{"hands_on_practices": [{"introduction": "在比较不同社区的健康状况时，一个常见的挑战是它们的人口年龄结构可能存在巨大差异。由于年龄是许多健康结果的关键影响因素，直接比较原始发病率可能会产生误导。本练习将引导您应用年龄标化这一核心流行病学方法，通过该方法可以消除年龄结构差异带来的混杂效应，从而对社区间的根本健康风险进行更公平、更准确的评估。[@problem_id:4364090]", "problem": "一个市卫生部门的社区健康需求评估（CHNA）旨在比较不同社区之间与哮喘相关的急诊（ED）就诊负担，同时考虑到年龄结构的差异。为了分离出与年龄分布无关的潜在风险，请使用直接法和2000年美国标准人口数据，计算该市的直接年龄标化哮喘急诊就诊率。使用以下信息：\n\n- 年龄组、城市人口分母以及年度哮喘急诊就诊次数：\n  - 年龄 $0$–$17$ 岁：人口 $= 52{,}000$，急诊就诊 $= 780$ 次。\n  - 年龄 $18$–$44$ 岁：人口 $= 95{,}000$，急诊就诊 $= 600$ 次。\n  - 年龄 $45$–$64$ 岁：人口 $= 61{,}000$，急诊就诊 $= 500$ 次。\n  - 年龄 $\\ge 65$ 岁：人口 $= 28{,}000$，急诊就诊 $= 420$ 次。\n\n- 使用汇总至上述年龄组的2000年美国标准人口权重：\n  - 年龄 $0$–$17$ 岁：权重 $w_1 = 0.26$。\n  - 年龄 $18$–$44$ 岁：权重 $w_2 = 0.39$。\n  - 年龄 $45$–$64$ 岁：权重 $w_3 = 0.23$。\n  - 年龄 $\\ge 65$ 岁：权重 $w_4 = 0.12$。\n\n从核心定义出发，计算每 $10{,}000$ 人的直接年龄标化年度哮喘急诊就诊率。然后，在急诊就诊次数服从大样本泊松分布且各年龄层相互独立的假设下，为该直接标化率构建一个 $95\\%$ 的置信区间（CI）。\n\n要求：\n- 以每 $10{,}000$ 人为单位，表示最终的年龄标化率以及 $95\\%$ 置信区间的下限和上限。\n- 将报告的所有三个数字四舍五入到四位有效数字。\n- 按照以下顺序报告你的最终结果：标化率、下限、上限。", "solution": "经评估，此问题有效可解。其科学依据是标准的流行病学方法（直接年龄标化），问题陈述清晰，提供了所有必要信息，且其表述是客观的。提供的标准人口权重之和为 $1$（$0.26 + 0.39 + 0.23 + 0.12 = 1.00$），所有数据都是一致且符合实际的。所要求的计算是生物统计学中的标准程序。\n\n令索引 $i$ 代表年龄层，其中 $i \\in \\{1, 2, 3, 4\\}$。\n给定数据如下：\n- 对于层 $i=1$（年龄 $0$–$17$ 岁）：计数 $C_1 = 780$，人口 $N_1 = 52,000$，标准权重 $w_1 = 0.26$。\n- 对于层 $i=2$（年龄 $18$–$44$ 岁）：计数 $C_2 = 600$，人口 $N_2 = 95,000$，标准权重 $w_2 = 0.39$。\n- 对于层 $i=3$（年龄 $45$–$64$ 岁）：计数 $C_3 = 500$，人口 $N_3 = 61,000$，标准权重 $w_3 = 0.23$。\n- 对于层 $i=4$（年龄 $\\ge 65$ 岁）：计数 $C_4 = 420$，人口 $N_4 = 28,000$，标准权重 $w_4 = 0.12$。\n\n任务是计算直接年龄标化率（DASR）及其 $95\\%$ 置信区间（CI）。\n\n首先，我们计算每个年龄层 $i$ 的年龄别率 $r_i$。年龄别率是该年龄层的事件数（急诊就诊次数）除以该层的人口数。\n$$r_i = \\frac{C_i}{N_i}$$\n四个年龄层的率如下：\n$$r_1 = \\frac{780}{52,000} = 0.015$$\n$$r_2 = \\frac{600}{95,000} \\approx 0.00631579$$\n$$r_3 = \\frac{500}{61,000} \\approx 0.00819672$$\n$$r_4 = \\frac{420}{28,000} = 0.015$$\n\n直接年龄标化率是年龄别率的加权平均值，其中权重来自标准人口。DASR 的计算公式为：\n$$\\text{DASR} = \\sum_{i=1}^{4} w_i r_i$$\n代入数值：\n$$\\text{DASR} = (0.26)(0.015) + (0.39)\\left(\\frac{600}{95,000}\\right) + (0.23)\\left(\\frac{500}{61,000}\\right) + (0.12)(0.015)$$\n$$\\text{DASR} \\approx (0.26)(0.015) + (0.39)(0.00631579) + (0.23)(0.00819672) + (0.12)(0.015)$$\n$$\\text{DASR} \\approx 0.0039 + 0.00246316 + 0.00188525 + 0.0018$$\n$$\\text{DASR} \\approx 0.01004841$$\n为表示为每 $10,000$ 人的率，我们乘以 $10,000$：\n$$\\text{DASR}_{\\text{per } 10,000} = 0.01004841 \\times 10,000 = 100.4841$$\n\n接下来，我们为 DASR 构建 $95\\%$ 的置信区间。在事件计数 $C_i$ 服从泊松分布的假设下，年龄别率 $r_i$ 的方差估计为：\n$$\\text{Var}(r_i) \\approx \\frac{C_i}{N_i^2}$$\n由于各年龄层是独立的，DASR（$r_i$ 的线性组合）的方差是加权方差之和：\n$$\\text{Var}(\\text{DASR}) = \\sum_{i=1}^{4} w_i^2 \\text{Var}(r_i) \\approx \\sum_{i=1}^{4} \\frac{w_i^2 C_i}{N_i^2}$$\n我们逐项计算这个和：\n$$\\text{Var}(\\text{DASR}) \\approx \\frac{0.26^2 \\times 780}{52,000^2} + \\frac{0.39^2 \\times 600}{95,000^2} + \\frac{0.23^2 \\times 500}{61,000^2} + \\frac{0.12^2 \\times 420}{28,000^2}$$\n$$\\text{Var}(\\text{DASR}) \\approx \\frac{52.728}{2,704,000,000} + \\frac{91.26}{9,025,000,000} + \\frac{26.45}{3,721,000,000} + \\frac{6.048}{784,000,000}$$\n$$\\text{Var}(\\text{DASR}) \\approx 1.9485 \\times 10^{-8} + 1.0112 \\times 10^{-8} + 0.7108 \\times 10^{-8} + 0.7714 \\times 10^{-8}$$\n$$\\text{Var}(\\text{DASR}) \\approx 4.4419 \\times 10^{-8}$$\nDASR 的标准误（SE）是其方差的平方根：\n$$\\text{SE}(\\text{DASR}) = \\sqrt{\\text{Var}(\\text{DASR})} \\approx \\sqrt{4.4419 \\times 10^{-8}} \\approx 2.1076 \\times 10^{-4}$$\n\n对于大样本，使用正态近似构建 $95\\%$ 置信区间：\n$$\\text{CI} = \\text{DASR} \\pm Z_{1-\\alpha/2} \\times \\text{SE}(\\text{DASR})$$\n对于 $95\\%$ 的置信区间，$\\alpha=0.05$，临界值为 $Z_{0.975} = 1.96$。\n误差范围（ME）为：\n$$\\text{ME} = 1.96 \\times \\text{SE}(\\text{DASR}) \\approx 1.96 \\times 2.1076 \\times 10^{-4} \\approx 4.1309 \\times 10^{-4}$$\nDASR 置信区间的下限和上限为：\n$$\\text{Lower Bound} = \\text{DASR} - \\text{ME} \\approx 0.01004841 - 0.00041309 = 0.00963532$$\n$$\\text{Upper Bound} = \\text{DASR} + \\text{ME} \\approx 0.01004841 + 0.00041309 = 0.01046150$$\n\n为表示为每 $10,000$ 人的界限，我们乘以 $10,000$：\n$$\\text{Lower Bound}_{\\text{per } 10,000} = 0.00963532 \\times 10,000 = 96.3532$$\n$$\\text{Upper Bound}_{\\text{per } 10,000} = 0.01046150 \\times 10,000 = 104.6150$$\n\n最后，我们按照要求将标化率和置信区间界限四舍五入到四位有效数字：\n- 标化率：$100.4841 \\to 100.5$\n- 下限：$96.3532 \\to 96.35$\n- 上限：$104.6150 \\to 104.6$\n\n所要求的三个数字是标化率、下限和上限，均以每 $10,000$ 人计。", "answer": "$$\\boxed{\\begin{pmatrix} 100.5 & 96.35 & 104.6 \\end{pmatrix}}$$", "id": "4364090"}, {"introduction": "社区健康需求评估严重依赖于地理数据，但分析单元（如邮政编码区域与人口普查区）的选择并非无关紧要。本练习将揭示“可变分区单元问题”（Modifiable Areal Unit Problem, MAUP），展示仅通过改变分析区域的边界就可能得出关于社区健康风险的不同结论。通过这个实践，您将学会批判性地审视数据的地理背景及其对评估结果的潜在影响。[@problem_id:4364088]", "problem": "一位卫生系统分析师正在评估在社区健康需求评估期间，不同的服务区定义如何影响哮喘事件率的估计。分析师比较了基于邮政编码（Zone Improvement Plan, ZIP）聚合定义的服务区与基于人口普查区聚合定义的服务区。基本原则是事件率的定义：对于一个固定的观察窗口，事件率等于事件数除以风险人群和观察时长。具体来说，哮喘急诊科（ED）就诊的事件率计算为每$10{,}000$人年的就诊次数。\n\n基本原理：\n- 事件率的定义：$r = \\dfrac{N}{P \\cdot T}$，其中 $N$ 是事件总数，$P$ 是风险人群，$T$ 是以年为单位的时长。\n- 缩放到常规社区健康指标：每$10{,}000$人年的就诊次数，通过 $r_{\\text{scaled}} = r \\cdot S$ 实现，其中 $S = 10{,}000$。\n- 地理流行病学中经过充分验证的观察：改变分母的聚合单位（例如，邮政编码与人口普查区）可以改变估计率，因为即使 $N$ 保持不变，$P$ 也会不同，这一现象与可变分区单元问题（Modifiable Areal Unit Problem）有关。\n\n任务：\n- 对于每个测试用例，给定相同的哮喘急诊分子计数 $N$ 和两个分母：基于邮政编码的服务区的 $P_{\\text{zip}}$ 和基于人口普查区的服务区的 $P_{\\text{tract}}$，以及以年为单位的观察时长 $T$。\n- 计算基于邮政编码的率 $r_{\\text{zip}} = \\dfrac{N}{P_{\\text{zip}} \\cdot T} \\cdot S$ 和基于人口普查区的率 $r_{\\text{tract}} = \\dfrac{N}{P_{\\text{tract}} \\cdot T} \\cdot S$，其中 $S = 10{,}000$。\n- 计算变化因子 $F = \\dfrac{r_{\\text{tract}}}{r_{\\text{zip}}}$ 以量化分母的选择如何抬高或压低该率。确定性地处理边界条件：如果 $r_{\\text{zip}} = 0$ 且 $r_{\\text{tract}} = 0$，则定义 $F = 1$；如果 $r_{\\text{zip}} = 0$ 且 $r_{\\text{tract}} > 0$，则定义 $F = +\\infty$；如果 $r_{\\text{zip}} > 0$ 且 $r_{\\text{tract}} = 0$，则定义 $F = 0$。\n- 计算绝对差 $D = \\left| r_{\\text{tract}} - r_{\\text{zip}} \\right|$，并确定其是否至少为阈值 $\\tau = 5$ 次/每$10{,}000$人年。输出一个布尔值 $B$，如果 $D \\ge \\tau$ 则为 $\\text{True}$，否则为 $\\text{False}$。\n\n单位和数值格式：\n- 所有率必须以每$10{,}000$人年的就诊次数表示。\n- 输出的 $r_{\\text{zip}}$、$r_{\\text{tract}}$ 和 $F$ 必须在最终输出中四舍五入到 $3$ 位小数。布尔值 $B$ 不进行四舍五入。\n\n测试套件：\n提供以下参数集 $(N, P_{\\text{zip}}, P_{\\text{tract}}, T)$ 的解，其中除了时长 $T$ 是正实数外，所有量都是正整数，且所有人口都代表人：\n1. $(N, P_{\\text{zip}}, P_{\\text{tract}}, T) = (120, 50000, 35000, 1)$\n2. $(N, P_{\\text{zip}}, P_{\\text{tract}}, T) = (5, 800, 1200, 0.5)$\n3. $(N, P_{\\text{zip}}, P_{\\text{tract}}, T) = (0, 100000, 90000, 1)$\n4. $(N, P_{\\text{zip}}, P_{\\text{tract}}, T) = (300, 120000, 125000, 2)$\n5. $(N, P_{\\text{zip}}, P_{\\text{tract}}, T) = (45, 400000, 250000, 1.5)$\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个子列表。每个子列表必须按 $[r_{\\text{zip}}, r_{\\text{tract}}, F, B]$ 的顺序排列，并包含两个四舍五入到3位小数的率浮点数、一个四舍五入到3位小数的变化因子浮点数（或根据需要为 $+\\infty$），以及布尔值 $B$。\n- 所需输出结构的示例：$[[r_{\\text{zip},1}, r_{\\text{tract},1}, F_1, B_1],[r_{\\text{zip},2}, r_{\\text{tract},2}, F_2, B_2],\\dots]$。", "solution": "问题陈述经评估有效。它具有科学依据，定义明确且客观。该问题描述了事件率的标准流行病学计算，并研究了改变分母人口的影响，这是一个与地理分析中的可变分区单元问题（Modifiable Areal Unit Problem, MAUP）相关的概念。输入被明确定义，所需的计算通过显式公式指定，输出格式精确。没有矛盾、歧义或对非科学主张的依赖。\n\n解决方案通过将提供的公式应用于每个测试用例来进行。\n\n事件率的核心公式，按每 $S = 10{,}000$ 人年进行缩放，由下式给出：\n$$ r_{\\text{scaled}} = \\frac{N}{P \\cdot T} \\cdot S $$\n其中 $N$ 是事件数，$P$ 是风险人群，$T$ 是以年为单位的观察时长。\n\n对于每个测试用例，我们都得到一组参数 $(N, P_{\\text{zip}}, P_{\\text{tract}}, T)$。我们必须计算四个值：$r_{\\text{zip}}$、$r_{\\text{tract}}$、$F$ 和 $B$。\n\n1.  **基于邮政编码的率 ($r_{\\text{zip}}$)**：\n    该率使用基于邮政编码的人口分母 $P_{\\text{zip}}$ 计算。\n    $$ r_{\\text{zip}} = \\frac{N}{P_{\\text{zip}} \\cdot T} \\cdot 10000 $$\n\n2.  **基于人口普查区的率 ($r_{\\text{tract}}$)**：\n    该率使用基于人口普查区的人口分母 $P_{\\text{tract}}$ 计算。\n    $$ r_{\\text{tract}} = \\frac{N}{P_{\\text{tract}} \\cdot T} \\cdot 10000 $$\n\n3.  **变化因子 ($F$)**：\n    变化因子 $F$ 是基于人口普查区的率与基于邮政编码的率之比。\n    $$ F = \\frac{r_{\\text{tract}}}{r_{\\text{zip}}} $$\n    对于 $N > 0$ 的情况，两个率都将非零（因为 $P > 0$ 且 $T > 0$）。我们可以简化 $F$ 的表达式：\n    $$ F = \\frac{\\frac{N}{P_{\\text{tract}} \\cdot T} \\cdot S}{\\frac{N}{P_{\\text{zip}} \\cdot T} \\cdot S} = \\frac{N \\cdot S}{P_{\\text{tract}} \\cdot T} \\cdot \\frac{P_{\\text{zip}} \\cdot T}{N \\cdot S} = \\frac{P_{\\text{zip}}}{P_{\\text{tract}}} $$\n    这种简化在数值上是稳定的，并避免了涉及可能很小的计算率的除法。\n    对于 $N=0$ 的边界情况， $r_{\\text{zip}}$ 和 $r_{\\text{tract}}$ 均为 $0$。问题在这种情况下定义 $F=1$。其他边界条件（由于一个率为零而另一个不为零导致的 $F=+\\infty$ 和 $F=0$）是不可能出现的，因为两个率共享相同的分子 $N$ 并且具有有限的正分母。因此，我们的逻辑是：如果 $N=0$，则 $F=1$；否则，$F = P_{\\text{zip}} / P_{\\text{tract}}$。\n\n4.  **绝对差 ($D$) 和阈值布尔值 ($B$)**：\n    两个率之间的绝对差 $D$ 计算如下：\n    $$ D = \\left| r_{\\text{tract}} - r_{\\text{zip}} \\right| $$\n    布尔值 $B$ 是通过将 $D$ 与指定的阈值 $\\tau = 5$ 次/每$10{,}000$人年进行比较来确定的。\n    $$ B = (D \\ge 5) $$\n\n最终的率和变化因子的数值结果必须四舍五入到3位小数进行输出。\n\n让我们为第一个测试用例演示计算过程：$(N, P_{\\text{zip}}, P_{\\text{tract}}, T) = (120, 50000, 35000, 1)$。\n- $r_{\\text{zip}} = \\dfrac{120}{50000 \\cdot 1} \\cdot 10000 = 0.0024 \\cdot 10000 = 24.0$\n- $r_{\\text{tract}} = \\dfrac{120}{35000 \\cdot 1} \\cdot 10000 \\approx 0.00342857 \\cdot 10000 \\approx 34.2857$\n- $F = \\dfrac{P_{\\text{zip}}}{P_{\\text{tract}}} = \\dfrac{50000}{35000} = \\dfrac{10}{7} \\approx 1.42857$\n- $D = |34.2857 - 24.0| = 10.2857$\n- $B = (10.2857 \\ge 5) = \\text{True}$\n\n四舍五入到3位小数后，此特定用例的输出为 $[24.000, 34.286, 1.429, \\text{True}]$。将相同的过程应用于所有其他测试用例以生成最终结果。", "answer": "[[24.000, 34.286, 1.429, True],[125.000, 83.333, 0.667, True],[0.000, 0.000, 1.000, False],[12.500, 12.000, 0.960, False],[0.750, 1.200, 1.600, False]]", "id": "4364088"}, {"introduction": "在识别出多种社区健康需求后，最艰巨的任务是决定优先解决哪些问题。多标准决策分析（Multi-Criteria Decision Analysis, MCDA）为此提供了一个结构化且透明的框架。本练习将模拟这一决策过程，您将学习如何权衡问题的规模、严重性、干预措施的可行性以及社区偏好等多种因素，从而做出合理、有据可依的优先排序决策。[@problem_id:4364052]", "problem": "一个卫生系统必须使用多标准决策分析框架对社区健康需求进行优先级排序。每个健康需求由五个标准来表征：量级、严重性、差异性、可行性和社区偏好。决策的基本基础是植根于效用理论的价值函数模型：当属性相互偏好独立时，存在一个加性多属性价值函数，可以合理地聚合特定标准的价值。\n\n该模型的定义和假设如下：\n- 量级 ($x_{\\text{mag}}$)：受影响的人数，以人数为单位。\n- 严重性 ($x_{\\text{sev}}$)：在从 $0$ 到 $10$ 的有界量表上的专家评分。\n- 差异性 ($x_{\\text{disp}}$)：目标亚群体的比率与参考群体的比率之比，为一个无量纲的比率，其中 $x_{\\text{disp}} \\ge 1$。\n- 可行性 ($x_{\\text{feas}}$)：成功实施的估计概率，在 $[0,1]$ 区间内，以小数表示。\n- 社区偏好 ($x_{\\text{pref}}$)：受访者中赞成优先处理的比例，在 $[0,1]$ 区间内，以小数表示。\n\n令 $v_j(\\cdot)$ 表示特定标准的价值转换函数，它将原始测量值映射到 $[0,1]$ 区间内的可通约量表上，并具有单调递增的偏好（越大越好）。需求 $i$ 的总价值（优先级得分）建模为\n$$\nU_i = \\sum_{j=1}^{5} w_j \\, v_j\\!\\left(x_{ij}\\right),\n$$\n其中 $w_j \\ge 0$ 是满足 $\\sum_{j=1}^{5} w_j = 1$ 的标准权重。\n\n您必须构建以下归一化方案以实现可通约性：\n- 对于量级，使用对数缓和的最小-最大变换来处理重尾计数：\n$$\nv_{\\text{mag}}(x) = \n\\begin{cases}\n\\dfrac{\\log(1+x) - \\log(1+x_{\\min})}{\\log(1+x_{\\max}) - \\log(1+x_{\\min})},  & \\text{if } \\log(1+x_{\\max}) \\neq \\log(1+x_{\\min}) \\\\[8pt]\n0.5, & \\text{otherwise}\n\\end{cases}\n$$\n其中 $x_{\\min}$ 和 $x_{\\max}$ 是给定测试案例中观测到的量级值的最小值和最大值。\n- 对于严重性，对其已知边界使用线性缩放：\n$$\nv_{\\text{sev}}(s) = \\dfrac{s}{10}.\n$$\n- 对于差异性，使用对数缓和的最小-最大变换来考虑乘法差异：\n$$\nv_{\\text{disp}}(r) = \n\\begin{cases}\n\\dfrac{\\log(r) - \\log(r_{\\min})}{\\log(r_{\\max}) - \\log(r_{\\min})},  & \\text{if } \\log(r_{\\max}) \\neq \\log(r_{\\min}) \\\\[8pt]\n0.5, & \\text{otherwise}\n\\end{cases}\n$$\n其中 $r_{\\min}$ 和 $r_{\\max}$ 是给定测试案例中观测到的差异性比率的最小值和最大值。\n- 对于可行性，在 $[0,1]$ 上使用恒等变换：\n$$\nv_{\\text{feas}}(f) = f.\n$$\n- 对于社区偏好，在 $[0,1]$ 上使用恒等变换：\n$$\nv_{\\text{pref}}(p) = p.\n$$\n\n当任何最小-最大变换的分母为零时（即在某个测试案例中，该标准的所有观测值都相等），则将该标准上所有备选项的归一化值定义为 $0.5$。对需求使用基于 $0$ 的索引，并通过选择最小的索引来打破平局。\n\n您的任务是实现此归一化方案，并为以下测试套件中的每个需求计算 $U_i$。对于每个测试案例，输出具有最高优先级的单个需求的索引。\n\n测试套件：\n- 测试案例 $1$ (权重 $w = [0.3, 0.25, 0.2, 0.15, 0.1]$):\n  - 量级 (人数): $[8500, 12000, 3000, 9500]$\n  - 严重性 ($0$–$10$): $[7.5, 6.0, 5.5, 8.0]$\n  - 差异性比率 ($\\ge 1$): $[1.8, 1.2, 2.5, 1.4]$\n  - 可行性 (小数): $[0.7, 0.9, 0.6, 0.5]$\n  - 偏好 (小数): $[0.65, 0.55, 0.80, 0.60]$\n- 测试案例 $2$ (权重 $w = [0.25, 0.20, 0.30, 0.15, 0.10]$):\n  - 量级 (人数): $[50000, 900, 2500, 4000]$\n  - 严重性 ($0$–$10$): $[9.0, 4.0, 6.5, 7.0]$\n  - 差异性比率 ($\\ge 1$): $[1.1, 2.0, 3.2, 1.5]$\n  - 可行性 (小数): $[0.4, 0.8, 0.6, 0.7]$\n  - 偏好 (小数): $[0.50, 0.70, 0.60, 0.55]$\n- 测试案例 $3$ (权重 $w = [0.2, 0.2, 0.2, 0.2, 0.2]$):\n  - 量级 (人数): $[2000, 2000, 2000, 2000]$\n  - 严重性 ($0$–$10$): $[5.0, 5.0, 5.0, 5.0]$\n  - 差异性比率 ($\\ge 1$): $[1.0, 1.0, 1.0, 1.0]$\n  - 可行性 (小数): $[0.2, 0.4, 0.6, 0.8]$\n  - 偏好 (小数): $[0.1, 0.2, 0.3, 0.4]$\n- 测试案例 $4$ (权重 $w = [0.35, 0.25, 0.20, 0.10, 0.10]$):\n  - 量级 (人数): $[0, 750, 1500]$\n  - 严重性 ($0$–$10$): $[8.5, 7.0, 3.0]$\n  - 差异性比率 ($\\ge 1$): $[1.7, 1.3, 2.1]$\n  - 可行性 (小数): $[0.3, 0.9, 0.2]$\n  - 偏好 (小数): $[0.0, 0.6, 0.4]$\n\n您的程序必须计算归一化的标准值，通过加权和将它们聚合以获得每个测试案例中每个需求的 $U_i$，然后报告每个测试案例中最高 $U_i$ 的索引。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[0,2,1,3]$）。无需用户输入。", "solution": "该问题提出了一个用于社区健康需求优先级排序的多标准决策分析（MCDA）框架。该方法基于加性多属性价值函数，这是决策理论中当标准间满足相互偏好独立假设时的标准技术。我们的任务是实现这个模型，计算几个测试案例中每个健康需求的优先级得分，并找出每个案例中得分最高的需求。\n\n给定健康需求 $i$ 的总价值，或称优先级得分 $U_i$，是其在五个标准上表现的加权和：\n$$\nU_i = \\sum_{j=1}^{5} w_j \\, v_j\\!\\left(x_{ij}\\right)\n$$\n这里，$x_{ij}$ 是需求 $i$ 在标准 $j$ 上的原始分数，$v_j(\\cdot)$ 是一个特定标准的价值函数，它将原始分数归一化到 $[0, 1]$ 的通用量表上，$w_j$ 是标准 $j$ 的权重，且 $w_j \\ge 0$ 且 $\\sum_j w_j = 1$。这些标准是量级 ($x_{\\text{mag}}$)、严重性 ($x_{\\text{sev}}$)、差异性 ($x_{\\text{disp}}$)、可行性 ($x_{\\text{feas}}$) 和社区偏好 ($x_{\\text{pref}}$)。\n\n该过程对每个测试案例涉及三个主要步骤：\n1.  应用指定的价值函数 $v_j(\\cdot)$ 对所有竞争的健康需求在每个标准上的原始数据进行归一化。\n2.  使用提供的权重聚合每个需求的归一化值，以计算总优先级得分 $U_i$。\n3.  找出得分最高 $U_i$ 的健康需求的索引，使用最小索引作为平局打破规则。\n\n价值函数 $v_j(\\cdot)$ 定义如下：\n\n**1. 量级 ($v_{\\text{mag}}$):**\n对于受影响的人数 $x$，采用对数缓和的最小-最大归一化。使用变换 $x \\to \\log(1+x)$ 来处理潜在的重尾分布计数，并确保对数在 $x=0$ 时有定义。\n价值函数为：\n$$\nv_{\\text{mag}}(x) = \\frac{\\log(1+x) - \\log(1+x_{\\min})}{\\log(1+x_{\\max}) - \\log(1+x_{\\min})}\n$$\n其中 $x_{\\min}$ 和 $x_{\\max}$ 是在被比较的需求集合中观测到的量级值的最小值和最大值。如果所有需求的量级都相同 ($x_{\\min} = x_{\\max}$)，则分母为零。在这种情况下，所有需求的归一化值被定义为 $0.5$，表示该标准贡献为中性或平均水平。\n\n**2. 严重性 ($v_{\\text{sev}}$):**\n严重性 $s$ 是在从 $0$ 到 $10$ 的固定量表上的专家评分。它通过对其理论边界进行线性缩放来归一化：\n$$\nv_{\\text{sev}}(s) = \\frac{s}{10}\n$$\n这将分数转换到所需的 $[0, 1]$ 区间。\n\n**3. 差异性 ($v_{\\text{disp}}$):**\n差异性 $r$ 是一个比率，其乘法差异比加法差异更有意义。因此，使用对数最小-最大归一化：\n$$\nv_{\\text{disp}}(r) = \\frac{\\log(r) - \\log(r_{\\min})}{\\log(r_{\\max}) - \\log(r_{\\min})}\n$$\n其中 $r_{\\min}$ 和 $r_{\\max}$ 是观测到的差异性比率的最小值和最大值。由于 $r \\ge 1$，$\\log(r)$ 是良定义且非负的。与量级类似，如果所有差异性值都相等 ($r_{\\min} = r_{\\max}$)，则归一化值设为 $0.5$。\n\n**4. 可行性 ($v_{\\text{feas}}$) 和社区偏好 ($v_{\\text{pref}}$):**\n可行性 $f$ 和社区偏好 $p$ 都以 $[0,1]$ 区间内的值给出（分别为一个概率和一个分数）。由于它们已经处于所需的通用量表上，因此使用恒等函数进行其价值转换：\n$$\nv_{\\text{feas}}(f) = f \\\\\nv_{\\text{pref}}(p) = p\n$$\n\n**计算流程：**\n对于每个测试案例，为了提高效率，我们将使用向量化操作执行以下计算。\n假设 $N$ 个需求和 $5$ 个标准的原始数据由一个 $N \\times 5$ 的原始分数矩阵表示。我们将生成一个 $N \\times 5$ 的归一化值矩阵 $V$，其中每个元素 $V_{ij} = v_j(x_{ij})$。\n1.  对于 `magnitude` 列，确定 $x_{\\min}$ 和 $x_{\\max}$。应用 $v_{\\text{mag}}$ 公式获得 $V$ 的第一列。\n2.  对于 `severity` 列，应用 $v_{\\text{sev}}$ 公式获得 $V$ 的第二列。\n3.  对于 `disparity` 列，确定 $r_{\\min}$ 和 $r_{\\max}$。应用 $v_{\\text{disp}}$ 公式获得 $V$ 的第三列。\n4.  `feasibility` 和 `preference` 列直接构成 $V$ 的第四和第五列。\n5.  然后通过计算归一化值矩阵 $V$ 和权重向量 $w$ 的矩阵-向量积，在单个操作中计算所有需求的优先级得分：\n    $$\n    \\mathbf{U} = V \\mathbf{w}\n    $$\n    其中 $\\mathbf{U}$ 是一个 $N \\times 1$ 的优先级得分向量。\n6.  最后，我们在向量 $\\mathbf{U}$ 中找到最大值的基于 $0$ 的索引。`argmax` 函数返回最大值的首次出现索引，这自然地处理了指定的平局打破规则。对问题陈述中提供的每个测试案例重复此过程。", "answer": "[0,2,3,2]", "id": "4364052"}]}