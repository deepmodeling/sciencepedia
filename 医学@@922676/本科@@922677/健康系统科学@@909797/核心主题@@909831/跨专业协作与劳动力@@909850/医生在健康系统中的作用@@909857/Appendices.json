{"hands_on_practices": [{"introduction": "现代医生必须在个体患者的需求与更广泛的公共卫生目标之间取得平衡。这项练习将运用贝叶斯定理这一循证医学的基本工具，来对抗生素的使用做出理性决策。它展示了定量方法如何帮助医生在对抗微生物耐药性这一系统性挑战中发挥关键作用。[@problem_id:4401017]", "problem": "一名在社区诊所执业的医生，负责在个体患者护理与系统层面目标（如抗生素管理和预防抗菌素耐药性）之间取得平衡。一名 $28$ 岁的成年人因喉咙痛前来就诊。根据使用经过验证的评分系统进行的临床风险分层，医生估计 A 组链球菌感染的验前概率为 $p = 0.30$。该诊所使用一种用于 A 组链球菌的快速抗原检测测试（RADT），其经分析验证的灵敏度为 $Se = 0.85$，特异性为 $Sp = 0.95$。患者的 RADT 结果呈阳性。\n\n使用条件概率的基本原理以及灵敏度和特异性的核心定义，推导在 RADT 结果为阳性的情况下，该患者确实患有 A 组链球菌感染的后验概率。然后，从医生在系统中的角色出发，根据诊所的抗菌药物管理计划（ASP）政策（该政策建议当验后概率至少为 $0.60$ 时进行治疗），解释是否应进行抗生素治疗。明确说明所使用的任何假设。\n\n为评分目的，仅报告后验概率，形式为 $0$ 到 $1$ 之间的小数，四舍五入至四位有效数字。最终报告值中不包含任何单位。", "solution": "该问题要求计算在检测结果为阳性的情况下，患者患有 A 组链球菌（GAS）感染的后验概率，并在抗生素管理政策的背景下解释这一结果。我们将使用条件概率的原理，特别是贝叶斯定理。\n\n让我们定义相关事件：\n$D$：患者患有 A 组链球菌感染。\n$D^c$：患者没有患有 A 组链球菌感染（$D$ 的补集）。\n$T^+$：快速抗原检测测试（RADT）结果为阳性。\n$T^-$：RADT 结果为阴性。\n\n根据问题陈述，我们已知以下概率：\n感染的验前概率为 $P(D) = p = 0.30$。\n测试的灵敏度是在患有该疾病的情况下检测结果为阳性的概率：$Se = P(T^+ | D) = 0.85$。\n测试的特异性是在未患该疾病的情况下检测结果为阴性的概率：$Sp = P(T^- | D^c) = 0.95$。\n\n需要计算的量是在检测结果为阳性的情况下患有该疾病的后验概率，记为 $P(D | T^+)$。\n\n根据贝叶斯定理，后验概率由以下公式给出：\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n\n分母中的项 $P(T^+)$ 是获得阳性检测结果的总概率。它可以使用全概率公式计算，该公式对疾病状态进行边缘化：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n\n我们已知 $P(T^+ | D)$ 和 $P(D)$ 的值。我们需要确定 $P(D^c)$ 和 $P(T^+ | D^c)$ 的值。\n未患该疾病的概率是患有该疾病概率的补集：\n$$P(D^c) = 1 - P(D) = 1 - 0.30 = 0.70$$\n\n概率 $P(T^+ | D^c)$ 是在未患病的患者中检测结果为阳性的概率，也称为假阳性率。这可以从特异性 $Sp$ 推导出来。因为对于一个未患病的患者，检测结果只能是阳性或阴性，所以我们有：\n$$P(T^+ | D^c) + P(T^- | D^c) = 1$$\n因此，假阳性率为：\n$$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp = 1 - 0.95 = 0.05$$\n\n现在我们可以计算阳性检测的总概率 $P(T^+)$：\n$$P(T^+) = (P(T^+ | D) \\times P(D)) + (P(T^+ | D^c) \\times P(D^c))$$\n$$P(T^+) = (0.85 \\times 0.30) + (0.05 \\times 0.70)$$\n$$P(T^+) = 0.255 + 0.035 = 0.290$$\n\n计算出 $P(T^+)$ 后，我们现在可以将所有值代回贝叶斯定理，以求得后验概率 $P(D | T^+)$：\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)} = \\frac{0.85 \\times 0.30}{0.290}$$\n$$P(D | T^+) = \\frac{0.255}{0.290} \\approx 0.87931034...$$\n\n按照题目要求将此结果四舍五入至四位有效数字，我们得到：\n$$P(D | T^+) \\approx 0.8793$$\n\n对于任务的第二部分，我们解释这个结果。诊所的抗菌药物管理计划（ASP）政策建议在验后概率至少为 $0.60$ 时进行抗生素治疗。我们计算出的后验概率约为 $0.8793$。由于 $0.8793 > 0.60$，满足了治疗的条件。因此，基于此概率分析和诊所的政策，有理由进行抗生素治疗。\n\n此计算中的主要假设是：\n1. 该患者能够代表确定验前概率 $p$、灵敏度 $Se$ 和特异性 $Sp$ 时所用的群体。\n2. 问题中提供的 $p$、$Se$ 和 $Sp$ 值是准确的，并且适用于这一特定的临床情景。\n3. 在给定真实疾病状态的情况下，测试结果与验前概率评估是条件独立的。", "answer": "$$\\boxed{0.8793}$$", "id": "4401017"}, {"introduction": "医疗保健的支付模式正在从按服务量付费转向按价值付费。这项练习将您置于一位医生领导者的角色，您必须通过数学建模来调整诊疗实践（特别是就诊强度），以在满足新的质量标准的同时保持财务可行性。这是在医疗体系中履行资源管家职责的一项核心技能。[@problem_id:4400974]", "problem": "一位初级保健医生正在从按服务收费 (FFS) 模式过渡到基于价值的支付 (VBP) 模式，并且必须重新设计访视强度以满足财务和质量约束。该医生的职责包括提供临床护理和管理卫生系统内的资源。假设访视强度是每位患者每年的平均访视次数，记为 $I$。该医生负责一个由 $N = 2000$ 名成年患者组成的患者群体。\n\n使用以下基本定义：\n- 在按服务收费 (FFS) 模式下，总收入等于每次访视的价格乘以总访视次数，总成本等于固定管理费用加上每次访视的可变成本乘以总访视次数。利润是总收入减去总成本。\n- 在基于价值的支付 (VBP) 模式下，如果满足质量要求，总收入等于每位患者每年的按人头付费收入加上每位患者每年的质量奖金。总成本的定义如上。利润是总收入减去总成本。\n- 质量绩效根据一个具有收益递减特性的饱和函数 $Q(I) = 1 - \\exp(-\\alpha I)$ 依赖于访视强度，并且必须达到最低质量阈值 $q_{0}$ 才能获得奖金。医生寻求满足利润目标和质量阈值的最低访视强度，这反映了卫生系统在满足要求的同时避免不必要资源使用的目标。\n\n参数：\n- FFS 模式下每次访视的报销额 $p_{\\mathrm{FFS}} = 120$。\n- 每次访视的可变成本 $c = 40$。\n- 年度固定管理费用 $F = 300{,}000$。\n- 年度目标利润 $M_{\\mathrm{target}} = 60{,}000$。\n- VBP 模式下每位患者每年的按人头付费收入 $r_{\\mathrm{cap}} = 360$。\n- VBP 模式下如果满足质量阈值，每位患者每年的质量奖金 $b = 40$。\n- 质量函数参数 $\\alpha = 0.6$。\n- 质量阈值 $q_{0} = 0.7$。\n\n假设在 VBP 模式下，当且仅当 $Q(I) \\geq q_{0}$ 时才能获得质量奖金，并且在该模式下，收入在其他方面不依赖于 $I$。仅使用利润等于收入减去成本的定义和给定的质量函数，计算从 FFS 模式过渡到 VBP 模式时访视强度的变化 $\\Delta I = I_{\\mathrm{VBP}} - I_{\\mathrm{FFS}}$，其中医生在每种支付模式下都选择满足利润目标和质量要求的最低访视强度 $I$。\n\n将最终数值答案四舍五入至四位有效数字，并以“次/患者·年”为单位表示。无需报告其他任何量。", "solution": "从定义开始。设 $I$ 为每位患者每年的平均访视次数，$V = N I$ 为每年的总访视次数。\n\n在按服务收费 (FFS) 模式下：\n- 总收入为 $R_{\\mathrm{FFS}} = p_{\\mathrm{FFS}} \\cdot V = p_{\\mathrm{FFS}} \\cdot N I$。\n- 总成本为 $C = F + c \\cdot V = F + c \\cdot N I$。\n- 利润为 $M_{\\mathrm{FFS}} = R_{\\mathrm{FFS}} - C = p_{\\mathrm{FFS}} N I - (F + c N I) = (p_{\\mathrm{FFS}} - c) N I - F$。\n\n为了以最低的资源使用率达到目标利润，将利润设定为目标值：\n$$\nM_{\\mathrm{FFS}} = M_{\\mathrm{target}} \\quad \\Rightarrow \\quad (p_{\\mathrm{FFS}} - c) N I_{\\mathrm{FFS}} - F = M_{\\mathrm{target}}.\n$$\n求解 $I_{\\mathrm{FFS}}$：\n$$\nI_{\\mathrm{FFS}} = \\frac{F + M_{\\mathrm{target}}}{(p_{\\mathrm{FFS}} - c) N}.\n$$\n代入参数 $F = 300{,}000$，$M_{\\mathrm{target}} = 60{,}000$，$p_{\\mathrm{FFS}} = 120$，$c = 40$ 和 $N = 2000$：\n$$\nI_{\\mathrm{FFS}} = \\frac{300{,}000 + 60{,}000}{(120 - 40) \\cdot 2000} = \\frac{360{,}000}{80 \\cdot 2000} = \\frac{360{,}000}{160{,}000} = 2.25.\n$$\n\n在基于价值的支付 (VBP) 模式下：\n- 如果达到质量阈值，则每位患者每年的总收入为 $r_{\\mathrm{cap}} + b$（否则为 $r_{\\mathrm{cap}}$）。\n- 总收入为 $R_{\\mathrm{VBP}} = N \\big(r_{\\mathrm{cap}} + B(I)\\big)$，其中如果 $Q(I) \\geq q_{0}$，则 $B(I) = b$，否则 $B(I) = 0$。\n- 总成本为 $C = F + c N I$。\n- 利润为 $M_{\\mathrm{VBP}} = R_{\\mathrm{VBP}} - C = N \\big(r_{\\mathrm{cap}} + B(I)\\big) - \\big(F + c N I\\big)$。\n\n质量要求：\n$$\nQ(I) = 1 - \\exp(-\\alpha I) \\geq q_{0} \\quad \\Rightarrow \\quad \\exp(-\\alpha I) \\leq 1 - q_{0} \\quad \\Rightarrow \\quad -\\alpha I \\leq \\ln(1 - q_{0}).\n$$\n因此，满足质量阈值的最低访视强度为\n$$\nI_{\\min} = -\\frac{1}{\\alpha} \\ln(1 - q_{0}).\n$$\n代入 $\\alpha = 0.6$ 和 $q_{0} = 0.7$：\n$$\nI_{\\min} = -\\frac{1}{0.6} \\ln(1 - 0.7) = -\\frac{1}{0.6} \\ln(0.3) = -\\frac{1}{0.6} \\cdot (-1.203972804\\ldots) = 1.666666\\ldots \\times 1.203972804\\ldots = 2.006621340\\ldots\n$$\n\n接下来，在 $I_{\\min}$ 处检查利润约束，并确定最小的可行 $I_{\\mathrm{VBP}}$。由于当达到阈值时 $B(I) = b$，并且在获得奖金后收入不再随 $I$ 增加，医生应选择满足质量和利润要求的最小 $I$。计算获得奖金时利润作为 $I$ 的函数：\n$$\nM_{\\mathrm{VBP}}(I) = N (r_{\\mathrm{cap}} + b) - F - c N I.\n$$\n代入 $N = 2000$，$r_{\\mathrm{cap}} = 360$，$b = 40$，$F = 300{,}000$ 和 $c = 40$：\n$$\nM_{\\mathrm{VBP}}(I) = 2000 \\cdot (360 + 40) - 300{,}000 - 40 \\cdot 2000 \\cdot I = 2000 \\cdot 400 - 300{,}000 - 80{,}000 I = 800{,}000 - 300{,}000 - 80{,}000 I = 500{,}000 - 80{,}000 I.\n$$\n为使利润达到目标：\n$$\nM_{\\mathrm{VBP}}(I) \\geq M_{\\mathrm{target}} \\quad \\Rightarrow \\quad 500{,}000 - 80{,}000 I \\geq 60{,}000 \\quad \\Rightarrow \\quad I \\leq \\frac{500{,}000 - 60{,}000}{80{,}000} = \\frac{440{,}000}{80{,}000} = 5.5.\n$$\n由于 $I_{\\min} \\approx 2.0066 \\leq 5.5$，在满足质量要求的最低访视强度下，利润目标也得到满足。因此，\n$$\nI_{\\mathrm{VBP}} = I_{\\min} = 2.006621340\\ldots\n$$\n\n最后，计算访视强度的变化：\n$$\n\\Delta I = I_{\\mathrm{VBP}} - I_{\\mathrm{FFS}} = 2.006621340\\ldots - 2.25 = -0.243378659\\ldots\n$$\n四舍五入至四位有效数字：\n$$\n\\Delta I \\approx -0.2434.\n$$\n单位为“次/患者·年”。", "answer": "$$\\boxed{-0.2434}$$", "id": "4400974"}, {"introduction": "随着临床算法和人工智能在医学领域的兴起，医生作为“数字伦理学家”的关键作用日益凸显，他们必须确保这些强大的工具不会延续或加剧健康不平等。这项高级练习将指导您应用一个正式的公平标准（“均等化赔率”），通过设定针对不同人群的决策阈值，来展示如何用严谨的数学方法将伦理原则付诸实践。[@problem_id:4401020]", "problem": "一名医生负责监督一个临床风险评分算法，该算法用于确定是否对疑似患有某种疾病的患者启动预防性干预。设二元基准真相为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示患者将从干预中受益，算法生成一个连续分数 $S \\in \\mathbb{R}$。医生采用一个决策规则，当且仅当 $S \\geq t_{g}$ 时进行干预，其中 $t_{g}$ 是一个可能因人口群体 $g \\in \\{A,B\\}$ 而异的阈值。\n\n对于群体 $g$ 和阈值 $t_{g}$，定义了两个核心性能指标如下：\n- 真阳性率 (TPR)，也称为灵敏度 (sensitivity)：$\\mathrm{TPR}_{g}(t_{g}) = \\mathbb{P}(S \\geq t_{g} \\mid Y=1)$。\n- 假阳性率 (FPR)：$\\mathrm{FPR}_{g}(t_{g}) = \\mathbb{P}(S \\geq t_{g} \\mid Y=0)$。\n\n均等化赔率 (Equalized odds) 是一种公平性标准，要求对于所选的决策阈值，各群体间的 $\\mathrm{TPR}$ 和 $\\mathrm{FPR}$ 都相等，即 $\\mathrm{TPR}_{A}(t_{A}) = \\mathrm{TPR}_{B}(t_{B})$ 且 $\\mathrm{FPR}_{A}(t_{A}) = \\mathrm{FPR}_{B}(t_{B})$。医生必须选择满足均等化赔率的阈值 $(t_{A}, t_{B})$，同时达到最低灵敏度目标以符合临床质量标准。\n\n假设存在以下科学上合理的评分模型：对于每个群体 $g \\in \\{A,B\\}$，分数的条件分布是高斯（正态）分布，\n$$\nS \\mid (Y=1, g) \\sim \\mathcal{N}(\\mu_{g1}, \\sigma^{2}), \\quad S \\mid (Y=0, g) \\sim \\mathcal{N}(\\mu_{g0}, \\sigma^{2}),\n$$\n参数为\n$$\n\\mu_{A1} = 0.9, \\quad \\mu_{A0} = 0.3, \\quad \\mu_{B1} = 1.2, \\quad \\mu_{B0} = 0.6, \\quad \\sigma = 0.2.\n$$\n医生施加策略约束 $\\mathrm{TPR}_{A}(t_{A}) = \\mathrm{TPR}_{B}(t_{B}) = 0.85$ 以确保足够的灵敏度，并要求两个群体之间满足均等化赔率。\n\n从 $\\mathrm{TPR}$ 和 $\\mathrm{FPR}$ 以及正态分布的基本定义出发，推导出实现均等化赔率所需的阈值约束，然后计算满足指定参数下灵敏度目标和均等化赔率的阈值 $t_{A}$ 和 $t_{B}$。将您的数值阈值四舍五入到四位有效数字。最终答案必须以包含 $t_{A}$ 和 $t_{B}$ 的单行矩阵形式提供，不带单位。", "solution": "目标是为两个人口群体 $A$ 和 $B$ 找到阈值 $t_{A}$ 和 $t_{B}$，使其满足均等化赔率公平性标准，同时达到 $0.85$ 的特定灵敏度 (TPR) 目标。\n\n首先，我们用正态分布的参数来表示真阳性率 ($\\mathrm{TPR}$) 和假阳性率 ($\\mathrm{FPR}$)。设 $Z \\sim \\mathcal{N}(0, 1)$ 为一个标准正态随机变量，并设 $\\Phi(z) = \\mathbb{P}(Z \\leq z)$ 为其累积分布函数 (CDF)。\n\n对于任何群体 $g \\in \\{A, B\\}$，在阈值 $t_g$ 下的 TPR 由下式给出：\n$$\n\\mathrm{TPR}_{g}(t_{g}) = \\mathbb{P}(S \\geq t_{g} \\mid Y=1, g)\n$$\n由于 $S \\mid (Y=1, g) \\sim \\mathcal{N}(\\mu_{g1}, \\sigma^2)$，我们可以对变量进行标准化：\n$$\n\\mathrm{TPR}_{g}(t_{g}) = \\mathbb{P}\\left(\\frac{S - \\mu_{g1}}{\\sigma} \\geq \\frac{t_{g} - \\mu_{g1}}{\\sigma}\\right) = \\mathbb{P}\\left(Z \\geq \\frac{t_{g} - \\mu_{g1}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t_{g} - \\mu_{g1}}{\\sigma}\\right)\n$$\n类似地，在阈值 $t_g$ 下的 FPR 由下式给出：\n$$\n\\mathrm{FPR}_{g}(t_{g}) = \\mathbb{P}(S \\geq t_{g} \\mid Y=0, g)\n$$\n由于 $S \\mid (Y=0, g) \\sim \\mathcal{N}(\\mu_{g0}, \\sigma^2)$，我们进行标准化：\n$$\n\\mathrm{FPR}_{g}(t_{g}) = \\mathbb{P}\\left(\\frac{S - \\mu_{g0}}{\\sigma} \\geq \\frac{t_{g} - \\mu_{g0}}{\\sigma}\\right) = \\mathbb{P}\\left(Z \\geq \\frac{t_{g} - \\mu_{g0}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t_{g} - \\mu_{g0}}{\\sigma}\\right)\n$$\n\n均等化赔率标准要求所选阈值 $(t_A, t_B)$ 满足两个条件：\n1. $\\mathrm{TPR}_{A}(t_{A}) = \\mathrm{TPR}_{B}(t_{B})$\n2. $\\mathrm{FPR}_{A}(t_{A}) = \\mathrm{FPR}_{B}(t_{B})$\n\n根据第一个条件，我们有：\n$$\n1 - \\Phi\\left(\\frac{t_{A} - \\mu_{A1}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t_{B} - \\mu_{B1}}{\\sigma}\\right)\n$$\n由于 $\\Phi$ 是一个严格递增函数，此等式意味着 $\\Phi$ 的参数必须相等：\n$$\n\\frac{t_{A} - \\mu_{A1}}{\\sigma} = \\frac{t_{B} - \\mu_{B1}}{\\sigma} \\implies t_{A} - \\mu_{A1} = t_{B} - \\mu_{B1}\n$$\n根据第二个条件，我们有：\n$$\n1 - \\Phi\\left(\\frac{t_{A} - \\mu_{A0}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t_{B} - \\mu_{B0}}{\\sigma}\\right)\n$$\n这同样意味着：\n$$\n\\frac{t_{A} - \\mu_{A0}}{\\sigma} = \\frac{t_{B} - \\mu_{B0}}{\\sigma} \\implies t_{A} - \\mu_{A0} = t_{B} - \\mu_{B0}\n$$\n这两个推导出的方程构成一个方程组。重新整理两个方程以表示 $t_{A} - t_{B}$：\n$$\nt_{A} - t_{B} = \\mu_{A1} - \\mu_{B1} \\quad \\text{和} \\quad t_{A} - t_{B} = \\mu_{A0} - \\mu_{B0}\n$$\n为了使这些条件能同时满足，必须有 $\\mu_{A1} - \\mu_{B1} = \\mu_{A0} - \\mu_{B0}$，这等价于 $\\mu_{A1} - \\mu_{A0} = \\mu_{B1} - \\mu_{B0}$。问题的参数构造得使其成立：\n$$\n\\mu_{A1} - \\mu_{A0} = 0.9 - 0.3 = 0.6\n$$\n$$\n\\mu_{B1} - \\mu_{B0} = 1.2 - 0.6 = 0.6\n$$\n这证实了问题设置的内部一致性。任何满足 TPR 相等条件的阈值对 $(t_A, t_B)$ 也将满足 FPR 相等条件。\n\n医生的策略约束设定了目标 TPR：\n$$\n\\mathrm{TPR}_{A}(t_{A}) = \\mathrm{TPR}_{B}(t_{B}) = 0.85\n$$\n我们可以使用这个约束来独立求解 $t_{A}$ 和 $t_{B}$。对于群体 A：\n$$\n\\mathrm{TPR}_{A}(t_{A}) = 1 - \\Phi\\left(\\frac{t_{A} - \\mu_{A1}}{\\sigma}\\right) = 0.85\n$$\n这得到：\n$$\n\\Phi\\left(\\frac{t_{A} - \\mu_{A1}}{\\sigma}\\right) = 1 - 0.85 = 0.15\n$$\n令 $\\Phi^{-1}$ 表示标准正态分布的分位数函数（逆 CDF）。对两边应用 $\\Phi^{-1}$：\n$$\n\\frac{t_{A} - \\mu_{A1}}{\\sigma} = \\Phi^{-1}(0.15)\n$$\n求解 $t_A$：\n$$\nt_{A} = \\mu_{A1} + \\sigma \\cdot \\Phi^{-1}(0.15)\n$$\n类似地，对于群体 B：\n$$\n\\frac{t_{B} - \\mu_{B1}}{\\sigma} = \\Phi^{-1}(0.15)\n$$\n求解 $t_B$：\n$$\nt_{B} = \\mu_{B1} + \\sigma \\cdot \\Phi^{-1}(0.15)\n$$\n现在，我们代入数值。分位数 $\\Phi^{-1}(0.15)$ 是一个标准值，约等于 $-1.036433$。给定参数为 $\\mu_{A1} = 0.9$, $\\mu_{B1} = 1.2$ 和 $\\sigma = 0.2$。\n\n对于阈值 $t_{A}$：\n$$\nt_{A} = 0.9 + 0.2 \\times (-1.036433) = 0.9 - 0.2072866 = 0.6927134\n$$\n对于阈值 $t_{B}$：\n$$\nt_{B} = 1.2 + 0.2 \\times (-1.036433) = 1.2 - 0.2072866 = 0.9927134\n$$\n问题要求将最终的数值阈值四舍五入到四位有效数字。\n$$\nt_{A} \\approx 0.6927\n$$\n$$\nt_{B} \\approx 0.9927\n$$\n这些阈值满足了两个群体的 $\\mathrm{TPR} = 0.85$ 的策略约束，并且由于模型参数的特定结构，它们也确保了 $\\mathrm{FPR}_{A}(t_{A}) = \\mathrm{FPR}_{B}(t_{B})$，从而满足了均等化赔率标准。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6927  0.9927\n\\end{pmatrix}\n}\n$$", "id": "4401020"}]}