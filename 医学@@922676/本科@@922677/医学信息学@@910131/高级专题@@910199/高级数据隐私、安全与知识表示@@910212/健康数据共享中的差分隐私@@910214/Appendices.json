{"hands_on_practices": [{"introduction": "拉普拉斯机制是中心化差分隐私的基石，但其有效性取决于能否正确校准噪声的水平。本练习将指导你计算一个查询的敏感度——即单个个体的数据能对结果造成的最大改变——这是为给定的隐私保证 $\\varepsilon$ 确定所需噪声量的关键。掌握这一过程是构建任何稳健的隐私保护系统的第一步。[@problem_id:4835475]", "problem": "一家研究型医院计划发布一个从其电子健康记录 (EHR) 系统中导出的综合质量指标：一个月内记录的成年患者血清肌酐测量值的总和。对于每位患者 $i$，假设有 $m_i$ 次抽血，测量值分别为 $x_{i1}, x_{i2}, \\dots, x_{im_i}$，单位为 $\\text{mg/dL}$。患者的原始总和定义为 $t_i = \\sum_{j=1}^{m_i} x_{ij}$。为了保证隐私和鲁棒性，医院将每位患者的贡献值裁剪到一个固定的上限 $C$（单位为 $\\text{mg/dL}$），形成 $s_i = \\min(t_i, C)$。发布的统计量是求和查询\n$$\nf(D) = \\sum_{i=1}^{n} s_i,\n$$\n其中 $D$ 是包含 $n$ 位患者的数据集。\n\n医院将使用纯差分隐私 (DP)，隐私参数为 $\\varepsilon$，基于添加/删除相邻关系：如果一个数据集可以通过添加或删除单个患者的完整 EHR 记录从另一个数据集中获得，那么这两个数据集 $D$ 和 $D'$ 是相邻的。该随机化机制在查询输出上添加从拉普拉斯分布中抽取的噪声，该分布以零为中心，尺度参数为 $b$（单位与查询相同，为 $\\text{mg/dL}$）。\n\n仅使用第一性原理——差分隐私的形式化定义、指定相邻关系下查询的全局 $\\ell_1$ 灵敏度概念，以及拉普拉斯分布的概率密度函数——推导 $f$ 的全局 $\\ell_1$ 灵敏度，然后确定满足此求和查询的 $\\varepsilon$-DP 所需的尺度参数 $b$。取 $C = 10\\,\\text{mg/dL}$ 和 $\\varepsilon = 0.8$。将 $b$ 的最终值四舍五入到四位有效数字，并以 $\\text{mg/dL}$ 为单位表示。仅报告 $b$ 的值。", "solution": "我们从差分隐私 (DP) 的形式化定义开始。如果对于所有相邻数据集 $D$ 和 $D'$ 以及所有可测输出子集 $S$，一个随机化机制 $\\mathcal{M}$ 满足\n$$\n\\Pr[\\mathcal{M}(D) \\in S] \\leq \\exp(\\varepsilon)\\,\\Pr[\\mathcal{M}(D') \\in S],\n$$\n那么它在添加/删除相邻关系下满足 $\\varepsilon$-DP。\n\n我们关注的机制是应用于求和查询 $f(D)$ 的拉普拉斯机制，即\n$$\n\\mathcal{M}(D) = f(D) + Y,\n$$\n其中 $Y$ 是一个服从均值为 $0$、尺度参数为 $b$ 的拉普拉斯分布的随机变量。$Y$ 的概率密度函数 (pdf) 是\n$$\np_{Y}(y) = \\frac{1}{2b}\\,\\exp\\!\\left(-\\frac{|y|}{b}\\right).\n$$\n\n为了使用拉普拉斯机制，我们需要在指定的相邻关系下查询 $f$ 的全局 $\\ell_1$ 灵敏度。全局 $\\ell_1$ 灵敏度 $\\Delta_{1}(f)$ 定义为\n$$\n\\Delta_{1}(f) = \\max_{D \\sim D'} |f(D) - f(D')|,\n$$\n其中 $D \\sim D'$ 表示 $D$ 和 $D'$ 是相邻数据集（因添加/删除一名患者的记录而不同）。\n\n给定 $f(D) = \\sum_{i=1}^{n} s_i$，其中 $s_i = \\min(t_i, C)$ 且 $t_i = \\sum_{j=1}^{m_i} x_{ij}$，在添加/删除邻接关系下，$D'$ 与 $D$ 的区别在于是否存在单个患者 $p$。那么\n$$\nf(D) - f(D') = \n\\begin{cases}\ns_p  \\text{如果 } D' \\text{ 是 } D \\text{ 移除了患者 } p \\text{ 之后的数据集},\\\\\n- s_p  \\text{如果 } D \\text{ 是 } D' \\text{ 移除了患者 } p \\text{ 之后的数据集}。\n\\end{cases}\n$$\n因此，\n$$\n|f(D) - f(D')| = |s_p|.\n$$\n根据定义，每个 $s_p$ 都被裁剪：$s_p = \\min(t_p, C)$，这意味着 $0 \\leq s_p \\leq C$。因此，\n$$\n|f(D) - f(D')| \\leq C,\n$$\n并且因为存在患者能达到 $s_p = C$ 的数据集，所以可能的最大变化在 $C$ 处达到。因此，\n$$\n\\Delta_{1}(f) = C.\n$$\n\n接下来，我们推导拉普拉斯机制满足 $\\varepsilon$-DP 所需的尺度参数 $b$。考虑在固定值 $z \\in \\mathbb{R}$ 处的输出密度比：\n$$\n\\frac{p_{\\mathcal{M}(D)}(z)}{p_{\\mathcal{M}(D')}(z)} \n= \n\\frac{\\frac{1}{2b}\\exp\\!\\left(-\\frac{|z - f(D)|}{b}\\right)}{\\frac{1}{2b}\\exp\\!\\left(-\\frac{|z - f(D')|}{b}\\right)}\n=\n\\exp\\!\\left(\\frac{|z - f(D')| - |z - f(D)|}{b}\\right).\n$$\n使用反三角不等式 $||a|-|b|| \\leq |a-b|$，我们得到\n$$\n\\left||z - f(D')| - |z - f(D)|\\right| \\leq |f(D) - f(D')|.\n$$\n因此，对于所有的 $z$，\n$$\n\\frac{p_{\\mathcal{M}(D)}(z)}{p_{\\mathcal{M}(D')}(z)} \n\\leq \\exp\\!\\left(\\frac{|f(D) - f(D')|}{b}\\right)\n\\leq \\exp\\!\\left(\\frac{\\Delta_{1}(f)}{b}\\right).\n$$\n为确保对所有可测子集 $S$ 都满足 DP 条件 $\\Pr[\\mathcal{M}(D) \\in S] \\leq \\exp(\\varepsilon)\\,\\Pr[\\mathcal{M}(D') \\in S]$，我们只需满足\n$$\n\\exp\\!\\left(\\frac{\\Delta_{1}(f)}{b}\\right) \\leq \\exp(\\varepsilon),\n$$\n这等价于\n$$\n\\frac{\\Delta_{1}(f)}{b} \\leq \\varepsilon\n\\quad\\Rightarrow\\quad\nb \\geq \\frac{\\Delta_{1}(f)}{\\varepsilon}.\n$$\n\n使用推导出的灵敏度 $\\Delta_{1}(f) = C$ 以及给定的参数 $C = 10\\,\\text{mg/dL}$ 和 $\\varepsilon = 0.8$，最小尺度为\n$$\nb = \\frac{C}{\\varepsilon} = \\frac{10}{0.8} = 12.5\\,\\text{mg/dL}.\n$$\n四舍五入到四位有效数字（并按要求以 $\\text{mg/dL}$ 为单位表示），结果是\n$$\nb = 12.50\\,\\text{mg/dL}.\n$$\n\n题目要求我们仅报告 $b$ 的值，四舍五入到四位有效数字。", "answer": "$$\\boxed{12.50}$$", "id": "4835475"}, {"introduction": "现实世界中的健康数据仪表盘不会只发布一个统计数据，而是日复一日地发布许多统计数据。本练习探讨了组合性这一至关重要的概念，它解释了隐私损失如何随着每个新查询的发布而累积。通过理解如何管理“隐私预算”，你可以设计出既能提供持续效用，又能恪守严格长期隐私承诺的系统。[@problem_id:4835438]", "problem": "一个区域性卫生机构运行一个公共监测仪表板，每天发布一组从受保护的患者数据库中计算得出的固定聚合统计数据。每个发布的统计数据都是一个计数查询（例如，过去$1$天内新增的流感入院人数），其全局敏感度为 $\\Delta f = 1$。为保护个人隐私，该机构对每个统计数据使用拉普拉斯机制，并根据单次发布的隐私参数 $\\epsilon_{0}$ 进行校准，这意味着噪声尺度为 $b = \\Delta f / \\epsilon_{0}$。\n\n从差分隐私（DP）的定义出发：对于任意一对相邻数据集 $D$ 和 $D'$ 以及任意可测的输出集合 $S$，若一个随机化机制 $M$ 满足 $\\Pr[M(D) \\in S] \\le \\exp(\\epsilon)\\,\\Pr[M(D') \\in S]$，则该机制是 $\\epsilon$-差分隐私的（$\\epsilon$-DP）。请推导当从同一数据集中顺序地、并可能自适应地发布 $k$ 个统计数据时（即每次发布可能依赖于之前的发布），累积隐私参数 $\\epsilon_{\\text{tot}}$ 在简单组合下的增长方式。然后，应用您的推导来确定在每次发布的隐私参数为 $\\epsilon_{0} = 0.05$ 且每日隐私预算为 $\\epsilon_{\\text{budget}} = 1.2$ 的情况下，每天可以发布的不同统计数据的最大数量 $k$。\n\n最终答案仅报告最大整数 $k$。无需单位。如果需要四舍五入，则舍入到最接近的整数；然而，如果该值恰好为整数，请精确报告该整数。", "solution": "**组合下累积隐私损失的推导**\n\n假设有一系列 $k$ 个随机化机制，$M_1, M_2, \\dots, M_k$。假设每个机制 $M_i$ 都是 $\\epsilon_0$-差分隐私的。这些机制顺序地应用于同一个数据库 $D$。组合可以是自适应的，这意味着机制 $M_i$（当 $i > 1$ 时）的选择可以依赖于先前机制 $M_1, \\dots, M_{i-1}$ 的输出。设输出序列为 $o_1, o_2, \\dots, o_k$，其中 $o_i$ 是 $M_i$ 的输出。\n\n组合机制 $M_{\\text{comp}}(D)$ 产生输出元组 $O = (o_1, o_2, \\dots, o_k)$。我们想要确定 $M_{\\text{comp}}$ 的总隐私参数 $\\epsilon_{\\text{tot}}$。\n\n设 $D$ 和 $D'$ 是两个相邻数据集，最多相差一个个体的记录。设 $p(O|D)$ 和 $p(O|D')$ 分别为当机制在数据集 $D$ 和 $D'$ 上运行时，输出元组 $O$ 的概率密度（或质量）函数。\n\n使用概率的链式法则，我们可以将联合概率密度写成条件概率的乘积：\n$$p(O|D) = p(o_1|D) \\cdot p(o_2|D, o_1) \\cdot p(o_3|D, o_1, o_2) \\cdots p(o_k|D, o_1, \\dots, o_{k-1})$$\n对于数据集 $D'$ 也类似：\n$$p(O|D') = p(o_1|D') \\cdot p(o_2|D', o_1) \\cdot p(o_3|D', o_1, o_2) \\cdots p(o_k|D', o_1, \\dots, o_{k-1})$$\n\n现在，我们分析这两个概率的比值：\n$$\\frac{p(O|D)}{p(O|D')} = \\left(\\frac{p(o_1|D)}{p(o_1|D')}\\right) \\cdot \\left(\\frac{p(o_2|D, o_1)}{p(o_2|D', o_1)}\\right) \\cdots \\left(\\frac{p(o_k|D, o_1, \\dots, o_{k-1})}{p(o_k|D', o_1, \\dots, o_{k-1})}\\right)$$\n\n对于第一个机制 $M_1$，因为它满足 $\\epsilon_0$-DP，所以对于任何可能的输出 $o_1$ 我们有：\n$$\\frac{p(o_1|D)}{p(o_1|D')} \\le \\exp(\\epsilon_0)$$\n对于第二个机制 $M_2$，$\\epsilon_0$-DP 的保证对于任何固定的条件信息都成立。之前的输出 $o_1$ 可以被视为公共的辅助信息。因此，对于任何 $o_2$：\n$$\\frac{p(o_2|D, o_1)}{p(o_2|D', o_1)} \\le \\exp(\\epsilon_0)$$\n这个推理可以扩展到所有后续的机制。对于序列中的任何机制 $M_i$，其 $\\epsilon_0$-DP 保证在给定先前机制的输出 $o_1, \\dots, o_{i-1}$ 的条件下成立：\n$$\\frac{p(o_i|D, o_1, \\dots, o_{i-1})}{p(o_i|D', o_1, \\dots, o_{i-1})} \\le \\exp(\\epsilon_0)$$\n将这些单独的界限代回到联合概率比值的乘积中：\n$$\\frac{p(O|D)}{p(O|D')} \\le \\exp(\\epsilon_0) \\cdot \\exp(\\epsilon_0) \\cdots \\exp(\\epsilon_0) \\quad (k \\text{ 次})$$\n$$\\frac{p(O|D)}{p(O|D')} \\le \\left(\\exp(\\epsilon_0)\\right)^k = \\exp(k \\cdot \\epsilon_0)$$\n这个不等式必须对任何一对相邻数据集 $D, D'$ 和任何可能的输出序列 $O$ 成立。这正是 $(k \\cdot \\epsilon_0)$-差分隐私的定义。因此，组合机制的累积隐私参数为：\n$$\\epsilon_{\\text{tot}} = k \\cdot \\epsilon_0$$\n这个结果被称为差分隐私的基本组合定理。\n\n**问题应用**\n\n问题陈述，每日总隐私预算 $\\epsilon_{\\text{budget}} = 1.2$ 不得超过。$k$ 次发布后的累积隐私损失 $\\epsilon_{\\text{tot}}$ 必须小于或等于此预算。\n$$\\epsilon_{\\text{tot}} \\le \\epsilon_{\\text{budget}}$$\n使用上面推导的组合规则：\n$$k \\cdot \\epsilon_0 \\le \\epsilon_{\\text{budget}}$$\n给定每次发布的隐私参数 $\\epsilon_0 = 0.05$。我们需要找到可以发布的最大整数统计数量 $k$。\n$$k \\le \\frac{\\epsilon_{\\text{budget}}}{\\epsilon_0}$$\n代入给定的数值：\n$$k \\le \\frac{1.2}{0.05}$$\n为了计算这个分数，我们可以将分子和分母都乘以 $100$：\n$$k \\le \\frac{120}{5}$$\n$$k \\le 24$$\n由于 $k$ 必须是整数，因此每天可以发布的最大统计数量是 $24$。", "answer": "$$\\boxed{24}$$", "id": "4835438"}, {"introduction": "添加噪声可以保护隐私，但也会影响数据的统计分析效用。这最后一个练习直面一个关键挑战：如何对为保护隐私而修改过的数据进行有效的假设检验。你将了解为什么简单的统计检验可能会产生误导性结果，并学习如何推导出一个修正的检验统计量，该统计量能恰当地将隐私噪声考虑在内，从而在隐私工程和严谨的科学推断之间架起一座桥梁。[@problem_id:4835490]", "problem": "一家医院正在评估本季度低密度脂蛋白胆固醇（LDL-C）异常高的患者比例是否超过了先前验证的基线比例。为了保护患者隐私，该医院遵循差分隐私（DP）原则，仅发布一个经过处理的LDL-C升高病例数，该数据是通过向真实计数添加独立的拉普拉斯噪声获得的。医院希望检验零假设，即真实的LDL-C升高比例仍保持在基线值。\n\n假设以下科学上合理的设定：\n- 在$n$名患者中，LDL-C升高的真实病例数是一个随机变量$C$，其模型为$C \\sim \\mathrm{Binomial}(n,p)$。\n- 在零假设$H_{0}: p = p_{0}$下，$p_{0}$是基线比例。\n- 发布的差分隐私计数为$\\tilde{C} = C + \\eta$，其中$\\eta \\sim \\mathrm{Laplace}(0,b)$且独立于$C$。这里$b$是数据管理者为满足固定的隐私预算而选择的拉普拉斯尺度参数；你可以认为拉普拉斯分布的均值为零，方差为$2b^{2}$。\n- 经典的二项分布比例大样本$z$检验在$H_{0}$下使用$C$的正态近似。\n\n请根据二项分布模型的基本原理和独立加性噪声的性质，解释为什么在忽略差分隐私（DP）噪声的情况下，对发布的$\\tilde{C}$草率地应用标准$z$检验会导致错误的$p$值。然后，推导一个修正后的大样本检验统计量，该统计量将差分隐私引起的噪声方差纳入零假设下的方差中。最后，根据以下具体发布数据计算修正后的检验统计量：\n- $n = 800$名患者，\n- $p_{0} = 0.12$，\n- $b = 5$，\n- 发布的计数$\\tilde{C} = 118.5$，\n\n并报告修正后的检验统计量的值。将你的数值答案四舍五入至四位有效数字。最终答案无需单位。", "solution": "首先，让我们建立一个经典的比例问题大样本$z$检验的框架。在零假设$H_{0}: p = p_{0}$下，真实病例数$C$服从二项分布，$C \\sim \\mathrm{Binomial}(n, p_{0})$。对于大的$n$，该分布可以很好地近似为正态分布，$C \\approx \\mathrm{Normal}(\\mu_{C}, \\sigma_{C}^{2})$，其中均值为$\\mu_{C} = \\mathrm{E}[C] = np_{0}$，方差为$\\sigma_{C}^{2} = \\mathrm{Var}(C) = np_{0}(1-p_{0})$。标准的检验统计量是通过对观测到的计数$C$进行标准化来构建的：\n$$ Z = \\frac{C - \\mathrm{E}[C]}{\\sqrt{\\mathrm{Var}(C)}} = \\frac{C - np_{0}}{\\sqrt{np_{0}(1-p_{0})}} $$\n这等价于使用样本比例$\\hat{p} = C/n$的更常见的形式：\n$$ Z = \\frac{\\hat{p} - p_{0}}{\\sqrt{p_{0}(1-p_{0})/n}} $$\n\n现在，考虑将此检验草率地应用于发布的差分隐私计数$\\tilde{C}$。这种草率的方法会将$\\tilde{C}$代入标准公式中的$C$，或者等效地，使用含噪声的比例$\\tilde{p} = \\tilde{C}/n$代替$\\hat{p}$。这会产生一个草率的检验统计量：\n$$ Z_{\\text{naive}} = \\frac{\\tilde{C} - np_{0}}{\\sqrt{np_{0}(1-p_{0})}} $$\n这种构造的缺陷在于分子中的随机变量与分母中用于标准化的方差不匹配。分子$\\tilde{C} - np_{0}$包含来自两个独立来源的变异性：原始抽样过程（$C$的变异性）和添加的拉普拉斯噪声（$\\eta$的变异性）。然而，分母$\\sqrt{np_{0}(1-p_{0})}$只考虑了真实计数$C$的方差。\n\n为了形式化地说明这一点，让我们分析含噪声计数$\\tilde{C} = C + \\eta$的方差。由于$C$和$\\eta$被规定为独立的，它们的和的方差等于它们各自方差的和：\n$$ \\mathrm{Var}(\\tilde{C}) = \\mathrm{Var}(C + \\eta) = \\mathrm{Var}(C) + \\mathrm{Var}(\\eta) $$\n在零假设$H_{0}$下，我们有$\\mathrm{Var}(C) = np_{0}(1-p_{0})$。问题陈述中说明噪声$\\eta \\sim \\mathrm{Laplace}(0, b)$的方差为$\\mathrm{Var}(\\eta) = 2b^{2}$。因此，在$H_{0}$下，含噪声计数的真实方差是：\n$$ \\mathrm{Var}_{H_{0}}(\\tilde{C}) = np_{0}(1-p_{0}) + 2b^{2} $$\n草率的检验统计量错误地使用$\\sqrt{np_{0}(1-p_{0})}$作为标准误，而这个值严格小于真实的标准误$\\sqrt{np_{0}(1-p_{0}) + 2b^{2}}$。在分母中使用一个被低估的方差会人为地增大检验统计量$|Z_{\\text{naive}}|$的绝对值。这会导致对统计显著性的高估、计算出的$p$值偏小，以及增加犯第一类错误的概率（即在零假设为真时错误地拒绝它）。\n\n为了推导一个修正后的大样本检验统计量，我们必须使用其在零假设下的正确均值和标准差来对观测值$\\tilde{C}$进行标准化。在$H_{0}$下，$\\tilde{C}$的期望值为：\n$$ \\mathrm{E}_{H_{0}}[\\tilde{C}] = \\mathrm{E}[C + \\eta] = \\mathrm{E}[C] + \\mathrm{E}[\\eta] = np_{0} + 0 = np_{0} $$\n如上所述，在$H_{0}$下$\\tilde{C}$的方差为$\\mathrm{Var}_{H_{0}}(\\tilde{C}) = np_{0}(1-p_{0}) + 2b^{2}$。对于大样本检验，我们将$\\tilde{C}$的抽样分布近似为具有此均值和方差的正态分布。因此，修正后的检验统计量$Z_{\\text{corr}}$为：\n$$ Z_{\\text{corr}} = \\frac{\\tilde{C} - \\mathrm{E}_{H_{0}}[\\tilde{C}]}{\\sqrt{\\mathrm{Var}_{H_{0}}(\\tilde{C})}} = \\frac{\\tilde{C} - np_{0}}{\\sqrt{np_{0}(1-p_{0}) + 2b^{2}}} $$\n该统计量恰当地考虑了两种随机性来源：二项抽样和加性拉普拉斯噪声。\n\n最后，我们使用提供的数据计算修正后的检验统计量的值：$n = 800$，$p_{0} = 0.12$，$b = 5$，以及观测到的发布计数$\\tilde{C} = 118.5$。\n\n首先，我们计算零假设下的期望计数：\n$$ \\mathrm{E}_{H_{0}}[\\tilde{C}] = np_{0} = 800 \\times 0.12 = 96 $$\n接下来，我们计算方差的两个组成部分：\n来自二项过程的方差是：\n$$ \\sigma_{C}^{2} = np_{0}(1-p_{0}) = 800 \\times 0.12 \\times (1 - 0.12) = 96 \\times 0.88 = 84.48 $$\n来自拉普拉斯噪声的方差是：\n$$ \\sigma_{\\eta}^{2} = 2b^{2} = 2 \\times 5^{2} = 2 \\times 25 = 50 $$\n零假设下的总方差是这两个分量的和：\n$$ \\mathrm{Var}_{H_{0}}(\\tilde{C}) = \\sigma_{C}^{2} + \\sigma_{\\eta}^{2} = 84.48 + 50 = 134.48 $$\n检验统计量的分子是观测计数与期望计数之差：\n$$ \\tilde{C} - np_{0} = 118.5 - 96 = 22.5 $$\n现在我们可以计算修正后的检验统计量：\n$$ Z_{\\text{corr}} = \\frac{22.5}{\\sqrt{134.48}} \\approx \\frac{22.5}{11.596551} \\approx 1.939912 $$\n将结果四舍五入至四位有效数字，得到$1.940$。", "answer": "$$\\boxed{1.940}$$", "id": "4835490"}]}