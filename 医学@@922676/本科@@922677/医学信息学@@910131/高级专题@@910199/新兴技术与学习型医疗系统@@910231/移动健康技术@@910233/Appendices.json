{"hands_on_practices": [{"introduction": "在移动健康 (mHealth) 技术领域，持续的数据监测能力是其核心优势，但这直接受到了移动设备最基本的物理限制——电池续航。本练习将引导你从最基本的电学原理出发，分析一项关键的功耗管理策略：占空比循环。通过这个实践，你将学习如何量化计算算法决策（例如，传感器是持续开启还是间歇性工作）对设备运行寿命的直接影响，深刻理解在数据采集密度与设备续航能力之间进行权衡的工程现实 [@problem_id:4848914]。", "problem": "一款移动健康（mHealth）应用程序在一台额定电池容量为 $3000\\,\\mathrm{mAh}$ 的智能手机上，以 $50\\,\\mathrm{Hz}$ 的采样频率持续收集三轴加速度计数据。当加速度计处于活动状态且数据在屏幕关闭的情况下于后台处理时，由该传感和处理工作负载产生的设备总平均电流为 $20\\,\\mathrm{mA}$；当加速度计处于非活动状态时，该工作负载产生的电流为 $0\\,\\mathrm{mA}$。假设对于本分析，其他系统负载可以忽略不计，自放电和电压依赖性也可以忽略，并且占空比 $d$ 是加速度计工作负载处于活动状态的时间所占的比例。仅使用“以安培小时为单位的电池容量代表可用电荷”和“电流是单位时间内的电荷量”这两个核心定义，推导出平均电流作为占空比的函数，以及相应的以小时为单位的电池续航时间。然后，通过计算定义为 $\\phi = \\dfrac{T(d=0.25)}{T(d=1)}$ 的乘法变化因子 $\\phi$，评估将占空比从连续运行（$d=1$）降低到 $d=0.25$ 的效果，其中 $T(\\cdot)$ 是以小时为单位的电池续航时间。将最终答案表示为一个无单位的纯数，并四舍五入到四位有效数字。", "solution": "首先将对问题的科学正确性、一致性和适定性进行验证。\n\n### 步骤1：提取已知条件\n-   采样频率：$50\\,\\mathrm{Hz}$\n-   电池容量，$C_{batt}$：$3000\\,\\mathrm{mAh}$\n-   活动工作负载（传感和处理）期间的电流，$I_{on}$：$20\\,\\mathrm{mA}$\n-   非活动工作负载期间的电流，$I_{off}$：$0\\,\\mathrm{mA}$\n-   占空比，$d$：加速度计工作负载处于活动状态的时间比例。\n-   假设：其他系统负载可忽略。\n-   假设：自放电和电压依赖性被忽略。\n-   定义：以安培小时为单位的电池容量代表可用电荷。\n-   定义：电流是单位时间内的电荷量。\n-   目标1：推导作为占空比函数的平均电流。\n-   目标2：推导相应的以小时为单位的电池续航时间。\n-   目标3：计算乘法变化因子 $\\phi = \\dfrac{T(d=0.25)}{T(d=1)}$，其中 $T(\\cdot)$ 是以小时为单位的电池续航时间。\n-   最终答案要求格式：四舍五入到四位有效数字的纯数。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n-   **科学性**：该问题基于电学的基本原理。电流被定义为电荷流动的速率（$I = \\frac{dQ}{dt}$），电池容量被视为可提供的总电荷量，这些都是基本电路理论的核心概念。所提供的值（电池容量为 $3000\\,\\mathrm{mAh}$，传感器工作负载电流为 $20\\,\\mathrm{mA}$）对于现代智能手机来说在物理上是现实的。$50\\,\\mathrm{Hz}$ 的采样频率在移动健康应用中是典型的。\n-   **适定性**：该问题是适定的。它提供了推导唯一解所需的所有必要数据和简化假设。目标陈述清晰，并且可以进行数学形式化。\n-   **客观性**：语言精确且无偏见。像“占空比”这样的术语得到了定义，并且假设被明确列出。\n-   **缺陷检查**：\n    1.  **科学/事实不健全**：无。问题遵循物理定律。\n    2.  **无法形式化/不相关**：问题是可形式化的，并且与移动健康技术的功耗分析直接相关，这是医学信息学中的一个关键课题。\n    3.  **不完整或矛盾的设置**：问题是自洽的。$50\\,\\mathrm{Hz}$ 的采样频率是背景信息，不会造成矛盾或信息不足，因为电流消耗是作为“传感和处理工作负载”的聚合值给出的。\n    4.  **不现实或不可行**：条件和数据是现实的。\n    5.  **不适定或结构不良**：问题结构良好，从第一性原理引导到一个具体的数值结果。\n    6.  **伪深刻、琐碎或同义反复**：问题是基本定义的直接应用，但并非琐碎，因为它需要正确地组合这些概念来对系统建模。\n    7.  **超出科学可验证性范围**：推理和结果可通过标准物理学原理进行验证。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供解答。\n\n### 解题推导\n问题要求基于电流和电荷的核心定义进行推导。设 $Q$ 为电荷， $t$ 为时间。电流 $I$ 是电荷的流动速率，即 $I = \\frac{dQ}{dt}$。对于恒定电流，在时间间隔 $\\Delta t$ 内传输的总电荷 $\\Delta Q$ 为 $\\Delta Q = I \\cdot \\Delta t$。\n\n电池容量以安培小时（$\\mathrm{Ah}$）或毫安小时（$\\mathrm{mAh}$）为单位，代表电池可以提供的总电荷 $C_{batt}$。已知 $C_{batt} = 3000\\,\\mathrm{mAh}$。\n\n工作负载是周期性的，由占空比 $d$ 来表征。设 $I_{on}$ 为工作负载活动时的电流， $I_{off}$ 为其非活动时的电流。\n-   $I_{on} = 20\\,\\mathrm{mA}$\n-   $I_{off} = 0\\,\\mathrm{mA}$\n\n平均电流 $I_{avg}$ 是两种状态下电流的加权平均值，其中权重是在每种状态下花费的时间比例。工作负载处于活动状态的时间比例为 $d$，处于非活动状态的时间比例为 $(1 - d)$。\n因此，作为占空比 $d$ 函数的平均电流为：\n$$I_{avg}(d) = d \\cdot I_{on} + (1 - d) \\cdot I_{off}$$\n代入给定值：\n$$I_{avg}(d) = d \\cdot (20\\,\\mathrm{mA}) + (1 - d) \\cdot (0\\,\\mathrm{mA})$$\n$$I_{avg}(d) = 20d\\,\\mathrm{mA}$$\n这是第一个要求的推导。\n\n接下来，我们推导电池续航时间 $T$，即电池电量耗尽前的总时间。假设设备以恒定的平均电流 $I_{avg}$ 运行，则在电池续航时间 $T$ 内消耗的总电荷为 $Q_{consumed} = I_{avg} \\cdot T$。当消耗的电荷等于电池容量时，电池电量耗尽，即 $Q_{consumed} = C_{batt}$。\n$$C_{batt} = I_{avg}(d) \\cdot T(d)$$\n求解电池续航时间 $T(d)$：\n$$T(d) = \\frac{C_{batt}}{I_{avg}(d)}$$\n代入 $C_{batt}$ 和 $I_{avg}(d)$ 的表达式：\n$$T(d) = \\frac{3000\\,\\mathrm{mAh}}{20d\\,\\mathrm{mA}} = \\frac{150}{d}\\,\\mathrm{h}$$\n这是第二个要求的推导。注意，$\\mathrm{mA}$ 单位相互抵消，剩下时间单位小时（$\\mathrm{h}$）。\n\n最后，我们必须计算乘法变化因子 $\\phi = \\dfrac{T(d=0.25)}{T(d=1)}$。\n首先，我们计算连续运行时（占空比 $d=1$）的电池续航时间：\n$$T(d=1) = \\frac{150}{1}\\,\\mathrm{h} = 150\\,\\mathrm{h}$$\n接下来，我们计算占空比降至 $d=0.25$ 时的电池续航时间：\n$$T(d=0.25) = \\frac{150}{0.25}\\,\\mathrm{h} = \\frac{150}{\\frac{1}{4}}\\,\\mathrm{h} = 150 \\cdot 4\\,\\mathrm{h} = 600\\,\\mathrm{h}$$\n\n现在，我们计算比率 $\\phi$：\n$$\\phi = \\frac{T(d=0.25)}{T(d=1)} = \\frac{600\\,\\mathrm{h}}{150\\,\\mathrm{h}}$$\n$$\\phi = 4$$\n或者，使用 $T(d)$ 的符号表达式：\n$$\\phi = \\frac{\\frac{150}{0.25}}{\\frac{150}{1}} = \\frac{1}{0.25} = 4$$\n问题要求答案表示为一个纯数，并四舍五入到四位有效数字。确切答案是整数 $4$。为了用四位有效数字表示，我们写作 $4.000$。", "answer": "$$\\boxed{4.000}$$", "id": "4848914"}, {"introduction": "移动健康系统不仅是数据收集工具，更是辅助临床决策的关键系统。本练习将带你探究一个在设计警报系统时至关重要的挑战：即使算法在技术指标上表现优异（如高灵敏度和特异度），在低患病率的真实场景中也可能产生大量的假警报。通过运用贝叶斯定理从头计算阳性预测值 (PPV)，你将能够定量地理解“警报疲劳”现象背后的统计学原理，这对于设计有效且能被临床医生信任的移动健康应用至关重要 [@problem_id:4848954]。", "problem": "一家医院部署了一套移动健康（mHealth）脓毒症预警系统，该系统将可穿戴传感器采集的生命体征数据流式传输到临床医生的智能手机上，并在怀疑发生脓毒症时生成一个二元警报。假设该病房的脓毒症患病率稳定在 $0.03$。该警报算法的灵敏度为 $0.85$，特异度为 $0.95$。使用第一性原理——即灵敏度和特异度作为条件概率的定义以及Bayes定理——从头推导阳性预测值（PPV）的表达式。阳性预测值（PPV）是在警报为阳性的条件下存在脓毒症的概率，记为 $\\Pr(\\text{sepsis} \\mid \\text{alert}+)$。然后根据给定的参数计算预期的PPV。仅基于计算出的PPV，并且不引入任何额外的经验性假设，解释在这种移动健康工作流程中，其对临床医生警报疲劳的影响。将PPV表示为一个无单位的小数，并将您的数值结果四舍五入到四位有效数字。", "solution": "本题要求从第一性原理出发，推导阳性预测值（PPV），并根据所给参数进行计算，最后在临床医生警报疲劳的背景下解释结果。验证过程确认了该问题具有科学依据、提法明确且客观。\n\n设 $S$ 表示患者患有脓毒症的事件，其补集 $S^c$ 表示患者没有患脓毒症的事件。设 $A$ 表示移动健康系统生成阳性警报（$\\text{alert}+$）的事件，其补集 $A^c$ 表示阴性警报。\n\n给定的参数可以转换成概率术语：\n1.  脓毒症的患病率，记为 $\\Pr(S)$，为 $0.03$。因此，不患脓毒症的概率为 $\\Pr(S^c) = 1 - \\Pr(S) = 1 - 0.03 = 0.97$。\n2.  警报算法的灵敏度，即在存在脓毒症的情况下出现阳性警报的条件概率，为 $\\Pr(A \\mid S) = 0.85$。这被称为真阳性率（TPR）。\n3.  算法的特异度，即在不存在脓毒症的情况下出现阴性警报的条件概率，为 $\\Pr(A^c \\mid S^c) = 0.95$。这被称为真阴性率（TNR）。\n\n目标量是阳性预测值（PPV），定义为在出现阳性警报的条件下存在脓毒症的概率，记为 $\\Pr(S \\mid A)$。\n\n**从第一性原理推导：**\n\n根据条件概率的定义，PPV由下式给出：\n$$\n\\Pr(S \\mid A) = \\frac{\\Pr(S \\cap A)}{\\Pr(A)}\n$$\n其中 $\\Pr(S \\cap A)$ 是患者患有脓毒症且系统发出阳性警报的联合概率。\n\n再次使用条件概率的定义，分子可以重新表示为：\n$$\n\\Pr(S \\cap A) = \\Pr(A \\mid S) \\Pr(S)\n$$\n该表达式直接使用了两个给定的量：灵敏度和患病率。\n\n分母 $\\Pr(A)$ 是收到阳性警报的总概率。这可以通过全概率公式来确定，该公式对患者的真实状态（有或没有脓毒症）进行边缘化：\n$$\n\\Pr(A) = \\Pr(A \\cap S) + \\Pr(A \\cap S^c)\n$$\n将条件概率的定义应用于右侧的两项，我们得到：\n$$\n\\Pr(A) = \\Pr(A \\mid S) \\Pr(S) + \\Pr(A \\mid S^c) \\Pr(S^c)\n$$\n第一项 $\\Pr(A \\mid S) \\Pr(S)$ 对应于真阳性警报。第二项 $\\Pr(A \\mid S^c) \\Pr(S^c)$ 对应于假阳性警报。\n\n项 $\\Pr(A \\mid S^c)$ 是假阳性率（FPR）。它没有直接给出，但可以从特异度推导出来。对于给定的条件，阳性警报（$A$）和阴性警报（$A^c$）的事件是互斥且穷尽的。因此，对于条件 $S^c$（无脓毒症）：\n$$\n\\Pr(A \\mid S^c) + \\Pr(A^c \\mid S^c) = 1\n$$\n这意味着假阳性率与真阴性率（特异度）互补：\n$$\n\\Pr(A \\mid S^c) = 1 - \\Pr(A^c \\mid S^c) = 1 - \\text{specificity}\n$$\n\n将所有这些表达式代入PPV的公式，我们得到从第一性原理推导出的完整表达式：\n$$\n\\text{PPV} = \\Pr(S \\mid A) = \\frac{\\Pr(A \\mid S) \\Pr(S)}{\\Pr(A \\mid S) \\Pr(S) + (1 - \\Pr(A^c \\mid S^c)) \\Pr(S^c)}\n$$\n用灵敏度（$Se$）、特异度（$Sp$）和患病率（$P$）表示：\n$$\n\\text{PPV} = \\frac{Se \\cdot P}{Se \\cdot P + (1 - Sp) \\cdot (1 - P)}\n$$\n此推导完成了任务的第一部分。\n\n**计算预期的PPV：**\n\n现在，我们将给定的数值代入推导出的公式中：\n- 患病率, $P = \\Pr(S) = 0.03$\n- 灵敏度, $Se = \\Pr(A \\mid S) = 0.85$\n- 特异度, $Sp = \\Pr(A^c \\mid S^c) = 0.95$\n\n无脓毒症的概率为 $1 - P = 1 - 0.03 = 0.97$。\n假阳性率为 $1 - Sp = 1 - 0.95 = 0.05$。\n\n分子是真阳性的概率：\n$$\nSe \\cdot P = 0.85 \\times 0.03 = 0.0255\n$$\n假阳性的概率为：\n$$\n(1 - Sp) \\cdot (1 - P) = 0.05 \\times 0.97 = 0.0485\n$$\n警报的总概率 $\\Pr(A)$ 是真阳性概率和假阳性概率之和：\n$$\n\\Pr(A) = 0.0255 + 0.0485 = 0.0740\n$$\n最后，PPV是真阳性概率与总警报概率的比值：\n$$\n\\text{PPV} = \\frac{0.0255}{0.0740} = \\frac{255}{740} = \\frac{51}{148} \\approx 0.34459459...\n$$\n四舍五入到四位有效数字，预期的PPV为 $0.3446$。\n\n**对临床医生警报疲劳的影响：**\n\n计算出的阳性预测值（PPV）约为 $0.3446$。该值表示在移动健康系统生成阳性警报的情况下，患者患有脓毒症的后验概率。该PPV的直接含义是，对于任何给定的警报，其为真阳性（即患者确实患有脓毒症）的概率仅为 $34.46\\%$。\n\n反之，一个警报为假阳性的概率由 $1 - \\text{PPV}$ 给出：\n$$\n\\Pr(S^c \\mid A) = 1 - \\Pr(S \\mid A) \\approx 1 - 0.3446 = 0.6554\n$$\n这意味着系统生成的大约 $65.54\\%$ 的警报是假警报。在临床工作流程中，这意味着临床医生接到潜在脓毒症病例的通知后，却发现近三分之二的情况下患者并无大碍。\n\n这种高假警报率是导致临床医生警报疲劳的主要原因。当大多数警报都是非行动性的时，临床医生可能会对它们变得不敏感或习惯。这可能导致他们的反应能力下降，从而忽略、覆盖或延迟对后续警报的反应。这种现象的严重后果是，一个真阳性警报——代表一个真实的、时间敏感的脓毒症病例——可能会被错过或处理得太慢，从而破坏了整个预警系统的初衷，并可能导致不良的患者后果。因此，尽管具有高灵敏度（$85\\%$）和高特异度（$95\\%$），但该疾病相对较低的患病率导致PPV低得有问题，从而产生了一个极易诱发警报疲劳的工作流程。", "answer": "$$\n\\boxed{0.3446}\n$$", "id": "4848954"}, {"introduction": "从移动健康设备收集的真实世界数据往往是不完美的，数据缺失是分析过程中普遍存在的问题。本练习将你的技能从处理理想数据提升到诊断和应对数据不完整性的关键能力。你将学习区分三种核心的缺失机制——完全随机缺失 (MCAR)、随机缺失 (MAR) 和非随机缺失 (MNAR)——并为每种情况选择恰当的统计处理策略。正确理解数据为何会缺失，是避免在移动健康研究中得出有偏见的结论、确保分析结果有效性的第一步 [@problem_id:4848950]。", "problem": "一位研究者正在分析来自医疗信息学领域一款移动健康（mHealth）应用的每日时间序列数据。对于每一天 $t \\in \\{1,\\dots,T\\}$，该应用会尝试收集以下变量：步数 $s_t$、心率变异性 $h_t$ (Heart Rate Variability (HRV))，以及自我报告的情绪 $m_t$（范围从1到10）。设 $R_t$ 为情绪数据的缺失指示变量，如果 $m_t$ 被观测到，则 $R_t=1$；如果 $m_t$ 缺失，则 $R_t=0$。考虑三种可能决定 $R_t$ 的、截然不同且貌似合理的用户参与动态：\n\n场景1：随机的云服务中断独立于用户行为和生理状况发生。在某些天， $m_t$ 无法同步完全是由于后端问题，与 $s_t$、$h_t$、$m_t$、日历或过去的应用使用情况无关。中断时间在研究期间内均匀分布。\n\n场景2：输入情绪的概率取决于可观察到的用户参与情境。具体来说，用户在周末和连续几天应用打开次数较少之后，打开应用的可能性较低。设 $W_t$ 为周末指示变量（周六/周日 $W_t=1$，否则 $W_t=0$），$A_{t-1}$ 为第 $t-1$ 天的应用打开次数；$W_t$ 和 $A_{t-1}$ 都是完全观测到的。根据经验，$P(R_t=1)$ 在 $W_t=1$ 时和 $A_{t-1}$ 较小时较低，但在给定 $W_t$ 和 $A_{t-1}$ 的情况下，它不再依赖于当前未观测到的情绪 $m_t$。\n\n场景3：用户在感觉较差时倾向于不报告情绪。输入情绪的概率取决于当前情绪值本身：当 $m_t$ 较低时，即使在对所有观测变量（包括 $s_t$、$h_t$、$W_t$ 以及过去的值 $\\{m_{t-1}, s_{t-1}, h_{t-1}, A_{t-1}\\}$）进行条件化之后，$P(R_t=1)$ 仍然会降低。\n\n选择一个选项，该选项能正确地将每种场景下 $R_t$ 的缺失机制分类为完全随机缺失（MCAR）、随机缺失（MAR）或非随机缺失（MNAR），并为其匹配一种在每日时间序列设置下适用于该机制的 $m_t$ 插补方法：\n\nA. 场景1：MCAR；使用时间序列插值法（例如，一个带有 Kalman 平滑的状态空间模型，它从 $m_{t-1}$ 和 $m_{t+1}$ 中借用信息）来插补 $m_t$，而无需对 $R_t$ 建模。场景2：MAR；使用带观测预测变量（$W_t$、$A_{t-1}$、$s_t$、$h_t$ 和过去的 $m$）的条件多重插补法来插补 $m_t$，从诸如贝叶斯回归（Bayesian regression）或链式方程多重插补（Multiple Imputation by Chained Equations, MICE）等模型中抽样。场景3：MNAR；通过联合建模数据和缺失机制（例如，将 $R_t$ 与 $m_t$ 联系起来的选择模型或模式混合模型）来插补 $m_t$，并对不可识别的参数进行敏感性分析。\n\nB. 场景1：MAR；使用对所有观测到的 $m_t$ 进行简单均值插补。场景2：MNAR；通过完整案例分析（删除所有 $R_t=0$ 的天）来处理。场景3：MCAR；使用忽略缺失过程的 Kalman 平滑器来插补 $m_t$。\n\nC. 场景1：MCAR；仅通过完整案例分析处理（不插补，只分析 $R_t=1$ 的天）。场景2：MAR；使用末次观测值结转（LOCF）法插补 $m_t$，而不以 $W_t$、$A_{t-1}$、$s_t$ 或 $h_t$ 为条件。场景3：MNAR；使用标准多重插补法来插补 $m_t$，该方法仅以观测到的协变量为条件，并假设缺失不依赖于 $m_t$。\n\nD. 场景1：MNAR；通过 $m_t$ 和 $R_t$ 的联合模型来插补 $m_t$。场景2：MCAR；使用无条件线性插值法来插补 $m_t$。场景3：MAR；使用一个忽略 $W_t$ 和 $A_{t-1}$ 且仅依赖于过去 $m$ 值的模型来插补 $m_t$。", "solution": "该问题要求根据完全随机缺失（MCAR）、随机缺失（MAR）和非随机缺失（MNAR）的标准分类法，对三种缺失数据场景进行分类，并为每种场景确定一种合适的插补策略。\n\n首先，让我们形式化定义缺失数据机制。设 $Y$ 代表完整数据集，它可以被划分为观测部分 $Y_{obs}$ 和缺失部分 $Y_{mis}$。设 $R$ 是一个二元指示变量矩阵，如果 $Y$ 中相应的数据点被观测到，则其元素为1，如果缺失则为0。在这个问题中，存在缺失的变量是情绪 $m_t$，因此我们关心的是 $m_t$ 的缺失指示变量 $R_t$。在时间 $t$ 完全观测到的变量集合包括步数 $s_t$、心率变异性 $h_t$、周末指示变量 $W_t$ 和前一天的应用打开次数 $A_{t-1}$。过去的观测值也是可用的。\n\n1.  **完全随机缺失 (MCAR)**：一个值缺失的概率与观测到的和未观测到的数据值都无关。形式上，缺失的分布不依赖于完整数据 $Y$：\n    $$P(R | Y) = P(R)$$\n    在我们的特定情境中，对于 $m_t$ 的缺失：\n    $$P(R_t=1 | \\{m_j\\}_{j=1}^T, \\{s_j\\}_{j=1}^T, \\{h_j\\}_{j=1}^T, \\dots) = P(R_t=1)$$\n\n2.  **随机缺失 (MAR)**：一个值缺失的概率仅依赖于观测到的数据，而不依赖于未观测到的数据。形式上：\n    $$P(R | Y) = P(R | Y_{obs})$$\n    对于 $m_t$ 的缺失，这意味着观测到 $m_t$ 的概率可以依赖于任何其他观测变量（例如，$s_t, h_t, W_t, A_{t-1}, m_{t-1}$ 如果被观测到），但在以观测数据为条件后，不依赖于 $m_t$ 本身的值：\n    $$P(R_t=1 | m_t, Y_{obs}) = P(R_t=1 | Y_{obs})$$\n    其中 $Y_{obs}$ 包括在时间 $t$ 和其他时间所有观测到的数据。\n\n3.  **非随机缺失 (MNAR)**：一个值缺失的概率依赖于该缺失变量本身的值，即使在考虑了所有观测信息之后也是如此。\n    $$P(R | Y) \\neq P(R | Y_{obs})$$\n    对于 $m_t$ 的缺失：\n    $$P(R_t=1 | m_t, Y_{obs}) \\neq P(R_t=1 | Y_{obs})$$\n    这也被称为不可忽略的缺失机制。\n\n现在，我们将分析问题陈述中描述的三种场景。\n\n**场景1分析**：\n问题陈述 $m_t$ 的缺失是由于“随机的云服务中断...独立于用户行为和生理状况”。中断“与 $s_t$、$h_t$、$m_t$、日历或过去的应用使用情况无关”。这明确指出缺失概率 $P(R_t=0)$ 与数据集中的所有变量（无论是观测到的还是未观测到的）都无关。这是 **MCAR** 的定义。\n对于 MCAR 下的插补，可以忽略缺失机制。由于数据是时间序列，利用时间结构的方法通常优于简单的均值插补等方法。时间序列插值，例如使用带有 Kalman 平滑器的状态空间模型框架，是一种统计上复杂且合适的方法。它利用时间上相邻的观测值（例如 $m_{t-1}$ 和 $m_{t+1}$）的信息，为缺失的 $m_t$ 生成一个有原则的估计，从而保留序列的潜在动态。\n\n**场景2分析**：\n问题陈述报告情绪的概率 $P(R_t=1)$“取决于可观察到的用户参与情境”，特别是周末指示变量 $W_t$ 和前一天的应用打开次数 $A_{t-1}$。$W_t$ 和 $A_{t-1}$ 都是完全观测到的。关键细节是，“在给定 $W_t$ 和 $A_{t-1}$ 的情况下，它不再依赖于当前未观测到的情绪 $m_t$”。这意味着 $m_t$ 的缺失概率依赖于其他观测变量（$W_t$、$A_{t-1}$），但不依赖于 $m_t$ 本身的值。这是 **MAR** 的定义。\n在 MAR 下，如果分析或插补模型以预测缺失的变量为条件，则缺失机制被认为是可忽略的。因此，一个合适的插补策略必须将 $W_t$ 和 $A_{t-1}$（以及可能相关的其他变量，如 $s_t$、$h_t$ 和 $m_t$ 的过去值）作为插补模型中的预测变量。条件多重插补方法，如链式方程多重插补（MICE）或贝叶斯回归模型，就是为此目的设计的。它们通过从条件分布 $P(m_t | W_t, A_{t-1}, s_t, h_t, \\dots)$ 中抽样来创建多个貌似合理的插补数据集，从而恰当地考虑了插补的不确定性。\n\n**场景3分析**：\n问题陈述“输入情绪的概率取决于当前情绪值本身：当 $m_t$ 较低时，即使在对所有观测变量进行条件化之后，$P(R_t=1)$ 仍然会降低”。这意味着 $m_t$ 的缺失概率是未观测值 $m_t$ 的函数。这是 **MNAR** 的定义。\n在 MNAR 下，缺失机制是不可忽略的。假设 MAR 的标准插补技术是有偏的，因为它们没有考虑到缺失对未观测值的依赖性。正确处理 MNAR 数据需要明确地对这种依赖性进行建模。这通常通过数据（$m_t$）和缺失机制（$R_t$）的联合模型来完成。常见的方法包括选择模型（将联合分布分解为 $P(m_t, R_t) = P(m_t) P(R_t | m_t)$）和模式混合模型（将其分解为 $P(m_t, R_t) = P(R_t) P(m_t | R_t)$）。由于 $R_t$ 和 $m_t$ 之间依赖关系的具体形式通常是未知的，并且无法仅从观测数据中验证（一个可识别性问题），任何此类分析都必须伴随敏感性分析，以评估在对缺失模型做出不同合理假设下，最终结论会如何变化。\n\n基于此分析，我们评估所提供的选项。\n\n**选项 A**：\n- **场景1**：分类为 **MCAR**。建议使用时间序列插值（Kalman 平滑器）进行插补，而无需对 $R_t$ 建模。这是正确的。分类准确，且该方法对于 MCAR 下的时间序列数据是复杂且合适的。\n- **场景2**：分类为 **MAR**。建议使用带观测预测变量（$W_t, A_{t-1}, s_t, h_t$ 等）的条件多重插补（MICE，贝叶斯回归）。这是正确的。分类准确，这是处理 MAR 的标准、先进方法。\n- **场景3**：分类为 **MNAR**。建议进行联合建模（选择模型或模式混合模型）并伴随敏感性分析。这是正确的。分类准确，这是处理不可忽略的 MNAR 数据所需的严谨统计方法。\n**结论**：**正确**。该选项的所有三个部分都提供了正确的分类，并为其匹配了统计上合理且适当的方法。\n\n**选项 B**：\n- **场景1**：分类为 **MAR**。这是不正确的；该场景是 MCAR。\n- **场景2**：分类为 **MNAR**。这是不正确的；该场景是 MAR。\n- **场景3**：分类为 **MCAR**。这是不正确的；该场景是 MNAR。\n**结论**：**不正确**。所有三个场景的分类都是错误的。\n\n**选项 C**：\n- **场景1**：分类为 **MCAR**。这是正确的。它建议进行完整案例分析。虽然完整案例分析在 MCAR 下是无偏的，但效率低下，因为它丢弃了数据，降低了统计功效。插补通常是最大化利用可用信息的更合适策略。\n- **场景2**：分类为 **MAR**。这是正确的。它建议使用末次观测值结转（LOCF）。LOCF 是一种简单的单次插补方法，因其人为地减小方差和扭曲时间关系而广受批评。更重要的是，该选项明确指出这样做时“不以 $W_t, A_{t-1}, s_t$, 或 $h_t$ 为条件”。对于 MAR，如果不以预测缺失的变量为条件，将导致有偏的结果。因此，建议的方法是不合适的。\n- **场景3**：分类为 **MNAR**。这是正确的。它建议“使用标准多重插补，该方法仅以观测到的协变量为条件，并假设缺失不依赖于 $m_t$”。这描述的是一种适用于 MAR 而非 MNAR 的方法。将基于 MAR 的方法应用于 MNAR 数据是不正确的，并且会产生有偏的估计。\n**结论**：**不正确**。虽然一些分类是正确的，但为场景2和3提出的方法存在根本性缺陷，不适用于各自的缺失机制。\n\n**选项 D**：\n- **场景1**：分类为 **MNAR**。这是不正确的；该场景是 MCAR。\n- **场景2**：分类为 **MCAR**。这是不正确的；该场景是 MAR。\n- **场景3**：分类为 **MAR**。这是不正确的；该场景是 MNAR。\n**结论**：**不正确**。所有三个场景的分类都是错误的。\n\n总之，选项A是唯一一个能正确分类所有三个场景，并为每个场景提出统计上有效且适当的处理策略的选项。", "answer": "$$\\boxed{A}$$", "id": "4848950"}]}