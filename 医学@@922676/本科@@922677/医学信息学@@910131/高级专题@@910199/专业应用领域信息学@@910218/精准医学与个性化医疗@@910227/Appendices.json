{"hands_on_practices": [{"introduction": "现代生物学在寻找致病基因时会产生海量数据，并进行数千次统计检验。这种大规模检验增加了假阳性发现的风险，即所谓的多重检验问题。本练习 [@problem_id:4852814] 将指导你应用 Benjamini-Hochberg 程序，这是一种控制伪发现率（FDR）的强大方法，能帮助你从高维数据中筛选出统计上可靠的结果。", "problem": "一项精准肿瘤学研究使用核糖核酸测序（RNA-seq）来分析患者肿瘤中的基因表达谱，以识别其表达水平与靶向治疗反应相关的基因。独立检验每个基因会产生许多假设检验。在这种高维设置中，请解释为什么进行许多假设检验会增加至少出现一个假阳性的机会，以及在优先选择候选生物标志物进行后续研究时，为什么控制错误发现率（FDR）通常比控制族系错误率（FWER）更可取。然后，使用一种在独立性假设下将FDR控制在目标水平$q$的标准升阶法，确定数据驱动的$p$值截断值（即，在被拒绝的假设中最大的$p$值）以宣告统计显著性。\n\n假设该研究测试了$m = 18$个基因，并获得了以下一组$p$值（未排序）：$\\{0.062,\\ 0.021,\\ 0.0087,\\ 0.055,\\ 0.0012,\\ 0.026,\\ 0.0168,\\ 0.047,\\ 0.039,\\ 0.0125,\\ 0.0102,\\ 0.091,\\ 0.0025,\\ 0.0006,\\ 0.006,\\ 0.033,\\ 0.078,\\ 0.0041\\}$。使用Benjamini–Hochberg（BH）程序将FDR控制在$q = 0.05$的水平，并报告由此产生的$p$值截断值，结果应为一个无单位的纯数。无需四舍五入。", "solution": "该问题需要一个分为两部分的解释，然后进行计算。\n\n首先，解释为什么进行许多假设检验会增加至少出现一个假阳性的机会。\n设$\\alpha$为单次假设检验的显著性水平，它代表当原假设为真时犯I类错误（假阳性）的概率。一个典型的值是$\\alpha = 0.05$。因此，正确地不拒绝一个真实原假设的概率是$1 - \\alpha$。如果我们进行$m$次独立的假设检验，那么在所有检验中都不犯I类错误的概率是$(1 - \\alpha)^m$。犯至少一个I类错误的概率，即族系错误率（FWER），是该事件的补集：\n$$\n\\text{FWER} = 1 - (1 - \\alpha)^m\n$$\n对于给定的问题，有$m = 18$个基因，每次检验的显著性水平为$\\alpha = 0.05$，在没有任何校正的情况下，FWER将是：\n$$\n\\text{FWER} = 1 - (1 - 0.05)^{18} = 1 - (0.95)^{18} \\approx 1 - 0.3972 = 0.6028\n$$\n这意味着观察到至少一个假阳性结果的几率超过$60\\%$，这与期望的$5\\%$水平相比急剧膨胀。当$m$变得很大时（这在基因组学中很常见，通常会测试成千上万个基因），这个概率迅速接近1，使得假阳性几乎是必然的。\n\n其次，解释为什么在生物标志物发现中，控制错误发现率（FDR）通常比控制FWER更可取。\nFWER控制的目标是使在所有检验中哪怕只出现一个假阳性的概率非常低（例如，$\\le \\alpha$）。这是一个非常严格的标准。控制FWER的方法，如Bonferroni校正（它使用$\\alpha/m$的显著性阈值），非常保守。虽然它们有效地减少了假阳性，但它们也严重降低了统计功效，这意味着它们更有可能错过真实效应（即，它们增加了假阴性的比率）。在像生物标志物发现这样的探索性设置中，主要目标是生成一个有希望的候选者列表，以进行更严格（且通常更昂贵）的进一步验证。假阴性的代价（错过一个可能拯救生命的生物标志物）可能非常高。\n\n相比之下，FDR控制则不那么严格。FDR被定义为被拒绝的假设中实际上是错误拒绝（假阳性）的期望比例。\n$$\n\\text{FDR} = E\\left[\\frac{V}{R} | R > 0\\right]P(R>0)\n$$\n其中$V$是假阳性的数量（被错误拒绝的真实原假设），$R$是被拒绝的原假设总数。将FDR控制在一个水平$q$（例如，$q=0.05$）意味着，平均而言，在被宣布为显著的基因中，预计不超过$5\\%$是假阳性。这种方法容忍发现列表中的一小部分假阳性，以换取检测真实效应的显著更高的功效。这种权衡在高维发现科学中通常是可取的，因为它会生成一个更丰富的候选列表以供后续研究，而这些后续研究旨在筛选掉假阳性。\n\n最后，我们应用Benjamini–Hochberg（BH）程序来找到数据驱动的p值截断值。该程序在$m = 18$次独立检验中将FDR控制在$q = 0.05$的水平。\n\n第1步：将$m=18$个p值按升序排序，记为$P_{(i)}$，其中$i=1, \\dots, 18$。\n提供的集合是 $\\{0.062, 0.021, 0.0087, 0.055, 0.0012, 0.026, 0.0168, 0.047, 0.039, 0.0125, 0.0102, 0.091, 0.0025, 0.0006, 0.006, 0.033, 0.078, 0.0041\\}$。\n排序后的p值$P_{(i)}$是：\n$P_{(1)} = 0.0006$\n$P_{(2)} = 0.0012$\n$P_{(3)} = 0.0025$\n$P_{(4)} = 0.0041$\n$P_{(5)} = 0.006$\n$P_{(6)} = 0.0087$\n$P_{(7)} = 0.0102$\n$P_{(8)} = 0.0125$\n$P_{(9)} = 0.0168$\n$P_{(10)} = 0.021$\n$P_{(11)} = 0.026$\n$P_{(12)} = 0.033$\n$P_{(13)} = 0.039$\n$P_{(14)} = 0.047$\n$P_{(15)} = 0.055$\n$P_{(16)} = 0.062$\n$P_{(17)} = 0.078$\n$P_{(18)} = 0.091$\n\n第2步：找到满足$P_{(k)} \\le \\frac{k}{m}q$的最大索引$k$。\n这里，$m=18$且$q=0.05$。条件是$P_{(k)} \\le \\frac{k}{18}(0.05)$。我们对每个$i$检查这个条件：\n对于 $i=1$: $P_{(1)} = 0.0006 \\le \\frac{1}{18}(0.05) \\approx 0.00278$。条件成立。\n对于 $i=2$: $P_{(2)} = 0.0012 \\le \\frac{2}{18}(0.05) \\approx 0.00556$。条件成立。\n对于 $i=3$: $P_{(3)} = 0.0025 \\le \\frac{3}{18}(0.05) \\approx 0.00833$。条件成立。\n对于 $i=4$: $P_{(4)} = 0.0041 \\le \\frac{4}{18}(0.05) \\approx 0.01111$。条件成立。\n对于 $i=5$: $P_{(5)} = 0.006 \\le \\frac{5}{18}(0.05) \\approx 0.01389$。条件成立。\n对于 $i=6$: $P_{(6)} = 0.0087 \\le \\frac{6}{18}(0.05) \\approx 0.01667$。条件成立。\n对于 $i=7$: $P_{(7)} = 0.0102 \\le \\frac{7}{18}(0.05) \\approx 0.01944$。条件成立。\n对于 $i=8$: $P_{(8)} = 0.0125 \\le \\frac{8}{18}(0.05) \\approx 0.02222$。条件成立。\n对于 $i=9$: $P_{(9)} = 0.0168 \\le \\frac{9}{18}(0.05) = 0.025$。条件成立。\n对于 $i=10$: $P_{(10)} = 0.021 \\le \\frac{10}{18}(0.05) \\approx 0.02778$。条件成立。\n对于 $i=11$: $P_{(11)} = 0.026 \\le \\frac{11}{18}(0.05) \\approx 0.03056$。条件成立。\n对于 $i=12$: $P_{(12)} = 0.033 \\le \\frac{12}{18}(0.05) \\approx 0.03333$。条件成立。\n对于 $i=13$: $P_{(13)} = 0.039 > \\frac{13}{18}(0.05) \\approx 0.03611$。条件不成立。\n\n满足条件的最大索引$k$是$k = 12$。\n\n第3步：确定截断值。\nBH程序拒绝所有原假设$H_{(i)}$，其中$i = 1, \\dots, k$。在这种情况下，我们拒绝对应于12个最小p值的原假设。用于宣告显著性的数据驱动p值截断值是被拒绝的那些p值中最大的一个，即$P_{(k)}$。\n因此，截断值是$P_{(12)} = 0.033$。任何小于或等于此值的原始p值都被宣布为统计显著的。", "answer": "$$\\boxed{0.033}$$", "id": "4852814"}, {"introduction": "开发预测模型是实现个性化医疗的关键一步，但我们如何客观地衡量其性能？一个好的模型不仅要能区分高风险和低风险个体，其预测的风险值也必须准确。在此实践中 [@problem_id:4852815]，你将学习计算曲线下面积（AUC）、校准斜率和 Brier 分数等基本指标，从而全面评估一个模型的实用价值。", "problem": "一个临床决策支持系统为二元结果（例如，在$30$天内发生药物不良反应）生成个体化风险评估，为精准医疗和个性化医疗保健提供信息。对于$n=6$名患者，模型输出的预测概率$\\hat{p}_i$和观测结果$y_i \\in \\{0,1\\}$如下：患者1：$\\hat{p}_1=0.12$，$y_1=0$；患者2：$\\hat{p}_2=0.18$，$y_2=0$；患者3：$\\hat{p}_3=0.33$，$y_3=1$；患者4：$\\hat{p}_4=0.52$，$y_4=0$；患者5：$\\hat{p}_5=0.61$，$y_5=1$；患者6：$\\hat{p}_6=0.85$，$y_6=1$。\n\n使用适用于医学信息学中概率风险模型评估的基本定义：\n\n- 区分度（Discrimination）由受试者工作特征（ROC）曲线下面积（AUC）量化，经验上定义为随机选择的病例（$y=1$）的预测风险高于随机选择的对照（$y=0$）的概率，其中平局贡献二分之一。\n- 校准度（Calibration）由在平方误差损失下从最小二乘线性校准模型获得的截距和斜率来概括，其中 $y$ 在 $1$ 和 $\\hat{p}$ 上的最佳线性投影最小化 $\\sum_{i=1}^{n}(y_i - \\alpha - \\beta \\hat{p}_i)^{2}$。校准截距 $\\alpha$ 和校准斜率 $\\beta$ 是该投影的系数。\n- 在平方误差损失下的总体性能由布里尔分数（Brier score）衡量，定义为 $\\frac{1}{n}\\sum_{i=1}^{n}(\\hat{p}_i - y_i)^{2}$。\n\n从这些定义和第一性原理（AUC的概率一致性、最小二乘校准的法方程以及布里尔分数的均方误差）出发，计算给定数据的AUC、校准截距 $\\alpha$、校准斜率 $\\beta$ 和布里尔分数。将每个指标四舍五入到四位有效数字。将您的最终答案以单行矩阵的形式报告，依次包含AUC、校准截距、校准斜率和布里尔分数。不需要单位。", "solution": "该问题提供了$n=6$名患者的数据，包括来自风险模型的预测概率$\\hat{p}_i$和观测到的二元结果$y_i$。任务是计算三个性能指标：用于区分度的ROC曲线下面积（AUC），用于校准度的校准截距$\\alpha$和斜率$\\beta$，以及用于总体性能的布里尔分数。计算必须基于所提供的定义和第一性原理。\n\n给定数据为：\n- 患者 1：$\\hat{p}_1=0.12$, $y_1=0$\n- 患者 2：$\\hat{p}_2=0.18$, $y_2=0$\n- 患者 3：$\\hat{p}_3=0.33$, $y_3=1$\n- 患者 4：$\\hat{p}_4=0.52$, $y_4=0$\n- 患者 5：$\\hat{p}_5=0.61$, $y_5=1$\n- 患者 6：$\\hat{p}_6=0.85$, $y_6=1$\n\n首先，我们识别病例（事件发生患者，$y_i=1$）和对照（事件未发生患者，$y_i=0$）。\n- 病例：患者 3、5、6。其预测风险为 $\\{\\hat{p}_3, \\hat{p}_5, \\hat{p}_6\\} = \\{0.33, 0.61, 0.85\\}$。病例数为 $n_1=3$。\n- 对照：患者 1、2、4。其预测风险为 $\\{\\hat{p}_1, \\hat{p}_2, \\hat{p}_4\\} = \\{0.12, 0.18, 0.52\\}$。对照数为 $n_0=3$。\n\n**1. ROC曲线下面积 (AUC)**\n\nAUC定义为随机选择的病例比随机选择的对照具有更高预测风险的概率，其中平局贡献$0.5$。这等同于计算Wilcoxon-Mann-Whitney U统计量。我们构建所有可能的（病例，对照）对，并比较它们的预测风险。总对数为 $n_1 \\times n_0 = 3 \\times 3 = 9$。\n\n我们将比较结果制成表格：\n1.  对 $(\\hat{p}_3, \\hat{p}_1) = (0.33, 0.12)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n2.  对 $(\\hat{p}_3, \\hat{p}_2) = (0.33, 0.18)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n3.  对 $(\\hat{p}_3, \\hat{p}_4) = (0.33, 0.52)$：$\\hat{p}_{\\text{case}}  \\hat{p}_{\\text{control}}$。得分 = $0$。\n4.  对 $(\\hat{p}_5, \\hat{p}_1) = (0.61, 0.12)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n5.  对 $(\\hat{p}_5, \\hat{p}_2) = (0.61, 0.18)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n6.  对 $(\\hat{p}_5, \\hat{p}_4) = (0.61, 0.52)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n7.  对 $(\\hat{p}_6, \\hat{p}_1) = (0.85, 0.12)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n8.  对 $(\\hat{p}_6, \\hat{p}_2) = (0.85, 0.18)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n9.  对 $(\\hat{p}_6, \\hat{p}_4) = (0.85, 0.52)$：$\\hat{p}_{\\text{case}} > \\hat{p}_{\\text{control}}$。得分 = $1$。\n\n病例和对照之间的预测风险没有平局。总分是所有对得分的总和：\n$$ \\text{Total Score} = 1+1+0+1+1+1+1+1+1 = 8 $$\nAUC是总分除以总对数：\n$$ \\text{AUC} = \\frac{8}{9} \\approx 0.88888... $$\n四舍五入到四位有效数字，我们得到 $\\text{AUC} = 0.8889$。\n\n**2. 校准截距 ($\\alpha$) 和斜率 ($\\beta$)**\n\n校准截距 $\\alpha$ 和斜率 $\\beta$ 由观测结果 $y_i$ 对预测概率 $\\hat{p}_i$ 的简单线性回归确定。我们的目标是找到使平方误差和 $S = \\sum_{i=1}^{n}(y_i - \\alpha - \\beta \\hat{p}_i)^{2}$ 最小化的 $\\alpha$ 和 $\\beta$。解由法方程给出，从而得到最小二乘估计的标准公式：\n$$ \\beta = \\frac{\\sum_{i=1}^{n}(\\hat{p}_i - \\bar{p})(y_i - \\bar{y})}{\\sum_{i=1}^{n}(\\hat{p}_i - \\bar{p})^2} = \\frac{n\\sum_{i=1}^{n}\\hat{p}_iy_i - (\\sum_{i=1}^{n}\\hat{p}_i)(\\sum_{i=1}^{n}y_i)}{n\\sum_{i=1}^{n}\\hat{p}_i^2 - (\\sum_{i=1}^{n}\\hat{p}_i)^2} $$\n$$ \\alpha = \\bar{y} - \\beta\\bar{p} $$\n其中 $\\bar{p}$ 是预测概率的平均值，$\\bar{y}$ 是结果的平均值。\n\n我们计算所需的和，其中 $n=6$：\n- $\\sum y_i = 0+0+1+0+1+1 = 3$\n- $\\sum \\hat{p}_i = 0.12+0.18+0.33+0.52+0.61+0.85 = 2.61$\n- $\\sum \\hat{p}_iy_i = (0.12)(0)+(0.18)(0)+(0.33)(1)+(0.52)(0)+(0.61)(1)+(0.85)(1) = 0.33+0.61+0.85 = 1.79$\n- $\\sum \\hat{p}_i^2 = 0.12^2+0.18^2+0.33^2+0.52^2+0.61^2+0.85^2 = 0.0144+0.0324+0.1089+0.2704+0.3721+0.7225 = 1.5207$\n\n现在我们可以计算 $\\beta$：\n$$ \\beta = \\frac{6(1.79) - (2.61)(3)}{6(1.5207) - (2.61)^2} = \\frac{10.74 - 7.83}{9.1242 - 6.8121} = \\frac{2.91}{2.3121} \\approx 1.258596... $$\n四舍五入到四位有效数字，得到 $\\beta = 1.259$。\n\n接下来，我们计算平均值 $\\bar{y}$ 和 $\\bar{p}$：\n- $\\bar{y} = \\frac{\\sum y_i}{n} = \\frac{3}{6} = 0.5$\n- $\\bar{p} = \\frac{\\sum \\hat{p}_i}{n} = \\frac{2.61}{6} = 0.435$\n\n然后，我们计算 $\\alpha$：\n$$ \\alpha = \\bar{y} - \\beta\\bar{p} \\approx 0.5 - (1.258596...)(0.435) = 0.5 - 0.547489... = -0.047489... $$\n四舍五入到四位有效数字，得到 $\\alpha = -0.04749$。\n\n**3. 布里尔分数 (Brier Score)**\n\n布里尔分数是预测概率与观测结果之间的均方误差。其定义为：\n$$ \\text{Brier Score} = \\frac{1}{n}\\sum_{i=1}^{n}(\\hat{p}_i - y_i)^2 $$\n我们计算每个患者的平方误差：\n- $(\\hat{p}_1-y_1)^2 = (0.12-0)^2 = 0.0144$\n- $(\\hat{p}_2-y_2)^2 = (0.18-0)^2 = 0.0324$\n- $(\\hat{p}_3-y_3)^2 = (0.33-1)^2 = (-0.67)^2 = 0.4489$\n- $(\\hat{p}_4-y_4)^2 = (0.52-0)^2 = 0.2704$\n- $(\\hat{p}_5-y_5)^2 = (0.61-1)^2 = (-0.39)^2 = 0.1521$\n- $(\\hat{p}_6-y_6)^2 = (0.85-1)^2 = (-0.15)^2 = 0.0225$\n\n这些平方误差的和是：\n$$ \\sum_{i=1}^{6}(\\hat{p}_i - y_i)^2 = 0.0144+0.0324+0.4489+0.2704+0.1521+0.0225 = 0.9407 $$\n布里尔分数是这个和的平均值：\n$$ \\text{Brier Score} = \\frac{0.9407}{6} \\approx 0.1567833... $$\n四舍五入到四位有效数字，我们得到布里尔分数 $= 0.1568$。\n\n总之，计算出的指标四舍五入到四位有效数字后为：\n- $\\text{AUC} = 0.8889$\n- 校准截距 $\\alpha = -0.04749$\n- 校准斜率 $\\beta = 1.259$\n- 布里尔分数 $= 0.1568$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8889  -0.04749  1.259  0.1568\n\\end{pmatrix}\n}\n$$", "id": "4852815"}, {"introduction": "即使是高度准确的预测性测试，也必须在现实世界中证明其价值才能被广泛采用，这需要权衡其临床效益与经济成本。这项动手练习 [@problem_id:4852807] 将让你扮演卫生政策分析师的角色，通过计算“为避免一例不良事件所需进行基因分型的人数”（Number Needed to Genotype, NNG）和收支平衡的测试成本，来判断一项药物基因组学测试项目的实际可行性。", "problem": "在一个旨在提高药物安全性的精准医疗项目中，一项药物基因组学（PGx）检测被用于识别携带某种遗传变异的患者。当这些患者接受标准疗法治疗时，该遗传变异会增加其发生严重不良事件的风险。其临床和经济背景如下。在适用患者中，该基因型的流行率为 $0.12$。在不进行检测的标准疗法下，携带者的不良事件发生概率为 $0.10$，非携带者为 $0.03$。如果进行检测，被识别出的携带者将获得一种替代疗法，该疗法相对于标准疗法下携带者的风险，通过 $0.50$ 的风险比将其不良事件概率乘性降低。非携带者接受标准疗法。假设该 PGx 检测具有完美的分析有效性、临床特异性和灵敏度，并且在常规护理中，有 $0.80$ 的已识别携带者实际接受了替代疗法。非携带者的不良事件概率没有变化，并且除了成本之外，替代疗法没有额外的危害。替代疗法相对于标准疗法的增量药物成本为每位患者 $\\$150$，此成本仅由转换疗法的携带者承担。发生严重不良事件所导致的下游成本（包括急性护理和后续随访）为每次事件 $\\$25{,}000$。\n\n仅使用概率、风险比和绝对风险变化的基本定义，按顺序完成以下任务：\n\n1) 在上述假设下，符号化地推导因实施基因型指导疗法而带来的每位接受基因分型患者的绝对风险降低值，并计算在此情况下为避免一次不良事件需要进行基因分型的人数。\n\n2) 定义一个简单的人群层面实施可行性标准：每位接受基因分型患者的预期增量成本不应为正。在此标准下，推导使预期增量成本恰好为零的盈亏平衡点单位检测成本的表达式，并根据上述数据计算其值。\n\n以美元表示最终答案，即盈亏平衡点的检测成本。将最终答案四舍五入至三位有效数字。在最终的方框答案中不要标明单位。", "solution": "为清晰起见，让我们用符号定义给定的参数：\n-   遗传变异的流行率（携带者状态）：$p_G = P(G+) = 0.12$。非携带者的流行率为 $P(G-) = 1 - p_G = 0.88$。\n-   携带者在标准疗法下发生不良事件（AE）的风险：$R_{S|G+} = P(AE|G+, S) = 0.10$。\n-   非携带者在标准疗法下发生 AE 的风险：$R_{S|G-} = P(AE|G-, S) = 0.03$。\n-   携带者接受替代疗法的风险比：$RR = 0.50$。\n-   转换至替代疗法的携带者比例：$f_s = 0.80$。\n-   替代药物的增量成本：$C_{alt} = \\$150$。\n-   不良事件的成本：$C_{AE} = \\$25,000$。\n\n假设检测具有完美的灵敏度和特异性，意味着它能正确识别所有携带者和非携带者。\n\n#### 第 1 部分：绝对风险降低和需基因分型人数\n\n首先，我们计算在标准治疗（无基因分型）下人群中不良事件的基线预期概率。这是携带者和非携带者风险的加权平均值。\n$$P(AE)_{std} = R_{S|G+} \\cdot p_G + R_{S|G-} \\cdot (1 - p_G)$$\n\n接下来，我们计算在基因型指导疗法策略下不良事件的预期概率。\n非携带者继续接受标准疗法，因此他们的风险不变：$R_{S|G-}$。\n对于携带者，比例为 $f_s$ 的人转换到替代疗法，其风险变为 $R_{S|G+} \\cdot RR$。剩余的比例 $1 - f_s$ 不转换，其风险保持为 $R_{S|G+}$。一个已识别携带者的平均风险是：\n$$R'_{G+} = f_s \\cdot (R_{S|G+} \\cdot RR) + (1 - f_s) \\cdot R_{S|G+}$$\n接受基因分型的人群中发生 AE 的总概率是两个组风险的加权平均值：\n$$P(AE)_{guided} = R'_{G+} \\cdot p_G + R_{S|G-} \\cdot (1 - p_G)$$\n\n每位接受基因分型患者的绝对风险降低（$ARR$）是两种情况下 AE 概率的差值：\n$$ARR = P(AE)_{std} - P(AE)_{guided}$$\n$$ARR = [R_{S|G+} \\cdot p_G + R_{S|G-} \\cdot (1 - p_G)] - [R'_{G+} \\cdot p_G + R_{S|G-} \\cdot (1 - p_G)]$$\n非携带者的项 $R_{S|G-} \\cdot (1 - p_G)$ 被消去。\n$$ARR = R_{S|G+} \\cdot p_G - R'_{G+} \\cdot p_G$$\n$$ARR = p_G \\cdot (R_{S|G+} - R'_{G+})$$\n代入 $R'_{G+}$ 的表达式：\n$$ARR = p_G \\cdot \\left( R_{S|G+} - [f_s \\cdot R_{S|G+} \\cdot RR + (1 - f_s) \\cdot R_{S|G+}] \\right)$$\n$$ARR = p_G \\cdot R_{S|G+} \\cdot \\left( 1 - [f_s \\cdot RR + 1 - f_s] \\right)$$\n$$ARR = p_G \\cdot R_{S|G+} \\cdot (1 - f_s \\cdot RR - 1 + f_s)$$\n$$ARR = p_G \\cdot R_{S|G+} \\cdot (f_s - f_s \\cdot RR)$$\n绝对风险降低的符号表达式是：\n$$ARR = p_G \\cdot f_s \\cdot R_{S|G+} \\cdot (1 - RR)$$\n这个表达式很直观：总体的风险降低仅在实际转换疗法（$f_s$）的携带者亚群（$p_G$）中实现，并且与他们的基线风险（$R_{S|G+}$）以及新疗法带来的风险降低分数（$(1-RR)$）成正比。\n\n使用给定值：\n$$ARR = (0.12) \\cdot (0.80) \\cdot (0.10) \\cdot (1 - 0.50)$$\n$$ARR = (0.12) \\cdot (0.80) \\cdot (0.10) \\cdot (0.50) = 0.0048$$\n\n为避免一次不良事件需要进行基因分型的人数（$NNG$）是 $ARR$ 的倒数：\n$$NNG = \\frac{1}{ARR} = \\frac{1}{0.0048} = \\frac{10000}{48} = \\frac{625}{3} \\approx 208.33$$\n因此，大约需要对 $209$ 名患者进行基因分型才能预防一次不良事件。\n\n#### 第 2 部分：盈亏平衡点检测成本\n\n可行性标准规定，每位接受基因分型患者的预期增量成本 $\\Delta E[C]$ 不应为正。在盈亏平衡点，该成本为零。\n$$\\Delta E[C] = E[C_{guided}] - E[C_{std}] = 0$$\n设 $C_{test}$ 为每人的基因分型检测成本。\n\n标准治疗下每位患者的预期成本 $E[C_{std}]$ 仅包括不良事件的成本：\n$$E[C_{std}] = P(AE)_{std} \\cdot C_{AE}$$\n基因型指导策略下每位患者的预期成本 $E[C_{guided}]$ 包括检测成本、转换疗法者的增量药物成本以及剩余不良事件的成本：\n$$E[C_{guided}] = C_{test} + (p_G \\cdot f_s \\cdot C_{alt}) + (P(AE)_{guided} \\cdot C_{AE})$$\n增量药物成本 $C_{alt}$ 仅由人群中身为携带者（$p_G$）且转换疗法（$f_s$）的这部分人承担。\n\n将增量成本设为零以满足盈亏平衡条件：\n$$C_{test} + p_G \\cdot f_s \\cdot C_{alt} + P(AE)_{guided} \\cdot C_{AE} - P(AE)_{std} \\cdot C_{AE} = 0$$\n$$C_{test} + p_G \\cdot f_s \\cdot C_{alt} - (P(AE)_{std} - P(AE)_{guided}) \\cdot C_{AE} = 0$$\n认识到 $P(AE)_{std} - P(AE)_{guided} = ARR$：\n$$C_{test} + p_G \\cdot f_s \\cdot C_{alt} - ARR \\cdot C_{AE} = 0$$\n求解盈亏平衡点检测成本 $C_{test}$：\n$$C_{test} = ARR \\cdot C_{AE} - p_G \\cdot f_s \\cdot C_{alt}$$\n该表达式表明，可负担的检测成本等于通过避免不良事件而节省的医疗保健费用（$ARR \\cdot C_{AE}$）减去在替代疗法上的额外支出（$p_G \\cdot f_s \\cdot C_{alt}$）。\n\n代入数值：\n-   避免 AE 带来的节省：$ARR \\cdot C_{AE} = 0.0048 \\cdot \\$25,000 = \\$120$\n-   额外的药物支出：$p_G \\cdot f_s \\cdot C_{alt} = 0.12 \\cdot 0.80 \\cdot \\$150 = 0.096 \\cdot \\$150 = \\$14.40$\n\n盈亏平衡点的检测成本是：\n$$C_{test} = \\$120 - \\$14.40 = \\$105.60$$\n题目要求最终答案四舍五入到三位有效数字。数字 $105.6$ 有四位有效数字。第四位数字（$6$）大于等于 $5$，所以我们将第三位数字向上取整。\n$$C_{test} \\approx \\$106$$", "answer": "$$\\boxed{106}$$", "id": "4852807"}]}