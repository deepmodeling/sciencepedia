{"hands_on_practices": [{"introduction": "可靠临床基因组学的基石是高质量的数据。在将任何基因组信息整合到电子健康记录 (EHR) 中用于临床决策之前，我们必须有一种稳健的方法来滤除测序和变异检出过程中的潜在错误。本练习将向您介绍 Phred 质量分数标度的基因型质量 (Genotype Quality, GQ) 分数，这是一个用于此目的的标准度量。您将练习将此分数转换为错误概率，并用它来为临床报告流程设定一个实用的质量控制阈值[@problem_id:4845063]。", "problem": "一家医院正在将其电子健康记录 (EHR) 系统与临床基因组学相结合。其变异检出流程提供了一种名为基因型质量 (Genotype Quality, GQ) 的基因型置信度分数，该分数以 Phred 标度报告。Phred 标度由质量分数 $Q$ 和错误概率 $p$ 之间的关系定义为 $Q=-10\\log_{10}(p)$。该医院计划为每位患者报告 $N=200$ 个药物基因组学基因型检出结果，并希望设定一个最低 $GQ$ 报告阈值，以使每位患者的预期假基因型检出数量不超过 $\\alpha=0.05$ 的容忍度。假设每个报告的基因型检出具有相同的错误概率，该概率仅由其 $GQ$ 决定，并且预期的假检出数量是各个错误概率的总和。\n(a) 从 Phred 定义 $Q=-10\\log_{10}(p)$ 出发，将错误概率 $p$ 表示为 $GQ$ 的函数。\n(b) 使用您的表达式，确定当 $GQ=20$ 时假基因型检出的概率。\n(c) 推导最小整数阈值 $GQ^{\\ast}$，使得在所有 $N=200$ 个报告的基因型中，预期的假基因型检出数量最多为 $\\alpha=0.05$。按 $(p \\text{ at } GQ=20,\\; GQ^{\\ast})$ 的顺序提供 (b) 和 (c) 部分的最终答案。不需要单位。第 (b) 部分不需要四舍五入。对于第 (c) 部分，报告满足约束条件的最小整数 $GQ^{\\ast}$。", "solution": "该问题要求我们在基因组数据分析的背景下，进行与 Phred 质量标度相关的计算。我们首先将验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- Phred 质量分数 $Q$ 的定义：$Q = -10 \\log_{10}(p)$，其中 $p$ 是错误概率。问题中使用 $GQ$ 来表示该分数。\n- 每位患者的药物基因组学基因型检出数量：$N = 200$。\n- 每位患者的预期假基因型检出数量的容忍度：$\\alpha = 0.05$。\n- 假设1：每个报告的基因型都有一个由其 $GQ$ 分数决定的错误概率 $p$。为了设定阈值，我们假设所有报告的检出都具有等于最低阈值的质量分数，这代表了最坏情况。\n- 假设2：预期的假检出数量是各个错误概率的总和。\n- 目标 (a)：将 $p$ 表示为 $GQ$ 的函数。\n- 目标 (b)：计算当 $GQ = 20$ 时的 $p$。\n- 目标 (c)：找到最小整数阈值 $GQ^{\\ast}$，使得预期的假基因型检出数量最多为 $\\alpha$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：Phred 标度及其定义 $Q = -10 \\log_{10}(p)$ 是生物信息学和基因组学中用于量化序列数据和变异检出质量的基本和标准概念。设定质量阈值以控制错误率的问题是临床基因组学中一项常见且实际的任务。因此，该问题在科学上是合理的。\n- **良态问题**：问题陈述清晰，提供了推导所需量（$p(GQ)$、$p(20)$ 和 $GQ^{\\ast}$）的所有必要数据（$N$、$\\alpha$）和定义。目标明确，并能导出一个唯一的解。\n- **客观性**：问题采用精确、定量的语言表述，没有任何主观或模棱两可的术语。\n\n**步骤3：结论与行动**\n该问题科学合理、良态且客观。被判定为**有效**。我们继续进行解答。\n\n### 解答\n\n**(a) 将错误概率 $p$ 表示为 $GQ$ 的函数。**\n\n我们已知 Phred 标度上基因型质量 ($GQ$) 分数的定义：\n$$GQ = -10 \\log_{10}(p)$$\n我们的目标是解出该方程中的错误概率 $p$。\n\n首先，我们将等式两边同时除以 $-10$ 来分离对数项：\n$$-\\frac{GQ}{10} = \\log_{10}(p)$$\n为了解出 $p$，我们使用以 10 为底的对数的定义，即如果 $y = \\log_{10}(x)$，那么 $x = 10^y$。将此应用于我们的方程，得到：\n$$p = 10^{-\\frac{GQ}{10}}$$\n这个表达式给出了错误概率 $p$ 作为 $GQ$ 分数的函数。\n\n**(b) 确定当 $GQ=20$ 时假基因型检出的概率。**\n\n使用 (a) 部分推导出的公式，我们代入 $GQ = 20$：\n$$p(20) = 10^{-\\frac{20}{10}}$$\n$$p(20) = 10^{-2}$$\n$$p(20) = \\frac{1}{10^2} = \\frac{1}{100} = 0.01$$\n所以，一个 $GQ$ 分数为 $20$ 的基因型检出有 $1\\%$ 的可能性是错误的。\n\n**(c) 推导最小整数阈值 $GQ^{\\ast}$。**\n\n医院报告 $N = 200$ 个基因型。设 $GQ^{\\ast}$ 为最低质量阈值。为确保所有报告基因型的质量，我们必须考虑最坏情况，即所有 $N$ 个基因型的质量分数都等于这个最低阈值 $GQ^{\\ast}$。在这种情况下， $N$ 个检出中每一个的错误概率都是 $p(GQ^{\\ast})$。\n\n预期的假检出数量 $E[\\text{false calls}]$ 是每次检出错误概率的总和。在我们的最坏情况假设下，这等于：\n$$E[\\text{false calls}] = \\sum_{i=1}^{N} p(GQ^{\\ast}) = N \\cdot p(GQ^{\\ast})$$\n医院要求这个预期数量不超过 $\\alpha = 0.05$ 的容忍度。这给了我们以下不等式：\n$$N \\cdot p(GQ^{\\ast}) \\le \\alpha$$\n代入 (a) 部分的 $p(GQ^{\\ast})$ 表达式以及已知的 $N$ 和 $\\alpha$ 的值：\n$$200 \\cdot 10^{-\\frac{GQ^{\\ast}}{10}} \\le 0.05$$\n现在我们求解 $GQ^{\\ast}$：\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{0.05}{200}$$\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{5 \\times 10^{-2}}{2 \\times 10^{2}} = 2.5 \\times 10^{-4}$$\n右边的另一种写法是 $\\frac{1}{4000}$。\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{1}{4000}$$\n为了解出 $GQ^{\\ast}$，我们对不等式两边取以 10 为底的对数。由于 $\\log_{10}(x)$ 是一个单调递增函数，不等号的方向保持不变。\n$$\\log_{10}\\left(10^{-\\frac{GQ^{\\ast}}{10}}\\right) \\le \\log_{10}\\left(\\frac{1}{4000}\\right)$$\n$$-\\frac{GQ^{\\ast}}{10} \\le -\\log_{10}(4000)$$\n将两边乘以 $-10$。这个操作会反转不等号的方向：\n$$GQ^{\\ast} \\ge 10 \\log_{10}(4000)$$\n我们可以简化对数项：\n$$\\log_{10}(4000) = \\log_{10}(4 \\times 1000) = \\log_{10}(4) + \\log_{10}(1000) = \\log_{10}(2^2) + 3 = 2 \\log_{10}(2) + 3$$\n$\\log_{10}(2)$ 的值约等于 $0.30103$。\n$$GQ^{\\ast} \\ge 10 (2 \\cdot (0.30103) + 3)$$\n$$GQ^{\\ast} \\ge 10 (0.60206 + 3)$$\n$$GQ^{\\ast} \\ge 10 (3.60206)$$\n$$GQ^{\\ast} \\ge 36.0206$$\n问题要求满足此条件的最小整数阈值 $GQ^{\\ast}$。大于或等于 $36.0206$ 的最小整数是 $37$。\n因此，最小整数 $GQ$ 阈值必须是 $37$。\n(b) 部分和 (c) 部分的最终答案分别为 $0.01$ 和 $37$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.01 & 37 \\end{pmatrix}}$$", "id": "4845063"}, {"introduction": "一个原始的变异检出结果，例如“在 chr1:100 位置有一个插入”，其本身并没有临床可操作性。为了使其有用，必须将其转化为标准化的格式，并理解其对蛋白质的生物学影响。本实践将指导您根据变异在基因编码序列中的位置来解释其影响。通过应用分子生物学的基本原理和人类基因组变异学会 (HGVS) 的命名系统，您将确定一个插入如何移动阅读框并影响最终的蛋白质，这是评估其临床意义的关键一步[@problem_id:4845082]。", "problem": "一家医院正在将其电子健康记录 (EHR) 中的基因组变异整合为可计算字段，以支持临床决策。一份变异调用格式 (VCF) 记录报告了在 Genome Reference Consortium human build 38 (GRCh38) 上的一个单碱基插入，位于染色体 $1$ 的位置 $100$，参考等位基因为“G”，备选等位基因为“GA”，这表明在该位点的“G”之后紧接着插入了一个“A”。对于正链上的一个特定信使核糖核酸 (mRNA) 转录本，其编码序列 (CDS) 起始于基因组位置 $50$，并且根据转录本定位已知，基因组位置 $100$ 对应于 Human Genome Variation Society (HGVS) 的编码 DNA 坐标 $\\mathrm{c.}51$。EHR 流水线希望存储一个名为“首个改变密码子索引”的整数字段，其定义为因该变异而可能与参考翻译产物不同的第一个氨基酸的位置（从翻译起始密码子处的甲硫氨酸开始，以 $1$ 计数）。\n\n仅使用基本原理，包括分子生物学的中心法则、翻译读取长度为 $3$ 个核苷酸的密码子这一定义、HGVS 编码 DNA 坐标系统（其中 $\\mathrm{c.}1$ 是正链上起始密码子的第一个核苷酸），以及长度不为 $3$ 的倍数的插入会导致从插入点开始发生移码这一事实，确定该变异的“首个改变密码子索引”。\n\n将你的最终答案表示为一个整数。无需四舍五入。", "solution": "该问题要求确定一个特定的单碱基插入变异的“首个改变密码子索引”。解决方案将根据分子生物学的基本原理和所提供的坐标系统定义推导得出。\n\n已知条件如下：\n- 在染色体 $1$ 的基因组位置 $100$ 处有一个单碱基插入。\n- 参考等位基因为 'G'，备选等位基因为 'GA'。这对应于在位置 $100$ 的 'G' 之后插入一个 'A' 核苷酸。\n- 基因组位置 $100$ 对应的 HGVS 编码 DNA 坐标为 $\\mathrm{c.}51$。\n- 密码子是核苷酸的三联体，即其长度为 $3$。\n- HGVS 编码 DNA 坐标系统是基于 $1$ 的，其中 $\\mathrm{c.}1$ 是起始密码子的第一个核苷酸。\n- “首个改变密码子索引”是在翻译出的蛋白质中，第一个可能与参考序列不同的氨基酸的基于 $1$ 的位置。\n\n让我们分析一下编码 DNA 序列 (CDS) 中的核苷酸位置与密码子位置之间的关系。\n第一个密码子由核苷酸 $\\mathrm{c.}1$、$\\mathrm{c.}2$ 和 $\\mathrm{c.}3$ 组成。\n第二个密码子由核苷酸 $\\mathrm{c.}4$、$\\mathrm{c.}5$ 和 $\\mathrm{c.}6$ 组成。\n通常，对于索引为 $k$ 的密码子（其中 $k$ 是正整数），其核苷酸位于位置 $\\mathrm{c.}(3k-2)$、$\\mathrm{c.}(3k-1)$ 和 $\\mathrm{c.}(3k)$。\n\n反之，要找到包含位置为 $\\mathrm{c.}N$ 的核苷酸的密码子索引 $k$，我们可以使用向上取整函数。索引 $k$ 是满足 $N \\le 3k$ 的最小整数。这在数学上表示为：\n$$k = \\lceil \\frac{N}{3} \\rceil$$\n\n问题指出，插入发生在基因组位置 $100$ 的核苷酸之后，该位置对应于编码 DNA 坐标 $\\mathrm{c.}51$。我们必须首先确定哪个密码子包含核苷酸 $\\mathrm{c.}51$。\n使用上述公式，设 $N = 51$：\n$$k = \\left\\lceil \\frac{51}{3} \\right\\rceil = \\lceil 17 \\rceil = 17$$\n因此，位置 $\\mathrm{c.}51$ 的核苷酸是第 $17$ 个密码子的一部分。\n\n由于 $51$ 是 $3$ 的整数倍（$51 = 3 \\times 17$），位置 $\\mathrm{c.}51$ 的核苷酸是第 $17$ 个密码子的第三个也是最后一个核苷酸。构成第 $17$ 个密码子的核苷酸是 $\\mathrm{c.}49$、$\\mathrm{c.}50$ 和 $\\mathrm{c.}51$。\n\n该变异是在核苷酸 $\\mathrm{c.}51$ *之后* 紧接着插入一个 'A' 核苷酸。这意味着直到并包括核苷酸 $\\mathrm{c.}51$ 在内的基因序列都未被改变。翻译的阅读框通过将核苷酸分组为三联体来进行。\n索引从 $1$ 到 $17$ 的密码子是从未改变的序列中读取的。\n- 密码子 $1$：($\\mathrm{c.}1, \\mathrm{c.}2, \\mathrm{c.}3$)\n- ...\n- 密码子 $17$：($\\mathrm{c.}49, \\mathrm{c.}50, \\mathrm{c.}51$)\n\n因此，多肽链中位置 $1$ 到 $17$ 的氨基酸将与参考序列产生的氨基酸相同。\n\n插入发生在位置 $\\mathrm{c.}51$ 之后。在参考序列中本应形成第 $18$ 个密码子的核苷酸是 $\\mathrm{c.}52$、$\\mathrm{c.}53$ 和 $\\mathrm{c.}54$。\n参考序列密码子：\n$$... (\\mathrm{c.}49, \\mathrm{c.}50, \\mathrm{c.}51) (\\mathrm{c.}52, \\mathrm{c.}53, \\mathrm{c.}54) ...$$\n$$ \\text{密码子 } 17 \\qquad\\quad \\text{密码子 } 18 $$\n\n单个核苷酸 'A' 的插入将序列变为：\n$$... (\\mathrm{c.}49, \\mathrm{c.}50, \\mathrm{c.}51) \\text{'A'} (\\mathrm{c.}52, \\mathrm{c.}53, \\mathrm{c.}54) ...$$\n翻译机制从最后一个已翻译密码子的位置开始继续以三联体方式读取。在密码子 $17$ 被翻译后，新的阅读框建立如下：\n$$... (\\mathrm{c.}49, \\mathrm{c.}50, \\mathrm{c.}51) (\\text{'A'}, \\mathrm{c.}52, \\mathrm{c.}53) (\\mathrm{c.}54, ...) ...$$\n$$ \\text{密码子 } 17 \\qquad\\quad \\text{新密码子 } 18 $$\n\n插入的长度为 $1$ 个核苷酸。由于这个长度不是 $3$ 的倍数，它会导致移码突变。移码从插入点之后立即开始。\n受此移码影响的第一个密码子是密码子 $17$ 之后的那个。这是索引为 $18$ 的密码子。在参考序列中，密码子 $18$ 由 $(\\mathrm{c.}52, \\mathrm{c.}53, \\mathrm{c.}54)$ 组成。在变异序列中，位置 $18$ 的密码子现在由 $(\\text{'A'}, \\mathrm{c.}52, \\mathrm{c.}53)$ 组成。由于这个新密码子由不同的核苷酸组成，它几乎肯定会翻译成一个不同的氨基酸（或一个提前的终止密码子）。\n\n因此，第一个可能与参考翻译产物不同的氨基酸是位于位置 $18$ 的那个。“首个改变密码子索引”是 $18$。", "answer": "$$\\boxed{18}$$", "id": "4845082"}, {"introduction": "将基因组数据整合到 EHR 中的最终目标是提供实时的、针对患者个体的临床决策支持 (CDS)。一个典型的例子是药物基因组学，即利用患者的基因构成来指导药物选择和剂量。本练习模拟了一个药物基因组学 CDS 模块，该模块使用一个数学模型来推荐药物剂量。您将应用一个给定的算法，该算法结合了患者的年龄和特定的遗传标记（*VKORC1* 和 *CYP2C9*）来计算个性化剂量，从而展示这些复杂的数据点如何被整合成一个单一的、可操作的建议[@problem_id:4845094]。", "problem": "一个集成了电子健康记录（EHR）的临床决策支持（CDS）模块被设计用于通过一个带有对数连接函数的广义线性模型（GLM）来计算窄治疗指数药物的初始剂量，该模型整合了基因组特征。在带有对数连接函数的广义线性模型中，通过对协变量的线性组合取指数来对预测的正值量进行建模。这种设置适用于剂量计算，因为指数化确保了剂量严格为正，并允许协变量在均值尺度上具有乘法效应。考虑一个实现，其中将维生素K环氧化物还原酶复合体亚单位1（*VKORC1*）风险等位基因的存在编码为 $1$，不存在则为 $0$；将细胞色素 P450 2C9（*CYP2C9*）功能减退基因型的存在编码为 $1$，不存在则为 $0$。该 CDS 使用规则 $Dose = \\exp(\\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9)$ 计算剂量（单位：毫克/天），其中系数为 $\\beta_0 = 3.5$，$\\beta_1 = -0.01$，$\\beta_2 = -0.3$ 和 $\\beta_3 = -0.2$。对于一名年龄为 65 岁、`VKORC1`=1（存在风险等位基因）且 `CYP2C9`=1（功能减退）的患者，计算推荐剂量。答案以毫克/天为单位，并四舍五入至四位有效数字。", "solution": "该问题要求使用一个给定的带有对数连接函数的广义线性模型（GLM）来计算药物剂量。这种类型的模型适用于预测严格为正的量，例如药物剂量。该模型的结构是协变量线性组合的指数函数。\n\n提供的剂量模型，$Dose$（单位：毫克/天），如下：\n$$Dose = \\exp(\\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9)$$\n\n问题提供了模型系数的以下值：\n- 截距：$\\beta_0 = 3.5$\n- 年龄的系数：$\\beta_1 = -0.01$\n- $VKORC1$ 等位基因存在的系数：$\\beta_2 = -0.3$\n- $CYP2C9$ 功能减退的系数：$\\beta_3 = -0.2$\n\n具体的患者数据如下：\n- 年龄：$65$ 岁\n- $VKORC1$ 状态：$1$（存在风险等位基因）\n- $CYP2C9$ 状态：$1$（存在功能减退基因型）\n\n首先，我们计算线性预测器的值，它是指数函数的参数。我们将线性预测器表示为 $\\eta$：\n$$\\eta = \\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9$$\n\n将给定值代入此表达式：\n$$\\eta = 3.5 + (-0.01) \\cdot 65 + (-0.3) \\cdot 1 + (-0.2) \\cdot 1$$\n\n现在，我们执行算术运算来求 $\\eta$ 的值：\n$$\\eta = 3.5 - 0.65 - 0.3 - 0.2$$\n$$\\eta = 3.5 - (0.65 + 0.3 + 0.2)$$\n$$\\eta = 3.5 - 1.15$$\n$$\\eta = 2.35$$\n\n计算出线性预测器的值后，我们现在可以通过应用指数函数来计算剂量：\n$$Dose = \\exp(\\eta) = \\exp(2.35)$$\n\n使用计算器来评估此表达式：\n$$Dose \\approx 10.4855905...$$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$4$ 和 $8$。第五位有效数字是 $5$，这要求对第四位数字进行向上取整。\n因此，四舍五入后的剂量是 $10.49$ 毫克/天。", "answer": "$$\\boxed{10.49}$$", "id": "4845094"}]}