{"hands_on_practices": [{"introduction": "疾病监测系统的基石在于其处理来自不同来源的原始数据的能力。本练习模拟了将多样化的实验室结果（例如使用HL7和LOINC标准编码的数据）标准化为一个统一的二进制指标的核心过程，这是将混杂信息转化为可分析洞见的必要步骤。通过此实践，你将掌握应用明确的业务逻辑来确保数据一致性的关键技能，这是公共卫生信息学的一项基本功。", "problem": "一个公共卫生部门正在实施一个标准化的二进制指标，用于甲型流感疾病监测病例定义，以汇总来自使用逻辑观察标识符名称和代码 (LOINC) 编码的第 $2$ 版健康水平七级标准 (HL7 v$2$) 观察/结果 (OBX) 段的实验室结果。给定一次包含来自同一天的多个 OBX 段的患者就诊事件。该指标必须根据指定的值集和决策逻辑，通过对检验代码和值进行标准化来计算。如果存在任何甲型流感的阳性实验室证据，则该二进制指标定义为 $1$，否则为 $0$。您的任务是计算此次就诊事件的该指标。\n\n使用以下上下文，其反映了标准的实验室信息传递惯例和广泛使用的公共卫生监测实践：\n\n- 甲型流感实验室证据的 LOINC 值集包括以下代码：$44569\\text{-}9$ (通过核酸扩增检测的甲型流感核糖核酸存在性)、$57406\\text{-}3$ (通过快速免疫分析的甲型流感抗原存在性) 和 $30334\\text{-}0$ (通过核酸扩增检测的甲型流感核糖核酸定量，单位为拷贝数/毫升)。在本练习中，仅这些代码被视为甲型流感的证据。\n- 对于 OBX-$5$ 中的文本结果，需要进行解释性值标准化，使用以下互斥集合（比较不区分大小写）：\n  - 阳性字符串 $S_{\\text{pos}} = \\{\\text{\"POS\"}, \\text{\"Positive\"}, \\text{\"Detected\"}, \\text{\"Reactive\"}\\}$。\n  - 阴性字符串 $S_{\\text{neg}} = \\{\\text{\"NEG\"}, \\text{\"Negative\"}, \\text{\"Not Detected\"}, \\text{\"Nonreactive\"}\\}$。\n  - 不确定字符串 $S_{\\text{inc}} = \\{\\text{\"Inconclusive\"}, \\text{\"Equivocal\"}, \\text{\"Indeterminate\"}\\}$。\n- 对于定量结果（对于 LOINC $30334\\text{-}0$，OBX-$5$ 包含以“拷贝数/毫升”为单位的数值），定义阳性阈值 $T = 1.0 \\times 10^{3}$ 拷贝数/毫升。如果定量值 $v \\geq T$，则解释为阳性；如果 $v  T$，则为阴性；如果数值或单位缺失，则为不确定。\n- 对于单次就诊事件的一组 OBX 段 $E$，二进制指标 $I$ 的决策逻辑如下：\n  - 筛选甲型流感证据：仅保留那些 OBX-$3$ 的 LOINC 在甲型流感值集 $\\{44569\\text{-}9, 57406\\text{-}3, 30334\\text{-}0\\}$ 中的 OBX 段。\n  - 对于每个保留的 OBX，根据上述标准化规则解释 OBX-$5$，将其分类为阳性证据、阴性证据或不确定。\n  - 如果存在至少一个被分类为阳性证据的保留 OBX，则将就诊事件级别的指标 $I$ 设为 $1$；否则将 $I$ 设为 $0$。\n\n该次就诊事件有以下 OBX 段（简化为相关字段），每个项目符号对应一个 OBX：\n\n- OBX-$1$: OBX-$3$ LOINC $44569\\text{-}9$; OBX-$5$ 值 \"Not detected\"。\n- OBX-$2$: OBX-$3$ LOINC $57406\\text{-}3$; OBX-$5$ 值 \"DETECTED\"。\n- OBX-$3$: OBX-$3$ LOINC $30334\\text{-}0$; OBX-$5$ 值 \"8.0 × 10^2 copies/mL\"。\n- OBX-$4$: OBX-$3$ LOINC $40982\\text{-}1$; OBX-$5$ 值 \"Positive\"。\n- OBX-$5$: OBX-$3$ LOINC $76080\\text{-}1$; OBX-$5$ 值 \"NEG\"。\n- OBX-$6$: OBX-$3$ LOINC $12345\\text{-}6$; OBX-$5$ 值 \"Equivocal\"。\n\n请计算此次就诊事件的标准化的甲型流感二进制指标 $I$，并严格按照指定规则进行。将您的最终答案表示为单个数字 $0$ 或 $1$。不需要四舍五入，最终答案中也不需要单位。", "solution": "问题要求根据一组六个实验室结果段 (OBX)，为一次患者就诊事件计算一个甲型流感二进制指标，记为 $I$。计算过程遵循一个特定的、多步骤的决策逻辑。\n\n在进行求解之前，我们必须首先验证问题陈述。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- **指标定义：** 二进制指标 $I$ 在就诊事件中存在任何甲型流感阳性实验室证据时设为 $1$，否则设为 $0$。\n- **甲型流感 LOINC 值集：** 构成甲型流感证据的逻辑观察标识符名称和代码 (LOINC) 集合是 $V_{\\text{LOINC}} = \\{44569\\text{-}9, 57406\\text{-}3, 30334\\text{-}0\\}$。\n- **文本结果标准化：** 对于定性检验，结果值通过与三个集合进行不区分大小写的匹配来进行标准化：\n  - 阳性字符串：$S_{\\text{pos}} = \\{\\text{\"POS\"}, \\text{\"Positive\"}, \\text{\"Detected\"}, \\text{\"Reactive\"}\\}$。\n  - 阴性字符串：$S_{\\text{neg}} = \\{\\text{\"NEG\"}, \\text{\"Negative\"}, \\text{\"Not Detected\"}, \\text{\"Nonreactive\"}\\}$。\n  - 不确定字符串：$S_{\\text{inc}} = \\{\\text{\"Inconclusive\"}, \\text{\"Equivocal\"}, \\text{\"Indeterminate\"}\\}$。\n- **定量结果标准化：** 对于 LOINC 为 $30334\\text{-}0$ 的定量结果，当一个值 $v \\geq T$ 时为阳性，其中阈值 $T = 1.0 \\times 10^{3}$ 拷贝数/毫升。如果 $v  T$，则结果为阴性。\n- **决策逻辑：**\n  $1$. 筛选给定的 OBX 段，仅保留那些 OBX-$3$ 的 LOINC 在 $V_{\\text{LOINC}}$ 中的段。\n  $2$. 通过标准化其 OBX-$5$ 值，将每个保留的 OBX 段分类为阳性、阴性或不确定。\n  $3$. 如果至少有一个保留段被分类为阳性，则设 $I=1$；否则，设 $I=0$。\n- **输入数据：** 提供了六个 OBX 段（OBX-$1$ 到 OBX-$6$）及其各自的 LOINC 代码和值。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在医学信息学和公共卫生报告领域具有科学依据。它以与其真实世界应用一致的方式使用了标准术语 (LOINC) 和数据结构 (HL7)。问题是良构的：它提供了一套完整、自洽且明确的规则和数据，这保证了存在唯一且确定的解。语言客观，没有任何非形式化或主观的陈述。所有必需的定义和约束均已提供，并且内部一致。因此，该问题被认为是有效的。\n\n我们现在通过系统地应用指定的决策逻辑来求解。\n\n**步骤 I：按 LOINC 代码筛选 OBX 段**\n我们检查 6 个输入段中每一个的 OBX-$3$ LOINC 代码，以确定它是否属于甲型流感值集 $V_{\\text{LOINC}} = \\{44569\\text{-}9, 57406\\text{-}3, 30334\\text{-}0\\}$。\n\n- **OBX-$1$**：LOINC 为 $44569\\text{-}9$。此代码在 $V_{\\text{LOINC}}$ 中。此段被**保留**。\n- **OBX-$2$**：LOINC 为 $57406\\text{-}3$。此代码在 $V_{\\text{LOINC}}$ 中。此段被**保留**。\n- **OBX-$3$**：LOINC 为 $30334\\text{-}0$。此代码在 $V_{\\text{LOINC}}$ 中。此段被**保留**。\n- **OBX-$4$**：LOINC 为 $40982\\text{-}1$。此代码不在 $V_{\\text{LOINC}}$ 中。此段被**丢弃**。\n- **OBX-$5$**：LOINC 为 $76080\\text{-}1$。此代码不在 $V_{\\text{LOINC}}$ 中。此段被**丢弃**。\n- **OBX-$6$**：LOINC 为 $12345\\text{-}6$。此代码不在 $V_{\\text{LOINC}}$ 中。此段被**丢弃**。\n\n用于进一步分析的相关段集合包括 OBX-$1$、OBX-$2$ 和 OBX-$3$。\n\n**步骤 II：按值对保留的段进行分类**\n接下来，我们解释每个保留段的 OBX-$5$ 值，以将其分类为提供阳性、阴性或不确定证据。\n\n- **OBX-$1$ 的分析**：LOINC 为 $44569\\text{-}9$，表示一个定性检验。OBX-$5$ 的值是 `\"Not detected\"`。根据文本标准化规则，该值与阴性字符串集合 $S_{\\text{neg}}$ 中的一个条目匹配。因此，OBX-$1$ 代表**阴性**证据。\n\n- **OBX-$2$ 的分析**：LOINC 为 $57406\\text{-}3$，表示一个定性检验。OBX-$5$ 的值是 `\"DETECTED\"`。比较是不区分大小写的，所以 `\"DETECTED\"` 与阳性字符串集合 $S_{\\text{pos}}$ 中的 `\"Detected\"` 匹配。因此，OBX-$2$ 代表**阳性**证据。\n\n- **OBX-$3$ 的分析**：LOINC 为 $30334\\text{-}0$，表示一个定量检验。OBX-$5$ 的值是 `\"8.0 × 10^2 copies/mL\"`。我们提取数值 $v = 8.0 \\times 10^2 = 800$。该值必须与指定的阳性阈值 $T = 1.0 \\times 10^{3} = 1000$ 进行比较。阴性的规则是 $v  T$。由于 $800  1000$，此条件满足。因此，OBX-$3$ 代表**阴性**证据。\n\n**步骤 III：确定就诊事件级别的指标 $I$**\n最后一步是汇总各个段的分类结果，以计算就诊事件级别的指标 $I$。规则规定，如果存在至少一个阳性证据，则 $I=1$；否则 $I=0$。\n\n我们对保留段的分析得出了以下分类：\n- OBX-$1$：阴性\n- OBX-$2$：阳性\n- OBX-$3$：阴性\n\n因为 OBX-$2$ 提供了甲型流感的阳性证据，所以将指标设为 $1$ 的条件已满足。根据指定的“任何阳性”逻辑，其他阴性结果（来自 OBX-$1$ 和 OBX-$3$）的存在不会覆盖一个阳性发现。\n\n因此，此次就诊事件的标准化的甲型流感二进制指标 $I$ 为 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "4836663"}, {"introduction": "一个有效的病例定义是疾病监测系统成功的核心，但我们如何量化其发现真实病例的能力？本练习将带你从“应用规则”进入“评估规则”的更高层次，学习如何利用概率论来计算一个复杂逻辑病例定义的整体敏感性。通过结合不同证据（如实验室测试和临床症状）的性能指标，你将能够量化和优化监测策略的有效性。", "problem": "一个国家免疫信息系统被配置用于自动标记可能的疫苗可预防病毒性疾病病例，以便采取快速的公共卫生行动。该监测病例定义将实验室证据和临床体征合并为一个布尔表达式。定义以下事件，每个事件均以真实患病状态为条件：\n- $D$：该人确实患病。\n- $T_{\\mathrm{PCR}}$：聚合酶链式反应（PCR）核酸扩增检测呈阳性。\n- $T_{\\mathrm{RAT}}$：快速抗原检测（RAT）呈阳性。\n- $T_{\\mathrm{ELISA}}$：酶联免疫吸附测定（ELISA）检测免疫球蛋白M（IgM）呈阳性。\n- $S_{\\mathrm{fever}}$：出现发热。\n- $S_{\\mathrm{rash}}$：出现斑丘疹。\n- $S_{\\mathrm{cough}}$：出现咳嗽。\n\n监测病例定义为：如果满足以下条件，则病例被标记\n$$\nC \\equiv T_{\\mathrm{PCR}} \\;\\lor\\; \\Big(T_{\\mathrm{RAT}} \\land \\big(S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}}\\big)\\Big) \\;\\lor\\; \\Big(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}}\\Big).\n$$\n\n假设在给定真实患病的情况下条件独立，即在给定 $D$ 的条件下，六个组成指标 $T_{\\mathrm{PCR}}$、$T_{\\mathrm{RAT}}$、$T_{\\mathrm{ELISA}}$、$S_{\\mathrm{fever}}$、$S_{\\mathrm{rash}}$ 和 $S_{\\mathrm{cough}}$ 是相互独立的。\n\n假设以下各组成部分的灵敏度（以 $D$ 为条件的概率）通过验证性研究和临床监测确定如下：\n- $P\\!\\left(T_{\\mathrm{PCR}} \\mid D\\right) = 0.94$，\n- $P\\!\\left(T_{\\mathrm{RAT}} \\mid D\\right) = 0.78$，\n- $P\\!\\left(T_{\\mathrm{ELISA}} \\mid D\\right) = 0.85$，\n- $P\\!\\left(S_{\\mathrm{fever}} \\mid D\\right) = 0.82$，\n- $P\\!\\left(S_{\\mathrm{rash}} \\mid D\\right) = 0.60$，\n- $P\\!\\left(S_{\\mathrm{cough}} \\mid D\\right) = 0.55$。\n\n从灵敏度作为 $P\\!\\left(C \\mid D\\right)$ 的第一性原理和概率公理出发，在这些假设下，推导并计算病例定义 $C$ 的总体逻辑灵敏度。将最终数值答案表示为小数，并四舍五入至四位有效数字。", "solution": "用户希望我验证并解决一个问题陈述。\n\n### 步骤 1：提取已知条件\n- **事件**：\n  - $D$：该人确实患病。\n  - $T_{\\mathrm{PCR}}$：聚合酶链式反应（PCR）核酸扩增检测呈阳性。\n  - $T_{\\mathrm{RAT}}$：快速抗原检测（RAT）呈阳性。\n  - $T_{\\mathrm{ELISA}}$：酶联免疫吸附测定（ELISA）检测免疫球蛋白M（IgM）呈阳性。\n  - $S_{\\mathrm{fever}}$：出现发热。\n  - $S_{\\mathrm{rash}}$：出现斑丘疹。\n  - $S_{\\mathrm{cough}}$：出现咳嗽。\n- **监测病例定义**：如果事件 $C$ 发生，则标记为病例，其中\n$$\nC \\equiv T_{\\mathrm{PCR}} \\;\\lor\\; \\Big(T_{\\mathrm{RAT}} \\land \\big(S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}}\\big)\\Big) \\;\\lor\\; \\Big(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}}\\Big).\n$$\n- **假设**：六个组成指标 $T_{\\mathrm{PCR}}$、$T_{\\mathrm{RAT}}$、$T_{\\mathrm{ELISA}}$、$S_{\\mathrm{fever}}$、$S_{\\mathrm{rash}}$ 和 $S_{\\mathrm{cough}}$ 在给定真实患病状态 $D$ 的条件下相互独立。\n- **组成部分灵敏度**：\n  - $P(T_{\\mathrm{PCR}} \\mid D) = 0.94$\n  - $P(T_{\\mathrm{RAT}} \\mid D) = 0.78$\n  - $P(T_{\\mathrm{ELISA}} \\mid D) = 0.85$\n  - $P(S_{\\mathrm{fever}} \\mid D) = 0.82$\n  - $P(S_{\\mathrm{rash}} \\mid D) = 0.60$\n  - $P(S_{\\mathrm{cough}} \\mid D) = 0.55$\n- **目标**：推导并计算病例定义 $C$ 的总体逻辑灵敏度，其定义为 $P(C \\mid D)$。\n- **最终答案格式**：数值答案必须是四舍五入到四位有效数字的小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是概率论在评估诊断或监测病例定义中的一个标准应用，这是流行病学和医学信息学的核心任务。使用不同类型的证据（实验室检测、临床体征）并通过布尔逻辑将其组合是真实的。给定的灵敏度值对于各自的方法是现实的。条件独立性的概念虽然是一个强假设，但在构建此类模型时是一种常见且必要的简化。该问题在科学上是合理的。\n- **定义良好**：问题定义良好。它为标准 $C$ 提供了清晰的逻辑表达式，给出了所有必要的输入概率（组成部分灵敏度），并明确说明了计算所需的条件独立性假设。目标，即计算 $P(C \\mid D)$，是明确的。存在唯一的数学解，并且可以从所提供的信息中推导出来。\n- **客观性**：该问题以精确、客观、形式化的数学和流行病学语言陈述。没有主观或含糊的术语。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。它在科学上是合理的，定义良好且客观。我现在将进行完整的推导和求解。\n\n目标是计算病例定义 $C$ 的总体灵敏度，即概率 $P(C \\mid D)$。为简化符号，令 $p(E)$ 表示任何事件 $E$ 在给定真实患病状态 $D$ 下的条件概率，即 $p(E) \\equiv P(E \\mid D)$。问题的已知条件可以写作：\n- $p(T_{\\mathrm{PCR}}) = 0.94$\n- $p(T_{\\mathrm{RAT}}) = 0.78$\n- $p(T_{\\mathrm{ELISA}}) = 0.85$\n- $p(S_{\\mathrm{fever}}) = 0.82$\n- $p(S_{\\mathrm{rash}}) = 0.60$\n- $p(S_{\\mathrm{cough}}) = 0.55$\n\n病例定义是三个子句的逻辑析取（OR）：\n$$ C \\equiv C_1 \\lor C_2 \\lor C_3 $$\n其中\n- $C_1 \\equiv T_{\\mathrm{PCR}}$\n- $C_2 \\equiv T_{\\mathrm{RAT}} \\land (S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}})$\n- $C_3 \\equiv T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}}$\n\n这些子句不是独立的，因为 $C_2$ 和 $C_3$ 都依赖于事件 $S_{\\mathrm{rash}}$。直接应用容斥原理是可能的，但计算量很大。一种更有条理的方法是根据共享事件 $S_{\\mathrm{rash}}$ 的状态对问题进行划分。使用全概率公式，我们可以将 $p(C)$ 表示为：\n$$ p(C) = p(C \\land S_{\\mathrm{rash}}) + p(C \\land \\neg S_{\\mathrm{rash}}) $$\n我们将分别计算每一项。\n\n**第 1 项：计算 $p(C \\land S_{\\mathrm{rash}})$**\n\n我们首先简化事件 $C \\land S_{\\mathrm{rash}}$ 的逻辑表达式：\n$$ C \\land S_{\\mathrm{rash}} \\equiv \\Big(T_{\\mathrm{PCR}} \\lor \\big(T_{\\mathrm{RAT}} \\land (S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}})\\big) \\lor \\big(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}}\\big)\\Big) \\land S_{\\mathrm{rash}} $$\n根据逻辑的分配律，我们有：\n$$ (T_{\\mathrm{PCR}} \\land S_{\\mathrm{rash}}) \\lor \\big(T_{\\mathrm{RAT}} \\land (S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}}) \\land S_{\\mathrm{rash}}\\big) \\lor \\big(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}} \\land S_{\\mathrm{rash}}\\big) $$\n使用吸收律 $(A \\lor B) \\land B \\equiv B$，项 $(S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}}) \\land S_{\\mathrm{rash}}$ 简化为 $S_{\\mathrm{rash}}$。表达式变为：\n$$ (T_{\\mathrm{PCR}} \\land S_{\\mathrm{rash}}) \\lor (T_{\\mathrm{RAT}} \\land S_{\\mathrm{rash}}) \\lor (T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}}) $$\n提取公因子 $S_{\\mathrm{rash}}$ 得：\n$$ C \\land S_{\\mathrm{rash}} \\equiv S_{\\mathrm{rash}} \\land \\Big( T_{\\mathrm{PCR}} \\lor T_{\\mathrm{RAT}} \\lor (T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}}) \\Big) $$\n事件 $S_{\\mathrm{rash}}$、$T_{\\mathrm{PCR}}$、$T_{\\mathrm{RAT}}$、$T_{\\mathrm{ELISA}}$ 和 $S_{\\mathrm{cough}}$ 在给定 $D$ 的情况下都是相互独立的。因此，事件 $S_{\\mathrm{rash}}$ 与事件 $K \\equiv T_{\\mathrm{PCR}} \\lor T_{\\mathrm{RAT}} \\lor (T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}})$ 是独立的。我们可以将概率写成乘积形式：\n$$ p(C \\land S_{\\mathrm{rash}}) = p(S_{\\mathrm{rash}}) \\times p(K) $$\n为了求 $p(K)$，我们注意到其构成事件 $T_{\\mathrm{PCR}}$、$T_{\\mathrm{RAT}}$ 和 $(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}})$ 依赖于原始独立指标的不相交集合。因此，它们是相互独立的。计算其补集 $\\neg K$ 的概率更容易：\n$$ p(K) = 1 - p(\\neg K) = 1 - p(\\neg T_{\\mathrm{PCR}} \\land \\neg T_{\\mathrm{RAT}} \\land \\neg(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}})) $$\n$$ p(K) = 1 - p(\\neg T_{\\mathrm{PCR}}) \\times p(\\neg T_{\\mathrm{RAT}}) \\times p(\\neg(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}})) $$\n我们计算各组成部分的概率：\n- $p(\\neg T_{\\mathrm{PCR}}) = 1 - p(T_{\\mathrm{PCR}}) = 1 - 0.94 = 0.06$\n- $p(\\neg T_{\\mathrm{RAT}}) = 1 - p(T_{\\mathrm{RAT}}) = 1 - 0.78 = 0.22$\n- $p(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}}) = p(T_{\\mathrm{ELISA}}) \\times p(S_{\\mathrm{cough}}) = 0.85 \\times 0.55 = 0.4675$\n- $p(\\neg(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}})) = 1 - 0.4675 = 0.5325$\n将这些代入 $p(K)$ 的表达式中：\n$$ p(K) = 1 - (0.06 \\times 0.22 \\times 0.5325) = 1 - (0.0132 \\times 0.5325) = 1 - 0.007029 = 0.992971 $$\n现在我们可以计算第一项了：\n$$ p(C \\land S_{\\mathrm{rash}}) = p(S_{\\mathrm{rash}}) \\times p(K) = 0.60 \\times 0.992971 = 0.5957826 $$\n\n**第 2 项：计算 $p(C \\land \\neg S_{\\mathrm{rash}})$**\n\n类似地，我们简化 $C \\land \\neg S_{\\mathrm{rash}}$ 的逻辑表达式：\n$$ C \\land \\neg S_{\\mathrm{rash}} \\equiv \\Big(T_{\\mathrm{PCR}} \\lor \\big(T_{\\mathrm{RAT}} \\land (S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}})\\big) \\lor \\big(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}}\\big)\\Big) \\land \\neg S_{\\mathrm{rash}} $$\n分配 $\\land \\neg S_{\\mathrm{rash}}$：\n$$ (T_{\\mathrm{PCR}} \\land \\neg S_{\\mathrm{rash}}) \\lor \\big(T_{\\mathrm{RAT}} \\land (S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}}) \\land \\neg S_{\\mathrm{rash}}\\big) \\lor \\big(T_{\\mathrm{ELISA}} \\land S_{\\mathrm{cough}} \\land S_{\\mathrm{rash}} \\land \\neg S_{\\mathrm{rash}}\\big) $$\n第三个子句包含 $S_{\\mathrm{rash}} \\land \\neg S_{\\mathrm{rash}}$，这是一个逻辑矛盾（假），因此该项消失。在第二个子句中，$(S_{\\mathrm{fever}} \\lor S_{\\mathrm{rash}}) \\land \\neg S_{\\mathrm{rash}}$ 简化为 $S_{\\mathrm{fever}} \\land \\neg S_{\\mathrm{rash}}$。表达式变为：\n$$ (T_{\\mathrm{PCR}} \\land \\neg S_{\\mathrm{rash}}) \\lor (T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}} \\land \\neg S_{\\mathrm{rash}}) $$\n提取公因子 $\\neg S_{\\mathrm{rash}}$：\n$$ C \\land \\neg S_{\\mathrm{rash}} \\equiv \\neg S_{\\mathrm{rash}} \\land \\Big( T_{\\mathrm{PCR}} \\lor (T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}}) \\Big) $$\n和之前一样，$\\neg S_{\\mathrm{rash}}$ 与事件 $L \\equiv T_{\\mathrm{PCR}} \\lor (T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}})$ 是独立的。其概率为：\n$$ p(C \\land \\neg S_{\\mathrm{rash}}) = p(\\neg S_{\\mathrm{rash}}) \\times p(L) $$\n我们利用其补集来计算 $p(L)$，注意到 $T_{\\mathrm{PCR}}$ 和 $(T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}})$ 是独立的：\n$$ p(L) = 1 - p(\\neg L) = 1 - p(\\neg T_{\\mathrm{PCR}} \\land \\neg(T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}})) $$\n$$ p(L) = 1 - p(\\neg T_{\\mathrm{PCR}}) \\times p(\\neg(T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}})) $$\n我们计算各组成部分的概率：\n- $p(\\neg S_{\\mathrm{rash}}) = 1 - p(S_{\\mathrm{rash}}) = 1 - 0.60 = 0.40$\n- $p(\\neg T_{\\mathrm{PCR}})$ 已知为 $0.06$。\n- $p(T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}}) = p(T_{\\mathrm{RAT}}) \\times p(S_{\\mathrm{fever}}) = 0.78 \\times 0.82 = 0.6396$\n- $p(\\neg(T_{\\mathrm{RAT}} \\land S_{\\mathrm{fever}})) = 1 - 0.6396 = 0.3604$\n将这些代入 $p(L)$ 的表达式中：\n$$ p(L) = 1 - (0.06 \\times 0.3604) = 1 - 0.021624 = 0.978376 $$\n现在我们可以计算第二项了：\n$$ p(C \\land \\neg S_{\\mathrm{rash}}) = p(\\neg S_{\\mathrm{rash}}) \\times p(L) = 0.40 \\times 0.978376 = 0.3913504 $$\n\n**最终组合**\n\n总概率 $p(C)$ 是这两项的和：\n$$ p(C) = p(C \\land S_{\\mathrm{rash}}) + p(C \\land \\neg S_{\\mathrm{rash}}) $$\n$$ p(C) = 0.5957826 + 0.3913504 = 0.987133 $$\n病例定义的总体灵敏度是 $0.987133$。问题要求答案四舍五入到四位有效数字。\n$$ P(C \\mid D) \\approx 0.9871 $$", "answer": "$$\\boxed{0.9871}$$", "id": "4836625"}, {"introduction": "免疫信息系统不仅记录疫苗接种历史，更在上市后安全监测中扮演着关键角色。本练习将介绍药物警戒领域的一项核心技术——使用“报告比例比”（Proportional Reporting Ratio, $PRR$）进行信号检测。通过计算$PRR$及其置信区间，你将学会如何从大规模不良事件报告数据中识别出值得关注的统计信号，这是保障公众健康的重要一环。", "problem": "国家免疫信息系统 (NIIS) 整合自发性不良事件报告，用于疫苗的上市后安全监测。在信号检测中，报告比例比 (Proportional Reporting Ratio, PRR) 用于比较某一特定疫苗的所有事件报告中目标事件所占的比例与所有其他疫苗的相应比例。考虑在一个固定的监测期内，针对目标不良事件 $E$ 和目标疫苗 $V_A$，存在以下科学上合理的 $2 \\times 2$ 共现摘要表：\n- 关于疫苗 $V_A$ 的报告：事件 $E$ 发生在 85 份报告中，所有其他事件发生在 915 份报告中。\n- 所有其他疫苗的合并报告：事件 $E$ 发生在 240 份报告中，所有其他事件发生在 8760 份报告中。\n请从比例的核心定义、事件计数的二项方差以及比例的光滑函数的大样本正态近似出发，计算疫苗 $V_A$ 与事件 $E$ 的报告比例比 (PRR) 及其近似的 $95\\%$ 置信区间（使用对数正态近似法）。将 PRR 及置信区间的界限值四舍五入至 3 位有效数字。最终数值答案无需单位。此外，请根据您的计算值，在解题方案中简要解释不成比例报告的程度（相对于无不成比例的零期望）。", "solution": "该问题要求基于一个自发报告系统提供的计数数据，计算特定疫苗-事件对的报告比例比 ($PRR$) 及其相关的 $95\\%$ 置信区间。该问题在药物警戒领域提法明确且具有科学依据。\n\n首先，我们将所提供的数据整理成一个标准的 $2 \\times 2$ 列联表。设 $E$ 为目标不良事件，$V_A$ 为目标疫苗。数据可整理如下，其中 $a$、$b$、$c$ 和 $d$ 是报告计数：\n\n| | 事件 $E$ | 其他事件 | 总计 |\n|---------------|:---------:|:------------:|:----------:|\n| 疫苗 $V_A$ | $a$ | $b$ | $a+b$ |\n| 其他疫苗 | $c$ | $d$ | $c+d$ |\n\n根据题目陈述，我们已知：\n- $a = 85$（疫苗 $V_A$ 的 $E$ 事件报告数）\n- $b = 915$（疫苗 $V_A$ 的其他事件报告数）\n- $c = 240$（所有其他疫苗的 $E$ 事件报告数）\n- $d = 8760$（所有其他疫苗的其他事件报告数）\n\n根据这些计数，我们可以计算每个疫苗组的总数：\n- 疫苗 $V_A$ 的总报告数：$n_A = a+b = 85 + 915 = 1000$\n- 其他疫苗的总报告数：$n_O = c+d = 240 + 8760 = 9000$\n\n报告比例比 ($PRR$) 定义为两个比例的比值。第一个比例 $p_A$ 是疫苗 $V_A$ 的报告中事件 $E$ 所占的比例。第二个比例 $p_O$ 是所有其他疫苗合并报告中的相应比例。\n\n疫苗 $V_A$ 报告中事件 $E$ 的比例为：\n$$p_A = \\frac{a}{a+b} = \\frac{85}{1000} = 0.085$$\n\n其他疫苗报告中事件 $E$ 的比例为：\n$$p_O = \\frac{c}{c+d} = \\frac{240}{9000} = \\frac{24}{900} = \\frac{2}{75} \\approx 0.02667$$\n\n$PRR$ 是这两个比例的比值：\n$$PRR = \\frac{p_A}{p_O} = \\frac{a/(a+b)}{c/(c+d)} = \\frac{0.085}{2/75} = 0.085 \\times 37.5 = 3.1875$$\n四舍五入至 3 位有效数字，$PRR$ 为 $3.19$。\n\n接下来，我们使用对数正态近似法计算 $PRR$ 的 $95\\%$ 置信区间 ($CI$)。这涉及到计算 $PRR$ 的自然对数 $\\ln(PRR)$ 的置信区间，然后对该区间的端点取指数。此计算需要 $\\ln(PRR)$ 的方差。\n\n$\\ln(PRR)$ 的表达式为：\n$$\\ln(PRR) = \\ln\\left(\\frac{p_A}{p_O}\\right) = \\ln(p_A) - \\ln(p_O)$$\n由于两组报告（疫苗 $V_A$ 的报告和其他疫苗的报告）是独立的，其对数比例之差的方差是它们各自方差的和：\n$$Var(\\ln(PRR)) = Var(\\ln(p_A)) + Var(\\ln(p_O))$$\n估计比例 $\\hat{p} = k/n$ 的对数的方差可以使用 delta 方法来近似。事件数 $k$ 被视为一个二项随机变量 $K \\sim Bin(n, \\pi)$，其中 $\\hat{p}$ 是 $\\pi$ 的估计值。$\\hat{p}$ 的方差是 $Var(\\hat{p}) = \\frac{\\pi(1-\\pi)}{n}$。\n$$Var(\\ln(\\hat{p})) \\approx \\left(\\frac{d}{d\\pi} \\ln(\\pi)\\right)^2 Var(\\hat{p}) = \\left(\\frac{1}{\\pi}\\right)^2 \\frac{\\pi(1-\\pi)}{n} = \\frac{1-\\pi}{n\\pi}$$\n我们通过代入观察到的比例 $\\hat{p} = k/n$ 来估计这个方差：\n$$s^2(\\ln(\\hat{p})) = \\frac{1-\\hat{p}}{n\\hat{p}} = \\frac{1 - k/n}{n(k/n)} = \\frac{(n-k)/n}{k} = \\frac{n-k}{nk}$$\n将此公式应用于我们的两个比例 $p_A$ 和 $p_O$：\n- 对于 $p_A = a/(a+b)$，估计方差为 $Var(\\ln(p_A)) \\approx \\frac{(a+b)-a}{a(a+b)} = \\frac{b}{a(a+b)}$。\n- 对于 $p_O = c/(c+d)$，估计方差为 $Var(\\ln(p_O)) \\approx \\frac{(c+d)-c}{c(c+d)} = \\frac{d}{c(c+d)}$。\n\n因此，$\\ln(PRR)$ 的方差估计为：\n$$Var(\\ln(PRR)) \\approx \\frac{b}{a(a+b)} + \\frac{d}{c(c+d)}$$\n代入给定值：\n$$Var(\\ln(PRR)) \\approx \\frac{915}{85(1000)} + \\frac{8760}{240(9000)} = \\frac{915}{85000} + \\frac{8760}{2160000} \\approx 0.0107647 + 0.0040556 \\approx 0.0148203$$\n$\\ln(PRR)$ 的标准误 ($SE$) 是其方差的平方根：\n$$SE(\\ln(PRR)) = \\sqrt{Var(\\ln(PRR))} \\approx \\sqrt{0.0148203} \\approx 0.121738$$\n$\\ln(PRR)$ 的近似 $95\\%$ 置信区间由 $\\ln(PRR) \\pm z_{1-\\alpha/2} \\times SE(\\ln(PRR))$ 给出，其中 $\\alpha=0.05$，标准正态分布的临界值为 $z_{0.975} \\approx 1.96$。\n$\\ln(PRR)$ 的值为 $\\ln(3.1875) \\approx 1.15926$。\n误差幅度 ($ME$) 为 $1.96 \\times 0.121738 \\approx 0.23861$。\n$\\ln(PRR)$ 的 $95\\%$ 置信区间为：\n$$1.15926 \\pm 0.23861 = [0.92065, 1.39787]$$\n为了获得 $PRR$ 的置信区间，我们对对数尺度区间的下限和上限取指数：\n- 下限：$CI_{low} = \\exp(0.92065) \\approx 2.5109$\n- 上限：$CI_{high} = \\exp(1.39787) \\approx 4.0463$\n将界限值四舍五入至 3 位有效数字，得到 $PRR$ 的 $95\\%$ 置信区间为 $(2.51, 4.05)$。\n\n解释：零期望（即疫苗 $V_A$ 与其他疫苗之间的报告无不成比例性）对应于 $PRR$ 为 1。我们计算出的 $PRR$ 点估计值为 $3.19$，这表明，与数据库中所有其他疫苗相比，疫苗 $V_A$ 的不良事件 $E$ 报告频率高出 3 倍以上。$(2.51, 4.05)$ 的 $95\\%$ 置信区间不包含零值 1。这为不成比例性提供了统计学上显著的证据。这一结果构成一个统计学上的“信号”，通常会促使安全专家进行进一步调查，以评估疫苗 $V_A$ 与事件 $E$ 之间可能存在的因果关系。", "answer": "$$\\boxed{\\begin{pmatrix} 3.19  2.51  4.05 \\end{pmatrix}}$$", "id": "4836679"}]}