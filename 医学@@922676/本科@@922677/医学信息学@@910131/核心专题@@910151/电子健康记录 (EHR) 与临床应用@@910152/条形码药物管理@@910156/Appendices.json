{"hands_on_practices": [{"introduction": "本练习是评估条码用药管理 (BCMA) 系统风险的起点。它将帮助你理解，一个复杂的系统是如何由多个可能出错的环节组成的，并学习如何用概率论来量化这些环节对最终用药安全的综合影响。通过这个练习 [@problem_id:4823881]，你将掌握分析系统中各个独立组件的故障率如何共同决定整体风险的方法。", "problem": "一家医院使用条形码药物管理（BCMA）系统来减少给错病人或给错药物的用药错误。药物从自动配药柜（ADC）中取出，然后在床边，护士扫描药物条形码和病人腕带条形码，与电子用药管理记录进行交叉核对。考虑单次用药管理的以下模型：\n- ADC取药不正确的概率为 $r_{A}$，这代表由于拣选或库存错误导致错误的药物送达床边。\n- 由于条形码无法读取或缺失，药物条形码扫描失败的概率为 $r_{M}$。\n- 由于腕带损坏或缺失，病人腕带扫描失败的概率为 $r_{P}$。\n- 如果两次床边扫描都成功，BCMA将以概率 $1$ 阻止任何错误的药物给药。\n- 如果两次扫描中至少有一次失败，交叉核对将不可用；在这种情况下，护士可以以概率 $r_{O}$ 强行操作，此时错误的药物给药将不会被拦截。\n假设 $A$（ADC错误）、$M$（药物扫描失败）和 $P$（病人扫描失败）是独立事件，并且强行操作的决定独立于ADC错误，仅取决于交叉核对的不可用性。仅使用基本概率规则和独立性来推导错误药物给到病人的联合风险。\n\n基线率为 $r_{A}=0.002$，$r_{M}=0.015$，$r_{P}=0.008$ 和 $r_{O}=0.25$。医院计划实施三项系统级控制措施：\n1. 重新设计ADC药箱照明和引导拣选，以将 $r_{A}$ 降低 $35\\%$。\n2. 改善条形码质量和腕带重印政策，以将 $r_{M}$ 降低 $40\\%$ 并将 $r_{P}$ 降低 $25\\%$。\n3. 一项硬停止政策，将条件性强行操作概率降低至 $r_{O}^{\\prime}=k\\,r_{O}$，其中因子 $k \\in (0,1]$。\n\n设干预后的参数为 $r_{A}^{\\prime}=0.65\\,r_{A}$，$r_{M}^{\\prime}=0.60\\,r_{M}$，$r_{P}^{\\prime}=0.75\\,r_{P}$ 和 $r_{O}^{\\prime}=k\\,r_{O}$。医院的目标是实现每次用药的错误给药概率不大于 $t=3.0 \\times 10^{-6}$。\n\n使用独立性假设和概率论第一性原理（乘法法则和容斥原理），推导干预后联合风险的表达式，并计算满足目标 $t$ 的最小 $k$ 值。将您最终的 $k$ 值表示为四舍五入到四位有效数字的小数。", "solution": "问题要求推导错误药物给药的联合风险，并计算一个控制参数 $k$ 以满足指定的风险目标。该问题提法清晰，科学上基于风险分析和概率论，因此可以推导出解决方案。\n\n设 $E$ 为错误药物给到病人的事件。要发生此事件，必须发生一系列故障：\n$1$. 从自动配药柜（ADC）取药时必须发生初始错误。设此事件为 $A$。其概率给出为 $P(A) = r_A$。\n$2$. 这个错误必须未被床边的条形码药物管理（BCMA）系统拦截。\n\nBCMA系统当且仅当药物条形码扫描和病人腕带扫描均成功时，才能拦截错误。设 $M$ 为药物扫描失败的事件，概率为 $P(M) = r_M$；设 $P$ 为病人扫描失败的事件，概率为 $P(P) = r_P$。\n如果这些扫描中至少有一个失败，BCMA检查就会失败。这对应于事件 $M \\cup P$。\n\n如果BCMA检查失败（即事件 $M \\cup P$ 发生），系统会发出警告。问题陈述，护士可以忽略此警告并继续给药。设 $O$ 为护士强行操作的事件。此强行操作是以BCMA检查失败为条件的。问题给出了条件概率 $P(O | M \\cup P) = r_O$。强行操作意味着错误的药物被给予。\n\n因此，错误药物给药事件 $E$ 发生，当且仅当事件 $A$ 发生，随后BCMA检查失败，并接着发生强行操作。这可以表示为事件的交集：\n$$E = A \\cap (M \\cup P) \\cap O$$\n我们需要求 $P(E)$。问题陈述 $A$、$M$ 和 $P$ 是独立事件。它还陈述强行操作的决定 $O$ 独立于ADC错误 $A$，并且仅取决于扫描失败事件 $M \\cup P$。\n这意味着事件 $A$ 与复合事件 $((M \\cup P) \\cap O)$ 独立。使用独立事件的乘法法则：\n$$P(E) = P(A) \\cdot P((M \\cup P) \\cap O)$$\n使用条件概率的定义，我们可以写出：\n$$P((M \\cup P) \\cap O) = P(O | M \\cup P) \\cdot P(M \\cup P)$$\n问题给出 $P(O | M \\cup P) = r_O$。\n为了求 $P(M \\cup P)$，我们使用概率的容斥原理：\n$$P(M \\cup P) = P(M) + P(P) - P(M \\cap P)$$\n由于 $M$ 和 $P$ 是独立事件，所以 $P(M \\cap P) = P(M)P(P) = r_M r_P$。\n代入此式，我们得到：\n$$P(M \\cup P) = r_M + r_P - r_M r_P$$\n将所有部分组合起来，错误药物给药的联合风险表达式为：\n$$P(E) = P(A) \\cdot P(O | M \\cup P) \\cdot P(M \\cup P) = r_A \\cdot r_O \\cdot (r_M + r_P - r_M r_P)$$\n这是风险的一般表达式。\n\n接下来，我们考虑干预后的参数：\n$r_{A}^{\\prime}=0.65\\,r_{A}$\n$r_{M}^{\\prime}=0.60\\,r_{M}$\n$r_{P}^{\\prime}=0.75\\,r_{P}$\n$r_{O}^{\\prime}=k\\,r_{O}$\n\n基线率为 $r_{A}=0.002$，$r_{M}=0.015$，$r_{P}=0.008$ 和 $r_{O}=0.25$。\n让我们计算新的基线概率：\n$r_{A}^{\\prime} = 0.65 \\times 0.002 = 0.0013$\n$r_{M}^{\\prime} = 0.60 \\times 0.015 = 0.009$\n$r_{P}^{\\prime} = 0.75 \\times 0.008 = 0.006$\n干预后的条件性强行操作概率不是一个固定值，而是给出为 $r_O' = k \\cdot r_O = k \\cdot 0.25$。\n\n干预后的风险 $P(E')$ 由带有撇号参数的相同公式给出：\n$$P(E') = r_{A}^{\\prime} \\cdot r_{O}^{\\prime} \\cdot (r_{M}^{\\prime} + r_{P}^{\\prime} - r_{M}^{\\prime}r_{P}^{\\prime})$$\n$$P(E') = r_{A}^{\\prime} \\cdot (k \\cdot r_{O}) \\cdot (r_{M}^{\\prime} + r_{P}^{\\prime} - r_{M}^{\\prime}r_{P}^{\\prime})$$\n医院的目标是实现风险不大于 $t=3.0 \\times 10^{-6}$。所以我们必须满足不等式：\n$$P(E') \\le t$$\n问题要求“满足目标的最小k值”。由于当 $k \\in (0,1]$ 时，风险 $P(E')$ 与 $k$ 成正比，较小的 $k$ 对应较低的风险。任何低于某个阈值的 $k$ 都将满足目标。短语“最小k值”被解释为询问边界情况，即风险恰好等于目标，$P(E')=t$。这个值代表了仍然满足安全目标的 $k$ 的最大允许值（即最不严格的策略）。\n\n我们通过设置 $P(E') = t$ 来求解 $k$：\n$$k = \\frac{t}{r_{A}^{\\prime} \\cdot r_{O} \\cdot (r_{M}^{\\prime} + r_{P}^{\\prime} - r_{M}^{\\prime}r_{P}^{\\prime})}$$\n首先，我们计算扫描失败概率的项：\n$$P(M' \\cup P') = r_{M}^{\\prime} + r_{P}^{\\prime} - r_{M}^{\\prime}r_{P}^{\\prime} = 0.009 + 0.006 - (0.009)(0.006)$$\n$$P(M' \\cup P') = 0.015 - 0.000054 = 0.014946$$\n现在，将这些值代入 $k$ 的方程中：\n$$k = \\frac{3.0 \\times 10^{-6}}{(0.0013) \\cdot (0.25) \\cdot (0.014946)}$$\n$$k = \\frac{3.0 \\times 10^{-6}}{(0.000325) \\cdot (0.014946)}$$\n$$k = \\frac{3.0 \\times 10^{-6}}{4.85745 \\times 10^{-6}}$$\n$$k = \\frac{3.0}{4.85745} \\approx 0.61763500$$\n问题要求答案四舍五入到四位有效数字。\n$$k \\approx 0.6176$$\n该值在指定的定义域 $k \\in (0, 1]$ 内。\n这意味着，在其他改进措施已经实施的情况下，条件性强行操作概率 $r_O$ 必须至少降低 $1 - 0.6176 = 0.3824$（即 $38.24\\%$），才能达到目标风险水平。因子 $k$ 本身为 $0.6176$。", "answer": "$$\\boxed{0.6176}$$", "id": "4823881"}, {"introduction": "在理想化的模型之后，我们必须面对现实世界中的复杂性，尤其是人的行为因素。本练习 [@problem_id:4823949] 旨在量化临床实践中常见的“变通操作” (workaround) 对用药错误的风险有多大影响。掌握这种量化方法，对于评估系统实际运行效果、推动质量改进和流程再造至关重要。", "problem": "一家医院部署了条形码用药管理系统（BCMA），该系统依靠扫描患者腕带和每份单剂量药品来强制执行用药五对原则。尽管如此，观察到一种被称为“扫描主标签”的变通方法，即护士扫描一个主条形码，从而绕过单剂量级别的验证。\n\n假设一位质量改进分析师收集了三个住院病区一整个月的数据，并估计了在两种模式下的变通方法频率和条件错误概率：实际使用变通方法和标准合规扫描。设这三个病区为重症监护室（ICU）、内外科（Med-Surg）和儿科（Peds）。对于病区 $i \\in \\{\\text{ICU}, \\text{Med-Surg}, \\text{Peds}\\}$，定义：\n- $N_i$：该月内用药管理的总次数，\n- $f_i$：使用主标签扫描变通方法的用药管理观察频率（以小数表示），\n- $p_{w,i}$：在使用变通方法的情况下发生用药管理错误的条件概率，\n- $p_{s,i}$：在使用标准BCMA合规扫描的情况下发生用药管理错误的条件概率。\n\n分析师的估计值如下：\n- ICU：$N_{\\text{ICU}} = 12,000$, $f_{\\text{ICU}} = 0.10$, $p_{w,\\text{ICU}} = 0.004$, $p_{s,\\text{ICU}} = 0.0009$。\n- 内外科（Med-Surg）：$N_{\\text{Med-Surg}} = 28,000$, $f_{\\text{Med-Surg}} = 0.07$, $p_{w,\\text{Med-Surg}} = 0.003$, $p_{s,\\text{Med-Surg}} = 0.0006$。\n- 儿科（Peds）：$N_{\\text{Peds}} = 10,000$, $f_{\\text{Peds}} = 0.05$, $p_{w,\\text{Peds}} = 0.0025$, $p_{s,\\text{Peds}} = 0.0004$。\n\n使用期望值和全概率定律的核心定义，计算由变通方法导致的每次用药管理总体错误风险的预期增加量。该增加量定义为：在观察到的混合模式下全院平均错误概率与所有用药管理均使用标准BCMA合规扫描的反事实情景下的全院平均错误概率之差。将最终答案表示为小数概率，并四舍五入到四位有效数字。", "solution": "问题要求计算因使用变通方法而导致的每次用药管理总体错误风险的预期增加量。这被定义为在观察条件下全院平均错误概率与所有用药管理均符合标准程序的反事实情景下全院平均错误概率之间的差值。设此增加量为 $\\Delta P(E)$。\n\n设 $E$ 为用药管理错误的事件。设三个医院病区由索引 $i \\in \\{\\text{ICU}, \\text{Med-Surg}, \\text{Peds}\\}$ 表示。为每个病区 $i$ 提供的数据如下：\n- $N_i$：用药管理总次数\n- $f_i$：变通方法使用频率\n- $p_{w,i}$：使用变通方法情况下的条件错误概率\n- $p_{s,i}$：使用标准合规扫描情况下的条件错误概率\n\n这个问题可以通过应用全概率定律和加权平均的定义来解决。\n\n首先，我们计算观察到的全院平均错误概率 $P(E)_{\\text{obs}}$。这是每个病区错误概率的加权平均值。每个病区的权重是其用药管理次数占医院总次数的比例。\n\n医院的总用药管理次数为：\n$$N_{\\text{total}} = N_{\\text{ICU}} + N_{\\text{Med-Surg}} + N_{\\text{Peds}}$$\n$$N_{\\text{total}} = 12000 + 28000 + 10000 = 50000$$\n\n单个病区 $i$ 内发生错误的概率，我们称之为 $P_i(E)$，由全概率定律确定，以是否使用了变通方法（$W$）或标准程序（$S$）为条件。\n$$P_i(E) = P(E|W)P(W) + P(E|S)P(S)$$\n根据问题的符号表示，对于病区 $i$，$P(W) = f_i$ 且 $P(S) = 1-f_i$。条件概率为 $P(E|W) = p_{w,i}$ 和 $P(E|S) = p_{s,i}$。\n因此，病区 $i$ 的平均错误概率为：\n$$P_i(E) = p_{w,i} f_i + p_{s,i}(1 - f_i)$$\n\n观察到的全院平均错误概率 $P(E)_{\\text{obs}}$ 是各病区特定错误概率的加权平均值，其中权重 $w_i = \\frac{N_i}{N_{\\text{total}}}$ 是每个病区用药管理次数占总数的比例。\n$$P(E)_{\\text{obs}} = \\sum_{i} w_i P_i(E) = \\sum_{i} \\frac{N_i}{N_{\\text{total}}} \\left[ p_{w,i} f_i + p_{s,i}(1 - f_i) \\right]$$\n\n接下来，我们计算在从不使用变通方法的情景下的反事实全院平均错误概率 $P(E)_{\\text{cf}}$。在这种情况下，对于每个病区 $i$，变通方法的使用频率 $f_i = 0$，所有用药管理都遵循标准程序。每个病区 $i$ 的错误概率将简化为 $p_{s,i}$。\n\n反事实的全院错误概率是这些标准程序错误概率的加权平均值：\n$$P(E)_{\\text{cf}} = \\sum_{i} w_i p_{s,i} = \\sum_{i} \\frac{N_i}{N_{\\text{total}}} p_{s,i}$$\n\n每次用药管理总体错误风险的预期增加量是这两个概率之差：\n$$\\Delta P(E) = P(E)_{\\text{obs}} - P(E)_{\\text{cf}}$$\n$$\\Delta P(E) = \\sum_{i} \\frac{N_i}{N_{\\text{total}}} \\left[ p_{w,i} f_i + p_{s,i}(1 - f_i) \\right] - \\sum_{i} \\frac{N_i}{N_{\\text{total}}} p_{s,i}$$\n我们可以合并求和项：\n$$\\Delta P(E) = \\frac{1}{N_{\\text{total}}} \\sum_{i} N_i \\left( [p_{w,i} f_i + p_{s,i}(1 - f_i)] - p_{s,i} \\right)$$\n简化求和号内的项：\n$$[p_{w,i} f_i + p_{s,i} - p_{s,i} f_i] - p_{s,i} = p_{w,i} f_i - p_{s,i} f_i = f_i(p_{w,i} - p_{s,i})$$\n因此，风险增加量的表达式简化为：\n$$\\Delta P(E) = \\frac{1}{N_{\\text{total}}} \\sum_{i} N_i f_i (p_{w,i} - p_{s,i})$$\n这个表达式很直观：它是所有病区因变通方法导致的额外错误总数，除以总用药管理次数，得出每次用药管理的平均风险增加量。\n\n现在，我们代入给定的数值。\n分子是 $\\sum_{i} N_i f_i (p_{w,i} - p_{s,i})$。让我们计算每个病区的项：\n对于 ICU ($i=\\text{ICU}$):\n$$N_{\\text{ICU}} f_{\\text{ICU}} (p_{w,\\text{ICU}} - p_{s,\\text{ICU}}) = 12000 \\times 0.10 \\times (0.004 - 0.0009) = 1200 \\times 0.0031 = 3.72$$\n对于内外科（Med-Surg）($i=\\text{Med-Surg}$):\n$$N_{\\text{Med-Surg}} f_{\\text{Med-Surg}} (p_{w,\\text{Med-Surg}} - p_{s,\\text{Med-Surg}}) = 28000 \\times 0.07 \\times (0.003 - 0.0006) = 1960 \\times 0.0024 = 4.704$$\n对于儿科（Peds）($i=\\text{Peds}$):\n$$N_{\\text{Peds}} f_{\\text{Peds}} (p_{w,\\text{Peds}} - p_{s,\\text{Peds}}) = 10000 \\times 0.05 \\times (0.0025 - 0.0004) = 500 \\times 0.0021 = 1.05$$\n\n这些项的总和给出了额外错误的总数：\n$$\\sum_{i} N_i f_i (p_{w,i} - p_{s,i}) = 3.72 + 4.704 + 1.05 = 9.474$$\n\n最后，我们除以总用药管理次数 $N_{\\text{total}} = 50000$：\n$$\\Delta P(E) = \\frac{9.474}{50000} = 0.00018948$$\n\n问题要求答案四舍五入到四位有效数字。第一位有效数字是 $1$。第四位是 $4$。后面的数字是 $8$，大于等于 $5$，所以我们向上进位。\n$$\\Delta P(E) \\approx 0.0001895$$\n这就是由变通方法导致的每次用药管理总体错误风险的预期增加量。", "answer": "$$\\boxed{0.0001895}$$", "id": "4823949"}, {"introduction": "识别风险之后，下一步便是优化系统以降低风险。本练习 [@problem_id:4823953] 将带你进入 BCMA 系统设计的核心，运用决策理论来寻找一个最佳的扫描匹配阈值。你将学习如何在“漏报”（拒绝正确匹配，False Negative）和“误报”（接受错误匹配，False Positive）这两类错误之间做出权衡，以最小化总体预期损失，这是医疗信息学中一项高级的系统优化技能。", "problem": "在条形码用药管理 (BCMA) 系统中，扫描引擎每次扫描患者腕带和药品时，都会产生一个连续的、无量纲的匹配分数 $s$。$s$ 的值越高，表明扫描的患者-药品配对正确的证据越强。假设以真实情况为条件的分数分布模型如下：在匹配正确 ($H_{1}$) 的假设下，$s \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$；在条码错误或患者错误 ($H_{0}$) 的假设下，$s \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$，且 $\\mu_{1} > \\mu_{0}$。系统使用一个阈值规则，当且仅当 $s \\ge t$ 时接受该匹配。\n\n给定某医院特定单元的以下参数：\n- 扫描时匹配正确的先验概率：$\\pi_{1} = 0.99$。\n- 扫描时出现错误条码的先验概率：$\\pi_{0} = 0.01$。\n- 分数分布参数：$\\mu_{1} = 2.0$，$\\mu_{0} = 0.0$，$\\sigma = 0.5$。\n- 决策成本（以抽象的安全成本单位计）：一次假阳性（接受错误条码）产生的成本为 $C_{\\mathrm{FP}} = 2000$，一次假阴性（拒绝正确匹配，即需要重新扫描并导致延误）产生的成本为 $C_{\\mathrm{FN}} = 2$。真阳性和真阴性结果被视为基准，无额外成本。\n\n仅从基本的决策理论原则（贝叶斯风险最小化）和正态概率密度函数的定义出发，完成以下任务：\n1. 将期望损失（风险）$R(t)$ 构建为阈值 $t$ 的函数，用 $C_{\\mathrm{FP}}$、$C_{\\mathrm{FN}}$、$\\pi_{0}$、$\\pi_{1}$ 和 $s$ 的条件分布表示。\n2. 从第一性原理出发，推导表征最小化 $R(t)$ 的阈值 $t^{\\ast}$ 的条件，并求解该条件，以获得在给定等方差高斯模型下 $t^{\\ast}$ 的闭式表达式。\n3. 对给定的参数值，数值计算 $t^{\\ast}$。将最终阈值四舍五入到四位有效数字。将结果表示为分数尺度上的单个实数（无量纲，无单位）。", "solution": "该问题要求推导和计算条形码用药管理 (BCMA) 系统的最优决策阈值。其框架是贝叶斯决策理论，旨在最小化与分类错误相关的期望成本（风险）。\n\n首先验证问题。\n\n**步骤1：提取给定条件**\n- 决策变量：连续匹配分数 $s$。\n- 假设：$H_1$（正确匹配），$H_0$（错误匹配）。\n- 条件概率分布：\n  - 对于正确匹配 ($H_1$)：$s \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$，其概率密度函数为 $p(s|H_1)$。\n  - 对于错误匹配 ($H_0$)：$s \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$，其概率密度函数为 $p(s|H_0)$。\n- 分布参数：$\\mu_{1} = 2.0$，$\\mu_{0} = 0.0$，$\\sigma = 0.5$。注意 $\\mu_{1} > \\mu_{0}$。\n- 先验概率：\n  - $P(H_1) = \\pi_{1} = 0.99$。\n  - $P(H_0) = \\pi_{0} = 0.01$。\n- 决策规则：如果 $s \\ge t$，则接受匹配；如果 $s  t$，则拒绝匹配。\n- 决策成本：\n  - 假阳性（在 $H_0$ 条件下接受）：$C_{\\mathrm{FP}} = 2000$。\n  - 假阴性（在 $H_1$ 条件下拒绝）：$C_{\\mathrm{FN}} = 2$。\n  - 真阳性（在 $H_1$ 条件下接受）：$C_{\\mathrm{TP}} = 0$。\n  - 真阴性（在 $H_0$ 条件下拒绝）：$C_{\\mathrm{TN}} = 0$。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题在科学上基于贝叶斯决策理论和信号检测理论，这些是此类分类任务的标准框架。问题是适定的，提供了找到唯一解所需的所有参数。语言客观、精确。参数是自洽的（$\\pi_0 + \\pi_1 = 1$），并且在应用背景下是合理的。该问题不违反任何无效性标准。\n\n**步骤3：结论与行动**\n问题是有效的。将提供一个完整、合理的解决方案。\n\n**第1部分：构建期望损失（风险）$R(t)$**\n\n期望损失或风险 $R(t)$ 是所有可能结果的成本之和，按各自的概率加权。结果由真实情况（$H_0$ 或 $H_1$）以及基于分数 $s$ 和阈值 $t$ 作出的决策来定义。产生非零成本的两类错误是假阳性和假阴性。\n\n假阳性 (FP) 发生于系统接受匹配 ($s \\ge t$)，但匹配实际上是错误的（$H_0$ 为真）。此事件的概率为 $P(\\text{接受}, H_0) = P(s \\ge t | H_0) P(H_0)$。\n假阴性 (FN) 发生于系统拒绝匹配 ($s  t$)，但匹配实际上是正确的（$H_1$ 为真）。此事件的概率为 $P(\\text{拒绝}, H_1) = P(s  t | H_1) P(H_1)$。\n\n总风险 $R(t)$ 是这两类错误产生的期望成本之和：\n$$ R(t) = C_{\\mathrm{FP}} \\cdot P(\\text{接受}, H_0) + C_{\\mathrm{FN}} \\cdot P(\\text{拒绝}, H_1) $$\n代入先验概率和决策的条件概率：\n$$ R(t) = C_{\\mathrm{FP}} \\pi_0 P(s \\ge t | H_0) + C_{\\mathrm{FN}} \\pi_1 P(s  t | H_1) $$\n条件概率是通过在决策区域上对各自的概率密度函数 (PDF) 进行积分得到的。设 $p(s|H_0)$ 和 $p(s|H_1)$ 分别为假设 $H_0$ 和 $H_1$ 下分数 $s$ 的概率密度函数。\n$$ P(s \\ge t | H_0) = \\int_{t}^{\\infty} p(s|H_0) \\, ds $$\n$$ P(s  t | H_1) = \\int_{-\\infty}^{t} p(s|H_1) \\, ds $$\n因此，作为阈值 $t$ 的函数的期望损失为：\n$$ R(t) = C_{\\mathrm{FP}} \\pi_0 \\int_{t}^{\\infty} p(s|H_0) \\, ds + C_{\\mathrm{FN}} \\pi_1 \\int_{-\\infty}^{t} p(s|H_1) \\, ds $$\n\n**第2部分：最优阈值 $t^{\\ast}$ 的推导与求解**\n\n为了找到最小化风险 $R(t)$ 的阈值 $t^{\\ast}$，我们必须对 $R(t)$ 关于 $t$ 求导，并令结果为零。我们使用莱布尼茨积分法则进行求导：$\\frac{d}{dx}\\int_{a}^{x}f(y)dy = f(x)$ 和 $\\frac{d}{dx}\\int_{x}^{b}f(y)dy = -f(x)$。\n\n对 $R(t)$ 求导：\n$$ \\frac{dR(t)}{dt} = C_{\\mathrm{FP}} \\pi_0 \\frac{d}{dt} \\left( \\int_{t}^{\\infty} p(s|H_0) \\, ds \\right) + C_{\\mathrm{FN}} \\pi_1 \\frac{d}{dt} \\left( \\int_{-\\infty}^{t} p(s|H_1) \\, ds \\right) $$\n$$ \\frac{dR(t)}{dt} = C_{\\mathrm{FP}} \\pi_0 (-p(t|H_0)) + C_{\\mathrm{FN}} \\pi_1 (p(t|H_1)) $$\n将导数设为零以求最优阈值 $t^{\\ast}$：\n$$ -C_{\\mathrm{FP}} \\pi_0 p(t^{\\ast}|H_0) + C_{\\mathrm{FN}} \\pi_1 p(t^{\\ast}|H_1) = 0 $$\n这就得出了最优阈值的特征条件：\n$$ C_{\\mathrm{FN}} \\pi_1 p(t^{\\ast}|H_1) = C_{\\mathrm{FP}} \\pi_0 p(t^{\\ast}|H_0) $$\n这个条件可以用似然比 $\\Lambda(t) = \\frac{p(t|H_1)}{p(t|H_0)}$ 表示：\n$$ \\Lambda(t^{\\ast}) = \\frac{p(t^{\\ast}|H_1)}{p(t^{\\ast}|H_0)} = \\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1} $$\n现在我们将给定的高斯概率密度函数代入此条件。正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数为 $p(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$。\n$$ \\frac{\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(t^{\\ast}-\\mu_1)^2}{2\\sigma^2}\\right)}{\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(t^{\\ast}-\\mu_0)^2}{2\\sigma^2}\\right)} = \\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1} $$\n由于方差相等，指数前因子 $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}$ 可以消去。\n$$ \\exp\\left(-\\frac{(t^{\\ast}-\\mu_1)^2}{2\\sigma^2} + \\frac{(t^{\\ast}-\\mu_0)^2}{2\\sigma^2}\\right) = \\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1} $$\n对两边取自然对数：\n$$ \\frac{(t^{\\ast}-\\mu_0)^2 - (t^{\\ast}-\\mu_1)^2}{2\\sigma^2} = \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n展开分子中的二次项：\n$$ ((t^{\\ast})^2 - 2t^{\\ast}\\mu_0 + \\mu_0^2) - ((t^{\\ast})^2 - 2t^{\\ast}\\mu_1 + \\mu_1^2) = 2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n$(t^{\\ast})^2$ 项消掉了。\n$$ -2t^{\\ast}\\mu_0 + \\mu_0^2 + 2t^{\\ast}\\mu_1 - \\mu_1^2 = 2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n合并含有 $t^{\\ast}$ 的项：\n$$ 2t^{\\ast}(\\mu_1 - \\mu_0) + (\\mu_0^2 - \\mu_1^2) = 2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n对平方差进行因式分解 $\\mu_0^2 - \\mu_1^2 = -(\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0)$：\n$$ 2t^{\\ast}(\\mu_1 - \\mu_0) - (\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0) = 2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n分离 $t^{\\ast}$ 项：\n$$ 2t^{\\ast}(\\mu_1 - \\mu_0) = (\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0) + 2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n最后，除以 $2(\\mu_1 - \\mu_0)$，这是允许的，因为 $\\mu_1  \\mu_0$ 意味着 $\\mu_1 - \\mu_0 \\neq 0$：\n$$ t^{\\ast} = \\frac{(\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0)}{2(\\mu_1 - \\mu_0)} + \\frac{2\\sigma^2}{2(\\mu_1 - \\mu_0)} \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n这可以简化为最优阈值的闭式表达式：\n$$ t^{\\ast} = \\frac{\\mu_1 + \\mu_0}{2} + \\frac{\\sigma^2}{\\mu_1 - \\mu_0} \\ln\\left(\\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1}\\right) $$\n\n**第3部分：$t^{\\ast}$ 的数值计算**\n\n我们将给定的参数值代入导出的 $t^{\\ast}$ 表达式中：\n- $\\mu_{1} = 2.0$\n- $\\mu_{0} = 0.0$\n- $\\sigma = 0.5$，因此 $\\sigma^2 = (0.5)^2 = 0.25$\n- $C_{\\mathrm{FP}} = 2000$\n- $C_{\\mathrm{FN}} = 2$\n- $\\pi_{1} = 0.99$\n- $\\pi_{0} = 0.01$\n\n均值的中点是：\n$$ \\frac{\\mu_1 + \\mu_0}{2} = \\frac{2.0 + 0.0}{2} = 1.0 $$\n缩放对数项的系数是：\n$$ \\frac{\\sigma^2}{\\mu_1 - \\mu_0} = \\frac{0.25}{2.0 - 0.0} = \\frac{0.25}{2.0} = 0.125 $$\n对数的参数是：\n$$ \\frac{C_{\\mathrm{FP}} \\pi_0}{C_{\\mathrm{FN}} \\pi_1} = \\frac{2000 \\times 0.01}{2 \\times 0.99} = \\frac{20}{1.98} = \\frac{2000}{198} = \\frac{1000}{99} $$\n现在，我们将这些部分组合起来：\n$$ t^{\\ast} = 1.0 + 0.125 \\times \\ln\\left(\\frac{1000}{99}\\right) $$\n计算数值：\n$$ \\ln\\left(\\frac{1000}{99}\\right) \\approx \\ln(10.10101...) \\approx 2.312635 $$\n$$ t^{\\ast} \\approx 1.0 + 0.125 \\times 2.312635 $$\n$$ t^{\\ast} \\approx 1.0 + 0.289079375 $$\n$$ t^{\\ast} \\approx 1.289079375 $$\n问题要求将结果四舍五入到四位有效数字。前四位有效数字是 $1.289$。后一位数字是 $0$，所以我们不向上取整。\n$$ t^{\\ast} \\approx 1.289 $$", "answer": "$$\\boxed{1.289}$$", "id": "4823953"}]}