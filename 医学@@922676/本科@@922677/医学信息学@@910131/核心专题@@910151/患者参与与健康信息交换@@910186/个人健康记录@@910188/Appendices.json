{"hands_on_practices": [{"introduction": "个人健康档案（PHR）的一个核心功能是从不同来源（如实验室、个人设备）整合健康数据。然而，这些数据往往使用不同的单位，因此数据协调是进行有意义分析的第一步。本练习将引导您处理一个常见的场景：将不同单位的血糖读数进行统一和标准化，以计算$z$分数，这是在纵向数据中追踪趋势和异常值的基本技能。[@problem_id:4852386]", "problem": "一位患者维护着一份个人健康记录（PHR），其中汇总了来自多个来源的空腹血糖测量值。由于数据来源以不同单位记录血糖值，PHR 必须统一单位并应用单一的归一化步骤，以便能够对随时间变化的趋势进行一致的可视化。PHR 的策略是使用经过充分检验的单位关系 $1\\,\\mathrm{mmol/L} = 18\\,\\mathrm{mg/dL}$ 将所有数值转换为毫克/分升（mg/dL），然后计算最新测量值相对于一个包含记录中较早数值的基线窗口的标准化分数（z-score）。\n\n给定以下包含十个先前空腹血糖记录的基线窗口，其单位为毫克/分升（mg/dL）或毫摩尔/升（mmol/L）：\n- 设备 A (mg/dL): $92$, $87$, $95$, $100$\n- 设备 B (mmol/L): $4.8$, $5.2$, $4.5$\n- 实验室门户网站 (mg/dL): $89$, $93$, $85$\n\n将在趋势图中下一个显示的最新空腹血糖记录来自设备 B：$5.1\\,\\mathrm{mmol/L}$。\n\n从基本定义开始：\n- 物理量的单位转换必须在汇总前生成一个共同的单位，此处使用 $1\\,\\mathrm{mmol/L} = 18\\,\\mathrm{mg/dL}$。\n- $n$ 个测量值 $x_1,\\dots,x_n$ 的算术平均值 $\\mu$ 为 $\\mu = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。\n- $n$ 个测量值 $x_1,\\dots,x_n$ 的样本标准差 $s$ 为 $s = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n} (x_i - \\mu)^2}$。\n- 测量值 $x$ 相对于由平均值 $\\mu$ 和样本标准差 $s$ 表征的基线的标准化分数（z-score）为 $z = \\frac{x - \\mu}{s}$。\n\n应用上述单位统一和归一化流程，计算最新空腹血糖测量值的 z-score。将最终数值答案四舍五入到四位有效数字。z-score 是无量纲的；报告时无需单位。", "solution": "将通过首先提取所有给定信息，然后评估其科学有效性、一致性和完整性来验证问题。\n\n### 步骤 1：提取给定信息\n\n- **单位转换关系**：$1\\,\\mathrm{mmol/L} = 18\\,\\mathrm{mg/dL}$。\n- **基线数据（先前测量值）**：\n    - 设备 A (mg/dL): $92$, $87$, $95$, $100$\n    - 设备 B (mmol/L): $4.8$, $5.2$, $4.5$\n    - 实验室门户网站 (mg/dL): $89$, $93$, $85$\n    - 基线测量总数为 $n=10$。\n- **最新测量值**：$x_{new} = 5.1\\,\\mathrm{mmol/L}$ 来自设备 B。\n- **基本定义**：\n    - 算术平均值：$\\mu = \\frac{1}{n}\\sum_{i=1}^{n} x_i$\n    - 样本标准差：$s = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n} (x_i - \\mu)^2}$\n    - Z-score: $z = \\frac{x - \\mu}{s}$\n- **任务**：在将单位统一为 mg/dL 后，计算最新测量值的 z-score。\n- **四舍五入要求**：最终数值答案必须四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n1.  **科学依据**：该问题基于医学数据分析和统计学的标准实践。单位（mg/dL, mmol/L）和葡萄糖的转换因子在医学中是标准的。平均值、样本标准差和 z-score 的概念是基本的统计度量。提供的血糖值在空腹血糖的生理学合理范围内。该问题是科学合理的。\n2.  **良构的 (Well-Posed)**：问题提供了所有必要的数据（基线测量值、新测量值）、公式和一个明确的目标（计算 z-score）。存在唯一解，并且可以直接从给定信息中计算出来。该问题是良构的。\n3.  **客观性**：问题以精确、定量和无偏见的语言陈述。它不包含主观陈述或意见。它是客观的。\n4.  **完整性和一致性**：提供了所有需要的数据和定义。没有矛盾之处。数据来源和单位已明确指定，单位统一规则是明确的。该问题是完整和一致的。\n\n### 步骤 3：结论与行动\n\n问题陈述是有效的。它是科学合理的、良构的、客观的和完整的。将遵循指定的方法推导出解决方案。\n\n### 解题推导\n\n解决方案需要一个三步过程：\n1.  将所有基线测量值统一为通用单位毫克/分升 (mg/dL)。\n2.  计算统一后基线数据的样本均值 ($\\mu$) 和样本标准差 ($s$)。\n3.  将新测量值统一为 mg/dL，并计算其相对于基线均值和标准差的 z-score。\n\n**步骤 1：基线数据的单位统一**\n\n来自设备 A 和实验室门户网站的基线测量值已经是 mg/dL。来自设备 B 的测量值必须使用给定的转换因子 $1\\,\\mathrm{mmol/L} = 18\\,\\mathrm{mg/dL}$ 从 mmol/L 转换为 mg/dL。\n\n来自设备 B 的三个测量值是 $4.8\\,\\mathrm{mmol/L}$, $5.2\\,\\mathrm{mmol/L}$ 和 $4.5\\,\\mathrm{mmol/L}$。\n转换后的值为：\n- $4.8\\,\\mathrm{mmol/L} \\times \\frac{18\\,\\mathrm{mg/dL}}{1\\,\\mathrm{mmol/L}} = 86.4\\,\\mathrm{mg/dL}$\n- $5.2\\,\\mathrm{mmol/L} \\times \\frac{18\\,\\mathrm{mg/dL}}{1\\,\\mathrm{mmol/L}} = 93.6\\,\\mathrm{mg/dL}$\n- $4.5\\,\\mathrm{mmol/L} \\times \\frac{18\\,\\mathrm{mg/dL}}{1\\,\\mathrm{mmol/L}} = 81\\,\\mathrm{mg/dL}$\n\n完整的以 mg/dL 为单位的基线数据集，记为 $\\{x_i\\}$，包含 $n=10$ 个值：\n$\\{92, 87, 95, 100, 86.4, 93.6, 81, 89, 93, 85\\}$\n\n**步骤 2：计算基线均值和标准差**\n\n首先，我们计算统一后基线数据的样本均值 ($\\mu$)。\n$$ \\mu = \\frac{1}{n} \\sum_{i=1}^{n} x_i $$\n$$ \\mu = \\frac{1}{10} (92 + 87 + 95 + 100 + 86.4 + 93.6 + 81 + 89 + 93 + 85) $$\n$$ \\mu = \\frac{902}{10} = 90.2 $$\n\n接下来，我们计算样本标准差 ($s$)。\n$$ s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\mu)^2} $$\n计算与均值的平方差之和 $\\sum_{i=1}^{n} (x_i - \\mu)^2$：\n- $(92 - 90.2)^2 = (1.8)^2 = 3.24$\n- $(87 - 90.2)^2 = (-3.2)^2 = 10.24$\n- $(95 - 90.2)^2 = (4.8)^2 = 23.04$\n- $(100 - 90.2)^2 = (9.8)^2 = 96.04$\n- $(86.4 - 90.2)^2 = (-3.8)^2 = 14.44$\n- $(93.6 - 90.2)^2 = (3.4)^2 = 11.56$\n- $(81 - 90.2)^2 = (-9.2)^2 = 84.64$\n- $(89 - 90.2)^2 = (-1.2)^2 = 1.44$\n- $(93 - 90.2)^2 = (2.8)^2 = 7.84$\n- $(85 - 90.2)^2 = (-5.2)^2 = 27.04$\n\n总和为：\n$$ \\sum_{i=1}^{10} (x_i - 90.2)^2 = 3.24 + 10.24 + 23.04 + 96.04 + 14.44 + 11.56 + 84.64 + 1.44 + 7.84 + 27.04 = 279.52 $$\n现在我们可以计算样本方差 $s^2$，然后计算样本标准差 $s$。自由度为 $n-1 = 10-1 = 9$。\n$$ s^2 = \\frac{279.52}{9} $$\n$$ s = \\sqrt{\\frac{279.52}{9}} \\approx 5.5729505 $$\n\n**步骤 3：计算 Z-score**\n\n最新的测量值是 $5.1\\,\\mathrm{mmol/L}$。我们首先将这个值（记为 $x$）转换为 mg/dL。\n$$ x = 5.1\\,\\mathrm{mmol/L} \\times \\frac{18\\,\\mathrm{mg/dL}}{1\\,\\mathrm{mmol/L}} = 91.8\\,\\mathrm{mg/dL} $$\n\n现在，我们使用公式 $z = \\frac{x - \\mu}{s}$ 计算 z-score。\n$$ z = \\frac{91.8 - 90.2}{5.5729505} $$\n$$ z = \\frac{1.6}{5.5729505} \\approx 0.2870908 $$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$ z \\approx 0.2871 $$\n\n计算出的 z-score 为 $0.2871$，表明最新的空腹血糖测量值比基线测量值的平均值高出约 $0.2871$ 个标准差。", "answer": "$$\\boxed{0.2871}$$", "id": "4852386"}, {"introduction": "个人健康档案的巨大价值在于其能够提供患者健康的纵向视图，从而揭示行为模式。本练习将挑战您从业内一个核心问题入手：如何仅根据配药记录来量化患者的用药依从性。您将设计并应用一个算法来计算用药持有率（MPR），这需要您仔细处理提前配药（导致药物囤积）和延迟配药（导致用药中断）等现实世界中的复杂情况。[@problem_id:4852329]", "problem": "一份个人健康记录 (PHR) 包含了患者输入和药房提供的药物续配数据。您的任务是设计一种依从性估计算法，该算法仅使用续配事件和剂量说明来计算一个固定观察期内的药物持有率 (Medication Possession Ratio, MPR)。从MPR的核心定义出发，即MPR是观察期内患者手中有药的天数所占的比例。请仅使用公认的假设和基本的时间间隔算术，从第一性原理构建该算法。然后将您的算法应用于下面的PHR数据。\n\n允许的假设：\n- 每次配药事件都会立即增加手头药物的存量。\n- 预期的给药速率是恒定的，并且可以从PHR中的说明得知。\n- 提前续配会产生囤积；持有天数不得重复计算。当一次续配发生在上一次供应耗尽之前时，新供应的开始日期将推迟到上一次供应结束后的第一天。\n- 如果一次续配发生在上一次供应耗尽之后，则会产生无药覆盖的空白期；新供应从实际取药日期开始。\n- 每次配药事件，配药量为 $Q_i$，每日给药速率为 $r$，产生的药物供应天数为 $s_i = Q_i / r$ 个日历日。\n- 每一份为期 $s_i$ 天的供应，从其指定的开始日期起，连续覆盖 $s_i$ 个日历日（含首尾两天）。\n- 观察期是一个闭区间；药物覆盖范围必须在观察期边界处进行裁剪。MPR的上限为 $1$。\n\n观察期：\n- 开始：$2023$年$1$月$1$日\n- 结束：$2023$年$3$月$31$日\n- 使用非闰年日历。将该观察期视为连续的$90$天。\n\n针对一种每日一次服用的药物（医嘱：“每日口服$1$片”）的PHR续配事件：\n- 续配$1$：$2023$年$1$月$1$日，配药量$30$片。\n- 续配$2$：$2023$年$1$月$25$日，配药量$30$片。\n- 续配$3$：$2023$年$3$月$5$日，配药量$30$片。\n\n任务：\n1. 根据上述假设和MPR的定义，推导出一个清晰的算法，仅使用续配日期和数量来计算固定观察期内的药物覆盖天数，并处理提前续配的结转重叠和延迟续配的空白期。\n2. 应用您的算法，计算$2023$年$1$月$1$日至$3$月$31$日观察期内的MPR。将最终的MPR表示为一个无单位小数，并四舍五入到四位有效数字。", "solution": "该问题是有效的，因为它在医学信息学领域有科学依据，问题提出得当，数据充分且一致，陈述客观。它要求基于药物依从性计算的标准原则，推导并应用一种算法。\n\n### 第一部分：药物持有率 (MPR) 算法的推导\n\n目标是计算药物持有率 (MPR)，其定义为在指定的观察期内，患者有可用药物的天数所占的比例。该算法必须能处理因提前续配产生的囤积和因延迟续配产生的空白期。\n\n设观察期为日历日期的闭区间 $[T_{start}, T_{end}]$。我们可以将这些日期映射到一个序数日编号系统，其中 $t_{start}$ 是 $T_{start}$ 的序数日，$t_{end}$ 是 $T_{end}$ 的序数日。观察期的持续时间为 $D = t_{end} - t_{start} + 1$ 天。\n\n假设有 $N$ 次续配事件，索引为 $i \\in \\{1, 2, \\dots, N\\}$。对于每次续配事件 $i$，我们已知：\n- $d_i$：续配的序数日。\n- $Q_i$：配发的药物数量。\n\n我们还已知一个恒定的每日给药速率 $r$。\n\n每次续配提供的药物供应天数计算为 $s_i = \\frac{Q_i}{r}$。\n\n该算法的核心是构建一系列非重叠的时间区间 $[p_i, e_i]$，代表药物覆盖的时期。其中，$p_i$ 是第 $i$ 次续配供应的有效开始日，$e_i$ 是其有效结束日。\n\n算法流程如下：\n\n1.  **初始化**：定义一个变量来追踪上一次供应期的预计结束日。对于第一次续配，没有先前的供应。我们可以将一个“第零次”有效结束日初始化为 $e_0 = -\\infty$，以形式化地处理基本情况。\n\n2.  **迭代计算覆盖区间**：我们从 $i=1$ 到 $N$ 遍历每次续配事件。\n    - 上一次续配 $(i-1)$ 的供应预计覆盖到第 $e_{i-1}$ 天（含当天）。因此，患者对下一次供应的需求从第 $e_{i-1} + 1$ 天开始。\n    - 第 $i$ 次续配供应的有效开始日 $p_i$ 由“结转”规则确定。患者只能在两个日期中较晚的一个开始使用新供应：实际续配日期 ($d_i$) 或上一次供应耗尽后的第二天 ($e_{i-1} + 1$)。这表示为：\n      $$p_i = \\max(d_i, e_{i-1} + 1)$$\n      这条单一规则正确地模拟了两种情况：\n      - **提前续配 ($d_i  e_{i-1} + 1$)**：开始日期推迟到 $p_i = e_{i-1} + 1$，防止重复计算持有天数。\n      - **延迟或按时续配 ($d_i \\ge e_{i-1} + 1$)**：新供应从取药当天开始，即 $p_i = d_i$，如果 $d_i > e_{i-1} + 1$，则可能产生无药覆盖的空白期。\n    - 第 $i$ 次续配供应的有效结束日 $e_i$ 是通过将其持续时间加到有效开始日上计算得出的。由于从 $p_i$ 开始的 $s_i$ 天供应覆盖了 $p_i, p_i+1, \\dots, p_i+s_i-1$ 这些天，因此结束日是：\n      $$e_i = p_i + s_i - 1$$\n    - 然后，在下一次迭代中，$e_i$ 的值将作为 $e_{i-1}$ 使用。\n\n3.  **对观察期内的覆盖天数求和**：计算出一系列不相交的覆盖区间 $[p_i, e_i]$ 后，我们计算落在观察期 $[t_{start}, t_{end}]$ 内的总覆盖天数 $C_{total}$。\n    - 对于每个区间 $[p_i, e_i]$，我们求其与 $[t_{start}, t_{end}]$ 的交集。交集的开始是 $p'_i = \\max(p_i, t_{start})$，结束是 $e'_i = \\min(e_i, t_{end})$。\n    - 第 $i$ 次续配贡献的覆盖天数，记为 $c_i$，是该交集的长度。如果 $p'_i > e'_i$，则交集为空。\n      $$c_i = \\max(0, e'_i - p'_i + 1)$$\n    - 总覆盖天数是所有续配贡献天数的总和：\n      $$C_{total} = \\sum_{i=1}^{N} c_i$$\n\n4.  **最终MPR计算**：MPR是总覆盖天数与观察期持续时间的比率。\n    $$\\text{MPR} = \\frac{C_{total}}{D}$$\n\n### 第二部分：算法的应用\n\n我们将推导出的算法应用于所提供的PHR数据。\n\n**已知条件**：\n- 观察期：$2023$年$1$月$1$日至$2023$年$3$月$31$日。在非闰年中，这对应于 $D = 31 + 28 + 31 = 90$ 天。\n- 设$1$月$1$日为序数日$1$。则观察期为区间 $[1, 90]$。\n- 给药速率：$r = 1$ 片/天。\n- 续配事件：\n  - 续配$1$：$d_1 = 1$（1月1日），$Q_1 = 30$。药物供应天数 $s_1 = 30/1 = 30$。\n  - 续配$2$：$d_2 = 25$（1月25日），$Q_2 = 30$。药物供应天数 $s_2 = 30/1 = 30$。\n  - 续配$3$：$d_3 = 31 + 28 + 5 = 64$（3月5日），$Q_3 = 30$。药物供应天数 $s_3 = 30/1 = 30$。\n\n**分步计算**：\n\n- **对于续配1 ($i=1$)**：\n  - 由于这是第一次续配，其有效开始日即为续配日：$p_1 = d_1 = 1$。\n  - 有效结束日为 $e_1 = p_1 + s_1 - 1 = 1 + 30 - 1 = 30$。\n  - 覆盖区间为 $[1, 30]$。\n  - 与观察期 $[1, 90]$ 的交集为 $[\\max(1, 1), \\min(30, 90)] = [1, 30]$。\n  - 本次续配的覆盖天数：$c_1 = 30 - 1 + 1 = 30$。\n\n- **对于续配2 ($i=2$)**：\n  - 上一次供应预计在第 $e_1 = 30$ 天结束。下一次需要用药的日期是第 $e_1 + 1 = 31$ 天。\n  - 实际续配发生在第 $d_2 = 25$ 天。这是一次提前续配。\n  - 有效开始日为 $p_2 = \\max(d_2, e_1 + 1) = \\max(25, 31) = 31$。\n  - 有效结束日为 $e_2 = p_2 + s_2 - 1 = 31 + 30 - 1 = 60$。\n  - 覆盖区间为 $[31, 60]$。\n  - 与观察期 $[1, 90]$ 的交集为 $[\\max(31, 1), \\min(60, 90)] = [31, 60]$。\n  - 本次续配的覆盖天数：$c_2 = 60 - 31 + 1 = 30$。\n\n- **对于续配3 ($i=3$)**：\n  - 上一次供应预计在第 $e_2 = 60$ 天结束。下一次需要用药的日期是第 $e_2 + 1 = 61$ 天。\n  - 实际续配发生在第 $d_3 = 64$ 天。这是一次延迟续配，造成了从第$61$天到第$63$天的无药空白期。\n  - 有效开始日为 $p_3 = \\max(d_3, e_2 + 1) = \\max(64, 61) = 64$。\n  - 有效结束日为 $e_3 = p_3 + s_3 - 1 = 64 + 30 - 1 = 93$。\n  - 覆盖区间为 $[64, 93]$。\n  - 与观察期 $[1, 90]$ 的交集为 $[\\max(64, 1), \\min(93, 90)] = [64, 90]$。\n  - 本次续配的覆盖天数：$c_3 = 90 - 64 + 1 = 27$。（注意在观察期末端进行了裁剪）。\n\n- **总覆盖天数**：\n  - $C_{total} = c_1 + c_2 + c_3 = 30 + 30 + 27 = 87$ 天。\n\n- **MPR 计算**：\n  - $\\text{MPR} = \\frac{C_{total}}{D} = \\frac{87}{90}$。\n  - $\\frac{87}{90} = \\frac{29}{30} = 0.9666\\overline{6}$。\n  - 四舍五入到四位有效数字，得到 $0.9667$。", "answer": "$$\\boxed{0.9667}$$", "id": "4852329"}, {"introduction": "维持高质量的数据对于建立可靠且安全的个人健康档案至关重要，而数据重复是整合多个来源信息时面临的普遍挑战。本练习将引导您超越简单的重复数据删除规则，进入系统性能评估的领域。您将构建一个概率模型，来量化一个确定性规则集在合并实验室结果时产生“错误合并”的预期风险，这是评估和优化健康信息学系统性能的一项关键高级技能。[@problem_id:4852368]", "problem": "个人健康记录 (PHR) 使用快速医疗互操作性资源 (FHIR) 汇总来自多个来源的实验室结果。为了在从两个不同数据源导入相同实验室结果时减少重复，您必须使用以下字段构建一个确定性的去重规则集：逻辑观察标识符名称和代码 (LOINC) 代码 ($\\text{code}$)、样本类型 ($\\text{specimen}$)、生效时间戳 ($\\text{effectiveDateTime}$) 和执行实验室 ($\\text{performer}$)。规则如下：当且仅当两条记录的规范化 $\\text{code}$ 字符串相等、规范化 $\\text{specimen}$ 字符串相等、规范化 $\\text{performer}$ 字符串相等，并且它们的 $\\text{effectiveDateTime}$ 值的绝对差最多为 $\\tau$ 小时时，才合并这两条记录。\n\n假设对于同一患者的跨源候选对，存在以下科学上合理的数据生成和变异性模型：\n- 仅当绝对时间差在宽度为 $W$ 小时的筛选窗口内时才形成候选对，其中 $W = 24$。\n- 在筛选出的配对中，真重复项的基础比率为 $\\pi_{\\text{dup}} = 0.07$；其余为非重复项配对，概率为 $1 - \\pi_{\\text{dup}}$。\n- 在非重复项配对的条件下，规范化 $\\text{code}$ 字符串匹配的概率为 $p_{c} = 0.18$，规范化 $\\text{specimen}$ 字符串匹配的概率为 $p_{s} = 0.90$，规范化 $\\text{performer}$ 字符串匹配的概率为 $p_{p} = 0.04$。这些概率反映了血液检测中现实的跨源别名和常见样本类别。\n- 在非重复项配对且该配对在筛选窗口内的条件下，绝对时间差在 $[0, W]$ 上均匀分布，因此绝对时间差最多为 $\\tau$ 小时的概率为 $\\tau / W$。\n- 取 $\\tau = 2$ 小时。\n- 在一个月内，系统筛选 $N = 5 \\times 10^{4}$ 个候选对。\n\n使用概率的基本定义、上述独立性假设以及非重复项时间偏移的均匀分布模型，推导在此规则集下每个筛选候选对的无条件错误合并概率的解析表达式，然后计算该月内预期错误合并的数量。将您最终的预期计数四舍五入到四位有效数字。将最终计数表示为一个无单位的数字。", "solution": "在尝试解决方案之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n- **去重规则**：当且仅当两条记录的规范化 `code` 字符串相等、规范化 `specimen` 字符串相等、规范化 `performer` 字符串相等，并且它们的 `effectiveDateTime` 值的绝对差最多为 $\\tau$ 小时时，才合并这两条记录。\n- **筛选窗口宽度**：$W = 24$ 小时。候选对经过预筛选，其绝对时间差最多为 $W$。\n- **合并时间阈值**：$\\tau = 2$ 小时。\n- **总筛选对数**：$N = 5 \\times 10^{4}$ 对/月。\n- **真重复项基础比率**：一个筛选出的配对是真重复项的概率为 $\\pi_{\\text{dup}} = 0.07$。\n- **非重复项基础比率**：一个筛选出的配对是非重复项的概率为 $1 - \\pi_{\\text{dup}}$。\n- **非重复项配对的条件概率**：\n  - `code` 匹配概率：$p_{c} = P(\\text{代码匹配} | \\text{非重复项}) = 0.18$。\n  - `specimen` 匹配概率：$p_{s} = P(\\text{样本匹配} | \\text{非重复项}) = 0.90$。\n  - `performer` 匹配概率：$p_{p} = P(\\text{执行者匹配} | \\text{非重复项}) = 0.04$。\n  - 绝对时间差 $\\Delta t$ 在 $[0, W]$ 上均匀分布。$\\Delta t \\le \\tau$ 的概率由 $P(\\Delta t \\le \\tau | \\text{非重复项}) = \\frac{\\tau}{W}$ 给出。\n- **独立性假设**：问题暗示，对于非重复项配对，`code` 匹配、`specimen` 匹配、`performer` 匹配和满足时间条件的事件是相互独立的。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准评估问题陈述。\n- **科学依据**：该问题在医学信息学领域有充分的依据，特别涉及个人健康记录 (PHR) 和 FHIR 标准的数据去重挑战。概率模型是分析此类规则集性能的标准且适当的方法。给定的数值据称是合理的，并且与健康数据中的真实世界场景一致。\n- **问题明确**：问题定义清晰。它提供了推导唯一解析表达式和计算特定数值所需的所有数据和假设。目标明确无歧义。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观声明。\n- **不完整或矛盾的设置**：问题是自洽的。所有变量（$\\pi_{\\text{dup}}$、$p_c$、$p_s$、$p_p$、$\\tau$、$W$、$N$）都已定义并赋值。均匀分布和独立性等假设被明确说明或强烈暗示为解决方案所必需。没有矛盾之处。\n- **不切实际或不可行**：场景和数据是对一个真实工程问题的现实简化。参数值是合理的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学依据、问题明确且内部一致。将制定一个解决方案。\n\n### 解决方案推导\n目标是计算一个月内错误合并的预期数量。“错误合并”指两条记录被合并，但它们并非真正的重复项配对。\n\n让我们为随机选择的筛选候选对定义以下事件：\n- $D$：该配对是真重复项的事件。\n- $D^c$：该配对是非重复项的事件。\n- $C$：`code` 字符串匹配的事件。\n- $S$：`specimen` 字符串匹配的事件。\n- $P$：`performer` 字符串匹配的事件。\n- $T$：绝对时间差最多为 $\\tau$ 的事件，即 $|\\Delta t| \\le \\tau$。\n- $M$：该配对被规则合并的事件。\n\n根据问题陈述，合并规则为：\n$$M = C \\cap S \\cap P \\cap T$$\n\n我们需要计算无条件错误合并概率，即一个随机选择的筛选对被合并且为非重复项的概率。这对应于联合概率 $P(M \\cap D^c)$。\n\n使用条件概率的定义，我们可以将其表示为：\n$$P(M \\cap D^c) = P(M | D^c) P(D^c)$$\n\n给定真重复项的基础比率为 $\\pi_{\\text{dup}} = P(D) = 0.07$。因此，一个配对为非重复项的概率是：\n$$P(D^c) = 1 - P(D) = 1 - \\pi_{\\text{dup}} = 1 - 0.07 = 0.93$$\n\n接下来，我们必须计算在配对为非重复项的条件下发生合并的概率，$P(M | D^c)$。\n$$P(M | D^c) = P(C \\cap S \\cap P \\cap T | D^c)$$\n\n问题陈述了对非重复项配对的独立性假设。这意味着在给定 $D^c$ 的条件下，事件 $C$、$S$、$P$ 和 $T$ 是相互独立的。因此，我们可以写出：\n$$P(M | D^c) = P(C | D^c) P(S | D^c) P(P | D^c) P(T | D^c)$$\n\n问题提供了这些条件概率的值：\n- $P(C | D^c) = p_c = 0.18$\n- $P(S | D^c) = p_s = 0.90$\n- $P(P | D^c) = p_p = 0.04$\n- 对于非重复项配对，时间差在 $[0, W]$ 上均匀分布。时间差小于或等于 $\\tau$ 的概率是区间 $[0, \\tau]$ 的长度与区间 $[0, W]$ 的长度之比。\n$$P(T | D^c) = \\frac{\\tau - 0}{W - 0} = \\frac{\\tau}{W}$$\n给定 $\\tau=2$ 小时和 $W=24$ 小时：\n$$P(T | D^c) = \\frac{2}{24} = \\frac{1}{12}$$\n\n现在我们可以计算 $P(M | D^c)$：\n$$P(M | D^c) = p_c \\cdot p_s \\cdot p_p \\cdot \\frac{\\tau}{W} = (0.18)(0.90)(0.04)\\left(\\frac{1}{12}\\right)$$\n$$P(M | D^c) = (0.00648)\\left(\\frac{1}{12}\\right) = 0.00054$$\n\n因此，无条件错误合并概率（我们表示为 $P_{FM}$）为：\n$$P_{FM} = P(M \\cap D^c) = P(M | D^c) P(D^c) = (0.00054)(0.93)$$\n$$P_{FM} = 0.0005022$$\n\n这是每个筛选对的无条件错误合并概率的解析表达式，推导如下：\n$$P_{FM} = (1 - \\pi_{\\text{dup}}) p_c p_s p_p \\frac{\\tau}{W}$$\n\n最后，我们需要计算在一个月内筛选 $N = 5 \\times 10^{4}$ 对候选对时，错误合并的预期数量 $E_{FM}$。错误合并的数量可以建模为一个具有 $N$ 次试验和成功概率 $P_{FM}$ 的二项随机变量。其期望值为：\n$$E_{FM} = N \\cdot P_{FM}$$\n代入数值：\n$$E_{FM} = (5 \\times 10^{4}) \\cdot P_{FM} = 50000 \\cdot (0.0005022)$$\n$$E_{FM} = 50000 \\cdot (1 - 0.07) \\cdot (0.18) \\cdot (0.90) \\cdot (0.04) \\cdot \\frac{2}{24}$$\n$$E_{FM} = 50000 \\cdot (0.93) \\cdot (0.18) \\cdot (0.90) \\cdot (0.04) \\cdot \\frac{1}{12}$$\n$$E_{FM} = 50000 \\cdot (0.93) \\cdot (0.00648) \\cdot \\frac{1}{12}$$\n$$E_{FM} = 50000 \\cdot (0.93) \\cdot (0.00054)$$\n$$E_{FM} = 50000 \\cdot (0.0005022)$$\n$$E_{FM} = 25.11$$\n\n问题要求将最终答案四舍五入到四位有效数字。计算值 $25.11$ 恰好有四位有效数字（$2, 5, 1, 1$），因此无需进一步四舍五入。\n该月内预期错误合并的数量为 $25.11$。", "answer": "$$\\boxed{25.11}$$", "id": "4852368"}]}