{"hands_on_practices": [{"introduction": "一个高灵敏度（真阳性率）的警报系统是否就一定可靠？这个练习将引导你深入思考这个问题。我们将使用贝叶斯定理来计算临床决策支持系统（CDSS）警报的阳性预测值（$PPV$），揭示在疾病患病率较低的情况下，即使一个表现良好的算法也可能产生大量的假阳性警报，而这正是导致临床医生“警报疲劳”的主要原因。[@problem_id:4824907]", "problem": "一家医院部署了一套用于早期脓毒症检测的临床决策支持系统 (CDSS)。在受监控的住院患者中，脓毒症的真实患病率为 $\\pi = 0.08$。当 CDSS 检测到提示可能患有脓毒症的模式时，会发出警报。设真阳性率（灵敏度）为 $TPR = 0.75$，假阳性率为 $FPR = 0.20$。请仅使用条件概率和贝叶斯定理的基本定义，推导出一个表达式，用以表示在警报触发的情况下患者确实患有脓毒症的概率，即 $P(\\text{脓毒症} \\mid \\text{警报})$，该表达式应以 $\\pi$、$TPR$ 和 $FPR$ 表示。然后，根据给定的参数计算其数值。将最终结果以小数形式表示，并四舍五入至四位有效数字。最后，根据计算出的数值，简要论证临床医生在常规实践中是否可能信任这些警报，并考虑警报疲劳的风险。在您的答案或推理中，请勿使用百分号。", "solution": "首先对问题的科学依据、一致性和完整性进行验证。\n\n**步骤1：提取已知条件**\n- 脓毒症的真实患病率：$\\pi = 0.08$。\n- CDSS 警报的真阳性率（灵敏度）：$TPR = 0.75$。\n- CDSS 警报的假阳性率：$FPR = 0.20$。\n- 任务是推导在警报触发的情况下患者确实患有脓毒症的概率 $P(\\text{脓毒症} \\mid \\text{警报})$ 的表达式，然后计算其数值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它基于概率论的基本原理（贝叶斯定理），是医学信息学和流行病学中的一个标准应用，特别是在评估诊断或筛查工具的性能方面。所提供的参数（$\\pi$、$TPR$、$FPR$）是完整且充分的，足以计算所需的后验概率，即阳性预测值 (PPV)。这些数值对于真实的临床场景是合理的。该问题没有矛盾、歧义和事实错误。\n\n**步骤3：结论与行动**\n问题被认定为有效。将推导求解。\n\n**推导与求解**\n令 $S$ 表示患者确实患有脓毒症的事件，令 $A$ 表示 CDSS 发出警报的事件。问题提供了以下概率：\n\n1.  脓毒症的先验概率（患病率）：\n    $$P(S) = \\pi = 0.08$$\n2.  未患脓毒症的概率是其补集：\n    $$P(S^c) = 1 - P(S) = 1 - \\pi = 1 - 0.08 = 0.92$$\n3.  真阳性率，或称灵敏度，是在患者患有脓毒症的条件下发出警报的条件概率：\n    $$P(A \\mid S) = TPR = 0.75$$\n4.  假阳性率是在患者未患脓毒症的条件下发出警报的条件概率：\n    $$P(A \\mid S^c) = FPR = 0.20$$\n\n我们需要求解后验概率 $P(S \\mid A)$，即在警报触发的条件下患有脓毒症的概率。这是贝叶斯定理的直接应用：\n$$P(S \\mid A) = \\frac{P(A \\mid S) P(S)}{P(A)}$$\n\n分母 $P(A)$ 是警报发生的总概率。可以通过全概率定律，考虑两种互斥情况来计算：为脓毒症患者发出警报和为非脓毒症患者发出警报。\n$$P(A) = P(A \\cap S) + P(A \\cap S^c)$$\n使用条件概率的定义，$P(X \\cap Y) = P(X \\mid Y)P(Y)$，我们可以写出：\n$$P(A) = P(A \\mid S)P(S) + P(A \\mid S^c)P(S^c)$$\n\n将这个 $P(A)$ 的表达式代回贝叶斯定理，得到所需的通用公式：\n$$P(S \\mid A) = \\frac{P(A \\mid S) P(S)}{P(A \\mid S)P(S) + P(A \\mid S^c)P(S^c)}$$\n\n用给定的符号参数 $\\pi$、$TPR$ 和 $FPR$ 表示，$P(\\text{脓毒症} \\mid \\text{警报})$ 的表达式为：\n$$P(S \\mid A) = \\frac{(TPR)(\\pi)}{(TPR)(\\pi) + (FPR)(1-\\pi)}$$\n这就是所要求的解析表达式。\n\n现在，我们代入给定的数据来计算数值：\n$$P(S \\mid A) = \\frac{(0.75)(0.08)}{(0.75)(0.08) + (0.20)(1 - 0.08)}$$\n$$P(S \\mid A) = \\frac{0.06}{0.06 + (0.20)(0.92)}$$\n$$P(S \\mid A) = \\frac{0.06}{0.06 + 0.184}$$\n$$P(S \\mid A) = \\frac{0.06}{0.244}$$\n$$P(S \\mid A) \\approx 0.245901639...$$\n四舍五入到四位有效数字，结果是 $0.2459$。\n\n**关于临床医生信任度与警报疲劳的论证**\n计算出的数值 $P(\\text{脓毒症} \\mid \\text{警报}) \\approx 0.2459$ 代表了 CDSS 警报的阳性预测值 (PPV)。这个结果表明，当警报触发时，患者实际患有脓毒症的概率仅为 0.2459。反过来说，这意味着大约 $1 - 0.2459 = 0.7541$，即大约每四个警报中就有三个是假阳性。高误报率是导致警报疲劳的一个有据可查的原因，在这种情况下，临床医生会因感觉系统缺乏可靠性而变得不敏感，并开始忽略或否决系统警报。鉴于绝大多数警报并不表示真正的脓毒症，临床医生不太可能信任该系统。这种信任的侵蚀是危险的，因为它可能导致医生忽视真正的阳性警报，从而延误救生治疗，并使早期检测系统的主要目的落空。因此，低阳性预测值强烈表明，临床医生很可能会不信任这些警报，从而在常规实践中导致严重的警报疲劳。", "answer": "$$\\boxed{0.2459}$$", "id": "4824907"}, {"introduction": "既然我们理解了为何阳性预测值（$PPV$）常常偏低，下一步自然是设法提高它。这个练习模拟了一种在实践中常见的优化策略：识别并移除那些“低证据强度”但产生大量警报的规则。通过亲手计算移除这些“噪音”规则后$PPV$的提升幅度，你将定量地理解CDSS的调优过程是如何直接有效地缓解警报疲劳的。[@problem_id:4824864]", "problem": "一家医院部署了一套用于用药安全的临床决策支持系统 (CDSS)。该CDSS在检测到潜在问题时会生成警报。在诊断和决策支持系统的评估研究中，阳性预测值 (PPV) 定义为对应于真实已确认问题的警报所占的比例，即 $PPV = \\frac{\\text{true positives}}{\\text{all alerts}}$。考虑以下基于病历验证结果的场景：在一个月的时间里，CDSS生成了 $A = 12{,}000$ 条警报，其中 $TP = 1{,}200$ 条经临床审查被核实为真实问题。一部分低证据规则被认为对警报疲劳的贡献过大。经验分析表明，这些规则产生了所有警报的 $0.40$ 的比例，但只占所有真实已确认问题的 $0.05$。该医疗系统正在考虑停用这些低证据规则。假设移除这些规则会精确地消除它们本应生成的警报和它们本应识别出的真实问题，而其余规则的行为和其他系统效应均无变化。使用阳性预测值的核心定义和基本的比例推理，计算在移除低证据规则后PPV的绝对改善量，该改善量定义为新的PPV减去基线PPV。将您的最终答案表示为十进制数，并四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题陈述经评估为有效。它在科学上基于医学信息学和诊断测试评估的原理，提供了一个定义明确、客观且自洽的场景。所有必要的数据均已提供，且各数值是一致且现实的。因此，我们可以开始求解。\n\n目标是计算在移除一个特定的警报生成规则子集后，阳性预测值 ($\\text{PPV}$) 的绝对改善量。绝对改善量定义为新的 $\\text{PPV}$ 减去基线 $\\text{PPV}$。\n\n设 $A_{\\text{total}}$ 为基线场景下的警报总数，$TP_{\\text{total}}$ 为真阳性警报总数。题目给出了这些值：\n$$ A_{\\text{total}} = 12{,}000 $$\n$$ TP_{\\text{total}} = 1{,}200 $$\n\n基线阳性预测值 $\\text{PPV}_{\\text{baseline}}$ 定义为真阳性与总警报的比率：\n$$ \\text{PPV}_{\\text{baseline}} = \\frac{TP_{\\text{total}}}{A_{\\text{total}}} = \\frac{1{,}200}{12{,}000} = 0.1 $$\n\n接下来，我们确定与将被停用的低证据规则相关的警报和真阳性。设 $f_A$ 是这些规则产生的所有警报的比例，设 $f_{TP}$ 是它们所占的所有真实问题的比例。给定的值为：\n$$ f_A = 0.40 $$\n$$ f_{TP} = 0.05 $$\n\n由低证据规则生成的警报数量，记为 $A_{\\text{low}}$，是：\n$$ A_{\\text{low}} = f_A \\cdot A_{\\text{total}} = 0.40 \\times 12{,}000 = 4{,}800 $$\n\n由这些相同规则识别出的真阳性数量，记为 $TP_{\\text{low}}$，是：\n$$ TP_{\\text{low}} = f_{TP} \\cdot TP_{\\text{total}} = 0.05 \\times 1{,}200 = 60 $$\n\n停用这些规则意味着这些警报及其对应的真阳性将从系统中移除。新的警报总数 $A_{\\text{new}}$ 和新的真阳性总数 $TP_{\\text{new}}$ 计算如下：\n$$ A_{\\text{new}} = A_{\\text{total}} - A_{\\text{low}} = 12{,}000 - 4{,}800 = 7{,}200 $$\n$$ TP_{\\text{new}} = TP_{\\text{total}} - TP_{\\text{low}} = 1{,}200 - 60 = 1{,}140 $$\n\n根据这些新的总数，我们可以计算新的阳性预测值 $\\text{PPV}_{\\text{new}}$：\n$$ \\text{PPV}_{\\text{new}} = \\frac{TP_{\\text{new}}}{A_{\\text{new}}} = \\frac{1{,}140}{7{,}200} $$\n这个分数可以简化为：\n$$ \\text{PPV}_{\\text{new}} = \\frac{114}{720} = \\frac{57}{360} = \\frac{19}{120} $$\n\n$\\text{PPV}$的绝对改善量，记为 $\\Delta\\text{PPV}$，是新值与基线值之差：\n$$ \\Delta\\text{PPV} = \\text{PPV}_{\\text{new}} - \\text{PPV}_{\\text{baseline}} $$\n代入计算出的值：\n$$ \\Delta\\text{PPV} = \\frac{19}{120} - 0.1 = \\frac{19}{120} - \\frac{1}{10} $$\n为了进行减法，我们找到一个公分母，即 $120$：\n$$ \\Delta\\text{PPV} = \\frac{19}{120} - \\frac{12}{120} = \\frac{19 - 12}{120} = \\frac{7}{120} $$\n\n最后，我们按照要求将此分数转换为小数，并四舍五入到四位有效数字。\n$$ \\Delta\\text{PPV} = \\frac{7}{120} \\approx 0.058333... $$\n第一个有效数字是 $5$。接下来的三位是 $8$、$3$ 和 $3$。第五位有效数字是 $3$，小于 $5$，因此我们向下舍入。将结果四舍五入到四位有效数字后为 $0.05833$。", "answer": "$$\\boxed{0.05833}$$", "id": "4824864"}, {"introduction": "除了对现有规则进行调整，我们能否从系统设计的起点就建立一个最优的警报阈值？这个更深入的练习将介绍一个基于决策理论的强大框架。通过权衡假阳性（不必要的工作、警报疲劳）和假阴性（漏诊）的相对成本，你将推导出一个能最小化预期总成本的最优决策边界。这个练习展示了如何从临床风险和成本效益的角度，系统性地平衡灵敏度与特异度之间的权衡。[@problem_id:4824938]", "problem": "一家医院正在部署一个临床决策支持系统（CDSS），用于触发早期败血症警报。真实早期败血症事件被建模为一个二元变量 $Y \\in \\{0,1\\}$，其基础率（患病率）为 $P(Y=1)=\\pi \\in (0,1)$。对于每一次带有特征向量 $x$ 的患者就诊，该 CDSS 会输出一个经过校准的分数，其形式为以下两种等价形式之一：\n- 一个后验概率分数 $p(x)=P(Y=1 \\mid x)$，该分数针对部署人群进行了良好校准。\n- 一个根据模型的证据计算得出的似然比分数 $L(x)=\\frac{p(x \\mid Y=1)}{p(x \\mid Y=0)}$。\n\nCDSS 必须决定是否发出警报 $a \\in \\{\\text{alert},\\text{no alert}\\}$。在 $Y=0$ 时发出警报会产生假阳性负担，导致警报疲劳，其成本量化为 $C_{FP}0$。在 $Y=1$ 时未能发出警报会产生假阴性伤害成本 $C_{FN}0$。假设正确决策的增量成本为零。令成本比率为 $r \\equiv \\frac{C_{FN}}{C_{FP}}$。\n\n仅使用期望风险最小化和贝叶斯法则的基本定义，推导出一个决策阈值，该阈值通过最小化每位患者的期望成本，在早期检测和假警报之间取得平衡。具体而言：\n1. 推导后验概率分数上的最优警报阈值 $t_{p}^{\\ast}$，使得决策规则为“如果 $p(x) \\ge t_{p}^{\\ast}$，则发出警报”。\n2. 推导似然比分数上的最优警报阈值 $t_{L}^{\\ast}$，使得决策规则为“如果 $L(x) \\ge t_{L}^{\\ast}$，则发出警报”。\n\n将最终答案表示为一个单行矩阵，其中依次包含用 $\\pi$ 和 $r$ 简化的 $t_{p}^{\\ast}$ 和 $t_{L}^{\\ast}$。不需要数值近似；请提供精确的符号表达式。不要包含单位。", "solution": "问题要求基于最小化期望成本的原则，推导用于发出败血症警报的最优决策阈值。我们已知临床决策支持系统（CDSS）产生两种类型的分数：后验概率分数 $p(x) = P(Y=1 \\mid x)$ 和似然比分数 $L(x) = \\frac{p(x \\mid Y=1)}{p(x \\mid Y=0)}$。真实早期败血症状态是一个二元变量 $Y \\in \\{0, 1\\}$，其中 $Y=1$ 表示败血症，其患病率为 $P(Y=1)=\\pi$。决策是从集合 $\\{\\text{alert}, \\text{no alert}\\}$ 中选择一个行动 $a$。\n\n与每个结果相关的成本已指定如下：\n- 假阳性（在 $Y=0$ 时发出警报）的成本：$C_{FP}  0$。即 $C(\\text{alert}, Y=0)$。\n- 假阴性（在 $Y=1$ 时不发出警报）的成本：$C_{FN}  0$。即 $C(\\text{no alert}, Y=1)$。\n- 真阳性（在 $Y=1$ 时发出警报）和真阴性（在 $Y=0$ 时不发出警报）的成本为零。因此，$C(\\text{alert}, Y=1) = 0$ 且 $C(\\text{no alert}, Y=0) = 0$。\n\n对于一个具有特征向量 $x$ 的给定患者，最优决策规则是选择使条件期望成本最小化的行动。期望成本以观测到的信息 $x$ 为条件。\n\n首先，我们为两种可能的行动分别表示其条件期望成本。\n\n采取行动 'alert' 的条件期望成本是：\n$$E[C \\mid x, a=\\text{alert}] = C(\\text{alert}, Y=1) P(Y=1 \\mid x) + C(\\text{alert}, Y=0) P(Y=0 \\mid x)$$\n代入给定的成本和后验概率 $p(x)$ 的定义：\n$$E[C \\mid x, a=\\text{alert}] = 0 \\cdot p(x) + C_{FP} \\cdot (1 - p(x)) = C_{FP}(1 - p(x))$$\n\n采取行动 'no alert' 的条件期望成本是：\n$$E[C \\mid x, a=\\text{no alert}] = C(\\text{no alert}, Y=1) P(Y=1 \\mid x) + C(\\text{no alert}, Y=0) P(Y=0 \\mid x)$$\n代入给定的成本和 $p(x)$：\n$$E[C \\mid x, a=\\text{no alert}] = C_{FN} \\cdot p(x) + 0 \\cdot (1 - p(x)) = C_{FN} p(x)$$\n\n期望成本最小化原则要求，当且仅当发出警报的期望成本小于或等于不发出警报的期望成本时，我们才应该发出警报。使用“小于或等于”（$\\le$）确保了在成本相等的情况下，我们默认发出警报，这与问题陈述中的阈值格式“如果 $p(x) \\ge t_{p}^{\\ast}$，则发出警报”相符。\n决策规则是：如果满足以下条件，则发出警报\n$$E[C \\mid x, a=\\text{alert}] \\le E[C \\mid x, a=\\text{no alert}]$$\n$$C_{FP}(1 - p(x)) \\le C_{FN} p(x)$$\n\n1. 后验概率阈值 $t_{p}^{\\ast}$ 的推导：\n我们重排不等式以求解 $p(x)$：\n$$C_{FP} - C_{FP} p(x) \\le C_{FN} p(x)$$\n$$C_{FP} \\le (C_{FN} + C_{FP}) p(x)$$\n由于 $C_{FN}  0$ 且 $C_{FP}  0$，它们的和为正，因此我们可以直接相除而不改变不等式的方向：\n$$p(x) \\ge \\frac{C_{FP}}{C_{FN} + C_{FP}}$$\n这定义了决策规则“如果 $p(x) \\ge t_{p}^{\\ast}$，则发出警报”，其中最优阈值 $t_{p}^{\\ast}$ 为：\n$$t_{p}^{\\ast} = \\frac{C_{FP}}{C_{FN} + C_{FP}}$$\n问题要求用成本比率 $r \\equiv \\frac{C_{FN}}{C_{FP}}$ 来表示该阈值。我们将分子和分母同除以 $C_{FP}$：\n$$t_{p}^{\\ast} = \\frac{\\frac{C_{FP}}{C_{FP}}}{\\frac{C_{FN}}{C_{FP}} + \\frac{C_{FP}}{C_{FP}}} = \\frac{1}{r + 1}$$\n\n2. 似然比阈值 $t_{L}^{\\ast}$ 的推导：\n我们从相同的基本不等式开始：\n$$C_{FP}(1 - p(x)) \\le C_{FN} p(x)$$\n对此进行不同的重排，可以得到一个关于后验几率的条件：\n$$\\frac{p(x)}{1 - p(x)} \\ge \\frac{C_{FP}}{C_{FN}}$$\n使用定义 $r = \\frac{C_{FN}}{C_{FP}}$，上式变为：\n$$\\frac{p(x)}{1 - p(x)} \\ge \\frac{1}{r}$$\n现在，我们必须将后验几率 $\\frac{p(x)}{1-p(x)}$ 与似然比 $L(x)$ 和先验概率（患病率）$\\pi = P(Y=1)$ 联系起来。\n根据贝叶斯法则，后验概率为 $P(Y=1 \\mid x) = \\frac{p(x \\mid Y=1)P(Y=1)}{p(x)}$。\n后验几率可以写为：\n$$\\frac{P(Y=1 \\mid x)}{P(Y=0 \\mid x)} = \\frac{p(x \\mid Y=1)P(Y=1)/p(x)}{p(x \\mid Y=0)P(Y=0)/p(x)} = \\frac{p(x \\mid Y=1)}{p(x \\mid Y=0)} \\cdot \\frac{P(Y=1)}{P(Y=0)}$$\n代入 $L(x)$、$\\pi$ 和 $P(Y=0)=1-\\pi$ 的定义：\n$$\\frac{p(x)}{1 - p(x)} = L(x) \\cdot \\frac{\\pi}{1-\\pi}$$\n这就是众所周知的关系：后验几率 = 似然比 $\\times$ 先验几率。\n将此代入我们的决策不等式中：\n$$L(x) \\frac{\\pi}{1-\\pi} \\ge \\frac{1}{r}$$\n我们求解 $L(x)$。由于 $\\pi \\in (0,1)$ 且 $r  0$，我们可以重排不等式：\n$$L(x) \\ge \\frac{1}{r} \\frac{1-\\pi}{\\pi}$$\n这定义了决策规则“如果 $L(x) \\ge t_{L}^{\\ast}$，则发出警报”，其中最优阈值 $t_{L}^{\\ast}$ 为：\n$$t_{L}^{\\ast} = \\frac{1-\\pi}{r\\pi}$$\n\n两个最优阈值分别为 $t_{p}^{\\ast} = \\frac{1}{r+1}$ 和 $t_{L}^{\\ast} = \\frac{1-\\pi}{r\\pi}$。\n最终答案要求将这两个表达式放在一个单行矩阵中。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{r+1}  \\frac{1-\\pi}{r\\pi} \\end{pmatrix}}$$", "id": "4824938"}]}