{"hands_on_practices": [{"introduction": "在临床信息学中，我们经常面临一个选择：是使用现成的结构化字段，还是利用自然语言处理（NLP）技术从非结构化的临床笔记中提取信息？这个练习将让你亲身体验如何量化这两种方法的表现。通过计算精确率（Precision）、召回率（Recall）和 $F1$ 分数等标准分类指标，你将学会如何客观地评估和比较结构化数据和非结构化数据提取的准确性，并理解它们各自的优劣。[@problem_id:4857088]", "problem": "一个临床自然语言处理（NLP）流程被用于评估从非结构化临床记录中提取“有记录的慢性肾脏病”这一概念的效果，评估使用专家病历审查作为参考标准。对于同一概念，电子健康记录（EHR）中包含一个结构化的问题列表字段。评估在 $N = 500$ 次患者就诊中进行。非结构化概念提取的混淆矩阵计数为 $TP = 190$，$FP = 35$，$TN = 245$ 和 $FN = 30$。另外，结构化字段的混淆矩阵计数为 $TP_{s} = 180$，$FP_{s} = 20$，$TN_{s} = 260$ 和 $FN_{s} = 40$。基于这些计数，使用分类指标的第一性原理定义，计算非结构化提取的精确率、召回率、特异度和 $F1$ 分数，以及结构化字段的准确率。然后，将非结构化提取的 $F1$ 分数与结构化字段准确率之间的有符号差值 $\\Delta$ 定义为 $\\Delta = F1_{\\text{unstructured}} - \\text{accuracy}_{\\text{structured}}$。以小数形式报告 $\\Delta$，并将最终答案四舍五入至四位有效数字。", "solution": "该问题要求计算和比较两种不同方法的性能指标，这两种方法都用于从患者就诊数据中识别一个临床概念（“有记录的慢性肾脏病”）。第一种方法是使用自然语言处理（NLP）的非结构化数据提取流程，第二种方法是来自电子健康记录（EHR）的结构化数据字段。评估是针对一个包含 $N=500$ 次就诊的样本，并以一个参考标准（专家病历审查）为基准进行的。\n\n首先，我们必须验证问题陈述的有效性。\n\n给定的条件是：\n总就诊次数, $N = 500$。\n\n对于非结构化概念提取：\n真正例 (True Positives), $TP = 190$。\n假正例 (False Positives), $FP = 35$。\n真负例 (True Negatives), $TN = 245$。\n假负例 (False Negatives), $FN = 30$。\n\n对于结构化问题列表字段：\n真正例 (True Positives), $TP_s = 180$。\n假正例 (False Positives), $FP_s = 20$。\n真负例 (True Negatives), $TN_s = 260$。\n假负例 (False Negatives), $FN_s = 40$。\n\n问题要求进行几项计算：\n1.  非结构化提取的精确率、召回率、特异度和 $F1$ 分数。\n2.  结构化字段的准确率。\n3.  有符号差值 $\\Delta = F1_{\\text{unstructured}} - \\text{accuracy}_{\\text{structured}}$。\n\n在继续之前，我们验证所提供数据的内部一致性。\n对于非结构化数据，混淆矩阵各项之和为 $TP + FP + TN + FN = 190 + 35 + 245 + 30 = 500$，与总就诊次数 $N$ 相符。\n对于结构化数据，其和为 $TP_s + FP_s + TN_s + FN_s = 180 + 20 + 260 + 40 = 500$，也与 $N$ 相符。\n此外，在参考标准中，正例的数量在两次评估之间必须保持一致。\n对于非结构化评估，参考标准中的正例数为 $P = TP + FN = 190 + 30 = 220$。\n对于结构化评估，正例数为 $P_s = TP_s + FN_s = 180 + 40 = 220$。\n负例的数量也必须一致。\n对于非结构化评估，负例数为 $N_{neg} = TN + FP = 245 + 35 = 280$。\n对于结构化评估，负例数为 $N_{s,neg} = TN_s + FP_s = 260 + 20 = 280$。\n由于 $P = P_s$ 且 $N_{neg} = N_{s,neg}$，并且总就诊次数 $N$ 是一致的，因此该问题定义明确、自洽，并且在科学上基于标准的分类性能评估。该问题被认为是有效的。\n\n我们现在根据其第一性原理定义进行计算。\n\n对于非结构化数据提取：\n预测为正例的总数为 $TP + FP = 190 + 35 = 225$。\n实际正例的总数为 $TP + FN = 190 + 30 = 220$。\n实际负例的总数为 $TN + FP = 245 + 35 = 280$。\n\n精确率（Precision），衡量所有预测为正例的样本中被正确预测的比例，定义为：\n$$ \\text{Precision} = \\frac{TP}{TP + FP} $$\n代入非结构化提取的值：\n$$ \\text{Precision}_{\\text{unstructured}} = \\frac{190}{190 + 35} = \\frac{190}{225} $$\n\n召回率（Recall，或称灵敏度），衡量所有实际为正例的样本中被正确识别的比例，定义为：\n$$ \\text{Recall} = \\frac{TP}{TP + FN} $$\n代入值：\n$$ \\text{Recall}_{\\text{unstructured}} = \\frac{190}{190 + 30} = \\frac{190}{220} $$\n\n特异度（Specificity），衡量所有实际为负例的样本中被正确识别的比例，定义为：\n$$ \\text{Specificity} = \\frac{TN}{TN + FP} $$\n代入值：\n$$ \\text{Specificity}_{\\text{unstructured}} = \\frac{245}{245 + 35} = \\frac{245}{280} $$\n\n$F1$ 分数是精确率和召回率的调和平均数。其定义为：\n$$ F1 = 2 \\times \\frac{\\text{Precision} \\times \\text{Recall}}{\\text{Precision} + \\text{Recall}} $$\n使用混淆矩阵计数的更直接公式是：\n$$ F1 = \\frac{2TP}{2TP + FP + FN} $$\n代入非结构化提取的值：\n$$ F1_{\\text{unstructured}} = \\frac{2 \\times 190}{2 \\times 190 + 35 + 30} = \\frac{380}{380 + 65} = \\frac{380}{445} $$\n\n接下来，我们计算结构化数据字段的准确率。\n准确率（Accuracy）衡量所有预测正确的样本（包括真正例和真负例）占总样本数的比例。其定义为：\n$$ \\text{Accuracy} = \\frac{TP + TN}{TP + FP + TN + FN} = \\frac{TP + TN}{N} $$\n使用结构化字段的计数（$TP_s, TN_s$）和总就诊次数 $N$：\n$$ \\text{accuracy}_{\\text{structured}} = \\frac{TP_s + TN_s}{N} = \\frac{180 + 260}{500} = \\frac{440}{500} $$\n\n最后，我们被要求计算有符号差值 $\\Delta$：\n$$ \\Delta = F1_{\\text{unstructured}} - \\text{accuracy}_{\\text{structured}} $$\n代入我们推导出的分数形式：\n$$ \\Delta = \\frac{380}{445} - \\frac{440}{500} $$\n为了计算最终值，我们将这些分数转换为它们的小数表示形式。\n$$ F1_{\\text{unstructured}} = \\frac{380}{445} \\approx 0.85393258... $$\n$$ \\text{accuracy}_{\\text{structured}} = \\frac{440}{500} = 0.88 $$\n现在，我们计算差值：\n$$ \\Delta \\approx 0.85393258 - 0.88 = -0.02606741... $$\n问题要求将此结果四舍五入到四位有效数字。第一个非零数字是百分位上的 $2$。四位有效数字是 $2$、$6$、$0$ 和 $6$。第五位有效数字是 $7$。由于 $7 \\geq 5$，我们将第四位有效数字向上取整。\n$$ \\Delta \\approx -0.02607 $$\n这是最终的数值答案。", "answer": "$$\\boxed{-0.02607}$$", "id": "4857088"}, {"introduction": "除了数据质量，获取数据的难易程度也是一个关键的考量因素。这个练习提出了一个巧妙的模型，用于量化和比较从高度结构化的OMOP通用数据模型中查询数据与处理非结构化文本的“复杂度”。通过这个练习，你将能更好地理解数据标准化的前期投入与临时文本处理的持续成本之间的权衡，这对于设计高效的数据分析流程至关重要。[@problem_id:4857095]", "problem": "一个卫生系统将其药物数据存储在观察性医学结果合作组织 (OMOP) 通用数据模型 (CDM) 中，同时也在电子健康记录 (EHR) 中存档非结构化的出院小结。您需要检索单个患者在成分层面的所有药物，并使用一个简单的、可操作的代理指标来比较结构化和非结构化方法之间的相对查询复杂度。使用以下定义和假设。\n\n结构化 (OMOP CDM) 检索的定义和假设：\n- 在 OMOP CDM 中，用药记录被记录在表 $drug\\_exposure$ 中，使用的字段是 $drug\\_concept\\_id$。\n- 成分归集通过表 $concept\\_ancestor$ 表示，它通过字段 $descendant\\_concept\\_id$ 和 $ancestor\\_concept\\_id$ 将一个后代药物概念链接到其祖先成分概念。\n- 概念的人类可读名称位于表 $concept$ 中，通过字段 $concept\\_name$ 获取。\n- 目标是检索由 $person\\_id = p$ 标识的单个患者的所有成分级别的药物名称和用药日期，这要求达到报告成分及其日期所需的最低标准化水平。假设 $person\\_id$ 过滤可以直接应用于 $drug\\_exposure$ 表，并且只需要标准的成分名称。\n- 计算为满足上述目标所需的 OMOP 表之间的等值连接 (equi-join) 的数量，要求在保证正确性的前提下最小化连接数。\n\n非结构化 (出院小结) 检索的定义和假设：\n- 非结构化处理流程检查同一患者的 $n$ 份出院小结。\n- 对于每份出院小结，有 $q$ 的概率存在一个专门的“药物”部分，此时处理流程需要 $a$ 次操作来提取药物；否则，有 $(1-q)$ 的概率该部分不存在，此时处理流程需要 $b$ 次操作通过扫描整个文档来提取药物。\n- 假设各文档之间是独立的，并且每次“操作”计为一个单位的工作量。\n\n复杂度指数：\n- 将结构化查询复杂度定义为连接数 $J_{s}$。\n- 将非结构化预期操作计数定义为所有 $n$ 份出院小结的总预期操作数 $O_{u}$，该值从第一性原理推导得出。\n- 将比较复杂度指数定义为比率 $R = \\frac{O_{u}}{J_{s}}$。\n\n数据：\n- 出院小结数量 $n = 3$。\n- 存在专门药物部分的概率 $q = 0.8$。\n- 如果部分存在，操作次数为 $a = 5$。\n- 如果部分不存在，操作次数为 $b = 20$。\n\n仅使用上述定义和假设，计算比率 $R$。报告一个实数值。无需四舍五入。", "solution": "用户提供了一个有科学依据、良定且客观的问题。所有必要的数据和定义都已提供，没有矛盾或歧义。该问题是有效的。\n\n解决方案要求计算比较复杂度指数 $R$，它被定义为非结构化预期操作计数 $O_u$ 与结构化查询复杂度 $J_s$ 的比值。我们必须分别计算 $J_s$ 和 $O_u$，然后求出它们的比值。\n\n首先，我们确定结构化查询复杂度 $J_s$，它被定义为从 OMOP 通用数据模型中检索指定数据所需的最少等值连接数。目标是获取由 $person\\_id = p$ 标识的单个患者的所有成分级别的药物名称及其对应的用药日期。\n\n1.  起点是 $drug\\_exposure$ 表，该表包含患者的用药记录。我们针对特定患者 $person\\_id = p$ 对此表进行筛选。该表为每个用药事件提供了 $drug\\_concept\\_id$ 和相关的用药日期。\n\n2.  $drug\\_exposure$ 表中的 $drug\\_concept\\_id$ 代表所使用的特定药物，这些药物不一定是成分。为了找到每种药物的活性成分，我们必须使用 $concept\\_ancestor$ 表。该表将后代概念（如特定的药物制剂）映射到其祖先概念（如成分）。因此，需要在 $drug\\_exposure$ 表和 $concept\\_ancestor$ 表之间进行第一次连接。连接条件是 $drug\\_exposure.drug\\_concept\\_id = concept\\_ancestor.descendant\\_concept\\_id$。这个连接使我们能够检索到每个用药记录的 $ancestor\\_concept\\_id$，这里的祖先就是成分概念。\n\n3.  此时，我们有了成分的概念标识符 ($ancestor\\_concept\\_id$) 和用药日期。最终要求是获取该成分的人类可读名称。$concept$ 表存储了所有概念的名称。因此，需要进行第二次连接。我们将上一步的结果与 $concept$ 表进行连接，连接条件是 $concept\\_ancestor.ancestor\\_concept\\_id = concept.concept\\_id$。从中我们可以选择 $concept\\_name$。\n\n这个两次连接的过程 ($drug\\_exposure \\rightarrow concept\\_ancestor \\rightarrow concept$) 是满足所有要求的最短序列。单次连接是不够的。例如，仅将 $drug\\_exposure$ 与 $concept$ 连接会得到所用药物的名称，而不是其成分。因此，结构化查询复杂度，即连接数，为 $J_s = 2$。\n\n接下来，我们计算非结构化预期操作计数 $O_u$。这是从 $n$ 份出院小结中提取药物信息所需的总操作数的期望值。\n\n设 $X_i$ 是表示第 $i$ 份小结（$i = 1, 2, \\ldots, n$）的操作数的随机变量。问题陈述如下：对于任何一份给定的小结：\n-   有 $q$ 的概率存在一个“药物”部分，操作数为 $a$。\n-   有 $(1-q)$ 的概率该部分不存在，操作数为 $b$。\n\n单个出院小结的期望操作数 $E[X_i]$ 由期望值的定义给出：\n$$E[X_i] = a \\cdot q + b \\cdot (1-q)$$\n所有 $n$ 个文档的总操作数是每个文档操作数的总和，即 $\\sum_{i=1}^{n} X_i$。总预期操作数 $O_u$ 是这个总和的期望值。根据期望的线性性质，并且由于每个文档的处理过程是独立同分布的：\n$$O_u = E\\left[\\sum_{i=1}^{n} X_i\\right] = \\sum_{i=1}^{n} E[X_i] = n \\cdot E[X_i]$$\n代入 $E[X_i]$ 的表达式：\n$$O_u = n(aq + b(1-q))$$\n我们已知以下数值：\n-   出院小结数量，$n = 3$。\n-   部分存在的概率，$q = 0.8$。\n-   部分存在时的操作数，$a = 5$。\n-   部分不存在时的操作数，$b = 20$。\n\n将这些值代入 $O_u$ 的方程中：\n$$O_u = 3 \\cdot (5 \\cdot 0.8 + 20 \\cdot (1-0.8))$$\n$$O_u = 3 \\cdot (5 \\cdot 0.8 + 20 \\cdot 0.2)$$\n$$O_u = 3 \\cdot (4 + 4)$$\n$$O_u = 3 \\cdot 8$$\n$$O_u = 24$$\n所以，非结构化预期操作计数为 $O_u = 24$。\n\n最后，我们计算比较复杂度指数 $R$，它是 $O_u$ 与 $J_s$ 的比值：\n$$R = \\frac{O_u}{J_s}$$\n使用我们计算出的值：\n$$R = \\frac{24}{2} = 12$$\n比率 $R$ 为 $12$。", "answer": "$$\\boxed{12}$$", "id": "4857095"}, {"introduction": "最后一个练习将我们的视角从数据提取本身，转移到数据的最终*应用*上。它通过一个数学推导，揭示了流行病学中的一个基本原则：暴露变量的测量误差（例如来自不完美的NLP工具）会如何导致研究结果产生偏倚。通过完成这个练习，你将深刻理解为什么高质量的数据对于从电子健康记录（EHR）中得出有效的科学结论至关重要，以及不完美的非结构化数据提取可能对最终的风险评估产生怎样的“衰减效应”。[@problem_id:4857070]", "problem": "一个医院信息学团队正在使用电子健康记录 (EHR) 来估计一个二元暴露 $E \\in \\{0,1\\}$（例如，慢性药物使用）对一个二元结局 $D \\in \\{0,1\\}$（例如，不良事件）的因果效应。暴露可以从结构化字段（被视为真实暴露的金标准测量）中确定，也可以使用自然语言处理 (NLP) 从临床医生笔记中提取。假设以下各项对于所研究的人群都是真实的，并且经过科学上良好校准的：\n\n- 真实暴露流行率为 $P(E=1)=\\pi$，其中 $\\pi=0.30$。\n- 未暴露人群中的真实风险为 $P(D=1 \\mid E=0)=p_{0}$，其中 $p_{0}=0.10$。\n- 暴露人群与未暴露人群相比的真实风险比为 $\\mathrm{RR}_{\\text{true}}=r$，其中 $r=2.0$，因此 $P(D=1 \\mid E=1)=p_{1}=r\\,p_{0}$。\n- NLP 笔记提取的暴露 $E^{\\ast}$ 是相对于结构化字段而言对 $E$ 的一种无差异错分测量，其灵敏度为 $Se=P(E^{\\ast}=1 \\mid E=1)=0.80$，特异度为 $Sp=P(E^{\\ast}=0 \\mid E=0)=0.90$。无差异错分意味着在给定 $E$ 的条件下，$E^{\\ast}$ 的误差不依赖于 $D$。\n\n仅从风险、风险比、全概率定律和贝叶斯定理的基本定义出发，推导当暴露由笔记变量 $E^{\\ast}$ 定义时观测风险比\n$$\n\\mathrm{RR}_{\\text{notes}}=\\frac{P(D=1 \\mid E^{\\ast}=1)}{P(D=1 \\mid E^{\\ast}=0)}\n$$,\n的一个闭式表达式，该表达式是 $Se$、$Sp$、$\\pi$、$p_{0}$ 和 $r$ 的函数。然后代入给定的数值计算 $\\mathrm{RR}_{\\text{notes}}$ 和衰减因子\n$$\nA=\\frac{\\mathrm{RR}_{\\text{notes}}}{\\mathrm{RR}_{\\text{true}}}.\n$$\n将 $A$ 作为您的最终答案报告。将您的最终数值答案四舍五入到四位有效数字。将答案表示为纯数（无单位）。", "solution": "该问题是有效的，因为它在科学上基于流行病学和生物统计学的原理，提法得当，提供了所有必要的信息，并且没有歧义或矛盾。\n\n目标是基于一个错分的暴露测量 $E^{\\ast}$，推导观测风险比 $\\mathrm{RR}_{\\text{notes}}$ 的表达式，然后计算衰减因子 $A$。真实风险比由 $\\mathrm{RR}_{\\text{true}} = r = \\frac{P(D=1|E=1)}{P(D=1|E=0)} = \\frac{p_1}{p_0}$ 给出。观测风险比定义为：\n$$ \\mathrm{RR}_{\\text{notes}} = \\frac{P(D=1 \\mid E^{\\ast}=1)}{P(D=1 \\mid E^{\\ast}=0)} $$\n我们将从基本原理出发，分别推导 $\\mathrm{RR}_{\\text{notes}}$ 的分子和分母的表达式。\n\n首先，我们来推导分子 $P(D=1 \\mid E^{\\ast}=1)$ 的表达式。\n使用条件概率的定义，我们有：\n$$ P(D=1 \\mid E^{\\ast}=1) = \\frac{P(D=1, E^{\\ast}=1)}{P(E^{\\ast}=1)} $$\n我们通过应用全概率定律，以真实暴露状态 $E \\in \\{0,1\\}$ 为条件，来找到分母 $P(E^{\\ast}=1)$：\n$$ P(E^{\\ast}=1) = P(E^{\\ast}=1 \\mid E=1)P(E=1) + P(E^{\\ast}=1 \\mid E=0)P(E=0) $$\n使用提供的定义：$P(E=1) = \\pi$，$P(E=0) = 1-\\pi$，$P(E^{\\ast}=1 \\mid E=1) = Se$ (灵敏度)，以及 $P(E^{\\ast}=0 \\mid E=0) = Sp$ (特异度)，这意味着 $P(E^{\\ast}=1 \\mid E=0) = 1 - Sp$。\n将这些代入 $P(E^{\\ast}=1)$ 的方程中，得到：\n$$ P(E^{\\ast}=1) = Se \\cdot \\pi + (1-Sp)(1-\\pi) $$\n接下来，我们再次使用全概率定律，以 $E$ 为条件，来找到分子 $P(D=1, E^{\\ast}=1)$：\n$$ P(D=1, E^{\\ast}=1) = P(D=1, E^{\\ast}=1 \\mid E=1)P(E=1) + P(D=1, E^{\\ast}=1 \\mid E=0)P(E=0) $$\n使用概率的链式法则，$P(A,B|C) = P(A|B,C)P(B|C)$，这变成：\n$$ P(D=1, E^{\\ast}=1) = P(D=1 \\mid E^{\\ast}=1, E=1)P(E^{\\ast}=1 \\mid E=1)P(E=1) + P(D=1 \\mid E^{\\ast}=1, E=0)P(E^{\\ast}=1 \\mid E=0)P(E=0) $$\n问题陈述 $E^{\\ast}$ 是相对于 $D$ 而言对 $E$ 的一个无差异错分测量。这意味着在给定 $E$ 的条件下，$E^{\\ast}$ 与 $D$ 是条件独立的，这蕴含了 $P(D=1 \\mid E, E^{\\ast}) = P(D=1 \\mid E)$。应用这个假设：\n$$ P(D=1 \\mid E^{\\ast}=1, E=1) = P(D=1 \\mid E=1) = p_1 $$\n$$ P(D=1 \\mid E^{\\ast}=1, E=0) = P(D=1 \\mid E=0) = p_0 $$\n将这些和其他定义代入 $P(D=1, E^{\\ast}=1)$ 的表达式中：\n$$ P(D=1, E^{\\ast}=1) = p_1 \\cdot Se \\cdot \\pi + p_0 \\cdot (1-Sp) \\cdot (1-\\pi) $$\n给定 $p_1 = r \\cdot p_0$，我们可以提取出 $p_0$：\n$$ P(D=1, E^{\\ast}=1) = p_0 [r \\cdot Se \\cdot \\pi + (1-Sp)(1-\\pi)] $$\n组合 $P(D=1 \\mid E^{\\ast}=1)$ 的各个部分：\n$$ P(D=1 \\mid E^{\\ast}=1) = \\frac{p_0 [r \\cdot Se \\cdot \\pi + (1-Sp)(1-\\pi)]}{Se \\cdot \\pi + (1-Sp)(1-\\pi)} $$\n\n其次，我们推导 $\\mathrm{RR}_{\\text{notes}}$ 的分母 $P(D=1 \\mid E^{\\ast}=0)$ 的表达式。\n遵循类似的步骤，从条件概率的定义开始：\n$$ P(D=1 \\mid E^{\\ast}=0) = \\frac{P(D=1, E^{\\ast}=0)}{P(E^{\\ast}=0)} $$\n分母是 $P(E^{\\ast}=0) = 1 - P(E^{\\ast}=1)$，或者通过全概率定律：\n$$ P(E^{\\ast}=0) = P(E^{\\ast}=0 \\mid E=1)P(E=1) + P(E^{\\ast}=0 \\mid E=0)P(E=0) $$\n使用 $P(E^{\\ast}=0 \\mid E=1) = 1-Se$ 和 $P(E^{\\ast}=0 \\mid E=0) = Sp$：\n$$ P(E^{\\ast}=0) = (1-Se)\\pi + Sp(1-\\pi) $$\n分子 $P(D=1, E^{\\ast}=0)$ 通过以 $E$ 为条件找到：\n$$ P(D=1, E^{\\ast}=0) = P(D=1 \\mid E^{\\ast}=0, E=1)P(E^{\\ast}=0 \\mid E=1)P(E=1) + P(D=1 \\mid E^{\\ast}=0, E=0)P(E^{\\ast}=0 \\mid E=0)P(E=0) $$\n应用无差异错分假设 $P(D=1 \\mid E, E^{\\ast}) = P(D=1 \\mid E)$，我们得到：\n$$ P(D=1, E^{\\ast}=0) = p_1 \\cdot (1-Se) \\cdot \\pi + p_0 \\cdot Sp \\cdot (1-\\pi) $$\n使用 $p_1 = r \\cdot p_0$ 提取出 $p_0$：\n$$ P(D=1, E^{\\ast}=0) = p_0 [r(1-Se)\\pi + Sp(1-\\pi)] $$\n组合 $P(D=1 \\mid E^{\\ast}=0)$ 的各个部分：\n$$ P(D=1 \\mid E^{\\ast}=0) = \\frac{p_0 [r(1-Se)\\pi + Sp(1-\\pi)]}{(1-Se)\\pi + Sp(1-\\pi)} $$\n\n现在，我们组合出 $\\mathrm{RR}_{\\text{notes}}$ 的最终表达式：\n$$ \\mathrm{RR}_{\\text{notes}} = \\frac{P(D=1 \\mid E^{\\ast}=1)}{P(D=1 \\mid E^{\\ast}=0)} = \\frac{\\frac{p_0 [r \\cdot Se \\cdot \\pi + (1-Sp)(1-\\pi)]}{Se \\cdot \\pi + (1-Sp)(1-\\pi)}}{\\frac{p_0 [r(1-Se)\\pi + Sp(1-\\pi)]}{(1-Se)\\pi + Sp(1-\\pi)}} $$\n基线风险 $p_0$ 被消去，得到作为 $r, Se, Sp,$ 和 $\\pi$ 的函数的闭式表达式：\n$$ \\mathrm{RR}_{\\text{notes}} = \\frac{r \\cdot Se \\cdot \\pi + (1-Sp)(1-\\pi)}{r(1-Se)\\pi + Sp(1-\\pi)} \\cdot \\frac{(1-Se)\\pi + Sp(1-\\pi)}{Se \\cdot \\pi + (1-Sp)(1-\\pi)} $$\n这就是所要求的符号推导。\n\n接下来，我们代入给定的数值：\n$r=2.0$, $\\pi=0.30$, $Se=0.80$, $Sp=0.90$.\n由此，我们推导出：$1-\\pi = 0.70$，$1-Se = 0.20$，$1-Sp = 0.10$。\n\n让我们计算 $\\mathrm{RR}_{\\text{notes}}$ 表达式的四个主要组成部分：\n- $P(E^{\\ast}=1) = Se \\cdot \\pi + (1-Sp)(1-\\pi) = (0.80)(0.30) + (0.10)(0.70) = 0.24 + 0.07 = 0.31$\n- $P(E^{\\ast}=0) = (1-Se)\\pi + Sp(1-\\pi) = (0.20)(0.30) + (0.90)(0.70) = 0.06 + 0.63 = 0.69$\n- 观测暴露组风险的分子：$r \\cdot Se \\cdot \\pi + (1-Sp)(1-\\pi) = (2.0)(0.80)(0.30) + (0.10)(0.70) = 0.48 + 0.07 = 0.55$\n- 观测未暴露组风险的分子：$r(1-Se)\\pi + Sp(1-\\pi) = (2.0)(0.20)(0.30) + (0.90)(0.70) = 0.12 + 0.63 = 0.75$\n\n将这些数值代入简化后的 $\\mathrm{RR}_{\\text{notes}}$ 公式中：\n$$ \\mathrm{RR}_{\\text{notes}} = \\frac{0.55}{0.75} \\cdot \\frac{0.69}{0.31} = \\frac{0.3795}{0.2325} \\approx 1.632258... $$\n真实风险比为 $\\mathrm{RR}_{\\text{true}} = r = 2.0$。\n衰减因子 $A$ 是观测风险比与真实风险比的比率：\n$$ A = \\frac{\\mathrm{RR}_{\\text{notes}}}{\\mathrm{RR}_{\\text{true}}} = \\frac{1.632258...}{2.0} = 0.816129... $$\n将结果四舍五入到四位有效数字，我们得到 $A = 0.8161$。", "answer": "$$\n\\boxed{0.8161}\n$$", "id": "4857070"}]}