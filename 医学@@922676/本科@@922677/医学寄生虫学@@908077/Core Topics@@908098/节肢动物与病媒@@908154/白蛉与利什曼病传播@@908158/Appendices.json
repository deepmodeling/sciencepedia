{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的计算开始，以量化个体面临的直接风险。本练习将指导您如何综合利用昆虫学数据，例如白蛉的叮咬率和在媒介种群中的感染率，来推导并计算一个关键的流行病学指标——人类感染力（force of infection）。通过这项实践[@problem_id:4810720]，您将学习如何将一系列独立的概率和比率事件串联起来，以评估在特定流行病学背景下，个体每天获得新感染的瞬时速率。", "problem": "一个利什曼病流行的城乡结合社区，由白蛉属（Phlebotomus）和罗蛉属（Lutzomyia）的嗜人雌性白蛉提供传播服务。考虑一个生活在该环境中的易感人群宿主。请使用人类感染力的核心定义（即在泊松暴露过程中，单位时间内易感个体获得感染的瞬时速率），以及以下经过充分检验的虫媒传播流行病学事实：(i) 每只雌性媒介以一个平均速率尝试叮咬人类，(ii) 只有受感染的媒介才能进行传染性叮咬，以及 (iii) 每次传染性叮咬都有一个固定的概率导致感染。\n\n昆虫学监测提供了以下在传播季节内的平均估计值：\n- 每只雌性白蛉每天对人的平均叮咬率：$a = 0.35\\,\\text{day}^{-1}$。\n- 人均雌性白蛉密度：$m = 3.0$。\n- 感染利什曼原虫的雌性白蛉比例：$i_v = 0.06$。\n- 受感染的雌性白蛉进行一次传染性叮咬后感染易感人群的概率：$b = 0.07$。\n\n从上述核心定义出发，不使用预先给定的目标公式，推导一个用 $a$、$m$、$i_v$ 和 $b$ 表示人类感染力的表达式，并计算其在此情境下的值。请以 $\\text{day}^{-1}$ 为单位表示您的最终数值答案，并将答案四舍五入至三位有效数字。简要论证您使用的任何独立性假设，并指出至少两个源于白蛉或利什曼原虫生物学特性的此计算的生物学局限性。", "solution": "该问题经评估是有效的，因为它科学上基于已确立的流行病学原理，问题设定良好，目标明确，数据充分，且语言客观。所提供的参数对于一个虫媒病流行地区而言是合理的。\n\n目标是推导人类感染力（记作 $\\lambda_h$）的表达式，并计算其数值。感染力被定义为易感个体获得感染的瞬时速率。我们被要求将其建模为泊松过程。\n\n让我们遵循从媒介到宿主的传播链，分解导致人类感染的各个事件。\n\n1.  我们考虑单个易感人群。该个体暴露于一个局部的雌性白蛉种群中。这些白蛉相对于人的密度由参数 $m$（人均雌性白蛉密度）给出。\n    $$m = 3.0$$\n\n2.  并非所有这些白蛉都具有传染性。雌性白蛉种群中感染了*利什曼原虫*（Leishmania）的比例由 $i_v$ 给出。\n    $$i_v = 0.06$$\n    因此，人均受感染的雌性白蛉的平均数量是人均总白蛉密度与受感染白蛉比例的乘积。\n    $$\\text{人均受感染白蛉数量} = m \\cdot i_v$$\n\n3.  每只雌性白蛉，无论其感染状态如何，都以平均速率 $a$（人类叮咬率）尝试叮咬人类。\n    $$a = 0.35 \\, \\text{day}^{-1}$$\n    问题要求的是对单个人的叮咬率。我们假设单个白蛉的叮咬行为是独立的。因此，单个人被整个受感染白蛉种群叮咬的总速率是人均受感染白蛉数量与每只白蛉叮咬率的乘积。在某些情境下，这个速率常被称为“传染性叮咬率”或“昆虫学接种率”（EIR），但在这里我们将直接推导感染力。\n    $$\\text{来自受感染白蛉对单个人的叮咬率} = (m \\cdot i_v) \\cdot a$$\n\n4.  来自受感染白蛉的一次叮咬并不保证传播。存在一个概率 $b$，即来自具传染性媒介的一次叮咬成功导致易感人群感染。\n    $$b = 0.07$$\n\n5.  感染力 $\\lambda_h$ 是*成功感染事件*的速率。问题指出暴露遵循泊松过程。“潜在传染性事件”（即来自受感染白蛉的叮咬）的发生速率是 $\\lambda_{\\text{bites}} = a \\cdot m \\cdot i_v$。这些事件中的每一个都有独立的概率 $b$ 成为“成功事件”（即导致感染）。这是一个泊松过程稀疏化的经典例子。如果事件以速率 $\\lambda$ 遵循泊松过程到达，并且每个事件以概率 $p$ 被独立地保留，那么保留下来的事件所构成的过程也是一个速率为 $\\lambda \\cdot p$ 的泊松过程。\n\n应用此原理，成功感染的速率 $\\lambda_h$ 是受感染白蛉的叮咬率乘以每次叮咬的传播概率。\n\n$$\\lambda_h = (\\text{来自受感染白蛉的叮咬率}) \\times (\\text{每次叮咬的感染概率})$$\n代入前面步骤中的表达式，我们得到推导出的感染力公式：\n$$\\lambda_h = (a \\cdot m \\cdot i_v) \\cdot b$$\n标准惯例是将参数分组为：\n$$\\lambda_h = a \\cdot m \\cdot b \\cdot i_v$$\n\n现在，我们使用所提供的数据计算 $\\lambda_h$ 的数值：\n$$a = 0.35 \\, \\text{day}^{-1}$$\n$$m = 3.0$$\n$$i_v = 0.06$$\n$$b = 0.07$$\n\n$$\\lambda_h = (0.35 \\, \\text{day}^{-1}) \\cdot (3.0) \\cdot (0.07) \\cdot (0.06)$$\n$$\\lambda_h = (1.05 \\, \\text{day}^{-1}) \\cdot (0.0042)$$\n$$\\lambda_h = 0.00441 \\, \\text{day}^{-1}$$\n问题要求答案四舍五入至三位有效数字。结果 $0.00441$ 已经恰好是三位有效数字（数字 $4$、$4$ 和 $1$）。\n\n独立性假设的论证：\n该推导依赖于构成事件在统计上是独立的这一假设。具体来说：\n- 每只白蛉的叮咬行为与其他白蛉独立。\n- 一只白蛉的感染状态与另一只独立。\n- 每次叮咬的传播成功与否是一个独立的伯努利试验，其概率为恒定的 $b$。\n这些假设允许通过将速率和概率简单相乘来得到最终的感染率。\n\n此计算的生物学局限性：\n这个模型虽然基础，但简化了利什曼病传播的复杂生物学现实。两个关键的局限性是：\n1.  **均质性假设**：该计算假设所有参数在群体中都是统一的平均值。实际上，在叮咬暴露（某些个体被叮咬的次数远多于其他人）、宿主易感性和媒介能力方面存在显著的异质性。对媒介的“超级吸引者”的存在可以不成比例地驱动传播，而这是使用平均叮咬率 $a$ 无法捕捉到的。\n2.  **静态的媒介与寄生虫动态**：该模型使用了媒介种群的静态快照，由密度（$m$）和感染比例（$i_v$）的恒定值表示。它忽略了关键的时间动态，例如：(i) 外源性潜伏期（EIP），即*利什曼原虫*在吸食感染性血餐后，在白蛉体内发育到具传染性阶段所需的时间；以及 (ii) 媒介死亡率，这意味着并非所有受感染的白蛉都能存活过 EIP 从而变得具有传染性。动态模型需要考虑这些过程，以更准确地描述具传染性的媒介比例 $i_v$ 如何随时间变化。", "answer": "$$\\boxed{0.00441}$$", "id": "4810720"}, {"introduction": "在评估了个体风险之后，我们转向一个更宏观的概念，即媒介能量（vectorial capacity），它衡量的是整个媒介种群驱动疾病传播的内在潜力。与直接计算感染力不同，本练习[@problem_id:4810801]要求您从第一性原理出发，推导出媒介能量的经典公式。这个过程将加深您对关键参数之间关系的理解，例如媒介的每日存活率 $p$、叮咬率 $a$ 以及病原体在外源性潜伏期 $n$ 内的存活情况，这些因素共同决定了传播的强度。", "problem": "在一个利什曼病疫源地，白蛉（Phlebotomus属和Lutzomyia属）是唯一的传播媒介。考虑以下来自Ross–Macdonald媒介传播疾病框架的、经过充分检验的流行病学定义。设 $m$ 表示雌性媒介与人类的比率，$a$ 表示每只媒介每天叮咬人类的比率，$p$ 表示媒介的每日存活概率（假定与年龄无关），$n$ 表示利什曼原虫（Leishmania）在媒介体内发育所需的外源性潜伏期（EIP），单位为天。假设传播需要两次人-媒介接触（一次叮咬使媒介获得感染，一次叮咬将病原体传播给另一个人），所有叮咬都发生在人类身上，并且与每日存活概率 $p$ 对应的瞬时死亡率是恒定的。仅从这些定义以及将存活和叮咬解释为连续时间中的类泊松过程出发，推导媒介传播能力 $C$（即由单个感染者引起的媒介种群每天对每人产生的潜在感染性叮咬的期望次数）的表达式，然后用 $m = 5$，$a = 0.25 \\, \\text{day}^{-1}$，$p = 0.85$，以及 $n = 7$ 天的值进行计算。将 $C$ 的最终值以 $\\text{day}^{-1}$ 为单位表示，并将数值答案四舍五入到四位有效数字。简要解释您所获得的数值在此情景下所代表的潜在传播强度。", "solution": "在进行解答之前，首先对问题陈述的有效性进行严格评估。\n\n### 步骤 1：提取已知条件\n- $m$：雌性媒介与人类的比率，无量纲量。\n- $a$：每只媒介每天叮咬人类的比率，单位为 $\\text{day}^{-1}$。\n- $p$：媒介的每日存活概率，无量纲。\n- $n$：外源性潜伏期（EIP），单位为天。\n- 媒介的瞬时死亡率是恒定的，对应于与年龄无关的存活概率。\n- 叮咬和存活是连续时间中的类泊松过程。\n- 所有媒介叮咬都发生在人类身上。\n- 目标量是媒介传播能力 $C$。\n- 用于计算的数值：$m = 5$，$a = 0.25 \\text{ day}^{-1}$，$p = 0.85$，$n = 7 \\text{ 天}$。\n- $C$ 的最终数值答案应四舍五入到四位有效数字。\n- 要求对计算出的 $C$ 的量值进行简要解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准评估该问题：\n- **科学依据：** 该问题基于Ross-Macdonald模型，这是数学流行病学中用于研究媒介传播疾病的基础框架。参数（$m, a, p, n$）是标准的，其定义与已发表的流行病学文献一致。生物学背景（利什曼病、白蛉、EIP）是准确的。恒定死亡率的假设（导致指数存活分布）是此类模型的标准且必要的简化。\n- **适定性：** 问题提供了所有必要的参数和一个明确的目标：推导媒介传播能力 $C$ 的公式，然后计算其值。要求明确，可以得出一个唯一的解。\n- **客观性：** 问题以精确、定量且无偏见的技术语言陈述。\n- **缺陷清单：**\n    1.  **科学不健全：** 无。该模型在科学上是健全的。\n    2.  **不可形式化/不相关：** 问题是明确可形式化的，并且与医学寄生虫学和利什曼病传播动力学的主题直接相关。\n    3.  **不完整/矛盾：** 无。信息充分且自洽。\n    4.  **不切实际/不可行：** 给定的 $m, a, p, n$ 数值在利什曼病传播的实地研究中观察到的合理范围内。\n    5.  **不适定：** 否。问题结构允许一个唯一、稳定且有意义的解。\n    6.  **伪深刻/琐碎：** 否。推导需要对流行病学和微积分的基本原理有扎实的理解。\n    7.  **超出科学可验证性：** 否。该模型及其组成部分基于可验证和可证伪的科学原理。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供完整的解答。\n\n### 媒介传播能力（$C$）的推导\n\n媒介传播能力 $C$ 定义为由单个感染者引起的整个媒介种群每天对易感人群产生的新增感染性叮咬的期望次数。它本质上是一个比率，单位是 $\\text{time}^{-1}$。\n\n推导过程通过组合一系列基于概率和比率的事件来进行：\n\n1.  **恒定死亡率：** 每日存活概率为 $p$。对于一个瞬时死亡率 $\\mu$ 恒定的连续时间过程，存活时间间隔 $\\Delta t$ 的概率是 $\\exp(-\\mu \\Delta t)$。对于一天的时间间隔（$\\Delta t = 1$），我们有 $p = \\exp(-\\mu \\cdot 1)$，这意味着 $\\mu = -\\ln(p)$。比率 $\\mu$ 的单位是 $\\text{day}^{-1}$。\n\n2.  **媒介感染率：** 种群中存在一个感染者。媒介与人类的比率为 $m$。每只媒介的叮咬率为 $a$。因此，媒介叮咬这个感染者的总比率是 $m \\times a$ 的乘积。假设每次对感染者的叮咬都会导致媒介感染，那么这个乘积就代表了新媒介被感染的比率。\n    来自一个人的新媒介感染率 $= m \\times a$。\n    单位是 $(\\text{无量纲}) \\times (\\text{day}^{-1}) = \\text{day}^{-1}$。\n\n3.  **每只受感染媒介的预期未来感染性叮咬次数：** 考虑一只在时间 $t=0$ 刚刚吸食了感染性血餐的媒介。这只媒介还不是感染性的。它必须存活过 $n$ 天的外源性潜伏期（EIP）才能变得具有感染性。存活过这段时期的概率是存活 $n$ 天的概率，即 $p^n = \\exp(-\\mu n)$。\n\n    如果媒介存活过EIP，它在时间 $t=n$ 时变得具有感染性，并在其剩余生命中保持感染性。我们需要计算它从时间 $n$ 开始将进行的叮咬总数的期望值。叮咬率为 $a$。在任何时间 $t \\ge n$ 媒介存活的概率是 $\\exp(-\\mu t)$。\n\n    假定这只媒介在 $t=0$ 时被感染，其产生的感染性叮咬的期望次数可以通过将其叮咬率在其剩余寿命内（从它变得具有感染性的时刻 $t=n$ 到无穷大）进行积分来计算：\n    $$ \\text{预期感染性叮咬次数} = \\int_{n}^{\\infty} a \\cdot (\\text{存活到时间 } t \\text{ 的概率}) \\, dt $$\n    $$ = \\int_{n}^{\\infty} a \\exp(-\\mu t) \\, dt $$\n    解此积分：\n    $$ = a \\left[ -\\frac{1}{\\mu} \\exp(-\\mu t) \\right]_{n}^{\\infty} $$\n    $$ = a \\left( 0 - \\left( -\\frac{1}{\\mu} \\exp(-\\mu n) \\right) \\right) $$\n    $$ = \\frac{a}{\\mu} \\exp(-\\mu n) $$\n\n4.  **组合各部分得到C：** 媒介传播能力 $C$ 是媒介被感染的比率（来自单个感染者）与每只新感染的媒介将产生的后续感染性叮咬的期望总次数的乘积。\n    $$ C = (\\text{新媒介感染率}) \\times (\\text{每次新感染的预期感染性叮咬次数}) $$\n    $$ C = (m \\times a) \\times \\left( \\frac{a}{\\mu} \\exp(-\\mu n) \\right) $$\n    $$ C = \\frac{m a^2 \\exp(-\\mu n)}{\\mu} $$\n    代入 $\\mu = -\\ln(p)$ 和 $\\exp(-\\mu n) = p^n$，我们得到媒介传播能力的标准公式：\n    $$ C = \\frac{m a^2 p^n}{-\\ln(p)} $$\n\n### $C$ 的计算\n\n问题提供了以下数值：\n- $m = 5$\n- $a = 0.25 \\text{ day}^{-1}$\n- $p = 0.85$\n- $n = 7 \\text{ 天}$\n\n将这些值代入推导出的 $C$ 的表达式中：\n$$ C = \\frac{(5) \\cdot (0.25)^2 \\cdot (0.85)^7}{-\\ln(0.85)} $$\n首先，我们计算各个组成部分：\n- $a^2 = (0.25)^2 = 0.0625$\n- $m \\cdot a^2 = 5 \\cdot 0.0625 = 0.3125$\n- $p^n = (0.85)^7 \\approx 0.320577088$\n- $\\ln(0.85) \\approx -0.162518929$\n- $-\\ln(0.85) \\approx 0.162518929$\n\n现在，我们计算 $C$ 的最终值：\n$$ C = \\frac{0.3125 \\cdot 0.320577088}{0.162518929} $$\n$$ C = \\frac{0.10018034}{0.162518929} \\approx 0.616428 \\text{ day}^{-1} $$\n\n按要求四舍五入到四位有效数字：\n$$ C \\approx 0.6164 \\text{ day}^{-1} $$\n\n### 结果解释\n\n计算出的媒介传播能力为 $C \\approx 0.6164 \\text{ day}^{-1}$。这个值代表了由媒介种群驱动的潜在传播强度。这意味着，在这个特定环境中，一个患有利什曼病的人预计每天会成为约 $0.6164$ 次新的对其他人的感染性白蛉叮咬的来源。\n\n媒介传播能力是基本再生数（$R_0$）的一个关键组成部分。对于一个简单模型，$R_0 = C \\cdot \\frac{b}{r}$，其中 $b$ 是每次叮咬时从感染性媒介传播给人的概率，$1/r$ 是人类的平均感染期。为了使传播在种群中持续， $R_0$ 必须大于1。这意味着传播效率和人类感染期的乘积（$b/r$）必须超过 $1/C$。在本例中，$1/C \\approx 1/0.6164 \\approx 1.62$ 天。由于利什曼病的人类感染期可持续数月甚至数年，因此持续时间 $1/r$ 非常大。因此，即使传播概率（$b$）非常小，也可能导致 $R_0 > 1$。所以，媒介传播能力为 $0.6164 \\text{ day}^{-1}$ 表明存在显著的传播风险，并暗示利什曼病可以在此环境中轻易地持续存在并成为地方病。", "answer": "$$\n\\boxed{0.6164}\n$$", "id": "4810801"}, {"introduction": "最后，我们将所有概念整合到一个动态的、现实世界的场景中。这项实践[@problem_id:4810784]将挑战您使用一个常微分方程（ODE）计算模型，来模拟一个包含犬（主要宿主）、人类（偶然宿主）和白蛉媒介的复杂利什曼病传播系统。您将亲身体验如何将在之前练习中遇到的静态参数（如叮咬率 $a$、存活率 $p$ 等）应用于一个动态框架，以评估一项重要的公共卫生干预措施——为犬类使用内吸性杀虫剂——对控制人类疾病发病率的预期效果。", "problem": "考虑一个用于内脏利什曼病传播的房室常微分方程（ODE）模型，该模型涉及犬、人和白蛉媒介。犬是主要的储存宿主，人是偶然宿主，白蛉（白蛉属 *Phlebotomus* 或罗蛉属 *Lutzomyia*）在宿主之间传播寄生虫。对犬施用的全身性杀虫剂会在白蛉从经处理的犬只吸血后导致其死亡。目标是通过对犬-媒介-人耦合系统进行建模，并计算使用杀虫剂与不使用杀虫剂的基线情况相比，人类累积发病率的比率，来评估此类杀虫剂对人类发病率的预期影响。\n\n使用以下与媒介传播疾病的物理和生物学一致的基本基础：\n- 质量作用叮咬：每只媒介以每只媒介每天 $a$ 次叮咬的叮咬率寻找宿主，将 $\\phi_d$ 比例的叮咬分配给犬，$\\phi_h = 1 - \\phi_d$ 比例的叮咬分配给人类。\n- 感染力（FOI）：新感染以与易感个体和感染个体之间由媒介介导的接触成比例的速率出现，并具有每次叮咬的传播概率。\n- 人、犬和媒介的恒定种群近似，通过出生与自然死亡率相平衡来维持。\n\n模型房室和参数：\n- 人类房室：易感者 $S_H(t)$，感染者 $I_H(t)$，总数为 $N_H = S_H(t) + I_H(t)$。\n- 犬类房室：易感者 $S_D(t)$，感染者 $I_D(t)$，总数为 $N_D = S_D(t) + I_D(t)$。\n- 媒介房室：易感者 $S_V(t)$，感染者 $I_V(t)$，总数为 $N_V = S_V(t) + I_V(t)$。\n- 人类参数：自然死亡率 $\\mu_H$，恢复率 $\\gamma_H$，出生率 $\\mu_H N_H$ 进入 $S_H$。\n- 犬类参数：自然死亡率 $\\mu_D$，恢复率 $\\gamma_D$，出生率 $\\mu_D N_D$ 进入 $S_D$。\n- 媒介参数：自然死亡率 $\\mu_V$，选择补充率以大致维持 $N_V$ 恒定。\n- 叮咬率：$a$。\n- 宿主偏好：叮咬犬的比例 $\\phi_d$，叮咬人的比例 $\\phi_h = 1 - \\phi_d$。\n- 每次叮咬的传播概率：媒介到人 $b_{VH}$，媒介到犬 $b_{VD}$，犬到媒介 $b_{DV}$，人到媒介 $b_{HV}$。\n- 犬只的全身性杀虫剂覆盖率 $c_d$（经处理的比例），每次叮咬经处理的犬只后白蛉的致死概率 $p_{\\mathrm{kill}}$。\n\n定义感染力：\n$$\n\\lambda_H(t) = a \\, \\phi_h \\, b_{VH} \\, \\frac{I_V(t)}{N_V}, \\quad\n\\lambda_D(t) = a \\, \\phi_d \\, b_{VD} \\, \\frac{I_V(t)}{N_V},\n$$\n$$\n\\lambda_V(t) = a \\left( \\phi_d \\, b_{DV} \\, \\frac{I_D(t)}{N_D} + \\phi_h \\, b_{HV} \\, \\frac{I_H(t)}{N_H} \\right).\n$$\n全身性杀虫剂通过一个附加风险增加每只媒介的死亡率，该风险等于叮咬经处理的犬只的预期致死率：\n$$\n\\mu_V^{\\mathrm{eff}} = \\mu_V + a \\, \\phi_d \\, c_d \\, p_{\\mathrm{kill}}.\n$$\n假设媒介补充使媒介总种群在当前死亡率下大致恒定在 $N_V$ 水平，即补充流量 $r_V(t) = \\mu_V^{\\mathrm{eff}} \\, N_V$ 进入 $S_V$。\n\nODE 系统为：\n$$\n\\frac{dS_H}{dt} = \\mu_H N_H - \\lambda_H S_H - \\mu_H S_H + \\gamma_H I_H, \\quad\n\\frac{dI_H}{dt} = \\lambda_H S_H - (\\gamma_H + \\mu_H) I_H,\n$$\n$$\n\\frac{dS_D}{dt} = \\mu_D N_D - \\lambda_D S_D - \\mu_D S_D + \\gamma_D I_D, \\quad\n\\frac{dI_D}{dt} = \\lambda_D S_D - (\\gamma_D + \\mu_D) I_D,\n$$\n$$\n\\frac{dS_V}{dt} = r_V(t) - \\lambda_V S_V - \\mu_V^{\\mathrm{eff}} S_V, \\quad\n\\frac{dI_V}{dt} = \\lambda_V S_V - \\mu_V^{\\mathrm{eff}} I_V.\n$$\n用一个辅助累加器 $J_H(t)$ 扩展该系统，以满足人类累积发病率：\n$$\n\\frac{dJ_H}{dt} = \\lambda_H(t) \\, S_H(t),\n$$\n其中 $J_H(0) = 0$。量 $J_H(T)/N_H$ 是在时间范围 $T$ 内每人的累积发病率。\n\n使用以下科学上合理的参数值和初始条件：\n- 时间范围：$T = 365$ 天。\n- 人类种群：$N_H = 100000$，初始感染者 $I_{H}(0) = 50$，因此 $S_{H}(0) = N_H - I_{H}(0)$。\n- 犬类种群：$N_D = 20000$，初始感染者 $I_{D}(0) = 500$，因此 $S_{D}(0) = N_D - I_{D}(0)$。\n- 媒介种群：$N_V = 500000$，初始感染者 $I_{V}(0) = 1000$，因此 $S_{V}(0) = N_V - I_{V}(0)$。\n- 自然死亡率：人类 $\\mu_H = \\frac{1}{70 \\times 365} \\, \\text{day}^{-1}$，犬 $\\mu_D = \\frac{1}{10 \\times 365} \\, \\text{day}^{-1}$，媒介 $\\mu_V = \\frac{1}{14} \\, \\text{day}^{-1}$。\n- 恢复率：人类 $\\gamma_H = \\frac{1}{180} \\, \\text{day}^{-1}$，犬 $\\gamma_D = \\frac{1}{120} \\, \\text{day}^{-1}$。\n- 叮咬率：$a = 0.3 \\, \\text{day}^{-1}$。\n- 每次叮咬的传播概率：媒介到人 $b_{VH} = 0.25$，媒介到犬 $b_{VD} = 0.30$，犬到媒介 $b_{DV} = 0.40$，人到媒介 $b_{HV} = 0.05$。\n\n对每个测试用例，运行模型两次：\n- 基线情景，无杀虫剂：$c_d = 0$, $p_{\\mathrm{kill}} = 0$，使用指定的 $\\phi_d$。\n- 干预情景，有杀虫剂：使用测试用例中给定的 $c_d$, $p_{\\mathrm{kill}}$ 和 $\\phi_d$。\n\n计算比率 $R = \\frac{J_H(T)/N_H \\text{（使用杀虫剂）}}{J_H(T)/N_H \\text{（不使用杀虫剂）}}$，这是一个无量纲的小数，表示在 $T$ 天内干预情景相对于基线的累积发病率。将每个 $R$ 四舍五入到 $6$ 位小数。\n\n参数三元组 $(c_d, p_{\\mathrm{kill}}, \\phi_d)$ 的测试套件，用于评估不同方面，包括正常路径、边界条件和边缘情况：\n- 情况 1：$(0.0, 0.0, 0.6)$。\n- 情况 2：$(0.5, 0.5, 0.6)$。\n- 情况 3：$(0.8, 0.9, 0.6)$。\n- 情况 4：$(1.0, 1.0, 0.6)$。\n- 情况 5：$(0.8, 0.9, 0.2)$。\n- 情况 6：$(0.8, 0.9, 0.95)$。\n\n你的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$，其中每个 $r_i$ 是上述的四舍五入后的小数。", "solution": "### 问题验证\n\n**步骤 1：提取已知信息**\n\n问题为内脏利什曼病传播的房室模型提供了一套全面的定义、参数和方程。\n\n- **模型类型**：针对人、犬和白蛉媒介种群的常微分方程（ODE）系统。\n- **房室**：\n  - 人类：易感者 $S_H(t)$，感染者 $I_H(t)$，总数 $N_H = S_H(t) + I_H(t)$（恒定）。\n  - 犬类：易感者 $S_D(t)$，感染者 $I_D(t)$，总数 $N_D = S_D(t) + I_D(t)$（恒定）。\n  - 媒介：易感者 $S_V(t)$，感染者 $I_V(t)$，总数 $N_V = S_V(t) + I_V(t)$（恒定）。\n- **辅助变量**：人类累积发病率 $J_H(t)$。\n- **感染力（FOI）**：\n  $$ \\lambda_H(t) = a \\, \\phi_h \\, b_{VH} \\, \\frac{I_V(t)}{N_V} $$\n  $$ \\lambda_D(t) = a \\, \\phi_d \\, b_{VD} \\, \\frac{I_V(t)}{N_V} $$\n  $$ \\lambda_V(t) = a \\left( \\phi_d \\, b_{DV} \\, \\frac{I_D(t)}{N_D} + \\phi_h \\, b_{HV} \\, \\frac{I_H(t)}{N_H} \\right) $$\n- **ODE 系统**：\n  $$ \\frac{dS_H}{dt} = \\mu_H N_H - \\lambda_H S_H - \\mu_H S_H + \\gamma_H I_H, \\quad \\frac{dI_H}{dt} = \\lambda_H S_H - (\\gamma_H + \\mu_H) I_H $$\n  $$ \\frac{dS_D}{dt} = \\mu_D N_D - \\lambda_D S_D - \\mu_D S_D + \\gamma_D I_D, \\quad \\frac{dI_D}{dt} = \\lambda_D S_D - (\\gamma_D + \\mu_D) I_D $$\n  $$ \\frac{dS_V}{dt} = r_V(t) - \\lambda_V S_V - \\mu_V^{\\mathrm{eff}} S_V, \\quad \\frac{dI_V}{dt} = \\lambda_V S_V - \\mu_V^{\\mathrm{eff}} I_V $$\n  $$ \\frac{dJ_H}{dt} = \\lambda_H(t) \\, S_H(t) $$\n- **杀虫剂效应**：\n  - 有效媒介死亡率：$\\mu_V^{\\mathrm{eff}} = \\mu_V + a \\, \\phi_d \\, c_d \\, p_{\\mathrm{kill}}$。\n  - 媒介补充率：$r_V(t) = \\mu_V^{\\mathrm{eff}} \\, N_V$。\n- **种群与时间参数**：\n  - $T = 365$ 天。\n  - $N_H = 100000$, $N_D = 20000$, $N_V = 500000$。\n- **初始条件**：\n  - $I_H(0) = 50$, $S_H(0) = N_H - 50$。\n  - $I_D(0) = 500$, $S_D(0) = N_D - 500$。\n  - $I_V(0) = 1000$, $S_V(0) = N_V - 1000$。\n  - $J_H(0) = 0$。\n- **生物学参数**：\n  - $\\mu_H = \\frac{1}{70 \\times 365}$，$\\mu_D = \\frac{1}{10 \\times 365}$，$\\mu_V = \\frac{1}{14}$。\n  - $\\gamma_H = \\frac{1}{180}$，$\\gamma_D = \\frac{1}{120}$。\n  - $a = 0.3$。\n  - $b_{VH} = 0.25$, $b_{VD} = 0.30$, $b_{DV} = 0.40$, $b_{HV} = 0.05$。\n- **测试用例**：提供了六个 $(c_d, p_{\\mathrm{kill}}, \\phi_d)$ 三元组。\n- **任务**：为每个测试用例计算比率 $R = \\frac{J_H(T)_{\\text{干预}}}{J_H(T)_{\\text{基线}}}$，四舍五入到 $6$ 位小数。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n根据验证标准对问题进行审查：\n- **科学依据**：该模型是一个经典的易感-感染（SI 或 SIS）房室模型，这是数学流行病学中用于模拟媒介传播疾病的一个标准且被广泛接受的框架。所选参数被明确说明为“科学上合理的”，并且常微分方程正确地表示了所描述的种群动态和传播机制。该主题与医学寄生虫学直接相关。\n- **良态问题**：该问题被表述为一个一阶常微分方程组的初值问题（IVP）。定义导数的函数是连续且光滑的（状态变量的多项式），根据 Picard-Lindelöf 定理，这保证了给定初始条件下解的存在性和唯一性。\n- **目标明确**：问题用精确的数学方程、数值和清晰、量化的目标进行了规定。它没有歧义和主观性。\n- **完整性和一致性**：提供了所有必要的方程、参数、初始条件和评估标准。模型是自洽的；例如，人口统计学项（$\\mu_H N_H$, $-\\mu_H S_H$, $-\\mu_H I_H$）确保了总人口 $N_H$ 按预期保持恒定。同样的逻辑也适用于犬和媒介种群。\n- **可行性**：该问题可以使用科学计算库中可用的标准 ODE 积分方法进行数值求解。参数值在物理上和生物学上都是现实的。\n\n**步骤 3：结论与行动**\n\n该问题是 **有效的**。它在科学上是合理的，在数学上是良态的，规定完整且客观。可以计算出数值解。\n\n### 解题推导\n\n该问题需要求解一个包含七个耦合一阶常微分方程的系统，以模拟内脏利什曼病的传播动态。系统在任何时间 $t$ 的状态由向量 $y(t) = [S_H(t), I_H(t), S_D(t), I_D(t), S_V(t), I_V(t), J_H(t)]^T$ 描述。解决方案的核心是实现一个表示系统动态的函数 $\\frac{d\\vec{y}}{dt} = f(t, \\vec{y}, \\text{params})$，并使用数值求解器将其从 $t=0$ 积分到 $t=T$。\n\n对于每个测试用例 $(c_d, p_{\\mathrm{kill}}, \\phi_d)$，其过程如下：\n\n1.  **定义系统参数**：所有恒定参数，如种群大小 ($N_H, N_D, N_V$)、死亡率 ($\\mu_H, \\mu_D, \\mu_V$)、恢复率 ($\\gamma_H, \\gamma_D$)、叮咬率 ($a$) 和传播概率 ($b_{VH}, \\ldots$) 都被定义为固定的数值。时间范围是 $T=365$ 天。\n\n2.  **定义初始条件**：根据给定的初始感染个体数量构建初始状态向量 $\\vec{y}(0)$：\n    $$ \\vec{y}(0) = [S_H(0), I_H(0), S_D(0), I_D(0), S_V(0), I_V(0), J_H(0)]^T $$\n    $$ = [N_H - 50, 50, N_D - 500, 500, N_V - 1000, 1000, 0]^T $$\n\n3.  **实现 ODE 系统函数**：定义一个函数，例如 `ode_system`，用于计算导数向量 $\\frac{d\\vec{y}}{dt}$。该函数将时间 $t$、状态向量 $\\vec{y}$ 以及特定情景的参数 $(c_d, p_{\\mathrm{kill}}, \\phi_d)$ 作为输入。在此函数内部：\n    a. 从输入向量 $\\vec{y}$ 中提取状态变量 $S_H, I_H, \\ldots, J_H$。\n    b. 计算叮咬人类的比例 $\\phi_h = 1 - \\phi_d$。\n    c. 计算有效媒介死亡率 $\\mu_V^{\\mathrm{eff}} = \\mu_V + a \\, \\phi_d \\, c_d \\, p_{\\mathrm{kill}}$。\n    d. 媒介补充率为 $r_V = \\mu_V^{\\mathrm{eff}} N_V$。\n    e. 使用当前的感染个体比例计算感染力 $\\lambda_H, \\lambda_D, \\lambda_V$。\n    f. 根据所提供的方程计算七个导数 $\\frac{dS_H}{dt}, \\ldots, \\frac{dJ_H}{dt}$。\n    g. 函数返回这七个导数值的数组。\n\n4.  **数值积分**：对于每个测试用例，使用 `scipy.integrate.solve_ivp` 函数执行两次模拟，这是一个用于解决初值问题的稳健工具。\n    a. **基线模拟**：使用基线参数 $(c_d=0, p_{\\mathrm{kill}}=0, \\phi_d=\\text{test_case_}\\phi_d)$ 将 `ode_system` 从 $t=0$ 积分到 $T=365$。从解中提取最终时间的累积发病率状态变量值 $J_{H,\\text{base}}(T)$。这是解的状态向量数组第 7 个分量的最后一个元素。\n    b. **干预模拟**：使用干预参数 $(c_d=\\text{test_case_}c_d, p_{\\mathrm{kill}}=\\text{test_case_}p_{\\mathrm{kill}}, \\phi_d=\\text{test_case_}\\phi_d)$ 重复积分。这将得到干预后的最终累积发病率 $J_{H,\\text{int}}(T)$。对情况 1 进行特定检查，其中干预参数与基线相同，确保比率恰好为 $1$。\n\n5.  **计算并格式化比率**：所需比率 $R$ 的计算公式为：\n    $$ R = \\frac{J_{H,\\text{int}}(T) / N_H}{J_{H,\\text{base}}(T) / N_H} = \\frac{J_{H,\\text{int}}(T)}{J_{H,\\text{base}}(T)} $$\n    结果四舍五入到 $6$ 位小数。对所有六个测试用例重复此过程。\n\n6.  **最终输出**：将计算出的比率收集到一个列表中，并格式化为所需的字符串格式 `[r_1,r_2,...,r_6]`。\n\n这种结构化方法确保了复杂生物系统的动态被准确模拟，并且杀虫剂干预的影响被精确地量化。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the ODE model for leishmaniasis transmission to evaluate the impact of systemic insecticides.\n    \"\"\"\n\n    # 1. Define all fixed parameters as specified in the problem statement.\n    # Time horizon\n    T = 365.0  # days\n\n    # Population sizes\n    N_H = 100000.0  # humans\n    N_D = 20000.0   # dogs\n    N_V = 500000.0  # vectors\n\n    # Natural mortality rates (per day)\n    mu_H = 1.0 / (70.0 * 365.0)\n    mu_D = 1.0 / (10.0 * 365.0)\n    mu_V = 1.0 / 14.0\n\n    # Recovery rates (per day)\n    gamma_H = 1.0 / 180.0\n    gamma_D = 1.0 / 120.0\n\n    # Biting rate (bites per vector per day)\n    a = 0.3\n\n    # Transmission probabilities per bite\n    b_VH = 0.25  # vector-to-human\n    b_VD = 0.30  # vector-to-dog\n    b_DV = 0.40  # dog-to-vector\n    b_HV = 0.05  # human-to-vector\n\n    # 2. Define the ODE system function.\n    # This function uses parameters from the outer scope via closure.\n    def ode_system(t, y, c_d, p_kill, phi_d):\n        \"\"\"\n        Defines the system of ordinary differential equations.\n        y: state vector [S_H, I_H, S_D, I_D, S_V, I_V, J_H]\n        c_d, p_kill, phi_d: scenario-specific parameters\n        \"\"\"\n        S_H, I_H, S_D, I_D, S_V, I_V, J_H = y\n\n        # Enforce non-negativity to prevent numerical artifacts\n        S_H = max(0, S_H)\n        I_H = max(0, I_H)\n        S_D = max(0, S_D)\n        I_D = max(0, I_D)\n        S_V = max(0, S_V)\n        I_V = max(0, I_V)\n\n        # Derived parameters for the current scenario\n        phi_h = 1.0 - phi_d\n        mu_V_eff = mu_V + a * phi_d * c_d * p_kill\n        r_V = mu_V_eff * N_V\n\n        # Forces of Infection (FOI)\n        lambda_H = a * phi_h * b_VH * (I_V / N_V)\n        lambda_D = a * phi_d * b_VD * (I_V / N_V)\n        lambda_V = a * (phi_d * b_DV * (I_D / N_D) + phi_h * b_HV * (I_H / N_H))\n\n        # System of ODEs\n        dS_H_dt = mu_H * N_H - lambda_H * S_H - mu_H * S_H + gamma_H * I_H\n        dI_H_dt = lambda_H * S_H - (gamma_H + mu_H) * I_H\n\n        dS_D_dt = mu_D * N_D - lambda_D * S_D - mu_D * S_D + gamma_D * I_D\n        dI_D_dt = lambda_D * S_D - (gamma_D + mu_D) * I_D\n\n        dS_V_dt = r_V - lambda_V * S_V - mu_V_eff * S_V\n        dI_V_dt = lambda_V * S_V - mu_V_eff * I_V\n\n        dJ_H_dt = lambda_H * S_H\n\n        return [dS_H_dt, dI_H_dt, dS_D_dt, dI_D_dt, dS_V_dt, dI_V_dt, dJ_H_dt]\n\n    # 3. Define initial conditions for the state vector y.\n    I_H0 = 50.0\n    S_H0 = N_H - I_H0\n    I_D0 = 500.0\n    S_D0 = N_D - I_D0\n    I_V0 = 1000.0\n    S_V0 = N_V - I_V0\n    J_H0 = 0.0\n    \n    y0 = np.array([S_H0, I_H0, S_D0, I_D0, S_V0, I_V0, J_H0])\n    t_span = (0, T)\n\n    # 4. Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0, 0.6),  # Case 1\n        (0.5, 0.5, 0.6),  # Case 2\n        (0.8, 0.9, 0.6),  # Case 3\n        (1.0, 1.0, 0.6),  # Case 4\n        (0.8, 0.9, 0.2),  # Case 5\n        (0.8, 0.9, 0.95), # Case 6\n    ]\n\n    results = []\n    # 5. Iterate through each test case, run simulations, and compute the ratio.\n    for c_d_int, p_kill_int, phi_d_int in test_cases:\n        # Run baseline simulation (no insecticide)\n        args_base = (0.0, 0.0, phi_d_int)\n        sol_base = solve_ivp(ode_system, t_span, y0, method='RK45', args=args_base, rtol=1e-8, atol=1e-8)\n        J_H_base = sol_base.y[6][-1]\n\n        # Handle the special case where intervention is identical to baseline\n        if c_d_int == 0.0 and p_kill_int == 0.0:\n            J_H_int = J_H_base\n        else:\n            # Run intervention simulation\n            args_int = (c_d_int, p_kill_int, phi_d_int)\n            sol_int = solve_ivp(ode_system, t_span, y0, method='RK45', args=args_int, rtol=1e-8, atol=1e-8)\n            J_H_int = sol_int.y[6][-1]\n\n        # Calculate and store the ratio. Guard against division by zero.\n        if J_H_base > 0:\n            ratio = J_H_int / J_H_base\n        else:\n            # This should not occur, but for robustness:\n            # if J_H_base is 0, and J_H_int is also 0, the ratio is 1 (no change).\n            # if J_H_base is 0 and J_H_int is > 0, the ratio is undefined/infinite.\n            # Given the problem setup, J_H_base will be positive.\n            ratio = 1.0 if J_H_int == 0.0 else np.inf\n        \n        # Append the result rounded to 6 decimal places.\n        results.append(f\"{ratio:.6f}\")\n\n    # 6. Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "4810784"}]}