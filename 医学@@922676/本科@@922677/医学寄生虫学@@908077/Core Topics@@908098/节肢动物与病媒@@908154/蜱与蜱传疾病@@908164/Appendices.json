{"hands_on_practices": [{"introduction": "不同的蜱传病原体具有不同的传播动态，这直接影响预防策略的有效性。本练习将运用生存分析中的风险函数模型，来量化蜱叮咬后感染风险随时间的变化。通过比较一种传播迅速的病原体（立克次氏体）和一种需要“激活期”的病原体（无形体），本练习将揭示为何及时清除蜱至关重要，以及这种措施的效力如何因病原体而异[@problem_id:4688312]。", "problem": "观察到一只受感染的成年雌性蜱虫附着在人类宿主上，并在已知的附着持续时间 $T=30$ 小时后被移除。现要求您使用基于生存分析的事件时间（time-to-event）框架，比较由硬蜱科（ixodid）蜱虫传播的常见病原体的两种生物学上截然不同的传播起始情景。对于 Anaplasma phagocytophilum（人类粒细胞无形体病 (HGA) 的病原体），假设传播需要一个生物再激活期，因此瞬时传播风险率 $h_{A}(t)$ 在连续吸食达到阈值 $t_{0,A}=24$ 小时之前为零，之后风险率恒定在基线水平 $\\lambda=0.05$ h$^{-1}$。对于 Rickettsia rickettsii（落基山斑疹热的病原体），假设传播可能在吸食早期发生，因此瞬时传播风险率 $h_{R}(t)$ 从附着开始就恒定在相同的基线水平 $\\lambda=0.05$ h$^{-1}$，即没有正的阈值。\n\n假设以下建模原则：(i) 风险率代表在先前未发生传播的条件下，成功传播的瞬时风险；(ii) 除了在时间 $T$ 被移除外，没有其他竞争风险；(iii) 蜱虫在被移除前一直持续附着；(iv) 在蜱虫已感染且能够传播的条件下，风险率是如所指定的时间分段常数函数。\n\n仅使用这些假设以及生存分析中关于风险率、生存和累积风险率的基本定义，推导并计算在移除时间 $T$ 时每种病原体的传播概率，Anaplasma phagocytophilum 的概率记为 $p_{A}$，Rickettsia rickettsii 的概率记为 $p_{R}$。将您的最终答案以单行向量 $\\big(p_{A},\\,p_{R}\\big)$ 的形式报告，四舍五入到四位有效数字。将概率表示为纯小数，不带百分号。", "solution": "该问题要求在事件时间框架内，根据两种不同病原体 *Anaplasma phagocytophilum* 和 *Rickettsia rickettsii* 各自不同的传播风险率函数，计算它们的传播概率。\n\n生存分析的基本原理将瞬时风险率 $h(t)$ 与在给定时间 $T$ 之前事件（传播）发生的概率联系起来。\n\n令 $S(t)$ 为生存函数，表示到时间 $t$ 为止传播*尚未*发生的概率。令 $F(t) = 1 - S(t)$ 为累积分布函数，表示到时间 $t$ 为止传播*已经*发生的概率。我们为每种病原体所求的概率是 $p = F(T)$。\n\n生存函数通过累积风险率函数 $H(t)$ 与风险率 $h(t)$ 相关联：\n$$S(t) = \\exp(-H(t))$$\n其中累积风险率 $H(t)$ 是瞬时风险率在时间区间 $0$ 到 $t$ 上的积分：\n$$H(t) = \\int_0^t h(u) \\, du$$\n因此，到时间 $T$ 为止的传播概率由下式给出：\n$$p = 1 - S(T) = 1 - \\exp(-H(T)) = 1 - \\exp\\left(-\\int_0^T h(u) \\, du\\right)$$\n\n我们将此框架应用于每种病原体，使用给定的移除时间 $T = 30\\,\\textnormal{h}$ 和基线风险率 $\\lambda = 0.05\\,\\textnormal{h}^{-1}$。\n\n**1. Anaplasma phagocytophilum 的概率 ($p_A$)**\n\n对于 *Anaplasma phagocytophilum*，由于需要一个生物再激活期，其传播风险率 $h_A(t)$ 是一个分段函数。在达到附着阈值时间 $t_{0,A} = 24\\,\\textnormal{h}$ 之前，风险率为零。\n风险率函数定义如下：\n$$\nh_A(t) =\n\\begin{cases}\n0  & \\text{for } 0 \\le t  t_{0,A} \\\\\n\\lambda   \\text{for } t \\ge t_{0,A}\n\\end{cases}\n$$\n我们通过对 $h_A(t)$ 从 $0$ 到 $T=30\\,\\textnormal{h}$ 积分来计算累积风险率 $H_A(T)$。由于该函数是分段的，我们在阈值 $t_{0,A} = 24\\,\\textnormal{h}$ 处分割积分：\n$$H_A(T) = \\int_0^{T} h_A(u) \\, du = \\int_0^{t_{0,A}} h_A(u) \\, du + \\int_{t_{0,A}}^{T} h_A(u) \\, du$$\n代入函数定义以及积分极限 $T=30\\,\\textnormal{h}$ 和 $t_{0,A}=24\\,\\textnormal{h}$：\n$$H_A(30) = \\int_0^{24} 0 \\, du + \\int_{24}^{30} \\lambda \\, du$$\n第一个积分为 $0$。第二个积分的计算结果为：\n$$H_A(30) = \\lambda \\int_{24}^{30} du = \\lambda [u]_{24}^{30} = \\lambda (30 - 24) = 6\\lambda$$\n现在，我们代入 $\\lambda = 0.05\\,\\textnormal{h}^{-1}$ 的值：\n$$H_A(30) = 6 \\times 0.05 = 0.3$$\n到时间 $T=30\\,\\textnormal{h}$ 为止，Anaplasma 的传播概率 $p_A$ 为：\n$$p_A = 1 - \\exp(-H_A(30)) = 1 - \\exp(-0.3)$$\n数值计算此值为：\n$p_A \\approx 1 - 0.74081822 = 0.25918178$\n四舍五入到四位有效数字，我们得到 $p_A = 0.2592$。\n\n**2. Rickettsia rickettsii 的概率 ($p_R$)**\n\n对于 *Rickettsia rickettsii*，传播可能早期发生，因此其风险率函数 $h_R(t)$ 从附着开始 ($t \\ge 0$) 就为常数。\n风险率函数定义如下：\n$$h_R(t) = \\lambda \\quad \\text{for } t \\ge 0$$\n我们通过对 $h_R(t)$ 从 $0$ 到 $T=30\\,\\textnormal{h}$ 积分来计算累积风险率 $H_R(T)$：\n$$H_R(T) = \\int_0^{T} h_R(u) \\, du = \\int_0^{30} \\lambda \\, du$$\n$$H_R(30) = \\lambda \\int_0^{30} du = \\lambda [u]_{0}^{30} = \\lambda (30 - 0) = 30\\lambda$$\n代入 $\\lambda = 0.05\\,\\textnormal{h}^{-1}$ 的值：\n$$H_R(30) = 30 \\times 0.05 = 1.5$$\n到时间 $T=30\\,\\textnormal{h}$ 为止，Rickettsia 的传播概率 $p_R$ 为：\n$$p_R = 1 - \\exp(-H_R(30)) = 1 - \\exp(-1.5)$$\n数值计算此值为：\n$p_R \\approx 1 - 0.22313016 = 0.77686984$\n四舍五入到四位有效数字，我们得到 $p_R = 0.7769$。\n\n最终答案是包含计算出的概率 $(p_A, p_R)$ 的行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2592  0.7769\n\\end{pmatrix}\n}\n$$", "id": "4688312"}, {"introduction": "为了使蜱传病在自然界中持续存在，病原体需要在“储存宿主”中得以维持和传播。本练习介绍了一个关键的流行病学概念——储存宿主适宜性（reservoir competence），并指导你使用假设的野外研究数据进行计算。通过这项实践，你将学会如何量化不同动物物种在莱姆病传播循环中所扮演角色的重要性[@problem_id:4815471]。", "problem": "莱姆病病原体 *Borrelia burgdorferi* 的储存宿主物种，其定义为能够维持病原体并将其传播给取食的幼蜱。请使用以下基本依据，为两种同域分布的小型哺乳动物 *Peromyscus leucopus* 和 *Tamias striatus* 构建一个储存能力的估计量，并利用异种诊断法对其进行量化：\n\n- 一个宿主物种的储存能力，是指一只 *Ixodes scapularis* 幼蜱在取食随机遇到的该宿主物种个体后被感染的概率。根据标准的流行病学分解，该概率等于宿主感染率与在宿主已感染的条件下幼蜱获得感染的条件概率的乘积。\n- 在 *Ixodes scapularis* 和 *Borrelia burgdorferi* 中，经卵传播可以忽略不计，因此用于异种诊断的幼蜱在取食前实际上是未感染的。\n- 在独立试验下，二项概率的最大似然估计量是观察到的成功次数除以试验总数。\n\n野外研究和异种诊断数据：\n\n- *Peromyscus leucopus*：在捕获的 $40$ 个个体中，有 $30$ 个通过耳部活检培养和聚合酶链式反应（PCR）检测出 *Borrelia burgdorferi* 感染呈阳性。对这 $30$ 个受感染个体进行的异种诊断使用了实验室饲养的未感染的 *Ixodes scapularis* 幼蜱；综合所有受感染的宿主，共有 $600$ 只幼蜱吸饱血，并随后通过定量聚合酶链式反应（qPCR）进行检测，其中 $300$ 只对 *Borrelia burgdorferi* 呈阳性。\n- *Tamias striatus*：在捕获的 $30$ 个个体中，有 $9$ 个通过相同的诊断方案检测呈阳性。对这 $9$ 只受感染的花栗鼠进行的异种诊断总共涉及 $450$ 只幼蜱，其中 $45$ 只后来通过qPCR检测呈阳性。\n\n假设在每个宿主物种内部，给定宿主感染状态，幼蜱的感染结果是独立的，并且在取食受感染宿主时共享一个共同的单只蜱传播概率。仅使用上述原则，估计每个物种的储存能力，并计算 *Peromyscus leucopus* 与 *Tamias striatus* 的储存能力之比。请将您的最终答案表示为四舍五入到四位有效数字的小数。无需单位。", "solution": "目标是量化每个宿主物种的储存能力，即一只幼年 *Ixodes scapularis* 蜱在取食随机遇到的该物种成员后被感染的概率。从概率的基本分解出发，储存能力可以写成\n$$\nC = P(\\text{host infected}) \\times P(\\text{larval infection} \\mid \\text{host infected}).\n$$\n为了估计给定物种的 $P(\\text{host infected})$，我们使用抽样宿主中观察到的感染率。在具有独立宿主感染结果和恒定感染率的二项模型下，最大似然估计量（MLE）是\n$$\n\\widehat{P(\\text{host infected})} = \\frac{\\text{number infected}}{\\text{number sampled}}.\n$$\n为了估计给定物种的 $P(\\text{larval infection} \\mid \\text{host infected})$，我们对受感染的宿主进行异种诊断。假设在取食受感染宿主的幼蜱之间感染结果是独立的，并且具有一个共同的单只蜱传播概率，那么在取食受感染宿主的幼蜱中，受感染幼蜱的数量服从二项分布。单只蜱传播概率的MLE是观察到的感染比例：\n$$\n\\widehat{P(\\text{larval infection} \\mid \\text{host infected})} = \\frac{\\text{number of xenodiagnostic larvae that became infected}}{\\text{number of xenodiagnostic larvae that fed to repletion on infected hosts}}.\n$$\n因此，对于每个物种，储存能力的MLE是\n$$\n\\widehat{C} = \\left(\\frac{\\text{number infected hosts}}{\\text{number sampled hosts}}\\right)\\left(\\frac{\\text{infected larvae}}{\\text{total larvae on infected hosts}}\\right).\n$$\n\n将此应用于 *Peromyscus leucopus*：\n- 宿主感染率估计：\n$$\n\\widehat{P(\\text{host infected})}_{\\text{P. leucopus}} = \\frac{30}{40} = \\frac{3}{4} = 0.75.\n$$\n- 基于受感染宿主的异种诊断得出的单只蜱传播概率估计：\n$$\n\\widehat{P(\\text{larval infection} \\mid \\text{host infected})}_{\\text{P. leucopus}} = \\frac{300}{600} = \\frac{1}{2} = 0.50.\n$$\n- 储存能力估计：\n$$\n\\widehat{C}_{\\text{P. leucopus}} = 0.75 \\times 0.50 = 0.375.\n$$\n\n将此应用于 *Tamias striatus*：\n- 宿主感染率估计：\n$$\n\\widehat{P(\\text{host infected})}_{\\text{T. striatus}} = \\frac{9}{30} = 0.30.\n$$\n- 基于受感染宿主的异种诊断得出的单只蜱传播概率估计：\n$$\n\\widehat{P(\\text{larval infection} \\mid \\text{host infected})}_{\\text{T. striatus}} = \\frac{45}{450} = 0.10.\n$$\n- 储存能力估计：\n$$\n\\widehat{C}_{\\text{T. striatus}} = 0.30 \\times 0.10 = 0.030.\n$$\n\n计算所要求的 *Peromyscus leucopus* 与 *Tamias striatus* 的储存能力之比：\n$$\nR \\equiv \\frac{\\widehat{C}_{\\text{P. leucopus}}}{\\widehat{C}_{\\text{T. striatus}}} = \\frac{0.375}{0.030} = 12.5.\n$$\n\n问题要求将该比率四舍五入到四位有效数字。将 $12.5$ 写成四位有效数字得到 $12.50$。", "answer": "$$\\boxed{12.50}$$", "id": "4815471"}, {"introduction": "蜱传疾病的传播动力学最终会体现在临床结果上，而早期诊断和治疗对于改善预后至关重要。本练习模拟了一个公共卫生情景，旨在评估一项旨在促进落基山斑点热（RMSF）早期治疗的政策所带来的益处。通过这项计算，你将理解如何利用流行病学数据来量化卫生干预措施对降低病死率的实际效果[@problem_id:4815494]。", "problem": "一个地区性医疗系统正在评估对落基山斑点热 (RMSF) 提早使用 doxycycline 的益处，该地区是硬蜱科 (Ixodidae) (硬蜱) 的地方病流行区。假设落基山斑点热 (RMSF) 由细菌 Rickettsia rickettsii 引起，主要通过硬蜱 (硬蜱科 Ixodidae) 传播，并且提早开始抗生素治疗能降低临床病例的死亡概率。\n\n考虑一个 RMSF 病例队列，其中相对于症状出现，开始使用 doxycycline 的日期 (记为 $d \\in \\{1,2,\\dots,10\\}$) 遵循以下观测分布：\n- $P(d=1)=0.10$，$P(d=2)=0.12$，$P(d=3)=0.14$，$P(d=4)=0.12$，$P(d=5)=0.07$，\n- $P(d=6)=0.09$，$P(d=7)=0.08$，\n- $P(d=8)=0.10$，$P(d=9)=0.10$，$P(d=10)=0.08$，\n满足 $\\sum_{d=1}^{10} P(d)=1$。\n\n已发表的基于开始治疗日期的条件病死率 (病例中的死亡概率) 被建模为一个阶跃函数 $c(d)$，反映了经过充分检验的临床观察结果：如果 $d \\leq 5$，则 $c(d)=0.01$；如果 $d \\in \\{6,7\\}$，则 $c(d)=0.07$；如果 $d \\geq 8$，则 $c(d)=0.20$。\n\n在一项反事实政策干预下，每位患者的治疗时间被精确缩短了 $2$ 天，且不允许在第 $1$ 天之前开始治疗，新的治疗开始日期变为 $d'=\\max(1, d-2)$。假设条件病死率仅通过相同的函数 $c(\\cdot)$ 依赖于治疗开始日期。\n\n仅使用病死率作为条件概率的定义以及混合队列期望的全概率定律，计算由这一提早治疗政策带来的总死亡概率 (总病死率) 的预期绝对降低值，该值定义为基线预期死亡率减去反事实预期死亡率。将最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "此问题经评估为有效，因为它具有科学依据、问题明确且客观。它提供了一套完整且一致的数据和定义，允许在流行病学背景下，基于已确立的概率论原理得出一个唯一的、可验证的解。\n\n目标是计算总病死率的预期绝对降低值。这是基线情景下的预期死亡概率与反事实政策干预下的预期死亡概率之差。\n\n设 $d$ 为随机变量，表示相对于症状出现，开始使用 doxycycline 的日期，其概率质量函数为给定的 $P(d)$。基线分布是为 $d \\in \\{1, 2, \\dots, 10\\}$ 给出的。\n设 $c(d)$ 为在第 $d$ 天开始治疗的条件病死率。函数 $c(d)$ 定义为一个阶跃函数：\n$$\nc(d) =\n\\begin{cases}\n0.01  \\text{if } d \\leq 5 \\\\\n0.07  \\text{if } d \\in \\{6, 7\\} \\\\\n0.20  \\text{if } d \\geq 8\n\\end{cases}\n$$\n\n首先，我们计算基线预期死亡率，记为 $M_{base}$。根据全概率定律，总死亡概率是在治疗开始日期的分布上对条件病死率的期望值。\n$$M_{base} = E[c(d)] = \\sum_{d=1}^{10} c(d) P(d)$$\n我们可以根据 $c(d)$ 的值对各项进行分组：\n$$M_{base} = 0.01 \\sum_{d=1}^{5} P(d) + 0.07 \\sum_{d=6}^{7} P(d) + 0.20 \\sum_{d=8}^{10} P(d)$$\n使用给定的概率：\n在第 $5$ 天或之前开始治疗的概率是：\n$$\\sum_{d=1}^{5} P(d) = P(1) + P(2) + P(3) + P(4) + P(5) = 0.10 + 0.12 + 0.14 + 0.12 + 0.07 = 0.55$$\n在第 $6$ 天或第 $7$ 天开始治疗的概率是：\n$$\\sum_{d=6}^{7} P(d) = P(6) + P(7) = 0.09 + 0.08 = 0.17$$\n在第 $8$ 天或之后开始治疗的概率是：\n$$\\sum_{d=8}^{10} P(d) = P(8) + P(9) + P(10) = 0.10 + 0.10 + 0.08 = 0.28$$\n将这些总和代入 $M_{base}$ 的表达式中：\n$$M_{base} = (0.01)(0.55) + (0.07)(0.17) + (0.20)(0.28)$$\n$$M_{base} = 0.0055 + 0.0119 + 0.0560 = 0.0734$$\n\n接下来，我们分析反事实情景。该政策将每位患者的治疗时间精确缩短了 $2$ 天，新的治疗开始日期 $d'$ 由 $d' = \\max(1, d-2)$ 给出。我们需要确定 $d'$ 的新概率分布，记为 $P'(d')$。\n从 $d$ 到 $d'$ 的映射如下：\n- $d \\in \\{1, 2, 3\\} \\rightarrow d' = 1$\n- $d = 4 \\rightarrow d' = 2$\n- $d = 5 \\rightarrow d' = 3$\n- $d = 6 \\rightarrow d' = 4$\n- $d = 7 \\rightarrow d' = 5$\n- $d = 8 \\rightarrow d' = 6$\n- $d = 9 \\rightarrow d' = 7$\n- $d = 10 \\rightarrow d' = 8$\n每个原始日期 $d$ 的概率质量被转移到新的日期 $d'$。我们通过对所有映射到给定 $d'$ 的 $d$ 值的原始概率求和来找到新的概率 $P'(d')$：\n$P'(d'=1) = P(d=1) + P(d=2) + P(d=3) = 0.10 + 0.12 + 0.14 = 0.36$\n$P'(d'=2) = P(d=4) = 0.12$\n$P'(d'=3) = P(d=5) = 0.07$\n$P'(d'=4) = P(d=6) = 0.09$\n$P'(d'=5) = P(d=7) = 0.08$\n$P'(d'=6) = P(d=8) = 0.10$\n$P'(d'=7) = P(d=9) = 0.10$\n$P'(d'=8) = P(d=10) = 0.08$\n对于 $d'  8$，$P'(d')=0$。\n\n现在，我们使用新的分布 $P'(d')$ 和相同的病死率函数 $c(\\cdot)$ 来计算反事实预期死亡率 $M_{counter}$。\n$$M_{counter} = E[c(d')] = \\sum_{d'=1}^{8} c(d') P'(d')$$\n根据 $c(d')$ 的值对各项进行分组：\n$$M_{counter} = 0.01 \\sum_{d'=1}^{5} P'(d') + 0.07 \\sum_{d'=6}^{7} P'(d') + 0.20 \\sum_{d'=8}^{8} P'(d')$$\n在新政策下，于第 $5$ 天或之前开始治疗的概率是：\n$$\\sum_{d'=1}^{5} P'(d') = 0.36 + 0.12 + 0.07 + 0.09 + 0.08 = 0.72$$\n在第 $6$ 天或第 $7$ 天开始治疗的概率是：\n$$\\sum_{d'=6}^{7} P'(d') = 0.10 + 0.10 = 0.20$$\n在第 $8$ 天或之后开始治疗的概率是：\n$$\\sum_{d'=8}^{8} P'(d') = 0.08$$\n将这些概率代入 $M_{counter}$ 的表达式中：\n$$M_{counter} = (0.01)(0.72) + (0.07)(0.20) + (0.20)(0.08)$$\n$$M_{counter} = 0.0072 + 0.0140 + 0.0160 = 0.0372$$\n\n最后，总死亡概率的预期绝对降低值是基线预期死亡率与反事实预期死亡率之差：\n$$\\Delta M = M_{base} - M_{counter} = 0.0734 - 0.0372 = 0.0362$$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。计算出的值 $0.0362$ 有三位有效数字。为了用四位有效数字表示，我们将其写为 $0.03620$。", "answer": "$$\\boxed{0.03620}$$", "id": "4815494"}]}