{"hands_on_practices": [{"introduction": "诊断试验的价值并不仅仅取决于其固有的准确性（即灵敏度和特异度）。本练习将向您展示如何计算一项试验的阳性预测值（$PPV$），它揭示了一个阳性结果真正为阳性的现实世界概率。通过这个关于疟疾快速诊断试验的案例[@problem_id:4795372]，您将理解疾病的患病率如何深刻影响一项试验的实际应用性能。", "problem": "一个地区的疟疾控制项目正在评估是否要为无并发症的发热性门诊患者采用一种新的快速诊断测试（RDT）。在一个具有代表性的门诊人群中，在当前的传播季节，经质量保证的显微镜检查，一名发热患者确实患有显性恶性疟原虫血症（patent Plasmodium falciparum parasitemia）的基线概率估计为 $0.12$。在一次与显微镜检查对比的独立评估中，该 RDT 的灵敏度（真阳性率）为 $0.92$，其特异性（真阴性率）为 $0.95$。请仅使用灵敏度、特异性和患病率的核心定义，并结合贝叶斯定理，推导出阳性预测值（PPV）的表达式，并计算其在此情境下的值。PPV 定义为在 RDT 结果为阳性的情况下，患者确实患有疟疾的概率。请将您的最终答案四舍五入至四位有效数字，并将其表示为一个无单位的小数（而非百分比）。", "solution": "基于诊断测试的灵敏度、特异性以及该病症在人群中的患病率来确定其阳性预测值（PPV）的问题，是贝叶斯定理在医学统计学中的一个标准应用。所陈述的问题具有科学依据，提法明确，且所有必需的参数均已提供。\n\n首先，我们必须根据问题陈述中给出的信息，正式定义事件和概率。\n设 $D$ 代表发热患者患有显性*恶性疟原虫*血症（即确实患有疟疾）的事件。\n设 $D^c$ 代表患者未患疟疾的互补事件。\n设 $T^+$ 代表新的快速诊断测试（RDT）结果为阳性的事件。\n设 $T^-$ 代表 RDT 结果为阴性的事件。\n\n根据问题陈述，我们得到以下概率：\n疾病的基线概率，或称患病率，给定为 $P(D) = 0.12$。\n患者未患病的概率是患病率的补集：\n$$P(D^c) = 1 - P(D) = 1 - 0.12 = 0.88$$\n\nRDT 的灵敏度是真阳性率，定义为在患者患病的情况下，测试结果为阳性的概率：\n$$P(T^+ | D) = 0.92$$\n\nRDT 的特异性是真阴性率，定义为在患者未患病的情况下，测试结果为阴性的概率：\n$$P(T^- | D^c) = 0.95$$\n\n问题要求计算阳性预测值（PPV），其定义为在 RDT 结果为阳性的情况下，患者确实患有疟疾的概率。用概率术语来说，这是条件概率 $P(D | T^+)$。\n\n为推导 $P(D | T^+)$ 的表达式，我们使用贝叶斯定理，其表述为：\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n分子包含直接给出的项：灵敏度 $P(T^+ | D)$ 和患病率 $P(D)$。\n分母 $P(T^+)$ 是获得阳性测试结果的总概率。这可能通过两种互斥的方式发生：患者患有该疾病且测试为阳性（真阳性），或者患者未患该疾病但测试为阳性（假阳性）。我们可以使用全概率公式来表示 $P(T^+)$：\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\n使用条件概率的定义，$P(A \\cap B) = P(A | B) P(B)$，我们可以将其改写为：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n第一项，$P(T^+ | D) P(D)$，是人群中真阳性的概率。第二项需要 $P(T^+ | D^c)$，即假阳性率。假阳性率是特异性（真阴性率）的补集：\n$$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.95 = 0.05$$\n\n现在，我们可以将 $P(T^+)$ 的完整表达式代回贝叶斯定理公式。这就得出了 PPV 的完整推导表达式：\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)}$$\n该表达式将 PPV 与灵敏度 ($P(T^+ | D)$)、患病率 ($P(D)$) 和特异性 (通过其补集，$P(T^+ | D^c) = 1-P(T^-|D^c)$) 这些核心参数联系起来。\n\n推导出表达式后，我们可以通过代入给定数据来计算其数值：\n$$PPV = \\frac{(0.92)(0.12)}{(0.92)(0.12) + (0.05)(0.88)}$$\n首先，我们计算各个单项：\n分子（真阳性的概率）：\n$$(0.92)(0.12) = 0.1104$$\n分母中的第二项（假阳性的概率）：\n$$(0.05)(0.88) = 0.044$$\n现在，将这些值代回方程中：\n$$PPV = \\frac{0.1104}{0.1104 + 0.044} = \\frac{0.1104}{0.1544}$$\n进行最后的除法运算：\n$$PPV \\approx 0.7150259067...$$\n问题要求答案四舍五入至四位有效数字。前四位有效数字是 $7$、$1$、$5$ 和 $0$。第五位数字是 $2$，小于 $5$，因此我们向下舍入（即，我们不改变第四位数字）。\n因此，计算出的 PPV 值为 $0.7150$。", "answer": "$$\\boxed{0.7150}$$", "id": "4795372"}, {"introduction": "在对寄生虫病进行大规模诊断和治疗后，我们如何衡量干预措施的成功程度？本练习介绍了一个关键指标——粪便虫卵计数减少率（$FECR$），它用于评估群体药物投服项目对土壤传播蠕虫等寄生虫的有效性。您将学习如何通过整合来自不同人群亚组的数据[@problem_id:4795425]，来计算社区层面的治疗效果。", "problem": "一个公共卫生团队在一个土源性蠕虫流行的农村社区评估单剂量苯并咪唑类药物的大规模给药效果。粪便虫卵计数 (FEC) 以每克粪便的虫卵数 (EPG) 进行量化。在第 $0$ 天（治疗前）和第 $14$ 天（治疗后）对两个亚组进行了抽样：儿童组和成人组。在两个时间点对相同的个体进行了测量。治疗前，儿童组的算术平均 EPG 为 $1200$，亚组样本量 $n_{c}=30$；成人组的算术平均 EPG 为 $400$，亚组样本量 $n_{a}=20$。治疗后，儿童组的算术平均 EPG 为 $180$，成人组为 $80$。\n\n仅使用以下基本原则：\n- 在某个时间点，社区层面的算术平均 EPG 等于各亚组算术平均值按亚组样本量加权的平均值。\n- 粪便虫卵减少率 (FECR) 定义为社区层面算术平均 EPG 从治疗前到治疗后的比例减少量。\n\n计算社区层面的 FECR，结果表示为纯小数（无单位），并四舍五入至四位有效数字。然后，用一句话解释该值对于社区层面治疗效果的意义。数值答案以小数形式表示，不要使用百分号。", "solution": "问题陈述经评估有效。它在科学上基于医学寄生虫学和流行病学的原理，特别是使用粪便虫卵减少率（FECR）作为驱虫药效的度量标准。该问题提法恰当，为得出唯一解提供了所有必要的数据和定义。语言客观，数据合理。\n\n目标是计算社区层面的粪便虫卵减少率（FECR）。让我们定义给定的变量：\n- 儿童组的亚组样本量：$n_{c} = 30$\n- 成人组的亚组样本量：$n_{a} = 20$\n- 儿童组治疗前的算术平均 EPG：$\\bar{x}_{c, \\text{pre}} = 1200$\n- 成人组治疗前的算术平均 EPG：$\\bar{x}_{a, \\text{pre}} = 400$\n- 儿童组治疗后的算术平均 EPG：$\\bar{x}_{c, \\text{post}} = 180$\n- 成人组治疗后的算术平均 EPG：$\\bar{x}_{a, \\text{post}} = 80$\n\n社区的总样本量为 $N = n_{c} + n_{a}$。\n$$N = 30 + 20 = 50$$\n\n首先，我们计算治疗前时间点的社区层面算术平均 EPG，即 $\\bar{X}_{\\text{pre}}$。根据问题的基本原则，这是各亚组平均值的加权平均值。\n$$ \\bar{X}_{\\text{pre}} = \\frac{n_{c} \\bar{x}_{c, \\text{pre}} + n_{a} \\bar{x}_{a, \\text{pre}}}{n_{c} + n_{a}} $$\n代入给定值：\n$$ \\bar{X}_{\\text{pre}} = \\frac{(30)(1200) + (20)(400)}{30 + 20} = \\frac{36000 + 8000}{50} = \\frac{44000}{50} = 880 $$\n\n接下来，我们使用相同的加权平均原则计算治疗后时间点的社区层面算术平均 EPG，即 $\\bar{X}_{\\text{post}}$。\n$$ \\bar{X}_{\\text{post}} = \\frac{n_{c} \\bar{x}_{c, \\text{post}} + n_{a} \\bar{x}_{a, \\text{post}}}{n_{c} + n_{a}} $$\n代入给定值：\n$$ \\bar{X}_{\\text{post}} = \\frac{(30)(180) + (20)(80)}{30 + 20} = \\frac{5400 + 1600}{50} = \\frac{7000}{50} = 140 $$\n\n现在，我们计算 FECR，它被定义为社区层面算术平均 EPG 从治疗前到治疗后的比例减少量。\n$$ \\text{FECR} = \\frac{\\bar{X}_{\\text{pre}} - \\bar{X}_{\\text{post}}}{\\bar{X}_{\\text{pre}}} $$\n代入计算出的社区层面平均值：\n$$ \\text{FECR} = \\frac{880 - 140}{880} = \\frac{740}{880} = \\frac{74}{88} = \\frac{37}{44} $$\n\n为了获得小数值，我们进行除法运算：\n$$ \\text{FECR} = \\frac{37}{44} \\approx 0.84090909... $$\n问题要求将此值四舍五入至四位有效数字。前四位有效数字是 $8$、$4$、$0$ 和 $9$。第五位有效数字是 $0$，所以我们不进位。\n$$ \\text{FECR} \\approx 0.8409 $$\n\n按要求，对此值的解释如下：社区层面的 FECR 为 $0.8409$ 意味着大规模给药与抽样社区的平均寄生虫卵负荷减少 $84.09\\%$ 相关。", "answer": "$$\n\\boxed{0.8409}\n$$", "id": "4795425"}, {"introduction": "现实世界中的临床诊断常常充满挑战，不同的检测可能会得出相互矛盾的结果。这项高级练习建立在贝叶斯推理原则之上，展示了如何系统地整合多项证据——在本例中，是针对一例疑似弓形虫感染的病例。通过学习计算更新后的疾病后验概率[@problem_id:4795466]，您将能够为复杂的临床决策提供定量的依据。", "problem": "弓形虫（Toxoplasma gondii）是一种原生动物寄生虫，家猫是其最终宿主，而人类是中间宿主。在临床寄生虫学中，“急性弓形虫病”感染指速殖子正在复制，是需要立即做出处理决策的关注状态。考虑一位来自急性弓形虫病患病率为 $0.01$ 的人群的怀孕患者。对该患者进行了三项检测：免疫球蛋白M（IgM）酶免疫测定、免疫球蛋白G（IgG）亲和力测试，以及针对弓形虫DNA的聚合酶链式反应（PCR）。\n\n检测性能特征如下，以“急性弓形虫病”为目标状况，“非急性”则包括既往（已痊愈）感染或无感染：\n- IgM检测对急性弓形虫病的灵敏度为 $0.85$，其对非急性状态的特异度为 $0.95$。\n- IgG亲和力分类将低亲和力视为近期感染的信号；低亲和力对急性弓形虫病的灵敏度为 $0.90$，对非急性状态的特异度为 $0.98$。在该患者中，观察到的亲和力为高。\n- PCR对急性弓形虫病的灵敏度为 $0.60$，其对非急性状态的特异度为 $0.99$。\n\n该患者的观察结果是：IgM阳性，IgG亲和力高，PCR阴性。假设在给定真实疾病状态的情况下，各检测结果条件独立，应用贝叶斯诊断框架来调和这些相互矛盾的结果，并计算在所有三个检测结果给定的情况下，该患者患有急性弓形虫病的后验概率。请用小数表示最终答案，并四舍五入至四位有效数字。", "solution": "在尝试解决问题之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n设 $A$ 为患者患有急性弓形虫病的事件。\n设 $A^c$ 为患者处于“非急性”状态的事件。\n急性弓形虫病的先验概率（患病率）为 $P(A) = 0.01$。\n因此，非急性状态的先验概率为 $P(A^c) = 1 - P(A) = 1 - 0.01 = 0.99$。\n\n设 $M$ 为免疫球蛋白M（IgM）检测结果为阳性的事件。\nIgM检测的灵敏度为 $P(M | A) = 0.85$。\nIgM检测的特异度为 $P(M^c | A^c) = 0.95$。\n\n设 $V$ 为免疫球蛋白G（IgG）亲和力结果为低（这是近期感染的信号）的事件。\n低亲和力的灵敏度为 $P(V | A) = 0.90$。\n对非急性状态的特异度是在没有急性感染的情况下亲和力为高（$V^c$）的概率，即 $P(V^c | A^c) = 0.98$。\n\n设 $C$ 为聚合酶链式反应（PCR）结果为阳性的事件。\nPCR的灵敏度为 $P(C | A) = 0.60$。\nPCR的特异度为 $P(C^c | A^c) = 0.99$。\n\n该患者的观察结果是：\n1. IgM阳性，对应事件 $M$。\n2. IgG亲和力高，对应事件 $V^c$。\n3. PCR阴性，对应事件 $C^c$。\n\n设 $E$ 表示所有观察到的证据的集合：$E = M \\cap V^c \\cap C^c$。\n问题假设在给定真实疾病状态的情况下，各检测结果条件独立。\n\n目标是计算后验概率 $P(A | E) = P(A | M \\cap V^c \\cap C^c)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，使用了医学诊断学的标准概念（灵敏度、特异度、患病率）和有效的生物医学背景（弓形虫检测）。所需的数学框架，即贝叶斯推断，适用于根据证据更新信念。问题陈述清晰，提供了所有必要的数值和条件独立性的关键假设。术语精确客观。没有内部矛盾；“相互矛盾”的检测结果是一个现实场景，而这种类型的概率调和正是为此设计的。该问题是完整且可解的。\n\n### 步骤 3：结论与行动\n问题有效。将提供解决方案。\n\n解决方案需要应用贝叶斯定理来计算在给定三个检测结果的情况下，患者患有急性弓形虫病的后验概率。\n贝叶斯定理陈述如下：\n$$ P(A | E) = \\frac{P(E | A) P(A)}{P(E)} $$\n分母 $P(E)$ 是观察到该证据的总概率，可以使用全概率公式展开：\n$$ P(E) = P(E | A) P(A) + P(E | A^c) P(A^c) $$\n因此，方程的完整形式是：\n$$ P(A | E) = \\frac{P(E | A) P(A)}{P(E | A) P(A) + P(E | A^c) P(A^c)} $$\n\n首先，我们必须使用条件独立性的假设来计算证据的似然 $P(E | A)$ 和 $P(E | A^c)$。\n\n如果患者患有急性弓形虫病（$A$），观察到证据 $E = M \\cap V^c \\cap C^c$ 的似然是：\n$$ P(E | A) = P(M | A) \\times P(V^c | A) \\times P(C^c | A) $$\n我们已知 $P(M | A) = 0.85$。\n在急性感染的情况下，亲和力为高（$V^c$）的概率是 $1$ 减去低亲和力的灵敏度：\n$P(V^c | A) = 1 - P(V | A) = 1 - 0.90 = 0.10$。\n在急性感染的情况下，PCR为阴性（$C^c$）的概率是 $1$ 减去PCR的灵敏度（即假阴性率）：\n$P(C^c | A) = 1 - P(C | A) = 1 - 0.60 = 0.40$。\n因此：\n$$ P(E | A) = 0.85 \\times 0.10 \\times 0.40 = 0.034 $$\n\n接下来，如果患者处于非急性状态（$A^c$），观察到证据 $E$ 的似然是：\n$$ P(E | A^c) = P(M | A^c) \\times P(V^c | A^c) \\times P(C^c | A^c) $$\n在非急性状态下，IgM为阳性（$M$）的概率是 $1$ 减去IgM的特异度（即假阳性率）：\n$P(M | A^c) = 1 - P(M^c | A^c) = 1 - 0.95 = 0.05$。\n在非急性状态下，亲和力为高（$V^c$）的概率是亲和力测试的特异度，已知为 $P(V^c | A^c) = 0.98$。\n在非急性状态下，PCR为阴性（$C^c$）的概率是PCR的特异度，已知为 $P(C^c | A^c) = 0.99$。\n因此：\n$$ P(E | A^c) = 0.05 \\times 0.98 \\times 0.99 = 0.04851 $$\n\n现在，我们可以将这些值代回贝叶斯定理。\n分子是：\n$$ P(E | A) P(A) = 0.034 \\times 0.01 = 0.00034 $$\n分母是：\n$$ P(E) = P(E | A) P(A) + P(E | A^c) P(A^c) $$\n$$ P(E) = (0.034 \\times 0.01) + (0.04851 \\times 0.99) $$\n$$ P(E) = 0.00034 + 0.0480249 = 0.0483649 $$\n最后，后验概率是：\n$$ P(A | E) = \\frac{0.00034}{0.0483649} \\approx 0.007029509... $$\n问题要求答案四舍五入至四位有效数字。\n$$ P(A | E) \\approx 0.007030 $$\n这表明，尽管IgM检测结果为阳性，但高亲和力的IgG结果和阴性的PCR结果相结合，显著地将急性感染的概率从初始患病率的 $1\\%$ 降低到约 $0.7\\%$。", "answer": "$$ \\boxed{0.007030} $$", "id": "4795466"}]}