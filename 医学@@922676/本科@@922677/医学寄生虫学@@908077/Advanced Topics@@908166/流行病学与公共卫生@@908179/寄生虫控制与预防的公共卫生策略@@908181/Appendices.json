{"hands_on_practices": [{"introduction": "在设计任何寄生虫病控制规划之前，我们必须拥有可靠的工具来衡量疾病的流行情况。本练习探讨了诊断测试的一个关键性能指标——阳性预测值（PPV），它揭示了一个阳性测试结果在特定人群中真正意味着什么。通过从基本原理推导并计算PPV ([@problem_id:4810543])，您将理解为何测试的内在准确性（敏感性 $Se$ 与特异性 $Sp$）与其在现实世界中的应用价值（取决于患病率 $\\pi$）是两个不同的概念。", "problem": "一个地区的公共卫生项目正在评估一种筛查策略，以指导在一个流行社区中针对土源性蠕虫进行大规模药物投喂（MDA）。提议使用快速诊断测试（RDT）进行即时筛查。设疾病状态由一个二元随机变量表示，其中存在感染为事件 $D$，测试结果为阳性为事件 $+$。\n\n适用以下标准定义：\n- 灵敏度 $Se$ 是指在真正感染的情况下测试结果为阳性的概率，即 $Se = \\mathbb{P}(+ \\mid D)$。\n- 特异性 $Sp$ 是指在没有感染的情况下测试结果为阴性的概率，即 $Sp = \\mathbb{P}(- \\mid \\neg D)$。\n- 患病率 $\\pi$ 是指目标人群中的感染概率，即 $\\pi = \\mathbb{P}(D)$。\n- 阳性预测值 (PPV) 为 $\\mathbb{P}(D \\mid +)$。\n\n仅从这些定义和全概率定律出发，推导阳性预测值（PPV）关于 $Se$、$Sp$ 和 $\\pi$ 的封闭形式表达式。然后，对于灵敏度 $Se = 0.85$、特异性 $Sp = 0.95$、目标社区患病率 $\\pi = 0.20$ 的RDT，计算PPV。将最终的PPV表示为小数，四舍五入到 $4$ 位有效数字。不要使用百分号。", "solution": "问题陈述需经过验证。\n\n### 第1步：提取已知条件\n- 感染事件（疾病存在）：$D$\n- 测试阳性事件：$+$\n- 灵敏度：$Se = \\mathbb{P}(+ \\mid D)$\n- 特异性：$Sp = \\mathbb{P}(- \\mid \\neg D)$\n- 患病率：$\\pi = \\mathbb{P}(D)$\n- 阳性预测值 (PPV)：$\\mathbb{P}(D \\mid +)$\n- 推导要求：从第一性原理（定义和全概率定律）推导PPV关于 $Se$、$Sp$ 和 $\\pi$ 的封闭形式表达式。\n- 数值：$Se = 0.85$，$Sp = 0.95$，$\\pi = 0.20$。\n- 最终答案要求：计算PPV并表示为四舍五入到 $4$ 位有效数字的小数。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是贝叶斯概率论在诊断测试评估中的一个标准应用，这是流行病学和公共卫生的基石。\n- **科学依据**：该问题基于概率论的基本原理（特别是贝叶斯定理）。所提供的灵敏度、特异性、患病率和PPV的定义在医学统计学中是标准且正确的。筛查土源性蠕虫的背景是一个有效的公共卫生情景。\n- **适定性**：该问题要求进行推导和后续计算，存在唯一且有意义的解。所提供的数据是充分且一致的。\n- **客观性**：该问题用精确的数学语言陈述，没有任何主观性或模糊性。\n\n### 第3步：结论和行动\n该问题是有效的。它科学合理、适定、客观且完整。我将继续进行解答。\n\n目标是推导阳性预测值（PPV）的表达式，它被定义为在测试结果为阳性的条件下患有该疾病的条件概率，即 $\\mathbb{P}(D \\mid +)$。\n\n根据条件概率的定义，我们有：\n$$\n\\text{PPV} = \\mathbb{P}(D \\mid +) = \\frac{\\mathbb{P}(D \\cap +)}{\\mathbb{P}(+)}\n$$\n其中 $\\mathbb{P}(D \\cap +)$ 是患病且测试结果为阳性的联合概率。\n\n我们将分别分析分子和分母。\n\n对于分子 $\\mathbb{P}(D \\cap +)$，我们可以使用概率的乘法法则，该法则关联了联合概率和条件概率：\n$$\n\\mathbb{P}(D \\cap +) = \\mathbb{P}(+ \\mid D) \\mathbb{P}(D)\n$$\n根据所给定义，$\\mathbb{P}(+ \\mid D) = Se$（灵敏度）和 $\\mathbb{P}(D) = \\pi$（患病率）。将这些代入分子的表达式中，得到：\n$$\n\\mathbb{P}(D \\cap +) = Se \\cdot \\pi\n$$\n\n对于分母 $\\mathbb{P}(+)$，即测试结果为阳性的边际概率，我们应用全概率定律。样本空间可以被患病事件 $D$ 和不患病事件 $\\neg D$ 所划分。因此，测试结果为阳性的概率可以写为在这两种互斥情况下测试结果为阳性的概率之和：\n$$\n\\mathbb{P}(+) = \\mathbb{P}(+ \\cap D) + \\mathbb{P}(+ \\cap \\neg D)\n$$\n对每一项再次使用乘法法则：\n$$\n\\mathbb{P}(+) = \\mathbb{P}(+ \\mid D)\\mathbb{P}(D) + \\mathbb{P}(+ \\mid \\neg D)\\mathbb{P}(\\neg D)\n$$\n从问题陈述中我们有：\n- $\\mathbb{P}(+ \\mid D) = Se$\n- $\\mathbb{P}(D) = \\pi$\n\n我们需要用给定的量来表示余下的项 $\\mathbb{P}(+ \\mid \\neg D)$ 和 $\\mathbb{P}(\\neg D)$。\n不患病的概率 $\\mathbb{P}(\\neg D)$ 是患病率的补集：\n$$\n\\mathbb{P}(\\neg D) = 1 - \\mathbb{P}(D) = 1 - \\pi\n$$\n项 $\\mathbb{P}(+ \\mid \\neg D)$ 是指在没有疾病的情况下测试结果为阳性的概率。这就是假阳性率。我们已知特异性 $Sp = \\mathbb{P}(- \\mid \\neg D)$，它是在没有疾病的情况下测试结果为阴性的概率。由于测试结果不是阳性就是阴性，对于没有疾病的亚群，阳性测试和阴性测试的概率之和必须为 $1$：\n$$\n\\mathbb{P}(+ \\mid \\neg D) + \\mathbb{P}(- \\mid \\neg D) = 1\n$$\n因此，假阳性率为：\n$$\n\\mathbb{P}(+ \\mid \\neg D) = 1 - \\mathbb{P}(- \\mid \\neg D) = 1 - Sp\n$$\n将所有这些组成部分代回到 $\\mathbb{P}(+)$ 的表达式中：\n$$\n\\mathbb{P}(+) = (Se \\cdot \\pi) + (1 - Sp)(1 - \\pi)\n$$\n\n现在，我们将分子和分母的表达式结合起来，形成PPV的最终表达式：\n$$\n\\text{PPV} = \\frac{Se \\cdot \\pi}{(Se \\cdot \\pi) + (1 - Sp)(1 - \\pi)}\n$$\n这就是所要求的阳性预测值的封闭形式表达式。这个公式是贝叶斯定理的直接应用。\n\n接下来，我们使用所提供的数据计算PPV的数值：\n- 灵敏度 $Se = 0.85$\n- 特异性 $Sp = 0.95$\n- 患病率 $\\pi = 0.20$\n\n将这些值代入推导出的公式中：\n$$\n\\text{PPV} = \\frac{0.85 \\cdot 0.20}{(0.85 \\cdot 0.20) + (1 - 0.95)(1 - 0.20)}\n$$\n首先，计算分子：\n$$\n\\text{分子} = 0.85 \\times 0.20 = 0.17\n$$\n接下来，计算分母：\n$$\n\\text{分母} = (0.85 \\times 0.20) + (0.05 \\times 0.80)\n$$\n$$\n\\text{分母} = 0.17 + 0.04 = 0.21\n$$\n现在，计算PPV的最终值：\n$$\n\\text{PPV} = \\frac{0.17}{0.21}\n$$\n$$\n\\text{PPV} = \\frac{17}{21} \\approx 0.8095238095...\n$$\n题目要求答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $8, 0, 9, 5$。第五位数字是 $2$，小于 $5$，因此我们向下舍入。\n$$\n\\text{PPV} \\approx 0.8095\n$$\n这一结果表明，对于在这个社区中使用此RDT测试呈阳性的个体，他们真正感染蠕虫的概率为 $80.95\\%$。", "answer": "$$\\boxed{0.8095}$$", "id": "4810543"}, {"introduction": "一旦我们能够评估疾病负担，下一步就是设计有效的干预措施。本练习介绍了流行病学中的一个核心概念——基本再生数 ($R_0$)，并展示了如何利用它来设定控制目标。通过亲手计算阻断传播所需达到的最低药物覆盖率 ([@problem_id:4810580])，您将学会如何将一个关键的流行病学参数直接转化为具体的公共卫生行动计划。", "problem": "一个地区正在经历土源性蠕虫的地方性传播。基本再生数，定义为在现有接触结构下，单个典型感染在完全易感人群中产生的预期二代病例数，估计为 $R_{0}=2.5$。卫生当局计划开展大规模药物分发 (MDA) 运动，使用一种单剂量驱虫药。在目标期间内，服用该药可将个体的继续传播贡献降低，效力为 $e=0.9$。假设同质混合、无获得性免疫，并且治疗通过按比例降低被治疗个体的每次接触传播潜能来起作用，而不改变接触结构。\n\n使用有效再生数 $R_{e}$ 的定义，即在干预措施存在时产生的平均二代病例数，并通过对已治疗和未治疗亚群进行适当的聚合，确定使 $R_{e}  1$ 所需的最低覆盖率 $c$（以小数表示）。将您的最终答案四舍五入到四位有效数字。", "solution": "问题要求计算大规模药物分发 (MDA) 运动所需的最低覆盖率 $c$，以将有效再生数 $R_{e}$ 降至 $1$ 以下。问题给出了基本再生数 $R_{0}$（即在完全易感人群中，单个感染产生的预期二代病例数）和驱虫药的效力 $e$（该效力降低了个体对传播的贡献）。\n\n首先，我们必须形式化在干预下基本再生数 $R_{0}$ 和有效再生数 $R_{e}$ 之间的关系。人群被分为两个亚群：一部分是已治疗的，比例为 $c$；另一部分是未治疗的，比例为 $(1-c)$。问题陈述中假设了同质混合，这意味着一个感染者接触人群中任何其他个体的可能性是相同的，无论其治疗状态如何。\n\n有效再生数 $R_{e}$ 是在这个混合人群中，一个典型感染者产生的平均二代病例数。一个典型的感染者有 $c$ 的概率属于已治疗组，有 $(1-c)$ 的概率属于未治疗组。\n\n来自未治疗组的感染者平均会引起 $R_{0}$ 个二代感染。\n来自已治疗组的感染者，其对继续传播的贡献因药物效力 $e$ 而降低。因此，他们的传播潜能降低了效力 $e$，他们贡献的量是一个未治疗个体的 $(1-e)$。因此，来自已治疗组的感染者平均会引起 $R_{0}(1-e)$ 个二代感染。\n\n$R_{e}$ 是这两类感染者贡献的加权平均值，权重是它们在人群中的各自比例：\n$$R_{e} = (1-c) \\cdot R_{0} + c \\cdot \\left[R_{0}(1-e)\\right]$$\n这个表达式代表了对已治疗和未治疗亚群的聚合，正如问题陈述中所指出的。我们可以通过提取公因子 $R_{0}$ 来简化这个表达式：\n$$R_{e} = R_{0} \\left[ (1-c) + c(1-e) \\right]$$\n$$R_{e} = R_{0} [1 - c + c - ce]$$\n$$R_{e} = R_{0}(1 - ce)$$\n这是一个标准公式，用于描述一项干预措施，该措施以效力 $e$ 降低了比例为 $c$ 的人群的传染性。\n\n公共卫生当局的目标是阻止地方性传播，这要求将有效再生数降至 $1$ 以下。条件是：\n$$R_{e}  1$$\n将我们得到的 $R_{e}$ 表达式代入这个不等式，得到：\n$$R_{0}(1 - ce)  1$$\n\n现在我们求解这个关于覆盖率 $c$ 的不等式。由于 $R_{0}=2.5 > 0$，我们可以用 $R_{0}$ 除以不等式两边，而不用改变不等号的方向：\n$$1 - ce  \\frac{1}{R_{0}}$$\n整理各项以分离出 $c$：\n$$1 - \\frac{1}{R_{0}}  ce$$\n由于效力 $e=0.9 > 0$，我们可以用 $e$ 除以不等式两边，而不用改变不等号的方向：\n$$c > \\frac{1 - \\frac{1}{R_{0}}}{e}$$\n这可以重写为：\n$$c > \\frac{\\frac{R_{0}-1}{R_{0}}}{e} = \\frac{R_{0}-1}{eR_{0}}$$\n这个不等式给出了确保 $R_{e}  1$ 所需的覆盖率 $c$ 的条件。所需的最低覆盖率是该条件的边界值。我们将这个最低或临界覆盖率表示为 $c_{min}$。\n$$c_{min} = \\frac{R_{0}-1}{eR_{0}}$$\n\n现在，我们将给定的数值代入此表达式：$R_{0}=2.5$ 和 $e=0.9$。\n$$c_{min} = \\frac{2.5 - 1}{0.9 \\times 2.5}$$\n$$c_{min} = \\frac{1.5}{2.25}$$\n为了简化分数，我们可以将其表示为整数之比：\n$$c_{min} = \\frac{1.50}{2.25} = \\frac{150}{225}$$\n分子分母同时除以它们的最大公约数 $75$：\n$$c_{min} = \\frac{2 \\times 75}{3 \\times 75} = \\frac{2}{3}$$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$c_{min} = \\frac{2}{3} \\approx 0.666666...$$\n四舍五入到四位有效数字，得到：\n$$c_{min} \\approx 0.6667$$\n这意味着需要大约 $66.67\\%$ 的最低覆盖率才能将有效再生数降至 $1$ 以下并中断传播。", "answer": "$$\\boxed{0.6667}$$", "id": "4810580"}, {"introduction": "公共卫生干预不仅要有效，还必须可持续。本练习通过一个群体遗传学模型，量化了药物压力下抗药性是如何快速出现的。计算单代抗性等位基因频率的变化 ([@problem_id:4810561])，将帮助您理解为何依赖单一药物的策略充满风险，并突显了诸如药物轮换或联合疗法等长期策略的重要性。", "problem": "一项国家控制计划正在考虑对一种无性单倍体血期寄生虫进行大规模药物投喂（MDA）。该寄生虫在单个基因座上有两个等位基因：一个抗药性等位基因 $\\mathrm{R}$ 和一个易感性等位基因 $\\mathrm{S}$。在MDA期间的持续药物压力下，$\\mathrm{R}$ 的相对适应度模型为 $w_{\\mathrm{R}}=1+s$，$\\mathrm{S}$ 的相对适应度模型为 $w_{\\mathrm{S}}=1$，其中 $s$ 是选择系数，代表了在已治疗和未治疗宿主中抗药性的净优势。假设在所考虑的时间范围内，世代是离散、不重叠的，存在随机混合，选择是恒定的，并且突变、迁移和遗传漂变可以忽略不计。\n\n在MDA活动开始时，抗药性等位基因的频率为 $p_0=0.01$。所考虑方案下的选择系数为 $s=0.10$。\n\n仅使用相对适应度、平均适应度的基本定义以及按比例加权的频率更新方法（即，通过相对适应度加权并按平均适应度重新归一化来更新下一代等位基因频率），从 $p_0$ 和 $s$ 推导出下一代抗药性等位基因频率 $p_1$，然后计算在给定参数下一个世代后抗药性等位基因频率的预期绝对变化量 $\\Delta p = p_1 - p_0$。将你计算出的 $\\Delta p$ 的最终数值答案四舍五入到四位有效数字，并以无单位小数表示（不要使用百分号）。用文字简要解释这一变化幅度对药物轮换、联合治疗和药物避难所（refugia）等项目设计选择的意义，但请注意，只有 $\\Delta p$ 的数值部分会被评分。", "solution": "用户提供了一个应用于医学寄生虫学的群体遗传学领域的问题，并要求在验证问题陈述有效性的前提下提供解答。\n\n### 第一步：提取已知条件\n- **生物体**：无性单倍体血期寄生虫。\n- **遗传学**：单个基因座，两个等位基因，抗药性（$\\mathrm{R}$）和易感性（$\\mathrm{S}$）。\n- **相对适应度（在MDA下）**：抗药性等位基因为 $w_{\\mathrm{R}}=1+s$；易感性等位基因为 $w_{\\mathrm{S}}=1$。\n- **模型假设**：离散、不重叠的世代；随机混合；恒定选择；可忽略的突变、迁移和遗传漂变。\n- **初始条件**：抗药性等位基因的初始频率为 $p_0=0.01$。\n- **参数**：选择系数为 $s=0.10$。\n- **任务1**：使用基本定义，从 $p_0$ 和 $s$ 推导出下一代抗药性等位基因频率 $p_1$。\n- **任务2**：计算一代后抗药性等位基因频率的绝对变化量 $\\Delta p = p_1 - p_0$。\n- **任务3**：将 $\\Delta p$ 的最终数值答案四舍五入到四位有效数字。\n- **任务4**：简要解释这一变化对公共卫生项目设计的意义。\n\n### 第二步：使用提取的已知条件进行验证\n根据既定标准对问题进行评估。\n\n- **科学依据**：该问题基于群体遗传学的基础模型——Wright-Fisher模型，特别是单倍体种群中的选择情况。这是一个标准且科学上合理的模型，广泛应用于进化生物学及其应用，包括抗微生物药物耐药性的研究。参数和背景都是现实的。\n- **问题适定**：该问题提供了计算等位基因频率变化 $\\Delta p$ 的唯一值所需的所有信息（初始等位基因频率、选择系数和明确定义的选择模型）。任务是明确的。\n- **客观性**：问题使用精确的量化语言和既定的科学术语陈述。它不含主观或基于观点的断言。\n\n该问题没有表现出任何列出的缺陷。它科学合理、信息完备、客观，并提出了一个植根于既定理论的、非平凡且可解的问题。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 推导与计算\n问题要求使用基本原理推导下一代的等位基因频率。设 $p_t$ 为第 $t$ 代抗药性等位基因 $\\mathrm{R}$ 的频率，$q_t$ 为易感性等位基因 $\\mathrm{S}$ 的频率。由于只有两个等位基因，所以 $p_t + q_t = 1$。\n\n相对适应度值给定为 $w_{\\mathrm{R}} = 1+s$ 和 $w_{\\mathrm{S}} = 1$。\n\n种群的平均适应度 $\\bar{w}$ 是等位基因适应度的加权平均值，权重为其频率：\n$$\n\\bar{w} = p_t w_{\\mathrm{R}} + q_t w_{\\mathrm{S}}\n$$\n代入 $q_t = 1 - p_t$ 和给定的适应度值：\n$$\n\\bar{w} = p_t (1+s) + (1-p_t)(1) = p_t + s p_t + 1 - p_t = 1 + s p_t\n$$\n下一代中一个等位基因的频率是它对该代基因库的比例贡献。计算方法是取当前代等位基因的频率，乘以其相对适应度，然后通过种群的平均适应度进行归一化。对于抗药性等位基因 $\\mathrm{R}$，其在下一代的频率 $p_{t+1}$ 为：\n$$\np_{t+1} = \\frac{p_t w_{\\mathrm{R}}}{\\bar{w}}\n$$\n代入 $w_{\\mathrm{R}}$ 和 $\\bar{w}$ 的表达式：\n$$\np_{t+1} = \\frac{p_t(1+s)}{1+s p_t}\n$$\n这是该模型下抗药性等位基因频率的通用递推关系。\n\n现在，我们将其应用于从 $t=0$ 到 $t=1$ 的单代步骤。频率 $p_1$ 从 $p_0$ 推导如下：\n$$\np_1 = \\frac{p_0(1+s)}{1+s p_0}\n$$\n问题要求计算等位基因频率的绝对变化量 $\\Delta p$，定义为 $\\Delta p = p_1 - p_0$。\n$$\n\\Delta p = \\frac{p_0(1+s)}{1+s p_0} - p_0\n$$\n为了简化，我们通分：\n$$\n\\Delta p = \\frac{p_0(1+s) - p_0(1+s p_0)}{1+s p_0}\n$$\n从分子中提取因子 $p_0$：\n$$\n\\Delta p = \\frac{p_0[(1+s) - (1+s p_0)]}{1+s p_0}\n$$\n简化分子中括号内的表达式：\n$$\n\\Delta p = \\frac{p_0[1+s - 1 - s p_0]}{1+s p_0} = \\frac{p_0(s - s p_0)}{1+s p_0}\n$$\n从括号项中提取因子 $s$：\n$$\n\\Delta p = \\frac{s p_0 (1-p_0)}{1+s p_0}\n$$\n这是一代内等位基因频率变化的通用表达式。现在，我们代入给定的数值：$p_0 = 0.01$ 和 $s = 0.10$。\n$$\n\\Delta p = \\frac{(0.10)(0.01)(1-0.01)}{1+(0.10)(0.01)}\n$$\n$$\n\\Delta p = \\frac{(0.10)(0.01)(0.99)}{1+0.001}\n$$\n$$\n\\Delta p = \\frac{0.00099}{1.001}\n$$\n进行除法运算：\n$$\n\\Delta p \\approx 0.000989010989...\n$$\n将此结果四舍五入到四位有效数字得到 $0.0009890$。\n\n问题还要求对这一结果的意义进行简要解释。$\\Delta p$ 约为 $0.0009890$ 意味着在单个寄生虫世代内，抗药性等位基因的频率增加了近0.1个百分点。对于许多寄生虫来说，世代时间很短，因此这表明在特定的药物压力下，抗药性正在被快速选择。这种快速增长对控制项目的设计具有重要意义：\n1. **药物轮换**：对当前药物的抗药性迅速上升，意味着其有效使用寿命有限。为了管理抗药性的传播，可能有必要在一定时期后轮换使用不同类别的药物。\n2. **联合治疗**：单个抗药性等位基因的强大选择优势凸显了单一疗法的脆弱性。同时使用两种或多种作用机制不同的药物（联合治疗），会使寄生虫进化出抗药性的难度呈指数级增加，因为它需要获得多个独立的抗药性突变。这一结果为从一开始就部署联合治疗提供了量化论据。\n3. **药物避难所（Refugia）**：选择的速度强调了药物避难所的重要性——即一部分未暴露于药物的寄生虫亚群。这些寄生虫主要是药物易感性的，它们通过与抗药性寄生虫竞争并稀释其比例，从而减缓了总寄生虫种群中抗药性频率的整体上升。计算出的变化率有助于量化在没有此类避难所的情况下抗药性传播的速度，从而为制定关于MDA覆盖范围（例如，靶向治疗与全民治疗）的政策提供信息，以平衡治疗效益与抗药性管理。", "answer": "$$\n\\boxed{0.0009890}\n$$", "id": "4810561"}]}