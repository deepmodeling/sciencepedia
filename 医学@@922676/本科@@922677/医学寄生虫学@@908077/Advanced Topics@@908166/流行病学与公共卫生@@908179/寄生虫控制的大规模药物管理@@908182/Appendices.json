{"hands_on_practices": [{"introduction": "为了阻止寄生虫的传播，我们需要将其繁殖能力降低到每个现有病例产生的新感染数少于一个。本练习介绍了大规模药物干预（MDA）背后的核心数学原理，将寄生虫的自然传播率（以基本再生数 $R_0$ 表示）与必要的治疗覆盖率（$c$）和药物疗效（$e$）联系起来。通过解决这个问题，你将学会如何计算实现疾病控制所需的最低干预力度，这是规划任何公共卫生项目的基础。[@problem_id:4799535]", "problem": "一个针对直接传播蠕虫病的控制项目正在计划进行一轮大规模药物分发（MDA）。基本再生数 $R_0$ 指在其他个体完全易感的人群中，由单个感染者产生的预期继发感染人数。有效再生数 $R_e$ 指干预措施改变了人群易感性和/或传染性后的预期继发感染人数。在该项目中，每个个体以概率（覆盖率）$c$ 独立接受治疗，如果接受治疗，其对下一代传播的贡献将因药物疗效 $e$ 而减少（即，一个接受治疗的个体贡献其未经治疗传播潜力的 $1-e$ 倍）。假设人群均匀混合，个体间治疗相互独立，且所考虑的时间尺度足够短，以至于无需对超出这一代的影响（如药物效应和人口更替）进行建模。\n\n从这些定义和假设出发，推导确保 $R_e  1$ 所需的关于 $c$ 的条件，并计算当 $R_0 = 2.5$ 和 $e = 0.8$ 时所需的最低覆盖率 $c$。将 $c$ 表示为小数。如果您的结果是精确值，请精确报告；否则，将您的数值答案四舍五入到四位有效数字。\n\n此外，简要评论（定性评论，而非额外的数值答案）在相同框架下，所需的 $c$ 对 $e$ 的错误估计有多敏感。", "solution": "在尝试求解之前，将首先验证问题陈述的科学合理性、自我一致性和清晰度。\n\n### 步骤1：提取给定条件\n问题提供了以下定义、参数和假设：\n-   **定义**：\n    -   基本再生数，$R_0$：在完全易感的人群中，由单个感染者产生的预期继发感染人数。\n    -   有效再生数，$R_e$：干预措施实施后的预期继发感染人数。\n-   **参数**：\n    -   $c$：覆盖率，表示个体接受治疗的概率。\n    -   $e$：药物疗效，表示若个体接受治疗，其对传播的贡献减少的分数。一个接受治疗的个体贡献其未经治疗潜力的 $1-e$ 倍。\n-   **假设**：\n    -   人群均匀混合。\n    -   个体间治疗相互独立。\n    -   时间尺度很短，因此只考虑单代传播，人口统计学效应可忽略不计。\n-   **目标**：\n    1.  推导确保 $R_e  1$ 所需的关于 $c$ 的条件。\n    2.  在 $R_0 = 2.5$ 和 $e = 0.8$ 的特定情况下，计算最低覆盖率 $c$。\n    3.  对所需覆盖率 $c$ 对药物疗效 $e$ 错误估计的敏感性进行定性评论。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估：\n-   **科学依据**：该问题基于传染病流行病学的基本概念，特别是使用大规模药物分发控制大型寄生虫感染的理论。$R_0$、$R_e$、覆盖率（$c$）和疗效（$e$）的定义在该领域是标准化的。建模方法是公认的、简化的干预影响表示方法。\n-   **适定性**：问题陈述清晰，提供了所有必要信息。假设（例如，均匀混合）被明确列出，用于定义一个可解的数学模型。给定信息中没有矛盾。目标是具体的，并能导出一个唯一的解。\n-   **客观性**：语言精确、定量，没有主观或含糊的术语。\n\n该问题不违反任何无效标准。在数学流行病学领域，这是一个科学合理、适定且客观的问题。\n\n### 步骤3：结论与行动\n问题有效。现在将推导完整的解。\n\n### 覆盖率条件的推导\n基本再生数 $R_0$ 表示在一个完全易感的人群中，单个感染者在其整个传染期内产生的平均新感染人数。经过一轮大规模药物分发（MDA）后，人群被分为两组：接受治疗者和未接受治疗者。\n\n-   未接受治疗的人群比例为 $1-c$。这些个体以与 $R_0$ 成比例的基线水平对传播做出贡献。\n-   接受治疗的人群比例为 $c$。对于这些个体，药物疗效 $e$ 使其对后续传播的贡献减少。因此，一个接受治疗的个体贡献的传播量是未经治疗个体的 $(1-e)$ 倍。\n\n有效再生数 $R_e$ 是新的平均继发感染人数，可以表示为接受治疗和未接受治疗亚群贡献的加权平均值。人群的总体繁殖能力因覆盖率和疗效的综合作用而降低。\n\n来自未治疗人群部分对 $R_e$ 的贡献是 $(1-c)R_0$。\n来自治疗人群部分对 $R_e$ 的贡献是 $c(1-e)R_0$。\n\n将这些贡献相加，得到 $R_e$ 的表达式：\n$$R_e = (1-c)R_0 + c(1-e)R_0$$\n我们可以提出因子 $R_0$：\n$$R_e = R_0 \\left[ (1-c) + c(1-e) \\right]$$\n简化括号内的表达式：\n$$R_e = R_0 [1 - c + c - ce]$$\n$$R_e = R_0 (1-ce)$$\n这个方程将有效再生数与基本再生数以及干预参数联系起来。\n\n控制项目中断传播的条件是有效再生数必须小于1，即 $R_e  1$。\n代入我们推导出的 $R_e$ 表达式：\n$$R_0 (1-ce)  1$$\n为了找到覆盖率 $c$ 的条件，我们解这个不等式。由于对于地方性流行病有 $R_0 > 1$，我们可以除以 $R_0$ 而不改变不等号的方向。\n$$1 - ce  \\frac{1}{R_0}$$\n整理各项以求解 $c$：\n$$-ce  \\frac{1}{R_0} - 1$$\n乘以 $-1$ 会使不等号反向：\n$$ce > 1 - \\frac{1}{R_0}$$\n最后，由于疗效 $e$ 是一个介于0和1之间的类概率度量（对于有效的药物，$e>0$），我们可以除以 $e$：\n$$c > \\frac{1}{e} \\left( 1 - \\frac{1}{R_0} \\right)$$\n这就是将有效再生数降低到1以下所需的覆盖率 $c$ 的通用条件。\n\n### 最低覆盖率的计算\n最低覆盖率，我们称之为 $c_{\\text{min}}$，是使 $R_e = 1$ 时的 $c$ 值。这代表了项目要取得成功必须超过的阈值。\n$$c_{\\text{min}} = \\frac{1}{e} \\left( 1 - \\frac{1}{R_0} \\right)$$\n问题给出了具体值 $R_0 = 2.5$ 和 $e = 0.8$。我们将这些值代入方程：\n$$c_{\\text{min}} = \\frac{1}{0.8} \\left( 1 - \\frac{1}{2.5} \\right)$$\n首先，我们计算括号内的项：\n$$\\frac{1}{2.5} = \\frac{1}{5/2} = \\frac{2}{5} = 0.4$$\n$$1 - 0.4 = 0.6$$\n现在，将此结果代回 $c_{\\text{min}}$ 的方程：\n$$c_{\\text{min}} = \\frac{1}{0.8} (0.6)$$\n$1/0.8$ 这一项是：\n$$\\frac{1}{0.8} = \\frac{1}{4/5} = \\frac{5}{4} = 1.25$$\n最后，我们计算乘积：\n$$c_{\\text{min}} = 1.25 \\times 0.6 = \\frac{5}{4} \\times \\frac{3}{5} = \\frac{3}{4} = 0.75$$\n所需的最低覆盖率为 $0.75$。该结果是所要求的精确小数。\n\n### 关于敏感性的定性评论\n所需的最低覆盖率 $c$ 由公式 $c = \\frac{1}{e} \\left( 1 - \\frac{1}{R_0} \\right)$ 给出。对于固定的 $R_0 > 1$，$(1 - 1/R_0)$ 项是一个正常数。因此，覆盖率和疗效之间的关系是反比关系：$c \\propto 1/e$。\n\n这种反比关系意味着所需的覆盖率对药物疗效的值很敏感。具体来说，随着疗效 $e$ 的降低，敏感性变得更加尖锐。我们可以通过考察 $c$ 对 $e$ 的导数来看这一点：\n$$\\frac{dc}{de} = -\\frac{1}{e^2} \\left( 1 - \\frac{1}{R_0} \\right)$$\n这个导数的绝对值 $|\\frac{dc}{de}|$ 代表疗效微小变化所需覆盖率的绝对变化，它与 $1/e^2$ 成正比。$1/e^2$ 项表明敏感性是高度非线性的。当 $e$ 接近其能够实现控制的理论最小值（即 $e_{crit} = 1 - 1/R_0$）时，所需的覆盖率 $c$ 接近 1，并且对 $e$ 的任何进一步下降的敏感性变得极高。因此，高估一个较低的药物疗效可能导致对所需覆盖率的严重低估，很可能导致控制项目无法中断传播。相反，当药物疗效很高（接近1）时，对 $e$ 的小幅错误估计对计算出的所需覆盖率的影响要小得多。", "answer": "$$\\boxed{0.75}$$", "id": "4799535"}, {"introduction": "在现实世界中，并非每个人都同样受到寄生虫的影响；例如，年龄扮演着重要角色。本练习超越了简单的同质化模型，探讨了针对特定人群（如学龄儿童）的干预措施如何影响整个社区的寄生虫负荷。你将使用微积分来模拟这些基于年龄的差异，并量化靶向MDA策略的有效性，从而对项目的实际影响做出更现实的评估。[@problem_id:4799544]", "problem": "一个土源性蠕虫病流行的社区实施了仅针对学龄儿童的大规模药物管理 (MDA)。设年龄用 $a$ 表示（单位：年），并假设每人按年龄划分的平均产卵强度由 $I(a) = \\alpha\\,a\\,\\exp(-\\beta a)$ 建模，这反映了童年时期接触感染增加，之后获得性部分免疫力又使强度降低。人口的年龄分布由 $N(a) = N_0\\,\\exp(-\\gamma a)$ 建模，其中 $a \\in [0,70]$，这代表了较年长年龄组人口密度合理下降的情况。假设治疗仅针对年龄在 $a \\in [5,14]$ 范围内的人群，治疗覆盖率为 $c$（目标年龄段接受治疗的个体比例），虫卵减少效力为 $e$（治疗后个体虫卵产出立即减少的平均比例）。\n\n此背景下的基本定义：\n- 治疗前社区总虫卵产出是各年龄段贡献的积分，即 $T = \\int_{0}^{70} I(a)\\,N(a)\\,da$。\n- 干预措施立即清除的总虫卵数是 $R = e\\,c\\,\\int_{5}^{14} I(a)\\,N(a)\\,da$。\n\n给定参数值 $\\beta = 0.25\\,\\text{year}^{-1}$，$\\gamma = 0.03\\,\\text{year}^{-1}$，$c = 0.85$ 和 $e = 0.90$，计算仅治疗 $5$–$14$ 岁人群所清除的虫卵量占治疗前总虫卵产出的比例，定义为 $P = R/T$。将最终答案表示为不带单位的小数，并四舍五入到四位有效数字。您可以将 $\\alpha$ 和 $N_0$ 视为反映规模但不影响比例的正数常量。", "solution": "用户提供了一个来自数理流行病学领域的问题，要求计算通过一项有针对性的大规模药物管理（MDA）项目从社区中清除的寄生虫卵的比例。该问题具有科学依据，提法明确，并提供了所有必需的参数。因此，该问题是有效的，可以推导出解决方案。\n\n需要计算的量是干预措施清除的虫卵量占治疗前总虫卵产出的比例，定义为 $P = R/T$。给定条件如下：\n- 治疗前社区总虫卵产出：$T = \\int_{0}^{70} I(a)\\,N(a)\\,da$\n- 干预措施清除的总虫卵数：$R = e\\,c\\,\\int_{5}^{14} I(a)\\,N(a)\\,da$\n- 按年龄划分的平均产卵强度：$I(a) = \\alpha\\,a\\,\\exp(-\\beta a)$\n- 人口的年龄分布：$N(a) = N_0\\,\\exp(-\\gamma a)$\n- 参数：$\\beta = 0.25$，$\\gamma = 0.03$，$c = 0.85$，$e = 0.90$。\n- 总人口的年龄范围是 $a \\in [0, 70]$ 岁。\n- 治疗的年龄范围是 $a \\in [5, 14]$ 岁。\n\n首先，我们通过将强度函数和人口分布函数相乘来确定被积函数：\n$$\nI(a)N(a) = (\\alpha a \\exp(-\\beta a)) (N_0 \\exp(-\\gamma a)) = \\alpha N_0 a \\exp(-(\\beta+\\gamma)a)\n$$\n比例 $P$ 是 $R$ 与 $T$ 的比值：\n$$\nP = \\frac{R}{T} = \\frac{e\\,c\\,\\int_{5}^{14} I(a)\\,N(a)\\,da}{\\int_{0}^{70} I(a)\\,N(a)\\,da} = \\frac{e\\,c\\,\\int_{5}^{14} \\alpha N_0 a \\exp(-(\\beta+\\gamma)a)\\,da}{\\int_{0}^{70} \\alpha N_0 a \\exp(-(\\beta+\\gamma)a)\\,da}\n$$\n比例常数 $\\alpha$ 和 $N_0$ 是正数，同时出现在分子和分母中，因此可以消掉。我们定义一个复合参数 $k = \\beta + \\gamma$。$P$ 的表达式简化为：\n$$\nP = e\\,c\\,\\frac{\\int_{5}^{14} a \\exp(-ka)\\,da}{\\int_{0}^{70} a \\exp(-ka)\\,da}\n$$\n为了计算定积分，我们首先使用分部积分法求出形如 $\\int x \\exp(-kx) dx$ 的不定积分，其中 $\\int u\\,dv = uv - \\int v\\,du$。\n设 $u = a$，$dv = \\exp(-ka) da$。则 $du = da$，$v = -\\frac{1}{k}\\exp(-ka)$。\n$$\n\\int a \\exp(-ka)\\,da = a \\left(-\\frac{1}{k}\\exp(-ka)\\right) - \\int \\left(-\\frac{1}{k}\\exp(-ka)\\right)\\,da\n$$\n$$\n= -\\frac{a}{k}\\exp(-ka) + \\frac{1}{k}\\int \\exp(-ka)\\,da\n$$\n$$\n= -\\frac{a}{k}\\exp(-ka) - \\frac{1}{k^2}\\exp(-ka) + C = -\\frac{1}{k^2}(ka+1)\\exp(-ka) + C\n$$\n现在，我们可以计算定积分了。设 $J(a_1, a_2, k) = \\int_{a_1}^{a_2} a \\exp(-ka)\\,da$。\n$$\nJ(a_1, a_2, k) = \\left[-\\frac{1}{k^2}(ka+1)\\exp(-ka)\\right]_{a_1}^{a_2} = \\frac{1}{k^2} \\left[ (ka_1+1)\\exp(-ka_1) - (ka_2+1)\\exp(-ka_2) \\right]\n$$\n$P$ 的分子中的积分，我们称之为 $R_{int}$，其积分区间是 $[5, 14]$：\n$$\nR_{int} = J(5, 14, k) = \\frac{1}{k^2} \\left[ (5k+1)\\exp(-5k) - (14k+1)\\exp(-14k) \\right]\n$$\n$P$ 的分母中的积分，我们称之为 $T_{int}$，其积分区间是 $[0, 70]$：\n$$\nT_{int} = J(0, 70, k) = \\frac{1}{k^2} \\left[ (k \\cdot 0+1)\\exp(-k \\cdot 0) - (70k+1)\\exp(-70k) \\right] = \\frac{1}{k^2} \\left[ 1 - (70k+1)\\exp(-70k) \\right]\n$$\n将这些代回到 $P$ 的表达式中：\n$$\nP = e\\,c\\,\\frac{R_{int}}{T_{int}} = e\\,c\\,\\frac{\\frac{1}{k^2} \\left[ (5k+1)\\exp(-5k) - (14k+1)\\exp(-14k) \\right]}{\\frac{1}{k^2} \\left[ 1 - (70k+1)\\exp(-70k) \\right]}\n$$\n因子 $1/k^2$ 被消掉，得到：\n$$\nP = e\\,c\\,\\frac{(5k+1)\\exp(-5k) - (14k+1)\\exp(-14k)}{1 - (70k+1)\\exp(-70k)}\n$$\n现在我们代入给定的参数值：\n$c = 0.85$\n$e = 0.90$\n$\\beta = 0.25$ year$^{-1}$\n$\\gamma = 0.03$ year$^{-1}$\n乘积 $e \\cdot c = 0.90 \\times 0.85 = 0.765$。\n复合参数 $k = \\beta + \\gamma = 0.25 + 0.03 = 0.28$ year$^{-1}$。\n\n我们计算 $P$ 公式中的各项：\n$5k = 5 \\times 0.28 = 1.4$\n$14k = 14 \\times 0.28 = 3.92$\n$70k = 70 \\times 0.28 = 19.6$\n\n表达式变为：\n$$\nP = 0.765 \\times \\frac{(1.4+1)\\exp(-1.4) - (3.92+1)\\exp(-3.92)}{1 - (19.6+1)\\exp(-19.6)}\n$$\n$$\nP = 0.765 \\times \\frac{2.4\\exp(-1.4) - 4.92\\exp(-3.92)}{1 - 20.6\\exp(-19.6)}\n$$\n我们计算数值：\n分数的分子：$2.4\\exp(-1.4) - 4.92\\exp(-3.92) \\approx 2.4(0.246597) - 4.92(0.019843) \\approx 0.591833 - 0.097628 \\approx 0.494205$\n分数的分母：$1 - 20.6\\exp(-19.6) \\approx 1 - 20.6(2.518 \\times 10^{-9}) \\approx 1 - 5.187 \\times 10^{-8} \\approx 0.999999948$\n分母非常接近于 $1$。\n\n最后，我们计算 $P$：\n$$\nP \\approx 0.765 \\times \\frac{0.494205}{0.999999948} \\approx 0.765 \\times 0.494205 \\approx 0.3780678\n$$\n按照要求，将结果四舍五入到四位有效数字：\n$$\nP \\approx 0.3781\n$$\n这意味着通过有针对性的治疗运动，大约清除了社区总虫卵产出的 $37.81\\%$。", "answer": "$$\\boxed{0.3781}$$", "id": "4799544"}, {"introduction": "MDA项目实施后，我们如何衡量其成功？我们依赖于诊断测试，但没有一种测试是完美的。本练习深入探讨了解读监测数据的关键任务，即考虑我们所用工具的灵敏度（$s$）和特异性（$f$）。你将计算观测结果中的“偏差”，从而理解为什么调查报告的患病率可能并非人群中的真实患病率，这对于准确评估项目成效至关重要。[@problem_id:4799555]", "problem": "一项国家淋巴丝虫病消除计划采用全民药物干预 (MDA)，并利用循环抗原快速检测试验进行横断面调查，以评估传播是否已得到充分抑制，从而决定是否停止 MDA。设目标人群中的真实感染患病率为 $P$，检验灵敏度为 $s$，检验特异度为 $f$，其标准定义如下：灵敏度 $s = \\Pr(\\text{检测阳性} \\mid \\text{感染})$，特异度 $f = \\Pr(\\text{检测阴性} \\mid \\text{未感染})$，以及真实患病率 $P = \\Pr(\\text{感染})$。调查团队计划使用由观察到的阳性检测比例给出的朴素患病率估计量，而不对不完美的灵敏度和特异度进行校正。\n\n从全概率定律和上述定义出发，推导表观患病率（随机抽样的个体检测呈阳性的概率）关于 $s$、$f$ 和 $P$ 的表达式。将偏差 $B$ 定义为该表观患病率与真实患病率 $P$ 之间的差值。然后计算当 $s = 0.9$、$f = 0.98$ 和 $P = 0.05$ 时 $B$ 的值。将 $B$ 的最终答案表示为小数（不要使用百分号），并四舍五入到三位有效数字。", "solution": "问题要求推导朴素患病率估计量偏差的表达式，并为一组特定参数计算其值。我们首先将给定信息形式化。\n\n设 $I$ 为随机抽样的个体被感染的事件，设 $U$ 为该个体未被感染的事件。这两个事件构成了样本空间的一个划分，因此 $\\Pr(U) = 1 - \\Pr(I)$。设 $T^+$ 为该个体检测呈阳性的事件，设 $T^-$ 为该个体检测呈阴性的事件。\n\n问题以概率术语提供了以下定义：\n- 真实患病率，$P = \\Pr(I)$。\n- 检验灵敏度，$s = \\Pr(T^+ \\mid I)$。这是指感染者检测呈阳性的概率。\n- 检验特异度，$f = \\Pr(T^- \\mid U)$。这是指未感染者检测呈阴性的概率。\n\n根据这些定义，我们可以推导出互补事件的概率：\n- 一个人未被感染的概率是 $\\Pr(U) = 1 - \\Pr(I) = 1 - P$。\n- 假阴性（感染者检测呈阴性）的概率是 $\\Pr(T^- \\mid I) = 1 - \\Pr(T^+ \\mid I) = 1 - s$。\n- 假阳性（未感染者检测呈阳性）的概率是 $\\Pr(T^+ \\mid U) = 1 - \\Pr(T^- \\mid U) = 1 - f$。\n\n表观患病率是指随机抽样的个体检测呈阳性的概率，我们将其表示为 $P_a = \\Pr(T^+)$。按照要求，我们使用全概率定律，根据个体的感染状态（感染 $I$ 或未感染 $U$）对事件 $T^+$ 进行划分：\n$$\nP_a = \\Pr(T^+) = \\Pr(T^+ \\cap I) + \\Pr(T^+ \\cap U)\n$$\n使用条件概率的定义，$\\Pr(A \\cap B) = \\Pr(A \\mid B) \\Pr(B)$，我们可以将其重写为：\n$$\nP_a = \\Pr(T^+ \\mid I)\\Pr(I) + \\Pr(T^+ \\mid U)\\Pr(U)\n$$\n代入患病率、灵敏度和特异度的符号定义：\n$$\nP_a = s \\cdot P + (1 - f) \\cdot (1 - P)\n$$\n这就是推导出的表观患病率的表达式。\n\n偏差 $B$ 定义为表观患病率 $P_a$ 与真实患病率 $P$ 之间的差值：\n$$\nB = P_a - P\n$$\n代入我们关于 $P_a$ 的表达式：\n$$\nB = \\left[ s \\cdot P + (1-f) \\cdot (1-P) \\right] - P\n$$\n这个表达式可以重新整理，以便更好地理解其组成部分：\n$$\nB = sP - P + (1-f)(1-P)\n$$\n$$\nB = P(s - 1) + (1-f)(1-P)\n$$\n该方程揭示了偏差的两个来源：第一项 $P(s-1) = -P(1-s)$，代表了由假阴性造成的负向偏差贡献；而第二项 $(1-f)(1-P)$，代表了由假阳性造成的正向偏差贡献。\n\n我们现在的任务是计算在特定参数 $s = 0.9$、$f = 0.98$ 和 $P = 0.05$ 下 $B$ 的值。\n首先，我们计算表观患病率 $P_a$：\n$$\nP_a = (0.9)(0.05) + (1 - 0.98)(1 - 0.05)\n$$\n$$\nP_a = 0.045 + (0.02)(0.95)\n$$\n$$\nP_a = 0.045 + 0.019\n$$\n$$\nP_a = 0.064\n$$\n接下来，我们计算偏差 $B$：\n$$\nB = P_a - P = 0.064 - 0.05\n$$\n$$\nB = 0.014\n$$\n问题要求最终答案保留三位有效数字。数字 $0.014$ 有两位有效数字（前导零不算有效数字）。为了将此值表示为三位有效数字，我们必须在末尾添加一个零。\n$$\nB \\approx 0.0140\n$$\n这个正偏差表明，在这种情况下，朴素估计量（阳性检测的比例）高估了真实患病率。发生这种情况是因为假阳性对偏差的贡献（$0.019$）大于假阴性的负向贡献（即 $P(s-1) = 0.05(0.9-1) = -0.005$）。", "answer": "$$\\boxed{0.0140}$$", "id": "4799555"}]}