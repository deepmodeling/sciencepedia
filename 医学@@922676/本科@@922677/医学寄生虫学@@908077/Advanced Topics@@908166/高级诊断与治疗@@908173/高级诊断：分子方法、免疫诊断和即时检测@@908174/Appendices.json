{"hands_on_practices": [{"introduction": "定量聚合酶链式反应（qPCR）的核心价值在于其“定量”能力，但仪器直接输出的信号是相对的循环阈值（$C_t$）。本练习将指导你如何利用标准曲线，将抽象的 $C_t$ 值转化为具体的、有生物学意义的起始模板拷贝数 $N_0$。这个过程是所有定量分子分析的基石，通过它你将掌握从原始数据中提取定量信息的核心技能 ([@problem_id:4778763])。", "problem": "一家临床寄生虫学实验室正在验证一种用于检测全血中 Plasmodium falciparum 多拷贝基因组靶标的定量聚合酶链式反应 (qPCR) 检测方法。在 qPCR 中，根据经验观察，阈值循环数 $C_t$ 通过斜率为 $m$、截距为 $b$ 的标准曲线，与起始模板拷贝数 $N_0$ 的以 10 为底的对数呈线性关系，即 $C_t$ 线性依赖于 $\\log_{10}(N_0)$。对于某次特定的检测运行，标准曲线的斜率 $m=-3.5$，截距 $b=38$。一份患者样本得到的 $C_t=30$。从 $C_t$ 和 $\\log_{10}(N_0)$ 之间的线性关系出发，推导一个用 $C_t$、$m$ 和 $b$ 表示 $N_0$ 的表达式，然后计算该样本每次反应的起始拷贝数。最后，简要评论当反应体积为 $20$ µL、其中包含 $5$ µL 提取的模板、且靶标为多拷贝基因座时，所计算出的 $N_0$ 的数量级对于低寄生虫血症感染是否具有生物学合理性。报告 $N_0$ 的数值，单位为拷贝数/反应，四舍五入到三位有效数字。最终数值答案中不要包含单位。", "solution": "该问题要求从定量聚合酶链式反应（qPCR）分析的标准方程中推导起始模板拷贝数 $N_0$ 的表达式，然后对一个特定样本进行计算，并对结果的合理性进行评论。\n\n阈值循环数 $C_t$ 和初始拷贝数 $N_0$ 之间的关系被描述为与 $N_0$ 的以 10 为底的对数呈线性关系。该关系可以表示为一个线性方程：\n$$C_t = m \\cdot \\log_{10}(N_0) + b$$\n其中 $m$ 是标准曲线的斜率，$b$ 是 y 轴截距。\n\n为了推导用 $C_t$、$m$ 和 $b$ 表示 $N_0$ 的表达式，我们必须对这个方程进行代数重排。\n首先，方程两边同时减去截距 $b$：\n$$C_t - b = m \\cdot \\log_{10}(N_0)$$\n接下来，两边同时除以斜率 $m$ 来分离对数项：\n$$\\frac{C_t - b}{m} = \\log_{10}(N_0)$$\n最后，为了求解 $N_0$，我们应用以 10 为底的对数的定义。方程 $\\log_{10}(x) = y$ 等价于 $x = 10^y$。应用此性质，我们得到 $N_0$ 的表达式：\n$$N_0 = 10^{\\left(\\frac{C_t - b}{m}\\right)}$$\n这是基于 qPCR 标准曲线参数的起始拷贝数的一般表达式。\n\n现在，我们可以使用所提供的数据计算患者样本的 $N_0$ 值：\n测得的阈值循环数是 $C_t = 30$。\n标准曲线的斜率是 $m = -3.5$。\n标准曲线的 y 轴截距是 $b = 38$。\n\n将这些值代入推导出的表达式中：\n$$N_0 = 10^{\\left(\\frac{30 - 38}{-3.5}\\right)}$$\n首先，我们计算指数部分：\n$$\\frac{30 - 38}{-3.5} = \\frac{-8}{-3.5} = \\frac{8}{3.5} = \\frac{8}{7/2} = \\frac{16}{7}$$\n因此 $N_0$ 的表达式变为：\n$$N_0 = 10^{16/7}$$\n对该表达式进行数值计算：\n$$N_0 \\approx 10^{2.285714...} \\approx 193.06977$$\n问题要求答案四舍五入到三位有效数字。\n$$N_0 \\approx 193$$\n因此，反应中靶序列的起始拷贝数约为 $193$ 个拷贝。\n\n最后，我们需要评论这个值对于低寄生虫血症感染是否具有生物学合理性。计算出的值是 $N_0 \\approx 193$ 个靶标拷贝/反应。这个量存在于添加到 $20$ µL 总反应体积中的 $5$ µL 模板 DNA 中。\n\n靶标被指定为 *Plasmodium falciparum* 基因组内的多拷贝基因座。一个常见的例子是 $18$S 核糖体 RNA 基因，每个单倍体寄生虫基因组中大约有 $5$ 到 $8$ 个拷贝。我们假设每个寄生虫平均有 $c \\approx 5$ 个靶标拷贝。\n反应中寄生虫基因组的数量可以估计为：\n$$\\text{寄生虫数量} = \\frac{N_0}{c} \\approx \\frac{193}{5} \\approx 38.6 \\text{ 个寄生虫}$$\n这个数量的寄生虫包含在 $5$ µL 的模板 DNA 中。这对应于大约 $38.6 / 5 = 7.72$ 个寄生虫基因组/微升 DNA 提取物 的模板浓度。\n\n为了将其与血液中的寄生虫血症水平联系起来，我们必须考虑 DNA 提取过程，但其细节未被提供。一个典型的方案可能涉及从 $V_{\\text{blood}} = 200$ µL 全血中提取 DNA，并将其洗脱到 $V_{\\text{eluate}} = 50$ 至 $100$ µL 的最终体积中。假设洗脱体积为 $V_{\\text{eluate}} = 100$ µL，且回收效率为假想的 $100\\%$，那么原始血样中的寄生虫总数将是 $(7.72 \\text{ 寄生虫/µL}) \\times (100 \\text{ µL}) = 772$ 个寄生虫。那么寄生虫血症水平将是 $\\frac{772 \\text{ 寄生虫}}{200 \\text{ µL 血液}} \\approx 3.9$ 寄生虫/µL。\n\n低寄生虫血症的临床阈值通常被认为低于 $100$ 寄生虫/µL，而亚显微感染（通常被光学显微镜漏检的感染）的水平可能低于 $1$ 寄生虫/µL。大约 $4$ 寄生虫/µL 的估计寄生虫血症水平完全属于低水平感染的范围，而像 qPCR 这样的分子方法正是为检测这类感染而设计的。使用多拷贝靶标提高了检测的灵敏度，使得检测如此低的寄生虫载量成为可能。因此，在诊断低寄生虫血症 *P. falciparum* 感染的背景下，计算出的拷贝数 $N_0 \\approx 193$ 是完全合理的。", "answer": "$$\\boxed{193}$$", "id": "4778763"}, {"introduction": "临床样本（如粪便）的复杂性常常给分子检测带来挑战，其中最常见的就是PCR抑制效应。本练习模拟了一个真实世界的情景，即样本中的抑制剂导致检测结果不准确 ([@problem_id:4778766])。你将通过建立数学模型来寻找一个最佳的解决方案：确定一个既能消除抑制又能保证靶标可被检测到的最小稀释倍数，这会让你深入理解诊断实验优化中的重要权衡。", "problem": "一个临床寄生虫学实验室正在验证一种定量聚合酶链式反应 (qPCR) 检测法，该方法用于检测粪便提取物中的 Giardia lamblia 小亚基核糖体RNA基因。一项内参扩增对照显示存在抑制作用，表现为循环阈值 ($C_t$) 的增加，其量化值为受抑制样本与匹配的未受抑制对照之间的测量差异 $\\Delta C_t = 3$。该检测的分析检测限 (LOD) 为每个反应 $10$ 个拷贝。从未受抑制的标准品得出的校准曲线估计，未稀释的临床样本含有每个反应 $200$ 个目标拷贝。\n\n假设关于实时qPCR的以下基本原则：\n- 在理想扩增条件下，扩增子数量每个循环加倍，因此在阈值处，关系式为 $N_{\\text{th}} = N_0 \\times 2^{C_t}$，其中 $N_{\\text{th}}$ 是固定的阈值数量，$N_0$ 是初始模板拷贝数，$C_t$ 是循环阈值。\n- 抑制作用通过一个乘法因子 $I$（$0  I \\le 1$）减少模板的有效可扩增部分，从而增加 $C_t$。观测到的 $\\Delta C_t$ 定义为，对于相同的初始 $N_0$ 和阈值 $N_{\\text{th}}$，受抑制和未受抑制的 $C_t$ 值之差。\n\n为减轻抑制作用，实验室考虑将提取物稀释一个因子 $D  1$，这会按比例降低抑制剂浓度和目标拷贝数。在一个简化的假设下，即稀释线性地减轻抑制作用直至其可忽略不计（即，每两倍稀释使抑制剂引起的 $\\Delta C_t$ 减少 $1$ 个循环），确定最小稀释因子 $D$，该因子既能消除观测到的抑制作用，又能确保稀释后的目标物保持在分析检测限 (LOD) 或以上。将你的最终答案表示为一个无单位的稀释因子。如果需要四舍五入，请保留四位有效数字。", "solution": "目标是确定最小稀释因子 $D$，该因子满足定量聚合酶链式反应 (qPCR) 检测的两个特定条件。首先，稀释必须足以消除观测到的PCR抑制。其次，稀释后样本中目标DNA的浓度必须保持在或高于检测的分析检测限 (LOD)。\n\n让我们将给定的信息和约束条件形式化。\n未稀释样本中目标模板的初始浓度为 $N_0 = 200$ 个拷贝/反应。\n分析检测限为 $LOD = 10$ 个拷贝/反应。\n未稀释样本中观测到的抑制作用由循环阈值差异 $\\Delta Ct_{initial} = 3$ 量化。\n\n问题陈述了一个关于稀释如何影响抑制的简化假设：每两倍稀释使抑制剂引起的 $\\Delta C_t$ 减少 $1$ 个循环。让我们用数学方式表达这种关系。稀释因子 $D$ 等效于 $k$ 次两倍稀释，其中 $D = 2^k$，这意味着 $k = \\log_2(D)$。因此，$\\Delta C_t$ 的减少量等于 $\\log_2(D)$。稀释后剩余的 $\\Delta C_t$，记作 $\\Delta C_{t,D}$，由下式给出：\n$$\n\\Delta C_{t,D} = \\Delta C_{t,initial} - \\log_2(D)\n$$\n\n第一个条件是稀释必须消除观测到的抑制作用。这意味着剩余的 $\\Delta C_{t,D}$ 必须小于或等于零。$\\Delta C_{t,D}  0$ 的值将表示存在残留抑制。\n$$\n\\Delta C_{t,D} \\le 0\n$$\n代入 $\\Delta C_{t,D}$ 的表达式和 $\\Delta C_{t,initial}$ 的给定值：\n$$\n3 - \\log_2(D) \\le 0\n$$\n解这个关于 $D$ 的不等式：\n$$\n3 \\le \\log_2(D)\n$$\n为了分离出 $D$，我们可以对不等式两边应用以 $2$ 为底的指数函数。由于底数大于 $1$ 的指数函数是单调递增的，不等式的方向保持不变。\n$$\n2^3 \\le D\n$$\n$$\n8 \\le D\n$$\n第一个条件要求稀释因子 $D$ 必须至少为 $8$。\n\n第二个条件是稀释后样本中目标的浓度必须保持在或高于LOD。稀释因子为 $D$ 后的目标浓度由 $N_D = \\frac{N_0}{D}$ 给出。此浓度必须大于或等于LOD。\n$$\nN_D \\ge LOD\n$$\n代入 $N_0$ 和 $LOD$ 的已知值：\n$$\n\\frac{200}{D} \\ge 10\n$$\n由于稀释因子 $D$ 大于 $1$，我们可以在不等式两边同乘以 $D$ 而不改变不等式的方向：\n$$\n200 \\ge 10D\n$$\n两边除以 $10$ 得到 $D$ 的上限：\n$$\n\\frac{200}{10} \\ge D\n$$\n$$\n20 \\ge D\n$$\n第二个条件要求稀释因子 $D$ 不得超过 $20$。\n\n为了找到满足这两个条件的最小稀释因子，我们必须找到 $D$ 在两个不等式定义的范围内的最小值：\n$$\n8 \\le D \\le 20\n$$\n所有有效稀释因子的集合是闭区间 $[8, 20]$。问题要求的是这个集合中的最小稀释因子 $D$。满足此组合约束的 $D$ 的最小值为 $8$。\n\n让我们验证一下这个结果。如果我们使用稀释因子 $D=8$：\n1.  抑制被消除：$\\Delta C_{t,D} = 3 - \\log_2(8) = 3 - 3 = 0$。\n2.  稀释后样本浓度为 $N_D = \\frac{200}{8} = 25$ 个拷贝/反应。这大于 $10$ 个拷贝/反应的LOD（$25 \\ge 10$）。\n\n两个条件都满足了。任何小于 $8$ 的稀释因子都无法消除抑制。因此，所需的最小稀释因子是 $8$。结果是一个精确的整数，所以不需要四舍五入。", "answer": "$$\\boxed{8}$$", "id": "4778766"}, {"introduction": "一项诊断测试的真正价值，取决于它在多大程度上能帮助我们做出正确的临床决策。本练习将引导你超越测试固有的灵敏度（$Se$）和特异性（$Sp$），去探索疾病流行率（$\\pi$）如何影响测试结果的解读 ([@problem_id:4778776])。通过运用贝叶斯定理推导并计算阳性预测值（PPV）和阴性预测值（NPV），你将深刻理解为何同一个测试在不同人群中的诊断效力会截然不同。", "problem": "在一家部署用于检测恶性疟原虫的疟疾快速诊断测试（RDT）的现场诊所中，临床医生希望量化疾病的检验前概率如何影响检验后的解读。请使用灵敏度、特异性、疾病患病率的概率定义以及关联先验和后验概率的 Bayes 定理作为基础。\n\n使用的定义：\n- 灵敏度（$Se$）是指在患有疾病的情况下，测试结果为阳性的概率。\n- 特异性（$Sp$）是指在未患疾病的情况下，测试结果为阴性的概率。\n- 患病率（$\\pi$）是指从目标人群中随机选择一名患者患有该疾病的先验概率。\n- 阳性预测值（PPV）是指在测试结果为阳性的情况下，患有该疾病的概率。\n- 阴性预测值（NPV）是指在测试结果为阴性的情况下，未患该疾病的概率。\n- Bayes 定理将后验概率与先验概率和似然的乘积联系起来。\n\n从这些定义和 Bayes 定理出发（不要假设任何简化公式），推导阳性预测值和阴性预测值作为 $Se$、$Sp$ 和 $\\pi$ 函数的解析表达式。然后，计算当疟疾 RDT 的 $Se = 0.95$、$Sp = 0.98$ 和 $\\pi = 0.10$ 时，$PPV$ 和 $NPV$ 的数值。将两个最终数值四舍五入至 $4$ 位有效数字，并以不带百分号的小数形式表示。最后，使用您推导的表达式，定性地简要解释增加或减少 $\\pi$ 如何在确诊与排除疟疾方面改变测试的临床效用。您的最终数值答案必须以包含 $PPV$ 和 $NPV$（按此顺序）的行矩阵形式给出。", "solution": "该问题是有效的，因为它科学地基于概率论和流行病学的既定原则，问题陈述清晰且提供了所有必要信息，并且其表述是客观的。我们将着手推导阳性预测值（PPV）和阴性预测值（NPV）的解析表达式，然后计算它们的数值。\n\n设 $D$ 为患者患有疾病（疟疾）的事件，$D^c$ 为患者未患该疾病的事件。设 $T$ 为测试结果为阳性的事件，$T^c$ 为测试结果为阴性的事件。\n\n给定的定义可以用条件概率表示：\n-   患病率（$\\pi$）：$P(D) = \\pi$。因此，未患病的概率为 $P(D^c) = 1 - P(D) = 1 - \\pi$。\n-   灵敏度（$Se$）：$P(T|D) = Se$。这是真阳性的概率。因此，假阴性的概率为 $P(T^c|D) = 1 - P(T|D) = 1 - Se$。\n-   特异性（$Sp$）：$P(T^c|D^c) = Sp$。这是真阴性的概率。因此，假阳性的概率为 $P(T|D^c) = 1 - P(T^c|D^c) = 1 - Sp$。\n\n我们的目标是推导 PPV 和 NPV 的表达式。\n-   阳性预测值（PPV）是在测试结果为阳性的情况下患有该疾病的概率：$PPV = P(D|T)$。\n-   阴性预测值（NPV）是在测试结果为阴性的情况下未患该疾病的概率：$NPV = P(D^c|T^c)$。\n\n我们将使用 Bayes 定理，该定理指出对于事件 $A$ 和 $B$，$P(A|B) = \\frac{P(B|A)P(A)}{P(B)}$。\n\n**阳性预测值（PPV）的推导**\n\n应用 Bayes 定理求 $PPV = P(D|T)$：\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T)}$$\n分母 $P(T)$ 是获得阳性测试结果的总概率。它可以通过全概率定律求得，考虑两种互斥情景：患者患有疾病或未患疾病。\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\n将我们定义的变量代入此表达式：\n$$P(T) = (Se)(\\pi) + (1-Sp)(1-\\pi)$$\n现在，我们将这个 $P(T)$ 的表达式代回 PPV 的方程中：\n$$PPV = \\frac{P(T|D)P(D)}{P(T|D)P(D) + P(T|D^c)P(D^c)}$$\n代入符号定义，得到 PPV 的最终解析表达式：\n$$PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1-Sp)(1-\\pi)}$$\n\n**阴性预测值（NPV）的推导**\n\n应用 Bayes 定理求 $NPV = P(D^c|T^c)$：\n$$NPV = P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c)}$$\n分母 $P(T^c)$ 是获得阴性测试结果的总概率。使用全概率定律：\n$$P(T^c) = P(T^c|D)P(D) + P(T^c|D^c)P(D^c)$$\n代入我们定义的变量：\n$$P(T^c) = (1-Se)(\\pi) + (Sp)(1-\\pi)$$\n现在，我们将这个 $P(T^c)$ 的表达式代回 NPV 的方程中：\n$$NPV = \\frac{P(T^c|D^c)P(D^c)}{P(T^c|D)P(D) + P(T^c|D^c)P(D^c)}$$\n代入符号定义，得到 NPV 的最终解析表达式：\n$$NPV = \\frac{Sp \\cdot (1-\\pi)}{(1-Se)\\cdot \\pi + Sp \\cdot (1-\\pi)}$$\n\n**数值计算**\n\n我们已知以下数值：\n-   $Se = 0.95$\n-   $Sp = 0.98$\n-   $\\pi = 0.10$\n\n由此，我们可以计算出：\n-   $1 - Se = 1 - 0.95 = 0.05$\n-   $1 - Sp = 1 - 0.98 = 0.02$\n-   $1 - \\pi = 1 - 0.10 = 0.90$\n\n现在，我们计算 PPV 的数值：\n$$PPV = \\frac{(0.95)(0.10)}{(0.95)(0.10) + (0.02)(0.90)} = \\frac{0.095}{0.095 + 0.018} = \\frac{0.095}{0.113} \\approx 0.840707...$$\n四舍五入到 $4$ 位有效数字，$PPV = 0.8407$。\n\n接下来，我们计算 NPV 的数值：\n$$NPV = \\frac{(0.98)(0.90)}{(0.05)(0.10) + (0.98)(0.90)} = \\frac{0.882}{0.005 + 0.882} = \\frac{0.882}{0.887} \\approx 0.994363...$$\n四舍五入到 $4$ 位有效数字，$NPV = 0.9944$。\n\n**患病率（$\\pi$）影响的定性解释**\n\n推导出的 $PPV$ 和 $NPV$ 表达式表明，它们强烈依赖于检验前概率，即患病率（$\\pi$）。\n\n-   **PPV 与确诊疾病：** 表达式 $PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1-Sp)(1-\\pi)}$ 表明 $PPV$ 是 $\\pi$ 的增函数。随着患病率 $\\pi$ 增加，分子（$Se \\cdot \\pi$）增加，分母中真阳性（$Se \\cdot \\pi$）的贡献超过了假阳性（$(1-Sp)(1-\\pi)$）的贡献。这意味着在高患病率环境中，阳性测试结果极有可能是真阳性，使得该测试在“确诊”疟疾方面非常有用。相反，当 $\\pi$ 趋近于 $0$ 时，$PPV$ 也趋近于 $0$。在低患病率环境中，大部分阳性结果将是假阳性，这严重限制了该测试在确认疾病方面的效用。\n\n-   **NPV 与排除疾病：** 表达式 $NPV = \\frac{Sp \\cdot (1-\\pi)}{(1-Se)\\cdot \\pi + Sp \\cdot (1-\\pi)}$ 表明 $NPV$ 是 $\\pi$ 的减函数。随着患病率 $\\pi$ 降低，项 $(1-\\pi)$ 趋近于 $1$，而分母中的项 $(1-Se)\\cdot\\pi$ 趋近于 $0$。这使得 $NPV$ 趋近于 $1$。一个非常高的 $NPV$ 意味着阴性测试结果极有可能是真阴性。因此，在低患病率环境中，该测试在“排除”疟疾方面非常有效，能够向临床医生保证患者很可能没有患病。随着患病率 $\\pi$ 增加，假阴性（$(1-Se)\\cdot\\pi$）相对于真阴性（$Sp \\cdot(1-\\pi)$）的概率增加，导致 $NPV$ 下降，从而略微削弱了其明确排除疾病的能力。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.8407  0.9944 \\end{pmatrix}}\n$$", "id": "4778776"}]}