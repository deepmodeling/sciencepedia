## 引言
流行病学是理解和改善人群健康的基石科学，其核心在于运用定量的语言来描述疾病的分布模式并探索其背后的原因。然而，从复杂的健康数据中提炼出有意义的见解，需要一套严谨的方法论框架。本文旨在系统性地介绍这些基础原理，解决如何科学地测量疾病频率、评估风险因素关联强度这一核心问题。在接下来的内容中，读者将首先通过“原理与机制”一章，深入学习发病率、患病率等基本指标的定义，掌握不同研究设计下的关联强度测量，并理解偏倚与混杂等关键挑战。随后，在“应用与跨学科交叉”一章中，我们将展示这些原理如何在公共卫生决策、临床实践乃至社会科学研究中发挥作用。最后，通过“动手实践”环节，您将有机会亲手应用所学知识，解决真实世界中的流行病学问题，从而将理论与实践紧密结合。

## 原理与机制

在流行病学研究中，我们的核心任务是描述人群中疾病的分布规律，并阐明其影响因素。为了系统地完成这一任务，我们需要一套严谨的定量工具来测量疾病的频率，并评估暴露与结局之间的关联强度。本章将深入探讨这些基本的原理与机制，它们构成了现代流行病学方法的基石。我们将从疾病频率的基础测量指标——患病率与发病率——入手，进而探讨如何在不同的研究设计中估计这些指标及相应的关联强度，最后将讨论在解释这些测量结果时必须面对的挑战，如偏倚与混杂，并引入一个形式化的框架来思考因果关系。

### 疾病频率的基本测量指标

量化人群中的疾病负担是流行病学研究的第一步。两个最核心的指标是患病率（prevalence）和发病率（incidence）。它们从不同维度刻画了疾病的流行状况：患病率描述的是疾病的“存量”状态，而发病率则衡量疾病的“增量”速度。

#### 患病率：疾病负担的快照

**患病率（Prevalence）** 指的是在特定时间点或特定时期内，特定人群中患有某种疾病的人口所占的比例。它反映了疾病对人群造成的即时负担，是公共卫生规划、资源分配和医疗服务需求评估的重要依据。患病率主要分为两种类型：时点患病率和时期患病率。

**时点患病率（Point Prevalence）** 衡量在某一个特定时间点（如2024年7月1日）人群中现存病例的比例。它像一张“快照”，捕捉了该时刻的疾病状态。其计算公式为：

$P_{\text{point}} = \frac{\text{特定时间点的现存病例数}}{\text{该时间点的总人口数}}$

**时期患病率（Period Prevalence）** 则衡量在一个特定时期内（如2024年全年）人群中曾经患病（包括期初已患病和期内新发病）的个体所占的比例。它涵盖了一个时间段内的全部病例，包括期初的存量和期内的新增量。其计算公式为：

$P_{\text{period}} = \frac{\text{特定时期内出现过的总病例数}}{\text{该时期内观察的总人口数}}$

理解这两种患病率的关键在于精确定义其分子和分母。在一个动态变化的开放队列中，个体会因出生、死亡、迁移等原因进入或离开，这使得分母的计算尤为重要。

为了阐明这一点，我们来思考一个追踪[流感](@entry_id:190386)样疾病（ILI）的假设情景 [@problem_id:4977441]。假设我们对一个包含20人的开放队列进行为期一年的观察（2024年1月1日至12月31日），每个人的观察时间窗口可能不同。

-   要计算**时点患病率**，例如在年中普查日7月1日这一天的患病率，分子是当天正处于ILI病程中的人数，分母则是当天正在被观察的总人数。例如，如果当天有4人患病，且有15人正在被观察（其他人或已离开或尚未加入），那么时点患病率就是 $4/15$。

-   要计算该年度的**时期患病率**，分子是在2024年任何时间点曾经患过ILI的*不重复*个体总数（包括年初带病进入观察期和年内新发病的个体）。分母则是这一年内任何时间点曾被观察过的*不重复*个体总数。例如，如果年内共有9位不同的个体患病，且总共有20位个体曾被纳入观察，那么时期患病率就是 $9/20$。

这里必须注意，时点患病率的分母是特定时间点的在册人口，而时期患病率的分母是整个时期内的总观察人口，这两者在开放队列中通常是不同的。混淆二者的分母是常见的错误。

#### 发病率：新发病例的度量

与衡量存量的患病率不同，**发病率（Incidence）** 关注的是新发病例的出现。它是衡量疾病风险和传播速度的动态指标，对于病因学研究和评价预防措施的效果至关重要。发病率主要有两种表现形式：累积发病率和发病率密度。

**累积发病率（Cumulative Incidence, CI）**，也常被称为**风险（Risk）**，指在一个特定时期内，一个初始无病的人群中新发病例所占的比例。它衡量的是一个个体在特定时间段内发生某疾病的平均风险。其计算公式为：

$CI = \frac{\text{特定时期内的新发病例数}}{\text{期初无病的风险人口数}}$

累积发病率是一个无量纲的比例，取值范围在 $0$ 到 $1$ 之间。它假设所有风险人口都被完整地随访了整个时期。在急性传染病暴发的特定情境下，累积发病率通常被称为**罹患率（Attack Rate, AR）**。罹患率的计算方式与累积发病率完全相同，只是应用场景更为具体，即用于衡量一次短期暴发中暴露人群的发病风险 [@problem_id:4977416]。

**发病率密度（Incidence Rate, IR）**，也称**发病密度（Incidence Density）**，是衡量疾病发生速度的真实速率。它考虑了每个个体处于风险状态下的实际观察时间。其计算公式为：

$IR = \frac{\text{特定时期内的新发病例数}}{\text{同期内风险人口的总人时数}}$

分母**人时数（Person-Time）** 是所有个体风险观察时间的总和（例如，人年、人月）。发病率密度的单位是“病例数/人时”，例如“每1000人年4个病例”。与累积发病率不同，发病率密度能够精确处理动态队列中个体随访时间不等的复杂情况（如失访、死亡、晚进组等），因此在许多长期队列研究中是更优越的指标。

在实际研究中，尤其是在有失访（即[右删失](@entry_id:164686)）的队列中，直接用“新发病例数/期初总人数”计算累积发病率会产生偏倚，因为它低估了风险（将失访者当作未发病处理）。此时，需要使用生存分析方法来正确估计累积发病率。一个标准的非参数方法是 **Kaplan-Meier估计法** [@problem_id:4977458]。该方法通过在每个事件发生时间点计算条件生存概率，并将它们连乘起来，从而得到生存函数 $\hat{S}(t)$（即生存到时间 $t$ 之后的概率）。累积发病率即为 $1 - \hat{S}(t)$。这种方法巧妙地利用了所有个体（无论其是否完整随访）在他们被观察期间提供的信息，从而得到对真实风险的[无偏估计](@entry_id:756289)。

#### 患病率、发病率与病程之间的动态关系

患病率、发病率和病程（Duration, $D$）三者之间存在一个重要的动态平衡关系。在一个人口规模和结构稳定、发病率和病程也保持不变的“[稳态](@entry_id:139253)（steady state）”系统中，人群中疾病的存量（患病人数）取决于新发病例的流入速率和因康复或死亡导致的流出速率。当流入等于流出时，系统[达到平衡](@entry_id:170346)。

这个关系可以用一个简洁的公式来近似描述 [@problem_id:4977429]：

$P \approx I \times D$

其中，$P$ 是患病率（一个比例），$I$ 是发病率密度（单位为 时间$^{-1}$），$D$ 是疾病的平均病程（单位为 时间）。这个公式在患病率较低（通常小于 $0.1$）时非常精确。

这个公式的实践意义是巨大的。例如，考虑一种慢性病，如慢性肾脏病（CKD）。假设某地区CKD的发病率（$I$）多年来稳定在每1000人年4例（即 $I = 0.004 \text{ year}^{-1}$），平均病程（$D$）为5年。根据公式，我们可以预期其[稳态](@entry_id:139253)患病率（$P$）约为 $0.004 \times 5 = 0.02$，即 $2\%$。现在，一项新的治疗方案被引入，它不能治愈疾病，但能显著延长患者的生存时间，使得平均病程从5年增加到8年。即使发病率（新发病例的速度）保持不变，由于患者带病生存的时间更长（流出减慢），人群中累积的病例数将会增加。在新的平衡状态下，患病率将上升至 $P_{\text{new}} \approx 0.004 \times 8 = 0.032$，即 $3.2\%$。

这个例子清楚地表明，**患病率的增加不一定意味着发病风险的增加**。它也可能是公共卫生改善（如治疗水平提高，生存期延长）的结果。因此，在解读患病率数据时，必须同时考虑发病率和病程的变化。

### 流行病学研究设计与指标估计

我们如何获得计算上述指标所需的数据？这取决于我们的研究设计。不同的设计适用于测量不同的频率指标和关联强度。

#### 队列研究：测量发病率的前瞻性方法

**队列研究（Cohort Study）** 是一种前瞻性的[观察性研究](@entry_id:174507)。研究者首先确定一个在研究开始时没有患目标疾病的人群（即“风险人群”），根据其是否具有某种暴露（如吸烟、接种疫苗）将其分为不同组，然后向前追踪这个队列，观察并记录新发疾病的出现情况。

队列研究的最大优势在于其**明确的时间顺序**：暴露的测量发生在结局出现之前 [@problem_id:4639113]。这种“因在果前”的[时间逻辑](@entry_id:181558)是建立因果推断的必要条件。由于队列研究直接追踪了从“无病”到“有病”的转变过程，因此它是测量**发病率**（包括累积发病率和发病率密度）的最直接、最自然的设计。

#### 横断面研究：患病率的时间快照

**横断面研究（Cross-sectional Study）** 在一个特定时间点上同时测量人群的暴露状态和疾病状态。它提供的是人群健康状况的“快照”，因此，它直接测量的疾病频率指标是**患病率** [@problem_id:4977447]。例如，一项调查可以同时询问居民的饮水来源（暴露）和他们目前是否患有腹泻（结局）。

横断面研究的主要局限性在于其时间模糊性。由于暴露和结局是同时测量的，我们通常无法确定是暴露导致了结局，还是结局影响了个体的暴露状况（即“先有鸡还是先有蛋”的问题）。这极大地限制了其在因果推断中的应用价值。

#### 病例对照研究：高效的回顾性探索

**病例对照研究（Case-control Study）** 采取一种回顾性的逻辑。研究者首先根据疾病状态选择研究对象：一组确诊患有某疾病的“病例（cases）”，和一组来自同一来源人群但不患该病的“对照（controls）”。然后，通过调查、查阅记录等方式，回顾性地比较两组人群在过去暴露于某个危险因素的比例差异。

这种设计的优势在于其高效性，尤其适用于研究罕见疾病或长潜伏期疾病。然而，由于其抽样是基于疾病状态，我们无法从中直接计算人群的发病率或患病率。

### 关联强度的测量

流行病学不仅要描述疾病频率，更要探究暴露与疾病之间的关联。关联强度（Measure of Association）是量化这种关系的指标，它告诉我们某种暴露的存在与否或程度高低，会在多大程度上改变疾病发生的风险或几率。关联强度主要分为相对测量和绝对测量。

#### 相对测量：比值

相对测量通过比值来比较暴露组与非暴露组的疾病频率，回答“暴露者的风险是非暴露者的多少倍”这类问题。

- **风险比（Risk Ratio, RR）**，也称累积发病率比（Cumulative Incidence Ratio），是暴露组的累积发病率（$CI_1$）与非暴露组的累积发病率（$CI_0$）之比。

  $RR = \frac{CI_1}{CI_0}$

  $RR$ 的直观解释是：暴露者的发病风险是非暴露者的 $RR$ 倍。由于 $RR$ 是基于累积发病率的，因此它只能从能够直接测量发病率的**队列研究**中估计 [@problem_id:4977408]。

- **发病率比（Incidence Rate Ratio, IRR）** 是暴露组的发病率密度（$IR_1$）与非暴露组的发病率密度（$IR_0$）之比。

  $IRR = \frac{IR_1}{IR_0}$

  $IRR$ 比较的是两个组疾病发生的速度，同样也只能在**队列研究**（尤其是提供了人时数据的队列研究）中直接估计。

- **比值比（Odds Ratio, OR）**，又称优势比，是暴露组中疾病发生的比值（odds）与非暴露组中疾病发生的比值之比。一个事件的比值定义为该事件发生的概率与不发生的概率之比，即 $Odds = \frac{p}{1-p}$。因此，疾病的 $OR$ 定义为：

  $OR_{\text{disease}} = \frac{CI_1 / (1-CI_1)}{CI_0 / (1-CI_0)}$

  $OR$ 是**病例对照研究**中主要的关联强度测量指标 [@problem_id:4977447]。在病例对照研究中，我们虽然不能直接计算风险，但可以计算病例组的暴露比值（暴露病例/非暴露病例）和[对照组](@entry_id:188599)的暴露比值（暴露对照/非暴露对照）。这两个比值的比率（即暴露 $OR$）在数学上可以证明等于人群中的疾病 $OR$。

  $OR$ 与 $RR$ 之间有一个非常重要的关系。当疾病罕见时（通常指人群中发病率或患病率低于 $10\%$），$CI_1$ 和 $CI_0$ 都很小，因此 $(1-CI_1) \approx 1$ 且 $(1-CI_0) \approx 1$。在这种情况下，$OR \approx RR$。这就是著名的**罕见病假设（rare disease assumption）**。这一特性使得在研究罕见病时，从病例对照研究中得到的 $OR$ 可以被视为对 $RR$ 的一个良好近似 [@problem_id:4977447]。

- **患病率比（Prevalence Ratio, PR）** 和**患病比值比（Prevalence Odds Ratio, POR）** 是从**横断面研究**中获得的关联度量。它们的计算方式与 $RR$ 和 $OR$ 类似，只是用患病率代替了发病率。例如，$PR = P_1 / P_0$ [@problem_id:4977408]。

#### 绝对测量：差值

绝对测量通过差值来比较两组的疾病频率，反映了暴露所带来的风险的绝对大小，具有重要的公共卫生意义。

- **风险差（Risk Difference, RD）**，也称归因风险（Attributable Risk），是暴露组与非暴露组累积发病率之差。

  $RD = CI_1 - CI_0$

  $RD$ 告诉我们，在暴露组中，由暴露本身所导致的额外风险是多少。例如，如果 $RD = 0.05$，则意味着每100个暴露者中，有5个病例是可归因于该暴露的。$RD$ 同样只能在**队列研究**中直接估计 [@problem_id:4977447]。

### 流行病学测量的挑战：偏倚与混杂

从数据中估计出的关联，并不总是真实反映暴露与结局之间的关系。混杂（Confounding）和偏倚（Bias）是两个主要的系统性误差来源，它们可能歪曲甚至颠倒我们观察到的关联。

#### 混杂与辛普森悖论

**混杂** 是指一个与暴露和结局均有关的第三个变量（混杂因素），它扭曲了我们观察到的暴露与结局之间的关联。一个变量成为混杂因素必须满足三个条件：(1) 它是结局的危险因素；(2) 它与暴露相关联；(3) 它不是暴露与结局因果链上的中间环节。

**辛普森悖论（Simpson's Paradox）** 是混杂效应一个极端而经典的体现，即在数据分组时表现出的一种趋势，在数据合并后却表现出完全相反的趋势。

为了理解这一点，让我们分析一个评估伤寒疫苗效果的假设队列研究 [@problem_id:4977445]。研究分为两个年龄组：高风险的老年人（$\ge 65$岁）和低风险的年轻人（ 65岁）。

- 在老年组中：疫苗接种者900人中发病90人（风险 $10\%$），未接种者100人中发病20人（风险 $20\%$）。风险比 $RR = 0.10 / 0.20 = 0.5$。疫苗看起来是保护性的。
- 在年轻组中：疫苗接种者100人中发病1人（风险 $1\%$），未接种者900人中发病18人（风险 $2\%$）。风险比 $RR = 0.01 / 0.02 = 0.5$。疫苗看起来同样是保护性的。

在每个年龄层内，疫苗都将风险减半。然而，如果我们不考虑年龄，将数据直接合并：

- 总接种者：$900+100=1000$人，总发病 $90+1=91$人，粗风险为 $9.1\%$。
- 总未接种者：$100+900=1000$人，总发病 $20+18=38$人，粗风险为 $3.8\%$。

计算粗风险比 $RR_{\text{crude}} = 0.091 / 0.038 \approx 2.39$。这个结果表明，接种疫苗的人风险反而是未接种者的2.39倍！

悖论的产生是因为**年龄**是一个强大的混杂因素。首先，年龄与结局（伤寒风险）相关（老年人风险更高）。其次，年龄与暴露（疫苗接种）相关（在这个假设中，高风险的老年人更倾向于接种疫苗，接种率$90\%$；而低风险的年轻人接种率仅$10\%$）。由于接种组中不成比例地聚集了大量高风险的老年人，而未接种组中则聚集了大量低风险的年轻人，这使得在粗略比较时，接种组的整体风险被不公平地拉高了。

这个例子揭示了，为了得到无偏的估计，必须对混杂因素进行**控制**。**分层分析（Stratification）**，即在混杂因素的不同水平内部分别计算关联，是控制混杂的基本方法之一。通过分层，我们恢复了疫苗的真实保护效应。

#### 选择偏倚与测量偏倚

**偏倚**是研究设计或实施过程中的系统性错误，导致对关联的估计偏离真实值。偏倚的类型多种多样，以下是两个在流行病学研究中尤为重要的例子。

**幸存者偏倚（Survivor Bias）** 是一种常见的选择偏倚，当我们的研究对象仅限于某个过程的“幸存者”时，就可能发生。在卫生监测中，仅依赖于医疗机构报告的数据来估算疾病发病率时，这个问题尤为突出 [@problem_id:4977454]。例如，在对一种农村地区的急性发热性疾病进行监测时，仅统计医院就诊的病患会遗漏两类重要人群：病情极其严重，在到达医院前就不幸死亡的患者；以及病情较轻，选择在家自愈而未寻求医疗服务的患者。这两类人群的系统性缺失，会导致对真实发病率的严重低估。一个更准确的估计，需要结合多种数据来源，如通过“死因推断（Verbal Autopsy）”来识别社区中的相关死亡病例，并通过社区卫生工作者进行主动病例搜索来发现未就诊的轻症病例。将这三部分（医院病例、社区死亡、社区轻症）的数据整合，才能得到一个更接近真实情况的发病率。

**“不朽时间”偏倚（Immortal Time Bias）** 是在[观察性研究](@entry_id:174507)中，尤其是在药物流行病学中，一种更为微妙的选择偏倚 [@problem_id:4977410]。当暴露（如开始服用某种药物）是在随访开始后某个时间点才发生时，如果分析时错误地将该个体从随访第一天起就划分为“暴露组”，就会产生这种偏倚。从随访开始到实际接受暴露的这段时间，该个体必须保持“存活”状态才能最终成为暴露者，这段时间因此被称为“不朽时间”。将这段零风险的“不朽时间”错误地计入暴露组的总人时数中，会人为地拉低暴露组的发病率，从而错误地高估暴露的保护效应（或低估其有害效应）。

正确的处理方法是将暴露视为一个**随时间变化的变量（time-varying covariate）**。在分析中，同一个体的随访时间需要被“切割”：在接受暴露之前，其贡献的人时数属于“非暴露组”；在接受暴露之后，其贡献的人时数才属于“暴露组”。通过这种动态的风险集划分，可以消除“不朽时间”偏倚，得到对关联的更准确估计。

### 从关联到因果：一个形式化的框架

流行病学研究的最终目标往往是进行因果推断。然而，我们计算出的关联强度（如RR, OR）本身只是统计关系，并不等同于因果关系。为了从关联跨越到因果，我们需要一个更严谨的理论框架。现代流行病学广泛采用**潜在结局框架（Potential Outcomes Framework）** 来形式化地定义和思考因果效应。

在这个框架下，我们为每个个体定义其在不同暴露水平下的潜在结局 [@problem_id:4977412]。假设我们研究疫苗（$A=1$）与未接种疫苗（$A=0$）对某感染病的影响。对于每个个体 $i$，我们设想存在两个潜在结局：$Y_i^1$ 是该个体如果接种了疫苗（即暴露水平被设定为 $a=1$）将会发生的结局；$Y_i^0$ 则是该个体如果未接种疫苗（即暴露水平被设定为 $a=0$）将会发生的结局。

**因果效应（Causal Effect）** 被定义为同一个体或同一人群在不同暴露水平下潜在结局的对比。例如，个体的因果效应可以是 $Y_i^1 - Y_i^0$。人群的平均因果效应，如**因果风险比（Causal Risk Ratio）**，可以定义为：

$RR_{\text{causal}} = \frac{P(Y^1=1)}{P(Y^0=1)} = \frac{E[Y^1]}{E[Y^0]}$

这里的 $P(Y^a=1)$ 是指如果整个人群的暴露都被设定为 $a$ 时，将会出现的发病风险（即反事实的累积发病率）。

然而，现实中我们面临着“因果推断的根本问题”：对任何一个个体，我们只能观察到其在一个暴露水平下的结局（即他实际接受的那个暴露下的结局），其反事实的结局是永远无法观测的。那么，我们如何从观察数据中估计出这些基于反事实的因果效应呢？这需要依赖于三个关键的、通常无法被完全验证的**可识别性假设（Identifiability Assumptions）**：

1.  **一致性（Consistency）**：一个个体观察到的结局，就是其在所接受的暴露水平下的潜在结局。即，如果一个个体实际接受了暴露 $A=a$，那么他被观察到的结局 $Y$ 就等于其潜在结局 $Y^a$。这个假设将我们能看到的数据与我们想知道的潜在结局联系起来。

2.  **可交换性（Exchangeability）** 或称 **无混杂（No Confounding）**：暴露组与非暴露组是“可交换”的，即除了所接受的暴露不同之外，两组在其他所有影响结局的特征上都是可比的。更严格地讲，在控制了所有重要的基线混杂因素 $L$ 之后，潜在结局与实际接受的暴露是独立的 ($Y^a \perp A \mid L$)。这意味着，在具有相同特征 $L$ 的人群中，个体最终是接受暴露还是不接受暴露，与其潜在的疾病风险无关。随机对照试验通过随机化过程，试图在期望上实现组间的无条件[可交换性](@entry_id:263314)。在[观察性研究](@entry_id:174507)中，我们通过统计方法（如分层、匹配、回归）控制已知的混杂因素 $L$，来尽可能地逼近条件可交换性。

3.  **正定性（Positivity）** 或称 **实验性处理分配（Experimental Treatment Assignment）**：在研究人群的每个由协变量 $L$ 定义的亚层中，都存在接受不同暴露水平的个体。即，对于任何特征组 $L=l$，都有 $0  P(A=1 \mid L=l)  1$。这个假设保证了在每个亚层内，我们都有进行比较的基础。

当这三个假设成立时，我们观察到的关联度量（经过对混杂因素的适当调整后）就可以被解释为对因果效应的一致估计。本章所讨论的各种流行病学方法——无论是精确定义疾病频率，还是通过严谨的研究设计和统计分析来控制混杂和偏倚——其最终目的，都是为了尽可能地满足这些假设，从而使我们能够从观察数据中，得出关于因果关系的有效结论。