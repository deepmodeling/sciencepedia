{"hands_on_practices": [{"introduction": "有效的监测是全球卫生安全的基石。然而，一个监测系统能否成功捕获疫情暴发的信号，取决于多种因素的相互作用。本练习 [@problem_id:4979160] 将指导你建立一个基础概率模型，用于评估监测系统的效能。通过这个模型，你将学会如何从基本原理出发，量化病例数、样本覆盖率和检测灵敏度等关键参数如何共同决定我们发现疫情的可能性。", "problem": "《国际卫生条例》（IHR）的一个缔约国维持着一个国家早期预警监测系统，以发现新型呼吸道传染病的暴发。考虑一次暴发，在规定需要报告的病例发现窗口期内，恰好产生了 $n$ 名感染者。对于每位感染者，以下条件成立：\n\n- 监测系统在该窗口期内成功从该个体获取诊断样本的概率为 $q$（即样本覆盖率）。\n- 在成功采样的条件下，实验室诊断检测的灵敏度为 $s$，即对于真实感染者，检测得出真阳性结果的概率为 $s$。\n- 不同个体间的采样事件和检测结果是相互独立的，并且在真实感染的条件下，采样过程和检测性能是独立的。为触发初始暴发信号，假定假阳性可以忽略不计，因此，一次发现要求至少有 $1$ 例来自真实感染者的真阳性检测结果。\n\n如果在该窗口期内，$n$ 名感染者中至少有 $1$ 例真阳性检测结果，则监测系统宣布已发现该暴发。\n\n请仅从独立伯努利试验和补事件的基本概率法则出发，推导出监测系统发现暴发的概率的精确表达式，该表达式应为 $n$、$q$ 和 $s$ 的函数。将您的最终答案表示为关于 $n$、$q$ 和 $s$ 的单一、简化的解析表达式。不要代入任何数值，最终表达式中也不要包含任何单位。无需进行四舍五入。", "solution": "本题要求推导涉及 $n$ 名个体的疾病暴发被发现的概率。监测系统的发现标准和概率参数已经给出。推导过程必须从基本原理出发。\n\n我们首先针对从 $n$ 名感染者群体中任意选择的单个感染者，定义相关事件及其概率。\n\n设 $S$ 为成功从该感染者获取诊断样本的事件。题目指出该事件的概率（代表样本覆盖率）为：\n$$ P(S) = q $$\n\n设 $T$ 为诊断检测得出阳性结果的事件。题目规定检测的灵敏度 $s$ 为，在从真实感染者处获得样本的条件下，检测得出真阳性结果的概率。这可以写作：\n$$ P(T | S) = s $$\n\n当且仅当从某个体处获得了样本“并且”随后的检测产生了阳性结果时，该个体才被监测系统视为“已发现”。设 $D$ 为发现此单个体的事件。事件 $D$ 是事件 $S$ 和 $T$ 的交集。事件 $D$ 的概率（记为 $p$）可利用条件概率的定义 $P(A \\cap B) = P(A|B)P(B)$ 计算：\n$$ p = P(D) = P(T \\cap S) = P(T|S)P(S) $$\n代入给定的概率，我们发现发现单个感染者的概率是：\n$$ p = s \\cdot q $$\n\n确定 $n$ 名感染者中的每一位是否被发现的过程，可以建模为一系列 $n$ 次独立的伯努利试验。对于每次试验（即对于每个个体 $i = 1, 2, \\dots, n$），有两种可能的结果：\n1.  **成功**：该个体被发现。此情况发生的概率为 $p = sq$。\n2.  **失败**：该个体未被发现。此情况发生的概率为 $1 - p = 1 - sq$。\n\n题目说明，针对不同个体的事件是独立的。\n\n如果 $n$ 名感染者中至少有 $1$ 例真阳性检测结果，则暴发被宣布为“已发现”。设 $D_{outbreak}$ 为暴发被发现的事件。这对应于在 $n$ 次伯努利试验中至少有一次“成功”。\n\n直接计算“至少一次”成功的概率，将涉及把恰好 $1$ 次成功、恰好 $2$ 次成功，直至 $n$ 次成功的概率加起来。一种更直接的方法，如题目所提示，是使用补事件法则。\n\n事件 $D_{outbreak}$ 的补事件是暴发未被发现，我们将其記为 $D_{outbreak}^c$。当且仅当在所有 $n$ 名个体中发现数为零时，暴发才算未被发现。这意味着对于 $n$ 名个体中的每一位，伯努利试验的结果都是“失败”。\n\n单次试验失败（即单个个体未被发现）的概率是 $1 - sq$。\n\n由于所有 $n$ 名个体的试验都是独立的，因此所有 $n$ 次试验都失败的概率是它们各自概率的乘积：\n$$ P(D_{outbreak}^c) = \\prod_{i=1}^{n} P(\\text{individual } i \\text{ is not detected}) $$\n$$ P(D_{outbreak}^c) = (1 - sq)^n $$\n\n事件 $D_{outbreak}$ 的概率是 $1$ 减去其补事件 $D_{outbreak}^c$ 的概率。\n$$ P(D_{outbreak}) = 1 - P(D_{outbreak}^c) $$\n代入 $P(D_{outbreak}^c)$ 的表达式，我们得到发现暴发的概率的最终表达式：\n$$ P(D_{outbreak}) = 1 - (1 - sq)^n $$\n\n该表达式给出了暴发发现概率，它是关于感染人数 $n$、样本覆盖率 $q$ 和检测灵敏度 $s$ 的函数。", "answer": "$$\n\\boxed{1 - (1 - sq)^{n}}\n$$", "id": "4979160"}, {"introduction": "当监测系统发出警报时，国家卫生主管部门面临一个关键抉择：是否应根据《国际卫生条例》向世界卫生组织通报？这个决定充满不确定性，因为信号可能是假警报。本练习 [@problem_id:4979148] 引入了一个基于贝叶斯定理的决策分析框架，让你权衡证据和不同错误（漏报和误报）的潜在代价，从而学习如何做出理性的、有数据支持的通报决策。", "problem": "一个国家的公共卫生主管机构必须决定是否根据《国际卫生条例》（IHR）向世界卫生组织（WHO）通报一个新发现的疫情信号。该机构将此情况建模为一个二元状态：事件要么确实符合IHR通报标准（状态 $H$），要么不符合（状态 $\\neg H$）。在观察到任何信号之前，该机构对于此类事件符合IHR通报标准的先验信念为 $P(H) = 0.20$。用于辅助决策的监测信号的特征为：灵敏度为 $0.70$（当 $H$ 为真时信号为阳性的概率），特异度为 $0.85$（当 $\\neg H$ 为真时信号为阴性的概率）。该机构观察到一个阳性信号。\n\n该机构使用一个基于人群健康影响的非对称损失函数，该影响以伤残调整生命年（DALYs）衡量。其中，$L_{FN}$ 是假阴性（当 $H$ 为真时不通報）造成的损失，$L_{FP}$ 是假阳性（当 $\\neg H$ 为真时通报）造成的损失。假设 $L_{FN} = 1000$ 且 $L_{FP} = 40$，并且正确分类状态不产生损失。将一个行动的遗憾值定义为仅当该行动与真实状态不符时所产生的损失。使用概率和贝叶斯定理的基本定义，计算在观察到阳性信号的条件下，“通报”和“不通报”的期望遗憾值，并将这两个期望遗憾值的最小值作为该决策问题的错分风险进行报告。\n\n将您的最终答案四舍五入到四位有效数字。以伤残调整生命年（DALYs）为单位表示您的最终答案。", "solution": "我们从条件概率和贝叶斯定理的基本定义开始。设 $H$ 表示事件确实符合《国际卫生条例》（IHR）的通报标准的状态，设 $S$ 表示监测信号。先验概率为 $P(H) = 0.20$，因此 $P(\\neg H) = 1 - P(H) = 0.80$。信号的灵敏度为 $P(S=+ \\mid H) = 0.70$，特异度为 $P(S=- \\mid \\neg H) = 0.85$，这意味着假阳性率为 $P(S=+ \\mid \\neg H) = 1 - 0.85 = 0.15$。\n\n在观察到阳性信号后，我们使用贝叶斯定理更新事件确实需要通报的概率：\n$$\nP(H \\mid S=+) = \\frac{P(S=+ \\mid H) P(H)}{P(S=+ \\mid H) P(H) + P(S=+ \\mid \\neg H) P(\\neg H)}.\n$$\n代入给定的数值，\n$$\nP(H \\mid S=+) = \\frac{0.70 \\times 0.20}{0.70 \\times 0.20 + 0.15 \\times 0.80} = \\frac{0.14}{0.14 + 0.12} = \\frac{0.14}{0.26}.\n$$\n因此，\n$$\nP(H \\mid S=+) = \\frac{14}{26} = \\frac{7}{13} \\approx 0.538461538.\n$$\n因此，事件不需要通报的后验概率是\n$$\nP(\\neg H \\mid S=+) = 1 - P(H \\mid S=+) = 1 - \\frac{7}{13} = \\frac{6}{13} \\approx 0.461538462.\n$$\n\n根据错分定义损失函数：如果主管机构在 $\\neg H$ 为真时选择通报，产生的损失为 $L_{FP} = 40$。如果主管机构在 $H$ 为真时选择不通报，产生的损失为 $L_{FN} = 1000$。正确的分类不产生损失。在 $S=+$ 的条件下，每个行动的期望遗憾值（在此仅考虑错分的损失函数下，其值等于期望损失）是通过计算损失相对于 $H$ 的后验分布的期望值得到的。\n\n对于“通报”这一行动，只有当 $\\neg H$ 为真时才会产生遗憾值。因此，“通报”的期望遗憾值为\n$$\n\\mathbb{E}[\\text{regret} \\mid \\text{notify}, S=+] = P(\\neg H \\mid S=+) \\times L_{FP} = \\frac{6}{13} \\times 40 = \\frac{240}{13}.\n$$\n计算其值：\n$$\n\\frac{240}{13} \\approx 18.46153846.\n$$\n\n对于“不通报”这一行动，只有当 $H$ 为真时才会产生遗憾值。因此，“不通报”的期望遗憾值为\n$$\n\\mathbb{E}[\\text{regret} \\mid \\text{do not notify}, S=+] = P(H \\mid S=+) \\times L_{FN} = \\frac{7}{13} \\times 1000 = \\frac{7000}{13}.\n$$\n计算其值：\n$$\n\\frac{7000}{13} \\approx 538.4615385.\n$$\n\n因此，该决策问题的错分风险（定义为两个期望遗憾值中的最小值）是\n$$\n\\min\\left(\\frac{240}{13}, \\frac{7000}{13}\\right) = \\frac{240}{13} \\approx 18.46153846.\n$$\n\n按要求四舍五入到四位有效数字，最终值为\n$$\n18.46.\n$$\n这个量代表了在观察到阳性信号的条件下，该决策的最小期望遗憾值，以伤残调整生命年（DALYs）为单位。", "answer": "$$\\boxed{18.46}$$", "id": "4979148"}, {"introduction": "《国际卫生条例》强调，公共卫生应对措施（如旅行限制）的强度必须与风险相称，并应“对国际交通和贸易的限制达到最低程度”。但如何在实践中量化并找到这一“相称”的平衡点呢？本练习 [@problem_id:4979149] 构建了一个简化模型，通过权衡减少病例输入带来的公共卫生收益与限制措施造成的经济成本，来求解最优的政策强度。它让你亲身体验如何运用优化原理，为“比例原则”这一核心概念赋予精确的量化意义。", "problem": "一个根据《国际卫生条例》（IHR）运作的国家主管部门，正在为一种具有国际传播潜力的新发传染病的早期阶段寻求一种相称的、限制最少的边境政策。设政策严格度由一个无量纲的强度变量 $x \\in [0,1]$ 表示，其中 $x=0$ 表示无额外限制，$x=1$ 表示在操作约束下被认为可行的最严格限制。以下基本要素被视为给定，具有科学依据，并与微观经济福利分析和流行病学输入风险一致：\n\n- 在无额外限制的情况下，单位时间内的基线预期受感染旅客输入数量为 $\\lambda_{0}  0$。\n- 跨境流动的经验规律表明，边境摩擦会以乘法方式减少流量；将其建模为输入强度的指数级减少：当限制强度为 $x$ 时，预期输入率为 $\\lambda(x) = \\lambda_{0}\\exp(-\\alpha x)$，其中 $\\alpha0$ 衡量限制对流动性的影响强度。\n- 每次输入性感染产生的预期货币化社会损失为 $L0$（包括发病、死亡和应对成本），并假定在早期阶段该损失与预期输入数量成局部线性关系。\n- 贸易和旅行限制会非线性地扰乱经济活动；设国际贸易中断造成的货币化损失为 $C(x)=\\frac{c}{\\alpha}\\left(\\exp(\\alpha x)-1\\right)$，其中 $c0$，确保 $C(0)=0$ 且函数对 $x$ 是凸的。\n\n将一个固定短期决策期内，限制强度为 $x$ 时与福利相关的净收益定义为 $W(x) = B(x)-C(x)$，其中 $B(x)$ 是相对于 $x=0$ 时通过限制所避免的预期损害，即 $B(x)=L\\left(\\lambda_{0}-\\lambda(x)\\right)$。\n\n仅使用这些基本要素和优化理论的第一性原理（即，一个二阶可微目标函数的内部最大值点满足一阶条件，且二阶条件确认其为最大值），完成以下任务：\n\n- 推导边际收益函数 $MB(x)$ 和边际成本函数 $MC(x)$。\n- 在最优策略是位于 $(0,1)$ 区间内的内部解的假设下，求出使 $W(x)$ 最大化的最优严格度 $x^{\\ast}$ 的闭式表达式。\n\n将最终答案表示为关于 $\\lambda_{0}$、$\\alpha$、$L$ 和 $c$ 的单一精确解析表达式。无需四舍五入。$x$ 是无量纲的，因此最终答案中不要包含单位。", "solution": "问题陈述经评估有效。其科学依据建立在公认的流行病学和经济学建模原则之上，问题本身是适定的，目标明确，信息充分，并使用客观、正式的语言。这是一个标准的优化问题，没有矛盾、歧义或其他缺陷。因此，我将开始推导解答。\n\n目标是找到使净收益函数 $W(x)$ 最大化的最优限制强度 $x^{\\ast}$。净收益定义为限制带来的收益 $B(x)$ 与限制带来的成本 $C(x)$ 之差。\n净收益函数由 $W(x) = B(x) - C(x)$ 给出。\n\n收益 $B(x)$ 是实施限制强度 $x$ 相对于无限制基线（$x=0$）所避免的预期损害。其表达式为 $B(x) = L(\\lambda_0 - \\lambda(x))$，其中 $L$ 是每次输入性感染的货币化社会损失，$\\lambda_0$ 是基线输入率，$\\lambda(x)$ 是在限制强度为 $x$ 时的输入率。代入给定的表达式 $\\lambda(x) = \\lambda_0 \\exp(-\\alpha x)$，我们得到：\n$$B(x) = L(\\lambda_0 - \\lambda_0 \\exp(-\\alpha x)) = L\\lambda_0(1 - \\exp(-\\alpha x))$$\n\n成本 $C(x)$ 是由贸易和旅行中断造成的货币化损失，由以下公式给出：\n$$C(x) = \\frac{c}{\\alpha}(\\exp(\\alpha x) - 1)$$\n其中 $c0$ 和 $\\alpha0$ 是参数。\n\n因此，需要被最大化的完整福利函数是：\n$$W(x) = L\\lambda_0(1 - \\exp(-\\alpha x)) - \\frac{c}{\\alpha}(\\exp(\\alpha x) - 1)$$\n\n第一个任务是推导边际收益 $MB(x)$ 和边际成本 $MC(x)$。它们分别是收益函数和成本函数关于 $x$ 的一阶导数。\n\n边际收益是：\n$$MB(x) = \\frac{dB}{dx} = \\frac{d}{dx} \\left[ L\\lambda_0(1 - \\exp(-\\alpha x)) \\right]$$\n应用微分链式法则，我们得到：\n$$MB(x) = L\\lambda_0(0 - \\exp(-\\alpha x) \\cdot (-\\alpha)) = L\\lambda_0\\alpha\\exp(-\\alpha x)$$\n\n边际成本是：\n$$MC(x) = \\frac{dC}{dx} = \\frac{d}{dx} \\left[ \\frac{c}{\\alpha}(\\exp(\\alpha x) - 1) \\right]$$\n求导后，我们发现：\n$$MC(x) = \\frac{c}{\\alpha}(\\exp(\\alpha x) \\cdot \\alpha - 0) = c\\exp(\\alpha x)$$\n\n第二个任务是找到使 $W(x)$ 最大化的最优严格度 $x^{\\ast}$。根据优化原理，一个二阶可微函数的内部最大值点必须满足一阶条件（FOC），即函数的一阶导数为零。\n福利函数的一阶导数是：\n$$\\frac{dW}{dx} = \\frac{d}{dx}(B(x) - C(x)) = MB(x) - MC(x)$$\n在最优点 $x = x^{\\ast}$ 处将其设为零：\n$$\\frac{dW}{dx}\\bigg|_{x=x^{\\ast}} = MB(x^{\\ast}) - MC(x^{\\ast}) = 0$$\n这就得出了经典的经济均衡条件：边际收益等于边际成本。\n$$MB(x^{\\ast}) = MC(x^{\\ast})$$\n代入 $MB(x)$ 和 $MC(x)$ 的表达式：\n$$L\\lambda_0\\alpha\\exp(-\\alpha x^{\\ast}) = c\\exp(\\alpha x^{\\ast})$$\n\n我们现在求解这个方程以得到 $x^{\\ast}$。已知所有参数 $L, \\lambda_0, \\alpha, c$ 均为正数。\n首先，我们整理包含 $x^{\\ast}$ 的项。将等式两边同除以 $c$，再同乘以 $\\exp(\\alpha x^{\\ast})$：\n$$\\frac{L\\lambda_0\\alpha}{c} = \\frac{\\exp(\\alpha x^{\\ast})}{\\exp(-\\alpha x^{\\ast})} = \\exp(\\alpha x^{\\ast} - (-\\alpha x^{\\ast})) = \\exp(2\\alpha x^{\\ast})$$\n为了解出 $x^{\\ast}$，我们对等式两边取自然对数：\n$$\\ln\\left(\\frac{L\\lambda_0\\alpha}{c}\\right) = \\ln(\\exp(2\\alpha x^{\\ast}))$$\n$$\\ln\\left(\\frac{L\\lambda_0\\alpha}{c}\\right) = 2\\alpha x^{\\ast}$$\n最后，分离出 $x^{\\ast}$ 得到最优严格度的闭式表达式：\n$$x^{\\ast} = \\frac{1}{2\\alpha} \\ln\\left(\\frac{L\\lambda_0\\alpha}{c}\\right)$$\n\n为确认此驻点确实是一个最大值点，我们检查二阶条件（SOC），该条件要求 $\\frac{d^2W}{dx^2}  0$。\n$$\\frac{d^2W}{dx^2} = \\frac{d}{dx}(MB(x) - MC(x)) = \\frac{d}{dx}(L\\lambda_0\\alpha\\exp(-\\alpha x) - c\\exp(\\alpha x))$$\n$$\\frac{d^2W}{dx^2} = -L\\lambda_0\\alpha^2\\exp(-\\alpha x) - c\\alpha\\exp(\\alpha x)$$\n鉴于 $L  0$、$\\lambda_0  0$、$\\alpha  0$ 和 $c  0$，且指数函数恒为正，二阶导数表达式中的两项均为负。因此，对于所有 $x$，$\\frac{d^2W}{dx^2}  0$。这证实了福利函数 $W(x)$ 是严格凹的，我们推导出的 $x^{\\ast}$ 对应一个唯一的全局最大值。问题假设参数使得 $x^{\\ast} \\in (0,1)$，因此该表达式即为所求的内部解。", "answer": "$$\\boxed{\\frac{1}{2\\alpha}\\ln\\left(\\frac{L\\lambda_{0}\\alpha}{c}\\right)}$$", "id": "4979149"}]}