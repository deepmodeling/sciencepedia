{"hands_on_practices": [{"introduction": "要掌握糖尿病全球流行的规模，我们首先必须学会如何衡量它。本练习将探讨“时点患病率”这一流行病学基本指标，它告诉我们在特定时间点受疾病影响的人群比例。通过一个假设性调查的数据[@problem_id:4972716]，您不仅将计算患病率的点估计值，还将学习使用置信区间来量化其不确定性，这是解读公共卫生数据的一项关键技能。", "problem": "在一项旨在监测糖尿病这一全球流行病的全国代表性横断面调查中，从一个大总体中抽取了一个由 $n=2000$ 名成年人组成的简单随机样本。其中，有 $x=300$ 人报告经医生诊断患有糖尿病。使用核心定义，即时点患病率是在特定时间点总体中患有该疾病的个体所占的比例，并使用样本比例的中心极限定理 (CLT) 作为区间估计的基础近似方法，解决以下问题：\n\n1. 使用观测数据 $(x,n)$ 计算糖尿病患病率的点估计值 $\\hat{p}$。\n2. 从样本比例的中心极限定理和与 $0.95$ 双侧置信水平对应的标准正态分布分位数出发，推导真实总体患病率 $p$ 的双侧Wald置信区间，不假设任何有限总体校正。\n3. 根据您推导出的区间，计算其总长度 $L$（上界减去下界）。\n\n仅报告区间长度 $L$ 作为您的最终答案。将您报告的 $L$ 四舍五入到四位有效数字，并以小数比例表示（例如，使用 $0.12$ 而不是百分比）。", "solution": "本题要求计算真实总体糖尿病患病率 $p$ 的双侧 $95\\%$ 置信区间的总长度 $L$。所提供的数据来自一个大小为 $n=2000$ 的简单随机样本，其中发现有 $x=300$ 人经医生诊断患有糖尿病。所使用的方法是Wald置信区间，该方法依赖于样本比例的中心极限定理 (CLT) 近似。\n\n首先，我们计算总体患病率的点估计值，记为 $\\hat{p}$。该估计值是患有该疾病的个体的样本比例。\n$$ \\hat{p} = \\frac{x}{n} $$\n代入给定值 $x=300$ 和 $n=2000$：\n$$ \\hat{p} = \\frac{300}{2000} = \\frac{3}{20} = 0.15 $$\n\n接下来，我们建立总体比例 $p$ 的双侧Wald置信区间的公式。根据中心极限定理，对于足够大的样本量 $n$，样本比例 $\\hat{p}$ 的抽样分布近似为正态分布。该分布的均值是真实总体比例 $p$，其标准差（称为比例的标准误）为 $SE(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}}$。\n\nWald区间的构建方法是用点估计值 $\\hat{p}$ 代替未知的 $p$ 来近似该标准误。估计的标准误 $\\widehat{SE}(\\hat{p})$ 为：\n$$ \\widehat{SE}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n$p$ 的双侧置信区间的通用公式由点估计值加减误差范围给出：\n$$ \\text{CI} = \\hat{p} \\pm z_{\\alpha/2} \\cdot \\widehat{SE}(\\hat{p}) $$\n这里，$z_{\\alpha/2}$ 是来自标准正态分布的临界值，对应于 $1-\\alpha$ 的置信水平。\n\n题目指定了 $0.95$ 的置信水平。这意味着显著性水平为 $\\alpha = 1 - 0.95 = 0.05$。对于双侧区间，临界值由 $\\alpha/2 = 0.05/2 = 0.025$ 确定。分位数 $z_{0.025}$ 是这样一个值，使得标准正态分布上尾的面积为 $0.025$。从标准统计表中，该值为：\n$$ z_{0.025} \\approx 1.96 $$\n\n置信区间由其下界 (LB) 和上界 (UB) 定义：\n$$ \\text{LB} = \\hat{p} - z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n$$ \\text{UB} = \\hat{p} + z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n\n置信区间的总长度 $L$ 是上界和下界之差：\n$$ L = \\text{UB} - \\text{LB} $$\n$$ L = \\left( \\hat{p} + z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\right) - \\left( \\hat{p} - z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\right) $$\n通过简化该表达式，我们发现长度是误差范围的两倍：\n$$ L = 2 \\cdot z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n\n我们现在将数值代入此公式以计算 $L$：\n-   $z_{\\alpha/2} = z_{0.025} \\approx 1.96$\n-   $\\hat{p} = 0.15$\n-   $n = 2000$\n\n$$ L = 2 \\times 1.96 \\times \\sqrt{\\frac{0.15 \\times (1 - 0.15)}{2000}} $$\n$$ L = 3.92 \\times \\sqrt{\\frac{0.15 \\times 0.85}{2000}} $$\n$$ L = 3.92 \\times \\sqrt{\\frac{0.1275}{2000}} $$\n$$ L = 3.92 \\times \\sqrt{0.00006375} $$\n我们进行数值计算：\n$$ \\sqrt{0.00006375} \\approx 0.0079843596... $$\n$$ L \\approx 3.92 \\times 0.0079843596... $$\n$$ L \\approx 0.03129988... $$\n\n题目要求最终答案四舍五入到四位有效数字。$L$ 的前四位有效数字是 $3$、$1$、$2$ 和 $9$。第五位有效数字是 $9$，这意味着我们必须将第四位有效数字向上舍入。将 $0.03129$ 向上舍入得到 $0.03130$。末尾的零是有效数字，对于表示四位有效数字的精度是必需的。\n$$ L \\approx 0.03130 $$", "answer": "$$\\boxed{0.03130}$$", "id": "4972716"}, {"introduction": "识别未被诊断的糖尿病患者是公共卫生应对的基石，但我们的筛查工具有多好用呢？本练习将深入探讨用于评估诊断测试的基本指标，如灵敏度、特异度和预测值。您将发现一个至关重要且往往有悖直觉的原则[@problem_id:4972665]：一个测试在现实世界中的表现，在很大程度上取决于被筛查人群中的疾病患病率。", "problem": "一个公共卫生团队正在评估一项用于城市成年人群中2型糖尿病（T2DM）的单阈值糖化血红蛋白（HbA1c）筛查测试。该测试的灵敏度为 $0.80$，特异度为 $0.90$。目标人群中T2DM的点患病率为 $0.10$。仅使用诊断测试性能的核心定义和标准概率定律（包括全概率定律和贝叶斯定理），从第一性原理推导出计算阳性预测值和阴性预测值所需的表达式。然后，根据这些参数，数值计算灵敏度、特异度、阳性预测值和阴性预测值。最后，使用您推导的表达式和形式化推理，解释为什么阳性预测值会随患病率变化，以及这对于全球健康中的筛查政策为何重要。以（灵敏度、特异度、阳性预测值、阴性预测值）的顺序，以小数形式报告您的四个最终数值，并将每个数值四舍五入到四位有效数字。在您的回答中不要使用任何百分号。", "solution": "首先，我们根据问题陈述定义相关事件和概率。\n令 $D$ 表示个体患有2型糖尿病（T2DM）的事件。\n令 $\\bar{D}$ 表示个体未患有T2DM的事件。\n令 $T$ 表示筛查测试结果为阳性的事件。\n令 $\\bar{T}$ 表示筛查测试结果为阴性的事件。\n\n给定条件可以用概率术语表示：\nT2DM的患病率是患有该疾病的概率，即 $P(D)$。\n$$P(D) = 0.10$$\n测试的灵敏度是在个体患有该疾病的条件下，测试结果为阳性的概率，即 $P(T|D)$。\n$$P(T|D) = 0.80$$\n测试的特异度是在个体未患有该疾病的条件下，测试结果为阴性的概率，即 $P(\\bar{T}|\\bar{D})$。\n$$P(\\bar{T}|\\bar{D}) = 0.90$$\n\n我们也可以定义互补事件的概率：\n未患病的概率是 $P(\\bar{D})$。\n$$P(\\bar{D}) = 1 - P(D) = 1 - 0.10 = 0.90$$\n假阴性的概率是 $P(\\bar{T}|D)$。\n$$P(\\bar{T}|D) = 1 - P(T|D) = 1 - 0.80 = 0.20$$\n假阳性的概率是 $P(T|\\bar{D})$。\n$$P(T|\\bar{D}) = 1 - P(\\bar{T}|\\bar{D}) = 1 - 0.90 = 0.10$$\n\n问题要求我们从第一性原理推导阳性预测值（PPV）和阴性预测值（NPV）的表达式。\n\n阳性预测值 $P(D|T)$ 是在测试结果为阳性的条件下，个体患有该疾病的概率。使用贝叶斯定理：\n$$P(D|T) = \\frac{P(T|D) P(D)}{P(T)}$$\n为了求分母 $P(T)$，我们使用全概率定律：\n$$P(T) = P(T|D)P(D) + P(T|\\bar{D})P(\\bar{D})$$\n将此代入PPV的贝叶斯定理表达式，得到其以初始参数表示的完整形式：\n$$P(D|T) = \\frac{P(T|D)P(D)}{P(T|D)P(D) + P(T|\\bar{D})P(\\bar{D})}$$\n象征性地，如果我们令 $s_e$ 为灵敏度，$s_p$ 为特异度，$p$ 为患病率，则表达式为：\n$$PPV = \\frac{s_e \\cdot p}{s_e \\cdot p + (1 - s_p)(1 - p)}$$\n\n阴性预测值 $P(\\bar{D}|\\bar{T})$ 是在测试结果为阴性的条件下，个体未患有该疾病的概率。使用贝叶斯定理：\n$$P(\\bar{D}|\\bar{T}) = \\frac{P(\\bar{T}|\\bar{D}) P(\\bar{D})}{P(\\bar{T})}$$\n为了求分母 $P(\\bar{T})$，我们再次使用全概率定律：\n$$P(\\bar{T}) = P(\\bar{T}|D)P(D) + P(\\bar{T}|\\bar{D})P(\\bar{D})$$\n将此代入NPV的贝叶斯定理表达式，得到其完整形式：\n$$P(\\bar{D}|\\bar{T}) = \\frac{P(\\bar{T}|\\bar{D})P(\\bar{D})}{P(\\bar{T}|D)P(D) + P(\\bar{T}|\\bar{D})P(\\bar{D})}$$\n用灵敏度、特异度和患病率表示：\n$$NPV = \\frac{s_p \\cdot (1-p)}{(1 - s_e) \\cdot p + s_p (1 - p)}$$\n\n现在，我们计算数值。\n灵敏度给定为 $0.80$。\n特异度给定为 $0.90$。\n\n为计算阳性预测值，我们首先计算 $P(T)$：\n$$P(T) = (0.80)(0.10) + (0.10)(0.90) = 0.08 + 0.09 = 0.17$$\n那么，PPV为：\n$$P(D|T) = \\frac{P(T|D) P(D)}{P(T)} = \\frac{(0.80)(0.10)}{0.17} = \\frac{0.08}{0.17} \\approx 0.470588...$$\n\n为计算阴性预测值，我们首先计算 $P(\\bar{T})$：\n$$P(\\bar{T}) = P(\\bar{T}|D)P(D) + P(\\bar{T}|\\bar{D})P(\\bar{D}) = (0.20)(0.10) + (0.90)(0.90) = 0.02 + 0.81 = 0.83$$\n那么，NPV为：\n$$P(\\bar{D}|\\bar{T}) = \\frac{P(\\bar{T}|\\bar{D}) P(\\bar{D})}{P(\\bar{T})} = \\frac{(0.90)(0.90)}{0.83} = \\frac{0.81}{0.83} \\approx 0.975903...$$\n\n将四个值四舍五入到四位有效数字：\n灵敏度：$0.8000$\n特异度：$0.9000$\n阳性预测值 (PPV)：$0.4706$\n阴性预测值 (NPV)：$0.9759$\n\n最后，我们解释为什么PPV随患病率变化及其对政策的重要性。\n推导出的PPV表达式为：\n$$PPV(p) = \\frac{s_e \\cdot p}{s_e \\cdot p + (1 - s_p)(1 - p)}$$\n其中 $p$ 是患病率。这个方程明确表明PPV是患病率 $p$ 的函数。为了正式证明这种依赖关系，我们可以考察PPV对 $p$ 的导数。使用商法则，可以证明该导数为：\n$$\\frac{d(PPV)}{dp} = \\frac{s_e (1-s_p)}{[s_e p + (1-s_p)(1-p)]^2}$$\n由于灵敏度 $s_e > 0$ 且特异度 $s_p \\le 1$，分子 $s_e(1-s_p)$ 是非负的。分母是一个平方项，所以也是正的。因此，$\\frac{d(PPV)}{dp} \\ge 0$，这证明了阳性预测值是患病率的单调递增函数。对于任何非完美的测试（即 $s_p1$），导数是严格为正的。\n\n这种关系对于全球健康筛查政策至关重要。PPV代表一个测试结果呈阳性的人实际患有该疾病的概率。\n在低患病率人群中，即使是灵敏度和特异度都很高的测试，其PPV也会很低。例如，如果我们将这个相同的测试应用于一个患病率仅为 $0.01$（$1\\%$）的人群，PPV将是：\n$$PPV = \\frac{0.80 \\times 0.01}{0.80 \\times 0.01 + (1-0.90)(1-0.01)} = \\frac{0.008}{0.008 + 0.099} \\approx 0.0748$$\n在这种情况下，不到 $8\\%$ 的阳性测试结果是真阳性。对这样的人群进行筛查会产生大量的假阳性结果，导致不必要的后续诊断测试（这些测试可能成本高昂且具有侵入性）、患者焦虑以及对医疗系统的巨大负担。潜在的危害和成本可能会超过益处。\n相反，在高患病率人群中（例如，一个患病率为 $0.30$ 或 $30\\%$ 的目标高风险群体），PPV会显著增加：\n$$PPV = \\frac{0.80 \\times 0.30}{0.80 \\times 0.30 + (1-0.90)(1-0.30)} = \\frac{0.24}{0.24 + 0.07} \\approx 0.774$$\n在这里，超过 $77\\%$ 的阳性测试结果是真阳性，这使得筛查项目在效率和临床价值上都高得多。\n\n因此，全球健康领域的疾病筛查政策不能“一刀切”。实施筛查项目以及如何实施的决策，必须基于特定目标人群中该疾病的患病率。在低患病率环境中，普遍筛查通常不合适或不具成本效益，而针对高风险群体的靶向筛查是有效公共卫生策略的基石。", "answer": "$$\\boxed{\\begin{pmatrix} 0.8000  0.9000  0.4706  0.9759 \\end{pmatrix}}$$", "id": "4972665"}, {"introduction": "为遏制糖尿病的流行，政府会实施含糖饮料税等政策，但我们如何确定这些政策是否真正有效？本练习将介绍一种来自因果推断领域的强大方法——“双重差分法”，用于在考虑潜在趋势的情况下估计干预措施的真实效果。通过分析一个假设情景[@problem_id:4972737]，您将学习流行病学家如何超越简单的相关性，对公共卫生政策的因果效应做出判断。", "problem": "一家国家公共卫生研究所评估一项全市范围的含糖饮料消费税对人群糖化血红蛋白（HbA1c）的因果效应。糖化血红蛋白是与作为全球流行病的糖尿病相关的慢性高血糖症的一个关键生物标志物。研究人员从一个实施了该税收的治疗城市和一个未实施该税收的对照城市收集了重复横截面数据。对于每个城市，他们计算了平均HbA1c的前后变化。治疗城市显示出前后平均变化为$-0.10\\%$（百分点的绝对减少），而对照城市在同一日历区间内显示出前后平均变化为$+0.02\\%$。假设在每个城市内，测量方案相同且人口构成随时间保持稳定，并采用潜在结果框架下的标准平行趋势假设。\n\n从潜在结果和平行趋势假设的核心因果推断定义出发（不使用任何未引入的快捷公式），推导出适用于该税收对平均HbA1c影响的适当的双重差分因果对比，并使用所提供的数据计算其值。将最终估计值表示为小数比例（例如，$0.001$ 对应于 $0.1\\%$），不带百分号，并将最终答案四舍五入到 $2$ 位有效数字。", "solution": "令 $Y_{it}$ 表示城市 $i$ 在时间段 $t$ 的预期平均HbA1c。\n令 $i \\in \\{T, C\\}$，其中 $T$ 代表治疗城市，$C$ 代表对照城市。\n令 $t \\in \\{0, 1\\}$，其中 $t=0$ 是干预前时期，$t=1$ 是干预后时期。\n\n我们使用潜在结果框架。令 $Y_{it}(1)$ 为城市 $i$ 在时间 $t$ 接受处理（税收）时的潜在结果（平均HbA1c）。令 $Y_{it}(0)$ 为未接受处理时的潜在结果。\n\n处理仅在干预后时期（$t=1$）应用于城市 $T$。观测结果（$Y_{it}$）与潜在结果之间的关系如下：\n-   对于治疗城市，在 $t=1$ 时：$Y_{T,1} = Y_{T,1}(1)$（在处理下观测到）。\n-   对于治疗城市，在 $t=0$ 时：$Y_{T,0} = Y_{T,0}(0)$（未接受处理时观测到，因为干预前时期在税收之前）。\n-   对于对照城市，在 $t=1$ 时：$Y_{C,1} = Y_{C,1}(0)$（未接受处理时观测到，因为对照城市从未接受税收）。\n-   对于对照城市，在 $t=0$ 时：$Y_{C,0} = Y_{C,0}(0)$（未接受处理时观测到）。\n\n我们感兴趣的因果效应是处理组的平均处理效应（Average Treatment effect on the Treated, ATT）。这是税收对实际接受它的城市的影响。对于干预后时期，ATT是治疗城市在有税收时的结果与假如没有税收时其结果之间的差异。\n$$ \\text{ATT} = E[Y_{T,1}(1) - Y_{T,1}(0)] $$\n我们可以观测到 $E[Y_{T,1}(1)]$，即治疗城市在干预后时期的平均HbA1c，$E[Y_{T,1}]$。然而，$E[Y_{T,1}(0)]$ 是反事实结果——即如果在干预后时期没有实施税收，治疗城市的平均HbA1c会是多少。这个量是根本无法观测的。\n\n为了估计这个无法观测的反事实，我们援引平行趋势假设。该假设指出，在没有处理的情况下，治疗组的结果会遵循与对照组结果相同的趋势。在数学上，两组未处理的潜在结果的变化是相同的：\n$$ E[Y_{T,1}(0) - Y_{T,0}(0)] = E[Y_{C,1}(0) - Y_{C,0}(0)] $$\n利用潜在结果和观测结果之间的关系，我们可以用对照组的观测值重写右侧，并用干预前时期治疗组的观测值重写左侧的第二项：\n$$ E[Y_{T,1}(0)] - E[Y_{T,0}] = E[Y_{C,1}] - E[Y_{C,0}] $$\n我们现在可以解出未观测到的反事实 $E[Y_{T,1}(0)]$：\n$$ E[Y_{T,1}(0)] = E[Y_{T,0}] + (E[Y_{C,1}] - E[Y_{C,0}]) $$\n该表达式表明，治疗组的反事实结果是其基线结果加上在对照组中观测到的变化。\n\n现在，我们将这个反事实的表达式代回到ATT的定义中：\n$$ \\text{ATT} = E[Y_{T,1}(1)] - E[Y_{T,1}(0)] $$\n$$ \\text{ATT} = E[Y_{T,1}] - \\left( E[Y_{T,0}] + (E[Y_{C,1}] - E[Y_{C,0}]) \\right) $$\n重新排列各项，将每个城市内部的变化分组，得到双重差分估计量：\n$$ \\text{ATT} = (E[Y_{T,1}] - E[Y_{T,0}]) - (E[Y_{C,1}] - E[Y_{C,0}]) $$\n这就是因果对比。它是治疗组的前后变化与对照组的前后变化之间的差值。\n\n问题直接提供了这些变化：\n-   治疗城市的前后变化：$\\Delta_T = E[Y_{T,1}] - E[Y_{T,0}] = -0.10\\%$。\n-   对照城市的前后变化：$\\Delta_C = E[Y_{C,1}] - E[Y_{C,0}] = +0.02\\%$。\n\n将这些值代入推导出的公式中：\n$$ \\text{ATT} = \\Delta_T - \\Delta_C = (-0.10\\%) - (+0.02\\%) = -0.12\\% $$\n估计的税收因果效应是平均HbA1c减少了 $0.12$ 个百分点。\n\n最后一步是将此百分比转换为小数比例，并四舍五入到 $2$ 位有效数字。\n要将百分比转换为比例，我们除以 $100$：\n$$ -0.12\\% = \\frac{-0.12}{100} = -0.0012 $$\n数字 $-0.0012$ 有两位有效数字（数字 $1$ 和 $2$），因此无需四舍五入。", "answer": "$$\\boxed{-0.0012}$$", "id": "4972737"}]}