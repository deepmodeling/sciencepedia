{"hands_on_practices": [{"introduction": "在动态变化的真实世界人群中，衡量新发感染的速率是流行病学监测的基石。本练习将指导您完成从个体随访数据中计算发病密度的核心过程，这种方法对于处理成员随时间加入和退出的队列研究至关重要。通过亲手计算人-时并处理删失数据，您将掌握评估艾滋病病毒传播速度的基本技能 [@problem_id:4985228]。", "problem": "一项基于社区的人类免疫缺陷病毒（HIV）感染队列研究在一段时间内跟踪一个动态人群，该研究存在交错入组以及因血清转化、失访或研究行政性终止导致的右删失。研究从第$0$个月持续到第$24$个月。对于以下每个个体，都记录了自研究开始以来的入组时间，以及退出时间与原因或血清转化时间（以月为单位）。对于发生血清转化的个体，随访在其血清转化时停止。对于失访的个体，随访在其最后一次观察访视时停止。对于行政性删失的个体，随访在第$24$个月时停止。\n\n这$12$名个体的信息如下：\n- 个体$1$：第$0$个月入组，第$24$个月退出，未发生血清转化（行政性删失）。\n- 个体$2$：第$0$个月入组，在第$9$个月发生血清转化。\n- 个体$3$：第$3$个月入组，在第$15$个月失访，无记录的血清转化。\n- 个体$4$：第$6$个月入组，第$24$个月退出，未发生血清转化（行政性删失）。\n- 个体$5$：第$6$个月入组，在第$20$个月发生血清转化。\n- 个体$6$：第$12$个月入组，第$24$个月退出，未发生血清转化（行政性删失）。\n- 个体$7$：第$0$个月入组，在第$8$个月失访，无记录的血清转化。\n- 个体$8$：第$10$个月入组，在第$16$个月发生血清转化。\n- 个体$9$：第$2$个月入组，第$24$个月退出，未发生血清转化（行政性删失）。\n- 个体$10$：第$14$个月入组，第$24$个月退出，未发生血清转化（行政性删失）。\n- 个体$11$：第$4$个月入组，在第$7$个月失访，无记录的血清转化。\n- 个体$12$：第$18$个月入组，第$24$个月退出，未发生血清转化（行政性删失）。\n\n任务：\n- (a) 仅使用动态队列中发病密度的基本定义，通过将从入组到血清转化、失访或研究结束三者中最早发生事件的个体人时进行求和，并对观察到的血清转化事件进行计数，计算HIV血清转化的常规发病密度（以每$100$人年发生的事件数表示）。将此部分的答案四舍五入至三位有效数字，并以每$100$人年发生的事件数表示。\n- (b) 为评估对删失的敏感性，在一个极端假设下计算发病密度的上限值，该假设为每个失访个体在他们最后一次观察访视后立即发生了血清转化（从而将所有失访计入事件数，而不增加随访时间）。将此部分的答案四舍五入至三位有效数字，并以每$100$人年发生的事件数表示。\n- (c) 最后，计算定义为(b)部分计算的发病密度上限值与(a)部分计算的常规发病密度之比的敏感性比率。将该比率报告为一个无单位的数值。该比率是所要求的最终答案。", "solution": "问题要求根据队列数据计算HIV发病密度率，进行随后的敏感性分析，并最终计算这两个率的比值。该问题定义明确，科学上基于标准的流行病学方法，并为得出唯一解提供了所有必要的数据。\n\n动态队列中发病密度（$ID$）的基本定义是在某一时期内发生的新病例（事件）数除以该时期内总的风险人时。\n$$ID = \\frac{\\text{Number of new cases}}{\\text{Total person-time at risk}}$$\n问题指定发病率以每$100$人年的事件数表示，而数据是以月为单位给出的。转换公式为：\n$$ID_{\\text{per 100 PY}} = \\frac{\\text{Number of events}}{\\text{Total person-months}} \\times \\frac{12 \\text{ months}}{1 \\text{ year}} \\times 100$$\n\n(a) 常规发病密度（$ID_a$）的计算。\n\n首先，我们必须通过对$12$名个体各自的随访时长求和来计算总风险人时。对于每个个体，其人时是从其入组月份到其退出事件（血清转化、失访或在第$24$个月的行政性删失）发生月份之间的时长。设$t_i$为个体$i$贡献的人时（以月为单位）。\n\n各项贡献如下：\n- 个体$1$：入组$0$，退出$24$（行政性删失）。$t_1 = 24 - 0 = 24$ 个月。\n- 个体$2$：入组$0$，退出$9$（血清转化）。$t_2 = 9 - 0 = 9$ 个月。\n- 个体$3$：入组$3$，退出$15$（失访）。$t_3 = 15 - 3 = 12$ 个月。\n- 个体$4$：入组$6$，退出$24$（行政性删失）。$t_4 = 24 - 6 = 18$ 个月。\n- 个体$5$：入组$6$，退出$20$（血清转化）。$t_5 = 20 - 6 = 14$ 个月。\n- 个体$6$：入组$12$，退出$24$（行政性删失）。$t_6 = 24 - 12 = 12$ 个月。\n- 个体$7$：入组$0$，退出$8$（失访）。$t_7 = 8 - 0 = 8$ 个月。\n- 个体$8$：入组$10$，退出$16$（血清转化）。$t_8 = 16 - 10 = 6$ 个月。\n- 个体$9$：入组$2$，退出$24$（行政性删失）。$t_9 = 24 - 2 = 22$ 个月。\n- 个体$10$：入组$14$，退出$24$（行政性删失）。$t_{10} = 24 - 14 = 10$ 个月。\n- 个体$11$：入组$4$，退出$7$（失访）。$t_{11} = 7 - 4 = 3$ 个月。\n- 个体$12$：入组$18$，退出$24$（行政性删失）。$t_{12} = 24 - 18 = 6$ 个月。\n\n总风险人时（以人月为单位）$T_{PM,a}$，是这些个体贡献的总和：\n$$T_{PM,a} = 24 + 9 + 12 + 18 + 14 + 12 + 8 + 6 + 22 + 10 + 3 + 6 = 144 \\text{ person-months}$$\n接下来，我们统计观察到的血清转化事件数，$E_a$。发生血清转化的个体是个体$2$、个体$5$和个体$8$。\n$$E_a = 3$$\n那么，常规发病密度$ID_a$为：\n$$ID_a = \\frac{E_a}{T_{PM,a}} \\times 12 \\times 100 = \\frac{3}{144} \\times 12 \\times 100 = \\frac{1}{48} \\times 1200 = 25 \\text{ events per } 100 \\text{ person-years}$$\n按要求四舍五入到三位有效数字，得到$25.0$。\n\n(b) 发病密度上限值（$ID_b$）的计算。\n\n这部分要求进行敏感性分析，其假设是所有失访的个体都视作在其最后一次访视后立即发生了血清转化。问题明确说明这会“将所有失访计入事件数，而不增加随访时间”。\n因此，总风险人时保持不变：\n$$T_{PM,b} = T_{PM,a} = 144 \\text{ person-months}$$\n事件数$E_b$是已记录的血清转化事件数与失访个体数之和。失访的个体是个体$3$、个体$7$和个体$11$。\n$$E_b = (\\text{seroconversions}) + (\\text{losses}) = 3 + 3 = 6$$\n发病密度的上限值$ID_b$为：\n$$ID_b = \\frac{E_b}{T_{PM,b}} \\times 12 \\times 100 = \\frac{6}{144} \\times 12 \\times 100 = \\frac{1}{24} \\times 1200 = 50 \\text{ events per } 100 \\text{ person-years}$$\n按要求四舍五入到三位有效数字，得到$50.0$。\n\n(c) 敏感性比率的计算。\n\n最终要求的答案是敏感性比率$R$，定义为发病密度上限值与常规发病密度之比。\n$$R = \\frac{ID_b}{ID_a}$$\n使用精确值最为准确。可以通过注意到分子和分母中的人时和转换因子是相同的，从而相互抵消，来简化计算。\n$$R = \\frac{\\frac{E_b}{T_{PM,b}} \\times 12 \\times 100}{\\frac{E_a}{T_{PM,a}} \\times 12 \\times 100} = \\frac{E_b}{E_a} \\quad (\\text{since } T_{PM,a} = T_{PM,b})$$\n代入事件数：\n$$R = \\frac{6}{3} = 2$$\n敏感性比率是一个无单位的数值，为$2$。", "answer": "$$\\boxed{2}$$", "id": "4985228"}, {"introduction": "当我们能够测量疾病发生率后，下一个关键问题是如何量化预防措施（如暴露前预防，PrEP）的公共卫生影响。本练习介绍了一个直观且重要的指标——需治数 (NNT)，它告诉我们需要为多少人提供干预才能预防一例不良事件的发生。通过推导和计算NNT，您将学会如何将药物疗效、用药依从性和时间范围等因素结合起来，以评估一项预防策略的实际效率 [@problem_id:4985242]。", "problem": "一个公共卫生部门正在为一个特定的高危人群规划一个为期两年的暴露前预防（PrEP）计划，以预防人类免疫缺陷病毒（HIV）的感染。假设采用恒定风险（发病率）模型，并且不存在间接（群体）效应，无风险补偿行为，且PrEP的使用与基础风险相互独立。\n\n给定以下基于经验的输入数据：\n- 目标人群中的基线HIV发病率为 $\\lambda_0 = 2.4$ / $100$ 人年（PY）。\n- 时间范围为 $T = 2$ 年。\n- 在完全依从性下，口服PrEP的生物学有效性为 $\\varepsilon = 0.75$（即，在完全依从性下，单位时间的感染风险成比例减少 $0.75$）。\n- 计划中的平均依从性为 $a = 0.60$（无量纲，其中 $a=1$ 表示完全依从性）。\n\n仅使用恒定风险下的累积发病率、绝对风险降低以及需治数（NNT）的基本定义，完成以下任务：\n\n1) 当PrEP使单位时间风险以 $1-\\varepsilon a$ 的因子乘积性降低时，推导在时间范围 $T$ 内绝对风险降低的表达式。然后，推导出在时间 $T$ 内避免一例感染所需的需治数的相应精确表达式。\n\n2) 展示在低风险近似下，你的表达式如何简化为一个与基线累积发病率、生物学有效性和依从性三者乘积的倒数成正比的形式。清晰地说明此近似成立的低风险条件。\n\n3) 使用给定的数值，计算在2年时间范围内的NNT。将你的最终NNT四舍五入至三位有效数字。最终答案应为一个无量纲的实数。", "solution": "该问题经核实具有科学依据，提法得当且客观。它是一个标准的流行病学建模练习，参数现实。所有必要信息均已提供，问题明确无歧义。\n\n解答按要求分为三个部分进行。\n\n恒定风险率 $\\lambda$ 与时间段 $T$ 内的累积发病率（风险）$R$ 之间的基本关系由生存函数 $S(T) = \\exp(-\\lambda T)$ 给出。风险是生存的补集，即 $R(T) = 1 - S(T) = 1 - \\exp(-\\lambda T)$。\n\n未暴露人群中的基线HIV发病率为 $\\lambda_0$。该人群在时间范围 $T$ 内的感染风险为：\n$$R_0 = 1 - \\exp(-\\lambda_0 T)$$\n\n问题陈述PrEP以乘积形式降低单位时间风险。有效效力是生物学有效性 $\\varepsilon$ 和依从性 $a$ 的乘积。因此，风险降低因子为 $\\varepsilon a$。对于使用PrEP的个体，新的风险率 $\\lambda_1$ 为：\n$$\\lambda_1 = \\lambda_0 (1 - \\varepsilon a)$$\n因此，使用PrEP的个体在时间范围 $T$ 内的感染风险为：\n$$R_1 = 1 - \\exp(-\\lambda_1 T) = 1 - \\exp(-\\lambda_0 (1 - \\varepsilon a) T)$$\n\n1) 绝对风险降低（ARR）与需治数（NNT）的推导\n\n绝对风险降低（$ARR$）是未暴露组与暴露（PrEP）组之间风险的差异。\n$$ARR = R_0 - R_1$$\n代入 $R_0$ 和 $R_1$ 的表达式：\n$$ARR = \\left[1 - \\exp(-\\lambda_0 T)\\right] - \\left[1 - \\exp(-\\lambda_0 (1 - \\varepsilon a) T)\\right]$$\n$$ARR = \\exp(-\\lambda_0 (1 - \\varepsilon a) T) - \\exp(-\\lambda_0 T)$$\n需治数（$NNT$）定义为 $ARR$ 的倒数。它表示为预防一例不良结局而需要治疗的平均人数。\n$$NNT = \\frac{1}{ARR}$$\n代入 $ARR$ 的表达式，NNT的精确表达式为：\n$$NNT = \\frac{1}{\\exp(-\\lambda_0 (1 - \\varepsilon a) T) - \\exp(-\\lambda_0 T)}$$\n\n2) 低风险近似\n\n当时间范围内的累积发病率很小时，低风险近似是成立的。这对应于指数函数的自变量远小于1的条件。因此，低风险条件为：\n$$\\lambda_0 T \\ll 1$$\n在此条件下，我们可以对指数函数使用一阶泰勒级数展开，即当 $x$ 很小时，$\\exp(-x) \\approx 1 - x$。\n\n将此近似应用于风险表达式：\n$$R_0 = 1 - \\exp(-\\lambda_0 T) \\approx 1 - (1 - \\lambda_0 T) = \\lambda_0 T$$\n$$R_1 = 1 - \\exp(-\\lambda_1 T) \\approx 1 - (1 - \\lambda_1 T) = \\lambda_1 T = \\lambda_0 (1 - \\varepsilon a) T$$\n那么，近似的 $ARR$ 为：\n$$ARR_{approx} \\approx R_{0,approx} - R_{1,approx} = \\lambda_0 T - \\lambda_0 (1 - \\varepsilon a) T$$\n$$ARR_{approx} \\approx \\lambda_0 T - \\lambda_0 T + \\lambda_0 T \\varepsilon a = \\lambda_0 T \\varepsilon a$$\n近似的 $NNT$ 是近似的 $ARR$ 的倒数：\n$$NNT_{approx} \\approx \\frac{1}{\\lambda_0 T \\varepsilon a}$$\n在低风险近似下，基线累积发病率 $R_0$ 为 $R_{0,approx} = \\lambda_0 T$。将此代入 $NNT_{approx}$ 的表达式中：\n$$NNT_{approx} \\approx \\frac{1}{R_{0,approx} \\cdot \\varepsilon \\cdot a}$$\n这表明，在低风险条件下，NNT 近似等于近似基线累积发病率（$\\lambda_0 T$）、生物学有效性（$\\varepsilon$）和平均依从性（$a$）三者乘积的倒数。\n\n3) NNT的数值计算\n\n首先，我们必须以一致的单位表示所有参数。基线发病率给定为 $\\lambda_0 = 2.4$ / $100$ 人年。这可以转换为每人年的比率：\n$$\\lambda_0 = \\frac{2.4}{100} \\, \\text{year}^{-1} = 0.024 \\, \\text{year}^{-1}$$\n其他给定值为：\n- 时间范围，$T = 2$ 年\n- 生物学有效性，$\\varepsilon = 0.75$\n- 平均依从性，$a = 0.60$\n\n我们使用第1部分推导出的NNT的精确公式：\n$$NNT = \\frac{1}{\\exp(-\\lambda_0 (1 - \\varepsilon a) T) - \\exp(-\\lambda_0 T)}$$\n首先，我们计算指数部分：\n乘积 $\\varepsilon a$ 是：\n$$\\varepsilon a = 0.75 \\times 0.60 = 0.45$$\nPrEP组的指数是：\n$$-\\lambda_0 (1 - \\varepsilon a) T = -0.024 \\times (1 - 0.45) \\times 2 = -0.024 \\times 0.55 \\times 2 = -0.0264$$\n对照组的指数是：\n$$-\\lambda_0 T = -0.024 \\times 2 = -0.048$$\n现在，将这些值代入 $NNT$ 方程：\n$$NNT = \\frac{1}{\\exp(-0.0264) - \\exp(-0.048)}$$\n我们计算指数函数的值：\n$$\\exp(-0.0264) \\approx 0.97394498$$\n$$\\exp(-0.048) \\approx 0.95313636$$\n$ARR$ 是差值：\n$$ARR \\approx 0.97394498 - 0.95313636 = 0.02080862$$\n最后，我们计算 $NNT$：\n$$NNT = \\frac{1}{0.02080862} \\approx 48.0569$$\n将结果四舍五入至三位有效数字，我们得到：\n$$NNT \\approx 48.1$$\n这意味着，目标人群中大约需要有48名个体接受为期2年的PrEP治疗，才能避免一例HIV感染。", "answer": "$$\\boxed{48.1}$$", "id": "4985242"}, {"introduction": "除了评估个体层面的干预效果，我们还需要工具来预测控制策略在人群层面的总体影响。本练习将带您使用一个核心的流行病学模型，通过基本再生数 ($R_0$) 来推导时变再生数 ($R_t$)，以评估抗逆转录病毒疗法 (ART) 的广泛覆盖如何影响艾滋病疫情的走向。理解 $R_t$ 如何随干预措施而变化，是判断我们是否能将疫情控制在流行阈值 $1$ 以下的关键 [@problem_id:4985285]。", "problem": "一个社区正在经历HIV疫情。基本再生数 $R_0$ 定义为，在完全易感的人群中且没有任何干预措施的情况下，由单个典型感染者产生的预期继发感染人数。在时间 $t$，抗逆转录病毒疗法（ART）的覆盖率达到了这样的水平：$\\alpha$ 比例的艾滋病病毒（HIV）感染者正在接受ART治疗。对于接受ART治疗的患者，其净传播能力（可解释为每次接触的传播概率与随时间变化的有效传染性的乘积）相对于未接受ART治疗的情况，乘性地降低了一个因子 $\\theta$。假设人群是均匀混合的，ART的分配除了通过 $\\theta$ 所编码的传播能力降低外，不改变接触率或传染期长度，并且特定类型的再生数与传播能力成正比。\n\n使用应用于ART状态的全期望定律，推导时间变化再生数 $R_t$ 作为 $\\alpha$、$\\theta$ 和 $R_0$ 的函数的封闭形式表达式。然后，当 $R_0 = 2.4$、$\\alpha = 0.65$ 和 $\\theta = 0.08$ 时，计算 $R_t$ 的值。将最终数值答案四舍五入到4位有效数字。将答案表示为一个无单位的纯数字。", "solution": "问题要求推导在一个有部分HIV感染者正在接受抗逆转录病毒疗法（ART）的人群中，随时间变化的再生数 $R_t$，并对其进行数值计算。推导将基于全期望定律，并将其应用于按ART状态划分的感染人群。\n\n设 $R_0$ 为基本再生数，定义为在无干预措施的完全易感人群中，由单个感染者产生的预期继发感染数。在时间 $t$，有比例为 $\\alpha$ 的感染人群正在接受ART治疗，剩下的比例为 $1-\\alpha$ 的人群则没有。\n\n问题指出，对于接受ART治疗的个体，其净传播能力乘性地降低了一个因子 $\\theta$。同时假设特定个体群体的再生数与其净传播能力成正比。\n\n我们用 $R_{noART}$ 表示未治疗个体的再生数，用 $R_{ART}$ 表示已治疗个体的再生数。\n根据定义，一个未治疗的个体具有与 $R_0$ 相关的基线传播能力。因此，我们可以将其对疫情传播的贡献设定为等同于基本再生数：\n$$R_{noART} = R_0$$\n对于接受ART治疗的个体，其传播能力降低了因子 $\\theta$。根据比例缩放的假设，其再生数也同样降低了这个因子：\n$$R_{ART} = \\theta R_0$$\n随时间变化的再生数 $R_t$ 表示在时间 $t$ 从整个感染人群中随机选择的一个感染个体所产生的平均继发感染数。该人群由两个不相交的群体组成：接受ART治疗的群体和未接受ART治疗的群体。我们可以使用全期望定律，通过以个体的ART状态为条件，来计算期望值 $R_t$。\n\n设 $N$ 为一个随机选择的感染者所引起的继发感染数的随机变量。设 $A$ 为此人正在接受ART治疗的事件。题目给出该事件的概率为 $P(A) = \\alpha$。其互补事件 $A^c$，即此人未接受ART治疗，其概率为 $P(A^c) = 1 - \\alpha$。\n\n根据全期望定律，$N$ 的期望值，即 $R_t$，由下式给出：\n$$R_t = E[N] = E[N|A] P(A) + E[N|A^c] P(A^c)$$\n条件期望 $E[N|A]$ 是来自一个接受ART治疗者的平均继发感染数，我们已经确定其为 $R_{ART} = \\theta R_0$。\n条件期望 $E[N|A^c]$ 是来自一个未接受ART治疗者的平均继发感染数，即 $R_{noART} = R_0$。\n\n将这些量代入 $R_t$ 的方程中：\n$$R_t = (\\theta R_0) \\cdot \\alpha + (R_0) \\cdot (1-\\alpha)$$\n这个表达式将 $R_t$ 表示为两个亚群再生数的加权平均值，权重为每个亚群的比例。我们现在可以简化这个表达式，以获得所要求的封闭形式。\n$$R_t = \\alpha \\theta R_0 + R_0 - \\alpha R_0$$\n提出公因式 $R_0$：\n$$R_t = R_0 (1 - \\alpha + \\alpha \\theta)$$\n这可以进一步整理，以突显从 $R_0$ 开始的减少量：\n$$R_t = R_0 [1 - \\alpha(1 - \\theta)]$$\n这就是 $R_t$ 作为 $R_0$、$\\alpha$ 和 $\\theta$ 的函数的封闭形式表达式。项 $\\alpha(1-\\theta)$ 代表了通过ART项目避免的传播事件的比例。\n\n接下来，我们使用给定的数值来计算这个表达式：$R_0 = 2.4$，$\\alpha = 0.65$ 和 $\\theta = 0.08$。\n\n将这些值代入推导出的公式中：\n$$R_t = 2.4 \\times [1 - 0.65 \\times (1 - 0.08)]$$\n首先，计算括号内的项：\n$$1 - 0.08 = 0.92$$\n然后，乘以ART覆盖率 $\\alpha$：\n$$0.65 \\times 0.92 = 0.598$$\n现在，将此结果代回主表达式中：\n$$R_t = 2.4 \\times (1 - 0.598)$$\n$$R_t = 2.4 \\times 0.402$$\n进行最后的乘法运算：\n$$R_t = 0.9648$$\n题目要求将最终答案四舍五入到4位有效数字。计算出的值 $0.9648$ 已经恰好是四位有效数字。\n\n这个结果，$R_t \\approx 0.9648$，小于1，表明在指定的ART覆盖率和疗效条件下，社区中的疫情预计将会减弱，因为平均每个感染者产生的新感染者少于一个。", "answer": "$$\\boxed{0.9648}$$", "id": "4985285"}]}