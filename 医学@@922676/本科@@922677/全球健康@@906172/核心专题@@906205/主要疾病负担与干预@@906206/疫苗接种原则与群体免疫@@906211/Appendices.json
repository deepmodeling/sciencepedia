{"hands_on_practices": [{"introduction": "理解群体免疫的第一步始于一个基础的数学计算。这个练习将引导你基于疾病的基本传染数 $R_0$ 来推导“群体免疫阈值”，即防止疫情持续传播所需达到的最低免疫人口比例。这是制定疫苗接种策略的基石 ([@problem_id:2543678])。", "problem": "在一个由易感-感染-移除（SIR）框架支配的大型、均匀混合的宿主群体中，基本再生数 $R_{0}$ 定义为单个典型感染者在一个完全易感的群体中产生的预期二次感染数。设 $H \\in [0,1]$ 表示免疫比例（例如，因保护性疫苗接种或既往感染而获得免疫），因此易感比例为 $S = 1 - H$。一个经过充分检验的事实是，在流行病初期，当因感染导致的易感者减少可以忽略不计时，有效再生数满足 $R_{\\mathrm{e}} = R_{0} S$。持续传播需要 $R_{\\mathrm{e}} > 1$，而阻止持续传播则需要 $R_{\\mathrm{e}}  1$。\n\n从这些基本事实出发，推导出刚好能阻止持续传播的最小免疫比例 $H^{*}$（即 $R_{\\mathrm{e}} = 1$ 时的阈值）。然后，将 $H^{*}$ 视为 $R_{0}$ 的显式函数，并使用一阶泰勒（delta 方法）近似，得到从 $R_{0}$ 的不确定性到 $H^{*}$ 的不确定性的主导阶线性不确定性传播；也就是说，如果 $R_{0}$ 的标准差为 $\\sigma_{R_{0}}$，通过 $\\sigma_{H^{*}} \\approx c\\,\\sigma_{R_{0}}$ 定义灵敏度系数 $c$，并用 $R_{0}$ 表示 $c$。\n\n最后，在 $R_{0} = 3.5$ 处计算这两个量的值。对于 $R_{0} = 3.5$ 时的最小免疫比例 $H^{*}$，将结果报告为四舍五入到四位有效数字的小数（不要使用百分号）。对于 $R_{0} = 3.5$ 时的灵敏度系数 $c$，提供一个精确表达式。将最终结果报告为一个包含两个条目的行矩阵 $\\big[\\,H^{*},\\,c\\,\\big]$，矩阵内不含单位。", "solution": "问题陈述需经过验证。\n\n逐字提取已知条件如下：\n1.  群体是大型、均匀混合的，并遵循易感-感染-移除（SIR）框架。\n2.  基本再生数为 $R_{0}$。\n3.  免疫比例为 $H \\in [0,1]$。\n4.  易感比例为 $S = 1 - H$。\n5.  在流行病初期，有效再生数为 $R_{\\mathrm{e}} = R_{0} S$。\n6.  持续传播需要 $R_{\\mathrm{e}}  1$。\n7.  阻止持续传播需要 $R_{\\mathrm{e}}  1$。\n8.  任务是找到刚好能阻止持续传播的最小免疫比例 $H^{*}$，此时 $R_{\\mathrm{e}} = 1$。\n9.  任务是找到关系式 $\\sigma_{H^{*}} \\approx c\\,\\sigma_{R_{0}}$ 中的灵敏度系数 $c$，该关系式由一阶泰勒近似推导得出。\n10. 必须在 $R_{0} = 3.5$ 处计算这些值。\n11. $H^{*}$ 的值必须是四舍五入到四位有效数字的小数。\n12. $c$ 的值必须是精确表达式。\n\n根据强制性标准对问题进行验证。\n*   **科学依据**：该问题建立在数学流行病学的基本原理之上，具体而言是 SIR 模型和群体免疫阈值的概念。关系式 $R_{\\mathrm{e}} = R_{0} S$ 是该领域的基石。因此，该问题在科学上是合理的。\n*   **适定性**：目标陈述清晰，并且可以从所给前提中通过数学推导得出。问题要求的是存在唯一解的特定量（$H^{*}$ 和 $c$）。\n*   **客观性**：该问题使用精确、定量且无偏见的语言进行陈述。\n\n该问题被认为是有效的，因为它没有表现出任何列举的缺陷。它具有科学依据、适定性和客观性。解题过程如下。\n\n第一个目标是推导阻止持续传播所需的最小免疫比例，记为 $H^{*}$。阻止持续传播的阈值是有效再生数 $R_{\\mathrm{e}}$ 等于 1 的点。在此阈值下，每个感染者平均产生一个新的感染，因此疫情不会增长。\n\n我们已知关系式：\n$$R_{\\mathrm{e}} = R_{0} S$$\n我们还已知易感比例 $S$ 与免疫比例 $H$ 的关系为：\n$$S = 1 - H$$\n将 $S$ 的表达式代入 $R_{\\mathrm{e}}$ 的方程中，得到：\n$$R_{\\mathrm{e}} = R_{0} (1 - H)$$\n为了求得群体免疫阈值 $H^{*}$，我们令 $R_{\\mathrm{e}} = 1$：\n$$1 = R_{0} (1 - H^{*})$$\n我们现在求解 $H^{*}$ 作为 $R_{0}$ 的函数。这是在 $R_{0}  1$ 的假设下进行的，这是首先可能发生流行病的必要条件。如果 $R_{0} \\le 1$，即使在完全易感的群体中也不会发生流行病，所需的免疫比例为 0。考虑到上下文和给定的值 $R_{0} = 3.5$，假设 $R_{0}  1$ 是有效的。\n$$\\frac{1}{R_{0}} = 1 - H^{*}$$\n$$H^{*} = 1 - \\frac{1}{R_{0}}$$\n该表达式给出了实现群体免疫所需的最小免疫比例。\n\n第二个目标是确定将 $H^{*}$ 的不确定性与 $R_{0}$ 的不确定性联系起来的灵敏度系数 $c$。这通过使用一阶泰勒级数近似（也称为 delta 方法）来实现。对于函数 $H^{*}(R_{0})$，不确定性传播由下式给出：\n$$\\sigma_{H^{*}} \\approx \\left| \\frac{dH^{*}}{dR_{0}} \\right| \\sigma_{R_{0}}$$\n题目将灵敏度系数 $c$ 定义为此近似中的因子：\n$$c = \\left| \\frac{dH^{*}}{dR_{0}} \\right|$$\n我们必须计算 $H^{*}(R_{0}) = 1 - \\frac{1}{R_{0}} = 1 - R_{0}^{-1}$ 对 $R_{0}$ 的导数：\n$$\\frac{dH^{*}}{dR_{0}} = \\frac{d}{dR_{0}} \\left( 1 - R_{0}^{-1} \\right) = 0 - (-1)R_{0}^{-2} = \\frac{1}{R_{0}^{2}}$$\n由于当 $R_{0}  1$ 时，$R_{0}^{2}$ 总是正的，导数也是正的，因此绝对值是多余的。所以，灵敏度系数为：\n$$c = \\frac{1}{R_{0}^{2}}$$\n\n最后，我们针对给定的值 $R_{0} = 3.5$ 计算 $H^{*}$ 和 $c$。\n\n对于最小免疫比例 $H^{*}$：\n$$H^{*} = 1 - \\frac{1}{3.5} = 1 - \\frac{1}{7/2} = 1 - \\frac{2}{7} = \\frac{5}{7}$$\n题目要求将此结果表示为四舍五入到四位有效数字的小数。\n$$\\frac{5}{7} \\approx 0.7142857...$$\n四舍五入到四位有效数字，我们得到：\n$$H^{*} \\approx 0.7143$$\n\n对于灵敏度系数 $c$：\n$$c = \\frac{1}{R_{0}^{2}} = \\frac{1}{(3.5)^{2}}$$\n题目要求此值为一个精确表达式。\n$$(3.5)^{2} = \\left(\\frac{7}{2}\\right)^{2} = \\frac{49}{4} = 12.25$$\n因此，\n$$c = \\frac{1}{49/4} = \\frac{4}{49}$$\n\n最终答案需报告为一个包含两个条目的行矩阵 $\\begin{pmatrix} H^{*}  c \\end{pmatrix}$。\n两个计算出的值是 $H^{*} \\approx 0.7143$ 和 $c = \\frac{4}{49}$。\n因此矩阵为 $\\begin{pmatrix} 0.7143  \\frac{4}{49} \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.7143  \\frac{4}{49} \\end{pmatrix}}$$", "id": "2543678"}, {"introduction": "现实世界中的疫苗可能具有多种保护效果。这个实践将超越简单的“免疫或未免疫”模型，探讨“非完美”疫苗如何同时降低接种者的感染风险（易感性）以及感染后传播病毒的能力（传染性）。通过构建这个更精细的模型，我们可以更准确地评估疫苗在人群层面的综合影响 ([@problem_id:2543662])。", "problem": "在一个规模恒定、均匀混合的封闭宿主种群中，一种病原体遵循在质量作用传播下的易感-感染-移除（SIR）过程。基本再生数 $R_0$ 定义为，在没有疫苗接种的情况下，将单个感染者引入一个完全易感的种群中所引起的二次感染的期望数。一种疫苗以覆盖率 $c$ 进行部署（即，在时间 $t=0$ 时，有比例为 $c$ 的人口接种了疫苗）。假设疫苗是“渗漏型”的（\"leaky\" vaccine）：疫苗接种使已接种宿主的每次接触易感性降低一个乘法因子 $(1-\\mathrm{VE}_S)$，并使已接种的感染宿主的每次接触传染性降低一个乘法因子 $(1-\\mathrm{VE}_I)$。假设疫苗不改变感染期持续时间，混合是成比例的，并且在所考虑的时间范围内没有免疫力减弱。\n\n从通过下一代矩阵对双类型系统（已接种和未接种）定义 $R_0$ 出发，并且仅使用上述假设和标准的SIR质量作用框架，推导有效再生数 $R_{\\mathrm{eff}}$ 的表达式，作为该已接种人群中传播开始时下一代矩阵的谱半径。然后对 $R_0=4$, $\\mathrm{VE}_S=0.7$, $\\mathrm{VE}_I=0.5$ 和 $c=0.6$ 进行求值。\n\n将你的最终答案以行矩阵 $\\begin{pmatrix} R_{\\mathrm{eff}}  G \\end{pmatrix}$ 的形式报告，其中 $R_{\\mathrm{eff}}$ 四舍五入到3位有效数字，并且 $G$ 是一个指示符，如果早期传播增长（即 $R_{\\mathrm{eff}}1$），则 $G=1$；如果早期传播下降（即 $R_{\\mathrm{eff}} \\le 1$），则 $G=0$。答案中不要包含任何单位或百分号。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 过程：易感-感染-移除（SIR）模型，在封闭、均匀混合、规模恒定的种群中。\n- 传播：质量作用。\n- 基本再生数：$R_0$，在完全易感的种群中。\n- 疫苗覆盖率：在 $t=0$ 时，比例为 $c$ 的人口接种了疫苗。\n- 疫苗作用（“渗漏型”）：\n  - 易感性降低因子 $(1-\\mathrm{VE}_S)$。\n  - 传染性降低因子 $(1-\\mathrm{VE}_I)$。\n- 假设：\n  - 疫苗不改变感染期持续时间。\n  - 混合是成比例的。\n  - 免疫力无减弱。\n- 任务：\n  - 推导有效再生数 $R_{\\mathrm{eff}}$，作为双类型系统（已接种和未接种）的下一代矩阵的谱半径。\n  - 对 $R_0=4$, $\\mathrm{VE}_S=0.7$, $\\mathrm{VE}_I=0.5$ 和 $c=0.6$ 进行求值。\n- 报告：\n  - 最终答案为行矩阵 $\\begin{pmatrix} R_{\\mathrm{eff}}  G \\end{pmatrix}$。\n  - $R_{\\mathrm{eff}}$ 四舍五入到3位有效数字。\n  - 若 $R_{\\mathrm{eff}}1$ 则 $G=1$，若 $R_{\\mathrm{eff}} \\le 1$ 则 $G=0$。\n\n步骤2：使用提取的已知条件进行验证\n- 科学依据：该问题基于标准的SIR仓室模型、用于计算再生数的下一代矩阵方法以及已建立的疫苗效力定义。这些是数理流行病学中基本且可靠的概念。该问题具有科学依据。\n- 适定性：该问题提供了推导唯一数学解所需的所有参数和假设。目标陈述清晰。该问题是适定的。\n- 客观性：语言精确、定量，没有主观或含糊的术语。该问题是客观的。\n- 完整性和一致性：所提供的信息对于推导是充分且自洽的。没有缺失的参数或矛盾的约束。\n- 现实性：指定的模型和参数值是简化的，但在理论研究中是标准的，并代表了传染病和疫苗接种计划的可能情景。\n- 结构：该问题结构逻辑清晰，要求使用指定方法（下一代矩阵）从第一性原理进行推导，然后进行数值计算。\n\n步骤3：结论与行动\n问题有效。这是理论流行病学中的一个标准练习。现在提供完整解法。\n\n人口被分层为两个群体：未接种者（1型）和已接种者（2型）。在无病平衡点（DFE），每个群体在总人口中所占的比例分别为：1型为 $(1-c)$，2型为 $c$。设 $I_1$ 和 $I_2$ 分别代表未接种群体和已接种群体中的感染者数量。\n\n基本再生数 $R_0$ 与基线传播率 $\\beta$ 和平均感染期 $1/\\gamma$ 相关，关系式为 $R_0 = \\beta/\\gamma$。这假设了一个标准的发病率公式，其中由 $I$ 个感染者在一个有 $S$ 个易感者的种群中引起新感染的速率为 $\\beta (S/N) I$。\n\n下一代方法要求我们定义每个群体中的新感染率。设 $\\mathcal{F}_i$ 为群体 $i$ 中的新感染率。\n未接种群体（$\\mathcal{F}_1$）中的新感染率来自于与未接种群体（$I_1$）和已接种群体（$I_2$）中的感染者接触。在流行开始时，1型群体中的易感者数量为 $S_1 \\approx (1-c)N$。\n$$ \\mathcal{F}_1 = \\beta \\frac{S_1}{N} I_1 + \\beta(1-\\mathrm{VE}_I) \\frac{S_1}{N} I_2 $$\n代入 $S_1 = (1-c)N$，我们得到：\n$$ \\mathcal{F}_1 = \\beta(1-c)I_1 + \\beta(1-c)(1-\\mathrm{VE}_I)I_2 $$\n\n已接种群体（$\\mathcal{F}_2$）中的新感染率也来自于与 $I_1$ 和 $I_2$ 的接触。该群体中的易感者 $S_2 \\approx cN$ 的易感性降低了一个因子 $(1-\\mathrm{VE}_S)$。\n$$ \\mathcal{F}_2 = \\beta(1-\\mathrm{VE}_S) \\frac{S_2}{N} I_1 + \\beta(1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) \\frac{S_2}{N} I_2 $$\n代入 $S_2 = cN$，我们得到：\n$$ \\mathcal{F}_2 = \\beta c (1-\\mathrm{VE}_S) I_1 + \\beta c (1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) I_2 $$\n\n我们可以将这些速率表示为矩阵形式 $\\mathbf{\\mathcal{F}} = F \\mathbf{I}$，其中 $\\mathbf{I} = \\begin{pmatrix} I_1 \\\\ I_2 \\end{pmatrix}$：\n$$ F = \\begin{pmatrix} \\beta(1-c)  \\beta(1-c)(1-\\mathrm{VE}_I) \\\\ \\beta c(1-\\mathrm{VE}_S)  \\beta c(1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) \\end{pmatrix} $$\n离开感染仓室的转移由矩阵 $V$ 描述。由于假设感染期持续时间不受疫苗接种影响，恢复率 $\\gamma$ 对两个群体是相同的。\n$$ V = \\begin{pmatrix} \\gamma  0 \\\\ 0  \\gamma \\end{pmatrix} $$\n下一代矩阵 $K$ 由 $K = F V^{-1}$ 给出。\n$$ K = \\begin{pmatrix} \\beta(1-c)  \\beta(1-c)(1-\\mathrm{VE}_I) \\\\ \\beta c(1-\\mathrm{VE}_S)  \\beta c(1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) \\end{pmatrix} \\begin{pmatrix} 1/\\gamma  0 \\\\ 0  1/\\gamma \\end{pmatrix} $$\n代入 $R_0 = \\beta/\\gamma$：\n$$ K = R_0 \\begin{pmatrix} 1-c  (1-c)(1-\\mathrm{VE}_I) \\\\ c(1-\\mathrm{VE}_S)  c(1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) \\end{pmatrix} $$\n有效再生数 $R_{\\mathrm{eff}}$ 是 $K$ 的谱半径，记为 $\\rho(K)$。我们观察到 $K$ 的第二列是第一列的 $(1-\\mathrm{VE}_I)$ 倍。这意味着矩阵 $K$ 的秩为1。对于秩为1的矩阵，其非零特征值等于其迹。\n$$ R_{\\mathrm{eff}} = \\rho(K) = \\mathrm{Tr}(K) $$\n$K$ 的迹是其对角元素之和：\n$$ \\mathrm{Tr}(K) = R_0(1-c) + R_0 c(1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) $$\n因此，有效再生数的解析表达式为：\n$$ R_{\\mathrm{eff}} = R_0 \\left( (1-c) + c(1-\\mathrm{VE}_S)(1-\\mathrm{VE}_I) \\right) $$\n该表达式表示基本再生数乘以在无病平衡点（DFE）的种群平均传播潜能，其中考虑了未接种和已接种状态下个体的分布以及他们易感性和传染性的相应改变。\n\n现在，我们对给定值进行求值：$R_0=4$, $\\mathrm{VE}_S=0.7$, $\\mathrm{VE}_I=0.5$ 和 $c=0.6$。\n未接种部分的项为：\n$$ 1-c = 1-0.6 = 0.4 $$\n已接种部分的项为：\n$$ 1-\\mathrm{VE}_S = 1-0.7 = 0.3 $$\n$$ 1-\\mathrm{VE}_I = 1-0.5 = 0.5 $$\n将这些值代入 $R_{\\mathrm{eff}}$ 的表达式中：\n$$ R_{\\mathrm{eff}} = 4 \\left( 0.4 + 0.6 \\times (0.3) \\times (0.5) \\right) $$\n$$ R_{\\mathrm{eff}} = 4 \\left( 0.4 + 0.6 \\times 0.15 \\right) $$\n$$ R_{\\mathrm{eff}} = 4 \\left( 0.4 + 0.09 \\right) $$\n$$ R_{\\mathrm{eff}} = 4(0.49) $$\n$$ R_{\\mathrm{eff}} = 1.96 $$\n该值已为3位有效数字。\n\n流行病增长指示符 $G$ 在 $R_{\\mathrm{eff}}1$ 时为1，在 $R_{\\mathrm{eff}} \\le 1$ 时为0。由于 $R_{\\mathrm{eff}} = 1.96  1$，我们得到 $G=1$。\n\n最终答案以行矩阵 $\\begin{pmatrix} R_{\\mathrm{eff}}  G \\end{pmatrix}$ 的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.96  1 \\end{pmatrix}}\n$$", "id": "2543662"}, {"introduction": "人群并非同质化的，不同年龄段的人有着不同的接触模式。这个动手编程练习将展示流行病学家如何利用计算工具和矩阵模型，为具有年龄结构的人群制定疫苗策略。它让我们能更精确地计算疫苗接种后的有效传染数，并找出控制残余传播的关键年龄组 ([@problem_id:5008235])。", "problem": "一名开发人员获得了传染病流行病学的以下概念基础：在一个划分为离散年龄组的人群中，直接传播感染的早期疫情增长可以用一个非负的下一代算子来表示，其最大特征值决定了基本再生数 (R0)。疫苗接种降低了接种者的易感性，从而改变了这个算子，并得出了有效再生数 (R_e)。该开发人员必须构建一个程序来计算疫苗接种后的 $R_e$，并在早期指数增长期间，识别哪个年龄组对残余传播的贡献最大。\n\n使用的基本原理：\n- 基本再生数 (R0) 是一个非负下一代矩阵的最大特征值（谱半径）。\n- 疫苗接种降低了每个接种者群组中的易感比例，从而减少了因传染性接触而产生的每代预期感染数。\n- 在一个有 $n$ 个年龄组的结构化混合模型中，设 $C$ 是一个 $n \\times n$ 的非负接触矩阵，其条目 $C_{ij}$ 是一个在 $j$ 组的人在一个传染期内对 $i$ 组接收者的平均传染性接触次数。设 $\\lambda$ 是一个非负标量，等于每次接触的传播概率与传染期长度的乘积，并设 $S_i$ 是疫苗接种后 $i$ 组接收者的易感比例。那么，疫苗接种后的下一代矩阵是非负的，其最大特征值得出 $R_e$。\n\n任务：\n- 对于每个测试用例，计算有效再生数 $R_e$，即疫苗接种后下一代矩阵的最大特征值。\n- 识别在早期指数增长阶段对残余传播贡献最大的单个年龄组（按从零开始的索引），该年龄组定义为使量 $v_j \\sum_{i=1}^{n} K_{ij}$ 最大化的源年龄组 $j$，其中 $K$ 是疫苗接种后的下一代矩阵，$v$ 是 $K$ 的主右特征向量，其条目经归一化后总和为 $1$。如果出现平局，选择最小的索引。\n- 所有覆盖率输入均为 $[0,1]$ 范围内的小数。输出不需要物理单位；$R_e$ 是无量纲的。\n\n定义和构建要求：\n- 疫苗接种后 $i$ 组接收者的易感比例为 $S_i = 1 - e_s \\cdot c_i$，其中 $c_i$ 是 $i$ 组的覆盖率，表示为小数（介于 $0$ 和 $1$ 之间），$e_s$ 是疫苗对易感性的效力（也是 $[0,1]$ 范围内的小数）。\n- 疫苗接种后的下一代矩阵是 $$K = \\lambda \\cdot \\operatorname{diag}(S) \\cdot C,$$ 其中 $\\operatorname{diag}(S)$ 是对角线上条目为 $S_1,\\dots,S_n$ 的对角矩阵。\n- 有效再生数是 $$R_e = \\rho(K),$$ 即 $K$ 的最大特征值。\n- 设 $v$ 是与 $R_e$ 相关的 $K$ 的主右特征向量，选择为实数并归一化，使得 $\\sum_{i=1}^{n} v_i = 1$。源组 $j$ 的残余传播贡献为 $$\\text{contrib}_j = v_j \\cdot \\sum_{i=1}^{n} K_{ij}.$$ 具有最大 $\\text{contrib}_j$ 的组是该测试用例的答案。\n\n程序需硬编码的输入（测试套件）：\n对于每个测试用例，程序将获得元组 $(C, c, e_s, \\lambda)$，其中：\n- $C$：一个列表的列表，表示一个 $n \\times n$ 的接触矩阵，\n- $c$：一个长度为 $n$ 的列表，包含覆盖率小数，\n- $e_s$：一个表示对易感性效力的小数，\n- $\\lambda$：一个非负标量，等于每次接触的传播概率乘以传染期长度。\n\n测试用例：\n1. 一般情况（三个年龄组，中等接种率和高效力）：\n   - $C = \\begin{bmatrix} 8.0  3.0  1.0 \\\\ 2.0  10.0  2.5 \\\\ 1.5  2.0  6.0 \\end{bmatrix}$,\n   - $c = [0.9, 0.7, 0.5]$,\n   - $e_s = 0.95$,\n   - $\\lambda = 0.08$.\n2. 边界情况（效力为零；疫苗接种无效）：\n   - $C = \\begin{bmatrix} 8.0  3.0  1.0 \\\\ 2.0  10.0  2.5 \\\\ 1.5  2.0  6.0 \\end{bmatrix}$,\n   - $c = [0.5, 0.5, 0.5]$,\n   - $e_s = 0.0$,\n   - $\\lambda = 0.08$.\n3. 四组情况（高接触组高覆盖率，高效力）：\n   - $C = \\begin{bmatrix} 12.0  2.0  1.0  0.5 \\\\ 3.0  9.0  3.0  1.0 \\\\ 1.0  2.0  8.0  2.0 \\\\ 0.5  1.0  1.5  5.0 \\end{bmatrix}$,\n   - $c = [0.3, 0.95, 0.2, 0.2]$,\n   - $e_s = 0.90$,\n   - $\\lambda = 0.06$.\n4. 接近群体免疫情景（三组，极高覆盖率和高效力）：\n   - $C = \\begin{bmatrix} 9.0  2.5  1.0 \\\\ 2.0  7.5  2.0 \\\\ 1.0  1.5  6.0 \\end{bmatrix}$,\n   - $c = [0.95, 0.85, 0.80]$,\n   - $e_s = 0.90$,\n   - $\\lambda = 0.08$.\n\n输出规范：\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，格式为用方括号括起来的逗号分隔列表。\n- 每个结果必须是一个包含两个元素的列表：第一个是浮点数 $R_e$，第二个是根据上述标准对残余传播贡献最大的年龄组的整数索引（从零开始）。\n- 示例格式：[[Re_case1,idx_case1],[Re_case2,idx_case2],[Re_case3,idx_case3],[Re_case4,idx_case4]]。", "solution": "该问题被评估为有效，因为它在科学上基于数学流行病学的既定原则，问题设定良好，定义和数据清晰完整，并且其表述是客观的。它要求将线性代数应用于结构化种群中传染病传播的标准模型。以下解决方案实现了指定的方法。\n\n问题的核心是分析定向疫苗接种运动对传染病传播动态的影响。该模型在一个划分为 $n$ 个不同年龄组的人群上运行。在疫情的早期指数增长阶段，传播动态由一个下一代矩阵控制，此处表示为 $K$。\n\n首先，我们定义构建疫苗接种后下一代矩阵 $K$ 所需的组件。\n每个年龄组 $i$ 的易感比例，表示为 $S_i$，由疫苗接种覆盖率 $c_i$ 和疫苗对易感性的效力 $e_s$ 决定。公式如下：\n$$S_i = 1 - e_s \\cdot c_i$$\n该公式代表了一个“渗漏型”疫苗模型，其中疫苗接种会降低但不一定能完全消除易感性。$i=1, \\dots, n$ 的值 $S_i$ 可以收集到一个对角矩阵 $\\operatorname{diag}(S)$ 中，其中对角线元素 $(i,i)$ 是 $S_i$，所有非对角线元素均为 $0$。\n\n传播过程本身由两个组件描述：一个接触矩阵 $C$ 和一个标量传播参数 $\\lambda$。$n \\times n$ 矩阵 $C$ 的元素 $C_{ij}$ 表示 $j$ 组中的一个感染个体与 $i$ 组中的个体发生的有效接触率。标量 $\\lambda$ 包含了每次接触的传播概率和传染期的持续时间。\n\n疫苗接种后的下一代矩阵 $K$ 是通过组合这些元素构建的。元素 $K_{ij}$ 表示在部分接种的人群中，由 $j$ 组中的单个感染个体在 $i$ 组中产生的平均新感染数。矩阵 $K$ 由下式给出：\n$$K = \\lambda \\cdot \\operatorname{diag}(S) \\cdot C$$\n\n有效再生数 $R_e$ 是一个决定疫情能否增长的阈值量。如果 $R_e  1$，感染人数将增加；而如果 $R_e  1$，疫情将减弱。对于此处使用的模型类别，$R_e$ 被定义为下一代矩阵 $K$ 的谱半径：\n$$R_e = \\rho(K)$$\n由于 $K$ 是一个非负矩阵（因为 $\\lambda \\ge 0$，$S_i \\in [0, 1]$，且 $C$ 是非负的），Perron-Frobenius 定理保证其谱半径 $\\rho(K)$ 是一个实数、非负的特征值，并且存在一个相应的非负右特征向量 $v$。这个特征向量，被称为主右特征向量，如果 $K$ 是不可约的，那么它在缩放意义上是唯一的。在归一化后，$v$ 的元素代表了指数增长阶段各年龄组中感染者的相对比例。\n\n为了识别哪个年龄组对剩余传播的贡献最大，我们使用量 $\\text{contrib}_j$。这个针对每个源组 $j$ 的度量定义为：\n$$\\text{contrib}_j = v_j \\cdot \\sum_{i=1}^{n} K_{ij}$$\n在这里，$v$ 是 $K$ 的主右特征向量，经归一化后其元素总和为 $1$（即 $\\sum_{i=1}^{n} v_i = 1$）。项 $\\sum_{i=1}^{n} K_{ij}$ 是 $K$ 的第 $j$ 列之和，代表由 $j$ 组中的单个感染个体产生的总二次感染数。因此，度量 $\\text{contrib}_j$ 用 $j$ 组中感染的相对流行率 ($v_j$) 对该繁殖输出进行加权，从而给出了源于该组的总传播量度。具有最大 $\\text{contrib}_j$ 值的组被确定为残余传播的主要驱动因素。\n\n每个测试用例的计算过程如下：\n1. 给定 $C$、$c$、$e_s$ 和 $\\lambda$，计算易感比例向量 $S$，其中 $S_i = 1 - e_s \\cdot c_i$。\n2. 构建下一代矩阵 $K = \\lambda \\cdot \\operatorname{diag}(S) \\cdot C$。\n3. 计算 $K$ 的特征值和右特征向量。\n4. 确定最大特征值，即 $R_e = \\rho(K)$。\n5. 找到相应的主右特征向量 $v$。由于数值库返回的特征向量可能是复数且具有任意符号或归一化，因此取其实部，并使其元素变为非负（例如，通过取绝对值）。\n6. 将特征向量 $v$ 归一化，使其元素总和为 $1$。\n7. 对于每个组 $j$（从 $0$ 到 $n-1$），通过对 $K$ 的列求和来计算总二次感染数 $\\sum_{i=1}^{n} K_{ij}$。\n8. 使用上述公式计算每个组的贡献 $\\text{contrib}_j$。\n9. 确定使 $\\text{contrib}_j$ 最大化的索引 $j$。如果出现平局，选择最小的索引。\n10. 测试用例的最终输出是对 $[R_e, \\text{index}]$。\n该算法应用于所提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the epidemiological problem for a set of test cases.\n    For each case, it computes the Effective Reproduction Number (R_e) and\n    identifies the age group contributing most to residual transmission.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            [[8.0, 3.0, 1.0], [2.0, 10.0, 2.5], [1.5, 2.0, 6.0]],\n            [0.9, 0.7, 0.5],\n            0.95,\n            0.08,\n        ),\n        (\n            [[8.0, 3.0, 1.0], [2.0, 10.0, 2.5], [1.5, 2.0, 6.0]],\n            [0.5, 0.5, 0.5],\n            0.0,\n            0.08,\n        ),\n        (\n            [\n                [12.0, 2.0, 1.0, 0.5],\n                [3.0, 9.0, 3.0, 1.0],\n                [1.0, 2.0, 8.0, 2.0],\n                [0.5, 1.0, 1.5, 5.0],\n            ],\n            [0.3, 0.95, 0.2, 0.2],\n            0.90,\n            0.06,\n        ),\n        (\n            [[9.0, 2.5, 1.0], [2.0, 7.5, 2.0], [1.0, 1.5, 6.0]],\n            [0.95, 0.85, 0.80],\n            0.90,\n            0.08,\n        ),\n    ]\n\n    results = []\n    for C_list, c_list, e_s, lambda_val in test_cases:\n        # Convert inputs to numpy arrays for matrix operations\n        C = np.array(C_list, dtype=float)\n        c = np.array(c_list, dtype=float)\n        n = C.shape[0]\n\n        # 1. Calculate the vector of susceptible fractions, S\n        S_vec = 1.0 - e_s * c\n        S_diag = np.diag(S_vec)\n\n        # 2. Construct the post-vaccination next-generation matrix, K\n        K = lambda_val * S_diag @ C\n\n        # 3. Compute eigenvalues and right eigenvectors of K\n        eigenvalues, eigenvectors = np.linalg.eig(K)\n\n        # 4. R_e is the largest eigenvalue (spectral radius)\n        # For non-negative matrices, the spectral radius is real and is the max of the real parts.\n        R_e = np.max(np.real(eigenvalues))\n\n        # 5. Find the dominant right eigenvector v\n        # It corresponds to the largest eigenvalue.\n        dominant_eigenvalue_idx = np.argmax(np.real(eigenvalues))\n        v = eigenvectors[:, dominant_eigenvalue_idx]\n        \n        # The eigenvector should be real and non-negative for a non-negative matrix.\n        # We take the absolute value of the real part to handle potential numerical artifacts.\n        v = np.abs(np.real(v))\n\n        # 6. Normalize v such that its elements sum to 1\n        v_normalized = v / np.sum(v)\n\n        # 7. Compute the column sums of K\n        # This represents the total number of secondary infections per infected person in each group j\n        col_sums_K = np.sum(K, axis=0)\n\n        # 8. Calculate the contribution of each group\n        # contrib_j = v_normalized_j * sum(K_ij for i in 1..n)\n        contributions = v_normalized * col_sums_K\n\n        # 9. Find the index of the group with the maximum contribution\n        # np.argmax returns the smallest index in case of a tie.\n        max_contrib_idx = np.argmax(contributions)\n\n        # 10. Store the results for this case\n        results.append([R_e, int(max_contrib_idx)])\n\n    # Final print statement in the exact required format.\n    # The format [[val1, val2], [val3, val4]] is created by default python list string representation.\n    print(f\"{results}\")\n\nsolve()\n```", "id": "5008235"}]}