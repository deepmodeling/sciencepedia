{"hands_on_practices": [{"introduction": "有效的供应链管理始于准确的需求预测。本练习将介绍一种基础技术——移动平均模型，该模型根据历史数据广泛用于预测基本药物的未来需求。通过完成这项练习 [@problem_id:4967326]，您不仅将学会如何生成预测，还将学会如何使用平均绝对百分比误差（MAPE）来评估其表现，这是优化和改进库存策略的一项关键技能。", "problem": "一个地区卫生供应团队正在为一种关键抗生素规划库存，以最大限度地减少缺货并避免库存积压。过去 $6$ 个月的月度消耗数据记录为 $[1000, 1100, 900, 1200, 1300, 1100]$ 剂，分别对应第 $1$ 个月到第 $6$ 个月。该团队使用一个 $3$ 个月移动平均需求预测模型来规划下个月。使用此模型和所提供的数据，确定第 $7$ 个月的预测需求量（以剂为单位）。此外，通过计算平均绝对百分比误差 (MAPE) 来评估该模型在第 $4$ 个月到第 $6$ 个月期间的准确性，MAPE 定义为各评估月份绝对百分比误差的平均值。\n\n以剂为单位表示第 $7$ 个月的预测值。将平均绝对百分比误差 (MAPE) 表示为小数形式，并将其四舍五入到 $4$ 位有效数字。", "solution": "在关键药物的供应链管理中，需求预测和误差评估是基于算术平均和比例误差度量。设 $D_t$ 表示第 $t$ 个月的实际消耗量（以剂为单位），并设 $\\hat{D}_t$ 表示由 $k$ 个月移动平均模型生成的第 $t$ 个月的预测值。对于 $3$ 个月移动平均，该模型使用最近 $3$ 个实现值的算术平均值来生成下个月的预测。形式上，对于 $k=3$，移动平均预测为\n$$\n\\hat{D}_{t} = \\frac{1}{3}\\left(D_{t-1} + D_{t-2} + D_{t-3}\\right),\n$$\n适用于 $t \\geq 4$，当之前 $3$ 个月的数据可用时。\n\n数据为 $D_1 = 1000$，$D_2 = 1100$，$D_3 = 900$，$D_4 = 1200$，$D_5 = 1300$，$D_6 = 1100$。\n\n首先，计算评估模型在第 $4$ 个月到第 $6$ 个月准确性所需的预测值，然后计算第 $7$ 个月的预测值。\n\n- 第 $4$ 个月：\n$$\n\\hat{D}_4 = \\frac{1}{3}\\left(D_3 + D_2 + D_1\\right) = \\frac{1}{3}\\left(900 + 1100 + 1000\\right) = \\frac{3000}{3} = 1000.\n$$\n\n- 第 $5$ 个月：\n$$\n\\hat{D}_5 = \\frac{1}{3}\\left(D_4 + D_3 + D_2\\right) = \\frac{1}{3}\\left(1200 + 900 + 1100\\right) = \\frac{3200}{3}.\n$$\n\n- 第 $6$ 个月：\n$$\n\\hat{D}_6 = \\frac{1}{3}\\left(D_5 + D_4 + D_3\\right) = \\frac{1}{3}\\left(1300 + 1200 + 900\\right) = \\frac{3400}{3}.\n$$\n\n- 第 $7$ 个月（所需的计划预测）：\n$$\n\\hat{D}_7 = \\frac{1}{3}\\left(D_6 + D_5 + D_4\\right) = \\frac{1}{3}\\left(1100 + 1300 + 1200\\right) = \\frac{3600}{3} = 1200.\n$$\n\n接下来，计算第 $4$ 到第 $6$ 个月的平均绝对百分比误差 (MAPE)。在 $n$ 个评估期内的平均绝对百分比误差 (MAPE) 定义为\n$$\n\\text{MAPE} = \\frac{1}{n}\\sum_{t}\\left|\\frac{D_t - \\hat{D}_t}{D_t}\\right|,\n$$\n其中求和遍及评估月份的集合。这里，$n = 3$ 且 $t \\in \\{4, 5, 6\\}$。\n\n计算每个绝对百分比误差：\n\n- 第 $4$ 个月：\n$$\n\\left|\\frac{D_4 - \\hat{D}_4}{D_4}\\right| = \\left|\\frac{1200 - 1000}{1200}\\right| = \\frac{200}{1200} = \\frac{1}{6}.\n$$\n\n- 第 $5$ 个月：\n$$\n\\left|\\frac{D_5 - \\hat{D}_5}{D_5}\\right| = \\left|\\frac{1300 - \\frac{3200}{3}}{1300}\\right|.\n$$\n将 $1300$ 重写为 $\\frac{3900}{3}$：\n$$\n\\left|\\frac{\\frac{3900}{3} - \\frac{3200}{3}}{1300}\\right| = \\left|\\frac{\\frac{700}{3}}{1300}\\right| = \\frac{700}{3900} = \\frac{7}{39}.\n$$\n\n- 第 $6$ 个月：\n$$\n\\left|\\frac{D_6 - \\hat{D}_6}{D_6}\\right| = \\left|\\frac{1100 - \\frac{3400}{3}}{1100}\\right|.\n$$\n将 $1100$ 重写为 $\\frac{3300}{3}$：\n$$\n\\left|\\frac{\\frac{3300}{3} - \\frac{3400}{3}}{1100}\\right| = \\left|\\frac{\\frac{-100}{3}}{1100}\\right| = \\frac{100}{3300} = \\frac{1}{33}.\n$$\n\n将这三个值取平均以得到 MAPE：\n$$\n\\text{MAPE} = \\frac{1}{3}\\left(\\frac{1}{6} + \\frac{7}{39} + \\frac{1}{33}\\right).\n$$\n为括号内的和找到一个公分母。$6$、$39$ 和 $33$ 的最小公倍数是 $858$。转换每个分数为：\n$$\n\\frac{1}{6} = \\frac{143}{858},\\quad \\frac{7}{39} = \\frac{154}{858},\\quad \\frac{1}{33} = \\frac{26}{858}.\n$$\n求和：\n$$\n\\frac{143}{858} + \\frac{154}{858} + \\frac{26}{858} = \\frac{323}{858}.\n$$\n除以 $3$：\n$$\n\\text{MAPE} = \\frac{1}{3}\\cdot\\frac{323}{858} = \\frac{323}{2574}.\n$$\n这个分数已是最简分数，因为 $323 = 17 \\times 19$ 和 $2574 = 2 \\times 3 \\times 3 \\times 11 \\times 13$ 没有共同的质因数。转换为小数并四舍五入到 $4$ 位有效数字：\n$$\n\\frac{323}{2574} \\approx 0.1254856\\ \\Rightarrow\\ \\text{MAPE} \\approx 0.1255\\ \\text{(rounded to $4$ significant figures)}.\n$$\n\n因此，第 $7$ 个月的 $3$ 个月移动平均预测值为 $1200$ 剂，而在此模型下，第 $4$ 个月到第 $6$ 个月的平均绝对百分比误差 (MAPE) 为 $0.1255$（作为小数并四舍五入到 $4$ 位有效数字）。", "answer": "$$\\boxed{\\begin{pmatrix}1200  0.1255\\end{pmatrix}}$$", "id": "4967326"}, {"introduction": "一旦您有了需求预测，下一个关键决策就是确定最佳的订购数量。订购太少会面临缺货风险，而订购太多则会导致高昂的仓储成本和浪费。经济订货量（EOQ）模型为找到这种平衡提供了一个强大的框架。这个实践问题 [@problem_id:4967285] 将引导您理解最小化总库存成本的逻辑，帮助您计算理想的订货量和再订货点，以确保基本药物的持续供应。", "problem": "一个地区卫生仓库负责确保向公共诊所持续供应一种单一的基本抗生素。该仓库采用持续审查策略，即当现有库存水平达到再订货点时，便下达一个固定规模的订单。假设满足经济订货量 (EOQ) 的经典确定性条件：需求率恒定、每次订货的固定设置成本、每单位每年的持有成本恒定、无缺货以及订单到货后即时接收。年需求量为 $D=120{,}000$ 单位/年，固定订货成本为 $S=50$ 美元 (USD)/订单，年单位持有成本为 $H=1$ 美元/单位/年。该设施每年运营 $300$ 天，平均每日需求量为 $400$ 单位/天，订货提前期为恒定的 $10$ 天。\n\n从这些假设所隐含的年订货成本和年持有成本的基本定义出发，推导使年总成本最小化的订货数量，然后计算：\n- EOQ（以单位计），\n- 给定订货提前期的再订货点（以单位计），\n- 以及年订货次数。\n\n将所有数值结果四舍五入至四位有效数字。EOQ 和再订货点以单位表示，年订货次数以订单/年表示。", "solution": "首先根据所需标准对问题进行验证。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n问题提供了以下信息：\n-   年需求量：$D=120,000$ 单位/年\n-   固定订货成本：$S=50$ 美元/订单\n-   年单位持有成本：$H=1$ 美元/单位/年\n-   运营时间：$300$ 天/年\n-   平均日需求量：$d=400$ 单位/天\n-   订货提前期：$L=10$ 天\n-   模型假设：假设满足经济订货量 (EOQ) 模型的经典确定性条件。这意味着需求率恒定、无缺货、成本固定且已知，并且订单到货后库存即时补充（尽管给出了一个非零的下单提前期）。\n\n#### 步骤 2：使用提取的已知条件进行验证\n根据既定的验证标准对问题进行审查。\n-   **科学依据**：该问题基于经济订货量 (EOQ) 模型，这是运筹学和库存管理领域的一个基础性且科学合理的原则。所列出的假设是该基础模型的标准理想化条件。\n-   **适定性**：该问题是适定的。它要求最小化一个已知存在唯一最小值的成本函数。所有必要的参数（$D$、$S$、$H$、$d$、$L$）都已提供，并且足以确定所需的量（EOQ、再订货点和订货次数）。\n-   **客观性**：该问题的表述清晰、客观，并提供了明确的定量数据和指令。\n-   **不完整或矛盾的设置**：所给数据内部一致。年需求量 $D=120,000$ 单位与日需求量 $d=400$ 单位及年运营天数正确相关（$400 \\text{ units/day} \\times 300 \\text{ days/year} = 120,000 \\text{ units/year}$）。该问题是自洽的。\n-   **不切实际或不可行**：虽然 EOQ 模型的假设是对现实的理想化，但为了应用经典模型，这些假设被明确说明。在给定背景下，数值是合理的。\n\n#### 步骤 3：结论与行动\n该问题有效，因为它科学合理、适定、客观且内部一致。将提供完整的解答。\n\n### 求解推导与计算\n\n目标是找到使库存管理相关的年总成本最小化的订货数量，记为 $Q$。年总成本 $TC(Q)$ 是年订货成本和年持有成本之和。\n\n1.  **经济订货量 (EOQ) 的推导**\n    年订货成本是每年下的订单数量乘以每次订单的固定成本 $S$。每年的订单数量是年总需求量 $D$ 除以订货数量 $Q$。\n    $$\n    \\text{Annual Ordering Cost} = S \\times \\frac{D}{Q}\n    $$\n    年持有成本是平均库存水平乘以每单位库存的年持有成本 $H$。在经典的 EOQ 模型中，库存从 $Q$ 线性消耗到 $0$，因此平均库存水平为 $\\frac{Q}{2}$。\n    $$\n    \\text{Annual Holding Cost} = H \\times \\frac{Q}{2}\n    $$\n    年总成本 $TC(Q)$ 是这两项成本之和：\n    $$\n    TC(Q) = \\frac{SD}{Q} + \\frac{HQ}{2}\n    $$\n    为了找到使 $TC(Q)$ 最小化的订货数量 $Q$，我们必须计算 $TC(Q)$ 关于 $Q$ 的一阶导数，并令其等于零。\n    $$\n    \\frac{d(TC)}{dQ} = \\frac{d}{dQ} \\left( \\frac{SD}{Q} + \\frac{HQ}{2} \\right) = -\\frac{SD}{Q^2} + \\frac{H}{2}\n    $$\n    将导数设为零以找到临界点：\n    $$\n    -\\frac{SD}{Q^2} + \\frac{H}{2} = 0 \\implies \\frac{H}{2} = \\frac{SD}{Q^2}\n    $$\n    求解 $Q$：\n    $$\n    Q^2 = \\frac{2SD}{H}\n    $$\n    $$\n    Q = \\sqrt{\\frac{2SD}{H}}\n    $$\n    这个最优订货数量就是经济订货量，即 $EOQ$。为确认此 $Q$ 值对应于一个最小值，我们检查二阶导数：\n    $$\n    \\frac{d^2(TC)}{dQ^2} = \\frac{d}{dQ} \\left( -\\frac{SD}{Q^2} + \\frac{H}{2} \\right) = \\frac{2SD}{Q^3}\n    $$\n    由于 $S$、$D$ 和 $Q$ 都是正数，所以 $\\frac{d^2(TC)}{dQ^2} > 0$，这证实了成本函数是凸函数，并且计算出的 $Q$ 是唯一的最小值。\n\n2.  **EOQ 的计算**\n    将给定值 $D=120,000$ 单位/年、$S=50$ 美元/订单和 $H=1$ 美元/单位/年代入推导出的公式：\n    $$\n    EOQ = \\sqrt{\\frac{2 \\times 50 \\times 120,000}{1}} = \\sqrt{12,000,000} \\approx 3464.1016 \\text{ units}\n    $$\n    四舍五入到四位有效数字，EOQ 为 $3464$ 单位。\n\n3.  **再订货点 (ROP) 的计算**\n    再订货点是应下新订单时的库存水平。由于订货提前期 $L$ 是恒定的，需求率 $d$ 也是恒定的，所以 ROP 是订货提前期内的需求量。\n    $$\n    ROP = d \\times L\n    $$\n    代入给定值 $d=400$ 单位/天和 $L=10$ 天：\n    $$\n    ROP = 400 \\frac{\\text{units}}{\\text{day}} \\times 10 \\text{ days} = 4000 \\text{ units}\n    $$\n    这个值是精确的。按要求以四位有效数字表示，可以写成科学记数法形式 $4.000 \\times 10^3$ 单位。\n\n4.  **年订货次数的计算**\n    年订货次数 $N$ 是年总需求量除以订货数量。对于最优策略，我们使用 $EOQ$。\n    $$\n    N = \\frac{D}{EOQ}\n    $$\n    为了在计算中获得更高精度，使用未四舍五入的 EOQ 值：\n    $$\n    N = \\frac{120,000}{\\sqrt{12,000,000}} \\approx 34.641016 \\text{ orders/year}\n    $$\n    四舍五入到四位有效数字，年订货次数为 $34.64$ 次/年。\n\n所需值为：\n-   EOQ：$3464$ 单位\n-   再订货点：$4000$ 单位\n-   年订货次数：$34.64$ 次/年", "answer": "$$\n\\boxed{\\begin{pmatrix} 3464  4.000 \\times 10^3  34.64 \\end{pmatrix}}\n$$", "id": "4967285"}, {"introduction": "许多基本药物，特别是疫苗，都具有易腐性，需要精心管理以防止浪费。这一挑战超越了简单的库存模型，引入了保质期的概念。在这个高级实践中 [@problem_id:4967232]，您将构建一个模拟来建模“先到期先出”（FEFO）库存策略，这是药品物流的基石。这项练习将让您深入了解运输计划、需求模式和产品保质期如何相互作用，使您能够量化并最终设计出减少昂贵疫苗浪费的策略。", "problem": "您需要开发一个完整的、可运行的程序，用于计算在需求恒定的确定性供应链中，采用先到期先出 (FEFO) 轮换管理的疫苗因过期而浪费的剂量的长期比例。该场景基于流量守恒和库龄结构库存动态，以纯数学术语进行描述。时间单位为月，数量单位为剂。\n\n基本依据：\n- 流量守恒：在任何时间区间内，在库库存的变化量等于流入量减去流出量再减去过期量。这是质量守恒定律在库存管理中的一种重述。\n- 确定性需求：需求是一个恒定速率 $d$（单位：剂/月）。\n- 确定性补货：每隔 $\\tau$ 个月有货运到达，批次大小为 $Q$ 剂，每剂在接收时的剩余保质期为 $L$ 个月。\n- FEFO 原则：在任何时间点，优先消耗即将到期的物品（等同于剩余保质期最短的物品）。\n- 固定寿命：任何剩余保质期达到 $0$ 的剂量都将过期并计为浪费。\n\n您的任务是推导并实现一个离散时间的库龄结构 FEFO 模拟，该模拟需符合上述基本原理，并使用以下精确的操作规则以确保得到唯一的、可测试的结果：\n- 使用固定的时间步长 $\\Delta t = 1/60$ 月（精确值），因此每个月为 $60$ 个步长。\n- 在总时长 $T = 60$ 月的范围内进行模拟，初始库存为零。\n- 为减少对初始条件的依赖，仅在最后的 $T_{\\mathrm{measure}} = 36$ 个月内计算性能。等效地，使用 $T_0 = 24$ 个月的预热期，并且仅从时间 $t \\ge T_0$ 开始测量。\n- 在每个离散时间步长 $k$（$t_k = k \\Delta t$）的状态表示：一个批次的多重集，每个批次包含剩余寿命 $\\ell$（单位：月）和数量 $q$（单位：剂）。通过始终优先消耗 $\\ell$ 最小的批次来强制执行 FEFO。\n- 在每个时间步长 $k$ 按以下顺序进行步进更新：\n  1) 如果 $t_k$ 是 $\\tau$ 的整数倍（即，在网格上精确满足 $t_k \\bmod \\tau = 0$），则接收 $Q$ 剂作为一个新批次，其剩余寿命为 $\\ell = L$。\n  2) 使用 FEFO（最旧的优先）从库存中消耗最多 $d \\Delta t$ 剂来满足需求。如果可用库存小于 $d \\Delta t$，则消耗所有可用库存，任何未满足的需求不作记录。\n  3) 将所有剩余批次的剩余寿命减少 $\\Delta t$，即 $\\ell \\leftarrow \\ell - \\Delta t$。\n  4) 将批次中剩余寿命 $\\ell \\le 0$ 的所有剂量作过期处理并移除；移除的数量在此步骤中计为浪费。\n- 度量：设 $R$ 为在 $t_k \\ge T_0$ 的步长中接收的总剂量， $W$ 为在 $t_k \\ge T_0$ 的步长中过期的总剂量。每个案例所需的输出是分数 $f = W / R$，以十进制小数表示（无单位），并四舍五入到 6 位小数。\n\n物理和数值单位：\n- 时间单位是月；数量单位是剂。\n- 输出是一个无单位的十进制小数，精确到六位小数。\n\n测试套件（每个元组为 $(d, Q, \\tau, L)$，所有量均采用上述指定单位）：\n- 案例 1（理想路径，流入与需求匹配，寿命充足）：(5000, 15000, 3, 6)。\n- 案例 2（边界情况，批次在过期时恰好完全消耗）：(10000, 60000, 3, 6)。\n- 案例 3（流入超过需求，寿命充足）：(4000, 15000, 3, 6)。\n- 案例 4（流入与需求匹配，寿命短于消耗一批次所需时间）：(5000, 20000, 4, 3)。\n- 案例 5（小批量高频次运输，流入与需求匹配，相对寿命充足）：(5000, 1000, 0.2, 2)。\n- 案例 6（流入远超需求，寿命充足）：(5000, 50000, 2, 4)。\n\n您的程序应根据上述规则计算每个案例的分数 $f$，并生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的六个结果列表，每个条目都四舍五入到六位小数，例如：\"[0.000000,0.123456,0.000000,0.250000,0.000000,0.800000]\"。", "solution": "我们将解决方案建立在流量守恒和先到期先出（FEFO）原则下的确定性库龄结构动态之上。库存是一个易腐品群体，其中每个物品的剩余寿命都会确定性地减少。核心原则是：\n\n- 物料守恒：对于任何区间 $[t_1,t_2]$，在库库存的净变化等于总流入量减去总消耗量再减去总过期量。\n- 确定性的流入和流出率：流入是周期性的（每 $\\tau$ 个月 $Q$ 剂），需求是恒定速率 $d$（剂/月）。\n- FEFO 原则：从剩余寿命最短的物品开始消耗；因此，随着库存老化，库龄结构的顺序得以保持。\n\n一个连续时间模型可以通过具有足够精细分辨率的离散时间模拟来近似。我们选择 $\\Delta t = 1/60$ 月，这个值可以精确地划分测试套件中的时间，从而确保货运时间和过期时间没有数值上的模糊性。在每个步长中，操作模拟了物理现实：\n\n- 货运接收：当 $t_k$ 是 $\\tau$ 的精确倍数时，一个数量为 $Q$、剩余寿命为 $L$ 的新批次被加入。这通过在该瞬间将在库库存增加 $Q$ 来维持守恒。\n- 需求满足：在 $\\Delta t$ 时间内，系统尝试满足 $d \\Delta t$ 剂的需求。FEFO 要求首先选择最早到期的物品。如果库存不足，则只消耗可用数量；未满足的需求与浪费无关，但能确保消耗量不超过可用量的守恒原则。\n- 老化：所有物品的剩余寿命都减少 $\\Delta t$。这代表了时间的物理流逝。\n- 过期：任何剩余寿命 $\\ell \\le 0$ 的物品都将被移除，其数量被计为浪费。这实现了固定寿命的约束。\n\n为了计算目标分数 $f = W/R$，我们在经过一个预热期以达到稳定状态后，在一个测量窗口内累积接收的剂量 $R$ 和浪费的剂量 $W$。预热期消除了对初始条件的依赖。每个测试案例产生一个单一的分数：\n\n算法设计细节：\n- 将库存表示为一个批次的有序列表 $(\\ell_i, q_i)$，其中 $\\ell_i$ 是剩余寿命， $q_i$ 是数量。该列表按 $\\ell_i$ 的非递减顺序维护，因此第一个元素是下一个要过期的。因为老化过程从每个 $\\ell_i$ 中减去相同的 $\\Delta t$，所以 $\\ell_i$ 的相对顺序得以保持。新货物的 $\\ell = L$，并被附加到列表末尾；因此，列表保持有序。\n- 需求服务从最前面的批次开始重复移除，直到该步长的需求（$d \\Delta t$）被满足或库存耗尽。这严格地维持了 FEFO 原则。\n- 在一个时间步长内的操作顺序是：收货、消耗、老化，然后是过期。这模拟了货运在步长内的即时可用性，并正确处理了恰好在寿命 $L$ 时达到过期时间的物品：在该步长老化之前消耗的任何剂量都不会被计为过期，这与连续时间极限相符。\n\n基于第一性原理的正确性论证：\n- 该模拟实现了在小步长上恒定速率下流量守恒的精确实现。当 $\\Delta t \\to 0$ 时，它收敛于由库龄结构平衡方程控制的连续时间 FEFO 动态。选择 $\\Delta t = 1/60$ 月确保了与测试套件参数（所有 $\\tau$ 和 $L$ 都是 $1/60$ 月的倍数）的精确对齐，防止了在货运时间或过期事件中出现相位误差。\n- 在稳态下，流入率为 $\\lambda_{\\mathrm{in}} = Q/\\tau$，需求为 $d$，长期浪费率必须满足 $w = \\max(0,\\lambda_{\\mathrm{in}} - \\text{吞吐量})$，其中吞吐量同时受 $d$ 和寿命约束的限制。离散 FEFO 模拟隐式地强制执行了这些约束。例如：\n  - 案例 1：$\\lambda_{\\mathrm{in}} = 5000$，$d = 5000$，消耗一个批次的时间为 $Q/d = 3$ 月 $ L = 6$ 月，因此无需过期；算法得出 $f = 0$。\n  - 案例 2（边界情况）：$Q/d = L = 6$ 月，因此每批的最后一剂恰好在过期时被消耗；FEFO 确保没有浪费，因此 $f = 0$。\n  - 案例 3：$\\lambda_{\\mathrm{in}} = 5000$，$d = 4000$。在稳态下，每月 $1000$ 的超额流入必须被浪费掉。在任何长区间内，$W/R \\to (\\lambda_{\\mathrm{in}} - d)/\\lambda_{\\mathrm{in}} = 0.2$。离散模拟再现了此比率。\n  - 案例 4：$\\lambda_{\\mathrm{in}} = d = 5000$，但 $Q/d = 4$ 月 $> L = 3$ 月，因此每批次中只有 $d \\times L = 15000$ 剂能在过期前被消耗；剩余的 $5000$ 剂会过期。因此，浪费分数为 $1 - (d \\times L) / Q = 1 - 15000 / 20000 = 0.25$。算法得出相同结果。\n  - 案例 5：$\\lambda_{\\mathrm{in}} = d = 5000$，且 $Q/d = 0.2$ 月 $ L = 2$ 月，因此批次被迅速消耗；不会发生过期， $f = 0$。\n  - 案例 6：$\\lambda_{\\mathrm{in}} = 25000$，$d = 5000$。系统只能以速率 $d$ 消耗，所以长期浪费分数为 $1 - d/\\lambda_{\\mathrm{in}} = 1 - 5000 / 25000 = 0.8$。由于库存总是充足的，寿命和 FEFO 排序不会进一步限制吞吐量；算法得出 $f \\approx 0.8$。\n\n数值输出：\n- 每个案例产生一个无单位的十进制小数，四舍五入到六位小数。预期结果是：\n  - 案例 1: $0.000000$。\n  - 案例 2: $0.000000$。\n  - 案例 3: $0.200000$。\n  - 案例 4: $0.250000$。\n  - 案例 5: $0.000000$。\n  - 案例 6: $0.800000$。\n\n程序必须精确实现所描述的模拟，并按指定格式将结果打印为单行列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fefo_waste_fraction(demand_per_month, shipment_size, shipment_interval_months, shelf_life_months,\n                        dt=1/60, total_months=60, warmup_months=24):\n    \"\"\"\n    Simulate FEFO perishable inventory with deterministic demand and shipments.\n    Returns the long-run waste fraction W/R over the measurement window.\n    \"\"\"\n    steps = int(round(total_months / dt))\n    warmup_steps = int(round(warmup_months / dt))\n\n    tau = shipment_interval_months\n    L = shelf_life_months\n    Q = shipment_size\n    d = demand_per_month\n\n    # Steps per shipment interval and shelf-life, assumed to be integers on the given grid\n    # Ensure alignment with the grid to avoid floating timing errors.\n    if tau > 0:\n        ship_interval_steps = int(round(tau / dt))\n    else:\n        ship_interval_steps = None  # No shipments if tau == 0 (not used in our test suite)\n\n    # Inventory represented as list of [remaining_life, quantity], sorted by remaining_life ascending (oldest first)\n    inventory = []\n\n    total_received = 0.0\n    total_wasted = 0.0\n\n    for k in range(steps):\n        t_k = k * dt\n\n        # 1) Shipment arrival at exact multiples of tau (on the discrete grid)\n        if ship_interval_steps is not None and (k % ship_interval_steps == 0):\n            # Add new batch with remaining life L at the end (newest, latest expiry)\n            inventory.append([L, float(Q)])\n            if k >= warmup_steps:\n                total_received += Q\n\n        # 2) Serve demand using FEFO: consume from the batch with smallest remaining life first\n        remaining_demand = d * dt\n        # Consume while there is demand and inventory\n        # Inventory is kept in ascending order of remaining life, so pop from front\n        idx = 0\n        while remaining_demand > 1e-12 and idx  len(inventory):\n            life, qty = inventory[idx]\n            if qty = remaining_demand + 1e-12:\n                # consume entire batch\n                consumed = qty\n                remaining_demand -= consumed\n                # remove this batch\n                inventory.pop(idx)\n                # do not increment idx because we removed current element\n            else:\n                # partially consume this batch\n                inventory[idx][1] = qty - remaining_demand\n                remaining_demand = 0.0\n                idx += 1  # move to next batch (though demand is zero, loop will exit)\n\n        # 3) Age all batches by dt\n        for i in range(len(inventory)):\n            inventory[i][0] -= dt\n\n        # 4) Expire and remove any batches with nonpositive remaining life\n        # Because aging was uniform, all expired batches will be at the front\n        waste_this_step = 0.0\n        while inventory and inventory[0][0] = 1e-14:\n            # All remaining quantity in this batch expires\n            waste_this_step += inventory[0][1]\n            inventory.pop(0)\n        if k >= warmup_steps:\n            total_wasted += waste_this_step\n\n        # Inventory remains sorted: new batches added at the end, aging preserves order,\n        # and we only consume from the front.\n\n    if total_received == 0:\n        return 0.0\n    return total_wasted / total_received\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (demand_per_month, shipment_size, shipment_interval_months, shelf_life_months)\n    test_cases = [\n        (5000.0, 15000.0, 3.0, 6.0),     # Case 1\n        (10000.0, 60000.0, 3.0, 6.0),    # Case 2\n        (4000.0, 15000.0, 3.0, 6.0),     # Case 3\n        (5000.0, 20000.0, 4.0, 3.0),     # Case 4\n        (5000.0, 1000.0, 0.2, 2.0),      # Case 5\n        (5000.0, 50000.0, 2.0, 4.0),     # Case 6\n    ]\n\n    results = []\n    for case in test_cases:\n        d, Q, tau, L = case\n        frac = fefo_waste_fraction(d, Q, tau, L, dt=1/60, total_months=60, warmup_months=24)\n        # Round to 6 decimals as specified\n        results.append(f\"{frac:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "4967232"}]}