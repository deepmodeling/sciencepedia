{"hands_on_practices": [{"introduction": "At the heart of interoperability is the ability to represent clinical data accurately and unambiguously. This exercise focuses on the FHIR `Quantity` data type, a fundamental building block for observations like lab results, and its use of the Unified Code for Units of Measure (UCUM) to provide semantic clarity. You will practice ensuring data fidelity by performing an error analysis on unit conversions, a critical skill for preventing information loss and potential patient safety issues when systems exchange data [@problem_id:4839897].", "problem": "A hospital laboratory produces blood glucose results as integers in milligrams per deciliter, written using Unified Code for Units of Measure (UCUM) as $\\mathrm{mg/dL}$. These results are exchanged using the Fast Healthcare Interoperability Resources (FHIR) standard, specifically as a Quantity whose essential fields include a decimal numeric value, a human-readable unit string, a UCUM system identifier, and a UCUM unit code. Some FHIR clients request glucose values in millimoles per liter, written as $\\mathrm{mmol/L}$, and the server performs conversions both ways.\n\nAssume the following scientifically grounded facts:\n1. The molecular weight of D-glucose is $M = 180.15588$ $\\mathrm{g/mol}$.\n2. The exact unit conversion from $\\mathrm{mg/dL}$ to $\\mathrm{mmol/L}$ is derived from base definitions: $\\mathrm{mg/dL}$ means milligrams per deciliter, and $\\mathrm{mmol/L}$ means millimoles per liter. Let $x$ denote a true glucose concentration in $\\mathrm{mg/dL}$ and let $y$ denote the corresponding true concentration in $\\mathrm{mmol/L}$. Use base unit transformations and $M$ to derive $y$ from $x$.\n3. Typical adult glucose values lie in the range $x \\in [40, 400]$ $\\mathrm{mg/dL}$.\n\nTo avoid clinically meaningful loss of precision in serialized data, the system enforces this validation rule: for any integer $x \\in [40, 400]$, when converting $x$ (in $\\mathrm{mg/dL}$) to $y$ (in $\\mathrm{mmol/L}$), then rounding $y$ to $n$ significant figures for serialization, then converting back to $\\mathrm{mg/dL}$ and rounding to the nearest integer, the final integer must equal the original $x$. Assume rounding to $n$ significant figures is performed by round-to-nearest and that the bound for the rounding error in the $\\mathrm{mmol/L}$ domain is $\\pm \\frac{1}{2}$ of the quantization step determined by the magnitude of $y$ and $n$. Also assume integer rounding in $\\mathrm{mg/dL}$ is round-to-nearest, and that preserving the original integer $x$ is guaranteed if the absolute $\\mathrm{mg/dL}$ error after reconversion is strictly less than $0.5$.\n\nDesign the Quantity representation by naming the necessary fields and their UCUM bindings conceptually, then derive the conversion relationship between $\\mathrm{mg/dL}$ and $\\mathrm{mmol/L}$ from first principles using $M$. Using this relationship, and considering the entire range $x \\in [40, 400]$, determine the smallest integer $n$ such that the above validation rule holds for all $x$ in the range. Your final answer must be the single integer $n$.", "solution": "The problem asks for the minimum integer number of significant figures, $n$, required to represent a blood glucose value in $\\mathrm{mmol/L}$ such that a round-trip conversion from an integer $\\mathrm{mg/dL}$ value, $x$, and back results in the original integer. This must hold for all integer values of $x$ in the range $[40, 400]$.\n\nFirst, as per the problem's request to design the `Quantity` representation, a Fast Healthcare Interoperability Resources (FHIR) `Quantity` for a glucose value of $x \\ \\mathrm{mg/dL}$ would typically be structured with the following fields:\n- `value`: The numeric value, e.g., $100.0$ for an input of $100$.\n- `unit`: A human-readable string, e.g., \"milligrams per deciliter\".\n- `system`: The URI for the code system, which for UCUM is `\"http://unitsofmeasure.org\"`.\n- `code`: The case-sensitive UCUM code, `mg/dL`.\n\nFor the converted value in $\\mathrm{mmol/L}$:\n- `value`: The decimal result of the conversion.\n- `unit`: \"millimoles per liter\".\n- `system`: `\"http://unitsofmeasure.org\"`.\n- `code`: `mmol/L`.\n\nThe core of the problem is to determine the necessary precision $n$ for this converted value.\n\nLet $x$ be the glucose concentration in $\\mathrm{mg/dL}$ and $y$ be the concentration in $\\mathrm{mmol/L}$. We first derive the conversion factor from first principles. The molecular weight of D-glucose is given as $M = 180.15588 \\ \\mathrm{g/mol}$.\n\nTo convert $\\mathrm{mg/dL}$ to $\\mathrm{mmol/L}$, we perform unit conversions:\n$1 \\ \\mathrm{mg} = 10^{-3} \\ \\mathrm{g}$\nThe number of moles in $1 \\ \\mathrm{g}$ of glucose is $\\frac{1}{M} \\ \\mathrm{mol}$.\nSo, $1 \\ \\mathrm{mg}$ of glucose is equivalent to $10^{-3} \\times \\frac{1}{M} \\ \\mathrm{mol} = \\frac{10^{-3}}{M} \\ \\mathrm{mol}$.\nSince $1 \\ \\mathrm{mol} = 10^3 \\ \\mathrm{mmol}$, we have $1 \\ \\mathrm{mg} = \\frac{10^{-3}}{M} \\times 10^3 \\ \\mathrm{mmol} = \\frac{1}{M} \\ \\mathrm{mmol}$.\n\nThe volume unit conversion is $1 \\ \\mathrm{dL} = 10^{-1} \\ \\mathrm{L}$.\n\nCombining these, we establish the relationship between $y$ and $x$:\n$$y \\ \\left[\\frac{\\mathrm{mmol}}{\\mathrm{L}}\\right] = x \\ \\left[\\frac{\\mathrm{mg}}{\\mathrm{dL}}\\right] = x \\times \\frac{\\frac{1}{M} \\ \\mathrm{mmol}}{10^{-1} \\ \\mathrm{L}} = x \\times \\frac{10}{M} \\ \\frac{\\mathrm{mmol}}{\\mathrm{L}}$$\nLet the conversion factor be $k = \\frac{10}{M}$. The conversion is $y = kx$.\n\nThe round-trip conversion process is as follows:\n1. Start with an integer glucose value $x_0$ where $x_0 \\in [40, 400]$.\n2. Convert to $\\mathrm{mmol/L}$: $y_0 = kx_0$.\n3. Round $y_0$ to $n$ significant figures to get $y'$. Let the rounding error be $\\Delta y = y' - y_0$.\n4. Convert $y'$ back to $\\mathrm{mg/dL}$: $x' = y'/k$.\n5. Round $x'$ to the nearest integer to get $x''$.\n\nThe validation rule requires $x'' = x_0$. This is guaranteed if the absolute error in the reconverted value is strictly less than $0.5$, i.e., $|x' - x_0| < 0.5$.\nLet's express this error in terms of the rounding error $\\Delta y$:\n$$|x' - x_0| = \\left|\\frac{y'}{k} - \\frac{y_0}{k}\\right| = \\frac{|y' - y_0|}{k} = \\frac{|\\Delta y|}{k}$$\nThe condition for a successful round-trip is $\\frac{|\\Delta y|}{k} < 0.5$, which is equivalent to $|\\Delta y| < 0.5k$.\n\nNext, we analyze the rounding error $|\\Delta y|$. Rounding a number to $n$ significant figures involves quantization. The quantization step size, $s$, depends on the magnitude of the number being rounded. For a number $y_0$, let $p = \\lfloor \\log_{10}(y_0) \\rfloor$. The position of the most significant digit is $10^p$. The position of the $n$-th significant digit is $10^{p - (n-1)}$. This defines the step size:\n$$s = 10^{p-n+1} = 10^{\\lfloor \\log_{10}(y_0) \\rfloor - n + 1}$$\nWhen rounding to the nearest value, the absolute error $|\\Delta y|$ is bounded by half the step size: $|\\Delta y| \\le \\frac{s}{2}$.\n\nTo satisfy the strict inequality $|\\Delta y| < 0.5k$, the upper bound of the error must be less than the threshold:\n$$\\frac{s}{2} < 0.5k \\implies s < k$$\nSubstituting the expression for $s$:\n$$10^{\\lfloor \\log_{10}(y_0) \\rfloor - n + 1} < k$$\nTo solve for $n$, we take the base-10 logarithm of both sides:\n$$\\lfloor \\log_{10}(y_0) \\rfloor - n + 1 < \\log_{10}(k)$$\n$$n > \\lfloor \\log_{10}(y_0) \\rfloor + 1 - \\log_{10}(k)$$\nThis inequality for $n$ must hold for any integer $x_0 \\in [40, 400]$. The term $\\log_{10}(k)$ is a constant. We must find the maximum value of the right-hand side, which depends on the value of $\\lfloor \\log_{10}(y_0) \\rfloor$. Since the floor function is non-decreasing, we need to find the maximum value of $\\lfloor \\log_{10}(y_0) \\rfloor$ over the specified range of $x_0$.\n\nThe range of $y_0$ is determined by the range of $x_0$:\n$y_0 = kx_0 = \\frac{10}{M}x_0 = \\frac{10}{180.15588}x_0$.\nFor the minimum $x_0 = 40$:\n$y_{min} = \\frac{400}{180.15588} \\approx 2.22029$\n$\\log_{10}(y_{min}) \\approx 0.3464$, so $\\lfloor \\log_{10}(y_{min}) \\rfloor = 0$.\n\nFor the maximum $x_0 = 400$:\n$y_{max} = \\frac{4000}{180.15588} \\approx 22.2029$\n$\\log_{10}(y_{max}) \\approx 1.3464$, so $\\lfloor \\log_{10}(y_{max}) \\rfloor = 1$.\n\nThe value of $\\lfloor \\log_{10}(y_0) \\rfloor$ is not constant over the range. It is $0$ for $y_0 < 10$ and $1$ for $y_0 \\ge 10$. The threshold $y_0=10$ corresponds to $x_0 = 10/k = M = 180.15588$.\nFor integer $x_0 \\le 180$, $y_0 < 10$ and $\\lfloor \\log_{10}(y_0) \\rfloor = 0$.\nFor integer $x_0 \\ge 181$, $y_0 > 10$ and $\\lfloor \\log_{10}(y_0) \\rfloor = 1$.\n\nTo ensure the inequality holds for the entire range, we must choose $n$ based on the worst-case scenario, which is the one that places the greatest lower bound on $n$. This occurs when $\\lfloor \\log_{10}(y_0) \\rfloor$ is maximal, i.e., $\\lfloor \\log_{10}(y_0) \\rfloor = 1$.\nThe condition becomes:\n$$n > 1 + 1 - \\log_{10}(k) = 2 - \\log_{10}(k)$$\nNow, we substitute $k = \\frac{10}{M}$:\n$\\log_{10}(k) = \\log_{10}\\left(\\frac{10}{M}\\right) = \\log_{10}(10) - \\log_{10}(M) = 1 - \\log_{10}(M)$.\nSubstituting this into the inequality for $n$:\n$$n > 2 - (1 - \\log_{10}(M))$$\n$$n > 1 + \\log_{10}(M)$$\nUsing the given value $M = 180.15588$:\n$$n > 1 + \\log_{10}(180.15588)$$\nCalculating the logarithm:\n$\\log_{10}(180.15588) \\approx 2.25565$.\nSo, the condition is:\n$$n > 1 + 2.25565$$\n$$n > 3.25565$$\nSince $n$ must be an integer, the smallest integer value for $n$ that satisfies this strict inequality is $4$.\nTherefore, a minimum of $4$ significant figures is required for the concentration in $\\mathrm{mmol/L}$ to ensure the round-trip conversion from and to integer $\\mathrm{mg/dL}$ is lossless across the entire specified range.", "answer": "$$\\boxed{4}$$", "id": "4839897"}, {"introduction": "While individual data points are crucial, their true power comes from their context within a larger resource structure. This practice delves into the core of FHIR's adaptability: profiling. You will work with the `StructureDefinition` resource to understand how a \"differential\" of changes is applied to a base resource to generate a complete \"snapshot,\" including the powerful technique of \"slicing\" to constrain repeating elements. This exercise provides a concrete, hands-on understanding of the mechanics that allow FHIR to be tailored for specific use cases [@problem_id:4839932].", "problem": "You are given a partial base profile of the Fast Healthcare Interoperability Resources (FHIR) standard for the Patient resource. Fast Healthcare Interoperability Resources (FHIR) defines the notion of a StructureDefinition that describes the content constraints of a resource, in two parts: a “differential” (which specifies the changes against a base) and a “snapshot” (which is the fully expanded, merged, and ordered list of all element definitions after applying the differential to the base). In FHIR, an element may be “sliced,” which introduces named sub-definitions (slices) for repeated elements, governed by slicing rules, and the snapshot contains entries for the base sliced element followed by its slice entries and their child elements.\n\nUse the following well-tested facts as the foundational base for reasoning:\n- In a snapshot, each element in the resource tree contributes one ElementDefinition entry. Primitive elements contribute only their own entry; complex elements contribute their own entry and the entries of their children.\n- When an element is sliced, the snapshot includes the base element (with slicing metadata), and then one entry per named slice; the children of each slice are listed beneath the slice entry. The base sliced element does not list its own children in the snapshot; only the slices do.\n- Differential constraints must preserve invariants such as cardinality consistency: slice cardinalities must be compatible with the base element’s cardinality, and slicing rules must remain consistent with the declared discriminator.\n\nFor this problem, consider only the following subset of Patient elements and their base cardinalities, and ignore all other Patient elements not listed below. Treat the listed complex datatypes as having only the specified child elements for counting purposes.\n\nBase Patient subset and structure (cardinalities shown as $m..n$, where $n=\\ast$ means unbounded):\n- Patient (root element; implicit cardinality $0..1$ for counting purposes).\n- Patient.identifier with base cardinality $0..\\ast$ and datatype Identifier having exactly two children for this problem: Identifier.system ($0..1$) and Identifier.value ($0..1$).\n- Patient.telecom with base cardinality $0..\\ast$ and datatype ContactPoint having exactly two children for this problem: ContactPoint.system ($0..1$) and ContactPoint.value ($0..1$).\n- Patient.gender with base cardinality $0..1$ and no children for this problem.\n- Patient.birthDate with base cardinality $0..1$ and no children for this problem.\n- Patient.name with base cardinality $0..\\ast$ and datatype HumanName having exactly two children for this problem: HumanName.family ($0..1$) and HumanName.given ($0..\\ast$). For counting purposes, treat HumanName.given as a child entry with no further children.\n\nNow define a constrained StructureDefinition differential that applies the following changes while preserving base invariants and slicing rules:\n- Slice Patient.identifier by the discriminator on Identifier.system value, introducing exactly two named slices:\n  - Patient.identifier:ssn with cardinality $0..1$, fixing Identifier.system to a specific URI indicative of social security numbers. Identifier.value remains $0..1$.\n  - Patient.identifier:mrn with cardinality $1..\\ast$, fixing Identifier.system to a specific URI indicative of medical record numbers. Identifier.value remains $0..1$.\n  The slicing must be disjoint and compatible with the base Patient.identifier cardinality $0..\\ast$.\n- Constrain Patient.telecom minimum cardinality to $1$ (resulting cardinality $1..\\ast$), but do not slice Patient.telecom. Its children remain ContactPoint.system ($0..1$) and ContactPoint.value ($0..1$).\n- Constrain Patient.name minimum cardinality to $1$ (resulting cardinality $1..\\ast$), but do not slice Patient.name. Its children remain HumanName.family ($0..1$) and HumanName.given ($0..\\ast$).\n- Constrain Patient.gender to bind to a required value set; this does not introduce children nor slicing.\n- Patient.birthDate is unchanged.\n\nConstruct the implied differential conceptually as described and, using the stated FHIR snapshot semantics, compute the total number $N$ of ElementDefinition entries in the resulting snapshot for this subset. Your answer must be a single integer. Do not introduce any elements beyond those listed. Do not consider extensions, modifiers, or any children other than those explicitly specified here. Provide the final numeric answer for $N$ with no units.", "solution": "The problem requires the computation of the total number, $N$, of `ElementDefinition` entries in a Fast Healthcare Interoperability Resources (FHIR) `StructureDefinition` snapshot. The computation is based on a specified base `Patient` resource profile subset and a set of differential constraints. The process is governed by the provided rules for snapshot generation.\n\nFirst, we must validate the problem statement.\nThe givens are:\n1.  A set of rules for snapshot generation:\n    - Each element in the resource tree contributes one `ElementDefinition` entry.\n    - Primitive elements contribute one entry.\n    - Complex elements contribute one entry for themselves plus entries for their children.\n    - A sliced element contributes one entry for the slicing base, one entry for each named slice, and entries for the children of each slice (not the children of the base).\n2.  A base `Patient` resource structure subset with specific elements and their cardinalities:\n    - `Patient`: root ($0..1$)\n    - `Patient.identifier`: $0..\\ast$, complex (`Identifier` with $2$ children: `.system` $0..1$, `.value` $0..1$)\n    - `Patient.telecom`: $0..\\ast$, complex (`ContactPoint` with $2$ children: `.system` $0..1$, `.value` $0..1$)\n    - `Patient.gender`: $0..1$, primitive\n    - `Patient.birthDate`: $0..1$, primitive\n    - `Patient.name`: $0..\\ast$, complex (`HumanName` with $2$ children: `.family` $0..1$, `.given` $0..\\ast$)\n3.  A differential with specific constraints:\n    - `Patient.identifier` is sliced into two named slices, `:ssn` (cardinality $0..1$) and `:mrn` (cardinality $1..\\ast$).\n    - `Patient.telecom` cardinality is changed to $1..\\ast$.\n    - `Patient.name` cardinality is changed to $1..\\ast$.\n    - `Patient.gender` is bound to a value set.\n    - `Patient.birthDate` is unchanged.\n\nThe problem is scientifically grounded in the formal FHIR specification, a recognized standard in medical informatics. It is well-posed, providing a clear, self-contained set of rules and data sufficient to derive a unique integer solution. The constraints provided in the differential, such as the cardinalities of the slices of `Patient.identifier` (`0..1` for `:ssn` and $1..\\ast$ for `:mrn`), are mathematically consistent with the base element's cardinality of $0..\\ast$, as the union of their scopes is a valid subset of the base scope. The problem uses objective, technical language and is free of ambiguities. Therefore, the problem is deemed valid and a solution can be derived.\n\nThe total number of `ElementDefinition` entries, $N$, is the sum of the entries contributed by each element in the final snapshot structure. We will calculate the contribution of each top-level element and its descendants.\n\n1.  **Patient root element**: The root of the resource itself always counts as one entry.\n    - Contribution: $1$ entry.\n\n2.  **Patient.identifier**: This element is sliced. According to the stated rules:\n    - The base `Patient.identifier` element contributes one entry, which contains the slicing metadata but does not list children.\n    - Each of the two named slices, `Patient.identifier:ssn` and `Patient.identifier:mrn`, contributes one entry.\n    - The children of each slice are then listed. The `Identifier` datatype has $2$ specified children (`.system` and `.value`).\n    - For the `:ssn` slice: $1$ entry for `Patient.identifier:ssn` plus $2$ entries for its children (`Patient.identifier:ssn.system`, `Patient.identifier:ssn.value`). Total is $1+2=3$.\n    - For the `:mrn` slice: $1$ entry for `Patient.identifier:mrn` plus $2$ entries for its children (`Patient.identifier:mrn.system`, `Patient.identifier:mrn.value`). Total is $1+2=3$.\n    - Total contribution from the `Patient.identifier` group: $1$ (base) + $3$ (ssn slice and children) + $3$ (mrn slice and children) = $7$ entries.\n\n3.  **Patient.telecom**: This is a complex element that is not sliced. The differential changes its cardinality to $1..\\ast$, but this does not affect the number of defining elements in the snapshot.\n    - It contributes one entry for itself (`Patient.telecom`).\n    - Its datatype, `ContactPoint`, has $2$ specified children (`.system` and `.value`). These contribute two more entries.\n    - Total contribution from `Patient.telecom`: $1$ (self) + $2$ (children) = $3$ entries.\n\n4.  **Patient.gender**: This is a primitive element. Its cardinality is $0..1$. The constraint to bind to a value set does not change its structural definition or add children.\n    - It contributes one entry for itself.\n    - Total contribution: $1$ entry.\n\n5.  **Patient.birthDate**: This is a primitive element with cardinality $0..1$. It is unchanged by the differential.\n    - It contributes one entry for itself.\n    - Total contribution: $1$ entry.\n\n6.  **Patient.name**: This is a complex element, not sliced. The differential changes its cardinality to $1..\\ast$.\n    - It contributes one entry for itself (`Patient.name`).\n    - Its datatype, `HumanName`, has $2$ specified children (`.family` and `.given`), contributing two more entries. The cardinality of `.given` ($0..\\ast$) does not affect the element count, as it is still a single definition.\n    - Total contribution from `Patient.name`: $1$ (self) + $2$ (children) = $3$ entries.\n\nFinally, we sum the contributions from all parts to find the total number of `ElementDefinition` entries, $N$.\n$N = (\\text{Patient}) + (\\text{Patient.identifier group}) + (\\text{Patient.telecom group}) + (\\text{Patient.gender}) + (\\text{Patient.birthDate}) + (\\text{Patient.name group})$\n$N = 1 + 7 + 3 + 1 + 1 + 3$\n$N = 16$\n\nTherefore, the total number of `ElementDefinition` entries in the resulting snapshot is $16$.", "answer": "$$\n\\boxed{16}\n$$", "id": "4839932"}, {"introduction": "Once data structures are well-defined, systems must interact with them in a predictable and robust manner. This problem explores the dynamic aspect of FHIR through its RESTful API, focusing on a common but complex interaction: the \"conditional create.\" By analyzing a scenario where a conditional request encounters multiple matches, you will learn to apply the rules of both the FHIR specification and the underlying HTTP protocol to determine the correct server response, including the construction of a detailed `OperationOutcome` resource to guide the client application [@problem_id:4839847].", "problem": "A client issues a Hypertext Transfer Protocol (HTTP) conditional create to a Fast Healthcare Interoperability Resources (FHIR) server by sending a POST to the Patient endpoint with the FHIR-defined precondition header If-None-Exist carrying a search expression that uniquely identifies a patient by identifier. The server evaluates the search and finds that there are $m = 3$ existing Patient resources that satisfy the search expression due to data duplication in the master patient index. The client’s request body is a valid Patient resource.\n\nBase facts you may assume:\n- Under Request for Comments (RFC) semantics for HTTP conditional requests (Request for Comments (RFC) $9110$), when a request includes a conditional precondition and the precondition evaluates to false on the server, the correct response is a client error indicating a precondition failure.\n- Under the FHIR RESTful API behavior, a conditional create with If-None-Exist must not create a new resource if any existing resource matches the supplied search expression. If exactly one match exists, the server may return an existing resource instead of creating a new one; if more than one match exists, the condition “none exist” is not satisfied.\n\nThe server follows this OperationOutcome policy on $4xx$ responses:\n- It returns an OperationOutcome with exactly one issue of severity “error” summarizing the reason the precondition failed.\n- It also returns one issue of severity “information” for each matched resource, each containing a reference to the matched resource’s logical identifier.\n- It returns no “warning” or “fatal” issues in this scenario.\n\nTasks:\n1. Derive the correct HTTP status code $s$ for this response using the above base facts and the semantics of HTTP preconditions in RFC $9110$ and FHIR conditional create behavior.\n2. Compute the number of OperationOutcome issues by severity: the count of “error” issues $e$, the count of “warning” issues $w$, and the count of “information” issues $i$.\n3. To produce a single numeric output, compute the scalar\n$$S \\;=\\; s \\;+\\; 3\\,e \\;+\\; 1\\,w \\;+\\; 0\\,i.$$\n\nProvide the final value of $S$ as a single number. No rounding is needed. Do not include any units.", "solution": "The problem requires the calculation of a scalar value $S$ based on parameters derived from a specific Fast Healthcare Interoperability Resources (FHIR) server interaction. The validation of the problem statement is the prerequisite first step.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Interaction Type**: A Hypertext Transfer Protocol (HTTP) conditional create request.\n- **HTTP Method**: `POST`.\n- **Target Endpoint**: `Patient`.\n- **Conditional Header**: `If-None-Exist` with a search expression.\n- **Server State**: The search expression matches $m = 3$ existing `Patient` resources.\n- **Request Body**: A valid `Patient` resource.\n- **Base Fact (RFC 9110)**: If a precondition evaluates to false, the response is a client error for precondition failure.\n- **Base Fact (FHIR)**: A conditional create with `If-None-Exist` must not create a new resource if any existing resource matches. If more than one match exists, the condition “none exist” is not satisfied.\n- **Server `OperationOutcome` Policy (for $4xx$ responses)**:\n    - Returns exactly one issue of severity “error”.\n    - Returns one issue of severity “information” for each matched resource.\n    - Returns no “warning” or “fatal” issues.\n- **Tasks**:\n    1. Derive the HTTP status code $s$.\n    2. Compute the number of `OperationOutcome` issues: $e$ (“error”), $w$ (“warning”), and $i$ (“information”).\n    3. Compute the scalar $S = s + 3e + 1w + 0i$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is grounded in the formal specifications of HTTP (RFC 9110) and the FHIR standard. These are established technical standards in computer science and medical informatics, serving as the fundamental principles for this context. The scenario is technically sound.\n- **Well-Posedness**: The problem provides all necessary data and constraints to logically deduce a unique solution. The question is unambiguous and the objective is clear.\n- **Objectivity**: The problem is expressed in precise, technical language referencing specific standards and policies. It is free of subjective or opinion-based statements.\n- **Conclusion**: The problem is valid as it is self-contained, consistent, and grounded in established technical standards. It does not violate any of the invalidity criteria.\n\n### Problem Solution\n\nThe solution proceeds by determining the values for $s$, $e$, $w$, and $i$ based on the provided facts and then calculating $S$.\n\n**1. Derivation of the HTTP Status Code ($s$)**\nThe request is a conditional `POST` using the `If-None-Exist` header. The condition is that no resources should exist matching the provided search criteria. The problem states that the server finds $m = 3$ matching resources.\n\n- Since the number of matches, $m = 3$, is greater than $0$, the condition \"none exist\" is false.\n- The FHIR specification confirms this: \"if more than one match exists, the condition 'none exist' is not satisfied.\"\n- The problem references RFC 9110, which governs HTTP conditional requests. The base fact states that when a precondition evaluates to false, the server should respond with a client error indicating a precondition failure.\n- The standard HTTP status code for a precondition failure is `412 Precondition Failed`.\n- Therefore, the HTTP status code $s$ is $412$.\n\n$s = 412$\n\n**2. Computation of `OperationOutcome` Issue Counts ($e, w, i$)**\nThe server's response for a $4xx$ error includes an `OperationOutcome` resource. The problem explicitly defines the policy for constructing this resource.\n\n- **Count of \"error\" issues ($e$)**: The policy states that the server \"returns an OperationOutcome with exactly one issue of severity 'error'\".\n  Therefore, $e = 1$.\n\n- **Count of \"warning\" issues ($w$)**: The policy states that the server \"returns no 'warning' ... issues in this scenario\".\n  Therefore, $w = 0$.\n\n- **Count of \"information\" issues ($i$)**: The policy states that the server \"returns one issue of severity 'information' for each matched resource\".\n  The number of matched resources is given as $m = 3$.\n  Therefore, $i = m = 3$.\n\n**3. Calculation of the Scalar $S$**\nThe final step is to compute the scalar $S$ using the formula provided and the values derived above.\nThe formula is:\n$$S = s + 3e + 1w + 0i$$\nSubstituting the derived values:\n- $s = 412$\n- $e = 1$\n- $w = 0$\n- $i = 3$\n\nThe calculation is as follows:\n$$S = 412 + 3(1) + 1(0) + 0(3)$$\n$$S = 412 + 3 + 0 + 0$$\n$$S = 415$$\nThe final value of the scalar $S$ is $415$.", "answer": "$$\\boxed{415}$$", "id": "4839847"}]}