{"hands_on_practices": [{"introduction": "Before genomic data can be used for clinical decision-making, we must be confident in its accuracy. This practice introduces the Phred-scaled Genotype Quality ($GQ$) score, a standard metric for quantifying the probability of a genotyping error. By working through this exercise [@problem_id:4845063], you will learn how to translate this abstract score into a concrete error probability and apply this knowledge to set a practical quality threshold for clinical reporting, a crucial step in ensuring patient safety.", "problem": "A hospital is integrating clinical genomics into its Electronic Health Record (EHR) system. The variant calling pipeline provides a per-genotype confidence score called Genotype Quality (GQ), reported on the Phred scale. The Phred scale is defined by the relationship between a quality score $Q$ and a probability of error $p$ as $Q=-10\\log_{10}(p)$. The hospital plans to report $N=200$ pharmacogenomic genotype calls per patient, and wishes to set a minimum $GQ$ threshold for reporting such that the expected number of false genotype calls per patient does not exceed a tolerance $\\alpha=0.05$. Assume each reported genotype call has the same error probability determined only by its $GQ$, and that the expected number of false calls is the sum of the individual error probabilities.\n(a) Starting from the Phred definition $Q=-10\\log_{10}(p)$, express the error probability $p$ as a function of $GQ$.\n(b) Using your expression, determine the probability of a false genotype call for $GQ=20$.\n(c) Derive the smallest integer threshold $GQ^{\\ast}$ such that the expected number of false genotype calls across all $N=200$ reported genotypes is at most $\\alpha=0.05$. Provide your final answers for parts (b) and (c) in the order $(p \\text{ at } GQ=20,\\; GQ^{\\ast})$. No units are required. Rounding is not required for part (b). For part (c), report the smallest integer $GQ^{\\ast}$ that satisfies the constraint.", "solution": "The problem requires us to perform calculations related to the Phred quality scale in the context of genomic data analysis. We will first validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Definition of Phred quality score $Q$: $Q = -10 \\log_{10}(p)$, where $p$ is the probability of error. The problem uses $GQ$ to denote this score.\n- Number of pharmacogenomic genotype calls per patient: $N = 200$.\n- Tolerance for the expected number of false genotype calls per patient: $\\alpha = 0.05$.\n- Assumption 1: Each reported genotype has an error probability $p$ determined by its $GQ$ score. For setting a threshold, we assume all reported calls have a quality score equal to the minimum threshold, which represents the worst-case scenario.\n- Assumption 2: The expected number of false calls is the sum of the individual error probabilities.\n- Objective (a): Express $p$ as a function of $GQ$.\n- Objective (b): Calculate $p$ for $GQ = 20$.\n- Objective (c): Find the smallest integer threshold $GQ^{\\ast}$ such that the expected number of false genotype calls is at most $\\alpha$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The Phred scale and its definition, $Q = -10 \\log_{10}(p)$, are fundamental and standard concepts in bioinformatics and genomics for quantifying the quality of sequence data and variant calls. The problem of setting a quality threshold to control the error rate is a common and practical task in clinical genomics. Thus, the problem is scientifically sound.\n- **Well-Posed**: The problem is clearly stated, providing all necessary data ($N$, $\\alpha$) and definitions to derive the required quantities ($p(GQ)$, $p(20)$, and $GQ^{\\ast}$). The objectives are explicit and lead to a unique solution.\n- **Objective**: The problem is formulated using precise, quantitative language, free from any subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. We proceed to the solution.\n\n### Solution\n\n**(a) Express the error probability $p$ as a function of $GQ$.**\n\nWe are given the definition of the Genotype Quality ($GQ$) score on the Phred scale:\n$$GQ = -10 \\log_{10}(p)$$\nOur goal is to solve this equation for the error probability, $p$.\n\nFirst, we isolate the logarithm term by dividing both sides by $-10$:\n$$-\\frac{GQ}{10} = \\log_{10}(p)$$\nTo solve for $p$, we use the definition of the base-$10$ logarithm, which states that if $y = \\log_{10}(x)$, then $x = 10^y$. Applying this to our equation, we get:\n$$p = 10^{-\\frac{GQ}{10}}$$\nThis expression gives the error probability $p$ as a function of the $GQ$ score.\n\n**(b) Determine the probability of a false genotype call for $GQ=20$.**\n\nUsing the formula derived in part (a), we substitute $GQ = 20$:\n$$p(20) = 10^{-\\frac{20}{10}}$$\n$$p(20) = 10^{-2}$$\n$$p(20) = \\frac{1}{10^2} = \\frac{1}{100} = 0.01$$\nSo, a genotype call with a $GQ$ score of $20$ has a $1\\%$ chance of being incorrect.\n\n**(c) Derive the smallest integer threshold $GQ^{\\ast}$.**\n\nThe hospital reports $N = 200$ genotypes. Let $GQ^{\\ast}$ be the minimum quality threshold. To ensure the quality of all reported genotypes, we must consider the worst-case scenario where all $N$ genotypes have a quality score equal to this minimum threshold, $GQ^{\\ast}$. In this case, the error probability for each of the $N$ calls is $p(GQ^{\\ast})$.\n\nThe expected number of false calls, $E[\\text{false calls}]$, is the sum of the error probabilities of each call. Under our worst-case assumption, this is:\n$$E[\\text{false calls}] = \\sum_{i=1}^{N} p(GQ^{\\ast}) = N \\cdot p(GQ^{\\ast})$$\nThe hospital requires this expected number to not exceed a tolerance $\\alpha = 0.05$. This gives us the following inequality:\n$$N \\cdot p(GQ^{\\ast}) \\le \\alpha$$\nSubstituting the expression for $p(GQ^{\\ast})$ from part (a) and the given values for $N$ and $\\alpha$:\n$$200 \\cdot 10^{-\\frac{GQ^{\\ast}}{10}} \\le 0.05$$\nNow we solve for $GQ^{\\ast}$:\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{0.05}{200}$$\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{5 \\times 10^{-2}}{2 \\times 10^{2}} = 2.5 \\times 10^{-4}$$\nAn alternative way to write the right-hand side is $\\frac{1}{4000}$.\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{1}{4000}$$\nTo solve for $GQ^{\\ast}$, we take the base-$10$ logarithm of both sides. Since $\\log_{10}(x)$ is a monotonically increasing function, the direction of the inequality is preserved.\n$$\\log_{10}\\left(10^{-\\frac{GQ^{\\ast}}{10}}\\right) \\le \\log_{10}\\left(\\frac{1}{4000}\\right)$$\n$$-\\frac{GQ^{\\ast}}{10} \\le -\\log_{10}(4000)$$\nMultiply both sides by $-10$. This action reverses the direction of the inequality:\n$$GQ^{\\ast} \\ge 10 \\log_{10}(4000)$$\nWe can simplify the logarithm term:\n$$\\log_{10}(4000) = \\log_{10}(4 \\times 1000) = \\log_{10}(4) + \\log_{10}(1000) = \\log_{10}(2^2) + 3 = 2 \\log_{10}(2) + 3$$\nThe value of $\\log_{10}(2)$ is approximately $0.30103$.\n$$GQ^{\\ast} \\ge 10 (2 \\cdot (0.30103) + 3)$$\n$$GQ^{\\ast} \\ge 10 (0.60206 + 3)$$\n$$GQ^{\\ast} \\ge 10 (3.60206)$$\n$$GQ^{\\ast} \\ge 36.0206$$\nThe problem asks for the smallest integer threshold $GQ^{\\ast}$ that satisfies this condition. The smallest integer greater than or equal to $36.0206$ is $37$.\nTherefore, the minimum integer $GQ$ threshold must be $37$.\nThe final answers for part (b) and part (c) are $0.01$ and $37$, respectively.", "answer": "$$\\boxed{\\begin{pmatrix} 0.01 & 37 \\end{pmatrix}}$$", "id": "4845063"}, {"introduction": "Genomics enables a shift from reactive to proactive medicine by predicting an individual's risk for common diseases. This is often achieved using a Polygenic Risk Score (PRS), which aggregates the effects of many genetic variants. This exercise [@problem_id:4845077] provides a practical walkthrough of how to adjust a baseline population risk using a patient's specific PRS, demonstrating a core principle of personalized risk stratification within the EHR.", "problem": "A hospital is integrating a Polygenic Risk Score (PRS) into its Electronic Health Record (EHR) to provide individualized $10$-year disease risk estimates. The PRS is standardized to have mean $0$ and standard deviation $1$ in the reference population. The disease has a baseline $10$-year absolute risk of $p_0 = 0.05$ for an individual with $PRS = 0$. A genome-wide association study reports an odds ratio per one standard deviation increase in PRS of $r = 1.6$. Assume that the odds ratio multiplies disease odds multiplicatively across standard deviations of PRS, and that absolute risk is obtained by converting odds to probability using the standard definition of odds. For an individual with $PRS = +2$, compute the individualized $10$-year absolute risk. Express your answer as a decimal fraction and round your answer to four significant figures.", "solution": "The user has provided a problem in medical informatics regarding the calculation of individualized disease risk based on a Polygenic Risk Score (PRS). I will first validate the problem statement and then proceed to a solution if it is deemed valid.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   The Polygenic Risk Score (PRS) is standardized with a mean of $0$ and a standard deviation of $1$.\n-   The baseline $10$-year absolute risk for an individual with PRS $= 0$ is $p_0 = 0.05$.\n-   The odds ratio per one standard deviation increase in PRS is $r = 1.6$.\n-   The odds ratio multiplies disease odds multiplicatively across standard deviations of PRS.\n-   Absolute risk is obtained by converting odds to probability.\n-   The target individual has a PRS of $+2$.\n-   The required output is the individualized $10$-year absolute risk, expressed as a decimal fraction rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is grounded in established principles of epidemiology and statistical genetics. The use of odds ratios, a baseline risk, and a standardized PRS to modulate risk is a standard methodology in the field. The provided values for baseline risk ($5\\%$) and odds ratio ($1.6$) are well within realistic ranges for common complex diseases. The logistic model (multiplicative on the odds scale) is a cornerstone of this type of analysis. The problem is scientifically sound.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary information: a baseline probability, a defined mechanism for risk modification (the odds ratio), and a specific value for the predictor variable (PRS). The goal is clearly stated. A unique solution can be determined.\n-   **Objective**: The problem is stated in precise, quantitative, and objective language, free from ambiguity or subjective claims.\n-   **Completeness and Consistency**: The problem is self-contained and internally consistent. All necessary parameters ($p_0$, $r$, and the individual's PRS) are provided.\n-   **Realism and Feasibility**: The scenario and data are realistic in the context of personalized medicine and the integration of genomic data into clinical practice.\n-   **Structure and Clarity**: The problem is clearly structured and uses standard terminology from biostatistics.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. I will proceed with the solution.\n\n### Solution Derivation\n\nThe solution requires converting the baseline risk to odds, applying the multiplicative effect of the odds ratio based on the individual's PRS, and then converting the resulting odds back to a probability (absolute risk).\n\nThe relationship between probability $p$ and odds $O$ is defined as:\n$$O = \\frac{p}{1-p}$$\nAnd conversely:\n$$p = \\frac{O}{1+O}$$\n\nFirst, we calculate the baseline odds, $O_0$, for an individual with a PRS of $0$. The baseline risk (probability) is given as $p_0 = 0.05$.\n$$O_0 = \\frac{p_0}{1-p_0} = \\frac{0.05}{1-0.05} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}$$\n\nNext, we calculate the odds for the individual in question. The problem states that the odds ratio per one standard deviation increase in PRS is $r = 1.6$. The odds are said to multiply multiplicatively. For an individual with a PRS of $z$ standard deviations from the mean, the individualized odds, $O(z)$, are given by:\n$$O(z) = O_0 \\times r^z$$\n\nThe individual has a PRS of $+2$, so $z = 2$. We can calculate their individualized odds, $O_{ind}$:\n$$O_{ind} = O(2) = O_0 \\times r^2$$\nSubstituting the values for $O_0$ and $r$:\n$$O_{ind} = \\left(\\frac{1}{19}\\right) \\times (1.6)^2 = \\frac{1}{19} \\times 2.56 = \\frac{2.56}{19}$$\n\nFinally, we convert these individualized odds back into an absolute risk (probability), $p_{ind}$:\n$$p_{ind} = \\frac{O_{ind}}{1+O_{ind}}$$\nSubstituting the expression for $O_{ind}$:\n$$p_{ind} = \\frac{\\frac{2.56}{19}}{1 + \\frac{2.56}{19}} = \\frac{\\frac{2.56}{19}}{\\frac{19}{19} + \\frac{2.56}{19}} = \\frac{\\frac{2.56}{19}}{\\frac{19 + 2.56}{19}} = \\frac{2.56}{21.56}$$\n\nNow, we perform the numerical calculation:\n$$p_{ind} = \\frac{2.56}{21.56} \\approx 0.11873840445...$$\n\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $1$, $1$, $8$, and $7$. The fifth significant digit is $3$, which is less than $5$, so we round down (i.e., truncate).\n$$p_{ind} \\approx 0.1187$$\n\nThus, the individualized $10$-year absolute risk for a person with a PRS of $+2$ is approximately $0.1187$.", "answer": "$$\\boxed{0.1187}$$", "id": "4845077"}, {"introduction": "A key goal of integrating genomic data into the EHR is to power real-time Clinical Decision Support (CDS), particularly in pharmacogenomics. By tailoring drug selection and dosage to a patient's genetic profile, we can increase efficacy and reduce adverse reactions. This final practice [@problem_id:4845094] immerses you in a realistic scenario, calculating a patient-specific drug dose using a model that incorporates both clinical (age) and genomic (*VKORC1* and *CYP2C9* variants) information, illustrating the power of personalized medicine at the point of care.", "problem": "An Electronic Health Record (EHR) integrated Clinical Decision Support (CDS) module is designed to compute initial dosing of a narrow-therapeutic-index drug by incorporating genomic features via a generalized linear model (GLM) with a log link. In a GLM with a log link, the predicted positive quantity is modeled by exponentiating a linear combination of covariates. This setup is appropriate for dosing because exponentiation ensures strictly positive doses and allows multiplicative effects of covariates on the mean scale. Consider an implementation that encodes the presence of the Vitamin K epoxide reductase complex subunit 1 (*VKORC1*) risk allele as $1$ if present and $0$ otherwise, and the Cytochrome P450 2C9 (*CYP2C9*) reduced-function genotype as $1$ if present and $0$ otherwise. The CDS computes the dose (in milligrams per day) using the rule $Dose = \\exp(\\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9)$, with coefficients $\\beta_0 = 3.5$, $\\beta_1 = -0.01$, $\\beta_2 = -0.3$, and $\\beta_3 = -0.2$. For a patient of age $65$, with $VKORC1 = 1$ (risk allele present) and $CYP2C9 = 1$ (reduced function), compute the recommended dose. Express your answer in milligrams per day and round to four significant figures.", "solution": "The problem requires the calculation of a drug dose using a given generalized linear model (GLM) with a log link function. This type of model is appropriate for predicting strictly positive quantities, such as a drug dose. The model's structure is an exponential function of a linear combination of covariates.\n\nThe provided model for the dose, $Dose$, in milligrams per day, is:\n$$Dose = \\exp(\\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9)$$\n\nThe problem provides the following values for the model coefficients:\n- Intercept: $\\beta_0 = 3.5$\n- Coefficient for Age: $\\beta_1 = -0.01$\n- Coefficient for $VKORC1$ allele presence: $\\beta_2 = -0.3$\n- Coefficient for $CYP2C9$ reduced function: $\\beta_3 = -0.2$\n\nThe specific patient data are:\n- Age: $65$ years\n- $VKORC1$ status: $1$ (risk allele is present)\n- $CYP2C9$ status: $1$ (reduced-function genotype is present)\n\nFirst, we compute the value of the linear predictor, which is the argument of the exponential function. Let us denote the linear predictor as $\\eta$:\n$$\\eta = \\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9$$\n\nSubstituting the given values into this expression:\n$$\\eta = 3.5 + (-0.01) \\cdot 65 + (-0.3) \\cdot 1 + (-0.2) \\cdot 1$$\n\nNow, we perform the arithmetic operations to find the value of $\\eta$:\n$$\\eta = 3.5 - 0.65 - 0.3 - 0.2$$\n$$\\eta = 3.5 - (0.65 + 0.3 + 0.2)$$\n$$\\eta = 3.5 - 1.15$$\n$$\\eta = 2.35$$\n\nWith the value of the linear predictor calculated, we can now compute the dose by applying the exponential function:\n$$Dose = \\exp(\\eta) = \\exp(2.35)$$\n\nUsing a calculator to evaluate this expression:\n$$Dose \\approx 10.4855905...$$\n\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $1$, $0$, $4$, and $8$. The fifth significant figure is $5$, which requires rounding up the fourth digit.\nTherefore, the rounded dose is $10.49$ milligrams per day.", "answer": "$$\\boxed{10.49}$$", "id": "4845094"}]}