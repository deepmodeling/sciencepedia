{"hands_on_practices": [{"introduction": "Implementing a comprehensive audit trail system is a cornerstone of trustworthy healthcare IT, but it comes with a practical cost: data storage. This exercise places you in the role of a systems architect tasked with quantifying the long-term storage needs for a hospital's Electronic Health Record (EHR) system. By working with realistic data rates and retention policies, you will develop essential skills in capacity planning and also explore how to design a tiered storage strategy based on query patterns, ensuring the system is both compliant and cost-effective [@problem_id:4833570].", "problem": "A tertiary-care hospital maintains comprehensive audit trails for its Electronic Health Record (EHR) system. Each audit event captures data provenance, including who modified which record, when, under which authorization, and the cryptographic integrity evidence. The hospital generates $R$ audit events per day and must retain them for $T$ years to satisfy internal policy aligned with the governance goals of the Health Insurance Portability and Accountability Act (HIPAA). The per-event stored content comprises a payload of $s_{\\text{payload}}$ bytes, provenance metadata of $s_{\\text{metadata}}$ bytes, a digital signature of $s_{\\text{sig}}$ bytes, and a header of $s_{\\text{header}}$ bytes. A secondary index consumes an additional fraction $f_{\\text{index}}$ of the aggregate per-event content.\n\nAssume the following empirically observed parameters for this hospital:\n- Daily event rate: $R = 4.5 \\times 10^{6}$ events/day.\n- Retention horizon: $T = 7$ years.\n- Average per-event components: $s_{\\text{payload}} = 180$ bytes, $s_{\\text{metadata}} = 110$ bytes, $s_{\\text{sig}} = 64$ bytes, $s_{\\text{header}} = 18$ bytes.\n- Index overhead: $f_{\\text{index}} = 0.15$ (dimensionless).\n- Use the civil time approximation $365.25$ days per year.\n\nIn addition, to guide rotation policy between hot and cold storage tiers, suppose audit query ages (time since the target event occurred) follow an exponential distribution with rate $\\lambda$ (in day$^{-1}$), with $\\lambda = 0.08$. The hot tier must be sized to retain the most recent $D_{\\text{hot}}$ days of events so that at least $0.95$ of audit queries are served by the hot tier.\n\nStarting only from fundamental definitions of rates, totals over time, byte-size aggregation, and the properties of the exponential distribution, compute:\n1. The total storage required to retain all audit events for $T$ years, expressed in terabytes (TB), using $1\\,\\text{TB} = 10^{12}$ bytes.\n2. The minimal hot-tier retention horizon $D_{\\text{hot}}$ (in days) such that the probability an audit query targets an event not older than $D_{\\text{hot}}$ is at least $0.95$.\n\nRound both numerical results to four significant figures. Provide your final answer as two values: total storage in TB and $D_{\\text{hot}}$ in days.", "solution": "The problem is first subjected to validation to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\nThe verbatim givens from the problem statement are:\n- Daily event rate: $R = 4.5 \\times 10^{6}$ events/day.\n- Retention horizon: $T = 7$ years.\n- Average per-event payload size: $s_{\\text{payload}} = 180$ bytes.\n- Average per-event metadata size: $s_{\\text{metadata}} = 110$ bytes.\n- Average per-event digital signature size: $s_{\\text{sig}} = 64$ bytes.\n- Average per-event header size: $s_{\\text{header}} = 18$ bytes.\n- Index overhead fraction: $f_{\\text{index}} = 0.15$ (dimensionless).\n- Civil time approximation: $365.25$ days per year.\n- Audit query age distribution: Exponential with rate $\\lambda = 0.08$ day$^{-1}$.\n- Hot tier service level: At least $0.95$ of queries served.\n- Hot tier retention horizon: $D_{\\text{hot}}$ days.\n- Unit conversion: $1\\,\\text{TB} = 10^{12}$ bytes.\n- Required outputs: Total storage in TB and $D_{\\text{hot}}$ in days, both rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientific Grounding**: The problem is grounded in standard principles of data storage calculation and probability theory. The use of an exponential distribution to model the age of queries is a common and reasonable simplification in systems analysis. The context of EHR data provenance and HIPAA is realistic.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary parameters to compute the two requested quantities. For each part, a unique and stable solution exists.\n- **Objectivity**: The language is precise and quantitative. There are no subjective or opinion-based statements.\n- **Consistency and Completeness**: The data are internally consistent and complete. No essential information is missing, and no constraints are contradictory.\n- **Realism**: The numerical values for event rates, data sizes, and retention periods, while large, are plausible for a major tertiary-care hospital.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution is warranted.\n\n### Part 1: Total Storage Requirement\n\nFirst, we determine the storage size for a single raw audit event, denoted $S_{\\text{event}}$, by summing the sizes of its constituent parts.\n$$S_{\\text{event}} = s_{\\text{payload}} + s_{\\text{metadata}} + s_{\\text{sig}} + s_{\\text{header}}$$\nSubstituting the given values:\n$$S_{\\text{event}} = 180\\,\\text{bytes} + 110\\,\\text{bytes} + 64\\,\\text{bytes} + 18\\,\\text{bytes} = 372\\,\\text{bytes}$$\nNext, we account for the secondary index overhead. The total storage per event, $S_{\\text{total\\_per\\_event}}$, is the raw event size plus the index fraction of that size.\n$$S_{\\text{total\\_per\\_event}} = S_{\\text{event}} \\times (1 + f_{\\text{index}})$$\nSubstituting the values:\n$$S_{\\text{total\\_per\\_event}} = 372\\,\\text{bytes} \\times (1 + 0.15) = 372\\,\\text{bytes} \\times 1.15 = 427.8\\,\\text{bytes}$$\nThe total storage generated per day, $S_{\\text{day}}$, is the product of the daily event rate $R$ and the total storage per event.\n$$S_{\\text{day}} = R \\times S_{\\text{total\\_per\\_event}}$$\n$$S_{\\text{day}} = (4.5 \\times 10^{6}\\,\\text{events/day}) \\times (427.8\\,\\text{bytes/event}) = 1.9251 \\times 10^{9}\\,\\text{bytes/day}$$\nThe total retention period in days, $N_{\\text{days}}$, is calculated from the retention horizon in years, $T$.\n$$N_{\\text{days}} = T \\times 365.25\\,\\text{days/year}$$\n$$N_{\\text{days}} = 7\\,\\text{years} \\times 365.25\\,\\text{days/year} = 2556.75\\,\\text{days}$$\nThe total storage required, $S_{\\text{total}}$, is the product of the daily storage generation and the total retention period in days.\n$$S_{\\text{total}} = S_{\\text{day}} \\times N_{\\text{days}}$$\n$$S_{\\text{total}} = (1.9251 \\times 10^{9}\\,\\text{bytes/day}) \\times (2556.75\\,\\text{days}) \\approx 4.921905 \\times 10^{12}\\,\\text{bytes}$$\nFinally, we convert this total storage from bytes to terabytes (TB) using the given conversion factor $1\\,\\text{TB} = 10^{12}\\,\\text{bytes}$.\n$$S_{\\text{total, TB}} = \\frac{S_{\\text{total}}}{10^{12}}$$\n$$S_{\\text{total, TB}} = \\frac{4.921905 \\times 10^{12}\\,\\text{bytes}}{10^{12}\\,\\text{bytes/TB}} \\approx 4.921905\\,\\text{TB}$$\nRounding to four significant figures, the total storage requirement is $4.922\\,\\text{TB}$.\n\n### Part 2: Minimal Hot-Tier Retention Horizon\n\nLet the random variable $X$ represent the age of a queried audit event in days. The problem states that $X$ follows an exponential distribution with rate parameter $\\lambda = 0.08\\,\\text{day}^{-1}$. The probability density function (PDF) is $p(x) = \\lambda \\exp(-\\lambda x)$ for $x \\ge 0$.\n\nThe cumulative distribution function (CDF), $F(d) = P(X \\le d)$, gives the probability that a query targets an event of age less than or equal to $d$ days.\n$$F(d) = \\int_{0}^{d} \\lambda \\exp(-\\lambda x) dx = [-\\exp(-\\lambda x)]_{0}^{d} = -\\exp(-\\lambda d) - (-\\exp(0)) = 1 - \\exp(-\\lambda d)$$\nThe hot tier must serve at least $0.95$ of audit queries. This implies that the probability of a query's target being within the hot tier retention period, $D_{\\text{hot}}$, must be at least $0.95$.\n$$P(X \\le D_{\\text{hot}}) \\ge 0.95$$\nTo find the minimal required retention horizon $D_{\\text{hot}}$, we solve the equality:\n$$1 - \\exp(-\\lambda D_{\\text{hot}}) = 0.95$$\nRearranging the equation to solve for $D_{\\text{hot}}$:\n$$\\exp(-\\lambda D_{\\text{hot}}) = 1 - 0.95 = 0.05$$\nTaking the natural logarithm of both sides:\n$$-\\lambda D_{\\text{hot}} = \\ln(0.05)$$\n$$D_{\\text{hot}} = -\\frac{\\ln(0.05)}{\\lambda}$$\nSubstituting the given value of $\\lambda = 0.08\\,\\text{day}^{-1}$:\n$$D_{\\text{hot}} = -\\frac{\\ln(0.05)}{0.08}\\,\\text{days}$$\nUsing the property $\\ln(a) = -\\ln(1/a)$, we can write $\\ln(0.05) = \\ln(1/20) = -\\ln(20)$.\n$$D_{\\text{hot}} = \\frac{\\ln(20)}{0.08}\\,\\text{days}$$\nNow, we compute the numerical value:\n$$D_{\\text{hot}} \\approx \\frac{2.995732}{0.08}\\,\\text{days} \\approx 37.44665\\,\\text{days}$$\nRounding to four significant figures, the minimal hot-tier retention horizon is $37.45\\,\\text{days}$.", "answer": "$$\\boxed{\\begin{pmatrix} 4.922 & 37.45 \\end{pmatrix}}$$", "id": "4833570"}, {"introduction": "Data provenance is more than just a historical log; it is a map of a process that can be analyzed to improve performance. In this practice, you will dissect the audit trail of a nightly data integration pipeline, a common process in healthcare analytics. Applying the principles of critical path analysis, you will determine the pipeline's total latency and identify the specific sequence of activities that creates the bottleneck, a crucial skill for optimizing complex data workflows [@problem_id:4833565].", "problem": "A hospital consortium maintains an Electronic Health Record (EHR) analytic warehouse fed by a nightly Extract-Transform-Load (ETL) pipeline. The data provenance system records an audit trail for each run as a sequence of activities with durations and explicit precedence constraints captured in a directed acyclic graph of activities. The goal of auditability is to trace how the integrated dataset was produced and to quantify the end-to-end latency of the pipeline for operational planning.\n\nConsider a single run that begins at time $t = 0$ minutes with an ingestion request event. The ETL activities are listed with their durations (in minutes) and their precedence constraints (an activity may start only after all its predecessors have finished). Assume unlimited parallel execution resources and negligible orchestration overhead, so any eligible activity may start immediately when its prerequisites are satisfied.\n\nActivities:\n- $A$: Extract structured EHR data from Hospital $X$, duration $14$; predecessors: none.\n- $B$: Extract unstructured clinical notes from Hospital $Y$, duration $9$; predecessors: none.\n- $C$: Normalize clinical codes to Logical Observation Identifiers Names and Codes (LOINC) and Systematized Nomenclature of Medicine Clinical Terms (SNOMED CT), duration $22$; predecessors: $A$.\n- $D$: Natural language processing of notes to identify diagnoses, duration $27$; predecessors: $B$.\n- $E$: Patient identity resolution against the Master Patient Index, duration $20$; predecessors: $C$, $D$.\n- $F$: Data quality validation checks, duration $12$; predecessors: $C$.\n- $G$: Create reporting snapshots for the research cohort, duration $15$; predecessors: $E$, $F$.\n- $H$: Load integrated data into the analytic warehouse, duration $8$; predecessors: $G$.\n\nUsing only the recorded durations and the precedence constraints from the audit trail, derive the earliest possible completion time of the pipeline and identify the critical path that determines this latency based on first principles of precedence-constrained scheduling. Express the total end-to-end latency in minutes. Provide the final latency as an exact integer; no rounding is required.", "solution": "The problem concerns data provenance and audit trails in an Extract-Transform-Load (ETL) pipeline. The audit trail provides a directed acyclic graph (DAG) of activities with recorded durations and explicit precedence constraints. Under unlimited parallel execution and negligible orchestration overhead, the earliest possible completion time is determined by precedence alone: an activity can start when all its predecessors have finished.\n\nFundamental base:\n- Precedence-constrained scheduling on a directed acyclic graph uses the earliest-start schedule. For each activity $X$, define the earliest start time $ES_X$ and earliest finish time $EF_X$.\n- For activities without predecessors, $ES_X = 0$. For activities with predecessors $\\{P_i\\}$, $ES_X = \\max\\{EF_{P_i}\\}$.\n- The earliest finish time is $EF_X = ES_X + d_X$, where $d_X$ is the duration of activity $X$.\n- The pipeline earliest completion time equals the maximum earliest finish time over all activities; with a single terminal activity $H$, it equals $EF_H$.\n- A critical path is any longest path in the DAG from a start node to the terminal activity; its length equals the pipeline earliest completion time.\n\nLet the durations be $d_A = 14$, $d_B = 9$, $d_C = 22$, $d_D = 27$, $d_E = 20$, $d_F = 12$, $d_G = 15$, $d_H = 8$ (all in minutes).\n\nCompute earliest times step by step:\n\n1. Activities without predecessors start at $t = 0$:\n- $ES_A = 0 \\implies EF_A = ES_A + d_A = 0 + 14 = 14$.\n- $ES_B = 0 \\implies EF_B = ES_B + d_B = 0 + 9 = 9$.\n\n2. Activities with single predecessors:\n- $C$ depends on $A$: $ES_C = EF_A = 14 \\implies EF_C = 14 + 22 = 36$.\n- $D$ depends on $B$: $ES_D = EF_B = 9 \\implies EF_D = 9 + 27 = 36$.\n- $F$ depends on $C$: $ES_F = EF_C = 36 \\implies EF_F = 36 + 12 = 48$.\n\n3. Activities with multiple predecessors:\n- $E$ depends on $C$ and $D$, so $ES_E = \\max\\{EF_C, EF_D\\} = \\max\\{36, 36\\} = 36 \\implies EF_E = 36 + 20 = 56$.\n- $G$ depends on $E$ and $F$, so $ES_G = \\max\\{EF_E, EF_F\\} = \\max\\{56, 48\\} = 56 \\implies EF_G = 56 + 15 = 71$.\n\n4. Terminal activity:\n- $H$ depends on $G$: $ES_H = EF_G = 71 \\implies EF_H = 71 + 8 = 79$.\n\nTherefore, the earliest possible completion time of the pipeline is $79$ minutes.\n\nIdentify the critical path by tracing any path that achieves the maximum time:\n- Path $A \\to C \\to E \\to G \\to H$ has total duration $d_A + d_C + d_E + d_G + d_H = 14 + 22 + 20 + 15 + 8 = 79$.\n- Path $B \\to D \\to E \\to G \\to H$ has total duration $d_B + d_D + d_E + d_G + d_H = 9 + 27 + 20 + 15 + 8 = 79$.\n\nBoth paths achieve the longest duration, so either is a critical path; the pipeline end-to-end latency equals the length of the critical path, which is $79$ minutes.\n\nHence, the total end-to-end latency, expressed in minutes, is $79$.", "answer": "$$\\boxed{79}$$", "id": "4833565"}, {"introduction": "The true power of a sophisticated provenance system is revealed when it helps ensure patient safety in complex, real-world scenarios. This problem presents a critical situation where two clinicians issue conflicting concurrent updates to a patient's medication order. Your task is to evaluate different conflict-resolution strategies, moving beyond simple technical rules to incorporate causality, actor credentials, and vital clinical context to determine the safest outcome. This exercise demonstrates why a rich and reliable audit trail is indispensable for building intelligent and safe clinical decision support systems [@problem_id:4833552].", "problem": "An Electronic Health Record (EHR) medication order for warfarin is stored as a state $s_0$ with dose $5\\,\\mathrm{mg}$ daily. The audit trail is append-only and each event is recorded with a digital signature, a role, a human-readable rationale, a parent pointer to the prior state, and a vector clock. Two clinicians issue concurrent updates after a new laboratory result:\n\n- A laboratory event $e_L$ posts an International Normalized Ratio (INR) measurement of $3.8$ with vector clock $v_L = \\langle 1, 1, 1 \\rangle$. This event is signed by the laboratory system and references $s_0$.\n- A pharmacist issues $e_P$, reducing the dose to $4\\,\\mathrm{mg}$, signed and credentialed, with vector clock $v_P = \\langle 2, 1, 1 \\rangle$. The rationale cites the elevated INR, and $e_P$ references $s_0$ and $e_L$ in its provenance.\n- A physician issues $e_D$, increasing the dose to $6\\,\\mathrm{mg}$, signed and credentialed, with vector clock $v_D = \\langle 1, 2, 1 \\rangle$. The rationale cites subtherapeutic INR in prior visits, and $e_D$ references $s_0$ and $e_L$.\n\nAssume the following foundational base:\n\n- Data provenance is represented as a Directed Acyclic Graph (DAG) $G$ with nodes for states and edges for derivations; audit trails must be immutable, complete, and support non-repudiation through digital signatures. The Health Insurance Portability and Accountability Act (HIPAA) requires that audit logs be immutable and attributable.\n- Causality uses the standard vector clock partial order: for vector timestamps $x$ and $y$, $x \\prec y$ if and only if for all components $i$ one has $x_i \\le y_i$ and there exists at least one component $j$ for which $x_j < y_j$. Events $x$ and $y$ are concurrent, denoted $x \\parallel y$, if neither $x \\prec y$ nor $y \\prec x$.\n- Clinical safety requires that any automated conflict resolution must not select an update that introduces a high risk of harm given available clinical context (e.g., elevated INR suggests dose reduction for warfarin rather than increase), and automated selection must be attributable and reversible by compensating transactions recorded in the provenance.\n\nGiven that $v_L \\prec v_P$, $v_L \\prec v_D$, and $v_P \\parallel v_D$, and that both $e_P$ and $e_D$ have valid digital signatures and credentials, select the conflict-resolution rule set and provenance criteria that most correctly determine an authoritative state $s^\\*$ under these conditions, while maintaining scientific realism and compliance with the stated foundational base.\n\nA. Last-write-wins by wall-clock time: choose the update with the largest wall-clock timestamp $t$ as $s^\\*$, discard the other update from the audit trail to avoid confusion, and do not record any resolution metadata.\n\nB. Signature-first lexicographic tie-break: among signed updates, select the update with the lexicographically smallest event identifier as $s^\\*$, ignoring causality and clinical context, and append only the chosen update to the provenance without parent references to the discarded update.\n\nC. Causality-guided, safety-constrained resolution with explicit provenance: if one update causally follows the other, choose the causally later one as $s^\\*$. If the updates are concurrent ($v_P \\parallel v_D$), evaluate each against decision support constraints derived from current context (e.g., elevated INR of $3.8$ contraindicates a warfarin dose increase); among updates that pass safety checks, require verified digital signatures and valid role credentials; prefer higher clinical authority if both are safe, but if only one is safe, choose the safe one even if from a lower-ranked role. Emit a new resolution event $e_R$ whose state $s^\\*$ references both $e_P$ and $e_D$ as parents, records the rationale, the policy applied, and a cryptographic attestation, preserving the DAG.\n\nD. Field-merge heuristic: compute an average dose $(4 + 6)/2 = 5\\,\\mathrm{mg}$ as $s^\\*$ to compromise between concurrent updates, do not evaluate clinical context, and record $s^\\*$ without linking to parent events to minimize provenance complexity.\n\nE. Role-maximization without constraints: always choose the update from the user with the highest role weight (physician over pharmacist) as $s^\\*$, disregard causality and decision support, and record the choice with a single parent pointer to $s_0$ to avoid introducing multiple edges in the DAG.", "solution": "The problem statement is a valid exercise in the domain of medical informatics and distributed systems. It presents a realistic clinical scenario involving concurrent updates to a patient's Electronic Health Record (EHR) and asks for the evaluation of conflict resolution strategies against a set of well-defined principles.\n\n### Step 1: Extract Givens\n\n-   Initial State: $s_0$, warfarin dose $5\\,\\mathrm{mg}$ daily.\n-   Audit Trail Properties: Append-only, digital signature, role, rationale, parent pointer, vector clock.\n-   Laboratory Event $e_L$: International Normalized Ratio (INR) is $3.8$. Vector clock is $v_L = \\langle 1, 1, 1 \\rangle$. Signed by the laboratory system. References $s_0$.\n-   Pharmacist Event $e_P$: Dose reduced to $4\\,\\mathrm{mg}$. Vector clock is $v_P = \\langle 2, 1, 1 \\rangle$. Signed and credentialed. Rationale cites elevated INR. References $s_0$ and $e_L$.\n-   Physician Event $e_D$: Dose increased to $6\\,\\mathrm{mg}$. Vector clock is $v_D = \\langle 1, 2, 1 \\rangle$. Signed and credentialed. Rationale cites subtherapeutic INR in prior visits. References $s_0$ and $e_L$.\n-   Foundational Base (Provenance): Provenance is a Directed Acyclic Graph (DAG) $G$. Audit trails must be immutable, complete, and support non-repudiation. Health Insurance Portability and Accountability Act (HIPAA) requires immutable and attributable logs.\n-   Foundational Base (Causality): Vector clock partial order is defined as $x \\prec y$ if and only if for all components $i$, $x_i \\le y_i$, and there exists at least one component $j$ for which $x_j < y_j$. Concurrency is defined as $x \\parallel y$ if neither $x \\prec y$ nor $y \\prec x$.\n-   Foundational Base (Clinical Safety): Automated conflict resolution must not select high-risk updates. Elevated INR (like $3.8$) for a patient on warfarin suggests a dose reduction, not an increase. Automated selections must be attributable and reversible.\n-   Explicit Relationships: $v_L \\prec v_P$, $v_L \\prec v_D$, and $v_P \\parallel v_D$. Both $e_P$ and $e_D$ have valid digital signatures and credentials.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded:** The problem is sound. It uses standard concepts from computer science (vector clocks, DAGs, digital signatures) and applies them to a standard, realistic problem in clinical medicine (warfarin management, INR monitoring, concurrent EHR updates). The definition of vector clock causality is correct. The clinical context is accurate: an INR of $3.8$ is elevated, and increasing the warfarin dose would be contraindicated and dangerous. The relationship between the events, $v_L \\prec v_P$, $v_L \\prec v_D$, and $v_P \\parallel v_D$, is consistent with the narrative: the lab result $e_L$ is seen by both clinicians, who then make concurrent updates.\n-   **Well-Posed:** The problem provides a clear set of initial conditions, events, and constraints (the foundational base). The task is to evaluate given resolution strategies against these constraints to find the one that is most compliant. A meaningful evaluation is possible.\n-   **Objective:** The problem is stated in precise, technical terms without subjective or ambiguous language. The constraints for evaluation are explicitly defined.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. The premises are internally consistent, scientifically sound, and well-posed. The solution process can proceed.\n\n### Principle-Based Derivation and Option Analysis\n\nThe optimal conflict-resolution strategy must satisfy three primary sets of constraints laid out in the foundational base:\n1.  **Provenance Integrity:** The strategy must respect the immutability and completeness of the audit trail. This means no events can be discarded. The resolution of the conflict is itself a significant event that must be recorded, including its rationale and its relationship to the conflicting events, preserving the DAG structure. HIPAA requirements for attributable logs reinforce this.\n2.  **Causal Consistency:** The strategy must correctly interpret the event ordering provided by the vector clocks. The concurrency of $e_P$ and $e_D$ ($v_P \\parallel v_D$) is a known fact and cannot be ignored or arbitrarily resolved by a non-causal mechanism like wall-clock time.\n3.  **Clinical Safety:** This is the most critical constraint in a medical context. Any automated decision must prioritize patient safety. Given the context of a high INR of $3.8$, the physician's update $e_D$ (increasing dose to $6\\,\\mathrm{mg}$) is clinically dangerous. The pharmacist's update $e_P$ (decreasing dose to $4\\,\\mathrm{mg}$) is clinically appropriate. A valid resolution rule must be capable of distinguishing these and rejecting the unsafe update.\n\nWe will now evaluate each option against these three core requirements.\n\n**A. Last-write-wins by wall-clock time: choose the update with the largest wall-clock timestamp $t$ as $s^\\*$, discard the other update from the audit trail to avoid confusion, and do not record any resolution metadata.**\n-   This strategy violates all three principles.\n-   **Provenance:** It violates immutability and completeness by proposing to \"discard the other update from the audit trail\". It violates attributability by failing to \"record any resolution metadata\".\n-   **Causality:** It uses wall-clock time, a poor substitute for true causality, to break a known concurrency ($v_P \\parallel v_D$).\n-   **Safety:** It completely ignores clinical context and could easily select the dangerous update $e_D$ if it happened to have a later timestamp.\n-   **Verdict: Incorrect.**\n\n**B. Signature-first lexicographic tie-break: among signed updates, select the update with the lexicographically smallest event identifier as $s^\\*$, ignoring causality and clinical context, and append only the chosen update to the provenance without parent references to the discarded update.**\n-   This strategy also fails on all key principles.\n-   **Provenance:** It creates an incomplete and misleading provenance record by \"without parent references to the discarded update\", thus hiding that a conflict even occurred.\n-   **Causality and Safety:** It explicitly states it is \"ignoring causality and clinical context\". This is a direct violation of the foundational base. The resolution is arbitrary and could select the unsafe option $e_D$.\n-   **Verdict: Incorrect.**\n\n**C. Causality-guided, safety-constrained resolution with explicit provenance: if one update causally follows the other, choose the causally later one as $s^\\*$. If the updates are concurrent ($v_P \\parallel v_D$), evaluate each against decision support constraints derived from current context (e.g., elevated INR of $3.8$ contraindicates a warfarin dose increase); among updates that pass safety checks, require verified digital signatures and valid role credentials; prefer higher clinical authority if both are safe, but if only one is safe, choose the safe one even if from a lower-ranked role. Emit a new resolution event $e_R$ whose state $s^\\*$ references both $e_P$ and $e_D$ as parents, records the rationale, the policy applied, and a cryptographic attestation, preserving the DAG.**\n-   This strategy correctly addresses all principles.\n-   **Provenance:** It ensures a complete and truthful audit trail by emitting a new resolution event $e_R$ that references both conflicting parents ($e_P$ and $e_D$), recording the rationale and policy. This preserves the DAG and ensures attributability.\n-   **Causality:** It correctly handles both causally ordered events and concurrent events, applying the appropriate logic for each case. It correctly identifies $v_P \\parallel v_D$ and proceeds to a suitable tie-breaking mechanism.\n-   **Safety:** It makes clinical safety the primary factor in resolving the concurrent conflict. It would evaluate the context ($INR = 3.8$) and correctly identify $e_D$ as unsafe and $e_P$ as safe. It then follows the logical policy of choosing the safe update, thereby selecting the $4\\,\\mathrm{mg}$ dose. The rule \"choose the safe one even if from a lower-ranked role\" is a critical safety feature.\n-   **Verdict: Correct.**\n\n**D. Field-merge heuristic: compute an average dose $(4 + 6)/2 = 5\\,\\mathrm{mg}$ as $s^\\*$ to compromise between concurrent updates, do not evaluate clinical context, and record $s^\\*$ without linking to parent events to minimize provenance complexity.**\n-   This strategy is deeply flawed.\n-   **Provenance:** It creates a disconnected, orphaned state by not linking to parent events, violating the DAG model and completeness.\n-   **Safety:** The core heuristic of averaging medication doses is clinically nonsensical and potentially extremely dangerous. It also explicitly states \"do not evaluate clinical context\", a direct violation of the safety principle. The resulting dose of $5\\,\\mathrm{mg}$ ignores the critical, safety-driven dose reduction proposed by the pharmacist.\n-   **Verdict: Incorrect.**\n\n**E. Role-maximization without constraints: always choose the update from the user with the highest role weight (physician over pharmacist) as $s^\\*$, disregard causality and decision support, and record the choice with a single parent pointer to $s_0$ to avoid introducing multiple edges in the DAG.**\n-   This strategy prioritizes hierarchy over safety, which is unacceptable.\n-   **Provenance:** It falsifies the provenance by recording an incorrect parent pointer (to $s_0$ only) and ignoring the conflict, thereby breaking the integrity of the DAG. The goal should be to accurately represent history, not to \"avoid introducing multiple edges.\"\n-   **Causality and Safety:** It explicitly states to \"disregard causality and decision support\". This would lead it to select the physician's unsafe update $e_D$, directly contravening the clinical safety mandate.\n-   **Verdict: Incorrect.**", "answer": "$$\\boxed{C}$$", "id": "4833552"}]}