{"hands_on_practices": [{"introduction": "The foundation of preventing cardiovascular disease lies in understanding its risk factors. Epidemiological studies that link factors like high blood pressure to heart attacks are essential, but the measurements they rely on are imperfect. This practice explores the concept of regression dilution bias, where random error in measuring a risk factor, such as systolic blood pressure, can lead to a significant underestimation of its true impact on disease. By working through the correction of a reported hazard ratio, you will develop a crucial skill in critically evaluating epidemiological evidence and appreciating the true magnitude of cardiovascular risk factors [@problem_id:4969559].", "problem": "A population-based cohort study in a Low- and Middle-Income Country (LMIC) setting enrolled $10{,}000$ adults and followed them for incident cardiovascular disease (CVD). The exposure of interest was systolic blood pressure (SBP), measured once at baseline. The primary analysis used a proportional hazards model with a log-linear specification for SBP and reported that the estimated log hazard ratio increased by $0.12$ per $10$ mmHg increment in SBP measured at baseline.\n\nTo assess and correct for regression dilution arising from within-person variability and random measurement error in SBP, a validation substudy was conducted in a simple random sample of $300$ cohort participants. Each participant in the substudy had $m=2$ replicate SBP measurements taken $1$ year apart under comparable conditions. A one-way random effects analysis of variance on the replicate SBP measurements yielded a mean square within-person of $MS_{W}=100$ (in mmHg$^{2}$) and a mean square between-person of $MS_{B}=400$ (in mmHg$^{2}$).\n\nAssume the following foundational conditions:\n- The true SBP for participant $i$, denoted $T_{i}$, is stable over the short term of replicates and varies across participants with variance $\\sigma_{b}^{2}$.\n- Each observed replicate $X_{ij}$ satisfies the classical additive measurement error model $X_{ij}=T_{i}+U_{ij}$ with $U_{ij}$ independent of $T_{i}$ and the outcome, and with variance $\\sigma_{w}^{2}$ identical across replicates.\n- The log hazard is a linear function of the true SBP in units of $10$ mmHg, and the proportional hazards analysis using baseline SBP is interpreted in terms of the corresponding regression of a linear predictor on a mismeasured exposure.\n\nUsing only fundamental definitions of variance decomposition, properties of covariance under additive independent noise, and the definition of a regression slope as a covariance-to-variance ratio, derive a correction for the baseline-analysis log hazard slope that accounts for regression dilution due to within-person variation and random error. Then compute the corrected hazard ratio for a $10$ mmHg higher true SBP.\n\nRound your final answer to four significant figures. Express the hazard ratio as a pure number (dimensionless).", "solution": "The problem requires us to correct an estimated log hazard ratio from a proportional hazards model for the effects of regression dilution due to measurement error in the exposure, systolic blood pressure (SBP). We will first derive the general correction formula based on the principles of linear regression and variance decomposition, and then use the data from the validation substudy to compute the corrected hazard ratio.\n\nLet $T$ be the true long-term average SBP for a participant, and let $X$ be the single baseline measurement of SBP. The problem states that the observed measurement $X$ is related to the true value $T$ by the classical additive measurement error model:\n$$X = T + U$$\nwhere $U$ is a random error term. Key assumptions are that $U$ is independent of $T$, $\\mathbb{E}[U] = 0$, and the variance of $U$ is $\\text{Var}(U) = \\sigma_w^2$. The variance of the true SBP across the population is $\\text{Var}(T) = \\sigma_b^2$.\n\nThe true underlying model assumes that the log hazard of cardiovascular disease (CVD), denoted by $L$, is a linear function of the true SBP, $T$:\n$$L = \\alpha + \\beta_{\\text{true}} T$$\nHowever, the analysis was conducted using the observed, mismeasured SBP, $X$. The proportional hazards model effectively performs a regression of the log hazard on $X$. The estimated log hazard ratio, $\\hat{\\beta}_{\\text{obs}}$, is an estimate of the slope in the regression of $L$ on $X$:\n$$L \\approx \\alpha' + \\beta_{\\text{obs}} X$$\nThe slope of a simple linear regression of a dependent variable $Y$ (here, $L$) on a predictor $Z$ is given by the ratio of their covariance to the variance of the predictor, $\\text{Cov}(Y, Z) / \\text{Var}(Z)$.\n\nThe true slope is:\n$$\\beta_{\\text{true}} = \\frac{\\text{Cov}(L, T)}{\\text{Var}(T)}$$\nThe observed slope is:\n$$\\beta_{\\text{obs}} = \\frac{\\text{Cov}(L, X)}{\\text{Var}(X)}$$\nWe can relate these two expressions. First, let's analyze the covariance term, $\\text{Cov}(L, X)$.\nSince $X = T+U$ and the error $U$ is independent of the true value $T$ and the outcome (implying it's independent of the log hazard $L$), we have:\n$$\\text{Cov}(L, X) = \\text{Cov}(L, T+U) = \\text{Cov}(L, T) + \\text{Cov}(L, U)$$\nBecause $L$ is a function of $T$, and $U$ is independent of $T$ and the factors determining the outcome, $\\text{Cov}(L, U) = 0$. Therefore:\n$$\\text{Cov}(L, X) = \\text{Cov}(L, T)$$\nNext, let's analyze the variance term, $\\text{Var}(X)$. Since $T$ and $U$ are independent:\n$$\\text{Var}(X) = \\text{Var}(T+U) = \\text{Var}(T) + \\text{Var}(U) = \\sigma_b^2 + \\sigma_w^2$$\nSubstituting these back into the expression for $\\beta_{\\text{obs}}$:\n$$\\beta_{\\text{obs}} = \\frac{\\text{Cov}(L, T)}{\\text{Var}(T) + \\text{Var}(U)} = \\frac{\\text{Cov}(L, T)}{\\sigma_b^2 + \\sigma_w^2}$$\nWe can rewrite this in terms of $\\beta_{\\text{true}}$:\n$$\\beta_{\\text{obs}} = \\left(\\frac{\\text{Cov}(L, T)}{\\text{Var}(T)}\\right) \\left(\\frac{\\text{Var}(T)}{\\text{Var}(T) + \\text{Var}(U)}\\right) = \\beta_{\\text{true}} \\left(\\frac{\\sigma_b^2}{\\sigma_b^2 + \\sigma_w^2}\\right)$$\nThe term $\\lambda = \\frac{\\sigma_b^2}{\\sigma_b^2 + \\sigma_w^2}$ is the regression dilution factor, also known as the reliability coefficient or intraclass correlation coefficient. It represents the proportion of the total variance in the observed measurements that is due to true between-person differences. Since $\\sigma_w^2 > 0$, we have $\\lambda  1$, which means $|\\beta_{\\text{obs}}|  |\\beta_{\\text{true}}|$. This attenuation of the regression slope towards zero is known as regression dilution.\n\nThe correction formula to find the true slope from the observed slope is:\n$$\\beta_{\\text{true}} = \\frac{\\beta_{\\text{obs}}}{\\lambda} = \\beta_{\\text{obs}} \\left(\\frac{\\sigma_b^2 + \\sigma_w^2}{\\sigma_b^2}\\right)$$\nTo apply this correction, we need to estimate the variance components $\\sigma_b^2$ (between-person variance, i.e., $\\text{Var}(T)$) and $\\sigma_w^2$ (within-person variance, i.e., $\\text{Var}(U)$). The problem provides results from a one-way random effects analysis of variance (ANOVA) on $m=2$ replicate measurements for $300$ participants. The expected values of the mean squares are:\n$$E(MS_W) = \\sigma_w^2$$\n$$E(MS_B) = \\sigma_w^2 + m \\sigma_b^2$$\nwhere $MS_W$ is the mean square within-person and $MS_B$ is the mean square between-person. We use the observed mean squares as estimates for their expected values.\nGiven data:\n$MS_{W} = 100$ mmHg$^2$\n$MS_{B} = 400$ mmHg$^2$\n$m = 2$\n\nFrom these, we can estimate the variance components:\nAn estimate for the within-person variance is $\\hat{\\sigma}_w^2 = MS_W = 100$.\nUsing the formula for $MS_B$, we can solve for an estimate of the between-person variance, $\\hat{\\sigma}_b^2$:\n$$MS_B = \\hat{\\sigma}_w^2 + m \\hat{\\sigma}_b^2$$\n$$400 = 100 + 2 \\hat{\\sigma}_b^2$$\n$$2 \\hat{\\sigma}_b^2 = 400 - 100 = 300$$\n$$\\hat{\\sigma}_b^2 = \\frac{300}{2} = 150$$\nSo, we have $\\hat{\\sigma}_b^2 = 150$ mmHg$^2$ and $\\hat{\\sigma}_w^2 = 100$ mmHg$^2$.\n\nNow we can estimate the reliability coefficient $\\lambda$:\n$$\\hat{\\lambda} = \\frac{\\hat{\\sigma}_b^2}{\\hat{\\sigma}_b^2 + \\hat{\\sigma}_w^2} = \\frac{150}{150 + 100} = \\frac{150}{250} = \\frac{3}{5} = 0.6$$\nThe problem states that the observed log hazard ratio increases by $0.12$ per $10$ mmHg increment in SBP. This is our observed slope, $\\hat{\\beta}_{\\text{obs}, 10} = 0.12$.\n\nWe apply the correction to find the true log hazard ratio for a $10$ mmHg increment:\n$$\\hat{\\beta}_{\\text{true}, 10} = \\frac{\\hat{\\beta}_{\\text{obs}, 10}}{\\hat{\\lambda}} = \\frac{0.12}{0.6} = 0.2$$\nThe corrected log hazard ratio for a $10$ mmHg increase in true SBP is $0.2$.\n\nThe final step is to compute the corrected hazard ratio (HR) for this increment:\n$$HR_{\\text{true}, 10} = \\exp(\\hat{\\beta}_{\\text{true}, 10}) = \\exp(0.2)$$\nCalculating the numerical value:\n$$\\exp(0.2) \\approx 1.221402758...$$\nRounding to four significant figures, we get $1.221$.\nThis is the corrected hazard ratio for a $10$ mmHg higher true SBP.", "answer": "$$\\boxed{1.221}$$", "id": "4969559"}, {"introduction": "While understanding single risk factors is important, clinical practice requires a holistic view of a patient's risk. This is often achieved using multivariable risk scores, which combine factors like age, smoking status, and diabetes into a single probability of a future cardiovascular event. However, since many of these scores were developed in high-income countries, their direct application in LMICs can be misleading. This exercise guides you through the essential process of model \"recalibration,\" where you will adjust a risk score's baseline to match the different underlying disease risk in a new population, ensuring the tool provides accurate predictions in a local context [@problem_id:4969535].", "problem": "A cardiovascular disease risk score developed in a High-Income Country (HIC) is specified using a logistic model for the probability of a $10$-year event. The model uses predictors coded relative to fixed clinical reference levels so that the intercept equals the log-odds of the event probability for the reference individual. Specifically, the model takes the form $$\\text{logit}(p) = \\alpha + \\beta_{\\text{smoke}} x_{\\text{smoke}} + \\beta_{\\text{diab}} x_{\\text{diab}} + \\beta_{\\text{age}} ( \\text{age} - 50 ),$$ where $x_{\\text{smoke}}$ and $x_{\\text{diab}}$ are indicator variables for current smoking and diabetes, respectively, and age is in years. By construction, when $x_{\\text{smoke}} = 0$, $x_{\\text{diab}} = 0$, and $\\text{age} = 50$, the event probability is the baseline probability, and the intercept equals the log-odds of that baseline.\n\nAssume the following empirically grounded facts and definitions:\n- The logit link is defined as $\\text{logit}(p) = \\ln\\!\\left(\\frac{p}{1-p}\\right)$ and the logistic function is $\\expit(\\eta) = \\frac{1}{1+\\exp(-\\eta)}$.\n- In the HIC development setting, the baseline $10$-year event probability for the reference individual is $p_{\\text{HIC}} = 0.06$.\n- In a Low- and Middle-Income Country (LMIC), the same relative effects (log-odds ratios) are transportable, but the baseline $10$-year event probability for the reference individual differs and is $p_{\\text{LMIC}} = 0.10$.\n- The estimated slope coefficients are $\\beta_{\\text{smoke}} = 0.7$, $\\beta_{\\text{diab}} = 0.9$, and $\\beta_{\\text{age}} = 0.02$ per year.\n\nUsing only the fundamental definitions of odds, log-odds, and the logistic link, derive the transport-calibrated intercept appropriate for the LMIC baseline and then compute the transport-calibrated $10$-year predicted probability for an individual who is a current smoker ($x_{\\text{smoke}} = 1$), not diabetic ($x_{\\text{diab}} = 0$), and aged $55$ years ($\\text{age} = 55$). Round your final probability to $4$ significant figures and express it as a decimal fraction without a percentage sign.", "solution": "The problem requires the calculation of a predicted probability from a logistic regression model after recalibrating its intercept for a new population. This involves three steps: determining the new intercept based on the baseline risk in the target population, calculating the linear predictor (log-odds) for the specified individual, and converting this log-odds back into a probability.\n\nThe intercept of the model, $\\alpha$, corresponds to the log-odds of the event for a reference individual ($x_{\\text{smoke}} = 0$, $x_{\\text{diab}} = 0$, $\\text{age} = 50$). To recalibrate the model for the LMIC setting, we must calculate a new intercept, $\\alpha_{\\text{LMIC}}$, that matches the given baseline risk in the LMIC, $p_{\\text{LMIC}} = 0.10$.\n\nFirst, we find the new intercept using the logit function:\n$$ \\alpha_{\\text{LMIC}} = \\text{logit}(p_{\\text{LMIC}}) = \\ln\\left(\\frac{p_{\\text{LMIC}}}{1-p_{\\text{LMIC}}}\\right) $$\n$$ \\alpha_{\\text{LMIC}} = \\ln\\left(\\frac{0.10}{1 - 0.10}\\right) = \\ln\\left(\\frac{0.10}{0.90}\\right) = \\ln\\left(\\frac{1}{9}\\right) = -\\ln(9) $$\n\nNext, we calculate the linear predictor, $\\eta_{\\text{target}}$, for the target individual (smoker, not diabetic, age 55) using the recalibrated intercept and the transportable slope coefficients ($\\beta_{\\text{smoke}} = 0.7$, $\\beta_{\\text{age}} = 0.02$):\n$$ \\eta_{\\text{target}} = \\alpha_{\\text{LMIC}} + \\beta_{\\text{smoke}} x_{\\text{smoke}} + \\beta_{\\text{diab}} x_{\\text{diab}} + \\beta_{\\text{age}} ( \\text{age} - 50 ) $$\n$$ \\eta_{\\text{target}} = -\\ln(9) + (0.7)(1) + (0.9)(0) + (0.02)(55 - 50) $$\n$$ \\eta_{\\text{target}} = -\\ln(9) + 0.7 + 0.02(5) = -\\ln(9) + 0.8 $$\n\nFinally, we convert the linear predictor (log-odds) back to a probability, $p_{\\text{target}}$, using the logistic function, $p = \\text{expit}(\\eta) = \\frac{1}{1+\\exp(-\\eta)}$:\n$$ p_{\\text{target}} = \\frac{1}{1 + \\exp(-\\eta_{\\text{target}})} = \\frac{1}{1 + \\exp(-(-\\ln(9) + 0.8))} = \\frac{1}{1 + \\exp(\\ln(9) - 0.8)} $$\n$$ p_{\\text{target}} = \\frac{1}{1 + \\exp(\\ln(9)) \\cdot \\exp(-0.8)} = \\frac{1}{1 + 9e^{-0.8}} $$\nCalculating the value:\n$$ p_{\\text{target}} \\approx \\frac{1}{1 + 9(0.449329)} = \\frac{1}{1 + 4.043961} = \\frac{1}{5.043961} \\approx 0.1982568 $$\nRounding to $4$ significant figures, we get $0.1983$.", "answer": "$$\n\\boxed{0.1983}\n$$", "id": "4969535"}, {"introduction": "After accurately predicting an individual's risk, the final step is to act on that information. In any health system, but especially in resource-constrained LMICs, it is not feasible or optimal to provide preventive therapy to everyone. This practice places you in the role of a health policymaker to determine a rational, evidence-based threshold for initiating treatment. By balancing the expected benefits of therapy, measured in Disability-Adjusted Life Years (DALYs) averted, against the costs and potential harms, you will derive the specific risk level above which treatment becomes a net benefit, a core principle in developing cost-effective public health strategies [@problem_id:4969510].", "problem": "A Ministry of Health in a low-income country plans to set a single initiation threshold for primary prevention therapy against major Cardiovascular Disease (CVD) events using World Health Organization (WHO) absolute risk charts. Adults whose estimated $10$-year CVD risk $p$ exceeds a threshold $p^{\\ast}$ will be offered a once-daily fixed-dose combination antihypertensive for $10$ years. Assume one major CVD event per person at most over $10$ years, no discounting, and independence of harms and benefits, so that linearity of expectations applies.\n\nUnder program conditions, for an individual with baseline $10$-year risk $p$:\n- The therapy yields a constant relative risk reduction $r$ in the probability of a first major CVD event over $10$ years.\n- Each first major CVD event leads to an average loss of $L$ Disability-Adjusted Life Years (DALYs), where Disability-Adjusted Life Year (DALY) is defined in the standard way as one lost year of healthy life.\n- Adverse effects attributable to the therapy occur with probability $q$ over $10$ years and cause an average loss of $h$ DALYs if they occur.\n- The daily pill imposes a small ongoing disutility of $d$ DALYs per person-year while taken.\n- Delivering the therapy uses health system resources with an opportunity cost equivalent to $c$ DALYs per treated person over $10$ years.\n\nStarting only from the definition of expected value and the definition of relative risk reduction, derive the condition on $p$ under which the expected net DALYs averted per person treated are positive. Then, find the risk threshold $p^{\\ast}$ that makes the expected net DALYs averted exactly zero.\n\nUsing the parameter values $r=0.25$, $L=8$, $q=0.02$, $h=0.3$, $d=0.003$, and $c=0.08$, compute $p^{\\ast}$. Round your final result to three significant figures. Express the threshold as a decimal fraction of $10$-year risk (do not use a percent sign).", "solution": "The objective is to find the risk threshold $p^{\\ast}$ where the expected net Disability-Adjusted Life Years (DALYs) averted by treatment are exactly zero. This is the point where the expected benefits of treatment equal its expected harms and costs. We can derive this by comparing the expected DALY loss for an individual with and without treatment.\n\nLet $p$ be the individual's baseline $10$-year risk of a major CVD event.\n\n1.  **Expected DALY loss without treatment:**\n    The only source of DALY loss is the CVD event itself.\n    $$E[\\text{Loss}_{\\text{no treat}}] = p \\cdot L$$\n\n2.  **Expected DALY loss with treatment:**\n    With treatment, the risk of a CVD event is reduced by a relative risk reduction $r$, so the new risk is $p' = p(1-r)$. The total expected loss includes the loss from these residual events, plus harms from adverse effects, the disutility of taking a daily pill for 10 years, and the opportunity cost of the resources used.\n    $$E[\\text{Loss}_{\\text{treat}}] = \\underbrace{p(1-r)L}_{\\text{residual events}} + \\underbrace{qh}_{\\text{adverse effects}} + \\underbrace{10d}_{\\text{disutility}} + \\underbrace{c}_{\\text{opportunity cost}}$$\n\n3.  **Net DALYs Averted:**\n    The expected net DALYs averted is the difference between these two expected losses.\n    $$E[\\text{Net DALYs Averted}] = E[\\text{Loss}_{\\text{no treat}}] - E[\\text{Loss}_{\\text{treat}}]$$\n    $$E[\\text{Net DALYs Averted}] = pL - [p(1-r)L + qh + 10d + c]$$\n    $$E[\\text{Net DALYs Averted}] = pL - pL + prL - (qh + 10d + c)$$\n    $$E[\\text{Net DALYs Averted}] = \\underbrace{prL}_{\\text{Benefit}} - \\underbrace{(qh + 10d + c)}_{\\text{Harm/Cost}}$$\n\n4.  **Derivation and Calculation of the Risk Threshold $p^{\\ast}$:**\n    The threshold $p^{\\ast}$ is the risk level where the net DALYs averted are zero.\n    $$p^{\\ast}rL - (qh + 10d + c) = 0$$\n    Solving for $p^{\\ast}$:\n    $$p^{\\ast} = \\frac{qh + 10d + c}{rL}$$\n    Now, we substitute the given parameter values: $r=0.25$, $L=8$, $q=0.02$, $h=0.3$, $d=0.003$, and $c=0.08$.\n    $$p^{\\ast} = \\frac{(0.02)(0.3) + 10(0.003) + 0.08}{(0.25)(8)}$$\n    $$p^{\\ast} = \\frac{0.006 + 0.030 + 0.08}{2} = \\frac{0.116}{2} = 0.058$$\n    The problem requires rounding to three significant figures.\n    $$p^{\\ast} = 0.0580$$\n    This is the 10-year risk threshold above which treatment provides a net positive expected health benefit.", "answer": "$$ \\boxed{0.0580} $$", "id": "4969510"}]}