{"hands_on_practices": [{"introduction": "This problem focuses on the heart of CRISPR action: the speed of DNA cleavage. By modeling the process with first-order kinetics, we can quantify the efficiency of a CRISPR-Cas9 enzyme under specific lab conditions. This exercise [@problem_id:4624353] is fundamental for understanding how to design experiments and interpret data related to the core catalytic activity of any CRISPR-based tool.", "problem": "Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-associated protein 9 (Cas9) ribonucleoprotein (RNP) complexes are used to cleave double-stranded plasmid DNA targets in diagnostic and therapeutic contexts. In a well-mixed reaction where the Cas9 RNP is present in excess over the plasmid targets, experiments are often carried out in a single-turnover regime in which each bound substrate undergoes one catalytic cleavage and the observed time course of substrate disappearance reflects the intrinsic cleavage step. Consider a reaction mixture containing $10\\,\\mathrm{nM}$ plasmid targets and $50\\,\\mathrm{nM}$ Cas9 RNP, measured under conditions where the observed first-order rate constant for cleavage is $k_{\\mathrm{obs}}=0.2\\,\\mathrm{min}^{-1}$. Starting from the fundamental definition of first-order kinetics for the decay of intact substrate and basic mass-action considerations applicable to enzyme-mediated reactions in single-turnover conditions, derive the expression for the time at which the fraction of cleaved substrate reaches $90\\%$. Then, compute the numerical value of that time using the given parameters. Clearly state the assumptions you make in translating the biochemical regime into the kinetic model. Round your final numerical answer to four significant figures and express the time in minutes.", "solution": "The problem is first subjected to a rigorous validation procedure.\n\n### Step 1: Extract Givens\n- System: Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-associated protein 9 (Cas9) ribonucleoprotein (RNP) complexes cleaving double-stranded plasmid DNA targets.\n- Reaction conditions:\n    - Well-mixed reaction.\n    - Cas9 RNP is in excess over plasmid targets.\n    - Single-turnover regime where the observed time course reflects the intrinsic cleavage step.\n- Initial concentration of plasmid targets (substrate, $S$): $[S]_0 = 10\\,\\mathrm{nM}$.\n- Initial concentration of Cas9 RNP (enzyme, $E$): $[E]_0 = 50\\,\\mathrm{nM}$.\n- Observed first-order rate constant for cleavage: $k_{\\mathrm{obs}} = 0.2\\,\\mathrm{min}^{-1}$.\n- Task 1: Derive the expression for the time, $t$, at which the fraction of cleaved substrate reaches $90\\%$.\n- Task 2: Compute the numerical value of this time in minutes, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity based on the provided information.\n\n- **Scientifically Grounded**: The problem describes a standard biophysical chemistry experiment, single-turnover enzyme kinetics, applied to the CRISPR-Cas9 system. This is a well-established experimental approach used to measure intrinsic catalytic rates. The given concentrations and rate constant are physically and biologically plausible for such an in vitro assay. The scientific premise is sound.\n- **Well-Posed**: The problem is clearly stated. It asks for the derivation of a specific formula and a subsequent numerical calculation. The provided data ($k_{\\mathrm{obs}}$) are sufficient and necessary to solve for the time required to reach a specific reaction extent ($90\\%$ cleavage), based on a first-order kinetic model, which is explicitly specified. The solution will be unique and meaningful.\n- **Objective**: The problem is stated using precise, quantitative, and unbiased language. There are no subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem is determined to be **valid** as it is scientifically grounded, well-posed, objective, and internally consistent. A full solution will be provided.\n\n### Solution Derivation\n\nThe problem requires a derivation starting from the fundamental definition of first-order kinetics. The following assumptions, extracted directly from the problem statement, are made to formalize the kinetic model:\n\n1.  The reaction follows first-order kinetics with respect to the concentration of the intact substrate (plasmid DNA). This is justified by the \"single-turnover\" condition in which the enzyme (Cas9 RNP) is present in a stoichiometric excess ($[E]_0 = 50\\,\\mathrm{nM} \\gg [S]_0 = 10\\,\\mathrm{nM}$). Under these conditions, the binding of substrate to the enzyme is rapid and not rate-limiting. All substrate molecules are assumed to be rapidly bound in an enzyme-substrate complex, $[ES]$.\n2.  The observed rate constant, $k_{\\mathrm{obs}}$, corresponds to the rate of the intrinsic catalytic cleavage step of the enzyme-substrate complex.\n\nLet $[S](t)$ denote the concentration of intact substrate at time $t$. The fundamental differential rate law for first-order decay is:\n$$ -\\frac{d[S](t)}{dt} = k_{\\mathrm{obs}} [S](t) $$\nTo find the concentration of substrate as a function of time, we solve this first-order linear ordinary differential equation by separation of variables:\n$$ \\frac{d[S](t)}{[S](t)} = -k_{\\mathrm{obs}} \\, dt $$\nWe integrate this equation from time $t=0$, where the concentration is $[S]_0$, to an arbitrary time $t$, where the concentration is $[S](t)$:\n$$ \\int_{[S]_0}^{[S](t)} \\frac{d[S]}{S} = \\int_{0}^{t} -k_{\\mathrm{obs}} \\, d\\tau $$\nPerforming the integration yields:\n$$ \\ln([S](t)) - \\ln([S]_0) = -k_{\\mathrm{obs}} t $$\n$$ \\ln\\left(\\frac{[S](t)}{[S]_0}\\right) = -k_{\\mathrm{obs}} t $$\nExponentiating both sides gives the expression for the concentration of intact substrate remaining at time $t$:\n$$ [S](t) = [S]_0 \\exp(-k_{\\mathrm{obs}} t) $$\nThe total concentration of substrate, in both intact and cleaved forms, is conserved. Let $[P](t)$ be the concentration of the cleaved product at time $t$. By mass balance:\n$$ [S]_0 = [S](t) + [P](t) $$\nTherefore, the concentration of cleaved substrate is:\n$$ [P](t) = [S]_0 - [S](t) = [S]_0 - [S]_0 \\exp(-k_{\\mathrm{obs}} t) = [S]_0 \\left(1 - \\exp(-k_{\\mathrm{obs}} t)\\right) $$\nThe fraction of cleaved substrate, which we denote as $f_{\\text{cleaved}}(t)$, is the ratio of the concentration of cleaved product to the initial substrate concentration:\n$$ f_{\\text{cleaved}}(t) = \\frac{[P](t)}{[S]_0} = \\frac{[S]_0 \\left(1 - \\exp(-k_{\\mathrm{obs}} t)\\right)}{[S]_0} = 1 - \\exp(-k_{\\mathrm{obs}} t) $$\nThe problem asks for the time $t_{90\\%}$ at which this fraction reaches $90\\%$, or $0.9$. We set $f_{\\text{cleaved}}(t_{90\\%}) = 0.9$:\n$$ 0.9 = 1 - \\exp(-k_{\\mathrm{obs}} t_{90\\%}) $$\nNow, we solve for $t_{90\\%}$. Rearranging the equation:\n$$ \\exp(-k_{\\mathrm{obs}} t_{90\\%}) = 1 - 0.9 = 0.1 $$\nTaking the natural logarithm of both sides:\n$$ \\ln(\\exp(-k_{\\mathrm{obs}} t_{90\\%})) = \\ln(0.1) $$\n$$ -k_{\\mathrm{obs}} t_{90\\%} = \\ln(10^{-1}) = -\\ln(10) $$\nThis gives the derived analytical expression for the time required to achieve $90\\%$ cleavage:\n$$ t_{90\\%} = \\frac{\\ln(10)}{k_{\\mathrm{obs}}} $$\nThis expression is independent of the initial substrate and enzyme concentrations, provided the single-turnover conditions are met.\n\nNext, we compute the numerical value for $t_{90\\%}$ using the provided value for $k_{\\mathrm{obs}}$.\nGiven $k_{\\mathrm{obs}} = 0.2\\,\\mathrm{min}^{-1}$:\n$$ t_{90\\%} = \\frac{\\ln(10)}{0.2\\,\\mathrm{min}^{-1}} $$\nUsing the value $\\ln(10) \\approx 2.302585...$:\n$$ t_{90\\%} \\approx \\frac{2.302585}{0.2} \\,\\mathrm{min} \\approx 11.512925 \\,\\mathrm{min} $$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $1$, $1$, $5$, and $1$. The fifth digit is $2$, so we round down.\n$$ t_{90\\%} \\approx 11.51 \\,\\mathrm{min} $$", "answer": "$$\n\\boxed{11.51}\n$$", "id": "4624353"}, {"introduction": "Translating a powerful molecular tool like CRISPR into a reliable diagnostic test requires rigorous validation. This practice explores the concept of the Limit of Detection (LoD), a critical metric that defines the smallest amount of a pathogen's nucleic acid that an assay can reliably identify. By working through this problem [@problem_id:4624372], you will learn how assay sensitivity and background noise combine to determine the ultimate performance of a CRISPR-based diagnostic.", "problem": "A clinical laboratory is validating a Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) and CRISPR-associated protein 12a (Cas12a) trans-cleavage fluorescence assay to detect a pathogen-specific nucleic acid target in patient samples. Under low-target conditions, the mean steady-state fluorescence signal is observed to be proportional to target concentration within the linear calibration range. Let the fluorescence signal be denoted by $y$ (in arbitrary units, a.u.), and the target concentration by $c$ (in nanomolar, nM). In the linear regime, the calibration relation can be modeled as\n$$y(c)=y_{\\mathrm{blank}}+S\\,c,$$\nwhere $y_{\\mathrm{blank}}$ is the mean fluorescence of reagent controls without target and $S$ is the calibration slope. Random fluctuations in the blank are characterized by a standard deviation $\\sigma_{\\mathrm{blank}}$ due to instrument noise, reporter background, and matrix effects. A commonly adopted detection criterion is that a true signal must exceed the blank mean by $k$ standard deviations, with $k=3$.\n\nStarting from these definitions and the premise that detection occurs at the concentration $c_{\\mathrm{LoD}}$ for which $y(c_{\\mathrm{LoD}})=y_{\\mathrm{blank}}+k\\,\\sigma_{\\mathrm{blank}}$, derive the analytical expression for the limit of detection (LoD) concentration in terms of $S$, $\\sigma_{\\mathrm{blank}}$, and $k$, then compute the LoD using the experimentally determined calibration slope $S=1.2\\times 10^{6}\\,\\mathrm{a.u./nM}$ and blank standard deviation $\\sigma_{\\mathrm{blank}}=5\\times 10^{3}\\,\\mathrm{a.u.}$. Express the LoD in picomolar (pM). Round your answer to 3 significant figures.\n\nFinally, based on first principles relevant to CRISPR-Cas12a assay behavior in medical microbiology, discuss the dominant sources of uncertainty that can affect the LoD and how they enter the derivation, without invoking any empirical shortcut formulas beyond the stated definitions and linear calibration relation.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and internally consistent.\n\nThe problem asks for the derivation of an analytical expression for the limit of detection ($c_{\\mathrm{LoD}}$), its numerical calculation based on provided experimental data, and a discussion of the primary sources of uncertainty from first principles.\n\nFirst, we derive the analytical expression for the limit of detection, $c_{\\mathrm{LoD}}$. The problem provides two fundamental equations:\n1. The linear calibration model, which relates the fluorescence signal $y$ to the target concentration $c$:\n$$y(c) = y_{\\mathrm{blank}} + S\\,c$$\nwhere $y_{\\mathrm{blank}}$ is the mean blank signal and $S$ is the calibration slope or sensitivity.\n\n2. The definition for the signal at the limit of detection, $y(c_{\\mathrm{LoD}})$, based on the blank's statistical properties:\n$$y(c_{\\mathrm{LoD}}) = y_{\\mathrm{blank}} + k\\,\\sigma_{\\mathrm{blank}}$$\nwhere $\\sigma_{\\mathrm{blank}}$ is the standard deviation of the blank signal and $k$ is a constant factor, given as $k=3$.\n\nThe concentration $c_{\\mathrm{LoD}}$ is the specific concentration that produces the signal $y(c_{\\mathrm{LoD}})$. Therefore, we can substitute $c = c_{\\mathrm{LoD}}$ into the first equation:\n$$y(c_{\\mathrm{LoD}}) = y_{\\mathrm{blank}} + S\\,c_{\\mathrm{LoD}}$$\n\nNow, we equate the two expressions for $y(c_{\\mathrm{LoD}})$:\n$$y_{\\mathrm{blank}} + S\\,c_{\\mathrm{LoD}} = y_{\\mathrm{blank}} + k\\,\\sigma_{\\mathrm{blank}}$$\n\nTo solve for $c_{\\mathrm{LoD}}$, we first subtract $y_{\\mathrm{blank}}$ from both sides of the equation, which yields:\n$$S\\,c_{\\mathrm{LoD}} = k\\,\\sigma_{\\mathrm{blank}}$$\n\nFinally, we isolate $c_{\\mathrm{LoD}}$ by dividing both sides by the calibration slope $S$:\n$$c_{\\mathrm{LoD}} = \\frac{k\\,\\sigma_{\\mathrm{blank}}}{S}$$\nThis is the required analytical expression for the limit of detection in terms of the given parameters.\n\nNext, we compute the numerical value for $c_{\\mathrm{LoD}}$ using the provided experimental data:\n- Factor $k = 3$ (dimensionless)\n- Blank standard deviation $\\sigma_{\\mathrm{blank}} = 5 \\times 10^{3}\\,\\mathrm{a.u.}$\n- Calibration slope $S = 1.2 \\times 10^{6}\\,\\mathrm{a.u./nM}$\n\nSubstituting these values into the derived expression:\n$$c_{\\mathrm{LoD}} = \\frac{3 \\times (5 \\times 10^{3}\\,\\mathrm{a.u.})}{1.2 \\times 10^{6}\\,\\mathrm{a.u./nM}}$$\n$$c_{\\mathrm{LoD}} = \\frac{15 \\times 10^{3}}{1.2 \\times 10^{6}}\\,\\mathrm{nM}$$\n$$c_{\\mathrm{LoD}} = 12.5 \\times 10^{-3}\\,\\mathrm{nM} = 0.0125\\,\\mathrm{nM}$$\n\nThe problem requires the answer to be expressed in picomolar (pM). The conversion between nanomolar (nM) and picomolar (pM) is $1\\,\\mathrm{nM} = 1000\\,\\mathrm{pM}$.\n$$c_{\\mathrm{LoD}} = 0.0125\\,\\mathrm{nM} \\times \\frac{1000\\,\\mathrm{pM}}{1\\,\\mathrm{nM}} = 12.5\\,\\mathrm{pM}$$\nThe value is already at 3 significant figures, so no further rounding is needed.\n\nFinally, we discuss the dominant sources of uncertainty that can affect the LoD based on first principles, as reflected in the derived equation $c_{\\mathrm{LoD}} = \\frac{k\\,\\sigma_{\\mathrm{blank}}}{S}$. The LoD is directly proportional to the blank's standard deviation ($\\sigma_{\\mathrm{blank}}$) and inversely proportional to the assay's sensitivity ($S$). Therefore, uncertainties in the LoD arise from physical and biochemical factors that influence these two parameters.\n\n1.  **Sources of Uncertainty Affecting $\\sigma_{\\mathrm{blank}}$ (Blank Noise):** An increase in $\\sigma_{\\mathrm{blank}}$ directly degrades (increases) the LoD.\n    -   **Enzymatic Background Activity:** The Cas12a enzyme may possess a low level of intrinsic, target-independent (*cis* or *trans*) nuclease activity. This leads to cleavage of the fluorescent reporter even in the absence of the target, contributing to both the mean blank signal $y_{\\mathrm{blank}}$ and its fluctuation $\\sigma_{\\mathrm{blank}}$. Batch-to-batch variation in enzyme purity and preparation can alter this background activity.\n    -   **Reporter Instability:** The single-stranded DNA (ssDNA) fluorescent reporters can undergo spontaneous degradation or quenching, which contributes to the variability of the fluorescence signal in blank samples.\n    -   **Instrumental Noise:** Fundamental sources of noise in the fluorometer, such as photon shot noise from the light source and detector, and electronic read noise, contribute to $\\sigma_{\\mathrm{blank}}$. These are physical limitations of the measurement apparatus.\n    -   **Sample Matrix Effects:** Biological samples are complex mixtures. Autofluorescent compounds, inhibitors, or non-specific interacting biomolecules present in the patient matrix can increase the variability of the blank measurement, thereby increasing $\\sigma_{\\mathrm{blank}}$.\n\n2.  **Sources of Uncertainty Affecting $S$ (Sensitivity/Slope):** A decrease in the slope $S$ directly degrades (increases) the LoD. The slope $S$ represents the rate of signal generation per unit of target concentration. In a CRISPR-Cas12a assay, this is governed by the kinetics of a multi-step enzymatic process.\n    -   **Enzyme Kinetics and Reaction Conditions:** The overall rate of the reaction, which determines $S$, is a complex function of several steps: (i) target DNA binding by the Cas12a-crRNA complex, (ii) conformational activation of the enzyme, and (iii) subsequent *trans*-cleavage of reporter molecules. This rate is highly sensitive to reaction conditions. Variations in temperature, pH, salt concentration (e.g., Mg$^{2+}$), or reagent concentrations (Cas12a, crRNA, reporter) will directly change the catalytic rate and thus alter the slope $S$. For example, a sub-optimal temperature will reduce enzymatic activity, decreasing $S$ and increasing the LoD.\n    -   **Target Accessibility and Integrity:** The structure of the target nucleic acid can affect its binding affinity to the Cas12a-crRNA complex. Secondary structures (e.g., hairpins) or the presence of DNA-binding proteins in the sample can occlude the target site, reducing the effective concentration of accessible targets and thereby lowering the observed slope $S$.\n    -   **Inhibition:** Components from the sample matrix can act as inhibitors of the Cas12a enzyme, reducing its catalytic efficiency. This inhibition lowers the reaction rate for a given target concentration, resulting in a smaller slope $S$ and a higher LoD.\n\nIn summary, the robustness of the CRISPR-diagnostic assay's LoD is fundamentally tied to controlling the sources of random error in the blank signal ($\\sigma_{\\mathrm{blank}}$) and maximizing the efficiency and consistency of the enzymatic signal amplification process ($S$).", "answer": "$$\n\\boxed{12.5}\n$$", "id": "4624372"}, {"introduction": "The power of CRISPR technology lies in its specificity, but how do we choose the best guide RNA to maximize on-target effects while minimizing dangerous off-target activity? This advanced problem [@problem_id:4624351] frames this crucial challenge as a constrained optimization task, using a thermodynamic model to score potential guides. This exercise provides a hands-on introduction to the computational bioengineering principles used to design safe and effective CRISPR diagnostics and therapeutics.", "problem": "You are designing a computational selector for Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) guide ribonucleic acids that will be used in medical microbiology diagnostics. The selector must choose a subset of candidate guides that maximizes on-target binding efficiency while ensuring the expected off-target binding risk across unintended genomic loci remains below a specified threshold. Ground your formulation and algorithm strictly on first principles of biomolecular binding thermodynamics, and express the problem as a constrained optimization problem in purely mathematical terms with all symbols and units fully specified.\n\nFundamental base and definitions:\n- The Central Dogma of Molecular Biology states that deoxyribonucleic acid (DNA) encodes information that can be targeted by ribonucleic acid (RNA) guides; in CRISPR diagnostics, guide RNA binding to the intended DNA target site is required to achieve recognition and downstream signal generation. We model binding using a two-state thermodynamic model (bound versus unbound).\n- In a two-state binding model at absolute temperature $T$, the probability of being in the bound state with standard-state free energy change $\\Delta G$ is derived from the Boltzmann distribution as\n$$\np^{\\mathrm{bind}}(\\Delta G, T) \\;=\\; \\frac{e^{-\\beta \\Delta G}}{1 + e^{-\\beta \\Delta G}} \\;=\\; \\frac{1}{1 + e^{\\beta \\Delta G}},\n$$\nwhere $\\beta = \\frac{1}{k_B T}$ and $k_B$ is the Boltzmann constant.\n- On-target efficiency for guide $i$ is defined as the bound-state probability at the intended site,\n$$\nv_i \\;=\\; p^{\\mathrm{bind}}(\\Delta G_i, T),\n$$\nwhere $\\Delta G_i$ is the standard-state free energy change (in $\\mathrm{kcal/mol}$) of the perfect-match guide $i$ binding to its intended target.\n- Off-target risk for guide $i$ is defined as the expected total bound occupancy across its enumerated unintended sites,\n$$\nw_i \\;=\\; \\sum_{j=1}^{m_i} p^{\\mathrm{bind}}(\\Delta G_i + \\Delta \\Delta G_{ij}, T),\n$$\nwhere $\\Delta \\Delta G_{ij}$ (in $\\mathrm{kcal/mol}$) is an additive free-energy penalty for binding guide $i$ to off-target site $j$ due to mismatches or context (positive values make binding less favorable), and $m_i$ is the number of enumerated off-target sites for guide $i$.\n\nConstrained optimization problem:\n- Let the decision variable be a subset $S \\subseteq \\{0,1,2,\\dots,n-1\\}$ of guides to select. The objective is to maximize the total on-target efficiency $\\sum_{i \\in S} v_i$ subject to the off-target risk constraint $\\sum_{i \\in S} w_i \\le R$, where $R$ is a user-specified threshold.\n- Tie-breaking rule: If multiple subsets achieve the same maximal objective (within tolerance $\\epsilon$), select the subset whose sorted index list is lexicographically smallest. Use tolerance $\\epsilon = 10^{-12}$.\n\nPhysical constants and units:\n- Use absolute temperature $T = 310\\ \\mathrm{K}$.\n- Use Boltzmann constant $k_B = 1.987 \\times 10^{-3}\\ \\mathrm{kcal/(mol \\cdot K)}$.\n- All energies $\\Delta G$ and $\\Delta \\Delta G$ are provided in $\\mathrm{kcal/mol}$; probabilities must be treated as decimals (unitless).\n\nCandidate guides and parameters:\n- Number of candidate guides $n = 6$, with zero-based indices $0,1,2,3,4,5$.\n- On-target standard-state free energies (perfect match) per guide $i$:\n$$\n(\\Delta G_0, \\Delta G_1, \\Delta G_2, \\Delta G_3, \\Delta G_4, \\Delta G_5) \\;=\\; (-8.4, -7.9, -9.2, -6.5, -8.0, -7.4)\\ \\mathrm{kcal/mol}.\n$$\n- Off-target additive free-energy penalties per guide (each list enumerates $\\Delta \\Delta G_{ij}$ for $j = 1, \\dots, m_i$):\n    - Guide $0$: $(11.0, 10.5, 12.0)\\ \\mathrm{kcal/mol}$.\n    - Guide $1$: $(9.0, 11.0, 8.5, 12.5)\\ \\mathrm{kcal/mol}$.\n    - Guide $2$: $(12.0, 11.5)\\ \\mathrm{kcal/mol}$.\n    - Guide $3$: $(8.0, 9.5, 10.0)\\ \\mathrm{kcal/mol}$.\n    - Guide $4$: $(10.0, 9.5, 11.0, 10.5)\\ \\mathrm{kcal/mol}$.\n    - Guide $5$: $(10.0, 12.0)\\ \\mathrm{kcal/mol}$.\n\nAlgorithmic requirements:\n- Compute $\\beta = \\frac{1}{k_B T}$.\n- Compute $v_i$ for each guide using $v_i = \\frac{1}{1 + e^{\\beta \\Delta G_i}}$.\n- Compute $w_i$ for each guide using $w_i = \\sum_j \\frac{1}{1 + e^{\\beta (\\Delta G_i + \\Delta \\Delta G_{ij})}}$.\n- Solve the selection problem exactly for the provided $n$ by enumerating all subsets $S$, computing $\\sum_{i \\in S} v_i$ and $\\sum_{i \\in S} w_i$, and applying the constraint and tie-breaking rule with tolerance $\\epsilon = 10^{-12}$.\n\nTest suite:\nEvaluate your program on the following four thresholds $R$ to test different facets of the solution. For each $R$, return the selected subset of guide indices as a sorted list.\n- Case $1$ (happy path): $R = 0.6$.\n- Case $2$ (larger allowance): $R = 1.2$.\n- Case $3$ (boundary condition): $R = 0.0$.\n- Case $4$ (edge case with effectively no constraint): $R = 100.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, where each element is itself a bracketed, comma-separated list of the selected zero-based indices. For example, a valid output looks like\n$[ [i\\_0,i\\_1], [j\\_0,j\\_1,j\\_2], [], [k\\_0,k\\_1,\\dots] ]$\nbut with the actual numbers determined by your computation.", "solution": "The problem statement poses a constrained optimization task for selecting a subset of CRISPR guide RNAs. It is scientifically grounded in a simplified thermodynamic model of biomolecular binding, is mathematically well-posed, and all parameters are explicitly defined. The problem is therefore deemed valid. We proceed with a complete solution.\n\nThe problem is to select a subset of guides $S$ from a candidate pool of $n$ guides, indexed from $0$ to $n-1$, to maximize the total on-target binding efficiency, $\\sum_{i \\in S} v_i$, subject to a constraint on the total off-target binding risk, $\\sum_{i \\in S} w_i \\le R$.\n\n**Step 1: Physical Constants and Derived Parameters**\n\nThe problem is defined at an absolute temperature $T = 310\\ \\mathrm{K}$. The Boltzmann constant is given as $k_B = 1.987 \\times 10^{-3}\\ \\mathrm{kcal/(mol \\cdot K)}$. From these, we compute the inverse thermal energy, $\\beta$, which is a central parameter in the binding probability model.\n\n$$\n\\beta = \\frac{1}{k_B T} = \\frac{1}{(1.987 \\times 10^{-3}\\ \\mathrm{kcal/(mol \\cdot K)}) \\times (310\\ \\mathrm{K})} = \\frac{1}{0.61597\\ \\mathrm{kcal/mol}} \\approx 1.623455\\ (\\mathrm{kcal/mol})^{-1}.\n$$\n\nThis parameter, $\\beta$, converts energy in $\\mathrm{kcal/mol}$ into a unitless exponent for the Boltzmann factor.\n\n**Step 2: Binding Probability Model**\n\nThe binding of a guide RNA to a DNA site is modeled as a two-state system (unbound or bound). The probability of being in the bound state, $p^{\\mathrm{bind}}$, is given by the Boltzmann distribution for a given standard-state free energy change $\\Delta G$ and temperature $T$:\n\n$$\np^{\\mathrm{bind}}(\\Delta G, T) = \\frac{1}{1 + e^{\\beta \\Delta G}}.\n$$\n\nThis function forms the basis for calculating both the on-target efficiency and the off-target risk. A more negative $\\Delta G$ signifies stronger binding and results in a binding probability closer to $1$. A positive $\\Delta G$ signifies unfavorable binding and results in a probability closer to $0$.\n\n**Step 3: Calculation of Guide-Specific Parameters ($v_i$ and $w_i$)**\n\nUsing the provided energetic parameters and the binding probability model, we compute the on-target efficiency $v_i$ and off-target risk $w_i$ for each of the $n=6$ candidate guides.\n\nThe on-target efficiency for guide $i$ is its binding probability to the perfect-match target site, characterized by the energy $\\Delta G_i$:\n$$\nv_i = p^{\\mathrm{bind}}(\\Delta G_i, T) = \\frac{1}{1 + e^{\\beta \\Delta G_i}}.\n$$\n\nThe off-target risk for guide $i$ is the sum of its binding probabilities over all $m_i$ enumerated off-target sites. The binding energy at an off-target site $j$ is penalized by an amount $\\Delta \\Delta G_{ij}$, making the total free energy change $\\Delta G_i + \\Delta \\Delta G_{ij}$:\n$$\nw_i = \\sum_{j=1}^{m_i} p^{\\mathrm{bind}}(\\Delta G_i + \\Delta \\Delta G_{ij}, T) = \\sum_{j=1}^{m_i} \\frac{1}{1 + e^{\\beta (\\Delta G_i + \\Delta \\Delta G_{ij})}}.\n$$\n\nGiven the data for $\\Delta G_i$ and $\\Delta \\Delta G_{ij}$, and using the calculated value of $\\beta$, we compute the vectors $v = (v_0, \\dots, v_5)$ and $w = (w_0, \\dots, w_5)$. All $v_i$ and $w_i$ are unitless quantities.\n\nThe input data are:\n- $\\Delta G = (-8.4, -7.9, -9.2, -6.5, -8.0, -7.4)\\ \\mathrm{kcal/mol}$.\n- $\\Delta \\Delta G_0 = (11.0, 10.5, 12.0)\\ \\mathrm{kcal/mol}$.\n- $\\Delta \\Delta G_1 = (9.0, 11.0, 8.5, 12.5)\\ \\mathrm{kcal/mol}$.\n- $\\Delta \\Delta G_2 = (12.0, 11.5)\\ \\mathrm{kcal/mol}$.\n- $\\Delta \\Delta G_3 = (8.0, 9.5, 10.0)\\ \\mathrm{kcal/mol}$.\n- $\\Delta \\Delta G_4 = (10.0, 9.5, 11.0, 10.5)\\ \\mathrm{kcal/mol}$.\n- $\\Delta \\Delta G_5 = (10.0, 12.0)\\ \\mathrm{kcal/mol}$.\n\nThe calculated values are:\n- $v \\approx (0.99999881, 0.99999729, 0.99999972, 0.99997361, 0.99999770, 0.99999382)$\n- $w \\approx (0.0493720, 0.4247833, 0.0340356, 0.0916327, 0.1430489, 0.0150346)$\n\n**Step 4: The Constrained Optimization Problem**\n\nThe task is to find the subset of guide indices $S \\subseteq \\{0, 1, 2, 3, 4, 5\\}$ that maximizes the total value $V(S) = \\sum_{i \\in S} v_i$ while satisfying the constraint that the total weight $W(S) = \\sum_{i \\in S} w_i$ does not exceed a given threshold $R$. This is a classic integer programming problem known as the **0-1 Knapsack Problem**, where each guide $i$ is an item with value $v_i$ and weight $w_i$.\n\n**Step 5: Solution Algorithm**\n\nThe number of candidate guides is $n=6$, which is very small. This permits an exact solution by enumerating all possible subsets of the guides. There are $2^n = 2^6 = 64$ such subsets, including the empty set. The algorithm proceeds as follows for each given risk threshold $R$:\n\n1.  Initialize the best-found solution: `max_value` = $0.0$, `best_subset` = $\\emptyset$. The empty set is a valid baseline solution with zero efficiency and zero risk.\n2.  Iterate through all $2^6$ subsets $S$ of the guide indices $\\{0, 1, ..., 5\\}$.\n3.  For each subset $S$:\n    a. Calculate the total off-target risk, $W(S) = \\sum_{i \\in S} w_i$.\n    b. If the constraint $W(S) \\le R$ is satisfied, proceed to evaluate the objective function. Otherwise, discard this subset.\n    c. Calculate the total on-target efficiency, $V(S) = \\sum_{i \\in S} v_i$.\n    d. Compare $V(S)$ with `max_value` using the specified tolerance $\\epsilon = 10^{-12}$:\n        i.  If $V(S) > \\text{max\\_value} + \\epsilon$, then subset $S$ is a new unique best. Update `max_value` = $V(S)$ and `best_subset` = $S$.\n        ii. If $|V(S) - \\text{max\\_value}| \\le \\epsilon$, a tie in value has occurred. Apply the tie-breaking rule: compare the sorted list of indices of $S$ with the sorted list of indices of `best_subset`. If the list for $S$ is lexicographically smaller, update `best_subset` = $S$ and `max_value` = $V(S)$.\n4.  After checking all subsets, `best_subset` holds the optimal solution for the given $R$. The result is reported as a sorted list of indices.\n\nThis exhaustive search guarantees finding the exact optimal subset according to the problem's criteria. This procedure is repeated for each of the four test cases for $R$.", "answer": "[[0,2,3,4,5],[0,1,2,3,4,5],[],[0,1,2,3,4,5]]", "id": "4624351"}]}