{"hands_on_practices": [{"introduction": "A primary challenge in clinical metagenomics is that patient samples are often dominated by host DNA, which can obscure the faint signals from pathogens. To address this, laboratories employ host depletion techniques to selectively remove human DNA before sequencing. This practice [@problem_id:4651340] will guide you through a quantitative assessment of how an effective depletion protocol can dramatically increase the proportion of microbial reads, a crucial step for improving the diagnostic sensitivity of the assay.", "problem": "A clinical stool specimen is processed for metagenomic sequencing using Next-Generation Sequencing (NGS). Prior to library preparation, host DNA depletion is performed. The specimen contains microbial deoxyribonucleic acid (DNA) with mass $10\\ \\mathrm{ng}$ and human DNA with mass $1\\ \\mathrm{\\mu g}$ before depletion. The depletion protocol removes $90\\%$ of the human DNA mass and leaves microbial DNA unchanged. Assume that library preparation and sequencing are unbiased with respect to source (microbial versus human), and that fragment size distributions and conversion efficiencies to sequencing-ready molecules are similar across sources, so that the expected fraction of sequencing reads originating from a source equals that source’s fraction of the total DNA mass in the library.\n\nUnder these assumptions, compute the expected microbial fraction of reads in the post-depletion library. Express your answer as a unitless decimal fraction and round to four significant figures.", "solution": "Let $m_{M,0}$ be the initial mass of microbial deoxyribonucleic acid (DNA) and $m_{H,0}$ be the initial mass of human DNA in the specimen. According to the problem statement, we are given:\n$$ m_{M,0} = 10\\ \\mathrm{ng} $$\n$$ m_{H,0} = 1\\ \\mathrm{\\mu g} $$\n\nTo ensure dimensional consistency, we must express both masses in the same unit. We convert micrograms ($\\mathrm{\\mu g}$) to nanograms ($\\mathrm{ng}$), using the conversion factor $1\\ \\mathrm{\\mu g} = 1000\\ \\mathrm{ng}$.\n$$ m_{H,0} = 1\\ \\mathrm{\\mu g} \\times \\frac{1000\\ \\mathrm{ng}}{1\\ \\mathrm{\\mu g}} = 1000\\ \\mathrm{ng} $$\n\nThe problem states that a host depletion protocol is applied. Let $m_{M,f}$ and $m_{H,f}$ be the final masses of microbial and human DNA, respectively, after the depletion process.\n\nThe microbial DNA mass is unchanged:\n$$ m_{M,f} = m_{M,0} = 10\\ \\mathrm{ng} $$\n\nThe depletion protocol removes $90\\%$ of the human DNA mass. This corresponds to a removal fraction of $0.9$. The remaining fraction of human DNA is $1 - 0.9 = 0.1$. Therefore, the final mass of human DNA is:\n$$ m_{H,f} = m_{H,0} \\times (1 - 0.90) = m_{H,0} \\times 0.10 $$\nSubstituting the value of $m_{H,0}$:\n$$ m_{H,f} = 1000\\ \\mathrm{ng} \\times 0.10 = 100\\ \\mathrm{ng} $$\n\nThe total mass of DNA in the post-depletion library, $m_{T,f}$, is the sum of the final microbial and human DNA masses:\n$$ m_{T,f} = m_{M,f} + m_{H,f} $$\n$$ m_{T,f} = 10\\ \\mathrm{ng} + 100\\ \\mathrm{ng} = 110\\ \\mathrm{ng} $$\n\nThe problem assumes that the expected fraction of sequencing reads originating from a source equals that source’s fraction of the total DNA mass in the library. We are asked to compute the expected microbial fraction of reads, which we denote as $F_M$. Based on the assumption:\n$$ F_M = \\frac{m_{M,f}}{m_{T,f}} $$\nSubstituting the calculated values:\n$$ F_M = \\frac{10\\ \\mathrm{ng}}{110\\ \\mathrm{ng}} = \\frac{10}{110} = \\frac{1}{11} $$\n\nTo express this fraction as a unitless decimal, we perform the division:\n$$ F_M = \\frac{1}{11} \\approx 0.09090909... $$\n\nThe problem requires the answer to be rounded to four significant figures. The first significant figure is the first non-zero digit, which is $9$. The next three significant figures are $0, 9, 0$. The digit following the fourth significant figure is $9$. Since $9 \\ge 5$, we round up the last significant digit.\n$$ F_M \\approx 0.09091 $$", "answer": "$$\\boxed{0.09091}$$", "id": "4651340"}, {"introduction": "Once sequencing is complete, a key metric for evaluating the quality of the data is sequencing coverage. Coverage quantifies the average number of times each base in a target genome has been read, directly impacting our ability to confidently assemble a genome or detect genetic variants. In this problem [@problem_id:4651408], you will learn to calculate the theoretical coverage from basic sequencing parameters and then adjust this value to account for technical artifacts like PCR duplicates, providing a more realistic estimate of the effective data available for analysis.", "problem": "A clinical shotgun metagenomic dataset is generated from a blood sample. After host depletion and taxonomic assignment, a suspected pathogen is inferred to contribute $N=1\\times 10^{5}$ reads of average length $L=150$ base pairs (bp). The pathogen’s genome is approximately $G=5\\times 10^{6}$ bp. Starting from the fundamental definition that average sequencing coverage is the expected number of times each base in the genome is sampled under uniform random sampling of bases, compute the expected average coverage for this pathogen. Then, acknowledging that Polymerase Chain Reaction (PCR) can introduce duplicate reads that do not add new unique molecular information, estimate the effective coverage if the PCR duplication rate is $10\\%$ (i.e., a fraction $p=0.10$ of reads are duplicates). Assume duplicates are distributed uniformly with respect to the genome and contribute no additional unique bases beyond their originals. Report both the expected coverage and the effective coverage after accounting for duplication as unitless fold-coverage numbers. Provide exact values without rounding.", "solution": "The solution is developed in two parts: first, calculating the expected average coverage, and second, calculating the effective coverage after accounting for PCR duplicates.\n\n**Part 1: Expected Average Coverage**\n\nThe average sequencing coverage, denoted as $C$, is the ratio of the total number of sequenced bases to the total size of the genome. Given the number of reads ($N=1\\times 10^{5}$), average read length ($L=150$ bp), and genome size ($G=5\\times 10^{6}$ bp):\n$$ C = \\frac{N \\times L}{G} $$\nSubstituting the given values:\n$$ C = \\frac{(1 \\times 10^{5}) \\times 150}{5 \\times 10^{6}} = \\frac{1.5 \\times 10^{7}}{5 \\times 10^{6}} = 3 $$\nThe expected average coverage is $3X$.\n\n**Part 2: Effective Coverage after Accounting for Duplication**\n\nPCR duplicates do not provide new information. With a duplication rate of $p = 0.10$, the fraction of unique, informative reads is $(1-p)$. The effective coverage, $C_{\\text{eff}}$, is the initial coverage adjusted by this fraction:\n$$ C_{\\text{eff}} = C \\times (1-p) $$\nSubstituting the calculated coverage and the given duplication rate:\n$$ C_{\\text{eff}} = 3 \\times (1 - 0.10) = 3 \\times 0.90 = 2.7 $$\nThe effective coverage is $2.7X$.\n\nThe two requested values are the expected coverage (3) and the effective coverage (2.7).", "answer": "$$\n\\boxed{\\begin{pmatrix} 3 & 2.7 \\end{pmatrix}}\n$$", "id": "4651408"}, {"introduction": "Ultimately, the value of a diagnostic test is not just its technical accuracy but its ability to correctly inform clinical decisions. A test's performance in a real-world setting depends on its sensitivity ($\\mathrm{Se}$) and specificity ($\\mathrm{Sp}$), as well as the prevalence ($\\pi$) of the disease in the population. This exercise [@problem_id:4651397] explores the critical concepts of Positive Predictive Value (PPV) and Negative Predictive Value (NPV), which translate abstract performance metrics into tangible probabilities that directly answer a clinician's most pressing questions about a patient's test result.", "problem": "A hospital is evaluating a metagenomic next-generation sequencing (mNGS) assay applied to cerebrospinal fluid (CSF) to screen for viral encephalitis among patients presenting with undifferentiated encephalopathy. In a defined clinical population, independent validation has estimated assay sensitivity and specificity as follows: sensitivity $\\left(\\mathrm{Se}\\right)=0.95$, specificity $\\left(\\mathrm{Sp}\\right)=0.98$. The disease prevalence in the screened population is $\\pi=0.01$. Using only the fundamental definitions of sensitivity, specificity, and prevalence, and the conditional probability rules that connect them to post-test probabilities, derive expressions for the positive predictive value (PPV) and the negative predictive value (NPV), then compute their numerical values for the stated parameters. Express both PPV and NPV as decimals without a percentage sign, and report the ordered pair $\\left(\\mathrm{PPV},\\mathrm{NPV}\\right)$ rounded to four significant figures. Finally, based on your results and the definitions you used, state in one or two sentences how these values bear on the clinical utility of mNGS as a screening test in CSF for viral encephalitis in this population.", "solution": "Let $D$ be the event that a patient has viral encephalitis, and let $D^c$ be the event that the patient does not. Let $T^+$ be the event of a positive test result from the mNGS assay, and $T^-$ be the event of a negative test result.\n\nThe givens from the problem statement are translated into probabilistic terms as follows:\n- The prevalence of the disease, $\\pi$, is the prior probability of having the disease: $P(D) = \\pi = 0.01$.\n- The probability of not having the disease is therefore $P(D^c) = 1 - P(D) = 1 - \\pi = 1 - 0.01 = 0.99$.\n- The sensitivity, $\\mathrm{Se}$, is the conditional probability of a positive test given the presence of the disease: $P(T^+ | D) = \\mathrm{Se} = 0.95$.\n- The specificity, $\\mathrm{Sp}$, is the conditional probability of a negative test given the absence of the disease: $P(T^- | D^c) = \\mathrm{Sp} = 0.98$.\n\nFrom the definitions of sensitivity and specificity, we can also define their complements:\n- The false negative rate is the probability of a negative test given the disease is present: $P(T^- | D) = 1 - P(T^+ | D) = 1 - \\mathrm{Se} = 1 - 0.95 = 0.05$.\n- The false positive rate is the probability of a positive test given the disease is absent: $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - \\mathrm{Sp} = 1 - 0.98 = 0.02$.\n\nOur objective is to derive expressions for and calculate the Positive Predictive Value (PPV) and the Negative Predictive Value (NPV).\n\nThe PPV is the post-test probability of having the disease given a positive result, which is the conditional probability $P(D | T^+)$.\nUsing Bayes' theorem, we have:\n$$\n\\mathrm{PPV} = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}\n$$\nThe denominator, $P(T^+)$, is the total probability of a positive test, which can be expanded using the law of total probability:\n$$\nP(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)\n$$\nSubstituting the terms for sensitivity, specificity, and prevalence:\n$$\nP(T^+) = (\\mathrm{Se})(\\pi) + (1 - \\mathrm{Sp})(1 - \\pi)\n$$\nTherefore, the derived expression for PPV is:\n$$\n\\mathrm{PPV} = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp}) \\cdot (1 - \\pi)}\n$$\n\nThe NPV is the post-test probability of not having the disease given a negative result, which is the conditional probability $P(D^c | T^-)$.\nUsing Bayes' theorem again:\n$$\n\\mathrm{NPV} = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}\n$$\nThe denominator, $P(T^-)$, is the total probability of a negative test, which can be expanded using the law of total probability:\n$$\nP(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)\n$$\nSubstituting the terms for sensitivity, specificity, and prevalence:\n$$\nP(T^-) = (\\mathrm{Sp})(1 - \\pi) + (1 - \\mathrm{Se})(\\pi)\n$$\nTherefore, the derived expression for NPV is:\n$$\n\\mathrm{NPV} = \\frac{\\mathrm{Sp} \\cdot (1 - \\pi)}{\\mathrm{Sp} \\cdot (1 - \\pi) + (1 - \\mathrm{Se}) \\cdot \\pi}\n$$\n\nNow, we compute the numerical values using the provided parameters: $\\mathrm{Se} = 0.95$, $\\mathrm{Sp} = 0.98$, and $\\pi = 0.01$.\n\nFor PPV:\n$$\n\\mathrm{PPV} = \\frac{0.95 \\cdot 0.01}{0.95 \\cdot 0.01 + (1 - 0.98) \\cdot (1 - 0.01)} = \\frac{0.0095}{0.0095 + (0.02)(0.99)} = \\frac{0.0095}{0.0095 + 0.0198} = \\frac{0.0095}{0.0293} \\approx 0.32423208...\n$$\nRounding to four significant figures, $\\mathrm{PPV} \\approx 0.3242$.\n\nFor NPV:\n$$\n\\mathrm{NPV} = \\frac{0.98 \\cdot (1 - 0.01)}{0.98 \\cdot (1 - 0.01) + (1 - 0.95) \\cdot 0.01} = \\frac{0.98 \\cdot 0.99}{0.98 \\cdot 0.99 + 0.05 \\cdot 0.01} = \\frac{0.9702}{0.9702 + 0.0005} = \\frac{0.9702}{0.9707} \\approx 0.9994848...\n$$\nRounding to four significant figures, $\\mathrm{NPV} \\approx 0.9995$.\n\nRegarding the clinical utility: The extremely high NPV ($0.9995$) makes the mNGS assay an excellent screening tool to rule out viral encephalitis, as a negative result is highly reliable. However, the low PPV ($0.3242$) indicates that a positive result has a high probability of being a false positive, necessitating confirmatory testing to establish a definitive diagnosis.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3242 & 0.9995 \\end{pmatrix}}\n$$", "id": "4651397"}]}