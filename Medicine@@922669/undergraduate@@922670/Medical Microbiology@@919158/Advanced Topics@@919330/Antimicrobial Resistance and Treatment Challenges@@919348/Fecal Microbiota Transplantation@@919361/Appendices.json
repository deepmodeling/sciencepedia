{"hands_on_practices": [{"introduction": "One of the central goals of Fecal Microbiota Transplantation (FMT) is to restore a healthy, diverse microbial ecosystem in a patient's gut. But how do we quantitatively measure this restoration? This exercise introduces a fundamental tool from ecology, the Shannon diversity index, which allows us to capture both the number of different species (richness) and their relative population sizes (evenness) in a single value. By applying this index to hypothetical pre- and post-FMT data, you will gain a hands-on understanding of how we can track the ecological recovery of the gut microbiome. [@problem_id:4630352]", "problem": "A clinical research lab is evaluating the impact of Fecal Microbiota Transplantation (FMT) on gut microbial diversity in a patient with recurrent Clostridioides difficile infection. They obtained high-quality amplicon sequencing counts for two fecal communities: one before FMT (Community A) and one after FMT (Community B). For each community, the taxa and read counts are as follows, where each community’s total is the sum of its listed counts.\n\nCommunity A (pre-FMT) counts:\n- Bacteroides: $2800$\n- Prevotella: $2200$\n- Faecalibacterium: $1500$\n- Clostridium sensu stricto: $1200$\n- Escherichia/Shigella: $800$\n- Other obligate anaerobes: $500$\n\nCommunity B (post-FMT) counts:\n- Bacteroides: $1700$\n- Prevotella: $1600$\n- Faecalibacterium: $1500$\n- Clostridium sensu stricto: $1400$\n- Escherichia/Shigella: $1400$\n- Other obligate anaerobes: $1400$\n\nUsing the core ecological definition of Shannon diversity, the Shannon index $H$ for a community with species-level relative abundances $\\{p_i\\}$ is\n$$\nH \\;=\\; -\\sum_{i} p_i \\,\\ln(p_i),\n$$\nwhere $\\ln$ denotes the natural logarithm, and $p_i = n_i/N$ with $n_i$ the count for species $i$ and $N$ the community total.\n\nTasks:\n1. Compute the Shannon index $H_A$ for Community A and $H_B$ for Community B using the counts above.\n2. State which community is more diverse based on the Shannon index.\n3. Define the difference $\\Delta H = H_B - H_A$ and report this single number as your final answer.\n\nUse $\\ln$ (natural logarithm). Round all reported intermediate Shannon indices and the final $\\Delta H$ to four significant figures. Express the final answer as a decimal number (unit: nats). The final boxed answer must be only the single value of $\\Delta H$.", "solution": "The problem statement has been critically validated and is deemed sound. It is scientifically grounded in established ecological principles, mathematically well-posed, objective, and contains all necessary information for a unique solution.\n\nThe problem requires the calculation and comparison of the Shannon diversity index for two microbial communities, A (pre-FMT) and B (post-FMT). The Shannon index, $H$, is a metric used in ecology to quantify the diversity within a community. It accounts for both the number of different species (richness) and their relative abundances (evenness). The formula is given as:\n$$\nH = -\\sum_{i=1}^{S} p_i \\ln(p_i)\n$$\nwhere $S$ is the number of species (taxa), $p_i$ is the relative abundance of species $i$, and $\\ln$ is the natural logarithm. The relative abundance $p_i$ is calculated as $p_i = n_i / N$, where $n_i$ is the number of individuals of species $i$ (read count) and $N$ is the total number of individuals in the community. The unit of $H$ when using the natural logarithm is nats.\n\nFirst, we calculate the total counts, $N_A$ and $N_B$, for each community.\n\nFor Community A (pre-FMT), the counts are:\n- Bacteroides: $n_{A,1} = 2800$\n- Prevotella: $n_{A,2} = 2200$\n- Faecalibacterium: $n_{A,3} = 1500$\n- Clostridium sensu stricto: $n_{A,4} = 1200$\n- Escherichia/Shigella: $n_{A,5} = 800$\n- Other obligate anaerobes: $n_{A,6} = 500$\n\nThe total count for Community A is:\n$$\nN_A = 2800 + 2200 + 1500 + 1200 + 800 + 500 = 9000\n$$\n\nFor Community B (post-FMT), the counts are:\n- Bacteroides: $n_{B,1} = 1700$\n- Prevotella: $n_{B,2} = 1600$\n- Faecalibacterium: $n_{B,3} = 1500$\n- Clostridium sensu stricto: $n_{B,4} = 1400$\n- Escherichia/Shigella: $n_{B,5} = 1400$\n- Other obligate anaerobes: $n_{B,6} = 1400$\n\nThe total count for Community B is:\n$$\nN_B = 1700 + 1600 + 1500 + 1400 + 1400 + 1400 = 9000\n$$\nBoth communities have the same total count, $N = 9000$, and the same richness, $S=6$.\n\nNext, we compute the Shannon index for each community.\n\n**Task 1: Compute Shannon index $H_A$ for Community A**\nThe relative abundances $p_{A,i}$ for Community A are:\n$p_{A,1} = 2800/9000 \\approx 0.3111$\n$p_{A,2} = 2200/9000 \\approx 0.2444$\n$p_{A,3} = 1500/9000 \\approx 0.1667$\n$p_{A,4} = 1200/9000 \\approx 0.1333$\n$p_{A,5} = 800/9000 \\approx 0.0889$\n$p_{A,6} = 500/9000 \\approx 0.0556$\n\nNow, we calculate $H_A$:\n$$\nH_A = -\\left( \\frac{2800}{9000}\\ln\\left(\\frac{2800}{9000}\\right) + \\frac{2200}{9000}\\ln\\left(\\frac{2200}{9000}\\right) + \\frac{1500}{9000}\\ln\\left(\\frac{1500}{9000}\\right) + \\frac{1200}{9000}\\ln\\left(\\frac{1200}{9000}\\right) + \\frac{800}{9000}\\ln\\left(\\frac{800}{9000}\\right) + \\frac{500}{9000}\\ln\\left(\\frac{500}{9000}\\right) \\right)\n$$\nPerforming the calculation:\n$H_A \\approx -(-0.36317 - 0.34444 - 0.29863 - 0.26865 - 0.21514 - 0.16058) = 1.65061$\nUsing higher precision, $H_A \\approx 1.650625$.\nRounding to four significant figures, the Shannon index for Community A is $H_A \\approx 1.651$ nats.\n\n**Task 1: Compute Shannon index $H_B$ for Community B**\nThe relative abundances $p_{B,i}$ for Community B are:\n$p_{B,1} = 1700/9000 \\approx 0.1889$\n$p_{B,2} = 1600/9000 \\approx 0.1778$\n$p_{B,3} = 1500/9000 \\approx 0.1667$\n$p_{B,4} = 1400/9000 \\approx 0.1556$\n$p_{B,5} = 1400/9000 \\approx 0.1556$\n$p_{B,6} = 1400/9000 \\approx 0.1556$\n\nNow, we calculate $H_B$:\n$$\nH_B = -\\left( \\frac{1700}{9000}\\ln\\left(\\frac{1700}{9000}\\right) + \\frac{1600}{9000}\\ln\\left(\\frac{1600}{9000}\\right) + \\frac{1500}{9000}\\ln\\left(\\frac{1500}{9000}\\right) + 3 \\times \\frac{1400}{9000}\\ln\\left(\\frac{1400}{9000}\\right) \\right)\n$$\nPerforming the calculation:\n$H_B \\approx -(-0.31481 - 0.30691 - 0.29863 - 3 \\times 0.28955) = 1.78899$\nUsing higher precision, $H_B \\approx 1.788841$.\nRounding to four significant figures, the Shannon index for Community B is $H_B \\approx 1.789$ nats.\n\n**Task 2: State which community is more diverse**\nComparing the two indices:\n$H_B \\approx 1.789$ and $H_A \\approx 1.651$.\nSince $H_B > H_A$, Community B (post-FMT) is more diverse than Community A (pre-FMT). This is consistent with a successful FMT, which aims to restore a healthy, diverse gut microbiota. The increased diversity in this case is due to greater evenness, as the relative abundances of the taxa in Community B are more similar to each other than in Community A, where a few taxa are highly dominant.\n\n**Task 3: Define and compute the difference $\\Delta H = H_B - H_A$**\nThe difference in Shannon diversity is defined as $\\Delta H = H_B - H_A$. To avoid rounding errors, we use the unrounded values for the calculation.\n$$\n\\Delta H = 1.788841... - 1.650625... = 0.138216...\n$$\nRounding the final answer to four significant figures as requested:\n$$\n\\Delta H \\approx 0.1382\n$$\nThis positive value confirms the increase in microbial diversity following the Fecal Microbiota Transplantation.", "answer": "$$\\boxed{0.1382}$$", "id": "4630352"}, {"introduction": "While increasing overall diversity is important, a successful FMT must also fundamentally change the *composition* of the microbial community, replacing a dysbiotic, disease-associated ecosystem with a healthy one. To quantify this ecological shift, we use metrics that compare two communities directly. This practice introduces the Bray-Curtis dissimilarity, a widely-used measure in microbial ecology that quantifies how different two communities are based on their species' abundances. [@problem_id:4630361] Calculating this value will help you appreciate FMT not just as a diversity boost, but as a full-scale community replacement.", "problem": "A patient with recurrent Clostridioides difficile infection underwent Fecal Microbiota Transplantation (FMT). Stool samples collected before FMT and at day $30$ post-FMT were profiled by $16$S ribosomal RNA (rRNA) gene sequencing, yielding amplicon counts for a fixed set of $8$ genera in the following order: Bacteroides, Prevotella, Faecalibacterium, Ruminococcus, Akkermansia, Escherichia/Shigella, Enterococcus, Clostridioides. Let the pre-FMT abundance vector be\n\n$$\n\\mathbf{x} = (600,\\,200,\\,150,\\,100,\\,50,\\,2500,\\,1800,\\,2700)\n$$\n\nand the post-FMT abundance vector be\n\n$$\n\\mathbf{y} = (2100,\\,900,\\,1300,\\,800,\\,400,\\,500,\\,200,\\,100).\n$$\n\nUsing only ecological core definitions that quantify compositional difference from shared abundances and total counts, derive the Bray–Curtis dissimilarity between the pre- and post-FMT communities and compute its value for the given data. Then, interpret the magnitude of the computed value in terms of the degree of community shift following FMT, based on the general principle that values closer to $0$ indicate more similar communities and values closer to $1$ indicate more dissimilar communities.\n\nReport the Bray–Curtis dissimilarity as a unitless decimal rounded to four significant figures.", "solution": "### Step 1: Extract Givens\nThe problem provides the following information:\n- Pre-FMT abundance vector for $8$ genera: $\\mathbf{x} = (600, 200, 150, 100, 50, 2500, 1800, 2700)$\n- Post-FMT abundance vector for the same $8$ genera: $\\mathbf{y} = (2100, 900, 1300, 800, 400, 500, 200, 100)$\n- The list of genera in order is: Bacteroides, Prevotella, Faecalibacterium, Ruminococcus, Akkermansia, Escherichia/Shigella, Enterococcus, Clostridioides.\n- The task is to compute the Bray–Curtis dissimilarity between $\\mathbf{x}$ and $\\mathbf{y}$ and interpret the result.\n- The final numerical answer must be reported as a unitless decimal rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem is grounded in established principles of medical microbiology and microbial ecology. Fecal Microbiota Transplantation (FMT) is a standard medical procedure for recurrent *Clostridioides difficile* infection. $16$S rRNA gene sequencing is a fundamental technique for profiling microbial communities. The Bray–Curtis dissimilarity is a standard, widely accepted metric for comparing the compositional structure of two ecological samples based on count data. The provided abundance vectors, while simplified, reflect a plausible biological scenario of a dysbiotic community being replaced by a healthier one post-FMT.\n- **Well-Posed**: The problem is well-posed. It provides all necessary data (two vectors of equal dimension) and asks for the calculation of a specific, well-defined mathematical quantity. The formula for Bray–Curtis dissimilarity is unique and its computation leads to a unique solution.\n- **Objective**: The problem is stated in precise, objective language. The data is numerical, and the task is a mathematical calculation followed by an interpretation based on established conventions for the dissimilarity index.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, formally structured, complete, and feasible.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe Bray–Curtis dissimilarity is an ecological measure used to quantify the compositional dissimilarity between two different samples, in this case, the pre-FMT and post-FMT microbial communities. For two communities represented by abundance vectors $\\mathbf{x} = (x_1, x_2, \\dots, x_n)$ and $\\mathbf{y} = (y_1, y_2, \\dots, y_n)$, where $n$ is the number of species (or genera, in this case), the Bray–Curtis dissimilarity, denoted as $BC(\\mathbf{x}, \\mathbf{y})$, is defined by the formula:\n\n$$\nBC(\\mathbf{x}, \\mathbf{y}) = \\frac{\\sum_{i=1}^{n} |x_i - y_i|}{\\sum_{i=1}^{n} (x_i + y_i)}\n$$\n\nThe numerator, $\\sum_{i=1}^{n} |x_i - y_i|$, represents the sum of absolute differences in abundances for each genus, quantifying the total magnitude of change across the community. The denominator, $\\sum_{i=1}^{n} (x_i + y_i)$, is the total number of individuals (total amplicon counts) summed across both communities. The index thus represents the total change in abundances as a proportion of the total abundance, yielding a value between $0$ (for identical communities) and $1$ (for communities with no taxa in common).\n\nThe given vectors are:\n$$\n\\mathbf{x} = (600, 200, 150, 100, 50, 2500, 1800, 2700)\n$$\n$$\n\\mathbf{y} = (2100, 900, 1300, 800, 400, 500, 200, 100)\n$$\nHere, the number of genera is $n=8$.\n\nFirst, we compute the numerator, the sum of the absolute differences for each corresponding element:\n$$\n\\sum_{i=1}^{8} |x_i - y_i| = |600 - 2100| + |200 - 900| + |150 - 1300| + |100 - 800| + |50 - 400| + |2500 - 500| + |1800 - 200| + |2700 - 100|\n$$\n$$\n\\sum_{i=1}^{8} |x_i - y_i| = 1500 + 700 + 1150 + 700 + 350 + 2000 + 1600 + 2600 = 10600\n$$\n\nNext, we compute the denominator, which is the sum of all abundances in both vectors. This can be calculated as the sum of total abundances for each vector.\nTotal abundance in the pre-FMT sample ($\\sum x_i$):\n$$\n\\sum_{i=1}^{8} x_i = 600 + 200 + 150 + 100 + 50 + 2500 + 1800 + 2700 = 8100\n$$\nTotal abundance in the post-FMT sample ($\\sum y_i$):\n$$\n\\sum_{i=1}^{8} y_i = 2100 + 900 + 1300 + 800 + 400 + 500 + 200 + 100 = 6300\n$$\nThe denominator is the sum of these two totals:\n$$\n\\sum_{i=1}^{8} (x_i + y_i) = \\sum_{i=1}^{8} x_i + \\sum_{i=1}^{8} y_i = 8100 + 6300 = 14400\n$$\n\nFinally, we calculate the Bray–Curtis dissimilarity by dividing the numerator by the denominator:\n$$\nBC(\\mathbf{x}, \\mathbf{y}) = \\frac{10600}{14400} = \\frac{106}{144} = \\frac{53}{72}\n$$\nTo obtain the decimal value, we perform the division:\n$$\nBC(\\mathbf{x}, \\mathbf{y}) \\approx 0.736111...\n$$\nRounding to four significant figures as required by the problem statement, we get:\n$$\nBC(\\mathbf{x}, \\mathbf{y}) \\approx 0.7361\n$$\n\n### Interpretation\nThe computed Bray–Curtis dissimilarity is $0.7361$. This value is on a scale from $0$ to $1$, where $0$ indicates perfect similarity and $1$ indicates complete dissimilarity. A value of $0.7361$ is significantly closer to $1$ than to $0$, signifying a very large and substantial shift in the gut microbial community composition between the pre-FMT and post-FMT states. This result is biologically consistent with the goal and outcome of a successful FMT, which aims to replace a diseased, dysbiotic microbial community (often characterized by high abundances of pathobionts like *Clostridioides*, *Enterococcus*, and *Escherichia/Shigella*, as seen in vector $\\mathbf{x}$) with a healthy, diverse community (characterized by higher abundances of commensal taxa like *Bacteroides* and *Faecalibacterium*, as seen in vector $\\mathbf{y}$). The high dissimilarity value quantitatively confirms that a profound ecological restructuring has occurred.", "answer": "$$\n\\boxed{0.7361}\n$$", "id": "4630361"}, {"introduction": "The efficacy of FMT is matched by an equally critical concern: safety. Transplanting a complex biological sample carries an inherent risk of transmitting undetected pathogens. Rigorous donor screening is the first line of defense, but how reliable is it? This exercise uses Bayes' theorem to explore the probabilistic nature of medical diagnostics. [@problem_id:4630418] You will calculate the post-test probability that a donor harbors a pathogen despite a negative test result, revealing the crucial interplay between test accuracy and the pathogen's prevalence in the population.", "problem": "A clinical stool donor program for Fecal Microbiota Transplantation (FMT) screens potential donors for a specific enteric pathogen using a single nucleic acid amplification test. The test has sensitivity $99.5\\%$ and specificity $99.9\\%$. Among pre-qualified donors (after initial non-laboratory screening), the pretest prevalence of the pathogen is $1$ in $10{,}000$. A particular donor’s laboratory screening result is negative. Using Bayes’ theorem together with standard definitions of sensitivity and specificity, derive from first principles an analytic expression for the post-test probability that the donor still harbors the pathogen despite the negative test, and then evaluate it numerically. Express the final probability as a decimal (not as a percentage), and round your answer to four significant figures.", "solution": "The problem requires the calculation of the post-test probability that a donor has a specific pathogen, given a negative test result. This is a classic application of Bayes' theorem in the context of medical diagnostics.\n\nFirst, we must formally define the events and probabilities based on the problem statement.\nLet $D$ denote the event that the donor has the pathogen.\nLet $D^c$ denote the event that the donor does not have the pathogen.\nLet $T^-$ denote the event that the laboratory screening result is negative.\nLet $T^+$ denote the event that the laboratory screening result is positive.\n\nThe givens can be translated into probabilistic terms as follows:\nThe pretest prevalence of the pathogen is $1$ in $10{,}000$. This is the prior probability of a donor having the pathogen, $P(D)$.\n$$P(D) = \\frac{1}{10{,}000} = 0.0001$$\nThe probability of a donor not having the pathogen is therefore:\n$$P(D^c) = 1 - P(D) = 1 - 0.0001 = 0.9999$$\n\nThe test sensitivity is given as $99.5\\%$. Sensitivity is the probability of a positive test result given that an individual has the pathogen.\n$$\\text{Sensitivity} = P(T^+ | D) = 0.995$$\n\nThe test specificity is given as $99.9\\%$. Specificity is the probability of a negative test result given that an individual does not have the pathogen.\n$$\\text{Specificity} = P(T^- | D^c) = 0.999$$\n\nWe are asked to find the post-test probability that the donor has the pathogen despite a negative test result. This is the conditional probability $P(D | T^-)$.\n\nWe will derive this probability using Bayes' theorem, which states:\n$$P(D | T^-) = \\frac{P(T^- | D) \\cdot P(D)}{P(T^-)}$$\n\nTo use this formula, we need to determine the values for the terms on the right-hand side.\nThe term $P(D)$ is the prevalence, which is given as $0.0001$.\nThe term $P(T^- | D)$ is the probability of a negative test given that the donor has the pathogen. This is the complement of the sensitivity. Since a donor with the pathogen can either test positive or negative, the sum of these probabilities is $1$.\n$$P(T^- | D) = 1 - P(T^+ | D) = 1 - \\text{Sensitivity} = 1 - 0.995 = 0.005$$\nThis value is also known as the false negative rate of the test.\n\nThe term $P(T^-)$ is the total probability of obtaining a negative test result, regardless of the donor's true disease status. We can calculate this using the law of total probability:\n$$P(T^-) = P(T^- | D) \\cdot P(D) + P(T^- | D^c) \\cdot P(D^c)$$\nWe have all the necessary components for this calculation:\n- $P(T^- | D) = 0.005$\n- $P(D) = 0.0001$\n- $P(T^- | D^c) = \\text{Specificity} = 0.999$\n- $P(D^c) = 0.9999$\n\nSubstituting these into the law of total probability:\n$$P(T^-) = (0.005)(0.0001) + (0.999)(0.9999)$$\n\nNow, we can assemble the complete analytic expression for $P(D | T^-)$. Let $p = P(D)$ be the prevalence, $\\text{Sens} = P(T^+|D)$ be the sensitivity, and $\\text{Spec} = P(T^-|D^c)$ be the specificity. The expression is:\n$$P(D | T^-) = \\frac{P(T^- | D) \\cdot P(D)}{P(T^- | D) \\cdot P(D) + P(T^- | D^c) \\cdot P(D^c)}$$\n$$P(D | T^-) = \\frac{(1 - \\text{Sens}) \\cdot p}{(1 - \\text{Sens}) \\cdot p + \\text{Spec} \\cdot (1 - p)}$$\nThis is the analytic expression derived from first principles.\n\nNext, we evaluate this expression numerically using the given values:\n$p = 0.0001$, $\\text{Sens} = 0.995$, $\\text{Spec} = 0.999$.\n$$P(D | T^-) = \\frac{(1 - 0.995) \\cdot 0.0001}{(1 - 0.995) \\cdot 0.0001 + 0.999 \\cdot (1 - 0.0001)}$$\n$$P(D | T^-) = \\frac{0.005 \\cdot 0.0001}{0.005 \\cdot 0.0001 + 0.999 \\cdot 0.9999}$$\nFirst, we calculate the numerator:\n$$\\text{Numerator} = 0.005 \\times 0.0001 = 0.0000005 = 5 \\times 10^{-7}$$\nNext, we calculate the denominator:\n$$\\text{Denominator} = (0.0000005) + (0.999 \\times 0.9999)$$\n$$0.999 \\times 0.9999 = 0.9989001$$\n$$\\text{Denominator} = 0.0000005 + 0.9989001 = 0.9989006$$\nFinally, we compute the probability:\n$$P(D | T^-) = \\frac{0.0000005}{0.9989006} \\approx 0.0000005005501$$\nThe problem requires the final probability to be expressed as a decimal rounded to four significant figures. The first four significant figures of the result are $5$, $0$, $0$, and $5$. The fifth significant figure is $5$, which means we must round up the fourth significant figure.\n$$0.0000005005501 \\approx 0.0000005006$$\nThis is the post-test probability that the donor has the pathogen, given the negative test result.", "answer": "$$\\boxed{0.0000005006}$$", "id": "4630418"}]}