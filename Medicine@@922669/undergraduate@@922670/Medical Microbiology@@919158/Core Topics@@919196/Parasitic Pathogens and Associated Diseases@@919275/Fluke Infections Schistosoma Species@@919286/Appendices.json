{"hands_on_practices": [{"introduction": "The life cycle of *Schistosoma* is a remarkable journey through the human body. This first exercise invites you to model the initial, hidden phase of infection, tracking the parasite's migration from skin penetration to its arrival in the liver. By applying fundamental principles of probability to the known stages of the parasite's life cycle, you will build a quantitative timeline of early infection. This practice [@problem_id:4631699] is valuable for understanding the pathogenesis of acute schistosomiasis and highlights how simple mathematical tools can provide insight into complex biological processes.", "problem": "A cohort of Schistosoma mansoni cercariae penetrate human skin at time $0$ and transform into schistosomula in the dermis. Empirical life-cycle observations in medical microbiology establish that schistosomula: (i) enter dermal venules within a window of $48$ to $72$ hours after penetration, (ii) traverse and reside within the pulmonary microvasculature before re-entering systemic circulation, and (iii) subsequently migrate via the splanchnic circulation to the portal venous system and lodge within hepatic sinusoids en route to the mesenteric venules. Assume the following scientifically plausible timing windows for each stage, modeled as independent continuous uniform random variables based on well-tested observations of schistosomule migration:\n- Dermis to first venous entry time, $T_1 \\sim \\mathrm{Uniform}([48,72])$ hours.\n- Post-venous-entry residence and transit within the pulmonary microvasculature until exit to systemic arterial circulation, $T_2 \\sim \\mathrm{Uniform}([3,7])$ days.\n- From pulmonary exit to arrival and lodging within hepatic sinusoids via the portomesenteric circulation, $T_3 \\sim \\mathrm{Uniform}([2,4])$ days.\n\nConstruct the mechanistic timeline implied by these steps, starting from the fundamental life-cycle fact that schistosomula penetrate the skin, enter the venous circulation, pass through the lungs, and migrate to the portal system where they lodge in hepatic sinusoids before moving to mesenteric venules. Then, using only fundamental probability principles (definition of expectation and additivity of expectations), compute the expected time from skin penetration to arrival in the hepatic sinusoids, expressed as the expected value of $T = T_1 + T_2 + T_3$ after converting all components to the same unit.\n\nExpress your final numerical answer in days, and round your answer to four significant figures. Do not include units in your final boxed value.", "solution": "The problem requires the calculation of the expected total time for a *Schistosoma mansoni* schistosomulum to migrate from the point of skin penetration to its arrival in the hepatic sinusoids. The total time, $T$, is the sum of three sequential time intervals, each modeled as an independent continuous uniform random variable.\n\nThe validation of the problem statement is performed first.\n\n### Step 1: Extract Givens\n- The total time $T$ is the sum of three time intervals: $T = T_1 + T_2 + T_3$.\n- $T_1$: Time from skin penetration to first venous entry. The distribution is given as $T_1 \\sim \\mathrm{Uniform}([48, 72])$ hours.\n- $T_2$: Time for pulmonary microvasculature residence and transit. The distribution is given as $T_2 \\sim \\mathrm{Uniform}([3, 7])$ days.\n- $T_3$: Time from pulmonary exit to arrival in hepatic sinusoids. The distribution is given as $T_3 \\sim \\mathrm{Uniform}([2, 4])$ days.\n- The random variables $T_1$, $T_2$, and $T_3$ are assumed to be independent.\n- The final answer must be expressed in days and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the canonical migration pathway of *S. mansoni* schistosomula in the human host: dermal penetration, entry into venules, transit through the pulmonary circulation (the \"lung stage\"), and subsequent migration to the portomesenteric system to reach the liver. The timeframes provided ($48$-$72$ hours for skin phase, several days for lung transit, several days for hepatoportal migration) are consistent with experimental and clinical observations in medical parasitology. The problem is scientifically sound.\n- **Well-Posed**: The problem is mathematically well-posed. It asks for the expected value of a sum of random variables whose distributions are explicitly defined. All necessary information is provided. The task is clear, and a unique, stable solution exists.\n- **Objective**: The problem is stated using precise, objective language from biology and probability theory. There are no subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution is warranted.\n\n### Solution Derivation\n\nThe total time $T$ is defined as the sum of the durations of the three sequential stages:\n$$T = T_1 + T_2 + T_3$$\nThe goal is to compute the expected value of $T$, denoted as $E[T]$. A fundamental property of expectation is its linearity. For any random variables $X_1, X_2, \\dots, X_n$, the expectation of their sum is the sum of their expectations:\n$$E[X_1 + X_2 + \\dots + X_n] = E[X_1] + E[X_2] + \\dots + E[X_n]$$\nThis property holds whether the random variables are independent or not. Applying this to the problem at hand:\n$$E[T] = E[T_1 + T_2 + T_3] = E[T_1] + E[T_2] + E[T_3]$$\nThe next step is to compute the expected value for each individual time interval, using the property of the continuous uniform distribution. For a random variable $X$ following a uniform distribution on the interval $[a, b]$, denoted $X \\sim \\mathrm{Uniform}([a, b])$, its expected value is given by:\n$$E[X] = \\frac{a+b}{2}$$\n\nWe calculate the expected value for each time component:\n1.  For $T_1 \\sim \\mathrm{Uniform}([48, 72])$ hours:\n    $$E[T_1] = \\frac{48 + 72}{2} = \\frac{120}{2} = 60 \\text{ hours}$$\n\n2.  For $T_2 \\sim \\mathrm{Uniform}([3, 7])$ days:\n    $$E[T_2] = \\frac{3 + 7}{2} = \\frac{10}{2} = 5 \\text{ days}$$\n\n3.  For $T_3 \\sim \\mathrm{Uniform}([2, 4])$ days:\n    $$E[T_3] = \\frac{2 + 4}{2} = \\frac{6}{2} = 3 \\text{ days}$$\n\nTo sum these expected values, they must be in consistent units. The problem specifies the final answer should be in days. Therefore, we must convert $E[T_1]$ from hours to days. Using the conversion factor $1 \\text{ day} = 24 \\text{ hours}$:\n$$E[T_1]_{\\text{days}} = \\frac{60 \\text{ hours}}{24 \\text{ hours/day}} = \\frac{5 \\times 12}{2 \\times 12} = \\frac{5}{2} = 2.5 \\text{ days}$$\n\nNow, we can sum the expected values, all expressed in days:\n$$E[T] = E[T_1]_{\\text{days}} + E[T_2] + E[T_3]$$\n$$E[T] = 2.5 + 5 + 3 = 10.5 \\text{ days}$$\n\nThe problem requires the final answer to be rounded to four significant figures. The exact value is $10.5$. To express this with four significant figures, we add a trailing zero, which is significant in this context.\n$$E[T] = 10.50 \\text{ days}$$\nThis represents the mean time, averaged over a large cohort of schistosomula, from the moment of skin penetration to arrival in the hepatic sinusoids.", "answer": "$$\\boxed{10.50}$$", "id": "4631699"}, {"introduction": "Once schistosomes mature and pair in the host's blood vessels, their presence is not directly visible, yet their biological activity leaves measurable traces. This practice explores how to quantify this hidden burden by connecting clinical data—circulating antigens and egg counts in stool—to the underlying number of worm pairs. You will use a steady-state kinetic model, a concept borrowed from pharmacokinetics, to translate these diagnostic signals into a direct estimate of infection intensity. This exercise [@problem_id:4631709] demonstrates a powerful approach used in clinical and epidemiological research to assess disease severity and understand the relationship between parasite load and pathology.", "problem": "A patient in an endemic area has a documented co-infection with two species of blood flukes (trematodes): Schistosoma mansoni and Schistosoma japonicum. You are provided with measurements and parameters that allow you to link circulating antigen levels to adult worm burden and, independently, stool egg counts to egg production. Assume that adult schistosomes are monogamously paired in the host vasculature and that each worm pair contains a single female producing eggs.\n\nFundamental base:\n- Circulating Anodic Antigen (CAA) is released by adult schistosome worm pairs. In steady state, antigen concentration dynamics follow first-order clearance and are maintained by constant production per worm pair. Specifically, model the antigen with a steady-state mass balance where production is proportional to worm pairs and clearance is first-order.\n- Eggs detected in stool arise from a fraction of the total eggs produced by females; the remaining eggs are retained in host tissues. Treat the fraction of produced eggs that are excreted as a species-specific constant.\n\nData and model parameters:\n- Measured plasma CAA concentration for Schistosoma mansoni: $C_{\\mathrm{sm}} = 0.050\\,\\text{mg/L}$.\n- Measured plasma CAA concentration for Schistosoma japonicum: $C_{\\mathrm{sj}} = 0.080\\,\\text{mg/L}$.\n- Antigen distribution volume: $V_{d} = 3.0\\,\\text{L}$ (assume plasma distribution).\n- Antigen clearance rate constant: $\\lambda = 2.0\\,\\text{day}^{-1}$ (assume the same for both species).\n- Antigen production rate per worm pair for Schistosoma mansoni: $q_{\\mathrm{sm}} = 0.005\\,\\text{mg/day/pair}$.\n- Antigen production rate per worm pair for Schistosoma japonicum: $q_{\\mathrm{sj}} = 0.008\\,\\text{mg/day/pair}$.\n- Average eggs per gram (EPG) in stool for Schistosoma mansoni: $\\mathrm{EPG}_{\\mathrm{sm}} = 50\\,\\text{eggs/g}$.\n- Average eggs per gram (EPG) in stool for Schistosoma japonicum: $\\mathrm{EPG}_{\\mathrm{sj}} = 200\\,\\text{eggs/g}$.\n- Daily stool output: $M = 200\\,\\text{g/day}$.\n- Fraction of produced eggs that are excreted for Schistosoma mansoni: $\\varepsilon_{\\mathrm{sm}} = 0.25$.\n- Fraction of produced eggs that are excreted for Schistosoma japonicum: $\\varepsilon_{\\mathrm{sj}} = 0.50$.\n\nTasks:\n1. Using a steady-state mass balance for circulating antigen with production proportional to worm pairs and first-order clearance, estimate the number of worm pairs for each species.\n2. From the stool data and excretion fractions, estimate the daily egg output per female ($\\text{eggs/day/female}$) for Schistosoma mansoni and Schistosoma japonicum.\n3. Compute the host-level daily egg burden as the total eggs produced per day across both species.\n\nRound your final numeric answer to four significant figures and express it in eggs per day. Provide only the total host-level daily egg burden as the final numeric answer.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded in the principles of parasitology and pharmacokinetics, is well-posed with all necessary information provided, and is presented objectively. The problem provides a clear, formalizable model to be solved using the given parameters. The values are within a plausible range for a biological modeling problem.\n\nThe solution proceeds by addressing the three specified tasks in sequence.\n\nTask 1: Estimate the number of worm pairs for each species.\n\nLet $A$ be the total mass of antigen in the distribution volume $V_d$. The concentration $C$ is then $A/V_d$. The rate of change of the antigen mass, $\\frac{dA}{dt}$, is the difference between the production rate and the clearance rate.\n\nThe production rate is proportional to the number of worm pairs, $N$. For a given species, this rate is $q \\times N$, where $q$ is the species-specific production rate per worm pair.\nThe clearance is a first-order process, so the clearance rate is $\\lambda \\times A$, where $\\lambda$ is the clearance rate constant.\n\nThe mass balance equation is:\n$$ \\frac{dA}{dt} = (q \\times N) - (\\lambda \\times A) $$\nAt steady state, $\\frac{dA}{dt} = 0$. Therefore, the production rate equals the clearance rate:\n$$ q \\times N = \\lambda \\times A $$\nSince the measured quantity is concentration $C$, we substitute $A = C \\times V_d$:\n$$ q \\times N = \\lambda \\times C \\times V_d $$\nSolving for the number of worm pairs, $N$, gives:\n$$ N = \\frac{\\lambda C V_d}{q} $$\nWe apply this formula to each *Schistosoma* species using the provided data.\n\nFor *Schistosoma mansoni*:\nGiven: $C_{\\mathrm{sm}} = 0.050\\,\\text{mg/L}$, $V_{d} = 3.0\\,\\text{L}$, $\\lambda = 2.0\\,\\text{day}^{-1}$, and $q_{\\mathrm{sm}} = 0.005\\,\\text{mg/day/pair}$.\nThe number of *S. mansoni* worm pairs, $N_{\\mathrm{sm}}$, is:\n$$ N_{\\mathrm{sm}} = \\frac{\\lambda C_{\\mathrm{sm}} V_d}{q_{\\mathrm{sm}}} = \\frac{(2.0\\,\\text{day}^{-1}) \\times (0.050\\,\\text{mg/L}) \\times (3.0\\,\\text{L})}{0.005\\,\\text{mg/day/pair}} $$\n$$ N_{\\mathrm{sm}} = \\frac{0.3}{0.005}\\,\\text{pairs} = 60\\,\\text{pairs} $$\n\nFor *Schistosoma japonicum*:\nGiven: $C_{\\mathrm{sj}} = 0.080\\,\\text{mg/L}$, $V_{d} = 3.0\\,\\text{L}$, $\\lambda = 2.0\\,\\text{day}^{-1}$, and $q_{\\mathrm{sj}} = 0.008\\,\\text{mg/day/pair}$.\nThe number of *S. japonicum* worm pairs, $N_{\\mathrm{sj}}$, is:\n$$ N_{\\mathrm{sj}} = \\frac{\\lambda C_{\\mathrm{sj}} V_d}{q_{\\mathrm{sj}}} = \\frac{(2.0\\,\\text{day}^{-1}) \\times (0.080\\,\\text{mg/L}) \\times (3.0\\,\\text{L})}{0.008\\,\\text{mg/day/pair}} $$\n$$ N_{\\mathrm{sj}} = \\frac{0.48}{0.008}\\,\\text{pairs} = 60\\,\\text{pairs} $$\n\nTask 2: Estimate the daily egg output per female for each species.\n\nThe problem states that each worm pair contains one female, so the number of females is equal to the number of worm pairs. Let $F$ be the daily egg output per female (in units of $\\text{eggs/day/female}$).\nThe total number of eggs produced per day by a species, $E_{\\mathrm{prod}}$, is $F \\times N$, where $N$ is the number of females (or pairs).\nThe total number of eggs excreted in stool per day, $E_{\\mathrm{excr}}$, is calculated from the stool egg count ($\\mathrm{EPG}$) and the daily stool mass ($M$):\n$$ E_{\\mathrm{excr}} = \\mathrm{EPG} \\times M $$\nThe link between produced and excreted eggs is the excretion fraction $\\varepsilon$:\n$$ E_{\\mathrm{excr}} = \\varepsilon \\times E_{\\mathrm{prod}} $$\nSubstituting the expressions for $E_{\\mathrm{excr}}$ and $E_{\\mathrm{prod}}$ gives:\n$$ \\mathrm{EPG} \\times M = \\varepsilon \\times (F \\times N) $$\nSolving for the daily egg output per female, $F$:\n$$ F = \\frac{\\mathrm{EPG} \\times M}{\\varepsilon \\times N} $$\n\nFor *Schistosoma mansoni*:\nGiven: $\\mathrm{EPG}_{\\mathrm{sm}} = 50\\,\\text{eggs/g}$, $M = 200\\,\\text{g/day}$, $\\varepsilon_{\\mathrm{sm}} = 0.25$, and $N_{\\mathrm{sm}} = 60$.\n$$ F_{\\mathrm{sm}} = \\frac{(50\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.25 \\times 60\\,\\text{females}} = \\frac{10000\\,\\text{eggs/day}}{15\\,\\text{females}} = \\frac{2000}{3}\\,\\text{eggs/day/female} \\approx 666.7\\,\\text{eggs/day/female} $$\n\nFor *Schistosoma japonicum*:\nGiven: $\\mathrm{EPG}_{\\mathrm{sj}} = 200\\,\\text{eggs/g}$, $M = 200\\,\\text{g/day}$, $\\varepsilon_{\\mathrm{sj}} = 0.50$, and $N_{\\mathrm{sj}} = 60$.\n$$ F_{\\mathrm{sj}} = \\frac{(200\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.50 \\times 60\\,\\text{females}} = \\frac{40000\\,\\text{eggs/day}}{30\\,\\text{females}} = \\frac{4000}{3}\\,\\text{eggs/day/female} \\approx 1333.3\\,\\text{eggs/day/female} $$\n\nTask 3: Compute the host-level daily egg burden.\n\nThe host-level daily egg burden is the total number of eggs produced per day by both species combined.\nLet $E_{\\mathrm{burden}}$ be this total burden.\n$$ E_{\\mathrm{burden}} = E_{\\mathrm{prod, sm}} + E_{\\mathrm{prod, sj}} $$\nThe total produced eggs for a species, $E_{\\mathrm{prod}}$, can be calculated more directly from the excretion data:\n$$ E_{\\mathrm{prod}} = \\frac{E_{\\mathrm{excr}}}{\\varepsilon} = \\frac{\\mathrm{EPG} \\times M}{\\varepsilon} $$\n\nFor *Schistosoma mansoni*:\n$$ E_{\\mathrm{prod, sm}} = \\frac{\\mathrm{EPG}_{\\mathrm{sm}} \\times M}{\\varepsilon_{\\mathrm{sm}}} = \\frac{(50\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.25} = \\frac{10000}{0.25}\\,\\text{eggs/day} = 40000\\,\\text{eggs/day} $$\n\nFor *Schistosoma japonicum*:\n$$ E_{\\mathrm{prod, sj}} = \\frac{\\mathrm{EPG}_{\\mathrm{sj}} \\times M}{\\varepsilon_{\\mathrm{sj}}} = \\frac{(200\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.50} = \\frac{40000}{0.50}\\,\\text{eggs/day} = 80000\\,\\text{eggs/day} $$\n\nThe total host-level daily egg burden is the sum:\n$$ E_{\\mathrm{burden}} = 40000\\,\\text{eggs/day} + 80000\\,\\text{eggs/day} = 120000\\,\\text{eggs/day} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ 120000 = 1.200 \\times 10^5 $$\nThis value is presented in scientific notation to explicitly show four significant figures.", "answer": "$$\\boxed{1.200 \\times 10^5}$$", "id": "4631709"}, {"introduction": "Moving from the individual host to the population level, controlling schistosomiasis relies on large-scale public health strategies like Mass Drug Administration (MDA). This final practice challenges you to think like an epidemiologist by building a simple mathematical model to simulate the impact of an annual MDA campaign. By deriving a clear update rule based on treatment coverage ($c$) and drug efficacy ($e$), you will project how disease prevalence in a community changes over several years. This hands-on simulation [@problem_id:4631761] illustrates the core principles of infectious disease modeling and provides a tangible sense of how public health interventions are planned and evaluated.", "problem": "A community is endemic for schistosomiasis caused by Schistosoma species. Consider an annual Mass Drug Administration (MDA) campaign using praziquantel, where Mass Drug Administration (MDA) is defined as treating a fraction $c$ of the total population each year regardless of individual infection status. Treatment efficacy is defined as the probability $e$ that a treated infected individual is cured. Prevalence is defined as the fraction $p_t \\in [0,1]$ of individuals infected at a specified time, with $t$ indexing the year (e.g., $t = 0$ denotes the baseline year before any MDA). Assume independence across individuals and years, that only infected individuals can be cured by treatment, that there is no reinfection or spontaneous clearance between annual rounds over the measurement interval, and that measurements are taken immediately after each annual MDA round.\n\nUsing only these fundamental definitions, derive a principled update rule from first principles to compute the expected prevalence immediately after each annual MDA round, starting from a baseline prevalence $p_0$. Then implement this rule to simulate the prevalence trajectory over $n$ years, producing the list $\\{p_1, p_2, \\dots, p_n\\}$ given parameters $(p_0, c, e, n)$.\n\nExpress all prevalence values as decimals in the interval $[0,1]$, rounded to six decimal places. There are no physical units. Angles are not involved.\n\nYour program must run the following test suite and aggregate the results in the specified final output format:\n\n- Test case $1$ (happy path): $(p_0, c, e, n) = (0.50, 0.75, 0.85, 3)$.\n- Test case $2$ (boundary, zero coverage): $(p_0, c, e, n) = (0.50, 0.00, 0.85, 3)$.\n- Test case $3$ (boundary, full coverage and efficacy): $(p_0, c, e, n) = (0.50, 1.00, 1.00, 3)$.\n- Test case $4$ (edge, zero baseline): $(p_0, c, e, n) = (0.00, 0.75, 0.85, 3)$.\n- Test case $5$ (general partial values, longer horizon): $(p_0, c, e, n) = (0.90, 0.50, 0.50, 5)$.\n- Test case $6$ (boundary, zero efficacy): $(p_0, c, e, n) = (0.50, 0.75, 0.00, 3)$.\n- Test case $7$ (boundary, zero rounds): $(p_0, c, e, n) = (0.50, 0.75, 0.85, 0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the prevalence trajectory list for the corresponding test case, in order, and each prevalence value is rounded to six decimal places (e.g., \"[[p1_case1,p2_case1,...],[p1_case2,...],...]\").", "solution": "The problem requires the derivation of a mathematical model from first principles to describe the year-over-year change in disease prevalence under a specific public health intervention strategy, followed by its implementation to simulate trajectories for given scenarios.\n\nWe begin by defining the variables and parameters as stipulated in the problem statement.\nLet $p_t$ be the prevalence of infection, defined as the fraction of the total population that is infected. The index $t$ represents the year, with measurements taken immediately after the annual intervention. Let $p_0$ be the baseline prevalence before the first intervention.\nThe intervention is a Mass Drug Administration (MDA) campaign with the following parameters:\n- $c \\in [0,1]$: The treatment coverage, representing the fraction of the total population treated each year.\n- $e \\in [0,1]$: The treatment efficacy, representing the probability that an infected individual who receives treatment is cured.\n\nThe model is built upon several key assumptions for the specified measurement interval:\n1.  There is no reinfection.\n2.  There is no spontaneous clearance of infection.\n3.  The population is closed (no births, deaths, or migration).\n4.  Treatment is administered randomly with respect to infection status.\n5.  Events are independent across individuals and years.\n\nOur goal is to derive an update rule that connects the prevalence after the intervention in year $t$, denoted $p_t$, to the prevalence just before that intervention, which is $p_{t-1}$ (the prevalence after the intervention in year $t-1$, given no change between interventions).\n\nLet us consider the state of the population at the beginning of year $t$, just before the MDA round. The prevalence is $p_{t-1}$.\nDuring the MDA in year $t$, a fraction $c$ of the entire population is selected for treatment. Due to the random selection, this process is independent of an individual's infection status. We can categorize the population into four distinct groups based on the conjunction of two independent attributes: infection status (prevalence $p_{t-1}$) and treatment status (coverage $c$).\n\nThe fractions of the total population in each group are:\n1.  Infected and Treated: The fraction of the population that is infected is $p_{t-1}$, and the fraction that is treated is $c$. The fraction that is both infected and treated is the product of these probabilities, $p_{t-1} \\times c$.\n2.  Infected and Not Treated: The fraction infected is $p_{t-1}$, and the fraction not treated is $(1-c)$. The fraction that is both infected and not treated is $p_{t-1} \\times (1-c)$.\n3.  Not Infected and Treated: The fraction not infected is $(1-p_{t-1})$, and the fraction treated is $c$. The fraction in this group is $(1-p_{t-1}) \\times c$.\n4.  Not Infected and Not Treated: The fraction not infected is $(1-p_{t-1})$, and the fraction not treated is $(1-c)$. The fraction in this group is $(1-p_{t-1}) \\times (1-c)$.\n\nThe new prevalence, $p_t$, is the fraction of the total population that remains infected immediately after the treatment is administered. We calculate this by summing the contributions from the groups that can contain infected individuals after the intervention.\n\n-   From the 'Infected and Treated' group (fraction $p_{t-1}c$): Treatment efficacy $e$ is the probability of being cured. Therefore, the probability of *not* being cured is $(1-e)$. The fraction of the total population from this group that remains infected is $(p_{t-1}c) \\times (1-e)$.\n-   From the 'Infected and Not Treated' group (fraction $p_{t-1}(1-c)$): These individuals receive no treatment and, by the assumption of no spontaneous clearance, all remain infected. The fraction of the total population from this group that remains infected is $p_{t-1}(1-c)$.\n-   The other two groups consist of uninfected individuals, and since treatment does not cause infection, they contribute $0$ to the post-intervention prevalence.\n\nThe total prevalence $p_t$ is the sum of the fractions of the population remaining infected:\n$$\np_t = [p_{t-1}c \\times (1-e)] + [p_{t-1}(1-c)]\n$$\n\nWe can factor out $p_{t-1}$ from the expression:\n$$\np_t = p_{t-1} [c(1-e) + (1-c)]\n$$\n\nSimplifying the term inside the brackets:\n$$\np_t = p_{t-1} [c - ce + 1 - c]\n$$\n$$\np_t = p_{t-1} (1 - ce)\n$$\n\nThis is the first-principles update rule. It is a linear recurrence relation indicating that the prevalence in one year is a constant fraction of the prevalence in the previous year. The factor $(1 - ce)$ represents the proportion of infected individuals who are not cleared of their infection in a given year.\n\nThis relationship describes a geometric progression. For any year $t \\ge 1$, the prevalence $p_t$ can be expressed directly in terms of the baseline prevalence $p_0$:\n$$\np_t = p_0 (1 - ce)^t\n$$\n\nTo implement the simulation, we will iterate the update rule $n$ times, starting with the initial prevalence $p_0$, to generate the sequence of post-MDA prevalences $\\{p_1, p_2, \\dots, p_n\\}$. For each step in the simulation, we calculate $p_t = p_{t-1}(1-ce)$, carrying full floating-point precision. The final values in the resulting list are then rounded to six decimal places as required for the output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an update rule for schistosomiasis prevalence\n    under annual Mass Drug Administration (MDA).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (p0, c, e, n)\n        (0.50, 0.75, 0.85, 3),    # Test case 1\n        (0.50, 0.00, 0.85, 3),    # Test case 2\n        (0.50, 1.00, 1.00, 3),    # Test case 3\n        (0.00, 0.75, 0.85, 3),    # Test case 4\n        (0.90, 0.50, 0.50, 5),    # Test case 5\n        (0.50, 0.75, 0.00, 3),    # Test case 6\n        (0.50, 0.75, 0.85, 0)     # Test case 7\n    ]\n\n    all_results = []\n    for p0, c, e, n in test_cases:\n        # p0: baseline prevalence\n        # c: treatment coverage\n        # e: treatment efficacy\n        # n: number of years (MDA rounds)\n\n        # The recurrence relation is p_t = p_{t-1} * (1 - c*e)\n        reduction_factor = 1.0 - c * e\n        \n        # Initialize the prevalence with the baseline value.\n        current_prevalence = float(p0)\n        \n        trajectory = []\n        for _ in range(n):\n            # Calculate the prevalence for the next year.\n            # Full precision is carried during calculation.\n            current_prevalence *= reduction_factor\n            trajectory.append(current_prevalence)\n        \n        all_results.append(trajectory)\n\n    # Format the final output string according to the problem specification.\n    # Each prevalence value must be a string rounded to six decimal places.\n    # The final string is a list of lists, with no spaces.\n    \n    # This manual construction is necessary to satisfy the specific formatting rules\n    # for numbers (fixed 6 decimal places) and list structure (no whitespace),\n    # which standard `str()` on lists of floats does not guarantee.\n    \n    case_strings = []\n    for traj in all_results:\n        # Format each number in the trajectory to a string with 6 decimal places.\n        num_strings = [f\"{p:.6f}\" for p in traj]\n        # Join the numbers into a string representation of a list.\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    # Join all case strings into the final output format.\n    final_output_string = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "4631761"}]}