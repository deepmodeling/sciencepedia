{"hands_on_practices": [{"introduction": "Accurate disease surveillance begins with reliable diagnostic tests. This exercise guides you through the fundamental statistical framework used to evaluate test performance. By deriving and calculating sensitivity ($Se$), specificity ($Sp$), and predictive values from first principles, you will gain a deeper understanding of how a test's utility is critically dependent on both its intrinsic characteristics and the prevalence of the disease in the population being tested [@problem_id:4666923].", "problem": "A hospital laboratory evaluates a new rapid antigen detection assay for a respiratory pathogen using a reference standard of Polymerase Chain Reaction (PCR). In a validation cohort, the assay is applied to two groups identified by the reference standard: the first group consists of $180$ individuals with confirmed infection, of whom $168$ return a positive assay result; the second group consists of $220$ individuals confirmed uninfected, of whom $198$ return a negative assay result. Subsequently, the assay is planned for use in a community screening program where the infection prevalence is known to be $P = 0.15$.\n\nStarting from the foundational epidemiologic definitions that sensitivity is the conditional probability $P(\\text{test positive} \\mid \\text{disease})$, specificity is the conditional probability $P(\\text{test negative} \\mid \\text{no disease})$, and prevalence is the marginal probability $P(\\text{disease})$, first derive expressions for sensitivity $Se$ and specificity $Sp$ in terms of observed counts in the validation cohort. Then, using the law of total probability and Bayesâ€™ theorem, derive analytic expressions for the positive predictive value $PPV = P(\\text{disease} \\mid \\text{test positive})$ and the negative predictive value $NPV = P(\\text{no disease} \\mid \\text{test negative})$ in terms of $P$, $Se$, and $Sp$. Finally, compute the numerical values of $Se$, $Sp$, $PPV$, and $NPV$ for the assay and the screening setting described, expressing each as a decimal (not a percentage), and round all four quantities to four significant figures.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Number of individuals with confirmed infection (disease present): $N_D = 180$.\n- Number of infected individuals who test positive (True Positives, $TP$): $168$.\n- Number of individuals confirmed uninfected (disease absent): $N_{\\bar{D}} = 220$.\n- Number of uninfected individuals who test negative (True Negatives, $TN$): $198$.\n- Infection prevalence in the community screening program: $P = P(\\text{disease}) = 0.15$.\n- Definition of sensitivity: $Se = P(\\text{test positive} \\mid \\text{disease})$.\n- Definition of specificity: $Sp = P(\\text{test negative} \\mid \\text{no disease})$.\n- Definition of positive predictive value: $PPV = P(\\text{disease} \\mid \\text{test positive})$.\n- Definition of negative predictive value: $NPV = P(\\text{no disease} \\mid \\text{test negative})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing standard, universally accepted principles of epidemiology and biostatistics (sensitivity, specificity, predictive values, Bayes' theorem). The scenario of validating a diagnostic test is a routine and fundamental task in medical science. The problem is well-posed, providing all necessary data for the derivations and calculations. The data are internally consistent (e.g., $168 \\leq 180$ and $198 \\leq 220$). The language is objective and the terms are formally defined. The problem is complete and non-contradictory.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nLet $D$ be the event that an individual has the disease and $\\bar{D}$ be the event that the individual does not have the disease. Let $T^+$ be the event of a positive test result and $T^-$ be the event of a negative test result.\n\nThe problem requires a three-part solution:\n1.  Derivation of expressions for sensitivity ($Se$) and specificity ($Sp$) from the validation cohort data.\n2.  Derivation of analytic expressions for the positive predictive value ($PPV$) and negative predictive value ($NPV$) in terms of prevalence ($P$), $Se$, and $Sp$.\n3.  Computation of the numerical values for $Se$, $Sp$, $PPV$, and $NPV$.\n\n**Part 1: Derivation of Sensitivity ($Se$) and Specificity ($Sp$)**\n\nFrom the validation cohort data, we can define the counts of true positives ($TP$), true negatives ($TN$), false positives ($FP$), and false negatives ($FN$).\n- True Positives ($TP$): The number of diseased individuals who test positive. We are given $TP = 168$.\n- False Negatives ($FN$): The number of diseased individuals who test negative. This is the total number of diseased individuals minus the true positives. $FN = N_D - TP = 180 - 168 = 12$.\n- True Negatives ($TN$): The number of non-diseased individuals who test negative. We are given $TN = 198$.\n- False Positives ($FP$): The number of non-diseased individuals who test positive. This is the total number of non-diseased individuals minus the true negatives. $FP = N_{\\bar{D}} - TN = 220 - 198 = 22$.\n\nSensitivity, $Se$, is the conditional probability of a positive test given the presence of disease, $P(T^+ \\mid D)$. This probability is estimated from the validation data as the proportion of diseased individuals who tested positive.\n$$Se = \\frac{\\text{Number of True Positives}}{\\text{Total Number with Disease}} = \\frac{TP}{TP + FN}$$\nSpecificity, $Sp$, is the conditional probability of a negative test given the absence of disease, $P(T^- \\mid \\bar{D})$. This is estimated as the proportion of non-diseased individuals who tested negative.\n$$Sp = \\frac{\\text{Number of True Negatives}}{\\text{Total Number without Disease}} = \\frac{TN}{TN + FP}$$\nThese are the required expressions in terms of observed counts.\n\n**Part 2: Derivation of Positive Predictive Value ($PPV$) and Negative Predictive Value ($NPV$)**\n\nThe Positive Predictive Value, $PPV = P(D \\mid T^+)$, is the conditional probability of having the disease given a positive test result. We use Bayes' theorem to derive its expression:\n$$PPV = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)}$$\nThe term $P(D)$ is the prevalence, given as $P$. The term $P(T^+ \\mid D)$ is the sensitivity, $Se$. The denominator, $P(T^+)$, is the marginal probability of a positive test, which can be expanded using the law of total probability:\n$$P(T^+) = P(T^+ \\mid D)P(D) + P(T^+ \\mid \\bar{D})P(\\bar{D})$$\nWe have $P(D) = P$ and $P(\\bar{D}) = 1 - P$. We know $P(T^+ \\mid D) = Se$. The term $P(T^+ \\mid \\bar{D})$ is the false positive rate, which is related to specificity by $P(T^+ \\mid \\bar{D}) = 1 - P(T^- \\mid \\bar{D}) = 1 - Sp$.\nSubstituting these into the expansion for $P(T^+)$:\n$$P(T^+) = (Se)(P) + (1 - Sp)(1 - P)$$\nSubstituting this back into the expression for $PPV$:\n$$PPV = \\frac{Se \\cdot P}{Se \\cdot P + (1 - Sp)(1 - P)}$$\nThe Negative Predictive Value, $NPV = P(\\bar{D} \\mid T^-)$, is the conditional probability of not having the disease given a negative test result. Using Bayes' theorem:\n$$NPV = P(\\bar{D} \\mid T^-) = \\frac{P(T^- \\mid \\bar{D}) P(\\bar{D})}{P(T^-)}$$\nThe term $P(\\bar{D}) = 1 - P$. The term $P(T^- \\mid \\bar{D})$ is the specificity, $Sp$. The denominator, $P(T^-)$, is the marginal probability of a negative test, expanded using the law of total probability:\n$$P(T^-) = P(T^- \\mid \\bar{D})P(\\bar{D}) + P(T^- \\mid D)P(D)$$\nThe term $P(T^- \\mid D)$ is the false negative rate, which is related to sensitivity by $P(T^- \\mid D) = 1 - P(T^+ \\mid D) = 1 - Se$.\nSubstituting these into the expansion for $P(T^-)$:\n$$P(T^-) = (Sp)(1 - P) + (1 - Se)(P)$$\nSubstituting this back into the expression for $NPV$:\n$$NPV = \\frac{Sp \\cdot (1 - P)}{Sp \\cdot (1 - P) + (1 - Se)P}$$\n\n**Part 3: Numerical Computation**\n\nFirst, we compute the values for $Se$ and $Sp$ from the validation cohort data.\n$$Se = \\frac{168}{180} = \\frac{14}{15} \\approx 0.933333...$$\nRounding to four significant figures, $Se = 0.9333$.\n$$Sp = \\frac{198}{220} = \\frac{9}{10} = 0.9$$\nExpressed to four significant figures, $Sp = 0.9000$.\n\nNext, we compute $PPV$ and $NPV$ for the community screening program where the prevalence is $P = 0.15$. Consequently, $1 - P = 0.85$.\nUsing the derived formulas and the calculated values of $Se$ and $Sp$:\nFor $PPV$, we use $Se = \\frac{14}{15}$ and $Sp = \\frac{9}{10}$:\n$$PPV = \\frac{(\\frac{14}{15}) \\cdot 0.15}{(\\frac{14}{15}) \\cdot 0.15 + (1 - \\frac{9}{10})(1 - 0.15)} = \\frac{\\frac{14}{15} \\cdot \\frac{15}{100}}{\\frac{14}{15} \\cdot \\frac{15}{100} + (\\frac{1}{10})(0.85)} = \\frac{\\frac{14}{100}}{\\frac{14}{100} + \\frac{8.5}{100}} = \\frac{0.14}{0.14 + 0.085} = \\frac{0.140}{0.225}$$\n$$PPV = \\frac{140}{225} = \\frac{28}{45} \\approx 0.622222...$$\nRounding to four significant figures, $PPV = 0.6222$.\n\nFor $NPV$, we use $Se = \\frac{14}{15}$ and $Sp = \\frac{9}{10}$:\n$$NPV = \\frac{\\frac{9}{10} \\cdot (1 - 0.15)}{\\frac{9}{10} \\cdot (1 - 0.15) + (1 - \\frac{14}{15}) \\cdot 0.15} = \\frac{0.9 \\cdot 0.85}{0.9 \\cdot 0.85 + (\\frac{1}{15})(0.15)} = \\frac{0.765}{0.765 + (\\frac{1}{15}) \\frac{15}{100}} = \\frac{0.765}{0.765 + \\frac{1}{100}}$$\n$$NPV = \\frac{0.765}{0.765 + 0.01} = \\frac{0.765}{0.775} = \\frac{765}{775} = \\frac{153}{155} \\approx 0.987096...$$\nRounding to four significant figures, $NPV = 0.9871$.\n\nThe four computed numerical values are:\n- Sensitivity ($Se$): $0.9333$\n- Specificity ($Sp$): $0.9000$\n- Positive Predictive Value ($PPV$): $0.6222$\n- Negative Predictive Value ($NPV$): $0.9871$\nThese values are presented in the final answer as a row matrix in the order ($Se$, $Sp$, $PPV$, $NPV$).", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9333 & 0.9000 & 0.6222 & 0.9871\n\\end{pmatrix}\n}\n$$", "id": "4666923"}, {"introduction": "To control an epidemic, we must measure its transmission in real time. This practice introduces the renewal model, a powerful tool for estimating the instantaneous effective reproduction number, $R_t$, directly from daily case counts. You will derive the Maximum Likelihood Estimator for $R_t$, providing a clear, intuitive link between observed incidence data and this critical measure of an outbreak's growth potential [@problem_id:4666875].", "problem": "An infectious disease outbreak in a closed population is monitored daily. Let daily incidence be denoted by $I_t$, and assume the renewal model with a known, discrete generation interval distribution $g(\\tau)$, where $g(\\tau) \\ge 0$ and $\\sum_{\\tau=1}^{\\infty} g(\\tau) = 1$. Under the renewal model, the expected incidence at time $t$ is proportional to the total infectiousness generated by prior cases, with instantaneous effective reproduction number $R_t$, so that the incidence satisfies the Poisson assumption with mean $R_t \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)$. Assume independence over times conditional on the past incidence and $g(\\tau)$.\n\nYour tasks are:\n1. Starting from the definition of the Poisson likelihood and the renewal model assumptions, derive the Maximum Likelihood Estimator (MLE) for the instantaneous effective reproduction number $R_t$. Define and use $\\Lambda_t = \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)$.\n2. Using the following empirically estimated generation interval distribution and incidence data at times $t-1$, $t-2$, $t-3$, and $t$, compute the numerical value of the MLE for $R_t$:\n   - $g(1) = 0.5$, $g(2) = 0.3$, $g(3) = 0.2$, and $g(\\tau) = 0$ for $\\tau \\ge 4$,\n   - $I_{t-1} = 18$, $I_{t-2} = 12$, $I_{t-3} = 9$, $I_t = 17$.\n   Report your final numerical answer for $R_t$ as a pure number (dimensionless) and round it to four significant figures.\n3. Briefly explain how one might correct for overdispersion by replacing the Poisson observation model with a Negative Binomial observation model, and state whether this changes the MLE for $R_t$ under a fixed overdispersion parameter.\n\nOnly the numerical value requested in part 2 will be graded as the final answer.", "solution": "The user-provided problem has been analyzed and is determined to be valid. It is scientifically grounded in established principles of mathematical epidemiology, well-posed with sufficient information for a unique solution, and objectively stated. The problem does not violate any of the invalidity criteria. We may therefore proceed with the solution.\n\nThe problem is divided into three parts. We will address each in sequence.\n\nPart 1: Derivation of the Maximum Likelihood Estimator (MLE) for $R_t$.\n\nThe problem states that the daily incidence, $I_t$, follows a Poisson distribution. The parameter of this distribution, its mean $\\lambda_t$, is given by the renewal equation:\n$$\n\\lambda_t = R_t \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)\n$$\nWe are asked to define $\\Lambda_t = \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)$, which represents the total infectiousness produced by previously infected individuals, weighted by the generation interval distribution $g(\\tau)$. With this definition, the mean of the Poisson distribution becomes $\\lambda_t = R_t \\Lambda_t$.\n\nThe number of new cases at time $t$, denoted $I_t$, is thus a random variable drawn from a Poisson distribution with this mean:\n$$\nI_t \\sim \\text{Poisson}(R_t \\Lambda_t)\n$$\nThe likelihood function, $L(R_t)$, for the single observation of incidence $I_t$ at time $t$, is given by the probability mass function (PMF) of the Poisson distribution evaluated at $I_t$:\n$$\nL(R_t; I_t, \\Lambda_t) = \\frac{(\\lambda_t)^{I_t} \\exp(-\\lambda_t)}{I_t!} = \\frac{(R_t \\Lambda_t)^{I_t} \\exp(-R_t \\Lambda_t)}{I_t!}\n$$\nTo find the MLE, it is more convenient to work with the log-likelihood function, $\\ell(R_t) = \\ln(L(R_t))$:\n$$\n\\ell(R_t) = \\ln\\left( \\frac{(R_t \\Lambda_t)^{I_t} \\exp(-R_t \\Lambda_t)}{I_t!} \\right)\n$$\nUsing the properties of logarithms, we expand this expression:\n$$\n\\ell(R_t) = \\ln((R_t \\Lambda_t)^{I_t}) - \\ln(\\exp(R_t \\Lambda_t)) - \\ln(I_t!)\n$$\n$$\n\\ell(R_t) = I_t \\ln(R_t \\Lambda_t) - R_t \\Lambda_t - \\ln(I_t!)\n$$\n$$\n\\ell(R_t) = I_t (\\ln(R_t) + \\ln(\\Lambda_t)) - R_t \\Lambda_t - \\ln(I_t!)\n$$\n$$\n\\ell(R_t) = I_t \\ln(R_t) + I_t \\ln(\\Lambda_t) - R_t \\Lambda_t - \\ln(I_t!)\n$$\nTo find the value of $R_t$ that maximizes this function, we take the first derivative of $\\ell(R_t)$ with respect to $R_t$ and set it to zero. In this differentiation, $I_t$ and $\\Lambda_t$ are treated as constants, as $\\Lambda_t$ depends on past incidence data, not on $R_t$.\n$$\n\\frac{d\\ell(R_t)}{dR_t} = \\frac{d}{dR_t} \\left( I_t \\ln(R_t) + I_t \\ln(\\Lambda_t) - R_t \\Lambda_t - \\ln(I_t!) \\right)\n$$\n$$\n\\frac{d\\ell(R_t)}{dR_t} = \\frac{I_t}{R_t} + 0 - \\Lambda_t - 0 = \\frac{I_t}{R_t} - \\Lambda_t\n$$\nSetting the derivative to zero gives the equation for the MLE, which we denote $\\hat{R}_t$:\n$$\n\\frac{I_t}{\\hat{R}_t} - \\Lambda_t = 0\n$$\n$$\n\\frac{I_t}{\\hat{R}_t} = \\Lambda_t\n$$\nSolving for $\\hat{R}_t$, we obtain the MLE:\n$$\n\\hat{R}_t = \\frac{I_t}{\\Lambda_t}\n$$\nSubstituting the definition of $\\Lambda_t$, the full expression is:\n$$\n\\hat{R}_t = \\frac{I_t}{\\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)}\n$$\nTo confirm this is a maximum, we check the second derivative:\n$$\n\\frac{d^2\\ell(R_t)}{dR_t^2} = \\frac{d}{dR_t} \\left( \\frac{I_t}{R_t} - \\Lambda_t \\right) = -\\frac{I_t}{R_t^2}\n$$\nSince incidence $I_t$ must be non-negative ($I_t \\ge 0$) and $R_t$ must be positive ($R_t > 0$), the second derivative is non-positive. For any $I_t > 0$, it is strictly negative, confirming that our solution corresponds to a maximum of the likelihood function.\n\nPart 2: Numerical Calculation of the MLE for $R_t$.\n\nWe are given the following data:\nThe generation interval distribution is $g(1) = 0.5$, $g(2) = 0.3$, $g(3) = 0.2$, and $g(\\tau) = 0$ for all $\\tau \\ge 4$.\nThe incidence data are $I_{t-1} = 18$, $I_{t-2} = 12$, $I_{t-3} = 9$, and $I_t = 17$.\n\nFirst, we compute the total infectiousness, $\\Lambda_t$. Since $g(\\tau)=0$ for $\\tau \\ge 4$, the infinite sum truncates after $\\tau=3$:\n$$\n\\Lambda_t = \\sum_{\\tau=1}^{3} I_{t-\\tau} g(\\tau) = I_{t-1} g(1) + I_{t-2} g(2) + I_{t-3} g(3)\n$$\nSubstituting the given numerical values:\n$$\n\\Lambda_t = (18)(0.5) + (12)(0.3) + (9)(0.2)\n$$\n$$\n\\Lambda_t = 9.0 + 3.6 + 1.8 = 14.4\n$$\nNow, we use the MLE formula derived in Part 1 to compute $\\hat{R}_t$:\n$$\n\\hat{R}_t = \\frac{I_t}{\\Lambda_t}\n$$\nSubstituting the values for $I_t$ and the calculated $\\Lambda_t$:\n$$\n\\hat{R}_t = \\frac{17}{14.4} \\approx 1.180555...\n$$\nThe problem requires rounding the result to four significant figures. The fifth significant figure is $5$, so we round up.\n$$\n\\hat{R}_t \\approx 1.181\n$$\n\nPart 3: Overdispersion and the Negative Binomial Model.\n\nThe Poisson distribution has a defining property that its mean is equal to its variance, i.e., $E[I_t] = \\text{Var}(I_t) = \\lambda_t$. Overdispersion is the phenomenon observed in many real-world count datasets where the sample variance is significantly larger than the sample mean. This violates the Poisson assumption.\n\nOne standard way to correct for overdispersion is to replace the Poisson observation model with a Negative Binomial (NB) model. The NB distribution has two parameters and allows the variance to be greater than the mean. A common parameterization is in terms of a mean $\\mu$ and an overdispersion parameter $\\phi > 0$, such that the variance is given by $\\text{Var}(I_t) = \\mu + \\phi \\mu^2$. As $\\phi \\to 0$, the NB distribution converges to the Poisson distribution.\n\nTo apply this to our problem, we would model $I_t$ as:\n$$\nI_t \\sim \\text{NB}(\\mu_t, \\phi)\n$$\nwhere the mean $\\mu_t$ is specified by the same renewal process model, $\\mu_t = R_t \\Lambda_t$. The problem asks if this change affects the MLE for $R_t$ under the assumption of a *fixed* overdispersion parameter $\\phi$.\n\nTo determine this, we examine the MLE for the mean parameter of the NB distribution. For a single observation $y$ from a NB distribution with mean $\\mu$ and fixed size parameter $k = 1/\\phi$, the log-likelihood is $\\ell_{NB}(\\mu) = \\ln(f(y; \\mu, k))$. The derivative of the log-likelihood with respect to the mean $\\mu$ is $\\frac{\\partial \\ell_{NB}}{\\partial \\mu} = \\frac{y-\\mu}{\\mu(1+\\mu/k)}$. Setting this score function to zero to find the MLE for the mean, $\\hat{\\mu}$, yields:\n$$\n\\frac{y - \\hat{\\mu}}{\\hat{\\mu}(1+\\hat{\\mu}/k)} = 0 \\implies y - \\hat{\\mu} = 0 \\implies \\hat{\\mu} = y\n$$\nHence, for a single observation, the MLE of the mean of an NB distribution (with a fixed dispersion parameter) is simply the observation itself. In our case, with the single observation $I_t$, the MLE for the mean $\\mu_t$ is $\\hat{\\mu}_t = I_t$.\n\nThis result is identical to the MLE for the mean of a Poisson distribution, which is also the observation itself. Since in both models the mean is related to $R_t$ by the same equation ($\\mu_t = R_t \\Lambda_t$), and the MLE for the mean is the same ($\\hat{\\mu}_t = I_t$), the resulting MLE for $R_t$ must also be the same. Setting $\\hat{\\mu}_t = \\hat{R}_t \\Lambda_t$ and using $\\hat{\\mu}_t = I_t$, we get:\n$$\nI_t = \\hat{R}_t \\Lambda_t \\implies \\hat{R}_t = \\frac{I_t}{\\Lambda_t}\n$$\nTherefore, under the condition that the overdispersion parameter $\\phi$ is fixed and known, replacing the Poisson observation model with a Negative Binomial model does *not* change the Maximum Likelihood Estimator for $R_t$. The estimator remains the ratio of the current incidence to the total past infectiousness.", "answer": "$$\\boxed{1.181}$$", "id": "4666875"}, {"introduction": "Epidemiological models are not just for analysis; they are essential for forecasting and planning. This hands-on coding exercise challenges you to implement the renewal equation to simulate an epidemic's trajectory under a constant reproduction number. Furthermore, you will learn to assess your model's performance by comparing its predictions to observed data using residual analysis, a foundational skill in validating any quantitative model of a real-world process [@problem_id:4666884].", "problem": "You are asked to implement a principled computation of the expected epidemic curve using renewal process modeling under a constant effective reproduction number and then to assess the discrepancy between expected and observed incidence using residual checks derived from a well-tested stochastic assumption. Work entirely in discrete time. The underpinning base consists of the following core definitions and facts: the effective reproduction number $R$ is the expected number of secondary infections generated by a typical infectious individual under current conditions; the generation interval distribution $g(\\tau)$ describes the delay from a primary infection to its secondary infections; under renewal process modeling with independence and stationarity assumptions and constant $R$, expected incidence at a given time equals $R$ times a weighted sum of past incidence with weights given by $g(\\tau)$; and count data from infectious disease surveillance are often well-approximated by a Poisson model, providing a variance approximately equal to the mean.\n\nTasks:\n- Derive from the stated base the discrete-time recursion that maps the effective reproduction number $R$, a discrete generation interval weight vector $w$ whose entries sum to $1$, and an initial seed incidence value to an expected incidence sequence over a fixed horizon in units of days. The discrete-time index should be $t \\in \\{0,1,\\dots,T-1\\}$ and the generation interval lags should be $s \\in \\{1,2,\\dots,S\\}$ where $S$ is the length of the weight vector $w$.\n- Given an observed incidence sequence over the same horizon, perform a residual check grounded in the Poisson assumption by computing the Pearson residual at each time $t$: $r_t = \\dfrac{O_t - E_t}{\\sqrt{E_t + \\delta}}$, where $O_t$ is observed incidence, $E_t$ is expected incidence from the renewal recursion, and $\\delta$ is a small positive constant used only to regularize denominators when $E_t$ is zero.\n- Aggregate the residuals by computing the mean absolute Pearson residual $\\overline{|r|} = \\dfrac{1}{T} \\sum_{t=0}^{T-1} \\left| r_t \\right|$ as a single float per test case. This is dimensionless. Use $\\delta = 10^{-8}$.\n- For all time indices, the unit of time is days, and all incidence counts are per day. The required outputs are unitless floats.\n\nImplementation requirements:\n- Compute the expected incidence sequence using only the discrete renewal recursion derived from the base definitions. Do not use any shortcut formulas or pre-specified target expressions beyond what follows from the base.\n- Use the provided test suite below. For each test case, compute the expected incidence sequence and then the mean absolute Pearson residual. The final program output must be a single line that is a comma-separated list enclosed in square brackets, containing the four floats for the four test cases in the order listed.\n\nTest suite:\n- Case $1$ (growth):\n  - $R = 1.4$\n  - $w = [0.2, 0.5, 0.3]$ (entries sum to $1$)\n  - Seed incidence $I_0 = 10$\n  - Horizon $T = 14$ days (indices $t = 0$ to $t = 13$)\n  - Observed incidence $[10, 12, 15, 19, 24, 31, 40, 52, 66, 84, 105, 131, 163, 204]$\n- Case $2$ (boundary $R$):\n  - $R = 1.0$\n  - $w = [0.6, 0.4]$\n  - Seed incidence $I_0 = 20$\n  - Horizon $T = 10$ days\n  - Observed incidence $[20, 19, 21, 20, 20, 19, 21, 20, 20, 19]$\n- Case $3$ (decay):\n  - $R = 0.7$\n  - $w = [0.3, 0.4, 0.2, 0.1]$\n  - Seed incidence $I_0 = 30$\n  - Horizon $T = 12$ days\n  - Observed incidence $[30, 25, 22, 19, 17, 15, 13, 12, 11, 10, 9, 8]$\n- Case $4$ (edge case with zero seed and a zero-weight lag):\n  - $R = 1.2$\n  - $w = [0.0, 0.5, 0.5]$\n  - Seed incidence $I_0 = 0$\n  - Horizon $T = 8$ days\n  - Observed incidence $[0, 0, 0, 0, 0, 0, 0, 0]$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where $r_i$ is the mean absolute Pearson residual (a float) for test case $i$.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of mathematical epidemiology, specifically renewal process theory. It is well-posed, with all necessary parameters and data provided for each test case, and is free of contradictions or ambiguities. The tasks are objective and formalizable.\n\nThe solution proceeds in two main steps as per the problem description: first, the computation of the expected daily incidence sequence using a discrete-time renewal equation, and second, the calculation of the discrepancy between this expected sequence and the observed data using Pearson residuals.\n\n**1. Derivation of the Renewal Process Recursion**\n\nThe problem states that the expected incidence at a given time is the product of the effective reproduction number, $R$, and a weighted sum of past incidences. The weights are given by the discrete generation interval distribution, $w$, whose entries $w_s$ sum to $1$. Let $E_t$ be the expected incidence on day $t$, where $t \\in \\{0, 1, \\dots, T-1\\}$. The generation interval lags are $s \\in \\{1, 2, \\dots, S\\}$, where $S$ is the length of the weight vector $w$. The weight $w_s$ represents the fraction of secondary infections that occur with a delay of $s$ days.\n\nAn individual infected on day $t'$ is expected to generate $R$ secondary infections over their entire infectious period. These secondary infections are distributed in time according to the generation interval distribution. The contribution to new infections on day $t$ from individuals who were infected on day $t-s$ is proportional to the expected incidence on that day, $E_{t-s}$, and the probability of a generation interval of length $s$, which is $w_s$.\n\nThe total \"infectious pressure\" at time $t$ is the sum of contributions from all relevant past cohorts of infected individuals. This is expressed as the weighted sum $\\sum_{s=1}^{S} w_s E_{t-s}$.\n\nTherefore, the expected incidence at time $t$, $E_t$, is given by the discrete renewal equation:\n$$E_t = R \\sum_{s=1}^{S} w_s E_{t-s}$$\nThis recursion defines $E_t$ for $t \\ge 1$. For the recursion to be well-defined, we need initial conditions. The problem provides a \"seed incidence\" $I_0$ at time $t=0$. We set $E_0 = I_0$. For any time $t' < 0$, the incidence is assumed to be zero, i.e., $E_{t'} = 0$. This is a standard assumption when initiating an epidemic model from a single seed point.\n\nThe computational algorithm for the expected incidence sequence $E = [E_0, E_1, \\dots, E_{T-1}]$ is as follows:\n1. Initialize an array for $E$ of length $T$.\n2. Set the initial value: $E_0 = I_0$.\n3. For each subsequent time step $t$ from $1$ to $T-1$, compute $E_t$ using the renewal equation. The summation $\\sum_{s=1}^{S} w_s E_{t-s}$ is performed by iterating through $s$ from $1$ to $S$. If the index $t-s$ is less than $0$, the term $E_{t-s}$ is taken as $0$, effectively truncating the sum for early time steps where $t < S$.\n\nIt is important to note that this modeling choice, starting from a single non-zero incidence value $E_0$ with all prior incidence being zero, can create a transient \"startup artifact\". For example, $E_1 = R \\cdot w_1 \\cdot E_0$. If $R \\cdot w_1 < 1$, $E_1$ will be less than $E_0$, causing an initial dip in expected incidence before a potential growth phase begins. This is a feature of the specified model, not a flaw in the reasoning. The resulting discrepancy with observed data is what the residual analysis is designed to quantify.\n\n**2. Residual Analysis**\n\nOnce the full expected incidence sequence $E_t$ for $t \\in \\{0, 1, \\dots, T-1\\}$ is computed, we assess the model's fit to the observed incidence sequence $O_t$. The problem mandates the use of Pearson residuals, which are appropriate for count data often modeled by a Poisson distribution. The variance of a Poisson-distributed random variable is equal to its mean. Thus, for an observation $O_t$ with expected value $E_t$, the standard deviation is approximately $\\sqrt{E_t}$.\n\nThe Pearson residual at time $t$, denoted $r_t$, is the difference between the observed and expected values, standardized by the estimated standard deviation of the observation:\n$$r_t = \\frac{O_t - E_t}{\\sqrt{E_t + \\delta}}$$\nHere, $\\delta$ is a small positive constant (given as $10^{-8}$) to prevent division by zero or numerical instability when $E_t$ is zero or very close to it.\n\nFinally, to obtain a single summary statistic for the overall model discrepancy for a given test case, we compute the mean absolute Pearson residual, $\\overline{|r|}$:\n$$\\overline{|r|} = \\frac{1}{T} \\sum_{t=0}^{T-1} |r_t|$$\nThis metric provides a measure of the average magnitude of the standardized error over the entire time horizon $T$. For each test case, the value of $\\overline{|r|}$ is calculated and reported as a single float.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the validation and solving process for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"R\": 1.4,\n            \"w\": [0.2, 0.5, 0.3],\n            \"I0\": 10.0,\n            \"T\": 14,\n            \"obs_inc\": [10, 12, 15, 19, 24, 31, 40, 52, 66, 84, 105, 131, 163, 204]\n        },\n        {\n            \"R\": 1.0,\n            \"w\": [0.6, 0.4],\n            \"I0\": 20.0,\n            \"T\": 10,\n            \"obs_inc\": [20, 19, 21, 20, 20, 19, 21, 20, 20, 19]\n        },\n        {\n            \"R\": 0.7,\n            \"w\": [0.3, 0.4, 0.2, 0.1],\n            \"I0\": 30.0,\n            \"T\": 12,\n            \"obs_inc\": [30, 25, 22, 19, 17, 15, 13, 12, 11, 10, 9, 8]\n        },\n        {\n            \"R\": 1.2,\n            \"w\": [0.0, 0.5, 0.5],\n            \"I0\": 0.0,\n            \"T\": 8,\n            \"obs_inc\": [0, 0, 0, 0, 0, 0, 0, 0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        mean_abs_residual = compute_mean_absolute_pearson_residual(\n            R=case[\"R\"],\n            w=case[\"w\"],\n            I0=case[\"I0\"],\n            T=case[\"T\"],\n            obs_inc=case[\"obs_inc\"]\n        )\n        results.append(mean_abs_residual)\n\n    # The final print statement must produce only the specified output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_mean_absolute_pearson_residual(R, w, I0, T, obs_inc):\n    \"\"\"\n    Computes the mean absolute Pearson residual for a single test case.\n\n    Args:\n        R (float): The effective reproduction number.\n        w (list): The discrete generation interval weight vector.\n        I0 (float): The initial seed incidence value at t=0.\n        T (int): The time horizon in days.\n        obs_inc (list): The observed incidence sequence.\n\n    Returns:\n        float: The mean absolute Pearson residual.\n    \"\"\"\n    delta = 1e-8\n    w_np = np.array(w)\n    S = len(w_np)\n    \n    # 1. Compute the expected incidence sequence using the renewal recursion.\n    # E_t = R * sum_{s=1 to S} w_s * E_{t-s}\n    expected_inc = np.zeros(T)\n    if T > 0:\n        expected_inc[0] = I0\n\n    for t in range(1, T):\n        infectious_pressure = 0.0\n        # Sum over past incidences weighted by the generation interval distribution.\n        # The lags s are 1-based, corresponding to w[s-1].\n        for s in range(1, S + 1):\n            if t - s >= 0:\n                infectious_pressure += w_np[s - 1] * expected_inc[t - s]\n        \n        expected_inc[t] = R * infectious_pressure\n\n    # 2. Compute the Pearson residuals.\n    # r_t = (O_t - E_t) / sqrt(E_t + delta)\n    obs_inc_np = np.array(obs_inc, dtype=float)\n    \n    # The denominator is regularized by delta to avoid division by zero.\n    denominators = np.sqrt(expected_inc + delta)\n    pearson_residuals = (obs_inc_np - expected_inc) / denominators\n\n    # 3. Aggregate by computing the mean absolute residual.\n    # mean_abs_r = (1/T) * sum_{t=0 to T-1} |r_t|\n    mean_abs_residual = np.mean(np.abs(pearson_residuals))\n    \n    return mean_abs_residual\n\nsolve()\n```", "id": "4666884"}]}