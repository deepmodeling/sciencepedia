{"hands_on_practices": [{"introduction": "The concentration of cyclic AMP ($cAMP$) is the primary carrier of information in its signaling pathway. This concentration is not static but represents a dynamic equilibrium between its synthesis by adenylyl cyclase and its degradation by phosphodiesterases. This first practice invites you to build the most fundamental quantitative model of this process, treating the cell as a single, well-mixed compartment to derive the steady-state concentration of $cAMP$. Mastering this simple mass-balance approach provides a crucial foundation for understanding how cells regulate the strength and duration of second messenger signals [@problem_id:5070888].", "problem": "In a neuron, cyclic adenosine monophosphate (cAMP) is synthesized by adenylyl cyclase upon sustained activation of a G protein-coupled receptor (GPCR), and degraded by phosphodiesterase (PDE). Consider a single, well-mixed compartment such that spatial gradients can be neglected and the volume is constant. Suppose that sustained GPCR activation clamps the net cAMP synthesis by adenylyl cyclase to a constant rate per unit volume denoted by $J_s$ (with units of concentration per unit time), and that PDE-mediated degradation of cAMP follows first-order kinetics with rate constant $k_d$ (with units of inverse time), so that the degradation flux per unit volume is proportional to the instantaneous cAMP concentration. Let $C(t)$ denote the concentration of cAMP as a function of time.\n\nStarting exclusively from conservation of mass for a well-mixed compartment and the stated kinetic assumptions, derive an explicit expression for the steady-state concentration of cAMP, defined as the time-independent concentration $C^{\\ast}$ that results when synthesis and degradation balance exactly. Express your final answer as a symbolic expression in terms of $J_s$ and $k_d$. Do not include units in your final expression.", "solution": "The problem requires the derivation of the steady-state concentration of cyclic adenosine monophosphate (cAMP), denoted as $C^{\\ast}$, based on a mass-balance model in a well-mixed neuronal compartment. The derivation will start from the principle of conservation of mass and the provided kinetic laws for synthesis and degradation.\n\nFirst, we establish the governing ordinary differential equation for the concentration of cAMP, $C(t)$. The principle of conservation of mass for a species in a well-mixed compartment of constant volume states that the rate of change of its concentration is equal to the sum of all synthesis rates per unit volume minus the sum of all degradation rates per unit volume.\n\nLet $\\frac{dC(t)}{dt}$ be the rate of change of the cAMP concentration over time.\n\nAccording to the problem statement:\n1.  The synthesis of cAMP by adenylyl cyclase is clamped at a constant rate per unit volume, which we denote as $J_s$. This represents the influx term.\n    Rate of Synthesis = $J_s$\n2.  The degradation of cAMP by phosphodiesterase (PDE) follows first-order kinetics. This means the degradation flux per unit volume is directly proportional to the instantaneous cAMP concentration, $C(t)$. The proportionality constant is the rate constant $k_d$. This represents the outflux term.\n    Rate of Degradation = $k_d C(t)$\n\nCombining these terms, the mass-balance equation is:\n$$\n\\frac{dC(t)}{dt} = \\text{(Rate of Synthesis)} - \\text{(Rate of Degradation)}\n$$\nSubstituting the given kinetic expressions, we obtain the differential equation for $C(t)$:\n$$\n\\frac{dC(t)}{dt} = J_s - k_d C(t)\n$$\nThis is a first-order linear ordinary differential equation with constant coefficients.\n\nThe problem asks for the steady-state concentration, $C^{\\ast}$. The steady state is defined as the condition where the concentration no longer changes with time. Mathematically, this corresponds to the point where the time derivative of the concentration is zero.\n$$\n\\frac{dC}{dt} = 0\n$$\nAt steady state, the concentration $C(t)$ becomes the time-independent steady-state concentration $C^{\\ast}$. We can substitute this condition into our governing differential equation:\n$$\n0 = J_s - k_d C^{\\ast}\n$$\nThis equation signifies that at steady state, the rate of synthesis is exactly balanced by the rate of degradation.\n\nTo find the expression for $C^{\\ast}$, we solve this algebraic equation for $C^{\\ast}$.\n$$\nk_d C^{\\ast} = J_s\n$$\nDividing both sides by the degradation rate constant $k_d$ (which must be non-zero for degradation to occur, $k_d > 0$), we isolate $C^{\\ast}$:\n$$\nC^{\\ast} = \\frac{J_s}{k_d}\n$$\nThis expression represents the steady-state concentration of cAMP as a function of the constant synthesis rate $J_s$ and the first-order degradation rate constant $k_d$. The units are consistent: $J_s$ has units of concentration/time, and $k_d$ has units of $1$/time, so their ratio has units of concentration, as expected for $C^{\\ast}$.", "answer": "$$\\boxed{\\frac{J_s}{k_d}}$$", "id": "5070888"}, {"introduction": "While the first model assumed a perfectly mixed cell, neurons possess intricate geometries, such as long dendrites, where signals are often highly localized. This practice moves beyond the simple \"box\" model to explore how a $cAMP$ signal propagates in space. By modeling a localized source of $cAMP$ within a one-dimensional dendrite, you will investigate the interplay between diffusion and degradation. This exercise [@problem_id:5070923] will guide you through deriving the spatial profile of the signal and introduce the critical biophysical concept of the space constant, $\\lambda$, which determines how far a second messenger's influence can spread from its origin.", "problem": "Consider cyclic Adenosine Monophosphate (cAMP) produced locally by a cluster of adenylyl cyclase at position $x=0$ inside a straight dendritic shaft that is well-approximated as a one-dimensional cytosolic cable of constant cross-sectional area $A$. The local production is modeled as a point source with total production rate $Q$ (in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$). The cAMP diffuses with diffusion coefficient $D$ (in $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$) and is removed by phosphodiesterase-mediated first-order degradation with rate constant $k_d$ (in $\\mathrm{s}^{-1}$). Assume the cable extends to infinity in both directions and that a steady state exists in which the cAMP concentration profile $[\\mathrm{cAMP}](x)$ is time-independent and vanishes as $|x|\\to\\infty$. \n\nStarting from particle conservation and Fick’s law of diffusion, together with first-order degradation and a localized source represented by a Dirac delta distribution, derive the steady-state spatial concentration profile $[\\mathrm{cAMP}](x)$ along the cable. Explicitly state and use the appropriate boundary and matching conditions at $x=0$. Express your final answer as a single closed-form analytic expression for $[\\mathrm{cAMP}](x)$ in terms of $Q$, $A$, $D$, and $k_d$. No numerical evaluation is required. The final answer must be a single expression and must not include units inside the expression.", "solution": "Let $C(x)$ be the steady-state concentration of cAMP, $[\\mathrm{cAMP}](x)$. The problem describes a one-dimensional reaction-diffusion system at steady state. The governing principle is the conservation of mass.\n\nFor any segment of the cable not at the origin ($x \\neq 0$), the rate of change of concentration due to diffusion must balance the rate of change due to degradation. The steady-state equation is:\n$$\nD \\frac{d^2C}{dx^2} - k_d C(x) = 0\n$$\nwhere $D$ is the diffusion coefficient and $k_d$ is the first-order degradation rate constant. We can rearrange this homogeneous second-order linear ordinary differential equation to:\n$$\n\\frac{d^2C}{dx^2} = \\frac{k_d}{D} C(x)\n$$\nLet us define the characteristic length, or space constant, $\\lambda = \\sqrt{D/k_d}$. The equation becomes:\n$$\n\\frac{d^2C}{dx^2} = \\frac{1}{\\lambda^2} C(x)\n$$\nThe general solution to this equation is $C(x) = c_1 \\exp(x/\\lambda) + c_2 \\exp(-x/\\lambda)$.\n\nWe apply the boundary conditions specified: the concentration must vanish at infinity, i.e., $\\lim_{|x|\\to\\infty} C(x) = 0$.\n- For the region $x > 0$, the term $\\exp(x/\\lambda)$ grows infinitely. To satisfy the boundary condition, its coefficient must be zero ($c_1=0$). The solution is of the form $C(x) = C_R \\exp(-x/\\lambda)$.\n- For the region $x  0$, the term $\\exp(-x/\\lambda)$ grows infinitely as $x \\to -\\infty$. To satisfy the boundary condition, its coefficient must be zero ($c_2=0$). The solution is of the form $C(x) = C_L \\exp(x/\\lambda)$.\n\nThese can be written compactly for both regions as $C(x) = C_0 \\exp(-|x|/\\lambda)$, which assumes continuity at $x=0$, a physically necessary condition. Thus, $C_R=C_L=C_0$.\n\nTo determine the constant $C_0$, we must account for the point source at $x=0$. The source introduces a discontinuity in the diffusive flux. We can derive this by integrating the full reaction-diffusion equation, including the source term represented by a Dirac delta function, $\\frac{Q}{A}\\delta(x)$, over an infinitesimally small interval $[-\\epsilon, \\epsilon]$ around the origin:\n$$\n\\int_{-\\epsilon}^{\\epsilon} \\left( D \\fracd^2C}{dx^2} - k_d C(x) + \\frac{Q}{A}\\delta(x) \\right) dx = 0\n$$\nIn the limit as $\\epsilon \\to 0$:\n- The first term gives the jump in the derivative: $D \\left[ \\frac{dC}{dx} \\right]_{-\\epsilon}^{\\epsilon} = D \\left( \\frac{dC}{dx}\\Big|_{0^+} - \\frac{dC}{dx}\\Big|_{0^-} \\right)$.\n- The integral of $k_d C(x)$ vanishes because $C(x)$ is finite.\n- The integral of the Dirac delta function is 1, so the source term contributes $\\frac{Q}{A}$.\n\nThis yields the flux balance (matching) condition at the source:\n$$\nD \\left( \\frac{dC}{dx}\\Big|_{0^+} - \\frac{dC}{dx}\\Big|_{0^-} \\right) + \\frac{Q}{A} = 0\n$$\nNow, we compute the derivatives from our solution $C(x) = C_0 \\exp(-|x|/\\lambda)$:\n- For $x > 0$, $\\frac{dC}{dx} = -\\frac{C_0}{\\lambda} \\exp(-x/\\lambda)$. At $x=0^+$, $\\frac{dC}{dx}\\Big|_{0^+} = -\\frac{C_0}{\\lambda}$.\n- For $x  0$, $\\frac{dC}{dx} = \\frac{C_0}{\\lambda} \\exp(x/\\lambda)$. At $x=0^-$, $\\frac{dC}{dx}\\Big|_{0^-} = \\frac{C_0}{\\lambda}$.\n\nSubstituting these into the matching condition:\n$$\nD \\left( -\\frac{C_0}{\\lambda} - \\frac{C_0}{\\lambda} \\right) + \\frac{Q}{A} = 0 \\quad \\implies \\quad D \\left( - \\frac{2C_0}{\\lambda} \\right) = -\\frac{Q}{A}\n$$\nSolving for the peak concentration $C_0$:\n$$\nC_0 = \\frac{Q\\lambda}{2AD}\n$$\nFinally, we substitute the definition of $\\lambda = \\sqrt{D/k_d}$:\n$$\nC_0 = \\frac{Q \\sqrt{D/k_d}}{2AD} = \\frac{Q \\sqrt{D}}{2AD\\sqrt{k_d}} = \\frac{Q}{2A\\sqrt{Dk_d}}\n$$\nSubstituting this peak concentration $C_0$ back into our general solution gives the final concentration profile:\n$$\n[\\mathrm{cAMP}](x) = C(x) = \\frac{Q}{2A\\sqrt{Dk_d}} \\exp\\left(-\\frac{|x|}{\\sqrt{D/k_d}}\\right)\n$$\nThis can be written as:\n$$\n[\\mathrm{cAMP}](x) = \\frac{Q}{2A\\sqrt{Dk_d}} \\exp\\left(-|x|\\sqrt{\\frac{k_d}{D}}\\right)\n$$", "answer": "$$ \\boxed{ \\frac{Q}{2A \\sqrt{D k_d}} \\exp\\left(-|x| \\sqrt{\\frac{k_d}{D}}\\right) } $$", "id": "5070923"}, {"introduction": "Having modeled the concentration of $cAMP$ in both time and space, we now bridge the molecular world to a functional, physiological outcome: a neuron's electrical excitability. This final practice is a hands-on computational exercise where you will build a Hodgkin-Huxley-style model of a neuron that includes the Hyperpolarization-activated Cyclic Nucleotide-gated (HCN) current, a key channel directly modulated by $cAMP$. By simulating the model [@problem_id:5070924], you will directly observe how a change in the $cAMP$ level alters the neuron's membrane potential, providing a powerful example of how modern computational methods are used to connect molecular signaling pathways to systems-level neuronal function.", "problem": "You are to write a complete, runnable program that simulates, from first principles, a Hodgkin–Huxley-style neuron model with a leak current and a Hyperpolarization-activated Cyclic Nucleotide-gated (HCN) current whose voltage-dependent activation is modulated by cyclic Adenosine Monophosphate (cAMP). The goal is to compute the steady depolarization in membrane potential produced by a step increase in cAMP from $1\\,\\mu\\mathrm{M}$ to $5\\,\\mu\\mathrm{M}$. The model must be based on the membrane-as-capacitor law and standard first-order gating kinetics, and must incorporate a physically plausible binding model for cAMP-dependent shifts in the HCN activation curve. All quantities must be treated in consistent physical units, and the final reported depolarizations must be expressed in $\\mathrm{mV}$.\n\nFundamental base and core definitions to use:\n- Treat the neuron membrane as a capacitor with capacitance $C_m$, obeying $$C_m \\,\\frac{dV}{dt} = - I_{\\mathrm{ion}} + I_{\\mathrm{app}},$$ where $V$ is the membrane potential, $I_{\\mathrm{ion}}$ is the total ionic current density, and $I_{\\mathrm{app}}$ is the externally applied current density. Set $I_{\\mathrm{app}} = 0$ throughout.\n- Include two currents in $I_{\\mathrm{ion}}$: a leak current and an HCN current. Use $$I_{\\mathrm{ion}} = g_L\\,(V - E_L) + g_h\\,m\\,(V - E_h),$$ where $g_L$ and $E_L$ are the leak conductance and leak reversal potential, $g_h$ and $E_h$ are the maximal HCN conductance and HCN reversal potential, and $m$ is the HCN activation gate (fractional open probability).\n- Use first-order Hodgkin–Huxley activation dynamics for the HCN gate: $$\\frac{dm}{dt} = \\frac{m_\\infty(V,c) - m}{\\tau_h},$$ with a constant activation time constant $\\tau_h$.\n- For the steady-state activation $m_\\infty(V,c)$, use a Boltzmann form with a cAMP-dependent half-activation voltage $V_{1/2}(c)$ and slope factor $k$: $$m_\\infty(V,c) = \\frac{1}{1 + \\exp\\!\\left(\\frac{V - V_{1/2}(c)}{k}\\right)}.$$\n- Model the cAMP dependence of $V_{1/2}(c)$ via a saturating binding relation based on standard Hill kinetics: define the binding occupancy $$\\theta(c) = \\frac{c^n}{K^n + c^n},$$ and map occupancy to a voltage shift with a maximal depolarizing shift $\\Delta V_{\\max}$ such that $$V_{1/2}(c) = V_{1/2,0} + \\Delta V_{\\max}\\,\\theta(c),$$ where $V_{1/2,0}$ is the half-activation voltage at negligible cAMP.\n\nSimulation protocol and units:\n- Use $C_m = 1\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$, $E_L = -65\\,\\mathrm{mV}$, $g_L = 0.1\\,\\mathrm{mS}/\\mathrm{cm}^2$, $E_h = -30\\,\\mathrm{mV}$, $\\tau_h = 150\\,\\mathrm{ms}$, $V_{1/2,0} = -75\\,\\mathrm{mV}$, $\\Delta V_{\\max} = 15\\,\\mathrm{mV}$, $K = 2\\,\\mu\\mathrm{M}$, and $n = 2$. The slope factor $k$ and maximal HCN conductance $g_h$ will vary per test case as specified below. Use a fixed-step time integration with step size $\\Delta t = 0.5\\,\\mathrm{ms}$, total simulation duration $T = 8.0\\,\\mathrm{s}$, and a cAMP step time $t_{\\mathrm{step}} = 2.0\\,\\mathrm{s}$ from $c_{\\mathrm{pre}} = 1\\,\\mu\\mathrm{M}$ to $c_{\\mathrm{post}} = 5\\,\\mu\\mathrm{M}$.\n- Initialize the state at $t = 0$ with $V(0) = E_L$ and $m(0) = m_\\infty(V(0), c_{\\mathrm{pre}})$.\n- Compute the pre-step steady membrane potential $V_{\\mathrm{pre}}$ as the mean $V(t)$ over the interval $t \\in [1.5, 2.0]\\,\\mathrm{s}$, and the late post-step steady membrane potential $V_{\\mathrm{post}}$ as the mean $V(t)$ over $t \\in [7.5, 8.0]\\,\\mathrm{s}$.\n- Report the steady depolarization as $\\Delta V = V_{\\mathrm{post}} - V_{\\mathrm{pre}}$, in $\\mathrm{mV}$, rounded to three decimal places.\n\nNumerical scheme:\n- Implement a forward-Euler or equivalent fixed-step update using the definitions above. Treat currents with the outward-positive convention so that inward HCN current (for $V  E_h$) depolarizes the membrane.\n\nTest suite and coverage:\nProvide four test cases as tuples specifying $(g_h, k)$ with all other parameters fixed as above:\n1. Case A (general happy path): $(g_h = 0.5\\,\\mathrm{mS}/\\mathrm{cm}^2, k = 7\\,\\mathrm{mV})$.\n2. Case B (boundary, no HCN): $(g_h = 0.0\\,\\mathrm{mS}/\\mathrm{cm}^2, k = 7\\,\\mathrm{mV})$.\n3. Case C (strong HCN): $(g_h = 1.5\\,\\mathrm{mS}/\\mathrm{cm}^2, k = 7\\,\\mathrm{mV})$.\n4. Case D (reduced voltage sensitivity): $(g_h = 0.5\\,\\mathrm{mS}/\\mathrm{cm}^2, k = 20\\,\\mathrm{mV})$.\n\nRequired final output format:\nYour program should produce a single line of output containing the computed depolarizations for the four cases as a comma-separated list enclosed in square brackets, for example, $$[\\Delta V_{\\mathrm{A}},\\Delta V_{\\mathrm{B}},\\Delta V_{\\mathrm{C}},\\Delta V_{\\mathrm{D}}],$$ where each entry is a float in $\\mathrm{mV}$ rounded to three decimal places and no units are printed in the line.", "solution": "We begin from the membrane-as-capacitor law, which is a fundamental physical description of a capacitive element charged by ionic currents. With membrane capacitance $C_m$ and outward-positive ionic currents, the voltage dynamics are given by\n$$\nC_m\\,\\frac{dV}{dt} = -I_{\\mathrm{ion}} + I_{\\mathrm{app}},\n$$\nand we set $I_{\\mathrm{app}} = 0$ to isolate intrinsic currents. The total ionic current is modeled as the sum of a passive leak and an HCN current,\n$$\nI_{\\mathrm{ion}} = g_L\\,(V - E_L) + g_h\\,m\\,(V - E_h),\n$$\nwhere $g_L$ and $E_L$ are the leak conductance and reversal potential, and $g_h$ and $E_h$ are the maximal HCN conductance and reversal potential. The HCN current is proportionate to the open probability $m$ of the channel, multiplied by the driving force $(V - E_h)$.\n\nThe HCN channel activation follows first-order Hodgkin–Huxley kinetics, yielding\n$$\n\\frac{dm}{dt} = \\frac{m_\\infty(V,c) - m}{\\tau_h},\n$$\nwhere $\\tau_h$ is a time constant and $m_\\infty(V,c)$ is the steady-state activation at voltage $V$ and cAMP concentration $c$. Under the Boltzmann assumption for voltage-dependent gating, the steady-state activation has the logistic form\n$$\nm_\\infty(V,c) = \\frac{1}{1 + \\exp\\!\\left(\\frac{V - V_{1/2}(c)}{k}\\right)},\n$$\nwith slope factor $k$ and half-activation voltage $V_{1/2}(c)$. For HCN channels, cyclic Adenosine Monophosphate (cAMP) binds to the cyclic nucleotide-binding domain and stabilizes the open state, producing a depolarizing shift in $V_{1/2}$. A standard model of ligand binding occupancy is given by Hill kinetics,\n$$\n\\theta(c) = \\frac{c^n}{K^n + c^n},\n$$\nwhere $K$ is the dissociation constant and $n$ is the Hill coefficient. The occupancy produces a saturating shift in the half-activation voltage,\n$$\nV_{1/2}(c) = V_{1/2,0} + \\Delta V_{\\max}\\,\\theta(c),\n$$\nwith $V_{1/2,0}$ the baseline half-activation and $\\Delta V_{\\max}$ the maximal depolarizing shift at saturating cAMP. This construction is physically plausible and widely used to represent cyclic nucleotide modulation of gating.\n\nWith the above, the voltage and gate differential equations become\n$$\n\\frac{dV}{dt} = -\\frac{1}{C_m}\\Big(g_L\\,(V - E_L) + g_h\\,m\\,(V - E_h)\\Big),\n\\quad\n\\frac{dm}{dt} = \\frac{1}{\\tau_h}\\Big(m_\\infty(V,c(t)) - m\\Big).\n$$\nWe discretize time with a fixed step $\\Delta t$ in $\\mathrm{ms}$ and apply a forward-Euler scheme, which is appropriate for non-stiff dynamics at the chosen step size. The discrete updates are\n$$\nV_{t+\\Delta t} = V_t + \\Delta t\\cdot \\left(-\\frac{g_L\\,(V_t - E_L) + g_h\\,m_t\\,(V_t - E_h)}{C_m}\\right),\n$$\n$$\nm_{t+\\Delta t} = m_t + \\Delta t\\cdot \\frac{m_\\infty(V_t,c(t)) - m_t}{\\tau_h}.\n$$\nWe choose $C_m = 1\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$, $E_L = -65\\,\\mathrm{mV}$, $g_L = 0.1\\,\\mathrm{mS}/\\mathrm{cm}^2$, $E_h = -30\\,\\mathrm{mV}$, $\\tau_h = 150\\,\\mathrm{ms}$, $V_{1/2,0} = -75\\,\\mathrm{mV}$, $\\Delta V_{\\max} = 15\\,\\mathrm{mV}$, $K = 2\\,\\mu\\mathrm{M}$, and $n = 2$. The cAMP step is prescribed as $c(t) = c_{\\mathrm{pre}}$ for $t  t_{\\mathrm{step}}$ and $c(t) = c_{\\mathrm{post}}$ for $t \\ge t_{\\mathrm{step}}$, with $c_{\\mathrm{pre}} = 1\\,\\mu\\mathrm{M}$, $c_{\\mathrm{post}} = 5\\,\\mu\\mathrm{M}$, $t_{\\mathrm{step}} = 2.0\\,\\mathrm{s}$, total duration $T = 8.0\\,\\mathrm{s}$, and step size $\\Delta t = 0.5\\,\\mathrm{ms}$. The initial conditions are $V(0) = E_L$ and $m(0) = m_\\infty(V(0), c_{\\mathrm{pre}})$, ensuring consistency with the pre-step equilibrium.\n\nTo quantify the steady depolarization induced by the cAMP increase, we compute the mean voltage $V_{\\mathrm{pre}}$ over $t \\in [1.5, 2.0]\\,\\mathrm{s}$, which approximates the steady state under $c_{\\mathrm{pre}}$, and the mean voltage $V_{\\mathrm{post}}$ over $t \\in [7.5, 8.0]\\,\\mathrm{s}$, which approximates the steady state under $c_{\\mathrm{post}}$. The difference $\\Delta V = V_{\\mathrm{post}} - V_{\\mathrm{pre}}$ measures the steady depolarization (positive values indicate depolarization).\n\nThe test suite varies the maximal HCN conductance $g_h$ and the slope factor $k$ to probe different regimes:\n- Case A: $g_h = 0.5\\,\\mathrm{mS}/\\mathrm{cm}^2$, $k = 7\\,\\mathrm{mV}$ represents a typical HCN density and sensitivity; increasing cAMP shifts $V_{1/2}$ positively, increasing $m$ at a given $V$, producing more inward current (negative $I_h$ for $V  E_h$) and thus depolarization. We expect $\\Delta V$ to be a positive float in $\\mathrm{mV}$.\n- Case B: $g_h = 0\\,\\mathrm{mS}/\\mathrm{cm}^2$ removes the HCN current, so the leak-only system has a fixed point at $V \\approx E_L$ with no cAMP dependence, leading to $\\Delta V$ near $0$.\n- Case C: $g_h = 1.5\\,\\mathrm{mS}/\\mathrm{cm}^2$ increases HCN influence and should yield a larger positive $\\Delta V$.\n- Case D: $g_h = 0.5\\,\\mathrm{mS}/\\mathrm{cm}^2$ with $k = 20\\,\\mathrm{mV}$ reduces voltage sensitivity, flattening $m_\\infty(V,c)$ and diminishing the effect of a given $V_{1/2}$ shift, so $\\Delta V$ should be positive but smaller than Case A.\n\nAlgorithmic implementation computes $m_\\infty(V,c)$ at each step using\n$$\n\\theta(c) = \\frac{c^n}{K^n + c^n},\\quad V_{1/2}(c) = V_{1/2,0} + \\Delta V_{\\max}\\,\\theta(c),\\quad\nm_\\infty(V,c) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}(c)}{k}\\right)}.\n$$\nUsing the fixed-step integrator with the outward-positive convention preserves unit consistency: with $g$ in $\\mathrm{mS}/\\mathrm{cm}^2$ and voltages in $\\mathrm{mV}$, currents are in $\\mu\\mathrm{A}/\\mathrm{cm}^2$; with $C_m$ in $\\mu\\mathrm{F}/\\mathrm{cm}^2$ and time in $\\mathrm{ms}$, $dV/dt$ is in $\\mathrm{mV}/\\mathrm{ms}$.\n\nFinally, we compute and round each $\\Delta V$ to three decimal places, and produce a single output line in the specified bracketed, comma-separated format. The simulation ensures scientific realism: parameters are physiologically plausible, the cAMP modulation employs a saturating binding curve, and the quantification uses averages over steady windows to avoid transient artifacts.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_deltaV(gh, k,\n                    Cm=1.0,         # microF/cm^2\n                    gL=0.1,         # mS/cm^2\n                    EL=-65.0,       # mV\n                    Eh=-30.0,       # mV\n                    tau_h=150.0,    # ms\n                    Vhalf0=-75.0,   # mV\n                    dVmax=15.0,     # mV\n                    K=2.0,          # uM\n                    n_hill=2,       # unitless\n                    c_pre=1.0,      # uM\n                    c_post=5.0,     # uM\n                    t_step_ms=2000.0,  # ms\n                    T_ms=8000.0,       # ms\n                    dt_ms=0.5):        # ms\n    \"\"\"\n    Simulate HH-style membrane with leak and cAMP-modulated HCN current.\n    Returns steady depolarization DeltaV in mV: V_post_avg - V_pre_avg.\n    \"\"\"\n    # Time vector\n    n_steps = int(np.round(T_ms / dt_ms))\n    times = np.linspace(0.0, T_ms, n_steps + 1)\n\n    # cAMP step function\n    def cAMP(t_ms):\n        return c_pre if t_ms  t_step_ms else c_post\n\n    # Hill binding occupancy\n    def theta(c):\n        return (c**n_hill) / (K**n_hill + c**n_hill)\n\n    # cAMP-dependent half-activation\n    def Vhalf(c):\n        return Vhalf0 + dVmax * theta(c)\n\n    # Steady-state activation (Boltzmann)\n    def m_inf(V, c):\n        return 1.0 / (1.0 + np.exp((V - Vhalf(c)) / k))\n\n    # Initialize state\n    V = EL\n    m = m_inf(V, c_pre)\n\n    # Record V for averaging windows\n    V_trace = np.empty_like(times)\n    V_trace[0] = V\n\n    # Integrate with forward Euler\n    for i in range(n_steps):\n        t = times[i]\n        c = cAMP(t)\n        # Currents: outward positive\n        I_leak = gL * (V - EL)\n        I_h = gh * m * (V - Eh)\n        I_ion = I_leak + I_h\n\n        # Voltage update (mV/ms)\n        dVdt = -(I_ion) / Cm\n        V = V + dt_ms * dVdt\n\n        # Gate update\n        minf = m_inf(V, c)\n        dm_dt = (minf - m) / tau_h\n        m = m + dt_ms * dm_dt\n\n        V_trace[i + 1] = V\n\n    # Compute windowed means\n    def window_mean(t_start_ms, t_end_ms):\n        idx = np.where((times >= t_start_ms)  (times = t_end_ms))[0]\n        if idx.size == 0:\n            return float('nan')\n        return float(np.mean(V_trace[idx]))\n\n    V_pre = window_mean(1500.0, 2000.0)\n    V_post = window_mean(7500.0, 8000.0)\n    deltaV = V_post - V_pre\n    return deltaV\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (g_h, k) with units as specified.\n    test_cases = [\n        (0.5, 7.0),   # Case A: typical HCN\n        (0.0, 7.0),   # Case B: no HCN (boundary)\n        (1.5, 7.0),   # Case C: strong HCN\n        (0.5, 20.0),  # Case D: reduced voltage sensitivity\n    ]\n\n    results = []\n    for gh, k in test_cases:\n        dv = simulate_deltaV(gh=gh, k=k)\n        # Round to three decimal places as required\n        results.append(round(dv, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5070924"}]}