{"hands_on_practices": [{"introduction": "A fundamental question in neuroscience is how the brain constructs complex feature detectors from simpler inputs. This practice explores the classic Hubel and Wiesel model, demonstrating how the property of orientation selectivity can emerge in a 'simple cell' in the primary visual cortex [@problem_id:5049850]. By linearly combining inputs from spatially arranged ON-center and OFF-center cells, you will derive from first principles how a neuron becomes tuned to respond best to lines of a specific orientation.", "problem": "Consider a minimal linear model for an orientation-selective simple cell in primary visual cortex constructed from three inputs from the Lateral Geniculate Nucleus (LGN). Each LGN input has an isotropic Gaussian receptive field (RF) center of identical width. The three LGN centers lie on the $x$-axis at positions $\\mathbf{r}_{0}=(0,0)$ (an ON-center) and $\\mathbf{r}_{\\pm}=(\\pm a,0)$ (two OFF-centers). Each LGN RF center is modeled as a two-dimensional Gaussian\n$$\ng(\\mathbf{r};\\mathbf{r}_{i})=\\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right),\n$$\nwith peak value $1$ at $\\mathbf{r}=\\mathbf{r}_{i}$ and width parameter $\\sigma>0$. The simple cell forms a linear weighted sum of LGN inputs with weights $w_{0}=+1$ for the ON-center at the origin and $w_{\\pm}=-\\rho$ for each of the two OFF-centers at $\\pm a$, where $\\rho>0$ is to be determined.\n\nAssume the stimulus is an infinitely long, infinitesimally thin bright bar of contrast $s>0$, passing through the origin, oriented at angle $\\theta$ relative to the $y$-axis. Let the bar be represented as a line distribution of intensity $I(\\mathbf{r})=s\\,\\delta(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r})$, where $\\mathbf{n}_{\\theta}$ is a unit normal to the bar and $\\delta(\\cdot)$ is the Dirac delta. Take $\\theta$ in radians. The simple cell’s linear response is the superposition of LGN inputs driven by the stimulus,\n$$\nR(\\theta)=\\sum_{i\\in\\{0,+,-\\}} w_{i}\\int_{\\mathbb{R}^{2}} g(\\mathbf{r};\\mathbf{r}_{i})\\,I(\\mathbf{r})\\,d^{2}\\mathbf{r}.\n$$\n\nStarting from the linear superposition principle and properties of Gaussian functions, derive a closed-form expression for $R(\\theta)$ as a function of $\\theta$, $a$, $\\sigma$, $\\rho$, and $s$. Then impose the condition that the response to the bar orthogonal to the preferred orientation is minimized to zero, specifically $R\\!\\left(\\frac{\\pi}{2}\\right)=0$, and eliminate $\\rho$ using this constraint. Provide the final expression for $R(\\theta)$ (with $\\theta$ in radians) in closed form. No numerical values are required, and you should not assume any special relationship among $a$, $\\sigma$, and $s$ beyond positivity.", "solution": "The problem is to derive the response function $R(\\theta)$ for a model simple cell in the primary visual cortex, subject to a specific constraint. The process involves first principles of linear superposition and integration of Gaussian functions against a delta-function stimulus distribution.\n\n### Step 1: Problem Validation\n\nThe problem statement is first validated for scientific soundness, completeness, and objectivity.\n\n**1. Extraction of Givens:**\n-   **LGN Receptive Fields:** Three isotropic Gaussian receptive fields, $g(\\mathbf{r};\\mathbf{r}_{i})=\\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)$, with identical width parameter $\\sigma>0$.\n-   **LGN Center Positions:**\n    -   ON-center: $\\mathbf{r}_{0}=(0,0)$.\n    -   OFF-centers: $\\mathbf{r}_{\\pm}=(\\pm a,0)$, with $a>0$.\n-   **Synaptic Weights:**\n    -   ON-center: $w_{0}=+1$.\n    -   OFF-centers: $w_{\\pm}=-\\rho$, with $\\rho>0$.\n-   **Stimulus:** An infinitely long, infinitesimally thin bright bar of contrast $s>0$, passing through the origin. It is oriented at an angle $\\theta$ (in radians) with respect to the $y$-axis. Its intensity distribution is $I(\\mathbf{r})=s\\,\\delta(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r})$, where $\\mathbf{n}_{\\theta}$ is a unit vector normal to the bar.\n-   **Simple Cell Response:** The linear response is given by the superposition $R(\\theta)=\\sum_{i\\in\\{0,+,-\\}} w_{i}\\int_{\\mathbb{R}^{2}} g(\\mathbf{r};\\mathbf{r}_{i})\\,I(\\mathbf{r})\\,d^{2}\\mathbf{r}$.\n-   **Constraint:** The response to a bar orthogonal to the preferred orientation is zero. Based on the cell's geometry (ON-center at the origin flanked by OFF-centers on the $x$-axis), the preferred orientation is a vertical bar ($\\theta=0$). The orthogonal orientation is a horizontal bar ($\\theta=\\frac{\\pi}{2}$). Thus, the constraint is $R(\\frac{\\pi}{2})=0$.\n\n**2. Validation:**\n-   **Scientific Grounding:** The problem describes a classic linear model of a simple cell receptive field, originating from the work of Hubel and Wiesel. This is a cornerstone of theoretical and computational neuroscience. The use of Gaussian functions and linear superposition is standard practice. The stimulus is a standard probe in visual neuroscience. The model is scientifically grounded and realistic as a first-order approximation.\n-   **Well-Posedness:** The problem is well-posed. It provides all necessary definitions, constants, and functions. The goal is clearly stated and the constraint is specific, leading to a unique solution.\n-   **Objectivity:** The problem is formulated in precise mathematical language, free from any subjective or ambiguous terms.\n\n**3. Verdict:**\nThe problem is valid. We proceed to the solution.\n\n### Step 2: Derivation of the Response Function $R(\\theta)$\n\nThe total response $R(\\theta)$ is a weighted sum of the responses of the three LGN inputs. Let's first calculate the response of a single generic LGN cell with its RF centered at $\\mathbf{r}_{i}$, which we denote as $R_i(\\theta)$.\n\n$R_i(\\theta) = \\int_{\\mathbb{R}^{2}} g(\\mathbf{r};\\mathbf{r}_{i})\\,I(\\mathbf{r})\\,d^{2}\\mathbf{r} = \\int_{\\mathbb{R}^{2}} \\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right) s\\,\\delta(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r})\\,d^{2}\\mathbf{r}$\n\nThe bar is oriented at an angle $\\theta$ with respect to the $y$-axis. Its direction is given by the unit vector $\\mathbf{d}_{\\theta} = (\\sin\\theta, \\cos\\theta)$. The unit vector normal to the bar is $\\mathbf{n}_{\\theta} = (\\cos\\theta, -\\sin\\theta)$. The stimulus $\\delta(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r})$ confines the integration to the line $\\mathbf{n}_{\\theta}\\cdot\\mathbf{r} = 0$, which is the line passing through the origin with direction $\\mathbf{d}_{\\theta}$.\n\nTo solve the integral, we perform a change of coordinates. Let $(u, v)$ be a new coordinate system rotated by $\\theta$ such that $u = \\mathbf{n}_{\\theta}\\cdot\\mathbf{r}$ and $v = \\mathbf{d}_{\\theta}\\cdot\\mathbf{r}$. A point on the integration line is parameterized by $v$ as $\\mathbf{r}(v) = v\\mathbf{d}_{\\theta}$. The integral is effectively a line integral of the Gaussian along this line. The general result for the integral of a 2D Gaussian over a line is well-known. The integral of $g(\\mathbf{r};\\mathbf{r}_{i})$ over the line $\\mathbf{n}_{\\theta}\\cdot\\mathbf{r} = 0$ is:\n$$ \\int_{\\mathbb{R}^{2}} \\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right) \\delta(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r})\\,d^{2}\\mathbf{r} = \\sqrt{2\\pi}\\sigma \\exp\\left(-\\frac{(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r}_{i})^2}{2\\sigma^2}\\right) $$\nThis result can be derived by completing the square in the exponent of the Gaussian after parameterizing the line.\n\nMultiplying by the stimulus contrast $s$, the response of a single cell is:\n$R_i(\\theta) = s\\sqrt{2\\pi}\\sigma \\exp\\left(-\\frac{(\\mathbf{n}_{\\theta}\\cdot\\mathbf{r}_{i})^2}{2\\sigma^2}\\right)$.\n\nLet's apply this to our three specific LGN cells. The normal vector is $\\mathbf{n}_{\\theta} = (\\cos\\theta, -\\sin\\theta)$. Let $C = s\\sqrt{2\\pi}\\sigma$ be a constant factor.\n\n-   **ON-center cell at $\\mathbf{r}_0 = (0,0)$:**\n    The dot product is $\\mathbf{n}_{\\theta}\\cdot\\mathbf{r}_{0} = (\\cos\\theta, -\\sin\\theta)\\cdot(0,0) = 0$.\n    The response is $R_0(\\theta) = C \\exp(0) = C$.\n\n-   **OFF-center cell at $\\mathbf{r}_+ = (a,0)$:**\n    The dot product is $\\mathbf{n}_{\\theta}\\cdot\\mathbf{r}_{+} = (\\cos\\theta, -\\sin\\theta)\\cdot(a,0) = a\\cos\\theta$.\n    The response is $R_+(\\theta) = C \\exp\\left(-\\frac{(a\\cos\\theta)^2}{2\\sigma^2}\\right) = C \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)$.\n\n-   **OFF-center cell at $\\mathbf{r}_- = (-a,0)$:**\n    The dot product is $\\mathbf{n}_{\\theta}\\cdot\\mathbf{r}_{-} = (\\cos\\theta, -\\sin\\theta)\\cdot(-a,0) = -a\\cos\\theta$.\n    The response is $R_-(\\theta) = C \\exp\\left(-\\frac{(-a\\cos\\theta)^2}{2\\sigma^2}\\right) = C \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)$. Note that $R_+(\\theta) = R_-(\\theta)$.\n\nThe total response $R(\\theta)$ is the weighted sum:\n$R(\\theta) = w_0 R_0(\\theta) + w_+ R_+(\\theta) + w_- R_-(\\theta)$\nSubstituting the weights $w_0=1$ and $w_{\\pm}=-\\rho$:\n$R(\\theta) = (1) C + (-\\rho) C \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right) + (-\\rho) C \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)$\n$R(\\theta) = C \\left[1 - 2\\rho \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)\\right]$\n\nSubstituting back $C = s\\sqrt{2\\pi}\\sigma$:\n$$ R(\\theta) = s\\sqrt{2\\pi}\\sigma \\left[1 - 2\\rho \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)\\right] $$\nThis is the general expression for the simple cell's response.\n\n### Step 3: Application of the Constraint\n\nWe are given the constraint that the response to a bar orthogonal to the preferred orientation is zero. The preferred orientation for this receptive field geometry is vertical ($\\theta=0$), so the orthogonal orientation is horizontal, corresponding to $\\theta = \\frac{\\pi}{2}$. We must enforce $R(\\frac{\\pi}{2})=0$.\n\nLet's evaluate $R(\\theta)$ at $\\theta = \\frac{\\pi}{2}$. For this angle, $\\cos(\\frac{\\pi}{2}) = 0$.\n$R(\\frac{\\pi}{2}) = s\\sqrt{2\\pi}\\sigma \\left[1 - 2\\rho \\exp\\left(-\\frac{a^2\\cos^2(\\pi/2)}{2\\sigma^2}\\right)\\right]$\n$R(\\frac{\\pi}{2}) = s\\sqrt{2\\pi}\\sigma \\left[1 - 2\\rho \\exp(0)\\right]$\n$R(\\frac{\\pi}{2}) = s\\sqrt{2\\pi}\\sigma (1 - 2\\rho)$\n\nSetting this to zero:\n$s\\sqrt{2\\pi}\\sigma (1 - 2\\rho) = 0$\nSince $s>0$ and $\\sigma>0$, the pre-factor $s\\sqrt{2\\pi}\\sigma$ is non-zero. Therefore, the term in the parenthesis must be zero:\n$1 - 2\\rho = 0 \\implies \\rho = \\frac{1}{2}$.\n\n### Step 4: Final Expression for $R(\\theta)$\n\nNow we substitute the constrained value $\\rho = \\frac{1}{2}$ back into the general expression for $R(\\theta)$:\n$R(\\theta) = s\\sqrt{2\\pi}\\sigma \\left[1 - 2\\left(\\frac{1}{2}\\right) \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)\\right]$\n$R(\\theta) = s\\sqrt{2\\pi}\\sigma \\left[1 - \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)\\right]$\n\nThis is the final closed-form expression for the simple cell's response as a function of the bar's orientation $\\theta$, after imposing the normalization constraint. The term $\\sqrt{2\\pi}$ can be written as $(2\\pi)^{1/2}$.\n\nFinal expression:\n$R(\\theta) = s\\sigma\\sqrt{2\\pi}\\left(1 - \\exp\\left(-\\frac{a^2\\cos^2\\theta}{2\\sigma^2}\\right)\\right)$", "answer": "$$\n\\boxed{s\\sigma\\sqrt{2\\pi}\\left(1 - \\exp\\left(-\\frac{a^{2}\\cos^{2}(\\theta)}{2\\sigma^{2}}\\right)\\right)}\n$$", "id": "5049850"}, {"introduction": "Once a neuron shows a preference for a certain stimulus, we need precise tools to quantify its tuning and distinguish related properties. This exercise delves into the important distinction between orientation selectivity (preference for an axis of motion) and direction selectivity (preference for a vector of motion) [@problem_id:5049871]. By analyzing hypothetical neural response data, you will develop a geometric intuition for how these properties are dissociated using vector summation, including the critical angle-doubling transformation ($2\\theta$) used to analyze orientation.", "problem": "You record responses of a single visual cortical neuron to drifting gratings at $8$ evenly spaced motion directions $\\theta \\in \\{0^\\circ, 45^\\circ, 90^\\circ, 135^\\circ, 180^\\circ, 225^\\circ, 270^\\circ, 315^\\circ\\}$. You will assess tuning using Orientation Selectivity Index (OSI) and Direction Selectivity Index (DSI). By standard usage in visual neuroscience, DSI reflects vector addition in direction space (angles modulo $2\\pi$), whereas OSI reflects vector addition in orientation space, where opposite directions $\\theta$ and $\\theta+\\pi$ are identified by mapping $\\theta \\mapsto 2\\theta$ on the unit circle before vector averaging. Assume responses are steady-state mean firing rates in spikes per second and are nonnegative.\n\nSelect the option that provides:\n- A concrete dataset (Case $1$) in which OSI is high but DSI is low; and\n- A concrete dataset (Case $2$) in which DSI is high but OSI is moderate;\nand also includes a correct geometric explanation in terms of the unit circle representation and the $2\\theta$ angle-doubling for orientation.\n\nOptions list the $8$ responses as $R(\\theta)$ at each $\\theta$, followed by a brief explanation.\n\nA. \n- Case $1$ data: $R(0^\\circ)=20$, $R(45^\\circ)=2$, $R(90^\\circ)=1$, $R(135^\\circ)=1$, $R(180^\\circ)=20$, $R(225^\\circ)=2$, $R(270^\\circ)=1$, $R(315^\\circ)=1$. Explanation: Opposite-direction pairs are nearly equal, so in direction space the vectors at $\\theta$ and $\\theta+\\pi$ cancel, giving low DSI; after $2\\theta$ wrapping, those same opposite-direction pairs align to the same orientation angle and add, yielding a large resultant and high OSI.\n- Case $2$ data: $R(0^\\circ)=3$, $R(45^\\circ)=10$, $R(90^\\circ)=20$, $R(135^\\circ)=10$, $R(180^\\circ)=3$, $R(225^\\circ)=2$, $R(270^\\circ)=1$, $R(315^\\circ)=2$. Explanation: The distribution is strongly skewed toward a single direction (near $90^\\circ$), producing a large resultant in direction space (high DSI). In orientation space, substantial responses also exist at the orthogonal orientation (near $0^\\circ/180^\\circ$), which map via $2\\theta$ to a vector that partially cancels the $90^\\circ/270^\\circ$ contribution, so OSI is moderate.\n\nB. \n- Case $1$ data: $R(0^\\circ)=0$, $R(45^\\circ)=0$, $R(90^\\circ)=20$, $R(135^\\circ)=0$, $R(180^\\circ)=0$, $R(225^\\circ)=0$, $R(270^\\circ)=0$, $R(315^\\circ)=0$. Explanation: Single strong direction means opposite directions cancel in $2\\theta$ space, so OSI is high while DSI is low.\n- Case $2$ data: $R(0^\\circ)=20$, $R(45^\\circ)=0$, $R(90^\\circ)=0$, $R(135^\\circ)=0$, $R(180^\\circ)=20$, $R(225^\\circ)=0$, $R(270^\\circ)=0$, $R(315^\\circ)=0$. Explanation: Two opposite directions reinforce in direction space to give high DSI, but because they are opposite, OSI is only moderate.\n\nC. \n- Case $1$ data: $R(0^\\circ)=10$, $R(45^\\circ)=0$, $R(90^\\circ)=10$, $R(135^\\circ)=0$, $R(180^\\circ)=10$, $R(225^\\circ)=0$, $R(270^\\circ)=10$, $R(315^\\circ)=0$. Explanation: Four-cardinal responses cancel in direction space (low DSI) but reinforce in $2\\theta$ space (high OSI).\n- Case $2$ data: $R(0^\\circ)=0$, $R(45^\\circ)=5$, $R(90^\\circ)=20$, $R(135^\\circ)=5$, $R(180^\\circ)=0$, $R(225^\\circ)=0$, $R(270^\\circ)=10$, $R(315^\\circ)=0$. Explanation: The net is strongly directional (high DSI) while $2\\theta$ wrapping yields only moderate OSI due to partial cancellation.\n\nD. \n- Case $1$ data: $R(0^\\circ)=1$, $R(45^\\circ)=1$, $R(90^\\circ)=15$, $R(135^\\circ)=1$, $R(180^\\circ)=1$, $R(225^\\circ)=1$, $R(270^\\circ)=15$, $R(315^\\circ)=1$. Explanation: Equal responses at $\\theta$ and $\\theta+\\pi$ cancel in direction space (low DSI), and in $2\\theta$ space they point to opposite angles and therefore also cancel, so OSI is high.\n- Case $2$ data: $R(0^\\circ)=12$, $R(45^\\circ)=0$, $R(90^\\circ)=15$, $R(135^\\circ)=0$, $R(180^\\circ)=12$, $R(225^\\circ)=0$, $R(270^\\circ)=0$, $R(315^\\circ)=0$. Explanation: The single dominant direction makes DSI high, and because there is also substantial power at the orthogonal orientation, OSI is only moderate.", "solution": "### Step 1: Extract Givens\n- A single visual cortical neuron's responses are recorded for drifting gratings at $8$ evenly spaced motion directions: $\\theta \\in \\{0^\\circ, 45^\\circ, 90^\\circ, 135^\\circ, 180^\\circ, 225^\\circ, 270^\\circ, 315^\\circ\\}$.\n- Responses, denoted $R(\\theta)$, are non-negative steady-state mean firing rates.\n- Direction Selectivity Index (DSI) is calculated using vector addition in direction space, where angles are modulo $2\\pi$ (or $360^\\circ$).\n- Orientation Selectivity Index (OSI) is calculated using vector addition in orientation space, which is achieved by a transformation $\\theta \\mapsto 2\\theta$ before vector averaging. This identifies opposite directions $\\theta$ and $\\theta+\\pi$ as the same orientation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n\n- **Scientifically Grounded:** The problem is firmly based on standard, well-established methods for quantifying tuning properties of neurons in visual cortex. The concepts of Direction Selectivity Index (DSI) and Orientation Selectivity Index (OSI), and their calculation via vector averaging, are canonical in sensory neuroscience. The angle-doubling trick ($\\theta \\mapsto 2\\theta$) is the standard mathematical method for handling orientation, which is an axial quantity (periodicity of $\\pi$ or $180^\\circ$) rather than a directional one (periodicity of $2\\pi$ or $360^\\circ$). The problem is scientifically sound.\n- **Well-Posed:** The problem provides clear definitions for DSI and OSI and asks to identify a correct example among a set of options. Given the definitions, the properties of the example datasets can be unambiguously calculated and evaluated. A unique solution exists.\n- **Objective:** The problem is phrased in precise, objective language. The definitions and data are quantitative. There are no subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a standard, well-posed problem in computational neuroscience. I will proceed with the solution.\n\n### Derivation of Solution\nThe Direction Selectivity Index (DSI) and Orientation Selectivity Index (OSI) are formally defined as the normalized length of a resultant vector. Let the responses to the $N=8$ directions $\\theta_k$ be $R_k = R(\\theta_k)$.\n\nThe DSI is calculated from the vector sum in direction space:\n$$\n\\text{DSI} = \\frac{\\left| \\sum_{k=1}^{N} R_k e^{i\\theta_k} \\right|}{\\sum_{k=1}^{N} R_k}\n$$\nwhere angles $\\theta_k$ are in radians. A DSI near $1$ indicates a strong preference for a single direction of motion. A DSI near $0$ indicates that responses are balanced across directions (e.g., symmetric).\n\nThe OSI is calculated from the vector sum after mapping directions to orientation space via angle doubling:\n$$\n\\text{OSI} = \\frac{\\left| \\sum_{k=1}^{N} R_k e^{i2\\theta_k} \\right|}{\\sum_{k=1}^{N} R_k}\n$$\nThe angle doubling maps two opposite directions, $\\theta$ and $\\theta+\\pi$, to the same angle in the new space: $2\\theta$ and $2(\\theta+\\pi)=2\\theta+2\\pi$, which are equivalent. This causes responses to opposite directions to sum constructively. An OSI near $1$ indicates a strong preference for a single axis of motion (orientation). An OSI near $0$ indicates responses are balanced across orientations.\n\nWe are looking for an option with:\n- **Case 1:** High OSI (close to $1$), Low DSI (close to $0$). This typically occurs when a neuron responds strongly and symmetrically to opposite directions of motion, i.e., $R(\\theta) \\approx R(\\theta+\\pi)$. The vectors in direction space, $R(\\theta)e^{i\\theta}$ and $R(\\theta+\\pi)e^{i(\\theta+\\pi)} = -R(\\theta+\\pi)e^{i\\theta}$, will approximately cancel. In orientation space, the vectors $R(\\theta)e^{i2\\theta}$ and $R(\\theta+\\pi)e^{i2(\\theta+\\pi)} = R(\\theta+\\pi)e^{i2\\theta}$ will add constructively.\n- **Case 2:** High DSI (close to $1$), Moderate OSI. High DSI occurs when responses are dominated by a single preferred direction. To have only moderate OSI, there must be responses at other orientations that partially cancel the vector contribution from the preferred orientation in the $2\\theta$ space.\n\n### Option-by-Option Analysis\n\n**A. Evaluation**\n- **Case 1 data:** $R(0^\\circ)=20$, $R(45^\\circ)=2$, $R(90^\\circ)=1$, $R(135^\\circ)=1$, $R(180^\\circ)=20$, $R(225^\\circ)=2$, $R(270^\\circ)=1$, $R(315^\\circ)=1$.\n  - Total response $\\sum R_k = 2(20+2+1+1) = 48$.\n  - DSI: The responses are perfectly symmetric, $R(\\theta) = R(\\theta+180^\\circ)$. Each pair of opposite direction vectors cancels: $R(\\theta)e^{i\\theta} + R(\\theta+180^\\circ)e^{i(\\theta+180^\\circ)} = (R(\\theta) - R(\\theta+180^\\circ))e^{i\\theta} = 0$. The resultant vector is $\\vec{0}$. Thus, $\\text{DSI} = 0$. This is low.\n  - OSI: In $2\\theta$ space, opposite directions sum. The resultant vector is $\\vec{V}_{Ori} = \\sum R_k e^{i2\\theta_k}$. Grouping opposite directions:\n    - $0^\\circ/180^\\circ \\to 2\\theta=0^\\circ$: Contribution is $(R(0^\\circ)+R(180^\\circ))e^{i0} = 40$.\n    - $45^\\circ/225^\\circ \\to 2\\theta=90^\\circ$: Contribution is $(R(45^\\circ)+R(225^\\circ))e^{i\\pi/2} = 4i$.\n    - $90^\\circ/270^\\circ \\to 2\\theta=180^\\circ$: Contribution is $(R(90^\\circ)+R(270^\\circ))e^{i\\pi} = -2$.\n    - $135^\\circ/315^\\circ \\to 2\\theta=270^\\circ$: Contribution is $(R(135^\\circ)+R(315^\\circ))e^{i3\\pi/2} = -2i$.\n    - $\\vec{V}_{Ori} = 40 + 4i - 2 - 2i = 38 + 2i$.\n    - $|\\vec{V}_{Ori}| = \\sqrt{38^2 + 2^2} = \\sqrt{1444+4} = \\sqrt{1448} \\approx 38.05$.\n    - $\\text{OSI} = \\sqrt{1448}/48 \\approx 0.793$. This is high.\n  - Case 1 fits the criteria. The explanation is also correct: opposite direction vectors cancel for DSI, but sum constructively for OSI.\n\n- **Case 2 data:** $R(0^\\circ)=3, R(45^\\circ)=10, R(90^\\circ)=20, R(135^\\circ)=10, R(180^\\circ)=3, R(225^\\circ)=2, R(270^\\circ)=1, R(315^\\circ)=2$.\n  - Total response $\\sum R_k = 3+10+20+10+3+2+1+2 = 51$.\n  - DSI: The responses are concentrated around $90^\\circ$. The resultant vector is $\\vec{V}_{Dir} = \\sum R_k e^{i\\theta_k}$. The real part is $0$ due to symmetry around the vertical axis. The imaginary part is $Im(\\vec{V}_{Dir}) = 10\\sin(45^\\circ)+20\\sin(90^\\circ)+10\\sin(135^\\circ)+2\\sin(225^\\circ)+1\\sin(270^\\circ)+2\\sin(315^\\circ) = 5\\sqrt{2}+20+5\\sqrt{2}-\\sqrt{2}-1-\\sqrt{2} = 19+8\\sqrt{2} \\approx 30.31$.\n  - $\\text{DSI} = (19+8\\sqrt{2})/51 \\approx 0.594$. This is a high DSI.\n  - OSI: Grouping by orientation axis in $2\\theta$ space:\n    - Horizontal ($0^\\circ/180^\\circ$) maps to $2\\theta=0^\\circ$: Contribution $(R(0^\\circ)+R(180^\\circ))e^{i0} = 6$.\n    - Vertical ($90^\\circ/270^\\circ$) maps to $2\\theta=180^\\circ$: Contribution $(R(90^\\circ)+R(270^\\circ))e^{i\\pi} = -21$.\n    - Diagonal ($45^\\circ/225^\\circ$) maps to $2\\theta=90^\\circ$: Contribution $(R(45^\\circ)+R(225^\\circ))e^{i\\pi/2} = 12i$.\n    - Anti-diagonal ($135^\\circ/315^\\circ$) maps to $2\\theta=270^\\circ$: Contribution $(R(135^\\circ)+R(315^\\circ))e^{i3\\pi/2} = -12i$.\n    - $\\vec{V}_{Ori} = 6 - 21 + 12i - 12i = -15$.\n    - $|\\vec{V}_{Ori}| = 15$.\n    - $\\text{OSI} = 15/51 \\approx 0.294$. This value is moderate (or low-to-moderate), and significantly lower than the DSI.\n  - Case 2 fits the criteria. The explanation is also correct: high DSI is due to responses peaking in one direction. Moderate OSI is due to partial cancellation in $2\\theta$ space between the vector for the preferred vertical orientation (magnitude $21$) and the vector for the orthogonal horizontal orientation (magnitude $6$).\n\n**Verdict:** Correct.\n\n**B. Evaluation**\n- **Case 1 data:** $R(90^\\circ)=20$, others $0$. This is a perfectly directional cell.\n  - DSI = $|20e^{i\\pi/2}|/20 = 1$ (high). The problem requires low DSI.\n  - OSI = $|20e^{i\\pi}|/20 = 1$ (high).\n- **Case 2 data:** $R(0^\\circ)=20, R(180^\\circ)=20$, others $0$. This is a perfectly orientation-selective, non-directional cell.\n  - DSI = $|20e^{i0} + 20e^{i\\pi}|/40 = |20-20|/40 = 0$ (low). The problem requires high DSI.\n- The data in both cases fail to meet the requirements. The explanations are also incorrect. For instance, in Case 2, it claims two opposite directions \"reinforce in direction space\", which is false; they cancel.\n\n**Verdict:** Incorrect.\n\n**C. Evaluation**\n- **Case 1 data:** $R(0^\\circ)=R(90^\\circ)=R(180^\\circ)=R(270^\\circ)=10$, others $0$.\n  - DSI: By symmetry, the vector sum is $\\vec{V}_{Dir} = 10(1) + 10(i) + 10(-1) + 10(-i) = 0$. DSI is $0$ (low).\n  - OSI: In $2\\theta$ space, $0^\\circ$ and $180^\\circ$ map to $0^\\circ$. $90^\\circ$ and $270^\\circ$ map to $180^\\circ$. The resultant vector is $\\vec{V}_{Ori} = (R(0^\\circ)+R(180^\\circ))e^{i0} + (R(90^\\circ)+R(270^\\circ))e^{i\\pi} = 20(1) + 20(-1) = 0$. OSI is $0$ (low). The problem requires high OSI.\n  - The data fails the requirement. The explanation incorrectly claims reinforcement in $2\\theta$ space.\n\n- **Case 2 data:** Non-zero responses are $R(45^\\circ)=5, R(90^\\circ)=20, R(135^\\circ)=5, R(270^\\circ)=10$.\n  - $\\sum R_k = 40$.\n  - DSI: By symmetry around the $y$-axis, $Re(\\vec{V}_{Dir})=0$. $Im(\\vec{V}_{Dir}) = 5\\sin(45^\\circ)+20\\sin(90^\\circ)+5\\sin(135^\\circ)+10\\sin(270^\\circ) = 5\\frac{\\sqrt{2}}{2}+20+5\\frac{\\sqrt{2}}{2}-10 = 10+5\\sqrt{2} \\approx 17.07$. DSI $\\approx 17.07/40 \\approx 0.427$ (moderate, not decisively high).\n  - OSI: $\\vec{V}_{Ori} = 5e^{i\\pi/2} + 20e^{i\\pi} + 5e^{i3\\pi/2} + 10e^{i\\pi} = 5i-20-5i-10=-30$. $|\\vec{V}_{Ori}|=30$. OSI is $30/40 = 0.75$ (high). The problem requires moderate OSI.\n\n**Verdict:** Incorrect.\n\n**D. Evaluation**\n- **Case 1 data:** $R(90^\\circ)=15, R(270^\\circ)=15$, others $1$.\n  - DSI: This is a symmetric response profile. The large responses at $90^\\circ$ and $270^\\circ$ cancel. The small uniform responses at the other 6 directions also form canceling pairs. DSI is $0$ (low).\n  - OSI: The large responses sum constructively in $2\\theta$ space, contributing $(15+15)e^{i\\pi}=-30$. The small responses also contribute. This will result in a large vector sum, hence high OSI.\n  - The data matches the requirement. However, the explanation states that in $2\\theta$ space, opposite directions \"point to opposite angles and therefore also cancel, so OSI is high.\" This is internally contradictory and factually wrong. In $2\\theta$ space, opposite directions map to the *same* angle and *add*. If they canceled, OSI would be low.\n- **Case 2 data:** $R(0^\\circ)=12, R(90^\\circ)=15, R(180^\\circ)=12$, others $0$.\n  - $\\sum R_k = 39$.\n  - DSI: $\\vec{V}_{Dir} = 12e^{i0}+15e^{i\\pi/2}+12e^{i\\pi} = 12+15i-12 = 15i$. $|\\vec{V}_{Dir}|=15$. DSI is $15/39 \\approx 0.385$ (moderate at best, not high).\n  - OSI: $\\vec{V}_{Ori} = 12e^{i0}+15e^{i\\pi}+12e^{i2\\pi} = 12-15+12=9$. $|\\vec{V}_{Ori}|=9$. OSI is $9/39 \\approx 0.23$ (low). The problem requires moderate OSI.\n\n**Verdict:** Incorrect.\n\nBased on the detailed analysis, only option A provides correct datasets for both cases and correct corresponding explanations.", "answer": "$$\\boxed{A}$$", "id": "5049871"}, {"introduction": "Visual cortical neurons are not all alike; they can be categorized based on the complexity of their receptive fields. This hands-on computational practice tackles the classic distinction between 'simple' and 'complex' cells by analyzing their response to the phase of a drifting grating [@problem_id:5049870]. You will implement an algorithm to fit competing models—a phase-sensitive Rectified Linear-Nonlinear (LN) model and a phase-invariant Energy Model—to simulated neural data, learning how quantitative analysis is used to classify neurons and infer underlying mechanisms.", "problem": "Consider a neuron in the primary visual cortex driven by a drifting sinusoidal grating at a fixed preferred orientation. The stimulus temporal phase is denoted by $\\phi$, measured in radians. A core observation in neurobiology is that simple cells exhibit responses that are approximately linear with respect to the grating phase and thus show strong phase modulation, whereas complex cells exhibit phase-invariant responses that can be modeled by an energy computation using a quadrature pair of linear filters. You must implement an algorithmic decision procedure that, given arrays of membrane potential tuning and spike tuning as functions of phase, fits two competing models and then classifies the neuron as behaving like a simple cell or a complex cell by comparing phase modulation depth.\n\nFundamental base and model definitions:\n1. Linear filtering of periodic stimuli implies that the subthreshold membrane potential response $V(\\phi)$ to a drifting sinusoidal grating can be approximated by a first harmonic expansion $V(\\phi) \\approx M_V + A_V \\cos(\\phi - \\phi_V)$, where $M_V$ is the mean (the zero-frequency component), $A_V$ is the first harmonic amplitude, and $\\phi_V$ is the phase offset.\n2. The Rectified Linear–Nonlinear (LN) model, where Linear–Nonlinear (LN) denotes linear filtering followed by a static nonlinearity, approximates the spike response as $r_{\\mathrm{LN}}(\\phi) = \\alpha \\max\\{0, \\cos(\\phi - \\phi_0)\\} + \\beta$, where $\\alpha \\ge 0$ is a gain parameter, $\\beta \\ge 0$ is a baseline, and $\\phi_0$ is a phase offset. This captures phase-dependent rectification characteristic of simple cells.\n3. The Energy Model for complex cells, using a quadrature pair of linear filters, approximates the spike response as $r_{\\mathrm{EM}}(\\phi) = \\gamma \\left[\\cos^2(\\phi - \\phi_0) + \\sin^2(\\phi - \\phi_0)\\right] + \\delta = \\gamma + \\delta$, which is independent of phase due to the trigonometric identity $\\cos^2(\\psi) + \\sin^2(\\psi) = 1$ for any $\\psi$. This captures phase invariance characteristic of complex cells.\n4. The phase modulation depth is quantified by the ratio of the amplitude of the first harmonic to the mean response, namely $R = F1/F0$, where $F0$ is the mean response and $F1$ is the amplitude of the first harmonic computed from the discrete Fourier transform of the spike tuning curve sampled uniformly across phase. For $n$ equally spaced samples $\\{\\phi_i\\}_{i=0}^{n-1}$ over $[0, 2\\pi)$ with corresponding spike responses $\\{r_i\\}_{i=0}^{n-1}$, the first harmonic amplitude is $F1 = \\left|\\frac{2}{n} \\sum_{i=0}^{n-1} r_i e^{-j \\phi_i}\\right|$ and the mean is $F0 = \\frac{1}{n} \\sum_{i=0}^{n-1} r_i$, where $j$ is the imaginary unit.\n\nTask:\nGiven membrane potential samples $\\{V(\\phi_i)\\}$ and spike rate samples $\\{r(\\phi_i)\\}$ at $n$ uniformly spaced phases $\\phi_i$, perform the following steps for each test case:\n1. Estimate the phase offset $\\phi_V$ of the membrane potential by computing the argument of its first harmonic, namely $\\phi_V = \\arg\\left( \\sum_{i=0}^{n-1} V(\\phi_i) e^{-j \\phi_i} \\right)$.\n2. Fit the Rectified LN model $r_{\\mathrm{LN}}(\\phi) = \\alpha \\max\\{0, \\cos(\\phi - \\phi_0)\\} + \\beta$ to the spike rates by minimizing the mean squared error over $\\alpha$, $\\beta$, and $\\phi_0$. You may search $\\phi_0$ over $[0, 2\\pi)$; for each candidate $\\phi_0$, estimate $\\alpha$ and $\\beta$ by least squares on the design matrix with columns $\\max\\{0, \\cos(\\phi_i - \\phi_0)\\}$ and $1$.\n3. Fit the Energy Model $r_{\\mathrm{EM}}(\\phi) = \\gamma + \\delta$ to the spike rates by minimizing mean squared error. This reduces to fitting a constant equal to the mean spike rate.\n4. Compute $R_{\\mathrm{LN}}$ and $R_{\\mathrm{EM}}$ for the spike rates predicted by the fitted models using the discrete Fourier formulas above.\n5. Decide simple versus complex behavior using the following rule: if the Rectified LN model yields a lower mean squared error than the Energy Model and its phase modulation depth satisfies $R_{\\mathrm{LN}} \\ge 0.5$, classify as simple; otherwise, classify as complex. Encode the classification as a boolean, with `True` meaning simple and `False` meaning complex.\n\nAngle unit requirement:\nAll phases $\\phi$ must be treated in radians.\n\nTest suite:\nUse $n = 16$ uniformly spaced phases $\\phi_i = \\frac{2\\pi i}{n}$ for $i \\in \\{0,1,\\dots,15\\}$. For each case below, construct the membrane potential and spike arrays using the specified parameters:\n- Case $1$ (strong phase modulation, expected to be simple): membrane potential parameters $M_V = 1.0$, $A_V = 2.5$, $\\phi_V = \\frac{\\pi}{6}$; spike parameters $\\beta = 5.0$, $\\alpha = 10.0$; i.e., $V(\\phi) = M_V + A_V \\cos(\\phi - \\phi_V)$ and $r(\\phi) = \\beta + \\alpha \\max\\{0, \\cos(\\phi - \\phi_V)\\}$.\n- Case $2$ (phase-invariant spikes, expected to be complex): membrane potential parameters $M_V = 1.0$, $A_V = 0.2$, $\\phi_V = \\frac{\\pi}{3}$; spike parameters $\\beta = 8.0$, $\\alpha = 0.0$; i.e., $V(\\phi) = M_V + A_V \\cos(\\phi - \\phi_V)$ and $r(\\phi) = \\beta + \\alpha \\max\\{0, \\cos(\\phi - \\phi_V)\\}$ which yields a constant spike rate.\n- Case $3$ (moderate phase modulation, borderline): membrane potential parameters $M_V = 1.0$, $A_V = 1.2$, $\\phi_V = \\frac{\\pi}{8}$; spike parameters $\\beta = 7.0$, $\\alpha = 2.0$; i.e., $V(\\phi) = M_V + A_V \\cos(\\phi - \\phi_V)$ and $r(\\phi) = \\beta + \\alpha \\max\\{0, \\cos(\\phi - \\phi_V)\\}$.\n\nRequired final output format:\nYour program should produce a single line of output containing the classification results for the three cases as a comma-separated list enclosed in square brackets with Python boolean literals, for example `[True,False,True]`. The actual output must have no spaces and use the booleans corresponding to the three cases, in the order Case $1$, Case $2$, Case $3$, as `[True,False,True]` or similar, depending on the computed classifications.", "solution": "The task is to implement an algorithmic procedure to classify a model neuron from the primary visual cortex as behaving like a simple cell or a complex cell. The classification is based on the neuron's response to a drifting sinusoidal grating stimulus, specifically how its firing rate is modulated by the temporal phase $\\phi$ of the grating. We are given two competing models: a Rectified Linear-Nonlinear (LN) model for simple cells, which exhibit phase-dependent responses, and an Energy Model for complex cells, which exhibit phase-invariant responses. The decision will be made by fitting both models to simulated spike rate data and comparing their goodness-of-fit and the phase modulation depth of the superior model.\n\nThe procedure is executed for three distinct test cases, with data sampled at $n=16$ uniformly spaced phases $\\phi_i = \\frac{2\\pi i}{n}$ for $i \\in \\{0, 1, \\dots, n-1\\}$.\n\nFirst, we generate the stimulus-driven membrane potential data $V(\\phi_i)$ and spike rate data $r(\\phi_i)$ for each case. The membrane potential follows a first harmonic model, $V(\\phi) = M_V + A_V \\cos(\\phi - \\phi_V)$, and the spike rate is generated from a rectified cosine function, $r(\\phi) = \\beta + \\alpha \\max\\{0, \\cos(\\phi - \\phi_V)\\}$, using the parameters specified for each case.\n\nThe classification algorithm proceeds through five main steps:\n\n1.  **Estimation of Membrane Potential Phase ($\\phi_V$)**: The phase offset of the subthreshold membrane potential, $\\phi_V$, is estimated. Although the true $\\phi_V$ is used for data generation, this step simulates the experimental process of estimating it from measured data. The estimation is performed by calculating the argument of the first component of the Discrete Fourier Transform (DFT) of the potential $V(\\phi_i)$. The complex sum $S_V = \\sum_{i=0}^{n-1} V(\\phi_i) e^{-j \\phi_i}$ is computed, where $j$ is the imaginary unit. The estimated phase is then $\\phi_{V, \\text{est}} = \\arg(S_V)$. This computed value serves as a procedural check and is not used in the subsequent spike rate model fitting.\n\n2.  **Fitting the Rectified LN Model**: The Rectified LN model, $r_{\\mathrm{LN}}(\\phi) = \\alpha \\max\\{0, \\cos(\\phi - \\phi_0)\\} + \\beta$, is fitted to the spike rate data $\\{r(\\phi_i)\\}$. This model is non-linear in the phase parameter $\\phi_0$ but linear in the gain $\\alpha$ and baseline $\\beta$. We employ a hybrid optimization strategy. A grid search is performed for the optimal phase $\\phi_0$ over the interval $[0, 2\\pi)$. For each candidate value of $\\phi_0$, the problem reduces to a linear least-squares estimation of $\\alpha$ and $\\beta$. We seek to minimize the Mean Squared Error (MSE), which is equivalent to solving the linear system $r \\approx \\mathbf{A}p$, where $r$ is the vector of spike rates, $p = [\\alpha, \\beta]^T$ is the parameter vector, and $\\mathbf{A}$ is the design matrix with columns given by $X_1 = \\max\\{0, \\cos(\\phi_i - \\phi_0)\\}$ and a vector of ones, $X_2 = \\mathbf{1}$. The least-squares solution is found using standard numerical methods. The constraints $\\alpha \\ge 0$ and $\\beta \\ge 0$ are inherent to the model's biophysical interpretation, but standard least squares provides a valid estimate. After iterating through the grid of $\\phi_0$ values, the set of parameters $(\\alpha^*, \\beta^*, \\phi_0^*)$ that yields the minimum MSE is selected. This minimum error is denoted $\\mathrm{MSE}_{\\mathrm{LN}}$, and the spike rates predicted by this best-fit model are denoted $\\{r_{\\mathrm{LN}}^*(\\phi_i)\\}$.\n\n3.  **Fitting the Energy Model**: The Energy Model predicts a phase-invariant response, which simplifies to a constant firing rate: $r_{\\mathrm{EM}}(\\phi) = \\gamma + \\delta = C$. To fit this model, we find the constant $C$ that minimizes the MSE with respect to the data $\\{r(\\phi_i)\\}$. The optimal value is the mean of the data, $C^* = \\bar{r} = \\frac{1}{n} \\sum_{i=0}^{n-1} r_i$. The predictions of this model are simply $\\{r_{\\mathrm{EM}}^*(\\phi_i) = \\bar{r}\\}$. The corresponding MSE, denoted $\\mathrm{MSE}_{\\mathrm{EM}}$, is the variance of the spike rate data.\n\n4.  **Computation of Phase Modulation Depth ($R$)**: The phase modulation depth is quantified by the ratio $R = F1/F0$, which compares the amplitude of the first harmonic of the response to its mean. The mean, $F0$, is the zeroth Fourier component: $F0 = \\frac{1}{n} \\sum_{i=0}^{n-1} r_i$. The first harmonic amplitude, $F1$, is given by the magnitude of the first Fourier component, scaled by two: $F1 = \\left|\\frac{2}{n} \\sum_{i=0}^{n-1} r_i e^{-j \\phi_i}\\right|$. This metric is calculated for the spike rates predicted by each of the two fitted models, yielding $R_{\\mathrm{LN}}$ from $\\{r_{\\mathrm{LN}}^*(\\phi_i)\\}$ and $R_{\\mathrm{EM}}$ from $\\{r_{\\mathrm{EM}}^*(\\phi_i)\\}$. Analytically, since $\\{r_{\\mathrm{EM}}^*\\}$ is constant, its $F1$ component must be zero, and thus $R_{\\mathrm{EM}}=0$.\n\n5.  **Classification Decision**: A neuron is classified as simple-like (represented by the boolean `True`) or complex-like (`False`) based on a two-part criterion. The cell is classified as simple if and only if: (a) the Rectified LN model provides a better fit to the data than the Energy Model, i.e., $\\mathrm{MSE}_{\\mathrm{LN}} < \\mathrm{MSE}_{\\mathrm{EM}}$, AND (b) the phase modulation of the fitted LN model's response is sufficiently strong, i.e., $R_{\\mathrm{LN}} \\ge 0.5$. If either of these conditions is not met, the neuron is classified as complex. This rule formalizes the idea that a simple cell must not only be better described by a phase-sensitive model but must also exhibit a substantial degree of phase sensitivity in that description.\n\nThis entire procedure is systematically applied to each test case to arrive at a final classification.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a decision procedure to classify neurons as simple or complex\n    based on phase tuning of membrane potential and spike responses.\n    \"\"\"\n\n    n_samples = 16\n    phi_grid = np.linspace(0, 2 * np.pi, n_samples, endpoint=False)\n\n    test_cases = [\n        # Case 1: Strong modulation (expected simple)\n        {'M_V': 1.0, 'A_V': 2.5, 'phi_V': np.pi / 6, 'beta': 5.0, 'alpha': 10.0},\n        # Case 2: No spike modulation (expected complex)\n        {'M_V': 1.0, 'A_V': 0.2, 'phi_V': np.pi / 3, 'beta': 8.0, 'alpha': 0.0},\n        # Case 3: Moderate modulation (borderline)\n        {'M_V': 1.0, 'A_V': 1.2, 'phi_V': np.pi / 8, 'beta': 7.0, 'alpha': 2.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Generate data for the current case\n        V_phi = case['M_V'] + case['A_V'] * np.cos(phi_grid - case['phi_V'])\n        r_phi = case['beta'] + case['alpha'] * np.maximum(0, np.cos(phi_grid - case['phi_V']))\n\n        # Step 1: Estimate phase offset phi_V from membrane potential\n        # This is a required step, but its result is not used later per problem statement.\n        complex_sum_V = np.sum(V_phi * np.exp(-1j * phi_grid))\n        phi_V_est = np.angle(complex_sum_V)\n\n        # Step 2: Fit the Rectified LN model\n        best_mse_ln = np.inf\n        best_params_ln = {}\n        \n        # Grid search over phi_0\n        phi0_search_grid = np.linspace(0, 2 * np.pi, 100, endpoint=False)\n        for phi0_candidate in phi0_search_grid:\n            # Construct design matrix for least squares\n            cos_term = np.maximum(0, np.cos(phi_grid - phi0_candidate))\n            A = np.vstack([cos_term, np.ones(n_samples)]).T\n            \n            # Solve for alpha and beta using least squares\n            p, res, _, _ = np.linalg.lstsq(A, r_phi, rcond=None)\n            alpha_fit, beta_fit = p[0], p[1]\n            \n            # Calculate MSE for this phi0\n            r_pred_ln = alpha_fit * cos_term + beta_fit\n            mse = np.mean((r_phi - r_pred_ln)**2)\n            \n            if mse < best_mse_ln:\n                best_mse_ln = mse\n                best_params_ln = {'alpha': alpha_fit, 'beta': beta_fit, 'phi0': phi0_candidate}\n\n        mse_ln = best_mse_ln\n        alpha_opt = best_params_ln['alpha']\n        beta_opt = best_params_ln['beta']\n        phi0_opt = best_params_ln['phi0']\n        \n        # Predicted spike rates from the best-fit LN model\n        r_pred_ln = alpha_opt * np.maximum(0, np.cos(phi_grid - phi0_opt)) + beta_opt\n\n        # Step 3: Fit the Energy Model (constant model)\n        r_mean = np.mean(r_phi)\n        r_pred_em = np.full_like(r_phi, r_mean)\n        mse_em = np.mean((r_phi - r_pred_em)**2)\n\n        # Step 4: Compute phase modulation depths for the predicted rates\n        def compute_r_metric(responses, phases):\n            n = len(responses)\n            if n == 0:\n                return 0.0\n            \n            F0 = np.mean(responses)\n            if np.isclose(F0, 0):\n                return 0.0 # Avoid division by zero for zero-response models\n\n            F1_complex = (2 / n) * np.sum(responses * np.exp(-1j * phases))\n            F1 = np.abs(F1_complex)\n            \n            return F1 / F0\n\n        R_ln = compute_r_metric(r_pred_ln, phi_grid)\n        R_em = compute_r_metric(r_pred_em, phi_grid) # This will be 0\n\n        # Step 5: Classify the neuron\n        is_simple = (mse_ln < mse_em) and (R_ln >= 0.5)\n        results.append(is_simple)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5049870"}]}