{"hands_on_practices": [{"introduction": "The foundation of any brain-computer interface is the ability to acquire neural signals with high fidelity. In modern systems using microelectrode arrays, this means listening to hundreds or even thousands of neurons at once. This practice tackles the first major engineering hurdle: the sheer volume of data generated. By calculating the raw data rate and storage needs for a typical recording setup [@problem_id:4457855], you will gain a concrete understanding of the immense information bandwidth required to interface with the brain.", "problem": "A multichannel extracellular recording system in a Brain-Computer Interface (BCI) application uses a microelectrode array (MEA) with $96$ independent channels to acquire neuronal spike waveforms. Each channel is digitized at a constant sampling frequency of $30\\,\\mathrm{kHz}$ with an analog-to-digital converter (ADC) resolution of $12$ bits per sample. Assume continuous acquisition, synchronous sampling across channels, and raw streaming with no compression, framing, metadata, or line-coding overhead; assume that samples are densely packed bitwise so that exactly $12$ bits are stored per sample.\n\nStarting from fundamental definitions of sampling frequency (samples per second) and information representation in digital systems (bits per sample), derive the expressions needed to compute:\n1. The raw data rate of the entire system.\n2. The total storage required for $1$ hour of recording.\n\nExpress the raw data rate in megabytes per second (MB/s) and the total storage in gigabytes (GB), using the decimal definitions $1\\,\\mathrm{MB} = 10^{6}\\,\\mathrm{bytes}$ and $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$. Provide the final numerical values without rounding.", "solution": "The foundational definitions we use are:\n- The sampling frequency $f_{s}$ gives the number of samples produced per second per channel.\n- The analog-to-digital converter resolution $n_{b}$ gives the number of bits used to represent each sample.\n- For $N_{c}$ channels sampled independently and synchronously, the total number of samples per second is $N_{c} f_{s}$.\n- The raw bit rate is the product of the number of samples per second and the number of bits per sample.\n\nLet $f_{s} = 30\\,\\mathrm{kHz} = 30{,}000\\,\\mathrm{s}^{-1}$, $n_{b} = 12\\,\\mathrm{bits/sample}$, and $N_{c} = 96$ channels.\n\nThe raw bit rate $R_{\\mathrm{bits}}$ is\n$$\nR_{\\mathrm{bits}} = f_{s} \\times n_{b} \\times N_{c}.\n$$\nSubstituting symbols and then values:\n$$\nR_{\\mathrm{bits}} = 30{,}000 \\times 12 \\times 96 = 34{,}560{,}000 \\ \\text{bits/s}.\n$$\n\nTo convert to bytes per second, use $1\\,\\mathrm{byte} = 8\\,\\mathrm{bits}$:\n$$\nR_{\\mathrm{bytes}} = \\frac{R_{\\mathrm{bits}}}{8} = \\frac{34{,}560{,}000}{8} = 4{,}320{,}000 \\ \\text{bytes/s}.\n$$\n\nTo express the raw data rate in megabytes per second (decimal), use $1\\,\\mathrm{MB} = 10^{6}\\,\\mathrm{bytes}$:\n$$\nR_{\\mathrm{MB/s}} = \\frac{R_{\\mathrm{bytes}}}{10^{6}} = \\frac{4{,}320{,}000}{1{,}000{,}000} = 4.32.\n$$\n\nNext, compute the total storage for a recording duration $T = 1\\,\\mathrm{hour} = 3600\\,\\mathrm{s}$. The total bytes $S_{\\mathrm{bytes}}$ stored are\n$$\nS_{\\mathrm{bytes}} = R_{\\mathrm{bytes}} \\times T = 4{,}320{,}000 \\times 3{,}600 = 15{,}552{,}000{,}000 \\ \\text{bytes}.\n$$\n\nConvert to gigabytes (decimal) using $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$:\n$$\nS_{\\mathrm{GB}} = \\frac{S_{\\mathrm{bytes}}}{10^{9}} = \\frac{15{,}552{,}000{,}000}{1{,}000{,}000{,}000} = 15.552.\n$$\n\nThus, the raw data rate is $4.32\\,\\mathrm{MB/s}$ and the storage required for one hour is $15.552\\,\\mathrm{GB}$, under the stated assumptions and decimal unit definitions.", "answer": "$$\\boxed{\\begin{pmatrix}4.32 & 15.552\\end{pmatrix}}$$", "id": "4457855"}, {"introduction": "Once a BCI system is built to decode a user's intent, how do we objectively measure its performance? While simple accuracy is intuitive, it doesn't tell the whole story, especially when considering the number of choices and the speed of communication. This exercise introduces the concept of the Information Transfer Rate (ITR), a powerful metric derived from information theory that has become a gold standard in the field [@problem_id:5002103]. By working through this calculation, you will learn to quantify not just if the BCI is correct, but how much information is being successfully transmitted per minute.", "problem": "A Brain-Computer Interface (BCI) speller presents a user with a fixed set of $N$ equally likely symbols. Each selection trial takes $T$ seconds from cue onset to finalized output, and the classifier selects the intended symbol with probability $P$; when an error occurs, it is uniformly distributed over the $N-1$ non-target symbols. Assume trials are independent and the symbol prior is uniform.\n\nStarting from the fundamental definitions of Shannon entropy and mutual information, derive expressions that formalize:\n- the symbol throughput (expected correctly communicated symbols per minute),\n- the raw bitrate upper bound (bits per minute assuming error-free communication of $N$-ary symbols),\n- the information transfer rate (mutual information per minute through the selection channel under the stated error model).\n\nThen, for a speller with $N=36$, $T=4\\,\\mathrm{s}$, and $P=0.85$, compute the numerical values of the symbol throughput, the raw bitrate, and the information transfer rate. Report your final numerical value for the Information Transfer Rate in bits per minute. Round your final answer to four significant figures and express it in bits per minute.", "solution": "### Derivation of Performance Metrics\n\nWe will derive the expressions for the three requested metrics based on the provided parameters $N$, $T$, and $P$. All information-theoretic quantities will be calculated using the base-$2$ logarithm, yielding results in bits. The number of trials (selections) that can be made per minute is given by $\\frac{60}{T}$.\n\n**1. Symbol Throughput (ST)**\nThe symbol throughput is the expected number of correctly communicated symbols per unit of time.\nA single trial results in a correct symbol with probability $P$. The expected number of correct symbols per trial is thus $1 \\times P + 0 \\times (1-P) = P$.\nMultiplying the expected correct symbols per trial by the number of trials per minute gives the symbol throughput in symbols per minute.\n$$\n\\text{ST} = P \\times \\frac{60}{T}\n$$\n\n**2. Raw Bitrate Upper Bound (RBUB)**\nThe raw bitrate represents the theoretical maximum information transfer rate assuming error-free communication ($P=1$). For a source with $N$ equally likely symbols, the Shannon entropy (information content per symbol) is $H = \\log_2(N)$.\nThe raw bitrate is the information per symbol multiplied by the number of symbols selected per minute.\n$$\n\\text{RBUB} = \\log_2(N) \\times \\frac{60}{T}\n$$\n\n**3. Information Transfer Rate (ITR)**\nThe ITR quantifies the actual amount of information successfully transmitted through the noisy channel. It is defined as the mutual information between the intended symbol and the classifier's output, expressed per unit of time.\n\nLet $X$ be the random variable representing the symbol intended by the user, and $Y$ be the random variable for the symbol selected by the BCI classifier. Both $X$ and $Y$ can take any of the $N$ possible symbol values.\n\nThe mutual information per trial, $I(X;Y)$, is given by:\n$$\nI(X;Y) = H(Y) - H(Y|X)\n$$\nwhere $H(Y)$ is the entropy of the output distribution and $H(Y|X)$ is the conditional entropy of the output given the input.\n\nDue to the uniform prior on the intended symbols ($p(x) = \\frac{1}{N}$) and the symmetry of the error model, the output distribution $p(y)$ is also uniform. We can verify this:\n$$\np(y) = \\sum_{x} p(y|x)p(x) = p(y|x=y)p(x=y) + \\sum_{x \\neq y} p(y|x \\neq y)p(x \\neq y)\n$$\n$$\np(y) = P \\cdot \\frac{1}{N} + (N-1) \\cdot \\left(\\frac{1-P}{N-1}\\right) \\cdot \\frac{1}{N} = \\frac{P}{N} + \\frac{1-P}{N} = \\frac{1}{N}\n$$\nSince the output distribution is uniform, its entropy is:\n$$\nH(Y) = -\\sum_{y} p(y)\\log_2(p(y)) = -\\sum_{i=1}^N \\frac{1}{N}\\log_2\\left(\\frac{1}{N}\\right) = \\log_2(N)\n$$\n\nNext, we find the conditional entropy $H(Y|X)$, which represents the uncertainty in the output given the input is known.\n$$\nH(Y|X) = -\\sum_{x,y} p(x,y) \\log_2(p(y|x)) = -\\sum_{x} p(x) \\sum_{y} p(y|x)\\log_2(p(y|x))\n$$\nDue to the channel's symmetry, the inner sum is the same for all $x$. For any given input $x$, the probability of a correct output is $p(y=x|x) = P$, and the probability of any specific incorrect output $y \\neq x$ is $p(y \\neq x|x) = \\frac{1-P}{N-1}$.\nThe entropy for a given $x$ is:\n$$\nH(Y|X=x) = -p(y=x|x)\\log_2(p(y=x|x)) - \\sum_{y \\neq x} p(y \\neq x|x)\\log_2(p(y \\neq x|x))\n$$\n$$\nH(Y|X=x) = -P\\log_2(P) - (N-1)\\left(\\frac{1-P}{N-1}\\right)\\log_2\\left(\\frac{1-P}{N-1}\\right)\n$$\n$$\nH(Y|X=x) = -P\\log_2(P) - (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right)\n$$\nSince this is constant for all $x$, $H(Y|X) = H(Y|X=x)$.\n\nNow we can compute the mutual information per trial, often denoted as $B$:\n$$\nB = I(X;Y) = H(Y) - H(Y|X) = \\log_2(N) - \\left[-P\\log_2(P) - (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right)\\right]\n$$\n$$\nB = \\log_2(N) + P\\log_2(P) + (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right)\n$$\nThis expression gives the information transferred in bits per trial. The ITR is this quantity multiplied by the number of trials per minute:\n$$\n\\text{ITR} = \\left[ \\log_2(N) + P\\log_2(P) + (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right) \\right] \\times \\frac{60}{T}\n$$\n\n### Numerical Computations\nGiven the values $N=36$, $T=4\\,\\mathrm{s}$, and $P=0.85$.\nThe number of trials per minute is $\\frac{60}{4} = 15$.\n\n**1. Symbol Throughput (ST)**\n$$\n\\text{ST} = 0.85 \\times 15 = 12.75 \\text{ symbols/min}\n$$\n\n**2. Raw Bitrate Upper Bound (RBUB)**\n$$\n\\text{RBUB} = \\log_2(36) \\times 15 = \\frac{\\ln(36)}{\\ln(2)} \\times 15 \\approx 5.1699 \\times 15 \\approx 77.55 \\text{ bits/min}\n$$\n\n**3. Information Transfer Rate (ITR)**\nFirst, we compute the information per trial, $B$:\n$$\nB = \\log_2(36) + 0.85\\log_2(0.85) + (1-0.85)\\log_2\\left(\\frac{1-0.85}{36-1}\\right)\n$$\n$$\nB = \\log_2(36) + 0.85\\log_2(0.85) + 0.15\\log_2\\left(\\frac{0.15}{35}\\right)\n$$\nWe evaluate the terms:\n- $\\log_2(36) \\approx 5.169925$\n- $0.85\\log_2(0.85) = 0.85 \\times \\frac{\\ln(0.85)}{\\ln(2)} \\approx 0.85 \\times (-0.234453) \\approx -0.199285$\n- $0.15\\log_2\\left(\\frac{0.15}{35}\\right) = 0.15 \\times \\frac{\\ln(0.15/35)}{\\ln(2)} \\approx 0.15 \\times (-7.86613) \\approx -1.179920$\nSumming these terms to get bits per trial:\n$$\nB \\approx 5.169925 - 0.199285 - 1.179920 \\approx 3.79072 \\text{ bits/trial}\n$$\nFinally, we compute the ITR in bits per minute:\n$$\n\\text{ITR} = B \\times 15 \\approx 3.79072 \\times 15 \\approx 56.8608 \\text{ bits/min}\n$$\nRounding the final answer for the ITR to four significant figures gives $56.86$ bits/min.", "answer": "$$\n\\boxed{56.86}\n$$", "id": "5002103"}, {"introduction": "Advanced neuroprosthetics complete the loop by not only reading from the brain but also writing information back, for example, to create a sense of touch for a prosthetic hand. This process of neurostimulation, however, must be performed within strict safety limits to avoid damaging delicate neural tissue. This practice focuses on that critical safety boundary by having you calculate the maximum safe current for a stimulation electrode based on its material properties and charge injection capacity [@problem_id:4457814]. This exercise highlights the bioengineering principles that ensure BCIs can interact with the brain safely and effectively over the long term.", "problem": "A cortical microstimulation electrode made of sputtered iridium oxide film is used in a brain-computer interface for somatosensory feedback. To avoid irreversible Faradaic reactions and tissue damage, stimulation is constrained by the material’s reversible charge injection limit per phase. Assume a rectangular, constant-current, cathodic-first biphasic pulse with a cathodic phase duration of $200\\,\\mu\\text{s}$. The electrode’s geometric surface area is $A=0.02\\,\\text{cm}^2$, and the manufacturer reports a reversible charge injection limit per phase of $\\sigma_{\\text{max}}=0.35\\,\\text{mC/cm}^2$ for the cathodic phase under the relevant waveform and bias conditions. For safety, the device is operated with a $10\\%$ safety margin, defined here as limiting operation to $90\\%$ of the theoretical maximum reversible charge per phase.\n\nUsing only the foundational relationships that (i) the charge delivered in a phase is the time integral of current over that phase, and (ii) the charge per phase must not exceed the product of the reversible areal limit and the geometric area, compute the maximum safe current amplitude for the cathodic phase. Express your final answer in milliamperes and round to three significant figures.", "solution": "The objective is to compute the maximum safe current amplitude, $I_{\\text{safe, max}}$, for the cathodic phase of a biphasic stimulus pulse. This will be accomplished by adhering to the constraints on charge injection.\n\nFirst, let us define the provided parameters with symbols:\n- Cathodic phase duration: $t_c = 200\\,\\mu\\text{s}$\n- Electrode geometric surface area: $A = 0.02\\,\\text{cm}^2$\n- Reversible charge injection limit per phase (areal charge density): $\\sigma_{\\text{max}} = 0.35\\,\\text{mC/cm}^2$\n- Safety factor: $S_f = 0.90$ (representing operation at $90\\%$ of the maximum limit, as per the $10\\%$ safety margin).\n\nThe problem is governed by two foundational relationships explicitly stated.\n\nFirst, the maximum theoretical reversible charge that can be injected during a single phase, $Q_{\\text{max, theoretical}}$, is the product of the material's charge injection limit per unit area, $\\sigma_{\\text{max}}$, and the electrode's geometric surface area, $A$.\n$$Q_{\\text{max, theoretical}} = \\sigma_{\\text{max}} \\times A$$\n\nSecond, for safety, the operational charge must not exceed a certain fraction of this theoretical maximum. The maximum safe charge per phase, $Q_{\\text{safe}}$, is therefore determined by applying the safety factor $S_f$.\n$$Q_{\\text{safe}} = S_f \\times Q_{\\text{max, theoretical}} = S_f \\times \\sigma_{\\text{max}} \\times A$$\n\nThird, the total charge $Q$ delivered by a constant current $I$ over a duration $t$ is the product of the current and duration. This is the result of integrating the constant current over the time interval. For the cathodic phase, the charge delivered is:\n$$Q_c = I_c \\times t_c$$\nwhere $I_c$ is the current amplitude during the cathodic phase.\n\nTo find the maximum safe current amplitude, $I_{\\text{safe, max}}$, we set the charge delivered during the cathodic phase equal to the maximum safe charge limit, $Q_{\\text{safe}}$.\n$$I_{\\text{safe, max}} \\times t_c = Q_{\\text{safe}}$$\n\nSubstituting the expression for $Q_{\\text{safe}}$ gives:\n$$I_{\\text{safe, max}} \\times t_c = S_f \\times \\sigma_{\\text{max}} \\times A$$\n\nWe can now solve for $I_{\\text{safe, max}}$:\n$$I_{\\text{safe, max}} = \\frac{S_f \\times \\sigma_{\\text{max}} \\times A}{t_c}$$\n\nNow, we substitute the given numerical values into this equation. It is crucial to maintain unit consistency. We will first calculate $Q_{\\text{safe}}$ in millicoulombs ($ \\text{mC} $).\n$$Q_{\\text{safe}} = 0.90 \\times (0.35\\,\\frac{\\text{mC}}{\\text{cm}^2}) \\times (0.02\\,\\text{cm}^2)$$\n$$Q_{\\text{safe}} = 0.90 \\times 0.007\\,\\text{mC}$$\n$$Q_{\\text{safe}} = 0.0063\\,\\text{mC}$$\n\nNext, we calculate $I_{\\text{safe, max}}$. The charge is in millicoulombs ($ \\text{mC} $), and the duration is in microseconds ($ \\mu\\text{s} $). It is prudent to convert these to base SI units (Coulombs and seconds) to find the current in Amperes, before finally converting to milliamperes as requested.\n$Q_{\\text{safe}} = 0.0063\\,\\text{mC} = 0.0063 \\times 10^{-3}\\,\\text{C} = 6.3 \\times 10^{-6}\\,\\text{C}$\n$t_c = 200\\,\\mu\\text{s} = 200 \\times 10^{-6}\\,\\text{s} = 2.0 \\times 10^{-4}\\,\\text{s}$\n\nNow, we compute the current in Amperes ($ \\text{A} $):\n$$I_{\\text{safe, max}} = \\frac{Q_{\\text{safe}}}{t_c} = \\frac{6.3 \\times 10^{-6}\\,\\text{C}}{2.0 \\times 10^{-4}\\,\\text{s}}$$\n$$I_{\\text{safe, max}} = 3.15 \\times 10^{-2}\\,\\text{A}$$\n$$I_{\\text{safe, max}} = 0.0315\\,\\text{A}$$\n\nThe problem requires the final answer to be expressed in milliamperes ($ \\text{mA} $) and rounded to three significant figures.\nTo convert from Amperes to milliamperes, we multiply by $1000$:\n$$I_{\\text{safe, max}} = 0.0315\\,\\text{A} \\times \\frac{1000\\,\\text{mA}}{1\\,\\text{A}} = 31.5\\,\\text{mA}$$\n\nThe value $31.5$ has exactly three significant figures ($3$, $1$, and $5$). Therefore, no further rounding is necessary.\nThe maximum safe current amplitude for the cathodic phase is $31.5\\,\\text{mA}$.", "answer": "$$\n\\boxed{31.5}\n$$", "id": "4457814"}]}