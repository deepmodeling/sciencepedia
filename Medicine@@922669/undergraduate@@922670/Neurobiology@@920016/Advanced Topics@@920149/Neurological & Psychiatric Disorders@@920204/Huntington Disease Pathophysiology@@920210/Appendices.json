{"hands_on_practices": [{"introduction": "Huntington's disease is fundamentally a genetic disorder where the number of cytosine-adenine-guanine ($CAG$) repeats in the huntingtin ($HTT$) gene is the primary determinant of disease onset. This practice bridges the gap between molecular genetics and clinical prediction, using principles of Mendelian inheritance and biostatistics to calculate the real-world risk of juvenile-onset HD for an offspring. This exercise develops skills in probabilistic reasoning and demonstrates how quantitative models help interpret complex genetic data in a clinical context [@problem_id:5025638].", "problem": "Huntington’s disease is an autosomal dominant neurodegenerative disorder in which the cytosine-adenine-guanine (CAG) trinucleotide repeat length in the huntingtin gene strongly influences the age of onset. In the male germline, repeat instability produces a mosaic distribution of CAG lengths across sperm carrying the expanded allele. Consider the following scientifically grounded assumptions:\n\n1. Mendelian inheritance: an offspring of a heterozygous affected father and an unaffected mother inherits the expanded allele with probability $0.5$ and the normal allele with probability $0.5$.\n2. The mother’s allele has a normal CAG repeat length and does not contribute to juvenile-onset risk; juvenile-onset risk is determined by the inherited expanded allele’s repeat length.\n3. The father’s sperm carrying the expanded allele has a germline mosaic distribution of CAG lengths, with probability mass function\n$$\n\\mathbb{P}(L = 58) = 0.4,\\quad \\mathbb{P}(L = 62) = 0.4,\\quad \\mathbb{P}(L = 68) = 0.2,\n$$\nwhere $L$ denotes the CAG repeat length of the transmitted expanded allele conditional on transmission of the expanded allele.\n4. The cumulative probability of onset by age $20$ years, conditional on the inherited expanded allele having length $L$, is modeled using a logistic hazard formulation for the age-$20$ cumulative incidence:\n$$\np_{\\text{juv}}(L) = \\frac{1}{1 + \\exp\\!\\big(-(\\alpha + \\beta\\,(L - L_{0}))\\big)},\n$$\nwith parameters $\\alpha = -3$, $\\beta = 0.35$, and $L_{0} = 60$.\n\nUsing these assumptions, compute the overall probability that the offspring will develop juvenile-onset Huntington’s disease (defined here as onset by age $20$ years). Round your final answer to four significant figures and express it as a decimal with no units.", "solution": "The problem is subjected to validation against the established criteria.\n\n### Step 1: Extract Givens\n- **Mendelian Inheritance**: The probability of inheriting the expanded allele from a heterozygous affected father is $0.5$. Let this event be $E$, so $\\mathbb{P}(E) = 0.5$. The probability of inheriting the normal allele is also $0.5$.\n- **Maternal Contribution**: The mother is unaffected and her normal allele does not contribute to juvenile-onset risk.\n- **Germline Mosaicism**: Conditional on transmitting the expanded allele, the CAG repeat length, $L$, follows a discrete probability distribution:\n  - $\\mathbb{P}(L=58) = 0.4$\n  - $\\mathbb{P}(L=62) = 0.4$\n  - $\\mathbb{P}(L=68) = 0.2$\n- **Juvenile Onset Risk Model**: The cumulative probability of onset by age $20$ years (juvenile onset), conditional on an inherited expanded allele of length $L$, is given by the logistic function:\n$$p_{\\text{juv}}(L) = \\frac{1}{1 + \\exp\\!\\big(-(\\alpha + \\beta\\,(L - L_{0}))\\big)}$$\n- **Model Parameters**:\n  - $\\alpha = -3$\n  - $\\beta = 0.35$\n  - $L_{0} = 60$\n- **Objective**: Compute the overall probability that the offspring will develop juvenile-onset Huntington's disease. The final answer must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is based on established principles of Mendelian genetics and the pathophysiology of Huntington's disease, including the concepts of CAG repeat expansion, age of onset correlation, and germline instability. The use of a logistic model is a standard approach in biomedical statistics. The premise is scientifically sound.\n- **Well-Posed**: The problem is clearly stated, providing all necessary data and definitions to calculate a unique probability. The probability mass function for $L$ is valid as the probabilities sum to $1$ ($0.4 + 0.4 + 0.2 = 1$). The question is unambiguous.\n- **Objective**: The language is precise and free of subjective claims.\n- **Other Flaws**: The problem does not violate any other criteria for invalidity (e.g., it is not incomplete, contradictory, unrealistic, or trivial).\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Solution Derivation\nThe objective is to find the overall probability that the offspring will develop juvenile-onset Huntington's disease, which we denote as $\\mathbb{P}(J)$.\n\nWe can compute this using the law of total probability, conditioning on whether the offspring inherits the expanded allele ($E$) or the normal allele ($N$) from the father.\n$$\\mathbb{P}(J) = \\mathbb{P}(J | E) \\mathbb{P}(E) + \\mathbb{P}(J | N) \\mathbb{P}(N)$$\n\nFrom the problem statement:\n1.  The probability of inheriting the expanded allele is $\\mathbb{P}(E) = 0.5$. The probability of inheriting the normal allele is $\\mathbb{P}(N) = 0.5$.\n2.  Juvenile-onset risk is determined solely by the inherited expanded allele's length. If the normal allele is inherited from the father (and the mother's allele is also normal), the risk is zero. Thus, the conditional probability of juvenile onset given inheritance of the normal allele is $\\mathbb{P}(J | N) = 0$.\n\nSubstituting these values into the equation gives:\n$$\\mathbb{P}(J) = \\mathbb{P}(J | E) \\times 0.5 + 0 \\times 0.5 = 0.5 \\times \\mathbb{P}(J | E)$$\n\nThe next step is to calculate $\\mathbb{P}(J | E)$, the probability of juvenile onset given that the expanded allele has been inherited. This probability depends on the CAG repeat length, $L$, of the specific allele that was transmitted. We can again use the law of total probability, conditioning on the possible values of $L$:\n$$\\mathbb{P}(J | E) = \\sum_{l \\in \\{58, 62, 68\\}} \\mathbb{P}(J | L=l, E) \\mathbb{P}(L=l | E)$$\n\nThe terms in this summation are:\n- $\\mathbb{P}(L=l | E)$ is the probability that the transmitted expanded allele has length $l$, which is given by the provided probability mass function: $\\mathbb{P}(L=58)=0.4$, $\\mathbb{P}(L=62)=0.4$, and $\\mathbb{P}(L=68)=0.2$.\n- $\\mathbb{P}(J | L=l, E)$ is the probability of juvenile onset given an inherited expanded allele of length $l$. This is precisely what the function $p_{\\text{juv}}(l)$ models.\n\nSo, the expression for $\\mathbb{P}(J | E)$ becomes:\n$$\\mathbb{P}(J | E) = p_{\\text{juv}}(58) \\mathbb{P}(L=58) + p_{\\text{juv}}(62) \\mathbb{P}(L=62) + p_{\\text{juv}}(68) \\mathbb{P}(L=68)$$\nThis is equivalent to finding the expected value of $p_{\\text{juv}}(L)$ over the distribution of $L$.\n\nWe now calculate $p_{\\text{juv}}(l)$ for each value of $l$ using the given logistic function and parameters ($\\alpha = -3$, $\\beta = 0.35$, $L_{0} = 60$). The argument of the exponential function is $z(L) = -(\\alpha + \\beta(L-L_0))$.\n\nFor $L=58$:\n$$z(58) = -(-3 + 0.35(58-60)) = -(-3 + 0.35(-2)) = -(-3 - 0.7) = 3.7$$\n$$p_{\\text{juv}}(58) = \\frac{1}{1 + \\exp(3.7)}$$\n\nFor $L=62$:\n$$z(62) = -(-3 + 0.35(62-60)) = -(-3 + 0.35(2)) = -(-3 + 0.7) = 2.3$$\n$$p_{\\text{juv}}(62) = \\frac{1}{1 + \\exp(2.3)}$$\n\nFor $L=68$:\n$$z(68) = -(-3 + 0.35(68-60)) = -(-3 + 0.35(8)) = -(-3 + 2.8) = 0.2$$\n$$p_{\\text{juv}}(68) = \\frac{1}{1 + \\exp(0.2)}$$\n\nNow, substitute these into the expression for $\\mathbb{P}(J | E)$:\n$$\\mathbb{P}(J | E) = \\left(\\frac{1}{1 + \\exp(3.7)}\\right)(0.4) + \\left(\\frac{1}{1 + \\exp(2.3)}\\right)(0.4) + \\left(\\frac{1}{1 + \\exp(0.2)}\\right)(0.2)$$\n\nWe evaluate the numerical values:\n$\\exp(3.7) \\approx 40.4473$\n$\\exp(2.3) \\approx 9.9742$\n$\\exp(0.2) \\approx 1.2214$\n\n$$p_{\\text{juv}}(58) \\approx \\frac{1}{1 + 40.4473} = \\frac{1}{41.4473} \\approx 0.024127$$\n$$p_{\\text{juv}}(62) \\approx \\frac{1}{1 + 9.9742} = \\frac{1}{10.9742} \\approx 0.091123$$\n$$p_{\\text{juv}}(68) \\approx \\frac{1}{1 + 1.2214} = \\frac{1}{2.2214} \\approx 0.450166$$\n\nNow, we compute $\\mathbb{P}(J | E)$:\n$$\\mathbb{P}(J | E) \\approx (0.024127)(0.4) + (0.091123)(0.4) + (0.450166)(0.2)$$\n$$\\mathbb{P}(J | E) \\approx 0.0096508 + 0.0364492 + 0.0900332$$\n$$\\mathbb{P}(J | E) \\approx 0.1361332$$\n\nFinally, we compute the overall probability $\\mathbb{P}(J)$:\n$$\\mathbb{P}(J) = 0.5 \\times \\mathbb{P}(J | E) \\approx 0.5 \\times 0.1361332 = 0.0680666$$\n\nThe problem requires rounding the final answer to four significant figures. The number is $0.0680666$. The first significant figure is $6$, the second is $8$, the third is $0$, and the fourth is $6$. The fifth significant figure is $6$, so we round up the fourth significant figure.\n$$\\mathbb{P}(J) \\approx 0.06807$$", "answer": "$$\\boxed{0.06807}$$", "id": "5025638"}, {"introduction": "The genetic mutation in HD ultimately leads to the death of striatal medium spiny neurons, with excitotoxicity—pathological calcium influx from excessive glutamate stimulation—being a primary mechanism. This problem challenges you to model this process, combining receptor pharmacology with cellular calcium dynamics to determine how a therapeutic agent can protect the neuron. By calculating the minimum antagonist concentration needed to keep the steady-state calcium concentration, $[Ca^{2+}]_{\\mathrm{ss}}$, below a toxic threshold, you will see how a quantitative understanding of pathophysiology can inform therapeutic strategies [@problem_id:5025600].", "problem": "In Huntington's disease, striatal medium spiny neurons experience pathological calcium loading driven by excessive activation of N-methyl-D-aspartate (NMDA) receptors during high glutamatergic input and impaired uptake. Consider a single-compartment neuron in which cytosolic calcium concentration, denoted $[Ca^{2+}]$, follows first-order balance dynamics under sustained stimulation: $d[Ca^{2+}]/dt = J_{\\mathrm{in}} - k_{\\mathrm{eff}}[Ca^{2+}]$, where $J_{\\mathrm{in}}$ is the NMDA receptor-mediated calcium influx rate and $k_{\\mathrm{eff}}$ is an effective first-order clearance rate constant that summarizes buffering, pumps, and sequestration. Under sustained input, assume the membrane is sufficiently depolarized that the magnesium block of NMDA receptors is relieved, and the glycine co-agonist site is saturated. Assume further that the open probability of NMDA receptors is proportional to the fraction of receptors occupied by glutamate, which you must model using the law of mass action for a single binding site with a competitive antagonist.\n\nLet $[G]$ be the glutamate concentration during high input, $[A]$ the concentration of a competitive NMDA receptor antagonist, $K_G$ the dissociation constant for glutamate, and $K_A$ the dissociation constant for the antagonist. Under these assumptions, let $J_{\\mathrm{in}} = \\alpha f_G$, where $\\alpha$ is a constant scaling the maximum calcium influx rate of the receptor population and $f_G$ is the fraction of receptors occupied by glutamate in the presence of the antagonist. At steady state, $[Ca^{2+}]_{\\mathrm{ss}} = J_{\\mathrm{in}}/k_{\\mathrm{eff}}$.\n\nUse the following parameter values, chosen to reflect a high-input, transporter-impaired state relevant to Huntington's disease pathophysiology:\n- $[G] = 20\\,\\mu\\mathrm{M}$\n- $K_G = 2.0\\,\\mu\\mathrm{M}$\n- $K_A = 1.0\\,\\mu\\mathrm{M}$\n- $\\alpha = 0.15\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{eff}} = 0.25\\,\\mathrm{s}^{-1}$\n- Target threshold $[Ca^{2+}]^\\ast = 0.30\\,\\mu\\mathrm{M}$\n\nStarting from the law of mass action for a single receptor binding site with a competitive antagonist and the calcium balance equation above, derive an expression for the minimum antagonist concentration $[A]_{\\min}$ that guarantees $[Ca^{2+}]_{\\mathrm{ss}} \\le [Ca^{2+}]^\\ast$ during the sustained high-input condition. Then compute its numerical value using the parameters provided. Round your final result to two significant figures. Express the final antagonist concentration in micromolar ($\\mu\\mathrm{M}$).", "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained. The model used is a standard simplification in biophysical pharmacology and presents no contradictions or factual unsoundness. All necessary parameters and relationships are provided to arrive at a unique, meaningful solution. Thus, the problem is valid, and a full solution follows.\n\nThe core of the problem is to determine the minimum concentration of a competitive antagonist, $[A]_{\\min}$, required to keep the steady-state intracellular calcium concentration, $[Ca^{2+}]_{\\mathrm{ss}}$, below a specified threshold, $[Ca^{2+}]^\\ast$.\n\nFirst, we must derive the expression for the fraction of NMDA receptors occupied by glutamate, $f_G$, in the presence of both glutamate ($[G]$) and a competitive antagonist ($[A]$). According to the law of mass action for a single binding site, the equilibria for the agonist (glutamate, $G$) and antagonist ($A$) binding to the receptor ($R$) are:\n$$R + G \\rightleftharpoons RG \\quad \\text{with dissociation constant} \\quad K_G = \\frac{[R][G]}{[RG]}$$\n$$R + A \\rightleftharpoons RA \\quad \\text{with dissociation constant} \\quad K_A = \\frac{[R][A]}{[RA]}$$\nThe total concentration of receptors, $[R]_{\\mathrm{tot}}$, is the sum of receptors in all possible states: unbound ($[R]$), glutamate-bound ($[RG]$), and antagonist-bound ($[RA]$).\n$$[R]_{\\mathrm{tot}} = [R] + [RG] + [RA]$$\nWe can express the concentrations of the bound states in terms of the free receptor concentration $[R]$:\n$$[RG] = \\frac{[R][G]}{K_G} \\quad \\text{and} \\quad [RA] = \\frac{[R][A]}{K_A}$$\nSubstituting these into the equation for $[R]_{\\mathrm{tot}}$:\n$$[R]_{\\mathrm{tot}} = [R] + \\frac{[R][G]}{K_G} + \\frac{[R][A]}{K_A} = [R] \\left(1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}\\right)$$\nThe fraction of receptors occupied by glutamate, $f_G$, is the ratio $[RG]/[R]_{\\mathrm{tot}}$:\n$$f_G = \\frac{\\frac{[R][G]}{K_G}}{[R] \\left(1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}\\right)} = \\frac{\\frac{[G]}{K_G}}{1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}}$$\nMultiplying the numerator and denominator by $K_G$ yields the final expression for $f_G$:\n$$f_G = \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}}$$\nNext, we establish the relationship for the steady-state calcium concentration, $[Ca^{2+}]_{\\mathrm{ss}}$. The system dynamics are given by $\\frac{d[Ca^{2+}]}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}[Ca^{2+}]$. At steady state, $\\frac{d[Ca^{2+}]}{dt} = 0$, which gives:\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}}$$\nThe problem states that the calcium influx $J_{\\mathrm{in}}$ is proportional to the fraction of glutamate-bound receptors, $J_{\\mathrm{in}} = \\alpha f_G$. Substituting this relation gives:\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{\\alpha f_G}{k_{\\mathrm{eff}}}$$\nNow, we combine the expressions for $f_G$ and $[Ca^{2+}]_{\\mathrm{ss}}$:\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{\\alpha}{k_{\\mathrm{eff}}} \\left( \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}} \\right)$$\nThe condition to be met is $[Ca^{2+}]_{\\mathrm{ss}} \\le [Ca^{2+}]^\\ast$. To find the minimum antagonist concentration, $[A]_{\\min}$, we solve the equality $[Ca^{2+}]_{\\mathrm{ss}} = [Ca^{2+}]^\\ast$.\n$$\\frac{\\alpha}{k_{\\mathrm{eff}}} \\left( \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}} \\right) = [Ca^{2+}]^\\ast$$\nWe rearrange this equation to solve for $[A]$. Since all terms are positive, we can manipulate the expression directly:\n$$K_G + [G] + [A]\\frac{K_G}{K_A} = \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast}$$\nIsolating the term containing $[A]$:\n$$[A]\\frac{K_G}{K_A} = \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast} - (K_G + [G])$$\nFinally, solving for $[A]$ yields the general expression for the minimum required concentration, $[A]_{\\min}$:\n$$[A]_{\\min} = \\frac{K_A}{K_G} \\left( \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast} - (K_G + [G]) \\right)$$\nNow, we substitute the given numerical values into this expression:\n- $[G] = 20\\,\\mu\\mathrm{M}$\n- $K_G = 2.0\\,\\mu\\mathrm{M}$\n- $K_A = 1.0\\,\\mu\\mathrm{M}$\n- $\\alpha = 0.15\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{eff}} = 0.25\\,\\mathrm{s}^{-1}$\n- $[Ca^{2+}]^\\ast = 0.30\\,\\mu\\mathrm{M}$\n\nFirst, we compute the term $\\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast}$:\n$$\\frac{(0.15)(20)}{(0.25)(0.30)} \\mu\\mathrm{M} = \\frac{3.0}{0.075} \\mu\\mathrm{M} = 40\\,\\mu\\mathrm{M}$$\nNext, we compute the term $(K_G + [G])$:\n$$2.0\\,\\mu\\mathrm{M} + 20\\,\\mu\\mathrm{M} = 22\\,\\mu\\mathrm{M}$$\nSubstituting these back into the equation for $[A]_{\\min}$:\n$$[A]_{\\min} = \\frac{1.0}{2.0} \\left( 40\\,\\mu\\mathrm{M} - 22\\,\\mu\\mathrm{M} \\right)$$\n$$[A]_{\\min} = 0.5 \\left( 18\\,\\mu\\mathrm{M} \\right)$$\n$$[A]_{\\min} = 9.0\\,\\mu\\mathrm{M}$$\nThe result is $9.0\\,\\mu\\mathrm{M}$. This value is already presented with two significant figures as requested.", "answer": "$$\\boxed{9.0}$$", "id": "5025600"}, {"introduction": "The clinical presentation of HD is marked by a paradoxical shift from excessive movement (hyperkinesia) to profound immobility (akinesia), a direct result of the selective loss of different neuron populations within the basal ganglia. This capstone practice involves building a computational model of the motor circuit to simulate this exact biphasic symptom progression. By translating neuroanatomical rules and disease progression into a functional algorithm, you will gain insight into how complex, system-level dynamics produce the clinical symptoms experienced by patients [@problem_id:5025611].", "problem": "You are to build, explain, and implement a discrete-time progression model of basal ganglia-thalamocortical motor output that connects early hyperkinetic symptoms to later akinetic symptoms in Huntington's disease pathophysiology by tracking the degeneration of indirect-pathway medium spiny neurons (MSNs) and predicting threshold-crossing transitions in motor output. You must derive the model from core neurobiological sign rules and a standard firing-rate transfer function, then implement it and evaluate it on a specified test suite. All neural activities are to be treated as dimensionless in arbitrary units (a.u.). The final program output must be a single line containing all test-case results as a comma-separated Python-style list, as specified below.\n\nFoundational base and definitions to use:\n- Basal ganglia circuit sign rules. The direct pathway (striatonigral) inhibits the internal segment of the globus pallidus (GPi), thereby disinhibiting thalamus and facilitating movement; the indirect pathway (striatopallidal via the external segment of the globus pallidus (GPe) and subthalamic nucleus (STN)) has a net excitatory effect on GPi, thereby inhibiting thalamus and suppressing movement. The thalamus excites motor cortex.\n- Huntington’s disease early-stage preferentially degenerates indirect-pathway MSNs, effectively reducing the net excitatory drive to GPi, leading to thalamic disinhibition and hyperkinesia; later disease involves degeneration that reduces direct-pathway MSNs and cortical drive, increasing GPi influence and leading to akinesia.\n- Rate-model assumption. Each nucleus’ output is a monotonic function of a weighted sum of its inputs. Use a static logistic nonlinearity for the thalamic transfer function.\n\nModel specification to be derived and implemented:\n- Let $C_t$ denote cortical drive at discrete time step $t$, in a.u.\n- Let $D_t \\in [0,1]$ denote the fraction of intact direct-pathway MSNs at time $t$, and $I_t \\in [0,1]$ denote the fraction of intact indirect-pathway MSNs at time $t$.\n- Let $G_t$ denote GPi output at time $t$ and $T_t$ denote thalamic output at time $t$.\n- Parameters are fixed constants: baseline GPi output $G_0 = 1.0$ (a.u.), indirect-pathway gain $k_I = 1.0$, direct-pathway gain $k_D = 1.0$, thalamic pre-activation bias $u_0 = 0.0$, cortical gain $k_C = 1.0$, GPi-to-thalamus gain $k_G = 1.0$, and thalamic logistic gain $g = 4.0$ (dimensionless).\n- Use the qualitative sign structure to construct the following computational stages:\n  1) Compute the GPi output $G_t$ as a baseline $G_0$ plus the net indirect-pathway effect (excitatory to GPi) minus the net direct-pathway effect (inhibitory to GPi), each proportional to both the corresponding MSN fraction and the cortical drive, consistent with a feedforward approximation.\n  2) Compute the thalamic pre-activation $U_t$ as the difference of an excitatory cortical term and an inhibitory GPi term with bias $u_0$.\n  3) Map $U_t$ to thalamic output $T_t$ using the logistic transfer $S(x) = \\dfrac{1}{1 + \\exp(-x)}$ with slope parameter $g$, i.e., $T_t = S(g \\, U_t)$.\n  4) Treat $T_t$ as a dimensionless motor output proxy in $[0,1]$.\n- Define two clinically interpretable thresholds: a hyperkinesia threshold $H = 0.8$ and an akinesia threshold $A = 0.2$. A hyperkinetic phase onset occurs at the smallest index $t$ such that $T_t \\ge H$. An akinetic phase onset occurs at the smallest index $t$ such that $T_t \\le A$. If no such index exists within the provided series, return $-1$ for that transition.\n\nInput and test suite (hard-coded; no user input):\nFor each test case, you must generate discrete series for $t = 0, 1, \\dots, T-1$ as described. All sequences and constants are in a.u., and angles are not involved.\n- Test case $1$ (happy path, early hyperkinesia then late akinesia):\n  - Horizon $T = 11$.\n  - Indirect-pathway integrity $I_t$ decreases linearly from $1.0$ at $t = 0$ to $0.2$ at $t = 10$.\n  - Direct-pathway integrity $D_t$ remains $1.0$ for $t \\le 5$, then decreases linearly to $0.1$ at $t = 10$.\n  - Cortical drive $C_t$ remains $1.0$ for $t \\le 5$, then decreases linearly to $0.5$ at $t = 10$.\n- Test case $2$ (edge case: indirect-pathway loss only; hyperkinesia but no akinesia):\n  - Horizon $T = 11$.\n  - $I_t$ decreases linearly from $1.0$ at $t = 0$ to $0.2$ at $t = 10$.\n  - $D_t \\equiv 1.0$ for all $t$.\n  - $C_t \\equiv 1.0$ for all $t$.\n- Test case $3$ (edge case: late akinesia without preceding hyperkinesia):\n  - Horizon $T = 11$.\n  - $I_t \\equiv 0.9$ for all $t$.\n  - $D_t$ decreases linearly from $1.0$ at $t = 0$ to $0.1$ at $t = 10$.\n  - $C_t$ decreases linearly from $1.0$ at $t = 0$ to $0.5$ at $t = 10$.\n- Test case $4$ (boundary conditions: exact-threshold equality):\n  - Horizon $T = 2$.\n  - Let $U^\\star = \\dfrac{\\ln 4}{g}$ so that $S(g \\, U^\\star) = 0.8$, and let $U_\\star = -\\dfrac{\\ln 4}{g}$ so that $S(g \\, U_\\star) = 0.2$.\n  - For $t = 0$, use $C_0 = 1.0$, $D_0 = 1.0$, and $I_0 = 1.0 - U^\\star$ so that $U_0 = 1.0 - I_0 = U^\\star$ and hence $T_0 = 0.8$.\n  - For $t = 1$, use $C_1 = 1.0$, set $I_1 = I_0$, and choose $D_1 = I_0 + U_\\star$ so that $U_1 = D_1 - I_1 = U_\\star$ and hence $T_1 = 0.2$.\n\nRequired computations:\n- For each test case, generate $I_t$, $D_t$, and $C_t$ as above, then compute $G_t$, $U_t$, and $T_t$ for all $t$.\n- Determine the smallest time index $t_H$ such that $T_t \\ge H$ and the smallest time index $t_A$ such that $T_t \\le A$. If a condition is never met within the horizon, report $-1$ for that index.\n- The program must output a single line containing a Python-style list of lists with the pair $[t_H, t_A]$ for each test case in order $1$ through $4$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[[t_{H,1}, t_{A,1}],[t_{H,2}, t_{A,2}],[t_{H,3}, t_{A,3}],[t_{H,4}, t_{A,4}]]$ where each entry is an integer. No additional text must be printed.", "solution": "The problem requires the construction and implementation of a discrete-time computational model of the basal ganglia-thalamocortical circuit to simulate the motor symptoms of Huntington's disease. The model must be derived from specified neurobiological principles and then used to predict the onset of hyperkinetic and akinetic phases for a suite of test cases.\n\n### Principles and Model Derivation\n\nThe model is founded upon a simplified rate-based representation of key nuclei in the motor loop, consistent with established circuit diagrams. The core components are the cortex, the striatum (comprising direct and indirect pathway Medium Spiny Neurons, or MSNs), the Globus Pallidus internal segment (GPi), and the thalamus. The sign rules governing their interactions are as follows: cortical drive excites both striatal pathways; the direct pathway ultimately inhibits the GPi; the indirect pathway ultimately excites the GPi; the GPi tonically inhibits the thalamus; and the thalamus excites the motor cortex, closing the loop. Motor output is facilitated by thalamic disinhibition (i.e., reduced GPi activity).\n\nHuntington's disease progression is modeled by the selective degeneration of MSN populations. Early in the disease, degeneration is concentrated in the indirect pathway MSNs ($I_t$ decreases). Reduced indirect pathway function lessens the net excitatory drive to the GPi. This lowers GPi output, disinhibits the thalamus, and leads to excessive motor output (hyperkinesia). Later, the disease also affects the direct pathway MSNs ($D_t$ decreases) and reduces cortical drive ($C_t$ decreases). The loss of direct pathway function reduces the inhibitory influence on the GPi, while reduced cortical drive lowers the overall input to the system. The net effect is a pathological increase in GPi's inhibitory output, which suppresses thalamic activity and leads to a lack of movement (akinesia).\n\nWe formalize this conceptual model into a set of discrete-time equations. All activities are dimensionless, in arbitrary units (a.u.).\n\n**1. GPi Output ($G_t$)**\n\nThe GPi output at time $t$, denoted $G_t$, is determined by a baseline activity $G_0$, modulated by the opposing effects of the direct and indirect pathways.\n- The indirect pathway's net effect is excitatory on the GPi. Its influence is proportional to the fraction of intact indirect-pathway MSNs, $I_t$, the cortical drive, $C_t$, and a gain factor, $k_I$. This term is $+k_I I_t C_t$.\n- The direct pathway's net effect is inhibitory on the GPi. Its influence is proportional to the fraction of intact direct-pathway MSNs, $D_t$, the cortical drive, $C_t$, and a gain factor, $k_D$. This term is $-k_D D_t C_t$.\n\nThe resulting equation for GPi output is:\n$$\nG_t = G_0 + k_I I_t C_t - k_D D_t C_t\n$$\nUsing the provided parameters ($G_0=1.0$, $k_I=1.0$, $k_D=1.0$):\n$$\nG_t = 1.0 + (1.0) \\cdot I_t C_t - (1.0) \\cdot D_t C_t = 1.0 + C_t(I_t - D_t)\n$$\n\n**2. Thalamic Pre-activation ($U_t$)**\n\nThe thalamus receives excitatory input from the cortex and inhibitory input from the GPi. Its pre-activation potential, $U_t$, is the weighted sum of these inputs plus a bias term, $u_0$.\n- The excitatory cortical input is proportional to cortical drive $C_t$ with gain $k_C$. Term: $+k_C C_t$.\n- The inhibitory GPi input is proportional to GPi output $G_t$ with gain $k_G$. Term: $-k_G G_t$.\n\nThe equation for thalamic pre-activation is:\n$$\nU_t = u_0 + k_C C_t - k_G G_t\n$$\nUsing the provided parameters ($u_0=0.0$, $k_C=1.0$, $k_G=1.0$):\n$$\nU_t = 0.0 + (1.0) \\cdot C_t - (1.0) \\cdot G_t = C_t - G_t\n$$\nSubstituting the expression for $G_t$ into the equation for $U_t$:\n$$\nU_t = C_t - (1.0 + C_t(I_t - D_t)) = C_t - 1.0 - C_t I_t + C_t D_t\n$$\nFactoring out $C_t$ yields the final compact form:\n$$\nU_t = C_t(1.0 - I_t + D_t) - 1.0\n$$\n\n**3. Thalamic Output ($T_t$)**\n\nThe thalamic output, $T_t$, which serves as a proxy for motor output, is a non-linear, saturating function of its pre-activation. We use the standard logistic function, $S(x) = \\frac{1}{1 + \\exp(-x)}$, with a gain parameter $g$ that controls the steepness of the response.\n$$\nT_t = S(g \\cdot U_t)\n$$\nUsing the given thalamic logistic gain $g = 4.0$:\n$$\nT_t = \\frac{1}{1 + \\exp(-4.0 \\cdot U_t)}\n$$\n\n**4. Clinical Phase Onset**\n\nThe model's output, $T_t$, is compared against two thresholds to determine the onset of clinical phases.\n- **Hyperkinesia onset ($t_H$)**: The first time index $t$ where motor output exceeds a high threshold, $H = 0.8$. Formally, $t_H = \\min(\\{t \\mid T_t \\ge 0.8\\} \\cup \\{-1\\})$, where $-1$ is used if the set is empty.\n- **Akinesia onset ($t_A$)**: The first time index $t$ where motor output falls below a low threshold, $A = 0.2$. Formally, $t_A = \\min(\\{t \\mid T_t \\le 0.2\\} \\cup \\{-1\\})$.\n\n### Algorithmic Implementation\n\nThe implementation proceeds by first defining the model parameters and the logistic function. Then, for each of the four test cases, we perform the following steps:\n1. Generate the input time series for $I_t$, $D_t$, and $C_t$ over the specified time horizon $T$, from $t=0$ to $t=T-1$. This involves creating constant arrays or using linear interpolation (e.g., via `numpy.linspace`) for simple or piecewise linear functions as specified.\n2. Apply the derived equations vectorially to the time series arrays to compute the sequence of GPi outputs ($G_t$), thalamic pre-activations ($U_t$), and finally the motor outputs ($T_t$).\n3. Search the resulting $T_t$ sequence for the first indices where the hyperkinesia ($T_t \\ge 0.8$) and akinesia ($T_t \\le 0.2$) conditions are met. The `numpy.where` function is suitable for finding all indices satisfying a condition; the first element of the resulting index array is the desired onset time. If the condition is never met, the index array will be empty, and we report $-1$.\n4. Store the resulting pair $[t_H, t_A]$ for each test case.\n5. After processing all test cases, format the collected results into a single string representing a Python list of lists, e.g., `[[t_H1, t_A1],[t_H2, t_A2],...]`, and print it to standard output. This requires careful string formatting to match the required output precisely, without extra spaces.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Derives and implements a discrete-time model for Huntington's disease\n    pathophysiology, evaluating it on four test cases to find the onset times\n    of hyperkinesia and akinesia.\n    \"\"\"\n\n    # Define model parameters\n    G_0 = 1.0\n    k_I = 1.0\n    k_D = 1.0\n    u_0 = 0.0\n    k_C = 1.0\n    k_G = 1.0\n    g = 4.0\n    \n    # Define clinical thresholds\n    H = 0.8\n    A = 0.2\n\n    def S(x):\n        \"\"\"Logistic transfer function.\"\"\"\n        return 1.0 / (1.0 + np.exp(-g * x))\n\n    def run_simulation(C_t, D_t, I_t):\n        \"\"\"\n        Computes GPi, thalamic pre-activation, and thalamic output series.\n        \n        Args:\n            C_t (np.ndarray): Cortical drive time series.\n            D_t (np.ndarray): Direct-pathway integrity time series.\n            I_t (np.ndarray): Indirect-pathway integrity time series.\n\n        Returns:\n            np.ndarray: Thalamic output (motor proxy) time series.\n        \"\"\"\n        G_t = G_0 + k_I * I_t * C_t - k_D * D_t * C_t\n        U_t = u_0 + k_C * C_t - k_G * G_t\n        T_t = S(U_t)\n        return T_t\n\n    def find_onsets(T_series):\n        \"\"\"\n        Finds the first time indices for hyperkinesia and akinesia.\n\n        Args:\n            T_series (np.ndarray): Thalamic output time series.\n\n        Returns:\n            list[int, int]: A pair of indices [t_H, t_A].\n        \"\"\"\n        tH_indices = np.where(T_series >= H)[0]\n        tH = tH_indices[0] if len(tH_indices) > 0 else -1\n        \n        tA_indices = np.where(T_series <= A)[0]\n        tA = tA_indices[0] if len(tA_indices) > 0 else -1\n        \n        return [tH, tA]\n\n    all_results = []\n\n    # Test Case 1: Happy path (hyperkinesia then akinesia)\n    T = 11\n    I_t1 = np.linspace(1.0, 0.2, T)\n    D_t1 = np.ones(T)\n    D_t1[5:] = np.linspace(1.0, 0.1, T - 5)\n    C_t1 = np.ones(T)\n    C_t1[5:] = np.linspace(1.0, 0.5, T - 5)\n    T_series_1 = run_simulation(C_t1, D_t1, I_t1)\n    all_results.append(find_onsets(T_series_1))\n\n    # Test Case 2: Indirect-pathway loss only (hyperkinesia only)\n    T = 11\n    I_t2 = np.linspace(1.0, 0.2, T)\n    D_t2 = np.ones(T)\n    C_t2 = np.ones(T)\n    T_series_2 = run_simulation(C_t2, D_t2, I_t2)\n    all_results.append(find_onsets(T_series_2))\n\n    # Test Case 3: Late akinesia without preceding hyperkinesia\n    T = 11\n    I_t3 = np.full(T, 0.9)\n    D_t3 = np.linspace(1.0, 0.1, T)\n    C_t3 = np.linspace(1.0, 0.5, T)\n    T_series_3 = run_simulation(C_t3, D_t3, I_t3)\n    all_results.append(find_onsets(T_series_3))\n\n    # Test Case 4: Boundary conditions (exact threshold equality)\n    T = 2\n    U_star = math.log(4) / g\n    U_star_neg = -math.log(4) / g\n    \n    C_t4 = np.ones(T)\n    D_t4 = np.zeros(T)\n    I_t4 = np.zeros(T)\n    \n    # Time t=0 setup\n    D_t4[0] = 1.0\n    I_t4[0] = 1.0 - U_star\n    \n    # Time t=1 setup\n    I_t4[1] = I_t4[0]\n    D_t4[1] = I_t4[0] + U_star_neg\n    \n    T_series_4 = run_simulation(C_t4, D_t4, I_t4)\n    all_results.append(find_onsets(T_series_4))\n    \n    # Format the final output string precisely as specified\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "5025611"}]}