{"hands_on_practices": [{"introduction": "To effectively navigate the massive datasets of Whole Slide Images (WSI), they are stored in a multi-resolution pyramid structure. This exercise provides a foundational understanding of this structure by connecting the physical dimensions of a tissue specimen to the pixel dimensions at various magnification levels. By performing this calculation [@problem_id:4948984], you will gain a practical grasp of how digital slides represent biological reality at different scales.", "problem": "In virtual microscopy and digital pathology, Whole Slide Images (WSI) are stored as resolution pyramids to enable rapid multi-scale navigation. Consider a WSI acquired at $40\\times$ optical magnification with a spatial sampling of $0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$. A contiguous square tissue region on this slide measures $15\\,\\mathrm{mm}\\times 15\\,\\mathrm{mm}$ in physical space. The pyramid contains $4$ levels indexed by $\\ell=0,1,2,3$, where each successive level is downsampled by a factor of $2$ relative to the previous level. Assume that the pixel dimension along each axis is determined solely by the physical size and sampling rate at that level, and that downsampling yields exact integer pixel counts without padding or cropping.\n\nUsing the fundamental relation between physical length and sampling, and standard dimensional conversion $1\\,\\mathrm{mm}=1000\\,\\mu\\mathrm{m}$, compute the pixel dimensions (width and height) at each pyramid level. Report your final answer as a single row matrix containing $(w_0,h_0,w_1,h_1,w_2,h_2,w_3,h_3)$, where $w_\\ell$ and $h_\\ell$ are the width and height in pixels at level $\\ell$. Do not include units in your final answer.", "solution": "Whole Slide Image (WSI) pyramids rely on the sampling relation that connects physical length to the number of discrete samples (pixels). The foundational definition is that if a one-dimensional extent has physical length $L$ and the sampling interval is $s$ (in $\\mu\\mathrm{m}/\\mathrm{pixel}$), then the number of pixels $N$ along that axis is\n$$\nN \\;=\\; \\frac{L}{s}.\n$$\nFor a square region, the width and height in pixels are equal and each given by this relation, applied independently to each axis.\n\nFirst, convert the given physical size from millimeters to micrometers using the well-tested dimensional identity $1\\,\\mathrm{mm}=1000\\,\\mu\\mathrm{m}$. The tissue region is $15\\,\\mathrm{mm}\\times 15\\,\\mathrm{mm}$, so each side length is\n$$\nL \\;=\\; 15\\,\\mathrm{mm} \\times 1000\\,\\frac{\\mu\\mathrm{m}}{\\mathrm{mm}} \\;=\\; 15000\\,\\mu\\mathrm{m}.\n$$\nAt the base level (level $\\ell=0$), the sampling interval is the native scan sampling $s_0 = 0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$. Therefore, the pixel count along one axis at level $0$ is\n$$\nN_0 \\;=\\; \\frac{L}{s_0} \\;=\\; \\frac{15000}{0.25} \\;=\\; 60000.\n$$\nSince the region is square, the width and height at level $0$ are\n$$\nw_0 \\;=\\; 60000, \\quad h_0 \\;=\\; 60000.\n$$\n\nEach successive pyramid level is downsampled by a factor of $2$ relative to the previous level. Downsampling by a factor of $2$ along each axis reduces the pixel count by the same factor. Thus, the general relationship for level $\\ell$ is\n$$\nN_{\\ell} \\;=\\; \\frac{N_0}{2^{\\ell}},\n$$\nand since the region remains square at each level,\n$$\nw_{\\ell} \\;=\\; N_{\\ell}, \\quad h_{\\ell} \\;=\\; N_{\\ell}.\n$$\nCompute these for $\\ell=1,2,3$:\n- For $\\ell=1$:\n$$\nN_1 \\;=\\; \\frac{60000}{2^{1}} \\;=\\; 30000, \\quad w_1 \\;=\\; 30000, \\quad h_1 \\;=\\; 30000.\n$$\n- For $\\ell=2$:\n$$\nN_2 \\;=\\; \\frac{60000}{2^{2}} \\;=\\; 15000, \\quad w_2 \\;=\\; 15000, \\quad h_2 \\;=\\; 15000.\n$$\n- For $\\ell=3$:\n$$\nN_3 \\;=\\; \\frac{60000}{2^{3}} \\;=\\; 7500, \\quad w_3 \\;=\\; 7500, \\quad h_3 \\;=\\; 7500.\n$$\n\nCollecting the ordered sequence $(w_0,h_0,w_1,h_1,w_2,h_2,w_3,h_3)$ as requested yields\n$$\n(60000,\\,60000,\\,30000,\\,30000,\\,15000,\\,15000,\\,7500,\\,7500).\n$$\nAll entries are integers, consistent with the assumption that downsampling yields exact integer pixel counts.", "answer": "$$\\boxed{\\begin{pmatrix}60000 & 60000 & 30000 & 30000 & 15000 & 15000 & 7500 & 7500\\end{pmatrix}}$$", "id": "4948984"}, {"introduction": "The diagnostic value of a digital slide hinges on its ability to faithfully capture clinically significant features, such as the subtle characteristics of cell nuclei. This practice applies the fundamental Nyquist–Shannon sampling theorem to determine the minimum required scanner resolution for this task. Working through this problem [@problem_id:4949003] will illustrate the critical link between the principles of signal processing and the practical specifications of digital pathology hardware.", "problem": "In virtual slide microscopy for histopathology, the smallest diagnostically relevant nuclear feature to be captured is a micronucleus-like nuclear fragment of diameter $1.5\\,\\mu\\mathrm{m}$ at the specimen plane. The scanner reports sampling density as an object-space pixel size in $\\mu\\mathrm{m}/\\mathrm{pixel}$. Using the Nyquist–Shannon sampling theorem for band-limited signals and the definition that faithful digital capture of a spatial feature requires at least $2$ samples across the minimum feature width, derive the relationship between the required object-space pixel size and the minimum feature width. Then compute the minimum object-space pixel size needed to faithfully capture a $1.5\\,\\mu\\mathrm{m}$ diameter feature at $2$ samples per minimum feature width. Finally, based on your derivation, determine whether an object-space pixel size of $0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$ is adequate for this task, justifying your conclusion in words.\n\nExpress the computed minimum object-space pixel size in $\\mu\\mathrm{m}/\\mathrm{pixel}$ and round your numerical answer to three significant figures.", "solution": "The problem requires the derivation of a relationship between sampling pixel size and minimum feature size, a calculation based on this relationship, and an assessment of a given scanner's adequacy. This will be addressed sequentially.\n\nThe foundation for this problem is the Nyquist–Shannon sampling theorem, which dictates the conditions necessary to reconstruct a continuous band-limited signal from a discrete set of samples without loss of information. For a spatial signal, such as a microscopic image, the theorem can be expressed in terms of spatial frequencies.\n\nLet $d_{min}$ be the smallest feature size (diameter) that must be resolved. This corresponds to the highest spatial frequency, $k_{max}$, present in the signal that we wish to capture, where the relationship is approximately $k_{max} \\approx \\frac{1}{d_{min}}$. The theorem states that the sampling frequency, $k_s$, must be at least twice the highest frequency component of the signal.\n$$k_s \\ge 2k_{max}$$\nThe spatial sampling frequency, $k_s$, is determined by the object-space pixel size, $p_s$. The sampling frequency is the number of samples per unit distance, so it is the reciprocal of the pixel size.\n$$k_s = \\frac{1}{p_s}$$\nSubstituting the expressions for $k_s$ and $k_{max}$ into the Nyquist criterion gives:\n$$\\frac{1}{p_s} \\ge 2 \\left( \\frac{1}{d_{min}} \\right)$$\nSolving this inequality for the object-space pixel size, $p_s$, yields the required relationship:\n$$p_s \\le \\frac{d_{min}}{2}$$\nThis relationship states that for faithful capture, the center-to-center distance between adjacent sampling points (the pixel size) must be less than or equal to half the width of the smallest feature of interest. This corresponds directly to the problem's definition of requiring at least $N_{samples} = 2$ samples across the minimum feature width. The maximum permissible pixel size, which I will denote as $p_{s,max}$, occurs at the limit of this inequality.\n\nNext, we compute this maximum permissible object-space pixel size needed to faithfully capture a feature of diameter $d_{min} = 1.5\\,\\mu\\mathrm{m}$, using the critical sampling condition of exactly $2$ samples per feature width.\n$$p_{s,max} = \\frac{d_{min}}{2} = \\frac{1.5\\,\\mu\\mathrm{m}}{2} = 0.75\\,\\mu\\mathrm{m}$$\nThe units are implicitly $\\mu\\mathrm{m}/\\mathrm{pixel}$ as per the problem's definition of object-space pixel size. The problem requires this value to be rounded to three significant figures.\n$$p_{s,max} = 0.750\\,\\mu\\mathrm{m}/\\mathrm{pixel}$$\n\nFinally, we must determine whether a scanner with an object-space pixel size of $p_{s,actual} = 0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$ is adequate for this task. The condition for adequacy is that the actual pixel size must be less than or equal to the maximum permissible pixel size derived from the Nyquist criterion.\n$$p_{s,actual} \\le p_{s,max}$$\nSubstituting the values:\n$$0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel} \\le 0.750\\,\\mu\\mathrm{m}/\\mathrm{pixel}$$\nThis inequality is true.\n\nJustification: An object-space pixel size of $0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$ is adequate. The derived maximum allowable pixel size to satisfy the Nyquist criterion for a $1.5\\,\\mu\\mathrm{m}$ feature is $0.750\\,\\mu\\mathrm{m}/\\mathrm{pixel}$. Since the scanner's actual pixel size ($0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$) is smaller than this maximum limit, the sampling rate is higher than the minimum required rate. Specifically, the number of samples across the $1.5\\,\\mu\\mathrm{m}$ feature would be:\n$$N_{samples} = \\frac{d_{min}}{p_{s,actual}} = \\frac{1.5\\,\\mu\\mathrm{m}}{0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}} = 6\\,\\mathrm{pixels}$$\nSince $6$ samples is greater than the required minimum of $2$ samples, the scanner provides more than sufficient sampling density to faithfully capture the $1.5\\,\\mu\\mathrm{m}$ nuclear fragment. This represents oversampling, which is beneficial for image quality and subsequent analysis.", "answer": "$$\\boxed{0.750}$$", "id": "4949003"}, {"introduction": "A key challenge in both manual and automated histopathology is distinguishing true biological changes from artifacts introduced during tissue processing. This problem guides you through the logic of computational pathology by asking you to design a decision rule that separates true villus atrophy from crush artifacts using quantitative image features. This thought experiment [@problem_id:4949008] develops crucial skills in translating qualitative histological knowledge into a robust, quantitative classification strategy.", "problem": "You are building a rule-based classifier to distinguish true villus atrophy from crush artifacts in embryonic intestinal whole-slide images (WSI) using virtual microscopy. The mucosa is segmented and the slide is tessellated into square tiles of side length $200\\,\\mu\\mathrm{m}$ aligned to the villus–crypt axis. For each tile, you extract the following features, which are standardized to gestational-age normative controls:\n\n- Villus-to-crypt height ratio $R_{vc}$, estimated from a medial axis of villi and depth of adjacent crypts. Lower $R_{vc}$ suggests shorter villi relative to crypts.\n- Anisotropy index $A$, derived from the image structure tensor $J$ with eigenvalues $\\lambda_1 \\ge \\lambda_2$, defined as $A = \\dfrac{\\lambda_1 - \\lambda_2}{\\lambda_1 + \\lambda_2}$. Higher $A$ indicates stronger directional alignment of textures and nuclei.\n- Gray-level co-occurrence matrix (GLCM) entropy $H$, defined as $H = -\\sum_{i,j} p_{ij}\\log p_{ij}$ for the co-occurrence probabilities $p_{ij}$ in a tile, quantifying randomness of texture.\n- Nuclear ellipticity $E$, defined as the ratio of major to minor axis of epithelial nuclei averaged per tile.\n- Distance to nearest tissue edge or fold $D$ (in $\\mu\\mathrm{m}$).\n- Spatial contiguity $k$, the count of immediately adjacent tiles (sharing an edge) that satisfy the same predicate within a connected mucosal region.\n\nAssume the following well-tested histologic and imaging facts:\n\n- True villus atrophy (biological remodeling) in embryonic mucosa reduces $R_{vc}$ persistently across contiguous mucosal regions, preserves epithelial nuclear polarity and shape (moderate $E$), and does not induce directional smearing. Therefore, atrophy tends to present with moderately low $R_{vc}$, relatively low $A$, moderate $H$, and appears away from knife edges or folds.\n- Crush artifacts are mechanical compressions that cause nuclear streaming and elongation with a dominant direction. Therefore, artifacts tend to present with lower apparent $R_{vc}$ but high $A$, high $E$, elevated $H$ from heterogeneous tearing and folding, and occur near edges or folds (small $D$), often in focal patches.\n- In embryonic intestine at the analyzed stage, normative $R_{vc}$ has already been adjusted to gestational age, so thresholding on $R_{vc}$ can be interpreted relative to age-matched controls.\n\nYou must propose a decision rule that classifies a slide region as true villus atrophy while controlling false positives from crush artifacts. The operating requirement is to avoid classifying focal edge-related compressions as atrophy. Consider the following candidate rules, each applied tile-wise and then aggregated per region:\n\nA. Classify as atrophy if any tile has $R_{vc} < 1.0$.\n\nB. Classify as atrophy if a tile has $R_{vc} < 1.0$ and $A > 0.7$ and $D < 200\\,\\mu\\mathrm{m}$.\n\nC. Classify as atrophy if there exist at least $k \\ge 5$ contiguous tiles each satisfying $R_{vc} < 1.0$, $A < 0.5$, $E < 0.75$, $H \\le 2.5$, and with mean $D \\ge 300\\,\\mu\\mathrm{m}$ across those tiles.\n\nD. Classify as atrophy if any tile has $H > 3.0$ and $A > 0.7$, regardless of $R_{vc}$, provided $D \\ge 100\\,\\mu\\mathrm{m}$.\n\nWhich rule best distinguishes true villus atrophy from crush artifacts under the stated constraints?\n\n- A. Rule A\n- B. Rule B\n- C. Rule C\n- D. Rule D", "solution": "To solve this problem, we must identify the rule that best captures the described features of true villus atrophy while simultaneously excluding the features of crush artifacts. Let's summarize the key distinguishing characteristics provided:\n\n- **True Villus Atrophy:** Characterized by a low villus-to-crypt ratio ($R_{vc}$) that is persistent over a large, contiguous area (high $k$). It preserves tissue structure, resulting in low anisotropy ($A$), moderate nuclear ellipticity ($E$), and moderate texture entropy ($H$). Crucially, it is a biological process and not related to mechanical damage, so it occurs away from tissue edges (high $D$).\n\n- **Crush Artifact:** A mechanical deformation that also lowers the apparent $R_{vc}$. However, it is characterized by directional smearing and nuclear elongation, leading to high anisotropy ($A$) and high nuclear ellipticity ($E$). The tissue tearing can also increase texture entropy ($H$). It is typically focal (low $k$) and occurs near tissue edges or folds (low $D$).\n\nNow let's evaluate each rule based on these profiles:\n\n**A. Classify as atrophy if any tile has $R_{vc} < 1.0$.**\nThis rule is too simple. Since both true atrophy and crush artifacts can cause a low $R_{vc}$, this rule cannot distinguish between them and will produce many false positives.\n\n**B. Classify as atrophy if a tile has $R_{vc} < 1.0$ and $A > 0.7$ and $D < 200\\,\\mu\\mathrm{m}$.**\nThis rule combines low $R_{vc}$ with high anisotropy ($A > 0.7$) and proximity to an edge ($D < 200\\,\\mu\\mathrm{m}$). These are the classic signs of a **crush artifact**, not true atrophy. Therefore, this rule would misclassify artifacts as atrophy.\n\n**C. Classify as atrophy if there exist at least $k \\ge 5$ contiguous tiles each satisfying $R_{vc} < 1.0$, $A < 0.5$, $E < 0.75$, $H \\le 2.5$, and with mean $D \\ge 300\\,\\mu\\mathrm{m}$ across those tiles.**\nThis rule is comprehensive and accurately models true atrophy. It requires:\n- Spatial contiguity ($k \\ge 5$), matching the \"persistent\" nature of atrophy.\n- The primary indicator ($R_{vc} < 1.0$).\n- Low anisotropy ($A < 0.5$) and moderate ellipticity ($E < 0.75$) and entropy ($H \\le 2.5$), which are features of preserved tissue structure, directly contrasting with artifact features.\n- Location away from edges (mean $D \\ge 300\\,\\mu\\mathrm{m}$), which is a key requirement to avoid classifying edge-related artifacts.\nThis rule effectively captures the signature of true atrophy while rejecting artifacts.\n\n**D. Classify as atrophy if any tile has $H > 3.0$ and $A > 0.7$, regardless of $R_{vc}$, provided $D \\ge 100\\,\\mu\\mathrm{m}$.**\nThis rule is flawed. It ignores $R_{vc}$, the most fundamental feature of villus atrophy. Furthermore, it uses high entropy ($H > 3.0$) and high anisotropy ($A > 0.7$), which are defining features of a crush artifact. This rule is designed to detect artifacts, not atrophy.\n\nBased on this analysis, Rule C is the only one that correctly combines multiple features to specifically identify true villus atrophy and distinguish it from crush artifacts.", "answer": "$$\\boxed{C}$$", "id": "4949008"}]}