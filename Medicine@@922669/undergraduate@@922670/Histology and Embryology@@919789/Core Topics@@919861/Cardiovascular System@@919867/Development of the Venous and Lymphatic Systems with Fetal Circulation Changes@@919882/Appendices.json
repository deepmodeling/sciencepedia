{"hands_on_practices": [{"introduction": "The fetal circulatory system features remarkable shunts that optimize oxygen delivery. This first practice focuses on the ductus venosus, which allows a portion of umbilical vein blood to bypass the liver. By modeling the ductus venosus and the hepatic circulation as a simple parallel resistor circuit, you can apply principles analogous to Ohm's law to calculate how blood flow is partitioned [@problem_id:4881700]. This exercise provides a quantitative foundation for understanding why shunts are effective and how blood preferentially follows paths of lower resistance.", "problem": "In fetal circulation, oxygenated blood returns via the umbilical vein and splits between two parallel pathways before reaching the inferior vena cava and right atrium: (i) directly through the ductus venosus (a vascular shunt that bypasses hepatic sinusoids) and (ii) through the hepatic sinusoids within the liver. In a steady-state hemodynamic model where each pathway is represented by a pure resistance, assume laminar, incompressible flow with negligible compliance and inertial effects. Let the pressure at the umbilical vein entry be $P_{u}$ and the pressure at the confluence (downstream of both pathways) be $P_{d}$, with both pathways thus experiencing the same pressure drop $\\Delta P = P_{u} - P_{d}$. The volumetric flow rate through a resistive pathway is governed by the hemodynamic analogue of Ohmâ€™s law, $Q = \\Delta P / R$, and conservation of flow holds at the junction.\n\nSuppose the resistances are $R_{\\mathrm{DV}} = 0.4 R$ for the ductus venosus pathway and $R_{\\mathrm{hepatic}} = 0.6 R$ for the hepatic sinusoidal pathway, where $R > 0$ is an arbitrary positive reference resistance. Using only these assumptions and starting from the stated fundamental relationships, derive the fraction of total umbilical venous flow that is shunted through the ductus venosus versus the fraction that perfuses the hepatic sinusoids.\n\nExpress your final answer as a row matrix $\\begin{pmatrix} f_{\\mathrm{DV}} & f_{\\mathrm{hepatic}} \\end{pmatrix}$ of dimensionless fractions, where $f_{\\mathrm{DV}}$ is the fraction through the ductus venosus and $f_{\\mathrm{hepatic}}$ is the fraction through the hepatic sinusoids. No rounding is required.", "solution": "The problem is scientifically grounded, well-posed, and objective. It presents a standard fluid dynamics problem analogous to a parallel electrical circuit, applied to a simplified but physiologically correct model of fetal circulation. All necessary data and governing principles are provided, and no contradictions exist. Therefore, the problem is valid and a solution will be derived.\n\nThe problem describes two parallel hemodynamic pathways: the ductus venosus (DV) and the hepatic sinusoids. The total volumetric flow rate from the umbilical vein, denoted as $Q_{\\mathrm{total}}$, splits between these two pathways. Let $Q_{\\mathrm{DV}}$ be the flow rate through the ductus venosus and $Q_{\\mathrm{hepatic}}$ be the flow rate through the hepatic sinusoids. According to the principle of conservation of flow (mass conservation for an incompressible fluid), the total flow entering the junction must equal the total flow exiting it.\n$$Q_{\\mathrm{total}} = Q_{\\mathrm{DV}} + Q_{\\mathrm{hepatic}}$$\nThe problem states that both pathways are subject to the same pressure drop, $\\Delta P = P_{u} - P_{d}$. The flow rate through each resistive pathway is governed by the hemodynamic analogue of Ohm's law, $Q = \\Delta P / R$. Applying this relationship to each pathway yields:\n$$Q_{\\mathrm{DV}} = \\frac{\\Delta P}{R_{\\mathrm{DV}}}$$\n$$Q_{\\mathrm{hepatic}} = \\frac{\\Delta P}{R_{\\mathrm{hepatic}}}$$\nwhere $R_{\\mathrm{DV}}$ and $R_{\\mathrm{hepatic}}$ are the resistances of the ductus venosus and hepatic pathways, respectively.\n\nWe can express the total flow, $Q_{\\mathrm{total}}$, in terms of the common pressure drop $\\Delta P$ and the individual resistances:\n$$Q_{\\mathrm{total}} = \\frac{\\Delta P}{R_{\\mathrm{DV}}} + \\frac{\\Delta P}{R_{\\mathrm{hepatic}}} = \\Delta P \\left( \\frac{1}{R_{\\mathrm{DV}}} + \\frac{1}{R_{\\mathrm{hepatic}}} \\right)$$\nThis can be simplified by finding a common denominator:\n$$Q_{\\mathrm{total}} = \\Delta P \\left( \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}} \\right)$$\nThis relationship shows that the total flow is related to the pressure drop via an equivalent resistance for the parallel combination, $R_{\\mathrm{eq}} = \\frac{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$.\n\nThe objective is to find the fractions of the total flow that pass through each pathway. The fraction of flow through the ductus venosus, $f_{\\mathrm{DV}}$, is the ratio of the flow through the ductus venosus to the total flow:\n$$f_{\\mathrm{DV}} = \\frac{Q_{\\mathrm{DV}}}{Q_{\\mathrm{total}}}$$\nSubstituting the expressions for $Q_{\\mathrm{DV}}$ and $Q_{\\mathrm{total}}$:\n$$f_{\\mathrm{DV}} = \\frac{\\frac{\\Delta P}{R_{\\mathrm{DV}}}}{\\Delta P \\left( \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}} \\right)} = \\frac{1}{R_{\\mathrm{DV}}} \\cdot \\frac{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\nSimplifying this expression gives the general formula for the flow fraction in one of two parallel resistive paths:\n$$f_{\\mathrm{DV}} = \\frac{R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\nSimilarly, the fraction of flow through the hepatic pathway, $f_{\\mathrm{hepatic}}$, is:\n$$f_{\\mathrm{hepatic}} = \\frac{Q_{\\mathrm{hepatic}}}{Q_{\\mathrm{total}}} = \\frac{\\frac{\\Delta P}{R_{\\mathrm{hepatic}}}}{\\Delta P \\left( \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}} \\right)} = \\frac{1}{R_{\\mathrm{hepatic}}} \\cdot \\frac{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\n$$f_{\\mathrm{hepatic}} = \\frac{R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\nNote that $f_{\\mathrm{DV}} + f_{\\mathrm{hepatic}} = \\frac{R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}} + \\frac{R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}} = \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}} = 1$, as required by conservation of flow.\n\nThe problem provides the specific resistance values: $R_{\\mathrm{DV}} = 0.4 R$ and $R_{\\mathrm{hepatic}} = 0.6 R$, where $R$ is a positive reference resistance. We substitute these values into the derived fractional expressions.\n\nFor the ductus venosus fraction:\n$$f_{\\mathrm{DV}} = \\frac{0.6 R}{0.4 R + 0.6 R} = \\frac{0.6 R}{1.0 R} = 0.6$$\nThis can be expressed as the exact fraction $\\frac{3}{5}$.\n\nFor the hepatic sinusoid fraction:\n$$f_{\\mathrm{hepatic}} = \\frac{0.4 R}{0.4 R + 0.6 R} = \\frac{0.4 R}{1.0 R} = 0.4$$\nThis can be expressed as the exact fraction $\\frac{2}{5}$.\n\nThus, $60\\%$ of the umbilical venous blood flow is shunted through the lower-resistance ductus venosus, while $40\\%$ perfuses the higher-resistance hepatic sinusoids. The final answer is to be expressed as a row matrix $\\begin{pmatrix} f_{\\mathrm{DV}} & f_{\\mathrm{hepatic}} \\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.6 & 0.4 \\end{pmatrix}}$$", "id": "4881700"}, {"introduction": "Now that we have seen how blood flow is divided, we can explore the critical physiological consequence: the preferential delivery of highly oxygenated blood to vital organs. This exercise simulates the intricate mixing that occurs in the fetal right atrium, where different streams of blood are directed with remarkable precision [@problem_id:4881638]. By applying the principle of conservation to calculate the final oxygen saturation of blood supplying the fetal heart, you will gain a deeper appreciation for the functional elegance of the fetal circulatory design.", "problem": "In fetal circulation, partial stream separation at the inferior vena cava (IVC) and right atrium influenced by the Eustachian valve (EV) preferentially directs the more oxygenated umbilical venous return toward the foramen ovale (FO) and thus into the left atrium. The ascending aorta (AAo) supplies the coronary circulation from the left ventricle, which in this scenario is assumed to be filled entirely by FO-directed inflow (pulmonary venous inflow is negligible). Assume conservation of mass and oxygen content during mixing, and that dissolved oxygen is negligible relative to hemoglobin-bound oxygen under these conditions.\n\nUse the following scientifically plausible parameters:\n- Flow fractions entering the IVC from three sources that sum to $1$: umbilical via ductus venosus ($w_{UV} = 0.44$), hepatic veins ($w_{HV} = 0.26$), and lower body veins ($w_{LB} = 0.30$).\n- Preferential FO streaming fractions for each source (the fraction of each source flow that crosses the FO into the left atrium): umbilical via ductus venosus ($p_{UV} = 0.92$), hepatic veins ($p_{HV} = 0.58$), and lower body veins ($p_{LB} = 0.12$).\n- Oxygen content (total, primarily hemoglobin-bound) of each source stream, in milliliters of oxygen per deciliter: umbilical via ductus venosus ($C_{UV} = 17.6$), hepatic veins ($C_{HV} = 13.2$), and lower body veins ($C_{LB} = 10.8$).\n- Fetal hemoglobin concentration: $[Hb] = 16.5$ grams per deciliter.\n- Hemoglobin oxygen-binding capacity: $1.34$ milliliters of oxygen per gram of hemoglobin.\n\nStarting from the principles of conservation of mass and oxygen during mixing, and the standard oxygen content relation $C \\approx 1.34[Hb]S$ for saturation $S$ when dissolved oxygen is negligible, compute the oxygen saturation delivered to the coronary circulation via the AAo, modeled as the mixed FO inflow to the left atrium. Express the final oxygen saturation as a decimal fraction (not with a percentage sign) and round your answer to four significant figures.", "solution": "The problem statement will first be validated for scientific soundness, self-consistency, and clarity before a solution is attempted.\n\n### Step 1: Extract Givens\n-   Flow fractions entering the Inferior Vena Cava (IVC):\n    -   Umbilical vein via ductus venosus: $w_{UV} = 0.44$\n    -   Hepatic veins: $w_{HV} = 0.26$\n    -   Lower body veins: $w_{LB} = 0.30$\n-   Preferential foramen ovale (FO) streaming fractions:\n    -   Umbilical vein: $p_{UV} = 0.92$\n    -   Hepatic veins: $p_{HV} = 0.58$\n    -   Lower body veins: $p_{LB} = 0.12$\n-   Oxygen content of source streams (in ml O$_2$/dL):\n    -   Umbilical vein: $C_{UV} = 17.6$\n    -   Hepatic veins: $C_{HV} = 13.2$\n    -   Lower body veins: $C_{LB} = 10.8$\n-   Constants and physiological parameters:\n    -   Fetal hemoglobin concentration: $[Hb] = 16.5$ g/dL\n    -   Hemoglobin oxygen-binding capacity: $k_{O_2} = 1.34$ ml O$_2$/g Hb\n-   Assumptions and conditions:\n    1.  The left ventricle is filled entirely by FO-directed inflow; pulmonary venous return is negligible.\n    2.  The Ascending Aorta (AAo) receives its blood from the left ventricle, so its oxygen content is that of the mixed FO inflow.\n    3.  Conservation of mass (blood volume) and oxygen content during mixing.\n    4.  Dissolved oxygen is negligible.\n    5.  Oxygen content $C$ is related to saturation $S$ by $C \\approx k_{O_2} [Hb] S$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard, albeit simplified, model of fetal circulation and oxygen transport. The physiological parameters provided are plausible. The sum of the IVC inflow fractions $w_{UV} + w_{HV} + w_{LB} = 0.44 + 0.26 + 0.30 = 1.00$, which is consistent. The problem is well-posed, objective, and contains sufficient information to calculate a unique solution for the requested quantity. The relationship $C \\approx k_{O_2} [Hb] S$ is a standard approximation in physiology.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe problem requires the calculation of the oxygen saturation in the ascending aorta, $S_{AAo}$. Based on the problem's assumptions, this is equivalent to the saturation of the mixed blood that has crossed the foramen ovale (FO) into the left atrium.\n\nThe core principle is the conservation of mass and the conservation of oxygen. The oxygen content of a mixture of fluids is the total rate of oxygen flow divided by the total rate of fluid flow.\n\nLet $Q_{IVC}$ be the total blood flow rate in the IVC just before the right atrium. The flow rate from each contributing source $i$ (where $i \\in \\{UV, HV, LB\\}$) is $Q_i = w_i Q_{IVC}$.\n\nThe fraction of each of these streams that crosses the FO is given by $p_i$. Therefore, the flow rate of blood from each source $i$ that crosses the FO and enters the left atrium is $Q_{FO,i} = p_i Q_i = p_i w_i Q_{IVC}$.\n\nThe total blood flow rate across the FO, $Q_{FO,total}$, is the sum of these components:\n$$Q_{FO,total} = Q_{FO,UV} + Q_{FO,HV} + Q_{FO,LB}$$\n$$Q_{FO,total} = (p_{UV}w_{UV} + p_{HV}w_{HV} + p_{LB}w_{LB})Q_{IVC}$$\n\nSimilarly, the rate of oxygen transport from each source $i$ across the FO is the product of its flow rate across the FO and its oxygen content $C_i$. Let this be $\\dot{O}_{2,FO,i}$:\n$$\\dot{O}_{2,FO,i} = Q_{FO,i} C_i = (p_i w_i Q_{IVC}) C_i$$\n\nThe total rate of oxygen transport across the FO, $\\dot{O}_{2,FO,total}$, is the sum of these components:\n$$\\dot{O}_{2,FO,total} = \\dot{O}_{2,FO,UV} + \\dot{O}_{2,FO,HV} + \\dot{O}_{2,FO,LB}$$\n$$\\dot{O}_{2,FO,total} = (p_{UV}w_{UV}C_{UV} + p_{HV}w_{HV}C_{HV} + p_{LB}w_{LB}C_{LB})Q_{IVC}$$\n\nThe mixed oxygen content in the left atrium, which supplies the AAo, is $C_{AAo}$. It is calculated as the total oxygen flow rate across the FO divided by the total blood flow rate across the FO:\n$$C_{AAo} = \\frac{\\dot{O}_{2,FO,total}}{Q_{FO,total}} = \\frac{(p_{UV}w_{UV}C_{UV} + p_{HV}w_{HV}C_{HV} + p_{LB}w_{LB}C_{LB})Q_{IVC}}{(p_{UV}w_{UV} + p_{HV}w_{HV} + p_{LB}w_{LB})Q_{IVC}}$$\nThe term $Q_{IVC}$ cancels, yielding:\n$$C_{AAo} = \\frac{p_{UV}w_{UV}C_{UV} + p_{HV}w_{HV}C_{HV} + p_{LB}w_{LB}C_{LB}}{p_{UV}w_{UV} + p_{HV}w_{HV} + p_{LB}w_{LB}}$$\n\nWe now substitute the given numerical values. First, calculate the numerator:\nNumerator $= (0.92)(0.44)(17.6) + (0.58)(0.26)(13.2) + (0.12)(0.30)(10.8)$\nNumerator $= (0.4048)(17.6) + (0.1508)(13.2) + (0.036)(10.8)$\nNumerator $= 7.12448 + 1.99056 + 0.3888 = 9.50384$\n\nNext, calculate the denominator:\nDenominator $= (0.92)(0.44) + (0.58)(0.26) + (0.12)(0.30)$\nDenominator $= 0.4048 + 0.1508 + 0.036 = 0.5916$\n\nNow, compute $C_{AAo}$:\n$$C_{AAo} = \\frac{9.50384}{0.5916} \\approx 16.06464165 \\text{ ml O}_2/\\text{dL}$$\n\nThe problem asks for the oxygen saturation, $S_{AAo}$. The relationship is given as $C = k_{O_2} [Hb] S$. We can solve for $S$:\n$$S_{AAo} = \\frac{C_{AAo}}{k_{O_2} [Hb]}$$\n\nThe denominator is the maximum oxygen-carrying capacity of the blood:\n$k_{O_2} [Hb] = (1.34 \\text{ ml O}_2/\\text{g Hb}) \\times (16.5 \\text{ g/dL}) = 22.11 \\text{ ml O}_2/\\text{dL}$\n\nFinally, we calculate the saturation $S_{AAo}$:\n$$S_{AAo} = \\frac{16.06464165}{22.11} \\approx 0.72657809$$\n\nRounding the result to four significant figures as requested gives $0.7266$.", "answer": "$$\\boxed{0.7266}$$", "id": "4881638"}, {"introduction": "The transition to life outside the womb involves a profound reorganization of the circulatory system, including the closure and regression of fetal vessels that are no longer needed. This practice delves into the field of mechanobiology to explore how this happens [@problem_id:4881757]. You will implement a computational model based on the principle that blood vessels regress when the physical force of blood flow, or wall shear stress, falls below a critical threshold, providing a hands-on look at how hemodynamics sculpts vascular anatomy.", "problem": "You are tasked with building a minimal mechanobiological pruning model grounded in laminar hemodynamics to reason about vessel regression during the transition from fetal to neonatal circulation. The biological observation is that vessels experiencing chronically low wall shear stress tend to regress. You will use a time-averaged wall shear stress threshold to decide which segments in a small, predefined set of networks regress. Your program must be completely deterministic and produce a single line of output aggregating the results of all test cases.\n\nFundamental base and core definitions to use:\n- Under steady, fully developed, incompressible, laminar flow (Poiseuille flow) in a cylindrical vessel of radius $R$ and length $L$, the volumetric flow rate $Q$ and pressure drop $\\Delta P$ obey $Q = \\dfrac{\\pi R^{4}}{8\\mu L}\\Delta P$, where $\\mu$ is the dynamic viscosity.\n- The wall shear stress (WSS) is defined as $\\tau = \\mu \\left.\\dfrac{dv}{dr}\\right|_{r=R}$, where $v(r)$ is the axial velocity profile. For Poiseuille flow, this yields the well-tested formula $\\tau = \\dfrac{4\\mu Q}{\\pi R^{3}}$.\n- The time-averaged WSS over a uniformly sampled time series $\\{\\tau(t_{k})\\}_{k=1}^{K}$ is $\\overline{\\tau} = \\dfrac{1}{K}\\sum_{k=1}^{K}\\tau(t_{k})$.\n- Pruning criterion: a segment is declared to regress if and only if its time-averaged WSS is strictly less than the pruning threshold $\\tau_{\\mathrm{th}}$ in Pascals. To ensure numerical robustness, use an absolute tolerance $\\varepsilon = 10^{-12}$ Pascal, i.e., declare regression if $\\overline{\\tau} < \\tau_{\\mathrm{th}} - \\varepsilon$.\n\nImplementation details to follow strictly:\n- Inputs are specified per test case as a set of vessel segments indexed $0,1,\\dots,N-1$, each with a radius $r_{i}$ (in meters), a common dynamic viscosity $\\mu$ (in Pascal-second), and a discrete-time flow sequence $Q_{i}(t_{k})$ (in cubic meters per second) sampled at $K$ uniformly spaced instants $t_{1},\\dots,t_{K}$. You must compute $\\tau_{i}(t_{k}) = \\dfrac{4\\mu Q_{i}(t_{k})}{\\pi r_{i}^{3}}$ in Pascals at each time sample, then compute $\\overline{\\tau}_{i}$, and finally apply the pruning rule for each segment.\n- Express all intermediate shear stresses in Pascals, although the final output requires no units.\n- Angles are not involved. No percentages are involved; any ratio is to be handled as a decimal.\n- Output format: for each test case, compute the sorted list of the indices of all regressed segments. Your program should produce a single line of output containing the results as a comma-separated list of these lists, enclosed in square brackets, for example, \"[[0,2],[1],[]]\".\n\nTest suite:\nYou must run your program on the following three test cases, which are designed to reflect flow redistribution from fetal to neonatal states and edge conditions, while remaining purely mathematical and reproducible.\n\n- Test Case 1 (fetal-to-neonatal redistribution with some segments losing flow):\n  - Viscosity: $\\mu = 0.0035$ Pascal-second.\n  - Pruning threshold: $\\tau_{\\mathrm{th}} = 3.0$ Pascal.\n  - Segment radii in meters: $\\big[r_{0}, r_{1}, r_{2}, r_{3}\\big] = \\big[0.0015, 0.0010, 0.0010, 0.0012\\big]$.\n  - Discrete-time flows in cubic meters per second for $K=4$ equally spaced times (two prenatal-like samples followed by two postnatal-like samples):\n    - Segment $0$: $Q_{0}(t) = \\big[5\\times 10^{-6}, 4\\times 10^{-6}, 0, 0\\big]$.\n    - Segment $1$: $Q_{1}(t) = \\big[2.5\\times 10^{-6}, 2.0\\times 10^{-6}, 0, 0\\big]$.\n    - Segment $2$: $Q_{2}(t) = \\big[1\\times 10^{-6}, 2\\times 10^{-6}, 4\\times 10^{-6}, 5\\times 10^{-6}\\big]$.\n    - Segment $3$: $Q_{3}(t) = \\big[3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}\\big]$.\n\n- Test Case 2 (boundary behavior at the threshold):\n  - Viscosity: $\\mu = 0.0035$ Pascal-second.\n  - Pruning threshold: $\\tau_{\\mathrm{th}} = 3.0$ Pascal.\n  - Segment radii in meters: $\\big[r_{0}, r_{1}, r_{2}\\big] = \\big[0.0010, 0.0010, 0.0010\\big]$.\n  - Define $Q_{\\mathrm{th}}$ for a vessel of radius $r = 0.0010$ meters by the identity $\\tau_{\\mathrm{th}} = \\dfrac{4\\mu Q_{\\mathrm{th}}}{\\pi r^{3}}$, i.e.,\n    $$Q_{\\mathrm{th}} = \\dfrac{\\tau_{\\mathrm{th}}\\pi r^{3}}{4\\mu}.$$\n    Now set $K=2$ and flows:\n    - Segment $0$: $Q_{0}(t) = \\big[Q_{\\mathrm{th}}, Q_{\\mathrm{th}}\\big]$.\n    - Segment $1$: $Q_{1}(t) = \\big[0.9\\,Q_{\\mathrm{th}}, 0.9\\,Q_{\\mathrm{th}}\\big]$.\n    - Segment $2$: $Q_{2}(t) = \\big[1.1\\,Q_{\\mathrm{th}}, 0.9\\,Q_{\\mathrm{th}}\\big]$.\n  - By construction, Segment $0$ has $\\overline{\\tau} = \\tau_{\\mathrm{th}}$, Segment $1$ has $\\overline{\\tau} < \\tau_{\\mathrm{th}}$, and Segment $2$ has $\\overline{\\tau} = \\tau_{\\mathrm{th}}$.\n\n- Test Case 3 (edge cases: zero-flow and large-radius effects):\n  - Viscosity: $\\mu = 0.0035$ Pascal-second.\n  - Pruning threshold: $\\tau_{\\mathrm{th}} = 3.0$ Pascal.\n  - Segment radii in meters: $\\big[r_{0}, r_{1}, r_{2}\\big] = \\big[0.0010, 0.0020, 0.0005\\big]$.\n  - Discrete-time flows for $K=4$:\n    - Segment $0$: $Q_{0}(t) = \\big[0, 0, 0, 0\\big]$.\n    - Segment $1$: $Q_{1}(t) = \\big[3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}\\big]$.\n    - Segment $2$: $Q_{2}(t) = \\big[1\\times 10^{-6}, 1\\times 10^{-6}, 1\\times 10^{-6}, 1\\times 10^{-6}\\big]$.\n\nYour program must compute, for each test case, the indices of regressed segments as a sorted list of integers and output all three lists aggregated as a single list in one line, for example:\n- If the first case yields segments $\\big[0,2\\big]$, the second yields $\\big[1\\big]$, and the third yields $\\big[0\\big]$, then the program must print \"[[0,2],[1],[0]]\" and nothing else.", "solution": "The problem is valid as it is scientifically grounded in fundamental principles of fluid dynamics, is well-posed with a complete and consistent set of definitions and data, and is expressed in objective, formal language. A unique solution can be deterministically computed.\n\nThe solution is derived from a mechanobiological model where vessel regression is driven by low wall shear stress (WSS). The model is based on the principles of steady, laminar, incompressible flow (Poiseuille flow) within cylindrical vessels.\n\nThe governing equation for wall shear stress, $\\tau$, in a vessel of radius $R$ experiencing a volumetric flow rate $Q$ is given by:\n$$ \\tau = \\dfrac{4\\mu Q}{\\pi R^{3}} $$\nwhere $\\mu$ is the dynamic viscosity of the fluid.\n\nThe biological hypothesis is that a vessel regresses if the time-averaged wall shear stress, $\\overline{\\tau}$, falls below a critical threshold, $\\tau_{\\mathrm{th}}$. For a discrete time series of $K$ flow measurements $Q(t_k)$, the time-averaged WSS is calculated as:\n$$ \\overline{\\tau} = \\dfrac{1}{K}\\sum_{k=1}^{K}\\tau(t_{k}) = \\dfrac{1}{K}\\sum_{k=1}^{K} \\dfrac{4\\mu Q(t_{k})}{\\pi R^{3}} $$\nThis expression can be simplified by factoring out the constant terms and recognizing the average of the flow rates, $\\overline{Q}$:\n$$ \\overline{\\tau} = \\dfrac{4\\mu}{\\pi R^{3}} \\left( \\dfrac{1}{K}\\sum_{k=1}^{K} Q(t_{k}) \\right) = \\dfrac{4\\mu \\overline{Q}}{\\pi R^{3}} $$\nThis form is computationally efficient and less prone to floating-point error accumulation than summing individual stress values.\n\nThe pruning criterion is applied to each vessel segment $i$ with radius $r_i$ and time-averaged WSS $\\overline{\\tau}_i$. The segment regresses if its average WSS is strictly less than the threshold $\\tau_{\\mathrm{th}}$. To handle floating-point comparisons robustly, we declare regression if $\\overline{\\tau}_i < \\tau_{\\mathrm{th}} - \\varepsilon$, where $\\varepsilon = 10^{-12} \\, \\text{Pascals}$. The indices of all regressed segments for each test case are collected into a sorted list.\n\nWe now apply this procedure to each test case.\n\n**Test Case 1**\nParameters: $\\mu = 0.0035 \\, \\text{Pa}\\cdot\\text{s}$, $\\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$, $K=4$.\nThe radii are $[r_0, r_1, r_2, r_3] = [0.0015, 0.0010, 0.0010, 0.0012] \\, \\text{m}$.\n\n- **Segment 0**: $r_0 = 0.0015 \\, \\text{m}$.\n  Flows: $Q_0(t) = [5 \\times 10^{-6}, 4 \\times 10^{-6}, 0, 0] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_0 = \\frac{1}{4}(5+4+0+0) \\times 10^{-6} = 2.25 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_0 = \\dfrac{4(0.0035)(2.25 \\times 10^{-6})}{\\pi (0.0015)^3} \\approx 2.97089 \\, \\text{Pa}$.\n  Since $2.97089 < 3.0 - 10^{-12}$, segment $0$ regresses.\n\n- **Segment 1**: $r_1 = 0.0010 \\, \\text{m}$.\n  Flows: $Q_1(t) = [2.5 \\times 10^{-6}, 2.0 \\times 10^{-6}, 0, 0] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_1 = \\frac{1}{4}(2.5+2.0+0+0) \\times 10^{-6} = 1.125 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_1 = \\dfrac{4(0.0035)(1.125 \\times 10^{-6})}{\\pi (0.0010)^3} \\approx 5.01338 \\, \\text{Pa}$.\n  Since $5.01338 \\not< 3.0 - 10^{-12}$, segment $1$ does not regress.\n\n- **Segment 2**: $r_2 = 0.0010 \\, \\text{m}$.\n  Flows: $Q_2(t) = [1 \\times 10^{-6}, 2 \\times 10^{-6}, 4 \\times 10^{-6}, 5 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_2 = \\frac{1}{4}(1+2+4+5) \\times 10^{-6} = 3.0 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_2 = \\dfrac{4(0.0035)(3.0 \\times 10^{-6})}{\\pi (0.0010)^3} \\approx 13.369 \\, \\text{Pa}$.\n  Since $13.369 \\not< 3.0 - 10^{-12}$, segment $2$ does not regress.\n\n- **Segment 3**: $r_3 = 0.0012 \\, \\text{m}$.\n  Flows: $Q_3(t) = [3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_3 = 3.0 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_3 = \\dfrac{4(0.0035)(3.0 \\times 10^{-6})}{\\pi (0.0012)^3} \\approx 7.7367 \\, \\text{Pa}$.\n  Since $7.7367 \\not< 3.0 - 10^{-12}$, segment $3$ does not regress.\n\nResult for Test Case 1: $[0]$.\n\n**Test Case 2**\nParameters: $\\mu = 0.0035 \\, \\text{Pa}\\cdot\\text{s}$, $\\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$, $K=2$.\nAll segments have radius $r = 0.0010 \\, \\text{m}$. The flow is defined relative to $Q_{\\mathrm{th}}$, the flow that produces exactly $\\tau_{\\mathrm{th}}$:\n$$ Q_{\\mathrm{th}} = \\dfrac{\\tau_{\\mathrm{th}}\\pi r^{3}}{4\\mu} = \\dfrac{3.0 \\cdot \\pi \\cdot (0.0010)^3}{4 \\cdot 0.0035} \\approx 6.73198 \\times 10^{-7} \\, \\text{m}^3/\\text{s} $$\nFor a flow $Q = c \\cdot Q_{\\mathrm{th}}$, the WSS is $\\tau = c \\cdot \\tau_{\\mathrm{th}}$. Therefore, the average WSS $\\overline{\\tau}$ is simply $\\overline{c} \\cdot \\tau_{\\mathrm{th}}$, where $\\overline{c}$ is the average of the flow coefficients.\n\n- **Segment 0**: Flows $Q_0(t) = [1.0 \\cdot Q_{\\mathrm{th}}, 1.0 \\cdot Q_{\\mathrm{th}}]$. Average coefficient $\\overline{c}_0 = 1.0$.\n  Average WSS: $\\overline{\\tau}_0 = 1.0 \\cdot \\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$.\n  Since $3.0 \\not< 3.0 - 10^{-12}$, segment $0$ does not regress.\n\n- **Segment 1**: Flows $Q_1(t) = [0.9 \\cdot Q_{\\mathrm{th}}, 0.9 \\cdot Q_{\\mathrm{th}}]$. Average coefficient $\\overline{c}_1 = 0.9$.\n  Average WSS: $\\overline{\\tau}_1 = 0.9 \\cdot \\tau_{\\mathrm{th}} = 2.7 \\, \\text{Pa}$.\n  Since $2.7 < 3.0 - 10^{-12}$, segment $1$ regresses.\n\n- **Segment 2**: Flows $Q_2(t) = [1.1 \\cdot Q_{\\mathrm{th}}, 0.9 \\cdot Q_{\\mathrm{th}}]$. Average coefficient $\\overline{c}_2 = \\frac{1.1+0.9}{2} = 1.0$.\n  Average WSS: $\\overline{\\tau}_2 = 1.0 \\cdot \\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$.\n  Since $3.0 \\not< 3.0 - 10^{-12}$, segment $2$ does not regress.\n\nResult for Test Case 2: $[1]$.\n\n**Test Case 3**\nParameters: $\\mu = 0.0035 \\, \\text{Pa}\\cdot\\text{s}$, $\\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$, $K=4$.\nThe radii are $[r_0, r_1, r_2] = [0.0010, 0.0020, 0.0005] \\, \\text{m}$.\n\n- **Segment 0**: $r_0 = 0.0010 \\, \\text{m}$.\n  Flows: $Q_0(t) = [0, 0, 0, 0] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_0 = 0 \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_0 = 0 \\, \\text{Pa}$.\n  Since $0 < 3.0 - 10^{-12}$, segment $0$ regresses.\n\n- **Segment 1**: $r_1 = 0.0020 \\, \\text{m}$.\n  Flows: $Q_1(t) = [3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_1 = 3 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_1 = \\dfrac{4(0.0035)(3 \\times 10^{-6})}{\\pi (0.0020)^3} \\approx 1.67113 \\, \\text{Pa}$.\n  Since $1.67113 < 3.0 - 10^{-12}$, segment $1$ regresses.\n\n- **Segment 2**: $r_2 = 0.0005 \\, \\text{m}$.\n  Flows: $Q_2(t) = [1 \\times 10^{-6}, 1 \\times 10^{-6}, 1 \\times 10^{-6}, 1 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$.\n  Average flow: $\\overline{Q}_2 = 1 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$.\n  Average WSS: $\\overline{\\tau}_2 = \\dfrac{4(0.0035)(1 \\times 10^{-6})}{\\pi (0.0005)^3} \\approx 35.6507 \\, \\text{Pa}$.\n  Since $35.6507 \\not< 3.0 - 10^{-12}$, segment $2$ does not regress.\n\nResult for Test Case 3: $[0, 1]$.\n\nAggregating the results from all test cases yields the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vessel pruning problem for the three specified test cases.\n    \"\"\"\n\n    # Define the numerical tolerance for the pruning criterion\n    epsilon = 1e-12\n\n    # A helper function to process a single test case\n    def process_case(mu, tau_th, radii, flows):\n        \"\"\"\n        Calculates which segments regress for a given test case.\n        \n        Args:\n            mu (float): Dynamic viscosity.\n            tau_th (float): Pruning threshold for wall shear stress.\n            radii (np.ndarray): Array of segment radii.\n            flows (np.ndarray): 2D array of flow time series for each segment.\n        \n        Returns:\n            list: A sorted list of indices of regressed segments.\n        \"\"\"\n        regressed_indices = []\n        num_segments = len(radii)\n\n        for i in range(num_segments):\n            r = radii[i]\n            Q_series = flows[i, :]\n            \n            # Calculate average flow rate\n            avg_Q = np.mean(Q_series)\n            \n            # Calculate average wall shear stress using the formula:\n            # avg_tau = (4 * mu * avg_Q) / (pi * r^3)\n            # Handle division by zero for r=0, though not in test data.\n            if r == 0:\n                # Assuming infinite stress if radius is zero and flow is non-zero,\n                # and zero stress if flow is zero. This case is not in the problem spec.\n                avg_tau = 0.0 if avg_Q == 0 else float('inf')\n            else:\n                avg_tau = (4 * mu * avg_Q) / (np.pi * r**3)\n            \n            # Apply pruning criterion with numerical tolerance\n            if avg_tau < tau_th - epsilon:\n                regressed_indices.append(i)\n        \n        return sorted(regressed_indices)\n\n    # --- Test Case 1 Data ---\n    mu1 = 0.0035\n    tau_th1 = 3.0\n    radii1 = np.array([0.0015, 0.0010, 0.0010, 0.0012])\n    flows1 = np.array([\n        [5e-6, 4e-6, 0.0, 0.0],\n        [2.5e-6, 2.0e-6, 0.0, 0.0],\n        [1e-6, 2e-6, 4e-6, 5e-6],\n        [3e-6, 3e-6, 3e-6, 3e-6]\n    ])\n\n    # --- Test Case 2 Data ---\n    mu2 = 0.0035\n    tau_th2 = 3.0\n    radii2 = np.array([0.0010, 0.0010, 0.0010])\n    # Calculate Q_th as defined in the problem\n    r_for_Qth = 0.0010\n    Q_th = (tau_th2 * np.pi * r_for_Qth**3) / (4 * mu2)\n    flows2 = np.array([\n        [Q_th, Q_th],\n        [0.9 * Q_th, 0.9 * Q_th],\n        [1.1 * Q_th, 0.9 * Q_th]\n    ])\n\n    # --- Test Case 3 Data ---\n    mu3 = 0.0035\n    tau_th3 = 3.0\n    radii3 = np.array([0.0010, 0.0020, 0.0005])\n    flows3 = np.array([\n        [0.0, 0.0, 0.0, 0.0],\n        [3e-6, 3e-6, 3e-6, 3e-6],\n        [1e-6, 1e-6, 1e-6, 1e-6]\n    ])\n\n    # Encapsulate test cases for processing\n    test_cases = [\n        (mu1, tau_th1, radii1, flows1),\n        (mu2, tau_th2, radii2, flows2),\n        (mu3, tau_th3, radii3, flows3)\n    ]\n    \n    all_results = []\n    for case_params in test_cases:\n        result = process_case(*case_params)\n        all_results.append(result)\n\n    # Format the final output string as specified\n    # Example format: \"[[0,2],[1],[]]\"\n    result_strings = [str(res).replace(\" \", \"\") for res in all_results]\n    output_string = f\"[{','.join(result_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```", "id": "4881757"}]}