{"hands_on_practices": [{"introduction": "Type I hypersensitivity reactions, like those in common allergies, are known for their startling speed. This exercise moves beyond a qualitative description of mast cell degranulation to build a quantitative, real-time model of the trigger event. By applying the principles of chemical kinetics to the binding of an allergen to Immunoglobulin E (IgE) on a mast cell, you will derive and calculate the precise time required to reach the degranulation threshold, providing a concrete link between molecular binding rates and the rapid onset of allergic symptoms [@problem_id:4964937].", "problem": "A patient with a history of atopy experiences a rapid-onset Type I hypersensitivity reaction mediated by Immunoglobulin E (IgE). In the tissue, mast cells display IgE bound to the high-affinity Fc epsilon receptor I ($Fc\\varepsilon RI$). A multivalent allergen suddenly diffuses into the tissue and maintains a constant extracellular concentration. Crosslinking of IgE-$Fc\\varepsilon RI$ by the allergen initiates degranulation. For this scenario, assume the following biophysically grounded approximation: degranulation is reliably triggered once the fraction of $Fc\\varepsilon RI$-bound IgE occupied by allergen reaches a threshold fraction $p_{\\text{th}}$, reflecting that sufficient crosslinking occurs when occupancy is high enough. At time $t=0$, the allergen concentration jumps and then remains constant, and all receptors are initially unoccupied.\n\nUse the mass-action law for receptor-ligand binding at a constant ligand concentration as your starting point. The allergen concentration is $C = 5.0 \\times 10^{-9}$ M. The association (on) rate constant for allergen binding to receptor-bound IgE is $k_{\\mathrm{on}} = 2.0 \\times 10^{5}$ M$^{-1}$ s$^{-1}$, and the dissociation (off) rate constant is $k_{\\mathrm{off}} = 2.0 \\times 10^{-3}$ s$^{-1}$. The degranulation threshold is $p_{\\text{th}} = 0.25$. Assume a well-mixed environment, constant $C$ over time, and that occupation dynamics follow a single-site reversible binding process for each receptor.\n\nDerive, from first principles, the time $t^{\\ast}$ required for the receptor occupancy to reach $p_{\\text{th}}$ and compute its numerical value. Express the final time in seconds, and round your answer to four significant figures.", "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in the principles of chemical kinetics and immunology, is well-posed with sufficient information and a clear objective, and is free from any disqualifying flaws.\n\nThe problem asks for the time, $t^{\\ast}$, required for a fraction of receptors, $p(t)$, to reach a threshold value, $p_{\\text{th}}$, following the introduction of a constant concentration of ligand (allergen). The binding is modeled as a single-site, reversible process.\n\nLet $R$ denote the unbound IgE-$Fc\\varepsilon RI$ complex and $A$ denote the allergen. The formation of the allergen-bound complex, $RA$, is described by the reaction:\n$$ R + A \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} RA $$\nwhere $k_{\\mathrm{on}}$ is the association rate constant and $k_{\\mathrm{off}}$ is the dissociation rate constant.\n\nThe rate of change of the concentration of the bound complex, $[RA]$, is given by the law of mass action:\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}[R][A] - k_{\\mathrm{off}}[RA] $$\nThe problem states that the allergen concentration is constant, so we set $[A] = C$.\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}C[R] - k_{\\mathrm{off}}[RA] $$\nThe total concentration of receptors, $[R_T]$, is constant and is the sum of the concentrations of unbound and bound receptors: $[R_T] = [R] + [RA]$. Thus, we can express $[R]$ as $[R] = [R_T] - [RA]$. Substituting this into the rate equation gives:\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}C([R_T] - [RA]) - k_{\\mathrm{off}}[RA] $$\nThe fractional occupancy of the receptors is defined as $p(t) = \\frac{[RA]}{[R_T]}$. From this, we have $[RA] = p(t)[R_T]$. Differentiating with respect to time, and noting that $[R_T]$ is constant, we get $\\frac{d[RA]}{dt} = [R_T]\\frac{dp}{dt}$.\n\nSubstituting these expressions for $[RA]$ and its derivative into the rate equation:\n$$ [R_T]\\frac{dp}{dt} = k_{\\mathrm{on}}C([R_T] - p(t)[R_T]) - k_{\\mathrm{off}}(p(t)[R_T]) $$\nThe total receptor concentration, $[R_T]$, is a common factor and can be canceled from the equation:\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C(1 - p) - k_{\\mathrm{off}}p $$\nThis is a first-order linear ordinary differential equation for the fractional occupancy $p(t)$. We can rearrange it by grouping terms involving $p$:\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C - (k_{\\mathrm{on}}C + k_{\\mathrm{off}})p $$\nLet us define the observed pseudo-first-order rate constant, $k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}}$. The equation becomes:\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C - k_{\\mathrm{obs}}p $$\nAt equilibrium ($t \\to \\infty$), the net rate is zero ($\\frac{dp}{dt} = 0$), and the occupancy reaches its equilibrium value, $p_{\\mathrm{eq}}$.\n$$ 0 = k_{\\mathrm{on}}C - k_{\\mathrm{obs}}p_{\\mathrm{eq}} \\implies p_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{obs}}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} $$\nWe can rewrite the differential equation in terms of $p_{\\mathrm{eq}}$ and $k_{\\mathrm{obs}}$:\n$$ \\frac{dp}{dt} = k_{\\mathrm{obs}}p_{\\mathrm{eq}} - k_{\\mathrm{obs}}p = -k_{\\mathrm{obs}}(p - p_{\\mathrm{eq}}) $$\nTo solve this equation, we use separation of variables, with the initial condition that at $t=0$, the receptors are unoccupied, i.e., $p(0)=0$.\n$$ \\int_{p(0)}^{p(t)} \\frac{dp'}{p' - p_{\\mathrm{eq}}} = \\int_{0}^{t} -k_{\\mathrm{obs}} dt' $$\n$$ \\int_{0}^{p(t)} \\frac{dp'}{p' - p_{\\mathrm{eq}}} = -k_{\\mathrm{obs}} t $$\n$$ \\left[ \\ln|p' - p_{\\mathrm{eq}}| \\right]_{0}^{p(t)} = -k_{\\mathrm{obs}} t $$\n$$ \\ln|p(t) - p_{\\mathrm{eq}}| - \\ln|-p_{\\mathrm{eq}}| = -k_{\\mathrm{obs}} t $$\nSince $p(t) < p_{\\mathrm{eq}}$ for any finite time $t$, $|p(t) - p_{\\mathrm{eq}}| = p_{\\mathrm{eq}} - p(t)$.\n$$ \\ln\\left(\\frac{p_{\\mathrm{eq}} - p(t)}{p_{\\mathrm{eq}}}\\right) = -k_{\\mathrm{obs}}t $$\n$$ \\ln\\left(1 - \\frac{p(t)}{p_{\\mathrm{eq}}}\\right) = -k_{\\mathrm{obs}}t $$\nSolving for $p(t)$:\n$$ 1 - \\frac{p(t)}{p_{\\mathrm{eq}}} = \\exp(-k_{\\mathrm{obs}}t) $$\n$$ p(t) = p_{\\mathrm{eq}}\\left(1 - \\exp(-k_{\\mathrm{obs}}t)\\right) $$\nWe need to find the time $t^{\\ast}$ at which $p(t^{\\ast}) = p_{\\mathrm{th}}$.\n$$ p_{\\mathrm{th}} = p_{\\mathrm{eq}}\\left(1 - \\exp(-k_{\\mathrm{obs}}t^{\\ast})\\right) $$\nSolving for $t^{\\ast}$:\n$$ \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}} = 1 - \\exp(-k_{\\mathrm{obs}}t^{\\ast}) $$\n$$ \\exp(-k_{\\mathrm{obs}}t^{\\ast}) = 1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}} $$\n$$ -k_{\\mathrm{obs}}t^{\\ast} = \\ln\\left(1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}}\\right) $$\n$$ t^{\\ast} = -\\frac{1}{k_{\\mathrm{obs}}} \\ln\\left(1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}}\\right) $$\nThis is the symbolic expression for the time to reach the threshold.\n\nNow, we substitute the given numerical values:\n$C = 5.0 \\times 10^{-9}$ M\n$k_{\\mathrm{on}} = 2.0 \\times 10^{5}$ M$^{-1}$ s$^{-1}$\n$k_{\\mathrm{off}} = 2.0 \\times 10^{-3}$ s$^{-1}$\n$p_{\\mathrm{th}} = 0.25$\n\nFirst, we compute the intermediate terms $k_{\\mathrm{obs}}$ and $p_{\\mathrm{eq}}$.\nThe product $k_{\\mathrm{on}}C$ is:\n$$ k_{\\mathrm{on}}C = (2.0 \\times 10^{5} \\, \\mathrm{M}^{-1}\\mathrm{s}^{-1}) \\times (5.0 \\times 10^{-9} \\, \\mathrm{M}) = 10.0 \\times 10^{-4} \\, \\mathrm{s}^{-1} = 1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1} $$\nThe observed rate constant $k_{\\mathrm{obs}}$ is:\n$$ k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}} = (1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}) + (2.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}) = 3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1} $$\nThe equilibrium fractional occupancy $p_{\\mathrm{eq}}$ is:\n$$ p_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} = \\frac{1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}}{3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}} = \\frac{1}{3} $$\nThe threshold occupancy is $p_{\\mathrm{th}}=0.25 = \\frac{1}{4}$. Since $p_{\\mathrm{th}} < p_{\\mathrm{eq}}$ (i.e., $\\frac{1}{4} < \\frac{1}{3}$), the threshold will be reached in finite time.\n\nNow, we compute $t^{\\ast}$:\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}} \\ln\\left(1 - \\frac{1/4}{1/3}\\right) $$\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3}} \\ln\\left(1 - \\frac{3}{4}\\right) \\, \\mathrm{s} $$\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3}} \\ln\\left(\\frac{1}{4}\\right) \\, \\mathrm{s} $$\nUsing the identity $\\ln(1/x) = -\\ln(x)$, we have $\\ln(1/4) = -\\ln(4)$.\n$$ t^{\\ast} = \\frac{1}{3.0 \\times 10^{-3}} \\ln(4) \\, \\mathrm{s} $$\n$$ t^{\\ast} = \\frac{\\ln(2^2)}{3.0 \\times 10^{-3}} \\, \\mathrm{s} = \\frac{2\\ln(2)}{3.0 \\times 10^{-3}} \\, \\mathrm{s} $$\nUsing the value $\\ln(2) \\approx 0.693147$:\n$$ t^{\\ast} \\approx \\frac{2 \\times 0.693147}{3.0 \\times 10^{-3}} \\, \\mathrm{s} = \\frac{1.386294}{3.0 \\times 10^{-3}} \\, \\mathrm{s} \\approx 462.098 \\, \\mathrm{s} $$\nRounding the result to four significant figures, as requested:\n$$ t^{\\ast} \\approx 462.1 \\, \\mathrm{s} $$", "answer": "$$\\boxed{462.1}$$", "id": "4964937"}, {"introduction": "In Type II hypersensitivity, antibodies mistakenly target our own cells for destruction, a process often mediated by the complement system. Activation of the classical complement pathway is not triggered by a single antibody binding, but rather requires a critical cluster of antibodies on the cell surface. This practice explores the probabilistic nature of this destructive event, challenging you to combine equilibrium binding theory with binomial statistics to predict the fraction of cells that will be lysed, thereby illustrating how molecular affinity and concentration translate into a population-level pathological outcome [@problem_id:4964883].", "problem": "A patient develops drug-induced hemolytic anemia consistent with Type II (antibody-mediated cytotoxicity) hypersensitivity after exposure to a beta-lactam antibiotic that haptenates erythrocyte membranes. In a controlled in vitro assay at equilibrium, each Red Blood Cell (RBC) bears exactly $N = 10$ identical haptenated sites that are recognized by circulating Immunoglobulin G (IgG). The anti-drug IgG has an equilibrium dissociation constant $K_{D} = 10\\,\\text{nM}$ for each site, and the total IgG concentration in plasma is $[\\text{IgG}]_{\\text{tot}} = 5\\,\\text{nM}$. The RBC concentration is sufficiently low that the free IgG concentration remains approximately equal to the total IgG concentration (that is, $[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}}$). Assume all sites are equivalent and bind independently.\n\nThe classical complement pathway is assumed to lyse an RBC within the assay time if and only if at least two IgG molecules are simultaneously bound to that RBCâ€™s surface (that is, two or more occupied sites on the same RBC suffice to trigger C1q engagement and membrane attack complex formation on the timescale of the assay).\n\nStarting only from the law of mass action for ligand-receptor binding at equilibrium and the definition of independent Bernoulli trials over $N$ sites, derive an expression for the expected fraction of RBCs that undergo complement-mediated lysis in this assay, and evaluate it numerically for the parameters above. Express your final answer as a dimensionless decimal fraction rounded to four significant figures.", "solution": "The scenario can be modeled using equilibrium ligand binding for Immunoglobulin G (IgG) to $N$ identical, independent sites on each Red Blood Cell (RBC), along with the probabilistic requirement for classical complement activation. The fundamental starting points are:\n\n1. Law of mass action for a single site: for the reversible binding reaction $\\text{IgG} + \\text{Site} \\rightleftharpoons \\text{IgG}\\text{-Site}$ at equilibrium, the dissociation constant $K_{D}$ is defined by\n$$\nK_{D} = \\frac{[\\text{IgG}]_{\\text{free}} \\,[\\text{Site}]_{\\text{free}}}{[\\text{IgG}\\text{-Site}]}.\n$$\nFor a single site, the fractional occupancy $\\theta$ (the probability that a given site is bound) under equilibrium is given by the well-tested relation\n$$\n\\theta = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}}.\n$$\n\n2. Independent identical binding sites on an RBC imply that the number of bound IgG molecules per RBC follows a binomial distribution with parameters $N$ and $p$, where $p$ is the per-site binding probability:\n$$\np = \\theta = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}}.\n$$\n\n3. The classical complement requirement in this assay is that an RBC is lysed if and only if at least two IgG molecules are bound to it. Therefore, the probability that an RBC is lysed equals the binomial probability of having at least two successes (bound sites) among $N$ trials with success probability $p$:\n$$\nP(\\text{lysis}) = \\sum_{k=2}^{N} \\binom{N}{k} p^{k} (1-p)^{N-k} = 1 - \\left[ \\binom{N}{0} p^{0} (1-p)^{N} + \\binom{N}{1} p^{1} (1-p)^{N-1} \\right].\n$$\nThis simplifies to\n$$\nP(\\text{lysis}) = 1 - \\left[ (1-p)^{N} + N p (1-p)^{N-1} \\right].\n$$\n\nWe now evaluate $p$ from the binding equilibrium using the given parameters. The assumption $[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}}$ is justified by the low RBC concentration relative to the IgG pool, so\n$$\n[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}} = 5\\,\\text{nM}, \\quad K_{D} = 10\\,\\text{nM}.\n$$\nThus,\n$$\np = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}} = \\frac{5}{10 + 5} = \\frac{5}{15} = \\frac{1}{3}.\n$$\n\nWith $N = 10$ and $p = \\frac{1}{3}$, the exact expression for the lysis probability becomes\n$$\nP(\\text{lysis}) = 1 - \\left[ \\left(1 - \\frac{1}{3}\\right)^{10} + 10 \\cdot \\frac{1}{3} \\left(1 - \\frac{1}{3}\\right)^{9} \\right]\n= 1 - \\left[ \\left(\\frac{2}{3}\\right)^{10} + \\frac{10}{3} \\left(\\frac{2}{3}\\right)^{9} \\right].\n$$\nWe can place all terms over a common denominator $3^{10}$:\n$$\n\\left(\\frac{2}{3}\\right)^{10} = \\frac{2^{10}}{3^{10}} = \\frac{1024}{59049}, \\quad\n\\frac{10}{3} \\left(\\frac{2}{3}\\right)^{9} = \\frac{10 \\cdot 2^{9}}{3^{10}} = \\frac{5120}{59049}.\n$$\nHence,\n$$\nP(\\text{lysis}) = 1 - \\frac{1024 + 5120}{59049} = 1 - \\frac{6144}{59049} = \\frac{59049 - 6144}{59049} = \\frac{52905}{59049}.\n$$\nThis fraction simplifies by a factor of $3$:\n$$\nP(\\text{lysis}) = \\frac{17635}{19683}.\n$$\nFor a numerical value,\n$$\nP(\\text{lysis}) \\approx 0.8959508\\ldots\n$$\nRounded to four significant figures as a dimensionless decimal fraction,\n$$\nP(\\text{lysis}) \\approx 0.8960.\n$$\n\nTherefore, the expected fraction of Red Blood Cells that undergo complement-mediated lysis under the stated conditions is $0.8960$ when rounded to four significant figures.", "answer": "$$\\boxed{0.8960}$$", "id": "4964883"}, {"introduction": "Autoimmune diseases are often chronic and progressive, a feature driven by a phenomenon known as \"epitope spreading,\" where the immune response broadens to attack an ever-wider array of self-antigens. This complex feedback loop can be difficult to grasp intuitively. In this capstone exercise, you will construct a computational model from first principles to simulate the dynamics of epitope spreading over time, offering a powerful, hands-on method for understanding how a contained autoimmune response can evolve into a systemic disease [@problem_id:4964942].", "problem": "You are asked to formalize a principled quantitative model of autoantigen generation and epitope spreading, derive the expected discrete-time update from foundational immunology and probability, and implement it to compute the expected number of distinct self-epitopes recognized by the adaptive immune system over successive inflammatory cycles. The model must be grounded in the following base definitions and well-tested facts: epitope spreading is the process by which an immune response initially focused on a limited set of epitopes expands to include additional epitopes due to ongoing tissue damage and antigen processing; clonal selection requires antigen recognition in an activating context; linearity of expectation permits additive decomposition of expected counts; and a finite antigen pool limits the number of novel epitopes that can be recognized.\n\nAssumptions and definitions:\n- There exists a finite pool of potential self-epitopes in the target tissue of size $M$. This represents all distinct epitopes that could in principle be recognized under the inflammatory context considered.\n- At discrete cycle $t$, let $n_t$ denote the expected number of unique self-epitopes currently recognized (actively targeted).\n- Each recognized epitope contributes to tissue damage and antigen release; per cycle, per recognized epitope, an average of $r$ new candidate epitopes are released or revealed (autoantigen generation) to the antigen processing pathways.\n- For each newly released candidate epitope, the independent probability that it is processed, presented, and breaks tolerance to be added to the recognized set is $p$. A regulatory control parameter $c \\in [0,1]$ scales the effective activation probability to $p_{\\mathrm{eff}} = (1 - c)\\,p$, reflecting suppression when $c$ is close to $1$.\n- Only previously unrecognized epitopes can be added. Under a finite pool constraint, the expected fraction of released candidates that are novel at cycle $t$ is $\\frac{M - n_t}{M}$.\n- You should assume independence of candidate evaluations and apply linearity of expectation to obtain a deterministic expected-value update. The expected count must remain in the closed interval $[0,M]$ for all cycles.\n\nTask:\n1. From the stated assumptions, logically derive the deterministic discrete-time expectation update for $n_{t+1}$ from $n_t$, in terms of $M$, $r$, $p$, $c$, and $n_t$, without introducing any unstated parameters.\n2. Implement a program that:\n   - Initializes $n_0$ as given.\n   - Iterates the derived expected-value update for exactly $T$ cycles to obtain $n_T$ for each test case below.\n   - Ensures that the expected count remains within $[0,M]$ at every step by appropriate clamping if needed due to floating-point arithmetic.\n   - Produces results as real numbers rounded to exactly $3$ decimal places.\n\nTest suite:\nCompute $n_T$ for each parameter set $(M, n_0, r, p, c, T)$ listed below:\n- Case A: $M=100$, $n_0=1$, $r=3$, $p=0.1$, $c=0.2$, $T=10$.\n- Case B: $M=50$, $n_0=5$, $r=0$, $p=0.5$, $c=0.0$, $T=20$.\n- Case C: $M=5$, $n_0=1$, $r=5$, $p=0.8$, $c=0.0$, $T=10$.\n- Case D: $M=1000$, $n_0=10$, $r=0.05$, $p=0.02$, $c=0.5$, $T=50$.\n- Case E: $M=20$, $n_0=20$, $r=10$, $p=1.0$, $c=0.0$, $T=100$.\n- Case F: $M=200$, $n_0=2$, $r=1.5$, $p=0.2$, $c=1.0$, $T=15$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,\\dots,x_6]$), where each $x_i$ is the computed $n_T$ for the corresponding case rounded to exactly $3$ decimal places. No other output should be produced. There are no physical units in this problem, and answers are real numbers (floats).", "solution": "The problem is assessed to be valid as it is scientifically grounded in immunological principles, mathematically well-posed, objective, and contains a complete and consistent set of definitions and parameters. It represents a formalizable quantitative modeling task that is directly relevant to the specified topic.\n\n### Part 1: Derivation of the Discrete-Time Expectation Update\n\nThe objective is to derive the update rule for $n_{t+1}$, the expected number of unique self-epitopes recognized at cycle $t+1$, as a function of $n_t$, the number at cycle $t$. We shall proceed step-by-step from the provided assumptions, applying the principle of linearity of expectation.\n\n1.  **Expected Number of Recognized Epitopes at Cycle $t$**: Let this be denoted by $n_t$. This is the state variable of our system.\n\n2.  **Total Expected Autoantigen Generation**: The problem states that each of the $n_t$ recognized epitopes contributes to tissue damage, which in turn leads to the release or revelation of new candidate epitopes. On average, $r$ new candidates are generated per recognized epitope per cycle. By linearity of expectation, the total expected number of candidate epitopes generated in cycle $t$ is the product of the number of recognized epitopes and the rate of generation per epitope:\n    $$ E[\\text{candidates generated}] = n_t \\times r $$\n\n3.  **Fraction of Novel Candidates**: The total pool of potential self-epitopes is finite, with size $M$. At cycle $t$, $n_t$ of these are already recognized. The number of unrecognized, or \"novel,\" epitopes is therefore $M - n_t$. The problem provides the assumption that the expected fraction of released candidates that are novel is given by:\n    $$ \\text{Fraction}_{\\text{novel}} = \\frac{M - n_t}{M} = 1 - \\frac{n_t}{M} $$\n    This assumes that the generated candidate epitopes are a representative sample of the entire epitope pool.\n\n4.  **Expected Number of Novel Candidates**: To find the expected number of novel candidates generated in cycle $t$, we multiply the total number of generated candidates by the fraction that are expected to be novel:\n    $$ E[\\text{novel candidates}] = (n_t r) \\times \\left( \\frac{M - n_t}{M} \\right) $$\n\n5.  **Probability of Breaking Tolerance**: Each novel candidate epitope must be processed, presented by an antigen-presenting cell, and recognized by a T or B cell clone in a context that breaks self-tolerance. The base probability for this sequence of events is $p$. This probability is modulated by a regulatory control parameter $c \\in [0, 1]$, where $c \\approx 1$ implies strong suppression. The effective probability, $p_{\\mathrm{eff}}$, is given as:\n    $$ p_{\\mathrm{eff}} = (1 - c) p $$\n\n6.  **Expected Number of Newly Recognized Epitopes**: Assuming the process of breaking tolerance for each novel candidate is an independent event, we can again apply linearity of expectation. The expected number of novel epitopes that are newly added to the recognized set, denoted $\\Delta n_t$, is the expected number of novel candidates multiplied by the effective probability of recognition:\n    $$ \\Delta n_t = E[\\text{newly recognized}] = E[\\text{novel candidates}] \\times p_{\\mathrm{eff}} $$\n    Substituting the expressions from steps 4 and 5:\n    $$ \\Delta n_t = \\left( n_t r \\frac{M - n_t}{M} \\right) \\times (1 - c) p $$\n\n7.  **The Update Equation**: The expected number of recognized epitopes at cycle $t+1$, denoted $n_{t+1}$, is the sum of those already recognized at cycle $t$ and the expected number of newly recognized epitopes during that cycle:\n    $$ n_{t+1} = n_t + \\Delta n_t $$\n    Substituting the full expression for $\\Delta n_t$ yields the final deterministic discrete-time update equation:\n    $$ n_{t+1} = n_t + n_t r \\left( \\frac{M - n_t}{M} \\right) p (1 - c) $$\n    This can be rewritten in a form similar to the discrete logistic equation:\n    $$ n_{t+1} = n_t + r p (1 - c) n_t \\left(1 - \\frac{n_t}{M}\\right) $$\n    This equation describes the evolution of the expected number of recognized epitopes over discrete time cycles. The model's constraints require that $n_t \\in [0, M]$. If the parameters lead to a value of $n_{t+1}$ outside this range, it must be clamped. Specifically, if the calculated $n_{t+1}$ exceeds $M$, it is set to $M$, representing saturation of the epitope pool. If it falls below $0$ (possible only through floating-point error, as the increment is non-negative for $n_t \\in [0,M]$), it is set to $0$.\n\n### Part 2: Implementation\n\nThe derived update rule is implemented in a program that iterates for $T$ cycles for each given parameter set. The state variable $n_t$ is initialized with $n_0$ and updated according to the formula. At each step, the value is clamped to the interval $[0, M]$. The final value $n_T$ is rounded to $3$ decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the expected number of distinct self-epitopes recognized by the\n    adaptive immune system over T inflammatory cycles for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (M, n0, r, p, c, T)\n    test_cases = [\n        (100, 1, 3, 0.1, 0.2, 10),      # Case A\n        (50, 5, 0, 0.5, 0.0, 20),      # Case B\n        (5, 1, 5, 0.8, 0.0, 10),      # Case C\n        (1000, 10, 0.05, 0.02, 0.5, 50),  # Case D\n        (20, 20, 10, 1.0, 0.0, 100),   # Case E\n        (200, 2, 1.5, 0.2, 1.0, 15),   # Case F\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M, n0, r, p, c, T = case\n        \n        # Initialize the expected number of recognized epitopes.\n        # Use floating-point numbers for the calculation.\n        n_current = float(n0)\n        M_float = float(M)\n\n        # Iterate the discrete-time update for T cycles.\n        for _ in range(T):\n            # The model is invalid if n_current > M or n_current  0.\n            # We proceed assuming n_current is in [0, M] due to clamping.\n            \n            # The fraction of candidates that are novel.\n            # This term is zero if M is zero to avoid division by zero, or if all epitopes are recognized.\n            if M_float == 0 or n_current >= M_float:\n                novel_fraction = 0.0\n            else:\n                novel_fraction = (M_float - n_current) / M_float\n\n            # Calculate the expected number of newly recognized epitopes.\n            # This is the core of the derived update rule.\n            increment = r * n_current * novel_fraction * (1.0 - c) * p\n            \n            # Update the expected number of recognized epitopes.\n            n_current += increment\n            \n            # Enforce the constraint that n must be in [0, M] by clamping.\n            # This is necessary for discrete models with high growth rates (e.g., Case C)\n            # and as a safeguard against floating-point inaccuracies.\n            n_current = max(0.0, min(n_current, M_float))\n\n        # Append the final result, rounded to 3 decimal places.\n        # The f-string format ensures exactly three decimal places.\n        results.append(f\"{n_current:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4964942"}]}