{"hands_on_practices": [{"introduction": "The success of many transplants, particularly hematopoietic stem cell transplants, hinges on finding a donor with closely matched Human Leukocyte Antigen (HLA) proteins. The genes for these proteins are clustered on chromosome 6 and are typically inherited together as a block, or haplotype. This exercise delves into the genetic foundation of transplant matching by asking you to derive the probabilities of a sibling being a full match, a half match, or a complete mismatch, starting from Mendelian principles and in-corporating the effect of genetic recombination [@problem_id:4985381]. Mastering this calculation provides a first-principles understanding of why siblings are often the first potential donors considered for a patient in need.", "problem": "A hospital is evaluating two full siblings for hematopoietic stem cell transplantation and wants to understand, from first principles, the probability that they are Human Leukocyte Antigen (HLA) identical, HLA haploidentical, or HLA mismatched when the HLA region is modeled with two linked loci. Human Leukocyte Antigen (HLA) is a multi-locus region on chromosome $6$ that is typically inherited as a haplotype but can be altered by meiotic recombination.\n\nConsider a simplified, scientifically realistic model in which the HLA region is represented by two loci, $L_{1}$ and $L_{2}$, on the same chromosome, separated by a recombination fraction $r$ with $0 \\leq r \\leq \\frac{1}{2}$. The mother carries two distinct two-locus haplotypes, $\\left(A_{1},B_{1}\\right)$ and $\\left(A_{2},B_{2}\\right)$, and the father carries two distinct two-locus haplotypes, $\\left(C_{1},D_{1}\\right)$ and $\\left(C_{2},D_{2}\\right)$. Assume the following foundational principles and conditions:\n- Mendelian equal segregation: in any meiosis, each homolog is chosen with probability $\\frac{1}{2}$.\n- Two-locus recombination: with probability $r$ per meiosis, a crossover occurs between $L_{1}$ and $L_{2}$, yielding one of the two recombinant haplotypes with equal probability; otherwise, with probability $1-r$, a nonrecombinant haplotype is transmitted.\n- Independence: maternal and paternal meioses are independent of each other and independent across conceptions (distinct pregnancies).\n- No de novo mutation, no gene conversion, and no selection; all parental haplotypes are distinguishable at both loci.\n\nFor each sibling, the maternal gamete is one of $\\left(A_{1},B_{1}\\right)$, $\\left(A_{2},B_{2}\\right)$, $\\left(A_{1},B_{2}\\right)$, or $\\left(A_{2},B_{1}\\right)$, with probabilities $\\frac{1-r}{2}$, $\\frac{1-r}{2}$, $\\frac{r}{2}$, and $\\frac{r}{2}$, respectively. The paternal gamete is distributed analogously over $\\left(C_{1},D_{1}\\right)$, $\\left(C_{2},D_{2}\\right)$, $\\left(C_{1},D_{2}\\right)$, and $\\left(C_{2},D_{1}\\right)$.\n\nDefine:\n- “HLA-identical” siblings: both siblings inherit the same maternal two-locus haplotype and the same paternal two-locus haplotype.\n- “HLA haploidentical” siblings: the siblings inherit exactly one identical two-locus haplotype (maternal or paternal) but not both.\n- “HLA mismatched” siblings: the siblings inherit neither the same maternal nor the same paternal two-locus haplotype.\n\nStarting only from the principles above, derive closed-form expressions for the probabilities of HLA-identical, HLA haploidentical, and HLA mismatched outcomes for the sibling pair as functions of $r$. Present your final answer as a single row matrix $\\left(P_{\\text{identical}} \\; P_{\\text{haploidentical}} \\; P_{\\text{mismatched}}\\right)$ in terms of $r$. No numerical rounding is required, and no units should be included in the final answer.", "solution": "The user has requested a solution to a problem concerning the probabilities of Human Leukocyte Antigen (HLA) matching between two full siblings, based on a two-locus model with recombination.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Model:** Two linked HLA loci, $L_{1}$ and $L_{2}$, on the same chromosome.\n-   **Recombination Fraction:** $r$, where $0 \\leq r \\leq \\frac{1}{2}$.\n-   **Parental Haplotypes:**\n    -   Mother: two distinct haplotypes, $\\left(A_{1},B_{1}\\right)$ and $\\left(A_{2},B_{2}\\right)$.\n    -   Father: two distinct haplotypes, $\\left(C_{1},D_{1}\\right)$ and $\\left(C_{2},D_{2}\\right)$.\n-   **Principles and Conditions:**\n    -   Mendelian equal segregation: probability of $\\frac{1}{2}$ for each homolog.\n    -   Two-locus recombination: probability $r$ of a crossover, yielding one of two recombinant haplotypes with equal probability. Probability $1-r$ of no recombination.\n    -   Independence: Maternal and paternal meioses are independent; conceptions are independent.\n    -   No de novo mutation, gene conversion, or selection. All parental haplotypes are distinguishable.\n-   **Gamete Probabilities (Maternal):**\n    -   $\\left(A_{1},B_{1}\\right)$ (non-recombinant): $\\frac{1-r}{2}$\n    -   $\\left(A_{2},B_{2}\\right)$ (non-recombinant): $\\frac{1-r}{2}$\n    -   $\\left(A_{1},B_{2}\\right)$ (recombinant): $\\frac{r}{2}$\n    -   $\\left(A_{2},B_{1}\\right)$ (recombinant): $\\frac{r}{2}$\n-   **Gamete Probabilities (Paternal):** Analogous distribution for paternal gametes.\n-   **Definitions:**\n    -   **HLA-identical:** Siblings inherit the same maternal and same paternal two-locus haplotype.\n    -   **HLA haploidentical:** Siblings inherit exactly one identical haplotype (maternal or paternal), but not both.\n    -   **HLA mismatched:** Siblings inherit neither the same maternal nor the same paternal haplotype.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n\n-   **Scientifically Grounded:** The problem uses a standard and scientifically valid simplification of genetic linkage and recombination to model inheritance of HLA haplotypes. The concepts of haplotypes, recombination fraction ($r$), and Mendelian inheritance are fundamental principles in genetics.\n-   **Well-Posed:** The problem is clearly defined with all necessary parameters, probabilities, and definitions provided. It asks for a specific set of closed-form expressions, for which a unique solution exists.\n-   **Objective:** The problem is stated using precise, quantitative, and unbiased language.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, being non-formalizable, incomplete, unrealistic, or ill-posed. All provided probabilities for maternal gametes correctly sum to $1$: $2 \\times \\frac{1-r}{2} + 2 \\times \\frac{r}{2} = 1-r+r = 1$. The setup is internally consistent and logically sound.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Derivation of Probabilities\n\nLet $S_{1}$ and $S_{2}$ denote the two siblings. Let $H_{M,1}$ and $H_{P,1}$ be the maternal and paternal haplotypes inherited by sibling $S_{1}$, respectively. Similarly, let $H_{M,2}$ and $H_{P,2}$ be the haplotypes for sibling $S_2$. The problem requires finding the probabilities of three mutually exclusive events:\n\n1.  $P_{\\text{identical}} = P(H_{M,1} = H_{M,2} \\text{ and } H_{P,1} = H_{P,2})$\n2.  $P_{\\text{haploidentical}} = P((H_{M,1} = H_{M,2} \\text{ and } H_{P,1} \\neq H_{P,2}) \\text{ or } (H_{M,1} \\neq H_{M,2} \\text{ and } H_{P,1} = H_{P,2}))$\n3.  $P_{\\text{mismatched}} = P(H_{M,1} \\neq H_{M,2} \\text{ and } H_{P,1} \\neq H_{P,2})$\n\nThe problem states that maternal and paternal meioses are independent, and meioses for different siblings are independent. Therefore, we can simplify the probabilities:\n\n$P_{\\text{identical}} = P(H_{M,1} = H_{M,2}) \\times P(H_{P,1} = H_{P,2})$\n$P_{\\text{haploidentical}} = P(H_{M,1} = H_{M,2})P(H_{P,1} \\neq H_{P,2}) + P(H_{M,1} \\neq H_{M,2})P(H_{P,1} = H_{P,2})$\n$P_{\\text{mismatched}} = P(H_{M,1} \\neq H_{M,2}) \\times P(H_{P,1} \\neq H_{P,2})$\n\nThe core task is to determine the probability that two siblings inherit the same haplotype from a given parent. Let's calculate this for the mother. The same logic will apply to the father due to symmetry.\n\nThe mother can produce four distinct haplotypes for her gametes. Let these be $h_1 = (A_1, B_1)$, $h_2 = (A_2, B_2)$, $h_3 = (A_1, B_2)$, and $h_4 = (A_2, B_1)$. The probabilities of producing these gametes are given as:\n$P(h_1) = \\frac{1-r}{2}$\n$P(h_2) = \\frac{1-r}{2}$\n$P(h_3) = \\frac{r}{2}$\n$P(h_4) = \\frac{r}{2}$\n\nThe probability that both siblings inherit the same maternal haplotype, $P(H_{M,1} = H_{M,2})$, is the sum of the probabilities that they both inherit $h_1$, or both inherit $h_2$, and so on. Since the two conceptions are independent events, we can write:\n$P(H_{M,1} = H_{M,2}) = \\sum_{i=1}^{4} P(H_{M,1}=h_i \\text{ and } H_{M,2}=h_i) = \\sum_{i=1}^{4} [P(h_i)]^2$\n\nSubstituting the given probabilities:\n$$P(H_{M,1} = H_{M,2}) = \\left(\\frac{1-r}{2}\\right)^2 + \\left(\\frac{1-r}{2}\\right)^2 + \\left(\\frac{r}{2}\\right)^2 + \\left(\\frac{r}{2}\\right)^2$$\n$$P(H_{M,1} = H_{M,2}) = 2\\left(\\frac{(1-r)^2}{4}\\right) + 2\\left(\\frac{r^2}{4}\\right)$$\n$$P(H_{M,1} = H_{M,2}) = \\frac{(1-r)^2 + r^2}{2} = \\frac{1 - 2r + r^2 + r^2}{2} = \\frac{1 - 2r + 2r^2}{2}$$\n\nLet's denote this probability of sharing one parental haplotype as $\\pi$. So, $\\pi = \\frac{1 - 2r + 2r^2}{2}$.\nBy symmetry, the probability of sharing the paternal haplotype is the same: $P(H_{P,1} = H_{P,2}) = \\pi$.\n\nThe probability of not sharing a maternal haplotype is:\n$$P(H_{M,1} \\neq H_{M,2}) = 1 - P(H_{M,1} = H_{M,2}) = 1 - \\pi$$\n$$1 - \\pi = 1 - \\frac{1 - 2r + 2r^2}{2} = \\frac{2 - (1 - 2r + 2r^2)}{2} = \\frac{1 + 2r - 2r^2}{2}$$\nSimilarly, $P(H_{P,1} \\neq H_{P,2}) = 1-\\pi$.\n\nNow we can compute the final probabilities.\n\n**1. Probability of being HLA-identical:**\nThis requires sharing both the maternal and paternal haplotypes.\n$$P_{\\text{identical}} = P(H_{M,1} = H_{M,2}) \\times P(H_{P,1} = H_{P,2}) = \\pi \\times \\pi = \\pi^2$$\n$$P_{\\text{identical}} = \\left(\\frac{1 - 2r + 2r^2}{2}\\right)^2 = \\frac{(1 - 2r + 2r^2)^2}{4}$$\n\n**2. Probability of being HLA haploidentical:**\nThis requires sharing a haplotype from one parent but not the other.\n$$P_{\\text{haploidentical}} = P(H_{M,1} = H_{M,2})P(H_{P,1} \\neq H_{P,2}) + P(H_{M,1} \\neq H_{M,2})P(H_{P,1} = H_{P,2})$$\n$$P_{\\text{haploidentical}} = \\pi(1-\\pi) + (1-\\pi)\\pi = 2\\pi(1-\\pi)$$\n$$P_{\\text{haploidentical}} = 2 \\left(\\frac{1 - 2r + 2r^2}{2}\\right) \\left(\\frac{1 + 2r - 2r^2}{2}\\right) = \\frac{(1 - 2r + 2r^2)(1 + 2r - 2r^2)}{2}$$\n\n**3. Probability of being HLA mismatched:**\nThis requires sharing neither the maternal nor the paternal haplotype.\n$$P_{\\text{mismatched}} = P(H_{M,1} \\neq H_{M,2}) \\times P(H_{P,1} \\neq H_{P,2}) = (1-\\pi) \\times (1-\\pi) = (1-\\pi)^2$$\n$$P_{\\text{mismatched}} = \\left(\\frac{1 + 2r - 2r^2}{2}\\right)^2 = \\frac{(1 + 2r - 2r^2)^2}{4}$$\n\nThese three probabilities represent the complete set of outcomes. As a check, their sum is $\\pi^2 + 2\\pi(1-\\pi) + (1-\\pi)^2 = (\\pi + (1-\\pi))^2 = 1^2 = 1$.\n\nThe final answer is the row matrix of these three expressions.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\left(1 - 2r + 2r^2\\right)^2}{4} & \\frac{\\left(1 - 2r + 2r^2\\right)\\left(1 + 2r - 2r^2\\right)}{2} & \\frac{\\left(1 + 2r - 2r^2\\right)^2}{4} \\end{pmatrix} } $$", "id": "4985381"}, {"introduction": "While understanding inheritance patterns is crucial, assessing a specific donor-recipient pair requires quantifying their immunological differences. A \"mismatch\" is not a single concept; it can be evaluated at progressively finer levels of molecular detail, from broad antigen groups down to specific amino acid patches called eplets. This practice challenges you to calculate mismatch counts at the allele, antigen, and eplet levels for a hypothetical transplant pair, providing insight into how each level of resolution helps predict different aspects of the anti-graft immune response, from T-cell recognition to the formation of donor-specific antibodies (DSAs) [@problem_id:4985311].", "problem": "A patient is being evaluated for kidney transplantation. Human Leukocyte Antigen (HLA) typing reveals the following class I HLA-A alleles: the donor expresses HLA-A $\\text{A*}02{:}01$ and $\\text{A*}24{:}02$, while the recipient expresses HLA-A $\\text{A*}02{:}01$ and $\\text{A*}03{:}01$. Using foundational immunology, consider how mismatches at different levels of granularity relate to the likelihood of allorecognition and the development of Donor-Specific Antibodies (DSA). Work from first principles:\n\n- Definition of an HLA allele: a specific sequence-defined variant at a locus.\n- Antigen-level matching at HLA-A uses the two-digit antigen groups (for example, $\\text{A2}$, $\\text{A3}$, $\\text{A24}$).\n- An eplet is a minimal polymorphic patch on the HLA molecule surface that can be the target of a B cell receptor and antibodies; eplet mismatch is defined as the count of donor eplets not present on any of the recipient’s alleles.\n\nUnder the following specified and simplified eplet library for HLA-A, compute the allele-level mismatch count, the antigen-level mismatch count, and the eplet-level mismatch count:\n\n- Eplets carried by $\\text{A*}02{:}01$: $E(\\text{A*}02{:}01) = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\}$.\n- Eplets carried by $\\text{A*}24{:}02$: $E(\\text{A*}24{:}02) = \\{ e_{62}, e_{70Q}, e_{76E}, e_{90N}, e_{116Y}, e_{144}, e_{163} \\}$.\n- Eplets carried by $\\text{A*}03{:}01$: $E(\\text{A*}03{:}01) = \\{ e_{62}, e_{76E}, e_{90D}, e_{145R}, e_{152} \\}$.\n\nUse only the eplet definitions provided above. Assume antigen-level grouping: $\\text{A*}02{:}01 \\rightarrow \\text{A2}$, $\\text{A*}24{:}02 \\rightarrow \\text{A24}$, $\\text{A*}03{:}01 \\rightarrow \\text{A3}$. Define the mismatch counts as follows:\n\n- The allele mismatch count $m_{\\text{allele}}$ is the number of donor alleles not found among the recipient alleles.\n- The antigen mismatch count $m_{\\text{antigen}}$ is the number of donor antigens not found among the recipient antigens.\n- The eplet mismatch count $m_{\\text{eplet}}$ is the number of unique donor eplets not present on any of the recipient’s alleles.\n\nThen, briefly discuss from first principles why each mismatch level could contribute to allorecognition and DSA formation in transplantation immunology, grounding your discussion in the concepts of T cell and B cell recognition rather than registry-derived heuristics. Express your final computed mismatch counts as a row matrix $\\left( m_{\\text{allele}}, m_{\\text{antigen}}, m_{\\text{eplet}} \\right)$. No rounding is required; report exact integer counts without units.", "solution": "The problem requires the calculation of three distinct types of Human Leukocyte Antigen (HLA) mismatch counts between a kidney donor and recipient, followed by a discussion of the immunological principles underlying each type of mismatch.\n\nFirst, we formalize the given information.\nLet $D_{\\text{alleles}}$ be the set of HLA-A alleles expressed by the donor, and $R_{\\text{alleles}}$ be the set for the recipient.\n$$D_{\\text{alleles}} = \\{\\text{A*}02{:}01, \\text{A*}24{:}02\\}$$\n$$R_{\\text{alleles}} = \\{\\text{A*}02{:}01, \\text{A*}03{:}01\\}$$\n\nFrom the provided rules, we can define the corresponding sets of HLA-A antigens, $D_{\\text{antigens}}$ and $R_{\\text{antigens}}$.\n$$D_{\\text{antigens}} = \\{\\text{A2}, \\text{A24}\\}$$\n$$R_{\\text{antigens}} = \\{\\text{A2}, \\text{A3}\\}$$\n\nThe eplet compositions for each allele are provided as sets:\n$E(\\text{A*}02{:}01) = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\}$\n$E(\\text{A*}24{:}02) = \\{ e_{62}, e_{70Q}, e_{76E}, e_{90N}, e_{116Y}, e_{144}, e_{163} \\}$\n$E(\\text{A*}03{:}01) = \\{ e_{62}, e_{76E}, e_{90D}, e_{145R}, e_{152} \\}$\n\nWith this information, we proceed to calculate the three specified mismatch counts.\n\n1.  **Allele Mismatch Count ($m_{\\text{allele}}$)**\n    The allele mismatch count, $m_{\\text{allele}}$, is defined as the number of donor alleles not found among the recipient alleles. This is the cardinality of the set difference $D_{\\text{alleles}} \\setminus R_{\\text{alleles}}$.\n    $$D_{\\text{alleles}} \\setminus R_{\\text{alleles}} = \\{\\text{A*}02{:}01, \\text{A*}24{:}02\\} \\setminus \\{\\text{A*}02{:}01, \\text{A*}03{:}01\\} = \\{\\text{A*}24{:}02\\}$$\n    The cardinality of this resulting set is $1$.\n    $$m_{\\text{allele}} = |\\{\\text{A*}24{:}02\\}| = 1$$\n\n2.  **Antigen Mismatch Count ($m_{\\text{antigen}}$)**\n    The antigen mismatch count, $m_{\\text{antigen}}$, is defined as the number of donor antigens not found among the recipient antigens. This is the cardinality of the set difference $D_{\\text{antigens}} \\setminus R_{\\text{antigens}}$.\n    $$D_{\\text{antigens}} \\setminus R_{\\text{antigens}} = \\{\\text{A2}, \\text{A24}\\} \\setminus \\{\\text{A2}, \\text{A3}\\} = \\{\\text{A24}\\}$$\n    The cardinality of this set is $1$.\n    $$m_{\\text{antigen}} = |\\{\\text{A24}\\}| = 1$$\n\n3.  **Eplet Mismatch Count ($m_{\\text{eplet}}$)**\n    The eplet mismatch count, $m_{\\text{eplet}}$, is the number of unique donor eplets not present on any of the recipient's alleles. To calculate this, we first determine the complete set of eplets expressed by the donor, $E_D$, and the recipient, $E_R$. These are the unions of the eplets from their respective alleles.\n\n    Set of donor eplets, $E_D$:\n    $$E_D = E(\\text{A*}02{:}01) \\cup E(\\text{A*}24{:}02)$$\n    $$E_D = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\} \\cup \\{ e_{62}, e_{70Q}, e_{76E}, e_{90N}, e_{116Y}, e_{144}, e_{163} \\}$$\n    $$E_D = \\{ e_{62}, e_{70Q}, e_{76E}, e_{76V}, e_{90N}, e_{116Y}, e_{144}, e_{149A}, e_{163} \\}$$\n\n    Set of recipient eplets, $E_R$:\n    $$E_R = E(\\text{A*}02{:}01) \\cup E(\\text{A*}03{:}01)$$\n    $$E_R = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\} \\cup \\{ e_{62}, e_{76E}, e_{90D}, e_{145R}, e_{152} \\}$$\n    $$E_R = \\{ e_{62}, e_{76E}, e_{76V}, e_{90D}, e_{90N}, e_{144}, e_{145R}, e_{149A}, e_{152} \\}$$\n\n    The mismatched eplets are those in $E_D$ but not in $E_R$. We compute the set difference $E_D \\setminus E_R$.\n    $$E_D \\setminus E_R = \\{ e_{70Q}, e_{116Y}, e_{163} \\}$$\n    The eplets $e_{62}$, $e_{76E}$, $e_{76V}$, $e_{90N}$, $e_{144}$, and $e_{149A}$ are present in both sets and thus do not contribute to the mismatch. The count is the cardinality of the resulting set.\n    $$m_{\\text{eplet}} = |\\{ e_{70Q}, e_{116Y}, e_{163} \\}| = 3$$\n\n**Immunological Discussion**\n\nThe three levels of mismatch correspond to different granularities of viewing the foreignness of the donor organ, each relating to specific mechanisms of the recipient's immune response.\n\n- **Allele-level Mismatch ($m_{\\text{allele}}=1$):** An HLA allele corresponds to a specific amino acid sequence of the HLA protein. A mismatched allele, such as the donor's $\\text{A*}24{:}02$ in this case, represents a foreign protein to the recipient's immune system. This foreignness is the primary trigger for T cell-mediated allorecognition.\n    - **Direct Allorecognition:** Recipient T cells that have been educated to recognize foreign peptides on self-HLA molecules can cross-reactively recognize the intact, foreign donor HLA molecule ($\\text{A*}24{:}02$) on the surface of donor antigen-presenting cells (APCs). This pathway mounts a powerful and rapid T cell response against the graft.\n    - **Indirect Allorecognition:** The foreign donor HLA protein ($\\text{A*}24{:}02$) is taken up and processed into smaller peptides by the recipient's own APCs. These peptides are then presented on the recipient's self-HLA molecules (e.g., $\\text{A*}02{:}01$ or $\\text{A*}03{:}01$) to recipient T-helper cells. This activation of T-helper cells is crucial for orchestrating the overall anti-graft response, including providing help to B cells.\n    Thus, an allele mismatch provides the fundamental molecular basis for T cell-driven rejection.\n\n- **Antigen-level Mismatch ($m_{\\text{antigen}}=1$):** This is a lower-resolution classification based on historical serological typing. An antigen-level mismatch (here, the donor's $\\text{A24}$) implies substantial structural differences between the donor and recipient HLA molecules. Such broad differences almost guarantee a significant number of amino acid and eplet mismatches. Consequently, it serves as a strong, albeit coarse, predictor of robust T-cell allorecognition through both direct and indirect pathways.\n\n- **Eplet-level Mismatch ($m_{\\text{eplet}}=3$):** This represents the highest level of immunological resolution relevant to the humoral (antibody-mediated) response. An eplet is a minimal, three-dimensional patch of polymorphic amino acids on the HLA surface that is recognized by a B-cell receptor (BCR) and can be a target for antibodies.\n    - **B-cell Recognition and DSA Formation:** B cells directly recognize conformational epitopes on foreign proteins. The mismatched eplets on the donor HLA molecules (here, $e_{70Q}$, $e_{116Y}$, and $e_{163}$) are foreign epitopes to the recipient's B cell repertoire. A B cell whose BCR binds to one of these eplets can become activated. This activation is greatly enhanced by help from T-helper cells (activated via the indirect pathway). The activated B cell then matures into a plasma cell that secretes antibodies specific to that donor eplet. These are known as Donor-Specific Antibodies (DSAs).\n    - **Antibody-Mediated Rejection (AMR):** DSAs can bind to donor HLA molecules expressed on the endothelium of the graft's blood vessels. This binding can trigger complement activation, inflammation, and endothelial damage, leading to AMR, a major cause of both acute and chronic graft failure. The eplet mismatch count is therefore a quantitative measure of the risk of developing DSAs and subsequent AMR.\n\nIn summary, the allele mismatch is a fundamental measure of foreignness driving T cell responses, whereas the eplet mismatch provides a more precise, quantitative assessment of the risk for B cell activation and the development of pathogenic DSAs.\n\nThe computed mismatch counts are $m_{\\text{allele}} = 1$, $m_{\\text{antigen}} = 1$, and $m_{\\text{eplet}} = 3$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 3\n\\end{pmatrix}\n}\n$$", "id": "4985311"}, {"introduction": "Following a successful transplant, the focus shifts to long-term graft survival, which requires carefully managed immunosuppression to prevent rejection. The dosing of critical drugs like tacrolimus is complex, as individual patients metabolize them at different rates, partly due to genetic variations in metabolic enzymes like CYP3A5. This final hands-on practice uses a computational pharmacokinetic model to simulate how a patient's genetic profile impacts drug levels over time, demonstrating the principles of personalized medicine in action [@problem_id:4985320]. You will explore how different starting doses affect the time it takes to reach a therapeutic target, a central challenge in post-transplant clinical care.", "problem": "You are to implement a simulation of tacrolimus trough concentration dynamics in a one-compartment model with first-order elimination to compare dosing needs between cytochrome P450 family 3 subfamily A member 5 (CYP3A5) expressers and nonexpressers. The aim is to compute the time required to reach a specified target trough concentration when starting therapy at two dosing strategies.\n\nFundamental base:\n- First-order elimination: the concentration $C(t)$ follows $dC/dt = -k\\,C(t)$ where $k$ is the elimination rate constant.\n- Volume of distribution $V$ and clearance $CL$ relate as $k = CL/V$.\n- For oral dosing, a fraction $F$ (bioavailability) of the dose reaches the central compartment.\n- Repeated dosing occurs at fixed intervals $\\tau$ with immediate input approximated as an instantaneous bolus at each dosing time.\n\nModel assumptions and fixed parameters to use:\n- Bioavailability $F = 0.25$ (unitless).\n- Volume of distribution per kilogram $V_d = 1.5\\,\\mathrm{L/kg}$.\n- Clearance per kilogram for CYP3A5 nonexpressers $CL_{\\text{nonexp}} = 0.06\\,\\mathrm{L/h/kg}$.\n- Clearance per kilogram for CYP3A5 expressers $CL_{\\text{exp}} = 0.12\\,\\mathrm{L/h/kg}$.\n- Dosing interval $\\tau = 12\\,\\mathrm{h}$ (twice daily).\n- Initial concentration $C(0) = 0\\,\\mathrm{mg/L}$.\n- Target trough concentration $C_{\\text{tgt}} = 0.01\\,\\mathrm{mg/L}$.\n\nDefinitions:\n- For a patient of weight $W$ (in $\\mathrm{kg}$) given a daily dose $D_{\\text{day}}$ (in $\\mathrm{mg/kg/day}$), each dose at time $n \\in \\{1,2,3,\\dots\\}$ is $\\frac{D_{\\text{day}}\\,W}{2}$ (in $\\mathrm{mg}$), administered every $\\tau$ hours.\n- The effective increment to concentration immediately after dosing is $\\Delta C = \\dfrac{F \\cdot \\left(\\frac{D_{\\text{day}}\\,W}{2}\\right)}{V_d\\,W} = \\dfrac{F\\,D_{\\text{day}}}{2\\,V_d}$ (in $\\mathrm{mg/L}$), independent of $W$.\n- Between doses, concentration decays exponentially with factor $r = e^{-k \\tau}$ where $k = \\dfrac{CL}{V}$ and $CL = CL_{\\text{kg}} \\cdot W$, $V = V_d \\cdot W$, hence $k = \\dfrac{CL_{\\text{kg}}}{V_d}$ is independent of $W$.\n- Let $C_n$ denote the trough concentration immediately before the $n$-th dose. Then $C_0 = 0$ and $C_n = \\left(C_{n-1} + \\Delta C\\right) \\cdot r$ for $n \\ge 1$.\n\nYour program must:\n1. For each test case, determine whether the target trough $C_{\\text{tgt}}$ is reachable. If the steady-state trough $C_{\\text{ss}}$ is strictly less than $C_{\\text{tgt}}$, declare it unreachable. Otherwise, simulate the discrete recurrence for troughs until $C_n \\ge C_{\\text{tgt}}$ and report the earliest time $t_n = n \\cdot \\tau$ (in hours), converted to days as $t_n/24$.\n2. Output the time in days as a floating-point number rounded to two decimal places. If unreachable, output $-1.00$.\n\nAngle units are not applicable. Physical units:\n- Concentrations must be conceptualized in $\\mathrm{mg/L}$, but your program outputs only time in days.\n- Express the final time strictly in days, rounded to two decimal places.\n\nTest suite:\nUse the following four test cases, each defined by genotype and starting daily dose $D_{\\text{day}}$:\n- Case $1$: genotype $=$ nonexpresser, $D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$.\n- Case $2$: genotype $=$ expresser, $D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$.\n- Case $3$: genotype $=$ nonexpresser, $D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$.\n- Case $4$: genotype $=$ expresser, $D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$.\n\nWeight $W$ cancels from the model when $D_{\\text{day}}$ is specified per kilogram, but for completeness assume $W = 70\\,\\mathrm{kg}$ in your implementation.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_i$ is the time to reach the target in days rounded to two decimal places, or $-1.00$ if unreachable. No extra text should be printed.", "solution": "The problem has been validated and is determined to be scientifically grounded, well-posed, and objective. All necessary parameters and conditions are provided to formalize a solution based on a standard one-compartment pharmacokinetic model. The problem is solvable.\n\n### 1. Model Formulation\n\nThe problem describes the trough concentration of tacrolimus using a one-compartment model with first-order elimination and repeated oral bolus dosing.\n\nThe concentration $C(t)$ of the drug in the blood plasma is governed by the differential equation for first-order elimination between doses:\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\nwhere $k$ is the elimination rate constant. The solution to this is an exponential decay: $C(t) = C(t_0) e^{-k(t-t_0)}$.\n\nThe key parameters are defined as follows:\n- Bioavailability: $F = 0.25$\n- Volume of distribution per kilogram: $V_d = 1.5\\,\\mathrm{L/kg}$\n- Dosing interval: $\\tau = 12\\,\\mathrm{h}$\n- Patient weight $W$ is assumed to be $70\\,\\mathrm{kg}$ but cancels out of the concentration calculations.\n- Clearance per kilogram, $CL_{\\text{kg}}$, depends on the patient's genotype:\n  - CYP3A5 nonexpresser: $CL_{\\text{nonexp}} = 0.06\\,\\mathrm{L/h/kg}$\n  - CYP3A5 expresser: $CL_{\\text{exp}} = 0.12\\,\\mathrm{L/h/kg}$\n\nThe elimination rate constant $k$ is given by the ratio of clearance ($CL$) to volume of distribution ($V$). Since both are proportional to weight $W$ (i.e., $CL = CL_{\\text{kg}} W$ and $V = V_d W$), $k$ is independent of weight:\n$$\nk = \\frac{CL}{V} = \\frac{CL_{\\text{kg}} W}{V_d W} = \\frac{CL_{\\text{kg}}}{V_d}\n$$\n\nA dose is administered every $\\tau=12$ hours. The daily dose is $D_{\\text{day}}$ in $\\mathrm{mg/kg/day}$, so each dose is $\\frac{D_{\\text{day}}W}{2}$. The effective dose that reaches the central compartment is $F \\cdot \\frac{D_{\\text{day}}W}{2}$. This dose causes an instantaneous increase in concentration, $\\Delta C$:\n$$\n\\Delta C = \\frac{\\text{Effective Dose}}{\\text{Volume}} = \\frac{F \\cdot \\frac{D_{\\text{day}}W}{2}}{V_d W} = \\frac{F D_{\\text{day}}}{2 V_d}\n$$\nThis increment is also independent of patient weight $W$.\n\nBetween doses, the concentration decays by a factor of $r$:\n$$\nr = e^{-k \\tau}\n$$\n\nLet $C_n$ be the trough concentration measured immediately before the $n$-th dose (at time $t=(n-1)\\tau$). The initial concentration is $C_0=0$, although this problem uses a slightly different indexing where the first trough is $C_1$. The concentration just after the $(n-1)$-th dose is $C_{n-1} + \\Delta C$. After decaying for one interval $\\tau$, the concentration becomes the next trough, $C_n$. This establishes the recurrence relation:\n$$\nC_n = (C_{n-1} + \\Delta C) r, \\quad \\text{for } n \\ge 1 \\text{ with } C_0 = 0\\,\\mathrm{mg/L}\n$$\n\n### 2. Steady-State Analysis and Reachability\n\nThe trough concentration increases with each dose and approaches a steady-state value, $C_{\\text{ss}}$. This is found by setting $C_n = C_{n-1} = C_{\\text{ss}}$ in the recurrence relation:\n$$\nC_{\\text{ss}} = (C_{\\text{ss}} + \\Delta C) r \\implies C_{\\text{ss}}(1-r) = r \\Delta C \\implies C_{\\text{ss}} = \\frac{r \\Delta C}{1-r}\n$$\nThe target trough concentration, $C_{\\text{tgt}} = 0.01\\,\\mathrm{mg/L}$, can only be reached if the steady-state trough is greater than or equal to the target. However, if $C_{\\text{ss}} = C_{\\text{tgt}}$, the target is only reached asymptotically at infinite time. Therefore, for the target to be reachable in finite time, we must have $C_{\\text{ss}} > C_{\\text{tgt}}$. The problem states to consider the target unreachable if $C_{\\text{ss}} < C_{\\text{tgt}}$, which we interpret as requiring $C_{\\text{ss}} > C_{\\text{tgt}}$ for a finite-time solution.\n\n### 3. Analytical Solution for Time to Target\n\nIf the target is reachable, we need to find the smallest integer dose number $n \\ge 1$ such that $C_n \\ge C_{\\text{tgt}}$. The recurrence relation has a closed-form solution:\n$$\nC_n = \\Delta C \\frac{r(1-r^n)}{1-r} = C_{\\text{ss}}(1-r^n)\n$$\nWe need to solve for $n$ in the inequality:\n$$\nC_{\\text{ss}}(1-r^n) \\ge C_{\\text{tgt}}\n$$\n$$\n1-r^n \\ge \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\n$$\n$$\nr^n \\le 1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\n$$\nSince $r=e^{-k\\tau}$ is between $0$ and $1$, its logarithm is negative. Taking the natural logarithm of both sides and dividing by $\\ln(r)$ reverses the inequality:\n$$\nn \\ln(r) \\le \\ln\\left(1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\\right)\n$$\n$$\nn \\ge \\frac{\\ln\\left(1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\\right)}{\\ln(r)}\n$$\nSince $n$ must be an integer, we take the ceiling of the right-hand side:\n$$\nn = \\left\\lceil \\frac{\\ln\\left(1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\\right)}{\\ln(r)} \\right\\rceil\n$$\nThe time to reach the target is given by $n$ doses, with each dose cycle being $\\tau=12$ hours. The problem specifies to report the time as $t = n \\cdot \\tau$. The time in days is $t_{\\text{days}} = \\frac{n \\cdot \\tau}{24}$.\n\n### 4. Step-by-Step Calculation for Each Case\n\n**Constants:**\n- $F = 0.25$, $V_d = 1.5\\,\\mathrm{L/kg}$, $\\tau = 12\\,\\mathrm{h}$, $C_{\\text{tgt}} = 0.01\\,\\mathrm{mg/L}$.\n- Hours to days conversion factor: $1/24$.\n\n**Case 1: Nonexpresser, $D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.06\\,\\mathrm{L/h/kg}$.\n2.  $k = \\frac{0.06}{1.5} = 0.04\\,\\mathrm{h}^{-1}$.\n3.  $r = e^{-0.04 \\cdot 12} = e^{-0.48} \\approx 0.61878$.\n4.  $\\Delta C = \\frac{0.25 \\cdot 0.1}{2 \\cdot 1.5} = \\frac{0.025}{3} \\approx 0.00833\\,\\mathrm{mg/L}$.\n5.  $C_{\\text{ss}} = \\frac{0.61878 \\cdot (0.025/3)}{1 - 0.61878} \\approx 0.01351\\,\\mathrm{mg/L}$.\n6.  $C_{\\text{ss}} > C_{\\text{tgt}}$? Yes, $0.01351 > 0.01$. Reachable.\n7.  $n = \\lceil \\frac{\\ln(1 - 0.01/0.01351)}{\\ln(0.61878)} \\rceil = \\lceil \\frac{\\ln(0.2598)}{\\-0.48} \\rceil = \\lceil 2.807 \\rceil = 3$.\n8.  $t_{\\text{days}} = \\frac{3 \\cdot 12}{24} = 1.5$. Result: $1.50$.\n\n**Case 2: Expresser, $D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.12\\,\\mathrm{L/h/kg}$.\n2.  $k = \\frac{0.12}{1.5} = 0.08\\,\\mathrm{h}^{-1}$.\n3.  $r = e^{-0.08 \\cdot 12} = e^{-0.96} \\approx 0.38289$.\n4.  $\\Delta C = \\frac{0.25 \\cdot 0.1}{2 \\cdot 1.5} = \\frac{0.025}{3} \\approx 0.00833\\,\\mathrm{mg/L}$.\n5.  $C_{\\text{ss}} = \\frac{0.38289 \\cdot (0.025/3)}{1 - 0.38289} \\approx 0.00518\\,\\mathrm{mg/L}$.\n6.  $C_{\\text{ss}} < C_{\\text{tgt}}$? Yes, $0.00518 < 0.01$. Unreachable.\n7.  Result: $-1.00$.\n\n**Case 3: Nonexpresser, $D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.06\\,\\mathrm{L/h/kg}$, $k = 0.04\\,\\mathrm{h}^{-1}$, $r \\approx 0.61878$.\n2.  $\\Delta C = \\frac{0.25 \\cdot 0.2}{2 \\cdot 1.5} = \\frac{0.05}{3} \\approx 0.01667\\,\\mathrm{mg/L}$.\n3.  $C_{\\text{ss}} = \\frac{0.61878 \\cdot (0.05/3)}{1 - 0.61878} \\approx 0.02702\\,\\mathrm{mg/L}$.\n4.  $C_{\\text{ss}} > C_{\\text{tgt}}$? Yes, $0.02702 > 0.01$. Reachable.\n5.  $n = \\lceil \\frac{\\ln(1 - 0.01/0.02702)}{\\ln(0.61878)} \\rceil = \\lceil \\frac{\\ln(0.6300)}{\\-0.48} \\rceil = \\lceil 0.963 \\rceil = 1$.\n6.  $t_{\\text{days}} = \\frac{1 \\cdot 12}{24} = 0.5$. Result: $0.50$.\n\n**Case 4: Expresser, $D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.12\\,\\mathrm{L/h/kg}$, $k = 0.08\\,\\mathrm{h}^{-1}$, $r \\approx 0.38289$.\n2.  $\\Delta C = \\frac{0.25 \\cdot 0.2}{2 \\cdot 1.5} = \\frac{0.05}{3} \\approx 0.01667\\,\\mathrm{mg/L}$.\n3.  $C_{\\text{ss}} = \\frac{0.38289 \\cdot (0.05/3)}{1 - 0.38289} \\approx 0.01037\\,\\mathrm{mg/L}$.\n4.  $C_{\\text{ss}} > C_{\\text{tgt}}$? Yes, $0.01037 > 0.01$. Reachable.\n5.  $n = \\lceil \\frac{\\ln(1 - 0.01/0.01037)}{\\ln(0.38289)} \\rceil = \\lceil \\frac{\\ln(0.0354)}{\\-0.96} \\rceil = \\lceil 3.48 \\rceil = 4$.\n6.  $t_{\\text{days}} = \\frac{4 \\cdot 12}{24} = 2.0$. Result: $2.00$.\n\nThe computed results for the four test cases are $[1.50, -1.00, 0.50, 2.00]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Computes the time required to reach a target tacrolimus trough concentration\n    for different genotypes and dosing strategies in a one-compartment model.\n    \"\"\"\n    \n    # Define problem constants\n    F = 0.25            # Bioavailability (unitless)\n    V_d = 1.5           # Volume of distribution per kg (L/kg)\n    tau = 12.0          # Dosing interval (h)\n    C_tgt = 0.01        # Target trough concentration (mg/L)\n    \n    # Genotype-specific clearance rates per kg\n    CL_nonexp = 0.06    # Clearance for CYP3A5 nonexpressers (L/h/kg)\n    CL_exp = 0.12       # Clearance for CYP3A5 expressers (L/h/kg)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'genotype': 'nonexpresser', 'D_day': 0.1},\n        {'genotype': 'expresser', 'D_day': 0.1},\n        {'genotype': 'nonexpresser', 'D_day': 0.2},\n        {'genotype': 'expresser', 'D_day': 0.2},\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Determine parameters for the case\n        D_day = case['D_day']\n        if case['genotype'] == 'nonexpresser':\n            CL_kg = CL_nonexp\n        else:\n            CL_kg = CL_exp\n            \n        # 2. Calculate model constants based on case parameters\n        # Elimination rate constant, k (h^-1)\n        k = CL_kg / V_d\n        \n        # Decay factor over one dosing interval, r\n        r = np.exp(-k * tau)\n        \n        # Concentration increment per dose, delta_C (mg/L)\n        delta_C = (F * D_day) / (2 * V_d)\n        \n        # 3. Check for reachability by calculating steady-state trough concentration\n        # C_ss = (r * delta_C) / (1 - r)\n        # The target is unreachable if C_ss is not strictly greater than C_tgt,\n        # as reaching it would take infinite time if C_ss <= C_tgt.\n        # This is a more robust condition than the problem's \"strictly less than\".\n        if (delta_C <= 0) or (1-r <= 0) or ((r * delta_C) / (1 - r)) <= C_tgt:\n            results.append(\"{:.2f}\".format(-1.0))\n            continue\n            \n        C_ss = (r * delta_C) / (1 - r)\n\n        # 4. Analytically solve for the number of doses 'n'\n        # Formula: n = ceil( ln(1 - C_tgt/C_ss) / ln(r) )\n        # This is derived from solving C_n >= C_tgt for n.\n        ratio = C_tgt / C_ss\n        n = np.ceil(np.log(1 - ratio) / np.log(r))\n        \n        # 5. Calculate time in days and format the output\n        # Time in hours = n * tau\n        # Time in days = (n * tau) / 24\n        time_days = (n * tau) / 24.0\n        results.append(\"{:.2f}\".format(time_days))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "4985320"}]}