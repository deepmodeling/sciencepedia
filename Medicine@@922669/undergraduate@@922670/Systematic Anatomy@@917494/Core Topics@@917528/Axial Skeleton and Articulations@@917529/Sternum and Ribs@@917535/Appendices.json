{"hands_on_practices": [{"introduction": "Mastering the anatomy of the sternum begins with understanding its fundamental segments and their proportional relationships. This practice connects anatomical terminology—the manubrium, body, and xiphoid process—to quantitative analysis, allowing you to calculate the dimensions of key regions based on morphometric data. By determining the length of the sternal body, you will reinforce your knowledge of crucial landmarks like the sternal angle and xiphisternal junction, which are vital for surface anatomy and physical examination [@problem_id:5153266].", "problem": "An advanced-undergraduate anatomy student is analyzing the adult sternum to predict a midline measurement relevant to thoracic surface anatomy. The sternum is classically subdivided into the manubrium, the body (corpus sterni), and the xiphoid process. The sternal angle (manubriosternal junction) lies between the manubrium and the body, and the xiphisternal junction lies between the body and the xiphoid process. In an average adult, the total sternal length is the sum of the lengths of these three segments, and widely reported morphometric averages indicate that the body constitutes a typical majority of the total length.\n\nGiven an adult whose total sternal length has been measured along the anterior midline as $175$ mm, and using typical proportional segment lengths for adults of $0.23$ for the manubrium, $0.66$ for the body, and $0.11$ for the xiphoid process (which together approximate the observed mean distribution across populations), calculate the expected linear distance along the anterior midline between the sternal angle and the xiphisternal junction. Round your answer to three significant figures and express your final result in mm.\n\nUse only the core anatomical definitions and the basic fact that the total sternal length equals the sum of the segment lengths; assume negligible curvature along the measurement line and ignore age-related ossification variations for this estimation.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- Total sternal length: $175$ mm.\n- Proportional segment length for manubrium: $0.23$.\n- Proportional segment length for body (corpus sterni): $0.66$.\n- Proportional segment length for xiphoid process: $0.11$.\n- Anatomical definitions: The sternal angle is the manubriosternal junction (between manubrium and body). The xiphisternal junction is between the body and the xiphoid process.\n- Assumption: Total sternal length is the sum of the three segment lengths.\n- Assumption: Negligible curvature along the measurement line.\n- Task: Calculate the linear distance between the sternal angle and the xiphisternal junction.\n- Formatting: Round the answer to three significant figures and express in mm.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated for validity.\n1.  **Scientifically Grounded**: The problem is based on established principles of human gross anatomy and morphometrics. The sternum's subdivisions (manubrium, body, xiphoid process) and the locations of the sternal angle and xiphisternal junction are standard anatomical facts. The given proportions ($0.23$, $0.66$, $0.11$) are consistent with published averages for adult humans and sum to $1.00$ ($0.23 + 0.66 + 0.11 = 1.00$), representing a complete system. The problem is scientifically sound.\n2.  **Well-Posed**: The problem is clearly defined and provides all necessary data to arrive at a unique solution. The question asks for the distance between two specific anatomical landmarks, which is unambiguously defined by the length of a single sternal segment.\n3.  **Objective**: The problem uses precise, objective anatomical terminology and quantitative data. It is free of subjective or ambiguous language.\n4.  **No Flaws**: The problem statement does not violate any fundamental principles, is not incomplete or contradictory, does not contain unrealistic data, and is well-structured.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived.\n\nThe problem requires calculating the linear distance along the anterior midline between the sternal angle and the xiphisternal junction for an adult with a given total sternal length.\n\nLet $L_{total}$ be the total sternal length. Let $L_{man}$, $L_{body}$, and $L_{xiph}$ be the lengths of the manubrium, the body of the sternum (corpus sterni), and the xiphoid process, respectively. The corresponding proportional lengths are given as $P_{man}$, $P_{body}$, and $P_{xiph}$.\n\nThe given values are:\n- $L_{total} = 175$ mm\n- $P_{man} = 0.23$\n- $P_{body} = 0.66$\n- $P_{xiph} = 0.11$\n\nAccording to the provided definitions:\n1.  The sternal angle (manubriosternal junction) is the articulation point between the manubrium and the body of the sternum.\n2.  The xiphisternal junction is the articulation point between the body of the sternum and the xiphoid process.\n\nTherefore, the linear distance along the midline between the sternal angle and the xiphisternal junction is, by definition, the length of the body of the sternum, $L_{body}$.\n\nThe problem states that the length of each segment is a specific proportion of the total length. The length of the sternal body is calculated as:\n$$L_{body} = P_{body} \\times L_{total}$$\n\nSubstituting the given values into this equation:\n$$L_{body} = 0.66 \\times 175 \\text{ mm}$$\n\nPerforming the multiplication:\n$$L_{body} = 115.5 \\text{ mm}$$\n\nThe problem requires the final answer to be rounded to three significant figures. The calculated value is $115.5$. The first three significant figures are $1$, $1$, and $5$. The fourth digit is $5$. Following standard rounding conventions (rounding up when the digit is $5$ or greater), the value is rounded up.\n$$115.5 \\approx 116$$\n\nThus, the expected linear distance between the sternal angle and the xiphisternal junction is $116$ mm.", "answer": "$$\\boxed{116}$$", "id": "5153266"}, {"introduction": "The thoracic cage is not a static structure; its primary function is to facilitate respiration through dynamic movement. This exercise allows you to quantify the 'pump-handle' motion of the upper ribs, a critical mechanism that increases the chest's anteroposterior diameter during inspiration [@problem_id:5153224]. By applying principles of rotational kinematics, you will model how small rotations at the costovertebral joints translate into significant changes in thoracic volume, bridging the gap between static anatomy and respiratory physiology.", "problem": "An advanced undergraduate studying systematic anatomy is modeling the pump-handle motion of the upper ribs and its effect on the anteroposterior diameter of the thorax at the level of the sternal angle. Use the following anatomically grounded assumptions and parameters to compute the change in anteroposterior diameter. Begin from first principles of rigid-body rotation and small-angle kinematics, not from pre-derived shortcuts.\n\nAssume an adult thorax at functional residual capacity, with symmetric pump-handle rotations of ribs $2$ through $5$ by an angle of $3^\\circ$ about their respective instantaneous axes near the costovertebral complex. For each rib $n \\in \\{2,3,4,5\\}$, let the effective radius from the instantaneous rotation axis to the sternal end be $r_n$, approximated by $r_n = (1 - f_n) L_n$, where $L_n$ is the rib length from the vertebral rotation axis to the sternal end (measured along the chord of motion), and $f_n$ is the fraction locating the axis along the rib measured from the vertebral end. Let the local direction of sternal-end motion for each rib lie approximately in the sagittal plane and be tilted from the pure anteroposterior axis by an angle $\\beta_n$ toward the superior direction (reflecting the observed pump-handle trajectory); thus the anteroposterior component of motion for rib $n$ is the projection onto the anteroposterior axis.\n\nTake the small-angle displacement magnitude along the tangent of the motion circle as equal to the product of the rotation angle in radians and the radius $r_n$. Assume equal compliance of the second through fifth costal cartilages and treat the sternum as translating anteriorly without rotation to first order, such that the anterior translation at the sternal angle equals the arithmetic mean of the anteroposterior displacements of the sternal ends of ribs $2$ through $5$.\n\nUse the parameter values:\n- Rib $2$: $L_2 = 180$ mm, $f_2 = 0.35$, $\\beta_2 = 15^\\circ$.\n- Rib $3$: $L_3 = 190$ mm, $f_3 = 0.37$, $\\beta_3 = 18^\\circ$.\n- Rib $4$: $L_4 = 210$ mm, $f_4 = 0.40$, $\\beta_4 = 22^\\circ$.\n- Rib $5$: $L_5 = 230$ mm, $f_5 = 0.43$, $\\beta_5 = 25^\\circ$.\n\nThe rotation angle is $\\theta = 3^\\circ$.\n\nCalculate the change in anteroposterior diameter at the level of the sternal angle (in millimeters) produced by this rotation. Round your answer to three significant figures. Express the final result in millimeters. Angles are given in degrees; if needed for calculation, convert to radians.", "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n**Step 1: Extract Givens**\n- Ribs under consideration: $n \\in \\{2, 3, 4, 5\\}$.\n- Rotation angle for each rib: $\\theta = 3^\\circ$.\n- Rotation is about an instantaneous axis near the costovertebral complex.\n- Effective radius of rotation for rib $n$: $r_n = (1 - f_n) L_n$.\n- $L_n$: Length of rib $n$ from vertebral rotation axis to sternal end.\n- $f_n$: Fractional distance of the instantaneous axis from the vertebral end along the rib.\n- Sternal-end motion direction: Tilted from the anteroposterior (AP) axis by an angle $\\beta_n$ towards the superior direction.\n- AP displacement component: Projection of the total displacement onto the AP axis.\n- Small-angle approximation: Displacement magnitude $d_n \\approx r_n \\theta_{rad}$, where $\\theta_{rad}$ is the angle in radians.\n- Total change in AP diameter at the sternal angle: Equal to the arithmetic mean of the AP displacements of the sternal ends of ribs $2$ through $5$.\n- Parameters for Rib $2$: $L_2 = 180$ mm, $f_2 = 0.35$, $\\beta_2 = 15^\\circ$.\n- Parameters for Rib $3$: $L_3 = 190$ mm, $f_3 = 0.37$, $\\beta_3 = 18^\\circ$.\n- Parameters for Rib $4$: $L_4 = 210$ mm, $f_4 = 0.40$, $\\beta_4 = 22^\\circ$.\n- Parameters for Rib $5$: $L_5 = 230$ mm, $f_5 = 0.43$, $\\beta_5 = 25^\\circ$.\n- Required output: Change in AP diameter in millimeters, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed to be valid. It is scientifically grounded, employing a simplified but physically and anatomically plausible model of thoracic biomechanics (pump-handle motion, rigid-body rotation, small-angle kinematics). All parameters are provided, the terminology is precise, and the relationships are mathematically well-defined. The problem is self-contained, consistent, and well-posed, admitting a unique and meaningful solution. There are no violations of scientific principles, logical inconsistencies, or ambiguities that would render it invalid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Solution**\n\nThe objective is to calculate the change in the anteroposterior (AP) diameter of the thorax at the level of the sternal angle, denoted as $\\Delta D_{AP}$. The problem states that this change is the arithmetic mean of the AP displacements of the sternal ends of ribs $2$ through $5$. Let $\\Delta x_n$ be the AP displacement for rib $n$. The total change is then:\n$$ \\Delta D_{AP} = \\frac{1}{4} \\sum_{n=2}^{5} \\Delta x_n $$\n\nWe must first determine the AP displacement $\\Delta x_n$ for each rib $n$. The motion of each rib's sternal end is described as a rotation through a small angle $\\theta$ about an instantaneous axis of rotation.\n\nThe rotation angle is given in degrees, $\\theta = 3^\\circ$. For calculations in kinematics, this angle must be converted to radians:\n$$ \\theta_{rad} = \\theta \\cdot \\frac{\\pi}{180} = 3 \\cdot \\frac{\\pi}{180} = \\frac{\\pi}{60} \\text{ rad} $$\n\nFor each rib $n$, the effective radius of rotation $r_n$ is the distance from the instantaneous axis to the sternal end. The problem defines this as $r_n = (1 - f_n) L_n$, where $L_n$ is the length from the vertebral axis to the sternal end and $f_n$ is the fractional location of the instantaneous axis along this length from the vertebral side.\n\nUsing the small-angle approximation, the magnitude of the displacement, $d_n$, of the sternal end of rib $n$ along the tangent of its arc of motion is given by:\n$$ d_n = r_n \\theta_{rad} $$\nSubstituting the expression for $r_n$:\n$$ d_n = (1 - f_n) L_n \\theta_{rad} $$\n\nThis displacement $d_n$ is not purely in the AP direction. It is tilted superiorly by an angle $\\beta_n$ with respect to the AP axis. The AP component, $\\Delta x_n$, is found by projecting the displacement vector onto the AP axis. Assuming the AP axis is the reference direction, the projected displacement is:\n$$ \\Delta x_n = d_n \\cos(\\beta_n) $$\n\nSubstituting the expression for $d_n$:\n$$ \\Delta x_n = (1 - f_n) L_n \\theta_{rad} \\cos(\\beta_n) $$\n\nNow, we can express the total change in AP diameter, $\\Delta D_{AP}$, by substituting this expression for $\\Delta x_n$ into the averaging formula. The constant terms $\\frac{1}{4}$ and $\\theta_{rad}$ can be factored out of the summation:\n$$ \\Delta D_{AP} = \\frac{1}{4} \\sum_{n=2}^{5} \\left[ (1 - f_n) L_n \\theta_{rad} \\cos(\\beta_n) \\right] = \\frac{\\theta_{rad}}{4} \\sum_{n=2}^{5} (1 - f_n) L_n \\cos(\\beta_n) $$\n\nWe now substitute the given numerical values for each rib into the summation term. Let $T_n = (1 - f_n) L_n \\cos(\\beta_n)$.\n\nFor rib $n=2$:\n$L_2 = 180$ mm, $f_2 = 0.35$, $\\beta_2 = 15^\\circ$\n$T_2 = (1 - 0.35) \\cdot 180 \\cdot \\cos(15^\\circ) = 0.65 \\cdot 180 \\cdot \\cos(15^\\circ) = 117 \\cos(15^\\circ)$ mm\n\nFor rib $n=3$:\n$L_3 = 190$ mm, $f_3 = 0.37$, $\\beta_3 = 18^\\circ$\n$T_3 = (1 - 0.37) \\cdot 190 \\cdot \\cos(18^\\circ) = 0.63 \\cdot 190 \\cdot \\cos(18^\\circ) = 119.7 \\cos(18^\\circ)$ mm\n\nFor rib $n=4$:\n$L_4 = 210$ mm, $f_4 = 0.40$, $\\beta_4 = 22^\\circ$\n$T_4 = (1 - 0.40) \\cdot 210 \\cdot \\cos(22^\\circ) = 0.60 \\cdot 210 \\cdot \\cos(22^\\circ) = 126 \\cos(22^\\circ)$ mm\n\nFor rib $n=5$:\n$L_5 = 230$ mm, $f_5 = 0.43$, $\\beta_5 = 25^\\circ$\n$T_5 = (1 - 0.43) \\cdot 230 \\cdot \\cos(25^\\circ) = 0.57 \\cdot 230 \\cdot \\cos(25^\\circ) = 131.1 \\cos(25^\\circ)$ mm\n\nNow we calculate the numerical values for each term $T_n$:\n$T_2 = 117 \\cdot \\cos(15^\\circ) \\approx 117 \\cdot 0.965926 \\approx 113.013$ mm\n$T_3 = 119.7 \\cdot \\cos(18^\\circ) \\approx 119.7 \\cdot 0.951057 \\approx 113.841$ mm\n$T_4 = 126 \\cdot \\cos(22^\\circ) \\approx 126 \\cdot 0.927184 \\approx 116.825$ mm\n$T_5 = 131.1 \\cdot \\cos(25^\\circ) \\approx 131.1 \\cdot 0.906308 \\approx 118.830$ mm\n\nThe sum is:\n$$ \\sum_{n=2}^{5} T_n \\approx 113.013 + 113.841 + 116.825 + 118.830 = 462.509 \\text{ mm} $$\n\nFinally, we calculate $\\Delta D_{AP}$:\n$$ \\Delta D_{AP} = \\frac{\\theta_{rad}}{4} \\sum_{n=2}^{5} T_n = \\frac{\\pi/60}{4} \\cdot (462.509) = \\frac{\\pi}{240} \\cdot 462.509 $$\n$$ \\Delta D_{AP} \\approx 0.01308997 \\cdot 462.509 \\approx 6.0543 \\text{ mm} $$\n\nThe problem requires the answer to be rounded to three significant figures.\n$$ \\Delta D_{AP} \\approx 6.05 \\text{ mm} $$", "answer": "$$\\boxed{6.05}$$", "id": "5153224"}, {"introduction": "Anatomical variations can have profound clinical consequences, and understanding them is crucial for safe medical practice. This advanced problem challenges you to model the risk associated with a persistent sternal foramen, a congenital defect resulting from incomplete embryonic fusion [@problem_id:5153241]. You will use three-dimensional geometry to construct an algorithm that simulates a sternal puncture, evaluating whether a needle's trajectory could lead to iatrogenic cardiac injury, thereby integrating anatomy, physics, and computational thinking to address a real-world clinical scenario.", "problem": "A persistent sternal foramen is a congenital perforation in the sternal body that results from incomplete fusion between paired sternal bars and segmental ossification centers (sternebrae) during embryonic development and postnatal ossification. This anatomical variation can permit an unimpeded path for an instrument introduced at the anterior surface to traverse the sternum and enter the anterior mediastinum, increasing the risk of injuring the right ventricle during sternal puncture. Starting from fundamental definitions of embryological segmentation and fusion in bone formation and Euclidean three-dimensional geometry, model the anterior chest wall and heart with the following abstractions and parameters, and construct an algorithm to evaluate injury risk.\n\nAssume a right-handed Cartesian coordinate system with axes defined as follows: the $x$-axis increases to the patient's left, the $y$-axis increases superiorly, and the $z$-axis increases posteriorly. The anterior sternal surface lies in the plane $z = 0$. The sternum is modeled as a homogeneous slab occupying $0 \\le z \\le T$ except for a cylindrical sternal foramen (a through-hole) aligned with the $z$-axis and centered at $(x_f,y_f)$ with radius $R$. The inner sternal surface lies in the plane $z = T$. The right ventricle's anterior surface at risk is approximated by a sphere of radius $r_h$ centered at $(x_h,y_h,z_h)$ with $z_h > T$.\n\nA needle is introduced at the point $(x_0,y_0,z_0)$ with $z_0 = 0$ and advanced along a straight trajectory of length $L$ in the direction given by two angles: the elevation angle $\\alpha$ measured from the $z$-axis ($\\alpha = 0$ means exactly perpendicular to the sternal surface, pointing posteriorly), and the azimuth angle $\\varphi$ measured in the $x$–$y$ plane from the positive $x$-axis toward the positive $y$-axis. Using Euclidean geometry, the needle’s trajectory can be represented as a parametric line segment from $t = 0$ to $t = L$:\n$$\n\\mathbf{p}(t) = \\mathbf{p}_0 + t\\,\\mathbf{d},\n$$\nwhere $\\mathbf{p}_0 = (x_0,y_0,0)$ and $\\mathbf{d}$ is a unit direction vector determined by $\\alpha$ and $\\varphi$. Angles must be handled in degrees. All lengths must be handled in millimeters (mm).\n\nRisk criterion: iatrogenic cardiac injury is considered possible if and only if both of the following conditions are satisfied:\n1. The needle’s path through the sternal thickness $0 \\le z \\le T$ remains entirely inside the cylindrical foramen (i.e., it does not intersect the bony slab), and\n2. The portion of the needle’s path for $z \\ge T$ intersects the spherical region representing the right ventricle.\n\nFrom first principles, use the definitions above to derive and implement an algorithm that, given numerical parameters, returns $True$ if injury risk exists and $False$ otherwise.\n\nUse these fixed anatomical model parameters for all test cases unless otherwise specified within a test:\n- Sternal thickness $T = 12$ mm.\n- Foramen center $(x_f,y_f) = (0,0)$ mm and radius $R = 3.5$ mm.\n- Heart sphere radius $r_h = 15$ mm and center $(x_h,y_h,z_h) = (0,0,37)$ mm.\n\nYour program must evaluate the following test suite of needle trajectories and output a single line with the results as a comma-separated list enclosed in square brackets:\n\n- Test case 1 (general perpendicular, through-foramen, sufficient length): $(x_0,y_0) = (0,0)$ mm, $\\alpha = 0$ degrees, $\\varphi = 0$ degrees, $L = 60$ mm. Use the default heart center.\n- Test case 2 (lateral tilt causes exit from foramen before inner surface): $(x_0,y_0) = (0,0)$ mm, $\\alpha = 20$ degrees, $\\varphi = 90$ degrees, $L = 60$ mm. Use the default heart center.\n- Test case 3 (perpendicular but insufficient length to reach heart sphere): $(x_0,y_0) = (0,0)$ mm, $\\alpha = 0$ degrees, $\\varphi = 0$ degrees, $L = 20$ mm. Use the default heart center.\n- Test case 4 (off-center entry still remains within foramen due to compensatory azimuth, sufficient length): $(x_0,y_0) = (2,0)$ mm, $\\alpha = 10$ degrees, $\\varphi = 180$ degrees, $L = 60$ mm. Use the default heart center.\n- Test case 5 (perpendicular and through-foramen but heart center laterally offset, so trajectory misses): $(x_0,y_0) = (0,0)$ mm, $\\alpha = 0$ degrees, $\\varphi = 0$ degrees, $L = 60$ mm. For this test case, use heart center $(x_h,y_h,z_h) = (30,0,37)$ mm and radius $r_h = 15$ mm.\n\nAngle inputs must be treated in degrees. Lengths must be treated in millimeters. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is a boolean ($True$ or $False$) corresponding to the injury risk for each test case in order.", "solution": "The problem requires an algorithmic assessment of iatrogenic injury risk during a sternal puncture, based on a simplified geometric model of the chest wall and heart. The model and risk criteria are provided, and the solution must be derived from first principles of Euclidean geometry.\n\nThe solution is developed in three main steps:\n1. Formulating the needle's trajectory as a parametric line in a three-dimensional Cartesian coordinate system.\n2. Deriving the mathematical condition for the needle to pass entirely through the sternal foramen without intersecting the surrounding bone.\n3. Deriving the mathematical condition for the segment of the needle's path posterior to the sternum to intersect the spherical volume representing the heart.\n\nAn injury risk exists if and only if both conditions are met.\n\n**1. Needle Trajectory Formulation**\n\nA right-handed Cartesian coordinate system is defined with the anterior sternal surface on the plane $z=0$. The needle is introduced at $\\mathbf{p}_0 = (x_0, y_0, 0)$ and advances along a straight line. The direction of this line is given by an elevation angle $\\alpha$ and an azimuth angle $\\varphi$. The angle $\\alpha$ is measured from the positive $z$-axis (posteriorly), and $\\varphi$ is measured in the $x-y$ plane from the positive $x$-axis.\n\nTo use these angles, they must first be converted from degrees to radians:\n$$ \\alpha_{\\text{rad}} = \\alpha_{\\text{deg}} \\frac{\\pi}{180} $$\n$$ \\varphi_{\\text{rad}} = \\varphi_{\\text{deg}} \\frac{\\pi}{180} $$\nThe unit direction vector $\\mathbf{d}$ of the needle's trajectory is then given by the standard spherical-to-Cartesian conversion:\n$$ \\mathbf{d} = (d_x, d_y, d_z) = (\\sin\\alpha_{\\text{rad}}\\cos\\varphi_{\\text{rad}}, \\sin\\alpha_{\\text{rad}}\\sin\\varphi_{\\text{rad}}, \\cos\\alpha_{\\text{rad}}) $$\nThe needle's trajectory is a parametric line segment $\\mathbf{p}(t)$ of length $L$, starting at $\\mathbf{p}_0$:\n$$ \\mathbf{p}(t) = \\mathbf{p}_0 + t\\mathbf{d} \\quad \\text{for } t \\in [0, L] $$\nIn component form, this is:\n$$ x(t) = x_0 + t\\sin\\alpha_{\\text{rad}}\\cos\\varphi_{\\text{rad}} $$\n$$ y(t) = y_0 + t\\sin\\alpha_{\\text{rad}}\\sin\\varphi_{\\text{rad}} $$\n$$ z(t) = t\\cos\\alpha_{\\text{rad}} $$\nFor the needle to advance posteriorly into the mediastinum, its $z$-component of direction, $d_z = \\cos\\alpha_{\\text{rad}}$, must be positive. This implies $\\alpha_{\\text{deg}} \\in [0, 90)$. If $\\alpha_{\\text{deg}} \\ge 90$, the needle does not proceed posteriorly, and the risk is zero.\n\n**2. Condition 1: Foramen Pass-Through**\n\nThe first risk criterion is that the needle's path remains entirely within the cylindrical foramen as it passes through the sternum. The sternum occupies the slab $0 \\le z \\le T$. The foramen is a cylinder of radius $R$ centered at $(x_f, y_f)$ and aligned with the $z$-axis. Its equation is $(x-x_f)^2 + (y-y_f)^2 \\le R^2$.\n\nThe needle traverses the sternal thickness from $z=0$ to $z=T$. The corresponding values of the parameter $t$ are found from $z(t) = t\\cos\\alpha_{\\text{rad}}$.\n- At $z=0$, $t=0$.\n- At $z=T$, $t = T/\\cos\\alpha_{\\text{rad}}$. Let this be $t_T$.\nSo, for the entire path segment corresponding to $t \\in [0, t_T]$, the needle's $x$ and $y$ coordinates must satisfy the foramen's inequality.\n$$ (x(t)-x_f)^2 + (y(t)-y_f)^2 \\le R^2 \\quad \\text{for all } t \\in [0, t_T] $$\nLet's analyze the function representing the squared distance of the needle's projection from the foramen's center:\n$$ g(t) = ((x_0 - x_f) + t d_x)^2 + ((y_0 - y_f) + t d_y)^2 $$\nThis is a quadratic function of $t$, $g(t) = At^2 + Bt + C$, where $A = d_x^2 + d_y^2 = \\sin^2\\alpha_{\\text{rad}} \\ge 0$. Since the coefficient $A$ is non-negative, the function describes a parabola opening upwards (or a constant if $A=0$). The maximum value of such a function on a closed interval $[t_a, t_b]$ must occur at one of the endpoints, $t_a$ or $t_b$.\nIn our case, the interval is $[0, t_T]$. Thus, we only need to verify the condition at $t=0$ and $t=t_T$:\n1. At $t=0$ (entry point): $(x_0-x_f)^2 + (y_0-y_f)^2 \\le R^2$.\n2. At $t=t_T$ (exit point): $(x(t_T)-x_f)^2 + (y(t_T)-y_f)^2 \\le R^2$, where $x(t_T) = x_0 + t_T d_x$ and $y(t_T) = y_0 + t_T d_y$.\n\nIf both inequalities hold, Condition 1 is satisfied. Otherwise, it is not.\n\n**3. Condition 2: Heart Intersection**\n\nThe second risk criterion is that the needle intersects the heart after passing through the sternum. The heart is modeled as a sphere of radius $r_h$ centered at $\\mathbf{c} = (x_h, y_h, z_h)$. The needle path segment to consider is for $z \\ge T$, which corresponds to $t \\in [t_T, L]$. This segment exists only if $L > t_T$. If $L \\le t_T$, the needle does not advance far enough to potentially strike the heart, so Condition 2 is not met.\n\nAssuming $L > t_T$, we perform a line segment-sphere intersection test. The sphere's equation is $\\|\\mathbf{p} - \\mathbf{c}\\|^2 = r_h^2$. Substituting the line equation $\\mathbf{p}(t) = \\mathbf{p}_0 + t\\mathbf{d}$ gives:\n$$ \\|\\mathbf{p}_0 + t\\mathbf{d} - \\mathbf{c}\\|^2 = r_h^2 $$\nLet $\\mathbf{v} = \\mathbf{p}_0 - \\mathbf{c}$. The equation becomes $\\|\\mathbf{v} + t\\mathbf{d}\\|^2 = r_h^2$, which expands to:\n$$ (\\mathbf{v}\\cdot\\mathbf{v}) + 2t(\\mathbf{v}\\cdot\\mathbf{d}) + t^2(\\mathbf{d}\\cdot\\mathbf{d}) - r_h^2 = 0 $$\nSince $\\mathbf{d}$ is a unit vector, $\\mathbf{d}\\cdot\\mathbf{d}=1$. This is a standard quadratic equation in $t$: $at^2+bt+c=0$ with coefficients:\n- $a = 1$\n- $b = 2(\\mathbf{v}\\cdot\\mathbf{d})$\n- $c = (\\mathbf{v}\\cdot\\mathbf{v}) - r_h^2$\n\nThe discriminant is $\\Delta = b^2 - 4ac$.\n- If $\\Delta < 0$, the line does not intersect the sphere. Condition 2 is false.\n- If $\\Delta \\ge 0$, there is at least one intersection point. The solutions for $t$ are:\n$$ t_{i1, i2} = \\frac{-b \\pm \\sqrt{\\Delta}}{2a} = -(\\mathbf{v}\\cdot\\mathbf{d}) \\pm \\sqrt{(\\mathbf{v}\\cdot\\mathbf{d})^2 - ((\\mathbf{v}\\cdot\\mathbf{v}) - r_h^2)} $$\nThese two values, $t_{i1}$ and $t_{i2}$ (with $t_{i1} \\le t_{i2}$), define the interval along the infinite line that is inside the sphere.\n\nFor an injury to occur, the needle's path segment posterior to the sternum, $[t_T, L]$, must overlap with the sphere's intersection interval, $[t_{i1}, t_{i2}]$. Two intervals $[a, b]$ and $[c, d]$ overlap if and only if $a \\le d$ and $c \\le b$.\nThus, Condition 2 is met if $L > t_T$, $\\Delta \\ge 0$, and the intervals overlap:\n$$ t_T \\le t_{i2} \\quad \\text{and} \\quad t_{i1} \\le L $$\n\n**Summary of the Algorithm**\n\nThe final algorithm for a given set of parameters is:\n1. Convert angles $\\alpha$ and $\\varphi$ to radians. If $\\alpha \\ge 90^\\circ$, return `False`.\n2. Compute the direction vector $\\mathbf{d}$.\n3. Check Condition 1:\n    a. Verify the entry point $(x_0, y_0)$ is within the foramen radius $R$. If not, return `False`.\n    b. Calculate $t_T = T/\\cos\\alpha_{\\text{rad}}$ and the corresponding exit point's $xy$-coordinates. Verify this point is within the foramen radius $R$. If not, return `False`.\n4. Check Condition 2:\n    a. If the needle length $L \\le t_T$, return `False`.\n    b. Set up and solve the quadratic equation for line-sphere intersection. If the discriminant is negative, return `False`.\n    c. Find the intersection interval $[t_{i1}, t_{i2}]$.\n    d. Check for overlap between $[t_T, L]$ and $[t_{i1}, t_{i2}]$. If they overlap, return `True`. Otherwise, return `False`.\n\nThis procedure is applied to each test case to generate the final list of results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the sternal puncture risk assessment problem for a suite of test cases.\n    \"\"\"\n\n    def evaluate_risk(x0, y0, alpha_deg, phi_deg, L, T, xf, yf, R, xh, yh, zh, rh):\n        \"\"\"\n        Evaluates the risk of iatrogenic cardiac injury for a single needle trajectory.\n\n        Args:\n            x0, y0 (float): Needle entry coordinates (mm).\n            alpha_deg (float): Elevation angle from z-axis (degrees).\n            phi_deg (float): Azimuth angle from x-axis (degrees).\n            L (float): Needle trajectory length (mm).\n            T (float): Sternal thickness (mm).\n            xf, yf (float): Foramen center coordinates (mm).\n            R (float): Foramen radius (mm).\n            xh, yh, zh (float): Heart sphere center coordinates (mm).\n            rh (float): Heart sphere radius (mm).\n\n        Returns:\n            bool: True if injury risk exists, False otherwise.\n        \"\"\"\n        # Convert angles to radians\n        alpha_rad = np.deg2rad(alpha_deg)\n        phi_rad = np.deg2rad(phi_deg)\n\n        # The needle must advance posteriorly (positive z-direction).\n        # cos(alpha) > 0 implies alpha is in [0, 90) degrees.\n        # If alpha is 90 degrees, cos(alpha) is 0, needle moves parallel to sternum.\n        # If alpha > 90, it moves away from the heart.\n        if alpha_deg >= 90.0:\n            return False\n\n        # 1. Formulate the needle trajectory\n        # Direction vector d from spherical coordinates\n        d = np.array([\n            np.sin(alpha_rad) * np.cos(phi_rad),\n            np.sin(alpha_rad) * np.sin(phi_rad),\n            np.cos(alpha_rad)\n        ])\n        \n        # Start point p0\n        p0 = np.array([x0, y0, 0.0])\n\n        # 2. Check Condition 1: Foramen Pass-Through\n        foramen_center_2d = np.array([xf, yf])\n        \n        # Check entry point at t=0\n        entry_point_2d = p0[:2]\n        if np.linalg.norm(entry_point_2d - foramen_center_2d)**2 > R**2:\n            return False\n            \n        # Check exit point from sternum at z=T\n        # z(t) = t * d_z => t_T = T / d_z\n        t_sternum_exit = T / d[2]\n        \n        exit_point_3d = p0 + t_sternum_exit * d\n        exit_point_2d = exit_point_3d[:2]\n\n        if np.linalg.norm(exit_point_2d - foramen_center_2d)**2 > R**2:\n            return False\n\n        # 3. Check Condition 2: Heart Intersection\n        # Needle must be long enough to exit the sternum\n        if L <= t_sternum_exit:\n            return False\n\n        # Line-segment-sphere intersection test\n        heart_center = np.array([xh, yh, zh])\n        v = p0 - heart_center\n        \n        # Solve quadratic equation for t: a*t^2 + b*t + c = 0\n        # where a=1, b=2*(v.d), c=(v.v) - rh^2\n        dot_v_d = np.dot(v, d)\n        dot_v_v = np.dot(v, v)\n        \n        # Discriminant of the quadratic equation\n        discriminant = dot_v_d**2 - (dot_v_v - rh**2)\n        \n        if discriminant < 0:\n            return False # Line misses the sphere entirely\n        \n        sqrt_discriminant = np.sqrt(discriminant)\n        \n        # Intersection interval of the infinite line with the sphere\n        t_intersect1 = -dot_v_d - sqrt_discriminant\n        t_intersect2 = -dot_v_d + sqrt_discriminant\n        \n        # The relevant segment of the needle path is [t_sternum_exit, L]\n        # Check for overlap between [t_sternum_exit, L] and [t_intersect1, t_intersect2]\n        # Overlap exists if start1 <= end2 and start2 <= end1\n        if t_sternum_exit <= t_intersect2 and t_intersect1 <= L:\n            return True\n        else:\n            return False\n\n    # Default anatomical model parameters\n    default_params = {\n        'T': 12.0,       # Sternal thickness (mm)\n        'xf': 0.0,       # Foramen center x (mm)\n        'yf': 0.0,       # Foramen center y (mm)\n        'R': 3.5,        # Foramen radius (mm)\n        'xh': 0.0,       # Heart center x (mm)\n        'yh': 0.0,       # Heart center y (mm)\n        'zh': 37.0,      # Heart center z (mm)\n        'rh': 15.0       # Heart radius (mm)\n    }\n\n    # Test suite of needle trajectories\n    test_cases = [\n        # Test case 1\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 0.0, 'phi_deg': 0.0, 'L': 60.0},\n        # Test case 2\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 20.0, 'phi_deg': 90.0, 'L': 60.0},\n        # Test case 3\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 0.0, 'phi_deg': 0.0, 'L': 20.0},\n        # Test case 4\n        {'x0': 2.0, 'y0': 0.0, 'alpha_deg': 10.0, 'phi_deg': 180.0, 'L': 60.0},\n        # Test case 5 (with overridden heart center)\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 0.0, 'phi_deg': 0.0, 'L': 60.0, 'xh': 30.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Combine default params with case-specific params\n        params = default_params.copy()\n        params.update(case)\n        result = evaluate_risk(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5153241"}]}