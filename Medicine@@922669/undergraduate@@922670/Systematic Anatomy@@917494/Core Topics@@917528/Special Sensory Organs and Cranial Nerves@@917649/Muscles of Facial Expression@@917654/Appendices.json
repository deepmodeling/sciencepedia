{"hands_on_practices": [{"introduction": "To understand how a complex expression is formed, we can model individual muscles as force vectors. This exercise demonstrates how the principles of vector addition can be used to predict the movement of the corner of the mouth (the modiolus) when several muscles contract simultaneously. By resolving each muscle's pull into horizontal and vertical components, you can calculate the net displacement, providing a quantitative link between muscle anatomy and visible facial movement [@problem_id:5128137].", "problem": "A planar biomechanical model of the lip corner (the modiolus) is used to approximate the actions of selected muscles of facial expression as forces applied along their anatomical lines of pull. Let the lip corner be modeled as the origin of a two-dimensional coordinate system with the $x$-axis oriented laterally (to the subject's right) and the $y$-axis oriented superiorly. The soft tissues around the lip corner are approximated as two orthogonal linear springs that resist motion independently in the $x$ and $y$ directions, with stiffnesses $k_{x}$ and $k_{y}$, respectively. Assume superposition of forces and linear elasticity are valid.\n\nThe following muscles are activated simultaneously:\n- Zygomaticus major, exerting a force of magnitude $F_{z} = 2.8$ newtons along a line of pull that makes an angle of $\\theta_{z} = 30^{\\circ}$ above the positive $x$-axis.\n- Levator anguli oris, exerting a force of magnitude $F_{l} = 1.6$ newtons along a line of pull that makes an angle of $\\theta_{l} = 65^{\\circ}$ above the positive $x$-axis.\n- Depressor anguli oris, exerting a force of magnitude $F_{d} = 1.1$ newtons along a line of pull that makes an angle of $\\theta_{d} = -40^{\\circ}$ (below the positive $x$-axis).\n\nThe tissue stiffnesses are $k_{x} = 450$ newtons per meter and $k_{y} = 600$ newtons per meter. Angles are given in degrees; use standard trigonometric functions that take radian arguments when performing calculations. Using a first-principles approach based on vector addition of forces and Hookeâ€™s law, compute the resultant displacement vector of the lip corner, $\\Delta \\mathbf{r} = (\\Delta x, \\Delta y)$, in millimeters.\n\nExpress your final answer as a two-component row vector in millimeters and round each component to four significant figures. State angles in degrees and express the displacement in millimeters as instructed.", "solution": "The fundamental principle governing this system is static equilibrium. The lip corner will be displaced until the reactive force from the surrounding tissue, modeled as springs, exactly balances the resultant force exerted by the activated muscles. The total force on the system at equilibrium is zero.\n$$ \\mathbf{F}_{\\text{total}} = \\mathbf{F}_{\\text{muscles}} + \\mathbf{F}_{\\text{restore}} = \\mathbf{0} $$\nThis implies that the muscle force is equal and opposite to the restoring force:\n$$ \\mathbf{F}_{\\text{muscles}} = - \\mathbf{F}_{\\text{restore}} $$\n\nFirst, we resolve each muscle force vector into its components in the specified coordinate system. Let $\\mathbf{F}_{z}$, $\\mathbf{F}_{l}$, and $\\mathbf{F}_{d}$ be the force vectors for the Zygomaticus major, Levator anguli oris, and Depressor anguli oris, respectively.\nThe components are given by:\n$$ \\mathbf{F}_{z} = \\begin{pmatrix} F_{z} \\cos(\\theta_{z}) \\\\ F_{z} \\sin(\\theta_{z}) \\end{pmatrix} $$\n$$ \\mathbf{F}_{l} = \\begin{pmatrix} F_{l} \\cos(\\theta_{l}) \\\\ F_{l} \\sin(\\theta_{l}) \\end{pmatrix} $$\n$$ \\mathbf{F}_{d} = \\begin{pmatrix} F_{d} \\cos(\\theta_{d}) \\\\ F_{d} \\sin(\\theta_{d}) \\end{pmatrix} $$\n\nThe total muscle force, $\\mathbf{F}_{\\text{muscles}}$, is the vector sum of these individual forces, by the principle of superposition.\n$$ \\mathbf{F}_{\\text{muscles}} = \\mathbf{F}_{z} + \\mathbf{F}_{l} + \\mathbf{F}_{d} $$\nLet the components of the total muscle force be $F_{\\text{muscles},x}$ and $F_{\\text{muscles},y}$.\n$$ F_{\\text{muscles},x} = F_{z} \\cos(\\theta_{z}) + F_{l} \\cos(\\theta_{l}) + F_{d} \\cos(\\theta_{d}) $$\n$$ F_{\\text{muscles},y} = F_{z} \\sin(\\theta_{z}) + F_{l} \\sin(\\theta_{l}) + F_{d} \\sin(\\theta_{d}) $$\n\nThe restoring force, $\\mathbf{F}_{\\text{restore}}$, is provided by the orthogonal springs. For a displacement vector $\\Delta \\mathbf{r} = (\\Delta x, \\Delta y)$, Hooke's Law gives the restoring force components as:\n$$ F_{\\text{restore},x} = -k_{x} \\Delta x $$\n$$ F_{\\text{restore},y} = -k_{y} \\Delta y $$\nSo, the restoring force vector is:\n$$ \\mathbf{F}_{\\text{restore}} = \\begin{pmatrix} -k_{x} \\Delta x \\\\ -k_{y} \\Delta y \\end{pmatrix} $$\n\nAt equilibrium, we have $F_{\\text{muscles},x} = -F_{\\text{restore},x}$ and $F_{\\text{muscles},y} = -F_{\\text{restore},y}$.\n$$ F_{z} \\cos(\\theta_{z}) + F_{l} \\cos(\\theta_{l}) + F_{d} \\cos(\\theta_{d}) = k_{x} \\Delta x $$\n$$ F_{z} \\sin(\\theta_{z}) + F_{l} \\sin(\\theta_{l}) + F_{d} \\sin(\\theta_{d}) = k_{y} \\Delta y $$\n\nWe can now solve for the displacement components $\\Delta x$ and $\\Delta y$:\n$$ \\Delta x = \\frac{1}{k_{x}} \\left( F_{z} \\cos(\\theta_{z}) + F_{l} \\cos(\\theta_{l}) + F_{d} \\cos(\\theta_{d}) \\right) $$\n$$ \\Delta y = \\frac{1}{k_{y}} \\left( F_{z} \\sin(\\theta_{z}) + F_{l} \\sin(\\theta_{l}) + F_{d} \\sin(\\theta_{d}) \\right) $$\n\nBefore substituting the numerical values, the angles must be converted from degrees to radians, as trigonometric functions in computational contexts standardly operate on radians. The conversion is $\\theta_{\\text{rad}} = \\theta_{\\text{deg}} \\times \\frac{\\pi}{180}$.\n- $\\theta_{z} = 30^{\\circ} = \\frac{\\pi}{6}$ rad\n- $\\theta_{l} = 65^{\\circ} = 65 \\frac{\\pi}{180}$ rad\n- $\\theta_{d} = -40^{\\circ} = -40 \\frac{\\pi}{180}$ rad\n\nNow, we substitute the given values:\n$F_{z} = 2.8$ N, $F_{l} = 1.6$ N, $F_{d} = 1.1$ N\n$k_{x} = 450$ N/m, $k_{y} = 600$ N/m\n\nCalculate the total force component in the $x$-direction:\n$$ F_{\\text{muscles},x} = (2.8)\\cos(30^{\\circ}) + (1.6)\\cos(65^{\\circ}) + (1.1)\\cos(-40^{\\circ}) $$\n$$ F_{\\text{muscles},x} \\approx (2.8)(0.866025) + (1.6)(0.422618) + (1.1)(0.766044) $$\n$$ F_{\\text{muscles},x} \\approx 2.42487 + 0.676189 + 0.842648 \\approx 3.943707 \\text{ N} $$\n\nCalculate the total force component in the $y$-direction:\n$$ F_{\\text{muscles},y} = (2.8)\\sin(30^{\\circ}) + (1.6)\\sin(65^{\\circ}) + (1.1)\\sin(-40^{\\circ}) $$\n$$ F_{\\text{muscles},y} \\approx (2.8)(0.5) + (1.6)(0.906308) + (1.1)(-0.642788) $$\n$$ F_{\\text{muscles},y} \\approx 1.4 + 1.450093 - 0.707067 \\approx 2.143026 \\text{ N} $$\n\nNow, compute the displacement components in meters:\n$$ \\Delta x = \\frac{F_{\\text{muscles},x}}{k_{x}} \\approx \\frac{3.943707 \\text{ N}}{450 \\text{ N/m}} \\approx 0.00876379 \\text{ m} $$\n$$ \\Delta y = \\frac{F_{\\text{muscles},y}}{k_{y}} \\approx \\frac{2.143026 \\text{ N}}{600 \\text{ N/m}} \\approx 0.00357171 \\text{ m} $$\n\nThe problem requires the answer in millimeters. We convert the results:\n$$ \\Delta x \\approx 0.00876379 \\text{ m} \\times \\frac{1000 \\text{ mm}}{1 \\text{ m}} \\approx 8.76379 \\text{ mm} $$\n$$ \\Delta y \\approx 0.00357171 \\text{ m} \\times \\frac{1000 \\text{ mm}}{1 \\text{ m}} \\approx 3.57171 \\text{ mm} $$\n\nFinally, we round each component to four significant figures as instructed:\n$$ \\Delta x \\approx 8.764 \\text{ mm} $$\n$$ \\Delta y \\approx 3.572 \\text{ mm} $$\n\nThe resultant displacement vector $\\Delta \\mathbf{r}$ in millimeters is $(\\Delta x, \\Delta y) = (8.764, 3.572)$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 8.764 & 3.572 \\end{pmatrix} } $$", "id": "5128137"}, {"introduction": "Facial movements often involve rotation around soft-tissue pivots, not just simple linear pulling. This practice introduces a more sophisticated biomechanical model that uses the concept of torque to analyze the action of the zygomaticus major in creating a smile. By balancing the muscle's activating torque against the resistive torques of elastic facial tissues, you can calculate the force required to achieve a specific elevation of the lip corner, offering deeper insight into the mechanics of facial expression [@problem_id:5128140].", "problem": "In a simplified biomechanical model of smiling, the oral commissure (modiolus) is treated as a point that undergoes a small upward displacement against passive tissues of the perioral complex. The tissues are modeled as two elastic elements acting in parallel about a pivot located in the perioral tissues: (1) a linear translational spring that resists vertical displacement with stiffness $k_{y}$, and (2) a rotational spring that resists rotation about the pivot with stiffness $K_{\\theta}$. The zygomaticus major acts with a constant effective moment arm $a$ about the same pivot over the small range of motion considered. For small motions, the geometry is approximated by $y = r \\theta$, where $y$ is the vertical elevation of the oral commissure, $\\theta$ is the rotation about the pivot in radians, and $r$ is the radius from the pivot to the oral commissure. Assume quasi-static equilibrium and neglect inertia.\n\nGiven the following parameters: desired oral commissure elevation $y = 5\\,\\mathrm{mm}$, linear stiffness $k_{y} = 150\\,\\mathrm{N/m}$, rotational stiffness $K_{\\theta} = 0.15\\,\\mathrm{N\\cdot m/rad}$, pivot radius $r = 25\\,\\mathrm{mm}$, and effective moment arm $a = 12\\,\\mathrm{mm}$, compute the magnitude of the zygomaticus major force $F_{m}$ required to achieve this elevation.\n\nUse radians for $\\theta$, assume the small-angle relation $y = r \\theta$ holds, and model static equilibrium by balancing torques about the pivot. Express your final answer in newtons and round to three significant figures.", "solution": "The solution is based on the principle of static equilibrium, where the sum of torques about the pivot point must be zero. The activating torque generated by the zygomaticus major muscle must balance the sum of the resistive torques from the passive perioral tissues, which are modeled as a rotational spring and a linear spring.\n\nLet $F_m$ be the magnitude of the force exerted by the zygomaticus major muscle. The activating torque, $\\tau_m$, is given by the product of this force and its effective moment arm, $a$:\n$$ \\tau_m = F_m a $$\n\nThe resistive torque is the sum of two components:\n1. The torque from the rotational spring, $\\tau_{\\theta}$, which is proportional to the angle of rotation, $\\theta$, with a stiffness constant $K_{\\theta}$:\n$$ \\tau_{\\theta} = K_{\\theta} \\theta $$\n2. The torque from the linear translational spring, $\\tau_y$. This spring resists vertical displacement, $y$, with a vertical force $F_y = k_y y$. For a small rotation $\\theta$, this vertical force is applied at a horizontal distance from the pivot that is approximately equal to the radius, $r$. Thus, the torque generated by this force is:\n$$ \\tau_y \\approx F_y r = (k_y y) r $$\n\nThe condition for quasi-static equilibrium is that the activating torque equals the total resistive torque:\n$$ \\tau_m = \\tau_{\\theta} + \\tau_y $$\nSubstituting the expressions for the torques gives the equilibrium equation:\n$$ F_m a = K_{\\theta} \\theta + k_y y r $$\n\nThe problem provides a geometric relationship for small angles: $y = r \\theta$. We can solve this for the angle $\\theta$:\n$$ \\theta = \\frac{y}{r} $$\nSubstituting this expression for $\\theta$ into the equilibrium equation eliminates $\\theta$ and allows us to solve for $F_m$ in terms of the given parameters:\n$$ F_m a = K_{\\theta} \\left(\\frac{y}{r}\\right) + k_y y r $$\nSolving for $F_m$:\n$$ F_m = \\frac{1}{a} \\left( \\frac{K_{\\theta} y}{r} + k_y y r \\right) $$\nWe can factor out the common term $y$ to simplify the expression:\n$$ F_m = \\frac{y}{a} \\left( \\frac{K_{\\theta}}{r} + k_y r \\right) $$\n\nNext, we substitute the given numerical values. It is imperative to use a consistent set of units. We will convert all lengths to meters to be consistent with the SI units of the stiffness constants.\nGiven values in SI units:\n- $y = 5\\,\\mathrm{mm} = 5 \\times 10^{-3}\\,\\mathrm{m}$\n- $k_y = 150\\,\\mathrm{N/m}$\n- $K_{\\theta} = 0.15\\,\\mathrm{N\\cdot m/rad}$\n- $r = 25\\,\\mathrm{mm} = 25 \\times 10^{-3}\\,\\mathrm{m} = 0.025\\,\\mathrm{m}$\n- $a = 12\\,\\mathrm{mm} = 12 \\times 10^{-3}\\,\\mathrm{m} = 0.012\\,\\mathrm{m}$\n\nSubstitute these values into the equation for $F_m$:\n$$ F_m = \\frac{5 \\times 10^{-3}}{12 \\times 10^{-3}} \\left( \\frac{0.15}{0.025} + (150)(0.025) \\right) $$\nFirst, evaluate the terms inside the parentheses:\n$$ \\frac{K_{\\theta}}{r} = \\frac{0.15\\,\\mathrm{N\\cdot m}}{0.025\\,\\mathrm{m}} = 6\\,\\mathrm{N} $$\n$$ k_y r = (150\\,\\mathrm{N/m})(0.025\\,\\mathrm{m}) = 3.75\\,\\mathrm{N} $$\nNow, substitute these results back into the equation for $F_m$:\n$$ F_m = \\frac{5}{12} \\left( 6\\,\\mathrm{N} + 3.75\\,\\mathrm{N} \\right) = \\frac{5}{12} (9.75\\,\\mathrm{N}) $$\nPerforming the final multiplication:\n$$ F_m = \\frac{5 \\times 9.75}{12}\\,\\mathrm{N} = \\frac{48.75}{12}\\,\\mathrm{N} = 4.0625\\,\\mathrm{N} $$\nThe problem requires the answer to be rounded to three significant figures.\n$$ F_m \\approx 4.06\\,\\mathrm{N} $$\nThis is the magnitude of the force required from the zygomaticus major muscle to achieve the desired elevation of the oral commissure under the specified model conditions.", "answer": "$$\\boxed{4.06}$$", "id": "5128140"}, {"introduction": "Anatomical descriptions of muscle synergy, like the co-activation of zygomaticus major and orbicularis oculi in a Duchenne smile, can be quantitatively verified using physiological data. This hands-on programming exercise bridges anatomy with data analysis by having you process electromyography (EMG) signals. By calculating the correlation between the activity of these two muscles, you will learn a fundamental technique used in biomechanics and neuroscience to confirm and quantify the coordinated patterns of muscle function during expressive movements [@problem_id:5128189].", "problem": "You are given discrete Electromyography (EMG) time series for the zygomaticus major and the orbicularis oculi, along with a binary label sequence indicating moments of a Duchenne smile. In systematic anatomy, the Duchenne smile is defined by co-activation of the zygomaticus major and the orbicularis oculi. In electrophysiological terms, Electromyography (EMG) amplitude is treated as a discrete-time sequence representing motor unit activation intensity. To assess synchrony between these muscles during Duchenne smiles, compute the linear correlation coefficient between the two EMG sequences over each contiguous segment where the Duchenne label equals $1$.\n\nFundamental base and definitions to be used:\n- A Duchenne smile segment is defined as a maximal contiguous index set $S$ such that the label $l_i = 1$ for all $i \\in S$ and $l_{i-1} = 0$ (or $i$ is the first index) and $l_{i+1} = 0$ (or $i$ is the last index). The aim is to measure linear synchrony between the EMG amplitude of zygomaticus major and orbicularis oculi during each $S$.\n- The EMG signals are modeled as discrete sequences $x_i$ (zygomaticus major) and $y_i$ (orbicularis oculi), with $i$ indexing time samples at sampling frequency $f_s$ measured in $\\mathrm{Hz}$. EMG amplitude values are measured in microvolts $\\mu \\mathrm{V}$; the correlation coefficient is dimensionless.\n- Your program must treat the correlation coefficient as undefined if the variation of either signal within a segment is zero (standard deviation equals $0$) or the segment length is less than $2$. To maintain testability, adopt the convention that such segments return a correlation coefficient of $0.0$.\n\nTask requirements:\n- For each test case, identify all contiguous Duchenne smile segments (where $l_i = 1$) and compute the linear correlation coefficient between $\\{x_i\\}_{i \\in S}$ and $\\{y_i\\}_{i \\in S}$ for each segment $S$.\n- Round each correlation coefficient to $4$ decimal places.\n- The final output is dimensionless; no physical units should be included in the output.\n\nTest suite:\n- Test case $1$ (happy path, two Duchenne segments, positive synchrony):\n  - $x$ (zygomaticus major EMG, $\\mu \\mathrm{V}$): $\\{0.0, 0.5, 1.0, 1.5, 2.0, 0.0, 0.0, 0.4, 0.8, 1.2\\}$\n  - $y$ (orbicularis oculi EMG, $\\mu \\mathrm{V}$): $\\{0.0, 0.55, 0.95, 1.45, 2.05, 0.0, 0.0, 0.42, 0.78, 1.25\\}$\n  - $l$ (Duchenne labels): $\\{0, 1, 1, 1, 1, 0, 0, 1, 1, 1\\}$\n- Test case $2$ (boundary case, zero variance in one signal within the Duchenne segment):\n  - $x$: $\\{0, 1, 1, 1, 1, 0\\}$\n  - $y$: $\\{0, 0.5, 0.7, 1.0, 1.3, 0\\}$\n  - $l$: $\\{0, 1, 1, 1, 1, 0\\}$\n- Test case $3$ (edge case, strong anti-correlation, two segments):\n  - $x$: $\\{0, 1, 2, 3, 0, 2, 1, 0\\}$\n  - $y$: $\\{0, -1, -2, -3, 0, -2, -1, 0\\}$\n  - $l$: $\\{0, 1, 1, 1, 0, 1, 1, 0\\}$\n- Test case $4$ (edge case, single-sample Duchenne segment):\n  - $x$: $\\{0, 2, 0\\}$\n  - $y$: $\\{0, 5, 0\\}$\n  - $l$: $\\{0, 1, 0\\}$\n\nAnswer specification:\n- For each test case, the answer is a list of floats, each being the rounded correlation coefficient for one Duchenne segment found in that test case, ordered by segment occurrence from earliest to latest in the sequence.\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list of these lists, enclosed in square brackets. For example, in the format $\\left[\\left[r_{1,1}, r_{1,2}\\right], \\left[r_{2,1}\\right], \\left[r_{3,1}, r_{3,2}\\right], \\left[r_{4,1}\\right]\\right]$, with each $r_{i,j}$ rounded to $4$ decimal places.", "solution": "The user-provided problem has been rigorously validated and is determined to be a valid and well-posed scientific question. It is scientifically grounded in systematic anatomy and electrophysiology, with a clearly defined computational task based on standard statistical methods. The problem statement is complete, objective, and internally consistent.\n\nThe solution to this problem involves two primary stages: first, identifying the discrete time segments corresponding to Duchenne smiles, and second, computing the linear correlation coefficient for the electromyography (EMG) signals within each of these segments.\n\n### Stage 1: Duchenne Smile Segment Identification\nThe input includes a binary label sequence, $l$, where $l_i = 1$ indicates the presence of a Duchenne smile at time index $i$. A Duchenne smile segment is defined as a maximal contiguous block of indices where the label is $1$. The algorithm to identify these segments is as follows:\n1.  Initialize a pointer, $i$, to the beginning of the label sequence ($i=0$).\n2.  Iterate through the sequence until the end is reached.\n3.  If $l_i = 0$, advance the pointer ($i \\leftarrow i+1$) and continue.\n4.  If $l_i = 1$, a segment has started at index $start = i$.\n5.  Find the end of this contiguous segment by advancing a second pointer, $end$, from $start$ until either $l_{end+1} = 0$ or the end of the sequence is reached.\n6.  The identified segment spans the indices from $start$ to $end$, inclusive. The corresponding subsequences from the EMG time series $x$ (zygomaticus major) and $y$ (orbicularis oculi) are extracted.\n7.  The main pointer is then updated to $i \\leftarrow end+1$ to search for the next segment.\n\nThis process is repeated for the entire label sequence, yielding an ordered list of all Duchenne smile segments.\n\n### Stage 2: Linear Correlation Coefficient Computation\nFor each identified segment $S$, we compute the Pearson linear correlation coefficient, $r$, between the EMG subsequences $\\{x_i\\}_{i \\in S}$ and $\\{y_i\\}_{i \\in S}$. The formula for $r$ is:\n$$ r = \\frac{\\sum_{i \\in S} (x_i - \\bar{x}_S)(y_i - \\bar{y}_S)}{\\sqrt{\\sum_{i \\in S} (x_i - \\bar{x}_S)^2} \\sqrt{\\sum_{i \\in S} (y_i - \\bar{y}_S)^2}} $$\nwhere $\\bar{x}_S$ and $\\bar{y}_S$ are the arithmetic means of the subsequences $\\{x_i\\}_{i \\in S}$ and $\\{y_i\\}_{i \\in S}$, respectively. The value of $r$ ranges from $-1$ (perfect negative correlation) to $+1$ (perfect positive correlation), with $0$ indicating no linear correlation.\n\nThe problem specifies handling for cases where the correlation coefficient is mathematically undefined. These conditions and the corresponding actions are:\n1.  **Segment Length**: If the number of samples in the segment, $|S|$, is less than $2$ (i.e., $|S|  2$), the correlation is undefined.\n2.  **Zero Variance**: If either subsequence has zero variance (i.e., its standard deviation, $\\sigma_x$ or $\\sigma_y$, is $0$), the denominator of the correlation formula becomes zero, making the coefficient undefined.\n\n**Convention**: For any of these undefined cases, the problem mandates assigning a correlation value of $0.0$. This ensures a determinate output for all segments.\n\nThe computational procedure for each segment is therefore:\n1.  Extract the subsequences $x_S$ and $y_S$.\n2.  Check if the length of the subsequences is less than $2$. If so, the correlation is $0.0$.\n3.  Check if the standard deviation of either $x_S$ or $y_S$ is $0$. If so, the correlation is $0.0$.\n4.  If neither of the above conditions is met, compute the Pearson correlation coefficient $r$.\n5.  Round the final value of $r$ to $4$ decimal places.\n\n### Example Walkthrough: Test Case 1\n- **Given**:\n  - $x = \\{0.0, 0.5, 1.0, 1.5, 2.0, 0.0, 0.0, 0.4, 0.8, 1.2\\}$\n  - $y = \\{0.0, 0.55, 0.95, 1.45, 2.05, 0.0, 0.0, 0.42, 0.78, 1.25\\}$\n  - $l = \\{0, 1, 1, 1, 1, 0, 0, 1, 1, 1\\}$\n\n- **Segment Identification**:\n  - Segment $S_1$: starts at index $1$, ends at index $4$. Indices are $\\{1, 2, 3, 4\\}$.\n  - Segment $S_2$: starts at index $7$, ends at index $9$. Indices are $\\{7, 8, 9\\}$.\n\n- **Correlation for $S_1$**:\n  - $x_{S_1} = \\{0.5, 1.0, 1.5, 2.0\\}$. Length is $4 \\ge 2$, standard deviation is non-zero.\n  - $y_{S_1} = \\{0.55, 0.95, 1.45, 2.05\\}$. Length is $4 \\ge 2$, standard deviation is non-zero.\n  - The calculated correlation is $r_1 \\approx 0.9960237$. Rounded to $4$ decimal places, this is $0.9960$.\n\n- **Correlation for $S_2$**:\n  - $x_{S_2} = \\{0.4, 0.8, 1.2\\}$. Length is $3 \\ge 2$, standard deviation is non-zero.\n  - $y_{S_2} = \\{0.42, 0.78, 1.25\\}$. Length is $3 \\ge 2$, standard deviation is non-zero.\n  - The calculated correlation is $r_2 \\approx 0.997165...$. Rounded to $4$ decimal places, this is $0.9972$.\n\n- **Result for Test Case 1**: The list of correlations is $[0.9960, 0.9972]$.\n\nThis comprehensive procedure is applied to all test cases to generate the final output. The implementation utilizes the `numpy` library for efficient and accurate numerical computation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the linear correlation coefficient for EMG signals during Duchenne smiles.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"x\": [0.0, 0.5, 1.0, 1.5, 2.0, 0.0, 0.0, 0.4, 0.8, 1.2],\n            \"y\": [0.0, 0.55, 0.95, 1.45, 2.05, 0.0, 0.0, 0.42, 0.78, 1.25],\n            \"l\": [0, 1, 1, 1, 1, 0, 0, 1, 1, 1]\n        },\n        {\n            \"x\": [0, 1, 1, 1, 1, 0],\n            \"y\": [0, 0.5, 0.7, 1.0, 1.3, 0],\n            \"l\": [0, 1, 1, 1, 1, 0]\n        },\n        {\n            \"x\": [0, 1, 2, 3, 0, 2, 1, 0],\n            \"y\": [0, -1, -2, -3, 0, -2, -1, 0],\n            \"l\": [0, 1, 1, 1, 0, 1, 1, 0]\n        },\n        {\n            \"x\": [0, 2, 0],\n            \"y\": [0, 5, 0],\n            \"l\": [0, 1, 0]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        x, y, l = case[\"x\"], case[\"y\"], case[\"l\"]\n        \n        # Convert to numpy arrays for easier slicing and computation\n        x_np = np.array(x, dtype=float)\n        y_np = np.array(y, dtype=float)\n        l_np = np.array(l, dtype=int)\n        \n        case_results = []\n        i = 0\n        n_samples = len(l_np)\n        \n        while i  n_samples:\n            # Find the start of the next Duchenne smile segment\n            if l_np[i] == 0:\n                i += 1\n                continue\n            \n            # Found the start of a segment\n            start_index = i\n            \n            # Find the end of the segment\n            end_index = start_index\n            while end_index + 1  n_samples and l_np[end_index + 1] == 1:\n                end_index += 1\n            \n            # Extract subsequences for the segment\n            x_segment = x_np[start_index : end_index + 1]\n            y_segment = y_np[start_index : end_index + 1]\n            \n            segment_len = len(x_segment)\n            \n            # Apply conditions for undefined correlation\n            if segment_len  2 or np.std(x_segment) == 0 or np.std(y_segment) == 0:\n                corr_coeff = 0.0\n            else:\n                # Calculate Pearson correlation coefficient\n                corr_matrix = np.corrcoef(x_segment, y_segment)\n                corr_coeff = corr_matrix[0, 1]\n\n            # Round to 4 decimal places and append\n            case_results.append(round(corr_coeff, 4))\n            \n            # Move index to the end of the processed segment\n            i = end_index + 1\n            \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format [[...],[...],...]\n    # Using str() on a list of lists produces the required format with spaces.\n    # The example in the prompt is [[r_1,1, r_1,2], [r_2,1], ...], which has spaces.\n    print(all_results)\n\nsolve()\n```", "id": "5128189"}]}