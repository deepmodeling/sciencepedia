{"hands_on_practices": [{"introduction": "Understanding cerebral vascular territories begins with the fundamental physics of blood flow. This exercise explores how collateral vessels compensate for an arterial occlusion, a critical mechanism for preserving brain tissue. By applying the Hagen–Poiseuille law, a foundational principle of fluid dynamics, you will quantify the powerful relationship between a vessel's radius and the volume of blood it can carry, revealing why even small changes in vessel diameter can have a profound impact on cerebral perfusion [@problem_id:5095705].", "problem": "A cortical branch in the Middle Cerebral Artery (MCA) territory becomes dependent on pial collaterals from the Anterior Cerebral Artery (ACA) after a proximal MCA occlusion. Assume the dominant collateral segment supplying this branch is a straight, cylindrical vessel with laminar flow of a Newtonian fluid and that systemic autoregulation maintains a constant pressure drop across the collateral. The vessel length and blood viscosity remain unchanged during an acute vasodilatory response, so the only parameter that can change is the vessel radius. Starting from the Hagen–Poiseuille law for laminar flow in a cylindrical tube and using the described physiological constraints, determine the minimal fractional increase in collateral vessel radius required to double the volumetric flow to the affected MCA cortical branch.\n\nExpress your final answer as a decimal fraction without a percent sign, and round your answer to four significant figures.", "solution": "The cortical branch is supplied via pial collaterals that can dilate to increase flow. Under the assumptions provided, the appropriate fundamental base is the Hagen–Poiseuille law for laminar flow of a Newtonian fluid in a rigid cylindrical tube. The volumetric flow rate $Q$ through a vessel of radius $r$ and length $L$ under pressure drop $\\Delta P$ with dynamic viscosity $\\mu$ is\n$$\nQ \\;=\\; \\frac{\\pi \\,\\Delta P\\, r^{4}}{8\\, \\mu\\, L}.\n$$\nIn the physiological scenario, the pressure drop $\\Delta P$ is maintained constant by systemic autoregulation and the Circle of Willis, blood viscosity $\\mu$ is taken as constant over the time scale of the response, and the vessel length $L$ is fixed. Therefore, the only changing parameter is the radius $r$.\n\nLet $Q_{\\text{old}}$ and $r_{\\text{old}}$ denote the initial flow and radius, and $Q_{\\text{new}}$ and $r_{\\text{new}}$ denote the post-dilation flow and radius. Taking the ratio of the Hagen–Poiseuille expressions with $\\Delta P$, $\\mu$, and $L$ held constant yields\n$$\n\\frac{Q_{\\text{new}}}{Q_{\\text{old}}}\n\\;=\\;\n\\left( \\frac{r_{\\text{new}}}{r_{\\text{old}}} \\right)^{4}.\n$$\nWe are asked to find the minimal fractional increase in radius needed to double the flow, i.e., to achieve $Q_{\\text{new}}/Q_{\\text{old}} = 2$. Set\n$$\n2 \\;=\\; \\left( \\frac{r_{\\text{new}}}{r_{\\text{old}}} \\right)^{4}.\n$$\nSolving for the radius ratio gives\n$$\n\\frac{r_{\\text{new}}}{r_{\\text{old}}} \\;=\\; 2^{1/4}.\n$$\nThe fractional increase in radius $\\delta$ is defined as\n$$\n\\delta \\;=\\; \\frac{r_{\\text{new}} - r_{\\text{old}}}{r_{\\text{old}}}\n\\;=\\;\n\\frac{r_{\\text{new}}}{r_{\\text{old}}} - 1\n\\;=\\;\n2^{1/4} - 1.\n$$\nThis is a dimensionless quantity. To provide the requested numerical value, compute $2^{1/4}$ and round the final decimal fraction to four significant figures:\n$$\n2^{1/4} \\approx 1.189207115\\quad \\Rightarrow \\quad \\delta \\approx 1.189207115 - 1 = 0.189207115.\n$$\nRounded to four significant figures, the minimal fractional increase is\n$$\n0.1892.\n$$", "answer": "$$\\boxed{0.1892}$$", "id": "5095705"}, {"introduction": "A core skill in neurology is localizing a lesion based on a patient's symptoms. This process is a form of diagnostic reasoning, where knowledge of anatomy and vascular territories is combined with clinical evidence. This practice problem formalizes this reasoning process using Bayes' theorem, allowing you to calculate the probability of a lesion's location given a specific set of neurological deficits and pre-existing data on stroke frequencies [@problem_id:5095773]. This exercise demonstrates how physicians can quantitatively update their diagnostic hypotheses in light of new clinical findings.", "problem": "A patient presents with a constellation of deficits consistent with brainstem localization: contralateral pure motor hemiparesis without sensory loss, ipsilateral horizontal gaze palsy consistent with involvement of the abducens nucleus, and dysarthria. The medial (paramedian) pontine region supplied by paramedian perforators of the basilar artery contains the corticospinal tract and the abducens nucleus and is classically implicated in such a pattern, whereas the lateral pontine region supplied by circumferential branches more commonly affects spinothalamic and trigeminal systems resulting in sensory deficits rather than isolated motor signs.\n\nFrom a curated registry of basilar artery territory ischemic events, the prior occlusion rates of pontine branches are as follows: paramedian pontine penetrating branches, $14$ per $1000$ events; circumferential pontine branches, $26$ per $1000$ events. In an advanced clinical series correlating vascular territory with bedside examination, the probability of observing the described deficit pattern given a lesion in the paramedian pons is $0.76$, whereas the probability of observing the same pattern given a lesion in the lateral pons is $0.10$.\n\nAssuming the lesion is confined to the pons and that the above two territories exhaust the pontine possibilities, use appropriate Bayesian reasoning to compute the posterior probability that the lesion localizes to the paramedian pons given the observed deficits and the stated priors. Express your final answer as a decimal rounded to four significant figures.", "solution": "This problem requires the application of Bayes' theorem to update the probability of a lesion's location based on clinical evidence.\n\nLet us define the following events:\n-   $M$: The event that the ischemic lesion is in the paramedian pons.\n-   $L$: The event that the ischemic lesion is in the lateral pons.\n-   $D$: The event that the patient presents with the described deficits (the data).\n\nWe are asked to find the posterior probability $P(M|D)$.\n\nFirst, we determine the prior probabilities for the lesion location, $P(M)$ and $P(L)$. The problem states the occlusion rates for paramedian and lateral pontine branches are $14$ per $1000$ and $26$ per $1000$ events, respectively. Since we assume the lesion is confined to the pons and these two territories are exhaustive, we must normalize these rates to find the prior probabilities. The total rate for these pontine events is $14 + 26 = 40$.\nThe prior probability of a paramedian lesion is:\n$$P(M) = \\frac{14}{14+26} = \\frac{14}{40} = 0.35$$\nThe prior probability of a lateral lesion is:\n$$P(L) = \\frac{26}{14+26} = \\frac{26}{40} = 0.65$$\nNote that these probabilities sum to $1.0$.\n\nNext, we use the conditional probabilities (likelihoods) provided in the problem statement:\n-   The probability of observing the deficits given a paramedian lesion is $P(D|M) = 0.76$.\n-   The probability of observing the deficits given a lateral lesion is $P(D|L) = 0.10$.\n\nWe apply Bayes' theorem, which states $P(M|D) = \\frac{P(D|M)P(M)}{P(D)}$. The denominator, $P(D)$, is the total probability of observing the deficits, calculated using the law of total probability:\n$$P(D) = P(D|M)P(M) + P(D|L)P(L)$$\nThe full formula is:\n$$P(M|D) = \\frac{P(D|M)P(M)}{P(D|M)P(M) + P(D|L)P(L)}$$\nNow, we substitute the numerical values:\n$$P(M|D) = \\frac{(0.76)(0.35)}{(0.76)(0.35) + (0.10)(0.65)}$$\n$$P(M|D) = \\frac{0.266}{0.266 + 0.065} = \\frac{0.266}{0.331}$$\nPerforming the final division:\n$$P(M|D) \\approx 0.80362537764...$$\nRounding the result to four significant figures gives:\n$$P(M|D) \\approx 0.8036$$", "answer": "$$\\boxed{0.8036}$$", "id": "5095773"}, {"introduction": "Modern neurology relies heavily on quantitative analysis of medical images to diagnose and manage strokes. This problem provides a hands-on introduction to this computational approach by tasking you with calculating the volume of an infarct from simulated brain imaging data. By defining an infarct based on a Cerebral Blood Flow (CBF) threshold and a specific vascular territory (the MCA), you will learn the basic principles of voxel-based analysis, a technique used to turn complex imaging data into a clinically meaningful measurement of tissue damage [@problem_id:5095706].", "problem": "A three-dimensional brain image is discretized into congruent voxels of edge length $2\\,\\mathrm{mm}$, each voxel representing a rectangular prism whose volume follows from the geometric formula for the volume of a cube. The cortical territory of the Middle Cerebral Artery (MCA) is represented by a binary mask over the same grid, where a mask value of $1$ denotes membership in the MCA cortical territory and a value of $0$ denotes non-membership. A corresponding array of Cerebral Blood Flow (CBF) values, measured in $\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$, is defined on the same grid. Using the definition of volume for a set in a discretized space as the sum of the volumes of its constituent voxels, derive from first principles an algorithm that computes the infarct volume in the MCA cortical territory defined as the total volume of voxels that both belong to the MCA cortical territory and satisfy the hemodynamic threshold $CBF<18\\,\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$. Use the following foundational facts: (i) the volume of a cube with edge length $a$ is $a^3$, and (ii) $1\\,\\mathrm{cm}^3=1\\,\\mathrm{mL}$ and $1\\,\\mathrm{cm}=10\\,\\mathrm{mm}$. Express the final infarct volume in $\\mathrm{mL}$, rounded to three decimal places.\n\nYour program must implement this computation for the following test suite. Each test case consists of a CBF array and a binary MCA mask array of identical shape, given as slices along the third dimension. All comparisons to the threshold must be strictly less than (values exactly equal to the threshold must not be counted).\n\nTest case $1$ (shape $2\\times 2\\times 2$):\n- CBF slices (in $\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$):\n  - $z=0$: $\\begin{bmatrix}25 & 12 \\\\ 30 & 17\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}40 & 22 \\\\ 15 & 10\\end{bmatrix}$\n- MCA mask slices:\n  - $z=0$: $\\begin{bmatrix}1 & 1 \\\\ 0 & 1\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}1 & 0 \\\\ 1 & 1\\end{bmatrix}$\n\nTest case $2$ (shape $2\\times 2\\times 2$; boundary values around the threshold $18$):\n- CBF slices (in $\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$):\n  - $z=0$: $\\begin{bmatrix}18 & 18 \\\\ 17.9 & 18.1\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}5 & 50 \\\\ 18 & 17.999\\end{bmatrix}$\n- MCA mask slices:\n  - $z=0$: $\\begin{bmatrix}1 & 1 \\\\ 1 & 1\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}1 & 1 \\\\ 1 & 1\\end{bmatrix}$\n\nTest case $3$ (shape $2\\times 2\\times 2$; low CBF values exist but are outside the MCA mask):\n- CBF slices (in $\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$):\n  - $z=0$: $\\begin{bmatrix}10 & 16 \\\\ 12 & 14\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}7 & 9 \\\\ 19 & 20\\end{bmatrix}$\n- MCA mask slices:\n  - $z=0$: $\\begin{bmatrix}0 & 0 \\\\ 0 & 0\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}0 & 0 \\\\ 1 & 1\\end{bmatrix}$\n\nTest case $4$ (shape $3\\times 3\\times 1$):\n- CBF slice (in $\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$) at $z=0$:\n  $\\begin{bmatrix}10 & 20 & 17 \\\\ 18 & 18.0 & 16 \\\\ 30 & 12 & 22\\end{bmatrix}$\n- MCA mask slice at $z=0$:\n  $\\begin{bmatrix}1 & 1 & 1 \\\\ 1 & 0 & 1 \\\\ 1 & 1 & 0\\end{bmatrix}$\n\nRequirements:\n- Use a strict threshold $CBF<18$; do not include voxels with $CBF=18$.\n- Each voxel has edge length $2\\,\\mathrm{mm}$.\n- Express each computed infarct volume in $\\mathrm{mL}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, for example, $[v_1,v_2,v_3,v_4]$, where each $v_i$ is a float in $\\mathrm{mL}$ rounded to three decimal places.", "solution": "The objective is to compute the total volume of infarcted tissue within the Middle Cerebral Artery (MCA) territory. This volume is the sum of the volumes of all voxels where the MCA mask value is $1$ and the Cerebral Blood Flow (CBF) is strictly less than $18\\,\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$.\n\nFirst, we calculate the volume of a single voxel. With an edge length of $a = 2\\,\\mathrm{mm}$, the voxel volume is $v_{voxel} = a^3 = 8\\,\\mathrm{mm}^3$. We convert this to milliliters ($\\mathrm{mL}$) using the relation $1\\,\\mathrm{mL} = 1\\,\\mathrm{cm}^3 = (10\\,\\mathrm{mm})^3 = 1000\\,\\mathrm{mm}^3$.\n$$v_{voxel} (\\mathrm{in~mL}) = 8\\,\\mathrm{mm}^3 \\times \\frac{1\\,\\mathrm{mL}}{1000\\,\\mathrm{mm}^3} = 0.008\\,\\mathrm{mL}$$\n\nThe algorithm is to find the total number of voxels, $N_{infarct}$, that satisfy both conditions ($M_{ijk} = 1$ and $C_{ijk} < 18$) and then calculate the total volume as $V_{infarct} = N_{infarct} \\times v_{voxel}$.\n\nApplying this procedure to the test cases by iterating through all voxels yields the following counts of infarcted voxels:\n-   **Test case 1:** $N_{infarct} = 4$. $V_{infarct} = 4 \\times 0.008 = 0.032\\,\\mathrm{mL}$.\n-   **Test case 2:** $N_{infarct} = 3$. $V_{infarct} = 3 \\times 0.008 = 0.024\\,\\mathrm{mL}$.\n-   **Test case 3:** $N_{infarct} = 0$. $V_{infarct} = 0 \\times 0.008 = 0.000\\,\\mathrm{mL}$.\n-   **Test case 4:** $N_{infarct} = 4$. $V_{infarct} = 4 \\times 0.008 = 0.032\\,\\mathrm{mL}$.\n\nThe results for the four test cases are $[0.032, 0.024, 0.000, 0.032]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes infarct volume for a set of test cases based on CBF and MCA mask data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (shape 2x2x2)\n        (\n            np.array([[[25, 12], [30, 17]], [[40, 22], [15, 10]]]), # CBF\n            np.array([[[1, 1], [0, 1]], [[1, 0], [1, 1]]])  # MCA mask\n        ),\n        # Test case 2 (shape 2x2x2)\n        (\n            np.array([[[18, 18], [17.9, 18.1]], [[5, 50], [18, 17.999]]]), # CBF\n            np.array([[[1, 1], [1, 1]], [[1, 1], [1, 1]]])  # MCA mask\n        ),\n        # Test case 3 (shape 2x2x2)\n        (\n            np.array([[[10, 16], [12, 14]], [[7, 9], [19, 20]]]), # CBF\n            np.array([[[0, 0], [0, 0]], [[0, 0], [1, 1]]])  # MCA mask\n        ),\n        # Test case 4 (shape 3x3x1)\n        (\n            np.array([[[10, 20, 17], [18, 18.0, 16], [30, 12, 22]]]), # CBF\n            np.array([[[1, 1, 1], [1, 0, 1], [1, 1, 0]]])  # MCA mask\n        ),\n    ]\n\n    # --- Calculation based on first principles ---\n\n    # 1. Voxel volume calculation\n    # Voxel edge length in millimeters, as given.\n    voxel_edge_mm = 2\n    # Volume of a single voxel in cubic millimeters (a^3).\n    voxel_vol_mm3 = voxel_edge_mm ** 3  # (2 mm)^3 = 8 mm^3\n\n    # 2. Unit conversion\n    # Conversion from cubic millimeters to milliliters.\n    # 1 cm = 10 mm => 1 cm^3 = 1000 mm^3.\n    # 1 cm^3 = 1 mL.\n    # Therefore, 1 mL = 1000 mm^3.\n    voxel_vol_ml = voxel_vol_mm3 / 1000.0  # 8 / 1000 = 0.008 mL\n\n    # 3. CBF threshold\n    # The hemodynamic threshold for infarct, as defined in the problem.\n    cbf_threshold = 18.0\n\n    results = []\n    for cbf_data, mca_mask in test_cases:\n        # --- Algorithm for Infarct Volume Computation ---\n\n        # Create a boolean mask for voxels with CBF below the threshold.\n        # The comparison must be strictly less than.\n        is_low_cbf = cbf_data < cbf_threshold\n\n        # Create a boolean mask for voxels within the MCA territory.\n        # The input MCA mask is already binary (0 or 1).\n        is_in_mca = mca_mask.astype(bool)\n\n        # Combine the two conditions using a logical AND operation.\n        # A voxel is considered part of the infarct if it is in the MCA\n        # territory AND has a low CBF value.\n        infarct_mask = np.logical_and(is_low_cbf, is_in_mca)\n\n        # Count the total number of voxels that satisfy both conditions.\n        infarct_voxel_count = np.sum(infarct_mask)\n\n        # Calculate the total infarct volume by multiplying the count by\n        # the volume of a single voxel.\n        total_infarct_volume_ml = infarct_voxel_count * voxel_vol_ml\n        \n        # Round the final volume to three decimal places as required.\n        rounded_volume = round(total_infarct_volume_ml, 3)\n        results.append(rounded_volume)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) handles cases like 0.0 correctly.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5095706"}]}