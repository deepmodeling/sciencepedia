{"hands_on_practices": [{"introduction": "To truly grasp the mechanics of a nested case-control study, we must start with the foundation: the sampling process itself. At each event time, how likely is any given at-risk individual to be chosen as a control? This exercise challenges you to derive this fundamental probability from first principles, providing insight into the statistical underpinnings of why the design works so effectively.", "problem": "In a nested case-control design at failure time $t_i$, a single incident case is identified within the risk set $R(t_i)$. The risk set $R(t_i)$ has size $Y(t_i)$, defined as the number of individuals at risk just prior to $t_i$ (including the case who fails at $t_i$). From the eligible controls, defined as $R(t_i) \\setminus \\{\\text{case at } t_i\\}$, a fixed number $m$ of controls are selected by Simple Random Sampling (SRS) without replacement. Consider an individual $j$ such that $j \\in R(t_i)$ and $j$ is not the case at $t_i$. Using only the definitions of SRS without replacement and basic combinatorial counting, derive the probability that $j$ is selected as one of the $m$ controls at time $t_i$. Express your final answer as a single simplified analytic expression in terms of $m$ and $Y(t_i)$. No rounding is required, and no units should be included.", "solution": "The problem statement will first be validated for scientific soundness, clarity, and completeness.\n\n### Step 1: Extract Givens\n- Study Design: Nested case-control.\n- Event Time: $t_i$.\n- Case Identification: A single incident case is identified at $t_i$.\n- Risk Set: $R(t_i)$ is the set of individuals at risk just prior to $t_i$.\n- Size of Risk Set: $Y(t_i) = |R(t_i)|$.\n- Eligible Controls: The set of individuals in $R(t_i)$ excluding the case, i.e., $R(t_i) \\setminus \\{\\text{case at } t_i\\}$.\n- Control Selection: A fixed number $m$ of controls are selected from the eligible controls.\n- Sampling Method: Simple Random Sampling (SRS) without replacement.\n- Individual of Interest: An individual $j$ such that $j \\in R(t_i)$ and $j$ is not the case at $t_i$.\n- Objective: Derive the probability that individual $j$ is selected as one of the $m$ controls at time $t_i$.\n- Methodological Constraint: Use only the definitions of SRS without replacement and basic combinatorial counting.\n- Final Expression: The result must be a single simplified analytic expression in terms of $m$ and $Y(t_i)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard theoretical question in epidemiology and biostatistics concerning study design and sampling theory. The concepts of a risk set, case-control sampling, and SRS without replacement are well-defined. The problem is well-posed, with a clear objective and sufficient information to derive a unique solution. The language is objective and precise. The givens are self-consistent and the setup is standard for analyzing the properties of a nested case-control design. No flaws listed in the validation criteria are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to find the probability that a specific individual $j$, who is an eligible control, is selected into the sample of $m$ controls. We will use combinatorial principles as stipulated.\n\nLet the set of eligible controls at time $t_i$ be denoted by $C_{elig}$. The total number of individuals in the risk set $R(t_i)$ is $Y(t_i)$. This set includes the single case that fails at $t_i$. The set of eligible controls consists of all individuals in the risk set except for this one case.\nTherefore, the total number of eligible controls is:\n$$ |C_{elig}| = Y(t_i) - 1 $$\n\nWe are selecting a sample of $m$ controls from this set of $Y(t_i) - 1$ eligible controls using Simple Random Sampling (SRS) without replacement.\n\nThe total number of distinct samples of size $m$ that can be drawn from the population of $Y(t_i) - 1$ eligible controls is given by the binomial coefficient \"N choose k\", where $N = Y(t_i) - 1$ and $k = m$.\n$$ \\text{Total number of possible samples} = \\binom{Y(t_i) - 1}{m} $$\nThis represents the size of the sample space, where each outcome is an equally likely combination of $m$ individuals.\n\nNext, we must determine the number of these samples that include our specific individual of interest, $j$. If individual $j$ is to be included in the sample, then we have already accounted for one of the $m$ spots in the sample. We must then choose the remaining $m-1$ controls from the remaining pool of eligible controls.\n\nThe size of the remaining pool of eligible controls, after fixing that $j$ is selected, is the original number of eligible controls minus individual $j$.\n$$ \\text{Number of remaining eligible controls} = (Y(t_i) - 1) - 1 = Y(t_i) - 2 $$\n\nThe number of ways to choose the remaining $m-1$ controls from this pool of $Y(t_i) - 2$ individuals is:\n$$ \\text{Number of samples containing } j = \\binom{Y(t_i) - 2}{m-1} $$\nThis represents the number of favorable outcomes.\n\nThe probability of an event is the ratio of the number of favorable outcomes to the total number of possible outcomes. Therefore, the probability that individual $j$ is selected is:\n$$ P(j \\text{ is selected}) = \\frac{\\text{Number of samples containing } j}{\\text{Total number of possible samples}} = \\frac{\\binom{Y(t_i) - 2}{m-1}}{\\binom{Y(t_i) - 1}{m}} $$\n\nTo simplify this expression, we expand the binomial coefficients using their definition, $\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$.\n$$ \\binom{Y(t_i) - 2}{m-1} = \\frac{(Y(t_i) - 2)!}{(m-1)!((Y(t_i) - 2) - (m-1))!} = \\frac{(Y(t_i) - 2)!}{(m-1)!(Y(t_i) - m - 1)!} $$\n$$ \\binom{Y(t_i) - 1}{m} = \\frac{(Y(t_i) - 1)!}{m!((Y(t_i) - 1) - m)!} = \\frac{(Y(t_i) - 1)!}{m!(Y(t_i) - m - 1)!} $$\n\nNow, we compute the ratio:\n$$ P(j \\text{ is selected}) = \\frac{\\frac{(Y(t_i) - 2)!}{(m-1)!(Y(t_i) - m - 1)!}}{\\frac{(Y(t_i) - 1)!}{m!(Y(t_i) - m - 1)!}} $$\nWe can cancel the common term $(Y(t_i) - m - 1)!$ from the numerator and the denominator's fraction.\n$$ P(j \\text{ is selected}) = \\frac{(Y(t_i) - 2)!}{(m-1)!} \\times \\frac{m!}{(Y(t_i) - 1)!} $$\nNow, we expand the factorial terms $m! = m \\times (m-1)!$ and $(Y(t_i) - 1)! = (Y(t_i) - 1) \\times (Y(t_i) - 2)!$.\n$$ P(j \\text{ is selected}) = \\frac{(Y(t_i) - 2)!}{(m-1)!} \\times \\frac{m \\cdot (m-1)!}{(Y(t_i) - 1) \\cdot (Y(t_i) - 2)!} $$\nCanceling the terms $(m-1)!$ and $(Y(t_i) - 2)!$ leaves us with the simplified expression.\n$$ P(j \\text{ is selected}) = \\frac{m}{Y(t_i) - 1} $$\nThis is the probability that any given eligible control $j$ is selected to be in the matched set of $m$ controls at time $t_i$. This result is contingent on the physical constraint that the number of controls to be sampled, $m$, does not exceed the number of available eligible controls, i.e., $m \\leq Y(t_i) - 1$.", "answer": "$$\\boxed{\\frac{m}{Y(t_i) - 1}}$$", "id": "4614280"}, {"introduction": "A frequent point of confusion is the \"rare disease assumption,\" which is necessary for the odds ratio to approximate the risk ratio in traditional case-control studies. The nested case-control design, however, possesses a remarkable property: it can provide an unbiased estimate of the hazard ratio even when the disease is common. This practice uses a small, clear, hypothetical dataset to demonstrate this principle, solidifying your understanding of one of the design's major strengths [@problem_id:4614275].", "problem": "A closed cohort of size $N = 10$ is followed from baseline until a fixed administrative end of follow-up. Exposure $X \\in \\{0,1\\}$ is fixed at baseline and does not change over time. Event times are distinct. Assume the data-generating mechanism follows a Cox proportional hazards (CPH) model with hazard function $\\lambda(t \\mid X) = \\lambda_{0}(t)\\exp(\\beta X)$, where $\\lambda_{0}(t)$ is an unknown baseline hazard and $\\beta$ is a constant log hazard ratio. The true parameter is $\\exp(\\beta^{\\star}) = 3$. Over follow-up, $6$ of the $10$ individuals experience the event, so the outcome is common in this cohort, with cumulative incidence $6/10 = 0.6$. A nested case-control study is conducted using incidence density sampling: at each of the $6$ distinct event times, one control is sampled uniformly at random from the risk set just before that event time, forming $6$ matched pairs (the case and the sampled control).\n\nThe resulting nested case-control sample contains the following matched pairs of exposure statuses $(X_{\\text{case}}, X_{\\text{control}})$, in chronological order of the $6$ event times:\n- Pair $1$: $(1,0)$\n- Pair $2$: $(1,1)$\n- Pair $3$: $(0,1)$\n- Pair $4$: $(1,0)$\n- Pair $5$: $(0,0)$\n- Pair $6$: $(1,0)$\n\nStarting only from the CPH model assumption $\\lambda(t \\mid X) = \\lambda_{0}(t)\\exp(\\beta X)$ and the definition of incidence density sampling of risk sets in a nested case-control design, derive the conditional likelihood for the matched pairs with one control per case, and show how it reduces to a function of the number of discordant pairs and the number of discordant pairs in which the case is exposed. Then, compute the conditional logistic regression estimator of the hazard ratio $\\exp(\\beta)$ from the $6$ pairs above. Finally, compare this estimate to the true hazard ratio $\\exp(\\beta^{\\star}) = 3$ to demonstrate that the nested case-control conditional logistic regression remains unbiased for the hazard ratio even when the outcome is common in the underlying cohort.\n\nReport the estimated hazard ratio $\\exp(\\hat{\\beta})$ as a single number rounded to four significant figures. No units are required.", "solution": "We begin from the Cox proportional hazards (CPH) model $\\lambda(t \\mid X) = \\lambda_{0}(t)\\exp(\\beta X)$ and the construction of a nested case-control study by incidence density sampling, in which controls are sampled uniformly from the risk set immediately prior to each failure time. For each failure time indexed by $i$, let $\\mathcal{R}_{i}$ denote the risk set just prior to that event time, and suppose one control is sampled uniformly at random from $\\mathcal{R}_{i} \\setminus \\{\\text{case}\\}$. The resulting matched set at time $t_{i}$ contains the case and one sampled control.\n\nUnder the CPH model, the partial likelihood for the full cohort can be written as the product over failure times $i$ of\n$$\n\\frac{\\exp(\\beta X_{i,\\text{case}})}{\\sum_{j \\in \\mathcal{R}_{i}} \\exp(\\beta X_{ij})}.\n$$\nIncidence density sampling with one control per case replaces the denominator by a term proportional to the sum over the matched set (case and sampled control), because the sampling scheme yields a conditional likelihood that, given the sampled set, depends on $\\beta$ only through the relative hazards within the set. Specifically, given a matched set of size $2$ at time $t_{i}$ with exposures $(X_{i,\\text{case}}, X_{i,\\text{control}})$, the conditional probability that the case has exposure $X_{i,\\text{case}}$ rather than $X_{i,\\text{control}}$ is\n$$\n\\Pr\\{\\text{case has } X_{i,\\text{case}} \\mid X_{i,\\text{case}}, X_{i,\\text{control}}\\}\n= \\frac{\\exp(\\beta X_{i,\\text{case}})}{\\exp(\\beta X_{i,\\text{case}}) + \\exp(\\beta X_{i,\\text{control}})}.\n$$\nThis follows from the CPH model because, within a risk set, the instantaneous risk of being the case at $t_{i}$ is proportional to $\\exp(\\beta X)$, and conditioning on the matched set eliminates $\\lambda_{0}(t_{i})$ and the sizes of the full risk sets. Therefore, the conditional likelihood over all $m$ matched pairs (here $m = 6$) is\n$$\nL(\\beta) = \\prod_{i=1}^{m} \\frac{\\exp(\\beta X_{i,\\text{case}})}{\\exp(\\beta X_{i,\\text{case}}) + \\exp(\\beta X_{i,\\text{control}})}.\n$$\n\nConsider the contributions by pair type:\n- If a pair is concordant, $X_{i,\\text{case}} = X_{i,\\text{control}}$, then the contribution is\n$$\n\\frac{\\exp(\\beta X)}{\\exp(\\beta X) + \\exp(\\beta X)} = \\frac{1}{2},\n$$\nwhich does not depend on $\\beta$ and thus carries no information for estimating $\\beta$.\n- If a pair is discordant, say $(X_{i,\\text{case}}, X_{i,\\text{control}}) = (1,0)$, then the contribution is\n$$\n\\frac{\\exp(\\beta)}{\\exp(\\beta) + 1} = \\frac{\\exp(\\beta)}{1 + \\exp(\\beta)}.\n$$\nIf the pair is discordant with $(X_{i,\\text{case}}, X_{i,\\text{control}}) = (0,1)$, then the contribution is\n$$\n\\frac{1}{1 + \\exp(\\beta)}.\n$$\n\nLet $D$ denote the total number of discordant pairs and let $Y$ denote the number of discordant pairs in which the case is exposed, i.e., the number of pairs of type $(1,0)$. The conditional likelihood up to a multiplicative constant (dropping the concordant pairsâ€™ constant contributions) is\n$$\nL(\\beta) \\propto \\left(\\frac{\\exp(\\beta)}{1 + \\exp(\\beta)}\\right)^{Y} \\left(\\frac{1}{1 + \\exp(\\beta)}\\right)^{D - Y}.\n$$\nThe log-likelihood is\n$$\n\\ell(\\beta) = Y \\beta - D \\ln\\!\\left(1 + \\exp(\\beta)\\right) + \\text{constant}.\n$$\nDifferentiating with respect to $\\beta$ and setting the derivative to zero yields the score equation\n$$\n\\frac{d\\ell(\\beta)}{d\\beta} = Y - D \\cdot \\frac{\\exp(\\beta)}{1 + \\exp(\\beta)} = 0.\n$$\nSolving for $\\exp(\\beta)$,\n$$\nY = D \\cdot \\frac{\\exp(\\beta)}{1 + \\exp(\\beta)}\n\\;\\;\\Longrightarrow\\;\\;\nY\\left(1 + \\exp(\\beta)\\right) = D \\exp(\\beta)\n\\;\\;\\Longrightarrow\\;\\;\nY = \\exp(\\beta)\\left(D - Y\\right)\n\\;\\;\\Longrightarrow\\;\\;\n\\exp(\\hat{\\beta}) = \\frac{Y}{D - Y}.\n$$\n\nWe now compute $Y$ and $D$ from the observed pairs. The $6$ pairs are:\n- Pair $1$: $(1,0)$ discordant with case exposed\n- Pair $2$: $(1,1)$ concordant\n- Pair $3$: $(0,1)$ discordant with case unexposed\n- Pair $4$: $(1,0)$ discordant with case exposed\n- Pair $5$: $(0,0)$ concordant\n- Pair $6$: $(1,0)$ discordant with case exposed\n\nThus, the number of discordant pairs is $D = 4$ (pairs $1$, $3$, $4$, $6$), and the number with the case exposed is $Y = 3$ (pairs $1$, $4$, $6$). Therefore,\n$$\n\\exp(\\hat{\\beta}) = \\frac{Y}{D - Y} = \\frac{3}{4 - 3} = 3.\n$$\n\nThis conditional logistic regression (which is the conditional likelihood corresponding to matched sets) estimator of the hazard ratio equals $3$, which matches the true hazard ratio $\\exp(\\beta^{\\star}) = 3$ by construction. Crucially, this equality arises from the risk set sampling and the CPH model structure, not from any rare disease assumption. The outcome is common in the cohort, with cumulative incidence $6/10 = 0.6$, yet the estimator correctly recovers the hazard ratio, demonstrating unbiasedness of the nested case-control conditional logistic regression for the hazard ratio even when the outcome is common.\n\nRounding the estimated hazard ratio to four significant figures yields $3.000$.", "answer": "$$\\boxed{3.000}$$", "id": "4614275"}, {"introduction": "While the nested case-control design samples controls at each event time, the case-cohort design takes a different approach by selecting a representative 'subcohort' at baseline. A crucial question for researchers is, \"How many people will we actually need to test?\" This exercise guides you through calculating the expected number of measurements, a vital step for budgeting resources and assessing the feasibility of a case-cohort study [@problem_id:4614262].", "problem": "A population-based cohort study follows a fixed cohort of size $N$ from baseline until a prespecified end of follow-up. During follow-up, a total of $D$ incident cases of a disease occur within the cohort. Investigators plan a case-cohort study to measure an expensive biomarker at a second phase of data collection. Under the case-cohort design, a subcohort is selected at baseline by Simple Random Sampling (SRS) without replacement, with subcohort sampling fraction $f$ (so the subcohort size is $fN$). The design stipulates that the expensive biomarker will be measured in phase $2$ only for (i) all members of the subcohort, and (ii) all incident cases that are not already members of the subcohort. If a case happens to be in the subcohort, it is measured once as a subcohort member; no duplication occurs. Assume subcohort selection is non-informative with respect to case status, that is, membership in the subcohort is independent of the disease occurrence process, and that the $D$ cases arise uniformly in the sense that any cohort member is equally likely to become a case.\n\nUsing only fundamental definitions of SRS and expectations from probability theory, derive the expected number of phase $2$ biomarker measurements required by this case-cohort design as a closed-form analytic expression in terms of $N$, $f$, and $D$. Express your final answer as a simplified expression. No numerical evaluation is required, and no rounding is necessary.", "solution": "The problem statement is a well-posed question in the field of biostatistics and epidemiology, grounded in the principles of probability theory and sampling. It is self-contained, scientifically sound, and free of contradictions or ambiguities. Therefore, a solution can be derived.\n\nThe objective is to determine the expected number of unique individuals who will have their biomarker measured in a case-cohort study. The design specifies that measurements are taken for all members of a randomly selected subcohort and any additional cases that fall outside this subcohort.\n\nLet $N$ be the total number of individuals in the fixed cohort.\nLet $D$ be the total number of incident cases that occur within the cohort.\nLet $f$ be the sampling fraction for the subcohort, selected by Simple Random Sampling (SRS) without replacement at baseline.\nThe size of the subcohort is therefore $n_{sc} = fN$.\n\nLet $S$ denote the set of individuals in the subcohort, so $|S| = fN$.\nLet $C$ denote the set of individuals who become cases, so $|C| = D$.\nThe set of individuals who receive a biomarker measurement, which we will denote by $M_{set}$, is the union of the set of subcohort members and the set of cases. This is because an individual is measured if they are in the subcohort, or if they are a case. The condition \"no duplication occurs\" is naturally handled by the definition of a set union.\n$$ M_{set} = S \\cup C $$\nThe total number of required measurements is the size of this set, $|M_{set}|$. We are asked to find the expected value of this quantity, $E[|M_{set}|]$.\n\nUsing the principle of inclusion-exclusion for the cardinality of the union of two sets, we can write:\n$$ |M_{set}| = |S \\cup C| = |S| + |C| - |S \\cap C| $$\nHere, $|S \\cap C|$ is the number of individuals who are both cases and members of the subcohort.\n\nWe can now take the expectation of this expression. By the linearity of expectation:\n$$ E[|M_{set}|] = E[|S| + |C| - |S \\cap C|] = E[|S|] + E[|C|] - E[|S \\cap C|] $$\nThe problem states that the cohort size $N$, the number of cases $D$, and the sampling fraction $f$ are fixed quantities. Therefore, the size of the subcohort $|S| = fN$ and the number of cases $|C| = D$ are constants, not random variables. Their expectation is simply their value.\n$$ E[|S|] = fN $$\n$$ E[|C|] = D $$\nThe term $|S \\cap C|$ is a random variable, as it represents the number of cases that happen to be selected into the randomly chosen subcohort. Our task reduces to finding the expectation of this random variable, $E[|S \\cap C|]$.\n\nLet $X = |S \\cap C|$. To find $E[X]$ from first principles, we can use the method of indicator variables. Let the $D$ cases be indexed from $j=1$ to $D$. For each case $j$, we define an indicator random variable $I_j$:\n$$ I_j = \\begin{cases} 1 & \\text{if case } j \\text{ is in the subcohort } S \\\\ 0 & \\text{if case } j \\text{ is not in the subcohort } S \\end{cases} $$\nThe total number of cases in the subcohort is the sum of these indicator variables:\n$$ X = \\sum_{j=1}^{D} I_j $$\nBy the linearity of expectation:\n$$ E[X] = E\\left[\\sum_{j=1}^{D} I_j\\right] = \\sum_{j=1}^{D} E[I_j] $$\nThe expectation of an indicator variable is the probability of the event it indicates:\n$$ E[I_j] = 1 \\cdot P(I_j = 1) + 0 \\cdot P(I_j = 0) = P(I_j = 1) $$\n$P(I_j = 1)$ is the probability that a specific individual (in this instance, case $j$) is included in the subcohort. The subcohort is formed by a Simple Random Sample (SRS) of size $fN$ drawn without replacement from the total cohort of $N$ individuals.\n\nThe total number of possible subcohorts of size $fN$ from a cohort of size $N$ is given by the binomial coefficient $\\binom{N}{fN}$.\nFor a specific individual to be included in the subcohort, we must choose that individual and then choose the remaining $fN-1$ members of the subcohort from the remaining $N-1$ individuals in the cohort. The number of ways to do this is $\\binom{1}{1}\\binom{N-1}{fN-1} = \\binom{N-1}{fN-1}$.\n\nTherefore, the probability of inclusion for any given individual is:\n$$ P(I_j = 1) = \\frac{\\text{Number of subcohorts containing individual } j}{\\text{Total number of possible subcohorts}} = \\frac{\\binom{N-1}{fN-1}}{\\binom{N}{fN}} $$\nLet's simplify this expression:\n$$ \\frac{\\binom{N-1}{fN-1}}{\\binom{N}{fN}} = \\frac{\\frac{(N-1)!}{(fN-1)!(N-1 - (fN-1))!}}{\\frac{N!}{(fN)!(N-fN)!}} = \\frac{(N-1)!}{(fN-1)!(N-fN)!} \\cdot \\frac{(fN)!(N-fN)!}{N!} $$\nWe can cancel the $(N-fN)!$ terms and expand the other factorials:\n$$ \\frac{(N-1)!}{N!} \\cdot \\frac{(fN)!}{(fN-1)!} = \\frac{(N-1)!}{N \\cdot (N-1)!} \\cdot \\frac{fN \\cdot (fN-1)!}{(fN-1)!} = \\frac{1}{N} \\cdot fN = f $$\nThus, the probability for any individual to be selected into the subcohort is simply the sampling fraction $f$. This is a fundamental property of SRS. The problem states that subcohort selection is non-informative with respect to case status, so this probability applies equally to cases and non-cases.\nTherefore, $E[I_j] = f$ for all $j=1, \\ldots, D$.\n\nNow we can compute $E[X]$:\n$$ E[X] = \\sum_{j=1}^{D} E[I_j] = \\sum_{j=1}^{D} f = Df $$\nSo, the expected number of cases in the subcohort is $Df$. This result could also be stated directly as the mean of a hypergeometric distribution with population size $N$, $D$ successes, and sample size $fN$, which is $(fN) \\cdot (D/N) = fD$.\n\nFinally, we substitute this result back into the expression for the expected total number of measurements:\n$$ E[|M_{set}|] = |S| + |C| - E[|S \\cap C|] $$\n$$ E[|M_{set}|] = fN + D - Df $$\nThis expression can be simplified by factoring out $D$:\n$$ E[|M_{set}|] = fN + D(1 - f) $$\nThis is the closed-form analytic expression for the expected number of phase $2$ biomarker measurements.", "answer": "$$\\boxed{fN + D(1 - f)}$$", "id": "4614262"}]}