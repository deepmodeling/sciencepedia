{"hands_on_practices": [{"introduction": "The Difference-in-Differences (DiD) design is a cornerstone of quasi-experimental analysis, valued for its intuitive approach to estimating treatment effects. Its credibility, however, rests entirely on the parallel trends assumption: that the treatment and control groups would have followed similar trends in the absence of the intervention. This exercise ([@problem_id:4626142]) formalizes this concept within the potential outcomes framework, challenging you to derive the precise bias that arises when this crucial assumption is violated.", "problem": "Consider a canonical two-period and two-group Difference-in-Differences (DiD) setup in epidemiology, where a policy exposure affects only the treated group in the post period. Let groups be indexed by $g \\in \\{T, C\\}$ for treated and control, and time by $t \\in \\{0,1\\}$ for pre and post. Let $Y_{gt}(d)$ denote the potential outcome for group $g$ at time $t$ under exposure status $d \\in \\{0,1\\}$. Assume the Stable Unit Treatment Value Assumption (SUTVA) holds and the additive treatment response is constant for the treated group only in the post period, so that $Y_{T1}(1) - Y_{T1}(0) = \\tau$, $Y_{T0}(1) - Y_{T0}(0) = 0$, $Y_{C1}(1) - Y_{C1}(0) = 0$, and $Y_{C0}(1) - Y_{C0}(0) = 0$. The Average Treatment Effect on the Treated (ATT) is defined as $\\tau$. The Difference-in-Differences (DiD) estimator is constructed from observed outcomes $Y_{gt}$ as the post-minus-pre difference in the treated group, minus the post-minus-pre difference in the control group.\n\nSuppose the parallel trends assumption is violated by a constant difference in untreated trends between the treated and control groups, quantified by a scalar $\\Delta$, defined as\n$$\\left[E\\!\\left(Y_{T1}(0) - Y_{T0}(0)\\right)\\right] - \\left[E\\!\\left(Y_{C1}(0) - Y_{C0}(0)\\right)\\right] = \\Delta.$$\nStarting from the fundamental potential outcomes framework and the definition of the DiD estimator, derive the expected value of the DiD estimator and compute its bias with respect to $\\tau$. Show how the sign and magnitude of the bias depend on $\\Delta$. Express your final answer as a single closed-form expression in terms of $\\Delta$; do not include any units and do not round.", "solution": "The problem asks us to derive the expected value and bias of the Difference-in-Differences (DiD) estimator under a specified violation of the parallel trends assumption. We begin by formalizing the DiD estimator and then use the potential outcomes framework to derive its properties.\n\nLet the observed outcome for group $g \\in \\{T, C\\}$ at time $t \\in \\{0,1\\}$ be denoted by the random variable $Y_{gt}$. The DiD estimator, $\\hat{\\tau}_{\\text{DiD}}$, is constructed from the sample means of these outcomes. The estimator is given by:\n$$\n\\hat{\\tau}_{\\text{DiD}} = (\\bar{Y}_{T1} - \\bar{Y}_{T0}) - (\\bar{Y}_{C1} - \\bar{Y}_{C0})\n$$\nwhere $\\bar{Y}_{gt}$ is the sample mean outcome for group $g$ at time $t$. We are interested in the expected value of this estimator, $E[\\hat{\\tau}_{\\text{DiD}}]$. By the linearity of expectation and the property that the expectation of a sample mean is the population mean ($E[\\bar{Y}_{gt}] = E[Y_{gt}]$), we have:\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = (E[Y_{T1}] - E[Y_{T0}]) - (E[Y_{C1}] - E[Y_{C0}])\n$$\n\nNext, we relate the observed outcomes to the potential outcomes, $Y_{gt}(d)$, where $d \\in \\{0,1\\}$ indicates exposure status. The problem states that the policy exposure affects only the treated group ($T$) in the post-period ($t=1$). This defines the exposure status for each group-period combination:\n\\begin{itemize}\n    \\item Group $T$, time $t=1$: Exposed, so the observed outcome is $Y_{T1} = Y_{T1}(1)$.\n    \\item Group $T$, time $t=0$: Not exposed, so the observed outcome is $Y_{T0} = Y_{T0}(0)$.\n    \\item Group $C$, time $t=1$: Not exposed, so the observed outcome is $Y_{C1} = Y_{C1}(0)$.\n    \\item Group $C$, time $t=0$: Not exposed, so the observed outcome is $Y_{C0} = Y_{C0}(0)$.\n\\end{itemize}\nThe Stable Unit Treatment Value Assumption (SUTVA) ensures this mapping is well-defined.\n\nSubstituting the potential outcomes into the expression for the expected value of the estimator, we get:\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = (E[Y_{T1}(1)] - E[Y_{T0}(0)]) - (E[Y_{C1}(0)] - E[Y_{C0}(0)])\n$$\n\nThe problem provides a key assumption about the treatment effect. It is an additive constant, $\\tau$, for the treated group in the post-period:\n$$\nY_{T1}(1) - Y_{T1}(0) = \\tau\n$$\nThis implies $Y_{T1}(1) = Y_{T1}(0) + \\tau$. Taking the expectation of both sides gives:\n$$\nE[Y_{T1}(1)] = E[Y_{T1}(0) + \\tau] = E[Y_{T1}(0)] + \\tau\n$$\nsince $\\tau$ is a constant. The parameter of interest, the Average Treatment Effect on the Treated (ATT), is given as $\\tau$.\n\nNow we substitute this expression for $E[Y_{T1}(1)]$ back into our equation for $E[\\hat{\\tau}_{\\text{DiD}}]$:\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = ( (E[Y_{T1}(0)] + \\tau) - E[Y_{T0}(0)]) - (E[Y_{C1}(0)] - E[Y_{C0}(0)])\n$$\nRearranging the terms to isolate $\\tau$, we have:\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = \\tau + \\left[ (E[Y_{T1}(0)] - E[Y_{T0}(0)]) - (E[Y_{C1}(0)] - E[Y_{C0}(0)]) \\right]\n$$\n\nThe term in the square brackets represents the difference between the time trend for the treated group and the time trend for the control group, both under the non-exposed condition ($d=0$). The standard parallel trends assumption posits that this term is zero. However, the problem states that this assumption is violated and defines this difference as a scalar constant $\\Delta$:\n$$\n\\left[E\\!\\left(Y_{T1}(0) - Y_{T0}(0)\\right)\\right] - \\left[E\\!\\left(Y_{C1}(0) - Y_{C0}(0)\\right)\\right] = \\Delta\n$$\nSubstituting $\\Delta$ into our expression for the expected value of the estimator gives the first part of our result:\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = \\tau + \\Delta\n$$\n\nThe bias of an estimator is defined as the difference between its expected value and the true parameter it is intended to estimate. In this case, the true parameter is the ATT, $\\tau$.\n$$\n\\text{Bias}(\\hat{\\tau}_{\\text{DiD}}) = E[\\hat{\\tau}_{\\text{DiD}}] - \\tau\n$$\nSubstituting the derived expression for $E[\\hat{\\tau}_{\\text{DiD}}]$:\n$$\n\\text{Bias}(\\hat{\\tau}_{\\text{DiD}}) = (\\tau + \\Delta) - \\tau = \\Delta\n$$\n\nThis result shows that the bias of the DiD estimator is precisely equal to $\\Delta$, the magnitude of the violation of the parallel trends assumption. The sign and magnitude of the bias are therefore a direct function of $\\Delta$:\n\\begin{itemize}\n    \\item If $\\Delta > 0$, it means that the outcome for the treated group would have trended upwards more steeply than the outcome for the control group, even in the absence of treatment. The DiD estimator mistakes this differential trend for a treatment effect, leading to a positive bias. The estimator overestimates the true effect $\\tau$.\n    \\item If $\\Delta < 0$, the outcome for the treated group would have trended downwards (or less steeply upwards) relative to the control group in the absence of treatment. This leads to a negative bias, and the estimator underestimates the true effect $\\tau$.\n    \\item If $\\Delta = 0$, the parallel trends assumption holds, the bias is zero, and the DiD estimator is an unbiased estimator for the ATT, $\\tau$.\n\\end{itemize}\nThe magnitude of the bias is directly given by $|\\Delta|$. A larger absolute value of $\\Delta$ corresponds to a larger bias in the DiD estimate.\n\nThe final answer requested is the closed-form expression for the bias in terms of $\\Delta$. As derived, this is simply $\\Delta$.", "answer": "$$\n\\boxed{\\Delta}\n$$", "id": "4626142"}, {"introduction": "Interrupted Time Series (ITS) analysis is a powerful tool for evaluating population-level interventions when a randomized control group is not available. A key challenge in ITS is distinguishing the intervention's effect from other time-varying factors, such as seasonality, that can confound the analysis. In this practice problem ([@problem_id:4626097]), you will quantify the bias introduced by unmodeled seasonality and explore how to build a more robust model that correctly accounts for these cyclical patterns.", "problem": "A public health department evaluates a quasi-experimental policy that began in month $19$ of a $36$-month observation period, using an interrupted time series framework in epidemiology. Let monthly outcome $Y_{t}$ denote influenza-like illness clinic visits per $100{,}000$ population at month $t$, where $t \\in \\{1,2,\\ldots,36\\}$. The true data-generating process is\n$$\nY_{t} \\;=\\; \\alpha \\;+\\; \\beta D_{t} \\;+\\; \\delta S_{t} \\;+\\; \\varepsilon_{t},\n$$\nwhere $D_{t}$ is a deterministic treatment indicator equal to $0$ for $t \\leq 18$ and $1$ for $t \\geq 19$, $S_{t}$ is a deterministic seasonality component given by\n$$\nS_{t} \\;=\\; \\cos\\!\\left(\\frac{2\\pi t}{12}\\right),\n$$\n$\\delta$ is the magnitude of seasonal fluctuation, and $\\varepsilon_{t}$ is an error term with $\\mathbb{E}[\\varepsilon_{t} \\mid D_{t}, S_{t}] = 0$. Suppose $\\delta = 27$.\n\nAn analyst mistakenly omits the seasonality component and fits an ordinary least squares regression of $Y_{t}$ on an intercept and $D_{t}$ only. Starting from the definitions of unbiasedness and the Ordinary Least Squares (OLS) normal equations, derive and compute the expected bias in the estimated treatment effect for this misspecified model. Express the final bias as a single real number in the unit “visits per $100{,}000$”.\n\nThen, specify a scientifically reasonable model that would mitigate this bias by including either Fourier series terms or monthly seasonal indicator (“dummy”) variables. You must write the model explicitly in symbolic form.\n\nNo rounding is necessary; provide the exact value for the bias.", "solution": "The problem requires the derivation and computation of the omitted variable bias for an estimated treatment effect in a misspecified interrupted time series model, and the specification of a correctly specified model.\n\nFirst, let us formalize the models. The true data-generating process (DGP) is given by:\n$$ Y_{t} = \\alpha + \\beta D_{t} + \\delta S_{t} + \\varepsilon_{t} \\quad (*)$$\nwhere $t \\in \\{1, 2, \\ldots, 36\\}$, $D_{t} = 1$ for $t \\geq 19$ and $0$ otherwise, $S_{t} = \\cos(\\frac{2\\pi t}{12})$, $\\delta = 27$, and $\\mathbb{E}[\\varepsilon_{t} \\mid D_{t}, S_{t}] = 0$.\n\nThe analyst fits a misspecified model that omits the seasonality component $S_t$:\n$$ Y_{t} = a + b D_{t} + u_{t} \\quad (**) $$\nWe are tasked with finding the expected bias of the Ordinary Least Squares (OLS) estimator of $b$, denoted $\\hat{b}$, relative to the true effect $\\beta$. The bias is defined as $\\text{Bias}(\\hat{b}) = \\mathbb{E}[\\hat{b}] - \\beta$.\n\nThe OLS estimators for model $(**)$, which we denote $\\hat{a}$ and $\\hat{b}$, are derived from the normal equations:\n$$ \\sum_{t=1}^{N} (Y_t - \\hat{a} - \\hat{b}D_t) = 0 $$\n$$ \\sum_{t=1}^{N} D_t (Y_t - \\hat{a} - \\hat{b}D_t) = 0 $$\nwhere $N=36$ is the total number of observations. Solving this system yields the standard formula for the slope coefficient estimator:\n$$ \\hat{b} = \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})(Y_t - \\bar{Y})}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\nwhere $\\bar{D} = \\frac{1}{N}\\sum_{t=1}^{N} D_t$ and $\\bar{Y} = \\frac{1}{N}\\sum_{t=1}^{N} Y_t$. Using the property $\\sum_{t=1}^{N} (D_t - \\bar{D})\\bar{Y} = 0$, this simplifies to:\n$$ \\hat{b} = \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})Y_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\nTo find the bias, we first compute the expectation of $\\hat{b}$. We substitute the true model for $Y_t$ from equation $(*)$ into the expression for $\\hat{b}$:\n$$ \\hat{b} = \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})(\\alpha + \\beta D_t + \\delta S_t + \\varepsilon_t)}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\nLet's expand the numerator:\n$$ \\sum_{t=1}^{N} (D_t - \\bar{D})\\alpha + \\sum_{t=1}^{N} (D_t - \\bar{D})\\beta D_t + \\sum_{t=1}^{N} (D_t - \\bar{D})\\delta S_t + \\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t $$\nThe terms simplify as follows:\n1.  $\\alpha \\sum_{t=1}^{N} (D_t - \\bar{D}) = 0$ by the properties of deviations from the mean.\n2.  $\\beta \\sum_{t=1}^{N} (D_t - \\bar{D})D_t = \\beta \\sum_{t=1}^{N} (D_t - \\bar{D})(D_t - \\bar{D}) = \\beta \\sum_{t=1}^{N} (D_t - \\bar{D})^2$.\n3.  $\\delta \\sum_{t=1}^{N} (D_t - \\bar{D})S_t$.\n4.  $\\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t$.\n\nSubstituting these back into the expression for $\\hat{b}$:\n$$ \\hat{b} = \\frac{\\beta \\sum_{t=1}^{N} (D_t - \\bar{D})^2 + \\delta \\sum_{t=1}^{N} (D_t - \\bar{D})S_t + \\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n$$ \\hat{b} = \\beta + \\delta \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})S_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} + \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\nNow we take the expectation, conditional on the deterministic regressors $D_t$ and $S_t$. Since $\\mathbb{E}[\\varepsilon_t] = 0$, the expectation of the last term is zero.\n$$ \\mathbb{E}[\\hat{b}] = \\beta + \\delta \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})S_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\nThe bias is therefore:\n$$ \\text{Bias}(\\hat{b}) = \\mathbb{E}[\\hat{b}] - \\beta = \\delta \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})S_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\nTo compute the value of the bias, we must evaluate the sums.\nThe observation period is $N=36$ months. The intervention starts at $t=19$. There are $18$ pre-intervention months ($t=1, \\dots, 18$) and $18$ post-intervention months ($t=19, \\dots, 36$).\nThe mean of the treatment indicator $D_t$ is $\\bar{D} = \\frac{18 \\times 0 + 18 \\times 1}{36} = \\frac{18}{36} = \\frac{1}{2}$.\n\nThe denominator is:\n$$ \\sum_{t=1}^{36} (D_t - \\bar{D})^2 = \\sum_{t=1}^{18} (0 - \\frac{1}{2})^2 + \\sum_{t=19}^{36} (1 - \\frac{1}{2})^2 = 18 \\left(\\frac{1}{4}\\right) + 18 \\left(\\frac{1}{4}\\right) = \\frac{18}{2} = 9 $$\nThe numerator requires calculating $\\sum_{t=1}^{36} (D_t - \\frac{1}{2})S_t$. We can expand this:\n$$ \\sum_{t=1}^{36} (D_t - \\frac{1}{2}) S_t = \\sum_{t=1}^{18} (0 - \\frac{1}{2}) \\cos\\left(\\frac{2\\pi t}{12}\\right) + \\sum_{t=19}^{36} (1 - \\frac{1}{2}) \\cos\\left(\\frac{2\\pi t}{12}\\right) $$\n$$ = -\\frac{1}{2} \\sum_{t=1}^{18} \\cos\\left(\\frac{\\pi t}{6}\\right) + \\frac{1}{2} \\sum_{t=19}^{36} \\cos\\left(\\frac{\\pi t}{6}\\right) = \\frac{1}{2} \\left( \\sum_{t=19}^{36} S_t - \\sum_{t=1}^{18} S_t \\right) $$\nThe function $S_t = \\cos(\\frac{\\pi t}{6})$ has a period of $12$. The sum over any $12$ consecutive integers is $0$.\nLet's compute the sum for the pre-intervention period ($t=1, \\dots, 18$):\n$$ \\sum_{t=1}^{18} S_t = \\sum_{t=1}^{12} \\cos\\left(\\frac{\\pi t}{6}\\right) + \\sum_{t=13}^{18} \\cos\\left(\\frac{\\pi t}{6}\\right) = 0 + \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi (j+12)}{6}\\right) = \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6} + 2\\pi\\right) $$\n$$ = \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6}\\right) = \\cos(\\frac{\\pi}{6}) + \\cos(\\frac{\\pi}{3}) + \\cos(\\frac{\\pi}{2}) + \\cos(\\frac{2\\pi}{3}) + \\cos(\\frac{5\\pi}{6}) + \\cos(\\pi) $$\n$$ = \\frac{\\sqrt{3}}{2} + \\frac{1}{2} + 0 - \\frac{1}{2} - \\frac{\\sqrt{3}}{2} - 1 = -1 $$\nNow, let's compute the sum for the post-intervention period ($t=19, \\dots, 36$). This is also an $18$-month period.\n$$ \\sum_{t=19}^{36} S_t = \\sum_{t=19}^{30} S_t + \\sum_{t=31}^{36} S_t = 0 + \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi (j+30)}{6}\\right) = \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6} + 5\\pi\\right) $$\n$$ = \\sum_{j=1}^{6} -\\cos\\left(\\frac{\\pi j}{6}\\right) = - \\left( \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6}\\right) \\right) = -(-1) = 1 $$\nPlugging these results back into the numerator expression:\n$$ \\sum_{t=1}^{36} (D_t - \\frac{1}{2})S_t = \\frac{1}{2} (1 - (-1)) = \\frac{1}{2}(2) = 1 $$\nFinally, we compute the bias using $\\delta=27$:\n$$ \\text{Bias}(\\hat{b}) = (27) \\frac{1}{9} = 3 $$\nThe expected bias in the estimated treatment effect is $3$ visits per $100,000$.\n\nThe second task is to specify a scientifically reasonable model to mitigate this bias. The bias arises because the omitted seasonality term $S_t$ is correlated with the treatment indicator $D_t$. To correct this, the model must include terms that account for the 12-month seasonal cycle. A standard approach is to use Fourier series terms (sine and cosine pairs) for the fundamental frequency of the cycle. For a 12-month period, the fundamental frequency is $\\omega = \\frac{2\\pi}{12}$. A model incorporating these terms is:\n$$ Y_t = c_0 + c_1 D_t + c_2 \\cos\\left(\\frac{2\\pi t}{12}\\right) + c_3 \\sin\\left(\\frac{2\\pi t}{12}\\right) + e_t $$\nIn this model, the coefficients $c_2$ and $c_3$ will capture the amplitude and phase of the seasonal pattern. By including these terms as regressors, we control for the confounding effect of seasonality, and the OLS estimator of the treatment effect, $\\hat{c}_1$, will be an unbiased estimator of the true effect $\\beta$. This is because the omitted variable $S_t$ (or a sufficient representation of it) is now included in the regression, satisfying the OLS assumption of no omitted confounding variables.", "answer": "$$\\boxed{3}$$", "id": "4626097"}, {"introduction": "The Synthetic Control Method (SCM) offers an elegant solution for estimating treatment effects for a single treated unit, such as a state or country, by constructing a data-driven counterfactual from a \"donor pool\" of untreated units. The validity of this method depends critically on the ability of the synthetic control to accurately reproduce the pre-treatment trajectory of the treated unit. This exercise ([@problem_id:4626096]) delves into the consequences of poor pre-treatment fit, asking you to calculate the resulting bias and consider how regularization techniques can improve the estimator's performance.", "problem": "A public health researcher plans to use a synthetic control method within the potential outcomes framework to estimate the causal effect of a statewide policy on an outcome observed annually. Let there be one treated unit indexed by $i=1$ and $J=2$ donor units indexed by $i \\in \\{2,3\\}$. The policy is implemented just before period $t=3$, so periods $t=1$ and $t=2$ are pre-treatment, and $t=3$ is post-treatment. Assume the Stable Unit Treatment Value Assumption (SUTVA) holds and there is no interference between units.\n\nSuppose the no-treatment potential outcomes follow a one-factor interactive fixed effects model:\n$$\nY_{it}(0) \\;=\\; \\alpha_{t} \\;+\\; \\lambda_{i} f_{t} \\;+\\; \\varepsilon_{it},\n$$\nwhere $\\mathbb{E}[\\varepsilon_{it}]=0$ for all $i,t$, and the treated potential outcome is $Y_{1t}(1) = Y_{1t}(0) + \\tau_{t}$ for $t \\ge 3$, with $\\tau_{3}$ the causal effect of interest at $t=3$. Assume, for simplicity, that $\\alpha_{t}=0$ for $t \\in \\{1,2,3\\}$ and that the common factor takes values $f_{1}=1$, $f_{2}=1$, and $f_{3}=2$. The factor loadings are $\\lambda_{1}=3$ for the treated unit, and $\\lambda_{2}=2$, $\\lambda_{3}=1$ for the two donor units.\n\nA practitioner, facing limited donor pool comparability, uses fixed donor weights $\\mathbf{w} = (w_{2}, w_{3})^{\\top} = (0.5, 0.5)^{\\top}$ that sum to $1$ but yield poor pre-treatment fit. The synthetic control estimator of the period-$3$ effect is\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} \\;=\\; Y_{1,3} \\;-\\; \\sum_{j=2}^{3} w_{j} Y_{j,3}.\n$$\n\nTasks:\n1) Starting from the potential outcomes framework and the model above, derive an expression for the expected bias $\\mathbb{E}[\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3}]$ at $t=3$ in terms of the factor loadings, the factor at $t=3$, and the donor weights. Then compute its numerical value for the given parameters and weights. Round your numerical answer to four significant figures.\n\n2) To trade off pre-treatment fit and estimator variance, propose a ridge-augmented synthetic control that chooses weights $\\mathbf{v} \\in \\mathbb{R}^{J}$ to minimize the penalized pre-treatment discrepancy subject to an adding-up constraint. Let $\\mathbf{X}_{1} \\in \\mathbb{R}^{T_{0}}$ collect the treated unit’s pre-treatment outcomes and let $\\mathbf{X}_{0} \\in \\mathbb{R}^{T_{0} \\times J}$ collect the donors’ pre-treatment outcomes, where $T_{0}=2$. Formulate the constrained optimization problem that uses a penalty parameter $\\lambda > 0$ on $\\|\\mathbf{v}\\|_{2}^{2}$ and the constraint $\\mathbf{1}^{\\top}\\mathbf{v}=1$ (where $\\mathbf{1}$ is a $J \\times 1$ vector of ones), and derive the closed-form solution $\\mathbf{v}^{\\star}(\\lambda)$ in terms of $\\mathbf{X}_{0}$, $\\mathbf{X}_{1}$, $\\lambda$, and $\\mathbf{1}$.\n\nExpress your final answer to part (1) as specified above. No units are required.", "solution": "**Part 1: Expected Bias of the Synthetic Control Estimator**\n\nThe synthetic control estimator for the causal effect $\\tau_{3}$ at time $t=3$ is given by\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} \\;=\\; Y_{1,3} \\;-\\; \\sum_{j=2}^{3} w_{j} Y_{j,3}.\n$$\nThe problem specifies that the treated unit is $i=1$ and the donor units are $j \\in \\{2,3\\}$. The policy is implemented at $t=3$. Therefore, the observed outcome for the treated unit is its potential outcome under treatment, $Y_{1,3} = Y_{1,3}(1)$. The donor units remain untreated, so their observed outcomes are their potential outcomes under no treatment, $Y_{j,3} = Y_{j,3}(0)$ for $j \\in \\{2,3\\}$. Substituting these into the estimator's definition gives:\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} \\;=\\; Y_{1,3}(1) \\;-\\; \\sum_{j=2}^{3} w_{j} Y_{j,3}(0).\n$$\nThe problem provides the relationship between the potential outcomes: $Y_{1t}(1) = Y_{1t}(0) + \\tau_{t}$ for $t \\ge 3$. Using this for $t=3$, we have:\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} \\;=\\; (Y_{1,3}(0) + \\tau_{3}) \\;-\\; \\sum_{j=2}^{3} w_{j} Y_{j,3}(0).\n$$\nThe estimation error is the difference between the estimator and the true effect, $\\tau_{3}$:\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3} \\;=\\; Y_{1,3}(0) \\;-\\; \\sum_{j=2}^{3} w_{j} Y_{j,3}(0).\n$$\nWe now substitute the given factor model for the no-treatment potential outcomes, $Y_{it}(0) = \\alpha_{t} + \\lambda_{i} f_{t} + \\varepsilon_{it}$. We are also given that $\\alpha_t = 0$ for all $t$.\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3} \\;=\\; (\\lambda_{1} f_{3} + \\varepsilon_{1,3}) \\;-\\; \\sum_{j=2}^{3} w_{j} (\\lambda_{j} f_{3} + \\varepsilon_{j,3}).\n$$\nDistributing the summation and grouping terms by $f_3$ and $\\varepsilon_{it}$:\n$$\n\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3} \\;=\\; \\lambda_{1} f_{3} - f_{3} \\sum_{j=2}^{3} w_{j} \\lambda_{j} \\;+\\; \\varepsilon_{1,3} - \\sum_{j=2}^{3} w_{j} \\varepsilon_{j,3} \\;=\\; f_{3} \\left(\\lambda_{1} - \\sum_{j=2}^{3} w_{j}\\lambda_{j}\\right) \\;+\\; \\left(\\varepsilon_{1,3} - \\sum_{j=2}^{3} w_{j}\\varepsilon_{j,3}\\right).\n$$\nThe expected bias is the expectation of this estimation error. We take the expectation, noting that the factor loadings $\\lambda_i$, factors $f_t$, and weights $w_j$ are non-stochastic, and using the assumption that $\\mathbb{E}[\\varepsilon_{it}] = 0$ for all $i, t$.\n$$\n\\mathbb{E}[\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3}] \\;=\\; \\mathbb{E}\\left[f_{3} \\left(\\lambda_{1} - \\sum_{j=2}^{3} w_{j}\\lambda_{j}\\right) \\;+\\; \\left(\\varepsilon_{1,3} - \\sum_{j=2}^{3} w_{j}\\varepsilon_{j,3}\\right)\\right]\n$$\n$$\n\\mathbb{E}[\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3}] \\;=\\; f_{3} \\left(\\lambda_{1} - \\sum_{j=2}^{3} w_{j}\\lambda_{j}\\right) \\;+\\; \\mathbb{E}[\\varepsilon_{1,3}] - \\sum_{j=2}^{3} w_{j}\\mathbb{E}[\\varepsilon_{j,3}]\n$$\n$$\n\\mathbb{E}[\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3}] \\;=\\; f_{3} \\left(\\lambda_{1} - \\sum_{j=2}^{3} w_{j}\\lambda_{j}\\right).\n$$\nThis is the general expression for the expected bias. It arises from the mismatch between the treated unit's factor loading and the weighted average of the donor units' factor loadings, scaled by the factor's value in the post-treatment period.\n\nTo compute the numerical value, we use the given parameters: $f_{3}=2$, $\\lambda_{1}=3$, $\\lambda_{2}=2$, $\\lambda_{3}=1$, and weights $w_{2}=0.5$, $w_{3}=0.5$.\n$$\n\\sum_{j=2}^{3} w_{j}\\lambda_{j} \\;=\\; w_{2}\\lambda_{2} + w_{3}\\lambda_{3} \\;=\\; (0.5)(2) + (0.5)(1) \\;=\\; 1 + 0.5 \\;=\\; 1.5.\n$$\nSubstituting this into the bias expression:\n$$\n\\mathbb{E}[\\widehat{\\tau}_{\\mathrm{SC}} - \\tau_{3}] \\;=\\; 2 (3 - 1.5) \\;=\\; 2 (1.5) \\;=\\; 3.\n$$\nRounding to four significant figures as requested, the expected bias is $3.000$.\n\n**Part 2: Ridge-Augmented Synthetic Control**\n\nThe second task is to formulate and solve the constrained optimization problem for a ridge-augmented synthetic control. The goal is to choose a weight vector $\\mathbf{v} \\in \\mathbb{R}^{J}$ that minimizes the sum of squared differences between the treated unit's pre-treatment outcomes and the synthetic control's outcomes, with an added penalty term on the squared norm of the weights.\n\nLet $\\mathbf{X}_{1} \\in \\mathbb{R}^{T_{0}}$ be the column vector of the treated unit's outcomes over the $T_{0}=2$ pre-treatment periods. Let $\\mathbf{X}_{0} \\in \\mathbb{R}^{T_{0} \\times J}$ be the matrix whose columns are the outcome vectors for the $J=2$ donor units over the pre-treatment periods. The synthetic control for the pre-treatment period is given by $\\mathbf{X}_{0}\\mathbf{v}$.\n\nThe pre-treatment discrepancy (sum of squared errors) is $\\|\\mathbf{X}_{1} - \\mathbf{X}_{0}\\mathbf{v}\\|_{2}^{2}$. The ridge penalty term is $\\lambda \\|\\mathbf{v}\\|_{2}^{2}$ for a penalty parameter $\\lambda > 0$. The weights are constrained to sum to one, which is written as $\\mathbf{1}^{\\top}\\mathbf{v}=1$, where $\\mathbf{1}$ is a $J \\times 1$ vector of ones.\n\nThe constrained optimization problem is therefore formulated as:\n$$\n\\min_{\\mathbf{v} \\in \\mathbb{R}^{J}} \\left( \\|\\mathbf{X}_{1} - \\mathbf{X}_{0}\\mathbf{v}\\|_{2}^{2} + \\lambda \\|\\mathbf{v}\\|_{2}^{2} \\right) \\quad \\text{subject to} \\quad \\mathbf{1}^{\\top}\\mathbf{v}=1.\n$$\nThis is a quadratic programming problem with a linear equality constraint. We solve it using the method of Lagrange multipliers. The Lagrangian function is:\n$$\nL(\\mathbf{v}, \\mu) \\;=\\; (\\mathbf{X}_{1} - \\mathbf{X}_{0}\\mathbf{v})^{\\top}(\\mathbf{X}_{1} - \\mathbf{X}_{0}\\mathbf{v}) + \\lambda \\mathbf{v}^{\\top}\\mathbf{v} + \\mu(\\mathbf{1}^{\\top}\\mathbf{v} - 1),\n$$\nwhere $\\mu$ is the Lagrange multiplier. Expanding the objective function part gives:\n$$\nL(\\mathbf{v}, \\mu) \\;=\\; \\mathbf{X}_{1}^{\\top}\\mathbf{X}_{1} - 2\\mathbf{X}_{1}^{\\top}\\mathbf{X}_{0}\\mathbf{v} + \\mathbf{v}^{\\top}\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0}\\mathbf{v} + \\lambda \\mathbf{v}^{\\top}\\mathbf{I}_{J}\\mathbf{v} + \\mu(\\mathbf{1}^{\\top}\\mathbf{v} - 1),\n$$\nwhere $\\mathbf{I}_{J}$ is the $J \\times J$ identity matrix. To find the optimal $\\mathbf{v}$, we take the gradient of $L$ with respect to $\\mathbf{v}$ and set it to zero:\n$$\n\\frac{\\partial L}{\\partial \\mathbf{v}} \\;=\\; -2\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} + 2\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0}\\mathbf{v} + 2\\lambda\\mathbf{I}_{J}\\mathbf{v} + \\mu\\mathbf{1} \\;=\\; \\mathbf{0}.\n$$\nSolving for $\\mathbf{v}$:\n$$\n2(\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0} + \\lambda\\mathbf{I}_{J})\\mathbf{v} \\;=\\; 2\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - \\mu\\mathbf{1}.\n$$\nLet's define $M = \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0} + \\lambda\\mathbf{I}_{J}$. Since $\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0}$ is positive semi-definite and $\\lambda > 0$, $M$ is positive definite and thus invertible.\n$$\n\\mathbf{v} \\;=\\; M^{-1} \\left( \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - \\frac{\\mu}{2}\\mathbf{1} \\right).\n$$\nTo find the multiplier $\\mu$, we apply the constraint $\\mathbf{1}^{\\top}\\mathbf{v}=1$:\n$$\n\\mathbf{1}^{\\top} M^{-1} \\left( \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - \\frac{\\mu}{2}\\mathbf{1} \\right) \\;=\\; 1.\n$$\n$$\n\\mathbf{1}^{\\top} M^{-1} \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - \\frac{\\mu}{2} (\\mathbf{1}^{\\top} M^{-1} \\mathbf{1}) \\;=\\; 1.\n$$\nSolving for $\\frac{\\mu}{2}$:\n$$\n\\frac{\\mu}{2} \\;=\\; \\frac{\\mathbf{1}^{\\top} M^{-1} \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - 1}{\\mathbf{1}^{\\top} M^{-1} \\mathbf{1}}.\n$$\nSubstituting this back into the expression for $\\mathbf{v}$ yields the closed-form solution $\\mathbf{v}^{\\star}(\\lambda)$:\n$$\n\\mathbf{v}^{\\star}(\\lambda) \\;=\\; M^{-1}\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - M^{-1}\\mathbf{1} \\left(\\frac{\\mathbf{1}^{\\top} M^{-1} \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - 1}{\\mathbf{1}^{\\top} M^{-1} \\mathbf{1}}\\right).\n$$\nReplacing $M$ with its definition, the solution is:\n$$\n\\mathbf{v}^{\\star}(\\lambda) \\;=\\; (\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0} + \\lambda \\mathbf{I}_{J})^{-1}\\left( \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - \\mathbf{1} \\left( \\frac{\\mathbf{1}^{\\top} (\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0} + \\lambda \\mathbf{I}_{J})^{-1} \\mathbf{X}_{0}^{\\top}\\mathbf{X}_{1} - 1}{\\mathbf{1}^{\\top} (\\mathbf{X}_{0}^{\\top}\\mathbf{X}_{0} + \\lambda \\mathbf{I}_{J})^{-1} \\mathbf{1}} \\right) \\right).\n$$", "answer": "$$\\boxed{3.000}$$", "id": "4626096"}]}