{"hands_on_practices": [{"introduction": "One of the most direct ways to estimate a per-protocol effect is through standardization, a method formalized as the G-computation formula. The core idea is to ask: 'What would the average outcome be in a world where everyone followed a specific treatment protocol?' This practice [@problem_id:4618687] guides you through this logic by calculating the expected outcome, $E[Y^{(1,1)}]$, under a sustained treatment regimen. You will do this by averaging outcome probabilities across the distribution of covariates that would be observed under that specific treatment path, providing a foundational understanding of how to construct a causal estimand from first principles.", "problem": "Consider a longitudinal observational study with two decision times and a binary final outcome. Let $L_{0} \\in \\{0,1\\}$ be a baseline binary covariate, $A_{0} \\in \\{0,1\\}$ the baseline treatment, $L_{1} \\in \\{0,1\\}$ a post-baseline time-varying binary covariate that may be affected by $A_{0}$, $A_{1} \\in \\{0,1\\}$ the follow-up treatment, and $Y \\in \\{0,1\\}$ the binary outcome measured at the end of follow-up. Assume the standard potential outcomes framework and that the per-protocol estimand under full adherence to treatment at both times is the mean potential outcome under the sustained treatment intervention that sets $A_{0}=1$ and $A_{1}=1$, denoted $E\\!\\left[Y^{(1,1)}\\right]$. Using the fundamental laws of probability and definitions of potential outcomes, derive and compute $E\\!\\left[Y^{(1,1)}\\right]$ given the following scientifically plausible hypothetical models:\n\n- Baseline covariate distribution: $P(L_{0}=1)=0.35$, so $P(L_{0}=0)=0.65$.\n- Post-baseline covariate model under baseline treatment: $P(L_{1}=1 \\mid A_{0}=1,L_{0}=1)=0.55$ and $P(L_{1}=1 \\mid A_{0}=1,L_{0}=0)=0.25$. Consequently, $P(L_{1}=0 \\mid A_{0}=1,L_{0}=1)=0.45$ and $P(L_{1}=0 \\mid A_{0}=1,L_{0}=0)=0.75$.\n- Outcome model under full adherence to treatment at both times: $P(Y=1 \\mid A_{1}=1,A_{0}=1,L_{1}=1,L_{0}=1)=0.18$, $P(Y=1 \\mid A_{1}=1,A_{0}=1,L_{1}=0,L_{0}=1)=0.12$, $P(Y=1 \\mid A_{1}=1,A_{0}=1,L_{1}=1,L_{0}=0)=0.10$, and $P(Y=1 \\mid A_{1}=1,A_{0}=1,L_{1}=0,L_{0}=0)=0.07$.\n\nYou may assume that any treatment assignment models $P(A_{0}=1 \\mid L_{0})$ and $P(A_{1}=1 \\mid A_{0},L_{1},L_{0})$ are not needed to compute the per-protocol estimand under the sustained intervention that sets $A_{0}=1$ and $A_{1}=1$. Using only the information provided, compute $E\\!\\left[Y^{(1,1)}\\right]$ by appropriately averaging over the covariate distribution induced by $A_{0}=1$ and the outcome model under $(A_{0},A_{1})=(1,1)$. Express your final answer as a decimal and round to four significant figures.", "solution": "The user has provided a well-defined problem in the field of causal inference within epidemiology. An analysis of the problem statement against the validation criteria demonstrates its validity. The problem is scientifically grounded in the potential outcomes framework, is well-posed with a unique and computable solution, and is expressed with objective, unambiguous language. All necessary data and models are provided, and there are no internal contradictions. Therefore, a full solution can be derived.\n\nThe primary objective is to compute the per-protocol estimand $E[Y^{(1,1)}]$, which represents the expected outcome if all individuals in the population were to follow the sustained treatment regimen $(A_0, A_1) = (1,1)$. Under the standard causal inference assumptions of consistency, positivity, and conditional exchangeability (no unmeasured confounding), this potential outcome mean can be identified from the observed data distributions using the G-computation formula, also known as standardization.\n\nThe G-computation formula for the specified intervention $\\bar{a} = (a_0, a_1)=(1,1)$ is obtained by averaging the conditional expectation of the outcome $Y$ over the joint distribution of the covariates $(L_0, L_1)$ as they would be realized under the specified intervention. The formula is:\n$$E\\left[Y^{(1,1)}\\right] = \\sum_{l_0 \\in \\{0,1\\}} \\sum_{l_1 \\in \\{0,1\\}} E\\left[Y \\mid A_0=1, A_1=1, L_1=l_1, L_0=l_0\\right] \\times P\\left(L_1=l_1, L_0=l_0 \\mid do(A_0=1)\\right)$$\nwhere $do(A_0=1)$ denotes an intervention setting $A_0$ to $1$.\n\nThe joint probability of the covariates under this intervention can be factored according to the time ordering of the variables. The baseline covariate $L_0$ is measured before any treatment, so an intervention on $A_0$ does not affect its distribution: $P(L_0=l_0 \\mid do(A_0=1)) = P(L_0=l_0)$. The post-baseline covariate $L_1$ is affected by $A_0$, and assuming no unmeasured confounding for the effect of $A_0$ on $L_1$, its distribution under intervention is equal to its conditional observed distribution: $P(L_1=l_1 \\mid L_0=l_0, do(A_0=1)) = P(L_1=l_1 \\mid L_0=l_0, A_0=1)$.\n\nThus, the joint distribution is $P(L_1=l_1, L_0=l_0 \\mid do(A_0=1)) = P(L_1=l_1 \\mid A_0=1, L_0=l_0) P(L_0=l_0)$.\nSince the outcome $Y$ is binary, its conditional expectation is equal to the conditional probability of the event $Y=1$. Substituting these into the G-computation formula gives:\n$$E\\left[Y^{(1,1)}\\right] = \\sum_{l_0 \\in \\{0,1\\}} \\sum_{l_1 \\in \\{0,1\\}} P(Y=1 \\mid A_0=1, A_1=1, L_1=l_1, L_0=l_0) \\times P(L_1=l_1 \\mid A_0=1, L_0=l_0) \\times P(L_0=l_0)$$\nWe can compute this sum by applying the law of total expectation, first conditioning on $L_0$ and then marginalizing over its distribution:\n$$E\\left[Y^{(1,1)}\\right] = \\sum_{l_0 \\in \\{0,1\\}} P(L_0=l_0) \\left[ \\sum_{l_1 \\in \\{0,1\\}} P(Y=1 \\mid A_0=1, A_1=1, L_1=l_1, L_0=l_0) \\times P(L_1=l_1 \\mid A_0=1, L_0=l_0) \\right]$$\nThe inner sum is the conditional expectation of $Y$ given $A_0=1, A_1=1, L_0=l_0$, after marginalizing over $L_1$. Let's compute this for $L_0=1$ and $L_0=0$.\n\nFor the stratum $L_0=1$:\nThe required probabilities are:\n$P(Y=1 \\mid A_1=1, A_0=1, L_1=1, L_0=1) = 0.18$\n$P(Y=1 \\mid A_1=1, A_0=1, L_1=0, L_0=1) = 0.12$\n$P(L_1=1 \\mid A_0=1, L_0=1) = 0.55$, which implies $P(L_1=0 \\mid A_0=1, L_0=1) = 1 - 0.55 = 0.45$.\nThe inner expectation for $L_0=1$ is:\n$$E_{L_1}\\left[ P(Y=1 \\mid A_0=1, A_1=1, L_1, L_0=1) \\right] = (0.18)(0.55) + (0.12)(0.45) = 0.099 + 0.054 = 0.153$$\n\nFor the stratum $L_0=0$:\nThe required probabilities are:\n$P(Y=1 \\mid A_1=1, A_0=1, L_1=1, L_0=0) = 0.10$\n$P(Y=1 \\mid A_1=1, A_0=1, L_1=0, L_0=0) = 0.07$\n$P(L_1=1 \\mid A_0=1, L_0=0) = 0.25$, which implies $P(L_1=0 \\mid A_0=1, L_0=0) = 1 - 0.25 = 0.75$.\nThe inner expectation for $L_0=0$ is:\n$$E_{L_1}\\left[ P(Y=1 \\mid A_0=1, A_1=1, L_1, L_0=0) \\right] = (0.10)(0.25) + (0.07)(0.75) = 0.025 + 0.0525 = 0.0775$$\n\nFinally, we average these results over the distribution of the baseline covariate $L_0$. We are given $P(L_0=1)=0.35$, which implies $P(L_0=0)=1-0.35=0.65$.\n$$E\\left[Y^{(1,1)}\\right] = P(L_0=1) \\times (0.153) + P(L_0=0) \\times (0.0775)$$\n$$E\\left[Y^{(1,1)}\\right] = (0.35)(0.153) + (0.65)(0.0775)$$\n$$E\\left[Y^{(1,1)}\\right] = 0.05355 + 0.050375$$\n$$E\\left[Y^{(1,1)}\\right] = 0.103925$$\nThe problem requires the answer to be rounded to four significant figures. The number is $0.103925$. The four significant figures are $1, 0, 3, 9$. The fifth significant figure is $2$, so we round down.\nThe final result is $0.1039$.", "answer": "$$\\boxed{0.1039}$$", "id": "4618687"}, {"introduction": "An alternative and widely used method for per-protocol analysis is Inverse Probability Weighting (IPW). Instead of calculating what the outcome would be in a standardized population, IPW adjusts the existing data by creating a 'pseudo-population' where selection bias from non-adherence is removed. This exercise [@problem_id:4618706] focuses on the fundamental step of this method: calculating the weights themselves. You will compute both unstabilized and stabilized weights, learning how they are constructed and why stabilized weights are often preferred for their better statistical properties.", "problem": "In a longitudinal per-protocol analysis of a randomized trial, investigators emulate adherence to the assigned strategy by censoring participants at the first deviation from the protocol. To remove selection bias induced by this censoring, they use inverse probability of censoring weights. Let $C_{t}$ denote the indicator of remaining uncensored at discrete time $t$ (with $C_{t}=0$ meaning uncensored at $t$), $\\bar{L}_{t}$ denote the covariate history up to $t$, and $\\bar{A}_{t}$ denote the treatment history up to $t$. The unstabilized inverse probability of censoring weight for an individual across $T$ times is defined as the product over time of the reciprocals of the individual’s predicted conditional probabilities of remaining uncensored at each time. The stabilized weight replaces the numerator with a product of marginal (or baseline-adjusted) probabilities of remaining uncensored at each time.\n\nFor a specific participant observed at three times $t \\in \\{1,2,3\\}$, suppose the fitted conditional probabilities of remaining uncensored given the individual’s covariate and treatment histories at each time are $0.90$, $0.85$, and $0.80$, respectively. Suppose the corresponding marginal probabilities used in the stabilized numerator are $0.95$, $0.92$, and $0.90$.\n\nUsing only the core definitions above, compute:\n- the unstabilized weight, and\n- the stabilized weight for this participant.\n\nReport both weights as decimal numbers rounded to four significant figures. No units are required.", "solution": "The user wants to compute two types of inverse probability of censoring weights: unstabilized and stabilized.\n\nFirst, the problem statement is validated.\n\n### Step 1: Extract Givens\n- **Context**: A longitudinal per-protocol analysis of a randomized trial.\n- **Methodology**: Censoring participants at the first deviation from protocol and using inverse probability of censoring weights (IPCW) to adjust for selection bias.\n- **Variable Definitions**:\n    - $C_{t}$: Indicator of remaining uncensored at discrete time $t$, with $C_{t}=0$ meaning uncensored at $t$.\n    - $\\bar{L}_{t}$: Covariate history up to $t$.\n    - $\\bar{A}_{t}$: Treatment history up to $t$.\n- **Weight Definitions**:\n    - **Unstabilized weight ($W_{US}$)**: The product over time of the reciprocals of the individual’s predicted conditional probabilities of remaining uncensored.\n    - **Stabilized weight ($W_{S}$)**: The unstabilized weight where the numerator is replaced with a product of marginal probabilities of remaining uncensored.\n- **Data for a Specific Participant**:\n    - Number of time points: $3$ (let $K=3$).\n    - Conditional probabilities of remaining uncensored, $p_{c,t}$: $p_{c,1} = 0.90$, $p_{c,2} = 0.85$, $p_{c,3} = 0.80$.\n    - Marginal probabilities of remaining uncensored, $p_{m,t}$: $p_{m,1} = 0.95$, $p_{m,2} = 0.92$, $p_{m,3} = 0.90$.\n- **Task**: Compute the unstabilized weight and the stabilized weight, reporting both as decimal numbers rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is grounded in the established statistical methodology of causal inference in epidemiology, specifically dealing with inverse probability weighting for handling time-varying confounding and selection bias in longitudinal studies. The concepts of per-protocol analysis, censoring, unstabilized and stabilized weights are standard (see Hernán & Robins, \"Causal Inference: What If\").\n- **Well-Posed**: The problem provides clear definitions for the quantities to be calculated and all necessary numerical data. A unique solution is obtainable through direct computation.\n- **Objective**: The language is technical and devoid of subjective or ambiguous terms.\n- **Completeness and Consistency**: The problem is self-contained. The provided probabilities are valid (i.e., in the range $[0, 1]$). The definitions are consistent with standard use in the field, although the definition of the indicator $C_t=0$ for \"uncensored\" is unconventional (typically $1$ is used). However, this does not affect the calculation, as the problem directly provides the \"probabilities of remaining uncensored,\" rendering the specific indicator value irrelevant to the calculation itself.\n- **No Other Flaws**: The problem is not unrealistic, ill-posed, trivial, or unverifiable. It is a standard application of defined formulas.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. The solution will now be derived.\n\nThe problem asks for the calculation of the unstabilized and stabilized inverse probability of censoring weights for a participant observed over $K=3$ time points.\n\nLet $p_{c,t}$ be the conditional probability of the participant remaining uncensored at time $t$, given their past covariate and treatment history. The problem states these are:\n$p_{c,1} = 0.90$\n$p_{c,2} = 0.85$\n$p_{c,3} = 0.80$\n\nLet $p_{m,t}$ be the marginal probability of the participant remaining uncensored at time $t$ (potentially adjusted for baseline covariates only). The problem states these are:\n$p_{m,1} = 0.95$\n$p_{m,2} = 0.92$\n$p_{m,3} = 0.90$\n\nAccording to the provided definition, the unstabilized weight, $W_{US}$, for an individual who remains uncensored across all time points is the product of the reciprocals of the conditional probabilities of remaining uncensored at each time point.\nMathematically, this is:\n$$ W_{US} = \\prod_{t=1}^{K} \\frac{1}{p_{c,t}} = \\frac{1}{\\prod_{t=1}^{K} p_{c,t}} $$\nFor $K=3$, the denominator is the product of the conditional probabilities:\n$$ \\prod_{t=1}^{3} p_{c,t} = p_{c,1} \\times p_{c,2} \\times p_{c,3} = 0.90 \\times 0.85 \\times 0.80 $$\n$$ \\prod_{t=1}^{3} p_{c,t} = 0.765 \\times 0.80 = 0.612 $$\nThus, the unstabilized weight is:\n$$ W_{US} = \\frac{1}{0.612} \\approx 1.6339869... $$\nRounding to four significant figures, we get $W_{US} \\approx 1.634$.\n\nThe stabilized weight, $W_{S}$, is defined by modifying the unstabilized weight. The numerator, which is $1$ in the unstabilized weight formulation, is replaced by the product of the marginal probabilities of remaining uncensored.\nMathematically, this is:\n$$ W_{S} = \\frac{\\prod_{t=1}^{K} p_{m,t}}{\\prod_{t=1}^{K} p_{c,t}} $$\nThe denominator is the same as calculated before, $0.612$. The numerator is the product of the marginal probabilities:\n$$ \\prod_{t=1}^{3} p_{m,t} = p_{m,1} \\times p_{m,2} \\times p_{m,3} = 0.95 \\times 0.92 \\times 0.90 $$\n$$ \\prod_{t=1}^{3} p_{m,t} = 0.874 \\times 0.90 = 0.7866 $$\nThus, the stabilized weight is:\n$$ W_{S} = \\frac{0.7866}{0.612} \\approx 1.2852941... $$\nRounding to four significant figures, we get $W_{S} \\approx 1.285$.\n\nThe calculated weights are the unstabilized weight $W_{US} \\approx 1.634$ and the stabilized weight $W_{S} \\approx 1.285$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.634 & 1.285 \\end{pmatrix}}\n$$", "id": "4618706"}, {"introduction": "Having learned how to construct inverse probability weights, the final step is to apply them to estimate the per-protocol effect. This practice [@problem_id:4618652] brings the concept to life by having you calculate a weighted risk difference using a hypothetical dataset of adherent participants. This simulates the culmination of an IPW analysis and also introduces a crucial real-world challenge: the statistical instability that can be caused by highly variable or extreme weights, a key diagnostic for any weighted analysis.", "problem": "A randomized trial is conducted to estimate the per-protocol effect of an intervention on a binary outcome measured at $12$ weeks. The per-protocol estimand is the difference in the risk of the outcome had all participants fully adhered to the protocol in the intervention arm versus the control arm. In practice, nonadherence occurs, and investigators use Inverse Probability Weighting (IPW) to reweight adherent participants so that their covariate distribution approximates that of the full trial population under each arm. Assume the following:\n\n- The binary outcome is denoted by $Y$, with $Y=1$ indicating the occurrence of the outcome by $12$ weeks and $Y=0$ otherwise.\n- In the intervention arm, there are four adherent participants indexed by $i=1,\\dots,4$ with weights $w_i=(1.0,\\,1.5,\\,3.0,\\,0.8)$ and observed outcomes $Y_i=(1,\\,0,\\,1,\\,0)$.\n- In the control arm, there are four adherent participants indexed by $j=1,\\dots,4$ with weights $v_j=(0.9,\\,1.2,\\,2.5,\\,0.7)$ and observed outcomes $Z_j=(0,\\,1,\\,0,\\,1)$.\n\nStarting from first principles in epidemiology, use the definition of risk as an expectation of the indicator outcome under each protocol and the concept that IPW reweights adherent individuals to recover the target arm-specific population risk. Derive the appropriate sample analog for the arm-specific risks and compute the per-protocol weighted risk difference (intervention minus control) using the data provided. Round your final numeric answer to four significant figures and express it as a unitless decimal. Additionally, explain briefly why extreme or highly variable weights can lead to instability in such weighted estimators and relate your explanation to the data provided.", "solution": "The problem statement is critically reviewed for validity before proceeding.\n\n### Step 1: Extract Givens\n- **Estimand**: Per-protocol effect, defined as the difference in the risk of the outcome had all participants fully adhered.\n- **Method**: Inverse Probability Weighting (IPW).\n- **Outcome**: Binary, denoted by $Y$. $Y=1$ for outcome occurrence by $12$ weeks, $Y=0$ otherwise.\n- **Intervention Arm Data**: For $4$ adherent participants, indexed by $i=1, 2, 3, 4$:\n  - Weights: $w_i = (1.0, 1.5, 3.0, 0.8)$.\n  - Outcomes: $Y_i = (1, 0, 1, 0)$.\n- **Control Arm Data**: For $4$ adherent participants, indexed by $j=1, 2, 3, 4$:\n  - Weights: $v_j = (0.9, 1.2, 2.5, 0.7)$.\n  - Outcomes: $Z_j = (0, 1, 0, 1)$. Note: The problem uses $Z_j$ for outcomes in the control arm; for consistency in formulation, we will treat this as the observed value of the outcome variable $Y$ in the control arm.\n- **Required Calculation**: The per-protocol weighted risk difference (intervention minus control).\n- **Final Answer Format**: A unitless decimal rounded to four significant figures.\n- **Additional Task**: Explain the instability of weighted estimators due to extreme weights, with reference to the provided data.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard epidemiological scenario involving a randomized trial with nonadherence, a common issue addressed using established causal inference methods like IPW. The data provided are complete and consistent for the task. The quantities to be calculated are clearly defined. The terms are used precisely within the context of clinical trial analysis. Therefore, the problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to estimate the per-protocol risk difference. This requires estimating the risk in each arm under the hypothetical condition that all participants adhered to their assigned protocol. We use Inverse Probability Weighting (IPW) to adjust for the selection bias introduced by nonadherence.\n\nLet $A$ be the indicator for the randomized arm, with $A=1$ for intervention and $A=0$ for control. Let $Y$ be the binary outcome. Let $C$ be the indicator for adherence, with $C=1$ for adherents and $C=0$ for nonadherents. The weights, $w_i$ for the intervention arm and $v_j$ for the control arm, are the inverse probabilities of adherence for each participant, i.e., $w_i = 1/P(C=1 | A=1, X_i)$ for a participant $i$ in the intervention arm with covariates $X_i$.\n\nThe risk in an arm is the expectation of the outcome variable, $E[Y]$. For a binary outcome, this is equivalent to the probability of the outcome occurring, $P(Y=1)$. The IPW approach estimates this population risk by calculating a weighted average of the outcomes observed among the adherent subgroup. The weights are designed to make the adherent subgroup \"representative\" of the full randomized group.\n\nThe appropriate sample analog for the risk in a given arm is the stabilized IPW estimator of the mean. For the intervention arm, the risk, $\\hat{R}_{int}$, is the sum of the weighted outcomes divided by the sum of the weights:\n$$\n\\hat{R}_{int} = \\frac{\\sum_{i \\in \\text{adherent, int}} w_i Y_i}{\\sum_{i \\in \\text{adherent, int}} w_i}\n$$\nThe numerator, $\\sum w_i Y_i$, represents the estimated number of events in the full target population (the entire intervention arm), and the denominator, $\\sum w_i$, represents the estimated total size of this target population.\n\nSimilarly, for the control arm, the risk, $\\hat{R}_{ctrl}$, is:\n$$\n\\hat{R}_{ctrl} = \\frac{\\sum_{j \\in \\text{adherent, ctrl}} v_j Z_j}{\\sum_{j \\in \\text{adherent, ctrl}} v_j}\n$$\nThe per-protocol weighted risk difference, $\\Delta\\hat{R}_{PP}$, is then the difference between these two estimated risks:\n$$\n\\Delta\\hat{R}_{PP} = \\hat{R}_{int} - \\hat{R}_{ctrl}\n$$\n\n### Calculation\nUsing the data provided:\n\nFor the intervention arm:\n- The observed outcomes are $Y_i = (1, 0, 1, 0)$.\n- The corresponding weights are $w_i = (1.0, 1.5, 3.0, 0.8)$.\n- The sum of the weighted outcomes is:\n$$\n\\sum_{i=1}^4 w_i Y_i = (1.0 \\times 1) + (1.5 \\times 0) + (3.0 \\times 1) + (0.8 \\times 0) = 1.0 + 0 + 3.0 + 0 = 4.0\n$$\n- The sum of the weights is:\n$$\n\\sum_{i=1}^4 w_i = 1.0 + 1.5 + 3.0 + 0.8 = 6.3\n$$\n- The estimated risk in the intervention arm is:\n$$\n\\hat{R}_{int} = \\frac{4.0}{6.3}\n$$\n\nFor the control arm:\n- The observed outcomes are $Z_j = (0, 1, 0, 1)$.\n- The corresponding weights are $v_j = (0.9, 1.2, 2.5, 0.7)$.\n- The sum of the weighted outcomes is:\n$$\n\\sum_{j=1}^4 v_j Z_j = (0.9 \\times 0) + (1.2 \\times 1) + (2.5 \\times 0) + (0.7 \\times 1) = 0 + 1.2 + 0 + 0.7 = 1.9\n$$\n- The sum of the weights is:\n$$\n\\sum_{j=1}^4 v_j = 0.9 + 1.2 + 2.5 + 0.7 = 5.3\n$$\n- The estimated risk in the control arm is:\n$$\n\\hat{R}_{ctrl} = \\frac{1.9}{5.3}\n$$\n\nThe per-protocol weighted risk difference is:\n$$\n\\Delta\\hat{R}_{PP} = \\hat{R}_{int} - \\hat{R}_{ctrl} = \\frac{4.0}{6.3} - \\frac{1.9}{5.3}\n$$\nNow we compute the numerical value:\n$$\n\\Delta\\hat{R}_{PP} \\approx 0.63492063... - 0.35849056... = 0.27643007...\n$$\nRounding to four significant figures, we get $0.2764$.\n\n### Explanation of Weight Instability\nInverse probability weighted estimators, such as the one used here, can be unstable when some weights are extremely large or when the weights are highly variable. The variance of the IPW estimator is sensitive to the second moment of the weight distribution. An estimator of the arm-specific risk, $\\hat{R} = (\\sum w_i Y_i) / (\\sum w_i)$, is a weighted average where each individual $i$'s contribution to the final estimate is proportional to their weight $w_i$.\n\nIf one individual, say participant $k$, has a weight $w_k$ that is much larger than all other weights, this individual will have a disproportionate influence on the estimate. The total estimated risk becomes heavily dependent on that single individual's outcome, $Y_k$. In the extreme case where $w_k \\gg \\sum_{i \\neq k} w_i$, the estimator approaches $\\hat{R} \\approx (w_k Y_k) / w_k = Y_k$. The entire population risk estimate hinges on the binary outcome of a single person. This leads to a high-variance (unstable) estimator, as a small change in the data (e.g., if that one person's outcome had been different) would cause a large swing in the final estimate.\n\nIn the provided data, we can observe this phenomenon. In the intervention arm, participant $i=3$ has a weight of $w_3 = 3.0$. The sum of all weights is $\\sum w_i = 6.3$. This single participant accounts for $3.0/6.3 \\approx 47.6\\%$ of the total weight in the arm. Their outcome is $Y_3=1$, and they contribute $3.0$ to the numerator sum of $4.0$. If this participant's outcome had been $Y_3=0$, the risk estimate for the intervention arm would have plummeted from $\\hat{R}_{int} = 4.0/6.3 \\approx 0.635$ to $\\hat{R}_{int} = (4.0 - 3.0)/6.3 = 1.0/6.3 \\approx 0.159$. This dramatic change, contingent on one data point, exemplifies the instability caused by an influential, high-weight observation. Similarly, in the control arm, participant $j=3$ has a weight of $v_3 = 2.5$ on a total of $5.3$, accounting for $\\approx 47.2\\%$ of the weight. The high variability and presence of large relative weights in this small dataset contribute to the potential for an imprecise and unstable estimate of the per-protocol effect.", "answer": "$$\n\\boxed{0.2764}\n$$", "id": "4618652"}]}