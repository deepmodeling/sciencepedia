{"hands_on_practices": [{"introduction": "A core function of surveillance is to accurately measure disease burden, but raw data can be misleading if the monitored population is not representative of the whole. This first practice tackles this common issue by having you adjust for varied surveillance coverage across different age groups. You will learn to transform biased sentinel data into a more accurate, weighted estimate of population-wide incidence, demonstrating the importance of the representativeness attribute. This exercise [@problem_id:4592233] builds the crucial skill of identifying and correcting for coverage bias, ensuring that surveillance outputs faithfully reflect the true burden of disease in the community.", "problem": "A regional Acute Respiratory Infection (ARI) sentinel physician network reports age-stratified new case counts over a $12$-week period. Because the network is not fully representative, the fraction of providers participating differs by age group. Assume that within each age group the risk of ARI among patients seen by participating providers is the same as among patients seen by non-participating providers, and that incidence is defined as the number of new cases divided by the population at risk over the period.\n\nData for the three age groups are:\n- Ages $0$–$17$: observed cases $80$, provider participation fraction $0.25$, population $52{,}000$.\n- Ages $18$–$64$: observed cases $220$, provider participation fraction $0.10$, population $130{,}000$.\n- Ages $\\geq 65$: observed cases $100$, provider participation fraction $0.40$, population $26{,}000$.\n\nUsing first principles:\n1. Estimate the coverage-adjusted weighted incidence per $100{,}000$ persons over the $12$-week period by inferring the total number of cases in the population for each age group from the observed counts and participation fractions, and aggregating across age groups relative to the total population.\n2. Compute the naive crude incidence per $100{,}000$ persons obtained by aggregating observed sentinel counts across age groups and dividing by the total population, ignoring differences in participation fractions.\n3. Let $R$ be the ratio of the naive crude incidence to the coverage-adjusted weighted incidence. Report $R$ as a unitless decimal.\n\nExpress all incidence rates per $100{,}000$ persons. Round the final ratio $R$ to four significant figures. Provide only the value of $R$ as your final answer.", "solution": "The problem requires the calculation of two types of incidence rates from sentinel surveillance data and their ratio. First, the problem is validated to be scientifically sound, well-posed, and objective. The provided data are sufficient and consistent.\n\nLet the three age groups be indexed by $i=1, 2, 3$, corresponding to ages $0$–$17$, $18$–$64$, and $\\geq 65$, respectively. The provided data for each group are:\n- Observed cases: $C_{obs,i}$\n- Provider participation fraction: $f_i$\n- Population size: $N_i$\n\nThe specific values are:\n- For $i=1$: $C_{obs,1}=80$, $f_1=0.25$, $N_1=52000$.\n- For $i=2$: $C_{obs,2}=220$, $f_2=0.10$, $N_2=130000$.\n- For $i=3$: $C_{obs,3}=100$, $f_3=0.40$, $N_3=26000$.\n\nThe problem states that incidence is defined as the number of new cases divided by the population at risk over the $12$-week period. It is also assumed that the risk of Acute Respiratory Infection (ARI) is homogeneous within each age group, regardless of whether patients are seen by participating or non-participating providers. This assumption allows us to estimate the total number of cases in each age group, $C_{total,i}$, by scaling the observed cases by the inverse of the participation fraction:\n$$C_{total,i} = \\frac{C_{obs,i}}{f_i}$$\n\nThe problem asks for three calculations in sequence.\n\n1.  **Coverage-adjusted weighted incidence ($I_{adj}$)**\n    This incidence rate is based on the total estimated cases for the entire population, adjusted for the incomplete coverage of the sentinel network.\n    The total estimated number of cases in the population is the sum of the estimated cases from each age group:\n    $$C_{total} = \\sum_{i=1}^{3} C_{total,i} = \\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}$$\n    The total population at risk is the sum of the populations of the age groups:\n    $$N_{total} = \\sum_{i=1}^{3} N_i$$\n    The coverage-adjusted incidence rate per $100{,}000$ persons is therefore:\n    $$I_{adj} = \\left( \\frac{C_{total}}{N_{total}} \\right) \\times 100000 = \\left( \\frac{\\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000$$\n\n2.  **Naive crude incidence ($I_{naive}$)**\n    This incidence rate is calculated by using only the observed case counts without adjustment for coverage.\n    The total number of observed cases is:\n    $$C_{obs,total} = \\sum_{i=1}^{3} C_{obs,i}$$\n    The naive crude incidence rate per $100{,}000$ persons is:\n    $$I_{naive} = \\left( \\frac{C_{obs,total}}{N_{total}} \\right) \\times 100000 = \\left( \\frac{\\sum_{i=1}^{3} C_{obs,i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000$$\n\n3.  **Ratio $R$**\n    The ratio $R$ is defined as the naive crude incidence divided by the coverage-adjusted weighted incidence.\n    $$R = \\frac{I_{naive}}{I_{adj}} = \\frac{\\left( \\frac{\\sum_{i=1}^{3} C_{obs,i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000}{\\left( \\frac{\\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000}$$\n    The terms for the total population ($N_{total} = \\sum N_i$) and the scaling factor of $100000$ cancel out, simplifying the expression for $R$ to the ratio of the total observed cases to the total estimated cases:\n    $$R = \\frac{\\sum_{i=1}^{3} C_{obs,i}}{\\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}} = \\frac{C_{obs,total}}{C_{total}}$$\n\nNow, we substitute the numerical values into the expression for $R$.\nFirst, calculate the numerator, the total number of observed cases:\n$$C_{obs,total} = 80 + 220 + 100 = 400$$\nNext, calculate the denominator, the total estimated number of cases:\n$$C_{total} = \\frac{80}{0.25} + \\frac{220}{0.10} + \\frac{100}{0.40}$$\n$$C_{total} = 320 + 2200 + 250 = 2770$$\nNow, we can compute the ratio $R$:\n$$R = \\frac{400}{2770} = \\frac{40}{277}$$\nAs a decimal, this value is:\n$$R \\approx 0.14440433213...$$\nThe problem requires the final answer to be rounded to four significant figures. The fifth significant figure is $0$, so we round down.\n$$R \\approx 0.1444$$\nThe value of $R$ being significantly less than $1$ indicates that the naive incidence, which ignores surveillance coverage, substantially underestimates the true population incidence estimated by the coverage-adjusted method. This is primarily due to the very low participation fraction ($f_2=0.10$) in the largest population group (ages $18$–$64$).", "answer": "$$\\boxed{0.1444}$$", "id": "4592233"}, {"introduction": "Public health surveillance systems are rarely static; they evolve as new data sources become available. This exercise places you in the role of an epidemiologist evaluating such a change, analyzing the trade-offs of combining a new, imperfect data stream with an existing one. You will calculate how this modification affects key performance metrics like the positive predictive value ($PPV$) and the false alarm rate ($FAR$). By working through this problem [@problem_id:4592268], you'll gain a quantitative understanding of how to assess the complex interplay between sensitivity, specificity, and predictive values when designing and improving surveillance systems.", "problem": "A public health department operates an automated infectious disease surveillance system that issues an alarm when a decision rule is met. There is an existing primary stream that, at the current decision threshold, identifies infected cases with sensitivity $Se_{1}$ and identifies non-infected cases with specificity $Sp_{1}$. The system is deployed in a population with infection prevalence $\\pi$. The department considers adding a second, independent auxiliary stream characterized by low sensitivity and high specificity, with sensitivity $Se_{2}$ and specificity $Sp_{2}$. After addition, the decision threshold is held fixed so that the combined system issues an alarm if at least one of the two streams flags positive. Assume conditional independence of the streams given infection status (infected versus not infected). Use the following parameters: $Se_{1} = 0.85$, $Sp_{1} = 0.95$, $Se_{2} = 0.30$, $Sp_{2} = 0.99$, and $\\pi = 0.01$. Using fundamental definitions, compute the ratio $\\rho$ of the change in Positive Predictive Value (PPV) to the change in false alarm rate, where false alarm rate is defined as the probability of an alarm when infection is absent. Specifically, let $\\Delta PPV = PPV_{\\text{after}} - PPV_{\\text{before}}$ and $\\Delta FAR = FAR_{\\text{after}} - FAR_{\\text{before}}$, and define $\\rho = \\frac{\\Delta PPV}{\\Delta FAR}$. Express your answer as a decimal and round your final answer to four significant figures.", "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It is a standard problem in the evaluation of diagnostic or surveillance systems. I will proceed with a full solution.\n\nLet $I$ be the event that an individual is infected, and $I^c$ be the event that an individual is not infected. The prevalence of the infection is given as $\\pi = P(I) = 0.01$. Consequently, $P(I^c) = 1 - \\pi = 1 - 0.01 = 0.99$.\n\nLet $T_1$ be the event that the primary stream flags a case as positive, and $T_2$ be the event that the auxiliary stream flags a case as positive. The test results are assumed to be conditionally independent given the true infection status.\n\nThe fundamental definitions are:\n- Sensitivity ($Se$): $P(\\text{Test Positive} | I)$\n- Specificity ($Sp$): $P(\\text{Test Negative} | I^c)$\n- Positive Predictive Value ($PPV$): $P(I | \\text{Test Positive})$\n- False Alarm Rate ($FAR$): $P(\\text{Test Positive} | I^c)$. Note that $FAR = 1 - P(\\text{Test Negative} | I^c) = 1 - Sp$.\n\nThe given parameters are:\n- Primary stream: $Se_1 = 0.85$, $Sp_1 = 0.95$\n- Auxiliary stream: $Se_2 = 0.30$, $Sp_2 = 0.99$\n\n**1. Analysis of the System Before Adding the Auxiliary Stream (Primary Stream Only)**\n\nThe system \"before\" consists only of the primary stream. Let the total probability of a positive test be $P(T_1)$.\nThe false alarm rate before, $FAR_{\\text{before}}$, is the probability of a positive test from stream 1 given absence of infection:\n$$FAR_{\\text{before}} = P(T_1 | I^c) = 1 - Sp_1$$\nSubstituting the given value for $Sp_1$:\n$$FAR_{\\text{before}} = 1 - 0.95 = 0.05$$\n\nThe positive predictive value before, $PPV_{\\text{before}}$, is calculated using Bayes' theorem:\n$$PPV_{\\text{before}} = P(I | T_1) = \\frac{P(T_1 | I) P(I)}{P(T_1)}$$\nThe denominator $P(T_1)$ is found using the law of total probability:\n$$P(T_1) = P(T_1 | I) P(I) + P(T_1 | I^c) P(I^c)$$\n$$P(T_1) = Se_1 \\pi + (1 - Sp_1)(1 - \\pi)$$\nSubstituting the numerical values:\n$$P(T_1) = (0.85)(0.01) + (1 - 0.95)(1 - 0.01) = 0.0085 + (0.05)(0.99) = 0.0085 + 0.0495 = 0.058$$\nNow, we can compute $PPV_{\\text{before}}$:\n$$PPV_{\\text{before}} = \\frac{Se_1 \\pi}{P(T_1)} = \\frac{(0.85)(0.01)}{0.058} = \\frac{0.0085}{0.058}$$\n\n**2. Analysis of the System After Adding the Auxiliary Stream (Combined System)**\n\nThe combined system issues an alarm if at least one stream is positive. Let this event be $T_{\\text{comb}} = T_1 \\cup T_2$. We need to find the sensitivity ($Se_{\\text{comb}}$) and specificity ($Sp_{\\text{comb}}$) of this combined test.\n\nThe sensitivity of the combined system is:\n$$Se_{\\text{comb}} = P(T_1 \\cup T_2 | I) = 1 - P((T_1 \\cup T_2)^c | I) = 1 - P(T_1^c \\cap T_2^c | I)$$\nUsing conditional independence, $P(T_1^c \\cap T_2^c | I) = P(T_1^c | I) P(T_2^c | I)$.\nWe know $P(T_1^c | I) = 1 - P(T_1 | I) = 1 - Se_1$, and similarly $P(T_2^c | I) = 1 - Se_2$.\n$$Se_{\\text{comb}} = 1 - (1 - Se_1)(1 - Se_2)$$\nSubstituting the numerical values:\n$$Se_{\\text{comb}} = 1 - (1 - 0.85)(1 - 0.30) = 1 - (0.15)(0.70) = 1 - 0.105 = 0.895$$\n\nThe specificity of the combined system is:\n$$Sp_{\\text{comb}} = P((T_1 \\cup T_2)^c | I^c) = P(T_1^c \\cap T_2^c | I^c)$$\nUsing conditional independence, $P(T_1^c \\cap T_2^c | I^c) = P(T_1^c | I^c) P(T_2^c | I^c)$.\nWe know $P(T_1^c | I^c) = Sp_1$ and $P(T_2^c | I^c) = Sp_2$.\n$$Sp_{\\text{comb}} = Sp_1 Sp_2$$\nSubstituting the numerical values:\n$$Sp_{\\text{comb}} = (0.95)(0.99) = 0.9405$$\n\nNow, we compute the false alarm rate and PPV for the combined system.\nThe false alarm rate after, $FAR_{\\text{after}}$, is:\n$$FAR_{\\text{after}} = P(T_{\\text{comb}} | I^c) = 1 - Sp_{\\text{comb}} = 1 - 0.9405 = 0.0595$$\n\nThe positive predictive value after, $PPV_{\\text{after}}$, is:\n$$PPV_{\\text{after}} = P(I | T_{\\text{comb}}) = \\frac{P(T_{\\text{comb}} | I) P(I)}{P(T_{\\text{comb}})}$$\nThe denominator $P(T_{\\text{comb}})$ is:\n$$P(T_{\\text{comb}}) = P(T_{\\text{comb}} | I) P(I) + P(T_{\\text{comb}} | I^c) P(I^c)$$\n$$P(T_{\\text{comb}}) = Se_{\\text{comb}} \\pi + (1 - Sp_{\\text{comb}})(1 - \\pi)$$\nSubstituting the numerical values:\n$$P(T_{\\text{comb}}) = (0.895)(0.01) + (1 - 0.9405)(1 - 0.01) = 0.00895 + (0.0595)(0.99)$$\n$$P(T_{\\text{comb}}) = 0.00895 + 0.058905 = 0.067855$$\nNow, we can compute $PPV_{\\text{after}}$:\n$$PPV_{\\text{after}} = \\frac{Se_{\\text{comb}} \\pi}{P(T_{\\text{comb}})} = \\frac{(0.895)(0.01)}{0.067855} = \\frac{0.00895}{0.067855}$$\n\n**3. Calculation of the Ratio $\\rho$**\n\nFirst, we calculate the change in the false alarm rate, $\\Delta FAR$:\n$$\\Delta FAR = FAR_{\\text{after}} - FAR_{\\text{before}} = 0.0595 - 0.05 = 0.0095$$\n\nNext, we calculate the change in the positive predictive value, $\\Delta PPV$:\n$$\\Delta PPV = PPV_{\\text{after}} - PPV_{\\text{before}} = \\frac{0.00895}{0.067855} - \\frac{0.0085}{0.058}$$\nNumerically, this is:\n$$\\Delta PPV \\approx 0.1318989 - 0.1465517 = -0.0146528$$\n\nFinally, we compute the ratio $\\rho = \\frac{\\Delta PPV}{\\Delta FAR}$:\n$$\\rho = \\frac{-0.0146528}{0.0095} \\approx -1.54240$$\n\nRounding the result to four significant figures, we get $-1.542$.", "answer": "$$\\boxed{-1.542}$$", "id": "4592268"}, {"introduction": "Once we have a point estimate for a surveillance attribute like sensitivity, how confident can we be in that number? This final practice moves from calculation to statistical inference, asking you to quantify the uncertainty around a sensitivity estimate using a rigorous confidence interval. You will specifically explore the scenario where a system detects all known cases—an observed sensitivity of $100\\%$. This exercise [@problem_id:4592234] introduces the exact Clopper-Pearson method, forcing you to consider that even a perfect observed result does not imply perfect true performance and teaching you why statistical conservatism is an important concept in public health reporting.", "problem": "A public health agency is evaluating the sensitivity of its Public Health Surveillance (PHS) system for detecting invasive meningococcal disease. In a validation study, a cohort of laboratory-confirmed true cases was assembled using an independent gold standard. Assume each true case has an identical and independent probability $p$ of being detected by the PHS system, consistent with a Bernoulli process. Sensitivity is defined as the probability that a true case is detected, equal to $p$ under this model. Let $X$ denote the number of detected cases among $n$ gold-standard true cases, so that $X \\sim \\mathrm{Binomial}(n,p)$.\n\nIn one jurisdiction, the validation identified $n = 60$ gold-standard true cases, and the PHS system detected $X = 60$ of them. Using the exact two-sided Clopper–Pearson $95\\%$ Confidence Interval (CI) for the binomial proportion obtained by inverting the exact binomial test (equal tails), compute the exact two-sided CI for the sensitivity $p$ and explain, from first principles, why this CI is considered conservative in terms of coverage. Then, report only the lower bound of this exact Clopper–Pearson $95\\%$ CI for $p$ as a decimal. Round your reported number to four significant figures. Do not use a percent sign in your final reported value.", "solution": "The problem asks for the calculation of the lower bound of the exact two-sided $95\\%$ Clopper-Pearson confidence interval for a binomial proportion $p$, given an observation of $X=60$ successes in $n=60$ trials. It also requires an explanation of why this confidence interval is considered conservative.\n\nFirst, we validate the problem statement.\nThe givens are:\n- The number of true cases is $n=60$.\n- The number of detected cases is $X=60$.\n- The statistical model for the number of detections is $X \\sim \\mathrm{Binomial}(n,p)$, where $p$ is the sensitivity of the surveillance system.\n- The desired confidence level is $1-\\alpha = 0.95$, which implies $\\alpha = 0.05$.\n- The method to use is the exact two-sided Clopper-Pearson confidence interval.\nThe problem is scientifically grounded, using standard statistical methods in epidemiology. It is well-posed, providing all necessary information for a unique solution. The language is objective and precise. The problem is valid.\n\nWe now proceed to the solution. The Clopper-Pearson confidence interval $[p_L, p_U]$ for a binomial proportion $p$ is constructed by inverting two one-sided, equal-tailed exact binomial tests. Let the observed number of successes be $x$ out of $n$ trials. The confidence level is $1-\\alpha$.\n\nThe lower bound, $p_L$, is defined as the value of $p$ for which the probability of observing $x$ or more successes is equal to $\\alpha/2$. This is the solution to the equation:\n$$ \\mathrm{P}(Y \\ge x | Y \\sim \\mathrm{Binomial}(n, p_L)) = \\sum_{k=x}^{n} \\binom{n}{k} p_L^k (1-p_L)^{n-k} = \\frac{\\alpha}{2} $$\n\nThe upper bound, $p_U$, is defined as the value of $p$ for which the probability of observing $x$ or fewer successes is equal to $\\alpha/2$. This is the solution to the equation:\n$$ \\mathrm{P}(Y \\le x | Y \\sim \\mathrm{Binomial}(n, p_U)) = \\sum_{k=0}^{x} \\binom{n}{k} p_U^k (1-p_U)^{n-k} = \\frac{\\alpha}{2} $$\n\nIn this problem, we have $n=60$, $x=60$, and $1-\\alpha=0.95$, so $\\alpha/2 = 0.025$.\n\nWe are asked to compute the lower bound of the confidence interval. We use the formula for $p_L$ with $x=60$:\n$$ \\sum_{k=60}^{60} \\binom{60}{k} p_L^k (1-p_L)^{60-k} = 0.025 $$\nThe sum has only one term, for $k=60$:\n$$ \\binom{60}{60} p_L^{60} (1-p_L)^{60-60} = 0.025 $$\nSince $\\binom{60}{60}=1$ and $(1-p_L)^0=1$, the equation simplifies to:\n$$ p_L^{60} = 0.025 $$\nSolving for $p_L$, we get:\n$$ p_L = (0.025)^{\\frac{1}{60}} $$\nWe can compute this value:\n$$ p_L = \\exp\\left(\\frac{1}{60} \\ln(0.025)\\right) \\approx \\exp\\left(\\frac{-3.688879}{60}\\right) \\approx \\exp(-0.061481) \\approx 0.940360 $$\nRounding to four significant figures, the lower bound is $0.9404$.\n\nFor completeness, let's consider the upper bound $p_U$. The equation is:\n$$ \\sum_{k=0}^{60} \\binom{60}{k} p_U^k (1-p_U)^{60-k} = 0.025 $$\nThe sum on the left is the sum of all probabilities for a $\\mathrm{Binomial}(60, p_U)$ distribution, which is always equal to $1$. The equation $1=0.025$ has no solution for $p_U \\in [0,1)$. By convention, in the extreme case where $x=n$, the upper bound of the confidence interval is set to $p_U = 1$. Thus, the full $95\\%$ CI is $[(0.025)^{1/60}, 1]$.\n\nNext, we explain why the Clopper-Pearson interval is considered conservative. The term \"conservative\" in this context means that the actual coverage probability of the interval, which is the long-run frequency with which the interval contains the true parameter $p$, is guaranteed to be at least the nominal level $1-\\alpha$ for all possible values of $p$. For many values of $p$, the actual coverage is strictly greater than $1-\\alpha$.\n\nThis conservatism is a direct consequence of the discrete nature of the binomial distribution. The construction of the confidence interval is based on inverting a hypothesis test. An observation $x$ is included in the acceptance region of a test for a given $p_0$ if it is not in the tails of the distribution. For a two-sided test with significance level $\\alpha$, we would ideally want to define the tails such that $\\mathrm{P}(X \\le k_{lower} | p_0) = \\alpha/2$ and $\\mathrm{P}(X \\ge k_{upper} | p_0) = \\alpha/2$. However, because the cumulative distribution function (CDF) of a discrete distribution like the binomial is a step function (it increases in discrete jumps), it is generally impossible to find integers $k_{lower}$ and $k_{upper}$ for which these equalities hold exactly.\n\nTo ensure the Type I error rate does not exceed $\\alpha$, one must define the rejection region such that $\\mathrm{P}(\\text{reject } H_0 | p_0) \\le \\alpha$. For the two-sided test inverted by the Clopper-Pearson method, this means the probability of the lower tail must be at most $\\alpha/2$ and the probability of the upper tail must be at most $\\alpha/2$. When these tests are inverted to form the confidence interval, the condition that guarantees the interval contains the true parameter $p$ is met with a probability that is, for most values of $p$, strictly greater than $1-\\alpha$.\n\nIn formal terms, the coverage probability for a true parameter $p$ is $\\mathrm{P}(p \\in [p_L(X), p_U(X)])$. By construction of the Clopper-Pearson interval, this is equal to $\\mathrm{P}(\\mathrm{P}(Y \\le X | p) \\ge \\alpha/2 \\text{ and } \\mathrm{P}(Y \\ge X | p) \\ge \\alpha/2)$, where $Y \\sim \\mathrm{Binomial}(n, p)$. Due to the discreteness, the actual probabilities $\\mathrm{P}(Y \\le X | p)$ and $\\mathrm{P}(Y \\ge X | p)$ rarely equal $\\alpha/2$ exactly. Summing over all possible outcomes $x$, the total probability that the interval covers $p$ fluctuates as a function of $p$, but it never falls below the nominal $1-\\alpha$ level. This property of having coverage always greater than or equal to the nominal level is the definition of a conservative interval.\n\nThe problem asks for the numerical value of the lower bound, rounded to four significant figures.\n$$ p_L = (0.025)^{1/60} \\approx 0.940360 $$\nRounding to four significant figures gives $0.9404$.", "answer": "$$ \\boxed{0.9404} $$", "id": "4592234"}]}