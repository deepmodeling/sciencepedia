{"hands_on_practices": [{"introduction": "All Age-Period-Cohort (APC) analysis begins with data organized by age and calendar time. The power of this approach comes from recognizing that these two dimensions also define a third: the birth cohort. This first exercise focuses on the fundamental identity that links these three time scales. By mastering this simple calculation, you will solidify your understanding of how individuals are grouped and tracked across time in the aggregated data tables used for APC modeling [@problem_id:4571535].", "problem": "A population-based cancer registry has aggregated counts and person-time by single-year age and calendar year. The data are organized in a rectangular array where each cell corresponds to an Age-Period-Cohort (APC) combination. Let $a$ denote age in completed years at the midpoint of the calendar year, $p$ denote the calendar year, and $c$ denote the birth cohort year. For APC analysis, each APC cell is indexed by $(a,p)$ with $a \\in \\{0,1,2,\\dots,99\\}$ and $p \\in \\{1995,1996,\\dots,2010\\}$, and the cohort index $c$ is to be defined so that it is consistent with the epidemiologic definition of age as elapsed time since birth and period as calendar time.\n\nYou are given one cell from the registry: age $a = 37$ observed in calendar year $p = 2009$, with incident cases $N_{37,2009} = 54$ and person-years $Y_{37,2009} = 17{,}300$. Using a scientifically consistent indexing for $a$, $p$, and $c$ that aligns with the fundamental definitions of age and period described above, determine the cohort index $c$ for this APC cell. Express your answer as an integer calendar year. No rounding is required.", "solution": "The problem requires the determination of the birth cohort year, denoted by the index $c$, for a specific Age-Period-Cohort (APC) data cell. The given cell is defined by the age index $a$ and the period index $p$.\n\n**Step 1: Problem Validation**\n\nFirst, I will extract the given information and validate the problem statement.\n\n**Givens:**\n*   Age index: $a = 37$ years, defined as \"age in completed years at the midpoint of the calendar year\".\n*   Period index: $p = 2009$, defined as the calendar year.\n*   Cohort index: $c$, defined as the birth cohort year.\n*   The relationship between $a$, $p$, and $c$ must be \"consistent with the epidemiologic definition of age as elapsed time since birth and period as calendar time\".\n*   Additional data for the cell $(a,p) = (37, 2009)$: Incident cases $N_{37,2009} = 54$ and person-years $Y_{37,2009} = 17,300$.\n\n**Validation:**\n1.  **Scientific Grounding**: The problem is grounded in the established principles of epidemiology and biostatistics, specifically the methodology of Age-Period-Cohort (APC) analysis. The concepts of age, period, and cohort are fundamental to demography and public health.\n2.  **Well-Posedness**: The problem is well-posed. The relationship between age, period, and birth cohort is deterministic. Given any two of these variables, the third is typically specified by a clear identity. The question asks for a single, unique cohort index for the given age and period.\n3.  **Objectivity**: The problem is stated using precise, objective terminology common to the field of epidemiology.\n4.  **Flaw Analysis**:\n    *   The problem does not violate any scientific principles.\n    *   It is directly formalizable and relevant to APC analysis.\n    *   The information provided ($a=37$, $p=2009$) is sufficient to determine $c$. The additional data ($N_{37,2009}$ and $Y_{37,2009}$) are contextually relevant for calculating rates but are not needed to determine the cohort index itself. They do not introduce contradiction.\n    *   The values are realistic, and the setup is feasible.\n    *   The problem is not ill-posed; the standard indexing convention provides a unique answer. While the aggregation of people into an \"age $37$\" group in a given year involves individuals from two adjacent birth cohorts, the indexing of the cell $(a,p)$ itself conventionally follows a single, simple identity.\n\n**Verdict:** The problem is valid.\n\n**Step 2: Solution Derivation**\n\nThe core of Age-Period-Cohort analysis lies in the interrelationship between the three time scales: age ($a$), period ($p$), and cohort ($c$).\n\n*   **Period ($p$)** is calendar time.\n*   **Age ($a$)** is the time elapsed since birth.\n*   **Cohort ($c$)** is the time of birth.\n\nThese three quantities are not independent. For an individual born in calendar year $c$, their age $a$ during calendar year $p$ is given by the difference between the current year and their birth year. This leads to the fundamental identity used in APC analysis:\n$$a \\approx p - c$$\nRearranging this identity to solve for the birth cohort year $c$ gives:\n$$c \\approx p - a$$\nIn the context of APC models, where data are aggregated into discrete cells indexed by integer values of age $a$ and period $p$, this approximation is treated as an exact identity for the purpose of indexing the cohort effect:\n$$c = p - a$$\nThis linear dependency is a defining feature of APC models and is the source of the \"identification problem,\" where the separate linear effects of age, period, and cohort cannot be uniquely estimated without imposing at least one constraint on the model parameters. The \"scientifically consistent indexing\" requested in the problem statement refers to this fundamental identity.\n\nThe problem provides the specific values for the age and period indices for the cell in question:\n*   Age index: $a = 37$\n*   Period index: $p = 2009$\n\nSubstituting these values into the cohort indexing identity:\n$$c = 2009 - 37$$\nPerforming the subtraction yields the cohort year:\n$$c = 1972$$\nTherefore, the APC cell for age $37$ in the year $2009$ corresponds to the birth cohort of $1972$. The provided data on incident cases ($N_{37,2009} = 54$) and person-years ($Y_{37,2009} = 17,300$) are used for calculating the incidence rate for this cell but are extraneous to the task of identifying the cohort index $c$.", "answer": "$$\\boxed{1972}$$", "id": "4571535"}, {"introduction": "The linear dependency between age, period, and cohort indices, often expressed as $c = p - a$, creates a fundamental challenge known as the \"identification problem.\" It is impossible to uniquely separate the linear trends of the age, period, and cohort effects. However, this does not mean the model is without value. This practice demonstrates that specific features of the trends, known as \"estimable functions,\" can be reliably estimated. You will calculate the \"curvatures\" (second differences) of the period and cohort effects, which are immune to the identification problem and reveal the nonlinear changes in trends [@problem_id:4571547].", "problem": "Consider a standard Age–Period–Cohort (APC) model for incidence rates, where the logarithm of the rate in age category $a$ and period category $p$ is modeled as $\\ln(\\lambda_{ap}) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c}$, with cohort category $c$ determined by the identity $c = p - a$. Assume categorical effects for age $(\\alpha_{a})$, period $(\\pi_{p})$, and cohort $(\\gamma_{c})$ and that the data are structured on the full age-by-period grid so that the cohort index is uniquely determined by age and period.\n\nYou are given $P = 6$ period categories with period effects $(\\pi_{1}, \\pi_{2}, \\pi_{3}, \\pi_{4}, \\pi_{5}, \\pi_{6}) = (0.10, 0.18, 0.27, 0.29, 0.31, 0.30)$ and $C = 7$ cohort categories with cohort effects $(\\gamma_{1}, \\gamma_{2}, \\gamma_{3}, \\gamma_{4}, \\gamma_{5}, \\gamma_{6}, \\gamma_{7}) = (-0.05, -0.02, 0.01, 0.05, 0.06, 0.06, 0.04)$.\n\nDefine the first-difference operator on a sequence $\\{f_{k}\\}$ by $\\Delta f_{k} = f_{k} - f_{k-1}$ and the second-difference operator by $\\Delta^{2} f_{k} = \\Delta(\\Delta f_{k}) = f_{k+1} - 2 f_{k} + f_{k-1}$ for interior indices.\n\nStarting from the APC identity $c = p - a$ and the definition of categorical APC effects, derive which features of $(\\pi_{p})$ and $(\\gamma_{c})$ are estimable without imposing arbitrary constraints, and then compute the specific curvature contrasts $\\Delta^{2} \\pi_{3}$ and $\\Delta^{2} \\gamma_{4}$. Finally, determine the dimension (as a single integer) of the estimable curvature subspace for the combined set of period and cohort effects given $P$ and $C$.\n\nExpress your final answer as a row matrix with three entries in the order $\\Delta^{2} \\pi_{3}$, $\\Delta^{2} \\gamma_{4}$, and the dimension. No rounding is required. Do not include units.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the statistical theory of Age-Period-Cohort (APC) models, is well-posed with sufficient information for a unique solution, and is stated using objective and precise terminology.\n\nThe problem centers on the Age-Period-Cohort (APC) model for rates $\\lambda_{ap}$, where the index $a$ denotes age category and $p$ denotes period category. The model is given by:\n$$\n\\ln(\\lambda_{ap}) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c}\n$$\nThe cohort category, $c$, is linearly dependent on age and period through the identity $c = p - a$. This exact linear relationship is the source of the fundamental non-identifiability problem in APC models. Specifically, for any constant $k$, the following transformation of the parameters\n\\begin{align*}\n\\alpha_{a}^{*} &= \\alpha_{a} + k \\cdot a \\\\\n\\pi_{p}^{*} &= \\pi_{p} - k \\cdot p \\\\\n\\gamma_{c}^{*} &= \\gamma_{c} + k \\cdot c\n\\end{align*}\nleaves the predicted value of the model unchanged. This is demonstrated by substituting the transformed parameters into the model equation:\n$$\n\\mu + \\alpha_{a}^{*} + \\pi_{p}^{*} + \\gamma_{c}^{*} = \\mu + (\\alpha_{a} + k \\cdot a) + (\\pi_{p} - k \\cdot p) + (\\gamma_{c} + k \\cdot c)\n$$\nUsing the identity $c = p - a$, the terms involving $k$ cancel out:\n$$\n\\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c} + ka - kp + k(p - a) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c} + (ka - ka) + (-kp + kp) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c}\n$$\nSince the model's predictions are invariant to this transformation for any arbitrary $k$, the individual parameters $\\alpha_{a}$, $\\pi_{p}$, and $\\gamma_{c}$ are not uniquely estimable from the data. Specifically, their linear trends (or \"drifts\") are confounded.\n\nA function of the model parameters is called \"estimable\" if its value is invariant under all non-identifying transformations. We investigate the second-difference operator, defined as $\\Delta^{2} f_{k} = f_{k+1} - 2 f_{k} + f_{k-1}$. The key property of this operator is that it annihilates linear functions. If $f_k = m \\cdot k + b$, then $\\Delta^2 f_k = (m(k+1)+b) - 2(mk+b) + (m(k-1)+b) = m(k+1 - 2k + k-1) + b(1-2+1) = 0$.\n\nLet us apply this operator to the transformed period effects, $\\pi_{p}^{*} = \\pi_{p} - k \\cdot p$:\n$$\n\\Delta^{2} \\pi_{p}^{*} = \\Delta^{2} (\\pi_{p} - k \\cdot p) = \\Delta^{2} \\pi_{p} - k \\cdot \\Delta^{2} p\n$$\nSince $\\Delta^{2} p = (p+1) - 2p + (p-1) = 0$, we have:\n$$\n\\Delta^{2} \\pi_{p}^{*} = \\Delta^{2} \\pi_{p}\n$$\nThe second difference of the period effects is invariant to the transformation and is therefore an estimable function. These quantities are often referred to as the \"curvature\" of the period effect.\n\nSimilarly, for the transformed cohort effects, $\\gamma_{c}^{*} = \\gamma_{c} + k \\cdot c$:\n$$\n\\Delta^{2} \\gamma_{c}^{*} = \\Delta^{2} (\\gamma_{c} + k \\cdot c) = \\Delta^{2} \\gamma_{c} + k \\cdot \\Delta^{2} c\n$$\nSince $\\Delta^{2} c = (c+1) - 2c + (c-1) = 0$, we have:\n$$\n\\Delta^{2} \\gamma_{c}^{*} = \\Delta^{2} \\gamma_{c}\n$$\nThe second difference, or curvature, of the cohort effects is also an estimable function. These second differences are the primary features of the period and cohort effects that can be estimated without imposing arbitrary constraints on the model parameters.\n\nNext, we compute the specific curvature contrasts $\\Delta^{2} \\pi_{3}$ and $\\Delta^{2} \\gamma_{4}$ using the provided data.\nThe period effects are given as $(\\pi_{1}, \\pi_{2}, \\pi_{3}, \\pi_{4}, \\pi_{5}, \\pi_{6}) = (0.10, 0.18, 0.27, 0.29, 0.31, 0.30)$.\nThe second difference for the period effect at index $p=3$ is:\n$$\n\\Delta^{2} \\pi_{3} = \\pi_{4} - 2 \\pi_{3} + \\pi_{2} = 0.29 - 2(0.27) + 0.18 = 0.29 - 0.54 + 0.18 = -0.07\n$$\n\nThe cohort effects are given as $(\\gamma_{1}, \\gamma_{2}, \\gamma_{3}, \\gamma_{4}, \\gamma_{5}, \\gamma_{6}, \\gamma_{7}) = (-0.05, -0.02, 0.01, 0.05, 0.06, 0.06, 0.04)$.\nThe second difference for the cohort effect at index $c=4$ is:\n$$\n\\Delta^{2} \\gamma_{4} = \\gamma_{5} - 2 \\gamma_{4} + \\gamma_{3} = 0.06 - 2(0.05) + 0.01 = 0.06 - 0.10 + 0.01 = -0.03\n$$\n\nFinally, we determine the dimension of the estimable curvature subspace for the combined set of period and cohort effects.\nThe estimable curvatures for the period effects are the set of second differences $\\{\\Delta^{2} \\pi_{p}\\}$ for all interior indices $p$. Given $P=6$ period categories, the interior indices are $p = 2, 3, 4, 5$. This provides $P-2 = 6-2=4$ linearly independent estimable contrasts, which form a basis for the period curvature subspace.\nThe estimable curvatures for the cohort effects are the set of second differences $\\{\\Delta^{2} \\gamma_{c}\\}$ for all interior indices $c$. Given $C=7$ cohort categories, the interior indices are $c = 2, 3, 4, 5, 6$. This provides $C-2 = 7-2=5$ linearly independent estimable contrasts, which form a basis for the cohort curvature subspace.\n\nThe combined estimable curvature subspace is spanned by the union of the basis vectors for the period curvatures and the basis vectors for the cohort curvatures. Since the period contrasts involve only the parameters $\\{\\pi_p\\}$ and the cohort contrasts involve only the parameters $\\{\\gamma_c\\}$, these two sets of basis vectors are linearly independent of each other. Therefore, the dimension of the combined subspace is the sum of the dimensions of the individual subspaces.\n$$\n\\text{Dimension} = (\\text{Dimension of Period Curvature Subspace}) + (\\text{Dimension of Cohort Curvature Subspace})\n$$\n$$\n\\text{Dimension} = (P-2) + (C-2)\n$$\nSubstituting the given values $P=6$ and $C=7$:\n$$\n\\text{Dimension} = (6-2) + (7-2) = 4 + 5 = 9\n$$\nThe dimension of the estimable curvature subspace for the combined set of period and cohort effects is $9$.\n\nThe three requested values are $\\Delta^{2} \\pi_{3} = -0.07$, $\\Delta^{2} \\gamma_{4} = -0.03$, and the dimension is $9$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -0.07 & -0.03 & 9 \\end{pmatrix}}\n$$", "id": "4571547"}, {"introduction": "Fitting a model is just the beginning; a responsible analysis requires checking if the model's assumptions hold true for the data. The standard APC model for count data is the Poisson log-linear model, which assumes the variance of the counts equals their mean. This exercise guides you through a crucial diagnostic check for \"overdispersion,\" a common situation where the observed variance is larger than the model assumes. By computing the Pearson-based dispersion estimate, you will learn a vital skill in statistical modeling: validating your model's foundation before drawing conclusions from it [@problem_id:4571569].", "problem": "An epidemiologist fits an Age–Period–Cohort (APC) log-linear Poisson model to a $4 \\times 4$ age-by-period table of incident case counts, where the linear predictor includes additive age, period, and cohort main effects with standard identifiability constraints. The fundamental base assumptions to use are: under a Poisson model, the variance equals the mean, and standardized residuals constructed from observed counts and model-predicted means can be used to assess model adequacy via large-sample approximations. The fitted APC model is constructed with an intercept, sum-to-zero constraints on age, period, and cohort categorical effects, and a single additional linear constraint to resolve the inherent aliasing among age, period, and cohort indices; under these constraints, the design matrix has rank $r = 13$.\n\nYou are given observed counts $Y_{a,p}$ and fitted means $\\hat{\\mu}_{a,p}$ for ages $a \\in \\{1,2,3,4\\}$ and periods $p \\in \\{1,2,3,4\\}$:\n- Age group $1$: $Y_{1,\\cdot} = (8, 7, 7, 6)$ and $\\hat{\\mu}_{1,\\cdot} = (7.3, 7.2, 7.5, 6.2)$.\n- Age group $2$: $Y_{2,\\cdot} = (14, 13, 12, 10)$ and $\\hat{\\mu}_{2,\\cdot} = (13.5, 13.0, 12.6, 11.4)$.\n- Age group $3$: $Y_{3,\\cdot} = (25, 22, 19, 17)$ and $\\hat{\\mu}_{3,\\cdot} = (24.0, 21.7, 20.5, 18.9)$.\n- Age group $4$: $Y_{4,\\cdot} = (47, 32, 26, 24)$ and $\\hat{\\mu}_{4,\\cdot} = (38.1, 36.2, 33.3, 29.7)$.\n\nStarting from the fundamental base that in a Poisson model $\\mathrm{Var}(Y_{a,p})=\\mathbb{E}(Y_{a,p})$ and that sums of squared standardized residuals are asymptotically comparable to a chi-square reference with appropriate degrees of freedom, construct the Pearson-based overdispersion test for the APC Poisson model, compute the dispersion estimate $\\hat{\\phi}$ defined as the Pearson chi-square divided by its degrees of freedom, and give its numerical value. Use the number of cells $N = 16$ and the rank $r = 13$ to determine the degrees of freedom. Round your answer to three significant figures. Express your final answer as a dimensionless number.", "solution": "The problem is valid. It is a well-posed statistical calculation based on standard epidemiological modeling principles, specifically the analysis of count data using a log-linear Poisson model. All necessary data and parameters are provided, and the problem is internally consistent and scientifically grounded.\n\nThe primary objective is to compute the Pearson-based overdispersion estimate, $\\hat{\\phi}$, for an Age-Period-Cohort (APC) model fitted to a $4 \\times 4$ table of incident case counts. This estimate is a crucial diagnostic tool for assessing the validity of the Poisson model's mean-variance assumption.\n\nIn a Poisson generalized linear model, the variance of the response variable $Y_{a,p}$ is assumed to be equal to its mean, $\\mathrm{Var}(Y_{a,p}) = \\mathbb{E}(Y_{a,p}) = \\mu_{a,p}$. Overdispersion occurs when the observed variance is larger than the mean. The Pearson chi-square statistic, $X^2$, provides a measure of the goodness-of-fit and can be used to estimate the scale of this overdispersion.\n\nThe Pearson chi-square statistic is defined as the sum of the squared Pearson residuals over all $N$ cells of the data table. The Pearson residual for a cell with observed count $Y_{a,p}$ and fitted mean $\\hat{\\mu}_{a,p}$ is given by $\\frac{Y_{a,p} - \\hat{\\mu}_{a,p}}{\\sqrt{\\hat{\\mu}_{a,p}}}$. Therefore, the statistic is:\n$$ X^2 = \\sum_{a=1}^{4} \\sum_{p=1}^{4} \\frac{(Y_{a,p} - \\hat{\\mu}_{a,p})^2}{\\hat{\\mu}_{a,p}} $$\nUnder the null hypothesis that the model is correctly specified, $X^2$ asymptotically follows a chi-square distribution, $\\chi^2_{df}$, with degrees of freedom $df$ calculated as the number of data points ($N$) minus the number of estimated parameters ($r$). The problem states that there are $N = 16$ cells and the rank of the design matrix is $r = 13$, which corresponds to the number of independent parameters in the constrained APC model.\nThe degrees of freedom are:\n$$ df = N - r = 16 - 13 = 3 $$\nThe dispersion estimate $\\hat{\\phi}$ is then calculated as the Pearson chi-square statistic divided by its degrees of freedom. A value of $\\hat{\\phi} \\approx 1$ suggests that the Poisson model is appropriate, while $\\hat{\\phi} > 1$ indicates overdispersion.\n$$ \\hat{\\phi} = \\frac{X^2}{df} $$\nWe now proceed to calculate the value of $X^2$ using the provided observed counts $Y_{a,p}$ and fitted means $\\hat{\\mu}_{a,p}$.\n\nFor age group $a=1$:\n- $\\frac{(8 - 7.3)^2}{7.3} = \\frac{0.49}{7.3} \\approx 0.067123$\n- $\\frac{(7 - 7.2)^2}{7.2} = \\frac{0.04}{7.2} \\approx 0.005556$\n- $\\frac{(7 - 7.5)^2}{7.5} = \\frac{0.25}{7.5} \\approx 0.033333$\n- $\\frac{(6 - 6.2)^2}{6.2} = \\frac{0.04}{6.2} \\approx 0.006452$\n\nFor age group $a=2$:\n- $\\frac{(14 - 13.5)^2}{13.5} = \\frac{0.25}{13.5} \\approx 0.018519$\n- $\\frac{(13 - 13.0)^2}{13.0} = \\frac{0}{13.0} = 0$\n- $\\frac{(12 - 12.6)^2}{12.6} = \\frac{0.36}{12.6} \\approx 0.028571$\n- $\\frac{(10 - 11.4)^2}{11.4} = \\frac{1.96}{11.4} \\approx 0.171930$\n\nFor age group $a=3$:\n- $\\frac{(25 - 24.0)^2}{24.0} = \\frac{1}{24.0} \\approx 0.041667$\n- $\\frac{(22 - 21.7)^2}{21.7} = \\frac{0.09}{21.7} \\approx 0.004147$\n- $\\frac{(19 - 20.5)^2}{20.5} = \\frac{2.25}{20.5} \\approx 0.109756$\n- $\\frac{(17 - 18.9)^2}{18.9} = \\frac{3.61}{18.9} \\approx 0.190995$\n\nFor age group $a=4$:\n- $\\frac{(47 - 38.1)^2}{38.1} = \\frac{79.21}{38.1} \\approx 2.079003$\n- $\\frac{(32 - 36.2)^2}{36.2} = \\frac{17.64}{36.2} \\approx 0.487293$\n- $\\frac{(26 - 33.3)^2}{33.3} = \\frac{53.29}{33.3} \\approx 1.600300$\n- $\\frac{(24 - 29.7)^2}{29.7} = \\frac{32.49}{29.7} \\approx 1.093939$\n\nSumming these $16$ terms gives the Pearson chi-square statistic:\n$$ X^2 \\approx 0.067123 + 0.005556 + 0.033333 + 0.006452 + 0.018519 + 0 + 0.028571 + 0.171930 \\\\ + 0.041667 + 0.004147 + 0.109756 + 0.190995 + 2.079003 + 0.487293 + 1.600300 + 1.093939 $$\n$$ X^2 \\approx 5.938584 $$\nFinally, we compute the dispersion estimate $\\hat{\\phi}$ by dividing $X^2$ by the degrees of freedom, $df=3$:\n$$ \\hat{\\phi} = \\frac{X^2}{df} \\approx \\frac{5.938584}{3} \\approx 1.979528 $$\nThe problem requires rounding the result to three significant figures.\n$$ \\hat{\\phi} \\approx 1.98 $$\nThis value indicates that the variance in the data is approximately $1.98$ times greater than the mean, suggesting significant overdispersion.", "answer": "$$\n\\boxed{1.98}\n$$", "id": "4571569"}]}