{"hands_on_practices": [{"introduction": "The most common mistake in interpreting data is equating association with causation. This fundamental exercise provides a hands-on opportunity to see why these two concepts diverge and how to correct for it. Using a hypothetical but realistic dataset [@problem_id:4576153], you will calculate both the 'crude' associational measure and the true causal effect, revealing the impact of a confounder and demonstrating how conditioning on it can recover the true causal relationship.", "problem": "Consider an observational cohort study evaluating a binary treatment $A \\in \\{0,1\\}$ on a binary outcome $Y \\in \\{0,1\\}$, with a baseline confounder $X \\in \\{0,1\\}$ measured prior to treatment. Let $Y^1$ and $Y^0$ denote the potential outcomes under treatment and no treatment, respectively, and assume the following core definitions hold throughout the study: consistency ($Y = Y^A$), exchangeability ($Y^a \\perp\\!\\!\\!\\perp A$ for $a \\in \\{0,1\\}$), conditional exchangeability ($Y^a \\perp\\!\\!\\!\\perp A \\mid X$ for $a \\in \\{0,1\\}$), and positivity ($0 < P(A=a \\mid X=x)$ for all $x$ with $P(X=x) > 0$). The Average Treatment Effect (ATE) is defined as $E(Y^1) - E(Y^0)$.\n\nSuppose the following data-generating mechanism holds:\n- $P(X=1) = 0.5$ and $P(X=0) = 0.5$.\n- $P(A=1 \\mid X=1) = 0.8$ and $P(A=1 \\mid X=0) = 0.2$.\n- $E(Y^1 \\mid X=1) = 0.9$, $E(Y^1 \\mid X=0) = 0.5$; $E(Y^0 \\mid X=1) = 0.7$, $E(Y^0 \\mid X=0) = 0.2$.\n\nAssume that treatment assignment depends on $X$ but, given $X$, is otherwise unrelated to the potential outcomes, and that all modeling assumptions are scientifically plausible in an epidemiologic setting.\n\nUsing only the definitions above and the given probabilities, evaluate which statements below are correct:\n\nA. Because consistency and positivity hold, the unadjusted difference in observed means $E(Y \\mid A=1) - E(Y \\mid A=0)$ identifies $E(Y^1) - E(Y^0)$, so unconditional exchangeability is not required. \n\nB. Unconditional exchangeability fails in this setting because $E(Y^1 \\mid A=1) \\neq E(Y^1)$, specifically $E(Y^1 \\mid A=1) = 0.82$ while $E(Y^1) = 0.7$. By conditioning on $X$, conditional exchangeability is restored, and standardization recovers $E(Y^1) = 0.7$ and $E(Y^0) = 0.45$, yielding an Average Treatment Effect of $0.25$.\n\nC. Adjusting for $X$ would introduce selection bias because $X$ is a collider affected by treatment, so conditioning on $X$ is inappropriate in this scenario.\n\nD. Positivity is violated since $P(A=1 \\mid X=0) = 0$, implying that $E(Y^a)$ is not identifiable even after conditioning on $X$.\n\nE. Within levels of $X$, the difference in observed outcomes between $A=1$ and $A=0$ equals the causal effect in that stratum, and averaging these stratum-specific causal effects by $P(X=x)$ yields the true Average Treatment Effect.\n\nSelect all that apply.", "solution": "The user has provided a problem in causal inference and asked for an evaluation of several statements. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n\n-   **Variables**: Binary treatment $A \\in \\{0,1\\}$, binary outcome $Y \\in \\{0,1\\}$, and binary baseline confounder $X \\in \\{0,1\\}$.\n-   **Potential Outcomes**: $Y^1$ (outcome if $A=1$), $Y^0$ (outcome if $A=0$).\n-   **Definitions and Assumptions**:\n    -   Consistency: $Y = Y^A$.\n    -   Exchangeability: $Y^a \\perp\\!\\!\\!\\perp A$ for $a \\in \\{0,1\\}$.\n    -   Conditional Exchangeability: $Y^a \\perp\\!\\!\\!\\perp A \\mid X$ for $a \\in \\{0,1\\}$. This is stated to hold.\n    -   Positivity: $0 < P(A=a \\mid X=x)$ for all $x$ with $P(X=x) > 0$.\n-   **Quantity of Interest**: Average Treatment Effect (ATE) $= E(Y^1) - E(Y^0)$.\n-   **Data-Generating Mechanism**:\n    -   $P(X=1) = 0.5$ and $P(X=0) = 0.5$.\n    -   $P(A=1 \\mid X=1) = 0.8$ and $P(A=1 \\mid X=0) = 0.2$.\n    -   $E(Y^1 \\mid X=1) = 0.9$ and $E(Y^1 \\mid X=0) = 0.5$.\n    -   $E(Y^0 \\mid X=1) = 0.7$ and $E(Y^0 \\mid X=0) = 0.2$.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem is situated within the potential outcomes framework (also known as the Rubin Causal Model), which is a standard and rigorously defined approach to causal inference in epidemiology, statistics, and other quantitative sciences. The concepts of exchangeability, positivity, consistency, confounding, and the ATE are fundamental principles of this framework. The setup describes a classic scenario of confounding, where a variable $X$ is a common cause of treatment $A$ and the outcome $Y$. All elements are scientifically sound.\n-   **Well-Posed**: The problem provides sufficient numerical data and clear definitions to calculate both the causal effect of interest (ATE) and the corresponding associational measure (the unadjusted difference in mean outcomes). The question is unambiguous.\n-   **Objectivity**: The problem is stated using precise, formal mathematical and statistical language, free from subjectivity or ambiguity.\n-   **Flaw Check**:\n    1.  **Scientific/Factual Unsoundness**: None. The probabilistic model is self-consistent and adheres to the axioms of probability.\n    2.  **Non-Formalizable/Irrelevant**: None. The problem is a formal exercise in applied probability and causal theory.\n    3.  **Incomplete/Contradictory Setup**: None. All necessary information is provided. For example, $P(A=0 \\mid X=1) = 1 - P(A=1 \\mid X=1) = 1 - 0.8 = 0.2$, and $P(A=0 \\mid X=0) = 1 - P(A=1 \\mid X=0) = 1 - 0.2 = 0.8$. All probabilities are coherent.\n    4.  **Unrealistic/Infeasible**: None. The values are hypothetical but represent a plausible scenario in an observational study.\n    5.  **Ill-Posed/Poorly Structured**: None. The problem is well-structured.\n    6.  **Pseudo-Profound/Trivial**: None. The problem tests a foundational concept in epidemiology: the distinction between association and causation and the method (standardization/stratification) for correcting for confounding.\n    7.  **Outside Scientific Verifiability**: None. All claims can be verified through calculation.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. I will proceed with a full derivation and an evaluation of each option.\n\n### Derivation of Causal and Associational Quantities\n\n**1. Calculate the Average Treatment Effect (ATE)**\n\nThe ATE, $E(Y^1) - E(Y^0)$, is a causal quantity. Since conditional exchangeability ($Y^a \\perp\\!\\!\\!\\perp A \\mid X$) is assumed, we can identify the marginal means of the potential outcomes by standardizing over the distribution of the confounder $X$.\n\nThe formula for standardization is $E(Y^a) = \\sum_{x} E(Y^a \\mid X=x) P(X=x)$.\n\nFor $Y^1$:\n$$ E(Y^1) = E(Y^1 \\mid X=1)P(X=1) + E(Y^1 \\mid X=0)P(X=0) $$\n$$ E(Y^1) = (0.9)(0.5) + (0.5)(0.5) = 0.45 + 0.25 = 0.70 $$\n\nFor $Y^0$:\n$$ E(Y^0) = E(Y^0 \\mid X=1)P(X=1) + E(Y^0 \\mid X=0)P(X=0) $$\n$$ E(Y^0) = (0.7)(0.5) + (0.2)(0.5) = 0.35 + 0.10 = 0.45 $$\n\nTherefore, the ATE is:\n$$ \\text{ATE} = E(Y^1) - E(Y^0) = 0.70 - 0.45 = 0.25 $$\n\n**2. Calculate the Unadjusted Associational Difference**\n\nThis is the non-causal \"crude\" difference in means between the treated and untreated groups: $E(Y \\mid A=1) - E(Y \\mid A=0)$. We use the law of total expectation, conditioning on $X$.\n$$ E(Y \\mid A=a) = \\sum_{x} E(Y \\mid A=a, X=x) P(X=x \\mid A=a) $$\nUnder consistency ($Y=Y^A$) and conditional exchangeability ($Y^a \\perp\\!\\!\\!\\perp A \\mid X$), we have $E(Y \\mid A=a, X=x) = E(Y^a \\mid A=a, X=x) = E(Y^a \\mid X=x)$. So:\n$$ E(Y \\mid A=1, X=1) = E(Y^1 \\mid X=1) = 0.9 $$\n$$ E(Y \\mid A=1, X=0) = E(Y^1 \\mid X=0) = 0.5 $$\n$$ E(Y \\mid A=0, X=1) = E(Y^0 \\mid X=1) = 0.7 $$\n$$ E(Y \\mid A=0, X=0) = E(Y^0 \\mid X=0) = 0.2 $$\n\nNext, we need the conditional probabilities $P(X=x \\mid A=a)$, which we find using Bayes' rule. First, we find the marginal probability of treatment, $P(A=1)$:\n$$ P(A=1) = P(A=1 \\mid X=1)P(X=1) + P(A=1 \\mid X=0)P(X=0) $$\n$$ P(A=1) = (0.8)(0.5) + (0.2)(0.5) = 0.4 + 0.1 = 0.5 $$\nThus, $P(A=0) = 1 - P(A=1) = 0.5$.\n\nNow for Bayes' rule:\n$$ P(X=1 \\mid A=1) = \\frac{P(A=1 \\mid X=1) P(X=1)}{P(A=1)} = \\frac{(0.8)(0.5)}{0.5} = 0.8 $$\n$$ P(X=0 \\mid A=1) = 1 - P(X=1 \\mid A=1) = 0.2 $$\n$$ P(X=1 \\mid A=0) = \\frac{P(A=0 \\mid X=1) P(X=1)}{P(A=0)} = \\frac{(1-0.8)(0.5)}{0.5} = 0.2 $$\n$$ P(X=0 \\mid A=0) = 1 - P(X=1 \\mid A=0) = 0.8 $$\n\nNow we can compute the observed means:\n$$ E(Y \\mid A=1) = E(Y \\mid A=1, X=1)P(X=1 \\mid A=1) + E(Y \\mid A=1, X=0)P(X=0 \\mid A=1) $$\n$$ E(Y \\mid A=1) = (0.9)(0.8) + (0.5)(0.2) = 0.72 + 0.10 = 0.82 $$\n\n$$ E(Y \\mid A=0) = E(Y \\mid A=0, X=1)P(X=1 \\mid A=0) + E(Y \\mid A=0, X=0)P(X=0 \\mid A=0) $$\n$$ E(Y \\mid A=0) = (0.7)(0.2) + (0.2)(0.8) = 0.14 + 0.16 = 0.30 $$\n\nThe unadjusted associational difference is:\n$$ E(Y \\mid A=1) - E(Y \\mid A=0) = 0.82 - 0.30 = 0.52 $$\n\n### Option-by-Option Analysis\n\n**A. Because consistency and positivity hold, the unadjusted difference in observed means $E(Y \\mid A=1) - E(Y \\mid A=0)$ identifies $E(Y^1) - E(Y^0)$, so unconditional exchangeability is not required.**\nThis statement claims that the unadjusted difference ($0.52$) identifies the ATE ($0.25$). Our calculations show this is false ($0.52 \\neq 0.25$). The reason for this discrepancy is confounding, which is equivalent to the failure of unconditional exchangeability. For the unadjusted difference to identify the ATE, three assumptions are required: consistency, positivity, AND unconditional exchangeability. The statement incorrectly claims the third is not required.\n**Verdict: Incorrect.**\n\n**B. Unconditional exchangeability fails in this setting because $E(Y^1 \\mid A=1) \\neq E(Y^1)$, specifically $E(Y^1 \\mid A=1) = 0.82$ while $E(Y^1) = 0.7$. By conditioning on $X$, conditional exchangeability is restored, and standardization recovers $E(Y^1) = 0.7$ and $E(Y^0) = 0.45$, yielding an Average Treatment Effect of $0.25$.**\nLet's verify each claim in this statement.\n1.  Failure of Unconditional Exchangeability: This would mean $E(Y^a \\mid A=1) \\neq E(Y^a)$. For $a=1$, we need to check if $E(Y^1 \\mid A=1) \\neq E(Y^1)$.\n    $E(Y^1)=0.70$ from our ATE calculation.\n    $E(Y^1 \\mid A=1)$ can be computed as:\n    $E(Y^1 \\mid A=1) = \\sum_{x} E(Y^1 \\mid A=1, X=x)P(X=x \\mid A=1)$. due to conditional exchangeability, this is $\\sum_{x} E(Y^1 \\mid X=x)P(X=x \\mid A=1)$.\n    $E(Y^1 \\mid A=1) = E(Y^1 \\mid X=1)P(X=1 \\mid A=1) + E(Y^1 \\mid X=0)P(X=0 \\mid A=1) = (0.9)(0.8) + (0.5)(0.2) = 0.72 + 0.10 = 0.82$.\n    The statement correctly asserts that $E(Y^1 \\mid A=1) = 0.82 \\neq E(Y^1) = 0.7$.\n2.  Restoration of Exchangeability: The phrasing \"conditional exchangeability is restored\" is slightly informal; the crucial point is that conditional exchangeability is assumed to hold, which enables the adjustment.\n3.  Standardization values: The statement claims standardization yields $E(Y^1) = 0.7$ and $E(Y^0) = 0.45$. These match our calculations precisely.\n4.  ATE value: The statement claims an ATE of $0.7 - 0.45 = 0.25$. This also matches our calculation.\nEvery numerical claim and the core conceptual points are correct.\n**Verdict: Correct.**\n\n**C. Adjusting for $X$ would introduce selection bias because $X$ is a collider affected by treatment, so conditioning on $X$ is inappropriate in this scenario.**\nThis statement mischaracterizes the causal structure. $X$ is a baseline variable measured before treatment, so it cannot be \"affected by treatment\" ($A$). The data-generating process implies that $X$ influences both treatment assignment ($P(A=1|X)$ depends on $X$) and the potential outcomes ($E(Y^a|X)$ depends on $X$). This makes $X$ a common cause of $A$ and $Y$, i.e., a confounder, with the structure $A \\leftarrow X \\rightarrow Y$. A collider structure would be $A \\rightarrow X \\leftarrow Y$. Conditioning on a confounder is the standard and correct procedure to block the backdoor path and remove confounding bias. Conditioning on a collider would induce bias (selection bias), but $X$ is not a collider here.\n**Verdict: Incorrect.**\n\n**D. Positivity is violated since $P(A=1 \\mid X=0) = 0$, implying that $E(Y^a)$ is not identifiable even after conditioning on $X$.**\nThe positivity assumption requires $0 < P(A=a \\mid X=x)$ for all levels of $a$ and $x$ that exist in the population. We are given $P(A=1 \\mid X=0) = 0.2$. This value is greater than $0$. The statement's premise that $P(A=1 \\mid X=0) = 0$ is factually false based on the provided givens. We can also check the other conditions:\n$P(A=0 \\mid X=0) = 1 - 0.2 = 0.8 > 0$.\n$P(A=1 \\mid X=1) = 0.8 > 0$.\n$P(A=0 \\mid X=1) = 1 - 0.8 = 0.2 > 0$.\nPositivity is satisfied in all strata for both treatment levels. Therefore, the conclusion that the effects are not identifiable (due to positivity violation) is also false.\n**Verdict: Incorrect.**\n\n**E. Within levels of $X$, the difference in observed outcomes between $A=1$ and $A=0$ equals the causal effect in that stratum, and averaging these stratum-specific causal effects by $P(X=x)$ yields the true Average Treatment Effect.**\nLet's analyze this statement in two parts.\n1.  \"Within levels of $X$, the difference in observed outcomes... equals the causal effect in that stratum\".\n    The observed difference within stratum $x$ is $E(Y \\mid A=1, X=x) - E(Y \\mid A=0, X=x)$.\n    The causal effect in stratum $x$ is $E(Y^1 \\mid X=x) - E(Y^0 \\mid X=x)$.\n    Given consistency and conditional exchangeability, $E(Y \\mid A=a, X=x) = E(Y^a \\mid X=x)$. Thus, the observed difference within a stratum is indeed equal to the causal effect for that stratum. This part is correct.\n    For $X=1$: $E(Y^1|X=1)-E(Y^0|X=1) = 0.9 - 0.7 = 0.2$.\n    For $X=0$: $E(Y^1|X=0)-E(Y^0|X=0) = 0.5 - 0.2 = 0.3$.\n2.  \"averaging these stratum-specific causal effects by $P(X=x)$ yields the true Average Treatment Effect.\"\n    The ATE is $E(Y^1) - E(Y^0)$. By the law of total expectation:\n    $E(Y^1) - E(Y^0) = \\sum_{x} E(Y^1 \\mid X=x)P(X=x) - \\sum_{x} E(Y^0 \\mid X=x)P(X=x) = \\sum_{x} [E(Y^1 \\mid X=x) - E(Y^0 \\mid X=x)]P(X=x)$.\n    This equation shows that the ATE is the weighted average of the stratum-specific causal effects, with weights given by the prevalence of each stratum, $P(X=x)$. This principle is known as standardization or stratification. This part is also correct.\n    Calculation check: $(0.2)P(X=1) + (0.3)P(X=0) = (0.2)(0.5) + (0.3)(0.5) = 0.10 + 0.15 = 0.25$. This matches our ATE.\nThe entire statement provides a correct description of identification via stratification.\n**Verdict: Correct.**", "answer": "$$\\boxed{BE}$$", "id": "4576153"}, {"introduction": "Having seen how conditioning on a confounder can work in practice, we can now explore the theoretical underpinnings of this process. This problem [@problem_id:4576125] introduces a powerful idea: viewing causal inference as a missing data problem, where the counterfactual outcomes are the 'missing' values. By framing it this way, we can use the formal language of missing data mechanisms—like 'Missing At Random' (MAR)—to precisely understand what assumptions like exchangeability truly mean and why they are so critical for valid causal inference.", "problem": "An investigator analyzes an observational cohort to estimate the causal effect of a binary treatment $A \\in \\{0,1\\}$ on a scalar outcome $Y$. Let the potential outcomes be $Y(1)$ and $Y(0)$, and let the observed outcome satisfy the consistency part of the Stable Unit Treatment Value Assumption (SUTVA): $Y = Y(A)$. Let $X$ denote a vector of measured baseline covariates. The investigator assumes conditional exchangeability, that is, for each $a \\in \\{0,1\\}$, $Y(a) \\perp A \\mid X$, and also assumes positivity, that is, for each covariate value with positive density, $0 < \\Pr(A=1 \\mid X) < 1$.\n\nConsider the following missing-data framing of causal inference with potential outcomes: for each individual, one of the two potential outcomes is unobserved. Define observation indicators for the potential outcomes as follows: for each $a \\in \\{0,1\\}$, $R_a$ equals $1$ if $Y(a)$ is observed for that individual and $0$ otherwise.\n\nWhich option best describes how this setup can be framed as a missing data problem and correctly classifies the missingness mechanism for $Y(1)$ and $Y(0)$ under conditional exchangeability? Select the single best option.\n\nA. Define $R_a = \\mathbb{I}(A=a)$ so that $Y(a)$ is observed if and only if $A=a$. Under conditional exchangeability $Y(a) \\perp A \\mid X$, the missingness of $Y(a)$ is Missing At Random (MAR) given $X$, because the probability that $R_a=1$ given $(Y(a),X)$ does not depend on $Y(a)$. In a completely randomized trial with $A \\perp (X,Y(0),Y(1))$, the missingness is Missing Completely At Random (MCAR).\n\nB. Define $R_a = \\mathbb{I}(A=a)$ so that $Y(a)$ is observed if and only if $A=a$. Even under conditional exchangeability $Y(a) \\perp A \\mid X$, the missingness of $Y(a)$ is Missing Not At Random (MNAR) because the unobserved $Y(a)$ must influence treatment choice beyond $X$.\n\nC. Define $R_a = \\mathbb{I}(A=a)$ so that $Y(a)$ is observed if and only if $A=a$. In any observational study with positivity, the missingness of $Y(a)$ is Missing Completely At Random (MCAR), because positivity implies that treatment is randomly assigned.\n\nD. Define $R_a = \\mathbb{I}(Y=a)$ so that $Y(a)$ is observed when the realized outcome equals $a$. Under conditional exchangeability $Y(a) \\perp A \\mid X$, the missingness of $Y(a)$ is MAR without conditioning on $X$, because $A$ is independent of $Y(a)$ marginally.", "solution": "The problem has been validated and is a well-posed question grounded in established statistical theory. It correctly asks to connect the causal inference assumption of conditional exchangeability to the missing data mechanism of Missing At Random (MAR).\n\n**Formalization of the Missing Data Analogy**\nIn the potential outcomes framework, for each individual, the pair of potential outcomes $(Y(0), Y(1))$ constitutes the \"complete data\". However, we only observe one of these for each person. The observed outcome $Y$ is $Y(1)$ if treatment $A=1$ is received, and $Y(0)$ if $A=0$. Thus, $Y(0)$ is \"missing\" for those with $A=1$, and $Y(1)$ is \"missing\" for those with $A=0$.\n\nWe can define an indicator variable for observing the potential outcome $Y(a)$, denoted $R_a$. An individual's potential outcome $Y(a)$ is observed if and only if they received treatment $A=a$. Therefore, the observation indicator is correctly defined as $R_a = \\mathbb{I}(A=a)$, where $\\mathbb{I}(\\cdot)$ is the indicator function.\n\n**Classification of the Missingness Mechanism**\nThe type of missingness (MCAR, MAR, or MNAR) depends on the relationship between the probability of observation and the data values themselves. Let's analyze the probability of observing $Y(a)$, which is $\\Pr(R_a=1 | Y(0), Y(1), X)$, under the assumptions given.\n\n- **Missing At Random (MAR):** The probability of missingness is independent of the unobserved values, conditional on the observed values. For the potential outcome $Y(a)$, this means $\\Pr(R_a = 1 | Y(0), Y(1), X)$ does not depend on the value of $Y(a)$.\n- **Missing Completely At Random (MCAR):** The probability of missingness is independent of all data values, observed or unobserved. This means $\\Pr(R_a = 1 | Y(0), Y(1), X)$ is a constant.\n\n**Analysis under Conditional Exchangeability**\nThe problem states we assume conditional exchangeability, typically taken to mean joint conditional exchangeability $(Y(0), Y(1)) \\perp A \\mid X$. Using the definition $R_a = \\mathbb{I}(A=a)$, the probability of observing $Y(a)$ is:\n$$ \\Pr(R_a = 1 | Y(0), Y(1), X) = \\Pr(A=a | Y(0), Y(1), X) $$\nBy the assumption of conditional exchangeability, this simplifies to:\n$$ \\Pr(A=a | Y(0), Y(1), X) = \\Pr(A=a | X) $$\nThe probability of observing $Y(a)$ depends on the covariates $X$ (which are fully observed), but it does not depend on the values of the potential outcomes $Y(0)$ or $Y(1)$. This is the formal definition of Missing At Random (MAR), conditional on $X$.\n\n**Analysis under Unconditional Exchangeability (Randomized Trial)**\nIn a completely randomized trial, treatment assignment $A$ is independent of all pre-treatment variables: $(Y(0), Y(1), X) \\perp A$. In this special case:\n$$ \\Pr(R_a = 1 | Y(0), Y(1), X) = \\Pr(A=a | Y(0), Y(1), X) = \\Pr(A=a) $$\nThe probability of observation is constant and does not depend on any variables. This is the formal definition of Missing Completely At Random (MCAR).\n\n**Evaluation of Options**\n*   **A:** This option correctly defines $R_a = \\mathbb{I}(A=a)$, correctly classifies the mechanism as MAR given $X$ under conditional exchangeability, and correctly identifies the mechanism as MCAR in a randomized trial. The reasoning is sound and matches our derivation.\n*   **B:** This option is incorrect. It claims the mechanism is MNAR, which is what the assumption of conditional exchangeability is designed to rule out.\n*   **C:** This option is incorrect. It wrongly claims the mechanism is MCAR in any observational study and misunderstands positivity. Positivity does not imply randomization or MCAR.\n*   **D:** This option is incorrect. It provides a nonsensical definition for the observation indicator, $R_a = \\mathbb{I}(Y=a)$.\n\nTherefore, option A provides the best and most complete description.", "answer": "$$\\boxed{A}$$", "id": "4576125"}, {"introduction": "What happens when we cannot measure all the necessary confounders to ensure exchangeability? This common challenge calls for different identification strategies, one of the most powerful being the instrumental variable (IV) approach. This exercise [@problem_id:4576120] explores a scenario where a key assumption of IV analysis, the exclusion restriction, is violated. By quantifying the resulting bias, you will gain a deeper appreciation for how this method works and the critical importance of its underlying assumptions.", "problem": "A public health department evaluates the effect of receiving a seasonal influenza vaccination on a continuous symptom severity index. Let $Z \\in \\{0,1\\}$ denote random assignment of a mailed encouragement to vaccinate. Let $A \\in \\{0,1\\}$ denote whether an individual receives the vaccine. Let $Y$ denote the end-of-season symptom severity index (higher values are worse). For each individual $i$, define the potential treatment $A_i(z)$ and the potential outcome $Y_i(a,z)$, with the Stable Unit Treatment Value Assumption (SUTVA) holding. The department intends to use $Z$ as an Instrumental Variable (IV), but in this setting the exclusion restriction fails because the encouragement letter $Z$ also includes behavioral advice that directly reduces symptoms.\n\nAssume the following scientifically plausible and internally consistent data-generating scenario:\n- $Z$ is randomly assigned with $P(Z=1)=P(Z=0)=\\tfrac{1}{2}$ and is independent of all potential outcomes and potential treatments.\n- The encouragement increases vaccine uptake by a nonzero amount: $P(A=1 \\mid Z=1)=0.50$ and $P(A=1 \\mid Z=0)=0.30$. Denote $\\pi \\equiv E[A \\mid Z=1]-E[A \\mid Z=0]$, so here $\\pi=0.20$.\n- The causal effect of vaccination on the symptom severity index is constant across individuals and does not depend on $Z$: for all $i$ and all $z \\in \\{0,1\\}$, $Y_i(1,z)-Y_i(0,z)=\\beta$, with $\\beta=-0.8$.\n- The direct effect of the encouragement letter on the symptom severity index is constant across individuals and does not depend on $A$: for all $i$ and all $a \\in \\{0,1\\}$, $Y_i(a,1)-Y_i(a,0)=\\gamma$, with $\\gamma=-0.1$.\n- All error terms, if any, have mean zero and are independent of $Z$.\n\nAn analyst estimates the IV (Wald) estimand\n$$\n\\theta_{\\mathrm{IV}} \\equiv \\frac{E[Y \\mid Z=1]-E[Y \\mid Z=0]}{E[A \\mid Z=1]-E[A \\mid Z=0]}.\n$$\nUsing only the definitions of potential outcomes, SUTVA, randomization, and the law of iterated expectations, derive an expression for $\\theta_{\\mathrm{IV}}$ in terms of $\\beta$, $\\gamma$, and $\\pi$, and then compute the bias of the IV estimand relative to the true causal effect of $A$ on $Y$, defined as $\\theta_{\\mathrm{IV}} - \\beta$, under the scenario above. Express your final answer as a single real number. No rounding is required.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Instrumental Variable (IV): $Z \\in \\{0,1\\}$, a randomly assigned encouragement to vaccinate.\n-   Treatment: $A \\in \\{0,1\\}$, receipt of vaccine.\n-   Outcome: $Y$, a continuous symptom severity index.\n-   Potential Outcomes Framework: Potential treatment $A_i(z)$ and potential outcome $Y_i(a,z)$ for individual $i$.\n-   Assumption: The Stable Unit Treatment Value Assumption (SUTVA) holds.\n-   Violation of Exclusion Restriction: The instrument $Z$ has a direct effect on the outcome $Y$.\n-   Randomization of IV: $P(Z=1)=P(Z=0)=\\frac{1}{2}$, and $Z$ is independent of all potential outcomes and potential treatments.\n-   Effect of IV on Treatment: $P(A=1 \\mid Z=1)=0.50$ and $P(A=1 \\mid Z=0)=0.30$.\n-   First-stage effect size: $\\pi \\equiv E[A \\mid Z=1]-E[A \\mid Z=0] = 0.20$.\n-   Constant Causal Effect of Treatment: For all $i, z$, $Y_i(1,z)-Y_i(0,z)=\\beta$, with $\\beta=-0.8$.\n-   Constant Direct Effect of Instrument: For all $i, a$, $Y_i(a,1)-Y_i(a,0)=\\gamma$, with $\\gamma=-0.1$.\n-   Error Term properties: Any error terms have a mean of zero and are independent of $Z$.\n-   Estimand of interest: The IV (Wald) estimand, $\\theta_{\\mathrm{IV}} \\equiv \\frac{E[Y \\mid Z=1]-E[Y \\mid Z=0]}{E[A \\mid Z=1]-E[A \\mid Z=0]}$.\n-   Objective: Derive an expression for $\\theta_{\\mathrm{IV}}$ and compute the bias, $\\theta_{\\mathrm{IV}} - \\beta$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, operating within the standard potential outcomes framework for causal inference, a cornerstone of modern statistics and epidemiology. The concepts of an instrumental variable, SUTVA, the exclusion restriction, and the Wald estimand are well-defined and central to this field. The specified scenario of a failed exclusion restriction is a common and important practical problem. All assumptions are explicitly stated, and the data are internally consistent. The problem is well-posed, providing all necessary information for a unique solution. The language is objective and precise. The problem is therefore deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of the Bias\nThe objective is to compute the bias of the Instrumental Variable (IV) estimand, $\\theta_{\\mathrm{IV}} - \\beta$. We begin by deriving an expression for $\\theta_{\\mathrm{IV}}$. The IV estimand is defined as:\n$$\n\\theta_{\\mathrm{IV}} \\equiv \\frac{E[Y \\mid Z=1]-E[Y \\mid Z=0]}{E[A \\mid Z=1]-E[A \\mid Z=0]}\n$$\nThe denominator is given as $\\pi = E[A \\mid Z=1]-E[A \\mid Z=0]$, which is numerically $0.50 - 0.30 = 0.20$.\n\nWe must now analyze the numerator, $E[Y \\mid Z=1]-E[Y \\mid Z=0]$. The structure of the potential outcomes $Y_i(a,z)$ is defined by the constant additive effect assumptions. Let $Y_i(0,0)$ be the baseline potential outcome for individual $i$ when receiving no treatment ($a=0$) and no encouragement ($z=0$).\n\nThe constant causal effect of the treatment $A$ is given by $Y_i(1,z) - Y_i(0,z) = \\beta$. This can be written as $Y_i(a,z) = Y_i(0,z) + a\\beta$ for $a \\in \\{0,1\\}$.\n\nThe constant direct effect of the instrument $Z$ is given by $Y_i(a,1) - Y_i(a,0) = \\gamma$. This can be written as $Y_i(a,z) = Y_i(a,0) + z\\gamma$ for $z \\in \\{0,1\\}$.\n\nCombining these two assumptions, we can express any potential outcome in terms of the baseline $Y_i(0,0)$:\n$$\nY_i(a,z) = Y_i(a,0) + z\\gamma = (Y_i(0,0) + a\\beta) + z\\gamma = Y_i(0,0) + a\\beta + z\\gamma\n$$\nThis linear additive model for the potential outcomes is a direct consequence of the problem's assumptions.\n\nBy the consistency assumption, which is part of SUTVA, the observed outcome $Y_i$ for an individual with observed treatment $A_i$ and instrument status $Z_i$ is $Y_i = Y_i(A_i, Z_i)$. Substituting our derived model for the potential outcome, we get a model for the observed outcome:\n$$\nY_i = Y_i(0,0) + A_i\\beta + Z_i\\gamma\n$$\nNow, we can compute the conditional expectation of $Y$ given $Z=z$, using the law of iterated expectations and properties of expectation:\n$$\nE[Y \\mid Z=z] = E[Y(0,0) + A\\beta + Z\\gamma \\mid Z=z]\n$$\n$$\nE[Y \\mid Z=z] = E[Y(0,0) \\mid Z=z] + E[A\\beta \\mid Z=z] + E[Z\\gamma \\mid Z=z]\n$$\nBy linearity of expectation, this becomes:\n$$\nE[Y \\mid Z=z] = E[Y(0,0) \\mid Z=z] + \\beta E[A \\mid Z=z] + \\gamma E[Z \\mid Z=z]\n$$\nFrom the problem statement, $Z$ is randomly assigned and is independent of all potential outcomes. Therefore, $Z$ is independent of the baseline potential outcome $Y(0,0)$. This implies $E[Y(0,0) \\mid Z=z] = E[Y(0,0)]$. Let's denote $E[Y(0,0)]$ as $\\mu_0$. Also, when conditioning on $Z=z$, the value of $Z$ is fixed, so $E[Z \\mid Z=z] = z$.\nSubstituting these into the equation, we get:\n$$\nE[Y \\mid Z=z] = \\mu_0 + \\beta E[A \\mid Z=z] + z\\gamma\n$$\nUsing this general form, we can find the specific expectations for $Z=1$ and $Z=0$:\nFor $Z=1$:\n$$\nE[Y \\mid Z=1] = \\mu_0 + \\beta E[A \\mid Z=1] + (1)\\gamma\n$$\nFor $Z=0$:\n$$\nE[Y \\mid Z=0] = \\mu_0 + \\beta E[A \\mid Z=0] + (0)\\gamma = \\mu_0 + \\beta E[A \\mid Z=0]\n$$\nNow we compute the difference for the numerator of the IV estimand:\n$$\nE[Y \\mid Z=1] - E[Y \\mid Z=0] = (\\mu_0 + \\beta E[A \\mid Z=1] + \\gamma) - (\\mu_0 + \\beta E[A \\mid Z=0])\n$$\n$$\nE[Y \\mid Z=1] - E[Y \\mid Z=0] = \\beta (E[A \\mid Z=1] - E[A \\mid Z=0]) + \\gamma\n$$\nSubstituting this result and the definition of $\\pi$ into the formula for $\\theta_{\\mathrm{IV}}$:\n$$\n\\theta_{\\mathrm{IV}} = \\frac{\\beta (E[A \\mid Z=1] - E[A \\mid Z=0]) + \\gamma}{E[A \\mid Z=1] - E[A \\mid Z=0]} = \\frac{\\beta\\pi + \\gamma}{\\pi}\n$$\nThis can be simplified to:\n$$\n\\theta_{\\mathrm{IV}} = \\beta + \\frac{\\gamma}{\\pi}\n$$\nThis expression shows that the IV estimand is equal to the true causal effect $\\beta$ plus an additive bias term $\\frac{\\gamma}{\\pi}$. This bias arises from the violation of the exclusion restriction (i.e., $\\gamma \\neq 0$). If the exclusion restriction held, then $\\gamma=0$ and $\\theta_{\\mathrm{IV}}$ would be an unbiased estimator of $\\beta$.\n\nThe bias of the IV estimand is defined as $\\theta_{\\mathrm{IV}} - \\beta$. Based on our derived expression:\n$$\n\\text{Bias} = (\\beta + \\frac{\\gamma}{\\pi}) - \\beta = \\frac{\\gamma}{\\pi}\n$$\nFinally, we substitute the numerical values provided in the problem statement:\n-   The direct effect of the instrument: $\\gamma = -0.1$.\n-   The effect of the instrument on treatment uptake: $\\pi = 0.20$.\n\nThe bias is:\n$$\n\\text{Bias} = \\frac{-0.1}{0.20} = -0.5\n$$", "answer": "$$\n\\boxed{-0.5}\n$$", "id": "4576120"}]}