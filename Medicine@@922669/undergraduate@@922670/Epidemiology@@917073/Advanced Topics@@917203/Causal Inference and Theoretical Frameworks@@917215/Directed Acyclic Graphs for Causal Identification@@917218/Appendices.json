{"hands_on_practices": [{"introduction": "Understanding how information flows through a causal graph is the first step toward mastering causal inference. The rules of d-separation allow us to predict which variables will be statistically associated, given the underlying causal structure. This exercise provides focused practice on these fundamental rules, helping you build intuition for how conditioning on different variables can either block or open pathways of association between an exposure and an outcome. Mastering these mechanics is essential for correctly identifying confounders and avoiding common pitfalls like conditioning on mediators or colliders [@problem_id:4587645].", "problem": "Consider an epidemiologic setting with exposure $E$, mediator $M$, outcome $Y$, and a pre-exposure common cause $C$ of both $E$ and $Y$. Construct the Directed Acyclic Graph (DAG) with edges $E \\to M \\to Y$ and $E \\leftarrow C \\to Y$. Assume there are no other variables or edges and no selection or measurement processes.\n\nUsing the formal concept of $d$-separation, determine which paths between $E$ and $Y$ are open under each of the following conditioning sets: no variables (the empty set), $\\{C\\}$ alone, $\\{M\\}$ alone, and $\\{C,M\\}$. For each conditioning set, list all open paths qualitatively as part of your working, but for the final answer report only the number of open paths for each conditioning scenario.\n\nAnswer specification:\n- Provide the number of open paths as a four-entry row vector in the order: no variables, $\\{C\\}$, $\\{M\\}$, $\\{C,M\\}$.\n- The final answer must be a single row vector of integers. No rounding is required.", "solution": "The problem is valid as it is scientifically grounded in the principles of causal inference using Directed Acyclic Graphs (DAGs), is well-posed with a unique and verifiable solution, and is stated in objective, formal language.\n\nThe problem describes a system with four variables: exposure $E$, mediator $M$, outcome $Y$, and a common cause (confounder) $C$. The relationships are given as a set of directed edges: $C \\to E$, $C \\to Y$, $E \\to M$, and $M \\to Y$. The corresponding Directed Acyclic Graph (DAG) is therefore constructed with nodes $\\{E, M, Y, C\\}$ and edges representing these causal influences.\n\nThe task is to identify all paths between the exposure $E$ and the outcome $Y$ and to determine which of these paths are open or blocked under different conditioning sets, based on the rules of $d$-separation. A path is a sequence of edges connecting two variables, regardless of the direction of the arrows.\n\nFirst, we identify all paths between $E$ and $Y$ in the specified graph. There are two such paths:\n1.  Path 1: $E \\to M \\to Y$. This is a directed causal path from $E$ to $Y$ that is mediated by $M$.\n2.  Path 2: $E \\leftarrow C \\to Y$. This is a non-causal \"backdoor\" path from $E$ to $Y$ created by the common cause $C$.\n\nNext, we apply the rules of $d$-separation to determine the status of each path (open or blocked) for each given conditioning set $S$. A path is blocked by a set $S$ if it contains a non-collider that is in $S$, or if it contains a collider that is not in $S$ and has no descendants in $S$. Conversely, a path is open if it is not blocked.\n\n-   A node on a path is a \"chain\" if the arrows meet head-to-tail (e.g., $\\to Z \\to$). A chain is blocked by conditioning on the middle node $Z$.\n-   A node on a path is a \"fork\" if the arrows emanate from it (e.g., $\\leftarrow Z \\to$). A fork is blocked by conditioning on the middle node $Z$.\n-   A node on a path is a \"collider\" if the arrows meet head-to-head (e.g., $\\to Z \\leftarrow$). A collider blocks a path by default. Conditioning on the collider itself, or on a descendant of the collider, opens the path.\n\nIn our graph, Path 1 ($E \\to M \\to Y$) is a chain passing through $M$. Path 2 ($E \\leftarrow C \\to Y$) is a fork at $C$. There are no colliders on any path between $E$ and $Y$.\n\nWe now analyze the paths for each specified conditioning set:\n\n1.  **Conditioning set $S = \\emptyset$ (no variables)**\n    -   **Path 1 ($E \\to M \\to Y$):** This path is a chain through $M$. Since the middle node $M$ is not in the conditioning set $S = \\emptyset$, the path is **open**.\n    -   **Path 2 ($E \\leftarrow C \\to Y$):** This path is a fork at $C$. Since the fork node $C$ is not in the conditioning set $S = \\emptyset$, the path is **open**.\n    -   **Total open paths:** $2$. The open paths are $E \\to M \\to Y$ and $E \\leftarrow C \\to Y$.\n\n2.  **Conditioning set $S = \\{C\\}$**\n    -   **Path 1 ($E \\to M \\to Y$):** This path is a chain through $M$. The middle node $M$ is not in the conditioning set $S = \\{C\\}$. Therefore, this path remains **open**.\n    -   **Path 2 ($E \\leftarrow C \\to Y$):** This path is a fork at $C$. The fork node $C$ is in the conditioning set $S = \\{C\\}$. Therefore, this path is **blocked**.\n    -   **Total open paths:** $1$. The only open path is $E \\to M \\to Y$.\n\n3.  **Conditioning set $S = \\{M\\}$**\n    -   **Path 1 ($E \\to M \\to Y$):** This path is a chain through $M$. The middle node $M$ is in the conditioning set $S = \\{M\\}$. Therefore, this path is **blocked**.\n    -   **Path 2 ($E \\leftarrow C \\to Y$):** This path is a fork at $C$. The fork node $C$ is not in the conditioning set $S = \\{M\\}$. Therefore, this path remains **open**.\n    -   **Total open paths:** $1$. The only open path is $E \\leftarrow C \\to Y$.\n\n4.  **Conditioning set $S = \\{C, M\\}$**\n    -   **Path 1 ($E \\to M \\to Y$):** This path is a chain through $M$. The middle node $M$ is in the conditioning set $S = \\{C, M\\}$. Therefore, this path is **blocked**.\n    -   **Path 2 ($E \\leftarrow C \\to Y$):** This path is a fork at $C$. The fork node $C$ is in the conditioning set $S = \\{C, M\\}$. Therefore, this path is **blocked**.\n    -   **Total open paths:** $0$. Both paths are blocked.\n\nIn summary, the number of open paths between $E$ and $Y$ for the conditioning sets $\\emptyset$, $\\{C\\}$, $\\{M\\}$, and $\\{C,M\\}$ are $2$, $1$, $1$, and $0$, respectively. The problem asks for these counts as a four-entry row vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 1 & 1 & 0\n\\end{pmatrix}\n}\n$$", "id": "4587645"}, {"introduction": "Once we have used a Directed Acyclic Graph (DAG) to identify a valid adjustment set, the next step is to use observational data to estimate the causal effect. The backdoor adjustment formula, often called standardization or the g-formula, provides the mathematical tool to do this. This practice problem translates theory into a concrete calculation, showing how adjusting for a confounder allows us to estimate the causal effect of an exposure on an outcome [@problem_id:4587606].", "problem": "Consider a study of an infectious disease where the binary exposure $E$ indicates receipt of a prophylactic intervention ($E=1$ if received, $E=0$ if not), the binary outcome $Y$ indicates incident infection within $30$ days ($Y=1$ if infected, $Y=0$ otherwise), and the binary covariate $Z$ indicates baseline high comorbidity burden ($Z=1$ for high burden, $Z=0$ for low burden). The causal structure is represented by a Directed Acyclic Graph (DAG) in which $Z$ has arrows to both $E$ and $Y$, and $E$ has an arrow to $Y$. Assume there are no other common causes of $E$ and $Y$, all variables are measured without error, and the following conditions hold: conditional exchangeability given $Z$, consistency, and positivity.\n\nThe study estimates the following quantities:\n- $p(Z=1)=0.4$ and $p(Z=0)=0.6$.\n- $p(Y=1\\mid E=1,Z=0)=0.25$ and $p(Y=1\\mid E=1,Z=1)=0.60$.\n- $p(Y=1\\mid E=0,Z=0)=0.10$ and $p(Y=1\\mid E=0,Z=1)=0.50$.\n\nUsing $Z$ as a valid backdoor adjustment set for identifying the causal effect of $E$ on $Y$ under the DAG described, compute the backdoor-adjusted causal risk difference $E[Y\\mid \\operatorname{do}(E=1)]-E[Y\\mid \\operatorname{do}(E=0)]$. Express your final answer as a decimal (no percentage sign). Provide the exact value; no rounding is required.", "solution": "The problem asks for the computation of the backdoor-adjusted causal risk difference, which is defined as $E[Y\\mid \\operatorname{do}(E=1)] - E[Y\\mid \\operatorname{do}(E=0)]$. The problem is validated as sound, well-posed, and containing all necessary information.\n\nThe causal structure is described by a Directed Acyclic Graph (DAG) where a covariate $Z$ is a common cause of the exposure $E$ and the outcome $Y$. Specifically, the causal paths are $Z \\to E$, $Z \\to Y$, and $E \\to Y$. The path $E \\leftarrow Z \\rightarrow Y$ is a \"backdoor path\" because it is a non-causal path between $E$ and $Y$ that begins with an arrow pointing into $E$. To estimate the causal effect of $E$ on $Y$, this backdoor path must be blocked. The problem states that $Z$ is a valid backdoor adjustment set. This is consistent with the backdoor criterion, as $Z$ is not a descendant of $E$ and conditioning on $Z$ blocks the path $E \\leftarrow Z \\rightarrow Y$.\n\nThe assumptions of conditional exchangeability, consistency, and positivity, along with the specified DAG, allow for the identification of the causal effect from the provided observational data. We can use the backdoor adjustment formula (also known as standardization or g-formula) to calculate the potential outcome means, $E[Y \\mid \\operatorname{do}(E=e)]$. For a binary outcome $Y$, this is equivalent to the probability of the outcome under intervention, $p(Y=1 \\mid \\operatorname{do}(E=e))$.\n\nThe formula is given by:\n$$p(Y=1 \\mid \\operatorname{do}(E=e)) = \\sum_z p(Y=1 \\mid E=e, Z=z) \\cdot p(Z=z)$$\n\nFirst, let's calculate the risk of infection if everyone in the population received the prophylactic intervention, $p(Y=1 \\mid \\operatorname{do}(E=1))$. The sum is over the strata of the confounder $Z$, which are $Z=0$ and $Z=1$.\n$$p(Y=1 \\mid \\operatorname{do}(E=1)) = p(Y=1 \\mid E=1, Z=0) \\cdot p(Z=0) + p(Y=1 \\mid E=1, Z=1) \\cdot p(Z=1)$$\nThe problem provides the following values:\n- $p(Y=1\\mid E=1,Z=0) = 0.25$\n- $p(Y=1\\mid E=1,Z=1) = 0.60$\n- $p(Z=0) = 0.6$\n- $p(Z=1) = 0.4$\n\nSubstituting these values into the formula:\n$$p(Y=1 \\mid \\operatorname{do}(E=1)) = (0.25)(0.6) + (0.60)(0.4)$$\n$$p(Y=1 \\mid \\operatorname{do}(E=1)) = 0.15 + 0.24$$\n$$p(Y=1 \\mid \\operatorname{do}(E=1)) = 0.39$$\n\nNext, we calculate the risk of infection if no one in the population received the intervention, $p(Y=1 \\mid \\operatorname{do}(E=0))$.\n$$p(Y=1 \\mid \\operatorname{do}(E=0)) = p(Y=1 \\mid E=0, Z=0) \\cdot p(Z=0) + p(Y=1 \\mid E=0, Z=1) \\cdot p(Z=1)$$\nThe problem provides:\n- $p(Y=1\\mid E=0,Z=0) = 0.10$\n- $p(Y=1\\mid E=0,Z=1) = 0.50$\n- $p(Z=0) = 0.6$\n- $p(Z=1) = 0.4$\n\nSubstituting these values:\n$$p(Y=1 \\mid \\operatorname{do}(E=0)) = (0.10)(0.6) + (0.50)(0.4)$$\n$$p(Y=1 \\mid \\operatorname{do}(E=0)) = 0.06 + 0.20$$\n$$p(Y=1 \\mid \\operatorname{do}(E=0)) = 0.26$$\n\nFinally, the causal risk difference is the difference between these two quantities.\n$$E[Y\\mid \\operatorname{do}(E=1)] - E[Y\\mid \\operatorname{do}(E=0)] = p(Y=1 \\mid \\operatorname{do}(E=1)) - p(Y=1 \\mid \\operatorname{do}(E=0))$$\n$$= 0.39 - 0.26$$\n$$= 0.13$$\n\nThis result represents the estimated decrease in the risk of infection attributable to the prophylactic intervention in the total population, after accounting for confounding by comorbidity burden $Z$.", "answer": "$$\\boxed{0.13}$$", "id": "4587606"}, {"introduction": "In real-world research, we often don't know the true causal graph beforehand. Instead, we use a combination of subject-matter knowledge and observed statistical dependencies to propose a plausible DAG. This advanced exercise challenges you to act as a causal detective, deducing the roles of different variables—including a confounder and a source of selection bias—from a set of observed relationships and specifying the correct analytical approach for causal estimation [@problem_id:4587672].", "problem": "In an observational epidemiologic study of respiratory health, let $E$ denote a binary exposure to ambient fine particulate matter, $Y$ a binary respiratory outcome within $1$ year, $C$ a binary pre-exposure baseline health status indicator measured at enrollment, and $S$ a binary indicator of inclusion in the analytic dataset (with $S=1$ if included). Assume the following about the data generating mechanism in the source population: there are no other measured variables besides $E$, $Y$, $C$, and $S$, there are no unmeasured common causes of $(E,Y)$ beyond $C$, and the joint distribution is compatible with a Directed Acyclic Graph (DAG) model.\n\nSuppose the following empirical conditional independence and dependence relations are observed in the source population:\n- $S \\perp\\!\\!\\!\\perp C \\mid E, Y$,\n- $S \\not\\!\\perp\\!\\!\\!\\perp E$ and $S \\not\\!\\perp\\!\\!\\!\\perp Y$,\n- $E \\not\\!\\perp\\!\\!\\!\\perp C$ and $Y \\not\\!\\perp\\!\\!\\!\\perp C$,\n- $E \\not\\!\\perp\\!\\!\\!\\perp Y$.\n\nUsing only the fundamental definitions of Directed Acyclic Graphs (DAGs), d-separation, backdoor paths, and the interventional do-operator, do the following:\n1. From the given observed conditional independences, infer the qualitative roles of $C$ and $S$ (e.g., confounder versus collider or descendant) and identify all backdoor paths from $E$ to $Y$ that can be open in the source population when no variables are conditioned on.\n2. Specify a minimal set of nodes to condition on that blocks each identified backdoor path without inducing new spurious associations.\n3. Finally, express the interventional probability $\\Pr(Y=1 \\mid \\operatorname{do}(E=1))$ in the source population as a closed-form analytic expression in terms of the observational joint distribution over $(E, Y, C)$ only. Treat $E$, $Y$, and $C$ as binary and write your expression explicitly as a finite sum over the support of $C$. Your final answer must be a single analytic expression. No numerical rounding is required, and no units apply.", "solution": "The problem as stated is a well-posed question in causal inference, grounded in the established theoretical framework of Directed Acyclic Graphs (DAGs) as developed by Judea Pearl and others. It is self-contained, its premises are internally consistent, and it possesses a unique, meaningful solution derivable from its givens. All terms are standard in the field of epidemiology and causal inference. Therefore, the problem is valid.\n\nThe solution proceeds in three parts as requested: first, inferring the causal structure and identifying backdoor paths; second, determining the appropriate adjustment set; and third, deriving the expression for the interventional probability.\n\n### Part 1: Causal Structure and Backdoor Paths\n\nWe are given four binary variables: exposure $E$, outcome $Y$, pre-exposure measure $C$, and selection indicator $S$. The joint distribution is assumed to be compatible with a DAG.\n\n**1. The Role of $C$ (Confounder):**\nThe problem states that there are \"no unmeasured common causes of $(E,Y)$ beyond $C$\". This is the assumption of conditional exchangeability, also known as no unmeasured confounding, given $C$. The observed dependencies $E \\not\\!\\perp\\!\\!\\!\\perp C$ and $Y \\not\\!\\perp\\!\\!\\!\\perp C$ indicate that $C$ is associated with both the exposure and the outcome. Since $C$ is a \"pre-exposure\" measure, it cannot be caused by $E$. Given these facts, $C$ must be a common cause of $E$ and $Y$. This is represented by the directed edges $C \\rightarrow E$ and $C \\rightarrow Y$. A variable that is a common cause of exposure and outcome is a **confounder**. The path $E \\leftarrow C \\rightarrow Y$ is a non-causal path that contributes to the observed association between $E$ and $Y$.\n\n**2. The Causal Path:**\nWe are asked to find the interventional probability $\\Pr(Y=1 \\mid \\operatorname{do}(E=1))$, which quantifies the causal effect of $E$ on $Y$. This presupposes the existence of a direct or indirect causal path from $E$ to $Y$. The simplest such path is a direct edge $E \\rightarrow Y$. This edge, in combination with the confounding path through $C$, explains the observed association $E \\not\\!\\perp\\!\\!\\!\\perp Y$.\n\n**3. The Role of $S$ (Collider):**\nThe variable $S$ represents inclusion in an analytic dataset. Such variables are typically consequences of other variables in the system, a process known as selection. We are given that $S$ is marginally dependent on both $E$ and $Y$ ($S \\not\\!\\perp\\!\\!\\!\\perp E$ and $S \\not\\!\\perp\\!\\!\\!\\perp Y$). This is most directly represented by directed edges from $E$ and $Y$ to $S$, i.e., $E \\rightarrow S$ and $Y \\rightarrow S$. In this configuration, $S$ is a common effect of $E$ and $Y$. A node that is a common effect of two other nodes on a path is a **collider**. The path $E \\rightarrow S \\leftarrow Y$ is a path where two arrows \"collide\" at $S$.\n\n**4. Verifying the DAG Structure:**\nThe proposed DAG structure is: $E \\leftarrow C \\rightarrow Y$, $E \\rightarrow Y$, and $E \\rightarrow S \\leftarrow Y$. Let us verify the given conditional independence $S \\perp\\!\\!\\!\\perp C \\mid E, Y$ using the graphical criterion of d-separation. We must check all paths between $S$ and $C$ to see if they are blocked by the set $\\{E, Y\\}$.\n- Path 1: $S \\leftarrow E \\leftarrow C$. This path is a chain. Conditioning on a node in a chain blocks the path. Since we are conditioning on $E$, this path is blocked.\n- Path 2: $S \\leftarrow Y \\leftarrow C$. This path is also a chain. Conditioning on $Y$ blocks this path.\nSince all paths between $S$ and $C$ are blocked by the set $\\{E, Y\\}$, the condition $S \\perp\\!\\!\\!\\perp C \\mid \\{E, Y\\}$ holds in this DAG. The proposed structure is therefore consistent with all provided information.\n\n**5. Identifying Backdoor Paths:**\nA backdoor path from $E$ to $Y$ is a path that begins with an arrow pointing into $E$. Based on our inferred DAG, the only path from $E$ to $Y$ that starts with an incoming arrow at $E$ is the path **$E \\leftarrow C \\rightarrow Y$**. This is the sole backdoor path. This path is open by default because $C$ is not a collider.\n\n### Part 2: Minimal Adjustment Set\n\nTo estimate the causal effect of $E$ on $Y$, we must block all open backdoor paths from $E$ to $Y$ without opening new ones. This is achieved by conditioning on a set of variables that satisfies the backdoor criterion.\n\n- The only backdoor path is $E \\leftarrow C \\rightarrow Y$.\n- To block this path, we must condition on a node on the path (other than the endpoints). The only such node is $C$.\n- The set $\\{C\\}$ is therefore a candidate for an adjustment set.\n- According to the backdoor criterion, conditioning on the chosen set must not open any new spurious paths. Conditioning on a non-collider, such as $C$, does not open any paths. The set $\\{C\\}$ does not contain any colliders or descendants of colliders.\n- Therefore, the set $\\{C\\}$ is a valid adjustment set.\n- Since it contains only one variable, which is necessary to block the single backdoor path, $\\{C\\}$ is a **minimal adjustment set**.\n- Note that we must not condition on $S$. Since $S$ is a collider on the path $E \\rightarrow S \\leftarrow Y$, conditioning on $S$ would open this path and induce a spurious association between $E$ and $Y$, a form of selection bias. The problem correctly asks for the effect in the source population, which means we must not condition on $S$.\n\n### Part 3: Expression for the Interventional Probability\n\nHaving identified a valid adjustment set $\\{C\\}$, we can use the backdoor adjustment formula (also known as the g-formula or standardization) to express the interventional probability $\\Pr(Y=y \\mid \\operatorname{do}(E=e))$ in terms of the observational distribution.\n\nThe formula is:\n$$ \\Pr(Y=y \\mid \\operatorname{do}(E=e)) = \\sum_c \\Pr(Y=y \\mid E=e, C=c) \\Pr(C=c) $$\nwhere the sum is over all possible values of the variables in the adjustment set, in this case, $C$.\n\nWe are asked for the specific interventional probability $\\Pr(Y=1 \\mid \\operatorname{do}(E=1))$. Since $C$ is a binary variable, its support is $\\{0, 1\\}$. Substituting these values into the general formula, we get the expression as a finite sum over the support of $C$:\n$$ \\Pr(Y=1 \\mid \\operatorname{do}(E=1)) = \\sum_{c \\in \\{0, 1\\}} \\Pr(Y=1 \\mid E=1, C=c) \\Pr(C=c) $$\nExpanding this sum explicitly gives:\n$$ \\Pr(Y=1 \\mid \\operatorname{do}(E=1)) = \\Pr(Y=1 \\mid E=1, C=0) \\Pr(C=0) + \\Pr(Y=1 \\mid E=1, C=1) \\Pr(C=1) $$\nThis expression represents the weighted average of the stratum-specific probabilities of the outcome, where the weights are the prevalence of each stratum of the confounder $C$ in the source population. Each term, such as $\\Pr(Y=1 \\mid E=1, C=0)$ and $\\Pr(C=0)$, can be estimated from the observational joint distribution $\\Pr(E, Y, C)$, thus satisfying all conditions of the problem.", "answer": "$$\\boxed{\\Pr(Y=1 \\mid E=1, C=0) \\Pr(C=0) + \\Pr(Y=1 \\mid E=1, C=1) \\Pr(C=1)}$$", "id": "4587672"}]}