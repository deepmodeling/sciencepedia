{"hands_on_practices": [{"introduction": "Understanding disease transmission begins with a clear grasp of the key time periods within an infected host. This first exercise challenges you to apply the definitions of the latent, incubation, and infectious periods to a concrete, hypothetical scenario. By mapping out the timeline of infection, you will practice identifying the critical window for pre-symptomatic transmission, a foundational skill for assessing the potential for a pathogen to spread silently. [@problem_id:4600639]", "problem": "Consider a single host infected at time $0$ with a pathogen. The latent period is the time from infection to the onset of infectiousness, the incubation period is the time from infection to the onset of symptoms, and the infectious period is the interval during which the host can transmit the pathogen. Suppose the pathogen has a latent period of $2$ days and an incubation period of $5$ days. The infectious period lasts for $7$ days and begins at the end of the latent period. Using only these definitions and the provided parameters, determine whether pre-symptomatic transmission occurs, identify the time window during which it occurs relative to infection, and calculate the total duration of pre-symptomatic transmission. Express your final numerical answer for the duration in days. Provide the exact value; no rounding is required.", "solution": "Let $t$ represent the time in days, with $t=0$ corresponding to the moment of infection. We are given the following definitions and parameters from the problem statement.\n\nThe latent period is the time from infection to the onset of infectiousness. Let its duration be $T_L$. The problem states its duration is $2$ days, so $T_L = 2$. This implies that the host becomes infectious at time $t = T_L = 2$.\n\nThe incubation period is the time from infection to the onset of symptoms. Let its duration be $T_{inc}$. The problem states its duration is $5$ days, so $T_{inc} = 5$. This implies that the host begins to show symptoms at time $t = T_{inc} = 5$.\n\nThe infectious period is the interval during which the host can transmit the pathogen. Let its duration be $D_{inf}$. The problem states $D_{inf} = 7$ days. It begins at the end of the latent period, i.e., at time $t_{\\text{inf,start}} = T_L = 2$. The infectious period ends at time $t_{\\text{inf,end}} = t_{\\text{inf,start}} + D_{inf} = 2 + 7 = 9$. The time interval during which the host is infectious is therefore $I_{inf} = [2, 9]$.\n\nThe problem requires us to determine if pre-symptomatic transmission occurs, to identify its time window, and to calculate its total duration.\n\nPre-symptomatic transmission is defined as pathogen transmission by a host before the onset of symptoms. This requires the host to be simultaneously infectious and pre-symptomatic.\n\nThe pre-symptomatic period is the time interval from infection until the onset of symptoms. Based on the definition of the incubation period, the host is pre-symptomatic during the time interval $I_{pre-symp} = [0, t_{\\text{symp,start}}) = [0, T_{inc}) = [0, 5)$.\n\nTo determine if pre-symptomatic transmission occurs, we must check if the infectious period begins before the symptomatic period begins. The onset of infectiousness is at $t = T_L = 2$. The onset of symptoms is at $t = T_{inc} = 5$. Since $T_L  T_{inc}$, specifically $2  5$, the host becomes infectious before they become symptomatic. Therefore, a period of pre-symptomatic transmission exists.\n\nThe time window for pre-symptomatic transmission is the interval during which the host is both infectious and pre-symptomatic. This is the intersection of the infectious interval, $I_{inf}$, and the pre-symptomatic interval, $I_{pre-symp}$.\n$$\n\\text{Window for pre-symptomatic transmission} = I_{inf} \\cap I_{pre-symp} = [2, 9] \\cap [0, 5)\n$$\nThe intersection of these two sets is the interval $[2, 5)$. This is the time window, relative to the infection at $t=0$, during which pre-symptomatic transmission occurs. It starts at $t=2$ days and ends at $t=5$ days.\n\nThe total duration of pre-symptomatic transmission is the length of this time window. The length of an interval $[a, b)$ is calculated as $b - a$.\n$$\n\\text{Duration} = 5 - 2 = 3\n$$\nThe total duration of pre-symptomatic transmission is $3$ days. In general terms, this duration is given by the formula $T_{inc} - T_L$, provided that $T_L  T_{inc}$.", "answer": "$$\n\\boxed{3}\n$$", "id": "4600639"}, {"introduction": "While core transmission parameters like the generation interval are difficult to measure directly, epidemiologists often rely on observable data like the serial interval—the time between symptom onsets in an infector and infectee. This exercise guides you through the mathematical derivation connecting these concepts. It culminates in exploring the intriguing phenomenon of a negative mean serial interval, which provides powerful, real-world evidence for the extent of pre-symptomatic transmission in an outbreak. [@problem_id:4600665]", "problem": "Consider a directly transmitted respiratory pathogen in a well-mixed population. Let the incubation period $I$ be defined as the time from infection to symptom onset, the latent period $L$ as the time from infection to the onset of infectiousness, and the generation interval $G$ as the time from the infector’s infection to the infectee’s infection. The observed serial interval $S$ is defined as the time between the symptom onset of the infectee and the symptom onset of the infector in an identified transmission pair. For a transmission pair, denote the incubation period of the infector by $I_{1}$ and of the infectee by $I_{2}$. Assume that $I_{1}$, $I_{2}$, and $G$ are random variables with finite expectations $\\mu_{1} = \\mathbb{E}[I_{1}]$, $\\mu_{2} = \\mathbb{E}[I_{2}]$, and $\\mu_{G} = \\mathbb{E}[G]$. You may assume that the linearity of expectation holds and that all quantities are well-defined in the sense of standard renewal-type transmission models in epidemiology.\n\nStarting from the core definitions above and first principles, derive the form of the mean observed serial interval $\\mathbb{E}[S]$ in terms of $\\mu_{1}$, $\\mu_{2}$, and $\\mu_{G}$. Then, construct a single analytic expression $C(\\mu_{1},\\mu_{2},\\mu_{G})$ whose sign determines whether the mean observed serial interval is negative, in the sense that $\\mathbb{E}[S]  0$ if and only if $C(\\mu_{1},\\mu_{2},\\mu_{G})  0$. Provide $C(\\mu_{1},\\mu_{2},\\mu_{G})$ in simplest form. No numerical evaluation is required. In your reasoning, explain epidemiologically what a negative mean observed serial interval implies about the relationships among incubation, latent, and infectious periods, and why such a phenomenon can arise in a realistic setting. The final answer must be the single closed-form analytic expression $C(\\mu_{1},\\mu_{2},\\mu_{G})$ only, with no units.", "solution": "The problem requires the derivation of the mean observed serial interval $\\mathbb{E}[S]$ and the construction of an analytic expression $C$ that determines if $\\mathbb{E}[S]$ is negative. The provided definitions are standard in mathematical epidemiology and form a valid basis for a formal derivation.\n\nFirst, we must establish the mathematical relationship between the serial interval $S$, the generation interval $G$, and the incubation periods of the infector ($I_1$) and infectee ($I_2$). Let us define a timeline based on the infection events. Let time $t=0$ be the moment the infector is infected.\n\nAccording to the definitions:\n1.  The infector develops symptoms at time $t_{s,1} = I_1$. This is the time elapsed from the infector's own infection to their symptom onset.\n2.  The infector transmits the pathogen to the infectee at time $t_{i,2} = G$. This is the generation interval, defined as the time from the infector's infection to the infectee's infection.\n3.  The infectee, having been infected at time $t_{i,2}$, develops symptoms after a duration equal to their incubation period, $I_2$. Therefore, the absolute time of the infectee's symptom onset is $t_{s,2} = t_{i,2} + I_2 = G + I_2$.\n\nThe observed serial interval, $S$, is defined as the time between the symptom onset of the infectee and the symptom onset of the infector. Mathematically, this is the difference between their respective symptom onset times:\n$$S = t_{s,2} - t_{s,1}$$\nSubstituting the expressions derived from our timeline, we get:\n$$S = (G + I_2) - I_1$$\nThis equation provides the fundamental relationship between the random variables $S$, $G$, $I_1$, and $I_2$ for a single transmission pair.\n\nNext, we are asked to find the mean observed serial interval, $\\mathbb{E}[S]$. We take the expectation of the derived equation for $S$. The problem statement explicitly allows for the use of the linearity of expectation.\n$$\\mathbb{E}[S] = \\mathbb{E}[G + I_2 - I_1]$$\nApplying the linearity property, which states that the expectation of a sum of random variables is the sum of their expectations, we have:\n$$\\mathbb{E}[S] = \\mathbb{E}[G] + \\mathbb{E}[I_2] - \\mathbb{E}[I_1]$$\nThe problem defines the means of $I_1$, $I_2$, and $G$ as $\\mu_1 = \\mathbb{E}[I_1]$, $\\mu_2 = \\mathbb{E}[I_2]$, and $\\mu_G = \\mathbb{E}[G]$, respectively. Substituting these definitions yields the expression for the mean serial interval:\n$$\\mathbb{E}[S] = \\mu_G + \\mu_2 - \\mu_1$$\n\nThe epidemiological significance of a negative mean serial interval, $\\mathbb{E}[S]  0$, is profound. This condition implies that, on average, an infectee develops symptoms *before* the infector who transmitted the pathogen to them. This phenomenon is a hallmark of significant pre-symptomatic transmission. For transmission to occur, the infector must be infectious. The period from infection to infectiousness is the latent period, $L$. If transmission occurs at time $G$ (the generation interval), then it must be that $G \\ge L$. If this transmission occurs before the infector's symptom onset (at time $I_1$), then $G  I_1$. This requires that the latent period is shorter than the incubation period ($L  I_1$), allowing for a window of pre-symptomatic infectiousness. If transmission consistently occurs during this window (i.e., the mean generation time $\\mu_G$ is less than the mean incubation period of the infector $\\mu_1$), and if the infectee's incubation period $\\mu_2$ is not unusually long, it becomes possible for the average time of the infectee's symptom onset, $\\mu_G + \\mu_2$, to be less than the average time of the infector's symptom onset, $\\mu_1$. Therefore, observation of a negative mean serial interval in a population is strong evidence that pre-symptomatic transmission is a primary driver of the epidemic.\n\nFinally, we are tasked with constructing a single analytic expression $C(\\mu_1, \\mu_2, \\mu_G)$ such that $\\mathbb{E}[S]  0$ if and only if $C(\\mu_1, \\mu_2, \\mu_G)  0$.\nThe condition for a negative mean serial interval is:\n$$\\mathbb{E}[S]  0$$\n$$\\mu_G + \\mu_2 - \\mu_1  0$$\nTo find an expression $C$ that is positive under this condition, we can multiply the inequality by $-1$. This operation reverses the direction of the inequality sign:\n$$-(\\mu_G + \\mu_2 - \\mu_1)  0$$\n$$-\\mu_G - \\mu_2 + \\mu_1  0$$\nRearranging the terms, we get:\n$$\\mu_1 - \\mu_2 - \\mu_G  0$$\nThis inequality holds if and only if $\\mathbb{E}[S]  0$. We can therefore define the function $C$ as the left-hand side of this inequality.\n$$C(\\mu_1, \\mu_2, \\mu_G) = \\mu_1 - \\mu_2 - \\mu_G$$\nThis expression satisfies the required condition. It is in its simplest form as it is a linear combination of the given mean values.", "answer": "$$\\boxed{\\mu_{1} - \\mu_{2} - \\mu_{G}}$$", "id": "4600665"}, {"introduction": "The true duration of an incubation period is not a single number but varies across a population, following a statistical distribution. This final practice moves from theory to application, simulating the work of an epidemiologist by using observed data to inform policy. You will fit different distributions to incubation period data, select the best model, and use it to determine an appropriate quarantine duration, demonstrating how understanding the full shape of a distribution—especially its tail—is critical for designing effective public health interventions. [@problem_id:4600638]", "problem": "You are given three independent datasets of incubation times measured in days, assumed to be positive and continuous. For each dataset, you must fit two candidate distributions, the Gamma distribution and the Lognormal distribution, under a two-parameter specification with no location parameter. You must then compare the fits using the Akaike Information Criterion (AIC) and use the better-fitting model to quantify tail behavior relevant to quarantine design.\n\nBase definitions and assumptions:\n- The Gamma distribution with shape parameter $\\alpha$ and scale parameter $\\theta$ has probability density function $f(t \\mid \\alpha,\\theta) = \\dfrac{t^{\\alpha - 1} e^{-t/\\theta}}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}}$ for $t  0$, where $\\Gamma(\\cdot)$ is the Gamma function. Parameters satisfy $\\alpha  0$ and $\\theta  0$.\n- The Lognormal distribution with log-mean $\\mu$ and log-standard deviation $\\sigma$ has probability density function $f(t \\mid \\mu,\\sigma) = \\dfrac{1}{t\\,\\sigma\\,\\sqrt{2\\pi}} \\exp\\!\\left( -\\dfrac{(\\ln t - \\mu)^2}{2\\sigma^2} \\right)$ for $t  0$, with $\\sigma  0$.\n- Maximum likelihood estimation (MLE) is to be used to estimate parameters for each model by maximizing the log-likelihood $\\ell(\\boldsymbol{\\theta} \\mid \\{t_i\\}) = \\sum_{i=1}^{n} \\log f(t_i \\mid \\boldsymbol{\\theta})$ over the admissible parameter space.\n- Use the two-parameter forms only (that is, fix the location parameter to $0$ for both distributions). The number of free parameters for each model is $k = 2$.\n- The Akaike Information Criterion (AIC) is defined as $\\mathrm{AIC} = 2k - 2\\ell(\\widehat{\\boldsymbol{\\theta}})$, where $\\ell(\\widehat{\\boldsymbol{\\theta}})$ is the maximized log-likelihood and $k$ is the number of free parameters.\n- The survival function is $S(q) = \\mathbb{P}(T  q) = 1 - F(q)$, where $F$ is the cumulative distribution function. The $(1 - r)$ quantile satisfies $F(q^\\star) = 1 - r$, equivalently $S(q^\\star) = r$.\n\nTasks for each dataset:\n1. Estimate the Gamma and Lognormal parameters by maximum likelihood under the constraints above, compute their maximized log-likelihoods, and then compute their AIC values.\n2. Select the better model as the one with the smaller AIC.\n3. Using the better model, compute the tail probability $S(Q) = \\mathbb{P}(T  Q)$ at the specified quarantine duration $Q$ (in days).\n4. Using the better model, compute the minimum quarantine duration (in days) required so that the tail probability is less than or equal to the specified risk tolerance $r$; that is, compute $q^\\star$ such that $F(q^\\star) = 1 - r$. Express all times in days.\n5. Report, for each dataset, the following list in order:\n   - An integer model identifier where Gamma is coded as $0$ and Lognormal is coded as $1$.\n   - The Gamma AIC as a real number.\n   - The Lognormal AIC as a real number.\n   - The tail probability $S(Q)$ under the selected model as a real number.\n   - The required quarantine duration $q^\\star$ under the selected model as a real number.\nAll real numbers must be rounded to exactly $6$ decimal places. All times are in days. The risk tolerance $r$ must be treated as a decimal, not a percentage.\n\nDatasets and associated quarantine evaluation parameters (test suite):\n- Dataset $\\mathcal{D}_1$ (moderate sample, moderately right-skewed): $\\{\\,2.0,\\,3.5,\\,4.2,\\,5.1,\\,6.3,\\,3.8,\\,4.9,\\,2.7,\\,5.6,\\,4.1,\\,3.2,\\,6.8,\\,5.0,\\,4.4,\\,3.9\\,\\}$ with quarantine duration $Q_1 = 7.0$ and risk tolerance $r_1 = 0.05$.\n- Dataset $\\mathcal{D}_2$ (smaller sample with a heavier right tail): $\\{\\,1.2,\\,2.5,\\,3.1,\\,4.7,\\,2.9,\\,5.3,\\,9.5,\\,11.2,\\,14.8,\\,3.6,\\,4.1\\,\\}$ with quarantine duration $Q_2 = 10.0$ and risk tolerance $r_2 = 0.01$.\n- Dataset $\\mathcal{D}_3$ (very small sample, low variance): $\\{\\,3.0,\\,3.2,\\,3.4,\\,3.1,\\,3.3\\,\\}$ with quarantine duration $Q_3 = 5.0$ and risk tolerance $r_3 = 0.10$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three sublists, each corresponding to one dataset in order $\\mathcal{D}_1,\\mathcal{D}_2,\\mathcal{D}_3$. Each sublist must be formatted as $[m,a_{\\Gamma},a_{\\mathrm{LN}},s,q^\\star]$ with no spaces, where $m$ is the integer model identifier, $a_{\\Gamma}$ is the Gamma AIC, $a_{\\mathrm{LN}}$ is the Lognormal AIC, $s$ is $S(Q)$ under the selected model, and $q^\\star$ is the required quarantine duration under the selected model. For example, a valid shape is $\\big[ [0,12.345000,11.234000,0.012300,8.765000],[\\dots], [\\dots] \\big]$ but with no spaces anywhere.", "solution": "We begin from fundamental definitions in statistical inference and probability. For a parametric model with parameter vector $\\boldsymbol{\\theta}$ and independent observations $\\{t_i\\}_{i=1}^{n}$, the likelihood is $L(\\boldsymbol{\\theta}\\mid \\{t_i\\}) = \\prod_{i=1}^{n} f(t_i \\mid \\boldsymbol{\\theta})$, and the log-likelihood is $\\ell(\\boldsymbol{\\theta}\\mid \\{t_i\\}) = \\sum_{i=1}^{n} \\log f(t_i \\mid \\boldsymbol{\\theta})$. Maximum likelihood estimation (MLE) chooses $\\widehat{\\boldsymbol{\\theta}}$ to maximize $\\ell(\\boldsymbol{\\theta}\\mid \\{t_i\\})$ over the admissible parameter space. Model selection using Akaike’s framework is based on the Akaike Information Criterion (AIC), defined as $\\mathrm{AIC} = 2k - 2\\ell(\\widehat{\\boldsymbol{\\theta}})$, where $k$ is the number of free parameters.\n\nWe analyze two models for incubation times, which are positive and continuous:\n\n1. Gamma distribution. Parameters: shape $\\alpha  0$ and scale $\\theta  0$. Density:\n$$\nf(t \\mid \\alpha,\\theta) = \\frac{t^{\\alpha - 1} e^{-t/\\theta}}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}},\\quad t0.\n$$\nFor a dataset $\\{t_i\\}_{i=1}^{n}$, the log-likelihood is\n$$\n\\ell(\\alpha,\\theta) = \\sum_{i=1}^{n} \\left[ (\\alpha - 1)\\log t_i - \\frac{t_i}{\\theta} - \\log \\Gamma(\\alpha) - \\alpha \\log \\theta \\right].\n$$\nThe constraints are $\\alpha0$ and $\\theta0$.\n\n2. Lognormal distribution. Parameters: log-mean $\\mu \\in \\mathbb{R}$ and log-standard deviation $\\sigma  0$. Density:\n$$\nf(t \\mid \\mu,\\sigma) = \\frac{1}{t\\,\\sigma\\,\\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln t - \\mu)^2}{2\\sigma^2} \\right),\\quad t0.\n$$\nThe log-likelihood is\n$$\n\\ell(\\mu,\\sigma) = \\sum_{i=1}^{n} \\left[ -\\log t_i - \\log \\sigma - \\frac{1}{2}\\log(2\\pi) - \\frac{(\\ln t_i - \\mu)^2}{2\\sigma^2} \\right],\n$$\nwith $\\sigma0$.\n\nIn both models, we restrict to the two-parameter versions by fixing the location parameter to $0$. Thus the number of free parameters is $k=2$ for each model. After obtaining $\\widehat{\\alpha},\\widehat{\\theta}$ for the Gamma model and $\\widehat{\\mu},\\widehat{\\sigma}$ for the Lognormal model via MLE, we compute\n$$\n\\mathrm{AIC}_{\\Gamma} = 2\\cdot 2 - 2\\,\\ell(\\widehat{\\alpha},\\widehat{\\theta}),\\quad\n\\mathrm{AIC}_{\\mathrm{LN}} = 2\\cdot 2 - 2\\,\\ell(\\widehat{\\mu},\\widehat{\\sigma}).\n$$\nWe select the model with the smaller AIC as the better fit.\n\nTo assess tail behavior relevant to quarantine design, for a quarantine duration $Q$ (in days), the tail probability (survival function) under a fitted model is\n$$\nS(Q) = \\mathbb{P}(T  Q) = 1 - F(Q),\n$$\nwhere $F$ is the cumulative distribution function of the fitted model. For a specified risk tolerance $r$ (a decimal, not a percentage), the minimum quarantine duration $q^\\star$ that ensures $\\mathbb{P}(T  q^\\star) \\le r$ satisfies\n$$\nF(q^\\star) = 1 - r \\quad \\Longleftrightarrow \\quad q^\\star = F^{-1}(1 - r).\n$$\nThis is computed from the quantile function of the selected model at probability $1-r$.\n\nAlgorithmic design:\n- Input data are the three datasets of incubation times (in days) with their associated $(Q,r)$ pairs. We denote them $(\\mathcal{D}_j,Q_j,r_j)$ for $j \\in \\{1,2,3\\}$.\n- For each dataset $\\mathcal{D}_j$, we compute MLEs for the Gamma and Lognormal models under the constraints ($\\alpha0,\\theta0$ and $\\sigma0$ respectively) and location fixed at $0$. Practically, we can implement MLE by numerical optimization of the negative log-likelihood, or use robust library routines that perform MLE under the specified constraints by fixing the location parameter to $0$.\n- We evaluate the maximized log-likelihoods $\\ell_{\\Gamma,j}$ and $\\ell_{\\mathrm{LN},j}$ at the MLEs, and compute $\\mathrm{AIC}_{\\Gamma,j} = 4 - 2\\ell_{\\Gamma,j}$ and $\\mathrm{AIC}_{\\mathrm{LN},j} = 4 - 2\\ell_{\\mathrm{LN},j}$.\n- We select the model with smaller AIC: define $m_j = 0$ if $\\mathrm{AIC}_{\\Gamma,j}  \\mathrm{AIC}_{\\mathrm{LN},j}$, else $m_j = 1$ (ties can be broken by choosing the Lognormal, but deterministic implementation is to choose Lognormal when $\\mathrm{AIC}_{\\Gamma,j} \\ge \\mathrm{AIC}_{\\mathrm{LN},j}$).\n- Under the selected model, we compute the survival function at $Q_j$: $s_j = S(Q_j)$, and the required quarantine duration $q^\\star_j = F^{-1}(1-r_j)$.\n- We round all real numbers to exactly $6$ decimal places.\n- We output a single line containing a list of three sublists $[m_j,\\mathrm{AIC}_{\\Gamma,j},\\mathrm{AIC}_{\\mathrm{LN},j},s_j,q^\\star_j]$ in order $j=1,2,3$, with no spaces anywhere.\n\nScientific implications:\n- If $\\mathrm{AIC}_{\\mathrm{LN}}$ is smaller, this indicates relatively heavier right tails compared to the Gamma fit, which tends to increase $S(Q)$ at larger $Q$ and inflate $q^\\star$ for stringent $r$, implying longer quarantine durations to achieve the same residual risk.\n- Conversely, if $\\mathrm{AIC}_{\\Gamma}$ is smaller, the tail is typically lighter, potentially yielding smaller $S(Q)$ and shorter $q^\\star$ for the same $r$.\n- The small-sample dataset tests stability: both models may fit closely with similar AICs; nevertheless, the quantile-based $q^\\star$ calculation remains well-defined under the selected model.\n\nAll computations must express times in days, tail probabilities as decimals, and final outputs as specified lists with six decimal places and no spaces.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef fit_gamma_mle(data):\n    # Fit two-parameter Gamma by fixing loc=0\n    a_hat, loc_hat, scale_hat = stats.gamma.fit(data, floc=0.0)\n    # Compute log-likelihood at MLE\n    logpdf = stats.gamma.logpdf(data, a=a_hat, loc=0.0, scale=scale_hat)\n    ll = float(np.sum(logpdf))\n    k = 2  # shape and scale\n    aic = 2 * k - 2 * ll\n    params = {'shape': a_hat, 'scale': scale_hat}\n    return params, ll, aic\n\ndef fit_lognorm_mle(data):\n    # Fit two-parameter Lognormal by fixing loc=0\n    s_hat, loc_hat, scale_hat = stats.lognorm.fit(data, floc=0.0)\n    # Compute log-likelihood at MLE\n    logpdf = stats.lognorm.logpdf(data, s=s_hat, loc=0.0, scale=scale_hat)\n    ll = float(np.sum(logpdf))\n    k = 2  # s (sigma), scale (=exp(mu))\n    aic = 2 * k - 2 * ll\n    # For interpretability, mu_hat = log(scale_hat), sigma_hat = s_hat\n    params = {'sigma': s_hat, 'scale': scale_hat}\n    return params, ll, aic\n\ndef survival_and_quantile_gamma(params, q, r):\n    # Survival at q and quantile at 1-r for Gamma(shape, scale)\n    shape = params['shape']\n    scale = params['scale']\n    s_val = float(stats.gamma.sf(q, a=shape, loc=0.0, scale=scale))\n    q_star = float(stats.gamma.ppf(1.0 - r, a=shape, loc=0.0, scale=scale))\n    return s_val, q_star\n\ndef survival_and_quantile_lognorm(params, q, r):\n    # Survival at q and quantile at 1-r for Lognormal(sigma, scale=exp(mu))\n    sigma = params['sigma']\n    scale = params['scale']\n    s_val = float(stats.lognorm.sf(q, s=sigma, loc=0.0, scale=scale))\n    q_star = float(stats.lognorm.ppf(1.0 - r, s=sigma, loc=0.0, scale=scale))\n    return s_val, q_star\n\ndef round6(x):\n    return float(f\"{x:.6f}\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (data list, Q in days, r in decimal)\n    test_cases = [\n        ([2.0, 3.5, 4.2, 5.1, 6.3, 3.8, 4.9, 2.7, 5.6, 4.1, 3.2, 6.8, 5.0, 4.4, 3.9], 7.0, 0.05),\n        ([1.2, 2.5, 3.1, 4.7, 2.9, 5.3, 9.5, 11.2, 14.8, 3.6, 4.1], 10.0, 0.01),\n        ([3.0, 3.2, 3.4, 3.1, 3.3], 5.0, 0.10),\n    ]\n\n    results = []\n    for data, Q, r in test_cases:\n        data = np.asarray(data, dtype=float)\n        # Fit both models\n        g_params, g_ll, g_aic = fit_gamma_mle(data)\n        ln_params, ln_ll, ln_aic = fit_lognorm_mle(data)\n        # Select model: 0 for Gamma, 1 for Lognormal (choose LN on tie)\n        if g_aic  ln_aic:\n            model_id = 0\n            s_Q, q_star = survival_and_quantile_gamma(g_params, Q, r)\n        else:\n            model_id = 1\n            s_Q, q_star = survival_and_quantile_lognorm(ln_params, Q, r)\n        # Round outputs\n        out = [\n            model_id,\n            round6(g_aic),\n            round6(ln_aic),\n            round6(s_Q),\n            round6(q_star),\n        ]\n        results.append(out)\n\n    # Format output: single line, no spaces\n    def format_no_spaces(res):\n        sublists = []\n        for sub in res:\n            items = []\n            for val in sub:\n                if isinstance(val, int):\n                    items.append(str(val))\n                else:\n                    # Ensure exactly 6 decimal places (already rounded)\n                    items.append(f\"{val:.6f}\")\n            sublists.append(\"[\" + \",\".join(items) + \"]\")\n        return \"[\" + \",\".join(sublists) + \"]\"\n\n    print(format_no_spaces(results))\n\nsolve()\n```", "id": "4600638"}]}