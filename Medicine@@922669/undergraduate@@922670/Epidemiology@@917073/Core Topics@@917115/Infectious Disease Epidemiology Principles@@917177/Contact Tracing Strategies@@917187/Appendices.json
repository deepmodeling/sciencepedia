{"hands_on_practices": [{"introduction": "The core principle of contact tracing is a race against the clock: isolating an infected person before they can transmit the pathogen to others. This exercise provides a quantitative foundation for understanding this principle by modeling the fraction of transmission averted as a function of isolation delay. By working through this problem [@problem_id:4581590], you will learn to connect an epidemic's natural timeline, described by the generation interval, directly to the potential impact of a public health intervention.", "problem": "Consider a pathogen for which the time from an infected individual’s infection to the infection of one of their secondary cases (the generation interval) is modeled by a Weibull distribution. Let the probability density function be $g(t)$ with shape parameter $k$ and scale parameter $\\lambda$, so that for $t \\ge 0$ the density is $g(t) = \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right)$ and $g(t)=0$ for $t0$. Assume that the instantaneous infectiousness profile of an infected individual is proportional to $g(t)$ and that the expected number of secondary infections generated at time $t$ after infection is $R_0 g(t)$, where $R_0$ is the basic reproduction number (R0). Suppose a contact tracing strategy isolates infected contacts at a fixed delay $d$ after their infection, after which their infectiousness is reduced to zero immediately and completely.\n\nUsing only these assumptions and standard properties of probability distributions, derive from first principles an expression for the expected fraction of onward transmissions prevented by this isolation-at-delay policy in terms of $g(t)$ and then evaluate it for a Weibull generation interval. Finally, compute the numerical value of this fraction for $k = 2.3$, $\\lambda = 5.2$ days, and $d = 3.0$ days. Express your final answer as a unit-free decimal fraction and round your answer to four significant figures. Do not express your answer as a percentage.", "solution": "The problem has been validated and is deemed scientifically grounded, well-posed, and objective. It is a standard problem in theoretical epidemiology that can be solved from first principles.\n\nThe expected number of secondary infections generated by an infected individual at time $t$ after their own infection is given by the infectiousness profile, which is stated to be $R_0 g(t)$. Here, $R_0$ is the basic reproduction number and $g(t)$ is the probability density function (PDF) of the generation interval.\n\nFirst, we establish the total expected number of secondary infections, $N_{total}$, from a single case in the absence of any intervention. This is obtained by integrating the infectiousness profile over all time:\n$$\nN_{total} = \\int_{-\\infty}^{\\infty} R_0 g(t) \\, dt\n$$\nThe problem states that the generation interval PDF $g(t)$ is zero for $t  0$. Therefore, the integral becomes:\n$$\nN_{total} = \\int_{0}^{\\infty} R_0 g(t) \\, dt = R_0 \\int_{0}^{\\infty} g(t) \\, dt\n$$\nBy definition, the integral of any probability density function over its entire domain is equal to $1$. Thus, $\\int_{0}^{\\infty} g(t) \\, dt = 1$. This confirms that the total expected number of secondary cases is $R_0$, which is consistent with the definition of the basic reproduction number.\n$$\nN_{total} = R_0 \\times 1 = R_0\n$$\nNext, we consider the effect of the contact tracing policy. The policy isolates the infected individual at a fixed delay $d$ after their infection, at which point their infectiousness immediately and completely becomes zero. This means that all transmissions that would have occurred at any time $t > d$ are prevented.\n\nThe expected number of prevented transmissions, $N_{prevented}$, is the integral of the infectiousness profile over the time period when transmission is blocked, i.e., from $t=d$ to infinity:\n$$\nN_{prevented} = \\int_{d}^{\\infty} R_0 g(t) \\, dt = R_0 \\int_{d}^{\\infty} g(t) \\, dt\n$$\nThe problem asks for the expected fraction of onward transmissions prevented. This fraction, which we denote as $F_{prevented}$, is the ratio of the expected number of prevented transmissions to the total expected number of transmissions:\n$$\nF_{prevented} = \\frac{N_{prevented}}{N_{total}} = \\frac{R_0 \\int_{d}^{\\infty} g(t) \\, dt}{R_0}\n$$\nThe $R_0$ terms cancel, yielding a general expression for the fraction of transmissions prevented that depends only on the generation interval distribution and the delay to isolation:\n$$\nF_{prevented} = \\int_{d}^{\\infty} g(t) \\, dt\n$$\nThis integral represents the probability that a transmission event occurs after time $d$. It is the complement of the cumulative distribution function (CDF) evaluated at $d$. If we define the CDF as $G(t) = \\int_0^t g(\\tau) \\, d\\tau$, then the fraction prevented is $1 - G(d)$. This is also known as the survival function, $S(d)$.\n\nNow, we evaluate this expression for the given Weibull distribution. The PDF is:\n$$\ng(t) = \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right) \\quad \\text{for } t \\ge 0\n$$\nTo find the fraction prevented, we must evaluate $F_{prevented} = \\int_{d}^{\\infty} g(t) \\, dt$. It is often simpler to first find the CDF, $G(d) = \\int_0^d g(t) \\, dt$, and then compute $1 - G(d)$.\n$$\nG(d) = \\int_0^d \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right) \\, dt\n$$\nWe use the substitution $u = (t/\\lambda)^k$. Then the differential is $du = \\frac{k}{\\lambda} \\left(\\frac{t}{\\lambda}\\right)^{k-1} dt$. The limits of integration change from $t=0$ and $t=d$ to $u=(0/\\lambda)^k = 0$ and $u=(d/\\lambda)^k$, respectively.\n$$\nG(d) = \\int_0^{(d/\\lambda)^k} \\exp(-u) \\, du = \\left[-\\exp(-u)\\right]_0^{(d/\\lambda)^k} = -\\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right) - (-\\exp(0)) = 1 - \\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right)\n$$\nThe fraction of transmissions prevented is therefore:\n$$\nF_{prevented} = 1 - G(d) = 1 - \\left(1 - \\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right)\\right) = \\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right)\n$$\nThis is the analytical expression for the fraction of onward transmissions prevented.\n\nFinally, we compute the numerical value using the provided parameters: shape parameter $k = 2.3$, scale parameter $\\lambda = 5.2$ days, and isolation delay $d = 3.0$ days. The units of $\\lambda$ and $d$ are consistent, so their ratio is dimensionless.\n$$\nF_{prevented} = \\exp\\left(-\\left(\\frac{3.0}{5.2}\\right)^{2.3}\\right)\n$$\nFirst, we calculate the exponent:\n$$\n\\left(\\frac{3.0}{5.2}\\right) \\approx 0.57692307...\n$$\n$$\n\\left(\\frac{3.0}{5.2}\\right)^{2.3} \\approx (0.57692307...)^{2.3} \\approx 0.28225155...\n$$\nNow, we compute the exponential of the negative of this value:\n$$\nF_{prevented} = \\exp(-0.28225155...) \\approx 0.754090...\n$$\nRounding the result to four significant figures gives $0.7541$. This is the unit-free decimal fraction representing the proportion of transmissions prevented.", "answer": "$$\n\\boxed{0.7541}\n$$", "id": "4581590"}, {"introduction": "Effective contact tracing doesn't end with identifying a contact; it requires informed decisions about that individual. This practice shifts our focus from population-level dynamics to the crucial task of individual risk assessment. By applying Bayes' rule [@problem_id:4581601], you will learn how to combine prior knowledge from an exposure assessment with new evidence from a diagnostic test to calculate an updated, more accurate probability of infection.", "problem": "A public health contact tracing team assigns an exposure intensity score to each traced contact following a single exposure event at time $t=0$. Suppose the team models the per-minute transmission hazard as constant and multiplicative in an exposure weight, so that if the contact lasted $d$ minutes with exposure weight $w$ and baseline hazard $\\beta$ (per minute), the prior infection probability is modeled by the no-event probability of a Poisson process:\n$$\nP(\\text{infection}) \\equiv p_{0} = 1 - \\exp\\!\\big(-\\beta\\,w\\,d\\big).\n$$\nAt day $t$ after exposure, a rapid antigen test is administered. Let the test sensitivity (probability of a positive test given infection) be time-varying according to the logistic function\n$$\ns(t) = \\frac{s_{\\max}}{1 + \\exp\\!\\big(-k\\,(t - t_{50})\\big)},\n$$\nand let the test specificity (probability of a negative test given no infection) be $\\sigma$, assumed constant over $t$. Assume that if infected, the infection occurred at the exposure time $t=0$, and that the sensitivity $s(t)$ is already marginal over within-host variability at day $t$.\n\nUsing only Bayes’ rule and the definitions of sensitivity and specificity, derive an analytic expression for the posterior probability of infection after observing a negative antigen test at day $t$, in terms of $p_{0}$, $s(t)$, and $\\sigma$. Then evaluate this posterior for the following parameters:\n- Baseline hazard $\\beta = 1.5 \\times 10^{-3}$ per minute,\n- Exposure weight $w = 2.5$,\n- Duration $d = 30$ minutes,\n- Day of testing $t = 3$ days after exposure,\n- Sensitivity parameters $s_{\\max} = 0.85$, $k = 1.2$ per day, $t_{50} = 4$ days,\n- Specificity $\\sigma = 0.995$.\n\nReport the posterior probability as a decimal number. Round your answer to four significant figures. Do not use a percentage sign.", "solution": "The problem requires the derivation of an analytic expression for the posterior probability of infection after a negative test, and its subsequent evaluation for a specific set of parameters. This is a direct application of Bayes' rule.\n\nFirst, let us define the relevant events:\n- Let $I$ be the event that the individual is infected.\n- Let $I^c$ be the event that the individual is not infected.\n- Let $T^+$ be the event that the antigen test is positive.\n- Let $T^-$ be the event that the antigen test is negative.\n\nWe are asked to find the posterior probability of infection given a negative test result at day $t$, which is denoted by $P(I | T^-)$.\n\nFrom the problem statement, we are given the following probabilities:\n- The prior probability of infection is $P(I) = p_0$.\n- The prior probability of not being infected is therefore $P(I^c) = 1 - P(I) = 1 - p_0$.\n- The sensitivity of the test at day $t$ is the probability of a positive test given infection: $P(T^+ | I) = s(t)$. From this, the probability of a negative test given infection is $P(T^- | I) = 1 - P(T^+ | I) = 1 - s(t)$.\n- The specificity of the test is the probability of a negative test given no infection: $P(T^- | I^c) = \\sigma$.\n\nAccording to Bayes' rule, the posterior probability of infection given a negative test is:\n$$\nP(I | T^-) = \\frac{P(T^- | I) P(I)}{P(T^-)}\n$$\n\nThe denominator, $P(T^-)$, is the total probability of a negative test result. It can be expanded using the law of total probability:\n$$\nP(T^-) = P(T^- | I) P(I) + P(T^- | I^c) P(I^c)\n$$\nSubstituting the defined terms into this expression:\n$$\nP(T^-) = (1 - s(t)) p_0 + \\sigma (1 - p_0)\n$$\n\nNow, we can substitute this expression for $P(T^-)$ back into Bayes' rule:\n$$\nP(I | T^-) = \\frac{P(T^- | I) P(I)}{(1 - s(t)) p_0 + \\sigma (1 - p_0)}\n$$\nSubstituting the known terms into the numerator:\n$$\nP(I | T^-) = \\frac{(1 - s(t)) p_0}{(1 - s(t)) p_0 + \\sigma (1 - p_0)}\n$$\nThis is the required analytic expression for the posterior probability of infection in terms of $p_0$, $s(t)$, and $\\sigma$.\n\nNext, we must evaluate this expression using the provided parameters.\nThe parameters are:\n- Baseline hazard $\\beta = 1.5 \\times 10^{-3}$ per minute\n- Exposure weight $w = 2.5$\n- Duration $d = 30$ minutes\n- Day of testing $t = 3$ days\n- Sensitivity parameters $s_{\\max} = 0.85$, $k = 1.2$ per day, $t_{50} = 4$ days\n- Specificity $\\sigma = 0.995$\n\nFirst, we calculate the prior probability of infection, $p_0$:\n$$\np_0 = 1 - \\exp(-\\beta w d)\n$$\nThe argument of the exponential is:\n$$\n-\\beta w d = -(1.5 \\times 10^{-3}) \\times 2.5 \\times 30 = -0.0015 \\times 75 = -0.1125\n$$\nSo, the prior probability is:\n$$\np_0 = 1 - \\exp(-0.1125)\n$$\n\nNext, we calculate the test sensitivity at day $t=3$, $s(3)$:\n$$\ns(t) = \\frac{s_{\\max}}{1 + \\exp(-k(t - t_{50}))}\n$$\nThe argument of the exponential in the denominator is:\n$$\n-k(t - t_{50}) = -1.2 \\times (3 - 4) = -1.2 \\times (-1) = 1.2\n$$\nSo, the sensitivity at $t=3$ is:\n$$\ns(3) = \\frac{0.85}{1 + \\exp(1.2)}\n$$\n\nNow we substitute these expressions for $p_0$ and $s(3)$ into our derived formula for the posterior probability. Let's denote the posterior probability as $P_{\\text{post}}$:\n$$\nP_{\\text{post}} = P(I | T^-) = \\frac{(1 - s(3)) p_0}{(1 - s(3)) p_0 + \\sigma (1 - p_0)}\n$$\nLet's substitute the intermediate expressions:\n$$\n1 - p_0 = 1 - (1 - \\exp(-0.1125)) = \\exp(-0.1125)\n$$\n$$\n1 - s(3) = 1 - \\frac{0.85}{1 + \\exp(1.2)} = \\frac{1 + \\exp(1.2) - 0.85}{1 + \\exp(1.2)} = \\frac{0.15 + \\exp(1.2)}{1 + \\exp(1.2)}\n$$\nThe numerator of $P_{\\text{post}}$ is:\n$$\n(1 - s(3))p_0 = \\left(\\frac{0.15 + \\exp(1.2)}{1 + \\exp(1.2)}\\right) \\times (1 - \\exp(-0.1125))\n$$\nThe denominator of $P_{\\text{post}}$ is:\n$$\n(1 - s(3))p_0 + \\sigma(1 - p_0) = \\left(\\frac{0.15 + \\exp(1.2)}{1 + \\exp(1.2)}\\right) (1 - \\exp(-0.1125)) + 0.995 \\exp(-0.1125)\n$$\n\nNow we perform the numerical calculations:\n$$\n\\exp(-0.1125) \\approx 0.8935950\n$$\n$$\np_0 = 1 - 0.8935950 = 0.1064050\n$$\n$$\n\\exp(1.2) \\approx 3.3201169\n$$\n$$\ns(3) = \\frac{0.85}{1 + 3.3201169} = \\frac{0.85}{4.3201169} \\approx 0.1967543\n$$\n$$\n1 - s(3) \\approx 1 - 0.1967543 = 0.8032457\n$$\n\nNow we can calculate the numerator and denominator of the posterior probability expression:\nNumerator:\n$$\n(1 - s(3)) p_0 \\approx 0.8032457 \\times 0.1064050 \\approx 0.0854701\n$$\nDenominator:\n$$\n(1 - s(3)) p_0 + \\sigma (1 - p_0) \\approx 0.0854701 + (0.995 \\times 0.8935950)\n$$\n$$\n(1 - s(3)) p_0 + \\sigma (1 - p_0) \\approx 0.0854701 + 0.8891270 = 0.9745971\n$$\nFinally, the posterior probability is:\n$$\nP(I | T^-) = \\frac{0.0854701}{0.9745971} \\approx 0.0877003\n$$\nThe problem asks for the answer to be rounded to four significant figures. The first significant figure is $8$. The fourth is the final $0$.\n$$\nP(I | T^-) \\approx 0.08770\n$$", "answer": "$$\n\\boxed{0.08770}\n$$", "id": "4581601"}, {"introduction": "In many outbreaks, a small number of individuals are responsible for a large proportion of transmission. This exercise introduces backward contact tracing, a powerful strategy designed to find these high-yield transmission clusters. By exploring the concept of size-biased sampling [@problem_id:4581671], you will understand why tracing the source of an infection is often more efficient than only tracing its subsequent contacts.", "problem": "An emerging infectious disease spreads in a population where the number of secondary infections caused by a single infectious individual (the offspring count) is modeled by a Negative Binomial distribution with mean $R0$ and dispersion parameter $k0$, using the standard parameterization in which the variance is $R + \\frac{R^{2}}{k}$. A case is detected at random from among all detected cases and public health practitioners employ backward contact tracing: they successfully identify the infector (the source case) of the detected case with probability $1$, and then perform forward tracing from that source to identify all remaining infections caused by that same source in the same generation.\n\nTreat the observed detected case as fixed, and define the cluster uncovered by backward tracing to be the set of other infections caused by the same source case in that generation, excluding the originally detected case. Assume tracing is instantaneous and perfect, generations do not overlap, and there is no right censoring.\n\nStarting from first principles about size-biased sampling and standard properties of the Negative Binomial distribution, derive a closed-form expression in terms of $R$ and $k$ for the expected number of cases in this backward-traced cluster (that is, the expected number of other infections caused by the same source, excluding the originally detected case). Provide your final result as a single analytic expression. No rounding is required.", "solution": "The problem asks for the expected number of other cases (co-infectees) generated by the source of a randomly detected case. This process involves size-biased sampling.\n\nLet $X$ be the random variable representing the number of secondary infections caused by a single infectious individual. This is the offspring count. The problem states that $X$ follows a Negative Binomial distribution. The distribution is parameterized by its mean, $E[X] = R$, and its dispersion parameter, $k$. The variance is given as $\\text{Var}(X) = R + \\frac{R^2}{k}$.\n\nWhen a case is detected at random from the population of all infected individuals, the infector of this case is not a randomly chosen individual from the population of all infectors. An infector who produced a larger number of secondary cases, say $j$, is $j$ times more likely to be the source of a randomly selected case than an infector who produced only one case. This is the principle of size-biased sampling.\n\nLet $X^*$ be the random variable representing the offspring count of the infector of a randomly selected case. The distribution of $X^*$ is the size-biased distribution of $X$. The probability mass function (PMF) of $X^*$, for $j \\ge 1$, is related to the PMF of $X$ by the formula:\n$$ P(X^*=j) = \\frac{j \\cdot P(X=j)}{E[X]} $$\nThe denominator $E[X]$ serves as a normalization constant, as $\\sum_{j=0}^{\\infty} j \\cdot P(X=j) = E[X]$. Note that $P(X^*=0) = 0$, since the source must have caused at least one infection (the detected case).\n\nWe are asked for the expected number of cases in the backward-traced cluster, which is defined as the set of other infections from the same source, excluding the originally detected case. If the source's total offspring count is $X^*$, then the number of cases in this cluster is $X^* - 1$. We need to calculate $E[X^* - 1]$.\n\nBy the linearity of expectation, we have:\n$$ E[X^* - 1] = E[X^*] - 1 $$\nTo find $E[X^*]$, we can use the moments of the original distribution $X$. The expected value of the size-biased variable $X^*$ is given by:\n$$ E[X^*] = \\sum_{j=1}^{\\infty} j \\cdot P(X^*=j) = \\sum_{j=1}^{\\infty} j \\cdot \\frac{j \\cdot P(X=j)}{E[X]} = \\frac{1}{E[X]} \\sum_{j=0}^{\\infty} j^2 \\cdot P(X=j) = \\frac{E[X^2]}{E[X]} $$\nWe are given the first moment (mean) of $X$:\n$$ E[X] = R $$\nWe can find the second moment, $E[X^2]$, from the variance. The definition of variance is $\\text{Var}(X) = E[X^2] - (E[X])^2$. Therefore:\n$$ E[X^2] = \\text{Var}(X) + (E[X])^2 $$\nThe problem provides the expression for the variance:\n$$ \\text{Var}(X) = R + \\frac{R^2}{k} $$\nSubstituting the given mean and variance, we obtain the second moment of $X$:\n$$ E[X^2] = \\left(R + \\frac{R^2}{k}\\right) + R^2 = R + R^2 \\left(1 + \\frac{1}{k}\\right) = R + R^2 \\frac{k+1}{k} $$\nNow we can compute $E[X^*]$:\n$$ E[X^*] = \\frac{E[X^2]}{E[X]} = \\frac{R + R^2 \\frac{k+1}{k}}{R} $$\nDividing each term in the numerator by $R$ gives:\n$$ E[X^*] = 1 + R \\frac{k+1}{k} $$\nFinally, we can find the expected size of the backward-traced cluster, $E[X^* - 1]$:\n$$ E[X^* - 1] = E[X^*] - 1 = \\left(1 + R \\frac{k+1}{k}\\right) - 1 = R \\frac{k+1}{k} $$\nThe expression can also be written as $R\\left(1 + \\frac{1}{k}\\right)$ or $R + \\frac{R}{k}$. This result demonstrates that in populations with high transmission heterogeneity (small $k$), backward contact tracing is particularly effective because it is more likely to lead to a source with a large number of infectees. For instance, as $k \\to \\infty$, the Negative Binomial distribution converges to a Poisson distribution, and the expected cluster size becomes $\\lim_{k \\to \\infty} R(1 + \\frac{1}{k}) = R$. In contrast, for small $k$, the term $\\frac{1}{k}$ becomes large, substantially increasing the expected yield of contact tracing.", "answer": "$$\\boxed{R + \\frac{R}{k}}$$", "id": "4581671"}]}