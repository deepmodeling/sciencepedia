{"hands_on_practices": [{"introduction": "To move from theory to application, we begin with a foundational exercise. This practice will guide you through the essential workflow of an epidemiologist: using a hypothetical dataset to first verify if a variable meets the classic criteria for a confounder, and then applying the method of standardization to adjust for its effect. This process allows us to estimate the causal risk difference, a clear measure of the exposure's impact on the outcome. [@problem_id:4582738]", "problem": "Consider an observational cohort study of a preventive therapy with binary exposure $A \\in \\{0,1\\}$ and binary outcome $Y \\in \\{0,1\\}$, and a baseline covariate $L \\in \\{0,1\\}$ measured prior to exposure assignment. The study aims to estimate the causal risk difference $E[Y_{1}] - E[Y_{0}]$, where $Y_{a}$ denotes the potential outcome under exposure set to $a$.\n\nYou are given the following stratified counts from the cohort:\n- For $L=0$: among the exposed ($A=1$), there are $n_{10}=220$ individuals and $y_{10}=33$ observed outcomes ($Y=1$); among the unexposed ($A=0$), there are $n_{00}=380$ individuals and $y_{00}=38$ observed outcomes.\n- For $L=1$: among the exposed ($A=1$), there are $n_{11}=180$ individuals and $y_{11}=54$ observed outcomes; among the unexposed ($A=0$), there are $n_{01}=220$ individuals and $y_{01}=44$ observed outcomes.\n\nAssume that the target population for inference has the marginal distribution of $L$ given by $p(L=0)=0.6$ and $p(L=1)=0.4$.\n\nTasks:\n1. Using first principles in causal inference, verify that $L$ satisfies the criteria to be treated as a confounder for the effect of $A$ on $Y$ in this setting, based on the information provided.\n2. Under the assumptions of consistency, conditional exchangeability given $L$, and positivity, derive an identification strategy from core definitions and the law of total expectation to express $E[Y_{1}] - E[Y_{0}]$ in terms of observable quantities.\n3. Compute the numerical value of the causal risk difference for the target population using the provided data.\n\nExpress the final numerical answer as a decimal and round your answer to four significant figures.", "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of causal inference, well-posed with sufficient data and clear objectives, and framed using objective, formal language. We proceed with the solution.\n\nThe solution is structured into three parts as requested by the problem statement.\n\n### Part 1: Verification of $L$ as a Confounder\n\nA baseline covariate $L$ is a confounder for the causal effect of an exposure $A$ on an outcome $Y$ if it satisfies three criteria:\n1.  $L$ is associated with the exposure $A$.\n2.  $L$ is associated with the outcome $Y$, conditional on the exposure $A$. (This implies $L$ is a risk factor for $Y$).\n3.  $L$ is not on the causal pathway from $A$ to $Y$.\n\nThe problem states that $L$ is a \"baseline covariate measured prior to exposure assignment,\" which satisfies the third criterion by temporal ordering. We must verify the first two criteria using the provided data. The associations are evaluated using empirical probabilities from the sample counts.\n\n**Criterion 1: Association between $L$ and $A$**\n\nWe test if the probability of exposure differs across strata of $L$, i.e., if $P(A=1|L=1) \\neq P(A=1|L=0)$.\nThe total number of individuals in stratum $L=0$ is $n_{10} + n_{00} = 220 + 380 = 600$.\nThe total number of individuals in stratum $L=1$ is $n_{11} + n_{01} = 180 + 220 = 400$.\n\nThe probability of being exposed ($A=1$) given $L=0$ is estimated as:\n$$\nP(A=1|L=0) = \\frac{n_{10}}{n_{10} + n_{00}} = \\frac{220}{600} = \\frac{11}{30} \\approx 0.3667\n$$\nThe probability of being exposed ($A=1$) given $L=1$ is estimated as:\n$$\nP(A=1|L=1) = \\frac{n_{11}}{n_{11} + n_{01}} = \\frac{180}{400} = \\frac{9}{20} = 0.45\n$$\nSince $P(A=1|L=0) \\neq P(A=1|L=1)$ ($0.3667 \\neq 0.45$), $L$ is associated with the exposure $A$ in this study population.\n\n**Criterion 2: Association between $L$ and $Y$ conditional on $A$**\n\nWe test if the probability of the outcome differs across strata of $L$, within levels of exposure $A$.\n\nFirst, among the unexposed ($A=0$):\nWe test if $P(Y=1|A=0, L=1) \\neq P(Y=1|A=0, L=0)$.\nThe risk of the outcome among the unexposed in stratum $L=0$ is:\n$$\nP(Y=1|A=0, L=0) = \\frac{y_{00}}{n_{00}} = \\frac{38}{380} = 0.10\n$$\nThe risk of the outcome among the unexposed in stratum $L=1$ is:\n$$\nP(Y=1|A=0, L=1) = \\frac{y_{01}}{n_{01}} = \\frac{44}{220} = 0.20\n$$\nSince $P(Y=1|A=0, L=0) \\neq P(Y=1|A=0, L=1)$ ($0.10 \\neq 0.20$), $L$ is associated with the outcome $Y$ among the unexposed.\n\nSecond, among the exposed ($A=1$):\nWe test if $P(Y=1|A=1, L=1) \\neq P(Y=1|A=1, L=0)$.\nThe risk of the outcome among the exposed in stratum $L=0$ is:\n$$\nP(Y=1|A=1, L=0) = \\frac{y_{10}}{n_{10}} = \\frac{33}{220} = 0.15\n$$\nThe risk of the outcome among the exposed in stratum $L=1$ is:\n$$\nP(Y=1|A=1, L=1) = \\frac{y_{11}}{n_{11}} = \\frac{54}{180} = 0.30\n$$\nSince $P(Y=1|A=1, L=0) \\neq P(Y=1|A=1, L=1)$ ($0.15 \\neq 0.30$), $L$ is also associated with the outcome $Y$ among the exposed.\n\nAs all three criteria are satisfied, $L$ is a confounder for the effect of $A$ on $Y$.\n\n### Part 2: Identification Strategy\n\nThe goal is to express the causal risk difference, $E[Y_1] - E[Y_0]$, in terms of observable quantities. The derivation relies on the assumptions of consistency, conditional exchangeability, and positivity.\n\nLet $E[Y_a]$ be the expected potential outcome had everyone in the population been assigned exposure level $a \\in \\{0,1\\}$. We can identify $E[Y_a]$ by standardizing over the distribution of the confounder $L$ in the target population.\n\n1.  Start with the law of total expectation, marginalizing over $L$:\n    $$\n    E[Y_a] = \\sum_{l \\in \\{0,1\\}} E[Y_a | L=l] P(L=l)\n    $$\n2.  Apply the assumption of *conditional exchangeability* (or no unmeasured confounding), $Y_a \\perp A | L$. This states that, within strata of $L$, the potential outcome $Y_a$ is independent of the actual exposure received, $A$. This implies:\n    $$\n    E[Y_a | L=l] = E[Y_a | A=a, L=l]\n    $$\n3.  Apply the assumption of *consistency*, which states that for an individual who received exposure $A=a$, their observed outcome $Y$ is equal to their potential outcome $Y_a$. This allows us to link the potential outcome to the observable outcome:\n    $$\n    E[Y_a | A=a, L=l] = E[Y | A=a, L=l]\n    $$\n4.  Combining these steps gives the identification formula for $E[Y_a]$:\n    $$\n    E[Y_a] = \\sum_{l \\in \\{0,1\\}} E[Y | A=a, L=l] P(L=l)\n    $$\n    Since $Y$ is binary, $E[Y|A=a, L=l]$ is simply the conditional probability $P(Y=1|A=a, L=l)$, which is an observable quantity. The formula becomes:\n    $$\n    E[Y_a] = \\sum_{l \\in \\{0,1\\}} P(Y=1 | A=a, L=l) P(L=l)\n    $$\n    The *positivity* assumption, $P(A=a|L=l) > 0$ for all $a, l$, ensures that we can estimate the conditional probabilities $P(Y=1|A=a, L=l)$ from the data, as there are individuals with both exposure levels in each stratum of $L$. The provided counts ($n_{10}=220, n_{00}=380, n_{11}=180, n_{01}=220$) are all non-zero, satisfying this condition.\n\nThe causal risk difference, $E[Y_1] - E[Y_0]$, is then identified as:\n$$\nE[Y_1] - E[Y_0] = \\left(\\sum_{l=0}^{1} P(Y=1|A=1,L=l)P(L=l)\\right) - \\left(\\sum_{l=0}^{1} P(Y=1|A=0,L=l)P(L=l)\\right)\n$$\nThis can be rewritten as:\n$$\nE[Y_1] - E[Y_0] = \\sum_{l=0}^{1} \\left( P(Y=1|A=1,L=l) - P(Y=1|A=0,L=l) \\right) P(L=l)\n$$\nThis is the standardization formula for the risk difference.\n\n### Part 3: Numerical Computation\n\nWe use the derived formula and the provided data to compute the causal risk difference for the target population where $P(L=0)=0.6$ and $P(L=1)=0.4$.\n\nFirst, we calculate the stratum-specific observable risks, which were also used in Part 1.\n-   $P(Y=1|A=1, L=0) = \\frac{33}{220} = 0.15$\n-   $P(Y=1|A=0, L=0) = \\frac{38}{380} = 0.10$\n-   $P(Y=1|A=1, L=1) = \\frac{54}{180} = 0.30$\n-   $P(Y=1|A=0, L=1) = \\frac{44}{220} = 0.20$\n\nNext, we compute the standardized risks $E[Y_1]$ and $E[Y_0]$ for the target population.\nFor $E[Y_1]$ (standardized risk if everyone were exposed):\n$$\nE[Y_1] = P(Y=1|A=1, L=0)P(L=0) + P(Y=1|A=1, L=1)P(L=1)\n$$\n$$\nE[Y_1] = (0.15)(0.6) + (0.30)(0.4) = 0.09 + 0.12 = 0.21\n$$\n\nFor $E[Y_0]$ (standardized risk if everyone were unexposed):\n$$\nE[Y_0] = P(Y=1|A=0, L=0)P(L=0) + P(Y=1|A=0, L=1)P(L=1)\n$$\n$$\nE[Y_0] = (0.10)(0.6) + (0.20)(0.4) = 0.06 + 0.08 = 0.14\n$$\n\nFinally, the causal risk difference is the difference between these two standardized risks:\n$$\nE[Y_1] - E[Y_0] = 0.21 - 0.14 = 0.07\n$$\nThe problem requires the answer to be expressed as a decimal rounded to four significant figures.\n$$\n0.07000\n$$", "answer": "$$\n\\boxed{0.07000}\n$$", "id": "4582738"}, {"introduction": "Building on our understanding of adjustment, this practice introduces the Mantel-Haenszel method, a classic and powerful tool for controlling confounding in stratified data when the goal is to estimate a common risk or odds ratio. You will not only calculate the adjusted risk ratio but also investigate the assumption of effect measure homogeneity—the idea that the exposure's effect is consistent across different subgroups. This exercise demonstrates how epidemiologists pool information across strata to obtain a single, precise estimate of effect. [@problem_id:4582728]", "problem": "Consider a cohort study with a binary exposure $A \\in \\{0,1\\}$, a binary outcome $Y \\in \\{0,1\\}$ measured at the end of follow-up, and a baseline binary covariate $L \\in \\{0,1\\}$ suspected to be a confounder. You observe the following counts within each stratum of $L$, where $a_{\\ell}$ denotes exposed cases, $b_{\\ell}$ exposed non-cases, $c_{\\ell}$ unexposed cases, and $d_{\\ell}$ unexposed non-cases in stratum $L=\\ell$:\n- For $L=0$: $a_{0}=10$, $b_{0}=90$, $c_{0}=10$, $d_{0}=190$.\n- For $L=1$: $a_{1}=20$, $b_{1}=30$, $c_{1}=10$, $d_{1}=40$.\n\nLet $n_{1\\ell}=a_{\\ell}+b_{\\ell}$ be the number exposed in stratum $\\ell$, $n_{0\\ell}=c_{\\ell}+d_{\\ell}$ the number unexposed in stratum $\\ell$, and $n_{\\ell}=n_{1\\ell}+n_{0\\ell}$ the stratum total. Define the risk in a cell as the proportion of cases among those at risk in that cell. The target effect measure is the causal risk ratio $\\text{RR}=\\Pr(Y^{1}=1)/\\Pr(Y^{0}=1)$, where $Y^{a}$ denotes the potential outcome under exposure level $a$.\n\nUsing only fundamental definitions of risk, association, and the identification assumptions of consistency, exchangeability, and positivity from the potential outcomes framework, do the following:\n\n1) Using the data above, justify whether $L$ satisfies the traditional criteria for a confounder in this setting (association with $A$ and independent association with $Y$ in the source population, and not a consequence of $A$).\n\n2) Compute the crude risk ratio ignoring $L$, that is, the ratio of the overall risk among exposed to the overall risk among unexposed, treating the sample as unstratified. Express your result as an exact fraction in simplest terms.\n\n3) Compute the stratum-specific risk ratios $\\text{RR}_{\\ell}=\\Pr(Y=1 \\mid A=1,L=\\ell)/\\Pr(Y=1 \\mid A=0,L=\\ell)$ for $\\ell \\in \\{0,1\\}$, and state whether they are equal across strata.\n\n4) Starting from the definition of a common causal risk ratio across strata, derive the Mantel–Haenszel (MH) estimator for the risk ratio in a cohort, expressed in terms of the stratum-specific cell counts $\\{a_{\\ell},b_{\\ell},c_{\\ell},d_{\\ell}\\}$ and totals $\\{n_{1\\ell},n_{0\\ell},n_{\\ell}\\}$, and compute its value for the data above. Do not assume any approximate rare disease conditions.\n\n5) Suppose that for each stratum $\\ell$ there exists a constant $\\theta>0$ such that $\\Pr(Y=1 \\mid A=1,L=\\ell)=\\theta\\,\\Pr(Y=1 \\mid A=0,L=\\ell)$, and assume the causal identification conditions hold: consistency, positivity ($0<\\Pr(A=a \\mid L=\\ell)<1$ for all $a \\in \\{0,1\\}$ and strata with support), and conditional exchangeability $\\{Y^{0},Y^{1}\\} \\perp A \\mid L$. Under these conditions and in large samples, derive the expected value of the Mantel–Haenszel risk ratio estimator you obtained in part $4)$ and express it as a single closed-form analytic expression in terms of $\\theta$. Your final answer must be a single expression. No rounding is required.", "solution": "The user has provided a multi-part problem in epidemiology concerning the assessment of confounding and the estimation of a risk ratio. I will first validate the problem and then proceed to solve each part sequentially.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Study type: Cohort study.\n-   Exposure: Binary, $A \\in \\{0,1\\}$.\n-   Outcome: Binary, $Y \\in \\{0,1\\}$.\n-   Covariate: Binary, $L \\in \\{0,1\\}$.\n-   Data for stratum $L=0$: exposed cases $a_{0}=10$, exposed non-cases $b_{0}=90$, unexposed cases $c_{0}=10$, unexposed non-cases $d_{0}=190$.\n-   Data for stratum $L=1$: exposed cases $a_{1}=20$, exposed non-cases $b_{1}=30$, unexposed cases $c_{1}=10$, unexposed non-cases $d_{1}=40$.\n-   Definitions: $n_{1\\ell}=a_{\\ell}+b_{\\ell}$, $n_{0\\ell}=c_{\\ell}+d_{\\ell}$, $n_{\\ell}=n_{1\\ell}+n_{0\\ell}$.\n-   Target parameter: Causal risk ratio $\\text{RR}=\\Pr(Y^{1}=1)/\\Pr(Y^{0}=1)$.\n-   Causal assumptions for identification: Consistency, conditional exchangeability ($\\{Y^{0},Y^{1}\\} \\perp A \\mid L$), and positivity.\n-   Assumption for part 5: Common stratum-specific risk ratio, $\\Pr(Y=1 \\mid A=1,L=\\ell)=\\theta\\,\\Pr(Y=1 \\mid A=0,L=\\ell)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of epidemiology and causal inference. It uses standard definitions and data structures (stratified $2 \\times 2$ tables from a cohort study). The concepts of confounding, risk ratio, the Mantel-Haenszel estimator, and the potential outcomes framework are central to the discipline. The problem is well-posed, with all necessary data and definitions provided to answer each of the five parts. The language is objective and precise. The problem is free from any scientific unsoundness, ambiguity, or contradiction. The derivations and calculations requested are standard, non-trivial exercises in epidemiological methods.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with a full solution.\n\n### Solution\n\n**Part 1: Justification of $L$ as a Confounder**\n\nThe three traditional criteria for a variable $L$ to be a confounder for the effect of an exposure $A$ on an outcome $Y$ are:\n1.  $L$ is associated with the exposure $A$ in the source population.\n2.  $L$ is an independent risk factor for the outcome $Y$ (i.e., associated with $Y$ among the unexposed).\n3.  $L$ is not on the causal pathway from $A$ to $Y$.\n\nThe problem states that $L$ is a baseline covariate, which implies it is measured before the exposure $A$ is determined. Thus, criterion $3$ is satisfied by study design. We assess criteria $1$ and $2$ using the provided data.\n\nTo check for an association between $L$ and $A$, we can compare the proportion of exposed individuals in each stratum of $L$.\n-   Total subjects in stratum $L=0$: $n_{0} = a_{0}+b_{0}+c_{0}+d_{0} = 10+90+10+190 = 300$.\n-   Number of exposed in stratum $L=0$: $n_{10} = a_{0}+b_{0} = 10+90 = 100$.\n-   Proportion exposed in stratum $L=0$: $\\hat{\\Pr}(A=1 \\mid L=0) = \\frac{n_{10}}{n_{0}} = \\frac{100}{300} = \\frac{1}{3}$.\n-   Total subjects in stratum $L=1$: $n_{1} = a_{1}+b_{1}+c_{1}+d_{1} = 20+30+10+40 = 100$.\n-   Number of exposed in stratum $L=1$: $n_{11} = a_{1}+b_{1} = 20+30 = 50$.\n-   Proportion exposed in stratum $L=1$: $\\hat{\\Pr}(A=1 \\mid L=1) = \\frac{n_{11}}{n_{1}} = \\frac{50}{100} = \\frac{1}{2}$.\nSince $\\hat{\\Pr}(A=1 \\mid L=0) = \\frac{1}{3} \\neq \\frac{1}{2} = \\hat{\\Pr}(A=1 \\mid L=1)$, there is an association between $L$ and $A$ in the sample.\n\nTo check if $L$ is an independent risk factor for $Y$, we compare the risk of the outcome in each stratum of $L$ among the unexposed ($A=0$).\n-   Number of unexposed in stratum $L=0$: $n_{00} = c_{0}+d_{0} = 10+190 = 200$.\n-   Risk among unexposed in stratum $L=0$: $\\hat{\\Pr}(Y=1 \\mid A=0, L=0) = \\frac{c_{0}}{n_{00}} = \\frac{10}{200} = \\frac{1}{20}$.\n-   Number of unexposed in stratum $L=1$: $n_{01} = c_{1}+d_{1} = 10+40 = 50$.\n-   Risk among unexposed in stratum $L=1$: $\\hat{\\Pr}(Y=1 \\mid A=0, L=1) = \\frac{c_{1}}{n_{01}} = \\frac{10}{50} = \\frac{1}{5}$.\nSince $\\hat{\\Pr}(Y=1 \\mid A=0, L=0) = \\frac{1}{20} \\neq \\frac{1}{5} = \\hat{\\Pr}(Y=1 \\mid A=0, L=1)$, $L$ is associated with the outcome $Y$ among the unexposed.\n\nSince all three criteria are met, we conclude that $L$ is a confounder for the relationship between $A$ and $Y$ in this dataset.\n\n**Part 2: Crude Risk Ratio**\n\nThe crude risk ratio is calculated by ignoring the stratification by $L$ and creating a single $2 \\times 2$ table.\n-   Total exposed cases: $a = a_{0}+a_{1} = 10+20=30$.\n-   Total exposed subjects: $N_{1} = (a_{0}+b_{0})+(a_{1}+b_{1}) = 100+50 = 150$.\n-   Total unexposed cases: $c = c_{0}+c_{1} = 10+10=20$.\n-   Total unexposed subjects: $N_{0} = (c_{0}+d_{0})+(c_{1}+d_{1}) = 200+50=250$.\nThe risk among the exposed is $R_{1} = \\frac{a}{N_{1}} = \\frac{30}{150} = \\frac{1}{5}$.\nThe risk among the unexposed is $R_{0} = \\frac{c}{N_{0}} = \\frac{20}{250} = \\frac{2}{25}$.\nThe crude risk ratio is $\\text{RR}_{\\text{crude}} = \\frac{R_{1}}{R_{0}} = \\frac{1/5}{2/25} = \\frac{1}{5} \\times \\frac{25}{2} = \\frac{25}{10} = \\frac{5}{2}$.\n\n**Part 3: Stratum-Specific Risk Ratios**\n\nWe calculate the risk ratio within each stratum of $L$.\nFor stratum $L=0$:\n-   Risk in exposed: $\\hat{\\Pr}(Y=1 \\mid A=1, L=0) = \\frac{a_{0}}{n_{10}} = \\frac{10}{100} = \\frac{1}{10}$.\n-   Risk in unexposed: $\\hat{\\Pr}(Y=1 \\mid A=0, L=0) = \\frac{c_{0}}{n_{00}} = \\frac{10}{200} = \\frac{1}{20}$.\n-   Stratum-specific risk ratio: $\\text{RR}_{0} = \\frac{1/10}{1/20} = 2$.\n\nFor stratum $L=1$:\n-   Risk in exposed: $\\hat{\\Pr}(Y=1 \\mid A=1, L=1) = \\frac{a_{1}}{n_{11}} = \\frac{20}{50} = \\frac{2}{5}$.\n-   Risk in unexposed: $\\hat{\\Pr}(Y=1 \\mid A=0, L=1) = \\frac{c_{1}}{n_{01}} = \\frac{10}{50} = \\frac{1}{5}$.\n-   Stratum-specific risk ratio: $\\text{RR}_{1} = \\frac{2/5}{1/5} = 2$.\n\nThe stratum-specific risk ratios are equal: $\\text{RR}_{0} = \\text{RR}_{1} = 2$. This indicates that $L$ does not modify the effect of $A$ on $Y$ on the risk ratio scale. The discrepancy between the crude risk ratio ($\\frac{5}{2}=2.5$) and the common stratum-specific risk ratio ($2$) is evidence of confounding by $L$.\n\n**Part 4: Mantel-Haenszel Risk Ratio Estimator**\n\nThe Mantel-Haenszel (MH) estimator for a common risk ratio, $\\theta$, is derived from an estimating equation that sets a weighted sum of the differences in risks to zero across strata. Let $p_{1\\ell} = \\Pr(Y=1 \\mid A=1, L=\\ell)$ and $p_{0\\ell} = \\Pr(Y=1 \\mid A=0, L=\\ell)$. Assuming a common risk ratio $\\theta$, we have $p_{1\\ell} = \\theta p_{0\\ell}$, or $p_{1\\ell} - \\theta p_{0\\ell} = 0$. The MH method uses stratum-specific weights $w_{\\ell} = \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}}$ and sets the weighted sum of sample-based differences to zero:\n$$ \\sum_{\\ell} w_{\\ell} (\\hat{p}_{1\\ell} - \\hat{\\theta}_{\\text{MH}} \\hat{p}_{0\\ell}) = 0 $$\nwhere $\\hat{p}_{1\\ell} = a_{\\ell}/n_{1\\ell}$ and $\\hat{p}_{0\\ell} = c_{\\ell}/n_{0\\ell}$. Solving for $\\hat{\\theta}_{\\text{MH}}$:\n$$ \\hat{\\theta}_{\\text{MH}} \\sum_{\\ell} w_{\\ell} \\hat{p}_{0\\ell} = \\sum_{\\ell} w_{\\ell} \\hat{p}_{1\\ell} $$\n$$ \\hat{\\theta}_{\\text{MH}} = \\frac{\\sum_{\\ell} w_{\\ell} (a_{\\ell}/n_{1\\ell})}{\\sum_{\\ell} w_{\\ell} (c_{\\ell}/n_{0\\ell})} $$\nSubstituting the expression for the weight $w_{\\ell}$:\n$$ \\hat{\\theta}_{\\text{MH}} = \\frac{\\sum_{\\ell} \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}} \\frac{a_{\\ell}}{n_{1\\ell}}}{\\sum_{\\ell} \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}} \\frac{c_{\\ell}}{n_{0\\ell}}} = \\frac{\\sum_{\\ell} a_{\\ell} n_{0\\ell} / n_{\\ell}}{\\sum_{\\ell} c_{\\ell} n_{1\\ell} / n_{\\ell}} $$\nThis is the expression for the Mantel-Haenszel risk ratio estimator, $\\hat{\\text{RR}}_{\\text{MH}}$.\n\nNow, we compute its value using the given data.\nThe components are:\n-   Summand for numerator, $L=0$: $a_{0} n_{00} / n_{0} = 10 \\times 200 / 300 = 20/3$.\n-   Summand for numerator, $L=1$: $a_{1} n_{01} / n_{1} = 20 \\times 50 / 100 = 10$.\n-   Summand for denominator, $L=0$: $c_{0} n_{10} / n_{0} = 10 \\times 100 / 300 = 10/3$.\n-   Summand for denominator, $L=1$: $c_{1} n_{11} / n_{1} = 10 \\times 50 / 100 = 5$.\n\nThe estimator is:\n$$ \\hat{\\text{RR}}_{\\text{MH}} = \\frac{ \\frac{20}{3} + 10 }{ \\frac{10}{3} + 5 } = \\frac{ \\frac{20+30}{3} }{ \\frac{10+15}{3} } = \\frac{ 50/3 }{ 25/3 } = \\frac{50}{25} = 2 $$\n\n**Part 5: Expected Value of the Mantel-Haenszel Risk Ratio Estimator**\n\nWe are asked to derive the expected value of $\\hat{\\text{RR}}_{\\text{MH}}$ in large samples under the assumption of a common risk ratio $\\theta$ across strata and the specified causal identification conditions.\nThe estimator is $\\hat{\\text{RR}}_{\\text{MH}} = \\frac{\\sum_{\\ell} (a_{\\ell}/n_{1\\ell}) w_{\\ell}}{\\sum_{\\ell} (c_{\\ell}/n_{0\\ell}) w_{\\ell}}$, where $w_{\\ell} = \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}}$. Let $\\hat{p}_{1\\ell} = a_{\\ell}/n_{1\\ell}$ and $\\hat{p}_{0\\ell} = c_{\\ell}/n_{0\\ell}$.\nIn large samples, where the stratum-specific sample sizes $n_{1\\ell}$ and $n_{0\\ell}$ tend to infinity, the sample risks converge in probability to the true population risks by the Law of Large Numbers:\n$$ \\hat{p}_{1\\ell} \\xrightarrow{p} p_{1\\ell} = \\Pr(Y=1 \\mid A=1, L=\\ell) $$\n$$ \\hat{p}_{0\\ell} \\xrightarrow{p} p_{0\\ell} = \\Pr(Y=1 \\mid A=0, L=\\ell) $$\nThe weights $w_{\\ell}$ are constants determined by the stratum sizes. By the Continuous Mapping Theorem, the estimator $\\hat{\\text{RR}}_{\\text{MH}}$, being a continuous function of these sample risks, converges in probability to the same function of the true risks:\n$$ \\hat{\\text{RR}}_{\\text{MH}} \\xrightarrow{p} \\frac{\\sum_{\\ell} p_{1\\ell} w_{\\ell}}{\\sum_{\\ell} p_{0\\ell} w_{\\ell}} $$\nWe are given the assumption that the risk ratio is constant across strata, i.e., $p_{1\\ell} = \\theta p_{0\\ell}$ for all $\\ell$. Substituting this into the expression for the limit:\n$$ \\hat{\\text{RR}}_{\\text{MH}} \\xrightarrow{p} \\frac{\\sum_{\\ell} (\\theta p_{0\\ell}) w_{\\ell}}{\\sum_{\\ell} p_{0\\ell} w_{\\ell}} = \\frac{\\theta \\sum_{\\ell} p_{0\\ell} w_{\\ell}}{\\sum_{\\ell} p_{0\\ell} w_{\\ell}} $$\nUnder the positivity assumption, we have subjects in each exposure and stratum level, ensuring $w_{\\ell} > 0$. We also assume that not all baseline risks $p_{0\\ell}$ are zero, so the sum $\\sum_{\\ell} p_{0\\ell} w_{\\ell}$ is non-zero. Thus, we can cancel the sum:\n$$ \\hat{\\text{RR}}_{\\text{MH}} \\xrightarrow{p} \\theta $$\nThis shows that the Mantel-Haenszel risk ratio estimator is a consistent estimator for the common risk ratio $\\theta$.\nThe phrase \"expected value in large samples\" refers to the asymptotic expectation, $\\lim_{N \\to \\infty} E[\\hat{\\text{RR}}_{\\text{MH}}]$. Since the estimator is a ratio of averages of bounded random variables (risks are in $[0,1]$), and thus is bounded itself (assuming positivity), the Dominated Convergence Theorem applies. This allows the interchange of the limit and expectation operators:\n$$ \\lim_{N \\to \\infty} E[\\hat{\\text{RR}}_{\\text{MH}}] = E[\\lim_{N \\to \\infty} \\hat{\\text{RR}}_{\\text{MH}}] = E[\\theta] $$\nSince $\\theta$ is a constant parameter, its expectation is itself. Therefore, the large-sample expected value of the estimator is $\\theta$.\nThe causal assumptions (consistency, conditional exchangeability, positivity) ensure that this associational parameter $\\theta$ is equal to the causal risk ratio $\\text{RR}=\\Pr(Y^{1}=1)/\\Pr(Y^{0}=1)$, because under these assumptions and a constant RR, $\\text{RR} = \\frac{\\sum_{\\ell} p_{1\\ell} \\Pr(L=\\ell)}{\\sum_{\\ell} p_{0\\ell} \\Pr(L=\\ell)} = \\frac{\\sum_{\\ell} \\theta p_{0\\ell} \\Pr(L=\\ell)}{\\sum_{\\ell} p_{0\\ell} \\Pr(L=\\ell)} = \\theta$.\nThus, the large-sample expected value of the Mantel-Haenszel estimator is $\\theta$.", "answer": "$$ \\boxed{\\theta} $$", "id": "4582728"}, {"introduction": "A crucial and often counterintuitive aspect of causal inference is knowing which variables *not* to adjust for. This exercise provides a concrete numerical demonstration of collider bias, a phenomenon where conditioning on a common *effect* of the exposure and outcome paradoxically introduces bias rather than removing it. By working through the calculations, you will see how an adjustment that seems intuitive can lead to conclusions that are not only wrong but in the opposite direction of the truth. [@problem_id:4582718]", "problem": "Consider a binary exposure $A \\in \\{0,1\\}$, a binary outcome $Y \\in \\{0,1\\}$, and a binary variable $C \\in \\{0,1\\}$ that is affected by both $A$ and $Y$. Suppose the target causal estimand is the marginal risk difference, defined as $P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0)$. You are given the following scientifically plausible data-generating mechanism:\n- Baseline outcome risks by exposure: $P(Y=1 \\mid A=1) = 0.30$ and $P(Y=1 \\mid A=0) = 0.20$.\n- Selection mechanism for $C$ (a common effect of $A$ and $Y$): \n  - $P(C=1 \\mid A=1, Y=1) = 0.05$, \n  - $P(C=1 \\mid A=1, Y=0) = 0.95$, \n  - $P(C=1 \\mid A=0, Y=1) = 0.95$, \n  - $P(C=1 \\mid A=0, Y=0) = 0.05$.\n\nStarting from fundamental definitions of probability, the law of total probability, and the definition of the risk difference, compute the conditional risk difference within the stratum $C=1$, namely\n$$\\text{RD}_{C=1} \\equiv P(Y=1 \\mid A=1, C=1) - P(Y=1 \\mid A=0, C=1).$$\nExpress your final answer as a decimal and round to four significant figures. No percentage signs are permitted.", "solution": "The problem is valid as it is scientifically grounded in the principles of probability theory and epidemiology, is well-posed with all necessary information provided for a unique solution, and is stated in objective, formal language. There are no contradictions, ambiguities, or factual errors. The problem describes a classic scenario of collider-stratification bias, a core concept in causal inference.\n\nThe objective is to compute the conditional risk difference within the stratum where the variable $C$ is equal to $1$, denoted $\\text{RD}_{C=1}$. This is defined as:\n$$ \\text{RD}_{C=1} = P(Y=1 \\mid A=1, C=1) - P(Y=1 \\mid A=0, C=1) $$\nWe will compute each of the two conditional probabilities on the right-hand side separately using the provided data and fundamental principles of probability.\n\nThe given probabilities are:\n- $P(Y=1 \\mid A=1) = 0.30$\n- $P(Y=1 \\mid A=0) = 0.20$\n- $P(C=1 \\mid A=1, Y=1) = 0.05$\n- $P(C=1 \\mid A=1, Y=0) = 0.95$\n- $P(C=1 \\mid A=0, Y=1) = 0.95$\n- $P(C=1 \\mid A=0, Y=0) = 0.05$\n\nFrom the given probabilities for the outcome $Y$, we can deduce the complementary probabilities:\n- $P(Y=0 \\mid A=1) = 1 - P(Y=1 \\mid A=1) = 1 - 0.30 = 0.70$\n- $P(Y=0 \\mid A=0) = 1 - P(Y=1 \\mid A=0) = 1 - 0.20 = 0.80$\n\nFirst, let us calculate the term $P(Y=1 \\mid A=1, C=1)$. We apply Bayes' theorem for conditional events:\n$$ P(Y=1 \\mid A=1, C=1) = \\frac{P(C=1 \\mid A=1, Y=1) P(Y=1 \\mid A=1)}{P(C=1 \\mid A=1)} $$\nThe numerator is calculated by substituting the given values:\n$$ \\text{Numerator}_1 = P(C=1 \\mid A=1, Y=1) P(Y=1 \\mid A=1) = (0.05)(0.30) = 0.015 $$\nThe denominator, $P(C=1 \\mid A=1)$, can be found using the law of total probability, by marginalizing over the variable $Y$:\n$$ P(C=1 \\mid A=1) = P(C=1 \\mid A=1, Y=1)P(Y=1 \\mid A=1) + P(C=1 \\mid A=1, Y=0)P(Y=0 \\mid A=1) $$\nSubstituting the known and derived values:\n$$ P(C=1 \\mid A=1) = (0.05)(0.30) + (0.95)(0.70) = 0.015 + 0.665 = 0.680 $$\nNow, we can compute the first term of the risk difference:\n$$ P(Y=1 \\mid A=1, C=1) = \\frac{0.015}{0.680} = \\frac{15}{680} = \\frac{3}{136} $$\n\nNext, we calculate the second term, $P(Y=1 \\mid A=0, C=1)$. We again apply Bayes' theorem:\n$$ P(Y=1 \\mid A=0, C=1) = \\frac{P(C=1 \\mid A=0, Y=1) P(Y=1 \\mid A=0)}{P(C=1 \\mid A=0)} $$\nThe numerator is:\n$$ \\text{Numerator}_2 = P(C=1 \\mid A=0, Y=1) P(Y=1 \\mid A=0) = (0.95)(0.20) = 0.190 $$\nThe denominator, $P(C=1 \\mid A=0)$, is found using the law of total probability:\n$$ P(C=1 \\mid A=0) = P(C=1 \\mid A=0, Y=1)P(Y=1 \\mid A=0) + P(C=1 \\mid A=0, Y=0)P(Y=0 \\mid A=0) $$\nSubstituting the known and derived values:\n$$ P(C=1 \\mid A=0) = (0.95)(0.20) + (0.05)(0.80) = 0.190 + 0.040 = 0.230 $$\nNow, we can compute the second term of the risk difference:\n$$ P(Y=1 \\mid A=0, C=1) = \\frac{0.190}{0.230} = \\frac{19}{23} $$\n\nFinally, we compute the conditional risk difference, $\\text{RD}_{C=1}$:\n$$ \\text{RD}_{C=1} = P(Y=1 \\mid A=1, C=1) - P(Y=1 \\mid A=0, C=1) = \\frac{3}{136} - \\frac{19}{23} $$\nTo find the numerical value, we convert the fractions to decimals:\n$$ \\frac{3}{136} \\approx 0.0220588... $$\n$$ \\frac{19}{23} \\approx 0.8260869... $$\n$$ \\text{RD}_{C=1} \\approx 0.0220588 - 0.8260869 = -0.8040281 $$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $8$, $0$, $4$, and $0$. The fifth digit is $2$, so we round down.\n$$ \\text{RD}_{C=1} \\approx -0.8040 $$\nThis result demonstrates collider bias. The marginal risk difference is positive: $P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0) = 0.30 - 0.20 = 0.10$. However, after conditioning on the common effect (collider) $C$, the association between $A$ and $Y$ is not only distorted but its direction is reversed, becoming strongly negative.", "answer": "$$\\boxed{-0.8040}$$", "id": "4582718"}]}