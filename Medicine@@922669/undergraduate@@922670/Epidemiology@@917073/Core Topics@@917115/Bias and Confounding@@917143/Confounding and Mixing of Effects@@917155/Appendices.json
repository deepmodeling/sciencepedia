{"hands_on_practices": [{"introduction": "Understanding confounding begins with seeing it in action. This first exercise presents a classic scenario related to Simpson's Paradox, where a measure of association appears to point in one direction for the overall population but in the opposite direction within specific subgroups [@problem_id:4580916]. By calculating both the crude and stratum-specific risk ratios from a hypothetical dataset, you will gain a concrete understanding of how a third variable can distort an exposure-outcome relationship, underscoring the critical need for stratification and other adjustment techniques.", "problem": "An epidemiologist is studying the association between exposure to a medication and a binary health outcome in a cohort, concerned that age may act as a confounder. Consider a hypothetical dataset that has been constructed with two age strata to illustrate mixing of effects and confounding. The counts are as follows.\n\nStratum $1$ (younger): among the exposed, $3$ cases out of $300$ exposed individuals; among the unexposed, $2$ cases out of $400$ unexposed individuals.\n\nStratum $2$ (older): among the exposed, $85$ cases out of $100$ exposed individuals; among the unexposed, $160$ cases out of $200$ unexposed individuals.\n\nStarting exclusively from core definitions—risk as the probability of the outcome within an exposure group, the risk ratio as the ratio of risks between exposed and unexposed, and the law of total probability for stratified populations—compute:\n\n1. The crude risk ratio across both strata combined.\n2. The stratum-specific risk ratio in stratum $1$.\n3. The stratum-specific risk ratio in stratum $2$.\n\nReport the three risk ratios as decimal numbers rounded to four significant figures, in the order: crude risk ratio, stratum $1$ risk ratio, stratum $2$ risk ratio. Express the final answer with no units.", "solution": "The problem is deemed valid as it is scientifically grounded in epidemiological principles, well-posed with sufficient data, and objective in its formulation. We will proceed with the calculations as requested.\n\nLet $E$ denote the event of being exposed to the medication and $\\bar{E}$ denote the event of being unexposed. Let $D$ be the event of having the health outcome (being a case). Let $S_1$ and $S_2$ denote being in stratum $1$ (younger) and stratum $2$ (older), respectively.\n\nThe risk within a group is defined as the probability of the outcome within that group. The risk in the exposed group is $R_E = P(D|E)$, and the risk in the unexposed group is $R_{\\bar{E}} = P(D|\\bar{E})$. The risk ratio ($RR$) is the ratio of these two risks: $RR = \\frac{R_E}{R_{\\bar{E}}}$.\n\nThe data provided can be summarized as follows:\nStratum $1$ ($S_1$):\n- Exposed ($E$): $3$ cases, $N_{E,1} = 300$ total.\n- Unexposed ($\\bar{E}$): $2$ cases, $N_{\\bar{E},1} = 400$ total.\n\nStratum $2$ ($S_2$):\n- Exposed ($E$): $85$ cases, $N_{E,2} = 100$ total.\n- Unexposed ($\\bar{E}$): $160$ cases, $N_{\\bar{E},2} = 200$ total.\n\n1. Computation of the Crude Risk Ratio ($RR_{crude}$)\nTo compute the crude risk ratio, we first aggregate the data from both strata.\n\nTotal number of exposed individuals across both strata:\n$$ N_E = N_{E,1} + N_{E,2} = 300 + 100 = 400 $$\nTotal number of cases among the exposed:\n$$ \\text{Cases}_E = \\text{Cases}_{E,1} + \\text{Cases}_{E,2} = 3 + 85 = 88 $$\nThe crude risk in the exposed group is:\n$$ R_{E,crude} = P(D|E) = \\frac{\\text{Total cases among exposed}}{\\text{Total exposed}} = \\frac{88}{400} = 0.22 $$\n\nTotal number of unexposed individuals across both strata:\n$$ N_{\\bar{E}} = N_{\\bar{E},1} + N_{\\bar{E},2} = 400 + 200 = 600 $$\nTotal number of cases among the unexposed:\n$$ \\text{Cases}_{\\bar{E}} = \\text{Cases}_{\\bar{E},1} + \\text{Cases}_{\\bar{E},2} = 2 + 160 = 162 $$\nThe crude risk in the unexposed group is:\n$$ R_{\\bar{E},crude} = P(D|\\bar{E}) = \\frac{\\text{Total cases among unexposed}}{\\text{Total unexposed}} = \\frac{162}{600} = 0.27 $$\n\nThe crude risk ratio is the ratio of these crude risks:\n$$ RR_{crude} = \\frac{R_{E,crude}}{R_{\\bar{E},crude}} = \\frac{0.22}{0.27} = \\frac{22}{27} \\approx 0.8148148... $$\nRounding to four significant figures, we get $RR_{crude} = 0.8148$.\n\n2. Computation of the Stratum-Specific Risk Ratio in Stratum $1$ ($RR_1$)\nFor this calculation, we only use the data from stratum $1$.\n\nThe risk in the exposed group in stratum $1$:\n$$ R_{E,1} = P(D|E, S_1) = \\frac{\\text{Cases}_{E,1}}{N_{E,1}} = \\frac{3}{300} = 0.01 $$\nThe risk in the unexposed group in stratum $1$:\n$$ R_{\\bar{E},1} = P(D|\\bar{E}, S_1) = \\frac{\\text{Cases}_{\\bar{E},1}}{N_{\\bar{E},1}} = \\frac{2}{400} = 0.005 $$\nThe stratum-specific risk ratio for stratum $1$ is:\n$$ RR_1 = \\frac{R_{E,1}}{R_{\\bar{E},1}} = \\frac{0.01}{0.005} = 2.0 $$\nTo four significant figures, this is $2.000$.\n\n3. Computation of the Stratum-Specific Risk Ratio in Stratum $2$ ($RR_2$)\nFor this calculation, we only use the data from stratum $2$.\n\nThe risk in the exposed group in stratum $2$:\n$$ R_{E,2} = P(D|E, S_2) = \\frac{\\text{Cases}_{E,2}}{N_{E,2}} = \\frac{85}{100} = 0.85 $$\nThe risk in the unexposed group in stratum $2$:\n$$ R_{\\bar{E},2} = P(D|\\bar{E}, S_2) = \\frac{\\text{Cases}_{\\bar{E},2}}{N_{\\bar{E},2}} = \\frac{160}{200} = 0.80 $$\nThe stratum-specific risk ratio for stratum $2$ is:\n$$ RR_2 = \\frac{R_{E,2}}{R_{\\bar{E},2}} = \\frac{0.85}{0.80} = 1.0625 $$\nRounding to four significant figures, we get $RR_2 = 1.063$.\n\nThe three requested risk ratios, rounded to four significant figures, are:\n- Crude risk ratio: $0.8148$\n- Stratum $1$ risk ratio: $2.000$\n- Stratum $2$ risk ratio: $1.063$", "answer": "$$\\boxed{\\begin{pmatrix} 0.8148 & 2.000 & 1.063 \\end{pmatrix}}$$", "id": "4580916"}, {"introduction": "Once confounding is identified, the next step is to control for it. This practice introduces standardization, a powerful and intuitive method for obtaining a confounder-adjusted estimate of effect [@problem_id:4580949]. You will calculate a standardized risk difference by applying stratum-specific risks to a target population's distribution, effectively creating a summary measure that is adjusted for the confounder. This exercise provides direct experience with a core technique used to ensure fair comparisons in epidemiological studies.", "problem": "Consider a cohort study of one-year cumulative incidence of a binary outcome $Y$ (incident disease within one year) comparing an exposure $X$ (exposed $X=1$ versus unexposed $X=0$). Let $Z$ denote a categorical potential confounder with three strata: $z_{1}$ (younger), $z_{2}$ (middle), and $z_{3}$ (older). The stratum-specific one-year risks are measured without error and are as follows:\n- For $z_{1}$: $E[Y \\mid X=1, Z=z_{1}] = 0.08$ and $E[Y \\mid X=0, Z=z_{1}] = 0.04$.\n- For $z_{2}$: $E[Y \\mid X=1, Z=z_{2}] = 0.12$ and $E[Y \\mid X=0, Z=z_{2}] = 0.10$.\n- For $z_{3}$: $E[Y \\mid X=1, Z=z_{3}] = 0.20$ and $E[Y \\mid X=0, Z=z_{3}] = 0.15$.\n\nSuppose you wish to standardize to a target population in which the distribution of $Z$ is given by $P^{*}(Z=z_{1}) = 0.50$, $P^{*}(Z=z_{2}) = 0.30$, and $P^{*}(Z=z_{3}) = 0.20$, motivated by concerns about confounding and mixing of effects across strata. Define the standardized risk difference (RD) to this target as the difference in the target-standardized risks under $X=1$ versus $X=0$, each constructed by averaging the stratum-specific risks over the target distribution $P^{*}(Z)$.\n\nCompute the target-standardized risk difference. Express your final answer as a decimal (no percentage sign). If rounding is needed, round to four significant figures.", "solution": "The problem requires the computation of a target-standardized risk difference. This is a standard epidemiological method to adjust for confounding, ensuring that the comparison between the exposed and unexposed groups is not distorted by differences in the distribution of the confounding variable $Z$.\n\nLet $Y$ be the binary outcome variable, where $Y=1$ indicates the occurrence of the disease and $Y=0$ indicates its absence. Let $X$ be the binary exposure variable, with $X=1$ for the exposed group and $X=0$ for the unexposed group. Let $Z$ be a categorical potential confounder with three levels, or strata: $z_1$ (younger), $z_2$ (middle), and $z_3$ (older).\n\nThe stratum-specific one-year risks are provided as conditional expectations, $E[Y \\mid X=x, Z=z_j]$. For a binary outcome $Y$, this is equivalent to the conditional probability $P(Y=1 \\mid X=x, Z=z_j)$. Let us denote this risk as $R_{xj}$. The provided data are:\n- For stratum $z_1$: $R_{11} = P(Y=1 \\mid X=1, Z=z_1) = 0.08$ and $R_{01} = P(Y=1 \\mid X=0, Z=z_1) = 0.04$.\n- For stratum $z_2$: $R_{12} = P(Y=1 \\mid X=1, Z=z_2) = 0.12$ and $R_{02} = P(Y=1 \\mid X=0, Z=z_2) = 0.10$.\n- For stratum $z_3$: $R_{13} = P(Y=1 \\mid X=1, Z=z_3) = 0.20$ and $R_{03} = P(Y=1 \\mid X=0, Z=z_3) = 0.15$.\n\nThe standardization is to be performed with respect to a target population where the distribution of $Z$ is given by $P^*(Z)$. Let $w_j = P^*(Z=z_j)$ be the weight for each stratum. The given weights are:\n- $w_1 = P^*(Z=z_1) = 0.50$\n- $w_2 = P^*(Z=z_2) = 0.30$\n- $w_3 = P^*(Z=z_3) = 0.20$\nThe sum of these weights is $0.50 + 0.30 + 0.20 = 1.00$, which confirms it is a valid probability distribution.\n\nThe standardized risk for a given exposure level $x$, which we can denote $R^*_x$, is calculated by taking the weighted average of the stratum-specific risks $R_{xj}$ over the distribution of $Z$ in the target population.\n$$R^*_x = \\sum_{j=1}^{3} R_{xj} \\cdot w_j$$\n\nFirst, we calculate the standardized risk for the exposed group ($x=1$), denoted $R^*_1$:\n$$R^*_1 = R_{11} \\cdot w_1 + R_{12} \\cdot w_2 + R_{13} \\cdot w_3$$\nSubstituting the given values:\n$$R^*_1 = (0.08)(0.50) + (0.12)(0.30) + (0.20)(0.20)$$\n$$R^*_1 = 0.040 + 0.036 + 0.040$$\n$$R^*_1 = 0.116$$\n\nNext, we calculate the standardized risk for the unexposed group ($x=0$), denoted $R^*_0$:\n$$R^*_0 = R_{01} \\cdot w_1 + R_{02} \\cdot w_2 + R_{03} \\cdot w_3$$\nSubstituting the given values:\n$$R^*_0 = (0.04)(0.50) + (0.10)(0.30) + (0.15)(0.20)$$\n$$R^*_0 = 0.020 + 0.030 + 0.030$$\n$$R^*_0 = 0.080$$\n\nThe target-standardized risk difference, $RD_{\\text{std}}^*$, is the difference between the standardized risk in the exposed group and the standardized risk in the unexposed group.\n$$RD_{\\text{std}}^* = R^*_1 - R^*_0$$\nPlugging in the calculated standardized risks:\n$$RD_{\\text{std}}^* = 0.116 - 0.080$$\n$$RD_{\\text{std}}^* = 0.036$$\nThe result is an exact decimal, so no rounding is necessary.", "answer": "$$\\boxed{0.036}$$", "id": "4580949"}, {"introduction": "While adjusting for confounders is essential, adjusting for the wrong variable can be just as problematic. This exercise explores the subtle but critical concept of collider bias, a type of bias that is *created* by conditioning on a variable that is a common effect of both the exposure and another cause of the outcome [@problem_id:4580964]. By working through a hypothetical data-generating process, you will see how adjusting for a collider can distort a true causal effect, even reversing its direction. This practice is crucial for developing the sophisticated judgment needed to select appropriate covariates for statistical adjustment.", "problem": "An investigator is studying the causal effect of an exposure on a continuous health outcome in a source population. Let the exposure be denoted by $X$, the outcome by $Y$, an unmeasured factor by $U$, and a downstream variable that is influenced by both $X$ and $U$ (a collider) by $C$. Assume the following linear-Gaussian data-generating process at the population level:\n1. $X \\sim \\mathcal{N}(0,1)$ and $U \\sim \\mathcal{N}(0,1)$ with $X \\perp U$.\n2. $e_{c} \\sim \\mathcal{N}(0,\\sigma_{c}^{2})$ and $e_{y} \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$, with $e_{c} \\perp e_{y}$ and both independent of $(X,U)$.\n3. $C = a X + b U + e_{c}$.\n4. $Y = \\beta X + d U + e_{y}$.\n\nThese structural relations encode that $C$ is a collider on the noncausal path $X \\to C \\leftarrow U \\to Y$. The investigator fits an ordinary least squares regression of $Y$ on $X$ and $C$ and reports the population coefficient on $X$ (i.e., the coefficient that minimizes the population mean squared prediction error under the linear model). Use the parameter values $a = 1$, $b = 1$, $\\beta = 0.2$, $d = 0.8$, $\\sigma_{c}^{2} = 0.01$, and $\\sigma_{y}^{2} = 1$.\n\nCompute the population ordinary least squares coefficient on $X$ in the multiple regression of $Y$ on $(X,C)$. Report your final numerical answer rounded to $4$ significant figures. No units are required.", "solution": "The objective is to compute the population ordinary least squares (OLS) coefficient for the exposure $X$ in a multiple linear regression of the outcome $Y$ on the predictors $(X, C)$. Let the vector of predictors be $\\mathbf{V} = \\begin{pmatrix} X \\\\ C \\end{pmatrix}$. We are seeking the coefficient $\\gamma_X$ in the population model $Y = \\gamma_0 + \\gamma_X X + \\gamma_C C + \\epsilon$.\n\nThe vector of population OLS coefficients, $\\boldsymbol{\\gamma} = \\begin{pmatrix} \\gamma_X \\\\ \\gamma_C \\end{pmatrix}$, for a regression of $Y$ on $\\mathbf{V}$ (excluding the intercept) is given by the formula:\n$$ \\boldsymbol{\\gamma} = (\\mathbb{E}[\\mathbf{V}\\mathbf{V}^T])^{-1} \\mathbb{E}[\\mathbf{V}Y] $$\nThis formula is applicable for centered variables (i.e., variables with a mean of zero). We first verify this condition for the variables involved.\nGiven $X \\sim \\mathcal{N}(0,1)$ and $U \\sim \\mathcal{N}(0,1)$, their expectations are $\\mathbb{E}[X]=0$ and $\\mathbb{E}[U]=0$. The noise terms $e_c \\sim \\mathcal{N}(0,\\sigma_{c}^{2})$ and $e_y \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$ also have zero expectation.\nThe expectation of the collider $C$ is:\n$$ \\mathbb{E}[C] = \\mathbb{E}[a X + b U + e_{c}] = a\\mathbb{E}[X] + b\\mathbb{E}[U] + \\mathbb{E}[e_{c}] = a(0) + b(0) + 0 = 0 $$\nThe expectation of the outcome $Y$ is:\n$$ \\mathbb{E}[Y] = \\mathbb{E}[\\beta X + d U + e_{y}] = \\beta\\mathbb{E}[X] + d\\mathbb{E}[U] + \\mathbb{E}[e_{y}] = \\beta(0) + d(0) + 0 = 0 $$\nSince all variables $X, C, Y$ are centered, the formula holds and the intercept $\\gamma_0$ is zero. The matrices in the formula are the covariance matrix of the predictors and the vector of covariances between the predictors and the outcome.\n$$ \\mathbb{E}[\\mathbf{V}\\mathbf{V}^T] = \\Sigma_{\\mathbf{VV}} = \\begin{pmatrix} \\text{Var}(X) & \\text{Cov}(X,C) \\\\ \\text{Cov}(C,X) & \\text{Var}(C) \\end{pmatrix} $$\n$$ \\mathbb{E}[\\mathbf{V}Y] = \\Sigma_{\\mathbf{V}Y} = \\begin{pmatrix} \\text{Cov}(X,Y) \\\\ \\text{Cov}(C,Y) \\end{pmatrix} $$\nWe now compute each component of these matrices using the given data-generating process and independence assumptions ($X \\perp U$, $e_c \\perp e_y$, and $(e_c, e_y) \\perp (X,U)$).\n\n1.  $\\text{Var}(X)$: Given $X \\sim \\mathcal{N}(0,1)$, $\\text{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = 1 - 0^2 = 1$.\n\n2.  $\\text{Cov}(X,C)$:\n    $$ \\text{Cov}(X,C) = \\mathbb{E}[XC] = \\mathbb{E}[X(aX + bU + e_c)] = a\\mathbb{E}[X^2] + b\\mathbb{E}[XU] + \\mathbb{E}[Xe_c] $$\n    Due to independence, $\\mathbb{E}[XU] = \\mathbb{E}[X]\\mathbb{E}[U] = 0$ and $\\mathbb{E}[Xe_c] = \\mathbb{E}[X]\\mathbb{E}[e_c] = 0$.\n    $$ \\text{Cov}(X,C) = a\\mathbb{E}[X^2] = a(1) = a $$\n\n3.  $\\text{Var}(C)$:\n    $$ \\text{Var}(C) = \\text{Var}(aX + bU + e_c) $$\n    Since $X, U, e_c$ are mutually independent, the variance of the sum is the sum of variances:\n    $$ \\text{Var}(C) = a^2\\text{Var}(X) + b^2\\text{Var}(U) + \\text{Var}(e_c) = a^2(1) + b^2(1) + \\sigma_c^2 = a^2 + b^2 + \\sigma_c^2 $$\n\n4.  $\\text{Cov}(X,Y)$:\n    $$ \\text{Cov}(X,Y) = \\mathbb{E}[XY] = \\mathbb{E}[X(\\beta X + dU + e_y)] = \\beta\\mathbb{E}[X^2] + d\\mathbb{E}[XU] + \\mathbb{E}[Xe_y] $$\n    Due to independence, $\\mathbb{E}[XU]=0$ and $\\mathbb{E}[Xe_y]=0$.\n    $$ \\text{Cov}(X,Y) = \\beta\\mathbb{E}[X^2] = \\beta(1) = \\beta $$\n\n5.  $\\text{Cov}(C,Y)$:\n    $$ \\text{Cov}(C,Y) = \\mathbb{E}[CY] = \\mathbb{E}[(aX + bU + e_c)(\\beta X + dU + e_y)] $$\n    Expanding the product and taking the expectation, only terms with non-independent variables or squared variables will be non-zero. The non-zero expectation terms are $\\mathbb{E}[X^2]$ and $\\mathbb{E}[U^2]$:\n    $$ \\text{Cov}(C,Y) = a\\beta\\mathbb{E}[X^2] + bd\\mathbb{E}[U^2] = a\\beta(1) + bd(1) = a\\beta + bd $$\n\nNow, we assemble the matrices:\n$$ \\Sigma_{\\mathbf{VV}} = \\begin{pmatrix} 1 & a \\\\ a & a^2+b^2+\\sigma_c^2 \\end{pmatrix} $$\n$$ \\Sigma_{\\mathbf{V}Y} = \\begin{pmatrix} \\beta \\\\ a\\beta+bd \\end{pmatrix} $$\n\nNext, we find the inverse of $\\Sigma_{\\mathbf{VV}}$. The determinant is $\\det(\\Sigma_{\\mathbf{VV}}) = (1)(a^2+b^2+\\sigma_c^2) - (a)(a) = b^2+\\sigma_c^2$.\nThe inverse is:\n$$ \\Sigma_{\\mathbf{VV}}^{-1} = \\frac{1}{b^2+\\sigma_c^2} \\begin{pmatrix} a^2+b^2+\\sigma_c^2 & -a \\\\ -a & 1 \\end{pmatrix} $$\n\nWe can now compute the coefficient vector $\\boldsymbol{\\gamma}$:\n$$ \\begin{pmatrix} \\gamma_X \\\\ \\gamma_C \\end{pmatrix} = \\frac{1}{b^2+\\sigma_c^2} \\begin{pmatrix} a^2+b^2+\\sigma_c^2 & -a \\\\ -a & 1 \\end{pmatrix} \\begin{pmatrix} \\beta \\\\ a\\beta+bd \\end{pmatrix} $$\nWe only need to calculate the top element of the resulting vector, which corresponds to $\\gamma_X$:\n$$ \\gamma_X = \\frac{1}{b^2+\\sigma_c^2} \\left[ (a^2+b^2+\\sigma_c^2)\\beta - a(a\\beta+bd) \\right] $$\n$$ \\gamma_X = \\frac{1}{b^2+\\sigma_c^2} \\left[ a^2\\beta + b^2\\beta + \\sigma_c^2\\beta - a^2\\beta - abd \\right] $$\nThe $a^2\\beta$ terms cancel out:\n$$ \\gamma_X = \\frac{ b^2\\beta + \\sigma_c^2\\beta - abd }{b^2+\\sigma_c^2} $$\n$$ \\gamma_X = \\frac{ (b^2+\\sigma_c^2)\\beta - abd }{b^2+\\sigma_c^2} = \\beta - \\frac{abd}{b^2+\\sigma_c^2} $$\nThis expression reveals that the OLS coefficient $\\gamma_X$ is equal to the true causal effect $\\beta$ plus a bias term, $-\\frac{abd}{b^2+\\sigma_c^2}$. This bias results from conditioning on the collider $C$, which opens a non-causal path between $X$ and $Y$ through $U$.\n\nFinally, we substitute the given parameter values into the derived expression:\n$a = 1$, $b = 1$, $\\beta = 0.2$, $d = 0.8$, and $\\sigma_{c}^{2} = 0.01$.\n$$ \\gamma_X = 0.2 - \\frac{(1)(1)(0.8)}{1^2 + 0.01} $$\n$$ \\gamma_X = 0.2 - \\frac{0.8}{1 + 0.01} $$\n$$ \\gamma_X = 0.2 - \\frac{0.8}{1.01} $$\n$$ \\gamma_X = 0.2 - 0.79207920... $$\n$$ \\gamma_X = -0.59207920... $$\nThe problem requires the answer to be rounded to $4$ significant figures. The fifth significant digit is $7$, so we round up the fourth.\n$$ \\gamma_X \\approx -0.5921 $$", "answer": "$$\\boxed{-0.5921}$$", "id": "4580964"}]}