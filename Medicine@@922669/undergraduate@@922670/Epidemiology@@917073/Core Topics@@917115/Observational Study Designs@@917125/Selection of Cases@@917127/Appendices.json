{"hands_on_practices": [{"introduction": "In public health, a crucial first step is to determine the extent of a health problem, but it's often impossible to find every single case. The capture-recapture method offers a powerful statistical tool to estimate the total number of cases by comparing incomplete lists from different, independent sources. This exercise will guide you through the application of a bias-corrected estimator to assess the completeness of a surveillance system, a fundamental skill for evaluating public health data quality [@problem_id:4633812].", "problem": "A public health surveillance team conducts a two-source case-finding exercise for a defined, closed population over a short period to estimate the completeness of case ascertainment for a disease. Source $1$ ascertains $n_{1}=120$ cases, source $2$ ascertains $n_{2}=150$ cases, and there are $m=60$ matched cases common to both sources after record linkage. Assume the standard two-source capture–recapture framework applies: a closed population, independent sources, and equal catchability within the period. Define overall completeness as the proportion of all true cases that appear in at least one of the two sources. Starting from first principles of two-sample capture–recapture sampling under independence and without replacement, derive an estimator for the total number of true cases and then derive the corresponding estimator of overall completeness. Use a well-tested small-sample bias correction when estimating the total number of true cases. Compute the numerical value of completeness as a decimal and round your answer to four significant figures. Finally, briefly interpret whether additional sources would likely be needed if a programmatic target for completeness is at least $0.9$.", "solution": "The problem is assessed to be valid as it represents a standard application of capture-recapture methodology in epidemiology, is scientifically grounded, well-posed, and objective.\n\nThe problem asks for the derivation of an estimator for the total number of cases and overall completeness, its numerical computation, and an interpretation based on the results. We will proceed by first principles under the stated assumptions.\n\nLet $N$ be the total number of true cases in the closed population. Let $n_{1}$ be the number of cases ascertained by source $1$, and $n_{2}$ be the number of cases ascertained by source $2$. Let $m$ be the number of cases ascertained by both sources. The given values are $n_{1}=120$, $n_{2}=150$, and $m=60$.\n\nThe core assumptions are:\n1. The population of cases is closed (no entries or exits during the surveillance period).\n2. The two sources are independent. This means the probability of being captured by source $1$ is independent of the probability of being captured by source $2$.\n3. Each case has an equal probability of being captured by a given source (equal catchability).\n\nFrom first principles, the probability of a case being captured by source $1$ is estimated by $p_1 = \\frac{n_1}{N}$.\nSimilarly, the probability of a case being captured by source $2$ is estimated by $p_2 = \\frac{n_2}{N}$.\n\nUnder the independence assumption, the probability of a case being captured by both source $1$ and source $2$ is the product of the individual probabilities:\n$$p_{12} = p_1 \\times p_2 = \\left(\\frac{n_1}{N}\\right) \\left(\\frac{n_2}{N}\\right) = \\frac{n_1 n_2}{N^2}$$\nThe expected number of cases captured by both sources, $E[m]$, is the total number of cases $N$ multiplied by this joint probability:\n$$E[m] = N \\times p_{12} = N \\times \\frac{n_1 n_2}{N^2} = \\frac{n_1 n_2}{N}$$\nBy the method of moments, we can derive an estimator for $N$, denoted $\\hat{N}$, by equating the observed quantity $m$ with its expectation:\n$$m = \\frac{n_1 n_2}{\\hat{N}}$$\nSolving for $\\hat{N}$ yields the Lincoln-Petersen estimator, which is also the maximum likelihood estimator under this model:\n$$\\hat{N}_{LP} = \\frac{n_1 n_2}{m}$$\nThis estimator is known to be biased, particularly in small samples. The problem specifies the use of a well-tested small-sample bias correction. The standard choice is the Chapman estimator, which provides a nearly unbiased estimate for $N$. The Chapman estimator, $\\hat{N}_C$, is derived as:\n$$\\hat{N}_C = \\frac{(n_1 + 1)(n_2 + 1)}{m+1} - 1$$\nThis is the estimator for the total number of true cases we will use.\n\nNext, we derive the estimator for overall completeness. Overall completeness, $C$, is defined as the proportion of all true cases that appear in at least one of the two sources.\nThe total number of unique cases found by either source $1$ or source $2$ (or both) is given by the inclusion-exclusion principle:\n$$U = n_1 + n_2 - m$$\nThe completeness $C$ is the ratio of the number of unique cases found to the total number of true cases:\n$$C = \\frac{U}{N} = \\frac{n_1 + n_2 - m}{N}$$\nUsing our bias-corrected estimator for $N$, the corresponding estimator for completeness, $\\hat{C}$, is:\n$$\\hat{C} = \\frac{n_1 + n_2 - m}{\\hat{N}_C} = \\frac{n_1 + n_2 - m}{\\frac{(n_1 + 1)(n_2 + 1)}{m+1} - 1}$$\nNow, we compute the numerical value of this estimator using the given data: $n_{1}=120$, $n_{2}=150$, and $m=60$.\n\nFirst, we calculate the number of unique cases ascertained, $U$:\n$$U = 120 + 150 - 60 = 210$$\nNext, we calculate the estimated total number of cases, $\\hat{N}_C$:\n$$\\hat{N}_C = \\frac{(120 + 1)(150 + 1)}{60+1} - 1 = \\frac{121 \\times 151}{61} - 1 = \\frac{18271}{61} - 1$$\n$$\\hat{N}_C \\approx 299.52459 - 1 = 298.52459$$\nFinally, we calculate the estimated completeness, $\\hat{C}$:\n$$\\hat{C} = \\frac{U}{\\hat{N}_C} = \\frac{210}{298.52459} \\approx 0.7034633$$\nRounding to four significant figures, we get:\n$$\\hat{C} \\approx 0.7035$$\n\nFor the final part of the problem, we interpret this result. The estimated completeness of the two-source surveillance system is approximately $0.7035$, or $70.35\\%$. The programmatic target for completeness is at least $0.9$, or $90\\%$. Since $0.7035 < 0.9$, the current system's performance falls substantially short of the target. Therefore, to achieve the programmatic goal, it is highly likely that additional sources for case-finding would be needed to increase the overall proportion of cases ascertained.", "answer": "$$\\boxed{0.7035}$$", "id": "4633812"}, {"introduction": "Case-control studies are a cornerstone of epidemiology because they are an efficient way to investigate risk factors for diseases. Instead of measuring risk directly, they calculate an odds ratio ($OR$), but how does this relate to the true risk ratio ($RR$) you would find in a full cohort study? This practice problem walks you through the calculations for both a cohort and a case-control study sampled from it, clarifying the mathematical link between these two essential measures of association [@problem_id:4633739].", "problem": "A source population comprises $N = 12{,}000$ individuals observed over a fixed risk period with negligible loss to follow-up. Exposure status is ascertained at baseline. Of these, $E = 2{,}400$ are exposed and $U = 9{,}600$ are unexposed. The disease of interest has incidence proportion (risk) in the exposed of $R_{1} = 0.03$ and in the unexposed of $R_{0} = 0.015$. A separate case-control study is conducted by independently sampling a fixed fraction of cases and a fixed fraction of non-cases from the same source population, with selection probabilities that depend only on case status and not on exposure status. Specifically, the study selects a fraction $s_{c} = \\frac{2}{3}$ of all incident cases and a fraction $s_{n} = \\frac{1}{12}$ of all non-cases.\n\nUsing only core definitions of incidence proportion, odds, risk ratio, and odds ratio, and the stated case-control selection mechanism:\n\n1. Construct the $2 \\times 2$ table of exposure by disease in the underlying cohort and compute the cohort risk ratio $RR$.\n2. Compute the cohort odds ratio $OR_{\\text{cohort}}$.\n3. Construct the expected $2 \\times 2$ table of exposure by case status in the case-control sample implied by the given selection fractions, and compute the case-control odds ratio $OR_{\\text{cc}}$. Justify whether $OR_{\\text{cc}}$ equals $OR_{\\text{cohort}}$ under the stated selection mechanism.\n4. Because the overall disease incidence is less than $0.05$, assess the low-incidence approximation by computing the relative deviation $\\Delta = \\frac{|OR_{\\text{cc}} - RR|}{RR}$.\n\nReport the following three quantities, in this order, each as a dimensionless number: $OR_{\\text{cc}}$, $RR$, and $\\Delta$. Round each reported quantity to four significant figures.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in established epidemiological principles, self-contained, and provides all necessary data and definitions for a unique and meaningful solution. The problem is well-posed and objective.\n\nThe analysis proceeds by addressing the four parts of the problem in sequence.\n\nThe given parameters are:\n- Source population size: $N = 12,000$\n- Number of exposed individuals: $E = 2,400$\n- Number of unexposed individuals: $U = 9,600$\n- Incidence proportion (risk) in exposed: $R_{1} = 0.03$\n- Incidence proportion (risk) in unexposed: $R_{0} = 0.015$\n- Sampling fraction for cases: $s_{c} = \\frac{2}{3}$\n- Sampling fraction for non-cases: $s_{n} = \\frac{1}{12}$\n\n1. Construction of the cohort $2 \\times 2$ table and calculation of the risk ratio ($RR$).\n\nFirst, we determine the number of cases and non-cases within the exposed and unexposed groups in the source population.\nLet $C_{1}$ be the number of cases among the exposed, and $N_{1}$ be the number of non-cases among the exposed.\n$C_{1} = E \\times R_{1} = 2,400 \\times 0.03 = 72$\n$N_{1} = E \\times (1 - R_{1}) = 2,400 \\times (1 - 0.03) = 2,400 \\times 0.97 = 2,328$\n\nLet $C_{0}$ be the number of cases among the unexposed, and $N_{0}$ be the number of non-cases among the unexposed.\n$C_{0} = U \\times R_{0} = 9,600 \\times 0.015 = 144$\n$N_{0} = U \\times (1 - R_{0}) = 9,600 \\times (1 - 0.015) = 9,600 \\times 0.985 = 9,456$\n\nThe $2 \\times 2$ table for the source population (cohort) is thus:\n\\begin{center}\n\\begin{tabular}{c|c|c|c}\n & Cases & Non-cases & Total \\\\\n\\hline\nExposed & $a=72$ & $b=2,328$ & $2,400$ \\\\\n\\hline\nUnexposed & $c=144$ & $d=9,456$ & $9,600$ \\\\\n\\hline\nTotal & $216$ & $11,784$ & $12,000$\n\\end{tabular}\n\\end{center}\n\nThe risk ratio, $RR$, is the ratio of the risk in the exposed to the risk in the unexposed.\n$$RR = \\frac{R_{1}}{R_{0}} = \\frac{0.03}{0.015} = 2$$\n\n2. Calculation of the cohort odds ratio ($OR_{\\text{cohort}}$).\n\nThe odds of disease in the exposed group is $O_{1} = \\frac{R_{1}}{1 - R_{1}}$.\nThe odds of disease in the unexposed group is $O_{0} = \\frac{R_{0}}{1 - R_{0}}$.\nThe cohort odds ratio is the ratio of these odds:\n$$OR_{\\text{cohort}} = \\frac{O_{1}}{O_{0}} = \\frac{R_{1} / (1 - R_{1})}{R_{0} / (1 - R_{0})} = \\frac{0.03 / (1 - 0.03)}{0.015 / (1 - 0.015)} = \\frac{0.03 / 0.97}{0.015 / 0.985}$$\n$$OR_{\\text{cohort}} = \\frac{0.03}{0.015} \\times \\frac{0.985}{0.97} = 2 \\times \\frac{0.985}{0.97} \\approx 2.0309278$$\nAlternatively, using the cross-product ratio from the cohort table ($a, b, c, d$):\n$$OR_{\\text{cohort}} = \\frac{ad}{bc} = \\frac{72 \\times 9,456}{2,328 \\times 144} = \\frac{680,832}{335,232} \\approx 2.0309278$$\nThe results are identical.\n\n3. Construction of the case-control table and calculation of the case-control odds ratio ($OR_{\\text{cc}}$).\n\nThe case-control study samples a fraction $s_{c} = \\frac{2}{3}$ of all cases and a fraction $s_{n} = \\frac{1}{12}$ of all non-cases. The expected counts in the case-control study table (denoted by primes) are:\n- Exposed cases: $a' = a \\times s_{c} = 72 \\times \\frac{2}{3} = 48$\n- Unexposed cases: $c' = c \\times s_{c} = 144 \\times \\frac{2}{3} = 96$\n- Exposed controls (non-cases): $b' = b \\times s_{n} = 2,328 \\times \\frac{1}{12} = 194$\n- Unexposed controls (non-cases): $d' = d \\times s_{n} = 9,456 \\times \\frac{1}{12} = 788$\n\nThe expected $2 \\times 2$ table for the case-control study is:\n\\begin{center}\n\\begin{tabular}{c|c|c}\n & Cases & Controls \\\\\n\\hline\nExposed & $a'=48$ & $b'=194$ \\\\\n\\hline\nUnexposed & $c'=96$ & $d'=788$\n\\end{tabular}\n\\end{center}\n\nThe case-control odds ratio, $OR_{\\text{cc}}$, is the cross-product ratio from this table:\n$$OR_{\\text{cc}} = \\frac{a'd'}{b'c'} = \\frac{48 \\times 788}{194 \\times 96} = \\frac{37,824}{18,624} \\approx 2.0309278$$\n\nJustification of $OR_{\\text{cc}} = OR_{\\text{cohort}}$:\nThe case-control odds ratio is calculated as $OR_{\\text{cc}} = \\frac{a'd'}{b'c'}$. Substituting the expressions for the sampled counts:\n$$OR_{\\text{cc}} = \\frac{(a \\cdot s_{c})(d \\cdot s_{n})}{(b \\cdot s_{n})(c \\cdot s_{c})} = \\frac{ad \\cdot s_{c}s_{n}}{bc \\cdot s_{c}s_{n}}$$\nSince the sampling fractions $s_{c}$ and $s_{n}$ are constants that do not depend on exposure, they cancel from the numerator and denominator.\n$$OR_{\\text{cc}} = \\frac{ad}{bc} = OR_{\\text{cohort}}$$\nThis demonstrates that when the selection probabilities for cases and controls are independent of exposure status, the case-control odds ratio is an unbiased estimator of the cohort odds ratio. Our numerical calculation confirmed this equality.\n\n4. Assessment of the low-incidence approximation.\n\nThe problem asks to compute the relative deviation $\\Delta = \\frac{|OR_{\\text{cc}} - RR|}{RR}$.\nUsing the calculated values:\n$OR_{\\text{cc}} \\approx 2.0309278$\n$RR = 2$\n$$\\Delta = \\frac{|2.0309278 - 2|}{2} = \\frac{0.0309278}{2} \\approx 0.0154639$$\nThe premise for this approximation is a low overall disease incidence. In the cohort, the total number of cases is $C_1 + C_0 = 72+144 = 216$, and the total population is $N=12,000$. The overall incidence is $\\frac{216}{12,000} = 0.018$, which is less than the specified threshold of $0.05$. The \"rare disease assumption\" states that if the disease is rare, $OR \\approx RR$. This calculation quantifies the error in that approximation for this specific scenario. The deviation from unity is driven by the factor $\\frac{1-R_0}{1-R_1} = \\frac{1-0.015}{1-0.03} = \\frac{0.985}{0.97} \\approx 1.01546$. The relative deviation $\\Delta$ is simply this factor minus $1$, i.e., $|\\frac{1-R_0}{1-R_1} - 1| \\approx 0.01546$.\n\nSummary of quantities to be reported, rounded to four significant figures:\n- $OR_{\\text{cc}} \\approx 2.0309 \\rightarrow 2.031$\n- $RR = 2 \\rightarrow 2.000$\n- $\\Delta \\approx 0.0154639 \\rightarrow 0.01546$", "answer": "$$\\boxed{\\begin{pmatrix} 2.031 & 2.000 & 0.01546 \\end{pmatrix}}$$", "id": "4633739"}, {"introduction": "Real-world epidemiological studies must contend with imperfect measurements, and the process of selecting cases is no exception. Misclassification, where true cases are missed or non-cases are incorrectly included, can significantly bias study results. This exercise demonstrates how to algebraically correct for this bias using the known sensitivity ($Se$) and specificity ($Sp$) of the case definition, allowing you to recover a more accurate estimate of the true odds ratio [@problem_id:4633716].", "problem": "A case–control study investigates the association between a binary exposure $E$ and a binary disease $D$. Exposure status is measured without error. However, selection of cases is imperfect: some true cases are misclassified as controls and some true controls are misclassified as cases. The imperfection in case selection is characterized by sensitivity (Se) and specificity (Sp) of the case definition, assumed to be nondifferential with respect to exposure, that is, the same $Se$ and $Sp$ apply within the exposed and unexposed strata.\n\nThe following counts are observed after case selection:\n- Observed selected cases: $n_{1E} = 340$ exposed and $n_{1\\bar{E}} = 260$ unexposed.\n- Observed selected controls: $n_{0E} = 210$ exposed and $n_{0\\bar{E}} = 690$ unexposed.\n\nSensitivity and specificity of the case definition are $Se = 0.85$ and $Sp = 0.98$. Using only core definitions and first principles, derive the corrected odds ratio for the association between exposure and disease by reconstructing the expected true $2 \\times 2$ table of $(D,E)$ from the observed misclassified totals. Let the true cell counts be $t_{11}$ (truly diseased and exposed), $t_{10}$ (truly diseased and unexposed), $t_{01}$ (truly non-diseased and exposed), and $t_{00}$ (truly non-diseased and unexposed). Then compute the corrected odds ratio\n$$\nOR_{\\text{corrected}} = \\frac{t_{11} / t_{10}}{t_{01} / t_{00}} = \\frac{t_{11} \\, t_{00}}{t_{10} \\, t_{01}}.\n$$\nAssume the classification errors are independent of exposure. Round your final numerical answer to four significant figures. No units are required.", "solution": "The problem requires the calculation of an odds ratio corrected for outcome misclassification in a case–control study. The fundamental principle is to reconstruct the true (unobserved) counts of diseased and non-diseased individuals within each exposure stratum, using the provided observed counts and the sensitivity and specificity of the case selection process. The assumption of nondifferential misclassification—that the sensitivity, $Se$, and specificity, $Sp$, are the same for exposed and unexposed individuals—is critical for this reconstruction.\n\nLet $t_{11}$, $t_{10}$, $t_{01}$, and $t_{00}$ represent the true cell counts for the study population, where the first subscript denotes disease status ($1$ for diseased, $0$ for non-diseased) and the second denotes exposure status ($1$ for exposed, $0$ for unexposed). Let the observed counts be $n_{1E}$ (observed exposed cases), $n_{1\\bar{E}}$ (observed unexposed cases), $n_{0E}$ (observed exposed controls), and $n_{0\\bar{E}}$ (observed unexposed controls).\n\nThe given values are:\n- $n_{1E} = 340$\n- $n_{1\\bar{E}} = 260$\n- $n_{0E} = 210$\n- $n_{0\\bar{E}} = 690$\n- $Se = 0.85$\n- $Sp = 0.98$\n\nWe analyze the exposed and unexposed strata separately.\n\nFirst, consider the exposed stratum. The total number of exposed individuals in the study is the sum of observed exposed cases and controls:\n$$T_E = n_{1E} + n_{0E} = 340 + 210 = 550$$\nThese $550$ individuals are composed of $t_{11}$ true cases and $t_{01}$ true non-cases. Therefore, we have the conservation equation:\n$$t_{11} + t_{01} = 550 \\quad (1)$$\n\nAn observed case is either a true case that is correctly classified (a true positive) or a true non-case that is incorrectly classified as a case (a false positive). This relationship is expressed as:\n$$n_{1E} = t_{11} \\cdot Se + t_{01} \\cdot (1 - Sp)$$\nSubstituting the given numerical values:\n$$340 = t_{11} \\cdot (0.85) + t_{01} \\cdot (1 - 0.98)$$\n$$340 = 0.85 t_{11} + 0.02 t_{01} \\quad (2)$$\n\nWe solve the system of two linear equations, $(1)$ and $(2)$, for the two unknowns $t_{11}$ and $t_{01}$. From equation $(1)$, we write $t_{01}$ as $t_{01} = 550 - t_{11}$. Substituting this into equation $(2)$:\n$$340 = 0.85 t_{11} + 0.02 (550 - t_{11})$$\n$$340 = 0.85 t_{11} + 11 - 0.02 t_{11}$$\n$$340 - 11 = (0.85 - 0.02) t_{11}$$\n$$329 = 0.83 t_{11}$$\nThus, the expected true number of exposed cases is:\n$$t_{11} = \\frac{329}{0.83}$$\nAnd the expected true number of exposed non-cases is:\n$$t_{01} = 550 - t_{11} = 550 - \\frac{329}{0.83} = \\frac{550 \\cdot 0.83 - 329}{0.83} = \\frac{456.5 - 329}{0.83} = \\frac{127.5}{0.83}$$\n\nNext, we perform the same analysis for the unexposed stratum. The total number of unexposed individuals is:\n$$T_{\\bar{E}} = n_{1\\bar{E}} + n_{0\\bar{E}} = 260 + 690 = 950$$\nThese $950$ individuals comprise $t_{10}$ true cases and $t_{00}$ true non-cases:\n$$t_{10} + t_{00} = 950 \\quad (3)$$\n\nThe number of observed unexposed cases, $n_{1\\bar{E}}$, is related to the true counts by:\n$$n_{1\\bar{E}} = t_{10} \\cdot Se + t_{00} \\cdot (1 - Sp)$$\nSubstituting the values:\n$$260 = t_{10} \\cdot (0.85) + t_{00} \\cdot (1 - 0.98)$$\n$$260 = 0.85 t_{10} + 0.02 t_{00} \\quad (4)$$\n\nWe solve the system of equations $(3)$ and $(4)$ for $t_{10}$ and $t_{00}$. From equation $(3)$, $t_{00} = 950 - t_{10}$. Substituting into equation $(4)$:\n$$260 = 0.85 t_{10} + 0.02 (950 - t_{10})$$\n$$260 = 0.85 t_{10} + 19 - 0.02 t_{10}$$\n$$260 - 19 = (0.85 - 0.02) t_{10}$$\n$$241 = 0.83 t_{10}$$\nThus, the expected true number of unexposed cases is:\n$$t_{10} = \\frac{241}{0.83}$$\nAnd the expected true number of unexposed non-cases is:\n$$t_{00} = 950 - t_{10} = 950 - \\frac{241}{0.83} = \\frac{950 \\cdot 0.83 - 241}{0.83} = \\frac{788.5 - 241}{0.83} = \\frac{547.5}{0.83}$$\n\nWith the expected true counts determined, we can calculate the corrected odds ratio, $OR_{\\text{corrected}}$:\n$$OR_{\\text{corrected}} = \\frac{t_{11} \\, t_{00}}{t_{10} \\, t_{01}}$$\n$$OR_{\\text{corrected}} = \\frac{\\left(\\frac{329}{0.83}\\right) \\left(\\frac{547.5}{0.83}\\right)}{\\left(\\frac{241}{0.83}\\right) \\left(\\frac{127.5}{0.83}\\right)}$$\nThe term $(1/0.83)^2$ in the numerator and denominator cancels out, yielding:\n$$OR_{\\text{corrected}} = \\frac{329 \\times 547.5}{241 \\times 127.5} = \\frac{180127.5}{30727.5}$$\n$$OR_{\\text{corrected}} \\approx 5.862105$$\n\nThe problem requires the final answer to be rounded to four significant figures.\n$$OR_{\\text{corrected}} \\approx 5.862$$", "answer": "$$\\boxed{5.862}$$", "id": "4633716"}]}