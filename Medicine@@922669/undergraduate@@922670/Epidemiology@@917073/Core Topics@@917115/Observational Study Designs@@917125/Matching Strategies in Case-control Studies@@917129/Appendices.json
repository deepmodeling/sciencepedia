{"hands_on_practices": [{"introduction": "Once data from a frequency-matched study is collected, the next step is to perform an analysis that properly accounts for the stratified design. The Mantel-Haenszel method provides a robust way to calculate a pooled odds ratio, giving us a single summary measure of association that is adjusted for the matching variable. This practice will guide you through the mechanics of applying the Mantel-Haenszel formula to data from several strata, a fundamental skill for interpreting results from matched studies. [@problem_id:4610307]", "problem": "A population-based case-control study investigates the association between a binary exposure and a binary disease outcome. The study uses frequency matching on age categories to reduce confounding by age, yielding three strata corresponding to age groups. Within each stratum, the $2 \\times 2$ table cell counts are defined as follows: $a_k$ is the number of exposed cases, $b_k$ is the number of unexposed cases, $c_k$ is the number of exposed controls, and $d_k$ is the number of unexposed controls, for stratum index $k \\in \\{1,2,3\\}$. Let $N_k = a_k + b_k + c_k + d_k$ denote the total subjects in stratum $k$.\n\nData were as follows:\n- Stratum $1$: $a_1 = 18$, $b_1 = 22$, $c_1 = 12$, $d_1 = 38$.\n- Stratum $2$: $a_2 = 25$, $b_2 = 15$, $c_2 = 20$, $d_2 = 40$.\n- Stratum $3$: $a_3 = 10$, $b_3 = 30$, $c_3 = 8$, $d_3 = 52$.\n\nStarting from the fundamental definitions of odds and odds ratio in a $2 \\times 2$ table, and using the principle of stratification to control for the matching factor, derive an appropriate pooled estimator for a common odds ratio across strata using the Mantel-Haenszel approach (Mantel-Haenszel (MH)). Then compute the value of this pooled estimator for the given data. Round your numerical answer to four significant figures. No units should be used. Finally, interpret the estimate in the context of a case-control study with frequency matching.", "solution": "The objective is to compute the Mantel-Haenszel (MH) pooled odds ratio for stratified case-control data and interpret the result. The study employs frequency matching by age, and the analysis uses stratification to control for age as a potential confounding variable.\n\nFirst, we define the odds ratio (OR) for a single stratum $k$. In a case-control study, we compare the odds of exposure among cases to the odds of exposure among controls. The odds ratio for stratum $k$, denoted $OR_k$, is the ratio of these two odds:\n$$OR_k = \\frac{\\text{odds of exposure among cases}}{\\text{odds of exposure among controls}} = \\frac{a_k / b_k}{c_k / d_k} = \\frac{a_k d_k}{b_k c_k}$$\n\nThe Mantel-Haenszel method provides a pooled estimate of a common odds ratio, $\\psi_{MH}$, across all strata. The formula for the Mantel-Haenszel pooled odds ratio is:\n$$\\psi_{MH} = \\frac{\\sum_{k=1}^{K} \\frac{a_k d_k}{N_k}}{\\sum_{k=1}^{K} \\frac{b_k c_k}{N_k}}$$\nwhere $K$ is the total number of strata ($3$ in this problem) and $N_k = a_k + b_k + c_k + d_k$.\n\nWe now compute the necessary components for each of the three strata.\n\n**Stratum 1 ($k=1$):**\nGiven: $a_1 = 18, b_1 = 22, c_1 = 12, d_1 = 38$.\nTotal subjects: $N_1 = 18 + 22 + 12 + 38 = 90$.\nNumerator component: $\\frac{a_1 d_1}{N_1} = \\frac{18 \\times 38}{90} = \\frac{684}{90} = 7.6$.\nDenominator component: $\\frac{b_1 c_1}{N_1} = \\frac{22 \\times 12}{90} = \\frac{264}{90} \\approx 2.933$.\n\n**Stratum 2 ($k=2$):**\nGiven: $a_2 = 25, b_2 = 15, c_2 = 20, d_2 = 40$.\nTotal subjects: $N_2 = 25 + 15 + 20 + 40 = 100$.\nNumerator component: $\\frac{a_2 d_2}{N_2} = \\frac{25 \\times 40}{100} = \\frac{1000}{100} = 10$.\nDenominator component: $\\frac{b_2 c_2}{N_2} = \\frac{15 \\times 20}{100} = \\frac{300}{100} = 3$.\n\n**Stratum 3 ($k=3$):**\nGiven: $a_3 = 10, b_3 = 30, c_3 = 8, d_3 = 52$.\nTotal subjects: $N_3 = 10 + 30 + 8 + 52 = 100$.\nNumerator component: $\\frac{a_3 d_3}{N_3} = \\frac{10 \\times 52}{100} = \\frac{520}{100} = 5.2$.\nDenominator component: $\\frac{b_3 c_3}{N_3} = \\frac{30 \\times 8}{100} = \\frac{240}{100} = 2.4$.\n\nNext, we sum these components across all strata.\nSum of numerator components:\n$$\\sum_{k=1}^{3} \\frac{a_k d_k}{N_k} = 7.6 + 10 + 5.2 = 22.8$$\nSum of denominator components:\n$$\\sum_{k=1}^{3} \\frac{b_k c_k}{N_k} = \\frac{264}{90} + 3 + 2.4 \\approx 2.933 + 3 + 2.4 = 8.333$$\n\nFinally, we compute the Mantel-Haenszel pooled odds ratio:\n$$\\psi_{MH} = \\frac{\\sum R_k}{\\sum S_k} = \\frac{22.8}{8.333...} = \\frac{22.8}{25/3} = \\frac{22.8 \\times 3}{25} = \\frac{68.4}{25} = 2.736$$\nThe result $2.736$ has four significant figures, as requested.\n\n**Interpretation:**\nThe Mantel-Haenszel pooled odds ratio, $\\psi_{MH} = 2.736$, is an estimate of the association between the exposure and the disease, adjusted for the confounding effect of age. A value of $2.736$ indicates a positive association. The interpretation is as follows: After controlling for confounding by age via stratification, the odds of having been exposed are estimated to be $2.736$ times greater for individuals with the disease (cases) than for individuals without the disease (controls). It is important to note that frequency matching is a design strategy, while the Mantel-Haenszel procedure is the analysis method that actually controls for confounding.", "answer": "$$\n\\boxed{2.736}\n$$", "id": "4610307"}, {"introduction": "Matching in a study's design phase is not a 'free lunch'; it must be accounted for in the analysis phase to obtain a valid result. This exercise demonstrates the critical pitfall of ignoring the matching variable and performing a crude, unadjusted analysis. By calculating the expected crude odds ratio from a hypothetical matched study and comparing it to the true odds ratio, you will quantify the bias introduced, solidifying your understanding of why a matched design demands a matched analysis. [@problem_id:4610264]", "problem": "An investigator conducts a frequency-matched case-control study to estimate the effect of a binary exposure $E \\in \\{0,1\\}$ on a binary disease $D \\in \\{0,1\\}$, with frequency-matching on a binary stratum variable $S \\in \\{0,1\\}$ (for example, age group). The design is such that for each stratum $s \\in \\{0,1\\}$, exactly $n_s$ cases and $n_s$ controls are sampled, with $n_0 = 300$ and $n_1 = 100$. In the source population, within each stratum $s$, the exposure $E$ has prevalence $\\pi_s$ among controls, with $\\pi_0 = 0.7$ and $\\pi_1 = 0.2$. The true stratum-specific disease odds ratio (odds ratio (OR)) comparing $E=1$ to $E=0$ is homogeneous across strata and equal to $\\theta = 2$.\n\nStarting only from the core definitions of odds, odds ratio, and the rules of case-control sampling, derive the expected unconditional crude odds ratio for $E$ obtained by ignoring $S$ (that is, pooling all strata and fitting an unconditional model without any stratum indicators). Then, define the multiplicative bias factor as $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$, where $\\mathrm{OR}_{\\text{unadj}}$ is the unconditional crude odds ratio ignoring $S$. Compute $b$ for the given design and parameters.\n\nExpress the final answer for $b$ as a real number, rounded to four significant figures. No units are required.", "solution": "The objective is to compute the multiplicative bias factor $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$. To do this, we must first derive the expected unconditional crude odds ratio, $\\mathrm{OR}_{\\text{unadj}}$. This odds ratio is calculated from a $2 \\times 2$ table that pools data across the two strata $S=0$ and $S=1$.\n\nThe pooled table of expected counts is:\n| | Exposed ($E=1$) | Unexposed ($E=0$) |\n|---|---|---|\n| Cases ($D=1$) | $E[A]$ | $E[B]$ |\n| Controls ($D=0$) | $E[C]$ | $E[D]$ |\n\nThe crude odds ratio is given by $\\mathrm{OR}_{\\text{unadj}} = \\frac{E[A]E[D]}{E[B]E[C]}$.\n\n**1. Expected Counts for Controls ($D=0$)**\n\nThe problem provides the prevalence of exposure among controls in the source population for each stratum, $\\pi_s = P(E=1|D=0, S=s)$.\n- In stratum $s=0$, we sample $n_0 = 300$ controls. The prevalence of exposure is $\\pi_0 = 0.7$.\nThe expected number of exposed controls in stratum $0$ is: $E[N_{100}] = n_0 \\cdot \\pi_0 = 300 \\cdot 0.7 = 210$.\nThe expected number of unexposed controls in stratum $0$ is: $E[N_{000}] = n_0 \\cdot (1 - \\pi_0) = 300 \\cdot (1 - 0.7) = 90$.\n- In stratum $s=1$, we sample $n_1 = 100$ controls. The prevalence of exposure is $\\pi_1 = 0.2$.\nThe expected number of exposed controls in stratum $1$ is: $E[N_{101}] = n_1 \\cdot \\pi_1 = 100 \\cdot 0.2 = 20$.\nThe expected number of unexposed controls in stratum $1$ is: $E[N_{001}] = n_1 \\cdot (1 - \\pi_1) = 100 \\cdot (1 - 0.2) = 80$.\n\nThe total expected counts for controls in the pooled table are:\n$E[C] = E[N_{100}] + E[N_{101}] = 210 + 20 = 230$.\n$E[D] = E[N_{000}] + E[N_{001}] = 90 + 80 = 170$.\n\n**2. Expected Counts for Cases ($D=1$)**\n\nWe determine the prevalence of exposure among cases, $\\pi_s^* = P(E=1|D=1, S=s)$, from the stratum-specific odds ratio, $\\theta$.\n$$ \\pi_s^* = \\frac{\\theta \\pi_s}{1 + (\\theta-1)\\pi_s} $$\nUsing the given values $\\theta = 2$, $\\pi_0 = 0.7$, and $\\pi_1 = 0.2$:\n- For stratum $s=0$: $\\pi_0^* = \\frac{2 \\cdot 0.7}{1 + (2-1) \\cdot 0.7} = \\frac{1.4}{1.7} = \\frac{14}{17}$.\n- For stratum $s=1$: $\\pi_1^* = \\frac{2 \\cdot 0.2}{1 + (2-1) \\cdot 0.2} = \\frac{0.4}{1.2} = \\frac{1}{3}$.\nNow we can compute the expected counts for cases.\n- In stratum $s=0$, we sample $n_0 = 300$ cases: $E[N_{110}] = 300 \\cdot \\frac{14}{17} = \\frac{4200}{17}$ and $E[N_{010}] = 300 \\cdot \\frac{3}{17} = \\frac{900}{17}$.\n- In stratum $s=1$, we sample $n_1 = 100$ cases: $E[N_{111}] = 100 \\cdot \\frac{1}{3} = \\frac{100}{3}$ and $E[N_{011}] = 100 \\cdot \\frac{2}{3} = \\frac{200}{3}$.\n\nThe total expected counts for cases in the pooled table are:\n$E[A] = E[N_{110}] + E[N_{111}] = \\frac{4200}{17} + \\frac{100}{3} = \\frac{12600 + 1700}{51} = \\frac{14300}{51}$.\n$E[B] = E[N_{010}] + E[N_{011}] = \\frac{900}{17} + \\frac{200}{3} = \\frac{2700 + 3400}{51} = \\frac{6100}{51}$.\n\n**3. Compute the Unconditional Crude Odds Ratio ($\\mathrm{OR}_{\\text{unadj}}$)**\n\nUsing the expected counts for the pooled table:\n$$ \\mathrm{OR}_{\\text{unadj}} = \\frac{E[A]E[D]}{E[B]E[C]} = \\frac{\\left(\\frac{14300}{51}\\right) \\cdot 170}{\\left(\\frac{6100}{51}\\right) \\cdot 230} = \\frac{14300 \\cdot 170}{6100 \\cdot 230} = \\frac{143 \\cdot 17}{61 \\cdot 23} = \\frac{2431}{1403} $$\n\n**4. Compute the Bias Factor ($b$)**\n\nThe multiplicative bias factor is $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$. Given $\\theta = 2$:\n$$ b = \\frac{\\mathrm{OR}_{\\text{unadj}}}{\\theta} = \\frac{2431/1403}{2} = \\frac{2431}{2 \\cdot 1403} = \\frac{2431}{2806} $$\nThe numerical value is approximately $0.8663578$. Rounding to four significant figures gives $0.8664$.", "answer": "$$\\boxed{0.8664}$$", "id": "4610264"}, {"introduction": "Effective study design requires deciding *which* variables to match on, a decision with significant consequences for both validity and efficiency. This thought experiment explores the concept of overmatching, a scenario where matching is done on a variable that is associated with the exposure but not independently with the disease. Analyzing this hypothetical case will help you understand why such matching does not control for confounding and can harm your study's statistical power, providing crucial insight into strategic study design. [@problem_id:4610295]", "problem": "A research team conducts a case-control study to evaluate the association between a specific workplace chemical exposure $E$ (binary: exposed versus unexposed) and acute neurologic symptoms $D$ (binary: case versus control) among employees of a large company with uniform access to occupational health services. Socioeconomic Status (SES) is measured by a composite index incorporating education, job grade, and assets. Prior company records indicate the following in the source population from which cases arise: $SES$ strongly predicts job assignment and, consequently, exposure (for some values $s_1$ and $s_2$, $P(E=1 \\mid SES=s_1) \\neq P(E=1 \\mid SES=s_2)$), but susceptibility to the acute neurologic outcome itself is biologically determined by exposure and not by $SES$; specifically, $SES$ does not affect $D$ except possibly through its effect on $E$. Equivalently, in the source population, $P(D=1 \\mid SES=s) = p$ for all $s$, and $SES$ is not on the causal pathway between $E$ and $D$. Controls are sampled via incidence density sampling from the same workforce and are selected independent of $SES$ except insofar as matching might impose constraints.\n\nFrom first principles, recall that in a case-control study, unbiased estimation of the exposure–outcome association requires that controls represent the exposure distribution in the source population of the cases, and that confounding occurs when a third variable $C$ is associated with both $E$ and $D$ and is not a consequence of $E$. Matching is a design strategy that selects controls to have the same distribution of the matching factor as cases, which is equivalent to conditioning on that factor in the design. Overmatching is matching on a variable that is not a confounder, often one related to $E$ but not to $D$, which can reduce the variability of $E$ within matched strata and thereby affect efficiency.\n\nThe team is considering matching cases and controls on $SES$ to simplify fieldwork and ensure comparable $SES$ distributions across case-control sets.\n\nWhich statement best describes the impact of matching on $SES$ in this study?\n\nA. Matching on $SES$ will introduce selection bias even if the analysis correctly conditions on $SES$, because controls no longer represent the source population.\n\nB. Matching on $SES$ will not introduce selection bias provided that $SES$ is independent of $D$ in the source population and the analysis correctly accounts for matching; however, it will likely reduce statistical efficiency by decreasing variation in $E$ within $SES$-matched sets.\n\nC. Matching on $SES$ is necessary for an unbiased estimate because $SES$ is associated with $E$, and failing to match will inevitably confound the $E$–$D$ association.\n\nD. Matching on $SES$ will improve efficiency by reducing variance, since aligning cases and controls on predictors of $E$ strengthens the contrast needed to estimate the $E$–$D$ association.\n\nE. Matching on $SES$ will create collider stratification bias because $SES$ lies on the causal pathway between $E$ and $D$.", "solution": "The central task is to evaluate the consequences of matching on Socioeconomic Status ($SES$) in this case-control study. This requires determining the role of $SES$ in the relationship between the exposure ($E$) and the disease ($D$).\n\n**Analysis of the Role of SES**\n\n1.  **Is $SES$ a confounder?**\n    A variable is a confounder if it is associated with the exposure ($E$), is an independent risk factor for the disease ($D$), and is not on the causal pathway between $E$ and $D$.\n    -   **Association with E**: The problem states that $SES$ is strongly associated with the exposure $E$. This criterion is met.\n    -   **Association with D**: The problem explicitly states that in the source population, \"$P(D=1 \\mid SES=s) = p$ for all $s$\". This means the risk of disease is the same across all strata of $SES$. Therefore, $SES$ is **not** associated with the disease $D$. This criterion is not met.\n    -   Since $SES$ is not associated with the disease outcome $D$, **$SES$ is not a confounder**.\n\n2.  **What are the consequences of matching on a non-confounder?**\n    Matching on a variable that is not a confounder is a form of \"overmatching\". The consequences depend on the variable's relationship with the exposure and outcome.\n    -   **Impact on Bias**: If a proper matched analysis is performed (e.g., conditional logistic regression), which respects the study design, an unbiased estimate of the exposure effect can be obtained. Matching on a non-confounder does not introduce an irremovable bias, provided the analysis is appropriate for the design.\n    -   **Impact on Statistical Efficiency**: The information to estimate an odds ratio in a matched study comes from strata that are discordant on exposure. The problem states that $SES$ is strongly associated with $E$. By matching on $SES$, we pair individuals who have a similar probability of being exposed. This increases the likelihood that they will be concordant on exposure (both exposed or both unexposed), reducing the number of informative discordant pairs. This loss of information reduces statistical power and precision (i.e., widens the confidence interval). Therefore, matching on a variable strongly associated with exposure but not with disease leads to a **loss of statistical efficiency**.\n\n**Option-by-Option Evaluation**\n\nA. Matching on $SES$ will introduce selection bias even if the analysis correctly conditions on $SES$, because controls no longer represent the source population.\nThis is incorrect. A properly conditional analysis is designed to account for the matched selection process and yield an unbiased estimate.\n\nB. Matching on $SES$ will not introduce selection bias provided that $SES$ is independent of $D$ in the source population and the analysis correctly accounts for matching; however, it will likely reduce statistical efficiency by decreasing variation in $E$ within $SES$-matched sets.\nThis is correct. It accurately summarizes the two main consequences: no bias with proper analysis, but a loss of efficiency.\n\nC. Matching on $SES$ is necessary for an unbiased estimate because $SES$ is associated with $E$, and failing to match will inevitably confound the $E$–$D$ association.\nThis is incorrect. $SES$ is not a confounder because it is not associated with the disease $D$.\n\nD. Matching on $SES$ will improve efficiency by reducing variance, since aligning cases and controls on predictors of $E$ strengthens the contrast needed to estimate the $E$–$D$ association.\nThis is incorrect. It makes the opposite claim about efficiency. Matching on a variable that is only associated with exposure *reduces* efficiency by weakening the informative contrast.\n\nE. Matching on $SES$ will create collider stratification bias because $SES$ lies on the causal pathway between $E$ and $D$.\nThis is incorrect. The problem states $SES$ is not on the causal pathway, and the described structure ($SES \\rightarrow E$) does not involve a collider.", "answer": "$$\\boxed{B}$$", "id": "4610295"}]}