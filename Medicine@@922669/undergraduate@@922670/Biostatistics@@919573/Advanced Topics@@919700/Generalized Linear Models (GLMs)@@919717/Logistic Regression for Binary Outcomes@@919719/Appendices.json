{"hands_on_practices": [{"introduction": "A logistic regression model's direct output is the log-odds, a scale that is not immediately intuitive for clinical interpretation. This exercise provides practice in the fundamental skill of converting this linear predictor, $\\eta$, into a tangible and meaningful probability, $p$. Mastering this transformation from the logit scale to the probability scale is the first step toward using a model for risk prediction and communication [@problem_id:4970702].", "problem": "A clinical research team is developing a prognostic model for $30$-day mortality among patients admitted to the intensive care unit (ICU) with acute decompensated heart failure. Let $Y \\in \\{0,1\\}$ denote the binary outcome where $Y=1$ indicates death within $30$ days and $Y=0$ indicates survival. Assume $Y \\mid \\boldsymbol{X}$ follows a Bernoulli distribution with parameter $p(\\boldsymbol{X})$, and the model is a generalized linear model with the canonical logit link. For a particular patient with covariates $\\boldsymbol{X}$, the fitted linear predictor (also called the log-odds) is $\\eta=-1.386$.\n\nStarting only from the Bernoulli model and the definition of the canonical logit link in generalized linear models, derive the mapping from the linear predictor $\\eta$ to the probability $p(\\boldsymbol{X})$, and compute the numerical value of $p$ for this patient. Briefly state the clinical meaning of the obtained $p$ for $30$-day mortality risk.\n\nProvide the value of $p$ as a decimal rounded to three significant figures. Do not use a percentage sign.", "solution": "The problem statement is evaluated for validity.\n\n**Step 1: Extract Givens**\n-   Outcome variable: $Y \\in \\{0,1\\}$, where $Y=1$ denotes death within $30$ days and $Y=0$ denotes survival.\n-   Conditional distribution of the outcome: $Y \\mid \\boldsymbol{X} \\sim \\text{Bernoulli}(p(\\boldsymbol{X}))$.\n-   Model framework: Generalized linear model (GLM).\n-   Link function: Canonical logit link.\n-   Fitted linear predictor for a specific patient: $\\eta = -1.386$.\n-   Tasks:\n    1.  Derive the mapping from the linear predictor $\\eta$ to the probability $p(\\boldsymbol{X})$.\n    2.  Compute the numerical value of $p$ for the given patient.\n    3.  Briefly state the clinical meaning of the computed probability.\n    4.  Provide $p$ rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the theory of generalized linear models, a standard and fundamental topic in statistical modeling. The use of a Bernoulli distribution for a binary outcome and the logit link function are canonical choices within this framework. The problem is well-posed, providing all necessary information to perform the requested derivation and calculation, leading to a unique solution. The terminology is precise and objective. The provided value for the linear predictor, $\\eta = -1.386$, is a plausible real-world value. There are no contradictions, ambiguities, or violations of scientific principles.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n***\n\nThe problem requires the derivation of the relationship between the linear predictor, $\\eta$, and the event probability, $p$, within the framework of a generalized linear model (GLM) for a Bernoulli-distributed outcome.\n\nA GLM consists of three components:\n1.  A random component: The distribution of the response variable $Y$ is a member of the exponential family.\n2.  A systematic component: A linear predictor, $\\eta = \\boldsymbol{X}^T\\boldsymbol{\\beta}$.\n3.  A link function: A function $g$ that relates the expected value of the random component, $\\mu = E[Y]$, to the systematic component, such that $g(\\mu) = \\eta$.\n\nFor the binary outcome $Y \\in \\{0,1\\}$, the conditional distribution is Bernoulli with parameter $p = P(Y=1 \\mid \\boldsymbol{X})$. The probability mass function is $f(y;p) = p^y(1-p)^{1-y}$. To identify the canonical link function, we must express this in the canonical form of the exponential family:\n$$f(y; \\theta) = \\exp \\left( \\frac{y\\theta - b(\\theta)}{a(\\phi)} + c(y, \\phi) \\right)$$\nRewriting the Bernoulli PMF:\n$$f(y;p) = p^y(1-p)^{1-y} = \\exp\\left( \\ln\\left(p^y(1-p)^{1-y}\\right) \\right)$$\n$$= \\exp\\left( y\\ln(p) + (1-y)\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln(p) + \\ln(1-p) - y\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\left[\\ln(p) - \\ln(1-p)\\right] + \\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln\\left(\\frac{p}{1-p}\\right) + \\ln(1-p) \\right)$$\nComparing this to the canonical form, we can identify the canonical parameter $\\theta = \\ln\\left(\\frac{p}{1-p}\\right)$. The quantity $\\frac{p}{1-p}$ is the odds of the event $Y=1$, and its natural logarithm is the log-odds. The expected value of a Bernoulli variable is $\\mu = E[Y] = p$.\n\nThe canonical link function is the function that maps the mean $\\mu$ to the canonical parameter $\\theta$. For the Bernoulli distribution, this is:\n$$g(p) = \\theta = \\ln\\left(\\frac{p}{1-p}\\right)$$\nThis function, $g(p)$, is known as the logit function.\n\nIn a GLM, the link function relates the mean of the outcome to the linear predictor, $\\eta$. Using the canonical logit link, we have:\n$$\\eta = g(p) = \\ln\\left(\\frac{p}{1-p}\\right)$$\nThe first task is to derive the mapping from $\\eta$ to $p$. This requires inverting the logit function. We solve the above equation for $p$:\n$$\\exp(\\eta) = \\frac{p}{1-p}$$\n$$\\exp(\\eta)(1-p) = p$$\n$$\\exp(\\eta) - p\\exp(\\eta) = p$$\n$$\\exp(\\eta) = p + p\\exp(\\eta)$$\n$$\\exp(\\eta) = p(1 + \\exp(\\eta))$$\n$$p = \\frac{\\exp(\\eta)}{1 + \\exp(\\eta)}$$\nThis expression provides the mapping from the linear predictor $\\eta$ to the probability $p$. This function is commonly known as the logistic sigmoid function. An equivalent and often more numerically stable form is obtained by dividing the numerator and denominator by $\\exp(\\eta)$:\n$$p = \\frac{1}{\\exp(-\\eta) + 1}$$\nThis completes the derivation.\n\nThe second task is to compute the numerical value of $p$ for the patient with a linear predictor of $\\eta = -1.386$. Using the derived formula:\n$$p = \\frac{1}{1 + \\exp(-\\eta)} = \\frac{1}{1 + \\exp(-(-1.386))}$$\n$$p = \\frac{1}{1 + \\exp(1.386)}$$\nWe calculate the value of $\\exp(1.386)$:\n$$\\exp(1.386) \\approx 3.998854$$\nSubstituting this back into the expression for $p$:\n$$p \\approx \\frac{1}{1 + 3.998854} = \\frac{1}{4.998854} \\approx 0.20004585$$\nThe problem requires the answer to be rounded to three significant figures. The first significant figure is $2$, the second is $0$, and the third is $0$. The fourth digit is $0$, so we round down.\n$$p \\approx 0.200$$\n\nThe final task is to state the clinical meaning of this value. The probability $p$ represents the model's prediction for the likelihood of the event $Y=1$ (death within $30$ days) for a patient with the given set of covariates $\\boldsymbol{X}$. Therefore, a value of $p=0.200$ means that for this particular patient, the prognostic model estimates a $20.0\\%$ probability of death within $30$ days of admission to the ICU. This is the patient's individual predicted risk.", "answer": "$$\n\\boxed{0.200}\n$$", "id": "4970702"}, {"introduction": "After translating the model's output into a risk probability, the next critical task is to understand how each covariate influences that risk. This practice demonstrates how to interpret a regression coefficient, $\\beta_j$, by calculating its corresponding odds ratio, $\\exp(\\beta_j)$. This is the most common method for quantifying and communicating the effect of a predictor in logistic regression [@problem_id:4970670].", "problem": "A prospective cohort study of adult surgical patients models the binary outcome $Y \\in \\{0,1\\}$, where $Y=1$ denotes severe postoperative infection within $30$ days. Let $\\mathbf{x} = (x_1,\\dots,x_p)$ denote patient covariates including high-sensitivity C-reactive protein (hs-CRP). The hs-CRP covariate is encoded as $x_j$, defined so that a one-unit increase in $x_j$ corresponds to an increase of $10$ mg/L in hs-CRP. Investigators fit a logistic regression model with a logit link, where the probability of infection given covariates is $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$, the odds of infection are $p(\\mathbf{x})/(1 - p(\\mathbf{x}))$, and the log-odds (logit) are $\\ln\\!\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)$. Suppose the estimated regression coefficient for $x_j$ is $\\beta_j = 0.693$.\n\nStarting from the definitions of odds and the logit link, and treating all other covariates as fixed, derive the multiplicative change in the odds of severe postoperative infection associated with a one-unit increase in $x_j$. Then, compute this multiplicative change for the given $\\beta_j$. Round your final numeric answer to four significant figures and do not include units. In addition, state the clinical interpretation of an odds ratio of $2$ per one-unit increase in $x_j$ (this interpretation is not part of the final numeric answer).", "solution": "The problem is valid as it is scientifically grounded in the principles of biostatistics, specifically logistic regression, and is well-posed with all necessary information provided for a unique solution.\n\nThe problem asks to derive the multiplicative change in the odds of an event for a unit increase in a covariate in a logistic regression model, compute its value for a given coefficient, and provide a clinical interpretation.\n\nLet the binary outcome be $Y \\in \\{0, 1\\}$, where $Y=1$ represents the event of interest (severe postoperative infection). The probability of this event, conditional on a vector of covariates $\\mathbf{x} = (x_1, \\dots, x_p)$, is denoted by $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$.\n\nThe logistic regression model uses a logit link function, which models the natural logarithm of the odds of the event as a linear function of the covariates. The odds are defined as the ratio of the probability of the event occurring to the probability of it not occurring:\n$$\n\\text{Odds}(\\mathbf{x}) = \\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\n$$\nThe log-odds (or logit) is therefore:\n$$\n\\text{logit}(p(\\mathbf{x})) = \\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)\n$$\nIn the logistic regression model, the logit is expressed as:\n$$\n\\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p = \\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\n$$\nwhere $\\beta_0, \\beta_1, \\dots, \\beta_p$ are the regression coefficients.\n\nTo derive the multiplicative change in the odds associated with a one-unit increase in a specific covariate $x_j$, we must compare the odds at two different levels of $x_j$, while holding all other covariates $(x_k \\text{ for } k \\neq j)$ constant.\n\nLet the odds for a patient with covariates $\\mathbf{x}$ be denoted by $\\text{Odds}(\\mathbf{x})$. By exponentiating the logit equation, we get:\n$$\n\\text{Odds}(\\mathbf{x}) = \\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)\n$$\nNow, consider a second scenario where the covariate $x_j$ is increased by one unit to $x_j + 1$. The new vector of covariates is $\\mathbf{x}' = (x_1, \\dots, x_j+1, \\dots, x_p)$. The odds for this scenario are:\n$$\n\\text{Odds}(\\mathbf{x}') = \\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)\n$$\nThe multiplicative change in the odds is the ratio of the new odds to the original odds. This ratio is defined as the odds ratio (OR) for a one-unit change in $x_j$.\n$$\n\\text{OR}_j = \\frac{\\text{Odds}(\\mathbf{x}')}{\\text{Odds}(\\mathbf{x})} = \\frac{\\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\nWe can rewrite the exponent in the numerator:\n$$\n\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j x_j + \\beta_j = \\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\n$$\nSubstituting this back into the expression for the odds ratio:\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\nUsing the property $\\exp(a+b) = \\exp(a)\\exp(b)$, we get:\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) \\exp(\\beta_j)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\nThe term $\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)$ cancels from the numerator and denominator, yielding the fundamental result:\n$$\n\\text{OR}_j = \\exp(\\beta_j)\n$$\nThis derivation shows that the multiplicative change in the odds for a one-unit increase in $x_j$ is equal to the exponential of the coefficient $\\beta_j$.\n\nThe problem states that the estimated coefficient for the covariate $x_j$ (representing hs-CRP) is $\\beta_j = 0.693$. We can now compute the multiplicative change in the odds:\n$$\n\\text{OR}_j = \\exp(0.693)\n$$\nWe calculate this value and round to four significant figures as requested:\n$$\n\\exp(0.693) \\approx 1.99970535 \\approx 2.000\n$$\nThe multiplicative change in the odds is $2.000$.\n\nThe problem also requests the clinical interpretation of an odds ratio of $2$ per one-unit increase in $x_j$. The covariate $x_j$ is encoded such that a one-unit increase corresponds to a $10$ mg/L increase in hs-CRP. Therefore, an odds ratio of $2$ for $x_j$ means that for every $10$ mg/L increase in a patient's hs-CRP level, the odds of developing a severe postoperative infection within $30$ days are estimated to be multiplied by $2$ (i.e., they are doubled), assuming all other patient characteristics in the model are held constant.", "answer": "$$\\boxed{2.000}$$", "id": "4970670"}, {"introduction": "While an odds ratio describes a constant multiplicative effect on the odds, its corresponding impact on the absolute probability of an event is not constant; it depends on the baseline risk. This advanced exercise delves into the concept of the marginal effect, $\\frac{\\partial p}{\\partial x_j}$, showing how to calculate the change in probability for a one-unit change in a predictor. Understanding this concept reveals the non-linear nature of the logistic model and allows for a more nuanced interpretation of a predictor's real-world impact [@problem_id:4970705].", "problem": "A clinical study models the probability of post-operative acute kidney injury as a binary outcome using logistic regression. Let $Y \\in \\{0,1\\}$ denote whether acute kidney injury occurs ($Y=1$) or not ($Y=0$). For a patient with covariate vector $\\boldsymbol{x}$, the model specifies the conditional probability $p(\\boldsymbol{x}) = \\mathbb{P}(Y=1 \\mid \\boldsymbol{x})$ through the log-odds (logit) link: the log-odds is linear in the covariates, with linear predictor $\\eta(\\boldsymbol{x}) = \\beta_{0} + \\sum_{k} \\beta_{k} x_{k}$, and probability $p(\\boldsymbol{x})$ obtained by mapping $\\eta(\\boldsymbol{x})$ to the unit interval via the logistic function. Consider a particular continuous covariate $x_{j}$ representing a standardized preoperative biomarker. At a specific patient’s covariate values, the model yields a predicted probability $p(\\boldsymbol{x}) = p = 0.3$, and the estimated coefficient for $x_{j}$ is $\\beta_{j} = 1.2$. Starting from the definition of the logistic regression model and the logistic function, derive the marginal effect of $x_{j}$ on the probability, $\\frac{\\partial p}{\\partial x_{j}}$, evaluated at this patient’s covariates, and compute its numerical value. Express your final answer as a pure number. No rounding is required.", "solution": "The problem is well-posed, scientifically grounded, and provides sufficient information to derive and compute the requested quantity. It is a standard application of differential calculus to the functional form of a logistic regression model. Therefore, the problem is valid.\n\nThe logistic regression model defines the probability of a binary outcome $Y=1$ for a given covariate vector $\\boldsymbol{x}$ as a function of a linear predictor $\\eta(\\boldsymbol{x})$. The relationship is given by the logistic function, often denoted $\\sigma(\\cdot)$:\n$$p(\\boldsymbol{x}) = \\sigma(\\eta(\\boldsymbol{x})) = \\frac{1}{1 + \\exp(-\\eta(\\boldsymbol{x}))}$$\nThe linear predictor $\\eta(\\boldsymbol{x})$ is a linear combination of the covariates:\n$$\\eta(\\boldsymbol{x}) = \\beta_{0} + \\sum_{k} \\beta_{k} x_{k}$$\nwhere $\\beta_0$ is the intercept and $\\beta_k$ are the coefficients for the covariates $x_k$.\n\nWe are asked to find the marginal effect of a specific continuous covariate $x_j$ on the probability $p(\\boldsymbol{x})$. This marginal effect is defined as the partial derivative $\\frac{\\partial p}{\\partial x_{j}}$. To find this derivative, we apply the chain rule of differentiation:\n$$\\frac{\\partial p}{\\partial x_{j}} = \\frac{d p}{d \\eta} \\cdot \\frac{\\partial \\eta}{\\partial x_{j}}$$\n\nFirst, we compute the derivative of the linear predictor $\\eta(\\boldsymbol{x})$ with respect to $x_j$:\n$$\\frac{\\partial \\eta}{\\partial x_{j}} = \\frac{\\partial}{\\partial x_{j}} \\left( \\beta_{0} + \\sum_{k} \\beta_{k} x_{k} \\right)$$\nAssuming the covariates are distinct variables, the derivative of $x_k$ with respect to $x_j$ is $1$ if $k=j$ and $0$ otherwise. Thus, only the term involving $\\beta_j x_j$ contributes to the derivative.\n$$\\frac{\\partial \\eta}{\\partial x_{j}} = \\beta_{j}$$\n\nNext, we compute the derivative of the logistic function $p(\\eta)$ with respect to its argument $\\eta$:\n$$p(\\eta) = (1 + \\exp(-\\eta))^{-1}$$\nUsing the power rule and the chain rule:\n$$\\frac{d p}{d \\eta} = -1 \\cdot (1 + \\exp(-\\eta))^{-2} \\cdot \\frac{d}{d\\eta}(\\exp(-\\eta))$$\n$$\\frac{d p}{d \\eta} = -1 \\cdot (1 + \\exp(-\\eta))^{-2} \\cdot (-\\exp(-\\eta))$$\n$$\\frac{d p}{d \\eta} = \\frac{\\exp(-\\eta)}{(1 + \\exp(-\\eta))^{2}}$$\nThis expression can be conveniently rewritten in terms of $p$ itself. We recognize that:\n$$p = \\frac{1}{1 + \\exp(-\\eta)}$$\nAnd we can write $1-p$ as:\n$$1 - p = 1 - \\frac{1}{1 + \\exp(-\\eta)} = \\frac{(1 + \\exp(-\\eta)) - 1}{1 + \\exp(-\\eta)} = \\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)}$$\nTherefore, the derivative $\\frac{dp}{d\\eta}$ is the product of these two terms:\n$$\\frac{d p}{d \\eta} = \\left( \\frac{1}{1 + \\exp(-\\eta)} \\right) \\cdot \\left( \\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)} \\right) = p \\cdot (1 - p)$$\nThis is a fundamental property of the logistic function.\n\nNow, we combine the two parts of the chain rule to obtain the final expression for the marginal effect:\n$$\\frac{\\partial p}{\\partial x_{j}} = \\frac{d p}{d \\eta} \\cdot \\frac{\\partial \\eta}{\\partial x_{j}} = p(\\boldsymbol{x}) \\cdot (1 - p(\\boldsymbol{x})) \\cdot \\beta_{j}$$\n\nThe problem provides the necessary values evaluated for a specific patient:\nThe predicted probability is $p(\\boldsymbol{x}) = p = 0.3$.\nThe estimated coefficient for the covariate $x_j$ is $\\beta_j = 1.2$.\n\nWe substitute these numerical values into our derived formula for the marginal effect:\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.3 \\cdot (1 - 0.3) \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.3 \\cdot 0.7 \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.21 \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.252$$\nThus, at this patient's covariate values, a one-unit increase in the standardized biomarker $x_j$ is associated with an increase in the probability of acute kidney injury by approximately $0.252$.", "answer": "$$\n\\boxed{0.252}\n$$", "id": "4970705"}]}