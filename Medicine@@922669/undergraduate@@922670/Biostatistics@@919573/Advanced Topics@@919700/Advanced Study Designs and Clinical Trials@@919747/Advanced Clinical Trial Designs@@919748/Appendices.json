{"hands_on_practices": [{"introduction": "Efficient trial design is crucial, especially in early-phase oncology studies where resources are limited and patient safety is paramount. Two-stage designs provide a formal framework for stopping a trial early for futility if a new treatment shows insufficient activity. This practice will walk you through the decision-making process at the end of the first stage, helping you apply the core logic of this efficient design [@problem_id:4892401].", "problem": "A single-arm Phase II oncology study is planned using a two-stage design to allow early termination for lack of activity while controlling type I error and power at design-specified levels. The binary endpoint is objective response (responder versus non-responder). The design specifies a first-stage enrollment of $n_1=18$ participants and a total maximum enrollment of $n=44$ participants. The early futility boundary is $r_1=3$: after the first stage, if the observed number of responders is $x_1 \\le r_1$, the trial stops for futility; otherwise, it proceeds to stage $2$. At the end of stage $2$, efficacy is declared if the total number of responders across both stages is at least the final boundary $r=10$.\n\nSuppose that after completing stage $1$, the observed number of responders is $x_1=5$. Using only the defining properties of this two-stage design and the arithmetic relationship between stage-wise and total responses, determine whether the trial continues beyond stage $1$, and compute the minimum number of additional responders required in stage $2$ among the additional $n-n_1$ participants so that the final decision at $n$ would declare efficacy. Let $Q$ denote this minimum required number of additional responders in stage $2$; report the value of $Q$ as a single integer. No rounding is needed.", "solution": "The problem is a valid application of the principles of a two-stage clinical trial design. All necessary parameters and conditions are provided, and the problem is scientifically grounded, well-posed, and objective. We may proceed with a formal solution.\n\nThe two-stage design is defined by the following parameters:\n-   The number of participants in stage $1$: $n_1 = 18$.\n-   The total number of participants if the trial proceeds to stage $2$: $n = 44$.\n-   The early futility boundary for stage $1$: $r_1 = 3$. If the number of responders in stage $1$, denoted by $x_1$, is less than or equal to this value ($x_1 \\le r_1$), the trial is terminated.\n-   The final efficacy boundary: $r = 10$. If the total number of responders across both stages, denoted by $x$, is greater than or equal to this value ($x \\ge r$), the trial is declared a success.\n\nThe problem provides the observed outcome from stage $1$: the number of responders is $x_1 = 5$.\n\nFirst, we must determine if the trial continues to the second stage. The rule for early termination for futility is to stop if $x_1 \\le r_1$. In this case, we have the observed value $x_1 = 5$ and the futility boundary $r_1 = 3$. We evaluate the condition:\n$$5 \\le 3$$\nThis inequality is false. Since the observed number of responders, $x_1=5$, is greater than the futility boundary, $r_1=3$, the trial does not stop for futility. Therefore, the trial proceeds to the second stage.\n\nIn the second stage, an additional number of participants, $n_2$, will be enrolled. The value of $n_2$ is the difference between the total planned enrollment and the stage $1$ enrollment:\n$$n_2 = n - n_1 = 44 - 18 = 26$$\nLet $x_2$ be the number of responders among these additional $n_2 = 26$ participants in stage $2$.\n\nThe total number of responders at the conclusion of the trial is the sum of responders from both stages:\n$$x = x_1 + x_2$$\nFor the trial to be declared a success (i.e., to declare efficacy), the total number of responders, $x$, must meet or exceed the final efficacy boundary, $r$. The condition for success is:\n$$x \\ge r$$\nSubstituting the expression for $x$, this becomes:\n$$x_1 + x_2 \\ge r$$\nWe are given the observed outcome from stage $1$, $x_1 = 5$, and the final boundary, $r = 10$. We can substitute these values into the inequality:\n$$5 + x_2 \\ge 10$$\nTo find the minimum number of responders required in stage $2$, we solve for $x_2$:\n$$x_2 \\ge 10 - 5$$\n$$x_2 \\ge 5$$\nThe variable $x_2$ represents a count of people (responders), so it must be a non-negative integer. The question asks for the minimum number of additional responders in stage $2$ required to declare efficacy. This quantity is denoted by $Q$. Based on the inequality $x_2 \\ge 5$, the smallest integer value that $x_2$ can take is $5$.\nTherefore, the minimum required number of additional responders in stage $2$ is:\n$$Q = 5$$\nThis is a feasible outcome, as it is possible to observe $5$ responders among the $n_2=26$ participants enrolled in stage $2$ (since $0 \\le 5 \\le 26$).", "answer": "$$\\boxed{5}$$", "id": "4892401"}, {"introduction": "Modern clinical trials often investigate multiple treatments or endpoints simultaneously, which inflates the risk of finding a 'significant' result purely by chance. To maintain scientific rigor, we must adjust for these multiple comparisons, and the Bonferroni-Holm method provides a powerful way to control the overall error rate without being overly conservative. This exercise will guide you through applying this step-down procedure to a realistic multi-arm, multi-endpoint trial scenario [@problem_id:4892393].", "problem": "A multi-arm, multi-endpoint randomized controlled trial compares $m=3$ experimental treatments $\\{A,B,C\\}$ against a shared control on $e=2$ co-primary continuous endpoints $\\{E_{1},E_{2}\\}$. For each arm-endpoint pair, a two-sided large-sample $z$-test for superiority versus control is performed, based on standardized mean differences under a common variance assumption. The null hypotheses are $H_{A,1}$, $H_{A,2}$, $H_{B,1}$, $H_{B,2}$, $H_{C,1}$, and $H_{C,2}$, where $H_{X,j}$ states no difference between arm $X \\in \\{A,B,C\\}$ and control on endpoint $E_{j} \\in \\{E_{1},E_{2}\\}$.\n\nObserved $z$-statistics are:\n- $H_{A,1}$: $z=3.10$,\n- $H_{A,2}$: $z=2.50$,\n- $H_{B,1}$: $z=2.20$,\n- $H_{B,2}$: $z=1.99$,\n- $H_{C,1}$: $z=1.60$,\n- $H_{C,2}$: $z=0.80$.\n\nAssume the null distribution of each $z$-statistic is standard normal and compute two-sided $p$-values as $p=2\\{1-\\Phi(|z|)\\}$, where $\\Phi$ is the cumulative distribution function of the standard normal distribution. Treat the family of all $m\\times e=6$ hypotheses as the multiplicity family requiring strong control of the Family-Wise Error Rate (FWER). Apply the Bonferroni-Holm (Holm) step-down method to obtain adjusted $p$-values for the six hypotheses and determine which are rejected at FWER level $\\alpha=0.05$.\n\nReport only the total number of null hypotheses rejected at $\\alpha=0.05$ using the Holm method across all six tests. The final answer must be a single integer.", "solution": "The problem requires the application of the Bonferroni-Holm (Holm) step-down method to a family of $m \\times e = 3 \\times 2 = 6$ null hypotheses to control the Family-Wise Error Rate (FWER) at a significance level of $\\alpha=0.05$. The total number of hypotheses is $k=6$.\n\nThe Holm procedure is executed in the following steps:\n\n**Step 1: Calculate unadjusted $p$-values**\n\nFirst, we must calculate the two-sided unadjusted $p$-value for each of the six null hypotheses using the given $z$-statistics and the formula $p = 2(1 - \\Phi(|z|))$, where $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution $N(0,1)$.\n\n- For $H_{A,1}$ with $z=3.10$:\n$p_{A,1} = 2(1 - \\Phi(3.10))$. Using standard normal tables or a calculator, $\\Phi(3.10) \\approx 0.99903$.\n$p_{A,1} \\approx 2(1 - 0.99903) = 2(0.00097) = 0.00194$.\n\n- For $H_{A,2}$ with $z=2.50$:\n$p_{A,2} = 2(1 - \\Phi(2.50))$. $\\Phi(2.50) \\approx 0.99379$.\n$p_{A,2} \\approx 2(1 - 0.99379) = 2(0.00621) = 0.01242$.\n\n- For $H_{B,1}$ with $z=2.20$:\n$p_{B,1} = 2(1 - \\Phi(2.20))$. $\\Phi(2.20) \\approx 0.98610$.\n$p_{B,1} \\approx 2(1 - 0.98610) = 2(0.01390) = 0.02780$.\n\n- For $H_{B,2}$ with $z=1.99$:\n$p_{B,2} = 2(1 - \\Phi(1.99))$. $\\Phi(1.99) \\approx 0.97670$.\n$p_{B,2} \\approx 2(1 - 0.97670) = 2(0.02330) = 0.04660$.\n\n- For $H_{C,1}$ with $z=1.60$:\n$p_{C,1} = 2(1 - \\Phi(1.60))$. $\\Phi(1.60) \\approx 0.94520$.\n$p_{C,1} \\approx 2(1 - 0.94520) = 2(0.05480) = 0.10960$.\n\n- For $H_{C,2}$ with $z=0.80$:\n$p_{C,2} = 2(1 - \\Phi(0.80))$. $\\Phi(0.80) \\approx 0.78814$.\n$p_{C,2} \\approx 2(1 - 0.78814) = 2(0.21186) = 0.42372$.\n\n**Step 2: Order the unadjusted $p$-values**\n\nNext, we order the $p$-values from smallest to largest, denoting them as $p_{(1)}, p_{(2)}, \\dots, p_{(6)}$, and keep track of their corresponding null hypotheses $H_{(1)}, H_{(2)}, \\dots, H_{(6)}$.\n\n- $p_{(1)} = p_{A,1} \\approx 0.00194$ (Hypothesis $H_{A,1}$)\n- $p_{(2)} = p_{A,2} \\approx 0.01242$ (Hypothesis $H_{A,2}$)\n- $p_{(3)} = p_{B,1} \\approx 0.02780$ (Hypothesis $H_{B,1}$)\n- $p_{(4)} = p_{B,2} \\approx 0.04660$ (Hypothesis $H_{B,2}$)\n- $p_{(5)} = p_{C,1} \\approx 0.10960$ (Hypothesis $H_{C,1}$)\n- $p_{(6)} = p_{C,2} \\approx 0.42372$ (Hypothesis $H_{C,2}$)\n\n**Step 3: Apply the sequential comparison**\n\nThe Holm method proceeds sequentially by comparing each ordered $p$-value $p_{(j)}$ with a decreasingly stringent significance level $\\frac{\\alpha}{k-j+1}$, for $j = 1, 2, \\dots, k$. The FWER level is $\\alpha=0.05$ and the total number of hypotheses is $k=6$.\n\n- **For $j=1$**: Compare $p_{(1)}$ with $\\frac{\\alpha}{k-1+1} = \\frac{\\alpha}{6} = \\frac{0.05}{6} \\approx 0.00833$.\nWe have $p_{(1)} \\approx 0.00194$.\nThe condition is $0.00194 \\le 0.00833$. This is true.\nTherefore, we **reject** the null hypothesis $H_{(1)}$, which is $H_{A,1}$. We proceed to the next step.\n\n- **For $j=2$**: Compare $p_{(2)}$ with $\\frac{\\alpha}{k-2+1} = \\frac{\\alpha}{5} = \\frac{0.05}{5} = 0.01$.\nWe have $p_{(2)} \\approx 0.01242$.\nThe condition is $0.01242 \\le 0.01$. This is false.\nTherefore, we **fail to reject** the null hypothesis $H_{(2)}$, which is $H_{A,2}$.\n\nAccording to the Holm step-down procedure, once a null hypothesis is not rejected, the procedure stops, and all subsequent null hypotheses with larger $p$-values are also not rejected. Thus, we fail to reject $H_{(2)}, H_{(3)}, H_{(4)}, H_{(5)}$, and $H_{(6)}$.\n\n**Conclusion:**\n\nBased on the Bonferroni-Holm procedure, only the first null hypothesis in the ordered sequence, $H_{A,1}$, is rejected. All other five hypotheses ($H_{A,2}, H_{B,1}, H_{B,2}, H_{C,1}, H_{C,2}$) are not rejected at the FWER level of $\\alpha=0.05$.\n\nThe total number of rejected null hypotheses is $1$.", "answer": "$$\\boxed{1}$$", "id": "4892393"}, {"introduction": "Adaptive clinical trials allow for pre-planned interim analyses to assess accumulating data, offering the flexibility to modify the trial or stop it early. A key tool in this process is conditional power: the probability of achieving a successful outcome at the trial's conclusion, given the results observed so far. This practice demonstrates how to calculate conditional power in a time-to-event setting, a vital skill for making informed decisions during a group sequential trial [@problem_id:4892432].", "problem": "A two-arm randomized time-to-event clinical trial compares an experimental therapy to a control with equal allocation. The primary analysis uses the logrank test oriented so that a positive standardized statistic favors the experimental therapy. An interim analysis was conducted after a total of $D_{i} = 150$ events, yielding an observed interim logrank $Z$-score of $Z_{i} = 1.20$. The final analysis is planned at $D_{T} = 400$ total events and will use a one-sided Type I error rate of $\\alpha = 0.025$, corresponding to a standard normal critical value $z_{\\alpha}$.\n\nAssume the Cox proportional hazards model holds with a constant hazard ratio $HR$ for the experimental arm relative to control from the interim onward, and take $HR = 0.80$. Let $\\beta = \\ln(HR)$ denote the log hazard ratio. Work under the information accrual framework in which the logrank score process has independent increments and the observed Fisher information for $\\beta$ is approximated by $I \\approx p(1-p)D$, where $p$ is the randomization proportion to the experimental arm and $D$ is the cumulative number of observed events. For equal allocation, use $p = 1/2$.\n\nStarting from these principles, derive the conditional distribution of the final standardized logrank statistic given the observed interim $Z$-score, and then compute the conditional power to reject the null hypothesis at the final analysis under the assumed $HR$. Express the final conditional power as a decimal and round your answer to four significant figures.", "solution": "The solution proceeds by first establishing the theoretical framework for the distribution of the logrank statistic over time, then deriving the conditional distribution of the final statistic given the interim result, and finally calculating the conditional power.\n\nThe logrank score statistic, let's call it $S$, is known to behave approximately as a Brownian motion with drift, indexed by Fisher information $I$. The property of independent increments means that the increment of the score statistic from information level $I_i$ to $I_T$, denoted by $S_T - S_i$, is independent of the score statistic at the interim analysis, $S_i$.\n\nThe standardized logrank statistic at information level $I$ is $Z = S / \\sqrt{I}$. Under the alternative hypothesis with log-hazard ratio $\\beta = \\ln(HR)$, the score statistic $S$ is approximately distributed as $S \\sim N(\\mu_S, I)$, where $\\mu_S$ is the mean. The problem states that a positive statistic favors the experimental therapy. Since $HR=0.80 < 1$ favors the experimental therapy, this implies that the expected value of the Z-statistic should be positive. A hazard ratio less than 1 ($\\beta < 0$) typically yields a negative score statistic under standard definitions. Therefore, to align with the problem's convention, the mean of the score statistic must be defined in opposition to the sign of $\\beta$. We thus take the mean of $S$ to be $-\\beta I$.\nSo, $S \\sim N(-\\beta I, I)$, and the standardized statistic $Z$ is approximately distributed as $Z \\sim N(-\\beta\\sqrt{I}, 1)$.\n\nThe information $I$ is given by $I \\approx p(1-p)D$. With equal allocation, $p=1/2$, so $p(1-p) = 1/4$.\nThe information at the interim and final analyses are:\n$I_i \\approx \\frac{1}{4}D_i$\n$I_T \\approx \\frac{1}{4}D_T$\nThe ratio of information levels, also known as the information fraction, is $\\tau = \\frac{I_i}{I_T} = \\frac{D_i}{D_T}$.\n\nThe final score statistic $S_T$ can be expressed as the sum of the interim score and the increment from interim to final: $S_T = S_i + (S_T - S_i)$.\nThe distributions are:\n$S_i \\sim N(-\\beta I_i, I_i)$\n$S_T - S_i \\sim N(-\\beta (I_T - I_i), I_T - I_i)$\n\nConditional on the observed interim score $s_i$, the distribution of the final score $S_T$ is:\n$S_T | (S_i = s_i) \\sim N(s_i - \\beta(I_T - I_i), I_T - I_i)$\n\nWe are given the observed standardized statistic $Z_i = z_i = 1.20$. We can write $s_i = z_i \\sqrt{I_i}$. Substituting this into the conditional distribution of $S_T$ and standardizing to get the final Z-score, $Z_T = S_T / \\sqrt{I_T}$:\n$Z_T | (Z_i=z_i) \\sim N\\left(\\frac{z_i \\sqrt{I_i} - \\beta(I_T - I_i)}{\\sqrt{I_T}}, \\frac{I_T - I_i}{I_T}\\right)$\n\nThe mean and variance of this conditional normal distribution can be simplified using the information fraction $\\tau$:\nConditional Mean: $\\mu_c = \\frac{z_i \\sqrt{I_i}}{\\sqrt{I_T}} - \\frac{\\beta(I_T - I_i)}{\\sqrt{I_T}} = z_i \\sqrt{\\tau} - \\beta\\sqrt{I_T}(1-\\tau)$\nConditional Variance: $\\sigma_c^2 = \\frac{I_T - I_i}{I_T} = 1 - \\tau$\n\nNow, we substitute the given numerical values:\n$D_i = 150$, $D_T = 400 \\implies \\tau = \\frac{150}{400} = \\frac{3}{8} = 0.375$.\n$p=1/2$, so $I_T \\approx \\frac{1}{4} D_T = \\frac{1}{4}(400) = 100$.\n$HR = 0.80 \\implies \\beta = \\ln(0.80) \\approx -0.22314$.\n$Z_i = z_i = 1.20$.\n\nLet's compute the conditional mean $\\mu_c$ and variance $\\sigma_c^2$:\n$\\mu_c = 1.20 \\sqrt{0.375} - \\ln(0.80) \\sqrt{100} (1 - 0.375)$\n$\\mu_c \\approx 1.20 \\times 0.61237 - (-0.22314) \\times 10 \\times 0.625$\n$\\mu_c \\approx 0.73485 + 1.39463 \\approx 2.12948$\n\n$\\sigma_c^2 = 1 - 0.375 = 0.625$\n$\\sigma_c = \\sqrt{0.625} \\approx 0.79057$\n\nSo, the conditional distribution of the final statistic is $Z_T | (Z_i=1.20) \\sim N(2.12948, 0.625)$.\n\nThe final analysis will reject the null hypothesis if $Z_T > z_\\alpha$. The one-sided significance level is $\\alpha=0.025$. The corresponding critical value $z_{0.025}$ is the value such that $P(Z > z_{0.025}) = 0.025$ for a standard normal variable $Z$, which is $z_{0.025} = \\Phi^{-1}(1 - 0.025) = \\Phi^{-1}(0.975) \\approx 1.95996$.\n\nThe conditional power is the probability $P(Z_T > z_{0.025} | Z_i = 1.20)$. To calculate this, we standardize the variable $Z_T$ using its conditional distribution parameters:\nConditional Power $= P\\left(\\frac{Z_T - \\mu_c}{\\sigma_c} > \\frac{z_{0.025} - \\mu_c}{\\sigma_c}\\right)$\nLet $W = \\frac{Z_T - \\mu_c}{\\sigma_c}$, where $W \\sim N(0,1)$.\nConditional Power $= P\\left(W > \\frac{1.95996 - 2.12948}{0.79057}\\right)$\nConditional Power $= P\\left(W > \\frac{-0.16952}{0.79057}\\right)$\nConditional Power $\\approx P(W > -0.21445)$\n\nUsing the symmetry of the standard normal distribution, $P(W > -x) = P(W < x) = \\Phi(x)$, where $\\Phi$ is the standard normal cumulative distribution function.\nConditional Power $\\approx \\Phi(0.21445)$\n\nUsing a standard normal distribution calculator, $\\Phi(0.21445) \\approx 0.58493$.\nRounding to four significant figures, the conditional power is $0.5849$.", "answer": "$$\\boxed{0.5849}$$", "id": "4892432"}]}