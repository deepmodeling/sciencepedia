{"hands_on_practices": [{"introduction": "The Kaplan-Meier (KM) estimator is the cornerstone of non-parametric survival analysis, providing a way to estimate the survival function from time-to-event data. This hands-on exercise demystifies the familiar KM curve by guiding you through its construction from first principles. By manually calculating survival probabilities for a small clinical cohort [@problem_id:4962132], you will gain a concrete understanding of how the estimator correctly handles right-censored observations through the dynamic accounting of the risk set at each event time.", "problem": "A clinical cohort of $12$ patients is followed from study entry to either a disease event or administrative right-censoring. Assume independent, non-informative right-censoring and that, when an event and a censoring share the same recorded time, the event is considered to occur just before the censoring for risk set accounting. Time is measured in months. The observed data for each patient are given as an ordered pair $(\\text{time}, \\text{indicator})$, where $\\text{indicator}=1$ denotes an observed event and $\\text{indicator}=0$ denotes a right-censoring:\n- Subject $1$: $(3, 1)$\n- Subject $2$: $(4, 0)$\n- Subject $3$: $(4, 1)$\n- Subject $4$: $(5, 1)$\n- Subject $5$: $(6, 0)$\n- Subject $6$: $(7, 1)$\n- Subject $7$: $(7, 0)$\n- Subject $8$: $(8, 1)$\n- Subject $9$: $(9, 1)$\n- Subject $10$: $(11, 0)$\n- Subject $11$: $(12, 1)$\n- Subject $12$: $(12, 0)$\n\nStarting from first principles appropriate for time-to-event data, including the definition of the survival function $S(t)=\\Pr(Tt)$ and the notion of conditional event probabilities at distinct observed event times under right-censoring, construct the nonparametric product-limit estimator of $S(t)$ by expressing it as a product over distinct observed event times. In your construction, precisely define the symbols that count the numbers of events and the numbers at risk at each distinct event time.\n\nThen, using your constructed estimator, compute the estimated survival probability at $t=10$ months for the data above. Round your final numerical answer to four significant figures and express it as a decimal.", "solution": "The problem is valid as it is scientifically grounded in the principles of biostatistics, specifically survival analysis, is well-posed with a complete and consistent set of data and assumptions, and is expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe problem requires the construction of the product-limit estimator for the survival function, $S(t)$, and its application to a given dataset to find the estimated survival probability at $t=10$ months.\n\nFirst, we construct the estimator from first principles. The survival function, $S(t)$, is defined as the probability that the true event time, a random variable $T$, is greater than some specified time $t$:\n$$S(t) = \\Pr(T  t)$$\nLet the distinct ordered event times observed in the cohort be $t_{(1)}  t_{(2)}  \\dots  t_{(k)}$. The survival function can be expressed as a product of conditional probabilities over the intervals defined by these event times. For any time $t$ such that $t_{(j)} \\le t  t_{(j+1)}$, the probability of surviving beyond $t$ is the same as surviving beyond $t_{(j)}$. This can be written as:\n$$S(t) = \\Pr(T  t_{(j)}) = \\Pr(T  t_{(1)}) \\times \\Pr(T  t_{(2)} | T  t_{(1)}) \\times \\dots \\times \\Pr(T  t_{(j)} | T  t_{(j-1)})$$\nUsing the product notation, and defining $t_{(0)} = 0$, we have:\n$$S(t) = \\prod_{i: t_{(i)} \\le t} \\Pr(T  t_{(i)} | T  t_{(i-1)})$$\nUnder the assumption of non-informative censoring, we can estimate each conditional probability term from the observed data. Let us define the following quantities for each distinct event time $t_{(i)}$:\n-   $n_i$: The number of individuals at risk of experiencing the event just prior to time $t_{(i)}$. This constitutes the risk set. These are all subjects whose observed time (event or censoring) is greater than or equal to $t_{(i)}$.\n-   $d_i$: The number of individuals who experience the event at time $t_{(i)}$.\n\nThe conditional probability of an event occurring at time $t_{(i)}$, given that a subject has survived up to that time, can be estimated by the proportion of subjects at risk who experience the event at $t_{(i)}$:\n$$\\widehat{\\Pr}(T = t_{(i)} | T \\ge t_{(i)}) = \\frac{d_i}{n_i}$$\nConsequently, the conditional probability of surviving past time $t_{(i)}$, given survival up to that time, is estimated as:\n$$\\widehat{\\Pr}(T  t_{(i)} | T \\ge t_{(i)}) = 1 - \\frac{d_i}{n_i}$$\nSince there are no events between $t_{(i-1)}$ and $t_{(i)}$, $\\Pr(T  t_{(i)} | T  t_{(i-1)})$ is equivalent to $\\Pr(T  t_{(i)} | T \\ge t_{(i)})$. Substituting this estimate into the product expression for $S(t)$ yields the product-limit estimator, also known as the Kaplan-Meier estimator, $\\hat{S}(t)$:\n$$\\hat{S}(t) = \\prod_{i: t_{(i)} \\le t} \\left(1 - \\frac{d_i}{n_i}\\right)$$\nBy convention, $\\hat{S}(t) = 1$ for $t  t_{(1)}$.\n\nNext, we apply this estimator to the provided data to compute $\\hat{S}(10)$. We must first determine the values of $n_i$ and $d_i$ at each distinct event time. The total number of subjects is $N=12$.\nThe ordered times of events or censorings are: $3(1), 4(0), 4(1), 5(1), 6(0), 7(1), 7(0), 8(1), 9(1), 11(0), 12(1), 12(0)$.\nThe distinct event times are $3, 4, 5, 7, 8, 9, 12$. We need to calculate $\\hat{S}(10)$, so we consider all event times $t_{(i)} \\le 10$. These are $t_{(1)}=3, t_{(2)}=4, t_{(3)}=5, t_{(4)}=7, t_{(5)}=8, t_{(6)}=9$.\n\nWe construct a life table to organize the calculation. The rule for ties in time between an event and a censoring is that the subject being censored is included in the risk set for that time.\n\n-   At $t_{(1)} = 3$:\n    The number of subjects at risk is all $12$ subjects, so $n_1 = 12$.\n    One subject has an event, so $d_1 = 1$.\n    The survival factor is $1 - \\frac{d_1}{n_1} = 1 - \\frac{1}{12} = \\frac{11}{12}$.\n\n-   At $t_{(2)} = 4$:\n    One subject had an event at $t=3$. The number of subjects at risk is $12 - 1 = 11$, so $n_2 = 11$. (Subject $2$, censored at $t=4$, is included in this risk set).\n    One subject has an event, so $d_2 = 1$.\n    The survival factor is $1 - \\frac{d_2}{n_2} = 1 - \\frac{1}{11} = \\frac{10}{11}$.\n\n-   At $t_{(3)} = 5$:\n    At $t=4$, one subject had an event and one was censored. The number of subjects at risk is $11 - 2 = 9$, so $n_3 = 9$.\n    One subject has an event, so $d_3 = 1$.\n    The survival factor is $1 - \\frac{d_3}{n_3} = 1 - \\frac{1}{9} = \\frac{8}{9}$.\n\n-   At $t_{(4)} = 7$:\n    At $t=5$, one subject had an event. At $t=6$, one was censored. The number of subjects at risk is $9 - 2 = 7$, so $n_4 = 7$. (Subject $7$, censored at $t=7$, is included).\n    One subject has an event, so $d_4 = 1$.\n    The survival factor is $1 - \\frac{d_4}{n_4} = 1 - \\frac{1}{7} = \\frac{6}{7}$.\n\n-   At $t_{(5)} = 8$:\n    At $t=7$, one subject had an event and one was censored. The number of subjects at risk is $7 - 2 = 5$, so $n_5 = 5$.\n    One subject has an event, so $d_5 = 1$.\n    The survival factor is $1 - \\frac{d_5}{n_5} = 1 - \\frac{1}{5} = \\frac{4}{5}$.\n\n-   At $t_{(6)} = 9$:\n    At $t=8$, one subject had an event. The number of subjects at risk is $5 - 1 = 4$, so $n_6 = 4$.\n    One subject has an event, so $d_6 = 1$.\n    The survival factor is $1 - \\frac{d_6}{n_6} = 1 - \\frac{1}{4} = \\frac{3}{4}$.\n\nThe next event time is at $t=12$, which is greater than $10$. Therefore, the survival probability estimate $\\hat{S}(10)$ is the product of the survival factors for all event times up to and including $t=9$.\n$$\\hat{S}(10) = \\prod_{i=1}^{6} \\left(1 - \\frac{d_i}{n_i}\\right)$$\n$$\\hat{S}(10) = \\left(\\frac{11}{12}\\right) \\times \\left(\\frac{10}{11}\\right) \\times \\left(\\frac{8}{9}\\right) \\times \\left(\\frac{6}{7}\\right) \\times \\left(\\frac{4}{5}\\right) \\times \\left(\\frac{3}{4}\\right)$$\nWe can simplify this product by canceling terms:\n$$\\hat{S}(10) = \\frac{11 \\times 10 \\times 8 \\times 6 \\times 4 \\times 3}{12 \\times 11 \\times 9 \\times 7 \\times 5 \\times 4}$$\nCanceling the $11$s and $4$s:\n$$\\hat{S}(10) = \\frac{10 \\times 8 \\times 6 \\times 3}{12 \\times 9 \\times 7 \\times 5}$$\nFactoring terms to simplify further:\n$$\\hat{S}(10) = \\frac{(2 \\times 5) \\times 8 \\times 6 \\times 3}{(2 \\times 6) \\times (3 \\times 3) \\times 7 \\times 5}$$\nCanceling $(2 \\times 5 \\times 6 \\times 3)$:\n$$\\hat{S}(10) = \\frac{8}{3 \\times 7} = \\frac{8}{21}$$\nTo provide the numerical answer, we convert the fraction to a decimal and round to four significant figures as requested.\n$$\\frac{8}{21} \\approx 0.38095238...$$\nRounding to four significant figures gives $0.3810$.", "answer": "$$\\boxed{0.3810}$$", "id": "4962132"}, {"introduction": "Real-world studies often involve competing risks, where subjects can experience different types of events that preclude one another, such as death from a specific disease versus death from other causes. A common but serious error is to treat these competing events as simple right-censoring. This practice exercise [@problem_id:4962185] makes the consequences of this mistake tangible by asking you to derive and quantify the resulting bias, revealing how the true probability of an event (the cumulative incidence function) can be significantly overestimated by a naive analysis.", "problem": "A cohort of individuals is followed from baseline to assess time to a disease-specific death ($k=1$) in the presence of a competing event (death from other causes, $k=2$). Assume that events follow a competing risks structure with constant cause-specific hazards: the disease-specific hazard is $\\lambda_{1}(t)=\\lambda_{1}$ and the other-cause hazard is $\\lambda_{2}(t)=\\lambda_{2}$, where both $\\lambda_{1}$ and $\\lambda_{2}$ are positive constants. Assume there is no loss to follow-up and no administrative censoring; only the competing event prevents the occurrence of the disease-specific event. The independence and non-informative censoring assumptions apply whenever there is censoring unrelated to failure types, but here the competing event precludes the event of interest.\n\nBy definition, the cumulative incidence function (CIF) for cause $k$, denoted $F_{k}(t)$, is the probability that failure due to cause $k$ occurs by time $t$. Consider a common but incorrect practice where the competing event ($k=2$) is treated as independent right-censoring when estimating the risk for cause $k=1$ using the Kaplanâ€“Meier (KM) estimator. Under this incorrect practice, the estimator targets the net risk had competing events been removed.\n\nStarting from core definitions of hazard, survival, and the probability of cause-specific failure over time, derive the analytic expression for the bias at time $t$, defined as the difference between the incorrect KM-based estimate (that treats the competing event as independent censoring) and the true cumulative incidence function for cause $k=1$. Then, evaluate this bias numerically for $\\lambda_{1}=0.05$ (per year), $\\lambda_{2}=0.10$ (per year), and $t=5$ (years). Express your final numerical result as a decimal probability and round your answer to four significant figures.", "solution": "The problem requires us to derive the analytical expression for the bias that arises from incorrectly using a Kaplan-Meier (KM) based approach to estimate the risk of an event in the presence of competing risks, and then to calculate this bias for a specific set of parameters. The bias at a given time $t$ is the difference between the incorrect estimate of risk and the true cumulative incidence function (CIF).\n\nLet $T$ be the time to the first event and $K$ be the type of event, where $K=1$ for disease-specific death and $K=2$ for death from other causes. The cause-specific hazards are given as constants: $\\lambda_{1}(t) = \\lambda_{1}  0$ and $\\lambda_{2}(t) = \\lambda_{2}  0$.\n\nFirst, we derive the expression for the true cumulative incidence function for cause $1$, denoted $F_{1}(t)$. The CIF is the probability of failing from cause $1$ by time $t$, $P(T \\le t, K=1)$. This requires the overall survival function, $S(t)$, which is the probability of being event-free (from any cause) at time $t$.\n\nThe overall hazard rate, $\\lambda(t)$, is the sum of the cause-specific hazard rates:\n$$ \\lambda(t) = \\lambda_{1}(t) + \\lambda_{2}(t) = \\lambda_{1} + \\lambda_{2} $$\nThe overall survival function $S(t)$ is given by:\n$$ S(t) = \\exp\\left(-\\int_{0}^{t} \\lambda(u) \\, du\\right) $$\nSince the overall hazard rate is constant, the integral is straightforward:\n$$ S(t) = \\exp\\left(-\\int_{0}^{t} (\\lambda_{1} + \\lambda_{2}) \\, du\\right) = \\exp(-(\\lambda_{1} + \\lambda_{2})t) $$\nThe CIF for cause $k=1$, $F_{1}(t)$, is the integral of its cause-specific hazard multiplied by the overall survival function over the time interval $[0, t]$:\n$$ F_{1}(t) = \\int_{0}^{t} \\lambda_{1}(u) S(u) \\, du $$\nSubstituting the expressions for $\\lambda_{1}(u)$ and $S(u)$:\n$$ F_{1}(t) = \\int_{0}^{t} \\lambda_{1} \\exp(-(\\lambda_{1} + \\lambda_{2})u) \\, du $$\n$$ F_{1}(t) = \\lambda_{1} \\left[ \\frac{\\exp(-(\\lambda_{1} + \\lambda_{2})u)}{-(\\lambda_{1} + \\lambda_{2})} \\right]_{0}^{t} $$\n$$ F_{1}(t) = \\lambda_{1} \\left( \\frac{\\exp(-(\\lambda_{1} + \\lambda_{2})t)}{-(\\lambda_{1} + \\lambda_{2})} - \\frac{\\exp(0)}{-(\\lambda_{1} + \\lambda_{2})} \\right) $$\n$$ F_{1}(t) = \\frac{\\lambda_{1}}{\\lambda_{1} + \\lambda_{2}} \\left( 1 - \\exp(-(\\lambda_{1} + \\lambda_{2})t) \\right) $$\nThis is the correct expression for the cumulative incidence of cause $1$.\n\nNext, we derive the expression for the incorrect risk estimate obtained by treating the competing event ($k=2$) as independent right-censoring. The Kaplan-Meier estimator under this incorrect assumption targets the *net* survival function for cause $1$, which we denote $S_{1}^{*}(t)$. This function describes the survival probability in a hypothetical scenario where cause $1$ is the only possible event. The hazard for this scenario is simply $\\lambda_1(t) = \\lambda_1$.\n$$ S_{1}^{*}(t) = \\exp\\left(-\\int_{0}^{t} \\lambda_{1}(u) \\, du\\right) = \\exp(-\\lambda_{1} t) $$\nThe corresponding cumulative risk estimate, which we denote $F_{KM,1}(t)$, is $1$ minus this net survival function:\n$$ F_{KM,1}(t) = 1 - S_{1}^{*}(t) = 1 - \\exp(-\\lambda_{1} t) $$\nThis quantity is often referred to as the net risk.\n\nThe analytical expression for the bias at time $t$ is the difference between the incorrect estimate and the true CIF:\n$$ \\text{Bias}(t) = F_{KM,1}(t) - F_{1}(t) $$\nSubstituting the derived expressions:\n$$ \\text{Bias}(t) = \\left(1 - \\exp(-\\lambda_{1} t)\\right) - \\left(\\frac{\\lambda_{1}}{\\lambda_{1} + \\lambda_{2}} \\left( 1 - \\exp(-(\\lambda_{1} + \\lambda_{2})t) \\right)\\right) $$\nThis is the required analytical expression for the bias.\n\nNow, we evaluate this bias numerically for the given parameters: $\\lambda_{1}=0.05$, $\\lambda_{2}=0.10$, and $t=5$.\n\nFirst, calculate the incorrect KM-based estimate $F_{KM,1}(5)$:\n$$ F_{KM,1}(5) = 1 - \\exp(-\\lambda_{1} t) = 1 - \\exp(-0.05 \\times 5) = 1 - \\exp(-0.25) $$\nNext, calculate the true CIF $F_{1}(5)$:\n$$ F_{1}(5) = \\frac{\\lambda_{1}}{\\lambda_{1} + \\lambda_{2}} \\left( 1 - \\exp(-(\\lambda_{1} + \\lambda_{2})t) \\right) $$\n$$ F_{1}(5) = \\frac{0.05}{0.05 + 0.10} \\left( 1 - \\exp(-(0.05 + 0.10) \\times 5) \\right) $$\n$$ F_{1}(5) = \\frac{0.05}{0.15} \\left( 1 - \\exp(-0.15 \\times 5) \\right) = \\frac{1}{3} \\left( 1 - \\exp(-0.75) \\right) $$\nThe bias at $t=5$ is:\n$$ \\text{Bias}(5) = \\left(1 - \\exp(-0.25)\\right) - \\frac{1}{3} \\left(1 - \\exp(-0.75)\\right) $$\nNow we compute the numerical values:\n$$ \\exp(-0.25) \\approx 0.77880078 $$\n$$ \\exp(-0.75) \\approx 0.47236655 $$\nSubstituting these values into the bias expression:\n$$ \\text{Bias}(5) \\approx (1 - 0.77880078) - \\frac{1}{3}(1 - 0.47236655) $$\n$$ \\text{Bias}(5) \\approx 0.22119922 - \\frac{1}{3}(0.52763345) $$\n$$ \\text{Bias}(5) \\approx 0.22119922 - 0.17587782 $$\n$$ \\text{Bias}(5) \\approx 0.04532140 $$\nRounding the result to four significant figures, we get $0.04532$.", "answer": "$$ \\boxed{0.04532} $$", "id": "4962185"}, {"introduction": "Beyond simply estimating survival probabilities, we often want to understand how covariates like treatment exposure or patient characteristics influence the time to an event. The Cox proportional hazards model is the most widely used tool for this type of survival regression. Its power and elegance stem from the use of a partial likelihood, which ingeniously allows us to estimate the effects of covariates without needing to specify or estimate the underlying baseline hazard function. This foundational exercise [@problem_id:4962119] will guide you through the derivation of this powerful statistical engine, revealing the logic of conditional probability that makes the Cox model so effective.", "problem": "A cohort study follows $n$ independent individuals indexed by $i \\in \\{1,\\dots,n\\}$, each with a fixed covariate vector $x_i \\in \\mathbb{R}^{p}$ recorded at baseline. Let the true event time be $T_i$ and the right-censoring time be $C_i$, with the observed time $Y_i = \\min\\{T_i, C_i\\}$ and the event indicator $\\delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$. Assume right-censoring is non-informative given covariates in the sense that, conditional on $x_i$, the censoring process is independent of the failure process.\n\nSuppose the failure time follows a Cox proportional hazards model, that is, the hazard function satisfies $h(t \\mid x_i) = h_0(t) \\exp(x_i^{\\top}\\beta)$ for a baseline hazard $h_0(t)$ and a regression coefficient vector $\\beta \\in \\mathbb{R}^{p}$. Let the distinct observed failure times be $t_{(1)}  t_{(2)}  \\dots  t_{(K)}$, with no tied failures, and define the risk set at time $t$ as $R(t) = \\{i : Y_i \\ge t\\}$.\n\nStarting from the definitions of hazard, survivor function, and conditional probability, and using the non-informative censoring assumption, derive the partial likelihood for $\\beta$ by conditioning on the set of observed failure times and eliminating any nuisance baseline hazard terms. Your derivation must start from first principles (e.g., the definition of the hazard as an instantaneous failure rate and the construction of conditional probabilities among risk sets) and clearly justify each step leading to a product form over the observed failures.\n\nProvide the final analytic expression for the partial likelihood $L(\\beta)$ in terms of $\\{x_i, Y_i, \\delta_i\\}_{i=1}^{n}$ and the risk sets $R(t)$, expressed as a single closed-form product that depends on $\\beta$ only through the covariates. No numerical evaluation is required. The final answer must be presented as a single mathematical expression.", "solution": "The user wants to derive the partial likelihood for the Cox proportional hazards model.\n\n### Step 1: Extract Givens\n-   **Study Population:** A cohort of $n$ independent individuals, indexed by $i \\in \\{1, \\dots, n\\}$.\n-   **Covariates:** A fixed baseline covariate vector $x_i \\in \\mathbb{R}^{p}$ for each individual $i$.\n-   **True Event Time:** $T_i$.\n-   **Right-Censoring Time:** $C_i$.\n-   **Observed Data:** The observed time is $Y_i = \\min\\{T_i, C_i\\}$, and the event indicator is $\\delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$, where $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n-   **Censoring Assumption:** Right-censoring is non-informative, meaning the censoring process is independent of the failure process conditional on the covariates $x_i$.\n-   **Hazard Model:** The failure time follows a Cox proportional hazards model, with the hazard function for individual $i$ given by $h(t \\mid x_i) = h_0(t) \\exp(x_i^{\\top}\\beta)$. Here, $h_0(t)$ is the baseline hazard function and $\\beta \\in \\mathbb{R}^{p}$ is the vector of regression coefficients.\n-   **Observed Failures:** The distinct observed failure times are denoted by $t_{(1)}  t_{(2)}  \\dots  t_{(K)}$, with the simplifying assumption of no tied failures.\n-   **Risk Set:** The risk set at time $t$ is defined as $R(t) = \\{i : Y_i \\ge t\\}$, which comprises all individuals who are still under observation (neither failed nor censored) just prior to time $t$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to scrutiny based on the established criteria.\n\n-   **Scientific Grounding:** The problem is fundamentally sound. It describes a standard setup in survival analysis, a major subfield of biostatistics. The Cox proportional hazards model, right-censoring, non-informative censoring, and partial likelihood are all cornerstone concepts in this field.\n-   **Well-Posedness:** The problem is well-posed. It asks for the derivation of a specific, well-defined statistical quantity (the partial likelihood) under a standard set of assumptions (proportional hazards, non-informative censoring, no ties). The goal is clear, and a unique analytical expression is attainable.\n-   **Objectivity:** The problem is stated using precise, objective mathematical and statistical language, free of any subjectivity or ambiguity.\n-   **Completeness and Consistency:** The problem provides all necessary information for the derivation. The model, data structure, assumptions, and definitions are complete and consistent with each other. The assumption of \"no tied failures\" simplifies the derivation but does not render the problem invalid; it is a common starting point in textbook treatments of the topic.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard and important theoretical exercise in biostatistics. The derivation will now proceed from first principles as requested.\n\nThe derivation of the partial likelihood for the parameter vector $\\beta$ hinges on a crucial insight by D.R. Cox, which involves reframing the likelihood construction to eliminate the infinite-dimensional nuisance parameter, the baseline hazard $h_0(t)$. Instead of constructing the full likelihood of the observed times and event statuses, we construct a likelihood based on a sequence of conditional probabilities at each observed failure time.\n\nFrom first principles, the hazard function $h(t \\mid x_i)$ represents the instantaneous rate of failure at time $t$, given the individual has survived up to time $t$. Formally, for a small time interval $dt$, we have:\n$$ P(t \\leq T_i  t+dt \\mid T_i \\geq t, x_i) \\approx h(t \\mid x_i) dt $$\nThe model for the hazard is given as $h(t \\mid x_i) = h_0(t) \\exp(x_i^{\\top}\\beta)$.\n\nLet the $K$ distinct, ordered failure times be $t_{(1)}  t_{(2)}  \\dots  t_{(K)}$. Let $i_j$ be the index of the specific individual who is observed to fail at time $t_{(j)}$. The risk set at this time is $R(t_{(j)}) = \\{k : Y_k \\geq t_{(j)}\\}$. By definition, the individual $i_j$ must be in the risk set $R(t_{(j)})$.\n\nThe core of the partial likelihood argument is to consider, at each failure time $t_{(j)}$, the conditional probability that the failure is observed in individual $i_j$, given the specific risk set $R(t_{(j)})$ and the fact that exactly one failure occurs at this time.\n\nLet's compute this conditional probability for the $j$-th failure at time $t_{(j)}$. The event of interest is \"individual $i_j$ fails at $t_{(j)}$\". The conditioning event is \"exactly one failure occurs at time $t_{(j)}$ among the individuals in the risk set $R(t_{(j)})$\".\n\nThe probability that an arbitrary individual $k \\in R(t_{(j)})$ fails in the infinitesimal interval $[t_{(j)}, t_{(j)}+dt)$ is approximately $h(t_{(j)} \\mid x_k) dt$. The probability that this individual does not fail is $1 - h(t_{(j)} \\mid x_k) dt$.\n\nThe probability that exactly one individual from the risk set $R(t_{(j)})$ fails in the interval is the sum of probabilities that a specific individual $k$ fails and all others in the risk set do not. Assuming $dt$ is small enough that terms of order $(dt)^2$ and higher are negligible, this probability is:\n$$ P(\\text{one failure from } R(t_{(j)})) \\approx \\sum_{k \\in R(t_{(j)})} P(\\text{individual } k \\text{ fails}) = \\sum_{k \\in R(t_{(j)})} h(t_{(j)} \\mid x_k) dt $$\nThe probability that the specific individual $i_j$ is the one who fails is approximately $h(t_{(j)} \\mid x_{i_j}) dt$.\n\nThe conditional probability, which forms the $j$-th term of the partial likelihood, is therefore:\n$$ L_j(\\beta) = \\frac{P(\\text{individual } i_j \\text{ fails in } [t_{(j)}, t_{(j)}+dt))}{P(\\text{one failure from } R(t_{(j)}) \\text{ in } [t_{(j)}, t_{(j)}+dt))} \\approx \\frac{h(t_{(j)} \\mid x_{i_j}) dt}{\\sum_{k \\in R(t_{(j)})} h(t_{(j)} \\mid x_k) dt} $$\nThe term $dt$ cancels.\n$$ L_j(\\beta) = \\frac{h(t_{(j)} \\mid x_{i_j})}{\\sum_{k \\in R(t_{(j)})} h(t_{(j)} \\mid x_k)} $$\nNow, we substitute the Cox model specification, $h(t \\mid x_k) = h_0(t) \\exp(x_k^{\\top}\\beta)$:\n$$ L_j(\\beta) = \\frac{h_0(t_{(j)}) \\exp(x_{i_j}^{\\top}\\beta)}{\\sum_{k \\in R(t_{(j)})} h_0(t_{(j)}) \\exp(x_k^{\\top}\\beta)} $$\nThe baseline hazard term $h_0(t_{(j)})$, which is a common factor for all individuals at risk at time $t_{(j)}$, cancels from the numerator and the denominator. This is the pivotal step that eliminates the nuisance parameter.\n$$ L_j(\\beta) = \\frac{\\exp(x_{i_j}^{\\top}\\beta)}{\\sum_{k \\in R(t_{(j)})} \\exp(x_k^{\\top}\\beta)} $$\nThis term depends only on the parameter vector $\\beta$ and the covariate data of the individuals in the risk set at time $t_{(j)}$. The non-informative censoring assumption is crucial for this step, as it ensures that the composition of the risk set at any time $t$ is not biased with respect to future failure risk, beyond what is explained by the covariates.\n\nThe total partial likelihood, $L(\\beta)$, is formed by multiplying these conditional probability terms for all $K$ observed failures. This is justified by treating the sequence of failure events as a series of conditionally independent events, given the risk sets.\n$$ L(\\beta) = \\prod_{j=1}^{K} L_j(\\beta) = \\prod_{j=1}^{K} \\frac{\\exp(x_{i_j}^{\\top}\\beta)}{\\sum_{k \\in R(t_{(j)})} \\exp(x_k^{\\top}\\beta)} $$\nThis expression is a product over the observed failure events. To express it in terms of the full dataset $\\{x_i, Y_i, \\delta_i\\}_{i=1}^{n}$, we can rewrite the product to be over all $n$ individuals. The event indicator $\\delta_i$ is used to select only those individuals who were observed to fail. If an individual $i$ fails, then $\\delta_i=1$, their failure time is $Y_i$, and they contribute one term to the product. If they are censored, $\\delta_i=0$, and their contribution to the product should be $1$. This is achieved by using $\\delta_i$ as an exponent:\n$$ L(\\beta) = \\prod_{i=1}^{n} \\left[ \\frac{\\exp(x_i^{\\top}\\beta)}{\\sum_{j \\in R(Y_i)} \\exp(x_j^{\\top}\\beta)} \\right]^{\\delta_i} $$\nIn this final form, the product is taken over all individuals $i$ from $1$ to $n$. If $\\delta_i=0$, the term in brackets is raised to the power of $0$, which equals $1$, so censored individuals do not alter the likelihood value. If $\\delta_i=1$, the term corresponds to the conditional probability of individual $i$ failing at their observed failure time $Y_i$, given the risk set $R(Y_i)$. This is the partial likelihood for $\\beta$.", "answer": "$$ \\boxed{\\prod_{i=1}^{n} \\left( \\frac{\\exp(x_i^{\\top}\\beta)}{\\sum_{j \\in R(Y_i)} \\exp(x_j^{\\top}\\beta)} \\right)^{\\delta_i}} $$", "id": "4962119"}]}