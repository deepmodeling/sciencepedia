{"hands_on_practices": [{"introduction": "This first practice is your entry into the mechanics of survival analysis. We will use the Kaplan-Meier method, a cornerstone for dealing with censored data, to build a survival curve from scratch. This exercise [@problem_id:4911089] will guide you through tracking individuals at risk and calculating the survival probability step-by-step, providing a concrete understanding of how to derive the median survival time from a typical clinical study dataset.", "problem": "A cohort of $20$ patients enrolled in a clinical study are followed to observe time to death, with right-censoring for those lost to follow-up or study end. Let $T$ denote the nonnegative continuous time-to-event random variable and $S(t) = \\Pr(T > t)$ denote the survival function. Assume non-informative right-censoring and that, when events and censorings occur at the same recorded time, events are processed before censorings. The observed data consist of pairs $(t_i, \\delta_i)$, where $t_i$ is the recorded time in months and $\\delta_i \\in \\{0,1\\}$ indicates whether a death ($\\delta_i = 1$) or a right-censoring ($\\delta_i = 0$) occurred at $t_i$. The $20$ observed pairs are:\n- $(2, 1)$,\n- $(3, 1)$,\n- $(3, 0)$,\n- $(4, 0)$,\n- $(5, 1)$,\n- $(6, 1)$,\n- $(7, 0)$,\n- $(8, 1)$,\n- $(9, 0)$,\n- $(10, 1)$,\n- $(11, 1)$,\n- $(12, 0)$,\n- $(12, 1)$,\n- $(13, 0)$,\n- $(14, 0)$,\n- $(15, 1)$,\n- $(16, 0)$,\n- $(18, 0)$,\n- $(20, 1)$,\n- $(22, 0)$.\n\nUsing only the definition of a survival function and the principles of handling right-censoring under the stated assumptions, construct the stepwise estimator of $S(t)$ via the Kaplan–Meier approach from these data, and then extract the estimated median survival time (the smallest time $t$ such that the estimated survival function is less than or equal to $1/2$). Express the final time in months, and round your answer to three significant figures.", "solution": "The user has provided a problem in biostatistics requiring the estimation of a median survival time from right-censored data.\n\n### Step 1: Extract Givens\n-   **Cohort size**: $n = 20$ patients.\n-   **Random variable**: $T$, a nonnegative continuous time-to-event variable.\n-   **Survival function**: $S(t) = \\Pr(T > t)$.\n-   **Data structure**: Pairs $(t_i, \\delta_i)$, where $t_i$ is time in months and $\\delta_i=1$ for an event (death) and $\\delta_i=0$ for right-censoring.\n-   **Assumptions**: Non-informative right-censoring. For ties in time, events are processed before censorings.\n-   **Dataset**: The $20$ observed pairs are $(2, 1)$, $(3, 1)$, $(3, 0)$, $(4, 0)$, $(5, 1)$, $(6, 1)$, $(7, 0)$, $(8, 1)$, $(9, 0), (10, 1)$, $(11, 1)$, $(12, 0)$, $(12, 1)$, $(13, 0)$, $(14, 0)$, $(15, 1)$, $(16, 0)$, $(18, 0)$, $(20, 1)$, $(22, 0)$.\n-   **Objective**: Construct the Kaplan-Meier estimator for $S(t)$ and find the estimated median survival time, defined as the smallest time $t$ such that $\\hat{S}(t) \\le 1/2$. The result must be in months and rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is a standard application of the Kaplan-Meier method, a fundamental tool in survival analysis. It is well-posed, providing all necessary data, a clear objective, and specific definitions, including a tie-breaking rule and the exact definition of the median survival time to be used. The language is objective and precise. The data are plausible for a small clinical study. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\nThe Kaplan-Meier estimator of the survival function, $\\hat{S}(t)$, is a non-parametric method to estimate $S(t)$ from survival data that may be right-censored. It is a product-limit estimator given by the formula:\n$$ \\hat{S}(t) = \\prod_{j: t_{(j)} \\le t} \\left(1 - \\frac{d_j}{n_j}\\right) $$\nwhere $t_{(j)}$ are the distinct times at which at least one event occurred, $d_j$ is the number of events at time $t_{(j)}$, and $n_j$ is the number of individuals at risk (i.e., those who are alive and not yet censored) just prior to time $t_{(j)}$. By convention, $\\hat{S}(0) = 1$. The estimate of the survival function is a step function that changes its value only at the times of observed events.\n\nTo compute $\\hat{S}(t)$, we first order the distinct event times and for each, determine the number of individuals at risk ($n_j$) and the number of events ($d_j$). We must carefully track the number of subjects at risk by subtracting subjects who have an event or are censored at each time point. The total number of subjects is $N=20$.\n\nThe distinct event times are $t=2, 3, 5, 6, 8, 10, 11, 12, 15, 20$. We will calculate the survival probability at these points.\n\n-   **Initial state**: At $t=0$, the number of subjects at risk is $n=20$. $\\hat{S}(t)=1$ for $t \\in [0, 2)$.\n\n-   **At event time $t_{(1)} = 2$**:\n    -   Subjects at risk: $n_1 = 20$.\n    -   Events observed: $d_1 = 1$.\n    -   $\\hat{S}(2) = \\hat{S}(0) \\times \\left(1 - \\frac{d_1}{n_1}\\right) = 1 \\times \\left(1 - \\frac{1}{20}\\right) = \\frac{19}{20} = 0.95$.\n    -   Subjects remaining for the next interval: $20 - 1(\\text{event}) = 19$.\n\n-   **At event time $t_{(2)} = 3$**:\n    -   Subjects at risk: $n_2 = 19$.\n    -   Events observed: $d_2 = 1$.\n    -   $\\hat{S}(3) = \\hat{S}(2) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{19}{20} \\times \\left(1 - \\frac{1}{19}\\right) = \\frac{19}{20} \\times \\frac{18}{19} = \\frac{18}{20} = 0.90$.\n    -   At $t=3$, one subject is also censored. Subjects remaining: $19 - 1(\\text{event}) - 1(\\text{censored}) = 17$.\n\n-   **Between $t=3$ and $t=5$**: At $t=4$, one subject is censored. Subjects remaining: $17 - 1 = 16$.\n\n-   **At event time $t_{(3)} = 5$**:\n    -   Subjects at risk: $n_3 = 16$.\n    -   Events observed: $d_3 = 1$.\n    -   $\\hat{S}(5) = \\hat{S}(3) \\times \\left(1 - \\frac{d_3}{n_3}\\right) = \\frac{18}{20} \\times \\left(1 - \\frac{1}{16}\\right) = \\frac{18}{20} \\times \\frac{15}{16} = \\frac{270}{320} = \\frac{27}{32} = 0.84375$.\n    -   Subjects remaining: $16 - 1(\\text{event}) = 15$.\n\n-   **At event time $t_{(4)} = 6$**:\n    -   Subjects at risk: $n_4 = 15$.\n    -   Events observed: $d_4 = 1$.\n    -   $\\hat{S}(6) = \\hat{S}(5) \\times \\left(1 - \\frac{d_4}{n_4}\\right) = \\frac{27}{32} \\times \\left(1 - \\frac{1}{15}\\right) = \\frac{27}{32} \\times \\frac{14}{15} = \\frac{378}{480} = \\frac{63}{80} = 0.7875$.\n    -   Subjects remaining: $15 - 1 = 14$. At $t=7$, one subject is censored, leaving $13$.\n\n-   **At event time $t_{(5)} = 8$**:\n    -   Subjects at risk: $n_5 = 13$.\n    -   Events observed: $d_5 = 1$.\n    -   $\\hat{S}(8) = \\hat{S}(6) \\times \\left(1 - \\frac{d_5}{n_5}\\right) = \\frac{63}{80} \\times \\left(1 - \\frac{1}{13}\\right) = \\frac{63}{80} \\times \\frac{12}{13} = \\frac{756}{1040} = \\frac{189}{260} \\approx 0.7269$.\n    -   Subjects remaining: $13-1=12$. At $t=9$, one subject is censored, leaving $11$.\n\n-   **At event time $t_{(6)} = 10$**:\n    -   Subjects at risk: $n_6 = 11$.\n    -   Events observed: $d_6 = 1$.\n    -   $\\hat{S}(10) = \\hat{S}(8) \\times \\left(1 - \\frac{d_6}{n_6}\\right) = \\frac{189}{260} \\times \\left(1 - \\frac{1}{11}\\right) = \\frac{189}{260} \\times \\frac{10}{11} = \\frac{189}{286} \\approx 0.6608$.\n    -   Subjects remaining: $11-1 = 10$.\n\n-   **At event time $t_{(7)} = 11$**:\n    -   Subjects at risk: $n_7 = 10$.\n    -   Events observed: $d_7 = 1$.\n    -   $\\hat{S}(11) = \\hat{S}(10) \\times \\left(1 - \\frac{d_7}{n_7}\\right) = \\frac{189}{286} \\times \\left(1 - \\frac{1}{10}\\right) = \\frac{189}{286} \\times \\frac{9}{10} = \\frac{1701}{2860} \\approx 0.5948$.\n    -   Subjects remaining: $10-1 = 9$.\n\n-   **At event time $t_{(8)} = 12$**:\n    -   Subjects at risk: $n_8 = 9$.\n    -   Events observed: $d_8 = 1$. As per the rule, the event is processed before the censoring at the same time.\n    -   $\\hat{S}(12) = \\hat{S}(11) \\times \\left(1 - \\frac{d_8}{n_8}\\right) = \\frac{1701}{2860} \\times \\left(1 - \\frac{1}{9}\\right) = \\frac{1701}{2860} \\times \\frac{8}{9} = \\frac{1512}{2860} = \\frac{378}{715} \\approx 0.5287$.\n    -   Subjects remaining: $9-1(\\text{event}) - 1(\\text{censored}) = 7$.\n\n-   **Between $t=12$ and $t=15$**: At $t=13$, one is censored (6 remain). At $t=14$, one is censored (5 remain).\n\n-   **At event time $t_{(9)} = 15$**:\n    -   Subjects at risk: $n_9 = 5$.\n    -   Events observed: $d_9 = 1$.\n    -   $\\hat{S}(15) = \\hat{S}(12) \\times \\left(1 - \\frac{d_9}{n_9}\\right) = \\frac{378}{715} \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{378}{715} \\times \\frac{4}{5} = \\frac{1512}{3575} \\approx 0.4229$.\n\nWe are looking for the median survival time, defined as the smallest time $t$ for which $\\hat{S}(t) \\le 0.5$.\nLet's examine the values of the estimated survival function we have calculated:\n-   For $t \\in [12, 15)$, $\\hat{S}(t) = \\hat{S}(12) \\approx 0.5287$, which is greater than $0.5$.\n-   At $t=15$, the survival function drops to $\\hat{S}(15) \\approx 0.4229$, which is less than or equal to $0.5$.\n\nThus, the smallest time $t$ at which the condition $\\hat{S}(t) \\le 0.5$ is met is $t=15$ months.\n\nThe problem asks for the answer to be rounded to three significant figures. The exact answer is $15$. To express this with three significant figures, we write it as $15.0$.", "answer": "$$\n\\boxed{15.0}\n$$", "id": "4911089"}, {"introduction": "After mastering the calculation, we now turn to a critical aspect of interpretation. What happens if more than half of the study participants are still event-free at the end of the follow-up period? This common scenario, explored in this exercise [@problem_id:4605660], demonstrates that the Kaplan-Meier curve $\\hat{S}(t)$ may never drop below $0.5$, making the median survival time inestimable within the study's duration and introducing the important concept of a right-censored median.", "problem": "A cohort study follows $10$ patients for time-to-event outcomes with independent right-censoring. Let $T$ denote the event time and let the survival function be $S(t) = \\mathbb{P}(T > t)$. The Kaplan–Meier (KM) estimator of the survival function, denoted $\\hat S(t)$, is constructed from observed event times and censoring times. The median survival time $m$ is defined as the smallest time $t$ such that $S(t) \\le 0.5$. Administrative censoring occurs at a maximum follow-up time $\\tau$.\n\nSuppose the observed data are:\n- Event times (in months) for $3$ patients: $2$, $4$, $7$.\n- Censoring times (in months) for the remaining $7$ patients: $9$.\n\nAssume no ties beyond what is explicitly stated. Using first principles of the Kaplan–Meier estimator, compute $\\hat S(t)$ at the event times and determine whether $\\hat S(t)$ crosses $0.5$ by time $t = \\tau = 9$ months. Then, based on this determination, select the option that most appropriately describes how to handle the median survival estimate and how to formally represent a censored median or an infeasible estimate scenario under this setting.\n\nA. Report the median survival as $7$ months because it is the last event time observed before administrative censoring.\n\nB. Report that the median survival is not estimable within $[0,\\tau]$ because $\\hat S(t)$ never falls to $\\le 0.5$; treat the median as right-censored beyond $\\tau$ by stating $m > \\tau$, and, if desired, provide a one-sided lower confidence bound for $m$ by inverting a confidence interval for $\\hat S(t)$ and/or report an alternative summary such as the restricted mean survival time $\\int_{0}^{\\tau} \\hat S(t)\\, dt$.\n\nC. Linearly interpolate between $\\hat S(7)$ and $\\hat S(9)$ to find the time $t \\in (7,9)$ at which $\\hat S(t)$ would equal $0.5$ and report that time as the median survival.\n\nD. Fit an exponential parametric model to impute a median survival time and report that value as the Kaplan–Meier median.", "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- Total number of patients in the cohort study: $N = 10$.\n- Outcome: Time-to-event with independent right-censoring.\n- Variable for event time: $T$.\n- Definition of survival function: $S(t) = \\mathbb{P}(T > t)$.\n- Estimator for the survival function: Kaplan–Meier (KM) estimator, $\\hat S(t)$.\n- Definition of median survival time, $m$: the smallest time $t$ such that $S(t) \\le 0.5$.\n- Maximum follow-up time (administrative censoring): $\\tau$.\n- Observed data:\n    - Event times: $2$, $4$, $7$ months (for $d=3$ patients).\n    - Censoring times: $9$ months (for $c=7$ patients).\n- Assumption: No ties beyond what is explicitly stated in the data.\n- Task: Compute $\\hat S(t)$ at event times, determine if $\\hat S(t)$ crosses $0.5$ by $t = \\tau = 9$ months, and select the appropriate option for handling the median survival estimate.\n\nFrom the data, the maximum follow-up time $\\tau$ is $9$ months, as this is the latest time point observed and is specified as an administrative censoring time.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the Kaplan–Meier estimator, a cornerstone of survival analysis in biostatistics and epidemiology. All concepts—survival function, censoring, median survival—are standard and well-defined. The problem is a straightforward application of this established methodology.\n2.  **Well-Posed:** The problem provides all necessary data to construct the Kaplan–Meier curve: total sample size, number and times of events, and number and times of censoring. The question is specific and answerable. A unique Kaplan-Meier curve can be constructed from this data.\n3.  **Objective:** The problem is stated using precise, objective, and standard statistical terminology. There is no ambiguity or subjective language.\n4.  **Flaw Analysis:**\n    - **Scientific or Factual Unsoundness:** None. The principles of survival analysis are correctly stated.\n    - **Non-Formalizable or Irrelevant:** None. The problem is a formal and relevant exercise in biostatistics.\n    - **Incomplete or Contradictory Setup:** None. The data are complete and consistent. The number of patients with events ($3$) and the number censored ($7$) sum to the total cohort size ($10$).\n    - **Unrealistic or Infeasible:** None. The data represent a plausible small-scale study.\n    - **Ill-Posed or Poorly Structured:** None. The definition of the median is standard. The question leads to a unique conclusion based on the data.\n    - **Pseudo-Profound, Trivial, or Tautological:** None. The problem requires a correct calculation and interpretation of a standard statistical estimator, which is a non-trivial task.\n    - **Outside Scientific Verifiability:** None. The calculations are entirely verifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived based on the provided information.\n\n### Derivation of the Kaplan–Meier Estimator\n\nThe Kaplan–Meier estimator, $\\hat S(t)$, is a non-parametric a product-limit estimator for the survival function. It is calculated as:\n$$ \\hat S(t) = \\prod_{i: t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right) $$\nwhere $t_i$ are the distinct event times, $d_i$ is the number of events at time $t_i$, and $n_i$ is the number of individuals at risk (i.e., alive and not yet censored) just prior to time $t_i$.\n\nThe data are first ordered by time:\n- Event at $t=2$.\n- Event at $t=4$.\n- Event at $t=7$.\n- Censoring of $7$ patients at $t=9$.\n\nWe construct a life table to calculate $\\hat S(t)$ at each event time.\n\n1.  **Time $t=0$**: The study begins. The number of patients at risk is $n_0=10$. The survival estimate is $\\hat S(t) = 1.0$ for $t \\in [0, 2)$.\n\n2.  **Event at $t_1 = 2$ months**:\n    - Number at risk just before $t=2$: $n_1 = 10$.\n    - Number of events at $t=2$: $d_1 = 1$.\n    - The survival probability at this step is $(1 - d_1/n_1) = (1 - 1/10) = 0.9$.\n    - The cumulative survival is $\\hat S(2) = 1.0 \\times 0.9 = 0.9$.\n    - For $t \\in [2, 4)$, $\\hat S(t) = 0.9$.\n    - After the event, $10 - 1 = 9$ patients remain at risk.\n\n3.  **Event at $t_2 = 4$ months**:\n    - Number at risk just before $t=4$: $n_2 = 9$.\n    - Number of events at $t=4$: $d_2 = 1$.\n    - The survival probability at this step is $(1 - d_2/n_2) = (1 - 1/9) = 8/9$.\n    - The cumulative survival is $\\hat S(4) = \\hat S(t<4) \\times (8/9) = 0.9 \\times (8/9) = (9/10) \\times (8/9) = 8/10 = 0.8$.\n    - For $t \\in [4, 7)$, $\\hat S(t) = 0.8$.\n    - After the event, $9 - 1 = 8$ patients remain at risk.\n\n4.  **Event at $t_3 = 7$ months**:\n    - Number at risk just before $t=7$: $n_3 = 8$.\n    - Number of events at $t=7$: $d_3 = 1$.\n    - The survival probability at this step is $(1 - d_3/n_3) = (1 - 1/8) = 7/8$.\n    - The cumulative survival is $\\hat S(7) = \\hat S(t<7) \\times (7/8) = 0.8 \\times (7/8) = (8/10) \\times (7/8) = 7/10 = 0.7$.\n    - For $t \\in [7, 9)$, $\\hat S(t) = 0.7$.\n    - After the event, $8 - 1 = 7$ patients remain at risk.\n\n5.  **Censoring at $t = 9$ months**:\n    - At $t=9$, the remaining $7$ patients are censored.\n    - Censoring events do not cause a change in the Kaplan–Meier survival estimate. Thus, the value of $\\hat S(t)$ remains $0.7$ at $t=9$.\n    - The study ends at $\\tau=9$ months. The last calculated value for the survival function is $\\hat S(9) = 0.7$.\n\n### Determination of Median Survival\n\nThe median survival time, $m$, is defined as the smallest time $t$ for which $\\hat S(t) \\le 0.5$.\nBased on our calculations, the final value of the survival estimate at the end of the follow-up period ($t=\\tau=9$) is $\\hat S(9) = 0.7$.\nSince $0.7 > 0.5$, the Kaplan–Meier curve never drops to or below the $0.5$ threshold within the observation period $[0, 9]$. Therefore, the median survival time is not reached and cannot be estimated from the observed data. The only conclusion that can be drawn is that the median survival time is greater than the maximum follow-up duration, i.e., $m > 9$ months. This is referred to as a right-censored median.\n\n### Option-by-Option Analysis\n\n**A. Report the median survival as $7$ months because it is the last event time observed before administrative censoring.**\n- **Analysis:** This is incorrect. The median survival time is defined by the survival probability reaching $0.5$, not by the time of the last observed event. At $t=7$ months, the estimated survival probability is $\\hat S(7) = 0.7$, which is substantially higher than $0.5$.\n- **Verdict:** Incorrect.\n\n**B. Report that the median survival is not estimable within $[0,\\tau]$ because $\\hat S(t)$ never falls to $\\le 0.5$; treat the median as right-censored beyond $\\tau$ by stating $m > \\tau$, and, if desired, provide a one-sided lower confidence bound for $m$ by inverting a confidence interval for $\\hat S(t)$ and/or report an alternative summary such as the restricted mean survival time $\\int_{0}^{\\tau} \\hat S(t)\\, dt$.**\n- **Analysis:** This statement accurately reflects the findings from our derivation. The KM estimate $\\hat S(t)$ has a minimum value of $0.7$ at the end of the study, so it never reaches $\\le 0.5$. The correct statistical practice in this situation is to conclude that the median is not estimable within the study's timeframe and is right-censored, meaning $m > \\tau=9$ months. The option also correctly lists standard and appropriate alternative summaries for such scenarios: inverting a confidence interval for $S(t)$ to find a lower bound for the median, or calculating the Restricted Mean Survival Time (RMST), which is the area under the KM curve up to $\\tau$. This option represents a complete and professionally sound approach.\n- **Verdict:** Correct.\n\n**C. Linearly interpolate between $\\hat S(7)$ and $\\hat S(9)$ to find the time $t \\in (7,9)$ at which $\\hat S(t)$ would equal $0.5$ and report that time as the median survival.**\n- **Analysis:** This is an invalid procedure. The Kaplan–Meier curve is a step function, not a continuous line. It is constant between event times. Specifically, for any time $t$ in the interval $[7, 9)$, $\\hat S(t) = 0.7$. Linear interpolation is not a feature of the KM estimation method and would produce a spurious result by assuming a linear decrease in survival probability where the model explicitly states it is constant.\n- **Verdict:** Incorrect.\n\n**D. Fit an exponential parametric model to impute a median survival time and report that value as the Kaplan–Meier median.**\n- **Analysis:** This option proposes switching from a non-parametric method (Kaplan–Meier) to a parametric one (exponential model). While fitting a parametric model is a valid statistical technique, the resulting median estimate would be from the exponential model, not the Kaplan–Meier estimator. The problem specifically asks about the Kaplan–Meier median. Conflating a parametric estimate with a non-parametric one is a methodological error.\n- **Verdict:** Incorrect.", "answer": "$$\\boxed{B}$$", "id": "4605660"}, {"introduction": "A point estimate of the median survival is informative, but its true power in scientific inference comes from understanding its precision. This final practice [@problem_id:4948655] introduces the nonparametric bootstrap, a powerful and intuitive resampling technique to estimate the variance and confidence intervals for survival statistics. By understanding this procedure, you will learn how to quantify the uncertainty of your median survival estimate without relying on complex analytical formulas or parametric assumptions.", "problem": "A biostatistician analyzes right-censored survival data from a cohort study. For each subject, the observed data consist of an observed time $t_i$ and a censoring indicator $\\delta_i \\in \\{0,1\\}$, where $\\delta_i = 1$ indicates an event and $\\delta_i = 0$ indicates right-censoring. Assume independent and identically distributed subjects, non-informative right-censoring, and that the survival function $S(t)$ is estimated nonparametrically by the Kaplan–Meier (KM) estimator. The target functionals are the median survival time $m$, defined as the smallest $t$ such that $S(t) \\leq 0.5$, and the restricted mean survival time (RMST) at a prespecified truncation time $\\tau$, defined as $R(\\tau) = \\int_{0}^{\\tau} S(t)\\, dt$.\n\nThe biostatistician wishes to use the nonparametric bootstrap with case resampling to obtain point estimates and robust variance estimates for $m$ and $R(\\tau)$. Which option below correctly and completely defines a scientifically sound bootstrap procedure using case resampling for both $m$ and $R(\\tau)$ in the presence of right-censoring?\n\nA. Draw, with replacement, $n$ subject-level pairs $(t_i, \\delta_i)$ from the original sample to form a bootstrap sample. On each bootstrap sample, compute the Kaplan–Meier estimator $\\widehat{S}^{\\ast}(t)$, define the bootstrap median $m^{\\ast}$ as the smallest $t$ such that $\\widehat{S}^{\\ast}(t) \\leq 0.5$, and compute the bootstrap RMST $R^{\\ast}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}^{\\ast}(t)\\, dt$ with fixed $\\tau$. Repeat this resampling $B$ times to obtain $\\{m^{\\ast}_b\\}_{b=1}^{B}$ and $\\{R^{\\ast}_b(\\tau)\\}_{b=1}^{B}$; use the sample variances of these bootstrap replicates as robust variance estimates and percentile intervals for confidence intervals. Report the original-sample KM-based $m$ and $R(\\tau)$ as point estimates.\n\nB. Resample only the uncensored event times $\\{t_i : \\delta_i = 1\\}$ with replacement to form bootstrap samples, ignore censored observations, and compute the sample median of resampled times as $m^{\\ast}$. For RMST, average the resampled event times truncated at $\\tau$ to define $R^{\\ast}(\\tau)$. Repeat $B$ times and use the empirical variability across replicates for variance estimation.\n\nC. Fit an exponential survival model to the original data, simulate $n$ survival times from the fitted model without censoring, and compute $m^{\\ast}$ and $R^{\\ast}(\\tau)$ directly from the simulated parametric survival curve. Repeat $B$ times and use the variability across parametric replicates for variance estimation.\n\nD. Within each bootstrap replicate, resample only event times in order to reconstruct risk sets, compute the Nelson–Aalen cumulative hazard $\\widehat{H}^{\\ast}(t)$, set $m^{\\ast}$ as the time solving $\\widehat{H}^{\\ast}(t) = \\log(2)$, and define $R^{\\ast}(\\tau)$ as $\\int_{0}^{\\tau} \\left[1 - \\widehat{H}^{\\ast}(t)\\right] dt$. Repeat $B$ times and use the empirical variance across replicates for variance estimation.\n\nE. Fit a Cox proportional hazards model, resample model residuals with replacement, refit the model on each residual-resampled dataset, and compute $m^{\\ast}$ and $R^{\\ast}(\\tau)$ from the model-based survival curve for an “average” subject. Repeat $B$ times and use the empirical variance across replicates for variance estimation.", "solution": "The problem statement poses a well-defined question in the field of biostatistics, specifically concerning the application of a standard resampling method to estimate the variance of common survival analysis functionals.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Data Structure**: Right-censored survival data from a cohort study.\n-   **Observation for subject $i$**: a pair $(t_i, \\delta_i)$, where $t_i$ is the observed time and $\\delta_i$ is a censoring indicator.\n-   **Censoring Indicator**: $\\delta_i \\in \\{0, 1\\}$, with $\\delta_i = 1$ for an event and $\\delta_i = 0$ for right-censoring.\n-   **Assumptions**:\n    1.  Subjects are independent and identically distributed (i.i.d.).\n    2.  Right-censoring is non-informative.\n-   **Survival Function Estimator**: The nonparametric Kaplan–Meier (KM) estimator, $\\widehat{S}(t)$.\n-   **Target Functional 1 (Median Survival Time)**: $m$, defined as the smallest $t$ such that $S(t) \\leq 0.5$.\n-   **Target Functional 2 (Restricted Mean Survival Time)**: $R(\\tau) = \\int_{0}^{\\tau} S(t)\\, dt$ for a prespecified truncation time $\\tau$.\n-   **Objective**: Define a scientifically sound procedure for the nonparametric bootstrap with case resampling to obtain point estimates and robust variance estimates for $m$ and $R(\\tau)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective.\n-   **Scientific Grounding**: The concepts presented—right-censoring, Kaplan-Meier estimation, median survival time, restricted mean survival time, and the nonparametric bootstrap—are all fundamental and standard topics in survival analysis and biostatistics. The assumptions of i.i.d. subjects and non-informative censoring are the standard conditions under which these methods are valid.\n-   **Well-Posed**: The problem asks to identify the correct definition of a specific, well-established statistical procedure (nonparametric bootstrap with case resampling) for a clearly defined purpose. A unique, correct procedure exists and can be derived from first principles of bootstrap theory.\n-   **Objective**: The terminology is precise and standard within the field. There is no ambiguity or subjectivity.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. The task is to identify the correct procedure among the given options.\n\n### Derivation and Option Analysis\n\nThe nonparametric bootstrap, as proposed by Bradley Efron, is a computational method for estimating the sampling distribution of a statistic. The core principle is to approximate the population distribution with the empirical distribution of the observed sample. A bootstrap sample is then generated by drawing from this empirical distribution. In the context of i.i.d. data, this translates to resampling the original observations with replacement.\n\nFor survival data where each subject $i$ contributes a pair of observations $(t_i, \\delta_i)$, the \"case\" or \"unit of observation\" is this pair. To preserve the relationship between the observed time and the event/censoring status, the bootstrap procedure must resample these pairs together. This is known as \"case resampling\" or \"resampling the pairs\".\n\nThe general algorithm for a nonparametric bootstrap for the functionals $m$ and $R(\\tau)$ is as follows:\n\n1.  From the original sample of size $n$, $\\{(t_i, \\delta_i)\\}_{i=1}^n$, compute the Kaplan-Meier survival curve, $\\widehat{S}(t)$.\n2.  From $\\widehat{S}(t)$, compute the point estimates for the median survival time, $\\hat{m} = \\inf\\{t : \\widehat{S}(t) \\leq 0.5\\}$, and the restricted mean survival time, $\\widehat{R}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}(t)\\, dt$. These are the final reported point estimates.\n3.  Repeat for $b=1, \\dots, B$ (where $B$ is a large number, e.g., $1000$ or more):\n    a.  Generate a bootstrap sample of size $n$ by drawing $n$ pairs, $(t_i^{\\ast,b}, \\delta_i^{\\ast,b})$, with replacement from the original sample $\\{(t_i, \\delta_i)\\}_{i=1}^n$.\n    b.  Using this bootstrap sample, apply the exact same estimation procedure as in step 1: compute the Kaplan-Meier curve $\\widehat{S}^{\\ast,b}(t)$.\n    c.  From $\\widehat{S}^{\\ast,b}(t)$, compute the bootstrap replicates of the statistics: $m^{\\ast,b} = \\inf\\{t : \\widehat{S}^{\\ast,b}(t) \\leq 0.5\\}$ and $R^{\\ast,b}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}^{\\ast,b}(t)\\, dt$.\n4.  The collection of bootstrap replicates $\\{m^{\\ast,b}\\}_{b=1}^B$ and $\\{R^{\\ast,b}(\\tau)\\}_{b=1}^B$ forms an empirical approximation to the sampling distributions of $\\hat{m}$ and $\\widehat{R}(\\tau)$, respectively.\n5.  The sample variance of the bootstrap replicates, e.g., $\\widehat{\\text{Var}}(\\hat{m}) \\approx \\frac{1}{B-1}\\sum_{b=1}^{B} (m^{\\ast,b} - \\bar{m}^{\\ast})^2$, is used as the estimate of the variance of the original estimator. Confidence intervals can be constructed using the percentiles of the bootstrap distribution (the percentile method).\n\nWe now evaluate each option against this correct procedure.\n\n**A. Draw, with replacement, $n$ subject-level pairs $(t_i, \\delta_i)$ from the original sample to form a bootstrap sample. On each bootstrap sample, compute the Kaplan–Meier estimator $\\widehat{S}^{\\ast}(t)$, define the bootstrap median $m^{\\ast}$ as the smallest $t$ such that $\\widehat{S}^{\\ast}(t) \\leq 0.5$, and compute the bootstrap RMST $R^{\\ast}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}^{\\ast}(t)\\, dt$ with fixed $\\tau$. Repeat this resampling $B$ times to obtain $\\{m^{\\ast}_b\\}_{b=1}^{B}$ and $\\{R^{\\ast}_b(\\tau)\\}_{b=1}^{B}$; use the sample variances of these bootstrap replicates as robust variance estimates and percentile intervals for confidence intervals. Report the original-sample KM-based $m$ and $R(\\tau)$ as point estimates.**\n\nThis option precisely and completely describes the standard nonparametric bootstrap procedure with case resampling for survival data. It correctly identifies the resampling unit as the pair $(t_i, \\delta_i)$, specifies that the same estimation procedure (KM curve and derived functionals) is applied to each bootstrap sample, and correctly describes how the resulting bootstrap distribution is used for inference (variance estimation, CIs) and which values are reported as the point estimates.\n**Verdict: Correct.**\n\n**B. Resample only the uncensored event times $\\{t_i : \\delta_i = 1\\}$ with replacement to form bootstrap samples, ignore censored observations, and compute the sample median of resampled times as $m^{\\ast}$. For RMST, average the resampled event times truncated at $\\tau$ to define $R^{\\ast}(\\tau)$. Repeat $B$ times and use the empirical variability across replicates for variance estimation.**\n\nThis procedure is fundamentally flawed. Ignoring censored observations violates the principles of survival analysis. A censored observation at time $t_c$ provides the critical information that the subject survived at least until $t_c$. Discarding this information leads to a systematic underestimation of survival times, introducing substantial bias. The Kaplan-Meier estimator is specifically designed to correctly incorporate information from both event times and censored times. This option discards key information and is scientifically unsound.\n**Verdict: Incorrect.**\n\n**C. Fit an exponential survival model to the original data, simulate $n$ survival times from the fitted model without censoring, and compute $m^{\\ast}$ and $R^{\\ast}(\\tau)$ directly from the simulated parametric survival curve. Repeat $B$ times and use the variability across parametric replicates for variance estimation.**\n\nThis describes a *parametric bootstrap*. It relies on the strong assumption that the survival times follow an exponential distribution. The problem specifies the use of the *nonparametric* KM estimator and requests a *nonparametric bootstrap* with case resampling. This option describes a different, and more assumption-laden, procedure.\n**Verdict: Incorrect.**\n\n**D. Within each bootstrap replicate, resample only event times in order to reconstruct risk sets, compute the Nelson–Aalen cumulative hazard $\\widehat{H}^{\\ast}(t)$, set $m^{\\ast}$ as the time solving $\\widehat{H}^{\\ast}(t) = \\log(2)$, and define $R^{\\ast}(\\tau)$ as $\\int_{0}^{\\tau} \\left[1 - \\widehat{H}^{\\ast}(t)\\right] dt$. Repeat $B$ times and use the empirical variance across replicates for variance estimation.**\n\nThis option has multiple errors. First, similarly to option B, it proposes resampling only event times, which is incorrect as it discards information from censored subjects and misconstructs the risk sets. Second, the formula for the RMST is wrong. The RMST is $R(\\tau) = \\int_0^\\tau S(t) \\, dt$. The survival function $S(t)$ is related to the cumulative hazard function $H(t)$ by $S(t) = \\exp(-H(t))$. The proposed formula $\\int_{0}^{\\tau} [1 - \\widehat{H}^{\\ast}(t)] \\, dt$ is not equivalent to the correct definition of RMST. The approximation $S(t) \\approx 1 - H(t)$ is only valid for very small $H(t)$ (i.e., small $t$).\n**Verdict: Incorrect.**\n\n**E. Fit a Cox proportional hazards model, resample model residuals with replacement, refit the model on each residual-resampled dataset, and compute $m^{\\ast}$ and $R^{\\ast}(\\tau)$ from the model-based survival curve for an “average” subject. Repeat $B$ times and use the empirical variance across replicates for variance estimation.**\n\nThis describes a form of model-based bootstrap for a Cox proportional hazards model. A Cox model is a semi-parametric regression model used to assess the effect of covariates on survival, which is a different goal from the nonparametric estimation of the survival function in a single cohort as described in the problem. The problem statement specifies the use of the nonparametric Kaplan-Meier estimator, not a Cox model. This option describes an entirely different analysis.\n**Verdict: Incorrect.**\n\nIn summary, only Option A correctly describes the nonparametric bootstrap with case resampling for estimating the variance of functionals derived from the Kaplan-Meier curve.", "answer": "$$\\boxed{A}$$", "id": "4948655"}]}