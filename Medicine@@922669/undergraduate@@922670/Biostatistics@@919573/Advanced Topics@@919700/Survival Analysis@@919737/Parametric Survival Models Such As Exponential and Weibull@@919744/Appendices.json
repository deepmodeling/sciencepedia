{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will derive a cornerstone result in parametric survival analysis: the maximum likelihood estimator (MLE) for the rate parameter, $\\lambda$, of an exponential model. This exercise is crucial as it connects the formal theory of likelihood-based inference with the intuitive and widely used concept of an incidence rate (total events divided by total time-at-risk). By working through this derivation [@problem_id:4978007], you will gain a foundational understanding of how parametric models are fitted to censored time-to-event data.", "problem": "In a randomized clinical registry of $n$ patients evaluating time to a composite cardiovascular event, each patient $i$ contributes an observed follow-up duration $x_i$ and an event indicator $\\delta_i$, where $x_i = \\min\\{t_i, c_i\\}$ is the minimum of the true event time $t_i$ and a right-censoring time $c_i$, and $\\delta_i = \\mathbb{I}(t_i \\le c_i)$ indicates whether the event was observed. Assume independent, non-informative right censoring and a parametric survival model where the event time $t_i$ is exponentially distributed with a constant hazard parameter $\\lambda > 0$. The exponential model is characterized by the survival function $S(t) = \\exp(-\\lambda t)$ and the density $f(t) = \\lambda \\exp(-\\lambda t)$ for $t \\ge 0$. Using the likelihood principle and the contribution of each subject under right censoring, derive the maximum likelihood estimator, that is, the estimator obtained by the maximum likelihood estimation (MLE), for the parameter $\\lambda$, and identify its interpretation in terms of observable quantities in this study. Which option correctly states both the closed-form estimator and its interpretation?\n\nA. The estimator is the number of observed events divided by the total observed follow-up time across all patients, and it estimates the average event rate per unit time over the cohort’s accumulated time at risk.\n\nB. The estimator is the total observed follow-up time divided by the number of observed events, and it estimates the average survival time per event.\n\nC. Under a Weibull model with unknown shape parameter $k$, the estimator is the number of observed events divided by the sum of $x_i^k$, and it estimates the instantaneous risk normalized by the sample size.\n\nD. The estimator is the number of observed events divided by the number of enrolled patients, and it estimates the proportion of patients who experienced the event during follow-up.", "solution": "The problem statement is a standard formulation for survival analysis with right-censored data under an exponential model. It is scientifically grounded, well-posed, and objective. There are no contradictions, missing data, or ambiguous terms. The problem is valid.\n\nWe are tasked with deriving the maximum likelihood estimator (MLE) for the rate parameter $\\lambda$ of an exponential distribution, given right-censored data. The data for each of the $n$ patients consists of a pair $(x_i, \\delta_i)$, where $x_i$ is the observed follow-up time and $\\delta_i$ is the event indicator. The follow-up time $x_i = \\min\\{t_i, c_i\\}$ is the minimum of the true event time $t_i$ and the censoring time $c_i$. The event indicator is $\\delta_i = 1$ if the event was observed ($t_i \\le c_i$) and $\\delta_i = 0$ if the observation was censored ($t_i > c_i$).\n\nThe derivation proceeds by constructing the likelihood function for the observed data. The principle of likelihood construction for right-censored data states that the contribution of an individual to the likelihood is the probability density function $f(x_i)$ if the event is observed at time $x_i$, and the survival function $S(x_i)$ if the individual is known only to have survived up to time $x_i$.\n\nThe contribution of patient $i$ to the likelihood function, $L_i(\\lambda)$, can be written as:\n$$ L_i(\\lambda) = [f(x_i)]^{\\delta_i} [S(x_i)]^{1-\\delta_i} $$\nThis compact form correctly represents the contribution for both cases:\n- If the event is observed ($\\delta_i=1$): $L_i(\\lambda) = f(x_i)^1 S(x_i)^0 = f(x_i)$.\n- If the observation is censored ($\\delta_i=0$): $L_i(\\lambda) = f(x_i)^0 S(x_i)^1 = S(x_i)$.\n\nThe problem states that the event times follow an exponential distribution with parameter $\\lambda > 0$. The probability density function (PDF) is $f(t) = \\lambda e^{-\\lambda t}$ and the survival function (SF) is $S(t) = e^{-\\lambda t}$.\nSubstituting these into the expression for $L_i(\\lambda)$:\n$$ L_i(\\lambda) = [\\lambda e^{-\\lambda x_i}]^{\\delta_i} [e^{-\\lambda x_i}]^{1-\\delta_i} $$\nWe can simplify this expression by combining the exponential terms:\n$$ L_i(\\lambda) = \\lambda^{\\delta_i} (e^{-\\lambda x_i})^{\\delta_i} (e^{-\\lambda x_i})^{1-\\delta_i} = \\lambda^{\\delta_i} e^{-\\lambda x_i (\\delta_i + 1 - \\delta_i)} = \\lambda^{\\delta_i} e^{-\\lambda x_i} $$\n\nAssuming the observations for all $n$ patients are independent, the total likelihood function $L(\\lambda)$ is the product of the individual contributions:\n$$ L(\\lambda) = \\prod_{i=1}^{n} L_i(\\lambda) = \\prod_{i=1}^{n} \\left( \\lambda^{\\delta_i} e^{-\\lambda x_i} \\right) $$\nBy separating the terms involving $\\lambda$ and the exponential terms, we get:\n$$ L(\\lambda) = \\left( \\prod_{i=1}^{n} \\lambda^{\\delta_i} \\right) \\left( \\prod_{i=1}^{n} e^{-\\lambda x_i} \\right) = \\lambda^{\\sum_{i=1}^{n} \\delta_i} \\exp\\left(-\\lambda \\sum_{i=1}^{n} x_i\\right) $$\n\nLet us define two summary statistics from the data:\n1. The total number of observed events: $D = \\sum_{i=1}^{n} \\delta_i$.\n2. The total observed follow-up time (or total person-time at risk): $T = \\sum_{i=1}^{n} x_i$.\n\nThe likelihood function can now be written concisely as:\n$$ L(\\lambda) = \\lambda^D e^{-\\lambda T} $$\nTo find the MLE, we maximize $L(\\lambda)$ with respect to $\\lambda$. It is computationally simpler to maximize the log-likelihood function, $\\ell(\\lambda) = \\ln(L(\\lambda))$.\n$$ \\ell(\\lambda) = \\ln(\\lambda^D e^{-\\lambda T}) = D \\ln(\\lambda) - \\lambda T $$\nTo find the maximum, we take the first derivative of $\\ell(\\lambda)$ with respect to $\\lambda$ and set it to zero:\n$$ \\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda}(D \\ln(\\lambda) - \\lambda T) = \\frac{D}{\\lambda} - T $$\nSetting the derivative to zero gives the equation for the MLE, denoted $\\hat{\\lambda}$:\n$$ \\frac{D}{\\hat{\\lambda}} - T = 0 \\implies \\frac{D}{\\hat{\\lambda}} = T \\implies \\hat{\\lambda} = \\frac{D}{T} $$\nTo confirm that this corresponds to a maximum, we check the second derivative:\n$$ \\frac{d^2\\ell}{d\\lambda^2} = -\\frac{D}{\\lambda^2} $$\nSince $D$ (the number of events) is non-negative and $\\lambda^2$ is positive, the second derivative is less than or equal to zero. For non-trivial cases where $D > 0$, the second derivative is strictly negative, confirming that $\\hat{\\lambda}$ is indeed a maximum likelihood estimator.\n\nThe derived MLE is:\n$$ \\hat{\\lambda} = \\frac{\\sum_{i=1}^{n} \\delta_i}{\\sum_{i=1}^{n} x_i} = \\frac{\\text{Total number of observed events}}{\\text{Total observed follow-up time}} $$\nThis is the formula for an incidence rate. In the context of the exponential model, the parameter $\\lambda$ represents the constant hazard rate, which is the instantaneous risk of an event per unit time. Therefore, the estimator $\\hat{\\lambda}$ is the estimated constant event rate, calculated as the total number of events observed in the cohort divided by the total accumulated time at risk for that cohort.\n\nNow we evaluate each option:\n\n**A. The estimator is the number of observed events divided by the total observed follow-up time across all patients, and it estimates the average event rate per unit time over the cohort’s accumulated time at risk.**\n- **Estimator Form**: \"the number of observed events divided by the total observed follow-up time across all patients\" corresponds exactly to our derived estimator $\\hat{\\lambda} = \\frac{D}{T}$. This is correct.\n- **Interpretation**: The parameter $\\lambda$ is a constant event rate. The MLE $\\hat{\\lambda}$ is its estimate based on the entire cohort's experience. Phrasing this as \"the average event rate per unit time over the cohort’s accumulated time at risk\" is a precise and standard interpretation in epidemiology for an incidence rate, which is what $\\hat{\\lambda}$ represents. This is correct.\n- **Verdict**: Correct.\n\n**B. The estimator is the total observed follow-up time divided by the number of observed events, and it estimates the average survival time per event.**\n- **Estimator Form**: This describes the quantity $\\frac{T}{D} = \\frac{1}{\\hat{\\lambda}}$. This is the MLE for the mean survival time ($1/\\lambda$) in an exponential model, not the MLE for the rate parameter $\\lambda$. The question explicitly asks for the estimator of $\\lambda$. This is incorrect.\n- **Interpretation**: The quantity $1/\\lambda$ is the mean time to event. The interpretation is plausible for $1/\\hat{\\lambda}$, but the estimator form is wrong for $\\lambda$.\n- **Verdict**: Incorrect.\n\n**C. Under a Weibull model with unknown shape parameter $k$, the estimator is the number of observed events divided by the sum of $x_i^k$, and it estimates the instantaneous risk normalized by the sample size.**\n- **Estimator Form**: This option changes the model from exponential to Weibull. The exponential model is a special case of the Weibull model where the shape parameter $k=1$. If we set $k=1$ in the formula presented, we get $\\frac{D}{\\sum x_i^1} = \\frac{D}{T}$, which matches our result. However, the option posits a general Weibull model and claims this form holds, which is only true if $k$ is known. The problem statement explicitly specifies an exponential model. Therefore, this option addresses a different problem.\n- **Verdict**: Incorrect.\n\n**D. The estimator is the number of observed events divided by the number of enrolled patients, and it estimates the proportion of patients who experienced the event during follow-up.**\n- **Estimator Form**: This describes the quantity $\\frac{D}{n} = \\frac{\\sum \\delta_i}{n}$. This is the simple proportion of subjects who had an event. This is not the MLE for $\\lambda$ because it ignores the time dimension of the data (i.e., the values of $x_i$). It treats a patient followed for 1 day identically to a patient followed for 10 years. This is not the correct estimator derived from the likelihood principle for time-to-event data.\n- **Verdict**: Incorrect.\n\nBased on the rigorous derivation, only option A correctly provides both the mathematical form of the MLE for $\\lambda$ and its correct statistical interpretation in the context of survival analysis.", "answer": "$$\\boxed{A}$$", "id": "4978007"}, {"introduction": "Once a model is fitted, we often want to extract clinically meaningful summaries. This next practice focuses on deriving one of the most important metrics: the median survival time. You will first prove the general relationship between the survival function and the median, and then apply this to derive explicit formulas for both the exponential and Weibull models [@problem_id:4977992]. This exercise solidifies your understanding of the functional forms of these models and demonstrates how to translate their parameters into an easily interpretable measure of typical survival.", "problem": "A time-to-event variable $T$ denotes the time to biochemical relapse following definitive therapy for localized prostate cancer in a cohort with no loss to follow-up before relapse. Assume $T$ has a continuous distribution on $(0,\\infty)$ with strictly positive probability density function and no point masses. Let the survival function be $S(t)=\\mathbb{P}(Tt)$ and the cumulative distribution function be $F(t)=\\mathbb{P}(T\\le t)$.\n\n1. Using only the definitions of $S(t)$ and $F(t)$, and the definition of the median $t_{0.5}$ as any value satisfying $F(t_{0.5})\\ge 0.5$ and $\\mathbb{P}(T\\ge t_{0.5})\\ge 0.5$, prove that under the stated continuity conditions the median survival $t_{0.5}$ satisfies $S(t_{0.5})=0.5$.\n\n2. In parametric survival modeling, the hazard function $h(t)$ is defined by $h(t)=\\lim_{\\Delta t\\downarrow 0}\\frac{\\mathbb{P}(t\\le Tt+\\Delta t\\,|\\,T\\ge t)}{\\Delta t}$, with cumulative hazard $H(t)=\\int_{0}^{t}h(u)\\,\\mathrm{d}u$. For each of the following models, starting from the hazard function and its relation to the survival function via $H(t)$, derive an explicit closed-form expression for the median $t_{0.5}$:\n   - Exponential model with constant hazard $h(t)=\\lambda$ for $t0$, where $\\lambda0$ is the rate parameter.\n   - Weibull model with shape $k0$ and scale $\\alpha0$, having hazard $h(t)=\\frac{k}{\\alpha}\\left(\\frac{t}{\\alpha}\\right)^{k-1}$ for $t0$.\n\nExpress your final answer as a two-entry row vector $\\bigl(t_{0.5}^{\\text{(exp)}},\\,t_{0.5}^{\\text{(weib)}}\\bigr)$ in closed form in terms of the model parameters. Do not substitute numerical values. No rounding is required, and no units should be included in the final expression.", "solution": "We begin from core definitions in survival analysis. For a nonnegative, continuously distributed time-to-event variable $T$ with survival function $S(t)=\\mathbb{P}(Tt)$ and cumulative distribution function $F(t)=\\mathbb{P}(T\\le t)$, the two functions satisfy the fundamental identity\n$$\nF(t) \\;=\\; 1 - S(t),\n$$\nwhich follows directly from the complement rule, since $\\{T\\le t\\}$ and $\\{Tt\\}$ are complementary events.\n\nPart 1: Characterization of the median via the survival function. The median $t_{0.5}$ is defined as any value satisfying $F(t_{0.5})\\ge 0.5$ and $\\mathbb{P}(T\\ge t_{0.5})\\ge 0.5$. Under the stated assumptions that $T$ is continuously distributed on $(0,\\infty)$ with no point masses, $F$ is continuous and strictly increasing, and $S$ is continuous and strictly decreasing. In particular, continuity implies that the set of medians is a singleton and satisfies\n$$\nF(t_{0.5}) \\;=\\; 0.5.\n$$\nUsing $F(t)=1-S(t)$, we obtain\n$$\nS(t_{0.5}) \\;=\\; 1 - F(t_{0.5}) \\;=\\; 1 - 0.5 \\;=\\; 0.5.\n$$\nThus, under the stated conditions, the median survival $t_{0.5}$ is characterized by the equation $S(t_{0.5})=0.5$.\n\nPart 2: Explicit computation of $t_{0.5}$ for the exponential and Weibull models. We start from the definition of the hazard function $h(t)$ and cumulative hazard $H(t)=\\int_{0}^{t}h(u)\\,\\mathrm{d}u$. A foundational relationship connects the survival function and the cumulative hazard:\n$$\nS(t) \\;=\\; \\exp\\!\\bigl(-H(t)\\bigr).\n$$\nThis identity follows from the differential equation $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\ln S(t) = -h(t)$, which itself is obtained by combining $h(t)=\\frac{f(t)}{S(t)}$ with $f(t)=-\\frac{\\mathrm{d}}{\\mathrm{d}t}S(t)$ for a continuous distribution.\n\nExponential model. Suppose $h(t)=\\lambda$ for $t0$ with $\\lambda0$. Then\n$$\nH(t) \\;=\\; \\int_{0}^{t}\\lambda\\,\\mathrm{d}u \\;=\\; \\lambda t,\n$$\nso the survival function is\n$$\nS(t) \\;=\\; \\exp(-\\lambda t).\n$$\nBy part 1, the median $t_{0.5}$ satisfies\n$$\n\\exp(-\\lambda t_{0.5}) \\;=\\; 0.5.\n$$\nTaking the natural logarithm and solving for $t_{0.5}$ yields\n$$\n-\\lambda t_{0.5} \\;=\\; \\ln(0.5) \\;=\\; -\\ln(2)\n\\quad\\Longrightarrow\\quad\nt_{0.5}^{\\text{(exp)}} \\;=\\; \\frac{\\ln 2}{\\lambda}.\n$$\n\nWeibull model. Suppose $h(t)=\\frac{k}{\\alpha}\\left(\\frac{t}{\\alpha}\\right)^{k-1}$ for $t0$, with shape $k0$ and scale $\\alpha0$. Then\n$$\nH(t) \\;=\\; \\int_{0}^{t} \\frac{k}{\\alpha}\\left(\\frac{u}{\\alpha}\\right)^{k-1}\\mathrm{d}u.\n$$\nMake the change of variables $v = \\frac{u}{\\alpha}$ so that $\\mathrm{d}u = \\alpha\\,\\mathrm{d}v$ and $u=0\\mapsto v=0$, $u=t\\mapsto v=\\frac{t}{\\alpha}$. Then\n$$\nH(t) \\;=\\; \\int_{0}^{t/\\alpha} \\frac{k}{\\alpha} v^{k-1}\\,\\alpha\\,\\mathrm{d}v\n\\;=\\; \\int_{0}^{t/\\alpha} k\\,v^{k-1}\\,\\mathrm{d}v\n\\;=\\; \\left[v^{k}\\right]_{0}^{t/\\alpha}\n\\;=\\; \\left(\\frac{t}{\\alpha}\\right)^{k}.\n$$\nTherefore the survival function is\n$$\nS(t) \\;=\\; \\exp\\!\\left(-\\left(\\frac{t}{\\alpha}\\right)^{k}\\right).\n$$\nBy part 1, the median $t_{0.5}$ solves\n$$\n\\exp\\!\\left(-\\left(\\frac{t_{0.5}}{\\alpha}\\right)^{k}\\right) \\;=\\; 0.5,\n$$\nwhich implies\n$$\n\\left(\\frac{t_{0.5}}{\\alpha}\\right)^{k} \\;=\\; \\ln 2\n\\quad\\Longrightarrow\\quad\nt_{0.5}^{\\text{(weib)}} \\;=\\; \\alpha\\,(\\ln 2)^{1/k}.\n$$\n\nCollecting both results, the requested two-entry row vector of medians is\n$$\n\\left(t_{0.5}^{\\text{(exp)}},\\,t_{0.5}^{\\text{(weib)}}\\right)\n\\;=\\;\n\\left(\\frac{\\ln 2}{\\lambda},\\,\\alpha\\,(\\ln 2)^{1/k}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\ln 2}{\\lambda}  \\alpha(\\ln 2)^{1/k}\\end{pmatrix}}$$", "id": "4977992"}, {"introduction": "Our final practice bridges the gap between theory and real-world application by simulating the process of fitting a Weibull proportional hazards model to a small dataset. You will derive the log-likelihood and the score equations, which are the mathematical engine behind maximum likelihood estimation, and then use them to perform a numerical calculation [@problem_id:4977946]. This comprehensive exercise demystifies what statistical software does behind the scenes, showing how calculus and numerical algorithms like Newton-Raphson work together to estimate model parameters from censored data with covariates.", "problem": "A clinical trial investigates time-to-event outcomes under a parametric Weibull proportional hazards (PH) model. Assume independent right-censored observations. The Weibull PH model specifies the hazard function conditional on a covariate vector as $h(t \\mid \\boldsymbol{x}) = k \\lambda t^{k-1} \\exp(\\boldsymbol{x}^{\\top} \\boldsymbol{\\beta})$, where $k \\gt 0$ is the shape parameter, $\\lambda \\gt 0$ is the baseline scale parameter, and $\\boldsymbol{\\beta}$ are regression coefficients. The survival function is defined by $S(t \\mid \\boldsymbol{x}) = \\exp\\!\\big(-\\Lambda(t \\mid \\boldsymbol{x})\\big)$, where $\\Lambda(t \\mid \\boldsymbol{x})$ is the cumulative hazard.\n\nConsider a single binary covariate $x \\in \\{0,1\\}$ representing treatment assignment, with $\\beta$ the corresponding scalar coefficient. You observe $n = 5$ independent patients with right-censored times $(t_i, \\delta_i, x_i)$ given by:\n- $(t_1, \\delta_1, x_1) = (2, 1, 0)$\n- $(t_2, \\delta_2, x_2) = (5, 0, 1)$\n- $(t_3, \\delta_3, x_3) = (3, 1, 0)$\n- $(t_4, \\delta_4, x_4) = (8, 1, 1)$\n- $(t_5, \\delta_5, x_5) = (4, 0, 1)$\n\nAll times are measured on a consistent time scale (for example, months), but you should treat them as unitless for the purposes of this question.\n\nTasks:\n1) Starting only from the core definitions for independent right-censored data, namely that the likelihood factorizes as $\\prod_{i=1}^{n} \\left[h(t_i \\mid x_i)\\right]^{\\delta_i} S(t_i \\mid x_i)$ and the Weibull PH hazard and survival are as defined above, derive the full log-likelihood for $(\\beta, k, \\lambda)$ and then derive the score equations (first derivatives of the log-likelihood) for $\\beta$ and $k$. Express your results as explicit sums over $i = 1, \\dots, n$ in terms of $(t_i, \\delta_i, x_i)$ and $(\\beta, k, \\lambda)$.\n\n2) Describe how to jointly estimate $(\\beta, k, \\lambda)$ by maximum likelihood. Your description should begin from the score equations and proceed to a practical algorithmic solution suitable for implementation, making clear how all parameters are estimated simultaneously. Define any acronyms on first use, such as Maximum Likelihood Estimator (MLE) and Newton–Raphson (NR).\n\n3) Using the data above and the parameter values $(\\beta, k, \\lambda) = (-0.3, 1.5, 0.04)$, evaluate the joint score vector $\\big(U_{\\beta}, U_{k}, U_{\\lambda}\\big)$ at this parameter point. Report your answer as a single row matrix $\\begin{pmatrix} U_{\\beta}  U_{k}  U_{\\lambda} \\end{pmatrix}$. Round each component to four significant figures. Do not include units in your final numerical report.", "solution": "The problem asks for derivations related to the Weibull proportional hazards model, a description of the maximum likelihood estimation procedure, and a numerical evaluation of the score vector for a given dataset and parameter values. The problem is well-posed, scientifically grounded, and provides all necessary information.\n\n**1) Derivation of Log-Likelihood and Score Equations**\n\nThe analysis begins with the fundamental definitions of the model. The hazard function for the Weibull proportional hazards (PH) model with a single covariate $x$ is given by:\n$h(t \\mid x) = k \\lambda t^{k-1} \\exp(x \\beta)$\nwhere $k  0$ is the shape parameter, $\\lambda  0$ is the baseline scale parameter, and $\\beta$ is the regression coefficient for the covariate $x$.\n\nThe cumulative hazard function, $\\Lambda(t \\mid x)$, is the integral of the hazard function from $0$ to $t$:\n$$\n\\Lambda(t \\mid x) = \\int_{0}^{t} h(u \\mid x) \\, du = \\int_{0}^{t} k \\lambda u^{k-1} \\exp(x \\beta) \\, du\n$$\n$$\n\\Lambda(t \\mid x) = \\lambda \\exp(x \\beta) \\int_{0}^{t} k u^{k-1} \\, du = \\lambda \\exp(x \\beta) \\left[ u^k \\right]_{0}^{t} = \\lambda t^k \\exp(x \\beta)\n$$\nThe survival function, $S(t \\mid x)$, is defined as $S(t \\mid x) = \\exp(-\\Lambda(t \\mid x))$. Therefore:\n$$\nS(t \\mid x) = \\exp\\left(-\\lambda t^k \\exp(x \\beta)\\right)\n$$\nFor a sample of $n$ independent, right-censored observations $(t_i, \\delta_i, x_i)$, where $t_i$ is the observed time, $\\delta_i=1$ if the event occurred and $\\delta_i=0$ if the observation was censored, the likelihood function $L$ is the product of individual contributions. Each contribution is the probability density function (pdf) $f(t_i | x_i)$ if the event occurred ($\\delta_i=1$) or the survival function $S(t_i | x_i)$ if the observation was censored ($\\delta_i=0$). Since $f(t \\mid x) = h(t \\mid x) S(t \\mid x)$, the likelihood for observation $i$ is $[h(t_i \\mid x_i)]^{\\delta_i} S(t_i \\mid x_i)$. The full likelihood is:\n$$\nL(\\beta, k, \\lambda) = \\prod_{i=1}^{n} \\left[h(t_i \\mid x_i)\\right]^{\\delta_i} S(t_i \\mid x_i)\n$$\nSubstituting the expressions for $h(t \\mid x)$ and $S(t \\mid x)$:\n$$\nL(\\beta, k, \\lambda) = \\prod_{i=1}^{n} \\left[k \\lambda t_i^{k-1} \\exp(x_i \\beta)\\right]^{\\delta_i} \\exp\\left(-\\lambda t_i^k \\exp(x_i \\beta)\\right)\n$$\nThe log-likelihood, $\\ell(\\beta, k, \\lambda) = \\ln L(\\beta, k, \\lambda)$, is more convenient for differentiation:\n$$\n\\ell(\\beta, k, \\lambda) = \\sum_{i=1}^{n} \\left[ \\delta_i \\ln\\left(k \\lambda t_i^{k-1} \\exp(x_i \\beta)\\right) - \\lambda t_i^k \\exp(x_i \\beta) \\right]\n$$\n$$\n\\ell(\\beta, k, \\lambda) = \\sum_{i=1}^{n} \\left[ \\delta_i (\\ln(k) + \\ln(\\lambda) + (k-1)\\ln(t_i) + x_i \\beta) - \\lambda t_i^k \\exp(x_i \\beta) \\right]\n$$\nThis can be written as:\n$$\n\\ell(\\beta, k, \\lambda) = \\left(\\sum_{i=1}^{n} \\delta_i\\right) (\\ln(k) + \\ln(\\lambda)) + \\sum_{i=1}^{n} \\delta_i (k-1)\\ln(t_i) + \\beta \\sum_{i=1}^{n} \\delta_i x_i - \\lambda \\sum_{i=1}^{n} t_i^k \\exp(x_i \\beta)\n$$\nThe score equations are the first partial derivatives of the log-likelihood with respect to the parameters, set to zero. We derive the score components $U_{\\beta}$ and $U_{k}$ as requested. For completeness and use in subsequent parts, we also derive $U_{\\lambda}$.\n\nThe score component for $\\beta$ is $U_{\\beta} = \\frac{\\partial \\ell}{\\partial \\beta}$:\n$$\nU_{\\beta} = \\sum_{i=1}^{n} \\delta_i x_i - \\lambda \\sum_{i=1}^{n} \\frac{\\partial}{\\partial \\beta} \\left(t_i^k \\exp(x_i \\beta)\\right) = \\sum_{i=1}^{n} \\delta_i x_i - \\lambda \\sum_{i=1}^{n} t_i^k x_i \\exp(x_i \\beta)\n$$\nThe score component for $k$ is $U_{k} = \\frac{\\partial \\ell}{\\partial k}$:\n$$\nU_{k} = \\frac{\\partial}{\\partial k} \\left[ \\left(\\sum_{i=1}^{n} \\delta_i\\right) \\ln(k) + \\sum_{i=1}^{n} \\delta_i (k-1)\\ln(t_i) - \\lambda \\sum_{i=1}^{n} t_i^k \\exp(x_i \\beta) \\right]\n$$\nUsing the fact that $\\frac{d}{dk} t_i^k = t_i^k \\ln(t_i)$:\n$$\nU_{k} = \\frac{\\sum_{i=1}^{n} \\delta_i}{k} + \\sum_{i=1}^{n} \\delta_i \\ln(t_i) - \\lambda \\sum_{i=1}^{n} t_i^k \\ln(t_i) \\exp(x_i \\beta)\n$$\nThe score component for $\\lambda$ is $U_{\\lambda} = \\frac{\\partial \\ell}{\\partial \\lambda}$:\n$$\nU_{\\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left[ \\left(\\sum_{i=1}^{n} \\delta_i\\right) \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} t_i^k \\exp(x_i \\beta) \\right] = \\frac{\\sum_{i=1}^{n} \\delta_i}{\\lambda} - \\sum_{i=1}^{n} t_i^k \\exp(x_i \\beta)\n$$\n\n**2) Maximum Likelihood Estimation Procedure**\n\nThe joint Maximum Likelihood Estimators (MLEs) of the parameter vector $\\boldsymbol{\\theta} = (\\beta, k, \\lambda)^{\\top}$ are the values $(\\hat{\\beta}, \\hat{k}, \\hat{\\lambda})$ that maximize the log-likelihood function $\\ell(\\boldsymbol{\\theta})$. These estimators are found by solving the system of score equations, where the score vector $U(\\boldsymbol{\\theta}) = (U_{\\beta}, U_{k}, U_{\\lambda})^{\\top}$ is set to the zero vector:\n$$\nU(\\boldsymbol{\\theta}) = \\boldsymbol{0}\n$$\nThe score equations are non-linear and coupled, meaning they cannot be solved analytically for $(\\beta, k, \\lambda)$. Therefore, a numerical optimization algorithm is required. A standard and efficient method for this problem is the Newton-Raphson (NR) algorithm.\n\nThe NR algorithm is an iterative procedure for finding the roots of a system of equations. To find the MLE, it iteratively updates the parameter estimates using the following formula:\n$$\n\\boldsymbol{\\theta}^{(m+1)} = \\boldsymbol{\\theta}^{(m)} - \\left[H\\left(\\boldsymbol{\\theta}^{(m)}\\right)\\right]^{-1} U\\left(\\boldsymbol{\\theta}^{(m)}\\right)\n$$\nwhere:\n- $\\boldsymbol{\\theta}^{(m)}$ is the vector of parameter estimates at iteration $m$.\n- $U(\\boldsymbol{\\theta}^{(m)})$ is the score vector (first derivatives of $\\ell$) evaluated at $\\boldsymbol{\\theta}^{(m)}$.\n- $H(\\boldsymbol{\\theta}^{(m)})$ is the Hessian matrix, which is the $3 \\times 3$ matrix of second partial derivatives of the log-likelihood, $\\left[H_{ij}\\right] = \\frac{\\partial^2 \\ell}{\\partial \\theta_i \\partial \\theta_j}$, evaluated at $\\boldsymbol{\\theta}^{(m)}$. The negative of the Hessian is the observed information matrix.\n\nThe practical algorithmic solution proceeds as follows:\n1.  **Initialization**: Choose a starting value for the parameter vector, $\\boldsymbol{\\theta}^{(0)} = (\\beta^{(0)}, k^{(0)}, \\lambda^{(0)})^{\\top}$.\n2.  **Iteration**: For $m = 0, 1, 2, \\dots$:\n    a.  Calculate the score vector $U(\\boldsymbol{\\theta}^{(m)})$ using the expressions derived in Part 1.\n    b.  Calculate the $3 \\times 3$ Hessian matrix $H(\\boldsymbol{\\theta}^{(m)})$ by taking the second partial derivatives of the log-likelihood function $\\ell(\\boldsymbol{\\theta})$. For example, $H_{11} = \\frac{\\partial^2 \\ell}{\\partial \\beta^2} = -\\lambda \\sum_{i=1}^{n} t_i^k x_i^2 \\exp(x_i \\beta)$, and so on for all nine elements.\n    c.  Invert the Hessian matrix to obtain $[H(\\boldsymbol{\\theta}^{(m)})]^{-1}$.\n    d.  Update the parameter vector using the NR formula: $\\boldsymbol{\\theta}^{(m+1)} = \\boldsymbol{\\theta}^{(m)} - [H(\\boldsymbol{\\theta}^{(m)})]^{-1} U(\\boldsymbol{\\theta}^{(m)})$.\n3.  **Convergence**: Repeat the iteration step until a convergence criterion is met. This is typically when the change in the parameter estimates, $\\|\\boldsymbol{\\theta}^{(m+1)} - \\boldsymbol{\\theta}^{(m)}\\|$, or the magnitude of the score vector, $\\|U(\\boldsymbol{\\theta}^{(m+1)})\\|$, falls below a small, pre-specified tolerance $\\epsilon$.\n4.  **Result**: The final parameter vector, $\\boldsymbol{\\theta}^{(m+1)}$, is the MLE, denoted $\\hat{\\boldsymbol{\\theta}} = (\\hat{\\beta}, \\hat{k}, \\hat{\\lambda})$.\n\n**3) Numerical Evaluation of the Score Vector**\n\nWe are asked to evaluate the score vector $(U_{\\beta}, U_{k}, U_{\\lambda})$ at the point $(\\beta, k, \\lambda) = (-0.3, 1.5, 0.04)$.\nThe data for $n=5$ patients are:\n- $(t_1, \\delta_1, x_1) = (2, 1, 0)$\n- $(t_2, \\delta_2, x_2) = (5, 0, 1)$\n- $(t_3, \\delta_3, x_3) = (3, 1, 0)$\n- $(t_4, \\delta_4, x_4) = (8, 1, 1)$\n- $(t_5, \\delta_5, x_5) = (4, 0, 1)$\n\nFirst, we compute summary statistics:\n- Total number of events: $D = \\sum_{i=1}^{5} \\delta_i = 1+0+1+1+0 = 3$.\n- $\\sum_{i=1}^{5} \\delta_i x_i = (1 \\cdot 0) + (0 \\cdot 1) + (1 \\cdot 0) + (1 \\cdot 1) + (0 \\cdot 1) = 1$.\n- $\\sum_{i=1}^{5} \\delta_i \\ln(t_i) = 1 \\cdot \\ln(2) + 1 \\cdot \\ln(3) + 1 \\cdot \\ln(8) = \\ln(2 \\cdot 3 \\cdot 8) = \\ln(48) \\approx 3.8712$.\n\nNext, we evaluate the required sums using the given parameter values $k=1.5$ and $\\beta=-0.3$, where $\\exp(-0.3) \\approx 0.740818$.\n\n**Evaluation of $U_{\\beta}$:**\n$U_{\\beta} = \\sum_{i=1}^{5} \\delta_i x_i - \\lambda \\sum_{i=1}^{5} t_i^k x_i \\exp(x_i \\beta)$.\nThe second term is $\\lambda \\exp(\\beta) \\sum_{i: x_i=1} t_i^k$:\n$\\sum_{i: x_i=1} t_i^k = t_2^{1.5} + t_4^{1.5} + t_5^{1.5} = 5^{1.5} + 8^{1.5} + 4^{1.5} \\approx 11.18034 + 22.62742 + 8 = 41.80776$.\n$\\lambda \\exp(\\beta) \\sum_{i: x_i=1} t_i^k \\approx 0.04 \\times 0.740818 \\times 41.80776 \\approx 1.23886$.\n$U_{\\beta} = 1 - 1.23886 = -0.23886$.\nTo four significant figures, $U_{\\beta} = -0.2389$.\n\n**Evaluation of $U_{k}$:**\n$U_{k} = \\frac{D}{k} + \\sum_{i=1}^{5} \\delta_i \\ln(t_i) - \\lambda \\sum_{i=1}^{5} t_i^k \\ln(t_i) \\exp(x_i \\beta)$.\n$D/k = 3/1.5 = 2$.\n$\\sum \\delta_i \\ln(t_i) = \\ln(48) \\approx 3.87120$.\nLet's compute the final sum term by term:\n$i=1: 2^{1.5}\\ln(2)\\exp(0) \\approx 1.96091$\n$i=2: 5^{1.5}\\ln(5)\\exp(-0.3) \\approx 13.33083$\n$i=3: 3^{1.5}\\ln(3)\\exp(0) \\approx 5.70868$\n$i=4: 8^{1.5}\\ln(8)\\exp(-0.3) \\approx 34.85624$\n$i=5: 4^{1.5}\\ln(4)\\exp(-0.3) \\approx 8.21664$\n$\\sum_{i=1}^{5} t_i^k \\ln(t_i) \\exp(x_i \\beta) \\approx 1.96091+13.33083+5.70868+34.85624+8.21664 = 64.0733$.\n$\\lambda \\sum t_i^k \\ln(t_i) \\exp(x_i \\beta) \\approx 0.04 \\times 64.0733 = 2.56293$.\n$U_{k} = 2 + 3.87120 - 2.56293 = 3.30827$.\nTo four significant figures, $U_{k} = 3.308$.\n\n**Evaluation of $U_{\\lambda}$:**\n$U_{\\lambda} = \\frac{D}{\\lambda} - \\sum_{i=1}^{5} t_i^k \\exp(x_i \\beta)$.\n$D/\\lambda = 3/0.04 = 75$.\nLet's compute the sum term by term:\n$i=1: 2^{1.5}\\exp(0) \\approx 2.82843$\n$i=2: 5^{1.5}\\exp(-0.3) \\approx 8.28253$\n$i=3: 3^{1.5}\\exp(0) \\approx 5.19615$\n$i=4: 8^{1.5}\\exp(-0.3) \\approx 16.76214$\n$i=5: 4^{1.5}\\exp(-0.3) \\approx 5.92654$\n$\\sum_{i=1}^{5} t_i^k \\exp(x_i \\beta) \\approx 2.82843+8.28253+5.19615+16.76214+5.92654 = 38.99579$.\n$U_{\\lambda} = 75 - 38.99579 = 36.00421$.\nTo four significant figures, $U_{\\lambda} = 36.00$.\n\nThe joint score vector $(U_{\\beta}, U_{k}, U_{\\lambda})$ evaluated at the given point is $(-0.2389, 3.308, 36.00)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -0.2389  3.308  36.00 \\end{pmatrix}}\n$$", "id": "4977946"}]}