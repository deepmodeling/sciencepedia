{"hands_on_practices": [{"introduction": "The first step in many survival analyses is to transform raw event and censoring data into a meaningful survival curve. This exercise introduces the actuarial method, a cornerstone technique for estimating survival probabilities from data grouped into time intervals. By building a life table, you will practice the fundamental calculations for handling censored observations and estimate the median survival time, a crucial summary statistic in reliability and medical studies [@problem_id:1925049].", "problem": "An engineering firm is conducting a reliability study on a new model of industrial light bulbs. A batch of 250 bulbs was placed on test, and their status was recorded at the end of each week. A bulb's life is considered 'failed' if it burns out and 'censored' if it is withdrawn from the study for reasons other than failure (e.g., accidental breakage or removal for other experiments). The study was conducted for five weeks, and the following data were collected:\n\n- **Week 1 (Interval [0, 1) weeks):** 10 failures, 5 censored.\n- **Week 2 (Interval [1, 2) weeks):** 25 failures, 3 censored.\n- **Week 3 (Interval [2, 3) weeks):** 40 failures, 2 censored.\n- **Week 4 (Interval [3, 4) weeks):** 55 failures, 0 censored.\n- **Week 5 (Interval [4, 5) weeks):** 30 failures, 1 censored.\n\nTo handle the censored data, assume that censored bulbs were at risk for, on average, half of the interval in which they were withdrawn. Using the actuarial method and linear interpolation, estimate the median survival time of these light bulbs.\n\nExpress your final answer in weeks, rounded to three significant figures.", "solution": "The objective is to find the median survival time, which is the time $t_m$ at which the survival function $S(t)$ equals 0.5. We will first construct a life table to estimate the survival function $S(t)$ using the actuarial method, and then use linear interpolation to find $t_m$.\n\nThe life table calculation proceeds interval by interval. For each interval $i$, starting at time $t_i$ and ending at $t_{i+1}$:\n- $n_i$: The number of items at risk at the start of interval $i$.\n- $d_i$: The number of failures (events) during interval $i$.\n- $c_i$: The number of censored items during interval $i$.\n- $n'_i$: The effective number of items at risk during interval $i$. Given the assumption that censoring occurs on average halfway through the interval, this is calculated as $n'_i = n_i - \\frac{c_i}{2}$.\n- $q_i$: The conditional probability of failure during interval $i$, calculated as $q_i = \\frac{d_i}{n'_i}$.\n- $p_i$: The conditional probability of survival through interval $i$, calculated as $p_i = 1 - q_i$.\n- $S(t_{i+1})$: The cumulative probability of surviving to the end of interval $i$. This is the product of all previous conditional survival probabilities: $S(t_{i+1}) = S(t_i) \\times p_i$. We start with $S(t_0) = S(0) = 1$.\n\nLet's populate the life table based on the provided data.\n\n**Interval 1: [0, 1) weeks**\n- At risk at start, $n_0 = 250$.\n- Failures, $d_0 = 10$.\n- Censored, $c_0 = 5$.\n- Effective number at risk, $n'_0 = 250 - \\frac{5}{2} = 247.5$.\n- Conditional probability of failure, $q_0 = \\frac{10}{247.5}$.\n- Conditional probability of survival, $p_0 = 1 - \\frac{10}{247.5} = \\frac{237.5}{247.5}$.\n- Cumulative survival at $t=1$, $S(1) = S(0) \\times p_0 = 1 \\times \\frac{237.5}{247.5} \\approx 0.959596$.\n\n**Interval 2: [1, 2) weeks**\n- At risk at start, $n_1 = n_0 - d_0 - c_0 = 250 - 10 - 5 = 235$.\n- Failures, $d_1 = 25$.\n- Censored, $c_1 = 3$.\n- Effective number at risk, $n'_1 = 235 - \\frac{3}{2} = 233.5$.\n- Conditional probability of failure, $q_1 = \\frac{25}{233.5}$.\n- Conditional probability of survival, $p_1 = 1 - \\frac{25}{233.5} = \\frac{208.5}{233.5}$.\n- Cumulative survival at $t=2$, $S(2) = S(1) \\times p_1 = \\left(\\frac{237.5}{247.5}\\right) \\times \\left(\\frac{208.5}{233.5}\\right) \\approx 0.857790$.\n\n**Interval 3: [2, 3) weeks**\n- At risk at start, $n_2 = n_1 - d_1 - c_1 = 235 - 25 - 3 = 207$.\n- Failures, $d_2 = 40$.\n- Censored, $c_2 = 2$.\n- Effective number at risk, $n'_2 = 207 - \\frac{2}{2} = 206$.\n- Conditional probability of failure, $q_2 = \\frac{40}{206} = \\frac{20}{103}$.\n- Conditional probability of survival, $p_2 = 1 - \\frac{20}{103} = \\frac{83}{103}$.\n- Cumulative survival at $t=3$, $S(3) = S(2) \\times p_2 \\approx 0.857790 \\times \\frac{83}{103} \\approx 0.691143$.\n\n**Interval 4: [3, 4) weeks**\n- At risk at start, $n_3 = n_2 - d_2 - c_2 = 207 - 40 - 2 = 165$.\n- Failures, $d_3 = 55$.\n- Censored, $c_3 = 0$.\n- Effective number at risk, $n'_3 = 165 - \\frac{0}{2} = 165$.\n- Conditional probability of failure, $q_3 = \\frac{55}{165} = \\frac{1}{3}$.\n- Conditional probability of survival, $p_3 = 1 - \\frac{1}{3} = \\frac{2}{3}$.\n- Cumulative survival at $t=4$, $S(4) = S(3) \\times p_3 \\approx 0.691143 \\times \\frac{2}{3} \\approx 0.460762$.\n\nWe have now determined that $S(3) \\approx 0.691143$ and $S(4) \\approx 0.460762$. Since $S(3)  0.5$ and $S(4)  0.5$, the median survival time $t_m$ lies within the interval $[3, 4)$.\n\nWe use linear interpolation to estimate $t_m$. The formula for linear interpolation is:\n$t_m = t_j + w_j \\left( \\frac{S(t_j) - 0.5}{S(t_j) - S(t_{j+1})} \\right)$\nwhere:\n- $t_j$ is the start time of the median interval, so $t_j = 3$ weeks.\n- $w_j$ is the width of the median interval, so $w_j = 4 - 3 = 1$ week.\n- $S(t_j)$ is the survival probability at the start of the interval, $S(3) \\approx 0.691143$.\n- $S(t_{j+1})$ is the survival probability at the end of the interval, $S(4) \\approx 0.460762$.\n\nSubstituting the values:\n$t_m = 3 + 1 \\times \\left( \\frac{0.691143 - 0.5}{0.691143 - 0.460762} \\right)$\n$t_m = 3 + \\frac{0.191143}{0.230381}$\n$t_m \\approx 3 + 0.82968$\n$t_m \\approx 3.82968$\n\nThe problem asks for the answer rounded to three significant figures.\n$t_m \\approx 3.83$ weeks.", "answer": "$$\\boxed{3.83}$$", "id": "1925049"}, {"introduction": "Beyond calculating survival estimates, a skilled analyst must understand their statistical properties. This problem challenges you to think critically about the quality of your data and its effect on the results from the Kaplan-Meier estimator. By analyzing a hypothetical clinical trial scenario with a high rate of late-stage censoring, you will explore the crucial distinction between an estimator's bias and its precision, building intuition for interpreting the reliability of survival curves, especially in the tail of the distribution [@problem_id:1925065].", "problem": "A biostatistics team is analyzing the results of a 5-year clinical trial for a new therapeutic drug designed to slow the progression of a non-lethal, chronic disease. The event of interest is a specific, well-defined milestone of disease progression. The study enrolled a large cohort of patients at time $t=0$.\n\nDuring the first four years of the study, patient follow-up was excellent. However, in the fifth and final year, a substantial fraction of the remaining patients who had not yet experienced the event of interest dropped out of the study for reasons documented to be unrelated to their disease status (e.g., relocating for a new job, dislike of the study protocol). These dropouts are treated as right-censored data points at the time they leave the study.\n\nThe team uses the Kaplan-Meier method to estimate the survival function, $S(t)$, which represents the probability that a patient has not experienced the disease progression event by time $t$. The lead statistician is particularly concerned about the quality of the estimate for $S(t)$ in the tail of the distribution, specifically in the last year of the study (i.e., for $t \\in (4, 5]$ years).\n\nWhich of the following statements best describes the primary statistical consequence of this high volume of late-stage right-censoring on the Kaplan-Meier estimate of the survival probability in the tail of the distribution?\n\nA. The estimate becomes more precise (i.e., has a smaller variance) and remains an unbiased estimate of the true survival probability.\n\nB. The estimate becomes less precise (i.e., has a larger variance) but remains an unbiased estimate of the true survival probability.\n\nC. The estimate becomes biased, tending to overestimate the true survival probability, and also becomes more precise.\n\nD. The estimate becomes biased, tending to underestimate the true survival probability, and also becomes less precise.\n\nE. The estimate is largely unaffected in terms of both bias and precision, as the censored individuals did not have the event.", "solution": "The problem asks for the statistical effect of a high rate of right-censoring late in a study period on the Kaplan-Meier (KM) survival estimate. We need to analyze the impact on two key properties of an estimator: its bias and its precision (variance).\n\nFirst, let's recall the Kaplan-Meier estimator for the survival function $S(t)$. Let $t_1  t_2  \\dots  t_k$ be the distinct times at which at least one event (disease progression) occurred. The KM estimate is given by the product:\n$$ \\hat{S}(t) = \\prod_{i: t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right) $$\nHere, $d_i$ is the number of patients who experienced the event at time $t_i$, and $n_i$ is the number of patients who were at risk (i.e., alive and under observation) just prior to time $t_i$.\n\n**Analysis of Bias:**\nA key assumption for the validity of the Kaplan-Meier estimator is that censoring is non-informative. This means that the mechanism causing a patient to be censored is independent of their prognosis or risk of experiencing the event. The problem statement explicitly provides reasons for dropout (\"relocating for a new job, dislike of the study protocol\") that are \"unrelated to their disease status.\" Under this assumption of non-informative censoring, the Kaplan-Meier estimator is known to be an asymptotically unbiased estimator of the true survival function $S(t)$. This means that for a large enough sample, the expected value of the estimator, $E[\\hat{S}(t)]$, is approximately equal to the true value $S(t)$. The heavy censoring does not, in itself, introduce a systematic tendency to overestimate or underestimate the survival probability. Therefore, we can conclude the estimate remains unbiased.\n\n**Analysis of Precision (Variance):**\nPrecision is the inverse of variance. A less precise estimate has a larger variance. The variance of the Kaplan-Meier estimator can be approximated using Greenwood's formula:\n$$ \\text{Var}(\\hat{S}(t)) \\approx [\\hat{S}(t)]^2 \\sum_{i: t_i \\le t} \\frac{d_i}{n_i(n_i - d_i)} $$\nLet's analyze the terms in this formula. The summation is over all event times up to time $t$. The problem states that there is a high volume of right-censoring in the final year of the study. When a patient is censored, they are removed from the risk set for all subsequent time points. Therefore, for event times $t_i$ in the tail of the distribution (the final year), the number of patients at risk, $n_i$, will be significantly reduced.\n\nAs $n_i$ becomes small, the term $\\frac{d_i}{n_i(n_i - d_i)}$ in the variance formula becomes very large. For example, if there are only $n_i = 5$ patients at risk and $d_i = 1$ event occurs, the contribution to the sum is $\\frac{1}{5(4)} = 0.05$. If, due to heavy censoring, there were only $n_i = 2$ patients at risk and $d_i = 1$ event occurred, the contribution would be $\\frac{1}{2(1)} = 0.5$, an order of magnitude larger.\n\nBecause the number at risk, $n_i$, appears in the denominator, a small risk set leads to a large variance. This means the estimate $\\hat{S}(t)$ becomes highly unstable and uncertain in the tail of the distribution. The confidence intervals around the KM curve would become very wide. Therefore, the estimate becomes significantly less precise.\n\n**Conclusion:**\nThe high rate of late-stage, non-informative right-censoring makes the number of patients at risk in the tail of the distribution very small. This drastically increases the variance of the Kaplan-Meier estimate for large $t$, making it less precise. However, because the censoring is non-informative, the estimator remains unbiased.\n\nCombining these two findings:\n- The estimate remains unbiased.\n- The estimate becomes less precise (variance increases).\n\nThis corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1925065"}, {"introduction": "A point estimate, like the median survival time, is only part of the story; quantifying our uncertainty is just as important. This practice introduces the non-parametric bootstrap, a powerful computational method for constructing confidence intervals without relying on strong distributional assumptions. You will learn how to interpret the results of a bootstrap analysis to determine a 95% confidence interval for the median lifetime, providing a range of plausible values and a more complete picture of the component's reliability [@problem_id:1925069].", "problem": "A city's water management department is assessing the reliability of a specific model of high-capacity water pump. A study followed a sample of 10 pumps for a period of 8 years. For each pump, the data recorded is a pair $(T, \\delta)$, where $T$ is the time in years (either to failure or to the end of the study) and $\\delta$ is a status indicator ($\\delta=1$ for failure, $\\delta=0$ for being operational at the study's end). The dataset is:\n(1.9, 1), (2.8, 1), (3.1, 1), (4.2, 1), (5.5, 1), (6.9, 1), (7.8, 1), (8.0, 0), (8.0, 0), (8.0, 0).\n\nTo quantify the uncertainty in the estimated median lifetime, a non-parametric bootstrap procedure was performed. A total of $B=39$ bootstrap samples were generated by resampling the original 10 data pairs with replacement. For each bootstrap sample, the median lifetime was estimated (in many cases, using the Kaplan-Meier estimator, as the bootstrap samples also contain censored data). The 39 resulting median lifetime estimates, sorted in ascending order, are provided below:\n\n`[3.1, 4.2, 4.2, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 6.9, 6.9, 6.9, 6.9, 6.9, 6.9, 6.9, 6.9, 6.9, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 7.8, 8.0, 8.0, 8.0]`\n\nUsing the bootstrap percentile method, determine the 95% confidence interval for the median pump lifetime. Express your answer as a pair of values representing the lower and upper bounds of the interval, in years. Round your final answers to two significant figures.", "solution": "We are given $B=39$ bootstrap replications of the median lifetime, sorted in ascending order. Using the bootstrap percentile method for a two-sided confidence interval with confidence level $1-\\alpha=0.95$ (so $\\alpha=0.05$), the endpoints are the empirical quantiles at probabilities $p_{\\ell}=\\alpha/2=0.025$ and $p_{u}=1-\\alpha/2=0.975$ of the bootstrap distribution.\n\nWith the sorted bootstrap statistics denoted by $x_{(1)} \\leq x_{(2)} \\leq \\dots \\leq x_{(B)}$, the percentile method uses order-statistic indices computed by the nearest-rank rule based on $(B+1)p$, that is\n$$\nk_{\\ell}=\\lceil (B+1)p_{\\ell} \\rceil,\\quad k_{u}=\\lceil (B+1)p_{u} \\rceil.\n$$\nSubstituting $B=39$, we have $B+1=40$, so\n$$\nk_{\\ell}=\\lceil 40 \\cdot 0.025 \\rceil=\\lceil 1 \\rceil=1,\\qquad\nk_{u}=\\lceil 40 \\cdot 0.975 \\rceil=\\lceil 39 \\rceil=39.\n$$\nTherefore, the $95$ percent bootstrap percentile confidence interval is given by the first and thirty-ninth order statistics of the provided sorted list. Reading them off, $x_{(1)}=3.1$ and $x_{(39)}=8.0$. Rounding to two significant figures yields the same values.\n\nHence, the $95$ percent confidence interval for the median pump lifetime is $(3.1,\\ 8.0)$ years.", "answer": "$$\\boxed{\\begin{pmatrix} 3.1  8.0 \\end{pmatrix}}$$", "id": "1925069"}]}