{"hands_on_practices": [{"introduction": "The foundation of statistical testing lies not in complex software but in understanding the logic from first principles. This first practice exercise is designed to demystify Fisher's Exact Test by guiding you through a manual calculation. By working through the steps of fixing margins, enumerating all possible tables, and applying the hypergeometric probability formula, you will build a concrete understanding of how the test quantifies evidence against the null hypothesis of independence. [@problem_id:4912046]", "problem": "A clinical pilot study records a $2 \\times 2$ contingency table of treatment assignment versus binary outcome, with observed cell counts denoted by $(a,b;c,d)=(3,1;0,4)$. Under the null hypothesis of independence with fixed margins (the conditional model underlying Fisher’s exact test (FET)), the distribution of the top-left cell count is determined by sampling without replacement.\n\nUsing only the definitions of a $2 \\times 2$ table, fixed row and column margins, and elementary combinatorial counting for sampling without replacement, do the following:\n\n- Compute the row totals $n_{1}$ and $n_{2}$, the column totals $m_{1}$ and $m_{2}$, and the grand total $N$.\n- From the fixed margins, determine the set of all feasible values of the top-left cell $a'$ that preserve the margins.\n- Using the counting argument for sampling without replacement, express the conditional probability of observing a table with $a'=k$ as a function of the margins and $k$.\n- For testing $H_{0}$ (independence) versus the one-sided alternative of positive association (i.e., larger $a'$ indicates stronger evidence against $H_{0}$), compute the one-sided Fisher’s exact $p$-value $\\Pr(A \\ge a \\mid \\text{margins fixed})$ for the observed table.\n\nReport only the one-sided Fisher’s exact $p$-value as your final numeric answer, rounded to four significant figures. No units are required.", "solution": "The problem is valid as it presents a standard, well-posed question in biostatistics with all necessary data for a unique solution. We will proceed by following the steps outlined in the problem statement.\n\nThe observed $2 \\times 2$ contingency table is given by the cell counts $(a, b; c, d) = (3, 1; 0, 4)$. We can represent this table as:\n$$\n\\begin{array}{c|cc|c}\n  \\text{Outcome 1}  \\text{Outcome 2}  \\text{Total} \\\\\n\\hline\n\\text{Group 1}  a=3  b=1  n_1 \\\\\n\\text{Group 2}  c=0  d=4  n_2 \\\\\n\\hline\n\\text{Total}  m_1  m_2  N\n\\end{array}\n$$\n\nFirst, we compute the row totals ($n_{1}$, $n_{2}$), column totals ($m_{1}$, $m_{2}$), and the grand total ($N$). These are the fixed margins for the conditional test.\nRow totals:\n$n_{1} = a + b = 3 + 1 = 4$\n$n_{2} = c + d = 0 + 4 = 4$\n\nColumn totals:\n$m_{1} = a + c = 3 + 0 = 3$\n$m_{2} = b + d = 1 + 4 = 5$\n\nGrand total:\n$N = n_{1} + n_{2} = 4 + 4 = 8$\nAs a check, $N = m_{1} + m_{2} = 3 + 5 = 8$, which is consistent.\n\nSecond, we determine the set of all feasible values for the top-left cell count, which we will denote by $a'$, that preserve these fixed margins. A general table with these margins can be written as:\n$$\n\\begin{array}{c|cc|c}\n  \\text{Col 1}  \\text{Col 2}  \\text{Total} \\\\\n\\hline\n\\text{Row 1}  a'  4-a'  4 \\\\\n\\text{Row 2}  3-a'  1+a'  4 \\\\\n\\hline\n\\text{Total}  3  5  8\n\\end{array}\n$$\nSince each cell count must be a non-negative integer, we have the following constraints on $a'$:\n$a' \\ge 0$\n$4 - a' \\ge 0 \\implies a' \\le 4$\n$3 - a' \\ge 0 \\implies a' \\le 3$\n$1 + a' \\ge 0 \\implies a' \\ge -1$\n\nCombining these inequalities, we find that $0 \\le a' \\le 3$. Thus, the set of all feasible integer values for the top-left cell is $\\{0, 1, 2, 3\\}$.\n\nThird, we express the conditional probability of observing a table with $a' = k$ for some value $k$. Under the null hypothesis of independence with fixed margins, the count $a'$ follows a hypergeometric distribution. This arises from a combinatorial argument of sampling without replacement. The total number of ways to choose $m_{1}=3$ individuals for the first column from a total of $N=8$ individuals is $\\binom{N}{m_{1}} = \\binom{8}{3}$. The number of ways to form a specific table with $a'=k$ is to choose $k$ individuals from the first row (with $n_{1}=4$ individuals) for the first column, which is $\\binom{n_{1}}{k} = \\binom{4}{k}$, and to choose the remaining $m_{1}-k=3-k$ individuals for the first column from the second row (with $n_{2}=4$ individuals), which is $\\binom{n_{2}}{m_{1}-k} = \\binom{4}{3-k}$.\n\nThe probability of observing a table with the top-left cell equal to $k$ is therefore:\n$$ P(A=k) = \\frac{\\binom{n_1}{k} \\binom{n_2}{m_1-k}}{\\binom{N}{m_1}} = \\frac{\\binom{4}{k}\\binom{4}{3-k}}{\\binom{8}{3}} $$\n\nFourth, we compute the one-sided Fisher's exact $p$-value. The observed table has $a=3$. The alternative hypothesis is for positive association, which corresponds to larger values of the top-left cell count $a'$. The $p$-value is the probability of observing a table with a count as extreme or more extreme than the one observed, in the direction of the alternative.\n$$ p\\text{-value} = \\Pr(A \\ge a \\mid \\text{margins fixed}) = \\Pr(A \\ge 3) $$\nSince the possible values for the random variable $A$ are $\\{0, 1, 2, 3\\}$, the event $A \\ge 3$ consists of only the outcome $A=3$. Therefore, the $p$-value is simply $P(A=3)$.\n\nWe calculate this probability using the formula derived above:\n$$ p\\text{-value} = P(A=3) = \\frac{\\binom{4}{3}\\binom{4}{3-3}}{\\binom{8}{3}} = \\frac{\\binom{4}{3}\\binom{4}{0}}{\\binom{8}{3}} $$\nWe compute the binomial coefficients:\n$\\binom{4}{3} = \\frac{4!}{3!(4-3)!} = 4$\n$\\binom{4}{0} = \\frac{4!}{0!(4-0)!} = 1$\n$\\binom{8}{3} = \\frac{8!}{3!(8-3)!} = \\frac{8 \\times 7 \\times 6}{3 \\times 2 \\times 1} = 56$\n\nSubstituting these values:\n$$ p\\text{-value} = \\frac{4 \\times 1}{56} = \\frac{4}{56} = \\frac{1}{14} $$\n\nThe problem asks for a numeric answer rounded to four significant figures.\n$$ \\frac{1}{14} \\approx 0.07142857\\dots $$\nRounding to four significant figures gives $0.07143$.", "answer": "$$\\boxed{0.07143}$$", "id": "4912046"}, {"introduction": "Real-world data, especially from small studies, can present unique challenges. One common occurrence is a \"zero cell\" in a contingency table, which can have surprising consequences for different types of statistical analysis. This problem asks you to explore the practical implications of a zero count, forcing a critical distinction between estimating an effect size, like the odds ratio, and conducting a hypothesis test. You will discover why Fisher's test is considered \"exact\" and robust in these situations, whereas other measures may require special adjustments. [@problem_id:4911992]", "problem": "A small randomized pilot study evaluates whether a prophylactic treatment reduces the risk of a binary infection outcome. The $2 \\times 2$ table of counts is:\n\n- Treated group: $0$ infected, $8$ not infected.\n- Control group: $4$ infected, $2$ not infected.\n\nAssume the study design yields fixed margins on treatment allocation and on total number of infections. Consider the odds ratio (OR) parameter for association and the conditional approach underlying Fisher’s exact test.\n\nFrom first principles:\n\n- Define the odds in each group and the odds ratio (OR) as the ratio of odds between treated and control groups. Use the maximum likelihood estimator (MLE) of the OR based on the cell counts, and reason about its behavior when a cell count is zero.\n- Under the null hypothesis of no association between treatment and infection and conditioning on the fixed margins, derive the exact distribution of the number of infected subjects in the treated group and use it to compute the exact one-sided $p$-value for the alternative that the treatment is protective.\n- Explain whether any continuity corrections or small-sample adjustments are required for Fisher’s exact $p$-value, and contrast this with small-sample adjustments commonly used for estimation of the OR when a zero cell occurs.\n\nWhich option best captures the correct conclusions for this dataset and context?\n\nA. The MLE of the odds ratio is infinite because there is a zero cell; Fisher’s exact test requires adding $0.5$ to all cells to compute any $p$-value; the two-sided exact $p$-value is approximately $0.03$ regardless of definition.\n\nB. The MLE of the odds ratio equals $0$ for these counts; Fisher’s exact test is valid without any continuity correction, and the one-sided exact $p$-value for a protective effect is approximately $0.015$; adding $0.5$ to each cell (a Haldane–Anscombe correction) yields a finite odds ratio estimate useful for small-sample estimation.\n\nC. The MLE of the odds ratio equals the risk ratio; Fisher’s exact test approximates the large-sample chi-square $p$-value even with a zero cell; mid-$p$ values are always larger than classical exact $p$-values.\n\nD. Because of the zero cell, both the odds ratio and Fisher’s exact $p$-value are undefined; the standard remedy is to drop the treated group and analyze a $1 \\times 2$ table; mid-$p$ adjustments are invalid in exact testing.\n\nE. The MLE of the odds ratio equals $0$, and Fisher’s exact two-sided $p$-value is exactly $0.03$ for any definition of “two-sided”; adding $1$ only to the zero cell produces an unbiased odds ratio estimate in small samples.", "solution": "Begin with the core definitions. For a binary outcome, the odds in a group are defined as $p/(1-p)$, where $p$ is the group’s event probability. In a $2 \\times 2$ table with cell counts\n$\n\\begin{array}{cc}\na  b \\\\\nc  d\n\\end{array}\n$\ncorresponding to treated infected $(a)$, treated not infected $(b)$, control infected $(c)$, and control not infected $(d)$, the sample odds in the treated group are $a/b$ (events over non-events), and in the control group are $c/d$. The odds ratio (OR) is the ratio of these odds, which simplifies to $\\text{OR} = (a d)/(b c)$. The maximum likelihood estimator (MLE) of the OR under a multinomial sampling model coincides with this sample odds ratio.\n\nFor the given data, we have $a = 0$, $b = 8$, $c = 4$, and $d = 2$. Therefore,\n$\n\\widehat{\\text{OR}} = \\frac{a d}{b c} = \\frac{0 \\cdot 2}{8 \\cdot 4} = 0.\n$\nThis is a boundary estimate: the log-odds ratio $\\log(\\widehat{\\text{OR}})$ is $-\\infty$, and large-sample Wald procedures for $\\log(\\text{OR})$ are not applicable because they require finite counts in all cells to form the usual variance estimate (which involves reciprocals of the cell counts). A commonly used small-sample adjustment for estimation is the Haldane–Anscombe correction, which adds $0.5$ to each cell to reduce bias and avoid infinities. With this correction, the adjusted counts are $a^{*} = 0.5$, $b^{*} = 8.5$, $c^{*} = 4.5$, and $d^{*} = 2.5$, yielding an adjusted odds ratio\n$\n\\widetilde{\\text{OR}} = \\frac{a^{*} d^{*}}{b^{*} c^{*}} = \\frac{0.5 \\times 2.5}{8.5 \\times 4.5} = \\frac{1.25}{38.25} \\approx 0.03268,\n$\na finite value that reflects the strong apparent protective effect while enabling approximate interval estimation.\n\nNext, consider Fisher’s exact test. Under the null hypothesis of no association between treatment and infection, and conditioning on the fixed margins (total treated $= 8$, total control $= 6$, total infected $= 4$, total not infected $= 10$), the random variable $X$ equal to the number of infected in the treated group follows a hypergeometric distribution. The support of $X$ is $\\{0,1,2,3,4\\}$, and for each $k$,\n$\n\\mathbb{P}(X = k) = \\frac{\\binom{4}{k} \\binom{10}{8 - k}}{\\binom{14}{8}}.\n$\nThe observed value is $x_{\\text{obs}} = 0$. For the one-sided alternative that the treatment is protective (fewer infections among treated), the exact one-sided $p$-value is\n$\np_{\\text{one-sided}} = \\mathbb{P}(X \\le 0) = \\mathbb{P}(X = 0) = \\frac{\\binom{4}{0} \\binom{10}{8}}{\\binom{14}{8}} = \\frac{1 \\cdot 45}{3003} \\approx 0.01498.\n$\nThus, the one-sided exact $p$-value is approximately $0.015$. Importantly, this calculation is valid as stated; Fisher’s exact test does not require any continuity correction or small-sample adjustment to compute $p$-values, even when a cell count is zero, because the test is based on the exact hypergeometric distribution conditioned on the margins.\n\nTwo-sided exact $p$-values in Fisher’s test depend on how “tables as or more extreme than observed” are defined. A common approach sums the probabilities of all tables with hypergeometric probability less than or equal to the observed table’s probability, which in this dataset yields a two-sided $p$$=$$0.01498$ because no other table has a probability less than or equal to $\\mathbb{P}(X=0)$. Another approach doubles the smaller one-sided $p$-value, giving approximately $0.02996$. The key point is that the exact test itself remains well-defined without continuity corrections; small-sample adjustments like adding $0.5$ are principally for estimation of the odds ratio or for asymptotic approximations, not for the exact $p$-value. An additional small-sample technique sometimes used to reduce conservatism is the mid-$p$, which, for a one-sided test, can be defined as $\\mathbb{P}(X  x_{\\text{obs}}) + \\tfrac{1}{2}\\mathbb{P}(X = x_{\\text{obs}})$; this yields a value between the classical exact $p$-value and the nominal level but is not strictly exact in the sense of guaranteed type I error control at or below the nominal level.\n\nOption-by-option analysis:\n\n- Option A: It asserts the MLE is infinite. Here, with $a = 0$ (and $b, c, d > 0$), $\\widehat{\\text{OR}} = 0$, not infinite; infinities arise when $b = 0$ or $c = 0$ (division by zero), or when $a$ or $d$ are positive while the opposing non-event cell is zero. It also incorrectly claims Fisher’s test requires adding $0.5$, which it does not. The fixed statement that the two-sided exact $p$-value is approximately $0.03$ “regardless of definition” is incorrect because two-sided definitions differ. Incorrect.\n\n- Option B: It correctly states that $\\widehat{\\text{OR}} = 0$ for these counts; that Fisher’s exact test is valid without continuity corrections; that the one-sided protective $p$-value is approximately $0.015$; and that adding $0.5$ to each cell (Haldane–Anscombe) yields a finite small-sample odds ratio estimate. Correct.\n\n- Option C: The odds ratio is not equal to the risk ratio in general; they coincide only under special circumstances. Fisher’s exact test is an exact conditional test, not an approximation to a chi-square $p$-value, and this is especially important with small samples or zero cells. Mid-$p$ values are typically smaller (less conservative) than classical exact $p$-values, not larger. Incorrect.\n\n- Option D: Both the odds ratio and Fisher’s exact $p$-value are defined here; dropping a row to analyze a $1 \\times 2$ table discards information and is not standard. Mid-$p$ adjustments are used by some practitioners as a compromise in small samples; they are not “invalid” per se, though they are not strictly exact. Incorrect.\n\n- Option E: While $\\widehat{\\text{OR}} = 0$ is correct, the claim that the two-sided $p$-value is exactly $0.03$ “for any definition” is false; two-sided definitions differ. Adding $1$ only to the zero cell is not a standard bias-reducing small-sample adjustment and does not yield an unbiased odds ratio; the Haldane–Anscombe correction adds $0.5$ to all cells. Incorrect.\n\nTherefore, the option that best captures the correct conclusions is Option B.", "answer": "$$\\boxed{B}$$", "id": "4911992"}, {"introduction": "To truly master a statistical method, it's invaluable to translate its logic into a repeatable process. This final exercise challenges you to move beyond a single calculation and develop a computational algorithm based on the combinatorial principles of Fisher's Exact Test. By thinking in terms of permutations and designing a program to systematically count outcomes, you will solidify your understanding of the test's core mechanism and gain a powerful tool for analyzing any $2 \\times 2$ table with fixed margins. [@problem_id:4912033]", "problem": "You are given a binary outcome recorded for each of $N$ individuals partitioned into two groups of sizes $n_1$ and $n_2$ with $n_1 + n_2 = N$. The total number of outcome $1$ values across all $N$ individuals is fixed at $m_1$. Under the null hypothesis of independence with fixed margins in Fisher's exact test, all allocations of the $m_1$ outcomes across the $N$ individuals are equally likely, and the number of outcomes $1$ observed in group $1$ is a random variable $A$. Your task is to design a permutation algorithm, derived from first principles of combinatorial counting, to compute the exact one-sided right-tail p-value $\\mathbb{P}(A \\ge a_{\\mathrm{obs}})$ by counting the proportion of all allocations that produce $A \\ge a_{\\mathrm{obs}}$.\n\nFundamental base to use:\n- Under the null with fixed margins, every allocation of $m_1$ outcomes $1$ among $N$ labeled individuals is equally likely. The sample space has size equal to the number of ways to choose which $m_1$ of the $N$ individuals receive the outcome $1$.\n- For any fixed integer $a$, the count of allocations in which exactly $a$ of the $n_1$ group-$1$ individuals receive outcome $1$ and the remaining $m_1 - a$ outcomes $1$ are assigned to group $2$ is determined by basic combinatorial counting.\n- The Probability Mass Function (PMF) for $A$ under this model arises directly from these counts.\n\nAlgorithmic goal:\n- Compute the exact one-sided p-value as a ratio of counts in the sample space, without approximation, by summing over all allocations that lead to $A \\ge a_{\\mathrm{obs}}$.\n\nYour program must implement this algorithm and produce results for the following test suite of parameter values. Each tuple is $(n_1,n_2,m_1,N,a_{\\mathrm{obs}})$:\n- Test $1$: $(6,6,7,12,5)$, a standard case (the scenario in the directive).\n- Test $2$: $(6,6,7,12,0)$, a boundary case where $a_{\\mathrm{obs}}$ is the minimum possible value.\n- Test $3$: $(5,5,3,10,6)$, an edge case where $a_{\\mathrm{obs}}$ exceeds the maximum possible value of $A$.\n- Test $4$: $(4,4,0,8,1)$, an extreme case with $m_1 = 0$.\n- Test $5$: $(4,3,7,7,4)$, an extreme case with $m_1 = N$.\n- Test $6$: $(3,9,5,12,2)$, a general case with unequal group sizes.\n\nFor each test, compute the exact right-tail p-value $\\mathbb{P}(A \\ge a_{\\mathrm{obs}})$ and output each p-value as a decimal rounded to $12$ digits after the decimal point. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,\\dots,x_6]$. No physical units or angle units are involved. Percentages must be expressed as decimals, not with a percentage sign.", "solution": "The problem requires the computation of a one-sided right-tail p-value for Fisher's exact test, derived from the first principles of combinatorial counting. The physical setup involves two groups of individuals, with a binary outcome recorded for each. The problem is framed under the null hypothesis of independence between group membership and outcome, with fixed marginal totals.\n\nLet the total number of individuals be $N$, partitioned into two groups of sizes $n_1$ and $n_2$, such that $n_1 + n_2 = N$. The binary outcome can be denoted as '$1$' (success) or '$0$' (failure). The total number of successes across both groups is fixed at $m_1$. Consequently, the total number of failures is $m_2 = N - m_1$. Let $A$ be the random variable representing the number of successes observed in group $1$. The observed value of this variable is denoted as $a_{\\mathrm{obs}}$.\n\nThis setup can be represented by a $2 \\times 2$ contingency table with fixed marginals:\n\n|             | Outcome 1 (Success) | Outcome 0 (Failure) | Total     |\n|-------------|---------------------|---------------------|-----------|\n| **Group 1** |    $A = a$          | $n_1 - a$           |   $n_1$   |\n| **Group 2** |    $m_1 - a$        | $n_2 - (m_1 - a)$   |   $n_2$   |\n| **Total**   |   $m_1$             |   $N - m_1$         |   $N$     |\n\nThe core of the problem is to determine the probability distribution of $A$ under the null hypothesis.\n\n**Step 1: Determine the Size of the Sample Space**\nUnder the null hypothesis with fixed margins, every possible allocation of the $m_1$ successes among the $N$ individuals is equally likely. The total number of such allocations constitutes our sample space. This is a classic combinatorial problem: choosing $m_1$ individuals to have the 'success' outcome from a total population of $N$. The size of the sample space, $\\Omega$, is given by the binomial coefficient:\n$$ |\\Omega| = \\binom{N}{m_1} = \\frac{N!}{m_1!(N-m_1)!} $$\n\n**Step 2: Count Favorable Allocations for a Specific Outcome $A=a$**\nWe need to find the number of allocations where exactly $a$ successes occur in group $1$. For this to happen, we must choose $a$ successes from the $n_1$ individuals in group $1$, and the remaining $m_1 - a$ successes must be chosen from the $n_2$ individuals in group $2$. Using the multiplication principle of counting:\n- The number of ways to choose $a$ successes from group $1$ is $\\binom{n_1}{a}$.\n- The number of ways to choose the remaining $m_1-a$ successes from group $2$ is $\\binom{n_2}{m_1-a}$.\n\nThe total number of allocations corresponding to the event $A=a$, let's call this count $C(a)$, is the product:\n$$ C(a) = \\binom{n_1}{a} \\binom{n_2}{m_1 - a} $$\n\n**Step 3: Define the Probability Mass Function (PMF) of $A$**\nSince all allocations in the sample space are equally likely, the probability of observing exactly $a$ successes in group $1$ is the ratio of the number of favorable allocations to the total number of possible allocations. This defines the Probability Mass Function (PMF) of $A$:\n$$ \\mathbb{P}(A=a) = \\frac{C(a)}{|\\Omega|} = \\frac{\\binom{n_1}{a} \\binom{n_2}{m_1 - a}}{\\binom{N}{m_1}} $$\nThis is the PMF of the hypergeometric distribution. The value of $a$ is constrained by the marginal totals. Specifically, $a$ must satisfy $0 \\le a \\le n_1$, $0 \\le a \\le m_1$, and $0 \\le m_1 - a \\le n_2$. These simplify to $\\max(0, m_1-n_2) \\le a \\le \\min(n_1, m_1)$. The binomial coefficient $\\binom{n}{k}$ is defined to be $0$ if $k0$ or $kn$, which implicitly enforces these constraints.\n\n**Step 4: Formulate the Right-Tail p-value**\nThe one-sided right-tail p-value is the probability of observing a result at least as extreme as the observed value $a_{\\mathrm{obs}}$, assuming the null hypothesis is true. This is calculated by summing the probabilities of all outcomes $k$ where $k \\ge a_{\\mathrm{obs}}$.\n$$ \\mathbb{P}(A \\ge a_{\\mathrm{obs}}) = \\sum_{k=a_{\\mathrm{obs}}}^{k_{\\max}} \\mathbb{P}(A=k) $$\nwhere $k_{\\max}$ is the maximum possible value for $A$, which is $\\min(n_1, m_1)$.\n\nSubstituting the PMF into the summation gives the final expression for the p-value:\n$$ \\mathbb{P}(A \\ge a_{\\mathrm{obs}}) = \\sum_{k=a_{\\mathrm{obs}}}^{\\min(n_1, m_1)} \\frac{\\binom{n_1}{k} \\binom{n_2}{m_1 - k}}{\\binom{N}{m_1}} = \\frac{1}{\\binom{N}{m_1}} \\sum_{k=a_{\\mathrm{obs}}}^{\\min(n_1, m_1)} \\binom{n_1}{k} \\binom{n_2}{m_1 - k} $$\n\n**Step 5: Algorithmic Design**\nThe algorithm to compute this p-value for a given set of parameters $(n_1, n_2, m_1, N, a_{\\mathrm{obs}})$ is as follows:\n1.  Calculate the total number of allocations, which is the denominator: $D = \\binom{N}{m_1}$.\n2.  If $D$ is $0$, the configuration is impossible, and the probability of any event is $0$.\n3.  Initialize a sum for the numerator, $S = 0$.\n4.  Determine the upper limit of the summation, $k_{\\max} = \\min(n_1, m_1)$.\n5.  Iterate with an index $k$ from $a_{\\mathrm{obs}}$ to $k_{\\max}$ (inclusive).\n6.  In each iteration, calculate the term for the number of favorable allocations: $T_k = \\binom{n_1}{k} \\binom{n_2}{m_1 - k}$.\n7.  Add this term to the numerator sum: $S = S + T_k$.\n8.  After the loop completes, the p-value is the ratio $P = S / D$.\n9.  This algorithm will be implemented using a function to compute binomial coefficients, such as `scipy.special.comb`, which correctly handles cases where the upper index is smaller than the lower index by returning $0$.\n10. The final result for each test case will be rounded to $12$ decimal places.\n\nThis approach provides an exact p-value based entirely on combinatorial counting, as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import comb\n\ndef solve():\n    \"\"\"\n    Computes the exact one-sided right-tail p-value for Fisher's exact test\n    for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (n1, n2, m1, N, a_obs)\n    # n1: size of group 1\n    # n2: size of group 2\n    # m1: total number of '1' outcomes (successes)\n    # N: total individuals (N = n1 + n2)\n    # a_obs: observed number of '1' outcomes in group 1\n    test_cases = [\n        (6, 6, 7, 12, 5),  # Test 1: Standard case\n        (6, 6, 7, 12, 0),  # Test 2: Boundary case (a_obs = min possible value)\n        (5, 5, 3, 10, 6),  # Test 3: Edge case (a_obs  max possible value)\n        (4, 4, 0, 8, 1),   # Test 4: Extreme case (m1 = 0)\n        (4, 3, 7, 7, 4),   # Test 5: Extreme case (m1 = N)\n        (3, 9, 5, 12, 2),  # Test 6: General case (unequal groups)\n    ]\n\n    results = []\n    for n1, n2, m1, N, a_obs in test_cases:\n        # Step 1: Calculate the total number of allocations (denominator).\n        # This is the total number of ways to choose m1 individuals from N to have outcome '1'.\n        # Using exact=True to ensure integer arithmetic for precision.\n        denominator = comb(N, m1, exact=True)\n\n        # If the denominator is 0, it indicates an impossible marginal configuration \n        # (e.g., m1  N or m1  0). The probability of any outcome is 0.\n        if denominator == 0:\n            p_value = 0.0\n        else:\n            # Step 2: Sum the counts of favorable allocations for the numerator.\n            # A favorable allocation is one where the count in group 1, k, is = a_obs.\n            numerator_sum = 0\n            \n            # The maximum possible value for the count in group 1 is min(n1, m1).\n            k_max = min(n1, m1)\n\n            # Iterate from the observed count to the maximum possible count.\n            for k in range(a_obs, k_max + 1):\n                # The number of ways to have k successes in group 1 and m1-k in group 2.\n                # comb(n, k) returns 0 if k  n or k  0, which correctly handles the\n                # constraints on the support of the hypergeometric distribution.\n                term = comb(n1, k, exact=True) * comb(n2, m1 - k, exact=True)\n                numerator_sum += term\n            \n            # Step 3: Compute the p-value as the ratio of favorable to total allocations.\n            p_value = numerator_sum / denominator\n\n        results.append(p_value)\n\n    # Format the results to 12 decimal places and print in the required format.\n    formatted_results = [f\"{p:.12f}\" for p in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4912033"}]}