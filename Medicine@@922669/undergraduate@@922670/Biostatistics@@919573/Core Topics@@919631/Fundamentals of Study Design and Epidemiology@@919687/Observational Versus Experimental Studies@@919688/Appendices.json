{"hands_on_practices": [{"introduction": "This exercise moves from a qualitative to a quantitative understanding of confounding, the primary challenge in observational research. By working through a hypothetical study on sodium intake and blood pressure, you will derive a formal bias function. This practice will equip you to analyze how the strength of a confounder's relationship with both the exposure and the outcome determines the magnitude and direction of bias in an observed effect estimate [@problem_id:4933625].", "problem": "An observational cohort study investigates the relationship between high dietary sodium intake and systolic blood pressure. Let the binary exposure be $X \\in \\{0,1\\}$, where $X=1$ indicates high sodium intake and $X=0$ indicates low sodium intake. The continuous outcome is systolic blood pressure, denoted by $Y$, measured in millimeters of mercury (mmHg). Consider an unmeasured confounder $U$ representing habitual physical activity, measured on a continuous scale, which affects both the exposure $X$ and the outcome $Y$.\n\nAssume the data-generating mechanism for the outcome in the source population follows a linear model\n$$\nY \\;=\\; \\beta_{0} \\;+\\; \\beta_{X} X \\;+\\; \\beta_{U} U \\;+\\; \\varepsilon,\n$$\nwhere $\\varepsilon$ satisfies $\\mathbb{E}[\\varepsilon \\mid X, U] = 0$ and has finite variance. The parameter $\\beta_{X}$ is the causal effect of $X$ on $Y$ that would be identified under randomized assignment of $X$ (i.e., no confounding), and $\\beta_{U}$ is the causal effect of $U$ on $Y$.\n\nIn the observational data, the naive difference in mean systolic blood pressure comparing $X=1$ to $X=0$ (ignoring $U$) is observed to be $8.5$ mmHg:\n$$\n\\Delta_{Y}^{\\text{obs}} \\;=\\; \\mathbb{E}[Y \\mid X=1] \\;-\\; \\mathbb{E}[Y \\mid X=0] \\;=\\; 8.5.\n$$\nExternal evidence provides two additional quantities:\n- The confounder-outcome association (per unit change in $U$) is $\\beta_{U} = -0.6$ (mmHg per unit of $U$).\n- The confounder-exposure association, expressed as the difference in mean $U$ between exposed and unexposed groups, is\n$$\n\\Delta_{U} \\;=\\; \\mathbb{E}[U \\mid X=1] \\;-\\; \\mathbb{E}[U \\mid X=0] \\;=\\; -3.0.\n$$\n\nStarting from the stated linear model and the definition of conditional expectations, construct a bias function $B(\\beta_{U}, \\Delta_{U})$ for unmeasured confounding in this setting in terms of the confounder-outcome association $\\beta_{U}$ and the confounder-exposure association $\\Delta_{U}$. Then, use this bias function to quantify the adjusted effect estimate for $\\beta_{X}$ from the observational data. Express the final adjusted effect in mmHg and round your answer to three significant figures.", "solution": "### Solution Derivation\nThe objective is to derive an expression for the bias due to the unmeasured confounder $U$ and then use it to estimate the true causal effect $\\beta_{X}$ from the observed association $\\Delta_{Y}^{\\text{obs}}$.\n\nThe observed association, $\\Delta_{Y}^{\\text{obs}}$, is the difference in the conditional expectation of the outcome $Y$ given the exposure status $X$.\n$$\n\\Delta_{Y}^{\\text{obs}} = \\mathbb{E}[Y \\mid X=1] - \\mathbb{E}[Y \\mid X=0]\n$$\nWe substitute the given linear model for $Y$, which is $Y = \\beta_{0} + \\beta_{X} X + \\beta_{U} U + \\varepsilon$, into the expressions for the conditional expectations.\n\nFor the exposed group ($X=1$):\n$$\n\\mathbb{E}[Y \\mid X=1] = \\mathbb{E}[\\beta_{0} + \\beta_{X} X + \\beta_{U} U + \\varepsilon \\mid X=1]\n$$\nBy linearity of expectation, and substituting $X=1$:\n$$\n\\mathbb{E}[Y \\mid X=1] = \\mathbb{E}[\\beta_{0} \\mid X=1] + \\mathbb{E}[\\beta_{X} \\cdot 1 \\mid X=1] + \\mathbb{E}[\\beta_{U} U \\mid X=1] + \\mathbb{E}[\\varepsilon \\mid X=1]\n$$\nSince $\\beta_{0}$, $\\beta_{X}$, and $\\beta_{U}$ are constants, this simplifies to:\n$$\n\\mathbb{E}[Y \\mid X=1] = \\beta_{0} + \\beta_{X} + \\beta_{U} \\mathbb{E}[U \\mid X=1] + \\mathbb{E}[\\varepsilon \\mid X=1]\n$$\n\nFor the unexposed group ($X=0$):\n$$\n\\mathbb{E}[Y \\mid X=0] = \\mathbb{E}[\\beta_{0} + \\beta_{X} X + \\beta_{U} U + \\varepsilon \\mid X=0]\n$$\nSimilarly, by linearity of expectation and substituting $X=0$:\n$$\n\\mathbb{E}[Y \\mid X=0] = \\beta_{0} + \\beta_{X} \\cdot 0 + \\beta_{U} \\mathbb{E}[U \\mid X=0] + \\mathbb{E}[\\varepsilon \\mid X=0]\n$$\n$$\n\\mathbb{E}[Y \\mid X=0] = \\beta_{0} + \\beta_{U} \\mathbb{E}[U \\mid X=0] + \\mathbb{E}[\\varepsilon \\mid X=0]\n$$\n\nThe problem states that $\\mathbb{E}[\\varepsilon \\mid X, U] = 0$. By the law of iterated expectations, we have $\\mathbb{E}[\\varepsilon \\mid X] = \\mathbb{E}[\\mathbb{E}[\\varepsilon \\mid X, U] \\mid X] = \\mathbb{E}[0 \\mid X] = 0$. This implies that $\\mathbb{E}[\\varepsilon \\mid X=1] = 0$ and $\\mathbb{E}[\\varepsilon \\mid X=0] = 0$.\n\nSubstituting these results back into the conditional expectation expressions:\n$$\n\\mathbb{E}[Y \\mid X=1] = \\beta_{0} + \\beta_{X} + \\beta_{U} \\mathbb{E}[U \\mid X=1]\n$$\n$$\n\\mathbb{E}[Y \\mid X=0] = \\beta_{0} + \\beta_{U} \\mathbb{E}[U \\mid X=0]\n$$\n\nNow, we compute the difference to find $\\Delta_{Y}^{\\text{obs}}$:\n$$\n\\Delta_{Y}^{\\text{obs}} = (\\beta_{0} + \\beta_{X} + \\beta_{U} \\mathbb{E}[U \\mid X=1]) - (\\beta_{0} + \\beta_{U} \\mathbb{E}[U \\mid X=0])\n$$\n$$\n\\Delta_{Y}^{\\text{obs}} = \\beta_{X} + \\beta_{U} \\mathbb{E}[U \\mid X=1] - \\beta_{U} \\mathbb{E}[U \\mid X=0]\n$$\n$$\n\\Delta_{Y}^{\\text{obs}} = \\beta_{X} + \\beta_{U} (\\mathbb{E}[U \\mid X=1] - \\mathbb{E}[U \\mid X=0])\n$$\nThe term $(\\mathbb{E}[U \\mid X=1] - \\mathbb{E}[U \\mid X=0])$ is given as the confounder-exposure association, $\\Delta_{U}$.\n$$\n\\Delta_{Y}^{\\text{obs}} = \\beta_{X} + \\beta_{U} \\Delta_{U}\n$$\nThe bias, $B$, is defined as the difference between the observed association and the true causal effect, $B = \\Delta_{Y}^{\\text{obs}} - \\beta_{X}$. From the equation above, we find the bias function:\n$$\nB(\\beta_{U}, \\Delta_{U}) = \\beta_{U} \\Delta_{U}\n$$\nThis function demonstrates that the bias is the product of the confounder-outcome association ($\\beta_{U}$) and the confounder-exposure association ($\\Delta_{U}$).\n\nTo find the adjusted effect estimate for $\\beta_{X}$, we rearrange the equation:\n$$\n\\beta_{X} = \\Delta_{Y}^{\\text{obs}} - \\beta_{U} \\Delta_{U}\n$$\nNow, we substitute the numerical values provided in the problem:\n- $\\Delta_{Y}^{\\text{obs}} = 8.5$\n- $\\beta_{U} = -0.6$\n- $\\Delta_{U} = -3.0$\n\nFirst, calculate the bias term:\n$$\nB = \\beta_{U} \\Delta_{U} = (-0.6) \\times (-3.0) = 1.8\n$$\nThe bias due to confounding by physical activity is $1.8$ mmHg. This positive bias inflates the observed association.\n\nNext, calculate the adjusted effect $\\beta_{X}$:\n$$\n\\beta_{X} = 8.5 - 1.8 = 6.7\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\beta_{X} = 6.70\n$$\nThe adjusted causal effect of high sodium intake on systolic blood pressure is $6.70$ mmHg.", "answer": "$$\n\\boxed{6.70}\n$$", "id": "4933625"}, {"introduction": "While adjusting for confounders is crucial, adjusting for the wrong variable can create bias where none existed. This exercise introduces the concept of collider bias through a simple, non-parametric thought experiment known as an \"M-structure\" [@problem_id:4933650]. By calculating the spurious association that arises from conditioning on a common effect (a collider), you will learn a critical lesson about the importance of using causal diagrams to guide analytical decisions.", "problem": "An investigator is studying the causal effect of a binary exposure $X$ on a binary outcome $Y$ in an observational study. Consider the following nonparametric structural causal model encoded by a Directed Acyclic Graph (DAG), with two independent, unobserved causes $U$ and $V$ that jointly create an $M$-structure but no direct causal effect of $X$ on $Y$:\n- $U \\sim \\text{Bernoulli}(0.5)$ and $V \\sim \\text{Bernoulli}(0.5)$ are independent.\n- $X$ is determined by $U$ via $X := U$.\n- $Y$ is determined by $V$ via $Y := V$.\n- $Z$ is a collider determined nonparametrically by the logical OR of $U$ and $V$ via $Z := \\mathbf{1}\\{U=1 \\text{ or } V=1\\}$, where $\\mathbf{1}\\{\\cdot\\}$ denotes the indicator function.\n\nThus, the DAG has arrows $U \\rightarrow X$, $U \\rightarrow Z$, $V \\rightarrow Y$, and $V \\rightarrow Z$, and no arrow $X \\rightarrow Y$. The Average Causal Effect (ACE) on the risk difference scale is defined as $\\Delta_{\\text{causal}} := \\mathbb{E}[Y \\mid \\text{do}(X=1)] - \\mathbb{E}[Y \\mid \\text{do}(X=0)]$.\n\nIn the observational study, the investigator restricts the analysis to the stratum with $Z=1$ (conditioning on the collider $Z$) and computes the naive difference in conditional risks\n$$\n\\Delta_{\\text{obs}} := \\mathbb{E}[Y \\mid X=1, Z=1] - \\mathbb{E}[Y \\mid X=0, Z=1].\n$$\n\nUsing only fundamental probability rules, independence, and the definitions above, compute the signed bias induced by conditioning on the nonconfounder collider $Z$,\n$$\nB := \\Delta_{\\text{obs}} - \\Delta_{\\text{causal}}.\n$$\nReport the exact value of $B$ as a single real number. No rounding is required, and no units are involved.", "solution": "The objective is to compute the bias, $B$, defined as the difference between the observed association, $\\Delta_{\\text{obs}}$, and the true Average Causal Effect (ACE), $\\Delta_{\\text{causal}}$. The bias is given by the expression $B := \\Delta_{\\text{obs}} - \\Delta_{\\text{causal}}$. We will compute $\\Delta_{\\text{causal}}$ and $\\Delta_{\\text{obs}}$ separately.\n\nFirst, we compute the true Average Causal Effect, $\\Delta_{\\text{causal}}$.\nThe ACE is defined on the risk difference scale as $\\Delta_{\\text{causal}} := \\mathbb{E}[Y \\mid \\text{do}(X=1)] - \\mathbb{E}[Y \\mid \\text{do}(X=0)]$.\nThe `do` operator, $\\text{do}(X=x)$, represents a hypothetical intervention where we force the variable $X$ to take the value $x$, regardless of its usual causes. In the context of the given structural causal model, the intervention $\\text{do}(X=x)$ severs the causal arrow from $U$ to $X$ (i.e., removes the equation $X:=U$) and replaces it with $X:=x$.\nThe structural equation for the outcome $Y$ is $Y := V$. The variable $V$ is specified to be independent of $U$, which is the cause of $X$ in the observational setting. An intervention on $X$ does not affect the distribution of $V$, as there is no causal path from $X$ to $V$ or from $X$ to $Y$.\nTherefore, the expectation of $Y$ under an intervention on $X$ is simply the unconditional expectation of $V$.\nFor the intervention $\\text{do}(X=1)$:\n$$\n\\mathbb{E}[Y \\mid \\text{do}(X=1)] = \\mathbb{E}[V]\n$$\nFor the intervention $\\text{do}(X=0)$:\n$$\n\\mathbb{E}[Y \\mid \\text{do}(X=0)] = \\mathbb{E}[V]\n$$\nWe are given that $V \\sim \\text{Bernoulli}(0.5)$. The expectation of a Bernoulli-distributed variable with parameter $p$ is $p$. Thus, $\\mathbb{E}[V] = 0.5$.\nSubstituting this into the definition of $\\Delta_{\\text{causal}}$:\n$$\n\\Delta_{\\text{causal}} = \\mathbb{E}[V] - \\mathbb{E}[V] = 0.5 - 0.5 = 0\n$$\nThe true causal effect is $0$, which is consistent with the absence of a direct arrow from $X$ to $Y$ in the Directed Acyclic Graph (DAG).\n\nNext, we compute the observed association, $\\Delta_{\\text{obs}}$, within the stratum $Z=1$.\nThis is defined as $\\Delta_{\\text{obs}} := \\mathbb{E}[Y \\mid X=1, Z=1] - \\mathbb{E}[Y \\mid X=0, Z=1]$.\nSince $Y$ is a binary variable, its conditional expectation is equal to its conditional probability, i.e., $\\mathbb{E}[Y \\mid \\mathcal{C}] = P(Y=1 \\mid \\mathcal{C})$ for any condition $\\mathcal{C}$.\nSo, we need to compute $P(Y=1 \\mid X=1, Z=1)$ and $P(Y=1 \\mid X=0, Z=1)$.\n\nLet's evaluate the first term, $\\mathbb{E}[Y \\mid X=1, Z=1] = P(Y=1 \\mid X=1, Z=1)$.\nWe translate the conditioning event $(X=1, Z=1)$ into statements about the underlying latent variables $U$ and $V$.\nThe structural equations are $X:=U$, $Y:=V$, and $Z := \\mathbf{1}\\{U=1 \\text{ or } V=1\\}$.\nThe condition $X=1$ implies $U=1$.\nThe condition $Z=1$ implies $(U=1 \\text{ or } V=1)$.\nThe combined condition $(X=1, Z=1)$ is equivalent to $(U=1 \\text{ and } (U=1 \\text{ or } V=1))$. Since the first part of the conjunction is $U=1$, the second part $(U=1 \\text{ or } V=1)$ is automatically satisfied. Thus, the condition $(X=1, Z=1)$ is equivalent to the simpler condition $U=1$.\nTherefore:\n$$\n\\mathbb{E}[Y \\mid X=1, Z=1] = P(Y=1 \\mid U=1)\n$$\nSince $Y=V$, this is equivalent to $P(V=1 \\mid U=1)$. The problem states that $U$ and $V$ are independent variables. Thus, conditioning on $U$ does not change the probability distribution of $V$:\n$$\nP(V=1 \\mid U=1) = P(V=1) = 0.5\n$$\nSo, the first term is $\\mathbb{E}[Y \\mid X=1, Z=1] = 0.5$.\n\nNow, let's evaluate the second term, $\\mathbb{E}[Y \\mid X=0, Z=1] = P(Y=1 \\mid X=0, Z=1)$.\nWe again translate the conditioning event $(X=0, Z=1)$ into statements about $U$ and $V$.\nThe condition $X=0$ implies $U=0$.\nThe condition $Z=1$ implies $(U=1 \\text{ or } V=1)$.\nThe combined condition $(X=0, Z=1)$ is equivalent to $(U=0 \\text{ and } (U=1 \\text{ or } V=1))$. Substituting $U=0$ into the second part gives $(U=0 \\text{ and } (0=1 \\text{ or } V=1))$, which simplifies to $(U=0 \\text{ and } V=1)$.\nSo, the conditioning event $(X=0, Z=1)$ provides full information about the values of both $U$ and $V$; specifically, it implies that $U=0$ and $V=1$.\nWe are computing the expectation of $Y$ given this information. Since $Y=V$, and we know $V=1$:\n$$\n\\mathbb{E}[Y \\mid X=0, Z=1] = \\mathbb{E}[Y \\mid U=0, V=1] = \\mathbb{E}[V \\mid U=0, V=1]\n$$\nGiven that $V=1$, the expectation of $Y=V$ is simply $1$:\n$$\n\\mathbb{E}[Y \\mid X=0, Z=1] = 1\n$$\nThis result illustrates collider bias: conditioning on the common effect $Z=1$ creates a dependency between its causes $U$ and $V$ (and thus between their proxies $X$ and $Y$). In this case, learning $X=0$ (and thus $U=0$) within the $Z=1$ stratum provides information that $V$ must be $1$.\n\nNow we can compute $\\Delta_{\\text{obs}}$:\n$$\n\\Delta_{\\text{obs}} = \\mathbb{E}[Y \\mid X=1, Z=1] - \\mathbb{E}[Y \\mid X=0, Z=1] = 0.5 - 1 = -0.5\n$$\n\nFinally, we compute the bias, $B$:\n$$\nB = \\Delta_{\\text{obs}} - \\Delta_{\\text{causal}} = -0.5 - 0 = -0.5\n$$\nThe bias induced by conditioning on the collider $Z$ is $-0.5$. This non-zero bias creates a spurious association between $X$ and $Y$ when the analysis is restricted to the stratum $Z=1$, even though there is no causal relationship.", "answer": "$$\n\\boxed{-0.5}\n$$", "id": "4933650"}, {"introduction": "Randomized controlled trials (RCTs) provide strong evidence for causal effects, but are their findings applicable to everyone? This practice tackles the problem of \"transportability,\" or generalizability, from an RCT to a different target population [@problem_id:4933661]. You will quantify the bias that arises when a treatment's effect varies across subgroups (effect modification) and the prevalence of these subgroups differs between the trial and the target population, and then develop a reweighting scheme to correct it.", "problem": "A randomized controlled trial (RCT) evaluates a binary treatment $A \\in \\{0,1\\}$ on an outcome $Y$ under the potential outcomes framework with $Y(1)$ and $Y(0)$. Let $Z \\in \\{0,1\\}$ be a baseline covariate measured prior to treatment. Assume the following:\n- The average treatment effect (ATE) in any population is defined as $E[Y(1) - Y(0)]$.\n- Randomization in the RCT implies $A \\perp \\{Y(1),Y(0)\\} \\mid Z, S$, where $S \\in \\{0,1\\}$ indicates membership in the RCT ($S=1$) versus the target population ($S=0$).\n- Consistency and positivity hold, so that $E[Y(1) - Y(0) \\mid Z=z, S=1] = \\Delta(z)$ generalizes to the target population for each $z \\in \\{0,1\\}$.\n\nSuppose the RCT has estimated stratum-specific treatment effects $\\Delta(0) = 1$ and $\\Delta(1) = 3$. The distribution of $Z$ differs between the RCT and the target population: in the RCT, $P(Z=1 \\mid S=1) = 0.2$ (so $P(Z=0 \\mid S=1) = 0.8$), while in the target population, $P(Z=1 \\mid S=0) = 0.6$ (so $P(Z=0 \\mid S=0) = 0.4$).\n\nStarting from the definitions above and the law of total expectation, derive the bias that results from naively transporting the unweighted RCT ATE to the target population when there is effect modification by $Z$ and the distribution of $Z$ differs between the two populations. Then, propose a reweighting scheme based on first principles that corrects this bias by appropriately mapping the RCT covariate distribution to the target covariate distribution, and compute the corrected target population ATE using the given numbers. Report the corrected target ATE as a single real number. No rounding is required.", "solution": "We begin with the potential outcomes framework. The average treatment effect (ATE) in a population identified by selection indicator $S \\in \\{0,1\\}$ is\n$$\n\\text{ATE}(S) = E[Y(1) - Y(0) \\mid S].\n$$\nBy the law of total expectation,\n$$\n\\text{ATE}(S) = E\\big(E[Y(1) - Y(0) \\mid Z, S] \\mid S\\big).\n$$\nUnder randomization, consistency, and positivity, the conditional effect $E[Y(1) - Y(0) \\mid Z=z, S=1]$ is identified in the RCT and equals a structural effect $\\Delta(z)$ that does not depend on $S$. Therefore,\n$$\n\\text{ATE}(S) = E[\\Delta(Z) \\mid S] = \\sum_{z \\in \\{0,1\\}} \\Delta(z) \\, P(Z=z \\mid S).\n$$\n\nThe naive transport that uses the unweighted RCT ATE for the target population implicitly assumes that $P(Z \\mid S=1) = P(Z \\mid S=0)$ or $\\Delta(Z)$ is constant in $Z$. When effect modification is present and the $Z$ distribution differs, the bias of the naive approach is\n$$\n\\text{Bias} = \\text{ATE}(S=1) - \\text{ATE}(S=0)\n= \\sum_{z \\in \\{0,1\\}} \\Delta(z) \\left\\{ P(Z=z \\mid S=1) - P(Z=z \\mid S=0) \\right\\}.\n$$\n\nWith the provided values $\\Delta(0) = 1$, $\\Delta(1) = 3$, $P(Z=1 \\mid S=1) = 0.2$, $P(Z=0 \\mid S=1) = 0.8$, $P(Z=1 \\mid S=0) = 0.6$, and $P(Z=0 \\mid S=0) = 0.4$, we compute\n$$\n\\text{ATE}(S=1) = \\Delta(0) \\, P(Z=0 \\mid S=1) + \\Delta(1) \\, P(Z=1 \\mid S=1)\n= 1 \\cdot 0.8 + 3 \\cdot 0.2 = 0.8 + 0.6 = 1.4,\n$$\nand\n$$\n\\text{ATE}(S=0) = \\Delta(0) \\, P(Z=0 \\mid S=0) + \\Delta(1) \\, P(Z=1 \\mid S=0)\n= 1 \\cdot 0.4 + 3 \\cdot 0.6 = 0.4 + 1.8 = 2.2.\n$$\nThus the bias is\n$$\n\\text{Bias} = 1.4 - 2.2 = -0.8.\n$$\n\nTo correct this bias by reweighting, we seek weights $w(Z)$ such that, for any function $g(Z)$,\n$$\nE\\big[g(Z) \\mid S=0\\big] = E\\big[w(Z) \\, g(Z) \\mid S=1\\big].\n$$\nBy a change of measure (importance sampling), a sufficient choice is\n$$\nw(z) = \\frac{P(Z=z \\mid S=0)}{P(Z=z \\mid S=1)},\n$$\nwhich satisfies\n$$\nE\\big[w(Z) \\mid S=1\\big] = \\sum_{z} \\frac{P(Z=z \\mid S=0)}{P(Z=z \\mid S=1)} P(Z=z \\mid S=1) = \\sum_{z} P(Z=z \\mid S=0) = 1,\n$$\nand\n$$\nE\\big[w(Z) \\, g(Z) \\mid S=1\\big] = \\sum_{z} g(z) \\frac{P(Z=z \\mid S=0)}{P(Z=z \\mid S=1)} P(Z=z \\mid S=1) = \\sum_{z} g(z) P(Z=z \\mid S=0) = E\\big[g(Z) \\mid S=0\\big].\n$$\nApplying this to $g(Z) = \\Delta(Z)$ yields a reweighted RCT estimator of the target ATE:\n$$\n\\text{ATE}_{\\text{reweighted}} = E\\big[w(Z) \\, \\Delta(Z) \\mid S=1\\big].\n$$\n\nCompute the weights:\n$$\nw(0) = \\frac{P(Z=0 \\mid S=0)}{P(Z=0 \\mid S=1)} = \\frac{0.4}{0.8} = 0.5, \\quad\nw(1) = \\frac{P(Z=1 \\mid S=0)}{P(Z=1 \\mid S=1)} = \\frac{0.6}{0.2} = 3.\n$$\nThen\n$$\n\\text{ATE}_{\\text{reweighted}} =\n\\sum_{z} \\Delta(z) \\, w(z) \\, P(Z=z \\mid S=1)\n= \\Delta(0) \\, w(0) \\, P(Z=0 \\mid S=1) + \\Delta(1) \\, w(1) \\, P(Z=1 \\mid S=1).\n$$\nSubstituting the given values,\n$$\n\\text{ATE}_{\\text{reweighted}} = 1 \\cdot 0.5 \\cdot 0.8 + 3 \\cdot 3 \\cdot 0.2 = 0.4 + 1.8 = 2.2.\n$$\nThis equals the true target ATE computed directly, confirming that the reweighting correction maps the RCT covariate distribution to that of the target population and removes the bias under the stated assumptions. The requested final numerical answer is the corrected target ATE, which is $2.2$.", "answer": "$$\\boxed{2.2}$$", "id": "4933661"}]}