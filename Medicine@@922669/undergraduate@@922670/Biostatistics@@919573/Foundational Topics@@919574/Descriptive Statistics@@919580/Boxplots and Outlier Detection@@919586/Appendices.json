{"hands_on_practices": [{"introduction": "Real-world data, particularly in biology, often come in the form of counts that don't fit the symmetric, bell-shaped distributions assumed by many basic statistical methods. This exercise tackles that challenge head-on by exploring bacterial colony counts, a classic example of data that can be approximated by a Poisson model. You will first derive and apply a variance-stabilizing transformation, a crucial preprocessing step, before constructing a boxplot and identifying potential outliers, learning not to apply statistical tools blindly but to adapt them to the nature of the data. [@problem_id:4898851]", "problem": "A laboratory quantifies colony-forming units per plate from replicate cultures of a bacterial strain under identical growth conditions. The observed counts (per plate) are: $0$, $1$, $2$, $3$, $4$, $5$, $6$, $9$, $12$, $16$, $20$, $27$, $40$, $100$. In exploratory biostatistical analysis, boxplots are routinely used for outlier detection, but for count data the spread often increases with the mean. Using only foundational properties of count data that are well-approximated by a Poisson model, first derive an appropriate variance-stabilizing monotone transformation $g(y)$ that is suitable for large counts. Then, apply this transformation to the given data, construct a boxplot on the transformed scale using the following definitions: the first quartile $Q_{1}$ and the third quartile $Q_{3}$ are the medians of the lower and upper halves, respectively, of the sorted transformed sample; for an even sample size $n$, the lower half consists of the first $n/2$ observations and the upper half of the last $n/2$ observations, and the sample median is the average of the $n/2$-th and $(n/2+1)$-th observations. Define the Interquartile Range (IQR) as $Q_{3}-Q_{1}$, and define the upper outlier fence as $Q_{3}+1.5 \\times \\mathrm{IQR}$. Back-transform this upper fence to the original count scale and report how many of the original observations exceed this back-transformed threshold. Give your final answer as a single integer with no units; rounding is not required.", "solution": "The problem is to identify outliers in a given dataset of bacterial colony counts using a boxplot analysis on a variance-stabilized scale. The process involves four main steps: deriving the appropriate transformation, applying it to the data, calculating the outlier fence on the transformed scale, and then back-transforming this fence to identify outliers in the original data.\n\n### Step 1: Problem Validation\n\n**1. Extraction of Givens:**\n- Data (colony counts, $y$): $0$, $1$, $2$, $3$, $4$, $5$, $6$, $9$, $12$, $16$, $20$, $27$, $40$, $100$.\n- Sample Size: $n=14$.\n- Model Assumption: The count data is well-approximated by a Poisson model for large counts.\n- Task 1: Derive a variance-stabilizing monotone transformation $g(y)$.\n- Boxplot Definitions for even $n$:\n    - The sample is sorted.\n    - The lower half consists of the first $n/2$ observations.\n    - The upper half consists of the last $n/2$ observations.\n    - First Quartile ($Q_1$): Median of the lower half.\n    - Third Quartile ($Q_3$): Median of the upper half.\n- Outlier Definition:\n    - Interquartile Range (IQR): $\\mathrm{IQR} = Q_3 - Q_1$.\n    - Upper Outlier Fence: $Q_3 + 1.5 \\times \\mathrm{IQR}$.\n    - An observation is an outlier if it exceeds the back-transformed upper fence.\n\n**2. Validation using Extracted Givens:**\n- **Scientific Grounding:** The problem is firmly rooted in biostatistics. The use of a Poisson model for count data, variance-stabilizing transformations (specifically the square root transformation for Poisson data), and boxplot analysis for outlier detection are standard and scientifically sound methods.\n- **Well-Posedness:** The problem provides a specific dataset and a completely defined, step-by-step procedure for calculation. The definitions for quartiles and outlier fences are explicit and unambiguous, ensuring a unique solution can be determined.\n- **Objectivity:** The problem is stated in objective, mathematical language with no subjective or vague terminology.\n\n**3. Verdict:**\nThe problem is valid. It is scientifically sound, well-posed, and objective. I will now proceed with the solution.\n\n### Step 2: Derivation of the Variance-Stabilizing Transformation\n\nFor a random variable $Y$ that follows a Poisson distribution with mean $\\lambda$, a fundamental property is that its mean equals its variance:\n$$E[Y] = \\lambda$$\n$$\\mathrm{Var}(Y) = \\lambda$$\nThe goal is to find a transformation $g(Y)$ such that its variance is approximately constant, regardless of the mean $\\lambda$. We use a first-order Taylor series expansion (the Delta method) to approximate the variance of $g(Y)$:\n$$\\mathrm{Var}(g(Y)) \\approx [g'(E[Y])]^2 \\mathrm{Var}(Y)$$\nSubstituting the properties of the Poisson distribution ($E[Y]=\\lambda$ and $\\mathrm{Var}(Y)=\\lambda$):\n$$\\mathrm{Var}(g(Y)) \\approx [g'(\\lambda)]^2 \\lambda$$\nTo stabilize the variance, we require the right-hand side to be a constant, say $c^2$:\n$$[g'(\\lambda)]^2 \\lambda = c^2$$\nSolving for $g'(\\lambda)$:\n$$g'(\\lambda) = \\frac{c}{\\sqrt{\\lambda}} = c\\lambda^{-1/2}$$\nTo find the function $g(\\lambda)$, we integrate $g'(\\lambda)$ with respect to $\\lambda$:\n$$g(\\lambda) = \\int c\\lambda^{-1/2} d\\lambda = c \\frac{\\lambda^{1/2}}{1/2} + K = 2c\\sqrt{\\lambda} + K$$\nwhere $K$ is the constant of integration. The stabilizing property is independent of the constants $c$ and $K$. For simplicity, we can choose $2c=1$ and $K=0$. This gives the transformation:\n$$g(y) = \\sqrt{y}$$\nThis is the square root transformation, a standard variance-stabilizing transformation for Poisson-distributed data.\n\n### Step 3: Application to Data and Boxplot Construction\n\nThe original data are: $y = \\{0, 1, 2, 3, 4, 5, 6, 9, 12, 16, 20, 27, 40, 100\\}$.\nThe sample size is $n=14$, which is even.\nWe apply the transformation $g(y) = \\sqrt{y}$ to each data point. The transformed data, sorted, are:\n$$x = \\{\\sqrt{0}, \\sqrt{1}, \\sqrt{2}, \\sqrt{3}, \\sqrt{4}, \\sqrt{5}, \\sqrt{6}, \\sqrt{9}, \\sqrt{12}, \\sqrt{16}, \\sqrt{20}, \\sqrt{27}, \\sqrt{40}, \\sqrt{100}\\}$$\n$$x = \\{0, 1, \\sqrt{2}, \\sqrt{3}, 2, \\sqrt{5}, \\sqrt{6}, 3, \\sqrt{12}, 4, \\sqrt{20}, \\sqrt{27}, \\sqrt{40}, 10\\}$$\nAccording to the problem's definition for an even sample size $n=14$, the lower half consists of the first $n/2 = 7$ observations, and the upper half consists of the last $n/2 = 7$ observations.\n\nLower half: $\\{0, 1, \\sqrt{2}, \\sqrt{3}, 2, \\sqrt{5}, \\sqrt{6}\\}$\nUpper half: $\\{3, \\sqrt{12}, 4, \\sqrt{20}, \\sqrt{27}, \\sqrt{40}, 10\\}$\n\nThe first quartile, $Q_1$, is the median of the lower half. Since the lower half has $7$ (an odd number) observations, its median is the middle value, which is the $4$-th observation.\n$$Q_1 = \\sqrt{3}$$\nThe third quartile, $Q_3$, is the median of the upper half. The upper half also has $7$ observations, so its median is the middle value, which is the $4$-th observation of this subset.\n$$Q_3 = \\sqrt{20}$$\nWe can simplify $\\sqrt{20} = \\sqrt{4 \\times 5} = 2\\sqrt{5}$.\nSo, $Q_3 = 2\\sqrt{5}$.\n\n### Step 4: Outlier Detection\n\nFirst, we calculate the Interquartile Range (IQR) on the transformed scale:\n$$\\mathrm{IQR} = Q_3 - Q_1 = 2\\sqrt{5} - \\sqrt{3}$$\nNext, we calculate the upper outlier fence on the transformed scale. The formula is $Q_3 + 1.5 \\times \\mathrm{IQR}$.\n$$\\text{Upper Fence}_{\\text{transf}} = Q_3 + 1.5 \\times \\mathrm{IQR} = 2\\sqrt{5} + 1.5(2\\sqrt{5} - \\sqrt{3})$$\n$$\\text{Upper Fence}_{\\text{transf}} = 2\\sqrt{5} + 3\\sqrt{5} - 1.5\\sqrt{3} = 5\\sqrt{5} - 1.5\\sqrt{3}$$\nTo compare this fence with the original data, we must back-transform it to the original count scale. The back-transformation is $y = (g(y))^2$.\n$$\\text{Upper Fence}_{\\text{orig}} = (\\text{Upper Fence}_{\\text{transf}})^2 = (5\\sqrt{5} - 1.5\\sqrt{3})^2$$\nExpanding this expression:\n$$\\text{Upper Fence}_{\\text{orig}} = (5\\sqrt{5})^2 - 2(5\\sqrt{5})(1.5\\sqrt{3}) + (1.5\\sqrt{3})^2$$\n$$\\text{Upper Fence}_{\\text{orig}} = (25 \\times 5) - (15\\sqrt{15}) + (2.25 \\times 3)$$\n$$\\text{Upper Fence}_{\\text{orig}} = 125 - 15\\sqrt{15} + 6.75$$\n$$\\text{Upper Fence}_{\\text{orig}} = 131.75 - 15\\sqrt{15}$$\nTo make a comparison, we approximate the value. We know that $3.8^2 = 14.44$ and $3.9^2 = 15.21$, so $\\sqrt{15}$ is approximately $3.87$.\n$$\\text{Upper Fence}_{\\text{orig}} \\approx 131.75 - 15(3.873) = 131.75 - 58.095 = 73.655$$\nThe final step is to count how many of the original observations exceed this back-transformed threshold. The original data are:\n$$y = \\{0, 1, 2, 3, 4, 5, 6, 9, 12, 16, 20, 27, 40, 100\\}$$\nWe check each value against the threshold of approximately $73.655$.\n- The largest value before the last is $40$, which is less than $73.655$.\n- The last value is $100$, which is greater than $73.655$.\n\nOnly one observation, $100$, exceeds the upper outlier fence. Therefore, there is $1$ outlier according to this method.", "answer": "$$\\boxed{1}$$", "id": "4898851"}, {"introduction": "The $1.5 \\times \\mathrm{IQR}$ rule is a foundational tool for outlier detection, prized for its robustness compared to methods based on the mean and standard deviation. But how robust is it really? This practice challenges you to quantify its resilience by pitting it against an even more robust method based on the Median Absolute Deviation (MAD). By calculating how each rule's outlier cutoff shifts in response to a single, extreme measurement error, you will gain a tangible and quantitative understanding of what \"robustness\" means and why it is a critical concept in biostatistical analysis. [@problem_id:4798471]", "problem": "A cardiology service evaluates high-sensitivity cardiac troponin I (hs-cTnI) values to identify outliers using graphical summaries. A histogram of hs-cTnI values from a single on-call period appears unimodal with a right-skew typical of acute care presentations. The box plot uses Tukey’s hinges for quartiles, and a scatter plot of repeated draws identifies one manifestly extreme erroneous measurement attributed to a laboratory instrument fault. To formalize how graphical rules respond to this single extreme error, consider the following.\n\nStart from the core definitions: the Interquartile Range (IQR) is defined as $Q_{3}-Q_{1}$, where $Q_{1}$ and $Q_{3}$ are the first and third quartiles computed by Tukey’s hinge method (split the ordered sample at the median; for an odd-sized sample, compute $Q_{1}$ from the lower half and $Q_{3}$ from the upper half; for an even-sized sample, $Q_{1}$ is the median of the lower half and $Q_{3}$ is the median of the upper half). The classical box-plot upper fence is $Q_{3}+1.5\\times \\mathrm{IQR}$. The Median Absolute Deviation (MAD) is defined as the median of $\\{|x_{i}-m|\\}$, where $m$ is the sample median. A robust, distribution-calibrated MAD rule for high outliers is given by $m+c\\times \\mathrm{MAD}$, with $c$ chosen to match the upper fence of the $1.5\\times \\mathrm{IQR}$ rule under a normal reference model.\n\nYou are given a baseline ordered sample of hs-cTnI values in $\\mathrm{ng/L}$:\n$5,\\ 8,\\ 10,\\ 12,\\ 15,\\ 18,\\ 22,\\ 30,\\ 45$.\nAfter a single laboratory error, the extreme erroneous value $50{,}000$ is appended, producing the ordered sample:\n$5,\\ 8,\\ 10,\\ 12,\\ 15,\\ 18,\\ 22,\\ 30,\\ 45,\\ 50{,}000$.\n\nUsing only the definitions above and the normal-reference equivalence between the $1.5\\times \\mathrm{IQR}$ fence and a MAD-based cutoff, proceed as follows:\n\n- Derive the constant $c$ such that, for a normal distribution with standard deviation $\\sigma$, the upper cutoff $m+c\\times \\mathrm{MAD}$ aligns with $Q_{3}+1.5\\times \\mathrm{IQR}$.\n- Compute, for the baseline sample and for the sample with the single extreme error, the upper cutoff under the $1.5\\times \\mathrm{IQR}$ rule and under the MAD-based rule with your derived $c$.\n- Quantify the response of each rule to the single extreme error by calculating the increase in the upper cutoff from baseline to post-error under each rule.\n- Finally, compute the ratio of these increases (increase under the $1.5\\times \\mathrm{IQR}$ rule divided by increase under the MAD-based rule).\n\nExpress the final ratio as a decimal without units and round your answer to four significant figures.", "solution": "The problem requires the validation of two outlier detection rules, one based on the Interquartile Range (IQR) and the other on the Median Absolute Deviation (MAD), by analyzing their response to a single extreme outlier. The process involves four main steps: deriving the calibration constant $c$ for the MAD-based rule, calculating the outlier cutoffs for a baseline sample and an error-containing sample, determining the increase in these cutoffs due to the error, and finally computing the ratio of these increases.\n\n### Step 1: Derivation of the Calibration Constant $c$\n\nThe constant $c$ is determined by equating the upper outlier cutoff from the $1.5 \\times \\mathrm{IQR}$ rule with the MAD-based rule, $m + c \\times \\mathrm{MAD}$, for a general normal distribution, $X \\sim N(\\mu, \\sigma^2)$.\n\nFor a normal distribution, the median $m$ is equal to the mean $\\mu$. Let $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution $Z \\sim N(0, 1)$.\n\nThe first quartile ($Q_1$) and third quartile ($Q_3$) correspond to the $25^{th}$ and $75^{th}$ percentiles, respectively.\nFor a normal distribution $N(\\mu, \\sigma^2)$:\n$Q_1 = \\mu + \\sigma \\Phi^{-1}(0.25)$\n$Q_3 = \\mu + \\sigma \\Phi^{-1}(0.75)$\nDue to the symmetry of the normal distribution, $\\Phi^{-1}(0.25) = -\\Phi^{-1}(0.75)$.\nThe Interquartile Range (IQR) is:\n$\\mathrm{IQR} = Q_3 - Q_1 = (\\mu + \\sigma \\Phi^{-1}(0.75)) - (\\mu - \\sigma \\Phi^{-1}(0.75)) = 2 \\sigma \\Phi^{-1}(0.75)$.\n\nThe classical box-plot upper fence is defined as $Q_3 + 1.5 \\times \\mathrm{IQR}$. Substituting the expressions for $Q_3$ and $\\mathrm{IQR}$:\nUpper Fence $= (\\mu + \\sigma \\Phi^{-1}(0.75)) + 1.5 \\times (2 \\sigma \\Phi^{-1}(0.75))$\nUpper Fence $= \\mu + \\sigma \\Phi^{-1}(0.75) + 3 \\sigma \\Phi^{-1}(0.75) = \\mu + 4 \\sigma \\Phi^{-1}(0.75)$.\n\nNow, we analyze the MAD-based rule. The MAD is the median of the absolute deviations from the sample median. For a normal distribution, this corresponds to the median of the random variable $|X - m| = |X - \\mu|$.\n$\\mathrm{MAD} = \\text{median}(|X - \\mu|)$.\nLet $k = \\mathrm{MAD}$. We must find $k$ such that $P(|X - \\mu| \\le k) = 0.5$.\nThis is equivalent to $P(-k \\le X - \\mu \\le k) = 0.5$, or $P(-k/\\sigma \\le Z \\le k/\\sigma) = 0.5$.\nUsing the standard normal CDF, this becomes $\\Phi(k/\\sigma) - \\Phi(-k/\\sigma) = 0.5$.\nBy symmetry, $2\\Phi(k/\\sigma) - 1 = 0.5$, which implies $\\Phi(k/\\sigma) = 0.75$.\nTherefore, $k/\\sigma = \\Phi^{-1}(0.75)$, which gives $\\mathrm{MAD} = k = \\sigma \\Phi^{-1}(0.75)$.\n\nThe MAD-based upper cutoff is $m + c \\times \\mathrm{MAD}$. For a normal distribution, this is:\nMAD Cutoff $= \\mu + c \\times (\\sigma \\Phi^{-1}(0.75))$.\n\nTo find $c$, we equate the two cutoffs:\n$\\mu + 4 \\sigma \\Phi^{-1}(0.75) = \\mu + c \\sigma \\Phi^{-1}(0.75)$\n$4 \\sigma \\Phi^{-1}(0.75) = c \\sigma \\Phi^{-1}(0.75)$\nThis yields $c = 4$.\n\n### Step 2: Calculation of Cutoffs for the Samples\n\nWe will use the derived constant $c=4$ for the MAD-based rule.\n\n**A. Baseline Sample**\nThe ordered sample is $S_1 = \\{5, 8, 10, 12, 15, 18, 22, 30, 45\\}$. The sample size is $n_1 = 9$.\n- **Median ($m_1$):** The median is the $((9+1)/2)^{th} = 5^{th}$ value. So, $m_1 = 15$.\n- **Quartiles ($Q_{1,1}, Q_{3,1}$):** For an odd-sized sample, we exclude the median.\n  - Lower half: $L_1 = \\{5, 8, 10, 12\\}$. The median of $L_1$ is $Q_{1,1} = \\frac{8+10}{2} = 9$.\n  - Upper half: $U_1 = \\{18, 22, 30, 45\\}$. The median of $U_1$ is $Q_{3,1} = \\frac{22+30}{2} = 26$.\n- **IQR Rule Cutoff ($F_1$):**\n  - $\\mathrm{IQR}_1 = Q_{3,1} - Q_{1,1} = 26 - 9 = 17$.\n  - Upper fence $F_1 = Q_{3,1} + 1.5 \\times \\mathrm{IQR}_1 = 26 + 1.5 \\times 17 = 26 + 25.5 = 51.5$.\n- **MAD Rule Cutoff ($M_1$):**\n  - Absolute deviations from the median $m_1=15$: $\\{|5-15|, |8-15|, |10-15|, ..., |45-15|\\} = \\{10, 7, 5, 3, 0, 3, 7, 15, 30\\}$.\n  - Ordered deviations: $\\{0, 3, 3, 5, 7, 7, 10, 15, 30\\}$.\n  - The MAD is the median of these deviations: $\\mathrm{MAD}_1 = 7$.\n  - MAD cutoff $M_1 = m_1 + c \\times \\mathrm{MAD}_1 = 15 + 4 \\times 7 = 15 + 28 = 43$.\n\n**B. Sample with Extreme Error**\nThe ordered sample is $S_2 = \\{5, 8, 10, 12, 15, 18, 22, 30, 45, 50000\\}$. The sample size is $n_2 = 10$.\n- **Median ($m_2$):** The median is the average of the $(10/2)^{th} = 5^{th}$ and $6^{th}$ values. So, $m_2 = \\frac{15+18}{2} = 16.5$.\n- **Quartiles ($Q_{1,2}, Q_{3,2}$):** For an even-sized sample, we split the data into two equal halves.\n  - Lower half: $L_2 = \\{5, 8, 10, 12, 15\\}$. The median of $L_2$ is $Q_{1,2} = 10$.\n  - Upper half: $U_2 = \\{18, 22, 30, 45, 50000\\}$. The median of $U_2$ is $Q_{3,2} = 30$.\n- **IQR Rule Cutoff ($F_2$):**\n  - $\\mathrm{IQR}_2 = Q_{3,2} - Q_{1,2} = 30 - 10 = 20$.\n  - Upper fence $F_2 = Q_{3,2} + 1.5 \\times \\mathrm{IQR}_2 = 30 + 1.5 \\times 20 = 30 + 30 = 60$.\n- **MAD Rule Cutoff ($M_2$):**\n  - Absolute deviations from the median $m_2=16.5$: $\\{|5-16.5|, ..., |50000-16.5|\\} = \\{11.5, 8.5, 6.5, 4.5, 1.5, 1.5, 5.5, 13.5, 28.5, 49983.5\\}$.\n  - Ordered deviations: $\\{1.5, 1.5, 4.5, 5.5, 6.5, 8.5, 11.5, 13.5, 28.5, 49983.5\\}$.\n  - The MAD is the median of these deviations: $\\mathrm{MAD}_2 = \\frac{6.5+8.5}{2} = 7.5$.\n  - MAD cutoff $M_2 = m_2 + c \\times \\mathrm{MAD}_2 = 16.5 + 4 \\times 7.5 = 16.5 + 30 = 46.5$.\n\n### Step 3: Quantify the Increase in Cutoffs\n\nWe calculate the change in each cutoff value from the baseline to the error-containing sample.\n- Increase in IQR-based cutoff: $\\Delta F = F_2 - F_1 = 60 - 51.5 = 8.5$.\n- Increase in MAD-based cutoff: $\\Delta M = M_2 - M_1 = 46.5 - 43 = 3.5$.\n\n### Step 4: Compute the Final Ratio\n\nThe final step is to compute the ratio of the increase under the $1.5 \\times \\mathrm{IQR}$ rule to the increase under the MAD-based rule.\nRatio $= \\frac{\\Delta F}{\\Delta M} = \\frac{8.5}{3.5} = \\frac{17/2}{7/2} = \\frac{17}{7}$.\n\nConverting the fraction to a decimal gives approximately $2.4285714...$. Rounding to four significant figures, we get $2.429$.\nThis result demonstrates that the MAD-based cutoff is substantially more robust (less influenced by the single extreme outlier) than the IQR-based cutoff. The IQR-based cutoff increased by a factor of roughly $2.43$ more than the MAD-based cutoff in response to the same erroneous data point.", "answer": "$$\n\\boxed{2.429}\n$$", "id": "4798471"}, {"introduction": "After mastering the description of a single sample, the next logical step is comparison between groups, a cornerstone of biostatistics. This practice elevates the boxplot from a purely descriptive tool to an inferential one by introducing the \"notch,\" which provides an approximate confidence interval around the median. You will implement a complete comparison framework from the ground up, calculating all boxplot components for two distinct groups and using the overlap of their notches to make a visual judgment about whether their medians are significantly different. [@problem_id:4898861]", "problem": "You are tasked with implementing a program that compares two independent groups using notched boxplot logic and Tukey outlier detection within a single, coherent algorithmic framework grounded in robust descriptive statistics. The goal is to build a procedure that, for each pair of groups, constructs the interquartile range based boxplot components, detects outliers, constructs notches around the sample medians based on large sample theory, and concludes whether the groups have meaningfully different medians by assessing notch overlap. All calculations must be derived from fundamental definitions and well-tested asymptotic results, without relying on prepackaged high-level routines beyond basic numerical operations.\n\nThe foundational base to use is as follows:\n- The sample is an independent and identically distributed collection $\\{x_i\\}_{i=1}^n$ of real observations.\n- The sample median $\\tilde{x}$ is the $p = 0.5$ quantile. The first quartile $Q_1$ and third quartile $Q_3$ are the $p = 0.25$ and $p = 0.75$ quantiles, respectively.\n- Quantiles must be computed by linear interpolation between order statistics (a widely used, well-tested definition). Specifically, for a sample of size $n$, let the sorted order statistics be $x_{(1)} \\le \\cdots \\le x_{(n)}$. For a probability $p \\in [0,1]$, define $h = (n-1)p + 1$, $k = \\lfloor h \\rfloor$, and $\\gamma = h - k$. Then set\n$$\nQ(p) =\n\\begin{cases}\nx_{(k)},  \\text{if } \\gamma = 0, \\\\\n(1 - \\gamma)\\, x_{(k)} + \\gamma\\, x_{(k+1)},  \\text{if } \\gamma \\in (0,1).\n\\end{cases}\n$$\nUse this definition for $p \\in \\{0.25, 0.5, 0.75\\}$ to compute $Q_1$, $\\tilde{x}$, and $Q_3$.\n- The Interquartile Range (IQR) is $\\mathrm{IQR} = Q_3 - Q_1$.\n- Tukey’s $1.5$ interquartile range rule for outliers uses the lower and upper fences $L = Q_1 - 1.5\\,\\mathrm{IQR}$ and $U = Q_3 + 1.5\\,\\mathrm{IQR}$. Observations $x_i$ with $x_i  L$ or $x_i  U$ are outliers. Whiskers are defined as the smallest observation $\\ge L$ and the largest observation $\\le U$.\n- For large samples, the sample median $\\tilde{x}$ is asymptotically normal with variance $\\mathrm{Var}(\\tilde{x}) \\approx \\frac{1}{4n f(m)^2}$, where $m$ is the population median and $f(m)$ is the value of the continuous density at $m$. This leads to a half-width for a confidence interval around $\\tilde{x}$ proportional to $\\frac{1}{\\sqrt{n} f(m)}$. To operationalize a notch in a boxplot, use the Interquartile Range (IQR) as a robust scale proxy and derive an explicit constant that calibrates the notch half-width to a practical interval for the median under well-behaved distributions. You must base your reasoning on the asymptotic normality of $\\tilde{x}$ and a robust substitution using $\\mathrm{IQR}$ under a normal calibration to determine the notch half-width of the form $c \\cdot \\mathrm{IQR}/\\sqrt{n}$, for a constant $c$ that is conventionally used in Tukey’s notched boxplots. Your program must implement this conventional constant after the derivation.\n\nFor each pair of groups $(A,B)$, the program must:\n- Compute $Q_1$, $\\tilde{x}$, $Q_3$, and $\\mathrm{IQR}$ for each group using the quantile definition above.\n- Compute fences $L$ and $U$, identify outliers by Tukey’s rule, and determine the whisker endpoints as the most extreme non-outlying values.\n- Compute the notches for each group as $[\\tilde{x} - c \\cdot \\mathrm{IQR}/\\sqrt{n},\\ \\tilde{x} + c \\cdot \\mathrm{IQR}/\\sqrt{n}]$, using the constant $c$ that you derive from first principles and conventions described above.\n- Determine whether the two notches overlap. Define a boolean output $\\mathrm{DiffMed}$ that is $\\mathrm{True}$ if the notches do not overlap (interpreted as evidence of different medians in the notched boxplot heuristic) and $\\mathrm{False}$ otherwise.\n\nYour program must process the following test suite of group pairs. Each group is given as an explicit list of real numbers:\n\n- Test case $1$:\n  - $A_1 = [$ $118$, $121$, $119$, $122$, $120$, $123$, $117$, $124$, $119$, $121$, $120$, $122$, $118$, $125$, $119$, $121$, $120$, $123$, $118$, $122$ $]$\n  - $B_1 = [$ $98$, $100$, $101$, $99$, $102$, $97$, $103$, $100$, $99$, $98$, $101$, $97$, $104$, $100$, $98$, $102$, $99$, $101$, $100$, $98$ $]$\n\n- Test case $2$:\n  - $A_2 = [$ $10$, $12$, $11$, $15$, $14$, $13$, $16$, $17$, $12$, $14$, $15$, $13$, $12$, $14$, $13$, $50$ $]$\n  - $B_2 = [$ $12$, $14$, $13$, $16$, $15$, $14$, $17$, $18$, $13$, $15$, $16$, $14$, $13$, $15$, $-5$, $14$ $]$\n\n- Test case $3$:\n  - $A_3 = [$ $1$, $2$, $3$, $4$, $5$ $]$\n  - $B_3 = [$ $6$, $7$, $8$, $9$, $10$ $]$\n\n- Test case $4$:\n  - $A_4 = [$ $0.1$, $0.2$, $0.3$, $0.5$, $0.8$, $1.0$, $0.4$, $0.6$, $0.7$, $5.0$, $6.0$ $]$\n  - $B_4 = [$ $0.2$, $0.3$, $0.4$, $0.5$, $1.5$, $1.6$, $1.7$, $2.0$, $2.2$, $2.5$ $]$\n\n- Test case $5$ (boundary where $\\mathrm{IQR} = 0$ for one group):\n  - $A_5 = [$ $5$, $5$, $5$, $5$, $5$, $5$ $]$\n  - $B_5 = [$ $5$, $5$, $5$, $5$, $10$, $5$ $]$\n\nFor each test case $t \\in \\{1,2,3,4,5\\}$, your program must output a list\n$[\\mathrm{DiffMed}_t,\\ \\mathrm{OutA}_t,\\ \\mathrm{OutB}_t,\\ [W^{A}_{L,t}, W^{A}_{U,t}],\\ [W^{B}_{L,t}, W^{B}_{U,t}]]$\nwhere:\n- $\\mathrm{DiffMed}_t$ is a boolean that is $\\mathrm{True}$ if notches do not overlap and $\\mathrm{False}$ otherwise,\n- $\\mathrm{OutA}_t$ and $\\mathrm{OutB}_t$ are the integer counts of outliers in groups $A_t$ and $B_t$ under Tukey’s $1.5$ rule,\n- $W^{A}_{L,t}$ and $W^{A}_{U,t}$ are the lower and upper whisker endpoints for $A_t$,\n- $W^{B}_{L,t}$ and $W^{B}_{U,t}$ are the lower and upper whisker endpoints for $B_t$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all five test cases as a comma-separated top-level list of per-case lists, exactly in the form\n$[[\\mathrm{DiffMed}_1,\\ \\mathrm{OutA}_1,\\ \\mathrm{OutB}_1,\\ [W^{A}_{L,1}, W^{A}_{U,1}],\\ [W^{B}_{L,1}, W^{B}_{U,1}]],\\ \\ldots,\\ [\\mathrm{DiffMed}_5,\\ \\mathrm{OutA}_5,\\ \\mathrm{OutB}_5,\\ [W^{A}_{L,5}, W^{A}_{U,5}],\\ [W^{B}_{L,5}, W^{B}_{U,5}]]]$\nwith no additional text.\n\nNo physical units, angle units, or percentages are involved in this problem. All outputs must be raw numbers and booleans as specified.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of descriptive statistics and hypothesis testing, is well-posed with a clear algorithmic path to a unique solution, and is expressed objectively with all necessary data and definitions provided. We will proceed with a solution.\n\nThe task is to implement a statistical procedure for comparing two independent groups, $A$ and $B$, using the logic of notched boxplots. This involves several computational steps for each group: calculating quartiles, identifying outliers via Tukey's method, determining whisker lengths, and computing a confidence interval (notch) around the median. The final determination of whether the group medians differ is based on whether these notches overlap.\n\n### Part 1: Boxplot Components and Outlier Detection\n\nThe foundation of a boxplot lies in the sample quartiles. Given a sample of $n$ observations, $\\{x_i\\}_{i=1}^n$, we first obtain the order statistics $x_{(1)} \\le x_{(2)} \\le \\cdots \\le x_{(n)}$. The problem specifies a precise method for calculating the $p$-th quantile, $Q(p)$, via linear interpolation. For a probability $p \\in [0,1]$, we define an index $h = (n-1)p + 1$. Let $k = \\lfloor h \\rfloor$ be the integer part of $h$ and $\\gamma = h - k$ be the fractional part. The quantile $Q(p)$ is then given by:\n$$\nQ(p) = (1 - \\gamma) x_{(k)} + \\gamma x_{(k+1)}\n$$\nThis formula is applied for $p \\in \\{0.25, 0.5, 0.75\\}$ to find the first quartile ($Q_1$), the sample median ($\\tilde{x}$), and the third quartile ($Q_3$), respectively.\n\nFrom these quartiles, we define the Interquartile Range ($\\mathrm{IQR}$) as a robust measure of statistical dispersion:\n$$\n\\mathrm{IQR} = Q_3 - Q_1\n$$\nThe $\\mathrm{IQR}$ is then used to define fences for outlier detection, according to Tukey's $1.5 \\times \\mathrm{IQR}$ rule. The lower fence, $L$, and upper fence, $U$, are:\n$$\nL = Q_1 - 1.5 \\cdot \\mathrm{IQR}\n$$\n$$\nU = Q_3 + 1.5 \\cdot \\mathrm{IQR}\n$$\nAny observation $x_i$ such that $x_i  L$ or $x_i  U$ is classified as an outlier.\n\nThe \"whiskers\" of the boxplot extend to the most extreme data points that are not outliers. The lower whisker endpoint, $W_L$, is the minimum observation in the sample that is greater than or equal to $L$. The upper whisker endpoint, $W_U$, is the maximum observation that is less than or equal to $U$.\n$$\nW_L = \\min\\{x_i \\mid x_i \\ge L\\}\n$$\n$$\nW_U = \\max\\{x_i \\mid x_i \\le U\\}\n$$\n\n### Part 2: Derivation and Implementation of the Notched Interval\n\nThe notch in a boxplot provides an approximate confidence interval for the population median, which facilitates a visual comparison between groups. The half-width of this notch is specified to be of the form $c \\cdot \\mathrm{IQR}/\\sqrt{n}$, where $c$ is a constant. We are tasked with deriving the principle behind this constant.\n\nThe derivation starts from the asymptotic distribution of the sample median, $\\tilde{x}$. For large samples drawn from a continuous distribution with probability density function $f(x)$ and population median $m$, the sample median is approximately normally distributed:\n$$\n\\tilde{x} \\sim \\mathcal{N}\\left(m, \\frac{1}{4n [f(m)]^2}\\right)\n$$\nThe standard error of the median is therefore $\\mathrm{SE}(\\tilde{x}) \\approx \\frac{1}{2\\sqrt{n}f(m)}$.\n\nTo make this formula practical, we need to estimate $f(m)$ from the sample. The problem directs a \"normal calibration\" approach, where we use the relationship between $f(m)$ and the $\\mathrm{IQR}$ for a normal distribution, $N(\\mu, \\sigma^2)$, as a reference.\nFor a normal distribution, the median $m$ is the mean $\\mu$, and the density at the median is $f(m) = f(\\mu) = \\frac{1}{\\sigma\\sqrt{2\\pi}}$. The theoretical quartiles are related to the standard deviation $\\sigma$ by $Q_1 = \\mu - z_{0.25}\\sigma$ and $Q_3 = \\mu + z_{0.25}\\sigma$, where $z_{0.25} = \\Phi^{-1}(0.75) \\approx 0.6745$. The theoretical interquartile range is $\\mathrm{IQR}_{\\text{normal}} = Q_3 - Q_1 = 2 z_{0.25}\\sigma \\approx 1.349\\sigma$.\nFrom this, we can express $\\sigma$ and subsequently $f(m)$ in terms of the $\\mathrm{IQR}$:\n$$\n\\sigma \\approx \\frac{\\mathrm{IQR}_{\\text{normal}}}{1.349} \\quad \\implies \\quad f(m) \\approx \\frac{1}{(\\mathrm{IQR}_{\\text{normal}}/1.349)\\sqrt{2\\pi}} = \\frac{1.349}{\\mathrm{IQR}_{\\text{normal}}\\sqrt{2\\pi}}\n$$\nSubstituting this into the standard error formula and replacing the theoretical $\\mathrm{IQR}_{\\text{normal}}$ with the sample $\\mathrm{IQR}$:\n$$\n\\mathrm{SE}(\\tilde{x}) \\approx \\frac{1}{2\\sqrt{n}} \\left( \\frac{\\mathrm{IQR}\\sqrt{2\\pi}}{1.349} \\right) = \\left( \\frac{\\sqrt{2\\pi}}{2 \\cdot 1.349} \\right) \\frac{\\mathrm{IQR}}{\\sqrt{n}} \\approx 0.925 \\frac{\\mathrm{IQR}}{\\sqrt{n}}\n$$\nThe notch half-width, $H$, is defined as $H = c \\cdot \\mathrm{IQR}/\\sqrt{n}$. The heuristic for comparing two groups, $A$ and $B$, is that their medians are deemed different if their notches do not overlap, i.e., $|\\tilde{x}_A - \\tilde{x}_B|  H_A + H_B$. This visual test is intended to approximate a formal hypothesis test for the difference of medians, where one would reject the null hypothesis of equal medians if $|\\tilde{x}_A - \\tilde{x}_B|  z_{\\alpha/2} \\mathrm{SE}(\\tilde{x}_A - \\tilde{x}_B)$.\n\nEquating the two criteria under the simplifying assumption that $n_A \\approx n_B$ and $\\mathrm{IQR}_A \\approx \\mathrm{IQR}_B$ leads to a value for $c$. However, the problem acknowledges that a specific conventional constant is used in practice. This constant, $c \\approx 1.57$, originates from the foundational work by McGill, Tukey, and Larsen (1978) and subsequent refinements. It is designed to provide a robust visual test for comparing medians across a variety of distributional shapes and sample sizes. The derivation shows the statistical grounding, but a simple line of reasoning does not perfectly recover this exact value, which accounts for factors beyond the simple normal calibration. As instructed, we will use the conventional constant $c = 1.57$.\n\nThe notch for a given group is thus calculated as the interval:\n$$\n\\left[ \\tilde{x} - 1.57 \\frac{\\mathrm{IQR}}{\\sqrt{n}}, \\quad \\tilde{x} + 1.57 \\frac{\\mathrm{IQR}}{\\sqrt{n}} \\right]\n$$\nA special case arises when $\\mathrm{IQR}=0$. In this situation, the notch half-width is $0$, and the notch collapses to a single point at the median.\n\n### Part 3: Algorithmic Procedure\n\nFor each pair of groups ($A_t, B_t$), the algorithm is as follows:\n1.  For each group, create a numerical array from the input list and sort it. Let the size be $n$.\n2.  Calculate $Q_1$, $\\tilde{x}$, and $Q_3$ using the specified quantile interpolation formula. This can be achieved using `numpy.quantile` with `interpolation='linear'`.\n3.  Calculate $\\mathrm{IQR} = Q_3 - Q_1$.\n4.  Handle the case $\\mathrm{IQR}=0$:\n    - The lower and upper fences are $L=U=\\tilde{x}$.\n    - Outliers are any points not equal to $\\tilde{x}$.\n    - The whisker endpoints are both equal to $\\tilde{x}$.\n    - The notch is the interval $[\\tilde{x}, \\tilde{x}]$.\n5.  If $\\mathrm{IQR}0$:\n    - Calculate fences $L = Q_1 - 1.5 \\cdot \\mathrm{IQR}$ and $U = Q_3 + 1.5 \\cdot \\mathrm{IQR}$.\n    - Count the number of data points $x_i$ where $x_i  L$ or $x_i  U$.\n    - Find the whisker endpoints by taking the minimum and maximum of the non-outlying data points.\n    - Calculate the notch half-width $H = 1.57 \\cdot \\mathrm{IQR} / \\sqrt{n}$ and form the notch interval $[\\tilde{x} - H, \\tilde{x} + H]$.\n6.  Compare the notch intervals for groups $A$ and $B$, namely $[\\text{lower}_A, \\text{upper}_A]$ and $[\\text{lower}_B, \\text{upper}_B]$. The boolean variable $\\mathrm{DiffMed}$ is $\\mathrm{True}$ if the notches do not overlap, which occurs if $\\text{upper}_A  \\text{lower}_B$ or $\\text{upper}_B  \\text{lower}_A$. Otherwise, $\\mathrm{DiffMed}$ is $\\mathrm{False}$.\n7.  Collect the results for the test case $t$ into the specified list format: $[\\mathrm{DiffMed}_t,\\ \\mathrm{OutA}_t,\\ \\mathrm{OutB}_t,\\ [W^{A}_{L,t}, W^{A}_{U,t}],\\ [W^{B}_{L,t}, W^{B}_{U,t}]]$.\n8.  Repeat for all test cases and present the final output as a list of lists.", "answer": "[[True, 0, 0, [117.0, 125.0], [97.0, 104.0]], [False, 1, 1, [10.0, 17.0], [12.0, 18.0]], [True, 0, 0, [1.0, 5.0], [6.0, 10.0]], [False, 2, 0, [0.1, 1.0], [0.2, 2.5]], [False, 0, 1, [5.0, 5.0], [5.0, 5.0]]]", "id": "4898861"}]}