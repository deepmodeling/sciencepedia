{"hands_on_practices": [{"introduction": "The foundation of any epidemic curve is a clear and consistent case definition. Often, this definition combines multiple criteria, such as clinical symptoms and laboratory results. This first exercise explores the quantitative impact of how we combine tests, demonstrating the fundamental trade-off between sensitivity and specificity that epidemiologists must navigate when deciding who counts as a case [@problem_id:4507895].", "problem": "A respiratory outbreak investigation team is developing a case definition to construct the epidemic curve for daily incident cases. They consider a two-test algorithm comprising an initial symptoms screen followed by Reverse Transcription Polymerase Chain Reaction (RT-PCR). The symptoms screen has sensitivity $0.78$ and specificity $0.65$, while RT-PCR has sensitivity $0.92$ and specificity $0.98$. Assume conditional independence of test results given disease status: for diseased individuals, the probabilities that the two tests are positive multiply, and for non-diseased individuals, the probabilities that the two tests are positive multiply.\n\nTwo candidate case definitions are under consideration:\n- Serial (AND) structure: classify as a case only if both the symptoms screen and RT-PCR are positive.\n- Parallel (OR) structure: classify as a case if either the symptoms screen or RT-PCR is positive.\n\nUsing only the core definitions of sensitivity and specificity as conditional probabilities of correct classification and the stated independence assumption, compute the joint sensitivity and joint specificity of the two-test algorithm under both the serial (AND) and parallel (OR) structures. Provide your final answer in the order: serial sensitivity, serial specificity, parallel sensitivity, parallel specificity. Express your answers as decimals (do not use a percentage sign) and round to four significant figures.", "solution": "The problem requires the calculation of the joint sensitivity and specificity for a two-test algorithm under two different combination structures: serial (AND) and parallel (OR). We begin by formally defining the given parameters and then deriving the expressions for the desired quantities.\n\nLet $D$ be the event that an individual is diseased, and $D^c$ be the event that the individual is not diseased. Let $T_1$ denote the symptoms screen and $T_2$ denote the RT-PCR test. A positive result for test $i$ is denoted by $T_i^+$ and a negative result by $T_i^-$.\n\nThe sensitivity of a test is the probability of a positive result given the individual is diseased. The specificity of a test is the probability of a negative result given the individual is not diseased.\n\nThe given sensitivities are:\nSensitivity of Test 1: $S_1 = P(T_1^+ | D) = 0.78$\nSensitivity of Test 2: $S_2 = P(T_2^+ | D) = 0.92$\n\nThe given specificities are:\nSpecificity of Test 1: $C_1 = P(T_1^- | D^c) = 0.65$\nSpecificity of Test 2: $C_2 = P(T_2^- | D^c) = 0.98$\n\nFrom these definitions, we can derive the probabilities of the complementary events:\nThe probability of a false negative for Test 1 is $P(T_1^- | D) = 1 - P(T_1^+|D) = 1 - S_1 = 1 - 0.78 = 0.22$.\nThe probability of a false positive for Test 1 is $P(T_1^+ | D^c) = 1 - P(T_1^-|D^c) = 1 - C_1 = 1 - 0.65 = 0.35$.\nThe probability of a false negative for Test 2 is $P(T_2^- | D) = 1 - P(T_2^+|D) = 1 - S_2 = 1 - 0.92 = 0.08$.\nThe probability of a false positive for Test 2 is $P(T_2^+ | D^c) = 1 - P(T_2^-|D^c) = 1 - C_2 = 1 - 0.98 = 0.02$.\n\nThe problem states that the test results are conditionally independent given the disease status. This means that for any outcome of $T_1$ and any outcome of $T_2$, their joint probability conditional on the disease status is the product of their individual conditional probabilities. For example, $P(T_1^+, T_2^+ | D) = P(T_1^+ | D) P(T_2^+ | D)$.\n\n**Serial (AND) Structure**\nIn the serial structure, an individual is classified as a case if and only if both tests are positive. The overall test result is positive if the event $T_1^+ \\cap T_2^+$ occurs.\n\nThe joint sensitivity of the serial algorithm, $S_{serial}$, is the probability of the combined test being positive given the individual is diseased:\n$$S_{serial} = P(T_1^+ \\cap T_2^+ | D)$$\nUsing the conditional independence assumption:\n$$S_{serial} = P(T_1^+ | D) \\times P(T_2^+ | D) = S_1 \\times S_2$$\nSubstituting the given values:\n$$S_{serial} = 0.78 \\times 0.92 = 0.7176$$\n\nThe joint specificity of the serial algorithm, $C_{serial}$, is the probability of the combined test being negative given the individual is not diseased. A negative result in the serial algorithm means that it is not the case that both tests are positive, which is the event $(T_1^+ \\cap T_2^+)^c = T_1^- \\cup T_2^-$.\n$$C_{serial} = P((T_1^+ \\cap T_2^+)^c | D^c) = 1 - P(T_1^+ \\cap T_2^+ | D^c)$$\nUsing the conditional independence assumption:\n$$C_{serial} = 1 - \\left( P(T_1^+ | D^c) \\times P(T_2^+ | D^c) \\right) = 1 - (1 - C_1)(1 - C_2)$$\nSubstituting the given values:\n$$C_{serial} = 1 - (1 - 0.65)(1 - 0.98) = 1 - (0.35)(0.02) = 1 - 0.007 = 0.993$$\n\n**Parallel (OR) Structure**\nIn the parallel structure, an individual is classified as a case if either test is positive. The overall test result is positive if the event $T_1^+ \\cup T_2^+$ occurs.\n\nThe joint sensitivity of the parallel algorithm, $S_{parallel}$, is the probability of the combined test being positive given the individual is diseased:\n$$S_{parallel} = P(T_1^+ \\cup T_2^+ | D)$$\nIt is simpler to calculate this using the complement event. The complement of \"at least one positive\" is \"both negative\", i.e., $(T_1^+ \\cup T_2^+)^c = T_1^- \\cap T_2^-$.\n$$S_{parallel} = 1 - P(T_1^- \\cap T_2^- | D)$$\nUsing the conditional independence assumption:\n$$S_{parallel} = 1 - \\left( P(T_1^- | D) \\times P(T_2^- | D) \\right) = 1 - (1 - S_1)(1 - S_2)$$\nSubstituting the given values:\n$$S_{parallel} = 1 - (1 - 0.78)(1 - 0.92) = 1 - (0.22)(0.08) = 1 - 0.0176 = 0.9824$$\n\nThe joint specificity of the parallel algorithm, $C_{parallel}$, is the probability of the combined test being negative given the individual is not diseased. A negative result in the parallel algorithm requires both tests to be negative, which is the event $T_1^- \\cap T_2^-$.\n$$C_{parallel} = P(T_1^- \\cap T_2^- | D^c)$$\nUsing the conditional independence assumption:\n$$C_{parallel} = P(T_1^- | D^c) \\times P(T_2^- | D^c) = C_1 \\times C_2$$\nSubstituting the given values:\n$$C_{parallel} = 0.65 \\times 0.98 = 0.637$$\n\nThe problem requires the answers to be expressed as decimals rounded to four significant figures.\n- Serial sensitivity: $S_{serial} = 0.7176$. This has four significant figures.\n- Serial specificity: $C_{serial} = 0.993$. To four significant figures, this is $0.9930$.\n- Parallel sensitivity: $S_{parallel} = 0.9824$. This has four significant figures.\n- Parallel specificity: $C_{parallel} = 0.637$. To four significant figures, this is $0.6370$.\n\nThe final results, in the specified order (serial sensitivity, serial specificity, parallel sensitivity, parallel specificity), are $0.7176$, $0.9930$, $0.9824$, and $0.6370$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7176 & 0.9930 & 0.9824 & 0.6370\n\\end{pmatrix}\n}\n$$", "id": "4507895"}, {"introduction": "Once a case definition is established, we can begin counting cases. However, no surveillance system is perfect, and simply plotting the cases you find can underestimate the true scale of an outbreak. This practice introduces the capture-recapture method, a powerful tool used to estimate the total number of cases in a population by analyzing the overlap between two or more incomplete data sources [@problem_id:4507913].", "problem": "During a campus outbreak of acute gastroenteritis, the outbreak investigation team constructs the epidemic curve by date of symptom onset using a standardized case definition to ensure comparability across data sources. For the peak week of the curve, the team applies a confirmed-case definition: a confirmed case is defined as acute onset of vomiting or diarrhea with Norovirus genogroup II detected by Reverse Transcription Polymerase Chain Reaction (RT-PCR), and symptom onset within the peak week.\n\nTwo independent surveillance sources are available for that week:\n- Source $1$: The campus health clinic line list records $n_{1} = 120$ confirmed cases (ascertained by RT-PCR and matched to onset in the peak week).\n- Source $2$: The public health laboratory database records $n_{2} = 95$ confirmed cases (RT-PCR positives matched to onset in the peak week).\nA record linkage procedure, based on deterministic matching of name, date of birth, and onset date, finds $m_{2} = 50$ cases appearing on both lists.\n\nUsing first-principles probabilistic reasoning and appropriate independence assumptions for two-source capture–recapture, derive an estimator for the total number of confirmed cases $N$ in the peak week from the two overlapping lists and compute its value for the data provided. Round your final estimate to $3$ significant figures and express it as a count. In addition, state the assumptions necessary for the validity of this estimator in this surveillance context.", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the principles of epidemiological surveillance and biostatistics, well-posed with a clear objective and sufficient data, and free from subjective or ambiguous language. We may therefore proceed with a formal solution.\n\nThe problem requires the derivation and computation of an estimator for the total number of confirmed cases, $N$, during the peak week of an outbreak, using a two-source capture-recapture method. The provided data are:\n- The number of cases recorded by Source $1$: $n_{1} = 120$.\n- The number of cases recorded by Source $2$: $n_{2} = 95$.\n- The number of cases recorded by both sources (the overlap): $m_{2} = 50$.\n\nThe core of the capture-recapture method rests on a key assumption: the two sources are independent. This means that the probability of a case being recorded by Source $1$ is independent of the probability of it being recorded by Source $2$.\n\nLet $N$ represent the true, unknown total number of confirmed cases in the population of interest.\nLet $S_1$ be the event that a case is captured by Source $1$, and $S_2$ be the event that a case is captured by Source $2$.\nThe probability of a randomly selected case being captured by Source $1$ is $p_1 = P(S_1)$. A reasonable estimate for this probability based on the entire population $N$ is $\\hat{p}_1 = \\frac{n_1}{N}$.\nSimilarly, the probability of a randomly selected case being captured by Source $2$ is $p_2 = P(S_2)$, with the estimate $\\hat{p}_2 = \\frac{n_2}{N}$.\n\nThe fundamental insight of the method comes from considering the proportion of cases in one list that are also found on the other list. Let us consider the sample provided by Source $2$, which contains $n_2$ individuals. Among these $n_2$ cases, $m_2$ were also found in Source $1$. The proportion of cases in Source $2$ that are also in Source $1$ is therefore $\\frac{m_2}{n_2}$. This can be interpreted as an empirical estimate of the conditional probability that a case is in Source $1$, given that it is in Source $2$, i.e., $P(S_1 | S_2)$.\n\nUnder the assumption of independence between the two sources, we have:\n$$\nP(S_1 | S_2) = P(S_1) = p_1\n$$\nWe can now formulate an equation by equating the two different ways of expressing $p_1$: the estimate from the conditional sample and the estimate from the total population.\n$$\n\\frac{m_2}{n_2} \\approx \\hat{p}_1 = \\frac{n_1}{N}\n$$\nThis relationship forms the basis of the Lincoln-Petersen estimator for $N$. By rearranging this equation to solve for $N$, we derive the estimator, denoted as $\\hat{N}$:\n$$\n\\hat{N} = \\frac{n_1 n_2}{m_2}\n$$\nThis estimator provides a maximum likelihood estimate for $N$ under the specified assumptions.\n\nNow, we substitute the provided numerical data into this formula:\n$n_1 = 120$\n$n_2 = 95$\n$m_2 = 50$\n\n$$\n\\hat{N} = \\frac{120 \\times 95}{50}\n$$\nPerforming the calculation:\n$$\n\\hat{N} = \\frac{11400}{50} = \\frac{1140}{5} = 228\n$$\nThe problem requests the final estimate to be rounded to $3$ significant figures. The calculated value of $228$ already consists of exactly three significant figures. Thus, the estimated total number of confirmed cases is $228$.\n\nAs required, we must also state the assumptions necessary for the validity of this capture-recapture estimator in this specific surveillance context:\n$1$. **Closed Population**: The population of cases is closed and constant during the period of surveillance (the peak week). This means there are no new onsets or unresolved cases entering the population, and no cases are lost (e.g., due to migration or death from other causes) during this period. The problem's case definition based on onset within the peak week helps to satisfy this assumption.\n$2$. **Independence of Sources**: The two surveillance sources (campus health clinic and public health laboratory) are independent. The probability of a case being listed by one source is not affected by the probability of it being listed by the other. This assumption would be violated if, for example, the clinic routinely sent all or a non-random subset of its specimens to that specific public health lab, creating a dependency.\n$3$. **Homogeneous Capture Probability**: Every individual in the population of $N$ cases has the same probability of being captured by a given source. That is, the probability $p_1$ is the same for all cases, and the probability $p_2$ is the same for all cases. This can be violated if, for instance, more severely ill individuals are more likely to be detected by both sources than less severely ill individuals.\n$4$. **Perfect Matching**: All records that correspond to the same individual case are correctly linked, and no records for different individuals are incorrectly linked. The value $m_2 = 50$ must be the exact count of true matches.\n\nThe violation of any of these assumptions can introduce bias into the estimate $\\hat{N}$.", "answer": "$$\\boxed{228}$$", "id": "4507913"}, {"introduction": "The choice of a case definition—whether strict and specific or broad and sensitive—has profound consequences for the resulting epidemic curve. This final exercise provides a direct, quantitative comparison of this effect by asking you to generate two different epidemic curves from the same underlying data [@problem_id:4507891]. By calculating the difference between them, you will gain a concrete appreciation for how the choice of case definition shapes our perception of an outbreak's magnitude and dynamics.", "problem": "You are given a line list of individuals with symptom onset times and binary attributes representing clinical and epidemiologic criteria. Your task is to construct epidemic curves under two distinct case definitions, compare their shapes over time using a normalized root mean square error, and report the result for each test case. The scientific base for this problem is the concept of a case definition in public health surveillance and epidemic curves as time-aggregated counts of incident cases. Time is measured in days and is represented as integer day indices. You must aggregate by day and report results as real numbers rounded to six decimal places.\n\nDefinitions and assumptions:\n- An epidemic curve is the sequence of daily counts of incident cases that satisfy a given case definition within a time window. Given a finite set of line-list records with onset times, define the time window as the inclusive range from the minimum to the maximum onset day observed in the given line list.\n- For a fixed time window with days indexed by $t \\in \\{t_{\\min}, t_{\\min}+1, \\dots, t_{\\max}\\}$, let $c_{A}(t)$ and $c_{B}(t)$ denote the daily counts under case definitions $A$ and $B$.\n- The root mean square error is defined as\n$$\n\\mathrm{RMSE}(A,B) = \\sqrt{\\frac{1}{|T|} \\sum_{t \\in T} \\left(c_{A}(t) - c_{B}(t)\\right)^2},\n$$\nwhere $T$ is the set of all days in the window and $|T|$ is the number of days.\n- To compare curves on a scale-free basis, define the normalization constant\n$$\n\\mu = \\frac{1}{2}\\left(\\overline{c_{A}} + \\overline{c_{B}}\\right),\n$$\nwhere $\\overline{c_{A}} = \\frac{1}{|T|}\\sum_{t \\in T} c_{A}(t)$ and $\\overline{c_{B}} = \\frac{1}{|T|}\\sum_{t \\in T} c_{B}(t)$.\n- The normalized root mean square error is then\n$$\n\\mathrm{NRMSE}(A,B) =\n\\begin{cases}\n0, & \\text{if } \\mu = 0,\\\\[6pt]\n\\dfrac{\\mathrm{RMSE}(A,B)}{\\mu}, & \\text{if } \\mu \\neq 0.\n\\end{cases}\n$$\n\nCase definitions:\n- Case Definition $A$ (strict): include a record if and only if fever and cough are both present and at least one of laboratory confirmation or known exposure is present. Using binary variables $F$ (fever), $C$ (cough), $S$ (shortness of breath), $L$ (laboratory confirmation), and $E$ (known exposure), the inclusion rule is\n$$\nA: \\quad (F = 1) \\wedge (C = 1) \\wedge \\left((L = 1) \\vee (E = 1)\\right).\n$$\n- Case Definition $B$ (broad): include a record if and only if at least one of fever, cough, or shortness of breath is present and at least one of laboratory confirmation or known exposure is present:\n$$\nB: \\quad \\left((F = 1) \\vee (C = 1) \\vee (S = 1)\\right) \\wedge \\left((L = 1) \\vee (E = 1)\\right).\n$$\n\nData model:\n- Each record in the line list is a tuple of the form $(d, F, C, S, L, E)$ where $d$ is the onset day as an integer measured in days, and $F, C, S, L, E \\in \\{0,1\\}$ are binary indicators.\n- Time unit is days. All onset days $d$ are integers in units of days.\n\nTask:\n- For each provided test case, compute $c_{A}(t)$ and $c_{B}(t)$ by counting included records per day $t$ for all $t$ in the inclusive range from $t_{\\min}$ to $t_{\\max}$ for that test case’s line list. Then compute $\\mathrm{NRMSE}(A,B)$ as defined above.\n- Express the final result for each test case as a real number rounded to exactly six decimal places.\n\nTest suite:\n- Test Case $1$:\n  - Line list records:\n    - $(0, 1, 1, 0, 1, 0)$\n    - $(0, 1, 0, 0, 1, 0)$\n    - $(1, 1, 1, 0, 0, 1)$\n    - $(1, 1, 0, 1, 0, 1)$\n    - $(2, 1, 1, 0, 0, 0)$\n    - $(2, 0, 1, 1, 1, 0)$\n    - $(3, 0, 0, 1, 0, 1)$\n    - $(3, 1, 1, 1, 1, 1)$\n    - $(4, 1, 1, 0, 1, 1)$\n    - $(5, 1, 1, 0, 0, 1)$\n    - $(6, 0, 0, 0, 1, 1)$\n    - $(7, 1, 0, 0, 0, 1)$\n    - $(8, 0, 1, 0, 1, 0)$\n    - $(9, 1, 1, 1, 0, 0)$\n- Test Case $2$:\n  - Line list records:\n    - $(0, 1, 1, 0, 1, 0)$\n    - $(0, 1, 1, 0, 0, 1)$\n    - $(1, 1, 1, 0, 1, 1)$\n    - $(1, 0, 0, 1, 0, 0)$\n    - $(2, 1, 1, 0, 0, 0)$\n    - $(2, 1, 1, 1, 1, 1)$\n    - $(3, 0, 0, 0, 1, 1)$\n    - $(3, 1, 1, 0, 0, 1)$\n- Test Case $3$:\n  - Line list records:\n    - $(5, 0, 1, 0, 1, 0)$\n- Test Case $4$:\n  - Line list records:\n    - $(2, 0, 0, 0, 1, 1)$\n    - $(3, 1, 0, 0, 0, 0)$\n    - $(4, 0, 1, 1, 0, 0)$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each value rounded to exactly six decimal places, in the order of Test Case $1$, Test Case $2$, Test Case $3$, Test Case $4$; for example, a valid format is\n$$\n[\\text{value}_{1},\\text{value}_{2},\\text{value}_{3},\\text{value}_{4}].\n$$", "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded in the principles of epidemiology, specifically public health surveillance, case definitions, and the analysis of epidemic curves. The problem is well-posed, providing all necessary definitions, data, and mathematical formulas required for a unique and verifiable solution. The language is objective and the structure is logical.\n\nThe solution is derived by following a sequence of well-defined computational steps for each test case. The overall methodology consists of:\n1.  Identifying the surveillance time window from the provided line list.\n2.  Constructing the two epidemic curves, $c_A(t)$ and $c_B(t)$, by classifying each case according to the strict (A) and broad (B) case definitions and aggregating counts by day.\n3.  Calculating the Normalized Root Mean Square Error ($\\mathrm{NRMSE}$) between the two curves using the provided formulas.\n\nLet us detail these steps.\n\n**Step 1: Time Window Determination**\nFor each test case, we are given a line list of records, where each record includes an integer onset day $d$. The surveillance time window, $T$, is the inclusive set of integer days from the minimum observed onset day, $t_{\\min}$, to the maximum, $t_{\\max}$.\n$$T = \\{t \\in \\mathbb{Z} \\mid t_{\\min} \\leq t \\leq t_{\\max}\\}$$\nThe duration of this window, which is the number of time points for our analysis, is $|T| = t_{\\max} - t_{\\min} + 1$.\n\n**Step 2: Epidemic Curve Construction**\nWe initialize two vectors, representing the daily case counts for each definition, $c_A$ and $c_B$, with a length of $|T|$ and all elements set to $0$. We then iterate through each record $(d, F, C, S, L, E)$ from the line list. For each record, we evaluate two boolean conditions corresponding to the case definitions.\n\nThe condition for the strict Case Definition $A$ is:\n$$ (F = 1) \\wedge (C = 1) \\wedge \\left((L = 1) \\vee (E = 1)\\right) $$\nThe condition for the broad Case Definition $B$ is:\n$$ \\left((F = 1) \\vee (C = 1) \\vee (S = 1)\\right) \\wedge \\left((L = 1) \\vee (E = 1)\\right) $$\nwhere $\\wedge$ denotes logical AND and $\\vee$ denotes logical OR.\n\nIf a record satisfies the condition for Definition $A$, we increment the count for its onset day $d$. Specifically, we increment the element at index $(d - t_{\\min})$ in the vector $c_A$. Similarly, if the record satisfies the condition for Definition $B$, we increment the corresponding element in the vector $c_B$. After processing all records, the vectors $c_A$ and $c_B$ represent the discrete time series of daily case counts, i.e., the epidemic curves.\n\n**Step 3: NRMSE Calculation**\nThe final step is to compute the $\\mathrm{NRMSE}(A,B)$, which quantifies the difference in shape between the two curves, normalized by their mean level.\n\nFirst, we calculate the Root Mean Square Error ($\\mathrm{RMSE}$):\n$$ \\mathrm{RMSE}(A,B) = \\sqrt{\\frac{1}{|T|} \\sum_{t \\in T} \\left(c_{A}(t) - c_{B}(t)\\right)^2} $$\nThis is the square root of the mean of the squared differences between the daily counts of the two curves.\n\nNext, we compute the normalization factor, $\\mu$. This is the average of the mean values of the two curves. The mean of each curve is given by:\n$$ \\overline{c_{A}} = \\frac{1}{|T|}\\sum_{t \\in T} c_{A}(t) \\quad \\text{and} \\quad \\overline{c_{B}} = \\frac{1}{|T|}\\sum_{t \\in T} c_{B}(t) $$\nThe normalization factor is then:\n$$ \\mu = \\frac{1}{2}\\left(\\overline{c_{A}} + \\overline{c_{B}}\\right) $$\n\nFinally, the $\\mathrm{NRMSE}$ is the ratio of the $\\mathrm{RMSE}$ to $\\mu$. A special case is defined for when $\\mu=0$, which occurs if and only if both curves are zero for all $t \\in T$.\n$$\n\\mathrm{NRMSE}(A,B) =\n\\begin{cases}\n0, & \\text{if } \\mu = 0 \\\\\n\\dfrac{\\mathrm{RMSE}(A,B)}{\\mu}, & \\text{if } \\mu \\neq 0\n\\end{cases}\n$$\nThe result for each test case is this value, rounded to six decimal places.\n\n**Example Calculation for Test Case 1:**\n- **Time Window**: The onset days range from $d=0$ to $d=9$. Thus, $t_{\\min}=0$, $t_{\\max}=9$, and $|T|=10$.\n- **Curve Construction**: Processing all $14$ records against the definitions yields the following daily counts:\n  - $c_A = [1, 1, 0, 1, 1, 1, 0, 0, 0, 0]$\n  - $c_B = [2, 2, 1, 2, 1, 1, 0, 1, 1, 0]$\n- **NRMSE Calculation**:\n  - Total cases for A: $\\sum c_A(t) = 5$. Total for B: $\\sum c_B(t) = 11$.\n  - $\\overline{c_{A}} = 5/10 = 0.5$.\n  - $\\overline{c_{B}} = 11/10 = 1.1$.\n  - $\\mu = \\frac{1}{2}(0.5 + 1.1) = 0.8$.\n  - The vector of differences is $c_A - c_B = [-1, -1, -1, -1, 0, 0, 0, -1, -1, 0]$.\n  - The vector of squared differences is $[1, 1, 1, 1, 0, 0, 0, 1, 1, 0]$.\n  - The sum of squared differences is $6$.\n  - $\\mathrm{RMSE} = \\sqrt{6/10} = \\sqrt{0.6} \\approx 0.77459667$.\n  - $\\mathrm{NRMSE} = \\frac{0.77459667}{0.8} \\approx 0.96824584$.\n- **Result**: Rounded to six decimal places, the result is $0.968246$.\n\nThis procedure is systematically applied to all provided test cases to derive the final answers.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases by calculating the Normalized\n    Root Mean Square Error (NRMSE) between epidemic curves generated from\n    two different case definitions.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        [\n            (0, 1, 1, 0, 1, 0), (0, 1, 0, 0, 1, 0), (1, 1, 1, 0, 0, 1),\n            (1, 1, 0, 1, 0, 1), (2, 1, 1, 0, 0, 0), (2, 0, 1, 1, 1, 0),\n            (3, 0, 0, 1, 0, 1), (3, 1, 1, 1, 1, 1), (4, 1, 1, 0, 1, 1),\n            (5, 1, 1, 0, 0, 1), (6, 0, 0, 0, 1, 1), (7, 1, 0, 0, 0, 1),\n            (8, 0, 1, 0, 1, 0), (9, 1, 1, 1, 0, 0)\n        ],\n        # Test Case 2\n        [\n            (0, 1, 1, 0, 1, 0), (0, 1, 1, 0, 0, 1), (1, 1, 1, 0, 1, 1),\n            (1, 0, 0, 1, 0, 0), (2, 1, 1, 0, 0, 0), (2, 1, 1, 1, 1, 1),\n            (3, 0, 0, 0, 1, 1), (3, 1, 1, 0, 0, 1)\n        ],\n        # Test Case 3\n        [\n            (5, 0, 1, 0, 1, 0)\n        ],\n        # Test Case 4\n        [\n            (2, 0, 0, 0, 1, 1), (3, 1, 0, 0, 0, 0), (4, 0, 1, 1, 0, 0)\n        ]\n    ]\n\n    results = []\n    for line_list in test_cases:\n        results.append(calculate_nrmse_for_case(line_list))\n\n    # Format the final output string exactly as specified.\n    formatted_results = ','.join(f\"{r:.6f}\" for r in results)\n    print(f\"[{formatted_results}]\")\n\ndef calculate_nrmse_for_case(line_list):\n    \"\"\"\n    Calculates the NRMSE for a single test case's line list.\n\n    Args:\n        line_list: A list of tuples, where each tuple is a record\n                   (d, F, C, S, L, E).\n\n    Returns:\n        The calculated NRMSE value as a float.\n    \"\"\"\n    if not line_list:\n        return 0.0\n\n    data = np.array(line_list, dtype=int)\n    onset_days = data[:, 0]\n    \n    t_min = np.min(onset_days)\n    t_max = np.max(onset_days)\n    num_days = t_max - t_min + 1\n\n    counts_a = np.zeros(num_days, dtype=float)\n    counts_b = np.zeros(num_days, dtype=float)\n\n    for record in data:\n        d, f, c, s, l, e = record\n        \n        # Epidemiologic criteria: Lab confirmation or known exposure\n        epi_criterion = (l == 1) or (e == 1)\n\n        # Apply Case Definition A (strict)\n        # Fever AND Cough AND (Lab OR Exposure)\n        is_case_a = (f == 1) and (c == 1) and epi_criterion\n        if is_case_a:\n            counts_a[d - t_min] += 1\n\n        # Apply Case Definition B (broad)\n        # (Fever OR Cough OR Shortness of Breath) AND (Lab OR Exposure)\n        clinical_criterion_b = (f == 1) or (c == 1) or (s == 1)\n        is_case_b = clinical_criterion_b and epi_criterion\n        if is_case_b:\n            counts_b[d - t_min] += 1\n\n    # Calculate normalization factor mu\n    mean_a = np.mean(counts_a)\n    mean_b = np.mean(counts_b)\n    mu = 0.5 * (mean_a + mean_b)\n\n    # Handle the case where both curves are zero\n    if mu == 0:\n        return 0.0\n\n    # Calculate RMSE\n    squared_diff = (counts_a - counts_b) ** 2\n    mse = np.mean(squared_diff)\n    rmse = np.sqrt(mse)\n\n    # Calculate NRMSE\n    nrmse = rmse / mu\n    return nrmse\n\nsolve()\n```", "id": "4507891"}]}