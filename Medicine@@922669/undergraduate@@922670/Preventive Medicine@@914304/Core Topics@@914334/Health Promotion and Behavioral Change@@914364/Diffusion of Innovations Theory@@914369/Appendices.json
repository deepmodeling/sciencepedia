{"hands_on_practices": [{"introduction": "The Bass diffusion model is a cornerstone for quantitatively describing how innovations spread. It elegantly captures the two primary forces driving adoption: external influence from sources like media ('innovators') and internal influence from peer-to-peer communication ('imitators').\n\nThis first practice challenges you to translate these qualitative drivers into a precise mathematical expression, a fundamental skill for applying theoretical concepts to real-world scenarios [@problem_id:4520327]. By correctly identifying the structure of the model, you build the foundation for all subsequent analysis.", "problem": "A public health department is evaluating the diffusion of a new self-collection kit for cervical cancer screening among an eligible population. Let the total number of eligible individuals be $K$ and the cumulative number of adopters by time $t$ be $F(t)$. Consider the principles of Diffusion of Innovations (DOI) and a mass-action mixing assumption: at any time $t$, those who have not yet adopted are $K - F(t)$, and the probability that a non-adopter encounters an adopter is proportional to the fraction of adopters, $F(t)/K$. Assume that adoption arises from two channels that act additively: (i) an external, exogenous influence (e.g., media campaigns and clinician outreach) that contributes a constant instantaneous adoption hazard per non-adopter, and (ii) an internal, endogenous influence from social contagion and peer imitation (e.g., word-of-mouth, provider networks) that contributes an instantaneous adoption hazard proportional to the rate of adopter–non-adopter encounters. Based on these principles and definitions, select the option that correctly specifies the adoption incidence $f(t)$ as a function of $K$ and $F(t)$ and accurately explains the roles of the innovation coefficient $p$ and imitation coefficient $q$ in the context of preventive interventions.\n\nA. $f(t) = p\\big(K - F(t)\\big) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$. Here, $p$ is the rate at which non-adopters adopt due to external drivers that are independent of peer uptake (e.g., public health messaging, clinician recommendations), and $q$ is the strength of peer or network imitation whereby the instantaneous adoption risk increases in proportion to the fraction already adopted.\n\nB. $f(t) = p\\,F(t) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$. Here, $p$ is the rate at which current adopters continue adopting due to external drivers, and $q$ measures imitation strength; $f(t)$ depends on adopters for both terms because external influence is assumed to amplify only among those already adopted.\n\nC. $f(t) = p\\big(K - F(t)\\big) + q\\big(K - F(t)\\big)$. Here, both $p$ and $q$ are constant external rates affecting non-adopters only, with $q$ representing the decay of innovation impact over time; peer effects are negligible in preventive interventions.\n\nD. $f(t) = p\\,K + q\\,F(t)$. Here, $p$ is the baseline external push acting on the whole population regardless of current adoption, while $q$ scales with the number of adopters but does not depend on the remaining non-adopters; imitation does not require remaining market.", "solution": "The problem statement describes a process of innovation diffusion, which can be modeled mathematically. The goal is to derive the adoption incidence, $f(t)$, which is the rate of change of the cumulative number of adopters, $f(t) = \\dfrac{dF(t)}{dt}$.\n\n### Step 1: Extract Givens and Formalize the Principles\nThe problem provides the following definitions and principles:\n1.  $K$: The total number of eligible individuals (the market potential).\n2.  $F(t)$: The cumulative number of adopters at time $t$.\n3.  $K - F(t)$: The number of non-adopters (potential adopters) at time $t$.\n4.  $f(t)$: The adoption incidence, or the rate of new adoptions, at time $t$. By definition, $f(t) = \\dfrac{dF(t)}{dt}$.\n5.  The rate of new adoptions $f(t)$ is the product of the number of non-adopters and the instantaneous hazard of adoption for a non-adopter. Let's denote this hazard as $h(t)$.\n    $$f(t) = h(t) \\times \\left(K - F(t)\\right)$$\n6.  The hazard $h(t)$ is the sum of two components, one from an external channel and one from an internal channel: $h(t) = h_{\\text{external}} + h_{\\text{internal}}$.\n7.  **External Influence (Channel i):** This contributes a \"constant instantaneous adoption hazard per non-adopter\". Let's name this constant $p$, the coefficient of innovation.\n    $$h_{\\text{external}} = p$$\n    This component of adoption is independent of the number of existing adopters. It is driven by factors external to the social system, such as media campaigns.\n8.  **Internal Influence (Channel ii):** This contributes an \"instantaneous adoption hazard proportional to the rate of adopter–non-adopter encounters\". The problem further states that the probability of such an encounter is \"proportional to the fraction of adopters, $F(t)/K$\". Let's name the constant of proportionality $q$, the coefficient of imitation. The hazard for a single non-adopter due to internal influence is therefore:\n    $$h_{\\text{internal}} = q \\dfrac{F(t)}{K}$$\n    This component depends on social contagion or word-of-mouth effects, which increase as the proportion of adopters in the population grows.\n\n### Step 2: Validate the Problem Statement\nThe problem describes the foundational principles of the Bass diffusion model, a cornerstone of quantitative marketing science and a widely used model in epidemiology and public health for tracking the spread of behaviors, technologies, and ideas.\n\n-   **Scientific Grounding:** The model is scientifically sound and established. Its application to the diffusion of a preventive health technology (cervical cancer screening kits) is a standard and appropriate use case. The concepts of innovation ($p$) and imitation ($q$) coefficients are central to this theory.\n-   **Well-Posedness:** The description is clear and contains all necessary components to construct a differential equation for $F(t)$. This constitutes a well-posed initial value problem (given $F(0)$ is known, typically $F(0) \\approx 0$). The question asks for the expression for the derivative, $f(t)$, which is directly derivable from the premises.\n-   **Objectivity:** The problem statement uses precise, objective language standard to the field. It is free of ambiguity or subjective claims.\n\nThe problem statement is valid. It presents a clear, formalizable scenario based on established scientific principles.\n\n### Step 3: Derive the Expression for Adoption Incidence $f(t)$\nCombining the principles from Step 1, we first assemble the total instantaneous hazard for a non-adopter, $h(t)$:\n$$h(t) = h_{\\text{external}} + h_{\\text{internal}} = p + q \\dfrac{F(t)}{K}$$\nNext, we use this hazard to find the total rate of new adoptions, $f(t)$, by multiplying the hazard by the number of individuals at risk of adopting, which is the pool of non-adopters, $K - F(t)$:\n$$f(t) = h(t) \\times \\left(K - F(t)\\right)$$\nSubstituting the expression for $h(t)$:\n$$f(t) = \\left(p + q \\dfrac{F(t)}{K}\\right) \\left(K - F(t)\\right)$$\nThis is the differential form of the Bass model. We can expand this expression to match the format of the options:\n$$f(t) = p\\left(K - F(t)\\right) + q \\dfrac{F(t)}{K} \\left(K - F(t)\\right)$$\nThis equation states that the rate of new adoptions ($f(t)$) is the sum of two terms:\n-   A term representing adoptions by \"innovators\": $p\\left(K - F(t)\\right)$. The rate is proportional to the number of remaining non-adopters, with the constant of proportionality $p$.\n-   A term representing adoptions by \"imitators\": $q \\dfrac{F(t)}{K} \\left(K - F(t)\\right)$. The rate is proportional to the product of the number of non-ad adopters ($K - F(t)$) and the proportion of adopters ($F(t)/K$), scaled by the imitation coefficient $q$.\n\n### Step 4: Evaluate Each Option\n\n**A. $f(t) = p\\big(K - F(t)\\big) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$. Here, $p$ is the rate at which non-adopters adopt due to external drivers that are independent of peer uptake (e.g., public health messaging, clinician recommendations), and $q$ is the strength of peer or network imitation whereby the instantaneous adoption risk increases in proportion to the fraction already adopted.**\n-   **Mathematical Form:** This expression is identical to the one derived from the first principles described in the problem statement.\n-   **Explanation:** The explanation for $p$ correctly identifies it as the coefficient for external influence acting on non-adopters. The explanation for $q$ correctly identifies it as the coefficient for internal (imitation) influence, where the adoption pressure grows with the fraction of adopters, $F(t)/K$. Both the formula and the interpretation are correct.\n-   **Verdict:** **Correct**.\n\n**B. $f(t) = p\\,F(t) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$. Here, $p$ is the rate at which current adopters continue adopting due to external drivers, and $q$ measures imitation strength; $f(t)$ depends on adopters for both terms because external influence is assumed to amplify only among those already adopted.**\n-   **Mathematical Form:** The first term, $p\\,F(t)$, is incorrect. The external influence must act on the pool of non-adopters, $K - F(t)$, not the pool of current adopters, $F(t)$. Individuals who have already adopted cannot adopt again.\n-   **Explanation:** The explanation that $p$ is a rate at which \"current adopters continue adopting\" is nonsensical for a one-time adoption event like using a screening kit for the first time.\n-   **Verdict:** **Incorrect**.\n\n**C. $f(t) = p\\big(K - F(t)\\big) + q\\big(K - F(t)\\big)$. Here, both $p$ and $q$ are constant external rates affecting non-adopters only, with $q$ representing the decay of innovation impact over time; peer effects are negligible in preventive interventions.**\n-   **Mathematical Form:** This simplifies to $f(t) = (p+q)(K-F(t))$. This model lacks the term $F(t)/K$, which is required to represent the internal influence (imitation) that depends on the existing number of adopters. It models a purely external influence process with a combined coefficient of $(p+q)$.\n-   **Explanation:** The explanation incorrectly classifies $q$ as an external rate and makes an unsubstantiated claim that \"peer effects are negligible in preventive interventions,\" which contradicts the problem's premise of including an internal, endogenous influence channel.\n-   **Verdict:** **Incorrect**.\n\n**D. $f(t) = p\\,K + q\\,F(t)$. Here, $p$ is the baseline external push acting on the whole population regardless of current adoption, while $q$ scales with the number of adopters but does not depend on the remaining non-adopters; imitation does not require remaining market.**\n-   **Mathematical Form:** This equation is fundamentally flawed. Critically, the rate of new adoptions, $f(t)$, must approach $0$ as the number of adopters $F(t)$ approaches the total population $K$. In this model, as $F(t) \\to K$, $f(t) \\to pK + qK \\ne 0$. This implies an infinite number of adoptions are possible, which violates the definition of $K$ as the total eligible population. The model must include the term $(K - F(t))$ to ensure the process terminates.\n-   **Explanation:** The interpretation is also flawed. Imitation is an interaction between those who have adopted and those who have not; it absolutely requires a \"remaining market\" of non-adopters.\n-   **Verdict:** **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "4520327"}, {"introduction": "Many diffusion processes are characterized by the iconic S-shaped curve, but where does this famous pattern originate? This exercise reveals the mathematical engine behind it by focusing on the power of imitation, a key component of the models we have discussed.\n\nYou will derive the logistic growth curve from a simple, powerful first principle: the rate of new adoptions is proportional to the number of interactions between current adopters and potential adopters [@problem_id:4520329]. This practice provides deep insight into how simple local interactions can generate predictable, large-scale adoption patterns.", "problem": "A public health department is monitoring the adoption of a new preventive intervention checklist by primary care clinics. Let $S(t)$ denote the cumulative number of clinics that have adopted by time $t$ (measured in months). Suppose the total number of clinics that could eventually adopt is $K$, and let $S(0) = S_{0}$. In the spirit of Diffusion of Innovations theory, assume adoption is driven primarily by interpersonal influence among clinics: the instantaneous rate at which non-adopting clinics adopt is proportional to both the number of current adopters and the number of remaining non-adopters. Using only this assumption and standard calculus, derive the closed-form adoption trajectory $S(t)$ and show that it has a sigmoidal shape. Identify the parameters corresponding to the saturation level $K$, the intrinsic adoption speed $r$, and the inflection time $t_{0}$.\n\nThen, consider a specific rollout with $K = 1200$ clinics, baseline adoption $S(0) = 30$, and observed adoption $S(6) = 180$ after $6$ months. Using your derived model:\n- Express $r$ and $t_{0}$ in terms of $K$, $S_{0}$, and observed $S(6)$, and then evaluate them numerically.\n- Compute the time $t$ at which adoption reaches $0.8K$.\n\nRound your final numerical answer for $t$ to four significant figures and express the time in months. Do not use a percentage sign; treat $0.8$ as a decimal fraction.", "solution": "The problem is well-posed, scientifically grounded, and contains sufficient information for a unique solution. The model described is the classic logistic growth model, widely used in modeling diffusion processes.\n\nFirst, we derive the general closed-form adoption trajectory $S(t)$. The problem states that the instantaneous rate of adoption, $\\frac{dS}{dt}$, is proportional to both the number of current adopters, $S$, and the number of remaining non-adopters, $K-S$. We can write this as a differential equation:\n$$\n\\frac{dS}{dt} = p S(K-S)\n$$\nwhere $p$ is a constant of proportionality related to the adoption rate. This is a separable differential equation. We can rearrange it to separate the variables $S$ and $t$:\n$$\n\\frac{dS}{S(K-S)} = p \\, dt\n$$\nTo integrate the left side, we use partial fraction decomposition. Let\n$$\n\\frac{1}{S(K-S)} = \\frac{A}{S} + \\frac{B}{K-S}\n$$\nMultiplying by $S(K-S)$ gives $1 = A(K-S) + BS$.\nSetting $S=0$ yields $1 = AK$, so $A = \\frac{1}{K}$.\nSetting $S=K$ yields $1 = BK$, so $B = \\frac{1}{K}$.\nThus, the equation becomes:\n$$\n\\frac{1}{K} \\left( \\frac{1}{S} + \\frac{1}{K-S} \\right) dS = p \\, dt\n$$\nIntegrating both sides:\n$$\n\\int \\frac{1}{K} \\left( \\frac{1}{S} + \\frac{1}{K-S} \\right) dS = \\int p \\, dt\n$$\n$$\n\\frac{1}{K} \\left( \\ln|S| - \\ln|K-S| \\right) = pt + C_1\n$$\nwhere $C_1$ is the constant of integration. Since $S$ represents a number of clinics, $0 \\le S \\le K$, we can drop the absolute value signs.\n$$\n\\ln\\left(\\frac{S}{K-S}\\right) = Kpt + KC_1\n$$\nLet's define the intrinsic adoption speed as $r = Kp$. The equation becomes:\n$$\n\\ln\\left(\\frac{S}{K-S}\\right) = rt + C\n$$\nwhere $C = KC_1$. Exponentiating both sides gives:\n$$\n\\frac{S}{K-S} = \\exp(rt+C) = \\exp(C)\\exp(rt)\n$$\nWe use the initial condition $S(0) = S_0$ to find $\\exp(C)$:\n$$\n\\frac{S_0}{K-S_0} = \\exp(C)\\exp(0) = \\exp(C)\n$$\nSubstituting this back into the equation:\n$$\n\\frac{S}{K-S} = \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)\n$$\nNow, we solve for $S(t)$:\n$S = (K-S) \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)$\n$S \\left(1 + \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)\\right) = K \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)$\n$S(t) = \\frac{K \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)}{1 + \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)}$\nDividing the numerator and denominator by $\\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)$:\n$$\nS(t) = \\frac{K}{1 + \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt)}\n$$\nThis is the closed-form solution for the adoption trajectory.\n\nNext, we show its sigmoidal shape and identify parameters.\nThe function is a logistic function.\n- As $t \\to \\infty$, $\\exp(-rt) \\to 0$, so $S(t) \\to K$. The saturation level is $K$.\n- As $t \\to -\\infty$, $\\exp(-rt) \\to \\infty$, so $S(t) \\to 0$.\n- The derivative $\\frac{dS}{dt} = pS(K-S) = \\frac{r}{K}S(K-S)$ is positive for $0 < S < K$, so the function is monotonically increasing.\n- The inflection point occurs when the rate of growth is maximal, which is when $\\frac{d^2S}{dt^2} = 0$.\n$$\n\\frac{d^2S}{dt^2} = \\frac{d}{dt}\\left(\\frac{r}{K}S(K-S)\\right) = \\frac{r}{K}(K-2S)\\frac{dS}{dt}\n$$\nSetting $\\frac{d^2S}{dt^2}=0$ (and assuming $\\frac{dS}{dt} \\neq 0$), we get $K-2S=0$, which means $S = \\frac{K}{2}$. The growth rate is fastest when half the clinics have adopted. The time at which this occurs is the inflection time, $t_0$.\nWe find $t_0$ by setting $S(t_0) = \\frac{K}{2}$:\n$$\n\\frac{K}{2} = \\frac{K}{1 + \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt_0)}\n$$\n$2 = 1 + \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt_0)$\n$1 = \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt_0)$\n$\\exp(rt_0) = \\frac{K-S_0}{S_0} \\implies t_0 = \\frac{1}{r}\\ln\\left(\\frac{K-S_0}{S_0}\\right)$.\nThus, the parameters are:\n- Saturation level: $K$.\n- Intrinsic adoption speed: $r$.\n- Inflection time: $t_0$.\n\nWe can rewrite $S(t)$ in a more standard form using $t_0$:\n$$\nS(t) = \\frac{K}{1 + \\exp(rt_0)\\exp(-rt)} = \\frac{K}{1 + \\exp(-r(t-t_0))}\n$$\n\nNow, we use the specific data: $K = 1200$, $S_0 = S(0) = 30$, and $S(6) = 180$.\nFirst, we express and evaluate $r$. From the derived solution:\n$$\n\\frac{K}{S(t)} - 1 = \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt)\n$$\n$\\exp(-rt) = \\left(\\frac{S_0}{K-S_0}\\right) \\left(\\frac{K-S(t)}{S(t)}\\right)$\n$-rt = \\ln\\left[ \\frac{S_0(K-S(t))}{S(t)(K-S_0)} \\right]$\n$$\nr = \\frac{1}{t} \\ln\\left[ \\frac{S(t)(K-S_0)}{S_0(K-S(t))} \\right]\n$$\nUsing $t = 6$ and $S(6) = 180$:\n$$\nr = \\frac{1}{6} \\ln\\left[ \\frac{180(1200-30)}{30(1200-180)} \\right] = \\frac{1}{6} \\ln\\left[ \\frac{180 \\cdot 1170}{30 \\cdot 1020} \\right] = \\frac{1}{6} \\ln\\left[ \\frac{6 \\cdot 1170}{1020} \\right] = \\frac{1}{6} \\ln\\left[ \\frac{7020}{1020} \\right] = \\frac{1}{6} \\ln\\left(\\frac{117}{17}\\right)\n$$\nNumerically, $r \\approx \\frac{1}{6}\\ln(6.88235) \\approx \\frac{1.928928}{6} \\approx 0.321488$ months$^{-1}$.\n\nNext, we express and evaluate $t_0$:\n$$\nt_0 = \\frac{1}{r} \\ln\\left(\\frac{K-S_0}{S_0}\\right) = \\frac{1}{\\frac{1}{6}\\ln\\left(\\frac{117}{17}\\right)} \\ln\\left(\\frac{1200-30}{30}\\right) = \\frac{6 \\ln(39)}{\\ln(117/17)}\n$$\nNumerically, $t_0 \\approx \\frac{6 \\cdot 3.66356}{1.928928} \\approx 11.3957$ months.\n\nFinally, we compute the time $t$ at which adoption reaches $0.8K$.\n$S(t) = 0.8K = 0.8 \\times 1200 = 960$.\nUsing the form $S(t) = \\frac{K}{1 + \\exp(-r(t-t_0))}$:\n$$\n960 = \\frac{1200}{1 + \\exp(-r(t-t_0))}\n$$\n$1 + \\exp(-r(t-t_0)) = \\frac{1200}{960} = \\frac{5}{4}$\n$\\exp(-r(t-t_0)) = \\frac{5}{4} - 1 = \\frac{1}{4}$\n$-r(t-t_0) = \\ln\\left(\\frac{1}{4}\\right) = -\\ln(4)$\n$t-t_0 = \\frac{\\ln(4)}{r}$\n$t = t_0 + \\frac{\\ln(4)}{r}$\nSubstituting the expressions for $t_0$ and $r$:\n$$\nt = \\frac{\\frac{1}{r} \\ln\\left(\\frac{K-S_0}{S_0}\\right) + \\frac{\\ln(4)}{r}}{1} = \\frac{\\ln\\left(\\frac{K-S_0}{S_0}\\right) + \\ln(4)}{r} = \\frac{\\ln\\left[4 \\left(\\frac{K-S_0}{S_0}\\right)\\right]}{r}\n$$\nPlugging in the values:\n$$\nt = \\frac{\\ln\\left[4 \\left(\\frac{1200-30}{30}\\right)\\right]}{\\frac{1}{6}\\ln\\left(\\frac{117}{17}\\right)} = \\frac{\\ln\\left[4 \\cdot 39\\right]}{\\frac{1}{6}\\ln\\left(\\frac{117}{17}\\right)} = \\frac{6 \\ln(156)}{\\ln(117/17)}\n$$\nNow, we calculate the numerical value:\n$$\nt \\approx \\frac{6 \\cdot 5.049856}{1.928928} \\approx \\frac{30.299136}{1.928928} \\approx 15.70777\n$$\nRounding to four significant figures, we get $t \\approx 15.71$ months.", "answer": "$$\\boxed{15.71}$$", "id": "4520329"}, {"introduction": "Theoretical models become truly powerful when they connect with real-world data. This final practice moves from theory to application, challenging you to analyze a realistic dataset.\n\nUsing adoption data from a new screening program, you will fit the Bass model to estimate the crucial innovation ($p$) and imitation ($q$) coefficients [@problem_id:4520340]. This hands-on coding exercise not only reinforces your understanding of the model's structure but also equips you with the practical skill of diagnosing whether an intervention's success is driven by external promotion or organic, word-of-mouth spread.", "problem": "A preventive medicine consortium launches a new cancer screening program across several clinics. Adoption spreads through two forces: an intrinsic innovation impulse from proactive communication and clinician leadership, and an imitation force through word-of-mouth and peer influence among clinics. Assume a homogenous population of potential adopters of size $M$, and let $F(t)$ denote the cumulative fraction of adopters by time $t$ (in months). The instantaneous adoption hazard for a non-adopter at time $t$ is the sum of an innovation component with constant rate $p$ and an imitation component with rate $q$ times the already-adopted fraction. Under homogeneity and independence, this implies the differential equation $dF/dt = \\left(p + q F(t)\\right)\\left(1 - F(t)\\right)$ with initial condition $F(0) = 0$. You must derive the analytical form for $F(t)$ from this base and use it to perform nonlinear least squares regression to estimate $p$ and $q$ from cumulative adoption data.\n\nYour program must, for each dataset, estimate $p$ and $q$ using nonlinear regression with positivity constraints ($p > 0$, $q > 0$), taking the observed cumulative adoptions as $N(t_i) = M \\cdot F(t_i)$ at observation times $t_i$. After estimating, classify the diffusion as innovation-driven, imitation-driven, or indeterminate (tie) using the rule:\n- Imitation-driven if $q - p \\ge \\varepsilon$,\n- Innovation-driven if $p - q \\ge \\varepsilon$,\n- Indeterminate if $\\left|p - q\\right| < \\varepsilon$,\nwith $\\varepsilon = 10^{-3}$. Express all estimates $p$ and $q$ as decimals rounded to five places. No percentage symbols are to be used.\n\nPhysical units: time $t$ is measured in months. No other physical units are involved. Angles are not used.\n\nTest suite. Use the following three datasets, each providing the eligible population size $M$, observation times $t$ (in months), and observed cumulative adoptions $N(t)$:\n1. Dataset A (eligible population $M = 10000$), observation times $t \\in \\{1,2,3,4,6,9,12,15\\}$ months, observed cumulative adoptions $N(t)$ given by the sequence $[490, 961, 1411, 1844, 2653, 3740, 4681, 5495]$.\n2. Dataset B (eligible population $M = 5000$), observation times $t \\in \\{1,2,3,4,6,9,12,15\\}$ months, observed cumulative adoptions $N(t)$ given by the sequence $[61, 151, 279, 460, 1033, 2443, 3843, 4597]$.\n3. Dataset C (eligible population $M = 8000$), observation times $t \\in \\{1,2,3,4,6,9,12,15\\}$ months, observed cumulative adoptions $N(t)$ given by the sequence $[240, 480, 718, 956, 1425, 2110, 2762, 3380]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each dataset, output a list of the form $[p\\_\\text{hat}, q\\_\\text{hat}, c]$, where $p\\_\\text{hat}$ and $q\\_\\text{hat}$ are the estimates rounded to five decimal places, and $c$ is the classification code with $0$ for innovation-driven, $1$ for imitation-driven, and $2$ for indeterminate. For example, an output line could look like $[[0.01234,0.05678,1],[0.04500,0.01000,0],[0.03000,0.03000,2]]$.", "solution": "The problem is assessed as **valid**. It is a well-posed and scientifically grounded problem in the field of mathematical modeling of social phenomena. The problem asks for the application of the Bass diffusion model, a standard and well-established model, to analyze adoption data in a preventive medicine context. The givens are complete, the terminology is precise, and the objectives are clear and quantitative. The task involves standard mathematical and statistical procedures: solving a nonlinear ordinary differential equation and performing nonlinear least squares parameter estimation.\n\nThe core of the problem is the Bass diffusion model, which describes the process of how new ideas and products spread through a population. The model's differential equation for the cumulative fraction of adopters, $F(t)$, is given as:\n$$\n\\frac{dF}{dt} = \\left(p + q F(t)\\right)\\left(1 - F(t)\\right)\n$$\nwith the initial condition $F(0) = 0$. Here, $p$ is the coefficient of innovation (external influence) and $q$ is the coefficient of imitation (internal influence).\n\nFirst, we derive the analytical solution for $F(t)$. The given differential equation is separable. We can write:\n$$\n\\frac{dF}{\\left(p + q F\\right)\\left(1 - F\\right)} = dt\n$$\nWe integrate both sides. The left-hand side requires partial fraction decomposition. Let's decompose the fraction:\n$$\n\\frac{1}{\\left(p + qF\\right)\\left(1 - F\\right)} = \\frac{A}{1 - F} + \\frac{B}{p + qF}\n$$\nSolving for the coefficients $A$ and $B$ by equating numerators gives $1 = A(p + qF) + B(1 - F)$.\nThis must hold for all $F$.\nSetting $F=1$ gives $1 = A(p+q)$, so $A = \\frac{1}{p+q}$.\nSetting $F=-p/q$ gives $1 = B(1 - (-p/q)) = B(1+p/q) = B\\frac{p+q}{q}$, so $B = \\frac{q}{p+q}$.\n\nSubstituting the partial fractions back into the integral:\n$$\n\\int \\left( \\frac{1/(p+q)}{1 - F} + \\frac{q/(p+q)}{p + qF} \\right) dF = \\int dt\n$$\nIntegrating from $t=0$ (where $F=0$) to a general time $t$ (where the fraction is $F(t)$):\n$$\n\\frac{1}{p+q} \\left[ \\int_0^{F(t)} \\frac{dF'}{1 - F'} + q \\int_0^{F(t)} \\frac{dF'}{p + qF'} \\right] = \\int_0^t dt'\n$$\n$$\n\\frac{1}{p+q} \\left[ -\\ln(1-F') + \\ln(p+qF') \\right]_0^{F(t)} = t\n$$\n$$\n\\frac{1}{p+q} \\left( \\left( -\\ln(1-F(t)) + \\ln(p+qF(t)) \\right) - \\left( -\\ln(1) + \\ln(p) \\right) \\right) = t\n$$\nUsing $\\ln(1)=0$, we get:\n$$\n\\frac{1}{p+q} \\left( \\ln\\left(\\frac{p+qF(t)}{1-F(t)}\\right) - \\ln(p) \\right) = t\n$$\n$$\n\\ln\\left(\\frac{p+qF(t)}{p(1-F(t))}\\right) = (p+q)t\n$$\nExponentiating both sides:\n$$\n\\frac{p+qF(t)}{p(1-F(t))} = e^{(p+q)t}\n$$\nNow, we solve for $F(t)$:\n$$\np+qF(t) = p(1-F(t))e^{(p+q)t} = pe^{(p+q)t} - pF(t)e^{(p+q)t}\n$$\n$$\nF(t) \\left(q + pe^{(p+q)t}\\right) = p\\left(e^{(p+q)t} - 1\\right)\n$$\n$$\nF(t) = \\frac{p\\left(e^{(p+q)t} - 1\\right)}{q + pe^{(p+q)t}}\n$$\nTo obtain a more standard and numerically stable form, we multiply the numerator and denominator by $e^{-(p+q)t}$:\n$$\nF(t;p,q) = \\frac{p\\left(1 - e^{-(p+q)t}\\right)}{p + qe^{-(p+q)t}}\n$$\nThis is the analytical solution for the cumulative adoption fraction $F(t)$.\n\nFor parameter estimation, we are given datasets comprising observation times $t_i$ and the corresponding cumulative number of adopters $N(t_i)$. The model's prediction for the number of adopters is $N_{pred}(t_i) = M \\cdot F(t_i; p, q)$, where $M$ is the total potential adopter population size. We will use nonlinear least squares (NLLS) to find the parameters $\\hat{p}$ and $\\hat{q}$ that minimize the sum of squared residuals (SSR):\n$$\n\\text{SSR}(p, q) = \\sum_{i} \\left(N(t_i) - M \\cdot F(t_i; p, q)\\right)^2\n$$\nThis optimization is performed subject to the constraints $p > 0$ and $q > 0$. The `scipy.optimize.curve_fit` function is well-suited for this task, as it can perform NLLS with bounds on the parameters.\n\nAfter obtaining the estimates $\\hat{p}$ and $\\hat{q}$ for each dataset, we classify the diffusion process based on the following rules, with a given threshold of $\\varepsilon = 10^{-3}$:\n- **Imitation-driven** (code $1$): if $\\hat{q} - \\hat{p} \\ge \\varepsilon$. This indicates that peer influence is the dominant force.\n- **Innovation-driven** (code $0$): if $\\hat{p} - \\hat{q} \\ge \\varepsilon$. This indicates that proactive communication and external factors are dominant.\n- **Indeterminate** (code $2$): if $|\\hat{p} - \\hat{q}| < \\varepsilon$. The two forces are of comparable strength.\n\nThe implementation will process each dataset by setting up the model function with the corresponding M, performing the NLLS fit using `curve_fit`, and then applying the classification logic. The final results, consisting of the estimated parameters rounded to five decimal places and the classification code, will be formatted into a single output string as specified.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the Bass diffusion model parameter estimation and classification problem.\n    \"\"\"\n    test_cases = [\n        {'M': 10000, 't': [1, 2, 3, 4, 6, 9, 12, 15], 'N': [490, 961, 1411, 1844, 2653, 3740, 4681, 5495]},\n        {'M': 5000, 't': [1, 2, 3, 4, 6, 9, 12, 15], 'N': [61, 151, 279, 460, 1033, 2443, 3843, 4597]},\n        {'M': 8000, 't': [1, 2, 3, 4, 6, 9, 12, 15], 'N': [240, 480, 718, 956, 1425, 2110, 2762, 3380]},\n    ]\n    \n    epsilon = 1e-3\n    all_results = []\n\n    def bass_model_fraction(t, p, q):\n        \"\"\"\n        Calculates the cumulative fraction of adopters F(t) using the Bass model.\n        The form used is F(t) = p*(1 - exp(-(p+q)t)) / (p + q*exp(-(p+q)t)),\n        which is numerically stable for p near zero.\n        \"\"\"\n        val = p + q\n        # Ensure t is a numpy array for vectorized operations\n        t = np.asarray(t, dtype=float)\n        \n        # Handle the case where p+q is extremely small to avoid issues with exp\n        if np.isclose(val, 0):\n            # This is the first-order Taylor approximation F(t) ~ pt, which is accurate when p+q is small.\n            return p * t\n\n        exp_term = np.exp(-val * t)\n        \n        numerator = p * (1 - exp_term)\n        denominator = p + q * exp_term\n\n        # Denominator should not be zero for p>0, q>0 but as a safe guard.\n        # Replace division by zero or NaN with 0.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            F_t = np.true_divide(numerator, denominator)\n            F_t[~np.isfinite(F_t)] = 0\n        \n        return F_t\n\n    for case in test_cases:\n        M = case['M']\n        t_data = np.array(case['t'])\n        N_data = np.array(case['N'])\n\n        def model_to_fit(t, p, q):\n            return M * bass_model_fraction(t, p, q)\n\n        # Initial guesses for p and q.\n        # p can be estimated from the first data point: p ~ (N1/M)/t1\n        p_guess = (N_data[0] / M) / t_data[0] if t_data[0] > 0 else 0.01\n        # q is often larger than p in imitation-driven scenarios.\n        q_guess = 0.1 \n        initial_guesses = [p_guess, q_guess]\n        \n        # Define bounds for parameters: p > 0, q > 0\n        # Use a small positive number to avoid p=0 issues in the model's standard form.\n        bounds = ([1e-9, 1e-9], [np.inf, np.inf])\n\n        try:\n            popt, _ = curve_fit(\n                model_to_fit,\n                t_data,\n                N_data,\n                p0=initial_guesses,\n                bounds=bounds,\n                maxfev=5000 # Increase max iterations for convergence\n            )\n            p_hat, q_hat = popt\n        except RuntimeError:\n            # Fallback in case of non-convergence, though unlikely with these data\n            p_hat, q_hat = 0.0, 0.0\n\n        # Classify the diffusion process\n        diff = q_hat - p_hat\n        if diff >= epsilon:\n            classification = 1  # Imitation-driven\n        elif -diff >= epsilon: # same as p_hat - q_hat >= epsilon\n            classification = 0  # Innovation-driven\n        else: # |p_hat - q_hat|  epsilon\n            classification = 2  # Indeterminate\n\n        all_results.append([p_hat, q_hat, classification])\n\n    # Format the final output string as per specifications\n    # Each p, q must be a decimal rounded to five places.\n    result_strings = []\n    for p_val, q_val, c_val in all_results:\n        result_strings.append(f\"[{p_val:.5f},{q_val:.5f},{c_val}]\")\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "4520340"}]}