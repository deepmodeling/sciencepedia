{"hands_on_practices": [{"introduction": "A cornerstone of public health genomics is understanding that a genetic test result rarely provides a definitive \"yes\" or \"no\" answer. Instead, it adjusts an individual's pre-existing risk. This first practice problem demonstrates this crucial concept by using Bayes' theorem to calculate how a positive polygenic risk score (PRS) modifies a person's lifetime risk for a complex disease, a fundamental skill for interpreting modern genomic information [@problem_id:4564872].", "problem": "A public health genomics program is evaluating a binary polygenic risk score (PRS) threshold to identify individuals at elevated lifetime risk for a common complex disease by age $75$. In the target population, the baseline lifetime risk of the disease by age $75$ is $0.05$. At the chosen threshold, validation studies in a cohort representative of the target population show a true positive rate of $0.40$ and a false positive rate of $0.10$. A randomly selected individual from the target population tests positive at this PRS threshold.\n\nUsing only the definitions of conditional probability, odds, and likelihood ratios, and assuming the validation metrics apply to the target population without spectrum bias, determine the individual’s posterior probability of developing the disease by age $75$ given the positive test. Express your final answer as a decimal, rounded to four significant figures. Do not use a percentage sign.", "solution": "The problem requires the calculation of the posterior probability that an individual will develop a disease, given a positive result from a polygenic risk score (PRS) test. This is an application of Bayesian inference, and the solution will adhere to the constraint of using the definitions of odds and likelihood ratios.\n\nLet $D$ denote the event that a randomly selected individual from the target population develops the disease by age $75$. The complement, $D^c$, is the event that the individual does not develop the disease. Let $T^+$ denote the event that the individual receives a positive test result.\n\nThe problem provides the following information:\n1.  The prior probability of developing the disease (baseline lifetime risk): $P(D) = 0.05$.\n2.  The true positive rate (sensitivity): the probability of a positive test given the individual will develop the disease, $P(T^+|D) = 0.40$.\n3.  The false positive rate: the probability of a positive test given the individual will not develop the disease, $P(T^+|D^c) = 0.10$.\n\nOur goal is to compute the posterior probability, $P(D|T^+)$.\n\nFirst, we determine the prior odds of developing the disease. The odds of an event are defined as the ratio of the probability of the event occurring to the probability of the event not occurring. The prior probability of not developing the disease is $P(D^c) = 1 - P(D) = 1 - 0.05 = 0.95$.\nThe prior odds are therefore:\n$$Odds(D) = \\frac{P(D)}{P(D^c)} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}$$\n\nNext, we compute the likelihood ratio for a positive test result, denoted $LR(+)$. The likelihood ratio is the ratio of the probability of a test result in those with the condition to the probability of the same result in those without the condition.\n$$LR(+) = \\frac{P(T^+|D)}{P(T^+|D^c)}$$\nUsing the given values for the true positive rate and false positive rate:\n$$LR(+) = \\frac{0.40}{0.10} = 4$$\nA positive test result is $4$ times more likely in an individual who will develop the disease compared to one who will not.\n\nThe relationship between prior odds, posterior odds, and the likelihood ratio is a formulation of Bayes' theorem:\n$$Posterior \\: Odds = Prior \\: Odds \\times Likelihood \\: Ratio$$\nIn terms of our defined events, this is written as:\n$$Odds(D|T^+) = Odds(D) \\times LR(+)$$\nHere, $Odds(D|T^+)$ represents the odds of having the disease after receiving a positive test result. Substituting the calculated values for prior odds and the likelihood ratio:\n$$Odds(D|T^+) = \\frac{1}{19} \\times 4 = \\frac{4}{19}$$\n\nFinally, the posterior odds must be converted back into a probability. The probability of an event $A$ can be calculated from its odds, $Odds(A)$, using the formula $P(A) = \\frac{Odds(A)}{1 + Odds(A)}$.\nApplying this to the posterior odds:\n$$P(D|T^+) = \\frac{Odds(D|T^+)}{1 + Odds(D|T^+)} = \\frac{\\frac{4}{19}}{1 + \\frac{4}{19}}$$\nTo simplify this complex fraction:\n$$P(D|T^+) = \\frac{\\frac{4}{19}}{\\frac{19}{19} + \\frac{4}{19}} = \\frac{\\frac{4}{19}}{\\frac{23}{19}} = \\frac{4}{23}$$\n\nThe problem asks for the final answer to be expressed as a decimal rounded to four significant figures. We perform the division:\n$$P(D|T^+) = \\frac{4}{23} \\approx 0.17391304...$$\nRounding to four significant figures yields the final value.", "answer": "$$\\boxed{0.1739}$$", "id": "4564872"}, {"introduction": "Expanding from individual risk to population-level screening, the effectiveness of a program depends heavily on the prevalence of the condition it targets. This exercise bridges the gap between population genetics and public health practice. By applying the Hardy-Weinberg equilibrium principle, you will determine genotype frequencies in a population and then use these to calculate the Positive Predictive Value (PPV) of a newborn screening test, a critical metric for assessing its real-world utility [@problem_id:4564890].", "problem": "A public health program evaluates a newborn screening assay for an autosomal recessive metabolic disorder caused by a pathogenic allele $a$ at a bi-allelic locus with alleles $A$ and $a$. The population is large, undergoes random mating, and experiences no selection, mutation, or migration. Under these conditions, assume Hardy–Weinberg equilibrium holds. The population allele frequency of $A$ is $p$, so the allele frequency of $a$ is $q=1-p$. By first principles of Mendelian inheritance under random mating, derive the genotype frequencies for $AA$, $Aa$, and $aa$ in terms of $p$ and $q$.\n\nThe screening assay yields a positive result with probability $s$ for truly affected newborns with genotype $aa$, with probability $r$ for carriers with genotype $Aa$ (due to occasional borderline enzyme activity), and with probability $f$ for non-carriers with genotype $AA$ (false positives). The program applies the test to the entire newborn population. Using the derived genotype frequencies, construct the expression for the positive predictive value, defined as the probability that a randomly selected positive screen is truly affected, that is, the positive predictive value (PPV) equals $\\mathbb{P}(aa \\mid \\text{positive})$.\n\nEvaluate this PPV for $p=0.972$, $s=0.95$, $r=0.02$, and $f=0.001$. Express your final numerical answer as a decimal and round to four significant figures.", "solution": "The fundamental base is the Hardy–Weinberg equilibrium, which follows from the core assumptions of random mating, a large population, and the absence of evolutionary forces such as selection, mutation, and migration. Under Mendelian inheritance with two alleles $A$ and $a$ at a locus, the frequency of an allele in gametes equals the allele frequency in the population. The probability that a zygote is of a given genotype is the product of the probabilities of drawing the corresponding alleles from the two parental gamete pools.\n\nLet the allele frequencies be $p$ for $A$ and $q$ for $a$, with $q=1-p$. Then:\n- The probability that a newborn is genotype $AA$ is the probability of drawing $A$ from both gametes, which is $p \\times p = p^{2}$.\n- The probability that a newborn is genotype $Aa$ (or $aA$) is the probability of drawing one $A$ and one $a$ in either order, which is $p \\times q + q \\times p = 2pq$.\n- The probability that a newborn is genotype $aa$ is the probability of drawing $a$ from both gametes, which is $q \\times q = q^{2}$.\n\nThus, under Hardy–Weinberg equilibrium, the genotype frequencies are $p^{2}$ for $AA$, $2pq$ for $Aa$, and $q^{2}$ for $aa$.\n\nWe are asked to compute the positive predictive value (PPV), defined as the conditional probability $\\mathbb{P}(aa \\mid \\text{positive})$. By Bayes' rule and the law of total probability over genotypes,\n$$\n\\mathbb{P}(aa \\mid \\text{positive}) \\;=\\; \\frac{\\mathbb{P}(\\text{positive} \\mid aa)\\,\\mathbb{P}(aa)}{\\mathbb{P}(\\text{positive})}\n\\;=\\; \\frac{s \\cdot q^{2}}{s \\cdot q^{2} + r \\cdot (2pq) + f \\cdot p^{2}}.\n$$\nThis expression uses that the probability of a positive test given genotype $aa$ is $s$, given $Aa$ is $r$, and given $AA$ is $f$, and weights by the genotype frequencies.\n\nWe now evaluate this expression for the given parameter values $p=0.972$, $s=0.95$, $r=0.02$, and $f=0.001$. First compute $q$:\n$$\nq \\;=\\; 1 - p \\;=\\; 1 - 0.972 \\;=\\; 0.028.\n$$\nNext compute the Hardy–Weinberg genotype frequencies:\n$$\np^{2} \\;=\\; (0.972)^{2} \\;=\\; 0.944784, \\quad\n2pq \\;=\\; 2 \\cdot 0.972 \\cdot 0.028 \\;=\\; 0.054432, \\quad\nq^{2} \\;=\\; (0.028)^{2} \\;=\\; 0.000784.\n$$\nCompute each contribution to the overall positive probability:\n- Affected ($aa$): $s \\cdot q^{2} \\;=\\; 0.95 \\cdot 0.000784 \\;=\\; 0.0007448$.\n- Carrier ($Aa$): $r \\cdot 2pq \\;=\\; 0.02 \\cdot 0.054432 \\;=\\; 0.00108864$.\n- Non-carrier ($AA$): $f \\cdot p^{2} \\;=\\; 0.001 \\cdot 0.944784 \\;=\\; 0.000944784$.\n\nSum to obtain $\\mathbb{P}(\\text{positive})$:\n$$\n\\mathbb{P}(\\text{positive}) \\;=\\; 0.0007448 + 0.00108864 + 0.000944784 \\;=\\; 0.002778224.\n$$\nTherefore, the PPV is\n$$\n\\text{PPV} \\;=\\; \\frac{0.0007448}{0.002778224} \\;\\approx\\; 0.2680849.\n$$\nRounded to four significant figures and expressed as a decimal, the PPV is $0.2681$.", "answer": "$$\\boxed{0.2681}$$", "id": "4564890"}, {"introduction": "Effective public health programs often require sophisticated strategies that go beyond simple screening. This final problem challenges you to model the expected yield of cascade screening, a proactive approach where relatives of a diagnosed individual are systematically tested. You will build a comprehensive model that integrates principles of Mendelian inheritance, the probability of spontaneous mutations, and real-world behavioral factors like testing uptake to predict the success of this advanced genomic health initiative [@problem_id:4564863].", "problem": "A public health genomics program implements cascade screening for autosomal dominant genetic conditions to identify additional carriers among relatives of an index case (the proband). Assume the proband carries a heterozygous pathogenic variant in an autosomal dominant gene. Let the probability that the proband’s variant arose de novo (not inherited from either parent) be $d$, where $0 \\leq d \\leq 1$. The cascade screening is offered only to first-degree relatives and uses a variant-specific genetic test with analytic sensitivity $s$, where $0 \\leq s \\leq 1$.\n\nDefine the family structure and uptake as follows:\n- $N_{\\mathrm{par}}$: the number of living parents eligible for testing.\n- $N_{\\mathrm{sib}}$: the number of living full siblings eligible for testing.\n- $N_{\\mathrm{child}}$: the number of living biological children eligible for testing.\n- $u_{\\mathrm{par}}$: the net probability that any given parent is contacted, consents, and completes testing.\n- $u_{\\mathrm{sib}}$: the net probability that any given sibling is contacted, consents, and completes testing.\n- $u_{\\mathrm{child}}$: the net probability that any given child is contacted, consents, and completes testing.\n\nAssume:\n- Mendelian inheritance for autosomal dominant heterozygous variants applies, with each child of a heterozygous carrier having probability $\\frac{1}{2}$ of inheriting the variant.\n- If the proband’s variant is de novo (with probability $d$), then neither parent carries the variant, and siblings are assumed to have negligible risk (take this as $0$). If the proband’s variant is inherited (with probability $1-d$), then exactly one parent carries the variant, and each sibling has probability $\\frac{1}{2}$ of carrying the variant.\n- For parents, conditional on inherited origin, each individual parent has probability $\\frac{1}{2}$ of being the transmitting parent.\n- Independence across relatives for testing uptake and test performance, and that uptake and test sensitivity are independent of carrier status.\n\nUsing only these assumptions and the rules of probability, derive a single closed-form analytic expression for the expected number of newly identified carriers per proband, $Y$, when cascade screening is offered to parents, siblings, and children. Express $Y$ in terms of $N_{\\mathrm{par}}$, $N_{\\mathrm{sib}}$, $N_{\\mathrm{child}}$, $u_{\\mathrm{par}}$, $u_{\\mathrm{sib}}$, $u_{\\mathrm{child}}$, $s$, and $d$. No numerical evaluation or rounding is required. The final answer must be a single analytic expression without units.", "solution": "The problem requires the derivation of a closed-form expression for the expected number of newly identified carriers, denoted by $Y$, resulting from a cascade screening program. The total expected number of identified carriers is the sum of the expected numbers from each group of first-degree relatives: parents, siblings, and children. By the linearity of expectation, we can write:\n$$Y = E[\\text{total carriers}] = E[\\text{carriers from parents}] + E[\\text{carriers from siblings}] + E[\\text{carriers from children}]$$\nWe will calculate the expected number for each group of relatives separately. Let $Y_{\\mathrm{par}}$, $Y_{\\mathrm{sib}}$, and $Y_{\\mathrm{child}}$ represent the random variables for the number of identified carriers in each respective group. Our goal is to find $Y = E[Y_{\\mathrm{par}}] + E[Y_{\\mathrm{sib}}] + E[Y_{\\mathrm{child}}]$.\n\nLet us first determine the expected number of carriers identified among the proband's children, $E[Y_{\\mathrm{child}}]$. The proband is a known heterozygous carrier. According to Mendelian inheritance for an autosomal dominant condition, each biological child of the proband has a probability of $\\frac{1}{2}$ of inheriting the pathogenic variant. The identification of a carrier child requires three independent events to occur: the child must be a carrier, the child must be tested, and the test must yield a positive result.\nThe probability that a specific child is a carrier is $P(\\text{carrier}) = \\frac{1}{2}$.\nThe probability that a specific child is tested is given by the uptake probability, $u_{\\mathrm{child}}$.\nThe probability that the test is positive for a carrier is the analytic sensitivity, $s$.\nTherefore, the probability of identifying any single child as a carrier is the product of these probabilities:\n$$P(\\text{child identified}) = P(\\text{carrier}) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{child}} \\cdot s$$\nThere are $N_{\\mathrm{child}}$ children. Since the identification of each child is an independent event, the total expected number of identified carriers among children is the sum of the individual expectations. For each child $i$, let $I_i$ be the indicator variable that the child is identified. $E[I_i] = P(\\text{child identified})$.\n$$E[Y_{\\mathrm{child}}] = \\sum_{i=1}^{N_{\\mathrm{child}}} E[I_i] = \\sum_{i=1}^{N_{\\mathrm{child}}} \\left(\\frac{1}{2} u_{\\mathrm{child}} s\\right) = N_{\\mathrm{child}} \\frac{1}{2} u_{\\mathrm{child}} s$$\nThis expectation is independent of a de novo origin because the proband's carrier status is the starting point.\n\nNext, we calculate the expected number of carriers identified among parents, $E[Y_{\\mathrm{par}}]$, and siblings, $E[Y_{\\mathrm{sib}}]$. The carrier status of these relatives depends on whether the proband's variant was inherited or arose de novo. We use the law of total expectation, conditioning on the origin of the variant. Let $I$ be the event that the variant was inherited, and $D$ be the event that it was de novo. We are given $P(D) = d$ and $P(I) = 1-d$.\n\nFor the parents, the expected number of identified carriers is:\n$$E[Y_{\\mathrm{par}}] = E[Y_{\\mathrm{par}} | I] P(I) + E[Y_{\\mathrm{par}} | D] P(D)$$\nIf the variant arose de novo (event $D$), neither parent carries the variant. Therefore, the number of carriers identified among them is zero: $E[Y_{\\mathrm{par}} | D] = 0$.\nIf the variant was inherited (event $I$), exactly one parent is a carrier. For any given parent of the proband, the probability of being the carrier parent is $\\frac{1}{2}$. The probability of identifying a specific parent as a carrier, conditional on the variant being inherited, is:\n$$P(\\text{parent identified} | I) = P(\\text{parent is carrier} | I) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{par}} \\cdot s$$\nThe total expected number of identified carriers among the $N_{\\mathrm{par}}$ parents, given inheritance, is the sum of individual expectations:\n$$E[Y_{\\mathrm{par}} | I] = \\sum_{j=1}^{N_{\\mathrm{par}}} P(\\text{parent } j \\text{ identified} | I) = N_{\\mathrm{par}} \\frac{1}{2} u_{\\mathrm{par}} s$$\nSubstituting back into the law of total expectation for parents:\n$$E[Y_{\\mathrm{par}}] = \\left(N_{\\mathrm{par}} \\frac{1}{2} u_{\\mathrm{par}} s\\right)(1-d) + (0)(d) = \\frac{1}{2} N_{\\mathrm{par}} u_{\\mathrm{par}} s (1-d)$$\n\nFor the siblings, we follow the same logic:\n$$E[Y_{\\mathrm{sib}}] = E[Y_{\\mathrm{sib}} | I] P(I) + E[Y_{\\mathrm{sib}} | D] P(D)$$\nIf the variant arose de novo (event $D$), siblings do not carry the variant, so $E[Y_{\\mathrm{sib}} | D] = 0$.\nIf the variant was inherited (event $I$), the proband inherited it from a carrier parent. Each full sibling of the proband has the same parents and thus has a $\\frac{1}{2}$ chance of inheriting the variant from that carrier parent. The probability of identifying a specific sibling as a carrier, conditional on the proband's variant being inherited, is:\n$$P(\\text{sibling identified} | I) = P(\\text{sibling is carrier} | I) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{sib}} \\cdot s$$\nThe total expected number of identified carriers among the $N_{\\mathrm{sib}}$ siblings, given inheritance, is:\n$$E[Y_{\\mathrm{sib}} | I] = \\sum_{k=1}^{N_{\\mathrm{sib}}} P(\\text{sibling } k \\text{ identified} | I) = N_{\\mathrm{sib}} \\frac{1}{2} u_{\\mathrm{sib}} s$$\nSubstituting back into the law of total expectation for siblings:\n$$E[Y_{\\mathrm{sib}}] = \\left(N_{\\mathrm{sib}} \\frac{1}{2} u_{\\mathrm{sib}} s\\right)(1-d) + (0)(d) = \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} s (1-d)$$\n\nFinally, we sum the expected values for all three groups of relatives to find the total expected number of newly identified carriers, $Y$:\n$$Y = E[Y_{\\mathrm{par}}] + E[Y_{\\mathrm{sib}}] + E[Y_{\\mathrm{child}}]$$\n$$Y = \\frac{1}{2} N_{\\mathrm{par}} u_{\\mathrm{par}} s (1-d) + \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} s (1-d) + \\frac{1}{2} N_{\\mathrm{child}} u_{\\mathrm{child}} s$$\nTo present this as a single closed-form expression, we can factor out common terms:\n$$Y = \\frac{1}{2}s \\left[ N_{\\mathrm{par}} u_{\\mathrm{par}} (1-d) + N_{\\mathrm{sib}} u_{\\mathrm{sib}} (1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]$$\n$$Y = \\frac{s}{2} \\left[ (N_{\\mathrm{par}} u_{\\mathrm{par}} + N_{\\mathrm{sib}} u_{\\mathrm{sib}})(1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]$$\nThis expression represents the expected diagnostic yield of the cascade screening program per index case.", "answer": "$$\\boxed{\\frac{s}{2} \\left[ (N_{\\mathrm{par}} u_{\\mathrm{par}} + N_{\\mathrm{sib}} u_{\\mathrm{sib}})(1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]}$$", "id": "4564863"}]}