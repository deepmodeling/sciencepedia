{"hands_on_practices": [{"introduction": "Automated identification systems like MALDI-TOF MS rely on precise physical measurements. This technology identifies microbes by creating a 'fingerprint' based on the masses of their proteins. This exercise explores the fundamental concept of mass accuracy, demonstrating how a small, systematic calibration error—measured in parts per million (ppm)—can affect the system's ability to match a measured protein mass to its reference database [@problem_id:5208469]. By calculating the impact of this error, you will gain a concrete understanding of an instrument's physical limitations and its direct consequences on diagnostic accuracy.", "problem": "An automated microbial identification system based on Matrix-Assisted Laser Desorption/Ionization Time-of-Flight Mass Spectrometry (MALDI-TOF MS) generates a fingerprint consisting of prominent ion peaks predominantly corresponding to intact ribosomal proteins across the mass range $[2, 20]\\,\\mathrm{kDa}$. Assume the following:\n\n- A systematic mass calibration error produces a constant relative mass shift of $50\\,\\mathrm{ppm}$ across the entire mass range. By definition, parts per million (ppm) error means a relative error of $50 \\times 10^{-6}$.\n- The matching algorithm declares a peak correctly matched to the reference library if its absolute mass deviation is within an absolute tolerance window of $\\pm 0.3\\,\\mathrm{Da}$.\n- Fingerprint peaks are uniformly distributed in mass over $[2, 20]\\,\\mathrm{kDa}$.\n- Define matching accuracy as the fraction of peaks in $[2, 20]\\,\\mathrm{kDa}$ that satisfy the matching criterion under the $50\\,\\mathrm{ppm}$ systematic calibration error.\n\nUsing only the above definitions and assumptions, compute the matching accuracy as a single real number. Express your final answer as a dimensionless decimal and round your answer to four significant figures.", "solution": "The user has provided a problem to be solved, and my first responsibility is to validate its integrity.\n\n### Step 1: Extract Givens\nThe problem statement provides the following data and definitions:\n- **Mass Range:** The system analyzes peaks in the mass range $[2, 20]\\,\\mathrm{kDa}$.\n- **Systematic Error:** A constant relative mass shift of $\\delta = 50\\,\\mathrm{ppm}$.\n- **Definition of ppm Error:** The relative error is explicitly defined as $50 \\times 10^{-6}$.\n- **Matching Criterion:** A peak is considered matched if its absolute mass deviation is within a tolerance window of $\\pm T$, where $T = 0.3\\,\\mathrm{Da}$.\n- **Peak Distribution:** The fingerprint peaks are uniformly distributed in mass over the interval $[2, 20]\\,\\mathrm{kDa}$.\n- **Definition of Matching Accuracy:** The fraction of peaks in the specified mass range that satisfy the matching criterion.\n- **Required Output:** A single real number for the matching accuracy, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a validation check.\n- **Scientifically Grounded:** The problem is grounded in the principles of mass spectrometry, specifically MALDI-TOF MS, a standard technique in analytical chemistry and microbiology. The parameters given—mass range for ribosomal proteins, ppm error for mass accuracy, and Dalton-level tolerance—are realistic for this type of instrumentation. The problem is a valid, albeit simplified, model of instrument performance assessment.\n- **Well-Posed:** The problem is well-posed. It provides all necessary information: the mass range, the nature and magnitude of the systematic error, the matching tolerance, and the distribution of the variable (mass). This allows for the calculation of a unique, stable, and meaningful solution for the matching accuracy.\n- **Objective:** The language is technical and devoid of subjectivity. All terms are defined quantitatively.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradictions, or ambiguity. It is a formalizable physics and statistics problem.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. I will proceed with a full solution.\n\n### Solution Derivation\n\nLet $m$ be the true mass of a protein peak. The problem states the mass range of interest is $[2, 20]\\,\\mathrm{kDa}$. It is convenient to work with a single unit of mass, the Dalton ($\\mathrm{Da}$), where $1\\,\\mathrm{kDa} = 1000\\,\\mathrm{Da}$. Therefore, the mass range is $[2000, 20000]\\,\\mathrm{Da}$. Let the lower and upper bounds of this range be $m_{min} = 2000\\,\\mathrm{Da}$ and $m_{max} = 20000\\,\\mathrm{Da}$, respectively.\n\nThe system introduces a constant relative mass shift, $\\delta$. The value is given as $50\\,\\mathrm{ppm}$, which is defined as:\n$$ \\delta = 50 \\times 10^{-6} $$\n\nFor a true mass $m$, the observed mass $m_{obs}$ will be shifted. The absolute mass deviation, $\\Delta m$, is the absolute difference between the observed mass and the true mass:\n$$ \\Delta m = |m_{obs} - m| $$\nGiven a relative error $\\delta$, the observed mass is $m_{obs} = m(1 \\pm \\delta)$. The problem phrasing \"mass shift\" implies a directional error, but the matching criterion is based on \"absolute mass deviation,\" so the sign of the shift is immaterial to the magnitude of the deviation. The deviation is:\n$$ \\Delta m = |m(1+\\delta) - m| = |m\\delta| $$\nSince mass $m$ and the relative error factor $\\delta$ are positive quantities, we can write:\n$$ \\Delta m = m\\delta $$\nThis equation shows that the absolute mass deviation is not constant but increases linearly with the mass $m$.\n\nA peak is correctly matched if its absolute mass deviation is within the specified tolerance window. Let the tolerance be $T = 0.3\\,\\mathrm{Da}$. The matching criterion is:\n$$ \\Delta m \\le T $$\nSubstituting the expression for $\\Delta m$, the condition for a successful match becomes:\n$$ m\\delta \\le T $$\n\nThis inequality defines the range of masses for which a peak will be correctly identified. We can solve for the maximum mass, let's call it $m_{crit}$, for which the matching criterion is met. At this critical mass, the deviation is exactly equal to the tolerance:\n$$ m_{crit}\\delta = T $$\nSolving for $m_{crit}$:\n$$ m_{crit} = \\frac{T}{\\delta} $$\nSubstituting the given values:\n$$ m_{crit} = \\frac{0.3\\,\\mathrm{Da}}{50 \\times 10^{-6}} = \\frac{0.3}{5 \\times 10^{-5}} = \\frac{3 \\times 10^{-1}}{5 \\times 10^{-5}} = 0.6 \\times 10^{4}\\,\\mathrm{Da} = 6000\\,\\mathrm{Da} $$\n\nAny peak with a mass $m \\le m_{crit}$ will satisfy the matching criterion ($m\\delta \\le T$), and any peak with a mass $m  m_{crit}$ will fail it. The mass range for successfully matched peaks, within the instrument's operating range of $[m_{min}, m_{max}]$, is therefore $[m_{min}, m_{crit}]$, since $m_{min} = 2000\\,\\mathrm{Da}  m_{crit} = 6000\\,\\mathrm{Da}$ and $m_{max} = 20000\\,\\mathrm{Da}  m_{crit}$.\nThe specific interval of successful matching is $[2000, 6000]\\,\\mathrm{Da}$.\n\nThe problem defines matching accuracy as the fraction of peaks that are correctly matched. It is stated that the peaks are uniformly distributed in mass over the entire range $[m_{min}, m_{max}]$. For a uniform distribution, this fraction is equivalent to the ratio of the length of the \"matched\" mass interval to the length of the total mass interval.\n\nLength of the total mass interval, $L_{total}$:\n$$ L_{total} = m_{max} - m_{min} = 20000\\,\\mathrm{Da} - 2000\\,\\mathrm{Da} = 18000\\,\\mathrm{Da} $$\n\nLength of the successfully matched mass interval, $L_{matched}$:\n$$ L_{matched} = m_{crit} - m_{min} = 6000\\,\\mathrm{Da} - 2000\\,\\mathrm{Da} = 4000\\,\\mathrm{Da} $$\n\nThe matching accuracy, which we denote as $A$, is the ratio:\n$$ A = \\frac{L_{matched}}{L_{total}} = \\frac{4000}{18000} = \\frac{4}{18} = \\frac{2}{9} $$\n\nTo provide the final answer, we must express this fraction as a decimal rounded to four significant figures.\n$$ A = \\frac{2}{9} = 0.22222... $$\nRounding to four significant figures gives $0.2222$.", "answer": "$$ \\boxed{0.2222} $$", "id": "5208469"}, {"introduction": "Beyond physical measurements, automated systems employ sophisticated algorithms to interpret data. This practice delves into the probabilistic logic at the heart of many biochemical identification systems. Using a hypothetical scenario, you will apply Bayes' theorem to determine the most probable microbial species based on a pattern of metabolic reactions [@problem_id:5208490]. This exercise demystifies the decision-making process, showing how these systems weigh evidence to arrive at a conclusion.", "problem": "An automated microbial identification system evaluates a panel of $20$ biochemical wells, each producing a binary reaction outcome $R_{i} \\in \\{0,1\\}$, where $1$ denotes a positive reaction and $0$ denotes a negative reaction. Assume that, conditional on the microbial species $S \\in \\{1,2,3\\}$, the wells are conditionally independent and each well has a species-specific probability of positivity. The identification engine uses maximum a posteriori (MAP) estimation based on Bayes’ theorem. The prior probabilities of species are $P(S=1)=0.5$, $P(S=2)=0.3$, and $P(S=3)=0.2$.\n\nThe $20$ wells are partitioned into four biochemically coherent groups with identical conditional positivity probabilities within each group for a given species:\n- Group $\\mathcal{C}$ (carbohydrate utilization): wells $1$–$5$.\n- Group $\\mathcal{D}$ (amino acid decarboxylases): wells $6$–$12$.\n- Group $\\mathcal{E}$ (enzyme activities): wells $13$–$15$.\n- Group $\\mathcal{M}$ (miscellaneous reactions): wells $16$–$20$.\n\nFor each species $s \\in \\{1,2,3\\}$ and group $G \\in \\{\\mathcal{C},\\mathcal{D},\\mathcal{E},\\mathcal{M}\\}$, the conditional probability of a positive reaction in any well of that group is $p_{G|s}$, given by:\n- $p_{\\mathcal{C}|1}=0.9$, $p_{\\mathcal{C}|2}=0.6$, $p_{\\mathcal{C}|3}=0.3$.\n- $p_{\\mathcal{D}|1}=0.2$, $p_{\\mathcal{D}|2}=0.7$, $p_{\\mathcal{D}|3}=0.4$.\n- $p_{\\mathcal{E}|1}=0.95$, $p_{\\mathcal{E}|2}=0.5$, $p_{\\mathcal{E}|3}=0.8$.\n- $p_{\\mathcal{M}|1}=0.4$, $p_{\\mathcal{M}|2}=0.3$, $p_{\\mathcal{M}|3}=0.6$.\n\nA specimen yields the following observed reaction vector $\\mathbf{r}=(r_{1},\\dots,r_{20})$:\n- Wells $1$–$5$: $\\{1,1,1,1,0\\}$.\n- Wells $6$–$12$: $\\{1,0,0,1,0,0,0\\}$.\n- Wells $13$–$15$: $\\{1,1,1\\}$.\n- Wells $16$–$20$: $\\{0,0,0,1,0\\}$.\n\nUsing Bayes’ theorem and the conditional independence assumption across wells, compute the maximum a posteriori species assignment. Express your final answer as the species index $s^{*} \\in \\{1,2,3\\}$. No rounding is required.", "solution": "The problem requires the determination of the maximum a posteriori (MAP) species assignment for a given set of biochemical reaction outcomes. The MAP estimate $s^{*}$ for the species $S$ is the value of $s \\in \\{1,2,3\\}$ that maximizes the posterior probability $P(S=s | \\mathbf{R}=\\mathbf{r})$, where $\\mathbf{r}$ is the observed reaction vector.\n\nAccording to Bayes’ theorem, the posterior probability is given by:\n$$\nP(S=s | \\mathbf{R}=\\mathbf{r}) = \\frac{P(\\mathbf{R}=\\mathbf{r} | S=s) P(S=s)}{P(\\mathbf{R}=\\mathbf{r})}\n$$\nThe denominator, $P(\\mathbf{R}=\\mathbf{r})$, is the marginal probability of observing the data, which is constant for all species $s$. Therefore, to find the species that maximizes the posterior probability, we only need to maximize the numerator, which is proportional to the posterior. Let us define a score for each species $s$, $\\text{Score}(s)$, as this numerator:\n$$\n\\text{Score}(s) = P(\\mathbf{R}=\\mathbf{r} | S=s) P(S=s)\n$$\nThe MAP estimate is then $s^{*} = \\arg\\max_{s \\in \\{1,2,3\\}} \\text{Score}(s)$.\n\nThe term $P(\\mathbf{R}=\\mathbf{r} | S=s)$ is the likelihood of observing the reaction vector $\\mathbf{r}$ given the species $s$. The problem states that the $20$ biochemical wells are conditionally independent, given the species $S$. Thus, the likelihood is the product of the probabilities of the individual reaction outcomes:\n$$\nP(\\mathbf{R}=\\mathbf{r} | S=s) = \\prod_{i=1}^{20} P(R_i=r_i | S=s)\n$$\nThe wells are partitioned into four groups, $\\mathcal{C}, \\mathcal{D}, \\mathcal{E}, \\mathcal{M}$, with sizes $n_{\\mathcal{C}}=5$, $n_{\\mathcal{D}}=7$, $n_{\\mathcal{E}}=3$, and $n_{\\mathcal{M}}=5$, respectively. Within each group $G$, the conditional probability of a positive reaction, $P(R_i=1 | S=s)$, is constant and denoted by $p_{G|s}$. The probability of a negative reaction is $P(R_i=0 | S=s) = 1 - p_{G|s}$.\n\nLet $k_G$ be the number of positive reactions observed in group $G$. The contribution of group $G$ to the total likelihood is $p_{G|s}^{k_G} (1 - p_{G|s})^{n_G - k_G}$. The total likelihood $L(s) = P(\\mathbf{R}=\\mathbf{r} | S=s)$ is the product of these contributions:\n$$\nL(s) = \\left( p_{\\mathcal{C}|s}^{k_{\\mathcal{C}}} (1-p_{\\mathcal{C}|s})^{n_{\\mathcal{C}} - k_{\\mathcal{C}}} \\right) \\left( p_{\\mathcal{D}|s}^{k_{\\mathcal{D}}} (1-p_{\\mathcal{D}|s})^{n_{\\mathcal{D}} - k_{\\mathcal{D}}} \\right) \\left( p_{\\mathcal{E}|s}^{k_{\\mathcal{E}}} (1-p_{\\mathcal{E}|s})^{n_{\\mathcal{E}} - k_{\\mathcal{E}}} \\right) \\left( p_{\\mathcal{M}|s}^{k_{\\mathcal{M}}} (1-p_{\\mathcal{M}|s})^{n_{\\mathcal{M}} - k_{\\mathcal{M}}} \\right)\n$$\nFrom the observed reaction vector $\\mathbf{r}$:\n-   Group $\\mathcal{C}$ (wells $1$–$5$): $\\{1,1,1,1,0\\}$. Thus, $k_{\\mathcal{C}}=4$ and $n_{\\mathcal{C}}-k_{\\mathcal{C}}=1$.\n-   Group $\\mathcal{D}$ (wells $6$–$12$): $\\{1,0,0,1,0,0,0\\}$. Thus, $k_{\\mathcal{D}}=2$ and $n_{\\mathcal{D}}-k_{\\mathcal{D}}=5$.\n-   Group $\\mathcal{E}$ (wells $13$–$15$): $\\{1,1,1\\}$. Thus, $k_{\\mathcal{E}}=3$ and $n_{\\mathcal{E}}-k_{\\mathcal{E}}=0$.\n-   Group $\\mathcal{M}$ (wells $16$–$20$): $\\{0,0,0,1,0\\}$. Thus, $k_{\\mathcal{M}}=1$ and $n_{\\mathcal{M}}-k_{\\mathcal{M}}=4$.\n\nWe now compute the score for each species.\n\nFor species $S=1$:\nThe prior is $P(S=1)=0.5$. The conditional probabilities are $p_{\\mathcal{C}|1}=0.9$, $p_{\\mathcal{D}|1}=0.2$, $p_{\\mathcal{E}|1}=0.95$, and $p_{\\mathcal{M}|1}=0.4$.\nThe likelihood is:\n$L(1) = (0.9^{4} \\cdot (1-0.9)^{1}) \\cdot (0.2^{2} \\cdot (1-0.2)^{5}) \\cdot (0.95^{3} \\cdot (1-0.95)^{0}) \\cdot (0.4^{1} \\cdot (1-0.4)^{4})$\n$L(1) = (0.9^{4} \\cdot 0.1^{1}) \\cdot (0.2^{2} \\cdot 0.8^{5}) \\cdot (0.95^{3} \\cdot 0.05^{0}) \\cdot (0.4^{1} \\cdot 0.6^{4})$\n$L(1) = (0.6561 \\cdot 0.1) \\cdot (0.04 \\cdot 0.32768) \\cdot (0.857375 \\cdot 1) \\cdot (0.4 \\cdot 0.1296)$\n$L(1) = (0.06561) \\cdot (0.0131072) \\cdot (0.857375) \\cdot (0.05184)$\n$L(1) \\approx 3.82216 \\times 10^{-5}$\nThe score is:\n$\\text{Score}(1) = L(1) \\cdot P(S=1) \\approx (3.82216 \\times 10^{-5}) \\cdot 0.5 = 1.91108 \\times 10^{-5}$\n\nFor species $S=2$:\nThe prior is $P(S=2)=0.3$. The conditional probabilities are $p_{\\mathcal{C}|2}=0.6$, $p_{\\mathcal{D}|2}=0.7$, $p_{\\mathcal{E}|2}=0.5$, and $p_{\\mathcal{M}|2}=0.3$.\nThe likelihood is:\n$L(2) = (0.6^{4} \\cdot (1-0.6)^{1}) \\cdot (0.7^{2} \\cdot (1-0.7)^{5}) \\cdot (0.5^{3} \\cdot (1-0.5)^{0}) \\cdot (0.3^{1} \\cdot (1-0.3)^{4})$\n$L(2) = (0.6^{4} \\cdot 0.4^{1}) \\cdot (0.7^{2} \\cdot 0.3^{5}) \\cdot (0.5^{3} \\cdot 0.5^{0}) \\cdot (0.3^{1} \\cdot 0.7^{4})$\n$L(2) = (0.1296 \\cdot 0.4) \\cdot (0.49 \\cdot 0.00243) \\cdot (0.125 \\cdot 1) \\cdot (0.3 \\cdot 0.2401)$\n$L(2) = (0.05184) \\cdot (0.0011907) \\cdot (0.125) \\cdot (0.07203)$\n$L(2) \\approx 5.55806 \\times 10^{-7}$\nThe score is:\n$\\text{Score}(2) = L(2) \\cdot P(S=2) \\approx (5.55806 \\times 10^{-7}) \\cdot 0.3 = 1.66742 \\times 10^{-7}$\n\nFor species $S=3$:\nThe prior is $P(S=3)=0.2$. The conditional probabilities are $p_{\\mathcal{C}|3}=0.3$, $p_{\\mathcal{D}|3}=0.4$, $p_{\\mathcal{E}|3}=0.8$, and $p_{\\mathcal{M}|3}=0.6$.\nThe likelihood is:\n$L(3) = (0.3^{4} \\cdot (1-0.3)^{1}) \\cdot (0.4^{2} \\cdot (1-0.4)^{5}) \\cdot (0.8^{3} \\cdot (1-0.8)^{0}) \\cdot (0.6^{1} \\cdot (1-0.6)^{4})$\n$L(3) = (0.3^{4} \\cdot 0.7^{1}) \\cdot (0.4^{2} \\cdot 0.6^{5}) \\cdot (0.8^{3} \\cdot 0.2^{0}) \\cdot (0.6^{1} \\cdot 0.4^{4})$\n$L(3) = (0.0081 \\cdot 0.7) \\cdot (0.16 \\cdot 0.07776) \\cdot (0.512 \\cdot 1) \\cdot (0.6 \\cdot 0.0256)$\n$L(3) = (0.00567) \\cdot (0.0124416) \\cdot (0.512) \\cdot (0.01536)$\n$L(3) \\approx 5.54755 \\times 10^{-7}$\nThe score is:\n$\\text{Score}(3) = L(3) \\cdot P(S=3) \\approx (5.54755 \\times 10^{-7}) \\cdot 0.2 = 1.10951 \\times 10^{-7}$\n\nComparing the scores:\n$\\text{Score}(1) \\approx 1.91108 \\times 10^{-5}$\n$\\text{Score}(2) \\approx 1.66742 \\times 10^{-7}$\n$\\text{Score}(3) \\approx 1.10951 \\times 10^{-7}$\n\nSince $1.91108 \\times 10^{-5}$ is the largest value, the score is maximized for species $s=1$.\nTherefore, the maximum a posteriori species assignment is $s^{*}=1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "5208490"}, {"introduction": "No diagnostic test is perfect, and a key skill is to critically evaluate its performance. This final practice focuses on the statistical assessment of an identification system using data from a confusion matrix [@problem_id:5208465]. You will calculate standard performance metrics like the F$_1$-score and explore a common real-world strategy: improving reporting reliability by collapsing difficult-to-distinguish species into a single genus. This demonstrates the important link between statistical validation and practical laboratory reporting.", "problem": "A clinical microbiology laboratory evaluates an automated microbial identification system (for example, Matrix-Assisted Laser Desorption/Ionization Time-of-Flight (MALDI-TOF) mass spectrometry) on four clinically relevant species that belong to two genera. Each isolate belongs to exactly one true species, and the system outputs exactly one predicted species per isolate. The test set contains $100$ isolates of each species. The species and their genera are:\n- Genus A: Species $A_1$ and Species $A_2$.\n- Genus B: Species $B_1$ and Species $B_2$.\n\nThe observed species-level outcomes (rows are true species; values are the number of isolates predicted into each species) are:\n- True $A_1$: predicted $A_1$ $40$, $A_2$ $50$, $B_1$ $7$, $B_2$ $3$.\n- True $A_2$: predicted $A_1$ $45$, $A_2$ $42$, $B_1$ $8$, $B_2$ $5$.\n- True $B_1$: predicted $A_1$ $6$, $A_2$ $4$, $B_1$ $52$, $B_2$ $38$.\n- True $B_2$: predicted $A_1$ $3$, $A_2$ $7$, $B_1$ $41$, $B_2$ $49$.\n\nWhen reporting at the genus level, the laboratory collapses both true labels and predictions to genera by summing species that share the same genus (that is, predictions of $A_1$ or $A_2$ are treated as genus A; predictions of $B_1$ or $B_2$ are treated as genus B).\n\nUsing only foundational definitions of precision, recall, and the F$_1$-score for multiclass single-label classification, compute the absolute change in the macro-averaged F$_1$-score when switching from species-level reporting to genus-level reporting. Here, macro-averaged F$_1$-score is the simple mean of the per-class F$_1$-scores over all classes at that reporting level. Express your final result as a decimal number and round your answer to four significant figures. Do not include any units in your answer.", "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We will proceed to solve it by first calculating the macro-averaged F$_1$-score at the species level, then at the genus level, and finally computing the absolute difference between these two scores.\n\nThe performance metrics for a given class $i$ are defined as:\nPrecision: $P_i = \\frac{TP_i}{TP_i + FP_i}$\nRecall: $R_i = \\frac{TP_i}{TP_i + FN_i}$\nF$_1$-score: $F_{1,i} = 2 \\cdot \\frac{P_i \\cdot R_i}{P_i + R_i}$\nwhere $TP_i$ is the number of true positives, $FP_i$ is the number of false positives, and $FN_i$ is the number of false negatives for class $i$. The macro-averaged F$_1$-score is the arithmetic mean of the F$_1$-scores of all classes.\n\nThe species-level outcomes can be represented by a $4 \\times 4$ confusion matrix $C_S$, where rows are the true species and columns are the predicted species. The classes are $A_1$, $A_2$, $B_1$, and $B_2$.\n$$ C_S = \\begin{pmatrix} 40  50  7  3 \\\\ 45  42  8  5 \\\\ 6  4  52  38 \\\\ 3  7  41  49 \\end{pmatrix} $$\nThe number of isolates per true species is $100$.\n\nFirst, we calculate the macro-averaged F$_1$-score at the species level ($F_{1,\\text{species}}$).\n\nFor Species $A_1$:\n$TP_{A_1} = 40$\n$FP_{A_1} = 45 + 6 + 3 = 54$\n$FN_{A_1} = 50 + 7 + 3 = 60$\n$P_{A_1} = \\frac{40}{40 + 54} = \\frac{40}{94}$\n$R_{A_1} = \\frac{40}{40 + 60} = \\frac{40}{100}$\n$F_{1, A_1} = 2 \\cdot \\frac{\\frac{40}{94} \\cdot \\frac{40}{100}}{\\frac{40}{94} + \\frac{40}{100}} = \\frac{2 \\cdot 40}{94 + 100} = \\frac{80}{194} = \\frac{40}{97}$\n\nFor Species $A_2$:\n$TP_{A_2} = 42$\n$FP_{A_2} = 50 + 4 + 7 = 61$\n$FN_{A_2} = 45 + 8 + 5 = 58$\n$P_{A_2} = \\frac{42}{42 + 61} = \\frac{42}{103}$\n$R_{A_2} = \\frac{42}{42 + 58} = \\frac{42}{100}$\n$F_{1, A_2} = 2 \\cdot \\frac{\\frac{42}{103} \\cdot \\frac{42}{100}}{\\frac{42}{103} + \\frac{42}{100}} = \\frac{2 \\cdot 42}{103 + 100} = \\frac{84}{203} = \\frac{12}{29}$\n\nFor Species $B_1$:\n$TP_{B_1} = 52$\n$FP_{B_1} = 7 + 8 + 41 = 56$\n$FN_{B_1} = 6 + 4 + 38 = 48$\n$P_{B_1} = \\frac{52}{52 + 56} = \\frac{52}{108}$\n$R_{B_1} = \\frac{52}{52 + 48} = \\frac{52}{100}$\n$F_{1, B_1} = 2 \\cdot \\frac{\\frac{52}{108} \\cdot \\frac{52}{100}}{\\frac{52}{108} + \\frac{52}{100}} = \\frac{2 \\cdot 52}{108 + 100} = \\frac{104}{208} = \\frac{1}{2}$\n\nFor Species $B_2$:\n$TP_{B_2} = 49$\n$FP_{B_2} = 3 + 5 + 38 = 46$\n$FN_{B_2} = 3 + 7 + 41 = 51$\n$P_{B_2} = \\frac{49}{49 + 46} = \\frac{49}{95}$\n$R_{B_2} = \\frac{49}{49 + 51} = \\frac{49}{100}$\n$F_{1, B_2} = 2 \\cdot \\frac{\\frac{49}{95} \\cdot \\frac{49}{100}}{\\frac{49}{95} + \\frac{49}{100}} = \\frac{2 \\cdot 49}{95 + 100} = \\frac{98}{195}$\n\nThe macro-averaged F$_1$-score for species is the average of these four scores:\n$F_{1,\\text{species}} = \\frac{1}{4} (F_{1, A_1} + F_{1, A_2} + F_{1, B_1} + F_{1, B_2})$\n$F_{1,\\text{species}} = \\frac{1}{4} \\left(\\frac{40}{97} + \\frac{12}{29} + \\frac{1}{2} + \\frac{98}{195}\\right)$\nUsing decimal approximations:\n$F_{1,\\text{species}} \\approx \\frac{1}{4} (0.412371 + 0.413793 + 0.5 + 0.502564) = \\frac{1}{4}(1.828728) = 0.457182$\n\nNext, we calculate the macro-averaged F$_1$-score at the genus level ($F_{1,\\text{genus}}$). We collapse the $4 \\times 4$ matrix $C_S$ into a $2 \\times 2$ matrix $C_G$ for Genus A and Genus B.\n\nThe counts for the genus-level confusion matrix $C_G$ are:\n$N(\\text{True A, Pred A}) = 40 + 50 + 45 + 42 = 177$\n$N(\\text{True A, Pred B}) = 7 + 3 + 8 + 5 = 23$\n$N(\\text{True B, Pred A}) = 6 + 4 + 3 + 7 = 20$\n$N(\\text{True B, Pred B}) = 52 + 38 + 41 + 49 = 180$\n\nThe resulting $2 \\times 2$ confusion matrix $C_G$ is:\n$$ C_G = \\begin{pmatrix} 177  23 \\\\ 20  180 \\end{pmatrix} $$\n\nFor Genus A:\n$TP_A = 177$\n$FP_A = 20$\n$FN_A = 23$\n$P_A = \\frac{177}{177+20} = \\frac{177}{197}$\n$R_A = \\frac{177}{177+23} = \\frac{177}{200}$\n$F_{1, A} = 2 \\cdot \\frac{\\frac{177}{197} \\cdot \\frac{177}{200}}{\\frac{177}{197} + \\frac{177}{200}} = \\frac{2 \\cdot 177}{197+200} = \\frac{354}{397}$\n\nFor Genus B:\n$TP_B = 180$\n$FP_B = 23$\n$FN_B = 20$\n$P_B = \\frac{180}{180+23} = \\frac{180}{203}$\n$R_B = \\frac{180}{180+20} = \\frac{180}{200}$\n$F_{1, B} = 2 \\cdot \\frac{\\frac{180}{203} \\cdot \\frac{180}{200}}{\\frac{180}{203} + \\frac{180}{200}} = \\frac{2 \\cdot 180}{203+200} = \\frac{360}{403}$\n\nThe macro-averaged F$_1$-score for genera is the average of these two scores:\n$F_{1,\\text{genus}} = \\frac{1}{2} (F_{1, A} + F_{1, B}) = \\frac{1}{2}\\left(\\frac{354}{397} + \\frac{360}{403}\\right)$\nUsing decimal approximations:\n$F_{1,\\text{genus}} \\approx \\frac{1}{2}(0.891688 + 0.893300) = \\frac{1}{2}(1.784988) = 0.892494$\n\nFinally, we compute the absolute change in the macro-averaged F$_1$-score:\n$|\\Delta F_1| = |F_{1,\\text{genus}} - F_{1,\\text{species}}|$\n$|\\Delta F_1| \\approx |0.892494 - 0.457182| = 0.435312$\n\nRounding the result to four significant figures gives $0.4353$.", "answer": "$$\\boxed{0.4353}$$", "id": "5208465"}]}