{"hands_on_practices": [{"introduction": "A Laboratory Information Management System (LIMS) is fundamentally built upon the principle of data integrity, and this begins with accurate sample identification. A single mistyped digit in a sample ID can lead to a catastrophic error. This exercise [@problem_id:5229668] demonstrates how a simple but powerful mathematical tool, the weighted check digit, is used to automatically detect common data entry and scanning errors, thereby safeguarding the entire diagnostic process from the outset.", "problem": "A Laboratory Information Management System (LIMS) in a high-throughput clinical diagnostics laboratory encodes sample identifiers as a fixed-length sequence of base digits followed by a single check digit. The goal is to detect common mis-scan and data-entry errors (single-digit substitutions and adjacent transpositions) before results are associated with the wrong patient specimen.\n\nFrom first principles of modular arithmetic and error-detecting codes, a check digit scheme defines a validity criterion that must hold for every correctly encoded identifier. Any deviation from the criterion indicates an error. In a weighted modulo arithmetic scheme, let the base digits be $d_1, d_2, \\dots, d_n$ and position-specific integer weights $w_1, w_2, \\dots, w_n$ be applied to the base digits. The check digit $d_c$ is appended and chosen so that the identifier satisfies a fixed congruence condition modulo $10$. Explain, using the properties of congruences and the structure of weighted sums, why such a scheme detects all single-digit substitutions and many adjacent transpositions when the weights are chosen to be nonzero modulo $10$ and not all equal.\n\nThen, for a concrete instantiation used by the laboratory, the base sequence has length $n = 8$ and the weights applied from leftmost to rightmost positions are\n$(w_1, w_2, \\dots, w_8) = (3, 1, 7, 9, 3, 1, 7, 9)$.\nThe validity criterion is that the total weighted sum of the base digits plus the check digit is congruent to $0$ modulo $10$. For the sample identifier with base digits $(d_1, d_2, \\dots, d_8) = (4, 5, 1, 0, 8, 2, 9, 6)$, compute the check digit $d_c$ that must be appended to satisfy the validity criterion. Express your final answer as the single check digit. No rounding is required.", "solution": "The problem is evaluated as valid. It is scientifically grounded in number theory and coding theory, well-posed with sufficient information for a unique solution, and objective in its language. It presents a standard application of modular arithmetic for error detection, which is a verifiable and formalizable concept. The problem consists of two parts: a theoretical explanation of an error-detecting code's properties and a specific calculation.\n\nFirst, we will address the theoretical explanation of the error detection capabilities of the weighted modulo scheme. Let the sequence of base digits be $(d_1, d_2, \\dots, d_n)$, where each $d_i \\in \\{0, 1, \\dots, 9\\}$. Let the corresponding weights be $(w_1, w_2, \\dots, w_n)$, where $w_i \\in \\mathbb{Z}$. A check digit, $d_c \\in \\{0, 1, \\dots, 9\\}$, is appended. The validity criterion for the complete identifier $(d_1, \\dots, d_n, d_c)$ is given as a congruence condition modulo $10$. In this specific problem, the criterion is that the weighted sum of the base digits plus the check digit is congruent to $0$ modulo $10$.\nLet $S$ be the weighted sum of the base digits:\n$$ S = \\sum_{i=1}^{n} w_i d_i $$\nThe validity criterion is $S + d_c \\equiv 0 \\pmod{10}$. This equation determines the value of the check digit, $d_c$, for a given set of base digits:\n$$ d_c \\equiv -S \\pmod{10} $$\nSince $d_c$ must be a single digit from $0$ to $9$, this congruence defines a unique value for $d_c$. The total weighted sum for a valid identifier, treating the check digit as having a weight of $1$, is $C = \\sum_{i=1}^{n} w_i d_i + d_c$. For any valid identifier, $C \\equiv 0 \\pmod{10}$. An error is detected if the altered identifier results in a total weighted sum $C'$ that is not congruent to $0$ modulo $10$.\n\n**1. Detection of Single-Digit Substitutions**\nA single-digit substitution error occurs if one base digit $d_i$ is misread as $d'_i$, where $d_i \\neq d'_i$. The original valid sum is $C = \\sum_{j=1}^{n} w_j d_j + d_c$. The new, erroneous sum is $C' = (\\sum_{j \\neq i} w_j d_j) + w_i d'_i + d_c$.\nThe difference between the new and original sums is:\n$$ \\Delta C = C' - C = w_i d'_i - w_i d_i = w_i (d'_i - d_i) $$\nThe error is detected if and only if $\\Delta C \\not\\equiv 0 \\pmod{10}$, which means $w_i (d'_i - d_i) \\not\\equiv 0 \\pmod{10}$.\nThe problem states that weights $w_i$ are chosen to be nonzero modulo $10$, i.e., $w_i \\not\\equiv 0 \\pmod{10}$. However, for the scheme to detect *all* single-digit substitutions, a stronger condition is required. The difference $d'_i - d_i$ is a non-zero integer in the range $[-9, 9]$. For the product $w_i (d'_i - d_i)$ to be a multiple of $10$, its prime factors must include $2$ and $5$. If $w_i$ is not coprime to $10$ (for example, if $w_i$ is an even number like $2$, $4$, $6$, or $8$, or a multiple of $5$), then there exists a difference $d'_i - d_i$ that will make the product a multiple of $10$. For instance, if $w_i = 2$ and the error is a substitution of a digit $k$ for $k+5$ (e.g., $1 \\to 6$), then $d'_i - d_i = 5$, and $\\Delta C = 2 \\times 5 = 10 \\equiv 0 \\pmod{10}$. This error would go undetected.\nTherefore, for *all* single-digit substitutions to be detected, we must have $\\gcd(w_i, 10) = 1$ for all weights $w_i$. This means the weights must not be divisible by $2$ or $5$. The problem's condition of \"nonzero modulo $10$\" is a necessary but not sufficient condition for this guarantee. The principle is that if $w_i$ is invertible modulo $10$, then $w_i(d'_i - d_i) \\equiv 0 \\pmod{10}$ implies $d'_i - d_i \\equiv 0 \\pmod{10}$, which is impossible for distinct single digits.\n\n**2. Detection of Adjacent Transpositions**\nAn adjacent transposition error occurs if two adjacent digits, $d_i$ and $d_{i+1}$, are swapped. Assume $d_i \\neq d_{i+1}$.\nThe original contribution to the sum from this pair is $w_i d_i + w_{i+1} d_{i+1}$.\nThe new contribution after transposition is $w_i d_{i+1} + w_{i+1} d_i$.\nThe change in the total sum is:\n$$ \\Delta C = (w_i d_{i+1} + w_{i+1} d_i) - (w_i d_i + w_{i+1} d_{i+1}) $$\n$$ \\Delta C = d_{i+1}(w_i - w_{i+1}) - d_i(w_i - w_{i+1}) = (w_i - w_{i+1})(d_{i+1} - d_i) $$\nThe error is detected if and only if $\\Delta C \\not\\equiv 0 \\pmod{10}$.\nThe problem states the weights are \"not all equal\". This ensures that there is at least one pair of adjacent weights $w_i, w_{i+1}$ such that $w_i \\neq w_{i+1}$, so $w_i-w_{i+1} \\neq 0$. If all adjacent weights are distinct ($w_i \\neq w_{i+1}$ for all $i$), then the term $(w_i - w_{i+1})$ is never zero. However, even if $w_i - w_{i+1} \\neq 0$, the product $(w_i-w_{i+1})(d_{i+1}-d_i)$ can still be a multiple of $10$. This occurs if, for example, $w_i - w_{i+1}$ is even and $|d_{i+1} - d_i| = 5$. Because this possibility for failure exists for certain combinations of weights and digit differences, the scheme does not detect all adjacent transpositions. It does, however, detect \"many\" such errors, specifically any transposition where the product $(w_i - w_{i+1})(d_{i+1} - d_i)$ is not a multiple of $10$.\n\nNow, we proceed to the calculation for the given concrete instantiation.\nThe base sequence has length $n=8$.\nThe weights are $(w_1, w_2, \\dots, w_8) = (3, 1, 7, 9, 3, 1, 7, 9)$.\nThe base digits are $(d_1, d_2, \\dots, d_8) = (4, 5, 1, 0, 8, 2, 9, 6)$.\nThe validity criterion is $\\sum_{i=1}^{8} w_i d_i + d_c \\equiv 0 \\pmod{10}$.\n\nWe first compute the weighted sum $S = \\sum_{i=1}^{8} w_i d_i$:\n$$ S = w_1 d_1 + w_2 d_2 + w_3 d_3 + w_4 d_4 + w_5 d_5 + w_6 d_6 + w_7 d_7 + w_8 d_8 $$\n$$ S = (3)(4) + (1)(5) + (7)(1) + (9)(0) + (3)(8) + (1)(2) + (7)(9) + (9)(6) $$\n$$ S = 12 + 5 + 7 + 0 + 24 + 2 + 63 + 54 $$\nSumming these values:\n$$ S = 17 + 7 + 0 + 24 + 2 + 63 + 54 $$\n$$ S = 24 + 24 + 2 + 63 + 54 $$\n$$ S = 50 + 63 + 54 $$\n$$ S = 113 + 54 $$\n$$ S = 167 $$\nThe validity criterion is $S + d_c \\equiv 0 \\pmod{10}$. Substituting the value of $S$:\n$$ 167 + d_c \\equiv 0 \\pmod{10} $$\nTo simplify the congruence, we find the remainder of $167$ when divided by $10$.\n$$ 167 = 16 \\times 10 + 7 \\implies 167 \\equiv 7 \\pmod{10} $$\nThe congruence becomes:\n$$ 7 + d_c \\equiv 0 \\pmod{10} $$\nSolving for $d_c$:\n$$ d_c \\equiv -7 \\pmod{10} $$\nIn the set of integers $\\{0, 1, \\dots, 9\\}$, the value congruent to $-7$ modulo $10$ is $3$, since $-7 + 10 = 3$.\nTherefore, the check digit is $d_c = 3$.\nThe complete identifier would be $(4, 5, 1, 0, 8, 2, 9, 6, 3)$.\nThe total sum is $167 + 3 = 170$, which is congruent to $0$ modulo $10$, confirming the result.", "answer": "$$\\boxed{3}$$", "id": "5229668"}, {"introduction": "Once a specimen is correctly identified, the LIMS must track its journey through the lab, which often involves splitting it into multiple aliquots and derivatives. This practice problem [@problem_id:5229674] asks you to model a typical specimen processing workflow to determine the total number of physical labels required. Solving it provides insight into the crucial LIMS function of maintaining an unbroken chain of custody and managing the exponential growth of trackable items in a high-throughput environment.", "problem": "A clinical laboratory implements a Laboratory Information Management System (LIMS) to enforce chain-of-custody and traceability for all physical items associated with diagnostic workflows. A single primary specimen is accessioned into the system and immediately assigned its own container and physical labels. The specimen is then subdivided into $n$ aliquots for parallel processing. Each aliquot undergoes a standardized preparation step that yields $m$ distinct derivative items (for example, separated fractions or extracted analytes), each entering storage or downstream testing as a separate physical item.\n\nThe LIMS policy requires that every physical item that exists at any stage (including the original specimen container, each aliquot, and each derivative) must be printed with exactly two physical labels: one barcode label and one human-readable label. No additional labels are printed for racks, secondary packaging, or administrative reprints, and there are no failed or discarded items.\n\nStarting from the core definitions of item enumeration in LIMS and basic counting principles, derive the total number of physical labels that must be printed for this workflow as a function of $n$ and $m$. Express your final answer as a single simplified algebraic expression in terms of $n$ and $m$. No rounding is required, and do not include any units in your answer.", "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of laboratory diagnostics and information management, is well-posed with all necessary information provided, and is expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe task is to derive an expression for the total number of physical labels required for a specific laboratory workflow. The guiding principle is the rule stated in the problem: \"every physical item that exists at any stage...must be printed with exactly two physical labels\". Therefore, the solution requires us to enumerate all distinct physical items generated throughout the workflow and then multiply this total number by $2$.\n\nWe can categorize the physical items into three distinct, non-overlapping sets based on their stage in the workflow. Let $N_{items}$ be the total number of physical items.\n\n1.  **The Primary Specimen:** The workflow begins with a single primary specimen, which is placed in its own container. This container is the first physical item to be tracked. Let $N_{specimen}$ be the number of primary specimens.\n    $$N_{specimen} = 1$$\n\n2.  **The Aliquots:** The primary specimen is subdivided into $n$ aliquots. Each aliquot is a new, distinct physical item requiring its own container and labels. Let $N_{aliquots}$ be the number of aliquots.\n    $$N_{aliquots} = n$$\n\n3.  **The Derivative Items:** Each of the $n$ aliquots undergoes a preparation step that yields $m$ distinct derivative items. Since each of the $n$ aliquots produces $m$ derivatives, we can find the total number of derivative items by the multiplication principle. Let $N_{derivatives}$ be the total number of derivative items.\n    $$N_{derivatives} = n \\times m = nm$$\n\nThe total number of unique physical items, $N_{items}$, is the sum of the items from these three stages, as they represent all items generated in the specified workflow.\n$$N_{items} = N_{specimen} + N_{aliquots} + N_{derivatives}$$\nSubstituting the counts from each stage, we get:\n$$N_{items} = 1 + n + nm$$\n\nThe problem states that each physical item requires exactly $2$ labels (one barcode and one human-readable). Let $L_{total}$ be the total number of labels to be printed.\n$$L_{total} = 2 \\times N_{items}$$\n\nSubstituting the expression for $N_{items}$:\n$$L_{total} = 2(1 + n + nm)$$\n\nThis is the final, simplified algebraic expression for the total number of physical labels as a function of $n$ and $m$.", "answer": "$$\\boxed{2(1+n+nm)}$$", "id": "5229674"}, {"introduction": "Beyond tracking samples, a modern LIMS serves as an automated quality guardian by applying sophisticated statistical rules to quality control (QC) data. This exercise [@problem_id:5229718] places you in the role of the LIMS, asking you to apply a standard set of Westgard multirules to a sequence of QC measurements to decide if a run is acceptable. This hands-on analysis demonstrates how a LIMS automates complex decision-making to detect subtle shifts in analytical performance and uphold the quality of laboratory results.", "problem": "A clinical chemistry instrument sends Quality Control (QC) results to a Laboratory Information Management System (LIMS) for run-by-run acceptance. The LIMS is configured to use the Westgard multirule QC approach, where violation of any of the following rules triggers run rejection: $2_{2s}$, $R_{4s}$, $4_{1s}$, $10_{x}$. The rule $1_{2s}$ is treated as a warning only and does not, by itself, cause rejection.\n\nAssume two control materials are measured once per run: Level $1$ and Level $2$. For Level $1$, the assigned mean is $\\mu_{1}=100$ and the standard deviation is $\\sigma_{1}=2$. For Level $2$, the assigned mean is $\\mu_{2}=200$ and the standard deviation is $\\sigma_{2}=4$. Let $x_{i,r}$ denote the measured value for control Level $i \\in \\{1,2\\}$ in run $r$, and let the standardized deviation (the $z$-score) be $z_{i,r} = \\frac{x_{i,r}-\\mu_{i}}{\\sigma_{i}}$.\n\nThe LIMS enforces the following well-tested QC decision rules at each run $r$ using the current and preceding runs as needed:\n- $1_{2s}$ (warning only): There exists a control Level $i$ with $|z_{i,r}|>2$ at the current run.\n- $2_{2s}$: For the same control Level $i$, two consecutive runs $r-1$ and $r$ satisfy either $z_{i,r-1}>2$ and $z_{i,r}>2$, or $z_{i,r-1}<-2$ and $z_{i,r}<-2$.\n- $R_{4s}$: In the same run $r$, one control Level has $z_{i,r}\\geq 2$ while the other control Level has $z_{j,r}\\leq -2$ (with $i\\neq j$), or vice versa.\n- $4_{1s}$: For the same control Level $i$, four consecutive runs $k=r-3,r-2,r-1,r$ all have $z_{i,k}>1$, or all have $z_{i,k}<-1$.\n- $10_{x}$: For the same control Level $i$, ten consecutive runs $k=r-9,\\dots,r$ all have $z_{i,k}\\geq 0$, or all have $z_{i,k}\\leq 0$.\n\nThe LIMS has recorded the following $12$ consecutive runs of control results (each number is a single measurement per level per run):\n- Run $1$: $x_{1,1}=99.6$, $x_{2,1}=201.0$\n- Run $2$: $x_{1,2}=99.8$, $x_{2,2}=199.5$\n- Run $3$: $x_{1,3}=100.3$, $x_{2,3}=200.8$\n- Run $4$: $x_{1,4}=100.5$, $x_{2,4}=199.2$\n- Run $5$: $x_{1,5}=100.7$, $x_{2,5}=200.0$\n- Run $6$: $x_{1,6}=100.8$, $x_{2,6}=199.9$\n- Run $7$: $x_{1,7}=100.9$, $x_{2,7}=200.2$\n- Run $8$: $x_{1,8}=101.0$, $x_{2,8}=200.3$\n- Run $9$: $x_{1,9}=101.2$, $x_{2,9}=199.7$\n- Run $10$: $x_{1,10}=101.4$, $x_{2,10}=200.4$\n- Run $11$: $x_{1,11}=101.5$, $x_{2,11}=200.1$\n- Run $12$: $x_{1,12}=101.6$, $x_{2,12}=199.8$\n\nStarting strictly from the rule definitions above and the provided data, determine whether Run $12$ should be accepted or rejected by the LIMS. Express your decision as the indicator variable $I$, where $I=1$ if Run $12$ is rejected, and $I=0$ if Run $12$ is accepted. No rounding is required, and the final answer must be a single real number without units.", "solution": "The problem requires an evaluation of Quality Control (QC) data for Run $12$ based on a predefined set of Westgard multirules implemented in a Laboratory Information Management System (LIMS). The decision to accept or reject the run depends on whether any of the specified rejection rules are violated. The indicator variable $I$ is defined as $1$ for rejection and $0$ for acceptance.\n\nFirst, we must calculate the standardized deviation (z-score) for each measurement. The z-score, $z_{i,r}$, for control Level $i$ in run $r$ is given by the formula:\n$$z_{i,r} = \\frac{x_{i,r}-\\mu_{i}}{\\sigma_{i}}$$\nFor Level $1$, the assigned mean is $\\mu_{1}=100$ and the standard deviation is $\\sigma_{1}=2$.\nFor Level $2$, the assigned mean is $\\mu_{2}=200$ and the standard deviation is $\\sigma_{2}=4$.\n\nUsing this formula, we calculate the z-scores for each of the $12$ runs for both control levels.\n\nFor Level $1$ ($z_{1,r}$):\n- Run $1$: $z_{1,1} = \\frac{99.6-100}{2} = -0.2$\n- Run $2$: $z_{1,2} = \\frac{99.8-100}{2} = -0.1$\n- Run $3$: $z_{1,3} = \\frac{100.3-100}{2} = 0.15$\n- Run $4$: $z_{1,4} = \\frac{100.5-100}{2} = 0.25$\n- Run $5$: $z_{1,5} = \\frac{100.7-100}{2} = 0.35$\n- Run $6$: $z_{1,6} = \\frac{100.8-100}{2} = 0.4$\n- Run $7$: $z_{1,7} = \\frac{100.9-100}{2} = 0.45$\n- Run $8$: $z_{1,8} = \\frac{101.0-100}{2} = 0.5$\n- Run $9$: $z_{1,9} = \\frac{101.2-100}{2} = 0.6$\n- Run $10$: $z_{1,10} = \\frac{101.4-100}{2} = 0.7$\n- Run $11$: $z_{1,11} = \\frac{101.5-100}{2} = 0.75$\n- Run $12$: $z_{1,12} = \\frac{101.6-100}{2} = 0.8$\n\nFor Level $2$ ($z_{2,r}$):\n- Run $1$: $z_{2,1} = \\frac{201.0-200}{4} = 0.25$\n- Run $2$: $z_{2,2} = \\frac{199.5-200}{4} = -0.125$\n- Run $3$: $z_{2,3} = \\frac{200.8-200}{4} = 0.2$\n- Run $4$: $z_{2,4} = \\frac{199.2-200}{4} = -0.2$\n- Run $5$: $z_{2,5} = \\frac{200.0-200}{4} = 0.0$\n- Run $6$: $z_{2,6} = \\frac{199.9-200}{4} = -0.025$\n- Run $7$: $z_{2,7} = \\frac{200.2-200}{4} = 0.05$\n- Run $8$: $z_{2,8} = \\frac{200.3-200}{4} = 0.075$\n- Run $9$: $z_{2,9} = \\frac{199.7-200}{4} = -0.075$\n- Run $10$: $z_{2,10} = \\frac{200.4-200}{4} = 0.1$\n- Run $11$: $z_{2,11} = \\frac{200.1-200}{4} = 0.025$\n- Run $12$: $z_{2,12} = \\frac{199.8-200}{4} = -0.05$\n\nNow, we must evaluate the status of Run $12$ by checking for violations of the rejection rules ($2_{2s}$, $R_{4s}$, $4_{1s}$, $10_{x}$).\n\n1.  **Check for $2_{2s}$ violation at Run $12$**: This rule is violated if, for the same control level, two consecutive results exceed the same $+2s$ or $-2s$ limit. We need to check the data for runs $11$ and $12$.\n    - For Level $1$: $z_{1,11}=0.75$ and $z_{1,12}=0.8$. Neither value is greater than $2$ or less than $-2$. No violation.\n    - For Level $2$: $z_{2,11}=0.025$ and $z_{2,12}=-0.05$. Neither value is greater than $2$ or less than $-2$. No violation.\n    The $2_{2s}$ rule is not violated.\n\n2.  **Check for $R_{4s}$ violation at Run $12$**: This rule is violated if, within a single run, one control level is $\\ge +2s$ and the other is $\\le -2s$.\n    - At Run $12$, we have $z_{1,12}=0.8$ and $z_{2,12}=-0.05$.\n    - We check if ($z_{1,12} \\ge 2$ and $z_{2,12} \\le -2$) or ($z_{2,12} \\ge 2$ and $z_{1,12} \\le -2$).\n    - Since $|z_{1,12}| < 2$ and $|z_{2,12}| < 2$, neither condition is met.\n    The $R_{4s}$ rule is not violated.\n\n3.  **Check for $4_{1s}$ violation at Run $12$**: This rule is violated if, for the same control level, four consecutive results exceed the same $+1s$ or $-1s$ limit. We check the data for runs $9, 10, 11, 12$.\n    - For Level $1$: The z-scores are $z_{1,9}=0.6$, $z_{1,10}=0.7$, $z_{1,11}=0.75$, $z_{1,12}=0.8$. None of these values are greater than $1$. No violation.\n    - For Level $2$: The z-scores are $z_{2,9}=-0.075$, $z_{2,10}=0.1$, $z_{2,11}=0.025$, $z_{2,12}=-0.05$. These values are not all greater than $1$, nor are they all less than $-1$. No violation.\n    The $4_{1s}$ rule is not violated.\n\n4.  **Check for $10_{x}$ violation at Run $12$**: This rule is violated if, for the same control level, ten consecutive results fall on the same side of the mean (i.e., all $z \\geq 0$ or all $z \\leq 0$). We must check the data for runs $3$ through $12$.\n    - For Level $1$, the z-scores for runs $k=3, \\dots, 12$ are:\n      $z_{1,3}=0.15$\n      $z_{1,4}=0.25$\n      $z_{1,5}=0.35$\n      $z_{1,6}=0.4$\n      $z_{1,7}=0.45$\n      $z_{1,8}=0.5$\n      $z_{1,9}=0.6$\n      $z_{1,10}=0.7$\n      $z_{1,11}=0.75$\n      $z_{1,12}=0.8$\n      All ten of these values are positive (i.e., $z_{1,k} \\ge 0$ for $k \\in \\{3, \\dots, 12\\}$). Therefore, the $10_{x}$ rule is violated for Level $1$.\n    - For completeness, we check Level $2$. The z-scores for runs $k=3, \\dots, 12$ are: $0.2$, $-0.2$, $0.0$, $-0.025$, $0.05$, $0.075$, $-0.075$, $0.1$, $0.025$, $-0.05$. These values are not all on the same side of the mean. No violation for Level $2$.\n\nSince the $10_{x}$ rule is violated for Level $1$ at the evaluation of Run $12$, the run must be rejected. The indicator variable $I$ for a rejected run is $1$.", "answer": "$$\\boxed{1}$$", "id": "5229718"}]}