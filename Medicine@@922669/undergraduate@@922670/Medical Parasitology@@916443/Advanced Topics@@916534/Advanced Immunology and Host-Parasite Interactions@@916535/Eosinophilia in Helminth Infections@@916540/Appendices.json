{"hands_on_practices": [{"introduction": "Eosinophilia presents a common diagnostic dilemma, as it is a hallmark of both helminth infections and atopic diseases. This exercise challenges you to act as a clinical detective, using Bayesian reasoning to quantitatively weigh different pieces of immunological evidence—such as immunoglobulin E (IgE) profiles and exposure timelines—to distinguish between these two causes [@problem_id:4788541]. Mastering this approach is key to developing robust skills in differential diagnosis, where probabilities are updated as new information becomes available.", "problem": "A returning traveler presents with peripheral eosinophilia following recent exposure in a region endemic for tissue-invasive helminths. Advanced-undergraduate reasoning in medical parasitology requires distinguishing helminth-induced eosinophilia from atopic disease by integrating the biology of T-helper type 2 (Th2) immunity with quantitative diagnostic evidence. In helminth infection, tissue migration of larvae and adult worm antigens drive interleukin-5–dependent eosinophilopoiesis and polyclonal immunoglobulin E (IgE) production, whereas atopic disease more commonly features high-affinity, allergen-specific immunoglobulin E (IgE) targeting common aeroallergens with a characteristic exposure timeline.\n\nConsider a patient with mixed features:\n- Very high total immunoglobulin E (IgE) concentration, defined as greater than $1200$ kU/L.\n- Specific immunoglobulin E (IgE) testing negative to common aeroallergens (for example, house dust mite and grass pollens) but positive to multiple helminth antigens at low to moderate intensities, suggestive of polyclonal reactivity.\n- Eosinophilia emerging approximately $3$ to $6$ weeks after freshwater exposure in an endemic area, temporally consistent with tissue-migrating helminths.\n\nSuppose the clinical question is to discriminate between two mutually exclusive explanations for eosinophilia:\n- $H$: active helminth infection.\n- $A$: atopic disease without helminth infection.\n\nAmong returned travelers with eosinophilia, the pretest probability of $H$ is $0.30$. For the three observed features above (treated as conditionally independent given $H$ or $A$), assume the following diagnostic performance for the presence of each feature when distinguishing $H$ from $A$:\n- Very high total immunoglobulin E (IgE): sensitivity $0.60$, specificity $0.68$.\n- Helminth-skewed specific immunoglobulin E (IgE) pattern with absence of common aeroallergen sensitization: sensitivity $0.70$, specificity $0.88$.\n- Post-exposure timeline consistent with tissue-migrating helminths: sensitivity $0.50$, specificity $0.75$.\n\nAll three features are present in this patient. Using fundamental definitions of sensitivity, specificity, and probability, compute the posterior probability of $H$ given these findings. Express your final answer as a decimal number (no units), and round to $4$ significant figures.", "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded, and objective problem in applied probability, specifically Bayesian inference. All necessary data are provided, the constraints are consistent, and the question is unambiguous. We may therefore proceed with the solution.\n\nThe problem asks for the posterior probability of a patient having an active helminth infection ($H$) given three distinct clinical findings ($E_1, E_2, E_3$). We are given the prior probability of helminth infection and the sensitivity and specificity for each finding.\n\nLet $H$ be the event that the patient has an active helminth infection.\nLet $A$ be the event that the patient has atopic disease without helminth infection.\nThe problem states that $H$ and $A$ are mutually exclusive explanations. Therefore, $A$ is the complement of $H$, denoted $H^c$.\n\nThe prior probability of helminth infection is given as:\n$$P(H) = 0.30$$\nSince $H$ and $A$ are mutually exclusive and exhaustive possibilities for the eosinophilia, the prior probability of atopic disease is:\n$$P(A) = P(H^c) = 1 - P(H) = 1 - 0.30 = 0.70$$\n\nLet $E_1$ be the finding of \"Very high total immunoglobulin E (IgE)\".\nLet $E_2$ be the finding of \"Helminth-skewed specific immunoglobulin E (IgE) pattern\".\nLet $E_3$ be the finding of \"Post-exposure timeline consistent with tissue-migrating helminths\".\n\nThe patient exhibits all three findings. Let $E$ represent the conjunction of these findings: $E = E_1 \\cap E_2 \\cap E_3$. We need to compute the posterior probability $P(H | E)$.\n\nAccording to Bayes' theorem:\n$$P(H | E) = \\frac{P(E | H) P(H)}{P(E)}$$\nThe total probability of observing the evidence, $P(E)$, can be expressed using the law of total probability:\n$$P(E) = P(E | H) P(H) + P(E | A) P(A)$$\nSubstituting this into Bayes' theorem gives:\n$$P(H | E) = \\frac{P(E | H) P(H)}{P(E | H) P(H) + P(E | A) P(A)}$$\n\nWe are given the sensitivities and specificities for each finding.\nSensitivity is defined as $P(\\text{finding present} | \\text{disease present})$, which is $P(E_i | H)$.\nSpecificity is defined as $P(\\text{finding absent} | \\text{disease absent})$, which is $P(E_i^c | A)$.\n\nFor finding $E_1$:\nSensitivity: $P(E_1 | H) = 0.60$\nSpecificity: $P(E_1^c | A) = 0.68$\nFrom the specificity, we can find the probability of the finding being present in the absence of helminthiasis:\n$P(E_1 | A) = 1 - P(E_1^c | A) = 1 - 0.68 = 0.32$\n\nFor finding $E_2$:\nSensitivity: $P(E_2 | H) = 0.70$\nSpecificity: $P(E_2^c | A) = 0.88$\nThus, $P(E_2 | A) = 1 - P(E_2^c | A) = 1 - 0.88 = 0.12$\n\nFor finding $E_3$:\nSensitivity: $P(E_3 | H) = 0.50$\nSpecificity: $P(E_3^c | A) = 0.75$\nThus, $P(E_3 | A) = 1 - P(E_3^c | A) = 1 - 0.75 = 0.25$\n\nThe problem states that the three features are conditionally independent given $H$ or $A$. This allows us to calculate the likelihood of observing the combined evidence $E$ by multiplying the probabilities of the individual findings.\n\nThe likelihood of the combined evidence given helminth infection is:\n$$P(E | H) = P(E_1 \\cap E_2 \\cap E_3 | H) = P(E_1 | H) \\times P(E_2 | H) \\times P(E_3 | H)$$\n$$P(E | H) = 0.60 \\times 0.70 \\times 0.50 = 0.21$$\n\nThe likelihood of the combined evidence given atopic disease is:\n$$P(E | A) = P(E_1 \\cap E_2 \\cap E_3 | A) = P(E_1 | A) \\times P(E_2 | A) \\times P(E_3 | A)$$\n$$P(E | A) = 0.32 \\times 0.12 \\times 0.25 = 0.0096$$\n\nNow we have all the components to calculate the posterior probability $P(H | E)$.\nSubstitute these values into the Bayes' formula:\n$$P(H | E) = \\frac{P(E | H) P(H)}{P(E | H) P(H) + P(E | A) P(A)}$$\n$$P(H | E) = \\frac{(0.21) \\times (0.30)}{(0.21) \\times (0.30) + (0.0096) \\times (0.70)}$$\n\nCalculate the numerator and the terms in the denominator:\nNumerator: $0.21 \\times 0.30 = 0.063$\nDenominator, first term: $0.21 \\times 0.30 = 0.063$\nDenominator, second term: $0.0096 \\times 0.70 = 0.00672$\nTotal denominator: $0.063 + 0.00672 = 0.06972$\n\nSo, the posterior probability is:\n$$P(H | E) = \\frac{0.063}{0.06972}$$\n$$P(H | E) \\approx 0.9036144578...$$\n\nThe problem requires the answer to be rounded to $4$ significant figures.\n$$P(H | E) \\approx 0.9036$$", "answer": "$$\\boxed{0.9036}$$", "id": "4788541"}, {"introduction": "A falling eosinophil count is a classic indicator of successful anti-helminthic treatment, but what is the expected rate of this decline? This exercise applies the principles of first-order kinetics to model the decay of eosinophilia after the parasitic stimulus is eliminated [@problem_id:4788557]. By deriving the decay curve, you will learn to translate a fundamental biological process—the clearance of immune cells—into a predictive mathematical model that has direct application in monitoring therapeutic response.", "problem": "A patient with confirmed Strongyloides stercoralis infection presents with an absolute eosinophil count (AEC) of $1{,}800$ cells per microliter (cells/$\\mu$L) prior to therapy. Following a single dose of ivermectin at time $t=0$, assume that parasite-derived antigenic stimulation abruptly ceases and the eosinophil elevation above a physiological baseline relaxes according to first-order kinetics. Let $A(t)$ denote the AEC at time $t$ (in days) after therapy, and let the physiological baseline eosinophil count be $A_{b} = 200$ cells/$\\mu$L. Assume that the excess eosinophil component $X(t) \\equiv A(t) - A_{b}$ obeys the first-order decay law $dX/dt = -k\\,X$ with rate constant $k = 0.1\\,\\text{day}^{-1}$.\n\nStarting from this kinetic assumption and fundamental properties of first-order decay, derive the analytic form of $A(t)$ and then compute the expected absolute decrease in AEC, $\\Delta(t) \\equiv A(0) - A(t)$, at $t = 14$ days. Use the initial condition $A(0) = 1{,}800$ cells/$\\mu$L. Express the final numerical value of the decrease in cells per microliter (cells/$\\mu$L), rounded to three significant figures.", "solution": "The problem statement has been validated and is deemed sound, well-posed, and scientifically grounded. It presents a standard initial value problem based on first-order kinetics, a fundamental concept in physical and biological sciences.\n\nThe problem requires us to model the absolute eosinophil count (AEC), denoted by $A(t)$, as a function of time $t$ in days. The core of the model lies in the behavior of the excess eosinophil component, $X(t)$, which is defined as the AEC above a physiological baseline $A_b$.\nThe given parameters are:\n- Initial AEC: $A(0) = 1800$ cells/$\\mu$L.\n- Physiological baseline AEC: $A_b = 200$ cells/$\\mu$L.\n- Rate constant for decay: $k = 0.1$ day$^{-1}$.\n\nThe excess eosinophil component is defined as:\n$$X(t) \\equiv A(t) - A_b$$\n\nThe dynamic behavior of this excess component is governed by a first-order decay differential equation:\n$$\\frac{dX}{dt} = -kX(t)$$\n\nThis is a linear, first-order, homogeneous ordinary differential equation. We can solve it by separation of variables.\n$$\\frac{dX}{X} = -k \\, dt$$\n\nIntegrating both sides from the initial time $t=0$ to a general time $t$:\n$$\\int_{X(0)}^{X(t)} \\frac{1}{X'} dX' = \\int_{0}^{t} -k \\, dt'$$\n$$\\left[ \\ln|X'| \\right]_{X(0)}^{X(t)} = \\left[ -kt' \\right]_{0}^{t}$$\nSince $X(t)$ represents an excess cell count, it will be non-negative, so we can drop the absolute value.\n$$\\ln(X(t)) - \\ln(X(0)) = -kt$$\n$$\\ln\\left(\\frac{X(t)}{X(0)}\\right) = -kt$$\n\nTo solve for $X(t)$, we exponentiate both sides:\n$$\\frac{X(t)}{X(0)} = \\exp(-kt)$$\n$$X(t) = X(0) \\exp(-kt)$$\n\nWe need to determine the initial value of the excess component, $X(0)$. Using its definition:\n$$X(0) = A(0) - A_b$$\nSubstituting the given values:\n$$X(0) = 1800 - 200 = 1600 \\text{ cells}/\\mu\\text{L}$$\n\nNow we have the explicit solution for the excess component:\n$$X(t) = 1600 \\exp(-kt)$$\n\nThe first part of the problem asks for the analytic form of $A(t)$. We use the definition $A(t) = X(t) + A_b$ and substitute our expression for $X(t)$:\n$$A(t) = 1600 \\exp(-kt) + 200$$\nThis is the analytic form of the AEC as a function of time $t$, with the given parameters substituted for the initial condition and baseline. In a more general form using symbols, it is $A(t) = (A(0) - A_b)\\exp(-kt) + A_b$.\n\nThe second part of the problem asks for the absolute decrease in AEC, $\\Delta(t)$, at $t = 14$ days. The decrease is defined as:\n$$\\Delta(t) \\equiv A(0) - A(t)$$\n\nSubstituting the derived expression for $A(t)$:\n$$\\Delta(t) = A(0) - \\left( (A(0) - A_b)\\exp(-kt) + A_b \\right)$$\n$$\\Delta(t) = A(0) - A_b - (A(0) - A_b)\\exp(-kt)$$\nFactoring out the term $(A(0) - A_b)$:\n$$\\Delta(t) = (A(0) - A_b)(1 - \\exp(-kt))$$\nThis result shows that the total decrease at time $t$ is a fraction $(1 - \\exp(-kt))$ of the initial excess eosinophil count.\n\nNow we compute the numerical value of $\\Delta(t)$ at $t = 14$ days.\nThe given values are:\n- $A(0) = 1800$\n- $A_b = 200$\n- $k = 0.1$ day$^{-1}$\n- $t = 14$ days\n\nThe initial excess is $A(0) - A_b = 1600$. The argument of the exponential is $kt = (0.1)(14) = 1.4$.\nSo, we evaluate:\n$$\\Delta(14) = 1600(1 - \\exp(-1.4))$$\n\nWe now calculate the numerical value:\n$$\\exp(-1.4) \\approx 0.24659696$$\n$$1 - \\exp(-1.4) \\approx 1 - 0.24659696 = 0.75340304$$\n$$\\Delta(14) \\approx 1600 \\times 0.75340304 \\approx 1205.44486$$\n\nThe problem requires the final answer to be rounded to three significant figures. The calculated value is $1205.44486$. The first three significant digits are $1$, $2$, and $0$. The fourth digit is $5$, which requires rounding up the third digit. Therefore, $120$ becomes $121$. The number must maintain its magnitude, so the result is $1210$. To express this unambiguously with three significant figures, we use scientific notation.\n\n$$1210 = 1.21 \\times 10^3$$\nThe expected absolute decrease in AEC at $14$ days is $1210$ cells/$\\mu$L.", "answer": "$$\\boxed{1.21 \\times 10^{3}}$$", "id": "4788557"}, {"introduction": "While essential for fighting helminths, chronic eosinophilic inflammation can lead to severe pathology, such as liver fibrosis in schistosomiasis. This exercise challenges you to build a computational model that simulates this entire pathogenic cascade, from the arrival of parasite eggs to the progressive accumulation of fibrotic tissue [@problem_id:4788543]. By translating a complex biological system into a set of linked differential equations, you will gain hands-on experience with the principles of systems biology and appreciate how quantitative modeling can illuminate the long-term consequences of infectious diseases.", "problem": "A chronic hepatointestinal schistosomiasis infection deposits parasite eggs into hepatic microvasculature, eliciting granulomatous inflammation characterized by eosinophil infiltration that drives extracellular matrix (ECM) collagen deposition and, over time, fibrosis. Build a quantitative, cumulative-exposure model that links egg arrival to hepatic eosinophil infiltration and collagen accumulation using first-order recruitment and clearance kinetics grounded in standard mass-action and exponential decay principles. The model must be framed as a linear cascade with the following mechanistic structure: (i) an inflammatory chemoattractant signal generated proportionally to egg arrival and cleared with first-order kinetics; (ii) eosinophil infiltration recruited proportionally to the signal and cleared with first-order kinetics; and (iii) collagen deposition driven proportionally by eosinophil infiltration and cleared with first-order kinetics.\n\nUse the following base definitions, which are accepted facts in immunopathology and kinetics: (a) antigenic stimuli trigger inflammatory signaling with a finite memory described by exponential decay; (b) recruitment and clearance of cellular effectors such as eosinophils follow first-order kinetics when away from saturation; (c) net collagen accumulation is the balance between deposition driven by inflammatory effectors and turnover. Let time be $t$ in days. Let $a(t)$ be the egg arrival rate to the liver in eggs/day. Let $I(t)$ be the chemoattractant signal (arbitrary units), $E(t)$ the eosinophil infiltration level (arbitrary units), and $C(t)$ the collagen concentration in milligrams per gram of liver (mg/g). Assume zero initial conditions: $I(0)=0$, $E(0)=0$, $C(0)=0$. The model is defined by the first-order kinetics\n$$\\frac{dI}{dt}=\\alpha\\,a(t)-k_i\\,I(t),\\quad \\frac{dE}{dt}=\\beta\\,I(t)-k_e\\,E(t),\\quad \\frac{dC}{dt}=\\gamma\\,E(t)-k_c\\,C(t),$$\nwhere $\\alpha$ (signal per egg), $k_i$ (per day), $\\beta$ (per day), $k_e$ (per day), $\\gamma$ (mg g$^{-1}$ per day per eosinophil-unit), and $k_c$ (per day) are nonnegative parameters.\n\nYour task is to derive, from these definitions, a correct numerical procedure to compute $C(T)$ for a given exposure horizon $T$ and a piecewise-constant egg arrival rate $a(t)$. Implement your derivation as a program that numerically integrates the system with a fixed time step of $\\Delta t=0.01$ days using a forward-time, first-order method consistent with the above dynamics. Ensure variables remain nonnegative under nonnegative inputs and parameters.\n\nPhysical units requirement: Report collagen as mg/g. The program must output the value of $C(T)$ for each specified test case rounded to $6$ decimal places.\n\nTest suite:\n- Case $1$ (chronic constant exposure, \"happy path\"): $T=180$; $a(t)=2000$ eggs/day for $t \\in [0, 180)$; $\\alpha=0.001$, $k_i=0.5$, $\\beta=0.1$, $k_e=0.2$, $\\gamma=0.05$, $k_c=0.01$.\n- Case $2$ (no exposure, edge condition): $T=180$; $a(t)=0$ eggs/day for $t \\in [0, 180)$; $\\alpha=0.001$, $k_i=0.5$, $\\beta=0.1$, $k_e=0.2$, $\\gamma=0.05$, $k_c=0.01$.\n- Case $3$ (early burst then cessation): $T=180$; $a(t)=2000$ eggs/day for $t \\in [0, 30)$ and $a(t)=0$ eggs/day for $t \\in [30, 180)$; $\\alpha=0.001$, $k_i=0.5$, $\\beta=0.1$, $k_e=0.2$, $\\gamma=0.05$, $k_c=0.01$.\n- Case $4$ (rapid eosinophil clearance): $T=180$; $a(t)=2000$ eggs/day for $t \\in [0, 180)$; $\\alpha=0.001$, $k_i=0.5$, $\\beta=0.1$, $k_e=1.0$, $\\gamma=0.05$, $k_c=0.01$.\n- Case $5$ (no collagen turnover, boundary): $T=180$; $a(t)=2000$ eggs/day for $t \\in [0, 180)$; $\\alpha=0.001$, $k_i=0.5$, $\\beta=0.1$, $k_e=0.2$, $\\gamma=0.05$, $k_c=0.0$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of Cases $1$ through $5$, with each value rounded to $6$ decimal places, for example, \"[x1,x2,x3,x4,x5]\".", "solution": "The problem requires the numerical integration of a system of coupled, linear, first-order ordinary differential equations (ODEs) that model a biological cascade. The system describes the dynamics of a chemoattractant signal $I(t)$, eosinophil infiltration $E(t)$, and collagen concentration $C(t)$ over time $t$, driven by parasite egg arrival $a(t)$. The governing equations are:\n$$ \\frac{dI}{dt}=\\alpha\\,a(t)-k_i\\,I(t) $$\n$$ \\frac{dE}{dt}=\\beta\\,I(t)-k_e\\,E(t) $$\n$$ \\frac{dC}{dt}=\\gamma\\,E(t)-k_c\\,C(t) $$\nThis forms an initial value problem with the specified conditions $I(0)=0$, $E(0)=0$, and $C(0)=0$.\n\nThe task is to solve this system numerically using a \"forward-time, first-order method\" with a fixed time step $\\Delta t = 0.01$ days. This specified method is the Forward Euler method. We discretize time such that $t_n = n \\Delta t$ for $n = 0, 1, 2, \\dots$. Let $I_n, E_n, C_n$ be the numerical approximations of $I(t_n), E(t_n), C(t_n)$, respectively.\n\nThe time derivative of a generic function $y(t)$ at time $t_n$, $\\frac{dy}{dt}|_{t_n}$, is approximated by the forward difference quotient:\n$$ \\frac{dy}{dt}\\bigg|_{t_n} \\approx \\frac{y(t_{n+1}) - y(t_n)}{\\Delta t} = \\frac{y_{n+1} - y_n}{\\Delta t} $$\nApplying this approximation to each ODE in the system yields a set of discrete update rules. For the first equation:\n$$ \\frac{I_{n+1} - I_n}{\\Delta t} = \\alpha\\,a(t_n) - k_i\\,I_n $$\nSolving for $I_{n+1}$ gives the iterative formula for the chemoattractant signal:\n$$ I_{n+1} = I_n + \\Delta t (\\alpha\\,a(t_n) - k_i\\,I_n) = (1 - k_i\\Delta t)I_n + \\alpha\\Delta t\\,a(t_n) $$\nSimilarly, for the eosinophil infiltration $E(t)$ and collagen concentration $C(t)$:\n$$ E_{n+1} = E_n + \\Delta t (\\beta I_n - k_e E_n) = (1 - k_e\\Delta t)E_n + \\beta\\Delta t\\,I_n $$\n$$ C_{n+1} = C_n + \\Delta t (\\gamma E_n - k_c C_n) = (1 - k_c\\Delta t)C_n + \\gamma\\Delta t\\,E_n $$\nThese three equations form the core of the numerical algorithm.\n\nA crucial requirement is to ensure the variables remain nonnegative. In the Forward Euler method, this is related to numerical stability. For an equation of the form $\\frac{dy}{dt} = -ky$, the update rule is $y_{n+1} = (1 - k\\Delta t)y_n$. If $y_n$ is positive, $y_{n+1}$ will remain positive only if $(1 - k\\Delta t) \\ge 0$, which implies a stability constraint on the time step: $\\Delta t \\le 1/k$. For our system, this constraint must hold for all decay constants: $\\Delta t \\le \\min(1/k_i, 1/k_e, 1/k_c)$.\n\nLet us verify this condition for the given parameters. The largest rate constant across all test cases is $k_e=1.0$ day$^{-1}$ in Case $4$. This requires $\\Delta t \\le 1/1.0 = 1.0$ day. The specified time step is $\\Delta t = 0.01$ days, which is well within this stability limit. The other parameters also satisfy this condition. Since the initial conditions are zero and all forcing terms ($\\alpha a(t_n)$, $\\beta I_n$, $\\gamma E_n$) are nonnegative throughout the simulation (as $I_n$ and $E_n$ will remain nonnegative), the numerical solution for $I(t)$, $E(t)$, and $C(t)$ will correctly remain nonnegative without any ad-hoc modifications.\n\nThe computational procedure is as follows:\n1.  Initialize the state variables: $I=0.0$, $E=0.0$, $C=0.0$.\n2.  Set the time step $\\Delta t = 0.01$. For a given total time $T$, the number of integration steps is $N = \\text{int}(T / \\Delta t)$.\n3.  Iterate $N$ times, with the loop index $n$ ranging from $0$ to $N-1$.\n4.  In each iteration, calculate the current time $t_n = n \\cdot \\Delta t$.\n5.  Evaluate the egg arrival rate $a(t_n)$ based on the piecewise-constant function for the specific test case.\n6.  Use the values of $I$, $E$, and $C$ from the current step to calculate their values at the next step using the derived update equations.\n7.  After the loop completes, the final value of $C$ is the numerical approximation of $C(T)$. This value is then formatted to $6$ decimal places. This process is repeated for each of the five test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the system of ODEs for schistosomiasis-induced liver fibrosis\n    using the Forward Euler method for a suite of test cases.\n    \"\"\"\n\n    # The fixed time step for numerical integration, in days.\n    dt = 0.01\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 180,\n            \"a_func\": lambda t: 2000.0,\n            \"params\": {\"alpha\": 0.001, \"k_i\": 0.5, \"beta\": 0.1, \"k_e\": 0.2, \"gamma\": 0.05, \"k_c\": 0.01},\n        },\n        {\n            \"T\": 180,\n            \"a_func\": lambda t: 0.0,\n            \"params\": {\"alpha\": 0.001, \"k_i\": 0.5, \"beta\": 0.1, \"k_e\": 0.2, \"gamma\": 0.05, \"k_c\": 0.01},\n        },\n        {\n            \"T\": 180,\n            \"a_func\": lambda t: 2000.0 if t < 30 else 0.0,\n            \"params\": {\"alpha\": 0.001, \"k_i\": 0.5, \"beta\": 0.1, \"k_e\": 0.2, \"gamma\": 0.05, \"k_c\": 0.01},\n        },\n        {\n            \"T\": 180,\n            \"a_func\": lambda t: 2000.0,\n            \"params\": {\"alpha\": 0.001, \"k_i\": 0.5, \"beta\": 0.1, \"k_e\": 1.0, \"gamma\": 0.05, \"k_c\": 0.01},\n        },\n        {\n            \"T\": 180,\n            \"a_func\": lambda t: 2000.0,\n            \"params\": {\"alpha\": 0.001, \"k_i\": 0.5, \"beta\": 0.1, \"k_e\": 0.2, \"gamma\": 0.05, \"k_c\": 0.0},\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        T = case[\"T\"]\n        a_func = case[\"a_func\"]\n        p = case[\"params\"]\n        alpha, k_i, beta, k_e, gamma, k_c = p[\"alpha\"], p[\"k_i\"], p[\"beta\"], p[\"k_e\"], p[\"gamma\"], p[\"k_c\"]\n\n        # Initialize state variables\n        I, E, C = 0.0, 0.0, 0.0\n\n        # Calculate the number of integration steps\n        num_steps = int(T / dt)\n\n        # Time-stepping loop using the Forward Euler method\n        for n in range(num_steps):\n            t = n * dt\n            \n            # Egg arrival rate at current time step\n            a_t = a_func(t)\n\n            # Update equations based on the Forward Euler discretization\n            # I_{n+1} = I_n + dt * (alpha * a(t_n) - k_i * I_n)\n            # E_{n+1} = E_n + dt * (beta * I_n - k_e * E_n)\n            # C_{n+1} = C_n + dt * (gamma * E_n - k_c * C_n)\n            I_next = I + dt * (alpha * a_t - k_i * I)\n            E_next = E + dt * (beta * I - k_e * E)\n            C_next = C + dt * (gamma * E - k_c * C)\n            \n            # Update state variables for the next iteration\n            I, E, C = I_next, E_next, C_next\n\n        # Append the final collagen concentration, formatted to 6 decimal places\n        results.append(f\"{C:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4788543"}]}