{"hands_on_practices": [{"introduction": "Single-cell RNA sequencing (scRNA-seq) provides unprecedented resolution into parasite biology but comes with technical challenges. This practice demonstrates how to address these challenges through size-factor normalization, a fundamental step to make gene expression levels comparable across individual cells. You will then apply a statistical approach to identify highly variable genes (HVGs), which often drive biological heterogeneity and are essential for downstream analyses like identifying different parasite life stages [@problem_id:4805895].", "problem": "A single-cell ribonucleic acid sequencing (scRNA-seq) experiment on the human malaria parasite Plasmodium falciparum measured Unique Molecular Identifier (UMI) counts for five parasite genes across three single cells, one from each of three asexual blood stages. Let the cells be labeled $C_{1}$, $C_{2}$, and $C_{3}$, and the genes be labeled $g_{1}, g_{2}, g_{3}, g_{4}, g_{5}$. The observed UMI count matrix (genes as rows, cells as columns) is\n$$\nX \\;=\\;\n\\begin{pmatrix}\n400 & 320 & 480 \\\\\n300 & 160 & 360 \\\\\n200 & 240 & 120 \\\\\n80 & 64 & 180 \\\\\n20 & 16 & 60\n\\end{pmatrix}.\n$$\nAssume the following foundational principles and modeling choices appropriate for UMI-based transcript counts in single-cell data:\n- The Central Dogma of molecular biology motivates that messenger ribonucleic acid abundance is a proxy for gene expression at the transcript level.\n- For UMI counts dominated by sampling noise, a Poisson model is a well-tested first approximation in which the variance equals the mean for a given gene after correcting for cell-specific capture efficiency.\n- Capture efficiency and sequencing depth differences across cells act as a multiplicative, cell-specific factor on all genes in that cell; thus, to compare expression across cells, counts must be normalized by a per-cell size factor that removes this multiplicative effect while preserving within-cell relative abundances.\n\nProceed as follows, using only these principles:\n1. Estimate a per-cell size factor $s_{j}$ for cell $C_{j}$ proportional to its total UMI count and scaled so that the median size factor across cells equals $1$. Then compute size-factor–normalized counts $Y_{ij}$ by dividing each observed count $X_{ij}$ by the corresponding $s_{j}$ for cell $C_{j}$.\n2. For each gene $g_{i}$, compute the across-cell mean $\\mu_{i}$ and the across-cell population variance $v_{i}$ of the normalized counts $Y_{ij}$, where the population variance is the arithmetic mean of squared deviations from the mean over the $3$ cells.\n3. Using the Poisson baseline (technical) variability expectation that $v_{i}$ should approximately equal $\\mu_{i}$ in the absence of biological variability, quantify standardized excess dispersion for each gene as the ratio of excess variance to the mean, namely $\\delta_{i} = (v_{i} - \\mu_{i})/\\mu_{i}$.\n4. Define a gene to be a highly variable gene (HVG) if $\\delta_{i} > 0.5$.\n\nWhat is the total number of HVGs identified by this procedure for the given matrix $X$? Provide your final answer as a single integer. No rounding is required.", "solution": "The problem requires us to identify Highly Variable Genes (HVGs) from a given matrix of Unique Molecular Identifier (UMI) counts by following a specified four-step procedure. The final answer is the total number of genes classified as HVGs.\n\nThe provided UMI count matrix is:\n$$\nX \\;=\\;\n\\begin{pmatrix}\n400 & 320 & 480 \\\\\n300 & 160 & 360 \\\\\n200 & 240 & 120 \\\\\n80 & 64 & 180 \\\\\n20 & 16 & 60\n\\end{pmatrix}\n$$\nwhere rows represent genes $g_{1}$ through $g_{5}$ and columns represent cells $C_{1}$, $C_{2}$, and $C_{3}$.\n\nStep 1: Estimate per-cell size factors and normalize the counts.\nThe size factor $s_{j}$ for cell $C_{j}$ is proportional to its total UMI count, $T_{j}$. First, we calculate the total UMI count for each cell by summing the counts in each column of $X$.\nFor cell $C_{1}$:\n$T_{1} = 400 + 300 + 200 + 80 + 20 = 1000$\nFor cell $C_{2}$:\n$T_{2} = 320 + 160 + 240 + 64 + 16 = 800$\nFor cell $C_{3}$:\n$T_{3} = 480 + 360 + 120 + 180 + 60 = 1200$\n\nThe raw size factors are $s'_{1} = 1000$, $s'_{2} = 800$, and $s'_{3} = 1200$. We scale these so that their median is $1$. The sorted values are $800, 1000, 1200$. The median of this set is $1000$.\nThe final size factors $s_{j}$ are obtained by dividing the raw factors by this median:\n$s_{1} = \\frac{T_{1}}{1000} = \\frac{1000}{1000} = 1$\n$s_{2} = \\frac{T_{2}}{1000} = \\frac{800}{1000} = 0.8$\n$s_{3} = \\frac{T_{3}}{1000} = \\frac{1200}{1000} = 1.2$\n\nNext, we compute the size-factor–normalized counts $Y_{ij}$ by dividing each observed count $X_{ij}$ by the size factor $s_{j}$ of the corresponding cell $C_{j}$.\n$$\nY_{ij} = \\frac{X_{ij}}{s_{j}}\n$$\nThis results in the normalized count matrix $Y$:\n$$\nY \\;=\\;\n\\begin{pmatrix}\n400/1 & 320/0.8 & 480/1.2 \\\\\n300/1 & 160/0.8 & 360/1.2 \\\\\n200/1 & 240/0.8 & 120/1.2 \\\\\n80/1 & 64/0.8 & 180/1.2 \\\\\n20/1 & 16/0.8 & 60/1.2\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n400 & 400 & 400 \\\\\n300 & 200 & 300 \\\\\n200 & 300 & 100 \\\\\n80 & 80 & 150 \\\\\n20 & 20 & 50\n\\end{pmatrix}\n$$\n\nStep 2 & 3: Compute per-gene statistics and standardized excess dispersion.\nFor each gene $g_{i}$, we compute the across-cell mean $\\mu_{i}$ and population variance $v_{i}$ of the normalized counts $Y_{ij}$ over the $3$ cells. The population variance is defined as $v_{i} = \\frac{1}{3}\\sum_{j=1}^{3} (Y_{ij} - \\mu_{i})^2$. We then calculate the standardized excess dispersion $\\delta_{i} = (v_{i} - \\mu_{i})/\\mu_{i}$.\n\nFor gene $g_{1}$: $Y_{1j} = (400, 400, 400)$\n$\\mu_{1} = \\frac{400+400+400}{3} = 400$\n$v_{1} = \\frac{(400-400)^2 + (400-400)^2 + (400-400)^2}{3} = 0$\n$\\delta_{1} = \\frac{v_{1} - \\mu_{1}}{\\mu_{1}} = \\frac{0 - 400}{400} = -1$\n\nFor gene $g_{2}$: $Y_{2j} = (300, 200, 300)$\n$\\mu_{2} = \\frac{300+200+300}{3} = \\frac{800}{3}$\n$v_{2} = \\frac{(300 - \\frac{800}{3})^2 + (200 - \\frac{800}{3})^2 + (300 - \\frac{800}{3})^2}{3} = \\frac{(\\frac{100}{3})^2 + (-\\frac{200}{3})^2 + (\\frac{100}{3})^2}{3} = \\frac{\\frac{10000}{9} + \\frac{40000}{9} + \\frac{10000}{9}}{3} = \\frac{60000}{27} = \\frac{20000}{9}$\n$\\delta_{2} = \\frac{v_{2} - \\mu_{2}}{\\mu_{2}} = \\frac{\\frac{20000}{9} - \\frac{800}{3}}{\\frac{800}{3}} = \\frac{\\frac{20000-2400}{9}}{\\frac{2400}{9}} = \\frac{17600}{2400} = \\frac{176}{24} = \\frac{22}{3}$\n\nFor gene $g_{3}$: $Y_{3j} = (200, 300, 100)$\n$\\mu_{3} = \\frac{200+300+100}{3} = \\frac{600}{3} = 200$\n$v_{3} = \\frac{(200-200)^2 + (300-200)^2 + (100-200)^2}{3} = \\frac{0 + 100^2 + (-100)^2}{3} = \\frac{20000}{3}$\n$\\delta_{3} = \\frac{v_{3} - \\mu_{3}}{\\mu_{3}} = \\frac{\\frac{20000}{3} - 200}{200} = \\frac{\\frac{20000-600}{3}}{200} = \\frac{19400}{600} = \\frac{194}{6} = \\frac{97}{3}$\n\nFor gene $g_{4}$: $Y_{4j} = (80, 80, 150)$\n$\\mu_{4} = \\frac{80+80+150}{3} = \\frac{310}{3}$\n$v_{4} = \\frac{(80-\\frac{310}{3})^2 + (80-\\frac{310}{3})^2 + (150-\\frac{310}{3})^2}{3} = \\frac{(-\\frac{70}{3})^2 + (-\\frac{70}{3})^2 + (\\frac{140}{3})^2}{3} = \\frac{\\frac{4900}{9} + \\frac{4900}{9} + \\frac{19600}{9}}{3} = \\frac{29400}{27} = \\frac{9800}{9}$\n$\\delta_{4} = \\frac{v_{4} - \\mu_{4}}{\\mu_{4}} = \\frac{\\frac{9800}{9} - \\frac{310}{3}}{\\frac{310}{3}} = \\frac{\\frac{9800-930}{9}}{\\frac{930}{9}} = \\frac{8870}{930} = \\frac{887}{93}$\n\nFor gene $g_{5}$: $Y_{5j} = (20, 20, 50)$\n$\\mu_{5} = \\frac{20+20+50}{3} = \\frac{90}{3} = 30$\n$v_{5} = \\frac{(20-30)^2 + (20-30)^2 + (50-30)^2}{3} = \\frac{(-10)^2 + (-10)^2 + 20^2}{3} = \\frac{100+100+400}{3} = \\frac{600}{3} = 200$\n$\\delta_{5} = \\frac{v_{5} - \\mu_{5}}{\\mu_{5}} = \\frac{200 - 30}{30} = \\frac{170}{30} = \\frac{17}{3}$\n\nStep 4: Identify and count the HVGs.\nA gene is defined as an HVG if its standardized excess dispersion $\\delta_{i} > 0.5$. We check this condition for each gene.\n$g_{1}: \\delta_{1} = -1$. Since $-1 \\ngtr 0.5$, $g_{1}$ is not an HVG.\n$g_{2}: \\delta_{2} = \\frac{22}{3} \\approx 7.33$. Since $\\frac{22}{3} > 0.5$, $g_{2}$ is an HVG.\n$g_{3}: \\delta_{3} = \\frac{97}{3} \\approx 32.33$. Since $\\frac{97}{3} > 0.5$, $g_{3}$ is an HVG.\n$g_{4}: \\delta_{4} = \\frac{887}{93} \\approx 9.54$. Since $\\frac{887}{93} > 0.5$, $g_{4}$ is an HVG.\n$g_{5}: \\delta_{5} = \\frac{17}{3} \\approx 5.67$. Since $\\frac{17}{3} > 0.5$, $g_{5}$ is an HVG.\n\nThe genes identified as HVGs are $g_{2}, g_{3}, g_{4},$ and $g_{5}$.\nThe total number of HVGs is $4$.", "answer": "$$\\boxed{4}$$", "id": "4805895"}, {"introduction": "After an omics experiment yields a list of interesting genes, the next challenge is to understand their collective biological function. This exercise introduces Gene Ontology (GO) enrichment analysis, a powerful method to discover if a gene list is significantly associated with certain biological processes or pathways. You will use the hypergeometric test to calculate statistical significance and, crucially, learn to apply procedures that correct for testing multiple hypotheses at once, a vital skill for avoiding false discoveries in large datasets [@problem_id:4805833].", "problem": "A targeted transcriptomics panel in the malaria parasite Plasmodium falciparum profiled a universe of $40$ genes under antimalarial drug pressure. A differential expression analysis identified $8$ genes as differentially expressed. To interpret the result biologically, you conduct a one-sided Gene Ontology (GO) over-representation analysis under the null model that differentially expressed genes are a random sample drawn without replacement from the gene universe. This implies a hypergeometric sampling model based on counts.\n\nFour GO biological process terms of interest and their gene-annotation counts in the $40$-gene universe, together with the observed overlaps with the $8$ differentially expressed genes, are:\n\n- GO: heme metabolic process: annotated genes in universe $K = 6$; overlap with differentially expressed list $k = 4$.\n- GO: glycolytic process: $K = 10$; $k = 5$.\n- GO: microtubule-based movement: $K = 5$; $k = 1$.\n- GO: mitochondrial translation: $K = 12$; $k = 4$.\n\nUsing only the core definitions of sampling without replacement and the hypergeometric distribution as the null for over-representation, compute for each GO term the right-tailed hypergeometric $p$-value for observing at least the given $k$ successes in $n = 8$ draws from the population of size $N = 40$ with $K$ annotated successes. Then adjust the resulting $4$ $p$-values for multiple testing using the Benjamini–Hochberg (BH) procedure to control the False Discovery Rate (FDR).\n\nWhat is the Benjamini–Hochberg adjusted $p$-value for GO: glycolytic process? Express your answer as a decimal and round your final answer to four significant figures.", "solution": "The problem requires the calculation of a Benjamini–Hochberg (BH) adjusted $p$-value for a specific Gene Ontology (GO) term from a set of four. This involves two main steps: first, calculating the raw $p$-value for each GO term using a right-tailed hypergeometric test, and second, applying the BH multiple testing correction procedure.\n\nThe general parameters for the hypergeometric model are provided:\n- The total number of genes in the background set (population size) is $N = 40$.\n- The number of genes selected as differentially expressed (sample size) is $n = 8$.\n\nThe null hypothesis for the over-representation analysis is that the $n=8$ differentially expressed genes are a random sample drawn without replacement from the $N=40$ total genes. For a given GO term that annotates $K$ genes in the population, the number of annotated genes $X$ observed in the sample of size $n$ follows a hypergeometric distribution. The probability mass function (PMF) is:\n$$ P(X=k) = \\frac{\\binom{K}{k} \\binom{N-K}{n-k}}{\\binom{N}{n}} $$\nwhere $k$ is the number of observed successes (annotated genes in the sample).\n\nThe problem asks for a one-sided, right-tailed $p$-value, which is the probability of observing at least $k$ successes by chance. This cumulative probability is given by:\n$$ p = P(X \\ge k) = \\sum_{i=k}^{\\min(n, K)} P(X=i) = \\sum_{i=k}^{\\min(n, K)} \\frac{\\binom{K}{i} \\binom{N-K}{n-i}}{\\binom{N}{n}} $$\n\nFirst, we calculate the denominator $\\binom{N}{n}$, which is constant for all tests:\n$$ \\binom{40}{8} = \\frac{40!}{8!(40-8)!} = 76904685 $$\n\nNow, we compute the raw $p$-value for each of the four GO terms.\n\n1.  **GO: heme metabolic process**: $K = 6$, $k = 4$.\n    The $p$-value is $p_1 = P(X \\ge 4)$ for $X \\sim \\text{Hypergeometric}(N=40, K=6, n=8)$.\n    $$ p_1 = \\sum_{i=4}^{6} \\frac{\\binom{6}{i}\\binom{34}{8-i}}{\\binom{40}{8}} = \\frac{\\binom{6}{4}\\binom{34}{4} + \\binom{6}{5}\\binom{34}{3} + \\binom{6}{6}\\binom{34}{2}}{76904685} $$\n    $$ p_1 = \\frac{(15)(46376) + (6)(5984) + (1)(561)}{76904685} = \\frac{695640 + 35904 + 561}{76904685} = \\frac{732105}{76904685} \\approx 0.00951964 $$\n\n2.  **GO: glycolytic process**: $K = 10$, $k = 5$.\n    The $p$-value is $p_2 = P(X \\ge 5)$ for $X \\sim \\text{Hypergeometric}(N=40, K=10, n=8)$.\n    $$ p_2 = \\sum_{i=5}^{8} \\frac{\\binom{10}{i}\\binom{30}{8-i}}{\\binom{40}{8}} = \\frac{\\binom{10}{5}\\binom{30}{3} + \\binom{10}{6}\\binom{30}{2} + \\binom{10}{7}\\binom{30}{1} + \\binom{10}{8}\\binom{30}{0}}{76904685} $$\n    $$ p_2 = \\frac{(252)(4060) + (210)(435) + (120)(30) + (45)(1)}{76904685} = \\frac{1023120 + 91350 + 3600 + 45}{76904685} = \\frac{1118115}{76904685} \\approx 0.0145389 $$\n\n3.  **GO: microtubule-based movement**: $K = 5$, $k = 1$.\n    The $p$-value is $p_3 = P(X \\ge 1) = 1 - P(X=0)$ for $X \\sim \\text{Hypergeometric}(N=40, K=5, n=8)$.\n    $$ p_3 = 1 - \\frac{\\binom{5}{0}\\binom{35}{8}}{\\binom{40}{8}} = 1 - \\frac{(1)(23535820)}{76904685} \\approx 1 - 0.3060373 = 0.6939627 $$\n\n4.  **GO: mitochondrial translation**: $K = 12$, $k = 4$.\n    The $p$-value is $p_4 = P(X \\ge 4)$ for $X \\sim \\text{Hypergeometric}(N=40, K=12, n=8)$.\n    $$ p_4 = \\sum_{i=4}^{8} \\frac{\\binom{12}{i}\\binom{28}{8-i}}{\\binom{40}{8}} = \\frac{\\binom{12}{4}\\binom{28}{4} + \\binom{12}{5}\\binom{28}{3} + \\binom{12}{6}\\binom{28}{2} + \\binom{12}{7}\\binom{28}{1} + \\binom{12}{8}\\binom{28}{0}}{76904685} $$\n    $$ p_4 = \\frac{(495)(20475) + (792)(3276) + (924)(378) + (792)(28) + (495)(1)}{76904685} = \\frac{13101660}{76904685} \\approx 0.1703631 $$\n\nWith the four raw $p$-values calculated, we now apply the Benjamini–Hochberg procedure to the set of $m=4$ tests.\n1.  Order the raw $p$-values from smallest to largest, noting their original identity:\n    - $p_{(1)} = p_1 \\approx 0.00951964$ (heme)\n    - $p_{(2)} = p_2 \\approx 0.0145389$ (glycolytic)\n    - $p_{(3)} = p_4 \\approx 0.1703631$ (mitochondrial)\n    - $p_{(4)} = p_3 \\approx 0.6939627$ (microtubule)\nThe rank of each $p$-value is its position $i$ in this sorted list.\n\n2.  Calculate the adjusted $p$-value for each rank. The BH adjusted $p$-value for the test with rank $i$, denoted $p_{adj,(i)}$, is calculated by starting from the largest rank and enforcing monotonicity.\n    The rule is: $p_{adj,(i)} = \\min\\left( p_{(i)} \\times \\frac{m}{i}, p_{adj,(i+1)} \\right)$, with the base case $p_{adj,(m)} = p_{(m)}$.\n\n    - For rank $i=4$:\n      $p_{adj,(4)} = p_{(4)} \\times \\frac{4}{4} = 0.6939627 \\times 1 = 0.6939627$.\n    - For rank $i=3$:\n      The intermediate value is $p_{(3)} \\times \\frac{4}{3} = 0.1703631 \\times \\frac{4}{3} \\approx 0.2271508$.\n      $p_{adj,(3)} = \\min(0.2271508, p_{adj,(4)}) = \\min(0.2271508, 0.6939627) = 0.2271508$.\n    - For rank $i=2$:\n      The intermediate value is $p_{(2)} \\times \\frac{4}{2} = 0.0145389 \\times 2 = 0.0290778$.\n      $p_{adj,(2)} = \\min(0.0290778, p_{adj,(3)}) = \\min(0.0290778, 0.2271508) = 0.0290778$.\n    - For rank $i=1$:\n      The intermediate value is $p_{(1)} \\times \\frac{4}{1} = 0.00951964 \\times 4 = 0.03807856$.\n      $p_{adj,(1)} = \\min(0.03807856, p_{adj,(2)}) = \\min(0.03807856, 0.0290778) = 0.0290778$.\n\nThe inquiry is for the adjusted $p$-value for **GO: glycolytic process**. This term's raw $p$-value was $p_2$, which holds the rank $i=2$ in the sorted list. Its adjusted $p$-value is therefore $p_{adj,(2)}$.\n$$ p_{\\text{adj, glycolytic}} = p_{adj,(2)} \\approx 0.0290778 $$\nRounding the final answer to four significant figures gives $0.02908$.", "answer": "$$\\boxed{0.02908}$$", "id": "4805833"}, {"introduction": "Genomic data can be used to infer complex biological properties of an infection, moving beyond simple gene lists. This advanced practice explores how to estimate the Multiplicity of Infection (MOI)—the number of distinct parasite clones within a host—a critical parameter in epidemiology. You will use a statistical model to connect raw sequencing read counts from polymorphic loci to the MOI, showcasing how bioinformatics can bridge molecular data and population-level questions [@problem_id:4805878].", "problem": "A clinical malaria blood sample is sequenced using short-read Next Generation Sequencing (NGS), and biallelic Single Nucleotide Polymorphisms (SNPs) across the parasite genome are analyzed to infer the Multiplicity of Infection (MOI), defined as the number of distinct haploid parasite clones, denoted by $k$. Assume the following fundamental basis for modeling read counts across loci:\n\n- Clones are haploid and independent draws from a parasite population in Hardy–Weinberg-like equilibrium at each SNP locus, with alternate allele population frequency $q$.\n- At a given locus, the number of clones carrying the alternate allele among $k$ clones is $m \\sim \\text{Binomial}(k, q)$.\n- Sequencing reads at that locus are sampled uniformly from clones, so the true alternate allele fraction is $\\theta = m/k$. Given sequencing depth $n$, the observed alternate allele read count $x$ follows $x \\sim \\text{Binomial}(n, \\theta)$.\n- Loci are conditionally independent given $k$.\n\nYou are provided data for $L=4$ loci. For locus $i$, the known alternate allele frequency in the broader parasite population is $q_i$, the observed total read depth is $n_i$, and the observed alternate allele read count is $x_i$:\n\n- Locus $1$: $q_1 = 0.1$, $n_1 = 18$, $x_1 = 6$.\n- Locus $2$: $q_2 = 0.2$, $n_2 = 24$, $x_2 = 8$.\n- Locus $3$: $q_3 = 0.3$, $n_3 = 30$, $x_3 = 10$.\n- Locus $4$: $q_4 = 0.4$, $n_4 = 27$, $x_4 = 9$.\n\nStarting from the fundamental basis stated above, derive the marginal likelihood $L(k)$ of the MOI $k$ given the data $\\{(q_i,n_i,x_i)\\}_{i=1}^{L}$, by integrating over the unobserved number of alternate-allele clones $m_i$ at each locus. Evaluate $L(k)$ up to a proportionality constant common to all $k$ for the candidate set $k \\in \\{1,2,3,4\\}$, determine the maximum likelihood estimate (MLE) $\\hat{k}$, and compute a $95\\%$ likelihood-ratio-based support interval for $k$ defined as the set of $k$ such that $2\\left[\\ln L(\\hat{k}) - \\ln L(k)\\right] \\leq \\chi^{2}_{0.95,\\,1}$, where $\\chi^{2}_{0.95,\\,1}$ is the $95\\%$ quantile of the chi-square distribution with $1$ degree of freedom.\n\nExpress the final MOI estimate $\\hat{k}$ as an integer. No rounding is required for the final answer. The uncertainty interval does not need to be included in the final answer but must be derived in your solution.", "solution": "The goal is to determine the Multiplicity of Infection (MOI), $k$, that maximizes the likelihood of the observed sequencing data. The data consists of read counts from $L=4$ independent single nucleotide polymorphism (SNP) loci.\n\nThe overall likelihood of $k$, given the data from all loci, is the product of the likelihoods for each locus, due to the specified conditional independence:\n$$L(k) = P(\\{(x_i, n_i)\\}_{i=1}^{L} | k, \\{q_i\\}_{i=1}^{L}) = \\prod_{i=1}^{L} P(x_i | n_i, k, q_i)$$\nWe must derive the marginal likelihood for a single locus $i$, $P(x_i | n_i, k, q_i)$, by summing over the unobserved latent variable $m_i$, which is the number of clones carrying the alternate allele. Using the law of total probability:\n$$P(x_i | n_i, k, q_i) = \\sum_{m_i=0}^{k} P(x_i, m_i | n_i, k, q_i)$$\nUsing the chain rule of probability, this becomes:\n$$P(x_i | n_i, k, q_i) = \\sum_{m_i=0}^{k} P(x_i | n_i, k, q_i, m_i) P(m_i | n_i, k, q_i)$$\nFrom the problem statement, we have the following conditional probability models:\n1.  The probability of the observed read count $x_i$ depends on the true allele fraction $\\theta_i = m_i/k$ and the sequencing depth $n_i$. This is a binomial sampling process: $P(x_i | n_i, k, q_i, m_i) = P(x_i | n_i, \\theta_i=m_i/k) = \\binom{n_i}{x_i} (\\frac{m_i}{k})^{x_i} (1 - \\frac{m_i}{k})^{n_i-x_i}$.\n2.  The probability of having $m_i$ clones with the alternate allele depends on the total number of clones $k$ and the population allele frequency $q_i$: $P(m_i | n_i, k, q_i) = P(m_i | k, q_i) = \\binom{k}{m_i} q_i^{m_i} (1-q_i)^{k-m_i}$.\n\nSubstituting these into the marginal likelihood expression for a single locus gives:\n$$P(x_i | n_i, k, q_i) = \\sum_{m_i=0}^{k} \\left[ \\binom{n_i}{x_i} \\left(\\frac{m_i}{k}\\right)^{x_i} \\left(1 - \\frac{m_i}{k}\\right)^{n_i-x_i} \\right] \\left[ \\binom{k}{m_i} q_i^{m_i} (1-q_i)^{k-m_i} \\right]$$\nTo find the MLE $\\hat{k}$, we seek to maximize $L(k)$ or, more conveniently, its logarithm, $\\ln L(k)$.\n$$\\ln L(k) = \\sum_{i=1}^{L} \\ln P(x_i | n_i, k, q_i) = \\sum_{i=1}^{L} \\left( \\ln\\binom{n_i}{x_i} + \\ln\\left[ \\sum_{m_i=0}^{k} \\binom{k}{m_i} q_i^{m_i} (1-q_i)^{k-m_i} \\left(\\frac{m_i}{k}\\right)^{x_i} \\left(1 - \\frac{m_i}{k}\\right)^{n_i-x_i} \\right] \\right)$$\nThe term $\\sum_{i=1}^{L} \\ln\\binom{n_i}{x_i}$ is a constant with respect to $k$ and can be ignored for the purpose of maximization. We can define a proportional log-likelihood, $\\ln L'(k)$:\n$$\\ln L'(k) = \\sum_{i=1}^{L} \\ln S_i(k) \\quad \\text{where} \\quad S_i(k) = \\sum_{m_i=0}^{k} \\binom{k}{m_i} q_i^{m_i} (1-q_i)^{k-m_i} \\left(\\frac{m_i}{k}\\right)^{x_i} \\left(1 - \\frac{m_i}{k}\\right)^{n_i-x_i}$$\nFor all four loci, the data shows $x_i > 0$ and $n_i - x_i > 0$. The read sampling likelihood term $(\\frac{m_i}{k})^{x_i} (1 - \\frac{m_i}{k})^{n_i-x_i}$ is zero if $m_i=0$ (since $x_i>0$) or if $m_i=k$ (since $n_i-x_i>0$). Therefore, the summation for $S_i(k)$ only needs to run from $m_i=1$ to $m_i=k-1$.\n\nWe now evaluate $\\ln L'(k)$ for each candidate value $k \\in \\{1, 2, 3, 4\\}$.\n\n**For $k=1$**: The summation range for $m_i$ from $1$ to $k-1$ is empty ($1$ to $0$). Thus, $S_i(1) = 0$ for all loci, and $\\ln L'(1) = -\\infty$. This is logical, as a single clone cannot produce reads of both a reference and an alternate allele at the same locus.\n\n**For $k=2$**: The sum for $m_i$ runs from $1$ to $1$, so it has only one term.\n$S_i(2) = \\binom{2}{1} q_i^1 (1-q_i)^1 \\left(\\frac{1}{2}\\right)^{x_i} \\left(1 - \\frac{1}{2}\\right)^{n_i-x_i} = 2 q_i(1-q_i) (0.5)^{n_i}$.\nCalculating $\\ln S_i(2)$ for each locus:\n-   Locus $1: \\ln S_1(2) = \\ln[2(0.1)(0.9)(0.5)^{18}] \\approx -14.1915$\n-   Locus $2: \\ln S_2(2) = \\ln[2(0.2)(0.8)(0.5)^{24}] \\approx -17.7750$\n-   Locus $3: \\ln S_3(2) = \\ln[2(0.3)(0.7)(0.5)^{30}] \\approx -21.6620$\n-   Locus $4: \\ln S_4(2) = \\ln[2(0.4)(0.6)(0.5)^{27}] \\approx -19.4490$\n$\\ln L'(2) = \\sum_{i=1}^4 \\ln S_i(2) \\approx -14.1915 - 17.7750 - 21.6620 - 19.4490 \\approx -73.0785$.\n\n**For $k=3$**: The sum for $m_i$ runs from $1$ to $2$.\n$S_i(3) = \\binom{3}{1} q_i(1-q_i)^2 (\\frac{1}{3})^{x_i}(\\frac{2}{3})^{n_i-x_i} + \\binom{3}{2} q_i^2(1-q_i) (\\frac{2}{3})^{x_i}(\\frac{1}{3})^{n_i-x_i}$.\n-   Locus $1: \\ln S_1(3) \\approx -12.8694$\n-   Locus $2: \\ln S_2(3) \\approx -16.2338$\n-   Locus $3: \\ln S_3(3) \\approx -19.9146$\n-   Locus $4: \\ln S_4(3) \\approx -18.0258$\n$\\ln L'(3) = \\sum_{i=1}^4 \\ln S_i(3) \\approx -12.8694 - 16.2338 - 19.9146 - 18.0258 \\approx -67.0436$.\n\n**For $k=4$**: The sum for $m_i$ runs from $1$ to $3$.\n$S_i(4) = \\sum_{m_i=1}^{3} \\binom{4}{m_i} q_i^{m_i}(1-q_i)^{4-m_i} (\\frac{m_i}{4})^{x_i}(1-\\frac{m_i}{4})^{n_i-x_i}$.\n-   Locus $1: \\ln S_1(4) \\approx -12.9234$\n-   Locus $2: \\ln S_2(4) \\approx -16.4492$\n-   Locus $3: \\ln S_3(4) \\approx -20.3204$\n-   Locus $4: \\ln S_4(4) \\approx -18.4173$\n$\\ln L'(4) = \\sum_{i=1}^4 \\ln S_i(4) \\approx -12.9234 - 16.4492 - 20.3204 - 18.4173 \\approx -68.1103$.\n\n**Maximum Likelihood Estimate (MLE)**\nWe compare the proportional log-likelihoods:\n-   $\\ln L'(1) = -\\infty$\n-   $\\ln L'(2) \\approx -73.0785$\n-   $\\ln L'(3) \\approx -67.0436$\n-   $\\ln L'(4) \\approx -68.1103$\n\nThe maximum log-likelihood value is approximately $-67.0436$, which occurs at $k=3$. Therefore, the maximum likelihood estimate for the MOI is $\\hat{k}=3$.\n\n**95% Support Interval**\nThe support interval is the set of $k$ values for which the likelihood is not significantly lower than the maximum likelihood. The interval is defined by $\\{k | 2[\\ln L(\\hat{k}) - \\ln L(k)] \\leq \\chi^{2}_{0.95,\\,1}\\}$. We can use $\\ln L'(k)$ as the constant terms cancel. The critical value from the chi-square distribution with $1$ degree of freedom for a $95\\%$ confidence level is $\\chi^{2}_{0.95,\\,1} \\approx 3.841$.\nWe have $\\hat{k}=3$ and $\\ln L'(\\hat{k}) \\approx -67.0436$.\nWe compute the likelihood ratio statistic $D(k) = 2[\\ln L'(3) - \\ln L'(k)]$ for each $k$:\n-   $D(1) = 2[-67.0436 - (-\\infty)] = \\infty > 3.841$.\n-   $D(2) = 2[-67.0436 - (-73.0785)] = 2(6.0349) = 12.0698 > 3.841$.\n-   $D(3) = 2[-67.0436 - (-67.0436)] = 0 \\leq 3.841$.\n-   $D(4) = 2[-67.0436 - (-68.1103)] = 2(1.0667) = 2.1334 \\leq 3.841$.\n\nThe values of $k$ that satisfy the condition are $3$ and $4$. Thus, the $95\\%$ support interval is $\\{3, 4\\}$.\nThe problem asks for the single integer value of the MLE, $\\hat{k}$. Based on our analysis, this is $3$.", "answer": "$$\\boxed{3}$$", "id": "4805878"}]}