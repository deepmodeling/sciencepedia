{"hands_on_practices": [{"introduction": "The electrical stability of every heart cell begins with its resting membrane potential. This potential is not static; it's a dynamic equilibrium determined by ion concentrations across the cell membrane. This exercise explores how a common pathological condition, ischemia, alters potassium levels and shifts this crucial potential, providing a quantitative look at the very first step in many arrhythmogenic processes. By applying the Nernst equation, you will calculate how these ionic shifts can depolarize a myocyte, making it more prone to abnormal electrical activity. [@problem_id:4818509]", "problem": "A ventricular myocyte at physiological temperature experiences an ischemic perturbation that alters transmembrane potassium gradients, a key driver of arrhythmogenesis through depolarization-induced inactivation of voltage-gated sodium channels. Treat the resting state as dominated by potassium permeability so that the resting membrane potential approximates the potassium equilibrium potential. Assume ideal dilute solution behavior and that electrochemical equilibrium for potassium is defined by equality of the electrochemical potential inside and outside the cell. The myocyteâ€™s initial state is characterized by intracellular potassium concentration $[K^{+}]_{i,0} = 140\\,\\text{mM}$ and extracellular potassium concentration $[K^{+}]_{o,0} = 4.0\\,\\text{mM}$. During early ischemia, the values shift to $[K^{+}]_{i,1} = 130\\,\\text{mM}$ and $[K^{+}]_{o,1} = 7.0\\,\\text{mM}$. The temperature is $T = 310\\,\\text{K}$. Use the universal gas constant $R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$, the Faraday constant $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$, and the potassium valence $z = +1$. \n\nStarting from the equality of electrochemical potentials for potassium at equilibrium and ideal dilute behavior, derive the ionic equilibrium potential expression and use it to calculate the ischemia-induced change in the potassium equilibrium potential $\\Delta E_{K} = E_{K,1} - E_{K,0}$. Round your final answer to three significant figures. Express your answer in millivolts.", "solution": "The pathophysiological link between altered transmembrane ion gradients and cardiac arrhythmias arises from how membrane potential depends on ionic electrochemical equilibria. For an ion of valence $z$, the electrochemical potential is given by\n$$\n\\mu = \\mu^{0} + RT \\ln a + z F \\psi,\n$$\nwhere $a$ is the activity (approximated by concentration under ideal dilute conditions), $R$ is the universal gas constant, $T$ is absolute temperature, $F$ is the Faraday constant, and $\\psi$ is the electric potential. At electrochemical equilibrium for a given ion across a membrane separating an outside compartment (o) from an inside compartment (i), one has\n$$\n\\mu_{o} = \\mu_{i}.\n$$\nSubstituting and rearranging using ideal dilute activities, this gives\n$$\n\\mu^{0} + RT \\ln [X]_{o} + z F \\psi_{o} \\;=\\; \\mu^{0} + RT \\ln [X]_{i} + z F \\psi_{i}.\n$$\nCanceling $\\mu^{0}$ and solving for the potential difference $E \\equiv \\psi_{i} - \\psi_{o}$ yields the Nernst equilibrium potential:\n$$\nE \\;=\\; \\frac{RT}{zF} \\ln\\!\\left(\\frac{[X]_{o}}{[X]_{i}}\\right).\n$$\nFor potassium with valence $z = +1$, the potassium equilibrium potential is\n$$\nE_{K} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{[K^{+}]_{o}}{[K^{+}]_{i}}\\right).\n$$\nGiven that resting membrane potential in ventricular myocytes is dominated by potassium permeability, the resting potential approximates $E_{K}$. Therefore, the ischemia-induced change in the resting potential can be approximated as\n$$\n\\Delta E_{K} \\;=\\; E_{K,1} - E_{K,0} \\;=\\; \\frac{RT}{F} \\left[\\ln\\!\\left(\\frac{[K^{+}]_{o,1}}{[K^{+}]_{i,1}}\\right) - \\ln\\!\\left(\\frac{[K^{+}]_{o,0}}{[K^{+}]_{i,0}}\\right)\\right].\n$$\nCombine logarithms:\n$$\n\\Delta E_{K} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{[K^{+}]_{o,1}/[K^{+}]_{i,1}}{[K^{+}]_{o,0}/[K^{+}]_{i,0}}\\right) \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{[K^{+}]_{o,1}\\,[K^{+}]_{i,0}}{[K^{+}]_{i,1}\\,[K^{+}]_{o,0}}\\right).\n$$\nSubstitute the provided values, keeping symbols until the final numerical step:\n- $R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$,\n- $T = 310\\,\\text{K}$,\n- $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$,\n- $[K^{+}]_{o,1} = 7.0\\,\\text{mM}$,\n- $[K^{+}]_{i,1} = 130\\,\\text{mM}$,\n- $[K^{+}]_{o,0} = 4.0\\,\\text{mM}$,\n- $[K^{+}]_{i,0} = 140\\,\\text{mM}$.\n\nCompute the argument of the logarithm:\n$$\n\\frac{[K^{+}]_{o,1}\\,[K^{+}]_{i,0}}{[K^{+}]_{i,1}\\,[K^{+}]_{o,0}} \\;=\\; \\frac{(7.0)(140)}{(130)(4.0)} \\;=\\; \\frac{980}{520} \\;=\\; \\frac{49}{26} \\;=\\; 1.884615\\ldots.\n$$\nThus,\n$$\n\\Delta E_{K} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(1.884615\\ldots\\right).\n$$\nEvaluate the prefactor:\n$$\n\\frac{RT}{F} \\;=\\; \\frac{(8.314)(310)}{96485}\\,\\text{V} \\;\\approx\\; 0.0267\\,\\text{V}.\n$$\nEvaluate the natural logarithm and multiply:\n$$\n\\ln(1.884615\\ldots) \\;\\approx\\; 0.6335,\n$$\nso\n$$\n\\Delta E_{K} \\;\\approx\\; (0.0267\\,\\text{V})(0.6335) \\;=\\; 0.0169\\,\\text{V} \\;=\\; 16.9\\,\\text{mV}.\n$$\nA positive $\\Delta E_{K}$ indicates depolarization (a less negative equilibrium potential), which is arrhythmogenic because it reduces availability of fast sodium channels and slows conduction. Rounding to three significant figures and expressing in millivolts, the ischemia-induced change is $16.9\\,\\text{mV}$.", "answer": "$$\\boxed{16.9}$$", "id": "4818509"}, {"introduction": "A heart cell's ability to fire an action potential is followed by a necessary recovery period, known as refractoriness. This is governed by the time it takes for voltage-gated ion channels to reset. This practice focuses on the recovery kinetics of the fast sodium channels, which are essential for the rapid upstroke of the action potential and for conducting the electrical impulse through the heart. By modeling this recovery, you will determine the minimal time required between beats for the tissue to remain fully excitable, a concept that is fundamental to understanding conduction block and the initiation of reentrant arrhythmias. [@problem_id:4818499]", "problem": "A myocyte strand exhibiting fast inward sodium current recovery kinetics is paced at a basic cycle length that allows full repolarization between beats. Consider the sodium channel inactivation gate variable $h(t)$, which follows first-order recovery toward its steady-state value at a fixed diastolic membrane potential of $-80$ millivolts during the diastolic interval. The recovery dynamics are governed by a standard first-order relaxation law: $h(t)$ relaxes toward the steady-state value $h_{\\infty}$ with a time constant $\\tau_{h}$ when the membrane potential is held constant. At the onset of diastole ($t = 0$), immediately after the preceding Action Potential (AP) has repolarized to $-80$ millivolts, the inactivation gate variable is $h(0) = h_{0}$.\n\nA premature stimulus is delivered at time $t = \\mathrm{DI}$ (the diastolic interval) after repolarization. For sustained conduction in this strand, the maximum rate of rise of membrane voltage during the upstroke must exceed a source-sink threshold, which in this setting is equivalent to requiring the fraction of recoverable sodium channels to be at least a critical value $h_{\\mathrm{crit}}$ at the instant of stimulation. Assume the activation gates open rapidly compared to inactivation recovery, so that the availability for sodium current during the upstroke is limited by $h(t)$.\n\nUse the following scientifically plausible parameters at $-80$ millivolts:\n- Steady-state inactivation value $h_{\\infty} = 0.95$,\n- Time constant of recovery $\\tau_{h} = 30$ milliseconds,\n- Initial inactivation gate at diastole onset $h_{0} = 0.10$,\n- Critical availability threshold $h_{\\mathrm{crit}} = 0.60$.\n\nDerive from first principles the minimal diastolic interval $\\mathrm{DI}_{\\min}$ such that $h(\\mathrm{DI}_{\\min}) = h_{\\mathrm{crit}}$. Report $\\mathrm{DI}_{\\min}$ in milliseconds. Round your final numerical answer to three significant figures.", "solution": "The problem asks for the minimal diastolic interval, $\\mathrm{DI}_{\\min}$, required for the sodium channel inactivation gate variable, $h$, to recover to a critical value, $h_{\\mathrm{crit}}$, necessary for sustained conduction. The recovery process is described by a first-order relaxation law.\n\nThe governing principle is that during the diastolic interval, where the membrane potential is constant at $-80$ millivolts, the inactivation gate variable $h(t)$ relaxes towards its steady-state value $h_{\\infty}$ with a time constant $\\tau_{h}$. This process is described by the first-order linear ordinary differential equation:\n$$ \\frac{dh(t)}{dt} = \\frac{h_{\\infty} - h(t)}{\\tau_{h}} $$\nThis equation is subject to the initial condition at the onset of diastole, which we define as $t=0$. At this time, the inactivation variable has a value $h(0) = h_{0}$, representing its state immediately after the previous action potential.\n\nTo find the time evolution of $h(t)$, we must solve this differential equation. It is a separable equation, which we can write as:\n$$ \\frac{dh}{h_{\\infty} - h} = \\frac{dt}{\\tau_{h}} $$\nWe integrate both sides from the initial state $(t=0, h=h_0)$ to a general state $(t, h(t))$:\n$$ \\int_{h_0}^{h(t)} \\frac{1}{h_{\\infty} - h'} dh' = \\int_{0}^{t} \\frac{1}{\\tau_{h}} dt' $$\nThe integration yields:\n$$ \\left[-\\ln\\left|h_{\\infty} - h'\\right|\\right]_{h_0}^{h(t)} = \\frac{t}{\\tau_{h}} $$\nSince $h(t)$ is recovering from $h_0$ towards $h_{\\infty}$, and $h_0 < h_{\\infty}$, the term $h_{\\infty} - h'$ will remain positive throughout the interval. Thus, the absolute value is not strictly necessary. Evaluating the definite integral gives:\n$$ -\\ln(h_{\\infty} - h(t)) - (-\\ln(h_{\\infty} - h_0)) = \\frac{t}{\\tau_{h}} $$\n$$ \\ln(h_{\\infty} - h_0) - \\ln(h_{\\infty} - h(t)) = \\frac{t}{\\tau_{h}} $$\nUsing the properties of logarithms, we combine the terms:\n$$ \\ln\\left(\\frac{h_{\\infty} - h_0}{h_{\\infty} - h(t)}\\right) = \\frac{t}{\\tau_{h}} $$\nTo solve for $h(t)$, we first exponentiate both sides:\n$$ \\frac{h_{\\infty} - h_0}{h_{\\infty} - h(t)} = \\exp\\left(\\frac{t}{\\tau_{h}}\\right) $$\nRearranging the terms to isolate $h(t)$:\n$$ h_{\\infty} - h(t) = (h_{\\infty} - h_0) \\exp\\left(-\\frac{t}{\\tau_{h}}\\right) $$\n$$ h(t) = h_{\\infty} - (h_{\\infty} - h_0) \\exp\\left(-\\frac{t}{\\tau_{h}}\\right) $$\nThis equation describes the value of the inactivation gate variable at any time $t$ during the diastolic interval.\n\nThe problem requires finding the minimal diastolic interval, $\\mathrm{DI}_{\\min}$, such that $h(\\mathrm{DI}_{\\min}) = h_{\\mathrm{crit}}$. We set $t = \\mathrm{DI}_{\\min}$ and $h(t) = h_{\\mathrm{crit}}$ in the solution above:\n$$ h_{\\mathrm{crit}} = h_{\\infty} - (h_{\\infty} - h_0) \\exp\\left(-\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}}\\right) $$\nNow, we must solve for $\\mathrm{DI}_{\\min}$. First, isolate the exponential term:\n$$ (h_{\\infty} - h_0) \\exp\\left(-\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}}\\right) = h_{\\infty} - h_{\\mathrm{crit}} $$\n$$ \\exp\\left(-\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}}\\right) = \\frac{h_{\\infty} - h_{\\mathrm{crit}}}{h_{\\infty} - h_0} $$\nTake the natural logarithm of both sides:\n$$ -\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}} = \\ln\\left(\\frac{h_{\\infty} - h_{\\mathrm{crit}}}{h_{\\infty} - h_0}\\right) $$\nFinally, solving for $\\mathrm{DI}_{\\min}$:\n$$ \\mathrm{DI}_{\\min} = -\\tau_{h} \\ln\\left(\\frac{h_{\\infty} - h_{\\mathrm{crit}}}{h_{\\infty} - h_0}\\right) $$\nUsing the property that $-\\ln(x) = \\ln(1/x)$, we can write this in a more intuitive form, as the argument of the logarithm will be greater than $1$:\n$$ \\mathrm{DI}_{\\min} = \\tau_{h} \\ln\\left(\\frac{h_{\\infty} - h_0}{h_{\\infty} - h_{\\mathrm{crit}}}\\right) $$\nThis is the analytical expression for the minimal diastolic interval.\n\nWe are given the following numerical parameters:\n- $\\tau_{h} = 30$ milliseconds\n- $h_{\\infty} = 0.95$\n- $h_{0} = 0.10$\n- $h_{\\mathrm{crit}} = 0.60$\n\nSubstituting these values into the derived expression:\n$$ \\mathrm{DI}_{\\min} = 30 \\ln\\left(\\frac{0.95 - 0.10}{0.95 - 0.60}\\right) $$\n$$ \\mathrm{DI}_{\\min} = 30 \\ln\\left(\\frac{0.85}{0.35}\\right) $$\n$$ \\mathrm{DI}_{\\min} = 30 \\ln\\left(\\frac{17}{7}\\right) $$\nNow, we compute the numerical value.\n$$ \\frac{17}{7} \\approx 2.4285714... $$\n$$ \\ln\\left(\\frac{17}{7}\\right) \\approx 0.88725459... $$\n$$ \\mathrm{DI}_{\\min} \\approx 30 \\times 0.88725459... $$\n$$ \\mathrm{DI}_{\\min} \\approx 26.6176378... $$\nThe problem requires the answer to be rounded to three significant figures. The first three significant figures are $2$, $6$, and $6$. The fourth digit is $1$, so we round down.\n$$ \\mathrm{DI}_{\\min} \\approx 26.6 $$\nThe unit is milliseconds, as specified by the unit of $\\tau_{h}$.", "answer": "$$\n\\boxed{26.6}\n$$", "id": "4818499"}, {"introduction": "Many of the most dangerous and persistent cardiac arrhythmias are caused by reentry, where an electrical impulse fails to terminate and instead begins to circulate within the heart tissue. The key to understanding whether reentry can be sustained lies in the \"wavelength\" concept, which relates conduction speed to the tissue's refractory period. This final practice allows you to build a computational model that applies the wavelength principle, $\\lambda = v \\cdot T_{\\mathrm{ERP}}$, to a realistic scenario of atrial fibrosis, a common cause of atrial fibrillation. You will see firsthand how structural disease alters electrical properties to create a substrate for self-sustaining reentrant circuits, or \"rotors\". [@problem_id:4818468]", "problem": "You are tasked with deriving, implementing, and testing a principled criterion for rotor formation and persistence in atrial tissue with fibrosis, grounded in the pathophysiological understanding of atrial fibrillation. Begin from foundational definitions and well-tested facts in cardiac electrophysiology, and do not rely on shortcut formulas that are not justified from first principles. A rotor is defined here as a self-sustaining reentrant activation that circulates around a functional or anatomical obstacle; in atrial fibrosis, slowed conduction and refractoriness heterogeneity can enable and stabilize such rotors.\n\nUse the following fundamental base and core definitions:\n- Conduction velocity $v$ is the speed at which an activation front propagates through tissue, expressed in $\\mathrm{cm/s}$.\n- Effective refractory period $T_{\\mathrm{ERP}}$ is the minimal time after activation during which tissue cannot be re-excited, expressed in $\\mathrm{s}$.\n- The excitable wavelength $\\lambda$ is the minimal spatial extent required for a wavefront to avoid colliding with its refractory tail, which is known to be the product of conduction velocity and effective refractory period, $$\\lambda = v \\cdot T_{\\mathrm{ERP}}.$$\n- A closed-loop path length $L$ around an obstacle (anatomical or functional) must strictly exceed the wavelength to permit reentry, that is, the strict inequality $$L > \\lambda$$ is required for rotor formation; equality does not produce sustained reentry because the wavefront meets refractory tissue.\n\nModel the effect of atrial fibrosis and anisotropy with the following physically plausible parameterizations:\n- Let $R$ be the effective obstacle radius in $\\mathrm{cm}$ and $g$ be a dimensionless anisotropy factor that elongates the path length by fiber orientation and structural heterogeneity. The closed-loop path length is $$L = 2\\pi R \\cdot g,$$ using angle measure in radians.\n- Let $f \\in [0,1]$ be the fibrosis fraction and $\\beta$ a dimensionless conduction-slowing coefficient. The effective conduction velocity is $$v_{\\mathrm{eff}} = \\max\\!\\big(v_{\\min},\\; v_0 \\cdot (1 - \\beta f)\\big),$$ where $v_0$ is the baseline conduction velocity in $\\mathrm{cm/s}$ and $v_{\\min}$ is a small positive lower bound in $\\mathrm{cm/s}$ imposed to avoid non-physical negative velocities at high $f$.\n- Let $\\sigma \\in [0,1]$ be a dimensionless dispersion amplitude characterizing refractory heterogeneity and $h$ a dimensionless scaling factor mapping dispersion amplitude to an effective shortening of the minimal local refractory period encountered along the loop. The effective refractory period is $$T_{\\mathrm{ERP,eff}} = T_0 \\cdot (1 - h \\sigma),$$ where $T_0$ is the baseline effective refractory period in $\\mathrm{s}$.\n- The excitable wavelength under fibrosis and heterogeneity is $$\\lambda_{\\mathrm{eff}} = v_{\\mathrm{eff}} \\cdot T_{\\mathrm{ERP,eff}}.$$\n\nFrom these bases, derive, justify, and implement an algorithm to compute the number of simultaneously sustainable, non-overlapping rotors that can fit around the loop. A rotor requires at least one full wavelength strictly less than the loop path length; multiple rotors are possible when multiple wavelengths fit without overlap. Your decision rule must explicitly enforce the strict inequality $L > \\lambda_{\\mathrm{eff}}$, and on $L \\le \\lambda_{\\mathrm{eff}}$ it must return zero.\n\nYour program must implement this logic and evaluate the following test suite of parameter sets, each specified as a tuple $(R,\\; v_0,\\; T_0,\\; f,\\; \\beta,\\; g,\\; \\sigma,\\; h,\\; v_{\\min})$ with units as defined above. Use radians for any angle-related quantities. For each case, compute the integer number of rotors. The cases are:\n\n- Case 1 (general \"happy path\"): ($R=1.5$ cm, $v_0=60$ cm/s, $T_0=0.09$ s, $f=0.2$, $\\beta=0.7$, $g=1.1$, $\\sigma=0.2$, $h=0.5$, $v_{\\min}=20$ cm/s).\n- Case 2 (boundary condition where $L$ equals $\\lambda_{\\mathrm{eff}}$): ($R=1.0$ cm, $v_0=60$ cm/s, $T_0=0.10472$ s, $f=0.0$, $\\beta=1.0$, $g=1.0$, $\\sigma=0.0$, $h=0.5$, $v_{\\min}=20$ cm/s).\n- Case 3 (large obstacle, low fibrosis, multiple rotors expected): ($R=3.0$ cm, $v_0=70$ cm/s, $T_0=0.06$ s, $f=0.1$, $\\beta=0.5$, $g=1.0$, $\\sigma=0.1$, $h=0.3$, $v_{\\min}=20$ cm/s).\n- Case 4 (extreme fibrosis with conduction cap): ($R=1.0$ cm, $v_0=50$ cm/s, $T_0=0.08$ s, $f=0.95$, $\\beta=1.2$, $g=1.2$, $\\sigma=0.4$, $h=0.5$, $v_{\\min}=15$ cm/s).\n- Case 5 (small obstacle, no rotor): ($R=0.4$ cm, $v_0=60$ cm/s, $T_0=0.09$ s, $f=0.2$, $\\beta=0.7$, $g=1.0$, $\\sigma=0.2$, $h=0.5$, $v_{\\min}=20$ cm/s).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$), where each $result_i$ is the integer number of rotors for the corresponding test case.", "solution": "The supplied problem is deemed valid. It is scientifically grounded in established principles of cardiac electrophysiology, well-posed with a clear and computable objective, and self-contained with all necessary parameters and equations. The problem is free of contradictions, ambiguities, and non-scientific claims.\n\nThe core task is to derive and implement a criterion to calculate the number of sustainable, non-overlapping reentrant circuits (rotors) in a model of fibrotic atrial tissue. The derivation must proceed from the fundamental principles provided.\n\nThe fundamental condition for a single reentrant circuit to form and sustain itself is that the length of the closed-loop path, $L$, must be strictly greater than the excitable wavelength, $\\lambda$. The wavelength $\\lambda = v \\cdot T_{\\mathrm{ERP}}$ represents the physical length of an action potential wave, where $v$ is the conduction velocity and $T_{\\mathrm{ERP}}$ is the effective refractory period. For a wave to re-excite its point of origin, it must travel around a loop of length $L$ in a time $t = L/v$. This time, known as the revolution time, must be greater than the refractory period $T_{\\mathrm{ERP}}$ of the tissue at the origin. Thus, $L/v > T_{\\mathrm{ERP}}$, which rearranges to $L > v \\cdot T_{\\mathrm{ERP}}$, or $L > \\lambda$. If $L \\le \\lambda$, the wavefront returns to its origin before the tissue has recovered, finding it refractory and extinguishing the circuit. Therefore, no rotors can be sustained if $L \\le \\lambda$.\n\nThe problem extends this to a scenario with multiple, non-overlapping rotors. If one rotor requires a path length greater than $\\lambda$, then $N$ non-overlapping rotors coexisting along the same closed loop of total length $L$ would require the path to accommodate $N$ such wavelengths. The total length required for $N$ rotors is $N \\cdot \\lambda$. For these $N$ rotors to be sustainable, this required length must not exceed the available path length $L$. This gives the condition $L \\ge N \\cdot \\lambda$. To find the maximum possible number of rotors, $N_{\\max}$, we seek the largest integer $N$ that satisfies this inequality. This is given by $N \\le L/\\lambda$. The maximum integer value is therefore $N_{\\max} = \\lfloor L / \\lambda \\rfloor$.\n\nWe must reconcile this with the strict inequality $L > \\lambda$ required for even one rotor. The problem explicitly states that \"on $L \\le \\lambda_{\\mathrm{eff}}$ it must return zero.\" A simple application of $\\lfloor L / \\lambda_{\\mathrm{eff}} \\rfloor$ is insufficient, because if $L = \\lambda_{\\mathrm{eff}}$, the formula yields $\\lfloor 1 \\rfloor = 1$, which violates the given rule.\n\nTherefore, the correct, principled logic is a two-part criterion:\n1. First, evaluate the primary condition for any reentry: Is $L > \\lambda_{\\mathrm{eff}}$?\n2. If this condition is false (i.e., $L \\le \\lambda_{\\mathrm{eff}}$), the number of rotors $N$ is $0$.\n3. If this condition is true (i.e., $L > \\lambda_{\\mathrm{eff}}$), then reentry is possible, and the maximum number of non-overlapping rotors is the number of full wavelengths that can fit within the path length $L$. This is correctly calculated as $N = \\lfloor L / \\lambda_{\\mathrm{eff}} \\rfloor$.\n\nThis leads to the following formal algorithm for a given set of parameters $(R, v_0, T_0, f, \\beta, g, \\sigma, h, v_{\\min})$:\n\nStep 1: Calculate the effective path length, $L$.\nThe path is modeled as an ellipse-like loop around an obstacle of effective radius $R$, with an anisotropy factor $g$.\n$$L = 2\\pi R \\cdot g$$\n\nStep 2: Calculate the effective conduction velocity, $v_{\\mathrm{eff}}$.\nFibrosis (fraction $f$) slows conduction, which is modeled by a linear reduction from the baseline velocity $v_0$ with a coefficient $\\beta$. A minimum velocity $v_{\\min}$ is imposed to prevent non-physical results.\n$$v_{\\mathrm{eff}} = \\max\\!\\big(v_{\\min},\\; v_0 \\cdot (1 - \\beta f)\\big)$$\n\nStep 3: Calculate the effective refractory period, $T_{\\mathrm{ERP,eff}}$.\nHeterogeneity in refractoriness (dispersion amplitude $\\sigma$) can shorten the local refractory period encountered along the path, which is modeled by a linear reduction from the baseline period $T_0$ with a scaling factor $h$.\n$$T_{\\mathrm{ERP,eff}} = T_0 \\cdot (1 - h \\sigma)$$\n\nStep 4: Calculate the effective wavelength, $\\lambda_{\\mathrm{eff}}$.\nThe wavelength is the product of the effective velocity and effective refractory period.\n$$\\lambda_{\\mathrm{eff}} = v_{\\mathrm{eff}} \\cdot T_{\\mathrm{ERP,eff}}$$\n\nStep 5: Determine the number of rotors, $N$.\nApply the derived two-part criterion.\n$$N = \\begin{cases} \\lfloor L / \\lambda_{\\mathrm{eff}} \\rfloor & \\text{if } L > \\lambda_{\\mathrm{eff}} \\\\ 0 & \\text{if } L \\le \\lambda_{\\mathrm{eff}} \\end{cases}$$\n\nThis algorithm will be implemented to evaluate the provided test cases. All calculations will use floating-point arithmetic until the final integer conversion of $N$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a criterion for rotor formation in a model of\n    atrial tissue with fibrosis, and evaluates it on a suite of test cases.\n    \"\"\"\n\n    # The test suite of parameter sets, each specified as a tuple:\n    # (R, v0, T0, f, beta, g, sigma, h, v_min)\n    test_cases = [\n        # Case 1 (general \"happy path\")\n        (1.5, 60.0, 0.09, 0.2, 0.7, 1.1, 0.2, 0.5, 20.0),\n        # Case 2 (boundary condition where L equals lambda_eff)\n        (1.0, 60.0, 0.10472, 0.0, 1.0, 1.0, 0.0, 0.5, 20.0),\n        # Case 3 (large obstacle, low fibrosis, multiple rotors expected)\n        (3.0, 70.0, 0.06, 0.1, 0.5, 1.0, 0.1, 0.3, 20.0),\n        # Case 4 (extreme fibrosis with conduction cap)\n        (1.0, 50.0, 0.08, 0.95, 1.2, 1.2, 0.4, 0.5, 15.0),\n        # Case 5 (small obstacle, no rotor)\n        (0.4, 60.0, 0.09, 0.2, 0.7, 1.0, 0.2, 0.5, 20.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R, v0, T0, f, beta, g, sigma, h, v_min = case\n\n        # Step 1: Calculate the effective path length L.\n        # L = 2 * pi * R * g\n        path_length = 2 * np.pi * R * g\n\n        # Step 2: Calculate the effective conduction velocity v_eff.\n        # v_eff = max(v_min, v0 * (1 - beta * f))\n        fibrotic_velocity = v0 * (1 - beta * f)\n        v_eff = max(v_min, fibrotic_velocity)\n\n        # Step 3: Calculate the effective refractory period T_ERP,eff.\n        # T_ERP,eff = T0 * (1 - h * sigma)\n        T_erp_eff = T0 * (1 - h * sigma)\n\n        # Step 4: Calculate the effective wavelength lambda_eff.\n        # lambda_eff = v_eff * T_ERP,eff\n        lambda_eff = v_eff * T_erp_eff\n\n        # Step 5: Determine the number of rotors, N, based on the derived criterion.\n        # N = floor(L / lambda_eff) if L > lambda_eff, else 0.\n        num_rotors = 0\n        if path_length > lambda_eff:\n            # If the path is long enough for at least one rotor, calculate\n            # how many full wavelengths can fit.\n            num_rotors = int(np.floor(path_length / lambda_eff))\n        \n        results.append(num_rotors)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4818468"}]}