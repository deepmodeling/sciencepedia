{"hands_on_practices": [{"introduction": "Before deploying any diagnostic test, we must understand its performance in a real-world population. This exercise explores the fundamental statistical principles that govern the interpretation of a test result, connecting intrinsic test characteristics like sensitivity ($s$) and specificity ($c$) with the prevalence of the disease ($\\pi$). By deriving and applying the formulas for Positive and Negative Predictive Value (PPV and NPV), you will gain a crucial, and often counter-intuitive, understanding of how disease rarity dramatically impacts the meaning of a positive result in a screening setting [@problem_id:5053056].", "problem": "A hospital deploys a circulating tumor deoxyribonucleic acid (ctDNA)-based liquid biopsy to screen for a specific, actionable driver mutation associated with an early-stage cancer in an asymptomatic population. Assume a binary classification test result (positive or negative) and a binary disease state (mutation-bearing cancer present or absent). Let $s$ denote the test sensitivity, defined as the probability that the test is positive given the disease is present; let $c$ denote the test specificity, defined as the probability that the test is negative given the disease is absent; and let $\\pi$ denote the disease prevalence, defined as the probability that the disease is present before testing in this screening population.\n\nStarting from the core definitions of sensitivity, specificity, and prevalence, and using the law of total probability together with Bayes' theorem, derive analytic expressions for the Positive Predictive Value (PPV), $P(\\text{disease} \\mid \\text{test positive})$, and the Negative Predictive Value (NPV), $P(\\text{no disease} \\mid \\text{test negative})$, as functions of $s$, $c$, and $\\pi$. Then, for a ctDNA assay characterized by $s=0.75$, $c=0.99$, and prevalence $\\pi=0.005$ in the screened population, compute the PPV. Express the PPV as a decimal fraction and round your answer to four significant figures.", "solution": "We begin by formally defining the events based on the problem statement.\nLet $D$ be the event that the disease (mutation-bearing cancer) is present.\nLet $D^c$ be the event that the disease is absent.\nLet $T^+$ be the event that the test result is positive.\nLet $T^-$ be the event that the test result is negative.\n\nThe problem provides the following definitions in the language of conditional probability:\nThe prevalence, $\\pi$, is the prior probability of having the disease:\n$$ \\pi = P(D) $$\nFrom this, the probability of not having the disease is:\n$$ P(D^c) = 1 - P(D) = 1 - \\pi $$\nThe sensitivity, $s$, is the probability of a positive test given the disease is present:\n$$ s = P(T^+ \\mid D) $$\nThis implies the probability of a negative test given the disease is present (a false negative) is:\n$$ P(T^- \\mid D) = 1 - P(T^+ \\mid D) = 1 - s $$\nThe specificity, $c$, is the probability of a negative test given the disease is absent:\n$$ c = P(T^- \\mid D^c) $$\nThis implies the probability of a positive test given the disease is absent (a false positive) is:\n$$ P(T^+ \\mid D^c) = 1 - P(T^- \\mid D^c) = 1 - c $$\n\nThe task is to derive expressions for the Positive Predictive Value (PPV) and the Negative Predictive Value (NPV).\n\n**Derivation of the Positive Predictive Value (PPV)**\nThe PPV is defined as the probability that the disease is present given that the test is positive, which is $P(D \\mid T^+)$. We apply Bayes' theorem:\n$$ \\text{PPV} = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)} $$\nThe numerator is the product of sensitivity and prevalence, $s \\pi$. The denominator, $P(T^+)$, is the total probability of a positive test result. We can expand $P(T^+)$ using the law of total probability, conditioning on the presence or absence of the disease:\n$$ P(T^+) = P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c) $$\nSubstituting the defined terms into this expansion gives:\n$$ P(T^+) = s \\pi + (1 - c)(1 - \\pi) $$\nThis denominator represents the sum of true positives, $P(T^+ \\mid D) P(D)$, and false positives, $P(T^+ \\mid D^c) P(D^c)$.\nSubstituting this expression for $P(T^+)$ back into the Bayes' theorem formula for PPV yields the final analytic expression:\n$$ \\text{PPV} = \\frac{s \\pi}{s \\pi + (1 - c)(1 - \\pi)} $$\n\n**Derivation of the Negative Predictive Value (NPV)**\nThe NPV is defined as the probability that the disease is absent given that the test is negative, which is $P(D^c \\mid T^-)$. Again, we apply Bayes' theorem:\n$$ \\text{NPV} = P(D^c \\mid T^-) = \\frac{P(T^- \\mid D^c) P(D^c)}{P(T^-)} $$\nThe numerator is the product of specificity and the probability of being disease-free, $c(1 - \\pi)$. The denominator, $P(T^-)$, is the total probability of a negative test result. We expand $P(T^-)$ using the law of total probability:\n$$ P(T^-) = P(T^- \\mid D^c) P(D^c) + P(T^- \\mid D) P(D) $$\nSubstituting the defined terms gives:\n$$ P(T^-) = c(1 - \\pi) + (1 - s)\\pi $$\nThis denominator represents the sum of true negatives, $P(T^- \\mid D^c) P(D^c)$, and false negatives, $P(T^- \\mid D) P(D)$.\nSubstituting this expression for $P(T^-)$ into the formula for NPV yields the final analytic expression:\n$$ \\text{NPV} = \\frac{c(1 - \\pi)}{c(1 - \\pi) + (1 - s)\\pi} $$\n\n**Calculation of the PPV**\nThe problem requires the calculation of the PPV for the given parameters:\nSensitivity, $s = 0.75$\nSpecificity, $c = 0.99$\nPrevalence, $\\pi = 0.005$\n\nWe use the derived formula for PPV:\n$$ \\text{PPV} = \\frac{s \\pi}{s \\pi + (1 - c)(1 - \\pi)} $$\nSubstitute the numerical values into the expression:\n$$ \\text{PPV} = \\frac{(0.75)(0.005)}{(0.75)(0.005) + (1 - 0.99)(1 - 0.005)} $$\nFirst, calculate the individual terms:\nThe probability of a true positive result in the population is the numerator:\n$$ s \\pi = 0.75 \\times 0.005 = 0.00375 $$\nThe probability of a false positive result in the population is the second term in the denominator's sum:\n$$ (1 - c)(1 - \\pi) = (0.01)(0.995) = 0.00995 $$\nNow, substitute these values back into the PPV formula:\n$$ \\text{PPV} = \\frac{0.00375}{0.00375 + 0.00995} $$\n$$ \\text{PPV} = \\frac{0.00375}{0.0137} $$\nPerforming the division:\n$$ \\text{PPV} \\approx 0.2737226277... $$\nThe problem asks for the answer to be rounded to four significant figures.\n$$ \\text{PPV} \\approx 0.2737 $$\nThis result signifies that for an individual in this population who receives a positive test result, the probability that they actually have the cancer-associated mutation is approximately $27.37\\%$. The low PPV, despite high specificity, is a characteristic outcome when screening for a rare condition.", "answer": "$$ \\boxed{0.2737} $$", "id": "5053056"}, {"introduction": "The concentration of circulating tumor DNA (ctDNA) in the bloodstream is not a static value but a dynamic state reflecting the balance between tumor cell death and systemic clearance. This practice applies a classic single-compartment pharmacokinetic model to describe this process mathematically, allowing you to predict how ctDNA levels change over time following an intervention like surgery. By modeling ctDNA clearance using first-order kinetics, you will develop a foundational understanding of how longitudinal liquid biopsy data can be interpreted to monitor treatment efficacy and detect disease recurrence [@problem_id:5053009].", "problem": "In a liquid biopsy context, circulating tumor deoxyribonucleic acid (ctDNA) is a subpopulation of cell-free deoxyribonucleic acid (cfDNA) present in plasma. Empirically, cfDNA is cleared from plasma with first-order kinetics, with a typical half-life between $0.5$ and $2$ hours. Consider a single-compartment, well-mixed plasma model in which ctDNA concentration, denoted $C(t)$, is governed by a balance between input from tumor cell death and first-order clearance. Let the input (source) term be piecewise constant: before a surgical intervention at time $t=0$, the ctDNA input rate is $S_{0}$; immediately after surgery ($t \\geq 0$), the input rate suddenly drops to a lower constant value $S_{1}$, with $S_{1} < S_{0}$, reflecting reduced tumor cell death. Assume the system was at steady state before surgery and that plasma volume is constant over the time frame considered.\n\nStarting from first principles of mass balance for a single compartment and the definition of a first-order clearance process with half-life $t_{1/2}$, derive the closed-form analytic expression for the temporal profile $C(t)$ for $t \\geq 0$. Express your final answer in terms of $S_{0}$, $S_{1}$, $t_{1/2}$, and $t$ only. No numerical evaluation is required, and no units should be included in your final expression.", "solution": "The problem requires deriving the concentration profile $C(t)$ of ctDNA for $t \\geq 0$ based on a single-compartment model.\n\n**1. Formulate the Governing Differential Equation**\nThe rate of change of ctDNA concentration, $\\frac{dC(t)}{dt}$, is the difference between the input rate per unit volume, $S(t)$, and the clearance rate. Since clearance follows first-order kinetics, the clearance rate is proportional to the concentration, $kC(t)$, where $k$ is the first-order rate constant.\nThe governing ordinary differential equation (ODE) is:\n$$ \\frac{dC(t)}{dt} = S(t) - kC(t) $$\n\n**2. Relate the Rate Constant ($k$) to Half-Life ($t_{1/2}$)**\nFor a first-order process, the relationship between the rate constant $k$ and the half-life $t_{1/2}$ is derived from the decay equation $C(t) = C(0)e^{-kt}$. By definition, $C(t_{1/2}) = C(0)/2$.\n$$ \\frac{1}{2} = e^{-kt_{1/2}} \\implies \\ln\\left(\\frac{1}{2}\\right) = -kt_{1/2} \\implies -\\ln(2) = -kt_{1/2} $$\nSolving for $k$ gives:\n$$ k = \\frac{\\ln(2)}{t_{1/2}} $$\n\n**3. Determine the Initial Condition**\nThe problem states the system was at steady state for $t  0$, with a constant input rate $S(t) = S_0$. At steady state, $\\frac{dC}{dt} = 0$.\n$$ 0 = S_0 - kC_{\\text{ss}} $$\nThe steady-state concentration, $C_{\\text{ss}}$, is therefore $C_{\\text{ss}} = \\frac{S_0}{k}$.\nSince concentration is continuous, the initial condition for our problem at $t=0$ is $C(0) = C_{\\text{ss}}$.\n$$ C(0) = \\frac{S_0}{k} $$\n\n**4. Solve the Differential Equation for $t \\geq 0$**\nFor $t \\geq 0$, the input rate is $S(t) = S_1$. The ODE becomes:\n$$ \\frac{dC(t)}{dt} + kC(t) = S_1 $$\nThis is a standard first-order linear non-homogeneous ODE. The general solution is the sum of a homogeneous solution ($C_h(t) = A e^{-kt}$) and a particular solution ($C_p(t) = S_1/k$).\n$$ C(t) = A e^{-kt} + \\frac{S_1}{k} $$\nWe use the initial condition $C(0) = S_0/k$ to solve for the constant $A$:\n$$ C(0) = \\frac{S_0}{k} = A e^0 + \\frac{S_1}{k} \\implies A = \\frac{S_0}{k} - \\frac{S_1}{k} = \\frac{S_0 - S_1}{k} $$\nSubstituting $A$ back into the general solution gives the specific solution:\n$$ C(t) = \\frac{S_1}{k} + \\left(\\frac{S_0 - S_1}{k}\\right) e^{-kt} $$\n\n**5. Express the Final Solution in Terms of Given Variables**\nFinally, we substitute $k = \\frac{\\ln(2)}{t_{1/2}}$ back into the expression for $C(t)$:\n$$ C(t) = \\frac{S_1}{\\frac{\\ln(2)}{t_{1/2}}} + \\left(\\frac{S_0 - S_1}{\\frac{\\ln(2)}{t_{1/2}}}\\right) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) $$\nSimplifying and factoring out the common term $\\frac{t_{1/2}}{\\ln(2)}$ gives the final closed-form analytic expression:\n$$ C(t) = \\frac{t_{1/2}}{\\ln(2)} \\left[ S_1 + (S_0 - S_1) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) \\right] $$\nThis expression correctly describes the concentration profile as it transitions from the initial steady state defined by $S_0$ to a new steady state defined by $S_1$.", "answer": "$$\n\\boxed{\\frac{t_{1/2}}{\\ln(2)} \\left( S_1 + (S_0 - S_1) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) \\right)}\n$$", "id": "5053009"}, {"introduction": "Detecting minimal residual disease (MRD) with ctDNA is akin to finding a needle in a haystackâ€”a statistical challenge of identifying a few mutant DNA fragments among millions of normal ones. This problem takes you to the core of this challenge, using the Poisson distribution to model the rare-event nature of sampling low-frequency mutations from a blood draw. By calculating the per-locus and overall panel sensitivity, you will quantitatively explore how factors like sequencing depth ($N$), variant allele fraction ($p$), and the number of tracked mutations ($m$) combine to determine the ultimate detection limit of an MRD assay [@problem_id:5053050].", "problem": "A minimal residual disease (MRD) assay based on a circulating tumor deoxyribonucleic acid (ctDNA) liquid biopsy tracks a panel of single-nucleotide variants (SNVs). Suppose $m$ independent loci are monitored, each with deduplicated unique molecular identifier (UMI) depth $N$ and true variant allele fraction (VAF) $p$. A locus is called positive if the number of mutant molecules observed at that locus, denoted by $X$, satisfies $X \\geq t$, where $t$ is a fixed detection threshold.\n\nModel the read sampling at a single locus as $X \\sim \\mathrm{Binomial}(N,p)$. For small $p$ and large $N$, use the Poisson approximation $X \\approx \\mathrm{Poisson}(\\lambda)$ with $\\lambda = Np$. Assume the detection events across loci are independent.\n\nStarting from these assumptions, derive an expression for the per-locus detection probability $q$ in terms of $\\lambda$ and $t$, and then derive the overall probability that the panel detects MRD (at least one locus is positive) when $m$ loci are tracked. Finally, evaluate this overall detection probability numerically for the parameters $m = 8$, $N = 10{,}000$, $p = 2.0 \\times 10^{-4}$, and $t = 3$. Express your final sensitivity as a decimal number with no units, and round your answer to four significant figures.", "solution": "The problem requires deriving an expression for the overall detection probability of an MRD panel and then calculating it for a specific set of parameters.\n\n**1. Derive the Per-Locus Detection Probability ($q$)**\nThe number of mutant molecules observed at a single locus, $X$, is modeled by a Poisson distribution with parameter $\\lambda = Np$.\n$$ X \\sim \\mathrm{Poisson}(\\lambda) $$\nThe probability mass function is $P(X=k) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$.\nA locus is considered positive if $X \\geq t$. The per-locus detection probability, $q$, is therefore $P(X \\geq t)$. It is easier to calculate this via the complement:\n$$ q = P(X \\geq t) = 1 - P(X  t) $$\nThe event $X  t$ corresponds to observing $0, 1, \\dots, t-1$ mutant molecules.\n$$ P(X  t) = \\sum_{k=0}^{t-1} P(X=k) = \\sum_{k=0}^{t-1} \\frac{\\lambda^k e^{-\\lambda}}{k!} = e^{-\\lambda} \\sum_{k=0}^{t-1} \\frac{\\lambda^k}{k!} $$\nThus, the per-locus detection probability is:\n$$ q = 1 - e^{-\\lambda} \\sum_{k=0}^{t-1} \\frac{\\lambda^k}{k!} $$\n\n**2. Derive the Overall Panel Detection Probability ($P_{\\text{overall}}$)**\nThe panel detects MRD if at least one of the $m$ independent loci is positive. Let $P_{\\text{overall}}$ be this probability. It is easier to calculate the probability of the complement event: that no locus is positive.\nThe probability that a single locus is *not* positive is $1-q$.\nSince the $m$ loci are independent, the probability that all of them are not positive is the product of their individual probabilities:\n$$ P(\\text{no detection}) = (1-q)^m $$\nThe overall detection probability is therefore:\n$$ P_{\\text{overall}} = 1 - P(\\text{no detection}) = 1 - (1-q)^m $$\n\n**3. Numerical Calculation**\nWe are given the parameters:\n-   Number of loci, $m = 8$\n-   UMI depth, $N = 10,000$\n-   VAF, $p = 2.0 \\times 10^{-4}$\n-   Detection threshold, $t = 3$\n\nFirst, calculate the Poisson parameter $\\lambda$:\n$$ \\lambda = Np = 10,000 \\times (2.0 \\times 10^{-4}) = 2.0 $$\nNext, calculate the per-locus detection probability $q$. With $t=3$, the sum goes from $k=0$ to $2$:\n$$ q = 1 - e^{-2} \\sum_{k=0}^{2} \\frac{2^k}{k!} = 1 - e^{-2} \\left( \\frac{2^0}{0!} + \\frac{2^1}{1!} + \\frac{2^2}{2!} \\right) $$\n$$ q = 1 - e^{-2} \\left( \\frac{1}{1} + \\frac{2}{1} + \\frac{4}{2} \\right) = 1 - e^{-2} (1 + 2 + 2) = 1 - 5e^{-2} $$\nNow, use this value of $q$ to calculate the overall probability:\n$$ P_{\\text{overall}} = 1 - (1-q)^m = 1 - (1 - (1 - 5e^{-2}))^8 $$\n$$ P_{\\text{overall}} = 1 - (5e^{-2})^8 = 1 - 5^8 e^{-16} $$\nNow, we compute the final numerical value:\n$$ P_{\\text{overall}} = 1 - 390625 \\times e^{-16} $$\nUsing $e^{-16} \\approx 1.12535 \\times 10^{-7}$:\n$$ P_{\\text{overall}} \\approx 1 - 390625 \\times (1.12535 \\times 10^{-7}) $$\n$$ P_{\\text{overall}} \\approx 1 - 0.043959... $$\n$$ P_{\\text{overall}} \\approx 0.956040... $$\nRounding to four significant figures gives:\n$$ P_{\\text{overall}} \\approx 0.9560 $$", "answer": "$$\n\\boxed{0.9560}\n$$", "id": "5053050"}]}