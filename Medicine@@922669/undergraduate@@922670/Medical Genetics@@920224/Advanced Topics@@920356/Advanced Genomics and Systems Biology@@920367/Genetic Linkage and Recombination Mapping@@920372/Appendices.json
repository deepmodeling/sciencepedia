{"hands_on_practices": [{"introduction": "The three-point testcross is a cornerstone of classical genetics, providing a powerful method to determine the linear order of genes on a chromosome and the genetic distances between them. This exercise offers hands-on practice with the core logic of this technique, using hypothetical progeny data from a testcross. By identifying parental, single-crossover, and double-crossover classes based on their frequencies, you will learn to infer the gene that lies in the middle and calculate map distances, a fundamental skill for constructing genetic maps [@problem_id:2801497].", "problem": "A trihybrid individual that is heterozygous at three loci $A$, $B$, and $C$ carries coupling-phase haplotypes $A B C$ and $a b c$. This individual is testcrossed to a triple-recessive $a b c$ tester. The phenotypic classes in the testcross progeny directly reflect the gametes produced by the trihybrid parent. You observe the following eight progeny classes (total $N = 10{,}000$):\n\n- $A B C: 3{,}579$\n- $a b c: 3{,}573$\n- $A b c: 525$\n- $a B C: 523$\n- $A B c: 826$\n- $a b C: 824$\n- $A b C: 76$\n- $a B c: 74$\n\nStarting only from core definitions about recombination fraction, double crossover (DCO), and three-point testcross logic in classical genetics, infer the linear gene order and compute the genetic map distances between adjacent loci in the inferred order.\n\n- Report the gene order from left to right as a permutation of locus indices $(1,2,3)$, where $1 \\equiv A$, $2 \\equiv B$, and $3 \\equiv C$.\n- Compute the two adjacent-locus distances $d_{1\\text{–}2}$ and $d_{2\\text{–}3}$ in centiMorgans (cM), using the standard short-distance approximation that the recombination fraction multiplied by $100$ equals genetic distance in $\\text{cM}$.\n- Round each distance to four significant figures.\n- Express your final answer as a single row matrix $\\begin{pmatrix} i_1 & i_2 & i_3 & d_{1\\text{–}2} & d_{2\\text{–}3} \\end{pmatrix}$, with no units inside the matrix. In the body of your solution, state the units as $\\text{cM}$.", "solution": "The problem is subjected to validation.\n\nGivens are extracted verbatim:\n- A trihybrid individual is heterozygous at three loci $A$, $B$, and $C$.\n- The individual carries coupling-phase haplotypes $A B C$ and $a b c$.\n- This individual is testcrossed to a triple-recessive $a b c$ tester.\n- The total progeny count is $N = 10,000$.\n- Progeny phenotypic class counts:\n  - $A B C: 3,579$\n  - $a b c: 3,573$\n  - $A b c: 525$\n  - $a B C: 523$\n  - $A B c: 826$\n  - $a b C: 824$\n  - $A b C: 76$\n  - $a B c: 74$\n\nValidation verdict: The problem is valid.\n- It is scientifically grounded in the principles of classical genetics, specifically three-point testcross analysis for gene mapping.\n- It is well-posed, providing all necessary data for a unique solution.\n- The language is objective and precise.\n- The data are internally consistent; the sum of progeny counts is $3,579 + 3,573 + 525 + 523 + 826 + 824 + 76 + 74 = 10,000$, which matches the given total $N$. The reciprocal classes (e.g., $A B C$ and $a b c$) have quantitatively similar counts, as expected from meiosis. All criteria for a valid problem are met.\n\nThe solution proceeds. The objective is to determine the linear order of the three genes and the genetic distances between them. The analysis of a three-point testcross relies on identifying the different classes of gametes produced by the heterozygous parent. Since the tester parent is homozygous recessive ($a b c$), the phenotype of the progeny directly reveals the genetic constitution of the gamete from the trihybrid parent.\n\nFirst, we classify the progeny based on their frequencies. The principle is that parental (non-recombinant) gametes are the most frequent, and double crossover (DCO) gametes are the least frequent.\n- The two most frequent phenotypic classes are $A B C$ (count $3,579$) and $a b c$ (count $3,573$). These represent the parental, or non-recombinant, gametes. The total number of non-recombinant progeny is $N_{P} = 3,579 + 3,573 = 7,152$. This is consistent with the given parental haplotypes $A B C$ and $a b c$.\n- The two least frequent phenotypic classes are $A b C$ (count $76$) and $a B c$ (count $74$). These represent the double crossover (DCO) gametes, which arise from two simultaneous crossover events. The total number of DCO progeny is $N_{DCO} = 76 + 74 = 150$.\n\nNext, we determine the gene order. A double crossover event switches the middle allele between the two parental chromosomes. By comparing the allelic composition of a DCO gamete with a parental gamete, we can identify the gene in the middle. Let us compare the parental haplotype $A B C$ with the DCO haplotype $A b C$. The alleles for loci $A$ and $C$ are the same ($A$ and $C$), while the allele for locus $B$ has been exchanged ($B$ for $b$). This indicates that locus $B$ is located between loci $A$ and $C$. The correct gene order is therefore $A - B - C$. As per the problem's notation where $1 \\equiv A$, $2 \\equiv B$, and $3 \\equiv C$, the gene order is $(1, 2, 3)$.\n\nWith the gene order established, we can now classify the remaining four progeny classes, which result from single crossover (SCO) events.\n- A single crossover between gene $A$ and gene $B$ (Region $1$) would produce the gametes $A b c$ and $a B C$. The observed counts for these classes are $525$ and $523$, respectively. The total number of SCO progeny for Region $1$ is $N_{SCO1} = 525 + 523 = 1,048$.\n- A single crossover between gene $B$ and gene $C$ (Region $2$) would produce the gametes $A B c$ and $a b C$. The observed counts for these classes are $826$ and $824$, respectively. The total number of SCO progeny for Region $2$ is $N_{SCO2} = 826 + 824 = 1,650$.\n\nNow, we compute the genetic map distances. The map distance between two loci is defined as the recombination frequency between them, expressed in centiMorgans ($\\text{cM}$). One centiMorgan corresponds to a $1\\%$ recombination frequency. The recombination frequency ($RF$) is the ratio of the number of recombinant progeny to the total number of progeny. It is crucial to remember that the total number of recombinant events between two loci includes *both* single crossovers in that interval *and all* double crossovers.\n\nThe distance between locus $A$ and locus $B$, denoted $d_{1\\text{–}2}$, is calculated as:\n$$RF_{A-B} = \\frac{N_{SCO1} + N_{DCO}}{N_{total}} = \\frac{1,048 + 150}{10,000} = \\frac{1,198}{10,000} = 0.1198$$\nThe map distance is then:\n$$d_{1\\text{–}2} = RF_{A-B} \\times 100 = 0.1198 \\times 100 = 11.98 \\text{ cM}$$\nThis value is already provided to four significant figures.\n\nThe distance between locus $B$ and locus $C$, denoted $d_{2\\text{–}3}$, is calculated similarly:\n$$RF_{B-C} = \\frac{N_{SCO2} + N_{DCO}}{N_{total}} = \\frac{1,650 + 150}{10,000} = \\frac{1,800}{10,000} = 0.1800$$\nThe map distance is then:\n$$d_{2\\text{–}3} = RF_{B-C} \\times 100 = 0.1800 \\times 100 = 18.00 \\text{ cM}$$\nThis value is given to four significant figures.\n\nThe inferred genetic map is: $A \\xrightarrow{11.98\\text{ cM}} B \\xrightarrow{18.00\\text{ cM}} C$.\n\nTo confirm the non-randomness of crossover events (genetic interference), we can compare the observed DCO frequency with the expected DCO frequency. The expected frequency is the product of the recombination frequencies of the two adjacent regions:\n$$RF_{expected DCO} = RF_{A-B} \\times RF_{B-C} = 0.1198 \\times 0.1800 \\approx 0.02156$$\nThe expected number of DCO progeny is $10,000 \\times 0.02156 = 215.6$.\nThe observed number is $150$. The coefficient of coincidence is $C = \\frac{\\text{Observed DCO}}{\\text{Expected DCO}} = \\frac{150}{215.6} \\approx 0.696$.\nThe interference is $I = 1 - C = 1 - 0.696 = 0.304$. This positive interference value indicates that a crossover in one region reduces the probability of a simultaneous crossover in the adjacent region, a common biological phenomenon.\n\nThe final answer requires the gene order as a permutation of $(1,2,3)$ and the two adjacent map distances, $d_{1\\text{–}2}$ and $d_{2\\text{–}3}$.\nThe gene order is $A-B-C$, which corresponds to $(1, 2, 3)$.\nThe distances are $d_{1\\text{–}2} = 11.98$ and $d_{2\\text{–}3} = 18.00$.\nThe required output is a single row matrix containing these five values.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2 & 3 & 11.98 & 18.00\n\\end{pmatrix}\n}\n$$", "id": "2801497"}, {"introduction": "While recombination frequency is directly observable, it can underestimate the true genetic distance between distant loci due to multiple crossover events. Mapping functions are mathematical models that correct for this discrepancy by relating recombination fraction ($r$) to map distance ($x$). This practice challenges you to apply two seminal models—Haldane's function, which assumes no crossover interference, and Kosambi's function, which accounts for positive interference—to the same hypothetical recombination data. Working through these calculations will clarify the crucial distinction between recombination frequency and map distance and highlight how theoretical models refine our interpretation of genetic data [@problem_id:2801515].", "problem": "A large backcross in a diploid species yields an empirically estimated recombination fraction of $r=0.22$ between two codominant genetic markers. Assume independent assortment is not applicable at this scale and that crossover formation along the chromosome can be modeled by one of two classical mapping-function frameworks.\n\nUsing only the following foundational bases:\n- The recombination fraction $r$ is the probability that a randomly sampled chromatid is recombinant between the two loci, which occurs when the number of exchanges between the loci on that chromatid is odd.\n- Under a no-interference model, crossover locations along a bivalent follow a Poisson process along genetic length, and the number of exchanges involving a given chromatid is a thinned Poisson process.\n- Under a positive-interference model with additivity of map distance, the Kosambi mapping function is a widely used, well-tested transformation between recombination fraction and genetic distance.\n\nDerive the genetic map distance under Haldane’s no-interference model and under Kosambi’s positive-interference model for the given $r$, and then compute the magnitude of the difference between the two distances. Express the two distances in centiMorgans (cM), where the map distance is measured in Morgans (M). Report three values, in this order: Haldane distance (cM), Kosambi distance (cM), and the absolute difference (cM). Round each reported value to $4$ significant figures. Do not include any commentary in the final reported values; units and commentary should appear only in your working. The final reported values must be consistent with the derivations you present.", "solution": "The problem requires the calculation of genetic map distance from an observed recombination fraction using two different models: Haldane's no-interference model and Kosambi's positive-interference model. We are given an empirical recombination fraction $r = 0.22$. The final results must be expressed in centiMorgans (cM) and rounded to $4$ significant figures.\n\nFirst, we address the Haldane no-interference model. Let the genetic map distance in Morgans be denoted by $x$. Under the Haldane model, it is assumed that the number of exchanges $K$ affecting a single chromatid follows a Poisson distribution with mean $x$. The probability of observing $k$ exchanges is given by:\n$$P(K=k) = \\frac{\\exp(-x) x^k}{k!}$$\nA recombinant chromatid is produced if an odd number of exchanges occur between the loci. Therefore, the recombination fraction $r$ is the sum of probabilities for all odd values of $k$:\n$$r = \\sum_{j=0}^{\\infty} P(K = 2j+1) = \\sum_{j=0}^{\\infty} \\frac{\\exp(-x) x^{2j+1}}{(2j+1)!}$$\nThis sum can be recognized in the context of the Taylor series for hyperbolic functions. Specifically, $\\sinh(x) = \\sum_{j=0}^{\\infty} \\frac{x^{2j+1}}{(2j+1)!}$.\nThus, the relationship is:\n$$r = \\exp(-x) \\sinh(x)$$\nBy substituting the exponential form of the hyperbolic sine, $\\sinh(x) = \\frac{\\exp(x) - \\exp(-x)}{2}$, we derive Haldane's mapping function:\n$$r = \\exp(-x) \\left( \\frac{\\exp(x) - \\exp(-x)}{2} \\right) = \\frac{1 - \\exp(-2x)}{2}$$\nTo find the genetic distance $x_H$ from the recombination fraction $r$, we must invert this function:\n$$2r = 1 - \\exp(-2x_H)$$\n$$\\exp(-2x_H) = 1 - 2r$$\n$$-2x_H = \\ln(1 - 2r)$$\n$$x_H = -\\frac{1}{2} \\ln(1 - 2r)$$\nThe distance $x_H$ is in Morgans. To convert to centiMorgans ($d_H$), we multiply by $100$:\n$$d_H = 100 \\times x_H = -50 \\ln(1 - 2r)$$\nSubstituting the given value $r = 0.22$:\n$$d_H = -50 \\ln(1 - 2 \\times 0.22) = -50 \\ln(1 - 0.44) = -50 \\ln(0.56)$$\nCalculating the numerical value:\n$$d_H \\approx -50 \\times (-0.579818) \\approx 28.9909 \\text{ cM}$$\nRounded to $4$ significant figures, the Haldane distance is $28.99$ cM.\n\nSecond, we address the Kosambi positive-interference model. The problem directs us to use the Kosambi mapping function, which relates the recombination fraction $r$ to the map distance in Morgans, $x_K$, as follows:\n$$r = \\frac{1}{2} \\tanh(2x_K)$$\nThis function accounts for positive interference, where one crossover event reduces the probability of another occurring nearby. To find the distance $d_K$ from $r$, we must invert this function.\n$$2r = \\tanh(2x_K)$$\n$$2x_K = \\arctanh(2r)$$\n$$x_K = \\frac{1}{2} \\arctanh(2r)$$\nThe distance $x_K$ is in Morgans. The distance in centiMorgans, $d_K$, is:\n$$d_K = 100 \\times x_K = 50 \\arctanh(2r)$$\nWe can also express this using the logarithmic definition of the inverse hyperbolic tangent, $\\arctanh(z) = \\frac{1}{2} \\ln \\left( \\frac{1+z}{1-z} \\right)$:\n$$d_K = 50 \\left( \\frac{1}{2} \\ln \\left( \\frac{1+2r}{1-2r} \\right) \\right) = 25 \\ln \\left( \\frac{1+2r}{1-2r} \\right)$$\nSubstituting the value $r = 0.22$:\n$$d_K = 50 \\arctanh(2 \\times 0.22) = 50 \\arctanh(0.44)$$\nCalculating the numerical value:\n$$d_K \\approx 50 \\times (0.472231) \\approx 23.6115 \\text{ cM}$$\nRounded to $4$ significant figures, the Kosambi distance is $23.61$ cM.\n\nFinally, we compute the magnitude of the difference between the two distances, $\\Delta d$:\n$$\\Delta d = |d_H - d_K|$$\nUsing the unrounded values for higher precision before a final rounding:\n$$\\Delta d = |28.99092... - 23.61154...| = |5.37938...| \\text{ cM}$$\nRounding the absolute difference to $4$ significant figures, we get $5.379$ cM.\n\nThe three required values are therefore:\nHaldane distance: $d_H \\approx 28.99$ cM.\nKosambi distance: $d_K \\approx 23.61$ cM.\nAbsolute difference: $\\Delta d \\approx 5.379$ cM.", "answer": "$$\n\\boxed{\\begin{pmatrix} 28.99 & 23.61 & 5.379 \\end{pmatrix}}\n$$", "id": "2801515"}, {"introduction": "The principles of genetic mapping are now applied on a genomic scale to pinpoint disease-causing genes. A powerful modern technique, particularly for recessive diseases in consanguineous families, is autozygosity mapping, which involves searching for Runs of Homozygosity (ROH) shared among affected individuals. This computational exercise simulates this process, tasking you with writing a program to analyze hypothetical SNP genotype data from two siblings. You will identify shared homozygous regions and calculate their genetic lengths in centiMorgans, providing a practical demonstration of how classical mapping concepts are integrated into contemporary bioinformatics workflows for medical genetics [@problem_id:5038275].", "problem": "You are given single-nucleotide polymorphism (SNP) genotype series for two affected siblings from a consanguineous pedigree. Runs of Homozygosity (ROH) that are shared by affected siblings and identical by state are indicative of potential autozygous segments harboring a recessive risk allele. Using known genetic map positions in centiMorgans (cM) for each SNP along a chromosome, implement a program that identifies maximal shared ROH segments and computes their genetic lengths.\n\nUse the following foundational base:\n- A genetic map position in centiMorgans (cM) is a monotonic coordinate along the chromosome where $1$ cM is defined as the genetic distance corresponding to a recombination fraction of $0.01$. The map is additive along intervals: the genetic length of a segment spanning SNPs indexed from $i$ to $j$ equals $m_j - m_i$, where $m_k$ is the map position (in cM) of SNP index $k$.\n- A SNP genotype is coded as an integer: $0$ for homozygous allele $A$, $1$ for heterozygous allele $A/B$, $2$ for homozygous allele $B$, and $-1$ for missing. A SNP is homozygous if its code is in $\\{0, 2\\}$. Two siblings share a SNP identically by state if both are homozygous and have the same homozygous code (both $0$ or both $2$).\n- A shared ROH segment is a maximal consecutive block of SNPs along the chromosome where both siblings are identically homozygous by state at each SNP in the block. Missing data ($-1$) or heterozygosity ($1$) at any SNP breaks the segment.\n\nYour program must:\n1. Identify all maximal shared ROH segments that satisfy a minimum SNP count threshold $t$ (i.e., the block length in SNPs must be $\\geq t$).\n2. For each accepted segment, compute its genetic length in cM as the difference between the map positions (in cM) of the last and first SNP in the segment, i.e., $L = m_{\\text{end}} - m_{\\text{start}}$.\n3. Express lengths as decimal numbers in centiMorgans (cM), rounded to three decimal places.\n\nImplement the program for the following test suite. Each test case is specified by:\n- A list of genetic map positions (in cM) $[m_0, m_1, \\dots, m_{n-1}]$ with non-decreasing values.\n- Two genotype lists (integers as above) for the siblings, $[g^{(1)}_0, \\dots, g^{(1)}_{n-1}]$ and $[g^{(2)}_0, \\dots, g^{(2)}_{n-1}]$.\n- The minimum SNP threshold $t$ (an integer).\n\nTest suite:\n- Case A (general happy path):\n  - Map cM: $[0.0, 0.5, 1.0, 1.5, 3.0, 3.2, 4.0]$\n  - Sibling $1$ genotypes: $[0, 0, 0, 1, 2, 2, 2]$\n  - Sibling $2$ genotypes: $[0, 0, 0, 1, 2, 2, 2]$\n  - Threshold $t = 3$\n- Case B (boundary condition, segment length exactly at threshold):\n  - Map cM: $[10.0, 10.2, 10.4]$\n  - Sibling $1$ genotypes: $[2, 2, 2]$\n  - Sibling $2$ genotypes: $[2, 2, 2]$\n  - Threshold $t = 3$\n- Case C (edge case: no segment meets threshold):\n  - Map cM: $[1.0, 1.5, 2.0]$\n  - Sibling $1$ genotypes: $[0, 0, 0]$\n  - Sibling $2$ genotypes: $[0, 0, 0]$\n  - Threshold $t = 4$\n- Case D (edge case: homozygous blocks with allele mismatch breaking shared identity):\n  - Map cM: $[5.0, 5.4, 5.8, 6.4, 7.0]$\n  - Sibling $1$ genotypes: $[0, 0, 2, 2, 2]$\n  - Sibling $2$ genotypes: $[0, 0, 0, 0, 2]$\n  - Threshold $t = 2$\n- Case E (edge case: heterozygosity and missing data break segments):\n  - Map cM: $[12.0, 12.6, 13.0, 13.2, 13.8, 14.0]$\n  - Sibling $1$ genotypes: $[2, 2, 1, -1, 2, 2]$\n  - Sibling $2$ genotypes: $[2, 2, 1, -1, 2, 2]$\n  - Threshold $t = 2$\n- Case F (edge case: long homozygous runs but different alleles in siblings):\n  - Map cM: $[20.0, 20.5, 21.0, 21.5]$\n  - Sibling $1$ genotypes: $[0, 0, 0, 0]$\n  - Sibling $2$ genotypes: $[2, 2, 2, 2]$\n  - Threshold $t = 2$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is the list of segment lengths (in cM) for that case, rounded to three decimals (e.g., $[[1.000, 0.400],[\\dots],\\dots]$). The printed Python list representation with decimal numbers is acceptable; do not include any text other than this single-line list.", "solution": "The problem is valid. It is scientifically grounded in the principles of medical genetics, specifically autozygosity mapping, and presents a well-posed computational task with clear, objective, and complete definitions.\n\n### Principle-Based Design\n\nThe problem addresses the identification of shared Runs of Homozygosity (ROH) between two affected siblings from a consanguineous family. This is a fundamental technique in medical genetics for mapping the location of recessive disease genes. The underlying principle is that in a consanguineous mating, offspring have an increased probability of inheriting two copies of the same ancestral chromosomal segment from a common ancestor. This state is known as being homozygous by descent, or autozygous. If a rare recessive disease allele is present on such a segment, an affected individual will be homozygous for it. When two siblings are affected by the same recessive disease, it is highly probable that they are both autozygous for the same causal genomic region. By searching for segments where both siblings are homozygous and share the same alleles—a state known as identical by state (IBS), which serves as a proxy for autozygosity—we can identify candidate regions that may harbor the disease gene.\n\nThe problem provides a formalized, computational approach to this search. We are given Single-Nucleotide Polymorphism (SNP) genotypes and their corresponding genetic map positions in centiMorgans ($cM$) along a chromosome.\n\nA SNP at a given index $k$ is considered for inclusion in a shared ROH if and only if both siblings are homozygous for the same allele at that position. Let $g_k^{(1)}$ and $g_k^{(2)}$ be the integer-coded genotypes for sibling $1$ and sibling $2$ at SNP index $k$, respectively. The set of homozygous genotypes is $\\{0, 2\\}$. A SNP at index $k$ contributes to a shared ROH if the following condition holds:\n$$\ng_k^{(1)} = g_k^{(2)} \\land g_k^{(1)} \\in \\{0, 2\\}\n$$\nAny SNP where either sibling is heterozygous (genotype code $1$), has missing data (code $-1$), or where both are homozygous but for different alleles (e.g., $g_k^{(1)}=0$ and $g_k^{(2)}=2$) will break a shared ROH.\n\nA shared ROH segment is defined as a *maximal* consecutive block of SNPs that all satisfy the shared homozygosity criterion. The task is to identify all such maximal segments that meet or exceed a minimum length threshold, $t$, defined by the number of SNPs in the segment.\n\nFor each valid segment, its genetic length, $L$, must be calculated. The genetic map provides a coordinate system in centiMorgans ($cM$). If a valid segment starts at SNP index $i_{\\text{start}}$ and ends at SNP index $i_{\\text{end}}$, its genetic length is the difference in their map positions:\n$$\nL = m_{i_{\\text{end}}} - m_{i_{\\text{start}}}\n$$\nwhere $m_k$ is the genetic map position in cM for the SNP at index $k$.\n\n### Algorithmic Strategy\n\nTo implement this, we can employ a single-pass algorithm that iterates through the SNP data, maintaining state to identify the boundaries of potential shared ROH segments.\n\n1.  **State Initialization**: We use a state variable, for instance `run_start_index`, initialized to a sentinel value (e.g., $-1$) to indicate that we are not currently within a shared ROH.\n\n2.  **Iteration**: We iterate through each SNP index $i$ from $0$ to $n-1$, where $n$ is the total number of SNPs.\n\n3.  **State Transition**: At each SNP $i$, we check if it meets the shared homozygosity condition: $g_i^{(1)} = g_i^{(2)} \\land g_i^{(1)} \\in \\{0, 2\\}$.\n    - If the condition is **met** and `run_start_index` is $-1$, it signifies the beginning of a new potential segment. We record this starting position by setting `run_start_index = i`.\n    - If the condition is **not met** and `run_start_index` is not $-1$, it signifies the end of the current segment. The just-ended segment spans from `run_start_index` to $i-1$. We proceed to process this segment (Step 4) and then reset `run_start_index` to $-1$.\n\n4.  **Segment Processing**: When a segment terminates (either by a non-qualifying SNP or by reaching the end of the chromosome data), we determine its properties.\n    - Let the start index be $i_{\\text{start}} = \\text{run\\_start\\_index}$ and the end index be $i_{\\text{end}}$.\n    - The number of SNPs in the segment is $N_{SNPs} = i_{\\text{end}} - i_{\\text{start}} + 1$.\n    - We check if this count meets the threshold: $N_{SNPs} \\geq t$.\n    - If the segment is valid, we compute its genetic length $L = m_{i_{\\text{end}}} - m_{i_{\\text{start}}}$. This length, rounded to three decimal places, is stored.\n\n5.  **Termination**: After the loop has finished, we must perform a final check to see if a segment was active up to the very last SNP. If `run_start_index` is not $-1$ after the loop, it means the last segment extends to the end of the data (index $n-1$), and it must be processed as described in Step 4. A clean way to implement this is to extend the iteration one step beyond the end of the data, which forces any trailing active segment to be processed.\n\nThis algorithm correctly identifies all maximal, non-overlapping shared ROH segments and calculates their genetic lengths as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the shared ROH identification problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case A (general happy path)\n        {\n            \"map_cm\": [0.0, 0.5, 1.0, 1.5, 3.0, 3.2, 4.0],\n            \"g1\": [0, 0, 0, 1, 2, 2, 2],\n            \"g2\": [0, 0, 0, 1, 2, 2, 2],\n            \"t\": 3\n        },\n        # Case B (boundary condition, segment length exactly at threshold)\n        {\n            \"map_cm\": [10.0, 10.2, 10.4],\n            \"g1\": [2, 2, 2],\n            \"g2\": [2, 2, 2],\n            \"t\": 3\n        },\n        # Case C (edge case: no segment meets threshold)\n        {\n            \"map_cm\": [1.0, 1.5, 2.0],\n            \"g1\": [0, 0, 0],\n            \"g2\": [0, 0, 0],\n            \"t\": 4\n        },\n        # Case D (edge case: homozygous blocks with allele mismatch)\n        {\n            \"map_cm\": [5.0, 5.4, 5.8, 6.4, 7.0],\n            \"g1\": [0, 0, 2, 2, 2],\n            \"g2\": [0, 0, 0, 0, 2],\n            \"t\": 2\n        },\n        # Case E (edge case: heterozygosity and missing data break segments)\n        {\n            \"map_cm\": [12.0, 12.6, 13.0, 13.2, 13.8, 14.0],\n            \"g1\": [2, 2, 1, -1, 2, 2],\n            \"g2\": [2, 2, 1, -1, 2, 2],\n            \"t\": 2\n        },\n        # Case F (edge case: long homozygous runs but different alleles)\n        {\n            \"map_cm\": [20.0, 20.5, 21.0, 21.5],\n            \"g1\": [0, 0, 0, 0],\n            \"g2\": [2, 2, 2, 2],\n            \"t\": 2\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result_lengths = find_shared_roh(\n            case[\"map_cm\"],\n            case[\"g1\"],\n            case[\"g2\"],\n            case[\"t\"]\n        )\n        all_results.append(result_lengths)\n\n    # Format the final output string to match the required format precisely.\n    # e.g., [[1.000,1.000],[0.400],[],[0.400],[0.600,0.200],[]]\n    output_parts = []\n    for case_result in all_results:\n        formatted_nums = [f\"{num:.3f}\" for num in case_result]\n        inner_str = \",\".join(formatted_nums)\n        output_parts.append(f\"[{inner_str}]\")\n    \n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\ndef find_shared_roh(map_cm, g1, g2, t):\n    \"\"\"\n    Identifies maximal shared ROH segments and computes their genetic lengths.\n\n    Args:\n        map_cm (list[float]): Genetic map positions in centiMorgans.\n        g1 (list[int]): Genotypes for sibling 1.\n        g2 (list[int]): Genotypes for sibling 2.\n        t (int): Minimum SNP count threshold for a segment.\n\n    Returns:\n        list[float]: A list of genetic lengths (in cM) for valid segments,\n                     rounded to three decimal places.\n    \"\"\"\n    n = len(map_cm)\n    g1_np = np.array(g1)\n    g2_np = np.array(g2)\n\n    # A SNP is in a shared ROH if both siblings are homozygous for the same allele.\n    # Genotype codes for homozygous are 0 and 2.\n    is_shared_homozygous = (g1_np == g2_np) & np.isin(g1_np, [0, 2])\n\n    found_lengths = []\n    run_start_index = -1\n\n    # Iterate one position past the end to handle runs at the very end of the array.\n    for i in range(n + 1):\n        is_in_run = i < n and is_shared_homozygous[i]\n\n        if is_in_run:\n            # If a run is starting, record its start index.\n            if run_start_index == -1:\n                run_start_index = i\n        else:\n            # If we were in a run, it has now ended.\n            if run_start_index != -1:\n                run_end_index = i - 1\n                snp_count = run_end_index - run_start_index + 1\n\n                # Check if the run meets the minimum SNP threshold.\n                if snp_count >= t:\n                    # Calculate genetic length and round to 3 decimal places.\n                    length = map_cm[run_end_index] - map_cm[run_start_index]\n                    found_lengths.append(round(length, 3))\n                \n                # Reset state to indicate we are no longer in a run.\n                run_start_index = -1\n                \n    return found_lengths\n\nsolve()\n```", "id": "5038275"}]}