{"hands_on_practices": [{"introduction": "In network medicine, a primary goal is to identify which genes within a complex interaction network are the most influential drivers of a disease. Centrality measures offer a quantitative method to rank the importance of each gene based on its position in the network. This exercise focuses on calculating Katz centrality, a sophisticated measure that accounts for both direct and indirect connections, to prioritize candidate genes in a hypothetical disease module. [@problem_id:5084478]", "problem": "A disease module in a proteinâ€“protein interaction network is approximated by a small undirected graph of four genes $\\mathrm{G1}$, $\\mathrm{G2}$, $\\mathrm{G3}$, and $\\mathrm{G4}$. The adjacency matrix $\\mathbf{A}$ in the ordered basis $(\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4})$ is\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\n0 & 1 & 1 & 1\\\\\n1 & 0 & 0 & 0\\\\\n1 & 0 & 0 & 0\\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\nUsing the standard definition of Katz centrality as the convergent series\n$$\n\\mathbf{x} \\;=\\; \\sum_{k=1}^{\\infty} \\alpha^{k}\\,\\mathbf{A}^{k}\\,\\mathbf{1},\n$$\nwhere $\\mathbf{1}$ is the all-ones column vector and $\\alpha$ is an attenuation parameter chosen to ensure convergence, compute the Katz centrality vector $\\mathbf{x}$ for $\\alpha = \\tfrac{1}{2}$. Justify that the choice of $\\alpha$ yields a convergent series based on the spectral properties of $\\mathbf{A}$. Then briefly interpret, in terms of gene prioritization for follow-up experiments in medical genetics, how the relative magnitudes of the computed entries would guide which genes to study first and why, using network medicine reasoning. Provide the final Katz centrality vector as a row matrix in the order $(\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4})$. No rounding is required; report exact values.", "solution": "The problem requires the computation of the Katz centrality vector for a given gene network, a justification for the convergence of the series used in the definition, and an interpretation of the results in the context of medical genetics.\n\nFirst, the validity and convergence of the Katz centrality series must be established. The Katz centrality vector $\\mathbf{x}$ is defined by the series:\n$$\n\\mathbf{x} \\;=\\; \\sum_{k=1}^{\\infty} \\alpha^{k}\\,\\mathbf{A}^{k}\\,\\mathbf{1}\n$$\nThis is a geometric series of matrices, which converges if and only if the attenuation parameter $\\alpha$ is less than the reciprocal of the spectral radius $\\rho(\\mathbf{A})$ of the adjacency matrix $\\mathbf{A}$. The spectral radius is the maximum absolute value among the eigenvalues of $\\mathbf{A}$.\n\nThe eigenvalues $\\lambda$ of $\\mathbf{A}$ are found by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$.\nThe matrix has a specific block structure corresponding to a star graph. For a matrix of the form $\\begin{pmatrix} 0 & \\mathbf{w}^T \\\\ \\mathbf{w} & \\mathbf{0} \\end{pmatrix}$ where $\\mathbf{w}$ is a column vector of dimension $n-1$, the characteristic polynomial is $\\lambda^{n-2}(\\lambda^2 - \\mathbf{w}^T \\mathbf{w})$. Here, $n=4$ and $\\mathbf{w} = (1, 1, 1)^T$. Thus $\\mathbf{w}^T\\mathbf{w}=1^2+1^2+1^2 = 3$. The characteristic polynomial is $\\lambda^{4-2}(\\lambda^2 - 3) = \\lambda^2(\\lambda^2-3)$.\nSetting this to $0$:\n$$\n\\lambda^{2}(\\lambda^{2} - 3) = 0\n$$\nThe eigenvalues are $\\lambda_{1} = \\sqrt{3}$, $\\lambda_{2} = -\\sqrt{3}$, and $\\lambda_{3,4} = 0$ (with multiplicity $2$).\nThe spectral radius is $\\rho(\\mathbf{A}) = \\max(|\\sqrt{3}|, |-\\sqrt{3}|, |0|) = \\sqrt{3}$.\nThe convergence condition for the Katz centrality series is $\\alpha < \\frac{1}{\\rho(\\mathbf{A})}$.\n$$\n\\alpha < \\frac{1}{\\sqrt{3}}\n$$\nThe problem specifies $\\alpha = \\frac{1}{2}$. We must check if this condition is met:\n$$\n\\frac{1}{2} < \\frac{1}{\\sqrt{3}} \\iff \\sqrt{3} < 2 \\iff 3 < 4\n$$\nThis inequality is true. Therefore, the choice of $\\alpha = \\frac{1}{2}$ ensures that the series converges.\n\nNext, we compute the Katz centrality vector $\\mathbf{x}$. The sum of the series can be expressed in closed form:\n$$\n\\mathbf{x} = \\sum_{k=1}^{\\infty} (\\alpha\\mathbf{A})^{k} \\mathbf{1} = \\left(\\left(\\sum_{k=0}^{\\infty} (\\alpha\\mathbf{A})^{k}\\right) - \\mathbf{I}\\right) \\mathbf{1} = ((\\mathbf{I} - \\alpha\\mathbf{A})^{-1} - \\mathbf{I})\\mathbf{1}\n$$\nFirst, we construct the matrix $\\mathbf{M} = \\mathbf{I} - \\alpha\\mathbf{A}$ with $\\alpha = \\frac{1}{2}$:\n$$\n\\mathbf{M} = \\mathbf{I} - \\frac{1}{2}\\mathbf{A} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} - \\frac{1}{2}\\begin{pmatrix} 0 & 1 & 1 & 1 \\\\ 1 & 0 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & -\\frac{1}{2} & -\\frac{1}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 1 & 0 & 0 \\\\ -\\frac{1}{2} & 0 & 1 & 0 \\\\ -\\frac{1}{2} & 0 & 0 & 1 \\end{pmatrix}\n$$\nNext, we compute the inverse $\\mathbf{M}^{-1} = (\\mathbf{I} - \\frac{1}{2}\\mathbf{A})^{-1}$. By using Gaussian elimination or by exploiting the matrix's structure, one finds:\n$$\n(\\mathbf{I} - \\frac{1}{2}\\mathbf{A})^{-1} = \\begin{pmatrix}\n4 & 2 & 2 & 2 \\\\\n2 & 2 & 1 & 1 \\\\\n2 & 1 & 2 & 1 \\\\\n2 & 1 & 1 & 2\n\\end{pmatrix}\n$$\nNow we can compute the vector $\\mathbf{x}$:\n$$\n\\mathbf{x} = \\left( \\begin{pmatrix}\n4 & 2 & 2 & 2 \\\\\n2 & 2 & 1 & 1 \\\\\n2 & 1 & 2 & 1 \\\\\n2 & 1 & 1 & 2\n\\end{pmatrix} - \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{x} = \\begin{pmatrix}\n3 & 2 & 2 & 2 \\\\\n2 & 1 & 1 & 1 \\\\\n2 & 1 & 1 & 1 \\\\\n2 & 1 & 1 & 1\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix}\n3+2+2+2 \\\\\n2+1+1+1 \\\\\n2+1+1+1 \\\\\n2+1+1+1\n\\end{pmatrix} = \\begin{pmatrix}\n9 \\\\ 5 \\\\ 5 \\\\ 5\n\\end{pmatrix}\n$$\nThe Katz centrality scores for genes $(\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4})$ are $(9, 5, 5, 5)$.\n\nFinally, we interpret these results. In network medicine, centrality measures are used to identify influential nodes within a disease module, which represents a group of interacting genes or proteins implicated in a particular disease. The \"guilt-by-association\" principle posits that highly central nodes are more likely to be functionally important and thus play a key role in the disease mechanism.\nKatz centrality quantifies influence by summing over all walks originating from a node, with longer walks being exponentially penalized. The network structure is a star graph with gene $\\mathrm{G1}$ at the center, connected to the three peripheral genes $\\mathrm{G2}$, $\\mathrm{G3}$, and $\\mathrm{G4}$.\nThe computed centrality scores reflect this topology:\n- Gene $\\mathrm{G1}$ has the highest centrality score ($9$). This is because it is the hub, having the most direct connections and participating in the largest number of walks of all lengths throughout the network. It mediates all communication between the peripheral genes.\n- Genes $\\mathrm{G2}$, $\\mathrm{G3}$, and $\\mathrm{G4}$ have identical, lower centrality scores ($5$). This is due to their symmetric positions in the network. They are less influential than the central hub, as they have fewer connections and their outgoing walks are largely channeled through $\\mathrm{G1}$.\nFrom a gene prioritization perspective, the significantly higher centrality of $\\mathrm{G1}$ marks it as the most influential component of this disease module. Therefore, according to network medicine principles, $\\mathrm{G1}$ should be prioritized for further experimental investigation. It is the top candidate for being a driver gene or a potent therapeutic target related to the disease. The remaining genes ($\\mathrm{G2}$, $\\mathrm{G3}$, $\\mathrm{G4}$) are of secondary priority.", "answer": "$$\n\\boxed{\\begin{pmatrix} 9 & 5 & 5 & 5 \\end{pmatrix}}\n$$", "id": "5084478"}, {"introduction": "Biological functions are often carried out by cohesive groups of interacting proteins, which form \"communities\" or \"modules\" within the larger network. This practice problem delves into the core mechanic of community detection by asking you to evaluate a potential community merger using the concept of modularity, $Q$. By calculating the modularity gain, $\\Delta Q$, you will apply the quantitative logic that algorithms like the Louvain method use to partition complex networks into meaningful functional units. [@problem_id:5084453]", "problem": "Consider a small undirected, unweighted gene interaction network representing six genes $G_1, G_2, G_3, G_4, G_5, G_6$. The network is specified by the symmetric adjacency matrix $A$ (with $A_{ij} = 1$ if there is an interaction between $G_i$ and $G_j$, and $A_{ij} = 0$ otherwise):\n$$\nA =\n\\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 1 & 0 & 0 \\\\\n1 & 1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 1 & 0\n\\end{pmatrix}.\n$$\nIn systems biology and network medicine, the Louvain community detection method greedily merges communities to maximize network modularity. Use the standard definition of modularity $Q$ for undirected, unweighted networks and the following initial partition of the nodes into communities:\n- $\\mathcal{C}_1 = \\{G_1, G_2\\}$,\n- $\\mathcal{C}_2 = \\{G_3, G_4\\}$,\n- $\\mathcal{C}_3 = \\{G_5, G_6\\}$.\n\nYou are to:\n- Compute the modularity $Q$ for the given initial partition.\n- Consider a single Louvain merge step that merges $\\mathcal{C}_1$ and $\\mathcal{C}_2$ into a single community $\\mathcal{C}_{12} = \\{G_1, G_2, G_3, G_4\\}$ (leaving $\\mathcal{C}_3$ unchanged), and compute the new modularity $Q$ after this merge.\n- From first principles, derive the modularity gain $\\Delta Q$ induced by this merge.\n\nExpress your final modularity gain $\\Delta Q$ as a single simplified fraction. No rounding is required, and no units are involved. Clearly state any quantities you compute (such as node degrees and the total number of edges) and adhere to the standard undirected modularity definition throughout your derivation.", "solution": "The solution proceeds as follows. First, we define network modularity and calculate the fundamental properties of the given gene interaction network. Second, we compute the modularity $Q$ for the initial partition. Third, we compute the modularity for the partition after the specified merge. Finally, we derive the modularity gain $\\Delta Q$ from first principles and calculate its value for the given merge.\n\nThe modularity, $Q$, of a network partitioned into communities is defined as:\n$$Q = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\frac{k_i k_j}{2m} \\right] \\delta(c_i, c_j)$$\nwhere $m$ is the total number of edges, $A_{ij}$ is the entry in the adjacency matrix for nodes $i$ and $j$, $k_i$ is the degree of node $i$, $c_i$ is the community to which node $i$ belongs, and $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if $c_i=c_j$ and $0$ otherwise.\n\nAn equivalent and more practical formula for calculation is:\n$$Q = \\sum_{c \\in \\mathcal{C}} \\left[ \\frac{l_c}{m} - \\left(\\frac{d_c}{2m}\\right)^2 \\right]$$\nwhere $\\mathcal{C}$ is the set of all communities, $l_c$ is the number of edges entirely within community $c$, and $d_c$ is the sum of the degrees of the nodes in community $c$.\n\nFirst, we calculate the basic properties of the network from the adjacency matrix $A$:\n$$A =\n\\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 1 & 0 & 0 \\\\\n1 & 1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\nThe total number of edges, $m$, is half the sum of all entries in the adjacency matrix (or half the sum of all node degrees):\n$$m = \\frac{1}{2} \\sum_{i,j} A_{ij} = \\frac{14}{2} = 7$$\nThe degrees of the nodes (genes) are the sums of the rows (or columns) of $A$:\n$k_1 = 1+1 = 2$\n$k_2 = 1+1+1 = 3$\n$k_3 = 1+1+1 = 3$\n$k_4 = 1+1+1 = 3$\n$k_5 = 1+1 = 2$\n$k_6 = 1 = 1$\nThe sum of degrees is $\\sum k_i = 2+3+3+3+2+1=14$, which correctly equals $2m$.\n\nNow, we compute the modularity $Q_{\\text{initial}}$ for the initial partition: $\\mathcal{C}_1 = \\{G_1, G_2\\}$, $\\mathcal{C}_2 = \\{G_3, G_4\\}$, $\\mathcal{C}_3 = \\{G_5, G_6\\}$.\n\nFor community $\\mathcal{C}_1$:\n- Internal edges $l_1$: The edge between $G_1$ and $G_2$ ($A_{12}=1$). So, $l_1 = 1$.\n- Sum of degrees $d_1$: $k_1 + k_2 = 2 + 3 = 5$.\n\nFor community $\\mathcal{C}_2$:\n- Internal edges $l_2$: The edge between $G_3$ and $G_4$ ($A_{34}=1$). So, $l_2 = 1$.\n- Sum of degrees $d_2$: $k_3 + k_4 = 3 + 3 = 6$.\n\nFor community $\\mathcal{C}_3$:\n- Internal edges $l_3$: The edge between $G_5$ and $G_6$ ($A_{56}=1$). So, $l_3 = 1$.\n- Sum of degrees $d_3$: $k_5 + k_6 = 2 + 1 = 3$.\n\nThe initial modularity is:\n$$Q_{\\text{initial}} = \\left[ \\frac{l_1}{m} - \\left(\\frac{d_1}{2m}\\right)^2 \\right] + \\left[ \\frac{l_2}{m} - \\left(\\frac{d_2}{2m}\\right)^2 \\right] + \\left[ \\frac{l_3}{m} - \\left(\\frac{d_3}{2m}\\right)^2 \\right]$$\n$$Q_{\\text{initial}} = \\left[ \\frac{1}{7} - \\left(\\frac{5}{14}\\right)^2 \\right] + \\left[ \\frac{1}{7} - \\left(\\frac{6}{14}\\right)^2 \\right] + \\left[ \\frac{1}{7} - \\left(\\frac{3}{14}\\right)^2 \\right]$$\n$$Q_{\\text{initial}} = \\frac{3}{7} - \\frac{5^2 + 6^2 + 3^2}{14^2} = \\frac{3}{7} - \\frac{25 + 36 + 9}{196} = \\frac{3}{7} - \\frac{70}{196}$$\n$$Q_{\\text{initial}} = \\frac{3 \\times 28}{196} - \\frac{70}{196} = \\frac{84 - 70}{196} = \\frac{14}{196} = \\frac{1}{14}$$\n\nNext, we compute the modularity $Q_{\\text{merged}}$ after merging $\\mathcal{C}_1$ and $\\mathcal{C}_2$ into $\\mathcal{C}_{12} = \\{G_1, G_2, G_3, G_4\\}$. The new partition is $\\{\\mathcal{C}_{12}, \\mathcal{C}_3\\}$.\n\nFor the new community $\\mathcal{C}_{12}$:\n- Internal edges $l_{12}$: These are the edges within $\\mathcal{C}_1$ ($l_1$), within $\\mathcal{C}_2$ ($l_2$), and between $\\mathcal{C}_1$ and $\\mathcal{C}_2$.\n  - Edges between $\\{G_1, G_2\\}$ and $\\{G_3, G_4\\}$ are $(G_1, G_3)$, $(G_2, G_3)$, and $(G_2, G_4)$, since $A_{13}=1$, $A_{23}=1$, and $A_{24}=1$. There are $3$ such edges.\n  - $l_{12} = l_1 + l_2 + (\\text{edges between } \\mathcal{C}_1, \\mathcal{C}_2) = 1 + 1 + 3 = 5$.\n- Sum of degrees $d_{12}$: $d_1 + d_2 = 5 + 6 = 11$.\n\nCommunity $\\mathcal{C}_3$ is unchanged.\n\nThe new modularity is:\n$$Q_{\\text{merged}} = \\left[ \\frac{l_{12}}{m} - \\left(\\frac{d_{12}}{2m}\\right)^2 \\right] + \\left[ \\frac{l_3}{m} - \\left(\\frac{d_3}{2m}\\right)^2 \\right]$$\n$$Q_{\\text{merged}} = \\left[ \\frac{5}{7} - \\left(\\frac{11}{14}\\right)^2 \\right] + \\left[ \\frac{1}{7} - \\left(\\frac{3}{14}\\right)^2 \\right]$$\n$$Q_{\\text{merged}} = \\frac{6}{7} - \\frac{11^2 + 3^2}{14^2} = \\frac{6}{7} - \\frac{121 + 9}{196} = \\frac{6}{7} - \\frac{130}{196}$$\n$$Q_{\\text{merged}} = \\frac{6 \\times 28}{196} - \\frac{130}{196} = \\frac{168 - 130}{196} = \\frac{38}{196} = \\frac{19}{98}$$\n\nFinally, we derive the modularity gain $\\Delta Q$ from first principles. The change in modularity from merging two communities, say $\\mathcal{C}_i$ and $\\mathcal{C}_j$, into a new community $\\mathcal{C}_{ij}$ is:\n$$\\Delta Q = Q_{\\text{new}} - Q_{\\text{old}}$$\nThe terms in the modularity sum corresponding to $\\mathcal{C}_i$ and $\\mathcal{C}_j$ are removed and replaced by a single term for $\\mathcal{C}_{ij}$.\n$$Q_{\\text{old\\_terms}} = \\left[ \\frac{l_i}{m} - \\left(\\frac{d_i}{2m}\\right)^2 \\right] + \\left[ \\frac{l_j}{m} - \\left(\\frac{d_j}{2m}\\right)^2 \\right]$$\n$$Q_{\\text{new\\_term}} = \\left[ \\frac{l_{ij}}{m} - \\left(\\frac{d_{ij}}{2m}\\right)^2 \\right]$$\nThe parameters for the new community are $d_{ij} = d_i + d_j$ and $l_{ij} = l_i + l_j + l_{i,j}^{\\text{between}}$, where $l_{i,j}^{\\text{between}}$ is the number of edges between nodes in $\\mathcal{C}_i$ and nodes in $\\mathcal{C}_j$.\n$$\\Delta Q = Q_{\\text{new\\_term}} - Q_{\\text{old\\_terms}}$$\n$$\\Delta Q = \\left[ \\frac{l_i + l_j + l_{i,j}^{\\text{between}}}{m} - \\left(\\frac{d_i + d_j}{2m}\\right)^2 \\right] - \\left[ \\frac{l_i}{m} - \\left(\\frac{d_i}{2m}\\right)^2 + \\frac{l_j}{m} - \\left(\\frac{d_j}{2m}\\right)^2 \\right]$$\n$$\\Delta Q = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{1}{(2m)^2} \\left[ (d_i + d_j)^2 - d_i^2 - d_j^2 \\right]$$\n$$\\Delta Q = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{1}{4m^2} \\left[ d_i^2 + 2d_i d_j + d_j^2 - d_i^2 - d_j^2 \\right]$$\n$$\\Delta Q = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{2d_i d_j}{4m^2} = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{d_i d_j}{2m^2}$$\nThis is the general formula for the modularity gain when merging two communities.\n\nApplying this formula to the merge of $\\mathcal{C}_1$ and $\\mathcal{C}_2$:\n- $i=1$, $j=2$\n- $m = 7$\n- $d_1 = 5$\n- $d_2 = 6$\n- $l_{1,2}^{\\text{between}} = 3$ (as calculated before)\n\n$$\\Delta Q = \\frac{3}{7} - \\frac{5 \\times 6}{2 \\times 7^2} = \\frac{3}{7} - \\frac{30}{2 \\times 49} = \\frac{3}{7} - \\frac{15}{49}$$\nTo combine the fractions, we use a common denominator of $49$:\n$$\\Delta Q = \\frac{3 \\times 7}{49} - \\frac{15}{49} = \\frac{21 - 15}{49} = \\frac{6}{49}$$\n\nAs a check, we can compute $\\Delta Q = Q_{\\text{merged}} - Q_{\\text{initial}}$:\n$$\\Delta Q = \\frac{19}{98} - \\frac{1}{14} = \\frac{19}{98} - \\frac{7}{98} = \\frac{12}{98} = \\frac{6}{49}$$\nThe results are consistent. The derived modularity gain is $\\frac{6}{49}$.\n\nIn summary:\n- Initial modularity $Q_{\\text{initial}} = \\frac{1}{14}$.\n- Modularity after merge $Q_{\\text{merged}} = \\frac{19}{98}$.\n- Modularity gain $\\Delta Q = \\frac{6}{49}$.", "answer": "$$\\boxed{\\frac{6}{49}}$$", "id": "5084453"}, {"introduction": "After identifying disease-associated gene modules, a key question is how these modules relate to one another, which can provide clues about disease comorbidity and pathway crosstalk. This problem introduces a network separation score to quantify the proximity of two gene sets within the protein-protein interaction network. By calculating this score, you will learn a powerful technique to assess whether two disease modules are topologically distinct or overlapping, providing a network-based perspective on their biological relationship. [@problem_id:5084477]", "problem": "In network medicine, the proximity between two disease-associated gene modules embedded in a protein-protein interaction network can be quantified by a separation score derived from shortest-path distances on the network. Consider the undirected, unweighted gene-gene interaction network with the following edges:\n(TP53, MDM2), (TP53, ATM), (ATM, CHEK2), (ATM, BRCA1), (BRCA1, BRCA2), (CHEK2, BRCA1), (EGFR, PIK3CA), (PIK3CA, AKT1), (AKT1, MDM2).\nLet the two gene sets be\n$A=\\{\\text{BRCA1}, \\text{BRCA2}, \\text{CHEK2}\\}$, $B=\\{\\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$.\nUse the following definitions based on shortest-path distance $d(x,y)$ measured as the number of edges along the shortest path between nodes $x$ and $y$ in the above network:\n- For distinct sets $X$ and $Y$, define the mean cross-set distance\n$$\n\\overline{d}_{XY}=\\frac{1}{|X|\\,|Y|}\\sum_{x\\in X}\\sum_{y\\in Y} d(x,y).\n$$\n- For a single set $X$, define the mean within-set distance over unordered distinct pairs\n$$\n\\overline{d}_{XX}=\\frac{2}{|X|\\,(|X|-1)}\\sum_{\\{x,x'\\}\\subset X} d(x,x').\n$$\nThe network separation score between $A$ and $B$ is defined as\n$$\ns(A,B)=\\overline{d}_{AB}-\\frac{1}{2}\\left(\\overline{d}_{AA}+\\overline{d}_{BB}\\right).\n$$\nCompute $s(A,B)$ for the specified network and gene sets. Express your final answer as an exact real number; no rounding is required. Do not include units.", "solution": "The problem requires the computation of the network separation score $s(A,B)$ between two gene sets, $A$ and $B$, within a given protein-protein interaction network. The score is defined as $s(A,B)=\\overline{d}_{AB}-\\frac{1}{2}\\left(\\overline{d}_{AA}+\\overline{d}_{BB}\\right)$. This computation necessitates determining three preliminary quantities: the mean within-set distance for set $A$ ($\\overline{d}_{AA}$), the mean within-set distance for set $B$ ($\\overline{d}_{BB}$), and the mean cross-set distance between $A$ and $B$ ($\\overline{d}_{AB}$). All these quantities are based on the shortest-path distance, $d(x,y)$, between nodes in the network.\n\nFirst, we represent the network graph and identify the members of sets $A$ and $B$.\nThe set of genes (nodes) is $V = \\{\\text{TP53}, \\text{MDM2}, \\text{ATM}, \\text{CHEK2}, \\text{BRCA1}, \\text{BRCA2}, \\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$.\nThe set of interactions (edges) is $E = \\{\\{\\text{TP53},\\text{MDM2}\\}, \\{\\text{TP53},\\text{ATM}\\}, \\{\\text{ATM},\\text{CHEK2}\\}, \\{\\text{ATM},\\text{BRCA1}\\}, \\{\\text{BRCA1},\\text{BRCA2}\\}, \\{\\text{CHEK2},\\text{BRCA1}\\}, \\{\\text{EGFR},\\text{PIK3CA}\\}, \\{\\text{PIK3CA},\\text{AKT1}\\}, \\{\\text{AKT1},\\text{MDM2}\\}\\}$.\nThe gene sets are $A=\\{\\text{BRCA1}, \\text{BRCA2}, \\text{CHEK2}\\}$ and $B=\\{\\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$.\nThe sizes of the sets are $|A|=3$ and $|B|=3$.\n\nNext, we must compute the shortest-path distances, $d(x,y)$, between all pairs of nodes within set $A$, within set $B$, and between sets $A$ and $B$. The distance is the number of edges in the shortest path.\n\nDistances within set $A$: $\\{\\text{BRCA1}, \\text{BRCA2}, \\text{CHEK2}\\}$\n- $d(\\text{BRCA1}, \\text{BRCA2})$: An edge $(\\text{BRCA1}, \\text{BRCA2})$ exists. Thus, $d(\\text{BRCA1}, \\text{BRCA2}) = 1$.\n- $d(\\text{BRCA1}, \\text{CHEK2})$: An edge $(\\text{CHEK2}, \\text{BRCA1})$ exists. Thus, $d(\\text{BRCA1}, \\text{CHEK2}) = 1$.\n- $d(\\text{BRCA2}, \\text{CHEK2})$: The shortest path is $\\text{BRCA2} \\to \\text{BRCA1} \\to \\text{CHEK2}$. Thus, $d(\\text{BRCA2}, \\text{CHEK2}) = 2$.\n\nDistances within set $B$: $\\{\\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$\n- $d(\\text{EGFR}, \\text{PIK3CA})$: An edge $(\\text{EGFR}, \\text{PIK3CA})$ exists. Thus, $d(\\text{EGFR}, \\text{PIK3CA}) = 1$.\n- $d(\\text{PIK3CA}, \\text{AKT1})$: An edge $(\\text{PIK3CA}, \\text{AKT1})$ exists. Thus, $d(\\text{PIK3CA}, \\text{AKT1}) = 1$.\n- $d(\\text{EGFR}, \\text{AKT1})$: The shortest path is $\\text{EGFR} \\to \\text{PIK3CA} \\to \\text{AKT1}$. Thus, $d(\\text{EGFR}, \\text{AKT1}) = 2$.\n\nDistances between set $A$ and set $B$:\nThe core path connecting the neighborhood of $A$ and the neighborhood of $B$ is $\\text{ATM} \\to \\text{TP53} \\to \\text{MDM2} \\to \\text{AKT1}$.\nThe distances from the node $\\text{ATM}$ (adjacent to nodes in $A$) to nodes in $B$ are:\n- $d(\\text{ATM}, \\text{AKT1})$: Path $\\text{ATM} \\to \\text{TP53} \\to \\text{MDM2} \\to \\text{AKT1}$. $d(\\text{ATM}, \\text{AKT1}) = 3$.\n- $d(\\text{ATM}, \\text{PIK3CA})$: Path $\\text{ATM} \\to \\dots \\to \\text{AKT1} \\to \\text{PIK3CA}$. $d(\\text{ATM}, \\text{PIK3CA}) = d(\\text{ATM}, \\text{AKT1}) + 1 = 4$.\n- $d(\\text{ATM}, \\text{EGFR})$: Path $\\text{ATM} \\to \\dots \\to \\text{PIK3CA} \\to \\text{EGFR}$. $d(\\text{ATM}, \\text{EGFR}) = d(\\text{ATM}, \\text{PIK3CA}) + 1 = 5$.\n\nNow we calculate the distances from each gene in $A$ to each gene in $B$:\nFrom $\\text{BRCA1} \\in A$:\n- $d(\\text{BRCA1}, \\text{AKT1}) = d(\\text{BRCA1}, \\text{ATM}) + d(\\text{ATM}, \\text{AKT1}) = 1 + 3 = 4$.\n- $d(\\text{BRCA1}, \\text{PIK3CA}) = d(\\text{BRCA1}, \\text{ATM}) + d(\\text{ATM}, \\text{PIK3CA}) = 1 + 4 = 5$.\n- $d(\\text{BRCA1}, \\text{EGFR}) = d(\\text{BRCA1}, \\text{ATM}) + d(\\text{ATM}, \\text{EGFR}) = 1 + 5 = 6$.\n\nFrom $\\text{BRCA2} \\in A$:\n- $d(\\text{BRCA2}, \\text{AKT1}) = d(\\text{BRCA2}, \\text{BRCA1}) + d(\\text{BRCA1}, \\text{AKT1}) = 1 + 4 = 5$.\n- $d(\\text{BRCA2}, \\text{PIK3CA}) = d(\\text{BRCA2}, \\text{BRCA1}) + d(\\text{BRCA1}, \\text{PIK3CA}) = 1 + 5 = 6$.\n- $d(\\text{BRCA2}, \\text{EGFR}) = d(\\text{BRCA2}, \\text{BRCA1}) + d(\\text{BRCA1}, \\text{EGFR}) = 1 + 6 = 7$.\n\nFrom $\\text{CHEK2} \\in A$: The shortest paths from $\\text{CHEK2}$ to set $B$ are via $\\text{ATM}$, since $d(\\text{CHEK2}, \\text{ATM})=1$, while the path through $\\text{BRCA1}$ would be $\\text{CHEK2} \\to \\text{BRCA1} \\to \\text{ATM}$ which is longer.\n- $d(\\text{CHEK2}, \\text{AKT1}) = d(\\text{CHEK2}, \\text{ATM}) + d(\\text{ATM}, \\text{AKT1}) = 1 + 3 = 4$.\n- $d(\\text{CHEK2}, \\text{PIK3CA}) = d(\\text{CHEK2}, \\text{ATM}) + d(\\text{ATM}, \\text{PIK3CA}) = 1 + 4 = 5$.\n- $d(\\text{CHEK2}, \\text{EGFR}) = d(\\text{CHEK2}, \\text{ATM}) + d(\\text{ATM}, \\text{EGFR}) = 1 + 5 = 6$.\n\nNow we compute the mean distances.\n1. Mean within-set distance for $A$, $\\overline{d}_{AA}$:\n$$ \\overline{d}_{AA}=\\frac{2}{|A|\\,(|A|-1)}\\sum_{\\{a,a'\\}\\subset A} d(a,a') = \\frac{2}{3(2)} \\left( d(\\text{BRCA1}, \\text{BRCA2}) + d(\\text{BRCA1}, \\text{CHEK2}) + d(\\text{BRCA2}, \\text{CHEK2}) \\right) $$\n$$ \\overline{d}_{AA} = \\frac{1}{3} (1 + 1 + 2) = \\frac{4}{3} $$\n\n2. Mean within-set distance for $B$, $\\overline{d}_{BB}$:\n$$ \\overline{d}_{BB}=\\frac{2}{|B|\\,(|B|-1)}\\sum_{\\{b,b'\\}\\subset B} d(b,b') = \\frac{2}{3(2)} \\left( d(\\text{EGFR}, \\text{PIK3CA}) + d(\\text{EGFR}, \\text{AKT1}) + d(\\text{PIK3CA}, \\text{AKT1}) \\right) $$\n$$ \\overline{d}_{BB} = \\frac{1}{3} (1 + 2 + 1) = \\frac{4}{3} $$\n\n3. Mean cross-set distance between $A$ and $B$, $\\overline{d}_{AB}$:\n$$ \\overline{d}_{AB}=\\frac{1}{|A|\\,|B|}\\sum_{a\\in A}\\sum_{b\\in B} d(a,b) = \\frac{1}{3 \\times 3} \\sum_{a\\in A}\\sum_{b\\in B} d(a,b) $$\nThe sum of distances is:\n$$ \\sum_{a\\in A}\\sum_{b\\in B} d(a,b) = (4+5+6) + (5+6+7) + (4+5+6) = 15 + 18 + 15 = 48 $$\n$$ \\overline{d}_{AB} = \\frac{1}{9} (48) = \\frac{16}{3} $$\n\nFinally, we compute the network separation score $s(A,B)$:\n$$ s(A,B) = \\overline{d}_{AB} - \\frac{1}{2}\\left(\\overline{d}_{AA} + \\overline{d}_{BB}\\right) $$\n$$ s(A,B) = \\frac{16}{3} - \\frac{1}{2}\\left(\\frac{4}{3} + \\frac{4}{3}\\right) = \\frac{16}{3} - \\frac{1}{2}\\left(\\frac{8}{3}\\right) = \\frac{16}{3} - \\frac{4}{3} = \\frac{12}{3} = 4 $$\nThe network separation score is $4$.", "answer": "$$\n\\boxed{4}\n$$", "id": "5084477"}]}