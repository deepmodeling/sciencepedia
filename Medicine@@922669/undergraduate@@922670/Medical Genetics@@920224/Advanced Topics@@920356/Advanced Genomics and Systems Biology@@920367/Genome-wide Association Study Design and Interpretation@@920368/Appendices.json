{"hands_on_practices": [{"introduction": "The Hardy-Weinberg Equilibrium (HWE) principle serves as a fundamental null model in population genetics, describing the stable relationship between allele and genotype frequencies in an ideal population. Before searching for trait associations, a critical quality control step in any Genome-Wide Association Study (GWAS) is to verify that genetic markers in the control population conform to HWE expectations. This practice will strengthen your foundational skills by having you derive the formulas for allele frequency and HWE from first principles and apply them to a sample dataset, a crucial first step in assessing data quality. [@problem_id:5041680]", "problem": "A genome-wide association study (GWAS) quality-control pipeline requires computing the minor allele frequency and checking consistency with Hardy-Weinberg Equilibrium (HWE) expectations. Consider a single-nucleotide polymorphism with two alleles, denoted by $A$ and $a$, genotyped in $N$ unrelated individuals drawn from a large, randomly mating population. In a sample of $N = 1000$ individuals, the observed genotype counts are $n_{AA} = 540$, $n_{Aa} = 420$, and $n_{aa} = 40$.\n\nUsing only core definitions from population genetics and Mendelian segregation, proceed as follows:\n\n1. Starting from the definition of allele frequency as the number of copies of an allele divided by the total number of allele copies in the sample, express the sample minor allele frequency $p$ for allele $a$ in terms of $n_{AA}$, $n_{Aa}$, $n_{aa}$, and $N$.\n\n2. Using the assumptions underlying Hardy-Weinberg Equilibrium (random mating, no selection, no mutation, no migration, and sufficiently large population), derive from first principles the expected genotype frequencies for $AA$, $Aa$, and $aa$ in terms of the allele frequencies, where $p$ denotes the frequency of allele $a$ and $q$ denotes the frequency of allele $A$.\n\n3. Compute the numerical values of the HWE-expected genotype frequencies for $AA$, $Aa$, and $aa$ using the value of $p$ obtained from the observed counts. Round your probabilities to $4$ significant figures and express them as decimals.\n\nProvide your final answer as a single row matrix in the order $\\big(P(AA),\\,P(Aa),\\,P(aa)\\big)$ with no units.", "solution": "The problem requires a three-part analysis of genotype data from a single-nucleotide polymorphism (SNP) based on the principles of population genetics, specifically the Hardy-Weinberg Equilibrium (HWE). The analysis proceeds by first deriving the formula for allele frequency, then deriving the HWE principle for genotype frequencies, and finally applying these to the provided data.\n\n### Part 1: Derivation of the Minor Allele Frequency Expression\n\nThe first task is to express the sample minor allele frequency, $p$, for allele $a$ in terms of the observed genotype counts $n_{AA}$, $n_{Aa}$, $n_{aa}$, and the total sample size $N$.\n\nThe definition of allele frequency is the total number of copies of that allele in a population sample divided by the total number of all allele copies for that gene. Since humans are diploid organisms, each individual carries two alleles for any autosomal gene.\n\nGiven a sample of $N$ individuals, the total number of alleles in the sample is $2N$. The problem states that the genotype counts are $n_{AA}$ for genotype $AA$, $n_{Aa}$ for genotype $Aa$, and $n_{aa}$ for genotype $aa$. The total number of individuals is the sum of these counts:\n$$N = n_{AA} + n_{Aa} + n_{aa}$$\n\nThe allele $a$ is carried by individuals with genotypes $Aa$ and $aa$.\n- Each individual with genotype $Aa$ carries one copy of the allele $a$. Thus, the total number of $a$ alleles from heterozygotes is $1 \\times n_{Aa} = n_{Aa}$.\n- Each individual with genotype $aa$ carries two copies of the allele $a$. Thus, the total number of $a$ alleles from homozygotes is $2 \\times n_{aa}$.\n\nThe total count of allele $a$ in the sample, let's call it $C_a$, is the sum of copies from both genotype groups:\n$$C_a = n_{Aa} + 2n_{aa}$$\n\nThe frequency of allele $a$, denoted by $p$, is therefore the ratio of the total count of allele $a$ to the total number of all alleles in the sample ($2N$):\n$$p = \\frac{C_a}{2N} = \\frac{n_{Aa} + 2n_{aa}}{2N}$$\nSubstituting the expression for $N$ in terms of the genotype counts yields the full expression requested:\n$$p = \\frac{n_{Aa} + 2n_{aa}}{2(n_{AA} + n_{Aa} + n_{aa})}$$\nThis completes the first part of the problem.\n\n### Part 2: Derivation of Expected Genotype Frequencies under HWE\n\nThe second task is to derive the expected genotype frequencies for $AA$, $Aa$, and $aa$ under the assumptions of Hardy-Weinberg Equilibrium. The core assumptions are a large, randomly mating population with no evolutionary influences such as mutation, migration, or natural selection.\n\nLet $p$ be the frequency of allele $a$ and $q$ be the frequency of allele $A$ in the population's gene pool. Since these are the only two alleles at this locus, their frequencies must sum to unity:\n$$p + q = 1$$\nUnder the assumption of random mating, the formation of genotypes for the next generation can be modeled as the random union of gametes (sperm and eggs) drawn from this gene pool. The frequency of gametes carrying allele $a$ is $p$, and the frequency of gametes carrying allele $A$ is $q$.\n\nThe probability of an offspring receiving a specific genotype is determined by the product of the frequencies of the alleles contributed by the two gametes that form the zygote.\n\n- The expected frequency of the homozygous genotype $AA$, denoted $P(AA)$, is the probability that a gamete carrying $A$ combines with another gamete carrying $A$. This probability is:\n  $$P(AA) = q \\times q = q^2$$\n\n- The expected frequency of the homozygous genotype $aa$, denoted $P(aa)$, is the probability that a gamete carrying $a$ combines with another gamete carrying $a$. This probability is:\n  $$P(aa) = p \\times p = p^2$$\n\n- The expected frequency of the heterozygous genotype $Aa$, denoted $P(Aa)$, can occur in two mutually exclusive ways:\n  1. A gamete carrying $A$ combines with a gamete carrying $a$. The probability of this is $q \\times p$.\n  2. A gamete carrying $a$ combines with a gamete carrying $A$. The probability of this is $p \\times q$.\n  The total probability for the heterozygous genotype is the sum of these two probabilities:\n  $$P(Aa) = (q \\times p) + (p \\times q) = 2pq$$\n\nThus, the expected genotype frequencies under HWE are:\n$$P(AA) = q^2$$\n$$P(Aa) = 2pq$$\n$$P(aa) = p^2$$\nAs a verification, the sum of these frequencies is $(q+p)^2 = 1^2 = 1$, as expected. This completes the second part.\n\n### Part 3: Numerical Computation of Expected Frequencies\n\nThe final task is to compute the numerical values for these expected frequencies using the provided data and round them to $4$ significant figures.\n\nFirst, we must calculate the sample allele frequencies $p$ and $q$ from the observed genotype counts: $N = 1000$, $n_{AA} = 540$, $n_{Aa} = 420$, and $n_{aa} = 40$. Note that $540+420+40 = 1000$, so the counts are consistent.\n\nUsing the formula from Part 1 for the frequency of allele $a$:\n$$p = \\frac{n_{Aa} + 2n_{aa}}{2N} = \\frac{420 + 2(40)}{2(1000)} = \\frac{420 + 80}{2000} = \\frac{500}{2000} = 0.25$$\nThe frequency of allele $A$, denoted by $q$, can be calculated similarly:\n$$q = \\frac{2n_{AA} + n_{Aa}}{2N} = \\frac{2(540) + 420}{2(1000)} = \\frac{1080 + 420}{2000} = \\frac{1500}{2000} = 0.75$$\nAlternatively, since $p+q=1$, we have $q = 1 - p = 1 - 0.25 = 0.75$. Since $p  q$, allele $a$ is indeed the minor allele.\n\nNow, we use these allele frequencies to calculate the HWE-expected genotype frequencies using the formulas from Part 2.\n\n- Expected frequency of $AA$:\n  $$P(AA) = q^2 = (0.75)^2 = 0.5625$$\n\n- Expected frequency of $Aa$:\n  $$P(Aa) = 2pq = 2 \\times 0.25 \\times 0.75 = 0.5 \\times 0.75 = 0.375$$\n\n- Expected frequency of $aa$:\n  $$P(aa) = p^2 = (0.25)^2 = 0.0625$$\n\nThe problem requires these probabilities to be rounded to $4$ significant figures.\n- $P(AA) = 0.5625$. This number already has exactly $4$ significant figures.\n- $P(Aa) = 0.375$. To express this with $4$ significant figures, we add a trailing zero: $0.3750$.\n- $P(aa) = 0.0625$. To show $4$ significant figures, we add a trailing zero: $0.06250$.\n\nThe final results for the expected frequencies are $0.5625$, $0.3750$, and $0.06250$ for genotypes $AA$, $Aa$, and $aa$, respectively. These are presented as a row matrix as requested.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5625  0.3750  0.06250 \\end{pmatrix}}\n$$", "id": "5041680"}, {"introduction": "Building on the principles of Hardy-Weinberg Equilibrium, this exercise moves from theory to practical application. In a real-world GWAS, the power of HWE testing lies not in confirming equilibrium, but in identifying significant deviations that can signal underlying problems with the data. This practice demonstrates how a stark deviation from HWE in a control group can be a strong indicator of systematic genotyping error, one of the most common sources of false-positive findings, and prompts you to consider the nuanced policies used to filter such problematic variants. [@problem_id:5041654]", "problem": "A Genome-Wide Association Study (GWAS) of a complex disease is conducted in a homogeneous population using high-density single-nucleotide polymorphism arrays. In a bi-allelic locus with alleles $A$ and $a$, the Hardy-Weinberg Equilibrium (HWE) principle states that, under random mating in a large population with no selection, migration, or mutation, genotype frequencies in an ideal control population are $p^2$ for $AA$, $2pq$ for $Aa$, and $q^2$ for $aa$, where $p$ and $q=1-p$ are the allele frequencies of $A$ and $a$, respectively. Deviations from these expected proportions in the control group can arise from biological causes (e.g., inbreeding or population substructure) or technical causes (e.g., systematic genotyping error such as allele-specific probe failure).\n\nYou observe the following genotype counts for the control subjects at a candidate variant: $n_{AA}=500$, $n_{Aa}=20$, $n_{aa}=24$, with total number of controls $N_c=544$. Assume the controls are ancestrally homogeneous and unrelated, and that cases may show deviation from HWE if the variant is truly associated with disease risk.\n\nStarting from the HWE definition and large-sample testing principles, compute the allele frequency $p$ in controls, the expected genotype counts under HWE, and an approximate chi-square goodness-of-fit test statistic for HWE in controls. Use the result to reason about whether the observed deviation is more consistent with genotyping error than with stochastic fluctuation, and then select all statements below that are most appropriate for interpreting and filtering this variant in a case-control GWAS.\n\nA. In control samples, a marked heterozygote deficit relative to Hardy-Weinberg Equilibrium (HWE) expectations (for example, $p_{\\mathrm{HWE}}10^{-6}$ by an exact test) is evidence consistent with genotyping error (such as allele-specific probe failure), so variants meeting this criterion should be excluded.\n\nB. HWE should be tested only in cases; if cases show deviation with $p_{\\mathrm{HWE}}10^{-6}$, the variant should be removed regardless of the control group.\n\nC. A universal threshold of $p_{\\mathrm{HWE}}0.05$ in controls is appropriate for genome-wide quality control filtering across all minor allele frequencies.\n\nD. Because HWE tests have reduced power and unstable expectations at very low minor allele frequency, an allele-frequency–stratified policy is advisable, such as filtering if $p_{\\mathrm{HWE}}^{\\mathrm{controls}}10^{-6}$ when $\\mathrm{MAF}\\ge 0.05$, filtering if $p_{\\mathrm{HWE}}^{\\mathrm{controls}}10^{-4}$ when $0.01\\le \\mathrm{MAF}0.05$, and not filtering solely on HWE when $\\mathrm{MAF}0.01$ unless other quality indicators (e.g., excess missingness) are present.\n\nE. The appropriate chi-square test for HWE at a bi-allelic locus has $2$ degrees of freedom because there are $3$ genotype classes.\n\nF. Population structure can induce apparent HWE deviations; therefore, testing HWE within ancestry-stratified control subsets rather than pooling all controls reduces false flags due to structure and is preferable for filtering decisions.", "solution": "The user has provided a problem statement regarding the interpretation of a Hardy-Weinberg Equilibrium (HWE) test in the context of a Genome-Wide Association Study (GWAS). I will first validate the problem statement, then perform the requested calculations, and finally evaluate each of the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Study type: Genome-Wide Association Study (GWAS) of a complex disease.\n- Population: Homogeneous.\n- Technology: High-density single-nucleotide polymorphism arrays.\n- Locus: Bi-allelic with alleles $A$ and $a$.\n- HWE Principle Definition: In an ideal control population (random mating, large size, no selection, migration, or mutation), genotype frequencies are $p^2$ ($AA$), $2pq$ ($Aa$), and $q^2$ ($aa$), where $p$ and $q$ are allele frequencies and $q=1-p$.\n- Potential causes for HWE deviation in controls: biological (inbreeding, population substructure) or technical (genotyping error).\n- Observed genotype counts in controls: $n_{AA}=500$, $n_{Aa}=20$, $n_{aa}=24$.\n- Total number of controls: $N_c=544$.\n- Assumptions: Controls are ancestrally homogeneous and unrelated. Cases may deviate from HWE due to disease association.\n- Task: Compute allele frequency $p$, expected genotype counts, and a chi-square statistic for HWE in controls. Use this to reason about the cause of deviation and select appropriate statements for variant interpretation and filtering.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is firmly grounded in the established principles of population genetics and statistical genetics. The use of Hardy-Weinberg Equilibrium as a quality control check in GWAS is a standard and critical procedure. The concepts mentioned—HWE, chi-square test, genotyping error, population structure, and minor allele frequency (MAF)-dependent filtering—are all fundamental to the field.\n- **Well-Posedness**: The problem is well-posed. It provides concrete data ($n_{AA}$, $n_{Aa}$, $n_{aa}$) and asks for specific calculations that lead to a definite quantitative result (the $\\chi^2$ statistic). This result then forms the basis for a qualitative, but standard, interpretation based on established practice.\n- **Objectivity**: The language is technical, precise, and objective. It presents a standard scenario encountered in genetic data analysis.\n\nThe problem statement is scientifically sound, formalizable, self-contained, and objective. It contains no contradictions, fatal ambiguities, or factual errors. The data provided ($500+20+24=544$) is internally consistent.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed to the solution.\n\n### Derivation and Interpretation\n\nFirst, I will perform the calculations requested in the problem statement using the provided genotype counts for the control group: $n_{AA}=500$, $n_{Aa}=20$, $n_{aa}=24$. The total sample size is $N_c = n_{AA} + n_{Aa} + n_{aa} = 500 + 20 + 24 = 544$.\n\n**1. Compute Allele Frequencies**\nThe total number of alleles in the sample is $2N_c = 2 \\times 544 = 1088$.\nThe number of $A$ alleles is $2 \\times n_{AA} + n_{Aa} = 2 \\times 500 + 20 = 1020$.\nThe number of $a$ alleles is $2 \\times n_{aa} + n_{Aa} = 2 \\times 24 + 20 = 48 + 20 = 68$.\nThe frequency of allele $A$, denoted by $p$, is:\n$$p = \\frac{2 n_{AA} + n_{Aa}}{2 N_c} = \\frac{1020}{1088} = \\frac{15}{16} = 0.9375$$\nThe frequency of allele $a$, denoted by $q$, is:\n$$q = 1 - p = 1 - 0.9375 = 0.0625 = \\frac{1}{16}$$\nAs a check, $q = (2 n_{aa} + n_{Aa}) / (2 N_c) = 68 / 1088 = 1/16$. The frequencies are correct. The minor allele is $a$, so the Minor Allele Frequency (MAF) is $0.0625$.\n\n**2. Compute Expected Genotype Counts under HWE**\nBased on the estimated allele frequencies, the expected genotype counts in a sample of size $N_c=544$ are:\n- Expected count of $AA$: $E_{AA} = N_c \\times p^2 = 544 \\times (0.9375)^2 = 544 \\times 0.87890625 = 478.125$\n- Expected count of $Aa$: $E_{Aa} = N_c \\times 2pq = 544 \\times 2 \\times 0.9375 \\times 0.0625 = 544 \\times 0.1171875 = 63.75$\n- Expected count of $aa$: $E_{aa} = N_c \\times q^2 = 544 \\times (0.0625)^2 = 544 \\times 0.00390625 = 2.125$\nThe sum of expected counts is $478.125 + 63.75 + 2.125 = 544$, which equals the sample size $N_c$.\n\n**3. Compute Chi-Square Goodness-of-Fit Statistic**\nThe chi-square ($\\chi^2$) statistic is calculated as $\\sum \\frac{(\\text{Observed} - \\text{Expected})^2}{\\text{Expected}}$.\nObserved counts: $O_{AA}=500$, $O_{Aa}=20$, $O_{aa}=24$.\n$$ \\chi^2 = \\frac{(O_{AA} - E_{AA})^2}{E_{AA}} + \\frac{(O_{Aa} - E_{Aa})^2}{E_{Aa}} + \\frac{(O_{aa} - E_{aa})^2}{E_{aa}} $$\n$$ \\chi^2 = \\frac{(500 - 478.125)^2}{478.125} + \\frac{(20 - 63.75)^2}{63.75} + \\frac{(24 - 2.125)^2}{2.125} $$\n$$ \\chi^2 = \\frac{(21.875)^2}{478.125} + \\frac{(-43.75)^2}{63.75} + \\frac{(21.875)^2}{2.125} $$\n$$ \\chi^2 \\approx \\frac{478.52}{478.125} + \\frac{1914.06}{63.75} + \\frac{478.52}{2.125} \\approx 1.0008 + 30.0245 + 225.1838 \\approx 256.21 $$\nThe degrees of freedom for this test are (number of genotype classes) - $1$ - (number of independent alleles estimated) = $3 - 1 - 1 = 1$. A $\\chi^2$ value of $\\approx 256$ on $1$ degree of freedom is astronomically significant (the p-value is infinitesimally small, far less than any conventional threshold like $10^{-6}$).\n\n**4. Interpretation of Results**\nThe observed genotype counts show a profound deviation from HWE. Specifically, there is a large deficit of heterozygotes ($O_{Aa}=20$ vs. $E_{Aa}\\approx64$) and a surplus of both homozygote classes. This pattern is a classic signature of genotyping error, particularly the kind where heterozygotes are systematically miscalled as homozygotes. Given the extremity of the deviation, genotyping error is a much more plausible cause than stochastic fluctuation (which is ruled out by the p-value) or biological phenomena like inbreeding, especially in a population assumed to be homogeneous.\n\n### Option-by-Option Analysis\n\n**A. In control samples, a marked heterozygote deficit relative to Hardy-Weinberg Equilibrium (HWE) expectations (for example, $p_{\\mathrm{HWE}}10^{-6}$ by an exact test) is evidence consistent with genotyping error (such as allele-specific probe failure), so variants meeting this criterion should be excluded.**\nThis statement is correct. A significant deviation from HWE in the control group, which is supposed to represent a randomly mating population, is a red flag for data quality. The specific pattern of heterozygote deficit, as calculated above, is strongly indicative of certain types of systematic genotyping error. Standard GWAS quality control (QC) protocols therefore recommend filtering out variants that show extreme HWE deviation in controls (e.g., $p_{\\mathrm{HWE}}  10^{-6}$ or a similarly stringent threshold) to avoid false-positive associations driven by technical artifacts.\n**Verdict: Correct**\n\n**B. HWE should be tested only in cases; if cases show deviation with $p_{\\mathrm{HWE}}10^{-6}$, the variant should be removed regardless of the control group.**\nThis statement is fundamentally incorrect. The HWE principle assumes the absence of selection. For a variant genuinely associated with a disease, the case group is, by definition, under selective pressure, and genotype frequencies are *expected* to deviate from HWE. Testing HWE in cases can be a test for association, not a test of genotyping quality. The control group is the proper group for HWE-based QC checks because it is assumed to be free from the selection pressure of the disease under study.\n**Verdict: Incorrect**\n\n**C. A universal threshold of $p_{\\mathrm{HWE}}0.05$ in controls is appropriate for genome-wide quality control filtering across all minor allele frequencies.**\nThis statement is incorrect for two main reasons. First, a p-value threshold of $0.05$ is far too lenient for a genome-wide study involving millions of tests; with $1,000,000$ variants, one would expect $50,000$ to fail this test by chance alone. Much stricter, Bonferroni-corrected-style thresholds (e.g., $p_{\\mathrm{HWE}}  10^{-6}$) are used in practice. Second, applying a \"universal\" threshold across all MAFs is not advisable because the statistical properties of the HWE test (both chi-square and exact tests) change with allele frequency.\n**Verdict: Incorrect**\n\n**D. Because HWE tests have reduced power and unstable expectations at very low minor allele frequency, an allele-frequency–stratified policy is advisable, such as filtering if $p_{\\mathrm{HWE}}^{\\mathrm{controls}}10^{-6}$ when $\\mathrm{MAF}\\ge 0.05$, filtering if $p_{\\mathrm{HWE}}^{\\mathrm{controls}}10^{-4}$ when $0.01\\le \\mathrm{MAF}0.05$, and not filtering solely on HWE when $\\mathrm{MAF}0.01$ unless other quality indicators (e.g., excess missingness) are present.**\nThis statement accurately describes a sophisticated and widely accepted best practice in GWAS QC. For rare variants (low MAF), the expected count of the rare homozygote genotype is very low (often $1$), which compromises the validity of the chi-square approximation and reduces statistical power. Therefore, it is standard practice to use a more lenient HWE filter for less common variants or to forgo HWE filtering entirely for very rare variants, relying instead on other QC metrics. The policy described is a realistic example of such a stratified approach.\n**Verdict: Correct**\n\n**E. The appropriate chi-square test for HWE at a bi-allelic locus has $2$ degrees of freedom because there are $3$ genotype classes.**\nThis statement is incorrect. The degrees of freedom for a chi-square goodness-of-fit test are calculated as: $df = (\\text{number of categories}) - 1 - (\\text{number of parameters estimated from the data})$. In this case, there are $3$ genotype categories ($AA$, $Aa$, $aa$). The allele frequency $p$ is one parameter estimated from the data (from which $q=1-p$ is determined). Therefore, the degrees of freedom are $df = 3 - 1 - 1 = 1$. Having $2$ degrees of freedom would only be correct if the allele frequencies were known *a priori* and not estimated from the sample, which is not the standard procedure.\n**Verdict: Incorrect**\n\n**F. Population structure can induce apparent HWE deviations; therefore, testing HWE within ancestry-stratified control subsets rather than pooling all controls reduces false flags due to structure and is preferable for filtering decisions.**\nThis statement is correct. The Wahlund effect describes how pooling samples from distinct subpopulations, even if each is in HWE internally, can create an artificial deficit of heterozygotes in the combined sample. This can mimic the signal of genotyping error. The standard and correct approach to mitigate this is to perform HWE testing within genetically homogeneous subgroups (e.g., defined by principal components analysis of genetic data or by self-reported ancestry). This helps to distinguish true technical artifacts from population genetic phenomena. While the problem assumes a homogeneous sample, this principle is a cornerstone of proper HWE test interpretation in any real-world GWAS.\n**Verdict: Correct**", "answer": "$$\\boxed{ADF}$$", "id": "5041654"}, {"introduction": "After ensuring high data quality through checks like the Hardy-Weinberg Equilibrium test, the core task of a GWAS is to quantify the association between each genetic variant and the trait of interest. This hands-on practice demystifies the statistical engine driving this analysis for quantitative traits: linear regression. By regressing a trait on genotype counts, you will calculate a variant's effect size ($\\beta$) and its standard error, the two key statistics that determine the strength and significance of a genetic association. [@problem_id:5041695]", "problem": "A Genome-Wide Association Study (GWAS) of an additive single-nucleotide polymorphism (SNP) in a cohort of $n=10$ unrelated individuals models a continuous quantitative trait $y$ using a linear model with an intercept and covariates (age, sex, and ancestry via the first five Principal Components (PCs)). The trait has been residualized by regressing $y$ on the intercept and those covariates using Ordinary Least Squares (OLS), yielding residuals $r_i = y_i - \\hat{y}_i$ that are orthogonal to the covariates. Consider the additive genotype $g_i \\in \\{0,1,2\\}$ for the same SNP, coded as the count of the effect allele. Assume independent, homoskedastic errors consistent with standard OLS assumptions.\n\nYou are provided the residuals and genotypes for individuals $i=1,\\dots,10$:\n$$\nr = (-0.4,\\ 0.1,\\ 0.2,\\ -0.1,\\ 0.3,\\ 0.5,\\ 0.4,\\ -0.2,\\ -0.3,\\ -0.5), \\quad\ng = (0,\\ 0,\\ 1,\\ 1,\\ 1,\\ 2,\\ 2,\\ 0,\\ 1,\\ 2).\n$$\nUsing OLS with an intercept, regress the residualized trait $r$ on the SNP genotype $g$ to obtain the estimated SNP effect (the slope) and its standard error. Start from the linear model definition for GWAS with covariates and use established results that justify residualization followed by single-predictor OLS.\n\nCompute the SNP effect estimate and its standard error, and provide both numbers. Round your numerical answers to four significant figures.", "solution": "The problem asks for the Ordinary Least Squares (OLS) estimate of a single-nucleotide polymorphism (SNP) effect and its standard error in a Genome-Wide Association Study (GWAS) context. The analysis uses a two-step procedure: first, the quantitative trait is residualized with respect to a set of covariates, and second, these residuals are regressed on the SNP genotype.\n\nThe full linear model for a GWAS is specified as:\n$$y_i = \\mathbf{x}_i^T \\boldsymbol{\\gamma} + \\beta g_i + \\epsilon_i$$\nwhere $y_i$ is the trait value for individual $i$, $\\mathbf{x}_i$ is a vector of covariates including an intercept, $\\boldsymbol{\\gamma}$ is the vector of covariate effects, $g_i$ is the SNP genotype, $\\beta$ is the SNP effect size, and $\\epsilon_i$ is an error term.\n\nThe Frisch-Waugh-Lovell (FWL) theorem states that the OLS estimate of $\\beta$ in the full model above is numerically identical to the slope coefficient obtained from a simple regression of the residuals of $y$ on the residuals of $g$, where both are residualized with respect to the covariates $\\mathbf{x}$. Let $M_X = I - X(X^T X)^{-1} X^T$ be the residual-maker matrix for the covariate matrix $X$. The exact OLS estimate is $\\hat{\\beta} = (g^T M_X g)^{-1} g^T M_X y$. The problem provides the residuals of the trait, $r = M_X y$, but asks to regress $r$ on the raw genotype vector $g$, not the residualized genotype vector $M_X g$. This is a common approximation in GWAS for computational speed, and it yields a very similar, though not identical, result to the full model, especially when the SNP genotype $g$ is weakly correlated with the covariates in $X$.\n\nFollowing the problem's explicit instructions, we fit the linear model:\n$$r_i = \\alpha + \\beta g_i + \\varepsilon_i$$\nwhere $r_i$ are the provided residuals of the trait, $g_i$ is the genotype, and we estimate an intercept $\\alpha$ and a slope $\\beta$ using OLS. The sample size is $n=10$.\n\nThe provided data are:\n$$r = (-0.4,\\ 0.1,\\ 0.2,\\ -0.1,\\ 0.3,\\ 0.5,\\ 0.4,\\ -0.2,\\ -0.3,\\ -0.5)$$\n$$g = (0,\\ 0,\\ 1,\\ 1,\\ 1,\\ 2,\\ 2,\\ 0,\\ 1,\\ 2)$$\n\nFirst, we compute the sample means $\\bar{r}$ and $\\bar{g}$:\n$$\\bar{r} = \\frac{1}{n} \\sum_{i=1}^{n} r_i = \\frac{1}{10} (-0.4 + 0.1 + 0.2 - 0.1 + 0.3 + 0.5 + 0.4 - 0.2 - 0.3 - 0.5) = \\frac{0}{10} = 0$$\nThe mean of the residuals is $0$, as expected since the original regression producing them included an intercept.\n$$\\bar{g} = \\frac{1}{n} \\sum_{i=1}^{n} g_i = \\frac{1}{10} (0+0+1+1+1+2+2+0+1+2) = \\frac{10}{10} = 1$$\n\nThe OLS estimate for the slope $\\beta$ (the SNP effect) is given by:\n$$\\hat{\\beta} = \\frac{\\sum_{i=1}^{n} (g_i - \\bar{g})(r_i - \\bar{r})}{\\sum_{i=1}^{n} (g_i - \\bar{g})^2}$$\nSince $\\bar{r}=0$, this simplifies to:\n$$\\hat{\\beta} = \\frac{\\sum_{i=1}^{n} (g_i - \\bar{g})r_i}{\\sum_{i=1}^{n} (g_i - \\bar{g})^2} = \\frac{S_{gr}}{S_{gg}}$$\n\nWe calculate the sum of squared deviations for $g$, $S_{gg}$:\n$$S_{gg} = \\sum_{i=1}^{n} (g_i - 1)^2 = (0-1)^2 + (0-1)^2 + (1-1)^2 + (1-1)^2 + (1-1)^2 + (2-1)^2 + (2-1)^2 + (0-1)^2 + (1-1)^2 + (2-1)^2$$\n$$S_{gg} = (-1)^2 + (-1)^2 + 0^2 + 0^2 + 0^2 + 1^2 + 1^2 + (-1)^2 + 0^2 + 1^2 = 1 + 1 + 0 + 0 + 0 + 1 + 1 + 1 + 0 + 1 = 6$$\n\nNext, we calculate the sum of cross-products, $S_{gr}$:\n$$S_{gr} = \\sum_{i=1}^{n} (g_i - 1)r_i = (-1)(-0.4) + (-1)(0.1) + (0)(0.2) + (0)(-0.1) + (0)(0.3) + (1)(0.5) + (1)(0.4) + (-1)(-0.2) + (0)(-0.3) + (1)(-0.5)$$\n$$S_{gr} = 0.4 - 0.1 + 0 + 0 + 0 + 0.5 + 0.4 + 0.2 + 0 - 0.5 = 0.9$$\n\nNow, we can compute the SNP effect estimate $\\hat{\\beta}$:\n$$\\hat{\\beta} = \\frac{S_{gr}}{S_{gg}} = \\frac{0.9}{6} = 0.15$$\n\nTo find the standard error of $\\hat{\\beta}$, we first need to estimate the variance of the error term, $\\sigma^2$. The estimator is $\\hat{\\sigma}^2$, the mean squared error:\n$$\\hat{\\sigma}^2 = \\frac{SSR}{n-k}$$\nwhere $SSR$ is the sum of squared residuals from our current regression of $r$ on $g$, and $k$ is the number of parameters estimated ($k=2$ for $\\alpha$ and $\\beta$). The degrees of freedom for the error term is $n-k = 10 - 2 = 8$.\n\nThe $SSR$ can be calculated as:\n$$SSR = S_{rr} - \\frac{S_{gr}^2}{S_{gg}}$$\nwhere $S_{rr} = \\sum (r_i - \\bar{r})^2 = \\sum r_i^2$ since $\\bar{r}=0$.\n$$S_{rr} = (-0.4)^2 + (0.1)^2 + (0.2)^2 + (-0.1)^2 + (0.3)^2 + (0.5)^2 + (0.4)^2 + (-0.2)^2 + (-0.3)^2 + (-0.5)^2$$\n$$S_{rr} = 0.16 + 0.01 + 0.04 + 0.01 + 0.09 + 0.25 + 0.16 + 0.04 + 0.09 + 0.25 = 1.1$$\n\nNow we compute $SSR$:\n$$SSR = 1.1 - \\frac{(0.9)^2}{6} = 1.1 - \\frac{0.81}{6} = 1.1 - 0.135 = 0.965$$\nThe estimated error variance is:\n$$\\hat{\\sigma}^2 = \\frac{SSR}{n-2} = \\frac{0.965}{8} = 0.120625$$\n\nThe standard error of the slope estimate, $SE(\\hat{\\beta})$, is given by:\n$$SE(\\hat{\\beta}) = \\sqrt{\\frac{\\hat{\\sigma}^2}{S_{gg}}}$$\n$$SE(\\hat{\\beta}) = \\sqrt{\\frac{0.120625}{6}} = \\sqrt{0.020104166...} \\approx 0.14178916$$\n\nThe problem requires rounding the results to four significant figures.\nThe SNP effect estimate is $\\hat{\\beta}=0.15$. To four significant figures, this is $0.1500$.\nThe standard error of the SNP effect is $SE(\\hat{\\beta}) \\approx 0.14178916$. To four significant figures, this is $0.1418$.\n\nThe SNP effect estimate is $\\hat{\\beta} = 0.1500$ and its standard error is $SE(\\hat{\\beta}) = 0.1418$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.1500  0.1418 \\end{pmatrix}}$$", "id": "5041695"}]}