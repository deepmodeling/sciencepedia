{"hands_on_practices": [{"introduction": "Every single-cell experiment begins with a biological sample, but not every cell survives the journey to the sequencer. This practice models the critical pre-analytical phase, where cumulative cell loss during tissue processing can determine the success or failure of an entire study. You will use basic probability to calculate the expected final cell yield, demonstrating a crucial step in experimental planning and quality control [@problem_id:5081910].", "problem": "A surgical biopsy from a heterogeneous tumor is processed for single-cell transcriptomics to support clinical diagnostics in medical genetics. The workflow includes three sequential steps: enzymatic tissue dissociation to obtain a single-cell suspension, Fluorescence-Activated Cell Sorting (FACS) to enrich viable cells and remove debris or doublets, and microfluidic capture for single-cell library preparation. Suppose the initial cell yield from the biopsy is $N = 1.0 \\times 10^{6}$ cells. Empirically measured stepwise losses are $30\\%$ during dissociation, $20\\%$ during sorting, and $10\\%$ during capture. Assume these losses act independently on each cell and that viability at each step is already reflected by the stated losses. The clinical assay being considered requires at least $M = 2.5 \\times 10^{5}$ viable single cells after capture to meet sensitivity specifications for detecting low-frequency mosaic variants.\n\nUsing only core probability definitions and the independence assumption for sequential processing steps, derive the expected number of viable single cells recovered after capture. Then, based on that expectation, decide whether the assay requirement is met. Express the expected number as a count in scientific notation and round to four significant figures.", "solution": "The problem statement is evaluated as scientifically grounded, well-posed, objective, and self-contained. All provided data—the initial cell number, sequential loss percentages, and the minimum required cell count—are plausible within the context of single-cell genomics workflows in a clinical setting. The problem is based on fundamental principles of probability theory, specifically the concept of independent events. The request is to calculate an expected value and compare it to a threshold, which is a standard and formalizable task. Therefore, the problem is valid and a solution will be provided.\n\nLet $N$ be the initial number of cells from the biopsy. Let $L_1$, $L_2$, and $L_3$ be the fractional losses at the three sequential steps: dissociation, sorting, and capture, respectively.\nThe given values are:\nInitial cell yield: $N = 1.0 \\times 10^{6}$\nLoss during dissociation: $L_1 = 30\\% = 0.30$\nLoss during sorting: $L_2 = 20\\% = 0.20$\nLoss during capture: $L_3 = 10\\% = 0.10$\nMinimum required cells for the assay: $M = 2.5 \\times 10^{5}$\n\nThe retention rate, or probability of a single cell surviving a given step, is the complement of the loss rate. Let $R_1$, $R_2$, and $R_3$ be the retention rates for the three steps.\nThe retention rate during dissociation is $R_1 = 1 - L_1 = 1 - 0.30 = 0.70$.\nThe retention rate during sorting is $R_2 = 1 - L_2 = 1 - 0.20 = 0.80$.\nThe retention rate during capture is $R_3 = 1 - L_3 = 1 - 0.10 = 0.90$.\n\nThe problem states that these losses act independently. Therefore, the overall probability, $R_{\\text{total}}$, that a single cell will survive all three sequential processing steps is the product of the individual retention rates:\n$$R_{\\text{total}} = R_1 \\times R_2 \\times R_3$$\n\nThe process can be formally described by considering each of the $N$ initial cells as undergoing an independent Bernoulli trial, where \"success\" is defined as surviving all three steps. The probability of success for any given cell is $p = R_{\\text{total}}$. The total number of recovered cells, $N_{\\text{final}}$, follows a binomial distribution $B(N, p)$. The expected value of a binomial distribution is given by the product of the number of trials ($N$) and the probability of success ($p$).\n\nTherefore, the expected number of viable single cells recovered after capture, $E[N_{\\text{final}}]$, is:\n$$E[N_{\\text{final}}] = N \\times p = N \\times R_{\\text{total}}$$\n$$E[N_{\\text{final}}] = N \\times (1 - L_1) \\times (1 - L_2) \\times (1 - L_3)$$\n\nSubstituting the given values into the equation:\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times (1 - 0.30) \\times (1 - 0.20) \\times (1 - 0.10)$$\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times (0.70) \\times (0.80) \\times (0.90)$$\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times (0.56) \\times (0.90)$$\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times 0.504$$\n$$E[N_{\\text{final}}] = 504000$$\n\nThe problem requires the answer to be expressed in scientific notation and rounded to four significant figures.\n$$E[N_{\\text{final}}] = 5.040 \\times 10^{5}$$\n\nNext, we must decide if the assay requirement is met. This requires comparing the expected number of recovered cells, $E[N_{\\text{final}}]$, with the minimum required number of cells, $M$.\nThe clinical assay requires at least $M = 2.5 \\times 10^{5}$ cells.\nOur calculated expected number of recovered cells is $E[N_{\\text{final}}] = 5.040 \\times 10^{5}$.\n\nComparing the two values:\n$$5.040 \\times 10^{5} > 2.5 \\times 10^{5}$$\nSince the expected number of recovered cells is greater than the minimum requirement, we conclude that, based on this expectation, the assay requirement is met. The expected yield exceeds the minimum threshold for the clinical assay.", "answer": "$$\\boxed{5.040 \\times 10^{5}}$$", "id": "5081910"}, {"introduction": "In modern high-throughput single-cell genomics, cells are randomly encapsulated into millions of tiny droplets, a process governed by the laws of probability. This exercise explores the core statistical challenge of this technology: the trade-off between maximizing the number of captured single cells and minimizing the creation of \"doublets\"—droplets containing two or more cells, which can confound downstream analysis. By modeling cell loading with a Poisson distribution, you will determine the optimal loading concentration $\\lambda$ to achieve a desired experimental throughput, a fundamental skill for designing any droplet-based single-cell experiment [@problem_id:5081929].", "problem": "A droplet-based single-cell RNA sequencing (scRNA-seq) system used in clinical diagnostics partitions cells into microdroplets such that the number of cells per droplet arises from random encapsulation. In standard practice, under dilute loading and well-mixed suspensions, the number of cells per droplet is modeled as a Poisson random variable with mean loading rate $\\lambda$ cells per droplet. Starting from this assumption and the definition of the Poisson process, derive the expected probability that a droplet contains two or more cells (a doublet or higher-order multiplet) as a function of $\\lambda$. Then, determine the loading rate $\\lambda$ that minimizes the doublet probability while achieving an expected throughput of $10^{4}$ successfully captured single-cell profiles in one run, where “throughput” means the expected number of droplets that yield exactly one viable, barcoded cell.\n\nAssume the following experimentally grounded parameters for the run:\n- Droplet generation rate $R_{d} = 2000$ droplets per second.\n- Run time $T_{\\text{run}} = 1800$ seconds.\n- Effective capture efficiency $\\eta = 0.6$, which combines viability and molecular barcoding success.\n\nReport the single value of $\\lambda$ that achieves the target throughput with the smallest possible doublet probability. Express $\\lambda$ as a dimensionless quantity and round your answer to four significant figures.", "solution": "The problem statement is first validated for scientific soundness, self-consistency, and clarity.\n\n**Step 1: Extract Givens**\n- The number of cells per droplet, $X$, is a Poisson random variable with mean loading rate $\\lambda$.\n- Goal 1: Derive the expected probability that a droplet contains two or more cells, $P(X \\ge 2)$, as a function of $\\lambda$.\n- Goal 2: Determine the loading rate $\\lambda$ that minimizes the doublet probability while achieving an expected throughput of $10^{4}$ successfully captured single-cell profiles.\n- Definition of \"throughput\": The expected number of droplets that yield exactly one viable, barcoded cell.\n- Droplet generation rate: $R_{d} = 2000$ droplets per second.\n- Run time: $T_{\\text{run}} = 1800$ seconds.\n- Effective capture efficiency: $\\eta = 0.6$.\n- Final answer constraint: Report $\\lambda$ as a dimensionless quantity rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The premise that cell encapsulation in droplet microfluidics follows a Poisson distribution is a standard and experimentally verified model in single-cell genomics. It is a cornerstone of the analysis of droplet-based sequencing data. The given parameters ($R_{d}$, $T_{\\text{run}}$, $\\eta$) are realistic for commercial systems. The problem is firmly rooted in established principles of probability theory and biophysics.\n- **Well-Posed**: The problem asks for a derivation and a constrained optimization. The objective function to be minimized is the doublet probability, $P(X \\ge 2)$. The constraint is a fixed target for throughput. As will be shown, the doublet probability is a monotonically increasing function of the loading rate $\\lambda$. The throughput is a function of $\\lambda$ that has a maximum, meaning a given throughput level can be achieved by two different values of $\\lambda$. The directive to minimize the doublet probability unambiguously selects the smaller of these two $\\lambda$ values, rendering the problem well-posed with a unique solution.\n- **Objective**: The problem is stated using precise, quantitative, and unbiased language. All terms are either standard in the field or explicitly defined.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. Proceeding to the solution.\n\n**Part 1: Derivation of Multiplet Probability**\n\nLet $X$ be the random variable representing the number of cells in a single droplet. According to the problem statement, $X$ follows a Poisson distribution with mean $\\lambda$. The probability mass function (PMF) is given by:\n$$\nP(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots\n$$\nThe event that a droplet contains two or more cells is a \"multiplet\" event (a doublet, triplet, etc.). The probability of this event is $P(X \\ge 2)$. It is more convenient to calculate this using the complement rule:\n$$\nP(X \\ge 2) = 1 - P(X < 2) = 1 - (P(X=0) + P(X=1))\n$$\nUsing the PMF, we find the probabilities for $k=0$ and $k=1$:\n$$\nP(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)\n$$\n$$\nP(X=1) = \\frac{\\lambda^1 \\exp(-\\lambda)}{1!} = \\lambda \\exp(-\\lambda)\n$$\nSubstituting these into the expression for $P(X \\ge 2)$ yields the desired function:\n$$\nP(X \\ge 2) = 1 - \\exp(-\\lambda) - \\lambda \\exp(-\\lambda)\n$$\n\n**Part 2: Determination of the Optimal Loading Rate $\\lambda$**\n\nThe problem requires finding the loading rate $\\lambda$ that minimizes the multiplet probability, $P(X \\ge 2)$, subject to a throughput constraint. To understand how $P(X \\ge 2)$ depends on $\\lambda$, we can examine its derivative with respect to $\\lambda$:\n$$\n\\frac{d}{d\\lambda} P(X \\ge 2) = \\frac{d}{d\\lambda} (1 - \\exp(-\\lambda) - \\lambda \\exp(-\\lambda)) = -(-\\exp(-\\lambda)) - (\\exp(-\\lambda) - \\lambda \\exp(-\\lambda)) = \\lambda \\exp(-\\lambda)\n$$\nFor any physically meaningful loading rate $\\lambda > 0$, the derivative $\\lambda \\exp(-\\lambda)$ is always positive. This means that $P(X \\ge 2)$ is a strictly increasing function of $\\lambda$. Therefore, to minimize the multiplet probability, we must find the smallest possible value of $\\lambda$ that satisfies the throughput constraint.\n\nThe throughput, which we will denote as $T_p$, is the expected number of successfully captured single-cell profiles. This is determined by the total number of droplets generated, the probability that a droplet contains exactly one cell, and the effective capture efficiency.\n\nFirst, we calculate the total number of droplets, $N_{\\text{total}}$, generated during the run:\n$$\nN_{\\text{total}} = R_d \\times T_{\\text{run}} = (2000 \\, \\text{s}^{-1}) \\times (1800 \\, \\text{s}) = 3.6 \\times 10^6\n$$\nThe expected throughput $T_p$ is given by the expression:\n$$\nT_p = N_{\\text{total}} \\times P(X=1) \\times \\eta\n$$\nWe are given a target throughput $T_p = 10^4$ and an efficiency $\\eta = 0.6$. Substituting the known values and the expression for $P(X=1)$:\n$$\n10^4 = (3.6 \\times 10^6) \\times (\\lambda \\exp(-\\lambda)) \\times 0.6\n$$\nWe can now solve for the term $\\lambda \\exp(-\\lambda)$:\n$$\n\\lambda \\exp(-\\lambda) = \\frac{10^4}{3.6 \\times 10^6 \\times 0.6} = \\frac{10^4}{2.16 \\times 10^6} = \\frac{1}{216}\n$$\nLet this constant be $C = \\frac{1}{216}$. We must solve the transcendental equation $\\lambda \\exp(-\\lambda) = C$. The function $f(\\lambda) = \\lambda \\exp(-\\lambda)$ increases from $0$ at $\\lambda=0$ to a maximum value of $\\exp(-1) \\approx 0.3679$ at $\\lambda=1$, and then decreases towards $0$ as $\\lambda \\to \\infty$. Since our constant $C = \\frac{1}{216} \\approx 0.00463$ is between $0$ and $\\exp(-1)$, there are two real solutions for $\\lambda$: one in the interval $(0, 1)$ and another in $(1, \\infty)$.\n\nAs established earlier, to minimize the multiplet probability $P(X \\ge 2)$, we must select the smaller of these two solutions for $\\lambda$.\n\nThis equation can be solved formally using the Lambert W function. Let $y = -\\lambda$. The equation becomes:\n$$\n-(-y) \\exp(y) = C \\implies y \\exp(y) = -C\n$$\nThe solution for $y$ is given by $y = W(-C)$. The Lambert W function, $W(z)$, is multi-valued for $z \\in [-1/e, 0)$. The two real branches are the principal branch, $W_0(z)$, which yields values in $[-1, 0]$, and the lower branch, $W_{-1}(z)$, which yields values in $(-\\infty, -1]$.\nThe two solutions for $\\lambda = -y$ are:\n$$\n\\lambda_0 = -W_0(-C)\n$$\n$$\n\\lambda_{-1} = -W_{-1}(-C)\n$$\nSince $W_0(-C)$ is between $-1$ and $0$, $\\lambda_0$ is between $0$ and $1$. Since $W_{-1}(-C)$ is less than $-1$, $\\lambda_{-1}$ is greater than $1$. We must choose the smaller solution, $\\lambda_0$.\n\nWe now compute the numerical value for $\\lambda = -W_0(-1/216)$:\n$$\\lambda = -W_0\\left(-\\frac{1}{216}\\right)$$\n$$\\lambda \\approx -W_0(-0.0046296)$$\nUsing a numerical solver for the Lambert W function:\n$$\\lambda \\approx 0.004651037$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\\lambda \\approx 0.004651$$\nThis is the loading rate that achieves the target throughput of $10^4$ cells while incurring the lowest possible probability of generating multiplets.", "answer": "$$\\boxed{0.004651}$$", "id": "5081929"}, {"introduction": "Ultimately, the goal of clinical single-cell genomics is to make accurate diagnostic calls from sequencing data, which is inherently noisy. This exercise tackles the final step of our workflow: distinguishing a true genetic signal from background sequencing error at the single-cell level. You will derive and apply a one-sided hypothesis test based on the binomial distribution to decide if a cell carries a specific heterozygous variant [@problem_id:5081884]. This practice provides a framework for making statistically robust conclusions from quantitative sequencing reads, the very foundation of genomic diagnostics.", "problem": "A targeted single-cell DNA sequencing assay is used in a clinical genetics laboratory to assess whether an individual cell harbors a heterozygous single nucleotide variant (SNV). Each sequencing read overlapping the locus independently reports either the reference base or the variant base. Assume that, if the cell is truly homozygous reference at this locus (no SNV present), the only way to observe a variant-supporting read is through a per-read substitution error with probability $\\epsilon$, and that read errors are independent across reads.\n\nFrom first principles of independent Bernoulli trials and the definition of the binomial distribution, derive a one-sided hypothesis test for the presence of a heterozygous SNV based on observing $k$ variant-supporting reads out of $n$ total reads, under the null hypothesis $H_{0}$ that the cell is homozygous reference (so that the probability of a variant-supporting read is $\\epsilon$). Explicitly derive a closed-form expression for the $p$-value as a function of $k$, $n$, and $\\epsilon$.\n\nThen evaluate this $p$-value for $k=3$, $n=20$, and $\\epsilon=0.01$. Express your final numerical probability as a decimal rounded to four significant figures.", "solution": "The problem requires the derivation of a one-sided hypothesis test to determine if a heterozygous single nucleotide variant (SNV) is present in a single cell, based on DNA sequencing data.\n\nFirst, we formalize the problem in statistical terms. Let $X$ be the random variable representing the number of sequencing reads that support the variant base out of a total of $n$ reads covering the genomic locus in question. We are given the observed value of this variable, $X=k$.\n\nThe problem specifies the null hypothesis, $H_{0}$, as the scenario where the cell is homozygous for the reference allele. Under this hypothesis, observing a variant-supporting read is purely the result of a sequencing error. Each read is an independent trial. Let us define a \"success\" as observing a variant-supporting read. The probability of success for any single read, under $H_{0}$, is given as the error rate, $\\epsilon$.\n\nSince there are $n$ independent trials (reads), each with the same probability of success $\\epsilon$, the random variable $X$ follows a binomial distribution. We can write this as:\n$$\nX | H_{0} \\sim \\text{Binomial}(n, \\epsilon)\n$$\nThe probability mass function (PMF) for $X$ under the null hypothesis is given by:\n$$\nP(X=i | H_{0}) = \\binom{n}{i} \\epsilon^i (1-\\epsilon)^{n-i}\n$$\nfor $i \\in \\{0, 1, 2, \\ldots, n\\}$.\n\nThe alternative hypothesis, $H_{a}$, is that the cell is heterozygous for the SNV. In this case, we would expect a significantly higher number of variant-supporting reads than what can be attributed to error alone. An ideal heterozygous locus would yield variant reads with a probability of approximately $0.5$. Therefore, observing a large value of $k$ provides evidence against $H_{0}$ and in favor of $H_{a}$. This indicates that a one-sided, right-tailed test is appropriate.\n\nThe $p$-value is defined as the probability of observing a result at least as extreme as the one actually observed (i.e., $k$ variant reads), assuming the null hypothesis $H_{0}$ is true. For a right-tailed test, \"at least as extreme\" means observing $k$ or more successes.\n\nThus, the $p$-value is $P(X \\ge k | H_0)$. We can express this as a sum of probabilities from the binomial distribution:\n$$\np\\text{-value} = P(X \\ge k | H_0) = \\sum_{i=k}^{n} P(X=i | H_{0})\n$$\nSubstituting the binomial PMF, we arrive at the general closed-form expression for the $p$-value as a function of the observed variant read count $k$, the total read count $n$, and the error probability $\\epsilon$:\n$$\np\\text{-value}(k, n, \\epsilon) = \\sum_{i=k}^{n} \\binom{n}{i} \\epsilon^i (1-\\epsilon)^{n-i}\n$$\nThis completes the first part of the problem.\n\nFor the second part, we must evaluate this $p$-value for the specific case where $k=3, n=20$, and $\\epsilon=0.01$. The expression becomes:\n$$\np\\text{-value} = \\sum_{i=3}^{20} \\binom{20}{i} (0.01)^i (1-0.01)^{20-i}\n$$\nDirectly calculating this sum of $18$ terms is computationally intensive. It is more efficient to calculate the probability of the complementary event, $P(X  3)$, and subtract it from $1$:\n$$\np\\text{-value} = 1 - P(X  3) = 1 - [P(X=0) + P(X=1) + P(X=2)]\n$$\nWe calculate each of these probabilities using the binomial PMF with $n=20$ and $p=\\epsilon=0.01$:\n$$\nP(X=0) = \\binom{20}{0} (0.01)^0 (0.99)^{20} = 1 \\cdot 1 \\cdot (0.99)^{20} \\approx 0.81790693\n$$\n$$\nP(X=1) = \\binom{20}{1} (0.01)^1 (0.99)^{19} = 20 \\cdot (0.01) \\cdot (0.99)^{19} \\approx 0.16523372\n$$\n$$\nP(X=2) = \\binom{20}{2} (0.01)^2 (0.99)^{18} = \\frac{20 \\cdot 19}{2} \\cdot (0.01)^2 \\cdot (0.99)^{18} = 190 \\cdot (0.0001) \\cdot (0.99)^{18} \\approx 0.01585576\n$$\nNow, we sum these probabilities:\n$$\nP(X  3) \\approx 0.81790693 + 0.16523372 + 0.01585576 \\approx 0.99899641\n$$\nFinally, we calculate the $p$-value:\n$$\np\\text{-value} = 1 - P(X  3) \\approx 1 - 0.99899641 = 0.00100359\n$$\nThe problem requires this result to be rounded to four significant figures. The first significant figure is the $1$ in the thousandths place. The fourth significant figure is the $3$ in the millionths place. The next digit is $5$, so we round up.\n$p\\text{-value} \\approx 0.001004$.\nThis small $p$-value suggests that observing $3$ variant reads out of $20$ is highly unlikely if the cell were truly homozygous reference (given an error rate of $1\\%$), thus providing strong statistical evidence for the presence of the heterozygous SNV.", "answer": "$$\n\\boxed{0.001004}\n$$", "id": "5081884"}]}