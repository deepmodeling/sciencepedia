{"hands_on_practices": [{"introduction": "Building a Polygenic Risk Score (PRS) starts with a critical question: which of the millions of genetic variants should be included? This practice [@problem_id:4326863] walks you through the widely used \"clumping-and-thresholding\" ($P+T$) method, a core algorithm in applied genomics. By filtering variants based on their statistical significance from a Genome-Wide Association Study (GWAS) and then pruning for linkage disequilibrium, you will gain hands-on experience with the logic that transforms vast genomic data into a concise set of predictive markers.", "problem": "A core definition in polygenic risk modeling is that a polygenic risk score (PRS) for an individual is computed as the weighted sum of genotype dosages across selected single-nucleotide polymorphisms (SNPs), where weights are allelic effect sizes derived from genome-wide association studies (GWAS). Formally, for SNPs indexed by $j$ in a selected set $\\mathcal{J}$, the raw PRS is $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$, where $\\hat{\\beta}_{j}$ is the GWAS effect size (e.g., per-allele log-odds or standardised regression coefficient) and $G_{j}\\in\\{0,1,2\\}$ is the genotype dosage of the risk-increasing allele for the individual. In the widely used clumping-and-thresholding approach (often called $P+T$), SNP selection proceeds by (i) applying a $p$-value threshold to GWAS summary statistics, and then (ii) resolving local linkage disequilibrium (LD) by pruning so that retained SNPs have pairwise LD below a specified threshold, typically measured by the squared correlation $r^{2}$ between alleles at two loci.\n\nConsider a toy locus set of $10$ SNPs, labeled $s_{1},\\dots,s_{10}$. You are given the following GWAS $p$-values, allelic effect sizes $\\hat{\\beta}_{j}$, and the genotype dosages $G_{j}$ for a single individual:\n- $p$-values: $p_{1}=1.0\\times 10^{-8}$, $p_{2}=2.0\\times 10^{-7}$, $p_{3}=1.0\\times 10^{-5}$, $p_{4}=4.0\\times 10^{-6}$, $p_{5}=3.0\\times 10^{-5}$, $p_{6}=4.0\\times 10^{-7}$, $p_{7}=2.0\\times 10^{-6}$, $p_{8}=7.0\\times 10^{-6}$, $p_{9}=4.0\\times 10^{-9}$, $p_{10}=1.0\\times 10^{-4}$.\n- Effect sizes: $\\hat{\\beta}_{1}=0.12$, $\\hat{\\beta}_{2}=0.08$, $\\hat{\\beta}_{3}=-0.05$, $\\hat{\\beta}_{4}=0.04$, $\\hat{\\beta}_{5}=0.02$, $\\hat{\\beta}_{6}=0.09$, $\\hat{\\beta}_{7}=0.06$, $\\hat{\\beta}_{8}=-0.03$, $\\hat{\\beta}_{9}=0.11$, $\\hat{\\beta}_{10}=-0.01$.\n- Individual genotypes (dosages): $G_{1}=2$, $G_{2}=1$, $G_{3}=0$, $G_{4}=2$, $G_{5}=1$, $G_{6}=0$, $G_{7}=2$, $G_{8}=1$, $G_{9}=1$, $G_{10}=2$.\n\nPairwise LD is summarized by $r^{2}$ among unordered SNP pairs. The following pairs have non-default LD values:\n- Block $1$ LD: $r^{2}(s_{1},s_{2})=0.35$, $r^{2}(s_{1},s_{4})=0.12$, $r^{2}(s_{2},s_{4})=0.08$.\n- Block $2$ LD: $r^{2}(s_{6},s_{7})=0.15$, $r^{2}(s_{6},s_{8})=0.11$, $r^{2}(s_{7},s_{8})=0.09$.\n- Block $3$ LD: $r^{2}(s_{3},s_{5})=0.20$, $r^{2}(s_{3},s_{10})=0.05$, $r^{2}(s_{5},s_{10})=0.14$.\nFor every other unordered pair $(s_{i},s_{j})$ not listed above, take $r^{2}(s_{i},s_{j})=0.04$.\n\nUsing the $P+T$ procedure with a GWAS $p$-value threshold of $p5\\times 10^{-6}$ and LD pruning that retains only SNPs whose pairwise $r^{2}$ with already-selected SNPs is strictly less than $0.1$, construct the selected SNP set by the following explicit clumping rule: among SNPs passing the $p$-value threshold, order them by ascending $p$-value; traverse this ordered list, and when a SNP is selected, exclude any remaining SNP whose $r^{2}$ with the selected SNP is greater than or equal to $0.1$. Continue until the ordered list is exhausted. Then compute the resulting raw PRS $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$ for the given individual. Express the final PRS as a unitless number and round your answer to four significant figures.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **PRS Formula**: The raw polygenic risk score (PRS) is $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$, where $\\mathcal{J}$ is the set of selected single-nucleotide polymorphisms (SNPs), $\\hat{\\beta}_{j}$ is the effect size, and $G_{j}$ is the genotype dosage.\n- **SNPs**: A set of $10$ SNPs, indexed $j=1, \\dots, 10$.\n- **GWAS $p$-values**: $p_{1}=1.0\\times 10^{-8}$, $p_{2}=2.0\\times 10^{-7}$, $p_{3}=1.0\\times 10^{-5}$, $p_{4}=4.0\\times 10^{-6}$, $p_{5}=3.0\\times 10^{-5}$, $p_{6}=4.0\\times 10^{-7}$, $p_{7}=2.0\\times 10^{-6}$, $p_{8}=7.0\\times 10^{-6}$, $p_{9}=4.0\\times 10^{-9}$, $p_{10}=1.0\\times 10^{-4}$.\n- **Effect sizes ($\\hat{\\beta}_{j}$)**: $\\hat{\\beta}_{1}=0.12$, $\\hat{\\beta}_{2}=0.08$, $\\hat{\\beta}_{3}=-0.05$, $\\hat{\\beta}_{4}=0.04$, $\\hat{\\beta}_{5}=0.02$, $\\hat{\\beta}_{6}=0.09$, $\\hat{\\beta}_{7}=0.06$, $\\hat{\\beta}_{8}=-0.03$, $\\hat{\\beta}_{9}=0.11$, $\\hat{\\beta}_{10}=-0.01$.\n- **Individual Genotypes ($G_{j}$)**: $G_{1}=2$, $G_{2}=1$, $G_{3}=0$, $G_{4}=2$, $G_{5}=1$, $G_{6}=0$, $G_{7}=2$, $G_{8}=1$, $G_{9}=1$, $G_{10}=2$.\n- **Linkage Disequilibrium ($r^{2}$)**:\n  - $r^{2}(s_{1},s_{2})=0.35$\n  - $r^{2}(s_{1},s_{4})=0.12$\n  - $r^{2}(s_{2},s_{4})=0.08$\n  - $r^{2}(s_{6},s_{7})=0.15$\n  - $r^{2}(s_{6},s_{8})=0.11$\n  - $r^{2}(s_{7},s_{8})=0.09$\n  - $r^{2}(s_{3},s_{5})=0.20$\n  - $r^{2}(s_{3},s_{10})=0.05$\n  - $r^{2}(s_{5},s_{10})=0.14$\n  - All other pairwise $r^{2}$ values are $0.04$.\n- **$P+T$ Procedure Parameters**:\n  - $p$-value threshold: $p  5\\times 10^{-6}$.\n  - LD pruning threshold: $r^{2}  0.1$.\n- **Clumping Rule**: Filter SNPs by $p$-value threshold, order them by ascending $p$-value, then iterate: select an index SNP and prune any remaining SNPs for which $r^{2}$ with the index SNP is $\\ge 0.1$.\n- **Task**: Compute the raw PRS, $S$, and round to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing the standard clumping-and-thresholding ($P+T$) method for PRS construction, a cornerstone technique in statistical genetics. All definitions and parameters—$p$-values, effect sizes, genotype dosages ($G_j \\in \\{0, 1, 2\\}$), and linkage disequilibrium ($r^2$)—are standard and have plausible values. The problem is well-posed and self-contained; all necessary data and a deterministic, unambiguous algorithm for SNP selection are provided, ensuring a unique solution. The language is objective and precise. The problem does not violate any criteria for validity.\n\n### Step 3: Verdict and Action\nThe problem is valid and can be solved as stated.\n\n### Solution\nThe calculation of the polygenic risk score (PRS) proceeds in two main phases: first, the selection of the set of relevant SNPs, $\\mathcal{J}$, using the specified clumping-and-thresholding ($P+T$) procedure; and second, the computation of the weighted sum $S = \\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$.\n\n**Phase 1: SNP Selection using the $P+T$ Procedure**\n\nThe procedure involves a $p$-value thresholding step followed by a linkage disequilibrium (LD) pruning (or clumping) step.\n\n**Step (i): $p$-value Thresholding**\nWe first identify all SNPs with a GWAS $p$-value strictly less than the threshold of $5\\times 10^{-6}$. We examine each SNP:\n- $s_{1}: p_{1}=1.0\\times 10^{-8}  5\\times 10^{-6}$ (Pass)\n- $s_{2}: p_{2}=2.0\\times 10^{-7}  5\\times 10^{-6}$ (Pass)\n- $s_{3}: p_{3}=1.0\\times 10^{-5} \\ge 5\\times 10^{-6}$ (Fail)\n- $s_{4}: p_{4}=4.0\\times 10^{-6}  5\\times 10^{-6}$ (Pass)\n- $s_{5}: p_{5}=3.0\\times 10^{-5} \\ge 5\\times 10^{-6}$ (Fail)\n- $s_{6}: p_{6}=4.0\\times 10^{-7}  5\\times 10^{-6}$ (Pass)\n- $s_{7}: p_{7}=2.0\\times 10^{-6}  5\\times 10^{-6}$ (Pass)\n- $s_{8}: p_{8}=7.0\\times 10^{-6} \\ge 5\\times 10^{-6}$ (Fail)\n- $s_{9}: p_{9}=4.0\\times 10^{-9}  5\\times 10^{-6}$ (Pass)\n- $s_{10}: p_{10}=1.0\\times 10^{-4} \\ge 5\\times 10^{-6}$ (Fail)\n\nThe set of SNPs passing this filter, which we will call the candidate set $\\mathcal{C}$, is $\\mathcal{C} = \\{s_{1}, s_{2}, s_{4}, s_{6}, s_{7}, s_{9}\\}$.\n\n**Step (ii): LD Clumping**\nThe clumping algorithm requires ordering the SNPs in $\\mathcal{C}$ by their $p$-value in ascending order.\nThe $p$-values for the candidate SNPs are:\n- $p_{9} = 4.0\\times 10^{-9}$\n- $p_{1} = 1.0\\times 10^{-8}$\n- $p_{2} = 2.0\\times 10^{-7}$\n- $p_{6} = 4.0\\times 10^{-7}$\n- $p_{7} = 2.0\\times 10^{-6}$\n- $p_{4} = 4.0\\times 10^{-6}$\n\nThe ordered list of candidates to traverse is $(s_{9}, s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$. Let $\\mathcal{J}$ be the final set of selected SNPs, initialized as empty. The pruning rule is to discard any remaining candidate SNP $s_k$ if its LD with the current index SNP $s_i$ satisfies $r^{2}(s_i, s_k) \\ge 0.1$.\n\n**Iteration 1:**\n- Index SNP: $s_{9}$ (the most significant SNP). It is added to the selection set: $\\mathcal{J}=\\{s_{9}\\}$.\n- We check the remaining candidates $(s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$ for LD with $s_{9}$. Unless specified, the LD is $r^2=0.04$.\n  - $r^{2}(s_{9}, s_{1}) = 0.04  0.1$. $s_{1}$ is kept.\n  - $r^{2}(s_{9}, s_{2}) = 0.04  0.1$. $s_{2}$ is kept.\n  - $r^{2}(s_{9}, s_{6}) = 0.04  0.1$. $s_{6}$ is kept.\n  - $r^{2}(s_{9}, s_{7}) = 0.04  0.1$. $s_{7}$ is kept.\n  - $r^{2}(s_{9}, s_{4}) = 0.04  0.1$. $s_{4}$ is kept.\n- The list of remaining candidates is unchanged: $(s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$.\n\n**Iteration 2:**\n- Index SNP: $s_{1}$ (the next SNP in the ordered list). It is added to the selection set: $\\mathcal{J}=\\{s_{9}, s_{1}\\}$.\n- We check the remaining candidates $(s_{2}, s_{6}, s_{7}, s_{4})$ for LD with $s_{1}$.\n  - $r^{2}(s_{1}, s_{2}) = 0.35 \\ge 0.1$. $s_{2}$ is pruned from the list.\n  - $r^{2}(s_{1}, s_{6}) = 0.04  0.1$. $s_{6}$ is kept.\n  - $r^{2}(s_{1}, s_{7}) = 0.04  0.1$. $s_{7}$ is kept.\n  - $r^{2}(s_{1}, s_{4}) = 0.12 \\ge 0.1$. $s_{4}$ is pruned from the list.\n- The list of remaining candidates is now $(s_{6}, s_{7})$.\n\n**Iteration 3:**\n- Index SNP: $s_{6}$. It is added to the selection set: $\\mathcal{J}=\\{s_{9}, s_{1}, s_{6}\\}$.\n- We check the sole remaining candidate $(s_{7})$ for LD with $s_{6}$.\n  - $r^{2}(s_{6}, s_{7}) = 0.15 \\ge 0.1$. $s_{7}$ is pruned from the list.\n- The list of remaining candidates is now empty.\n\nThe algorithm terminates as the candidate list is exhausted. The final set of selected SNPs is $\\mathcal{J} = \\{s_{1}, s_{6}, s_{9}\\}$.\n\n**Phase 2: PRS Calculation**\n\nThe raw PRS, $S$, is calculated using the formula $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$ for the selected SNPs $\\mathcal{J}=\\{1, 6, 9\\}$.\n$$S = \\hat{\\beta}_{1}G_{1} + \\hat{\\beta}_{6}G_{6} + \\hat{\\beta}_{9}G_{9}$$\nWe substitute the given values for the effect sizes ($\\hat{\\beta}_{j}$) and genotype dosages ($G_{j}$) for these three SNPs:\n- For $j=1$: $\\hat{\\beta}_{1}=0.12$, $G_{1}=2$\n- For $j=6$: $\\hat{\\beta}_{6}=0.09$, $G_{6}=0$\n- For $j=9$: $\\hat{\\beta}_{9}=0.11$, $G_{9}=1$\n\nThe calculation is:\n$$S = (0.12 \\times 2) + (0.09 \\times 0) + (0.11 \\times 1)$$\n$$S = 0.24 + 0 + 0.11$$\n$$S = 0.35$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $0.35$ has two significant figures. To express this with four significant figures, we add trailing zeros.\n$$S = 0.3500$$", "answer": "$$\\boxed{0.3500}$$", "id": "4326863"}, {"introduction": "After selecting the relevant genetic markers, the next step is to calculate the score for an individual and understand its meaning. This exercise [@problem_id:4326881] focuses on the fundamental calculation of a raw Polygenic Risk Score ($S$) as a weighted sum of an individual's genetic data. You will then learn the critical process of standardizing this score against a reference population, transforming an abstract number into an interpretable measure of relative genetic liability.", "problem": "In a precision medicine clinic, a linear polygenic score is used to summarize common-variant liability for a complex trait under an additive genetic model. An individual has risk-allele dosages $x=(2,1,0,2,1)$ at $5$ independent single-nucleotide polymorphisms (SNPs), and the corresponding per-allele effect size estimates from an external genome-wide association study (GWAS) are $\\hat{\\beta}=(0.08,-0.05,0.12,0.02,0.09)$. Assume the usual additive model in which each locus contributes independently and additively to the log-risk on the liability scale, the risk-allele dosages are accurate counts per locus, and the $5$ loci have been linkage disequilibrium pruned in the discovery study so that weights can be combined linearly without double-counting correlated signals. Using the conventional definition of a linear polygenic score that aggregates locus-specific contributions via a weighted sum, construct the individual’s unstandardized score $S$ from these inputs. Then, using a reference population score distribution with mean $\\mu=0.15$ and standard deviation $\\sigma=0.10$, compute the individual’s standardized value $z$ relative to that reference. Round both reported values to four significant figures. Report your final answer as a row vector containing $S$ and $z$ in that order. No units are required.", "solution": "The user has asked for the calculation of an unstandardized and standardized polygenic score based on provided genetic data.\n\n### Step 1: Problem Validation\n\nFirst, the problem statement is validated against the required criteria.\n\n**Extracted Givens:**\n-   **Model:** A linear polygenic score based on an additive genetic model.\n-   **Risk-allele dosages vector:** $x = (2, 1, 0, 2, 1)$ for $5$ independent single-nucleotide polymorphisms (SNPs).\n-   **Per-allele effect size estimates vector:** $\\hat{\\beta} = (0.08, -0.05, 0.12, 0.02, 0.09)$.\n-   **Definition of unstandardized score ($S$):** A weighted sum of locus-specific contributions, which translates to the dot product of the dosage and effect size vectors.\n-   **Reference population parameters:** Mean score $\\mu = 0.15$ and standard deviation $\\sigma = 0.10$.\n-   **Task:**\n    1.  Calculate the unstandardized score $S$.\n    2.  Calculate the standardized score $z$.\n    3.  Round both values to four significant figures.\n    4.  Report the results as a row vector $[S, z]$.\n\n**Validation Verdict:**\nThe problem is deemed **valid**.\n-   **Scientifically Grounded:** The described methodology for calculating a polygenic score is standard practice in statistical genetics and precision medicine. The additive model, use of effect sizes from genome-wide association studies (GWAS), and standardization are all well-established concepts.\n-   **Well-Posed:** All necessary data and definitions are provided for a unique solution. The vectors $x$ and $\\hat{\\beta}$ have consistent dimensions.\n-   **Objective:** The problem is stated using precise, quantitative language, free of ambiguity or subjective claims.\n-   The problem does not violate any other criteria for invalidity (e.g., it is not incomplete, contradictory, unrealistic, or trivial).\n\nThe solution process can proceed.\n\n### Step 2: Calculation of the Unstandardized Polygenic Score ($S$)\n\nThe problem defines the unstandardized polygenic score, $S$, as a weighted sum of the risk-allele dosages, where the weights are the corresponding per-allele effect sizes. This can be expressed as the dot product of the dosage vector $x$ and the effect size vector $\\hat{\\beta}$. For $n$ SNPs, the formula is:\n$$S = \\sum_{i=1}^{n} x_i \\hat{\\beta}_i = x \\cdot \\hat{\\beta}$$\nIn this case, we have $n=5$ SNPs. The given vectors are:\n$$x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\\\ x_5 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}$$\n$$\\hat{\\beta} = \\begin{pmatrix} \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\\\ \\hat{\\beta}_3 \\\\ \\hat{\\beta}_4 \\\\ \\hat{\\beta}_5 \\end{pmatrix} = \\begin{pmatrix} 0.08 \\\\ -0.05 \\\\ 0.12 \\\\ 0.02 \\\\ 0.09 \\end{pmatrix}$$\nThe calculation is as follows:\n$$S = (x_1 \\times \\hat{\\beta}_1) + (x_2 \\times \\hat{\\beta}_2) + (x_3 \\times \\hat{\\beta}_3) + (x_4 \\times \\hat{\\beta}_4) + (x_5 \\times \\hat{\\beta}_5)$$\n$$S = (2 \\times 0.08) + (1 \\times -0.05) + (0 \\times 0.12) + (2 \\times 0.02) + (1 \\times 0.09)$$\n$$S = 0.16 - 0.05 + 0 + 0.04 + 0.09$$\n$$S = 0.11 + 0.04 + 0.09$$\n$$S = 0.24$$\nThe problem requires this value to be rounded to four significant figures. The value $0.24$ has two significant figures. To express it with four, we add trailing zeros:\n$$S = 0.2400$$\n\n### Step 3: Calculation of the Standardized Polygenic Score ($z$)\n\nThe standardized score, or $z$-score, measures how many standard deviations an individual's score is from the mean of a reference population. The formula is:\n$$z = \\frac{S - \\mu}{\\sigma}$$\nUsing the calculated unstandardized score $S = 0.24$ and the given reference population parameters $\\mu = 0.15$ and $\\sigma = 0.10$:\n$$z = \\frac{0.24 - 0.15}{0.10}$$\n$$z = \\frac{0.09}{0.10}$$\n$$z = 0.9$$\nThe problem requires this value to also be rounded to four significant figures. The value $0.9$ has one significant figure. To express it with four, we add trailing zeros:\n$$z = 0.9000$$\n\n### Step 4: Final Answer Formulation\n\nThe final answer is to be reported as a row vector containing the rounded values of $S$ and $z$ in that order.\nThe required vector is $(S, z)$, which is $(0.2400, 0.9000)$. This is represented using the `pmatrix` environment in LaTeX.", "answer": "$$\\boxed{\\begin{pmatrix} 0.2400  0.9000 \\end{pmatrix}}$$", "id": "4326881"}, {"introduction": "A calculated risk score is only valuable if it accurately separates individuals who are likely to develop a disease from those who are not. This problem [@problem_id:5072377] explores how we quantify this \"clinical utility\" using the Area Under the Receiver Operating Characteristic curve (AUC), a gold-standard metric for predictive models. By deriving the AUC from the statistical distributions of scores in cases and controls, you will grasp the theoretical foundation for evaluating and comparing the performance of different Polygenic Risk Scores.", "problem": "A common approach to evaluate the clinical utility of Polygenic Risk Scores (PRS) is to study how well the PRS separates cases from controls under plausible distributional assumptions. Consider a disease for which the PRS in cases is modeled as a normal distribution with mean $\\mu_{1}$ and variance $\\sigma^{2}$, denoted $N(\\mu_{1},\\sigma^{2})$, and the PRS in controls is modeled as a normal distribution with mean $\\mu_{0}$ and variance $\\sigma^{2}$, denoted $N(\\mu_{0},\\sigma^{2})$. Assume independence between case and control PRS values. A threshold-based classifier declares an individual a case if their PRS $x$ exceeds a threshold $c$.\n\nUsing the foundational definitions of the Receiver Operating Characteristic (ROC) curve (True Positive Rate versus False Positive Rate across all thresholds) and Area Under the Curve (AUC), and the well-tested properties of the normal distribution and its cumulative distribution function, perform the following:\n\n1. Derive the ROC curve by eliminating the threshold $c$ to express the True Positive Rate as a function of the False Positive Rate.\n2. Derive a closed-form analytic expression for the Area Under the Curve in terms of $\\mu_{1}$, $\\mu_{0}$, and $\\sigma$.\n\nProvide the final answer as the closed-form expression for the Area Under the Curve. No numerical evaluation is required.", "solution": "The problem is valid. It is scientifically grounded in standard statistical and biostatistical theory, well-posed with all necessary information provided, and stated objectively. The premises—modeling Polygenic Risk Scores (PRS) with normal distributions and evaluating them with ROC analysis—are common and accepted practices in medical genetics. The problem is a standard derivation in signal detection theory and presents a formalizable challenge with a unique, meaningful solution.\n\nThe solution proceeds in two parts as requested: first, deriving the Receiver Operating Characteristic (ROC) curve, and second, deriving the closed-form expression for the Area Under the Curve (AUC).\n\nLet $X_1$ be the random variable representing the PRS for a case, and $X_0$ be the random variable for a control. The problem states their distributions are:\n$$X_1 \\sim N(\\mu_1, \\sigma^2)$$\n$$X_0 \\sim N(\\mu_0, \\sigma^2)$$\nAn individual is classified as a case if their PRS, denoted by $x$, exceeds a certain threshold $c$.\n\nThe two key metrics for the ROC curve are the True Positive Rate (TPR) and the False Positive Rate (FPR).\n\nThe True Positive Rate (TPR), or sensitivity, is the probability that a case is correctly classified as a case.\n$$ \\text{TPR}(c) = P(X_1  c) $$\nThe False Positive Rate (FPR) is the probability that a control is incorrectly classified as a case.\n$$ \\text{FPR}(c) = P(X_0  c) $$\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, $N(0, 1)$. The probability $P(X  a)$ for a normally distributed random variable $X \\sim N(\\mu, \\sigma^2)$ can be written as $1 - P(X \\le a) = 1 - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)$.\n\nUsing this property, we can express TPR and FPR as functions of the threshold $c$:\n$$ \\text{TPR}(c) = 1 - \\Phi\\left(\\frac{c - \\mu_1}{\\sigma}\\right) $$\n$$ \\text{FPR}(c) = 1 - \\Phi\\left(\\frac{c - \\mu_0}{\\sigma}\\right) $$\nThe ROC curve is a plot of TPR versus FPR for all possible values of the threshold $c$. To obtain an expression for the ROC curve, we must express TPR as a function of FPR by eliminating $c$.\n\n**Part 1: Derivation of the ROC Curve**\n\nFirst, we solve the equation for FPR to express $c$ in terms of FPR.\n$$ \\text{FPR} = 1 - \\Phi\\left(\\frac{c - \\mu_0}{\\sigma}\\right) $$\n$$ 1 - \\text{FPR} = \\Phi\\left(\\frac{c - \\mu_0}{\\sigma}\\right) $$\nLet $\\Phi^{-1}$ denote the inverse CDF of the standard normal distribution (the quantile function or probit function). Applying $\\Phi^{-1}$ to both sides:\n$$ \\Phi^{-1}(1 - \\text{FPR}) = \\frac{c - \\mu_0}{\\sigma} $$\nUsing the symmetry property of the standard normal distribution, $\\Phi^{-1}(1-p) = -\\Phi^{-1}(p)$, we have:\n$$ -\\Phi^{-1}(\\text{FPR}) = \\frac{c - \\mu_0}{\\sigma} $$\nSolving for $c$:\n$$ c = \\mu_0 - \\sigma \\Phi^{-1}(\\text{FPR}) $$\nNow, we substitute this expression for $c$ into the equation for TPR:\n$$ \\text{TPR} = 1 - \\Phi\\left(\\frac{(\\mu_0 - \\sigma \\Phi^{-1}(\\text{FPR})) - \\mu_1}{\\sigma}\\right) $$\n$$ \\text{TPR} = 1 - \\Phi\\left(\\frac{\\mu_0 - \\mu_1}{\\sigma} - \\frac{\\sigma \\Phi^{-1}(\\text{FPR})}{\\sigma}\\right) $$\n$$ \\text{TPR} = 1 - \\Phi\\left(\\frac{\\mu_0 - \\mu_1}{\\sigma} - \\Phi^{-1}(\\text{FPR})\\right) $$\nUsing the symmetry property of the CDF, $1 - \\Phi(z) = \\Phi(-z)$:\n$$ \\text{TPR} = \\Phi\\left(-\\left(\\frac{\\mu_0 - \\mu_1}{\\sigma} - \\Phi^{-1}(\\text{FPR})\\right)\\right) $$\n$$ \\text{TPR} = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma} + \\Phi^{-1}(\\text{FPR})\\right) $$\nThis equation expresses the TPR as a function of the FPR, defining the ROC curve.\n\n**Part 2: Derivation of the Area Under the Curve (AUC)**\n\nThe AUC is the integral of the ROC curve from $\\text{FPR} = 0$ to $\\text{FPR} = 1$:\n$$ \\text{AUC} = \\int_0^1 \\text{TPR}(\\text{FPR}) \\, d(\\text{FPR}) $$\nA more direct and insightful method to calculate the AUC in this context is to use its probabilistic interpretation. The AUC is equal to the probability that a randomly selected case will have a higher risk score than a randomly selected control.\n$$ \\text{AUC} = P(X_1  X_0) $$\nThis can be rewritten as:\n$$ \\text{AUC} = P(X_1 - X_0  0) $$\nLet's define a new random variable $Y = X_1 - X_0$. Since $X_1$ and $X_0$ are independent random variables with normal distributions, their difference $Y$ is also normally distributed.\nThe mean of $Y$ is the difference of the means:\n$$ E[Y] = E[X_1 - X_0] = E[X_1] - E[X_0] = \\mu_1 - \\mu_0 $$\nThe variance of $Y$ is the sum of the variances (due to independence):\n$$ \\text{Var}(Y) = \\text{Var}(X_1 - X_0) = \\text{Var}(X_1) + \\text{Var}(-X_0) = \\text{Var}(X_1) + (-1)^2 \\text{Var}(X_0) = \\sigma^2 + \\sigma^2 = 2\\sigma^2 $$\nSo, the distribution of $Y$ is:\n$$ Y \\sim N(\\mu_1 - \\mu_0, 2\\sigma^2) $$\nThe standard deviation of $Y$ is $\\sigma_Y = \\sqrt{2\\sigma^2} = \\sigma\\sqrt{2}$.\n\nNow we can calculate the probability $P(Y  0)$. We standardize the variable $Y$ by subtracting its mean and dividing by its standard deviation to obtain a standard normal variable $Z$:\n$$ P(Y  0) = P\\left(\\frac{Y - E[Y]}{\\sigma_Y}  \\frac{0 - E[Y]}{\\sigma_Y}\\right) $$\n$$ P(Y  0) = P\\left(Z  \\frac{0 - (\\mu_1 - \\mu_0)}{\\sigma\\sqrt{2}}\\right) $$\n$$ P(Y  0) = P\\left(Z  -\\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right) $$\nUsing the symmetry of the standard normal distribution, $P(Z  -z) = P(Z  z)$, we get:\n$$ P(Y  0) = P\\left(Z  \\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right) $$\nBy definition, this probability is the value of the standard normal CDF, $\\Phi$, evaluated at this point.\n$$ \\text{AUC} = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right) $$\nThis is the closed-form analytic expression for the Area Under the Curve in terms of the given parameters $\\mu_1$, $\\mu_0$, and $\\sigma$.", "answer": "$$\\boxed{\\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right)}$$", "id": "5072377"}]}