{"hands_on_practices": [{"introduction": "The first step toward addressing health disparities is to measure them accurately. This exercise introduces several fundamental metrics used in epidemiology and public health to quantify the gap in outcomes or access between different groups. By calculating the absolute risk difference, relative risk, and standardized mean difference for access to germline testing, you will learn how different quantitative measures can provide unique insights into the magnitude of an equity problem. [@problem_id:5027556]", "problem": "In a community-based implementation study of germline testing for hereditary cancer genes, investigators assess access disparities between two income-defined groups of equal population size. Let the binary access indicator be $A \\in \\{0,1\\}$, where $A=1$ denotes that an individual obtained germline testing within a defined observation window. The observed uptake probabilities are $p_{H} = 0.70$ in the high-income group and $p_{L} = 0.30$ in the low-income group. Using definitions grounded in probability and variance for binary variables, compute the following measures of disparity in access:\n- Absolute risk difference (difference in probabilities) between the high-income and low-income groups.\n- Relative Risk (RR) as the ratio of access probabilities in the high-income to the low-income group.\n- Standardized Mean Difference (SMD) for $A$ across the two groups, where the standardization uses the pooled standard deviation appropriate for a binary variable and equal group sizes.\n\nRound each quantity to four significant figures. Report each as a pure number (no units, no percent sign) and give your final answer as a $1 \\times 3$ row matrix in the order $(\\text{absolute risk difference}, \\text{RR}, \\text{SMD})$.", "solution": "The problem statement is evaluated for validity before attempting a solution.\n\n**Step 1: Extract Givens**\n- Two income-defined groups of equal population size.\n- A binary access indicator $A \\in \\{0, 1\\}$, where $A=1$ indicates access to germline testing.\n- The probability of access in the high-income group is $p_{H} = 0.70$.\n- The probability of access in the low-income group is $p_{L} = 0.30$.\n- The required outputs are three measures of disparity:\n    1. Absolute risk difference (difference in probabilities).\n    2. Relative Risk (RR) as the ratio of probabilities.\n    3. Standardized Mean Difference (SMD) using the pooled standard deviation for a binary variable with equal group sizes.\n- Each output must be rounded to four significant figures.\n- The final answer must be a $1 \\times 3$ row matrix in the order $(\\text{absolute risk difference}, \\text{RR}, \\text{SMD})$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses standard, well-defined concepts from epidemiology and biostatistics (risk difference, relative risk, standardized mean difference) in a realistic public health research context (genomic medicine access disparities). The framework is based on established statistical principles.\n- **Well-Posed:** All necessary data ($p_H$, $p_L$) and conditions (equal group sizes) are provided. The definitions for the quantities to be calculated are explicit and unambiguous. The problem is structured to yield a unique, stable solution.\n- **Objective:** The problem statement is expressed in precise, quantitative, and unbiased language.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It is therefore deemed **valid**. A solution will be provided.\n\nThe problem requires the calculation of three distinct measures of disparity in access to germline testing between a high-income group (H) and a low-income group (L). The access is a binary event, so the variable $A$ follows a Bernoulli distribution for each group.\n\nThe given probabilities are:\n$p_{H} = 0.70$ (probability of access in the high-income group)\n$p_{L} = 0.30$ (probability of access in the low-income group)\n\n1.  **Absolute Risk Difference (ARD)**\n    The absolute risk difference is the simple arithmetic difference between the two probabilities.\n    $$ARD = p_{H} - p_{L}$$\n    Substituting the given values:\n    $$ARD = 0.70 - 0.30 = 0.40$$\n    Rounding to four significant figures, we get $0.4000$.\n\n2.  **Relative Risk (RR)**\n    The relative risk is the ratio of the probability of the outcome in the exposed group (here, high-income) to the probability in the unexposed group (low-income).\n    $$RR = \\frac{p_{H}}{p_{L}}$$\n    Substituting the given values:\n    $$RR = \\frac{0.70}{0.30} = \\frac{7}{3} \\approx 2.3333...$$\n    Rounding to four significant figures, we get $2.333$.\n\n3.  **Standardized Mean Difference (SMD)**\n    The SMD, often denoted as Cohen's $d$, is the difference in means between two groups, divided by a pooled standard deviation. For a binary variable $A$ with success probability $p$, its mean is $\\mu = p$ and its variance is $\\sigma^2 = p(1-p)$.\n    The means for the two groups are:\n    $\\mu_{H} = p_{H} = 0.70$\n    $\\mu_{L} = p_{L} = 0.30$\n    The difference in means is $\\mu_{H} - \\mu_{L} = p_{H} - p_{L} = 0.40$.\n\n    The variances for the two groups are:\n    $\\sigma_{H}^2 = p_{H}(1 - p_{H}) = 0.70(1 - 0.70) = 0.70 \\times 0.30 = 0.21$\n    $\\sigma_{L}^2 = p_{L}(1 - p_{L}) = 0.30(1 - 0.30) = 0.30 \\times 0.70 = 0.21$\n\n    The problem specifies using the pooled standard deviation for equal group sizes ($n_H = n_L$). The formula for the pooled variance is the average of the individual group variances:\n    $$\\sigma_{pooled}^2 = \\frac{\\sigma_{H}^2 + \\sigma_{L}^2}{2}$$\n    The pooled standard deviation is the square root of this value:\n    $$\\sigma_{pooled} = \\sqrt{\\frac{\\sigma_{H}^2 + \\sigma_{L}^2}{2}}$$\n    Substituting the calculated variances:\n    $$\\sigma_{pooled} = \\sqrt{\\frac{0.21 + 0.21}{2}} = \\sqrt{\\frac{0.42}{2}} = \\sqrt{0.21}$$\n    Now, we compute the SMD:\n    $$SMD = \\frac{\\mu_{H} - \\mu_{L}}{\\sigma_{pooled}} = \\frac{p_{H} - p_{L}}{\\sigma_{pooled}}$$\n    Substituting the values:\n    $$SMD = \\frac{0.40}{\\sqrt{0.21}}$$\n    Calculating the numerical value:\n    $$SMD \\approx \\frac{0.40}{0.458257569...} \\approx 0.87287156...$$\n    Rounding to four significant figures, we get $0.8729$.\n\nThe three requested measures, rounded to four significant figures, are:\n- Absolute risk difference = $0.4000$\n- Relative Risk = $2.333$\n- Standardized Mean Difference = $0.8729$\nThese are to be presented in a $1 \\times 3$ row matrix.", "answer": "$$\\boxed{\\begin{pmatrix} 0.4000 & 2.333 & 0.8729 \\end{pmatrix}}$$", "id": "5027556"}, {"introduction": "Disparities in access to healthcare services often translate into participation bias in large-scale research studies like biobanks. When some populations are underrepresented, naive statistical analyses can lead to skewed and inaccurate conclusions about human genetics. This practice challenges you to apply a powerful statistical technique, inverse probability weighting, to correct for such biases and derive an unbiased estimate of an allele frequency from stratified data. [@problem_id:5027498]", "problem": "A hospital system operates a biobank and seeks to estimate the minor allele frequency of a single nucleotide polymorphism (SNP) in its catchment-area population while addressing equitable access issues and participation bias across demographic strata. The population is partitioned into three strata by self-identified ancestry. Due to unequal participation driven by access barriers, each stratum has a different participation rate in the biobank. The biobank has genotype data for enrolled participants. The goal is to estimate the overall population minor allele frequency in a way that is unbiased with respect to these unequal participation rates.\n\nUse only core definitions and well-tested principles: the definition of allele frequency as the total minor allele count divided by twice the number of individuals, and the principle from unequal-probability sampling that unbiased population totals can be constructed using inverse inclusion probabilities. Do not assume any shortcut formulas beyond these foundations.\n\nData:\n- Population sizes by stratum:\n  - Stratum 1: $N_{1} = 120000$\n  - Stratum 2: $N_{2} = 80000$\n  - Stratum 3: $N_{3} = 100000$\n- Biobank participants by stratum:\n  - Stratum 1: $n_{1} = 3000$\n  - Stratum 2: $n_{2} = 800$\n  - Stratum 3: $n_{3} = 1200$\n- Among biobank participants, genotype counts for the SNP (minor allele $a$) by stratum:\n  - Stratum 1: $\\text{AA} = 2100$, $\\text{Aa} = 780$, $\\text{aa} = 120$\n  - Stratum 2: $\\text{AA} = 480$, $\\text{Aa} = 280$, $\\text{aa} = 40$\n  - Stratum 3: $\\text{AA} = 780$, $\\text{Aa} = 360$, $\\text{aa} = 60$\n\nTasks:\n1. Compute the participation rate in each stratum (the per-person probability of participation) from the counts provided.\n2. From first principles, derive the unbiased estimator for the overall population minor allele frequency of this SNP under unequal participation probabilities, using inverse-probability weighting grounded in the core definition of allele frequency and unbiased estimation of population totals.\n3. Compute the final numerical estimate of the unbiased overall population minor allele frequency using the provided data.\n\nExpress the final minor allele frequency as a decimal fraction. Round your final answer to four significant figures.", "solution": "The problem requires the estimation of the overall population minor allele frequency (MAF) from stratified biobank data where participation rates differ across strata. The solution must be derived from first principles, specifically using the definition of allele frequency and inverse probability weighting to correct for participation bias.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\nThe problem provides the following data:\n- Population sizes by stratum:\n  - Stratum 1: $N_{1} = 120000$\n  - Stratum 2: $N_{2} = 80000$\n  - Stratum 3: $N_{3} = 100000$\n- Biobank participants (sample sizes) by stratum:\n  - Stratum 1: $n_{1} = 3000$\n  - Stratum 2: $n_{2} = 800$\n  - Stratum 3: $n_{3} = 1200$\n- Genotype counts for minor allele '$a$' among participants:\n  - Stratum 1: count(AA) = $2100$, count(Aa) = $780$, count(aa) = $120$\n  - Stratum 2: count(AA) = $480$, count(Aa) = $280$, count(aa) = $40$\n  - Stratum 3: count(AA) = $780$, count(Aa) = $360$, count(aa) = $60$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-posed and scientifically grounded.\n- **Scientific Grounding**: The concepts of minor allele frequency, stratified sampling, and inverse probability weighting (Horvitz-Thompson estimation) are standard in population genetics and statistics. The scenario of biased participation in biobanks reflects real-world challenges in genomic medicine research.\n- **Well-Posed**: All necessary data for the calculation are provided. The genotype counts in each stratum sum to the respective sample size:\n  - Stratum 1: $2100 + 780 + 120 = 3000 = n_1$\n  - Stratum 2: $480 + 280 + 40 = 800 = n_2$\n  - Stratum 3: $780 + 360 + 60 = 1200 = n_3$\n  The data is internally consistent. The tasks are clearly defined and lead to a unique solution.\n- **Objectivity**: The problem is stated in precise, objective language without subjective elements.\n- **Unrealistic/Infeasible Check**: The population and sample sizes are realistic for a large hospital system. The allele frequencies are within plausible ranges.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with the solution.\n\n### Solution Derivation and Calculation\n\nThe overall population minor allele frequency, $p$, is defined as the total number of minor alleles in the entire population divided by the total number of available allele slots (twice the total population size). Let $N_{\\text{total}}$ be the total population size, and $C_{a, \\text{total}}$ be the total count of the minor allele '$a$' in that population.\n$$p = \\frac{C_{a, \\text{total}}}{2 N_{\\text{total}}}$$\nThe total population size is known: $N_{\\text{total}} = N_1 + N_2 + N_3$. The primary task is to find an unbiased estimator for $C_{a, \\text{total}}$.\n\nThe total population allele count is the sum of the counts in each stratum: $C_{a, \\text{total}} = \\sum_{i=1}^3 C_{a,i}$, where $C_{a,i}$ is the true (unknown) count of allele '$a$' in the entire population of stratum $i$.\n\n#### Task 1: Compute participation rates\nThe participation rate for an individual in stratum $i$, denoted $\\pi_i$, is the probability of being included in the biobank sample. Assuming simple random sampling within each stratum, this rate is the ratio of the sample size to the population size for that stratum.\n- Stratum 1: $\\pi_1 = \\frac{n_1}{N_1} = \\frac{3000}{120000} = \\frac{1}{40} = 0.025$\n- Stratum 2: $\\pi_2 = \\frac{n_2}{N_2} = \\frac{800}{80000} = \\frac{1}{100} = 0.01$\n- Stratum 3: $\\pi_3 = \\frac{n_3}{N_3} = \\frac{1200}{100000} = \\frac{12}{1000} = 0.012$\nThe participation rates are unequal, confirming the need for adjustment.\n\n#### Task 2: Derive the unbiased estimator\nTo estimate the total minor allele count in the population, $C_{a, \\text{total}}$, we first estimate the total for each stratum, $C_{a,i}$, and then sum the estimates. The principle of inverse probability weighting (as used in the Horvitz-Thompson estimator) states that an unbiased estimate of a population total can be obtained by summing the values from the sample, where each sampled unit is weighted by the inverse of its inclusion probability.\n\nLet $c_{a,i}$ be the observed count of the minor allele '$a$' in the sample from stratum $i$. The individuals in the sample from stratum $i$ are a subset of the $N_i$ individuals in the stratum population. The quantity $c_{a,i}$ is the sum of minor alleles over the $n_i$ individuals in the sample. To estimate the total number of minor alleles in the entire stratum $i$, $C_{a,i}$, we scale up the sample count $c_{a,i}$ by the inverse of the sampling rate, $1/\\pi_i$.\nThe unbiased estimator for the total minor allele count in stratum $i$ is:\n$$\\hat{C}_{a,i} = \\frac{1}{\\pi_i} c_{a,i} = \\frac{1}{n_i / N_i} c_{a,i} = N_i \\frac{c_{a,i}}{n_i}$$\nThis estimator effectively calculates the average number of minor alleles per individual in the sample ($\\frac{c_{a,i}}{n_i}$) and extrapolates this to the full stratum population size $N_i$.\n\nThe unbiased estimator for the total minor allele count in the entire population, $\\hat{C}_{a, \\text{total}}$, is the sum of the stratum-specific estimates:\n$$\\hat{C}_{a, \\text{total}} = \\sum_{i=1}^{3} \\hat{C}_{a,i} = \\sum_{i=1}^{3} N_i \\frac{c_{a,i}}{n_i}$$\nFinally, the unbiased estimator for the overall population minor allele frequency, $\\hat{p}$, is obtained by substituting $\\hat{C}_{a, \\text{total}}$ into the definition of $p$:\n$$\\hat{p} = \\frac{\\hat{C}_{a, \\text{total}}}{2 N_{\\text{total}}} = \\frac{\\sum_{i=1}^{3} N_i \\frac{c_{a,i}}{n_i}}{2 \\sum_{i=1}^{3} N_i}$$\nThis is the derived estimator required.\n\n#### Task 3: Compute the numerical estimate\nFirst, we calculate the observed minor allele counts, $c_{a,i}$, from the genotype data for each sample stratum. The count is $1$ for each heterozygote (Aa) and $2$ for each minor allele homozygote (aa).\n- Stratum 1: $c_{a,1} = (1 \\times 780) + (2 \\times 120) = 780 + 240 = 1020$\n- Stratum 2: $c_{a,2} = (1 \\times 280) + (2 \\times 40) = 280 + 80 = 360$\n- Stratum 3: $c_{a,3} = (1 \\times 360) + (2 \\times 60) = 360 + 120 = 480$\n\nNext, we calculate the total population size:\n$$N_{\\text{total}} = N_1 + N_2 + N_3 = 120000 + 80000 + 100000 = 300000$$\nThe total number of allele slots in the population is $2 N_{\\text{total}} = 600000$.\n\nNow, we compute the estimated total minor allele count, $\\hat{C}_{a, \\text{total}}$:\n\\begin{align*} \\hat{C}_{a, \\text{total}} &= \\sum_{i=1}^{3} N_i \\frac{c_{a,i}}{n_i} \\\\ &= N_1 \\frac{c_{a,1}}{n_1} + N_2 \\frac{c_{a,2}}{n_2} + N_3 \\frac{c_{a,3}}{n_3} \\\\ &= 120000 \\times \\frac{1020}{3000} + 80000 \\times \\frac{360}{800} + 100000 \\times \\frac{480}{1200} \\\\ &= 40 \\times 1020 + 100 \\times 360 + \\frac{1000}{12} \\times 480 \\\\ &= 40800 + 36000 + 40000 \\\\ &= 116800 \\end{align*}\nThis is the unbiased estimate for the total number of minor alleles in the entire catchment-area population.\n\nFinally, we compute the estimated population minor allele frequency, $\\hat{p}$:\n$$\\hat{p} = \\frac{\\hat{C}_{a, \\text{total}}}{2 N_{\\text{total}}} = \\frac{116800}{2 \\times 300000} = \\frac{116800}{600000} = \\frac{1168}{6000} = \\frac{73}{375}$$\nAs a decimal fraction, this is:\n$$\\hat{p} = 0.194666...$$\nRounding to four significant figures, the final estimate is $0.1947$.", "answer": "$$\\boxed{0.1947}$$", "id": "5027498"}, {"introduction": "The consequences of biased genomic databases extend directly to the clinic, affecting the certainty of diagnostic test results. Due to a higher prevalence of Variants of Uncertain Significance (VUS) in underrepresented populations, the performance of a genetic test can differ across ancestries. This exercise uses the fundamental principles of Bayes’ theorem to demonstrate how a \"positive\" test result for a pathogenic variant can confer a much lower posterior probability of disease in an individual from an underrepresented group, highlighting a critical inequity in the clinical application of genomic medicine. [@problem_id:5027562]", "problem": "A clinical gene panel is used to detect a pathogenic variant associated with a monogenic disorder. The panel outputs a binary call: “pathogenic-variant-positive” if the variant is classified as pathogenic by the laboratory pipeline, and “pathogenic-variant-negative” otherwise. Due to differences in representation within variant databases, individuals from an underrepresented ancestry experience a higher prevalence of Variant of Uncertain Significance (VUS), which affects both the probability that true pathogenic variants are correctly labeled and the probability that benign variants are incorrectly labeled. Assume the following are scientifically established base definitions and observations:\n\n- Sensitivity is defined as $P(+ \\mid D)$, the probability of a positive test given the disease.\n- Specificity is defined as $P(- \\mid \\neg D)$, the probability of a negative test given no disease.\n- Pretest risk is $P(D)$, the prior probability of disease before testing.\n- The law of total probability and Bayes’ theorem relate $P(D \\mid +)$ to $P(+ \\mid D)$, $P(+ \\mid \\neg D)$, and $P(D)$.\n\nConsider two ancestry groups who present with identical clinical features and family history, yielding the same pretest risk $P(D) = 0.05$. However, test performance differs across groups:\n\n- Group A (well represented in databases): sensitivity $0.94$, specificity $0.99$.\n- Group B (underrepresented in databases with more VUS): sensitivity $0.85$, specificity $0.97$.\n\nUsing only the core definitions above and first principles, compute the posterior probability of disease $P(D \\mid +)$ for each group when the panel returns a pathogenic-variant-positive result. Express both answers as decimal fractions, in the order Group A then Group B, and round each to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on fundamental principles of probability theory, specifically Bayes' theorem, applied to a realistic scenario in medical genetics concerning diagnostic test performance and health disparities. All necessary parameters are provided, and the objective is clearly defined. Therefore, the problem is deemed valid and a solution will be furnished.\n\nThe objective is to compute the posterior probability of disease given a positive test result, denoted as $P(D \\mid +)$, for two distinct groups, A and B. We are given the pretest probability of disease, $P(D)$, and the test's sensitivity and specificity for each group. Let $D$ represent the event that an individual has the disease (i.e., carries the true pathogenic variant) and $\\neg D$ be the complementary event of not having the disease. Let $+$ be the event of a positive test result and $-$ be the event of a negative result.\n\nThe core relationship required for this computation is Bayes' theorem:\n$$ P(D \\mid +) = \\frac{P(+ \\mid D) P(D)}{P(+)} $$\nThe term in the numerator, $P(+ \\mid D)$, is the sensitivity of the test, which is provided for each group. The term $P(D)$ is the pretest probability, or prevalence, also given. The denominator, $P(+)$, is the total probability of receiving a positive test result. It can be calculated using the law of total probability, by summing over the mutually exclusive states of having the disease or not:\n$$ P(+) = P(+ \\mid D) P(D) + P(+ \\mid \\neg D) P(\\neg D) $$\nWe are given the specificity, which is $P(- \\mid \\neg D)$. The term $P(+ \\mid \\neg D)$ represents the false positive rate, which is the probability of a positive test in an individual without the disease. Since a test result on an individual without disease must be either positive or negative, we have the relation:\n$$ P(+ \\mid \\neg D) + P(- \\mid \\neg D) = 1 $$\nTherefore, the false positive rate can be calculated as:\n$$ P(+ \\mid \\neg D) = 1 - P(- \\mid \\neg D) = 1 - \\text{specificity} $$\nThe probability of not having the disease, $P(\\neg D)$, is simply:\n$$ P(\\neg D) = 1 - P(D) $$\nFor both groups, the pretest risk is given as $P(D) = 0.05$. Thus, for both groups, $P(\\neg D) = 1 - 0.05 = 0.95$.\n\nWe will now compute the posterior probability for each group separately.\n\n**For Group A (well-represented):**\nThe given parameters are:\n-   Sensitivity: $P_A(+ \\mid D) = 0.94$\n-   Specificity: $P_A(- \\mid \\neg D) = 0.99$\n-   Pretest risk: $P(D) = 0.05$\n\nFirst, we calculate the false positive rate for Group A:\n$$ P_A(+ \\mid \\neg D) = 1 - P_A(- \\mid \\neg D) = 1 - 0.99 = 0.01 $$\nNext, we calculate the total probability of a positive test, $P_A(+)$:\n$$ P_A(+) = P_A(+ \\mid D) P(D) + P_A(+ \\mid \\neg D) P(\\neg D) $$\n$$ P_A(+) = (0.94)(0.05) + (0.01)(0.95) $$\n$$ P_A(+) = 0.047 + 0.0095 = 0.0565 $$\nNow, we apply Bayes' theorem to find the posterior probability $P_A(D \\mid +)$:\n$$ P_A(D \\mid +) = \\frac{P_A(+ \\mid D) P(D)}{P_A(+)} = \\frac{(0.94)(0.05)}{0.0565} = \\frac{0.047}{0.0565} \\approx 0.8318584... $$\nRounding to four significant figures, the posterior probability for an individual in Group A is $0.8319$.\n\n**For Group B (underrepresented):**\nThe given parameters are:\n-   Sensitivity: $P_B(+ \\mid D) = 0.85$\n-   Specificity: $P_B(- \\mid \\neg D) = 0.97$\n-   Pretest risk: $P(D) = 0.05$\n\nFirst, we calculate the false positive rate for Group B:\n$$ P_B(+ \\mid \\neg D) = 1 - P_B(- \\mid \\neg D) = 1 - 0.97 = 0.03 $$\nNext, we calculate the total probability of a positive test, $P_B(+)$:\n$$ P_B(+) = P_B(+ \\mid D) P(D) + P_B(+ \\mid \\neg D) P(\\neg D) $$\n$$ P_B(+) = (0.85)(0.05) + (0.03)(0.95) $$\n$$ P_B(+) = 0.0425 + 0.0285 = 0.0710 $$\nNow, we apply Bayes' theorem to find the posterior probability $P_B(D \\mid +)$:\n$$ P_B(D \\mid +) = \\frac{P_B(+ \\mid D) P(D)}{P_B(+)} = \\frac{(0.85)(0.05)}{0.0710} = \\frac{0.0425}{0.0710} \\approx 0.5985915... $$\nRounding to four significant figures, the posterior probability for an individual in Group B is $0.5986$.\n\nIn summary, the posterior probability of disease given a positive test result is approximately $0.8319$ for Group A and $0.5986$ for Group B. This demonstrates that despite an identical pretest risk, the lower sensitivity and specificity of the test for the underrepresented group lead to a substantially lower confidence in a positive result, highlighting a significant health disparity driven by data biases.", "answer": "$$ \\boxed{\\begin{pmatrix} 0.8319 & 0.5986 \\end{pmatrix}} $$", "id": "5027562"}]}