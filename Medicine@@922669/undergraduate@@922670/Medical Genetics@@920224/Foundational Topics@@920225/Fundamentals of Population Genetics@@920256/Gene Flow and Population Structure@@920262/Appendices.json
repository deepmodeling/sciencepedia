{"hands_on_practices": [{"introduction": "Population structure has direct, measurable consequences on the distribution of genetic diversity. This first exercise demonstrates the Wahlund effect, a foundational principle stating that subdivision into distinct groups reduces the overall frequency of heterozygotes compared to a single, randomly mating population. By working through this hypothetical scenario [@problem_id:2800679], you will quantify this heterozygote deficit and compute the fixation index, $F_{ST}$, one of the most important metrics in population and medical genetics.", "problem": "A single biallelic locus with alleles $A$ and $a$ is studied in a metapopulation consisting of $2$ subpopulations of equal census size. Within each subpopulation, mating is random (Hardy–Weinberg equilibrium), and there is no selection, mutation, or migration during the generation of interest. Subpopulation $1$ has allele $A$ frequency $p_1=0.2$ and subpopulation $2$ has allele $A$ frequency $p_2=0.8$. Let expected heterozygosity be defined as the probability that two alleles drawn at random (with replacement) from the relevant gene pool are of different allelic types.\n\nUsing only fundamental definitions and assumptions stated above, determine:\n- the expected heterozygosity if one were to ignore population structure and treat the pooled sample as panmictic,\n- the average expected heterozygosity within subpopulations, and\n- the heterozygote deficit attributable to population structure expressed as the fraction of the pooled expected heterozygosity that is missing due to substructure (that is, report the deficit as a dimensionless fraction in decimal form, not as a percent).\n\nReport only the final fraction described in the last bullet as your answer, rounded to $4$ significant figures. No units are required.", "solution": "The problem will first be validated for scientific and logical integrity.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- A single biallelic locus with alleles $A$ and $a$.\n- A metapopulation consists of $2$ subpopulations.\n- Subpopulations have equal census size.\n- Within each subpopulation: random mating (Hardy–Weinberg equilibrium), no selection, no mutation, no migration.\n- Subpopulation $1$ has allele $A$ frequency $p_1=0.2$.\n- Subpopulation $2$ has allele $A$ frequency $p_2=0.8$.\n- Definition of expected heterozygosity: the probability that two alleles drawn at random (with replacement) from the relevant gene pool are of different allelic types.\n- Task: Determine the heterozygote deficit attributable to population structure, expressed as the fraction of the pooled expected heterozygosity that is missing due to substructure.\n- Report the final fraction rounded to $4$ significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is evaluated against the established criteria.\n- **Scientifically Grounded:** The problem is a classic exercise in population genetics, dealing with standard concepts such as allele frequencies, Hardy-Weinberg equilibrium, and the Wahlund effect, which describes the reduction in heterozygosity in a structured population. The premises are fundamentally sound.\n- **Well-Posed:** The problem is clearly defined, providing all necessary numerical values ($p_1$, $p_2$) and conditions (equal subpopulation sizes, no evolutionary forces within generations) to calculate a unique, meaningful answer. The term \"expected heterozygosity\" is explicitly and correctly defined.\n- **Objective:** The language is quantitative and precise, free of any subjectivity or ambiguity.\n- **Completeness and Consistency:** The problem is self-contained. The information that the $2$ subpopulations are of equal size is crucial and provided. There are no internal contradictions.\n- **Realism:** The given allele frequencies are biologically plausible, and the model of a subdivided population is a cornerstone of population genetics theory.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, standard problem in quantitative biology. A full solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds by calculating the three required quantities: the expected heterozygosity in a hypothetical panmictic total population ($H_T$), the average expected heterozygosity within the actual subpopulations ($H_S$), and finally, the relative deficit.\n\nFirst, we determine the average allele frequency of allele $A$ in the total metapopulation, denoted as $\\bar{p}$. Since the two subpopulations are of equal census size, the average frequency is the arithmetic mean of the individual subpopulation frequencies, $p_1$ and $p_2$:\n$$\n\\bar{p} = \\frac{p_1 + p_2}{2}\n$$\nSubstituting the given values, $p_1 = 0.2$ and $p_2 = 0.8$:\n$$\n\\bar{p} = \\frac{0.2 + 0.8}{2} = \\frac{1.0}{2} = 0.5\n$$\nThe corresponding average frequency of allele $a$ is $\\bar{q} = 1 - \\bar{p} = 1 - 0.5 = 0.5$.\n\nNext, we calculate the expected heterozygosity for the total population, $H_T$, under the hypothetical assumption that the subpopulations are pooled and mating occurs randomly (panmixia) across the entire metapopulation. In a population at Hardy-Weinberg equilibrium, the expected heterozygosity is given by $2\\bar{p}\\bar{q}$.\n$$\nH_T = 2\\bar{p}\\bar{q} = 2(0.5)(0.5) = 0.5\n$$\nThis value, $H_T$, represents the expected proportion of heterozygotes if the population structure were ignored.\n\nNow, we calculate the expected heterozygosity within each subpopulation. Mating is random within each subpopulation, so Hardy-Weinberg principles apply locally.\nFor subpopulation $1$, the frequency of allele $a$ is $q_1 = 1 - p_1 = 1 - 0.2 = 0.8$. The expected heterozygosity, $H_1$, is:\n$$\nH_1 = 2p_1q_1 = 2(0.2)(0.8) = 0.32\n$$\nFor subpopulation $2$, the frequency of allele $a$ is $q_2 = 1 - p_2 = 1 - 0.8 = 0.2$. The expected heterozygosity, $H_2$, is:\n$$\nH_2 = 2p_2q_2 = 2(0.8)(0.2) = 0.32\n$$\nThe average expected heterozygosity within subpopulations, $H_S$, is the weighted average of the individual heterozygosities. Since the subpopulations are of equal size, this is the simple arithmetic mean of $H_1$ and $H_2$.\n$$\nH_S = \\frac{H_1 + H_2}{2} = \\frac{0.32 + 0.32}{2} = 0.32\n$$\nThis value, $H_S$, represents the actual average proportion of heterozygotes across the structured population.\n\nThe deficit in heterozygosity due to population subdivision (the Wahlund effect) is the difference $H_T - H_S$.\n$$\n\\text{Deficit} = H_T - H_S = 0.5 - 0.32 = 0.18\n$$\nThe problem asks for this deficit expressed as a fraction of the pooled expected heterozygosity, $H_T$. This is a measure of population differentiation, commonly known as the fixation index, $F_{ST}$.\n$$\nF_{ST} = \\frac{H_T - H_S}{H_T}\n$$\nSubstituting the calculated values:\n$$\nF_{ST} = \\frac{0.5 - 0.32}{0.5} = \\frac{0.18}{0.5} = 0.36\n$$\nThe problem requires the answer to be rounded to $4$ significant figures. The exact value is $0.36$. To express this with $4$ significant figures, we write it as $0.3600$.", "answer": "$$\n\\boxed{0.3600}\n$$", "id": "2800679"}, {"introduction": "While $F_{ST}$ provides a static snapshot of differentiation, its value is shaped by dynamic evolutionary processes. This next practice explores the classic island model of population structure, revealing how the level of genetic differentiation reflects an equilibrium between two opposing forces: gene flow (migration), which homogenizes allele frequencies, and genetic drift, which causes them to diverge. By deriving and applying the famous relationship between $F_{ST}$, effective population size ($N_e$), and migration rate ($m$) [@problem_id:5034295], you will gain a deeper understanding of what determines the structure of populations.", "problem": "A neutral, biallelic variant influencing a pharmacogenomic trait is segregating in a metapopulation of human subpopulations connected by symmetric migration. Consider the following scientifically grounded setting: an effectively infinite number of exchangeable demes, each with constant effective population size ($N_e$) equal to $2{,}000$, exchange migrants each generation at rate $m = 0.0025$, and have reached migration–drift equilibrium. Let the global allele frequency be $\\bar{p}$, and let $p_i$ denote the allele frequency in deme $i$. Assume no mutation and no selection. Using only core definitions and the sequential action of migration and genetic drift in one discrete generation, proceed as follows.\n\n1) Define the among-deme variance $V_t = \\operatorname{Var}(p_i)$ at generation $t$ and Wright’s fixation index ($F_{ST}$) as the standardized among-deme variance $F_{ST} = \\dfrac{V_t}{\\bar{p}(1-\\bar{p})}$.\n\n2) Starting from these definitions and the law of total variance, write the recursion that combines the variance-reducing effect of migration and the variance-inflating effect of binomial genetic drift in demes of size $N_e$. Solve this recursion at equilibrium to express the expected $F_{ST}$ as a function of $N_e$ and $m$. Where algebraically justified, you may use a small-$m$ approximation.\n\n3) Using your derived expression, compute the expected $F_{ST}$ for $N_e = 2{,}000$ and $m = 0.0025$. Round your final numerical answer to $3$ significant figures.\n\n4) Briefly interpret the magnitude you obtain in terms of population differentiation relevant for medical allele frequency differences (for example, whether it suggests weak, modest, or strong differentiation that could matter for cross-population portability of genetic risk estimates).\n\nYour final reported value for $F_{ST}$ must be a single decimal number as specified in step $3$ (no units).", "solution": "The problem asks for the derivation and calculation of Wright's fixation index, $F_{ST}$, in an infinite island model at migration-drift equilibrium. The solution proceeds in four stages as requested: (1) stating the given definitions, (2) deriving the equilibrium expression for $F_{ST}$, (3) calculating its numerical value for the given parameters, and (4) interpreting the result.\n\n### 1. Problem Definitions\n\nThe problem defines the among-deme variance in allele frequency at generation $t$ as $V_t = \\operatorname{Var}(p_i)$, where $p_i$ is the allele frequency in deme $i$. Wright's fixation index, $F_{ST}$, is defined as the standardized variance:\n$$\nF_{ST} = \\frac{V_t}{\\bar{p}(1-\\bar{p})}\n$$\nwhere $\\bar{p}$ is the constant global allele frequency across the metapopulation. The effective population size of each deme is $N_e = 2{,}000$, and the symmetric migration rate is $m = 0.0025$.\n\n### 2. Derivation of the Recursion and Equilibrium Solution\n\nWe model the change in the among-deme variance, $V_t$, over one discrete generation. A generation consists of two sequential processes: migration followed by genetic drift.\n\n#### Effect of Migration\n\nLet $p_i(t)$ be the allele frequency in deme $i$ at the start of generation $t$. Following an exchange of a fraction $m$ of individuals with a migrant pool, the allele frequency in deme $i$ becomes $p'_i(t)$. In the infinite island model, the migrant pool is assumed to be a perfect sample of the entire metapopulation, so its allele frequency is the global average, $\\bar{p}$. The post-migration frequency is a weighted average:\n$$\np'_i(t) = (1-m)p_i(t) + m\\bar{p}\n$$\nThe variance of these post-migration frequencies across demes, denoted $V'_t$, is:\n$$\nV'_t = \\operatorname{Var}(p'_i(t)) = \\operatorname{Var}((1-m)p_i(t) + m\\bar{p})\n$$\nUsing the property $\\operatorname{Var}(aX + b) = a^2\\operatorname{Var}(X)$, and noting that $m$ and $\\bar{p}$ are constants across demes:\n$$\nV'_t = (1-m)^2 \\operatorname{Var}(p_i(t)) = (1-m)^2 V_t\n$$\nMigration acts to reduce the variance among demes, homogenizing allele frequencies.\n\n#### Effect of Genetic Drift\n\nFollowing migration, the next generation within each deme is formed by random sampling of $2N_e$ gametes from the deme's gene pool, which has an allele frequency of $p'_i(t)$. This process is binomial sampling, which introduces a new component of variance. We use the law of total variance to find the variance of allele frequencies at the start of the next generation, $V_{t+1} = \\operatorname{Var}(p_i(t+1))$.\n$$\n\\operatorname{Var}(p_i(t+1)) = E[\\operatorname{Var}(p_i(t+1) | p'_i(t))] + \\operatorname{Var}(E[p_i(t+1) | p'_i(t)])\n$$\nThe two terms are evaluated as follows:\n1.  The expectation of the conditional variance: The variance from binomial sampling within a deme is $\\frac{p'_i(t)(1-p'_i(t))}{2N_e}$. We take the expectation of this quantity over all demes.\n    $$\n    E[\\operatorname{Var}(p_i(t+1) | p'_i(t))] = E\\left[ \\frac{p'_i(t)(1-p'_i(t))}{2N_e} \\right] = \\frac{1}{2N_e} E[p'_i(t) - (p'_i(t))^2]\n    $$\n    We know $E[p'_i(t)] = \\bar{p}$ and $\\operatorname{Var}(p'_i(t)) = E[(p'_i(t))^2] - (E[p'_i(t)])^2 = V'_t$. Thus, $E[(p'_i(t))^2] = V'_t + \\bar{p}^2$. Substituting these in:\n    $$\n    E[\\operatorname{Var}(p_i(t+1) | p'_i(t))] = \\frac{1}{2N_e} (\\bar{p} - (V'_t + \\bar{p}^2)) = \\frac{\\bar{p}(1-\\bar{p}) - V'_t}{2N_e}\n    $$\n2.  The variance of the conditional expectation: The expected allele frequency after drift is simply the frequency before drift, so $E[p_i(t+1) | p'_i(t)] = p'_i(t)$.\n    $$\n    \\operatorname{Var}(E[p_i(t+1) | p'_i(t)]) = \\operatorname{Var}(p'_i(t)) = V'_t\n    $$\nCombining the two terms gives the full recursion for the variance:\n$$\nV_{t+1} = \\frac{\\bar{p}(1-\\bar{p}) - V'_t}{2N_e} + V'_t = V'_t \\left(1 - \\frac{1}{2N_e}\\right) + \\frac{\\bar{p}(1-\\bar{p})}{2N_e}\n$$\nSubstituting $V'_t = (1-m)^2 V_t$, we obtain the complete one-generation recurrence relation for $V_t$:\n$$\nV_{t+1} = (1-m)^2 V_t \\left(1 - \\frac{1}{2N_e}\\right) + \\frac{\\bar{p}(1-\\bar{p})}{2N_e}\n$$\n\n#### Equilibrium Solution\n\nAt migration-drift equilibrium, the variance is constant, so $V_{t+1} = V_t = V_{eq}$.\n$$\nV_{eq} = (1-m)^2 V_{eq} \\left(1 - \\frac{1}{2N_e}\\right) + \\frac{\\bar{p}(1-\\bar{p})}{2N_e}\n$$\nSolving for $V_{eq}$:\n$$\nV_{eq} \\left[1 - (1-m)^2 \\left(1 - \\frac{1}{2N_e}\\right)\\right] = \\frac{\\bar{p}(1-\\bar{p})}{2N_e}\n$$\nLet's analyze the term in the brackets. Given that $m$ is small ($m=0.0025$), we can use the approximation $(1-m)^2 \\approx 1 - 2m$. This is justified as $m^2 = 6.25 \\times 10^{-6}$ is negligible.\n$$\n1 - (1-2m)\\left(1 - \\frac{1}{2N_e}\\right) = 1 - \\left(1 - \\frac{1}{2N_e} - 2m + \\frac{2m}{2N_e}\\right) = \\frac{1}{2N_e} + 2m - \\frac{m}{N_e}\n$$\nSince both $m$ and $1/N_e$ are small, the product term $m/N_e$ is of a smaller order of magnitude and can be neglected. So, the bracketed term is approximately $\\frac{1}{2N_e} + 2m$.\nThis leads to:\n$$\nV_{eq} \\left( \\frac{1}{2N_e} + 2m \\right) \\approx \\frac{\\bar{p}(1-\\bar{p})}{2N_e}\n$$\nMultiplying both sides by $2N_e$:\n$$\nV_{eq} (1 + 4N_e m) \\approx \\bar{p}(1-\\bar{p})\n$$\n$$\nV_{eq} \\approx \\frac{\\bar{p}(1-\\bar{p})}{1 + 4N_e m}\n$$\nFinally, we substitute this into the definition of $F_{ST}$ at equilibrium:\n$$\nF_{ST} = \\frac{V_{eq}}{\\bar{p}(1-\\bar{p})} \\approx \\frac{\\frac{\\bar{p}(1-\\bar{p})}{1 + 4N_e m}}{\\bar{p}(1-\\bar{p})} = \\frac{1}{1 + 4N_e m}\n$$\nThis is the classic equilibrium expression for $F_{ST}$ in the infinite island model.\n\n### 3. Numerical Calculation\n\nWe are given $N_e = 2{,}000$ and $m = 0.0025$. We compute the product $4N_e m$:\n$$\n4N_e m = 4 \\times 2{,}000 \\times 0.0025 = 8{,}000 \\times 0.0025 = 20\n$$\nNow, we calculate the expected $F_{ST}$:\n$$\nF_{ST} \\approx \\frac{1}{1 + 20} = \\frac{1}{21}\n$$\nConverting this to a decimal and rounding to $3$ significant figures:\n$$\nF_{ST} \\approx 0.047619... \\approx 0.0476\n$$\n\n### 4. Interpretation\n\nAn $F_{ST}$ value of $0.0476$ indicates that approximately $4.8\\%$ of the total genetic variation for this neutral variant is due to allele frequency differences *among* subpopulations, while the remaining $95.2\\%$ resides *within* subpopulations. According to conventional benchmarks (e.g., those proposed by Wright), an $F_{ST}$ value between $0$ and $0.05$ signifies little genetic differentiation. This value is on the cusp of being considered 'moderate' differentiation.\n\nIn the context of medical genetics and pharmacogenomics, even this level of differentiation can be clinically meaningful. It implies that while populations are largely similar, there are measurable differences in allele frequencies. Relying on genetic risk associations or drug-response predictions from one population and applying them to another might be misleading. For instance, a drug dosage optimized for a population with one allele frequency might not be optimal for another population where the frequency is different. Therefore, this level of differentiation suggests that the cross-population portability of pharmacogenomic findings cannot be assumed and may require population-specific validation or adjustment.", "answer": "$$\n\\boxed{0.0476}\n$$", "id": "5034295"}, {"introduction": "Beyond measuring overall differentiation with metrics like $F_{ST}$, population geneticists have developed powerful tools to detect specific, historical episodes of gene flow. This final exercise introduces the D-statistic, or ABBA-BABA test, a widely used method for identifying introgression (gene flow between divergent lineages) against the background noise of incomplete lineage sorting. By calculating the D-statistic and evaluating its statistical significance [@problem_id:5034281], you will learn a key technique used to uncover ancient admixture events that have shaped the genomes of many species, including our own.", "problem": "A medical genetics group uses a four-taxon allele-sharing test to assess historical gene flow among human populations. Let $P_1$, $P_2$, and $P_3$ denote three human populations and let $O$ denote an outgroup. Across $L$ nonoverlapping genomic blocks, biallelic sites are summarized into two discordant site-pattern counts under the assumed species tree topology: $ABBA$ and $BABA$. In the absence of gene flow and under incomplete lineage sorting (ILS), the two discordant patterns are expected to occur in equal proportions.\n\nTo detect deviation from this null expectation, the group defines a test statistic $D$ as a normalized contrast of the observed discordant pattern counts. The variability of $D$ across the genome is estimated via a block jackknife over the $L$ blocks, yielding a block-jackknife standard error (SE) for $D$, denoted $\\widehat{\\sigma}_D$.\n\nYou are given the following empirically observed totals across the genome: $ABBA = 1200$ and $BABA = 900$. The block-jackknife estimate of the standard error is $\\widehat{\\sigma}_D = 0.05$. Starting from the null expectation that $ABBA$ and $BABA$ are equally likely under ILS, and using the definition of $D$ as a normalized contrast of these counts, compute:\n1. The value of $D$ from the given counts.\n2. The $Z$-score defined by standardizing $D$ with $\\widehat{\\sigma}_D$.\n\nState whether the result provides evidence for introgression using the widely adopted criterion $|Z| > 3$ for significance. Round the numerical values of $D$ and $Z$ to three significant figures. Report the final numerical answer as the pair $[D, Z]$ in that order; both quantities are dimensionless.", "solution": "The problem asks for the calculation of the D-statistic and its associated Z-score to test for gene flow (introgression) among human populations. The problem is well-posed and scientifically sound, resting on the established principles of the ABBA-BABA test in population genetics.\n\nThe D-statistic is a test statistic designed to detect an imbalance in the frequencies of two discordant site patterns, denoted $ABBA$ and $BABA$, which arise from a specific four-taxon phylogeny. The null hypothesis, assuming no gene flow and that discordance is due only to incomplete lineage sorting (ILS), posits that these two patterns should appear in equal frequencies. The D-statistic, defined as a normalized contrast of the counts of these patterns, quantifies the deviation from this null expectation.\n\nLet $n_{ABBA}$ and $n_{BABA}$ be the observed counts of the $ABBA$ and $BABA$ site patterns, respectively. The D-statistic is formulated as:\n$$ D = \\frac{n_{ABBA} - n_{BABA}}{n_{ABBA} + n_{BABA}} $$\n\nThe problem provides the following empirically observed counts:\n$n_{ABBA} = 1200$\n$n_{BABA} = 900$\n\nSubstituting these values into the formula for $D$:\n$$ D = \\frac{1200 - 900}{1200 + 900} = \\frac{300}{2100} = \\frac{1}{7} $$\n\nTo provide a numerical value as requested, we convert the fraction to a decimal and round to three significant figures:\n$$ D = \\frac{1}{7} \\approx 0.142857... $$\nRounding to three significant figures, we get:\n$$ D \\approx 0.143 $$\n\nNext, we compute the $Z$-score to assess the statistical significance of the observed $D$ value. The $Z$-score standardizes the D-statistic by dividing it by its standard error, $\\widehat{\\sigma}_D$. The $Z$-score is thus given by:\n$$ Z = \\frac{D}{\\widehat{\\sigma}_D} $$\nThe problem provides the block-jackknife estimate of the standard error as $\\widehat{\\sigma}_D = 0.05$. To maintain precision, we use the exact value of $D = \\frac{1}{7}$ for the calculation:\n$$ Z = \\frac{1/7}{0.05} = \\frac{1/7}{1/20} = \\frac{20}{7} $$\n\nConverting this fraction to a decimal and rounding to three significant figures:\n$$ Z = \\frac{20}{7} \\approx 2.85714... $$\nRounding to three significant figures, we get:\n$$ Z \\approx 2.86 $$\n\nFinally, we are asked to determine if this result provides evidence for introgression. The specified criterion for statistical significance is $|Z| > 3$. Our calculated $Z$-score is approximately $2.86$. We check if its absolute value meets the criterion:\n$$ |Z| \\approx |2.86| = 2.86 $$\nThe comparison is:\n$$ 2.86 > 3 $$\nThis inequality is false. The calculated $|Z|$ value of $2.86$ does not exceed the threshold of $3$. Therefore, based on the provided data and the specified significance criterion, a formal conclusion is that the null hypothesis of no gene flow is not rejected. The observed excess of $ABBA$ patterns is not statistically significant at the $|Z| > 3$ level.\n\nThe final numerical answers for $D$ and $Z$, rounded to three significant figures, are $0.143$ and $2.86$, respectively.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.143 & 2.86\n\\end{pmatrix}\n}\n$$", "id": "5034281"}]}