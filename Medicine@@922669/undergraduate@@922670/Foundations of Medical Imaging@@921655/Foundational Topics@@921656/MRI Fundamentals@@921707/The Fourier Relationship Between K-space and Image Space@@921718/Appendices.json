{"hands_on_practices": [{"introduction": "Understanding the Fourier relationship between k-space and the image begins with mastering the transform itself. This exercise provides direct practice by having you compute the inverse Fourier transform of an analytically defined k-space signal, specifically a Gaussian function [@problem_id:4933058]. Working through this problem reinforces the mathematical details of the transform and reveals the fundamental principle that a compact signal in one domain corresponds to a spread-out signal in the conjugate domain.", "problem": "In Magnetic Resonance Imaging (MRI), the complex image-domain magnetization $m(\\mathbf{r})$ and the $k$-space signal $M(\\mathbf{k})$ are related by the spatial Fourier transform pair\n$$\nM(\\mathbf{k}) = \\int_{\\mathbb{R}^{2}} m(\\mathbf{r}) \\,\\exp\\!\\big(-i\\,2\\pi\\,\\mathbf{k}\\cdot \\mathbf{r}\\big)\\, d^{2}\\mathbf{r}, \\qquad\nm(\\mathbf{r}) = \\int_{\\mathbb{R}^{2}} M(\\mathbf{k}) \\,\\exp\\!\\big(i\\,2\\pi\\,\\mathbf{k}\\cdot \\mathbf{r}\\big)\\, d^{2}\\mathbf{k},\n$$\nwhere $\\mathbf{r}=(x,y)$ denotes position in meters and $\\mathbf{k}=(k_{x},k_{y})$ denotes spatial frequency in cycles per meter.\n\nConsider the analytically specified $k$-space function\n$$\nM(\\mathbf{k}) = M_{0}\\,\\exp\\!\\Big(-\\pi\\big[\\sigma_{x}^{2}\\big(k_{x}-k_{0x}\\big)^{2} + \\sigma_{y}^{2}\\big(k_{y}-k_{0y}\\big)^{2}\\big]\\Big)\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{x}\\,\\Delta_{x} + k_{y}\\,\\Delta_{y}\\big]\\big),\n$$\nwhere $M_{0}>0$ is a constant amplitude, $\\sigma_{x}>0$ and $\\sigma_{y}>0$ are characteristic length scales (in meters), $\\mathbf{k}_{0}=(k_{0x},k_{0y})$ is the $k$-space offset (in cycles per meter), and $\\boldsymbol{\\Delta}=(\\Delta_{x},\\Delta_{y})$ is a spatial offset (in meters).\n\nStarting only from the stated Fourier transform definitions and standard, well-tested integral facts, compute the inverse Fourier transform $m(\\mathbf{r})$ and provide the fully simplified, explicit expression for $m(\\mathbf{r})$ with all constants carried through. No numerical evaluation is required; provide your answer as a single closed-form analytic expression. The final expression should be written in terms of $M_{0}$, $\\sigma_{x}$, $\\sigma_{y}$, $k_{0x}$, $k_{0y}$, $\\Delta_{x}$, $\\Delta_{y}$, $x$, and $y$.", "solution": "The problem asks for the inverse Fourier transform of the specified $k$-space function under the stated Fourier conventions. We begin from the definition\n$$\nm(\\mathbf{r}) = \\int_{\\mathbb{R}^{2}} M(\\mathbf{k})\\,\\exp\\!\\big(i\\,2\\pi\\,\\mathbf{k}\\cdot\\mathbf{r}\\big)\\,d^{2}\\mathbf{k},\n$$\nwith $\\mathbf{r}=(x,y)$ and $\\mathbf{k}=(k_{x},k_{y})$. Substituting the given $M(\\mathbf{k})$,\n$$\nm(\\mathbf{r}) = \\int_{\\mathbb{R}^{2}} M_{0}\\,\\exp\\!\\Big(-\\pi\\big[\\sigma_{x}^{2}\\big(k_{x}-k_{0x}\\big)^{2} + \\sigma_{y}^{2}\\big(k_{y}-k_{0y}\\big)^{2}\\big]\\Big)\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{x}\\,\\Delta_{x} + k_{y}\\,\\Delta_{y}\\big]\\big)\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{x}\\,x + k_{y}\\,y\\big]\\big)\\,dk_{x}\\,dk_{y}.\n$$\nCombine the exponentials in the last two factors:\n$$\n\\exp\\!\\big(i\\,2\\pi\\big[k_{x}\\,\\Delta_{x} + k_{y}\\,\\Delta_{y}\\big]\\big)\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{x}\\,x + k_{y}\\,y\\big]\\big) = \\exp\\!\\big(i\\,2\\pi\\big[k_{x}\\,(x+\\Delta_{x}) + k_{y}\\,(y+\\Delta_{y})\\big]\\big).\n$$\nNext perform a change of variables to center the Gaussian: define $u_{x} = k_{x}-k_{0x}$ and $u_{y} = k_{y}-k_{0y}$, so $dk_{x}\\,dk_{y} = du_{x}\\,du_{y}$ and $k_{x} = u_{x}+k_{0x}$, $k_{y} = u_{y}+k_{0y}$. Then\n\\begin{align*}\nm(\\mathbf{r})\n&= \\int_{\\mathbb{R}^{2}} M_{0}\\,\\exp\\!\\Big(-\\pi\\big[\\sigma_{x}^{2}\\,u_{x}^{2} + \\sigma_{y}^{2}\\,u_{y}^{2}\\big]\\Big)\\,\\exp\\!\\big(i\\,2\\pi\\big[(u_{x}+k_{0x})(x+\\Delta_{x}) + (u_{y}+k_{0y})(y+\\Delta_{y})\\big]\\big)\\,du_{x}\\,du_{y}\\\\\n&= M_{0}\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{0x}(x+\\Delta_{x}) + k_{0y}(y+\\Delta_{y})\\big]\\big)\\,\\int_{\\mathbb{R}^{2}} \\exp\\!\\Big(-\\pi\\big[\\sigma_{x}^{2}\\,u_{x}^{2} + \\sigma_{y}^{2}\\,u_{y}^{2}\\big]\\Big)\\,\\exp\\!\\big(i\\,2\\pi\\big[u_{x}(x+\\Delta_{x}) + u_{y}(y+\\Delta_{y})\\big]\\big)\\,du_{x}\\,du_{y}.\n\\end{align*}\nThe integral is separable in $u_{x}$ and $u_{y}$:\n\\begin{align*}\nI &= \\left(\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\pi\\,\\sigma_{x}^{2}\\,u_{x}^{2}\\big)\\,\\exp\\!\\big(i\\,2\\pi\\,u_{x}\\,(x+\\Delta_{x})\\big)\\,du_{x}\\right)\\,\\left(\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\pi\\,\\sigma_{y}^{2}\\,u_{y}^{2}\\big)\\,\\exp\\!\\big(i\\,2\\pi\\,u_{y}\\,(y+\\Delta_{y})\\big)\\,du_{y}\\right).\n\\end{align*}\nWe evaluate the standard Fourier-type Gaussian integral. Using the widely accepted Gaussian integral fact (which can be derived by completing the square),\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\pi\\,a\\,u^{2}\\big)\\,\\exp\\!\\big(i\\,2\\pi\\,b\\,u\\big)\\,du = \\frac{1}{\\sqrt{a}}\\,\\exp\\!\\big(-\\pi\\,b^{2}/a\\big), \\quad \\text{for } a>0,\n$$\nwe identify $a=\\sigma_{x}^{2}$, $b=x+\\Delta_{x}$ in the $u_{x}$ integral, and $a=\\sigma_{y}^{2}$, $b=y+\\Delta_{y}$ in the $u_{y}$ integral. Therefore,\n\\begin{align*}\n\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\pi\\,\\sigma_{x}^{2}\\,u_{x}^{2}\\big)\\,\\exp\\!\\big(i\\,2\\pi\\,u_{x}\\,(x+\\Delta_{x})\\big)\\,du_{x} &= \\frac{1}{\\sigma_{x}}\\,\\exp\\!\\left(-\\pi\\,\\frac{(x+\\Delta_{x})^{2}}{\\sigma_{x}^{2}}\\right),\\\\\n\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\pi\\,\\sigma_{y}^{2}\\,u_{y}^{2}\\big)\\,\\exp\\!\\big(i\\,2\\pi\\,u_{y}\\,(y+\\Delta_{y})\\big)\\,du_{y} &= \\frac{1}{\\sigma_{y}}\\,\\exp\\!\\left(-\\pi\\,\\frac{(y+\\Delta_{y})^{2}}{\\sigma_{y}^{2}}\\right).\n\\end{align*}\nHence,\n$$\nI = \\frac{1}{\\sigma_{x}\\,\\sigma_{y}}\\,\\exp\\!\\left(-\\pi\\left[\\frac{(x+\\Delta_{x})^{2}}{\\sigma_{x}^{2}} + \\frac{(y+\\Delta_{y})^{2}}{\\sigma_{y}^{2}}\\right]\\right).\n$$\nPutting this back into the expression for $m(\\mathbf{r})$ gives\n\\begin{align*}\nm(\\mathbf{r})\n&= M_{0}\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{0x}(x+\\Delta_{x}) + k_{0y}(y+\\Delta_{y})\\big]\\big)\\,\\frac{1}{\\sigma_{x}\\,\\sigma_{y}}\\,\\exp\\!\\left(-\\pi\\left[\\frac{(x+\\Delta_{x})^{2}}{\\sigma_{x}^{2}} + \\frac{(y+\\Delta_{y})^{2}}{\\sigma_{y}^{2}}\\right]\\right)\\\\\n&= \\frac{M_{0}}{\\sigma_{x}\\,\\sigma_{y}}\\,\\exp\\!\\left(-\\pi\\left[\\frac{(x+\\Delta_{x})^{2}}{\\sigma_{x}^{2}} + \\frac{(y+\\Delta_{y})^{2}}{\\sigma_{y}^{2}}\\right]\\right)\\,\\exp\\!\\big(i\\,2\\pi\\big[k_{0x}\\,x + k_{0y}\\,y + k_{0x}\\,\\Delta_{x} + k_{0y}\\,\\Delta_{y}\\big]\\big).\n\\end{align*}\nThis is the fully specified image-domain function with all constants carried through. It shows that an anisotropic, shifted Gaussian in $k$-space produces an anisotropic Gaussian in image space whose widths are inversely proportional to $\\sigma_{x}$ and $\\sigma_{y}$, shifted by $\\boldsymbol{\\Delta}$, and modulated by a complex exponential carrier at spatial frequency $\\mathbf{k}_{0}$, along with a global phase factor $\\exp\\!\\big(i\\,2\\pi\\big[\\mathbf{k}_{0}\\cdot\\boldsymbol{\\Delta}\\big]\\big)$.", "answer": "$$\\boxed{\\frac{M_{0}}{\\sigma_{x}\\,\\sigma_{y}}\\,\\exp\\!\\left(-\\pi\\left[\\frac{(x+\\Delta_{x})^{2}}{\\sigma_{x}^{2}} + \\frac{(y+\\Delta_{y})^{2}}{\\sigma_{y}^{2}}\\right]\\right)\\,\\exp\\!\\left(i\\,2\\pi\\left(k_{0x}\\,x + k_{0y}\\,y + k_{0x}\\,\\Delta_{x} + k_{0y}\\,\\Delta_{y}\\right)\\right)}$$", "id": "4933058"}, {"introduction": "Moving from continuous theory to practical application, we must consider that k-space is sampled at discrete points, and the choices made during this sampling have profound consequences on the final image. This practice [@problem_id:4941776] explores the critical distinction between the k-space sampling interval, which sets the Field-of-View (FOV), and the total k-space coverage, which defines the image resolution. By analyzing a scenario involving wrap-around artifact, you will solidify your understanding of how these parameters independently control fundamental aspects of image quality.", "problem": "A one-dimensional object with spin density $\\rho(x)$ is imaged using Magnetic Resonance Imaging (MRI). The object has effective nonzero support over $x \\in [-20\\,\\mathrm{cm},\\,20\\,\\mathrm{cm}]$. The imaging system acquires samples of the $k$-space signal $S(k)$ at uniformly spaced points $k_n = n\\,\\Delta k$ for integers $n$ with total number of samples $N$, and reconstructs an image via a discrete inverse Fourier transform over $N$ points. You may assume the standard continuous Fourier transform pair $S(k)=\\int_{-\\infty}^{\\infty} \\rho(x)\\,e^{-i2\\pi k x}\\,dx$ and the Nyquist–Shannon sampling theorem, as well as the usual properties that uniform sampling in one domain produces a periodic extension in the conjugate domain.\n\nTwo acquisition tweaks are considered:\n\n- Case 1: Increase $N$ from $256$ to $512$ while keeping $\\Delta k$ fixed at $1/32\\,\\mathrm{cm}^{-1}$.\n- Case 2: Reduce $\\Delta k$ from $1/32\\,\\mathrm{cm}^{-1}$ to $1/48\\,\\mathrm{cm}^{-1}$ while keeping $N$ fixed at $256$.\n\nObserved outcomes are that Case 1 improves spatial resolution but does not remove wrap-around (aliasing), whereas Case 2 removes wrap-around. Using only the fundamental bases stated above, reason about the discrete inverse Fourier reconstruction and explain which statement best accounts for these outcomes.\n\nA. Reducing $\\Delta k$ increases the period of the implicit periodic extension in the image domain, allowing the object’s support to fit within a single period and eliminating wrap-around; increasing $N$ at fixed $\\Delta k$ only decreases the image grid spacing $\\Delta x$ (improving resolution) without changing that period, so wrap-around persists if it was present.\n\nB. Increasing $N$ at fixed $\\Delta k$ increases the maximum sampled spatial frequency $k_{\\max}$ enough to satisfy the Nyquist criterion for the object, thereby removing wrap-around; reducing $\\Delta k$ merely increases resolution and cannot affect aliasing.\n\nC. Wrap-around is caused by insufficient $k_{\\max}$, so increasing $N$ at fixed $\\Delta k$ removes it by extending the sampled bandwidth, whereas reducing $\\Delta k$ does not change aliasing unless $N$ is simultaneously increased.\n\nD. Wrap-around arises from time-domain sampling effects, so changing $\\Delta k$ (a frequency-domain parameter) does not influence aliasing; increasing $N$ fixes the artifact by enlarging the reconstructed image extent.", "solution": "The problem statement will first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n-   Object description: A one-dimensional object with spin density $\\rho(x)$.\n-   Object support: Effective nonzero support over $x \\in [-20\\,\\mathrm{cm},\\,20\\,\\mathrm{cm}]$. The total extent is $L_{obj} = 20\\,\\mathrm{cm} - (-20\\,\\mathrm{cm}) = 40\\,\\mathrm{cm}$.\n-   Imaging process: Acquisition of $k$-space signal samples $S(k)$ at uniformly spaced points $k_n = n\\,\\Delta k$. The total number of samples is $N$. Reconstruction is performed via an $N$-point discrete inverse Fourier transform.\n-   Assumed principles:\n    -   Continuous Fourier transform pair: $S(k)=\\int_{-\\infty}^{\\infty} \\rho(x)\\,e^{-i2\\pi k x}\\,dx$.\n    -   Nyquist–Shannon sampling theorem.\n    -   Uniform sampling in k-space produces a periodic extension in the image (spatial) domain.\n-   Case 1: $N$ is increased from $256$ to $512$ while $\\Delta k$ is kept fixed at $1/32\\,\\mathrm{cm}^{-1}$.\n-   Case 2: $\\Delta k$ is reduced from $1/32\\,\\mathrm{cm}^{-1}$ to $1/48\\,\\mathrm{cm}^{-1}$ while $N$ is kept fixed at $256$.\n-   Observed outcomes: Case 1 improves spatial resolution but wrap-around persists. Case 2 removes wrap-around.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of Fourier-based imaging, specifically as applied in MRI. The concepts of k-space, field-of-view, spatial resolution, and wrap-around (aliasing) are central to the field. The provided mathematical relationship is the standard definition of the Fourier transform.\n\nLet us analyze the relationships between the sampling parameters and the image properties based on the principles of the Discrete Fourier Transform (DFT), which is the discrete equivalent of the continuous transform mentioned.\n\n1.  **Field-of-View (FOV) and Wrap-around:** Uniform sampling in the frequency domain (k-space) with an interval $\\Delta k$ results in a periodic replication in the conjugate spatial domain ($x$-domain). The period of this replication defines the Field-of-View (FOV) of the reconstructed image. The relationship is $\\mathrm{FOV} = 1/\\Delta k$. Wrap-around aliasing occurs if the extent of the object, $L_{obj}$, exceeds the FOV. The condition to avoid wrap-around is $L_{obj} \\le \\mathrm{FOV}$, which is equivalent to the Nyquist criterion for k-space sampling: $\\Delta k \\le 1/L_{obj}$.\n\n2.  **Spatial Resolution:** The spatial resolution, or more precisely the pixel/grid spacing $\\Delta x$ in the reconstructed image, is determined by the total extent of the k-space data acquisition, $k_{span} = N \\Delta k$. The relationship is $\\Delta x = 1/k_{span} = 1/(N \\Delta k)$. This can also be seen as $\\Delta x = \\mathrm{FOV}/N$. Improving spatial resolution means decreasing $\\Delta x$.\n\nLet's check the numerical consistency of the problem statement.\n-   **Initial State:** $N_0 = 256$, $\\Delta k_0 = 1/32\\,\\mathrm{cm}^{-1}$.\n    -   The initial FOV is $\\mathrm{FOV}_0 = 1/\\Delta k_0 = 1 / (1/32\\,\\mathrm{cm}^{-1}) = 32\\,\\mathrm{cm}$.\n    -   The object extent is $L_{obj} = 40\\,\\mathrm{cm}$.\n    -   Since $L_{obj} > \\mathrm{FOV}_0$, the object is larger than the field of view. This correctly predicts that wrap-around aliasing must be present in the initial state.\n\n-   **Analysis of Case 1:** Parameters are $N_1 = 512$, $\\Delta k_1 = 1/32\\,\\mathrm{cm}^{-1}$.\n    -   The new FOV is $\\mathrm{FOV}_1 = 1/\\Delta k_1 = 1 / (1/32\\,\\mathrm{cm}^{-1}) = 32\\,\\mathrm{cm}$.\n    -   Since the FOV is unchanged and is still smaller than the object extent ($32\\,\\mathrm{cm} < 40\\,\\mathrm{cm}$), wrap-around **must persist**. This matches the observed outcome.\n    -   The initial grid spacing was $\\Delta x_0 = 1/(N_0 \\Delta k_0) = 1/(256 \\times 1/32) = 1/8\\,\\mathrm{cm} = 0.125\\,\\mathrm{cm}$.\n    -   The new grid spacing is $\\Delta x_1 = 1/(N_1 \\Delta k_1) = 1/(512 \\times 1/32) = 1/16\\,\\mathrm{cm} = 0.0625\\,\\mathrm{cm}$.\n    -   Since $\\Delta x_1 < \\Delta x_0$, the grid spacing has decreased, which corresponds to an **improvement in spatial resolution**. This also matches the observed outcome.\n\n-   **Analysis of Case 2:** Parameters are $N_2 = 256$, $\\Delta k_2 = 1/48\\,\\mathrm{cm}^{-1}$.\n    -   The new FOV is $\\mathrm{FOV}_2 = 1/\\Delta k_2 = 1 / (1/48\\,\\mathrm{cm}^{-1}) = 48\\,\\mathrm{cm}$.\n    -   Now, the FOV is larger than the object extent ($\\mathrm{FOV}_2 = 48\\,\\mathrm{cm} > L_{obj} = 40\\,\\mathrm{cm}$). The condition to avoid aliasing is met. Therefore, wrap-around is **removed**. This matches the observed outcome.\n\nThe problem statement, including the described cases and their outcomes, is fully consistent with the fundamental principles of Fourier imaging. It is well-posed, scientifically sound, and objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. The analysis will proceed to evaluate the provided options.\n\n### Solution and Option Analysis\n\nThe core of the problem lies in the duality of the Fourier transform. The sampling interval in one domain determines the period (extent) in the conjugate domain, while the total sampled width in one domain determines the resolution (grid spacing) in the conjugate domain.\n\n-   k-space sampling interval $\\Delta k$ determines image-space period/extent (FOV): $\\mathrm{FOV} = 1/\\Delta k$.\n-   k-space sampling extent $k_{span} = N \\Delta k$ determines image-space resolution/grid spacing: $\\Delta x = 1/(N \\Delta k)$.\n\nWrap-around is a spatial aliasing artifact caused by the object extending beyond the FOV. To eliminate it, the FOV must be increased to be at least as large as the object. This requires reducing the k-space sampling interval $\\Delta k$.\n\nSpatial resolution is the ability to distinguish fine details. In the context of a discrete grid, it is limited by the grid spacing $\\Delta x$. To improve resolution (i.e., decrease $\\Delta x$), one must increase the total k-space coverage, $N \\Delta k$.\n\nWith this framework, let us evaluate the options:\n\n**A. Reducing $\\Delta k$ increases the period of the implicit periodic extension in the image domain, allowing the object’s support to fit within a single period and eliminating wrap-around; increasing $N$ at fixed $\\Delta k$ only decreases the image grid spacing $\\Delta x$ (improving resolution) without changing that period, so wrap-around persists if it was present.**\n\n-   This statement correctly identifies that the \"period of the implicit periodic extension\" is the FOV, and its value is $1/\\Delta k$.\n-   It correctly states that reducing $\\Delta k$ increases this period (FOV), which is the mechanism for eliminating wrap-around, matching the observation in Case 2. In our analysis, reducing $\\Delta k$ to $1/48\\,\\mathrm{cm}^{-1}$ increased the FOV to $48\\,\\mathrm{cm}$, which successfully encompassed the $40\\,\\mathrm{cm}$ object.\n-   It correctly states that increasing $N$ at a fixed $\\Delta k$ decreases the grid spacing $\\Delta x$, thereby improving resolution. Our analysis for Case 1 showed $\\Delta x$ decreased from $0.125\\,\\mathrm{cm}$ to $0.0625\\,\\mathrm{cm}$.\n-   It correctly states that this change (increasing $N$) does not alter the period (FOV), and thus wrap-around persists if the object was initially larger than the FOV. Our analysis for Case 1 showed the FOV remained $32\\,\\mathrm{cm}$, and wrap-around persisted.\n-   This option provides a complete and accurate explanation for all observations.\n-   **Verdict: Correct.**\n\n**B. Increasing $N$ at fixed $\\Delta k$ increases the maximum sampled spatial frequency $k_{\\max}$ enough to satisfy the Nyquist criterion for the object, thereby removing wrap-around; reducing $\\Delta k$ merely increases resolution and cannot affect aliasing.**\n\n-   This statement incorrectly associates wrap-around with the Nyquist criterion as applied to $k_{\\max}$. Wrap-around is aliasing in the *spatial* domain due to undersampling in the *k-space* domain. The relevant criterion is $\\Delta k \\le 1/L_{obj}$. Increasing $k_{\\max}$ (by increasing $N$) improves resolution, but does not affect the aliasing condition which depends on $\\Delta k$.\n-   The claim that increasing $N$ removes wrap-around is directly contradicted by the observed outcome in Case 1.\n-   The claim that reducing $\\Delta k$ \"merely increases resolution\" is false. For a fixed $N$, reducing $\\Delta k$ *worsens* resolution (increases $\\Delta x = 1/(N\\Delta k)$).\n-   The claim that reducing $\\Delta k$ \"cannot affect aliasing\" is also false; it is the primary method to affect and eliminate aliasing.\n-   **Verdict: Incorrect.**\n\n**C. Wrap-around is caused by insufficient $k_{\\max}$, so increasing $N$ at fixed $\\Delta k$ removes it by extending the sampled bandwidth, whereas reducing $\\Delta k$ does not change aliasing unless $N$ is simultaneously increased.**\n\n-   This statement incorrectly identifies the cause of wrap-around. It is caused by $\\Delta k$ being too large (insufficient sampling density), not by insufficient $k_{\\max}$ (insufficient bandwidth/coverage). Insufficient $k_{\\max}$ leads to blurring (poor resolution).\n-   The conclusion that increasing $N$ removes wrap-around is factually wrong, as per the outcome of Case 1.\n-   The claim that reducing $\\Delta k$ does not change aliasing is also factually wrong. It is precisely what removes aliasing in Case 2.\n-   **Verdict: Incorrect.**\n\n**D. Wrap-around arises from time-domain sampling effects, so changing $\\Delta k$ (a frequency-domain parameter) does not influence aliasing; increasing $N$ fixes the artifact by enlarging the reconstructed image extent.**\n\n-   While sampling in k-space occurs over time, the direct cause of spatial wrap-around is the k-space sampling interval $\\Delta k$. The statement that changing $\\Delta k$ \"does not influence aliasing\" is fundamentally wrong.\n-   The statement that \"increasing $N$ fixes the artifact by enlarging the reconstructed image extent\" is also incorrect. The \"reconstructed image extent\" is the FOV ($1/\\Delta k$). Increasing $N$ while keeping $\\Delta k$ fixed does *not* change the FOV. It only increases the number of pixels within that FOV.\n-   This statement contradicts both the principles of Fourier imaging and the observed outcomes.\n-   **Verdict: Incorrect.**\n\nThe only statement that correctly and completely explains the observed phenomena based on the fundamental principles of MRI and Fourier analysis is A.", "answer": "$$\\boxed{A}$$", "id": "4941776"}, {"introduction": "To rigorously assess image quality, we must use a quantitative tool: the Point Spread Function (PSF). The PSF describes the effective blurring and artifact pattern of an imaging system, and it is determined entirely by the k-space sampling and reconstruction process. This computational practice [@problem_id:4933044] challenges you to implement a basic reconstruction operator and compute the PSF for different sampling strategies, providing direct, hands-on experience in how the choice of k-space coordinates fundamentally dictates spatial resolution and artifact behavior.", "problem": "You are to implement, analyze, and test the adjoint of the Nonuniform Fast Fourier Transform (NUFFT) operator for one-dimensional nonuniform frequency-domain sampling and use it to compute the point spread function of the composite adjoint-forward operator in the context of the Fourier relationship between k-space and image space in medical imaging. Work entirely in discrete-time image space and nonuniformly sampled discrete frequency space. Angles in complex exponentials are measured in radians.\n\nStarting point and definitions, grounded in the Fourier relationship between k-space and image space: The continuous-space mapping between an object and its measured frequency-domain signal is modeled by the Fourier transform. In discrete settings relevant to Magnetic Resonance Imaging (MRI), a nonuniform discrete sampling of k-space is modeled by a linear operator that maps a discrete image on a uniform grid to a vector of samples at nonuniform frequency coordinates. Let the image domain be a length-$N$ vector $x \\in \\mathbb{C}^{N}$ indexed by $n \\in \\{0,1,\\dots,N-1\\}$, and let the nonuniform k-space coordinates be $\\{k_m\\}_{m=0}^{M-1}$ (real-valued) with $M$ samples. The forward nonuniform discrete Fourier operator $\\mathcal{A}: \\mathbb{C}^{N} \\to \\mathbb{C}^{M}$ is defined by\n$$\n(\\mathcal{A}x)_m \\triangleq \\sum_{n=0}^{N-1} x[n] \\, e^{-i 2\\pi \\frac{k_m n}{N}}, \\quad m=0,1,\\dots,M-1.\n$$\nThe adjoint operator $\\mathcal{A}^{\\ast}: \\mathbb{C}^{M} \\to \\mathbb{C}^{N}$ is defined by the condition $\\langle \\mathcal{A}x, y \\rangle = \\langle x, \\mathcal{A}^{\\ast}y \\rangle$ for all $x \\in \\mathbb{C}^{N}, y \\in \\mathbb{C}^{M}$ under the standard complex inner products, leading to\n$$\n(\\mathcal{A}^{\\ast} y)[n] \\triangleq \\sum_{m=0}^{M-1} y[m] \\, e^{+i 2\\pi \\frac{k_m n}{N}}, \\quad n=0,1,\\dots,N-1.\n$$\nThe composite adjoint-forward operator $\\mathcal{A}^{\\ast}\\mathcal{A}: \\mathbb{C}^{N} \\to \\mathbb{C}^{N}$ is linear and shift-invariant on the discrete cyclic group when $k_m$ are integer-spaced, and more generally produces a discrete point spread function capturing how an impulse in image space is spread by the measurement and reconstruction pair. Define the point spread function $g \\in \\mathbb{C}^{N}$ of $\\mathcal{A}^{\\ast}\\mathcal{A}$ as the response of $\\mathcal{A}^{\\ast}\\mathcal{A}$ to a discrete delta image $\\delta$ at the origin index $0$:\n$$\ng[n] \\triangleq (\\mathcal{A}^{\\ast}\\mathcal{A}\\,\\delta)[n], \\quad \\delta[n] = \n\\begin{cases}\n1, & n=0,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nTasks:\n1. Implement the forward operator $\\mathcal{A}$ and the adjoint operator $\\mathcal{A}^{\\ast}$ as defined above using direct summation. You may treat this implementation as the adjoint NUFFT realized without acceleration, which is acceptable for the small problem sizes in this task.\n2. Compute the point spread function $g = \\mathcal{A}^{\\ast}\\mathcal{A}\\,\\delta$ for each test case below.\n3. From $g$, compute the following three scalar metrics:\n   - The peak magnitude at the origin, $p \\triangleq |g[0]|$.\n   - The full-width at half-maximum (FWHM) in units of pixels, defined on the discrete cyclic grid as the number of consecutive indices around $n=0$ (considering wrap-around adjacency) for which $|g[n]| \\geq \\tfrac{1}{2} p$. This is a discrete width; report it as a real number equal to this count.\n   - The sidelobe ratio $r \\triangleq \\frac{\\sum_{n \\neq 0} |g[n]|}{|g[0]|}$.\n4. Report the three metrics $[p, \\text{FWHM}, r]$ rounded to six decimal places for each test case, aggregated in the specified final output format.\n\nTest suite of parameter values:\n- Use image length $N = 64$ for all cases. For each case below, the nonuniform k-space sample coordinates $\\{k_m\\}$ are specified.\n  1. Case A (uniform Cartesian sampling, happy path): $M=N$, $k_m = m$ for $m \\in \\{0,1,\\dots,N-1\\}$.\n  2. Case B (smoothly jittered sampling): $M=N$, $k_m = m + 0.25 \\,\\sin\\!\\big(2\\pi m/7\\big)$ for $m \\in \\{0,1,\\dots,N-1\\}$.\n  3. Case C (coarse nonuniform sampling, alias-prone): $M=20$, $k_m = \\big(\\tfrac{N}{M}\\big) m + 0.33 \\,\\cos\\!\\big(2\\pi m/5\\big)$ for $m \\in \\{0,1,\\dots,M-1\\}$, then wrap to the principal interval by $k_m \\leftarrow k_m \\bmod N$.\n  4. Case D (extreme boundary: single-sample acquisition): $M=1$, $k_0 = 10.3$.\n\nAlgorithmic and numerical requirements:\n- Angles are in radians. Implement the exponentials as shown above with factors $e^{\\pm i 2\\pi \\frac{k_m n}{N}}$.\n- All computations may be done in double-precision complex arithmetic.\n- No physical units are involved beyond the index domain; report FWHM in pixel units as an integer count, but encode it as a float in the output.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of the results for the cases A–D in order. Each case contributes a list $[p,\\text{FWHM},r]$ with each entry rounded to six decimal places. The final output must be a single line of the form\n\"[ [p_A,FWHM_A,r_A], [p_B,FWHM_B,r_B], [p_C,FWHM_C,r_C], [p_D,FWHM_D,r_D] ]\"\nwith no extra spaces beyond those shown here being required; any consistent comma-separated bracketed list is acceptable. For example: \"[[1.000000,1.000000,0.000000],[...],[...],[...]]\".", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of Fourier signal processing as applied to medical imaging, specifically concerning the relationship between k-space sampling and the image-domain point spread function. The definitions are mathematically precise and self-contained, and the tasks are well-posed, leading to a unique and verifiable solution.\n\nThe core of the problem is to analyze the point spread function (PSF) resulting from a composite forward-adjoint operator pair, which models a simplified measurement and reconstruction process in Magnetic Resonance Imaging (MRI). The PSF, denoted by $g$, characterizes the spatial resolution and artifact level of an imaging system. It is defined as the system's response to an idealized point source, a discrete delta function $\\delta$ at the origin.\n\nThe forward operator $\\mathcal{A}: \\mathbb{C}^{N} \\to \\mathbb{C}^{M}$ maps an image vector $x \\in \\mathbb{C}^{N}$ of length $N$ to $M$ k-space samples at nonuniform frequency coordinates $\\{k_m\\}_{m=0}^{M-1}$. It is given by:\n$$\n(\\mathcal{A}x)_m = \\sum_{n=0}^{N-1} x[n] \\, e^{-i 2\\pi \\frac{k_m n}{N}}\n$$\nThe adjoint operator $\\mathcal{A}^{\\ast}: \\mathbb{C}^{M} \\to \\mathbb{C}^{N}$, used for image reconstruction in this model, maps the k-space data $y \\in \\mathbb{C}^{M}$ back to the image domain:\n$$\n(\\mathcal{A}^{\\ast} y)[n] = \\sum_{m=0}^{M-1} y[m] \\, e^{+i 2\\pi \\frac{k_m n}{N}}\n$$\nWe seek the PSF $g = (\\mathcal{A}^{\\ast}\\mathcal{A}\\,\\delta)$. The calculation proceeds in two steps. First, we apply the forward operator $\\mathcal{A}$ to the discrete delta function $\\delta$, where $\\delta[n]=1$ for $n=0$ and $\\delta[n]=0$ for $n \\neq 0$. Let the result be the k-space vector $y_{\\delta} = \\mathcal{A}\\delta$.\n$$\n(y_{\\delta})_m = (\\mathcal{A}\\delta)_m = \\sum_{n=0}^{N-1} \\delta[n] \\, e^{-i 2\\pi \\frac{k_m \\cdot 0}{N}} = \\delta[0] \\cdot e^{-i 2\\pi \\frac{k_m \\cdot 0}{N}} = 1 \\cdot e^0 = 1\n$$\nThis shows that the k-space representation of a delta function at the origin is a vector of all ones, regardless of the sampling coordinates $\\{k_m\\}$.\n\nSecond, we apply the adjoint operator $\\mathcal{A}^{\\ast}$ to this result, $y_{\\delta}$, to obtain the PSF $g$.\n$$\ng[n] = (\\mathcal{A}^{\\ast} y_{\\delta})[n] = \\sum_{m=0}^{M-1} (y_{\\delta})_m \\, e^{+i 2\\pi \\frac{k_m n}{N}} = \\sum_{m=0}^{M-1} 1 \\cdot e^{+i 2\\pi \\frac{k_m n}{N}}\n$$\nThus, the final expression for the PSF is:\n$$\ng[n] = \\sum_{m=0}^{M-1} e^{i 2\\pi \\frac{k_m n}{N}}\n$$\nThis fundamental result reveals that the PSF is determined by the sum of complex sinusoids whose frequencies are dictated by the k-space sampling locations $\\{k_m\\}$.\n\nThe algorithm for each test case is as follows:\n1.  Define the image size $N=64$ and the parameters for the k-space coordinates $\\{k_m\\}$ for the given case. Generate the array of $M$ coordinates.\n2.  Compute the PSF vector $g \\in \\mathbb{C}^{N}$ using the derived formula. This is achieved by creating an $M \\times N$ matrix of complex exponentials and summing over the $M$ dimension.\n3.  Calculate the three characterization metrics from the computed PSF $g$:\n    a.  **Peak Magnitude, $p$**: This is the magnitude of the PSF at the origin, $p = |g[0]|$. From our formula, $g[0] = \\sum_{m=0}^{M-1} e^{0} = \\sum_{m=0}^{M-1} 1 = M$. Thus, we expect $p=M$.\n    b.  **Sidelobe Ratio, $r$**: This metric quantifies the energy spread into sidelobes relative to the peak. It is computed as $r = \\frac{\\sum_{n=1}^{N-1} |g[n]|}{|g[0]|}$.\n    c.  **Full-Width at Half-Maximum (FWHM)**: This measures the width of the central peak of the PSF. We first find the half-maximum threshold $\\tfrac{1}{2}p$. The FWHM is the count of consecutive indices around $n=0$ (with wrap-around) where $|g[n]| \\ge \\tfrac{1}{2}p$. The algorithm identifies the contiguous block of such indices containing the origin and reports its size.\n\nThis procedure is applied to each of the four test cases, which represent different k-space sampling strategies, to demonstrate how sampling choices impact image quality, as quantified by the PSF metrics.\n- **Case A** represents ideal, fully-sampled Cartesian acquisition. We anticipate a perfect PSF (a scaled delta function), resulting in $p=N$, FWHM$=1$, and $r=0$.\n- **Case B** introduces a small, smooth perturbation to the sampling grid, which is expected to slightly broaden the main lobe and introduce low-level sidelobes.\n- **Case C** models an aggressive undersampling scenario, which theory predicts will lead to significant aliasing artifacts, appearing as strong, structured sidelobes and a high sidelobe ratio.\n- **Case D** is an extreme case with only one k-space sample, which provides no spatial localization. The resulting PSF should have a constant magnitude, yielding a maximal FWHM of $N$ and a large sidelobe ratio.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and evaluates the adjoint NUFFT operator to compute\n    the Point Spread Function (PSF) for various k-space sampling patterns.\n    \"\"\"\n\n    N = 64  # Image size in one dimension\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"M\": N,\n            \"k_coords_func\": lambda M, N: np.arange(M),\n        },\n        {\n            \"name\": \"B\",\n            \"M\": N,\n            \"k_coords_func\": lambda M, N: np.arange(M) + 0.25 * np.sin(2 * np.pi * np.arange(M) / 7),\n        },\n        {\n            \"name\": \"C\",\n            \"M\": 20,\n            \"k_coords_func\": lambda M, N: np.mod( (N / M) * np.arange(M) + 0.33 * np.cos(2 * np.pi * np.arange(M) / 5), N),\n        },\n        {\n            \"name\": \"D\",\n            \"M\": 1,\n            \"k_coords_func\": lambda M, N: np.array([10.3]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        M = case[\"M\"]\n        k_coords = case[\"k_coords_func\"](M, N)\n\n        # The PSF g is the adjoint of an all-ones vector of length M.\n        # g[n] = sum_{m=0}^{M-1} exp(j * 2 * pi * k_m * n / N)\n        n_indices = np.arange(N)\n        \n        # Vectorized computation of the PSF\n        # outer product of k_coords and n_indices forms the phase terms\n        # k_coords: (M, 1), n_indices: (1, N) -> phase_matrix: (M, N)\n        phase_matrix = (2j * np.pi / N) * k_coords.reshape(-1, 1) * n_indices.reshape(1, -1)\n        exp_matrix = np.exp(phase_matrix)\n        g = np.sum(exp_matrix, axis=0) # Sum over the m-dimension\n\n        # --- Compute Metrics ---\n\n        # 1. Peak magnitude at the origin\n        p = np.abs(g[0])\n\n        # 2. Sidelobe ratio\n        # Sum of magnitudes of all non-origin points divided by peak magnitude\n        if p > 1e-9:\n             r = (np.sum(np.abs(g)) - np.abs(g[0])) / p\n        else:\n             r = np.inf if np.sum(np.abs(g)) > 1e-9 else 0.0\n\n        # 3. Full-width at half-maximum (FWHM)\n        half_max_val = 0.5 * p\n        above_half_max = np.abs(g) >= half_max_val\n        \n        fwhm = 0.0\n        if above_half_max[0]:\n            fwhm = 1.0\n            \n            # Search forward from n=1\n            pos_extent = 0\n            for i in range(1, N):\n                if above_half_max[i]:\n                    pos_extent += 1\n                else:\n                    break\n            \n            # Search backward from n=N-1 (handles wrap-around)\n            neg_extent = 0\n            for i in range(1, N):\n                if above_half_max[N - i]:\n                    neg_extent += 1\n                else:\n                    break\n            \n            # Total FWHM is the size of the contiguous block around 0\n            # Ensure we don't count the whole array twice if it's all True\n            if pos_extent + neg_extent >= N - 1:\n                fwhm = float(N)\n            else:\n                fwhm = 1.0 + pos_extent + neg_extent\n\n\n        results.append([round(p, 6), round(fwhm, 6), round(r, 6)])\n\n    # Format the final output string as specified a list of lists.\n    case_results_str = [f\"[{p},{fwhm},{r}]\" for p, fwhm, r in (np.array(results).round(6))]\n    \n    # Custom format to prevent float trailing issues like 1.0 -> 1.\n    formatted_case_results = []\n    for res_list in results:\n        formatted_case_results.append(f\"[{res_list[0]:.6f},{res_list[1]:.6f},{res_list[2]:.6f}]\")\n\n    print(f\"[{','.join(formatted_case_results)}]\")\n\nsolve()\n```", "id": "4933044"}]}