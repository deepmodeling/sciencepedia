{"hands_on_practices": [{"introduction": "How do we ensure that a digital image appears smooth and continuous, without distracting \"banding\" artifacts? This exercise connects the physical properties of an image signal to the limits of human perception. You will calculate the minimum bit depth required to make quantization steps smaller than the Just Noticeable Difference (JND), ensuring a visually seamless grayscale representation. [@problem_id:4880586]", "problem": "A flat-panel digital radiography system linearly maps detector signal intensities within a prescribed window to a display grayscale with uniform quantization. Suppose a particular imaging protocol restricts the region of interest to intensities in the interval $[I_{\\min}, I_{\\max}] = [\\,10,\\,410\\,]$ in calibrated detector units. The display pipeline uses an $N$-bit uniform quantizer with $2^N$ equally spaced levels over the interval $[I_{\\min}, I_{\\max})$. To ensure that quantization is visually imperceptible under the given viewing conditions, assume a just noticeable difference (JND) threshold $\\Delta I_{\\mathrm{JND}} = 0.35$ in the same calibrated detector units, and require that the quantization step (i.e., the width of one quantization interval) is strictly smaller than $\\Delta I_{\\mathrm{JND}}$ across the entire mapped range.\n\nStarting from the definitions of dynamic range, bit depth, uniform quantization, and the just noticeable difference threshold, determine the minimum integer bit depth $N$ that satisfies the perceptual requirement. Express your final answer as an integer number of bits. No rounding instruction is necessary since the answer is an integer.", "solution": "The problem requires determining the minimum integer bit depth $N$ for a uniform quantizer such that the quantization step size is strictly smaller than a given just noticeable difference (JND) threshold. We begin by formally defining the relevant quantities and establishing their relationships based on the principles of digital signal processing and medical imaging.\n\nThe problem statement provides the following givens:\n1.  The range of signal intensities to be mapped is the interval $[I_{\\min}, I_{\\max}] = [10, 410]$ in calibrated detector units.\n2.  The quantizer is a uniform $N$-bit quantizer, which provides $L = 2^N$ quantization levels.\n3.  The quantization is applied over the interval $[I_{\\min}, I_{\\max})$, which has a total width or dynamic range, $W$.\n4.  The just noticeable difference threshold is $\\Delta I_{\\mathrm{JND}} = 0.35$ in the same units.\n5.  The perceptual requirement is that the quantization step size, which we denote as $\\Delta I_q$, must be strictly smaller than the JND threshold: $\\Delta I_q < \\Delta I_{\\mathrm{JND}}$.\n\nFirst, let's calculate the total width of the intensity range to be quantized. This dynamic range, $W$, is given by the difference between the maximum and minimum intensity values:\n$$W = I_{\\max} - I_{\\min}$$\nSubstituting the given values, we have:\n$$W = 410 - 10 = 400$$\n\nNext, we consider the uniform $N$-bit quantizer. By definition, an $N$-bit quantizer divides the input range into $L$ discrete levels, where $L$ is given by:\n$$L = 2^N$$\nFor a uniform quantizer, these $L$ levels are equally spaced across the entire dynamic range $W$. The width of each quantization interval, also known as the quantization step size $\\Delta I_q$, is therefore the total width of the range divided by the number of levels:\n$$\\Delta I_q = \\frac{W}{L} = \\frac{I_{\\max} - I_{\\min}}{2^N}$$\n\nThe core requirement of the problem is that this quantization step must be imperceptible, which is mathematically stated as being strictly smaller than the JND threshold, $\\Delta I_{\\mathrm{JND}}$. This gives us the following inequality:\n$$\\Delta I_q < \\Delta I_{\\mathrm{JND}}$$\nSubstituting our expression for $\\Delta I_q$, we get:\n$$\\frac{I_{\\max} - I_{\\min}}{2^N} < \\Delta I_{\\mathrm{JND}}$$\n\nWe can now substitute the given numerical values into this inequality to solve for $N$:\n$$\\frac{400}{2^N} < 0.35$$\nTo find the minimum integer $N$ that satisfies this condition, we first rearrange the inequality to isolate the term $2^N$:\n$$2^N > \\frac{400}{0.35}$$\nLet's evaluate the fraction on the right-hand side.\n$$\\frac{400}{0.35} = \\frac{400}{35/100} = \\frac{400 \\times 100}{35} = \\frac{40000}{35} = \\frac{8000}{7}$$\nSo the inequality is:\n$$2^N > \\frac{8000}{7}$$\nCalculating the approximate decimal value of the fraction:\n$$\\frac{8000}{7} \\approx 1142.857$$\nThus, we must find the smallest integer $N$ such that $2^N > 1142.857...$.\n\nTo solve for $N$, we take the base-$2$ logarithm of both sides of the inequality. Since $\\log_2(x)$ is a monotonically increasing function, the direction of the inequality is preserved.\n$$\\log_2(2^N) > \\log_2\\left(\\frac{8000}{7}\\right)$$\n$$N > \\log_2\\left(\\frac{8000}{7}\\right)$$\nUsing the change of base formula for logarithms, $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$, we can compute the value using the natural logarithm ($\\ln$):\n$$N > \\frac{\\ln\\left(\\frac{8000}{7}\\right)}{\\ln(2)}$$\nNumerically evaluating the expression:\n$$\\ln\\left(\\frac{8000}{7}\\right) \\approx \\ln(1142.857) \\approx 7.0413$$\n$$\\ln(2) \\approx 0.6931$$\n$$N > \\frac{7.0413}{0.6931} \\approx 10.158$$\nSince the bit depth $N$ must be an integer, we must find the smallest integer value of $N$ that is strictly greater than $10.158$. The first integer to satisfy this condition is $11$.\n\nTherefore, the minimum integer bit depth required to meet the perceptual criterion is $N=11$. We can verify this answer.\nIf $N=10$, $2^{10} = 1024$. The quantization step would be $\\Delta I_q = \\frac{400}{1024} \\approx 0.3906$, which is not smaller than $\\Delta I_{\\mathrm{JND}} = 0.35$.\nIf $N=11$, $2^{11} = 2048$. The quantization step would be $\\Delta I_q = \\frac{400}{2048} \\approx 0.1953$, which is strictly smaller than $\\Delta I_{\\mathrm{JND}} = 0.35$. This satisfies the condition.\nThus, the minimum integer bit depth is indeed $11$.", "answer": "$$\\boxed{11}$$", "id": "4880586"}, {"introduction": "Increasing bit depth is a common strategy to improve image quality, but what is the actual quantitative benefit? This practice guides you through calculating the theoretical improvement in Signal-to-Noise Ratio (SNR) gained by adding more bits to your analog-to-digital converter. More importantly, it challenges you to think about why this ideal gain might not be fully achieved in real-world clinical scenarios. [@problem_id:4880569]", "problem": "An imaging acquisition chain for X-ray fluoroscopy uses an ideal uniform midtread Analog-to-Digital Converter (ADC). The ADC is operated first at $10$-bit resolution and then at $12$-bit resolution. Assume the input is a sinusoidal test signal that exactly spans the full-scale range (FSR), meaning its peak-to-peak equals the full-scale range (FSR), and that the quantization error can be modeled as uncorrelated, uniformly distributed over its support. Using only first principles of uniform quantization and basic definitions of signal and noise power, determine the expected improvement in the Signal-to-Noise Ratio (SNR) in decibels when moving from $10$-bit to $12$-bit quantization under these ideal conditions. Then, consider clinical operation in which pixel value histograms can be sparse or confined to a narrow subrange of the ADCâ€™s full-scale range (due to scene content and window/level choices): select the statement that correctly gives the ideal improvement and accurately explains why the improvement may not be realized in practice for such sparse or subrange inputs.\n\nChoose one:\n\nA. The ideal SNR improvement is approximately $12.04\\ \\mathrm{dB}$; in practice it may not be realized if the input occupies only a fraction $k<1$ of full scale without appropriate gain rescaling or if grayscale mapping uses a narrow window, because the signal root-mean-square scales with $k$ while the quantization step does not, and non-quantization noise sources can dominate, masking the quantization-limited gain.\n\nB. The ideal SNR improvement is approximately $6.02\\ \\mathrm{dB}$; in practice it may not be realized because sparse histograms inherently reduce quantization noise, so extra bits confer little benefit.\n\nC. The ideal SNR improvement is approximately $12.04\\ \\mathrm{dB}$; in practice it may not be realized for subrange inputs because using a narrower subrange reduces the quantization step size, which makes the quantization noise smaller regardless of bit depth.\n\nD. The ideal SNR improvement is approximately $24.08\\ \\mathrm{dB}$; in practice it may not be realized because $8$-bit display pipelines cap the visible grayscale levels, eliminating any upstream SNR gain.", "solution": "The user wants a critical validation of the problem statement, followed by a first-principles derivation of the solution and a detailed analysis of all provided options.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Imaging system: X-ray fluoroscopy acquisition chain.\n- ADC: Ideal uniform midtread Analog-to-Digital Converter (ADC).\n- Bit resolutions: First at $n_1 = 10$-bit, then at $n_2 = 12$-bit.\n- Test signal: Sinusoidal, peak-to-peak amplitude equals the full-scale range ($V_{pp} = V_{FSR}$).\n- Quantization error model: Uncorrelated, uniformly distributed over its support.\n- Tasks:\n    1. Determine the expected improvement in Signal-to-Noise Ratio (SNR) in decibels (dB) when moving from $10$-bit to $12$-bit quantization under ideal conditions.\n    2. Consider clinical operation where inputs are sparse or occupy a narrow subrange of the ADC's FSR.\n    3. Select the statement that provides the correct ideal improvement and accurately explains the practical limitations.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on fundamental principles of digital signal processing, specifically the theory of analog-to-digital conversion and quantization. The concepts of bit depth, SNR, quantization noise, full-scale range, and the use of a sinusoidal test signal are standard in the engineering analysis of data acquisition systems, including those used in medical imaging. The model of quantization error is a widely accepted and used approximation. The practical considerations regarding sparse histograms and subrange signals are relevant and grounded in the realities of medical image acquisition and processing. The problem is scientifically sound.\n- **Well-Posed:** The problem provides sufficient information to derive a unique numerical answer for the ideal SNR improvement. The idealized conditions are clearly stated. The qualitative part of the question regarding practical scenarios is also well-defined, allowing for a clear evaluation of the provided explanations based on first principles.\n- **Objective:** The problem statement is expressed in precise, technical language, free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid. It is scientifically sound, well-posed, and objective. It requires a standard but non-trivial derivation and a clear understanding of both ideal theory and practical system limitations.\n- **Action:** Proceed with the solution derivation.\n\n**Solution Derivation**\n\n**Part 1: Ideal Signal-to-Noise Ratio (SNR) Improvement**\n\nThe Signal-to-Noise Ratio (SNR) for a quantized signal is the ratio of the signal power ($P_S$) to the quantization noise power ($P_N$).\n$$ \\mathrm{SNR} = \\frac{P_S}{P_N} $$\n\n1.  **Quantization Noise Power ($P_N$)**:\n    For an $n$-bit uniform ADC with a full-scale range $V_{FSR}$, there are $L = 2^n$ quantization levels. The size of each quantization step is $\\Delta = V_{FSR} / L = V_{FSR} / 2^n$. The problem states that the quantization error, $e_q$, is modeled as a random variable uniformly distributed over its support. For an ideal midtread quantizer, this range is $[-\\Delta/2, \\Delta/2]$. The probability density function (PDF) of the error is $f(e_q) = 1/\\Delta$ for $e_q \\in [-\\Delta/2, \\Delta/2]$ and $0$ otherwise.\n    The noise power is the variance of this error, which, for a zero-mean distribution, is its mean-square value:\n    $$ P_N = E[e_q^2] = \\int_{-\\infty}^{\\infty} e_q^2 f(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q^2 \\frac{1}{\\Delta} de_q $$\n    $$ P_N = \\frac{1}{\\Delta} \\left[ \\frac{e_q^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{\\Delta} \\left( \\frac{(\\Delta/2)^3}{3} - \\frac{(-\\Delta/2)^3}{3} \\right) = \\frac{1}{\\Delta} \\left( \\frac{\\Delta^3}{24} + \\frac{\\Delta^3}{24} \\right) = \\frac{\\Delta^2}{12} $$\n\n2.  **Signal Power ($P_S$)**:\n    The input is a sinusoidal test signal, $x(t) = A \\cos(\\omega t + \\phi)$, whose peak-to-peak amplitude exactly spans the FSR. Thus, $V_{pp} = 2A = V_{FSR}$, which means the peak amplitude is $A = V_{FSR}/2$.\n    The power of a signal is its mean-square value. For a sinusoid, the power is its RMS (root-mean-square) value squared. The RMS value of a sinusoid with amplitude $A$ is $V_{rms} = A/\\sqrt{2}$.\n    $$ P_S = V_{rms}^2 = \\left( \\frac{A}{\\sqrt{2}} \\right)^2 = \\frac{A^2}{2} $$\n    Substituting $A = V_{FSR}/2$:\n    $$ P_S = \\frac{(V_{FSR}/2)^2}{2} = \\frac{V_{FSR}^2}{8} $$\n\n3.  **SNR Formula**:\n    Now, we combine the expressions for $P_S$ and $P_N$:\n    $$ \\mathrm{SNR} = \\frac{P_S}{P_N} = \\frac{V_{FSR}^2 / 8}{\\Delta^2 / 12} $$\n    Substitute $\\Delta = V_{FSR} / 2^n$:\n    $$ \\mathrm{SNR} = \\frac{V_{FSR}^2}{8} \\cdot \\frac{12}{(V_{FSR}/2^n)^2} = \\frac{12}{8} \\frac{V_{FSR}^2 \\cdot (2^n)^2}{V_{FSR}^2} = 1.5 \\cdot (2^n)^2 = 1.5 \\cdot 2^{2n} $$\n\n4.  **SNR in Decibels (dB)**:\n    The SNR in dB is defined as $10 \\log_{10}(\\mathrm{SNR})$.\n    $$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(1.5 \\cdot 2^{2n}) = 10 \\log_{10}(1.5) + 10 \\log_{10}(2^{2n}) $$\n    $$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(1.5) + 20n \\log_{10}(2) $$\n    Using the approximations $\\log_{10}(2) \\approx 0.30103$ and $\\log_{10}(1.5) \\approx 0.17609$:\n    $$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 10(0.17609) + 20n(0.30103) \\approx 1.76 + 6.02n $$\n    This well-known formula shows that for each additional bit of quantization ($n \\to n+1$), the ideal SNR increases by approximately $6.02\\ \\mathrm{dB}$.\n\n5.  **Calculate the Improvement**:\n    We need to find the improvement in SNR when moving from $n_1 = 10$-bit to $n_2 = 12$-bit resolution. The change in bit depth is $\\Delta n = n_2 - n_1 = 12 - 10 = 2$ bits.\n    The improvement in dB is:\n    $$ \\Delta \\mathrm{SNR}_{\\mathrm{dB}} = \\mathrm{SNR}_{\\mathrm{dB}}(n_2) - \\mathrm{SNR}_{\\mathrm{dB}}(n_1) = (1.76 + 6.02 n_2) - (1.76 + 6.02 n_1) $$\n    $$ \\Delta \\mathrm{SNR}_{\\mathrm{dB}} = 6.02 (n_2 - n_1) = 6.02 \\times 2 = 12.04\\ \\mathrm{dB} $$\n    The ideal SNR improvement is approximately $12.04\\ \\mathrm{dB}$.\n\n**Part 2: Analysis of Practical Limitations**\n\nThe problem asks why this improvement may not be realized in practice for inputs that occupy a narrow subrange of the ADC's FSR.\nLet the actual signal occupy a fraction $k < 1$ of the FSR. The signal amplitude is now $A' = k (V_{FSR}/2)$.\nThe signal power becomes $P_S' = (A')^2/2 = k^2 (V_{FSR}^2/8) = k^2 P_S$. The signal power is reduced by a factor of $k^2$.\nThe quantization step size $\\Delta$ is a property of the ADC and its FSR, so it remains unchanged (assuming no pre-amplification or gain adjustment). The quantization noise power $P_N = \\Delta^2/12$ is therefore also unchanged.\nThe SNR of the system is a ratio of signal power to *total* noise power, $P_{N,total}$. The total noise is the sum of quantization noise ($P_N$) and all other noise sources in the acquisition chain ($P_{other}$), such as thermal noise, electronic noise, and, in X-ray systems, photon shot noise.\n$$ \\mathrm{SNR}_{total} = \\frac{P_S'}{P_N + P_{other}} $$\nWhen we increase the bit depth from $n_1$ to $n_2$, the quantization noise power decreases significantly: $P_N(n_2) = P_N(n_1) / 2^{2(n_2-n_1)} = P_N(10) / 16$. However, $P_{other}$ remains constant.\nThe SNR improvement is the ratio of the total SNR at $n_2$ bits to that at $n_1$ bits.\nIf the system is quantization-noise-limited (i.e., $P_N \\gg P_{other}$), then $\\mathrm{SNR}_{total} \\approx P_S'/P_N$, and the full $12.04\\ \\mathrm{dB}$ improvement will be realized.\nHowever, in a practical system, especially one with a good ADC (high bit depth), it is often the case that $P_{other} \\ge P_N$. For a subrange signal, the signal power $P_S'$ is small. The system's performance is limited by its noise floor. If $P_{other}$ dominates the total noise (i.e., $P_{other} \\gg P_N$), then the total noise $P_N + P_{other} \\approx P_{other}$. In this scenario, reducing $P_N$ further by increasing bit depth has a negligible effect on the total noise power. Consequently, the observed $\\mathrm{SNR}_{total}$ does not improve significantly. This is why the ideal gain is not realized. Using a narrow window for grayscale mapping is a post-processing decision that highlights data in such a subrange, making this phenomenon relevant to clinical interpretation.\n\n**Option-by-Option Analysis**\n\n**A. The ideal SNR improvement is approximately $12.04\\ \\mathrm{dB}$; in practice it may not be realized if the input occupies only a fraction $k<1$ of full scale without appropriate gain rescaling or if grayscale mapping uses a narrow window, because the signal root-mean-square scales with $k$ while the quantization step does not, and non-quantization noise sources can dominate, masking the quantization-limited gain.**\n- **Ideal Improvement:** $12.04\\ \\mathrm{dB}$. This is correct as per the derivation.\n- **Practical Explanation:** Correctly states that for a subrange input (fraction $k$), the signal power (and RMS) scales down, while the quantization step $\\Delta$ remains fixed. Most importantly, it correctly identifies the core reason for the unrealized gain: other non-quantization noise sources dominate the total noise, especially for small signals, thus masking any benefit from reducing the already smaller quantization noise component.\n- **Verdict:** Correct.\n\n**B. The ideal SNR improvement is approximately $6.02\\ \\mathrm{dB}$; in practice it may not be realized because sparse histograms inherently reduce quantization noise, so extra bits confer little benefit.**\n- **Ideal Improvement:** $6.02\\ \\mathrm{dB}$. This is incorrect. This value corresponds to an increase of only $1$ bit, not $2$ bits.\n- **Practical Explanation:** The reasoning is flawed. Sparse histograms do not inherently reduce quantization noise power ($P_N = \\Delta^2/12$, which is fixed). A sparse histogram corresponding to a low-amplitude signal results in a poor *quantization SNR* ($P_S/P_N$), but does not change $P_N$.\n- **Verdict:** Incorrect.\n\n**C. The ideal SNR improvement is approximately $12.04\\ \\mathrm{dB}$; in practice it may not be realized for subrange inputs because using a narrower subrange reduces the quantization step size, which makes the quantization noise smaller regardless of bit depth.**\n- **Ideal Improvement:** $12.04\\ \\mathrm{dB}$. This is correct.\n- **Practical Explanation:** The reasoning is fundamentally incorrect. The signal itself does not alter the properties of the ADC. For a fixed ADC, the quantization step size $\\Delta$ is constant. Using a narrower subrange of the input does not reduce $\\Delta$. This statement confuses the input signal's range with the ADC's FSR.\n- **Verdict:** Incorrect.\n\n**D. The ideal SNR improvement is approximately $24.08\\ \\mathrm{dB}$; in practice it may not be realized because $8$-bit display pipelines cap the visible grayscale levels, eliminating any upstream SNR gain.**\n- **Ideal Improvement:** $24.08\\ \\mathrm{dB}$. This is incorrect. This value would correspond to an increase of $4$ bits ($6.02 \\times 4$).\n- **Practical Explanation:** While display limitations are a real issue in the overall imaging chain (from acquisition to perception), they do not explain why the SNR *of the acquired digital data itself* may not show the theoretical improvement. The SNR gain exists in the high-bit-depth data upstream of the display. The primary reason the acquisition SNR may not improve as expected is the dominance of other noise sources, not downstream display limitations.\n- **Verdict:** Incorrect.", "answer": "$$\\boxed{A}$$", "id": "4880569"}, {"introduction": "Radiologists rarely view the entire dynamic range of a CT scan at once; instead, they use \"windowing\" to focus on specific tissues. While essential for diagnosis, this process discards information outside the chosen window. This problem models a realistic clinical scenario to quantify the effects of windowing, calculating the amount of clipped data and the resulting bias in quantitative lesion analysis. [@problem_id:4880602]", "problem": "A computed tomography image volume is rendered to a $12$-bit grayscale display using windowing and linear mapping. Let the underlying voxel intensity $X$ (in Hounsfield units, HU) have a two-component mixture-of-Gaussians histogram representative of soft tissue and a focal lesion:\n- Background component: weight $w_{b} = 0.95$, distribution $X \\sim \\mathcal{N}(\\mu_{b}, \\sigma_{b}^{2})$ with $\\mu_{b} = 50$ and $\\sigma_{b} = 20$.\n- Lesion component: weight $w_{\\ell} = 0.05$, distribution $X \\sim \\mathcal{N}(\\mu_{\\ell}, \\sigma_{\\ell}^{2})$ with $\\mu_{\\ell} = 120$ and $\\sigma_{\\ell} = 15$.\n\nA window level $L$ and window width $W$ define the lower and upper limits of the grayscale mapping as $L L = L - \\frac{W}{2}$ and $U L = L + \\frac{W}{2}$. For this problem, use $L = 90$ and $W = 120$, so that $L L = 30$ and $U L = 150$. The $12$-bit display maps intensities as follows:\n- If $x \\leq L L$, the displayed code is $0$.\n- If $x \\geq U L$, the displayed code is $4095$.\n- If $L L < x < U L$, the displayed code is $d(x) = s\\,(x - L L)$, where $s = \\frac{4095}{U L - L L}$.\n\nClinically, a naive lesion quantification approach sometimes back-inverts the display to estimate intensities. Define the naive estimator $Y$ (in HU) by inverting the linear mapping and treating clipped voxels as exactly at the bounds:\n$$\nY = \\min\\big(\\max(X, L L), U L\\big).\n$$\n\nStarting from the definitions of windowing, bit depth mapping, and properties of the Gaussian distribution and its cumulative distribution function, derive and compute:\n1. The overall fraction of voxels in the image that are clipped on the display (either mapped to $0$ or to $4095$), expressed as a decimal.\n2. The bias in the estimated lesion mean under the naive estimator, defined as $E[Y] - \\mu_{\\ell}$, expressed in Hounsfield units.\n\nRound both answers to four significant figures. For the bias, express the final value in Hounsfield units (HU). The final numerical outputs must be given as a pair in a single row matrix.", "solution": "The problem statement is critically evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **Voxel Intensity Model**: The voxel intensity $X$ in Hounsfield units (HU) follows a two-component mixture-of-Gaussians distribution.\n  - Background component: weight $w_{b} = 0.95$, distribution $\\mathcal{N}(\\mu_{b}, \\sigma_{b}^{2})$ with mean $\\mu_{b} = 50$ HU and standard deviation $\\sigma_{b} = 20$ HU.\n  - Lesion component: weight $w_{\\ell} = 0.05$, distribution $\\mathcal{N}(\\mu_{\\ell}, \\sigma_{\\ell}^{2})$ with mean $\\mu_{\\ell} = 120$ HU and standard deviation $\\sigma_{\\ell} = 15$ HU.\n- **Display and Mapping**: A $12$-bit grayscale display is used.\n- **Windowing Parameters**: Window level $L = 90$ HU and window width $W = 120$ HU.\n- **Window Limits**:\n  - Lower limit: $LL = L - \\frac{W}{2} = 90 - \\frac{120}{2} = 30$ HU.\n  - Upper limit: $UL = L + \\frac{W}{2} = 90 + \\frac{120}{2} = 150$ HU.\n- **Grayscale Mapping Function**:\n  - For $x \\leq LL$, displayed code is $0$.\n  - For $x \\geq UL$, displayed code is $4095$.\n  - For $LL < x < UL$, displayed code is $d(x) = s\\,(x - LL)$, where $s = \\frac{4095}{UL - LL}$.\n- **Naive Estimator**: The naive estimate of voxel intensity is defined as $Y = \\min\\big(\\max(X, LL), UL\\big)$. This represents a clipping operation on the original data $X$ at the window limits.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is grounded in fundamental principles of medical imaging (CT Hounsfield units, windowing) and statistics (mixture models, Gaussian distributions). The parameters are realistic for CT imaging of soft tissues. This criterion is met.\n- **Well-Posed**: The problem is well-posed. The questions are mathematically precise, and all necessary data and definitions are provided to compute a unique, meaningful solution. This criterion is met.\n- **Objective**: The problem is stated using objective, formal language. There are no subjective or opinion-based claims. This criterion is met.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. It is a standard, formalizable problem in quantitative image analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe probability density function (PDF) of the voxel intensity $X$ is a weighted sum of the two component PDFs:\n$$\np(x) = w_{b} p_{b}(x) + w_{\\ell} p_{\\ell}(x)\n$$\nwhere $p_{b}(x)$ is the PDF of a normal distribution $\\mathcal{N}(\\mu_{b}, \\sigma_{b}^{2})$ and $p_{\\ell}(x)$ is the PDF of a normal distribution $\\mathcal{N}(\\mu_{\\ell}, \\sigma_{\\ell}^{2})$. Let $\\phi(z)$ and $\\Phi(z)$ denote the PDF and cumulative distribution function (CDF) of the standard normal distribution $\\mathcal{N}(0, 1)$, respectively.\n\n**Part 1: Fraction of Clipped Voxels**\n\nA voxel is clipped if its intensity $X$ is outside the window $[LL, UL]$. The fraction of clipped voxels is the probability $P(X \\leq LL \\text{ or } X \\geq UL)$, which can be calculated as $P(X \\leq LL) + P(X \\geq UL)$. By the law of total probability, this is:\n$$\nF_{\\text{clipped}} = w_{b} \\Big( P(X_{b} \\leq LL) + P(X_{b} \\geq UL) \\Big) + w_{\\ell} \\Big( P(X_{\\ell} \\leq LL) + P(X_{\\ell} \\geq UL) \\Big)\n$$\nwhere $X_b \\sim \\mathcal{N}(\\mu_b, \\sigma_b^2)$ and $X_\\ell \\sim \\mathcal{N}(\\mu_\\ell, \\sigma_\\ell^2)$.\n\nWe convert the probabilities to the standard normal CDF $\\Phi(z)$.\nFor the background component:\nThe standardized variables are $Z_{b,LL} = \\frac{LL - \\mu_{b}}{\\sigma_{b}}$ and $Z_{b,UL} = \\frac{UL - \\mu_{b}}{\\sigma_{b}}$.\n$$\nP(X_{b} \\leq LL) = \\Phi(Z_{b,LL}) = \\Phi\\left(\\frac{30 - 50}{20}\\right) = \\Phi(-1.0)\n$$\n$$\nP(X_{b} \\geq UL) = 1 - \\Phi(Z_{b,UL}) = 1 - \\Phi\\left(\\frac{150 - 50}{20}\\right) = 1 - \\Phi(5.0)\n$$\n\nFor the lesion component:\nThe standardized variables are $Z_{\\ell,LL} = \\frac{LL - \\mu_{\\ell}}{\\sigma_{\\ell}}$ and $Z_{\\ell,UL} = \\frac{UL - \\mu_{\\ell}}{\\sigma_{\\ell}}$.\n$$\nP(X_{\\ell} \\leq LL) = \\Phi(Z_{\\ell,LL}) = \\Phi\\left(\\frac{30 - 120}{15}\\right) = \\Phi(-6.0)\n$$\n$$\nP(X_{\\ell} \\geq UL) = 1 - \\Phi(Z_{\\ell,UL}) = 1 - \\Phi\\left(\\frac{150 - 120}{15}\\right) = 1 - \\Phi(2.0)\n$$\n\nThe total fraction of clipped voxels is:\n$$\nF_{\\text{clipped}} = w_{b} \\Big( \\Phi(-1.0) + 1 - \\Phi(5.0) \\Big) + w_{\\ell} \\Big( \\Phi(-6.0) + 1 - \\Phi(2.0) \\Big)\n$$\nUsing standard values for the normal CDF:\n$\\Phi(-1.0) \\approx 0.158655$\n$\\Phi(5.0) \\approx 0.999999713$, so $1 - \\Phi(5.0) \\approx 2.87 \\times 10^{-7}$\n$\\Phi(-6.0) \\approx 9.87 \\times 10^{-10}$\n$\\Phi(2.0) \\approx 0.977250$, so $1 - \\Phi(2.0) \\approx 0.022750$\n\nSubstituting these values:\n$$\nF_{\\text{clipped}} \\approx (0.95) \\cdot (0.158655 + 2.87 \\times 10^{-7}) + (0.05) \\cdot (9.87 \\times 10^{-10} + 0.022750)\n$$\n$$\nF_{\\text{clipped}} \\approx (0.95)(0.158655) + (0.05)(0.022750)\n$$\n$$\nF_{\\text{clipped}} \\approx 0.150722 + 0.0011375 = 0.1518595\n$$\nRounding to four significant figures, $F_{\\text{clipped}} \\approx 0.1519$.\n\n**Part 2: Bias in the Estimated Lesion Mean**\n\nThe bias is defined for the lesion component, so we consider only $X_{\\ell} \\sim \\mathcal{N}(\\mu_{\\ell}, \\sigma_{\\ell}^{2})$. The naive estimator for the lesion is $Y_{\\ell} = \\min\\big(\\max(X_{\\ell}, LL), UL\\big)$. The bias is defined as $\\text{Bias} = E[Y_{\\ell}] - \\mu_{\\ell}$. This can be computed as the expected value of the estimation error, $E[Y_{\\ell} - X_{\\ell}]$.\nThe error $Y_{\\ell} - X_{\\ell}$ is non-zero only when $X_{\\ell}$ is clipped:\n- If $X_{\\ell} \\leq LL$, the error is $LL - X_{\\ell}$.\n- If $LL < X_{\\ell} < UL$, the error is $X_{\\ell} - X_{\\ell} = 0$.\n- If $X_{\\ell} \\geq UL$, the error is $UL - X_{\\ell}$.\n\nThe bias is the expectation of this error over the distribution $p_{\\ell}(x)$:\n$$\n\\text{Bias} = \\int_{-\\infty}^{LL} (LL - x) p_{\\ell}(x) dx + \\int_{UL}^{\\infty} (UL - x) p_{\\ell}(x) dx\n$$\nLet's evaluate these integrals. We use the substitution $z = \\frac{x - \\mu_{\\ell}}{\\sigma_{\\ell}}$, so $x = \\mu_{\\ell} + z\\sigma_{\\ell}$ and $dx = \\sigma_{\\ell} dz$. The PDF becomes $p_{\\ell}(x)dx = \\phi(z)dz$.\nThe integration limits for the first integral are from $-\\infty$ to $a = \\frac{LL - \\mu_{\\ell}}{\\sigma_{\\ell}}$. For the second, from $b = \\frac{UL - \\mu_{\\ell}}{\\sigma_{\\ell}}$ to $\\infty$.\nFirst integral:\n$$\n\\int_{-\\infty}^{a} (LL - (\\mu_{\\ell} + z\\sigma_{\\ell})) \\phi(z) dz = \\int_{-\\infty}^{a} ((LL - \\mu_{\\ell}) - z\\sigma_{\\ell}) \\phi(z) dz\n$$\n$$\n= (LL - \\mu_{\\ell}) \\int_{-\\infty}^{a} \\phi(z) dz - \\sigma_{\\ell} \\int_{-\\infty}^{a} z \\phi(z) dz\n$$\nThe first term is $(LL - \\mu_{\\ell}) \\Phi(a)$. The integral $\\int z\\phi(z)dz = -\\phi(z)$. So the second term is $-\\sigma_{\\ell}[-\\phi(z)]_{-\\infty}^{a} = \\sigma_{\\ell}\\phi(a)$. The result is $(LL - \\mu_{\\ell})\\Phi(a) + \\sigma_{\\ell}\\phi(a)$.\n\nSecond integral:\n$$\n\\int_{b}^{\\infty} (UL - (\\mu_{\\ell} + z\\sigma_{\\ell})) \\phi(z) dz = (UL - \\mu_{\\ell}) \\int_{b}^{\\infty} \\phi(z) dz - \\sigma_{\\ell} \\int_{b}^{\\infty} z \\phi(z) dz\n$$\nThe first term is $(UL - \\mu_{\\ell})(1 - \\Phi(b))$. The second term is $-\\sigma_{\\ell}[-\\phi(z)]_{b}^{\\infty} = -\\sigma_{\\ell}(0 - (-\\phi(b))) = -\\sigma_{\\ell}\\phi(b)$. The result is $(UL - \\mu_{\\ell})(1 - \\Phi(b)) - \\sigma_{\\ell}\\phi(b)$.\n\nCombining the two parts gives the bias:\n$$\n\\text{Bias} = (LL - \\mu_{\\ell})\\Phi(a) + \\sigma_{\\ell}\\phi(a) + (UL - \\mu_{\\ell})(1 - \\Phi(b)) - \\sigma_{\\ell}\\phi(b)\n$$\n$$\n\\text{Bias} = (LL - \\mu_{\\ell})\\Phi(a) + (UL - \\mu_{\\ell})(1 - \\Phi(b)) + \\sigma_{\\ell}(\\phi(a) - \\phi(b))\n$$\nFrom Part 1, we have for the lesion: $a = -6.0$ and $b = 2.0$.\nWe have $\\mu_{\\ell} = 120$, $\\sigma_{\\ell} = 15$, $LL = 30$, $UL = 150$.\n$LL - \\mu_{\\ell} = 30 - 120 = -90$.\n$UL - \\mu_{\\ell} = 150 - 120 = 30$.\n\nWe need the values:\n$\\Phi(-6.0) \\approx 9.8659 \\times 10^{-10}$\n$1 - \\Phi(2.0) \\approx 0.022750$\n$\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$\n$\\phi(-6.0) = \\phi(6.0) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-18) \\approx 6.0758 \\times 10^{-9}$\n$\\phi(2.0) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-2) \\approx 0.053991$\n\nSubstituting these values into the bias equation:\n$$\n\\text{Bias} \\approx (-90)(9.8659 \\times 10^{-10}) + (30)(0.022750) + (15)(6.0758 \\times 10^{-9} - 0.053991)\n$$\n$$\n\\text{Bias} \\approx -8.879 \\times 10^{-8} + 0.68250 - 15 \\cdot (0.053991)\n$$\nThe first term is negligible.\n$$\n\\text{Bias} \\approx 0.68250 - 0.809865 = -0.127365\n$$\nRounding to four significant figures, the bias is $-0.1274$ HU.\n\nThe two requested values are the clipped fraction ($0.1519$) and the bias in the lesion mean ($-0.1274$ HU).", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1519 & -0.1274\n\\end{pmatrix}\n}\n$$", "id": "4880602"}]}