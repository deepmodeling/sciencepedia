{"hands_on_practices": [{"introduction": "The ultimate goal of elastography is to quantify the intrinsic mechanical properties of tissue. This practice connects the measurements from two distinct modalities—strain imaging and shear wave elastography—to the underlying material constants. By working through a hypothetical scenario based on experimental data, you will derive the shear modulus and Poisson’s ratio and explore how measurement errors can impact these estimates, reinforcing the link between observation and physical theory. [@problem_id:4940402]", "problem": "A homogeneous soft tissue phantom is interrogated using strain imaging and shear wave elastography under small-deformation, linear, isotropic elastic conditions. A vertical, quasi-static compression is applied along the axial direction $z$ while the lateral faces are constrained so that lateral deformation is suppressed (lateral confinement). A steady axial Cauchy stress $\\,\\sigma_{zz}\\,$ and axial engineering strain $\\,\\epsilon_{zz}\\,$ are measured from force sensing and ultrasound speckle tracking, respectively. In a separate acquisition using Acoustic Radiation Force Impulse (ARFI) shear wave elastography, the shear wave speed $\\,c_{s}\\,$ is measured in the same region of interest. The tissue mass density is known.\n\nAssume the following experimentally determined values:\n- $\\,\\rho = 1000\\ \\mathrm{kg\\ m^{-3}}\\,$,\n- $\\,c_{s} = 3.00\\ \\mathrm{m\\ s^{-1}}\\,$,\n- $\\,\\sigma_{zz} = -2.25\\ \\mathrm{kPa}\\,$ at $\\,\\epsilon_{zz} = -0.010\\,$.\n\nAssume lateral confinement implies $\\,\\epsilon_{xx} = \\epsilon_{yy} = 0\\,$ in the true state. However, the lateral strain tracking algorithm may report a small spurious lateral strain $\\,\\epsilon_{xx} = e\\,$ (with $\\,\\epsilon_{yy}=e\\,$ by symmetry), which an analyst might mistakenly use in a direct inversion of the three-dimensional isotropic constitutive law to estimate Poisson’s ratio.\n\nStarting only from the fundamental constitutive relations for linear, isotropic elasticity and the definition of shear wave speed in a linear elastic solid, do the following:\n1) Determine the shear modulus $\\,\\mu\\,$ from $\\,\\rho\\,$ and $\\,c_{s}\\,$.\n2) Using the measured $\\,\\sigma_{zz}\\,$ and $\\,\\epsilon_{zz}\\,$ under lateral confinement and your value of $\\,\\mu\\,$, determine Poisson’s ratio $\\,\\nu\\,$.\n3) If an analyst instead estimates $\\,\\nu\\,$ by inserting the measured $\\,\\epsilon_{xx}=e\\,$ (with $\\,\\epsilon_{yy}=e\\,$) into the three-dimensional isotropic stress–strain relation for $\\,\\sigma_{zz}\\,$, compute the first-order sensitivity of the estimated Poisson’s ratio to this lateral strain measurement at $\\,e=0\\,$; that is, evaluate $\\,\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0}\\,$.\n\nReport your final answer as a row vector containing, in order: $\\,\\mu\\,$ expressed in $\\mathrm{kPa}$, $\\,\\nu\\,$ (dimensionless), and $\\,\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0}\\,$ (dimensionless). Round each entry to four significant figures. Do not include units in your final boxed answer; state units only in the text as requested.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All provided data are physically realistic for soft tissues and the tasks are based on fundamental principles of continuum mechanics and wave propagation. The problem is self-contained and free of contradictions.\n\nThe solution is divided into three parts as requested by the problem statement.\n\n**Part 1: Determination of the Shear Modulus, $\\mu$**\n\nThe propagation of shear waves in a linear, isotropic, elastic solid is governed by the wave equation. The speed of these waves, $c_s$, is related to the material's shear modulus, $\\mu$, and its mass density, $\\rho$, by the fundamental relation:\n$$c_s = \\sqrt{\\frac{\\mu}{\\rho}}$$\nTo determine the shear modulus, $\\mu$, we can rearrange this equation:\n$$\\mu = \\rho c_s^2$$\nThe problem provides the following values:\n-   Mass density, $\\rho = 1000 \\ \\mathrm{kg\\ m^{-3}}$\n-   Shear wave speed, $c_s = 3.00 \\ \\mathrm{m\\ s^{-1}}$\n\nSubstituting these values into the equation for $\\mu$:\n$$\\mu = (1000 \\ \\mathrm{kg\\ m^{-3}}) \\times (3.00 \\ \\mathrm{m\\ s^{-1}})^2$$\n$$\\mu = 1000 \\times 9.00 \\ \\mathrm{kg\\ m^{-1}\\ s^{-2}}$$\n$$\\mu = 9000 \\ \\mathrm{Pa}$$\nThe problem asks for the value of $\\mu$ to be expressed in kilopascals ($\\mathrm{kPa}$). Since $1 \\ \\mathrm{kPa} = 1000 \\ \\mathrm{Pa}$, we have:\n$$\\mu = 9.00 \\ \\mathrm{kPa}$$\n\n**Part 2: Determination of Poisson’s Ratio, $\\nu$**\n\nThe constitutive relation for a linear, isotropic elastic material, also known as the generalized Hooke's Law, relates the Cauchy stress tensor, $\\sigma_{ij}$, to the engineering strain tensor, $\\epsilon_{ij}$, as follows:\n$$\\sigma_{ij} = \\lambda \\delta_{ij} \\epsilon_{kk} + 2\\mu \\epsilon_{ij}$$\nHere, $\\lambda$ is Lamé's first parameter, $\\mu$ is the shear modulus, $\\delta_{ij}$ is the Kronecker delta, and $\\epsilon_{kk} = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$ is the trace of the strain tensor, representing the volumetric strain.\n\nThe experiment is conducted under a condition of lateral confinement, which implies that the strains in the lateral directions ($x$ and $y$) are zero:\n$$\\epsilon_{xx} = 0, \\quad \\epsilon_{yy} = 0$$\nFor the axial stress component, $\\sigma_{zz}$ (where $i=j=z$), the constitutive relation becomes:\n$$\\sigma_{zz} = \\lambda(\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\nSubstituting the lateral confinement conditions:\n$$\\sigma_{zz} = \\lambda(0 + 0 + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n$$\\sigma_{zz} = (\\lambda + 2\\mu) \\epsilon_{zz}$$\nThe Lamé parameters $\\lambda$ and $\\mu$ are related to Poisson's ratio, $\\nu$, by the expression:\n$$\\lambda = \\frac{2\\mu\\nu}{1 - 2\\nu}$$\nSubstituting this into the equation for $\\sigma_{zz}$:\n$$\\sigma_{zz} = \\left(\\frac{2\\mu\\nu}{1 - 2\\nu} + 2\\mu\\right) \\epsilon_{zz}$$\nFactoring out $2\\mu$:\n$$\\sigma_{zz} = 2\\mu \\left(\\frac{\\nu}{1 - 2\\nu} + 1\\right) \\epsilon_{zz} = 2\\mu \\left(\\frac{\\nu + 1 - 2\\nu}{1 - 2\\nu}\\right) \\epsilon_{zz}$$\n$$\\sigma_{zz} = 2\\mu \\left(\\frac{1 - \\nu}{1 - 2\\nu}\\right) \\epsilon_{zz}$$\nTo find $\\nu$, we rearrange this equation. Let us define a dimensionless quantity $K$:\n$$K = \\frac{\\sigma_{zz}}{2\\mu \\epsilon_{zz}}$$\nThen, we have:\n$$K = \\frac{1 - \\nu}{1 - 2\\nu}$$\n$$K(1 - 2\\nu) = 1 - \\nu$$\n$$K - 2K\\nu = 1 - \\nu$$\n$$K - 1 = 2K\\nu - \\nu = \\nu(2K - 1)$$\n$$\\nu = \\frac{K - 1}{2K - 1}$$\nWe are given the experimental values:\n-   $\\sigma_{zz} = -2.25 \\ \\mathrm{kPa} = -2250 \\ \\mathrm{Pa}$\n-   $\\epsilon_{zz} = -0.010$\n-   $\\mu = 9000 \\ \\mathrm{Pa}$ (from Part 1)\n\nFirst, we calculate $K$:\n$$K = \\frac{-2250 \\ \\mathrm{Pa}}{2 \\times (9000 \\ \\mathrm{Pa}) \\times (-0.010)} = \\frac{-2250}{-180} = 12.5$$\nNow, we calculate $\\nu$:\n$$\\nu = \\frac{12.5 - 1}{2(12.5) - 1} = \\frac{11.5}{25 - 1} = \\frac{11.5}{24} = \\frac{23}{48}$$\nAs a decimal, $\\nu \\approx 0.479166...$.\n\n**Part 3: Sensitivity of the Estimated Poisson’s Ratio**\n\nAn analyst mistakenly uses a spurious lateral strain measurement, $\\epsilon_{xx} = e$ and $\\epsilon_{yy} = e$, in the constitutive relationship. The relevant stress component is still $\\sigma_{zz}$:\n$$\\sigma_{zz} = \\lambda(\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\nSubstituting the spurious strains:\n$$\\sigma_{zz} = \\lambda(e + e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz} = \\lambda(2e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\nWe again substitute $\\lambda = \\frac{2\\mu\\nu}{1 - 2\\nu}$. Here, $\\nu$ is the estimated Poisson's ratio, which is now a function of $e$.\n$$\\sigma_{zz} = \\frac{2\\mu\\nu(e)}{1 - 2\\nu(e)}(2e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\nTo find the sensitivity $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\left.\\frac{d\\nu}{de}\\right|_{e=0}$, we can use implicit differentiation with respect to $e$. The quantities $\\sigma_{zz}$, $\\epsilon_{zz}$, and $\\mu$ are treated as constants.\n$$0 = \\frac{d}{de} \\left[ \\frac{2\\mu\\nu(e)}{1-2\\nu(e)}(2e + \\epsilon_{zz}) \\right] + 0$$\nApplying the product rule and chain rule:\n$$0 = 2\\mu \\left[ \\frac{d}{de}\\left(\\frac{\\nu}{1-2\\nu}\\right) (2e + \\epsilon_{zz}) + \\frac{\\nu}{1-2\\nu} \\frac{d}{de}(2e+\\epsilon_{zz}) \\right]$$\nThe derivative of $\\frac{\\nu}{1-2\\nu}$ with respect to $\\nu$ is $\\frac{1}{(1-2\\nu)^2}$. The derivative of $(2e+\\epsilon_{zz})$ with respect to $e$ is $2$.\n$$0 = \\frac{1}{(1-2\\nu)^2} \\frac{d\\nu}{de} (2e + \\epsilon_{zz}) + \\frac{\\nu}{1-2\\nu} (2)$$\nWe want to evaluate this at $e=0$. At $e=0$, the estimated Poisson's ratio $\\nu$ must be equal to the true value calculated in Part 2, which we denote as $\\nu_0 = 23/48$.\n$$0 = \\frac{1}{(1-2\\nu_0)^2} \\left.\\frac{d\\nu}{de}\\right|_{e=0} (\\epsilon_{zz}) + \\frac{2\\nu_0}{1-2\\nu_0}$$\nSolving for the derivative:\n$$\\frac{1}{(1-2\\nu_0)^2} \\left.\\frac{d\\nu}{de}\\right|_{e=0} \\epsilon_{zz} = -\\frac{2\\nu_0}{1-2\\nu_0}$$\n$$\\left.\\frac{d\\nu}{de}\\right|_{e=0} = -\\frac{2\\nu_0}{1-2\\nu_0} \\cdot (1-2\\nu_0)^2 \\cdot \\frac{1}{\\epsilon_{zz}}$$\n$$\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\frac{-2\\nu_0(1-2\\nu_0)}{\\epsilon_{zz}}$$\nWe have $\\nu_0 = 23/48$ and $\\epsilon_{zz} = -0.010$.\nFirst, calculate $1-2\\nu_0$:\n$$1 - 2\\nu_0 = 1 - 2\\left(\\frac{23}{48}\\right) = 1 - \\frac{23}{24} = \\frac{1}{24}$$\nNow, substitute the values into the derivative expression:\n$$\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\frac{-2 \\left(\\frac{23}{48}\\right) \\left(\\frac{1}{24}\\right)}{-0.010} = \\frac{2 \\cdot \\frac{23}{48 \\cdot 24}}{0.01} = \\frac{\\frac{46}{1152}}{\\frac{1}{100}} = \\frac{4600}{1152}$$\nReducing the fraction:\n$$\\frac{4600}{1152} = \\frac{2300}{576} = \\frac{1150}{288} = \\frac{575}{144}$$\nAs a decimal, this is approximately $3.993055...$.\n\n**Final Answer Summary:**\n\nThe problem requires reporting the three calculated values, rounded to four significant figures, in a row vector.\n1.  $\\mu = 9.00 \\ \\mathrm{kPa}$. Rounded to four significant figures, this is $9.000 \\ \\mathrm{kPa}$.\n2.  $\\nu = 23/48 \\approx 0.479166...$. Rounded to four significant figures, this is $0.4792$.\n3.  $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = 575/144 \\approx 3.993055...$. Rounded to four significant figures, this is $3.993$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9.000 & 0.4792 & 3.993\n\\end{pmatrix}\n}\n$$", "id": "4940402"}, {"introduction": "Interpreting an elastogram requires careful consideration of the physical context, as the measured strain does not always directly reflect the tissue's true stiffness. This exercise demonstrates a critical ambiguity where a soft inclusion can appear artificially stiff due to mechanical constraints, a common challenge in clinical practice. You will analyze how different boundary conditions create this artifact in strain imaging and see how shear wave elastography, by measuring a different physical quantity, provides a more robust assessment. [@problem_id:4940413]", "problem": "You are given a synthetic, one-dimensional layered elastic medium intended to probe contrast ambiguities in Ultrasound Elastography (UE) when a soft inclusion is positioned beneath a hard superficial shell. Your goal is to construct a quantitative demonstration in which the apparent strain contrast reverses its sign under certain boundary conditions, and then design boundary conditions that recover the correct contrast sign. Work under the small deformation, linear, isotropic elasticity regime and use first principles.\n\nStart from the following foundational base:\n- Let $E$ denote the Young’s modulus, $\\nu$ the Poisson’s ratio, $\\mu$ the shear modulus, $\\rho$ the mass density, $\\boldsymbol{\\sigma}$ the Cauchy stress, and $\\boldsymbol{\\epsilon}$ the strain. For isotropic linear elasticity, use Hooke’s law in the form $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I}$ with Lamé parameters $\\lambda$ and $\\mu$, and the known relationships between $(E,\\nu)$ and $(\\lambda,\\mu)$.\n- For shear waves, use the shear wave speed formula $c_s = \\sqrt{\\mu / \\rho}$.\n\nConsider a two-layer stack in series along the axial direction $z$: a top hard shell with $(E_h,\\nu_h,\\rho_h)$ and a deeper soft inclusion with $(E_s,\\nu_s,\\rho_s)$. A uniform compressive pressure $p$ is applied at the top surface, inducing an axial stress $\\sigma_z = p$ everywhere (static equilibrium in series). Assume equal cross-sectional area for both layers and neglect body forces.\n\nTwo measurement boundary-condition modes are defined:\n1. Mode Free (plane stress, lateral stress-free): lateral stresses vanish, $\\sigma_x = \\sigma_y = 0$ everywhere.\n2. Mode Constrained (mixed mode): the superficial shell remains in plane stress ($\\sigma_x = \\sigma_y = 0$), while the soft inclusion is laterally constrained (plane strain), $\\epsilon_x = \\epsilon_y = 0$ in the inclusion.\n\nYour program must, for each test case, perform the following steps based only on the foundational base above:\n1. Derive the axial strain $\\epsilon_z$ in each layer for Mode Free and Mode Constrained from Hooke’s law and isotropy, starting from the definitions and relationships among $E$, $\\nu$, and $\\mu$.\n2. Define a naive apparent modulus under a plane-stress interpretation as $E_{\\text{app}} = p / \\epsilon_z$ for any measured axial strain $\\epsilon_z$ (this mimics interpreting strain images as inversely proportional to stiffness under the plane stress assumption).\n3. Under Mode Constrained, treat the hard shell measurement as plane stress (consistent with its boundary condition) and the soft inclusion measurement as plane strain (consistent with its boundary condition). Compute $E_{\\text{app},h}$ and $E_{\\text{app},s}$ accordingly and determine ambiguity as a boolean: ambiguous is true if the naive classification would label the inclusion as stiffer than the shell, i.e., if $E_{\\text{app},s} > E_{\\text{app},h}$ while the ground truth has $E_s < E_h$.\n4. Under Mode Free, both layers are in plane stress. Compute $E_{\\text{app},h}$ and $E_{\\text{app},s}$ and report whether this boundary condition resolves the contrast sign as a boolean: resolved is true if $E_{\\text{app},s} < E_{\\text{app},h}$ whenever $E_s < E_h$.\n5. Independently, compute the shear wave speeds in each layer, $c_{s,h} = \\sqrt{\\mu_h / \\rho_h}$ and $c_{s,s} = \\sqrt{\\mu_s / \\rho_s}$, with $\\mu = E/(2(1+\\nu))$, to demonstrate a boundary-condition-insensitive contrast modality (Shear Wave Elastography (SWE)). Report an integer shear_sign defined as $+1$ if $c_{s,h} > c_{s,s}$ and $-1$ otherwise.\n\nExpress all inputs in their specified physical units and compute outputs numerically:\n- Young’s moduli $E_h$, $E_s$ in kilopascals ($\\mathrm{kPa}$).\n- Pressure $p$ in kilopascals ($\\mathrm{kPa}$).\n- Densities $\\rho_h$, $\\rho_s$ in kilograms per cubic meter ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$).\n- Poisson’s ratios $\\nu_h$, $\\nu_s$ are dimensionless.\n- Axial strains $\\epsilon_z$ are dimensionless.\n- Shear wave speeds $c_s$ in meters per second ($\\mathrm{m}\\,\\mathrm{s}^{-1}$), but you only need the sign comparison as described.\n\nTest suite:\n- Case $1$ (happy path ambiguity): $E_h = 100\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.49$, $\\nu_s = 0.49$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 2\\,\\mathrm{kPa}$.\n- Case $2$ (boundary condition edge, more compressible): $E_h = 100\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.30$, $\\nu_s = 0.30$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 2\\,\\mathrm{kPa}$.\n- Case $3$ (near-modulus boundary, incompressible-like): $E_h = 12\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.49$, $\\nu_s = 0.49$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 1\\,\\mathrm{kPa}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three-element lists, one per test case, enclosed in square brackets. Each inner list must be of the form $[\\text{ambiguous}, \\text{resolved}, \\text{shear\\_sign}]$, where ambiguous and resolved are booleans and shear_sign is an integer. For example, the output should look like $[[\\text{True},\\text{False},1],[\\text{False},\\text{True},-1]]$ for two cases.", "solution": "The problem is deemed valid as it is scientifically grounded in the principles of linear elasticity, well-posed, objective, and internally consistent under the reasonable interpretation of a positive compression convention.\n\nThe analysis proceeds by deriving the axial strain under different boundary conditions from the first principles of continuum mechanics. We consider a two-layer medium, a hard superficial shell (h) and a soft deep inclusion (s), under a uniform axial compressive stress $\\sigma_z = p$. We adopt a convention where compressive stress and strain are positive. All material properties are assumed to be isotropic and linear elastic.\n\nThe fundamental constitutive relation is Hooke's law, given in terms of the Cauchy stress tensor $\\boldsymbol{\\sigma}$ and the infinitesimal strain tensor $\\boldsymbol{\\epsilon}$:\n$$ \\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I} $$\nwhere $\\mu$ is the shear modulus, $\\lambda$ is the first Lamé parameter, $\\operatorname{tr}(\\cdot)$ is the trace operator, and $\\mathbf{I}$ is the identity tensor. The elastic parameters $(\\lambda, \\mu)$ are related to Young's modulus $E$ and Poisson's ratio $\\nu$ by:\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\nAn inverted form of Hooke's law, expressing strain in terms of stress, is often more convenient:\n$$ \\epsilon_{ij} = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_{ij} - \\nu \\operatorname{tr}(\\boldsymbol{\\sigma}) \\delta_{ij} \\right] $$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\n**1. Derivation of Axial Strain $\\epsilon_z$**\n\nWe derive the axial strain $\\epsilon_z$ for the two specified boundary condition modes.\n\n**Mode Free (Plane Stress):**\nThis condition is defined by $\\sigma_x = \\sigma_y = 0$. It is applied to both layers in the \"Mode Free\" case, and to the hard shell in the \"Mode Constrained\" case. Using the inverted Hooke's law for the axial component $\\epsilon_z = \\epsilon_{zz}$:\n$$ \\epsilon_z = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_z - \\nu (\\sigma_x + \\sigma_y + \\sigma_z) \\right] $$\nSubstituting $\\sigma_x = 0$, $\\sigma_y = 0$, and the applied axial stress $\\sigma_z = p$:\n$$ \\epsilon_{z, \\text{stress}} = \\frac{1}{E} \\left[ (1+\\nu)p - \\nu (0 + 0 + p) \\right] = \\frac{1}{E} [p + \\nu p - \\nu p] = \\frac{p}{E} $$\nThus, for any layer under plane stress conditions, the axial strain is simply $\\epsilon_z = p/E$.\n\n**Mode Constrained (Plane Strain in Inclusion):**\nThis condition is defined by $\\epsilon_x = \\epsilon_y = 0$ and applies to the soft inclusion in the \"Mode Constrained\" case. We use the original form of Hooke's law. The axial stress component $\\sigma_z$ is:\n$$ \\sigma_z = \\lambda(\\epsilon_x + \\epsilon_y + \\epsilon_z) + 2\\mu\\epsilon_z $$\nSubstituting $\\epsilon_x = 0$ and $\\epsilon_y = 0$:\n$$ \\sigma_z = \\lambda \\epsilon_z + 2\\mu \\epsilon_z = (\\lambda + 2\\mu) \\epsilon_z $$\nGiven $\\sigma_z = p$, the axial strain is:\n$$ \\epsilon_{z, \\text{strain}} = \\frac{p}{\\lambda + 2\\mu} $$\nThe quantity $M = \\lambda + 2\\mu$ is the longitudinal or P-wave modulus. We express it in terms of $E$ and $\\nu$:\n$$ M = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + 2 \\frac{E}{2(1+\\nu)} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} $$\n$$ M = \\frac{E}{1+\\nu} \\left( \\frac{\\nu}{1-2\\nu} + 1 \\right) = \\frac{E}{1+\\nu} \\left( \\frac{\\nu + 1 - 2\\nu}{1-2\\nu} \\right) = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\nTherefore, for a layer under plane strain, the axial strain is:\n$$ \\epsilon_{z, \\text{strain}} = p \\frac{(1+\\nu)(1-2\\nu)}{E(1-\\nu)} $$\n\n**2. Apparent Modulus and Contrast Ambiguity (Mode Constrained)**\n\nThe problem defines a \"naive apparent modulus\" as $E_{\\text{app}} = p / \\epsilon_z$. This mimics an imaging scenario where all measured strain is interpreted via the simple plane stress relationship, $E = p/\\epsilon_z$.\n\nIn \"Mode Constrained\":\n- The hard shell is in plane stress, so $\\epsilon_{z,h} = p/E_h$. The apparent modulus is $E_{\\text{app},h} = p / \\epsilon_{z,h} = E_h$. The naive measurement is correct.\n- The soft inclusion is in plane strain, so $\\epsilon_{z,s} = p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}$. The naive apparent modulus is:\n  $$ E_{\\text{app},s} = \\frac{p}{\\epsilon_{z,s}} = \\frac{p}{p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}} = E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} $$\nAmbiguity, or contrast reversal, occurs when the soft inclusion is measured to be stiffer than the hard shell, i.e., $E_{\\text{app},s} > E_{\\text{app},h}$, despite the ground truth being $E_s < E_h$. The condition for ambiguity is:\n$$ E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} > E_h $$\nThis inequality shows that ambiguity is highly dependent on Poisson's ratio $\\nu_s$. As $\\nu_s$ approaches $0.5$ (the incompressible limit), the denominator $(1-2\\nu_s)$ approaches zero, causing $E_{\\text{app},s}$ to become very large, which can easily exceed $E_h$ even if $E_s$ is much smaller than $E_h$.\n\n**3. Contrast Resolution (Mode Free)**\n\nIn \"Mode Free\", both layers are in plane stress.\n- Hard shell: $\\epsilon_{z,h} = p/E_h$, so $E_{\\text{app},h} = p/\\epsilon_{z,h} = E_h$.\n- Soft inclusion: $\\epsilon_{z,s} = p/E_s$, so $E_{\\text{app},s} = p/\\epsilon_{z,s} = E_s$.\nIn this mode, the apparent moduli are equal to the true Young's moduli. The \"resolved\" condition is $E_{\\text{app},s} < E_{\\text{app},h}$ for a ground truth of $E_s < E_h$. This simplifies to $E_s < E_h$, which is true by construction. Therefore, the plane stress boundary condition correctly reflects the stiffness contrast.\n\n**4. Shear Wave Elastography (SWE)**\n\nSWE provides a measurement of stiffness that is independent of the compressive boundary conditions. It measures the shear wave speed, $c_s = \\sqrt{\\mu/\\rho}$. The shear modulus $\\mu$ is related to $E$ and $\\nu$ by $\\mu = E/(2(1+\\nu))$.\n- Hard shell: $c_{s,h} = \\sqrt{\\frac{\\mu_h}{\\rho_h}} = \\sqrt{\\frac{E_h}{2(1+\\nu_h)\\rho_h}}$.\n- Soft inclusion: $c_{s,s} = \\sqrt{\\frac{\\mu_s}{\\rho_s}} = \\sqrt{\\frac{E_s}{2(1+\\nu_s)\\rho_s}}$.\nThe sign of the stiffness contrast is determined by comparing $c_{s,h}$ and $c_{s,s}$. The `shear_sign` is $+1$ if $c_{s,h} > c_{s,s}$ and $-1$ otherwise. This comparison is equivalent to checking the sign of $(\\mu_h/\\rho_h) - (\\mu_s/\\rho_s)$. Since shear properties depend only on $\\mu$ and $\\rho$, they are not affected by the axial loading conditions ($\\sigma_z, \\epsilon_x, \\epsilon_y$).\n\nThis comprehensive theoretical framework is now applied to the specific test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ultrasound elastography contrast ambiguity problem\n    for the given test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Eh, Es, nu_h, nu_s, rho_h, rho_s, p)\n    # Units: E in kPa, rho in kg/m^3, p in kPa, nu is dimensionless.\n    test_cases = [\n        (100.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 2.0),\n        (100.0, 10.0, 0.30, 0.30, 1000.0, 1000.0, 2.0),\n        (12.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Eh, Es, nu_h, nu_s, rho_h, rho_s, p = case\n        \n        # Ground truth: The soft inclusion is indeed softer than the hard shell.\n        ground_truth_softness = Es < Eh\n\n        # --- Task 3: Mode Constrained Analysis ---\n        \n        # The hard shell is in plane stress. Its naive apparent modulus measurement\n        # is correct and equals its true Young's modulus.\n        E_app_h_constrained = Eh\n        \n        # The soft inclusion is in plane strain, but its strain is naively interpreted\n        # using the plane stress formula E_app = p / epsilon_z.\n        # From first principles, the axial strain in plane strain is:\n        # epsilon_z_s = p * (1+nu_s)(1-2*nu_s) / (Es * (1-nu_s))\n        # The naive apparent modulus is therefore:\n        # E_app_s = p / epsilon_z_s = Es * (1-nu_s) / ((1+nu_s)*(1-2*nu_s))\n        \n        # Handle the near-incompressible case to avoid division by zero.\n        if nu_s >= 0.5:\n            # For a perfectly incompressible material (nu=0.5), a plane strain\n            # compression is impossible, and the apparent modulus is infinite.\n            E_app_s_constrained = float('inf')\n        else:\n            E_app_s_constrained = Es * (1.0 - nu_s) / ((1.0 + nu_s) * (1.0 - 2.0 * nu_s))\n        \n        # Ambiguity is true if the naive measurement makes the soft layer appear harder,\n        # reversing the true stiffness contrast.\n        ambiguous = (E_app_s_constrained > E_app_h_constrained) and ground_truth_softness\n\n        # --- Task 4: Mode Free Analysis ---\n        \n        # In this mode, both layers are in plane stress. The naive apparent modulus\n        # measurement is correct for both.\n        E_app_h_free = Eh\n        E_app_s_free = Es\n        \n        # Resolved is true if the measurement correctly shows the soft layer is softer.\n        resolved = (E_app_s_free < E_app_h_free) and ground_truth_softness\n        \n        # --- Task 5: Shear Wave Elastography Analysis ---\n        \n        # Shear modulus is defined as mu = E / (2*(1+nu)).\n        mu_h = Eh / (2.0 * (1.0 + nu_h))\n        mu_s = Es / (2.0 * (1.0 + nu_s))\n        \n        # Shear wave speed squared is proportional to mu/rho. We only need to compare\n        # this ratio. Unit conversions for E (kPa to Pa) cancel out.\n        cs_sq_h = mu_h / rho_h\n        cs_sq_s = mu_s / rho_s\n        \n        # The shear_sign indicates the stiffness contrast measured by SWE.\n        shear_sign = 1 if cs_sq_h > cs_sq_s else -1\n        \n        results.append([ambiguous, resolved, shear_sign])\n\n    # Final print statement must produce the single-line format specified.\n    # The str() of a Python list is '[item1, item2, ...]' which matches the required\n    # inner list format. The f-string constructs the final outer list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4940413"}, {"introduction": "Implementing shear wave elastography effectively involves navigating a series of practical trade-offs to ensure both diagnostic quality and patient safety. This problem places you in the role of a system designer, tasked with optimizing acquisition parameters for an acoustic radiation force impulse (ARFI) sequence. You will balance the need for a strong signal-to-noise ratio against strict regulatory limits on acoustic intensity, a fundamental challenge in the development of all ultrasound technologies. [@problem_id:4940426]", "problem": "A shear-wave elastography system generates shear waves by delivering a focused acoustic push beam with spatial-peak pulse-average intensity (SPPA), denoted by $I_{\\mathrm{SPPA}}$, for a push duration $ \\tau_{\\mathrm{push}}$, repeated at a push repetition frequency $ f_{\\mathrm{rep}}$. The imaging sequence also includes ongoing diagnostic imaging that contributes a constant baseline spatial-peak temporal-average intensity (SPTA), denoted by $I_{\\mathrm{SPTA,base}}$. The regulatory limit on the total SPTA is $I_{\\mathrm{SPTA,lim}}$.\n\nAssume the following foundational relationships:\n- The spatial-peak temporal-average intensity is the temporal average of the spatial-peak intensity over a cycle, so the push contribution to SPTA is $I_{\\mathrm{SPPA}} \\times (\\tau_{\\mathrm{push}} f_{\\mathrm{rep}})$, and the total SPTA is $I_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\tau_{\\mathrm{push}} f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}$.\n- From prior calibration on a homogeneous soft-tissue phantom, the shear wave signal-to-noise ratio (SNR), denoted by $\\mathrm{SNR}$, scales linearly with the push intensity-time product as $\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}$, where $k$ is a known proportionality constant determined by the system and the tissue class under test.\n\nGiven the following parameters:\n- $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$,\n- $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}$,\n- Target shear wave $\\mathrm{SNR}_{\\mathrm{target}} = 12$,\n- $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$,\n- $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$,\n\nDesign the push parameters to minimize the push on-time while meeting the target shear wave $\\mathrm{SNR}_{\\mathrm{target}}$, and then compute the maximum permissible $ f_{\\mathrm{rep}} $ that still satisfies the SPTA regulatory limit. Specifically:\n1. Choose $ \\tau_{\\mathrm{push}} $ to be the minimum value that achieves $ \\mathrm{SNR}_{\\mathrm{target}} $.\n2. Using that choice of $ \\tau_{\\mathrm{push}} $, determine the maximum allowable push repetition frequency $ f_{\\mathrm{rep,max}} $ such that $ I_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}} $.\n\nExpress the final numerical answer for $ f_{\\mathrm{rep,max}} $ in $\\mathrm{Hz}$, and round your answer to four significant figures.", "solution": "The solution proceeds in two parts as specified by the problem statement. First, we determine the minimum push duration, $\\tau_{\\mathrm{push}}$, required to meet the target signal-to-noise ratio. Second, using this calculated duration, we find the maximum push repetition frequency, $f_{\\mathrm{rep,max}}$, that complies with the regulatory intensity limit.\n\n**Part 1: Determine the minimum push duration $\\tau_{\\mathrm{push}}$**\n\nThe signal-to-noise ratio ($\\mathrm{SNR}$) is given by the linear relationship:\n$$\n\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}\n$$\nTo achieve the target $\\mathrm{SNR}$, denoted $\\mathrm{SNR}_{\\mathrm{target}}$, while minimizing the push duration $\\tau_{\\mathrm{push}}$, we set the equation to an equality:\n$$\n\\mathrm{SNR}_{\\mathrm{target}} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}\n$$\nSolving for $\\tau_{\\mathrm{push}}$ gives:\n$$\n\\tau_{\\mathrm{push}} = \\frac{\\mathrm{SNR}_{\\mathrm{target}}}{k \\, I_{\\mathrm{SPPA}}}\n$$\nNow, we substitute the given values: $\\mathrm{SNR}_{\\mathrm{target}} = 12$, $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}$, and $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$.\n$$\n\\tau_{\\mathrm{push}} = \\frac{12}{(5.0 \\times 10^{-3}) \\times (4.0 \\times 10^{5})}\n$$\nFirst, calculate the product in the denominator:\n$$\nk \\, I_{\\mathrm{SPPA}} = (5.0 \\times 4.0) \\times (10^{-3} \\times 10^{5}) = 20.0 \\times 10^{2} = 2.0 \\times 10^{3} \\ \\mathrm{s}^{-1}\n$$\nNow, we compute $\\tau_{\\mathrm{push}}$:\n$$\n\\tau_{\\mathrm{push}} = \\frac{12}{2.0 \\times 10^{3}} = 6.0 \\times 10^{-3} \\ \\mathrm{s}\n$$\nThis is the minimum push duration required to achieve the target SNR.\n\n**Part 2: Determine the maximum push repetition frequency $f_{\\mathrm{rep,max}}$**\n\nThe total spatial-peak temporal-average intensity, $I_{\\mathrm{SPTA,tot}}$, is given as the sum of the push pulse contribution and the baseline imaging contribution:\n$$\nI_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}\n$$\nThe regulatory constraint is that this total intensity must not exceed a specified limit, $I_{\\mathrm{SPTA,lim}}$:\n$$\nI_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}}\n$$\nTo find the maximum permissible push repetition frequency, $f_{\\mathrm{rep,max}}$, we set the total intensity to its upper limit:\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep,max}} + I_{\\mathrm{SPTA,base}} = I_{\\mathrm{SPTA,lim}}\n$$\nWe solve this equation for $f_{\\mathrm{rep,max}}$:\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep,max}} = I_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}}\n$$\n$$\nf_{\\mathrm{rep,max}} = \\frac{I_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}}}{I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}}\n$$\nWe substitute the known and previously calculated values: $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$, $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$, $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$, and $\\tau_{\\mathrm{push}} = 6.0 \\times 10^{-3} \\ \\mathrm{s}$.\n\nFirst, calculate the numerator:\n$$\nI_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}} = (7.2 \\times 10^{3}) - (1.2 \\times 10^{3}) = (7.2 - 1.2) \\times 10^{3} = 6.0 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}\n$$\nNext, calculate the denominator (the intensity-time product of a single push):\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} = (4.0 \\times 10^{5}) \\times (6.0 \\times 10^{-3}) = 24.0 \\times 10^{2} = 2.4 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{s} \\, \\mathrm{m}^{-2}\n$$\nFinally, compute $f_{\\mathrm{rep,max}}$:\n$$\nf_{\\mathrm{rep,max}} = \\frac{6.0 \\times 10^{3}}{2.4 \\times 10^{3}} = \\frac{6.0}{2.4} = 2.5 \\ \\mathrm{Hz}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nf_{\\mathrm{rep,max}} = 2.500 \\ \\mathrm{Hz}\n$$", "answer": "$$\n\\boxed{2.500}\n$$", "id": "4940426"}]}