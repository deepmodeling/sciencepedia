{"hands_on_practices": [{"introduction": "One of the most intuitive ways to fuse two images is through a weighted average, known as convex combination. However, since images from different modalities like Positron Emission Tomography (PET) and Magnetic Resonance (MR) have vastly different and often arbitrary intensity scales, a direct combination is not meaningful. This exercise [@problem_id:4891123] provides a foundational, hands-on method for deriving a principled scaling law. By using basic statistical properties like mean and standard deviation, you will learn how to make two disparate datasets \"speak the same language,\" ensuring a scientifically interpretable and unbiased fusion.", "problem": "A hospital research lab aims to fuse a Positron Emission Tomography (PET) image and a Magnetic Resonance (MR) magnitude image using convex combination fusion to jointly visualize metabolism and anatomy. Let the PET image be represented by the voxelwise Standardized Uptake Value (SUV), denoted by $S$, and the MR image intensities by $M$. The fusion uses the model $F = w M + (1 - w) g(S)$, where $w \\in [0,1]$ and $g$ is a deterministic mapping that rescales PET SUV to an MR-compatible intensity scale.\n\nFor scientifically interpretable fusion across tissues, the lab requires that the fusion does not bias tissue contrasts. Operationally, take “not biasing tissue contrasts” to mean that around background tissue levels, equal standardized changes (one standard deviation) in either modality produce equal magnitude changes in the fused image when $w = \\frac{1}{2}$, and that the fused background level matches the MR background level. Assume the following well-tested statistical facts for image intensities in a homogeneous region-of-interest: mean intensity $\\mu$ and standard deviation $\\sigma$ characterize the typical background level and scale of fluctuations, and a linear mapping preserves ordering and scales mean and variance in a controllable way.\n\nThe lab measured region-of-interest statistics and found:\n- MR mean $\\mu_{\\mathrm{MR}} = 600$ (arbitrary MR units) and MR standard deviation $\\sigma_{\\mathrm{MR}} = 80$,\n- PET mean $\\mu_{\\mathrm{PET}} = 2.0$ (SUV) and PET standard deviation $\\sigma_{\\mathrm{PET}} = 0.5$ (SUV).\n\nStarting from the core definitions of mean, variance, and convex combinations, and enforcing the two constraints described above, derive the explicit affine scaling law $g(S)$ that maps PET SUV to an MR-compatible scale suitable for convex combination fusion without biasing tissue contrasts. Express your final $g(S)$ as a closed-form analytic expression in $S$ in MR arbitrary units. No rounding is required.", "solution": "The user wants to derive an affine scaling law $g(S)$ for PET image intensities to be fused with MR image intensities.\n\n### Step 1: Extract Givens\n-   PET image voxel value (SUV): $S$\n-   MR image voxel value (intensity): $M$\n-   Fusion model: $F = w M + (1 - w) g(S)$\n-   Weighting factor: $w \\in [0,1]$\n-   PET scaling function: $g(S)$, an affine scaling law\n-   MR background statistics: mean $\\mu_{\\mathrm{MR}} = 600$, standard deviation $\\sigma_{\\mathrm{MR}} = 80$\n-   PET background statistics: mean $\\mu_{\\mathrm{PET}} = 2.0$, standard deviation $\\sigma_{\\mathrm{PET}} = 0.5$\n-   Constraint 1: Around background tissue levels, equal standardized changes (one standard deviation) in either modality produce equal magnitude changes in the fused image when $w = \\frac{1}{2}$.\n-   Constraint 2: The fused background level matches the MR background level.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as PET-MR fusion is a standard medical imaging technique. The use of convex combination and affine scaling are well-established methods. The constraints are objective and mathematically formalizable, designed to ensure a meaningful fusion. The problem is well-posed, providing two constraints to determine the two parameters of the affine function. The provided numerical values are plausible. No flaws are detected.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of the Affine Scaling Law\n\nThe problem requires the derivation of an explicit affine scaling law, which has the general form $g(S) = aS + b$, where $a$ and $b$ are constants to be determined. We will use the two provided constraints to establish a system of two linear equations for $a$ and $b$.\n\n**Analysis of Constraint 2: Matching Background Levels**\n\nThis constraint states that \"the fused background level matches the MR background level.\" The background level is quantified by the mean intensity. Let $\\mu_F$, $\\mu_{\\mathrm{MR}}$, and $\\mu_{g(S)}$ denote the mean values of the fused image, MR image, and scaled PET image, respectively.\n\nThe mean of the scaled PET image, $\\mu_{g(S)}$, is found by applying the expectation operator:\n$$\n\\mu_{g(S)} = E[g(S)] = E[aS + b]\n$$\nUsing the linearity of expectation, $E[X+Y] = E[X] + E[Y]$ and $E[cX] = cE[X]$:\n$$\n\\mu_{g(S)} = a E[S] + b = a\\mu_{\\mathrm{PET}} + b\n$$\nThe mean of the fused image, $\\mu_F$, is given by:\n$$\n\\mu_F = E[F] = E[w M + (1 - w) g(S)]\n$$\nAssuming a voxel's MR intensity and PET SUV are generated by independent processes, the expectation of the sum is the sum of expectations:\n$$\n\\mu_F = w E[M] + (1 - w) E[g(S)] = w\\mu_{\\mathrm{MR}} + (1-w)\\mu_{g(S)}\n$$\nThe constraint is $\\mu_F = \\mu_{\\mathrm{MR}}$. Substituting this into the equation for $\\mu_F$:\n$$\n\\mu_{\\mathrm{MR}} = w\\mu_{\\mathrm{MR}} + (1-w)\\mu_{g(S)}\n$$\n$$\n(1-w)\\mu_{\\mathrm{MR}} = (1-w)\\mu_{g(S)}\n$$\nFor this relation to hold for any $w \\in [0, 1)$ (i.e., for any non-trivial fusion), it must be that the mean of the scaled PET image equals the mean of the MR image:\n$$\n\\mu_{g(S)} = \\mu_{\\mathrm{MR}}\n$$\nSubstituting the expression for $\\mu_{g(S)}$, we get our first equation for $a$ and $b$:\n$$\na\\mu_{\\mathrm{PET}} + b = \\mu_{\\mathrm{MR}} \\quad \\quad (1)\n$$\n\n**Analysis of Constraint 1: Equal Sensitivity to Standardized Changes**\n\nThis constraint states that \"equal standardized changes (one standard deviation) in either modality produce equal magnitude changes in the fused image when $w = \\frac{1}{2}$.\" We can formalize the change in the fused image $F$ with respect to changes in the input images $M$ and $S$ using partial derivatives.\n\nThe fused image is a function of two variables, $F(M, S) = wM + (1-w)g(S)$. The sensitivity of $F$ to a small change in $M$ is $\\frac{\\partial F}{\\partial M}$, and to a small change in $S$ is $\\frac{\\partial F}{\\partial S}$.\n$$\n\\frac{\\partial F}{\\partial M} = w\n$$\n$$\n\\frac{\\partial F}{\\partial S} = (1-w) \\frac{d g(S)}{d S} = (1-w)a\n$$\nA \"standardized change\" in $M$ is specified as one standard deviation, $\\sigma_{\\mathrm{MR}}$. The resulting change in $F$, denoted $\\Delta F_M$, is:\n$$\n\\Delta F_M = \\frac{\\partial F}{\\partial M} \\sigma_{\\mathrm{MR}} = w\\sigma_{\\mathrm{MR}}\n$$\nSimilarly, a standardized change in $S$ is $\\sigma_{\\mathrm{PET}}$, and the resulting change in $F$, denoted $\\Delta F_S$, is:\n$$\n\\Delta F_S = \\frac{\\partial F}{\\partial S} \\sigma_{\\mathrm{PET}} = (1-w) a \\sigma_{\\mathrm{PET}}\n$$\nThe constraint requires the magnitudes of these changes to be equal when $w = \\frac{1}{2}$:\n$$\n|\\Delta F_M| = |\\Delta F_S| \\quad \\text{at } w = \\frac{1}{2}\n$$\n$$\n\\left| \\frac{1}{2} \\sigma_{\\mathrm{MR}} \\right| = \\left| \\left(1 - \\frac{1}{2}\\right) a \\sigma_{\\mathrm{PET}} \\right|\n$$\nSince standard deviations are non-negative, this simplifies to:\n$$\n\\frac{1}{2} \\sigma_{\\mathrm{MR}} = \\frac{1}{2} |a| \\sigma_{\\mathrm{PET}}\n$$\n$$\n\\sigma_{\\mathrm{MR}} = |a| \\sigma_{\\mathrm{PET}}\n$$\nFor the scaling to be scientifically interpretable, a higher PET SUV (indicating more metabolic activity) should map to a higher intensity value, which implies $a > 0$. Thus, we can remove the absolute value:\n$$\na \\sigma_{\\mathrm{PET}} = \\sigma_{\\mathrm{MR}} \\quad \\quad (2)\n$$\n\n**Solving for $a$ and $b$**\n\nWe now have a system of two linear equations with two unknowns, $a$ and $b$:\n1.  $a\\mu_{\\mathrm{PET}} + b = \\mu_{\\mathrm{MR}}$\n2.  $a\\sigma_{\\mathrm{PET}} = \\sigma_{\\mathrm{MR}}$\n\nFrom equation (2), we solve for $a$:\n$$\na = \\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}}\n$$\nSubstitute this expression for $a$ into equation (1) to solve for $b$:\n$$\n\\left(\\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}}\\right) \\mu_{\\mathrm{PET}} + b = \\mu_{\\mathrm{MR}}\n$$\n$$\nb = \\mu_{\\mathrm{MR}} - \\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}} \\mu_{\\mathrm{PET}}\n$$\nThe complete affine scaling law is $g(S) = aS + b$. Substituting the expressions for $a$ and $b$:\n$$\ng(S) = \\left(\\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}}\\right) S + \\left(\\mu_{\\mathrm{MR}} - \\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}} \\mu_{\\mathrm{PET}}\\right)\n$$\nThis expression can be rearranged into a more insightful form:\n$$\ng(S) = \\mu_{\\mathrm{MR}} + \\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}} (S - \\mu_{\\mathrm{PET}})\n$$\nThis form shows that the PET SUV $S$ is first centered by its mean $\\mu_{\\mathrm{PET}}$, then scaled by the ratio of standard deviations $\\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}}$, and finally shifted to match the MR mean $\\mu_{\\mathrm{MR}}$.\n\n**Numerical Calculation**\n\nWe now substitute the given numerical values:\n$\\mu_{\\mathrm{MR}} = 600$, $\\sigma_{\\mathrm{MR}} = 80$, $\\mu_{\\mathrm{PET}} = 2.0$, and $\\sigma_{\\mathrm{PET}} = 0.5$.\n\nFirst, calculate $a$:\n$$\na = \\frac{\\sigma_{\\mathrm{MR}}}{\\sigma_{\\mathrm{PET}}} = \\frac{80}{0.5} = 160\n$$\nNext, calculate $b$:\n$$\nb = \\mu_{\\mathrm{MR}} - a \\mu_{\\mathrm{PET}} = 600 - (160)(2.0) = 600 - 320 = 280\n$$\nTherefore, the explicit affine scaling law is:\n$$\ng(S) = 160S + 280\n$$\nThe units of $g(S)$ are MR arbitrary units, as required.", "answer": "$$\n\\boxed{g(S) = 160S + 280}\n$$", "id": "4891123"}, {"introduction": "Image fusion is not just about creating a visually appealing composite; it can be used to leverage the strengths of one modality to correct the physical limitations of another. This practice demonstrates a powerful synergistic application where high-resolution anatomical data from an MR scan is used to improve the quantitative accuracy of a lower-resolution functional PET scan, which is often degraded by the partial volume effect (PVE). In this coding exercise [@problem_id:4891216], you will implement the geometric transfer matrix (GTM) method to perform partial volume correction, giving you practical insight into how multimodal fusion leads to more accurate diagnostics.", "problem": "You are given a simplified two-dimensional multimodal imaging scenario with synthetic lesion phantoms. The \"positron emission tomography (PET)\" channel is modeled as a linear, shift-invariant imaging system with a Gaussian point spread function (PSF), and the \"magnetic resonance (MR)\" channel provides a high-resolution structural segmentation of regions. The measured PET image is modeled by the convolution of the true activity distribution with a Gaussian PSF. The goal is to perform a region-based partial volume correction using the geometric transfer matrix method, generate fused images before and after correction, and quantify recovery coefficients for each lesion.\n\nFundamental base:\n- Linear systems theory for imaging: the measured PET image is modeled as a convolution of the true activity distribution with a system PSF, i.e., $I_{\\mathrm{meas}} = I_{\\mathrm{true}} \\ast h$, where $h$ is a normalized Gaussian PSF and $\\ast$ denotes convolution.\n- Region-based activity model: the true distribution is assumed piecewise-constant over $K$ disjoint regions with known masks $\\{M_j\\}_{j=1}^{K}$, so that $I_{\\mathrm{true}}(\\mathbf{r}) = \\sum_{j=1}^{K} C_j M_j(\\mathbf{r})$, where $C_j$ are region activities (constants).\n- Geometric transfer matrix method: define region-of-interest means of the measured PET image as $m_i = \\frac{1}{|R_i|}\\int_{R_i} I_{\\mathrm{meas}}(\\mathbf{r}) \\, d\\mathbf{r}$ for regions $R_i$ with masks $M_i$, and define $G_{ij} = \\frac{1}{|R_i|}\\int_{R_i} (M_j \\ast h)(\\mathbf{r}) \\, d\\mathbf{r}$. Then the vector of measured region means $\\mathbf{m}$ satisfies $\\mathbf{m} = G \\mathbf{C}$, and the estimate of $\\mathbf{C}$ is obtained by solving the linear system, $\\hat{\\mathbf{C}} = G^{-1} \\mathbf{m}$, assuming $G$ is nonsingular.\n- Recovery coefficient for lesion $j$: $\\mathrm{RC}_j = \\frac{\\bar{I}_{\\mathrm{region},j}}{C^{\\mathrm{true}}_j}$, where $\\bar{I}_{\\mathrm{region},j}$ is the mean intensity within lesion region $j$, and $C^{\\mathrm{true}}_j$ is the true region activity.\n\nYou must implement the following steps for each test case:\n1. Construct a $N \\times N$ grid with pixel size $p$ in $\\mathrm{mm}$, and generate two circular lesion masks and a background mask. The true activity image is $I_{\\mathrm{true}}(\\mathbf{r}) = C_1 M_1(\\mathbf{r}) + C_2 M_2(\\mathbf{r}) + C_{\\mathrm{bg}} M_{\\mathrm{bg}}(\\mathbf{r})$, where $M_{\\mathrm{bg}} = 1 - M_1 - M_2$.\n2. Generate the measured PET image by convolving $I_{\\mathrm{true}}$ with a normalized Gaussian PSF with standard deviation $\\sigma$ (in $\\mathrm{mm}$). The PSF standard deviation in pixels is $\\sigma_{\\mathrm{px}} = \\sigma / p$.\n3. Compute the region-wise means $m_i$ of the measured PET image over $M_1$, $M_2$, and $M_{\\mathrm{bg}}$.\n4. Form the geometric transfer matrix $G$ with entries $G_{ij}$ computed by convolving each mask $M_j$ with the PSF and averaging the result over region $i$.\n5. Solve for the partial volume-corrected region activities $\\hat{\\mathbf{C}} = [\\hat{C}_1,\\hat{C}_2,\\hat{C}_{\\mathrm{bg}}]^\\top$ using the linear system $G \\hat{\\mathbf{C}} = \\mathbf{m}$. Construct the corrected PET image $I_{\\mathrm{corr}}(\\mathbf{r}) = \\hat{C}_1 M_1(\\mathbf{r}) + \\hat{C}_2 M_2(\\mathbf{r}) + \\hat{C}_{\\mathrm{bg}} M_{\\mathrm{bg}}(\\mathbf{r})$.\n6. Compute the recovery coefficients for lesions $1$ and $2$ before correction as $\\mathrm{RC}^{\\mathrm{before}}_j = \\frac{\\bar{I}_{\\mathrm{meas},j}}{C^{\\mathrm{true}}_j}$ and after correction as $\\mathrm{RC}^{\\mathrm{after}}_j = \\frac{\\bar{I}_{\\mathrm{corr},j}}{C^{\\mathrm{true}}_j}$, where $\\bar{I}_{\\mathrm{meas},j}$ and $\\bar{I}_{\\mathrm{corr},j}$ are the mean intensities of $I_{\\mathrm{meas}}$ and $I_{\\mathrm{corr}}$ within lesion $j$, respectively. These are unitless.\n7. Create fused images before and after correction using simple intensity blending with the structural image. Define a structural image $S$ by assigning a high-intensity value to lesions and a lower value to the background, e.g., $S = s_{\\ell}(M_1 + M_2) + s_{\\mathrm{bg}} M_{\\mathrm{bg}}$, with $s_{\\ell} = 0.8$ and $s_{\\mathrm{bg}} = 0.2$. Normalize both $S$ and PET images to $[0,1]$ via min-max normalization, and compute $F_{\\mathrm{before}} = \\alpha S_{\\mathrm{norm}} + (1-\\alpha) I_{\\mathrm{meas,norm}}$ and $F_{\\mathrm{after}} = \\alpha S_{\\mathrm{norm}} + (1-\\alpha) I_{\\mathrm{corr,norm}}$, with $\\alpha = 0.5$. You do not need to output the fused images, but you must compute them.\n\nAll images are two-dimensional arrays. Intensities are in arbitrary units. Length scales must be handled in $\\mathrm{mm}$, with pixel size conversion as specified. No angles are used. Recovery coefficients must be reported as decimals without any unit.\n\nTest suite:\n- Common to all test cases: image size $N = 128$ pixels, pixel size $p = 1.0 \\ \\mathrm{mm}$ per pixel, fusion blending parameter $\\alpha = 0.5$, structural image intensities $s_{\\ell} = 0.8$, $s_{\\mathrm{bg}} = 0.2$.\n- Case $1$:\n  - Lesion diameters: $d_1 = 12.0 \\ \\mathrm{mm}$, $d_2 = 6.0 \\ \\mathrm{mm}$.\n  - Lesion centers (in pixels): $(x_1,y_1) = (48,64)$, $(x_2,y_2) = (80,64)$.\n  - True activities: $C_1 = 5.0$, $C_2 = 3.5$, $C_{\\mathrm{bg}} = 1.0$.\n  - PSF standard deviation: $\\sigma = 2.5 \\ \\mathrm{mm}$.\n- Case $2$:\n  - Lesion diameters: $d_1 = 4.0 \\ \\mathrm{mm}$, $d_2 = 8.0 \\ \\mathrm{mm}$.\n  - Lesion centers (in pixels): $(x_1,y_1) = (40,64)$, $(x_2,y_2) = (92,64)$.\n  - True activities: $C_1 = 6.0$, $C_2 = 4.0$, $C_{\\mathrm{bg}} = 1.0$.\n  - PSF standard deviation: $\\sigma = 3.0 \\ \\mathrm{mm}$.\n- Case $3$:\n  - Lesion diameters: $d_1 = 10.0 \\ \\mathrm{mm}$, $d_2 = 10.0 \\ \\mathrm{mm}$.\n  - Lesion centers (in pixels): $(x_1,y_1) = (60,64)$, $(x_2,y_2) = (74,64)$.\n  - True activities: $C_1 = 5.0$, $C_2 = 2.0$, $C_{\\mathrm{bg}} = 1.2$.\n  - PSF standard deviation: $\\sigma = 3.5 \\ \\mathrm{mm}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each test case, append in order: $\\mathrm{RC}^{\\mathrm{before}}_1$, $\\mathrm{RC}^{\\mathrm{before}}_2$, $\\mathrm{RC}^{\\mathrm{after}}_1$, $\\mathrm{RC}^{\\mathrm{after}}_2$, each rounded to $4$ decimal places.\n- Therefore, the final output will be a flat list of $12$ floating-point numbers corresponding to cases $1$, $2$, and $3$ in sequence, for a total of $12$ entries.\n\nYour program must implement the above steps exactly for the provided test suite and print the results in the specified format. No user input or external files are allowed. The output is unitless decimals rounded to $4$ decimal places.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of linear systems theory as applied to medical imaging, specifically Positron Emission Tomography (PET). The problem is well-posed, providing all necessary parameters and a clear, objective procedure for calculating the desired quantities. The specified method, the Geometric Transfer Matrix (GTM) for partial volume correction, is a standard and recognized technique in the field. The provided parameters for the synthetic phantoms are realistic for a simulation study.\n\nThe solution proceeds by implementing the steps outlined in the problem statement. The core of the problem is to correct for the partial volume effect, a degradation in quantitative accuracy in PET imaging that arises from the limited spatial resolution of the scanner. This effect causes the measured activity in a small region to be a mixture of its true activity and the activity of its surroundings. The GTM method corrects for this by modeling the \"spill-over\" of signal between predefined regions.\n\nThe fundamental model of the imaging process is a linear, shift-invariant system, described by the convolution equation:\n$$\nI_{\\mathrm{meas}}(\\mathbf{r}) = (I_{\\mathrm{true}} \\ast h)(\\mathbf{r}) = \\int I_{\\mathrm{true}}(\\mathbf{r}') h(\\mathbf{r} - \\mathbf{r}') \\, d\\mathbf{r}'\n$$\nwhere $I_{\\mathrm{true}}(\\mathbf{r})$ is the true spatial distribution of radiotracer activity, $h(\\mathbf{r})$ is the system's Point Spread Function (PSF), and $I_{\\mathrm{meas}}(\\mathbf{r})$ is the resulting measured image. For this problem, the PSF is a normalized 2D Gaussian function with standard deviation $\\sigma$.\n\nThe true activity distribution is defined as piecewise constant over $K=3$ disjoint regions (two lesions and a background):\n$$\nI_{\\mathrm{true}}(\\mathbf{r}) = C_1 M_1(\\mathbf{r}) + C_2 M_2(\\mathbf{r}) + C_{\\mathrm{bg}} M_{\\mathrm{bg}}(\\mathbf{r})\n$$\nHere, $C_j$ are the true, unknown constant activities within each region, and $M_j(\\mathbf{r})$ are the corresponding binary masks ($1$ inside the region, $0$ outside), which are assumed to be known from a high-resolution modality like MR.\n\nThe GTM method relates the vector of true activities, $\\mathbf{C} = [C_1, C_2, C_{\\mathrm{bg}}]^\\top$, to the vector of measured mean activities, $\\mathbf{m} = [m_1, m_2, m_{\\mathrm{bg}}]^\\top$, where $m_i$ is the average value of $I_{\\mathrm{meas}}$ over region $i$. The relationship is the linear system $\\mathbf{m} = G\\mathbf{C}$. The Geometric Transfer Matrix, $G$, has elements $G_{ij}$ that represent the fraction of signal from region $j$ that \"spills over\" into the measurement of region $i$.\n\nThe algorithmic procedure is as follows:\n\n1.  **Phantom Generation**: For each test case, we construct a discrete $N \\times N$ grid, where $N=128$. The pixel size is $p=1.0 \\ \\mathrm{mm}$. On this grid, we generate the binary masks $M_1$, $M_2$, and $M_{\\mathrm{bg}}$. $M_1$ and $M_2$ are circular masks defined by their centers $(x_j, y_j)$ and diameters $d_j$. The background mask is $M_{\\mathrm{bg}} = 1 - M_1 - M_2$. Using the true activities $C_1, C_2, C_{\\mathrm{bg}}$, the true activity image $I_{\\mathrm{true}}$ is synthesized.\n\n2.  **Image Blurring**: The measured PET image, $I_{\\mathrm{meas}}$, is simulated by convolving the true image $I_{\\mathrm{true}}$ with a normalized Gaussian PSF, $h$. The standard deviation of the PSF is given as $\\sigma$ in $\\mathrm{mm}$, which is converted to pixels as $\\sigma_{\\mathrm{px}} = \\sigma/p$. This convolution is efficiently implemented using a digital Gaussian filter.\n    $$\n    I_{\\mathrm{meas}} = I_{\\mathrm{true}} \\ast h\n    $$\n\n3.  **Measured Means Calculation**: The mean measured activity $m_i$ for each region $i \\in \\{1, 2, \\mathrm{bg}\\}$ is computed by averaging the pixel values of $I_{\\mathrm{meas}}$ within the mask $M_i$. In discrete terms, for region $i$:\n    $$\n    m_i = \\frac{\\sum_{\\mathbf{p}} (I_{\\mathrm{meas}})_{\\mathbf{p}} (M_i)_{\\mathbf{p}}}{\\sum_{\\mathbf{p}} (M_i)_{\\mathbf{p}}}\n    $$\n    where the sum is over all pixels $\\mathbf{p}$ in the grid.\n\n4.  **Geometric Transfer Matrix Construction**: The $3 \\times 3$ matrix $G$ is constructed. Each element $G_{ij}$ is calculated by first convolving the mask of the source region, $M_j$, with the PSF $h$, and then averaging the resulting blurred mask over the \"target\" region $M_i$.\n    $$\n    G_{ij} = \\frac{\\sum_{\\mathbf{p}} ((M_j \\ast h)_{\\mathbf{p}} (M_i)_{\\mathbf{p}})}{\\sum_{\\mathbf{p}} (M_i)_{\\mathbf{p}}}\n    $$\n    This matrix quantifies the spatial cross-talk between all pairs of regions.\n\n5.  **Partial Volume Correction**: With the vector of measured means $\\mathbf{m}$ and the matrix $G$, we solve the linear system of equations $G\\hat{\\mathbf{C}} = \\mathbf{m}$ to find the estimated, or partial volume-corrected, activities $\\hat{\\mathbf{C}} = [\\hat{C}_1, \\hat{C}_2, \\hat{C}_{\\mathrm{bg}}]^\\top$.\n    $$\n    \\hat{\\mathbf{C}} = G^{-1}\\mathbf{m}\n    $$\n    This is achieved using a standard linear algebra solver. A corrected image, $I_{\\mathrm{corr}}$, is then synthesized using these estimated activities: $I_{\\mathrm{corr}} = \\hat{C}_1 M_1 + \\hat{C}_2 M_2 + \\hat{C}_{\\mathrm{bg}} M_{\\mathrm{bg}}$.\n\n6.  **Recovery Coefficient Quantification**: To evaluate the performance of the correction, we compute a Recovery Coefficient (RC) for each lesion. The RC is the ratio of a measured or estimated mean activity to the true activity.\n    Before correction, for lesion $j \\in \\{1, 2\\}$:\n    $$\n    \\mathrm{RC}^{\\mathrm{before}}_j = \\frac{m_j}{C^{\\mathrm{true}}_j}\n    $$\n    After correction, the mean activity in region $j$ of the corrected image $I_{\\mathrm{corr}}$ is, by construction, exactly $\\hat{C}_j$. Therefore, the post-correction RC is:\n    $$\n    \\mathrm{RC}^{\\mathrm{after}}_j = \\frac{\\hat{C}_j}{C^{\\mathrm{true}}_j}\n    $$\n    An RC of $1.0$ signifies perfect recovery of the true activity.\n\n7.  **Image Fusion**: Though not part of the final numerical output, fused images are generated. A structural image $S = s_{\\ell}(M_1+M_2) + s_{\\mathrm{bg}}M_{\\mathrm{bg}}$ is created. The PET images ($I_{\\mathrm{meas}}$, $I_{\\mathrm{corr}}$) and the structural image $S$ are normalized to the range $[0, 1]$. Fused images are then created by a weighted sum, e.g., $F_{\\mathrm{before}} = \\alpha S_{\\mathrm{norm}} + (1-\\alpha) I_{\\mathrm{meas,norm}}$, with $\\alpha=0.5$.\n\nThis entire procedure is applied to each of the three test cases, and the four resulting recovery coefficients ($\\mathrm{RC}^{\\mathrm{before}}_1, \\mathrm{RC}^{\\mathrm{before}}_2, \\mathrm{RC}^{\\mathrm{after}}_1, \\mathrm{RC}^{\\mathrm{after}}_2$) for each case are calculated and reported.", "answer": "```python\nimport numpy as np\nfrom scipy.ndimage import gaussian_filter\n\ndef solve():\n    \"\"\"\n    Solves the partial volume correction problem for the given test suite.\n    \"\"\"\n    \n    # Common parameters for all test cases\n    N = 128\n    p = 1.0  # mm/pixel\n    alpha = 0.5\n    s_l = 0.8\n    s_bg = 0.2\n\n    test_cases = [\n        # Case 1\n        {'d': (12.0, 6.0), 'center': ((48, 64), (80, 64)), 'C_true': (5.0, 3.5, 1.0), 'sigma': 2.5},\n        # Case 2\n        {'d': (4.0, 8.0), 'center': ((40, 64), (92, 64)), 'C_true': (6.0, 4.0, 1.0), 'sigma': 3.0},\n        # Case 3\n        {'d': (10.0, 10.0), 'center': ((60, 64), (74, 64)), 'C_true': (5.0, 2.0, 1.2), 'sigma': 3.5},\n    ]\n\n    all_results = []\n    \n    # Create coordinate grid for mask generation\n    # yy corresponds to rows (y-coordinate), xx to columns (x-coordinate)\n    yy, xx = np.mgrid[:N, :N]\n\n    for case in test_cases:\n        # Step 1: Construct true image and masks\n        radii_mm = (case['d'][0] / 2.0, case['d'][1] / 2.0)\n        radii_px = [r / p for r in radii_mm]\n        centers_px = case['center'] # (x, y) = (col, row)\n        \n        dist_sq_1 = (xx - centers_px[0][0])**2 + (yy - centers_px[0][1])**2\n        dist_sq_2 = (xx - centers_px[1][0])**2 + (yy - centers_px[1][1])**2\n        \n        M1 = (dist_sq_1 <= radii_px[0]**2).astype(float)\n        M2 = (dist_sq_2 <= radii_px[1]**2).astype(float)\n        M_bg = 1.0 - M1 - M2\n        \n        masks = [M1, M2, M_bg]\n        region_pixels = [np.sum(m) for m in masks]\n\n        C_true_vec = np.array(case['C_true'])\n        I_true = C_true_vec[0] * M1 + C_true_vec[1] * M2 + C_true_vec[2] * M_bg\n        \n        # Step 2: Generate the measured PET image by convolution\n        sigma_px = case['sigma'] / p\n        I_meas = gaussian_filter(I_true, sigma=sigma_px, mode='reflect')\n\n        # Step 3: Compute the region-wise means of the measured image\n        m_measured = np.array([np.sum(I_meas * M) / num_pix if num_pix > 0 else 0 \n                               for M, num_pix in zip(masks, region_pixels)])\n\n        # Step 4: Form the geometric transfer matrix G\n        G = np.zeros((3, 3))\n        for j in range(3):  # For each source region mask M_j\n            M_j_blurred = gaussian_filter(masks[j], sigma=sigma_px, mode='reflect')\n            for i in range(3):  # For each target region of interest M_i\n                if region_pixels[i] > 0:\n                    G[i, j] = np.sum(M_j_blurred * masks[i]) / region_pixels[i]\n                else:\n                    G[i, j] = 0\n\n        # Step 5: Solve for corrected activities and create corrected image\n        try:\n            C_hat = np.linalg.solve(G, m_measured)\n        except np.linalg.LinAlgError:\n            # In case of a singular matrix, use pseudo-inverse\n            C_hat = np.linalg.pinv(G) @ m_measured\n        \n        I_corr = C_hat[0] * M1 + C_hat[1] * M2 + C_hat[2] * M_bg\n\n        # Step 6: Compute recovery coefficients\n        RC_before_1 = m_measured[0] / C_true_vec[0]\n        RC_before_2 = m_measured[1] / C_true_vec[1]\n        \n        # Mean of corrected image in region j is C_hat_j by construction\n        RC_after_1 = C_hat[0] / C_true_vec[0]\n        RC_after_2 = C_hat[1] / C_true_vec[1]\n        \n        # Step 7: Create fused images (as required by problem, though not directly output)\n        S = s_l * (M1 + M2) + s_bg * M_bg\n        \n        def normalize(img):\n            min_val = np.min(img)\n            max_val = np.max(img)\n            if max_val == min_val:\n                return np.zeros_like(img) \n            return (img - min_val) / (max_val - min_val)\n\n        S_norm = normalize(S)\n        I_meas_norm = normalize(I_meas)\n        I_corr_norm = normalize(I_corr)\n        \n        F_before = alpha * S_norm + (1 - alpha) * I_meas_norm\n        F_after = alpha * S_norm + (1 - alpha) * I_corr_norm\n        \n        # Append results for the current case to the main list\n        case_results = [RC_before_1, RC_before_2, RC_after_1, RC_after_2]\n        all_results.extend(case_results)\n\n    # Format the final output string\n    final_output_str = [f\"{r:.4f}\" for r in all_results]\n    print(f\"[{','.join(final_output_str)}]\")\n\nsolve()\n```", "id": "4891216"}, {"introduction": "Building on the fundamental concept of intensity normalization, this advanced practice moves from simple statistical matching to a more sophisticated, objective-driven approach. Instead of just aligning the means and variances, the goal here is to find a transformation that maximizes the structural similarity between two modalities, a goal more closely aligned with perceptual quality. This exercise [@problem_id:4891164] challenges you to use calculus to derive the optimal linear mapping that maximizes the Structural Similarity Index Measure (SSIM) between a CT and MR image, introducing you to the powerful concept of metric-driven optimization in image processing.", "problem": "A computed tomography (CT) volume and a magnetic resonance (MR) volume are to be fused for an anatomical study. To increase cross-modality similarity within a region of interest mask, you will linearly normalize the CT intensities inside the mask and then assess similarity using the Structural Similarity Index Measure (SSIM). Let the mask be a fixed set of voxels, and let the CT and MR intensity samples within the mask be denoted by $\\{x_i\\}$ and $\\{m_i\\}$, respectively. Consider the linear normalization model $y_i = \\alpha x_i + \\beta$ applied to the CT values inside the mask to produce $\\{y_i\\}$.\n\nThe Structural Similarity Index Measure (SSIM) between images $y$ and $m$ within the mask is defined by\n$$\n\\operatorname{SSIM}(y,m) \\;=\\; \\frac{\\left(2\\,\\mu_y\\,\\mu_m + C_1\\right)\\left(2\\,\\sigma_{y m} + C_2\\right)}{\\left(\\mu_y^2 + \\mu_m^2 + C_1\\right)\\left(\\sigma_y^2 + \\sigma_m^2 + C_2\\right)},\n$$\nwhere $\\mu_y$ and $\\mu_m$ are the sample means, $\\sigma_y^2$ and $\\sigma_m^2$ are the sample variances, and $\\sigma_{y m}$ is the sample covariance, all computed over the mask. The constants are $C_1 = (k_1 L)^2$ and $C_2 = (k_2 L)^2$ with $k_1 = 0.01$, $k_2 = 0.03$, and dynamic range $L = 1$ for unit-normalized MR intensities and the target normalized CT intensities.\n\nWithin the mask, the following empirical statistics (computed prior to normalization) are available:\n- CT mean $\\mu_x = 40$,\n- CT variance $\\sigma_x^2 = 400$,\n- MR mean $\\mu_m = 0.60$,\n- MR variance $\\sigma_m^2 = 0.010$,\n- CT–MR covariance $\\sigma_{x m} = 1.60$.\n\nUsing only the SSIM definition and standard properties of linear transformations of random variables, derive the optimal $\\alpha$ and $\\beta$ that maximize $\\operatorname{SSIM}(y,m)$ over the mask. Then compute the numerical values of $\\alpha$ and $\\beta$ using the provided statistics and constants. Report your final numerical values rounded to four significant figures. MR intensities are unit-normalized with dynamic range $L=1$, so $\\alpha$ is dimensionless and $\\beta$ is in normalized intensity units; do not include units in the final boxed answer. Express the final answer as a row vector $(\\alpha,\\beta)$.", "solution": "The user wants me to solve the following problem:\nA computed tomography (CT) volume and a magnetic resonance (MR) volume are to be fused for an anatomical study. To increase cross-modality similarity within a region of interest mask, you will linearly normalize the CT intensities inside the mask and then assess similarity using the Structural Similarity Index Measure (SSIM). Let the mask be a fixed set of voxels, and let the CT and MR intensity samples within the mask be denoted by $\\{x_i\\}$ and $\\{m_i\\}$, respectively. Consider the linear normalization model $y_i = \\alpha x_i + \\beta$ applied to the CT values inside the mask to produce $\\{y_i\\}$.\n\nThe Structural Similarity Index Measure (SSIM) between images $y$ and $m$ within the mask is defined by\n$$\n\\operatorname{SSIM}(y,m) \\;=\\; \\frac{\\left(2\\,\\mu_y\\,\\mu_m + C_1\\right)\\left(2\\,\\sigma_{y m} + C_2\\right)}{\\left(\\mu_y^2 + \\mu_m^2 + C_1\\right)\\left(\\sigma_y^2 + \\sigma_m^2 + C_2\\right)},\n$$\nwhere $\\mu_y$ and $\\mu_m$ are the sample means, $\\sigma_y^2$ and $\\sigma_m^2$ are the sample variances, and $\\sigma_{y m}$ is the sample covariance, all computed over the mask. The constants are $C_1 = (k_1 L)^2$ and $C_2 = (k_2 L)^2$ with $k_1 = 0.01$, $k_2 = 0.03$, and dynamic range $L = 1$ for unit-normalized MR intensities and the target normalized CT intensities.\n\nWithin the mask, the following empirical statistics (computed prior to normalization) are available:\n- CT mean $\\mu_x = 40$,\n- CT variance $\\sigma_x^2 = 400$,\n- MR mean $\\mu_m = 0.60$,\n- MR variance $\\sigma_m^2 = 0.010$,\n- CT–MR covariance $\\sigma_{x m} = 1.60$.\n\nUsing only the SSIM definition and standard properties of linear transformations of random variables, derive the optimal $\\alpha$ and $\\beta$ that maximize $\\operatorname{SSIM}(y,m)$ over the mask. Then compute the numerical values of $\\alpha$ and $\\beta$ using the provided statistics and constants. Report your final numerical values rounded to four significant figures. MR intensities are unit-normalized with dynamic range $L=1$, so $\\alpha$ is dimensionless and $\\beta$ is in normalized intensity units; do not include units in the final boxed answer. Express the final answer as a row vector $(\\alpha,\\beta)$.\n\n### Step 1: Extract Givens\n-   Linear transformation: $y_i = \\alpha x_i + \\beta$\n-   SSIM formula: $\\operatorname{SSIM}(y,m) = \\frac{(2\\mu_y\\mu_m + C_1)(2\\sigma_{ym} + C_2)}{(\\mu_y^2 + \\mu_m^2 + C_1)(\\sigma_y^2 + \\sigma_m^2 + C_2)}$\n-   Constants: $k_1 = 0.01$, $k_2 = 0.03$, $L = 1$\n-   CT statistics: $\\mu_x = 40$, $\\sigma_x^2 = 400$\n-   MR statistics: $\\mu_m = 0.60$, $\\sigma_m^2 = 0.010$\n-   Cross-statistics: $\\sigma_{xm} = 1.60$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the principles of medical image analysis, statistics, and optimization. It uses a standard, well-defined similarity metric (SSIM) and linear transformation properties. The problem is well-posed, providing all necessary information to find a unique solution for the optimal parameters $\\alpha$ and $\\beta$. The language is objective and precise. The numerical values are physically plausible for medical imaging data (e.g., CT in Hounsfield units being scaled to a normalized range near MRI). The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution\nThe objective is to find the parameters $\\alpha$ and $\\beta$ that maximize the Structural Similarity Index Measure, $\\operatorname{SSIM}(y,m)$, where $y$ is a linear transformation of $x$ given by $y_i = \\alpha x_i + \\beta$.\n\nFirst, we express the statistics of $y$ in terms of the statistics of $x$ and the parameters $\\alpha$ and $\\beta$. Using the properties of expectation and variance for a linear transformation, we have:\n-   Mean of $y$: $\\mu_y = E[\\alpha x + \\beta] = \\alpha E[x] + \\beta = \\alpha \\mu_x + \\beta$\n-   Variance of $y$: $\\sigma_y^2 = \\text{Var}(\\alpha x + \\beta) = \\alpha^2 \\text{Var}(x) = \\alpha^2 \\sigma_x^2$\n-   Covariance of $y$ and $m$: $\\sigma_{ym} = \\text{Cov}(\\alpha x + \\beta, m) = \\alpha \\text{Cov}(x, m) = \\alpha \\sigma_{xm}$\n\nThe SSIM formula can be written as a product of two terms: a luminance comparison term $L(y,m)$ and a combined contrast-structure comparison term $CS(y,m)$.\n$$ \\operatorname{SSIM}(y,m) = \\underbrace{\\frac{2\\mu_y\\mu_m + C_1}{\\mu_y^2 + \\mu_m^2 + C_1}}_{L(y,m)} \\cdot \\underbrace{\\frac{2\\sigma_{ym} + C_2}{\\sigma_y^2 + \\sigma_m^2 + C_2}}_{CS(y,m)} $$\nLet's substitute the expressions for the statistics of $y$:\n$$ \\operatorname{SSIM}(\\alpha, \\beta) = \\frac{2(\\alpha\\mu_x+\\beta)\\mu_m + C_1}{(\\alpha\\mu_x+\\beta)^2 + \\mu_m^2 + C_1} \\cdot \\frac{2\\alpha\\sigma_{xm} + C_2}{(\\alpha^2\\sigma_x^2) + \\sigma_m^2 + C_2} $$\nThe optimization problem is to maximize this function with respect to $\\alpha$ and $\\beta$. We observe that the parameter $\\beta$ only appears in the first term (the luminance comparison), while the parameter $\\alpha$ appears in both terms.\n\nThe maximization can be performed by taking partial derivatives with respect to $\\alpha$ and $\\beta$ and setting them to zero.\n$$ \\frac{\\partial \\operatorname{SSIM}}{\\partial \\beta} = \\frac{\\partial L}{\\partial \\beta} \\cdot CS = 0 $$\n$$ \\frac{\\partial \\operatorname{SSIM}}{\\partial \\alpha} = \\frac{\\partial L}{\\partial \\alpha} \\cdot CS + L \\cdot \\frac{\\partial CS}{\\partial \\alpha} = 0 $$\nFrom the first equation, since $CS$ is not generally zero, we must have $\\frac{\\partial L}{\\partial \\beta} = 0$. Let $u = \\mu_y = \\alpha\\mu_x+\\beta$. Then $\\frac{\\partial u}{\\partial \\beta} = 1$. By the chain rule, $\\frac{\\partial L}{\\partial \\beta} = \\frac{dL}{du}\\frac{\\partial u}{\\partial \\beta} = \\frac{dL}{du}$. Thus, we need to find the extremum of $L(u) = \\frac{2u\\mu_m + C_1}{u^2 + \\mu_m^2 + C_1}$ with respect to $u$.\n$$ \\frac{dL}{du} = \\frac{2\\mu_m(u^2 + \\mu_m^2 + C_1) - (2u\\mu_m + C_1)(2u)}{(u^2 + \\mu_m^2 + C_1)^2} = 0 $$\nThe numerator must be zero:\n$$ 2\\mu_m u^2 + 2\\mu_m^3 + 2\\mu_m C_1 - 4u^2\\mu_m - 2uC_1 = 0 $$\n$$ -2\\mu_m u^2 - 2uC_1 + 2\\mu_m(\\mu_m^2 + C_1) = 0 $$\n$$ \\mu_m u^2 + uC_1 - \\mu_m(\\mu_m^2 + C_1) = 0 $$\nOne can verify by substitution that $u = \\mu_m$ is a solution to this quadratic equation: $\\mu_m(\\mu_m^2) + \\mu_m C_1 - \\mu_m(\\mu_m^2 + C_1) = 0$. The second derivative test confirms this is a maximum. At this maximum, $L$ takes its highest possible value of $1$.\nSo, the optimal condition is $\\mu_y = \\mu_m$, which implies:\n$$ \\alpha\\mu_x + \\beta = \\mu_m \\implies \\beta = \\mu_m - \\alpha\\mu_x $$\nThis determines the optimal $\\beta$ in terms of the optimal $\\alpha$.\n\nNow we substitute this condition back into the second optimization equation, $\\frac{\\partial \\operatorname{SSIM}}{\\partial \\alpha} = 0$. At the optimal $\\beta$, we have $\\mu_y = \\mu_m$, which means $\\frac{dL}{du}=0$. Since $\\frac{\\partial L}{\\partial \\alpha} = \\frac{dL}{du}\\frac{\\partial u}{\\partial \\alpha} = \\frac{dL}{du}\\mu_x$, this term is zero. Also, $L=1$. The optimization equation simplifies to:\n$$ 1 \\cdot \\frac{d(CS)}{d\\alpha} = 0 $$\nWe need to maximize $CS(\\alpha) = \\frac{2\\alpha\\sigma_{xm} + C_2}{\\alpha^2\\sigma_x^2 + \\sigma_m^2 + C_2}$ with respect to $\\alpha$.\n$$ \\frac{d(CS)}{d\\alpha} = \\frac{2\\sigma_{xm}(\\alpha^2\\sigma_x^2 + \\sigma_m^2 + C_2) - (2\\alpha\\sigma_{xm} + C_2)(2\\alpha\\sigma_x^2)}{(\\alpha^2\\sigma_x^2 + \\sigma_m^2 + C_2)^2} = 0 $$\nThe numerator must be zero:\n$$ 2\\sigma_{xm}\\alpha^2\\sigma_x^2 + 2\\sigma_{xm}(\\sigma_m^2 + C_2) - 4\\alpha^2\\sigma_{xm}\\sigma_x^2 - 2\\alpha C_2\\sigma_x^2 = 0 $$\n$$ -2\\sigma_{xm}\\alpha^2\\sigma_x^2 - 2\\alpha C_2\\sigma_x^2 + 2\\sigma_{xm}(\\sigma_m^2 + C_2) = 0 $$\n$$ (\\sigma_{xm}\\sigma_x^2)\\alpha^2 + (C_2\\sigma_x^2)\\alpha - \\sigma_{xm}(\\sigma_m^2 + C_2) = 0 $$\nThis is a quadratic equation for $\\alpha$ of the form $A\\alpha^2+B\\alpha+C=0$ with:\n$A = \\sigma_{xm}\\sigma_x^2$\n$B = C_2\\sigma_x^2$\n$C = -\\sigma_{xm}(\\sigma_m^2 + C_2)$\n\nThe solution is $\\alpha = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$. Since $\\sigma_{xm} > 0$, we have $A>0$ and $C<0$. This guarantees two real roots of opposite signs. A positive correlation between CT and MR is expected, so we take the positive root for $\\alpha$.\n$$ \\alpha = \\frac{-C_2\\sigma_x^2 + \\sqrt{(C_2\\sigma_x^2)^2 + 4(\\sigma_{xm}\\sigma_x^2)\\sigma_{xm}(\\sigma_m^2 + C_2)}}{2\\sigma_{xm}\\sigma_x^2} $$\nNow, we compute the numerical values.\nFirst, calculate $C_1$ and $C_2$:\n$C_1 = (k_1 L)^2 = (0.01 \\cdot 1)^2 = 0.0001$\n$C_2 = (k_2 L)^2 = (0.03 \\cdot 1)^2 = 0.0009$\n\nNext, calculate the coefficients of the quadratic equation for $\\alpha$:\n$A = \\sigma_{xm}\\sigma_x^2 = 1.60 \\cdot 400 = 640$\n$B = C_2\\sigma_x^2 = 0.0009 \\cdot 400 = 0.36$\n$C = -\\sigma_{xm}(\\sigma_m^2 + C_2) = -1.60(0.010 + 0.0009) = -1.60(0.0109) = -0.01744$\n\nThe equation is $640\\alpha^2 + 0.36\\alpha - 0.01744 = 0$.\nSolving for the positive root $\\alpha$:\n$$ \\alpha = \\frac{-0.36 + \\sqrt{0.36^2 - 4(640)(-0.01744)}}{2(640)} $$\n$$ \\alpha = \\frac{-0.36 + \\sqrt{0.1296 + 44.6464}}{1280} $$\n$$ \\alpha = \\frac{-0.36 + \\sqrt{44.776}}{1280} $$\n$$ \\alpha = \\frac{-0.36 + 6.6914871...}{1280} $$\n$$ \\alpha = \\frac{6.3314871...}{1280} \\approx 0.004946474... $$\nRounding to four significant figures, $\\alpha = 0.004946$.\n\nFinally, we compute $\\beta$ using the relationship derived earlier:\n$$ \\beta = \\mu_m - \\alpha\\mu_x $$\n$$ \\beta = 0.60 - (0.004946474...) \\cdot 40 $$\n$$ \\beta = 0.60 - 0.19785896... $$\n$$ \\beta = 0.40214103... $$\nRounding to four significant figures, $\\beta = 0.4021$.\n\nThe optimal parameters are $\\alpha \\approx 0.004946$ and $\\beta \\approx 0.4021$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.004946 & 0.4021\n\\end{pmatrix}\n}\n$$", "id": "4891164"}]}