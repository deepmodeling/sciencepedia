{"hands_on_practices": [{"introduction": "Radiomic analysis often begins with the most intuitive characteristics of a lesion: its shape and size. Shape features, such as sphericity, provide a quantitative measure of a lesion's geometry, which can be a powerful indicator of its underlying biology. This exercise [@problem_id:4917043] grounds the abstract concept of a radiomic feature in fundamental geometry, asking you to derive and calculate sphericity to understand how much a lesion deviates from a perfect sphere.", "problem": "A compactness-related shape descriptor used in radiomics is the sphericity feature, which quantifies how close a segmented lesion is to a perfect sphere. Consider a lesion segmented from Computed Tomography (CT) whose volume is measured as $V = 20$ cm$^{3}$ and whose surface area is measured as $A = 60$ cm$^{2}$. Using the Image Biomarker Standardisation Initiative (IBSI) definition of sphericity as the ratio of the surface area of a sphere having the same volume to the lesion’s surface area, derive the sphericity from first principles starting only from the geometric relationships for a sphere, namely $V_{\\text{sphere}} = \\frac{4}{3}\\pi r^{3}$ and $A_{\\text{sphere}} = 4\\pi r^{2}$. Then define the deviation from a perfect sphere as $d = 1 - \\text{sphericity}$ and compute $d$ for this lesion. Express the final deviation as a unitless decimal number and round your answer to four significant figures. Report the deviation $d$ only in your final answer.", "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, objective, and complete. All provided data and definitions are consistent with established principles of geometry and their application in the field of medical imaging, specifically radiomics. Therefore, the solution process will proceed.\n\nThe objective is to compute the deviation from sphericity, denoted by $d$, for a lesion with a given volume and surface area. The deviation is defined as $d = 1 - \\text{sphericity}$. The first step is to derive an expression for sphericity, $\\psi$, based on the provided definition and first principles.\n\nAccording to the Image Biomarker Standardisation Initiative (IBSI) definition given in the problem, sphericity is the ratio of the surface area of a sphere having the same volume as the lesion to the actual surface area of the lesion. Let the lesion's volume be $V$ and its surface area be $A$. Let $A_{s,V}$ be the surface area of a sphere with volume equal to $V$. The sphericity, $\\psi$, is thus given by:\n$$\n\\psi = \\frac{A_{s,V}}{A}\n$$\nThe problem provides the fundamental geometric relationships for a sphere of radius $r$:\nVolume: $V_{\\text{sphere}} = \\frac{4}{3}\\pi r^{3}$\nSurface Area: $A_{\\text{sphere}} = 4\\pi r^{2}$\n\nTo find $A_{s,V}$, we must first determine the radius of a sphere that has a volume $V$. Setting $V_{\\text{sphere}} = V$, we solve for the radius, $r$:\n$$\nV = \\frac{4}{3}\\pi r^{3}\n$$\n$$\nr^{3} = \\frac{3V}{4\\pi}\n$$\n$$\nr = \\left(\\frac{3V}{4\\pi}\\right)^{1/3}\n$$\nThis expression gives the radius of a sphere with volume $V$. Now, we use this radius to find the surface area, $A_{s,V}$, of this same sphere:\n$$\nA_{s,V} = 4\\pi r^{2} = 4\\pi \\left[ \\left(\\frac{3V}{4\\pi}\\right)^{1/3} \\right]^{2}\n$$\n$$\nA_{s,V} = 4\\pi \\left(\\frac{3V}{4\\pi}\\right)^{2/3}\n$$\nWe can simplify this expression by manipulating the constants:\n$$\nA_{s,V} = \\frac{4\\pi}{(4\\pi)^{2/3}} (3V)^{2/3} = (4\\pi)^{1 - 2/3} (3V)^{2/3} = (4\\pi)^{1/3} (3V)^{2/3}\n$$\n$$\nA_{s,V} = (4\\pi)^{1/3} (3^{2}V^{2})^{1/3} = (4\\pi \\cdot 9V^{2})^{1/3} = (36\\pi V^{2})^{1/3}\n$$\nThis is the general formula for the surface area of a sphere expressed in terms of its volume.\n\nNow we can write the complete expression for sphericity, $\\psi$:\n$$\n\\psi = \\frac{(36\\pi V^{2})^{1/3}}{A}\n$$\nThe problem provides the following values for the lesion:\nVolume, $V = 20 \\text{ cm}^{3}$\nSurface Area, $A = 60 \\text{ cm}^{2}$\n\nSubstituting these values into the sphericity formula:\n$$\n\\psi = \\frac{(36\\pi (20)^{2})^{1/3}}{60} = \\frac{(36\\pi \\cdot 400)^{1/3}}{60} = \\frac{(14400\\pi)^{1/3}}{60}\n$$\nWe compute the numerical value:\n$$\n\\psi \\approx \\frac{(14400 \\cdot 3.14159265...)^{1/3}}{60} \\approx \\frac{(45238.934...)^{1/3}}{60} \\approx \\frac{35.63181...}{60} \\approx 0.5938635...\n$$\nThe value of sphericity for the lesion is approximately $0.5938635$. The problem asks for the deviation from a perfect sphere, defined as $d = 1 - \\psi$.\n$$\nd = 1 - \\psi \\approx 1 - 0.5938635... = 0.4061365...\n$$\nThe final answer must be rounded to four significant figures. The first four significant figures are $4$, $0$, $6$, and $1$. The fifth digit is $3$, which is less than $5$, so we round down.\n$$\nd \\approx 0.4061\n$$\nThis deviation is a unitless quantity, as required. A value of $d=0$ would indicate a perfect sphere, while values greater than $0$ indicate deviation from a spherical shape.", "answer": "$$\\boxed{0.4061}$$", "id": "4917043"}, {"introduction": "Beyond its overall shape, the distribution of pixel intensities within a lesion provides another layer of information. First-order statistics summarize this distribution without considering the spatial location of pixels, much like a histogram. In this practice [@problem_id:4917108], you will compute fundamental statistical moments and entropy to quantify the heterogeneity and complexity of tissue from its gray-level histogram.", "problem": "A two-dimensional Region of Interest (ROI) from a computed tomography image is discretized into $5$ equal-width gray-level bins, producing a normalized histogram that can be modeled as a Probability Mass Function (PMF) over discrete gray levels $x \\in \\{1,2,3,4,5\\}$ with probabilities $p = [0.1, 0.2, 0.3, 0.25, 0.15]$. In radiomics and quantitative texture analysis, first-order statistics and Shannon entropy are commonly used to characterize tissue heterogeneity.\n\nStarting from the core definitions of expectation and central moments for a discrete PMF, and the definition of Shannon entropy (using the natural logarithm), do the following:\n- Compute the mean $\\,\\mu\\,$, variance $\\,\\sigma^{2}\\,$, standardized skewness $\\,\\gamma_{3}\\,$, and Shannon entropy $\\,H_{\\mathrm{nat}}\\,$ (in nats) of the intensity distribution.\n- Then, using these quantities, compute the following dimensionless heterogeneity index\n$$J \\;=\\; \\frac{\\sigma^{2}}{4} \\;+\\; \\Bigl(1 - \\frac{H_{\\mathrm{nat}}}{\\ln 5}\\Bigr) \\;+\\; \\frac{1}{2}\\,|\\gamma_{3}|,$$\nwhere the denominator $4$ in the first term is the maximum variance achievable on the support $\\{1,2,3,4,5\\}$, and $\\ln 5$ is the maximum Shannon entropy (in nats) for a $5$-bin PMF.\n\nBriefly explain, based on the computed statistics, what the implications are for tissue heterogeneity in this ROI.\n\nExpress the final numerical value of $J$ with no units, and round your final answer to four significant figures.", "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. The probability mass function (PMF) is valid, as the sum of probabilities is $\\sum p(x_i) = 0.1 + 0.2 + 0.3 + 0.25 + 0.15 = 1.0$. The problem asks for the computation of standard statistical measures and a composite index derived from them, which is a standard procedure in quantitative image analysis.\n\nThe discrete gray levels are given by the set $x \\in \\{1, 2, 3, 4, 5\\}$, and the corresponding probabilities are $p = [0.1, 0.2, 0.3, 0.25, 0.15]$. We will compute the required quantities step-by-step.\n\n1.  **Mean ($\\mu$)**\n    The mean, or expected value $E[X]$, of a discrete random variable is defined as:\n    $$ \\mu = E[X] = \\sum_{i=1}^{N} x_i p(x_i) $$\n    Substituting the given values:\n    $$ \\mu = (1)(0.1) + (2)(0.2) + (3)(0.3) + (4)(0.25) + (5)(0.15) $$\n    $$ \\mu = 0.1 + 0.4 + 0.9 + 1.0 + 0.75 $$\n    $$ \\mu = 3.15 $$\n\n2.  **Variance ($\\sigma^2$)**\n    The variance, $\\sigma^2$, is the second central moment, defined as $E[(X-\\mu)^2]$. It can be more conveniently computed using the formula $\\sigma^2 = E[X^2] - \\mu^2$. First, we compute the expected value of $X^2$:\n    $$ E[X^2] = \\sum_{i=1}^{N} x_i^2 p(x_i) $$\n    $$ E[X^2] = (1^2)(0.1) + (2^2)(0.2) + (3^2)(0.3) + (4^2)(0.25) + (5^2)(0.15) $$\n    $$ E[X^2] = (1)(0.1) + (4)(0.2) + (9)(0.3) + (16)(0.25) + (25)(0.15) $$\n    $$ E[X^2] = 0.1 + 0.8 + 2.7 + 4.0 + 3.75 $$\n    $$ E[X^2] = 11.35 $$\n    Now, we can calculate the variance:\n    $$ \\sigma^2 = E[X^2] - \\mu^2 = 11.35 - (3.15)^2 = 11.35 - 9.9225 $$\n    $$ \\sigma^2 = 1.4275 $$\n\n3.  **Standardized Skewness ($\\gamma_3$)**\n    The standardized skewness, $\\gamma_3$, is defined as the third standardized moment:\n    $$ \\gamma_3 = \\frac{E[(X-\\mu)^3]}{\\sigma^3} = \\frac{m_3}{\\sigma^3} $$\n    First, we compute the third central moment, $m_3=E[(X-\\mu)^3]$:\n    $$ m_3 = \\sum_{i=1}^{N} (x_i - \\mu)^3 p(x_i) $$\n    The deviations from the mean $(x_i-\\mu)$ are:\n    $1 - 3.15 = -2.15$\n    $2 - 3.15 = -1.15$\n    $3 - 3.15 = -0.15$\n    $4 - 3.15 = 0.85$\n    $5 - 3.15 = 1.85$\n    Substituting these into the formula for $m_3$:\n    $$ m_3 = (-2.15)^3(0.1) + (-1.15)^3(0.2) + (-0.15)^3(0.3) + (0.85)^3(0.25) + (1.85)^3(0.15) $$\n    $$ m_3 = (-9.938375)(0.1) + (-1.520875)(0.2) + (-0.003375)(0.3) + (0.614125)(0.25) + (6.331625)(0.15) $$\n    $$ m_3 = -0.9938375 - 0.304175 - 0.0010125 + 0.15353125 + 0.94974375 $$\n    $$ m_3 = -0.19575 $$\n    Next, we need the standard deviation, $\\sigma = \\sqrt{\\sigma^2} = \\sqrt{1.4275}$.\n    $$ \\sigma \\approx 1.1947803 $$\n    Now we can calculate the skewness:\n    $$ \\gamma_3 = \\frac{m_3}{\\sigma^3} = \\frac{-0.19575}{(1.4275)^{3/2}} \\approx \\frac{-0.19575}{1.706175} $$\n    $$ \\gamma_3 \\approx -0.114730 $$\n\n4.  **Shannon Entropy ($H_{\\mathrm{nat}}$)**\n    The Shannon entropy for a discrete PMF, using the natural logarithm (base $e$), is defined as:\n    $$ H_{\\mathrm{nat}} = -\\sum_{i=1}^{N} p(x_i) \\ln(p(x_i)) $$\n    $$ H_{\\mathrm{nat}} = -[0.1\\ln(0.1) + 0.2\\ln(0.2) + 0.3\\ln(0.3) + 0.25\\ln(0.25) + 0.15\\ln(0.15)] $$\n    Using the values of the natural logarithm:\n    $\\ln(0.1) \\approx -2.302585$\n    $\\ln(0.2) \\approx -1.609438$\n    $\\ln(0.3) \\approx -1.203973$\n    $\\ln(0.25) \\approx -1.386294$\n    $\\ln(0.15) \\approx -1.897120$\n    $$ H_{\\mathrm{nat}} \\approx -[0.1(-2.302585) + 0.2(-1.609438) + 0.3(-1.203973) + 0.25(-1.386294) + 0.15(-1.897120)] $$\n    $$ H_{\\mathrm{nat}} \\approx -[-0.230259 - 0.321888 - 0.361192 - 0.346574 - 0.284568] $$\n    $$ H_{\\mathrm{nat}} \\approx -[-1.544481] $$\n    $$ H_{\\mathrm{nat}} \\approx 1.544481 \\text{ nats} $$\n\n5.  **Heterogeneity Index ($J$)**\n    Now we compute the dimensionless index $J$ using the given formula:\n    $$ J = \\frac{\\sigma^{2}}{4} + \\Bigl(1 - \\frac{H_{\\mathrm{nat}}}{\\ln 5}\\Bigr) + \\frac{1}{2}|\\gamma_{3}| $$\n    We substitute the calculated values:\n    $\\sigma^2 = 1.4275$\n    $H_{\\mathrm{nat}} \\approx 1.544481$\n    $\\gamma_3 \\approx -0.114730$\n    The maximum entropy for a $5$-level system is $H_{\\mathrm{max}} = \\ln(5) \\approx 1.609438$.\n    Let's compute each term of $J$:\n    Term 1: $\\frac{\\sigma^2}{4} = \\frac{1.4275}{4} = 0.356875$\n    Term 2: $1 - \\frac{H_{\\mathrm{nat}}}{\\ln 5} \\approx 1 - \\frac{1.544481}{1.609438} \\approx 1 - 0.959639 = 0.040361$\n    Term 3: $\\frac{1}{2}|\\gamma_3| \\approx \\frac{1}{2}|-0.114730| = \\frac{1}{2}(0.114730) = 0.057365$\n    Summing the terms to find $J$:\n    $$ J \\approx 0.356875 + 0.040361 + 0.057365 $$\n    $$ J \\approx 0.454601 $$\n    Rounding to four significant figures, we get $J \\approx 0.4546$.\n\n**Interpretation of Heterogeneity:**\nThe computed statistics provide insight into the tissue's properties as captured by the ROI's intensity distribution.\n- The **mean** ($\\mu=3.15$) indicates the average gray level is slightly brighter than the midpoint of the scale.\n- The **variance** ($\\sigma^2=1.4275$) is a direct measure of heterogeneity. The normalized variance term $\\sigma^2/4 \\approx 0.357$ shows that the dispersion of gray levels is moderate, at about $36\\%$ of the maximum possible for this scale. This suggests a notable but not extreme variation in tissue density.\n- The **skewness** ($\\gamma_3 \\approx -0.115$) is slightly negative, implying a minor asymmetry with a tail towards lower (darker) gray levels. Its small magnitude means the distribution is nearly symmetric, so this aspect of heterogeneity is not prominent.\n- The **entropy** ($H_{\\mathrm{nat}} \\approx 1.544$) is very close to the maximum possible entropy ($\\ln 5 \\approx 1.609$). This is reflected in the normalized entropy term $(1 - H/\\ln 5) \\approx 0.040$, which is very small. High entropy indicates a high degree of randomness or unpredictability in the gray-level distribution, a key characteristic of complex, heterogeneous tissue textures.\n\nIn summary, the ROI exhibits moderate to high heterogeneity. The high entropy points to a complex texture where many gray levels are present, while the moderate variance confirms a significant spread of these levels. The low skewness indicates that this spread is relatively balanced around the mean. The composite index $J$ synthesizes these features into a single metric.", "answer": "$$\\boxed{0.4546}$$", "id": "4917108"}, {"introduction": "To capture the fine-grained texture of a tissue, we must analyze the spatial relationships between pixels, a task that goes beyond simple histograms. The Gray Level Co-occurrence Matrix (GLCM) is a cornerstone of texture analysis, tabulating how often different gray-level pairs occur at a specific spatial offset. This problem [@problem_id:4917111] gives you direct experience in calculating key texture features—Contrast and Energy—from a GLCM, providing insight into textural roughness and uniformity.", "problem": "A region-of-interest from a computed tomography image has been quantized to $3$ gray levels and analyzed with a Gray Level Co-occurrence Matrix (GLCM), interpreted as a joint probability mass function over co-occurring gray-level pairs $(i,j)$ separated by a fixed displacement. The normalized GLCM is\n$$\nP=\\begin{bmatrix}\n0.2  0.1  0 \\\\\n0.1  0.3  0.1 \\\\\n0  0.1  0.1\n\\end{bmatrix},\n$$\nwhere indices follow $i,j \\in \\{0,1,2\\}$ and $\\sum_{i=0}^{2}\\sum_{j=0}^{2} P(i,j)=1$. Starting from the probabilistic interpretation of the GLCM and the definitions of second-order moment-type texture descriptors, derive expressions for the contrast and the energy of this texture in terms of $P(i,j)$, compute their numerical values for the given $P$, and briefly interpret what their magnitudes imply about the texture’s roughness relative to a highly uniform versus a highly heterogeneous pattern. Round your numerical results to four significant figures. Report both values in the order contrast, energy. The quantities are dimensionless and require no units.", "solution": "The problem is valid as it is scientifically grounded in the principles of quantitative texture analysis, is well-posed with a complete and consistent setup, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe problem requires the derivation and calculation of two second-order texture features, contrast and energy, from a given Gray Level Co-occurrence Matrix (GLCM), $P$. The image is quantized to $N_g=3$ gray levels, indexed as $i,j \\in \\{0, 1, 2\\}$. The normalized GLCM, representing the joint probability mass function $P(i,j)$ of gray-level pairs, is given by:\n$$\nP=\\begin{bmatrix}\nP(0,0)  P(0,1)  P(0,2) \\\\\nP(1,0)  P(1,1)  P(1,2) \\\\\nP(2,0)  P(2,1)  P(2,2)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0.2  0.1  0 \\\\\n0.1  0.3  0.1 \\\\\n0  0.1  0.1\n\\end{bmatrix}\n$$\nThe problem confirms that $\\sum_{i=0}^{2}\\sum_{j=0}^{2} P(i,j)=1$, which is a necessary property of a normalized GLCM.\n\nFirst, we derive the expression for **Contrast**. Contrast is a measure of the local intensity variation in an image. It is defined as a moment of the GLCM, specifically examining the distribution of entries with respect to the main diagonal. The expression for contrast is:\n$$\n\\text{Contrast} = \\sum_{i=0}^{N_g-1} \\sum_{j=0}^{N_g-1} (i-j)^2 P(i,j)\n$$\nFor our specific case with $N_g=3$, the indices $i$ and $j$ range from $0$ to $2$. The calculation proceeds by summing the products of $(i-j)^2$ and the corresponding matrix element $P(i,j)$ for all $i,j \\in \\{0,1,2\\}$:\n$$\n\\text{Contrast} = (0-0)^2 P(0,0) + (0-1)^2 P(0,1) + (0-2)^2 P(0,2) \\\\\n+ (1-0)^2 P(1,0) + (1-1)^2 P(1,1) + (1-2)^2 P(1,2) \\\\\n+ (2-0)^2 P(2,0) + (2-1)^2 P(2,1) + (2-2)^2 P(2,2)\n$$\nSubstituting the numerical values from the given matrix $P$:\n$$\n\\text{Contrast} = (0)^2(0.2) + (-1)^2(0.1) + (-2)^2(0) \\\\\n+ (1)^2(0.1) + (0)^2(0.3) + (-1)^2(0.1) \\\\\n+ (2)^2(0) + (1)^2(0.1) + (0)^2(0.1)\n$$\n$$\n\\text{Contrast} = 0 \\cdot (0.2) + 1 \\cdot (0.1) + 4 \\cdot (0) + 1 \\cdot (0.1) + 0 \\cdot (0.3) + 1 \\cdot (0.1) + 4 \\cdot (0) + 1 \\cdot (0.1) + 0 \\cdot (0.1)\n$$\n$$\n\\text{Contrast} = 0 + 0.1 + 0 + 0.1 + 0 + 0.1 + 0 + 0.1 + 0 = 0.4\n$$\nRounding to four significant figures, the contrast is $0.4000$.\n\nNext, we derive the expression for **Energy**. Energy, also known as the Angular Second Moment (ASM), is a measure of textural uniformity. It is calculated from the sum of the squared elements of the GLCM. A higher energy value indicates a more orderly and homogeneous texture. The expression for energy is:\n$$\n\\text{Energy} = \\sum_{i=0}^{N_g-1} \\sum_{j=0}^{N_g-1} P(i,j)^2\n$$\nFor our specific case, the calculation is:\n$$\n\\text{Energy} = P(0,0)^2 + P(0,1)^2 + P(0,2)^2 \\\\\n+ P(1,0)^2 + P(1,1)^2 + P(1,2)^2 \\\\\n+ P(2,0)^2 + P(2,1)^2 + P(2,2)^2\n$$\nSubstituting the numerical values from the matrix $P$:\n$$\n\\text{Energy} = (0.2)^2 + (0.1)^2 + (0)^2 + (0.1)^2 + (0.3)^2 + (0.1)^2 + (0)^2 + (0.1)^2 + (0.1)^2\n$$\n$$\n\\text{Energy} = 0.04 + 0.01 + 0 + 0.01 + 0.09 + 0.01 + 0 + 0.01 + 0.01\n$$\n$$\n\\text{Energy} = 0.18\n$$\nRounding to four significant figures, the energy is $0.1800$.\n\nFinally, we interpret the magnitudes of these values.\nA **highly uniform** texture, where most pixels have the same or very similar gray levels, would result in a GLCM with high-magnitude entries concentrated along the main diagonal ($i=j$). This would lead to a very low contrast (approaching $0$) and a very high energy (approaching $1$, the theoretical maximum for a single non-zero element).\nA **highly heterogeneous** or rough texture, with large variations between adjacent pixel values, would populate the GLCM with significant entries far from the main diagonal ($|i-j|$ is large). This would result in a high contrast value. The probability mass would be spread across many entries, leading to low energy.\n\nOur calculated values are $\\text{Contrast} = 0.4$ and $\\text{Energy} = 0.18$.\nThe contrast value of $0.4$ is relatively low. The maximum possible contrast for $N_g=3$ would be $(2-0)^2=4$, but this would require all probability to be concentrated at $P(0,2)$ and $P(2,0)$. Our value is much smaller, indicating that co-occurring gray-level pairs do not often have large differences. This is consistent with the GLCM having zero entries for the largest difference, i.e., $P(0,2)=P(2,0)=0$.\nThe energy value of $0.18$ is also relatively low. The energy ranges from $1/N_g^2 = 1/9 \\approx 0.1111$ (for a perfectly uniform distribution of probabilities) to $1$ (for a single probability of $1$). Our value is closer to the minimum than the maximum, which suggests that the texture is not highly ordered or periodic. The probabilities are spread out among several co-occurrence pairs rather than being concentrated in one or two.\n\nIn conclusion, the combination of a low contrast and low energy suggests a texture that is neither perfectly smooth nor extremely rough. It indicates a moderate level of heterogeneity, but without sharp, high-contrast variations between neighboring regions. The texture pattern is complex rather than simple and repetitive.\n\nThe numerical results for contrast and energy, rounded to four significant figures, are $0.4000$ and $0.1800$, respectively.", "answer": "$$\\boxed{\\begin{pmatrix} 0.4000  0.1800 \\end{pmatrix}}$$", "id": "4917111"}]}