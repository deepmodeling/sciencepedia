{"hands_on_practices": [{"introduction": "This practice will ground you in the fundamental building blocks of ROC analysis. Before we can analyze a full ROC curve, we must understand how a single point on that curve is generated. Using a hypothetical set of scores for diseased and non-diseased subjects, you will apply a specific decision threshold to classify each subject and build a confusion matrix. This exercise [@problem_id:4918260] will solidify your understanding of True Positive Rate ($\\mathrm{TPR}$) and False Positive Rate ($\\mathrm{FPR}$) as the essential coordinates that define a classifier's performance at a given operating point.", "problem": "In a diagnostic task within foundations of medical imaging, a scalar imaging biomarker score $s$ is used to decide disease presence by thresholding: classify as positive if $s \\ge \\tau$ and negative otherwise. Consider a sample of diseased subjects with scores $\\{2.1, 1.8, 3.3, 0.9\\}$ and nondiseased subjects with scores $\\{0.5, 0.7, 1.2, 2.4, 2.6\\}$, and set the threshold at $\\tau = 2.0$. Using the definitions of the confusion matrix categories under this rule—true positive, false negative, true negative, and false positive—construct the confusion matrix counts. Then, using the fundamental definitions of the True Positive Rate ($\\mathrm{TPR}$) and False Positive Rate ($\\mathrm{FPR}$) from receiver operating characteristic (ROC) analysis, compute the values of $\\mathrm{TPR}$ and $\\mathrm{FPR}$. Finally, compute the Youden index $J$, defined as $J = \\mathrm{TPR} - \\mathrm{FPR}$.\n\nRound your final numerical answer for $J$ to four significant figures and express it as a decimal fraction.", "solution": "The classification rule is to label a case as positive if $s \\ge \\tau$ and negative otherwise, with $\\tau = 2.0$. The diseased scores are given by the set $\\{2.1, 1.8, 3.3, 0.9\\}$ and the nondiseased scores by $\\{0.5, 0.7, 1.2, 2.4, 2.6\\}$. Receiver operating characteristic (ROC) analysis defines the True Positive Rate (TPR) as the proportion of diseased cases correctly classified as positive, and the False Positive Rate (FPR) as the proportion of nondiseased cases incorrectly classified as positive. Formally, with counts for true positives, false negatives, true negatives, and false positives denoted by $\\mathrm{TP}$, $\\mathrm{FN}$, $\\mathrm{TN}$, and $\\mathrm{FP}$, the definitions are\n$$\n\\mathrm{TPR} = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}, \\quad \\mathrm{FPR} = \\frac{\\mathrm{FP}}{\\mathrm{FP} + \\mathrm{TN}}.\n$$\n\nWe first construct the confusion matrix counts by applying the threshold to each score.\n\nFor the diseased set $\\{2.1, 1.8, 3.3, 0.9\\}$ at $\\tau = 2.0$:\n- The scores $2.1$ and $3.3$ satisfy $s \\ge 2.0$ and are classified as positive; since these subjects are diseased, they contribute to $\\mathrm{TP}$. Thus, $\\mathrm{TP} = 2$.\n- The scores $1.8$ and $0.9$ satisfy $s < 2.0$ and are classified as negative; since these subjects are diseased, they contribute to $\\mathrm{FN}$. Thus, $\\mathrm{FN} = 2$.\n\nFor the nondiseased set $\\{0.5, 0.7, 1.2, 2.4, 2.6\\}$ at $\\tau = 2.0$:\n- The scores $2.4$ and $2.6$ satisfy $s \\ge 2.0$ and are classified as positive; since these subjects are nondiseased, they contribute to $\\mathrm{FP}$. Thus, $\\mathrm{FP} = 2$.\n- The scores $0.5$, $0.7$, and $1.2$ satisfy $s < 2.0$ and are classified as negative; since these subjects are nondiseased, they contribute to $\\mathrm{TN}$. Thus, $\\mathrm{TN} = 3$.\n\nWith these counts, we compute the True Positive Rate and False Positive Rate using the definitions:\n$$\n\\mathrm{TPR} = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}} = \\frac{2}{2 + 2} = \\frac{2}{4} = 0.5,\n$$\n$$\n\\mathrm{FPR} = \\frac{\\mathrm{FP}}{\\mathrm{FP} + \\mathrm{TN}} = \\frac{2}{2 + 3} = \\frac{2}{5} = 0.4.\n$$\n\nThe Youden index $J$ is defined as $J = \\mathrm{TPR} - \\mathrm{FPR}$, so we have\n$$\nJ = 0.5 - 0.4 = 0.1.\n$$\n\nRounding $J$ to four significant figures and expressing it as a decimal fraction yields $0.1000$.", "answer": "$$\\boxed{0.1000}$$", "id": "4918260"}, {"introduction": "A single operating point gives only a partial picture of a diagnostic test's performance. To evaluate a test comprehensively, we must understand its behavior across all possible decision thresholds, which is precisely what the full ROC curve shows. In this practice [@problem_id:4918235], you will move from a single point to constructing the entire empirical ROC curve from a set of scores. You will learn the standard procedure for generating the curve's vertices and then calculate the Area Under the Curve (AUC) using the trapezoidal rule, a key metric summarizing overall diagnostic accuracy.", "problem": "A binary diagnostic task in medical imaging is evaluated using Receiver Operating Characteristic (ROC) analysis. A classifier produces continuous confidence scores in the interval $[0,1]$ that reflect the likelihood of disease. For a threshold $\\tau$, the decision rule is: declare an image positive (diseased) if its score is $\\ge \\tau$ and negative (nondiseased) otherwise. The True Positive Rate ($\\mathrm{TPR}$, sensitivity) at threshold $\\tau$ is defined as the fraction of diseased cases declared positive, and the False Positive Rate ($\\mathrm{FPR}$, one minus specificity) is the fraction of nondiseased cases declared positive.\n\nYou are given three diseased-case scores $\\{0.3,\\,0.6,\\,0.9\\}$ and four nondiseased-case scores $\\{0.1,\\,0.2,\\,0.4,\\,0.8\\}$. Using the empirical definitions above:\n\n1) Construct the empirical ROC curve by enumerating the unique thresholds $\\tau$ drawn from the union of the given scores, augmented with endpoint conventions $\\tau>\\max$ (no cases positive) and $\\tau\\le\\min$ (all cases positive). For each threshold, compute the corresponding point $(\\mathrm{FPR},\\,\\mathrm{TPR})$.\n\n2) From the empirical ROC curve, compute the Area Under the Curve (AUC) by summing the areas of the trapezoids formed between successive points along the $\\mathrm{FPR}$ axis.\n\nExpress the final AUC as a single exact fraction. No units are required.", "solution": "The problem requires the construction of an empirical ROC curve and the calculation of the Area Under this Curve (AUC) for a given set of classifier scores.\n\nFirst, we establish the given information. The set of scores for diseased cases is $S_D = \\{0.3, 0.6, 0.9\\}$, and the number of diseased cases is $N_D = 3$. The set of scores for nondiseased cases is $S_{ND} = \\{0.1, 0.2, 0.4, 0.8\\}$, and the number of nondiseased cases is $N_{ND} = 4$.\n\nA decision threshold $\\tau$ is applied to the scores. A case is classified as positive if its score is greater than or equal to $\\tau$.\nThe True Positive Rate, $\\mathrm{TPR}(\\tau)$, is the fraction of diseased cases with scores $\\ge \\tau$:\n$$ \\mathrm{TPR}(\\tau) = \\frac{|\\{s \\in S_D \\mid s \\ge \\tau\\}|}{N_D} $$\nThe False Positive Rate, $\\mathrm{FPR}(\\tau)$, is the fraction of nondiseased cases with scores $\\ge \\tau$:\n$$ \\mathrm{FPR}(\\tau) = \\frac{|\\{s \\in S_{ND} \\mid s \\ge \\tau\\}|}{N_{ND}} $$\nThe ROC curve is a plot of $\\mathrm{TPR}$ versus $\\mathrm{FPR}$ for all possible thresholds $\\tau$.\n\nPart 1: Construct the empirical ROC curve.\nThe vertices of the empirical ROC curve are generated by considering thresholds at the values of the given scores. A standard method is to sort all scores in descending order and move the threshold down past each score. This generates a path on the $\\mathrm{FPR}$-$\\mathrm{TPR}$ plane.\nThe combined set of scores, sorted in descending order with their class (D for diseased, ND for nondiseased), is:\n$0.9(\\text{D}), 0.8(\\text{ND}), 0.6(\\text{D}), 0.4(\\text{ND}), 0.3(\\text{D}), 0.2(\\text{ND}), 0.1(\\text{ND})$\n\nThe curve starts at the point $(0, 0)$, which corresponds to a threshold $\\tau > 0.9$ where no cases are classified as positive. As the threshold is lowered, for each diseased case encountered, the curve moves up by a step of size $\\frac{1}{N_D} = \\frac{1}{3}$. For each nondiseased case encountered, the curve moves to the right by a step of size $\\frac{1}{N_{ND}} = \\frac{1}{4}$.\n\nLet the ordered points on the ROC curve be $(x_i, y_i)$, where $x_i = \\mathrm{FPR}$ and $y_i = \\mathrm{TPR}$.\n1.  Start at point $p_0 = (x_0, y_0) = (0, 0)$.\n2.  The highest score is $0.9$, which is from a diseased case. The curve moves up. $p_1 = (0, 0 + \\frac{1}{3}) = (0, \\frac{1}{3})$.\n3.  The next score is $0.8$, from a nondiseased case. The curve moves right. $p_2 = (0 + \\frac{1}{4}, \\frac{1}{3}) = (\\frac{1}{4}, \\frac{1}{3})$.\n4.  The next score is $0.6$, from a diseased case. The curve moves up. $p_3 = (\\frac{1}{4}, \\frac{1}{3} + \\frac{1}{3}) = (\\frac{1}{4}, \\frac{2}{3})$.\n5.  The next score is $0.4$, from a nondiseased case. The curve moves right. $p_4 = (\\frac{1}{4} + \\frac{1}{4}, \\frac{2}{3}) = (\\frac{1}{2}, \\frac{2}{3})$.\n6.  The next score is $0.3$, from a diseased case. The curve moves up. $p_5 = (\\frac{1}{2}, \\frac{2}{3} + \\frac{1}{3}) = (\\frac{1}{2}, 1)$.\n7.  The next score is $0.2$, from a nondiseased case. The curve moves right. $p_6 = (\\frac{1}{2} + \\frac{1}{4}, 1) = (\\frac{3}{4}, 1)$.\n8.  The final score is $0.1$, from a nondiseased case. The curve moves right. $p_7 = (\\frac{3}{4} + \\frac{1}{4}, 1) = (1, 1)$.\n\nThe sequence of vertices for the empirical ROC curve is:\n$p_0 = (0, 0)$\n$p_1 = (0, \\frac{1}{3})$\n$p_2 = (\\frac{1}{4}, \\frac{1}{3})$\n$p_3 = (\\frac{1}{4}, \\frac{2}{3})$\n$p_4 = (\\frac{1}{2}, \\frac{2}{3})$\n$p_5 = (\\frac{1}{2}, 1)$\n$p_6 = (\\frac{3}{4}, 1)$\n$p_7 = (1, 1)$\n\nPart 2: Compute the Area Under the Curve (AUC).\nThe AUC is calculated by summing the areas of the trapezoids formed by consecutive points $(x_{i-1}, y_{i-1})$ and $(x_i, y_i)$ and the $\\mathrm{FPR}$ axis. The area of each trapezoid is given by the formula:\n$$ A_i = (x_i - x_{i-1}) \\times \\frac{y_i + y_{i-1}}{2} $$\nThe total AUC is the sum of these areas:\n$$ \\mathrm{AUC} = \\sum_{i=1}^{7} A_i = \\sum_{i=1}^{7} (x_i - x_{i-1}) \\times \\frac{y_i + y_{i-1}}{2} $$\nWe compute the area for each segment of the curve:\n-   Area between $p_0$ and $p_1$: $A_1 = (0 - 0) \\times \\frac{\\frac{1}{3} + 0}{2} = 0$.\n-   Area between $p_1$ and $p_2$: $A_2 = (\\frac{1}{4} - 0) \\times \\frac{\\frac{1}{3} + \\frac{1}{3}}{2} = \\frac{1}{4} \\times \\frac{1}{3} = \\frac{1}{12}$.\n-   Area between $p_2$ and $p_3$: $A_3 = (\\frac{1}{4} - \\frac{1}{4}) \\times \\frac{\\frac{2}{3} + \\frac{1}{3}}{2} = 0$.\n-   Area between $p_3$ and $p_4$: $A_4 = (\\frac{1}{2} - \\frac{1}{4}) \\times \\frac{\\frac{2}{3} + \\frac{2}{3}}{2} = \\frac{1}{4} \\times \\frac{2}{3} = \\frac{2}{12} = \\frac{1}{6}$.\n-   Area between $p_4$ and $p_5$: $A_5 = (\\frac{1}{2} - \\frac{1}{2}) \\times \\frac{1 + \\frac{2}{3}}{2} = 0$.\n-   Area between $p_5$ and $p_6$: $A_6 = (\\frac{3}{4} - \\frac{1}{2}) \\times \\frac{1 + 1}{2} = \\frac{1}{4} \\times 1 = \\frac{1}{4}$.\n-   Area between $p_6$ and $p_7$: $A_7 = (1 - \\frac{3}{4}) \\times \\frac{1 + 1}{2} = \\frac{1}{4} \\times 1 = \\frac{1}{4}$.\n\nThe total AUC is the sum of these individual areas:\n$$ \\mathrm{AUC} = 0 + \\frac{1}{12} + 0 + \\frac{1}{6} + 0 + \\frac{1}{4} + \\frac{1}{4} $$\nTo sum these fractions, we find a common denominator, which is $12$:\n$$ \\mathrm{AUC} = \\frac{1}{12} + \\frac{2}{12} + \\frac{3}{12} + \\frac{3}{12} = \\frac{1+2+3+3}{12} = \\frac{9}{12} $$\nSimplifying the fraction gives the final result:\n$$ \\mathrm{AUC} = \\frac{3}{4} $$\nThis result can be verified using the Wilcoxon-Mann-Whitney U statistic, which states that the AUC is the probability that a randomly selected diseased case will have a higher score than a randomly selected nondiseased case. The number of pairs of one diseased and one nondiseased case is $N_D \\times N_{ND} = 3 \\times 4 = 12$. The number of pairs where the diseased score is higher is found to be $9$. Thus, the AUC is $\\frac{9}{12} = \\frac{3}{4}$, confirming our calculation.", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "4918235"}, {"introduction": "While empirical ROC curves are built directly from observed data, theoretical models help us understand the underlying principles and predict performance. The binormal model, which assumes that scores from diseased and non-diseased populations follow Gaussian distributions, is a cornerstone of ROC theory. This exercise [@problem_id:4918289] challenges you to calculate the AUC directly from the parameters of these distributions. This will deepen your intuition for what the AUC represents: the probability that a randomly selected diseased subject has a more suspicious score than a randomly selected non-diseased subject.", "problem": "A diagnostic scoring system derived from a medical imaging modality assigns a continuous score to each subject. Let the score for non-diseased subjects be modeled as a Gaussian random variable $S_{0} \\sim \\mathcal{N}(0, 1)$ and the score for diseased subjects be modeled as an independent Gaussian random variable $S_{1} \\sim \\mathcal{N}(1, 2^{2})$. Under the binormal model, the receiver operating characteristic (ROC) curve is generated by thresholding the score. Using foundational definitions from detection theory and probability, compute the area under the receiver operating characteristic curve (AUC) for this model from first principles, starting from the definition that the AUC equals the probability that a randomly chosen diseased subject has a higher score than a randomly chosen non-diseased subject. Provide the final numerical value of the $\\mathrm{AUC}$ rounded to $4$ significant figures. Then, briefly discuss what this value implies about diagnostic performance and how the unequal variances influence the $\\mathrm{AUC}$ relative to an equal-variance scenario. Only report the numerical $\\mathrm{AUC}$ as your final answer.", "solution": "The problem asks for the computation of the AUC for a diagnostic test. The scores for non-diseased subjects are given by the random variable $S_0 \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$, where the mean $\\mu_0 = 0$ and the variance $\\sigma_0^2 = 1$. The scores for diseased subjects are given by the independent random variable $S_1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$, where the mean $\\mu_1 = 1$ and the variance $\\sigma_1^2 = 2^2 = 4$.\n\nThe AUC is defined from first principles as the probability that a randomly chosen diseased subject has a higher score than a randomly chosen non-diseased subject. Mathematically, this is expressed as:\n$$\n\\mathrm{AUC} = P(S_1 > S_0)\n$$\nTo calculate this probability, we can define a new random variable, $D$, as the difference between the scores of a diseased subject and a non-diseased subject:\n$$\nD = S_1 - S_0\n$$\nThe probability $P(S_1 > S_0)$ is then equivalent to $P(D > 0)$.\n\nSince $S_1$ and $S_0$ are independent Gaussian random variables, their difference, $D$, is also a Gaussian random variable. The mean of $D$, denoted $\\mu_D$, is the difference of the means of $S_1$ and $S_0$:\n$$\n\\mu_D = E[D] = E[S_1 - S_0] = E[S_1] - E[S_0] = \\mu_1 - \\mu_0 = 1 - 0 = 1\n$$\nThe variance of $D$, denoted $\\sigma_D^2$, is the sum of the variances of $S_1$ and $S_0$ because they are independent variables:\n$$\n\\sigma_D^2 = \\text{Var}(D) = \\text{Var}(S_1 - S_0) = \\text{Var}(S_1) + \\text{Var}(-S_0) = \\text{Var}(S_1) + (-1)^2 \\text{Var}(S_0) = \\sigma_1^2 + \\sigma_0^2 = 4 + 1 = 5\n$$\nSo, the distribution of the difference variable $D$ is $D \\sim \\mathcal{N}(1, 5)$.\n\nNow we compute the probability $P(D > 0)$. To do this, we standardize the random variable $D$ to a standard normal variable $Z \\sim \\mathcal{N}(0, 1)$ using the transformation $Z = \\frac{D - \\mu_D}{\\sigma_D}$:\n$$\nP(D > 0) = P\\left(\\frac{D - \\mu_D}{\\sigma_D} > \\frac{0 - \\mu_D}{\\sigma_D}\\right)\n$$\nSubstituting the values $\\mu_D = 1$ and $\\sigma_D = \\sqrt{5}$:\n$$\nP(D > 0) = P\\left(Z > \\frac{-1}{\\sqrt{5}}\\right)\n$$\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, defined as $\\Phi(z) = P(Z \\le z)$. The probability $P(Z > a)$ is equal to $1 - P(Z \\le a) = 1 - \\Phi(a)$.\n$$\nP\\left(Z > \\frac{-1}{\\sqrt{5}}\\right) = 1 - \\Phi\\left(\\frac{-1}{\\sqrt{5}}\\right)\n$$\nUsing the symmetry property of the standard normal distribution, $\\Phi(-z) = 1 - \\Phi(z)$, we can rewrite the expression:\n$$\n\\mathrm{AUC} = 1 - \\left(1 - \\Phi\\left(\\frac{1}{\\sqrt{5}}\\right)\\right) = \\Phi\\left(\\frac{1}{\\sqrt{5}}\\right)\n$$\nThis result conforms to the general formula for the AUC of a binormal model: $\\mathrm{AUC} = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}\\right)$.\n\nTo find the numerical value, we first calculate the argument of $\\Phi$:\n$$\n\\frac{1}{\\sqrt{5}} \\approx \\frac{1}{2.2360679...} \\approx 0.4472136\n$$\nWe then evaluate the standard normal CDF at this value:\n$$\n\\mathrm{AUC} = \\Phi(0.4472136) \\approx 0.672635\n$$\nRounding to $4$ significant figures, we get $\\mathrm{AUC} = 0.6726$.\n\nA brief discussion on this result:\nAn AUC of $1.0$ represents a perfect diagnostic test, while an AUC of $0.5$ represents a test with no diagnostic ability (equivalent to random guessing). The calculated value of $\\mathrm{AUC} \\approx 0.6726$ indicates that the diagnostic performance is better than chance but is generally considered poor to fair. It signifies that there is a $67.26\\%$ probability that a randomly drawn subject from the diseased population will have a higher score than a randomly drawn subject from the non-diseased population.\n\nThe unequal variances have a significant impact on the AUC. The denominator of the argument to $\\Phi$ is $\\sqrt{\\sigma_1^2 + \\sigma_0^2} = \\sqrt{5}$. Let's consider a comparable equal-variance scenario where both distributions have the same variance as the non-diseased population, i.e., $\\sigma_0^2 = \\sigma_1^2 = 1$. In that case, the AUC would be:\n$$\n\\mathrm{AUC}_{eq} = \\Phi\\left(\\frac{1 - 0}{\\sqrt{1^2 + 1^2}}\\right) = \\Phi\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx \\Phi(0.7071) \\approx 0.7602\n$$\nThe AUC is lower in the given problem ($0.6726$) than in this equal-variance case ($0.7602$). The reason is that the AUC is sensitive to the total variance of the difference, $\\sigma_1^2 + \\sigma_0^2$. The large variance of the diseased population ($\\sigma_1^2 = 4$) significantly increases this sum, leading to a larger denominator in the term $\\frac{\\mu_1 - \\mu_0}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}$. A smaller argument for the monotonically increasing function $\\Phi(z)$ results in a smaller AUC. Essentially, the greater spread (variance) of the diseased-subject scores causes more overlap with the non-diseased-subject scores, thereby degrading the discriminatory power of the test.", "answer": "$$\n\\boxed{0.6726}\n$$", "id": "4918289"}]}