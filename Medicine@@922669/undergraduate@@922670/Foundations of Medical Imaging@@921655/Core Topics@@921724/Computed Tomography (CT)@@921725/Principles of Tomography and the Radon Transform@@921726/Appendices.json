{"hands_on_practices": [{"introduction": "While the ultimate goal of tomography is often a full image reconstruction, the projection data itself holds a wealth of information. This exercise explores a powerful shortcut, demonstrating how global properties of an object, such as its center of mass and spatial distribution, can be determined directly from the moments of its projections without needing to perform a full, computationally expensive reconstruction [@problem_id:4913422]. Mastering this concept provides insight into data consistency checks and efficient methods for object alignment in real-world imaging systems.", "problem": "A two-dimensional object with spatial distribution $f(x,y)$ represents a normalized cross-sectional property relevant to Computed Tomography (CT). The object is compactly supported and integrable, and all coordinates are in normalized units (no physical units). Consider its projections characterized by the Radon transform. Let the projection at angle $\\theta$ (measured in radians) be defined by the Radon transform\n$$\np(\\theta,s) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,\\delta\\!\\big(s - x\\cos(\\theta) - y\\sin(\\theta)\\big)\\,dx\\,dy,\n$$\nwhere $\\delta(\\cdot)$ is the Dirac delta distribution and $s$ is the signed distance to the origin along the normal to the projection line.\n\nDefine the $n$-th projection moment as\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n}\\,p(\\theta,s)\\,ds.\n$$\n\nStarting only from these definitions and from the definitions of the object’s centroid and second moments,\n$$\nM = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,dx\\,dy,\\quad\n\\boldsymbol{\\mu} = \\frac{1}{M}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\begin{pmatrix} x \\\\ y \\end{pmatrix} f(x,y)\\,dx\\,dy,\n$$\n$$\n\\mathbf{R} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\begin{pmatrix} x \\\\ y \\end{pmatrix}\\begin{pmatrix} x & y \\end{pmatrix} f(x,y)\\,dx\\,dy,\\quad\n\\mathbf{C} = \\frac{1}{M}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(\\begin{pmatrix} x \\\\ y \\end{pmatrix} - \\boldsymbol{\\mu}\\big)\\big(\\begin{pmatrix} x & y \\end{pmatrix} - \\boldsymbol{\\mu}^{\\top}\\big) f(x,y)\\,dx\\,dy,\n$$\nderive the first two moment conditions $m_1(\\theta)$ and $m_2(\\theta)$ by interchanging the order of integration and evaluating the Dirac delta integral. Explicitly relate $m_1(\\theta)$ to the centroid $\\boldsymbol{\\mu}$ and $m_2(\\theta)$ to the raw second moment matrix $\\mathbf{R}$ (or equivalently, to the covariance matrix $\\mathbf{C}$ and the centroid $\\boldsymbol{\\mu}$).\n\nThen, apply your derived relations to the specific normalized object with total mass $M = 1$, centroid\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix},\n$$\nand covariance matrix\n$$\n\\mathbf{C} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\nExpress the first and second projection moments $m_1(\\theta)$ and $m_2(\\theta)$ as explicit functions of $\\theta$ in radians. No rounding is required. Provide your final answer as a single row matrix containing $m_1(\\theta)$ and $m_2(\\theta)$, in that order.", "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, objective, and self-contained. The definitions provided for the Radon transform, projection moments, and statistical moments of the object distribution are standard in the field of computed tomography and mathematical image analysis. The numerical values for the specific object are physically and mathematically consistent, as the given covariance matrix is symmetric and positive definite. Therefore, the problem is valid, and a complete solution can be derived.\n\nThe primary task is to derive expressions for the first and second projection moments, $m_1(\\theta)$ and $m_2(\\theta)$, and then apply these to a specific case.\n\nWe begin with the definition of the $n$-th projection moment, $m_n(\\theta)$:\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n}\\,p(\\theta,s)\\,ds\n$$\nWe substitute the definition of the Radon transform, $p(\\theta,s)$:\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n} \\left( \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,\\delta\\big(s - x\\cos(\\theta) - y\\sin(\\theta)\\big)\\,dx\\,dy \\right) ds\n$$\nAs suggested, we interchange the order of integration. This is permissible as the function $f(x,y)$ is compactly supported and integrable.\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y) \\left( \\int_{-\\infty}^{\\infty} s^{n}\\,\\delta\\big(s - (x\\cos(\\theta) + y\\sin(\\theta))\\big)\\,ds \\right) dx\\,dy\n$$\nThe inner integral with respect to $s$ can be evaluated using the sifting property of the Dirac delta distribution, $\\int_{-\\infty}^{\\infty} g(t)\\delta(t-a)dt = g(a)$. In this case, the variable of integration is $s$, the function is $g(s) = s^n$, and the shift is $a = x\\cos(\\theta) + y\\sin(\\theta)$. The integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} s^{n}\\,\\delta\\big(s - (x\\cos(\\theta) + y\\sin(\\theta))\\big)\\,ds = \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^n\n$$\nSubstituting this result back gives the general expression for the $n$-th projection moment, often known as the projection-slice theorem for moments:\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^n f(x,y) \\,dx\\,dy\n$$\n\nNow, we derive the expressions for $m_1(\\theta)$ and $m_2(\\theta)$.\n\nFor the first moment ($n=1$):\n$$\nm_1(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big) f(x,y) \\,dx\\,dy\n$$\nBy linearity of the integral, we can separate the terms:\n$$\nm_1(\\theta) = \\cos(\\theta)\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} x f(x,y) \\,dx\\,dy + \\sin(\\theta)\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} y f(x,y) \\,dx\\,dy\n$$\nFrom the definition of the centroid, $\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_x \\\\ \\mu_y \\end{pmatrix}$, we have the components of the first raw moment vector $\\int\\int \\begin{pmatrix} x \\\\ y \\end{pmatrix} f(x,y) \\,dx\\,dy = M\\boldsymbol{\\mu}$. Specifically:\n$$\n\\int\\int x f(x,y) \\,dx\\,dy = M\\mu_x \\quad \\text{and} \\quad \\int\\int y f(x,y) \\,dx\\,dy = M\\mu_y\n$$\nSubstituting these into the expression for $m_1(\\theta)$ yields:\n$$\nm_1(\\theta) = M(\\mu_x \\cos(\\theta) + \\mu_y \\sin(\\theta))\n$$\nThis can be expressed compactly using vector notation. Let $\\mathbf{u}(\\theta) = \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix}$. Then:\n$$\nm_1(\\theta) = M \\boldsymbol{\\mu}^{\\top} \\mathbf{u}(\\theta)\n$$\nThis is the required relationship between $m_1(\\theta)$ and the centroid $\\boldsymbol{\\mu}$.\n\nFor the second moment ($n=2$):\n$$\nm_2(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^2 f(x,y) \\,dx\\,dy\n$$\nExpanding the squared term:\n$$\nm_2(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x^2\\cos^2(\\theta) + 2xy\\cos(\\theta)\\sin(\\theta) + y^2\\sin^2(\\theta)\\big) f(x,y) \\,dx\\,dy\n$$\nSeparating the terms by linearity:\n$$\nm_2(\\theta) = \\cos^2(\\theta)\\int\\int x^2 f(x,y) dxdy + 2\\cos(\\theta)\\sin(\\theta)\\int\\int xy f(x,y) dxdy + \\sin^2(\\theta)\\int\\int y^2 f(x,y) dxdy\n$$\nThese integrals are the components of the raw second moment matrix $\\mathbf{R}$:\n$$\n\\mathbf{R} = \\int\\int \\begin{pmatrix} x^2 & xy \\\\ yx & y^2 \\end{pmatrix} f(x,y)\\,dx\\,dy = \\begin{pmatrix} R_{xx} & R_{xy} \\\\ R_{yx} & R_{yy} \\end{pmatrix}\n$$\nSo, we can write $m_2(\\theta)$ as:\n$$\nm_2(\\theta) = R_{xx}\\cos^2(\\theta) + 2R_{xy}\\cos(\\theta)\\sin(\\theta) + R_{yy}\\sin^2(\\theta)\n$$\nThis quadratic form can be expressed compactly using the vector $\\mathbf{u}(\\theta)$:\n$$\nm_2(\\theta) = \\mathbf{u}(\\theta)^{\\top} \\mathbf{R} \\mathbf{u}(\\theta)\n$$\nThis is the required relationship between $m_2(\\theta)$ and the matrix $\\mathbf{R}$.\n\nTo relate $m_2(\\theta)$ to the covariance matrix $\\mathbf{C}$ and centroid $\\boldsymbol{\\mu}$, we use the parallel axis theorem, which connects $\\mathbf{R}$, $\\mathbf{C}$, and $\\boldsymbol{\\mu}$. Starting with the definition of $\\mathbf{C}$:\n$$\n\\mathbf{C} = \\frac{1}{M}\\int\\int \\big(\\begin{pmatrix} x \\\\ y \\end{pmatrix} - \\boldsymbol{\\mu}\\big)\\big(\\begin{pmatrix} x & y \\end{pmatrix} - \\boldsymbol{\\mu}^{\\top}\\big) f(x,y)\\,dx\\,dy\n$$\nExpanding the product inside the integral yields $\\mathbf{R} = M\\mathbf{C} + M\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}$. Substituting this into our expression for $m_2(\\theta)$:\n$$\nm_2(\\theta) = \\mathbf{u}^{\\top} (M\\mathbf{C} + M\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}) \\mathbf{u} = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + M(\\mathbf{u}^{\\top}\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}\\mathbf{u})\n$$\nSince $\\mathbf{u}^{\\top}\\boldsymbol{\\mu}$ is a scalar, we have $\\mathbf{u}^{\\top}\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}\\mathbf{u} = (\\mathbf{u}^{\\top}\\boldsymbol{\\mu})(\\boldsymbol{\\mu}^{\\top}\\mathbf{u}) = (\\boldsymbol{\\mu}^{\\top}\\mathbf{u})^2$.\nFrom the derivation of $m_1(\\theta)$, we know $\\boldsymbol{\\mu}^{\\top}\\mathbf{u} = m_1(\\theta)/M$. Thus:\n$$\nm_2(\\theta) = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + M\\left(\\frac{m_1(\\theta)}{M}\\right)^2 = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + \\frac{m_1(\\theta)^2}{M}\n$$\nThis is the desired relationship for $m_2(\\theta)$ in terms of $\\mathbf{C}$ and $\\boldsymbol{\\mu}$ (via $m_1(\\theta)$).\n\nNow we apply these derived relations to the specific object with $M=1$, $\\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$, and $\\mathbf{C} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}$.\n\nCalculation of $m_1(\\theta)$:\n$$\nm_1(\\theta) = M \\boldsymbol{\\mu}^{\\top} \\mathbf{u}(\\theta) = 1 \\times \\begin{pmatrix} 2 & -1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix} = 2\\cos(\\theta) - \\sin(\\theta)\n$$\n\nCalculation of $m_2(\\theta)$:\nWe use the expression $m_2(\\theta) = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + \\frac{m_1(\\theta)^2}{M}$. With $M=1$, this simplifies to $m_2(\\theta) = \\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u} + m_1(\\theta)^2$.\nFirst, we compute the quadratic form $\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}$:\n$$\n\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u} = \\begin{pmatrix} \\cos(\\theta) & \\sin(\\theta) \\end{pmatrix} \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix}\n$$\n$$\n= 3\\cos^2(\\theta) + 2\\cos(\\theta)\\sin(\\theta) + 2\\sin^2(\\theta)\n$$\nNext, we compute $m_1(\\theta)^2$:\n$$\nm_1(\\theta)^2 = (2\\cos(\\theta) - \\sin(\\theta))^2 = 4\\cos^2(\\theta) - 4\\cos(\\theta)\\sin(\\theta) + \\sin^2(\\theta)\n$$\nSumming these two parts:\n$$\nm_2(\\theta) = (3\\cos^2(\\theta) + 2\\cos(\\theta)\\sin(\\theta) + 2\\sin^2(\\theta)) + (4\\cos^2(\\theta) - 4\\cos(\\theta)\\sin(\\theta) + \\sin^2(\\theta))\n$$\n$$\nm_2(\\theta) = 7\\cos^2(\\theta) - 2\\cos(\\theta)\\sin(\\theta) + 3\\sin^2(\\theta)\n$$\nTo obtain a more compact expression, we use the double-angle identities: $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$, $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$, and $2\\cos(\\theta)\\sin(\\theta) = \\sin(2\\theta)$.\n$$\nm_2(\\theta) = 7\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) - \\sin(2\\theta) + 3\\left(\\frac{1-\\cos(2\\theta)}{2}\\right)\n$$\n$$\nm_2(\\theta) = \\frac{7}{2} + \\frac{7}{2}\\cos(2\\theta) - \\sin(2\\theta) + \\frac{3}{2} - \\frac{3}{2}\\cos(2\\theta)\n$$\n$$\nm_2(\\theta) = \\frac{10}{2} + \\left(\\frac{7-3}{2}\\right)\\cos(2\\theta) - \\sin(2\\theta) = 5 + 2\\cos(2\\theta) - \\sin(2\\theta)\n$$\nThe expressions for the first and second projection moments are therefore:\n$m_1(\\theta) = 2\\cos(\\theta) - \\sin(\\theta)$\n$m_2(\\theta) = 5 + 2\\cos(2\\theta) - \\sin(2\\theta)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\cos(\\theta) - \\sin(\\theta) & 5 + 2\\cos(2\\theta) - \\sin(2\\theta)\n\\end{pmatrix}\n}\n$$", "id": "4913422"}, {"introduction": "The \"filtered\" in Filtered Backprojection is where much of the art and science of CT reconstruction lies. The ideal ramp filter required by the Fourier Slice Theorem, with a frequency response of $|\\omega|$, is notoriously sensitive to noise, making it impractical for clinical data. This practice delves into the engineering solution: applying window functions to the filter to control the trade-off between image sharpness (resolution) and noise suppression [@problem_id:4913443]. By quantitatively comparing the noise performance of standard windows like Ram-Lak, Shepp-Logan, and Hamming, you will gain a practical understanding of how filter design directly impacts final image quality.", "problem": "A two-dimensional parallel-beam tomographic system acquires projections of an object with spatial distribution $f(x,y)$, modeled by the Radon transform $R f(\\theta,s)$, where $\\theta$ is the projection angle and $s$ is detector position. Reconstruction is performed by Filtered Backprojection (FBP), which linearly filters each projection with a frequency-domain filter having response $H(\\omega)$ and then backprojects. In the ideal noiseless limit, the canonical FBP filter includes the magnitude ramp $|\\omega|$, but practical implementations multiply $|\\omega|$ by a window function $W(\\omega)$ to trade off resolution and noise.\n\nConsider three window functions with cutoff frequency $\\omega_{c}$:\n- Ram–Lak window: $W_{\\mathrm{RL}}(\\omega) = 1$ for $|\\omega| \\le \\omega_{c}$ and $W_{\\mathrm{RL}}(\\omega) = 0$ otherwise.\n- Shepp–Logan window: $W_{\\mathrm{SL}}(\\omega) = \\dfrac{\\sin\\!\\big(\\dfrac{\\pi\\,\\omega}{2\\,\\omega_{c}}\\big)}{\\dfrac{\\pi\\,\\omega}{2\\,\\omega_{c}}}$ for $|\\omega| \\le \\omega_{c}$ and $W_{\\mathrm{SL}}(\\omega) = 0$ otherwise.\n- Hamming window: $W_{\\mathrm{H}}(\\omega) = 0.54 + 0.46 \\cos\\!\\big(\\dfrac{\\pi\\,\\omega}{\\omega_{c}}\\big)$ for $|\\omega| \\le \\omega_{c}$ and $W_{\\mathrm{H}}(\\omega) = 0$ otherwise.\n\nAssume that, for each angle $\\theta$, the projection measurement contains additive, zero-mean, white noise that is wide-sense stationary along detector position $s$ with constant two-sided power spectral density $S_{0}$, independent across angles. Starting from the linear systems viewpoint (filtering in frequency with $H(\\omega) = |\\omega|\\,W(\\omega)$ followed by backprojection) and the definition of variance for filtered white noise, derive the frequency responses $H_{\\mathrm{RL}}(\\omega)$, $H_{\\mathrm{SL}}(\\omega)$, and $H_{\\mathrm{H}}(\\omega)$ and obtain analytic expressions for the relative image-domain noise variance amplification factors at a reconstructed pixel for these three windows. By “relative,” normalize all three factors to the Ram–Lak case so that the Ram–Lak factor is $1$. Express your final answer as a single row matrix in the order Ram–Lak, Shepp–Logan, Hamming. No rounding is required. The ratios are dimensionless.", "solution": "The user wants to find the relative noise variance amplification factors for three different window functions used in Filtered Backprojection (FBP).\n\n### Step 1: Problem Validation\nThe problem describes a standard scenario in computed tomography (CT) image reconstruction.\n- **Givens**:\n    - Object distribution: $f(x,y)$\n    - Projection model: Radon transform $R f(\\theta,s)$\n    - Reconstruction algorithm: Filtered Backprojection (FBP)\n    - FBP filter in frequency domain: $H(\\omega) = |\\omega|\\,W(\\omega)$, where $\\omega$ is spatial frequency.\n    - Window functions $W(\\omega)$ with cutoff frequency $\\omega_c$:\n        1. Ram–Lak: $W_{\\mathrm{RL}}(\\omega) = 1$ for $|\\omega| \\le \\omega_{c}$ and $0$ otherwise.\n        2. Shepp–Logan: $W_{\\mathrm{SL}}(\\omega) = \\dfrac{\\sin(\\frac{\\pi\\,\\omega}{2\\,\\omega_{c}})}{\\frac{\\pi\\,\\omega}{2\\,\\omega_{c}}}$ for $|\\omega| \\le \\omega_{c}$ and $0$ otherwise.\n        3. Hamming: $W_{\\mathrm{H}}(\\omega) = 0.54 + 0.46 \\cos(\\frac{\\pi\\,\\omega}{\\omega_{c}})$ for $|\\omega| \\le \\omega_{c}$ and $0$ otherwise.\n    - Noise model: Additive, zero-mean, white, wide-sense stationary (WSS) along detector position $s$, with constant two-sided power spectral density (PSD) $S_{0}$, independent across projection angles $\\theta$.\n- **Validation**:\n    - **Scientifically Grounded**: The problem is firmly rooted in the principles of linear systems theory and the mathematical foundations of tomographic imaging (Radon transform, FBP). All models and definitions are standard in the field.\n    - **Well-Posed**: The problem is clearly stated, with all necessary definitions provided. The task is to derive analytical expressions for well-defined physical quantities (relative noise variances), leading to a unique solution.\n    - **Objective**: The language is precise and free of subjectivity.\n- **Verdict**: The problem is valid.\n\n### Step 2: Derivation of Noise Variance Amplification\n\nThe FBP process consists of two linear operations: filtering and backprojection. We are interested in how input noise propagates to the reconstructed image.\n\nLet the noise in the projection at angle $\\theta$ be $n(\\theta, s)$. The problem states this is a zero-mean, WSS random process with a constant PSD, $S_{n}(\\omega) = S_{0}$. This is the definition of white noise.\n\n**Filtering Stage:**\nFor each projection angle $\\theta$, the noisy projection is filtered by a linear time-invariant (LTI) filter with frequency response $H(\\omega) = |\\omega|W(\\omega)$. The output of a linear system with frequency response $H(\\omega)$ to an input random process with PSD $S_{in}(\\omega)$ is a random process with PSD $S_{out}(\\omega) = S_{in}(\\omega) |H(\\omega)|^2$.\n\nIn our case, the input is the noise $n(\\theta, s)$ with PSD $S_{n}(\\omega) = S_0$. The filtered noise, let's call it $n_f(\\theta, s)$, will have a PSD $S_{n_f}(\\omega)$ given by:\n$$S_{n_f}(\\omega) = S_{0} |H(\\omega)|^2 = S_{0} \\big| |\\omega|W(\\omega) \\big|^2 = S_{0} \\omega^2 W(\\omega)^2$$\nThe window functions $W(\\omega)$ are real-valued, so $|W(\\omega)|^2 = W(\\omega)^2$.\n\nThe variance of the filtered noise, $\\sigma_f^2$, is the integral of its PSD over all frequencies. Using the standard definition for angular frequency $\\omega$ in signal processing, this is:\n$$\\sigma_f^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{n_f}(\\omega) \\,d\\omega = \\frac{S_{0}}{2\\pi} \\int_{-\\infty}^{\\infty} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n\n**Backprojection Stage:**\nThe backprojection operation sums (integrates) the filtered projections $n_f(\\theta, s)$ over all angles $\\theta$ from $0$ to $\\pi$. The noise in the final reconstructed image at a given pixel is the result of this integration. Since the noise is assumed to be independent across angles, the variance of the sum is the sum of the variances. More formally, the backprojection integrates the filtered noise processes. This integration over $\\theta$ results in a final image noise variance, $\\sigma_{\\text{img}}^2$, that is directly proportional to the variance of the filtered projections, $\\sigma_f^2$.\n$$\\sigma_{\\text{img}}^2 \\propto \\sigma_f^2$$\nTherefore, the amplification of noise variance in the final image is proportional to the integral:\n$$I_W = \\int_{-\\infty}^{\\infty} \\omega^2 W(\\omega)^2 \\,d\\omega$$\nSince all window functions are zero for $|\\omega| > \\omega_c$, the integral is bounded:\n$$I_W = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 W(\\omega)^2 \\,d\\omega$$\nWe need to calculate this integral for each of the three window functions and then find their ratios relative to the Ram-Lak case. The integrand $\\omega^2 W(\\omega)^2$ is an even function of $\\omega$ for all three windows, so we can write $I_W = 2 \\int_{0}^{\\omega_c} \\omega^2 W(\\omega)^2 \\,d\\omega$.\n\n### Step 3: Calculation of Integrals\n\n**1. Ram–Lak (RL) Window**\n$W_{\\mathrm{RL}}(\\omega) = 1$ for $|\\omega| \\le \\omega_{c}$.\n$$I_{\\mathrm{RL}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 (1)^2 \\,d\\omega = 2 \\int_{0}^{\\omega_c} \\omega^2 \\,d\\omega = 2 \\left[ \\frac{\\omega^3}{3} \\right]_{0}^{\\omega_c} = \\frac{2}{3} \\omega_c^3$$\nThis will serve as our normalization constant. The relative amplification factor for the Ram-Lak window is $A_{\\mathrm{RL}} = I_{\\mathrm{RL}}/I_{\\mathrm{RL}} = 1$.\n\n**2. Shepp–Logan (SL) Window**\n$W_{\\mathrm{SL}}(\\omega) = \\frac{\\sin(a\\omega)}{a\\omega}$, where $a = \\frac{\\pi}{2\\omega_c}$.\n$$I_{\\mathrm{SL}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\left( \\frac{\\sin(a\\omega)}{a\\omega} \\right)^2 \\,d\\omega = \\frac{1}{a^2} \\int_{-\\omega_c}^{\\omega_c} \\sin^2(a\\omega) \\,d\\omega$$\nUsing the identity $\\sin^2(x) = \\frac{1 - \\cos(2x)}{2}$:\n$$I_{\\mathrm{SL}} = \\frac{2}{a^2} \\int_{0}^{\\omega_c} \\frac{1 - \\cos(2a\\omega)}{2} \\,d\\omega = \\frac{1}{a^2} \\left[ \\omega - \\frac{\\sin(2a\\omega)}{2a} \\right]_{0}^{\\omega_c}$$\nAt the upper limit, $\\omega = \\omega_c$, the argument of the sine is $2a\\omega_c = 2(\\frac{\\pi}{2\\omega_c})\\omega_c = \\pi$. Since $\\sin(\\pi) = 0$ and $\\sin(0) = 0$, the sine term vanishes.\n$$I_{\\mathrm{SL}} = \\frac{1}{a^2} (\\omega_c - 0) = \\frac{\\omega_c}{a^2} = \\frac{\\omega_c}{(\\pi/(2\\omega_c))^2} = \\frac{\\omega_c}{\\pi^2/(4\\omega_c^2)} = \\frac{4\\omega_c^3}{\\pi^2}$$\nThe relative amplification factor is:\n$$A_{\\mathrm{SL}} = \\frac{I_{\\mathrm{SL}}}{I_{\\mathrm{RL}}} = \\frac{4\\omega_c^3/\\pi^2}{2\\omega_c^3/3} = \\frac{4}{\\pi^2} \\cdot \\frac{3}{2} = \\frac{6}{\\pi^2}$$\n\n**3. Hamming (H) Window**\n$W_{\\mathrm{H}}(\\omega) = P + Q\\cos(b\\omega)$ for $|\\omega| \\le \\omega_{c}$, where $P = 0.54$, $Q = 0.46$, and $b = \\frac{\\pi}{\\omega_c}$.\n$$I_{\\mathrm{H}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 (P + Q\\cos(b\\omega))^2 \\,d\\omega$$\nExpanding the square:\n$$I_{\\mathrm{H}} = \\int_{-\\omega_c}^{\\omega_c} \\left( P^2\\omega^2 + 2PQ\\omega^2\\cos(b\\omega) + Q^2\\omega^2\\cos^2(b\\omega) \\right) \\,d\\omega$$\nWe evaluate the three integral terms:\nTerm 1: $\\int_{-\\omega_c}^{\\omega_c} P^2\\omega^2 \\,d\\omega = P^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\,d\\omega = P^2 \\left(\\frac{2}{3}\\omega_c^3\\right)$.\nTerm 2: $2PQ \\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(b\\omega) \\,d\\omega$. Through integration by parts twice, one finds $\\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(b\\omega) \\,d\\omega = -\\frac{4\\omega_c^3}{\\pi^2}$. So, this term is $2PQ \\left(-\\frac{4\\omega_c^3}{\\pi^2}\\right) = -\\frac{8PQ\\omega_c^3}{\\pi^2}$.\nTerm 3: $Q^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos^2(b\\omega) \\,d\\omega = Q^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\frac{1+\\cos(2b\\omega)}{2} \\,d\\omega$. This splits into $\\frac{Q^2}{2}\\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\,d\\omega + \\frac{Q^2}{2}\\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(2b\\omega) \\,d\\omega$. The first integral is $\\frac{2}{3}\\omega_c^3$. The second integral, again via parts, is $\\frac{\\omega_c^3}{\\pi^2}$. So, Term 3 is $\\frac{Q^2}{2}\\left(\\frac{2}{3}\\omega_c^3 + \\frac{\\omega_c^3}{\\pi^2}\\right) = Q^2\\omega_c^3\\left(\\frac{1}{3} + \\frac{1}{2\\pi^2}\\right)$.\n\nSumming the terms for $I_{\\mathrm{H}}$:\n$$I_{\\mathrm{H}} = \\omega_c^3 \\left[ \\frac{2}{3}P^2 - \\frac{8PQ}{\\pi^2} + \\frac{1}{3}Q^2 + \\frac{Q^2}{2\\pi^2} \\right]$$\nThe relative amplification factor is $A_{\\mathrm{H}} = I_{\\mathrm{H}}/I_{\\mathrm{RL}}$:\n$$A_{\\mathrm{H}} = \\frac{\\omega_c^3 \\left[ \\frac{2}{3}P^2 + \\frac{1}{3}Q^2 - \\frac{8PQ}{\\pi^2} + \\frac{Q^2}{2\\pi^2} \\right]}{\\frac{2}{3}\\omega_c^3} = \\frac{3}{2} \\left[ \\frac{1}{3}(2P^2+Q^2) + \\frac{1}{2\\pi^2}(Q^2 - 16PQ) \\right]$$\n$$A_{\\mathrm{H}} = \\frac{1}{2}(2P^2+Q^2) + \\frac{3}{4\\pi^2}(Q^2 - 16PQ)$$\nSubstituting $P = 0.54 = \\frac{27}{50}$ and $Q = 0.46 = \\frac{23}{50}$:\n$2P^2+Q^2 = 2\\left(\\frac{27}{50}\\right)^2 + \\left(\\frac{23}{50}\\right)^2 = \\frac{2 \\cdot 729 + 529}{2500} = \\frac{1458+529}{2500} = \\frac{1987}{2500}$.\n$Q^2-16PQ = \\left(\\frac{23}{50}\\right)^2 - 16\\left(\\frac{27}{50}\\right)\\left(\\frac{23}{50}\\right) = \\frac{529 - 16 \\cdot 621}{2500} = \\frac{529 - 9936}{2500} = -\\frac{9407}{2500}$.\n$$A_{\\mathrm{H}} = \\frac{1}{2}\\left(\\frac{1987}{2500}\\right) + \\frac{3}{4\\pi^2}\\left(-\\frac{9407}{2500}\\right) = \\frac{1987}{5000} - \\frac{28221}{10000\\pi^2}$$\n\n### Step 4: Final Answer\nThe relative noise variance amplification factors for the Ram-Lak, Shepp-Logan, and Hamming windows are, respectively:\n1. $A_{\\mathrm{RL}} = 1$\n2. $A_{\\mathrm{SL}} = \\frac{6}{\\pi^2}$\n3. $A_{\\mathrm{H}} = \\frac{1987}{5000} - \\frac{28221}{10000\\pi^2}$\n\nWe present these in a single row matrix as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\frac{6}{\\pi^2} & \\frac{1987}{5000} - \\frac{28221}{10000 \\pi^2}\n\\end{pmatrix}\n}\n$$", "id": "4913443"}, {"introduction": "Every processing step in imaging can introduce artifacts, and filtering is no exception. Having seen how window functions are used to manage noise by limiting high-frequency information, we now examine the consequences of this bandlimiting in the image domain [@problem_id:4913446]. This exercise reveals the origin of the Gibbs phenomenon—the characteristic \"ringing\" or \"overshoot\" seen at sharp edges—by analyzing the system's response to an ideal edge. This provides a crucial link between the system's frequency response and the visual fidelity of the reconstructed image.", "problem": "A uniform circular disk phantom of unit intensity is reconstructed by parallel-beam Computed Tomography (CT), using Filtered Backprojection (FBP). Assume the reconstruction is linear and shift-invariant in the image plane, so the reconstructed image equals the true object convolved with the point spread function (PSF). The effective modulation transfer function (MTF) of the reconstruction is modeled as an ideal, circularly symmetric, bandlimited passband:\n$$\nM(\\mathbf{k}) = \\begin{cases}\n1, & |\\mathbf{k}| \\leq k_c, \\\\\n0, & |\\mathbf{k}| > k_c,\n\\end{cases}\n$$\nwhere $\\mathbf{k} = (k_x, k_y)$ is the spatial frequency vector and $k_c > 0$ is the cutoff spatial frequency. Use the two-dimensional Fourier transform convention\n$$\n\\mathcal{F}\\{f\\}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) \\exp(-i\\,\\mathbf{k}\\cdot\\mathbf{x}) \\, d^2\\mathbf{x}, \\quad\n\\mathcal{F}^{-1}\\{F\\}(\\mathbf{x}) = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} F(\\mathbf{k}) \\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x}) \\, d^2\\mathbf{k}.\n$$\nAt any point on the boundary of the disk, consider a local orthonormal coordinate system with $x$ denoting the inward normal direction to the edge and ideal interior as the half-plane $x>0$. Model the true object locally as a unit step $u(x)$ across the edge at $x=0$.\n\nStarting from the definitions above, derive the edge spread function $s(x)$, defined as the reconstructed intensity as a function of $x$ across the edge, in terms of the PSF and the unit step input. Then, use $s(x)$ to quantify the Gibbs phenomenon by determining the magnitude of the first overshoot above the asymptotic interior value. Express this overshoot as a dimensionless fraction of the step height. Your final answer must be a single real number rounded to five significant figures. No physical units are required.", "solution": "The problem asks for the magnitude of the Gibbs-phenomenon overshoot in a CT reconstruction, expressed as a fraction of the edge step height. The system is modeled as linear and shift-invariant (LSI) with an ideal, circularly symmetric low-pass filter in the frequency domain.\n\nThe reconstructed image, which we denote as $f_{rec}(\\mathbf{x})$, is the convolution of the true object, $f_{true}(\\mathbf{x})$, with the system's point spread function (PSF), $h(\\mathbf{x})$:\n$$f_{rec}(\\mathbf{x}) = (f_{true} * h)(\\mathbf{x})$$\nThe problem states that the modulation transfer function (MTF), $M(\\mathbf{k})$, is the specified ideal low-pass filter. In an LSI system, the PSF is the inverse Fourier transform of the Optical Transfer Function (OTF). The MTF is the magnitude of the OTF. Since the given $M(\\mathbf{k})$ is real and non-negative, we can equate the OTF with the MTF:\n$$OTF(\\mathbf{k}) = M(\\mathbf{k}) = \\begin{cases} 1, & |\\mathbf{k}| \\leq k_c \\\\ 0, & |\\mathbf{k}| > k_c \\end{cases}$$\nThe problem simplifies the analysis by considering a local region at the edge of the circular disk. In this region, the curved edge is approximated by a straight line, and the true object is modeled as a unit step function oriented along the $x$-axis:\n$$f_{true}(\\mathbf{x}) = u(x) = \\begin{cases} 1, & x > 0 \\\\ 0, & x < 0 \\end{cases}$$\nThe reconstructed image, called the edge spread function (ESF), $s(x,y)$, depends only on the coordinate $x$ perpendicular to the edge due to the 1D nature of the input object.\n$$s(x) = \\int\\limits_{-\\infty}^{\\infty}\\int\\limits_{-\\infty}^{\\infty} u(x') h(x-x', y-y') \\, dx' \\, dy'$$\nThis can be expressed as a 1D convolution of the input $u(x)$ with the line spread function (LSF), $L(x)$:\n$$s(x) = (u * L)(x)$$\nwhere the LSF is the integral of the 2D PSF along the direction parallel to the edge:\n$$L(x) = \\int_{-\\infty}^{\\infty} h(x,y) \\, dy$$\nA fundamental property related to the Fourier transform (the projection-slice theorem) states that the 1D Fourier transform of the LSF, $\\mathcal{F}_1\\{L\\}(k_x)$, is equal to the central slice of the 2D OTF at $k_y=0$:\n$$\\mathcal{F}_1\\{L\\}(k_x) = OTF(k_x, 0)$$\nFrom the definition of $OTF(\\mathbf{k})$, we have:\n$$\\mathcal{F}_1\\{L\\}(k_x) = \\begin{cases} 1, & |k_x| \\leq k_c \\\\ 0, & |k_x| > k_c \\end{cases}$$\nThis is a rectangular function in the frequency domain. The LSF is found by taking the 1D inverse Fourier transform. Using the specified convention where the inverse transform for a $d$-dimensional function has a prefactor of $1/(2\\pi)^d$, for $d=1$ we use $1/(2\\pi)$:\n$$L(x) = \\mathcal{F}_1^{-1}\\{\\mathcal{F}_1\\{L\\}\\}(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathcal{F}_1\\{L\\}(k_x) \\exp(i k_x x) \\, dk_x$$\n$$L(x) = \\frac{1}{2\\pi} \\int_{-k_c}^{k_c} (1) \\cdot \\exp(i k_x x) \\, dk_x$$\nEvaluating the integral:\n$$L(x) = \\frac{1}{2\\pi} \\left[ \\frac{\\exp(i k_x x)}{ix} \\right]_{-k_c}^{k_c} = \\frac{1}{2\\pi ix} (\\exp(i k_c x) - \\exp(-i k_c x)) = \\frac{2i\\sin(k_c x)}{2\\pi ix} = \\frac{\\sin(k_c x)}{\\pi x}$$\nThe ESF, $s(x)$, is the convolution of $u(x)$ and $L(x)$, which is equivalent to the integral of the LSF:\n$$s(x) = (u * L)(x) = \\int_{-\\infty}^{x} L(\\tau) \\, d\\tau$$\n$$s(x) = \\int_{-\\infty}^{x} \\frac{\\sin(k_c \\tau)}{\\pi \\tau} \\, d\\tau$$\nTo evaluate this integral, we make a substitution $z = k_c \\tau$, so $d\\tau = dz/k_c$:\n$$s(x) = \\int_{-\\infty}^{k_c x} \\frac{\\sin(z)}{\\pi (z/k_c)} \\frac{dz}{k_c} = \\frac{1}{\\pi} \\int_{-\\infty}^{k_c x} \\frac{\\sin(z)}{z} \\, dz$$\nWe can split the integral:\n$$s(x) = \\frac{1}{\\pi} \\left( \\int_{-\\infty}^{0} \\frac{\\sin(z)}{z} \\, dz + \\int_{0}^{k_c x} \\frac{\\sin(z)}{z} \\, dz \\right)$$\nThe first integral is a known definite integral, $\\int_0^{\\infty} \\frac{\\sin(z)}{z} dz = \\frac{\\pi}{2}$. By symmetry, $\\int_{-\\infty}^0 \\frac{\\sin(z)}{z} dz = \\frac{\\pi}{2}$. The second integral is the definition of the sine integral function, $\\text{Si}(t) = \\int_0^t \\frac{\\sin(z)}{z} dz$.\nThus, the ESF is:\n$$s(x) = \\frac{1}{\\pi} \\left( \\frac{\\pi}{2} + \\text{Si}(k_c x) \\right) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(k_c x)$$\nThe asymptotic interior value corresponds to $x \\to \\infty$. As $x \\to \\infty$, $k_c x \\to \\infty$, and $\\lim_{t\\to\\infty} \\text{Si}(t) = \\frac{\\pi}{2}$.\n$$s_{interior} = \\lim_{x\\to\\infty} s(x) = \\frac{1}{2} + \\frac{1}{\\pi} \\left(\\frac{\\pi}{2}\\right) = 1$$\nThe asymptotic exterior value is for $x \\to -\\infty$, for which $\\lim_{t\\to-\\infty} \\text{Si}(t) = -\\frac{\\pi}{2}$, giving $s_{exterior} = 0$. The step height is $s_{interior} - s_{exterior} = 1 - 0 = 1$.\n\nThe Gibbs phenomenon manifests as ringing around the discontinuity. The overshoot is found by locating the first maximum of $s(x)$ for $x>0$. We find the extrema by setting the derivative of $s(x)$ to zero:\n$$\\frac{ds}{dx} = L(x) = \\frac{\\sin(k_c x)}{\\pi x} = 0$$\nThis occurs when $\\sin(k_c x) = 0$, which implies $k_c x = n\\pi$ for any non-zero integer $n$. The extrema are at $x_n = n\\pi/k_c$. The first extremum in the region $x>0$ is for $n=1$, at $x_1 = \\pi/k_c$. This position corresponds to a maximum (the first overshoot).\nThe value of the ESF at this point is:\n$$s_{peak} = s(\\pi/k_c) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(k_c \\cdot \\frac{\\pi}{k_c}) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(\\pi)$$\nThe magnitude of the first overshoot above the asymptotic interior value is:\n$$Overshoot = s_{peak} - s_{interior} = \\left(\\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(\\pi)\\right) - 1 = \\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}$$\nThe problem asks for this overshoot as a dimensionless fraction of the step height. Since the step height is $1$, this fraction is equal to the overshoot magnitude itself.\n$$Fractional \\ Overshoot = \\frac{Overshoot}{Step \\ Height} = \\frac{\\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}}{1} = \\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}$$\nTo find the numerical value, we use the value of the sine integral at $\\pi$, which is $\\text{Si}(\\pi) \\approx 1.85193705$.\n$$Fractional \\ Overshoot \\approx \\frac{1.85193705}{3.14159265} - 0.5 \\approx 0.58949446 - 0.5 = 0.08949446$$\nRounding to five significant figures, we get $0.08949$.", "answer": "$$\\boxed{0.08949}$$", "id": "4913446"}]}