{"hands_on_practices": [{"introduction": "The primary motivation for developing 3D PET was to dramatically increase the scanner's sensitivity—its ability to detect the gamma photons from positron annihilation. This practice uses a simplified but powerful geometric model to quantify this gain. By integrating over the accepted solid angle for both 2D and 3D modes, you will derive the theoretical increase in sensitivity that comes from removing the inter-plane septa and accepting more obliquely travelling photons [@problem_id:4859419].", "problem": "Consider Positron Emission Tomography (PET) acquisition using a simplified cylindrical scanner modeled as an axially symmetric detector surrounding the patient. Assume a point source at the isocenter that emits annihilation photons isotropically, so that the emission probability is uniform over solid angle. Use the following foundational facts: the differential element of solid angle is given by $d\\Omega = \\sin\\theta\\,d\\theta\\,d\\phi$, the full sphere has solid angle $4\\pi$, and the sensitivity (detected coincidence rate per emitted annihilation) is proportional to the fraction of solid angle accepted by the acquisition mode. Define the polar angle $\\theta$ with respect to the scanner’s axial direction, with $\\theta = \\frac{\\pi}{2}$ corresponding to the transverse plane.\n\nModel the two acquisition modes by angular acceptance windows symmetric about the transverse plane:\n- In two-dimensional (2D) mode, interplane septa block oblique lines of response, so accepted directions satisfy $|\\theta - \\frac{\\pi}{2}| \\leq \\alpha_{2D}$ with $\\alpha_{2D} = 7$ degrees.\n- In three-dimensional (3D) mode, the septa are retracted and a wider range of oblique lines of response is accepted, so $|\\theta - \\frac{\\pi}{2}| \\leq \\alpha_{3D}$ with $\\alpha_{3D} = 50$ degrees.\n\nAssuming uniform azimuthal acceptance for both modes, derive expressions (up to a common proportionality constant) for the sensitivities $S_{2D}$ and $S_{3D}$ by integrating over the accepted solid angle regions, and then compute the ratio $\\frac{S_{3D}}{S_{2D}}$. Angles $\\alpha_{2D}$ and $\\alpha_{3D}$ are given in degrees; convert to radians when performing any trigonometric evaluations. Round your final ratio to four significant figures. Express your final answer as a dimensionless number.", "solution": "The source emits uniformly over all directions, so sensitivity in this simplified model is proportional to the accepted solid angle. Using axial symmetry, the accepted solid angle for a mode that allows polar angles $\\theta \\in [\\theta_{\\min}, \\theta_{\\max}]$ and full azimuthal range $\\phi \\in [0, 2\\pi]$ is\n$$\n\\Omega_{\\text{acc}} = \\int_{0}^{2\\pi}\\int_{\\theta_{\\min}}^{\\theta_{\\max}} \\sin\\theta\\,d\\theta\\,d\\phi = 2\\pi\\int_{\\theta_{\\min}}^{\\theta_{\\max}} \\sin\\theta\\,d\\theta.\n$$\nHence the sensitivity $S$ is proportional to $\\Omega_{\\text{acc}}$, and any common proportionality constants (such as detector efficiency and geometry scaling factors) cancel when taking the ratio $\\frac{S_{3D}}{S_{2D}}$.\n\nBoth modes are symmetric about $\\theta = \\frac{\\pi}{2}$ with acceptances $|\\theta - \\frac{\\pi}{2}| \\leq \\alpha$, so the bounds are $\\theta_{\\min} = \\frac{\\pi}{2} - \\alpha$ and $\\theta_{\\max} = \\frac{\\pi}{2} + \\alpha$. Then\n$$\n\\Omega_{\\text{acc}}(\\alpha) = 2\\pi\\int_{\\frac{\\pi}{2}-\\alpha}^{\\frac{\\pi}{2}+\\alpha} \\sin\\theta\\,d\\theta = 2\\pi\\left[-\\cos\\theta\\right]_{\\frac{\\pi}{2}-\\alpha}^{\\frac{\\pi}{2}+\\alpha}.\n$$\nEvaluating the cosine at the bounds,\n$$\n-\\cos\\left(\\frac{\\pi}{2}+\\alpha\\right) + \\cos\\left(\\frac{\\pi}{2}-\\alpha\\right) = -(-\\sin\\alpha) + \\sin\\alpha = 2\\sin\\alpha,\n$$\nso\n$$\n\\Omega_{\\text{acc}}(\\alpha) = 2\\pi\\cdot 2\\sin\\alpha = 4\\pi\\sin\\alpha.\n$$\nTherefore, up to a common proportionality constant,\n$$\nS(\\alpha) \\propto 4\\pi\\sin\\alpha.\n$$\nFor the two modes,\n$$\nS_{2D} \\propto 4\\pi\\sin\\alpha_{2D}, \\quad S_{3D} \\propto 4\\pi\\sin\\alpha_{3D},\n$$\nand the ratio is\n$$\n\\frac{S_{3D}}{S_{2D}} = \\frac{\\sin\\alpha_{3D}}{\\sin\\alpha_{2D}}.\n$$\n\nConvert the given degrees to radians. Using $\\alpha_{2D} = 7$ degrees and $\\alpha_{3D} = 50$ degrees,\n$$\n\\alpha_{2D} = \\frac{7\\pi}{180} \\text{ radians}, \\quad \\alpha_{3D} = \\frac{50\\pi}{180} = \\frac{5\\pi}{18} \\text{ radians}.\n$$\nCompute the sines:\n$$\n\\sin\\left(\\frac{5\\pi}{18}\\right) = \\sin(50^\\circ) \\approx 0.7660444431,\n$$\n$$\n\\sin\\left(\\frac{7\\pi}{180}\\right) = \\sin(7^\\circ) \\approx 0.1218693434.\n$$\nThus,\n$$\n\\frac{S_{3D}}{S_{2D}} \\approx \\frac{0.7660444431}{0.1218693434} \\approx 6.285785\\ldots\n$$\nRounded to four significant figures, the ratio is\n$$\n6.286.\n$$\nThis is dimensionless, as it is a ratio of sensitivities.", "answer": "$$\\boxed{6.286}$$", "id": "4859419"}, {"introduction": "While 3D PET offers a major sensitivity advantage, this comes at a cost: an increased susceptibility to scattered photons, which degrade image quality and quantitative accuracy. This exercise explores the practical consequences of this trade-off. You will model how a small, residual error in the scatter correction process can lead to a significant bias in the final activity measurement, and you will quantify why this bias is more pronounced in the higher-scatter environment of 3D PET [@problem_id:4859465].", "problem": "A uniform cylindrical water phantom is imaged with Positron Emission Tomography (PET). Two acquisitions are performed: a two-dimensional (2D) mode with interplane septa and a three-dimensional (3D) mode without septa. Assume a uniform region of interest (ROI) in which the true coincidence counts are linearly related to the true activity by a calibration factor (system sensitivity) $s$, so that the true counts satisfy $T = s A$, where $A$ is the true activity in the ROI. Let the measured prompt counts be the sum of true and scattered coincidences, $P = T + S$, and assume that random coincidences are perfectly corrected and therefore can be ignored for this analysis.\n\nDefine the scatter fraction $\\mathrm{SF}$ by $\\mathrm{SF} = \\dfrac{S}{T + S}$. In the 3D acquisition, the scatter fraction is $\\mathrm{SF}_{3\\mathrm{D}} = 0.40$, and in the 2D acquisition, the scatter fraction is $\\mathrm{SF}_{2\\mathrm{D}} = 0.20$. The scatter correction algorithm underestimates the true scatter by a residual fraction $\\delta = 0.10$, meaning that after correction a fraction $\\delta$ of the true scatter remains unremoved. Reconstruction is linear, and the corrected counts are mapped to the activity estimate by the same sensitivity $s$ used for true coincidences.\n\nStarting from these definitions and the linearity assumptions above, derive the fractional bias in the reconstructed activity, $B = \\dfrac{\\hat{A} - A}{A}$, for each acquisition mode as a function of $\\delta$ and $\\mathrm{SF}$. Then, using the given numerical values, compute the ratio\n$$R = \\dfrac{B_{3\\mathrm{D}}}{B_{2\\mathrm{D}}}.$$\nExpress $R$ as a pure number (dimensionless) and round your answer to four significant figures.", "solution": "The fractional bias $B$ in the reconstructed activity is defined as:\n$$B = \\frac{\\hat{A} - A}{A}$$\nwhere $A$ is the true activity and $\\hat{A}$ is the estimated activity.\n\nThe problem states that activity is linearly proportional to counts via a sensitivity factor $s$. Thus, $A = T/s$ and $\\hat{A} = P_c/s$, where $T$ are the true counts and $P_c$ are the corrected counts. Substituting these into the bias formula gives:\n$$B = \\frac{P_c/s - T/s}{T/s} = \\frac{P_c - T}{T}$$\n\nThe measured prompt counts $P$ are the sum of true ($T$) and scattered ($S$) counts: $P = T + S$. The scatter correction process underestimates the true scatter $S$ by a fraction $\\delta$, meaning the amount of scatter subtracted is $(1-\\delta)S$. The remaining corrected counts are:\n$$P_c = P - (1-\\delta)S = (T+S) - (1-\\delta)S = T + \\delta S$$\n\nSubstituting this into the bias expression:\n$$B = \\frac{(T + \\delta S) - T}{T} = \\frac{\\delta S}{T}$$\n\nTo express this in terms of the scatter fraction $\\mathrm{SF} = \\frac{S}{T+S}$, we first solve for the ratio $S/T$:\n$$\\mathrm{SF}(T+S) = S \\implies \\mathrm{SF} \\cdot T = S(1-\\mathrm{SF}) \\implies \\frac{S}{T} = \\frac{\\mathrm{SF}}{1 - \\mathrm{SF}}$$\n\nTherefore, the general formula for fractional bias is:\n$$B = \\delta \\left(\\frac{\\mathrm{SF}}{1 - \\mathrm{SF}}\\right)$$\n\nWe can now compute the ratio of the biases for the 3D and 2D modes, $R = B_{3\\mathrm{D}} / B_{2\\mathrm{D}}$. The factor $\\delta$ is the same for both and cancels out.\n$$R = \\frac{\\frac{\\mathrm{SF}_{3\\mathrm{D}}}{1 - \\mathrm{SF}_{3\\mathrm{D}}}}{\\frac{\\mathrm{SF}_{2\\mathrm{D}}}{1 - \\mathrm{SF}_{2\\mathrm{D}}}}$$\n\nUsing the given values $\\mathrm{SF}_{3\\mathrm{D}} = 0.40$ and $\\mathrm{SF}_{2\\mathrm{D}} = 0.20$:\n$$R = \\frac{\\frac{0.40}{1 - 0.40}}{\\frac{0.20}{1 - 0.20}} = \\frac{\\frac{0.40}{0.60}}{\\frac{0.20}{0.80}} = \\frac{\\frac{2}{3}}{\\frac{1}{4}}$$\n$$R = \\frac{2}{3} \\times 4 = \\frac{8}{3} \\approx 2.6666...$$\n\nRounding to four significant figures, the ratio is:\n$$R = 2.667$$", "answer": "$$\\boxed{2.667}$$", "id": "4859465"}, {"introduction": "The raw data in PET consists of coincidence events that define Lines of Response (LORs) between pairs of detectors. The total number of possible LORs determines the fundamental sampling of the imaging volume and the scale of the dataset. This practice challenges you to think from first principles about the geometric constraints of 2D acquisition, where septa are used to limit coincidences. By applying combinatorics, you will derive an expression for the total number of accepted LORs, providing a concrete understanding of how a 2D dataset is structured [@problem_id:4859470].", "problem": "A cylindrical Positron Emission Tomography (PET) scanner consists of $M$ axially stacked rings, each ring containing $N$ identical scintillation crystals uniformly distributed around the circumference. In $2\\text{D}$ acquisition mode, slice-defining septa restrict accepted coincidences to those that define a Line of Response (LOR) either within the same transaxial plane or between immediately adjacent transaxial planes. A Line of Response (LOR) is defined by the straight line connecting the centers of two crystals that detect coincident gamma photons. Assume the following:\n- A coincidence event is registered if and only if two distinct crystals record detections within the coincidence timing window.\n- Accepted LORs are restricted to either intra-ring (both crystals in the same ring) or adjacent-ring (one crystal in a ring and the other in the immediately neighboring ring) pairs.\n- Detection order does not distinguish LORs; that is, the pair $\\{i,j\\}$ is considered identical to the pair $\\{j,i\\}$.\n- Ignore any effects of detector dead time, parallax, or axial gaps; count only the distinct geometric detector pairs consistent with the acceptance described above.\n\nStarting from first principles of coincidence detection and the combinatorics of unordered pairs drawn from sets of size $N$, derive a closed-form expression for the total number of distinct detector-pair LORs accepted in $2\\text{D}$ mode for the entire scanner as a function of $M$ and $N$. Express your final answer as a single analytic expression in terms of $M$ and $N$. No numerical evaluation or rounding is required, and no physical units should be included in your answer.", "solution": "The problem requires the derivation of a closed-form expression for the total number of distinct Lines of Response (LORs) in a cylindrical PET scanner operating in $2\\text{D}$ acquisition mode. The scanner is defined by $M$ axial rings, each containing $N$ crystals.\n\nThe problem statement specifies two types of accepted LORs in $2\\text{D}$ mode:\n1.  Intra-ring LORs: LORs connecting two distinct crystals within the same ring.\n2.  Adjacent-ring LORs: LORs connecting a crystal in one ring to a crystal in an immediately neighboring ring.\n\nThe total number of LORs, which we will denote as $L_{2D}$, is the sum of the number of LORs from these two mutually exclusive categories.\n$$L_{2D} = L_{\\text{intra}} + L_{\\text{adjacent}}$$\n\nWe will derive the expression for each category separately based on first principles of combinatorics.\n\nFirst, let us calculate the number of intra-ring LORs, $L_{\\text{intra}}$.\nAn intra-ring LOR is formed by selecting two distinct crystals from within a single ring. Each ring contains $N$ crystals. The problem states that an LOR defined by the crystal pair $\\{i,j\\}$ is identical to the LOR defined by $\\{j,i\\}$. This implies that we are counting unordered pairs of crystals. The number of ways to choose $2$ distinct items from a set of $N$ is given by the binomial coefficient, $\\binom{N}{k}$ with $k=2$.\nThe number of LORs within a single ring is therefore:\n$$ L_{\\text{per ring}} = \\binom{N}{2} = \\frac{N!}{2!(N-2)!} = \\frac{N(N-1)}{2} $$\nThe scanner consists of $M$ such rings. Since intra-ring LORs are confined to their respective rings, the total number of intra-ring LORs for the entire scanner is the number of LORs per ring multiplied by the number of rings, $M$.\n$$ L_{\\text{intra}} = M \\times L_{\\text{per ring}} = M \\frac{N(N-1)}{2} $$\n\nNext, we calculate the number of adjacent-ring LORs, $L_{\\text{adjacent}}$.\nAn adjacent-ring LOR connects a crystal in a ring $k$ to a crystal in a neighboring ring, $k+1$. For a scanner with $M$ rings (indexed from $1$ to $M$), there are $M-1$ pairs of adjacent rings: $(1,2), (2,3), \\ldots, (M-1, M)$.\nLet us consider a single pair of adjacent rings. Each ring has $N$ crystals. To form an LOR between these two rings, one must choose one crystal from the first ring and one crystal from the second ring.\nThe number of choices for a crystal from the first ring is $N$.\nThe number of choices for a crystal from the second ring is $N$.\nBy the fundamental principle of counting (the rule of product), the total number of LORs between one pair of adjacent rings is the product of the number of choices from each ring.\n$$ L_{\\text{per adjacent pair}} = N \\times N = N^2 $$\nUnlike the intra-ring case, we do not divide by $2$. The crystals are drawn from two distinct sets (the two different rings), so each of the $N^2$ pairs represents a unique geometric line.\nThe total number of adjacent-ring LORs for the scanner is the number of LORs per adjacent pair multiplied by the number of adjacent pairs, which is $M-1$.\n$$ L_{\\text{adjacent}} = (M-1) \\times L_{\\text{per adjacent pair}} = (M-1)N^2 $$\n\nFinally, we find the total number of accepted $2\\text{D}$ LORs, $L_{2D}$, by summing the two components.\n$$ L_{2D} = L_{\\text{intra}} + L_{\\text{adjacent}} = M \\frac{N(N-1)}{2} + (M-1)N^2 $$\nTo provide a single closed-form expression, we simplify this algebraically.\n$$ L_{2D} = \\frac{M(N^2-N)}{2} + (M-1)N^2 $$\n$$ L_{2D} = \\frac{MN^2 - MN}{2} + \\frac{2(M-1)N^2}{2} $$\n$$ L_{2D} = \\frac{MN^2 - MN + 2MN^2 - 2N^2}{2} $$\nCombining like terms in the numerator:\n$$ L_{2D} = \\frac{(MN^2 + 2MN^2) - 2N^2 - MN}{2} $$\n$$ L_{2D} = \\frac{3MN^2 - 2N^2 - MN}{2} $$\nThis expression can be factored by pulling out the common term $N$ from the numerator.\n$$ L_{2D} = \\frac{N(3MN - 2N - M)}{2} $$\nThis is the final, simplified, closed-form expression for the total number of distinct detector-pair LORs accepted in $2\\text{D}$ mode.", "answer": "$$\\boxed{\\frac{N(3MN - 2N - M)}{2}}$$", "id": "4859470"}]}