{"hands_on_practices": [{"introduction": "Physiological motion, such as breathing, is a primary source of artifacts in medical imaging. When an object moves during the data acquisition window, the resulting image is blurred, much like a photograph taken with a slow shutter speed. This first practice provides a quantitative foundation for understanding this effect by modeling respiratory motion as a simple sinusoid. By calculating the maximum possible displacement of the diaphragm during a Computed Tomography (CT) scan [@problem_id:4911791], you will connect a physiological parameter directly to the potential spatial extent of image blur.", "problem": "A patient’s superior–inferior diaphragm motion during normal breathing is modeled as a sinusoid. The respiration rate is $12\\,\\text{breaths}\\,\\text{min}^{-1}$, and the diaphragm peak-to-peak excursion is $20\\,\\text{mm}$. The position is modeled by $x(t)=10\\sin(2\\pi f t)$ in millimeters, where $f$ is the breathing frequency and the argument of the sine is in radians. During a single rotation of a Computed Tomography (CT) gantry lasting $\\Delta t=0.3\\,\\text{s}$, the acquisition integrates over this time window, effectively averaging the signal while the diaphragm moves.\n\nAssuming the start phase of the motion at the beginning of the gantry rotation is unknown, compute the maximum possible displacement magnitude of the diaphragm between the beginning and end of the rotation, defined as $|\\Delta x|_{\\max}=\\max_{t}\\,|x(t+\\Delta t)-x(t)|$. Use the given sinusoidal model, express the final numerical result in $\\text{mm}$, and round your answer to four significant figures. Angles must be treated in radians. Briefly explain, in words, the implications of this motion for image blur during CT acquisition.", "solution": "The problem statement will first be validated according to the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Patient's superior–inferior diaphragm motion model: Sinusoidal.\n- Respiration rate: $12\\,\\text{breaths}\\,\\text{min}^{-1}$.\n- Diaphragm peak-to-peak excursion: $20\\,\\text{mm}$.\n- Position model: $x(t) = 10\\sin(2\\pi f t)$, in millimeters.\n- Independent variable $t$: time.\n- Parameter $f$: breathing frequency.\n- CT acquisition time window: $\\Delta t = 0.3\\,\\text{s}$.\n- Quantity to compute: The maximum possible displacement magnitude, defined as $|\\Delta x|_{\\max} = \\max_{t}\\,|x(t+\\Delta t) - x(t)|$.\n- Output requirements: Numerical result in $\\text{mm}$, rounded to four significant figures, and a brief explanation of the implications for image blur.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on established principles of physiological motion and medical imaging (specifically, CT). Modeling respiratory motion as a sinusoid is a common and valid first-order approximation. The given values for respiration rate ($12\\,\\text{breaths/min}$ is a typical resting rate) and diaphragm excursion ($20\\,\\text{mm}$ peak-to-peak is within the normal physiological range) are realistic. The concept of signal integration over an acquisition window is fundamental to CT and other imaging modalities.\n- **Well-Posed:** The problem is mathematically well-posed. It asks for the maximum of a well-defined, continuous, and bounded function over all possible start times $t$. All necessary parameters are provided or can be derived from the givens. The amplitude of the model, $10\\,\\text{mm}$, is consistent with the peak-to-peak excursion of $20\\,\\text{mm}$. A unique, stable solution exists.\n- **Objective:** The problem is stated using clear, objective language and precise mathematical definitions.\n\nThe problem does not exhibit any of the flaws listed in the instructions (e.g., scientific unsoundness, missing information, ambiguity). The setup is self-contained, consistent, and scientifically plausible.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe goal is to compute the maximum possible displacement of the diaphragm, $|\\Delta x|_{\\max}$, during a CT acquisition window of duration $\\Delta t$.\n\nFirst, we determine the breathing frequency, $f$, and the angular frequency, $\\omega$. The respiration rate is given as $12$ breaths per minute. To convert this to Hertz (cycles per second), we perform the following conversion:\n$$f = \\frac{12\\,\\text{breaths}}{1\\,\\text{min}} \\times \\frac{1\\,\\text{min}}{60\\,\\text{s}} = 0.2\\,\\text{Hz}$$\nThe angular frequency $\\omega$ is related to the frequency $f$ by $\\omega = 2\\pi f$.\n$$\\omega = 2\\pi (0.2\\,\\text{s}^{-1}) = 0.4\\pi\\,\\text{rad s}^{-1}$$\n\nThe position of the diaphragm as a function of time $t$ is given by the model:\n$$x(t) = A\\sin(\\omega t)$$\nwhere the amplitude is $A = 10\\,\\text{mm}$.\n\nThe displacement of the diaphragm, $\\Delta x$, over a time interval $\\Delta t$ starting at an arbitrary time $t$ is given by the difference between the position at the end and the beginning of the interval:\n$$\\Delta x(t) = x(t+\\Delta t) - x(t)$$\nSubstituting the model for $x(t)$:\n$$\\Delta x(t) = A\\sin(\\omega(t+\\Delta t)) - A\\sin(\\omega t) = A[\\sin(\\omega t + \\omega\\Delta t) - \\sin(\\omega t)]$$\n\nTo find the maximum possible magnitude of this displacement, we need to maximize $|\\Delta x(t)|$ with respect to the start time $t$. We can simplify the expression for $\\Delta x(t)$ using the trigonometric sum-to-product identity:\n$$\\sin(\\alpha) - \\sin(\\beta) = 2\\cos\\left(\\frac{\\alpha+\\beta}{2}\\right)\\sin\\left(\\frac{\\alpha-\\beta}{2}\\right)$$\nLet $\\alpha = \\omega t + \\omega\\Delta t$ and $\\beta = \\omega t$. Then:\n$$\\frac{\\alpha+\\beta}{2} = \\frac{2\\omega t + \\omega\\Delta t}{2} = \\omega t + \\frac{\\omega\\Delta t}{2}$$\n$$\\frac{\\alpha-\\beta}{2} = \\frac{\\omega\\Delta t}{2}$$\nSubstituting these into the identity, the displacement becomes:\n$$\\Delta x(t) = A \\left[ 2\\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right)\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right]$$\n\nWe are interested in the maximum magnitude of this displacement, $|\\Delta x|_{\\max} = \\max_{t}|\\Delta x(t)|$.\n$$|\\Delta x(t)| = \\left| 2A \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right) \\right|$$\nIn this expression, the term $2A\\sin(\\frac{\\omega\\Delta t}{2})$ is constant with respect to the start time $t$. The maximization over $t$ depends only on the cosine term. The maximum absolute value of the cosine function is $1$, which occurs when its argument is an integer multiple of $\\pi$.\n$$\\max_{t} \\left|\\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right)\\right| = 1$$\nTherefore, the maximum possible displacement magnitude is:\n$$|\\Delta x|_{\\max} = \\left| 2A \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right|$$\n\nNow, we substitute the numerical values: $A = 10\\,\\text{mm}$, $\\omega = 0.4\\pi\\,\\text{rad s}^{-1}$, and $\\Delta t = 0.3\\,\\text{s}$.\n$$|\\Delta x|_{\\max} = \\left| 2(10) \\sin\\left(\\frac{(0.4\\pi)(0.3)}{2}\\right) \\right|$$\n$$|\\Delta x|_{\\max} = \\left| 20 \\sin\\left(\\frac{0.12\\pi}{2}\\right) \\right| = |20 \\sin(0.06\\pi)|$$\nThe argument $0.06\\pi$ is in the first quadrant, so its sine is positive.\n$$|\\Delta x|_{\\max} = 20 \\sin(0.06\\pi)$$\nCalculating the numerical value:\n$$|\\Delta x|_{\\max} \\approx 20 \\times \\sin(0.1884955...)$$\n$$|\\Delta x|_{\\max} \\approx 20 \\times 0.1873813...$$\n$$|\\Delta x|_{\\max} \\approx 3.747626...\\,\\text{mm}$$\nRounding the result to four significant figures, as requested:\n$$|\\Delta x|_{\\max} = 3.748\\,\\text{mm}$$\n\n### Implications for Image Blur\n\nThis calculated value, $|\\Delta x|_{\\max} \\approx 3.748\\,\\text{mm}$, represents the maximum possible distance the diaphragm moves in the superior-inferior direction during a single CT gantry rotation (the data acquisition window). CT image reconstruction algorithms assume the object being scanned is stationary during this acquisition. When physiological motion occurs, this assumption is violated. The CT scanner measures X-ray attenuation, and during the $\\Delta t = 0.3\\,\\text{s}$ acquisition, the signal from any given point is effectively an average or integral of the attenuation from all positions occupied by the moving tissue.\n\nThis motion causes features in the image, especially sharp boundaries like the edge of the diaphragm, to appear smeared or blurred. This artifact, known as motion blur or an intra-scan motion artifact, degrades image quality. The extent of the blurring is directly related to the distance the object moves during the scan. The value $|\\Delta x|_{\\max}$ provides a worst-case estimate for the spatial extent of this blurring artifact along the axis of motion. Such blurring can obscure small anatomical details or pathologies, such as nodules in the lung bases or lesions in the liver dome, potentially compromising the diagnostic accuracy of the CT scan.", "answer": "$$\n\\boxed{3.748}\n$$", "id": "4911791"}, {"introduction": "Having seen how motion causes image degradation, a natural next step is to design acquisition strategies to avoid it. Cardiac Magnetic Resonance Imaging (MRI) often employs a technique called prospective gating, where data is acquired only during the brief, relatively still ('quiescent') phase of the heartbeat. This exercise [@problem_id:4911792] puts you in the role of an MRI technologist or physicist, tasking you with calculating the critical timing parameters for a gated cardiac scan. You will discover the fundamental trade-off between motion artifact reduction and total acquisition time.", "problem": "A two-dimensional Cartesian Magnetic Resonance Imaging (MRI) sequence is prospectively Electrocardiogram (ECG) gated to acquire only during a quiescent mid-diastolic window in order to minimize motion artifacts. The subject has a heart rate of $75\\,\\mathrm{bpm}$, and the mid-diastolic quiescent window duration is $80\\,\\mathrm{ms}$. Each repetition time, denoted $\\mathrm{TR}$, is $4\\,\\mathrm{ms}$ and produces one distinct phase-encoding line. One image requires $256$ unique phase-encoding lines. Assume perfect gating, no arrhythmias, and that all lines must be acquired entirely within the quiescent window to be accepted for reconstruction.\n\nUsing only fundamental definitions of heart rate, period, and time-budgeting, determine the following acquisition constraints for motion-free reconstruction segments:\n(i) the maximum number of phase-encoding lines that can be acquired per cardiac cycle,\n(ii) the minimum number of accepted heartbeats required to complete one image,\n(iii) the minimum total acquisition time, expressed in seconds,\n(iv) the fraction of each R–R interval that is available for motion-free acquisition, expressed as a decimal.\n\nReport your answers in the order (i), (ii), (iii), (iv). If any rounding would be required, round to four significant figures; otherwise provide exact values.", "solution": "The heart rate is defined as beats per unit time. For a heart rate $HR$ in beats per minute, the duration of one cardiac cycle (the R–R interval) is the period\n$$\nT_{RR} = \\frac{60}{HR}\\mathrm{s}.\n$$\nWith $HR = 75\\,\\mathrm{bpm}$, this gives\n$$\nT_{RR} = \\frac{60}{75} = 0.8\\,\\mathrm{s}.\n$$\nThe quiescent window has duration $T_{w} = 80\\,\\mathrm{ms} = 0.08\\,\\mathrm{s}$. Acquisition is restricted to this window to avoid motion. Each repetition time $\\mathrm{TR} = 4\\,\\mathrm{ms} = 0.004\\,\\mathrm{s}$ yields one phase-encoding line, and to ensure lines are fully within the window, the number of lines per beat is limited by the time budget available.\n\n(i) The maximum number of lines per cardiac cycle is the greatest integer that fits within the window:\n$$\nN_{\\max} = \\left\\lfloor \\frac{T_{w}}{\\mathrm{TR}} \\right\\rfloor = \\left\\lfloor \\frac{0.08}{0.004} \\right\\rfloor = \\left\\lfloor 20 \\right\\rfloor = 20.\n$$\n\n(ii) The image requires $N_{\\mathrm{req}} = 256$ unique phase-encoding lines. The minimum number of accepted heartbeats needed to collect all lines, acquiring $N_{\\max}$ lines per beat, is\n$$\nB_{\\min} = \\left\\lceil \\frac{N_{\\mathrm{req}}}{N_{\\max}} \\right\\rceil = \\left\\lceil \\frac{256}{20} \\right\\rceil = \\left\\lceil 12.8 \\right\\rceil = 13.\n$$\n\n(iii) The minimum total acquisition time assuming every heartbeat contributes its full quota is the product of the number of accepted heartbeats and the R–R interval:\n$$\nT_{\\mathrm{scan,min}} = B_{\\min} \\, T_{RR} = 13 \\times 0.8\\,\\mathrm{s} = 10.4\\,\\mathrm{s}.\n$$\n\n(iv) The fraction of each R–R interval that is motion-free (the duty cycle for accepted acquisition) is the ratio of the window duration to the R–R interval:\n$$\nf = \\frac{T_{w}}{T_{RR}} = \\frac{0.08}{0.8} = 0.1.\n$$\n\nThus, the acquisition constraints are $N_{\\max} = 20$ lines per beat, $B_{\\min} = 13$ heartbeats, $T_{\\mathrm{scan,min}} = 10.4\\,\\mathrm{s}$, and $f = 0.1$.", "answer": "$$\\boxed{\\begin{pmatrix}20 & 13 & 10.4 & 0.1\\end{pmatrix}}$$", "id": "4911792"}, {"introduction": "Beyond causing qualitative artifacts like blurring, motion can introduce significant errors in quantitative imaging, where the goal is to measure biological function. In Positron Emission Tomography (PET), metrics like the Standardized Uptake Value (SUV) are crucial for cancer diagnosis and monitoring, but are highly susceptible to motion-induced bias. This advanced practice [@problem_id:4911809] challenges you to develop a computational model to simulate and quantify this bias. By combining the effects of sinusoidal respiratory motion with the scanner's intrinsic Point Spread Function (PSF), you will gain insight into the complex interplay of factors that affect the accuracy of modern functional imaging.", "problem": "A single, uniform, spherical lung nodule with radius $R$ expressed in millimeters is imaged with Positron Emission Tomography (PET). The image formation is modeled as a linear, shift-invariant convolution of the true activity distribution with a Gaussian Point Spread Function (PSF), and reconstruction is performed without motion correction. The nodule center moves along the $x$-axis following a sinusoid $x(t) = A \\sin(\\omega t)$ with amplitude $A$ expressed in millimeters, where the time-average over many cycles is taken. The Gaussian PSF has full width at half maximum (FWHM) equal to a specified value in millimeters, and its standard deviation $\\sigma$ is related to the FWHM by $\\sigma = \\dfrac{\\text{FWHM}}{2\\sqrt{2\\ln 2}}$. The Standardized Uptake Value (SUV) is treated as proportional to the local reconstructed activity concentration, so the relative bias is independent of the normalization constant. Assume the true SUV inside the nodule is uniform and equal to a constant $C$.\n\nStarting from the fundamentals:\n- Imaging linearity and shift-invariance, so reconstruction without motion correction yields the time-average of the instantaneous convolution of the object with the PSF.\n- The Gaussian PSF in three dimensions is normalized to unit integral.\n- Sinusoidal motion over many cycles results in a time-averaged displacement distribution derived from $x(t) = A \\sin(\\omega t)$, with uniform sampling over time.\n\nDefine the fractional SUV bias at the nominal nodule center as\n$$\n\\text{bias} = \\frac{I_{\\text{measured}} - C}{C},\n$$\nwhere $I_{\\text{measured}}$ is the reconstructed intensity at the nominal center after time-averaging and convolution. Express the final answers as decimals (for example, $-0.25$ represents a $25$ percent underestimation), with no percentage sign.\n\nYour task is to compute the fractional SUV bias for each test case below. All distances are in millimeters and angles (if used internally) must be in radians. The Gaussian PSF parameter must be converted using $\\sigma = \\dfrac{\\text{FWHM}}{2\\sqrt{2\\ln 2}}$ before use. When $\\text{FWHM} = 0$, treat the PSF as ideal (no blurring), and use the exact time-occupancy fraction at the nominal center implied by the sinusoidal motion and the spherical geometry.\n\nTest Suite (each case given as $(\\text{diameter}, A, \\text{FWHM})$, with diameter in millimeters, amplitude $A$ in millimeters, and FWHM in millimeters):\n1. $(10, 5, 6)$\n2. $(10, 0, 6)$\n3. $(10, 10, 6)$\n4. $(6, 5, 6)$\n5. $(10, 5, 0)$\n\nYour program must produce a single line of output containing the fractional SUV biases for the test suite as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places, in the order listed above (for example, $[b_1,b_2,b_3,b_4,b_5]$). No other output is permitted.", "solution": "The imaging system is modeled as linear and shift-invariant, so the reconstruction without motion correction is the time-average of instantaneous images. Let the true object be a uniform sphere of radius $R$ with activity $C$ inside the sphere and $0$ outside. The Point Spread Function (PSF) is a three-dimensional Gaussian with standard deviation $\\sigma$, normalized to unit integral:\n$$\ng(\\mathbf{x}) = \\frac{1}{( \\sqrt{2\\pi}\\sigma )^3} \\exp\\!\\left( -\\frac{\\|\\mathbf{x}\\|^2}{2\\sigma^2} \\right).\n$$\nAt any instant, when the sphere is displaced by $\\mathbf{s} = (u, 0, 0)$ along the $x$-axis, the reconstructed image equals the convolution $f * g$ of the true activity distribution $f$ with the PSF. The intensity at the nominal center (the origin) for a fixed displacement $u$ is\n$$\nI(u) = \\int_{\\mathbb{R}^3} f(\\mathbf{z})\\, g(\\mathbf{z} + \\mathbf{s})\\, d\\mathbf{z}.\n$$\nBecause $f$ is an indicator of the sphere scaled by $C$, i.e., $f(\\mathbf{z}) = C \\cdot \\mathbb{1}_{\\{\\|\\mathbf{z}\\| \\le R\\}}$, and $g$ is a probability density, the ratio $I(u)/C$ becomes a probability:\n$$\n\\frac{I(u)}{C} = \\int_{\\|\\mathbf{z}\\| \\le R} g(\\mathbf{z} + \\mathbf{s})\\, d\\mathbf{z} = \\mathbb{P}\\left( \\left\\| \\mathbf{X} - \\mathbf{s} \\right\\| \\le R \\right),\n$$\nwhere $\\mathbf{X} \\sim \\mathcal{N}\\!\\left(\\mathbf{0}, \\sigma^2 \\mathbf{I}_3\\right)$ is a three-dimensional Gaussian random vector. The squared norm $\\frac{\\|\\mathbf{X} - \\mathbf{s}\\|^2}{\\sigma^2}$ follows a noncentral chi-square distribution with $k=3$ degrees of freedom and noncentrality parameter $\\lambda = \\frac{\\|\\mathbf{s}\\|}{\\sigma}$, denoted $\\chi^2_{k=3, \\text{nc}=\\lambda^2}$. Therefore,\n$$\n\\frac{I(u)}{C} = F_{\\chi^2_{3, \\text{nc}=(u/\\sigma)^2}}\\!\\left( \\frac{R^2}{\\sigma^2} \\right),\n$$\nwhere $F_{\\chi^2_{3, \\text{nc}}}$ is the cumulative distribution function.\n\nWithout motion correction, the reconstructed intensity at the nominal center is the time-average over the motion cycle. For sinusoidal motion $x(t) = A \\sin(\\omega t)$, uniform averaging in time corresponds to uniform averaging over the phase $\\theta = \\omega t$ on $[0, 2\\pi]$. The displacement is $u(\\theta) = A \\sin(\\theta)$. Thus, the time-averaged ratio is\n$$\n\\frac{I_{\\text{measured}}}{C} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} F_{\\chi^2_{3, \\text{nc}=(A \\sin\\theta/\\sigma)^2}}\\!\\left( \\frac{R^2}{\\sigma^2} \\right)\\, d\\theta,\n$$\nand the fractional SUV bias becomes\n$$\n\\text{bias} = \\frac{I_{\\text{measured}}}{C} - 1.\n$$\nThis integral representation is numerically well-behaved because the integrand is bounded and smooth in $\\theta$. The conversion from full width at half maximum (FWHM) to standard deviation is\n$$\n\\sigma = \\frac{\\text{FWHM}}{2\\sqrt{2\\ln 2}}.\n$$\n\nBoundary conditions and special handling:\n- If $A = 0$, then $u(\\theta) = 0$ for all $\\theta$, and\n$$\n\\frac{I_{\\text{measured}}}{C} = F_{\\chi^2_{3, \\text{nc}=0}}\\!\\left( \\frac{R^2}{\\sigma^2} \\right),\n$$\nwhich quantifies partial volume loss from the PSF alone.\n- If $\\sigma = 0$ (i.e., FWHM equals $0$), the PSF is ideal and the convolution reduces to the object itself. The time-average at the origin is the fraction of time the moving sphere covers the origin. The origin is inside the sphere when $\\lvert u(\\theta) \\rvert \\le R$. For $R \\ge A$, this holds for all $\\theta$, so the fraction is $1$. For $R < A$, the set of phases where $\\lvert \\sin\\theta \\rvert \\le R/A$ has total measure $4 \\arcsin(R/A)$ on $[0, 2\\pi]$, giving the occupancy fraction\n$$\n\\frac{I_{\\text{measured}}}{C} = \\frac{4 \\arcsin(R/A)}{2\\pi} = \\frac{2}{\\pi} \\arcsin\\!\\left( \\frac{R}{A} \\right),\n$$\nand the fractional bias is this fraction minus $1$.\n\nAlgorithmic steps for computation:\n1. Convert the given diameter to radius via $R = \\text{diameter}/2$.\n2. Convert FWHM to $\\sigma$ using $\\sigma = \\text{FWHM} / \\left( 2\\sqrt{2\\ln 2} \\right)$.\n3. If $\\sigma = 0$, use the occupancy formula above to get $\\frac{I_{\\text{measured}}}{C}$ and subtract $1$ to get the bias.\n4. Otherwise, evaluate the integral $\\dfrac{1}{2\\pi}\\int_{0}^{2\\pi} F_{\\chi^2_{3, \\text{nc}=(A \\sin\\theta/\\sigma)^2}}\\!\\left( \\dfrac{R^2}{\\sigma^2} \\right)\\, d\\theta$ numerically using a reliable quadrature method with angles in radians, and compute $\\text{bias}$ as this average minus $1$.\n5. Round each bias to six decimal places and return the list in the required format.\n\nThe test suite exercises a typical case with motion and PSF, a PSF-only case, a large-amplitude motion case, a smaller nodule where partial volume loss is more severe, and an ideal-PSF boundary case where motion amplitude equals the radius. The output must be a single line with the comma-separated list of the five fractional biases in the order specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import ncx2\nfrom scipy import integrate\n\ndef fwhm_to_sigma(fwhm_mm: float) -> float:\n    \"\"\"Convert Gaussian FWHM (mm) to standard deviation sigma (mm).\"\"\"\n    return fwhm_mm / (2.0 * np.sqrt(2.0 * np.log(2.0)))\n\ndef occupancy_fraction_no_psf(radius_mm: float, amplitude_mm: float) -> float:\n    \"\"\"\n    For sigma = 0 (ideal PSF), compute the fraction of time the origin is\n    within the moving sphere. Motion is sinusoidal along x with amplitude A.\n    \"\"\"\n    R = radius_mm\n    A = amplitude_mm\n    if A <= 0.0:\n        # No motion: sphere always covers origin.\n        return 1.0\n    if R >= A:\n        # Origin always inside sphere for all phases.\n        return 1.0\n    # Otherwise, fraction of phases where |sin(theta)| <= R/A\n    k = R / A\n    return (2.0 / np.pi) * np.arcsin(k)\n\ndef suv_bias_fraction(diameter_mm: float, amplitude_mm: float, fwhm_mm: float) -> float:\n    \"\"\"\n    Compute fractional SUV bias at the nominal center:\n    bias = (I_measured - C)/C, with I_measured time-averaged reconstructed intensity.\n    Distances in mm. Uses noncentral chi-square CDF for Gaussian PSF.\n    \"\"\"\n    R = diameter_mm / 2.0\n    sigma = fwhm_to_sigma(fwhm_mm)\n\n    # Handle ideal PSF special case (sigma == 0)\n    if sigma <= 0.0:\n        frac = occupancy_fraction_no_psf(R, amplitude_mm)\n        return frac - 1.0\n\n    # Define integrand over theta (radians), uniform over [0, 2*pi]\n    x_val = (R / sigma) ** 2  # CDF argument for chi-square\n    def integrand(theta: float) -> float:\n        u = amplitude_mm * np.sin(theta)\n        nc_param = (u / sigma) ** 2  # noncentrality parameter for chi-square\n        return ncx2.cdf(x_val, df=3, nc=nc_param)\n\n    # Numerically integrate over theta from 0 to 2*pi\n    avg_prob, _ = integrate.quad(integrand, 0.0, 2.0 * np.pi, epsabs=1e-10, epsrel=1e-10, limit=200)\n    avg_prob /= (2.0 * np.pi)\n\n    # Fractional bias\n    return avg_prob - 1.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each is a tuple: (diameter_mm, amplitude_mm, fwhm_mm)\n    test_cases = [\n        (10.0, 5.0, 6.0),\n        (10.0, 0.0, 6.0),\n        (10.0, 10.0, 6.0),\n        (6.0, 5.0, 6.0),\n        (10.0, 5.0, 0.0),\n    ]\n\n    results = []\n    for diameter_mm, amplitude_mm, fwhm_mm in test_cases:\n        bias = suv_bias_fraction(diameter_mm, amplitude_mm, fwhm_mm)\n        results.append(f\"{bias:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4911809"}]}