{"hands_on_practices": [{"introduction": "To reconstruct a PET image, we must first model how the scanner \"sees\" the patient. This is achieved by calculating the path of each possible Line of Response (LOR) through a grid of image elements, or voxels. This foundational exercise guides you through the core geometric calculation used in modern reconstruction algorithms, showing how to determine the exact length of the path a single LOR takes through a single voxel [@problem_id:4907349]. Mastering this principle is the first step toward understanding how raw scanner data is transformed into a meaningful diagnostic image.", "problem": "A Positron Emission Tomography (PET) system with a cylindrical gantry of radius $400\\,\\mathrm{mm}$ places two opposing detector elements at polar angles $30^{\\circ}$ and $210^{\\circ}$ in the transaxial plane. The detector at $30^{\\circ}$ is located at $(x,y,z) = \\big(200\\sqrt{3}\\,,\\,200\\,,\\,-20\\big)\\,\\mathrm{mm}$ and the opposing detector at $210^{\\circ}$ is at $(x,y,z) = \\big(-200\\sqrt{3}\\,,\\,-200\\,,\\,40\\big)\\,\\mathrm{mm}$. The line of response (LOR) is the straight line segment connecting these two detector centers.\n\nConsider a single axis-aligned voxel defined in the scanner coordinate system by the bounds $x \\in [-5,0]\\,\\mathrm{mm}$, $y \\in [-5,5]\\,\\mathrm{mm}$, and $z \\in [0,20]\\,\\mathrm{mm}$. In a ray-driven discrete forward model for PET, the contribution (weight) of this voxel to the measured LOR is proportional to the chord length of the LOR through the voxel. Using only first principles of analytic geometry and the fundamental idea behind Siddon’s algorithm (parameterize the ray and determine the entry and exit parameters by intersecting with the voxel’s axis-aligned planes), derive the exact chord length of the LOR segment that lies inside this voxel.\n\nYou must:\n- Parameterize the LOR as a straight line segment connecting the two detector centers.\n- Determine the parameter values at which the ray intersects each of the voxel’s axis-aligned planes.\n- Identify the valid entry and exit parameters for the voxel and compute the path length inside the voxel as the difference between exit and entry parameters, scaled by the physical length of the full LOR segment.\n- Express the final weight as the exact path length in $\\mathrm{mm}$ with no numerical approximation.\n\nExpress your final answer as an exact closed-form expression in millimeters. Do not round or approximate.", "solution": "The problem is valid as it is scientifically grounded in the principles of PET imaging geometry, is well-posed with sufficient and consistent data, and is expressed objectively. We can therefore proceed with a formal derivation of the chord length.\n\nThe core of the problem is to determine the length of the intersection of a line segment (the Line of Response, LOR) with a rectangular prism (the voxel). This is a standard procedure in computational geometry, often applied in tomographic reconstruction algorithms like the one proposed by Siddon.\n\nLet the two detector positions be $P_1$ and $P_2$. The given coordinates are:\n$$P_1 = (x_1, y_1, z_1) = (200\\sqrt{3}, 200, -20)\\,\\mathrm{mm}$$\n$$P_2 = (x_2, y_2, z_2) = (-200\\sqrt{3}, -200, 40)\\,\\mathrm{mm}$$\n\nFirst, we parameterize the LOR as a line segment $L(t)$ for a parameter $t \\in [0, 1]$, where $L(0) = P_1$ and $L(1) = P_2$. The equation for the line is:\n$$L(t) = P_1 + t(P_2 - P_1)$$\nThe direction vector of the LOR, $V = P_2 - P_1$, is:\n$$V = \\langle x_2-x_1, y_2-y_1, z_2-z_1 \\rangle$$\n$$V = \\langle -200\\sqrt{3} - 200\\sqrt{3}, -200 - 200, 40 - (-20) \\rangle$$\n$$V = \\langle -400\\sqrt{3}, -400, 60 \\rangle$$\nThe total length of the LOR segment, $|V|$, is:\n$$|V| = \\sqrt{(-400\\sqrt{3})^2 + (-400)^2 + 60^2}$$\n$$|V| = \\sqrt{160000 \\cdot 3 + 160000 + 3600} = \\sqrt{480000 + 160000 + 3600} = \\sqrt{643600}$$\n$$|V| = \\sqrt{100 \\cdot 6436} = 10\\sqrt{4 \\cdot 1609} = 20\\sqrt{1609}\\,\\mathrm{mm}$$\n\nThe parametric equations for the coordinates of a point on the LOR are:\n$$x(t) = x_1 + t V_x = 200\\sqrt{3} - 400\\sqrt{3} t$$\n$$y(t) = y_1 + t V_y = 200 - 400 t$$\n$$z(t) = z_1 + t V_z = -20 + 60 t$$\n\nNext, we determine the values of the parameter $t$ at which the LOR intersects the six planes bounding the voxel. The voxel is defined by:\n$$x \\in [x_{\\min}, x_{\\max}] = [-5, 0]\\,\\mathrm{mm}$$\n$$y \\in [y_{\\min}, y_{\\max}] = [-5, 5]\\,\\mathrm{mm}$$\n$$z \\in [z_{\\min}, z_{\\max}] = [0, 20]\\,\\mathrm{mm}$$\n\nFor each dimension, we solve for $t$:\n1.  **Intersections with x-planes:**\n    $x(t) = 0 \\implies 200\\sqrt{3} - 400\\sqrt{3} t = 0 \\implies t = \\frac{200\\sqrt{3}}{400\\sqrt{3}} = \\frac{1}{2}$.\n    $x(t) = -5 \\implies 200\\sqrt{3} - 400\\sqrt{3} t = -5 \\implies 400\\sqrt{3} t = 200\\sqrt{3} + 5 \\implies t = \\frac{200\\sqrt{3} + 5}{400\\sqrt{3}} = \\frac{1}{2} + \\frac{5}{400\\sqrt{3}} = \\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$.\n    Since $V_x  0$, $x(t)$ is a decreasing function. The LOR enters the x-slab at $x=0$ and exits at $x=-5$. The parameter interval for the x-dimension is $[t_{x, \\text{start}}, t_{x, \\text{end}}] = [\\frac{1}{2}, \\frac{1}{2} + \\frac{1}{80\\sqrt{3}}]$.\n\n2.  **Intersections with y-planes:**\n    $y(t) = 5 \\implies 200 - 400 t = 5 \\implies 400 t = 195 \\implies t = \\frac{195}{400} = \\frac{39}{80}$.\n    $y(t) = -5 \\implies 200 - 400 t = -5 \\implies 400 t = 205 \\implies t = \\frac{205}{400} = \\frac{41}{80}$.\n    Since $V_y  0$, $y(t)$ is decreasing. The LOR enters the y-slab at $y=5$ and exits at $y=-5$. The parameter interval is $[t_{y, \\text{start}}, t_{y, \\text{end}}] = [\\frac{39}{80}, \\frac{41}{80}]$.\n\n3.  **Intersections with z-planes:**\n    $z(t) = 0 \\implies -20 + 60 t = 0 \\implies 60 t = 20 \\implies t = \\frac{20}{60} = \\frac{1}{3}$.\n    $z(t) = 20 \\implies -20 + 60 t = 20 \\implies 60 t = 40 \\implies t = \\frac{40}{60} = \\frac{2}{3}$.\n    Since $V_z  0$, $z(t)$ is increasing. The LOR enters the z-slab at $z=0$ and exits at $z=20$. The parameter interval is $[t_{z, \\text{start}}, t_{z, \\text{end}}] = [\\frac{1}{3}, \\frac{2}{3}]$.\n\nThe LOR is inside the voxel for the range of $t$ that satisfies all three conditions simultaneously. This corresponds to the intersection of the three parameter intervals. The resulting interval, $[t_{\\text{in}}, t_{\\text{out}}]$, is found as follows:\n$$t_{\\text{in}} = \\max(t_{x, \\text{start}}, t_{y, \\text{start}}, t_{z, \\text{start}}) = \\max\\left(\\frac{1}{2}, \\frac{39}{80}, \\frac{1}{3}\\right)$$\nTo compare, we use a common denominator of $240$: $\\max(\\frac{120}{240}, \\frac{117}{240}, \\frac{80}{240}) = \\frac{120}{240} = \\frac{1}{2}$.\n$$t_{\\text{out}} = \\min(t_{x, \\text{end}}, t_{y, \\text{end}}, t_{z, \\text{end}}) = \\min\\left(\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}, \\frac{41}{80}, \\frac{2}{3}\\right)$$\nLet's compare the values. $\\frac{41}{80} = 0.5125$. $\\frac{2}{3} \\approx 0.6667$. $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}} = \\frac{1}{2} + \\frac{\\sqrt{3}}{240} \\approx 0.5 + \\frac{1.732}{240} \\approx 0.5 + 0.0072 = 0.5072$.\nThe smallest value is thus $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$.\nTo prove this rigorously without approximation: compare $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$ to $\\frac{41}{80}$. This is equivalent to comparing $\\frac{1}{80\\sqrt{3}}$ to $\\frac{41}{80} - \\frac{1}{2} = \\frac{41-40}{80} = \\frac{1}{80}$. We compare $\\frac{1}{\\sqrt{3}}$ to $1$, and since $\\sqrt{3}  1$, we have $\\frac{1}{\\sqrt{3}}  1$. Thus, $\\frac{1}{80\\sqrt{3}}  \\frac{1}{80}$, and $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}  \\frac{41}{80}$. The minimum is $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$.\n\nSo, the parameter interval for which the LOR is inside the voxel is:\n$$[t_{\\text{in}}, t_{\\text{out}}] = \\left[\\frac{1}{2}, \\frac{1}{2} + \\frac{1}{80\\sqrt{3}}\\right]$$\nSince $t_{\\text{in}}  t_{\\text{out}}$, the LOR does intersect the voxel. The length of this parameter interval is:\n$$\\Delta t = t_{\\text{out}} - t_{\\text{in}} = \\left(\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}\\right) - \\frac{1}{2} = \\frac{1}{80\\sqrt{3}}$$\nThe chord length, $L_{\\text{chord}}$, is the product of this parameter interval length and the total length of the LOR vector:\n$$L_{\\text{chord}} = \\Delta t \\cdot |V| = \\left(\\frac{1}{80\\sqrt{3}}\\right) \\cdot (20\\sqrt{1609})$$\n$$L_{\\text{chord}} = \\frac{20\\sqrt{1609}}{80\\sqrt{3}} = \\frac{\\sqrt{1609}}{4\\sqrt{3}}$$\nTo provide the answer in a rationalized, closed form, we multiply the numerator and denominator by $\\sqrt{3}$:\n$$L_{\\text{chord}} = \\frac{\\sqrt{1609} \\cdot \\sqrt{3}}{4\\sqrt{3} \\cdot \\sqrt{3}} = \\frac{\\sqrt{1609 \\cdot 3}}{4 \\cdot 3} = \\frac{\\sqrt{4827}}{12}$$\nThis is the exact chord length of the LOR segment inside the specified voxel.", "answer": "$$\\boxed{\\frac{\\sqrt{4827}}{12}}$$", "id": "4907349"}, {"introduction": "While ideal models assume detectors are infinitely thin points, real-world PET scanners use scintillation crystals with a finite thickness. This physical reality introduces a geometric uncertainty known as parallax error, which can affect the spatial accuracy of the final image, particularly for events far from the gantry's center. This practice problem allows you to derive the radial bias caused by this effect, providing a crucial link between a physical design parameter—crystal thickness—and its direct impact on image quality [@problem_id:4907415].", "problem": "A Positron Emission Tomography (PET) system has a circular ring of detectors of radius $R$ equipped with scintillation crystals of radial thickness $t$. Events are reconstructed as lines of response (LORs) connecting pairs of opposite detectors. When the Depth of Interaction (DOI) is unknown, the interaction may occur anywhere within the crystal thickness, which induces an angular uncertainty in the effective detection angle. For small $t/R$, approximate the angular uncertainty magnitude by $\\delta\\alpha \\approx t/R$ and model the angular error as a random perturbation $\\varepsilon$ that is uniformly distributed on $[-\\delta\\alpha,\\delta\\alpha]$ with zero mean.\n\nConsider an annihilation event located at radial offset $\\rho$ along the $x$-axis. Use the following foundations:\n- The Radon transform of a point $(x,y)$ yields the projection $s(\\alpha) = x \\cos\\alpha + y \\sin\\alpha$ at angle $\\alpha$.\n- In simple backprojection, each projection is backprojected along the line $x \\cos\\alpha + y \\sin\\alpha = s(\\alpha)$, and the reconstructed location is influenced by the ensemble of such lines.\n\nAssume that angular uncertainty enters as a perturbation of the backprojection angle, so that the backprojected line uses $\\alpha+\\varepsilon$ while the measured projection length $s(\\alpha)$ corresponds to the true angle $\\alpha$. Work in the small-angle regime to second order in $\\varepsilon$, and take the ensemble mean over the uniform distribution of $\\varepsilon$.\n\nDerive, to second order in $t/R$, a closed-form analytic expression for the expected radial position bias $b(\\rho)$, defined as the difference between the ensemble-mean reconstructed radial coordinate along the $x$-axis and the true radial offset $\\rho$, expressed as a function of $\\rho$, $t$, and $R$. Present your final expression for $b(\\rho)$ in terms of $\\rho$, $t$, and $R$. No numerical rounding is required.", "solution": "The user wants to solve the problem described in the prompt. I will begin by validating the problem.\n\n### Step 1: Extract Givens\n- **System Geometry:** A Positron Emission Tomography (PET) system with a circular ring of detectors.\n- **Detector Ring Radius:** $R$.\n- **Crystal Thickness:** Scintillation crystals have a radial thickness $t$.\n- **Reconstruction Primitive:** Events are reconstructed as lines of response (LORs).\n- **DOI Uncertainty Model:** The interaction depth is unknown, leading to an angular uncertainty.\n- **Angular Uncertainty Magnitude:** For small $t/R$, this is approximated as $\\delta\\alpha \\approx t/R$.\n- **Angular Error Model:** The error is a random perturbation $\\varepsilon$, uniformly distributed on $[-\\delta\\alpha, \\delta\\alpha]$, with a mean of zero.\n- **Source Location:** An annihilation event is located at a radial offset $\\rho$ along the $x$-axis, i.e., at coordinates $(\\rho, 0)$.\n- **Radon Transform:** The projection of a point $(x,y)$ at angle $\\alpha$ is $s(\\alpha) = x \\cos\\alpha + y \\sin\\alpha$.\n- **Backprojection Model:** The measured projection $s(\\alpha)$ corresponding to the true angle $\\alpha$ is backprojected along a line with a perturbed angle $\\alpha+\\varepsilon$. The equation of the backprojected line is $x \\cos(\\alpha+\\varepsilon) + y \\sin(\\alpha+\\varepsilon) = s(\\alpha)$.\n- **Analysis Requirement:** Work in the small-angle regime to second order in $\\varepsilon$.\n- **Averaging:** Take the ensemble mean over the uniform distribution of $\\varepsilon$.\n- **Objective:** Derive the expected radial position bias $b(\\rho)$, defined as the difference between the ensemble-mean reconstructed radial coordinate along the $x$-axis and the true radial offset $\\rho$. The final expression should be a function of $\\rho$, $t$, and $R$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the principles of tomographic reconstruction in medical imaging. The concept of Depth of Interaction (DOI) uncertainty and its effect on spatial resolution (parallax error) is a standard topic in PET system design. The Radon transform and backprojection are foundational to the field. The model formulation, while simplified, is physically motivated.\n- **Well-Posed:** The problem is well-defined. It provides all necessary information: the source location, the error model, the backprojection equation, and a clear definition of the quantity to be derived. A unique solution is expected.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased scientific language.\n\nThe problem does not exhibit any of the flaws listed in the problem validation checklist. It is scientifically sound, formalizable, complete, and poses a non-trivial physics and mathematics-based question.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the derivation of the solution.\n\n### Derivation\nThe problem asks for the expected radial position bias for a point source at $(\\rho, 0)$ due to angular uncertainty in backprojection.\n\n1.  **Formulate the Backprojection Equation:**\n    An annihilation event occurs at $(x_0, y_0) = (\\rho, 0)$. The true projection data (line integral) at an angle $\\alpha$ is given by the Radon transform:\n    $$s(\\alpha) = x_0 \\cos\\alpha + y_0 \\sin\\alpha = \\rho \\cos\\alpha$$\n    The problem states that this measurement $s(\\alpha)$ is backprojected along a line with a perturbed angle $\\alpha' = \\alpha + \\varepsilon$. The equation for this backprojected line is:\n    $$x \\cos(\\alpha + \\varepsilon) + y \\sin(\\alpha + \\varepsilon) = \\rho \\cos\\alpha$$\n\n2.  **Identify the Virtual Source:**\n    We can analyze the effect of the error by reinterpreting the equation of the backprojected line. The goal is to express the right-hand side in terms of the perturbed angle $\\alpha' = \\alpha+\\varepsilon$. We substitute $\\alpha = \\alpha' - \\varepsilon$ into the right-hand side:\n    $$\\rho \\cos\\alpha = \\rho \\cos(\\alpha' - \\varepsilon) = \\rho (\\cos\\alpha' \\cos\\varepsilon + \\sin\\alpha' \\sin\\varepsilon)$$\n    The backprojection equation can now be written entirely in terms of the perturbed angle $\\alpha'$:\n    $$x \\cos\\alpha' + y \\sin\\alpha' = (\\rho \\cos\\varepsilon) \\cos\\alpha' + (\\rho \\sin\\varepsilon) \\sin\\alpha'$$\n    This equation is precisely the Radon transform of a \"virtual source\" point with coordinates $(x_s, y_s) = (\\rho \\cos\\varepsilon, \\rho \\sin\\varepsilon)$, projected at the angle $\\alpha'$. For each LOR, the angular error $\\varepsilon$ displaces the apparent origin of the event from the true point $(\\rho, 0)$ to this virtual source point $(\\rho \\cos\\varepsilon, \\rho \\sin\\varepsilon)$. The reconstruction process, which integrates or averages over all angles, will thus yield an image of the *average* position of this virtual source.\n\n3.  **Compute the Ensemble Mean of the Virtual Source Position:**\n    The reconstructed position is the expectation of the virtual source position $(x_s, y_s)$ over the distribution of the random error $\\varepsilon$. Let $\\langle x_{\\text{recon}} \\rangle$ and $\\langle y_{\\text{recon}} \\rangle$ be the coordinates of the mean reconstructed position.\n    $$\\langle x_{\\text{recon}} \\rangle = \\langle x_s \\rangle = \\langle \\rho \\cos\\varepsilon \\rangle = \\rho \\langle \\cos\\varepsilon \\rangle$$\n    $$\\langle y_{\\text{recon}} \\rangle = \\langle y_s \\rangle = \\langle \\rho \\sin\\varepsilon \\rangle = \\rho \\langle \\sin\\varepsilon \\rangle$$\n    The error $\\varepsilon$ is uniformly distributed on $[-\\delta\\alpha, \\delta\\alpha]$. This is a symmetric distribution about $0$. The function $\\sin\\varepsilon$ is an odd function, so its expectation over a symmetric interval is zero:\n    $$\\langle \\sin\\varepsilon \\rangle = \\frac{1}{2\\delta\\alpha} \\int_{-\\delta\\alpha}^{\\delta\\alpha} \\sin\\varepsilon \\, d\\varepsilon = 0$$\n    Therefore, $\\langle y_{\\text{recon}} \\rangle = 0$. The bias is purely radial along the $x$-axis, as expected by symmetry.\n\n    To find $\\langle x_{\\text{recon}} \\rangle$, we need to compute $\\langle \\cos\\varepsilon \\rangle$. The problem specifies working to second order in $\\varepsilon$. We use the Taylor expansion for cosine: $\\cos\\varepsilon \\approx 1 - \\frac{\\varepsilon^2}{2}$.\n    Taking the expectation:\n    $$\\langle \\cos\\varepsilon \\rangle \\approx \\left\\langle 1 - \\frac{\\varepsilon^2}{2} \\right\\rangle = 1 - \\frac{1}{2} \\langle \\varepsilon^2 \\rangle$$\n    We need to find $\\langle \\varepsilon^2 \\rangle$, which is the second moment of the uniform distribution. For a random variable $X$ uniformly distributed on $[a, b]$, the variance is $\\text{Var}(X) = \\frac{(b-a)^2}{12}$ and the mean is $\\text{E}[X] = \\frac{a+b}{2}$. The second moment is $\\langle X^2 \\rangle = \\text{Var}(X) + (\\text{E}[X])^2$.\n    For $\\varepsilon \\sim U[-\\delta\\alpha, \\delta\\alpha]$, we have $a = -\\delta\\alpha$ and $b = \\delta\\alpha$.\n    The mean is $\\langle \\varepsilon \\rangle = \\frac{-\\delta\\alpha + \\delta\\alpha}{2} = 0$.\n    The variance is $\\text{Var}(\\varepsilon) = \\frac{(\\delta\\alpha - (-\\delta\\alpha))^2}{12} = \\frac{(2\\delta\\alpha)^2}{12} = \\frac{4(\\delta\\alpha)^2}{12} = \\frac{(\\delta\\alpha)^2}{3}$.\n    The second moment is $\\langle \\varepsilon^2 \\rangle = \\text{Var}(\\varepsilon) + \\langle \\varepsilon \\rangle^2 = \\frac{(\\delta\\alpha)^2}{3} + 0^2 = \\frac{(\\delta\\alpha)^2}{3}$.\n\n    Substituting this into the expression for $\\langle \\cos\\varepsilon \\rangle$:\n    $$\\langle \\cos\\varepsilon \\rangle \\approx 1 - \\frac{1}{2} \\left( \\frac{(\\delta\\alpha)^2}{3} \\right) = 1 - \\frac{(\\delta\\alpha)^2}{6}$$\n    Now we can find the ensemble-mean reconstructed radial coordinate:\n    $$\\langle x_{\\text{recon}} \\rangle = \\rho \\langle \\cos\\varepsilon \\rangle = \\rho \\left(1 - \\frac{(\\delta\\alpha)^2}{6}\\right)$$\n\n4.  **Calculate the Radial Bias:**\n    The radial position bias $b(\\rho)$ is defined as the difference between the mean reconstructed radial coordinate and the true coordinate:\n    $$b(\\rho) = \\langle x_{\\text{recon}} \\rangle - \\rho$$\n    $$b(\\rho) = \\rho \\left(1 - \\frac{(\\delta\\alpha)^2}{6}\\right) - \\rho = \\rho - \\rho\\frac{(\\delta\\alpha)^2}{6} - \\rho = -\\rho\\frac{(\\delta\\alpha)^2}{6}$$\n\n5.  **Express in Terms of System Parameters:**\n    The problem provides the approximation for the angular uncertainty: $\\delta\\alpha \\approx t/R$. Substituting this into the expression for the bias, we obtain the final result to second order in $t/R$:\n    $$b(\\rho) = -\\rho\\frac{(t/R)^2}{6} = -\\frac{\\rho t^2}{6R^2}$$\n    The negative sign indicates that the reconstructed point is biased towards the center of the gantry. The bias is zero at the center ($\\rho=0$) and increases in magnitude linearly with the radial offset $\\rho$. It is also proportional to the square of the ratio of crystal thickness to gantry radius, $(t/R)^2$, which quantifies the severity of the parallax error.", "answer": "$$\n\\boxed{-\\frac{\\rho t^2}{6R^2}}\n$$", "id": "4907415"}, {"introduction": "Time-of-Flight (TOF) technology represents a significant advancement in PET imaging, enhancing image quality by providing more precise localization of annihilation events along the LOR. This is achieved by measuring the minute difference in the arrival times of the two photons. This exercise demonstrates the direct quantitative benefit of TOF by guiding you through the conversion of a scanner's timing resolution, measured in picoseconds, into a corresponding improvement in spatial certainty, measured in millimeters [@problem_id:4907332].", "problem": "A time-of-flight Positron Emission Tomography (PET) system measures the difference in arrival times of the two $511 \\text{ keV}$ annihilation photons at opposite detectors along a single line of response (LOR). Assume the coincidence timing uncertainty can be modeled as a Gaussian random variable with full width at half maximum (FWHM) in time equal to $FWHM_t = 300\\ \\text{ps}$. Use the following foundational facts: (i) both annihilation photons propagate at the speed of light $c$, and (ii) the difference in arrival times between the two detectors is determined solely by the difference in path lengths traveled along the LOR. The Full Width at Half Maximum (FWHM) and the standard deviation $\\sigma$ of a Gaussian are related, but do not assume any specific conversion until you derive it.\n\nStarting from these principles, derive the mapping from timing uncertainty to spatial uncertainty along the LOR. Then compute:\n- the spatial full width at half maximum along the LOR, $FWHM_x$, in millimeters, and\n- the corresponding spatial standard deviation, $\\sigma_x$, in millimeters,\n\nfor the given $FWHM_t$. Use $c = 2.99792458 \\times 10^8\\ \\text{m/s}$. Round both $FWHM_x$ and $\\sigma_x$ to $4$ significant figures. Express both results in millimeters. Provide the final numerical values only (without units) in the answer.", "solution": "The problem is valid as it is scientifically grounded in the principles of Positron Emission Tomography (PET), is well-posed with all necessary information, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe core principle of time-of-flight (TOF) PET is to use the difference in arrival times of the two annihilation photons to better estimate the position of the annihilation event along the line of response (LOR). Let the LOR be a one-dimensional coordinate axis. Let the midpoint between the two detectors be the origin, $x=0$. An annihilation event occurs at an unknown position $x$ along this axis.\n\nWhen the event occurs at $x$, one photon travels a distance $d_1$ to the first detector, and the other photon travels a distance $d_2$ to the second detector. The position $x$ represents the displacement from the center of the LOR. This displacement means one photon's path is shortened by a length $|x|$ and the other's is lengthened by the same amount, relative to an event at the center. Therefore, the difference in the path lengths traveled by the two photons is $\\Delta l = 2|x|$. For simplicity, we define the sign of $x$ such that the path difference is $\\Delta l = 2x$.\n\nThe two photons are created simultaneously and travel at the speed of light, $c$. The difference in their arrival times at the detectors, $\\Delta t$, is directly proportional to the path length difference:\n$$ \\Delta t = \\frac{\\Delta l}{c} $$\nSubstituting the expression for $\\Delta l$, we get:\n$$ \\Delta t = \\frac{2x}{c} $$\nThis equation can be rearranged to find the position of the event, $x$, based on the measured time difference, $\\Delta t$:\n$$ x = \\frac{c}{2} \\Delta t $$\nThis equation represents the mapping from the measured timing difference to the event's spatial position along the LOR.\n\nThe problem states that the measurement of $\\Delta t$ is subject to a timing uncertainty, which is modeled as a Gaussian random variable with a full width at half maximum (FWHM) of $FWHM_t$. Since the relationship between $x$ and $\\Delta t$ is linear, the resulting uncertainty in the position, $x$, will also follow a Gaussian distribution. The uncertainty in position, characterized by its FWHM, $FWHM_x$, is related to the timing uncertainty $FWHM_t$ by the same linear factor:\n$$ FWHM_x = \\frac{c}{2} FWHM_t $$\nThis is the derived mapping from timing uncertainty to spatial uncertainty along the LOR.\n\nNext, we must derive the relationship between the FWHM and the standard deviation, $\\sigma$, for a Gaussian distribution. A Gaussian probability density function is given by:\n$$ f(y) = A \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right) $$\nwhere $\\mu$ is the mean, $\\sigma$ is the standard deviation, and $A$ is a normalization constant. The maximum value of the function is $f(\\mu) = A$. The FWHM is the width of the distribution at half of its maximum value, i.e., at a height of $A/2$. We find the points $y$ where $f(y) = A/2$:\n$$ \\frac{A}{2} = A \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right) $$\n$$ \\frac{1}{2} = \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right) $$\nTaking the natural logarithm of both sides:\n$$ \\ln\\left(\\frac{1}{2}\\right) = -\\frac{(y-\\mu)^2}{2\\sigma^2} $$\n$$ -\\ln(2) = -\\frac{(y-\\mu)^2}{2\\sigma^2} $$\n$$ (y-\\mu)^2 = 2\\sigma^2\\ln(2) $$\n$$ |y-\\mu| = \\sigma\\sqrt{2\\ln(2)} $$\nThe two points are $y_1 = \\mu - \\sigma\\sqrt{2\\ln(2)}$ and $y_2 = \\mu + \\sigma\\sqrt{2\\ln(2)}$. The FWHM is the distance between these points:\n$$ FWHM = y_2 - y_1 = (\\mu + \\sigma\\sqrt{2\\ln(2)}) - (\\mu - \\sigma\\sqrt{2\\ln(2)}) = 2\\sigma\\sqrt{2\\ln(2)} $$\nThis relationship, $FWHM = \\sigma \\cdot 2\\sqrt{2\\ln(2)}$, holds for any Gaussian distribution, including both the timing and spatial uncertainties.\n\nWe can now compute the required values. The given data are:\nTiming FWHM: $FWHM_t = 300\\ \\text{ps} = 300 \\times 10^{-12}\\ \\text{s} = 3 \\times 10^{-10}\\ \\text{s}$.\nSpeed of light: $c = 2.99792458 \\times 10^8\\ \\text{m/s}$.\n\nFirst, we compute the spatial FWHM, $FWHM_x$:\n$$ FWHM_x = \\frac{c}{2} FWHM_t = \\frac{2.99792458 \\times 10^8\\ \\text{m/s}}{2} \\times (3 \\times 10^{-10}\\ \\text{s}) $$\n$$ FWHM_x = (1.49896229 \\times 10^8\\ \\text{m/s}) \\times (3 \\times 10^{-10}\\ \\text{s}) = 0.0449688687\\ \\text{m} $$\nTo express the result in millimeters, we multiply by $1000$:\n$$ FWHM_x = 0.0449688687\\ \\text{m} \\times 1000\\ \\text{mm/m} = 44.9688687\\ \\text{mm} $$\nRounding to $4$ significant figures, we get:\n$$ FWHM_x \\approx 44.97\\ \\text{mm} $$\n\nNext, we compute the corresponding spatial standard deviation, $\\sigma_x$, using the derived relationship:\n$$ \\sigma_x = \\frac{FWHM_x}{2\\sqrt{2\\ln(2)}} $$\nUsing the unrounded value of $FWHM_x$ for precision:\n$$ \\sigma_x = \\frac{44.9688687\\ \\text{mm}}{2\\sqrt{2\\ln(2)}} \\approx \\frac{44.9688687\\ \\text{mm}}{2.354820045} \\approx 19.096530\\ \\text{mm} $$\nRounding to $4$ significant figures, we get:\n$$ \\sigma_x \\approx 19.10\\ \\text{mm} $$", "answer": "$$\\boxed{\\begin{pmatrix} 44.97  19.10 \\end{pmatrix}}$$", "id": "4907332"}]}