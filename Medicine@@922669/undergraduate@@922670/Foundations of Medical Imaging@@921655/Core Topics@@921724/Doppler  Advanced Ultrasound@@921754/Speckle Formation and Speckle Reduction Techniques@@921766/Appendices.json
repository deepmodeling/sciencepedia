{"hands_on_practices": [{"introduction": "To truly understand speckle, we must first quantify its statistical properties from the ground up. This foundational exercise guides you through the derivation of speckle contrast, a key metric for noise level, starting from the physical model of wave interference. By completing this practice [@problem_id:4926689], you will derive the classic result that fully developed speckle has a contrast of unity, a cornerstone of coherent imaging theory.", "problem": "In coherent medical ultrasound imaging under fully developed speckle and single-look conditions, the detected baseband complex field at a pixel can be modeled as the superposition of many sub-resolution scatterers with random phases. By the central limit theorem, the in-phase and quadrature components of the complex field may be modeled as independent, identically distributed Gaussian random variables with zero mean and equal variance. Let the complex field be $U = X + \\mathrm{j} Y$, where $X \\sim \\mathcal{N}(0,\\sigma^{2})$, $Y \\sim \\mathcal{N}(0,\\sigma^{2})$, and $X$ and $Y$ are independent. The envelope amplitude is $A = \\sqrt{X^{2} + Y^{2}}$, and the intensity is $I = A^{2}$. Define the speckle contrast for intensity as $C = \\sigma_{I}/\\mu_{I}$, where $\\mu_{I} = \\mathbb{E}[I]$ and $\\sigma_{I} = \\sqrt{\\mathrm{Var}(I)}$, and define the amplitude contrast as $C_{A} = \\sigma_{A}/\\mu_{A}$ with $\\mu_{A} = \\mathbb{E}[A]$ and $\\sigma_{A} = \\sqrt{\\mathrm{Var}(A)}$. Starting from the stated Gaussian model and using only probability conservation and change of variables in transformations of random variables, derive closed-form expressions for $C$ and $C_{A}$ under single-look ($L = 1$) conditions. Express your final answer as a pair $\\left(C, C_{A}\\right)$ in exact analytic form. Do not approximate or round.", "solution": "The problem asks for the derivation of the speckle contrast for intensity ($C = \\sigma_I/\\mu_I$) and amplitude ($C_A = \\sigma_A/\\mu_A$) for a single-look coherent imaging system. We are given that the complex field is $U = X + \\mathrm{j}Y$, where $X$ and $Y$ are independent, zero-mean Gaussian random variables with equal variance $\\sigma^2$: $X, Y \\sim \\mathcal{N}(0, \\sigma^2)$.\n\n**1. Probability Density Function (PDF) of Amplitude**\n\nThe joint PDF of $X$ and $Y$ is:\n$$ p_{X,Y}(x,y) = p_X(x) p_Y(y) = \\frac{1}{2\\pi\\sigma^2}\\exp\\left(-\\frac{x^2+y^2}{2\\sigma^2}\\right) $$\nTo find the PDF of the amplitude $A = \\sqrt{X^2 + Y^2}$, we convert to polar coordinates $(a, \\theta)$, where $x=a\\cos\\theta$ and $y=a\\sin\\theta$. The amplitude is represented by $a$. The Jacobian of this transformation is $|J| = a$. The joint PDF of amplitude and phase is:\n$$ p_{A,\\Theta}(a,\\theta) = p_{X,Y}(a\\cos\\theta, a\\sin\\theta) |J| = \\frac{a}{2\\pi\\sigma^2}\\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) $$\nTo find the marginal PDF of the amplitude $A$, we integrate over all phases $\\theta \\in [0, 2\\pi)$:\n$$ p_A(a) = \\int_0^{2\\pi} \\frac{a}{2\\pi\\sigma^2}\\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) d\\theta = \\frac{a}{\\sigma^2}\\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) $$\nThis is the **Rayleigh distribution** for $a \\ge 0$.\n\n**2. Moments and Contrast of Amplitude ($C_A$)**\n\nWe need to calculate the mean $\\mu_A = \\mathbb{E}[A]$ and the variance $\\sigma_A^2 = \\mathbb{E}[A^2] - (\\mathbb{E}[A])^2$.\nThe general formula for the $k$-th moment of a Rayleigh-distributed variable is $\\mathbb{E}[A^k] = (2\\sigma^2)^{k/2} \\Gamma\\left(\\frac{k}{2}+1\\right)$, where $\\Gamma$ is the Gamma function.\n\n- **Mean Amplitude ($\\mu_A$):** For $k=1$:\n    $$ \\mu_A = \\mathbb{E}[A] = (2\\sigma^2)^{1/2} \\Gamma\\left(\\frac{1}{2}+1\\right) = \\sigma\\sqrt{2} \\Gamma\\left(\\frac{3}{2}\\right) = \\sigma\\sqrt{2} \\left(\\frac{1}{2}\\Gamma\\left(\\frac{1}{2}\\right)\\right) = \\sigma\\sqrt{2} \\frac{\\sqrt{\\pi}}{2} = \\sigma\\sqrt{\\frac{\\pi}{2}} $$\n- **Mean-Square Amplitude ($\\mathbb{E}[A^2]$):** For $k=2$:\n    $$ \\mathbb{E}[A^2] = (2\\sigma^2)^{2/2} \\Gamma\\left(\\frac{2}{2}+1\\right) = 2\\sigma^2 \\Gamma(2) = 2\\sigma^2 (1!) = 2\\sigma^2 $$\n- **Variance of Amplitude ($\\sigma_A^2$):**\n    $$ \\sigma_A^2 = \\mathbb{E}[A^2] - (\\mu_A)^2 = 2\\sigma^2 - \\left(\\sigma\\sqrt{\\frac{\\pi}{2}}\\right)^2 = 2\\sigma^2 - \\sigma^2 \\frac{\\pi}{2} = \\sigma^2\\left(2-\\frac{\\pi}{2}\\right) $$\n- **Amplitude Contrast ($C_A$):**\n    $$ C_A = \\frac{\\sigma_A}{\\mu_A} = \\frac{\\sqrt{\\sigma^2(2-\\pi/2)}}{\\sigma\\sqrt{\\pi/2}} = \\sqrt{\\frac{2-\\pi/2}{\\pi/2}} = \\sqrt{\\frac{4-\\pi}{\\pi}} $$\n\n**3. Moments and Contrast of Intensity ($C$)**\n\nThe intensity is $I=A^2$. We need to calculate its mean $\\mu_I = \\mathbb{E}[I]$ and variance $\\sigma_I^2 = \\mathbb{E}[I^2] - (\\mu_I)^2$.\n\n- **Mean Intensity ($\\mu_I$):**\n    $$ \\mu_I = \\mathbb{E}[I] = \\mathbb{E}[A^2] = 2\\sigma^2 $$\n- **Mean-Square Intensity ($\\mathbb{E}[I^2]$):** This is the fourth moment of the amplitude, $\\mathbb{E}[A^4]$. For $k=4$:\n    $$ \\mathbb{E}[I^2] = \\mathbb{E}[A^4] = (2\\sigma^2)^{4/2} \\Gamma\\left(\\frac{4}{2}+1\\right) = (2\\sigma^2)^2 \\Gamma(3) = 4\\sigma^4 (2!) = 8\\sigma^4 $$\n- **Variance of Intensity ($\\sigma_I^2$):**\n    $$ \\sigma_I^2 = \\mathbb{E}[I^2] - (\\mu_I)^2 = 8\\sigma^4 - (2\\sigma^2)^2 = 8\\sigma^4 - 4\\sigma^4 = 4\\sigma^4 $$\n- **Intensity Contrast ($C$):** The standard deviation is $\\sigma_I = \\sqrt{4\\sigma^4} = 2\\sigma^2$.\n    $$ C = \\frac{\\sigma_I}{\\mu_I} = \\frac{2\\sigma^2}{2\\sigma^2} = 1 $$\n\nThus, the intensity contrast is 1, and the amplitude contrast is $\\sqrt{(4-\\pi)/\\pi}$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 1 & \\sqrt{\\frac{4-\\pi}{\\pi}} \\end{pmatrix} } $$", "id": "4926689"}, {"introduction": "Now that we have characterized the statistical nature of speckle, the next question is how to reduce its impact on image quality. This practice [@problem_id:4926672] explores multi-look compounding, a fundamental speckle reduction technique used in virtually all modern ultrasound systems. You will mathematically prove how averaging multiple independent images reduces speckle contrast, revealing the celebrated $1/\\sqrt{L}$ scaling law.", "problem": "In coherent Medical Ultrasound (US) imaging, speckle arises from the random interference of echoes from many unresolved scatterers, yielding a stochastic image intensity. Consider a pixel whose single-look intensity, denoted by $I_{k}$ for look index $k$, is generated under fully developed speckle conditions and is modeled as an exponential random variable with mean $\\mu$, where $k = 1, 2, \\dots, L$. A multi-look compounding system forms the displayed pixel intensity by arithmetic averaging across $L$ looks, so that $I = \\frac{1}{L}\\sum_{k=1}^{L} I_{k}$. The speckle contrast is defined as $C = \\frac{\\sigma_{I}}{\\mu_{I}}$, where $\\mu_{I}$ is the mean of $I$ and $\\sigma_{I}$ is the standard deviation of $I$. Starting from fundamental definitions of expectation and variance, and using well-tested facts about fully developed speckle (exponential intensity statistics), derive a closed-form expression for $C$ in terms of $L$ when the $L$ looks are statistically independent and have equal mean. Clearly state the physical-statistical assumptions required for the derived scaling to hold. Express your final answer as a single analytic expression in terms of $L$. No rounding is required. The speckle contrast is dimensionless; do not report a unit.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is based on standard, validated models of speckle formation and reduction in medical ultrasound imaging. Therefore, the problem is deemed valid and a full solution is provided below.\n\nThe objective is to derive a closed-form expression for the speckle contrast, $C$, of a multi-look compounded image intensity, $I$. The speckle contrast is defined as:\n$$C = \\frac{\\sigma_{I}}{\\mu_{I}}$$\nwhere $\\mu_{I}$ is the mean of the compounded intensity $I$, and $\\sigma_{I}$ is its standard deviation.\n\nThe compounded intensity $I$ is formed by the arithmetic mean of $L$ independent single-look intensities, $I_k$:\n$$I = \\frac{1}{L}\\sum_{k=1}^{L} I_{k}$$\nEach single-look intensity $I_k$ is modeled as an exponential random variable with a mean $\\mu$. The problem states that the $L$ looks are statistically independent and have an equal mean.\n\nFirst, we will determine the mean of the compounded intensity, $\\mu_I$. By the definition of expectation:\n$$\\mu_I = E[I] = E\\left[\\frac{1}{L}\\sum_{k=1}^{L} I_{k}\\right]$$\nUsing the linearity of the expectation operator, we can write:\n$$\\mu_I = \\frac{1}{L} E\\left[\\sum_{k=1}^{L} I_{k}\\right] = \\frac{1}{L} \\sum_{k=1}^{L} E[I_{k}]$$\nWe are given that each look $I_k$ has the same mean, $E[I_k] = \\mu$. Substituting this into the equation:\n$$\\mu_I = \\frac{1}{L} \\sum_{k=1}^{L} \\mu = \\frac{1}{L} (L \\mu)$$\n$$\\mu_I = \\mu$$\nThis shows that the mean intensity of the compounded image is the same as the mean intensity of any single look.\n\nNext, we determine the standard deviation of the compounded intensity, $\\sigma_I$. We begin by calculating the variance, $\\sigma_I^2 = \\text{Var}(I)$.\n$$\\sigma_I^2 = \\text{Var}(I) = \\text{Var}\\left(\\frac{1}{L}\\sum_{k=1}^{L} I_{k}\\right)$$\nUsing the property of variance, $\\text{Var}(aX) = a^2 \\text{Var}(X)$, where $a$ is a constant:\n$$\\sigma_I^2 = \\left(\\frac{1}{L}\\right)^2 \\text{Var}\\left(\\sum_{k=1}^{L} I_{k}\\right) = \\frac{1}{L^2} \\text{Var}\\left(\\sum_{k=1}^{L} I_{k}\\right)$$\nA critical condition provided is that the $L$ looks, $I_k$, are statistically independent. For a sum of independent random variables, the variance of the sum is the sum of the variances:\n$$\\text{Var}\\left(\\sum_{k=1}^{L} I_{k}\\right) = \\sum_{k=1}^{L} \\text{Var}(I_k)$$\nSubstituting this into the expression for $\\sigma_I^2$:\n$$\\sigma_I^2 = \\frac{1}{L^2} \\sum_{k=1}^{L} \\text{Var}(I_k)$$\nWe must now find the variance of a single-look intensity, $\\text{Var}(I_k)$. The problem states that $I_k$ is an exponential random variable with mean $\\mu$. A well-known property of the exponential distribution is that its variance is equal to the square of its mean. Therefore:\n$$\\text{Var}(I_k) = \\mu^2$$\nSince all looks have the same mean $\\mu$, they all have the same variance $\\mu^2$. Substituting this into the equation for $\\sigma_I^2$:\n$$\\sigma_I^2 = \\frac{1}{L^2} \\sum_{k=1}^{L} \\mu^2 = \\frac{1}{L^2} (L \\mu^2)$$\n$$\\sigma_I^2 = \\frac{\\mu^2}{L}$$\nThe standard deviation $\\sigma_I$ is the square root of the variance. Since intensity and its mean $\\mu$ are non-negative physical quantities, we have:\n$$\\sigma_I = \\sqrt{\\frac{\\mu^2}{L}} = \\frac{\\mu}{\\sqrt{L}}$$\n\nFinally, we can compute the speckle contrast $C$:\n$$C = \\frac{\\sigma_{I}}{\\mu_{I}} = \\frac{\\frac{\\mu}{\\sqrt{L}}}{\\mu}$$\n$$C = \\frac{1}{\\sqrt{L}}$$\n\nThe physical-statistical assumptions required for this derivation to hold are:\n1.  **Fully Developed Speckle**: The signal is a result of coherent summation of echoes from a large number of randomly-phased, unresolved scatterers within each resolution cell. This is the fundamental condition that gives rise to the negative exponential probability distribution for the intensity.\n2.  **Exponential Intensity Statistics**: As a direct consequence of the fully developed speckle condition, the intensity of a single, un-averaged look, $I_k$, must follow a negative exponential distribution, for which the standard deviation is equal to the mean. For this model, the single-look speckle contrast is $C_1 = \\mu / \\mu = 1$.\n3.  **Statistical Independence of Looks**: The $L$ separate looks, $I_k$, must be statistically independent from one another. This ensures that their speckle patterns are uncorrelated, which is the mathematical basis for the variance of the sum being the sum of the variances. In practice, this is achieved by techniques such as spatial compounding (acquiring images from different angles) or frequency compounding (using different transducer frequency bands), where the separation between looks is sufficient to ensure decorrelation.\n4.  **Equal Mean Intensity Across Looks**: All $L$ looks are assumed to have the same underlying mean intensity $\\mu$. This implies that the underlying tissue reflectivity is constant across the regions from which the looks are gathered and that any systematic variations, such as system gain or attenuation, have been perfectly compensated for.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{L}}}$$", "id": "4926672"}, {"introduction": "Our theoretical models for speckle are powerful, but how do we verify if they apply to a real image? This problem [@problem_id:4926695] places you in the role of an imaging scientist, tasking you with designing a formal hypothesis test to determine if a region of an image exhibits fully developed speckle. This exercise bridges the gap between abstract theory and practical data analysis, teaching you how to use the statistical properties of speckle to make rigorous, evidence-based decisions.", "problem": "In a homogeneous region of an ultrasound image acquired under single-look coherent illumination, the backscattered complex field is modeled as the sum of many independent phasors with random phases. By the central limit behavior of such sums, the envelope amplitude is Rayleigh distributed, and the intensity $I$ is exponentially distributed with mean $\\mu$. Define the population speckle contrast as $C = \\sigma_I / \\mu$, where $\\sigma_I$ is the standard deviation of $I$. You wish to decide whether the region exhibits fully developed speckle by testing whether $C$ equals the Rayleigh expectation.\n\nYou collect $N=400$ independent pixel intensities $\\{I_i\\}_{i=1}^N$ from the region. Let the sample mean be $\\bar I = \\frac{1}{N}\\sum_{i=1}^N I_i$ and the sample second raw moment be $m_2 = \\frac{1}{N}\\sum_{i=1}^N I_i^2$. To obtain a scale-invariant estimate of contrast, use\n$$\n\\hat C = \\frac{\\sqrt{\\,m_2 - \\bar I^2\\,}}{\\bar I}.\n$$\nFor the observed data, $\\hat C = 0.92$. At significance level $\\alpha = 0.05$, formulate a hypothesis test for\n$$\nH_0: C = 1 \\quad \\text{versus} \\quad H_1: C < 1,\n$$\nand decide whether to reject $H_0$. Which option below correctly states a valid test based on first principles and the correct decision for the given numbers?\n\nA. Use the exponential model implied by Rayleigh amplitude: under $H_0$, $C=1$. By the multivariate Central Limit Theorem and the delta method applied to $(\\bar I, m_2)$, $\\hat C$ is approximately distributed as $\\mathcal{N}(1, 1/N)$ for large $N$. A level-$\\alpha$ left-tailed test rejects $H_0$ if $\\hat C < 1 + \\Phi^{-1}(\\alpha)/\\sqrt{N}$, where $\\Phi$ is the standard normal cumulative distribution function. With $N=400$ and $\\alpha=0.05$, the critical threshold is $1 - 1.6449/20 \\approx 0.9178$. Since $0.92 > 0.9178$, do not reject $H_0$. The $p\\text{-value}$ is $\\Phi\\!\\big( \\sqrt{N}(\\hat C - 1) \\big) = \\Phi(-1.6) \\approx 0.0548$.\n\nB. Use a two-sided normal test for $\\hat C$ with variance $1/N$ and reject $H_0$ if $|\\hat C - 1| > z_{0.975}/\\sqrt{N}$, where $z_{0.975} \\approx 1.96$. With $N=400$, the threshold is $1 \\pm 0.098$, and since $0.92 < 0.902$, reject $H_0$.\n\nC. Model the envelope amplitude as Rayleigh and test $H_0: C = \\sqrt{\\frac{\\pi}{2} - 1} \\approx 0.52$ for the observed $\\hat C = 0.92$. Since $0.92$ is much larger than $0.52$, reject $H_0$ at $\\alpha = 0.05$.\n\nD. Treat the sample variance as if intensities were Gaussian and use a chi-square test on $(N-1)s^2/\\mu^2$ with $(N-1)$ degrees of freedom (where $s^2$ uses the $(N-1)$ denominator). Reject $H_0$ at $\\alpha = 0.05$ because the observed $\\hat C = 0.92$ is below $1$.\n\nE. Estimate the effective number of looks by $\\hat L = \\hat C^{-2}$ and reject $H_0$ if $\\hat L > 1$. Since $\\hat C = 0.92$ gives $\\hat L \\approx 1.18 > 1$, reject $H_0$.", "solution": "### Step 1: Validate Problem Integrity\nThe problem presents a standard statistical hypothesis test scenario in the context of medical imaging physics.\n-   **Scientific Soundness**: The physical model (random phasors leading to Rayleigh amplitude/exponential intensity) and its consequence (intensity contrast $C=1$ for fully developed speckle) are correct and fundamental to the field.\n-   **Well-Posedness**: The problem clearly states the null and alternative hypotheses ($H_0: C=1$ vs. $H_1: C<1$), sample size ($N=400$), observed statistic basis ($\\hat C=0.92$), and significance level ($\\alpha=0.05$). This is a complete and solvable problem.\n-   **Objectivity**: The problem is stated in precise, quantitative terms.\n\nThe problem is valid and can be solved.\n\n### Step 2: Formulate the Hypothesis Test\n\nThe core task is to determine the sampling distribution of the estimator $\\hat C$ under the null hypothesis $H_0$.\n\nUnder $H_0$, the pixel intensities $I_i$ are independent and identically distributed (i.i.d.) samples from an exponential distribution with mean $\\mu$. The theoretical contrast $C$ is 1.\n\nThe estimator for the contrast is the sample coefficient of variation, $\\hat C$. For a large sample size ($N=400$ is large), we can invoke the Central Limit Theorem and the delta method to find the asymptotic distribution of $\\hat C$. A standard result in statistics for samples from an exponential distribution is that the sample coefficient of variation is asymptotically normal.\n\nSpecifically, under $H_0$, for large $N$:\n$$ \\sqrt{N}(\\hat C - 1) \\xrightarrow{d} \\mathcal{N}(0, 1) $$\nThis implies that the estimator $\\hat C$ is approximately normally distributed with a mean equal to the true contrast (1) and a variance of $1/N$:\n$$ \\hat C \\sim \\mathcal{N}\\left(1, \\frac{1}{N}\\right) $$\nWe can now construct the test.\n\n-   **Hypotheses**: $H_0: C=1$ (fully developed speckle) vs. $H_1: C<1$ (partially developed or smoothed speckle).\n-   **Test Statistic**: We can use a standardized Z-score: $Z = \\frac{\\hat C - 1}{1/\\sqrt{N}} = \\sqrt{N}(\\hat C - 1)$. Under $H_0$, $Z \\sim \\mathcal{N}(0, 1)$.\n-   **Significance Level**: $\\alpha = 0.05$.\n-   **Test Type**: This is a left-tailed test because the alternative is $H_1: C<1$. We reject $H_0$ if the observed statistic is significantly smaller than expected.\n-   **Critical Value**: The critical value for a standard normal distribution for a left-tailed test at $\\alpha=0.05$ is $z_{0.05} = \\Phi^{-1}(0.05) \\approx -1.6449$.\n-   **Rejection Rule**: Reject $H_0$ if the observed test statistic $Z_{obs} < -1.6449$.\n\n### Step 3: Apply Data and Make a Decision\n\nWe are given:\n-   $N=400$, so $\\sqrt{N}=20$.\n-   Observed estimator value: $\\hat C = 0.92$.\n\nCalculate the observed test statistic:\n$$ Z_{obs} = \\sqrt{400}(0.92 - 1) = 20(-0.08) = -1.60 $$\n\n**Decision**:\nWe compare the observed statistic to the critical value.\n$Z_{obs} = -1.60$ is not less than the critical value $-1.6449$.\nSince $-1.60 > -1.6449$, the result does not fall in the rejection region. Therefore, we **do not reject** the null hypothesis $H_0$.\n\n**P-value Calculation**:\nThe p-value is the probability of observing a test statistic as extreme or more extreme than the one observed, assuming $H_0$ is true.\n$$ p\\text{-value} = P(Z \\le Z_{obs}) = P(Z \\le -1.60) = \\Phi(-1.60) \\approx 0.0548 $$\nSince the p-value ($0.0548$) is greater than the significance level $\\alpha$ ($0.05$), we do not reject $H_0$. The data do not provide sufficient evidence to conclude that the speckle contrast is less than 1.\n\n### Step 4: Evaluate the Options\n\n**A.** This option correctly identifies the statistical model, the asymptotic distribution $\\mathcal{N}(1, 1/N)$ for $\\hat C$, and the correct left-tailed test formulation. It correctly calculates the critical threshold for $\\hat C$ as $1 - 1.6449/20 \\approx 0.9178$. It correctly compares the observation $\\hat C=0.92$ to this threshold ($0.92 > 0.9178$) and makes the correct decision not to reject $H_0$. The p-value calculation is also correct. **This option is correct.**\n\n**B.** This option incorrectly proposes a two-sided test, which does not match the physical alternative hypothesis. It also contains a numerical error, stating \"$0.92  0.902$,\" which is false. **This option is incorrect.**\n\n**C.** This option confuses the contrast of *intensity* (which is being tested) with the contrast of *amplitude*. The value $C \\approx 0.52$ is the theoretical contrast for the amplitude, not the intensity. The test is therefore set up with the wrong null hypothesis. **This option is incorrect.**\n\n**D.** This option incorrectly applies a chi-square test, which is appropriate for testing the variance of Gaussian-distributed data. The problem explicitly states the data are exponentially distributed under the null hypothesis. The rejection rule is also statistically invalid. **This option is incorrect.**\n\n**E.** This option correctly identifies the physical relationship $\\hat L = \\hat C^{-2}$ but uses flawed statistical reasoning. It rejects $H_0$ simply because the point estimate $\\hat L \\approx 1.18$ is not exactly 1. This fails to account for sampling variability and is not a valid hypothesis test. **This option is incorrect.**", "answer": "$$\\boxed{A}$$", "id": "4926695"}]}