{"hands_on_practices": [{"introduction": "Motion during an MRI scan is not a monolithic problem; its effect depends critically on *when* it occurs. This first practice focuses on movement during the phase-encoding step, the process that spatially localizes the signal in one direction. By deriving the relationship between velocity and phase error, you will calculate a practical tolerance for motion, directly connecting a physical speed to an acceptable level of image quality. [@problem_id:4901226]", "problem": "A patient undergoing Magnetic Resonance Imaging (MRI) has mild involuntary head motion along the phase-encoding axis during the application of the phase-encoding gradient. Consider a single phase-encoding line acquired with a rectangular phase-encoding gradient lobe of constant amplitude and duration. Assume the spin ensemble experiences a constant velocity $v$ along the phase-encoding direction only during the phase-encoding lobe, and neglect acceleration and any motion outside the lobe.\n\nStarting from the fundamental relation that the instantaneous angular frequency shift produced by a magnetic field gradient is $\\omega(t)=\\gamma\\,G(t)\\,x(t)$, where $\\gamma$ is the gyromagnetic ratio, $G(t)$ is the gradient waveform, and $x(t)$ is the position along the gradient direction, derive the motion-induced phase accrued during the lobe and thereby obtain the velocity at which the phase per line reaches a specified tolerance. Model the position as $x(t)=x_{0}+v\\,t$ over the lobe and take the phase-encoding gradient to be a rectangular lobe of amplitude $G_{pe}$ applied over $0\\le t\\le t_{pe}$.\n\nImpose the requirement that the velocity-induced phase accrued during the lobe remains strictly below $\\pi/4$ radians and compute the maximum allowable velocity $v_{\\max}$ for the following parameters: $G_{pe}=20$ mT/m, $t_{pe}=2$ ms, and $\\gamma=2\\pi\\cdot 42.58$ MHz/T. Express your final answer in meters per second. Round your answer to three significant figures.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It is a valid problem in the foundations of medical imaging, specifically concerning motion artifacts in Magnetic Resonance Imaging (MRI). We may therefore proceed with a formal solution.\n\nThe fundamental principle governing the phase accrual of a spin in the presence of a magnetic field gradient is that the gradient superimposes a spatially dependent shift on the Larmor frequency. The instantaneous angular frequency shift, $\\omega(t)$, for a spin at position $x(t)$ along a one-dimensional gradient $G(t)$ is given as:\n$$ \\omega(t) = \\gamma \\, G(t) \\, x(t) $$\nHere, $\\gamma$ is the gyromagnetic ratio.\n\nThe problem specifies the following models:\n1.  The position of the moving spin ensemble along the phase-encoding axis is $x(t) = x_0 + v \\, t$, where $x_0$ is the initial position at $t=0$ and $v$ is the constant velocity.\n2.  The phase-encoding gradient is a rectangular lobe of constant amplitude $G_{pe}$ applied for a duration $t_{pe}$. Thus, for the interval $0 \\le t \\le t_{pe}$, the gradient is $G(t) = G_{pe}$.\n\nSubstituting these models into the frequency shift equation, we get the instantaneous angular frequency during the application of the gradient lobe:\n$$ \\omega(t) = \\gamma \\, G_{pe} \\, (x_0 + v \\, t) \\quad \\text{for } 0 \\le t \\le t_{pe} $$\n\nThe total phase, $\\phi$, accrued by the spins during this interval is the time integral of the angular frequency:\n$$ \\phi = \\int_{0}^{t_{pe}} \\omega(t) \\, dt $$\nSubstituting the expression for $\\omega(t)$:\n$$ \\phi = \\int_{0}^{t_{pe}} \\gamma \\, G_{pe} \\, (x_0 + v \\, t) \\, dt $$\nSince $\\gamma$, $G_{pe}$, $x_0$, and $v$ are constants with respect to the integration variable $t$, we can perform the integration:\n$$ \\phi = \\gamma \\, G_{pe} \\int_{0}^{t_{pe}} (x_0 + v \\, t) \\, dt $$\n$$ \\phi = \\gamma \\, G_{pe} \\left[ x_0 t + \\frac{1}{2} v t^2 \\right]_{0}^{t_{pe}} $$\n$$ \\phi = \\gamma \\, G_{pe} \\left( (x_0 t_{pe} + \\frac{1}{2} v t_{pe}^2) - (0) \\right) $$\n$$ \\phi = \\gamma \\, G_{pe} \\, x_0 \\, t_{pe} + \\frac{1}{2} \\gamma \\, G_{pe} \\, v \\, t_{pe}^2 $$\n\nThis total phase consists of two distinct components:\n1.  $\\phi_{\\text{static}} = \\gamma \\, G_{pe} \\, x_0 \\, t_{pe}$: This is the intended phase encoding for a stationary spin at position $x_0$. It is proportional to the area of the gradient lobe, $G_{pe} t_{pe}$, which defines the position in k-space being sampled.\n2.  $\\phi_{\\text{motion}} = \\frac{1}{2} \\gamma \\, G_{pe} \\, v \\, t_{pe}^2$: This is the additional, unwanted phase shift resulting from the motion of the spin during the application of the gradient. This term is a motion artifact.\n\nThe problem requires that the magnitude of this velocity-induced phase error remains strictly below a tolerance of $\\frac{\\pi}{4}$ radians:\n$$ |\\phi_{\\text{motion}}| < \\frac{\\pi}{4} $$\nSubstituting the expression for $\\phi_{\\text{motion}}$:\n$$ \\left| \\frac{1}{2} \\gamma \\, G_{pe} \\, v \\, t_{pe}^2 \\right| < \\frac{\\pi}{4} $$\n\nTo find the maximum allowable velocity, $v_{\\max}$, we set the magnitude of the phase error to its limit:\n$$ \\left| \\frac{1}{2} \\gamma \\, G_{pe} \\, v_{\\max} \\, t_{pe}^2 \\right| = \\frac{\\pi}{4} $$\nSolving for $v_{\\max}$ (assuming $v_{\\max} > 0$ and all other parameters are positive):\n$$ \\frac{1}{2} \\gamma \\, G_{pe} \\, v_{\\max} \\, t_{pe}^2 = \\frac{\\pi}{4} $$\n$$ v_{\\max} = \\frac{\\pi / 4}{\\frac{1}{2} \\gamma \\, G_{pe} \\, t_{pe}^2} $$\n$$ v_{\\max} = \\frac{\\pi}{2 \\, \\gamma \\, G_{pe} \\, t_{pe}^2} $$\n\nNow, we substitute the given numerical values into this expression. The parameters are:\n-   $G_{pe} = 20 \\text{ mT/m} = 20 \\times 10^{-3} \\text{ T/m}$\n-   $t_{pe} = 2 \\text{ ms} = 2 \\times 10^{-3} \\text{ s}$\n-   $\\gamma = 2\\pi \\cdot 42.58 \\text{ MHz/T} = 2\\pi \\cdot 42.58 \\times 10^6 \\text{ rad s}^{-1} \\text{T}^{-1}$\n\nSubstituting these values:\n$$ v_{\\max} = \\frac{\\pi}{2 \\cdot (2\\pi \\cdot 42.58 \\times 10^6 \\, \\text{rad s}^{-1} \\text{T}^{-1}) \\cdot (20 \\times 10^{-3} \\, \\text{T m}^{-1}) \\cdot (2 \\times 10^{-3} \\, \\text{s})^2} $$\nThe factor of $\\pi$ in the numerator cancels with the $\\pi$ in the gyromagnetic ratio:\n$$ v_{\\max} = \\frac{1}{2 \\cdot (2 \\cdot 42.58 \\times 10^6) \\cdot (20 \\times 10^{-3}) \\cdot (4 \\times 10^{-6})} \\, \\text{m/s} $$\n$$ v_{\\max} = \\frac{1}{4 \\cdot 42.58 \\cdot 20 \\cdot 4 \\cdot (10^6 \\cdot 10^{-3} \\cdot 10^{-6})} \\, \\text{m/s} $$\n$$ v_{\\max} = \\frac{1}{13625.6 \\cdot 10^{-3}} \\, \\text{m/s} $$\n$$ v_{\\max} = \\frac{1}{13.6256} \\, \\text{m/s} $$\n$$ v_{\\max} \\approx 0.0733924 \\, \\text{m/s} $$\n\nThe problem requires rounding the final answer to three significant figures.\n$$ v_{\\max} \\approx 0.0734 \\, \\text{m/s} $$", "answer": "$$\\boxed{0.0734}$$", "id": "4901226"}, {"introduction": "In contrast to motion during phase encoding, movement during the data acquisition or \"readout\" window produces a different kind of image artifact. This exercise explores how constant velocity during the application of the frequency-encoding gradient causes the signal's frequency to shift, leading to blurring and smearing in the final image. You will quantify this smearing from first principles, providing insight into how sequence parameters like readout duration affect image sharpness in the presence of flow. [@problem_id:4901264]", "problem": "A two-dimensional gradient-echo Magnetic Resonance Imaging (MRI) acquisition uses a frequency-encoding (readout) gradient along the $x$-direction. Consider spins moving along $+x$ with constant velocity $v$. The readout gradient of magnitude $G_x$ is applied for a total readout duration $T_{\\mathrm{ro}}$, centered on the echo time (TE). The proton gyromagnetic ratio is $\\gamma/(2\\pi) = 42.58 \\times 10^{6} \\ \\mathrm{Hz/T}$. The field of view (FOV) along $x$ is $\\mathrm{FOV}_x$ and the number of readout samples is $N_x$. Assume the static magnetic field is $B_0$ and that diffusion and acceleration are negligible.\n\nStarting only from the definitions $v = dx/dt$ and the Larmor relationship $f = (\\gamma/(2\\pi)) B$, and recognizing that the frequency-encoding gradient produces a spatially varying magnetic field $B(x) = B_0 + G_x x$, derive expressions for:\n1. The displacement of spins during the readout, $\\Delta x_{\\mathrm{ro}}$, in terms of $v$ and $T_{\\mathrm{ro}}$.\n2. The span of the instantaneous frequency over the readout caused by motion under $G_x$, denoted $\\Delta f_{\\mathrm{broad}}$, in terms of $\\gamma$, $G_x$, $v$, and $T_{\\mathrm{ro}}$.\n3. The resulting edge smearing extent in voxels along $x$, $L_{\\mathrm{vox}}$, in terms of $\\Delta x_{\\mathrm{ro}}$, $\\mathrm{FOV}_x$, and $N_x$.\n\nThen evaluate these quantities for the following acquisition parameters:\n- Echo time $TE = 30 \\ \\mathrm{ms}$,\n- Readout duration $T_{\\mathrm{ro}} = 8 \\ \\mathrm{ms}$,\n- Readout gradient magnitude $G_x = 10 \\ \\mathrm{mT/m}$,\n- Flow velocity $v = 0.30 \\ \\mathrm{m/s}$,\n- $\\mathrm{FOV}_x = 256 \\ \\mathrm{mm}$,\n- $N_x = 320$.\n\nReport your final numerical results as a row vector $\\left[\\Delta x_{\\mathrm{ro}}, \\Delta f_{\\mathrm{broad}}, L_{\\mathrm{vox}}\\right]$, with units corresponding to millimeters for $\\Delta x_{\\mathrm{ro}}$, hertz for $\\Delta f_{\\mathrm{broad}}$, and voxels for $L_{\\mathrm{vox}}$. Round each component to four significant figures. Express the frequency in $\\mathrm{Hz}$ and the displacement in $\\mathrm{mm}$. The angle unit is not applicable in this problem.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of magnetic resonance imaging, well-posed with a clear objective and sufficient data, and free from ambiguity or contradiction. The provided parameters are physically realistic for a clinical MRI setting. We may therefore proceed with the solution.\n\nThe problem asks for the derivation and evaluation of three quantities related to motion artifacts in a gradient-echo MRI sequence: the displacement of spins during readout, the resulting frequency broadening, and the spatial smearing in terms of voxels.\n\n**Part 1: Derivation of Spin Displacement, $\\Delta x_{\\mathrm{ro}}$**\n\nWe are given that spins are moving with a constant velocity $v$ along the $+x$-direction. The definition of constant velocity is given as $v = \\frac{dx}{dt}$. To find the total displacement, $\\Delta x$, over a given time interval, $\\Delta t$, we can integrate this equation:\n$$ \\Delta x = \\int_{0}^{\\Delta t} v \\, dt $$\nSince $v$ is constant, the integral simplifies to:\n$$ \\Delta x = v \\int_{0}^{\\Delta t} dt = v \\Delta t $$\nThe time interval during which the motion affects the readout is the readout duration itself, which is given as $T_{\\mathrm{ro}}$. Therefore, the displacement of spins during the readout, $\\Delta x_{\\mathrm{ro}}$, is:\n$$ \\Delta x_{\\mathrm{ro}} = v T_{\\mathrm{ro}} $$\nThis expression gives the displacement in terms of the spin velocity $v$ and the readout duration $T_{\\mathrm{ro}}$, as required.\n\n**Part 2: Derivation of Frequency Broadening, $\\Delta f_{\\mathrm{broad}}$**\n\nThe frequency of a spin is determined by the local magnetic field it experiences, according to the Larmor relationship $f = (\\frac{\\gamma}{2\\pi}) B$. The problem states that the total magnetic field $B(x)$ along the $x$-direction is the sum of the static field $B_0$ and the field from the frequency-encoding gradient $G_x$:\n$$ B(x) = B_0 + G_x x $$\nSubstituting this into the Larmor equation gives the frequency of a stationary spin at position $x$:\n$$ f(x) = \\frac{\\gamma}{2\\pi} (B_0 + G_x x) = \\frac{\\gamma}{2\\pi} B_0 + \\frac{\\gamma}{2\\pi} G_x x $$\nNow, consider a spin moving with constant velocity $v$. Its position at time $t$ during the readout (where $t$ ranges from $0$ to $T_{\\mathrm{ro}}$) can be described as $x(t) = x_{\\mathrm{start}} + v t$, where $x_{\\mathrm{start}}$ is the position at the beginning of the readout. The instantaneous frequency of this moving spin is therefore a function of time:\n$$ f(t) = \\frac{\\gamma}{2\\pi} B(x(t)) = \\frac{\\gamma}{2\\pi} (B_0 + G_x (x_{\\mathrm{start}} + v t)) $$\n$$ f(t) = \\left(\\frac{\\gamma}{2\\pi} B_0 + \\frac{\\gamma}{2\\pi} G_x x_{\\mathrm{start}}\\right) + \\left(\\frac{\\gamma}{2\\pi} G_x v\\right) t $$\nThe frequency of the moving spin changes linearly with time during the readout. The \"frequency broadening\" or \"span of the instantaneous frequency\" caused by this motion is the total change in frequency over the duration $T_{\\mathrm{ro}}$. This is the difference between the frequency at the end of the readout ($t = T_{\\mathrm{ro}}$) and the frequency at the start of the readout ($t = 0$):\n$$ \\Delta f_{\\mathrm{broad}} = f(T_{\\mathrm{ro}}) - f(0) $$\n$$ \\Delta f_{\\mathrm{broad}} = \\left[\\left(\\frac{\\gamma}{2\\pi} B_0 + \\frac{\\gamma}{2\\pi} G_x x_{\\mathrm{start}}\\right) + \\frac{\\gamma}{2\\pi} G_x v T_{\\mathrm{ro}}\\right] - \\left[\\left(\\frac{\\gamma}{2\\pi} B_0 + \\frac{\\gamma}{2\\pi} G_x x_{\\mathrm{start}}\\right) + \\frac{\\gamma}{2\\pi} G_x v \\cdot 0\\right] $$\nSimplifying this expression, we find:\n$$ \\Delta f_{\\mathrm{broad}} = \\frac{\\gamma}{2\\pi} G_x v T_{\\mathrm{ro}} $$\nThis expression gives the frequency broadening in terms of $\\gamma$, $G_x$, $v$, and $T_{\\mathrm{ro}}$, as required.\n\n**Part 3: Derivation of Edge Smearing, $L_{\\mathrm{vox}}$**\n\nEdge smearing in the reconstructed image is the spatial manifestation of the frequency broadening. To express this smearing in units of voxels, we must first determine the size of a voxel in the frequency domain and in the spatial domain.\n\nThe spatial resolution along the readout direction, or the voxel size $\\delta x$, is determined by the field of view $\\mathrm{FOV}_x$ and the number of samples (which corresponds to the number of voxels) $N_x$:\n$$ \\delta x = \\frac{\\mathrm{FOV}_x}{N_x} $$\nThe total bandwidth of the readout, $\\Delta f_{\\mathrm{total}}$, required to encode the entire $\\mathrm{FOV}_x$ is given by the change in frequency across the FOV:\n$$ \\Delta f_{\\mathrm{total}} = \\frac{\\gamma}{2\\pi} G_x \\mathrm{FOV}_x $$\nThis total bandwidth is divided into $N_x$ frequency bins, so the frequency width per voxel, $\\delta f_{\\mathrm{vox}}$, is:\n$$ \\delta f_{\\mathrm{vox}} = \\frac{\\Delta f_{\\mathrm{total}}}{N_x} = \\frac{\\frac{\\gamma}{2\\pi} G_x \\mathrm{FOV}_x}{N_x} $$\nThe extent of smearing in voxels, $L_{\\mathrm{vox}}$, is the motion-induced frequency broadening $\\Delta f_{\\mathrm{broad}}$ divided by the frequency width of a single voxel, $\\delta f_{\\mathrm{vox}}$:\n$$ L_{\\mathrm{vox}} = \\frac{\\Delta f_{\\mathrm{broad}}}{\\delta f_{\\mathrm{vox}}} $$\nSubstituting the expressions we derived for $\\Delta f_{\\mathrm{broad}}$ and $\\delta f_{\\mathrm{vox}}$:\n$$ L_{\\mathrm{vox}} = \\frac{\\frac{\\gamma}{2\\pi} G_x v T_{\\mathrm{ro}}}{\\frac{\\frac{\\gamma}{2\\pi} G_x \\mathrm{FOV}_x}{N_x}} $$\nThe terms $\\frac{\\gamma}{2\\pi}$ and $G_x$ cancel, yielding:\n$$ L_{\\mathrm{vox}} = \\frac{v T_{\\mathrm{ro}}}{\\frac{\\mathrm{FOV}_x}{N_x}} $$\nRecognizing that the numerator is the displacement $\\Delta x_{\\mathrm{ro}}$ from Part 1, we get:\n$$ L_{\\mathrm{vox}} = \\frac{\\Delta x_{\\mathrm{ro}} N_x}{\\mathrm{FOV}_x} $$\nThis is the required expression for the smearing extent in voxels.\n\n**Numerical Evaluation**\n\nWe now evaluate these quantities using the provided parameters. All units will be converted to the base SI units of meters, seconds, and teslas for calculation, then converted to the required output units.\n\nGiven parameters:\n- $\\frac{\\gamma}{2\\pi} = 42.58 \\times 10^{6} \\ \\mathrm{Hz/T}$\n- $v = 0.30 \\ \\mathrm{m/s}$\n- $T_{\\mathrm{ro}} = 8 \\ \\mathrm{ms} = 8 \\times 10^{-3} \\ \\mathrm{s}$\n- $G_x = 10 \\ \\mathrm{mT/m} = 10 \\times 10^{-3} \\ \\mathrm{T/m} = 0.01 \\ \\mathrm{T/m}$\n- $\\mathrm{FOV}_x = 256 \\ \\mathrm{mm} = 0.256 \\ \\mathrm{m}$\n- $N_x = 320$\n\n1.  **Displacement $\\Delta x_{\\mathrm{ro}}$:**\n    $$ \\Delta x_{\\mathrm{ro}} = v T_{\\mathrm{ro}} = (0.30 \\ \\mathrm{m/s}) \\times (8 \\times 10^{-3} \\ \\mathrm{s}) = 0.0024 \\ \\mathrm{m} $$\n    Converting to millimeters:\n    $$ \\Delta x_{\\mathrm{ro}} = 2.4 \\ \\mathrm{mm} $$\n    Rounding to four significant figures gives $\\Delta x_{\\mathrm{ro}} = 2.400 \\ \\mathrm{mm}$.\n\n2.  **Frequency Broadening $\\Delta f_{\\mathrm{broad}}$:**\n    $$ \\Delta f_{\\mathrm{broad}} = \\frac{\\gamma}{2\\pi} G_x v T_{\\mathrm{ro}} $$\n    $$ \\Delta f_{\\mathrm{broad}} = (42.58 \\times 10^{6} \\ \\mathrm{Hz/T}) \\times (0.01 \\ \\mathrm{T/m}) \\times (0.30 \\ \\mathrm{m/s}) \\times (8 \\times 10^{-3} \\ \\mathrm{s}) $$\n    $$ \\Delta f_{\\mathrm{broad}} = 42.58 \\times 10^{6} \\times 0.01 \\times 0.30 \\times 0.008 \\ \\mathrm{Hz} $$\n    $$ \\Delta f_{\\mathrm{broad}} = 1021.92 \\ \\mathrm{Hz} $$\n    Rounding to four significant figures gives $\\Delta f_{\\mathrm{broad}} = 1022 \\ \\mathrm{Hz}$.\n\n3.  **Edge Smearing $L_{\\mathrm{vox}}$:**\n    $$ L_{\\mathrm{vox}} = \\frac{\\Delta x_{\\mathrm{ro}} N_x}{\\mathrm{FOV}_x} $$\n    Using values in consistent units (millimeters):\n    $$ L_{\\mathrm{vox}} = \\frac{(2.4 \\ \\mathrm{mm}) \\times 320}{256 \\ \\mathrm{mm}} $$\n    $$ L_{\\mathrm{vox}} = 3.0 $$\n    Rounding to four significant figures gives $L_{\\mathrm{vox}} = 3.000$ voxels.\n\nThe final numerical results are presented as a row vector as requested.", "answer": "$$\n\\boxed{\\begin{pmatrix} 2.400 & 1022 & 3.000 \\end{pmatrix}}\n$$", "id": "4901264"}, {"introduction": "After examining specific artifacts, we can generalize our understanding using the concept of the Point Spread Function (PSF). The PSF acts as a bridge, showing how systematic errors in the raw data (k-space) translate into artifacts in the final image. This practice asks you to derive the PSF for a simple, periodic motion pattern, revealing precisely how it generates a \"ghost\" image alongside the true object and providing a foundational tool for analyzing many types of imaging artifacts. [@problem_id:4901233]", "problem": "Consider one-dimensional Magnetic Resonance Imaging (MRI) along a single phase-encoding axis with a Cartesian sampling grid of $N$ equally spaced phase-encode lines, where $N$ is even. Let $n \\in \\{0,1,\\dots,N-1\\}$ index $k$-space lines and $m \\in \\{0,1,\\dots,N-1\\}$ index image-space pixels. In the absence of motion, the measured $k$-space data is the discrete Fourier transform of the true object, and the image is recovered by the inverse discrete Fourier transform (IDFT). For this problem, model motion as an inter-shot global phase error that is constant across each acquired line but can switch between two states. Specifically, assume a simple two-state motion model in which successive lines alternate between two motion states that impart phase offsets $\\phi_1$ and $\\phi_2$ (in radians) to $k$-space lines. That is, lines with even index $n$ have phase $\\phi_1$ and lines with odd index $n$ have phase $\\phi_2$. Define the motion Point Spread Function (PSF) as the image-space impulse response that results from the motion-induced multiplicative phase perturbations across $k$-space. Use only the fundamental Fourier relationship between image and $k$-space and the definition of the inverse discrete Fourier transform to derive the motion PSF as a closed-form expression in terms of $\\phi_1$ and $\\phi_2$. Express your answer in terms of the discrete Kronecker delta $\\delta_{m,k}$ and do not introduce any approximations. No numerical rounding is required, and no physical units are to be reported in the final expression.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It presents a canonical problem in Fourier-based imaging, linking k-space errors to image-space artifacts. We may therefore proceed with a formal solution.\n\nThe motion Point Spread Function (PSF) is the reconstructed image of a single point source, which in k-space is represented as uniform data. The motion artifact is modeled as a multiplicative phase modulation, $P(n)$, applied to the k-space data. According to the problem statement, this modulation alternates between two phase states:\n$$\nP(n) =\n\\begin{cases}\n    \\exp(i\\phi_1) & \\text{if } n \\text{ is an even integer} \\\\\n    \\exp(i\\phi_2) & \\text{if } n \\text{ is an odd integer}\n\\end{cases}\n$$\nThe motion PSF, which we denote as $psf(m)$, is the Inverse Discrete Fourier Transform (IDFT) of this phase modulation function $P(n)$. The IDFT is defined as:\n$$\npsf(m) = \\frac{1}{N} \\sum_{n=0}^{N-1} P(n) \\exp\\left(\\frac{i 2\\pi mn}{N}\\right)\n$$\nTo solve this, we can decompose the modulation function $P(n)$ into a constant component and an alternating component. Let $P(n) = A + B(-1)^n$.\nBy evaluating this for even ($n=2k$) and odd ($n=2k+1$) indices, we get:\n- For even $n$: $P(n) = A + B = \\exp(i\\phi_1)$\n- For odd $n$: $P(n) = A - B = \\exp(i\\phi_2)$\nThis gives a system of two linear equations for $A$ and $B$. Solving for $A$ and $B$:\n$$ A = \\frac{1}{2} \\left( \\exp(i\\phi_1) + \\exp(i\\phi_2) \\right) $$\n$$ B = \\frac{1}{2} \\left( \\exp(i\\phi_1) - \\exp(i\\phi_2) \\right) $$\nNow we can rewrite the PSF using this decomposition:\n$$\npsf(m) = \\frac{1}{N} \\sum_{n=0}^{N-1} \\left( A + B(-1)^n \\right) \\exp\\left(\\frac{i 2\\pi mn}{N}\\right)\n$$\nBy linearity of the Fourier transform, we can separate this into two terms:\n$$\npsf(m) = A \\left( \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp\\left(\\frac{i 2\\pi mn}{N}\\right) \\right) + B \\left( \\frac{1}{N} \\sum_{n=0}^{N-1} (-1)^n \\exp\\left(\\frac{i 2\\pi mn}{N}\\right) \\right)\n$$\nLet's analyze each term.\n1. The first term is the IDFT of a constant function with value 1. This is a Kronecker delta function centered at the origin of image space ($m=0$):\n   $$ \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp\\left(\\frac{i 2\\pi mn}{N}\\right) = \\delta_{m,0} $$\n2. The second term involves the alternating factor $(-1)^n$, which can be written as $\\exp(i\\pi n)$.\n   $$ \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp(i\\pi n) \\exp\\left(\\frac{i 2\\pi mn}{N}\\right) = \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp\\left(i 2\\pi n \\left(\\frac{m}{N} + \\frac{1}{2}\\right)\\right) = \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp\\left(\\frac{i 2\\pi n (m + N/2)}{N}\\right) $$\n   This is the IDFT of a complex exponential, which results in a shifted Kronecker delta. The sum is non-zero only when the argument of the exponential inside the sum is an integer multiple of $2\\pi$. This occurs when $m+N/2$ is a multiple of $N$. Since $m$ is in the range $\\{0, \\dots, N-1\\}$, the only solution is $m+N/2 = N$, which means $m=N/2$. The value of the IDFT at this point is 1. Thus:\n   $$ \\frac{1}{N} \\sum_{n=0}^{N-1} (-1)^n \\exp\\left(\\frac{i 2\\pi mn}{N}\\right) = \\delta_{m,N/2} $$\nCombining these results, the PSF is:\n$$ psf(m) = A \\cdot \\delta_{m,0} + B \\cdot \\delta_{m,N/2} $$\nSubstituting the expressions for $A$ and $B$:\n$$\npsf(m) = \\frac{1}{2} \\left( \\exp(i\\phi_1) + \\exp(i\\phi_2) \\right) \\delta_{m,0} + \\frac{1}{2} \\left( \\exp(i\\phi_1) - \\exp(i\\phi_2) \\right) \\delta_{m,N/2}\n$$\nThis result shows that the two-state periodic phase error in k-space creates a PSF with two components: a scaled version of the true object at its original location (proportional to $\\delta_{m,0}$) and a \"ghost\" artifact shifted by half the field of view (proportional to $\\delta_{m,N/2}$). The intensity of the true object is proportional to the average of the phase factors, while the intensity of the ghost is proportional to their difference.", "answer": "$$\n\\boxed{ \\frac{1}{2} \\left( \\exp(i\\phi_1) + \\exp(i\\phi_2) \\right) \\delta_{m,0} + \\frac{1}{2} \\left( \\exp(i\\phi_1) - \\exp(i\\phi_2) \\right) \\delta_{m,N/2} }\n$$", "id": "4901233"}]}