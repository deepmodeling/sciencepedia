{"hands_on_practices": [{"introduction": "The radiomics workflow begins by grounding abstract image data in physical reality. Before we can compute meaningful quantitative features, we must first understand the geometry of the image, translating digital voxels into tangible volumes. This exercise [@problem_id:4554338] guides you through the fundamental process of using standard medical imaging metadata to determine the physical volume of a single voxel and, consequently, the total volume of a segmented region of interest.", "problem": "A radiomics pipeline begins by linking the geometry of an image volume to real-world physical dimensions using Digital Imaging and Communications in Medicine (DICOM) metadata. Consider an axial computed tomography series used for radiomics, where the region of interest (ROI) is provided as a binary mask with exactly $N_{v} = 23{,}000$ voxels labeled as part of the ROI. The DICOM PixelSpacing attribute (tag $(0028,0030)$) indicates an in-plane spacing of $[0.7, 0.7]$ millimeters, and the SliceThickness attribute (tag $(0018,0050)$) is $2$ millimeters. Assume orthogonal axes, no gantry tilt, and contiguous slices with no inter-slice gaps, so that the physical voxel is a right rectangular prism whose edge lengths equal the physical spacings along the row, column, and slice directions.\n\nStarting only from the fundamental geometric definition that the volume of a right rectangular prism equals the product of its three edge lengths, and from the standard interpretation of these DICOM attributes (PixelSpacing entries as the physical distances between the centers of adjacent pixels along rows and columns in millimeters, and SliceThickness as the physical extent of the slice in the through-plane direction in millimeters), derive a general expression for the voxel volume in terms of the PixelSpacing components and SliceThickness. Then use it to compute the ROI volume for this mask.\n\nExpress the final ROI volume in cubic centimeters and round your answer to four significant figures. State only the final numeric value in cubic centimeters.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The premises are consistent with standard practices in the field of radiomics and medical imaging.\n\nThe primary objective is to calculate the total volume of a Region of Interest (ROI) from a computed tomography (CT) scan. The total volume, $V_{\\text{ROI}}$, is the product of the number of voxels in the ROI, $N_v$, and the volume of a single voxel, $V_{\\text{voxel}}$.\n$$V_{\\text{ROI}} = N_v \\times V_{\\text{voxel}}$$\n\nThe problem specifies that a voxel is to be modeled as a right rectangular prism. The fundamental geometric definition for the volume of such a prism is the product of its three orthogonal edge lengths.\n$$V_{\\text{prism}} = l_1 \\times l_2 \\times l_3$$\n\nThese edge lengths are given by the DICOM attributes for physical spacing. Let the in-plane physical spacing along the row and column directions be denoted by $\\Delta x$ and $\\Delta y$, respectively. These correspond to the two values in the `PixelSpacing` attribute. Let the through-plane physical spacing be denoted by $\\Delta z$, which corresponds to the `SliceThickness` attribute.\nFrom the problem statement, we have:\n- In-plane spacing (from `PixelSpacing`): $\\Delta x = 0.7 \\text{ mm}$ and $\\Delta y = 0.7 \\text{ mm}$.\n- Through-plane spacing (from `SliceThickness`): $\\Delta z = 2 \\text{ mm}$.\n\nThe problem states to assume the voxel edge lengths are equal to these physical spacings. This is a standard convention in medical imaging for orthogonal acquisitions, where the voxel fills the space defined by these center-to-center and slice-to-slice distances.\n\nFirst, as requested, we derive the general expression for the volume of a single voxel, $V_{\\text{voxel}}$, in terms of these DICOM-derived parameters.\n$$V_{\\text{voxel}} = \\Delta x \\times \\Delta y \\times \\Delta z$$\nThis formula connects the DICOM metadata to the physical volume of a single image element.\n\nNow, we substitute the given values to calculate the volume of one voxel in cubic millimeters.\n$$V_{\\text{voxel}} = (0.7 \\text{ mm}) \\times (0.7 \\text{ mm}) \\times (2 \\text{ mm})$$\n$$V_{\\text{voxel}} = 0.49 \\text{ mm}^2 \\times 2 \\text{ mm} = 0.98 \\text{ mm}^3$$\n\nThe total number of voxels in the ROI is given as $N_v = 23000$.\nWe can now compute the total volume of the ROI, $V_{\\text{ROI}}$, in cubic millimeters.\n$$V_{\\text{ROI}} = N_v \\times V_{\\text{voxel}} = 23000 \\times 0.98 \\text{ mm}^3$$\n$$V_{\\text{ROI}} = 22540 \\text{ mm}^3$$\n\nThe final part of the problem requires expressing this volume in cubic centimeters ($\\text{cm}^3$). The conversion between millimeters and centimeters is $1 \\text{ cm} = 10 \\text{ mm}$. For volumetric units, we must cube this conversion factor:\n$$1 \\text{ cm}^3 = (10 \\text{ mm})^3 = 1000 \\text{ mm}^3$$\nTo convert $V_{\\text{ROI}}$ from $\\text{mm}^3$ to $\\text{cm}^3$, we divide by $1000$.\n$$V_{\\text{ROI}} = \\frac{22540 \\text{ mm}^3}{1000 \\frac{\\text{mm}^3}{\\text{cm}^3}} = 22.54 \\text{ cm}^3$$\n\nFinally, the problem requires the answer to be rounded to four significant figures. The calculated value, $22.54$, already consists of exactly four significant figures (the digits $2$, $2$, $5$, and $4$). Therefore, no further rounding is necessary.\nThe final ROI volume is $22.54 \\text{ cm}^3$.", "answer": "$$\\boxed{22.54}$$", "id": "4554338"}, {"introduction": "Many advanced radiomic features are sensitive to noise and variations in image acquisition. To address this, a crucial preprocessing step is intensity discretization, which groups the wide range of continuous intensity values into a smaller, fixed number of bins. This practice [@problem_id:4554345] will help you master the logic behind fixed bin width discretization, a common technique for stabilizing the calculation of texture features.", "problem": "In quantitative image analysis known as radiomics, a typical workflow proceeds from image acquisition through segmentation to preprocessing and feature extraction. During preprocessing, intensity discretization is often performed to stabilize texture features such as those derived from the gray-level co-occurrence matrix. Consider a region of interest (ROI) segmented on a computed tomography image where intensities are measured in Hounsfield Unit (HU). In fixed bin width discretization, intensities within the ROI are partitioned into contiguous bins, each of width $w$, covering the range from the minimum intensity $I_{\\min}$ to the maximum intensity $I_{\\max}$. Bins are defined as left-inclusive and right-exclusive intervals, except that the last bin is left-inclusive and right-inclusive to ensure inclusion of $I_{\\max}$. Index bins starting from $1$ in ascending order of intensity.\n\nStarting from these definitions, derive an expression for the number of bins $N$ required to cover the range from $I_{\\min}$ to $I_{\\max}$ and for the bin index $b$ associated with a voxel of intensity $g$ belonging to the ROI. Then evaluate these expressions for $I_{\\min}=-150$ HU, $I_{\\max}=250$ HU, $w=25$ HU, and $g=37$ HU. Report the final values for $N$ and $b$ as integers. No rounding instructions are necessary because the result is exactly integral. Provide both values together as your final answer.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the field of radiomics, presenting a well-posed and objective problem in quantitative image analysis. All necessary data and definitions for intensity discretization are provided, and the setup is internally consistent and physically realistic.\n\nThe problem requires the derivation of expressions for the number of bins $N$ and the bin index $b$ for a given intensity $g$, based on a fixed bin width discretization scheme. The parameters are the minimum intensity $I_{\\min}$, maximum intensity $I_{\\max}$, and the bin width $w$. The bins are defined as left-inclusive and right-exclusive intervals, with indexing starting at $1$. A special condition is that the last bin is made right-inclusive to contain $I_{\\max}$.\n\nFirst, we derive the expression for the total number of bins, $N$.\nThe total range of intensities to be discretized is $\\Delta I = I_{\\max} - I_{\\min}$.\nThe bins are generated by partitioning this range into segments of width $w$. The bin edges can be thought of as a sequence starting at $I_{\\min}$, with subsequent edges at $I_{\\min} + w$, $I_{\\min} + 2w$, and so on.\nThe number of bins required is the number of intervals of width $w$ necessary to cover the entire span $\\Delta I$.\nLet's consider the ratio $\\frac{I_{\\max} - I_{\\min}}{w}$.\n\nCase 1: $\\frac{I_{\\max} - I_{\\min}}{w}$ is not an integer.\nLet $\\frac{I_{\\max} - I_{\\min}}{w} = K + \\delta$, where $K$ is an integer and $0 < \\delta < 1$. This means the range spans $K$ full bins and a fraction of another. Thus, a total of $K+1$ bins are required. This is equivalent to $\\lceil \\frac{I_{\\max} - I_{\\min}}{w} \\rceil$. For example, if the range is $10$ and width is $3$, $\\frac{10}{3} \\approx 3.33$. We need $4$ bins: $[0,3), [3,6), [6,9), [9,10]$. $\\lceil 3.33 \\rceil = 4$.\n\nCase 2: $\\frac{I_{\\max} - I_{\\min}}{w}$ is an integer, say $K$.\nThis means the total range is exactly divisible into $K$ intervals of width $w$. The sequence of bins according to the left-inclusive, right-exclusive rule $[...)$ would be:\nBin 1: $[I_{\\min}, I_{\\min} + w)$\nBin 2: $[I_{\\min} + w, I_{\\min} + 2w)$\n...\nBin $K$: $[I_{\\min} + (K-1)w, I_{\\min} + Kw)$.\nSince $I_{\\max} - I_{\\min} = Kw$, we have $I_{\\max} = I_{\\min} + Kw$. The final bin, Bin $K$, has an interval $[..., I_{\\max})$. This excludes the value $I_{\\max}$. The problem states that the last bin must be right-inclusive to ensure $I_{\\max}$ is included. Following the most standard interpretation for this process, the \"last bin\" in the sequence, which is Bin $K$, is the one whose interval is modified to be closed on the right. So, the interval for Bin $K$ becomes $[I_{\\min} + (K-1)w, I_{\\max}]$. The total number of bins is $K$. The ceiling function $\\lceil x \\rceil$ for an integer $x$ is $x$. So, in this case, $N = K = \\lceil \\frac{I_{\\max} - I_{\\min}}{w} \\rceil$.\n\nIn both cases, the number of bins $N$ is correctly given by the ceiling function.\n$$N = \\left\\lceil \\frac{I_{\\max} - I_{\\min}}{w} \\right\\rceil$$\n\nNext, we derive the expression for the bin index $b$ for a voxel with intensity $g$, where $I_{\\min} \\le g \\le I_{\\max}$. The bin index $b$ starts from $1$.\nFor any bin $b$ (except possibly the last one), an intensity $g$ falls into it if it satisfies the condition:\n$$I_{\\min} + (b-1)w \\le g < I_{\\min} + bw$$\nThis inequality is valid because bins are left-inclusive and right-exclusive, and the $b$-th bin starts at the position offset by $b-1$ widths from $I_{\\min}$.\nWe can solve for $b$:\n$$(b-1)w \\le g - I_{\\min} < bw$$\n$$b-1 \\le \\frac{g - I_{\\min}}{w} < b$$\nThis shows that $b-1$ is the greatest integer less than or equal to $\\frac{g - I_{\\min}}{w}$. This is the definition of the floor function, $\\lfloor \\cdot \\rfloor$.\n$$b-1 = \\left\\lfloor \\frac{g - I_{\\min}}{w} \\right\\rfloor$$\nTherefore, the bin index is:\n$$b(g) = \\left\\lfloor \\frac{g - I_{\\min}}{w} \\right\\rfloor + 1$$\nThis formula correctly assigns an index for any $g$ that is not on the upper boundary of the very last bin. A special consideration is needed for $g=I_{\\max}$ in the specific case where $\\frac{I_{\\max} - I_{\\min}}{w}$ is an integer, say $K$. In this scenario, $N=K$, but the formula would yield $b(I_{\\max}) = \\lfloor K \\rfloor + 1 = K+1$, which is out of bounds. The correct index for $I_{\\max}$ is always $N$. A general expression that handles this edge case is $b(g) = \\min(N, \\lfloor \\frac{g - I_{\\min}}{w} \\rfloor + 1)$. However, for any $g < I_{\\max}$, or for $g=I_{\\max}$ when $\\frac{I_{\\max} - I_{\\min}}{w}$ is not an integer, the simpler formula holds. Since the problem asks to evaluate $b$ for an intensity $g$ that is not $I_{\\max}$, the simpler expression is sufficient for the calculation part.\n\nNow we evaluate these expressions for the given values:\n$I_{\\min} = -150$ HU\n$I_{\\max} = 250$ HU\n$w = 25$ HU\n$g = 37$ HU\n\nFirst, we calculate the number of bins, $N$:\n$$N = \\left\\lceil \\frac{I_{\\max} - I_{\\min}}{w} \\right\\rceil = \\left\\lceil \\frac{250 - (-150)}{25} \\right\\rceil = \\left\\lceil \\frac{400}{25} \\right\\rceil = \\lceil 16 \\rceil$$\nSince $16$ is an integer, $\\lceil 16 \\rceil = 16$.\nSo, the number of bins is $N = 16$.\n\nNext, we calculate the bin index $b$ for the intensity $g = 37$:\n$$b = \\left\\lfloor \\frac{g - I_{\\min}}{w} \\right\\rfloor + 1 = \\left\\lfloor \\frac{37 - (-150)}{25} \\right\\rfloor + 1 = \\left\\lfloor \\frac{187}{25} \\right\\rfloor + 1$$\nPerforming the division: $\\frac{187}{25} = 7.48$.\n$$b = \\lfloor 7.48 \\rfloor + 1 = 7 + 1 = 8$$\nSo, the bin index for an intensity of $37$ HU is $b=8$.\n\nThe final values are $N=16$ and $b=8$. Both are integers as required.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n16 & 8\n\\end{pmatrix}\n}\n$$", "id": "4554345"}, {"introduction": "Beyond simple statistics like mean and variance, the true power of radiomics lies in its ability to quantify tissue texture and heterogeneity. The Gray Level Co-Occurrence Matrix (GLCM) is a cornerstone of texture analysis, capturing the spatial relationship between pairs of voxels at a specific distance and direction. In this hands-on exercise [@problem_id:4554327], you will construct GLCMs from a discretized image patch and compute a classic texture feature, gaining direct experience with the computational heart of radiomics.", "problem": "A radiomics workflow proceeds from image acquisition through segmentation of a Region of Interest (ROI) and discretization of intensities, followed by feature extraction. Consider the following discretized ROI intensity map with $N_{g}=3$ gray levels ($0$, $1$, $2$), distance $d=1$, and four standard directions: $0^{\\circ}$ (offset $(0,1)$), $45^{\\circ}$ (offset $(-1,1)$), $90^{\\circ}$ (offset $(-1,0)$), and $135^{\\circ}$ (offset $(-1,-1)$). The ROI is\n$$\nI=\\begin{pmatrix}\n0 & 1 & 2 \\\\\n2 & 1 & 0 \\\\\n1 & 0 & 2\n\\end{pmatrix}.\n$$\nStarting from the definition of the Gray Level Co-Occurrence Matrix (GLCM), where the asymmetric directional GLCM $P_{d,\\theta}^{\\mathrm{asym}}(i,j)$ counts co-occurrences of a reference gray level $i$ with its neighbor gray level $j$ at offset corresponding to direction $\\theta$ and the symmetric directional GLCM $P_{d,\\theta}^{\\mathrm{sym}}(i,j)$ is formed by symmetrization $P_{d,\\theta}^{\\mathrm{sym}}(i,j)=P_{d,\\theta}^{\\mathrm{asym}}(i,j)+P_{d,\\theta}^{\\mathrm{asym}}(j,i)$ prior to normalization, construct for each $\\theta\\in\\{0^{\\circ},45^{\\circ},90^{\\circ},135^{\\circ}\\}$ the normalized probability matrices $p_{d,\\theta}^{\\mathrm{asym}}(i,j)$ and $p_{d,\\theta}^{\\mathrm{sym}}(i,j)$ by dividing the raw counts by their respective directional sums so that $\\sum_{i=0}^{N_{g}-1}\\sum_{j=0}^{N_{g}-1}p_{d,\\theta}(\\!i,j\\!)=1$. Using the Angular Second Moment (ASM, also called energy) defined by\n$$\n\\mathrm{ASM}(p)=\\sum_{i=0}^{N_{g}-1}\\sum_{j=0}^{N_{g}-1}\\big(p(i,j)\\big)^{2},\n$$\ncompute the mean across directions of $\\mathrm{ASM}\\big(p_{d,\\theta}^{\\mathrm{asym}}\\big)$ and the mean across directions of $\\mathrm{ASM}\\big(p_{d,\\theta}^{\\mathrm{sym}}\\big)$, and then compute the difference\n$$\n\\Delta=\\left(\\frac{1}{4}\\sum_{\\theta}\\mathrm{ASM}\\big(p_{d,\\theta}^{\\mathrm{sym}}\\big)\\right)-\\left(\\frac{1}{4}\\sum_{\\theta}\\mathrm{ASM}\\big(p_{d,\\theta}^{\\mathrm{asym}}\\big)\\right).\n$$\nExpress your final answer for $\\Delta$ as a unitless decimal and round your result to four significant figures.", "solution": "The problem statement submitted for consideration is valid. It is a well-posed, scientifically grounded, and objective problem from the field of radiomics, specifically concerning the calculation of texture features from a Gray Level Co-Occurrence Matrix (GLCM). The problem provides all necessary data and definitionsâ€”the Region of Interest (ROI) intensity map, gray levels, distance and angular offsets, and formulae for the GLCM and the Angular Second Moment (ASM) feature. The task is to execute a standard computational workflow.\n\nThe objective is to compute the difference $\\Delta$ between the direction-averaged ASM of symmetric GLCMs and the direction-averaged ASM of asymmetric GLCMs. The calculation proceeds in the following steps:\n1.  For each of the four specified directions $\\theta$, construct the asymmetric raw counts matrix, $P_{d,\\theta}^{\\mathrm{asym}}$.\n2.  Normalize each $P_{d,\\theta}^{\\mathrm{asym}}$ to obtain the probability matrix $p_{d,\\theta}^{\\mathrm{asym}}$.\n3.  Compute the ASM for each $p_{d,\\theta}^{\\mathrm{asym}}$ and then find their mean.\n4.  For each direction $\\theta$, construct the symmetric raw counts matrix, $P_{d,\\theta}^{\\mathrm{sym}}$.\n5.  Normalize each $P_{d,\\theta}^{\\mathrm{sym}}$ to obtain the probability matrix $p_{d,\\theta}^{\\mathrm{sym}}$.\n6.  Compute the ASM for each $p_{d,\\theta}^{\\mathrm{sym}}$ and then find their mean.\n7.  Calculate the final difference $\\Delta$.\n\nThe given ROI is the matrix $I$ with gray levels $i,j \\in \\{0, 1, 2\\}$:\n$$\nI=\\begin{pmatrix}\n0 & 1 & 2 \\\\\n2 & 1 & 0 \\\\\n1 & 0 & 2\n\\end{pmatrix}\n$$\nThe directions are $\\theta \\in \\{0^{\\circ}, 45^{\\circ}, 90^{\\circ}, 135^{\\circ}\\}$ with distance $d=1$ and respective offsets $(\\Delta r, \\Delta c)$ of $(0,1)$, $(-1,1)$, $(-1,0)$, and $(-1,-1)$. The coordinates $(r,c)$ are $1$-indexed matrix coordinates.\n\n**Step 1 & 2: Asymmetric GLCMs and Normalization**\n\nWe compute the co-occurrences $(I(r,c), I(r+\\Delta r, c+\\Delta c))$ for each direction.\n\nFor $\\theta = 0^{\\circ}$ (offset $(0,1)$), there are $N_{0^{\\circ}}=6$ co-occurring pairs: $(0,1), (1,2), (2,1), (1,0), (1,0), (0,2)$.\nThe raw GLCM $P_{1,0^{\\circ}}^{\\mathrm{asym}}$ is:\n$$\nP_{1,0^{\\circ}}^{\\mathrm{asym}} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 2 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\nThe normalized matrix $p_{1,0^{\\circ}}^{\\mathrm{asym}}$ is obtained by dividing by $N_{0^{\\circ}}=6$:\n$$\np_{1,0^{\\circ}}^{\\mathrm{asym}} = \\frac{1}{6} \\begin{pmatrix} 0 & 1 & 1 \\\\ 2 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\n\nFor $\\theta = 45^{\\circ}$ (offset $(-1,1)$), there are $N_{45^{\\circ}}=4$ co-occurring pairs: $(2,1), (1,2), (1,1), (0,0)$.\nThe raw GLCM $P_{1,45^{\\circ}}^{\\mathrm{asym}}$ is:\n$$\nP_{1,45^{\\circ}}^{\\mathrm{asym}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\nThe normalized matrix $p_{1,45^{\\circ}}^{\\mathrm{asym}}$ is obtained by dividing by $N_{45^{\\circ}}=4$:\n$$\np_{1,45^{\\circ}}^{\\mathrm{asym}} = \\frac{1}{4} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\n\nFor $\\theta = 90^{\\circ}$ (offset $(-1,0)$), there are $N_{90^{\\circ}}=6$ co-occurring pairs: $(2,0), (1,1), (0,2), (1,2), (0,1), (2,0)$.\nThe raw GLCM $P_{1,90^{\\circ}}^{\\mathrm{asym}}$ is:\n$$\nP_{1,90^{\\circ}}^{\\mathrm{asym}} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 0 & 1 & 1 \\\\ 2 & 0 & 0 \\end{pmatrix}\n$$\nThe normalized matrix $p_{1,90^{\\circ}}^{\\mathrm{asym}}$ is obtained by dividing by $N_{90^{\\circ}}=6$:\n$$\np_{1,90^{\\circ}}^{\\mathrm{asym}} = \\frac{1}{6} \\begin{pmatrix} 0 & 1 & 1 \\\\ 0 & 1 & 1 \\\\ 2 & 0 & 0 \\end{pmatrix}\n$$\n\nFor $\\theta = 135^{\\circ}$ (offset $(-1,-1)$), there are $N_{135^{\\circ}}=4$ co-occurring pairs: $(1,0), (0,1), (0,2), (2,1)$.\nThe raw GLCM $P_{1,135^{\\circ}}^{\\mathrm{asym}}$ is:\n$$\nP_{1,135^{\\circ}}^{\\mathrm{asym}} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\nThe normalized matrix $p_{1,135^{\\circ}}^{\\mathrm{asym}}$ is obtained by dividing by $N_{135^{\\circ}}=4$:\n$$\np_{1,135^{\\circ}}^{\\mathrm{asym}} = \\frac{1}{4} \\begin{pmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\n\n**Step 3: Mean of Asymmetric ASMs**\n\nThe ASM is calculated as $\\mathrm{ASM}(p) = \\sum_{i,j} (p(i,j))^2$.\n$$\n\\mathrm{ASM}(p_{1,0^{\\circ}}^{\\mathrm{asym}}) = \\left(\\frac{1}{6}\\right)^2 (1^2+1^2+2^2+1^2+1^2) = \\frac{1+1+4+1+1}{36} = \\frac{8}{36} = \\frac{2}{9}\n$$\n$$\n\\mathrm{ASM}(p_{1,45^{\\circ}}^{\\mathrm{asym}}) = \\left(\\frac{1}{4}\\right)^2 (1^2+1^2+1^2+1^2) = \\frac{4}{16} = \\frac{1}{4}\n$$\n$$\n\\mathrm{ASM}(p_{1,90^{\\circ}}^{\\mathrm{asym}}) = \\left(\\frac{1}{6}\\right)^2 (1^2+1^2+1^2+1^2+2^2) = \\frac{1+1+1+1+4}{36} = \\frac{8}{36} = \\frac{2}{9}\n$$\n$$\n\\mathrm{ASM}(p_{1,135^{\\circ}}^{\\mathrm{asym}}) = \\left(\\frac{1}{4}\\right)^2 (1^2+1^2+1^2+1^2) = \\frac{4}{16} = \\frac{1}{4}\n$$\nThe mean of the asymmetric ASMs is:\n$$\n\\frac{1}{4}\\sum_{\\theta}\\mathrm{ASM}(p_{d,\\theta}^{\\mathrm{asym}}) = \\frac{1}{4}\\left(\\frac{2}{9} + \\frac{1}{4} + \\frac{2}{9} + \\frac{1}{4}\\right) = \\frac{1}{4}\\left(\\frac{4}{9} + \\frac{1}{2}\\right) = \\frac{1}{4}\\left(\\frac{8+9}{18}\\right) = \\frac{17}{72}\n$$\n\n**Step 4 & 5: Symmetric GLCMs and Normalization**\n\nThe symmetric GLCMs are computed as $P_{d,\\theta}^{\\mathrm{sym}} = P_{d,\\theta}^{\\mathrm{asym}} + (P_{d,\\theta}^{\\mathrm{asym}})^T$. The total number of pairs for normalization is $N_{\\theta}^{\\mathrm{sym}} = 2 N_{\\theta}$.\n\nFor $\\theta = 0^{\\circ}$, $N_{0^{\\circ}}^{\\mathrm{sym}}=12$:\n$$\nP_{1,0^{\\circ}}^{\\mathrm{sym}} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 2 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 2 & 0 \\\\ 1 & 0 & 1 \\\\ 1 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 3 & 1 \\\\ 3 & 0 & 2 \\\\ 1 & 2 & 0 \\end{pmatrix}\n\\implies p_{1,0^{\\circ}}^{\\mathrm{sym}} = \\frac{1}{12}\\begin{pmatrix} 0 & 3 & 1 \\\\ 3 & 0 & 2 \\\\ 1 & 2 & 0 \\end{pmatrix}\n$$\n\nFor $\\theta = 45^{\\circ}$, $N_{45^{\\circ}}^{\\mathrm{sym}}=8$:\n$$\nP_{1,45^{\\circ}}^{\\mathrm{sym}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}^T = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 2 \\\\ 0 & 2 & 0 \\end{pmatrix}\n\\implies p_{1,45^{\\circ}}^{\\mathrm{sym}} = \\frac{1}{8}\\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 2 \\\\ 0 & 2 & 0 \\end{pmatrix}\n$$\n\nFor $\\theta = 90^{\\circ}$, $N_{90^{\\circ}}^{\\mathrm{sym}}=12$:\n$$\nP_{1,90^{\\circ}}^{\\mathrm{sym}} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 0 & 1 & 1 \\\\ 2 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 2 \\\\ 1 & 1 & 0 \\\\ 1 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 3 \\\\ 1 & 2 & 1 \\\\ 3 & 1 & 0 \\end{pmatrix}\n\\implies p_{1,90^{\\circ}}^{\\mathrm{sym}} = \\frac{1}{12}\\begin{pmatrix} 0 & 1 & 3 \\\\ 1 & 2 & 1 \\\\ 3 & 1 & 0 \\end{pmatrix}\n$$\n\nFor $\\theta = 135^{\\circ}$, $N_{135^{\\circ}}^{\\mathrm{sym}}=8$:\n$$\nP_{1,135^{\\circ}}^{\\mathrm{sym}} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 2 & 1 \\\\ 2 & 0 & 1 \\\\ 1 & 1 & 0 \\end{pmatrix}\n\\implies p_{1,135^{\\circ}}^{\\mathrm{sym}} = \\frac{1}{8}\\begin{pmatrix} 0 & 2 & 1 \\\\ 2 & 0 & 1 \\\\ 1 & 1 & 0 \\end{pmatrix}\n$$\n\n**Step 6: Mean of Symmetric ASMs**\n$$\n\\mathrm{ASM}(p_{1,0^{\\circ}}^{\\mathrm{sym}}) = \\left(\\frac{1}{12}\\right)^2 (3^2+1^2+3^2+2^2+1^2+2^2) = \\frac{9+1+9+4+1+4}{144} = \\frac{28}{144} = \\frac{7}{36}\n$$\n$$\n\\mathrm{ASM}(p_{1,45^{\\circ}}^{\\mathrm{sym}}) = \\left(\\frac{1}{8}\\right)^2 (2^2+2^2+2^2+2^2) = \\frac{4 \\times 4}{64} = \\frac{16}{64} = \\frac{1}{4}\n$$\n$$\n\\mathrm{ASM}(p_{1,90^{\\circ}}^{\\mathrm{sym}}) = \\left(\\frac{1}{12}\\right)^2 (1^2+3^2+1^2+2^2+1^2+3^2+1^2) = \\frac{1+9+1+4+1+9+1}{144} = \\frac{26}{144} = \\frac{13}{72}\n$$\n$$\n\\mathrm{ASM}(p_{1,135^{\\circ}}^{\\mathrm{sym}}) = \\left(\\frac{1}{8}\\right)^2 (2^2+1^2+2^2+1^2+1^2+1^2) = \\frac{4+1+4+1+1+1}{64} = \\frac{12}{64} = \\frac{3}{16}\n$$\nThe mean of the symmetric ASMs is:\n$$\n\\frac{1}{4}\\sum_{\\theta}\\mathrm{ASM}(p_{d,\\theta}^{\\mathrm{sym}}) = \\frac{1}{4}\\left(\\frac{7}{36} + \\frac{1}{4} + \\frac{13}{72} + \\frac{3}{16}\\right)\n$$\nUsing a common denominator of $144$:\n$$\n= \\frac{1}{4}\\left(\\frac{7 \\cdot 4}{144} + \\frac{1 \\cdot 36}{144} + \\frac{13 \\cdot 2}{144} + \\frac{3 \\cdot 9}{144}\\right) = \\frac{1}{4}\\left(\\frac{28+36+26+27}{144}\\right) = \\frac{1}{4}\\left(\\frac{117}{144}\\right) = \\frac{1}{4}\\left(\\frac{13}{16}\\right) = \\frac{13}{64}\n$$\n\n**Step 7: Final Difference $\\Delta$**\nThe final difference $\\Delta$ is calculated as:\n$$\n\\Delta = \\left(\\frac{1}{4}\\sum_{\\theta}\\mathrm{ASM}(p_{d,\\theta}^{\\mathrm{sym}})\\right) - \\left(\\frac{1}{4}\\sum_{\\theta}\\mathrm{ASM}(p_{d,\\theta}^{\\mathrm{asym}})\\right) = \\frac{13}{64} - \\frac{17}{72}\n$$\nThe least common multiple of $64 = 2^6$ and $72 = 2^3 \\cdot 3^2$ is $2^6 \\cdot 3^2 = 64 \\cdot 9 = 576$.\n$$\n\\Delta = \\frac{13 \\cdot 9}{576} - \\frac{17 \\cdot 8}{576} = \\frac{117 - 136}{576} = -\\frac{19}{576}\n$$\nConverting this fraction to a decimal gives:\n$$\n\\Delta \\approx -0.03298611...\n$$\nRounding to four significant figures, we get $-0.03299$.", "answer": "$$\n\\boxed{-0.03299}\n$$", "id": "4554327"}]}