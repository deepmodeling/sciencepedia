{"hands_on_practices": [{"introduction": "The Gaussian function is a cornerstone for modeling blur in imaging systems due to its mathematical simplicity and frequent appearance in physical processes. A critical skill is translating the abstract parameters of this model into tangible metrics of image quality. This first exercise [@problem_id:4892468] challenges you to derive the direct relationship between the standard deviation ($\\sigma$) of a Gaussian Point Spread Function (PSF) and its Full Width at Half Maximum (FWHM), the most common measure of spatial resolution.", "problem": "In a one-dimensional, linear and shift-invariant medical imaging system, the point spread function (PSF) is the impulse response that characterizes spatial blur. Suppose the point spread function (PSF) is Gaussian with standard deviation $\\sigma$, with functional form given by $h(x)=\\dfrac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\dfrac{x^{2}}{2\\sigma^{2}}\\right)$. The full width at half maximum (FWHM) of a nonnegative, symmetric function is defined as the distance between the two points at which the function attains one-half of its global maximum value.\n\nUsing only these definitions and elementary properties of the natural logarithm, derive an analytical expression for the full width at half maximum (FWHM) of this Gaussian point spread function (PSF) in terms of $\\sigma$. Then evaluate your expression for $\\sigma = 0.6$ millimeters. Express the final numerical result in millimeters and round your answer to four significant figures.", "solution": "We begin from the definition of the Gaussian point spread function (PSF) in one spatial dimension,\n$$\nh(x)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right).\n$$\nBy definition, the full width at half maximum (FWHM) of a nonnegative, symmetric function is the distance between the two points where the function equals one-half of its maximum value. The Gaussian $h(x)$ is even and attains its global maximum at $x=0$. Its maximum value is\n$$\nh(0)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}.\n$$\nLet $x_{1/2}>0$ denote the positive location where $h(x)$ equals half its maximum. The half-maximum condition is\n$$\nh(x_{1/2})=\\frac{1}{2}\\,h(0).\n$$\nSubstituting the explicit form of $h(x)$ and canceling the common normalization factor yields\n$$\n\\exp\\!\\left(-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}\\right)=\\frac{1}{2}.\n$$\nTaking the natural logarithm of both sides gives\n$$\n-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}=\\ln\\!\\left(\\frac{1}{2}\\right)=-\\ln(2),\n$$\nso that\n$$\nx_{1/2}^{2}=2\\sigma^{2}\\ln(2)\\quad\\Rightarrow\\quad x_{1/2}=\\sigma\\,\\sqrt{2\\ln(2)}.\n$$\nBecause the Gaussian is symmetric, the two half-maximum points are located at $x=\\pm x_{1/2}$, and therefore the full width at half maximum is the distance between these two points:\n$$\n\\mathrm{FWHM}=2\\,x_{1/2}=2\\,\\sigma\\,\\sqrt{2\\ln(2)}.\n$$\n\nTo evaluate this for a given standard deviation $\\sigma$, substitute $\\sigma=0.6$ millimeters:\n$$\n\\mathrm{FWHM}=2\\,(0.6)\\,\\sqrt{2\\ln(2)}\\ \\text{ millimeters}.\n$$\nCompute the dimensionless factor $\\sqrt{2\\ln(2)}$. Symbolically, leave constants intact until the final numerical evaluation. Using $\\ln(2)$ as the natural logarithm of $2$, we have\n$$\n\\mathrm{FWHM}=(1.2)\\,\\sqrt{2\\ln(2)}\\ \\text{ millimeters}.\n$$\nNumerically evaluating at the final step,\n$$\n\\sqrt{2\\ln(2)}\\approx 1.177410022,\\quad \\text{so}\\quad \\mathrm{FWHM}\\approx (1.2)\\times(1.177410022)=1.412892026\\ \\text{ millimeters}.\n$$\nRounding to four significant figures and expressing the value in millimeters as requested gives\n$$\n\\mathrm{FWHM}=1.413\\ \\text{ millimeters}.\n$$", "answer": "$$\\boxed{1.413}$$", "id": "4892468"}, {"introduction": "An imaging system's resolution is not an abstract property but a direct consequence of its physical design, such as the size of its detector elements. This practice [@problem_id:4555628] models a detector bin's spatial averaging effect as a simple rectangular PSF and asks you to explore its implications in the frequency domain. By deriving the Modulation Transfer Function (MTF), you will gain a fundamental understanding of how hardware limitations determine which spatial frequencies are preserved or lost in an image.", "problem": "In a radiomics workflow analyzing a one-dimensional line profile of a medical image acquired by a linear, shift-invariant detector, the finite width of each detector bin causes spatial averaging of the incoming signal. Model this averaging as the system’s point spread function (PSF), where the PSF is a rectangular function of width $\\Delta$ normalized to unit area. The modulation transfer function (MTF) is defined as the magnitude of the Fourier transform of the PSF. Assume the Fourier transform convention\n$$\nH(f) = \\int_{-\\infty}^{\\infty} h(x)\\,\\exp(-i\\,2\\pi f x)\\,dx,\n$$\nwhere $f$ is the spatial frequency in cycles per millimeter. Let the rectangular function be defined as\n$$\n\\mathrm{rect}(u) = \n\\begin{cases}\n1, & |u| \\leq \\tfrac{1}{2},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nStarting from the definitions of point spread function and Fourier transform, derive the analytic expression for the modulation transfer function $M(f) = |H(f)|$ for this detector model. Then, identify the smallest positive spatial frequency $f$ at which $M(f)$ is exactly zero (the first zero of the MTF), expressed in terms of $\\Delta$. Finally, evaluate this first zero frequency for a detector bin width of $\\Delta = 0.73\\,\\mathrm{mm}$.\n\nExpress the final frequency in cycles per millimeter and round your answer to four significant figures.", "solution": "First, we define the Point Spread Function (PSF) based on the problem description. The PSF, $h(x)$, is a rectangular function of width $\\Delta$, centered at the origin, and normalized to unit area. This can be expressed using the given $\\mathrm{rect}(u)$ function as:\n$$\nh(x) = \\frac{1}{\\Delta} \\mathrm{rect}\\left(\\frac{x}{\\Delta}\\right)\n$$\nThis function has a value of $1/\\Delta$ for $|x| \\leq \\Delta/2$ and is zero otherwise. Its integral is 1, as required.\n\nNext, we derive the transfer function $H(f)$ by taking the Fourier transform of the PSF:\n$$\nH(f) = \\int_{-\\infty}^{\\infty} h(x)\\,\\exp(-i\\,2\\pi f x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} \\frac{1}{\\Delta}\\,\\exp(-i\\,2\\pi f x)\\,dx\n$$\nPerforming the integration gives:\n$$\nH(f) = \\frac{1}{\\Delta} \\left[ \\frac{\\exp(-i\\,2\\pi f x)}{-i\\,2\\pi f} \\right]_{x=-\\Delta/2}^{x=\\Delta/2} = \\frac{1}{\\Delta(-i\\,2\\pi f)} \\left( e^{-i\\pi f \\Delta} - e^{i\\pi f \\Delta} \\right)\n$$\nUsing the Euler identity $\\sin(\\theta) = (e^{i\\theta} - e^{-i\\theta}) / (2i)$, this simplifies to:\n$$\nH(f) = \\frac{1}{\\pi f \\Delta} \\sin(\\pi f \\Delta)\n$$\nThis is commonly written using the normalized sinc function notation, $H(f) = \\mathrm{sinc}(f\\Delta)$.\n\nThe Modulation Transfer Function (MTF) is the magnitude of $H(f)$:\n$$\nM(f) = |H(f)| = \\left| \\frac{\\sin(\\pi f \\Delta)}{\\pi f \\Delta} \\right| = |\\mathrm{sinc}(f\\Delta)|\n$$\n\nTo find the first zero of the MTF, we seek the smallest positive frequency $f > 0$ where $M(f) = 0$. This occurs when the numerator, $\\sin(\\pi f \\Delta)$, is zero, provided the denominator is non-zero. The zeros of $\\sin(\\theta)$ are at $\\theta = n\\pi$ for any integer $n$. Thus:\n$$\n\\pi f \\Delta = n\\pi \\quad \\implies \\quad f = \\frac{n}{\\Delta}\n$$\nThe smallest positive frequency corresponds to $n=1$, so the first zero is at $f_{\\text{zero}} = \\frac{1}{\\Delta}$.\n\nFinally, we evaluate this frequency for the given detector bin width $\\Delta = 0.73\\,\\mathrm{mm}$:\n$$\nf_{\\text{zero}} = \\frac{1}{0.73\\,\\mathrm{mm}} \\approx 1.369863... \\,\\mathrm{cycles/mm}\n$$\nRounding to four significant figures gives:\n$$\nf_{\\text{zero}} \\approx 1.370 \\,\\mathrm{cycles/mm}\n$$", "answer": "$$\n\\boxed{1.370}\n$$", "id": "4555628"}, {"introduction": "The principles connecting the spatial and frequency domains are powerfully illustrated in Magnetic Resonance Imaging (MRI), where the image is reconstructed from data acquired in 'k-space' (the spatial frequency domain). This final exercise [@problem_id:4555686] explores how the finite extent of k-space sampling—a practical limitation in every MRI scan—dictates the form of the PSF in the final image. This provides a direct, practical link between the acquisition strategy and the ultimate spatial resolution.", "problem": "A key factor influencing quantitative feature stability in Radiomics is the spatial resolution of the imaging system, which is determined by the Point Spread Function (PSF). In Cartesian Magnetic Resonance Imaging (MRI), the image formation process is governed by the Fourier encoding of the object’s spin density. Consider a two-dimensional object whose spin density is modeled as a Dirac delta distribution at the spatial origin, and suppose the measurement in the spatial frequency domain (commonly called $k$-space) is limited to a finite, isotropic rectangular region.\n\nAssume the following:\n- The forward encoding follows the standard Fourier integral with spatial frequency variables $k_x$ and $k_y$ measured in cycles per meter, and the reconstruction uses the corresponding inverse Fourier integral.\n- The $k$-space sampling window $W(k_x,k_y)$ is defined as $W(k_x,k_y)=1$ for $|k_x|\\leq K/2$ and $|k_y|\\leq K/2$, and $W(k_x,k_y)=0$ otherwise, with $K>0$.\n- The reconstructed image for the delta object equals the PSF induced by the finite $k$-space support.\n\nStarting only from the Fourier encoding definitions, derive the exact functional form of the PSF in the image domain corresponding to the above finite rectangular $k$-space sampling. Then, define the “main-lobe width” along the $x$-axis as the distance, in the spatial domain, between the first two nonzero zeros of the PSF on either side of the origin when evaluated along $y=0$. Provide this main-lobe width as a closed-form expression in terms of $K$. Express your final answer in meters as a symbolic expression. No numerical approximation is required.", "solution": "The problem asks for the derivation of the Point Spread Function (PSF) for a magnetic resonance imaging (MRI) system with a finite rectangular sampling of the spatial frequency domain ($k$-space), and for the calculation of the main-lobe width of this PSF.\n\nThe object is described as a Dirac delta distribution at the spatial origin. Its spin density function $\\rho(x,y)$ is therefore given by:\n$$\n\\rho(x,y) = \\delta(x,y)\n$$\nThe signal in $k$-space, $S(k_x, k_y)$, is the two-dimensional Fourier transform of the object's spin density. The forward Fourier transform is defined as:\n$$\nS(k_x, k_y) = \\mathcal{F}\\{\\rho(x,y)\\} = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\rho(x,y) \\exp(-i 2\\pi (k_x x + k_y y)) \\,dx\\,dy\n$$\nSubstituting $\\rho(x,y) = \\delta(x,y)$ and using the sifting property of the Dirac delta function, the true $k$-space signal $S_{\\text{true}}(k_x, k_y)$ is:\n$$\nS_{\\text{true}}(k_x, k_y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\delta(x,y) \\exp(-i 2\\pi (k_x x + k_y y)) \\,dx\\,dy = \\exp(-i 2\\pi (k_x \\cdot 0 + k_y \\cdot 0)) = 1\n$$\nThe signal is constant and equal to $1$ across the entire $k$-space.\n\nThe problem states that the measurement is limited to a finite rectangular region defined by the sampling window $W(k_x, k_y)$, where:\n$$\nW(k_x, k_y) =\n\\begin{cases}\n1 & \\text{if } |k_x| \\leq \\frac{K}{2} \\text{ and } |k_y| \\leq \\frac{K}{2} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThe measured $k$-space signal, $S_{\\text{meas}}(k_x, k_y)$, is the product of the true signal and the window function:\n$$\nS_{\\text{meas}}(k_x, k_y) = S_{\\text{true}}(k_x, k_y) \\cdot W(k_x, k_y) = 1 \\cdot W(k_x, k_y) = W(k_x, k_y)\n$$\nThe reconstructed image is the inverse Fourier transform of the measured $k$-space signal. For a delta object, this reconstructed image is, by definition, the system's PSF.\n$$\n\\text{PSF}(x,y) = \\mathcal{F}^{-1}\\{S_{\\text{meas}}(k_x, k_y)\\} = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} S_{\\text{meas}}(k_x, k_y) \\exp(i 2\\pi (k_x x + k_y y)) \\,dk_x\\,dk_y\n$$\nSubstituting the expression for $S_{\\text{meas}}(k_x, k_y)$ and applying the limits of the window function, the integral becomes:\n$$\n\\text{PSF}(x,y) = \\int_{-K/2}^{K/2} \\int_{-K/2}^{K/2} 1 \\cdot \\exp(i 2\\pi (k_x x + k_y y)) \\,dk_x\\,dk_y\n$$\nThe integral is separable with respect to $k_x$ and $k_y$:\n$$\n\\text{PSF}(x,y) = \\left( \\int_{-K/2}^{K/2} \\exp(i 2\\pi k_x x) \\,dk_x \\right) \\left( \\int_{-K/2}^{K/2} \\exp(i 2\\pi k_y y) \\,dk_y \\right)\n$$\nLet us evaluate the integral with respect to $k_x$. For $x \\neq 0$:\n$$\n\\int_{-K/2}^{K/2} \\exp(i 2\\pi k_x x) \\,dk_x = \\left[ \\frac{\\exp(i 2\\pi k_x x)}{i 2\\pi x} \\right]_{k_x=-K/2}^{k_x=K/2}\n$$\n$$\n= \\frac{\\exp(i 2\\pi (K/2) x) - \\exp(-i 2\\pi (K/2) x)}{i 2\\pi x} = \\frac{\\exp(i \\pi K x) - \\exp(-i \\pi K x)}{i 2\\pi x}\n$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, the expression simplifies to:\n$$\n= \\frac{2i \\sin(\\pi K x)}{i 2\\pi x} = \\frac{\\sin(\\pi K x)}{\\pi x}\n$$\nFor the case where $x = 0$, the integral is $\\int_{-K/2}^{K/2} 1 \\,dk_x = K$. This result is consistent with the limit of the derived expression as $x \\to 0$:\n$$\n\\lim_{x \\to 0} \\frac{\\sin(\\pi K x)}{\\pi x} = \\lim_{x \\to 0} \\frac{\\pi K \\cos(\\pi K x)}{\\pi} = K\n$$\nBy symmetry, the integral with respect to $k_y$ yields an analogous result, $\\frac{\\sin(\\pi K y)}{\\pi y}$.\n\nTherefore, the functional form of the PSF is the product of these two terms:\n$$\n\\text{PSF}(x,y) = \\left( \\frac{\\sin(\\pi K x)}{\\pi x} \\right) \\left( \\frac{\\sin(\\pi K y)}{\\pi y} \\right)\n$$\nThis is the first part of the required answer. This function is a two-dimensional sinc function.\n\nNext, we must find the main-lobe width along the $x$-axis. This requires evaluating the PSF along the line $y=0$.\n$$\n\\text{PSF}(x,0) = \\left( \\frac{\\sin(\\pi K x)}{\\pi x} \\right) \\lim_{y \\to 0} \\left( \\frac{\\sin(\\pi K y)}{\\pi y} \\right)\n$$\nAs established previously, the limit is $K$. Thus, the PSF profile along the $x$-axis is:\n$$\n\\text{PSF}(x,0) = K \\frac{\\sin(\\pi K x)}{\\pi x}\n$$\nThe main-lobe width is defined as the distance between the first two nonzero zeros of the PSF on either side of the origin. The zeros of $\\text{PSF}(x,0)$ occur when the numerator, $\\sin(\\pi K x)$, is zero, and the denominator, $\\pi x$, is non-zero. The condition $\\sin(\\theta)=0$ is met when $\\theta = n\\pi$ for any integer $n$.\n$$\n\\pi K x = n\\pi \\quad \\implies \\quad Kx = n \\quad \\implies \\quad x = \\frac{n}{K}\n$$\nWe are interested in nonzero zeros, so $n \\neq 0$. The first zero on the positive side of the origin corresponds to $n=1$, which gives $x_1 = \\frac{1}{K}$. The first zero on the negative side of the origin corresponds to $n=-1$, which gives $x_{-1} = -\\frac{1}{K}$.\n\nThe main-lobe width, $W_{ML}$, is the distance between these two points:\n$$\nW_{ML} = x_1 - x_{-1} = \\frac{1}{K} - \\left(-\\frac{1}{K}\\right) = \\frac{1}{K} + \\frac{1}{K} = \\frac{2}{K}\n$$\nThe spatial frequency $K$ is given in units of cycles per meter, so the width $W_{ML}$ has units of meters, as required.", "answer": "$$\\boxed{\\frac{2}{K}}$$", "id": "4555686"}]}