{"hands_on_practices": [{"introduction": "An imaging system's spatial resolution is fundamentally described by its Point Spread Function (PSF), which characterizes the blur applied to an ideal point source. To make this concept practical, we often distill the complex PSF into a single, intuitive number. This exercise [@problem_id:4561121] guides you through the derivation of the Full Width at Half Maximum (FWHM), a ubiquitous metric for resolution, from a Gaussian PSF model, cementing the mathematical link between system blur and its quantitative summary.", "problem": "In radiomics, the spatial resolution of an imaging system is commonly characterized by its Point Spread Function (PSF), which models blur introduced by the acquisition and reconstruction process. For many medical imaging systems such as Computed Tomography (CT) and Magnetic Resonance Imaging (MRI), the PSF can be approximated by a one-dimensional Gaussian function. Consider the Gaussian PSF defined by $PSF(x)=\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)$, where $\\sigma$ is the standard deviation that sets the spatial scale of blurring. The Full Width at Half Maximum (FWHM) is defined as the distance between the two points $x_{-}$ and $x_{+}$ where the PSF attains half of its maximum value, that is, $PSF(x_{\\pm})=\\frac{1}{2}PSF(0)$, and the FWHM equals $x_{+}-x_{-}$. Starting from these definitions and the properties of the exponential and natural logarithm, derive a closed-form analytic expression for the FWHM in terms of $\\sigma$ and known constants. Assume $\\sigma$ is specified in millimeters; express the final width in millimeters. Provide your final answer as a single analytic expression; no numerical rounding is required.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n### Step 1: Extract Givens\n- The Point Spread Function (PSF) is given by the one-dimensional Gaussian function: $PSF(x)=\\exp\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)$.\n- $\\sigma$ is the standard deviation.\n- The Full Width at Half Maximum (FWHM) is defined as the distance $x_{+} - x_{-}$.\n- The points $x_{\\pm}$ are defined by the condition $PSF(x_{\\pm}) = \\frac{1}{2}PSF(0)$.\n- The parameter $\\sigma$ has units of millimeters.\n- The final expression for FWHM must be in millimeters.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem uses a standard Gaussian model for a PSF and the standard definition of FWHM, both of which are fundamental concepts in signal processing and medical imaging. The premises are factually and scientifically sound.\n- **Well-Posed**: The problem is clearly stated with all necessary definitions and constraints. A unique, meaningful solution can be derived through standard mathematical procedures. The problem is not ambiguous or ill-posed.\n- **Objective**: The language is precise and quantitative, free of subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A rigorous derivation of the solution can proceed.\n\n### Derivation\nThe derivation begins with the provided definition of the Point Spread Function (PSF), which is a Gaussian function centered at $x=0$:\n$$PSF(x) = \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\nThe maximum value of the PSF is required to apply the definition of the Full Width at Half Maximum (FWHM). The exponential function, $\\exp(u)$, is monotonically increasing with its argument $u$. The argument in the PSF expression is $-\\frac{x^2}{2\\sigma^2}$. Since $\\sigma^2 > 0$ and $x^2 \\geq 0$, the argument is always non-positive. Its maximum value is $0$, which occurs when $x=0$. Therefore, the maximum value of the PSF is at $x=0$:\n$$PSF_{max} = PSF(0) = \\exp\\left(-\\frac{0^2}{2\\sigma^2}\\right) = \\exp(0) = 1$$\nThe FWHM is the distance between the two points, $x_{-}$ and $x_{+}$, where the function's value is half of its maximum. The condition for these points is thus:\n$$PSF(x_{\\pm}) = \\frac{1}{2} PSF_{max} = \\frac{1}{2}(1) = \\frac{1}{2}$$\nWe substitute the expression for the PSF into this condition to find the equation for $x_{\\pm}$:\n$$\\exp\\left(-\\frac{x_{\\pm}^2}{2\\sigma^2}\\right) = \\frac{1}{2}$$\nTo solve for $x_{\\pm}$, we first take the natural logarithm ($\\ln$) of both sides of the equation:\n$$\\ln\\left[\\exp\\left(-\\frac{x_{\\pm}^2}{2\\sigma^2}\\right)\\right] = \\ln\\left(\\frac{1}{2}\\right)$$\nUsing the fundamental property of logarithms that $\\ln(\\exp(u)) = u$, the left side simplifies to:\n$$-\\frac{x_{\\pm}^2}{2\\sigma^2} = \\ln\\left(\\frac{1}{2}\\right)$$\nUsing the logarithm property $\\ln(1/a) = -\\ln(a)$, the right side of the equation can be rewritten as:\n$$-\\frac{x_{\\pm}^2}{2\\sigma^2} = -\\ln(2)$$\nMultiplying both sides by $-1$ gives:\n$$\\frac{x_{\\pm}^2}{2\\sigma^2} = \\ln(2)$$\nNow, we isolate $x_{\\pm}^2$ by multiplying both sides by $2\\sigma^2$:\n$$x_{\\pm}^2 = 2\\sigma^2\\ln(2)$$\nTaking the square root of both sides yields the two solutions for the positions $x_{\\pm}$:\n$$x_{\\pm} = \\pm\\sqrt{2\\sigma^2\\ln(2)} = \\pm\\sigma\\sqrt{2\\ln(2)}$$\nBy convention, we assign the positive root to $x_{+}$ and the negative root to $x_{-}$:\n$$x_{+} = \\sigma\\sqrt{2\\ln(2)}$$\n$$x_{-} = -\\sigma\\sqrt{2\\ln(2)}$$\nThe FWHM is defined as the distance between these two points, $FWHM = x_{+} - x_{-}$. Substituting the expressions for $x_{+}$ and $x_{-}$ gives:\n$$FWHM = \\left(\\sigma\\sqrt{2\\ln(2)}\\right) - \\left(-\\sigma\\sqrt{2\\ln(2)}\\right)$$\n$$FWHM = \\sigma\\sqrt{2\\ln(2)} + \\sigma\\sqrt{2\\ln(2)}$$\nCombining the terms yields the final closed-form analytic expression for the FWHM:\n$$FWHM = 2\\sigma\\sqrt{2\\ln(2)}$$\nThe constant part of this expression, $2\\sqrt{2\\ln(2)}$, is a dimensionless number. Since $\\sigma$ is specified in units of millimeters, the FWHM will also be in millimeters, satisfying the problem's requirement.", "answer": "$$\\boxed{2\\sigma\\sqrt{2\\ln(2)}}$$", "id": "4561121"}, {"introduction": "Moving from the continuous model of a PSF to the discrete world of digital images introduces the concept of sampling. The size of an image's voxels determines the finest details it can faithfully represent. This practice [@problem_id:4561033] applies the foundational Nyquist-Shannon sampling theorem to a realistic medical imaging scenario with anisotropic voxels, teaching you how to calculate the Nyquist limit and predict when insufficient sampling will cause aliasing artifacts, which can distort features and mislead interpretation.", "problem": "A three-dimensional medical image intended for downstream radiomics feature extraction is acquired with isotropic in-plane voxel spacing of $1.5\\,\\mathrm{mm}$ in the $x$ and $y$ directions, and a through-plane slice spacing of $5\\,\\mathrm{mm}$ in the $z$ direction. A lesion within the image exhibits fine trabecular structure whose dominant spatial period is approximately $0.4\\,\\mathrm{mm}$ and is assumed to be isotropic. Starting from the spatial sampling theorem, treat sampling separately in each Cartesian dimension, define the spatial sampling frequency from the voxel spacing, and then define the Nyquist frequency accordingly. Use these results to determine whether the trabecular structure will alias in each direction by comparing the structureâ€™s spatial frequency to the Nyquist limit in that direction.\n\nCompute the Nyquist frequency in cycles per millimeter for each of the $x$, $y$, and $z$ dimensions and decide, for each dimension, whether aliasing is expected ($1$) or not expected ($0$). Express your final answer as a single row matrix in the form $(f_{N,x}\\;\\;f_{N,y}\\;\\;f_{N,z}\\;\\;A_{x}\\;\\;A_{y}\\;\\;A_{z})$, where $f_{N,i}$ are the Nyquist frequencies in $\\mathrm{mm}^{-1}$ and $A_{i}\\in\\{0,1\\}$ are the aliasing indicators for $i\\in\\{x,y,z\\}$. Round each Nyquist frequency to four significant figures. Do not include units inside the final boxed matrix; all Nyquist frequencies must be understood as cycles per millimeter.", "solution": "The problem is first subjected to validation.\n\n### Step 1: Extract Givens\nThe following data and conditions are provided in the problem statement:\n- In-plane voxel spacing in the $x$ direction: $\\Delta x = 1.5\\,\\mathrm{mm}$\n- In-plane voxel spacing in the $y$ direction: $\\Delta y = 1.5\\,\\mathrm{mm}$\n- Through-plane slice spacing in the $z$ direction: $\\Delta z = 5\\,\\mathrm{mm}$\n- Dominant spatial period of the trabecular structure: $T_{lesion} = 0.4\\,\\mathrm{mm}$\n- The structure is assumed to be isotropic.\n- The task is to compute the Nyquist frequencies $f_{N,x}$, $f_{N,y}$, $f_{N,z}$ in cycles per millimeter, rounded to four significant figures.\n- The task is to determine the aliasing indicator $A_i \\in \\{0, 1\\}$ for each dimension $i \\in \\{x, y, z\\}$, where $1$ indicates aliasing is expected and $0$ indicates it is not.\n- The final answer must be a single row matrix: $\\begin{pmatrix} f_{N,x}  f_{N,y}  f_{N,z}  A_{x}  A_{y}  A_{z} \\end{pmatrix}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the Shannon-Nyquist sampling theorem, a cornerstone of signal processing, and its direct application to digital imaging. The provided physical dimensions for voxel spacing and anatomical structures are realistic for medical imaging modalities such as Computed Tomography (CT) or Magnetic Resonance Imaging (MRI). The problem is free of pseudoscience.\n- **Well-Posed:** The problem is self-contained, providing all necessary information. The requested calculations follow a clear, logical path from the given data to a unique solution.\n- **Objective:** The problem is stated using precise, unambiguous technical language.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and objective. A complete solution will be provided.\n\nThe core principle for this problem is the Shannon-Nyquist sampling theorem. In the context of spatial sampling, the theorem states that to perfectly reconstruct a signal, the sampling frequency must be strictly greater than twice the highest frequency component present in the signal. The Nyquist frequency, or Nyquist limit, is defined as half the sampling frequency. If a signal contains frequencies higher than the Nyquist frequency, those frequencies will be incorrectly represented as lower frequencies in the sampled data, a phenomenon known as aliasing.\n\nThe sampling interval in a given spatial dimension $i$ is the voxel spacing, $\\Delta i$. The spatial sampling frequency, $f_{s,i}$, is the reciprocal of the sampling interval:\n$$f_{s,i} = \\frac{1}{\\Delta i}$$\nThe Nyquist frequency, $f_{N,i}$, is half of the sampling frequency:\n$$f_{N,i} = \\frac{f_{s,i}}{2} = \\frac{1}{2\\Delta i}$$\nAliasing occurs if the spatial frequency of the signal, $f_{signal}$, is greater than the Nyquist frequency, i.e., $f_{signal}  f_{N,i}$.\n\nFirst, we determine the spatial frequency of the trabecular structure. The problem gives its dominant spatial period, $T_{lesion} = 0.4\\,\\mathrm{mm}$. The spatial frequency, $f_{lesion}$, is the reciprocal of the period:\n$$f_{lesion} = \\frac{1}{T_{lesion}} = \\frac{1}{0.4\\,\\mathrm{mm}} = 2.5\\,\\mathrm{mm}^{-1}$$\nSince the structure is isotropic, this spatial frequency applies in all directions.\n\nNow, we analyze each dimension separately.\n\n**For the $x$ direction:**\nThe sampling interval is the voxel spacing $\\Delta x = 1.5\\,\\mathrm{mm}$.\nThe spatial sampling frequency is:\n$$f_{s,x} = \\frac{1}{\\Delta x} = \\frac{1}{1.5\\,\\mathrm{mm}} = \\frac{2}{3}\\,\\mathrm{mm}^{-1}$$\nThe Nyquist frequency is:\n$$f_{N,x} = \\frac{1}{2\\Delta x} = \\frac{1}{2 \\times 1.5\\,\\mathrm{mm}} = \\frac{1}{3}\\,\\mathrm{mm}^{-1} \\approx 0.33333...\\,\\mathrm{mm}^{-1}$$\nComparing the lesion's frequency to the Nyquist frequency:\n$$f_{lesion} = 2.5\\,\\mathrm{mm}^{-1}$$\n$$f_{N,x} \\approx 0.3333\\,\\mathrm{mm}^{-1}$$\nSince $f_{lesion}  f_{N,x}$ ($2.5  1/3$), aliasing is expected in the $x$ direction. Thus, the aliasing indicator is $A_x = 1$.\nRounding to four significant figures, $f_{N,x} = 0.3333\\,\\mathrm{mm}^{-1}$.\n\n**For the $y$ direction:**\nThe sampling interval is the voxel spacing $\\Delta y = 1.5\\,\\mathrm{mm}$. This is identical to the $x$ direction.\nTherefore, the Nyquist frequency is the same:\n$$f_{N,y} = f_{N,x} = \\frac{1}{3}\\,\\mathrm{mm}^{-1} \\approx 0.3333\\,\\mathrm{mm}^{-1}$$\nComparing the lesion's frequency to the Nyquist frequency:\n$$f_{lesion} = 2.5\\,\\mathrm{mm}^{-1}  f_{N,y} \\approx 0.3333\\,\\mathrm{mm}^{-1}$$\nAliasing is also expected in the $y$ direction. The aliasing indicator is $A_y = 1$.\nRounding to four significant figures, $f_{N,y} = 0.3333\\,\\mathrm{mm}^{-1}$.\n\n**For the $z$ direction:**\nThe sampling interval is the slice spacing $\\Delta z = 5\\,\\mathrm{mm}$.\nThe spatial sampling frequency is:\n$$f_{s,z} = \\frac{1}{\\Delta z} = \\frac{1}{5\\,\\mathrm{mm}} = 0.2\\,\\mathrm{mm}^{-1}$$\nThe Nyquist frequency is:\n$$f_{N,z} = \\frac{1}{2\\Delta z} = \\frac{1}{2 \\times 5\\,\\mathrm{mm}} = \\frac{1}{10\\,\\mathrm{mm}} = 0.1\\,\\mathrm{mm}^{-1}$$\nComparing the lesion's frequency to the Nyquist frequency:\n$$f_{lesion} = 2.5\\,\\mathrm{mm}^{-1}$$\n$$f_{N,z} = 0.1\\,\\mathrm{mm}^{-1}$$\nSince $f_{lesion}  f_{N,z}$ ($2.5  0.1$), aliasing is also expected in the $z$ direction. The aliasing indicator is $A_z = 1$.\nThe value $0.1$ written to four significant figures is $0.1000$. Thus, $f_{N,z} = 0.1000\\,\\mathrm{mm}^{-1}$.\n\nIn conclusion, the fine trabecular structure is undersampled in all three dimensions, leading to aliasing artifacts in the reconstructed image. The Nyquist frequencies and aliasing indicators are:\n$f_{N,x} \\approx 0.3333\\,\\mathrm{mm}^{-1}$, $A_x = 1$\n$f_{N,y} \\approx 0.3333\\,\\mathrm{mm}^{-1}$, $A_y = 1$\n$f_{N,z} = 0.1000\\,\\mathrm{mm}^{-1}$, $A_z = 1$\n\nThese results are collected into the required row matrix format for the final answer.", "answer": "$$\\boxed{\\begin{pmatrix} 0.3333  0.3333  0.1000  1  1  1 \\end{pmatrix}}$$", "id": "4561033"}, {"introduction": "The ultimate concern for a radiomics practitioner is how physical imaging limitations affect quantitative measurements. Finite spatial resolution leads to the 'partial volume effect,' where a single voxel averages the signal from multiple underlying tissue types, corrupting the measured intensity. This exercise [@problem_id:4561112] provides a model for this effect, allowing you to derive the resulting bias in a simple radiomic feature and understand how measurement accuracy is fundamentally linked to resolution and tissue contrast.", "problem": "Consider a static medical imaging experiment, such as computed tomography (CT) or magnetic resonance imaging (MRI), where the modality measures a scalar intensity field $I(\\mathbf{r},t)$ that does not change over the acquisition window, so $I(\\mathbf{r},t)=I(\\mathbf{r})$. The detector response at a voxel centered at position $\\mathbf{r}_0$ is modeled by a spatial Point Spread Function (PSF), denoted $p(\\mathbf{r})$, which is nonnegative and normalized so that $\\int_{\\mathbb{R}^3} p(\\mathbf{r})\\,\\mathrm{d}^3 r = 1$. The measured voxel intensity is the spatially weighted average\n$$\nM(\\mathbf{r}_0) = \\int_{\\mathbb{R}^3} p(\\mathbf{r}-\\mathbf{r}_0)\\, I(\\mathbf{r})\\, \\mathrm{d}^3 r.\n$$\nSuppose the voxel straddles exactly two homogeneous compartments within the support of $p$, with constant intensities $I_1$ and $I_2$. Let $f \\in [0,1]$ denote the PSF-weighted fraction of the voxel volume occupied by the compartment with intensity $I_1$, so that the complementary fraction $1-f$ is occupied by the compartment with intensity $I_2$. That is, the integral of $p(\\mathbf{r}-\\mathbf{r}_0)$ over the $I_1$ compartment yields $f$ and over the $I_2$ compartment yields $1-f$.\n\nA common first-order radiomic feature is the mean intensity of a region of interest (ROI). If one intends the ROI to represent the $I_1$ compartment but the ROI includes this single mixed voxel, then the measured contribution of this voxel to the ROI mean is $M(\\mathbf{r}_0)$, whereas the ideal contribution (under perfect spatial resolution) would be $I_1$. Define the bias in the radiomic feature mean intensity, due to finite spatial resolution and partial volume effects, as\n$$\nb(f) = M(\\mathbf{r}_0) - I_1.\n$$\n\nStarting from the given detector model and definitions, derive a closed-form expression for $M(\\mathbf{r}_0)$ in terms of $f$, $I_1$, and $I_2$, and then derive $b(f)$ explicitly. Briefly analyze how $b(f)$ depends on $f$ and on the contrast $I_2 - I_1$, identifying the value(s) of $f$ at which the bias vanishes and the value(s) at which the magnitude of the bias is largest.\n\nReport the bias $b(f)$ as a single closed-form analytic expression in terms of $f$, $I_1$, and $I_2$. Do not substitute numerical values. No units are required in the final expression.", "solution": "The problem requires the derivation of a closed-form expression for the bias in the mean intensity, a first-order radiomic feature, due to partial volume effects in a static medical imaging experiment. We must start from the provided definitions and model.\n\nThe measured voxel intensity at a position $\\mathbf{r}_0$ is given by the convolution of the true intensity field $I(\\mathbf{r})$ with the point spread function (PSF) $p(\\mathbf{r})$:\n$$\nM(\\mathbf{r}_0) = \\int_{\\mathbb{R}^3} p(\\mathbf{r}-\\mathbf{r}_0)\\, I(\\mathbf{r})\\, \\mathrm{d}^3 r\n$$\nThe problem states that the voxel straddles two homogeneous compartments with constant intensities $I_1$ and $I_2$. Let the regions corresponding to these compartments be $C_1$ and $C_2$. The intensity field is thus piecewise constant: $I(\\mathbf{r}) = I_1$ for $\\mathbf{r} \\in C_1$ and $I(\\mathbf{r}) = I_2$ for $\\mathbf{r} \\in C_2$. The integral for $M(\\mathbf{r}_0)$ can be split over these two regions. Since the PSF is normalized such that $\\int p(\\mathbf{r}) d^3r = 1$ and the problem states the two compartments are the only ones within the support of the PSF, we can write:\n$$\nM(\\mathbf{r}_0) = \\int_{C_1} p(\\mathbf{r}-\\mathbf{r}_0)\\, I(\\mathbf{r})\\, \\mathrm{d}^3 r + \\int_{C_2} p(\\mathbf{r}-\\mathbf{r}_0)\\, I(\\mathbf{r})\\, \\mathrm{d}^3 r\n$$\nSubstituting the constant intensity values for each region:\n$$\nM(\\mathbf{r}_0) = \\int_{C_1} p(\\mathbf{r}-\\mathbf{r}_0)\\, I_1\\, \\mathrm{d}^3 r + \\int_{C_2} p(\\mathbf{r}-\\mathbf{r}_0)\\, I_2\\, \\mathrm{d}^3 r\n$$\nSince $I_1$ and $I_2$ are constants, they can be factored out of their respective integrals:\n$$\nM(\\mathbf{r}_0) = I_1 \\int_{C_1} p(\\mathbf{r}-\\mathbf{r}_0)\\, \\mathrm{d}^3 r + I_2 \\int_{C_2} p(\\mathbf{r}-\\mathbf{r}_0)\\, \\mathrm{d}^3 r\n$$\nThe problem defines $f \\in [0,1]$ as the PSF-weighted fraction of the voxel volume occupied by the compartment with intensity $I_1$. This corresponds to the first integral:\n$$\nf = \\int_{C_1} p(\\mathbf{r}-\\mathbf{r}_0)\\, \\mathrm{d}^3 r\n$$\nSimilarly, the complementary fraction for the compartment with intensity $I_2$ is $1-f$:\n$$\n1-f = \\int_{C_2} p(\\mathbf{r}-\\mathbf{r}_0)\\, \\mathrm{d}^3 r\n$$\nSubstituting these definitions into the expression for $M(\\mathbf{r}_0)$ yields the closed-form expression for the measured intensity:\n$$\nM(\\mathbf{r}_0) = I_1 f + I_2 (1-f)\n$$\nThis equation shows that the measured intensity is a linear interpolation of the two pure intensities, weighted by their respective PSF-convolved volume fractions.\n\nNext, we derive the bias, $b(f)$, which is defined as the difference between the measured intensity $M(\\mathbf{r}_0)$ and the ideal intensity $I_1$:\n$$\nb(f) = M(\\mathbf{r}_0) - I_1\n$$\nSubstituting the derived expression for $M(\\mathbf{r}_0)$:\n$$\nb(f) = \\left( I_1 f + I_2 (1-f) \\right) - I_1\n$$\nWe simplify this expression algebraically:\n$$\nb(f) = I_1 f + I_2 - I_2 f - I_1\n$$\nGrouping terms with $I_1$ and $I_2$:\n$$\nb(f) = (I_2 - I_1) - (I_2 f - I_1 f)\n$$\nFactoring out the common term $(I_2 - I_1)$:\n$$\nb(f) = (I_2 - I_1) - f(I_2 - I_1)\n$$\nThis gives the final expression for the bias:\n$$\nb(f) = (1-f)(I_2 - I_1)\n$$\nTo analyze this result, we note that the bias $b(f)$ is a linear function of $f$ and is directly proportional to the contrast between the two compartments, $I_2 - I_1$.\nThe bias vanishes, $b(f) = 0$, when either $(1-f) = 0$ or $(I_2 - I_1) = 0$. The latter case is trivial (no contrast, no bias). The former case, $f=1$, means the voxel's signal content originates entirely from the compartment of interest, so the measurement is uncontaminated and thus unbiased.\nThe magnitude of the bias, $|b(f)| = |(1-f)(I_2 - I_1)| = (1-f)|I_2 - I_1|$ (since $f \\in [0,1]$), is maximized when $f$ is minimized. The minimum value of $f$ is $0$. At $f=0$, the bias is $b(0) = (1-0)(I_2 - I_1) = I_2 - I_1$. This corresponds to the case where the voxel's signal content originates entirely from the contaminating compartment, leading to the maximal measurement error.", "answer": "$$\\boxed{(1-f)(I_2 - I_1)}$$", "id": "4561112"}]}