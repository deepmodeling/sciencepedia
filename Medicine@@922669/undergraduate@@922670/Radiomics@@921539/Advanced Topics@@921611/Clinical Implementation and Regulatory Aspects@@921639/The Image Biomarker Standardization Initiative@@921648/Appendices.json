{"hands_on_practices": [{"introduction": "Before we can analyze the intricate textures within a medical image, we often start with the basics: the shape and size of the region of interest (ROI). Morphological features provide this fundamental characterization. This practice focuses on a key shape descriptor, sphericity, which quantifies how closely the shape of an ROI resembles a perfect sphere, a measure that can have important biological implications. By calculating volume, surface area, and sphericity for a simple geometric object, you will gain a concrete understanding of how these IBSI-compliant features are derived from first principles [@problem_id:4567092].", "problem": "A three-dimensional region of interest (ROI) from a medical image is segmented as an axis-aligned rectangular cuboid with edge lengths $3\\,\\mathrm{mm}$, $3\\,\\mathrm{mm}$, and $4\\,\\mathrm{mm}$. Under the Image Biomarker Standardization Initiative (IBSI) framework for morphological features, treat the ROI as a continuous geometric cuboid (ignore voxelization and partial volume effects) and determine:\n- the volume $V$ in $\\mathrm{mm}^3$,\n- the surface area $A$ in $\\mathrm{mm}^2$,\n- and the sphericity as defined by IBSI (a dimensionless quantity equal to the ratio of the surface area of a sphere with the same volume $V$ to the surface area $A$ of the ROI).\n\nCompute all quantities from first principles of Euclidean geometry and the IBSI definition of sphericity. Report the sphericity as a dimensionless decimal rounded to four significant figures. Only the sphericity should be given as your final boxed answer.", "solution": "The problem requires the calculation of the volume $V$, surface area $A$, and sphericity $\\Psi$ for a rectangular cuboid with specified edge lengths. The calculations will proceed from first principles.\n\nThe given edge lengths of the rectangular cuboid are $l_1 = 3\\,\\mathrm{mm}$, $l_2 = 3\\,\\mathrm{mm}$, and $l_3 = 4\\,\\mathrm{mm}$.\n\nFirst, we calculate the volume $V$ of the cuboid. The volume of a rectangular cuboid is the product of its three edge lengths.\n$$V = l_1 \\cdot l_2 \\cdot l_3$$\nSubstituting the given values:\n$$V = (3\\,\\mathrm{mm}) \\cdot (3\\,\\mathrm{mm}) \\cdot (4\\,\\mathrm{mm}) = 36\\,\\mathrm{mm}^3$$\n\nNext, we calculate the total surface area $A$ of the cuboid. The surface area is the sum of the areas of its six faces. For a rectangular cuboid, there are three pairs of identical faces.\n$$A = 2(l_1 l_2 + l_1 l_3 + l_2 l_3)$$\nSubstituting the given values:\n$$A = 2((3\\,\\mathrm{mm} \\cdot 3\\,\\mathrm{mm}) + (3\\,\\mathrm{mm} \\cdot 4\\,\\mathrm{mm}) + (3\\,\\mathrm{mm} \\cdot 4\\,\\mathrm{mm}))$$\n$$A = 2(9\\,\\mathrm{mm}^2 + 12\\,\\mathrm{mm}^2 + 12\\,\\mathrm{mm}^2)$$\n$$A = 2(33\\,\\mathrm{mm}^2) = 66\\,\\mathrm{mm}^2$$\n\nThe problem defines sphericity $\\Psi$ as the ratio of the surface area of a sphere with the same volume $V$ to the surface area $A$ of the cuboid itself. Let this sphere have radius $r$ and surface area $A_{\\text{sphere}}$.\n$$\\Psi = \\frac{A_{\\text{sphere}}}{A}$$\nThe volume of a sphere is given by the formula:\n$$V_{\\text{sphere}} = \\frac{4}{3}\\pi r^3$$\nWe require the sphere to have the same volume as the cuboid, so $V_{\\text{sphere}} = V = 36\\,\\mathrm{mm}^3$. We can solve for the radius $r$ of this sphere.\n$$\\frac{4}{3}\\pi r^3 = 36\\,\\mathrm{mm}^3$$\n$$r^3 = \\frac{3 \\cdot 36}{4\\pi}\\,\\mathrm{mm}^3 = \\frac{108}{4\\pi}\\,\\mathrm{mm}^3 = \\frac{27}{\\pi}\\,\\mathrm{mm}^3$$\n$$r = \\left(\\frac{27}{\\pi}\\right)^{1/3}\\,\\mathrm{mm} = \\frac{3}{\\pi^{1/3}}\\,\\mathrm{mm}$$\nThe surface area of this sphere is given by the formula:\n$$A_{\\text{sphere}} = 4\\pi r^2$$\nSubstituting the expression for $r$:\n$$A_{\\text{sphere}} = 4\\pi \\left(\\frac{3}{\\pi^{1/3}}\\,\\mathrm{mm}\\right)^2 = 4\\pi \\left(\\frac{9}{\\pi^{2/3}}\\right)\\,\\mathrm{mm}^2 = 36\\pi^{1 - 2/3}\\,\\mathrm{mm}^2 = 36\\pi^{1/3}\\,\\mathrm{mm}^2$$\nNow, we can compute the sphericity $\\Psi$ using its definition:\n$$\\Psi = \\frac{A_{\\text{sphere}}}{A} = \\frac{36\\pi^{1/3}\\,\\mathrm{mm}^2}{66\\,\\mathrm{mm}^2}$$\nThe units cancel, confirming that sphericity is a dimensionless quantity, as expected.\n$$\\Psi = \\frac{36}{66}\\pi^{1/3} = \\frac{6}{11}\\pi^{1/3}$$\nTo provide the final answer as a decimal rounded to four significant figures, we compute the numerical value:\n$$\\Psi \\approx \\frac{6}{11} \\cdot (3.14159265...)^{1/3}$$\n$$\\Psi \\approx 0.545454... \\cdot 1.46459188...$$\n$$\\Psi \\approx 0.7988683...$$\nRounding to four significant figures, we get:\n$$\\Psi \\approx 0.7989$$", "answer": "$$\\boxed{0.7989}$$", "id": "4567092"}, {"introduction": "Moving beyond the external shape, first-order statistical features describe the distribution of voxel intensities within the ROI, without considering their spatial arrangement. These features are derived from the intensity histogram, which acts as a statistical \"fingerprint\" of the region. This exercise will guide you in calculating two of the most fundamental histogram-based features defined by IBSI: uniformity and entropy. By working with a small, illustrative histogram, you will see how uniformity measures the homogeneity of the intensity distribution, while entropy measures its randomness or complexity [@problem_id:4567138].", "problem": "A radiomics pipeline following the Image Biomarker Standardization Initiative (IBSI) constructs a one-dimensional intensity histogram over a discretized Region of Interest (ROI). Consider an ROI with $N$ voxels discretized into $B$ bins indexed by $i=1,\\dots,B$. The observed bin counts are $n_i$, and the normalized histogram defines a probability mass function $p_i = n_i/N$. In IBSI, the histogram-based feature called uniformity quantifies the concentration of the distribution, and the histogram-based entropy quantifies the expected self-information. Using the probability mass function model and the information-theoretic definition of self-information, derive the expressions for IBSI uniformity and IBSI entropy for the given ROI, then evaluate them numerically for the following toy histogram:\n- Number of bins: $B=8$.\n- Bin counts: $n = (0,4,8,0,2,6,4,0)$.\n- Total voxel count: $N = \\sum_{i=1}^{B} n_i$.\n\nUse base-$2$ logarithms for entropy. Adopt the IBSI convention that any bin with $p_i=0$ contributes $0$ to the entropy, consistent with the limit $p \\ln p \\to 0$ as $p \\to 0^{+}$ (note that $\\log_{2} p = \\ln p / \\ln 2$). Provide the final uniformity and entropy in exact form as a single row vector, without decimal approximation. The quantities are dimensionless.", "solution": "### Derivation of IBSI Uniformity and Entropy\nLet $p_i$ be the probability of a voxel's intensity falling into bin $i$ of a histogram, where $i = 1, \\dots, B$. The set of probabilities $\\{p_i\\}$ constitutes a probability mass function (PMF), satisfying $p_i \\ge 0$ and $\\sum_{i=1}^{B} p_i = 1$.\n\n**IBSI Uniformity:**\nIBSI defines uniformity as the sum of the squared probabilities.\n$$\n\\text{Uniformity} = \\sum_{i=1}^{B} p_i^2\n$$\nA higher uniformity value corresponds to a greater concentration of probability in a few bins, indicating a less uniform distribution. A lower uniformity value indicates the probability is spread more evenly across many bins.\n\n**IBSI Entropy:**\nThe problem states that entropy quantifies the expected self-information. The self-information of an outcome with probability $p_i$ is given by $I(p_i) = -\\log_b(p_i)$, where the base $b$ is specified as $2$.\n$$\nI(p_i) = -\\log_2(p_i)\n$$\nEntropy, denoted by $H$, is the expected value of the self-information over the entire PMF.\n$$\nH = E[I(p)] = \\sum_{i=1}^{B} p_i I(p_i)\n$$\nSubstituting the expression for self-information, we obtain the expression for Shannon entropy, which is the definition used by IBSI.\n$$\n\\text{Entropy} = -\\sum_{i=1}^{B} p_i \\log_2(p_i)\n$$\nAs per the problem's (and the standard mathematical) convention, for any bin where $p_k = 0$, the corresponding term in the sum is taken to be $0$, since $\\lim_{p \\to 0^+} p \\log_2(p) = 0$.\n\n### Evaluation for the Given Histogram\nThe problem provides the following data:\n- Number of bins: $B=8$.\n- Bin counts: $n = (n_1, n_2, n_3, n_4, n_5, n_6, n_7, n_8) = (0, 4, 8, 0, 2, 6, 4, 0)$.\n\nFirst, calculate the total number of voxels, $N$.\n$$\nN = \\sum_{i=1}^{8} n_i = 0 + 4 + 8 + 0 + 2 + 6 + 4 + 0 = 24\n$$\n\nNext, calculate the probability mass function, $p_i = n_i/N$.\n$p_1 = 0/24 = 0$\n$p_2 = 4/24 = 1/6$\n$p_3 = 8/24 = 1/3$\n$p_4 = 0/24 = 0$\n$p_5 = 2/24 = 1/12$\n$p_6 = 6/24 = 1/4$\n$p_7 = 4/24 = 1/6$\n$p_8 = 0/24 = 0$\n\nThe PMF is $p = (0, 1/6, 1/3, 0, 1/12, 1/4, 1/6, 0)$.\n\n**Calculate Uniformity:**\nUsing the derived formula for uniformity:\n$$\n\\text{Uniformity} = \\sum_{i=1}^{8} p_i^2 = 0^2 + \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 + 0^2 + \\left(\\frac{1}{12}\\right)^2 + \\left(\\frac{1}{4}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 + 0^2\n$$\n$$\n\\text{Uniformity} = \\frac{1}{36} + \\frac{1}{9} + \\frac{1}{144} + \\frac{1}{16} + \\frac{1}{36}\n$$\nTo sum these fractions, we find a common denominator, which is $144$.\n$$\n\\text{Uniformity} = \\frac{4}{144} + \\frac{16}{144} + \\frac{1}{144} + \\frac{9}{144} + \\frac{4}{144} = \\frac{4+16+1+9+4}{144} = \\frac{34}{144}\n$$\nSimplifying the fraction gives:\n$$\n\\text{Uniformity} = \\frac{17}{72}\n$$\n\n**Calculate Entropy:**\nUsing the derived formula for entropy, and applying the convention for $p_i=0$:\n$$\n\\text{Entropy} = -\\sum_{i=1}^{8} p_i \\log_2(p_i)\n$$\nWe only sum over the terms with non-zero probabilities:\n$$\n\\text{Entropy} = -\\left[ \\frac{1}{6}\\log_2\\left(\\frac{1}{6}\\right) + \\frac{1}{3}\\log_2\\left(\\frac{1}{3}\\right) + \\frac{1}{12}\\log_2\\left(\\frac{1}{12}\\right) + \\frac{1}{4}\\log_2\\left(\\frac{1}{4}\\right) + \\frac{1}{6}\\log_2\\left(\\frac{1}{6}\\right) \\right]\n$$\nGrouping the identical terms:\n$$\n\\text{Entropy} = -\\left[ 2 \\cdot \\frac{1}{6}\\log_2\\left(\\frac{1}{6}\\right) + \\frac{1}{3}\\log_2\\left(\\frac{1}{3}\\right) + \\frac{1}{12}\\log_2\\left(\\frac{1}{12}\\right) + \\frac{1}{4}\\log_2\\left(\\frac{1}{4}\\right) \\right]\n$$\nUsing the logarithm property $\\log_b(1/x) = -\\log_b(x)$:\n$$\n\\text{Entropy} = \\frac{1}{3}\\log_2(6) + \\frac{1}{3}\\log_2(3) + \\frac{1}{12}\\log_2(12) + \\frac{1}{4}\\log_2(4)\n$$\nUsing the property $\\log_b(xy) = \\log_b(x) + \\log_b(y)$ and $\\log_b(b^k) = k$:\n$\\log_2(6) = \\log_2(2 \\cdot 3) = \\log_2(2) + \\log_2(3) = 1 + \\log_2(3)$\n$\\log_2(12) = \\log_2(4 \\cdot 3) = \\log_2(2^2 \\cdot 3) = \\log_2(2^2) + \\log_2(3) = 2 + \\log_2(3)$\n$\\log_2(4) = \\log_2(2^2) = 2$\nSubstituting these into the expression for entropy:\n$$\n\\text{Entropy} = \\frac{1}{3}(1 + \\log_2(3)) + \\frac{1}{3}\\log_2(3) + \\frac{1}{12}(2 + \\log_2(3)) + \\frac{1}{4}(2)\n$$\nDistribute the coefficients:\n$$\n\\text{Entropy} = \\frac{1}{3} + \\frac{1}{3}\\log_2(3) + \\frac{1}{3}\\log_2(3) + \\frac{2}{12} + \\frac{1}{12}\\log_2(3) + \\frac{2}{4}\n$$\nGroup the constant terms and the $\\log_2(3)$ terms:\n$$\n\\text{Entropy} = \\left(\\frac{1}{3} + \\frac{1}{6} + \\frac{1}{2}\\right) + \\left(\\frac{1}{3} + \\frac{1}{3} + \\frac{1}{12}\\right)\\log_2(3)\n$$\nEvaluate the coefficients:\n$$\n\\frac{1}{3} + \\frac{1}{6} + \\frac{1}{2} = \\frac{2}{6} + \\frac{1}{6} + \\frac{3}{6} = \\frac{6}{6} = 1\n$$\n$$\n\\frac{1}{3} + \\frac{1}{3} + \\frac{1}{12} = \\frac{4}{12} + \\frac{4}{12} + \\frac{1}{12} = \\frac{9}{12} = \\frac{3}{4}\n$$\nTherefore, the entropy is:\n$$\n\\text{Entropy} = 1 + \\frac{3}{4}\\log_2(3)\n$$\n\nThe final result is the pair (Uniformity, Entropy) in exact form.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{17}{72} & 1 + \\frac{3}{4}\\log_2(3) \\end{pmatrix}}\n$$", "id": "4567138"}, {"introduction": "While histograms tell us *what* intensity values are present, they don't tell us *where* they are located relative to each other. To capture this crucial spatial information, we use second-order, or textural, features. This advanced practice introduces one of the most powerful tools in radiomics: the Gray Level Co-occurrence Matrix (GLCM), which systematically quantifies the spatial relationships between voxel intensities. You will perform the complete workflow of constructing multiple directional GLCMs, aggregating them, and then using the resulting matrix to compute the IBSI features of contrast and homogeneity, gaining a deep appreciation for the rigor of textural analysis [@problem_id:4567098].", "problem": "A $4 \\times 4$ discretized two-dimensional region of interest (ROI) is given by\n$$\n\\mathbf{X} \\;=\\;\n\\begin{pmatrix}\n1 & 2 & 2 & 3 \\\\\n2 & 1 & 3 & 4 \\\\\n3 & 3 & 2 & 4 \\\\\n4 & 3 & 4 & 4\n\\end{pmatrix},\n$$\nwhere gray levels take values in $\\{1,2,3,4\\}$. Using the Image Biomarker Standardization Initiative (IBSI) conventions for the Gray Level Co-occurrence Matrix (GLCM), construct non-symmetric directional GLCMs at displacement $\\delta = 1$ in the directions $0^{\\circ}$, $45^{\\circ}$, $90^{\\circ}$, and $135^{\\circ}$. For definiteness, treat directions as displacement vectors $(\\Delta r, \\Delta c)$ on the ROI index grid with row index $r$ increasing from top to bottom and column index $c$ increasing from left to right:\n- $0^{\\circ}$: $(\\Delta r, \\Delta c) = (0, +1)$,\n- $45^{\\circ}$: $(\\Delta r, \\Delta c) = (-1, +1)$,\n- $90^{\\circ}$: $(\\Delta r, \\Delta c) = (-1, 0)$,\n- $135^{\\circ}$: $(\\Delta r, \\Delta c) = (-1, -1)$.\n\nFor each direction, count ordered pairs $(i,j)$ where $i$ is the source voxel gray level and $j$ is the gray level of its neighbor at displacement $\\delta$ in the specified direction, excluding any pairs that fall outside the ROI. Do not symmetrize the GLCM and do not merge opposite directions; treat each direction exactly as defined.\n\nNext, aggregate the four directional GLCMs by summing their counts elementwise to obtain a single co-occurrence count matrix, and normalize this aggregate count matrix by the total number of counted pairs across all four directions to obtain a joint probability matrix $P(i,j)$.\n\nUsing the normalized aggregate $P(i,j)$ and IBSI feature definitions, compute the contrast and the homogeneity (inverse difference moment). Then report the single quantity given by the ratio of contrast divided by homogeneity. Round your final ratio to four significant figures. Express the answer as a unitless number.", "solution": "**Step 1: Construct the Directional Gray Level Co-occurrence Matrices (GLCMs)**\n\nLet the given Region of Interest (ROI) be denoted by the matrix $\\mathbf{X}$, where $X(r, c)$ is the gray level at row $r$ and column $c$, with $r, c \\in \\{1, 2, 3, 4\\}$.\n$$\n\\mathbf{X} \\;=\\;\n\\begin{pmatrix}\n1 & 2 & 2 & 3 \\\\\n2 & 1 & 3 & 4 \\\\\n3 & 3 & 2 & 4 \\\\\n4 & 3 & 4 & 4\n\\end{pmatrix}\n$$\nThe number of gray levels is $N_g=4$. We will construct four non-symmetric $4 \\times 4$ GLCMs, which we denote as $\\mathbf{C}_{\\theta}$, for the four specified directions. The entry $C(i, j)$ in each matrix counts the number of times a voxel with gray level $i$ is adjacent to a voxel with gray level $j$ in the given direction.\n\n*   **Direction $0^{\\circ}$: displacement $(\\Delta r, \\Delta c) = (0, 1)$**\n    We count pairs $(X(r, c), X(r, c+1))$ for $r \\in \\{1, 2, 3, 4\\}$ and $c \\in \\{1, 2, 3\\}$. This yields the count matrix $\\mathbf{C}_{0^\\circ}$ with a total of $N_{0^\\circ} = 12$ pairs.\n    $$\n    \\mathbf{C}_{0^\\circ} = \\begin{pmatrix}\n    0 & 1 & 1 & 0 \\\\\n    1 & 1 & 1 & 1 \\\\\n    0 & 1 & 1 & 2 \\\\\n    0 & 0 & 1 & 1\n    \\end{pmatrix}\n    $$\n\n*   **Direction $45^{\\circ}$: displacement $(\\Delta r, \\Delta c) = (-1, 1)$**\n    We count pairs $(X(r, c), X(r-1, c+1))$ for $r \\in \\{2, 3, 4\\}$ and $c \\in \\{1, 2, 3\\}$. This yields the count matrix $\\mathbf{C}_{45^\\circ}$ with a total of $N_{45^\\circ} = 9$ pairs.\n    $$\n    \\mathbf{C}_{45^\\circ} = \\begin{pmatrix}\n    0 & 1 & 0 & 0 \\\\\n    0 & 1 & 0 & 1 \\\\\n    1 & 1 & 2 & 0 \\\\\n    0 & 0 & 1 & 1\n    \\end{pmatrix}\n    $$\n\n*   **Direction $90^{\\circ}$: displacement $(\\Delta r, \\Delta c) = (-1, 0)$**\n    We count pairs $(X(r, c), X(r-1, c))$ for $r \\in \\{2, 3, 4\\}$ and $c \\in \\{1, 2, 3, 4\\}$. This yields the count matrix $\\mathbf{C}_{90^\\circ}$ with a total of $N_{90^\\circ} = 12$ pairs.\n    $$\n    \\mathbf{C}_{90^\\circ} = \\begin{pmatrix}\n    0 & 1 & 0 & 0 \\\\\n    1 & 0 & 1 & 0 \\\\\n    1 & 2 & 1 & 0 \\\\\n    0 & 1 & 2 & 2\n    \\end{pmatrix}\n    $$\n\n*   **Direction $135^{\\circ}$: displacement $(\\Delta r, \\Delta c) = (-1, -1)$**\n    We count pairs $(X(r, c), X(r-1, c-1))$ for $r \\in \\{2, 3, 4\\}$ and $c \\in \\{2, 3, 4\\}$. This yields the count matrix $\\mathbf{C}_{135^\\circ}$ with a total of $N_{135^\\circ} = 9$ pairs.\n    $$\n    \\mathbf{C}_{135^\\circ} = \\begin{pmatrix}\n    1 & 0 & 0 & 0 \\\\\n    1 & 0 & 0 & 0 \\\\\n    0 & 2 & 1 & 0 \\\\\n    0 & 2 & 2 & 0\n    \\end{pmatrix}\n    $$\n\n**Step 2: Aggregate and Normalize the GLCMs**\n\nThe aggregate count matrix $\\mathbf{C}_{agg}$ is the element-wise sum of the four directional matrices:\n$$\n\\mathbf{C}_{agg} = \\mathbf{C}_{0^\\circ} + \\mathbf{C}_{45^\\circ} + \\mathbf{C}_{90^\\circ} + \\mathbf{C}_{135^\\circ} =\n\\begin{pmatrix}\n1 & 3 & 1 & 0 \\\\\n3 & 2 & 2 & 2 \\\\\n2 & 6 & 5 & 2 \\\\\n0 & 3 & 6 & 4\n\\end{pmatrix}\n$$\nThe total number of counted pairs is $N_p = N_{0^\\circ} + N_{45^\\circ} + N_{90^\\circ} + N_{135^\\circ} = 12 + 9 + 12 + 9 = 42$.\nThe normalized joint probability matrix $P(i, j)$ is obtained by dividing each element of $\\mathbf{C}_{agg}$ by $N_p$:\n$$\n\\mathbf{P} = \\frac{1}{42} \\mathbf{C}_{agg} = \\frac{1}{42}\n\\begin{pmatrix}\n1 & 3 & 1 & 0 \\\\\n3 & 2 & 2 & 2 \\\\\n2 & 6 & 5 & 2 \\\\\n0 & 3 & 6 & 4\n\\end{pmatrix}\n$$\n\n**Step 3: Compute Contrast and Homogeneity**\n\nThe gray levels are represented by indices $i, j \\in \\{1, 2, 3, 4\\}$.\n\n*   **Contrast:** The IBSI definition for contrast is:\n    $$\n    f_{contrast} = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_g} (i-j)^2 P(i, j) = \\frac{1}{N_p} \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_g} (i-j)^2 C_{agg}(i, j)\n    $$\n    We sum the contributions based on the difference $k = |i-j|$:\n    - For $k=1$: $(i-j)^2 = 1$. The sum of counts is $(C(1,2)+C(2,1)) + (C(2,3)+C(3,2)) + (C(3,4)+C(4,3)) = (3+3) + (2+6) + (2+6) = 22$. Contribution is $1^2 \\times 22 = 22$.\n    - For $k=2$: $(i-j)^2 = 4$. The sum of counts is $(C(1,3)+C(3,1)) + (C(2,4)+C(4,2)) = (1+2) + (2+3) = 8$. Contribution is $2^2 \\times 8 = 32$.\n    - For $k=3$: $(i-j)^2 = 9$. The sum of counts is $C(1,4)+C(4,1) = 0+0=0$. Contribution is $3^2 \\times 0 = 0$.\n\n    The total weighted sum of counts is $22 + 32 + 0 = 54$.\n    $$\n    f_{contrast} = \\frac{54}{42} = \\frac{9}{7}\n    $$\n\n*   **Homogeneity (Inverse Difference Moment):** The IBSI definition for homogeneity is:\n    $$\n    f_{homogeneity} = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_g} \\frac{P(i, j)}{1 + (i-j)^2} = \\frac{1}{N_p} \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_g} \\frac{C_{agg}(i, j)}{1 + (i-j)^2}\n    $$\n    We sum contributions based on $k = |i-j|$:\n    - For $k=0$: Weight is $1/(1+0^2)=1$. The sum of diagonal counts is $1+2+5+4 = 12$. Contribution is $1 \\times 12 = 12$.\n    - For $k=1$: Weight is $1/(1+1^2)=1/2$. Sum of counts is 22. Contribution is $(1/2) \\times 22 = 11$.\n    - For $k=2$: Weight is $1/(1+2^2)=1/5$. Sum of counts is 8. Contribution is $(1/5) \\times 8 = 8/5$.\n    - For $k=3$: Weight is $1/(1+3^2)=1/10$. Sum of counts is 0. Contribution is $0$.\n\n    The total weighted sum of counts is $12 + 11 + \\frac{8}{5} = 23 + \\frac{8}{5} = \\frac{115+8}{5} = \\frac{123}{5}$.\n    $$\n    f_{homogeneity} = \\frac{1}{42} \\left( \\frac{123}{5} \\right) = \\frac{123}{210} = \\frac{41}{70}\n    $$\n\n**Step 4: Compute the Final Ratio**\n\nThe problem asks for the ratio of contrast to homogeneity.\n$$\n\\text{Ratio} = \\frac{f_{contrast}}{f_{homogeneity}} = \\frac{9/7}{41/70} = \\frac{9}{7} \\times \\frac{70}{41} = \\frac{9 \\times 10}{41} = \\frac{90}{41}\n$$\nComputing the numerical value and rounding to four significant figures:\n$$\n\\frac{90}{41} \\approx 2.19512195...\n$$\nRounding to four significant figures gives $2.195$.", "answer": "$$\\boxed{2.195}$$", "id": "4567098"}]}