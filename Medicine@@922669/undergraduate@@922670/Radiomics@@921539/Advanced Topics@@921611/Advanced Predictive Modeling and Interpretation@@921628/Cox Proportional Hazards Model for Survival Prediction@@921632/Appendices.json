{"hands_on_practices": [{"introduction": "The Cox model's power lies in its partial likelihood, which avoids making assumptions about the baseline hazard. At its core, this method works by comparing the features of the individual who experiences an event at a specific time to the features of everyone else who was 'at risk' at that same moment. This exercise provides fundamental practice in identifying these crucial 'risk sets,' especially in realistic scenarios involving staggered study entry and incomplete follow-up, which are common in clinical and radiomics data [@problem_id:4534781].", "problem": "In a radiomics study of non-small-cell lung cancer, a cohort of $3$ patients is modeled using the Cox proportional hazards (PH) model, where the hazard for patient $i$ with radiomic feature vector $\\mathbf{x}_{i}$ is $h(t \\mid \\mathbf{x}_{i}) = h_{0}(t) \\exp(\\boldsymbol{\\beta}^{\\top}\\mathbf{x}_{i})$, with $h_{0}(t)$ the baseline hazard and $\\boldsymbol{\\beta}$ a coefficient vector. Due to staggered entry arising from imaging availability (left-truncation) and incomplete follow-up (right-censoring), each patient $i$ is characterized by an entry time $a_{i}$, an observed end time $y_{i}$, and an event indicator $\\delta_{i} \\in \\{0,1\\}$, where $\\delta_{i} = 1$ indicates an event at time $y_{i}$ and $\\delta_{i} = 0$ indicates right-censoring at time $y_{i}$. The observed times are: patient $1$ with $a_{1} = 0$, $y_{1} = 3$, $\\delta_{1} = 1$; patient $2$ with $a_{2} = 2$, $y_{2} = 5$, $\\delta_{2} = 0$; patient $3$ with $a_{3} = 4$, $y_{3} = 6$, $\\delta_{3} = 1$.\n\nAssume the standard survival analysis convention for right-censoring with left-truncation: at any time $t$, an individual is considered at risk if they have entered the study by time $t$ and have not experienced an event nor been censored prior to time $t$. Using this convention, determine the sizes of the risk sets $|R(3)|$ and $|R(5)|$, where $R(t)$ denotes the set of individuals at risk at time $t$. Report your answer as the ordered pair $\\left(|R(3)|, |R(5)|\\right)$ as exact integers. No rounding is required.", "solution": "The user has provided a valid problem statement from the field of survival analysis, a sub-discipline of statistics frequently applied in medical research fields such as radiomics. The problem is well-posed, scientifically grounded, and contains all necessary information to arrive at a unique, verifiable solution.\n\nThe core of this problem is the correct construction of the risk set, $R(t)$, at a given time $t$. The problem provides the standard definition for survival data subject to left-truncation (staggered entry) and right-censoring. An individual $i$ is in the risk set $R(t)$ if and only if they have entered the study at or before time $t$ and are still under observation (i.e., have not yet experienced an event or been censored) at time $t$.\n\nLet the data for patient $i$ be the triplet $(a_{i}, y_{i}, \\delta_{i})$, where $a_{i}$ is the entry time, $y_{i}$ is the time of event or censoring, and $\\delta_{i}$ is the event indicator. Based on the provided definition, patient $i$ is a member of the risk set $R(t)$ if the following two conditions are satisfied:\n1. The patient has entered the study: $a_{i} \\le t$.\n2. The patient has not yet experienced an event or been censored: $y_{i} \\ge t$.\n\nThe interval during which patient $i$ is at risk is thus $[a_{i}, y_{i}]$. We are given data for $3$ patients:\n- Patient $1$: $(a_{1}, y_{1}, \\delta_{1}) = (0, 3, 1)$. This patient is at risk during the time interval $[0, 3]$.\n- Patient $2$: $(a_{2}, y_{2}, \\delta_{2}) = (2, 5, 0)$. This patient is at risk during the time interval $[2, 5]$.\n- Patient $3$: $(a_{3}, y_{3}, \\delta_{3}) = (4, 6, 1)$. This patient is at risk during the time interval $[4, 6]$.\n\nThe problem requires the calculation of the size of the risk set, denoted $|R(t)|$, at two specific time points: $t=3$ and $t=5$.\n\nFirst, let's determine the size of the risk set at $t=3$, which is $|R(3)|$. We check the conditions for each patient:\n- Patient $1$: The risk interval is $[0, 3]$. Since $0 \\le 3$ and $3 \\ge 3$, patient $1$ is in the risk set $R(3)$.\n- Patient $2$: The risk interval is $[2, 5]$. Since $2 \\le 3$ and $5 \\ge 3$, patient $2$ is in the risk set $R(3)$.\n- Patient $3$: The risk interval is $[4, 6]$. Since the entry time is $a_{3}=4$, which is after $t=3$, the condition $a_{3} \\le 3$ is not met. Therefore, patient $3$ is not in the risk set $R(3)$.\nThe set of individuals at risk at $t=3$ is thus $R(3) = \\{1, 2\\}$. The size of this set is $|R(3)| = 2$.\n\nNext, we determine the size of the risk set at $t=5$, which is $|R(5)|$. We again check the conditions for each patient:\n- Patient $1$: The risk interval is $[0, 3]$. The event for this patient occurred at $y_{1}=3$, which is before $t=5$. The condition $y_{1} \\ge 5$ is not met. Therefore, patient $1$ is not in the risk set $R(5)$.\n- Patient $2$: The risk interval is $[2, 5]$. Since $2 \\le 5$ and $5 \\ge 5$, patient $2$ is in the risk set $R(5)$. Note that this patient is censored at time $5$, so they are considered at risk at exactly time $5$, but will not be at risk for any time $t > 5$.\n- Patient $3$: The risk interval is $[4, 6]$. Since $4 \\le 5$ and $6 \\ge 5$, patient $3$ is in the risk set $R(5)$.\nThe set of individuals at risk at $t=5$ is thus $R(5) = \\{2, 3\\}$. The size of this set is $|R(5)| = 2$.\n\nThe problem asks for the ordered pair $(|R(3)|, |R(5)|)$. Based on our calculations, this pair is $(2, 2)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  2\n\\end{pmatrix}\n}\n$$", "id": "4534781"}, {"introduction": "After fitting a Cox model, the primary output is a set of coefficients, $\\hat{\\boldsymbol{\\beta}}$, which are most intuitively interpreted by converting them into hazard ratios, $\\exp(\\hat{\\beta})$. A hazard ratio tells us how the risk of an event changes for each unit increase in a feature, but to assess its reliability, we must construct a confidence interval. This practice will guide you through the statistically sound method for calculating this interval, a crucial skill for evaluating the significance of any radiomic predictor [@problem_id:4534726].", "problem": "A radiomics study uses Computed Tomography (CT) features to predict time-to-event outcomes with the Cox Proportional Hazards (PH) model. For a patient with covariate vector $\\mathbf{x}$ and a radiomic texture feature $x_k$, the hazard function is modeled by $h(t \\mid \\mathbf{x}) = h_0(t)\\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$, where $h_0(t)$ is the baseline hazard and $\\boldsymbol{\\beta}$ are unknown regression coefficients. The hazard ratio associated with a one-unit increase in the feature $x_k$ is $\\exp(\\beta_k)$. Suppose the model is fit via partial likelihood and the estimator of $\\beta_k$, denoted $\\hat{\\beta}_k$, has an estimated variance $\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)$ obtained from the inverse observed information. Under standard large-sample regularity, $\\hat{\\beta}_k$ is approximately normal. In a cohort of lung cancer patients, for a texture feature $x_k$, the fit yields $\\hat{\\beta}_k = 0.40$ and $\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k) = 0.0225$. Let $\\alpha = 0.05$. Which option correctly constructs the $100(1-\\alpha)\\%$ Confidence Interval (CI) for the hazard ratio $\\exp(\\beta_k)$ using $\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)$, and gives its numerical value?\n\nA. $[\\exp(\\hat{\\beta}_k - z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}),\\ \\exp(\\hat{\\beta}_k + z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)})] = [1.11,\\ 2.00]$.\n\nB. $[\\exp(\\hat{\\beta}_k - z_{1-\\alpha/2}\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)),\\ \\exp(\\hat{\\beta}_k + z_{1-\\alpha/2}\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k))] = [1.43,\\ 1.56]$.\n\nC. $[\\exp(\\hat{\\beta}_k) - z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)},\\ \\exp(\\hat{\\beta}_k) + z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}] = [1.20,\\ 1.79]$.\n\nD. $[\\exp(\\hat{\\beta}_k - z_{1-\\alpha}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}),\\ \\exp(\\hat{\\beta}_k + z_{1-\\alpha}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)})] = [1.17,\\ 1.91]$.", "solution": "The problem statement is scientifically and statistically sound. It presents a standard task in survival analysis: constructing a confidence interval for a hazard ratio derived from a Cox proportional hazards model. All necessary information is provided, and the problem is well-posed.\n\nThe goal is to construct a $100(1-\\alpha)\\%$ confidence interval (CI) for the hazard ratio $HR = \\exp(\\beta_k)$.\nThe given data are:\n- The point estimate for the log-hazard coefficient: $\\hat{\\beta}_k = 0.40$.\n- The estimated variance of the estimator: $\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k) = 0.0225$.\n- The significance level: $\\alpha = 0.05$.\n\nThe problem states that the estimator $\\hat{\\beta}_k$ is approximately normally distributed. This is a standard result from the large-sample theory of maximum partial likelihood estimation. Therefore, we first construct a confidence interval for the parameter $\\beta_k$ and then transform it to obtain a CI for $\\exp(\\beta_k)$.\n\nStep 1: Construct the $100(1-\\alpha)\\%$ CI for $\\beta_k$.\nThe general formula for a two-sided CI for a normally distributed estimator is:\n$$ \\text{CI}_{\\beta_k} = \\left[ \\hat{\\beta}_k - z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\hat{\\beta}_k), \\quad \\hat{\\beta}_k + z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\hat{\\beta}_k) \\right] $$\nwhere $\\mathrm{SE}(\\hat{\\beta}_k)$ is the standard error of the estimator and $z_{1-\\alpha/2}$ is the upper $1-\\alpha/2$ quantile of the standard normal distribution.\n\nFirst, we calculate the standard error ($\\mathrm{SE}$) from the given variance:\n$$ \\mathrm{SE}(\\hat{\\beta}_k) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)} = \\sqrt{0.0225} = 0.15 $$\n\nNext, we find the critical value $z_{1-\\alpha/2}$. With $\\alpha = 0.05$, we need the $1 - 0.05/2 = 0.975$ quantile of the standard normal distribution.\n$$ z_{0.975} \\approx 1.96 $$\n\nNow, we can compute the $95\\%$ CI for $\\beta_k$:\n$$ \\text{CI}_{\\beta_k} = [0.40 - 1.96 \\times 0.15, \\quad 0.40 + 1.96 \\times 0.15] $$\n$$ \\text{CI}_{\\beta_k} = [0.40 - 0.294, \\quad 0.40 + 0.294] $$\n$$ \\text{CI}_{\\beta_k} = [0.106, \\quad 0.694] $$\n\nStep 2: Transform the CI for $\\beta_k$ to a CI for the hazard ratio $HR = \\exp(\\beta_k)$.\nThe exponential function $f(x) = \\exp(x)$ is strictly increasing and monotonic. Therefore, we can obtain the CI for $HR$ by applying the function to the endpoints of the CI for $\\beta_k$. This method, known as the transformation method (or log-transformation method in this context), preserves the coverage probability.\nThe general form of the CI for the hazard ratio is:\n$$ \\text{CI}_{\\exp(\\beta_k)} = \\left[ \\exp\\left(\\hat{\\beta}_k - z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}\\right), \\quad \\exp\\left(\\hat{\\beta}_k + z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}\\right) \\right] $$\n\nUsing the calculated interval for $\\beta_k$:\n$$ \\text{Lower Bound} = \\exp(0.106) \\approx 1.11183 $$\n$$ \\text{Upper Bound} = \\exp(0.694) \\approx 2.00171 $$\n\nRounding to two decimal places, the $95\\%$ CI for the hazard ratio is $[1.11, 2.00]$.\n\nNow, we evaluate each option:\n\nA. $[\\exp(\\hat{\\beta}_k - z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}),\\ \\exp(\\hat{\\beta}_k + z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)})] = [1.11,\\ 2.00]$.\nThis option presents the correct formula for constructing the CI for the hazard ratio by first finding the CI on the log-hazard (linear predictor) scale and then exponentiating the endpoints. The numerical calculation, as derived above, is also correct.\nVerdict: **Correct**.\n\nB. $[\\exp(\\hat{\\beta}_k - z_{1-\\alpha/2}\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)),\\ \\exp(\\hat{\\beta}_k + z_{1-\\alpha/2}\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k))] = [1.43,\\ 1.56]$.\nThis option incorrectly uses the variance, $\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)$, instead of the standard error, $\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}$, when constructing the interval on the log-hazard scale. The margin of error must have the same units as the estimator, which requires using the standard error. The formula isdimensionally and statistically incorrect.\nVerdict: **Incorrect**.\n\nC. $[\\exp(\\hat{\\beta}_k) - z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)},\\ \\exp(\\hat{\\beta}_k) + z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}] = [1.20,\\ 1.79]$.\nThis option incorrectly constructs a symmetric CI around the point estimate of the hazard ratio, $\\exp(\\hat{\\beta}_k)$. The estimator $\\exp(\\hat{\\beta}_k)$ follows a log-normal distribution, not a normal distribution. A symmetric confidence interval on this scale is inappropriate and can lead to lower bounds less than $0$. The correct approach is to construct the CI on the scale where normality holds (the $\\beta_k$ scale) and then transform.\nVerdict: **Incorrect**.\n\nD. $[\\exp(\\hat{\\beta}_k - z_{1-\\alpha}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)}),\\ \\exp(\\hat{\\beta}_k + z_{1-\\alpha}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta}_k)})] = [1.17,\\ 1.91]$.\nThis option uses an incorrect critical value, $z_{1-\\alpha}$, for a two-sided $100(1-\\alpha)\\%$ CI. A two-sided interval requires splitting the total error probability $\\alpha$ into two tails of size $\\alpha/2$, necessitating the use of the critical value $z_{1-\\alpha/2}$. Using $z_{1-\\alpha}$ (here, $z_{0.95} \\approx 1.645$) would correspond to a $100(1-2\\alpha)\\% = 90\\%$ CI, not a $95\\%$ CI.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "4534726"}, {"introduction": "While hazard ratios are excellent for understanding the relative effect of a feature, they don't tell us a patient's absolute probability of survival over time. To generate a full survival curve for a new patient, we must combine their specific hazard with the underlying baseline survival that is shared by all individuals in the study. This exercise demonstrates how to estimate this baseline component using the Breslow estimator, completing the puzzle for making absolute survival predictions [@problem_id:4534795].", "problem": "In a radiomics-based survival study, patients have high-dimensional quantitative imaging features that enter a Cox proportional hazards (CPH) model for time-to-event prediction. The CPH model posits that the hazard conditioned on features is $h(t \\mid x) = h_{0}(t)\\,\\exp(x^{\\top}\\beta)$, where $h_{0}(t)$ is the baseline hazard and $\\beta$ is the coefficient vector estimated from data. The baseline cumulative hazard $H_{0}(t)$ and baseline survival $S_{0}(t)$ are central for absolute risk prediction and calibration, as $S_{0}(t)$ connects to $h_{0}(t)$ through the fundamental survival-hazard relationship $S_{0}(t) = \\exp\\!\\big(-H_{0}(t)\\big)$.\n\nSuppose three distinct event times are observed at $t = (2, 4, 7)$, each corresponding to one event with event indicators $\\delta = (1, 1, 1)$. For each event time $t_{j}$, let $\\mathcal{R}(t_{j})$ denote the risk set immediately prior to $t_{j}$, and define the risk-set denominator $D_{t_{j}}$ as the sum of exponentiated linear predictors over $\\mathcal{R}(t_{j})$, namely $D_{t_{j}} = \\sum_{i \\in \\mathcal{R}(t_{j})} \\exp(x_{i}^{\\top}\\hat{\\beta})$. Assume that these denominators at the observed event times are $(D_{2}, D_{4}, D_{7}) = (10, 8, 5)$.\n\nUsing only core definitions of hazard, cumulative hazard, and survival, and standard large-sample proportional hazards arguments for estimating $H_{0}(t)$ from event counts and risk sets, derive the estimator for the baseline cumulative hazard at $t = 7$, denoted $\\hat{H}_{0}(7)$, and then compute the baseline survival at $t = 7$, denoted $\\hat{S}_{0}(7)$.\n\nExpress your final answer as exact values; no rounding is required.", "solution": "The user wants to find the estimated baseline cumulative hazard, $\\hat{H}_{0}(7)$, and the estimated baseline survival, $\\hat{S}_{0}(7)$, within the framework of a Cox Proportional Hazards (CPH) model. The problem provides the necessary components for this calculation: the distinct event times, the number of events at each time, and the pre-calculated risk-set denominators at these times.\n\nThe CPH model has the hazard function $h(t \\mid x) = h_{0}(t)\\exp(x^{\\top}\\beta)$, where $h_0(t)$ is the baseline hazard function. The baseline cumulative hazard function, $H_0(t)$, is the integral of the baseline hazard, $H_0(t) = \\int_0^t h_0(u)du$. In a semi-parametric setting where $h_0(t)$ is unspecified, its cumulative version $H_0(t)$ is typically estimated using the Breslow estimator. This estimator is a non-parametric, step-function estimate that increases only at the observed event times.\n\nLet the ordered distinct event times be $t_{(1)}  t_{(2)}  \\dots  t_{(k)}$. Let $d_j$ be the number of events occurring at time $t_{(j)}$, and let $\\mathcal{R}(t_{(j)})$ be the set of individuals at risk (i.e., alive and uncensored) just before time $t_{(j)}$. The risk-set denominator at time $t_{(j)}$ is given as $D_{t_{(j)}} = \\sum_{i \\in \\mathcal{R}(t_{(j)})} \\exp(x_{i}^{\\top}\\hat{\\beta})$, where $\\hat{\\beta}$ is the maximum partial likelihood estimate of the coefficient vector.\n\nThe Breslow estimator for the baseline cumulative hazard $H_0(t)$ is defined as the sum of the estimated instantaneous hazards up to time $t$:\n$$\n\\hat{H}_{0}(t) = \\sum_{t_{(j)} \\le t} \\frac{d_j}{D_{t_{(j)}}}\n$$\nThis formula arises from recognizing that the baseline hazard rate at time $t_{(j)}$ can be approximated by the ratio of the number of events $d_j$ to the total effective risk at that time, where the total effective risk is the sum of the risk scores $\\exp(x_i^\\top \\hat{\\beta})$ for all individuals in the risk set.\n\nFrom the problem statement, we are given:\n- The distinct event times are $t = (2, 4, 7)$. Thus, $t_{(1)} = 2$, $t_{(2)} = 4$, and $t_{(3)} = 7$.\n- There is one event at each of these times, meaning the number of events $d_j$ is $d_1 = 1$ (at $t=2$), $d_2 = 1$ (at $t=4$), and $d_3 = 1$ (at $t=7$).\n- The corresponding risk-set denominators are provided as $(D_{2}, D_{4}, D_{7}) = (10, 8, 5)$.\n\nWe are tasked with finding the baseline cumulative hazard at $t = 7$. Using the Breslow estimator, we sum the contributions from all event times less than or equal to $7$. These are the times $t=2$, $t=4$, and $t=7$.\n$$\n\\hat{H}_{0}(7) = \\sum_{t_j \\in \\{2, 4, 7\\}} \\frac{d_j}{D_{t_j}} = \\frac{d_1}{D_{2}} + \\frac{d_2}{D_{4}} + \\frac{d_3}{D_{7}}\n$$\nSubstituting the given values:\n$$\n\\hat{H}_{0}(7) = \\frac{1}{10} + \\frac{1}{8} + \\frac{1}{5}\n$$\nTo compute this sum, we find a common denominator, which is $40$.\n$$\n\\hat{H}_{0}(7) = \\frac{4}{40} + \\frac{5}{40} + \\frac{8}{40} = \\frac{4+5+8}{40} = \\frac{17}{40}\n$$\nThus, the estimated baseline cumulative hazard at $t = 7$ is $\\frac{17}{40}$.\n\nNext, we must find the baseline survival probability at $t = 7$, denoted $\\hat{S}_{0}(7)$. The problem provides the fundamental relationship between the survival function $S(t)$ and the cumulative hazard function $H(t)$, which is $S(t) = \\exp(-H(t))$. This relationship holds for the baseline functions as well: $S_{0}(t) = \\exp(-H_{0}(t))$.\n\nThe estimator for the baseline survival function is naturally derived from the estimator for the baseline cumulative hazard:\n$$\n\\hat{S}_{0}(t) = \\exp(-\\hat{H}_{0}(t))\n$$\nWe can now compute $\\hat{S}_{0}(7)$ using the value of $\\hat{H}_{0}(7)$ we just derived.\n$$\n\\hat{S}_{0}(7) = \\exp(-\\hat{H}_{0}(7)) = \\exp\\left(-\\frac{17}{40}\\right)\n$$\nThe problem requires an exact answer, so this expression is final.\n\nThe two requested quantities are $\\hat{H}_{0}(7) = \\frac{17}{40}$ and $\\hat{S}_{0}(7) = \\exp(-\\frac{17}{40})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{17}{40}  \\exp(-\\frac{17}{40}) \\end{pmatrix}}\n$$", "id": "4534795"}]}