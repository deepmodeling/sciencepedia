{"hands_on_practices": [{"introduction": "The Kaplan-Meier curve is a cornerstone of survival analysis, offering a powerful visual and quantitative summary of time-to-event data. Before interpreting these curves, it's essential to understand how they are constructed from raw patient data. This first practice provides a step-by-step guide to building a Kaplan-Meier estimator from scratch, focusing on the careful accounting of individuals at risk and the correct handling of censored observations [@problem_id:4562449].", "problem": "A radiomics study investigates overall survival in a cohort selected by a high-risk imaging signature. For each individual, the observed time is recorded in months along with an indicator of whether the event (death) occurred or the observation was censored. The dataset (ordered pairs $(t_i,\\delta_i)$ with $t_i$ in months and $\\delta_i \\in \\{0,1\\}$, where $\\delta_i=1$ indicates an event and $\\delta_i=0$ indicates censoring) is:\n- $(2,1)$,\n- $(3,0)$,\n- $(3,0)$,\n- $(4,1)$,\n- $(5,0)$,\n- $(6,1)$,\n- $(7,0)$,\n- $(8,1)$,\n- $(9,1)$,\n- $(10,0)$,\n- $(10,1)$,\n- $(12,0)$.\n\nStarting from first principles in survival analysis—namely, the definition of the survival function $S(t)=\\mathbb{P}(T>t)$ and the representation of survival over time as a product of conditional survival probabilities over successive intervals defined by ordered distinct event times—construct the Kaplan–Meier (product-limit) estimator step-by-step for this dataset. In your construction, explicitly handle times at which no events occur (pure censoring times) and times with both events and censorings occurring together. Use the right-continuous convention for the survival step function (i.e., the drop occurs at the event time).\n\nWhat is the exact value of the Kaplan–Meier estimate $\\hat{S}(t)$ at $t=9$ months under the right-continuous convention? Express your final answer as a reduced fraction with no units and do not round. Only provide the final numerical value; intermediate steps are not requested in the final answer.", "solution": "The fundamental quantity is the survival function $S(t)=\\mathbb{P}(T>t)$, which can be decomposed over ordered time intervals by the chain rule of conditional probability. If $t_{(1)}<t_{(2)}<\\dots$ denote the ordered distinct event times, then\n$$\nS(t)=\\mathbb{P}(T>t)=\\prod_{t_{(j)}\\le t}\\mathbb{P}\\big(T>t_{(j)} \\,\\big|\\, T\\ge t_{(j)}\\big).\n$$\nIn a right-censored sample, the Kaplan–Meier estimator replaces these conditional survival probabilities at each distinct event time $t_{(j)}$ by empirical conditional probabilities based on the at-risk set just prior to $t_{(j)}$. Let $n_j$ denote the number at risk just before $t_{(j)}$ and $d_j$ the number of events at $t_{(j)}$. The empirical conditional survival at $t_{(j)}$ is\n$$\n1-\\frac{d_j}{n_j}.\n$$\nPure censoring times contribute no multiplicative factor to the product; instead, they only reduce the size of the at-risk set for subsequent times. Under the right-continuous convention, the survival step occurs at the event time, so $\\hat{S}(t)$ at $t=t_{(j)}$ includes the factor from $t_{(j)}$.\n\nWe now apply this to the given data. First, list the distinct event times and tally the risk set and events:\n- The total sample size is $n=12$.\n- The ordered observations (time, indicator) are:\n  $(2,1)$, $(3,0)$, $(3,0)$, $(4,1)$, $(5,0)$, $(6,1)$, $(7,0)$, $(8,1)$, $(9,1)$, $(10,0)$, $(10,1)$, $(12,0)$.\n- The distinct event times are $2,4,6,8,9,10$.\n\nWe compute $n_j$ and $d_j$ at each event time, accounting for prior events and censorings and treating individuals censored at $t_{(j)}$ as still at risk just prior to $t_{(j)}$:\n1. At $t_{(1)}=2$: just prior, $n_1=12$, with $d_1=1$ event. Factor: $1-\\frac{d_1}{n_1}=1-\\frac{1}{12}=\\frac{11}{12}$.\n2. Between $2$ and $4$, there are censorings at $3$ (two individuals), so no survival step but the at-risk set reduces by $2$. At $t_{(2)}=4$: $n_2=12-1-2=9$, with $d_2=1$. Factor: $1-\\frac{1}{9}=\\frac{8}{9}$.\n3. Between $4$ and $6$, there is censoring at $5$ (one individual). At $t_{(3)}=6$: $n_3=9-1-1=7$, with $d_3=1$. Factor: $1-\\frac{1}{7}=\\frac{6}{7}$.\n4. Between $6$ and $8$, there is censoring at $7$ (one individual). At $t_{(4)}=8$: $n_4=7-1-1=5$, with $d_4=1$. Factor: $1-\\frac{1}{5}=\\frac{4}{5}$.\n5. At $t_{(5)}=9$: no intervening censoring after $8$, so $n_5=5-1=4$, with $d_5=1$. Factor: $1-\\frac{1}{4}=\\frac{3}{4}$.\n6. At $t_{(6)}=10$: there is both a censoring and an event. Just prior to $10$, the at-risk set is $n_6=4-1=3$, and $d_6=1$. Factor: $1-\\frac{1}{3}=\\frac{2}{3}$.\n7. The remaining observation at $12$ is censored and contributes no factor.\n\nThe Kaplan–Meier estimator is the product over event times up to the time of interest. Under the right-continuous convention, $\\hat{S}(9)$ includes the factor from $t=9$. Therefore,\n$$\n\\hat{S}(9)=\\left(1-\\frac{1}{12}\\right)\\left(1-\\frac{1}{9}\\right)\\left(1-\\frac{1}{7}\\right)\\left(1-\\frac{1}{5}\\right)\\left(1-\\frac{1}{4}\\right)\n=\\frac{11}{12}\\cdot\\frac{8}{9}\\cdot\\frac{6}{7}\\cdot\\frac{4}{5}\\cdot\\frac{3}{4}.\n$$\nWe simplify this product. First cancel $\\frac{4}{5}\\cdot\\frac{3}{4}=\\frac{3}{5}$, then proceed:\n$$\n\\hat{S}(9)=\\frac{11}{12}\\cdot\\frac{8}{9}\\cdot\\frac{6}{7}\\cdot\\frac{3}{5}.\n$$\nMultiply $\\frac{6}{7}\\cdot\\frac{3}{5}=\\frac{18}{35}$ and then\n$$\n\\hat{S}(9)=\\frac{11}{12}\\cdot\\frac{8}{9}\\cdot\\frac{18}{35}.\n$$\nCancel factors: $\\frac{8}{9}\\cdot\\frac{18}{35}=\\frac{144}{315}=\\frac{16}{35}$ after dividing numerator and denominator by $9$. Then\n$$\n\\hat{S}(9)=\\frac{11}{12}\\cdot\\frac{16}{35}=\\frac{176}{420}=\\frac{44}{105},\n$$\nwhere we divided numerator and denominator by $4$. Thus the exact Kaplan–Meier estimate at $t=9$ months, right-continuous, is $\\frac{44}{105}$.\n\nPure censoring times at $3$, $5$, $7$, and $12$ contributed no multiplicative drops, but they reduced the at-risk counts $n_j$ for subsequent event times, which is the correct handling in constructing the Kaplan–Meier curve. Ties in event and censoring times (e.g., at $10$) do not affect $\\hat{S}(9)$ but, in general, $n_j$ is computed just prior to the time including all individuals with that time, and $d_j$ counts only events at that time.", "answer": "$$\\boxed{\\frac{44}{105}}$$", "id": "4562449"}, {"introduction": "While plotting Kaplan-Meier curves for different groups is insightful, a visual inspection alone cannot definitively tell us if the survival experiences are statistically different. To make a rigorous comparison, we use hypothesis tests like the log-rank test, which assesses the null hypothesis that the survival distributions are identical. This exercise demystifies the log-rank test by guiding you through the calculation of its core components, revealing how it systematically compares event occurrences between groups at each point in time [@problem_id:4562464].", "problem": "A radiomics study stratified patients with glioblastoma into two cohorts based on a pre-treatment magnetic resonance imaging radiomic signature: a high-risk group (Group $1$) and a low-risk group (Group $2$). Progression-free survival time is measured in months. The event is radiographic progression; otherwise, observations are right-censored due to loss to follow-up or study end. Assume independent, non-informative censoring and that, at any calendar time where both events and censoring occur, all events at that time occur just before any censorings at that time. The data are as follows:\n\nGroup $1$ (high-risk): $(2,1)$, $(3,1)$, $(4,0)$, $(5,1)$, $(6,0)$, $(7,1)$, $(8,0)$, $(9,1)$\n\nGroup $2$ (low-risk): $(2,0)$, $(3,1)$, $(4,1)$, $(5,0)$, $(6,1)$, $(7,0)$, $(8,1)$, $(10,0)$\n\nEach pair $(t, \\delta)$ denotes a follow-up time $t$ and an indicator $\\delta$, where $\\delta=1$ denotes an event and $\\delta=0$ denotes right-censoring.\n\nStarting from first principles of survival analysis under the null hypothesis of equal hazard functions between the two groups, proceed as follows.\n\n1) At each distinct event time $t_j$, define the risk set just prior to $t_j$ as having $n_{1j}$ at risk in Group $1$ and $n_{2j}$ at risk in Group $2$, with $n_j=n_{1j}+n_{2j}$. Let $d_j$ be the total number of events at $t_j$, and $d_{1j}$ the number of those events in Group $1$. Using the permutation null (equal hazards) and conditioning on the risk set and the total number of events at $t_j$, establish the distributional model for $d_{1j}$ and derive expressions for its expectation and variance at each $t_j$.\n\n2) Use these results to construct the log-rank score statistic $U$ as a sum over distinct event times of the difference between observed and expected Group $1$ events, and its variance $V$ as the sum of the conditional variances over event times, including the finite-population correction that arises from sampling without replacement.\n\n3) Compute the log-rank chi-square statistic $\\chi^2 = U^2/V$ for the given data using the expressions you derived. Round your final numerical answer to four significant figures. No units are required.\n\n4) Briefly explain why a small-sample adjustment appears in the variance and how it differs from a large-sample approximation based on independent draws.\n\nProvide only the single numerical value of $\\chi^2$ as your final answer, rounded as requested.", "solution": "Under the null hypothesis that the hazard functions in Group $1$ and Group $2$ are equal at all times, the probability that any given event at a distinct event time $t_j$ occurs in Group $1$ is proportional to the current number at risk in Group $1$. Conditioning on the total number at risk at $t_j$ and the total number of events $d_j$ at $t_j$, the random variable $d_{1j}$, the number of Group $1$ events at $t_j$, follows a hypergeometric distribution. Specifically, at $t_j$, there are $n_{1j}$ potential “successes” (Group $1$ individuals) in a finite population of size $n_j$, and $d_j$ draws (events) are made without replacement. Therefore,\n$$\nd_{1j} \\sim \\text{Hypergeometric}\\left(N=n_j, K=n_{1j}, \\text{draws}=d_j\\right).\n$$\nFor a hypergeometric random variable with parameters as above, the conditional expectation and variance are well known:\n$$\n\\mathbb{E}[d_{1j}\\mid n_{1j},n_{2j},d_j] = d_j \\frac{n_{1j}}{n_j},\n$$\n$$\n\\operatorname{Var}(d_{1j}\\mid n_{1j},n_{2j},d_j) = d_j \\frac{n_{1j}}{n_j}\\left(1-\\frac{n_{1j}}{n_j}\\right)\\frac{n_j-d_j}{n_j-1}\n= \\frac{n_{1j}n_{2j}d_j(n_j-d_j)}{n_j^2(n_j-1)}.\n$$\n\nThe log-rank score statistic $U$ is constructed by summing, over all distinct event times $\\{t_j\\}$, the observed minus expected number of Group $1$ events:\n$$\nU = \\sum_{j} \\left(d_{1j} - \\mathbb{E}[d_{1j}\\mid n_{1j},n_{2j},d_j]\\right)\n= \\sum_{j} \\left(d_{1j} - d_j \\frac{n_{1j}}{n_j}\\right).\n$$\nUnder the null, $\\mathbb{E}[U]=0$. Its variance is the sum of the conditional variances:\n$$\nV = \\sum_{j} \\operatorname{Var}(d_{1j}\\mid n_{1j},n_{2j},d_j)\n= \\sum_{j} \\frac{n_{1j}n_{2j}d_j(n_j-d_j)}{n_j^2(n_j-1)}.\n$$\nThe ratio $\\chi^2 = U^2/V$ is asymptotically chi-square distributed with $1$ degree of freedom under the null.\n\nWe now compute $U$ and $V$ for the given data. First enumerate the distinct event times and the associated risk set counts. There are $16$ patients total, $8$ in each group. The distinct event times (pooled across groups) are $t \\in \\{2,3,4,5,6,7,8,9\\}$. Using the rule that events at time $t$ occur before censorings at time $t$, one can update the risk sets sequentially.\n\nInitialize at time just before $t=2$: $n_{1}=8$, $n_{2}=8$, $n=16$.\n- At $t=2$: events are one in Group $1$ and none in Group $2$, so $d_{1}=1$, $d_{2}=0$, $d=1$. Contribution to $U$ is\n$$\n1 - 1 \\cdot \\frac{8}{16} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\nContribution to $V$ is\n$$\n\\frac{8\\cdot 8 \\cdot 1 \\cdot (16-1)}{16^2(16-1)} = \\frac{64}{256} = \\frac{1}{4}.\n$$\nCensoring at $t=2$ in Group $2$ occurs after the event and reduces Group $2$ risk set by $1$ thereafter.\n\nUpdate: just before $t=3$, $n_{1}=7$, $n_{2}=7$, $n=14$.\n- At $t=3$: events are one in Group $1$ and one in Group $2$, so $d_{1}=1$, $d_{2}=1$, $d=2$. Contribution to $U$ is\n$$\n1 - 2 \\cdot \\frac{7}{14} = 1 - 1 = 0.\n$$\nContribution to $V$ is\n$$\n\\frac{7\\cdot 7 \\cdot 2 \\cdot (14-2)}{14^2(14-1)}\n= \\frac{49 \\cdot 2 \\cdot 12}{196 \\cdot 13}\n= \\frac{6}{13}.\n$$\n\nAfter these events, just before $t=4$, remove the two events at $t=3$: $n_{1}=6$, $n_{2}=6$, $n=12$.\n- At $t=4$: events are zero in Group $1$ and one in Group $2$, so $d_{1}=0$, $d_{2}=1$, $d=1$. Contribution to $U$ is\n$$\n0 - 1 \\cdot \\frac{6}{12} = -\\frac{1}{2}.\n$$\nContribution to $V$ is\n$$\n\\frac{6\\cdot 6 \\cdot 1 \\cdot (12-1)}{12^2(12-1)} = \\frac{36}{144} = \\frac{1}{4}.\n$$\nCensoring at $t=4$ in Group $1$ occurs after the event and reduces Group $1$ risk set thereafter.\n\nUpdate: just before $t=5$, $n_{1}=5$, $n_{2}=5$, $n=10$.\n- At $t=5$: events are one in Group $1$ and zero in Group $2$, so $d_{1}=1$, $d=1$. Contribution to $U$:\n$$\n1 - 1 \\cdot \\frac{5}{10} = \\frac{1}{2}.\n$$\nContribution to $V$:\n$$\n\\frac{5\\cdot 5 \\cdot 1 \\cdot (10-1)}{10^2(10-1)} = \\frac{25}{100} = \\frac{1}{4}.\n$$\nCensoring at $t=5$ in Group $2$ follows and reduces Group $2$ risk set.\n\nUpdate: just before $t=6$, $n_{1}=4$, $n_{2}=4$, $n=8$.\n- At $t=6$: events are zero in Group $1$ and one in Group $2$, so $d_{1}=0$, $d=1$. Contribution to $U$:\n$$\n0 - 1 \\cdot \\frac{4}{8} = -\\frac{1}{2}.\n$$\nContribution to $V$:\n$$\n\\frac{4\\cdot 4 \\cdot 1 \\cdot (8-1)}{8^2(8-1)} = \\frac{16}{64} = \\frac{1}{4}.\n$$\nCensoring at $t=6$ in Group $1$ follows and reduces Group $1$ risk set.\n\nUpdate: just before $t=7$, $n_{1}=3$, $n_{2}=3$, $n=6$.\n- At $t=7$: events are one in Group $1$ and zero in Group $2$, so $d_{1}=1$, $d=1$. Contribution to $U$:\n$$\n1 - 1 \\cdot \\frac{3}{6} = \\frac{1}{2}.\n$$\nContribution to $V$:\n$$\n\\frac{3\\cdot 3 \\cdot 1 \\cdot (6-1)}{6^2(6-1)} = \\frac{9}{36} = \\frac{1}{4}.\n$$\nCensoring at $t=7$ in Group $2$ follows.\n\nUpdate: just before $t=8$, $n_{1}=2$, $n_{2}=2$, $n=4$.\n- At $t=8$: events are zero in Group $1$ and one in Group $2$, so $d_{1}=0$, $d=1$. Contribution to $U$:\n$$\n0 - 1 \\cdot \\frac{2}{4} = -\\frac{1}{2}.\n$$\nContribution to $V$:\n$$\n\\frac{2\\cdot 2 \\cdot 1 \\cdot (4-1)}{4^2(4-1)} = \\frac{4}{16} = \\frac{1}{4}.\n$$\nCensoring at $t=8$ in Group $1$ follows.\n\nUpdate: just before $t=9$, $n_{1}=1$, $n_{2}=1$, $n=2$.\n- At $t=9$: events are one in Group $1$ and zero in Group $2$, so $d_{1}=1$, $d=1$. Contribution to $U$:\n$$\n1 - 1 \\cdot \\frac{1}{2} = \\frac{1}{2}.\n$$\nContribution to $V$:\n$$\n\\frac{1\\cdot 1 \\cdot 1 \\cdot (2-1)}{2^2(2-1)} = \\frac{1}{4}.\n$$\n\nSumming the contributions,\n$$\nU = \\left(\\frac{1}{2}\\right) + 0 + \\left(-\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) + \\left(-\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) + \\left(-\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) = \\frac{1}{2}.\n$$\nFor the variance,\n$$\nV = \\left(\\frac{1}{4}\\right) + \\left(\\frac{6}{13}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right).\n$$\nThere are seven terms equal to $\\frac{1}{4}$, summing to $\\frac{7}{4}$, so\n$$\nV = \\frac{7}{4} + \\frac{6}{13} = \\frac{91}{52} + \\frac{24}{52} = \\frac{115}{52}.\n$$\n\nThe log-rank chi-square statistic is\n$$\n\\chi^2 = \\frac{U^2}{V} = \\frac{\\left(\\frac{1}{2}\\right)^2}{\\frac{115}{52}} = \\frac{\\frac{1}{4}}{\\frac{115}{52}} = \\frac{52}{460} = \\frac{13}{115} \\approx 0.113043478.\n$$\nRounded to four significant figures, this is $0.1130$.\n\nRegarding small-sample adjustments, the finite-population correction $\\frac{n_j - d_j}{n_j - 1}$ in $\\operatorname{Var}(d_{1j})$ arises because, under the null, events are assigned to groups without replacement from a finite risk set at each time. This reduces the variance relative to a large-sample binomial approximation that treats the $d_j$ event assignments as independent draws with replacement, for which $\\operatorname{Var}(d_{1j}) \\approx d_j \\frac{n_{1j}}{n_j}\\left(1-\\frac{n_{1j}}{n_j}\\right)$. In our data, when $d_j=1$, the correction factor equals $1$, so there is no difference; when $d_j=2$ at $t=3$ with $n_j=14$, the factor $\\frac{n_j-d_j}{n_j-1}=\\frac{12}{13}$ reduces the variance by about $\\frac{1}{13}$ compared to the binomial approximation. Such corrections are important in small samples or when multiple events occur at the same time.", "answer": "$$\\boxed{0.1130}$$", "id": "4562464"}, {"introduction": "The log-rank test and the related Cox proportional hazards model are powerful tools, but their validity rests on the crucial assumption of proportional hazards—that the ratio of hazards between groups is constant over time. This exercise explores a scenario where this assumption is violated, leading to the phenomenon of crossing survival curves. By working through a case of non-proportional hazards, you will gain a deeper intuition for the limitations of standard models and the importance of checking assumptions before drawing conclusions [@problem_id:4562455].", "problem": "In a radiomics study of a new chemoradiation regimen, a binary radiomic signature partitions patients into two subgroups: group $A$ (signature-positive) and group $B$ (signature-negative). To illustrate how crossing Kaplan–Meier survival curves can arise from non-proportional hazards, consider the following constructed, scientifically plausible piecewise-constant hazard functions (hazard is per month), with a single change-point at $t=\\tau$ months:\n- For group $A$: $h_{A}(t)=\\lambda_{A,1}$ for $0 \\le t < \\tau$, and $h_{A}(t)=\\lambda_{A,2}$ for $t \\ge \\tau$.\n- For group $B$: $h_{B}(t)=\\lambda_{B,1}$ for $0 \\le t < \\tau$, and $h_{B}(t)=\\lambda_{B,2}$ for $t \\ge \\tau$.\n\nAssume that the survival function $S(t)$ satisfies the fundamental relationship $S(t)=\\exp\\big(-\\int_{0}^{t} h(u)\\,du\\big)$ for a non-negative hazard $h(t)$, and that there is no censoring. For a realistic radiotherapy-plus-chemotherapy scenario with an early treatment toxicity effect in group $B$ and late recurrence risk in group $A$, let\n$\\tau=12$, $\\lambda_{A,1}=0.03$, $\\lambda_{A,2}=0.10$, $\\lambda_{B,1}=0.07$, and $\\lambda_{B,2}=0.04$.\n\nTasks:\n1) Starting from the definition of the survival function in terms of the integrated hazard, derive closed-form expressions for $S_{A}(t)$ and $S_{B}(t)$ for all $t \\ge 0$ under the piecewise-constant hazards given.\n\n2) Using your expressions, verify whether the survival curves cross and determine the unique crossing time $t_{\\mathrm{cross}}$ such that $S_{A}(t_{\\mathrm{cross}})=S_{B}(t_{\\mathrm{cross}})$. Provide your answer in months.\n\n3) Using the definition of the hazard ratio $HR(t)=h_{A}(t)/h_{B}(t)$, determine whether the hazards are proportional over time. Briefly explain the implication of your finding for choosing an appropriate survival analysis model when analyzing radiomics-derived risk groups with potentially time-varying effects.\n\nGive only the numerical value of $t_{\\mathrm{cross}}$ in months as your final answer. No rounding is required.", "solution": "**Task 1: Derivation of Survival Functions**\n\nThe survival function $S(t)$ is given by $S(t) = \\exp(-H(t))$, where $H(t) = \\int_{0}^{t} h(u)\\,du$ is the cumulative hazard function. We must derive this for the piecewise-constant hazard functions for group $A$ and group $B$.\n\nLet's first derive the general form for a piecewise-constant hazard $h(t)$ with a single change-point at $\\tau$:\n$h(t) = \\begin{cases} \\lambda_1 & \\text{if } 0 \\le t < \\tau \\\\ \\lambda_2 & \\text{if } t \\ge \\tau \\end{cases}$\n\nFor the interval $0 \\le t < \\tau$:\nThe cumulative hazard is $H(t) = \\int_{0}^{t} h(u)\\,du = \\int_{0}^{t} \\lambda_1\\,du = \\lambda_1 t$.\nThe survival function is $S(t) = \\exp(-\\lambda_1 t)$.\n\nFor the interval $t \\ge \\tau$:\nThe cumulative hazard is calculated by splitting the integral at the change-point $\\tau$:\n$H(t) = \\int_{0}^{t} h(u)\\,du = \\int_{0}^{\\tau} h(u)\\,du + \\int_{\\tau}^{t} h(u)\\,du$\n$H(t) = \\int_{0}^{\\tau} \\lambda_1\\,du + \\int_{\\tau}^{t} \\lambda_2\\,du = \\lambda_1 [\\tau - 0] + \\lambda_2 [t - \\tau] = \\lambda_1 \\tau + \\lambda_2 (t - \\tau)$.\nThe survival function is $S(t) = \\exp(-[\\lambda_1 \\tau + \\lambda_2 (t - \\tau)])$.\n\nNow we apply this general form to groups $A$ and $B$ using the given parameters.\n\nFor group $A$, with $\\lambda_{A,1}=0.03$, $\\lambda_{A,2}=0.10$, and $\\tau=12$:\n$S_A(t) = \\begin{cases} \\exp(-0.03 t) & \\text{if } 0 \\le t < 12 \\\\ \\exp(-[0.03 \\cdot 12 + 0.10(t - 12)]) & \\text{if } t \\ge 12 \\end{cases}$\nSimplifying the exponent for $t \\ge 12$: $-(0.36 + 0.10t - 1.2) = -(0.10t - 0.84) = 0.84 - 0.10t$.\nSo, $S_A(t) = \\begin{cases} \\exp(-0.03 t) & \\text{if } 0 \\le t < 12 \\\\ \\exp(0.84 - 0.10t) & \\text{if } t \\ge 12 \\end{cases}$\n\nFor group $B$, with $\\lambda_{B,1}=0.07$, $\\lambda_{B,2}=0.04$, and $\\tau=12$:\n$S_B(t) = \\begin{cases} \\exp(-0.07 t) & \\text{if } 0 \\le t < 12 \\\\ \\exp(-[0.07 \\cdot 12 + 0.04(t - 12)]) & \\text{if } t \\ge 12 \\end{cases}$\nSimplifying the exponent for $t \\ge 12$: $-(0.84 + 0.04t - 0.48) = -(0.04t + 0.36)$.\nSo, $S_B(t) = \\begin{cases} \\exp(-0.07 t) & \\text{if } 0 \\le t < 12 \\\\ \\exp(-(0.04t + 0.36)) & \\text{if } t \\ge 12 \\end{cases}$\n\n**Task 2: Determination of Crossing Time**\n\nWe are looking for a time $t_{\\mathrm{cross}} > 0$ such that $S_A(t_{\\mathrm{cross}}) = S_B(t_{\\mathrm{cross}})$. Since the exponential function is one-to-one, this is equivalent to finding $t_{\\mathrm{cross}}$ such that the cumulative hazard functions are equal: $H_A(t_{\\mathrm{cross}}) = H_B(t_{\\mathrm{cross}})$.\n\nLet's check the two time intervals.\nFor $0 \\le t < 12$:\nWe would need to solve $H_A(t) = H_B(t)$, which is $\\lambda_{A,1} t = \\lambda_{B,1} t$.\nThis gives $(0.03 - 0.07)t = 0$, so $-0.04t = 0$, which implies $t=0$. This is the starting point where $S_A(0)=S_B(0)=1$, not a crossing. For $t \\in (0, 12)$, since $\\lambda_{A,1} < \\lambda_{B,1}$, we have $H_A(t) < H_B(t)$, which means $S_A(t) > S_B(t)$. Thus, no crossing occurs before $t=12$.\n\nFor $t \\ge 12$:\nWe must solve $H_A(t) = H_B(t)$.\n$\\lambda_{A,1} \\tau + \\lambda_{A,2} (t - \\tau) = \\lambda_{B,1} \\tau + \\lambda_{B,2} (t - \\tau)$\nWe rearrange the equation to solve for $t$:\n$\\lambda_{A,2} (t - \\tau) - \\lambda_{B,2} (t - \\tau) = \\lambda_{B,1} \\tau - \\lambda_{A,1} \\tau$\n$(t - \\tau)(\\lambda_{A,2} - \\lambda_{B,2}) = \\tau(\\lambda_{B,1} - \\lambda_{A,1})$\nProvided that $\\lambda_{A,2} \\neq \\lambda_{B,2}$, we can write:\n$t - \\tau = \\frac{\\tau(\\lambda_{B,1} - \\lambda_{A,1})}{\\lambda_{A,2} - \\lambda_{B,2}}$\n$t_{\\mathrm{cross}} = \\tau + \\frac{\\tau(\\lambda_{B,1} - \\lambda_{A,1})}{\\lambda_{A,2} - \\lambda_{B,2}}$\n\nNow, we substitute the given numerical values:\n$\\tau = 12$\n$\\lambda_{A,1} = 0.03$\n$\\lambda_{A,2} = 0.10$\n$\\lambda_{B,1} = 0.07$\n$\\lambda_{B,2} = 0.04$\n\n$t_{\\mathrm{cross}} = 12 + \\frac{12(0.07 - 0.03)}{0.10 - 0.04}$\n$t_{\\mathrm{cross}} = 12 + \\frac{12(0.04)}{0.06}$\n$t_{\\mathrm{cross}} = 12 + 12 \\left(\\frac{0.04}{0.06}\\right) = 12 + 12 \\left(\\frac{2}{3}\\right)$\n$t_{\\mathrm{cross}} = 12 + 8 = 20$\n\nThe solution $t_{\\mathrm{cross}} = 20$ is in the interval $t \\ge 12$, so it is a valid crossing time. The Kaplan-Meier curves cross at $20$ months.\n\n**Task 3: Proportionality of Hazards**\n\nThe hazard ratio is defined as $HR(t) = \\frac{h_A(t)}{h_B(t)}$. The proportional hazards assumption holds if and only if $HR(t)$ is constant for all $t \\ge 0$.\n\nFor $0 \\le t < 12$:\n$HR(t) = \\frac{\\lambda_{A,1}}{\\lambda_{B,1}} = \\frac{0.03}{0.07} = \\frac{3}{7} \\approx 0.429$\n\nFor $t \\ge 12$:\n$HR(t) = \\frac{\\lambda_{A,2}}{\\lambda_{B,2}} = \\frac{0.10}{0.04} = \\frac{10}{4} = 2.5$\n\nSince $HR(t)$ is not constant over time (it changes from $\\frac{3}{7}$ to $2.5$ at $t=12$), the hazards are **non-proportional**.\n\n**Implication for Survival Analysis Modeling:** The violation of the proportional hazards (PH) assumption means that standard survival models assuming proportionality, most notably the Cox proportional hazards model, are not appropriate for analyzing these data without modification. A standard Cox model would estimate a single, time-invariant hazard ratio, which would average the early protective effect ($HR < 1$) and the late detrimental effect ($HR > 1$) of being in group $A$ versus group $B$. This would obscure the true, time-dependent nature of the risk and could lead to incorrect clinical conclusions. Appropriate analytical methods would include time-dependent Cox models (e.g., using an interaction with time), stratified Cox models, or parametric models that explicitly account for non-proportionality, such as the piecewise exponential model used as the foundation of this problem.", "answer": "$$\\boxed{20}$$", "id": "4562455"}]}