{"hands_on_practices": [{"introduction": "Before we can develop sophisticated atlas-based segmentation methods, we must first answer a fundamental question: how do we measure success? This exercise introduces two of the most common metrics in medical image segmentation, the Dice Similarity Coefficient ($DSC$) and the Hausdorff distance ($H$). By calculating these for a simple case with a clear error, you will gain an intuitive understanding of how they capture different aspects of segmentation quality—volumetric overlap versus boundary accuracy—and why both are crucial for a complete evaluation [@problem_id:4529150].", "problem": "In atlas-based segmentation within radiomics, a population atlas of anatomical labels is deformed to a target subject by a registration, producing a candidate segmentation that can be compared to a manual ground-truth segmentation. Consider a two-dimensional slice with isotropic voxel spacing of $1\\,\\mathrm{mm}$, and let a ground-truth mask be represented by the set of foreground voxel coordinates $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$. An atlas-warped mask $T$ is obtained, and due to a minor misregistration, contains a spurious isolated label voxel at $(10,10)$ in addition to the intended structure, so $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$. Using the standard Euclidean metric on voxel coordinates and treating masks as sets of foreground voxels, compute the Dice similarity coefficient between $S$ and $T$ and the symmetric Hausdorff distance between $S$ and $T$. Express the Hausdorff distance in millimeters. Based on any discrepancy you find between these metrics, identify in your reasoning the dominant error mode present in the atlas-based segmentation relative to the ground truth. No rounding is required; provide exact values. Your final numerical answer must consist of the pair of values for the Dice similarity coefficient and the Hausdorff distance, respectively.", "solution": "The problem requires the computation of two standard metrics for comparing segmentation masks, the Dice similarity coefficient (DSC) and the symmetric Hausdorff distance, for the given ground-truth set $S$ and the atlas-warped set $T$.\n\nLet the ground-truth set be $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$ and the atlas-warped set be $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$.\n\n**1. Dice Similarity Coefficient (DSC)**\n\nThe Dice similarity coefficient measures the overlap between two sets. It is defined as:\n$$\n\\text{DSC}(S, T) = \\frac{2 |S \\cap T|}{|S| + |T|}\n$$\nwhere $|A|$ denotes the cardinality (number of elements) of a set $A$.\n\nFirst, we determine the cardinalities of the sets $S$ and $T$:\n$$\n|S| = 4\n$$\n$$\n|T| = 5\n$$\n\nNext, we find the intersection of the two sets, $S \\cap T$:\n$$\nS \\cap T = \\{(0,0),(0,1),(1,0),(1,1)\\}\n$$\nThe cardinality of the intersection is:\n$$\n|S \\cap T| = 4\n$$\n\nNow, we can compute the DSC:\n$$\n\\text{DSC}(S, T) = \\frac{2 \\times 4}{4 + 5} = \\frac{8}{9}\n$$\nThe Dice coefficient is a value between $0$ and $1$, where $1$ indicates perfect agreement. A value of $\\frac{8}{9}$ indicates a high degree of overlap.\n\n**2. Symmetric Hausdorff Distance**\n\nThe symmetric Hausdorff distance, $H(S,T)$, quantifies the maximum distance from a point in one set to the nearest point in the other set. It is defined as:\n$$\nH(S, T) = \\max \\left( h(S, T), h(T, S) \\right)\n$$\nwhere $h(S, T)$ is the directed Hausdorff distance from $S$ to $T$:\n$$\nh(S, T) = \\max_{s \\in S} \\left( \\min_{t \\in T} d(s, t) \\right)\n$$\nand $d(s, t)$ is the standard Euclidean distance between points (voxels) $s$ and $t$.\n\nFirst, let's compute the directed Hausdorff distance $h(S, T)$. This measures the largest distance from any point in $S$ to its closest point in $T$.\nSince the set $S$ is a proper subset of $T$ (i.e., $S \\subset T$), for every point $s \\in S$, that same point $s$ is also in $T$. Therefore, the minimum distance from any $s \\in S$ to the set $T$ is $0$, because $d(s, s) = 0$.\n$$\n\\min_{t \\in T} d(s, t) = 0 \\quad \\forall s \\in S\n$$\nTaking the maximum over all $s \\in S$:\n$$\nh(S, T) = \\max_{s \\in S} (0) = 0\n$$\n\nNext, we compute the directed Hausdorff distance $h(T, S)$, which measures the largest distance from any point in $T$ to its closest point in $S$.\n$$\nh(T, S) = \\max_{t \\in T} \\left( \\min_{s \\in S} d(t, s) \\right)\n$$\nWe need to compute $\\min_{s \\in S} d(t, s)$ for each point $t \\in T$.\nThe set $T$ consists of the points in $S$ plus the outlier point $(10,10)$.\nFor any point $t$ that is in both $S$ and $T$, the minimum distance to $S$ is $0$. This applies to the points $(0,0)$, $(0,1)$, $(1,0)$, and $(1,1)$.\nThe only point we need to consider is $t^* = (10,10)$, which is in $T$ but not in $S$. We must find its minimum distance to the set $S$.\n$$\n\\min_{s \\in S} d((10,10), s) = \\min \\left\\{ d((10,10),(0,0)), d((10,10),(0,1)), d((10,10),(1,0)), d((10,10),(1,1)) \\right\\}\n$$\nLet's calculate the individual Euclidean distances, $d((x_1,y_1),(x_2,y_2)) = \\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$:\n-   $d((10,10),(0,0)) = \\sqrt{(10-0)^2 + (10-0)^2} = \\sqrt{100+100} = \\sqrt{200} = 10\\sqrt{2}$\n-   $d((10,10),(0,1)) = \\sqrt{(10-0)^2 + (10-1)^2} = \\sqrt{100+81} = \\sqrt{181}$\n-   $d((10,10),(1,0)) = \\sqrt{(10-1)^2 + (10-0)^2} = \\sqrt{81+100} = \\sqrt{181}$\n-   $d((10,10),(1,1)) = \\sqrt{(10-1)^2 + (10-1)^2} = \\sqrt{81+81} = \\sqrt{162} = 9\\sqrt{2}$\n\nThe minimum of these distances is $\\sqrt{162} = 9\\sqrt{2}$.\nTherefore, $h(T, S) = \\max(0, 0, 0, 0, 9\\sqrt{2}) = 9\\sqrt{2}$.\n\nThe symmetric Hausdorff distance is the maximum of the two directed distances:\n$$\nH(S, T) = \\max(h(S, T), h(T, S)) = \\max(0, 9\\sqrt{2}) = 9\\sqrt{2}\n$$\nThis distance is in voxel units. The problem specifies an isotropic voxel spacing of $1\\,\\mathrm{mm}$. Thus, the Hausdorff distance in millimeters is:\n$$\nH(S, T) = 9\\sqrt{2}\\,\\mathrm{mm}\n$$\n\n**3. Interpretation of the Error Mode**\n\nWe have calculated a Dice coefficient of $\\text{DSC} = \\frac{8}{9} \\approx 0.889$ and a Hausdorff distance of $H = 9\\sqrt{2} \\approx 12.7\\,\\mathrm{mm}$.\n-   The **Dice coefficient** is a volumetric overlap metric. It is high because the segmentation mismatch constitutes only a single voxel ($T$ has $5$ voxels, $S$ has $4$, and $4$ of them overlap). This metric is relatively insensitive to the spatial location of the mismatched regions.\n-   The **Hausdorff distance** is a boundary-based metric, an indicator of the worst-case error. It is extremely sensitive to outliers. The large value of $9\\sqrt{2}\\,\\mathrm{mm}$ is caused exclusively by the single spurious voxel at $(10,10)$, which is far from the ground-truth set $S$.\n\nThe discrepancy between the high DSC value (suggesting a good overall segmentation) and the large Hausdorff distance (suggesting a poor segmentation boundary) points to a specific type of error. The dominant error mode is the presence of a **spurious, isolated cluster of voxels** (an outlier) far from the actual object boundary. The segmentation is largely correct in its main body, but the misregistration has introduced a false positive element at a significant distance.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{8}{9} & 9\\sqrt{2} \\end{pmatrix}}\n$$", "id": "4529150"}, {"introduction": "Multi-atlas segmentation relies on the \"wisdom of the crowd,\" but what happens when some members of the crowd are unreliable? This practice explores the core task of label fusion, comparing a simple majority vote with a robustly weighted approach that down-weights a poorly registered atlas. By working through this scenario, you will see how using atlas reliability scores, like the $DSC$ you learned to calculate, leads to a more accurate and stable final segmentation, especially in the presence of outliers [@problem_id:4529158].", "problem": "An atlas-based segmentation pipeline is used as a preprocessing step in a radiomics study to delineate a binary structure of interest in a target image by label fusion across $K$ registered atlas segmentations. You are given $K=5$ atlases. For label fusion at a single voxel, each atlas contributes a binary vote $y_i \\in \\{0,1\\}$ indicating foreground ($1$) or background ($0$). To downweight an atlas with gross misregistration, atlas reliabilities are estimated from a small validation set using the Dice similarity coefficient (DSC). Let $s_i \\in [0,1]$ denote the DSC of atlas $i$ with respect to withheld validation annotations, so that larger $s_i$ indicates higher atlas reliability. A robust weight $w_i$ is assigned to each atlas by applying the Huber M-estimator through iteratively reweighted least squares (IRLS): define the residual $r_i = 1 - s_i$ and the Huber tuning constant $c > 0$. The corresponding IRLS weight is $w_i = \\psi(r_i)/r_i$, where the Huber score function is $\\psi(r) = r$ if $|r| \\le c$ and $\\psi(r) = c \\,\\mathrm{sign}(r)$ if $|r| > c$, which yields $w_i = 1$ if $|r_i| \\le c$ and $w_i = c/|r_i|$ if $|r_i| > c$. The robustly fused posterior foreground probability at the voxel is then\n$$\np_{\\mathrm{fused}} = \\frac{\\sum_{i=1}^{K} w_i \\, y_i}{\\sum_{i=1}^{K} w_i}.\n$$\nThe majority voting fraction at the voxel is $m = \\frac{1}{K}\\sum_{i=1}^{K} y_i$. Suppose the atlas DSCs are $s_1=0.90$, $s_2=0.88$, $s_3=0.86$, $s_4=0.85$, and $s_5=0.30$, with $c=0.10$. Assume the voxelwise atlas votes are $y_1=0$, $y_2=0$, $y_3=1$, $y_4=1$, and $y_5=1$, where atlas $5$ is the grossly misregistered atlas. Using only the definitions above, compute the exact value of the difference between the robustly fused posterior and the majority voting fraction, namely $p_{\\mathrm{fused}} - m$. Express your final answer as a simplified fraction with no units. Do not round.", "solution": "The objective is to compute the difference $p_{\\mathrm{fused}} - m$. This requires the calculation of two quantities: the majority voting fraction $m$ and the robustly fused posterior probability $p_{\\mathrm{fused}}$.\n\nFirst, we compute the majority voting fraction $m$. With $K=5$ and atlas votes $y_1=0$, $y_2=0$, $y_3=1$, $y_4=1$, and $y_5=1$, the sum of votes is:\n$$\n\\sum_{i=1}^{5} y_i = 0 + 0 + 1 + 1 + 1 = 3\n$$\nThe majority voting fraction is therefore:\n$$\nm = \\frac{1}{K}\\sum_{i=1}^{5} y_i = \\frac{3}{5}\n$$\n\nNext, we compute the robustly fused posterior probability $p_{\\mathrm{fused}}$. This first requires calculating the weight $w_i$ for each atlas. The weight $w_i$ depends on the residual $r_i = 1 - s_i$.\n\nThe given atlas DSCs are:\n$s_1 = 0.90$\n$s_2 = 0.88$\n$s_3 = 0.86$\n$s_4 = 0.85$\n$s_5 = 0.30$\n\nThe corresponding residuals $r_i = 1 - s_i$ are:\n$r_1 = 1 - 0.90 = 0.10$\n$r_2 = 1 - 0.88 = 0.12$\n$r_3 = 1 - 0.86 = 0.14$\n$r_4 = 1 - 0.85 = 0.15$\n$r_5 = 1 - 0.30 = 0.70$\n\nThe weights $w_i$ are determined by comparing the absolute value of the residual, $|r_i|$, to the Huber tuning constant $c=0.10$. Since all $s_i \\in [0,1]$, the residuals $r_i \\in [0,1]$, so $|r_i| = r_i$. The rule for weights is $w_i = 1$ if $r_i \\le c$ and $w_i = c/r_i$ if $r_i > c$.\n\nWe calculate the weight for each atlas:\n- For atlas $1$: $r_1 = 0.10$. Since $r_1 \\le c$ (i.e., $0.10 \\le 0.10$), the weight is $w_1 = 1$.\n- For atlas $2$: $r_2 = 0.12$. Since $r_2 > c$ (i.e., $0.12 > 0.10$), the weight is $w_2 = \\frac{c}{r_2} = \\frac{0.10}{0.12} = \\frac{10}{12} = \\frac{5}{6}$.\n- For atlas $3$: $r_3 = 0.14$. Since $r_3 > c$ (i.e., $0.14 > 0.10$), the weight is $w_3 = \\frac{c}{r_3} = \\frac{0.10}{0.14} = \\frac{10}{14} = \\frac{5}{7}$.\n- For atlas $4$: $r_4 = 0.15$. Since $r_4 > c$ (i.e., $0.15 > 0.10$), the weight is $w_4 = \\frac{c}{r_4} = \\frac{0.10}{0.15} = \\frac{10}{15} = \\frac{2}{3}$.\n- For atlas $5$: $r_5 = 0.70$. Since $r_5 > c$ (i.e., $0.70 > 0.10$), the weight is $w_5 = \\frac{c}{r_5} = \\frac{0.10}{0.70} = \\frac{10}{70} = \\frac{1}{7}$.\n\nNow we can compute the components of $p_{\\mathrm{fused}}$. The numerator is the sum of weighted votes:\n$$\n\\sum_{i=1}^{5} w_i y_i = w_1 y_1 + w_2 y_2 + w_3 y_3 + w_4 y_4 + w_5 y_5\n$$\nSubstituting the values of $w_i$ and $y_i$:\n$$\n\\sum_{i=1}^{5} w_i y_i = (1)(0) + \\left(\\frac{5}{6}\\right)(0) + \\left(\\frac{5}{7}\\right)(1) + \\left(\\frac{2}{3}\\right)(1) + \\left(\\frac{1}{7}\\right)(1)\n$$\n$$\n\\sum_{i=1}^{5} w_i y_i = \\frac{5}{7} + \\frac{2}{3} + \\frac{1}{7} = \\left(\\frac{5}{7} + \\frac{1}{7}\\right) + \\frac{2}{3} = \\frac{6}{7} + \\frac{2}{3}\n$$\nTo sum these fractions, we find a common denominator, which is $21$:\n$$\n\\sum_{i=1}^{5} w_i y_i = \\frac{6 \\times 3}{7 \\times 3} + \\frac{2 \\times 7}{3 \\times 7} = \\frac{18}{21} + \\frac{14}{21} = \\frac{32}{21}\n$$\nThe denominator of $p_{\\mathrm{fused}}$ is the sum of all weights:\n$$\n\\sum_{i=1}^{5} w_i = w_1 + w_2 + w_3 + w_4 + w_5 = 1 + \\frac{5}{6} + \\frac{5}{7} + \\frac{2}{3} + \\frac{1}{7}\n$$\nWe group terms for easier summation:\n$$\n\\sum_{i=1}^{5} w_i = 1 + \\left(\\frac{5}{6} + \\frac{2}{3}\\right) + \\left(\\frac{5}{7} + \\frac{1}{7}\\right) = 1 + \\left(\\frac{5}{6} + \\frac{4}{6}\\right) + \\frac{6}{7} = 1 + \\frac{9}{6} + \\frac{6}{7} = 1 + \\frac{3}{2} + \\frac{6}{7}\n$$\nThe common denominator for these terms is $14$:\n$$\n\\sum_{i=1}^{5} w_i = \\frac{14}{14} + \\frac{3 \\times 7}{2 \\times 7} + \\frac{6 \\times 2}{7 \\times 2} = \\frac{14}{14} + \\frac{21}{14} + \\frac{12}{14} = \\frac{14 + 21 + 12}{14} = \\frac{47}{14}\n$$\nNow we can compute $p_{\\mathrm{fused}}$:\n$$\np_{\\mathrm{fused}} = \\frac{\\sum_{i=1}^{5} w_i y_i}{\\sum_{i=1}^{5} w_i} = \\frac{32/21}{47/14} = \\frac{32}{21} \\times \\frac{14}{47} = \\frac{32 \\times (2 \\times 7)}{(3 \\times 7) \\times 47} = \\frac{32 \\times 2}{3 \\times 47} = \\frac{64}{141}\n$$\nFinally, we compute the required difference, $p_{\\mathrm{fused}} - m$:\n$$\np_{\\mathrm{fused}} - m = \\frac{64}{141} - \\frac{3}{5}\n$$\nThe common denominator is $141 \\times 5 = (3 \\times 47) \\times 5 = 705$:\n$$\np_{\\mathrm{fused}} - m = \\frac{64 \\times 5}{141 \\times 5} - \\frac{3 \\times 141}{5 \\times 141} = \\frac{320}{705} - \\frac{423}{705} = \\frac{320 - 423}{705} = \\frac{-103}{705}\n$$\nThe numerator, $103$, is a prime number. The denominator is $705 = 3 \\times 5 \\times 47$. Since $103$ is not a factor of $705$, the fraction is in its simplest form.\nThe final result is $-\\frac{103}{705}$.", "answer": "$$\\boxed{-\\frac{103}{705}}$$", "id": "4529158"}, {"introduction": "Moving beyond fixed weights, we can treat segmentation as a statistical inference problem. This exercise provides a glimpse into the powerful Expectation-Maximization (EM) algorithm, a cornerstone of modern probabilistic methods like STAPLE (Simultaneous Truth and Performance Level Estimation). You will perform the first step of this iterative process, using initial estimates of atlas performance (sensitivity and specificity) to calculate the probability that a voxel belongs to the target structure, illustrating how we can fuse information in a principled, model-based fashion [@problem_id:4529145].", "problem": "In atlas-based segmentation for radiomics, consider a binary tissue classification problem where the latent true tissue label at voxel $v$ is $T_v \\in \\{0,1\\}$ and three atlases provide observed labels $\\ell_{iv} \\in \\{0,1\\}$ for $i \\in \\{1,2,3\\}$. Assume conditional independence of atlas observations given $T_v$, and a Bernoulli model for each atlas with sensitivity $s_i = \\mathbb{P}(\\ell_{iv} = 1 \\mid T_v = 1)$ and specificity $c_i = \\mathbb{P}(\\ell_{iv} = 0 \\mid T_v = 0)$. Let the prior prevalence be $\\pi = \\mathbb{P}(T_v = 1)$, identical across voxels. \n\nYou are given the following initial parameters: $s_1 = 0.90$, $c_1 = 0.95$, $s_2 = 0.85$, $c_2 = 0.90$, $s_3 = 0.80$, $c_3 = 0.92$, and $\\pi = 0.30$. For four voxels $v = 1,2,3,4$, the observed atlas labels are:\n- Voxel $1$: $\\ell_{1,1} = 1$, $\\ell_{2,1} = 1$, $\\ell_{3,1} = 1$.\n- Voxel $2$: $\\ell_{1,2} = 1$, $\\ell_{2,2} = 0$, $\\ell_{3,2} = 1$.\n- Voxel $3$: $\\ell_{1,3} = 0$, $\\ell_{2,3} = 0$, $\\ell_{3,3} = 1$.\n- Voxel $4$: $\\ell_{1,4} = 0$, $\\ell_{2,4} = 0$, $\\ell_{3,4} = 0$.\n\nPerform one iteration of Expectation-Maximization (EM), where Expectation-Maximization (EM) refers to computing the posterior probabilities in the expectation step (E-step) and updating the sensitivity and specificity parameters in the maximization step (M-step) based on the expected sufficient statistics. Specifically:\n1. In the E-step, compute for each voxel $v$ the posterior probability $p_v = \\mathbb{P}(T_v = 1 \\mid \\ell_{1v}, \\ell_{2v}, \\ell_{3v})$ using Bayes’ theorem and the conditional independence assumption.\n2. In the M-step, update each atlas’s sensitivity and specificity using the expected counts:\n   - $s_i^{(1)} = \\dfrac{\\sum_{v} p_v \\, \\ell_{iv}}{\\sum_{v} p_v}$,\n   - $c_i^{(1)} = \\dfrac{\\sum_{v} (1 - p_v) \\, (1 - \\ell_{iv})}{\\sum_{v} (1 - p_v)}$.\n\nProvide the numerical value of the posterior probability $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$ obtained in the E-step from the given initial parameters. Express your answer as a decimal rounded to four significant figures. No units are required.", "solution": "The objective is to compute the posterior probability $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$ for voxel $v=2$. Let the vector of observed labels for voxel $v$ be denoted by $\\boldsymbol{\\ell}_v = (\\ell_{1v}, \\ell_{2v}, \\ell_{3v})$. For voxel $2$, the observed labels are $\\boldsymbol{\\ell}_2 = (1, 0, 1)$.\n\nWe apply Bayes' theorem to calculate the posterior probability:\n$$ p_v = \\mathbb{P}(T_v=1 \\mid \\boldsymbol{\\ell}_v) = \\frac{\\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=1)\\mathbb{P}(T_v=1)}{\\mathbb{P}(\\boldsymbol{\\ell}_v)} $$\nThe denominator, $\\mathbb{P}(\\boldsymbol{\\ell}_v)$, is the marginal likelihood or evidence, which can be expanded using the law of total probability:\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_v) = \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=1)\\mathbb{P}(T_v=1) + \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=0)\\mathbb{P}(T_v=0) $$\nThe prior probabilities are given as $\\mathbb{P}(T_v=1) = \\pi = 0.30$ and thus $\\mathbb{P}(T_v=0) = 1 - \\pi = 1 - 0.30 = 0.70$.\n\nThe problem states that the atlas observations are conditionally independent given the true label $T_v$. This allows us to express the conditional probability of the label vector $\\boldsymbol{\\ell}_v$ as a product of individual probabilities:\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v) = \\prod_{i=1}^{3} \\mathbb{P}(\\ell_{iv} \\mid T_v) $$\nWe can now calculate the two conditional likelihood terms for voxel $v=2$, using the given sensitivities ($s_i$) and specificities ($c_i$).\n\n1.  **Likelihood given the true label is $1$ ($T_2 = 1$)**:\n    We use the sensitivities $s_i = \\mathbb{P}(\\ell_{iv}=1 \\mid T_v=1)$ and their complements $1-s_i = \\mathbb{P}(\\ell_{iv}=0 \\mid T_v=1)$.\n    For $\\boldsymbol{\\ell}_2 = (1, 0, 1)$:\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = \\mathbb{P}(\\ell_{1,2}=1 \\mid T_2=1) \\cdot \\mathbb{P}(\\ell_{2,2}=0 \\mid T_2=1) \\cdot \\mathbb{P}(\\ell_{3,2}=1 \\mid T_2=1) $$\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = s_1 \\cdot (1-s_2) \\cdot s_3 $$\n    Substituting the given values $s_1 = 0.90$, $s_2 = 0.85$, and $s_3 = 0.80$:\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = (0.90) \\cdot (1 - 0.85) \\cdot (0.80) = 0.90 \\cdot 0.15 \\cdot 0.80 = 0.108 $$\n\n2.  **Likelihood given the true label is $0$ ($T_2 = 0$)**:\n    We use the specificities $c_i = \\mathbb{P}(\\ell_{iv}=0 \\mid T_v=0)$ and their complements $1-c_i = \\mathbb{P}(\\ell_{iv}=1 \\mid T_v=0)$.\n    For $\\boldsymbol{\\ell}_2 = (1, 0, 1)$:\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = \\mathbb{P}(\\ell_{1,2}=1 \\mid T_2=0) \\cdot \\mathbb{P}(\\ell_{2,2}=0 \\mid T_2=0) \\cdot \\mathbb{P}(\\ell_{3,2}=1 \\mid T_2=0) $$\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = (1-c_1) \\cdot c_2 \\cdot (1-c_3) $$\n    Substituting the given values $c_1 = 0.95$, $c_2 = 0.90$, and $c_3 = 0.92$:\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = (1 - 0.95) \\cdot (0.90) \\cdot (1 - 0.92) = 0.05 \\cdot 0.90 \\cdot 0.08 = 0.0036 $$\n\nNow we combine these results to calculate the posterior probability $p_2$.\nThe numerator of Bayes' theorem is:\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1)\\mathbb{P}(T_2=1) = (0.108) \\cdot (0.30) = 0.0324 $$\nThe denominator (evidence) is:\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1)\\mathbb{P}(T_2=1) + \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0)\\mathbb{P}(T_2=0) $$\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = (0.108 \\cdot 0.30) + (0.0036 \\cdot 0.70) $$\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = 0.0324 + 0.00252 = 0.03492 $$\nFinally, the posterior probability $p_2$ is the ratio of the numerator to the denominator:\n$$ p_2 = \\frac{0.0324}{0.03492} \\approx 0.92783505... $$\nRounding the result to four significant figures, as requested, gives $0.9278$.", "answer": "$$\\boxed{0.9278}$$", "id": "4529145"}]}