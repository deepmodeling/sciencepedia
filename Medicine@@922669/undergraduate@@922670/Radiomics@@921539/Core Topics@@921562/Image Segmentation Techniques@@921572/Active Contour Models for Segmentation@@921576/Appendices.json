{"hands_on_practices": [{"introduction": "Active contours are dynamically guided by forces derived from the image. The most intuitive of these is the external force, which acts like a magnet pulling the contour towards features of interest, such as edges. This exercise provides a concrete example of this process, where you will calculate the force vector at a specific point based on an energy landscape constructed from a simple edge map. Completing this practice will give you a tangible understanding of how an active contour \"feels\" the image to perform segmentation [@problem_id:4528455].", "problem": "A radiomics pipeline seeks to segment a tumor boundary in a Magnetic Resonance Imaging (MRI) slice using active contour models (snakes). Consider a discrete image patch with pixel centers at integer lattice coordinates $(x,y)$ on a $6 \\times 6$ grid, where $x \\in \\{0,1,2,3,4,5\\}$ and $y \\in \\{0,1,2,3,4,5\\}$. An edge map is available, with two detected boundary pixels located at $(x_{e1},y_{e1}) = (1,3)$ and $(x_{e2},y_{e2}) = (4,1)$. Define the Euclidean distance transform (EDT) $D(x,y)$ by\n$$\nD(x,y) = \\min\\left\\{\\sqrt{(x-x_{e1})^{2} + (y-y_{e1})^{2}}, \\ \\sqrt{(x-x_{e2})^{2} + (y-y_{e2})^{2}}\\right\\}.\n$$\nTo attract the snake toward the edges, the external energy density is modeled as\n$$\nE_{\\text{ext}}(x,y) = \\frac{1}{2} \\, D(x,y)^{2},\n$$\nand the corresponding external force field is defined by the negative gradient of this potential,\n$$\n\\mathbf{F}_{\\text{ext}}(x,y) = - \\nabla E_{\\text{ext}}(x,y).\n$$\nTreat the pixel centers as points in a continuous plane and assume local differentiability of $D(x,y)$ wherever the nearest edge pixel is unique. For the snake control point located at $(x,y) = (2,2)$, compute the magnitude of the external force vector $|\\mathbf{F}_{\\text{ext}}(2,2)|$. Express your final answer as an exact value with no rounding, in dimensionless pixel units.", "solution": "The user has provided a problem to be solved. As per the instructions, the first step is a critical validation of the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   The problem is set on a $6 \\times 6$ grid of pixel centers at integer coordinates $(x,y)$ where $x \\in \\{0, 1, 2, 3, 4, 5\\}$ and $y \\in \\{0, 1, 2, 3, 4, 5\\}$.\n*   There are two detected boundary pixels: $P_{e1} = (x_{e1}, y_{e1}) = (1, 3)$ and $P_{e2} = (x_{e2}, y_{e2}) = (4, 1)$.\n*   The Euclidean distance transform (EDT) is defined as $D(x,y) = \\min\\left\\{\\sqrt{(x-x_{e1})^{2} + (y-y_{e1})^{2}}, \\ \\sqrt{(x-x_{e2})^{2} + (y-y_{e2})^{2}}\\right\\}$.\n*   The external energy density is $E_{\\text{ext}}(x,y) = \\frac{1}{2} \\, D(x,y)^{2}$.\n*   The external force field is $\\mathbf{F}_{\\text{ext}}(x,y) = - \\nabla E_{\\text{ext}}(x,y)$.\n*   The coordinate space $(x,y)$ is to be treated as a continuous plane for the purpose of differentiation.\n*   Local differentiability of $D(x,y)$ is assumed wherever the nearest edge pixel is unique.\n*   The task is to compute the magnitude of the external force vector, $|\\mathbf{F}_{\\text{ext}}(2,2)|$, at the point $(x,y) = (2,2)$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem is firmly rooted in the principles of computer vision and medical image analysis, specifically the theory of active contour models (snakes). The concepts of an energy functional, external energy derived from image features (here, an edge map represented by a distance transform), and forces as the negative gradient of potential energy are all standard and fundamental to the field. The setup is a simplified but correct representation of the external forces acting on a snake.\n*   **Well-Posed:** The problem provides all necessary definitions and data. The function $D(x,y)$ involves a $\\min$ operator, which makes it non-differentiable on the locus of points equidistant from $P_{e1}$ and $P_{e2}$. The problem statement explicitly acknowledges this by assuming differentiability \"wherever the nearest edge pixel is unique,\" which is the correct condition. The task is to calculate a specific value at a specific point, which is a well-defined mathematical problem. The existence and uniqueness of the solution depend on whether the point $(2,2)$ has a unique nearest edge point, a condition that can be verified.\n*   **Objective:** The problem is stated in precise, mathematical language, free of any subjectivity or ambiguity.\n*   **Other Flaws:** The problem does not violate any other validation criteria. It is complete, consistent, realistic (within the context of a modeling problem), and requires substantive calculation.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-formulated question based on established scientific principles. I will now proceed with the solution.\n\n### Solution\n\nThe objective is to compute the magnitude of the external force vector $\\mathbf{F}_{\\text{ext}}(x,y)$ at the specific point $(x,y)=(2,2)$. The force is defined as the negative gradient of the external energy potential, $\\mathbf{F}_{\\text{ext}} = - \\nabla E_{\\text{ext}}$.\n\nFirst, we must determine the expression for the external energy $E_{\\text{ext}}(x,y) = \\frac{1}{2} D(x,y)^2$ in the neighborhood of the point of interest, $P = (2,2)$. The definition of the Euclidean distance transform $D(x,y)$ involves a minimum operator, so we must identify which of the two edge points, $P_{e1}=(1,3)$ or $P_{e2}=(4,1)$, is closer to $P=(2,2)$.\n\nLet's compute the squared Euclidean distances from $P$ to $P_{e1}$ and $P_{e2}$.\nThe squared distance to $P_{e1}=(1,3)$ is:\n$$\nd_{1}^{2} = (x - x_{e1})^{2} + (y - y_{e1})^{2} = (2-1)^{2} + (2-3)^{2} = 1^{2} + (-1)^{2} = 1 + 1 = 2\n$$\nThe squared distance to $P_{e2}=(4,1)$ is:\n$$\nd_{2}^{2} = (x - x_{e2})^{2} + (y - y_{e2})^{2} = (2-4)^{2} + (2-1)^{2} = (-2)^{2} + 1^{2} = 4 + 1 = 5\n$$\nComparing the squared distances, we find that $d_{1}^{2} < d_{2}^{2}$ (since $2 < 5$). This confirms that $P_{e1}=(1,3)$ is the unique nearest edge pixel to the point $P=(2,2)$.\n\nAccording to the problem statement, since the nearest edge pixel is unique at $P=(2,2)$, we can treat the function $D(x,y)$ as differentiable in a local neighborhood around this point. In this neighborhood, the $\\min$ operator in the definition of $D(x,y)$ resolves to the distance from $P_{e1}$:\n$$\nD(x,y) = \\sqrt{(x - x_{e1})^{2} + (y - y_{e1})^{2}} = \\sqrt{(x - 1)^{2} + (y - 3)^{2}}\n$$\nThe external energy density is then given by:\n$$\nE_{\\text{ext}}(x,y) = \\frac{1}{2} D(x,y)^{2} = \\frac{1}{2} \\left[ (\\sqrt{(x - 1)^{2} + (y - 3)^{2}})^{2} \\right] = \\frac{1}{2} \\left( (x - 1)^{2} + (y - 3)^{2} \\right)\n$$\nNext, we compute the external force field $\\mathbf{F}_{\\text{ext}}(x,y)$ by taking the negative gradient of $E_{\\text{ext}}(x,y)$:\n$$\n\\mathbf{F}_{\\text{ext}}(x,y) = - \\nabla E_{\\text{ext}}(x,y) = - \\left( \\frac{\\partial E_{\\text{ext}}}{\\partial x} \\mathbf{i} + \\frac{\\partial E_{\\text{ext}}}{\\partial y} \\mathbf{j} \\right)\n$$\nWe calculate the partial derivatives of $E_{\\text{ext}}(x,y)$:\n$$\n\\frac{\\partial E_{\\text{ext}}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\frac{1}{2} \\left( (x - 1)^{2} + (y - 3)^{2} \\right) \\right] = \\frac{1}{2} \\cdot 2(x - 1) = x - 1\n$$\n$$\n\\frac{\\partial E_{\\text{ext}}}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\frac{1}{2} \\left( (x - 1)^{2} + (y - 3)^{2} \\right) \\right] = \\frac{1}{2} \\cdot 2(y - 3) = y - 3\n$$\nSubstituting these into the expression for the force gives:\n$$\n\\mathbf{F}_{\\text{ext}}(x,y) = - \\left( (x-1)\\mathbf{i} + (y-3)\\mathbf{j} \\right) = (1-x)\\mathbf{i} + (3-y)\\mathbf{j}\n$$\nThis result is intuitively correct: the force vector at any point $(x,y)$ points directly towards the nearest edge point, which is $(1,3)$ in this region.\n\nNow, we evaluate the force vector at the specific point $(x,y) = (2,2)$:\n$$\n\\mathbf{F}_{\\text{ext}}(2,2) = (1-2)\\mathbf{i} + (3-2)\\mathbf{j} = -1\\mathbf{i} + 1\\mathbf{j}\n$$\nThe vector components are $(-1, 1)$.\n\nFinally, we compute the magnitude of this force vector:\n$$\n|\\mathbf{F}_{\\text{ext}}(2,2)| = \\sqrt{(-1)^{2} + 1^{2}} = \\sqrt{1 + 1} = \\sqrt{2}\n$$\nThe magnitude of the external force vector at the point $(2,2)$ is $\\sqrt{2}$ in dimensionless pixel units.", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "4528455"}, {"introduction": "While many active contour models are drawn to edges, a powerful alternative approach uses regional information. Instead of seeking lines, models like the Chan-Vese algorithm try to partition the image into areas with the most uniform intensity. This practice places you at the core of such a model, asking you to calculate the optimal average intensities for the regions inside and outside a given contour [@problem_id:4528376]. This exercise demonstrates how region-based models quantify the \"fit\" of a contour, forming the basis for segmentation even in images with weak or missing edges.", "problem": "A radiomics segmentation task on a small computed tomography (CT) image slice is modeled using Active Contour Models (ACM, also called snakes) with a Chan-Vese type region-based energy. Consider a discrete image domain $\\Omega$ consisting of $3 \\times 3$ pixels indexed by $(i,j)$ with $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2,3\\}$. Let the measured intensities be given by the function $I : \\Omega \\to \\mathbb{R}$:\n- $I(1,1)=12$, $I(1,2)=10$, $I(1,3)=14$,\n- $I(2,1)=13$, $I(2,2)=11$, $I(2,3)=12$,\n- $I(3,1)=5$, $I(3,2)=4$, $I(3,3)=6$.\n\nLet $\\phi : \\Omega \\to \\mathbb{R}$ be a level set function whose sign indicates the current segmentation: pixels with $\\phi(i,j) > 0$ are considered inside the evolving contour and pixels with $\\phi(i,j) < 0$ are outside. The level set values are:\n- $\\phi(1,1)=0.8>0$, $\\phi(1,2)=0.3>0$, $\\phi(1,3)=1.2>0$,\n- $\\phi(2,1)=0.5>0$, $\\phi(2,2)=0.4>0$, $\\phi(2,3)=-0.2<0$,\n- $\\phi(3,1)=-0.6<0$, $\\phi(3,2)=-0.7<0$, $\\phi(3,3)=-0.4<0$.\n\nDefine the Heaviside function $H(\\cdot)$ by $H(\\phi(i,j))=1$ if $\\phi(i,j)>0$ and $H(\\phi(i,j))=0$ if $\\phi(i,j)<0$. Consider the Chan-Vese region-based data fidelity energy for fixed $\\phi$,\n$$\nE(c_{1},c_{2}\\,|\\,\\phi) \\;=\\; \\lambda_{1} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{1}\\big)^{2}\\, H\\!\\big(\\phi(i,j)\\big) \\;+\\; \\lambda_{2} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{2}\\big)^{2}\\, \\big(1 - H\\!\\big(\\phi(i,j)\\big)\\big),\n$$\nwith $\\lambda_{1}=\\lambda_{2}=1$. The geometric regularization terms depending on $\\phi$ (such as contour length and area penalties) are present in the full model but are independent of $c_{1}$ and $c_{2}$ and therefore can be ignored for the purpose of minimizing $E$ with respect to $c_{1}$ and $c_{2}$.\n\nTasks:\n- Starting from the above energy definition and basic principles of least-squares minimization, derive the update rules for $c_{1}$ and $c_{2}$ that minimize $E(c_{1},c_{2}\\,|\\,\\phi)$ for the given $\\phi$.\n- Using the provided $I$ and $\\phi$, compute the numerical values of $c_{1}$ and $c_{2}$.\n- Justify, from first principles, the convergence properties of alternating minimization over $c_{1}$ and $c_{2}$ for fixed $\\phi$ (i.e., update $c_{1}$ while holding $c_{2}$ fixed, then update $c_{2}$ while holding $c_{1}$ fixed, and repeat), focusing on existence, uniqueness, and energy monotonicity.\n\nExpress your final numerical answer as the ordered pair $\\big(c_{1},\\,c_{2}\\big)$ using exact arithmetic. Do not round. The final answer must be a single row matrix written using the LaTeX $\\texttt{pmatrix}$ environment, without units.", "solution": "The problem is valid as it is scientifically grounded in the well-established Chan-Vese model for image segmentation, is mathematically well-posed, self-contained, and objective. We will proceed with a full solution.\n\nThe problem asks for three things: the derivation of the update rules for the constants $c_{1}$ and $c_{2}$, the computation of their numerical values for the given image data and level set function, and a justification of the convergence properties of an alternating minimization scheme for these constants.\n\nLet the image domain be $\\Omega = \\{ (i,j) \\,|\\, i,j \\in \\{1,2,3\\} \\}$. The Chan-Vese energy functional for the constants $c_{1}$ and $c_{2}$, given a fixed level set function $\\phi$, is:\n$$\nE(c_{1},c_{2}\\,|\\,\\phi) \\;=\\; \\lambda_{1} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{1}\\big)^{2}\\, H\\!\\big(\\phi(i,j)\\big) \\;+\\; \\lambda_{2} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{2}\\big)^{2}\\, \\big(1 - H\\!\\big(\\phi(i,j)\\big)\\big)\n$$\nWith the given parameters $\\lambda_{1}=1$ and $\\lambda_{2}=1$, this simplifies to:\n$$\nE(c_{1},c_{2}) \\;=\\; \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{1}\\big)^{2}\\, H\\!\\big(\\phi(i,j)\\big) \\;+\\; \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{2}\\big)^{2}\\, \\big(1 - H\\!\\big(\\phi(i,j)\\big)\\big)\n$$\nFor notational clarity, let $\\Omega_{1} = \\{ (i,j) \\in \\Omega \\,|\\, \\phi(i,j) > 0 \\}$ be the set of pixels inside the contour, and $\\Omega_{2} = \\{ (i,j) \\in \\Omega \\,|\\, \\phi(i,j) < 0 \\}$ be the set of pixels outside. The Heaviside function $H(\\phi(i,j))$ is $1$ for $(i,j) \\in \\Omega_{1}$ and $0$ for $(i,j) \\in \\Omega_{2}$. The energy can then be written as:\n$$\nE(c_{1},c_{2}) \\;=\\; \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})^{2} \\;+\\; \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})^{2}\n$$\n\n**1. Derivation of the update rules for $c_1$ and $c_2$**\n\nTo find the values of $c_{1}$ and $c_{2}$ that minimize the energy $E(c_{1},c_{2})$, we must find the critical points by taking the partial derivatives with respect to $c_{1}$ and $c_{2}$ and setting them to zero. This is a necessary condition for a minimum.\n\nFor $c_{1}$, we compute the partial derivative:\n$$\n\\frac{\\partial E}{\\partial c_{1}} \\;=\\; \\frac{\\partial}{\\partial c_{1}} \\left( \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})^{2} \\right) \\;=\\; \\sum_{(i,j)\\in\\Omega_{1}} 2(I(i,j)-c_{1})(-1) \\;=\\; -2 \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})\n$$\nSetting this derivative to zero to find the minimum:\n$$\n-2 \\left( \\sum_{(i,j)\\in\\Omega_{1}} I(i,j) - \\sum_{(i,j)\\in\\Omega_{1}} c_{1} \\right) \\;=\\; 0\n$$\nSince $c_{1}$ is a constant over the sum, and letting $|\\Omega_{1}|$ be the number of pixels in $\\Omega_1$:\n$$\n\\sum_{(i,j)\\in\\Omega_{1}} I(i,j) - |\\Omega_{1}| c_{1} \\;=\\; 0\n$$\nSolving for $c_{1}$ yields the update rule:\n$$\nc_{1} \\;=\\; \\frac{\\sum_{(i,j)\\in\\Omega_{1}} I(i,j)}{|\\Omega_{1}|}\n$$\nThis is the mean intensity of all pixels inside the current contour.\n\nSimilarly, for $c_{2}$:\n$$\n\\frac{\\partial E}{\\partial c_{2}} \\;=\\; \\frac{\\partial}{\\partial c_{2}} \\left( \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})^{2} \\right) \\;=\\; \\sum_{(i,j)\\in\\Omega_{2}} 2(I(i,j)-c_{2})(-1) \\;=\\; -2 \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})\n$$\nSetting this derivative to zero:\n$$\n\\sum_{(i,j)\\in\\Omega_{2}} I(i,j) - |\\Omega_{2}| c_{2} \\;=\\; 0\n$$\nSolving for $c_{2}$ yields the update rule:\n$$\nc_{2} \\;=\\; \\frac{\\sum_{(i,j)\\in\\Omega_{2}} I(i,j)}{|\\Omega_{2}|}\n$$\nThis is the mean intensity of all pixels outside the current contour.\n\nTo confirm these are minima, we examine the second partial derivatives:\n$$\n\\frac{\\partial^{2}E}{\\partial c_{1}^{2}} \\;=\\; \\sum_{(i,j)\\in\\Omega_{1}} 2 \\;=\\; 2 |\\Omega_{1}| \\qquad \\qquad \\frac{\\partial^{2}E}{\\partial c_{2}^{2}} \\;=\\; \\sum_{(i,j)\\in\\Omega_{2}} 2 \\;=\\; 2 |\\Omega_{2}| \\qquad \\qquad \\frac{\\partial^{2}E}{\\partial c_{1} \\partial c_{2}} \\;=\\; 0\n$$\nSince $|\\Omega_{1}| > 0$ and $|\\Omega_{2}| > 0$ (assuming the segmentation is non-trivial), the second partial derivatives with respect to $c_1$ and $c_2$ are positive. The Hessian matrix is diagonal with positive entries, indicating it is positive definite. Therefore, the critical point $(c_1, c_2)$ is a unique global minimum.\n\n**2. Computation of numerical values**\n\nFirst, we must identify the sets $\\Omega_{1}$ and $\\Omega_{2}$ using the given level set function $\\phi(i,j)$.\n$\\Omega_{1} = \\{ (i,j) \\,|\\, \\phi(i,j) > 0 \\}$:\n$\\phi(1,1)=0.8>0$, $\\phi(1,2)=0.3>0$, $\\phi(1,3)=1.2>0$, $\\phi(2,1)=0.5>0$, $\\phi(2,2)=0.4>0$.\nSo, $\\Omega_{1} = \\{(1,1), (1,2), (1,3), (2,1), (2,2)\\}$. The size is $|\\Omega_{1}|=5$.\n\n$\\Omega_{2} = \\{ (i,j) \\,|\\, \\phi(i,j) < 0 \\}$:\n$\\phi(2,3)=-0.2<0$, $\\phi(3,1)=-0.6<0$, $\\phi(3,2)=-0.7<0$, $\\phi(3,3)=-0.4<0$.\nSo, $\\Omega_{2} = \\{(2,3), (3,1), (3,2), (3,3)\\}$. The size is $|\\Omega_{2}|=4$.\n\nNow we compute $c_{1}$ and $c_{2}$ using the derived formulas and the given intensities $I(i,j)$:\nFor $c_{1}$:\n$$\nc_{1} = \\frac{I(1,1)+I(1,2)+I(1,3)+I(2,1)+I(2,2)}{5} = \\frac{12+10+14+13+11}{5} = \\frac{60}{5} = 12\n$$\nFor $c_{2}$:\n$$\nc_{2} = \\frac{I(2,3)+I(3,1)+I(3,2)+I(3,3)}{4} = \\frac{12+5+4+6}{4} = \\frac{27}{4}\n$$\n\n**3. Justification of convergence properties**\n\nThe problem asks to justify the properties of an alternating minimization scheme, where one first updates $c_{1}$ holding $c_{2}$ fixed, and then updates $c_{2}$ holding the new $c_{1}$ fixed. Let the iteration be indexed by $k$.\nThe update steps would be:\nStep 1: $c_{1}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c, c_{2}^{(k)})$\nStep 2: $c_{2}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c_{1}^{(k+1)}, c)$\n\nA crucial observation from the energy function is that it is separable with respect to $c_{1}$ and $c_{2}$:\n$$\nE(c_{1},c_{2}) = E_{1}(c_{1}) + E_{2}(c_{2})\n$$\nwhere $E_{1}(c_{1}) = \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})^{2}$ and $E_{2}(c_{2}) = \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})^{2}$.\n\n**Existence and Uniqueness**: The function $E_{1}(c_{1})$ is a quadratic in $c_{1}$ with a positive leading coefficient ($|\\Omega_1|$), making it a strictly convex parabola. A strictly convex function has at most one minimum. Since it is also continuous and coercive (i.e., $E_{1}(c_1) \\to \\infty$ as $|c_1| \\to \\infty$), a unique global minimum is guaranteed to exist. The same argument holds for $E_{2}(c_{2})$. The unique minimizers are precisely the values we derived in the first section.\n\n**Energy Monotonicity**: For any alternating minimization (or coordinate descent) scheme on a convex function, the energy is guaranteed to be non-increasing at each step. Let $(c_{1}^{(k)}, c_{2}^{(k)})$ be the values at iteration $k$.\nThe first update gives $c_{1}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c, c_{2}^{(k)})$. By the definition of the minimum, we must have $E(c_{1}^{(k+1)}, c_{2}^{(k)}) \\leq E(c_{1}^{(k)}, c_{2}^{(k)})$.\nThe second update gives $c_{2}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c_{1}^{(k+1)}, c)$. Again, by definition, $E(c_{1}^{(k+1)}, c_{2}^{(k+1)}) \\leq E(c_{1}^{(k+1)}, c_{2}^{(k)})$.\nCombining these gives $E(c_{1}^{(k+1)}, c_{2}^{(k+1)}) \\leq E(c_{1}^{(k)}, c_{2}^{(k)})$, which proves the energy is monotonically non-increasing.\n\n**Convergence**: The separability of $E(c_1, c_2)$ has a powerful consequence. The minimization of $E$ with respect to $c_1$ is completely independent of the value of $c_2$, and vice versa.\n$$\n\\underset{c_{1}}{\\operatorname{argmin}} E(c_1, c_2) = \\underset{c_{1}}{\\operatorname{argmin}} (E_1(c_1) + E_2(c_2)) = \\underset{c_{1}}{\\operatorname{argmin}} E_1(c_1)\n$$\nThe solution of this minimization problem is the optimal $c_1^*$, which is $12$. This result is independent of the starting value or current value of $c_2$.\nSimilarly, minimizing with respect to $c_2$ gives the optimal $c_2^* = 27/4$, regardless of the value of $c_1$.\nTherefore, the very first step of the alternating minimization scheme, updating $c_1$, will set $c_1$ to its global optimal value $c_1^* = 12$. The second step will set $c_2$ to its global optimal value $c_2^* = 27/4$. The algorithm thus reaches the unique global minimum $(c_1^*, c_2^*)$ in exactly one iteration, regardless of the starting point. All subsequent iterations will yield the same values, confirming convergence.", "answer": "$$\n\\boxed{\\begin{pmatrix} 12 & \\frac{27}{4} \\end{pmatrix}}\n$$", "id": "4528376"}, {"introduction": "Understanding a model's components is the first step; the next is understanding its limitations. A classic challenge for active contours is their tendency to \"shortcut\" across concave boundaries, as the internal energy often penalizes the bending and extra length required to follow the true shape. This practice lets you quantify the energy trade-off between following a concave arc and taking a shortcut, revealing why this failure occurs [@problem_id:4528186]. By exploring solutions like Gradient Vector Flow (GVF), you will see how the basic model can be enhanced to overcome these intrinsic limitations and capture complex shapes more accurately.", "problem": "A radiomics segmentation task on a two-dimensional computed tomography image requires delineating a lesion boundary with a concave indentation. Consider a parametric active contour whose energy is the sum of internal regularization and an image-derived external attraction. Begin from the core definitions of the classical active contour internal energy and an edge-based external energy: the internal energy penalizes elasticity and curvature via the integral of $|v'(s)|^{2}$ and $|v''(s)|^{2}$, weighted by $ \\alpha $ and $ \\beta $, respectively, while the external energy is a line integral of an edge-derived potential that decreases the energy near image gradients. Assume the curve is parameterized approximately by arc length so that the elasticity term is proportional to curve length.\n\nThe indentation is well-approximated by a circular arc of radius $ r $ subtending central angle $ \\theta $, so its curvature is $ k = 1/r $ and arc length $ L_{\\text{arc}} = r \\theta $. The straight-line chord across the indentation has length $ L_{\\text{chord}} = 2 r \\sin(\\theta/2) $ and negligible curvature along that span. The edge strength near the true boundary produces an external energy reduction of $ \\mu $ per unit length along the arc, whereas the interior spanning the chord has a much weaker edge signal yielding $ \\mu_{i} $ per unit length.\n\nLet the base parameters be $ \\alpha = 0.5 $, $ \\beta = 2 $, $ r = 5 $, $ \\theta = \\pi/2 $, $ \\mu = 0.06 $, and $ \\mu_{i} = 0.01 $. Use the fact that the curvature contribution along the circular arc is $ \\int \\beta k^{2} \\, ds = \\beta \\int (1/r^{2}) \\, ds = \\beta L_{\\text{arc}} / r^{2} $.\n\nSuppose the snake can choose between following the concave arc or shortcutting across the chord. Based on first principles, quantify how curvature regularization interacts with concave boundaries and identify which adjustments make the arc energetically favorable over the chord, thereby preventing shortcutting while retaining regularization.\n\nConsider the following candidate adjustments, each to be evaluated independently with the indicated parameter changes:\n\nA. Globally increase the curvature weight from $ \\beta = 2 $ to $ \\beta = 4 $.\n\nB. Multiply the curvature weight by an edge indicator $ g(|\\nabla I|) $ that is small at strong edges and near $ 1 $ in homogeneous regions, setting $ g_{\\text{edge}} = 0.01 $ along the arc and $ g_{\\text{int}} = 1 $ along the chord so the curvature term becomes $ \\beta g(|\\nabla I|) \\int k^{2} ds $.\n\nC. Remove the elasticity term by setting $ \\alpha = 0 $.\n\nD. Introduce Gradient Vector Flow (GVF) external force (define GVF on first appearance), which propagates edge information into homogeneous regions and increases the effective external energy reduction near concave edges; model this by raising the per-length reduction along the arc from $ \\mu = 0.06 $ to $ \\mu_{\\text{GVF}} = 0.20 $, while keeping $ \\mu_{i} = 0.01 $ for the chord span.\n\nE. Introduce an edge-weighted length regularization by multiplying the elasticity coefficient with the same edge indicator $ g(|\\nabla I|) $, i.e., penalize length by $ \\alpha g(|\\nabla I|) $, with $ g_{\\text{edge}} = 0.01 $ along the arc and $ g_{\\text{int}} = 1 $ along the chord.\n\nWhich options prevent shortcutting across the concave indentation under the given numbers, and why?\n\nChoose all that apply.\n\nA. Increase $ \\beta $ globally from $ 2 $ to $ 4 $.\n\nB. Edge-weighted curvature regularization $ \\beta g(|\\nabla I|) $ with $ g_{\\text{edge}} = 0.01 $ and $ g_{\\text{int}} = 1 $.\n\nC. Remove elasticity by setting $ \\alpha = 0 $.\n\nD. Use Gradient Vector Flow (GVF) to increase the external attraction along the concave arc to $ \\mu_{\\text{GVF}} = 0.20 $.\n\nE. Edge-weighted length regularization $ \\alpha g(|\\nabla I|) $ with $ g_{\\text{edge}} = 0.01 $ and $ g_{\\text{int}} = 1 $.", "solution": "The user requires a critical validation of the problem statement, followed by a full solution deriving the answer from first principles and evaluating each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Model**: Parametric active contour (snake) for 2D image segmentation.\n- **Energy Function**: $E = E_{\\text{internal}} + E_{\\text{external}}$.\n- **Internal Energy**: $E_{\\text{internal}} = \\int (\\alpha |v'(s)|^{2} + \\beta |v''(s)|^{2}) \\, ds$. The term $\\alpha |v'(s)|^2$ penalizes elasticity, and $\\beta |v''(s)|^2$ penalizes curvature.\n- **Approximation**: The curve is parameterized approximately by arc length, so the elasticity term is proportional to curve length, which we can write as $\\alpha L$.\n- **External Energy**: An edge-derived potential that provides an energy reduction of $\\mu$ per unit length. This can be modeled as $E_{\\text{external}} = -\\int \\mu \\, ds = -\\mu L$.\n- **Geometric Setup**: A concave indentation approximated by a circular arc, versus a straight-line chord shortcut.\n    - **Arc Path**: Radius $r$, central angle $\\theta$, curvature $k = 1/r$, length $L_{\\text{arc}} = r \\theta$. External energy reduction per length is $\\mu$.\n    - **Chord Path**: Length $L_{\\text{chord}} = 2 r \\sin(\\theta/2)$, negligible curvature ($k \\approx 0$). External energy reduction per length is $\\mu_{i}$.\n- **Curvature Energy Formula**: The curvature energy along the arc is given as $\\int \\beta k^{2} \\, ds = \\beta L_{\\text{arc}} / r^{2}$.\n- **Base Parameters**:\n    - $\\alpha = 0.5$\n    - $\\beta = 2$\n    - $r = 5$ units\n    - $\\theta = \\pi/2$ radians\n    - $\\mu = 0.06$ (energy reduction per unit length on arc)\n    - $\\mu_{i} = 0.01$ (energy reduction per unit length on chord)\n- **Task**: For the snake to follow the concave boundary, the total energy of the arc path ($E_{\\text{arc}}$) must be less than the total energy of the chord path ($E_{\\text{chord}}$). The question is to identify which of the proposed adjustments to the model parameters achieve this condition ($E_{\\text{arc}} < E_{\\text{chord}}$).\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientific Groundedness**: The problem is grounded in the classical theory of active contour models (snakes) by Kass, Witkin, and Terzopoulos. The energy functional, its components (elasticity, curvature), and the concept of an external image-derived energy are all standard. The proposed modifications, such as Gradient Vector Flow (GVF) and spatially varying coefficients ($g(|\\nabla I|)$), are well-documented and established extensions to the original model. The use of a simplified geometric case (arc vs. chord) is a valid and common analytical approach.\n- **Well-Posedness**: The problem is well-posed. It establishes a clear, quantitative criterion ($E_{\\text{arc}} < E_{\\text{chord}}$) for success. For each option, all necessary information is provided to calculate the two energies and perform the comparison, leading to a unique, deterministic answer.\n- **Objectivity**: The problem is stated in objective, mathematical terms. All parameters are given numerical values, and the physical model is clearly defined. There is no ambiguity or subjective language.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, and objective. It contains no inconsistencies or missing information. Therefore, the problem is **valid**. I will proceed with the solution.\n\n### Solution Derivation\n\nThe total energy for a given path is the sum of its internal (elasticity and curvature) and external energies.\n$E = E_{\\text{elasticity}} + E_{\\text{curvature}} + E_{\\text{external}}$\n\nBased on the problem statement's definitions:\n- Elasticity energy: $E_{\\text{elasticity}} = \\alpha L$\n- Curvature energy: $E_{\\text{curvature}} = \\int \\beta k^2 \\, ds$\n- External energy: $E_{\\text{external}} = -\\mu L$\n\nThe total energy is $E = (\\alpha - \\mu)L + \\int \\beta k^2 \\, ds$.\n\n**Energy of the Arc Path ($E_{\\text{arc}}$)**\n- Length: $L_{\\text{arc}} = r \\theta$\n- Curvature: $k = 1/r$ is constant.\n- Curvature Energy: $\\int \\beta k^2 \\, ds = \\beta (1/r)^2 \\int_0^{L_{\\text{arc}}} ds = \\frac{\\beta L_{\\text{arc}}}{r^2} = \\frac{\\beta (r \\theta)}{r^2} = \\frac{\\beta \\theta}{r}$.\n- Total Arc Energy: $E_{\\text{arc}} = (\\alpha - \\mu)L_{\\text{arc}} + \\frac{\\beta L_{\\text{arc}}}{r^2} = (\\alpha - \\mu)r\\theta + \\frac{\\beta \\theta}{r}$.\n\n**Energy of the Chord Path ($E_{\\text{chord}}$)**\n- Length: $L_{\\text{chord}} = 2r \\sin(\\theta/2)$\n- Curvature: $k \\approx 0$, so the curvature energy is $0$.\n- Note: The external energy reduction along the chord is $\\mu_i$.\n- Total Chord Energy: $E_{\\text{chord}} = (\\alpha - \\mu_i)L_{\\text{chord}} = (\\alpha - \\mu_i)2r \\sin(\\theta/2)$.\n\nThe condition to prevent shortcutting is $E_{\\text{arc}} < E_{\\text{chord}}$.\n\n**Base Case Calculation**\nFirst, we evaluate the energies for the base parameters: $\\alpha = 0.5$, $\\beta = 2$, $r = 5$, $\\theta = \\pi/2$, $\\mu = 0.06$, $\\mu_i = 0.01$.\n\n- $L_{\\text{arc}} = 5(\\pi/2) = 2.5\\pi \\approx 7.854$\n- $L_{\\text{chord}} = 2(5)\\sin(\\pi/4) = 10(\\frac{\\sqrt{2}}{2}) = 5\\sqrt{2} \\approx 7.071$\n\nNow, we calculate the energies:\n$E_{\\text{arc}} = (0.5 - 0.06) (2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = 0.44(2.5\\pi) + \\frac{5\\pi}{25} = 1.1\\pi + 0.2\\pi = 1.3\\pi \\approx 4.084$\n$E_{\\text{chord}} = (0.5 - 0.01) (5\\sqrt{2}) = 0.49 (5\\sqrt{2}) = 2.45\\sqrt{2} \\approx 3.465$\n\nSince $E_{\\text{arc}} \\approx 4.084 > E_{\\text{chord}} \\approx 3.465$, the snake shortcuts across the chord in the base case. We now evaluate each option to see if it reverses this inequality.\n\n### Option-by-Option Analysis\n\n**A. Increase $ \\beta $ globally from $ 2 $ to $ 4 $.**\nThis modification changes $\\beta$ to $4$. All other parameters remain at their base values. This only affects $E_{\\text{arc}}$.\n$E_{\\text{arc, new}} = (0.5 - 0.06) (2.5\\pi) + \\frac{4(2.5\\pi)}{5^2} = 1.1\\pi + \\frac{10\\pi}{25} = 1.1\\pi + 0.4\\pi = 1.5\\pi \\approx 4.712$\n$E_{\\text{chord}}$ remains $\\approx 3.465$.\nWe check the condition $E_{\\text{arc, new}} < E_{\\text{chord}}$: $4.712 < 3.465$ is false.\nIncreasing the curvature weight $\\beta$ penalizes bending more heavily. Since the arc path has significant curvature and the chord path has none, this change increases the energy of the arc, making the shortcut even more favorable.\n**Verdict: Incorrect**\n\n**B. Edge-weighted curvature regularization $ \\beta g(|\\nabla I|) $ with $ g_{\\text{edge}} = 0.01 $ and $ g_{\\text{int}} = 1 $.**\nThis introduces a spatially varying curvature weight. Along the arc (a strong edge), the effective coefficient is $\\beta_{\\text{arc}} = \\beta \\cdot g_{\\text{edge}} = 2 \\cdot 0.01 = 0.02$. Along the chord (a homogeneous region), the coefficient would be $\\beta_{\\text{chord}} = \\beta \\cdot g_{\\text{int}} = 2 \\cdot 1 = 2$, but its curvature is zero anyway. We re-calculate $E_{\\text{arc}}$ with $\\beta_{\\text{arc}}$.\n$E_{\\text{arc, new}} = (0.5 - 0.06) (2.5\\pi) + \\frac{0.02(2.5\\pi)}{5^2} = 1.1\\pi + \\frac{0.05\\pi}{25} = 1.1\\pi + 0.002\\pi = 1.102\\pi \\approx 3.4620$\n$E_{\\text{chord}}$ remains $\\approx 3.465$.\nWe check the condition $E_{\\text{arc, new}} < E_{\\text{chord}}$: $3.4620 < 3.465$ is true.\nBy drastically reducing the curvature penalty at strong edges, this method allows the snake to bend and follow the true concave boundary without a large energy cost. The arc path becomes slightly more energetically favorable than the chord.\n**Verdict: Correct**\n\n**C. Remove the elasticity term by setting $ \\alpha = 0 $.**\nThis modification sets $\\alpha = 0$.\n$E_{\\text{arc, new}} = (0 - 0.06) (2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = -0.15\\pi + 0.2\\pi = 0.05\\pi \\approx 0.157$\n$E_{\\text{chord, new}} = (0 - 0.01) (5\\sqrt{2}) = -0.05\\sqrt{2} \\approx -0.071$\nWe check the condition $E_{\\text{arc, new}} < E_{\\text{chord, new}}$: $0.157 < -0.071$ is false.\nSetting $\\alpha=0$ removes the penalty on length. Since $L_{\\text{arc}} > L_{\\text{chord}}$, this disproportionately benefits the arc path. However, with the given parameters, the remaining energy balance (external vs. curvature) is not sufficient to make the arc path more favorable than the chord path. The chord's energy becomes negative and lower than the arc's positive energy.\n**Verdict: Incorrect**\n\n**D. Use Gradient Vector Flow (GVF) to increase the external attraction along the concave arc to $ \\mu_{\\text{GVF}} = 0.20 $.**\nGradient Vector Flow (GVF) is an external force field computed by diffusing the gradient of an edge map of the image. Its primary advantage is the creation of a larger capture range for the snake and its ability to actively pull the snake into concave boundary regions. The problem models this effect as an increase in the external energy reduction along the arc path, setting $\\mu = \\mu_{\\text{GVF}} = 0.20$.\n$E_{\\text{arc, new}} = (0.5 - 0.20) (2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = 0.3(2.5\\pi) + 0.2\\pi = 0.75\\pi + 0.2\\pi = 0.95\\pi \\approx 2.985$\n$E_{\\text chords}$ remains $\\approx 3.465$.\nWe check the condition $E_{\\text{arc, new}} < E_{\\text{chord}}$: $2.985 < 3.465$ is true.\nBy significantly increasing the energy reduction (attraction) along the arc, GVF makes following the true boundary much more rewarding. This strong external attraction overcomes the internal energy penalties for length and curvature, making the arc path significantly lower in energy than the shortcut.\n**Verdict: Correct**\n\n**E. Edge-weighted length regularization $ \\alpha g(|\\nabla I|) $ with $ g_{\\text{edge}} = 0.01 $ and $ g_{\\text{int}} = 1 $.**\nThis introduces a spatially varying elasticity weight. Along the arc, the effective coefficient is $\\alpha_{\\text{arc}} = \\alpha \\cdot g_{\\text{edge}} = 0.5 \\cdot 0.01 = 0.005$. Along the chord, the coefficient is $\\alpha_{\\text{chord}} = \\alpha \\cdot g_{\\text{int}} = 0.5 \\cdot 1 = 0.5$.\nWe must re-calculate both energies with their respective $\\alpha$ values.\n$E_{\\text{arc, new}} = (0.005 - 0.06)(2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = -0.055(2.5\\pi) + 0.2\\pi = -0.1375\\pi + 0.2\\pi = 0.0625\\pi \\approx 0.196$\n$E_{\\text{chord, new}} = (0.5 - 0.01)(5\\sqrt{2}) = 0.49(5\\sqrt{2}) \\approx 3.465$ (The chord energy is unchanged).\nWe check the condition $E_{\\text{arc, new}} < E_{\\text{chord, new}}$: $0.196 < 3.465$ is true.\nThe standard elasticity term $\\alpha L$ penalizes longer paths, which disfavors the arc. By making $\\alpha$ small at strong edges, we nearly eliminate the length penalty for following the true boundary. This dramatically reduces the arc's energy, making it much more favorable than the chord, which still has a high length penalty as it passes through a region with no edges.\n**Verdict: Correct**", "answer": "$$\\boxed{BDE}$$", "id": "4528186"}]}