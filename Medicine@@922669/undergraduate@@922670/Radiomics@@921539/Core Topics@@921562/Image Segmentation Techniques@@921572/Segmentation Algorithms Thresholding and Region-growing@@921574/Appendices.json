{"hands_on_practices": [{"introduction": "Effective image segmentation often begins with choosing the right intensity threshold. This exercise demonstrates that this choice need not be arbitrary; we can derive an optimal threshold based on the statistical properties of the image data. By applying Bayes' decision theory to a scenario involving a medical phantom, you will learn to calculate a threshold that minimizes misclassification between two tissue types, a fundamental skill in developing robust segmentation algorithms. [@problem_id:4560843]", "problem": "A radiomics team aims to calibrate an intensity threshold for a seeded region-growing segmentation algorithm in Computed Tomography (CT). They use a cylindrical phantom with two homogeneous compartments: a background compartment filled with water and an insert made of a tissue-mimicking polymer. Scans are acquired with the same protocol as the clinical workflow. Within manually drawn regions of interest (ROIs) on the phantom, the observed voxel intensities (in Hounsfield Units (HU)) in each compartment are well modeled by a Gaussian probability density function (PDF) due to scanner noise. Repeated measurements confirm that, under the protocol of interest, the noise variance is approximately equal across compartments. The team will use a single global threshold for intensity-based inclusion in the region-growing step.\n\nFrom the phantom, the following calibrated parameters are obtained:\n- Background compartment: mean intensity $\\mu_{b} = 0$ HU.\n- Insert compartment: mean intensity $\\mu_{t} = 60$ HU.\n- Common standard deviation across both compartments: $\\sigma = 12$ HU.\n- Fractional ROI areas, used to approximate class priors: $\\pi_{b} = 0.85$ for background and $\\pi_{t} = 0.15$ for insert.\n\nAssume equal misclassification costs. Starting from Bayesâ€™ decision rule and the Gaussian PDF definition, derive the decision threshold $T$ (in HU) that minimizes the total probability of misclassification when classifying a voxel of intensity $x$ into background versus insert, and hence will be used as the inclusion threshold in seeded region growing. You must explicitly obtain $T$ in closed form and then evaluate it numerically using the given parameters. Express the final threshold in Hounsfield Units (HU) and round your numerical answer to four significant figures.", "solution": "The problem requires the determination of an optimal intensity threshold, $T$, for classifying a voxel of intensity $x$ into one of two classes: background ($C_b$) or tissue insert ($C_t$). The optimality criterion is the minimization of the total probability of misclassification, which, under the assumption of equal misclassification costs, is achieved by applying Bayes' decision rule. The decision threshold $T$ is the intensity value where the posterior probabilities of the two classes are equal.\n\nThe posterior probability of a class $C_k$ given an observed intensity $x$ is given by Bayes' theorem:\n$$P(C_k|x) = \\frac{p(x|C_k)P(C_k)}{p(x)}$$\nwhere $k \\in \\{b, t\\}$. Here, $P(C_k)$ is the prior probability of class $C_k$, which is given by $\\pi_k$. The term $p(x|C_k)$ is the class-conditional probability density function (PDF), or likelihood, of observing intensity $x$ given that the voxel belongs to class $C_k$. The term $p(x)$ is the evidence, which is a normalization constant.\n\nThe decision threshold $T$ is the value of $x$ at which a voxel is equally likely to belong to either class. This occurs when the posterior probabilities are equal:\n$$P(C_b|T) = P(C_t|T)$$\nSubstituting the expression from Bayes' theorem:\n$$\\frac{p(T|C_b)P(C_b)}{p(T)} = \\frac{p(T|C_t)P(C_t)}{p(T)}$$\nThe evidence term $p(T)$ cancels, and substituting the priors $\\pi_b$ and $\\pi_t$, we get:\n$$p(T|C_b)\\pi_b = p(T|C_t)\\pi_t$$\nThe problem states that the voxel intensities for each class are modeled by a Gaussian PDF. The general form of a Gaussian PDF is:\n$$f(x; \\mu, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$$\nFor our two classes, the likelihoods are:\n$$p(x|C_b) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu_b)^2}{2\\sigma^2}\\right)$$\n$$p(x|C_t) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu_t)^2}{2\\sigma^2}\\right)$$\nNote that the standard deviation $\\sigma$ is common to both classes.\n\nSubstituting these into the decision boundary equation at $x=T$:\n$$\\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(T - \\mu_b)^2}{2\\sigma^2}\\right) \\pi_b = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(T - \\mu_t)^2}{2\\sigma^2}\\right) \\pi_t$$\nThe normalization factor $\\frac{1}{\\sqrt{2\\pi}\\sigma}$ cancels from both sides:\n$$\\pi_b \\exp\\left(-\\frac{(T - \\mu_b)^2}{2\\sigma^2}\\right) = \\pi_t \\exp\\left(-\\frac{(T - \\mu_t)^2}{2\\sigma^2}\\right)$$\nTo solve for $T$, we take the natural logarithm of both sides:\n$$\\ln(\\pi_b) - \\frac{(T - \\mu_b)^2}{2\\sigma^2} = \\ln(\\pi_t) - \\frac{(T - \\mu_t)^2}{2\\sigma^2}$$\nRearranging the terms to isolate the logarithms:\n$$\\frac{(T - \\mu_t)^2}{2\\sigma^2} - \\frac{(T - \\mu_b)^2}{2\\sigma^2} = \\ln(\\pi_t) - \\ln(\\pi_b)$$\nMultiply both sides by $2\\sigma^2$:\n$$(T - \\mu_t)^2 - (T - \\mu_b)^2 = 2\\sigma^2 (\\ln(\\pi_t) - \\ln(\\pi_b)) = -2\\sigma^2 (\\ln(\\pi_b) - \\ln(\\pi_t)) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\nExpand the squared terms:\n$$(T^2 - 2T\\mu_t + \\mu_t^2) - (T^2 - 2T\\mu_b + \\mu_b^2) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\nThe $T^2$ terms cancel out:\n$$-2T\\mu_t + \\mu_t^2 + 2T\\mu_b - \\mu_b^2 = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\nGroup the terms containing $T$:\n$$2T(\\mu_b - \\mu_t) + (\\mu_t^2 - \\mu_b^2) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\nIsolate the term with $T$:\n$$2T(\\mu_b - \\mu_t) = (\\mu_b^2 - \\mu_t^2) + 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n$$2T(\\mu_b - \\mu_t) = (\\mu_b - \\mu_t)(\\mu_b + \\mu_t) + 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\nAssuming $\\mu_b \\neq \\mu_t$, we can divide by $2(\\mu_b - \\mu_t)$:\n$$T = \\frac{\\mu_b + \\mu_t}{2} + \\frac{\\sigma^2}{\\mu_b - \\mu_t} \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\nTo match the convention where $\\mu_t > \\mu_b$, we can rewrite this as:\n$$T = \\frac{\\mu_b + \\mu_t}{2} - \\frac{\\sigma^2}{\\mu_t - \\mu_b} \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right) = \\frac{\\mu_b + \\mu_t}{2} + \\frac{\\sigma^2}{\\mu_t - \\mu_b} \\ln\\left(\\left(\\frac{\\pi_t}{\\pi_b}\\right)^{-1}\\right)$$\n$$T = \\frac{\\mu_b + \\mu_t}{2} + \\frac{\\sigma^2}{\\mu_t - \\mu_b} \\ln\\left(\\frac{\\pi_b}{\\pi_t}\\right)$$\nThis is the closed-form expression for the optimal threshold $T$. The first term is the midpoint between the class means, and the second term is a correction factor that accounts for the unequal priors. As $\\pi_b > \\pi_t$, the logarithm term is positive, shifting the threshold from the midpoint toward the mean of the less probable class (insert, $\\mu_t$).\n\nNow, we substitute the given numerical values:\n- $\\mu_{b} = 0$ HU\n- $\\mu_{t} = 60$ HU\n- $\\sigma = 12$ HU\n- $\\pi_{b} = 0.85$\n- $\\pi_{t} = 0.15$\n\n$$T = \\frac{0 + 60}{2} + \\frac{12^2}{60 - 0} \\ln\\left(\\frac{0.85}{0.15}\\right)$$\n$$T = 30 + \\frac{144}{60} \\ln\\left(\\frac{17}{3}\\right)$$\n$$T = 30 + 2.4 \\ln\\left(\\frac{17}{3}\\right)$$\nCalculating the numerical value:\n$$\\ln\\left(\\frac{17}{3}\\right) \\approx \\ln(5.66666...) \\approx 1.734601$$\n$$T \\approx 30 + 2.4 \\times 1.734601$$\n$$T \\approx 30 + 4.1630424$$\n$$T \\approx 34.1630424$$\nRounding to four significant figures, the optimal threshold is $34.16$ HU.", "answer": "$$\\boxed{34.16}$$", "id": "4560843"}, {"introduction": "Creating a segmentation is only half the battle; we must also be able to measure its quality. This practice introduces one of the most common metrics for this purpose: the Dice similarity coefficient, which quantifies the overlap between a segmentation result and a known ground truth. You will calculate the Dice coefficient for several different thresholds to determine which one yields the most accurate result, providing you with a core skill for validating and optimizing any segmentation method. [@problem_id:4560855]", "problem": "A radiomics pipeline performs tumor segmentation in a two-dimensional medical image by first applying a global intensity threshold and then constraining the result with a connected-component region-growing step from a known tumor seed. The global threshold produces a mask $\\mathcal{M}_{t} = \\{ x \\,|\\, I(x) \\ge t \\}$, where $I(x)$ is the observed intensity at pixel $x$ and $t$ is a unitless threshold. The final segmentation $\\mathcal{S}_{t}$ is defined as the $4$-connected component of $\\mathcal{M}_{t}$ that contains the seed. Segmentation quality is evaluated against a ground truth set $\\mathcal{G}$ using the Dice similarity coefficient, defined by $D(t) = \\dfrac{2|\\mathcal{S}_{t} \\cap \\mathcal{G}|}{|\\mathcal{S}_{t}| + |\\mathcal{G}|}$.\n\nYou are given that the ground truth tumor consists of $|\\mathcal{G}| = 40$ pixels. Due to the combined effect of thresholding and region-growing connectivity, the following measured counts hold for five candidate unitless thresholds:\n- For $t = 5$: $|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 40$ and $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 12$.\n- For $t = 6$: $|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 38$ and $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 8$.\n- For $t = 7$: $|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 35$ and $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 4$.\n- For $t = 8$: $|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 30$ and $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 2$.\n- For $t = 9$: $|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 20$ and $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 0$.\n\nStarting from the formal definitions above, determine the threshold $t^{\\ast} \\in \\{5,6,7,8,9\\}$ that maximizes the Dice similarity coefficient $D(t)$. Express your final answer as the single unitless number $t^{\\ast}$. No rounding is required.", "solution": "The objective is to determine the threshold $t^{\\ast}$ from the discrete set $\\{5, 6, 7, 8, 9\\}$ that maximizes the Dice similarity coefficient, $D(t)$. The Dice coefficient is defined as:\n$$D(t) = \\frac{2|\\mathcal{S}_{t} \\cap \\mathcal{G}|}{|\\mathcal{S}_{t}| + |\\mathcal{G}|}$$\nwhere $\\mathcal{S}_{t}$ is the segmented region for a given threshold $t$, and $\\mathcal{G}$ is the ground truth region. We are given that the size of the ground truth region is $|\\mathcal{G}| = 40$.\n\nFor each candidate threshold $t$, we are provided with the size of the intersection of the segmentation and the ground truth, $|\\mathcal{S}_{t} \\cap \\mathcal{G}|$ (the number of true positive pixels), and the size of the set difference between the segmentation and the ground truth, $|\\mathcal{S}_{t} \\setminus \\mathcal{G}|$ (the number of false positive pixels).\n\nTo calculate $D(t)$, we must first determine the size of the segmented region, $|\\mathcal{S}_{t}|$. The set $\\mathcal{S}_{t}$ can be partitioned into two disjoint subsets: the part that overlaps with the ground truth, $\\mathcal{S}_{t} \\cap \\mathcal{G}$, and the part that does not, $\\mathcal{S}_{t} \\setminus \\mathcal{G}$. Therefore, the size of the segmentation is the sum of the sizes of these two parts:\n$$|\\mathcal{S}_{t}| = |\\mathcal{S}_{t} \\cap \\mathcal{G}| + |\\mathcal{S}_{t} \\setminus \\mathcal{G}|$$\n\nWe now proceed to calculate $|\\mathcal{S}_{t}|$ and subsequently $D(t)$ for each of the five given thresholds.\n\nFor $t = 5$:\nGiven $|\\mathcal{S}_{5} \\cap \\mathcal{G}| = 40$ and $|\\mathcal{S}_{5} \\setminus \\mathcal{G}| = 12$.\nThe size of the segmentation is $|\\mathcal{S}_{5}| = 40 + 12 = 52$.\nThe Dice coefficient is $D(5) = \\dfrac{2 \\times 40}{52 + 40} = \\dfrac{80}{92}$.\n\nFor $t = 6$:\nGiven $|\\mathcal{S}_{6} \\cap \\mathcal{G}| = 38$ and $|\\mathcal{S}_{6} \\setminus \\mathcal{G}| = 8$.\nThe size of the segmentation is $|\\mathcal{S}_{6}| = 38 + 8 = 46$.\nThe Dice coefficient is $D(6) = \\dfrac{2 \\times 38}{46 + 40} = \\dfrac{76}{86}$.\n\nFor $t = 7$:\nGiven $|\\mathcal{S}_{7} \\cap \\mathcal{G}| = 35$ and $|\\mathcal{S}_{7} \\setminus \\mathcal{G}| = 4$.\nThe size of the segmentation is $|\\mathcal{S}_{7}| = 35 + 4 = 39$.\nThe Dice coefficient is $D(7) = \\dfrac{2 \\times 35}{39 + 40} = \\dfrac{70}{79}$.\n\nFor $t = 8$:\nGiven $|\\mathcal{S}_{8} \\cap \\mathcal{G}| = 30$ and $|\\mathcal{S}_{8} \\setminus \\mathcal{G}| = 2$.\nThe size of the segmentation is $|\\mathcal{S}_{8}| = 30 + 2 = 32$.\nThe Dice coefficient is $D(8) = \\dfrac{2 \\times 30}{32 + 40} = \\dfrac{60}{72}$.\n\nFor $t = 9$:\nGiven $|\\mathcal{S}_{9} \\cap \\mathcal{G}| = 20$ and $|\\mathcal{S}_{9} \\setminus \\mathcal{G}| = 0$.\nThe size of the segmentation is $|\\mathcal{S}_{9}| = 20 + 0 = 20$.\nThe Dice coefficient is $D(9) = \\dfrac{2 \\times 20}{20 + 40} = \\dfrac{40}{60}$.\n\nThe final step is to compare these five values to find the maximum. We can simplify the fractions and convert to decimal form for comparison.\n$D(5) = \\dfrac{80}{92} = \\dfrac{20}{23} \\approx 0.8696$\n$D(6) = \\dfrac{76}{86} = \\dfrac{38}{43} \\approx 0.8837$\n$D(7) = \\dfrac{70}{79} \\approx 0.8861$\n$D(8) = \\dfrac{60}{72} = \\dfrac{5}{6} \\approx 0.8333$\n$D(9) = \\dfrac{40}{60} = \\dfrac{2}{3} \\approx 0.6667$\n\nComparing these values:\n$0.8861 > 0.8837 > 0.8696 > 0.8333 > 0.6667$.\nThe maximum value is $D(7) = \\dfrac{70}{79}$.\nThus, the threshold that maximizes the Dice similarity coefficient is $t^{\\ast} = 7$.", "answer": "$$\\boxed{7}$$", "id": "4560855"}, {"introduction": "Segmentation algorithms rarely operate in isolation; they are typically part of a larger processing pipeline where each step influences the others. This advanced problem explores the critical trade-off between noise suppression and feature preservation in a realistic workflow involving smoothing, seed selection, and region growing. By analyzing how different levels of preprocessing impact subsequent steps, you will develop a deeper understanding of how to balance competing requirements to design an effective, end-to-end segmentation solution. [@problem_id:4560842]", "problem": "In a Computed Tomography (CT) radiomics workflow, a lesion is segmented using a pipeline that first applies intensity thresholding to generate seeds and then performs region-growing with a gradient-based stop criterion. The lesion and surrounding parenchyma can be modeled as two homogeneous regions separated by a sharp boundary. Intensities in each region are corrupted by additive white Gaussian noise with variance $\\sigma_n^2$ per pixel. Consider the following scientifically grounded modeling assumptions for this slice:\n- The background (parenchyma) and lesion have mean Hounsfield Unit (HU) intensities $\\mu_b = 130$ HU and $\\mu_\\ell = 90$ HU, respectively, so the boundary contrast is $C = |\\mu_b - \\mu_\\ell| = 40$ HU.\n- Noise is zero-mean, spatially white, Gaussian with variance $\\sigma_n^2 = 25$ HU$^2$ per pixel.\n- Seeds are generated by global thresholding at $\\tau = 110$ HU on the preprocessed image. The acceptable probability of a false seed formed by a single background pixel (i.e., a background pixel falling below $\\tau$) must satisfy $p_{\\text{seed}} \\leq p_{\\text{seed}}^{\\max} = 10^{-6}$.\n- Region-growing operates on the same preprocessed image and stops when the magnitude of the image gradient normal to the boundary exceeds $\\gamma_{\\min} = 12$ HU/pixel; this is to prevent leakage across the lesion boundary.\n- The boundary is locally well-approximated by a one-dimensional step edge of amplitude $C$.\n- Preprocessing is isotropic, unit-normalized Gaussian smoothing in two dimensions with standard deviation $\\sigma$ (in pixels). Four candidate choices are considered: $\\sigma \\in \\{0, 0.5, 1.0, 2.0\\}$, where $\\sigma = 0$ indicates no smoothing.\n\nUnder these assumptions and requirements, which preprocessing choice best balances noise suppression and edge preservation, meaning it maximizes noise suppression subject to simultaneously satisfying both the false-seed constraint and the region-growing boundary stop constraint?\n\nA. Apply Gaussian smoothing with $\\sigma = 2.0$, then threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\n\nB. Apply Gaussian smoothing with $\\sigma = 1.0$, then threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\n\nC. No smoothing ($\\sigma = 0$); threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\n\nD. Apply Gaussian smoothing with $\\sigma = 0.5$, then threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.", "solution": "The objective is to find the largest value of $\\sigma$ from the set $\\{0, 0.5, 1.0, 2.0\\}$ that satisfies two constraints: one on the probability of false seed generation and another on the gradient at the lesion boundary. Maximizing noise suppression is equivalent to maximizing the smoothing parameter $\\sigma$, as more aggressive smoothing reduces noise variance more effectively.\n\n**Constraint 1: False Seed Probability**\n\nA false seed is generated if a background pixel's intensity, after smoothing, falls below the threshold $\\tau = 110$ HU. The original background pixels have a mean intensity of $\\mu_b = 130$ HU and are corrupted by noise with variance $\\sigma_n^2 = 25$ HU$^2$.\n\nThe preprocessing step involves convolving the image with a 2D Gaussian kernel of standard deviation $\\sigma$. For a pixel in a homogeneous background region (far from the boundary), the mean intensity remains unchanged at $\\mu_b = 130$ HU. The variance of the noise, however, is reduced. For an input white noise with variance $\\sigma_n^2$, the variance of the noise after continuous Gaussian filtering is given by:\n$$ \\sigma_s^2(\\sigma) = \\sigma_n^2 \\iint_{-\\infty}^{\\infty} \\left[ G(x,y;\\sigma) \\right]^2 dx dy $$\nFor a unit-normalized 2D Gaussian kernel $G(x,y;\\sigma) = \\frac{1}{2\\pi\\sigma^2} e^{-(x^2+y^2)/(2\\sigma^2)}$, this evaluates to:\n$$ \\sigma_s^2(\\sigma) = \\frac{\\sigma_n^2}{4\\pi\\sigma^2} \\quad \\text{for } \\sigma > 0 $$\nFor the case of no smoothing ($\\sigma = 0$), the variance is unchanged: $\\sigma_s^2(0) = \\sigma_n^2 = 25$ HU$^2$.\n\nThe intensity of a smoothed background pixel, $I_s$, follows a normal distribution $I_s \\sim \\mathcal{N}(\\mu_b, \\sigma_s^2(\\sigma))$. The probability of a false seed is:\n$$ p_{\\text{seed}} = P(I_s < \\tau) = P\\left( \\frac{I_s - \\mu_b}{\\sigma_s(\\sigma)} < \\frac{\\tau - \\mu_b}{\\sigma_s(\\sigma)} \\right) $$\nLet $Z$ be a standard normal random variable, $Z \\sim \\mathcal{N}(0, 1)$.\n$$ p_{\\text{seed}} = P\\left( Z < \\frac{110 - 130}{\\sigma_s(\\sigma)} \\right) = \\Phi\\left( -\\frac{20}{\\sigma_s(\\sigma)} \\right) $$\nwhere $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution. The constraint is $p_{\\text{seed}} \\leq 10^{-6}$.\n$$ \\Phi\\left( -\\frac{20}{\\sigma_s(\\sigma)} \\right) \\leq 10^{-6} $$\nFrom statistical tables or a calculator for the inverse CDF, the z-score corresponding to a cumulative probability of $10^{-6}$ is approximately $z_{\\text{crit}} \\approx -4.753$. Therefore, we must have:\n$$ -\\frac{20}{\\sigma_s(\\sigma)} \\leq -4.753 $$\n$$ \\frac{20}{\\sigma_s(\\sigma)} \\geq 4.753 \\implies \\sigma_s(\\sigma) \\leq \\frac{20}{4.753} \\approx 4.208 \\text{ HU} $$\nThis implies the variance of the smoothed pixel must satisfy:\n$$ \\sigma_s^2(\\sigma) \\leq (4.208)^2 \\approx 17.71 \\text{ HU}^2 $$\nWe test each candidate $\\sigma$ with $\\sigma_n^2 = 25$ HU$^2$:\n-   **For $\\sigma = 0$**: $\\sigma_s^2(0) = 25$ HU$^2$. This does not satisfy $25 \\leq 17.71$. Thus, $\\sigma=0$ is invalid.\n-   **For $\\sigma = 0.5$**: $\\sigma_s^2(0.5) = \\frac{25}{4\\pi(0.5)^2} = \\frac{25}{\\pi} \\approx 7.96$ HU$^2$. This satisfies $7.96 \\leq 17.71$. Thus, $\\sigma=0.5$ is a candidate.\n-   **For $\\sigma = 1.0$**: $\\sigma_s^2(1.0) = \\frac{25}{4\\pi(1.0)^2} = \\frac{25}{4\\pi} \\approx 1.99$ HU$^2$. This satisfies $1.99 \\leq 17.71$. Thus, $\\sigma=1.0$ is a candidate.\n-   **For $\\sigma = 2.0$**: $\\sigma_s^2(2.0) = \\frac{25}{4\\pi(2.0)^2} = \\frac{25}{16\\pi} \\approx 0.497$ HU$^2$. This satisfies $0.497 \\leq 17.71$. Thus, $\\sigma=2.0$ is a candidate.\n\n**Constraint 2: Region-Growing Boundary Stop**\n\nTo prevent the region-growing algorithm from \"leaking\" across the lesion boundary, the gradient at the boundary must be strong enough to be detected. The stop criterion is triggered when the gradient magnitude exceeds $\\gamma_{\\min} = 12$ HU/pixel. This means the peak gradient at the smoothed boundary, $g_{\\max}(\\sigma)$, must be at least $\\gamma_{\\min}$.\nThe boundary is modeled as a 1D step edge of amplitude $C = 40$ HU. Smoothing this edge with a 1D Gaussian of standard deviation $\\sigma$ results in a smoothed profile whose maximum gradient (at the center of the edge) is:\n$$ g_{\\max}(\\sigma) = \\frac{C}{\\sqrt{2\\pi}\\sigma} \\quad \\text{for } \\sigma > 0 $$\nThe constraint is $g_{\\max}(\\sigma) \\geq \\gamma_{\\min}$.\n$$ \\frac{40}{\\sqrt{2\\pi}\\sigma} \\geq 12 $$\nSolving for $\\sigma$:\n$$ \\sigma \\leq \\frac{40}{12\\sqrt{2\\pi}} = \\frac{10}{3\\sqrt{2\\pi}} \\approx \\frac{10}{3 \\times 2.5066} \\approx 1.33 \\text{ pixels} $$\nFor the case $\\sigma = 0$ (no smoothing), the ideal gradient is a Dirac delta function. In a discrete image, the gradient across a single-pixel step is simply the difference in intensity, $C = 40$ HU/pixel.\nWe test each candidate $\\sigma$:\n-   **For $\\sigma = 0$**: The gradient is $40$ HU/pixel. This satisfies $40 \\geq 12$.\n-   **For $\\sigma = 0.5$**: This satisfies $0.5 \\leq 1.33$.\n-   **For $\\sigma = 1.0$**: This satisfies $1.0 \\leq 1.33$.\n-   **For $\\sigma = 2.0$**: This does not satisfy $2.0 \\leq 1.33$. Thus, $\\sigma=2.0$ is invalid.\n\n**Synthesizing Results**\n\nWe seek the largest $\\sigma \\in \\{0, 0.5, 1.0, 2.0\\}$ that satisfies both constraints.\n-   $\\sigma = 0$: Fails Constraint 1.\n-   $\\sigma = 0.5$: Satisfies Constraint 1 and Constraint 2. Valid.\n-   $\\sigma = 1.0$: Satisfies Constraint 1 and Constraint 2. Valid.\n-   $\\sigma = 2.0$: Fails Constraint 2.\n\nThe set of valid smoothing parameters is $\\{0.5, 1.0\\}$. The problem asks for the choice that maximizes noise suppression, which corresponds to the largest valid $\\sigma$. The largest value in the valid set is $\\sigma = 1.0$.\n\n**Option-by-Option Analysis**\n\nA. Apply Gaussian smoothing with $\\sigma = 2.0$, then threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\nThis choice of $\\sigma = 2.0$ provides strong noise suppression, satisfying the false-seed constraint. However, it excessively blurs the lesion boundary. The maximum gradient at the boundary becomes $g_{\\max}(2.0) = \\frac{40}{\\sqrt{2\\pi}(2.0)} \\approx 7.98$ HU/pixel, which is less than the required stop criterion of $\\gamma_{\\min} = 12$ HU/pixel. The region-growing algorithm would likely fail to stop at the boundary.\nVerdict: **Incorrect**.\n\nB. Apply Gaussian smoothing with $\\sigma = 1.0$, then threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\nThis choice of $\\sigma = 1.0$ satisfies the false-seed constraint ($\\sigma_s^2(1.0) \\approx 1.99 \\text{ HU}^2 \\leq 17.71 \\text{ HU}^2$). It also satisfies the boundary stop constraint ($\\sigma = 1.0 \\leq 1.33$). Since $\\sigma = 2.0$ is invalid, this is the valid option with the largest $\\sigma$, thus providing the maximum noise suppression among the valid choices.\nVerdict: **Correct**.\n\nC. No smoothing ($\\sigma = 0$); threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\nThis choice of $\\sigma = 0$ preserves the edge gradient ($g_{\\max}(0) = 40 \\text{ HU/pixel} \\geq 12 \\text{ HU/pixel}$). However, without smoothing, the noise variance is $\\sigma_s^2(0) = 25 \\text{ HU}^2$, which exceeds the maximum allowed variance of $17.71 \\text{ HU}^2$ to meet the false-seed probability constraint. This would lead to an unacceptably high number of false seeds.\nVerdict: **Incorrect**.\n\nD. Apply Gaussian smoothing with $\\sigma = 0.5$, then threshold at $\\tau$ and region-grow with gradient stop $\\gamma_{\\min}$.\nThis choice of $\\sigma = 0.5$ satisfies both the false-seed constraint ($\\sigma_s^2(0.5) \\approx 7.96 \\text{ HU}^2 \\leq 17.71 \\text{ HU}^2$) and the boundary stop constraint ($\\sigma = 0.5 \\leq 1.33$). It is a valid processing choice. However, the problem asks for the choice that *best* balances the requirements by maximizing noise suppression. Since $\\sigma = 1.0$ is also a valid choice and provides greater noise suppression (as $\\sigma_{s}^2(1.0) < \\sigma_{s}^2(0.5)$), $\\sigma = 0.5$ is not the optimal choice.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "4560842"}]}