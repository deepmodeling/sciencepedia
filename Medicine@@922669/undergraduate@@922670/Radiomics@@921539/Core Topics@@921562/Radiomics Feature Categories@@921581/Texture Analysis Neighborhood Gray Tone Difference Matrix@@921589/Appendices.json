{"hands_on_practices": [{"introduction": "To build a solid understanding of the Neighborhood Gray Tone Difference Matrix (NGTDM), we begin with the most fundamental scenario: a completely uniform texture. This exercise establishes a crucial baseline by applying the NGTDM formulas to a region where all voxels share the same intensity. By calculating the key parameters in this idealized case [@problem_id:4566022], you will discover the mathematical signature of perfect homogeneity and see how it relates to the concept of maximum \"Coarseness\".", "problem": "Consider a two-dimensional, discretely sampled medical image used in radiomics. Let the region of interest (ROI) be a $3 \\times 3$ grid of voxels, all of which are assigned the same quantized gray level $5$. Take the neighborhood radius to be $\\delta = 1$ under the Chebyshev distance (i.e., $8$-connected neighborhood in two dimensions). Use the Neighborhood Gray Tone Difference Matrix (NGTDM) framework with the following fundamental definitions.\n\nFor each gray level $i$, define:\n- $n_i$ as the number of voxels in the ROI whose gray level equals $i$ and which have at least one neighbor inside the ROI at Chebyshev distance $\\leq \\delta$ (excluding the center voxel from its own neighborhood).\n- For each such voxel $v$ having gray level $i$, let $\\mathcal{N}(v)$ be the set of its neighboring voxels that lie inside the ROI with Chebyshev distance $\\leq \\delta$, and let the local neighborhood average be $a_v = \\frac{1}{|\\mathcal{N}(v)|} \\sum_{u \\in \\mathcal{N}(v)} g(u)$, where $g(u)$ is the gray level at voxel $u$.\n- The NGTDM difference aggregate for level $i$ is $s_i = \\sum_{v:\\, g(v)=i} |\\, i - a_v \\,|$, where the sum runs over those voxels counted by $n_i$.\n- Let $N = \\sum_{i} n_i$ be the total number of voxels counted across all gray levels, and define $p_i = \\frac{n_i}{N}$.\n\nTasks:\n1. Compute $n_5$, $p_5$, and $s_5$ for the specified ROI.\n2. Compute $\\sum_{i} p_i s_i$.\n3. Using the well-established characterization that the NGTDM coarseness is inversely related to the aggregated neighborhood difference $\\sum_{i} p_i s_i$, interpret the coarseness $C$ for this ROI in terms of its limiting value.\n\nReport as your final numerical answer the value of $\\sum_{i} p_i s_i$. No rounding is required and no units are involved.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the field of radiomics, specifically concerning texture analysis using the Neighborhood Gray Tone Difference Matrix (NGTDM). The problem is well-posed, objective, and contains all necessary information to derive a unique solution. We may therefore proceed with the solution.\n\nThe problem asks for the computation of several NGTDM-related quantities for a specified region of interest (ROI). The ROI is a $3 \\times 3$ grid of voxels, where every voxel has a quantized gray level of $5$. The neighborhood is defined by a Chebyshev distance with radius $\\delta = 1$, which corresponds to an $8$-connected neighborhood in two dimensions.\n\nFirst, we address Task 1: Compute $n_5$, $p_5$, and $s_5$.\n\nThe quantity $n_i$ represents the number of voxels with gray level $i$ that possess at least one neighbor within the ROI. In our case, the only gray level present is $i=5$. The ROI is a $3 \\times 3$ grid. Every voxel in this grid, including those at the corners and edges, has at least one neighbor that is also inside the grid.\n- The central voxel has $8$ neighbors.\n- The four corner voxels each have $3$ neighbors.\n- The four edge (non-corner) voxels each have $5$ neighbors.\nSince all $9$ voxels in the ROI have a gray level of $5$ and all of them have neighbors within the ROI, all $9$ voxels are counted for the gray level $i=5$.\nTherefore, $n_5 = 9$. For any other gray level $j \\neq 5$, there are no voxels with that gray level, so $n_j = 0$.\n\nThe total number of voxels counted across all gray levels is $N = \\sum_{i} n_i$. Since the only non-zero term is $n_5$, we have:\n$$\nN = n_5 = 9\n$$\nThe probability $p_i$ is defined as $p_i = \\frac{n_i}{N}$. For the gray level $i=5$, this is:\n$$\np_5 = \\frac{n_5}{N} = \\frac{9}{9} = 1\n$$\nFor any other gray level $j \\neq 5$, $p_j = \\frac{n_j}{N} = \\frac{0}{9} = 0$.\n\nNext, we compute the NGTDM difference aggregate $s_i = \\sum_{v:\\, g(v)=i} |i - a_v|$. For our case with $i=5$, this becomes:\n$$\ns_5 = \\sum_{v:\\, g(v)=5} |5 - a_v|\n$$\nThe sum is over all $9$ voxels in the ROI, as all have gray level $5$. We must first determine the local neighborhood average $a_v$ for each voxel $v$. The definition is $a_v = \\frac{1}{|\\mathcal{N}(v)|} \\sum_{u \\in \\mathcal{N}(v)} g(u)$, where $\\mathcal{N}(v)$ is the set of neighbors of $v$ within the ROI.\nA critical observation is that every voxel $u$ in the ROI, and therefore every neighbor of every voxel $v$, has the same gray level $g(u) = 5$. Thus, for any voxel $v$, its neighborhood average $a_v$ is:\n$$\na_v = \\frac{1}{|\\mathcal{N}(v)|} \\sum_{u \\in \\mathcal{N}(v)} 5 = \\frac{1}{|\\mathcal{N}(v)|} \\cdot |\\mathcal{N}(v)| \\cdot 5 = 5\n$$\nThis means that for every voxel $v$ in the ROI, the local average is $a_v = 5$. Now we can compute $s_5$:\n$$\ns_5 = \\sum_{v:\\, g(v)=5} |5 - 5| = \\sum_{v:\\, g(v)=5} 0\n$$\nThe sum consists of $9$ terms, each of which is $0$. Therefore:\n$$\ns_5 = 0\n$$\n\nNow, we address Task 2: Compute $\\sum_{i} p_i s_i$.\nThis sum is taken over all possible gray levels $i$. We can expand this sum as:\n$$\n\\sum_{i} p_i s_i = p_5 s_5 + \\sum_{j \\neq 5} p_j s_j\n$$\nFrom our previous calculations, we have $p_5 = 1$ and $s_5 = 0$. For any gray level $j \\neq 5$, we have $p_j = 0$. Thus, every term in the sum is zero:\n$$\n\\sum_{i} p_i s_i = (1)(0) + \\sum_{j \\neq 5} (0) s_j = 0 + 0 = 0\n$$\nThe numerical value of the aggregated neighborhood difference is $0$.\n\nFinally, we address Task 3: Interpret the coarseness $C$.\nThe problem states that coarseness is inversely related to the aggregated neighborhood difference, which we just calculated to be $0$. Let this aggregated difference be $D = \\sum_{i} p_i s_i$. The NGTDM feature \"Coarseness\" is commonly defined as $C = (\\sum_i p_i s_i)^{-1}$ (often with a small epsilon added to the denominator to prevent division by zero in practical implementations).\nIn our idealized case, $D=0$. This value signifies that there is, on average, zero difference between a voxel's gray level and the average gray level of its neighbors. This condition is only met in a perfectly homogeneous, or spatially uniform, region where all local variations are absent.\nThe inverse relationship implies that as $D \\to 0$, coarseness $C \\to \\infty$. Therefore, for this ROI, the coarseness takes on its theoretical maximum value. This limiting value of infinite coarseness correctly characterizes the texture as being completely non-complex and uniform, which is the definition of the coarsest possible texture. An ROI where all voxels share the same intensity represents the absolute limit of coarseness.\n\nThe final numerical answer required is the value of $\\sum_{i} p_i s_i$.\n$$\n\\sum_{i} p_i s_i = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "4566022"}, {"introduction": "Moving from a uniform region to a more structured one, this practice challenges you to compute NGTDM features for an image with clear spatial patterns. You will need to systematically analyze voxels based on their position—corner, edge, or interior—and calculate their corresponding neighborhood differences. This detailed calculation [@problem_id:4565911] not only reinforces the core mechanics of NGTDM but also introduces the \"Busyness\" feature, expanding your toolkit for texture characterization.", "problem": "Consider a quantized two-dimensional image Region of Interest (ROI) of size $4 \\times 4$ with gray levels restricted to the set $\\{1,4\\}$. The gray level $4$ occupies a contiguous $2 \\times 2$ block centered in the ROI, and all remaining voxels have gray level $1$. Use the Neighborhood Gray Tone Difference Matrix (NGTDM) definitions with neighborhood radius $\\delta=1$ based on Chebyshev distance: the neighborhood of a voxel consists of all voxels within Chebyshev distance $\\delta=1$, excluding the center voxel itself, and at ROI boundaries the neighborhood mean is computed over all available neighbors inside the ROI. The quantities $p_i$ are defined as the empirical proportions of ROI voxels with gray level $i$, and $s_i$ are defined as the sum, taken over all voxels with gray level $i$, of the absolute difference between that voxel’s gray level and the mean of its neighborhood. \n\nStarting from these core definitions, compute $p_1$, $p_4$, $s_1$, and $s_4$ for the described ROI. Then, using first principles of the NGTDM framework and the computed $p_i$ and $s_i$, determine the busyness feature $B$ for this ROI. All answers are dimensionless. Provide exact values; no rounding is required.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All necessary parameters for the Neighborhood Gray Tone Difference Matrix (NGTDM) calculation are provided, and no contradictions or ambiguities are present.\n\nThe solution proceeds in several steps:\n1.  Define the Region of Interest (ROI) based on the problem description.\n2.  Calculate the empirical proportions, $p_i$, for each gray level $i$.\n3.  Calculate the sums of differences, $s_i$, for each gray level $i$.\n4.  Calculate the busyness feature, $B$, using the computed $p_i$ and $s_i$.\n\n**Step 1: Define the ROI**\n\nThe ROI is a $4 \\times 4$ grid. The gray levels are restricted to the set $\\{1, 4\\}$. A contiguous $2 \\times 2$ block of gray level $4$ is centered in the ROI. The remaining voxels have gray level $1$. This configuration is represented by the matrix $G$:\n$$ G = \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 1 & 4 & 4 & 1 \\\\ 1 & 4 & 4 & 1 \\\\ 1 & 1 & 1 & 1 \\end{pmatrix} $$\nThe total number of voxels in the ROI is $N_v = 4 \\times 4 = 16$.\n\n**Step 2: Calculate Proportions $p_i$**\n\nThe proportion $p_i$ is the number of voxels with gray level $i$, denoted $N_i$, divided by the total number of voxels $N_v$.\nBy counting the elements in the matrix $G$:\n-   The number of voxels with gray level $i=1$ is $N_1 = 12$.\n-   The number of voxels with gray level $i=4$ is $N_4 = 4$.\n\nThe proportions are:\n$$ p_1 = \\frac{N_1}{N_v} = \\frac{12}{16} = \\frac{3}{4} $$\n$$ p_4 = \\frac{N_4}{N_v} = \\frac{4}{16} = \\frac{1}{4} $$\n\n**Step 3: Calculate Sums of Differences $s_i$**\n\nThe quantity $s_i$ is the sum of absolute differences between a voxel's gray level $i$ and the mean gray level of its neighborhood, $\\bar{A}_k$, summed over all voxels $k$ with that gray level. The neighborhood is defined by a Chebyshev distance $\\delta=1$.\n$$ s_i = \\sum_{k: G(k)=i} |i - \\bar{A}_k| $$\n\n**Calculation of $s_1$:**\nWe analyze the $N_1=12$ voxels with gray level $1$. Based on their positions, they can be categorized into two groups: corner voxels and edge voxels.\n\n1.  **Corner Voxels:** There are $4$ such voxels at positions $(1,1), (1,4), (4,1), (4,4)$. Due to symmetry, the calculation is identical for all four. Let's consider the voxel at $(1,1)$.\n    -   Its neighborhood consists of $3$ voxels: at $(1,2)$, $(2,1)$, and $(2,2)$.\n    -   The gray levels of these neighbors are $1, 1, 4$.\n    -   The neighborhood mean is $\\bar{A}_{\\text{corner}} = \\frac{1+1+4}{3} = \\frac{6}{3} = 2$.\n    -   The absolute difference is $|1 - \\bar{A}_{\\text{corner}}| = |1 - 2| = 1$.\n    -   The total contribution from the $4$ corner voxels is $4 \\times 1 = 4$.\n\n2.  **Edge Voxels (non-corner):** There are $8$ such voxels. By symmetry, they all have the same neighborhood composition. Let's consider the voxel at position $(1,2)$.\n    -   Its neighborhood consists of $5$ voxels: at $(1,1), (1,3), (2,1), (2,2), (2,3)$.\n    -   The gray levels of these neighbors are $1, 1, 1, 4, 4$.\n    -   The neighborhood mean is $\\bar{A}_{\\text{edge}} = \\frac{1+1+1+4+4}{5} = \\frac{11}{5}$.\n    -   The absolute difference is $|1 - \\bar{A}_{\\text{edge}}| = |1 - \\frac{11}{5}| = |-\\frac{6}{5}| = \\frac{6}{5}$.\n    -   The total contribution from the $8$ edge voxels is $8 \\times \\frac{6}{5} = \\frac{48}{5}$.\n\nSumming the contributions for all voxels with gray level $1$:\n$$ s_1 = 4 + \\frac{48}{5} = \\frac{20}{5} + \\frac{48}{5} = \\frac{68}{5} $$\n\n**Calculation of $s_4$:**\nWe analyze the $N_4=4$ voxels with gray level $4$. These are at positions $(2,2), (2,3), (3,2), (3,3)$. All are symmetrically equivalent. Let's consider the voxel at position $(2,2)$.\n-   Its neighborhood consists of $8$ voxels, as it is not on the ROI boundary. The neighbors are at $(1,1), (1,2), (1,3), (2,1), (2,3), (3,1), (3,2), (3,3)$.\n-   The gray levels of these neighbors are $1, 1, 1, 1, 4, 1, 4, 4$.\n-   The neighborhood mean is $\\bar{A}_{\\text{center}} = \\frac{1+1+1+1+4+1+4+4}{8} = \\frac{17}{8}$.\n-   The absolute difference is $|4 - \\bar{A}_{\\text{center}}| = |4 - \\frac{17}{8}| = |\\frac{32-17}{8}| = \\frac{15}{8}$.\n-   Since all $4$ voxels with gray level $4$ are identical in this respect, the total sum $s_4$ is:\n$$ s_4 = 4 \\times \\frac{15}{8} = \\frac{60}{8} = \\frac{15}{2} $$\n\n**Step 4: Calculate Busyness $B$**\n\nThe busyness feature $B$ is a measure of the spatial rate of change of intensity. Following the original definition by Amadasun & King, which represents the \"first principles\" of NGTDM, the formula for busyness is:\n$$ B = \\frac{\\sum_{i=1}^{N_g} p_i s_i}{\\sum_{i=1}^{N_g} \\sum_{j \\neq i} p_i p_j |i - j|} $$\nwhere $N_g$ is the number of gray levels, which is $2$ in this problem ($i, j \\in \\{1, 4\\}$).\n\n**Numerator Calculation:**\n$$ \\sum_{i=1}^{N_g} p_i s_i = p_1 s_1 + p_4 s_4 = \\left(\\frac{3}{4}\\right)\\left(\\frac{68}{5}\\right) + \\left(\\frac{1}{4}\\right)\\left(\\frac{15}{2}\\right) $$\n$$ = \\frac{204}{20} + \\frac{15}{8} = \\frac{51}{5} + \\frac{15}{8} = \\frac{51 \\times 8 + 15 \\times 5}{40} = \\frac{408 + 75}{40} = \\frac{483}{40} $$\n\n**Denominator Calculation:**\n$$ \\sum_{i=1}^{2} \\sum_{j \\neq i} p_i p_j |i - j| = p_1 p_4 |1-4| + p_4 p_1 |4-1| = 2 p_1 p_4 | -3 | = 6 p_1 p_4 $$\n$$ = 6 \\left(\\frac{3}{4}\\right)\\left(\\frac{1}{4}\\right) = \\frac{18}{16} = \\frac{9}{8} $$\n\n**Final Busyness Calculation:**\n$$ B = \\frac{\\text{Numerator}}{\\text{Denominator}} = \\frac{483/40}{9/8} = \\frac{483}{40} \\times \\frac{8}{9} = \\frac{483}{5 \\times 9} = \\frac{483}{45} $$\nTo simplify the fraction, we note that the sum of digits of $483$ is $4+8+3=15$, which is divisible by $3$. The denominator $45$ is also divisible by $3$.\n$$ B = \\frac{483 \\div 3}{45 \\div 3} = \\frac{161}{15} $$\nThe number $161$ is not divisible by $3$ or $5$. (It is $7 \\times 23$). The fraction is in its simplest form.\n\nThe required values are:\n-   $p_1 = \\frac{3}{4}$\n-   $p_4 = \\frac{1}{4}$\n-   $s_1 = \\frac{68}{5}$\n-   $s_4 = \\frac{15}{2}$\n-   $B = \\frac{161}{15}$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{4} & \\frac{1}{4} & \\frac{68}{5} & \\frac{15}{2} & \\frac{161}{15} \\end{pmatrix}}$$", "id": "4565911"}, {"introduction": "This final exercise demonstrates the core value of texture analysis: its ability to see what simple statistics cannot. You will analyze two Regions of Interest that have identical gray-level histograms but possess vastly different visual textures. By calculating and comparing their NGTDM features [@problem_id:4565881], you will uncover how the matrix quantifies the spatial arrangement of pixels, providing a powerful illustration of why texture analysis is essential in fields like radiomics.", "problem": "A radiomics analyst is studying how the Neighborhood Gray Tone Difference Matrix (NGTDM) captures texture beyond what a gray-level histogram can reveal. The NGTDM is defined over a Region of Interest (ROI) using a specified neighborhood. Consider a two-dimensional ROI discretized to two gray levels, with an eight-connected neighborhood defined by Chebyshev distance $1$ (i.e., all neighbors with offsets in $\\{-1,0,1\\}$ except the center). A voxel is considered valid if its full $3 \\times 3$ neighborhood fits inside the ROI. For each valid voxel at position $\\mathbf{x}$ with gray level $g(\\mathbf{x})$, define the local neighborhood mean $m(\\mathbf{x})$ as the arithmetic mean of the gray levels of its neighbors. For each gray level $i$, define $n_{i}$ as the number of valid voxels with gray level $i$, the empirical distribution $p_{i} = n_{i}/N_{v}$ with $N_{v}$ the total number of valid voxels, and the NGTDM difference accumulation\n$$\ns_{i} = \\sum_{\\mathbf{x} \\,:\\, g(\\mathbf{x}) = i} \\left| i - m(\\mathbf{x}) \\right|.\n$$\nDefine the coarseness feature as\n$$\nC = \\frac{1}{\\sum_{i} s_{i}}.\n$$\nConstruct and analyze the following two ROIs on a $4 \\times 4$ grid, both discretized to gray levels $\\{0, 4\\}$:\n\nROI A (two large uniform halves with a sharp vertical boundary):\n$$\n\\begin{pmatrix}\n0 & 0 & 4 & 4 \\\\\n0 & 0 & 4 & 4 \\\\\n0 & 0 & 4 & 4 \\\\\n0 & 0 & 4 & 4\n\\end{pmatrix}\n$$\n\nROI B (fine-grained alternation in a checkerboard arrangement):\n$$\n\\begin{pmatrix}\n0 & 4 & 0 & 4 \\\\\n4 & 0 & 4 & 0 \\\\\n0 & 4 & 0 & 4 \\\\\n4 & 0 & 4 & 0\n\\end{pmatrix}\n$$\n\nUsing the above NGTDM definitions and the eight-connected neighborhood, do the following for each ROI: compute $p_{i}$ over valid voxels and verify that the histograms match, compute $s_{i}$ for each gray level, then compute the coarseness $C$. Finally, report the ratio $R = C_{\\text{A}} / C_{\\text{B}}$. Round your final ratio to four significant figures. Provide a concise explanation of why the quantities $s_{i}$ disambiguate these textures despite identical $p_{i}$. The graded answer is the single numerical value $R$, which is dimensionless.", "solution": "The user has provided a valid problem statement from the field of radiomics, specifically concerning texture analysis using the Neighborhood Gray Tone Difference Matrix (NGTDM). The problem is self-contained, scientifically grounded, and well-posed. We will proceed with a full solution.\n\nThe problem asks for the analysis of two $4 \\times 4$ Regions of Interest (ROIs), denoted ROI A and ROI B, with gray levels from the set {$0, 4$}.\n\nROI A:\n$$\n\\begin{pmatrix}\n0 & 0 & 4 & 4 \\\\\n0 & 0 & 4 & 4 \\\\\n0 & 0 & 4 & 4 \\\\\n0 & 0 & 4 & 4\n\\end{pmatrix}\n$$\n\nROI B:\n$$\n\\begin{pmatrix}\n0 & 4 & 0 & 4 \\\\\n4 & 0 & 4 & 0 \\\\\n0 & 4 & 0 & 4 \\\\\n4 & 0 & 4 & 0\n\\end{pmatrix}\n$$\n\nA voxel is defined as valid if its full $3 \\times 3$ neighborhood fits within the ROI. For a $4 \\times 4$ grid, this restricts the valid voxels to the central $2 \\times 2$ block. Let the position of a voxel be indexed by $(r, c)$ where $r$ is the row and $c$ is the column, both ranging from $1$ to $4$. The valid voxel positions are $(2,2)$, $(2,3)$, $(3,2)$, and $(3,3)$.\n\n**Analysis of ROI A**\n\nFirst, we identify the gray levels of the valid voxels in ROI A:\n- $g(2,2) = 0$\n- $g(2,3) = 4$\n- $g(3,2) = 0$\n- $g(3,3) = 4$\n\nThe total number of valid voxels is $N_{v} = 4$.\nThe number of valid voxels with gray level $i=0$ is $n_{0} = 2$.\nThe number of valid voxels with gray level $i=4$ is $n_{4} = 2$.\n\nThe empirical distribution (histogram) $p_{i} = n_{i}/N_{v}$ is:\n$p_{0} = 2/4 = 1/2$\n$p_{4} = 2/4 = 1/2$\n\nNext, we compute the NGTDM difference accumulation, $s_{i} = \\sum_{\\mathbf{x} \\,:\\, g(\\mathbf{x}) = i} \\left| i - m(\\mathbf{x}) \\right|$. This requires calculating the local neighborhood mean $m(\\mathbf{x})$ for each valid voxel. The neighborhood consists of $8$ neighbors.\n\nFor the voxel at $(2,2)$ with gray level $g(2,2)=0$:\nThe neighbors' gray levels are $\\{0, 0, 4, 0, 4, 0, 0, 4\\}$.\nThe sum of neighbors' gray levels is $5 \\times 0 + 3 \\times 4 = 12$.\nThe mean is $m(2,2) = 12/8 = 1.5$.\n\nFor the voxel at $(3,2)$ with gray level $g(3,2)=0$:\nThe neighborhood is identical to that of $(2,2)$.\nThe mean is $m(3,2) = 12/8 = 1.5$.\n\nFor the voxel at $(2,3)$ with gray level $g(2,3)=4$:\nThe neighbors' gray levels are $\\{0, 4, 4, 0, 4, 0, 4, 4\\}$.\nThe sum of neighbors' gray levels is $3 \\times 0 + 5 \\times 4 = 20$.\nThe mean is $m(2,3) = 20/8 = 2.5$.\n\nFor the voxel at $(3,3)$ with gray level $g(3,3)=4$:\nThe neighborhood is identical to that of $(2,3)$.\nThe mean is $m(3,3) = 20/8 = 2.5$.\n\nNow, we compute $s_{i}$ for ROI A:\n$s_{0} = |0 - m(2,2)| + |0 - m(3,2)| = |0 - 1.5| + |0 - 1.5| = 1.5 + 1.5 = 3$.\n$s_{4} = |4 - m(2,3)| + |4 - m(3,3)| = |4 - 2.5| + |4 - 2.5| = 1.5 + 1.5 = 3$.\n\nThe coarseness feature $C_{\\text{A}}$ is:\n$C_{\\text{A}} = \\frac{1}{\\sum_{i} s_{i}} = \\frac{1}{s_{0} + s_{4}} = \\frac{1}{3 + 3} = \\frac{1}{6}$.\n\n**Analysis of ROI B**\n\nNext, we identify the gray levels of the valid voxels in ROI B:\n- $g(2,2) = 0$\n- $g(2,3) = 4$\n- $g(3,2) = 4$\n- $g(3,3) = 0$\n\nThe total number of valid voxels is $N_{v} = 4$.\n$n_{0} = 2$ and $n_{4} = 2$.\nThe histogram $p_{i}$ is $p_{0} = 1/2$ and $p_{4} = 1/2$, which is identical to that of ROI A.\n\nNow we compute $m(\\mathbf{x})$ for each valid voxel in ROI B.\n\nFor the voxel at $(2,2)$ with gray level $g(2,2)=0$:\nThe neighbors' gray levels are $\\{0, 4, 0, 4, 4, 0, 4, 0\\}$.\nThe sum is $4 \\times 0 + 4 \\times 4 = 16$.\nThe mean is $m(2,2) = 16/8 = 2$.\n\nFor the voxel at $(3,3)$ with gray level $g(3,3)=0$:\nDue to the checkerboard symmetry, its neighborhood is identical to that of $(2,2)$.\nThe mean is $m(3,3) = 16/8 = 2$.\n\nFor the voxel at $(2,3)$ with gray level $g(2,3)=4$:\nThe neighbors' gray levels are $\\{4, 0, 4, 0, 0, 4, 0, 4\\}$.\nThe sum is $4 \\times 0 + 4 \\times 4 = 16$.\nThe mean is $m(2,3) = 16/8 = 2$.\n\nFor the voxel at $(3,2)$ with gray level $g(3,2)=4$:\nDue to symmetry, its neighborhood is identical to that of $(2,3)$.\nThe mean is $m(3,2) = 16/8 = 2$.\n\nNow, we compute $s_{i}$ for ROI B:\n$s_{0} = |0 - m(2,2)| + |0 - m(3,3)| = |0 - 2| + |0 - 2| = 2 + 2 = 4$.\n$s_{4} = |4 - m(2,3)| + |4 - m(3,2)| = |4 - 2| + |4 - 2| = 2 + 2 = 4$.\n\nThe coarseness feature $C_{\\text{B}}$ is:\n$C_{\\text{B}} = \\frac{1}{\\sum_{i} s_{i}} = \\frac{1}{s_{0} + s_{4}} = \\frac{1}{4 + 4} = \\frac{1}{8}$.\n\n**Explanation of Disambiguation**\n\nThe gray-level histograms $p_{i}$ are identical for both ROIs because they both contain the same number of valid voxels for each gray level ($n_0=2, n_4=2$). Histograms are first-order statistics that are insensitive to the spatial arrangement of pixels.\n\nThe NGTDM quantities $s_{i}$ successfully disambiguate the textures because they incorporate second-order spatial information. The term $|i - m(\\mathbf{x})|$ quantifies the local contrast by measuring how different a voxel's gray level is from the average of its immediate neighbors.\n\n- In ROI A (coarse texture), the valid voxels lie on the single boundary between two large uniform regions. The neighborhoods are heterogeneous, with means $m(\\mathbf{x})$ of $1.5$ and $2.5$. The total accumulated difference, $\\sum s_i = 6$, reflects the local contrast along this single boundary.\n- In ROI B (fine texture), the valid voxels are part of a high-frequency checkerboard pattern. Every voxel is maximally different from its immediate surroundings. This high local contrast results in a neighborhood mean of $m(\\mathbf{x})=2$ for all valid voxels, which is exactly halfway between the two gray levels $0$ and $4$. This leads to a larger absolute difference for every voxel: $|0-2|=2$ and $|4-2|=2$. The total accumulated difference, $\\sum s_i = 8$, is consequently higher, indicating a finer, more complex texture.\n\nThe coarseness feature $C = 1/\\sum s_i$ is inversely proportional to this accumulated difference. ROI A is visually \"coarser\" and has a smaller $\\sum s_i$, resulting in a larger coarseness value ($C_A = 1/6$). ROI B is visually \"finer\" and has a larger $\\sum s_i$, yielding a smaller coarseness value ($C_B = 1/8$). This demonstrates how NGTDM captures spatial relationships that simple histograms ignore.\n\n**Final Calculation of the Ratio R**\n\nThe ratio $R$ is defined as $C_{\\text{A}} / C_{\\text{B}}$.\n$R = \\frac{C_{\\text{A}}}{C_{\\text{B}}} = \\frac{1/6}{1/8} = \\frac{8}{6} = \\frac{4}{3}$.\n\nAs a decimal, $R = 1.3333...$. Rounding to four significant figures gives $1.333$.", "answer": "$$\\boxed{1.333}$$", "id": "4565881"}]}