{"hands_on_practices": [{"introduction": "To truly grasp the Gray-Level Dependence Matrix (GLDM), we must begin with its fundamental construction. This first practice [@problem_id:4564097] guides you through the meticulous process of calculating the dependence size for each pixel in a small region of interest, assembling the GLDM, and then computing a summary statistic, the dependence entropy. This exercise is essential for building a concrete, step-by-step understanding of how visual patterns are translated into a quantitative matrix.", "problem": "An image Region of Interest (ROI) is discretized into integer gray levels and given by the following $4 \\times 4$ array:\n$$\n\\begin{pmatrix}\n1 & 1 & 2 & 2 \\\\\n1 & 1 & 2 & 3 \\\\\n1 & 2 & 2 & 3 \\\\\n2 & 2 & 3 & 3\n\\end{pmatrix}.\n$$\nTexture analysis using the Gray-Level Dependence Matrix (GLDM) is based on the following fundamental definitions. For each pixel with gray level $g$, consider its neighbors within Chebyshev distance $\\delta$, that is, all pixels for which the maximum of the absolute row and column offsets equals $\\delta$. With an intensity tolerance $\\alpha$, a neighbor is said to be dependent on the central pixel if the absolute difference in gray levels between the neighbor and the central pixel is less than or equal to $\\alpha$. The dependence size $d$ of the central pixel is defined as $1$ plus the number of such dependent neighbors, where the $1$ accounts for the central pixel itself. The Gray-Level Dependence Matrix $p(g,d)$ counts, over all pixels in the ROI, the number of occurrences of gray level $g$ with dependence size $d$.\n\nUsing these definitions with $\\delta = 1$ and $\\alpha = 0$, construct the joint distribution $p(g,d)$ for the ROI above and then compute the dependence entropy, defined as the Shannon entropy of the joint probability mass function obtained by normalizing $p(g,d)$ by the total number of pixels in the ROI, using the natural logarithm. Express the final entropy in nats and round your answer to $4$ significant figures.", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and objective. It provides a complete and consistent set of definitions and data required to compute the specified texture feature. All terms and parameters are standard in the field of radiomics and image analysis. We may therefore proceed with the solution.\n\nThe problem asks for the computation of the dependence entropy for a given $4 \\times 4$ Region of Interest (ROI), using the Gray-Level Dependence Matrix (GLDM) method.\n\nThe ROI is given by the matrix $G$:\n$$\nG = \\begin{pmatrix}\n1 & 1 & 2 & 2 \\\\\n1 & 1 & 2 & 3 \\\\\n1 & 2 & 2 & 3 \\\\\n2 & 2 & 3 & 3\n\\end{pmatrix}\n$$\nThe parameters for the GLDM calculation are a Chebyshev distance of $\\delta = 1$ and an intensity tolerance of $\\alpha = 0$.\n\nThe first step is to compute the dependence size, $d$, for each pixel in the ROI. The dependence size is defined as $d = 1 + k$, where $k$ is the number of neighbors within the specified distance $\\delta$ that satisfy the dependence condition. With $\\delta=1$, the neighborhood of a pixel consists of its $8$ immediate neighbors. With $\\alpha=0$, a neighbor is considered dependent only if its gray level is identical to that of the central pixel.\n\nWe will iterate through each of the $16$ pixels of the ROI, identify its gray level $g$, and calculate its corresponding dependence size $d$.\n\n1.  Pixel $(1,1)$, $g=1$: Neighbors are $(1,2), (2,1), (2,2)$ with gray levels $1, 1, 1$. All $3$ are dependent. $d = 1+3=4$.\n2.  Pixel $(1,2)$, $g=1$: Neighbors are $(1,1), (2,1), (2,2), (1,3), (2,3)$ with gray levels $1, 1, 1, 2, 2$. $3$ are dependent. $d = 1+3=4$.\n3.  Pixel $(1,3)$, $g=2$: Neighbors are $(1,2), (1,4), (2,2), (2,3), (2,4)$ with gray levels $1, 2, 1, 2, 3$. $2$ are dependent. $d = 1+2=3$.\n4.  Pixel $(1,4)$, $g=2$: Neighbors are $(1,3), (2,3), (2,4)$ with gray levels $2, 2, 3$. $2$ are dependent. $d = 1+2=3$.\n5.  Pixel $(2,1)$, $g=1$: Neighbors are $(1,1), (1,2), (2,2), (3,1), (3,2)$ with gray levels $1, 1, 1, 1, 2$. $4$ are dependent. $d = 1+4=5$.\n6.  Pixel $(2,2)$, $g=1$: Neighbors are $(1,1), (1,2), (1,3), (2,1), (2,3), (3,1), (3,2), (3,3)$ with gray levels $1, 1, 2, 1, 2, 1, 2, 2$. $4$ are dependent. $d = 1+4=5$.\n7.  Pixel $(2,3)$, $g=2$: Neighbors are $(1,2), (1,3), (1,4), (2,2), (2,4), (3,2), (3,3), (3,4)$ with gray levels $1, 2, 2, 1, 3, 2, 2, 3$. $4$ are dependent. $d = 1+4=5$.\n8.  Pixel $(2,4)$, $g=3$: Neighbors are $(1,3), (1,4), (2,3), (3,3), (3,4)$ with gray levels $2, 2, 2, 2, 3$. $1$ is dependent. $d = 1+1=2$.\n9.  Pixel $(3,1)$, $g=1$: Neighbors are $(2,1), (2,2), (3,2), (4,1), (4,2)$ with gray levels $1, 1, 2, 2, 2$. $2$ are dependent. $d = 1+2=3$.\n10. Pixel $(3,2)$, $g=2$: Neighbors are $(2,1), (2,2), (2,3), (3,1), (3,3), (4,1), (4,2), (4,3)$ with gray levels $1, 1, 2, 1, 2, 2, 2, 3$. $4$ are dependent. $d = 1+4=5$.\n11. Pixel $(3,3)$, $g=2$: Neighbors are $(2,2), (2,3), (2,4), (3,2), (3,4), (4,2), (4,3), (4,4)$ with gray levels $1, 2, 3, 2, 3, 2, 3, 3$. $3$ are dependent. $d = 1+3=4$.\n12. Pixel $(3,4)$, $g=3$: Neighbors are $(2,3), (2,4), (3,3), (4,3), (4,4)$ with gray levels $2, 3, 2, 3, 3$. $3$ are dependent. $d = 1+3=4$.\n13. Pixel $(4,1)$, $g=2$: Neighbors are $(3,1), (3,2), (4,2)$ with gray levels $1, 2, 2$. $2$ are dependent. $d = 1+2=3$.\n14. Pixel $(4,2)$, $g=2$: Neighbors are $(3,1), (3,2), (3,3), (4,1), (4,3)$ with gray levels $1, 2, 2, 2, 3$. $3$ are dependent. $d = 1+3=4$.\n15. Pixel $(4,3)$, $g=3$: Neighbors are $(3,2), (3,3), (3,4), (4,2), (4,4)$ with gray levels $2, 2, 3, 2, 3$. $2$ are dependent. $d = 1+2=3$.\n16. Pixel $(4,4)$, $g=3$: Neighbors are $(3,3), (3,4), (4,3)$ with gray levels $2, 3, 3$. $2$ are dependent. $d = 1+2=3$.\n\nThe next step is to construct the Gray-Level Dependence Matrix, $p(g,d)$, which tabulates the counts of each $(g,d)$ pair.\n- For $g=1$: we have pairs $(1,4)$, $(1,4)$, $(1,5)$, $(1,5)$, $(1,3)$. Thus, $p(1,3)=1$, $p(1,4)=2$, $p(1,5)=2$.\n- For $g=2$: we have pairs $(2,3)$, $(2,3)$, $(2,5)$, $(2,5)$, $(2,4)$, $(2,3)$, $(2,4)$. Thus, $p(2,3)=3$, $p(2,4)=2$, $p(2,5)=2$.\n- For $g=3$: we have pairs $(3,2)$, $(3,4)$, $(3,3)$, $(3,3)$. Thus, $p(3,2)=1$, $p(3,3)=2$, $p(3,4)=1$.\n\nAll other entries $p(g,d)$ are $0$. The sum of all entries is $1+2+2+3+2+2+1+2+1 = 16$, which is the total number of pixels, as expected.\n\nNext, we normalize the GLDM by the total number of pixels, $N = 16$, to obtain the joint probability mass function $P(g,d) = p(g,d)/N$. The non-zero probabilities are:\n- $P(1,3) = \\frac{1}{16}$\n- $P(1,4) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(1,5) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(2,3) = \\frac{3}{16}$\n- $P(2,4) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(2,5) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(3,2) = \\frac{1}{16}$\n- $P(3,3) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(3,4) = \\frac{1}{16}$\n\nFinally, we compute the dependence entropy, $H$, which is the Shannon entropy of the joint distribution $P(g,d)$. Since the natural logarithm is used, the unit is nats.\n$$\nH = -\\sum_{g,d} P(g,d) \\ln(P(g,d))\n$$\nWe sum over the non-zero probabilities. We can group terms with the same probability value:\n- Three terms have $P(g,d) = \\frac{1}{16}$.\n- Five terms have $P(g,d) = \\frac{2}{16} = \\frac{1}{8}$.\n- One term has $P(g,d) = \\frac{3}{16}$.\n\nThe entropy calculation is:\n$$\nH = - \\left[ 3 \\left(\\frac{1}{16}\\ln\\left(\\frac{1}{16}\\right)\\right) + 5 \\left(\\frac{2}{16}\\ln\\left(\\frac{2}{16}\\right)\\right) + 1 \\left(\\frac{3}{16}\\ln\\left(\\frac{3}{16}\\right)\\right) \\right]\n$$\n$$\nH = - \\frac{1}{16} \\left[ 3\\ln\\left(\\frac{1}{16}\\right) + 10\\ln\\left(\\frac{1}{8}\\right) + 3\\ln\\left(\\frac{3}{16}\\right) \\right]\n$$\nUsing the properties of logarithms, $\\ln(a/b) = \\ln(a) - \\ln(b)$ and $\\ln(x^y) = y\\ln(x)$:\n$\\ln(\\frac{1}{16}) = -\\ln(16) = -\\ln(2^4) = -4\\ln(2)$\n$\\ln(\\frac{1}{8}) = -\\ln(8) = -\\ln(2^3) = -3\\ln(2)$\n$\\ln(\\frac{3}{16}) = \\ln(3) - \\ln(16) = \\ln(3) - 4\\ln(2)$\nSubstituting these into the expression for $H$:\n$$\nH = - \\frac{1}{16} \\left[ 3(-4\\ln(2)) + 10(-3\\ln(2)) + 3(\\ln(3) - 4\\ln(2)) \\right]\n$$\n$$\nH = - \\frac{1}{16} \\left[ -12\\ln(2) - 30\\ln(2) + 3\\ln(3) - 12\\ln(2) \\right]\n$$\n$$\nH = - \\frac{1}{16} \\left[ -54\\ln(2) + 3\\ln(3) \\right]\n$$\n$$\nH = \\frac{54\\ln(2) - 3\\ln(3)}{16}\n$$\nNow, we substitute the numerical values for $\\ln(2) \\approx 0.693147$ and $\\ln(3) \\approx 1.098612$:\n$$\nH \\approx \\frac{54(0.693147) - 3(1.098612)}{16}\n$$\n$$\nH \\approx \\frac{37.429938 - 3.295836}{16} = \\frac{34.134102}{16} \\approx 2.133381\n$$\nRounding the result to $4$ significant figures, we get $2.133$.", "answer": "$$\\boxed{2.133}$$", "id": "4564097"}, {"introduction": "Once you understand the mechanics of GLDM, the next step is to build intuition for what its features represent. This exercise [@problem_id:4564089] presents a stark contrast between a completely uniform image and a highly varied, checkerboard-like pattern. By comparing the mean dependence size for these two extreme cases, you will gain a deeper insight into how GLDM features quantify textural properties like homogeneity and complexity.", "problem": "You are given two discretized two-dimensional images used in radiomic texture analysis. All gray levels are already quantized to the integer set $\\{1,2,3,4\\}$. Consider the eight-neighborhood (Moore neighborhood): two pixels are neighbors if their Chebyshev distance is $\\leq 1$. Only in-bounds neighbors are considered; out-of-bounds locations are ignored. Let the tolerance parameter be $\\alpha=0$, meaning two pixels are considered dependent if and only if their gray levels are equal. For a pixel at location $\\mathbf{p}$ with gray level $g$, define its dependence size $d(\\mathbf{p})$ as the total number of pixels consisting of the center pixel at $\\mathbf{p}$ and all its eight-neighborhood in-bounds neighbors whose gray levels are equal to $g$. The Gray-Level Dependence Matrix (GLDM) $P(g,d)$ counts, for each gray level $g$ and dependence size $d$, how many pixels in the image have gray level $g$ and dependence size $d$.\n\nImage $\\mathcal{I}_{A}$ is uniform:\n$$\n\\mathcal{I}_{A}=\\begin{pmatrix}\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\n\\end{pmatrix}.\n$$\n\nImage $\\mathcal{I}_{B}$ is a $2\\times 2$ tiled four-level pattern:\n$$\n\\mathcal{I}_{B}=\\begin{pmatrix}\n1 & 2 & 1 & 2 & 1\\\\\n3 & 4 & 3 & 4 & 3\\\\\n1 & 2 & 1 & 2 & 1\\\\\n3 & 4 & 3 & 4 & 3\\\\\n1 & 2 & 1 & 2 & 1\n\\end{pmatrix}.\n$$\n\nFor each image $\\mathcal{I}\\in\\{\\mathcal{I}_{A},\\mathcal{I}_{B}\\}$, define the mean dependence size\n$$\n\\bar{d}(\\mathcal{I})=\\frac{1}{N}\\sum_{\\mathbf{p}} d(\\mathbf{p}),\n$$\nwhere $N$ is the total number of pixels and the sum runs over all pixel locations $\\mathbf{p}$ in the image.\n\nStarting from the definitions above and without invoking any formula not derivable from these definitions, determine the ratio\n$$\nR=\\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})}.\n$$\n\nGive your final value for $R$ as a decimal, rounded to four significant figures. No units are required.", "solution": "### Step 1: Extract Givens\n- **Images**: Two $5 \\times 5$ discretized images, $\\mathcal{I}_{A}$ and $\\mathcal{I}_{B}$.\n- **Gray Levels**: The set of quantized gray levels is $\\{1, 2, 3, 4\\}$.\n- **Neighborhood**: The eight-neighborhood (Moore neighborhood) is used, where neighbors have a Chebyshev distance $\\leq 1$. Only in-bounds neighbors are considered.\n- **Dependence Condition**: Two pixels are dependent if their gray levels are equal. This corresponds to a tolerance parameter $\\alpha=0$.\n- **Dependence Size**: For a pixel at location $\\mathbf{p}$ with gray level $g$, its dependence size $d(\\mathbf{p})$ is the total number of pixels including the center pixel at $\\mathbf{p}$ and its eight-neighborhood in-bounds neighbors whose gray levels are equal to $g$.\n- **Image $\\mathcal{I}_{A}$**:\n$$\n\\mathcal{I}_{A}=\\begin{pmatrix}\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\\\\\n2 & 2 & 2 & 2 & 2\n\\end{pmatrix}\n$$\n- **Image $\\mathcal{I}_{B}$**:\n$$\n\\mathcal{I}_{B}=\\begin{pmatrix}\n1 & 2 & 1 & 2 & 1\\\\\n3 & 4 & 3 & 4 & 3\\\\\n1 & 2 & 1 & 2 & 1\\\\\n3 & 4 & 3 & 4 & 3\\\\\n1 & 2 & 1 & 2 & 1\n\\end{pmatrix}\n$$\n- **Mean Dependence Size**:\n$$\n\\bar{d}(\\mathcal{I})=\\frac{1}{N}\\sum_{\\mathbf{p}} d(\\mathbf{p})\n$$\nwhere $N$ is the total number of pixels and the sum is over all pixel locations $\\mathbf{p}$.\n- **Objective**: Determine the ratio $R=\\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically grounded within the field of radiomics and image texture analysis. All terms, such as the Moore neighborhood, dependence size, and mean dependence size, are explicitly defined. The inputs are simple matrices, and the objective is a straightforward calculation based on the provided definitions. The problem is self-contained, consistent, and does not violate any scientific or mathematical principles. It is not ambiguous, ill-posed, or trivial.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\n### Solution Derivation\n\nThe goal is to compute the ratio $R = \\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})}$. This requires calculating the mean dependence size, $\\bar{d}(\\mathcal{I})$, for each image $\\mathcal{I}_{A}$ and $\\mathcal{I}_{B}$.\n\n#### Calculation for Image $\\mathcal{I}_{A}$\n\nThe image $\\mathcal{I}_{A}$ is a $5 \\times 5$ matrix where every pixel has a gray level of $2$. The total number of pixels is $N_{A} = 5 \\times 5 = 25$.\n\nThe dependence size $d(\\mathbf{p})$ for a pixel at location $\\mathbf{p}$ is the count of the pixel itself plus its in-bounds neighbors that have the same gray level. Since all pixels in $\\mathcal{I}_{A}$ have the same gray level ($g=2$), $d(\\mathbf{p})$ is simply $1$ plus the number of in-bounds neighbors for that pixel.\n\nThe number of neighbors depends on the pixel's position:\n1.  **Corner pixels**: There are $4$ corner pixels. Each has $3$ neighbors. For these pixels, the dependence size is $d(\\mathbf{p}) = 1 + 3 = 4$.\n2.  **Edge pixels (non-corner)**: There are $4 \\times (5-2) = 12$ edge pixels. Each has $5$ neighbors. For these pixels, the dependence size is $d(\\mathbf{p}) = 1 + 5 = 6$.\n3.  **Interior pixels**: There are $(5-2) \\times (5-2) = 9$ interior pixels. Each has $8$ neighbors. For these pixels, the dependence size is $d(\\mathbf{p}) = 1 + 8 = 9$.\n\nThe sum of the dependence sizes over all pixels in $\\mathcal{I}_{A}$ is:\n$$\n\\sum_{\\mathbf{p} \\in \\mathcal{I}_{A}} d(\\mathbf{p}) = (4 \\times 4) + (12 \\times 6) + (9 \\times 9) = 16 + 72 + 81 = 169.\n$$\n\nThe mean dependence size for $\\mathcal{I}_{A}$ is:\n$$\n\\bar{d}(\\mathcal{I}_{A}) = \\frac{1}{N_{A}} \\sum_{\\mathbf{p} \\in \\mathcal{I}_{A}} d(\\mathbf{p}) = \\frac{169}{25}.\n$$\n\n#### Calculation for Image $\\mathcal{I}_{B}$\n\nThe image $\\mathcal{I}_{B}$ is a $5 \\times 5$ matrix with a repeating $2 \\times 2$ pattern of gray levels. The total number of pixels is $N_{B} = 5 \\times 5 = 25$. Let $g(\\mathbf{p})$ be the gray level at pixel location $\\mathbf{p}=(i,j)$, where $i, j \\in \\{0, 1, 2, 3, 4\\}$. The pattern is based on the parity of the indices:\n- $g(i,j) = 1$ if $i$ is even and $j$ is even.\n- $g(i,j) = 2$ if $i$ is even and $j$ is odd.\n- $g(i,j) = 3$ if $i$ is odd and $j$ is even.\n- $g(i,j) = 4$ if $i$ is odd and $j$ is odd.\n\nWe need to calculate $d(\\mathbf{p})$ for each pixel. Let's consider an arbitrary pixel $\\mathbf{p}$ at $(i,j)$ and its neighbor $\\mathbf{p}'$ at $(i',j')$. For $\\mathbf{p}'$ to be a neighbor of $\\mathbf{p}$ in the eight-neighborhood, we must have $\\max(|i-i'|, |j-j'|) = 1$. This implies that at least one of the conditions $i \\neq i'$ or $j \\neq j'$ must be true.\n\nIf $i \\neq i'$, then $i'$ and $i$ have different parities. For example, if $i$ is even, $i'$ must be odd.\nIf $j \\neq j'$, then $j'$ and $j$ have different parities.\n\nSince $(i,j) \\neq (i',j')$, the pair of parities $(i \\pmod 2, j \\pmod 2)$ must be different from $(i' \\pmod 2, j' \\pmod 2)$. For instance, if $i' = i+1$, then $i' \\pmod 2 \\neq i \\pmod 2$.\nThe gray level at any location is uniquely determined by the parity pair of its coordinates. Since the parity pair for any neighbor $\\mathbf{p}'$ is different from that of the central pixel $\\mathbf{p}$, their gray levels must be different: $g(\\mathbf{p}') \\neq g(\\mathbf{p})$.\n\nWith a tolerance $\\alpha=0$, dependence requires gray levels to be exactly equal. Therefore, for any pixel $\\mathbf{p}$ in image $\\mathcal{I}_{B}$, none of its neighbors have the same gray level. The dependence set for any pixel consists only of the pixel itself.\n\nThus, for every pixel $\\mathbf{p}$ in $\\mathcal{I}_{B}$, the dependence size is $d(\\mathbf{p}) = 1$.\n\nThe sum of the dependence sizes over all pixels in $\\mathcal{I}_{B}$ is:\n$$\n\\sum_{\\mathbf{p} \\in \\mathcal{I}_{B}} d(\\mathbf{p}) = \\sum_{\\mathbf{p} \\in \\mathcal{I}_{B}} 1 = N_{B} = 25.\n$$\n\nThe mean dependence size for $\\mathcal{I}_{B}$ is:\n$$\n\\bar{d}(\\mathcal{I}_{B}) = \\frac{1}{N_{B}} \\sum_{\\mathbf{p} \\in \\mathcal{I}_{B}} d(\\mathbf{p}) = \\frac{25}{25} = 1.\n$$\n\n#### Calculation of the Ratio $R$\n\nThe ratio $R$ is given by:\n$$\nR = \\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})} = \\frac{169/25}{1} = \\frac{169}{25} = 6.76.\n$$\n\nThe problem requires the answer as a decimal rounded to four significant figures.\n$$\nR = 6.760.\n$$", "answer": "$$\n\\boxed{6.760}\n$$", "id": "4564089"}, {"introduction": "Radiomic features are powerful, but it is crucial to understand their sensitivity to small variations in image data. This practice [@problem_id:4564095] challenges you to explore this concept by comparing the dependence entropy of two nearly identical images that differ by only a single pixel value. This controlled experiment reveals how subtle changes can propagate through the GLDM calculation, offering valuable lessons on feature stability and the importance of careful validation.", "problem": "A Gray-Level Dependence Matrix (GLDM) is defined for an image as follows: for each pixel with gray level $g$, its dependence count $d$ is the number $1$ plus the number of neighboring pixels whose absolute gray-level difference from the center pixel is less than or equal to a prescribed tolerance $\\alpha$, using an $8$-connected neighborhood (Chebyshev distance $1$). The GLDM $P(g,d)$ records, for each gray level $g$ and dependence count $d$, the number of pixels having gray level $g$ and dependence count $d$. Consider two controlled test images designed for testing and debugging a GLDM implementation:\n$$\nI_{0} \\;=\\;\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 1 \\\\\n2 & 1 & 1\n\\end{pmatrix}\n\\qquad\\text{and}\\qquad\nI_{1} \\;=\\;\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 1 \\\\\n1 & 1 & 1\n\\end{pmatrix}.\n$$\nAssume a gray-level tolerance $\\alpha = 0$ and the $8$-connected neighborhood. For each image, construct the GLDM $P(g,d)$ from first principles, normalize it to a joint distribution $p_{g,d}$ by dividing by the total number of pixels $N$, and compute the Shannon entropy of this joint distribution using the natural logarithm. Let $H(I_{0})$ and $H(I_{1})$ denote these entropies. Compute the difference $\\Delta H = H(I_{1}) - H(I_{0})$. Express the final answer as a decimal number, and round your answer to four significant figures.", "solution": "### Problem Validation\n\n#### Step 1: Extract Givens\nThe problem provides the following information:\n1.  **Definition of Gray-Level Dependence Matrix (GLDM)**: For a pixel with gray level $g$, its dependence count $d$ is $1$ plus the number of neighboring pixels whose absolute gray-level difference from the center pixel is less than or equal to a tolerance $\\alpha$. The GLDM $P(g,d)$ is a count of pixels with gray level $g$ and dependence count $d$.\n2.  **Neighborhood**: $8$-connected neighborhood (Chebyshev distance $1$).\n3.  **Gray-Level Tolerance**: $\\alpha = 0$.\n4.  **Image $I_0$**:\n    $$\n    I_{0} \\;=\\;\n    \\begin{pmatrix}\n    0 & 0 & 0 \\\\\n    0 & 1 & 1 \\\\\n    2 & 1 & 1\n    \\end{pmatrix}\n    $$\n5.  **Image $I_1$**:\n    $$\n    I_{1} \\;=\\;\n    \\begin{pmatrix}\n    0 & 0 & 0 \\\\\n    0 & 1 & 1 \\\\\n    1 & 1 & 1\n    \\end{pmatrix}\n    $$\n6.  **Task**:\n    a. For each image, construct the GLDM $P(g,d)$.\n    b. Normalize $P(g,d)$ by the total number of pixels $N$ to obtain a joint probability distribution $p_{g,d} = P(g,d)/N$.\n    c. Compute the Shannon entropy for each distribution, $H(I_0)$ and $H(I_1)$, using the formula $H = - \\sum_{g,d} p_{g,d} \\ln(p_{g,d})$.\n    d. Compute the difference $\\Delta H = H(I_{1}) - H(I_{0})$.\n    e. Provide the final answer as a decimal rounded to four significant figures.\n\n#### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria:\n-   **Scientifically Grounded**: The problem is based on standard definitions from the field of radiomics and texture analysis, specifically the Gray-Level Dependence Matrix. The concepts of Shannon entropy, image neighborhoods, and gray-level tolerance are all well-established in image processing and information theory. The problem is scientifically and mathematically sound.\n-   **Well-Posed**: The problem is clearly stated with all necessary information. The images, neighborhood, tolerance, and the quantities to be calculated are explicitly defined. A unique solution exists and can be determined by a finite sequence of calculations.\n-   **Objective**: The language is precise and technical. All terms are formally defined or standard in the field. There is no subjective or opinion-based content.\n-   The problem does not exhibit any of the listed flaws (e.g., it is not incomplete, contradictory, unrealistic, or trivial). The calculations are detailed but follow directly from the definitions.\n\n#### Step 3: Verdict and Action\nThe problem is **valid**. The solution will be derived as requested.\n\n### Solution\n\nThe total number of pixels in each image is $N = 3 \\times 3 = 9$. The dependence count $d$ for a pixel with gray value $g_c$ is given by $d = 1 + \\sum_{i \\in \\mathcal{N}} \\delta(|g_i - g_c| \\le \\alpha)$, where $\\mathcal{N}$ is the set of $8$ neighbors and $\\delta(\\cdot)$ is an indicator function. Given $\\alpha = 0$, this simplifies to $d = 1 + (\\text{number of neighbors with gray level equal to } g_c)$.\n\n#### Analysis of Image $I_0$\n\nThe image is $I_{0} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & 1 \\\\ 2 & 1 & 1 \\end{pmatrix}$. We compute the pair $(g,d)$ for each pixel, using $(row, col)$ indexing from $(0,0)$ to $(2,2)$.\n\n1.  Pixel $(0,0)$, $g=0$. Neighbors: $\\{0, 0, 1\\}$. Same-gray-level neighbors: $2$. $d=1+2=3$. Pair: $(0,3)$.\n2.  Pixel $(0,1)$, $g=0$. Neighbors: $\\{0, 0, 0, 1, 1\\}$. Same-gray-level neighbors: $3$. $d=1+3=4$. Pair: $(0,4)$.\n3.  Pixel $(0,2)$, $g=0$. Neighbors: $\\{0, 1, 1\\}$. Same-gray-level neighbors: $1$. $d=1+1=2$. Pair: $(0,2)$.\n4.  Pixel $(1,0)$, $g=0$. Neighbors: $\\{0, 0, 1, 1, 2\\}$. Same-gray-level neighbors: $2$. $d=1+2=3$. Pair: $(0,3)$.\n5.  Pixel $(1,1)$, $g=1$. Neighbors: $\\{0,0,0,0,1,1,1,2\\}$. Same-gray-level neighbors: $3$. $d=1+3=4$. Pair: $(1,4)$.\n6.  Pixel $(1,2)$, $g=1$. Neighbors: $\\{0,0,1,1,1\\}$. Same-gray-level neighbors: $3$. $d=1+3=4$. Pair: $(1,4)$.\n7.  Pixel $(2,0)$, $g=2$. Neighbors: $\\{0, 1, 1\\}$. Same-gray-level neighbors: $0$. $d=1+0=1$. Pair: $(2,1)$.\n8.  Pixel $(2,1)$, $g=1$. Neighbors: $\\{0,1,1,1,2\\}$. Same-gray-level neighbors: $3$. $d=1+3=4$. Pair: $(1,4)$.\n9.  Pixel $(2,2)$, $g=1$. Neighbors: $\\{1, 1, 1\\}$. Same-gray-level neighbors: $3$. $d=1+3=4$. Pair: $(1,4)$.\n\nLet $P_0(g,d)$ be the GLDM for $I_0$. We tally the occurrences of each $(g,d)$ pair:\n-   $P_0(0,2)=1$\n-   $P_0(0,3)=2$\n-   $P_0(0,4)=1$\n-   $P_0(1,4)=4$\n-   $P_0(2,1)=1$\nAll other $P_0(g,d)=0$. The sum of these counts is $1+2+1+4+1=9=N$.\n\nThe normalized GLDM is $p_{g,d}^{(0)} = P_0(g,d)/N$. The non-zero probabilities are:\n$p^{(0)}(0,2)=\\frac{1}{9}$, $p^{(0)}(0,3)=\\frac{2}{9}$, $p^{(0)}(0,4)=\\frac{1}{9}$, $p^{(0)}(1,4)=\\frac{4}{9}$, $p^{(0)}(2,1)=\\frac{1}{9}$.\n\nThe entropy $H(I_0)$ is calculated as:\n$$H(I_0) = - \\sum_{g,d} p^{(0)}(g,d) \\ln(p^{(0)}(g,d))$$\n$$H(I_0) = - \\left[ \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{4}{9}\\ln\\left(\\frac{4}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) \\right]$$\n$$H(I_0) = - \\left[ 3 \\cdot \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{4}{9}\\ln\\left(\\frac{4}{9}\\right) \\right]$$\n$$H(I_0) = - \\frac{1}{9} \\left[ 3\\ln(1) - 3\\ln(9) + 2\\ln(2) - 2\\ln(9) + 4\\ln(4) - 4\\ln(9) \\right]$$\nSince $\\ln(1)=0$ and $\\ln(4)=2\\ln(2)$:\n$$H(I_0) = - \\frac{1}{9} \\left[ -3\\ln(9) + 2\\ln(2) - 2\\ln(9) + 4(2\\ln(2)) - 4\\ln(9) \\right]$$\n$$H(I_0) = - \\frac{1}{9} \\left[ (2+8)\\ln(2) - (3+2+4)\\ln(9) \\right]$$\n$$H(I_0) = - \\frac{1}{9} \\left[ 10\\ln(2) - 9\\ln(9) \\right] = \\ln(9) - \\frac{10}{9}\\ln(2)$$\n\n#### Analysis of Image $I_1$\n\nThe image is $I_{1} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & 1 \\\\ 1 & 1 & 1 \\end{pmatrix}$. We compute the pair $(g,d)$ for each pixel.\n\n1.  Pixel $(0,0)$, $g=0. N:\\{0,0,1\\}$. $d=1+2=3$. Pair: $(0,3)$.\n2.  Pixel $(0,1)$, $g=0. N:\\{0,0,0,1,1\\}$. $d=1+3=4$. Pair: $(0,4)$.\n3.  Pixel $(0,2)$, $g=0. N:\\{0,1,1\\}$. $d=1+1=2$. Pair: $(0,2)$.\n4.  Pixel $(1,0)$, $g=0. N:\\{0,0,1,1,1\\}$. $d=1+2=3$. Pair: $(0,3)$.\n5.  Pixel $(1,1)$, $g=1. N:\\{0,0,0,0,1,1,1,1\\}$. $d=1+4=5$. Pair: $(1,5)$.\n6.  Pixel $(1,2)$, $g=1. N:\\{0,0,1,1,1\\}$. $d=1+3=4$. Pair: $(1,4)$.\n7.  Pixel $(2,0)$, $g=1. N:\\{0,1,1\\}$. $d=1+2=3$. Pair: $(1,3)$.\n8.  Pixel $(2,1)$, $g=1. N:\\{0,1,1,1,1\\}$. $d=1+4=5$. Pair: $(1,5)$.\n9.  Pixel $(2,2)$, $g=1. N:\\{1,1,1\\}$. $d=1+3=4$. Pair: $(1,4)$.\n\nLet $P_1(g,d)$ be the GLDM for $I_1$. We tally the occurrences:\n-   $P_1(0,2)=1$\n-   $P_1(0,3)=2$\n-   $P_1(0,4)=1$\n-   $P_1(1,3)=1$\n-   $P_1(1,4)=2$\n-   $P_1(1,5)=2$\nThe sum is $1+2+1+1+2+2=9=N$.\n\nThe normalized GLDM is $p_{g,d}^{(1)} = P_1(g,d)/N$. The non-zero probabilities are:\n$p^{(1)}(0,2)=\\frac{1}{9}$, $p^{(1)}(0,3)=\\frac{2}{9}$, $p^{(1)}(0,4)=\\frac{1}{9}$, $p^{(1)}(1,3)=\\frac{1}{9}$, $p^{(1)}(1,4)=\\frac{2}{9}$, $p^{(1)}(1,5)=\\frac{2}{9}$.\n\nThe entropy $H(I_1)$ is calculated as:\n$$H(I_1) = - \\sum_{g,d} p^{(1)}(g,d) \\ln(p^{(1)}(g,d))$$\n$$H(I_1) = - \\left[ \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) \\right]$$\nGrouping terms by probability value:\n$$H(I_1) = - \\left[ 3 \\cdot \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + 3 \\cdot \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) \\right]$$\n$$H(I_1) = - \\frac{1}{3} \\left[ \\ln\\left(\\frac{1}{9}\\right) + 2\\ln\\left(\\frac{2}{9}\\right) \\right]$$\n$$H(I_1) = - \\frac{1}{3} \\left[ -\\ln(9) + 2(\\ln(2) - \\ln(9)) \\right]$$\n$$H(I_1) = - \\frac{1}{3} \\left[ 2\\ln(2) - 3\\ln(9) \\right] = \\ln(9) - \\frac{2}{3}\\ln(2)$$\n\n#### Calculation of $\\Delta H$\n\nWe now compute the difference $\\Delta H = H(I_1) - H(I_0)$.\n$$ \\Delta H = \\left(\\ln(9) - \\frac{2}{3}\\ln(2)\\right) - \\left(\\ln(9) - \\frac{10}{9}\\ln(2)\\right) $$\n$$ \\Delta H = \\ln(9) - \\frac{2}{3}\\ln(2) - \\ln(9) + \\frac{10}{9}\\ln(2) $$\n$$ \\Delta H = \\left(\\frac{10}{9} - \\frac{2}{3}\\right)\\ln(2) $$\nFinding a common denominator:\n$$ \\Delta H = \\left(\\frac{10}{9} - \\frac{6}{9}\\right)\\ln(2) = \\frac{4}{9}\\ln(2) $$\n\n#### Numerical Value\n\nThe problem requires a decimal answer rounded to four significant figures. Using the value $\\ln(2) \\approx 0.693147$:\n$$ \\Delta H = \\frac{4}{9} \\times 0.693147 \\approx 0.444444 \\times 0.693147 \\approx 0.308065 $$\nRounding to four significant figures, we look at the first four non-zero digits, which are $3, 0, 8, 0$. The fifth significant digit is $6$, which is greater than or equal to $5$, so we round up the fourth digit.\n$$ \\Delta H \\approx 0.3081 $$", "answer": "$$\\boxed{0.3081}$$", "id": "4564095"}]}