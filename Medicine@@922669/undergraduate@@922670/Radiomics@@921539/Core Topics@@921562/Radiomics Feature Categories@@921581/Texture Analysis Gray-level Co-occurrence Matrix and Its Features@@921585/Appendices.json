{"hands_on_practices": [{"introduction": "The most effective way to grasp the concept of the Gray-Level Co-occurrence Matrix (GLCM) is to construct one from first principles. This exercise guides you through the process of manually building a symmetric GLCM for a small, structured Region of Interest (ROI). By counting pixel pairs for a given offset and applying the rules of boundary handling and symmetry, you will gain a concrete understanding of how this fundamental matrix quantifies spatial texture [@problem_id:4563789].", "problem": "A radiomics analyst is quantizing a small two-dimensional Region of Interest (ROI) from a computed tomography slice into $L=4$ discrete gray levels labeled $\\{0,1,2,3\\}$. The ROI is given as the $4 \\times 5$ matrix\n$$\nI=\\begin{pmatrix}\n0 & 0 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 1 & 1 \\\\\n2 & 2 & 2 & 3 & 3 \\\\\n2 & 2 & 2 & 3 & 3\n\\end{pmatrix}.\n$$\nUsing the concept of the Gray-Level Co-occurrence Matrix (GLCM), defined as the matrix of counts of ordered gray-level pairs separated by a specified spatial offset, construct the non-normalized, symmetric GLCM for the horizontal offset vector $\\vec{d}=(0,1)$ in pixel units. Boundary handling must be nonperiodic: exclude any pair that would require a neighbor outside the ROI. Symmetric pairing means that for every valid pair $(i,j)$ observed with $\\vec{d}$, include the reverse pair $(j,i)$ observed with $-\\vec{d}$ in the same combined matrix, without normalization or averaging. \n\nTasks:\n1. From first principles, enumerate valid ordered pairs for the offset $\\vec{d}=(0,1)$ to construct the directional count matrix, and then apply the symmetric pairing rule to obtain the combined GLCM over gray levels $\\{0,1,2,3\\}$. Based on the resulting counts, justify whether diagonal entries are dominant for this ROI and offset.\n2. Compute the total number $N$ of counted pairs included in the symmetric, non-normalized GLCM under the stated boundary handling. Express your final answer for $N$ as an integer. No rounding is required.", "solution": "The problem is valid as it is scientifically grounded in the principles of texture analysis, specifically the construction of a Gray-Level Co-occurrence Matrix (GLCM), and is well-posed with a complete and consistent set of givens.\n\nThe task is to construct a symmetric, non-normalized GLCM for a given $4 \\times 5$ Region of Interest (ROI) and then determine the total number of pairs counted. The ROI is quantized into $L=4$ gray levels $\\{0, 1, 2, 3\\}$ and is represented by the matrix:\n$$\nI=\\begin{pmatrix}\n0 & 0 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 1 & 1 \\\\\n2 & 2 & 2 & 3 & 3 \\\\\n2 & 2 & 2 & 3 & 3\n\\end{pmatrix}\n$$\nThe spatial offset is specified as $\\vec{d}=(0,1)$, representing a displacement of $0$ rows down and $1$ column to the right (i.e., a horizontally adjacent pixel). Boundary handling is nonperiodic, meaning pairs that require a pixel outside the ROI are excluded.\n\n**1. Construction of the GLCM and Analysis of Diagonal Dominance**\n\nFirst, we construct the directional GLCM, let's call it $P(\\vec{d})$, for the offset $\\vec{d}=(0,1)$. This involves scanning the ROI and counting the occurrences of ordered gray-level pairs $(i, j)$ where $i$ is the gray level of a pixel at coordinates $(r, c)$ and $j$ is the gray level of the pixel at $(r, c+1)$. Given the $4 \\times 5$ dimensions of the matrix $I$ and the nonperiodic boundary condition, we can form pairs for columns $c \\in \\{1, 2, 3, 4\\}$.\n\nThe valid ordered pairs $(I(r,c), I(r,c+1))$ are enumerated as follows:\n- **Row 1:** $(I(1,1), I(1,2)) = (0,0)$; $(I(1,2), I(1,3)) = (0,0)$; $(I(1,3), I(1,4)) = (0,1)$; $(I(1,4), I(1,5)) = (1,1)$.\n- **Row 2:** $(I(2,1), I(2,2)) = (0,0)$; $(I(2,2), I(2,3)) = (0,0)$; $(I(2,3), I(2,4)) = (0,1)$; $(I(2,4), I(2,5)) = (1,1)$.\n- **Row 3:** $(I(3,1), I(3,2)) = (2,2)$; $(I(3,2), I(3,3)) = (2,2)$; $(I(3,3), I(3,4)) = (2,3)$; $(I(3,4), I(3,5)) = (3,3)$.\n- **Row 4:** $(I(4,1), I(4,2)) = (2,2)$; $(I(4,2), I(4,3)) = (2,2)$; $(I(4,3), I(4,4)) = (2,3)$; $(I(4,4), I(4,5)) = (3,3)$.\n\nNext, we tally the counts for each unique pair $(i, j)$ from the list above:\n- Count of $(0,0)$: $4$\n- Count of $(0,1)$: $2$\n- Count of $(1,1)$: $2$\n- Count of $(2,2)$: $4$\n- Count of $(2,3)$: $2$\n- Count of $(3,3)$: $2$\nAll other pairs have a count of $0$.\n\nThe resulting directional GLCM $P(\\vec{d})$ is a $4 \\times 4$ matrix, indexed by the gray levels $\\{0,1,2,3\\}$, where the entry at row $i$ and column $j$ is the count of the pair $(i,j)$:\n$$\nP(\\vec{d}) = \\begin{pmatrix}\n4 & 2 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 4 & 2 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix}\n$$\n\nThe problem requires a symmetric GLCM, $P_{sym}$, which accounts for both the offset $\\vec{d}=(0,1)$ and its reverse $-\\vec{d}=(0,-1)$. This is constructed by summing the directional GLCM for $\\vec{d}$ and the directional GLCM for $-\\vec{d}$. The GLCM for $-\\vec{d}$ is the transpose of the GLCM for $\\vec{d}$, i.e., $P(-\\vec{d}) = P(\\vec{d})^T$.\n\nFirst, we find the transpose of $P(\\vec{d})$:\n$$\nP(-\\vec{d}) = P(\\vec{d})^T = \\begin{pmatrix}\n4 & 0 & 0 & 0 \\\\\n2 & 2 & 0 & 0 \\\\\n0 & 0 & 4 & 0 \\\\\n0 & 0 & 2 & 2\n\\end{pmatrix}\n$$\nThe symmetric GLCM is the sum $P_{sym} = P(\\vec{d}) + P(\\vec{d})^T$:\n$$\nP_{sym} = \\begin{pmatrix}\n4 & 2 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 4 & 2 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix} + \\begin{pmatrix}\n4 & 0 & 0 & 0 \\\\\n2 & 2 & 0 & 0 \\\\\n0 & 0 & 4 & 0 \\\\\n0 & 0 & 2 & 2\n\\end{pmatrix} = \\begin{pmatrix}\n8 & 2 & 0 & 0 \\\\\n2 & 4 & 0 & 0 \\\\\n0 & 0 & 8 & 2 \\\\\n0 & 0 & 2 & 4\n\\end{pmatrix}\n$$\nTo justify whether diagonal entries are dominant, we compare the values on the main diagonal with the off-diagonal values. The diagonal entries are $P_{sym}(0,0)=8$, $P_{sym}(1,1)=4$, $P_{sym}(2,2)=8$, and $P_{sym}(3,3)=4$. The non-zero off-diagonal entries are $P_{sym}(0,1)=P_{sym}(1,0)=2$ and $P_{sym}(2,3)=P_{sym}(3,2)=2$.\nThe sum of diagonal entries is $8+4+8+4=24$. The sum of off-diagonal entries is $2+2+2+2=8$. Since $24 \\gg 8$, the counts are concentrated on the diagonal. Furthermore, for every row $i$, the diagonal element $P_{sym}(i,i)$ is greater than any off-diagonal element $P_{sym}(i,j)$ for $i \\neq j$. This dominance of the diagonal signifies that the texture is largely homogeneous in the horizontal direction, as adjacent pixels frequently share the same gray level. This is consistent with the visual structure of the ROI matrix $I$, which consists of blocks of constant intensity.\n\n**2. Computation of the Total Number of Pairs $N$**\n\nThe total number of counted pairs, $N$, in the symmetric, non-normalized GLCM is the sum of all its elements.\n$$\nN = \\sum_{i=0}^{3} \\sum_{j=0}^{3} P_{sym}(i,j)\n$$\nUsing the matrix $P_{sym}$ calculated above:\n$$\nN = (8+2+0+0) + (2+4+0+0) + (0+0+8+2) + (0+0+2+4) = 10 + 6 + 10 + 6 = 32\n$$\nAlternatively, we can determine $N$ by considering the number of valid pairs for each direction. For the $4 \\times 5$ matrix, the number of valid horizontal pairs for the offset $\\vec{d}=(0,1)$ is $4 \\text{ rows} \\times (5-1) \\text{ columns} = 16$. Similarly, for the reverse offset $-\\vec{d}=(0,-1)$, the number of valid pairs is $4 \\text{ rows} \\times (5-1) \\text{ columns} = 16$. The total number of pairs in the symmetric matrix is the sum from both directions: $N = 16 + 16 = 32$. This confirms the result.", "answer": "$$\\boxed{32}$$", "id": "4563789"}, {"introduction": "Once you can construct a GLCM, the next step is to interpret the texture features derived from it. This practice serves as a foundational thought experiment, asking you to derive feature values for the simplest possible case: a perfectly uniform image where all pixels have the same intensity. By calculating features like contrast, homogeneity, and entropy for this extreme case of perfect order, you will establish a baseline and gain deep intuition for what these metrics truly measure [@problem_id:4563803].", "problem": "A square region of interest (ROI) in a medical image is quantized to $G$ discrete gray levels by a deterministic mapping $Q$ from raw intensities to $\\{0,1,\\dots,G-1\\}$. Consider an ROI of size $M \\times N$ in which all pixels share the same quantized gray-level index $g^{*} \\in \\{0,1,\\dots,G-1\\}$. Using the definition of the Gray-Level Co-occurrence Matrix (GLCM), compute the non-symmetric co-occurrence counts for the spatial offset $\\Delta = (0,1)$ (each pixel paired with its right neighbor when that neighbor lies inside the ROI), normalize the GLCM to obtain a probability matrix, and then derive from first principles the values of the following texture features, using their standard definitions in radiomics and information theory: contrast, dissimilarity, homogeneity (inverse difference moment), angular second moment, energy, entropy (use the natural logarithm), and maximum probability. Provide exact values; no rounding is required. Express your final answer as a row matrix in the order: contrast, dissimilarity, homogeneity, angular second moment, energy, entropy, maximum probability.", "solution": "We begin from the definition of quantization and the Gray-Level Co-occurrence Matrix (GLCM). Let $Q$ map raw pixel intensities to the set $\\{0,1,\\dots,G-1\\}$, and let the ROI be of size $M \\times N$ with all pixels having the same quantized level $g^{*}$. For a chosen offset $\\Delta = (0,1)$, we form ordered pairs $(i,j)$ by taking each pixel and its right neighbor when that neighbor is within the ROI. The GLCM $C$ is an array of counts where $C(i,j)$ is the number of such co-occurrences with left pixel level $i$ and right pixel level $j$.\n\nBecause every pixel in the ROI has level $g^{*}$, every valid pair at offset $\\Delta$ is $(g^{*},g^{*})$. The total number of valid pairs is the number of horizontal neighbor relationships in the ROI, which is $M(N-1)$. Hence\n$$\nC(i,j) = \\begin{cases}\nM(N-1), & \\text{if } i=g^{*} \\text{ and } j=g^{*},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nThe normalized GLCM (probability matrix) $P$ is defined by dividing counts by the total number of pairs $\\sum_{i=0}^{G-1}\\sum_{j=0}^{G-1} C(i,j) = M(N-1)$. Therefore,\n$$\nP(i,j) = \\frac{C(i,j)}{M(N-1)} = \\begin{cases}\n1, & \\text{if } i=g^{*} \\text{ and } j=g^{*},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nEquivalently, $P(i,j) = \\delta_{i,g^{*}}\\,\\delta_{j,g^{*}}$, where $\\delta$ is the Kronecker delta.\n\nWe now compute the requested features from their standard definitions in radiomics, starting from $P$. In what follows, all sums are over $i,j \\in \\{0,1,\\dots,G-1\\}$.\n\n1. Contrast. The contrast is\n$$\n\\text{contrast} = \\sum_{i}\\sum_{j} (i-j)^{2}\\,P(i,j).\n$$\nSince $P(i,j)$ is zero except at $(i,j)=(g^{*},g^{*})$, and $(g^{*}-g^{*})^{2} = 0$, it follows that\n$$\n\\text{contrast} = 0.\n$$\n\n2. Dissimilarity. The dissimilarity is\n$$\n\\text{dissimilarity} = \\sum_{i}\\sum_{j} |i-j|\\,P(i,j).\n$$\nAgain, only $(i,j)=(g^{*},g^{*})$ contributes, with $|g^{*}-g^{*}| = 0$, hence\n$$\n\\text{dissimilarity} = 0.\n$$\n\n3. Homogeneity (inverse difference moment). The homogeneity is\n$$\n\\text{homogeneity} = \\sum_{i}\\sum_{j} \\frac{P(i,j)}{1+(i-j)^{2}}.\n$$\nOnly $(i,j)=(g^{*},g^{*})$ contributes, with denominator $1+(g^{*}-g^{*})^{2} = 1$, so\n$$\n\\text{homogeneity} = \\frac{1}{1} \\cdot P(g^{*},g^{*}) = 1.\n$$\n\n4. Angular second moment (ASM). The ASM is\n$$\n\\text{ASM} = \\sum_{i}\\sum_{j} \\big(P(i,j)\\big)^{2}.\n$$\nWith a single entry equal to $1$ and all others $0$, this yields\n$$\n\\text{ASM} = 1^{2} + \\sum_{\\substack{(i,j)\\neq(g^{*},g^{*})}} 0^{2} = 1.\n$$\n\n5. Energy. The energy is the square root of the angular second moment:\n$$\n\\text{energy} = \\sqrt{\\text{ASM}} = \\sqrt{1} = 1.\n$$\n\n6. Entropy. Using the natural logarithm, the entropy is\n$$\n\\text{entropy} = -\\sum_{i}\\sum_{j} P(i,j)\\,\\ln\\big(P(i,j)\\big),\n$$\nwith the convention that $0\\ln(0)$ is treated as $0$ (by continuity). Only $P(g^{*},g^{*})=1$ contributes, and $\\ln(1)=0$, hence\n$$\n\\text{entropy} = -\\,1 \\cdot 0 = 0.\n$$\n\n7. Maximum probability. The maximum probability feature is\n$$\n\\text{max prob} = \\max_{i,j} P(i,j) = 1.\n$$\n\nCollecting the values in the prescribed order (contrast, dissimilarity, homogeneity, angular second moment, energy, entropy, maximum probability), we obtain the row matrix\n$$\n\\begin{pmatrix}\n0 & 0 & 1 & 1 & 1 & 0 & 1\n\\end{pmatrix}.\n$$\nThese values confirm the expected edge-case behavior for a constant-intensity ROI: maximal homogeneity ($1$), minimal entropy ($0$), zero contrast ($0$) and dissimilarity ($0$), and unity for angular second moment, energy, and maximum probability due to the single nonzero probability mass.", "answer": "$$\\boxed{\\begin{pmatrix}0 & 0 & 1 & 1 & 1 & 0 & 1\\end{pmatrix}}$$", "id": "4563803"}, {"introduction": "As a conceptual counterpart to the perfectly homogeneous texture, this exercise explores the opposite extreme: an image composed of pure random noise. You will determine the theoretical form of the GLCM for an image where pixel intensities are independent and uniformly distributed. Deriving the values for energy, entropy, and maximum probability in this scenario of maximum disorder will solidify your understanding of the dynamic range of these features and how they respond to a complete lack of structure [@problem_id:4563819].", "problem": "An image used in medical radiomics is quantized into $G$ discrete gray levels by a uniform discretizer, such that each pixel independently takes any one of the $G$ gray levels with equal probability. Assume the pixel intensities are independent and identically distributed across the image (pure random noise), and consider a fixed displacement vector within the image grid used to construct a Gray-Level Co-occurrence Matrix (GLCM), where GLCM is defined as follows: for gray levels indexed by $i \\in \\{1,\\dots,G\\}$ and $j \\in \\{1,\\dots,G\\}$, the entry counts the number of pairs of pixels at the specified displacement whose values are $i$ and $j$, respectively, and the normalized GLCM is obtained by dividing by the total number of valid pairs. Let $N_{\\text{pairs}}$ denote the number of valid pixel pairs for the chosen displacement.\n\nUnder these conditions, and in the limit $N_{\\text{pairs}} \\to \\infty$, determine the limiting form of the normalized GLCM and, using only first principles from probability and the definitions of co-occurrence features used in texture analysis, derive the expected values of the following three features:\n- Angular Second Moment (ASM),\n- entropy computed with the natural logarithm,\n- maximum probability.\n\nExpress each of the three results as a closed-form function of $G$. Report your final answer as a single row matrix containing the values of Angular Second Moment (ASM), entropy, and maximum probability, in that order. No rounding is required.", "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective. It provides a clear, self-contained model for deriving standard radiomic features from first principles.\n\nThe problem states that an image is quantized into $G$ discrete gray levels, and each pixel's intensity is an independent and identically distributed (i.i.d.) random variable. The probability distribution is uniform over the set of gray levels $\\{1, 2, \\ldots, G\\}$. This means the probability of any given pixel having a gray level $k$ is:\n$$\nP(\\text{pixel value} = k) = \\frac{1}{G} \\quad \\text{for } k \\in \\{1, 2, \\ldots, G\\}\n$$\n\nA Gray-Level Co-occurrence Matrix (GLCM) is constructed using a fixed displacement vector. The normalized GLCM, denoted here by the matrix $P$, has entries $P(i, j)$ representing the joint probability that a pair of pixels separated by the given displacement have gray levels $i$ and $j$, respectively. In the limit where the number of pixel pairs $N_{\\text{pairs}} \\to \\infty$, this empirical probability converges to the true theoretical probability.\n\nDue to the fundamental assumption that pixel intensities are independent, the joint probability $P(i, j)$ is the product of the individual probabilities:\n$$\nP(i, j) = P(\\text{pixel}_1 = i \\text{ and } \\text{pixel}_2 = j) = P(\\text{pixel}_1 = i) \\times P(\\text{pixel}_2 = j)\n$$\nSince the pixel values are also identically distributed, the probability of any pixel having a specific gray level is the same, regardless of its position. Therefore:\n$$\nP(\\text{pixel}_1 = i) = \\frac{1}{G} \\quad \\text{and} \\quad P(\\text{pixel}_2 = j) = \\frac{1}{G}\n$$\nSubstituting these into the joint probability expression, we get the limiting form of the normalized GLCM entry:\n$$\nP(i, j) = \\frac{1}{G} \\times \\frac{1}{G} = \\frac{1}{G^2}\n$$\nThis result is valid for all pairs of gray levels $(i, j)$ where $i, j \\in \\{1, 2, \\ldots, G\\}$. The limiting normalized GLCM is a $G \\times G$ matrix where every element has the value $1/G^2$.\n\nWith this matrix, we can now derive the specified features.\n\n**1. Angular Second Moment (ASM)**\n\nThe Angular Second Moment (ASM) is defined as the sum of the squared elements of the normalized GLCM:\n$$\n\\text{ASM} = \\sum_{i=1}^{G} \\sum_{j=1}^{G} [P(i, j)]^2\n$$\nSubstituting $P(i, j) = 1/G^2$:\n$$\n\\text{ASM} = \\sum_{i=1}^{G} \\sum_{j=1}^{G} \\left(\\frac{1}{G^2}\\right)^2 = \\sum_{i=1}^{G} \\sum_{j=1}^{G} \\frac{1}{G^4}\n$$\nThe summand $\\frac{1}{G^4}$ is a constant. The double summation runs over $G \\times G = G^2$ pairs of indices $(i, j)$. Therefore, the sum is the constant term multiplied by the number of terms:\n$$\n\\text{ASM} = G^2 \\times \\frac{1}{G^4} = \\frac{G^2}{G^4} = \\frac{1}{G^2}\n$$\n\n**2. Entropy**\n\nThe entropy of the GLCM is defined using the natural logarithm ($\\ln$) as specified:\n$$\n\\text{Entropy} = -\\sum_{i=1}^{G} \\sum_{j=1}^{G} P(i, j) \\ln(P(i, j))\n$$\nWe handle the case $P(i,j)=0$ by the convention $0 \\ln(0) = 0$, but in this problem, $P(i,j) = 1/G^2 > 0$, so this is not a concern. Substituting $P(i, j) = 1/G^2$:\n$$\n\\text{Entropy} = -\\sum_{i=1}^{G} \\sum_{j=1}^{G} \\frac{1}{G^2} \\ln\\left(\\frac{1}{G^2}\\right)\n$$\nThe term $\\frac{1}{G^2} \\ln\\left(\\frac{1}{G^2}\\right)$ is constant with respect to the summation indices $i$ and $j$. The summation again consists of $G^2$ identical terms:\n$$\n\\text{Entropy} = -G^2 \\times \\left[ \\frac{1}{G^2} \\ln\\left(\\frac{1}{G^2}\\right) \\right] = - \\ln\\left(\\frac{1}{G^2}\\right)\n$$\nUsing the properties of logarithms, $\\ln(1/x) = -\\ln(x)$ and $\\ln(x^a) = a \\ln(x)$, we can simplify this expression:\n$$\n\\text{Entropy} = - \\ln(G^{-2}) = -(-2 \\ln(G)) = 2\\ln(G)\n$$\n\n**3. Maximum Probability**\n\nThe maximum probability feature is defined as the maximum value in the normalized GLCM:\n$$\n\\text{Maximum Probability} = \\max_{i,j} \\{P(i, j)\\}\n$$\nIn our derived limiting GLCM, every entry $P(i, j)$ is constant and equal to $1/G^2$. Therefore, the maximum value is simply this constant value:\n$$\n\\text{Maximum Probability} = \\frac{1}{G^2}\n$$\n\nThe three derived features are:\n- Angular Second Moment (ASM): $\\frac{1}{G^2}$\n- Entropy: $2\\ln(G)$\n- Maximum Probability: $\\frac{1}{G^2}$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{G^2} & 2\\ln(G) & \\frac{1}{G^2} \\end{pmatrix} } $$", "id": "4563819"}]}