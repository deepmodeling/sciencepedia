{"hands_on_practices": [{"introduction": "The value of a radiomic feature is not just a reflection of the underlying biology; it is also influenced by the scanner used, the imaging protocol, and random noise. To build reliable models, we must first understand the magnitude of these different sources of variation. This first exercise [@problem_id:4545012] introduces a fundamental statistical method, variance component analysis, to dissect the total variability of a feature and quantify the specific impact of differences between acquisition sites.", "problem": "A multi-center radiomics study evaluates a scalar radiomic texture feature extracted from Computed Tomography (CT) images. For subject $i$ scanned at acquisition site $j$ with repeated measurement index $k$, the feature value is modeled as\n$$Y_{ijk} = \\mu + S_{i} + A_{j} + \\varepsilon_{ijk},$$\nwhere $S_{i}$ is a random effect capturing biological variability between subjects, $A_{j}$ is a random effect capturing variability attributable to acquisition site (scanner, protocol differences), and $\\varepsilon_{ijk}$ is a residual capturing technical noise and within-subject, within-site variation. Assume $S_{i}$, $A_{j}$, and $\\varepsilon_{ijk}$ are mutually independent, each with zero mean, and variances $\\sigma^{2}_{\\text{subject}}$, $\\sigma^{2}_{\\text{site}}$, and $\\sigma^{2}_{\\text{residual}}$, respectively.\n\nUsing the definition of variance and properties of independent random variables, derive the marginal variance of $Y_{ijk}$ and then compute the fraction of the total variability attributable to acquisition site. Take\n$$\\sigma^{2}_{\\text{subject}}=40,\\quad \\sigma^{2}_{\\text{site}}=15,\\quad \\sigma^{2}_{\\text{residual}}=20.$$\nExpress your final answer as a decimal number (no units). No rounding is required.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed problem in applied statistics, specifically concerning variance component analysis within a linear mixed-effects model, which is a standard method in fields like radiomics. The problem is scientifically grounded, objective, and provides a complete and consistent set of givens for its resolution.\n\nThe model for the radiomic feature value, $Y_{ijk}$, for subject $i$ scanned at acquisition site $j$ with repeated measurement index $k$, is given by:\n$$Y_{ijk} = \\mu + S_{i} + A_{j} + \\varepsilon_{ijk}$$\nHere, $\\mu$ is a constant representing the overall population mean. The terms $S_{i}$, $A_{j}$, and $\\varepsilon_{ijk}$ are random variables that are stipulated to be mutually independent, each with a mean of zero. Their respective variances are given as $\\mathrm{Var}(S_i) = \\sigma^{2}_{\\text{subject}}$, $\\mathrm{Var}(A_j) = \\sigma^{2}_{\\text{site}}$, and $\\mathrm{Var}(\\varepsilon_{ijk}) = \\sigma^{2}_{\\text{residual}}$.\n\nOur first objective is to derive the marginal variance of the observation $Y_{ijk}$. The variance of a random variable, let's say $X$, is denoted as $\\mathrm{Var}(X)$. A fundamental property of variance is that for any random variable $X$ and any constant $c$, the variance of their sum is unchanged: $\\mathrm{Var}(X+c) = \\mathrm{Var}(X)$. Applying this principle to the model for $Y_{ijk}$, where $\\mu$ is a constant, we have:\n$$\\mathrm{Var}(Y_{ijk}) = \\mathrm{Var}(\\mu + S_{i} + A_{j} + \\varepsilon_{ijk}) = \\mathrm{Var}(S_{i} + A_{j} + \\varepsilon_{ijk})$$\nAnother core property of variance is that for a sum of mutually independent random variables, the variance of the sum equals the sum of their individual variances. The problem statement explicitly provides that $S_i$, $A_j$, and $\\varepsilon_{ijk}$ are mutually independent. Therefore, we can decompose the variance as follows:\n$$\\mathrm{Var}(Y_{ijk}) = \\mathrm{Var}(S_{i}) + \\mathrm{Var}(A_{j}) + \\mathrm{Var}(\\varepsilon_{ijk})$$\nThis expression represents the total variance of the measured feature, which we can denote as $\\sigma^{2}_{\\text{total}}$. Substituting the given symbols for the variance components, we get:\n$$\\sigma^{2}_{\\text{total}} = \\sigma^{2}_{\\text{subject}} + \\sigma^{2}_{\\text{site}} + \\sigma^{2}_{\\text{residual}}$$\nThis equation embodies the principle of variance decomposition, a cornerstone of statistical analysis for identifying sources of variability.\n\nThe second objective is to compute the fraction of the total variability that is attributable to the acquisition site. This is calculated as the ratio of the variance component due to the site, $\\sigma^{2}_{\\text{site}}$, to the total variance, $\\sigma^{2}_{\\text{total}}$.\n$$\\text{Fraction}_{\\text{site}} = \\frac{\\sigma^{2}_{\\text{site}}}{\\sigma^{2}_{\\text{total}}} = \\frac{\\sigma^{2}_{\\text{site}}}{\\sigma^{2}_{\\text{subject}} + \\sigma^{2}_{\\text{site}} + \\sigma^{2}_{\\text{residual}}}$$\nThis fraction is a form of the Intraclass Correlation Coefficient (ICC), which quantifies the proportion of total variance in the data that is accounted for by a specific grouping or clustering factor (in this case, the acquisition site).\n\nWe are given the following numerical values for the variance components:\n$$\\sigma^{2}_{\\text{subject}} = 40$$\n$$\\sigma^{2}_{\\text{site}} = 15$$\n$$\\sigma^{2}_{\\text{residual}} = 20$$\nFirst, we compute the total variance, $\\sigma^{2}_{\\text{total}}$, by substituting these values into our derived formula:\n$$\\sigma^{2}_{\\text{total}} = 40 + 15 + 20 = 75$$\nNext, we calculate the required fraction by substituting the value of $\\sigma^{2}_{\\text{site}}$ and the computed value of $\\sigma^{2}_{\\text{total}}$:\n$$\\text{Fraction}_{\\text{site}} = \\frac{15}{75}$$\nFinally, we simplify this fraction to obtain the decimal representation as requested:\n$$\\text{Fraction}_{\\text{site}} = \\frac{1}{5} = 0.2$$\nThus, $20\\%$ of the total variability in the radiomic feature measurements is attributable to differences between acquisition sites.", "answer": "$$\\boxed{0.2}$$", "id": "4545012"}, {"introduction": "While decomposing variance helps us understand the sources of variability, we often need a single, standardized metric to judge a feature's reliability. The Intraclass Correlation Coefficient (ICC) serves this exact purpose, providing a score that reflects how much of a feature's variation is due to true differences between subjects versus measurement variability. In this practice [@problem_id:4545040], you will derive and calculate the ICC, a crucial step in evaluating whether a feature is robust enough for clinical applications.", "problem": "A radiomics study evaluates the repeatability of a scalar intensity-based feature extracted from Computed Tomography (CT) images across repeated acquisitions. For each subject, multiple scans are acquired under nominally identical conditions, and the feature is computed for each scan. Assume a one-way random-effects model for the measured feature:\n$$\nY_{ij} = \\mu + S_{i} + \\varepsilon_{ij},\n$$\nwhere $Y_{ij}$ is the feature value for subject $i$ on acquisition $j$, $\\mu$ is a fixed overall mean, $S_{i}$ is a subject-specific random effect with $S_{i} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{between}})$ representing true between-subject variability, and $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{within}})$ represents within-subject variability dominated by image acquisition variability and downstream processing noise. Assume independence between $S_{i}$ and $\\varepsilon_{ij}$ and across different indices. The Intraclass Correlation Coefficient (ICC) is defined here as the correlation between two independent replicate measurements on the same subject under this model.\n\nSuppose $n=10$ subjects were scanned repeatedly, and variance component estimates aggregated across the cohort yield $\\sigma^{2}_{\\text{between}}=25$ and $\\sigma^{2}_{\\text{within}}=10$ (both in squared feature units).\n\nTasks:\n1. Starting from the definition of the correlation between two replicate measurements on the same subject under the stated model, derive a closed-form expression for the Intraclass Correlation Coefficient (ICC) in terms of $\\sigma^{2}_{\\text{between}}$ and $\\sigma^{2}_{\\text{within}}$.\n2. Using the provided variance components, compute the numerical value of the ICC.\n3. Briefly explain what the computed ICC implies about the robustness of the feature to acquisition variability and how this should influence feature selection in radiomics.\n\nReport the ICC as a single decimal number rounded to four significant figures. Do not include units in your final reported number. The explanatory discussion does not require numerical output beyond the ICC value.", "solution": "The scenario is modeled by the one-way random-effects model\n$$\nY_{ij} = \\mu + S_{i} + \\varepsilon_{ij},\n$$\nwith $S_{i} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{between}})$ representing true subject-to-subject variability and $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{within}})$ representing acquisition-related and residual within-subject variability. We assume independence across indices and between $S_{i}$ and $\\varepsilon_{ij}$. Under this model, the Intraclass Correlation Coefficient (ICC) for single measurements is defined as the correlation between two independent replicate measurements from the same subject:\n$$\n\\text{ICC} = \\operatorname{Corr}(Y_{i1}, Y_{i2}).\n$$\n\nTo derive $\\text{ICC}$ in terms of $\\sigma^{2}_{\\text{between}}$ and $\\sigma^{2}_{\\text{within}}$, we compute the covariance and variances of replicates for the same subject. For a fixed subject $i$,\n$$\nY_{i1} = \\mu + S_{i} + \\varepsilon_{i1}, \\quad Y_{i2} = \\mu + S_{i} + \\varepsilon_{i2}.\n$$\nUsing linearity of variance and independence,\n$$\n\\operatorname{Var}(Y_{i1}) = \\operatorname{Var}(S_{i}) + \\operatorname{Var}(\\varepsilon_{i1}) = \\sigma^{2}_{\\text{between}} + \\sigma^{2}_{\\text{within}},\n$$\nand similarly\n$$\n\\operatorname{Var}(Y_{i2}) = \\sigma^{2}_{\\text{between}} + \\sigma^{2}_{\\text{within}}.\n$$\nThe covariance between two replicates for the same subject is\n$$\n\\operatorname{Cov}(Y_{i1}, Y_{i2}) = \\operatorname{Cov}(S_{i} + \\varepsilon_{i1}, S_{i} + \\varepsilon_{i2}) = \\operatorname{Cov}(S_{i}, S_{i}) + \\operatorname{Cov}(S_{i}, \\varepsilon_{i2}) + \\operatorname{Cov}(\\varepsilon_{i1}, S_{i}) + \\operatorname{Cov}(\\varepsilon_{i1}, \\varepsilon_{i2}).\n$$\nBy independence, $\\operatorname{Cov}(S_{i}, \\varepsilon_{ij}) = 0$ and $\\operatorname{Cov}(\\varepsilon_{i1}, \\varepsilon_{i2}) = 0$ for $1 \\neq 2$, leaving\n$$\n\\operatorname{Cov}(Y_{i1}, Y_{i2}) = \\operatorname{Var}(S_{i}) = \\sigma^{2}_{\\text{between}}.\n$$\nTherefore, the correlation is\n$$\n\\text{ICC} = \\frac{\\operatorname{Cov}(Y_{i1}, Y_{i2})}{\\sqrt{\\operatorname{Var}(Y_{i1})\\operatorname{Var}(Y_{i2})}} = \\frac{\\sigma^{2}_{\\text{between}}}{\\sigma^{2}_{\\text{between}} + \\sigma^{2}_{\\text{within}}}.\n$$\n\nNow substitute the given variance components $\\sigma^{2}_{\\text{between}} = 25$ and $\\sigma^{2}_{\\text{within}} = 10$:\n$$\n\\text{ICC} = \\frac{25}{25 + 10} = \\frac{25}{35} = \\frac{5}{7}.\n$$\nAs a decimal, this is\n$$\n\\text{ICC} = \\frac{5}{7} \\approx 0.714285714\\ldots\n$$\nRounded to four significant figures, the ICC is\n$$\n0.7143.\n$$\n\nInterpretation and implications for feature selection: An Intraclass Correlation Coefficient of approximately $0.7143$ indicates that the majority of the total variability in the feature arises from true between-subject differences rather than acquisition-related within-subject variability, but a nontrivial fraction of variability is still due to acquisition effects. In radiomics pipelines, features with higher repeatability (often operationalized with thresholds such as $\\text{ICC} \\geq 0.75$ or $\\text{ICC} \\geq 0.80$) are generally preferred to ensure robustness across scans and scanners. An ICC near $0.7143$ suggests moderate-to-good repeatability; this feature may be considered borderline for high-stakes predictive modeling. This result would motivate either applying harmonization or standardization procedures to reduce $\\sigma^{2}_{\\text{within}}$, re-evaluating the feature extraction parameters, or prioritizing alternative features with higher ICC for inclusion in the final model.", "answer": "$$\\boxed{0.7143}$$", "id": "4545040"}, {"introduction": "Ultimately, our goal in radiomics is to select a small set of features that are both predictive and reliable. Simply choosing the most stable features isn't enough; they might all measure the same underlying biological property, leading to a redundant model. This final practice [@problem_id:4545050] simulates a realistic, two-stage feature selection process, challenging you to balance the dual requirements of feature stability (high ICC) and informational non-redundancy (low correlation).", "problem": "A research team is building a radiomics signature from Computed Tomography (CT) images acquired at multiple sites with different acquisition parameters. Because variability in acquisition can degrade the reproducibility of engineered image features, the team adopts a two-stage selection policy grounded in reliability and redundancy control. The goal is to retain features that are stable with respect to acquisition changes and not redundant with each other.\n\nFoundational principles used by the team:\n1. The Intraclass Correlation Coefficient (ICC) quantifies reliability as the ratio of between-subject variance to total variance, with higher values indicating greater stability of a feature across repeated measurements and acquisition conditions. Formally, if a one-way random-effects model is assumed, reliability is captured by an ICC of the form $ \\mathrm{ICC} = \\frac{\\sigma_{\\text{between}}^{2}}{\\sigma_{\\text{between}}^{2} + \\sigma_{\\text{within}}^{2}} $, where $ \\sigma_{\\text{between}}^{2} $ and $ \\sigma_{\\text{within}}^{2} $ denote between-subject and within-subject variance components, respectively.\n2. The Pearson correlation coefficient measures linear dependence between two features across subjects. High absolute correlation indicates redundancy in the encoded information.\n\nThe selection policy is as follows:\n- Stage 1 (reliability filtering): Retain features whose Intraclass Correlation Coefficient (ICC) is at least a stability threshold $ \\tau_{S} = 0.75 $.\n- Stage 2 (redundancy pruning): Among the retained features, construct an undirected graph where an edge links two features if their absolute Pearson correlation is at least a redundancy threshold $ \\tau_{R} = 0.80 $. In each connected component of this graph, keep only the feature with the highest ICC and discard the others.\n\nYou are given four candidate features $ F_{1}, F_{2}, F_{3}, F_{4} $ with ICCs\n$$\n\\{ \\mathrm{ICC}(F_{1}), \\mathrm{ICC}(F_{2}), \\mathrm{ICC}(F_{3}), \\mathrm{ICC}(F_{4}) \\} = \\{ 0.85, 0.72, 0.45, 0.90 \\}.\n$$\nAcross a cohort of subjects, the empirical Pearson correlation matrix $ \\mathbf{R} $ between these features is\n$$\n\\mathbf{R} =\n\\begin{pmatrix}\n1 & 0.82 & 0.00 & 0.82 \\\\\n0.82 & 1 & 0.00 & 0.82 \\\\\n0.00 & 0.00 & 1 & 0.00 \\\\\n0.82 & 0.82 & 0.00 & 1\n\\end{pmatrix}.\n$$\n\nApply the two-stage selection policy described above to these features. After selection, compute the mean Intraclass Correlation Coefficient (mean ICC) of the selected feature set. Express your final result as a unitless number rounded to four significant figures.", "solution": "The problem requires the application of a two-stage feature selection policy to a set of four radiomic features, followed by the calculation of the mean Intraclass Correlation Coefficient (ICC) of the selected features. The process will be executed step-by-step as defined in the problem description.\n\nFirst, we must validate the problem statement.\nAll given information is explicitly stated:\n1.  A set of four features: $F_{1}, F_{2}, F_{3}, F_{4}$.\n2.  Their corresponding ICCs: $\\{ \\mathrm{ICC}(F_{1}), \\mathrm{ICC}(F_{2}), \\mathrm{ICC}(F_{3}), \\mathrm{ICC}(F_{4}) \\} = \\{ 0.85, 0.72, 0.45, 0.90 \\}$.\n3.  The Pearson correlation matrix $\\mathbf{R}$ between the features:\n    $$\n    \\mathbf{R} =\n    \\begin{pmatrix}\n    1 & 0.82 & 0.00 & 0.82 \\\\\n    0.82 & 1 & 0.00 & 0.82 \\\\\n    0.00 & 0.00 & 1 & 0.00 \\\\\n    0.82 & 0.82 & 0.00 & 1\n    \\end{pmatrix}\n    $$\n4.  The two-stage selection policy:\n    -   Stage 1 (Reliability): Retain features with $\\mathrm{ICC} \\geq \\tau_{S}$, where the stability threshold is $\\tau_{S} = 0.75$.\n    -   Stage 2 (Redundancy): For the retained features, build a graph where an edge connects features if their absolute Pearson correlation is $\\geq \\tau_{R}$, with the redundancy threshold $\\tau_{R} = 0.80$. In each connected component, keep only the feature with the highest ICC.\n5.  The final task is to compute the mean ICC of the selected features, rounded to four significant figures.\n\nThe problem is scientifically grounded, using standard methods from radiomics and statistics (ICC, Pearson correlation). It is well-posed, with all necessary data and unambiguous rules provided. The language is objective and formal. Therefore, the problem is valid, and we may proceed with the solution.\n\n**Stage 1: Reliability Filtering**\n\nThis stage filters features based on their ICC values. The stability threshold is $\\tau_{S} = 0.75$. A feature is retained if its ICC is greater than or equal to this threshold. We evaluate each feature:\n\n-   For feature $F_{1}$: $\\mathrm{ICC}(F_{1}) = 0.85$. Since $0.85 \\geq 0.75$, feature $F_{1}$ is retained.\n-   For feature $F_{2}$: $\\mathrm{ICC}(F_{2}) = 0.72$. Since $0.72 < 0.75$, feature $F_{2}$ is discarded.\n-   For feature $F_{3}$: $\\mathrm{ICC}(F_{3}) = 0.45$. Since $0.45 < 0.75$, feature $F_{3}$ is discarded.\n-   For feature $F_{4}$: $\\mathrm{ICC}(F_{4}) = 0.90$. Since $0.90 \\geq 0.75$, feature $F_{4}$ is retained.\n\nAfter Stage 1, the set of retained features is $\\{F_{1}, F_{4}\\}$.\n\n**Stage 2: Redundancy Pruning**\n\nThis stage operates on the set of features that passed Stage 1: $\\{F_{1}, F_{4}\\}$. We construct an undirected graph where these features are the nodes. An edge is drawn between two nodes if the absolute value of their Pearson correlation coefficient, $|\\rho|$, is greater than or equal to the redundancy threshold $\\tau_{R} = 0.80$.\n\nWe need to check the correlation between $F_{1}$ and $F_{4}$. From the given correlation matrix $\\mathbf{R}$, the element at row $1$, column $4$ is $\\mathbf{R}_{14} = 0.82$.\n\nThe absolute value of this correlation is $|\\mathbf{R}_{14}| = |0.82| = 0.82$. We compare this to the threshold $\\tau_{R}$:\n$$\n0.82 \\geq \\tau_{R} = 0.80\n$$\nThe condition is satisfied. Therefore, an edge is placed between nodes $F_{1}$ and $F_{4}$. The resulting graph has one connected component containing both features: $\\{F_{1}, F_{4}\\}$.\n\nAccording to the policy, within each connected component, only the feature with the highest ICC is retained. We compare the ICCs of the features in this component:\n-   $\\mathrm{ICC}(F_{1}) = 0.85$\n-   $\\mathrm{ICC}(F_{4}) = 0.90$\n\nSince $\\mathrm{ICC}(F_{4}) > \\mathrm{ICC}(F_{1})$, feature $F_{4}$ is kept and feature $F_{1}$ is discarded.\n\nAfter both stages of the selection policy, the final set of selected features contains only one feature: $\\{F_{4}\\}$.\n\n**Final Calculation**\n\nThe problem requires calculating the mean ICC of the selected feature set. The selected set is $\\{F_{4}\\}$.\nThe ICC for this single feature is $\\mathrm{ICC}(F_{4}) = 0.90$.\nThe mean ICC of a set containing a single element is the value of that element itself.\n$$\n\\text{Mean ICC} = \\frac{\\mathrm{ICC}(F_{4})}{1} = 0.90\n$$\nThe problem specifies that the result must be rounded to four significant figures. To express $0.90$ with four significant figures, we write it as $0.9000$.", "answer": "$$\\boxed{0.9000}$$", "id": "4545050"}]}