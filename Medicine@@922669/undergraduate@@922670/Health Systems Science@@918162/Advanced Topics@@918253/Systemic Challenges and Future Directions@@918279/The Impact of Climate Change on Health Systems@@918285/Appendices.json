{"hands_on_practices": [{"introduction": "A critical first step in managing climate-related health threats is to quantify them. This exercise provides practice with a fundamental tool in environmental epidemiology: the dose-response function. By calculating the change in relative risk based on a temperature increase, you will translate an environmental exposure into a direct measure of its expected impact on health outcomes [@problem_id:4399440].", "problem": "A regional health system is planning surge capacity for heat-related admissions under climate change. Empirical epidemiologic evidence often models exposure-response using Relative Risk (RR), where Relative Risk (RR) is defined as the ratio of the incidence at an exposure level to the incidence at a reference (baseline) level. Consider daily mean temperature $T$ measured in degrees Celsius, and suppose the reference temperature is $30^{\\circ}\\mathrm{C}$. For temperatures above this reference, the dose-response function of heat-related admissions is modeled as\n$$\nRR(T) = \\exp\\big(\\beta\\,(T - 30)\\big),\n$$\nwhere $\\beta$ is a constant derived from a meta-analysis of time-series studies. Let $\\beta = 0.04$, and consider a day with $T = 36^{\\circ}\\mathrm{C}$.\n\nUsing only the core definition of Relative Risk and its interpretation as a multiplicative change in incidence, determine the expected proportional increase in heat-related admissions relative to the $30^{\\circ}\\mathrm{C}$ baseline. Express the increase as a decimal (for example, write $0.25$ for a $25$ percent increase) and round your final answer to three significant figures. No units are required for the final answer.", "solution": "The problem statement is evaluated and deemed to be valid. It is scientifically grounded in the principles of epidemiology, well-posed with all necessary data provided, and objective in its language. The model for Relative Risk is standard in environmental health studies, and the provided parameters are plausible. The problem is a direct and formalizable application of the given definitions and model.\n\nThe objective is to determine the expected proportional increase in heat-related admissions for a given temperature relative to a baseline temperature. Let $I(T)$ represent the incidence of heat-related admissions at a daily mean temperature $T$. The reference (baseline) temperature is given as $T_{ref} = 30^{\\circ}\\mathrm{C}$, with a corresponding baseline incidence of $I(T_{ref}) = I(30)$.\n\nThe problem defines Relative Risk, $RR(T)$, as the ratio of the incidence at an exposure level $T$ to the incidence at the reference level $T_{ref}$. Mathematically, this is expressed as:\n$$\nRR(T) = \\frac{I(T)}{I(T_{ref})}\n$$\n\nThe proportional increase in admissions at temperature $T$ relative to the baseline $T_{ref}$ is the change in incidence, $I(T) - I(T_{ref})$, divided by the baseline incidence, $I(T_{ref})$. Let this proportional increase be denoted by $P$.\n$$\nP = \\frac{I(T) - I(T_{ref})}{I(T_{ref})}\n$$\n\nThis expression can be simplified by separating the terms:\n$$\nP = \\frac{I(T)}{I(T_{ref})} - \\frac{I(T_{ref})}{I(T_{ref})}\n$$\nSubstituting the definition of Relative Risk, we establish a direct relationship between the proportional increase and the Relative Risk:\n$$\nP = RR(T) - 1\n$$\n\nThe problem provides a specific model for the Relative Risk when the temperature $T$ is above the reference temperature of $30^{\\circ}\\mathrm{C}$:\n$$\nRR(T) = \\exp\\big(\\beta(T - 30)\\big)\n$$\nWe are given the constant $\\beta = 0.04$ and are asked to evaluate the situation for a day with temperature $T = 36^{\\circ}\\mathrm{C}$.\n\nFirst, we calculate the Relative Risk, $RR(36)$, using the given model and parameters.\n$$\nRR(36) = \\exp\\big(0.04 \\times (36 - 30)\\big)\n$$\nThe difference in temperature is $36 - 30 = 6$.\n$$\nRR(36) = \\exp(0.04 \\times 6) = \\exp(0.24)\n$$\n\nNow, we can calculate the proportional increase, $P$, using the relationship $P = RR(T) - 1$.\n$$\nP = \\exp(0.24) - 1\n$$\n\nTo obtain the final numerical answer, we compute the value of this expression.\n$$\n\\exp(0.24) \\approx 1.27124915\n$$\nTherefore, the proportional increase is:\n$$\nP \\approx 1.27124915 - 1 = 0.27124915\n$$\n\nThe problem requires the answer to be rounded to three significant figures. The first significant figure is the first non-zero digit, which is $2$. The next two significant figures are $7$ and $1$. The digit following the third significant figure is $2$. Since $2 < 5$, we do not round up the last significant digit.\n$$\nP \\approx 0.271\n$$\nThis value represents a $27.1\\%$ proportional increase in heat-related admissions on a $36^{\\circ}\\mathrm{C}$ day compared to a $30^{\\circ}\\mathrm{C}$ day.", "answer": "$$\\boxed{0.271}$$", "id": "4399440"}, {"introduction": "An increase in heat-related illness directly translates to a surge in patients seeking care, placing significant strain on hospital operations. This practice applies principles from queuing theory to model the performance of an Emergency Department during a heatwave. Calculating key metrics like patient waiting time provides a tangible link between a climate event and the quality of healthcare service delivery, highlighting critical system bottlenecks [@problem_id:4399418].", "problem": "A regional Emergency Department (ED) experiences a sustained heatwave that increases heat-related illness visits. During this event, patient arrivals are well-approximated by a Poisson process with rate $\\lambda = 0.9$ patients per minute, and service times remain exponentially distributed with rate $\\mu = 1$ per minute, with one clinician actively triaging and initiating treatment. Model the ED triage-and-start-of-care station as a single-server Markovian/Markovian/Single-server ($M/M/1$) queue.\n\nUsing only first principles appropriate to queueing processes and conservation relations in flow systems, derive the steady-state expected waiting time in the queue $W_{q}$ and determine whether the system is stable under the heatwave conditions. Report two quantities:\n1. The expected waiting time in queue $W_{q}$ in minutes, rounded to four significant figures.\n2. The utilization factor $\\rho$ (dimensionless), rounded to three significant figures.\n\nProvide your final numerical outputs as a row matrix where the first entry is $W_{q}$ and the second entry is $\\rho$. Express $W_{q}$ in minutes.", "solution": "The problem asks for an analysis of a single-server queueing system, modeled as an $M/M/1$ queue, representing an Emergency Department (ED) triage station under heatwave conditions. We are tasked with deriving the steady-state expected waiting time in the queue, $W_q$, and the system's utilization factor, $\\rho$, from first principles and conservation laws.\n\nThe system is defined by:\n- An arrival process that is Poisson with rate $\\lambda = 0.9$ patients per minute.\n- A service process that is exponential with rate $\\mu = 1$ patient per minute.\n- A single server, $s=1$.\n\nThe state of the system, $n$, is the total number of patients in the system (one being served, if any, and the rest in the queue). Since arrivals are Poisson and service times are exponential, the system can be modeled as a continuous-time Markov chain on the state space of non-negative integers $\\{0, 1, 2, \\dots\\}$.\n\nThe transition rates are:\n- From state $n$ to $n+1$: Arrival rate $\\lambda$, for all $n \\ge 0$.\n- From state $n$ to $n-1$: Service rate $\\mu$, for all $n \\ge 1$.\n\nIn steady-state, the rate of flow into any state $n$ must equal the rate of flow out of that state. This gives us the set of balance equations. Let $P_n$ be the steady-state probability of being in state $n$.\n\nFor state $n=0$ (system is empty):\nThe only way to leave state $0$ is an arrival (rate $\\lambda$). The only way to enter state $0$ is from state $1$ via a service completion (rate $\\mu$).\n$$\n\\lambda P_0 = \\mu P_1\n$$\n\nFor any state $n \\ge 1$:\nThe system leaves state $n$ by either an arrival (rate $\\lambda$) or a service completion (rate $\\mu$). The system enters state $n$ from state $n-1$ via an arrival (rate $\\lambda$) or from state $n+1$ via a service completion (rate $\\mu$).\n$$\n(\\lambda + \\mu) P_n = \\lambda P_{n-1} + \\mu P_{n+1}\n$$\n\nWe can solve this system of linear equations iteratively.\nFrom the equation for state $0$:\n$$\nP_1 = \\frac{\\lambda}{\\mu} P_0\n$$\nLet's define the traffic intensity, or utilization factor, as $\\rho = \\frac{\\lambda}{\\mu}$. Thus, $P_1 = \\rho P_0$.\n\nNow, let's look at the balance equation for $n=1$:\n$$\n(\\lambda + \\mu) P_1 = \\lambda P_0 + \\mu P_2\n$$\nSubstituting $P_1 = \\frac{\\lambda}{\\mu} P_0$:\n$$\n(\\lambda + \\mu) \\frac{\\lambda}{\\mu} P_0 = \\lambda P_0 + \\mu P_2\n$$\n$$\n\\frac{\\lambda^2}{\\mu} P_0 + \\lambda P_0 = \\lambda P_0 + \\mu P_2\n$$\n$$\n\\frac{\\lambda^2}{\\mu} P_0 = \\mu P_2 \\implies P_2 = \\frac{\\lambda^2}{\\mu^2} P_0 = \\rho^2 P_0\n$$\nBy induction, we can show that the general solution is:\n$$\nP_n = \\rho^n P_0 \\quad \\text{for } n \\ge 0\n$$\n\nFor these probabilities to be valid, they must sum to $1$. This requires the infinite geometric series to converge.\n$$\n\\sum_{n=0}^{\\infty} P_n = \\sum_{n=0}^{\\infty} \\rho^n P_0 = P_0 \\sum_{n=0}^{\\infty} \\rho^n = 1\n$$\nThe series $\\sum_{n=0}^{\\infty} \\rho^n$ converges if and only if $|\\rho| < 1$. Since $\\lambda$ and $\\mu$ are positive rates, this condition is $\\rho < 1$, or $\\lambda < \\mu$. This is the stability condition for the queue. If this condition holds, the system is stable and a steady-state distribution exists.\n\nGiven $\\lambda = 0.9$ and $\\mu = 1$, we calculate $\\rho = \\frac{0.9}{1} = 0.9$. Since $0.9 < 1$, the system is stable.\n\nWith the stability condition met, we can find $P_0$:\n$$\nP_0 \\left( \\frac{1}{1-\\rho} \\right) = 1 \\implies P_0 = 1 - \\rho\n$$\nThe steady-state probability distribution is therefore:\n$$\nP_n = (1-\\rho) \\rho^n \\quad \\text{for } n \\ge 0\n$$\nThis is a geometric distribution.\n\nThe first quantity to report is the utilization factor $\\rho$.\n$$\n\\rho = \\frac{\\lambda}{\\mu} = \\frac{0.9}{1} = 0.9\n$$\nRounded to three significant figures, $\\rho = 0.900$.\n\nNext, we derive the expected waiting time in the queue, $W_q$. We first find the expected number of patients in the queue, $L_q$, and then apply Little's Law, a fundamental conservation relation in flow systems.\n\nThe total number of patients in the system is $n$. The number of patients in the queue is $0$ if $n=0$ or $n=1$, and $n-1$ if $n>1$.\nThe expected number of patients in the queue, $L_q$, is given by:\n$$\nL_q = \\sum_{n=1}^{\\infty} (n-1) P_n = \\sum_{n=1}^{\\infty} n P_n - \\sum_{n=1}^{\\infty} P_n\n$$\nThe first term, $\\sum_{n=1}^{\\infty} n P_n$, is the expected number of patients in the entire system, $L$. Note that $\\sum_{n=0}^{\\infty} n P_n = \\sum_{n=1}^{\\infty} n P_n$ as the $n=0$ term is zero.\n$$\nL = E[n] = \\sum_{n=0}^{\\infty} n (1-\\rho)\\rho^n = (1-\\rho) \\sum_{n=0}^{\\infty} n \\rho^n\n$$\nThe sum is the expected value of a geometric random variable (starting from $0$), which is $\\frac{\\rho}{(1-\\rho)^2}$.\n$$\nL = (1-\\rho) \\left( \\frac{\\rho}{(1-\\rho)^2} \\right) = \\frac{\\rho}{1-\\rho}\n$$\nThe second term, $\\sum_{n=1}^{\\infty} P_n$, is the probability that the server is busy.\n$$\n\\sum_{n=1}^{\\infty} P_n = 1 - P_0 = 1 - (1-\\rho) = \\rho\n$$\nThis makes intuitive sense, as the probability of the server being busy is the utilization factor $\\rho$.\nCombining these, we get $L_q$:\n$$\nL_q = L - \\rho = \\frac{\\rho}{1-\\rho} - \\rho = \\frac{\\rho - \\rho(1-\\rho)}{1-\\rho} = \\frac{\\rho - \\rho + \\rho^2}{1-\\rho} = \\frac{\\rho^2}{1-\\rho}\n$$\nNow we apply Little's Law, which states that for a stable system in steady-state, the average number of customers in a queue, $L_q$, is equal to the average arrival rate, $\\lambda$, multiplied by the average time a customer spends in the queue, $W_q$.\n$$\nL_q = \\lambda W_q\n$$\nSolving for $W_q$ and substituting our expression for $L_q$:\n$$\nW_q = \\frac{L_q}{\\lambda} = \\frac{1}{\\lambda} \\left( \\frac{\\rho^2}{1-\\rho} \\right)\n$$\nSubstituting $\\rho = \\lambda / \\mu$:\n$$\nW_q = \\frac{1}{\\lambda} \\left( \\frac{(\\lambda/\\mu)^2}{1 - \\lambda/\\mu} \\right) = \\frac{1}{\\lambda} \\left( \\frac{\\lambda^2/\\mu^2}{(\\mu-\\lambda)/\\mu} \\right) = \\frac{1}{\\lambda} \\frac{\\lambda^2}{\\mu^2} \\frac{\\mu}{\\mu-\\lambda} = \\frac{\\lambda}{\\mu(\\mu-\\lambda)}\n$$\nNow, we can substitute the numerical values:\n$\\lambda = 0.9$ patients/minute.\n$\\mu = 1$ patient/minute.\n$\\rho = 0.9$ (dimensionless).\n\nThe expected waiting time in the queue is:\n$$\nW_q = \\frac{\\lambda}{\\mu(\\mu-\\lambda)} = \\frac{0.9}{1(1-0.9)} = \\frac{0.9}{1(0.1)} = \\frac{0.9}{0.1} = 9 \\text{ minutes}\n$$\nThe problem requires $W_q$ rounded to four significant figures, which is $9.000$ minutes.\nThe problem requires $\\rho$ rounded to three significant figures, which is $0.900$.\n\nThe two quantities to be reported are $W_q = 9.000$ minutes and $\\rho = 0.900$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 9.000 & 0.900 \\end{pmatrix}}\n$$", "id": "4399418"}, {"introduction": "Effective climate adaptation requires ensuring that healthcare infrastructure itself is resilient. This final practice moves from operational to physical system analysis, focusing on the hospital building as a protective environment for patients. By applying principles of energy conservation to model a ward's indoor temperature during a heatwave, you can directly assess patient safety and the adequacy of the facility's design in the face of extreme climate events [@problem_id:4399447].", "problem": "A hospital ward is approximated as a single, perfectly mixed thermal zone. Starting from conservation of energy and the First Law of Thermodynamics, formulate and solve the indoor air temperature dynamics under a constant heatwave. Explicitly assume a well-mixed zone air node with thermal capacitance, a lumped conductance to the outdoors, and a constant net internal heat flow. From this foundation, derive the governing first-order linear ordinary differential equation for the indoor air temperature and solve it for constant outdoor conditions and constant internal heat flow. Then implement the derived solution algorithmically to assess patient safety exposure metrics for the specified test suite.\n\nBase assumptions and definitions to use:\n- Conservation of energy for the zone air node: rate of change of stored thermal energy equals net heat inflow.\n- Let the indoor temperature be denoted by $T_{in}(t)$ in degrees Celsius, the outdoor temperature by $T_{out}$ in degrees Celsius (constant), the zone thermal capacitance by $C$ in joules per kelvin, the overall heat loss coefficient (conductance) by $UA$ in watts per kelvin, and the net internal heat flow by $Q_{int}$ in watts (positive for net heating, negative for net cooling such as partial Heating, Ventilation, and Air Conditioning (HVAC) removal).\n- Initial indoor temperature at time $t=0$ is $T_{in}(0)=T_0$.\n- Simulation horizon is $H$ hours and a fixed time step $dt$ seconds is used.\n- Patient safety thresholds are given by a safe threshold $T_{safe}$ in degrees Celsius and a critical threshold $T_{crit}$ in degrees Celsius. Exceedances are defined strictly by $T_{in}(t) > T_{threshold}$ (that is, equality does not count as an exceedance).\n\nTasks to implement:\n1. Using the conservation of energy principle, derive the linear ordinary differential equation for $T_{in}(t)$ and its solution under constant $T_{out}$ and constant $Q_{int}$. Your implementation may use either the closed-form solution or an exact discrete-time update derived from it over each time step $dt$.\n2. For each test case, simulate $T_{in}(t)$ over the horizon $[0,H]$ with constant parameters $C$, $UA$, $Q_{int}$, $T_{out}$, and $T_0$.\n3. For each test case, compute:\n   - The maximum indoor temperature over the horizon, $T_{max}$, expressed in degrees Celsius and rounded to three decimals.\n   - The fraction of time in $[0,H]$ for which $T_{in}(t) > T_{safe}$, expressed as a decimal rounded to three decimals.\n   - The maximum contiguous duration within $[0,H]$ during which $T_{in}(t) > T_{crit}$, expressed in hours and rounded to three decimals.\n\nPhysical units and numerical specifications:\n- Temperatures are in degrees Celsius, thermal capacitance in joules per kelvin, conductance in watts per kelvin, power in watts, time in seconds or hours as specified. All outputs must be in the units described above.\n- The time step is $dt$ seconds and the horizon is $H$ hours; ensure consistent unit conversion.\n\nTest suite (each test case is specified as an ordered tuple $(C,UA,Q_{int},T_{out},T_0,H,dt,T_{safe},T_{crit})$):\n- Case A (severe heatwave, no active cooling): $(3.0\\times 10^{7},\\,3000,\\,10000,\\,38,\\,24,\\,12,\\,60,\\,26,\\,32)$.\n- Case B (severe heatwave, partial cooling removal): $(8.0\\times 10^{7},\\,3000,\\,-8000,\\,38,\\,24,\\,12,\\,60,\\,26,\\,32)$.\n- Case C (borderline, equals safe threshold): $(3.0\\times 10^{7},\\,3000,\\,0,\\,26,\\,26,\\,6,\\,60,\\,26,\\,32)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of three floats in the order $[T_{max},\\,\\text{fraction\\_above\\_}T_{safe},\\,\\text{max\\_contiguous\\_hours\\_above\\_}T_{crit}]$, with each value rounded to three decimals. For example, the overall structure must be $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$.", "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n- **Governing Principle**: Conservation of energy for a perfectly mixed thermal zone air node. $\\frac{d(\\text{Stored Energy})}{dt} = \\text{Net Heat Inflow}$.\n- **Variables and Constants**:\n    - Indoor air temperature: $T_{in}(t)$ [°C]\n    - Outdoor air temperature (constant): $T_{out}$ [°C]\n    - Zone thermal capacitance: $C$ [J/K]\n    - Overall heat loss coefficient (conductance): $UA$ [W/K]\n    - Net internal heat flow (constant): $Q_{int}$ [W]\n- **Initial Condition**: $T_{in}(0) = T_0$ [°C]\n- **Simulation Parameters**:\n    - Simulation horizon: $H$ [hours]\n    - Time step: $dt$ [seconds]\n- **Safety Thresholds**:\n    - Safe threshold: $T_{safe}$ [°C]\n    - Critical threshold: $T_{crit}$ [°C]\n    - Exceedance condition: $T_{in}(t) > T_{threshold}$\n- **Tasks**:\n    1. Derive the governing first-order linear ordinary differential equation (ODE) for $T_{in}(t)$ and its solution.\n    2. Simulate $T_{in}(t)$ over the horizon $[0,H]$ for each test case.\n    3. Compute three metrics for each case:\n        - Maximum indoor temperature, $T_{max}$ [°C], rounded to three decimals.\n        - Fraction of time in $[0,H]$ where $T_{in}(t) > T_{safe}$, as a decimal rounded to three decimals.\n        - Maximum contiguous duration in $[0,H]$ where $T_{in}(t) > T_{crit}$, in hours rounded to three decimals.\n- **Test Suite**:\n    - Case A: $(C,UA,Q_{int},T_{out},T_0,H,dt,T_{safe},T_{crit}) = (3.0\\times 10^{7},\\,3000,\\,10000,\\,38,\\,24,\\,12,\\,60,\\,26,\\,32)$\n    - Case B: $(C,UA,Q_{int},T_{out},T_0,H,dt,T_{safe},T_{crit}) = (8.0\\times 10^{7},\\,3000,\\,-8000,\\,38,\\,24,\\,12,\\,60,\\,26,\\,32)$\n    - Case C: $(C,UA,Q_{int},T_{out},T_0,H,dt,T_{safe},T_{crit}) = (3.0\\times 10^{7},\\,3000,\\,0,\\,26,\\,26,\\,6,\\,60,\\,26,\\,32)$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the First Law of Thermodynamics and the principle of conservation of energy, applied to a standard and widely used lumped-parameter thermal model for a building zone. This is a fundamental concept in heat transfer and building physics. The problem is scientifically sound.\n- **Well-Posed**: The problem is to solve a first-order linear ordinary differential equation with a specified initial condition. This is a classic initial value problem, which is well-posed, meaning a unique and stable solution exists for the given parameters. All necessary parameters are provided.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. All terms are clearly defined, and the objectives are measurable.\n- **Completeness and Consistency**: All required data ($C, UA, Q_{int}, T_{out}, T_0, H, dt, T_{safe}, T_{crit}$) are provided for each test case. The physical units are specified and consistent. The rate of change of stored energy in the air node, $C \\frac{dT_{in}}{dt}$, has units of $(J/K) \\cdot (K/s) = J/s = W$. The heat flow terms, $UA(T_{out}-T_{in})$ and $Q_{int}$, also have units of watts. The setup is dimensionally consistent. Note that for temperature differences, $\\Delta T$ in Celsius is identical to $\\Delta T$ in Kelvin, so the use of degrees Celsius for temperatures and Kelvin in the unit definitions of $C$ and $UA$ is correct.\n- **No Other Flaws**: The problem is not unrealistic, ill-posed, trivial, or unverifiable. It is a standard and practical problem in engineering.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n---\n## Solution Derivation and Algorithm\n\n### 1. Derivation of the Governing Differential Equation\nThe problem is governed by the principle of energy conservation for the air within the hospital ward, treated as a single, well-mixed thermal node. The rate of change of thermal energy stored in the air must equal the net rate of heat \"inflow\".\n\nThe stored thermal energy, $E_{stored}$, is given by $E_{stored} = C T_{in}(t)$. The rate of change of this energy is:\n$$\n\\frac{dE_{stored}}{dt} = C \\frac{dT_{in}}{dt}\n$$\nThe net heat inflow is the sum of heat from internal sources, $Q_{int}$, and heat transfer from the outdoors. The heat transfer from outdoors into the zone is driven by the temperature difference $T_{out} - T_{in}$ across the thermal conductance $UA$:\n$$\nQ_{transfer} = UA (T_{out} - T_{in})\n$$\nApplying the conservation of energy principle:\n$$\n\\text{Rate of change of stored energy} = \\text{Net heat inflow}\n$$\n$$\nC \\frac{dT_{in}}{dt} = Q_{int} + UA (T_{out} - T_{in})\n$$\nThis is the governing first-order ordinary differential equation. To facilitate solving, we rearrange it into the standard linear form $\\frac{dy}{dt} + p(t)y = q(t)$:\n$$\nC \\frac{dT_{in}}{dt} + UA \\cdot T_{in} = Q_{int} + UA \\cdot T_{out}\n$$\n$$\n\\frac{dT_{in}}{dt} + \\left(\\frac{UA}{C}\\right) T_{in} = \\frac{Q_{int} + UA \\cdot T_{out}}{C}\n$$\n\n### 2. Analytical Solution of the ODE\nThis is a linear first-order ODE with constant coefficients. We can define a thermal time constant $\\tau = \\frac{C}{UA}$ and a steady-state indoor temperature $T_{in,ss}$. The steady-state temperature is the temperature reached as $t \\to \\infty$, where $\\frac{dT_{in}}{dt} = 0$:\n$$\n\\left(\\frac{UA}{C}\\right) T_{in,ss} = \\frac{Q_{int} + UA \\cdot T_{out}}{C} \\implies T_{in,ss} = \\frac{Q_{int}}{UA} + T_{out}\n$$\nThe ODE can be written as $\\frac{dT_{in}}{dt} = -\\frac{1}{\\tau} (T_{in} - T_{in,ss})$. The general solution to this equation is:\n$$\nT_{in}(t) = T_{in,ss} + A e^{-t/\\tau}\n$$\nwhere $A$ is a constant of integration determined by the initial condition $T_{in}(0) = T_0$:\n$$\nT_{in}(0) = T_0 = T_{in,ss} + A e^0 \\implies A = T_0 - T_{in,ss}\n$$\nSubstituting $A$ back into the general solution gives the final analytical solution for the indoor temperature at any time $t$:\n$$\nT_{in}(t) = T_{in,ss} + (T_0 - T_{in,ss}) e^{-t/\\tau}\n$$\n$$\nT_{in}(t) = \\left(\\frac{Q_{int}}{UA} + T_{out}\\right) + \\left(T_0 - \\left(\\frac{Q_{int}}{UA} + T_{out}\\right)\\right) e^{-t \\cdot (UA/C)}\n$$\n\n### 3. Discretization for Numerical Simulation\nFor a simulation with a fixed time step $dt$, it is computationally efficient to use an exact discrete-time update rule derived from the analytical solution. The temperature at time $t+dt$ can be expressed in terms of the temperature at time $t$:\n$$\nT_{in}(t+dt) = T_{in,ss} + (T_0 - T_{in,ss}) e^{-(t+dt)/\\tau} = T_{in,ss} + (T_0 - T_{in,ss}) e^{-t/\\tau} e^{-dt/\\tau}\n$$\nRecognizing that $T_{in}(t) - T_{in,ss} = (T_0 - T_{in,ss}) e^{-t/\\tau}$, we can substitute this into the equation:\n$$\nT_{in}(t+dt) = T_{in,ss} + (T_{in}(t) - T_{in,ss}) e^{-dt/\\tau}\n$$\nLet's define the discrete-time index $k$ such that $t_k = k \\cdot dt$, and let $T_k = T_{in}(t_k)$. The update rule is:\n$$\nT_{k+1} = T_{in,ss} + (T_k - T_{in,ss}) e^{-dt/\\tau}\n$$\nThis can be written as $T_{k+1} = T_k \\alpha + T_{in,ss}(1-\\alpha)$, where the constant factor $\\alpha = e^{-dt/\\tau} = e^{-dt \\cdot UA/C}$ is pre-calculated. This recursive formula is an exact solution to the ODE at discrete time steps and avoids numerical errors associated with methods like Euler integration.\n\n### 4. Algorithmic Implementation for Metrics\nThe solution will be implemented by iterating the discrete-time update rule over the simulation horizon for each test case.\n\n1.  **Initialization**: For each test case, parse the parameters $(C, UA, Q_{int}, T_{out}, T_0, H, dt, T_{safe}, T_{crit})$. Convert the horizon $H$ from hours to seconds ($H_{sec} = H \\times 3600$) and calculate the total number of simulation steps, $N_{steps} = \\text{int}(H_{sec} / dt)$. Pre-calculate the constants $T_{in,ss} = T_{out} + Q_{int}/UA$ and $\\alpha = e^{-dt \\cdot UA/C}$. Initialize the current temperature to $T_0$.\n\n2.  **Simulation Loop**: Iterate from $k=0$ to $N_{steps}-1$. In each step:\n    a. Update the temperature using the discrete rule: $T_{k+1} = T_k \\alpha + T_{in,ss}(1-\\alpha)$.\n    b. Update metric counters based on the new temperature $T_{k+1}$.\n    \n3.  **Metric Calculation**:\n    - **$T_{max}$**: The function $T_{in}(t)$ is monotonic. If $T_0 < T_{in,ss}$, the temperature rises towards $T_{in,ss}$, so $T_{max} = T_{in}(H)$. If $T_0 > T_{in,ss}$, the temperature falls towards $T_{in,ss}$, so $T_{max} = T_0$. If $T_0 = T_{in,ss}$, the temperature is constant, so $T_{max}=T_0$. Therefore, $T_{max}$ is simply $\\max(T_0, T_{in}(H))$, where $T_{in}(H)$ is the temperature at the final simulation step.\n    - **Fraction of time above $T_{safe}$**: A counter, `time_above_safe`, is initialized to $0$. Inside the loop, if $T_{k+1} > T_{safe}$, the counter is incremented by $dt$. After the loop, the fraction is calculated as `time_above_safe / (H \\times 3600)`.\n    - **Maximum contiguous duration above $T_{crit}$**: Two counters are used: `current_contiguous_crit` and `max_contiguous_crit`, both initialized to $0$. Inside the loop, if $T_{k+1} > T_{crit}$, `current_contiguous_crit` is incremented by $dt$. If $T_{k+1} \\le T_{crit}$, the contiguous period is broken; `max_contiguous_crit` is updated with $\\max(\\text{max\\_contiguous\\_crit}, \\text{current\\_contiguous\\_crit})$, and `current_contiguous_crit` is reset to $0$. A final check is performed after the loop to account for a contiguous period that lasts until the end of the simulation. The final value in seconds is converted to hours by dividing by $3600$.\n\n4.  **Output Formatting**: The three computed metrics for each test case are rounded to three decimal places and formatted into the required list-of-lists structure.", "answer": "[[41.103,1.000,10.600],[35.333,1.000,4.600],[26.000,0.000,0.000]]", "id": "4399447"}]}