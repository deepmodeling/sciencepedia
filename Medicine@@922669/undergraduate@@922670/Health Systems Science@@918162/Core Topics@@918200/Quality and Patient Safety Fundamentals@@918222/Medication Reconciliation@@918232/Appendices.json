{"hands_on_practices": [{"introduction": "To improve any process, we must first be able to measure it. This practice applies the core principles of diagnostic testing to evaluate the effectiveness of a medication reconciliation workflow. By analyzing a confusion matrix [@problem_id:4383391], you will calculate key performance metrics like sensitivity and specificity, gaining essential skills for quantifying the accuracy and reliability of any health system process.", "problem": "A health system science team is evaluating a medication reconciliation workflow by comparing a binary classifier’s output to a gold-standard adjudication performed by a multidisciplinary review panel. The classifier labels a patient’s medication list as either “reconciled” (positive class) or “not reconciled” (negative class). The gold standard independently assigns the true reconciliation status for each case. Consider the following empirically observed confusion matrix over $500$ encounters:\n$$\n\\begin{array}{c|cc}\n & \\text{Actually reconciled} & \\text{Actually not reconciled} \\\\\n\\hline\n\\text{Predicted reconciled} & 178 & 22 \\\\\n\\text{Predicted not reconciled} & 36 & 264 \\\\\n\\end{array}\n$$\nUsing the foundational definitions for binary classification metrics in diagnostic testing and quality measurement, compute the sensitivity, specificity, Positive Predictive Value (PPV), Negative Predictive Value (NPV), and the $F_1$ score, where the positive class is “reconciled.” Express each metric as a unitless decimal. Round each metric to four significant figures. Report your final answers as a single row matrix in the order: sensitivity, specificity, PPV, NPV, $F_1$ score.", "solution": "The problem statement will first be validated for scientific soundness, self-consistency, and formalizability.\n\n### Step 1: Extract Givens\nThe following data and conditions are provided:\n- The total number of encounters is $N = 500$.\n- The positive class is defined as “reconciled”.\n- The negative class is defined as “not reconciled”.\n- The confusion matrix is given as:\n  - Predicted reconciled, Actually reconciled (True Positives, $TP$): $178$\n  - Predicted reconciled, Actually not reconciled (False Positives, $FP$): $22$\n  - Predicted not reconciled, Actually reconciled (False Negatives, $FN$): $36$\n  - Predicted not reconciled, Actually not reconciled (True Negatives, $TN$): $264$\n- The task is to compute five metrics: sensitivity, specificity, Positive Predictive Value (PPV), Negative Predictive Value (NPV), and the $F_1$ score.\n- Each metric must be expressed as a unitless decimal rounded to four significant figures.\n- The final answer must be a single row matrix in the specified order.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem is based on foundational concepts in statistics, machine learning, and epidemiology used for evaluating binary classification models. The terms (confusion matrix, sensitivity, specificity, PPV, NPV, $F_1$ score) are well-defined and standard in these fields. The application to medication reconciliation in health systems science is a valid and common use case.\n- **Well-Posed:** All necessary data ($TP$, $FP$, $FN$, $TN$) are explicitly provided. The quantities to be calculated are unambiguously defined by standard formulas. The instructions for output formatting and rounding are precise. A unique solution exists.\n- **Objective:** The problem is stated in quantitative and objective terms, free of subjective language.\n- **Internal Consistency:** The sum of the confusion matrix elements is $178 + 22 + 36 + 264 = 500$, which matches the total number of encounters given, $N=500$. The data is therefore internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and internally consistent. The solution will now be derived.\n\n### Solution Derivation\nThe performance metrics are calculated based on the counts of true positives ($TP$), true negatives ($TN$), false positives ($FP$), and false negatives ($FN$). From the problem statement:\n- $TP = 178$\n- $FP = 22$\n- $FN = 36$\n- $TN = 264$\n\nWe can also calculate the total number of actual positive and negative cases:\n- Total Actual Positives ($P$) = $TP + FN = 178 + 36 = 214$\n- Total Actual Negatives ($N$) = $TN + FP = 264 + 22 = 286$\n\nAnd the total number of predicted positive and negative cases:\n- Total Predicted Positives ($PP$) = $TP + FP = 178 + 22 = 200$\n- Total Predicted Negatives ($PN$) = $TN + FN = 264 + 36 = 300$\n\nThe required metrics are defined and calculated as follows:\n\n1.  **Sensitivity** (also known as Recall or True Positive Rate): This metric measures the proportion of actual positives that are correctly identified.\n    $$\n    \\text{Sensitivity} = \\frac{TP}{TP + FN} = \\frac{178}{214}\n    $$\n    Calculating the value:\n    $$\n    \\text{Sensitivity} = 0.8317757... \\approx 0.8318\n    $$\n\n2.  **Specificity** (also known as True Negative Rate): This metric measures the proportion of actual negatives that are correctly identified.\n    $$\n    \\text{Specificity} = \\frac{TN}{TN + FP} = \\frac{264}{286}\n    $$\n    Calculating the value:\n    $$\n    \\text{Specificity} = 0.9230769... \\approx 0.9231\n    $$\n\n3.  **Positive Predictive Value (PPV)** (also known as Precision): This metric measures the proportion of positive predictions that are actually correct.\n    $$\n    \\text{PPV} = \\frac{TP}{TP + FP} = \\frac{178}{200}\n    $$\n    Calculating the value:\n    $$\n    \\text{PPV} = 0.89\n    $$\n    To express this to four significant figures, we add trailing zeros: $0.8900$.\n\n4.  **Negative Predictive Value (NPV)**: This metric measures the proportion of negative predictions that are actually correct.\n    $$\n    \\text{NPV} = \\frac{TN}{TN + FN} = \\frac{264}{300}\n    $$\n    Calculating the value:\n    $$\n    \\text{NPV} = 0.88\n    $$\n    To express this to four significant figures, we add trailing zeros: $0.8800$.\n\n5.  **$F_1$ Score**: This is the harmonic mean of Precision (PPV) and Recall (Sensitivity). It provides a single score that balances both metrics.\n    $$\n    F_1 = 2 \\times \\frac{\\text{Precision} \\times \\text{Recall}}{\\text{Precision} + \\text{Recall}} = \\frac{2 \\times TP}{2 \\times TP + FP + FN}\n    $$\n    Substituting the values:\n    $$\n    F_1 = \\frac{2 \\times 178}{2 \\times 178 + 22 + 36} = \\frac{356}{356 + 58} = \\frac{356}{414}\n    $$\n    Calculating the value:\n    $$\n    F_1 = 0.85990338... \\approx 0.8599\n    $$\n\nThe five metrics, rounded to four significant figures, are:\n- Sensitivity: $0.8318$\n- Specificity: $0.9231$\n- PPV: $0.8900$\n- NPV: $0.8800$\n- $F_1$ score: $0.8599$\n\nThese values are to be reported in a single row matrix in the specified order.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.8318 & 0.9231 & 0.8900 & 0.8800 & 0.8599 \\end{pmatrix}}\n$$", "id": "4383391"}, {"introduction": "The ultimate goal of medication reconciliation is to prevent patient harm. This exercise moves beyond process accuracy to quantify the real-world clinical impact by modeling the chain of events from a medication discrepancy to a preventable Adverse Drug Event (ADE). You will use probabilistic reasoning [@problem_id:4383352] to estimate the expected number of ADEs, a critical skill for making a data-driven case for patient safety initiatives.", "problem": "A hospital seeks to quantify the effectiveness of Medication Reconciliation (MR) on reducing harm from medication discrepancies at admission. For the purpose of this problem, define a preventable Adverse Drug Event (ADE) as a harm event caused by a medication discrepancy that could have been prevented by MR if the discrepancy had been detected before harm occurred, but was not detected in time. Assume the following scientifically grounded principles as the starting point: the expected value of a sum equals the sum of expected values; a Bernoulli trial with probability $p$ has expected value $p$; and thinning of a Poisson process with independent per-item probabilities yields a Poisson process whose rate is the original rate multiplied by the thinning probability. Consider three discrepancy categories observed at admission, each modeled as an independent Poisson process of discrepancies per admission with mean rates and conditional probabilities described below. For each category $i$, each discrepancy has an independent probability of being clinically significant, an independent conditional probability of causing harm if undetected, and an independent probability of being detected by MR before harm occurs.\n\n- Omission errors: mean rate $\\lambda_{\\text{om}} = 0.5$ discrepancies per admission; clinically significant probability $p_{\\text{cs,om}} = 0.4$; harm given undetected $h_{\\text{om}} = 0.09$; detection probability $d_{\\text{om}} = 0.75$.\n- Dose errors: mean rate $\\lambda_{\\text{dose}} = 0.7$ discrepancies per admission; clinically significant probability $p_{\\text{cs,dose}} = 0.3$; harm given undetected $h_{\\text{dose}} = 0.05$; detection probability $d_{\\text{dose}} = 0.6$.\n- Frequency errors: mean rate $\\lambda_{\\text{freq}} = 0.6$ discrepancies per admission; clinically significant probability $p_{\\text{cs,freq}} = 0.2$; harm given undetected $h_{\\text{freq}} = 0.04$; detection probability $d_{\\text{freq}} = 0.55$.\n\nAssume independence across discrepancies and between the clinical significance, harm conditional on being undetected, and detection events. Derive, from first principles of probability and expectation, the expected number of preventable ADEs that occur per $1{,}000$ admissions by aggregating across categories. Express the final answer in ADEs per $1{,}000$ admissions and round your answer to $3$ significant figures.", "solution": "The problem requires the derivation of the expected number of preventable Adverse Drug Events (ADEs) per $1{,}000$ admissions, based on a probabilistic model of medication discrepancies. The solution will proceed by first determining the probability of a single discrepancy becoming a preventable ADE, then calculating the expected number of such events per admission for each category, and finally summing these expectations and scaling the result.\n\nLet $i$ denote one of the three discrepancy categories: omission ($\\text{om}$), dose ($\\text{dose}$), or frequency ($\\text{freq}$). For a single discrepancy of category $i$ to become a preventable ADE, a sequence of three independent events must occur:\n1. The discrepancy must be clinically significant. The probability of this event is $p_{\\text{cs},i}$.\n2. The discrepancy must not be detected by Medication Reconciliation (MR). The probability of detection is $d_i$, so the probability of non-detection is $1 - d_i$.\n3. The undetected, clinically significant discrepancy must cause harm. The probability of this is given as $h_i$.\n\nDue to the stated independence of these events, the probability that a single discrepancy of category $i$ results in a preventable ADE, which we denote as $p_{\\text{ADE},i}$, is the product of their individual probabilities:\n$$p_{\\text{ADE},i} = p_{\\text{cs},i} \\times (1 - d_i) \\times h_i$$\n\nThe number of discrepancies of category $i$ per admission is modeled as a Poisson process with a mean rate of $\\lambda_i$. Let $N_i$ be the random variable for the number of such discrepancies in one admission. Then $N_i \\sim \\text{Poisson}(\\lambda_i)$, and its expectation is $E[N_i] = \\lambda_i$.\n\nLet $A_i$ be the random variable for the number of preventable ADEs from category $i$ per admission. Each of the $N_i$ discrepancies has a probability $p_{\\text{ADE},i}$ of becoming a preventable ADE. Based on the principle of Poisson process thinning (or, equivalently, by using the law of total expectation), the expected number of preventable ADEs for category $i$ per admission is the product of the expected number of discrepancies and the probability of any one discrepancy becoming an ADE:\n$$E[A_i] = E[N_i] \\times p_{\\text{ADE},i} = \\lambda_i \\times p_{\\text{ADE},i}$$\nCombining these equations, we have:\n$$E[A_i] = \\lambda_i \\times p_{\\text{cs},i} \\times (1 - d_i) \\times h_i$$\n\nWe now apply this formula to each of the three categories using the provided data.\n\n1.  **Omission Errors ($i = \\text{om}$):**\n    The expected number of preventable ADEs from omission errors per admission is:\n    $$E[A_{\\text{om}}] = \\lambda_{\\text{om}} \\times p_{\\text{cs,om}} \\times (1 - d_{\\text{om}}) \\times h_{\\text{om}}$$\n    $$E[A_{\\text{om}}] = 0.5 \\times 0.4 \\times (1 - 0.75) \\times 0.09 = 0.5 \\times 0.4 \\times 0.25 \\times 0.09 = 0.0045$$\n\n2.  **Dose Errors ($i = \\text{dose}$):**\n    The expected number of preventable ADEs from dose errors per admission is:\n    $$E[A_{\\text{dose}}] = \\lambda_{\\text{dose}} \\times p_{\\text{cs,dose}} \\times (1 - d_{\\text{dose}}) \\times h_{\\text{dose}}$$\n    $$E[A_{\\text{dose}}] = 0.7 \\times 0.3 \\times (1 - 0.6) \\times 0.05 = 0.7 \\times 0.3 \\times 0.4 \\times 0.05 = 0.0042$$\n\n3.  **Frequency Errors ($i = \\text{freq}$):**\n    The expected number of preventable ADEs from frequency errors per admission is:\n    $$E[A_{\\text{freq}}] = \\lambda_{\\text{freq}} \\times p_{\\text{cs,freq}} \\times (1 - d_{\\text{freq}}) \\times h_{\\text{freq}}$$\n    $$E[A_{\\text{freq}}] = 0.6 \\times 0.2 \\times (1 - 0.55) \\times 0.04 = 0.6 \\times 0.2 \\times 0.45 \\times 0.04 = 0.00216$$\n\nThe total number of preventable ADEs per admission, $A_{\\text{total}}$, is the sum of the ADEs from each independent category: $A_{\\text{total}} = A_{\\text{om}} + A_{\\text{dose}} + A_{\\text{freq}}$. According to the principle of linearity of expectation, the total expected number of ADEs per admission is the sum of the individual expectations:\n$$E[A_{\\text{total}}] = E[A_{\\text{om}}] + E[A_{\\text{dose}}] + E[A_{\\text{freq}}]$$\n$$E[A_{\\text{total}}] = 0.0045 + 0.0042 + 0.00216 = 0.01086$$\n\nThis value is the expected number of preventable ADEs per single admission. To find the expected number per $1{,}000$ admissions, we multiply this result by $1{,}000$:\n$$E[\\text{ADEs per } 1{,}000 \\text{ admissions}] = E[A_{\\text{total}}] \\times 1000 = 0.01086 \\times 1000 = 10.86$$\n\nThe problem requires the final answer to be rounded to $3$ significant figures.\n$$10.86 \\approx 10.9$$\n\nTherefore, the expected number of preventable ADEs per $1{,}000$ admissions is $10.9$.", "answer": "$$\\boxed{10.9}$$", "id": "4383352"}, {"introduction": "Effective medication reconciliation involves synthesizing information from multiple, often conflicting, sources. This practice places you in the role of a data-savvy clinician, using Bayes' theorem to navigate this uncertainty [@problem_id:4383353]. By calculating how the probability of a medication being active changes with new evidence, you will gain hands-on experience with the probabilistic reasoning that underpins modern clinical decision-making and health informatics.", "problem": "A health system is auditing the process of medication reconciliation for outpatient care. The goal is to estimate how likely it is that a medication is currently being taken (“active use”) when two pieces of evidence are available: recent pharmacy claims and patient self-report. The following well-tested definitions are used as the fundamental base:\n\n- Sensitivity is defined as $P(\\text{test positive} \\mid \\text{condition present})$.\n- Specificity is defined as $P(\\text{test negative} \\mid \\text{condition absent})$.\n- Bayes’ theorem relates posterior probabilities to prior probabilities and likelihoods as $P(A \\mid E) = \\frac{P(E \\mid A) P(A)}{P(E \\mid A) P(A) + P(E \\mid A^{c}) P(A^{c})}$, where $A$ denotes the condition and $E$ denotes the observed evidence.\n\nConsider the condition $A$ to be “medication is in active use.” Evidence comes from two sources:\n\n1. Pharmacy claims indicating a recent fill within the last $30$ days (claims test). The sensitivity for recent-fill claims to indicate active use is $0.80$, and the specificity is $0.70$.\n2. Patient self-report of current use (self-report test). The sensitivity of self-report to indicate active use is $0.90$, and the specificity is $0.95$.\n\nAssume that, conditional on the true activity status of the medication, the claims test and the self-report test are independent. A clinician observes that a patient has a recent fill (claims test positive) but the patient does not report taking the medication (self-report test negative). The pre-evidence probability (prior) that a medication on the list is in active use in this population is $0.40$.\n\nUsing Bayes’ theorem and the provided test characteristics, compute the posterior probability $P(\\text{active use} \\mid \\text{recent fill and no patient report})$. Express your answer as a decimal and round to four significant figures.", "solution": "The problem statement has been validated and is deemed sound. It is a well-posed problem in applied probability theory, with all necessary conditions and data provided.\n\nThe objective is to calculate the posterior probability of a medication being in active use given conflicting evidence from two independent-when-conditioned tests. We will use Bayes' theorem for this purpose.\n\nFirst, let us define the relevant events with formal notation:\n- $A$: The medication is in active use (the condition is present).\n- $A^c$: The medication is not in active use (the condition is absent).\n- $C_p$: The pharmacy claims test is positive (a recent fill is observed).\n- $S_n$: The patient self-report test is negative (the patient does not report taking the medication).\n- $E$: The combined evidence observed, which is the event $C_p \\cap S_n$.\n\nWe are asked to compute the posterior probability $P(A \\mid E)$, which is $P(A \\mid C_p \\cap S_n)$.\n\nFrom the problem statement, we are given the following probabilities:\nThe prior probability of the condition:\n$$P(A) = 0.40$$\nFrom this, the prior probability of the condition being absent is:\n$$P(A^c) = 1 - P(A) = 1 - 0.40 = 0.60$$\n\nThe characteristics of the pharmacy claims test are:\n- Sensitivity: $P(C_p \\mid A) = 0.80$\n- Specificity: $P(C_n \\mid A^c) = 0.70$, where $C_n$ is a negative claims test.\nFrom the specificity, we can find the probability of a positive claims test given no active use (the false positive rate):\n$$P(C_p \\mid A^c) = 1 - P(C_n \\mid A^c) = 1 - 0.70 = 0.30$$\n\nThe characteristics of the patient self-report test are:\n- Sensitivity: $P(S_p \\mid A) = 0.90$, where $S_p$ is a positive self-report.\n- Specificity: $P(S_n \\mid A^c) = 0.95$\nFrom the sensitivity, we can find the probability of a negative self-report given active use (the false negative rate):\n$$P(S_n \\mid A) = 1 - P(S_p \\mid A) = 1 - 0.90 = 0.10$$\n\nThe problem states that the two tests are independent, conditional on the true activity status of the medication. This assumption allows us to compute the likelihood of the combined evidence $E = C_p \\cap S_n$ by multiplying the probabilities of the individual pieces of evidence:\n$$P(E \\mid A) = P(C_p \\cap S_n \\mid A) = P(C_p \\mid A) P(S_n \\mid A)$$\n$$P(E \\mid A^c) = P(C_p \\cap S_n \\mid A^c) = P(C_p \\mid A^c) P(S_n \\mid A^c)$$\n\nLet us calculate these combined likelihoods:\nThe likelihood of the evidence given that the medication is in active use:\n$$P(E \\mid A) = (0.80) \\times (0.10) = 0.08$$\nThe likelihood of the evidence given that the medication is not in active use:\n$$P(E \\mid A^c) = (0.30) \\times (0.95) = 0.285$$\n\nNow, we apply Bayes' theorem to find the posterior probability $P(A \\mid E)$:\n$$P(A \\mid E) = \\frac{P(E \\mid A) P(A)}{P(E)}$$\nThe denominator $P(E)$ is the total probability of the evidence, found by the law of total probability:\n$$P(E) = P(E \\mid A) P(A) + P(E \\mid A^c) P(A^c)$$\nSubstituting this into the theorem gives the full expression:\n$$P(A \\mid E) = \\frac{P(E \\mid A) P(A)}{P(E \\mid A) P(A) + P(E \\mid A^c) P(A^c)}$$\n\nNow, we substitute the numerical values we have calculated:\nThe numerator is:\n$$\\text{Numerator} = P(E \\mid A) P(A) = (0.08) \\times (0.40) = 0.032$$\nThe denominator is:\n$$\\text{Denominator} = (P(E \\mid A) P(A)) + (P(E \\mid A^c) P(A^c)) = (0.08 \\times 0.40) + (0.285 \\times 0.60)$$\n$$\\text{Denominator} = 0.032 + 0.171 = 0.203$$\n\nFinally, we compute the posterior probability:\n$$P(A \\mid E) = \\frac{0.032}{0.203}$$\n$$P(A \\mid E) \\approx 0.15763546798...$$\n\nThe problem requires the answer to be expressed as a decimal rounded to four significant figures.\n$$P(A \\mid C_p \\cap S_n) \\approx 0.1576$$", "answer": "$$\\boxed{0.1576}$$", "id": "4383353"}]}