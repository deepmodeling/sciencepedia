{"hands_on_practices": [{"introduction": "The journey into digital pathology begins with the scanner itself, a sophisticated instrument that marries classical microscopy with modern digital imaging. A crucial question is whether the digital sensor is capable of capturing all the fine details that the microscope's high-quality optics can resolve. This practice bridges the gap between the physical world of optics (numerical aperture, wavelength) and the digital world of pixels, using the fundamental Nyquist-Shannon sampling theorem to assess if a scanner's configuration is adequate for faithful digitization [@problem_id:4356907].", "problem": "A whole-slide imaging scanner in digital pathology uses an infinity-corrected brightfield microscope. An objective labeled $40\\times$ is designed to achieve its nominal magnification with a standard tube lens of focal length $f_t=200\\,\\text{mm}$. The camera has sensor pixel pitch $s=6.5\\,\\mu\\text{m}$. Illumination is broadband, and for performance assessment use the green spectral component $\\lambda=550\\,\\text{nm}$, with the objective numerical aperture $NA=0.75$. Starting from the definition of magnification as the ratio of image size to object size, the meaning of the $40\\times$ label in an infinity microscope, the sampling theorem, and the cutoff of the incoherent optical transfer function, derive the specimen-plane microns-per-pixel $p_{\\text{spec}}$ and use the sampling theorem to determine whether the sampling meets the Nyquist requirement for the given $\\lambda$ and $NA$. Report a single scalar summary of sampling adequacy defined by the oversampling factor\n$$R=\\frac{\\lambda}{4\\,NA\\,p_{\\text{spec}}},$$\nwhere $R\\geq 1$ indicates compliance. Round your final $R$ to four significant figures. Express $R$ as a pure number with no units.", "solution": "The goal is to compute the specimen-plane microns-per-pixel and assess Nyquist compliance via an oversampling factor. The fundamental bases are as follows.\n\nFirst, in an infinity-corrected microscope, the objective forms a collimated beam and the tube lens of focal length $f_t$ forms the intermediate image. The objective’s labeled magnification $M_{\\text{obj}}$ is defined for a standard tube lens, and for standard systems the label $40\\times$ corresponds to an objective-tube lens pair that yields image magnification $M=40$ at the intermediate image plane. Thus the total lateral magnification from specimen to sensor is\n$$M=40.$$\n\nThe specimen-plane pixel size $p_{\\text{spec}}$ is the sensor pixel pitch demagnified by $M$,\n$$p_{\\text{spec}}=\\frac{s}{M}.$$\nSubstituting $s=6.5\\,\\mu\\text{m}$ and $M=40$,\n$$p_{\\text{spec}}=\\frac{6.5\\,\\mu\\text{m}}{40}=0.1625\\,\\mu\\text{m}.$$\n\nNext, to assess sampling adequacy, use the sampling theorem (Nyquist-Shannon). For incoherent brightfield imaging, the optical transfer function (OTF) has a cutoff spatial frequency\n$$f_c=\\frac{2\\,NA}{\\lambda},$$\nwhich is the highest spatial frequency transmitted by the optics. Sampling with pixel spacing $p_{\\text{spec}}$ corresponds to a sampling frequency\n$$f_s=\\frac{1}{p_{\\text{spec}}}.$$\nNyquist requires $f_s\\geq 2 f_c$, which implies\n$$\\frac{1}{p_{\\text{spec}}}\\geq 2\\left(\\frac{2\\,NA}{\\lambda}\\right)\\quad\\Rightarrow\\quad p_{\\text{spec}}\\leq\\frac{\\lambda}{4\\,NA}.$$\nThe oversampling factor is defined as the ratio of the required maximum pixel size to the actual pixel size:\n$$R=\\frac{\\lambda/(4\\,NA)}{p_{\\text{spec}}} = \\frac{\\lambda}{4\\,NA\\,p_{\\text{spec}}}.$$\nIf $R\\geq 1$, the sampling complies with Nyquist; if $R1$, it does not.\n\nNow substitute the given values, using consistent units. Let $\\lambda=550\\,\\text{nm}=0.55\\,\\mu\\text{m}$, $NA=0.75$, and $p_{\\text{spec}}=0.1625\\,\\mu\\text{m}$. Then\n$$R=\\frac{0.55\\,\\mu\\text{m}}{4\\times 0.75\\times 0.1625\\,\\mu\\text{m}}=\\frac{0.55}{3\\times 0.1625}=\\frac{0.55}{0.4875}.$$\nThe calculation gives:\n$$R \\approx 1.128205128.$$\n\nTherefore, the specimen-plane microns-per-pixel is $p_{\\text{spec}}=0.1625\\,\\mu\\text{m}$, and the oversampling factor is $R\\approx 1.1282$. Because $R\\geq 1$, the sampling meets the Nyquist requirement for $\\lambda=550\\,\\text{nm}$ and $NA=0.75$. Rounding the final $R$ to four significant figures gives\n$$R\\approx 1.128.$$", "answer": "$$\\boxed{1.128}$$", "id": "4356907"}, {"introduction": "Having ensured our scanner can capture high-fidelity images, we immediately face a practical challenge: data volume. A single whole-slide image can easily exceed several gigabytes, making it cumbersome to store, transmit, and view. This exercise explores the standard solution to this problem—the multi-resolution image pyramid—which enables smooth, responsive zooming and panning. By working through this problem, you will learn how to perform a fundamental calculation to estimate the storage footprint of a digitized slide, a critical skill for planning any digital pathology project [@problem_id:4356862].", "problem": "A pathology laboratory scans a digitized whole-slide image using Whole-Slide Imaging (WSI) and stores it as a multi-resolution pyramid to support rapid pan-and-zoom. The full-resolution level (level $0$) has dimensions $100{,}000 \\times 50{,}000$ pixels. The image is standard color with three channels ($RGB$), each at $8$ bits per channel. The pyramid is constructed by downsampling by a factor of $2$ in each dimension between successive levels, with each level’s dimensions defined as the ceiling of the previous dimension divided by $2$ to preserve full coverage. Tiling is performed at each level with a fixed tile size of $512 \\times 512$ pixels, and levels are included until a level is reached whose dimensions are each less than or equal to $512$ pixels. Assume that the Joint Photographic Experts Group (JPEG) compression achieves a constant compression ratio of exactly $10{:}1$ at every level, and ignore any metadata, tile headers, or padding overhead. \n\nStarting from core definitions—bits per channel, bytes per pixel, pixel count at each level via the ceiling function, and a constant compression ratio—derive the total compressed storage required for the entire pyramid by summing over all included levels. Express your final answer in gibibytes (GiB), where $1\\,\\mathrm{GiB} = 2^{30}$ bytes, and round your result to four significant figures.", "solution": "To determine the total compressed storage size, we will calculate the size of each level in the image pyramid and then sum these sizes.\n\nFirst, we determine the uncompressed size of a single pixel. The image has 3 channels (RGB) with 8 bits per channel.\n$$ \\text{Bytes per pixel} = \\frac{3\\,\\text{channels} \\times 8\\,\\text{bits/channel}}{8\\,\\text{bits/byte}} = 3\\,\\text{bytes/pixel} $$\nThe compression ratio is $10:1$, so the compressed size per pixel is $3/10 = 0.3$ bytes.\n\nNext, we calculate the dimensions ($W_i, H_i$) and compressed storage size ($S_i$) for each pyramid level $i$, starting from $i=0$. The dimensions for level $i>0$ are $W_i = \\lceil W_{i-1}/2 \\rceil$ and $H_i = \\lceil H_{i-1}/2 \\rceil$. The storage size for level $i$ is $S_i = W_i \\times H_i \\times 0.3$ bytes. We stop when both $W_i \\le 512$ and $H_i \\le 512$.\n\n*   **Level 0:**\n    *   $W_0 = 100,000$, $H_0 = 50,000$\n    *   $S_0 = 100,000 \\times 50,000 \\times 0.3 = 1,500,000,000$ bytes\n\n*   **Level 1:**\n    *   $W_1 = \\lceil 100,000/2 \\rceil = 50,000$, $H_1 = \\lceil 50,000/2 \\rceil = 25,000$\n    *   $S_1 = 50,000 \\times 25,000 \\times 0.3 = 375,000,000$ bytes\n\n*   **Level 2:**\n    *   $W_2 = \\lceil 50,000/2 \\rceil = 25,000$, $H_2 = \\lceil 25,000/2 \\rceil = 12,500$\n    *   $S_2 = 25,000 \\times 12,500 \\times 0.3 = 93,750,000$ bytes\n\n*   **Level 3:**\n    *   $W_3 = \\lceil 25,000/2 \\rceil = 12,500$, $H_3 = \\lceil 12,500/2 \\rceil = 6,250$\n    *   $S_3 = 12,500 \\times 6,250 \\times 0.3 = 23,437,500$ bytes\n\n*   **Level 4:**\n    *   $W_4 = \\lceil 12,500/2 \\rceil = 6,250$, $H_4 = \\lceil 6,250/2 \\rceil = 3,125$\n    *   $S_4 = 6,250 \\times 3,125 \\times 0.3 = 5,859,375$ bytes\n\n*   **Level 5:**\n    *   $W_5 = \\lceil 6,250/2 \\rceil = 3,125$, $H_5 = \\lceil 3,125/2 \\rceil = 1,563$\n    *   $S_5 = 3,125 \\times 1,563 \\times 0.3 = 1,465,312.5$ bytes\n\n*   **Level 6:**\n    *   $W_6 = \\lceil 3,125/2 \\rceil = 1,563$, $H_6 = \\lceil 1,563/2 \\rceil = 782$\n    *   $S_6 = 1,563 \\times 782 \\times 0.3 = 366,679.8$ bytes\n\n*   **Level 7:**\n    *   $W_7 = \\lceil 1,563/2 \\rceil = 782$, $H_7 = \\lceil 782/2 \\rceil = 391$\n    *   The stopping condition ($W_i \\le 512$ AND $H_i \\le 512$) is not met, so we continue.\n    *   $S_7 = 782 \\times 391 \\times 0.3 = 91,728.6$ bytes\n\n*   **Level 8:**\n    *   $W_8 = \\lceil 782/2 \\rceil = 391$, $H_8 = \\lceil 391/2 \\rceil = 196$\n    *   Now both $W_8 \\le 512$ and $H_8 \\le 512$. This is the final level.\n    *   $S_8 = 391 \\times 196 \\times 0.3 = 22,990.8$ bytes\n\nNow, we sum the storage for all levels (0 through 8):\n$$ S_{\\text{total}} = \\sum_{i=0}^{8} S_i = 1,500,000,000 + 375,000,000 + ... + 22,990.8 $$\n$$ S_{\\text{total}} = 1,999,993,586.7\\,\\text{bytes} $$\n\nFinally, we convert the total size to gibibytes (GiB), where $1\\,\\text{GiB} = 2^{30}$ bytes.\n$$ S_{\\text{GiB}} = \\frac{1,999,993,586.7\\,\\text{bytes}}{2^{30}\\,\\text{bytes/GiB}} = \\frac{1,999,993,586.7}{1,073,741,824} \\approx 1.862590\\,\\text{GiB} $$\nRounding the result to four significant figures gives $1.863\\,\\text{GiB}$.", "answer": "$$\n\\boxed{1.863}\n$$", "id": "4356862"}, {"introduction": "Once an image is acquired and stored, we can turn our attention to quantitative analysis. A common task is to measure the amount of a particular stain, like hematoxylin, within the tissue. However, a raw slide image contains both tissue and non-tissue regions (i.e., the glass background). This practice uses statistical first principles to rigorously demonstrate why failing to separate these regions introduces a systematic error, or bias, into your measurements. You will derive an expression for this bias and see just how significantly it can skew results, reinforcing the necessity of background masking as a foundational step in any robust analysis pipeline [@problem_id:4356898].", "problem": "A Whole-Slide Imaging (WSI) scanner acquires a Hematoxylin and Eosin (HE) stained slide under a stable illuminant of incident intensity $I_{0}$. Pixel intensities in each Red-Green-Blue (RGB) channel are converted to Optical Density (OD) using the Beer-Lambert law, defined here as $OD = -\\log_{10}\\!\\left(I/I_{0}\\right)$, where $I$ is the measured transmitted intensity for a pixel. Following standard color deconvolution, consider the scalar hematoxylin OD channel for each pixel as a random variable.\n\nSuppose the slide contains two visually distinct classes of pixels:\n- Tissue pixels, with hematoxylin OD modeled by a random variable $X_{t}$ with mean $\\mu_{t}$ and finite variance.\n- Background pixels (glass or whitespace), with hematoxylin OD modeled by a random variable $X_{b}$ with mean $\\mu_{b}$ and finite variance. For background, $I \\approx I_{0}$, so $\\mu_{b}$ is small and close to $0$.\n\nIn practice, if background masking is not performed, the estimator of the stain mean uses all pixels, resulting in a mixture of tissue and background. Let the fraction of background pixels be $p \\in (0,1)$, so the fraction of tissue pixels is $1-p$. Using only fundamental definitions (Beer-Lambert law, expectation, and mixtures), justify the need for background masking before normalization by deriving the bias in the estimated mean hematoxylin OD introduced by including background pixels. Specifically, derive, from first principles, an analytic expression for the bias $\\Delta \\mu = \\hat{\\mu} - \\mu_{t}$, where $\\hat{\\mu}$ is the large-sample limit of the sample mean computed over all pixels without masking.\n\nThen, evaluate this bias numerically for the case $p = 0.65$, $\\mu_{t} = 0.48$ (OD units), and $\\mu_{b} = 0.02$ (OD units). Round your final numeric result to four significant figures. Express your final answer as an optical density (OD) value (dimensionless).", "solution": "The goal is to derive the bias $\\Delta \\mu = \\hat{\\mu} - \\mu_{t}$ introduced by including background pixels in the calculation of mean Optical Density (OD).\n\n**1. Derive the expression for the estimated mean, $\\hat{\\mu}$**\n\nThe set of all pixels is a mixture of two populations: tissue pixels (fraction $1-p$) and background pixels (fraction $p$). The estimated mean, $\\hat{\\mu}$, is the expected value of the OD of a randomly selected pixel from this mixture. Using the law of total expectation:\n$$ \\hat{\\mu} = E[\\text{Pixel OD}] = P(\\text{tissue}) \\cdot E[\\text{OD}|\\text{tissue}] + P(\\text{background}) \\cdot E[\\text{OD}|\\text{background}] $$\nThe problem gives us the probabilities and the conditional means:\n*   $P(\\text{tissue}) = 1-p$\n*   $P(\\text{background}) = p$\n*   $E[\\text{OD}|\\text{tissue}] = E[X_t] = \\mu_{t}$\n*   $E[\\text{OD}|\\text{background}] = E[X_b] = \\mu_{b}$\n\nSubstituting these into the equation:\n$$ \\hat{\\mu} = (1-p)\\mu_{t} + p\\mu_{b} $$\n\n**2. Derive the analytical expression for bias, $\\Delta \\mu$**\n\nThe bias is defined as the difference between the estimated mean and the true mean of the tissue pixels, $\\mu_t$.\n$$ \\Delta \\mu = \\hat{\\mu} - \\mu_{t} $$\nSubstitute the expression for $\\hat{\\mu}$:\n$$ \\Delta \\mu = \\left( (1-p)\\mu_{t} + p\\mu_{b} \\right) - \\mu_{t} $$\nExpand the terms:\n$$ \\Delta \\mu = \\mu_{t} - p\\mu_{t} + p\\mu_{b} - \\mu_{t} $$\nThe $\\mu_{t}$ terms cancel, leaving:\n$$ \\Delta \\mu = p\\mu_{b} - p\\mu_{t} $$\nFactoring out the common term $p$ gives the final analytical expression for the bias:\n$$ \\Delta \\mu = p(\\mu_{b} - \\mu_{t}) $$\nThis result shows that the bias is proportional to the fraction of background pixels and the difference between the mean background OD and the mean tissue OD. Since background pixels are nearly transparent ($\\mu_b \\approx 0$) and tissue pixels absorb light ($\\mu_t > \\mu_b$), the bias is negative. This means that failing to mask the background systematically underestimates the true tissue stain amount, justifying the need for background masking.\n\n**3. Evaluate the bias numerically**\n\nWe are given the values:\n*   $p = 0.65$\n*   $\\mu_{t} = 0.48$\n*   $\\mu_{b} = 0.02$\n\nSubstitute these into the bias formula:\n$$ \\Delta \\mu = 0.65 (0.02 - 0.48) $$\n$$ \\Delta \\mu = 0.65 (-0.46) $$\n$$ \\Delta \\mu = -0.299 $$\nRounding the result to four significant figures gives $-0.2990$. The units are Optical Density units (dimensionless).", "answer": "$$\\boxed{-0.2990}$$", "id": "4356898"}]}