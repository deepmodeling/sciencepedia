{"hands_on_practices": [{"introduction": "Before the widespread adoption of rigorous statistical methods, it was common to draw conclusions from simple observational data. This practice demonstrates a critical flaw in that approach through a phenomenon known as Simpson's Paradox, where an association observed within separate groups reverses when the groups are combined. By working through this example [@problem_id:4744898], you will see firsthand why confounding variables can lead to incorrect conclusions and why the statistical turn in medicine was so necessary.", "problem": "In the mid-twentieth century, the rise of Evidence-Based Medicine (EBM) relied increasingly on formal statistical reasoning to adjudicate the effects of therapies in realistic clinical populations. Consider an observational cohort study from a pre-randomization era investigating a new therapy for an infectious disease. Patients are grouped by baseline severity into two strata: \"mild\" and \"severe.\" Outcomes are measured as survival at $30$ days. The observed counts are as follows:\n\n- Mild stratum:\n  - Treated: $19$ survivors out of $20$ patients.\n  - Untreated: $180$ survivors out of $200$ patients.\n- Severe stratum:\n  - Treated: $2$ survivors out of $20$ patients.\n  - Untreated: $1$ survivor out of $20$ patients.\n\nUsing only the foundational definitions of risk and contrast measures, proceed as follows:\n\n1. Define the risk (probability of survival) in each group within each stratum as the ratio of survivors to total patients, and define the risk difference as $RD = r_{\\text{treated}} - r_{\\text{untreated}}$. Compute the stratum-specific risks and risk differences, and determine whether the treatment is beneficial within each stratum.\n\n2. Compute the pooled overall risks for the treated and untreated groups by aggregating across both strata, and then compute the pooled overall risk difference ignoring stratification.\n\n3. Define the \"Simpson reversal magnitude\" for this dataset as the absolute difference between the pooled overall risk difference and the simple average of the two stratum-specific risk differences. Compute this magnitude.\n\n4. In a short argument within your solution, articulate the causal conditions that can generate a reversal in sign between stratum-specific and pooled contrasts in observational data, grounding your explanation in the historical motivations for the statistical turn in EBM. You may invoke core definitions from probability and causal reasoning (e.g., confounding by indication) but do not assume randomized assignment.\n\nExpress the final numerical result for the Simpson reversal magnitude in decimal form and round your answer to four significant figures. Do not include units in the final result.", "solution": "The problem statement is a valid exercise in elementary probability, statistics, and causal reasoning, presenting a classic case of Simpson's paradox. It is scientifically grounded, well-posed, and objective. All data and definitions required for the solution are provided. We may proceed with the solution.\n\nThe problem asks for a four-part analysis of observational data from a hypothetical clinical study. We will address each part in sequence, using the provided definitions.\n\nLet $S=1$ denote survival and $S=0$ denote non-survival. Let $T=1$ for treated patients and $T=0$ for untreated patients. Let $Z=\\text{mild}$ for the mild stratum and $Z=\\text{severe}$ for the severe stratum. The risk of survival is the conditional probability $P(S=1 | T=t, Z=z)$ for a given treatment status $t$ and stratum $z$.\n\n**Part 1: Stratum-Specific Risks and Risk Differences**\n\nFirst, we analyze the \"mild\" stratum ($Z=\\text{mild}$).\nThe number of treated patients is $n_{T, \\text{mild}} = 20$, with $19$ survivors.\nThe number of untreated patients is $n_{UT, \\text{mild}} = 200$, with $180$ survivors.\n\nThe risk for the treated group in the mild stratum is:\n$$r_{T, \\text{mild}} = P(S=1 | T=1, Z=\\text{mild}) = \\frac{19}{20} = 0.95$$\nThe risk for the untreated group in the mild stratum is:\n$$r_{UT, \\text{mild}} = P(S=1 | T=0, Z=\\text{mild}) = \\frac{180}{200} = 0.90$$\nThe stratum-specific risk difference for the mild stratum, $RD_{\\text{mild}}$, is:\n$$RD_{\\text{mild}} = r_{T, \\text{mild}} - r_{UT, \\text{mild}} = 0.95 - 0.90 = 0.05$$\nSince $RD_{\\text{mild}} > 0$, the treatment appears beneficial within the mild stratum.\n\nNext, we analyze the \"severe\" stratum ($Z=\\text{severe}$).\nThe number of treated patients is $n_{T, \\text{severe}} = 20$, with $2$ survivors.\nThe number of untreated patients is $n_{UT, \\text{severe}} = 20$, with $1$ survivor.\n\nThe risk for the treated group in the severe stratum is:\n$$r_{T, \\text{severe}} = P(S=1 | T=1, Z=\\text{severe}) = \\frac{2}{20} = 0.10$$\nThe risk for the untreated group in the severe stratum is:\n$$r_{UT, \\text{severe}} = P(S=1 | T=0, Z=\\text{severe}) = \\frac{1}{20} = 0.05$$\nThe stratum-specific risk difference for the severe stratum, $RD_{\\text{severe}}$, is:\n$$RD_{\\text{severe}} = r_{T, \\text{severe}} - r_{UT, \\text{severe}} = 0.10 - 0.05 = 0.05$$\nSince $RD_{\\text{severe}} > 0$, the treatment also appears beneficial within the severe stratum. In both strata, the treatment is associated with a 5 percentage point increase in survival probability.\n\n**Part 2: Pooled Overall Risks and Risk Difference**\n\nTo compute the pooled (overall) risks, we aggregate the data across both strata, ignoring the severity variable.\n\nTotal number of treated patients:\n$$N_T = n_{T, \\text{mild}} + n_{T, \\text{severe}} = 20 + 20 = 40$$\nTotal number of survivors among treated patients:\n$$S_T = 19 + 2 = 21$$\nTotal number of untreated patients:\n$$N_{UT} = n_{UT, \\text{mild}} + n_{UT, \\text{severe}} = 200 + 20 = 220$$\nTotal number of survivors among untreated patients:\n$$S_{UT} = 180 + 1 = 181$$\n\nThe pooled risk for the treated group is:\n$$r_{T, \\text{pooled}} = \\frac{S_T}{N_T} = \\frac{21}{40} = 0.525$$\nThe pooled risk for the untreated group is:\n$$r_{UT, \\text{pooled}} = \\frac{S_{UT}}{N_{UT}} = \\frac{181}{220}$$\nThe pooled overall risk difference, $RD_{\\text{pooled}}$, is:\n$$RD_{\\text{pooled}} = r_{T, \\text{pooled}} - r_{UT, \\text{pooled}} = \\frac{21}{40} - \\frac{181}{220}$$\nTo subtract these fractions, we find a common denominator, which is $440$.\n$$RD_{\\text{pooled}} = \\frac{21 \\times 11}{40 \\times 11} - \\frac{181 \\times 2}{220 \\times 2} = \\frac{231}{440} - \\frac{362}{440} = \\frac{231 - 362}{440} = -\\frac{131}{440}$$\nIn decimal form, this is approximately $-0.2977$. Here, the sign is reversed: the pooled analysis suggests the treatment is harmful. This is a classic demonstration of Simpson's Paradox.\n\n**Part 3: Simpson Reversal Magnitude**\n\nThe problem defines the Simpson reversal magnitude, $M$, as the absolute difference between the pooled overall risk difference and the simple average of the two stratum-specific risk differences.\nFirst, we find the average of the stratum-specific risk differences:\n$$\\text{Average}(RD_{\\text{stratum}}) = \\frac{RD_{\\text{mild}} + RD_{\\text{severe}}}{2} = \\frac{0.05 + 0.05}{2} = 0.05$$\nNow, we compute the magnitude $M$:\n$$M = |RD_{\\text{pooled}} - \\text{Average}(RD_{\\text{stratum}})| = \\left|-\\frac{131}{440} - 0.05\\right|$$\nConverting $0.05$ to a fraction, $0.05 = \\frac{5}{100} = \\frac{1}{20}$.\n$$M = \\left|-\\frac{131}{440} - \\frac{1}{20}\\right| = \\left|-\\frac{131}{440} - \\frac{22}{440}\\right| = \\left|-\\frac{131 + 22}{440}\\right| = \\left|-\\frac{153}{440}\\right|$$\n$$M = \\frac{153}{440} \\approx 0.34772727...$$\nRounding to four significant figures, the Simpson reversal magnitude is $0.3477$.\n\n**Part 4: Causal Conditions for a Reversal (Simpson's Paradox)**\n\nA reversal in sign between stratum-specific and pooled contrasts, known as Simpson's Paradox, arises in observational data due to **confounding**. A confounder is a third variable that is associated with both the exposure (treatment) and the outcome (survival), creating a spurious association between them. In this dataset, the **baseline severity** of the disease is the confounder.\n\nFor a variable $Z$ (severity) to be a confounder of the effect of $X$ (treatment) on $Y$ (survival), two conditions must be met in the data:\n1.  $Z$ must be associated with the exposure $X$. In this study, we must check if the proportion of treated patients differs between severity strata.\n    -   Proportion of patients treated in the mild stratum: $\\frac{20}{20+200} = \\frac{20}{220} \\approx 0.091$ or $9.1\\%$.\n    -   Proportion of patients treated in the severe stratum: $\\frac{20}{20+20} = \\frac{20}{40} = 0.50$ or $50\\%$.\n    There is a strong association: severe patients are far more likely to receive the treatment. This is often termed \"confounding by indication,\" where the clinical reason for giving a treatment (severe illness) is itself a strong predictor of the outcome.\n2.  $Z$ must be a cause of the outcome $Y$, independent of the exposure $X$. We check if severity is associated with survival, for instance, in the untreated group.\n    -   Survival risk in untreated mild patients: $r_{UT, \\text{mild}} = 0.90$.\n    -   Survival risk in untreated severe patients: $r_{UT, \\text{severe}} = 0.05$.\n    The association is extremely strong: severely ill patients have a much lower intrinsic probability of survival.\n\nThe paradox arises because the pooled analysis \"crude\" comparison is not a fair one. The pooled \"treated\" group is composed of $50\\%$ severe patients ($20/40$) and $50\\%$ mild patients ($20/40$). The pooled \"untreated\" group is overwhelmingly composed of mild patients ($200/220 \\approx 91\\%$) and only a few severe patients ($20/220 \\approx 9\\%$). Therefore, the pooled analysis is effectively comparing a high-risk group (the treated) to a low-risk group (the untreated). The apparent harmful effect of the treatment in the pooled data is not due to the treatment itself but is caused by the fact that the treatment was preferentially given to sicker patients who were destined for poor outcomes regardless.\n\nThe historical motivation for the \"statistical turn\" in Evidence-Based Medicine (EBM) was precisely to address such failures of naive observational analysis. The realization that confounding by indication could lead to completely wrong conclusions (e.g., a beneficial drug appearing harmful) drove the development and adoption of the **Randomized Controlled Trial (RCT)**. In an RCT, treatment is assigned randomly. This procedure, by its very design, breaks the association between the confounder ($Z$) and the exposure ($X$), ensuring that, on average, the treated and untreated groups have the same distribution of patient severities. This allows for an unbiased estimation of the causal effect of the treatment. The paradox in this problem illustrates why stratifying on confounders or, more robustly, randomizing treatment became a cornerstone of modern clinical evidence.", "answer": "$$\n\\boxed{0.3477}\n$$", "id": "4744898"}, {"introduction": "The Randomized Controlled Trial (RCT) emerged as the primary tool to overcome the confounding seen in observational studies. By randomly assigning treatment, an RCT creates groups that are comparable, allowing for a fair assessment of a therapy's effect. In this exercise [@problem_id:4745026], you will analyze data from a hypothetical RCT to calculate two of the most fundamental measures of causal effect—the risk difference and the risk ratio—and understand their direct interpretation as the result of the intervention.", "problem": "A pivotal feature of the twentieth-century “statistical turn” in the history of medicine was the rise of randomized experiments that enabled causal claims about therapies under minimal assumptions. Consider an early Randomized Controlled Trial (RCT) investigating a new therapy for a serious infectious disease. Patients were randomly assigned to receive either the therapy or usual care at a $1\\!:\\!1$ allocation ratio, with no loss to follow-up. Let $Z$ denote treatment assignment, with $Z=1$ for therapy and $Z=0$ for usual care, and let $Y$ denote the binary outcome of $30$-day mortality, where $Y=1$ indicates death within $30$ days and $Y=0$ indicates survival.\n\nIn the therapy arm, $20$ of $100$ patients experienced $Y=1$. In the usual care arm, $35$ of $100$ patients experienced $Y=1$. Using only foundational definitions—namely, that the risk in a group is the probability of the outcome in that group, estimable by the observed proportion—and the fact that randomization makes the distribution of potential outcomes independent of assignment in expectation, do the following:\n\n1. Compute the risk difference between therapy and usual care, defined as the difference in risks.\n2. Compute the risk ratio between therapy and usual care, defined as the ratio of risks.\n3. Provide a brief causal interpretation consistent with the logic of randomization and the Stable Unit Treatment Value Assumption (SUTVA), stating what these estimates mean about the effect of therapy on $30$-day mortality under random assignment.\n\nExpress the numerical answers for the risk difference and risk ratio as exact fractions or decimals. If you choose decimals, round to four significant figures. Do not use a percentage sign; express proportions as decimals or fractions.", "solution": "The problem statement is a well-posed exercise in the analysis of data from a Randomized Controlled Trial (RCT), a foundational topic in biostatistics and epidemiology. It is scientifically grounded, self-contained, and objective. All necessary data and definitions are provided, and there are no internal contradictions or ambiguities. The problem is therefore deemed valid and a formal solution can be constructed.\n\nThe problem requires the computation of two \"effect measures\"—the risk difference and the risk ratio—and a causal interpretation of these estimates. We will proceed by first defining the relevant quantities and then computing the estimates from the provided data.\n\nLet $Z$ be the random variable for treatment assignment, where $Z=1$ indicates assignment to the therapy arm and $Z=0$ indicates assignment to the usual care arm. Let $Y$ be the binary outcome, where $Y=1$ denotes death within $30$ days and $Y=0$ denotes survival.\n\nThe data provided are:\n-   In the therapy arm ($Z=1$): $n_1 = 100$ patients, of whom $y_1 = 20$ experienced the outcome $Y=1$.\n-   In the usual care arm ($Z=0$): $n_0 = 100$ patients, of whom $y_0 = 35$ experienced the outcome $Y=1$.\n\nThe problem defines the risk in a group as the probability of the outcome in that group, which is estimated by the observed proportion.\n\nThe risk in the therapy arm, $R_1$, is estimated by $\\hat{R}_1$:\n$$ \\hat{R}_1 = P(Y=1|Z=1) = \\frac{y_1}{n_1} = \\frac{20}{100} = 0.20 $$\nThe risk in the usual care arm, $R_0$, is estimated by $\\hat{R}_0$:\n$$ \\hat{R}_0 = P(Y=1|Z=0) = \\frac{y_0}{n_0} = \\frac{35}{100} = 0.35 $$\n\nWith these estimated risks, we can address the three parts of the problem.\n\n1.  **Compute the risk difference (RD).**\nThe risk difference is defined as the difference in risks, $RD = R_1 - R_0$. Its estimate, $\\widehat{RD}$, is calculated as:\n$$ \\widehat{RD} = \\hat{R}_1 - \\hat{R}_0 = 0.20 - 0.35 = -0.15 $$\nThis value is an exact decimal.\n\n2.  **Compute the risk ratio (RR).**\nThe risk ratio is defined as the ratio of risks, $RR = R_1 / R_0$. Its estimate, $\\widehat{RR}$, is calculated as:\n$$ \\widehat{RR} = \\frac{\\hat{R}_1}{\\hat{R}_0} = \\frac{0.20}{0.35} = \\frac{20}{35} = \\frac{4}{7} $$\nThis value is an exact fraction. As a decimal rounded to four significant figures, it is approximately $0.5714$. The exact fractional form is preferred for precision.\n\n3.  **Provide a brief causal interpretation.**\nThe power of an RCT lies in its ability to yield estimates that have a causal interpretation. This relies on the potential outcomes framework, where each patient $i$ has a potential outcome under therapy, $Y_i(1)$, and a potential outcome under usual care, $Y_i(0)$. The causal effect for patient $i$ is the difference $Y_i(1) - Y_i(0)$, which is fundamentally unobservable. We instead estimate the Average Causal Effect (ACE), $E[Y(1) - Y(0)]$.\n\nRandomization ensures that, in expectation, the two groups are comparable with respect to all baseline characteristics, both measured and unmeasured. Formally, it makes the treatment assignment $Z$ independent of the potential outcomes $\\{Y(1), Y(0)\\}$. This implies $E[Y(1)|Z=1] = E[Y(1)]$ and $E[Y(0)|Z=0] = E[Y(0)]$.\n\nThe Stable Unit Treatment Value Assumption (SUTVA) posits that (a) there is no interference between patients and (b) there is only one version of the treatment and control. SUTVA allows us to equate the observed outcomes to the potential outcomes for each arm: for patients with $Z=1$, their observed outcome is $Y=Y(1)$, and for patients with $Z=0$, their observed outcome is $Y=Y(0)$.\n\nBecause of randomization and SUTVA, the expected value of the outcome in the therapy arm is the average potential outcome under therapy, $E[Y|Z=1] = E[Y(1)|Z=1] = E[Y(1)]$. Similarly, $E[Y|Z=0] = E[Y(0)|Z=0] = E[Y(0)]$. The risks $R_1$ and $R_0$ are these expected values, $R_1=E[Y(1)]$ and $R_0=E[Y(0)]$.\n\nTherefore, our statistical estimates are unbiased estimates of causal parameters:\n-   The risk difference estimate, $\\widehat{RD} = -0.15$, is an estimate of the Average Causal Effect: $ACE = E[Y(1)] - E[Y(0)]$.\n-   The risk ratio estimate, $\\widehat{RR} = 4/7$, is an estimate of the causal risk ratio: $E[Y(1)] / E[Y(0)]$.\n\n**Causal Interpretation:**\nBased on this randomized experiment, we can infer the causal effect of the therapy.\n-   The risk difference of $-0.15$ implies that, on average, receiving the therapy caused an absolute reduction in the $30$-day mortality risk by $0.15$, or $15$ percentage points, compared to receiving usual care.\n-   The risk ratio of $4/7$ (approximately $0.5714$) implies that the therapy caused the risk of $30$-day mortality to be just over half of what it would have been under usual care. This corresponds to a relative risk reduction of $1 - 4/7 = 3/7$, or approximately $42.9\\%$.\n\nIn summary, the estimates derived from this RCT suggest that the new therapy has a substantial protective causal effect on $30$-day mortality.", "answer": "$$\\boxed{\\begin{pmatrix} -0.15 & \\frac{4}{7} \\end{pmatrix}}$$", "id": "4745026"}, {"introduction": "The statistical turn also revolutionized clinical diagnosis, shifting it from a practice based on intuition to one grounded in probabilistic reasoning. Bayes' theorem provides the mathematical engine for formally updating our beliefs in light of new evidence. This practice [@problem_id:4744954] places you in the role of a clinician using a diagnostic test's known properties (sensitivity and specificity) to calculate the precise probability that a patient has a disease after a positive test result.", "problem": "In the historical development of Evidence-Based Medicine (EBM), the statistical turn emphasized formal probabilistic reasoning about diagnostic tests. Consider a test for a condition where clinicians historically reported its operating characteristics as sensitivity and specificity, and used likelihood ratios to update diagnostic beliefs. Starting from the core definitions of sensitivity, specificity, pretest probability, and the positive likelihood ratio, and using Bayes’ theorem framed in odds, compute the posterior probability of disease after a positive test.\n\nAssume the following empirically observed quantities for a single diagnostic test application in a clinical population: pretest probability $0.20$, sensitivity $0.90$, and specificity $0.80$. For a positive test result, the positive likelihood ratio is defined as $LR^{+} = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}$.\n\nUsing only these definitions and Bayes’ theorem to connect probabilities and odds, determine the posterior probability of disease after a single positive test result. Express your final answer as an exact fraction. Do not use a percentage sign.", "solution": "The problem is valid as it is scientifically grounded in the principles of biostatistics and evidence-based medicine, is well-posed with sufficient and consistent information, and is expressed in objective, formal language. We can therefore proceed with the solution.\n\nLet $D$ be the event that a patient has the disease, and let $D^c$ be the event that the patient does not have the disease. Let $T^+$ be the event of a positive test result. The problem requires us to compute the posterior probability of disease given a positive test, which is denoted as $P(D|T^+)$.\n\nThe given information is:\n1.  The pretest probability of disease, $P(D) = 0.20$.\n2.  The sensitivity of the test, which is the probability of a positive test given the patient has the disease, $P(T^+|D) = 0.90$.\n3.  The specificity of the test, which is the probability of a negative test given the patient does not have the disease, $P(T^-|D^c) = 0.80$.\n\nThe solution will be derived using Bayes' theorem in its odds form. The odds of an event $E$ are defined as the ratio of the probability of the event to the probability of its complement, $O(E) = \\frac{P(E)}{1-P(E)}$.\n\nFirst, we define the pretest odds and posterior odds of the disease.\nThe pretest odds, $O_{\\text{pre}}$, are the odds of having the disease before the test result is known:\n$$ O_{\\text{pre}} = \\frac{P(D)}{1-P(D)} = \\frac{P(D)}{P(D^c)} $$\nThe posterior odds, $O_{\\text{post}}$, are the odds of having the disease after a positive test result is observed:\n$$ O_{\\text{post}} = \\frac{P(D|T^+)}{1-P(D|T^+)} = \\frac{P(D|T^+)}{P(D^c|T^+)} $$\n\nThe odds form of Bayes' theorem relates the posterior odds to the pretest odds via the likelihood ratio (LR). For a positive test result, the equation is:\n$$ O_{\\text{post}} = LR^+ \\times O_{\\text{pre}} $$\nwhere $LR^+$ is the positive likelihood ratio. The $LR^+$ is the ratio of the probability of a positive test in a diseased patient to the probability of a positive test in a non-diseased patient:\n$$ LR^+ = \\frac{P(T^+|D)}{P(T^+|D^c)} $$\nThe numerator, $P(T^+|D)$, is the sensitivity. The denominator, $P(T^+|D^c)$, is the false positive rate. Since a patient without the disease ($D^c$) can only test positive ($T^+$) or negative ($T^-$), we have $P(T^+|D^c) + P(T^-|D^c) = 1$. Therefore, the false positive rate is $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - \\text{specificity}$.\nThis confirms the definition provided in the problem statement: $LR^{+} = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}$.\n\nNow, we calculate the necessary quantities using the given values. It is best to work with exact fractions.\nThe pretest probability is $P(D) = 0.20 = \\frac{20}{100} = \\frac{1}{5}$.\nThe probability of not having the disease is $P(D^c) = 1 - P(D) = 1 - \\frac{1}{5} = \\frac{4}{5}$.\nThe pretest odds are:\n$$ O_{\\text{pre}} = \\frac{P(D)}{P(D^c)} = \\frac{1/5}{4/5} = \\frac{1}{4} $$\nThe sensitivity is $P(T^+|D) = 0.90 = \\frac{9}{10}$.\nThe specificity is $P(T^-|D^c) = 0.80 = \\frac{8}{10} = \\frac{4}{5}$.\nThe positive likelihood ratio is:\n$$ LR^+ = \\frac{\\text{sensitivity}}{1 - \\text{specificity}} = \\frac{P(T^+|D)}{1 - P(T^-|D^c)} = \\frac{9/10}{1 - 4/5} = \\frac{9/10}{1/5} = \\frac{9}{10} \\times \\frac{5}{1} = \\frac{45}{10} = \\frac{9}{2} $$\nNow, we can calculate the posterior odds using the odds form of Bayes' theorem:\n$$ O_{\\text{post}} = LR^+ \\times O_{\\text{pre}} = \\frac{9}{2} \\times \\frac{1}{4} = \\frac{9}{8} $$\nThe final step is to convert the posterior odds back to a probability. If $O = \\frac{p}{1-p}$, we can solve for $p$:\n$O(1-p) = p \\implies O - O p = p \\implies O = p(1+O) \\implies p = \\frac{O}{1+O}$.\nApplying this formula to the posterior odds gives the posterior probability, $P(D|T^+)$:\n$$ P(D|T^+) = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}} = \\frac{9/8}{1 + 9/8} = \\frac{9/8}{8/8 + 9/8} = \\frac{9/8}{17/8} = \\frac{9}{17} $$\nThus, the posterior probability of disease after a single positive test result is $\\frac{9}{17}$.", "answer": "$$ \\boxed{\\frac{9}{17}} $$", "id": "4744954"}]}