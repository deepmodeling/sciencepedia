{"hands_on_practices": [{"introduction": "To understand how drugs are handled by the kidney, we must first be able to quantify the process. This foundational exercise grounds the abstract concept of renal clearance ($CL_{r}$) in measurable, real-world data such as urine flow and drug concentrations. By working through this calculation, you will practice applying the core definition of clearance and develop a critical eye for dimensional analysis, an essential skill for ensuring accuracy in all pharmacokinetic calculations [@problem_id:4940917].", "problem": "A single intravenous dose of a drug is administered to a healthy volunteer, and after a distribution phase, a steady state between plasma and urine formation is assumed during a timed urine collection. The measured quantities are urine flow rate $V$, urine drug concentration $C_{u}$, and plasma drug concentration $C_{p}$. Renal clearance $CL_{r}$ is defined conceptually as the hypothetical volume of plasma from which the drug is completely removed per unit time by the kidneys. Using the fundamental definition that clearance equals the rate of drug excretion divided by the plasma drug concentration, and that the rate of drug excretion equals the product of urine drug concentration and urine flow rate, compute the renal clearance $CL_{r}$ from the following measurements: $V = 2\\,\\text{mL/min}$, $C_{u} = 5\\,\\text{mg/mL}$, and $C_{p} = 10\\,\\text{mg/L}$. Evaluate whether the given units yield a dimensionally consistent clearance unit through explicit dimensional analysis. Express $CL_{r}$ in $\\text{L/min}$ and round your final numerical result to three significant figures.", "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded in the fundamental principles of pharmacokinetics, specifically renal excretion. The provided definitions for renal clearance and the rate of excretion are standard in the field. All necessary data ($V$, $C_u$, $C_p$) are supplied, and the problem is well-posed, objective, and free from contradictions or physically implausible values.\n\nThe problem requires the calculation of renal clearance, $CL_{r}$, based on provided definitions and measurements. The definitions are:\n1.  The rate of drug excretion, which we denote as $R_{ex}$, is the product of urine drug concentration, $C_{u}$, and urine flow rate, $V$.\n    $$R_{ex} = C_{u} \\times V$$\n2.  Renal clearance, $CL_{r}$, is the rate of drug excretion divided by the plasma drug concentration, $C_{p}$.\n    $$CL_{r} = \\frac{R_{ex}}{C_{p}}$$\n\nBy substituting the first equation into the second, we obtain a single expression for renal clearance in terms of the measured quantities:\n$$CL_{r} = \\frac{C_{u} \\times V}{C_{p}}$$\n\nThe problem explicitly asks for a dimensional analysis to confirm consistency. The given units are:\n-   Urine flow rate, $V$: $\\frac{\\text{mL}}{\\text{min}}$ (dimensionally $\\frac{[\\text{Volume}]}{[\\text{Time}]}$)\n-   Urine drug concentration, $C_{u}$: $\\frac{\\text{mg}}{\\text{mL}}$ (dimensionally $\\frac{[\\text{Mass}]}{[\\text{Volume}]}$)\n-   Plasma drug concentration, $C_{p}$: $\\frac{\\text{mg}}{\\text{L}}$ (dimensionally $\\frac{[\\text{Mass}]}{[\\text{Volume}]}$)\n\nFirst, let's determine the units of the rate of excretion, $R_{ex}$:\n$$ \\text{Units of } R_{ex} = [\\text{Units of } C_{u}] \\times [\\text{Units of } V] = \\left(\\frac{\\text{mg}}{\\text{mL}}\\right) \\times \\left(\\frac{\\text{mL}}{\\text{min}}\\right) = \\frac{\\text{mg}}{\\text{min}} $$\nThis result, a mass per unit time, correctly represents a rate of excretion.\n\nNext, we determine the units of renal clearance, $CL_{r}$:\n$$ \\text{Units of } CL_{r} = \\frac{[\\text{Units of } R_{ex}]}{[\\text{Units of } C_{p}]} = \\frac{\\frac{\\text{mg}}{\\text{min}}}{\\frac{\\text{mg}}{\\text{L}}} = \\frac{\\text{mg}}{\\text{min}} \\times \\frac{\\text{L}}{\\text{mg}} = \\frac{\\text{L}}{\\text{min}} $$\nThe resulting units are volume per time ($\\text{L/min}$), which is consistent with the conceptual definition of clearance as a volume of plasma cleared of a substance per unit time. The dimensional analysis confirms the given quantities and definitions yield a consistent and correct unit for clearance.\n\nNow, we can proceed with the numerical calculation. The given values are:\n-   $V = 2\\,\\text{mL/min}$\n-   $C_{u} = 5\\,\\text{mg/mL}$\n-   $C_{p} = 10\\,\\text{mg/L}$\n\nTo use the formula $CL_{r} = \\frac{C_{u} V}{C_{p}}$, the units must be consistent. The volume units in $C_{u}$ and $V$ are milliliters (mL), while the volume unit in $C_{p}$ is liters (L). We must convert them to a common volume unit. Let us convert all volume measurements to milliliters (mL).\nThe conversion between liters and milliliters is $1\\,\\text{L} = 1000\\,\\text{mL}$.\nWe convert $C_{p}$ to $\\text{mg/mL}$:\n$$ C_{p} = 10\\,\\frac{\\text{mg}}{\\text{L}} \\times \\frac{1\\,\\text{L}}{1000\\,\\text{mL}} = 0.01\\,\\frac{\\text{mg}}{\\text{mL}} $$\n\nNow, substitute the values with consistent units into the equation for $CL_{r}$:\n$$ CL_{r} = \\frac{\\left(5\\,\\frac{\\text{mg}}{\\text{mL}}\\right) \\times \\left(2\\,\\frac{\\text{mL}}{\\text{min}}\\right)}{0.01\\,\\frac{\\text{mg}}{\\text{mL}}} $$\n\nFirst, calculate the numerator (the rate of excretion, $R_{ex}$):\n$$ R_{ex} = 5\\,\\frac{\\text{mg}}{\\text{mL}} \\times 2\\,\\frac{\\text{mL}}{\\text{min}} = 10\\,\\frac{\\text{mg}}{\\text{min}} $$\n\nNow, divide by the converted plasma concentration:\n$$ CL_{r} = \\frac{10\\,\\frac{\\text{mg}}{\\text{min}}}{0.01\\,\\frac{\\text{mg}}{\\text{mL}}} $$\n$$ CL_{r} = \\frac{10}{0.01} \\left( \\frac{\\text{mg}}{\\text{min}} \\times \\frac{\\text{mL}}{\\text{mg}} \\right) = 1000\\,\\frac{\\text{mL}}{\\text{min}} $$\n\nThe problem asks for the final answer to be expressed in liters per minute ($\\text{L/min}$). We convert our result:\n$$ CL_{r} = 1000\\,\\frac{\\text{mL}}{\\text{min}} \\times \\frac{1\\,\\text{L}}{1000\\,\\text{mL}} = 1\\,\\frac{\\text{L}}{\\text{min}} $$\n\nFinally, the problem requires the numerical result to be rounded to three significant figures. The exact value is $1$. To express this with three significant figures, we write it as $1.00$.\n$$ CL_{r} = 1.00\\,\\text{L/min} $$", "answer": "$$\n\\boxed{1.00}\n$$", "id": "4940917"}, {"introduction": "The net renal clearance of a drug is determined by a balance of filtration, secretion, and reabsorption. This problem focuses on passive reabsorption, a process highly dependent on the drug's ionization state, which is governed by the local $pH$. You will apply the Henderson-Hasselbalch principle to understand \"ion trapping,\" a clinically vital concept that explains how modifying urine $pH$ can dramatically alter a drug's elimination rate [@problem_id:4940885].", "problem": "A weak monoprotic acid drug undergoes renal handling in which glomerular filtration delivers the drug to the tubular lumen and passive reabsorption across the tubular epithelium occurs predominantly for the unionized species. Consider a scenario where the urine has a potential of hydrogen ($pH$) of $7.5$ and the drug has a negative base-10 logarithm of the acid dissociation constant ($pK_a$) of $3.0$. Assume the tubular epithelium is highly permeable to the unionized species and negligibly permeable to the ionized species, and that there is no active secretion or reabsorption, no protein binding in the filtrate, and steady-state luminal $pH$.\n\nStarting from the acid dissociation equilibrium for a weak acid and the definition of the acid dissociation constant, derive a general expression for the fraction of the drug that is unionized in a solution of given $pH$ in terms of $pH$ and $pK_a$. Then, using the given values, compute the numerical value of the unionized fraction in the urine. Based on your derivation and computation, reason about the expected direction and magnitude of passive reabsorption from urine to blood under these conditions.\n\nExpress the final numerical value for the fraction of unionized drug as a decimal in scientific notation, rounded to four significant figures.", "solution": "The problem is valid as it is scientifically grounded in the principles of acid-base chemistry and renal physiology, is well-posed with sufficient information for a unique solution, and is stated objectively.\n\nThe first step is to derive a general expression for the fraction of a weak monoprotic acid drug that is in its unionized form. Let the weak acid be represented as $HA$. In an aqueous solution, it establishes an equilibrium with its ionized form, the conjugate base $A^-$, and a proton $H^+$:\n$$HA \\rightleftharpoons H^+ + A^-$$\nThe acid dissociation constant, $K_a$, for this equilibrium is defined as:\n$$K_a = \\frac{[H^+][A^-]}{[HA]}$$\nwhere $[H^+]$, $[A^-]$, and $[HA]$ represent the molar concentrations of the proton, the ionized drug, and the unionized drug, respectively.\n\nThe definitions of $pH$ and $pK_a$ are given by:\n$$pH = -\\log_{10}([H^+])$$\n$$pK_a = -\\log_{10}(K_a)$$\nFrom these definitions, we can write $[H^+] = 10^{-pH}$ and $K_a = 10^{-pK_a}$.\n\nThe total concentration of the drug, $[D_{total}]$, is the sum of the concentrations of the unionized and ionized forms:\n$$[D_{total}] = [HA] + [A^-]$$\nThe fraction of the drug that is unionized, which we will denote as $f_{unionized}$, is the ratio of the unionized drug concentration to the total drug concentration:\n$$f_{unionized} = \\frac{[HA]}{[D_{total}]} = \\frac{[HA]}{[HA] + [A^-]}$$\nTo express this fraction in terms of $pH$ and $pK_a$, we first rearrange the $K_a$ expression to solve for $[A^-]$:\n$$[A^-] = K_a \\frac{[HA]}{[H^+]}$$\nSubstitute this expression for $[A^-]$ into the denominator of the equation for $f_{unionized}$:\n$$f_{unionized} = \\frac{[HA]}{[HA] + K_a \\frac{[HA]}{[H^+]}}$$\nFactoring out $[HA]$ from the denominator yields:\n$$f_{unionized} = \\frac{[HA]}{[HA] \\left(1 + \\frac{K_a}{[H^+]}\\right)}$$\nCanceling the $[HA]$ term, we get:\n$$f_{unionized} = \\frac{1}{1 + \\frac{K_a}{[H^+]}}$$\nNow, we substitute the expressions for $K_a$ and $[H^+]$ in terms of $pK_a$ and $pH$:\n$$\\frac{K_a}{[H^+]} = \\frac{10^{-pK_a}}{10^{-pH}} = 10^{pH - pK_a}$$\nSubstituting this back into the expression for $f_{unionized}$ gives the desired general expression:\n$$f_{unionized} = \\frac{1}{1 + 10^{pH - pK_a}}$$\nThis equation is a form of the Henderson-Hasselbalch equation, rearranged to solve for the fraction of the protonated (unionized) species of a weak acid.\n\nNext, we compute the numerical value of the unionized fraction in the urine using the given values: $pH = 7.5$ and $pK_a = 3.0$.\n$$f_{unionized} = \\frac{1}{1 + 10^{7.5 - 3.0}} = \\frac{1}{1 + 10^{4.5}}$$\nCalculating the value:\n$$10^{4.5} = 10^{4} \\times 10^{0.5} \\approx 10000 \\times 3.162277... \\approx 31622.77$$\n$$f_{unionized} = \\frac{1}{1 + 31622.77} = \\frac{1}{31623.77} \\approx 0.0000316216$$\nRounding to four significant figures and expressing in scientific notation, the unionized fraction is $3.162 \\times 10^{-5}$.\n\nFinally, we reason about the expected direction and magnitude of passive reabsorption. Passive reabsorption of drugs from the renal tubules back into the blood is driven by the concentration gradient of the lipid-soluble (permeable) species across the tubular epithelium. The problem states that only the unionized form ($HA$) is permeable.\nThe direction of transport is from the tubular lumen (urine) to the peritubular capillaries (blood). The magnitude of this transport depends on the concentration of the permeable species, $[HA]$.\n\nOur calculation shows that the fraction of the drug in the unionized form in the urine (at $pH = 7.5$) is extremely small, $f_{unionized} \\approx 3.162 \\times 10^{-5}$. This means that over $99.99\\%$ of the drug in the urine is in the ionized, non-reabsorbable form ($A^-$). This occurs because the environmental $pH$ ($7.5$) is significantly higher than the drug's $pK_a$ ($3.0$), causing the weak acid to dissociate almost completely.\n\nThis phenomenon is known as \"ion trapping.\" Because the vast majority of the drug in the tubular fluid is in the ionized form, it cannot cross the tubular epithelium and is trapped within the lumen. Consequently, the concentration gradient for the permeable species ($HA$) is very low, severely limiting the rate and extent of passive reabsorption. The drug will therefore be efficiently excreted in the urine. The direction of reabsorption is from urine to blood, but its magnitude is expected to be very low. Urine alkalinization (as seen here, with a $pH$ of $7.5$) is a clinical strategy used to enhance the renal elimination of acidic drugs.", "answer": "$$\\boxed{3.162 \\times 10^{-5}}$$", "id": "4940885"}, {"introduction": "In clinical practice, disease states like Chronic Kidney Disease (CKD) impact all aspects of renal drug handling simultaneously. This advanced practice challenges you to integrate the concepts of glomerular filtration, active secretion, and passive reabsorption into a single, comprehensive model. By building and using this model to simulate the effects of CKD, you will gain a powerful, systems-level understanding of why disease necessitates careful drug dose adjustments [@problem_id:4940895].", "problem": "You are asked to build a mechanistic simulation of renal drug excretion that captures the combined effects of Chronic Kidney Disease (CKD) on Glomerular Filtration Rate (GFR), transporter abundances, and urine pH, and to compute the renal clearance and the fraction of total clearance that is renal. The goal is to design from first principles a program that computes, for each test case, the renal clearance and the renal fraction excreted for a drug under specified physiological and biochemical conditions.\n\nStart from the following core definitions and well-tested relationships.\n\n1. Mass balance at the kidney level for a drug eliminated unchanged in urine states that the net urinary excretion rate equals the sum of filtration input rate and active secretion input rate minus the tubular reabsorption rate. Let the plasma total concentration be $C_p$ and the unbound plasma fraction be $f_u$ so that the unbound plasma concentration is $C_{p,u} = f_u\\,C_p$. The glomerular filtration input rate is $GFR \\cdot C_{p,u}$. Under low substrate concentration conditions relative to transporter capacity (linear regime), the active secretion input rate can be modeled as $A \\cdot CL_{\\mathrm{int,sec}} \\cdot C_{p,u}$, where $A$ is a dimensionless transporter abundance factor and $CL_{\\mathrm{int,sec}}$ is an intrinsic secretion clearance in $\\mathrm{mL/min}$. Passive tubular reabsorption depends on the unionized fraction in urine and the tubular luminal drug concentration. Let $CL_{\\mathrm{int,reabs}}$ be an intrinsic reabsorption clearance in $\\mathrm{mL/min}$, assume negligible urine protein binding so the unbound fraction in urine is approximately $1$, and let $f_U$ be the fraction unionized in urine. Then the reabsorption rate is $CL_{\\mathrm{int,reabs}} \\cdot f_U \\cdot C_u$, where $C_u$ is the total luminal concentration. Conservation at steady state in the tubule implies $UFR \\cdot C_u = \\text{Filtration input} + \\text{Secretion input} - \\text{Reabsorption}$, where $UFR$ is the Urine Flow Rate (UFR) in $\\mathrm{mL/min}$.\n\n2. The unionized fraction in urine for a monoprotic weak acid or base is given by the Hendersonâ€“Hasselbalch relationships. For a weak acid with acid dissociation constant $pK_a$, $f_U = \\dfrac{1}{1 + 10^{(pH - pK_a)}}$. For a weak base, $f_U = \\dfrac{1}{1 + 10^{(pK_a - pH)}}$. Here $pH$ is the urine pH.\n\n3. Define the renal clearance $CL_r$ as the ratio of the net urinary excretion rate to the plasma total concentration, both at steady state. Define the renal fraction excreted $f_e$ as the fraction of total clearance that is renal under linear conditions, namely $f_e = \\dfrac{CL_r}{CL_r + CL_{\\mathrm{nr}}}$, where $CL_{\\mathrm{nr}}$ is a constant nonrenal clearance in $\\mathrm{mL/min}$ that is taken as unaffected by the CKD modifications for the purposes of this exercise.\n\nYour tasks are the following.\n\na) Using only the relationships in items $1$ and $2$, derive a closed-form expression for the renal clearance $CL_r$ in terms of $GFR$, $A$, $CL_{\\mathrm{int,sec}}$, $CL_{\\mathrm{int,reabs}}$, $UFR$, $f_u$, and $f_U$. Clearly indicate the algebraic steps that relate the mass balance to the final expression.\n\nb) Design an algorithm that, given a drug type (weak acid or weak base), $pK_a$, urine $pH$, $f_u$, $GFR$, $A$, $CL_{\\mathrm{int,sec}}$, $CL_{\\mathrm{int,reabs}}$, $UFR$, and $CL_{\\mathrm{nr}}$, computes $CL_r$ and $f_e$. Assume linear transporter kinetics (no saturation) and negligible binding in urine.\n\nc) Implement the algorithm as a complete, runnable program that evaluates the following five test cases. In each case, all clearances and flow rates are in $\\mathrm{mL/min}$, $pH$ and $pK_a$ are unitless, and $f_u$ is unitless. CKD is represented by reduced $GFR$, reduced transporter abundance factor $A$, and altered urine $pH$, as specified per case.\n\nCase $1$ (weak acid, baseline): drug type acid, $pK_a = 4.0$, $f_u = 0.8$, $GFR = 120$, $A = 1.0$, $CL_{\\mathrm{int,sec}} = 30$, $CL_{\\mathrm{int,reabs}} = 100$, $pH = 6.0$, $UFR = 1.5$, $CL_{\\mathrm{nr}} = 60$.\n\nCase $2$ (weak acid, CKD): drug type acid, $pK_a = 4.0$, $f_u = 0.8$, $GFR = 45$, $A = 0.5$, $CL_{\\mathrm{int,sec}} = 30$, $CL_{\\mathrm{int,reabs}} = 100$, $pH = 5.0$, $UFR = 0.8$, $CL_{\\mathrm{nr}} = 60$.\n\nCase $3$ (weak base, alkaline urine): drug type base, $pK_a = 9.0$, $f_u = 0.5$, $GFR = 120$, $A = 1.0$, $CL_{\\mathrm{int,sec}} = 80$, $CL_{\\mathrm{int,reabs}} = 200$, $pH = 9.5$, $UFR = 1.2$, $CL_{\\mathrm{nr}} = 40$.\n\nCase $4$ (weak base, CKD with acidic urine and low flow): drug type base, $pK_a = 9.0$, $f_u = 0.5$, $GFR = 15$, $A = 0.3$, $CL_{\\mathrm{int,sec}} = 80$, $CL_{\\mathrm{int,reabs}} = 200$, $pH = 6.0$, $UFR = 0.3$, $CL_{\\mathrm{nr}} = 40$.\n\nCase $5$ (weak acid, negligible reabsorption, no secretion): drug type acid, $pK_a = 4.0$, $f_u = 0.1$, $GFR = 90$, $A = 1.0$, $CL_{\\mathrm{int,sec}} = 0$, $CL_{\\mathrm{int,reabs}} = 0.1$, $pH = 8.0$, $UFR = 2.0$, $CL_{\\mathrm{nr}} = 20$.\n\nd) For each case, compute the renal clearance $CL_r$ and the renal fraction excreted $f_e$. Express $CL_r$ in $\\mathrm{mL/min}$ rounded to three decimal places and express $f_e$ as a decimal rounded to four decimal places.\n\ne) Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[CL_{r,1}, f_{e,1}, CL_{r,2}, f_{e,2}, CL_{r,3}, f_{e,3}, CL_{r,4}, f_{e,4}, CL_{r,5}, f_{e,5}]$ with the specified rounding and no additional spaces or text.\n\nYour program must be self-contained and require no input.", "solution": "The problem is validated as scientifically sound, well-posed, and containing all necessary information for a unique solution. The model of renal clearance presented is a standard, albeit simplified, representation used in pharmacology and is based on fundamental principles of mass balance.\n\n**a) Derivation of the Closed-Form Expression for Renal Clearance ($CL_r$)**\n\nThe derivation begins with the fundamental principles of mass balance and clearance provided in the problem statement. The goal is to express renal clearance, $CL_r$, in terms of the given physiological and drug-specific parameters.\n\nLet $C_p$ be the total plasma drug concentration, $f_u$ the unbound fraction in plasma, and $C_{p,u} = f_u C_p$ the unbound plasma concentration. Let $C_u$ be the total drug concentration in the tubular lumen.\n\nThe net urinary excretion rate, $R_{ex}$, is the product of the urine flow rate, $UFR$, and the urinary drug concentration, $C_u$:\n$$R_{ex} = UFR \\cdot C_u$$\n\nBy definition, renal clearance, $CL_r$, is the ratio of the net urinary excretion rate to the total plasma concentration:\n$$CL_r = \\frac{R_{ex}}{C_p} = \\frac{UFR \\cdot C_u}{C_p}$$\n\nThe problem states that at steady state, the mass balance in the tubule is given by:\nNet urinary excretion rate = (Filtration input rate) + (Secretion input rate) - (Reabsorption rate)\n\nThe individual rate components are defined as:\n- Filtration rate: $R_{filt} = GFR \\cdot C_{p,u} = GFR \\cdot f_u \\cdot C_p$\n- Secretion rate: $R_{sec} = A \\cdot CL_{\\mathrm{int,sec}} \\cdot C_{p,u} = A \\cdot CL_{\\mathrm{int,sec}} \\cdot f_u \\cdot C_p$\n- Reabsorption rate: $R_{reabs} = CL_{\\mathrm{int,reabs}} \\cdot f_U \\cdot C_u$\n\nSubstituting these into the mass balance equation:\n$$R_{ex} = R_{filt} + R_{sec} - R_{reabs}$$\n$$UFR \\cdot C_u = (GFR \\cdot f_u \\cdot C_p) + (A \\cdot CL_{\\mathrm{int,sec}} \\cdot f_u \\cdot C_p) - (CL_{\\mathrm{int,reabs}} \\cdot f_U \\cdot C_u)$$\n\nTo find an expression for $CL_r$, we first need to solve for the luminal concentration, $C_u$, in terms of the plasma concentration, $C_p$. We rearrange the equation by grouping terms with $C_u$ on the left side and terms with $C_p$ on the right side:\n$$UFR \\cdot C_u + CL_{\\mathrm{int,reabs}} \\cdot f_U \\cdot C_u = GFR \\cdot f_u \\cdot C_p + A \\cdot CL_{\\mathrm{int,sec}} \\cdot f_u \\cdot C_p$$\n\nFactor out $C_u$ on the left and $f_u C_p$ on the right:\n$$C_u (UFR + CL_{\\mathrm{int,reabs}} \\cdot f_U) = (GFR + A \\cdot CL_{\\mathrm{int,sec}}) f_u C_p$$\n\nNow, isolate $C_u$:\n$$C_u = \\frac{(GFR + A \\cdot CL_{\\mathrm{int,sec}}) f_u C_p}{UFR + CL_{\\mathrm{int,reabs}} \\cdot f_U}$$\n\nFinally, substitute this expression for $C_u$ back into the definition of $CL_r$:\n$$CL_r = \\frac{UFR \\cdot C_u}{C_p} = \\frac{UFR}{C_p} \\left( \\frac{(GFR + A \\cdot CL_{\\mathrm{int,sec}}) f_u C_p}{UFR + CL_{\\mathrm{int,reabs}} \\cdot f_U} \\right)$$\n\nThe term $C_p$ cancels out, yielding the final closed-form expression for renal clearance:\n$$CL_r = f_u \\frac{UFR \\cdot (GFR + A \\cdot CL_{\\mathrm{int,sec}})}{UFR + CL_{\\mathrm{int,reabs}} \\cdot f_U}$$\n\n**b) Algorithm Design**\n\nThe algorithm to compute $CL_r$ and the renal fraction excreted, $f_e$, follows directly from the derived formula and the given definitions.\n\nGiven the inputs: drug type (`acid` or `base`), $pK_a$, $pH$, $f_u$, $GFR$, $A$, $CL_{\\mathrm{int,sec}}$, $CL_{\\mathrm{int,reabs}}$, $UFR$, and $CL_{\\mathrm{nr}}$.\n\n1.  **Calculate the fraction unionized in urine, $f_U$**:\n    -   If the drug type is `acid`, use the formula: $f_U = \\dfrac{1}{1 + 10^{(pH - pK_a)}}$.\n    -   If the drug type is `base`, use the formula: $f_U = \\dfrac{1}{1 + 10^{(pK_a - pH)}}$.\n\n2.  **Calculate the renal clearance, $CL_r$**:\n    -   Using the derived expression:\n        $$CL_r = f_u \\frac{UFR \\cdot (GFR + A \\cdot CL_{\\mathrm{int,sec}})}{UFR + CL_{\\mathrm{int,reabs}} \\cdot f_U}$$\n\n3.  **Calculate the renal fraction excreted, $f_e$**:\n    -   Using the provided definition:\n        $$f_e = \\frac{CL_r}{CL_r + CL_{\\mathrm{nr}}}$$\n\n4.  **Format the results**:\n    -   Round $CL_r$ to three decimal places.\n    -   Round $f_e$ to four decimal places.\n\nThis algorithm provides a systematic procedure to compute the required outputs for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes renal clearance (CL_r) and renal fraction excreted (f_e)\n    for a series of test cases based on a mechanistic model of renal excretion.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"drug_type\": \"acid\", \"pka\": 4.0, \"fu\": 0.8, \"gfr\": 120, \"A\": 1.0, \n            \"cl_int_sec\": 30, \"cl_int_reabs\": 100, \"ph\": 6.0, \"ufr\": 1.5, \"cl_nr\": 60\n        },\n        {\n            \"drug_type\": \"acid\", \"pka\": 4.0, \"fu\": 0.8, \"gfr\": 45, \"A\": 0.5, \n            \"cl_int_sec\": 30, \"cl_int_reabs\": 100, \"ph\": 5.0, \"ufr\": 0.8, \"cl_nr\": 60\n        },\n        {\n            \"drug_type\": \"base\", \"pka\": 9.0, \"fu\": 0.5, \"gfr\": 120, \"A\": 1.0, \n            \"cl_int_sec\": 80, \"cl_int_reabs\": 200, \"ph\": 9.5, \"ufr\": 1.2, \"cl_nr\": 40\n        },\n        {\n            \"drug_type\": \"base\", \"pka\": 9.0, \"fu\": 0.5, \"gfr\": 15, \"A\": 0.3, \n            \"cl_int_sec\": 80, \"cl_int_reabs\": 200, \"ph\": 6.0, \"ufr\": 0.3, \"cl_nr\": 40\n        },\n        {\n            \"drug_type\": \"acid\", \"pka\": 4.0, \"fu\": 0.1, \"gfr\": 90, \"A\": 1.0, \n            \"cl_int_sec\": 0, \"cl_int_reabs\": 0.1, \"ph\": 8.0, \"ufr\": 2.0, \"cl_nr\": 20\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack case parameters\n        drug_type = case[\"drug_type\"]\n        pka = case[\"pka\"]\n        fu = case[\"fu\"]\n        gfr = case[\"gfr\"]\n        A = case[\"A\"]\n        cl_int_sec = case[\"cl_int_sec\"]\n        cl_int_reabs = case[\"cl_int_reabs\"]\n        ph = case[\"ph\"]\n        ufr = case[\"ufr\"]\n        cl_nr = case[\"cl_nr\"]\n\n        # Step 1: Calculate the fraction unionized in urine, f_U\n        if drug_type == \"acid\":\n            f_U = 1 / (1 + np.power(10, ph - pka))\n        elif drug_type == \"base\":\n            f_U = 1 / (1 + np.power(10, pka - ph))\n        else:\n            # This case should not be reached with the given test data\n            raise ValueError(\"Invalid drug type specified.\")\n\n        # Step 2: Calculate the renal clearance, CL_r\n        # CL_r = f_u * (UFR * (GFR + A * CL_int,sec)) / (UFR + CL_int,reabs * f_U)\n        numerator = fu * ufr * (gfr + A * cl_int_sec)\n        denominator = ufr + cl_int_reabs * f_U\n        \n        # Avoid division by zero, though not expected with given model/data\n        if denominator == 0:\n            cl_r = float('inf') if numerator > 0 else 0.0\n        else:\n            cl_r = numerator / denominator\n\n        # Step 3: Calculate the renal fraction excreted, f_e\n        # f_e = CL_r / (CL_r + CL_nr)\n        total_clearance = cl_r + cl_nr\n        \n        if total_clearance == 0:\n            f_e = 0.0\n        else:\n            f_e = cl_r / total_clearance\n        \n        # Step 4: Format the results and add to the list\n        # Round CL_r to 3 decimal places and f_e to 4 decimal places\n        results.append(f\"{cl_r:.3f}\")\n        results.append(f\"{f_e:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4940895"}]}