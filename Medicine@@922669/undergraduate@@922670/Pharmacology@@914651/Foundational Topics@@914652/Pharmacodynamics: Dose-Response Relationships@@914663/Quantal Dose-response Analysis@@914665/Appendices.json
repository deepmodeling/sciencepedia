{"hands_on_practices": [{"introduction": "The slope of a dose-response curve is a critical parameter, indicating how rapidly the effect of a drug changes with dose. This exercise delves into the mathematical heart of the probit model to reveal the direct relationship between the slope parameter $\\beta$ and the steepness of the curve. By deriving the ratio of two effective doses, $ED_{90}$ and $ED_{10}$, you will see how this abstract parameter translates into a tangible and interpretable measure of a drug's dose-response profile [@problem_id:4984806].", "problem": "A pharmacologist models a binary (quantal) response to dose in a homogeneous population using a probit dose-response model. Let $p(d)$ denote the probability of response at dose $d>0$. The model assumes that the probit-transformed response probability is linear in the natural logarithm of dose:\n$$\\Phi^{-1}\\!\\big(p(d)\\big) = \\alpha + \\beta \\ln d,$$\nwhere $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi^{-1}$ is its inverse (the probit), $\\alpha \\in \\mathbb{R}$ is a location parameter, and $\\beta>0$ is a slope parameter. The effective dose at probability level $p \\in (0,1)$, denoted $\\mathrm{ED}_{p}$, is defined by $p(\\mathrm{ED}_{p})=p$.\n\nStarting from these definitions, and without invoking any pre-given closed-form for $\\mathrm{ED}_{p}$, derive a symbolic expression for $\\mathrm{ED}_{p}$ in terms of $\\alpha$, $\\beta$, and $p$. Then specialize to $p=0.1$ and $p=0.9$ to obtain $\\mathrm{ED}_{10}$ and $\\mathrm{ED}_{90}$. Finally, form the ratio $R=\\mathrm{ED}_{90}/\\mathrm{ED}_{10}$ and simplify it using only fundamental properties of the standard normal distribution to eliminate $\\alpha$, expressing $R$ solely as a function of $\\beta$. Provide your final answer as a single closed-form expression for $R$ in terms of $\\beta$. No numerical approximation or rounding is required, and no units are needed for $R$ since it is dimensionless.", "solution": "The problem will first be validated for scientific soundness, self-consistency, and well-posedness.\n\n### Step 1: Extract Givens\n-   The probability of response at dose $d>0$ is denoted by $p(d)$.\n-   The probit dose-response model is given by the equation: $\\Phi^{-1}\\!\\big(p(d)\\big) = \\alpha + \\beta \\ln d$.\n-   $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution.\n-   $\\Phi^{-1}$ is the inverse of $\\Phi$, also known as the probit function.\n-   $\\alpha \\in \\mathbb{R}$ is a location parameter.\n-   $\\beta > 0$ is a slope parameter.\n-   The effective dose at probability level $p \\in (0,1)$, denoted $\\mathrm{ED}_{p}$, is defined by the condition $p(\\mathrm{ED}_{p})=p$.\n-   The task is to derive an expression for the ratio $R = \\mathrm{ED}_{90}/\\mathrm{ED}_{10}$ using the cases $p=0.9$ and $p=0.1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria.\n-   **Scientifically Grounded:** The probit model is a cornerstone of classical toxicology and pharmacology for analyzing quantal (all-or-none) dose-response data. It assumes that the logarithm of the tolerance of individuals in a population is normally distributed. The model formulation is standard and correctly stated.\n-   **Well-Posed:** The problem provides all necessary definitions and constraints to derive a unique symbolic expression for the ratio $R$. The parameters are defined, and the functional form of the model is explicit. The question is unambiguous.\n-   **Objective:** The problem is stated in precise mathematical and scientific language, free of subjectivity or opinion.\n-   The problem does not suffer from any of the invalidity flaws. It is scientifically sound, formalizable, complete, feasible, well-posed, and non-trivial. It asks for a standard derivation within its domain.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to derive a simplified, closed-form expression for the ratio $R = \\mathrm{ED}_{90}/\\mathrm{ED}_{10}$ as a function of the parameter $\\beta$.\n\nFirst, we derive a general expression for the effective dose, $\\mathrm{ED}_{p}$. By definition, $\\mathrm{ED}_{p}$ is the dose $d$ that satisfies the condition $p(d) = p$. Substituting $d = \\mathrm{ED}_{p}$ and $p(d) = p$ into the probit model equation gives:\n$$\n\\Phi^{-1}(p) = \\alpha + \\beta \\ln(\\mathrm{ED}_{p})\n$$\nWe must now solve this equation for $\\mathrm{ED}_{p}$. Rearranging the terms to isolate $\\ln(\\mathrm{ED}_{p})$:\n$$\n\\beta \\ln(\\mathrm{ED}_{p}) = \\Phi^{-1}(p) - \\alpha\n$$\n$$\n\\ln(\\mathrm{ED}_{p}) = \\frac{\\Phi^{-1}(p) - \\alpha}{\\beta}\n$$\nExponentiating both sides of the equation yields the general expression for $\\mathrm{ED}_{p}$:\n$$\n\\mathrm{ED}_{p} = \\exp\\left(\\frac{\\Phi^{-1}(p) - \\alpha}{\\beta}\\right)\n$$\nNext, we specialize this general expression for the two required cases: $\\mathrm{ED}_{90}$ and $\\mathrm{ED}_{10}$. The problem states that these correspond to response probabilities $p=0.9$ and $p=0.1$, respectively.\n\nFor $\\mathrm{ED}_{90}$, we set $p=0.9$:\n$$\n\\mathrm{ED}_{90} = \\exp\\left(\\frac{\\Phi^{-1}(0.9) - \\alpha}{\\beta}\\right)\n$$\nFor $\\mathrm{ED}_{10}$, we set $p=0.1$:\n$$\n\\mathrm{ED}_{10} = \\exp\\left(\\frac{\\Phi^{-1}(0.1) - \\alpha}{\\beta}\\right)\n$$\nNow, we form the ratio $R = \\mathrm{ED}_{90}/\\mathrm{ED}_{10}$:\n$$\nR = \\frac{\\mathrm{ED}_{90}}{\\mathrm{ED}_{10}} = \\frac{\\exp\\left(\\frac{\\Phi^{-1}(0.9) - \\alpha}{\\beta}\\right)}{\\exp\\left(\\frac{\\Phi^{-1}(0.1) - \\alpha}{\\beta}\\right)}\n$$\nUsing the property of exponential functions, $\\exp(a)/\\exp(b) = \\exp(a-b)$, we simplify the ratio:\n$$\nR = \\exp\\left(\\left(\\frac{\\Phi^{-1}(0.9) - \\alpha}{\\beta}\\right) - \\left(\\frac{\\Phi^{-1}(0.1) - \\alpha}{\\beta}\\right)\\right)\n$$\nCombining the terms in the exponent over the common denominator $\\beta$:\n$$\nR = \\exp\\left(\\frac{(\\Phi^{-1}(0.9) - \\alpha) - (\\Phi^{-1}(0.1) - \\alpha)}{\\beta}\\right)\n$$\nThe parameter $\\alpha$ cancels out in the numerator:\n$$\nR = \\exp\\left(\\frac{\\Phi^{-1}(0.9) - \\Phi^{-1}(0.1)}{\\beta}\\right)\n$$\nThe final step is to simplify the numerator using a fundamental property of the standard normal distribution. The standard normal probability density function is symmetric about $z=0$. This implies a symmetry for its CDF, $\\Phi(z)$, and its inverse, $\\Phi^{-1}(p)$. The property is $\\Phi(-z) = 1 - \\Phi(z)$.\nLet $p = \\Phi(z)$, which implies $z = \\Phi^{-1}(p)$. Substituting these into the symmetry property gives:\n$$\n1-p = \\Phi(-z) = \\Phi(-\\Phi^{-1}(p))\n$$\nApplying the inverse CDF, $\\Phi^{-1}$, to both sides:\n$$\n\\Phi^{-1}(1-p) = -\\Phi^{-1}(p)\n$$\nWe can apply this property to the term $\\Phi^{-1}(0.1)$ in our expression for $R$. Setting $p=0.9$, we have $1-p = 1-0.9 = 0.1$. Therefore:\n$$\n\\Phi^{-1}(0.1) = \\Phi^{-1}(1-0.9) = -\\Phi^{-1}(0.9)\n$$\nSubstituting this result back into the expression for $R$:\n$$\nR = \\exp\\left(\\frac{\\Phi^{-1}(0.9) - (-\\Phi^{-1}(0.9))}{\\beta}\\right)\n$$\n$$\nR = \\exp\\left(\\frac{\\Phi^{-1}(0.9) + \\Phi^{-1}(0.9)}{\\beta}\\right)\n$$\n$$\nR = \\exp\\left(\\frac{2\\Phi^{-1}(0.9)}{\\beta}\\right)\n$$\nThis is the final simplified expression for the ratio $R$. It is a function solely of the slope parameter $\\beta$, as the term $\\Phi^{-1}(0.9)$ represents a specific numerical constant (the $z$-score corresponding to the $90$th percentile of the standard normal distribution). The location parameter $\\alpha$ has been eliminated as required.", "answer": "$$\\boxed{\\exp\\left(\\frac{2\\Phi^{-1}(0.9)}{\\beta}\\right)}$$", "id": "4984806"}, {"introduction": "While parametric models like probit or logit assume a smooth, sigmoidal shape, experimental data often exhibit random fluctuations that can violate the expected monotonic trend. This is where non-parametric methods become invaluable. This practice introduces isotonic regression, a technique that estimates a non-decreasing dose-response relationship without assuming a specific functional form, using the Pool-Adjacent-Violators Algorithm (PAVA) to correct for local violations in the data [@problem_id:4984813].", "problem": "In quantal dose-response analysis, each subject at a given dose level either exhibits the pharmacological effect or not. Suppose there are $J$ ordered dose levels $\\{d_1, d_2, \\dots, d_J\\}$, with $n_j$ subjects tested at dose $d_j$ and $r_j$ responders, producing the empirical proportion $\\hat{p}_j = r_j / n_j$. The scientific expectation for a monotone dose-response is that the true probability of response $p(d_j)$ is nondecreasing in $d_j$. However, sampling variability can cause the empirical proportions $\\{\\hat{p}_j\\}$ to be nonmonotone.\n\nStarting from the binomial model for quantal outcomes where, at each dose $d_j$, the number of responders $r_j$ arises from a Binomial$(n_j, p(d_j))$ distribution, the nonparametric maximum likelihood estimator under a monotonicity constraint $p(d_1) \\le p(d_2) \\le \\cdots \\le p(d_J)$ can be obtained via isotonic regression. One constructive algorithm that yields this estimator is the pool-adjacent-violators algorithm (PAVA), which enforces monotonicity by combining adjacent dose levels that violate the order constraint into blocks and assigning a single block estimate.\n\nConsider the following dataset with $J = 5$ dose levels:\n- Dose levels: $d_1, d_2, d_3, d_4, d_5$.\n- Sample sizes: $n_1 = 10$, $n_2 = 15$, $n_3 = 20$, $n_4 = 25$, $n_5 = 30$.\n- Responders: $r_1 = 1$, $r_2 = 5$, $r_3 = 6$, $r_4 = 14$, $r_5 = 16$.\n\nThe empirical proportions are $\\hat{p}_1 = 1/10$, $\\hat{p}_2 = 5/15$, $\\hat{p}_3 = 6/20$, $\\hat{p}_4 = 14/25$, $\\hat{p}_5 = 16/30$.\n\nWhich option best explains isotonic regression with the pool-adjacent-violators algorithm (PAVA) for estimating a monotone $p(d_j)$, accurately describes how it handles nonmonotone empirical proportions, and gives the correct final monotone estimates for this dataset?\n\nA. PAVA proceeds in dose order and, whenever it finds adjacent empirical proportions that violate the nondecreasing constraint, it pools those adjacent doses into a single block. The block estimate is the weighted average of the pooled empirical proportions with weights equal to the corresponding sample sizes $\\{n_j\\}$; equivalently, for a block $\\mathcal{B}$, it sets the block value to $\\sum_{j \\in \\mathcal{B}} r_j \\big/ \\sum_{j \\in \\mathcal{B}} n_j$. It repeats pooling until no adjacent violations remain. For the given data, the violations at $d_2$ versus $d_3$ and at $d_4$ versus $d_5$ lead to blocks $\\{d_2, d_3\\}$ with estimate $11/35$ and $\\{d_4, d_5\\}$ with estimate $30/55 = 6/11$, yielding final monotone estimates $p(d_1) = 1/10$, $p(d_2) = p(d_3) = 11/35$, $p(d_4) = p(d_5) = 6/11$.\n\nB. PAVA pools any adjacent violators but uses the simple unweighted mean of the empirical proportions in the pooled block; for the data, this gives $p(d_2) = p(d_3) = \\big((5/15) + (6/20)\\big)/2$ and $p(d_4) = p(d_5) = \\big((14/25) + (16/30)\\big)/2$, with other doses unchanged.\n\nC. To enforce monotonicity, PAVA replaces any violating empirical proportion by the previous dose’s proportion (capping), without pooling or averaging; thus for the data, it sets $p(d_3) = 5/15$ and $p(d_5) = 14/25$, leaving other doses unchanged.\n\nD. PAVA first sorts doses by the empirical proportions in ascending order, then assigns the sorted values directly to the original dose order to achieve monotonicity, without pooling.\n\nE. PAVA fits a parametric logistic curve $p(d) = 1/\\big(1 + \\exp(-(\\alpha + \\beta d))\\big)$ by maximum likelihood and uses its fitted values to enforce monotonicity automatically, avoiding any pooling of adjacent dose levels.", "solution": "The problem statement will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- The context is quantal dose-response analysis.\n- There are $J$ ordered dose levels $\\{d_1, d_2, \\dots, d_J\\}$.\n- At each dose $d_j$, $n_j$ subjects are tested and $r_j$ subjects respond.\n- The empirical proportion of responders at dose $d_j$ is $\\hat{p}_j = r_j / n_j$.\n- The true probability of response $p(d_j)$ is assumed to be nondecreasing: $p(d_1) \\le p(d_2) \\le \\cdots \\le p(d_J)$.\n- The number of responders $r_j$ at dose $d_j$ follows a Binomial distribution: $r_j \\sim \\text{Binomial}(n_j, p(d_j))$.\n- The nonparametric maximum likelihood estimator under the monotonicity constraint is obtained via isotonic regression, using the pool-adjacent-violators algorithm (PAVA).\n- PAVA enforces monotonicity by pooling adjacent dose levels that violate the order constraint.\n- Dataset provided:\n  - Number of dose levels: $J = 5$.\n  - Dose levels: $d_1, d_2, d_3, d_4, d_5$.\n  - Sample sizes: $n_1 = 10$, $n_2 = 15$, $n_3 = 20$, $n_4 = 25$, $n_5 = 30$.\n  - Number of responders: $r_1 = 1$, $r_2 = 5$, $r_3 = 6$, $r_4 = 14$, $r_5 = 16$.\n- The stated empirical proportions are $\\hat{p}_1 = 1/10$, $\\hat{p}_2 = 5/15$, $\\hat{p}_3 = 6/20$, $\\hat{p}_4 = 14/25$, $\\hat{p}_5 = 16/30$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Groundedness**: The problem is well-grounded in the statistical theory of dose-response analysis and nonparametric estimation. The binomial model for quantal outcomes is standard. Isotonic regression via PAVA is the correct and established method for finding the nonparametric maximum likelihood estimate of a monotone sequence of binomial probabilities. The problem is scientifically sound.\n2.  **Well-Posedness**: The problem is well-posed. Given a set of empirical proportions and their corresponding sample sizes, PAVA provides a unique set of monotone estimates. The question asks for the correct description of the algorithm and its application to a specific dataset, which is a soluble problem with a unique answer.\n3.  **Objectivity**: The problem is stated using clear, objective, and standard terminology from statistics and pharmacology. There is no subjective or ambiguous language.\n4.  **Consistency and Completeness**: The provided data are complete and consistent. The empirical proportions are correctly calculated from the given numbers of responders and sample sizes:\n    - $\\hat{p}_1 = r_1 / n_1 = 1 / 10 = 0.1$\n    - $\\hat{p}_2 = r_2 / n_2 = 5 / 15 = 1/3 \\approx 0.333$\n    - $\\hat{p}_3 = r_3 / n_3 = 6 / 20 = 3/10 = 0.3$\n    - $\\hat{p}_4 = r_4 / n_4 = 14 / 25 = 0.56$\n    - $\\hat{p}_5 = r_5 / n_5 = 16 / 30 = 8/15 \\approx 0.533$\n    The problem provides all information necessary to apply the PAVA algorithm.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, and contains all necessary information. I will proceed with deriving the solution.\n\n### Derivation of Solution\nThe goal is to find the isotonic regression estimates $\\{p^*(d_j)\\}$ for the sequence of empirical proportions $\\{\\hat{p}_j\\}$ under the nondecreasing constraint $p^*(d_1) \\le p^*(d_2) \\le p^*(d_3) \\le p^*(d_4) \\le p^*(d_5)$. This is achieved using the pool-adjacent-violators algorithm (PAVA).\n\nThe initial empirical proportions are:\n$\\hat{\\mathbf{p}} = (\\hat{p}_1, \\hat{p}_2, \\hat{p}_3, \\hat{p}_4, \\hat{p}_5) = (1/10, 5/15, 6/20, 14/25, 16/30)$.\nIn decimal form, this is approximately $(0.1, 0.333, 0.3, 0.56, 0.533)$.\n\nWe can identify two violations of the nondecreasing order:\n1.  $\\hat{p}_2 = 5/15 \\approx 0.333 > \\hat{p}_3 = 6/20 = 0.3$.\n2.  $\\hat{p}_4 = 14/25 = 0.56 > \\hat{p}_5 = 16/30 \\approx 0.533$.\n\nPAVA proceeds by identifying and resolving these violations. A common implementation of PAVA scans the sequence and pools adjacent violators.\n\nLet the initial isotonic estimate be the empirical proportions: $p^*_j = \\hat{p}_j$.\n$p^* = (1/10, 5/15, 6/20, 14/25, 16/30)$.\n\n1.  Compare $p^*_1$ and $p_2^*$: $1/10 = 0.1 < 5/15 \\approx 0.333$. The order is correct. The current solution is $(1/10, 5/15, 6/20, 14/25, 16/30)$.\n\n2.  Compare $p^*_2$ and $p_3^*$: $5/15 > 6/20$. This is a violation. We pool the adjacent block $\\{2, 3\\}$. The new estimate for this block is the weighted average of the proportions, with weights given by the sample sizes $n_2=15$ and $n_3=20$. This is equivalent to summing the responders and dividing by the sum of subjects.\n$$p^*_{\\{2,3\\}} = \\frac{r_2 + r_3}{n_2 + n_3} = \\frac{5 + 6}{15 + 20} = \\frac{11}{35}$$\nNumerically, $11/35 \\approx 0.3143$. The sequence of estimates is now updated by replacing $p^*_2$ and $p^*_3$ with this new value: $(1/10, 11/35, 11/35, 14/25, 16/30)$.\nWe must check backwards from the new block. Is $p^*_1 \\le p^*_{\\{2,3\\}}$? $1/10 = 0.1 < 11/35 \\approx 0.3143$. The order is maintained.\n\n3.  Continue scanning from the new block. Compare $p^*_{\\{2,3\\}}$ and $p^*_4$: $11/35 \\approx 0.3143 < 14/25 = 0.56$. The order is correct. The current solution is $(1/10, 11/35, 11/35, 14/25, 16/30)$.\n\n4.  Compare $p^*_4$ and $p^*_5$: $14/25 = 0.56 > 16/30 \\approx 0.533$. This is a violation. We pool the adjacent block $\\{4, 5\\}$. The new estimate is:\n$$p^*_{\\{4,5\\}} = \\frac{r_4 + r_5}{n_4 + n_5} = \\frac{14 + 16}{25 + 30} = \\frac{30}{55} = \\frac{6}{11}$$\nNumerically, $6/11 \\approx 0.5454$. The sequence of estimates is updated to $(1/10, 11/35, 11/35, 6/11, 6/11)$.\nWe must check backwards. Is $p^*_{\\{2,3\\}} \\le p^*_{\\{4,5\\}}$? $11/35 \\approx 0.3143 < 6/11 \\approx 0.5454$. The order is maintained. No further pooling is required.\n\nThe final sequence of isotonic estimates is $(1/10, 11/35, 11/35, 6/11, 6/11)$.\nThis sequence is nondecreasing:\n$1/10 = 0.1$\n$11/35 \\approx 0.314$\n$6/11 \\approx 0.545$\nThe sequence $0.1 \\le 0.314 = 0.314 \\le 0.545 = 0.545$ is monotone.\n\nThe final estimates are:\n$p^*(d_1) = 1/10$\n$p^*(d_2) = 11/35$\n$p^*(d_3) = 11/35$\n$p^*(d_4) = 6/11$\n$p^*(d_5) = 6/11$\n\n### Option-by-Option Analysis\n\n**A. PAVA proceeds in dose order and, whenever it finds adjacent empirical proportions that violate the nondecreasing constraint, it pools those adjacent doses into a single block. The block estimate is the weighted average of the pooled empirical proportions with weights equal to the corresponding sample sizes $\\{n_j\\}$; equivalently, for a block $\\mathcal{B}$, it sets the block value to $\\sum_{j \\in \\mathcal{B}} r_j \\big/ \\sum_{j \\in \\mathcal{B}} n_j$. It repeats pooling until no adjacent violations remain. For the given data, the violations at $d_2$ versus $d_3$ and at $d_4$ versus $d_5$ lead to blocks $\\{d_2, d_3\\}$ with estimate $11/35$ and $\\{d_4, d_5\\}$ with estimate $30/55 = 6/11$, yielding final monotone estimates $p(d_1) = 1/10$, $p(d_2) = p(d_3) = 11/35$, $p(d_4) = p(d_5) = 6/11$.**\n- The description of PAVA is correct. PAVA for binomial proportions is precisely the process of finding the weighted average using sample sizes as weights, which is identical to pooling counts ($r_j$) and sample sizes ($n_j$).\n- The application to the data is also correct. The violations are correctly identified at $\\{d_2, d_3\\}$ and $\\{d_4, d_5\\}$. The block estimates are correctly calculated as $11/35$ and $30/55 = 6/11$. The final set of monotonic estimates matches the one derived above.\n- Verdict: **Correct**.\n\n**B. PAVA pools any adjacent violators but uses the simple unweighted mean of the empirical proportions in the pooled block; for the data, this gives $p(d_2) = p(d_3) = \\big((5/15) + (6/20)\\big)/2$ and $p(d_4) = p(d_5) = \\big((14/25) + (16/30)\\big)/2$, with other doses unchanged.**\n- This description of the averaging procedure is incorrect. PAVA produces the maximum likelihood estimate, which requires a *weighted* average where the weights are the sample sizes $n_j$. An unweighted mean gives equal importance to proportions derived from different sample sizes, which is statistically inefficient and does not correspond to the MLE.\n- Verdict: **Incorrect**.\n\n**C. To enforce monotonicity, PAVA replaces any violating empirical proportion by the previous dose’s proportion (capping), without pooling or averaging; thus for the data, it sets $p(d_3) = 5/15$ and $p(d_5) = 14/25$, leaving other doses unchanged.**\n- This describes a different, ad-hoc procedure for imposing monotonicity. It is not the PAVA algorithm, which is defined by the pooling-and-averaging process that minimizes the weighted sum of squared errors (or maximizes likelihood in this context).\n- Verdict: **Incorrect**.\n\n**D. PAVA first sorts doses by the empirical proportions in ascending order, then assigns the sorted values directly to the original dose order to achieve monotonicity, without pooling.**\n- This is a fundamental misunderstanding of PAVA. Sorting the values and reassigning them breaks the correspondence between the dose levels and the observed proportions. PAVA adjusts the *values* of the proportions at their original positions to satisfy monotonicity, it does not reorder them.\n- Verdict: **Incorrect**.\n\n**E. PAVA fits a parametric logistic curve $p(d) = 1/\\big(1 + \\exp(-(\\alpha + \\beta d))\\big)$ by maximum likelihood and uses its fitted values to enforce monotonicity automatically, avoiding any pooling of adjacent dose levels.**\n- This describes a parametric approach (logistic regression), which is distinct from the nonparametric isotonic regression performed by PAVA. The problem statement explicitly specifies a nonparametric method. PAVA makes no assumptions about the functional form of the dose-response relationship beyond monotonicity, whereas logistic regression assumes a specific sigmoidal shape.\n- Verdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "4984813"}, {"introduction": "A successful analysis depends on the quality of the data, and real-world experiments are susceptible to systematic errors beyond simple random noise. This problem models a common scenario: endpoint misclassification, where true responses are missed (false negatives) or non-responses are incorrectly recorded as responses (false positives). By working through this exercise, you will quantify how such errors can systematically distort the observed dose-response curve, leading to a biased estimation of potency, such as the apparent $ED_{50}$ [@problem_id:4984840].", "problem": "A pharmacology laboratory measures a binary quantal endpoint (e.g., loss of righting reflex) in a rodent cohort exposed to a drug at dose $D$ (in mg/kg). Assume the underlying true probability of response, denoted $p_{\\mathrm{true}}(D)$, follows a logistic link on the natural-log dose scale: the logit of $p_{\\mathrm{true}}$ is an affine function of $\\ln(D)$, and the Effective Dose for $50\\%$ of subjects (ED50) on the dose scale, $D_{50,\\mathrm{true}}$, satisfies $p_{\\mathrm{true}}(D_{50,\\mathrm{true}})=0.5$. The slope parameter on the $\\ln(D)$ scale is a positive constant $b$.\n\nIn the laboratory’s scoring system, independent random endpoint misclassification occurs: a non-responder is recorded as a responder with false-positive probability $\\alpha$, and a true responder is recorded as a non-responder with false-negative probability $\\beta$, where both $\\alpha$ and $\\beta$ are dose-independent and satisfy $0<\\alpha<0.5$, $0<\\beta<0.5$, and $\\alpha+\\beta<1$. Let the observed response probability be $p_{\\mathrm{obs}}(D)$, defined by the law of total probability given the above misclassification mechanism.\n\nStarting from the definitions of the logistic link for $p_{\\mathrm{true}}(D)$, the ED50 definition $p_{\\mathrm{true}}(D_{50,\\mathrm{true}})=0.5$, and the dose-independent misclassification mechanism described above, derive the dose $D_{50,\\mathrm{app}}$ that would be inferred as the ED50 if one naively fits a logistic model to $p_{\\mathrm{obs}}(D)$ under the (incorrect) assumption of no misclassification, i.e., by solving $p_{\\mathrm{obs}}(D)=0.5$ for $D$.\n\nFor a preparation characterized by $D_{50,\\mathrm{true}}=4.0$ mg/kg, slope $b=2.0$ on the $\\ln(D)$ scale, false-positive rate $\\alpha=0.05$, and false-negative rate $\\beta=0.20$, compute the numerical value of $D_{50,\\mathrm{app}}$ in mg/kg. Round your final numeric answer to four significant figures. In your derivation, explicitly justify why the misclassification mechanism flattens the quantal curve and how the solution for $D_{50,\\mathrm{app}}$ reflects an increased apparent ED50 when $\\beta>\\alpha$.", "solution": "### Step 1: Problem Validation\n\n**Extract Givens:**\n*   Quantal endpoint in a rodent cohort.\n*   Dose $D$ (in mg/kg).\n*   True probability of response: $p_{\\mathrm{true}}(D)$.\n*   Model for $p_{\\mathrm{true}}(D)$: logistic link on the natural-log dose scale.\n*   The logit of $p_{\\mathrm{true}}$ is an affine function of $\\ln(D)$.\n*   Effective Dose for $50\\%$ of subjects (ED50) on the dose scale: $D_{50,\\mathrm{true}}$.\n*   Condition for ED50: $p_{\\mathrm{true}}(D_{50,\\mathrm{true}})=0.5$.\n*   Slope parameter on the $\\ln(D)$ scale is a positive constant $b$.\n*   False-positive probability: $\\alpha$. A non-responder is recorded as a responder. Dose-independent. $0 < \\alpha < 0.5$.\n*   False-negative probability: $\\beta$. A true responder is recorded as a non-responder. Dose-independent. $0 < \\beta < 0.5$.\n*   Constraint: $\\alpha+\\beta<1$.\n*   Observed response probability: $p_{\\mathrm{obs}}(D)$, defined by the law of total probability.\n*   Apparent ED50: $D_{50,\\mathrm{app}}$ is the solution to $p_{\\mathrm{obs}}(D)=0.5$.\n*   Numerical values: $D_{50,\\mathrm{true}}=4.0$ mg/kg, $b=2.0$, $\\alpha=0.05$, $\\beta=0.20$.\n*   Task: Derive $D_{50,\\mathrm{app}}$, justify the flattening of the curve, explain the shift in ED50 when $\\beta > \\alpha$, and compute the numerical value of $D_{50,\\mathrm{app}}$. Round to four significant figures.\n\n**Validate Using Extracted Givens:**\n1.  **Scientifically Grounded:** The problem is a standard exercise in pharmacological statistics (quantal dose-response analysis). The use of a logistic model, log-dose transformation, ED50, and accounting for misclassification errors ($\\alpha$, $\\beta$) are all well-established concepts in this field. The model is a scientifically reasonable simplification. The constraints on $\\alpha$ and $\\beta$ ($0<\\alpha, \\beta<0.5$ and $\\alpha+\\beta<1$) are sensible. The problem is scientifically grounded.\n2.  **Well-Posed:** The problem provides all necessary information to derive the relationship between $D_{50,\\mathrm{app}}$ and the other parameters. The functions are well-defined. The question asks for a specific derivation and calculation, which should lead to a unique solution. The problem is well-posed.\n3.  **Objective:** The language is clear, precise, and mathematical. There are no subjective or opinion-based statements. The problem is objective.\n4.  **Flaw Checklist:**\n    *   No scientific/factual unsoundness.\n    *   Formalizable and relevant to the topic.\n    *   Complete and consistent setup.\n    *   Realistic and feasible within the context of a modeling problem.\n    *   Well-posed and structured.\n    *   Not trivial or tautological.\n    *   Verifiable through mathematical derivation.\n\n**Verdict and Action:**\nThe problem is **valid**. I will proceed with the solution.\n\n---\n\n### Step 2: Solution Derivation\n\n**Part 1: Theoretical Derivation**\n\n*   **True Probability Model:**\n    The logit of $p_{\\mathrm{true}}(D)$ is an affine function of $\\ln(D)$:\n    $$ \\mathrm{logit}(p_{\\mathrm{true}}(D)) = \\ln\\left(\\frac{p_{\\mathrm{true}}(D)}{1-p_{\\mathrm{true}}(D)}\\right) = a + b \\ln(D) $$\n    The constant $a$ is determined by the condition $p_{\\mathrm{true}}(D_{50,\\mathrm{true}}) = 0.5$. At this dose, $\\mathrm{logit}(0.5) = \\ln(1) = 0$.\n    $$ 0 = a + b \\ln(D_{50,\\mathrm{true}}) \\implies a = -b \\ln(D_{50,\\mathrm{true}}) $$\n    Substituting $a$ back, we obtain the log-dose logistic model:\n    $$ \\ln\\left(\\frac{p_{\\mathrm{true}}(D)}{1-p_{\\mathrm{true}}(D)}\\right) = b \\ln(D) - b \\ln(D_{50,\\mathrm{true}}) = b \\ln\\left(\\frac{D}{D_{50,\\mathrm{true}}}\\right) $$\n\n*   **Observed Probability Model:**\n    Let $R$ be the event of a true response and $O$ be the event of an observed response. The true response probability is $P(R|D) = p_{\\mathrm{true}}(D)$. The misclassification probabilities are the false-positive rate $\\alpha = P(O | \\neg R)$ and the false-negative rate $\\beta = P(\\neg O | R)$. The true-positive rate is thus $P(O | R) = 1-\\beta$.\n    Using the law of total probability, the observed probability of response $p_{\\mathrm{obs}}(D)$ is:\n    $$ p_{\\mathrm{obs}}(D) = P(O|D) = P(O | R, D) P(R|D) + P(O | \\neg R, D) P(\\neg R|D) $$\n    Given that misclassification is dose-independent:\n    $$ p_{\\mathrm{obs}}(D) = (1-\\beta) p_{\\mathrm{true}}(D) + \\alpha (1 - p_{\\mathrm{true}}(D)) $$\n    This simplifies to a linear transformation of the true probability:\n    $$ p_{\\mathrm{obs}}(D) = \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D) $$\n\n*   **Apparent ED50 Derivation:**\n    The apparent ED50, $D_{50,\\mathrm{app}}$, is the dose at which the observed response probability is $0.5$. We set $p_{\\mathrm{obs}}(D_{50,\\mathrm{app}}) = 0.5$:\n    $$ 0.5 = \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D_{50,\\mathrm{app}}) $$\n    Solving for the true probability at this apparent dose:\n    $$ p_{\\mathrm{true}}(D_{50,\\mathrm{app}}) = \\frac{0.5 - \\alpha}{1 - \\alpha - \\beta} $$\n    Let's denote this required true probability as $p^* = p_{\\mathrm{true}}(D_{50,\\mathrm{app}})$. We now substitute this into the true probability model:\n    $$ \\ln\\left(\\frac{p_{\\mathrm{true}}(D_{50,\\mathrm{app}})}{1-p_{\\mathrm{true}}(D_{50,\\mathrm{app}})}\\right) = b \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) $$\n    $$ \\ln\\left(\\frac{p^*}{1-p^*}\\right) = b \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) $$\n    The term $\\frac{p^*}{1-p^*}$ is calculated as:\n    $$ \\frac{p^*}{1-p^*} = \\frac{\\frac{0.5 - \\alpha}{1 - \\alpha - \\beta}}{1 - \\frac{0.5 - \\alpha}{1 - \\alpha - \\beta}} = \\frac{0.5 - \\alpha}{(1 - \\alpha - \\beta) - (0.5 - \\alpha)} = \\frac{0.5 - \\alpha}{0.5 - \\beta} $$\n    Substituting this back into the equation:\n    $$ \\ln\\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right) = b \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) $$\n    Solving for $D_{50,\\mathrm{app}}$:\n    $$ \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) = \\frac{1}{b} \\ln\\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right) $$\n    $$ \\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}} = \\exp\\left[\\frac{1}{b} \\ln\\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)\\right] = \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b} $$\n    The final expression for the apparent ED50 is:\n    $$ D_{50,\\mathrm{app}} = D_{50,\\mathrm{true}} \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b} $$\n\n**Part 2: Justification and Interpretation**\n\n*   **Flattening of the Curve:**\n    The true probability $p_{\\mathrm{true}}(D)$ ranges over $(0, 1)$ as $D$ varies from $0$ to $\\infty$. The observed probability is $p_{\\mathrm{obs}}(D) = \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D)$.\n    At zero dose ($D \\to 0$), $p_{\\mathrm{true}}(D) \\to 0$, so $p_{\\mathrm{obs}}(D) \\to \\alpha$. At infinite dose ($D \\to \\infty$), $p_{\\mathrm{true}}(D) \\to 1$, so $p_{\\mathrm{obs}}(D) \\to \\alpha + (1-\\alpha-\\beta) = 1-\\beta$.\n    The range of observed probabilities is $(\\alpha, 1-\\beta)$. Given $0 < \\alpha$ and $0 < \\beta$, this range is smaller than $(0, 1)$. The lower asymptote is raised from $0$ to $\\alpha$, and the upper asymptote is lowered from $1$ to $1-\\beta$. This compression of the probability range is referred to as \"flattening\" of the dose-response curve.\n    Mathematically, the slope on the log-dose scale, $\\frac{dp}{d(\\ln D)}$, is also reduced.\n    $$ \\frac{d p_{\\mathrm{obs}}(D)}{d(\\ln D)} = \\frac{d}{d(\\ln D)} \\left[ \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D) \\right] = (1 - \\alpha - \\beta) \\frac{d p_{\\mathrm{true}}(D)}{d(\\ln D)} $$\n    Since $0 < \\alpha+\\beta < 1$, the scaling factor $1 - \\alpha - \\beta$ is between $0$ and $1$. Thus, the slope of the observed curve is strictly less than the slope of the true curve at every dose $D$, confirming the curve is flattened.\n\n*   **Shift in ED50 for $\\beta > \\alpha$:**\n    The ratio of apparent to true ED50 is $\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}} = \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b}$.\n    We are given that the slope $b$ is a positive constant. The constraints $0 < \\alpha < 0.5$ and $0 < \\beta < 0.5$ ensure that both the numerator ($0.5-\\alpha$) and the denominator ($0.5-\\beta$) are positive.\n    If $\\beta > \\alpha$, then $-\\beta < -\\alpha$. Adding $0.5$ to both sides gives $0.5 - \\beta < 0.5 - \\alpha$.\n    Since both sides are positive, dividing by the smaller term $(0.5-\\beta)$ yields:\n    $$ \\frac{0.5 - \\alpha}{0.5 - \\beta} > 1 $$\n    Because the base of the power is greater than $1$ and the exponent $1/b$ is positive, the entire factor is greater than $1$:\n    $$ \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b} > 1 $$\n    This implies $D_{50,\\mathrm{app}} > D_{50,\\mathrm{true}}$.\n    Intuitively, if the false-negative rate $\\beta$ exceeds the false-positive rate $\\alpha$, there is a net bias towards observing a non-response. At the true ED50 ($D_{50,\\mathrm{true}}$), where $p_{\\mathrm{true}}=0.5$, the observed probability is $p_{\\mathrm{obs}}(D_{50,\\mathrm{true}}) = 0.5 + 0.5(\\alpha - \\beta)$. If $\\beta > \\alpha$, then $p_{\\mathrm{obs}}(D_{50,\\mathrm{true}}) < 0.5$. Since $p_{\\mathrm{obs}}(D)$ is a monotonically increasing function of dose, a higher dose is required to reach the apparent $50\\%$ response level, leading to an overestimation of the ED50.\n\n**Part 3: Numerical Calculation**\n\nWe are given the following values:\n*   $D_{50,\\mathrm{true}} = 4.0$\n*   $b = 2.0$\n*   $\\alpha = 0.05$\n*   $\\beta = 0.20$\n\nUsing the derived formula:\n$$ D_{50,\\mathrm{app}} = 4.0 \\left(\\frac{0.5 - 0.05}{0.5 - 0.20}\\right)^{1/2.0} $$\n$$ D_{50,\\mathrm{app}} = 4.0 \\left(\\frac{0.45}{0.30}\\right)^{0.5} $$\n$$ D_{50,\\mathrm{app}} = 4.0 \\left(1.5\\right)^{0.5} $$\n$$ D_{50,\\mathrm{app}} = 4.0 \\sqrt{1.5} $$\n$$ D_{50,\\mathrm{app}} \\approx 4.0 \\times 1.22474487... $$\n$$ D_{50,\\mathrm{app}} \\approx 4.89897948... $$\nRounding the result to four significant figures gives $4.899$.", "answer": "$$\n\\boxed{4.899}\n$$", "id": "4984840"}]}