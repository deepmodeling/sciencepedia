{"hands_on_practices": [{"introduction": "The relationship between ligand concentration and receptor occupancy is a cornerstone of pharmacology, often described by the simple Hill-Langmuir equation. However, this equation rests on the assumption that the concentration of free ligand at equilibrium is roughly equal to the total ligand added, which is only true when receptors are sparse. This practice [@problem_id:4987288] challenges you to explore what happens when this assumption breaks down—a situation known as ligand depletion—by deriving the fractional occupancy from first principles and comparing it to the simplified model. This exercise is crucial for developing a rigorous understanding of binding assays and avoiding common analytical pitfalls.", "problem": "A single-site ligand–receptor system is studied at equilibrium under conditions where the ligand can significantly deplete due to binding. A ligand of interest binds a receptor in a $1:1$ stoichiometry with a dissociation constant ($K_D$) of $10\\,\\text{nM}$. An experiment is performed with a total ligand concentration $[L_T] = 5\\,\\text{nM}$ and a total receptor concentration $[R_T] = 20\\,\\text{nM}$. Assume no cooperativity, a single binding site per receptor, and negligible non-specific binding. Work from mass action equilibrium and conservation laws to determine the fractional occupancy $ \\theta \\equiv \\frac{[RL]}{[R_T]} $ in two cases:\n- Case A (no depletion approximation): treat the free ligand concentration as equal to the total ligand concentration.\n- Case B (depletion-corrected): enforce conservation of mass for both ligand and receptor at equilibrium when solving for the bound complex.\n\nBegin from the definitions and fundamental equilibrium relations only (for example, the law of mass action and conservation of mass), not from any pre-derived binding equations. Express both answers as unitless decimals. Round each fractional occupancy to four significant figures. Report your answers in the order: Case A (no depletion), then Case B (depletion-corrected). The final answer must be provided as a row vector using parentheses notation as specified, and the entries must be the two rounded values (unitless).", "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- System: Single-site ligand-receptor system at equilibrium.\n- Stoichiometry: $1:1$.\n- Dissociation constant: $K_D = 10\\,\\text{nM}$.\n- Total ligand concentration: $[L_T] = 5\\,\\text{nM}$.\n- Total receptor concentration: $[R_T] = 20\\,\\text{nM}$.\n- Assumptions: No cooperativity, single binding site per receptor, negligible non-specific binding.\n- Task: Determine the fractional occupancy $\\theta \\equiv \\frac{[RL]}{[R_T]}$ for two cases.\n- Case A: No depletion approximation, where free ligand concentration at equilibrium $[L]$ is assumed to be equal to total ligand concentration, i.e., $[L] = [L_T]$.\n- Case B: Depletion-corrected, where mass conservation for both ligand and receptor is enforced.\n- Methodological constraint: The derivation must start from fundamental equilibrium relations (law of mass action and conservation of mass).\n- Reporting format: Results as unitless decimals, rounded to four significant figures, in a row vector for Case A and Case B, respectively.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in receptor pharmacology and biophysical chemistry. It is based on the well-established law of mass action and principles of mass conservation. The given concentrations and the dissociation constant are physically realistic for biological systems. The problem is well-posed, providing all necessary parameters and clear, objective definitions for the two cases to be analyzed. It lacks any of the flaws listed in the validation criteria: it is not scientifically unsound, non-formalizable, incomplete, unrealistic, or ill-posed. The problem requires a rigorous application of fundamental principles to derive solutions for two distinct, well-defined scenarios and compare them, which is a meaningful scientific exercise.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe fundamental relationship governing the interaction between a ligand ($L$) and a receptor ($R$) to form a complex ($RL$) is the reversible reaction:\n$$ R + L \\rightleftharpoons RL $$\nAt equilibrium, the law of mass action defines the dissociation constant, $K_D$, as:\n$$ K_D = \\frac{[R][L]}{[RL]} $$\nwhere $[R]$, $[L]$, and $[RL]$ are the concentrations of free receptor, free ligand, and receptor-ligand complex at equilibrium, respectively.\n\nThe conservation of mass for the total receptor concentration, $[R_T]$, and total ligand concentration, $[L_T]$, is given by:\n$$ [R_T] = [R] + [RL] $$\n$$ [L_T] = [L] + [RL] $$\nThe fractional occupancy, $\\theta$, is defined as the fraction of total receptors that are bound to a ligand:\n$$ \\theta = \\frac{[RL]}{[R_T]} $$\n\n### Case A: No Depletion Approximation\nIn this case, we assume that the amount of ligand that binds to the receptor is negligible compared to the total amount of ligand. This allows the approximation that the free ligand concentration at equilibrium is equal to the total ligand concentration:\n$$ [L] \\approx [L_T] $$\nThis approximation is generally valid only when $[R_T] \\ll [L_T]$. We are asked to apply it regardless of its validity.\n\nWe begin with the definition of $K_D$:\n$$ K_D = \\frac{[R][L]}{[RL]} $$\nSubstitute $[R] = [R_T] - [RL]$ from the receptor conservation equation:\n$$ K_D = \\frac{([R_T] - [RL])[L]}{[RL]} $$\nNow apply the no-depletion approximation, $[L] = [L_T]$:\n$$ K_D = \\frac{([R_T] - [RL])[L_T]}{[RL]} $$\nWe solve for the complex concentration, $[RL]$:\n$$ K_D [RL] = [R_T][L_T] - [RL][L_T] $$\n$$ K_D [RL] + [RL][L_T] = [R_T][L_T] $$\n$$ [RL](K_D + [L_T]) = [R_T][L_T] $$\n$$ [RL] = \\frac{[R_T][L_T]}{K_D + [L_T]} $$\nThe fractional occupancy for Case A, $\\theta_A$, is then:\n$$ \\theta_A = \\frac{[RL]}{[R_T]} = \\frac{1}{[R_T]} \\left( \\frac{[R_T][L_T]}{K_D + [L_T]} \\right) = \\frac{[L_T]}{K_D + [L_T]} $$\nThis is the standard Hill-Langmuir equation. We substitute the given values: $[L_T] = 5\\,\\text{nM}$ and $K_D = 10\\,\\text{nM}$.\n$$ \\theta_A = \\frac{5}{10 + 5} = \\frac{5}{15} = \\frac{1}{3} $$\nAs a decimal rounded to four significant figures, this is:\n$$ \\theta_A \\approx 0.3333 $$\n\n### Case B: Depletion-Corrected Calculation\nIn this case, we do not make the approximation $[L] \\approx [L_T]$. We must account for the depletion of the free ligand pool due to binding. We use the complete system of equations.\n\nFrom the conservation laws, we express the free concentrations in terms of the complex concentration $[RL]$:\n$$ [R] = [R_T] - [RL] $$\n$$ [L] = [L_T] - [RL] $$\nSubstitute these expressions into the $K_D$ equation:\n$$ K_D = \\frac{([R_T] - [RL])([L_T] - [RL])}{[RL]} $$\nThis equation must be solved for $[RL]$. We rearrange it into a standard quadratic form, $ax^2 + bx + c = 0$, with $x = [RL]$.\n$$ K_D [RL] = ([R_T] - [RL])([L_T] - [RL]) $$\n$$ K_D [RL] = [R_T][L_T] - [R_T][RL] - [L_T][RL] + [RL]^2 $$\n$$ 0 = [RL]^2 - ([R_T] + [L_T] + K_D)[RL] + [R_T][L_T] $$\nWe solve for $[RL]$ using the quadratic formula:\n$$ [RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\nwhere $a=1$, $b = -([R_T] + [L_T] + K_D)$, and $c = [R_T][L_T]$.\n$$ [RL] = \\frac{([R_T] + [L_T] + K_D) \\pm \\sqrt{([R_T] + [L_T] + K_D)^2 - 4[R_T][L_T]}}{2} $$\nTo choose the correct root, we consider the physical constraint that the concentration of the complex, $[RL]$, cannot exceed either the total ligand concentration, $[L_T]$, or the total receptor concentration, $[R_T]$. The positive root leads to a value of $[RL]$ that is greater than $[R_T] + [L_T]$, which is physically impossible. Therefore, we must select the negative root.\n\nSubstitute the given values: $[L_T] = 5\\,\\text{nM}$, $[R_T] = 20\\,\\text{nM}$, and $K_D = 10\\,\\text{nM}$.\nFirst, calculate the term $([R_T] + [L_T] + K_D)$:\n$$ [R_T] + [L_T] + K_D = 20 + 5 + 10 = 35\\,\\text{nM} $$\nNext, calculate the term $4[R_T][L_T]$:\n$$ 4[R_T][L_T] = 4(20)(5) = 400\\,\\text{nM}^2 $$\nNow, substitute these into the solution for $[RL]$:\n$$ [RL] = \\frac{35 - \\sqrt{(35)^2 - 400}}{2} = \\frac{35 - \\sqrt{1225 - 400}}{2} = \\frac{35 - \\sqrt{825}}{2}\\,\\text{nM} $$\nNumerically evaluate $[RL]$:\n$$ [RL] \\approx \\frac{35 - 28.722813}{2} = \\frac{6.277187}{2} \\approx 3.13859\\,\\text{nM} $$\nFinally, calculate the fractional occupancy for Case B, $\\theta_B$:\n$$ \\theta_B = \\frac{[RL]}{[R_T]} = \\frac{3.13859\\,\\text{nM}}{20\\,\\text{nM}} \\approx 0.1569295 $$\nAs a decimal rounded to four significant figures, this is:\n$$ \\theta_B \\approx 0.1569 $$\nThe significant difference between $\\theta_A$ ($0.3333$) and $\\theta_B$ ($0.1569$) highlights the failure of the no-depletion approximation in this regime, where the total receptor concentration is not negligible compared to the total ligand concentration.\n\nThe final answers for Case A and Case B, rounded to four significant figures, are $0.3333$ and $0.1569$, respectively.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3333  0.1569\n\\end{pmatrix}\n}\n$$", "id": "4987288"}, {"introduction": "While the equilibrium dissociation constant, $K_D$, quantifies the overall affinity of a ligand for its receptor, it doesn't reveal the full story of their interaction. The same $K_D$ can result from a fast-on/fast-off interaction or a slow-on/slow-off one, with profound implications for a drug's pharmacological profile. This exercise [@problem_id:4987319] will guide you through the process of dissecting $K_D$ into its kinetic components—the association rate constant ($k_{\\text{on}}$) and the dissociation rate constant ($k_{\\text{off}}$)—using time-course data. Mastering this analysis allows you to understand a drug's residence time and its dynamic behavior at the target.", "problem": "A receptor $\\mathrm{R}$ and ligand $\\mathrm{L}$ interact via a simple reversible bimolecular binding under conditions where the ligand concentration is effectively constant during the measurement. The association time course shows that the complex concentration $[ \\mathrm{RL} ](t)$ reaches $63\\%$ of its equilibrium value at $t = 10$ $\\mathrm{s}$ when the ligand is held at $[ \\mathrm{L} ] = 30$ $\\mathrm{nM}$. An independent equilibrium experiment (for example, saturation binding) determines the dissociation constant $K_{D}$ to be $15$ $\\mathrm{nM}$. Assume a single binding site and that the system obeys the law of mass action with no competing processes.\n\nStarting only from core definitions and well-tested kinetic principles, use the information above to:\n- Estimate the observed association rate constant $k_{\\text{obs}}$ from the time-course fraction approaching equilibrium.\n- Deduce the microscopic association rate constant $k_{\\text{on}}$ and the microscopic dissociation rate constant $k_{\\text{off}}$ consistent with the given $K_{D}$.\n\nRound each rate constant to three significant figures. Express $k_{\\text{obs}}$ and $k_{\\text{off}}$ in $\\mathrm{s}^{-1}$ and express $k_{\\text{on}}$ in $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$. Report the three values in the order $\\left( k_{\\text{obs}},\\, k_{\\text{on}},\\, k_{\\text{off}} \\right)$.", "solution": "The reversible binding of a receptor $\\mathrm{R}$ and ligand $\\mathrm{L}$ forming the complex $\\mathrm{RL}$ under the law of mass action is described by\n$$\n\\frac{d[ \\mathrm{RL} ]}{dt} \\;=\\; k_{\\text{on}} [ \\mathrm{R} ][ \\mathrm{L} ] \\;-\\; k_{\\text{off}} [ \\mathrm{RL} ].\n$$\nUnder experimental conditions where $[ \\mathrm{L} ]$ is held constant and large relative to the receptor, pseudo-first-order kinetics apply. The receptor balance is $[ \\mathrm{R} ] = [ \\mathrm{R} ]_{T} - [ \\mathrm{RL} ]$, where $[ \\mathrm{R} ]_{T}$ is the total receptor concentration. Substituting gives\n$$\n\\frac{d[ \\mathrm{RL} ]}{dt} \\;=\\; k_{\\text{on}} \\left( [ \\mathrm{R} ]_{T} - [ \\mathrm{RL} ] \\right) [ \\mathrm{L} ] \\;-\\; k_{\\text{off}} [ \\mathrm{RL} ] \\;=\\; k_{\\text{on}} [ \\mathrm{R} ]_{T} [ \\mathrm{L} ] \\;-\\; \\left( k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}} \\right) [ \\mathrm{RL} ].\n$$\nThis is a first-order linear differential equation with solution approaching equilibrium exponentially. The equilibrium complex satisfies\n$$\n0 \\;=\\; k_{\\text{on}} [ \\mathrm{R} ]_{T} [ \\mathrm{L} ] \\;-\\; \\left( k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}} \\right) [ \\mathrm{RL} ]_{\\text{eq}},\n$$\nso\n$$\n[ \\mathrm{RL} ]_{\\text{eq}} \\;=\\; \\frac{k_{\\text{on}} [ \\mathrm{R} ]_{T} [ \\mathrm{L} ]}{k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}} }.\n$$\nThe deviation from equilibrium decays with the rate constant\n$$\nk_{\\text{obs}} \\;=\\; k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}},\n$$\nand the time course of association can be written as\n$$\n[ \\mathrm{RL} ](t) \\;=\\; [ \\mathrm{RL} ]_{\\text{eq}} \\left( 1 - \\exp\\!\\left( - k_{\\text{obs}} t \\right) \\right),\n$$\nassuming the system starts with $[ \\mathrm{RL} ](0) = 0$. Therefore, the fraction of equilibrium attained at time $t$ is\n$$\nf(t) \\;\\equiv\\; \\frac{[ \\mathrm{RL} ](t)}{[ \\mathrm{RL} ]_{\\text{eq}}} \\;=\\; 1 - \\exp\\!\\left( - k_{\\text{obs}} t \\right).\n$$\n\nWe are told that $f(10\\,\\mathrm{s}) = 0.63$ at $[ \\mathrm{L} ] = 30\\,\\mathrm{nM}$. Solving for $k_{\\text{obs}}$:\n$$\n0.63 \\;=\\; 1 - \\exp\\!\\left( - k_{\\text{obs}} \\cdot 10 \\right)\n\\;\\;\\Rightarrow\\;\\;\n\\exp\\!\\left( - k_{\\text{obs}} \\cdot 10 \\right) \\;=\\; 0.37\n\\;\\;\\Rightarrow\\;\\;\nk_{\\text{obs}} \\;=\\; -\\frac{1}{10} \\ln(0.37).\n$$\nCompute $k_{\\text{obs}}$ numerically:\n$$\n\\ln(0.37) \\approx -0.994252273 \\;\\;\\Rightarrow\\;\\; k_{\\text{obs}} \\approx \\frac{0.994252273}{10} \\;=\\; 0.0994252273 \\;\\mathrm{s}^{-1}.\n$$\nRounded to three significant figures:\n$$\nk_{\\text{obs}} \\approx 0.0994 \\;\\mathrm{s}^{-1}.\n$$\n\nTo deduce $k_{\\text{on}}$ and $k_{\\text{off}}$, use the dissociation constant $K_{D}$ defined by\n$$\nK_{D} \\;=\\; \\frac{k_{\\text{off}}}{k_{\\text{on}}}.\n$$\nTogether with $k_{\\text{obs}} = k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}}$, we eliminate $k_{\\text{off}}$:\n$$\nk_{\\text{obs}} \\;=\\; k_{\\text{on}} [ \\mathrm{L} ] + K_{D} k_{\\text{on}} \\;=\\; k_{\\text{on}} \\left( [ \\mathrm{L} ] + K_{D} \\right),\n$$\nhence\n$$\nk_{\\text{on}} \\;=\\; \\frac{k_{\\text{obs}}}{[ \\mathrm{L} ] + K_{D}}.\n$$\nWith $[ \\mathrm{L} ] = 30\\,\\mathrm{nM} = 30 \\times 10^{-9}\\,\\mathrm{M}$ and $K_{D} = 15\\,\\mathrm{nM} = 15 \\times 10^{-9}\\,\\mathrm{M}$,\n$$\n[ \\mathrm{L} ] + K_{D} \\;=\\; (30 + 15) \\times 10^{-9}\\,\\mathrm{M} \\;=\\; 45 \\times 10^{-9}\\,\\mathrm{M}.\n$$\nTherefore,\n$$\nk_{\\text{on}} \\;=\\; \\frac{0.0994252273\\,\\mathrm{s}^{-1}}{45 \\times 10^{-9}\\,\\mathrm{M}} \\;=\\; 2.20944949 \\times 10^{6}\\,\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}.\n$$\nRounded to three significant figures:\n$$\nk_{\\text{on}} \\approx 2.21 \\times 10^{6}\\,\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}.\n$$\nFinally, obtain $k_{\\text{off}}$ using $k_{\\text{off}} = K_{D} \\, k_{\\text{on}}$:\n$$\nk_{\\text{off}} \\;=\\; (15 \\times 10^{-9}\\,\\mathrm{M}) \\times \\left( 2.20944949 \\times 10^{6}\\,\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1} \\right)\n\\;=\\; 0.0331417424 \\,\\mathrm{s}^{-1}.\n$$\nRounded to three significant figures:\n$$\nk_{\\text{off}} \\approx 0.0331 \\,\\mathrm{s}^{-1}.\n$$\n\nAs a consistency check, verify $k_{\\text{obs}} \\approx k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}}$ numerically:\n$$\nk_{\\text{on}} [ \\mathrm{L} ] \\;=\\; (2.20944949 \\times 10^{6}) \\times (30 \\times 10^{-9}) \\;\\mathrm{s}^{-1} \\;=\\; 0.0662834847 \\,\\mathrm{s}^{-1},\n$$\nand\n$$\n0.0662834847 + 0.0331417424 \\;\\approx\\; 0.0994252271 \\,\\mathrm{s}^{-1},\n$$\nmatching $k_{\\text{obs}}$ prior to rounding. Thus the derived $k_{\\text{on}}$ and $k_{\\text{off}}$ are consistent with both the time-course and the equilibrium dissociation constant.", "answer": "$$\\boxed{\\begin{pmatrix}0.0994  2.21 \\times 10^{6}  0.0331\\end{pmatrix}}$$", "id": "4987319"}, {"introduction": "Understanding how drugs interact is fundamental to pharmacology, and one of the most important interactions is antagonism, where one compound blocks the action of another. Schild analysis is the gold-standard method for quantifying a competitive antagonist's affinity ($K_B$) and verifying its mechanism of action. In this hands-on computational practice [@problem_id:4987342], you will implement a complete Schild regression, from transforming raw dose-ratio data to performing statistical tests and classifying the type of antagonism. This exercise bridges theoretical receptor theory with the practical data analysis skills essential for modern drug characterization.", "problem": "A pharmacology laboratory investigates receptor theory by quantifying how a reversible antagonist shifts the concentration–response relationship of an agonist. The goal is to construct a Schild plot and, from first principles, estimate the antagonist dissociation constant for the antagonist ($K_B$), test whether the Schild slope deviates from $1$, and interpret the mechanism of antagonism as competitive, noncompetitive, or insurmountable.\n\nStart from the following fundamental bases:\n- The Law of Mass Action states that the rate of formation of a receptor–ligand complex is proportional to the product of the free receptor and free ligand concentrations, and at equilibrium the fraction of occupied receptors depends on the dissociation constants.\n- Under purely competitive antagonism, increasing antagonist concentration increases the agonist concentration required to produce the same effect by reducing the fraction of receptors available to the agonist without changing the maximal response. Parallel rightward shifts in the agonist concentration–response curve are observed.\n- The dose ratio ($DR$) is defined as the ratio of the agonist concentration required to produce a specified effect in the presence of antagonist to that in its absence. By definition, $DR \\ge 1$.\n- The Schild plot maps $\\log_{10}(DR - 1)$ against $\\log_{10}([B])$, where $[B]$ is the antagonist concentration. A linear relationship with slope $1$ is consistent with simple competitive antagonism, and the intercept is related to $K_B$.\n\nYour task is to implement the following in a single program:\n1. For each provided test case, construct the Schild plot coordinates by computing $x_i = \\log_{10}([B_i])$ and $y_i = \\log_{10}(DR_i - 1)$ for all data points $i$.\n2. Perform ordinary least squares linear regression of $y$ on $x$ to estimate the slope $m$ and intercept $c$ of the line $y = mx + c$.\n3. Using the residual variance of the regression and the standard error of the slope, perform a two-sided $t$-test of the null hypothesis $H_0: m = 1$ at significance level $\\alpha = 0.05$, and compute the $p$-value.\n4. Estimate the antagonist dissociation constant $K_B$ in molar units ($\\mathrm{M}$) as follows:\n   - If the null hypothesis $H_0$ is not rejected (the slope is not significantly different from $1$), use the intercept to estimate $K_B$ under competitive assumptions.\n   - If $H_0$ is rejected (the slope is significantly different from $1$), report the concentration corresponding to a twofold agonist shift (the $x$-intercept where $y = 0$), understanding that this is an apparent estimate consistent with deviations from ideal competitive behavior.\n5. Interpret antagonism using the following decision rule with the provided maximal response ratios:\n   - Let $r_{\\max}$ denote the minimal observed maximal response ratio across antagonist concentrations (dimensionless, relative to control). If $r_{\\max}  0.9$, classify as insurmountable antagonism.\n   - Else, if the slope is not significantly different from $1$, classify as competitive antagonism.\n   - Else, classify as noncompetitive antagonism.\n6. For numerical outputs, express $K_B$ in $\\mathrm{M}$ and round all reported floats to six decimal places.\n\nTest suite:\nProvide the following three test cases, each defined by antagonist concentrations (in $\\mathrm{M}$), dose ratios $DR$ (dimensionless), and maximal response ratios $R_{\\max}$ (dimensionless):\n- Case A (expected to be consistent with competitive antagonism with small experimental variability):\n  - $[B] = [1.0 \\times 10^{-9}, 3.0 \\times 10^{-9}, 1.0 \\times 10^{-8}, 3.0 \\times 10^{-8}, 1.0 \\times 10^{-7}]$\n  - $DR = [1.105, 1.29, 2.02, 3.90, 11.20]$\n  - $R_{\\max} = [1.00, 0.99, 1.01, 0.98, 1.00]$\n- Case B (expected to be insurmountable with sublinear Schild slope and reduced maxima):\n  - $[B] = [1.0 \\times 10^{-9}, 3.0 \\times 10^{-9}, 1.0 \\times 10^{-8}, 3.0 \\times 10^{-8}, 1.0 \\times 10^{-7}]$\n  - $DR = [1.042, 1.081, 1.197, 1.435, 2.010]$\n  - $R_{\\max} = [0.95, 0.90, 0.82, 0.70, 0.50]$\n- Case C (expected to be noncompetitive with superlinear Schild slope but unchanged maxima):\n  - $[B] = [1.0 \\times 10^{-9}, 3.0 \\times 10^{-9}, 1.0 \\times 10^{-8}, 3.0 \\times 10^{-8}, 1.0 \\times 10^{-7}]$\n  - $DR = [1.015, 1.048, 1.242, 2.005, 5.75]$\n  - $R_{\\max} = [1.00, 0.99, 1.00, 0.99, 0.98]$\n\nAnswer specification and units:\n- Report $K_B$ in $\\mathrm{M}$.\n- All floating-point outputs must be rounded to six decimal places.\n- The slope deviation test must use a two-sided $t$-test with $\\alpha = 0.05$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of per-case results, where each per-case result is the list:\n$[m, p, K_B, \\text{dev}, \\text{code}]$\nwith $m$ the estimated slope (float), $p$ the $p$-value of the test $m = 1$ (float), $K_B$ in $\\mathrm{M}$ (float), $\\text{dev}$ a boolean indicating whether the slope significantly deviates from $1$ at $\\alpha = 0.05$, and $\\text{code}$ an integer interpretation code using the mapping $0 \\rightarrow$ competitive, $1 \\rightarrow$ noncompetitive, $2 \\rightarrow$ insurmountable. The entire output must be a single line showing a comma-separated Python-style list of these per-case lists, such as:\n$[[m_1,p_1,K_{B,1},\\text{dev}_1,\\text{code}_1],[m_2,p_2,K_{B,2},\\text{dev}_2,\\text{code}_2],[m_3,p_3,K_{B,3},\\text{dev}_3,\\text{code}_3]]$.", "solution": "The problem requires a thorough analysis of agonist-antagonist interaction data using Schild regression, a fundamental technique in pharmacology for characterizing receptor antagonism. The analysis involves several steps: data transformation, linear regression, statistical hypothesis testing, parameter estimation, and classification of the antagonism mechanism. The entire process is grounded in the principles of receptor theory and the law of mass action.\n\nThe theoretical basis for this analysis is the Schild equation, which describes the relationship between the concentration of a competitive antagonist, $[B]$, and the dose ratio, $DR$. The dose ratio is the factor by which the agonist concentration must be increased to produce the same response as in the absence of the antagonist. For a simple, reversible, competitive antagonist, the relationship is given by the Gaddum-Schild equation:\n$$\nDR = 1 + \\frac{[B]}{K_B}\n$$\nwhere $K_B$ is the equilibrium dissociation constant of the antagonist-receptor complex. A lower $K_B$ signifies a higher affinity of the antagonist for the receptor.\n\nTo facilitate linear analysis, this equation is rearranged and logarithmically transformed. Subtracting $1$ from both sides and taking the base-10 logarithm yields the Schild equation:\n$$\n\\log_{10}(DR - 1) = \\log_{10}\\left(\\frac{[B]}{K_B}\\right) = \\log_{10}([B]) - \\log_{10}(K_B)\n$$\nThis equation is in the form of a straight line, $y = mx + c$, where:\n- The dependent variable is $y = \\log_{10}(DR - 1)$.\n- The independent variable is $x = \\log_{10}([B])$.\n- The theoretical slope is $m = 1$.\n- The theoretical y-intercept is $c = -\\log_{10}(K_B)$.\n\nThe analysis proceeds through the following computational steps for each test case:\n\n1.  **Data Transformation**: For each given pair of antagonist concentration $[B_i]$ and dose ratio $DR_i$, we compute the coordinates for the Schild plot:\n    $$\n    x_i = \\log_{10}([B_i]) \\quad \\text{and} \\quad y_i = \\log_{10}(DR_i - 1)\n    $$\n    The problem statement guarantees that $DR_i > 1$, ensuring that $y_i$ is well-defined.\n\n2.  **Ordinary Least Squares (OLS) Linear Regression**: We fit a line $y = mx + c$ to the transformed data points $(x_i, y_i)$. The slope $m$ and intercept $c$ are estimated by minimizing the sum of the squared vertical distances between the data points and the regression line. The formulas for the OLS estimators are:\n    $$\n    m = \\frac{n \\sum_{i=1}^{n} x_i y_i - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n \\sum_{i=1}^{n} x_i^2 - (\\sum_{i=1}^{n} x_i)^2}\n    $$\n    $$\n    c = \\bar{y} - m\\bar{x} = \\frac{1}{n}\\left(\\sum_{i=1}^{n} y_i - m \\sum_{i=1}^{n} x_i\\right)\n    $$\n    where $n$ is the number of data points.\n\n3.  **Hypothesis Test for the Slope**: A key diagnostic for competitive antagonism is whether the empirical slope $m$ is consistent with the theoretical value of $1$. We perform a two-sided t-test for the null hypothesis $H_0: m = 1$ against the alternative $H_a: m \\neq 1$.\n    - The test statistic is calculated as:\n      $$\n      t = \\frac{m - 1}{SE(m)}\n      $$\n      where $SE(m)$ is the standard error of the slope.\n    - $SE(m)$ is derived from the variance of the residuals. The residuals are $e_i = y_i - (mx_i + c)$. The estimate of the error variance is:\n      $$\n      s_e^2 = \\frac{\\sum_{i=1}^{n} e_i^2}{n-2}\n      $$\n      where $df = n-2$ are the degrees of freedom.\n    - The standard error of the slope is then:\n      $$\n      SE(m) = \\sqrt{\\frac{s_e^2}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}}\n      $$\n    - The $p$-value is computed from the t-distribution with $n-2$ degrees of freedom: $p = 2 \\cdot P(T_{n-2} > |t|)$. The slope is considered to deviate significantly from $1$ if $p  \\alpha$ for a significance level $\\alpha = 0.05$.\n\n4.  **Estimation of the Antagonist Dissociation Constant ($K_B$)**: The method for estimating $K_B$ depends on the outcome of the hypothesis test.\n    - If $H_0$ is not rejected ($p \\ge 0.05$), we assume the simple competitive antagonism model holds. The estimated intercept $c$ is an estimate of $-\\log_{10}(K_B)$. Therefore, $K_B$ is calculated as:\n      $$\n      K_B = 10^{-c}\n      $$\n    - If $H_0$ is rejected ($p  0.05$), the slope deviates from unity, indicating a departure from the ideal model. In this case, the problem specifies estimating an apparent affinity parameter. This value is the antagonist concentration that produces a dose ratio of $2$. This corresponds to the point on the regression line where $y = \\log_{10}(2-1) = 0$. The x-intercept of the Schild plot gives $\\log_{10}([B])$ at this point.\n      $$\n      0 = m \\log_{10}([B]) + c \\implies \\log_{10}([B]) = -\\frac{c}{m}\n      $$\n      This concentration, an apparent $K_B$, is calculated as:\n      $$\n      K_B = 10^{-c/m}\n      $$\n\n5.  **Interpretation of the Antagonism Mechanism**: A decision rule is applied to classify the antagonism.\n    - First, we check for surmountability. If the minimal observed maximal response ratio, $r_{\\max} = \\min(R_{\\max})$, is less than $0.9$, the antagonist is considered to have depressed the maximal possible response, characteristic of **insurmountable antagonism** (code $2$).\n    - If the maximal response is preserved ($r_{\\max} \\ge 0.9$), the classification depends on the Schild slope. If the slope is not significantly different from $1$ ($p \\ge 0.05$), the a priori model is validated, and the mechanism is classified as **competitive antagonism** (code $0$).\n    - If the maximal response is preserved but the slope significantly deviates from $1$ ($p  0.05$), the mechanism is classified as **noncompetitive antagonism** (code $1$). This category includes allosteric modulation or other complex interactions that alter the agonist's affinity or efficacy in a manner not described by the simple competitive model, but without depressing the maximum response to the levels of insurmountability.\n\nAll floating-point numerical results ($m$, $p$, and $K_B$) are rounded to six decimal places as required. This structured, principle-based approach allows for a rigorous quantitative characterization of the antagonist's pharmacological profile from the provided experimental data.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to process test cases for Schild analysis.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Competitive Antagonism\n        {\n            \"B\": np.array([1.0e-9, 3.0e-9, 1.0e-8, 3.0e-8, 1.0e-7]),\n            \"DR\": np.array([1.105, 1.29, 2.02, 3.90, 11.20]),\n            \"R_max\": np.array([1.00, 0.99, 1.01, 0.98, 1.00])\n        },\n        # Case B: Insurmountable Antagonism\n        {\n            \"B\": np.array([1.0e-9, 3.0e-9, 1.0e-8, 3.0e-8, 1.0e-7]),\n            \"DR\": np.array([1.042, 1.081, 1.197, 1.435, 2.010]),\n            \"R_max\": np.array([0.95, 0.90, 0.82, 0.70, 0.50])\n        },\n        # Case C: Noncompetitive Antagonism\n        {\n            \"B\": np.array([1.0e-9, 3.0e-9, 1.0e-8, 3.0e-8, 1.0e-7]),\n            \"DR\": np.array([1.015, 1.048, 1.242, 2.005, 5.75]),\n            \"R_max\": np.array([1.00, 0.99, 1.00, 0.99, 0.98])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_schild_data(case[\"B\"], case[\"DR\"], case[\"R_max\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\ndef analyze_schild_data(B_conc, DR, R_max):\n    \"\"\"\n    Performs Schild regression and analysis for a single dataset.\n\n    Args:\n        B_conc (np.ndarray): Antagonist concentrations in M.\n        DR (np.ndarray): Dose ratios (dimensionless).\n        R_max (np.ndarray): Maximal response ratios (dimensionless).\n\n    Returns:\n        list: A list containing [m, p, K_B, dev, code].\n    \"\"\"\n    \n    # 1. Construct Schild plot coordinates\n    # x = log10([B]), y = log10(DR - 1)\n    x = np.log10(B_conc)\n    y = np.log10(DR - 1)\n    \n    # 2. Perform ordinary least squares linear regression from first principles\n    n = len(x)\n    sum_x = np.sum(x)\n    sum_y = np.sum(y)\n    sum_xy = np.sum(x * y)\n    sum_x2 = np.sum(x * x)\n    \n    # Slope (m) and intercept (c)\n    m_numerator = n * sum_xy - sum_x * sum_y\n    m_denominator = n * sum_x2 - sum_x**2\n    m = m_numerator / m_denominator\n    \n    c = (sum_y - m * sum_x) / n\n    \n    # 3. Perform a t-test of the null hypothesis H0: m = 1\n    # Calculate residuals and related statistics\n    y_pred = m * x + c\n    residuals = y - y_pred\n    ss_res = np.sum(residuals**2)\n    df = n - 2  # degrees of freedom\n    \n    # Handle case where df is 0 or less, although n=5 guarantees df=3\n    if df = 0:\n        p_value = np.nan\n    else:\n        # Variance of residuals\n        s_e2 = ss_res / df\n        # Sum of squares of x\n        ss_xx = np.sum((x - np.mean(x))**2)\n        # Standard error of the slope\n        se_m = np.sqrt(s_e2 / ss_xx)\n        \n        # t-statistic for H0: m=1\n        t_stat = (m - 1.0) / se_m\n        \n        # Two-sided p-value from t-distribution\n        p_value = 2 * stats.t.sf(np.abs(t_stat), df)\n\n    alpha = 0.05\n    dev = p_value  alpha\n\n    # 4. Estimate the antagonist dissociation constant (K_B)\n    if not dev:\n        # If slope is not significantly different from 1, assume competitive model\n        # c = -log10(K_B) = K_B = 10^(-c)\n        K_B = 10**(-c)\n    else:\n        # If slope deviates, find x-intercept (where y=0, i.e., DR=2)\n        # 0 = m*log10([B]) + c = log10([B]) = -c/m = [B] = 10^(-c/m)\n        if m != 0:\n            K_B = 10**(-c / m)\n        else: # Avoid division by zero, though unlikely in this context.\n            K_B = np.inf\n\n\n    # 5. Interpret antagonism using the decision rule\n    r_max_min = np.min(R_max)\n    if r_max_min  0.9:\n        # Insurmountable if max response is suppressed\n        code = 2\n    elif not dev:\n        # Competitive if max response is preserved and slope is ~1\n        code = 0\n    else:\n        # Noncompetitive if max response is preserved but slope deviates from 1\n        code = 1\n\n    # 6. Format numerical outputs rounded to six decimal places\n    m_rounded = round(m, 6)\n    p_rounded = round(p_value, 6)\n    KB_rounded = round(K_B, 6)\n    \n    return [m_rounded, p_rounded, KB_rounded, dev, code]\n\nsolve()\n```", "id": "4987342"}]}