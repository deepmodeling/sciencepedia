{"hands_on_practices": [{"introduction": "Accurate assessment is the foundation of all nutritional interventions. The weight-for-height z-score ($WHZ$) is a cornerstone metric, but its derivation is often treated as a black box. This exercise demystifies the process by guiding you through the derivation of the z-score formula from the WHO's Lambda-Mu-Sigma ($LMS$) method, providing a deep, statistical understanding of how raw measurements are transformed into universally comparable standard scores. [@problem_id:5177154]", "problem": "A pediatric nutrition team in a low-resource district clinic relies on anthropometry and the World Health Organization (WHO) 2006 Child Growth Standards to triage children for acute malnutrition. The standards use the Lambda–Mu–Sigma (LMS) method to construct normalized scores for strictly positive anthropometric measures. Let $X$ denote a strictly positive child anthropometric variable (for example, weight), and let $M$ denote the reference median at a given age or height, $L$ denote the Box–Cox power parameter that addresses skewness, and $S$ denote the generalized coefficient of variation (scale parameter) at that stratum. Starting from the Box–Cox power transformation applied to the normalized variable $X/M$ and the assumption that the transformed, scaled variable is approximately standard normal at the reference stratum, derive the expression for the standard score $z$ for the case $L \\neq 0$ in terms of $X$, $M$, $L$, and $S$.\n\nThen, using your derived expression, compute the Weight-for-Height $z$-score (WHZ) for a child with weight $x = 9.0$ kilograms and length (height) $80$ centimeters, given the WHO reference parameters at height $80$ centimeters are $L = -0.1$, $M = 10.2$ kilograms, and $S = 0.09$. Express the final $z$-score as a pure number (unitless). Round your final numerical answer to four significant figures.", "solution": "The user has provided a problem that requires the derivation of the formula for a $z$-score using the Lambda-Mu-Sigma (LMS) method and its subsequent application to calculate a specific Weight-for-Height $z$-score (WHZ).\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Methodology**: The World Health Organization (WHO) $2006$ Child Growth Standards, using the LMS method.\n-   **Variables and Parameters**:\n    -   $X$: A strictly positive child anthropometric variable (measurement).\n    -   $M$: The reference median for the variable $X$ at a given age or height.\n    -   $L$: The Box–Cox power parameter for skewness.\n    -   $S$: The generalized coefficient of variation (scale parameter).\n    -   $z$: The standard score.\n-   **Assumptions**:\n    1.  The case is $L \\neq 0$.\n    2.  The Box-Cox power transformation is applied to the normalized variable $X/M$.\n    3.  The transformed, scaled variable is approximately standard normal.\n-   **Task 1 (Derivation)**: Derive the expression for $z$ in terms of $X$, $M$, $L$, and $S$.\n-   **Task 2 (Calculation)**:\n    -   Compute the WHZ for a child with weight $x = 9.0$ kilograms and length $80$ centimeters.\n    -   The reference parameters at height $80$ centimeters are given as: $L = -0.1$, $M = 10.2$ kilograms, and $S = 0.09$.\n    -   The final numerical answer must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria:\n-   **Scientifically Grounded**: The problem is based on the WHO LMS method, a standard and widely accepted statistical technique in pediatrics and public health for assessing child growth. The Box-Cox transformation is a fundamental statistical tool. The problem is scientifically sound.\n-   **Well-Posed**: The problem is clearly stated. It requests a standard derivation followed by a calculation for which all necessary data ($X$, $L$, $M$, $S$) are provided. A unique, stable, and meaningful solution exists.\n-   **Objective**: The problem is stated in precise, quantitative, and objective language, free of any subjective or ambiguous terminology.\n-   **Flaw Check**: The problem does not violate any of the invalidity criteria. It is factually sound, formalizable, complete, realistic, and well-structured. The provided numerical values are plausible for the given context.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be provided.\n\n### Solution\n\nThe goal is to derive the expression for the standard score, $z$, and then calculate its value for the given data.\n\n**Part 1: Derivation of the $z$-score formula**\n\nThe standard score, or $z$-score, of a random variable is defined as the number of standard deviations by which the value of a raw score is above or below the mean of the distribution. If a variable $Y$ has a mean $\\mu_Y$ and a standard deviation $\\sigma_Y$, its $z$-score is given by $z = (Y - \\mu_Y) / \\sigma_Y$. The resulting $z$-score will have a mean of $0$ and a standard deviation of $1$.\n\nThe LMS method is designed for anthropometric data, which are often skewed. The method transforms the data to remove skewness and approximate a normal distribution.\n\n$1$. We start with the child's measurement, a strictly positive variable denoted by $X$. This measurement is first normalized by the reference median for the stratum (e.g., age or height), $M$. The normalized variable is $X/M$.\n\n$2$. The Box-Cox power transformation is applied to this normalized variable. For a parameter $L \\neq 0$, the transformation of a variable $y$ is given by $(y^L - 1)/L$. Applying this to $y = X/M$, we obtain a new variable, let's call it $Y_{trans}$:\n$$\nY_{trans} = \\frac{(X/M)^L - 1}{L}\n$$\nThis transformation is designed such that the resulting variable $Y_{trans}$ has a distribution that is approximately normal.\n\n$3$. We need to determine the mean and standard deviation of $Y_{trans}$. The parameter $M$ is the median of the distribution of $X$. For a measurement $X=M$, the value of $X/M$ is $1$. The transformed value is:\n$$\nY_{trans} \\bigg|_{X=M} = \\frac{(M/M)^L - 1}{L} = \\frac{1^L - 1}{L} = \\frac{1 - 1}{L} = 0\n$$\nSince the transformation to $Y_{trans}$ results in an approximately normal (and therefore symmetric) distribution, its mean is equal to its median. Thus, the mean of $Y_{trans}$ is $\\mu_{Y_{trans}} = 0$.\n\n$4$. The parameter $S$ in the LMS method is the generalized coefficient of variation, which is defined to be the standard deviation of the transformed variable $Y_{trans}$. Therefore, the standard deviation of $Y_{trans}$ is $\\sigma_{Y_{trans}} = S$.\n\n$5$. Now we can calculate the standard score, $z$, for the measurement $X$. The $z$-score is obtained by standardizing the transformed variable $Y_{trans}$. Using the general formula for a $z$-score:\n$$\nz = \\frac{Y_{trans} - \\mu_{Y_{trans}}}{\\sigma_{Y_{trans}}}\n$$\nSubstituting the expressions for $Y_{trans}$, its mean, and its standard deviation:\n$$\nz = \\frac{\\left(\\frac{(X/M)^L - 1}{L}\\right) - 0}{S}\n$$\n\n$6$. Simplifying this expression gives the formula for the $z$-score in the LMS method for $L \\neq 0$:\n$$\nz = \\frac{(X/M)^L - 1}{LS}\n$$\nThis completes the derivation.\n\n**Part 2: Calculation of the Weight-for-Height $z$-score (WHZ)**\n\nWe are given the following values:\n-   Child's weight (the measurement $X$): $x = 9.0$ kilograms. Note that the problem uses $x$ for the specific value of $X$.\n-   Reference median weight for the child's height ($M$): $M = 10.2$ kilograms.\n-   Box-Cox power parameter ($L$): $L = -0.1$.\n-   Generalized coefficient of variation ($S$): $S = 0.09$.\n\nWe substitute these values into the derived formula:\n$$\nz = \\frac{(x/M)^L - 1}{LS} = \\frac{(9.0/10.2)^{-0.1} - 1}{(-0.1)(0.09)}\n$$\nFirst, we compute the denominator:\n$$\nLS = (-0.1)(0.09) = -0.009\n$$\nNext, we compute the numerator. The ratio $x/M$ is:\n$$\n\\frac{x}{M} = \\frac{9.0}{10.2} \\approx 0.88235294...\n$$\nNow, we raise this to the power of $L = -0.1$:\n$$\n\\left(\\frac{x}{M}\\right)^L \\approx (0.88235294...)^{-0.1} \\approx 1.01259508...\n$$\nSubtracting $1$ from this value gives the numerator:\n$$\n\\left(\\frac{x}{M}\\right)^L - 1 \\approx 1.01259508... - 1 = 0.01259508...\n$$\nFinally, we compute the $z$-score by dividing the numerator by the denominator:\n$$\nz = \\frac{0.01259508...}{-0.009} \\approx -1.3994533...\n$$\nThe problem requires rounding the final answer to four significant figures. The first four significant figures are $1$, $3$, $9$, $9$. The fifth significant digit is $4$. Since $4 < 5$, we do not round up the last digit.\nTherefore, the WHZ score is $-1.399$.", "answer": "$$\\boxed{-1.399}$$", "id": "5177154"}, {"introduction": "Once a child is identified as growth-faltering, the challenge shifts to designing effective, practical interventions with locally available resources. A critical strategy is to increase the energy density of complementary foods, as young children have small stomach capacities. This problem simulates a core task for field practitioners: calculating the precise amount of a high-energy ingredient needed to fortify a local porridge, thereby translating nutritional principles into a life-saving recipe. [@problem_id:5177152]", "problem": "A community health worker in a rural pediatric clinic prepares complementary food for a mildly wasted child aged $12$ months using a locally milled maize porridge. The porridge portion to be offered weighs $200\\,\\mathrm{g}$ and has an energy density of $0.8\\,\\mathrm{kcal}\\,\\mathrm{g}^{-1}$. To improve catch-up growth within realistic feeding volumes, the worker plans to increase the porridge’s energy density to $1.2\\,\\mathrm{kcal}\\,\\mathrm{g}^{-1}$ by mixing in locally available vegetable oil, which has an energy density of $9\\,\\mathrm{kcal}\\,\\mathrm{g}^{-1}$. Assume that mass is additive on mixing and that energy content is additive across ingredients. Using the definition of energy density as total energy divided by total mass, determine the mass of oil, $x$, in grams that must be added to the $200\\,\\mathrm{g}$ porridge to achieve the target energy density. Express your final answer in grams and round your answer to three significant figures.", "solution": "The problem is subjected to validation and is deemed scientifically grounded, well-posed, objective, and complete. The provided data are realistic for the context of pediatric nutrition. The assumptions of additive mass and energy are standard for formulating such mixture problems. Therefore, a formal solution can be derived.\n\nLet $m_p$ be the initial mass of the porridge and $\\rho_{E,p}$ be its energy density. The values given are:\n$m_p = 200\\,\\mathrm{g}$\n$\\rho_{E,p} = 0.8\\,\\mathrm{kcal}\\,\\mathrm{g}^{-1}$\n\nLet $x$ be the unknown mass of vegetable oil to be added, and let $\\rho_{E,oil}$ be its energy density. The given value is:\n$\\rho_{E,oil} = 9\\,\\mathrm{kcal}\\,\\mathrm{g}^{-1}$\n\nThe target energy density for the final mixture is $\\rho_{E,mix}$, with the value:\n$\\rho_{E,mix} = 1.2\\,\\mathrm{kcal}\\,\\mathrm{g}^{-1}$\n\nThe problem defines energy density as total energy divided by total mass. Thus, for any component, its total energy $E$ can be calculated from its mass $m$ and energy density $\\rho_{E}$ as $E = m \\times \\rho_{E}$.\n\nThe initial energy content of the porridge, $E_p$, is:\n$$E_p = m_p \\times \\rho_{E,p}$$\n\nThe energy content of the added oil, $E_{oil}$, is:\n$$E_{oil} = x \\times \\rho_{E,oil}$$\n\nAccording to the problem statement, both mass and energy are additive.\nThe total mass of the final mixture, $m_{mix}$, is the sum of the mass of the porridge and the mass of the oil:\n$$m_{mix} = m_p + x$$\n\nThe total energy of the final mixture, $E_{mix}$, is the sum of the energy of the porridge and the energy of the oil:\n$$E_{mix} = E_p + E_{oil} = (m_p \\times \\rho_{E,p}) + (x \\times \\rho_{E,oil})$$\n\nThe energy density of the final mixture is defined as the total energy of the mixture divided by its total mass:\n$$\\rho_{E,mix} = \\frac{E_{mix}}{m_{mix}} = \\frac{(m_p \\times \\rho_{E,p}) + (x \\times \\rho_{E,oil})}{m_p + x}$$\n\nWe are given all values in this equation except for $x$, which we must determine. We can substitute the given values into the equation:\n$$1.2 = \\frac{(200 \\times 0.8) + (x \\times 9)}{200 + x}$$\n$$1.2 = \\frac{160 + 9x}{200 + x}$$\n\nTo solve for $x$, we first multiply both sides by the denominator $(200 + x)$:\n$$1.2 \\times (200 + x) = 160 + 9x$$\n$$240 + 1.2x = 160 + 9x$$\n\nNext, we rearrange the equation to isolate the terms containing $x$ on one side and the constant terms on the other:\n$$240 - 160 = 9x - 1.2x$$\n$$80 = (9 - 1.2)x$$\n$$80 = 7.8x$$\n\nFinally, we solve for $x$ by dividing by $7.8$:\n$$x = \\frac{80}{7.8}$$\n$$x \\approx 10.25641\\,\\mathrm{g}$$\n\nThe problem requires the final answer to be rounded to three significant figures. The first three significant figures are $1$, $0$, and $2$. The fourth significant figure is $5$, so we round up the third significant figure.\n$$x \\approx 10.3\\,\\mathrm{g}$$\nThus, $10.3\\,\\mathrm{g}$ of oil must be added to the porridge.", "answer": "$$\\boxed{10.3}$$", "id": "5177152"}, {"introduction": "While individual care is paramount, effective public health programs must evaluate impact and forecast outcomes at a population level. This advanced practice introduces a powerful quantitative tool: the Markov chain model, which simulates the flow of children between different nutritional states over time. By analyzing this model, you will learn how to project the ultimate fate of a cohort under a given set of conditions and calculate critical epidemiological metrics, such as the expected time until an irreversible outcome, providing a stark, quantitative way to compare the effectiveness of different intervention strategies. [@problem_id:5177216]", "problem": "A health program in a low-resource pediatric setting is evaluating the impact of nutritional interventions on child nutrition states using a discrete-time Markov chain. The child-level nutrition states are Normal, Moderate Acute Malnutrition (MAM), Severe Acute Malnutrition (SAM), and Death. Let the time step be one month. Model the system as a finite-state Markov chain with state space $\\{0,1,2,3\\}$ where $0$ denotes Normal, $1$ denotes Moderate Acute Malnutrition (MAM), $2$ denotes Severe Acute Malnutrition (SAM), and $3$ denotes Death. State $3$ is absorbing, and states $0$, $1$, and $2$ are transient.\n\nLet $P$ be the $4 \\times 4$ row-stochastic transition matrix (each row sums to $1$) where $P_{ij}$ is the probability of transitioning from state $i$ to state $j$ in one month. Let the initial distribution over states be $p_0$, a row vector of length $4$ whose entries sum to $1$. Define the transient-state submatrix $Q$ as the $3 \\times 3$ principal submatrix of $P$ indexed by states $\\{0,1,2\\}$, and define $R$ as the $3 \\times 1$ submatrix containing probabilities from transient states to the absorbing state $3$. The limiting (steady-state) distribution is defined as $\\lim_{n \\to \\infty} p_0 P^n$. The expected time to absorption from initial distribution $p_0$ is defined as the expected number of months until the chain reaches state $3$ for the first time.\n\nStarting from the fundamental definitions of Markov chains and absorbing chains, and without assuming any shortcut formulas, derive a computational procedure to:\n- Compute the steady-state distribution $\\lim_{n \\to \\infty} p_0 P^n$.\n- Compute the expected time to absorption in months from $p_0$.\n\nFor absorbing chains with a single absorbing state, recall that the transient-state dynamics are governed by $Q$. Under the condition that the spectral radius of $Q$ is less than $1$, the fundamental matrix is $N = \\sum_{k=0}^{\\infty} Q^k = (I - Q)^{-1}$ where $I$ is the $3 \\times 3$ identity matrix. Use this fundamental base to derive the quantities required above. The expected time to absorption from each transient state $i$ is the $i$-th entry of $N \\mathbf{1}$, where $\\mathbf{1}$ is the $3 \\times 1$ vector of ones, and the expected time from $p_0$ is the dot product of the transient portion of $p_0$ with $N \\mathbf{1}$, expressed in months. The absorption probability into state $3$ from each transient state is given by the entries of $N R$; use this to compute the steady-state distribution $\\lim_{n \\to \\infty} p_0 P^n$.\n\nExpress the expected time to absorption in months, rounded to two decimal places. Express each entry of the steady-state distribution rounded to four decimal places. Angles are not involved. Percentages should not be used; express all probabilities as decimals.\n\nYour program must produce a single line of output containing the results for all provided test cases as a comma-separated list enclosed in square brackets. Each test case’s result must be a two-element list of the form $\\left[[v_0,v_1,v_2,v_3], T\\right]$ where $[v_0,v_1,v_2,v_3]$ is the steady-state distribution rounded to four decimal places and $T$ is the expected time to absorption rounded to two decimal places (in months). For example: $[[[0.0000,0.0000,0.0000,1.0000],12.34],\\ldots]$.\n\nTest Suite (all rows of each $P$ sum to $1$, state indexing $\\{0,1,2,3\\} = \\{\\text{Normal}, \\text{MAM}, \\text{SAM}, \\text{Death}\\}$, and the time step is $1$ month):\n- Case $1$ (baseline scenario, happy path):\n    - $P = \\begin{bmatrix}\n    0.93 & 0.055 & 0.01 & 0.005 \\\\\n    0.20 & 0.60 & 0.15 & 0.05 \\\\\n    0.05 & 0.25 & 0.45 & 0.25 \\\\\n    0 & 0 & 0 & 1\n    \\end{bmatrix}$,\n    - $p_0 = [1, 0, 0, 0]$.\n- Case $2$ (moderate intervention, improved recovery):\n    - $P = \\begin{bmatrix}\n    0.95 & 0.035 & 0.01 & 0.005 \\\\\n    0.35 & 0.45 & 0.17 & 0.03 \\\\\n    0.15 & 0.35 & 0.30 & 0.20 \\\\\n    0 & 0 & 0 & 1\n    \\end{bmatrix}$,\n    - $p_0 = [0, 1, 0, 0]$.\n- Case $3$ (strong intervention with therapeutic feeding, edge with long expected time):\n    - $P = \\begin{bmatrix}\n    0.96 & 0.028 & 0.007 & 0.005 \\\\\n    0.50 & 0.35 & 0.10 & 0.05 \\\\\n    0.25 & 0.45 & 0.20 & 0.10 \\\\\n    0 & 0 & 0 & 1\n    \\end{bmatrix}$,\n    - $p_0 = [0.7, 0.25, 0.05, 0.0]$.\n- Case $4$ (humanitarian crisis, boundary with high mortality):\n    - $P = \\begin{bmatrix}\n    0.88 & 0.08 & 0.02 & 0.02 \\\\\n    0.10 & 0.50 & 0.20 & 0.20 \\\\\n    0.02 & 0.18 & 0.40 & 0.40 \\\\\n    0 & 0 & 0 & 1\n    \\end{bmatrix}$,\n    - $p_0 = [0, 0, 1, 0]$.\n\nYour program must implement the general computational approach derived from first principles and produce the output in the exact format specified. No user input is required.", "solution": "The problem requires the derivation of a computational procedure for finding the steady-state distribution and the expected time to absorption for a discrete-time absorbing Markov chain, followed by its implementation. The derivation must proceed from fundamental principles.\n\nLet the state space be $S = \\{0, 1, 2, 3\\}$, where states $T = \\{0, 1, 2\\}$ are transient and state $A = \\{3\\}$ is an absorbing state. The process is governed by a $4 \\times 4$ row-stochastic transition matrix $P$. Given the partitioning of states into transient and absorbing sets, the matrix $P$ can be written in the canonical block form:\n$$\nP = \\begin{pmatrix} Q & R \\\\ \\mathbf{0}^T & 1 \\end{pmatrix}\n$$\nHere, $Q$ is the $3 \\times 3$ submatrix of transition probabilities between transient states. $R$ is the $3 \\times 1$ column vector of probabilities of transitioning from a transient state to the absorbing state $3$. $\\mathbf{0}^T$ is a $1 \\times 3$ row vector of zeros, representing the fact that there are no transitions out of the absorbing state. The bottom-right entry is $1$, indicating that once in the absorbing state, the process remains there. The initial state distribution is given by the row vector $p_0 = [p_{0,0}, p_{0,1}, p_{0,2}, p_{0,3}]$.\n\n**1. Derivation of the Steady-State Distribution**\n\nThe distribution of the system after $n$ time steps (months) is given by $p_n = p_0 P^n$. The steady-state distribution is $\\pi = \\lim_{n \\to \\infty} p_n$.\n\nThe $n$-th power of the block matrix $P$ is:\n$$\nP^n = \\begin{pmatrix} Q^n & (\\sum_{k=0}^{n-1} Q^k)R \\\\ \\mathbf{0}^T & 1 \\end{pmatrix}\n$$\nFor an absorbing Markov chain, the probability of eventually leaving the set of transient states is $1$, provided the absorbing state is reachable from all transient states. This implies that the spectral radius of $Q$, $\\rho(Q)$, is less than $1$. A fundamental result from linear algebra is that if $\\rho(Q) < 1$, then $\\lim_{n \\to \\infty} Q^n = \\mathbf{0}$, where $\\mathbf{0}$ is the zero matrix.\n\nLet the initial distribution be partitioned similarly to $P$: $p_0 = [p_{0,T}, p_{0,A}]$, where $p_{0,T} = [p_{0,0}, p_{0,1}, p_{0,2}]$ and $p_{0,A} = [p_{0,3}]$.\nThe distribution at step $n$ is $p_n = [p_{0,T}Q^n, p_{0,A} + p_{0,T}(\\sum_{k=0}^{n-1} Q^k)R]$.\n\nTaking the limit as $n \\to \\infty$:\n- The transient part of the distribution becomes $\\lim_{n \\to \\infty} p_{0,T}Q^n = p_{0,T}(\\lim_{n \\to \\infty} Q^n) = p_{0,T}\\mathbf{0} = [0, 0, 0]$.\n- This shows that the probability of being in any transient state approaches zero as time goes to infinity.\n- The absorbing part of the distribution becomes $p_{0,A} + p_{0,T}(\\sum_{k=0}^{\\infty} Q^k)R$.\n\nThe problem states that the fundamental matrix is $N = \\sum_{k=0}^{\\infty} Q^k = (I-Q)^{-1}$. The matrix $B=NR$ contains the probabilities of being absorbed into state $3$ starting from each of the transient states $\\{0, 1, 2\\}$.\nLet's analyze $B$. Since each row of $P$ must sum to $1$, for any transient state $i \\in T$, we have $\\sum_{j \\in T} P_{ij} + \\sum_{j \\in A} P_{ij} = 1$. In our notation, this is $\\sum_{j=0}^2 Q_{ij} + R_i = 1$. Let $\\mathbf{1}$ be a $3 \\times 1$ column vector of ones. This system of equations can be written as $Q\\mathbf{1} + R = \\mathbf{1}$, which implies $R = (I-Q)\\mathbf{1}$.\nNow, we can compute $B$:\n$$\nB = NR = (I-Q)^{-1} R = (I-Q)^{-1} (I-Q) \\mathbf{1} = I \\mathbf{1} = \\mathbf{1}\n$$\nThis confirms that the probability of being absorbed into state $3$ is $1$, regardless of the starting transient state. This is expected as there is only one absorbing state and it is reachable from all transient states.\n\nThe total probability mass in the absorbing state at steady-state is the initial probability $p_{0,A}$ plus the probability of all transient-starting mass eventually being absorbed, which is $p_{0,T}B$.\n$p_{0,T}B = [p_{0,0}, p_{0,1}, p_{0,2}] \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = p_{0,0} + p_{0,1} + p_{0,2}$.\nSo the final probability in state $3$ is $p_{0,3} + (p_{0,0} + p_{0,1} + p_{0,2}) = \\sum_{i=0}^3 p_{0,i} = 1$, since $p_0$ is a probability distribution.\n\nThus, the steady-state distribution $\\pi$ concentrates all probability mass in the absorbing state:\n$$\n\\pi = [0, 0, 0, 1]\n$$\nThis result is general for any single-absorbing-state Markov chain where the absorbing state is reachable.\n\n**2. Derivation of the Expected Time to Absorption**\n\nLet $t_i$ be the expected number of steps (months) to reach the absorbing state for the first time, starting from transient state $i \\in \\{0, 1, 2\\}$. We can derive $t_i$ using a first-step analysis.\nStarting from state $i$, we take one step. The process transitions to state $j$ with probability $P_{ij}$.\n- If $j$ is another transient state ($j \\in T$), the remaining expected time to absorption is $t_j$.\n- If $j$ is the absorbing state ($j=3$), the process has been absorbed, and the remaining time is $0$.\nThe expected time $t_i$ is $1$ (for the current step) plus the expected time from the next state.\n$$\nt_i = 1 + \\sum_{j \\in T} P_{ij} t_j + \\sum_{j \\in A} P_{ij} \\cdot 0\n$$\nSubstituting $Q_{ij}$ for $P_{ij}$ where $j \\in T$:\n$$\nt_i = 1 + \\sum_{j=0}^{2} Q_{ij} t_j\n$$\nThis gives a system of $3$ linear equations for the $3$ unknowns $\\{t_0, t_1, t_2\\}$. In matrix notation, let $\\mathbf{t} = [t_0, t_1, t_2]^T$ be the column vector of expected times, and $\\mathbf{1}$ be a $3 \\times 1$ column vector of ones. The system is:\n$$\n\\mathbf{t} = \\mathbf{1} + Q \\mathbf{t}\n$$\nRearranging the terms to solve for $\\mathbf{t}$:\n$$\n\\mathbf{t} - Q\\mathbf{t} = \\mathbf{1}\n$$\n$$\n(I - Q)\\mathbf{t} = \\mathbf{1}\n$$\nSince $\\rho(Q) < 1$, the matrix $(I-Q)$ is invertible. We can solve for $\\mathbf{t}$:\n$$\n\\mathbf{t} = (I - Q)^{-1} \\mathbf{1}\n$$\nUsing the definition of the fundamental matrix, $N = (I-Q)^{-1}$, we have derived the expression for the vector of expected absorption times from each transient state:\n$$\n\\mathbf{t} = N\\mathbf{1}\n$$\nThe overall expected time to absorption, $T$, starting from an initial distribution $p_0$, is the weighted average of the expected times from each starting state. If the process starts in a transient state $i$, the time to absorption is $t_i$. If it starts in the absorbing state $3$, the time to absorption is $0$.\n$$\nT = \\sum_{i=0}^{2} p_{0,i} \\cdot t_i + p_{0,3} \\cdot 0 = \\sum_{i=0}^{2} p_{0,i} \\cdot t_i\n$$\nLet $p_{0,T} = [p_{0,0}, p_{0,1}, p_{0,2}]$ be the row vector of initial probabilities for the transient states. The total expected time to absorption is the dot product:\n$$\nT = p_{0,T} \\cdot \\mathbf{t} = p_{0,T} (N\\mathbf{1})\n$$\n\n**3. Computational Procedure**\n\nBased on the derivations above, the computational algorithm for a given transition matrix $P$ and initial distribution $p_0$ is as follows:\n1.  From the $4 \\times 4$ matrix $P$, extract the $3 \\times 3$ transient-to-transient submatrix $Q = P[0:3, 0:3]$.\n2.  Construct the $3 \\times 3$ identity matrix, $I$.\n3.  Calculate the matrix $I-Q$.\n4.  Compute the fundamental matrix $N$ by inverting $I-Q$, i.e., $N = (I-Q)^{-1}$.\n5.  Construct a $3 \\times 1$ column vector of ones, $\\mathbf{1}$.\n6.  Calculate the vector of expected absorption times, $\\mathbf{t} = N\\mathbf{1}$.\n7.  From the initial distribution $p_0$, extract the sub-vector of transient probabilities $p_{0,T} = [p_{0,0}, p_{0,1}, p_{0,2}]$.\n8.  Calculate the total expected time to absorption, $T = p_{0,T} \\cdot \\mathbf{t}$, and round the result to two decimal places.\n9.  The steady-state distribution is $\\pi = [0, 0, 0, 1]$. Format the entries to four decimal places, resulting in $[0.0000, 0.0000, 0.0000, 1.0000]$.\n10. Combine the results into the specified list format: $[[v_0,v_1,v_2,v_3], T]$.\n\nThis procedure is scientifically sound, computationally well-defined, and directly follows from the fundamental principles of absorbing Markov chains.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Markov chain problem for the given test cases.\n    It calculates the steady-state distribution and expected time to absorption.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (baseline scenario, happy path)\n        (\n            np.array([\n                [0.93, 0.055, 0.01, 0.005],\n                [0.20, 0.60, 0.15, 0.05],\n                [0.05, 0.25, 0.45, 0.25],\n                [0.0, 0.0, 0.0, 1.0]\n            ]),\n            np.array([1.0, 0.0, 0.0, 0.0])\n        ),\n        # Case 2 (moderate intervention, improved recovery)\n        (\n            np.array([\n                [0.95, 0.035, 0.01, 0.005],\n                [0.35, 0.45, 0.17, 0.03],\n                [0.15, 0.35, 0.30, 0.20],\n                [0.0, 0.0, 0.0, 1.0]\n            ]),\n            np.array([0.0, 1.0, 0.0, 0.0])\n        ),\n        # Case 3 (strong intervention with therapeutic feeding, edge with long expected time)\n        (\n            np.array([\n                [0.96, 0.028, 0.007, 0.005],\n                [0.50, 0.35, 0.10, 0.05],\n                [0.25, 0.45, 0.20, 0.10],\n                [0.0, 0.0, 0.0, 1.0]\n            ]),\n            np.array([0.7, 0.25, 0.05, 0.0])\n        ),\n        # Case 4 (humanitarian crisis, boundary with high mortality)\n        (\n            np.array([\n                [0.88, 0.08, 0.02, 0.02],\n                [0.10, 0.50, 0.20, 0.20],\n                [0.02, 0.18, 0.40, 0.40],\n                [0.0, 0.0, 0.0, 1.0]\n            ]),\n            np.array([0.0, 0.0, 1.0, 0.0])\n        ),\n    ]\n\n    results = []\n    for P, p0 in test_cases:\n        # Extract the transient submatrix Q (3x3)\n        Q = P[0:3, 0:3]\n\n        # Define the identity matrix\n        I = np.identity(3)\n\n        # Calculate the fundamental matrix N = (I - Q)^-1\n        N = np.linalg.inv(I - Q)\n        \n        # Define the 3x1 vector of ones\n        ones_vec = np.ones((3, 1))\n        \n        # Calculate the vector of expected times to absorption from each transient state\n        # t = N * 1\n        t_vec = N @ ones_vec\n\n        # Extract the transient portion of the initial distribution p0\n        p0_T = p0[0:3]\n\n        # Calculate the overall expected time to absorption T\n        # T is the dot product of p0_T and t_vec\n        # The result of the matmul is a 1-element array, so we extract the scalar value.\n        T_expected = (p0_T @ t_vec)[0]\n\n        # Round the expected time to two decimal places\n        T_rounded = round(T_expected, 2)\n\n        # The steady-state distribution for a single absorbing state is always [0,0,0,1]\n        # when the absorbing state is reachable from all transient states.\n        steady_state_dist = [0.0, 0.0, 0.0, 1.0]\n\n        # Format the result as a string according to the problem specification.\n        # Format the vector with 4 decimal places.\n        steady_state_str = f\"[{','.join([f'{v:.4f}' for v in steady_state_dist])}]\"\n        # Format the expected time with 2 decimal places.\n        time_str = f\"{T_rounded:.2f}\"\n        \n        result_str = f\"[{steady_state_str},{time_str}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "5177216"}]}