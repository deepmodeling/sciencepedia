{"hands_on_practices": [{"introduction": "To understand the protective capacity of the oral immune system, it is crucial to quantify the total amount of Secretory IgA (SIgA) delivered into the oral cavity. This practice applies the fundamental principle of mass balance to calculate the total daily secretion rate of SIgA from various salivary glands. By analyzing a hypothetical scenario of hyposalivation, you will develop skills in calculating and interpreting changes in immune output, a key aspect of assessing oral health and disease [@problem_id:4772320].", "problem": "A patient’s whole saliva contains Secretory Immunoglobulin A (SIgA), which is produced by plasma cells in the salivary glands, transcytosed via the polymeric immunoglobulin receptor (pIgR), and released into saliva bound to the secretory component. For any salivary source, the instantaneous mass secretion rate of SIgA equals concentration times volumetric flow. Assume saliva arises from three sources: parotid, submandibular/sublingual, and minor mucosal glands. Let $C_i$ denote the SIgA concentration for source $i$ in $\\mathrm{mg/mL}$ and $F_i$ the volumetric flow for source $i$ in $\\mathrm{mL/min}$. The instantaneous total SIgA mass flow is $S_{\\mathrm{tot}}=\\sum_i C_i F_i$ in $\\mathrm{mg/min}$. The daily SIgA secretion is $S_{\\mathrm{day}}=S_{\\mathrm{tot}} \\times 1440$ in $\\mathrm{mg/day}$, since there are $1440$ minutes per day.\n\nYou are given the following physiologically plausible values before hyposalivation (baseline) and after hyposalivation:\n\n- Baseline:\n  - Parotid: $C_{\\mathrm{P},0}=0.12$ $\\mathrm{mg/mL}$, $F_{\\mathrm{P},0}=0.25$ $\\mathrm{mL/min}$.\n  - Submandibular/sublingual: $C_{\\mathrm{S},0}=0.28$ $\\mathrm{mg/mL}$, $F_{\\mathrm{S},0}=0.20$ $\\mathrm{mL/min}$.\n  - Minor glands: $C_{\\mathrm{M},0}=0.40$ $\\mathrm{mg/mL}$, $F_{\\mathrm{M},0}=0.05$ $\\mathrm{mL/min}$.\n- After hyposalivation:\n  - Parotid: $C_{\\mathrm{P},1}=0.09$ $\\mathrm{mg/mL}$, $F_{\\mathrm{P},1}=0.10$ $\\mathrm{mL/min}$.\n  - Submandibular/sublingual: $C_{\\mathrm{S},1}=0.18$ $\\mathrm{mg/mL}$, $F_{\\mathrm{S},1}=0.06$ $\\mathrm{mL/min}$.\n  - Minor glands: $C_{\\mathrm{M},1}=0.40$ $\\mathrm{mg/mL}$, $F_{\\mathrm{M},1}=0.025$ $\\mathrm{mL/min}$.\n\nUsing only the definition that mass secretion rate equals concentration times volumetric flow and appropriate unit conversion to daily secretion, compute the fold-change in daily SIgA secretion caused by hyposalivation, defined as $R=\\dfrac{S_{\\mathrm{day,post}}}{S_{\\mathrm{day,pre}}}$. Report $R$ as a decimal rounded to four significant figures. The final answer is dimensionless; do not include units.", "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information to compute a unique solution. The data provided are physiologically plausible, and the model is based on a standard mass balance equation. Therefore, the problem is valid and a solution can be derived.\n\nThe problem asks for the fold-change, $R$, in daily Secretory Immunoglobulin A (SIgA) secretion, defined as the ratio of the daily secretion after hyposalivation to the daily secretion at baseline. Let the subscripts 'pre' and 'post' denote the baseline and post-hyposalivation conditions, respectively.\n\nThe daily SIgA secretion is defined as $S_{\\mathrm{day}} = S_{\\mathrm{tot}} \\times 1440$, where $S_{\\mathrm{tot}}$ is the instantaneous total mass secretion rate and $1440$ is the number of minutes in a day. The fold-change $R$ is therefore:\n$$R = \\frac{S_{\\mathrm{day,post}}}{S_{\\mathrm{day,pre}}} = \\frac{S_{\\mathrm{tot,post}} \\times 1440}{S_{\\mathrm{tot,pre}} \\times 1440}$$\nThe conversion factor of $1440$ cancels out, simplifying the expression for $R$ to the ratio of the instantaneous total mass secretion rates:\n$$R = \\frac{S_{\\mathrm{tot,post}}}{S_{\\mathrm{tot,pre}}}$$\nThe instantaneous total mass secretion rate, $S_{\\mathrm{tot}}$, is the sum of the mass secretion rates from the three specified salivary gland sources: parotid (P), submandibular/sublingual (S), and minor mucosal glands (M). The rate for each source is the product of its SIgA concentration, $C_i$, and its volumetric flow rate, $F_i$.\n$$S_{\\mathrm{tot}} = \\sum_i C_i F_i = C_{\\mathrm{P}}F_{\\mathrm{P}} + C_{\\mathrm{S}}F_{\\mathrm{S}} + C_{\\mathrm{M}}F_{\\mathrm{M}}$$\n\nFirst, we calculate the instantaneous total mass secretion rate for the baseline (pre-hyposalivation) condition, $S_{\\mathrm{tot,pre}}$. The given values are:\n- Parotid: $C_{\\mathrm{P},0}=0.12 \\, \\mathrm{mg/mL}$, $F_{\\mathrm{P},0}=0.25 \\, \\mathrm{mL/min}$\n- Submandibular/sublingual: $C_{\\mathrm{S},0}=0.28 \\, \\mathrm{mg/mL}$, $F_{\\mathrm{S},0}=0.20 \\, \\mathrm{mL/min}$\n- Minor glands: $C_{\\mathrm{M},0}=0.40 \\, \\mathrm{mg/mL}$, $F_{\\mathrm{M},0}=0.05 \\, \\mathrm{mL/min}$\n\n$$S_{\\mathrm{tot,pre}} = C_{\\mathrm{P},0}F_{\\mathrm{P},0} + C_{\\mathrm{S},0}F_{\\mathrm{S},0} + C_{\\mathrm{M},0}F_{\\mathrm{M},0}$$\n$$S_{\\mathrm{tot,pre}} = (0.12)(0.25) + (0.28)(0.20) + (0.40)(0.05)$$\n$$S_{\\mathrm{tot,pre}} = 0.030 + 0.056 + 0.020$$\n$$S_{\\mathrm{tot,pre}} = 0.106 \\, \\mathrm{mg/min}$$\n\nNext, we calculate the instantaneous total mass secretion rate for the post-hyposalivation condition, $S_{\\mathrm{tot,post}}$. The given values are:\n- Parotid: $C_{\\mathrm{P},1}=0.09 \\, \\mathrm{mg/mL}$, $F_{\\mathrm{P},1}=0.10 \\, \\mathrm{mL/min}$\n- Submandibular/sublingual: $C_{\\mathrm{S},1}=0.18 \\, \\mathrm{mg/mL}$, $F_{\\mathrm{S},1}=0.06 \\, \\mathrm{mL/min}$\n- Minor glands: $C_{\\mathrm{M},1}=0.40 \\, \\mathrm{mg/mL}$, $F_{\\mathrm{M},1}=0.025 \\, \\mathrm{mL/min}$\n\n$$S_{\\mathrm{tot,post}} = C_{\\mathrm{P},1}F_{\\mathrm{P},1} + C_{\\mathrm{S},1}F_{\\mathrm{S},1} + C_{\\mathrm{M},1}F_{\\mathrm{M},1}$$\n$$S_{\\mathrm{tot,post}} = (0.09)(0.10) + (0.18)(0.06) + (0.40)(0.025)$$\n$$S_{\\mathrm{tot,post}} = 0.009 + 0.0108 + 0.010$$\n$$S_{\\mathrm{tot,post}} = 0.0298 \\, \\mathrm{mg/min}$$\n\nFinally, we compute the fold-change, $R$:\n$$R = \\frac{S_{\\mathrm{tot,post}}}{S_{\\mathrm{tot,pre}}} = \\frac{0.0298}{0.106}$$\n$$R \\approx 0.281132075...$$\nThe problem requires the result to be reported as a decimal rounded to four significant figures. The first four significant figures are $2$, $8$, $1$, and $1$. The fifth significant figure is $3$, so we round down.\n$$R \\approx 0.2811$$", "answer": "$$\\boxed{0.2811}$$", "id": "4772320"}, {"introduction": "Beyond just quantifying secretion, it is vital to understand how Secretory IgA (SIgA) performs its primary function: preventing microbial adhesion. This exercise models the neutralization of a bacterium by combining principles of biochemical binding kinetics with probability theory. You will use the dissociation constant ($K_D$) to determine the likelihood of SIgA binding to bacterial epitopes and then calculate the probability of successfully neutralizing the pathogen, providing a quantitative link between molecular interactions and immune protection [@problem_id:4772316].", "problem": "A saliva sample from an adult patient shows elevated levels of Secretory Immunoglobulin A (SIgA), and a surface plasmon resonance assay performed in whole saliva yields an apparent dissociation constant for SIgA binding to a Streptococcus mutans adhesin epitope of $K_{D}^{\\mathrm{app}} = 1.5 \\times 10^{-7}$ M under oral conditions. Assume the epitope behaves as a monovalent receptor for one paratope of the dimeric SIgA and that avidity effects are already captured in $K_{D}^{\\mathrm{app}}$. At the tooth–biofilm interface, the free SIgA concentration is estimated to be $C_{\\mathrm{free}} = 7.5 \\times 10^{-7}$ M. Each bacterium displays $N = 10$ identical, adhesion-critical epitopes whose individual occupations sterically block adhesion. Neutralization (i.e., functional blockade of adhesion to the acquired enamel pellicle) occurs when at least $m = 7$ of the $N$ epitopes are occupied by SIgA. The antigen density is sufficiently low that SIgA binding does not appreciably deplete the free SIgA pool, and the epitopes are independent and identically distributed with noncooperative occupancy.\n\nStarting from the law of mass action at equilibrium and the core definition of the dissociation constant, derive the fractional occupancy per epitope and then, under the stated independence assumption, compute the probability that a single bacterium is neutralized at these conditions.\n\nRound your final answer to four significant figures and express it as a unitless decimal.", "solution": "The problem requires the calculation of the probability that a single *Streptococcus mutans* bacterium is neutralized by Secretory Immunoglobulin A (SIgA) under specific conditions. This will be accomplished in two main steps: first, by deriving and calculating the fractional occupancy of a single bacterial adhesin epitope, and second, by using this occupancy to model the probability of neutralizing the entire bacterium.\n\nThe binding of a ligand, in this case, SIgA, to a receptor, an adhesin epitope, can be described as a reversible chemical equilibrium. Let $L$ represent the ligand (SIgA) and $R$ represent the receptor (epitope). The formation of the ligand-receptor complex, $LR$, is governed by the reaction:\n$$L + R \\rightleftharpoons LR$$\nAt equilibrium, the law of mass action defines the dissociation constant, $K_D$, as the ratio of the product of the concentrations of the reactants to the concentration of the product:\n$$K_D = \\frac{[L][R]}{[LR]}$$\nwhere $[L]$, $[R]$, and $[LR]$ are the molar concentrations of the free ligand, free receptor, and ligand-receptor complex, respectively.\n\nThe fractional occupancy, $\\theta$, is defined as the fraction of the total receptor population that is bound by the ligand:\n$$\\theta = \\frac{[LR]}{[R]_{\\mathrm{total}}}$$\nThe total concentration of receptors, $[R]_{\\mathrm{total}}$, is the sum of the concentrations of free and occupied receptors:\n$$[R]_{\\mathrm{total}} = [R] + [LR]$$\nTo express $\\theta$ in terms of measurable quantities, we first rearrange the expression for $K_D$ to solve for $[R]$:\n$$[R] = \\frac{K_D [LR]}{[L]}$$\nSubstituting this into the equation for $[R]_{\\mathrm{total}}$ gives:\n$$[R]_{\\mathrm{total}} = \\frac{K_D [LR]}{[L]} + [LR] = [LR] \\left( \\frac{K_D}{[L]} + 1 \\right) = [LR] \\left( \\frac{K_D + [L]}{[L]} \\right)$$\nFinally, substituting this expression for $[R]_{\\mathrm{total}}$ into the definition of $\\theta$ yields the Hill-Langmuir equation for non-cooperative binding:\n$$\\theta = \\frac{[LR]}{[LR] \\left( \\frac{K_D + [L]}{[L]} \\right)} = \\frac{[L]}{K_D + [L]}$$\nThe problem provides the necessary values: the apparent dissociation constant, $K_{D}^{\\mathrm{app}} = 1.5 \\times 10^{-7}$ M, and the free SIgA concentration, $C_{\\mathrm{free}} = 7.5 \\times 10^{-7}$ M. The problem states that the free SIgA pool is not significantly depleted by binding, so we can set $[L] = C_{\\mathrm{free}}$ and $K_D = K_{D}^{\\mathrm{app}}$.\nWe calculate the numerical value for the fractional occupancy of a single epitope:\n$$\\theta = \\frac{C_{\\mathrm{free}}}{K_{D}^{\\mathrm{app}} + C_{\\mathrm{free}}} = \\frac{7.5 \\times 10^{-7} \\, \\mathrm{M}}{1.5 \\times 10^{-7} \\, \\mathrm{M} + 7.5 \\times 10^{-7} \\, \\mathrm{M}} = \\frac{7.5 \\times 10^{-7}}{9.0 \\times 10^{-7}} = \\frac{7.5}{9.0} = \\frac{5}{6}$$\nThis value, $\\theta$, represents the probability that any single epitope is occupied by an SIgA molecule at equilibrium.\n\nThe problem states that each bacterium displays $N = 10$ identical, independent, and noncooperative epitopes. The occupation of an epitope is therefore a Bernoulli trial with a success probability of $p = \\theta = 5/6$. The total number of occupied epitopes, $X$, on a single bacterium follows a binomial distribution, $X \\sim B(n, p)$, with parameters $n=N=10$ and $p=\\theta=5/6$. The probability of exactly $k$ epitopes being occupied is given by the binomial probability mass function:\n$$P(X=k) = \\binom{n}{k} p^k (1-p)^{n-k} = \\binom{10}{k} \\left(\\frac{5}{6}\\right)^k \\left(1-\\frac{5}{6}\\right)^{10-k} = \\binom{10}{k} \\left(\\frac{5}{6}\\right)^k \\left(\\frac{1}{6}\\right)^{10-k}$$\nNeutralization is defined as the event where at least $m=7$ of the $N=10$ epitopes are occupied. The probability of neutralization, $P_{\\mathrm{neut}}$, is the probability $P(X \\geq 7)$. This is the sum of the probabilities for $X=7, 8, 9, \\text{ and } 10$:\n$$P_{\\mathrm{neut}} = P(X \\geq 7) = \\sum_{k=7}^{10} \\binom{10}{k} \\left(\\frac{5}{6}\\right)^k \\left(\\frac{1}{6}\\right)^{10-k}$$\nWe expand the sum:\n$$P_{\\mathrm{neut}} = \\binom{10}{7}\\left(\\frac{5}{6}\\right)^7\\left(\\frac{1}{6}\\right)^3 + \\binom{10}{8}\\left(\\frac{5}{6}\\right)^8\\left(\\frac{1}{6}\\right)^2 + \\binom{10}{9}\\left(\\frac{5}{6}\\right)^9\\left(\\frac{1}{6}\\right)^1 + \\binom{10}{10}\\left(\\frac{5}{6}\\right)^{10}\\left(\\frac{1}{6}\\right)^0$$\nThe binomial coefficients are calculated as:\n$\\binom{10}{7} = \\frac{10!}{7!3!} = 120$\n$\\binom{10}{8} = \\frac{10!}{8!2!} = 45$\n$\\binom{10}{9} = \\frac{10!}{9!1!} = 10$\n$\\binom{10}{10} = \\frac{10!}{10!0!} = 1$\n\nSubstituting these values into the expression for $P_{\\mathrm{neut}}$:\n$$P_{\\mathrm{neut}} = \\frac{1}{6^{10}} \\left[ \\binom{10}{7}5^7 + \\binom{10}{8}5^8 + \\binom{10}{9}5^9 + \\binom{10}{10}5^{10} \\right]$$\n$$P_{\\mathrm{neut}} = \\frac{1}{6^{10}} \\left[ 120(5^7) + 45(5^8) + 10(5^9) + 1(5^{10}) \\right]$$\n$$P_{\\mathrm{neut}} = \\frac{1}{60,466,176} \\left[ 120(78,125) + 45(390,625) + 10(1,953,125) + 1(9,765,625) \\right]$$\n$$P_{\\mathrm{neut}} = \\frac{1}{60,466,176} \\left[ 9,375,000 + 17,578,125 + 19,531,250 + 9,765,625 \\right]$$\n$$P_{\\mathrm{neut}} = \\frac{56,250,000}{60,466,176} \\approx 0.93026539$$\nRounding the result to four significant figures, as requested, gives the final probability of neutralization for a single bacterium.\n$$P_{\\mathrm{neut}} \\approx 0.9303$$", "answer": "$$\\boxed{0.9303}$$", "id": "4772316"}, {"introduction": "The transport of IgA across the mucosal barrier is a specialized cellular process mediated by the polymeric immunoglobulin receptor ($pIgR$). This advanced practice moves from physiology and function to the underlying cellular and molecular biology, introducing a computational approach to analyze single-cell RNA-sequencing data. By implementing a normalization and classification algorithm, you will learn to identify epithelial cells specialized for immune crosstalk, demonstrating how bioinformatics tools can provide deep insights into the architecture of the secretory immune system [@problem_id:4772291].", "problem": "You are given single-cell Ribonucleic Acid sequencing (scRNA-seq) count data for oral epithelial cells relevant to the Secretory Immunoglobulin A (SIgA) pathway. Polymeric Immunoglobulin Receptor (pIgR) mediates the transcytosis of polymeric Immunoglobulin A (IgA) across epithelial cells, and epithelial subsets that co-express pIgR and cytokine genes are hypothesized to be specialized for immune crosstalk. From first principles, treat observed scRNA count data as discrete observations whose magnitude is proportional to underlying transcript abundance, modulated by cell-specific library size. Derive a normalization that maps raw counts $x_{i g}$ for cell $i$ and gene $g$ to a dimensionless, variance-stabilized scale that permits direct comparison across cells. Then design a decision rule that identifies cells with co-expression of pIgR and cytokine genes.\n\nUse the following specification to ensure a mathematically precise and testable solution:\n\n1. Data structure and normalization:\n   - For each test case, you will receive an integer matrix $X \\in \\mathbb{N}_0^{n \\times m}$, where each row is a cell and each column is a gene. Let $x_{i g}$ be the count for cell $i$ and gene $g$.\n   - Let the per-cell library size be $L_i = \\sum_{g=1}^{m} x_{i g}$.\n   - Define a normalized, variance-stabilized expression by $$y_{i g} = \\log\\!\\big(1 + 1000 \\cdot \\frac{x_{i g}}{L_i}\\big).$$ This transformation yields values on a dimensionless scale.\n\n2. Gene sets:\n   - The pIgR gene is indexed by the name \"PIGR\".\n   - The cytokine gene set is $G_{\\mathrm{cyt}} = \\{\\text{IL6}, \\text{IL8}, \\text{TNF}, \\text{TGFB1}, \\text{CXCL1}\\}$.\n\n3. Decision rule for immune crosstalk-specialized cells:\n   - A cell $i$ is classified as specialized for immune crosstalk if and only if both conditions hold:\n     - $y_{i,\\mathrm{PIGR}} \\ge \\theta_P$ with $\\theta_P = \\ln(1 + 100)$.\n     - At least $k$ cytokine genes $g \\in G_{\\mathrm{cyt}}$ satisfy $y_{i g} \\ge \\theta_C$ with $\\theta_C = \\ln(1 + 30)$, where $k = 2$.\n   - The output per test case is the integer count of specialized cells.\n\n4. Test suite:\n   - Use the gene order $[\\text{\"PIGR\"}, \\text{\"IL6\"}, \\text{\"IL8\"}, \\text{\"TNF\"}, \\text{\"TGFB1\"}, \\text{\"CXCL1\"}, \\text{\"MUC1\"}]$ for all test cases. \"MUC1\" is included as an epithelial marker but is not used in the decision rule.\n   - Provide results for the following four test cases:\n     - Test case A (general mixture; each row sums to $1000$):\n       $$X_A = \\begin{bmatrix}\n       200 & 80 & 60 & 40 & 20 & 50 & 550 \\\\\n       150 & 50 & 30 & 35 & 25 & 40 & 670 \\\\\n       30 & 90 & 100 & 80 & 60 & 70 & 570 \\\\\n       5 & 0 & 0 & 0 & 0 & 0 & 995 \\\\\n       160 & 0 & 0 & 0 & 0 & 0 & 840 \\\\\n       120 & 35 & 31 & 0 & 0 & 0 & 814 \\\\\n       100 & 40 & 30 & 29 & 20 & 15 & 766 \\\\\n       0 & 0 & 0 & 0 & 0 & 0 & 1000\n       \\end{bmatrix}.$$\n     - Test case B (boundary values):\n       $$X_B = \\begin{bmatrix}\n       100 & 30 & 0 & 30 & 0 & 0 & 840 \\\\\n       100 & 30 & 0 & 0 & 0 & 0 & 870 \\\\\n       99 & 40 & 35 & 0 & 0 & 0 & 826\n       \\end{bmatrix}.$$\n     - Test case C (edge cases; zeros and high counts):\n       $$X_C = \\begin{bmatrix}\n       0 & 0 & 0 & 0 & 0 & 0 & 1000 \\\\\n       100 & 29 & 29 & 0 & 0 & 0 & 842 \\\\\n       500 & 30 & 30 & 0 & 0 & 0 & 440 \\\\\n       50 & 50 & 50 & 50 & 0 & 0 & 800\n       \\end{bmatrix}.$$\n     - Test case D (heterogeneous library sizes; sums not equal to $1000$):\n       $$X_D = \\begin{bmatrix}\n       80 & 24 & 24 & 0 & 0 & 0 & 672 \\\\\n       50 & 15 & 0 & 15 & 0 & 0 & 420 \\\\\n       90 & 26 & 26 & 0 & 0 & 0 & 758 \\\\\n       98 & 0 & 0 & 0 & 0 & 0 & 902\n       \\end{bmatrix}.$$\n\n5. Required final output format:\n   - Your program should produce a single line of output containing the counts of specialized cells for test cases $A$, $B$, $C$, and $D$ in that order, as a comma-separated list enclosed in square brackets, for example, $[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D]$.\n\nNo external input is permitted. All numerical answers are dimensionless and must be computed exactly by the program from the specified matrices. Angles are not involved in this problem. Percentages are not used; any ratios must be expressed as decimals within computations, but the final outputs are integers.", "solution": "The problem requires us to develop a computational method to identify a specific subset of oral epithelial cells from single-cell RNA sequencing (scRNA-seq) data. These cells are hypothesized to be specialized for immune crosstalk, a function characterized by the co-expression of the Polymeric Immunoglobulin Receptor gene ($PIGR$) and a set of cytokine genes. The solution involves data normalization followed by the application of a precise quantitative decision rule.\n\nFirst, we must formalize the given problem. We are provided with a count matrix $X \\in \\mathbb{N}_0^{n \\times m}$, where $x_{ig}$ is the non-negative integer count of transcripts for cell $i$ and gene $g$. Here, $n$ is the number of cells and $m$ is the number of genes.\n\nThe first step is data normalization. The raw counts $x_{ig}$ are not directly comparable across cells due to technical variations, most notably the sequencing depth or `library size`. The library size for cell $i$, denoted $L_i$, is the total number of transcript counts detected in that cell, given by $L_i = \\sum_{g=1}^{m} x_{ig}$. To account for this, we transform the raw counts into a normalized, variance-stabilized expression value $y_{ig}$. The specified transformation is:\n$$y_{i g} = \\log\\left(1 + 1000 \\cdot \\frac{x_{i g}}{L_i}\\right)$$\nHere, $\\log$ is interpreted as the natural logarithm ($\\ln$), consistent with the thresholds provided. This formula first normalizes the count $x_{ig}$ to a proportion of the total library size, scales it (similar to `counts per thousand`), and then applies a logarithmic transformation, a common technique for stabilizing variance and making the data distribution more symmetric. The addition of $1$ inside the logarithm prevents issues with genes having zero counts.\n\nThe second step is to apply the decision rule for identifying specialized cells. A cell $i$ is classified as specialized if and only if two conditions are met concurrently.\n\nCondition 1: High $PIGR$ Expression\nThe normalized expression of the $PIGR$ gene must meet or exceed a threshold $\\theta_P$. The gene for $PIGR$ is specified, and let's denote its index by $g = \\mathrm{PIGR}$. The condition is:\n$$y_{i, \\mathrm{PIGR}} \\ge \\theta_P, \\quad \\text{where} \\; \\theta_P = \\ln(1 + 100)$$\nBy substituting the definition of $y_{ig}$ and recognizing that the natural logarithm is a strictly increasing function, we can simplify this condition.\n$$\\ln\\left(1 + 1000 \\cdot \\frac{x_{i, \\mathrm{PIGR}}}{L_i}\\right) \\ge \\ln(101)$$\n$$\\implies 1 + 1000 \\cdot \\frac{x_{i, \\mathrm{PIGR}}}{L_i} \\ge 101$$\n$$\\implies 1000 \\cdot \\frac{x_{i, \\mathrm{PIGR}}}{L_i} \\ge 100$$\n$$\\implies \\frac{x_{i, \\mathrm{PIGR}}}{L_i} \\ge 0.1$$\nThis simplified inequality on the proportion of raw counts is computationally more direct and avoids potential floating-point inaccuracies associated with evaluating logarithms. A cell must express $PIGR$ at a level of at least $10\\%$ of its total transcriptome. For cases where $L_i=0$, all $x_{ig}$ must be $0$, and we define the ratio $\\frac{x_{ig}}{L_i}$ as $0$.\n\nCondition 2: Co-expression of Cytokine Genes\nThe cell must express a sufficient number of cytokine genes from the specified set $G_{\\mathrm{cyt}} = \\{\\text{IL6}, \\text{IL8}, \\text{TNF}, \\text{TGFB1}, \\text{CXCL1}\\}$. Specifically, at least $k=2$ of these genes must have a normalized expression that meets or exceeds a threshold $\\theta_C$. For any gene $g \\in G_{\\mathrm{cyt}}$, the condition is:\n$$y_{ig} \\ge \\theta_C, \\quad \\text{where} \\; \\theta_C = \\ln(1 + 30)$$\nSimilar to the $PIGR$ condition, this can be simplified:\n$$\\ln\\left(1 + 1000 \\cdot \\frac{x_{ig}}{L_i}\\right) \\ge \\ln(31)$$\n$$\\implies 1 + 1000 \\cdot \\frac{x_{ig}}{L_i} \\ge 31$$\n$$\\implies 1000 \\cdot \\fracx_{ig}}{L_i} \\ge 30$$\n$$\\implies \\frac{x_{ig}}{L_i} \\ge 0.03$$\nTo satisfy Condition 2, we must count the number of genes in $G_{\\mathrm{cyt}}$ for which this inequality holds for a given cell $i$. Let this count be $c_i$. The condition is then $c_i \\ge k=2$.\n\nA cell $i$ is therefore counted as specialized if and only if $\\frac{x_{i, \\mathrm{PIGR}}}{L_i} \\ge 0.1$ AND $c_i \\ge 2$.\n\nThe computational algorithm for a given count matrix $X$ is as follows:\n1.  Initialize a counter for specialized cells to $0$.\n2.  Identify the gene indices: $PIGR$ is at column $0$, and the five cytokine genes are at columns $1$ through $5$.\n3.  For each row (cell) $i$ of the matrix $X$:\n    a. Calculate the library size $L_i = \\sum_{g=0}^{m-1} x_{ig}$.\n    b. If $L_i > 0$:\n        i. Check the $PIGR$ condition: Is $x_{i,0} / L_i \\ge 0.1$?\n        ii. If the $PIGR$ condition is met, proceed to check the cytokine condition. Otherwise, cell $i$ is not specialized.\n        iii. Initialize a cytokine-pass counter, $c_i = 0$.\n        iv. For each cytokine gene $g \\in \\{1, 2, 3, 4, 5\\}$, check if $x_{ig} / L_i \\ge 0.03$. If true, increment $c_i$.\n        v. After checking all five cytokine genes, if $c_i \\ge 2$, then cell $i$ satisfies the second condition.\n        vi. If both the $PIGR$ and cytokine conditions are met, increment the total counter for specialized cells.\n4. Return the final total count.\n\nThis procedure will be applied to each of the four test case matrices ($X_A, X_B, X_C, X_D$) to produce the required output. For implementation, a vectorized approach using numerical libraries like NumPy is highly efficient. This involves calculating library sizes for all cells at once, then computing the ratios and applying the thresholds across the entire matrix and its relevant slices.", "answer": "[4,1,1,2]", "id": "4772291"}]}