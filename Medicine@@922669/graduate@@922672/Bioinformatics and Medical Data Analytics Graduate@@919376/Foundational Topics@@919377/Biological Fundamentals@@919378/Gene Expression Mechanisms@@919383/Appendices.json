{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will translate the central dogma of molecular biology into a simple but powerful mathematical model. This foundational exercise treats gene expression as a two-stage process—transcription and translation—governed by first-order kinetics. By deriving the steady-state protein abundance, you will develop a core understanding of how synthesis and degradation rates balance to determine cellular protein levels, and through sensitivity analysis [@problem_id:4566761], you will learn to quantify the relative importance of each kinetic parameter.", "problem": "Consider a single gene expressed in a homogeneous cell population under steady environmental conditions. Messenger Ribonucleic Acid (mRNA) transcripts are synthesized by transcription at a constant rate $r_{\\text{tx}}$ (mRNA molecules per hour). Each mRNA produces protein by translation at a constant rate $r_{\\text{tl}}$ (proteins per mRNA per hour). Both mRNA and protein are removed by first-order processes with decay rate constants $\\gamma_m$ (per hour) and $\\gamma_p$ (per hour), respectively. Let $M(t)$ denote the mRNA abundance (molecules) and $P(t)$ the protein abundance (molecules) at time $t$, and assume a well-mixed compartment with deterministic mass-action dynamics. Using the Central Dogma of Molecular Biology and first-order birth–death process assumptions as the fundamental base, derive an expression for the steady-state protein abundance $P^{*}$ implied by this linear system. Then, quantify the local sensitivity of $P^{*}$ to each parameter $r_{\\text{tx}}$, $r_{\\text{tl}}$, $\\gamma_m$, and $\\gamma_p$ using the normalized logarithmic sensitivity coefficients defined for a generic parameter $x$ by $S_{x}=\\frac{\\partial \\ln P^{*}}{\\partial \\ln x}$.\n\nProvide your final answer as a single row matrix containing five entries in the following order: the steady-state protein abundance $P^{*}$, followed by the four normalized sensitivities $S_{r_{\\text{tx}}}$, $S_{r_{\\text{tl}}}$, $S_{\\gamma_m}$, and $S_{\\gamma_p}$. Do not include units in the final matrix.", "solution": "The problem describes a two-stage model of constitutive gene expression, encompassing transcription and translation, based on the Central Dogma of Molecular Biology. The dynamics of the system can be represented by a pair of coupled linear ordinary differential equations (ODEs) for the abundance of messenger RNA, $M(t)$, and protein, $P(t)$.\n\nThe rate of change of the mRNA abundance, $\\frac{dM(t)}{dt}$, is given by the balance between its synthesis (transcription) and its degradation. The synthesis occurs at a constant rate $r_{\\text{tx}}$. The degradation is a first-order process, meaning the removal rate is proportional to the current abundance, with a rate constant of $\\gamma_m$. Thus, the first ODE is:\n$$\n\\frac{dM(t)}{dt} = r_{\\text{tx}} - \\gamma_m M(t)\n$$\n\nSimilarly, the rate of change of the protein abundance, $\\frac{dP(t)}{dt}$, is determined by the balance between its synthesis (translation) and its degradation. The synthesis rate is proportional to the number of available mRNA molecules, $M(t)$, with a rate constant $r_{\\text{tl}}$. The degradation is also a first-order process with a rate constant $\\gamma_p$. This leads to the second ODE:\n$$\n\\frac{dP(t)}{dt} = r_{\\text{tl}} M(t) - \\gamma_p P(t)\n$$\n\nThe problem asks for the steady-state protein abundance, denoted by $P^{*}$. At steady state, the abundances of mRNA and protein no longer change with time. This condition is mathematically expressed by setting the time derivatives to zero: $\\frac{dM}{dt} = 0$ and $\\frac{dP}{dt} = 0$. Let $M^{*}$ and $P^{*}$ be the steady-state abundances.\n\nFrom the first equation at steady state:\n$$\n0 = r_{\\text{tx}} - \\gamma_m M^{*}\n$$\nSolving for the steady-state mRNA abundance $M^{*}$ yields:\n$$\nM^{*} = \\frac{r_{\\text{tx}}}{\\gamma_m}\n$$\n\nNow, we use the second equation at steady state:\n$$\n0 = r_{\\text{tl}} M^{*} - \\gamma_p P^{*}\n$$\nSolving for the steady-state protein abundance $P^{*}$ gives:\n$$\nP^{*} = \\frac{r_{\\text{tl}}}{\\gamma_p} M^{*}\n$$\nSubstituting the expression for $M^{*}$ into the equation for $P^{*}$, we obtain the final expression for the steady-state protein abundance:\n$$\nP^{*} = \\frac{r_{\\text{tl}}}{\\gamma_p} \\left( \\frac{r_{\\text{tx}}}{\\gamma_m} \\right) = \\frac{r_{\\text{tx}} r_{\\text{tl}}}{\\gamma_m \\gamma_p}\n$$\nThis is the first required result.\n\nNext, we must quantify the local sensitivity of $P^{*}$ to each of the four parameters: $r_{\\text{tx}}$, $r_{\\text{tl}}$, $\\gamma_m$, and $\\gamma_p$. The sensitivity is measured by the normalized logarithmic sensitivity coefficient, defined as $S_{x} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln x}$ for a generic parameter $x$. This quantity measures the fractional change in $P^{*}$ resulting from a fractional change in $x$.\n\nA useful property of this definition is that $\\frac{\\partial \\ln P^{*}}{\\partial \\ln x} = \\frac{x}{P^{*}} \\frac{\\partial P^{*}}{\\partial x}$. However, it is often simpler to first take the natural logarithm of the expression for $P^{*}$ and then differentiate.\nThe natural logarithm of $P^{*}$ is:\n$$\n\\ln(P^{*}) = \\ln\\left(\\frac{r_{\\text{tx}} r_{\\text{tl}}}{\\gamma_m \\gamma_p}\\right)\n$$\nUsing the properties of logarithms, this can be expanded as:\n$$\n\\ln(P^{*}) = \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p)\n$$\nNow we can compute the four sensitivity coefficients by taking the partial derivative of $\\ln(P^{*})$ with respect to the natural logarithm of each parameter.\n\n1. Sensitivity to the transcription rate, $r_{\\text{tx}}$:\n$$\nS_{r_{\\text{tx}}} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln r_{\\text{tx}}} = \\frac{\\partial}{\\partial \\ln r_{\\text{tx}}} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right]\n$$\nSince $\\ln(r_{\\text{tl}})$, $\\ln(\\gamma_m)$, and $\\ln(\\gamma_p)$ are treated as constants with respect to the differentiation variable $\\ln(r_{\\text{tx}})$, this simplifies to:\n$$\nS_{r_{\\text{tx}}} = \\frac{\\partial \\ln(r_{\\text{tx}})}{\\partial \\ln r_{\\text{tx}}} = 1\n$$\n\n2. Sensitivity to the translation rate, $r_{\\text{tl}}$:\n$$\nS_{r_{\\text{tl}}} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln r_{\\text{tl}}} = \\frac{\\partial}{\\partial \\ln r_{\\text{tl}}} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right] = \\frac{\\partial \\ln(r_{\\text{tl}})}{\\partial \\ln r_{\\text{tl}}} = 1\n$$\n\n3. Sensitivity to the mRNA decay rate, $\\gamma_m$:\n$$\nS_{\\gamma_m} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln \\gamma_m} = \\frac{\\partial}{\\partial \\ln \\gamma_m} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right] = -\\frac{\\partial \\ln(\\gamma_m)}{\\partial \\ln \\gamma_m} = -1\n$$\n\n4. Sensitivity to the protein decay rate, $\\gamma_p$:\n$$\nS_{\\gamma_p} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln \\gamma_p} = \\frac{\\partial}{\\partial \\ln \\gamma_p} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right] = -\\frac{\\partial \\ln(\\gamma_p)}{\\partial \\ln \\gamma_p} = -1\n$$\n\nIn summary, the steady-state protein abundance is directly proportional to the synthesis rates ($r_{\\text{tx}}$, $r_{\\text{tl}}$) and inversely proportional to the decay rates ($\\gamma_m$, $\\gamma_p$). The sensitivities of $1$ indicate that a $1\\%$ increase in a synthesis rate leads to a $1\\%$ increase in protein abundance. The sensitivities of $-1$ indicate that a $1\\%$ increase in a decay rate leads to a $1\\%$ decrease in protein abundance.\n\nThe final answer is a row matrix containing $P^{*}$, $S_{r_{\\text{tx}}}$, $S_{r_{\\text{tl}}}$, $S_{\\gamma_m}$, and $S_{\\gamma_p}$ in that order.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{r_{\\text{tx}} r_{\\text{tl}}}{\\gamma_m \\gamma_p} & 1 & 1 & -1 & -1 \\end{pmatrix}}\n$$", "id": "4566761"}, {"introduction": "Gene expression is not just a simple pipeline; it is finely regulated at multiple steps. This problem zooms in on translation initiation, a critical control point, and explores how features in the $5'$ untranslated region can modulate protein output. Using the established scanning model of eukaryotic initiation, you will apply probability theory to quantify the impact of a newly introduced upstream AUG (uAUG), a common type of genetic variant, on the final protein yield [@problem_id:4566762].", "problem": "A clinical variant in the $5^{\\prime}$ untranslated region (UTR) of a human gene introduces an upstream AUG (uAUG) that creates an upstream open reading frame (uORF). Under the eukaryotic scanning model, the $43\\mathrm{S}$ preinitiation complex (PIC) binds at the $5^{\\prime}$ cap and scans in the $5^{\\prime} \\to 3^{\\prime}$ direction. At each AUG, initiation can occur with a probability that depends on the local Kozak context and other features. If the PIC initiates at a uAUG and translates a uORF, it may, after termination, retain the small subunit and reinitiate scanning with some probability, potentially initiating at the downstream main AUG. Assume the following for a specific transcript quantified by ribosome profiling-derived predictors:\n- In the reference allele (no uAUG present), the main start codon (mAUG) has a predicted recognition probability $p_{m} = 0.72$.\n- In the variant allele, a strong uAUG with predicted recognition probability $p_{u} = 0.85$ appears upstream of the mAUG, defining a uORF of length $21$ codons that terminates $35$ nucleotides upstream of the mAUG. For this geometry, the probability of small-subunit retention and reinitiation on the same scanning pass is estimated as $r = 0.20$.\n- When the PIC encounters any AUG, recognition is an independent Bernoulli event with the stated probability for that AUG. If a uORF is initiated, the scanning pass proceeds to the mAUG only if reinitiation occurs; otherwise, the complex dissociates and the main AUG is not used on that pass. Assume no additional uAUGs, no internal entry, and neglect drop-off during scanning and any post-transcriptional decay effects.\n\nUsing only these assumptions and the core scanning model of eukaryotic translation initiation, compute the expected fold-change in initiation probability at the mAUG for the variant relative to the reference, that is, compute $\\frac{P_{\\text{variant}}(\\text{init at mAUG})}{P_{\\text{reference}}(\\text{init at mAUG})}$. Report a single number as a decimal rounded to $4$ significant figures. Do not use a percent sign.", "solution": "The objective is to compute the fold-change in the probability of translation initiation at the main start codon (mAUG) for a gene variant relative to its reference allele. This fold-change is the ratio of the initiation probability in the variant to the initiation probability in the reference.\n\nLet $P_{\\text{reference}}$ be the probability of initiation at the mAUG in the reference allele.\nLet $P_{\\text{variant}}$ be the probability of initiation at the mAUG in the variant allele.\n\nFirst, we calculate $P_{\\text{reference}}$.\nIn the reference allele, there is no upstream AUG (uAUG). According to the scanning model and the given assumptions (specifically, no PIC drop-off), any $43\\mathrm{S}$ preinitiation complex (PIC) that binds to the $5^{\\prime}$ cap will scan the mRNA and reach the mAUG. The problem states that the recognition probability of the mAUG is $p_m$. Therefore, the probability that a scanning PIC initiates at the mAUG is simply $p_m$.\n$$\nP_{\\text{reference}} = p_m\n$$\nGiven $p_m = 0.72$.\n\nNext, we calculate $P_{\\text{variant}}$.\nIn the variant allele, a uAUG is present upstream of the mAUG. A scanning PIC will encounter the uAUG first. Two mutually exclusive events can lead to initiation at the downstream mAUG:\n\n1.  **Leaky Scanning**: The PIC scans over the uAUG without initiating translation. This occurs with probability $1 - p_u$. The PIC then continues scanning until it reaches the mAUG, at which point it initiates with probability $p_m$. The combined probability of this path is the product of the probabilities of these independent events.\n    $$\n    P(\\text{Path 1}) = (1 - p_u) \\times p_m\n    $$\n\n2.  **Initiation at uAUG and Reinitiation**: The PIC initiates translation at the uAUG. This occurs with probability $p_u$. After translating the uORF, the small ribosomal subunit may be retained and resume scanning. This reinitiation event occurs with probability $r$. If reinitiation is successful, the PIC continues to scan and reaches the mAUG, where it initiates with probability $p_m$. The combined probability of this path is the product of the probabilities of this sequence of independent events.\n    $$\n    P(\\text{Path 2}) = p_u \\times r \\times p_m\n    $$\n\nThe total probability of initiation at the mAUG in the variant allele, $P_{\\text{variant}}$, is the sum of the probabilities of these two disjoint paths.\n$$\nP_{\\text{variant}} = P(\\text{Path 1}) + P(\\text{Path 2})\n$$\n$$\nP_{\\text{variant}} = (1 - p_u)p_m + p_u r p_m\n$$\nWe can factor out $p_m$:\n$$\nP_{\\text{variant}} = p_m (1 - p_u + p_u r)\n$$\nThis can be further simplified to:\n$$\nP_{\\text{variant}} = p_m (1 - p_u(1 - r))\n$$\n\nNow, we can compute the desired fold-change, which is the ratio $\\frac{P_{\\text{variant}}}{P_{\\text{reference}}}$.\n$$\n\\text{Fold-change} = \\frac{P_{\\text{variant}}}{P_{\\text{reference}}} = \\frac{p_m (1 - p_u(1 - r))}{p_m}\n$$\nThe term $p_m$ cancels out, indicating that the fold-change in this model is independent of the intrinsic strength of the mAUG.\n$$\n\\text{Fold-change} = 1 - p_u(1 - r)\n$$\nWe substitute the given numerical values: $p_u = 0.85$ and $r = 0.20$.\n$$\n\\text{Fold-change} = 1 - 0.85 \\times (1 - 0.20)\n$$\n$$\n\\text{Fold-change} = 1 - 0.85 \\times 0.80\n$$\n$$\n\\text{Fold-change} = 1 - 0.68\n$$\n$$\n\\text{Fold-change} = 0.32\n$$\nThe problem requires the answer to be reported as a decimal rounded to $4$ significant figures.\n$$\n\\text{Fold-change} = 0.3200\n$$", "answer": "$$ \\boxed{0.3200} $$", "id": "4566762"}, {"introduction": "The parameters in our models, such as decay rates, are not just abstract symbols; they are physical quantities that must be measured experimentally. This coding exercise puts you in the role of a data analyst tasked with estimating mRNA half-life from time-course sequencing data following a transcriptional shutoff. You will fit both a simple exponential decay model and a more complex piecewise model, using statistical criteria like the Akaike Information Criterion (AIC) to determine which model best explains the data [@problem_id:4566772], a fundamental task in quantitative biology.", "problem": "You are given time-course RNA sequencing abundance measurements for messenger ribonucleic acid (mRNA) following an instantaneous transcriptional shutoff. Under the Central Dogma of Molecular Biology, mRNA is produced by transcription and degraded by cellular processes. After shutoff, no new transcription occurs, and mRNA abundance is governed by degradation only. A standard, well-tested assumption in molecular kinetics is first-order decay, which implies that the logarithm of abundance follows a linear trajectory over time, possibly with a time-dependent decay rate. Additionally, for high-throughput quantification such as RNA sequencing, it is widely accepted to approximate the measurement noise on the logarithm of normalized abundance by independent Gaussian noise.\n\nYour tasks are to estimate mRNA half-life under a constant-rate decay model and to compare it against a model that allows a piecewise-constant decay rate. The program you write must:\n\n- Treat time $t$ in minutes and abundance $N(t)$ in normalized arbitrary units (strictly positive real numbers). You must report half-life in minutes.\n- Adopt the following observation model: if $y_i$ denotes the observed natural logarithm of abundance at time $t_i$, then\n  $$y_i = \\log N(t_i) + \\varepsilon_i,$$\n  with $\\varepsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$, where $\\sigma^2$ is unknown and must be estimated from the data.\n- Fit two models by maximum likelihood (equivalently, minimize the residual sum of squares on the log scale):\n  - Model $\\mathcal{M}_1$ (constant-rate decay): $N(t) = N_0 e^{-k t}$ with parameters $(N_0,k,\\sigma)$ and constraint $k \\ge 0$.\n  - Model $\\mathcal{M}_2$ (piecewise-constant rate): there exists a switch time $\\tau$ such that $N(t) = N_0 \\exp\\left(-k_1 \\min(t,\\tau) - k_2 \\max(0,t-\\tau)\\right)$ with parameters $(N_0,k_1,k_2,\\tau,\\sigma)$ and constraints $k_1 \\ge 0$, $k_2 \\ge 0$, and $\\tau$ restricted to a finite candidate set given below. For $\\mathcal{M}_2$, constrain $\\tau$ to the set of observed times excluding the minimum and maximum observed time for that test case; that is, grid search $\\tau$ over those interior time points.\n\nFor each model, let the residual sum of squares be $\\text{SSE} = \\sum_{i=1}^{n} r_i^2$, where $r_i$ are residuals on the log scale and $n$ is the number of observations. Under the Gaussian noise assumption, the maximized log-likelihood yields the Akaike Information Criterion (AIC)\n$$\\mathrm{AIC} = 2p + n\\left(\\log(2\\pi) + 1 + \\log\\left(\\frac{\\text{SSE}}{n}\\right)\\right),$$\nwhere $p$ is the number of estimated parameters in the model (include $\\sigma$ in $p$). Use $p = 3$ for $\\mathcal{M}_1$ (parameters $N_0,k,\\sigma$) and $p = 5$ for $\\mathcal{M}_2$ (parameters $N_0,k_1,k_2,\\tau,\\sigma$). To ensure numerical stability, if $\\text{SSE} = 0$, replace it by a small positive constant before taking the logarithm.\n\nFor each test case:\n\n- Fit $\\mathcal{M}_1$ and compute the half-life $t_{1/2} = \\ln(2)/k$ in minutes. Report this as a float rounded to three decimals.\n- Fit $\\mathcal{M}_2$ using the specified $\\tau$ grid, and compute its AIC. Decide whether $\\mathcal{M}_2$ is preferred over $\\mathcal{M}_1$ according to the rule $\\mathrm{AIC}_{\\mathcal{M}_1} - \\mathrm{AIC}_{\\mathcal{M}_2} \\ge 2$ (that is, at least a two-unit reduction in AIC). Report this decision as a boolean.\n\nTest suite (each case gives $t$ in minutes and $N(t)$ in arbitrary units):\n\n- Case $1$ (ideal constant-rate decay):\n  - $t = [\\,0,\\,10,\\,20,\\,30,\\,45,\\,60,\\,90\\,]$\n  - $N(t) = [\\,1000.0,\\,793.7005259840997,\\,629.9605249474366,\\,500.0,\\,353.5533905932738,\\,250.0,\\,125.0\\,]$\n- Case $2$ (piecewise-constant decay; stabilization then acceleration):\n  - $t = [\\,0,\\,10,\\,20,\\,30,\\,45,\\,60,\\,90\\,]$\n  - $N(t) = [\\,800.0,\\,712.7189745122715,\\,634.9604207872798,\\,565.685424949238,\\,282.842712474619,\\,141.4213562373095,\\,35.35533905932738\\,]$\n- Case $3$ (noisy constant-rate decay):\n  - $t = [\\,0,\\,5,\\,10,\\,20,\\,40,\\,80\\,]$\n  - $N(t) = [\\,1200.0,\\,1029.2572122705466,\\,831.5575746753799,\\,606.0,\\,291.0,\\,77.25\\,]$\n\nAngle units do not apply here. There are no percentage outputs; all quantities are either floats (rounded to three decimals) or booleans.\n\nFinal output format: Your program should produce a single line of output containing a top-level list with one element per test case. Each element must itself be a two-element list of the form $[\\,t_{1/2},\\,\\text{prefer\\_piecewise}\\,]$, where $t_{1/2}$ is the half-life in minutes (float rounded to three decimals) and $\\text{prefer\\_piecewise}$ is a boolean. For example, a valid overall output has the form\n$$[\\,[\\,12.345,\\,True\\,],\\,[\\,67.89,\\,False\\,],\\,[\\,23.0,\\,True\\,]\\,].$$", "solution": "The problem requires us to model the decay of messenger RNA (mRNA) abundance over time following a transcriptional shutoff. We will fit two distinct kinetic models to time-course data, compare their goodness-of-fit using the Akaike Information Criterion (AIC), and calculate the mRNA half-life based on the simpler model.\n\nThe fundamental statistical assumption is that the observed natural logarithm of mRNA abundance, $y_i = \\log N(t_i)$, at time $t_i$ is governed by the equation:\n$$y_i = f(t_i; \\boldsymbol{\\theta}) + \\varepsilon_i$$\nwhere $f(t_i; \\boldsymbol{\\theta})$ is the true log-abundance predicted by a model with parameters $\\boldsymbol{\\theta}$, and $\\varepsilon_i$ are independent and identically distributed Gaussian noise terms, $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$. Under this assumption, maximizing the likelihood of the data is equivalent to minimizing the Residual Sum of Squares (SSE), defined as $\\text{SSE} = \\sum_{i=1}^{n} (y_i - f(t_i; \\hat{\\boldsymbol{\\theta}}))^2$, where $\\hat{\\boldsymbol{\\theta}}$ are the estimated parameters and $n$ is the number of data points. This is a least-squares regression problem.\n\n### Model $\\mathcal{M}_1$: Constant-Rate Decay\n\nThis model assumes a first-order decay process, described by the differential equation $\\frac{dN}{dt} = -kN$. The solution is an exponential decay function:\n$$N(t) = N_0 e^{-kt}$$\nwhere $N_0$ is the initial abundance at $t=0$ and $k$ is the constant decay rate ($k \\ge 0$). Taking the natural logarithm transforms this into a linear equation:\n$$y(t) = \\log N(t) = \\log N_0 - kt$$\nThis is a simple linear regression model of the form $y(t) = \\beta_0 + \\beta_1 t$, with parameters $\\beta_0 = \\log N_0$ and $\\beta_1 = -k$. We estimate $\\beta_0$ and $\\beta_1$ by minimizing the SSE. The constraint $k \\ge 0$ implies that we must enforce $\\beta_1 \\le 0$. This is achieved using constrained least-squares optimization. The design matrix $\\mathbf{X}$ and parameter vector $\\boldsymbol{\\beta}$ for the regression problem $\\mathbf{y} \\approx \\mathbf{X}\\boldsymbol{\\beta}$ are:\n$$\\mathbf{X} = \\begin{pmatrix} 1 & t_1 \\\\ 1 & t_2 \\\\ \\vdots & \\vdots \\\\ 1 & t_n \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}$$\nOnce the estimate $\\hat{\\beta}_1$ is found, the decay rate is $\\hat{k} = -\\hat{\\beta}_1$. The mRNA half-life, $t_{1/2}$, the time it takes for the abundance to reduce by half, is derived from the relation $N(t_{1/2}) = N_0/2$:\n$$t_{1/2} = \\frac{\\log(2)}{\\hat{k}}$$\nThe SSE for this model, $\\text{SSE}_1$, is computed from the residuals of the fit. The AIC is then calculated using the provided formula with $p_1=3$ parameters (for $\\hat{N}_0, \\hat{k}, \\hat{\\sigma}$).\n\n### Model $\\mathcal{M}_2$: Piecewise-Constant Rate Decay\n\nThis model allows the decay rate to change at a single switch time, $\\tau$. The abundance function is:\n$$N(t) = N_0 \\exp\\left(-k_1 \\min(t,\\tau) - k_2 \\max(0,t-\\tau)\\right)$$\nThis model posits an initial decay rate $k_1$ for $t \\le \\tau$, and a subsequent rate $k_2$ for $t > \\tau$. Both rates are constrained to be non-negative, $k_1 \\ge 0$ and $k_2 \\ge 0$. The log-transformed model is:\n$$y(t) = \\log N_0 - k_1 \\min(t,\\tau) - k_2 \\max(0,t-\\tau)$$\nFor a fixed $\\tau$, this is a multiple linear regression problem $y(t) = \\beta_0 + \\beta_1 x_1(t) + \\beta_2 x_2(t)$, with $\\beta_0 = \\log N_0$, $\\beta_1 = -k_1$, $\\beta_2 = -k_2$, and regressors $x_1(t) = \\min(t,\\tau)$ and $x_2(t) = \\max(0,t-\\tau)$. The constraints $k_1, k_2 \\ge 0$ translate to $\\beta_1, \\beta_2 \\le 0$. The design matrix $\\mathbf{X}_{\\tau}$ and parameter vector $\\boldsymbol{\\beta}$ are:\n$$\\mathbf{X}_{\\tau} = \\begin{pmatrix} 1 & \\min(t_1,\\tau) & \\max(0,t_1-\\tau) \\\\ 1 & \\min(t_2,\\tau) & \\max(0,t_2-\\tau) \\\\ \\vdots & \\vdots & \\vdots \\\\ 1 & \\min(t_n,\\tau) & \\max(0,t_n-\\tau) \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\\\ \\beta_2 \\end{pmatrix}$$\nThe optimal switch time $\\tau^*$ is not known a priori. We find it by performing a grid search over the set of candidate values specified in the problem: the interior time points of the dataset. For each candidate $\\tau$, we perform a constrained least-squares fit to find the optimal parameters and the corresponding $\\text{SSE}_{2,\\tau}$. We select the $\\tau^*$ that yields the minimum SSE.\nThe final SSE for the model is $\\text{SSE}_2 = \\min_{\\tau} \\text{SSE}_{2,\\tau}$. The AIC is then calculated using the provided formula with $p_2=5$ parameters (for $\\hat{N}_0, \\hat{k}_1, \\hat{k}_2, \\hat{\\tau}, \\hat{\\sigma}$).\n\n### Model Selection\n\nThe two models are compared using their AIC values. The AIC provides a measure of model quality that balances goodness-of-fit (represented by SSE) with model complexity (represented by the number of parameters $p$). A lower AIC indicates a better model. To account for the statistical uncertainty in AIC values, a common heuristic is to prefer a more complex model only if its AIC is substantially lower. The problem specifies the decision rule: model $\\mathcal{M}_2$ is preferred over $\\mathcal{M}_1$ if and only if:\n$$\\mathrm{AIC}_{\\mathcal{M}_1} - \\mathrm{AIC}_{\\mathcal{M}_2} \\ge 2$$\nThis constitutes a formal criterion for deciding whether the additional complexity of the piecewise model is justified by a significantly better fit to the data.\n\nFor each test case, we will compute the half-life from $\\mathcal{M}_1$ and the boolean preference for $\\mathcal{M}_2$ based on this rule.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Solves the mRNA decay modeling problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Ideal constant-rate decay\n        {\n            \"t\": [0.0, 10.0, 20.0, 30.0, 45.0, 60.0, 90.0],\n            \"N\": [1000.0, 793.7005259840997, 629.9605249474366, 500.0, 353.5533905932738, 250.0, 125.0]\n        },\n        # Case 2: Piecewise-constant decay\n        {\n            \"t\": [0.0, 10.0, 20.0, 30.0, 45.0, 60.0, 90.0],\n            \"N\": [800.0, 712.7189745122715, 634.9604207872798, 565.685424949238, 282.842712474619, 141.4213562373095, 35.35533905932738]\n        },\n        # Case 3: Noisy constant-rate decay\n        {\n            \"t\": [0.0, 5.0, 10.0, 20.0, 40.0, 80.0],\n            \"N\": [1200.0, 1029.2572122705466, 831.5575746753799, 606.0, 291.0, 77.25]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        t = np.array(case[\"t\"])\n        N = np.array(case[\"N\"])\n        result = process_case(t, N)\n        results.append(result)\n\n    # The problem asks for a very specific string format that mimics a Python list of lists.\n    # We construct the string representation manually to match the requested format.\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{str(res[1])}]\" for res in results]) + \"]\"\n    print(output_str)\n\ndef calculate_aic(sse, n, p, eps=1e-15):\n    \"\"\"\n    Calculates the Akaike Information Criterion (AIC).\n    - sse: Residual Sum of Squares\n    - n: Number of observations\n    - p: Number of estimated parameters\n    - eps: Small constant for numerical stability if sse is zero\n    \"\"\"\n    if sse = eps:\n        sse = eps\n    \n    aic = 2 * p + n * (np.log(2 * np.pi) + 1 + np.log(sse / n))\n    return aic\n\ndef process_case(t, N):\n    \"\"\"\n    Fits models M1 and M2 to a single dataset and performs model comparison.\n    \"\"\"\n    y = np.log(N)\n    n = len(t)\n\n    # --- Model M1: Constant-rate decay (Simple Linear Regression) ---\n    # Model: y = beta0 + beta1 * t\n    # Parameters: beta0 = log(N0), beta1 = -k\n    # Constraint: k >= 0  => beta1 = 0\n    A1 = np.vstack([np.ones(n), t]).T\n    bounds1 = ([-np.inf, -np.inf], [np.inf, 0.0]) # beta1 = 0\n    \n    res1 = lsq_linear(A1, y, bounds=bounds1)\n    \n    k_hat = -res1.x[1]\n    \n    # Half-life from Model M1\n    if k_hat > 0:\n        t_half_life = np.log(2) / k_hat\n    else:\n        t_half_life = np.inf # Effectively infinite half-life if no decay\n\n    # SSE and AIC for Model M1\n    # lsq_linear returns 0.5 * ||Ax-b||^2, so we multiply by 2 for SSE\n    sse1 = res1.cost * 2\n    p1 = 3 # Parameters: N0, k, sigma\n    aic1 = calculate_aic(sse1, n, p1)\n\n    # --- Model M2: Piecewise-constant rate decay ---\n    # Model: y = beta0 + beta1*min(t,tau) + beta2*max(0,t-tau)\n    # Parameters: beta0=log(N0), beta1=-k1, beta2=-k2\n    # Constraints: k1, k2 >= 0 => beta1, beta2 = 0\n    \n    tau_grid = t[1:-1] # Grid search over interior time points\n    best_sse2 = np.inf\n    \n    for tau in tau_grid:\n        x1 = np.minimum(t, tau)\n        x2 = np.maximum(0, t - tau)\n        \n        A2 = np.vstack([np.ones(n), x1, x2]).T\n        bounds2 = ([-np.inf, -np.inf, -np.inf], [np.inf, 0.0, 0.0]) # beta1, beta2 = 0\n        \n        res_tau = lsq_linear(A2, y, bounds=bounds2)\n        sse_tau = res_tau.cost * 2\n        \n        if sse_tau  best_sse2:\n            best_sse2 = sse_tau\n\n    # SSE and AIC for Model M2 (using the best tau)\n    sse2 = best_sse2\n    p2 = 5 # Parameters: N0, k1, k2, tau, sigma\n    aic2 = calculate_aic(sse2, n, p2)\n    \n    # --- Model Comparison ---\n    # Prefer M2 if its AIC is at least 2 units smaller than M1's AIC\n    prefer_piecewise = (aic1 - aic2) >= 2.0\n\n    return [round(t_half_life, 3), prefer_piecewise]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "4566772"}]}