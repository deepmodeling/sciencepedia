{"hands_on_practices": [{"introduction": "A central feature of splice-aware aligners is the use of a scoring system to evaluate potential alignments, where a specific penalty is applied for introducing an intron. This exercise delves into the theoretical justification for such penalties by framing the problem in a probabilistic context [@problem_id:4609282]. You will derive the prior probability of observing a canonical splice motif by chance under a simple genomic background model and then connect this probability to the additive log-odds scores that form the basis of modern alignment algorithms.", "problem": "Consider a large eukaryotic genome being modeled as a stationary, zeroth-order independent and identically distributed process over nucleotides, with mono-nucleotide frequencies $p_A, p_C, p_G, p_T$ satisfying $p_A + p_C + p_G + p_T = 1$ and $0  p_A, p_C, p_G, p_T  1$. A splice-aware aligner examines a candidate intron on a fixed strand by selecting a donor boundary at positions $i,i+1$ and an acceptor boundary at positions $j-1,j$, with $j  i+1$ so that the putative intron length $L = j - i - 1 \\geq 1$. The canonical motif for a donor on this strand is the dinucleotide $GT$ and for an acceptor is the dinucleotide $AG$.\n\nStarting from first principles of probability under the given background model (stationary zeroth-order), derive the closed-form prior probability of the event $E$ that the donor boundary equals $GT$ and the acceptor boundary equals $AG$ for a randomly selected candidate pair $(i,j)$, expressed purely in terms of $p_A, p_C, p_G, p_T$. Then, explain how this prior connects to the additive junction penalty that splice-aware aligners commonly use when scoring alignments under a log-probability model.\n\nYour final answer must be a single closed-form expression for the prior probability $\\mathbb{P}(E)$ in terms of $p_A, p_C, p_G, p_T$. No rounding is required, and no units are involved.", "solution": "The problem statement is evaluated for validity before attempting a solution.\n\n### Step 1: Extract Givens\n-   **Genome Model**: A stationary, zeroth-order independent and identically distributed (i.i.d.) process over the alphabet $\\{A, C, G, T\\}$.\n-   **Nucleotide Frequencies**: Mono-nucleotide probabilities are $p_A, p_C, p_G, p_T$.\n-   **Constraints on Frequencies**: $p_A + p_C + p_G + p_T = 1$ and $0  p_k  1$ for $k \\in \\{A, C, G, T\\}$.\n-   **Candidate Intron**: Defined by a donor boundary at positions $(i, i+1)$ and an acceptor boundary at positions $(j-1, j)$.\n-   **Intron Length Constraint**: $j  i+1$, which implies the intron length $L = j - i - 1$ is at least $1$.\n-   **Donor Motif**: The dinucleotide at positions $(i, i+1)$ is $GT$.\n-   **Acceptor Motif**: The dinucleotide at positions $(j-1, j)$ is $AG$.\n-   **Event of Interest**: Let $E$ be the event that a randomly selected candidate intron has a donor boundary of $GT$ and an acceptor boundary of $AG$.\n-   **Task 1**: Derive the closed-form prior probability $\\mathbb{P}(E)$ in terms of $p_A, p_C, p_G, p_T$.\n-   **Task 2**: Explain the connection between this prior probability and the additive junction penalty in log-probability alignment models.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is grounded in fundamental principles of molecular biology and bioinformatics. The zeroth-order i.i.d. model is a standard, albeit simplified, null model for genomic sequences. The canonical $GT...AG$ splice junction is a well-established biological signal for the majority of introns in eukaryotes.\n-   **Well-Posed**: The problem is clearly defined. It provides a specific probabilistic model and asks for a derivation of a probability under that model. All necessary information is provided.\n-   **Objective**: The language is precise, technical, and free from any subjective or ambiguous statements.\n\n### Step 3: Verdict and Action\nThe problem is scientifically and mathematically sound, well-posed, and objective. It is deemed **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe problem asks for the prior probability of the event $E$, which is the simultaneous occurrence of a canonical donor motif ($GT$) at positions $(i, i+1)$ and a canonical acceptor motif ($AG$) at positions $(j-1, j)$. Let $N_k$ denote the nucleotide at a genomic position $k$. The event $E$ can be formally written as the conjunction of four conditions on the nucleotides at four specific positions:\n$$\nE = \\{ N_i = G \\} \\cap \\{ N_{i+1} = T \\} \\cap \\{ N_{j-1} = A \\} \\cap \\{ N_j = G \\}\n$$\nThe problem specifies that the genome is modeled as a stationary, zeroth-order i.i.d. process.\n-   **Zeroth-order**: The probability of a nucleotide at any given position is independent of the nucleotides at all other positions.\n-   **Stationary (Identically Distributed)**: The probability of observing a particular nucleotide is constant across all positions in the sequence. That is, for any position $k$, $\\mathbb{P}(N_k = A) = p_A$, $\\mathbb{P}(N_k = C) = p_C$, $\\mathbb{P}(N_k = G) = p_G$, and $\\mathbb{P}(N_k = T) = p_T$.\n\nThe constraint $j  i+1$ ensures that the intron has a minimum length of $1$ nucleotide. This is equivalent to $j \\ge i+2$, which implies $j-1 \\ge i+1$. This guarantees that the four positions $i$, $i+1$, $j-1$, and $j$ are distinct, as $i  i+1 \\le j-1  j$.\n\nDue to the independence assumption of the zeroth-order model, the probability of the joint event $E$ is the product of the probabilities of the individual nucleotide events:\n$$\n\\mathbb{P}(E) = \\mathbb{P}(N_i = G) \\times \\mathbb{P}(N_{i+1} = T) \\times \\mathbb{P}(N_{j-1} = A) \\times \\mathbb{P}(N_j = G)\n$$\nUsing the stationary property, we substitute the given mono-nucleotide frequencies for the probabilities at each position:\n$$\n\\mathbb{P}(E) = p_G \\times p_T \\times p_A \\times p_G\n$$\nCombining terms, we arrive at the closed-form expression for the prior probability of observing the canonical $GT-AG$ splice sites by chance:\n$$\n\\mathbb{P}(E) = p_A p_G^2 p_T\n$$\nThis completes the first part of the task.\n\nFor the second part, we explain the connection to the additive junction penalty in splice-aware aligners. These aligners typically operate in a log-probability framework to score alignments. In this framework, the score of an alignment is proportional to the logarithm of its probability under a generative model. This is computationally advantageous because it transforms products of probabilities into sums of scores (log-probabilities), which can be efficiently computed using dynamic programming.\n\nLet $S_{align}$ be the score of an alignment that postulates an intron. This alignment's probability, $\\mathbb{P}_{align}$, can be factored into components, including the probability of the sequence matching the exons and the probability of the intron junction itself.\n$$\n\\mathbb{P}_{align} = \\mathbb{P}_{exons} \\times \\mathbb{P}_{junction} \\times \\dots\n$$\nThe term $\\mathbb{P}_{junction}$ represents the probability of observing the splice site signals. Under the specified background model, this is precisely the prior probability $\\mathbb{P}(E)$ we calculated.\n$$\n\\mathbb{P}_{junction} = \\mathbb{P}(E) = p_A p_G^2 p_T\n$$\nIn the log-probability scoring scheme, the score contribution from the junction, $S_{junction}$, is:\n$$\nS_{junction} = \\alpha \\ln(\\mathbb{P}_{junction}) = \\alpha \\ln(p_A p_G^2 p_T)\n$$\nwhere $\\alpha$ is a positive scaling constant, often taken as $1$. The total score of the alignment is an additive composition of such terms:\n$$\nS_{align} = S_{exons} + S_{junction} + \\dots\n$$\nAlignment algorithms are frequently formulated as minimizing a cost or penalty, where the penalty is the negative of the score. The junction *penalty*, $J$, is thus:\n$$\nJ = -S_{junction} = -\\alpha \\ln(p_A p_G^2 p_T)\n$$\nThis term $J$ is an **additive penalty**. When a splice-aware aligner evaluates a path in its dynamic programming matrix that corresponds to creating an intron, it adds this constant penalty $J$ to the total alignment cost. The value of this penalty directly reflects the unlikeliness of the canonical splice motif occurring by random chance. A lower prior probability $\\mathbb{P}(E)$ leads to a larger penalty $J$, making the aligner less willing to introduce an intron unless there is strong evidence from the rest of the alignment. For example, if nucleotides were uniformly distributed ($p_A = p_C = p_G = p_T = 1/4$), the penalty (with $\\alpha=1$) would be $J = -\\ln((1/4)^4) = -\\ln(1/256) = \\ln(256)$, a fixed positive value. This demonstrates how the prior probability of the splice motif, derived from first principles, translates directly into the additive junction penalty used in practical alignment algorithms.", "answer": "$$\n\\boxed{p_A p_G^2 p_T}\n$$", "id": "4609282"}, {"introduction": "The core task of a splice-aware aligner is to find the highest-scoring explanation for a read's origin, which often involves deciding between a contiguous alignment with gaps and a spliced alignment across an intron. This practice provides a concrete example of this fundamental trade-off, where you will apply a standard scoring model with affine gap and intron penalties to compare two competing hypotheses [@problem_id:4609252]. By manually computing the alignment scores, you will develop an intuition for how these algorithms weigh evidence and make decisions at the level of a single read.", "problem": "In splice-aware alignment of ribonucleic acid sequencing (RNA-seq) reads to a reference genome, the objective is to select a mapping that optimizes an additive alignment score derived from a probabilistic model of sequence evolution and sequencing error. A standard and well-tested scoring framework uses an affine gap penalty to model insertions or deletions and a distinct intron penalty to model splice junctions. In this framework, each matched base contributes a match score, and structural events contribute fixed penalties:\n\n- A matched base contributes $c_{M}$ to the alignment score per base.\n- A gap (insertion or deletion) of length $l$ contributes a total penalty $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$, representing one gap opening event and $l$ gap extension steps.\n- A splice junction contributes a single intron penalty $c_{I}$, independent of intron length in this simplified model.\n\nConsider a single $150$ base-pair read with two candidate genomic mappings:\n\n1. Candidate A is a contiguous genomic alignment that contains a single insertion of length $10$ in the read-to-reference alignment, with $140$ matched bases and no mismatches.\n2. Candidate B is a spliced alignment in which the read is split into two segments of $75$ bases each that map to two exons across one intron, yielding $150$ matched bases and one splice junction, with no mismatches and no genomic gaps within exons.\n\nAssume the following scoring constants: $c_{M}=-2$, $c_{\\text{gap\\_open}}=-5$, $c_{\\text{gap\\_extend}}=-1$, and $c_{I}=-20$. Define the alignment score of each candidate as the sum of all applicable contributions described above. Compute the alignment score difference $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$, where $S_{\\text{splice}}$ is the score of Candidate B and $S_{\\text{deletion}}$ is the score of Candidate A. Provide your final answer as a single real number. No rounding is needed.", "solution": "### Derivation of Solution\nThe alignment score, $S$, is calculated as the sum of contributions from all alignment features (matches, gaps, and introns).\n\nFirst, we calculate the score for Candidate A, the contiguous alignment with an insertion, denoted as $S_{\\text{deletion}}$.\nCandidate A has $140$ matched bases. The total contribution from matches is the number of matches multiplied by the match score per base, $c_{M}$.\nContribution from matches = $140 \\cdot c_{M}$.\nCandidate A has a single insertion of length $l=10$. This constitutes one gap opening event and $10$ gap extension steps. The total penalty contribution from this gap is given by the affine gap penalty formula: $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$ with $l=10$.\nContribution from gap = $c_{\\text{gap\\_open}} + 10 \\cdot c_{\\text{gap\\_extend}}$.\nThere are no splice junctions in Candidate A.\nThe total score for Candidate A is the sum of these contributions:\n$$S_{\\text{deletion}} = 140 \\cdot c_{M} + (c_{\\text{gap\\_open}} + 10 \\cdot c_{\\text{gap\\_extend}})$$\nSubstituting the given values:\n$$S_{\\text{deletion}} = 140 \\cdot (-2) + (-5 + 10 \\cdot (-1))$$\n$$S_{\\text{deletion}} = -280 + (-5 - 10)$$\n$$S_{\\text{deletion}} = -280 - 15 = -295$$\n\nNext, we calculate the score for Candidate B, the spliced alignment, denoted as $S_{\\text{splice}}$.\nCandidate B has $150$ matched bases. The contribution from matches is:\nContribution from matches = $150 \\cdot c_{M}$.\nCandidate B has one splice junction, which contributes the intron penalty, $c_{I}$.\nContribution from intron = $c_{I}$.\nThere are no gaps within the exons for Candidate B.\nThe total score for Candidate B is the sum of these contributions:\n$$S_{\\text{splice}} = 150 \\cdot c_{M} + c_{I}$$\nSubstituting the given values:\n$$S_{\\text{splice}} = 150 \\cdot (-2) + (-20)$$\n$$S_{\\text{splice}} = -300 - 20$$\n$$S_{\\text{splice}} = -320$$\n\nFinally, we compute the requested alignment score difference, $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$.\n$$\\Delta S = (-320) - (-295)$$\n$$\\Delta S = -320 + 295$$\n$$\\Delta S = -25$$\n\nThe difference in alignment scores is $-25$. This indicates that, according to the specified scoring model, the alignment with the insertion (Candidate A) is preferred over the spliced alignment (Candidate B) as it has a higher (less negative) score.", "answer": "$$\\boxed{-25}$$", "id": "4609252"}, {"introduction": "After an aligner identifies a best-scoring alignment, a crucial next step is to quantify the confidence in this choice relative to other possibilities. This exercise illustrates how this is achieved using a Bayesian framework to compute the posterior probability that the chosen alignment is correct [@problem_id:4609207]. You will then convert this error probability into the industry-standard Mapping Quality ($MAPQ$) score, gaining insight into a critical metric used to filter and weigh alignments in all downstream genomic analyses.", "problem": "An RNA sequencing (RNA-seq) read spans a putative splice junction and is evaluated by a splice-aware aligner that uses a Hidden Markov Model (HMM) to score spliced alignments. The aligner considers two mutually exclusive candidate hypotheses for the read’s origin: $H_{A}$, a canonical donor–acceptor splice ($\\mathrm{GT}$–$\\mathrm{AG}$) consistent with the gene’s known annotation track, and $H_{B}$, a non-canonical donor–acceptor splice ($\\mathrm{GC}$–$\\mathrm{AG}$) not present in the annotation. The HMM likelihoods for the observed bases and gap structure are equal for both hypotheses, that is $P(D \\mid H_{A}) = P(D \\mid H_{B})$, where $D$ denotes the observed read sequence and its alignment features. Prior usage of canonical splice sites in this locus is supported by population-level junction counts, resulting in priors $P(H_{A}) = 0.9$ and $P(H_{B}) = 0.1$. Using Bayes’ rule and the definition that the Mapping Quality (MAPQ) is the Phred-scale (PHRED) transformation of the probability that the reported best alignment is incorrect, compute the $MAPQ$ for reporting $H_{A}$ as the best alignment.\n\nYou may assume:\n- $P(H_{A} \\mid D) = \\dfrac{P(D \\mid H_{A}) P(H_{A})}{P(D \\mid H_{A}) P(H_{A}) + P(D \\mid H_{B}) P(H_{B})}$ and similarly for $H_{B}$.\n- The error probability for the reported best alignment is $p_{\\mathrm{error}} = 1 - P_{\\mathrm{best}}$, where $P_{\\mathrm{best}}$ is the posterior probability of the chosen best hypothesis.\n- The Phred-scale transform is $Q = -10 \\log_{10}(p)$ for a probability $p$.\n\nExpress the final value of $MAPQ$ as an exact integer with no rounding.", "solution": "The splice-aware aligner produces two hypotheses, $H_{A}$ and $H_{B}$, with equal likelihoods under the Hidden Markov Model, so $P(D \\mid H_{A}) = P(D \\mid H_{B})$. The priors are $P(H_{A}) = 0.9$ and $P(H_{B}) = 0.1$. By Bayes’ rule,\n$$\nP(H_{A} \\mid D) = \\frac{P(D \\mid H_{A}) P(H_{A})}{P(D \\mid H_{A}) P(H_{A}) + P(D \\mid H_{B}) P(H_{B})}.\n$$\nBecause $P(D \\mid H_{A}) = P(D \\mid H_{B})$, denote this common likelihood by $L$; then\n$$\nP(H_{A} \\mid D) = \\frac{L \\cdot 0.9}{L \\cdot 0.9 + L \\cdot 0.1} = \\frac{0.9}{0.9 + 0.1} = 0.9,\n$$\nand similarly,\n$$\nP(H_{B} \\mid D) = \\frac{L \\cdot 0.1}{L \\cdot 0.9 + L \\cdot 0.1} = \\frac{0.1}{1.0} = 0.1.\n$$\nThe best alignment to report is $H_{A}$, with posterior $P_{\\mathrm{best}} = P(H_{A} \\mid D) = 0.9$. The error probability for the reported best alignment is the probability that the reported alignment is wrong, namely\n$$\np_{\\mathrm{error}} = 1 - P_{\\mathrm{best}} = 1 - 0.9 = 0.1.\n$$\nThe Mapping Quality (MAPQ) is the Phred-scale transformation of this error probability:\n$$\nMAPQ = -10 \\log_{10}(p_{\\mathrm{error}}) = -10 \\log_{10}(0.1).\n$$\nUsing the identity $\\log_{10}(0.1) = \\log_{10}(10^{-1}) = -1$, we obtain\n$$\nMAPQ = -10 \\cdot (-1) = 10.\n$$\nThis is already an exact integer, so no rounding is needed.", "answer": "$$\\boxed{10}$$", "id": "4609207"}]}