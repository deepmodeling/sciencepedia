{"hands_on_practices": [{"introduction": "The first step in CRISPR-Cas targeting is the recognition of a Protospacer Adjacent Motif (PAM). This exercise explores how we can computationally model this recognition process using a Position Weight Matrix (PWM), a cornerstone of motif analysis in bioinformatics. By calculating the expected number of PAM hits in a genome, you will connect a probabilistic sequence model to a concrete, large-scale prediction, which is a fundamental skill in genomics [@problem_id:4551342].", "problem": "A Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-CRISPR-associated (Cas) nuclease requires a Protospacer Adjacent Motif (PAM) to bind and cleave target DNA. Consider a three-nucleotide PAM modeled by a Position Weight Matrix (PWM), where at each position $i \\in \\{1,2,3\\}$, the PWM specifies probabilities $p_{i,A}$, $p_{i,C}$, $p_{i,G}$, and $p_{i,T}$ for observing bases $A$, $C$, $G$, and $T$, respectively, with $\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b} = 1$ for every $i$. Let the background genome follow an independent and identically distributed (i.i.d.) nucleotide model with base frequencies $q_{A}$, $q_{C}$, $q_{G}$, $q_{T}$, $\\sum_{b \\in \\{A,C,G,T\\}} q_{b} = 1$, and independence across positions.\n\nA window of length $3$ is declared a PAM hit if its log-likelihood ratio score\n$$\nS(b_{1}b_{2}b_{3}) = \\sum_{i=1}^{3} \\ln\\!\\left(\\frac{p_{i,b_{i}}}{q_{b_{i}}}\\right)\n$$\nexceeds a fixed threshold $T$. You will scan the plus strand of a genome of length $N$ using non-overlapping windows of length $3$ (stride $3$), so the number of scanned windows is $M = \\left\\lfloor\\frac{N-3+1}{3}\\right\\rfloor$. Assume the following scientifically plausible parameters for a Streptococcus pyogenes Cas9-like PAM preference:\n- Genome length $N = 4{,}500{,}002$,\n- Background base frequencies $q_{A} = 0.3$, $q_{C} = 0.2$, $q_{G} = 0.2$, $q_{T} = 0.3$,\n- PWM entries:\n$$\n(p_{1,A},p_{1,C},p_{1,G},p_{1,T}) = (0.3,0.2,0.2,0.3), \\quad (p_{2,A},p_{2,C},p_{2,G},p_{2,T}) = (0.02,0.02,0.95,0.01),\n$$\n$$\n(p_{3,A},p_{3,C},p_{3,G},p_{3,T}) = (0.02,0.02,0.95,0.01),\n$$\n- Threshold $T = 0.5$.\n\nUnder the i.i.d. model, treat the non-overlapping windows as independent Bernoulli trials with success defined by $S(b_{1}b_{2}b_{3}) \\geq T$. Derive from first principles the expected genome-wide hit count and its variance across the $M$ scanned windows.\n\nRound both the expected count and the variance to four significant figures. Express the expected count in counts and the variance in counts squared. Provide your final answer as two values in a single row matrix, with the first entry being the expected hit count and the second entry being the variance.", "solution": "We start from core definitions: a Position Weight Matrix (PWM) defines, for each position $i$ in a motif of length $3$, a categorical distribution $p_{i,b}$ over bases $b \\in \\{A,C,G,T\\}$. The background model is independent and identically distributed (i.i.d.), with per-base probabilities $q_{b}$, and bases across positions are independent. The log-likelihood ratio (LLR) score for a sequence $b_{1}b_{2}b_{3}$ is\n$$\nS(b_{1}b_{2}b_{3}) = \\sum_{i=1}^{3} \\ln\\!\\left(\\frac{p_{i,b_{i}}}{q_{b_{i}}}\\right).\n$$\nA hit is declared if $S(b_{1}b_{2}b_{3}) \\geq T$. Scanning is performed over non-overlapping windows of length $3$ on the plus strand, so under i.i.d. bases, the windows are independent.\n\nFirst, compute the number of scanned windows $M$. With stride $3$, the number of windows is\n$$\nM = \\left\\lfloor \\frac{N - 3 + 1}{3} \\right\\rfloor = \\left\\lfloor \\frac{N - 2}{3} \\right\\rfloor.\n$$\nFor $N = 4{,}500{,}002$, we have\n$$\nM = \\frac{4{,}500{,}002 - 2}{3} = \\frac{4{,}500{,}000}{3} = 1{,}500{,}000.\n$$\n\nNext, we determine the per-window hit probability under the i.i.d. background, denoted $p_{\\text{hit}}$. By definition,\n$$\np_{\\text{hit}} = \\sum_{b_{1},b_{2},b_{3} \\in \\{A,C,G,T\\}} \\left( \\prod_{i=1}^{3} q_{b_{i}} \\right) \\cdot \\mathbf{1}\\!\\left\\{ S(b_{1}b_{2}b_{3}) \\geq T \\right\\}.\n$$\nWe analyze $S(b_{1}b_{2}b_{3})$ position-wise using the provided PWM and background $q_{b}$. At position $1$, the PWM equals the background: $(p_{1,A},p_{1,C},p_{1,G},p_{1,T}) = (q_{A},q_{C},q_{G},q_{T})$. Therefore, for any base $b_{1}$,\n$$\n\\ln\\!\\left(\\frac{p_{1,b_{1}}}{q_{b_{1}}}\\right) = \\ln(1) = 0.\n$$\nThus, position $1$ contributes $0$ to $S$ for all bases, and the decision boundary depends only on positions $2$ and $3$.\n\nCompute the LLR contributions at positions $2$ and $3$:\n- For $G$ at positions $2$ or $3$:\n$$\n\\ln\\!\\left(\\frac{p_{i,G}}{q_{G}}\\right) = \\ln\\!\\left(\\frac{0.95}{0.2}\\right) = \\ln(4.75).\n$$\n- For non-$G$ bases at positions $2$ or $3$:\n$$\n\\ln\\!\\left(\\frac{p_{i,A}}{q_{A}}\\right) = \\ln\\!\\left(\\frac{0.02}{0.3}\\right) = \\ln\\!\\left(\\frac{1}{15}\\right), \\quad\n\\ln\\!\\left(\\frac{p_{i,C}}{q_{C}}\\right) = \\ln\\!\\left(\\frac{0.02}{0.2}\\right) = \\ln(0.1), \\quad\n\\ln\\!\\left(\\frac{p_{i,T}}{q_{T}}\\right) = \\ln\\!\\left(\\frac{0.01}{0.3}\\right) = \\ln\\!\\left(\\frac{1}{30}\\right).\n$$\nNumerically,\n$$\n\\ln(4.75) \\approx 1.5581446, \\quad \\ln\\!\\left(\\frac{1}{15}\\right) \\approx -2.7080502, \\quad \\ln(0.1) \\approx -2.3025851, \\quad \\ln\\!\\left(\\frac{1}{30}\\right) \\approx -3.4011974.\n$$\n\nBecause position $1$ contributes $0$, the total $S$ is the sum of two independent per-position contributions from positions $2$ and $3$. We compare the maximal possible $S$ among sequences that do not have $G$ at both positions versus the minimal $S$ among sequences that do have $G$ at both positions:\n- If both positions $2$ and $3$ are $G$, then\n$$\nS_{\\text{GG}} = \\ln\\!\\left(\\frac{p_{2,G}}{q_{G}}\\right) + \\ln\\!\\left(\\frac{p_{3,G}}{q_{G}}\\right) = 2 \\ln(4.75) \\approx 3.1162892.\n$$\n- If at most one of positions $2$ or $3$ is $G$, the largest $S$ occurs when one position is $G$ and the other is the least penalized non-$G$ base, namely $C$, giving\n$$\nS_{\\text{G+nonG,max}} = \\ln(4.75) + \\ln(0.1) \\approx 1.5581446 - 2.3025851 = -0.7444405.\n$$\nTherefore, with threshold $T = 0.5$, only windows with $G$ at both positions $2$ and $3$ satisfy $S \\geq T$, since $S_{\\text{GG}} \\approx 3.1162892 > 0.5$ and $S_{\\text{G+nonG,max}} \\approx -0.7444405 < 0.5$.\n\nThus, the hit criterion reduces to “positions $2$ and $3$ are $G$,” while position $1$ is unrestricted. Under the i.i.d. background with $q_{G} = 0.2$, this yields\n$$\np_{\\text{hit}} = \\sum_{b_{1} \\in \\{A,C,G,T\\}} q_{b_{1}} \\cdot q_{G} \\cdot q_{G} = \\left( \\sum_{b_{1}} q_{b_{1}} \\right) q_{G}^{2} = 1 \\cdot (0.2)^{2} = 0.04.\n$$\n\nWith $M$ independent Bernoulli trials (non-overlapping windows under i.i.d. bases), the hit count $X$ is binomial with parameters $(M, p_{\\text{hit}})$. Therefore,\n$$\n\\mathbb{E}[X] = M p_{\\text{hit}}, \\quad \\operatorname{Var}(X) = M p_{\\text{hit}} (1 - p_{\\text{hit}}).\n$$\nSubstituting $M = 1{,}500{,}000$ and $p_{\\text{hit}} = 0.04$,\n$$\n\\mathbb{E}[X] = 1{,}500{,}000 \\times 0.04 = 60{,}000,\n$$\n$$\n\\operatorname{Var}(X) = 1{,}500{,}000 \\times 0.04 \\times 0.96 = 57{,}600.\n$$\n\nFinally, round to four significant figures. Expressing in standard scientific notation:\n$$\n\\mathbb{E}[X] \\approx 6.000 \\times 10^{4}, \\quad \\operatorname{Var}(X) \\approx 5.760 \\times 10^{4}.\n$$\nThe expected count is in counts, and the variance is in counts squared, as required.", "answer": "$$\\boxed{\\begin{pmatrix}6.000 \\times 10^{4} & 5.760 \\times 10^{4}\\end{pmatrix}}$$", "id": "4551342"}, {"introduction": "Once a PAM is located, the strength of Cas9 binding is determined by the hybridization between the sgRNA and the target DNA, where the \"seed region\" plays a disproportionately large role. This practice uses a simplified but powerful model from statistical thermodynamics to quantify the impact of mismatch location on binding affinity. Deriving the change in binding probability when a mismatch moves from the seed to a distal region provides a tangible, first-principles understanding of this critical design rule for effective guides [@problem_id:4551374].", "problem": "A single-guide RNA (sgRNA) of length $20$ is used by Clustered Regularly Interspaced Short Palindromic Repeats-CRISPR associated protein 9 (CRISPR-Cas9) to interrogate a genomic target. Positions are indexed so that position $1$ is the nucleotide immediately proximal to the Protospacer Adjacent Motif (PAM), and the seed region is defined as positions $1$ through $10$. Consider two single-mismatch scenarios for the same target relative to the sgRNA: case $\\mathrm{A}$ has a single mismatch at position $5$ (inside the seed), and case $\\mathrm{B}$ has a single mismatch at position $15$ (outside the seed).\n\nDefine the seed match score $S$ for a target as the number of matching positions within the seed region (positions $1$ to $10$). Assume the following physically motivated, thermodynamically consistent model for binding free energy and occupancy:\n- The perfect-match reduced free energy (in units of $k_{B}T$ at temperature $T$) is $g_{0} = \\Delta G_{0}/(k_{B}T) = -40$.\n- Each mismatch in the seed region contributes an additive reduced penalty $\\delta_{s} = 6$, and each mismatch outside the seed contributes an additive reduced penalty $\\delta_{d} = 2$.\n- The reduced chemical potential of active Cas9–sgRNA in the grand canonical ensemble is $\\tilde{\\mu} = \\mu/(k_{B}T) = -38$.\n\nUse only fundamental laws and core definitions from statistical thermodynamics and molecular recognition to:\n- Compute the seed match score $S$ for case $\\mathrm{A}$ and for case $\\mathrm{B}$.\n- Derive, from first principles, the predicted site occupancy probability $p$ as a function of reduced free energy and reduced chemical potential, and then evaluate the fold-change $R$ in predicted binding probability when the mismatch is moved from seed (case $\\mathrm{A}$) to distal (case $\\mathrm{B}$), i.e., $R = p_{\\mathrm{B}}/p_{\\mathrm{A}}$.\n\nReport only the numerical value of $R$ as a dimensionless number, rounded to four significant figures. Do not include any units in your final reported value.", "solution": "The problem asks for two main calculations: the seed match score for two scenarios and the fold-change in binding probability between them. We will address these in sequence.\n\nFirst, we determine the seed match score, $S$, for each case. The sgRNA has a length of $20$ nucleotides. The seed region is defined as positions $1$ through $10$. The score $S$ is the number of matching base pairs within this $10$-nucleotide seed region.\n\nFor case $\\mathrm{A}$, there is a single mismatch at position $5$. Since position $5$ is within the seed region (positions $1$ to $10$), this mismatch reduces the number of matches in the seed by one. Therefore, the seed match score for case $\\mathrm{A}$ is:\n$$S_{\\mathrm{A}} = 10 - 1 = 9$$\n\nFor case $\\mathrm{B}$, there is a single mismatch at position $15$. Since position $15$ is outside the seed region (it is in the distal region, positions $11$ to $20$), all positions within the seed are perfect matches. Therefore, the seed match score for case $\\mathrm{B}$ is:\n$$S_{\\mathrm{B}} = 10 - 0 = 10$$\n\nNext, we calculate the reduced binding free energy for each case. The model for the reduced free energy, $g$, is given by $g = g_{0} + n_{s}\\delta_{s} + n_{d}\\delta_{d}$, where $g_{0}$ is the perfect-match reduced free energy, $n_{s}$ is the number of mismatches in the seed region, $\\delta_{s}$ is the seed mismatch penalty, $n_{d}$ is the number of mismatches outside the seed region, and $\\delta_{d}$ is the distal mismatch penalty.\n\nThe given parameters are:\n- Perfect-match reduced free energy: $g_{0} = -40$\n- Seed mismatch penalty: $\\delta_{s} = 6$\n- Distal mismatch penalty: $\\delta_{d} = 2$\n\nFor case $\\mathrm{A}$ (mismatch at position $5$), we have one seed mismatch and zero distal mismatches. Thus, $n_{s} = 1$ and $n_{d} = 0$. The reduced free energy $g_{\\mathrm{A}}$ is:\n$$g_{\\mathrm{A}} = g_{0} + (1)\\delta_{s} + (0)\\delta_{d} = -40 + 6 = -34$$\n\nFor case $\\mathrm{B}$ (mismatch at position $15$), we have zero seed mismatches and one distal mismatch. Thus, $n_{s} = 0$ and $n_{d} = 1$. The reduced free energy $g_{\\mathrm{B}}$ is:\n$$g_{\\mathrm{B}} = g_{0} + (0)\\delta_{s} + (1)\\delta_{d} = -40 + 2 = -38$$\n\nNow, we must derive the site occupancy probability, $p$, from first principles of statistical thermodynamics. We consider a single genomic target site in a grand canonical ensemble, where it can exchange energy and particles (Cas9–sgRNA complexes) with a large reservoir. The reservoir is characterized by a constant temperature $T$ and chemical potential $\\mu$.\n\nThe target site can exist in two states:\n$1$. Unbound state: The site is empty. The binding energy is taken as the reference, $E_{unbound} = 0$. The number of bound particles is $N_{unbound} = 0$.\n$2$. Bound state: The site is occupied by one Cas9–sgRNA complex. The binding energy is $E_{bound} = \\Delta G$. The number of bound particles is $N_{bound} = 1$.\n\nThe probability of the system being in a specific state $i$ is given by the Gibbs distribution:\n$$P_{i} = \\frac{1}{\\mathcal{Z}} \\exp\\left(-\\frac{E_{i} - \\mu N_{i}}{k_{B}T}\\right)$$\nwhere $\\mathcal{Z}$ is the grand partition function, which is the sum of the statistical factors for all possible states. In terms of the reduced free energy $g = \\Delta G / (k_{B}T)$ and reduced chemical potential $\\tilde{\\mu} = \\mu / (k_{B}T)$, the probability is:\n$$P_{i} = \\frac{1}{\\mathcal{Z}} \\exp(-(g_{i} - \\tilde{\\mu} N_{i}))$$\n\nThe grand partition function $\\mathcal{Z}$ is the sum over the unbound and bound states:\n$$\\mathcal{Z} = \\sum_{i \\in \\{\\text{unbound, bound}\\}} \\exp(-(g_{i} - \\tilde{\\mu} N_{i}))$$\nFor the unbound state: $\\exp(-(0 - \\tilde{\\mu} \\cdot 0)) = \\exp(0) = 1$.\nFor the bound state: $\\exp(-(g - \\tilde{\\mu} \\cdot 1)) = \\exp(-(g - \\tilde{\\mu}))$.\nTherefore, the partition function is:\n$$\\mathcal{Z} = 1 + \\exp(-(g - \\tilde{\\mu}))$$\n\nThe site occupancy probability, $p$, is the probability of the site being in the bound state:\n$$p = P_{\\text{bound}} = \\frac{\\exp(-(g - \\tilde{\\mu}))}{\\mathcal{Z}} = \\frac{\\exp(-(g - \\tilde{\\mu}))}{1 + \\exp(-(g - \\tilde{\\mu}))}$$\nThis expression can be rearranged to the form of a Fermi-Dirac distribution:\n$$p = \\frac{1}{\\exp(g - \\tilde{\\mu}) + 1}$$\nThis is the desired first-principles expression for the site occupancy probability.\n\nFinally, we use this formula to compute the probabilities $p_{\\mathrm{A}}$ and $p_{\\mathrm{B}}$ and their ratio $R = p_{\\mathrm{B}}/p_{\\mathrm{A}}$. The reduced chemical potential is given as $\\tilde{\\mu} = -38$.\n\nFor case $\\mathrm{A}$, with $g_{\\mathrm{A}} = -34$:\n$$p_{\\mathrm{A}} = \\frac{1}{\\exp(g_{\\mathrm{A}} - \\tilde{\\mu}) + 1} = \\frac{1}{\\exp(-34 - (-38)) + 1} = \\frac{1}{\\exp(4) + 1}$$\n\nFor case $\\mathrm{B}$, with $g_{\\mathrm{B}} = -38$:\n$$p_{\\mathrm{B}} = \\frac{1}{\\exp(g_{\\mathrm{B}} - \\tilde{\\mu}) + 1} = \\frac{1}{\\exp(-38 - (-38)) + 1} = \\frac{1}{\\exp(0) + 1} = \\frac{1}{1 + 1} = \\frac{1}{2}$$\n\nThe fold-change $R$ is the ratio of these probabilities:\n$$R = \\frac{p_{\\mathrm{B}}}{p_{\\mathrm{A}}} = \\frac{\\frac{1}{2}}{\\frac{1}{\\exp(4) + 1}} = \\frac{\\exp(4) + 1}{2}$$\n\nNow we compute the numerical value and round to four significant figures.\n$$R = \\frac{\\exp(4) + 1}{2} \\approx \\frac{54.59815 + 1}{2} = \\frac{55.59815}{2} \\approx 27.799075$$\nRounding to four significant figures gives $27.80$.\nThis result demonstrates that moving a single mismatch from the seed region to the distal region can increase the binding probability by a factor of approximately $28$, highlighting the critical importance of the seed region for CRISPR-Cas9 target recognition.", "answer": "$$\\boxed{27.80}$$", "id": "4551374"}, {"introduction": "After Cas9 induces a double-strand break, cellular repair via Non-Homologous End Joining (NHEJ) generates a stochastic mixture of insertions and deletions (indels). This exercise models this repair process to predict its most important functional consequence in coding regions: the rate of frameshift mutations. By deriving a closed-form expression for the frameshift probability from a model of indel lengths, you will learn how to link the statistics of molecular repair events to predictable genetic outcomes [@problem_id:4551385].", "problem": "A laboratory performs Clustered Regularly Interspaced Short Palindromic Repeats-CRISPR-associated protein 9 (CRISPR-Cas9) editing to generate gene knockouts in a human coding sequence. Under non-homologous end joining, repair outcomes are insertions and deletions (indels) that change the coding sequence length by an integer number of nucleotides. By the Central Dogma and the genetic code, translation proceeds in triplet codons of length $3$, so any net length change that is not divisible by $3$ induces a frameshift, while net changes divisible by $3$ preserve the reading frame.\n\nAssume the following informatics model for the distribution of indel lengths conditioned on the occurrence of an indel:\n- With probability $\\alpha \\in (0,1)$, the outcome is a deletion of length $\\ell \\in \\{1,2,3,\\dots\\}$ nucleotides. Conditional on deletion, the deletion length has a geometric probability mass function $P(\\ell \\mid \\text{del}) = (1 - r_{d})\\, r_{d}^{\\ell - 1}$ for a parameter $r_{d} \\in (0,1)$.\n- With probability $1 - \\alpha$, the outcome is an insertion of length $\\ell \\in \\{1,2,3,\\dots\\}$ nucleotides. Conditional on insertion, the insertion length has a geometric probability mass function $P(\\ell \\mid \\text{ins}) = (1 - r_{i})\\, r_{i}^{\\ell - 1}$ for a parameter $r_{i} \\in (0,1)$.\n\nHere, the geometric distribution is on the positive integers and models the empirically observed heavy tail of indel lengths under repair. Assume independence between the indel sign (deletion versus insertion) and the corresponding length distributions given above, and consider the net indel length $\\ell$ as the absolute number of nucleotides changed, since the sign does not affect the reading-frame congruence modulo $3$.\n\nStarting from the codon-triplet principle ($3$ nucleotides per codon) and standard probability rules, derive the expected frameshift rate $P(\\text{frameshift})$ as a closed-form analytic expression in terms of $\\alpha$, $r_{d}$, and $r_{i}$. Provide your final result as a single exact expression; no numerical approximation or rounding is required. Then, based on the derived expression, explain qualitatively in your derivation how the frameshift rate depends on the deletion bias $\\alpha$ when $r_{d}$ and $r_{i}$ differ.", "solution": "The total probability of a frameshift is the main quantity of interest. A frameshift occurs if the indel length $\\ell$ is not a multiple of $3$, i.e., $\\ell \\not\\equiv 0 \\pmod 3$. It is more convenient to first calculate the probability of an in-frame event, $P(\\text{in-frame})$, where $\\ell$ is a multiple of $3$. The frameshift rate is then given by $P(\\text{frameshift}) = 1 - P(\\text{in-frame})$.\n\nBy the law of total probability, the overall probability of an in-frame event is the weighted sum of the conditional probabilities of in-frame events for deletions and insertions:\n$$P(\\text{in-frame}) = P(\\text{in-frame} \\mid \\text{del})P(\\text{del}) + P(\\text{in-frame} \\mid \\text{ins})P(\\text{ins})$$\nGiven $P(\\text{del}) = \\alpha$ and $P(\\text{ins}) = 1 - \\alpha$, this becomes:\n$$P(\\text{in-frame}) = \\alpha P(\\text{in-frame} \\mid \\text{del}) + (1 - \\alpha) P(\\text{in-frame} \\mid \\text{ins})$$\n\nLet's calculate the conditional probability of an in-frame event, given that a deletion has occurred, $P(\\text{in-frame} \\mid \\text{del})$. This corresponds to the sum of probabilities for all deletion lengths $\\ell$ that are multiples of $3$. These lengths are $\\ell \\in \\{3, 6, 9, \\dots\\}$, which can be written as $\\ell = 3k$ for $k \\in \\{1, 2, 3, \\dots\\}$.\n$$P(\\text{in-frame} \\mid \\text{del}) = \\sum_{k=1}^{\\infty} P(\\ell = 3k \\mid \\text{del})$$\nSubstituting the given geometric probability mass function:\n$$P(\\text{in-frame} \\mid \\text{del}) = \\sum_{k=1}^{\\infty} (1 - r_{d}) r_{d}^{3k - 1}$$\nWe can factor out the constant terms:\n$$P(\\text{in-frame} \\mid \\text{del}) = (1 - r_{d}) r_{d}^{-1} \\sum_{k=1}^{\\infty} r_{d}^{3k} = \\frac{1 - r_{d}}{r_{d}} \\sum_{k=1}^{\\infty} (r_{d}^{3})^{k}$$\nThe sum is a geometric series with first term $a = r_{d}^3$ and common ratio $r = r_{d}^3$. Since $r_d \\in (0,1)$, we have $|r_d^3| < 1$, so the series converges to $\\frac{a}{1-r} = \\frac{r_d^3}{1 - r_d^3}$.\n$$P(\\text{in-frame} \\mid \\text{del}) = \\frac{1 - r_{d}}{r_{d}} \\left( \\frac{r_{d}^3}{1 - r_{d}^3} \\right) = (1 - r_{d}) \\frac{r_d^2}{1 - r_d^3}$$\nUsing the factorization $1 - x^3 = (1-x)(1+x+x^2)$, we simplify:\n$$P(\\text{in-frame} \\mid \\text{del}) = (1 - r_{d}) \\frac{r_d^2}{(1 - r_{d})(1 + r_{d} + r_{d}^2)} = \\frac{r_{d}^2}{1 + r_{d} + r_{d}^2}$$\n\nThe problem setup for insertions is structurally identical to that for deletions, with parameter $r_i$ instead of $r_d$. By symmetry, the conditional probability of an in-frame event for an insertion is:\n$$P(\\text{in-frame} \\mid \\text{ins}) = \\frac{r_{i}^2}{1 + r_{i} + r_{i}^2}$$\n\nNow we can calculate the total probability of an in-frame event:\n$$P(\\text{in-frame}) = \\alpha \\frac{r_{d}^2}{1 + r_{d} + r_{d}^2} + (1 - \\alpha) \\frac{r_{i}^2}{1 + r_{i} + r_{i}^2}$$\n\nThe frameshift rate is $P(\\text{frameshift}) = 1 - P(\\text{in-frame})$.\n$$P(\\text{frameshift}) = 1 - \\left( \\alpha \\frac{r_{d}^2}{1 + r_{d} + r_{d}^2} + (1 - \\alpha) \\frac{r_{i}^2}{1 + r_{i} + r_{i}^2} \\right)$$\nRearranging the terms by writing $1 = \\alpha + (1 - \\alpha)$:\n$$P(\\text{frameshift}) = \\alpha \\left( 1 - \\frac{r_{d}^2}{1 + r_{d} + r_{d}^2} \\right) + (1 - \\alpha) \\left( 1 - \\frac{r_{i}^2}{1 + r_{i} + r_{i}^2} \\right)$$\n$$P(\\text{frameshift}) = \\alpha \\left( \\frac{1 + r_{d} + r_{d}^2 - r_{d}^2}{1 + r_{d} + r_{d}^2} \\right) + (1 - \\alpha) \\left( \\frac{1 + r_{i} + r_{i}^2 - r_{i}^2}{1 + r_{i} + r_{i}^2} \\right)$$\nThis simplifies to the final closed-form expression:\n$$P(\\text{frameshift}) = \\alpha \\frac{1 + r_{d}}{1 + r_{d} + r_{d}^2} + (1 - \\alpha) \\frac{1 + r_{i}}{1 + r_{i} + r_{i}^2}$$\n\nFor the qualitative analysis, we examine how $P(\\text{frameshift})$ depends on $\\alpha$ when $r_{d}$ and $r_{i}$ differ. The expression is a linear interpolation between the conditional frameshift rate for deletions, $F_d = \\frac{1 + r_{d}}{1 + r_{d} + r_{d}^2}$, and the conditional frameshift rate for insertions, $F_i = \\frac{1 + r_{i}}{1 + r_{i} + r_{i}^2}$.\nThe dependence on $\\alpha$ is determined by the relative magnitudes of $F_d$ and $F_i$. Let's analyze the function $f(r) = \\frac{1 + r}{1 + r + r^2}$ for $r \\in (0,1)$. Its derivative is:\n$$f'(r) = \\frac{(1)(1+r+r^2) - (1+r)(1+2r)}{(1+r+r^2)^2} = \\frac{1+r+r^2 - (1+3r+2r^2)}{(1+r+r^2)^2} = \\frac{-2r-r^2}{(1+r+r^2)^2} = -\\frac{r(2+r)}{(1+r+r^2)^2}$$\nSince $r \\in (0,1)$, we have $r > 0$ and $(2+r) > 0$, so $f'(r) < 0$. This means that $f(r)$ is a strictly decreasing function of $r$ on the interval $(0,1)$.\n\nThe parameter $r$ controls the tail of the geometric distribution; a larger $r$ corresponds to a heavier tail and thus longer average indel lengths, since $E[\\ell] = \\frac{1}{1-r}$. The fact that $f(r)$ is decreasing implies that processes generating longer indels (larger $r$) have a lower conditional frameshift rate. This is because longer indels have a higher chance of their length being a multiple of $3$, whereas very short indels are almost exclusively of length $1$ or $2$, which are always frameshifting. In the limit as $r \\to 0$, $f(r) \\to 1$, as only indels of length $\\ell=1$ are probable. In the limit as $r \\to 1$, $f(r) \\to \\frac{2}{3}$, as the probabilities of lengths having remainders $0, 1, 2$ modulo $3$ become equal ($\\frac{1}{3}$ each).\n\nThe relationship is as follows:\n- If $r_{d} < r_{i}$, then from the decreasing nature of $f(r)$, we have $F_d = f(r_d) > f(r_i) = F_i$. Deletions (which are shorter on average) have a higher intrinsic frameshift rate than insertions. In this case, increasing $\\alpha$ (the probability of deletion) increases the overall frameshift rate $P(\\text{frameshift})$, as more weight is given to the higher-rate process.\n- If $r_{d} > r_{i}$, then $F_d < F_i$. Deletions (which are longer on average) have a lower intrinsic frameshift rate. Increasing $\\alpha$ will decrease the overall frameshift rate by giving more weight to the lower-rate process.\n- If $r_{d} = r_{i}$, then $F_d = F_i$, and the overall frameshift rate $P(\\text{frameshift})$ is independent of $\\alpha$.\n\nIn summary, the total frameshift rate shifts towards the intrinsic rate of the more probable event type (deletion or insertion). The event type characterized by shorter average indel lengths (smaller $r$ parameter) will have a higher intrinsic frameshift rate.", "answer": "$$\\boxed{\\alpha \\frac{1 + r_{d}}{1 + r_{d} + r_{d}^2} + (1 - \\alpha) \\frac{1 + r_{i}}{1 + r_{i} + r_{i}^2}}$$", "id": "4551385"}]}