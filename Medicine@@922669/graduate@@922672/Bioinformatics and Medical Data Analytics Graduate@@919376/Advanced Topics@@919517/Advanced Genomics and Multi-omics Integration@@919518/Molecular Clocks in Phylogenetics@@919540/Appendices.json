{"hands_on_practices": [{"introduction": "The foundation of any molecular clock analysis is the ability to convert observed genetic differences into an estimate of time. This first exercise takes us back to first principles, using the classic Jukes-Cantor model to perform this fundamental calculation. By working through this problem [@problem_id:4586166], you will gain a hands-on understanding of how substitution models correct for unobserved changes and how the core parameters of rate and time are mathematically linked.", "problem": "In a clinical viral genomics study, two independently sampled Influenza A virus hemagglutinin coding sequences were aligned across a sufficiently long region such that sampling noise in the observed differences is negligible. The observed proportion of nucleotide differences (uncorrected Hamming distance) between the two aligned sequences is $p = 0.015$. Prior molecular clock analyses based on dated samples indicate that the pairwise accumulation rate of substitutions per site across both descendant lineages combined is $r = 2.4 \\times 10^{-3}$ substitutions per site per year.\n\nAssume the Jukes–Cantor 1969 (JC69) model of nucleotide substitution, which is a Continuous-Time Markov Chain (CTMC) on the alphabet $\\{A,C,G,T\\}$ with equal state frequencies and equal off-diagonal instantaneous rates. Let the single-lineage CTMC have generator matrix $Q$ with off-diagonal entries $Q_{ij} = \\alpha$ for $i \\neq j$ and diagonal entries $Q_{ii} = -3\\alpha$, and let the single-lineage per-site substitution rate be $\\mu = 3\\alpha$. Under a strict molecular clock, the two descendant lineages evolve independently for the same divergence time $t$, and the pairwise rate satisfies $r = 2\\mu$.\n\nStarting from these foundations, derive an expression for the divergence time $t$ as a function of the observable $p$ and the known rate $r$, and then evaluate $t$ numerically for the given $p$ and $r$. Round your final numerical answer to four significant figures and express the time in years. As part of your derivation, clearly articulate the assumptions needed for the expression to be valid, and state any restrictions on $p$ that must hold for the model-based inversion to yield a finite real-valued time.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in molecular phylogenetics based on the foundational Jukes-Cantor model. All necessary parameters are provided, and there are no internal contradictions.\n\nThe solution proceeds in four stages:\n1.  Derivation of the relationship between the observed proportion of differences, $p$, and divergence time, $t$.\n2.  Inversion of this relationship to find an expression for $t$ as a function of $p$ and the pairwise substitution rate, $r$.\n3.  Statement of the assumptions and the mathematical restrictions on the value of $p$.\n4.  Numerical evaluation of $t$ using the provided data.\n\nLet us begin with the Jukes-Cantor 1969 (JC69) model. It is a Continuous-Time Markov Chain (CTMC) for nucleotide substitution. For a single lineage, the instantaneous rate matrix $Q$ is given by\n$$\nQ = \\begin{pmatrix} -3\\alpha & \\alpha & \\alpha & \\alpha \\\\ \\alpha & -3\\alpha & \\alpha & \\alpha \\\\ \\alpha & \\alpha & -3\\alpha & \\alpha \\\\ \\alpha & \\alpha & \\alpha & -3\\alpha \\end{pmatrix}\n$$\nwhere $\\alpha$ is the rate of substitution from any nucleotide to any other specific nucleotide.\n\nThe problem considers two sequences that diverged from a common ancestor $t$ years ago. Under a strict molecular clock, they evolve independently along two lineages of equal duration $t$. We want to find the probability, $p$, that at a given homologous site, the nucleotides in the two sequences are different. Let this probability be denoted $p_{\\text{diff}}(t)$. At time $t=0$ (the common ancestor), the sequences are identical, so $p_{\\text{diff}}(0) = 0$.\n\nLet's model the evolution of the state of the pair of sites. A pair of sites can be in one of two states: \"same\" (S) or \"different\" (D).\nA transition from S to D occurs if a substitution happens in one lineage but not the other. The rate of substitution for any nucleotide to any of the other three is $3\\alpha$. Since this can happen in either of the two lineages, the rate of transition from S to D is $2 \\times 3\\alpha = 6\\alpha$.\nA transition from D to S can occur if the nucleotide in one lineage mutates to match the nucleotide in the other. For example, if the sites are A and C, the A can mutate to C (rate $\\alpha$) or the C can mutate to A (rate $\\alpha$). So, the total rate of transition from D to S is $2\\alpha$.\n\nThis defines a two-state CTMC on $\\{S, D\\}$, and the probability of being in the \"different\" state, $p_{\\text{diff}}(t)$, follows the differential equation:\n$$\n\\frac{dp_{\\text{diff}}(t)}{dt} = (\\text{rate S}\\to\\text{D}) \\cdot p_{\\text{same}}(t) - (\\text{rate D}\\to\\text{S}) \\cdot p_{\\text{diff}}(t)\n$$\nSubstituting the rates and using the fact that $p_{\\text{same}}(t) = 1 - p_{\\text{diff}}(t)$, we get:\n$$\n\\frac{dp_{\\text{diff}}(t)}{dt} = 6\\alpha (1 - p_{\\text{diff}}(t)) - 2\\alpha \\, p_{\\text{diff}}(t) = 6\\alpha - 8\\alpha \\, p_{\\text{diff}}(t)\n$$\nThis is a first-order linear ordinary differential equation. The general solution is of the form $p_{\\text{diff}}(t) = A \\exp(-8\\alpha t) + B$. The particular solution $B$ is found by setting the derivative to zero: $0 = 6\\alpha - 8\\alpha B$, which gives $B = 6\\alpha / (8\\alpha) = 3/4$. So, $p_{\\text{diff}}(t) = A \\exp(-8\\alpha t) + 3/4$.\nUsing the initial condition $p_{\\text{diff}}(0) = 0$, we find $A$:\n$0 = A \\exp(0) + 3/4 \\implies A = -3/4$.\nThus, the proportion of different sites as a function of divergence time $t$ is:\n$$\np(t) = \\frac{3}{4} \\left(1 - \\exp(-8\\alpha t)\\right)\n$$\nThe problem provides the observed difference $p=0.015$, which corresponds to $p(t)$.\n\nNext, we express this equation in terms of the given pairwise rate $r$. The single-lineage substitution rate, $\\mu$, is the expected number of substitutions per site per unit time. For JC69, it is given as $\\mu = 3\\alpha$. The pairwise rate of substitution accumulation, $r$, is the rate for the pair of lineages combined. Therefore, $r = 2\\mu$. Substituting $\\mu = 3\\alpha$, we get $r = 2(3\\alpha) = 6\\alpha$. This allows us to write $\\alpha = r/6$.\nSubstituting this into our expression for $p(t)$:\n$$\np = \\frac{3}{4} \\left(1 - \\exp(-8(r/6) t)\\right) = \\frac{3}{4} \\left(1 - \\exp\\left(-\\frac{4}{3}rt\\right)\\right)\n$$\nNow, we invert this expression to solve for the divergence time $t$:\n$$\n\\frac{4}{3} p = 1 - \\exp\\left(-\\frac{4}{3}rt\\right)\n$$\n$$\n\\exp\\left(-\\frac{4}{3}rt\\right) = 1 - \\frac{4}{3}p\n$$\n$$\n-\\frac{4}{3}rt = \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n$$\nt = -\\frac{3}{4r} \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\nThis is the desired expression for $t$ as a function of $p$ and $r$.\n\nThe key assumptions for this derivation to be valid are:\n1.  The Jukes-Cantor model of nucleotide substitution is an accurate description of the evolutionary process. This includes equal equilibrium base frequencies ($\\pi_A = \\pi_C = \\pi_G = \\pi_T = 1/4$) and equal rates for all types of substitutions.\n2.  A strict molecular clock holds, meaning the substitution rate $\\mu$ is constant across lineages and through time.\n3.  The two lineages evolve independently after diverging from their most recent common ancestor.\n4.  The observed proportion of differences, $p$, is free of sampling error and accurately reflects the expected value $p(t)$.\n\nFor the expression to yield a finite, real, and positive time $t$, the argument of the natural logarithm must be strictly between $0$ and $1$:\n$$\n0 < 1 - \\frac{4}{3}p < 1\n$$\nThe right side of the inequality, $1 - \\frac{4}{3}p < 1$, implies $-\\frac{4}{3}p < 0$, which is true for any $p > 0$. The case $p=0$ yields $t=0$.\nThe left side of the inequality, $0 < 1 - \\frac{4}{3}p$, implies $\\frac{4}{3}p < 1$, which means $p < 3/4$.\nTherefore, the restriction on the observable $p$ is $0 \\le p < 0.75$. If $p \\ge 0.75$, the model suggests that the sequences are saturated with substitutions, and a finite divergence time cannot be estimated.\n\nFinally, we evaluate $t$ numerically with the given values $p = 0.015$ and $r = 2.4 \\times 10^{-3}$ substitutions per site per year.\nFirst, we check that $p$ is within the valid range: $0.015 < 0.75$, so the calculation is valid.\nSubstituting the values into the derived formula:\n$$\nt = -\\frac{3}{4 \\times (2.4 \\times 10^{-3})} \\ln\\left(1 - \\frac{4}{3} \\times 0.015\\right)\n$$\nFirst, calculate the term inside the logarithm:\n$$\n\\frac{4}{3} \\times 0.015 = 4 \\times 0.005 = 0.02\n$$\n$$\n1 - 0.02 = 0.98\n$$\nNow, substitute this back into the expression for $t$:\n$$\nt = -\\frac{3}{9.6 \\times 10^{-3}} \\ln(0.98)\n$$\nThe pre-factor is:\n$$\n\\frac{3}{9.6 \\times 10^{-3}} = \\frac{3}{0.0096} = 312.5\n$$\nSo, the expression becomes:\n$$\nt = -312.5 \\times \\ln(0.98)\n$$\nUsing a calculator for the natural logarithm:\n$$\n\\ln(0.98) \\approx -0.020202707\n$$\n$$\nt \\approx -312.5 \\times (-0.020202707) \\approx 6.3133459 \\text{ years}\n$$\nRounding the result to four significant figures, we get $t \\approx 6.313$ years.", "answer": "$$\\boxed{6.313}$$", "id": "4586166"}, {"introduction": "Modern phylogenetic dating predominantly uses Bayesian methods, where sequence data (the likelihood) is combined with external information like fossils (the priors). This thought experiment [@problem_id:4586180] explores a critical and common challenge in these analyses: the sensitivity of results to the specification of priors. You will reason through how changing a fossil calibration prior impacts the estimated rates and times, developing crucial intuition about the interplay between likelihood and prior in resolving the non-identifiability of rate and time.", "problem": "A Bayesian molecular clock analysis is performed on two sister taxa under a strict clock, using a single fossil calibration on their most recent common ancestor. Let the sequence length be $L=20{,}000$ sites, and the observed number of differences be $K=2{,}400$. Assume a homogeneous Poisson substitution process, in which the expected number of substitutions along a branch is the product of the per-site substitution rate $r$ and branch duration $t$, and the differences observed between two lineages reflect the sum of substitutions accumulated along both branches. The analyst uses a broad prior for the per-site per-million-years substitution rate $r$, modeled as a Gamma distribution with shape $a$ and rate $b$, and a fossil calibration prior for the node age $t$ modeled as a truncated Lognormal distribution with a minimum bound $t_{\\min}=10$ million years (Myr) and a mode near $12$ Myr. After review, the prior is corrected to a less restrictive minimum bound $t_{\\min}=1$ Myr with a mode near $3$ Myr, keeping the Gamma prior on $r$ unchanged and leaving the sequence data $K$ and $L$ unchanged. Assume the strict molecular clock with identical rates on both branches and that the likelihood for $K$ given $r$, $t$, and $L$ arises from the Poisson model specified above. Use Bayes’ rule, the definition of the molecular clock in terms of expected substitutions, and the identifiability structure of $(r,t)$ under a single calibrated node to reason about how the joint posterior over $(r,t)$ shifts when the calibration prior is corrected.\n\nWhich statement best describes the direction and structural reason for the shift in the posterior distributions of $r$ and $t$ when replacing the mis-specified calibration with the corrected calibration?\n\nA. With an overly high minimum age, the posterior mass for $t$ is pushed to older values, and the posterior for $r$ is correspondingly pushed lower to satisfy the data-implied constraint on the product of $r$ and $t$. Correcting the minimum age to be less restrictive shifts the posterior toward younger $t$ and higher $r$ along the same likelihood ridge determined by the observed differences.\n\nB. A high minimum age prior forces the posterior rate $r$ higher to match the observed differences, and correcting it lowers $r$ while leaving $t$ approximately unchanged because the likelihood depends primarily on $r$.\n\nC. Under a strict clock with a single calibration, the posterior of $r$ and $t$ is identifiable independently of the calibration prior; therefore, correcting the minimum age will not change the posterior means of $r$ or $t$.\n\nD. Correcting an overly restrictive minimum age necessarily increases both the posterior mean of $t$ and the posterior mean of $r$ because more prior mass is available for both parameters.", "solution": "The user wants a critical validation of the problem statement, followed by a detailed derivation and evaluation of the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Analysis:** Bayesian molecular clock.\n-   **Taxa:** Two sister taxa.\n-   **Clock Model:** Strict clock.\n-   **Calibration:** Single fossil calibration on the most recent common ancestor (MRCA).\n-   **Sequence Data:** Length $L=20{,}000$ sites, observed differences $K=2{,}400$.\n-   **Substitution Model:** Homogeneous Poisson process. Expected substitutions on a branch are $r \\times t$, where $r$ is the per-site substitution rate and $t$ is the branch duration. Observed differences between two lineages reflect the sum of substitutions on both branches.\n-   **Prior on Rate $r$:** Gamma distribution, $P(r) = \\text{Gamma}(r | a, b)$. This prior is unchanged.\n-   **Initial Prior on Age $t$:** Truncated Lognormal distribution with minimum bound $t_{\\min}=10$ million years (Myr) and mode near $12$ Myr.\n-   **Corrected Prior on Age $t$:** Truncated Lognormal distribution with minimum bound $t_{\\min}=1$ Myr with a mode near $3$ Myr.\n-   **Invariants:** The Gamma prior on $r$, sequence data $K$ and $L$, strict clock model, and Poisson likelihood framework are all unchanged between analyses.\n-   **Question:** Describe the shift in the joint posterior distribution of $(r, t)$ when the initial prior on $t$ is replaced by the corrected prior.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem statement describes a standard and well-established methodology in Bayesian phylogenetic dating. The use of a strict molecular clock, Poisson substitution process, Gamma priors for rates, and Lognormal priors for node ages are all canonical choices in software like BEAST or MrBayes. The scenario is scientifically sound and realistic.\n-   **Well-Posed:** The problem is well-posed for a qualitative analysis. It provides all the necessary components of a Bayesian model (likelihood and priors) and asks for the qualitative effect of changing one of the priors. The question has a clear, logical basis and a single conceptual answer derivable from the principles of Bayesian statistics.\n-   **Objective:** The problem is stated using precise, objective terminology from statistics and bioinformatics. It is free of ambiguity and subjective claims.\n-   **Conclusion of Validation:** The problem exhibits no flaws. It is scientifically sound, well-posed, objective, complete for the task, and poses a non-trivial conceptual question.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. The solution process will now proceed.\n\n### Derivation of the Solution\n\nThe core of this problem lies in the interaction between the likelihood function and the prior distributions within a Bayesian framework, particularly in the context of parameter identifiability.\n\n**1. The Likelihood Function and Parameter Identifiability**\nThe two lineages are sister taxa diverging from a common ancestor at time $t$ in the past. Under a strict clock, the evolutionary rate $r$ is the same along both lineages. The total time separating the two sequences is $t + t = 2t$.\n\nThe problem states that the number of substitutions is modeled as a Poisson process. The expected number of substitutions per site along the total divergence path of length $2t$ is the evolutionary distance $d$. This distance is given by $d = r \\times (2t)$.\n\nThe sequence data consist of $K=2{,}400$ differences over $L=20{,}000$ sites. The proportion of different sites is $p = K/L = 2{,}400 / 20{,}000 = 0.12$. This observed proportion $p$ is an estimate of the true evolutionary distance $d$, often adjusted for multiple substitutions at the same site (e.g., using a Jukes-Cantor correction, $d = -\\frac{3}{4}\\ln(1 - \\frac{4}{3}p)$). Regardless of the specific correction, the likelihood of observing $K$ differences is a function of the expected distance $d$.\n$$P(K | r, t, L) = \\text{Likelihood}(d) = \\text{Likelihood}(2rt)$$\nThis means that the likelihood function, $L(r, t | K)$, is determined by the product $rt$. Any pair of $(r, t)$ that yields the same product $rt$ will have the same likelihood. In the parameter space of $(r, t)$, the likelihood function forms a \"ridge\" of high probability along the hyperbola $rt = C$, where $C = d_{\\text{ML}}/2$ is a constant determined by the maximum likelihood estimate of the distance. The data alone cannot distinguish between a high rate $r$ and a short time $t$, or a low rate $r$ and a long time $t$. This is a classic non-identifiability problem.\n\n**2. The Role of Priors in a Bayesian Analysis**\nBayes' rule states that the joint posterior distribution is proportional to the product of the likelihood and the joint prior distribution:\n$$P(r, t | K, L) \\propto P(K | r, t, L) \\cdot P(r, t)$$\nAssuming the priors on $r$ and $t$ are independent, $P(r, t) = P(r) \\cdot P(t)$.\n$$P(r, t | K, L) \\propto \\underbrace{L(r, t | K)}_{\\text{Likelihood}} \\cdot \\underbrace{P(r)}_{\\text{Rate Prior}} \\cdot \\underbrace{P(t)}_{\\text{Age Prior}}$$\nThe posterior distribution will have high density in regions where all three components on the right-hand side are large. The likelihood confines the posterior mass to the ridge $rt \\approx C$. The priors for $r$ and $t$ then determine *where* along this ridge the posterior mass will concentrate.\n\n**3. Analysis of the Shift in the Posterior**\nLet's analyze the two scenarios for the prior on $t$, $P(t)$.\n\n*   **Scenario 1: Mis-specified, restrictive prior.** The prior for time is $P_1(t)$, a truncated Lognormal distribution with $t_{\\min}=10$ Myr and a mode near $12$ Myr. This prior places significant probability mass on large values of $t$ (i.e., $t \\geq 10$ Myr) and zero probability on $t < 10$ Myr. To obtain a high posterior probability, the solution must lie on the likelihood ridge ($rt \\approx C$) and also be in a region of high prior probability. Since $P_1(t)$ forces $t$ to be large, the corresponding value of $r$ on the likelihood ridge must be small (since $r \\approx C/t$). Therefore, the joint posterior distribution will be concentrated in a region of large $t$ and small $r$.\n\n*   **Scenario 2: Corrected, less restrictive prior.** The prior is replaced with $P_2(t)$, a truncated Lognormal distribution with $t_{\\min}=1$ Myr and a mode near $3$ Myr. This prior now places significant probability mass on much smaller values of $t$. The likelihood function remains unchanged because the data ($K, L$) are the same. The prior on $r$, $P(r)$, also remains unchanged. When calculating the new posterior, the model will again seek regions where the likelihood and priors are large. The new prior $P_2(t)$ favors smaller values of $t$. To remain on the same likelihood ridge ($rt \\approx C$), a smaller value of $t$ necessitates a larger value of $r$. Consequently, the joint posterior distribution will shift its mass to a region of smaller $t$ and larger $r$.\n\n**Conclusion:** The correction of the fossil prior from one favoring old ages to one favoring young ages causes the posterior distribution to shift along the likelihood ridge from a region of (high $t$, low $r$) to a region of (low $t$, high $r$).\n\n### Option-by-Option Analysis\n\n**A. With an overly high minimum age, the posterior mass for $t$ is pushed to older values, and the posterior for $r$ is correspondingly pushed lower to satisfy the data-implied constraint on the product of $r$ and $t$. Correcting the minimum age to be less restrictive shifts the posterior toward younger $t$ and higher $r$ along the same likelihood ridge determined by the observed differences.**\nThis statement accurately describes the derived behavior. The initial prior on $t$ is restrictive and forces $t$ to be high, which in turn forces $r$ to be low to match the likelihood constraint ($rt \\approx C$). Correcting the prior to favor smaller $t$ values allows the posterior for $t$ to shift to younger ages, which requires a corresponding shift to higher rates $r$ to remain on the likelihood ridge.\n**Verdict: Correct**\n\n**B. A high minimum age prior forces the posterior rate $r$ higher to match the observed differences, and correcting it lowers $r$ while leaving $t$ approximately unchanged because the likelihood depends primarily on $r$.**\nThis statement is incorrect on two counts. First, a high age prior ($t$) forces the rate ($r$) *lower*, not higher, to maintain the product $rt$. Second, the likelihood does not depend primarily on $r$; it depends on the product $rt$. The time $t$ will change significantly because its prior has been substantially altered.\n**Verdict: Incorrect**\n\n**C. Under a strict clock with a single calibration, the posterior of $r$ and $t$ is identifiable independently of the calibration prior; therefore, correcting the minimum age will not change the posterior means of $r$ or $t$.**\nThis statement fundamentally misunderstands parameter identifiability in this context. With a single calibration, $r$ and $t$ are *not* identifiable from the likelihood alone. The data only identify their product. The calibration prior on the node age $t$ is absolutely essential to break this non-identifiability and obtain separate, well-defined posterior distributions for $r$ and $t$. Changing this critical prior will necessarily change the resulting posteriors.\n**Verdict: Incorrect**\n\n**D. Correcting an overly restrictive minimum age necessarily increases both the posterior mean of $t$ and the posterior mean of $r$ because more prior mass is available for both parameters.**\nThis statement is incorrect. Correcting the prior from one with a mode near $12$ Myr to one with a mode near $3$ Myr will *decrease* the posterior mean of $t$. Furthermore, because $r$ and $t$ are negatively correlated in the posterior (due to the likelihood constraint $rt \\approx C$), a decrease in the mean of $t$ will lead to an *increase* in the mean of $r$. They cannot both increase. The reasoning about \"more prior mass\" is also misleading; the key change is the location of the prior mass for $t$, not its total integral.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "4586180"}, {"introduction": "The assumption of a single, constant \"strict\" molecular clock across an entire phylogeny is often biologically unrealistic. This final practice introduces a common method for diagnosing and addressing this issue by comparing different clock models. Using data from a root-to-tip regression and the Akaike Information Criterion (AIC), you will statistically evaluate whether implementing more complex \"local\" clocks is justified [@problem_id:4586176], illustrating the essential trade-off between model fit and parameter complexity in phylogenetics.", "problem": "A virology surveillance program produced a time-scaled phylogeny of an RNA virus with three well-supported monophyletic clades, denoted $C_1$, $C_2$, and $C_3$. For each tip $i$, the root-to-tip genetic distance $R_i$ (in substitutions per site) and the sampling time $T_i$ (in years, measured on the same absolute time axis across clades) were extracted from the dated tree. To assess molecular clock behavior, a global root-to-tip regression was fit under the linear model $R_i = a + r T_i + \\varepsilon_i$, where $a$ is a shared intercept, $r$ is a shared rate, and $\\varepsilon_i$ are independent errors. The errors are assumed to be independent and identically distributed as a Normal distribution with mean $0$ and variance $\\sigma^2$.\n\nFundamental base:\n- Under a strict molecular clock, branch-specific rates are constant across the tree, implying a linear relationship between accumulated substitutions and time. Root-to-tip regression assesses this by fitting a linear model and inspecting residuals for structure.\n- For a linear model with independent and identically distributed Normal errors, Maximum Likelihood Estimation (MLE) yields the same fit as Ordinary Least Squares (OLS). The Sum of Squared Residuals (SSR) $S = \\sum_i \\varepsilon_i^2$ is a sufficient statistic for goodness of fit, and model selection can be conducted with the Akaike Information Criterion (AIC), defined for a Normal-error regression with $p$ free parameters and $n$ observations by $\\mathrm{AIC} = 2p - 2 \\hat{\\ell}$, where $\\hat{\\ell}$ is the maximized log-likelihood. When $\\sigma^2$ is estimated by $\\hat{\\sigma}^2 = S/n$, this yields the standard form $\\mathrm{AIC} = 2p + n \\ln\\!\\big(S/n\\big) + \\text{constant}$, with the constant canceling in differences between candidate models.\n\nEmpirical summary from the global fit:\n- The global fit used $n = 90$ tips and yielded $\\mathrm{SSR}$ $S_0 = 820$.\n- Let $\\mathbf{e}$ denote the residual vector from the global fit. To test for clade-specific departures from clock-like behavior, consider adding local-rate deviation parameters for clades via predictors $\\mathbf{x}_k = \\big(T_i \\,\\mathbb{1}(i \\in C_k)\\big)$, $k \\in \\{1,2,3\\}$, while retaining the shared intercept and shared global rate. After properly residualizing each $\\mathbf{x}_k$ against the global intercept and time columns (to ensure valid partial sums-of-squares), the reduction in $\\mathrm{SSR}$ from adding a single clade-specific rate deviation is given by $\\Delta_k$, and the $\\Delta_k$ for the three clades were computed as\n  - $\\Delta_1 = 140$,\n  - $\\Delta_2 = 70$,\n  - $\\Delta_3 = 40$.\n- Because the clade-specific predictors have disjoint support and were residualized against the base columns, the total $\\mathrm{SSR}$ reduction from adding any subset of clade-specific deviations equals the sum of the corresponding $\\Delta_k$.\n\nModeling choices:\n- The baseline global-clock model has $p_0 = 2$ parameters ($a$ and $r$).\n- Each added local-rate deviation parameter contributes $+1$ to the parameter count.\n\nQuestion: Using the principle of Maximum Likelihood Estimation (MLE) under the Normal error model and the Akaike Information Criterion (AIC) for model selection, which assignment of local clocks yields the best model (lowest AIC) among the following choices?\n\nA. Apply local clocks to $C_1$ and $C_2$ only (retain a shared intercept and global rate plus two clade deviations).\n\nB. Apply a local clock to $C_1$ only (retain a shared intercept and global rate plus one clade deviation).\n\nC. Apply local clocks to all three clades $C_1$, $C_2$, and $C_3$ (retain a shared intercept and global rate plus three clade deviations).\n\nD. Do not apply any local clock; retain the global clock only.\n\nE. Apply local clocks to $C_2$ and $C_3$ only (retain a shared intercept and global rate plus two clade deviations).", "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness.\n\n**Step 1: Extract Givens**\n- The analysis involves three monophyletic clades: $C_1$, $C_2$, and $C_3$.\n- For each tip $i$, we have the root-to-tip genetic distance $R_i$ and sampling time $T_i$.\n- A global linear model is fit: $R_i = a + r T_i + \\varepsilon_i$.\n- The errors $\\varepsilon_i$ are independent and identically distributed (i.i.d.) from a Normal distribution with mean $0$ and variance $\\sigma^2$.\n- The total number of tips (observations) is $n = 90$.\n- The global fit (baseline model) has $p_0 = 2$ parameters ($a$ and $r$) and yields a Sum of Squared Residuals (SSR) of $S_0 = 820$.\n- The Akaike Information Criterion (AIC) is given by $\\mathrm{AIC} = 2p + n \\ln(S/n)$, ignoring an additive constant, where $p$ is the number of free parameters and $S$ is the SSR for a given model.\n- Adding a local-rate deviation parameter for a clade adds $1$ to the parameter count $p$.\n- The reductions in SSR from adding a single clade-specific rate deviation parameter are:\n  - For $C_1$: $\\Delta_1 = 140$.\n  - For $C_2$: $\\Delta_2 = 70$.\n  - For $C_3$: $\\Delta_3 = 40$.\n- The total SSR reduction for a model with multiple local clocks is the sum of the individual $\\Delta_k$ values for the included clades.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement describes a standard statistical procedure in molecular phylogenetics: using root-to-tip regression to assess the strict molecular clock hypothesis and employing model selection criteria like AIC to compare models with different clock assumptions (e.g., global clock vs. local clocks).\n\n- **Scientifically Grounded:** The concepts of molecular clocks, root-to-tip regression, Sum of Squared Residuals, and the Akaike Information Criterion are fundamental and widely used principles in bioinformatics and statistics. The setup is a canonical example of linear model comparison.\n- **Well-Posed:** The problem is well-posed. It provides all necessary data ($n$, $S_0$, and all $\\Delta_k$) and a clear objective function (minimizing AIC) to uniquely determine the best model among the given choices. The additivity of SSR reductions is a valid consequence of the specified model structure (residualized predictors with disjoint support).\n- **Objective:** The problem is stated using precise, objective mathematical and statistical language. It is free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, and objective. The solution process may proceed.\n\n**Solution Derivation**\nThe task is to identify which of the proposed clock models is best supported by the data, where \"best\" is defined as having the minimum Akaike Information Criterion (AIC). The formula for the AIC to be used for comparison is $\\mathrm{AIC} = 2p + n \\ln(S/n)$, where $p$ is the number of parameters, $n$ is the number of observations, and $S$ is the Sum of Squared Residuals (SSR). We are given $n = 90$.\n\nWe must calculate the AIC for each model described in the options.\n\n**Model D: Global clock only**\nThis is the baseline model.\n- Number of parameters: $p_D = p_0 = 2$ (one intercept $a$, one rate $r$).\n- Sum of Squared Residuals: $S_D = S_0 = 820$.\n- AIC calculation:\n$$ \\mathrm{AIC}_D = 2p_D + n \\ln(S_D/n) = 2(2) + 90 \\ln(820/90) = 4 + 90 \\ln(9.111...) \\approx 4 + 90(2.2095) \\approx 202.86 $$\n\n**Model B: Local clock for $C_1$ only**\nThis model adds one local rate parameter to the global model.\n- Number of parameters: $p_B = p_0 + 1 = 2 + 1 = 3$.\n- Sum of Squared Residuals: The SSR is reduced by $\\Delta_1$.\n$$ S_B = S_0 - \\Delta_1 = 820 - 140 = 680 $$\n- AIC calculation:\n$$ \\mathrm{AIC}_B = 2p_B + n \\ln(S_B/n) = 2(3) + 90 \\ln(680/90) = 6 + 90 \\ln(7.555...) \\approx 6 + 90(2.0223) \\approx 188.01 $$\n\n**Model A: Local clocks for $C_1$ and $C_2$ only**\nThis model adds two local rate parameters.\n- Number of parameters: $p_A = p_0 + 2 = 2 + 2 = 4$.\n- Sum of Squared Residuals: The SSR is reduced by $\\Delta_1 + \\Delta_2$.\n$$ S_A = S_0 - (\\Delta_1 + \\Delta_2) = 820 - (140 + 70) = 820 - 210 = 610 $$\n- AIC calculation:\n$$ \\mathrm{AIC}_A = 2p_A + n \\ln(S_A/n) = 2(4) + 90 \\ln(610/90) = 8 + 90 \\ln(6.777...) \\approx 8 + 90(1.9137) \\approx 180.23 $$\n\n**Model E: Local clocks for $C_2$ and $C_3$ only**\nThis model adds two local rate parameters.\n- Number of parameters: $p_E = p_0 + 2 = 2 + 2 = 4$.\n- Sum of Squared Residuals: The SSR is reduced by $\\Delta_2 + \\Delta_3$.\n$$ S_E = S_0 - (\\Delta_2 + \\Delta_3) = 820 - (70 + 40) = 820 - 110 = 710 $$\n- AIC calculation:\n$$ \\mathrm{AIC}_E = 2p_E + n \\ln(S_E/n) = 2(4) + 90 \\ln(710/90) = 8 + 90 \\ln(7.888...) \\approx 8 + 90(2.0654) \\approx 193.89 $$\n\n**Model C: Local clocks for all three clades $C_1$, $C_2$, and $C_3$**\nThis model adds three local rate parameters.\n- Number of parameters: $p_C = p_0 + 3 = 2 + 3 = 5$.\n- Sum of Squared Residuals: The SSR is reduced by $\\Delta_1 + \\Delta_2 + \\Delta_3$.\n$$ S_C = S_0 - (\\Delta_1 + \\Delta_2 + \\Delta_3) = 820 - (140 + 70 + 40) = 820 - 250 = 570 $$\n- AIC calculation:\n$$ \\mathrm{AIC}_C = 2p_C + n \\ln(S_C/n) = 2(5) + 90 \\ln(570/90) = 10 + 90 \\ln(6.333...) \\approx 10 + 90(1.8458) \\approx 176.12 $$\n\n**Model Comparison**\nThe calculated AIC values are:\n- $\\mathrm{AIC}_D \\approx 202.86$\n- $\\mathrm{AIC}_B \\approx 188.01$\n- $\\mathrm{AIC}_A \\approx 180.23$\n- $\\mathrm{AIC}_E \\approx 193.89$\n- $\\mathrm{AIC}_C \\approx 176.12$\n\nThe best model is the one with the lowest AIC value. Comparing the values:\n$$ 176.12 < 180.23 < 188.01 < 193.89 < 202.86 $$\n$$ \\mathrm{AIC}_C < \\mathrm{AIC}_A < \\mathrm{AIC}_B < \\mathrm{AIC}_E < \\mathrm{AIC}_D $$\nThe minimum AIC value corresponds to Model C.\n\n**Option-by-Option Analysis**\n- **A. Apply local clocks to $C_1$ and $C_2$ only (...):** This model yields an AIC of approximately $180.23$. This is not the lowest value. **Incorrect.**\n- **B. Apply a local clock to $C_1$ only (...):** This model yields an AIC of approximately $188.01$. This is not the lowest value. **Incorrect.**\n- **C. Apply local clocks to all three clades $C_1$, $C_2$, and $C_3$ (...):** This model yields an AIC of approximately $176.12$. This is the lowest AIC among all candidate models. **Correct.**\n- **D. Do not apply any local clock; retain the global clock only:** This model yields an AIC of approximately $202.86$. This is the highest value, indicating the worst fit among the choices. **Incorrect.**\n- **E. Apply local clocks to $C_2$ and $C_3$ only (...):** This model yields an AIC of approximately $193.89$. This is not the lowest value. **Incorrect.**\n\nThe analysis demonstrates that the model incorporating local clocks for all three clades provides the best balance between goodness of fit (lowest SSR) and model complexity (number of parameters), as judged by the Akaike Information Criterion.", "answer": "$$\\boxed{C}$$", "id": "4586176"}]}