{"hands_on_practices": [{"introduction": "A meaningful trajectory requires a defined beginning. In many biological processes, such as embryonic development or cell differentiation, this starting point corresponds to a progenitor or stem cell state. This exercise [@problem_id:2437518] demonstrates how to translate a common biological heuristic—that progenitor cells exhibit a focused expression of specific pluripotency markers—into a precise, quantitative algorithm. By calculating the Shannon entropy of marker gene expression, you will learn to identify the cells that are most likely the origin of the developmental process, a critical first step in any trajectory inference analysis.", "problem": "You are given a finite set of single cells, each measured for multiple genes, and a designated subset of genes that are pluripotency markers. For each cell, define a probability distribution over the marker set by normalizing its nonnegative marker expression vector with an additive nonnegative pseudocount. The Shannon entropy of this distribution quantifies the concentration of pluripotency marker expression within that cell. Define the root cell set as the subset of cells that minimize this Shannon entropy, with ties resolved by preferring larger total marker expression and then smaller cell index. Your task is to write a complete program that implements this definition exactly and returns the selected index or indices for each of several test cases.\n\nFormally, let there be $N$ cells and $G$ genes. Let $X \\in \\mathbb{R}_{\\ge 0}^{N \\times G}$ be the nonnegative expression matrix with entry $x_{i,g}$ denoting the expression of gene $g \\in \\{0,\\dots,G-1\\}$ in cell $i \\in \\{0,\\dots,N-1\\}$. Let $M \\subseteq \\{0,\\dots,G-1\\}$ be the nonempty set of indices of pluripotency marker genes, and let $|M| = K \\ge 1$. For a given nonnegative pseudocount $\\alpha \\in \\mathbb{R}_{\\ge 0}$, define for each cell $i$ the marker vector $v_i \\in \\mathbb{R}_{\\ge 0}^{K}$ with components $v_{i,g} = x_{i,g}$ for $g \\in M$, the smoothed marker vector $w_i$ with components $w_{i,g} = v_{i,g} + \\alpha$, and the normalization constant $s_i = \\sum_{g \\in M} w_{i,g}$. If $s_i > 0$, define the distribution $p_i$ with components $p_{i,g} = \\dfrac{w_{i,g}}{s_i}$. If $s_i = 0$, define $p_i$ to be the uniform distribution on $M$, that is $p_{i,g} = \\dfrac{1}{K}$ for all $g \\in M$. Define the Shannon entropy (using the natural logarithm) for cell $i$ as\n$$\nH_i = - \\sum_{g \\in M} p_{i,g} \\log p_{i,g},\n$$\nwith the usual convention that for any $q \\in [0,1]$, $q \\log q = 0$ when $q = 0$. Define also the total marker expression without pseudocount as\n$$\nS_i = \\sum_{g \\in M} v_{i,g} = \\sum_{g \\in M} x_{i,g}.\n$$\nGiven a target number of roots $r \\in \\{1,2,\\dots,N\\}$, define the selected root set $R$ to be the subset of $\\{0,\\dots,N-1\\}$ of size $r$ satisfying the following lexicographic minimization: order all cells by increasing $H_i$, breaking ties by decreasing $S_i$, and then breaking any remaining ties by increasing index $i$. Take the first $r$ cells under this order to form $R$. The output for a given test case is either the single integer index in $\\{0,\\dots,N-1\\}$ when $r=1$, or the list of indices in strictly increasing numerical order when $r>1$.\n\nYour program must implement these definitions precisely for the following test suite. In all cases, indices are zero-based.\n\n- Test case $1$ (general case with smoothing):\n  - $X = \\begin{bmatrix}\n  10 & 10 & 0 \\\\\n  20 & 0 & 0 \\\\\n  0 & 20 & 0 \\\\\n  5 & 5 & 10\n  \\end{bmatrix}$,\n  - $M = \\{0,1\\}$,\n  - $\\alpha = 1$,\n  - $r = 1$.\n- Test case $2$ (explicit tie in entropy, resolved by larger total marker expression):\n  - $X = \\begin{bmatrix}\n  8 & 2 \\\\\n  16 & 4 \\\\\n  5 & 5\n  \\end{bmatrix}$,\n  - $M = \\{0,1\\}$,\n  - $\\alpha = 0$,\n  - $r = 1$.\n- Test case $3$ (boundary with all-zero marker vector in a cell handled by smoothing):\n  - $X = \\begin{bmatrix}\n  0 & 0 \\\\\n  0 & 10 \\\\\n  0 & 1\n  \\end{bmatrix}$,\n  - $M = \\{0,1\\}$,\n  - $\\alpha = 1$,\n  - $r = 1$.\n- Test case $4$ (multiple roots requested):\n  - $X = \\begin{bmatrix}\n  10 & 0 & 0 \\\\\n  0 & 10 & 0 \\\\\n  3 & 3 & 3 \\\\\n  6 & 4 & 0 \\\\\n  9 & 1 & 0\n  \\end{bmatrix}$,\n  - $M = \\{0,1,2\\}$,\n  - $\\alpha = 1$,\n  - $r = 2$.\n\nYour program should produce a single line of output containing the results of the four test cases aggregated in order as a comma-separated list enclosed in square brackets. Each element must be either an integer (for $r=1$) or a list of integers in increasing order (for $r>1$). For example, an output may look like\n$[a,b,c,[d,e]]$\nwhere $a$, $b$, $c$ are integers and $[d,e]$ is a list of integers. No additional text should be printed.", "solution": "The problem presents a well-defined computational task grounded in the field of bioinformatics, specifically for identifying root cells in a single-cell dataset. The definitions are mathematically precise, the parameters are fully specified for each test case, and the required selection criteria are unambiguous. The problem is therefore valid and permits a direct algorithmic solution.\n\nThe objective is to identify a set of $r$ root cells from a total of $N$ cells. The selection is based on a lexicographical ordering where cells with the most concentrated expression profile across a predefined set of pluripotency marker genes are prioritized. This concentration is quantified by the Shannon entropy $H_i$ of a probability distribution derived from the cell's marker gene expression levels.\n\nThe procedure is executed as follows: for each cell $i \\in \\{0, \\dots, N-1\\}$, we compute two metrics that form the basis for sorting: the Shannon entropy $H_i$ and the total marker expression $S_i$.\n\nFirst, we compute the Shannon entropy $H_i$ for each cell $i$:\n1.  From the expression matrix $X \\in \\mathbb{R}_{\\ge 0}^{N \\times G}$, we extract the marker expression vector $v_i \\in \\mathbb{R}_{\\ge 0}^{K}$ for cell $i$. Its components are $v_{i,g} = x_{i,g}$ for all gene indices $g$ in the marker set $M$, where $K = |M|$.\n2.  A nonnegative pseudocount $\\alpha \\ge 0$ is added to each component of $v_i$ to form a smoothed vector $w_i$, with components $w_{i,g} = v_{i,g} + \\alpha$. This step ensures that no probabilities are zero when $\\alpha > 0$, avoiding issues with logarithms, and handles the case where a cell has zero expression for all markers.\n3.  The vector $w_i$ is normalized to create a probability distribution $p_i$. The normalization constant is $s_i = \\sum_{g \\in M} w_{i,g}$.\n4.  If $s_i > 0$, the probability distribution $p_i$ has components $p_{i,g} = \\dfrac{w_{i,g}}{s_i}$. In the specific case where $s_i = 0$, which can only happen if $\\alpha=0$ and all marker expressions $x_{i,g}$ for $g \\in M$ are zero, the distribution $p_i$ is defined as the uniform distribution, i.e., $p_{i,g} = \\dfrac{1}{K}$ for all $g \\in M$.\n5.  The Shannon entropy of this distribution is then calculated using the natural logarithm, as specified:\n    $$\n    H_i = - \\sum_{g \\in M} p_{i,g} \\log p_{i,g}\n    $$\n    The convention $q \\log q = 0$ for $q=0$ is respected. A lower value of $H_i$ signifies a more concentrated, less uniform expression profile over the marker genes.\n\nSecond, we compute the total marker expression $S_i$ for each cell $i$. This is the simple sum of the raw, non-smoothed marker expression values:\n$$\nS_i = \\sum_{g \\in M} x_{i,g}\n$$\nThis metric is used as the primary tie-breaker.\n\nWith $H_i$ and $S_i$ computed for all cells, we establish a unique ordering of the cells. The sorting is performed lexicographically based on a tuple of criteria for each cell $i$:\n1.  Primary criterion: Ascending order of Shannon entropy $H_i$.\n2.  Secondary criterion (tie-breaker): Descending order of total marker expression $S_i$.\n3.  Tertiary criterion (final tie-breaker): Ascending order of cell index $i$.\n\nThis sorting process can be implemented by ordering a list of tuples $(H_i, -S_i, i)$ for all $i \\in \\{0, \\dots, N-1\\}$.\n\nFinally, the root set $R$ is formed by selecting the first $r$ cells from this uniquely sorted list. The output for a given test case is the index (for $r=1$) or list of indices (for $r>1$) corresponding to these selected cells. If $r>1$, the indices in the final output must be presented in strictly increasing numerical order.\n\nThe implementation is written in Python, utilizing the `numpy` library for efficient array operations and `scipy.stats.entropy` for a robust calculation of the Shannon entropy. The algorithm follows the steps precisely as described above for each provided test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import entropy\n\ndef find_roots(X_raw, M, alpha, r):\n    \"\"\"\n    Identifies root cells based on Shannon entropy and total marker expression.\n\n    Args:\n        X_raw (list of lists): The N x G gene expression matrix.\n        M (set): The set of marker gene indices.\n        alpha (float): The nonnegative pseudocount.\n        r (int): The number of root cells to select.\n\n    Returns:\n        int or list of int: The index or list of indices of the root cells.\n    \"\"\"\n    X = np.array(X_raw, dtype=float)\n    marker_indices = sorted(list(M))\n    num_cells = X.shape[0]\n    K = len(marker_indices)\n\n    cell_metrics = []\n\n    for i in range(num_cells):\n        # Extract marker vector v_i and calculate total marker expression S_i\n        v_i = X[i, marker_indices]\n        S_i = np.sum(v_i)\n\n        # Calculate smoothed marker vector w_i and normalization constant s_i\n        w_i = v_i + alpha\n        s_i = np.sum(w_i)\n\n        # Define probability distribution p_i\n        if s_i > 0:\n            p_i = w_i / s_i\n        else:\n            # This case occurs iff alpha=0 and all relevant x_i,g are 0.\n            # Define p_i as the uniform distribution on M.\n            p_i = np.full(K, 1.0 / K)\n\n        # Calculate Shannon entropy H_i using natural logarithm\n        H_i = entropy(p_i, base=np.e)\n\n        # Store metrics for lexicographical sorting: (H_i, -S_i, i)\n        # We use -S_i because the tie-breaker is in descending order of S_i.\n        cell_metrics.append((H_i, -S_i, i))\n\n    # Sort cells based on the specified criteria\n    cell_metrics.sort()\n\n    # Select the top r cell indices\n    root_indices = [metric[2] for metric in cell_metrics[:r]]\n\n    # Format the output as per the problem description\n    if r == 1:\n        return root_indices[0]\n    else:\n        # Return indices in strictly increasing numerical order\n        return sorted(root_indices)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"X\": [[10, 10, 0], [20, 0, 0], [0, 20, 0], [5, 5, 10]],\n            \"M\": {0, 1}, \"alpha\": 1, \"r\": 1\n        },\n        {\n            \"X\": [[8, 2], [16, 4], [5, 5]],\n            \"M\": {0, 1}, \"alpha\": 0, \"r\": 1\n        },\n        {\n            \"X\": [[0, 0], [0, 10], [0, 1]],\n            \"M\": {0, 1}, \"alpha\": 1, \"r\": 1\n        },\n        {\n            \"X\": [[10, 0, 0], [0, 10, 0], [3, 3, 3], [6, 4, 0], [9, 1, 0]],\n            \"M\": {0, 1, 2}, \"alpha\": 1, \"r\": 2\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_roots(case[\"X\"], case[\"M\"], case[\"alpha\"], case[\"r\"])\n        results.append(result)\n\n    # Helper function to format results into the required string format\n    def format_result(res):\n        if isinstance(res, list):\n            # Format list as '[d,e]' without spaces\n            return f\"[{','.join(map(str, res))}]\"\n        else:\n            return str(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(format_result, results))}]\")\n\nsolve()\n```", "id": "2437518"}, {"introduction": "Once a root cell is identified, the next step is to order all other cells along the inferred developmental pathway, assigning each a \"pseudotime\" value. This practice [@problem_id:4614293] explores a powerful graph-based method, Diffusion Pseudotime (DPT), which models the progression as a random walk over the cell-cell similarity graph. By calculating shortest path distances on a small, tangible graph, you will gain a concrete understanding of how this abstract concept is computed and how it robustly captures the distance of each cell from the trajectory's origin.", "problem": "In single-cell ribonucleic acid sequencing (scRNA-seq) trajectory inference, diffusion pseudotime (DPT) aims to order cells along developmental progress by leveraging a diffusion process on a cell-cell graph. Consider a symmetric $k$-Nearest Neighbor (kNN) graph with $k=2$ constructed from five cells, labeled as nodes $1,2,3,4,5$. The graph is undirected and weighted; an undirected edge $\\{i,j\\}$ exists if either $i$ is among the two nearest neighbors of $j$ or $j$ is among the two nearest neighbors of $i$ in the original high-dimensional gene expression space. The edge weight $w_{ij} > 0$ represents the expected single-step diffusion time between nodes $i$ and $j$, consistent with a continuous-time random walk model in which shorter times correspond to higher similarity.\n\nYou are given the following edges and weights (all edges are undirected; weights are symmetric):\n$\\{1,2\\}$ with $w_{12} = 0.5$, $\\{2,3\\}$ with $w_{23} = 0.7$, $\\{3,4\\}$ with $w_{34} = 0.6$, $\\{4,5\\}$ with $w_{45} = 0.9$, $\\{2,4\\}$ with $w_{24} = 1.3$, $\\{1,3\\}$ with $w_{13} = 1.9$, $\\{2,5\\}$ with $w_{25} = 2.5$, $\\{3,5\\}$ with $w_{35} = 0.8$.\n\nLet node $1$ be the chosen root representing the earliest developmental state. Using fundamental definitions from Markov chains and diffusion processes on graphs, diffusion pseudotime from the root to a node can be approximated on small, sparse graphs by the minimal expected cumulative diffusion time along any path from the root to that node, i.e., the shortest path length with respect to the edge weights $\\{w_{ij}\\}$. Define the unnormalized diffusion pseudotime $d(i)$ as the minimal sum of edge weights over all paths from node $1$ to node $i$. Normalize pseudotime to the unit interval via min-max scaling,\n$$\n\\tilde{t}(i) = \\frac{d(i) - d_{\\min}}{d_{\\max} - d_{\\min}},\n$$\nwhere $d_{\\min} = \\min_{j \\in \\{1,2,3,4,5\\}} d(j)$ and $d_{\\max} = \\max_{j \\in \\{1,2,3,4,5\\}} d(j)$.\n\nCompute the normalized diffusion pseudotime $\\tilde{t}(4)$ for node $4$ as a single real number. No rounding is required. Express your final answer as a unitless quantity.", "solution": "The problem has been validated and is deemed valid. It is scientifically grounded in the context of bioinformatics and graph theory, well-posed with all necessary information provided, and objective in its formulation. We can proceed with a formal solution.\n\nThe problem asks for the computation of the normalized diffusion pseudotime, $\\tilde{t}(4)$, for node $4$. The problem statement defines the unnormalized diffusion pseudotime, $d(i)$, as the shortest path distance from a designated root node to any node $i$ in a weighted graph. The edge weights, $w_{ij}$, represent the diffusion time between nodes $i$ and $j$.\n\nThe graph consists of a set of $5$ nodes, $V = \\{1, 2, 3, 4, 5\\}$. The root node is specified as node $1$. The graph is undirected, and the edge weights are given as:\n$w_{12} = 0.5$\n$w_{23} = 0.7$\n$w_{34} = 0.6$\n$w_{45} = 0.9$\n$w_{24} = 1.3$\n$w_{13} = 1.9$\n$w_{25} = 2.5$\n$w_{35} = 0.8$\n\nOur first step is to compute the unnormalized pseudotime $d(i)$ for all nodes $i \\in V$. This corresponds to finding the shortest path from the source node $1$ to all other nodes in the graph. Since all edge weights are positive, Dijkstra's algorithm is a suitable method for this task. Let $d(i)$ denote the shortest path distance from node $1$ to node $i$.\n\n1.  **Initialization**:\n    The distance to the root node is $d(1) = 0$. The distances to all other nodes are initialized to infinity: $d(2) = \\infty$, $d(3) = \\infty$, $d(4) = \\infty$, $d(5) = \\infty$.\n\n2.  **Calculation of $d(i)$ for all $i \\in V$**:\n    We will systematically find the shortest path from node $1$ to every other node.\n\n    *   **For node $1$**: The shortest path from node $1$ to itself has a length of $0$.\n        $d(1) = 0$.\n\n    *   **For node $2$**: The only direct path is $1 \\to 2$ with weight $w_{12} = 0.5$. All other paths must pass through other nodes and will be longer.\n        $d(2) = w_{12} = 0.5$.\n\n    *   **For node $3$**: We consider all paths from $1$ to $3$:\n        *   Path $1 \\to 3$: cost is $w_{13} = 1.9$.\n        *   Path $1 \\to 2 \\to 3$: cost is $d(2) + w_{23} = 0.5 + 0.7 = 1.2$.\n        The minimum cost is $1.2$.\n        $d(3) = 1.2$.\n\n    *   **For node $4$**: We consider all paths from $1$ to $4$:\n        *   Path $1 \\to 2 \\to 4$: cost is $d(2) + w_{24} = 0.5 + 1.3 = 1.8$.\n        *   Path $1 \\to 2 \\to 3 \\to 4$: cost is $d(3) + w_{34} = 1.2 + 0.6 = 1.8$.\n        *   Path $1 \\to 3 \\to 4$: cost is $w_{13} + w_{34} = 1.9 + 0.6 = 2.5$. This path is not minimal since the path to $3$ via $1 \\to 2 \\to 3$ is shorter.\n        The minimum cost is $1.8$.\n        $d(4) = 1.8$.\n\n    *   **For node $5$**: We consider all paths from $1$ to $5$:\n        *   Path $1 \\to 2 \\to 5$: cost is $d(2) + w_{25} = 0.5 + 2.5 = 3.0$.\n        *   Path $1 \\to 2 \\to 3 \\to 5$: cost is $d(3) + w_{35} = 1.2 + 0.8 = 2.0$.\n        *   Path $1 \\to 2 \\to 4 \\to 5$: cost is $d(4) + w_{45} = 1.8 + 0.9 = 2.7$.\n        *   Path $1 \\to 2 \\to 3 \\to 4 \\to 5$: cost is also $d(4) + w_{45} = 1.8 + 0.9 = 2.7$.\n        The minimum cost is $2.0$.\n        $d(5) = 2.0$.\n\n    The unnormalized diffusion pseudotimes are:\n    $d(1) = 0$\n    $d(2) = 0.5$\n    $d(3) = 1.2$\n    $d(4) = 1.8$\n    $d(5) = 2.0$\n\n3.  **Normalization**:\n    The normalized pseudotime $\\tilde{t}(i)$ is given by the min-max scaling formula:\n    $$\n    \\tilde{t}(i) = \\frac{d(i) - d_{\\min}}{d_{\\max} - d_{\\min}}\n    $$\n    First, we determine the minimum and maximum values of $d(i)$:\n    $d_{\\min} = \\min_{j \\in V} d(j) = \\min\\{0, 0.5, 1.2, 1.8, 2.0\\} = 0$.\n    $d_{\\max} = \\max_{j \\in V} d(j) = \\max\\{0, 0.5, 1.2, 1.8, 2.0\\} = 2.0$.\n\n4.  **Compute $\\tilde{t}(4)$**:\n    We substitute the values for node $4$ into the normalization formula:\n    $d(4) = 1.8$\n    $d_{\\min} = 0$\n    $d_{\\max} = 2.0$\n\n    $$\n    \\tilde{t}(4) = \\frac{d(4) - d_{\\min}}{d_{\\max} - d_{\\min}} = \\frac{1.8 - 0}{2.0 - 0} = \\frac{1.8}{2.0}\n    $$\n    Calculating the final value:\n    $$\n    \\tilde{t}(4) = \\frac{18}{20} = \\frac{9}{10} = 0.9\n    $$\nThe normalized diffusion pseudotime for node $4$ is $0.9$.", "answer": "$$\n\\boxed{0.9}\n$$", "id": "4614293"}, {"introduction": "While pseudotime provides a static ordering of cells, it does not directly reveal the underlying regulatory dynamics driving the process. The RNA velocity framework provides this dynamic view by inferring the future transcriptional state of individual cells from the balance of unspliced and spliced mRNA. In this exercise [@problem_id:4614291], you will work from the first principles of mass-action kinetics to derive and compute a velocity vector, learning to interpret its components as indicators of active gene up-regulation, down-regulation, or steady-state equilibrium.", "problem": "A common approach to quantify instantaneous transcriptional state changes in single-cell ribonucleic acid sequencing (scRNA-seq) trajectory inference is to model pre-messenger ribonucleic acid (pre-mRNA) splicing and mature messenger ribonucleic acid (mRNA) degradation with first-order mass-action kinetics. Consider a single cell profiled for $2$ genes, where the observed unspliced count vector is $\\mathbf{u}=(5,4)$ and the spliced count vector is $\\mathbf{s}=(10,8)$. Assume a linear two-stage kinetic model in which unspliced molecules are produced at a constant transcription rate and converted to spliced molecules at a first-order splicing rate, while spliced molecules are degraded at a first-order degradation rate. Let the splicing rate be $\\beta=0.2$ and the degradation rate be $\\gamma=0.1$, both assumed constant over the short time window corresponding to the local pseudotime neighborhood of the cell. Using only the mass-action principle for first-order reactions and the definitions of unspliced and spliced species, derive from first principles the expression for the instantaneous rate of change of the spliced counts (the spliced RNA velocity) per gene and then compute the $2$-dimensional velocity vector for this cell. Based on the sign of each component, interpret the instantaneous direction of state change for each gene along pseudotime in the $2$-gene state space. No rounding is required. Express your final velocity vector as a row vector.", "solution": "The problem is valid. It is scientifically grounded in the principles of mass-action kinetics as applied to gene expression, a cornerstone of the RNA velocity model in bioinformatics. It is well-posed, providing all necessary data—unspliced counts $\\mathbf{u}$, spliced counts $\\mathbf{s}$, splicing rate $\\beta$, and degradation rate $\\gamma$—to derive and compute the requested velocity vector. The terminology is precise and objective.\n\nThe central task is to derive the expression for the instantaneous rate of change of spliced messenger ribonucleic acid (mRNA) counts, denoted as $s$, for a single gene. This quantity is also known as the spliced RNA velocity. The derivation is based on a two-stage kinetic model of gene expression governed by first-order mass-action kinetics.\n\nLet $u(t)$ be the number of unspliced pre-mRNA molecules and $s(t)$ be the number of spliced mRNA molecules for a given gene at time $t$. The model involves two key processes affecting the population of spliced mRNA:\n\n1.  **Production of Spliced mRNA**: Unspliced molecules are converted into spliced molecules. This is the splicing process. The problem states this is a first-order reaction with rate constant $\\beta$.\n    The reaction can be schematized as:\n    $$\n    u \\xrightarrow{\\beta} s\n    $$\n    According to the principle of mass-action for a first-order reaction, the rate of this process is directly proportional to the amount of the reactant, which is the unspliced mRNA count $u$. Therefore, the rate of production of $s$ is given by:\n    $$\n    \\text{Rate of Production} = \\beta u\n    $$\n\n2.  **Degradation of Spliced mRNA**: Spliced molecules are degraded and removed from the system. The problem states this is a first-order reaction with rate constant $\\gamma$.\n    The reaction can be schematized as:\n    $$\n    s \\xrightarrow{\\gamma} \\emptyset\n    $$\n    where $\\emptyset$ represents the degraded state. According to the principle of mass-action, the rate of this process is directly proportional to the amount of the reactant, which is the spliced mRNA count $s$. Therefore, the rate of loss of $s$ is given by:\n    $$\n    \\text{Rate of Loss} = \\gamma s\n    $$\n\nThe instantaneous rate of change of the spliced counts, $\\frac{ds}{dt}$, is the net result of these two processes: the rate of production minus the rate of loss. This gives the fundamental RNA velocity equation for spliced mRNA:\n$$\n\\frac{ds}{dt} = \\beta u - \\gamma s\n$$\nThis derivation from first principles provides the expression for the spliced RNA velocity for a single gene.\n\nThe problem requires us to compute the $2$-dimensional velocity vector for a cell with $2$ genes. We can apply the derived formula to each gene independently. Let the unspliced count vector be $\\mathbf{u} = (u_1, u_2)$ and the spliced count vector be $\\mathbf{s} = (s_1, s_2)$. The velocity vector $\\mathbf{v}$ is then given by $\\mathbf{v} = \\frac{d\\mathbf{s}}{dt} = (\\frac{ds_1}{dt}, \\frac{ds_2}{dt})$.\n\nThe given values are:\n- Unspliced count vector: $\\mathbf{u} = (u_1, u_2) = (5, 4)$\n- Spliced count vector: $\\mathbf{s} = (s_1, s_2) = (10, 8)$\n- Splicing rate constant: $\\beta = 0.2$\n- Degradation rate constant: $\\gamma = 0.1$\n\nWe can now compute the two components of the velocity vector:\n\nFor the first gene ($i=1$):\n$$\nv_1 = \\frac{ds_1}{dt} = \\beta u_1 - \\gamma s_1\n$$\nSubstituting the numerical values:\n$$\nv_1 = (0.2)(5) - (0.1)(10) = 1.0 - 1.0 = 0\n$$\n\nFor the second gene ($i=2$):\n$$\nv_2 = \\frac{ds_2}{dt} = \\beta u_2 - \\gamma s_2\n$$\nSubstituting the numerical values:\n$$\nv_2 = (0.2)(4) - (0.1)(8) = 0.8 - 0.8 = 0\n$$\n\nThus, the $2$-dimensional velocity vector for this cell is $\\mathbf{v} = (0, 0)$.\n\nThe final part of the task is to interpret the sign of each component.\n- The velocity component for gene $1$ is $v_1 = 0$. A velocity of zero indicates that the rate of production of spliced mRNA from its precursor ($\\beta u_1 = 1.0$) is exactly balanced by the rate of its degradation ($\\gamma s_1 = 1.0$). This means the gene is at a steady state (or a fixed point) in its expression dynamics. There is no instantaneous change in the amount of spliced mRNA.\n- The velocity component for gene $2$ is $v_2 = 0$. Similarly, this indicates that the production of spliced mRNA for gene $2$ ($\\beta u_2 = 0.8$) is perfectly balanced by its degradation ($\\gamma s_2 = 0.8$). This gene is also at a steady state.\n\nSince both components of the velocity vector are zero, the cell's transcriptional state, as described by the abundances of these two spliced mRNAs, is not changing at this instant in pseudotime. In the context of trajectory inference, this cell is located at a fixed point of the dynamical system, which could represent a stable cell state, an unstable progenitor state, or a transient state at the peak or trough of a dynamic process.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0\n\\end{pmatrix}\n}\n$$", "id": "4614291"}]}