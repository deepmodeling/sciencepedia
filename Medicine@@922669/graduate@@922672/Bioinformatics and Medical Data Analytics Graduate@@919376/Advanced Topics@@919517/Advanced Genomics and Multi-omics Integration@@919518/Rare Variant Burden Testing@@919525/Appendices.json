{"hands_on_practices": [{"introduction": "The simplest approach to rare variant burden testing is to \"collapse\" information from multiple variants into a single indicator for each person. This exercise demonstrates this core principle by treating a gene as a binary burden, where an individual is a \"carrier\" if they have at least one rare variant. By constructing a simple contingency table from case and control data, you will practice calculating the odds ratio, a cornerstone of epidemiological studies, and interpreting its meaning in the context of genetic risk. [@problem_id:4603573]", "problem": "In a case-control sequencing study of gene $G$, you will perform a rare-variant burden analysis by collapsing across extremely rare variants. Let the collapsed burden indicator for individual $i$ be $B_i \\in \\{0,1\\}$, where $B_i = 1$ if individual $i$ carries at least one minor allele among a prespecified set of rare variants in $G$, and $B_i = 0$ otherwise. You are given the following summary counts:\n- Number of cases: $n_{1} = 1500$.\n- Number of controls: $n_{0} = 2000$.\n- Case cumulative minor allele count (CMAC; cumulative minor allele count): $m_{1} = 28$.\n- Control cumulative minor allele count: $m_{0} = 22$.\n\nAssume the following standard rare-variant conditions:\n- Variants are sufficiently rare that homozygous minor genotypes are negligible and the co-occurrence of two distinct rare variants in the same individual is negligible at the given sample sizes.\n- Consequently, the number of burden-positive carriers equals the cumulative minor allele count within each group, that is, among cases the number of $B=1$ individuals is $m_{1}$ and among controls the number of $B=1$ individuals is $m_{0}$.\n\nUsing only first principles and the above assumptions:\n1) Define the population odds ratio quantifying the association between $B$ and case status, and derive a consistent sample estimator expressed solely in terms of $m_{1}$, $m_{0}$, $n_{1}$, and $n_{0}$.\n2) Compute the numerical value of this estimator for the provided data.\n3) Provide a one-sentence epidemiological interpretation of the computed value in terms of the odds of disease for carriers versus noncarriers.\n\nExpress the final odds ratio as a pure number without units, rounded to four significant figures. Do not use any continuity corrections or smoothing since no table cell is zero in this setting.", "solution": "The user has requested a solution to a problem in biostatistics, specifically concerning rare-variant burden analysis in a case-control study. The task involves defining and calculating an odds ratio estimator and interpreting the result.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n- Study type: Case-control sequencing study of gene $G$.\n- Analysis type: Rare-variant burden analysis by collapsing variants.\n- Burden indicator variable: $B_i \\in \\{0,1\\}$ for individual $i$.\n- $B_i = 1$ if individual $i$ has at least one minor allele in a set of rare variants in gene $G$.\n- $B_i = 0$ otherwise.\n- Number of cases: $n_{1} = 1500$.\n- Number of controls: $n_{0} = 2000$.\n- Case cumulative minor allele count (CMAC): $m_{1} = 28$.\n- Control cumulative minor allele count (CMAC): $m_{0} = 22$.\n- Assumption: Homozygous minor genotypes and co-occurrence of distinct rare variants in one individual are negligible.\n- Consequence of assumption: The number of burden-positive carriers equals the CMAC in each group.\n- Number of cases with $B=1$ is $m_1$.\n- Number of controls with $B=1$ is $m_0$.\n- The task is to:\n    1. Define the population odds ratio and derive a sample estimator.\n    2. Compute the numerical value of the estimator.\n    3. Provide a one-sentence epidemiological interpretation.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the principles of genetic epidemiology and biostatistics. It describes a standard case-control design and a common analysis method (burden testing) for rare genetic variants. The odds ratio is the correct measure of association for this study design. The simplifying assumptions are standard and appropriate for the context of \"extremely rare variants\".\n- **Well-Posed**: The problem is well-posed. It provides all necessary data ($n_1$, $n_0$, $m_1$, $m_0$) to construct a $2 \\times 2$ contingency table and compute the sample odds ratio. The question is unambiguous and a unique solution exists.\n- **Objective**: The problem is stated in precise, objective, and scientific language, free of any subjective or opinion-based content.\n\nThe problem does not violate any of the invalidity criteria. The data are consistent, the assumptions are standard in the field, and the request is for a standard statistical calculation and interpretation.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\nThe solution is developed in three parts as requested.\n\n### 1) Definition and Derivation of the Odds Ratio Estimator\n\nLet $D$ be the disease status, where $D=1$ for cases and $D=0$ for controls. Let $B$ be the burden status, where $B=1$ for individuals carrying at least one qualifying rare variant (carriers) and $B=0$ for non-carriers.\n\nThe population **odds ratio (OR)** is the ratio of the odds of disease in carriers to the odds of disease in non-carriers. It is defined as:\n$$\n\\text{OR} = \\frac{P(D=1|B=1) / P(D=0|B=1)}{P(D=1|B=0) / P(D=0|B=0)}\n$$\nIn a case-control study, we sample subjects based on their disease status ($D$), so we cannot directly estimate the conditional probabilities $P(D=1|B)$ and $P(D=0|B)$. However, by an application of Bayes' theorem, the odds ratio can be equivalently expressed as the ratio of the odds of exposure (being a carrier) in cases to the odds of exposure in controls:\n$$\n\\text{OR} = \\frac{P(B=1|D=1) / P(B=0|D=1)}{P(B=1|D=0) / P(B=0|D=0)}\n$$\nThis form is estimable from case-control data. We can summarize the provided data in a $2 \\times 2$ contingency table:\n\n| | Case ($D=1$) | Control ($D=0$) |\n| :--- | :--- | :--- |\n| Carrier ($B=1$) | $a$ | $b$ |\n| Non-carrier ($B=0$) | $c$ | $d$ |\n\nFrom the problem statement, we have:\n- The number of carriers among cases: $a = m_1$.\n- The number of carriers among controls: $b = m_0$.\n- The total number of cases: $n_1 = a + c$.\n- The total number of controls: $n_0 = b + d$.\n\nFrom these, we can deduce the number of non-carriers in each group:\n- The number of non-carriers among cases: $c = n_1 - a = n_1 - m_1$.\n- The number of non-carriers among controls: $d = n_0 - b = n_0 - m_0$.\n\nThe sample estimator for the odds ratio, denoted $\\widehat{\\text{OR}}$, is computed by replacing the population probabilities with their sample frequencies from the contingency table:\n$$\n\\widehat{\\text{OR}} = \\frac{(a/n_1) / (c/n_1)}{(b/n_0) / (d/n_0)} = \\frac{a/c}{b/d} = \\frac{ad}{bc}\n$$\nSubstituting the given variables, the consistent sample estimator is:\n$$\n\\widehat{\\text{OR}} = \\frac{m_1 (n_0 - m_0)}{m_0 (n_1 - m_1)}\n$$\n\n### 2) Numerical Computation\n\nWe are given the following values:\n- Number of cases, $n_1 = 1500$.\n- Number of controls, $n_0 = 2000$.\n- Number of carriers in cases, $m_1 = 28$.\n- Number of carriers in controls, $m_0 = 22$.\n\nFirst, we determine the number of non-carriers:\n- Non-carriers in cases: $n_1 - m_1 = 1500 - 28 = 1472$.\n- Non-carriers in controls: $n_0 - m_0 = 2000 - 22 = 1978$.\n\nNow, we substitute these values into the estimator formula:\n$$\n\\widehat{\\text{OR}} = \\frac{28 \\times (2000 - 22)}{22 \\times (1500 - 28)} = \\frac{28 \\times 1978}{22 \\times 1472}\n$$\n$$\n\\widehat{\\text{OR}} = \\frac{55384}{32384} \\approx 1.710227...\n$$\nRounding to four significant figures, the numerical value of the estimator is $1.710$.\n\n### 3) Epidemiological Interpretation\n\nThe computed odds ratio of $1.710$ provides a measure of the strength of association between carrying a qualifying rare variant in gene $G$ and the disease.\n\nThe odds of disease for individuals carrying a qualifying rare variant in gene $G$ are estimated to be $1.710$ times the odds of disease for non-carriers.", "answer": "$$\\boxed{1.710}$$", "id": "4603573"}, {"introduction": "While simple collapsing is intuitive, not all rare variants contribute equally to disease risk. This practice introduces a more sophisticated and powerful approach: the weighted burden score. You will learn to construct a score that up-weights variants predicted to be functionally important (using CADD scores) and down-weights more common variants, reflecting the hypothesis that the rarest and most damaging mutations have the largest effects. This exercise solidifies the mechanics of calculating such a score and connects it to the logistic regression model used for formal hypothesis testing. [@problem_id:4603598]", "problem": "You are analyzing a case-control dataset for a gene-based rare variant burden association study. For a given gene, there are $5$ nonsynonymous rare variants indexed by $j \\in \\{1,2,3,4,5\\}$. For each variant, you have an estimated minor allele frequency $p_j$ from the study sample and a functional annotation measured by Combined Annotation Dependent Depletion (CADD). For an individual $i^{\\star}$, you observe the minor-allele genotype counts $X_{i^{\\star}j} \\in \\{0,1,2\\}$.\n\nTo combine frequency down-weighting and functional impact up-weighting in a single burden score, you will use a weight defined by\n$$\nw_j \\equiv \\frac{\\ln\\!\\big(1 + \\mathrm{CADD}_j\\big)}{\\sqrt{p_j\\left(1 - p_j\\right)}},\n$$\nand define the individual’s weighted burden score as the weighted sum across variants,\n$$\nS_{i^{\\star}} \\equiv \\sum_{j=1}^{5} w_j\\,X_{i^{\\star}j}.\n$$\nYou are also planning to test the association between the gene burden and a binary disease outcome under a logistic regression framework.\n\nUse the following scientifically plausible and self-consistent data for this gene:\n- Variant-level minor allele frequencies: $p_1 = 0.002$, $p_2 = 0.005$, $p_3 = 0.010$, $p_4 = 0.020$, $p_5 = 0.030$.\n- CADD scores: $\\mathrm{CADD}_1 = 25.0$, $\\mathrm{CADD}_2 = 12.3$, $\\mathrm{CADD}_3 = 35.0$, $\\mathrm{CADD}_4 = 15.0$, $\\mathrm{CADD}_5 = 5.0$.\n- Individual $i^{\\star}$ genotypes: $X_{i^{\\star}1} = 1$, $X_{i^{\\star}2} = 0$, $X_{i^{\\star}3} = 2$, $X_{i^{\\star}4} = 1$, $X_{i^{\\star}5} = 0$.\n\nTasks:\n1. Using only the definitions given and standard properties of the natural logarithm and square root, compute the weighted burden $S_{i^{\\star}}$. Round your final numerical answer to four significant figures.\n2. Starting from the canonical definition of the logistic regression model for a binary outcome and the asymptotic normality of maximum likelihood estimators, outline the steps you would take to obtain a two-sided $p$-value for testing whether the gene burden is associated with disease status, while adjusting for measured covariates such as age, sex, and population structure principal components. Your outline must start from first principles (model specification and likelihood) and proceed through the construction of a valid large-sample test statistic.\n\nOnly the result of Task $1$ will be graded numerically; express it as a real number rounded to four significant figures. No units are required for the burden score.", "solution": "We begin from the core definitions of a rare variant burden and the logistic regression model.\n\nFor Task $1$, the burden score for individual $i^{\\star}$ is defined by the sum over variants of a per-variant weight times the genotype count. The weight $w_j$ increases with predicted functional impact via the natural logarithm of one plus the Combined Annotation Dependent Depletion (CADD) score and increases as the variant becomes rarer through the reciprocal of the square root of $p_j(1-p_j)$. Explicitly,\n$$\nw_j \\equiv \\frac{\\ln\\!\\big(1 + \\mathrm{CADD}_j\\big)}{\\sqrt{p_j\\left(1 - p_j\\right)}}, \\quad S_{i^{\\star}} \\equiv \\sum_{j=1}^{5} w_j\\,X_{i^{\\star}j}.\n$$\nUsing the provided values, we compute each $w_j$:\n- For $j=1$: $p_1 = 0.002$, $\\mathrm{CADD}_1 = 25.0$, so\n$$\nw_1 = \\frac{\\ln(1 + 25.0)}{\\sqrt{0.002 \\cdot (1 - 0.002)}} = \\frac{\\ln(26)}{\\sqrt{0.001996}}.\n$$\n- For $j=2$: $p_2 = 0.005$, $\\mathrm{CADD}_2 = 12.3$, so\n$$\nw_2 = \\frac{\\ln(1 + 12.3)}{\\sqrt{0.005 \\cdot (1 - 0.005)}} = \\frac{\\ln(13.3)}{\\sqrt{0.004975}}.\n$$\n- For $j=3$: $p_3 = 0.010$, $\\mathrm{CADD}_3 = 35.0$, so\n$$\nw_3 = \\frac{\\ln(1 + 35.0)}{\\sqrt{0.010 \\cdot (1 - 0.010)}} = \\frac{\\ln(36)}{\\sqrt{0.0099}}.\n$$\n- For $j=4$: $p_4 = 0.020$, $\\mathrm{CADD}_4 = 15.0$, so\n$$\nw_4 = \\frac{\\ln(1 + 15.0)}{\\sqrt{0.020 \\cdot (1 - 0.020)}} = \\frac{\\ln(16)}{\\sqrt{0.0196}}.\n$$\n- For $j=5$: $p_5 = 0.030$, $\\mathrm{CADD}_5 = 5.0$, so\n$$\nw_5 = \\frac{\\ln(1 + 5.0)}{\\sqrt{0.030 \\cdot (1 - 0.030)}} = \\frac{\\ln(6)}{\\sqrt{0.0291}}.\n$$\n\nWe evaluate the necessary logarithms and square roots symbolically and then numerically to combine into $S_{i^{\\star}}$:\n- $\\ln(26)$ is a constant; numerically $\\ln(26) \\approx 3.258096538$.\n- $\\sqrt{0.001996} \\approx 0.04467663$, hence $w_1 \\approx 3.258096538 / 0.04467663 \\approx 72.92616$.\n- $\\ln(13.3) \\approx 2.587764$, $\\sqrt{0.004975} \\approx 0.07054251$, hence $w_2 \\approx 2.587764 / 0.07054251 \\approx 36.6839$.\n- $\\ln(36) = 2 \\ln(6) \\approx 3.583518938$, and $\\sqrt{0.0099} = \\sqrt{99}/100 \\approx 0.0994987437$, hence $w_3 \\approx 3.583518938 / 0.0994987437 \\approx 36.01572$.\n- $\\ln(16) = 4 \\ln(2) \\approx 2.772588722$, and $\\sqrt{0.0196} = 0.14$, hence $w_4 \\approx 2.772588722 / 0.14 \\approx 19.804205$.\n- $\\ln(6) \\approx 1.791759469$, and $\\sqrt{0.0291} \\approx 0.170587$, hence $w_5 \\approx 1.791759469 / 0.170587 \\approx 10.508$.\n\nUsing the genotypes $X_{i^{\\star}1} = 1$, $X_{i^{\\star}2} = 0$, $X_{i^{\\star}3} = 2$, $X_{i^{\\star}4} = 1$, $X_{i^{\\star}5} = 0$, the burden is\n$$\nS_{i^{\\star}} = w_1 \\cdot 1 + w_2 \\cdot 0 + w_3 \\cdot 2 + w_4 \\cdot 1 + w_5 \\cdot 0 = w_1 + 2 w_3 + w_4.\n$$\nSubstituting the numerical values,\n$$\nS_{i^{\\star}} \\approx 72.92616 + 2 \\times 36.01572 + 19.804205 \\approx 72.92616 + 72.03144 + 19.804205 \\approx 164.761805.\n$$\nRounding to four significant figures gives $S_{i^{\\star}} \\approx 164.8$.\n\nFor Task $2$, we outline the steps to obtain a two-sided $p$-value under logistic regression from first principles:\n- Model specification: Let $Y_i \\in \\{0,1\\}$ denote the binary outcome for individual $i$, $S_i$ the gene burden, and $\\mathbf{C}_i$ a vector of covariates (for example, age, sex, and ancestry principal components). The logistic regression model specifies the conditional probability via the canonical logit link,\n$$\n\\Pr(Y_i = 1 \\mid S_i, \\mathbf{C}_i) \\equiv \\pi_i, \\quad \\ln\\!\\left(\\frac{\\pi_i}{1 - \\pi_i}\\right) = \\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i.\n$$\n- Likelihood: Under independent observations, the Bernoulli likelihood for parameters $(\\alpha, \\beta, \\boldsymbol{\\gamma})$ is\n$$\nL(\\alpha, \\beta, \\boldsymbol{\\gamma}) = \\prod_{i=1}^{n} \\pi_i^{Y_i} (1 - \\pi_i)^{1 - Y_i}, \\quad \\text{with} \\quad \\pi_i = \\frac{\\exp(\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i)}{1 + \\exp(\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i)}.\n$$\nThe log-likelihood is\n$$\n\\ell(\\alpha, \\beta, \\boldsymbol{\\gamma}) = \\sum_{i=1}^{n} \\left\\{ Y_i (\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i) - \\ln\\!\\big(1 + \\exp(\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i)\\big) \\right\\}.\n$$\n- Estimation: Obtain the maximum likelihood estimates $(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}})$ by solving the score equations $\\nabla \\ell = \\mathbf{0}$, typically via iteratively reweighted least squares or Newton–Raphson.\n- Variance estimation: Compute the observed Fisher information matrix, which is the negative Hessian of the log-likelihood,\n$$\n\\mathcal{I}(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}}) = - \\nabla^2 \\ell(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}}),\n$$\nand extract the estimated variance of $\\hat{\\beta}$ as the appropriate diagonal element of $\\mathcal{I}^{-1}$, denoted $\\widehat{\\mathrm{Var}}(\\hat{\\beta})$; the standard error is $\\mathrm{SE}(\\hat{\\beta}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta})}$.\n- Hypothesis test: Test the null $H_0\\!: \\beta = 0$ versus two-sided alternative $H_1\\!: \\beta \\neq 0$. By large-sample theory for maximum likelihood estimators, under $H_0$,\n$$\nZ \\equiv \\frac{\\hat{\\beta}}{\\mathrm{SE}(\\hat{\\beta})} \\overset{approx}{\\sim} \\mathcal{N}(0, 1).\n$$\n- $p$-value: Compute the two-sided $p$-value as\n$$\np = 2 \\left[ 1 - \\Phi\\!\\left( \\left| Z \\right| \\right) \\right],\n$$\nwhere $\\Phi(\\cdot)$ is the standard normal cumulative distribution function. As alternatives, one could also construct a likelihood ratio test using $2 \\left\\{\\ell(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}}) - \\ell(\\tilde{\\alpha}, 0, \\tilde{\\boldsymbol{\\gamma}})\\right\\}$, which is asymptotically $\\chi^2_1$ under $H_0$, or a score test at $\\beta = 0$ computed from the gradient and information evaluated under the null model. In all cases, the core steps remain model specification, parameter estimation (or null-model fitting), variance or information evaluation, and large-sample reference distribution to map the test statistic to a $p$-value.", "answer": "$$\\boxed{164.8}$$", "id": "4603598"}, {"introduction": "In practice, genetic studies often rely on integrating data from different sources, such as using publicly available external controls, which can introduce technical artifacts. This exercise explores the crucial concept of \"coverage harmonization,\" a method to ensure that comparisons between cases and controls are made over the same genomic regions. You will derive and quantify the bias and variance of both a naive (unharmonized) and a corrected (harmonized) estimator, providing a concrete illustration of the fundamental bias-variance tradeoff in statistical analysis. [@problem_id:4603566]", "problem": "Consider a rare variant burden test comparing two independent cohorts: a case cohort and an external control cohort. Each cohort has been sequenced and regions are annotated with high-quality callable indicators. We restrict attention to a single gene containing $G$ disjoint, biallelic sites. Let the callable indicator for the case cohort define a subset of sites, and similarly for the control cohort. Let these subsets partition the $G$ sites into three disjoint sets: $A$ (intersection of callable sites in both cohorts), $B$ (callable only in cases), and $D$ (callable only in controls), with sizes $n_A$, $n_B$, and $n_D$ respectively. Assume $A \\cup B \\cup D$ covers all callable sites across the two cohorts. Coverage harmonization by intersecting high-quality callable regions is the procedure that restricts analysis to the intersection set $A$ before computing burden differences.\n\nFor rare variant burden modeling, suppose that at each site $i$, the presence of at least one qualifying rare variant across the cohort is modeled as a Bernoulli random variable. Within each set, assume sites are independent and identically distributed for each cohort. Specifically, for cases, sites in $A$ have success probability $p_A$ and sites in $B$ have success probability $p_B$. For controls, sites in $A$ have success probability $q_A$ and sites in $D$ have success probability $q_D$. Assume independence across sites and across cohorts.\n\nDefine the unharmonized difference-of-means estimator as\n$$\n\\widehat{\\Delta}_{\\mathrm{unharm}} = \\left(\\frac{1}{n_A + n_B}\\sum_{i\\in A\\cup B} X_i\\right) - \\left(\\frac{1}{n_A + n_D}\\sum_{j\\in A\\cup D} Y_j\\right),\n$$\nwhere $X_i \\sim \\mathrm{Bernoulli}(p_A)$ for $i\\in A$ and $X_i \\sim \\mathrm{Bernoulli}(p_B)$ for $i\\in B$, and $Y_j \\sim \\mathrm{Bernoulli}(q_A)$ for $j\\in A$ and $Y_j \\sim \\mathrm{Bernoulli}(q_D)$ for $j\\in D$. Define the target parameter for the difference in burden restricted to the common callable region as\n$$\n\\Delta^\\ast = p_A - q_A.\n$$\nDefine the harmonized estimator as\n$$\n\\widehat{\\Delta}_{\\mathrm{harm}} = \\left(\\frac{1}{n_A}\\sum_{i\\in A} X_i\\right) - \\left(\\frac{1}{n_A}\\sum_{j\\in A} Y_j\\right).\n$$\n\nStarting from the definitions of expectation and variance for sums of independent Bernoulli random variables and standard properties of linearity of expectation and additivity of variance for independent sums, derive the bias and variance of $\\widehat{\\Delta}_{\\mathrm{unharm}}$ and $\\widehat{\\Delta}_{\\mathrm{harm}}$ with respect to the target parameter $\\Delta^\\ast$. Then implement a program that, given a set of parameters $(n_A, n_B, n_D, p_A, p_B, q_A, q_D)$, computes the following four quantities:\n- The bias of the unharmonized estimator, defined as $\\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{unharm}}] - \\Delta^\\ast$.\n- The variance of the unharmonized estimator, defined as $\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{unharm}})$.\n- The bias of the harmonized estimator, defined as $\\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{harm}}] - \\Delta^\\ast$.\n- The variance of the harmonized estimator, defined as $\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{harm}})$.\n\nYour program must compute these quantities for each of the following test cases, using the units implied by the probabilities and counts (no physical units apply), and must produce floating point results:\n\nTest Suite:\n1. Happy path with moderate mismatch and context-dependent probabilities:\n   - $n_A = 3000$, $n_B = 5000$, $n_D = 4000$, $p_A = 2\\times 10^{-4}$, $p_B = 5\\times 10^{-5}$, $q_A = 1.2\\times 10^{-4}$, $q_D = 3\\times 10^{-4}$.\n2. Boundary condition with one cohort having no unique callable sites:\n   - $n_A = 5000$, $n_B = 0$, $n_D = 3000$, $p_A = 1.8\\times 10^{-4}$, $p_B = 1.8\\times 10^{-4}$, $q_A = 1.4\\times 10^{-4}$, $q_D = 1.1\\times 10^{-4}$.\n3. Edge case with equal probabilities across all sets (no context-driven differences):\n   - $n_A = 4000$, $n_B = 6000$, $n_D = 2000$, $p_A = 1\\times 10^{-4}$, $p_B = 1\\times 10^{-4}$, $q_A = 1\\times 10^{-4}$, $q_D = 1\\times 10^{-4}$.\n4. Extreme mismatch with a tiny intersection and large context differences:\n   - $n_A = 500$, $n_B = 9500$, $n_D = 9500$, $p_A = 2.5\\times 10^{-4}$, $p_B = 2\\times 10^{-5}$, $q_A = 1\\times 10^{-4}$, $q_D = 5\\times 10^{-4}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list in the order $[\\mathrm{bias\\_unharm}, \\mathrm{var\\_unharm}, \\mathrm{bias\\_harm}, \\mathrm{var\\_harm}]$. For example, the output should look like $[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],[x_3,y_3,z_3,w_3],[x_4,y_4,z_4,w_4]]$, with each $x_i$, $y_i$, $z_i$, and $w_i$ being floating point numbers computed by your program.", "solution": "The problem requires the derivation of the bias and variance for two estimators of the difference in rare variant burden, $\\widehat{\\Delta}_{\\mathrm{unharm}}$ and $\\widehat{\\Delta}_{\\mathrm{harm}}$, with respect to a defined target parameter $\\Delta^\\ast = p_A - q_A$. The derivation will proceed from fundamental principles of probability theory.\n\nLet $X_i$ for $i \\in A \\cup B$ be the Bernoulli random variables for the case cohort and $Y_j$ for $j \\in A \\cup D$ be the Bernoulli random variables for the control cohort. The key properties of a Bernoulli random variable $Z \\sim \\mathrm{Bernoulli}(p)$ are its expectation $\\mathbb{E}[Z] = p$ and variance $\\mathrm{Var}(Z) = p(1-p)$. All sites are assumed to be independent. For a sum of $n$ independent random variables $S = \\sum_{k=1}^n Z_k$, the expectation is $\\mathbb{E}[S] = \\sum_{k=1}^n \\mathbb{E}[Z_k]$ and the variance is $\\mathrm{Var}(S) = \\sum_{k=1}^n \\mathrm{Var}(Z_k)$.\n\nLet us define the following sums of random variables:\n- Case cohort callable sites: $S_X = \\sum_{i \\in A \\cup B} X_i = \\sum_{i \\in A} X_i + \\sum_{i \\in B} X_i = S_{X,A} + S_{X,B}$\n- Control cohort callable sites: $S_Y = \\sum_{j \\in A \\cup D} Y_j = \\sum_{j \\in A} Y_j + \\sum_{j \\in D} Y_j = S_{Y,A} + S_{Y,D}$\nThe random variables are distributed as follows:\n- $X_i \\sim \\mathrm{Bernoulli}(p_A)$ for $i \\in A$ ($n_A$ sites)\n- $X_i \\sim \\mathrm{Bernoulli}(p_B)$ for $i \\in B$ ($n_B$ sites)\n- $Y_j \\sim \\mathrm{Bernoulli}(q_A)$ for $j \\in A$ ($n_A$ sites)\n- $Y_j \\sim \\mathrm{Bernoulli}(q_D)$ for $j \\in D$ ($n_D$ sites)\n\nFrom these definitions, we can compute the expectation and variance of the sums.\n- $\\mathbb{E}[S_{X,A}] = \\sum_{i \\in A} \\mathbb{E}[X_i] = n_A p_A$ and $\\mathrm{Var}(S_{X,A}) = \\sum_{i \\in A} \\mathrm{Var}(X_i) = n_A p_A(1-p_A)$.\n- $\\mathbb{E}[S_{X,B}] = n_B p_B$ and $\\mathrm{Var}(S_{X,B}) = n_B p_B(1-p_B)$.\n- $\\mathbb{E}[S_{Y,A}] = n_A q_A$ and $\\mathrm{Var}(S_{Y,A}) = \\sum_{j \\in A} \\mathrm{Var}(Y_j) = n_A q_A(1-q_A)$.\n- $\\mathbb{E}[S_{Y,D}] = n_D q_D$ and $\\mathrm{Var}(S_{Y,D}) = n_D q_D(1-q_D)$.\n\nDue to independence of sites within and across cohorts:\n$\\mathbb{E}[S_X] = \\mathbb{E}[S_{X,A}] + \\mathbb{E}[S_{X,B}] = n_A p_A + n_B p_B$.\n$\\mathrm{Var}(S_X) = \\mathrm{Var}(S_{X,A}) + \\mathrm{Var}(S_{X,B}) = n_A p_A(1-p_A) + n_B p_B(1-p_B)$.\n$\\mathbb{E}[S_Y] = \\mathbb{E}[S_{Y,A}] + \\mathbb{E}[S_{Y,D}] = n_A q_A + n_D q_D$.\n$\\mathrm{Var}(S_Y) = \\mathrm{Var}(S_{Y,A}) + \\mathrm{Var}(S_{Y,D}) = n_A q_A(1-q_A) + n_D q_D(1-q_D)$.\n\n**1. Unharmonized Estimator Analysis ($\\widehat{\\Delta}_{\\mathrm{unharm}}$)**\n\nThe unharmonized estimator is defined as:\n$$\n\\widehat{\\Delta}_{\\mathrm{unharm}} = \\left(\\frac{1}{n_A + n_B} S_X \\right) - \\left(\\frac{1}{n_A + n_D} S_Y \\right)\n$$\nThe two terms are independent because they are derived from independent cohorts.\n\n**Expectation and Bias of $\\widehat{\\Delta}_{\\mathrm{unharm}}$**\nUsing the linearity of expectation:\n$$\n\\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{unharm}}] = \\mathbb{E}\\left[\\frac{S_X}{n_A + n_B}\\right] - \\mathbb{E}\\left[\\frac{S_Y}{n_A + n_D}\\right] = \\frac{\\mathbb{E}[S_X]}{n_A+n_B} - \\frac{\\mathbb{E}[S_Y]}{n_A+n_D}\n$$\n$$\n\\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{unharm}}] = \\frac{n_A p_A + n_B p_B}{n_A + n_B} - \\frac{n_A q_A + n_D q_D}{n_A + n_D}\n$$\nThe bias is the difference between this expectation and the target parameter $\\Delta^\\ast = p_A - q_A$:\n$$\n\\mathrm{Bias}(\\widehat{\\Delta}_{\\mathrm{unharm}}) = \\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{unharm}}] - \\Delta^\\ast = \\left(\\frac{n_A p_A + n_B p_B}{n_A + n_B} - \\frac{n_A q_A + n_D q_D}{n_A + n_D}\\right) - (p_A - q_A)\n$$\nRearranging terms to better isolate the sources of bias:\n$$\n\\mathrm{Bias}(\\widehat{\\Delta}_{\\mathrm{unharm}}) = \\left(\\frac{n_A p_A + n_B p_B}{n_A + n_B} - p_A\\right) - \\left(\\frac{n_A q_A + n_D q_D}{n_A + n_D} - q_A\\right)\n$$\n$$\n= \\frac{n_A p_A + n_B p_B - p_A(n_A + n_B)}{n_A + n_B} - \\frac{n_A q_A + n_D q_D - q_A(n_A + n_D)}{n_A + n_D}\n$$\n$$\n= \\frac{n_B(p_B - p_A)}{n_A + n_B} - \\frac{n_D(q_D - q_A)}{n_A + n_D}\n$$\nThis expression constitutes the bias of the unharmonized estimator.\n\n**Variance of $\\widehat{\\Delta}_{\\mathrm{unharm}}$**\nSince the case and control estimators are independent, the variance of their difference is the sum of their variances:\n$$\n\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{unharm}}) = \\mathrm{Var}\\left(\\frac{S_X}{n_A + n_B}\\right) + \\mathrm{Var}\\left(\\frac{S_Y}{n_A + n_D}\\right)\n$$\nUsing the property $\\mathrm{Var}(cZ) = c^2\\mathrm{Var}(Z)$:\n$$\n\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{unharm}}) = \\frac{\\mathrm{Var}(S_X)}{(n_A + n_B)^2} + \\frac{\\mathrm{Var}(S_Y)}{(n_A + n_D)^2}\n$$\nSubstituting the expressions for $\\mathrm{Var}(S_X)$ and $\\mathrm{Var}(S_Y)$:\n$$\n\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{unharm}}) = \\frac{n_A p_A(1-p_A) + n_B p_B(1-p_B)}{(n_A + n_B)^2} + \\frac{n_A q_A(1-q_A) + n_D q_D(1-q_D)}{(n_A + n_D)^2}\n$$\nThis is the variance of the unharmonized estimator.\n\n**2. Harmonized Estimator Analysis ($\\widehat{\\Delta}_{\\mathrm{harm}}$)**\n\nThe harmonized estimator is defined using only sites in the intersection set $A$:\n$$\n\\widehat{\\Delta}_{\\mathrm{harm}} = \\left(\\frac{1}{n_A}\\sum_{i\\in A} X_i\\right) - \\left(\\frac{1}{n_A}\\sum_{j\\in A} Y_j\\right) = \\frac{S_{X,A}}{n_A} - \\frac{S_{Y,A}}{n_A}\n$$\n\n**Expectation and Bias of $\\widehat{\\Delta}_{\\mathrm{harm}}$**\n$$\n\\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{harm}}] = \\mathbb{E}\\left[\\frac{S_{X,A}}{n_A}\\right] - \\mathbb{E}\\left[\\frac{S_{Y,A}}{n_A}\\right] = \\frac{\\mathbb{E}[S_{X,A}]}{n_A} - \\frac{\\mathbb{E}[S_{Y,A}]}{n_A}\n$$\n$$\n\\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{harm}}] = \\frac{n_A p_A}{n_A} - \\frac{n_A q_A}{n_A} = p_A - q_A = \\Delta^\\ast\n$$\nThe bias is the difference between the expectation and the target parameter $\\Delta^\\ast$:\n$$\n\\mathrm{Bias}(\\widehat{\\Delta}_{\\mathrm{harm}}) = \\mathbb{E}[\\widehat{\\Delta}_{\\mathrm{harm}}] - \\Delta^\\ast = (p_A - q_A) - (p_A - q_A) = 0\n$$\nThe harmonized estimator is unbiased for the target parameter $\\Delta^\\ast$.\n\n**Variance of $\\widehat{\\Delta}_{\\mathrm{harm}}$**\nAgain, the two terms are independent:\n$$\n\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{harm}}) = \\mathrm{Var}\\left(\\frac{S_{X,A}}{n_A}\\right) + \\mathrm{Var}\\left(\\frac{S_{Y,A}}{n_A}\\right) = \\frac{\\mathrm{Var}(S_{X,A})}{n_A^2} + \\frac{\\mathrm{Var}(S_{Y,A})}{n_A^2}\n$$\nSubstituting the expressions for the variances of the sums:\n$$\n\\mathrm{Var}(\\widehat{\\Delta}_{\\mathrm{harm}}) = \\frac{n_A p_A(1-p_A)}{n_A^2} + \\frac{n_A q_A(1-q_A)}{n_A^2}\n$$\n$$\n= \\frac{p_A(1-p_A)}{n_A} + \\frac{q_A(1-q_A)}{n_A}\n$$\nThis is the variance of the harmonized estimator.\n\n**Summary of Final Formulae:**\n1.  Bias of $\\widehat{\\Delta}_{\\mathrm{unharm}}$: $\\mathrm{Bias}_{\\mathrm{unharm}} = \\frac{n_B(p_B-p_A)}{n_A+n_B} - \\frac{n_D(q_D-q_A)}{n_A+n_D}$\n2.  Variance of $\\widehat{\\Delta}_{\\mathrm{unharm}}$: $\\mathrm{Var}_{\\mathrm{unharm}} = \\frac{n_A p_A(1-p_A) + n_B p_B(1-p_B)}{(n_A + n_B)^2} + \\frac{n_A q_A(1-q_A) + n_D q_D(1-q_D)}{(n_A + n_D)^2}$\n3.  Bias of $\\widehat{\\Delta}_{\\mathrm{harm}}$: $\\mathrm{Bias}_{\\mathrm{harm}} = 0$\n4.  Variance of $\\widehat{\\Delta}_{\\mathrm{harm}}$: $\\mathrm{Var}_{\\mathrm{harm}} = \\frac{p_A(1-p_A) + q_A(1-q_A)}{n_A}$\nThe following Python program implements these four formulae.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the bias and variance for unharmonized and harmonized estimators\n    of rare variant burden difference for a set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n_A, n_B, n_D, p_A, p_B, q_A, q_D)\n        (3000, 5000, 4000, 2e-4, 5e-5, 1.2e-4, 3e-4),\n        (5000, 0, 3000, 1.8e-4, 1.8e-4, 1.4e-4, 1.1e-4),\n        (4000, 6000, 2000, 1e-4, 1e-4, 1e-4, 1e-4),\n        (500, 9500, 9500, 2.5e-4, 2e-5, 1e-4, 5e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        n_A, n_B, n_D, p_A, p_B, q_A, q_D = case\n\n        # --- Unharmonized Estimator Calculations ---\n\n        # Bias of the unharmonized estimator\n        # Bias_unharm = (E[delta_unharm] - (p_A - q_A))\n        # E[delta_unharm] = (n_A*p_A + n_B*p_B)/(n_A+n_B) - (n_A*q_A + n_D*q_D)/(n_A+n_D)\n        bias_unharm_term1 = (n_B * (p_B - p_A)) / (n_A + n_B) if (n_A + n_B) > 0 else 0\n        bias_unharm_term2 = (n_D * (q_D - q_A)) / (n_A + n_D) if (n_A + n_D) > 0 else 0\n        bias_unharm = bias_unharm_term1 - bias_unharm_term2\n\n        # Variance of the unharmonized estimator\n        # Var(delta_unharm) = Var(cases_mean) + Var(controls_mean)\n        # Var(cases_mean) = (n_A*p_A*(1-p_A) + n_B*p_B*(1-p_B))/(n_A+n_B)^2\n        # Var(controls_mean) = (n_A*q_A*(1-q_A) + n_D*q_D*(1-q_D))/(n_A+n_D)^2\n        var_cases_unharm_num = n_A * p_A * (1 - p_A) + n_B * p_B * (1 - p_B)\n        var_cases_unharm_den = (n_A + n_B)**2\n        var_cases_unharm = var_cases_unharm_num / var_cases_unharm_den if var_cases_unharm_den > 0 else 0\n\n        var_controls_unharm_num = n_A * q_A * (1 - q_A) + n_D * q_D * (1 - q_D)\n        var_controls_unharm_den = (n_A + n_D)**2\n        var_controls_unharm = var_controls_unharm_num / var_controls_unharm_den if var_controls_unharm_den > 0 else 0\n        \n        var_unharm = var_cases_unharm + var_controls_unharm\n\n        # --- Harmonized Estimator Calculations ---\n\n        # Bias of the harmonized estimator\n        # E[delta_harm] = p_A - q_A, so bias is 0.\n        bias_harm = 0.0\n\n        # Variance of the harmonized estimator\n        # Var(delta_harm) = (p_A*(1-p_A))/n_A + (q_A*(1-q_A))/n_A\n        if n_A > 0:\n            var_harm = (p_A * (1 - p_A) + q_A * (1 - q_A)) / n_A\n        else: # This case is not in the tests, but good practice.\n            var_harm = float('inf')\n\n        results.append([bias_unharm, var_unharm, bias_harm, var_harm])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is desired.\n    # We remove spaces to match the example format exactly.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "4603566"}]}