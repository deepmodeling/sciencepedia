{"hands_on_practices": [{"introduction": "Mastering sequence alignment begins with a deep, mechanical understanding of the dynamic programming algorithm. This exercise [@problem_id:4592019] challenges you to manually construct the full set of dynamic programming tables for a global alignment using an affine gap penalty, which distinguishes between the cost of opening a gap and extending one. By meticulously calculating the values for the three states—match/mismatch ($M$), gap in sequence Y ($I_x$), and gap in sequence X ($I_y$)—you will gain an intuitive grasp of how optimal paths are formed.", "problem": "Consider two deoxyribonucleic acid (DNA) sequences $X$ and $Y$ to be globally aligned under an affine gap penalty model. Let $X = (A, C, G, T)$ of length $n=4$ and $Y = (A, G, T, A)$ of length $m=4$. The scoring scheme is defined by a substitution function $S(\\cdot,\\cdot)$ and affine gap parameters. The substitution function $S(a,b)$ satisfies $S(a,a)=2$ for $a \\in \\{A,C,G,T\\}$, $S(A,G)=S(G,A)=0$, $S(C,T)=S(T,C)=0$, and $S(a,b)=-1$ for all other unequal pairs in $\\{A,C,G,T\\} \\times \\{A,C,G,T\\}$. The affine gap model assigns, for a gap of length $L \\geq 1$, a total contribution $-(g_o + L g_e)$ to the score, where $g_o=3$ is the gap opening parameter and $g_e=1$ is the per-residue gap extension parameter. The goal is to maximize the alignment score.\n\nUsing the principle of optimality and the standard decomposition into three dynamic programming (DP) state tables corresponding to match/mismatch ($M$), gap in $Y$ ($I_x$), and gap in $X$ ($I_y$), compute the full DP tables $M(i,j)$, $I_x(i,j)$, and $I_y(i,j)$ for $0 \\leq i \\leq 4$ and $0 \\leq j \\leq 4$, including boundary conditions consistent with global alignment and affine gaps. Then, determine the optimal final alignment score at $(i,j)=(4,4)$ and provide the precise state path from $(4,4)$ back to $(0,0)$ through the $M$, $I_x$, and $I_y$ states that realizes this optimum.\n\nExpress the final alignment score as a single real-valued number. No rounding is required.", "solution": "The problem requires performing a global alignment of two DNA sequences, $X$ and $Y$, using an affine gap penalty model. We are asked to compute the dynamic programming (DP) tables, determine the optimal alignment score, and find the corresponding state path.\n\nThe sequences are $X = (A, C, G, T)$ of length $n=4$ and $Y = (A, G, T, A)$ of length $m=4$. The scoring scheme is as follows:\nThe substitution function $S(a,b)$ gives a score of $S(a,a)=2$ for a match. For mismatches, the scores are $S(A,G)=S(G,A)=0$, $S(C,T)=S(T,C)=0$, and $S(a,b)=-1$ for all other pairs.\nThe affine gap penalty for a gap of length $L$ is $-(g_o + L g_e)$, with the gap opening parameter $g_o=3$ and the gap extension parameter $g_e=1$.\n\nWe use three DP tables:\n$M(i,j)$: score of the optimal alignment of $X[1..i]$ and $Y[1..j]$ ending with $X[i]$ aligned to $Y[j]$.\n$I_x(i,j)$: score of the optimal alignment of $X[1..i]$ and $Y[1..j]$ ending with $X[i]$ aligned to a gap.\n$I_y(i,j)$: score of the optimal alignment of $X[1..i]$ and $Y[1..j]$ ending with $Y[j]$ aligned to a gap.\n\nThe gap opening cost is $-(g_o+g_e) = -(3+1) = -4$.\nThe gap extension cost is $-g_e = -1$.\n\nThe recurrence relations for $i>0$ and $j>0$ are:\n$$M(i,j) = S(X[i], Y[j]) + \\max \\begin{cases} M(i-1, j-1) \\\\ I_x(i-1, j-1) \\\\ I_y(i-1, j-1) \\end{cases}$$\n$$I_x(i,j) = \\max \\begin{cases} M(i-1, j) - (g_o + g_e) \\\\ I_x(i-1, j) - g_e \\end{cases} = \\max \\begin{cases} M(i-1, j) - 4 \\\\ I_x(i-1, j) - 1 \\end{cases}$$\n$$I_y(i,j) = \\max \\begin{cases} M(i, j-1) - (g_o + g_e) \\\\ I_y(i, j-1) - g_e \\end{cases} = \\max \\begin{cases} M(i, j-1) - 4 \\\\ I_y(i, j-1) - 1 \\end{cases}$$\n\nFor global alignment, the boundary conditions are:\n$M(0,0) = 0$.\n$M(i,0) = -\\infty$ for $i0$, and $M(0,j) = -\\infty$ for $j0$.\n$I_x(0,j) = -\\infty$ for all $j \\ge 0$.\n$I_y(i,0) = -\\infty$ for all $i \\ge 0$.\nFor $i0$, $I_x(i,0) = -(g_o + i \\cdot g_e) = -(3+i)$. This corresponds to aligning the prefix $X[1..i]$ with $i$ gaps.\nFor $j0$, $I_y(0,j) = -(g_o + j \\cdot g_e) = -(3+j)$. This corresponds to aligning the prefix $Y[1..j]$ with $j$ gaps.\n\nWe now compute the DP tables for $0 \\leq i \\leq 4$ and $0 \\leq j \\leq 4$.\n\n**Table M(i,j):**\n$$\n\\begin{array}{c|cccccc}\nY \\setminus X  \\epsilon  A~(i=1)  C~(i=2)  G~(i=3)  T~(i=4) \\\\\n\\hline\n\\epsilon~(j=0)  0  -\\infty  -\\infty  -\\infty  -\\infty \\\\\nA~(j=1)  -\\infty  2  -5  -5  -7 \\\\\nG~(j=2)  -\\infty  -4  1  0  -4 \\\\\nT~(j=3)  -\\infty  -6  -2  0  2 \\\\\nA~(j=4)  -\\infty  -4  -4  -2  -1\n\\end{array}\n$$\n\n**Table $I_x(i,j)$ (Gap in Y):**\n$$\n\\begin{array}{c|cccccc}\nY \\setminus X  \\epsilon  A~(i=1)  C~(i=2)  G~(i=3)  T~(i=4) \\\\\n\\hline\n\\epsilon~(j=0)  -\\infty  -4  -5  -6  -7 \\\\\nA~(j=1)  -\\infty  -\\infty  -2  -3  -4 \\\\\nG~(j=2)  -\\infty  -\\infty  -8  -3  -4 \\\\\nT~(j=3)  -\\infty  -\\infty  -10  -6  -4 \\\\\nA~(j=4)  -\\infty  -\\infty  -8  -8  -6\n\\end{array}\n$$\n\n**Table $I_y(i,j)$ (Gap in X):**\n$$\n\\begin{array}{c|cccccc}\nY \\setminus X  \\epsilon  A~(i=1)  C~(i=2)  G~(i=3)  T~(i=4) \\\\\n\\hline\n\\epsilon~(j=0)  -\\infty  -\\infty  -\\infty  -\\infty  -\\infty \\\\\nA~(j=1)  -4  -\\infty  -\\infty  -\\infty  -\\infty \\\\\nG~(j=2)  -5  -2  -3  -4  -5 \\\\\nT~(j=3)  -6  -3  -3  -4  -6 \\\\\nA~(j=4)  -7  -4  -4  -4  -2\n\\end{array}\n$$\n\nThe final alignment score is the maximum value at the bottom-right cell $(i=4, j=4)$ across the three tables:\n$$ \\text{Score} = \\max(M(4,4), I_x(4,4), I_y(4,4)) = \\max(-1, -6, -2) = -1 $$\nThe optimal alignment score is $-1$.\n\nTo find the optimal alignment, we perform a traceback from the state that yields the optimal score. The maximum score $-1$ is found in $M(4,4)$.\n\n1.  **State (4,4,M): Score = -1**.\n    $M(4,4) = S(X[4], Y[4]) + \\max(M(3,3), I_x(3,3), I_y(3,3)) = S(T,A) + \\max(0, -6, -4) = -1 + 0 = -1$.\n    The score $0$ at $(3,3)$ comes from $M(3,3)$. The predecessor is state $(3,3,M)$.\n    Alignment step: $T$ aligns with $A$.\n\n2.  **State (3,3,M): Score = 0**.\n    $M(3,3) = S(X[3], Y[3]) + \\max(M(2,2), I_x(2,2), I_y(2,2)) = S(G,T) + \\max(1, -8, -3) = -1 + 1 = 0$.\n    The score $1$ at $(2,2)$ comes from $M(2,2)$. The predecessor is state $(2,2,M)$.\n    Alignment step: $G$ aligns with $T$.\n\n3.  **State (2,2,M): Score = 1**.\n    $M(2,2) = S(X[2], Y[2]) + \\max(M(1,1), I_x(1,1), I_y(1,1)) = S(C,G) + \\max(2, -\\infty, -\\infty) = -1 + 2 = 1$.\n    The score $2$ at $(1,1)$ comes from $M(1,1)$. The predecessor is state $(1,1,M)$.\n    Alignment step: $C$ aligns with $G$.\n\n4.  **State (1,1,M): Score = 2**.\n    $M(1,1) = S(X[1], Y[1]) + \\max(M(0,0), I_x(0,0), I_y(0,0)) = S(A,A) + \\max(0, -\\infty, -\\infty) = 2 + 0 = 2$.\n    The score $0$ at $(0,0)$ comes from $M(0,0)$. The predecessor is state $(0,0,M)$.\n    Alignment step: $A$ aligns with $A$.\n\n5.  **State (0,0,M): Score = 0**.\n    This is the start of the alignment.\n\nThe precise state path from $(4,4)$ back to $(0,0)$ is:\n$(4, 4, M) \\to (3, 3, M) \\to (2, 2, M) \\to (1, 1, M) \\to (0, 0, M)$.\n\nThis traceback corresponds to the gapless alignment:\n$X$: A C G T\n$Y$: A G T A\n\nThe score is calculated as: $S(A,A)+S(C,G)+S(G,T)+S(T,A) = 2 + (-1) + (-1) + (-1) = -1$.\nThis matches our result.", "answer": "$$\\boxed{-1}$$", "id": "4592019"}, {"introduction": "While dynamic programming provides the engine for alignment, the scoring scheme dictates the biological meaning of the result. This practice [@problem_id:4592021] takes you behind the scenes of substitution matrices like BLOSUM, which are founded on the log-odds principle. By deriving a toy matrix from raw pair counts, you will directly engage with the statistical concepts of target and background frequencies and see how they are used to quantify the evolutionary significance of residue substitutions.", "problem": "A fundamental scoring principle in pairwise sequence alignment for proteins is the use of log-odds substitution matrices derived from aligned homologous sequence blocks. In the BLOcks SUbstitution Matrix (BLOSUM) construction, the target probability of aligned residue pairs is estimated from within-block counts, while the null probability models independent sampling from background residue frequencies. The log-odds score for a pair $\\{i,j\\}$ is the natural logarithm of the ratio of the target pair probability to the null pair probability. This construction ensures that the expected score under the null model is negative, reflecting that random pairs are, on average, less consistent with homologous targeting than with independence.\n\nConsider a toy alphabet $\\mathcal{A} = \\{A,G,S\\}$ and the following unordered aligned-pair counts aggregated across clustered blocks of homologous proteins sampled in a medical proteomics study:\n- $n_{AA} = 40$, $n_{GG} = 30$, $n_{SS} = 20$,\n- $n_{AG} = 25$, $n_{AS} = 15$, $n_{GS} = 10$,\nwith total unordered pairs $N = \\sum_{i \\le j} n_{ij}$.\n\nFrom first principles:\n1. Define the target pair probabilities $q_{ij} = n_{ij}/N$ for $i \\le j$.\n2. Define the background (single-residue) frequencies $p_{i}$ as the probability that a randomly chosen residue from an aligned pair is $i$, given by $p_{i} = q_{ii} + \\sum_{j \\ne i} \\frac{q_{ij}}{2}$ so that $\\sum_{i \\in \\mathcal{A}} p_{i} = 1$.\n3. Define the null pair probabilities $e_{ij}$ for unordered pairs by $e_{ii} = p_{i}^{2}$ and $e_{ij} = 2 p_{i} p_{j}$ for $i \\ne j$.\n4. Define the unscaled natural-log odds scores $s_{ij} = \\ln\\!\\left(\\frac{q_{ij}}{e_{ij}}\\right)$, for $i \\le j$, using the natural logarithm.\n\nThen choose the positive scaling factor $\\lambda = \\frac{2}{\\ln 2}$ so that the scaled integer matrix $M$ has elements $M_{ij} = \\mathrm{round}\\!\\left(\\lambda\\, s_{ij}\\right)$, a half-bit scaling in natural log units rounded to integers.\n\nFinally, compute the expected score under the null model,\n$$\nE_{\\mathrm{null}} = \\sum_{i \\le j} e_{ij}\\, s_{ij},\n$$\nand verify it is negative by obtaining its numeric value.\n\nTasks:\n- Compute $q_{ij}$, $p_{i}$, $e_{ij}$, and the unscaled $s_{ij}$ for all unordered pairs in $\\mathcal{A}$.\n- Form the scaled integer matrix $M_{ij}$ using $\\lambda = \\frac{2}{\\ln 2}$.\n- Compute the numeric value of $E_{\\mathrm{null}}$ using the unscaled $s_{ij}$ and $e_{ij}$.\n\nRound your final $E_{\\mathrm{null}}$ to four significant figures. Express your answer as a pure number in natural logarithm units (nats).", "solution": "The construction begins with fundamental definitions of target and background probabilities for aligned residue pairs, consistent with the BLOcks SUbstitution Matrix (BLOSUM) framework. The target probability $q_{ij}$ is estimated directly from within-block aligned-pair counts, and the null probability $e_{ij}$ arises from independent sampling of residues with background frequencies $p_{i}$.\n\nStep 1: Compute target pair probabilities. The total number of unordered pairs is\n$$\nN = n_{AA} + n_{GG} + n_{SS} + n_{AG} + n_{AS} + n_{GS} = 40 + 30 + 20 + 25 + 15 + 10 = 140.\n$$\nThus,\n$$\nq_{AA} = \\frac{40}{140} = \\frac{2}{7},\\quad\nq_{GG} = \\frac{30}{140} = \\frac{3}{14},\\quad\nq_{SS} = \\frac{20}{140} = \\frac{1}{7},\n$$\n$$\nq_{AG} = \\frac{25}{140} = \\frac{5}{28},\\quad\nq_{AS} = \\frac{15}{140} = \\frac{3}{28},\\quad\nq_{GS} = \\frac{10}{140} = \\frac{1}{14}.\n$$\n\nStep 2: Compute background residue frequencies using the unordered-pair convention for BLOSUM. Each unordered off-diagonal pair contributes equally to both residues, so\n$$\np_{A} = q_{AA} + \\frac{q_{AG}}{2} + \\frac{q_{AS}}{2}\n= \\frac{2}{7} + \\frac{1}{2}\\left(\\frac{5}{28} + \\frac{3}{28}\\right)\n= \\frac{2}{7} + \\frac{1}{2}\\cdot\\frac{8}{28}\n= \\frac{2}{7} + \\frac{1}{7} = \\frac{3}{7},\n$$\n$$\np_{G} = q_{GG} + \\frac{q_{AG}}{2} + \\frac{q_{GS}}{2}\n= \\frac{3}{14} + \\frac{1}{2}\\left(\\frac{5}{28} + \\frac{1}{14}\\right)\n= \\frac{3}{14} + \\frac{1}{2}\\cdot\\frac{7}{28}\n= \\frac{3}{14} + \\frac{1}{4} = \\frac{19}{56},\n$$\n$$\np_{S} = q_{SS} + \\frac{q_{AS}}{2} + \\frac{q_{GS}}{2}\n= \\frac{1}{7} + \\frac{1}{2}\\left(\\frac{3}{28} + \\frac{1}{14}\\right)\n= \\frac{1}{7} + \\frac{1}{2}\\cdot\\frac{5}{28}\n= \\frac{1}{7} + \\frac{5}{56} = \\frac{13}{56}.\n$$\nIt is straightforward to verify $\\sum_{i \\in \\{A,G,S\\}} p_{i} = \\frac{3}{7} + \\frac{19}{56} + \\frac{13}{56} = \\frac{24 + 19 + 13}{56} = \\frac{56}{56} = 1$.\n\nStep 3: Compute null pair probabilities for unordered pairs. For $i=j$,\n$$\ne_{AA} = p_{A}^{2} = \\left(\\frac{3}{7}\\right)^{2} = \\frac{9}{49},\\quad\ne_{GG} = p_{G}^{2} = \\left(\\frac{19}{56}\\right)^{2} = \\frac{361}{3136},\\quad\ne_{SS} = p_{S}^{2} = \\left(\\frac{13}{56}\\right)^{2} = \\frac{169}{3136}.\n$$\nFor $i \\ne j$,\n$$\ne_{AG} = 2 p_{A} p_{G} = 2 \\cdot \\frac{3}{7} \\cdot \\frac{19}{56} = \\frac{57}{196},\\quad\ne_{AS} = 2 p_{A} p_{S} = 2 \\cdot \\frac{3}{7} \\cdot \\frac{13}{56} = \\frac{39}{196},\\quad\ne_{GS} = 2 p_{G} p_{S} = 2 \\cdot \\frac{19}{56} \\cdot \\frac{13}{56} = \\frac{247}{1568}.\n$$\n\nStep 4: Compute unscaled natural-log odds scores. Using $s_{ij} = \\ln\\!\\left(\\frac{q_{ij}}{e_{ij}}\\right)$ for unordered pairs,\n$$\ns_{AA} = \\ln\\!\\left(\\frac{q_{AA}}{e_{AA}}\\right)\n= \\ln\\!\\left(\\frac{\\frac{2}{7}}{\\frac{9}{49}}\\right)\n= \\ln\\!\\left(\\frac{14}{9}\\right),\n$$\n$$\ns_{GG} = \\ln\\!\\left(\\frac{q_{GG}}{e_{GG}}\\right)\n= \\ln\\!\\left(\\frac{\\frac{3}{14}}{\\frac{361}{3136}}\\right)\n= \\ln\\!\\left(\\frac{672}{361}\\right),\n$$\n$$\ns_{SS} = \\ln\\!\\left(\\frac{q_{SS}}{e_{SS}}\\right)\n= \\ln\\!\\left(\\frac{\\frac{1}{7}}{\\frac{169}{3136}}\\right)\n= \\ln\\!\\left(\\frac{448}{169}\\right),\n$$\n$$\ns_{AG} = \\ln\\!\\left(\\frac{q_{AG}}{e_{AG}}\\right)\n= \\ln\\!\\left(\\frac{\\frac{5}{28}}{\\frac{57}{196}}\\right)\n= \\ln\\!\\left(\\frac{35}{57}\\right),\n$$\n$$\ns_{AS} = \\ln\\!\\left(\\frac{q_{AS}}{e_{AS}}\\right)\n= \\ln\\!\\left(\\frac{\\frac{3}{28}}{\\frac{39}{196}}\\right)\n= \\ln\\!\\left(\\frac{7}{13}\\right),\n$$\n$$\ns_{GS} = \\ln\\!\\left(\\frac{q_{GS}}{e_{GS}}\\right)\n= \\ln\\!\\left(\\frac{\\frac{1}{14}}{\\frac{247}{1568}}\\right)\n= \\ln\\!\\left(\\frac{112}{247}\\right).\n$$\nNumerically (natural log),\n$$\ns_{AA} \\approx 0.441832752,\\quad s_{GG} \\approx 0.621380382,\\quad s_{SS} \\approx 0.974894517,\n$$\n$$\ns_{AG} \\approx -0.487703206,\\quad s_{AS} \\approx -0.619039208,\\quad s_{GS} \\approx -0.790889465.\n$$\n\nStep 5: Scale to integers using $\\lambda = \\frac{2}{\\ln 2}$ (half-bit scaling in natural log units) and round:\n$$\n\\lambda = \\frac{2}{\\ln 2} \\approx 2.885390082.\n$$\nThus,\n$$\nM_{AA} = \\mathrm{round}(\\lambda s_{AA}) \\approx \\mathrm{round}(1.275) = 1,\\quad\nM_{GG} \\approx \\mathrm{round}(1.793) = 2,\\quad\nM_{SS} \\approx \\mathrm{round}(2.813) = 3,\n$$\n$$\nM_{AG} \\approx \\mathrm{round}(-1.408) = -1,\\quad\nM_{AS} \\approx \\mathrm{round}(-1.787) = -2,\\quad\nM_{GS} \\approx \\mathrm{round}(-2.281) = -2.\n$$\nThis produces a symmetric integer matrix typical of BLOSUM-like scoring, with positive diagonal and negative off-diagonals.\n\nStep 6: Compute the expected score under the null model and verify negativity. By definition,\n$$\nE_{\\mathrm{null}} = \\sum_{i \\le j} e_{ij} s_{ij}\n= e_{AA} s_{AA} + e_{GG} s_{GG} + e_{SS} s_{SS}\n+ e_{AG} s_{AG} + e_{AS} s_{AS} + e_{GS} s_{GS}.\n$$\nThis expectation equals $-D_{\\mathrm{KL}}(e \\Vert q)$, the negative Kullback–Leibler Divergence (KLD) from the null distribution $e$ to the target $q$, and is therefore strictly negative unless $e=q$. Concretely,\n$$\nE_{\\mathrm{null}} = \\frac{9}{49}\\ln\\!\\left(\\frac{14}{9}\\right)\n+ \\frac{361}{3136}\\ln\\!\\left(\\frac{672}{361}\\right)\n+ \\frac{169}{3136}\\ln\\!\\left(\\frac{448}{169}\\right)\n+ \\frac{57}{196}\\ln\\!\\left(\\frac{35}{57}\\right)\n+ \\frac{39}{196}\\ln\\!\\left(\\frac{7}{13}\\right)\n+ \\frac{247}{1568}\\ln\\!\\left(\\frac{112}{247}\\right).\n$$\nNumerically,\n$$\ne_{AA} s_{AA} \\approx 0.183673469 \\cdot 0.441832752 \\approx 0.081153,\n$$\n$$\ne_{GG} s_{GG} \\approx 0.115114797 \\cdot 0.621380382 \\approx 0.071530,\n$$\n$$\ne_{SS} s_{SS} \\approx 0.053890306 \\cdot 0.974894517 \\approx 0.052537,\n$$\n$$\ne_{AG} s_{AG} \\approx 0.290816327 \\cdot (-0.487703206) \\approx -0.141832,\n$$\n$$\ne_{AS} s_{AS} \\approx 0.198979592 \\cdot (-0.619039208) \\approx -0.123176,\n$$\n$$\ne_{GS} s_{GS} \\approx 0.157525510 \\cdot (-0.790889465) \\approx -0.124585.\n$$\nSumming,\n$$\nE_{\\mathrm{null}} \\approx (0.081153 + 0.071530 + 0.052537) - (0.141832 + 0.123176 + 0.124585)\n\\approx 0.205220 - 0.389593 \\approx -0.184373.\n$$\nTherefore, $E_{\\mathrm{null}}$ is negative, as required by the log-odds construction. Rounding to four significant figures yields $-0.1844$ in natural log units (nats).", "answer": "$$\\boxed{-0.1844}$$", "id": "4592021"}, {"introduction": "The quadratic space complexity of standard dynamic programming alignment algorithms presents a significant hurdle for analyzing large genomic sequences. This advanced exercise [@problem_id:4592038] introduces Hirschberg's algorithm, an elegant divide-and-conquer strategy that reduces working space requirements from quadratic to linear. You will derive the forward and backward recurrences that make this possible and apply them to find an optimal split point, providing a foundational understanding of how to make alignment computationally feasible at scale.", "problem": "Consider two deoxyribonucleic acid (DNA) sequences $X = x_{1} x_{2} \\dots x_{m}$ and $Y = y_{1} y_{2} \\dots y_{n}$ with lengths $m$ and $n$, respectively. We consider global alignment under a standard scoring model: a substitution scoring function $\\sigma(a,b)$ that gives the score of aligning character $a$ with character $b$, and a constant linear gap penalty $d  0$ applied for each gap character. The optimal global alignment score between prefixes is defined by the dynamic programming optimal substructure: the score to align $X[1..i]$ to $Y[1..j]$ equals the maximum among introducing a match or mismatch at $(i,j)$, a gap at $x_{i}$, or a gap at $y_{j}$.\n\nYour tasks are as follows, grounded in these definitions:\n\n1. Starting from the optimal substructure principle for global alignment, derive the one-row forward recurrence that computes the dynamic programming scores for a fixed row index $i$ using only the immediately preceding row and the current row-in-progress. Define explicitly the forward score vector $F^{(i)} \\in \\mathbb{R}^{n+1}$, with entries $F^{(i)}_{j}$ equal to the optimal score for aligning $X[1..i]$ with $Y[1..j]$, and state the initialization and recurrence relations that allow $F^{(i)}$ to be computed with $O(n)$ working memory.\n\n2. By symmetry, derive the backward score vector $B^{(i)} \\in \\mathbb{R}^{n+1}$, where $B^{(i)}_{j}$ is the optimal score to align the suffix $X[i+1..m]$ with the suffix $Y[j+1..n]$. Show how to compute $B^{(i)}$ in $O(n)$ working memory either by reversing sequences and reusing the forward recurrence or by directly formulating the backward recurrence. State the initialization and recurrence relations.\n\n3. Using the forward and backward vectors, express the Hirschberg split index $k^{\\star}$ at the fixed row $i$ as the index $j \\in \\{0,1,\\dots,n\\}$ that maximizes the sum $F^{(i)}_{j} + B^{(i)}_{j}$. Explain why this choice implements the divide-and-conquer step and how it ensures that the total space to reconstruct an optimal alignment is $O(m+n)$, assuming standard stack-frame reuse and that the output alignment representation is stored.\n\nThen, for the concrete instance below, compute the numerical value of the Hirschberg split index at the middle row. Use the following data:\n- $X = $ \"AGTCA\" with $m = 5$,\n- $Y = $ \"ATGCCA\" with $n = 6$,\n- $\\sigma(a,b) = 2$ if $a=b$, and $\\sigma(a,b) = -1$ if $a \\neq b$,\n- $d = -2$,\n- middle row index $i = \\lfloor m/2 \\rfloor$.\n\nCompute $F^{(i)}$ and $B^{(i)}$ and then $k^{\\star} = \\arg\\max_{0 \\leq j \\leq n} \\left( F^{(i)}_{j} + B^{(i)}_{j} \\right)$. If there is a tie, choose the smallest such $j$. Report only the value of $k^{\\star}$ as your final answer. No rounding is required and no units are needed. The final answer must be a single real-valued number.", "solution": "The problem statement is a valid application of bioinformatics principles, specifically the Needleman-Wunsch algorithm for global sequence alignment and its space-efficient variant, the Hirschberg algorithm. All components—sequences, scoring scheme, and objectives—are well-defined, scientifically sound, and internally consistent.\n\nThe core of global alignment is the dynamic programming recurrence for the score $S(i,j)$ of aligning prefixes $X[1..i]$ and $Y[1..j]$. With a linear gap penalty $d$, the recurrence is:\n$$S(i,j) = \\max \\begin{cases} S(i-1, j-1) + \\sigma(x_i, y_j)  \\text{(match/mismatch)} \\\\ S(i-1, j) + d  \\text{(gap in } Y) \\\\ S(i, j-1) + d  \\text{(gap in } X) \\end{cases}$$\nThe base conditions are $S(0,0)=0$, $S(i,0) = i \\cdot d$, and $S(0,j) = j \\cdot d$.\n\n**1. Forward Recurrence**\n\nThe forward score vector $F^{(i)} \\in \\mathbb{R}^{n+1}$ has entries $F^{(i)}_{j}$ representing the optimal score of aligning $X[1..i]$ with $Y[1..j]$, which is equivalent to $S(i,j)$. To compute the scores for row $i$ using only memory proportional to the length of sequence $Y$, we observe that computing $S(i,j)$ only requires values from row $i-1$ and the current row $i$.\n\nWe define $F^{(i-1)}$ as the vector of scores from the previous row, where $F^{(i-1)}_{j} = S(i-1, j)$. The recurrence relation for the entries of $F^{(i)}$ is:\n$$F^{(i)}_{j} = \\max\\left( F^{(i-1)}_{j-1} + \\sigma(x_i, y_j), F^{(i-1)}_{j} + d, F^{(i)}_{j-1} + d \\right)$$\nThis formulation allows the computation of the entire vector $F^{(i)}$ using only the vector $F^{(i-1)}$ and the sequentially computed elements of $F^{(i)}$ itself.\n\n- **Initialization**: For row $i=0$, we are aligning an empty prefix of $X$ with prefixes of $Y$.\n$$F^{(0)}_{j} = j \\cdot d \\quad \\text{for } j \\in \\{0, 1, \\dots, n\\}$$\n- **Recurrence for the row vector**: To compute $F^{(i)}$ for $i  0$ given $F^{(i-1)}$:\nThe first element corresponds to aligning $X[1..i]$ with an empty prefix of $Y$.\n$$F^{(i)}_{0} = i \\cdot d$$\nThe remaining elements are computed for $j = 1, \\dots, n$:\n$$F^{(i)}_{j} = \\max\\left( F^{(i-1)}_{j-1} + \\sigma(x_i, y_j), F^{(i-1)}_{j} + d, F^{(i)}_{j-1} + d \\right)$$\nThis computation requires two vectors of size $n+1$ (one for the previous row, one for the current row), thus achieving $O(n)$ working memory.\n\n**2. Backward Recurrence**\n\nBy symmetry, the backward score vector $B^{(i)} \\in \\mathbb{R}^{n+1}$ has entries $B^{(i)}_{j}$ representing the optimal score for aligning the suffix $X[i+1..m]$ with the suffix $Y[j+1..n]$. Let's denote this score by $S_{rev}(i,j)$. The recurrence can be formulated by considering alignments from the end of the sequences backwards.\n\n$$S_{rev}(i,j) = \\max \\begin{cases} S_{rev}(i+1, j+1) + \\sigma(x_{i+1}, y_{j+1}) \\\\ S_{rev}(i+1, j) + d \\\\ S_{rev}(i, j+1) + d \\end{cases}$$\n- **Initialization**: The \"end\" of the backward alignment is at index $(m,n)$, where two empty suffixes align with a score of $0$.\n$$B^{(m)}_{j} = (n-j) \\cdot d \\quad \\text{for } j \\in \\{0, 1, \\dots, n\\}$$\nThis corresponds to aligning an empty suffix of $X$ with the suffix $Y[j+1..n]$.\n- **Recurrence for the row vector**: To compute $B^{(i)}$ for $i  m$ given $B^{(i+1)}$:\nThe last element corresponds to aligning $X[i+1..m]$ with an empty suffix of $Y$.\n$$B^{(i)}_{n} = (m-i) \\cdot d$$\nThe remaining elements are computed by iterating backwards from $j = n-1$ down to $0$:\n$$B^{(i)}_{j} = \\max\\left( B^{(i+1)}_{j+1} + \\sigma(x_{i+1}, y_{j+1}), B^{(i+1)}_{j} + d, B^{(i)}_{j+1} + d \\right)$$\nThis also requires $O(n)$ working memory.\n\n**3. Hirschberg Split Index and Space Complexity**\n\nAn optimal global alignment of $X$ and $Y$ must pass through some cell $(i,j)$ for any chosen row $i$. The score of any path passing through $(i,j)$ is the sum of the score of an optimal path from $(0,0)$ to $(i,j)$ and the score of an optimal path from $(i,j)$ to $(m,n)$. These scores are precisely $F^{(i)}_{j}$ and $B^{(i)}_{j}$, respectively. The total score of the overall optimal alignment, $S_{opt}$, is therefore:\n$$S_{opt} = \\max_{0 \\leq j \\leq n} \\left( F^{(i)}_{j} + B^{(i)}_{j} \\right)$$\nThe Hirschberg split index $k^{\\star}$ is the value of $j$ that achieves this maximum:\n$$k^{\\star} = \\arg\\max_{0 \\leq j \\leq n} \\left( F^{(i)}_{j} + B^{(i)}_{j} \\right)$$\nThis choice implements the divide-and-conquer strategy by identifying a point $(i, k^{\\star})$ on an optimal alignment path. The problem is then divided into two smaller, independent subproblems: aligning $X[1..i]$ with $Y[1..k^{\\star}]$ and aligning $X[i+1..m]$ with $Y[k^{\\star}+1..n]$.\n\nThe space complexity of $O(m+n)$ is achieved as follows:\n1.  **Working Memory**: At each step of the recursion for a subproblem of size $m' \\times n'$, finding the split point requires computing one forward and one backward score vector. If the split is along the dimension of length $m'$, this requires $O(n')$ working memory. The recursive calls are sequential. The maximum working memory is used at the top-level call, which is $O(n)$ (assuming we split along $m$).\n2.  **Output Storage**: The final alignment path, which is constructed by concatenating the results from the base cases of the recursion, has a length of at most $m+n$. Storing this path requires $O(m+n)$ space.\nThe total space is the sum of the maximum working memory and the output storage: $O(n) + O(m+n) = O(m+n)$.\n\n**Numerical Computation**\n\nGiven:\n- $X = $ \"AGTCA\" ($m=5$)\n- $Y = $ \"ATGCCA\" ($n=6$)\n- $\\sigma(match) = 2$, $\\sigma(mismatch) = -1$, $d = -2$\n- Middle row index $i = \\lfloor m/2 \\rfloor = \\lfloor 5/2 \\rfloor = 2$.\n\n**A. Compute Forward Vector $F^{(2)}$**\n$F^{(i)}_{j}$ is the score of aligning $X[1..i]$ with $Y[1..j]$.\n- **Row 0**: $F^{(0)} = [0, -2, -4, -6, -8, -10, -12]$\n- **Row 1 (for $x_1=$'A')**: $F^{(1)} = [-2, 2, 0, -2, -4, -6, -8]$\n- **Row 2 (for $x_2=$'G')**: We compute $F^{(2)}$ using $F^{(1)}$.\n$F^{(2)}_{0} = 2d = -4$.\n$F^{(2)}_{1} = \\max(F^{(1)}_{0}+\\sigma(G,A), F^{(1)}_{1}+d, F^{(2)}_{0}+d) = \\max(-2-1, 2-2, -4-2) = 0$.\n$F^{(2)}_{2} = \\max(F^{(1)}_{1}+\\sigma(G,T), F^{(1)}_{2}+d, F^{(2)}_{1}+d) = \\max(2-1, 0-2, 0-2) = 1$.\n$F^{(2)}_{3} = \\max(F^{(1)}_{2}+\\sigma(G,G), F^{(1)}_{3}+d, F^{(2)}_{2}+d) = \\max(0+2, -2-2, 1-2) = 2$.\n$F^{(2)}_{4} = \\max(F^{(1)}_{3}+\\sigma(G,C), F^{(1)}_{4}+d, F^{(2)}_{3}+d) = \\max(-2-1, -4-2, 2-2) = 0$.\n$F^{(2)}_{5} = \\max(F^{(1)}_{4}+\\sigma(G,C), F^{(1)}_{5}+d, F^{(2)}_{4}+d) = \\max(-4-1, -6-2, 0-2) = -2$.\n$F^{(2)}_{6} = \\max(F^{(1)}_{5}+\\sigma(G,A), F^{(1)}_{6}+d, F^{(2)}_{5}+d) = \\max(-6-1, -8-2, -2-2) = -4$.\nSo, $F^{(2)} = [-4, 0, 1, 2, 0, -2, -4]$.\n\n**B. Compute Backward Vector $B^{(2)}$**\n$B^{(i)}_{j}$ is the score of aligning $X[i+1..m]$ with $Y[j+1..n]$. We need to compute $B^{(2)}$ for $X[3..5]$=\"TCA\".\n- **Row 5 (for empty suffix of $X$)**: $B^{(5)}_{j} = (6-j)d$.\n$B^{(5)} = [-12, -10, -8, -6, -4, -2, 0]$.\n- **Row 4 (for $x_5=$'A')**: $B^{(4)} = [-8, -6, -4, -2, 0, 2, -2]$.\n- **Row 3 (for $x_4=$'C')**: $B^{(3)} = [-4, -2, 0, 2, 4, 0, -4]$.\n- **Row 2 (for $x_3=$'T')**: We compute $B^{(2)}$ using $B^{(3)}$.\n$B^{(2)}_{6} = (5-2)d = 3d = -6$.\n$B^{(2)}_{5} = \\max(B^{(3)}_{6}+\\sigma(T,A), B^{(3)}_{5}+d, B^{(2)}_{6}+d) = \\max(-4-1, 0-2, -6-2) = -2$.\n$B^{(2)}_{4} = \\max(B^{(3)}_{5}+\\sigma(T,C), B^{(3)}_{4}+d, B^{(2)}_{5}+d) = \\max(0-1, 4-2, -2-2) = 2$.\n$B^{(2)}_{3} = \\max(B^{(3)}_{4}+\\sigma(T,C), B^{(3)}_{3}+d, B^{(2)}_{4}+d) = \\max(4-1, 2-2, 2-2) = 3$.\n$B^{(2)}_{2} = \\max(B^{(3)}_{3}+\\sigma(T,G), B^{(3)}_{2}+d, B^{(2)}_{3}+d) = \\max(2-1, 0-2, 3-2) = 1$.\n$B^{(2)}_{1} = \\max(B^{(3)}_{2}+\\sigma(T,T), B^{(3)}_{1}+d, B^{(2)}_{2}+d) = \\max(0+2, -2-2, 1-2) = 2$.\n$B^{(2)}_{0} = \\max(B^{(3)}_{1}+\\sigma(T,A), B^{(3)}_{0}+d, B^{(2)}_{1}+d) = \\max(-2-1, -4-2, 2-2) = 0$.\nSo, $B^{(2)} = [0, 2, 1, 3, 2, -2, -6]$.\n\n**C. Find Split Index $k^{\\star}$**\nWe compute the sum $S_j = F^{(2)}_{j} + B^{(2)}_{j}$ for $j=0, \\dots, 6$.\n- $j=0: S_0 = -4 + 0 = -4$\n- $j=1: S_1 = 0 + 2 = 2$\n- $j=2: S_2 = 1 + 1 = 2$\n- $j=3: S_3 = 2 + 3 = 5$\n- $j=4: S_4 = 0 + 2 = 2$\n- $j=5: S_5 = -2 + (-2) = -4$\n- $j=6: S_6 = -4 + (-6) = -10$\nThe vector of sums is $[-4, 2, 2, 5, 2, -4, -10]$. The maximum value is $5$, which uniquely occurs at $j=3$.\nTherefore, the Hirschberg split index is $k^{\\star} = 3$.", "answer": "$$\\boxed{3}$$", "id": "4592038"}]}