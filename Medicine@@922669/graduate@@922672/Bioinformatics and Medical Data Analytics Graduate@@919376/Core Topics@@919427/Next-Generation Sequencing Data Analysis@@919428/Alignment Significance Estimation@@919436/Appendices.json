{"hands_on_practices": [{"introduction": "A cornerstone of interpreting alignment significance is understanding that the E-value is not an intrinsic property of an alignment's score alone, but is context-dependent, scaling with the size of the search space. This exercise provides foundational practice in deriving the common E-value formula from the bit score and using it to quantify the direct impact of database size. Mastering this calculation [@problem_id:4538924] is crucial for comparing search results across databases of different scales, such as a targeted pathogen database versus a vast metagenomic repository.", "problem": "A research group is performing protein homology searches in two practical settings: a targeted clinical pathogen database and a comprehensive metagenomic database. The same protein query of length $m = 1200$ amino acids produces a reported Basic Local Alignment Search Tool (BLAST) bit score $S' = 65$ for its top-scoring alignment to a specific subject sequence present in both databases. The pathogen database has total length $n_{A} = 5.0 \\times 10^{7}$ amino acids, and the metagenomic database has total length $n_{B} = 3.0 \\times 10^{9}$ amino acids. Assume the Karlin–Altschul model for local alignment scores applies with fixed statistical parameters for the scoring system used, and that effective lengths can be taken equal to the actual lengths for this setup.\n\nStarting from the foundational definitions associated with the Karlin–Altschul statistics and the BLAST bit score, derive the expression for the expected number of random high-scoring alignments (E-value) in terms of the query length $m$, database length $n$, and the bit score $S'$. Then, using that expression, quantify how the E-value changes when moving from Database $A$ to Database $B$ by computing the fold-change $\\frac{E_{B}}{E_{A}}$.\n\nProvide the final numeric value for $\\frac{E_{B}}{E_{A}}$ and round your answer to four significant figures. No units are required in the final answer.", "solution": "The problem requires the derivation of the formula for the BLAST E-value in terms of query length, database length, and bit score, and then using this formula to calculate the fold-change in E-value when moving from a smaller database to a larger one.\n\nThe analysis begins with the foundational Karlin–Altschul statistical model. The expected number of random alignments (the E-value, $E$) with a raw score $S$ greater than or equal to a threshold score $x$ is given by:\n$$E = K m' n' \\exp(-\\lambda x)$$\nIn this equation, $K$ and $\\lambda$ are statistical parameters determined by the scoring matrix and the background amino acid frequencies. The terms $m'$ and $n'$ represent the effective lengths of the query and the database, respectively. The problem statement allows for the simplification that the effective lengths are equal to the actual sequence lengths, thus $m' = m$ and $n' = n$. For a specific alignment with an observed raw score $S$, the E-value is:\n$$E = K m n \\exp(-\\lambda S)$$\n\nThe bit score, denoted as $S'$, is a normalized score that is independent of the parameters $K$ and $\\lambda$. The relationship between the raw score $S$ and the bit score $S'$ is defined as:\n$$S' = \\frac{\\lambda S - \\ln(K)}{\\ln(2)}$$\nTo derive the E-value expression in terms of the bit score $S'$, we first need to express the term $\\exp(-\\lambda S)$ using $S'$. We rearrange the bit score equation to solve for $\\lambda S$:\n$$S' \\ln(2) = \\lambda S - \\ln(K)$$\n$$\\lambda S = S' \\ln(2) + \\ln(K)$$\nNow, we can substitute this expression into the exponent of the E-value equation:\n$$E = K m n \\exp(-(S' \\ln(2) + \\ln(K)))$$\nUsing the property of exponents $\\exp(a+b) = \\exp(a)\\exp(b)$, we can separate the terms:\n$$E = K m n \\exp(-S' \\ln(2)) \\exp(-\\ln(K))$$\nThe term $\\exp(-\\ln(K))$ simplifies to $\\exp(\\ln(K^{-1}))$, which is equal to $K^{-1}$ or $\\frac{1}{K}$. Substituting this back into the equation gives:\n$$E = K m n \\exp(-S' \\ln(2)) \\frac{1}{K}$$\nThe parameter $K$ cancels out, leaving:\n$$E = m n \\exp(-S' \\ln(2))$$\nUsing another property of logarithms and exponents, $a \\ln(b) = \\ln(b^a)$ and $\\exp(\\ln(x)) = x$, we can simplify the exponential term:\n$$\\exp(-S' \\ln(2)) = \\exp(\\ln(2^{-S'})) = 2^{-S'}$$\nThis leads to the final derived expression for the E-value in terms of the query length $m$, the database length $n$, and the bit score $S'$:\n$$E = m n 2^{-S'}$$\nThis completes the first part of the problem.\n\nFor the second part, we must compute the fold-change $\\frac{E_{B}}{E_{A}}$. The problem provides the following values:\nQuery length: $m = 1200$\nBit score: $S' = 65$\nDatabase A length: $n_{A} = 5.0 \\times 10^{7}$\nDatabase B length: $n_{B} = 3.0 \\times 10^{9}$\n\nUsing the derived formula, we can write the E-values for the alignment in each database. The query length $m$ and the bit score $S'$ are constant for both cases.\nFor Database A:\n$$E_{A} = m n_{A} 2^{-S'}$$\nFor Database B:\n$$E_{B} = m n_{B} 2^{-S'}$$\n\nThe fold-change is the ratio of $E_{B}$ to $E_{A}$:\n$$\\frac{E_{B}}{E_{A}} = \\frac{m n_{B} 2^{-S'}}{m n_{A} 2^{-S'}}$$\nThe terms $m$ and $2^{-S'}$ cancel out, demonstrating that for a given query and alignment score, the E-value scales linearly with the database size. The ratio simplifies to:\n$$\\frac{E_{B}}{E_{A}} = \\frac{n_{B}}{n_{A}}$$\nSubstituting the given numerical values for the database lengths:\n$$\\frac{E_{B}}{E_{A}} = \\frac{3.0 \\times 10^{9}}{5.0 \\times 10^{7}}$$\n$$\\frac{E_{B}}{E_{A}} = \\frac{3.0}{5.0} \\times \\frac{10^{9}}{10^{7}} = 0.6 \\times 10^{2} = 60$$\nThe problem requires the final answer to be rounded to four significant figures. Therefore, the value $60$ must be expressed as $60.00$.", "answer": "$$\\boxed{60.00}$$", "id": "4538924"}, {"introduction": "Modern bioinformatics and medical data analytics rarely involve a single sequence search; instead, they often rely on high-throughput pipelines that execute hundreds or thousands of searches. In such scenarios, managing the cumulative risk of random, high-scoring alignments across the entire experiment is essential for drawing robust conclusions. This practice [@problem_id:4538915] explores how to enforce a run-level false positive budget by calculating a uniform E-value cutoff, a direct application of the linearity of expectation that is fundamental to controlling error rates in large-scale analyses.", "problem": "A translational bioinformatics pipeline in medical data analytics executes two high-throughput sequence alignment components in a single run: (i) a set of $N_{1} = 35$ query-versus-database searches using the Basic Local Alignment Search Tool (BLAST), and (ii) a set of $N_{2} = 120$ profile-based searches using Hidden Markov Model (HMM) scoring for domain detection. Every search computes alignment significance using the expected number of random high-scoring alignments (E-value). The team wishes to enforce a run-level false positive budget of at most $B = 5$ expected random hits across the entire run by applying a single uniform per-search E-value cutoff $E^{\\ast}$ across both components.\n\nAssuming searches are calibrated using standard local alignment statistics and can be treated as independent for the purpose of controlling expected counts, derive from first principles the per-search E-value cutoff $E^{\\ast}$ that satisfies the stated budget when applied uniformly to all $N_{1} + N_{2}$ searches in the run. Report the numerical value of $E^{\\ast}$, rounded to four significant figures. No physical units are required.", "solution": "The problem asks for a uniform per-search E-value cutoff, $E^{\\ast}$, that keeps the total expected number of random hits for a run within a specified budget. The core principle is the linearity of expectation.\n\nThe E-value of a search represents the expected number of false positives (random hits) from that search. If a uniform cutoff $E^{\\ast}$ is applied to each search, then the expected number of false positives from each search is $E^{\\ast}$.\n\nThe total number of searches in the run is the sum of the BLAST and HMM searches:\n$$N_{total} = N_{1} + N_{2} = 35 + 120 = 155$$\n\nLet $E_{run}$ be the total expected number of false positives across the entire run. Due to the linearity of expectation, this is the sum of the expected false positives from each individual search:\n$$E_{run} = \\sum_{i=1}^{N_{total}} E^{\\ast} = N_{total} \\times E^{\\ast}$$\n\nThe problem requires this total expected number of false positives to be at most the budget, $B = 5$. To find the least stringent (largest) cutoff that satisfies this, we set $E_{run}$ equal to $B$:\n$$N_{total} \\times E^{\\ast} = B$$\n$$(N_{1} + N_{2}) \\times E^{\\ast} = B$$\n\nSolving for the per-search E-value cutoff, $E^{\\ast}$:\n$$E^{\\ast} = \\frac{B}{N_{1} + N_{2}}$$\n\nSubstituting the given numerical values:\n$$E^{\\ast} = \\frac{5}{35 + 120} = \\frac{5}{155} = \\frac{1}{31}$$\n\nCalculating the decimal value and rounding to four significant figures as required:\n$$E^{\\ast} \\approx 0.03225806... \\approx 0.03226$$", "answer": "$$\\boxed{0.03226}$$", "id": "4538915"}, {"introduction": "The standard statistical models for sequence alignment, such as the Karlin-Altschul framework, rely on an assumption of average background amino acid frequencies. However, many biologically important proteins have biased compositions, such as transmembrane proteins or low-complexity regions. This practice [@problem_id:4538927] demonstrates how such compositional bias can lead to a drastic overestimation of an alignment's significance and reveals the statistical basis for composition-based corrections, a critical feature of modern alignment tools for generating more accurate E-values.", "problem": "A single-query search in the Basic Local Alignment Search Tool (BLAST) is performed for a protein of length $m = 1000$ amino acids against a single subject protein of length $n = 1000$. The query is strongly enriched for the amino acid lysine, with an empirical lysine fraction $p_{K}^{Q} = 0.40$. The subject protein (and the generic background used by BLAST when no composition-based statistics are applied) has typical proteomic lysine content $p_{K}^{D} = p_{K}^{\\text{bg}} = 0.057$. Consider a local high-scoring segment pair consisting of $L = 50$ aligned positions, each of which is a lysine–lysine match. Assume independence of sites and that the aligned positions are generated by a homologous model in which the per-position lysine–lysine pair probability $q_{KK}$ is strictly greater than $p_{K}^{Q} p_{K}^{D}$, but otherwise unspecified.\n\nUnder standard BLAST without composition-based statistics, the unadjusted background for both query and subject uses $p_{K}^{\\text{bg}}$ for lysine; under composition-based statistics, the query background is corrected to $p_{K}^{Q}$ while the subject background remains $p_{K}^{D}$. Using well-tested significance theory for local alignments, define the multiplicative bias factor as the ratio of the expected number of chance alignments (E-value) computed without composition-based statistics to that computed with composition-based statistics, for the described $L$-position lysine–lysine HSP.\n\nCompute this multiplicative bias factor as a single real number and round your answer to three significant figures. No physical units are required in the final answer.", "solution": "The problem requires the calculation of a multiplicative bias factor, defined as the ratio of the E-value computed without composition-based statistics to the E-value computed with them. Let these be $E_{\\text{unadjusted}}$ and $E_{\\text{adjusted}}$, respectively.\n\nThe E-value (expected number of chance alignments with a score greater than or equal to $S$) in BLAST is based on Karlin-Altschul statistics and is given by the formula:\n$$ E = K m' n' \\exp(-\\lambda S) $$\nwhere $S$ is the raw alignment score, $\\lambda$ and $K$ are statistical parameters that depend on the scoring system and background amino acid frequencies, and $m'$ and $n'$ are the effective lengths of the query and subject sequences.\n\nThe bias factor is the ratio:\n$$ \\text{Bias Factor} = \\frac{E_{\\text{unadjusted}}}{E_{\\text{adjusted}}} = \\frac{K_{\\text{unadj}} m'_{\\text{unadj}} n'_{\\text{unadj}} \\exp(-\\lambda_{\\text{unadj}} S_{\\text{unadj}})}{K_{\\text{adj}} m'_{\\text{adj}} n'_{\\text{adj}} \\exp(-\\lambda_{\\text{adj}} S_{\\text{adj}})} $$\n\nThe core of the statistical model resides in the term $\\exp(-\\lambda S)$. The parameters $K$, $m'$, and $n'$ also depend on the background composition, but their variation typically has a much smaller effect on the E-value than the exponential term. The problem concerns the statistical interpretation of a fixed high-scoring pair (HSP). A key insight of compositional adjustment is that the null hypothesis (i.e., the background frequencies) changes. The \"well-tested significance theory\" refers to the log-odds nature of the scores. The term $\\lambda S$ can be expressed as a sum of log-likelihood ratios:\n$$ \\lambda S = \\sum_{k=1}^{L} \\ln\\left(\\frac{q_{i_k j_k}}{p_{i_k} p_{j_k}}\\right) $$\nwhere $L$ is the alignment length, $q_{ij}$ is the target frequency of aligning amino acid $i$ with $j$ (under a model of homology), and $p_i$ and $p_j$ are the background frequencies of the amino acids in the sequences being compared (under the null model of random sequences).\n\nFor the given HSP consisting of $L=50$ lysine-lysine (K-K) matches, the total $\\lambda S$ is:\n$$ \\lambda S = L \\cdot \\ln\\left(\\frac{q_{KK}}{p_K^{\\text{query}} p_K^{\\text{subject}}}\\right) $$\nThe unspecified parameter $q_{KK}$ represents the probability of a K-K pair in a true homologous alignment.\n\nWe now apply this formula to the two scenarios described:\n\n1.  **Unadjusted Case**: The calculation uses a generic background model for both query and subject. The problem states this background frequency for lysine is $p_K^{\\text{bg}}$.\n    $$ p_K^{\\text{query}} = p_K^{\\text{subject}} = p_K^{\\text{bg}} $$\n    The corresponding statistical term is:\n    $$ \\lambda_{\\text{unadj}} S_{\\text{unadj}} = L \\ln\\left(\\frac{q_{KK}}{(p_K^{\\text{bg}})^2}\\right) $$\n\n2.  **Adjusted Case**: Composition-based statistics use the empirically observed frequency for the query, $p_K^Q$, and the database/subject frequency, $p_K^D$.\n    $$ p_K^{\\text{query}} = p_K^Q, \\quad p_K^{\\text{subject}} = p_K^D $$\n    The corresponding statistical term is:\n    $$ \\lambda_{\\text{adj}} S_{\\text{adj}} = L \\ln\\left(\\frac{q_{KK}}{p_K^Q p_K^D}\\right) $$\n\nAssuming the pre-exponential factors approximately cancel ($K_{\\text{unadj}} m'_{\\text{unadj}} n'_{\\text{unadj}} \\approx K_{\\text{adj}} m'_{\\text{adj}} n'_{\\text{adj}}$), the bias factor is dominated by the ratio of the exponential terms:\n$$ \\text{Bias Factor} \\approx \\frac{\\exp(-\\lambda_{\\text{unadj}} S_{\\text{unadj}})}{\\exp(-\\lambda_{\\text{adj}} S_{\\text{adj}})} = \\exp(\\lambda_{\\text{adj}} S_{\\text{adj}} - \\lambda_{\\text{unadj}} S_{\\text{unadj}}) $$\n\nSubstituting the expressions for $\\lambda S$:\n$$ \\lambda_{\\text{adj}} S_{\\text{adj}} - \\lambda_{\\text{unadj}} S_{\\text{unadj}} = L \\ln\\left(\\frac{q_{KK}}{p_K^Q p_K^D}\\right) - L \\ln\\left(\\frac{q_{KK}}{(p_K^{\\text{bg}})^2}\\right) $$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ = L \\left[ \\ln\\left(\\frac{q_{KK}}{p_K^Q p_K^D}\\right) - \\ln\\left(\\frac{q_{KK}}{(p_K^{\\text{bg}})^2}\\right) \\right] = L \\ln\\left( \\frac{q_{KK}/(p_K^Q p_K^D)}{q_{KK}/(p_K^{\\text{bg}})^2} \\right) = L \\ln\\left( \\frac{(p_K^{\\text{bg}})^2}{p_K^Q p_K^D} \\right) $$\nThe bias factor is therefore:\n$$ \\text{Bias Factor} = \\exp\\left(L \\ln\\left( \\frac{(p_K^{\\text{bg}})^2}{p_K^Q p_K^D} \\right)\\right) = \\left( \\frac{(p_K^{\\text{bg}})^2}{p_K^Q p_K^D} \\right)^L $$\nThis final expression for the bias factor elegantly depends only on the background frequencies and the alignment length, while the unknown target frequency $q_{KK}$ has cancelled out.\n\nWe are given the following values:\n-   Empirical lysine fraction in query: $p_K^Q = 0.40$\n-   Lysine fraction in subject/background: $p_K^D = p_K^{\\text{bg}} = 0.057$\n-   HSP length: $L = 50$\n\nSubstituting $p_K^D = p_K^{\\text{bg}}$ into the formula simplifies it:\n$$ \\text{Bias Factor} = \\left( \\frac{(p_K^{\\text{bg}})^2}{p_K^Q p_K^{\\text{bg}}} \\right)^L = \\left( \\frac{p_K^{\\text{bg}}}{p_K^Q} \\right)^L $$\nNow, we insert the numerical values:\n$$ \\text{Bias Factor} = \\left( \\frac{0.057}{0.40} \\right)^{50} = (0.1425)^{50} $$\nCalculating this value:\n$$ (0.1425)^{50} \\approx 4.889500... \\times 10^{-43} $$\nRounding to three significant figures, as requested, we get $4.89 \\times 10^{-43}$. This extremely small factor indicates that the unadjusted E-value is a vast underestimate of the more accurate, compositionally adjusted E-value, meaning the significance of the match is grossly overestimated without compositional correction.", "answer": "$$\\boxed{4.89 \\times 10^{-43}}$$", "id": "4538927"}]}