{"hands_on_practices": [{"introduction": "Position Weight Matrices (PWMs) provide a detailed, probabilistic view of a sequence motif. However, for visualization or database indexing, we often simplify them into a single consensus or degenerate sequence. This exercise asks you to perform such a simplification and, critically, to quantify the information lost in the process using the Kullback-Leibler divergence. Mastering this allows you to make informed decisions about model representation and the trade-offs between complexity and accuracy. [@problem_id:4576688]", "problem": "A transcription factor binding motif is summarized by a Position Weight Matrix (PWM), where each column is a categorical probability distribution over the four deoxyribonucleotide bases. Let the PWM for a length-$5$ motif be specified by the per-position probabilities $\\{p_i(A), p_i(C), p_i(G), p_i(T)\\}$ as follows:\n- Position $1$: $p_1(A)=0.7$, $p_1(C)=0.3$, $p_1(G)=0$, $p_1(T)=0$.\n- Position $2$: $p_2(A)=0.4$, $p_2(C)=0.6$, $p_2(G)=0$, $p_2(T)=0$.\n- Position $3$: $p_3(A)=0$, $p_3(C)=0.5$, $p_3(G)=0.5$, $p_3(T)=0$.\n- Position $4$: $p_4(A)=0.1$, $p_4(C)=0.1$, $p_4(G)=0.8$, $p_4(T)=0$.\n- Position $5$: $p_5(A)=0.25$, $p_5(C)=0$, $p_5(G)=0.25$, $p_5(T)=0.5$.\n\nDefine the consensus base at position $i$ as $c_i=\\arg\\max_{a\\in\\{A,C,G,T\\}} p_i(a)$, with ties broken by choosing the lexicographically smallest base. Using a probability threshold $\\tau=0.1$, map each position to an International Union of Pure and Applied Chemistry (IUPAC) degenerate code by forming the allowed set $S_i=\\{a\\in\\{A,C,G,T\\}: p_i(a)\\ge \\tau\\}$ and selecting the IUPAC letter that encodes exactly the bases in $S_i$. For the purpose of quantifying information, approximate the degenerate-code representation as an independent product distribution $q=\\prod_{i=1}^{5} q_i$ with $q_i(a)=\\frac{1}{|S_i|}$ for $a\\in S_i$ and $q_i(a)=0$ for $a\\notin S_i$.\n\nStarting from the core definitions of categorical distributions and Kullback–Leibler divergence (KLD), quantify the information lost when compressing the PWM into the degenerate-code distribution by computing the total divergence\n$$L=\\sum_{i=1}^{5} D\\!\\left(p_i \\,\\|\\, q_i\\right),$$\nwhere\n$$D\\!\\left(p_i \\,\\|\\, q_i\\right)=\\sum_{a\\in\\{A,C,G,T\\}} p_i(a)\\,\\log_{2}\\!\\left(\\frac{p_i(a)}{q_i(a)}\\right),$$\nwith the convention that terms with $p_i(a)=0$ contribute $0$. Round your final numerical value of $L$ to four significant figures. Express the final result in bits.", "solution": "The problem requires the calculation of the total information loss, quantified by the Kullback–Leibler divergence (KLD), when a positional weight matrix (PWM) model $p$ is approximated by a degenerate-code distribution $q$. The total divergence $L$ is the sum of the per-position divergences:\n$$L = \\sum_{i=1}^{5} D(p_i \\,\\|\\, q_i)$$\nwhere $p_i$ is the original probability distribution at position $i$, and $q_i$ is the approximate uniform distribution over a set of allowed bases $S_i$. The KLD for each position is defined as:\n$$D(p_i \\,\\|\\, q_i) = \\sum_{a \\in \\{\\text{A,C,G,T}\\}} p_i(a) \\log_{2}\\left(\\frac{p_i(a)}{q_i(a)}\\right)$$\nThe convention $0 \\log_{2}(0/q) = 0$ is used for terms where $p_i(a)=0$.\n\nThe approximate distribution $q_i$ is defined based on the allowed set $S_i = \\{a \\in \\{\\text{A,C,G,T}\\} : p_i(a) \\ge \\tau\\}$, with the threshold $\\tau=0.1$. The distribution $q_i$ is uniform over this set: $q_i(a) = \\frac{1}{|S_i|}$ if $a \\in S_i$, and $q_i(a)=0$ otherwise.\n\nWe can simplify the KLD expression. For $a \\notin S_i$, $q_i(a)=0$. The formula for KLD is only well-defined if the support of $p_i$ is a subset of the support of $q_i$. In our case, for any base $a$ where $p_i(a)  0$, it is also true that $p_i(a) \\ge 0.1$, so $a \\in S_i$. Thus, the summation can be restricted to $a \\in S_i$.\n\\begin{align*} D(p_i \\,\\|\\, q_i) = \\sum_{a \\in S_i} p_i(a) \\log_{2}\\left(\\frac{p_i(a)}{1/|S_i|}\\right) \\\\ = \\sum_{a \\in S_i} p_i(a) \\left( \\log_{2}(p_i(a)) - \\log_{2}\\left(\\frac{1}{|S_i|}\\right) \\right) \\\\ = \\sum_{a \\in S_i} p_i(a) \\log_{2}(p_i(a)) + \\sum_{a \\in S_i} p_i(a) \\log_{2}(|S_i|) \\\\ = \\sum_{a \\in S_i} p_i(a) \\log_{2}(p_i(a)) + \\log_{2}(|S_i|) \\sum_{a \\in S_i} p_i(a)\\end{align*}\nSince the support of each distribution $p_i$ is fully contained within the corresponding set $S_i$, we have $\\sum_{a \\in S_i} p_i(a) = 1$. The expression simplifies to:\n$$ D(p_i \\,\\|\\, q_i) = \\log_{2}(|S_i|) + \\sum_{a \\in \\{\\text{A,C,G,T}\\}} p_i(a) \\log_{2}(p_i(a)) $$\nRecognizing the Shannon entropy $H(p_i) = -\\sum_{a} p_i(a) \\log_{2}(p_i(a))$, the divergence is:\n$$ D(p_i \\,\\|\\, q_i) = \\log_{2}(|S_i|) - H(p_i) $$\nWe will now compute this value for each position $i=1, \\dots, 5$.\n\n**Position 1:**\n- Probabilities: $p_1(A)=0.7$, $p_1(C)=0.3$, $p_1(G)=0$, $p_1(T)=0$.\n- Allowed set with $\\tau=0.1$: $S_1 = \\{A, C\\}$ because $p_1(A) \\ge 0.1$ and $p_1(C) \\ge 0.1$.\n- Size of allowed set: $|S_1|=2$.\n- Shannon entropy: $H(p_1) = -(0.7 \\log_{2}(0.7) + 0.3 \\log_{2}(0.3)) \\approx 0.88129 \\text{ bits}$.\n- Divergence: $D(p_1 \\,\\|\\, q_1) = \\log_{2}(2) - H(p_1) = 1 - 0.88129 = 0.11871 \\text{ bits}$.\n\n**Position 2:**\n- Probabilities: $p_2(A)=0.4$, $p_2(C)=0.6$, $p_2(G)=0$, $p_2(T)=0$.\n- Allowed set: $S_2 = \\{A, C\\}$.\n- Size: $|S_2|=2$.\n- Shannon entropy: $H(p_2) = -(0.4 \\log_{2}(0.4) + 0.6 \\log_{2}(0.6)) \\approx 0.97095 \\text{ bits}$.\n- Divergence: $D(p_2 \\,\\|\\, q_2) = \\log_{2}(2) - H(p_2) = 1 - 0.97095 = 0.02905 \\text{ bits}$.\n\n**Position 3:**\n- Probabilities: $p_3(A)=0$, $p_3(C)=0.5$, $p_3(G)=0.5$, $p_3(T)=0$.\n- Allowed set: $S_3 = \\{C, G\\}$.\n- Size: $|S_3|=2$.\n- Shannon entropy: $H(p_3) = -(0.5 \\log_{2}(0.5) + 0.5 \\log_{2}(0.5)) = -(0.5 \\times (-1) + 0.5 \\times (-1)) = 1 \\text{ bit}$.\n- Divergence: $D(p_3 \\,\\|\\, q_3) = \\log_{2}(2) - H(p_3) = 1 - 1 = 0 \\text{ bits}$. This is expected, as $p_3$ is already uniform over $S_3$, so $p_3=q_3$.\n\n**Position 4:**\n- Probabilities: $p_4(A)=0.1$, $p_4(C)=0.1$, $p_4(G)=0.8$, $p_4(T)=0$.\n- Allowed set: $S_4 = \\{A, C, G\\}$ because $p_4(A)$, $p_4(C)$, and $p_4(G)$ are all $\\ge 0.1$.\n- Size: $|S_4|=3$.\n- Shannon entropy: $H(p_4) = -(0.1 \\log_{2}(0.1) + 0.1 \\log_{2}(0.1) + 0.8 \\log_{2}(0.8)) \\approx 0.92193 \\text{ bits}$.\n- Divergence: $D(p_4 \\,\\|\\, q_4) = \\log_{2}(3) - H(p_4) \\approx 1.58496 - 0.92193 = 0.66303 \\text{ bits}$.\n\n**Position 5:**\n- Probabilities: $p_5(A)=0.25$, $p_5(C)=0$, $p_5(G)=0.25$, $p_5(T)=0.5$.\n- Allowed set: $S_5 = \\{A, G, T\\}$.\n- Size: $|S_5|=3$.\n- Shannon entropy: $H(p_5) = -(0.25 \\log_{2}(0.25) + 0.25 \\log_{2}(0.25) + 0.5 \\log_{2}(0.5)) = -(2 \\times 0.25 \\times (-2) + 0.5 \\times (-1)) = 1.5 \\text{ bits}$.\n- Divergence: $D(p_5 \\,\\|\\, q_5) = \\log_{2}(3) - H(p_5) \\approx 1.58496 - 1.5 = 0.08496 \\text{ bits}$.\n\nFinally, the total information loss $L$ is the sum of the individual divergences:\n$$L = D(p_1 \\,\\|\\, q_1) + D(p_2 \\,\\|\\, q_2) + D(p_3 \\,\\|\\, q_3) + D(p_4 \\,\\|\\, q_4) + D(p_5 \\,\\|\\, q_5)$$\n$$L \\approx 0.11871 + 0.02905 + 0 + 0.66303 + 0.08496$$\n$$L \\approx 0.89575 \\text{ bits}$$\nRounding the result to four significant figures gives $0.8958$.", "answer": "$$\\boxed{0.8958}$$", "id": "4576688"}, {"introduction": "A key application of a PWM is to scan entire genomes to find potential regulatory sites, which involves scoring millions of potential sequences and creating a massive multiple hypothesis testing problem. This exercise walks you through the fundamental process of adjusting for these multiple tests by calculating a genome-wide $p$-value using a Bonferroni-like correction. This is an essential step in assessing the statistical significance of any genome-wide discovery. [@problem_id:4576676]", "problem": "A transcription factor binding site model is represented by a Position Weight Matrix (PWM), defined as follows. For a window of length $k$ in a deoxyribonucleic acid (DNA) sequence, the log-likelihood ratio score $S$ is computed by summing position-specific contributions $w_{i}(b_{i})$ for bases $b_{i} \\in \\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$ and positions $i \\in \\{1,\\dots,k\\}$, where $w_{i}(b_{i}) = \\ln\\left(\\frac{p_{i}(b_{i})}{q(b_{i})}\\right)$, $p_{i}(b)$ is the motif position-specific probability, and $q(b)$ is the background probability of base $b$ under the null model. Under a null model of genomic background evolution, the per-position tail probability of exceeding a threshold score $s^{\\star}$ is defined as $p_{0} = \\mathbb{P}_{0}(S \\ge s^{\\star})$. Suppose dynamic programming under a first-order Markov background yields $p_{0} = 4.12 \\times 10^{-8}$ for a PWM of length $k = 12$ at score threshold $s^{\\star}$.\n\nYou scan a double-stranded bacterial genome of length $G = 3.0 \\times 10^{6}$ base pairs for motif occurrences by sliding the PWM along every possible window on both the forward strand and the reverse complement strand. Assume the genome is linear, the scoring at each position uses the PWM as above, and any dependencies between overlapping windows do not invalidate a union-bound-based correction. Also assume that self-reverse-complement palindromic $k$-mers are negligible in frequency for $k = 12$ under the null and may be ignored in counting distinct trials.\n\nStarting from fundamental definitions of $k$-mer enumeration and the union bound for multiple testing, derive why scanning both strands approximately doubles the number of trials compared to a single-strand scan, and then compute the Bonferroni-like adjusted $p$-value for observing at least one window with score $\\ge s^{\\star}$ anywhere in the genome when scanning both strands.\n\nState clearly the total number of trials you consider and then provide the adjusted $p$-value as a single number. Round your final numerical answer to four significant figures. Express the final answer as a pure number (no units).", "solution": "The user has provided a problem statement to be validated and, if valid, solved.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   Model type: Position Weight Matrix (PWM) for a transcription factor binding site.\n-   Window length: $k = 12$.\n-   Alphabet: Bases $b_{i} \\in \\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$.\n-   Position index: $i \\in \\{1, \\dots, k\\}$.\n-   Score for a window: $S = \\sum_{i=1}^{k} w_{i}(b_{i})$.\n-   Score contribution at position $i$ for base $b_i$: $w_{i}(b_{i}) = \\ln\\left(\\frac{p_{i}(b_{i})}{q(b_{i})}\\right)$.\n-   $p_{i}(b)$: Motif position-specific probability of base $b$ at position $i$.\n-   $q(b)$: Background probability of base $b$.\n-   Per-position tail probability under the null model: $p_{0} = \\mathbb{P}_{0}(S \\ge s^{\\star}) = 4.12 \\times 10^{-8}$.\n-   Genome length: $G = 3.0 \\times 10^{6}$ base pairs.\n-   Scanning procedure: Slide the PWM along every possible window on both the forward strand and the reverse complement strand of a linear, double-stranded genome.\n-   Assumption 1: Dependencies between overlapping windows do not invalidate a union-bound-based correction.\n-   Assumption 2: Self-reverse-complement palindromic $k$-mers are negligible in frequency and may be ignored in counting distinct trials.\n-   Required output 1: A derivation for why scanning both strands approximately doubles the number of trials.\n-   Required output 2: The total number of trials considered.\n-   Required output 3: The Bonferroni-like adjusted $p$-value for observing at least one window with score $\\ge s^{\\star}$.\n-   Rounding: Final numerical answer to be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is firmly rooted in standard bioinformatics principles. PWMs, log-likelihood scores, genome scanning, reverse complements, and multiple testing correction (Bonferroni/union bound) are all fundamental concepts in sequence analysis. The given values for genome size, motif length, and p-value are realistic.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary data and explicit assumptions (linear genome, ignoring palindromes, validity of union bound for overlaps) that remove ambiguity and lead to a unique, derivable solution.\n-   **Objective**: The language is clear, precise, and objective, using standard scientific terminology.\n-   **Flaw Check**: The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, consistent, realistic, and well-structured.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A full solution will be provided.\n\n**Solution Derivation**\n\nThe problem asks for two main derivations: the total number of trials (statistical tests) and the adjusted $p$-value for the entire genome scan.\n\n**1. Derivation and Calculation of the Total Number of Trials**\n\nFirst, let's determine the number of trials for a single, linear DNA strand of length $G$. A trial consists of scoring one window of length $k$. A window of length $k$ (a $k$-mer) can start at any position $i$ from $1$ up to the last position that allows a full $k$-mer to be formed. The last possible starting position is $G - k + 1$, which corresponds to the window spanning bases from $G-k+1$ to $G$. Therefore, the number of distinct windows, and thus the number of trials, on a single strand is:\n$$N_{single} = G - k + 1$$\n\nThe problem specifies scanning a double-stranded genome, which includes the forward strand and its reverse complement.\n-   The forward strand has length $G$. The number of trials on the forward strand is $N_{forward} = G - k + 1$.\n-   The reverse complement strand also has a length of $G$. To scan it, we read its sequence and apply the PWM. The number of $k$-length windows is also $N_{reverse} = G - k + 1$.\n\nTo find the total number of trials, $N_{trials}$, we must sum the trials from both strands. However, we must consider if any trials are redundant. A trial on a forward-strand window is distinct from a trial on the corresponding reverse-complement window unless the sequence itself is a self-reverse-complement palindrome (e.g., the $6$-mer `GTATAC` has the reverse complement `GTATAC`). In such a palindromic case, scanning the forward strand window and the reverse complement window would constitute testing the exact same sequence, leading to redundant tests.\n\nThe problem explicitly addresses this by stating: \"assume that self-reverse-complement palindromic $k$-mers are negligible in frequency for $k=12$ under the null and may be ignored in counting distinct trials.\" This assumption directs us to treat the set of windows on the forward strand and the set of windows on the reverse complement strand as disjoint.\n\nThus, the total number of distinct trials is the sum of the trials on each strand:\n$$N_{trials} = N_{forward} + N_{reverse} = (G - k + 1) + (G - k + 1) = 2(G - k + 1)$$\n\nThis derivation explains why scanning both strands doubles the number of trials compared to a single-strand scan, $N_{trials} = 2 \\times N_{single}$. The use of \"approximately\" in the problem prompt is justified because in practice, for a large genome, $G \\gg k$, which means $G - k + 1 \\approx G$. Therefore, $N_{trials} \\approx 2G$, which is double the single-strand approximation of $N_{single} \\approx G$.\n\nNow, we calculate the exact total number of trials using the given values $G = 3.0 \\times 10^{6}$ and $k = 12$:\n$$N_{trials} = 2(3.0 \\times 10^{6} - 12 + 1) = 2(3,000,000 - 11) = 2(2,999,989)$$\n$$N_{trials} = 5,999,978$$\nThe total number of trials is $5,999,978$.\n\n**2. Derivation and Calculation of the Adjusted p-value**\n\nWe are performing $N_{trials} = 5,999,978$ hypothesis tests, one for each window. The null hypothesis for each test is that the sequence in the window is generated by the background model. The probability of a single test yielding a score $S \\ge s^{\\star}$ under the null hypothesis is given as $p_{0} = 4.12 \\times 10^{-8}$.\n\nWe need to find the \"Bonferroni-like adjusted $p$-value for observing at least one window with score $\\ge s^{\\star}$ anywhere in the genome\". This is the family-wise error rate (FWER), which is the probability of making one or more Type I errors (false positives) across all tests. Let $E_j$ be the event that the $j$-th window has a score $S_j \\ge s^{\\star}$. The FWER is $\\mathbb{P}(\\cup_{j=1}^{N_{trials}} E_j)$.\n\nThe problem directs us to use a \"union-bound-based correction\". The union bound, also known as Boole's inequality, states that for any set of events $E_1, E_2, \\dots, E_N$:\n$$\\mathbb{P}\\left(\\bigcup_{j=1}^{N} E_j\\right) \\le \\sum_{j=1}^{N} \\mathbb{P}(E_j)$$\nThis inequality holds regardless of any dependencies between the events. The problem's assumption that \"dependencies between overlapping windows do not invalidate a union-bound-based correction\" is a direct instruction to apply this bound.\n\nUsing the union bound, we can approximate the probability of at least one hit in the genome, which we denote $p_{adj}$, as an upper bound:\n$$p_{adj} \\approx \\mathbb{P}\\left(\\bigcup_{j=1}^{N_{trials}} E_j\\right) \\le \\sum_{j=1}^{N_{trials}} \\mathbb{P}(E_j)$$\nSince $\\mathbb{P}(E_j) = p_0$ for all $j$, the sum becomes:\n$$p_{adj} \\le N_{trials} \\cdot p_0$$\nThis product, $N_{trials} \\cdot p_0$, is the standard Bonferroni correction for the FWER. This is the quantity the problem asks for.\n\nWe now substitute the numerical values:\n-   $N_{trials} = 5,999,978$\n-   $p_0 = 4.12 \\times 10^{-8}$\n\n$$p_{adj} = 5,999,978 \\times (4.12 \\times 10^{-8})$$\n$$p_{adj} = 0.2471990936$$\n\nThe problem requires the final numerical answer to be rounded to four significant figures.\n$$p_{adj} \\approx 0.2472$$", "answer": "$$\n\\boxed{0.2472}\n$$", "id": "4576676"}, {"introduction": "While powerful, exhaustively scanning a genome with a PWM is computationally intensive. This practice introduces minimizers, a clever and widely-used $k$-mer sampling scheme designed to reduce the search space without sacrificing too much sensitivity. You will derive the expected sampling density and analyze the fundamental trade-off between computational speed and the recall of true binding sites, a core challenge in modern algorithm design for genomics. [@problem_id:4576693]", "problem": "Consider a long deoxyribonucleic acid (DNA) sequence and a fixed integer $k \\geq 1$. A $k$-mer is defined as any length-$k$ contiguous substring. A minimizer scheme for sparse $k$-mer sampling operates as follows: assign to each $k$-mer a hash value via a hash function $h$ that maps $k$-mers to independent and identically distributed continuous random variables on $[0,1]$; for each sliding window of $w$ consecutive $k$-mers (with $w \\geq 2$), select as the window's representative the position of the $k$-mer with smallest hash in the window, breaking ties by the leftmost position. This yields a subset of positions called minimizers.\n\nYou will analyze the expected density of minimizers and the trade-offs in accuracy versus speed for motif scanning using a Position Weight Matrix (PWM).\n\nStarting from fundamental definitions of independent and identically distributed continuous random variables and basic order statistics, and without invoking pre-derived results about minimizers, do the following:\n\n- Derive the expected fraction $d(w)$ of all $k$-mer positions that are selected as minimizers under the above assumptions for a long random sequence, in the asymptotic regime where the number of $k$-mers is much larger than $w$.\n\n- Consider scanning for a transcription factor binding site with a Position Weight Matrix (PWM) of length $L$ (number of nucleotides), where a PWM evaluation at the true motif start returns a true positive with probability $q \\in (0,1)$ and false positives can be neglected for this analysis. Suppose that instead of scanning every possible start position, you only evaluate the PWM at positions flagged by the minimizer scheme. For a single true motif occurrence of length $L$, model the event of capturing it as the event that at least one of its overlapping $k$-mers (there are $m = L - k + 1$ such $k$-mers when $L \\geq k$) is selected as a minimizer, and assume independence among these $m$ selection indicators. Derive the expected recall $\\mathcal{R}(w)$ as a function of $w$, $L$, $k$, and $q$.\n\n- Quantify the speed improvement factor $\\mathcal{S}(w)$, defined as the ratio of the number of PWM evaluations required by exhaustive scanning to that required by minimizer-based scanning, under the assumption that computational cost is dominated by PWM evaluations and each evaluation has equal cost. Express $\\mathcal{S}(w)$ in terms of $d(w)$ in the asymptotic regime $n \\gg L,k$, where $n$ is the length (in nucleotides) of the sequence.\n\n- Now set $k=15$, $L=21$, and $q=0.92$. Impose the constraint that the expected recall must be at least $\\rho_{\\min} = 0.85$. Among all integers $w \\geq 2$ satisfying $\\mathcal{R}(w) \\geq \\rho_{\\min}$, choose the largest such $w$ to maximize speed, and report this integer value. No rounding is needed; provide the exact integer.", "solution": "The problem is well-posed, scientifically grounded in established concepts of bioinformatics (k-mer statistics, minimizers, Position Weight Matrices), and provides a self-contained set of definitions and assumptions. All variables are clearly defined, and the questions posed are mathematically tractable under the given framework. The problem is therefore deemed valid and a full solution follows.\n\nThe problem is divided into four parts, which will be addressed sequentially.\n\n**Part 1: Derivation of the minimizer density $d(w)$**\n\nWe are asked to derive the expected fraction, $d(w)$, of $k$-mer positions that are selected as minimizers. The problem states that the hash function $h$ maps $k$-mers to independent and identically distributed (i.i.d.) continuous random variables on the interval $[0,1]$.\n\nLet us consider a very long sequence of $k$-mers, indexed by their starting positions $i=1, 2, 3, \\ldots$. Let $H_i = h(k_i)$ be the hash value of the $k$-mer at position $i$. The sequence of hashes $\\{H_i\\}$ is a sequence of i.i.d. continuous random variables. Due to the continuous distribution, the probability of a tie between any two hash values is zero, so we can neglect ties.\n\nThe density of minimizers, $d(w)$, in the asymptotic limit of a long sequence, can be interpreted as the probability that a minimizer is newly selected when the window of size $w$ slides one position to the right.\n\nConsider two adjacent windows of $k$-mers: $W_j = \\{k_j, k_{j+1}, \\dots, k_{j+w-1}\\}$ and $W_{j+1} = \\{k_{j+1}, k_{j+2}, \\dots, k_{j+w}\\}$. A new minimizer is chosen by the scheme if the position of the minimum hash value in window $W_{j+1}$ is different from the position of the minimum hash value in window $W_j$. Let us analyze the probability of this event.\n\nThe set of all $k$-mers involved in these two adjacent windows is $\\{k_j, k_{j+1}, \\dots, k_{j+w}\\}$. This set contains $w+1$ $k$-mers. Let their corresponding hash values be $\\{H_j, H_{j+1}, \\dots, H_{j+w}\\}$. Since these are $w+1$ i.i.d. continuous random variables, any one of them is equally likely to be the minimum of the entire set. The probability that any specific $H_i$ is the minimum of this set is $\\frac{1}{w+1}$.\n\nLet us analyze when the position of the minimizer changes:\n1.  If $H_j$ is the minimum among all $w+1$ hashes $\\{H_j, \\dots, H_{j+w}\\}$, then the minimizer in window $W_j$ must be at position $j$. The window $W_{j+1}$ does not contain position $j$, so its minimizer must be at a different position. Thus, the minimizer position changes. The probability of this event is $\\frac{1}{w+1}$.\n2.  If $H_{j+w}$ is the minimum among all $w+1$ hashes, then the minimizer in window $W_{j+1}$ is at position $j+w$. The minimizer in window $W_j$ must be at some position in $\\{j, \\dots, j+w-1\\}$, which is different from $j+w$. Thus, the minimizer position changes. The probability of this event is also $\\frac{1}{w+1}$.\n3.  If the minimum among all $w+1$ hashes is $H_i$ for some $i \\in \\{j+1, \\dots, j+w-1\\}$, then $H_i$ is the minimum value in both window $W_j$ (since $H_i  H_j$) and window $W_{j+1}$ (since $H_i  H_{j+w}$). In this case, the minimizer for both windows is at the same position $i$. The position does not change. The probability of this is the sum of probabilities for each of the $w-1$ possible positions, which is $\\frac{w-1}{w+1}$.\n\nThe probability that the minimizer position changes when the window slides is the sum of the probabilities of the first two mutually exclusive cases. This probability is the density of minimizers.\n$$d(w) = P(\\text{position changes}) = \\frac{1}{w+1} + \\frac{1}{w+1} = \\frac{2}{w+1}$$\n\n**Part 2: Derivation of the expected recall $\\mathcal{R}(w)$**\n\nThe expected recall, $\\mathcal{R}(w)$, is the probability that a true motif is successfully detected. Detection is a two-step process: the minimizer scheme must first \"capture\" the motif, and then the PWM evaluation must yield a true positive.\n\nA true motif of length $L$ contains $m = L-k+1$ overlapping $k$-mers. The problem defines \"capture\" as the event that at least one of these $m$ $k$-mers is selected as a minimizer. The probability that any given $k$-mer is a minimizer is $d(w) = \\frac{2}{w+1}$.\n\nThe problem instructs us to assume that the selection events for the $m$ distinct $k$-mers overlapping the motif are independent. Let $p_{min} = d(w)$ be the probability that a single $k$-mer is a minimizer. The probability that a single $k$-mer is *not* a minimizer is $1-p_{min}$.\n\nThe probability of capture, $P(\\text{capture})$, is the probability that at least one of the $m$ $k$-mers is a minimizer. It is simpler to calculate the complement: the probability that none of the $m$ $k$-mers are minimizers.\n$$P(\\text{capture}) = 1 - P(\\text{none of the } m \\text{ k-mers are minimizers})$$\nDue to the independence assumption:\n$$P(\\text{capture}) = 1 - (P(\\text{a single k-mer is not a minimizer}))^m = 1 - (1 - p_{min})^m$$\nSubstituting $p_{min} = d(w) = \\frac{2}{w+1}$:\n$$P(\\text{capture}) = 1 - \\left(1 - \\frac{2}{w+1}\\right)^m = 1 - \\left(\\frac{w+1-2}{w+1}\\right)^m = 1 - \\left(\\frac{w-1}{w+1}\\right)^m$$\nIf the motif is captured, a PWM evaluation is performed. We assume this process allows for the evaluation at the true motif start, which results in a true positive with probability $q$. The overall probability of detection, or recall $\\mathcal{R}(w)$, is the product of the probability of capture and the probability of a successful PWM test.\n$$\\mathcal{R}(w) = q \\times P(\\text{capture}) = q \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^m \\right]$$\nSubstituting $m=L-k+1$:\n$$\\mathcal{R}(w) = q \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^{L-k+1} \\right]$$\n\n**Part 3: Derivation of the speed improvement factor $\\mathcal{S}(w)$**\n\nThe speed improvement factor $\\mathcal{S}(w)$ is the ratio of the number of PWM evaluations in an exhaustive scan to the number of evaluations in a minimizer-based scan.\n\nLet the total length of the DNA sequence be $n$ nucleotides.\nFor an exhaustive scan, a PWM of length $L$ is evaluated at every possible start position. The number of such positions is $n - L + 1$. In the asymptotic regime where $n \\gg L$, the number of evaluations is approximately $n$.\n$$N_{\\text{exhaustive}} \\approx n$$\nFor a minimizer-based scan, the PWM is evaluated only at positions flagged as minimizers. The number of $k$-mers in a sequence of length $n$ is $n-k+1 \\approx n$ for $n \\gg k$. The expected fraction of these $k$-mer positions that are selected as minimizers is $d(w)$. Thus, the expected number of PWM evaluations is:\n$$N_{\\text{minimizer}} \\approx n \\cdot d(w)$$\nThe speed improvement factor is the ratio:\n$$\\mathcal{S}(w) = \\frac{N_{\\text{exhaustive}}}{N_{\\text{minimizer}}} \\approx \\frac{n}{n \\cdot d(w)} = \\frac{1}{d(w)}$$\nSubstituting the expression for $d(w)$:\n$$\\mathcal{S}(w) = \\frac{1}{\\frac{2}{w+1}} = \\frac{w+1}{2}$$\n\n**Part 4: Calculation of the optimal window size $w$**\n\nWe are given the specific parameters: $k=15$, $L=21$, and $q=0.92$. The required minimum expected recall is $\\rho_{\\min} = 0.85$. We must find the largest integer $w \\geq 2$ that satisfies $\\mathcal{R}(w) \\geq \\rho_{\\min}$. Maximizing $w$ maximizes the speed improvement $\\mathcal{S}(w) = \\frac{w+1}{2}$.\n\nFirst, we calculate the number of $k$-mers, $m$, overlapping the motif:\n$$m = L - k + 1 = 21 - 15 + 1 = 7$$\nThe recall constraint is:\n$$\\mathcal{R}(w) = 0.92 \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^7 \\right] \\geq 0.85$$\nThe term $\\frac{w-1}{w+1} = 1 - \\frac{2}{w+1}$ is a monotonically increasing function of $w$ for $w \\geq 2$. Consequently, $\\left(\\frac{w-1}{w+1}\\right)^7$ is also increasing, $1-\\left(\\frac{w-1}{w+1}\\right)^7$ is decreasing, and therefore $\\mathcal{R}(w)$ is a monotonically decreasing function of $w$.\n\nTo find the largest integer $w$ satisfying the inequality, we first solve for the boundary case where equality holds:\n$$0.92 \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^7 \\right] = 0.85$$\n$$1 - \\left(\\frac{w-1}{w+1}\\right)^7 = \\frac{0.85}{0.92} = \\frac{85}{92}$$\n$$\\left(\\frac{w-1}{w+1}\\right)^7 = 1 - \\frac{85}{92} = \\frac{7}{92}$$\n$$\\frac{w-1}{w+1} = \\left(\\frac{7}{92}\\right)^{1/7}$$\nLet $C = \\left(\\frac{7}{92}\\right)^{1/7}$. We solve for $w$:\n$$w-1 = C(w+1)$$\n$$w-1 = Cw + C$$\n$$w - Cw = 1 + C$$\n$$w(1-C) = 1+C$$\n$$w = \\frac{1+C}{1-C}$$\nSince $\\mathcal{R}(w)$ is a decreasing function, the inequality $\\mathcal{R}(w) \\geq 0.85$ holds for all $w$ such that:\n$$w \\leq \\frac{1+C}{1-C}$$\nWe need to evaluate this expression.\n$C = \\left(\\frac{7}{92}\\right)^{1/7} \\approx (0.076087)^{1/7} \\approx 0.69213$.\n$$w \\leq \\frac{1+0.69213}{1-0.69213} = \\frac{1.69213}{0.30787} \\approx 5.496$$\nThe problem asks for the largest integer $w \\geq 2$ that satisfies this condition. The set of integers satisfying $w \\leq 5.496$ is $\\{..., 3, 4, 5\\}$. The largest integer in this set that is also $\\geq 2$ is $5$.\n\nTo verify, let's check $w=5$ and $w=6$:\nFor $w=5$:\n$\\mathcal{R}(5) = 0.92 \\left[ 1 - \\left(\\frac{5-1}{5+1}\\right)^7 \\right] = 0.92 \\left[ 1 - \\left(\\frac{4}{6}\\right)^7 \\right] = 0.92 \\left[ 1 - \\left(\\frac{2}{3}\\right)^7 \\right] = 0.92 \\left[ 1 - \\frac{128}{2187} \\right] = 0.92 \\left[ \\frac{2059}{2187} \\right] \\approx 0.866 \\geq 0.85$.\nThe condition is satisfied.\n\nFor $w=6$:\n$\\mathcal{R}(6) = 0.92 \\left[ 1 - \\left(\\frac{6-1}{6+1}\\right)^7 \\right] = 0.92 \\left[ 1 - \\left(\\frac{5}{7}\\right)^7 \\right] = 0.92 \\left[ 1 - \\frac{78125}{823543} \\right] = 0.92 \\left[ \\frac{745418}{823543} \\right] \\approx 0.833  0.85$.\nThe condition is not satisfied.\n\nThus, the largest integer $w$ that meets the recall requirement is $5$.", "answer": "$$\\boxed{5}$$", "id": "4576693"}]}