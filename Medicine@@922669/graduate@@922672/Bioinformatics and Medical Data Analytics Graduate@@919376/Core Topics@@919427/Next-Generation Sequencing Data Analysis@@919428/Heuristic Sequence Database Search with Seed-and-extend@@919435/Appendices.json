{"hands_on_practices": [{"introduction": "Before we can extend an alignment, we must first find a \"seed.\" But how long should this seed be? This exercise delves into the statistical heart of the seed-and-extend strategy. By deriving the expected number of random seed hits, you will understand how to choose a seed length $k$ that is selective enough to filter out noise while remaining sensitive enough to find true homologies [@problem_id:4571633].", "problem": "In seed-and-extend heuristics used in sequence database search such as the Basic Local Alignment Search Tool (BLAST), an initial filter scans a database by looking for exact matches between contiguous seeds of length $k$ derived from a query sequence and windows of length $k$ in the database. Consider a nucleotide query sequence of length $L$ over a four-symbol alphabet $\\Sigma$ with $|\\Sigma|=4$, and a database consisting of independent and identically distributed sequences with equiprobable characters. Assume a contiguous exact seed model and that both the query and database are independent.\n\nStarting from first principles of probability (Bernoulli trials), independence assumptions for uniformly random sequences, and linearity of expectation, derive an expression for the expected number of random seed hits $E(k)$ when scanning all contiguous length-$k$ seeds in the query against all contiguous length-$k$ windows in a database of total length $N$. Then, impose the design requirement that $E(k)  0.1$ random hits for $L=100$, $N=10^{9}$, and $|\\Sigma|=4$, and choose the smallest integer $k$ that satisfies this requirement. Show the complete derivation and calculation. The final answer must be a single integer. No rounding is required.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Heuristic: Seed-and-extend for sequence database search.\n- Filter mechanism: Exact matches between contiguous seeds of length $k$.\n- Query sequence length: $L$.\n- Alphabet: $\\Sigma$, a nucleotide alphabet.\n- Alphabet size: $|\\Sigma|=4$.\n- Database properties: Composed of independent and identically distributed (i.i.d.) sequences with equiprobable characters. Total length is $N$.\n- Model: Contiguous exact seed model.\n- Independence assumption: Query and database are independent.\n- Task 1: Derive an expression for the expected number of random seed hits, $E(k)$.\n- Task 2: Impose the design requirement $E(k)  0.1$.\n- Specific parameters: $L=100$, $N=10^{9}$.\n- Task 3: Find the smallest integer $k$ that satisfies the requirement.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is firmly rooted in the statistical foundations of bioinformatics algorithms, specifically the widely used BLAST heuristic. The model of random sequences and the calculation of expected hits are standard, fundamental concepts in the field.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary parameters ($L$, $N$, $|\\Sigma|$) and a clear objective (derive $E(k)$ and find the minimal integer $k$ for a given threshold). The assumptions of i.i.d. and equiprobable characters create a formalizable probabilistic model that admits a unique solution.\n- **Objectivity**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard and well-defined problem in computational biology. A complete, reasoned solution will be provided.\n\n**Derivation of the Expected Number of Hits $E(k)$**\n\nOur goal is to derive the expected number of times a contiguous seed of length $k$ from the query sequence appears exactly in the database. We will use the principle of linearity of expectation.\n\nLet the query sequence have length $L$ and the database have total length $N$.\nThe number of possible contiguous seeds of length $k$ in the query is $L - k + 1$.\nThe number of possible contiguous windows of length $k$ in the database is $N - k + 1$.\n\nLet's define an indicator random variable $X_{ij}$ for a comparison between the $i$-th seed of the query (starting at position $i$) and the $j$-th window of the database (starting at position $j$).\n$X_{ij} = 1$ if the $i$-th query seed matches the $j$-th database window.\n$X_{ij} = 0$ otherwise.\nThe indices range from $i=1, \\dots, L-k+1$ and $j=1, \\dots, N-k+1$.\n\nThe total number of hits, $H$, is the sum of these indicator variables over all possible pairs of query seeds and database windows:\n$$H = \\sum_{i=1}^{L-k+1} \\sum_{j=1}^{N-k+1} X_{ij}$$\n\nBy the linearity of expectation, the expected total number of hits $E(k) = E[H]$ is:\n$$E(k) = E\\left[\\sum_{i=1}^{L-k+1} \\sum_{j=1}^{N-k+1} X_{ij}\\right] = \\sum_{i=1}^{L-k+1} \\sum_{j=1}^{N-k+1} E[X_{ij}]$$\n\nThe expectation of an indicator variable is the probability of the event it indicates: $E[X_{ij}] = P(X_{ij} = 1)$. This is the probability of a specific $k$-mer seed from the query matching a specific $k$-mer window from the database.\n\nA match occurs if all $k$ characters align perfectly. Let $p_m$ be the probability of a match at a single position. The probability of a $k$-mer match is $p_m^k$, assuming independence between character positions.\n\nThe problem states the database characters are i.i.d. and equiprobable over an alphabet of size $|\\Sigma|=4$. Let the alphabet be $\\{\\text{A, C, G, T}\\}$. The probability of any specific character appearing at any position in the database is $P(\\text{db\\_char}) = \\frac{1}{|\\Sigma|} = \\frac{1}{4}$.\nThe problem describes the search context for \"uniformly random sequences,\" which implies the statistical properties of the query can be modeled identically for the purpose of calculating random background hits. Therefore, the probability of any specific character at any position in the query is also $P(\\text{query\\_char}) = \\frac{1}{4}$.\n\nThe probability of a match at a single position, $p_m$, is the probability that the query character and the database character are the same. Since the query and database are independent, this is:\n$$p_m = \\sum_{c \\in \\Sigma} P(\\text{query\\_char}=c \\text{ and } \\text{db\\_char}=c)$$\n$$p_m = \\sum_{c \\in \\Sigma} P(\\text{query\\_char}=c) \\cdot P(\\text{db\\_char}=c) = \\sum_{i=1}^{4} \\left(\\frac{1}{4} \\cdot \\frac{1}{4}\\right) = 4 \\cdot \\frac{1}{16} = \\frac{1}{4}$$\n\nTherefore, the probability of a specific query seed of length $k$ matching a specific database window of length $k$ is:\n$$P(X_{ij} = 1) = (p_m)^k = \\left(\\frac{1}{4}\\right)^k = 4^{-k}$$\nSince this probability is the same for all pairs $(i, j)$, we can substitute it back into the expression for $E(k)$:\n$$E(k) = \\sum_{i=1}^{L-k+1} \\sum_{j=1}^{N-k+1} 4^{-k}$$\nThe sum is over $(L-k+1)(N-k+1)$ identical terms.\n$$E(k) = (L-k+1)(N-k+1)4^{-k}$$\nThis is the derived expression for the expected number of random seed hits.\n\nFor typical applications, $k$ is much smaller than both $L$ and $N$. Thus, we can use the accurate approximation $L-k+1 \\approx L$ and $N-k+1 \\approx N$.\n$$E(k) \\approx L \\cdot N \\cdot 4^{-k}$$\n\n**Calculating the Smallest Integer $k$**\n\nWe are given the design requirement $E(k)  0.1$ with parameters $L=100$, $N=10^9$, and $|\\Sigma|=4$.\nUsing the approximate formula for $E(k)$:\n$$100 \\cdot 10^9 \\cdot 4^{-k}  0.1$$\n$$10^2 \\cdot 10^9 \\cdot 4^{-k}  10^{-1}$$\n$$10^{11} \\cdot 4^{-k}  10^{-1}$$\nTo solve for $k$, we rearrange the inequality:\n$$10^{11}  10^{-1} \\cdot 4^k$$\n$$10^{12}  4^k$$\n\nTo find $k$, we take the base-$10$ logarithm of both sides:\n$$\\log_{10}(10^{12})  \\log_{10}(4^k)$$\n$$12  k \\cdot \\log_{10}(4)$$\n$$k  \\frac{12}{\\log_{10}(4)}$$\n\nWe know that $\\log_{10}(4) = \\log_{10}(2^2) = 2 \\log_{10}(2)$. The value of $\\log_{10}(2)$ is approximately $0.30103$.\n$$k  \\frac{12}{2 \\log_{10}(2)} = \\frac{6}{\\log_{10}(2)}$$\n$$k  \\frac{6}{0.30103} \\approx 19.9315$$\n\nSince $k$ must be an integer, the smallest integer value for $k$ that satisfies this condition is $20$.\n\nLet's verify this result by checking the values for $k=19$ and $k=20$ with our approximation.\nFor $k=19$:\n$E(19) \\approx 10^{11} \\cdot 4^{-19} = \\frac{10^{11}}{274877906944} \\approx \\frac{10^{11}}{2.75 \\times 10^{11}} \\approx 0.364$, which is not less than $0.1$.\nFor $k=20$:\n$E(20) \\approx 10^{11} \\cdot 4^{-20} = \\frac{10^{11}}{1099511627776} \\approx \\frac{10^{11}}{1.10 \\times 10^{12}} \\approx 0.091$, which is less than $0.1$.\n\nThe calculation confirms that the smallest integer seed length $k$ is $20$. The use of the approximation $E(k) \\approx L \\cdot N \\cdot 4^{-k}$ is justified as the correction factors $(L-k+1)/L$ and $(N-k+1)/N$ are very close to $1$ and do not alter the final integer result.\nFor $k=20$, $L-k+1 = 100-20+1 = 81$. The exact expectation is $E(20) = (81)(10^9-19)4^{-20} \\approx 81 \\cdot 10^9 \\cdot (1.10 \\times 10^{12})^{-1} \\approx 0.0737$, which is also less than $0.1$.\nFor $k=19$, $L-k+1=100-19+1 = 82$. The exact expectation is $E(19) = (82)(10^9-18)4^{-19} \\approx 82 \\cdot 10^9 \\cdot (2.75 \\times 10^{11})^{-1} \\approx 0.298$, which is not less than $0.1$.\nThe smallest integer $k$ is therefore confirmed to be $20$.", "answer": "$$\\boxed{20}$$", "id": "4571633"}, {"introduction": "Once an initial seed match is found, the next step is to extend it into a high-scoring segment pair (HSP). This exercise provides a concrete, step-by-step simulation of the ungapped extension process, a core component of the original BLAST algorithm. You will apply the X-drop rule, a crucial heuristic that prevents the extension from continuing indefinitely into low-quality regions, giving you a practical feel for how HSPs are defined and scored [@problem_id:4571668].", "problem": "Consider an ungapped seed-and-extend heuristic for sequence database search as used in Basic Local Alignment Search Tool (BLAST), where extension proceeds from an exact matching seed without introducing gaps and stops according to the \"X-drop\" rule. Let the query sequence be Q = TTGCAACGTAATACGTTGCA and the database sequence be D = GACAAACGTAAGTACGTTCA, both indexed starting at position $1$. You are given that there is an exact seed of length $k=4$ starting at positions $(i,j)=(7,7)$, so that $Q[7..10]=D[7..10]$. Use the following well-tested foundations of seed-and-extend scoring:\n- Define the ungapped pairwise alignment score as the sum of position-wise scores $s(x,y)$ over aligned positions, where $s(x,y)=+1$ if nucleotides $x$ and $y$ match and $s(x,y)=-2$ if they mismatch.\n- The seed contributes its exact-match score, and extension proceeds one position at a time to the left and to the right of the seed. For each direction, maintain a running extension score and a best-so-far score for that direction. The X-drop stopping rule with parameter $X=3$ is applied separately on each side: extension in a given direction stops when the running extension score falls more than $X$ below the best-so-far score on that side. The boundary for the high-scoring segment pair (HSP) is taken at the positions achieving the best-so-far score in each direction.\n\nStarting from the seed at $(i,j)=(7,7)$ with $k=4$, compute the total HSP score obtained after applying ungapped seed-and-extend with the above scoring and the X-drop parameter $X=3$. Express your final answer as a single integer. No rounding is required, and no units are to be reported.", "solution": "The user wants to compute the total score of a High-scoring Segment Pair (HSP) generated by an ungapped seed-and-extend heuristic, given a query sequence, a database sequence, a seed, a scoring scheme, and an X-drop stopping rule.\n\nThe problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\nThe givens are:\n- Query Sequence $Q = \\text{TTGCAACGTAATACGTTGCA}$\n- Database Sequence $D = \\text{GACAAACGTAAGTACGTTCA}$\n- Both sequences are $1$-indexed.\n- A seed of length $k=4$ is identified starting at position $(i,j)=(7,7)$, corresponding to $Q[7..10]$ and $D[7..10]$. Let's verify: $Q[7..10]=\\text{CGTA}$ and $D[7..10]=\\text{CGTA}$. This is indeed an exact match.\n- Scoring scheme: match score $s_{match} = +1$, mismatch score $s_{mismatch} = -2$.\n- Stopping rule: X-drop with parameter $X=3$. Extension in a direction stops when the running score for that extension falls more than $X$ below the maximum score achieved so far for that same extension.\n\nThe problem is a standard application of the BLAST seed-and-extend algorithm. All parameters are provided, the premises are factually correct within the context of the model, and the process is deterministic. The problem is therefore valid.\n\nThe total HSP score is the sum of the seed's score and the best scores from the leftward and rightward extensions.\n\n**1. Seed Score**\nThe seed is an exact match of length $k=4$. The score for each match is $+1$.\nThe score of the seed, $S_{seed}$, is:\n$$S_{seed} = 4 \\times s_{match} = 4 \\times (+1) = 4$$\n\n**2. Rightward Extension**\nExtension proceeds from the end of the seed, i.e., from position $(i,j)=(11,11)$. We maintain a running score, $S_{run,R}$, and a best score, $S_{best,R}$, for this extension, both initialized to $0$. The extension stops if $S_{run,R}  S_{best,R} - X$, where $X=3$.\n\n| Step | Query pos. $i$ | DB pos. $j$ | $Q[i]$ vs $D[j]$ | Pair score $s$ | $S_{run,R}$ | $S_{best,R}$ | Stop Condition: $S_{run,R}  S_{best,R} - 3$ |\n| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |\n| start | - | - | - | - | $0$ | $0$ | - |\n| $1$ | $11$ | $11$ | A vs A (Match) | $+1$ | $0+1=1$ | $\\max(0,1)=1$ | $1 \\not 1 - 3$, continue |\n| $2$ | $12$ | $12$ | T vs G (Mismatch) | $-2$ | $1-2=-1$ | $\\max(1,-1)=1$ | $-1 \\not 1 - 3$, continue |\n| $3$ | $13$ | $13$ | A vs T (Mismatch) | $-2$ | $-1-2=-3$ | $\\max(1,-3)=1$ | $-3  1 - 3 \\implies -3  -2$, **STOP** |\n\nThe maximum score achieved during the rightward extension is $S_{best,R} = 1$. The HSP boundary on the right is the position where this best score was achieved, which is at $(i,j)=(11,11)$.\n\n**3. Leftward Extension**\nExtension proceeds from the beginning of the seed, i.e., from position $(i,j)=(6,6)$ backwards. We maintain a running score, $S_{run,L}$, and a best score, $S_{best,L}$, for this extension, both initialized to $0$. The extension stops if $S_{run,L}  S_{best,L} - X$.\n\n| Step | Query pos. $i$ | DB pos. $j$ | $Q[i]$ vs $D[j]$ | Pair score $s$ | $S_{run,L}$ | $S_{best,L}$ | Stop Condition: $S_{run,L}  S_{best,L} - 3$ |\n| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |\n| start | - | - | - | - | $0$ | $0$ | - |\n| $1$ | $6$ | $6$ | A vs A (Match) | $+1$ | $0+1=1$ | $\\max(0,1)=1$ | $1 \\not 1-3$, continue |\n| $2$ | $5$ | $5$ | A vs A (Match) | $+1$ | $1+1=2$ | $\\max(1,2)=2$ | $2 \\not 2-3$, continue |\n| $3$ | $4$ | $4$ | C vs A (Mismatch) | $-2$ | $2-2=0$ | $\\max(2,0)=2$ | $0 \\not 2-3$, continue |\n| $4$ | $3$ | $3$ | G vs C (Mismatch) | $-2$ | $0-2=-2$ | $\\max(2,-2)=2$ | $-2 \\not 2-3$, continue |\n| $5$ | $2$ | $2$ | T vs A (Mismatch) | $-2$ | $-2-2=-4$ | $\\max(2,-4)=2$ | $-4  2-3 \\implies -4  -1$, **STOP** |\n\nThe maximum score achieved during the leftward extension is $S_{best,L} = 2$. The HSP boundary on the left is the position where this best score was achieved, which occurred after the comparison at $(i,j)=(5,5)$.\n\n**4. Total HSP Score**\nThe total score of the HSP is the sum of the seed score and the best scores from both extensions.\n$$S_{HSP} = S_{seed} + S_{best,L} + S_{best,R}$$\nSubstituting the calculated values:\n$$S_{HSP} = 4 + 2 + 1 = 7$$\n\nAlternatively, we can determine the full HSP and score it directly. The HSP extends from the left boundary at $(i,j)=(5,5)$ to the right boundary at $(i,j)=(11,11)$. The aligned segment is $Q[5..11]$ versus $D[5..11]$.\n- $Q[5..11] = \\text{AACGTAA}$\n- $D[5..11] = \\text{AACGTAA}$\nThe alignment is a perfect match of length $7$.\nThe score is $7 \\times s_{match} = 7 \\times (+1) = 7$.\nBoth methods yield the same result. The total HSP score is $7$.", "answer": "$$\\boxed{7}$$", "id": "4571668"}, {"introduction": "Real-world homologous sequences often contain insertions and deletions, causing a single alignment to be initially detected as a set of multiple, non-contiguous seed hits. This advanced exercise introduces the dynamic programming technique used to \"chain\" these disparate seeds into a single, optimal, gapped alignment. You will learn to score chains by balancing the weights of the seeds against the penalties for the gaps between them, a method that approximates a full gapped alignment at a fraction of the computational cost [@problem_id:4571661].", "problem": "A sequence database search using a seed-and-extend heuristic produces a set of ungapped seed hits (anchors) between a query and a subject on the plus strand. In this framework, a High-Scoring Segment Pair (HSP) is approximated by an optimal colinear chain of such seeds that maximizes a concave score composed of seed weights minus inter-seed gap penalties. This choice is grounded in the use of concave penalties to approximate affine gap costs and to regularize long-range chaining consistent with empirical rates of insertions and deletions. Consider the following seeds, each specified by query start coordinate $a_i$, subject start coordinate $b_i$, seed length $l_i$, and seed weight $w_i$:\n- Seed $1$: $(a_1,b_1,l_1,w_1) = (3, 5, 4, 7.5)$\n- Seed $2$: $(a_2,b_2,l_2,w_2) = (9, 12, 3, 6.2)$\n- Seed $3$: $(a_3,b_3,l_3,w_3) = (13, 17, 5, 9.1)$\n- Seed $4$: $(a_4,b_4,l_4,w_4) = (16, 19, 2, 3.6)$\n- Seed $5$: $(a_5,b_5,l_5,w_5) = (20, 26, 4, 8.4)$\n- Seed $6$: $(a_6,b_6,l_6,w_6) = (24, 30, 3, 5.8)$\n\nA valid chain is a subsequence of seeds with strictly increasing indices $i_1i_2\\cdotsi_m$ such that for each consecutive pair $(i_j,i_{j+1})$ both of the following hold: $a_{i_j}+l_{i_j} \\le a_{i_{j+1}}$ and $b_{i_j}+l_{i_j} \\le b_{i_{j+1}}$. The chain score is defined as the sum of seed weights minus a gap penalty between each consecutive seed pair. For a consecutive pair $(i,j)$ in the chain, let $\\Delta q_{ij} = a_j - (a_i + l_i)$ and $\\Delta s_{ij} = b_j - (b_i + l_i)$. The gap penalty is\n$$\nP(\\Delta q_{ij}, \\Delta s_{ij}) \\;=\\; \\mu\\,|\\Delta q_{ij}-\\Delta s_{ij}| \\;+\\; \\nu\\,\\ln\\!\\big(1+\\Delta q_{ij}+\\Delta s_{ij}\\big),\n$$\nwith natural logarithm $\\ln$, penalty parameters $\\mu=1.0$ and $\\nu=2.0$. There is no cost to start or end a chain, corresponding to local chaining.\n\nFrom first principles of heuristic seed chaining in sequence alignment, determine the optimal chain and compute its HSP score as the maximum possible chain score under the rules above. Report only the resulting HSP score as a unitless real number, rounded to four significant figures.", "solution": "The problem asks for the optimal score of a colinear chain of seeds, which is a classic dynamic programming problem in bioinformatics. We must find the highest-scoring path in a conceptual directed acyclic graph (DAG), where the seeds are the nodes and a directed edge exists from seed $i$ to seed $j$ if $ij$ and seed $j$ can legally follow seed $i$.\n\nFirst, we restate the given data and definitions in a formal context.\nThere are $N=6$ seeds, indexed $i=1, \\dots, 6$. Each seed $i$ is defined by a tuple $(a_i, b_i, l_i, w_i)$, representing query start, subject start, length, and weight, respectively.\n- Seed $1$: $(a_1,b_1,l_1,w_1) = (3, 5, 4, 7.5)$\n- Seed $2$: $(a_2,b_2,l_2,w_2) = (9, 12, 3, 6.2)$\n- Seed $3$: $(a_3,b_3,l_3,w_3) = (13, 17, 5, 9.1)$\n- Seed $4$: $(a_4,b_4,l_4,w_4) = (16, 19, 2, 3.6)$\n- Seed $5$: $(a_5,b_5,l_5,w_5) = (20, 26, 4, 8.4)$\n- Seed $6$: $(a_6,b_6,l_6,w_6) = (24, 30, 3, 5.8)$\n\nA chain is a subsequence of seeds with strictly increasing indices. A legal link from seed $i$ to seed $j$ (where $ij$) requires that the seeds do not overlap:\n$a_i+l_i \\le a_j$\n$b_i+l_i \\le b_j$\n\nThe gap penalty for a link from seed $i$ to seed $j$ is a function of the gap lengths on the query and subject sequences, $\\Delta q_{ij} = a_j - (a_i + l_i)$ and $\\Delta s_{ij} = b_j - (b_i + l_i)$. The penalty function is:\n$$ P(\\Delta q_{ij}, \\Delta s_{ij}) = \\mu |\\Delta q_{ij} - \\Delta s_{ij}| + \\nu \\ln(1 + \\Delta q_{ij} + \\Delta s_{ij}) $$\nwith parameters $\\mu=1.0$ and $\\nu=2.0$.\n\nThe total score of a chain $(i_1, i_2, \\dots, i_m)$ is the sum of seed weights minus the sum of inter-seed penalties:\n$$ \\text{Score} = \\sum_{k=1}^{m} w_{i_k} - \\sum_{k=1}^{m-1} P(\\Delta q_{i_k i_{k+1}}, \\Delta s_{i_k i_{k+1}}) $$\nThis is a \"local\" chaining problem, meaning a chain can start and end at any seed. The optimal score is the maximum score over all possible valid chains.\n\nLet $S_i$ be the score of the optimal chain ending at seed $i$. We can compute $S_i$ for $i=1, \\dots, 6$ using the following dynamic programming recurrence relation:\n$$ S_i = w_i + \\max\\left( 0, \\max_{ji, \\text{ link } j\\to i \\text{ is valid}} \\{ S_j - P(i,j) \\} \\right) $$\nThe use of $\\max(0, \\dots)$ allows a chain to start at seed $i$ with score $w_i$ if extending any prior chain results in a net negative contribution. The final answer, the HSP score, will be the maximum value among all $S_i$.\n\nWe proceed to calculate $S_i$ for each seed. For clarity, let the end coordinates of seed $i$ be $a'_i = a_i+l_i$ and $b'_i = b_i+l_i$.\n- Seed $1$: $(a'_1, b'_1) = (7, 9)$\n- Seed $2$: $(a'_2, b'_2) = (12, 15)$\n- Seed $3$: $(a'_3, b'_3) = (18, 22)$\n- Seed $4$: $(a'_4, b'_4) = (18, 21)$\n- Seed $5$: $(a'_5, b'_5) = (24, 30)$\n- Seed $6$: $(a'_6, b'_6) = (27, 33)$\n\n**Step 1: Compute $S_1$**\nNo predecessors exist. The chain starts with seed $1$.\n$S_1 = w_1 = 7.5$.\n\n**Step 2: Compute $S_2$**\nCandidate predecessor: seed $1$.\n- Link $1 \\to 2$: Valid, since $a'_1=7 \\le a_2=9$ and $b'_1=9 \\le b_2=12$.\n  $\\Delta q_{12} = a_2 - a'_1 = 9-7=2$.\n  $\\Delta s_{12} = b_2 - b'_1 = 12-9=3$.\n  $P(1,2) = 1.0 \\times |2-3| + 2.0 \\times \\ln(1+2+3) = 1 + 2\\ln(6) \\approx 4.5835$.\n  $S_1 - P(1,2) = 7.5 - 4.5835 = 2.9165$.\n$S_2 = w_2 + \\max(0, 2.9165) = 6.2 + 2.9165 = 9.1165$.\n\n**Step 3: Compute $S_3$**\nCandidate predecessors: seeds $1, 2$.\n- Link $1 \\to 3$: Valid ($7 \\le 13, 9 \\le 17$).\n  $\\Delta q_{13} = 13-7=6$. $\\Delta s_{13} = 17-9=8$.\n  $P(1,3) = 1.0 \\times |6-8| + 2.0 \\times \\ln(1+6+8) = 2 + 2\\ln(15) \\approx 7.4161$.\n  $S_1 - P(1,3) = 7.5 - 7.4161 = 0.0839$.\n- Link $2 \\to 3$: Valid ($12 \\le 13, 15 \\le 17$).\n  $\\Delta q_{23} = 13-12=1$. $\\Delta s_{23} = 17-15=2$.\n  $P(2,3) = 1.0 \\times |1-2| + 2.0 \\times \\ln(1+1+2) = 1 + 2\\ln(4) \\approx 3.7726$.\n  $S_2 - P(2,3) = 9.1165 - 3.7726 = 5.3439$.\n$S_3 = w_3 + \\max(0, 0.0839, 5.3439) = 9.1 + 5.3439 = 14.4439$.\n\n**Step 4: Compute $S_4$**\nCandidate predecessors: seeds $1, 2, 3$.\n- Link $1 \\to 4$: Valid ($7 \\le 16, 9 \\le 19$).\n  $\\Delta q_{14} = 16-7=9$. $\\Delta s_{14} = 19-9=10$.\n  $P(1,4) = 1.0 \\times |9-10| + 2.0 \\times \\ln(1+9+10) = 1 + 2\\ln(20) \\approx 6.9915$.\n  $S_1 - P(1,4) = 7.5 - 6.9915 = 0.5085$.\n- Link $2 \\to 4$: Valid ($12 \\le 16, 15 \\le 19$).\n  $\\Delta q_{24} = 16-12=4$. $\\Delta s_{24} = 19-15=4$.\n  $P(2,4) = 1.0 \\times |4-4| + 2.0 \\times \\ln(1+4+4) = 0 + 2\\ln(9) \\approx 4.3944$.\n  $S_2 - P(2,4) = 9.1165 - 4.3944 = 4.7221$.\n- Link $3 \\to 4$: Invalid, since $a'_3=18 \\not\\le a_4=16$.\n$S_4 = w_4 + \\max(0, 0.5085, 4.7221) = 3.6 + 4.7221 = 8.3221$.\n\n**Step 5: Compute $S_5$**\nCandidate predecessors: seeds $1, 2, 3, 4$.\n- Link $1 \\to 5$: Valid ($7 \\le 20, 9 \\le 26$). Contribution: $S_1 - P(1,5) = 7.5 - (4+2\\ln(31)) \\approx 7.5 - 10.8680 = -3.3680$.\n- Link $2 \\to 5$: Valid ($12 \\le 20, 15 \\le 26$). Contribution: $S_2 - P(2,5) = 9.1165 - (3+2\\ln(20)) \\approx 9.1165 - 8.9915 = 0.1250$.\n- Link $3 \\to 5$: Valid ($18 \\le 20, 22 \\le 26$).\n  $\\Delta q_{35} = 20-18=2$. $\\Delta s_{35} = 26-22=4$.\n  $P(3,5) = 1.0 \\times |2-4| + 2.0 \\times \\ln(1+2+4) = 2 + 2\\ln(7) \\approx 5.8918$.\n  $S_3 - P(3,5) = 14.4439 - 5.8918 = 8.5521$.\n- Link $4 \\to 5$: Valid ($18 \\le 20, 21 \\le 26$).\n  $\\Delta q_{45} = 20-18=2$. $\\Delta s_{45} = 26-21=5$.\n  $P(4,5) = 1.0 \\times |2-5| + 2.0 \\times \\ln(1+2+5) = 3 + 2\\ln(8) \\approx 7.1589$.\n  $S_4 - P(4,5) = 8.3221 - 7.1589 = 1.1632$.\n$S_5 = w_5 + \\max(0, -3.3680, 0.1250, 8.5521, 1.1632) = 8.4 + 8.5521 = 16.9521$.\n\n**Step 6: Compute $S_6$**\nCandidate predecessors: seeds $1, 2, 3, 4, 5$.\n- Link $1 \\to 6$: Valid ($7 \\le 24, 9 \\le 30$). Contribution: $S_1 - P(1,6) = 7.5 - (4+2\\ln(39)) \\approx 7.5 - 11.3271 = -3.8271$.\n- Link $2 \\to 6$: Valid ($12 \\le 24, 15 \\le 30$). Contribution: $S_2 - P(2,6) = 9.1165 - (3+2\\ln(28)) \\approx 9.1165 - 9.6644 = -0.5479$.\n- Link $3 \\to 6$: Valid ($18 \\le 24, 22 \\le 30$). Contribution: $S_3 - P(3,6) = 14.4439 - (2+2\\ln(15)) \\approx 14.4439 - 7.4161 = 7.0278$.\n- Link $4 \\to 6$: Valid ($18 \\le 24, 21 \\le 30$). Contribution: $S_4 - P(4,6) = 8.3221 - (3+2\\ln(16)) \\approx 8.3221 - 8.5452 = -0.2231$.\n- Link $5 \\to 6$: Valid ($24 \\le 24, 30 \\le 30$).\n  $\\Delta q_{56} = 24-24=0$. $\\Delta s_{56} = 30-30=0$.\n  $P(5,6) = 1.0 \\times |0-0| + 2.0 \\times \\ln(1+0+0) = 0$.\n  $S_5 - P(5,6) = 16.9521 - 0 = 16.9521$.\n$S_6 = w_6 + \\max(-3.8271, -0.5479, 7.0278, -0.2231, 16.9521) = 5.8 + 16.9521 = 22.7521$.\n\n**Step 7: Determine the Optimal HSP Score**\nThe optimal HSP score is the maximum score among all possible chains, which is the maximum value in the set $\\{S_1, S_2, S_3, S_4, S_5, S_6\\}$.\nScores: $\\{7.5, 9.1165, 14.4439, 8.3221, 16.9521, 22.7521\\}$.\nThe maximum score is $S_6 = 22.7521$.\n\nThe optimal chain can be found by tracing back from the seed with the maximum score. The predecessor for $S_6$ was seed $5$, for $S_5$ was seed $3$, for $S_3$ was seed $2$, and for $S_2$ was seed $1$. Thus, the optimal chain is $(1, 2, 3, 5, 6)$.\n\nThe problem requests the final HSP score rounded to four significant figures.\nHSP Score = $22.7521 \\dots$\nRounding to four significant figures gives $22.75$.", "answer": "$$\\boxed{22.75}$$", "id": "4571661"}]}