{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with the cornerstone of sequence alignment: the Needleman-Wunsch algorithm for global alignment. This first exercise [@problem_id:4559042] guides you through a manual computation for a small pair of sequences. By constructing the dynamic programming matrix step-by-step from first principles, you will gain a concrete understanding of how optimal substructure allows us to find the highest-scoring alignment across the entire length of two sequences.", "problem": "You are comparing two deoxyribonucleic acid ($\\text{DNA}$) sequences under a global alignment model using Dynamic Programming (DP). Let the first sequence be $x = \\text{ACG}$ and the second sequence be $y = \\text{AG}$. Define the substitution scoring function $s(a,b)$ by $s(a,b)=1$ if $a=b$ and $s(a,b)=-1$ if $a\\neq b$, and let the linear gap penalty be $d=-2$ for any insertion or deletion. Starting from the foundational principle of optimal substructure, in which the optimal global alignment between prefixes of $x$ and $y$ can be decomposed into optimal alignments of smaller prefixes, derive the dynamic programming approach needed to compute the optimal global alignment score. Construct the full dynamic programming matrix over indices $i\\in\\{0,1,2,3\\}$ and $j\\in\\{0,1,2\\}$, justify the boundary conditions from first principles, and perform the complete matrix fill. Then, using a logically consistent traceback argument, produce one optimal global alignment between $x$ and $y$ under the stated scoring scheme. Report the optimal global alignment score as your final numeric answer, expressed as an exact integer with no rounding.", "solution": "This problem requires the computation of the optimal global alignment score for two deoxyribonucleic acid ($\\text{DNA}$) sequences, $x = \\text{ACG}$ and $y = \\text{AG}$, using a dynamic programming approach, specifically the Needleman-Wunsch algorithm. The scoring scheme is defined by a substitution function $s(a,b)$ and a linear gap penalty $d$.\n\nFirst, we formalize the problem. Let the two sequences be $x = x_1x_2...x_m$ and $y = y_1y_2...y_n$, with lengths $m=3$ and $n=2$, respectively. We are given:\n- Sequence $x = \\text{ACG}$\n- Sequence $y = \\text{AG}$\n- Substitution scores: $s(a,b) = 1$ if $a=b$ (match), and $s(a,b) = -1$ if $a \\neq b$ (mismatch).\n- Linear gap penalty: $d = -2$.\n\nThe core of the dynamic programming solution lies in the principle of optimal substructure. We define a matrix $F$ where the entry $F(i,j)$ represents the score of the optimal global alignment between the prefix of $x$ of length $i$ (denoted $x_{1..i}$) and the prefix of $y$ of length $j$ (denoted $y_{1..j}$). The indices $i$ range from $0$ to $m=3$, and $j$ from $0$ to $n=2$.\n\nAn optimal alignment ending at the pair $(x_i, y_j)$ must be formed by extending a previously found optimal alignment of smaller prefixes. There are three possibilities for the final column of the alignment of $x_{1..i}$ and $y_{1..j}$:\n1.  Align $x_i$ with $y_j$. The score is the score of the optimal alignment of $x_{1..i-1}$ and $y_{1..j-1}$ plus the score for substituting $x_i$ with $y_j$. This gives $F(i-1, j-1) + s(x_i, y_j)$.\n2.  Align $x_i$ with a gap. The score is the score of the optimal alignment of $x_{1..i-1}$ and $y_{1..j}$ plus the gap penalty. This gives $F(i-1, j) + d$.\n3.  Align $y_j$ with a gap. The score is the score of the optimal alignment of $x_{1..i}$ and $y_{1..j-1}$ plus the gap penalty. This gives $F(i, j-1) + d$.\n\nThe optimal score $F(i,j)$ is the maximum of these three values. This yields the fundamental recurrence relation:\n$$F(i, j) = \\max \\begin{cases} F(i-1, j-1) + s(x_i, y_j)  \\text{(Align } x_i \\text{ and } y_j\\text{)} \\\\ F(i-1, j) + d  \\text{(Align } x_i \\text{ with a gap)} \\\\ F(i, j-1) + d  \\text{(Align } y_j \\text{ with a gap)} \\end{cases}$$\n\nThe boundary conditions are justified from first principles.\n- $F(0,0)$: The score of aligning two empty strings. There are no operations, so the score is $0$. $F(0,0) = 0$.\n- $F(i,0)$ for $i > 0$: The score of aligning the prefix $x_{1..i}$ with an empty string. This can only be achieved by aligning each of the $i$ characters of $x$ with a gap. The total score is the sum of $i$ gap penalties, so $F(i,0) = i \\times d$.\n- $F(0,j)$ for $j > 0$: The score of aligning an empty string with the prefix $y_{1..j}$. This requires $j$ gaps, so the score is $F(0,j) = j \\times d$.\n\nWith $d=-2$, the boundary conditions are:\n$F(0,0) = 0$\n$F(1,0) = 1 \\times (-2) = -2$\n$F(2,0) = 2 \\times (-2) = -4$\n$F(3,0) = 3 \\times (-2) = -6$\n$F(0,1) = 1 \\times (-2) = -2$\n$F(0,2) = 2 \\times (-2) = -4$\n\nWe now construct and fill the $(3+1) \\times (2+1)$ dynamic programming matrix.\n\n**Matrix Fill Calculation:**\n\n$F(1,1) = \\max(F(0,0) + s(\\text{A},\\text{A}), F(0,1) + d, F(1,0) + d) = \\max(0 + 1, -2 - 2, -2 - 2) = \\max(1, -4, -4) = 1$.\n$F(1,2) = \\max(F(0,1) + s(\\text{A},\\text{G}), F(0,2) + d, F(1,1) + d) = \\max(-2 - 1, -4 - 2, 1 - 2) = \\max(-3, -6, -1) = -1$.\n$F(2,1) = \\max(F(1,0) + s(\\text{C},\\text{A}), F(1,1) + d, F(2,0) + d) = \\max(-2 - 1, 1 - 2, -4 - 2) = \\max(-3, -1, -6) = -1$.\n$F(2,2) = \\max(F(1,1) + s(\\text{C},\\text{G}), F(1,2) + d, F(2,1) + d) = \\max(1 - 1, -1 - 2, -1 - 2) = \\max(0, -3, -3) = 0$.\n$F(3,1) = \\max(F(2,0) + s(\\text{G},\\text{A}), F(2,1) + d, F(3,0) + d) = \\max(-4 - 1, -1 - 2, -6 - 2) = \\max(-5, -3, -8) = -3$.\n$F(3,2) = \\max(F(2,1) + s(\\text{G},\\text{G}), F(2,2) + d, F(3,1) + d) = \\max(-1 + 1, 0 - 2, -3 - 2) = \\max(0, -2, -5) = 0$.\n\nThe complete dynamic programming matrix $F$ is:\n$$\n\\begin{array}{c|c|ccc}\n         \\text{A}  \\text{G} \\\\\n   i/j  0  1  2 \\\\\n\\hline\n   0  0  -2  -4 \\\\\n\\text{A}  1  -2  1  -1 \\\\\n\\text{C}  2  -4  -1  0 \\\\\n\\text{G}  3  -6  -3  0 \\\\\n\\end{array}\n$$\nThe optimal global alignment score is the value in the bottom-right cell of the matrix, $F(3,2)$, which is $0$.\n\nTo find an optimal alignment, we perform a traceback from $F(3,2)$ to $F(0,0)$. There can be multiple optimal paths. One such path is:\n1.  Start at $F(3,2)=0$. This value can be derived from $F(2,1) + s(\\text{G},\\text{G}) = -1 + 1 = 0$. This corresponds to a diagonal move, meaning $\\text{G}$ is aligned with $\\text{G}$. We move to $F(2,1)$.\n2.  At $F(2,1)=-1$. This value was derived from $F(1,1) + d = 1 - 2 = -1$. This corresponds to a move from above (an \"up\" move in the matrix), meaning $\\text{C}$ is aligned with a gap in sequence $y$. We move to $F(1,1)$.\n3.  At $F(1,1)=1$. This value was derived from $F(0,0) + s(\\text{A},\\text{A}) = 0 + 1 = 1$. This corresponds to a diagonal move, meaning $\\text{A}$ is aligned with $\\text{A}$. We move to $F(0,0)$.\n4.  At $F(0,0)$, the traceback terminates.\n\nReconstructing the alignment by reversing the path of the traceback:\n- The move from $F(1,1)$ to $F(0,0)$ gives: $\\text{A}$ aligned with $\\text{A}$.\n- The move from $F(2,1)$ to $F(1,1)$ gives: $\\text{C}$ aligned with a gap ($-$).\n- The move from $F(3,2)$ to $F(2,1)$ gives: $\\text{G}$ aligned with $\\text{G}$.\n\nOne optimal global alignment is therefore:\n$$\n\\begin{align*}\nx': \\quad  \\text{A C G} \\\\\ny': \\quad  \\text{A - G}\n\\end{align*}\n$$\nLet's verify the score of this alignment: $s(\\text{A},\\text{A}) + d + s(\\text{G},\\text{G}) = 1 + (-2) + 1 = 0$. This score matches the computed value $F(3,2)=0$.\n\nThe final requested answer is the optimal global alignment score.", "answer": "$$\\boxed{0}$$", "id": "4559042"}, {"introduction": "While global alignment is useful, many biological tasks, such as finding conserved domains or mapping short sequencing reads, require finding the most similar regions *within* longer sequences. This practice [@problem_id:4559104] introduces the Smith-Waterman algorithm for local alignment. You will see how a simple but powerful modification to the recurrence—allowing the score to reset to zero—enables the identification of the highest-scoring local segment, irrespective of the rest of the sequence.", "problem": "You are analyzing short genomic reads for variant discovery in a medical diagnostics pipeline. In sequence alignment, one seeks to quantify the similarity between two nucleotide sequences under an additive scoring model with linear gap penalties. In local alignment, only a contiguous high-similarity segment is retained, and the dynamic programming score at any position is bounded below by zero so that negative-scoring prefixes are discarded. Consider two DNA sequences $x=\\text{TGTTACGG}$ and $y=\\text{GGTTGACTA}$, with a scoring system defined by $+2$ for a match, $-1$ for a mismatch, and a linear gap penalty of $d=-2$. Starting from the principle of optimal substructure for dynamic programming (DP) and the additive nature of alignment scores under linear gap penalties, first establish the recurrence relation and boundary conditions appropriate for local alignment as formalized by the Smith–Waterman algorithm (SW). Then, compute the resulting dynamic programming matrix for the given $x$ and $y$, and determine the highest achievable local alignment score under the specified scoring system. Express the final score as an integer without any units. No rounding is required.", "solution": "Local alignment seeks the maximum scoring pair of substrings, one from $x$ and one from $y$, evaluated under an additive scoring system with linear gap penalties. The fundamental base consists of the optimal substructure property and the additive decomposition of alignment scores: any optimal alignment ending at positions $(i,j)$ arises from one of three mutually exclusive elementary extensions—diagonal (a character pair), vertical (a gap in $y$), or horizontal (a gap in $x$)—or is discarded if no extension gives a positive contribution. This is consistent with the principle of dynamic programming (DP) and the Smith–Waterman algorithm (SW) for local alignment.\n\nLet $H(i,j)$ denote the optimal local alignment score of substrings that end at $x_{i}$ and $y_{j}$. Let $s(a,b)$ be the pairwise substitution score: $s(a,b)=+2$ if $a=b$ and $s(a,b)=-1$ if $a\\neq b$. Let the gap penalty be $d=-2$. The recurrence follows from optimal substructure:\n$$\nH(i,j)=\\max\\left\\{0,\\; H(i-1,j-1)+s(x_{i},y_{j}),\\; H(i-1,j)+d,\\; H(i,j-1)+d\\right\\}.\n$$\nThe boundary conditions are\n$$\nH(0,j)=0\\quad\\text{for all }j,\\qquad H(i,0)=0\\quad\\text{for all }i,\n$$\nwhich ensure that negative-scoring prefixes are reset to zero and that local alignments may start anywhere.\n\nWe now compute $H(i,j)$ for $x=\\text{TGTTACGG}$ and $y=\\text{GGTTGACTA}$ with $s(\\cdot,\\cdot)$ as above and $d=-2$. Index $x$ as $x_{1}=\\text{T}$, $x_{2}=\\text{G}$, $x_{3}=\\text{T}$, $x_{4}=\\text{T}$, $x_{5}=\\text{A}$, $x_{6}=\\text{C}$, $x_{7}=\\text{G}$, $x_{8}=\\text{G}$; index $y$ as $y_{1}=\\text{G}$, $y_{2}=\\text{G}$, $y_{3}=\\text{T}$, $y_{4}=\\text{T}$, $y_{5}=\\text{G}$, $y_{6}=\\text{A}$, $y_{7}=\\text{C}$, $y_{8}=\\text{T}$, $y_{9}=\\text{A}$.\n\nWe compute $H(i,j)$ row by row using the recurrence. The initial row and column are zeros: $H(0,j)=0$ and $H(i,0)=0$.\n\nFor $i=1$ ($x_{1}=\\text{T}$):\n- $H(1,1)=\\max\\{0,\\,0+s(\\text{T},\\text{G})=-1,\\,0-2=-2,\\,0-2=-2\\}=0$.\n- $H(1,2)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(1,3)=\\max\\{0,\\,0+s(\\text{T},\\text{T})=2,\\,0-2,\\,0-2\\}=2$.\n- $H(1,4)=\\max\\{0,\\,0+2,\\,0-2,\\,2-2\\}=2$.\n- $H(1,5)=\\max\\{0,\\,0-1,\\,0-2,\\,2-2\\}=0$.\n- $H(1,6)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(1,7)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(1,8)=\\max\\{0,\\,0+2,\\,0-2,\\,0-2\\}=2$.\n- $H(1,9)=\\max\\{0,\\,0-1,\\,0-2,\\,2-2\\}=0$.\n\nFor $i=2$ ($x_{2}=\\text{G}$):\n- $H(2,1)=\\max\\{0,\\,0+2,\\,0-2,\\,0-2\\}=2$.\n- $H(2,2)=\\max\\{0,\\,0+2,\\,0-2,\\,2-2\\}=2$.\n- $H(2,3)=\\max\\{0,\\,0-1,\\,2-2,\\,2-2\\}=0$.\n- $H(2,4)=\\max\\{0,\\,2-1,\\,2-2,\\,0-2\\}=1$.\n- $H(2,5)=\\max\\{0,\\,2+2,\\,0-2,\\,1-2\\}=4$.\n- $H(2,6)=\\max\\{0,\\,0-1,\\,4-2,\\,4-2\\}=2$.\n- $H(2,7)=\\max\\{0,\\,0-1,\\,2-2,\\,2-2\\}=0$.\n- $H(2,8)=\\max\\{0,\\,2-1,\\,0-2,\\,0-2\\}=1$.\n- $H(2,9)=\\max\\{0,\\,0-1,\\,0-2,\\,1-2\\}=0$.\n\nFor $i=3$ ($x_{3}=\\text{T}$):\n- $H(3,1)=\\max\\{0,\\,0-1,\\,2-2,\\,0-2\\}=0$.\n- $H(3,2)=\\max\\{0,\\,2-1,\\,2-2,\\,0-2\\}=1$.\n- $H(3,3)=\\max\\{0,\\,2+2,\\,0-2,\\,1-2\\}=4$.\n- $H(3,4)=\\max\\{0,\\,0+2,\\,1-2,\\,4-2\\}=2$.\n- $H(3,5)=\\max\\{0,\\,1-1,\\,4-2,\\,2-2\\}=2$.\n- $H(3,6)=\\max\\{0,\\,4-1,\\,2-2,\\,2-2\\}=3$.\n- $H(3,7)=\\max\\{0,\\,2-1,\\,0-2,\\,3-2\\}=1$.\n- $H(3,8)=\\max\\{0,\\,0+2,\\,1-2,\\,1-2\\}=2$.\n- $H(3,9)=\\max\\{0,\\,1-1,\\,0-2,\\,2-2\\}=0$.\n\nFor $i=4$ ($x_{4}=\\text{T}$):\n- $H(4,1)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(4,2)=\\max\\{0,\\,0-1,\\,1-2,\\,0-2\\}=0$.\n- $H(4,3)=\\max\\{0,\\,1+2,\\,4-2,\\,0-2\\}=3$.\n- $H(4,4)=\\max\\{0,\\,4+2,\\,2-2,\\,3-2\\}=6$.\n- $H(4,5)=\\max\\{0,\\,2-1,\\,2-2,\\,6-2\\}=4$.\n- $H(4,6)=\\max\\{0,\\,2-1,\\,3-2,\\,4-2\\}=2$.\n- $H(4,7)=\\max\\{0,\\,3-1,\\,1-2,\\,2-2\\}=2$.\n- $H(4,8)=\\max\\{0,\\,1+2,\\,2-2,\\,2-2\\}=3$.\n- $H(4,9)=\\max\\{0,\\,2-1,\\,0-2,\\,3-2\\}=1$.\n\nFor $i=5$ ($x_{5}=\\text{A}$):\n- $H(5,1)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(5,2)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(5,3)=\\max\\{0,\\,0-1,\\,3-2,\\,0-2\\}=1$.\n- $H(5,4)=\\max\\{0,\\,3-1,\\,4-2,\\,1-2\\}=2$.\n- $H(5,5)=\\max\\{0,\\,6-1,\\,2-2,\\,2-2\\}=5$.\n- $H(5,6)=\\max\\{0,\\,4+2,\\,2-2,\\,5-2\\}=6$.\n- $H(5,7)=\\max\\{0,\\,2-1,\\,2-2,\\,6-2\\}=4$.\n- $H(5,8)=\\max\\{0,\\,2-1,\\,3-2,\\,4-2\\}=2$.\n- $H(5,9)=\\max\\{0,\\,3+2,\\,1-2,\\,2-2\\}=5$.\n\nFor $i=6$ ($x_{6}=\\text{C}$):\n- $H(6,1)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(6,2)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(6,3)=\\max\\{0,\\,0-1,\\,1-2,\\,0-2\\}=0$.\n- $H(6,4)=\\max\\{0,\\,1-1,\\,2-2,\\,0-2\\}=0$.\n- $H(6,5)=\\max\\{0,\\,2-1,\\,3-2,\\,0-2\\}=1$.\n- $H(6,6)=\\max\\{0,\\,5-1,\\,4-2,\\,1-2\\}=4$.\n- $H(6,7)=\\max\\{0,\\,6+2,\\,2-2,\\,4-2\\}=8$.\n- $H(6,8)=\\max\\{0,\\,4-1,\\,2-2,\\,8-2\\}=6$.\n- $H(6,9)=\\max\\{0,\\,2-1,\\,5-2,\\,6-2\\}=4$.\n\nFor $i=7$ ($x_{7}=\\text{G}$):\n- $H(7,1)=\\max\\{0,\\,0+2,\\,0-2,\\,0-2\\}=2$.\n- $H(7,2)=\\max\\{0,\\,0+2,\\,0-2,\\,2-2\\}=2$.\n- $H(7,3)=\\max\\{0,\\,0-1,\\,0-2,\\,2-2\\}=0$.\n- $H(7,4)=\\max\\{0,\\,0-1,\\,0-2,\\,0-2\\}=0$.\n- $H(7,5)=\\max\\{0,\\,0+2,\\,1-2,\\,0-2\\}=2$.\n- $H(7,6)=\\max\\{0,\\,1-1,\\,2-2,\\,2-2\\}=0$.\n- $H(7,7)=\\max\\{0,\\,4-1,\\,8-2,\\,0-2\\}=6$.\n- $H(7,8)=\\max\\{0,\\,8-1,\\,6-2,\\,6-2\\}=7$.\n- $H(7,9)=\\max\\{0,\\,6-1,\\,4-2,\\,7-2\\}=5$.\n\nFor $i=8$ ($x_{8}=\\text{G}$):\n- $H(8,1)=\\max\\{0,\\,0+2,\\,2-2,\\,0-2\\}=2$.\n- $H(8,2)=\\max\\{0,\\,2+2,\\,2-2,\\,2-2\\}=4$.\n- $H(8,3)=\\max\\{0,\\,2-1,\\,0-2,\\,4-2\\}=2$.\n- $H(8,4)=\\max\\{0,\\,0-1,\\,0-2,\\,2-2\\}=0$.\n- $H(8,5)=\\max\\{0,\\,0+2,\\,2-2,\\,0-2\\}=2$.\n- $H(8,6)=\\max\\{0,\\,0-1,\\,0-2,\\,2-2\\}=0$.\n- $H(8,7)=\\max\\{0,\\,0-1,\\,6-2,\\,0-2\\}=4$.\n- $H(8,8)=\\max\\{0,\\,6-1,\\,7-2,\\,4-2\\}=5$.\n- $H(8,9)=\\max\\{0,\\,7-1,\\,5-2,\\,5-2\\}=6$.\n\nThe global maximum over all $H(i,j)$ is $8$, achieved at $(i,j)=(6,7)$, i.e., ending at $x_{6}=\\text{C}$ and $y_{7}=\\text{C}$. To validate the local segment, we perform a traceback from $(6,7)$ following the choice that attained the maximum:\n- $H(6,7)=8$ arises from the diagonal $H(5,6)+s(\\text{C},\\text{C})=6+2$.\n- $H(5,6)=6$ arises from the diagonal $H(4,5)+s(\\text{A},\\text{A})=4+2$. Wait, `H(5,6)=max(0, H(4,5)+s(A,A), H(4,6)-2, H(5,5)-2) = max(0, 4+2, 2-2, 5-2)=6`. No, `s(A,A)` is `s(x_5, y_6)`. Correct.\n- `H(4,5)=4` arises from the left `H(4,4)+d=6-2`, corresponding to a gap in $x$ aligned against $y_{5}=\\text{G}$.\n- `H(4,4)=6` arises from the diagonal `H(3,3)+s(\\text{T},\\text{T})=4+2`.\n- `H(3,3)=4` arises from the diagonal `H(2,2)+s(\\text{T},\\text{T})=2+2`.\n- `H(2,2)=2` arises from the diagonal `H(1,1)+s(\\text{G},\\text{G})=0+2`.\n- `H(1,1)=0` terminates the local traceback.\n\nThus the optimal local alignment segment corresponds to aligning $x$ substring $x_{2..6}=\\text{GTTAC}$ against $y$ substring $y_{2..7}=\\text{GGTTGA}$ with one gap in $x$ at the position of $y_{5}=\\text{G}$, yielding the alignment\n$$\n\\begin{align*}\n\\text{G T T - A C} \\\\\n\\text{G T T G A C}\n\\end{align*}\n$$\nwhose score is $+2+2+2-2+2+2=8$. Therefore, the highest-scoring local alignment score is $8$, which is the required quantity.", "answer": "$$\\boxed{8}$$", "id": "4559104"}, {"introduction": "The choice of scoring model is critical and can dramatically alter alignment results. This advanced exercise [@problem_id:4559082] delves into the important distinction between linear and affine gap penalties. By analyzing the same pair of sequences under four different scenarios (global/linear, global/affine, local/linear, and local/affine), you will develop a nuanced understanding of how penalizing gap openings more harshly than extensions—a common feature in biological evolution—influences the placement and length of gaps in both global and local alignments.", "problem": "You are asked to analyze a pair of short biomolecular sequences to compare optimal gap placement under two gap models for both global and local alignment, using the principle of optimal substructure and dynamic programming derived from first principles. Consider two sequences representing short fragments of messenger ribonucleic acid (mRNA): let the first sequence be $X = \\texttt{AAGAA}$ and the second sequence be $Y = \\texttt{AAAAA}$. Assume a simple substitution scoring scheme with $+3$ for a match and $-8$ for any mismatch. Consider two gap models:\n- A linear gap model with a constant per-symbol gap penalty $g = -2$.\n- An affine gap model with a gap-open penalty $g_{o} = -6$ and a gap-extend penalty $g_{e} = -1$.\n\nFrom the basic principle of dynamic programming optimal substructure, construct the dynamic programming formulation for global alignment (Needleman–Wunsch) and local alignment (Smith–Waterman) under both the linear and affine gap models, without appealing to any pre-memorized shortcut formulas. Then, compute the optimal global alignment score under the linear gap model, the optimal global alignment score under the affine gap model, the optimal local alignment score under the linear gap model, and the optimal local alignment score under the affine gap model. Use these four scores to compute the scalar quantity\n$$\\Delta \\;=\\; \\big(S_{\\mathrm{global}}^{\\mathrm{lin}} - S_{\\mathrm{global}}^{\\mathrm{aff}}\\big) \\;+\\; \\big(S_{\\mathrm{local}}^{\\mathrm{lin}} - S_{\\mathrm{local}}^{\\mathrm{aff}}\\big).$$\nExpress your final answer as a pure number with no units. No rounding is required, and the answer must be provided as a single real value. In your work, justify the difference in optimal gap placement and gap length across the four scenarios by explicit reasoning from the dynamic programming states you define and the scoring parameters above. Acronyms must be defined at first use; for example, Dynamic Programming (DP), Needleman–Wunsch (NW), and Smith–Waterman (SW).", "solution": "The problem asks for the analysis of four sequence alignment scenarios involving two sequences, $X = \\texttt{AAGAA}$ and $Y = \\texttt{AAAAA}$, using two different gap penalty models (linear and affine) for both global and local alignments. The final goal is to compute a scalar quantity $\\Delta$ from the four resulting optimal scores.\n\nThe core principle underpinning these alignment algorithms is Dynamic Programming (DP), which breaks down a complex problem into a series of simpler, overlapping subproblems. The solution to each subproblem is stored, and these solutions are reused to solve larger subproblems until the entire problem is solved. This follows the principle of optimal substructure: an optimal alignment of two sequences is composed of optimal alignments of their prefixes.\n\nThe given parameters are:\n- Sequence $X$: $\\texttt{AAGAA}$ of length $m=5$\n- Sequence $Y$: $\\texttt{AAAAA}$ of length $n=5$\n- Match score: $s(\\text{match}) = +3$\n- Mismatch score: $s(\\text{mismatch}) = -8$. For this problem, this applies to $s(\\texttt{G},\\texttt{A})$.\n- Linear gap model penalty: $g = -2$ per symbol.\n- Affine gap model penalties: gap-open $g_{o} = -6$, gap-extend $g_{e} = -1$.\n\nWe will derive the DP formulation for each of the four cases, compute the optimal alignment scores, and then use them to calculate $\\Delta$.\n\n### 1. Global Alignment with Linear Gap Penalty (Needleman–Wunsch)\n\nThe goal of global alignment is to find the highest-scoring alignment that spans the entire length of both sequences.\n\n**DP Formulation:**\nLet $F(i, j)$ be the score of the optimal global alignment of the prefixes $X[1..i]$ and $Y[1..j]$. An optimal alignment ending at $(i, j)$ can be formed in one of three ways:\n1.  Aligning $X[i]$ with $Y[j]$ (match/mismatch): The score is $F(i-1, j-1) + s(X[i], Y[j])$.\n2.  Aligning $X[i]$ with a gap: The score is $F(i-1, j) + g$.\n3.  Aligning $Y[j]$ with a gap: The score is $F(i, j-1) + g$.\n\nThe optimal score $F(i, j)$ is the maximum of these possibilities. The recurrence relation is:\n$$F(i, j) = \\max \\begin{cases} F(i-1, j-1) + s(X[i], Y[j]) \\\\ F(i-1, j) + g \\\\ F(i, j-1) + g \\end{cases}$$\n**Initialization:**\n-   $F(0, 0) = 0$.\n-   $F(i, 0) = i \\times g = -2i$ for $i \\in [1, m]$. This represents aligning the prefix $X[1..i]$ with $i$ gaps.\n-   $F(0, j) = j \\times g = -2j$ for $j \\in [1, n]$. This represents aligning the prefix $Y[1..j]$ with $j$ gaps.\n\n**DP Table Calculation:**\nThe $6 \\times 6$ DP table for $F(i,j)$ is computed as follows. The columns correspond to sequence $Y$ and rows to sequence $X$.\n\n$$\n\\begin{array}{c|cccccc}\n  F(i,j)  -  \\texttt{A}  \\texttt{A}  \\texttt{A}  \\texttt{A}  \\texttt{A} \\\\\n\\hline\n-      0    -2   -4   -6   -8   -10 \\\\\n\\texttt{A}  -2   3    1    -1   -3   -5  \\\\\n\\texttt{A}  -4   1    6    4    2    0   \\\\\n\\texttt{G}  -6   -1   4    2    0    -2  \\\\\n\\texttt{A}  -8   -3   2    7    5    3   \\\\\n\\texttt{A}  -10  -5   0    5    10   8   \\\\\n\\end{array}\n$$\n\n**Optimal Score:**\nThe optimal global alignment score under the linear model is the value in the bottom-right cell of the matrix.\n$$S_{\\mathrm{global}}^{\\mathrm{lin}} = F(5, 5) = 8$$\n\n*Justification*: The linear gap penalty of $-2$ is less severe than the mismatch penalty of $-8$. The algorithm finds it optimal to introduce two gaps (one in each sequence) to avoid aligning `G` with `A`. A valid optimal alignment is `AAGAA-` vs `AA-AAA`, with a score of $3+3-2+3+3-2=8$.\n\n### 2. Global Alignment with Affine Gap Penalty (Needleman–Wunsch with Gotoh's improvement)\n\nThe affine gap model assigns a high penalty for opening a gap ($g_o$) and a smaller penalty for extending it ($g_e$). The score for a gap of length $k$ is $g_o + (k-1)g_e$.\n\n**DP Formulation:**\nWe need three DP tables to track the state of the alignment:\n-   $M(i, j)$: score of the best alignment of $X[1..i]$ and $Y[1..j]$ ending with $X[i]$ aligned to $Y[j]$.\n-   $I_x(i, j)$: score of the best alignment of $X[1..i]$ and $Y[1..j]$ ending with $X[i]$ aligned to a gap.\n-   $I_y(i, j)$: score of the best alignment of $X[1..i]$ and $Y[1..j]$ ending with $Y[j]$ aligned to a gap.\n\nThe recurrence relations are:\n$$M(i, j) = s(X[i], Y[j]) + \\max \\begin{cases} M(i-1, j-1) \\\\ I_x(i-1, j-1) \\\\ I_y(i-1, j-1) \\end{cases}$$\n$$I_x(i, j) = \\max \\begin{cases} M(i-1, j) + g_o + g_e \\\\ I_x(i-1, j) + g_e \\end{cases} = \\max \\begin{cases} M(i-1, j) - 7 \\\\ I_x(i-1, j) - 1 \\end{cases}$$\n$$I_y(i, j) = \\max \\begin{cases} M(i, j-1) + g_o + g_e \\\\ I_y(i, j-1) + g_e \\end{cases} = \\max \\begin{cases} M(i, j-1) - 7 \\\\ I_y(i, j-1) - 1 \\end{cases}$$\n\n**Initialization:**\n-   $M(0, 0) = 0$; $M(i, j) = -\\infty$ for $i>0$ or $j>0$ on the boundaries.\n-   $I_x(i, 0) = g_o + i \\cdot g_e = -6 - i$ for $i>0$.\n-   $I_y(0, j) = g_o + j \\cdot g_e = -6 - j$ for $j>0$.\n-   All other boundary values for $I_x$ and $I_y$ are $-\\infty$.\n\n**DP Table Calculation  Optimal Score:**\nAfter filling the three matrices, the optimal score is the maximum of the three values in the bottom-right cell.\nThe calculation yields $M(5, 5) = 4$.\n$$S_{\\mathrm{global}}^{\\mathrm{aff}} = \\max \\{ M(5, 5), I_x(5, 5), I_y(5, 5) \\} = 4$$\n\n*Justification*: The cost to introduce a gap is $g_o+g_e = -7$. The cost to introduce two separate gaps to avoid the `G/A` mismatch would be at least $2 \\times (g_o+g_e) = -14$. This is much worse than accepting the mismatch score of $-8$. Therefore, the optimal strategy is a gapless alignment: `AAGAA` vs `AAAAA`. The score is $s(A,A)+s(A,A)+s(G,A)+s(A,A)+s(A,A) = 3+3-8+3+3=4$.\n\n### 3. Local Alignment with Linear Gap Penalty (Smith–Waterman)\n\nLocal alignment finds the highest-scoring sub-alignment between two sequences.\n\n**DP Formulation:**\nThe recurrence is similar to Needleman-Wunsch, but with an added option to start a new alignment anywhere. This is achieved by ensuring the score never drops below zero.\nLet $H(i, j)$ be the score of the optimal local alignment ending at position $(i, j)$.\n$$H(i, j) = \\max \\begin{cases} 0 \\\\ H(i-1, j-1) + s(X[i], Y[j]) \\\\ H(i-1, j) + g \\\\ H(i, j-1) + g \\end{cases}$$\n**Initialization:**\n$H(i, 0) = 0$ for all $i$, and $H(0, j) = 0$ for all $j$.\n\n**DP Table Calculation:**\n$$\n\\begin{array}{c|cccccc}\n  H(i,j)  -  \\texttt{A}  \\texttt{A}  \\texttt{A}  \\texttt{A}  \\texttt{A} \\\\\n\\hline\n-      0  0  0  0  0  0 \\\\\n\\texttt{A}  0  3  3  3  3  3 \\\\\n\\texttt{A}  0  3  6  6  6  6 \\\\\n\\texttt{G}  0  1  4  4  4  4 \\\\\n\\texttt{A}  0  1  4  7  7  7 \\\\\n\\texttt{A}  0  1  4  7  10  10 \\\\\n\\end{array}\n$$\n**Optimal Score:**\nThe optimal local alignment score is the maximum value found anywhere in the matrix.\n$$S_{\\mathrm{local}}^{\\mathrm{lin}} = \\max_{i, j} H(i, j) = 10$$\n\n*Justification*: The algorithm identifies the highest-scoring segment. By aligning `G` with a gap (cost $-2$), the two `AA` segments in $X$ can be connected into a longer, higher-scoring local alignment of `AAGAA` vs `AA-AA`. The score is $3+3-2+3+3 = 10$. This is higher than any other local alignment score, so it is chosen as the optimum.\n\n### 4. Local Alignment with Affine Gap Penalty (Smith-Waterman with Gotoh's)\n\nThis combines the affine gap model with the local alignment principle.\n\n**DP Formulation:**\nThe recurrences are the same as for global affine alignment, but with the added condition that scores cannot be negative.\n$$M(i, j) = \\max \\left( 0, \\; s(X[i], Y[j]) + \\max \\begin{cases} M(i-1, j-1) \\\\ I_x(i-1, j-1) \\\\ I_y(i-1, j-1) \\end{cases} \\right)$$\n$$I_x(i, j) = \\max \\left( 0, \\; \\max \\begin{cases} M(i-1, j) + g_o + g_e \\\\ I_x(i-1, j) + g_e \\end{cases} \\right)$$\n$$I_y(i, j) = \\max \\left( 0, \\; \\max \\begin{cases} M(i, j-1) + g_o + g_e \\\\ I_y(i, j-1) + g_e \\end{cases} \\right)$$\n**Initialization:**\nAll cells in the first row and first column of all three matrices ($M, I_x, I_y$) are initialized to $0$.\n\n**DP Table Calculation  Optimal Score:**\nThe highest value in any of the three DP tables is the optimal local alignment score. The tables are filled, and the max value in the $M$ matrix is found to be $6$. The $I_x$ and $I_y$ matrices contain no values greater than $0$ because the high gap-opening penalty ($g_o=-6$) combined with the max match-containing score of $M=6$ results in non-positive values for gap states.\nThe $M$ matrix is:\n$$\n\\begin{array}{c|cccccc}\n  M(i,j)  -  \\texttt{A}  \\texttt{A}  \\texttt{A}  \\texttt{A}  \\texttt{A} \\\\\n\\hline\n-      0  0  0  0  0  0 \\\\\n\\texttt{A}  0  3  3  3  3  3 \\\\\n\\texttt{A}  0  3  6  6  6  6 \\\\\n\\texttt{G}  0  0  0  0  0  0 \\\\\n\\texttt{A}  0  3  3  3  3  3 \\\\\n\\texttt{A}  0  3  6  6  6  6 \\\\\n\\end{array}\n$$\nThe maximum score is:\n$$S_{\\mathrm{local}}^{\\mathrm{aff}} = 6$$\n\n*Justification*: The high gap opening penalty ($g_o+g_e=-7$) makes it unfavorable to bridge the two `AA` segments of $X$ across the `G`. An alignment of `AAGAA` vs `AA-AA` would have a score of $3+3+(-7)+3+3 = 5$. This is less than the score of an alignment consisting of just `AA` vs `AA` ($3+3=6$). The algorithm thus finds the optimal local alignment to be `AA/AA`, which can be formed from $X[1..2]$ or $X[4..5]$ against any `AA` substring of $Y$.\n\n### Final Calculation of $\\Delta$\n\nNow we compute the final quantity $\\Delta$ using the four scores:\n- $S_{\\mathrm{global}}^{\\mathrm{lin}} = 8$\n- $S_{\\mathrm{global}}^{\\mathrm{aff}} = 4$\n- $S_{\\mathrm{local}}^{\\mathrm{lin}} = 10$\n- $S_{\\mathrm{local}}^{\\mathrm{aff}} = 6$\n\n$$\\Delta \\;=\\; \\big(S_{\\mathrm{global}}^{\\mathrm{lin}} - S_{\\mathrm{global}}^{\\mathrm{aff}}\\big) \\;+\\; \\big(S_{\\mathrm{local}}^{\\mathrm{lin}} - S_{\\mathrm{local}}^{\\mathrm{aff}}\\big)$$\n$$\\Delta = (8 - 4) + (10 - 6)$$\n$$\\Delta = 4 + 4 = 8$$", "answer": "$$\\boxed{8}$$", "id": "4559082"}]}