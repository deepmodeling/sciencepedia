{"hands_on_practices": [{"introduction": "A core component of a genome-scale model is the set of constraints placed upon reaction fluxes, which often derive from the cell's enzymatic capacity. This exercise demonstrates how to connect fundamental biochemical data—enzyme concentration and catalytic rates—to the operational limits of a metabolic pathway. By calculating the maximum steady-state flux of the malate-aspartate shuttle, you will practice identifying the rate-limiting step, a foundational concept in understanding and engineering cellular metabolism [@problem_id:4584267].", "problem": "A cellular genome-wide reconstruction integrates gene-protein-reaction mapping to infer feasible metabolic pathways under the Central Dogma of molecular biology (DNA transcribed to RNA, RNA translated to protein) and steady-state mass-balance principles. Consider a eukaryotic cell in which the genome encodes only the malate-aspartate shuttle for transferring cytosolic reduced nicotinamide adenine dinucleotide (NADH) to the mitochondrial matrix; the glycerol-3-phosphate shuttle is absent. The malate-aspartate shuttle cycle consists of the following steps, each supported by a gene with measured enzyme or transporter abundance and turnover number under saturating substrate conditions:\n\n1. Cytosolic malate dehydrogenase: $$\\mathrm{OAA}_{c} + \\mathrm{NADH}_{c} \\rightarrow \\mathrm{Malate}_{c} + \\mathrm{NAD}^{+}_{c}$$\n2. Mitochondrial inner membrane malate/alpha-ketoglutarate antiporter: $$\\mathrm{Malate}_{c} + \\alpha\\mathrm{KG}_{m} \\rightleftharpoons \\mathrm{Malate}_{m} + \\alpha\\mathrm{KG}_{c}$$\n3. Mitochondrial malate dehydrogenase: $$\\mathrm{Malate}_{m} + \\mathrm{NAD}^{+}_{m} \\rightarrow \\mathrm{OAA}_{m} + \\mathrm{NADH}_{m}$$\n4. Mitochondrial aspartate aminotransferase: $$\\mathrm{OAA}_{m} + \\mathrm{Glu}_{m} \\rightleftharpoons \\mathrm{Asp}_{m} + \\alpha\\mathrm{KG}_{m}$$\n5. Mitochondrial inner membrane aspartate/glutamate antiporter: $$\\mathrm{Asp}_{m} + \\mathrm{Glu}_{c} \\rightleftharpoons \\mathrm{Asp}_{c} + \\mathrm{Glu}_{m}$$\n6. Cytosolic aspartate aminotransferase: $$\\mathrm{Asp}_{c} + \\alpha\\mathrm{KG}_{c} \\rightleftharpoons \\mathrm{OAA}_{c} + \\mathrm{Glu}_{c}$$\n\nAssume cytosolic and mitochondrial pools of glutamate and alpha-ketoglutarate are sufficiently buffered so that their concentrations do not limit flux, the membrane potential permits electroneutral antiport at the listed rates, and all steps operate under saturating substrate conditions so that their fluxes are bounded by enzyme or transporter capacity. For each step $i$, the capacity constraint is $v_{i} \\leq k_{\\text{cat},i} E_{i}$, where $v_{i}$ is the step flux in $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$, $k_{\\text{cat},i}$ is the turnover number in $\\mathrm{s}^{-1}$, and $E_{i}$ is the enzyme or transporter abundance in $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}$; $\\mathrm{gDW}$ denotes gram dry weight. The measured $E_{i}$ and $k_{\\text{cat},i}$ values are:\n\n- Step $1$: $E_{1} = 1.0 \\times 10^{-3}$, $k_{\\text{cat},1} = 2.0 \\times 10^{2}$.\n- Step $2$: $E_{2} = 2.0 \\times 10^{-5}$, $k_{\\text{cat},2} = 5.0 \\times 10^{2}$.\n- Step $3$: $E_{3} = 5.0 \\times 10^{-4}$, $k_{\\text{cat},3} = 1.5 \\times 10^{2}$.\n- Step $4$: $E_{4} = 2.0 \\times 10^{-4}$, $k_{\\text{cat},4} = 1.0 \\times 10^{2}$.\n- Step $5$: $E_{5} = 1.0 \\times 10^{-5}$, $k_{\\text{cat},5} = 7.9 \\times 10^{2}$.\n- Step $6$: $E_{6} = 3.0 \\times 10^{-4}$, $k_{\\text{cat},6} = 1.2 \\times 10^{2}$.\n\nIn a steady-state cyclic operation of the shuttle that transfers one cytosolic NADH equivalent to the mitochondrial matrix per cycle, each step $i$ must carry the same cycle flux $v$, and the overall malate-aspartate shuttle flux $v_{\\text{shuttle}}$ (production of $\\mathrm{NADH}_{m}$ per time per gram dry weight) is limited by the most restrictive step capacity within the cycle. Using only the above foundational principles and data, compute the maximum steady-state mitochondrial $\\mathrm{NADH}$ production rate $v_{\\text{shuttle,max}}$ achievable by this shuttle. Express your final answer in $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$ and round your answer to four significant figures.", "solution": "The problem statement will first be subjected to a rigorous validation process before any attempt at a solution is made.\n\n### Step 1: Extract Givens\n\nThe problem provides the following information:\n- A description of the malate-aspartate shuttle as a set of $6$ biochemical reactions and transport processes.\n- The principle of steady-state cyclic operation, where each step $i$ carries the same flux $v$.\n- The principle that step flux is capacity-constrained: $v_{i} \\leq k_{\\text{cat},i} E_{i}$.\n- The variable $v_{i}$ is the step flux in units of $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$.\n- The variable $k_{\\text{cat},i}$ is the turnover number in units of $\\mathrm{s}^{-1}$.\n- The variable $E_{i}$ is the enzyme or transporter abundance in units of $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}$.\n- The measured data for each step $i \\in \\{1, 2, 3, 4, 5, 6\\}$ are:\n    - Step $1$: $E_{1} = 1.0 \\times 10^{-3}$, $k_{\\text{cat},1} = 2.0 \\times 10^{2}$.\n    - Step $2$: $E_{2} = 2.0 \\times 10^{-5}$, $k_{\\text{cat},2} = 5.0 \\times 10^{2}$.\n    - Step $3$: $E_{3} = 5.0 \\times 10^{-4}$, $k_{\\text{cat},3} = 1.5 \\times 10^{2}$.\n    - Step $4$: $E_{4} = 2.0 \\times 10^{-4}$, $k_{\\text{cat},4} = 1.0 \\times 10^{2}$.\n    - Step $5$: $E_{5} = 1.0 \\times 10^{-5}$, $k_{\\text{cat},5} = 7.9 \\times 10^{2}$.\n    - Step $6$: $E_{6} = 3.0 \\times 10^{-4}$, $k_{\\text{cat},6} = 1.2 \\times 10^{2}$.\n- The objective is to compute the maximum steady-state mitochondrial $\\mathrm{NADH}$ production rate, $v_{\\text{shuttle,max}}$.\n- The final answer must be expressed in units of $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$ and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded**: The problem is based on the well-established biochemistry of the malate-aspartate shuttle and the fundamental principles of metabolic flux analysis, namely steady-state mass balance and enzyme capacity constraints. The framework $v \\leq k_{\\text{cat}}E$ is a standard representation of maximum enzymatic flux. The units are dimensionally consistent and standard in the field. The problem is free of pseudoscience or factual inaccuracies.\n- **Well-Posed**: The problem is clearly structured. It asks for the maximum flux of a cyclic pathway at steady state. The governing principle is that the flux of the entire cycle is limited by the flux of its slowest step (the bottleneck). All necessary data ($E_i$ and $k_{\\text{cat},i}$ for each step) are provided to calculate the maximum flux for each step and thus determine the overall maximum flux. The solution will be unique and meaningful.\n- **Objective**: The language is precise, quantitative, and free of any subjective or ambiguous terminology.\n- **Completeness and Consistency**: The problem is self-contained. All necessary reactions, data, constraints, and assumptions (e.g., saturating substrate conditions, steady-state) are explicitly stated. There are no internal contradictions.\n- **Realistic and Feasible**: The provided values for enzyme abundances and turnover numbers are within plausible biological ranges. The setup describes a standard problem in computational systems biology.\n\n### Step 3: Verdict and Action\n\nThe problem is scientifically sound, well-posed, completely specified, and objective. There are no identifiable flaws. Therefore, the problem is deemed **valid**, and I will proceed with a full solution.\n\n### Solution\n\nThe problem requires the calculation of the maximum steady-state flux of the malate-aspartate shuttle, $v_{\\text{shuttle,max}}$. This shuttle operates as a metabolic cycle. At steady state, the law of conservation of mass dictates that the net flux of all intermediate metabolites within the cycle must be zero. This implies that the rate, or flux, $v$, must be the same for every step in the cycle.\n\nThe problem states that all steps operate under saturating substrate conditions. Under these conditions, the flux through each step $i$, denoted $v_i$, is limited by its maximum capacity, $v_{i, \\text{max}}$. This maximum capacity is determined by the total amount of available enzyme or transporter, $E_i$, and its catalytic efficiency, represented by the turnover number, $k_{\\text{cat},i}$. The relationship is given by:\n$$v_{i, \\text{max}} = k_{\\text{cat},i} E_{i}$$\n\nSince the flux $v$ must be the same for all steps in the cycle ($v = v_1 = v_2 = \\dots = v_6$), the overall flux of the shuttle is constrained by the step with the lowest maximum capacity. This step is the rate-limiting step, or bottleneck, of the pathway. Therefore, the maximum flux for the entire shuttle, $v_{\\text{shuttle,max}}$, is the minimum of the maximum capacities of its individual steps.\n$$v_{\\text{shuttle,max}} = \\min(v_{1, \\text{max}}, v_{2, \\text{max}}, v_{3, \\text{max}}, v_{4, \\text{max}}, v_{5, \\text{max}}, v_{6, \\text{max}})$$\n\nWe will now calculate the maximum flux capacity for each of the $6$ steps using the provided data. The units for these calculations will be $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$.\n\n- **Step 1**: Cytosolic malate dehydrogenase\n  $v_{1, \\text{max}} = k_{\\text{cat},1} E_{1} = (2.0 \\times 10^{2} \\, \\mathrm{s}^{-1}) \\times (1.0 \\times 10^{-3} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}) = 2.0 \\times 10^{-1} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$\n\n- **Step 2**: Malate/alpha-ketoglutarate antiporter\n  $v_{2, \\text{max}} = k_{\\text{cat},2} E_{2} = (5.0 \\times 10^{2} \\, \\mathrm{s}^{-1}) \\times (2.0 \\times 10^{-5} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}) = 10.0 \\times 10^{-3} = 1.0 \\times 10^{-2} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$\n\n- **Step 3**: Mitochondrial malate dehydrogenase\n  $v_{3, \\text{max}} = k_{\\text{cat},3} E_{3} = (1.5 \\times 10^{2} \\, \\mathrm{s}^{-1}) \\times (5.0 \\times 10^{-4} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}) = 7.5 \\times 10^{-2} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$\n\n- **Step 4**: Mitochondrial aspartate aminotransferase\n  $v_{4, \\text{max}} = k_{\\text{cat},4} E_{4} = (1.0 \\times 10^{2} \\, \\mathrm{s}^{-1}) \\times (2.0 \\times 10^{-4} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}) = 2.0 \\times 10^{-2} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$\n\n- **Step 5**: Aspartate/glutamate antiporter\n  $v_{5, \\text{max}} = k_{\\text{cat},5} E_{5} = (7.9 \\times 10^{2} \\, \\mathrm{s}^{-1}) \\times (1.0 \\times 10^{-5} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}) = 7.9 \\times 10^{-3} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$\n\n- **Step 6**: Cytosolic aspartate aminotransferase\n  $v_{6, \\text{max}} = k_{\\text{cat},6} E_{6} = (1.2 \\times 10^{2} \\, \\mathrm{s}^{-1}) \\times (3.0 \\times 10^{-4} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1}) = 3.6 \\times 10^{-2} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$\n\nNow, we compare the calculated maximum capacities to find the minimum value:\n$v_{1, \\text{max}} = 0.20$\n$v_{2, \\text{max}} = 0.010$\n$v_{3, \\text{max}} = 0.075$\n$v_{4, \\text{max}} = 0.020$\n$v_{5, \\text{max}} = 0.0079$\n$v_{6, \\text{max}} = 0.036$\n\nThe minimum value is $v_{5, \\text{max}} = 7.9 \\times 10^{-3} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$. This corresponds to the aspartate/glutamate antiporter, which is the rate-limiting step of the shuttle.\nThus, the maximum steady-state flux of the shuttle is:\n$$v_{\\text{shuttle,max}} = 7.9 \\times 10^{-3} \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{s}^{-1}$$\nThe problem asks for the final answer to be expressed in units of $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$. To convert the units from per second to per hour, we multiply by the number of seconds in an hour ($3600$).\n$$v_{\\text{shuttle,max}} = (7.9 \\times 10^{-3} \\, \\frac{\\mathrm{mmol}}{\\mathrm{gDW} \\cdot \\mathrm{s}}) \\times (3600 \\, \\frac{\\mathrm{s}}{\\mathrm{h}})$$\n$$v_{\\text{shuttle,max}} = 7.9 \\times 10^{-3} \\times 3.6 \\times 10^{3} \\, \\frac{\\mathrm{mmol}}{\\mathrm{gDW} \\cdot \\mathrm{h}}$$\n$$v_{\\text{shuttle,max}} = 7.9 \\times 3.6 \\, \\frac{\\mathrm{mmol}}{\\mathrm{gDW} \\cdot \\mathrm{h}} = 28.44 \\, \\frac{\\mathrm{mmol}}{\\mathrm{gDW} \\cdot \\mathrm{h}}$$\nThe problem specifies rounding the final answer to four significant figures. The calculated value $28.44$ already has four significant figures.\n\nThe maximum steady-state mitochondrial $\\mathrm{NADH}$ production rate achievable by the malate-aspartate shuttle is $28.44 \\, \\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$.", "answer": "$$\\boxed{28.44}$$", "id": "4584267"}, {"introduction": "Draft metabolic networks reconstructed from genomic data are often incomplete, containing \"gaps\" that render the model incapable of simulating key biological functions like growth. This practice challenges you to translate this biological problem into a precise mathematical framework. You will construct a Mixed-Integer Linear Program (MILP) to find the minimum-cost set of candidate reactions needed to restore a functional pathway, providing a deep understanding of how automated gap-filling algorithms operate [@problem_id:4584300].", "problem": "A genome-scale reconstruction workflow infers a draft metabolic network from annotated genes and adds exchange and biomass reactions. To assess growth feasibility under steady-state and thermodynamically consistent fluxes, the draft model is analyzed using Flux Balance Analysis (FBA), which is grounded in the steady-state mass balance constraint $S \\mathbf{v} = \\mathbf{0},$ reaction directionality and capacity bounds, and a target biomass production requirement. When the draft model cannot produce the required biomass, gap filling introduces a minimal-cost subset of candidate reactions consistent with genomic evidence. Consider the following simplified core of such a draft network with internal metabolites $A$, $B$, and $C$ and reactions:\n- $R_1$: uptake $A_{\\mathrm{ext}} \\rightarrow A$,\n- $R_2$: $A \\rightarrow B$,\n- $R_3$ (candidate): $B \\rightarrow C$,\n- $R_5$ (candidate): $2A \\rightarrow C$,\n- $R_4$: $C \\rightarrow \\text{Biomass}$.\n\nAssume the steady-state mass balance constraints $S \\mathbf{v} = \\mathbf{0}$ for the internal metabolites $A$, $B$, and $C$ with the stoichiometric matrix\n$$\nS \\;=\\;\n\\begin{bmatrix}\n1  -1  0  -2  0 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  1  -1\n\\end{bmatrix},\n$$\nwhere the columns are ordered as $(R_1, R_2, R_3, R_5, R_4)$ and $\\mathbf{v} \\in \\mathbb{R}^5$ collects the reaction fluxes in the same order. All reactions are irreversible. The flux bounds are\n$$\n0 \\le v_1 \\le 5,\\quad 0 \\le v_2 \\le 4,\\quad 0 \\le v_4 \\le U,\n$$\nand for the candidate reactions, introduce binary inclusion variables $y_3, y_5 \\in \\{0,1\\}$ with the big-$M$ (single-parameter) coupling\n$$\n0 \\le v_3 \\le U y_3,\\quad 0 \\le v_5 \\le U y_5,\n$$\nwhere $U$ is a sufficiently large constant. Impose a biomass production requirement\n$$\nv_4 \\ge \\phi,\n$$\nwith target $\\phi = 3$. The candidate reactions carry penalties reflecting genomic evidence and curation confidence: cost $c_3 = 2$ for $R_3$ and cost $c_5 = 1$ for $R_5$. The objective of gap filling is to minimize the total penalty of added reactions subject to feasibility of the steady-state model with the biomass requirement.\n\nStarting from the steady-state definition, reaction irreversibility, and capacity constraints, derive a Mixed-Integer Linear Programming (MILP) formulation that selects a minimum-penalty subset of candidate reactions to achieve $v_4 \\ge \\phi$. Then, without invoking any external solver, determine the optimal objective value (the minimal total penalty) for the given parameters. Report the minimal total penalty as a dimensionless number. No rounding is required, and no units are to be provided with the final answer. Your final answer must be a single real number.", "solution": "The user's request is to solve a mixed-integer linear programming problem for metabolic network gap filling.\n\n## Problem Validation\n\n### Step 1: Extract Givens\n-   **System**: A metabolic network with internal metabolites $A$, $B$, and $C$.\n-   **Reactions**:\n    -   $R_1$: uptake $A_{\\mathrm{ext}} \\rightarrow A$\n    -   $R_2$: $A \\rightarrow B$\n    -   $R_3$ (candidate): $B \\rightarrow C$\n    -   $R_5$ (candidate): $2A \\rightarrow C$\n    -   $R_4$: $C \\rightarrow \\text{Biomass}$\n-   **Steady-State Constraint**: $S \\mathbf{v} = \\mathbf{0}$, where $\\mathbf{v} = (v_1, v_2, v_3, v_5, v_4)^T$ is the vector of reaction fluxes.\n-   **Stoichiometric Matrix**:\n    $$\n    S \\;=\\;\n    \\begin{bmatrix}\n    1  -1  0  -2  0 \\\\\n    0  1  -1  0  0 \\\\\n    0  0  1  1  -1\n    \\end{bmatrix}\n    $$\n-   **Flux Bounds and Irreversibility**:\n    -   All reactions are irreversible ($v_i \\ge 0$).\n    -   $0 \\le v_1 \\le 5$\n    -   $0 \\le v_2 \\le 4$\n    -   $0 \\le v_4 \\le U$\n-   **Candidate Reactions**:\n    -   Binary inclusion variables: $y_3, y_5 \\in \\{0,1\\}$.\n    -   Big-$M$ coupling: $0 \\le v_3 \\le U y_3$, $0 \\le v_5 \\le U y_5$. $U$ is a sufficiently large constant.\n-   **Biomass Requirement**: $v_4 \\ge \\phi$, with $\\phi = 3$.\n-   **Objective**: Minimize the total penalty of added reactions.\n-   **Penalties**: Cost $c_3 = 2$ for $R_3$, cost $c_5 = 1$ for $R_5$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard application of Flux Balance Analysis (FBA) and Mixed-Integer Linear Programming (MILP) for metabolic gap filling, a core task in systems biology and bioinformatics. The concepts used (stoichiometric matrix, steady-state assumption, flux bounds, MILP optimization) are fundamental to the field.\n2.  **Well-Posed**: The problem is well-posed. It asks for the minimum value of a linear objective function subject to a set of linear equality and inequality constraints, with some variables being integers (binary). This defines a MILP, which is a solvable optimization problem. All necessary parameters ($S$, bounds, costs, biomass target) are provided.\n3.  **Objective**: The problem is stated using precise, formal mathematical language. It is free of ambiguity and subjectivity.\n4.  **Completeness**: The problem is self-contained and provides all necessary information to formulate and solve the MILP. The term \"sufficiently large constant\" for $U$ is standard practice in MILP formulations and does not render the problem incomplete, as its role is to not constrain the flux if the corresponding reaction is chosen.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. I will proceed to solve it.\n\n## Derivation and Solution\n\nThe objective is to find the minimum penalty for adding candidate reactions such that a feasible flux distribution exists that produces the required amount of biomass. This can be formulated as a Mixed-Integer Linear Programming (MILP) problem.\n\n### MILP Formulation\nThe goal is to minimize the total cost associated with including the candidate reactions $R_3$ and $R_5$. The cost is a function of the binary variables $y_3$ and $y_5$.\n\n**Objective Function:**\nMinimize $z = c_3 y_3 + c_5 y_5$, which is:\n$$\n\\min_{\\mathbf{v}, y} \\;\\; 2y_3 + y_5\n$$\n\n**Constraints:**\nThe optimization is subject to the following constraints:\n1.  **Steady-state mass balance**: $S \\mathbf{v} = \\mathbf{0}$.\n    $$\n    \\begin{pmatrix}\n    1  -1  0  -2  0 \\\\\n    0  1  -1  0  0 \\\\\n    0  0  1  1  -1\n    \\end{pmatrix}\n    \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_5 \\\\ v_4 \\end{pmatrix}\n    =\n    \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n    $$\n    This matrix equation expands to the following system of linear equations for the internal metabolites $(A, B, C)$:\n    -   $v_1 - v_2 - 2v_5 = 0$\n    -   $v_2 - v_3 = 0$\n    -   $v_3 + v_5 - v_4 = 0$\n\n2.  **Flux bounds and irreversibility**:\n    -   $0 \\le v_1 \\le 5$\n    -   $0 \\le v_2 \\le 4$\n    -   $v_3 \\ge 0$\n    -   $v_5 \\ge 0$\n\n3.  **Biomass production requirement**:\n    -   $v_4 \\ge 3$\n\n4.  **Coupling of fluxes and binary variables**:\n    -   $v_3 \\le U y_3$\n    -   $v_5 \\le U y_5$\n    The upper bound $v_4 \\le U$ is implicitly handled as we are seeking a minimal set of fluxes, and $U$ is assumed large enough not to be a binding constraint.\n\n5.  **Binary variable definitions**:\n    -   $y_3, y_5 \\in \\{0, 1\\}$\n\n### Solving the MILP\nTo solve this problem without a dedicated solver, we can enumerate all possible combinations of the binary variables $(y_3, y_5)$ and check for the feasibility of the resulting Linear Program (LP). The objective value is the minimum cost among all feasible combinations. There are $2^2 = 4$ possible combinations.\n\nFrom the steady-state equations, we can express $v_1$, $v_2$, and $v_4$ in terms of the candidate reaction fluxes $v_3$ and $v_5$:\n-   From $v_2 - v_3 = 0$, we get $v_2 = v_3$.\n-   From $v_3 + v_5 - v_4 = 0$, we get $v_4 = v_3 + v_5$.\n-   Substituting $v_2=v_3$ into $v_1 - v_2 - 2v_5 = 0$, we get $v_1 = v_2 + 2v_5 = v_3 + 2v_5$.\n\nNow we test each case for feasibility.\n\n**Case 1: $(y_3, y_5) = (0, 0)$**\n-   Objective value: $2(0) + 1(0) = 0$.\n-   Constraints on fluxes: $y_3=0 \\implies v_3=0$, and $y_5=0 \\implies v_5=0$.\n-   Using the derived relationships:\n    -   $v_2 = v_3 = 0$.\n    -   $v_4 = v_3 + v_5 = 0 + 0 = 0$.\n-   Check biomass requirement: $v_4 \\ge 3$. Here, $v_4=0$. The condition $0 \\ge 3$ is false.\n-   **Conclusion**: This case is infeasible.\n\n**Case 2: $(y_3, y_5) = (0, 1)$**\n-   Objective value: $2(0) + 1(1) = 1$.\n-   Constraints on fluxes: $y_3=0 \\implies v_3=0$. $y_5=1 \\implies v_5 \\ge 0$.\n-   Flux relationships:\n    -   $v_3=0$\n    -   $v_2 = v_3 = 0$.\n    -   $v_4 = v_3 + v_5 = v_5$.\n    -   $v_1 = v_3 + 2v_5 = 2v_5$.\n-   We need to find a $v_5 \\ge 0$ that satisfies all constraints:\n    -   Biomass requirement: $v_4 \\ge 3 \\implies v_5 \\ge 3$.\n    -   Flux bound on $v_1$: $v_1 \\le 5 \\implies 2v_5 \\le 5 \\implies v_5 \\le 2.5$.\n    -   Flux bound on $v_2$: $v_2 \\le 4 \\implies 0 \\le 4$, which is always true.\n-   The conditions on $v_5$ are $v_5 \\ge 3$ and $v_5 \\le 2.5$. These are contradictory. No such $v_5$ exists.\n-   **Conclusion**: This case is infeasible.\n\n**Case 3: $(y_3, y_5) = (1, 0)$**\n-   Objective value: $2(1) + 1(0) = 2$.\n-   Constraints on fluxes: $y_3=1 \\implies v_3 \\ge 0$. $y_5=0 \\implies v_5=0$.\n-   Flux relationships:\n    -   $v_5=0$\n    -   $v_2 = v_3$.\n    -   $v_4 = v_3 + v_5 = v_3$.\n    -   $v_1 = v_3 + 2v_5 = v_3$.\n-   We now have $v_1 = v_2 = v_3 = v_4$. We need to find a $v_3 \\ge 0$ that satisfies all constraints:\n    -   Biomass requirement: $v_4 \\ge 3 \\implies v_3 \\ge 3$.\n    -   Flux bound on $v_1$: $v_1 \\le 5 \\implies v_3 \\le 5$.\n    -   Flux bound on $v_2$: $v_2 \\le 4 \\implies v_3 \\le 4$.\n-   Combining the conditions on $v_3$: $3 \\le v_3 \\le 4$.\n-   A feasible value for $v_3$ exists, for example $v_3 = 3$. This gives a valid flux vector $\\mathbf{v}=(3, 3, 3, 0, 3)^T$. All constraints are satisfied.\n-   **Conclusion**: This case is feasible. The cost is 2.\n\n**Case 4: $(y_3, y_5) = (1, 1)$**\n-   Objective value: $2(1) + 1(1) = 3$.\n-   This cost is already higher than the feasible cost of $2$ found in Case 3. Since we are minimizing the cost, we have already found a better solution. Thus, the optimal value cannot be $3$. For completeness, we can verify feasibility.\n-   Constraints: Find $v_3 \\ge 0$ and $v_5 \\ge 0$ that satisfy:\n    -   Biomass requirement: $v_4 = v_3 + v_5 \\ge 3$.\n    -   Flux bound on $v_1$: $v_1 = v_3 + 2v_5 \\le 5$.\n    -   Flux bound on $v_2$: $v_2 = v_3 \\le 4$.\n-   We need to find a point $(v_3, v_5)$ in the feasible region defined by $v_3 \\ge 0$, $v_5 \\ge 0$, $v_3 \\le 4$, $v_3+v_5 \\ge 3$, and $v_3+2v_5 \\le 5$.\n-   Consider the point $(v_3, v_5) = (1, 2)$.\n    -   $v_3=1 \\le 4$ (ok).\n    -   $v_3+v_5 = 1+2 = 3 \\ge 3$ (ok).\n    -   $v_3+2v_5 = 1+2(2) = 5 \\le 5$ (ok).\n-   This point is feasible. It corresponds to the flux vector $\\mathbf{v} = (5, 1, 1, 2, 3)^T$.\n-   **Conclusion**: This case is feasible. The cost is 3.\n\n### Final determination\nWe have systematically checked all possibilities for including the candidate reactions:\n-   Cost $0$ (no reactions): Infeasible.\n-   Cost $1$ ($R_5$ only): Infeasible.\n-   Cost $2$ ($R_3$ only): Feasible.\n-   Cost $3$ (both $R_3$ and $R_5$): Feasible.\n\nThe objective is to minimize the penalty. The set of costs for which the system is feasible is $\\{2, 3\\}$. The minimum value in this set is $2$.\n\nTherefore, the minimal total penalty to achieve the required biomass production is $2$.", "answer": "$$\\boxed{2}$$", "id": "4584300"}, {"introduction": "A functional metabolic model can often achieve a biological objective, such as maximizing biomass production, through many alternative flux distributions. This exercise introduces Flux Variability Analysis (FVA), a powerful technique used to explore the entire landscape of feasible metabolic states that satisfy a given condition. By implementing FVA to find the range of every reaction flux, you will learn to identify network flexibility and pinpoint reactions that are essential or completely inactive (blocked), offering richer insights than a single optimal flux vector provides [@problem_id:4584265].", "problem": "You are given a set of linear metabolic network models defined by a stoichiometric matrix, flux bounds, and a linear objective on reaction fluxes. The fundamental base is the mass conservation at steady state, which asserts that for a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ and a flux vector $\\mathbf{v} \\in \\mathbb{R}^{n}$, intracellular metabolite accumulation is zero, so $S \\mathbf{v} = \\mathbf{0}$. Additionally, every reaction $j$ has a lower bound $l_j$ and an upper bound $u_j$, so $l_j \\le v_j \\le u_j$. A linear metabolic objective is a vector $c \\in \\mathbb{R}^{n}$, and the canonical flux balance analysis (FBA) seeks an optimal $\\mathbf{v}$ that maximizes $c^\\top \\mathbf{v}$ subject to $S \\mathbf{v} = \\mathbf{0}$ and the bounds. Flux variability analysis (FVA) further asks, for each reaction $j$, the minimum and maximum feasible $v_j$ subject to both $S \\mathbf{v} = \\mathbf{0}$, bounds, and a constraint that the objective remains near the optimum. Define the optimal objective value $z^\\star = \\max\\{c^\\top \\mathbf{v} \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u\\}$, and for a retention fraction $\\gamma \\in [0,1]$, the FVA range for reaction $j$ is\n$$\n\\left[v_j^{\\min}, v_j^{\\max}\\right] =\n\\left[\n\\min\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u, \\ c^\\top \\mathbf{v} \\ge \\gamma z^\\star\\}, \\ \n\\max\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u, \\ c^\\top \\mathbf{v} \\ge \\gamma z^\\star\\}\n\\right].\n$$\nA reaction $j$ is called blocked if and only if, even without the objective retention constraint, both $\\min\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u\\}$ and $\\max\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u\\}$ are equal to $0$ within a small numerical tolerance. All fluxes and bounds are dimensionless rates, so no physical units are required.\n\nImplement a program that, for each of the following test cases, computes:\n- The optimal objective value $z^\\star$.\n- The FVA ranges $\\left[v_j^{\\min}, v_j^{\\max}\\right]$ for every reaction $j$ with objective retention fraction $\\gamma$.\n- The list of zero-based indices of all blocked reactions.\n\nYour program must use linear programming to solve the above optimization problems, and must aggregate results for all test cases into a single line as a comma-separated list enclosed in square brackets, with no spaces, where each test case result is a list of the form $\\left[z^\\star, \\ \\text{FVA\\_ranges}, \\ \\text{blocked\\_indices}\\right]$. In the output, $\\text{FVA\\_ranges}$ must be a list of $n$ two-element lists $\\left[v_j^{\\min}, v_j^{\\max}\\right]$ in reaction index order, and $\\text{blocked\\_indices}$ must be a list of integers.\n\nTest suite:\n- Case $1$ (parallel pathways create alternative optima for internal reactions while biomass is fixed):\n  - $m = 3$, $n = 5$.\n  - Metabolites: $A, B, C$; Reactions: $R_1$ uptake $A_{\\text{ext}} \\to A$, $R_2$ $A \\to B$, $R_3$ $B \\to C$, $R_4$ $C \\to$ sink (biomass), $R_6$ $B \\to C$ (parallel to $R_3$).\n  - Stoichiometric matrix $S$ (rows $A,B,C$; columns $R_1,R_2,R_3,R_4,R_6$):\n    $$\n    S =\n    \\begin{bmatrix}\n    +1  -1  0  0  0 \\\\\n    0  +1  -1  0  -1 \\\\\n    0  0  +1  -1  +1\n    \\end{bmatrix}.\n    $$\n  - Bounds $l = [0,0,0,0,0]$, $u = [10,1000,1000,1000,1000]$.\n  - Objective $c = [0,0,0,1,0]$.\n  - Retention fraction $\\gamma = 1.0$.\n\n- Case $2$ (blocked reaction due to missing source and sink balance):\n  - $m = 5$, $n = 6$.\n  - Metabolites: $A, B, C, D, E$; Reactions: $R_1, R_2, R_3, R_4, R_6$ as in Case $1$, plus $R_7$ $D \\to E$ (no other reactions on $D$ or $E$).\n  - Stoichiometric matrix $S$ (rows $A,B,C,D,E$; columns $R_1,R_2,R_3,R_4,R_6,R_7$):\n    $$\n    S =\n    \\begin{bmatrix}\n    +1  -1  0  0  0  0 \\\\\n    0  +1  -1  0  -1  0 \\\\\n    0  0  +1  -1  +1  0 \\\\\n    0  0  0  0  0  -1 \\\\\n    0  0  0  0  0  +1\n    \\end{bmatrix}.\n    $$\n  - Bounds $l = [0,0,0,0,0,0]$, $u = [5,1000,1000,1000,1000,100]$.\n  - Objective $c = [0,0,0,1,0,0]$.\n  - Retention fraction $\\gamma = 1.0$.\n\n- Case $3$ (boundary condition: a reaction with zero upper bound is trivially blocked):\n  - $m = 3$, $n = 6$.\n  - Metabolites: $A, B, C$; Reactions: $R_1, R_2, R_3, R_4, R_6$ as in Case $1$, plus $R_9$ $B \\to A$ with zero upper bound.\n  - Stoichiometric matrix $S$ (rows $A,B,C$; columns $R_1,R_2,R_3,R_4,R_6,R_9$):\n    $$\n    S =\n    \\begin{bmatrix}\n    +1  -1  0  0  0  +1 \\\\\n    0  +1  -1  0  -1  -1 \\\\\n    0  0  +1  -1  +1  0\n    \\end{bmatrix}.\n    $$\n  - Bounds $l = [0,0,0,0,0,0]$, $u = [8,1000,1000,1000,1000,0]$.\n  - Objective $c = [0,0,0,1,0,0]$.\n  - Retention fraction $\\gamma = 1.0$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of the three test case results, enclosed in square brackets, with no spaces. Each test case result must be a list of the form $\\left[z^\\star, \\ \\text{FVA\\_ranges}, \\ \\text{blocked\\_indices}\\right]$. For example, an output with placeholder numbers would look like $\\left[[1.0,[[0.0,1.0]],[]],[2.0,[[0.0,2.0]],[]],[3.0,[[0.0,3.0]],[]]\\right]$.", "solution": "The user has provided a well-posed problem from the field of bioinformatics, specifically metabolic network analysis. The problem is grounded in established scientific principles, namely mass conservation in metabolic networks at steady state, and its analysis using linear optimization techniques such as Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA). All provided data and definitions are clear, consistent, and mathematically precise. The problem is valid and can be solved as stated.\n\nThe core of the problem is the solution of a series of linear programming (LP) problems. An LP problem seeks to optimize a linear objective function subject to a set of linear equality and inequality constraints. The canonical form for a minimization problem is:\n$$\n\\begin{aligned}\n\\min_{x} \\quad  c^\\top x \\\\\n\\text{subject to} \\quad  A_{ub} x \\le b_{ub} \\\\\n A_{eq} x = b_{eq} \\\\\n l \\le x \\le u\n\\end{aligned}\n$$\nThe problem requires three distinct analyses for each test case, all of which can be formulated as LP problems.\n\n**1. Flux Balance Analysis (FBA) to find the Optimal Objective Value ($z^\\star$)**\n\nThe first task is to calculate the maximum possible value of the metabolic objective, $z^\\star$. This is a classic FBA problem.\nThe optimization problem is defined as:\n$$\nz^\\star = \\max_{\\mathbf{v}} \\{c^\\top \\mathbf{v} \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u\\}\n$$\nwhere $\\mathbf{v} \\in \\mathbb{R}^n$ is the vector of reaction fluxes, $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix, $c \\in \\mathbb{R}^n$ is the objective vector, and $l, u \\in \\mathbb{R}^n$ are the lower and upper bounds on the fluxes, respectively.\n\nTo solve this using a standard LP solver that performs minimization, we reformulate the problem as minimizing the negative of the objective function:\n$$\n-z^\\star = \\min_{\\mathbf{v}} \\{-c^\\top \\mathbf{v}\\}\n$$\nThis directly maps to the standard LP form with:\n- Objective vector: $-c$\n- Equality constraints: $A_{eq} = S$ and $b_{eq} = 0$ (a vector of $m$ zeros).\n- Bounds: The flux bounds $l_j \\le v_j \\le u_j$ for each reaction $j=1, \\dots, n$.\n\nThe optimal value returned by the solver, let's call it $z'_{opt}$, will be $-z^\\star$. Thus, $z^\\star = -z'_{opt}$.\n\n**2. Identification of Blocked Reactions**\n\nA reaction $j$ is defined as blocked if its flux $v_j$ must be zero across all feasible steady-state conditions, irrespective of any metabolic objective. This is determined by finding the minimum and maximum possible flux for each reaction subject only to the fundamental network constraints. For each reaction $j \\in \\{1, \\dots, n\\}$, we solve two LP problems:\n\n- **Minimization**: $\\min\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u\\}$\n- **Maximization**: $\\max\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u\\}$\n\nThe minimization problem maps to an LP with an objective vector $c_{min, j} = e_j$, where $e_j$ is the $j$-th standard basis vector (a vector of zeros with a $1$ at position $j$). The maximization problem is solved by minimizing $-v_j$, which corresponds to an objective vector $c_{max, j} = -e_j$.\n\nA reaction $j$ is blocked if and only if both the minimum and maximum achievable fluxes are equal to $0$ (within a small numerical tolerance $\\epsilon \\approx 10^{-9}$).\n\n**3. Flux Variability Analysis (FVA)**\n\nFVA determines the range of possible flux values for each reaction while ensuring that the primary metabolic objective remains near its optimal value. Given the optimal objective value $z^\\star$ and a retention fraction $\\gamma \\in [0,1]$, we add a new constraint to the system:\n$$\nc^\\top \\mathbf{v} \\ge \\gamma z^\\star\n$$\nThis inequality can be written in the standard $A_{ub}x \\le b_{ub}$ form as:\n$$\n-c^\\top \\mathbf{v} \\le -\\gamma z^\\star\n$$\nFor each reaction $j \\in \\{1, \\dots, n\\}$, we must find its minimum and maximum possible flux values, $[v_j^{\\min}, v_j^{\\max}]$, by solving two LPs:\n\n- **Minimization for $v_j^{\\min}$**:\n$$\nv_j^{\\min} = \\min\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u, \\ c^\\top \\mathbf{v} \\ge \\gamma z^\\star\\}\n$$\nThis corresponds to an LP with objective $e_j$, equality constraints $S\\mathbf{v}=\\mathbf{0}$, bounds $l \\le \\mathbf{v} \\le u$, and the additional inequality constraint $-c^\\top \\mathbf{v} \\le -\\gamma z^\\star$.\n\n- **Maximization for $v_j^{\\max}$**:\n$$\nv_j^{\\max} = \\max\\{v_j \\mid S \\mathbf{v} = \\mathbf{0}, \\ l \\le \\mathbf{v} \\le u, \\ c^\\top \\mathbf{v} \\ge \\gamma z^\\star\\}\n$$\nThis is solved by minimizing $-v_j$ (objective $-e_j$) with the same set of constraints.\n\n**Algorithmic Procedure**\n\nFor each test case provided:\n1.  Define the matrices and vectors $S, l, u, c$ and the scalar $\\gamma$.\n2.  Solve the FBA problem to find $z^\\star = \\max c^\\top \\mathbf{v}$.\n3.  Iterate through each reaction $j=1, \\dots, n$. Solve for $\\min v_j$ and $\\max v_j$ subject to $S \\mathbf{v} = \\mathbf{0}$ and bounds. If both are zero, add index $j-1$ (using zero-based indexing) to a list of blocked reactions.\n4.  Calculate the FVA constraint value, $z_{fva} = \\gamma z^\\star$.\n5.  Iterate through each reaction $j=1, \\dots, n$. Solve for $v_j^{\\min}$ and $v_j^{\\max}$ subject to $S \\mathbf{v} = \\mathbf{0}$, bounds, and the additional constraint $-c^\\top \\mathbf{v} \\le -z_{fva}$. Store the resulting pair $[v_j^{\\min}, v_j^{\\max}]$.\n6.  Assemble the results for the test case into the structure $[z^\\star, \\ \\text{FVA\\_ranges}, \\ \\text{blocked\\_indices}]$.\n7.  After processing all test cases, format the collected results into a single, comma-separated string as specified. Numerical results will be rounded to one decimal place for clarity, and near-zero values resulting from floating-point inaccuracies will be clamped to $0.0$.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of metabolic network analysis problems using FBA and FVA.\n    \"\"\"\n    test_cases = [\n        {\n            \"S\": np.array([\n                [1, -1, 0, 0, 0],\n                [0, 1, -1, 0, -1],\n                [0, 0, 1, -1, 1]\n            ], dtype=float),\n            \"l\": np.array([0, 0, 0, 0, 0], dtype=float),\n            \"u\": np.array([10, 1000, 1000, 1000, 1000], dtype=float),\n            \"c\": np.array([0, 0, 0, 1, 0], dtype=float),\n            \"gamma\": 1.0\n        },\n        {\n            \"S\": np.array([\n                [1, -1, 0, 0, 0, 0],\n                [0, 1, -1, 0, -1, 0],\n                [0, 0, 1, -1, 1, 0],\n                [0, 0, 0, 0, 0, -1],\n                [0, 0, 0, 0, 0, 1]\n            ], dtype=float),\n            \"l\": np.array([0, 0, 0, 0, 0, 0], dtype=float),\n            \"u\": np.array([5, 1000, 1000, 1000, 1000, 100], dtype=float),\n            \"c\": np.array([0, 0, 0, 1, 0, 0], dtype=float),\n            \"gamma\": 1.0\n        },\n        {\n            \"S\": np.array([\n                [1, -1, 0, 0, 0, 1],\n                [0, 1, -1, 0, -1, -1],\n                [0, 0, 1, -1, 1, 0]\n            ], dtype=float),\n            \"l\": np.array([0, 0, 0, 0, 0, 0], dtype=float),\n            \"u\": np.array([8, 1000, 1000, 1000, 1000, 0], dtype=float),\n            \"c\": np.array([0, 0, 0, 1, 0, 0], dtype=float),\n            \"gamma\": 1.0\n        }\n    ]\n\n    TOL = 1e-9\n    final_results = []\n\n    for case in test_cases:\n        S, l, u, c, gamma = case[\"S\"], case[\"l\"], case[\"u\"], case[\"c\"], case[\"gamma\"]\n        m, n = S.shape\n        bounds = list(zip(l, u))\n        b_eq = np.zeros(m)\n        \n        # 1. FBA for z_star\n        # Maximize c'v is equivalent to minimizing -c'v\n        res_fba = linprog(-c, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        z_star = -res_fba.fun if res_fba.success else 0.0\n        if abs(z_star)  TOL: z_star = 0.0\n\n        # 2. Blocked Reaction Analysis\n        blocked_indices = []\n        for j in range(n):\n            # Minimize v_j\n            c_min = np.zeros(n)\n            c_min[j] = 1\n            res_min = linprog(c_min, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs', options={'presolve': True})\n            \n            # Maximize v_j (minimize -v_j)\n            c_max = np.zeros(n)\n            c_max[j] = -1\n            res_max = linprog(c_max, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs', options={'presolve': True})\n\n            min_flux = res_min.fun if res_min.success else float('nan')\n            max_flux = -res_max.fun if res_max.success else float('nan')\n\n            if res_min.success and res_max.success and abs(min_flux)  TOL and abs(max_flux)  TOL:\n                blocked_indices.append(j)\n\n        # 3. FVA\n        fva_ranges = []\n        obj_constraint_val = gamma * z_star\n        # Constraint c'v = gamma*z_star  = -c'v = -gamma*z_star\n        A_ub_fva = -c.reshape(1, -1)\n        b_ub_fva = np.array([-obj_constraint_val])\n\n        for j in range(n):\n            # Minimize v_j\n            c_min = np.zeros(n)\n            c_min[j] = 1.0\n            res_min = linprog(c_min, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n\n            # Maximize v_j\n            c_max = np.zeros(n)\n            c_max[j] = -1.0\n            res_max = linprog(c_max, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n\n            v_j_min = res_min.fun if res_min.success else 0.0\n            v_j_max = -res_max.fun if res_max.success else 0.0\n            \n            # Clamp near-zero values\n            if abs(v_j_min)  TOL: v_j_min = 0.0\n            if abs(v_j_max)  TOL: v_j_max = 0.0\n            \n            fva_ranges.append([v_j_min, v_j_max])\n\n        # Format results for this case\n        z_formatted = f\"{z_star:.1f}\"\n        fva_formatted = '[' + ','.join(f'[{v_min:.1f},{v_max:.1f}]' for v_min, v_max in fva_ranges) + ']'\n        blocked_formatted = str(blocked_indices).replace(\" \", \"\")\n        case_result_str = f'[{z_formatted},{fva_formatted},{blocked_formatted}]'\n        final_results.append(case_result_str)\n\n    # Final print statement\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "4584265"}]}