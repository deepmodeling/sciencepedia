{"hands_on_practices": [{"introduction": "Paired-end sequencing is a cornerstone of modern amplicon analysis, allowing for longer and more accurate profiling of the 16S rRNA gene. The ability to merge the forward and reverse reads into a single, high-quality sequence, however, depends on a sufficient overlap between them. This exercise provides a concrete application of basic interval geometry to a fundamental bioinformatics task, allowing you to determine the feasibility of read merging based on key sequencing parameters. [@problem_id:4537113]", "problem": "A 16S ribosomal ribonucleic acid (rRNA) amplicon from the V4 region is sequenced using Illumina paired-end chemistry with two reads of length $250$ base pairs (bp) each. After adapter and primer trimming, assume that each read consists solely of amplicon-derived sequence and that the amplicon length is $253$ bp. In paired-end sequencing, one read originates from the $5^{\\prime}$ end and the other from the $3^{\\prime}$ end of the same amplicon, and the two reads may overlap within the amplicon. The expected overlap is defined as the number of amplicon positions covered by both reads. A merging algorithm requires a minimum overlap of $20$ bp to attempt unambiguous merging.\n\nUsing only fundamental interval reasoning consistent with this geometry, determine the expected overlap and assess whether unambiguous merging is feasible under the stated minimum requirement. Report, as your final numeric answer, the overlap margin $M$, defined as $M = O - O_{\\min}$, where $O$ is the expected overlap and $O_{\\min}$ is the minimum required overlap. Express your final answer as an integer count of base pairs. No rounding is required.", "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of molecular biology and bioinformatics, specifically concerning paired-end sequencing of DNA amplicons. The problem is well-posed, providing all necessary and consistent data for a unique solution. The terminology is objective and precise.\n\nLet us formalize the geometry of the sequencing reads relative to the amplicon. We are given the following quantities:\n- The length of the first read (forward read), $L_1 = 250$ bp.\n- The length of the second read (reverse read), $L_2 = 250$ bp.\n- The total length of the amplicon, $L_A = 253$ bp.\n- The minimum required overlap for merging, $O_{\\min} = 20$ bp.\n\nThe problem describes a standard paired-end sequencing scenario. The forward read, $R_1$, originates from the $5^{\\prime}$ end of the amplicon and extends for a length $L_1$. The reverse read, $R_2$, originates from the $3^{\\prime}$ end of the same amplicon and extends \"inward\" for a length $L_2$. Since the reads are from the same fragment, they are expected to overlap in the central region of the amplicon if the sum of their lengths, $L_1 + L_2$, is greater than the amplicon length, $L_A$.\n\nThe expected overlap, $O$, can be derived from a simple conservation of length argument. If the two reads were laid end-to-end, their combined length would be $L_1 + L_2$. However, they are both derived from a single fragment of length $L_A$. The extent to which their combined length exceeds the amplicon length is precisely the region covered by both reads, i.e., the overlap. This can be expressed using the principle of inclusion-exclusion for the sets of base positions covered by each read. Let $S_1$ be the set of positions covered by read $R_1$ and $S_2$ be the set of positions covered by read $R_2$. The length of the union, $|S_1 \\cup S_2|$, is the total length of the amplicon, $L_A$, as it is entirely covered. The lengths of the individual reads are $|S_1| = L_1$ and $|S_2| = L_2$. The overlap is the length of the intersection, $O = |S_1 \\cap S_2|$. The principle of inclusion-exclusion states:\n$$|S_1 \\cup S_2| = |S_1| + |S_2| - |S_1 \\cap S_2|$$\nSubstituting the defined variables, we have:\n$$L_A = L_1 + L_2 - O$$\nRearranging this equation to solve for the expected overlap, $O$, yields:\n$$O = L_1 + L_2 - L_A$$\nWe can now substitute the given numerical values into this equation:\n$$O = 250 + 250 - 253$$\n$$O = 500 - 253$$\n$$O = 247 \\text{ bp}$$\nThe expected overlap is $247$ base pairs.\n\nNext, we must assess whether unambiguous merging is feasible. The problem states that the merging algorithm requires a minimum overlap of $O_{\\min} = 20$ bp. Since our calculated expected overlap $O = 247$ bp is greater than the minimum required overlap $O_{\\min} = 20$ bp, the condition for merging is satisfied.\n$$O > O_{\\min} \\implies 247 > 20$$\nTherefore, unambiguous merging is feasible.\n\nFinally, we are asked to calculate the overlap margin, $M$, which is defined as the difference between the expected overlap and the minimum required overlap:\n$$M = O - O_{\\min}$$\nSubstituting the calculated and given values:\n$$M = 247 - 20$$\n$$M = 227 \\text{ bp}$$\nThe overlap margin is $227$ base pairs. This represents the amount of overlap available beyond the minimum requirement for the merging algorithm.", "answer": "$$\\boxed{227}$$", "id": "4537113"}, {"introduction": "Raw read counts from 16S rRNA sequencing experiments do not directly reflect the true abundance of bacterial cells in a community. A significant and well-documented biological bias arises from the variation in the number of 16S rRNA gene copies across different microbial genomes. This practice demonstrates how to mathematically correct for this copy number variation, a critical step for transforming observed sequence proportions into more accurate estimates of microbial community structure. [@problem_id:4537185]", "problem": "In 16S ribosomal RNA (rRNA) amplicon sequencing for microbial community profiling, the observed read count for a taxon is driven by the underlying number of cells and the number of 16S rRNA gene copies per genome, along with sampling depth and amplification efficiency. Under the assumptions that amplification efficiencies are equal across taxa and sampling is unbiased and uniform, the expected observed amplicon count for taxon $i$ is proportional to the product of its unknown absolute cell abundance and its known per-genome 16S rRNA gene copy number. The compositional nature of sequencing data implies that only relative abundances are identifiable, obtained by appropriate normalization.\n\nConsider a single sample with three taxa. Their observed amplicon counts are $[1000, 500, 500]$, and their known 16S rRNA gene copy numbers are $[5, 1, 2]$, in the same order. Using the proportionality principle described above and compositional normalization, derive the copy-number-corrected relative abundances for the three taxa. Report the three values as decimal fractions in the order given, rounded to four significant figures. No units should be used.", "solution": "The problem statement has been critically evaluated and is deemed valid. It is scientifically grounded in the principles of metagenomic analysis, specifically 16S rRNA gene amplicon sequencing, and presents a well-posed quantitative task with all necessary information. The language is objective and precise.\n\nThe central premise is that the observed amplicon count for a given taxon is biased by its genomic 16S rRNA gene copy number. To estimate the true relative abundance of cells, this bias must be corrected. The problem states that, under ideal conditions, the expected observed amplicon count, $C_i$, for taxon $i$ is proportional to the product of its absolute cell abundance, $N_i$, and its per-genome 16S rRNA gene copy number, $G_i$. We can formalize this relationship with a proportionality constant, $k$, which encapsulates system-wide factors such as total sequencing depth:\n$$C_i = k \\cdot N_i \\cdot G_i$$\nThis constant $k$ is identical for all taxa within a single sample. Our objective is to determine the copy-number-corrected relative abundances, which correspond to the relative cell abundances, $R_i$. The relative cell abundance for taxon $i$ is defined as its absolute cell abundance divided by the total absolute cell abundance of all taxa in the community:\n$$R_i = \\frac{N_i}{\\sum_{j} N_j}$$\nTo find an expression for $R_i$ in terms of the observable quantities, we first rearrange the model equation to solve for the unobservable cell abundance, $N_i$:\n$$N_i = \\frac{C_i}{k \\cdot G_i}$$\nSubstituting this expression into the definition of relative abundance $R_i$:\n$$R_i = \\frac{\\frac{C_i}{k \\cdot G_i}}{\\sum_{j} \\frac{C_j}{k \\cdot G_j}}$$\nThe proportionality constant $k$ is common to all terms in the numerator and the denominator, and thus cancels out:\n$$R_i = \\frac{\\frac{C_i}{G_i}}{\\sum_{j} \\frac{C_j}{G_j}}$$\nThis final expression provides the formula for calculating the copy-number-corrected relative abundance of taxon $i$ from its observed amplicon count $C_i$ and its known gene copy number $G_i$. The term $C_i / G_i$ can be interpreted as the corrected count, and the denominator is a normalization factor equal to the sum of all corrected counts.\n\nThe problem provides the following data for three taxa ($i = 1, 2, 3$):\nObserved amplicon counts: $C = \\begin{pmatrix} C_1 & C_2 & C_3 \\end{pmatrix} = \\begin{pmatrix} 1000 & 500 & 500 \\end{pmatrix}$.\n16S rRNA gene copy numbers: $G = \\begin{pmatrix} G_1 & G_2 & G_3 \\end{pmatrix} = \\begin{pmatrix} 5 & 1 & 2 \\end{pmatrix}$.\n\nFirst, we calculate the corrected count, $C_i/G_i$, for each taxon. These values are proportional to the true cell abundances.\nFor taxon 1:\n$$\\frac{C_1}{G_1} = \\frac{1000}{5} = 200$$\nFor taxon 2:\n$$\\frac{C_2}{G_2} = \\frac{500}{1} = 500$$\nFor taxon 3:\n$$\\frac{C_3}{G_3} = \\frac{500}{2} = 250$$\n\nNext, we compute the normalization factor, which is the sum of these corrected counts:\n$$\\sum_{j=1}^{3} \\frac{C_j}{G_j} = 200 + 500 + 250 = 950$$\n\nFinally, we calculate the relative abundance for each taxon by dividing its corrected count by the normalization factor.\n\nFor taxon 1:\n$$R_1 = \\frac{200}{950} \\approx 0.2105263...$$\nFor taxon 2:\n$$R_2 = \\frac{500}{950} \\approx 0.5263157...$$\nFor taxon 3:\n$$R_3 = \\frac{250}{950} \\approx 0.2631578...$$\n\nThe problem requires the results to be reported as decimal fractions rounded to four significant figures.\n$R_1 \\approx 0.2105$\n$R_2 \\approx 0.5263$\n$R_3 \\approx 0.2632$\n\nThese three values represent the copy-number-corrected relative abundances for the three taxa.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2105 & 0.5263 & 0.2632\n\\end{pmatrix}\n}\n$$", "id": "4537185"}, {"introduction": "A central task in microbiome analysis is to quantify the difference, or dissimilarity, between microbial communities in different samples. Different beta diversity metrics capture distinct aspects of community structure, such as changes in membership versus changes in abundance, and some are specifically designed to handle the compositional nature of sequencing data. By calculating and contrasting the Bray-Curtis, Jaccard, and Aitchison distances on the same dataset, this exercise reveals how the choice of metric can influence ecological conclusions and highlights the unique strengths of compositionally-aware methods. [@problem_id:4537288]", "problem": "A clinical microbiome study uses 16S ribosomal ribonucleic acid (rRNA) amplicon sequencing to profile bacterial communities in two stool samples across three operational taxonomic units (OTUs). The observed count vectors are $[30, 20, 0]$ for Sample $\\mathsf{A}$ and $[10, 10, 20]$ for Sample $\\mathsf{B}$. Starting from the foundational facts that (i) count data reflect read allocations across taxa, (ii) relative abundances are compositional, constrained to sum to $1$ (the simplex), and (iii) dissimilarities are functions that map pairs of samples to nonnegative real scalars reflecting ecological difference, do the following:\n- Compute the Bray–Curtis dissimilarity between the two samples using the standard abundance-based definition on nonnegative counts.\n- Compute the incidence-based Jaccard distance using presence/absence across the three OTUs, treating any strictly positive count as present and zero as absent.\n- Compute the Aitchison distance by first constructing compositions via adding a symmetric pseudocount $\\gamma = 0.5$ to each count to ensure strict positivity, applying closure to obtain relative abundances that sum to $1$, transforming each composition with the centered log-ratio transform $\\operatorname{clr}$, and then taking the Euclidean distance in $\\operatorname{clr}$ space. Explicitly, for a composition $x = (x_{1}, x_{2}, x_{3})$ with $x_{i} > 0$ and $\\sum_{i} x_{i} = 1$, define $\\operatorname{clr}(x) = \\left(\\ln\\!\\left(\\frac{x_{1}}{g(x)}\\right), \\ln\\!\\left(\\frac{x_{2}}{g(x)}\\right), \\ln\\!\\left(\\frac{x_{3}}{g(x)}\\right)\\right)$ where $g(x)$ is the geometric mean $g(x) = (x_{1} x_{2} x_{3})^{1/3}$; the Aitchison distance is the Euclidean norm of the difference of the two $\\operatorname{clr}$ vectors.\n- Briefly explain, in terms of these definitions and the compositional constraint, how the three distances differ in their sensitivity to rare taxa.\n\nRound each of the three numerical distances to four significant figures and express them as unitless decimal values. Report your final three values in a single row matrix in the order: Bray–Curtis, Jaccard, Aitchison.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and complete. It describes a standard bioinformatics task with clearly defined inputs, methods, and desired outputs. All provided formulas and concepts—Bray–Curtis dissimilarity, Jaccard distance, and Aitchison distance via the centered log-ratio (clr) transform—are standard in microbial ecology and compositional data analysis. The problem is therefore deemed valid and a full solution follows.\n\nLet the observed count vectors for the three operational taxonomic units (OTUs) in Sample $\\mathsf{A}$ and Sample $\\mathsf{B}$ be denoted by $C_A$ and $C_B$, respectively.\n$$C_A = \\begin{pmatrix} 30 & 20 & 0 \\end{pmatrix}$$\n$$C_B = \\begin{pmatrix} 10 & 10 & 20 \\end{pmatrix}$$\nLet the individual counts be denoted $y_{A,i}$ and $y_{B,i}$ for $i \\in \\{1, 2, 3\\}$.\n\n**1. Bray–Curtis Dissimilarity**\n\nThe Bray–Curtis dissimilarity, $D_{BC}$, between two samples is defined as the sum of absolute differences in counts, normalized by the sum of all counts in both samples.\n$$D_{BC}(A, B) = \\frac{\\sum_{i=1}^{3} |y_{A,i} - y_{B,i}|}{\\sum_{i=1}^{3} (y_{A,i} + y_{B,i})}$$\nThe numerator is calculated as:\n$$\\sum_{i=1}^{3} |y_{A,i} - y_{B,i}| = |30 - 10| + |20 - 10| + |0 - 20| = 20 + 10 + 20 = 50$$\nThe denominator is calculated as:\n$$\\sum_{i=1}^{3} (y_{A,i} + y_{B,i}) = (30 + 10) + (20 + 10) + (0 + 20) = 40 + 30 + 20 = 90$$\nThus, the Bray–Curtis dissimilarity is:\n$$D_{BC}(A, B) = \\frac{50}{90} = \\frac{5}{9} \\approx 0.555555...$$\nRounding to four significant figures gives $0.5556$.\n\n**2. Jaccard Distance**\n\nThe Jaccard distance is an incidence-based metric. First, the count vectors are converted to presence/absence vectors, where $1$ denotes presence (count $> 0$) and $0$ denotes absence (count $= 0$).\n$$P_A = \\begin{pmatrix} 1 & 1 & 0 \\end{pmatrix}$$\n$$P_B = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}$$\nLet $a$ be the number of OTUs present in both samples (co-presence), $b$ be the number of OTUs present in $\\mathsf{A}$ but not $\\mathsf{B}$, and $c$ be the number of OTUs present in $\\mathsf{B}$ but not $\\mathsf{A}$.\n- OTU 1: Present in both $\\mathsf{A}$ and $\\mathsf{B}$.\n- OTU 2: Present in both $\\mathsf{A}$ and $\\mathsf{B}$.\n- OTU 3: Absent in $\\mathsf{A}$, present in $\\mathsf{B}$.\nFrom this, we have $a = 2$, $b = 0$, and $c = 1$.\nThe Jaccard index, $J$, is the ratio of the size of the intersection to the size of the union of the sets of present OTUs, $J = \\frac{a}{a+b+c}$. The Jaccard distance, $D_J$, is defined as $1 - J$.\n$$D_J(A, B) = 1 - \\frac{a}{a+b+c} = \\frac{b+c}{a+b+c}$$\nSubstituting the values:\n$$D_J(A, B) = \\frac{0 + 1}{2 + 0 + 1} = \\frac{1}{3} \\approx 0.333333...$$\nRounding to four significant figures gives $0.3333$.\n\n**3. Aitchison Distance**\n\nThe calculation of the Aitchison distance proceeds in several steps as defined.\nFirst, a pseudocount of $\\gamma = 0.5$ is added to each count to handle the zero value.\n$$C'_A = \\begin{pmatrix} 30+0.5, & 20+0.5, & 0+0.5 \\end{pmatrix} = \\begin{pmatrix} 30.5 & 20.5 & 0.5 \\end{pmatrix}$$\n$$C'_B = \\begin{pmatrix} 10+0.5, & 10+0.5, & 20+0.5 \\end{pmatrix} = \\begin{pmatrix} 10.5 & 10.5 & 20.5 \\end{pmatrix}$$\nSecond, these vectors are closed to form compositions (relative abundances) that sum to $1$.\nThe total sum for $C'_A$ is $N_A = 30.5 + 20.5 + 0.5 = 51.5$.\nThe total sum for $C'_B$ is $N_B = 10.5 + 10.5 + 20.5 = 41.5$.\nThe compositional vectors $x_A$ and $x_B$ are:\n$$x_A = \\begin{pmatrix} \\frac{30.5}{51.5}, & \\frac{20.5}{51.5}, & \\frac{0.5}{51.5} \\end{pmatrix} \\approx \\begin{pmatrix} 0.59223 & 0.39806 & 0.00971 \\end{pmatrix}$$\n$$x_B = \\begin{pmatrix} \\frac{10.5}{41.5}, & \\frac{10.5}{41.5}, & \\frac{20.5}{41.5} \\end{pmatrix} \\approx \\begin{pmatrix} 0.25301 & 0.25301 & 0.49398 \\end{pmatrix}$$\nThird, we apply the centered log-ratio ($\\operatorname{clr}$) transform. For a composition $x = (x_1, x_2, x_3)$, $\\operatorname{clr}(x) = (\\ln(x_1/g(x)), \\ln(x_2/g(x)), \\ln(x_3/g(x)))$, where $g(x) = (x_1 x_2 x_3)^{1/3}$ is the geometric mean. An equivalent calculation is $\\operatorname{clr}(x)_i = \\ln(x_i) - \\frac{1}{3}\\sum_{j=1}^3 \\ln(x_j)$.\n\nFor $x_A$:\nMean of log-abundances: $\\frac{1}{3} (\\ln(\\frac{30.5}{51.5}) + \\ln(\\frac{20.5}{51.5}) + \\ln(\\frac{0.5}{51.5})) \\approx -2.0265$.\n$$\\operatorname{clr}(x_A) \\approx \\begin{pmatrix} \\ln(0.59223) - (-2.0265), & \\ln(0.39806) - (-2.0265), & \\ln(0.00971) - (-2.0265) \\end{pmatrix}$$\n$$\\operatorname{clr}(x_A) \\approx \\begin{pmatrix} -0.5238 + 2.0265, & -0.9211 + 2.0265, & -4.6347 + 2.0265 \\end{pmatrix}$$\n$$\\operatorname{clr}(x_A) \\approx \\begin{pmatrix} 1.5027 & 1.1054 & -2.6081 \\end{pmatrix}$$\n\nFor $x_B$:\nMean of log-abundances: $\\frac{1}{3} (\\ln(\\frac{10.5}{41.5}) + \\ln(\\frac{10.5}{41.5}) + \\ln(\\frac{20.5}{41.5})) \\approx -1.1513$.\n$$\\operatorname{clr}(x_B) \\approx \\begin{pmatrix} \\ln(0.25301) - (-1.1513), & \\ln(0.25301) - (-1.1513), & \\ln(0.49398) - (-1.1513) \\end{pmatrix}$$\n$$\\operatorname{clr}(x_B) \\approx \\begin{pmatrix} -1.3743 + 1.1513, & -1.3743 + 1.1513, & -0.7052 + 1.1513 \\end{pmatrix}$$\n$$\\operatorname{clr}(x_B) \\approx \\begin{pmatrix} -0.2230 & -0.2230 & 0.4461 \\end{pmatrix}$$\n\nFinally, the Aitchison distance $d_A$ is the Euclidean distance between the $\\operatorname{clr}$-transformed vectors.\n$$d_A(A, B) = \\sqrt{\\sum_{i=1}^{3} (\\operatorname{clr}(x_A)_i - \\operatorname{clr}(x_B)_i)^2}$$\n$$d_A(A, B) \\approx \\sqrt{(1.5027 - (-0.2230))^2 + (1.1054 - (-0.2230))^2 + (-2.6081 - 0.4461)^2}$$\n$$d_A(A, B) \\approx \\sqrt{(1.7257)^2 + (1.3284)^2 + (-3.0542)^2}$$\n$$d_A(A, B) \\approx \\sqrt{2.9780 + 1.7646 + 9.3281} = \\sqrt{14.0707} \\approx 3.75109...$$\nRounding to four significant figures gives $3.751$.\n\n**Explanation of Sensitivity to Rare Taxa**\n\nThe three distances differ fundamentally in how they handle abundance information, which dictates their sensitivity to rare taxa.\n\n- **Bray–Curtis dissimilarity** is an abundance-based metric where contributions to the distance are proportional to the counts. Both the numerator ($\\sum |y_{A,i} - y_{B,i}|$) and denominator ($\\sum (y_{A,i} + y_{B,i})$) are dominated by the most abundant taxa. A change in a rare taxon's count has a negligible effect on the total sum of differences and the total sum of counts. Consequently, Bray–Curtis is insensitive to variations in rare taxa.\n\n- **Jaccard distance** is an incidence-based metric that operates on presence/absence data. It gives equal weight to all taxa that are present, regardless of their abundance. A taxon with a count of $1$ has the same influence as a taxon with a count of $10^5$. Therefore, this distance is highly sensitive to changes in the presence or absence of taxa, making it particularly responsive to the dynamics of rare taxa, which are most likely to appear or disappear from samples.\n\n- **Aitchison distance** is based on the log-ratios of relative abundances. The logarithm function inherently up-weights the importance of relative changes in low-abundance components. A change in count from $1$ to $2$ represents a $100\\%$ relative increase, which leads to a substantial change in the log-transformed value $(\\ln(2))$. In contrast, a change from $1000$ to $1001$ is only a $0.1\\%$ relative increase and results in a minuscule change in the log-transformed data. By being sensitive to relative (or fold) changes rather than absolute differences in counts, the Aitchison distance is much more sensitive to shifts in rare and low-abundance taxa than the Bray-Curtis dissimilarity.", "answer": "$$\\boxed{\\begin{pmatrix} 0.5556 & 0.3333 & 3.751 \\end{pmatrix}}$$", "id": "4537288"}]}