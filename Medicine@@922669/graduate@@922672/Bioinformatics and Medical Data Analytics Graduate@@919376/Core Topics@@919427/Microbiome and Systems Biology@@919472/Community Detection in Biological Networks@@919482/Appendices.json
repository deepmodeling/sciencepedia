{"hands_on_practices": [{"introduction": "A deep understanding of community detection begins with mastering the calculation of its core metric, modularity. This exercise provides a foundational workout, tasking you with computing the modularity $Q$ for a small directed network from first principles. By explicitly handling the in-degrees and out-degrees, you will gain a concrete intuition for how modularity compares an observed network structure to a random null model [@problem_id:4365539].", "problem": "In systems biomedicine, community detection in directed biomolecular interaction networks such as a Gene Regulatory Network (GRN) is often quantified by a scalar quantity called network modularity, which measures how much a given partition concentrates edges within communities beyond what would be expected under a random null model that preserves the in-degree and out-degree sequences. Consider a directed network with nodes $1$, $2$, and $3$, and directed edges $1 \\to 2$, $2 \\to 3$, and $3 \\to 1$. Let the partition of nodes be $\\{\\{1,2\\},\\{3\\}\\}$, where nodes $1$ and $2$ form one community and node $3$ is alone in the other community. Using the standard configuration-model null ensemble for directed networks that preserves the in-degree and out-degree of each node, compute the modularity $Q$ for this partition. Your computation must proceed by first explicitly calculating the in-degree $k_{i}^{\\text{in}}$ and out-degree $k_{i}^{\\text{out}}$ for each node $i \\in \\{1,2,3\\}$, then evaluating the observed within-community edge count and its expectation under the null model, and finally assembling these into the modularity $Q$ for the specified partition. Express your final answer as an exact rational number, with no rounding.", "solution": "The problem requires the computation of the modularity, $Q$, for a given partition of a specific directed network. The modularity for a directed network measures the extent to which edges are concentrated within communities compared to a random null model. The standard definition of modularity, $Q$, for a partition of a directed network into a set of communities $\\{c\\}$ is given by:\n\n$$ Q = \\frac{1}{M} \\sum_{i,j} \\left[ A_{ij} - P_{ij} \\right] \\delta(c_i, c_j) $$\n\nwhere:\n- $M$ is the total number of edges in the network.\n- $A_{ij}$ is the adjacency matrix element, equal to $1$ if a directed edge exists from node $i$ to node $j$, and $0$ otherwise.\n- $P_{ij}$ is the probability of an edge existing from node $i$ to node $j$ in the configuration null model, given by $P_{ij} = \\frac{k_i^{\\text{out}} k_j^{\\text{in}}}{M}$. Here, $k_i^{\\text{out}}$ is the out-degree of node $i$ and $k_j^{\\text{in}}$ is the in-degree of node $j$.\n- $c_i$ is the community assignment of node $i$.\n- $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if nodes $i$ and $j$ are in the same community ($c_i = c_j$) and $0$ otherwise.\n\nThe calculation will proceed by following the steps outlined in the problem statement.\n\nFirst, we identify the network's properties from the problem description.\nThe network has nodes $V = \\{1, 2, 3\\}$.\nThe directed edges are $1 \\to 2$, $2 \\to 3$, and $3 \\to 1$.\nThe total number of edges is $M=3$.\nThe adjacency matrix $A$ is:\n$$ A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix} $$\n\nThe specified partition is $\\{\\{1,2\\},\\{3\\}\\}$. Let's denote community $C_1 = \\{1, 2\\}$ and community $C_2 = \\{3\\}$.\n\n**Step 1: Calculate the in-degree and out-degree for each node.**\n\n- For node $1$: There is one outgoing edge ($1 \\to 2$) and one incoming edge ($3 \\to 1$).\n  $$ k_1^{\\text{out}} = 1, \\quad k_1^{\\text{in}} = 1 $$\n- For node $2$: There is one outgoing edge ($2 \\to 3$) and one incoming edge ($1 \\to 2$).\n  $$ k_2^{\\text{out}} = 1, \\quad k_2^{\\text{in}} = 1 $$\n- For node $3$: There is one outgoing edge ($3 \\to 1$) and one incoming edge ($2 \\to 3$).\n  $$ k_3^{\\text{out}} = 1, \\quad k_3^{\\text{in}} = 1 $$\nThe sum of out-degrees is $\\sum_{i} k_i^{\\text{out}} = 1+1+1=3$, and the sum of in-degrees is $\\sum_{j} k_j^{\\text{in}} = 1+1+1=3$. Both sums are equal to the total number of edges $M$, as expected.\n\n**Step 2: Evaluate the observed within-community edge count.**\n\nThe modularity formula can be expressed as the difference between the fraction of edges that are within communities and the expected fraction of such edges in the null model.\nThe fraction of edges within communities is given by $\\frac{1}{M}\\sum_{i,j} A_{ij} \\delta(c_i, c_j)$.\nWe sum the number of edges that start and end in the same community.\n- For community $C_1 = \\{1, 2\\}$, we check for edges $(i,j)$ where $i,j \\in \\{1,2\\}$. The only such edge is $1 \\to 2$. Thus, the number of internal edges is $L_{C_1} = 1$.\n- For community $C_2 = \\{3\\}$, we check for edges $(i,j)$ where $i,j \\in \\{3\\}$. There are no self-loops on node $3$. Thus, the number of internal edges is $L_{C_2} = 0$.\n\nThe total number of observed within-community edges is $L = L_{C_1} + L_{C_2} = 1 + 0 = 1$.\nThe fraction of observed within-community edges is $\\frac{L}{M} = \\frac{1}{3}$.\n\n**Step 3: Evaluate the expected within-community edge count under the null model.**\n\nThe expected fraction of edges within communities is given by $\\frac{1}{M}\\sum_{i,j} P_{ij} \\delta(c_i, c_j) = \\frac{1}{M^2}\\sum_{i,j} k_i^{\\text{out}} k_j^{\\text{in}} \\delta(c_i, c_j)$.\nThis term can be calculated by summing the contributions from each community. Let $K_c^{\\text{out}} = \\sum_{i \\in c} k_i^{\\text{out}}$ and $K_c^{\\text{in}} = \\sum_{j \\in c} k_j^{\\text{in}}$. The expected fraction is $\\sum_{c} \\frac{K_c^{\\text{out}} K_c^{\\text{in}}}{M^2}$.\n\n- For community $C_1 = \\{1, 2\\}$:\n  The total out-degree is $K_{C_1}^{\\text{out}} = k_1^{\\text{out}} + k_2^{\\text{out}} = 1 + 1 = 2$.\n  The total in-degree is $K_{C_1}^{\\text{in}} = k_1^{\\text{in}} + k_2^{\\text{in}} = 1 + 1 = 2$.\n  The expected fraction of edges within $C_1$ is $\\frac{K_{C_1}^{\\text{out}} K_{C_1}^{\\text{in}}}{M^2} = \\frac{2 \\times 2}{3^2} = \\frac{4}{9}$.\n\n- For community $C_2 = \\{3\\}$:\n  The total out-degree is $K_{C_2}^{\\text{out}} = k_3^{\\text{out}} = 1$.\n  The total in-degree is $K_{C_2}^{\\text{in}} = k_3^{\\text{in}} = 1$.\n  The expected fraction of edges within $C_2$ is $\\frac{K_{C_2}^{\\text{out}} K_{C_2}^{\\text{in}}}{M^2} = \\frac{1 \\times 1}{3^2} = \\frac{1}{9}$.\n\nThe total expected fraction of within-community edges is the sum of these contributions:\n$$ \\frac{4}{9} + \\frac{1}{9} = \\frac{5}{9} $$\n\n**Step 4: Assemble these components to compute the modularity $Q$.**\n\nThe modularity $Q$ is the difference between the observed fraction of within-community edges and the expected fraction:\n$$ Q = (\\text{Observed fraction}) - (\\text{Expected fraction}) $$\n$$ Q = \\frac{1}{3} - \\frac{5}{9} $$\nTo subtract, we find a common denominator, which is $9$:\n$$ Q = \\frac{3}{9} - \\frac{5}{9} = -\\frac{2}{9} $$\n\nThe modularity for the given partition is $-\\frac{2}{9}$. The negative value indicates that the given partition has fewer internal edges than would be expected at random under the specified configuration null model.", "answer": "$$\\boxed{-\\frac{2}{9}}$$", "id": "4365539"}, {"introduction": "While modularity is a powerful tool, it is not without its pitfalls, the most famous of which is the resolution limit. This practice challenges you to move beyond simple application and analytically derive the conditions under which modularity maximization fails to resolve small, well-defined communities in a synthetic network [@problem_id:4549351]. Successfully navigating this derivation will provide a crucial insight into a fundamental limitation of this widely used community detection method.", "problem": "Consider a Protein-Protein Interaction (PPI) network modeled as an undirected simple graph in which protein complexes form densely interconnected modules linked sparsely in a cyclic topology. Let there be $L$ modules, each modeled as a complete graph on $c$ nodes (a clique $K_c$). Consecutive modules are connected by exactly one inter-module edge, forming a ring. There are no other inter-module edges. Let $A_{ij}$ be the adjacency matrix of the network, $k_i$ the degree of node $i$, and let the generalized modularity with resolution parameter $\\gamma$ be defined by\n$$\nQ_{\\gamma} \\equiv \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\gamma \\frac{k_i k_j}{2m} \\right] \\delta(c_i,c_j),\n$$\nwhere $m$ is the total number of edges, and $\\delta(c_i,c_j)$ is $1$ if nodes $i$ and $j$ are assigned to the same community and $0$ otherwise.\n\nUsing only these definitions and first-principles counting arguments, compare the modularity $Q_{\\gamma}$ of two partitions: (i) the partition where each clique is its own community, and (ii) the partition where two adjacent cliques are merged into a single community while all other cliques remain separate. By analyzing the change in $Q_{\\gamma}$, derive the condition under which merging two adjacent modules increases modularity when $\\gamma=1$. From this condition, determine the minimal ring size threshold $L^{\\ast}(c)$, expressed solely in terms of $c$, such that for any $L > L^{\\ast}(c)$ the optimal modularity at $\\gamma=1$ favors merging two adjacent cliques rather than keeping all cliques separate.\n\nExpress your final answer as a single closed-form symbolic expression in terms of $c$. No numerical evaluation is required.", "solution": "First, we characterize the properties of the network based on the provided description.\n\n**Network Parameters**\n1.  **Total Number of Nodes ($N$)**: There are $L$ modules, each with $c$ nodes. The total number of nodes is $N = Lc$.\n2.  **Total Number of Edges ($m$)**:\n    -   The number of edges within a single $K_c$ module is $\\binom{c}{2} = \\frac{c(c-1)}{2}$. For $L$ modules, the total number of intra-module edges is $L \\frac{c(c-1)}{2}$.\n    -   The $L$ modules are arranged in a ring, with each of the $L$ connections between consecutive modules consisting of a single edge. This gives $L$ inter-module edges.\n    -   The total number of edges is the sum of intra- and inter-module edges:\n        $$m = L \\frac{c(c-1)}{2} + L = L \\left( \\frac{c^2 - c + 2}{2} \\right)$$\n3.  **Node Degrees ($k_i$) and Community Degree Sum ($K_C$)**:\n    -   Within each module (clique), each node has $c-1$ internal connections.\n    -   Each module is connected to two other modules in the ring. These two inter-module edges must be incident on nodes within the module. We assume these two edges are incident on two distinct nodes. Thus, in each module, there are:\n        -   $2$ \"corner\" nodes, each connected to one external node. Their degree is $k_{corner} = (c-1) + 1 = c$.\n        -   $c-2$ \"internal\" nodes with no external connections. Their degree is $k_{internal} = c-1$.\n        (This assumes $c \\ge 2$. If $c=1$, a module is a single node with degree $2$, and the framework remains consistent).\n    -   Let's consider a single clique as a community $C$. The sum of the degrees of all nodes in this community is:\n        $$K_C = \\sum_{i \\in C} k_i = 2 \\cdot k_{corner} + (c-2) \\cdot k_{internal} = 2c + (c-2)(c-1)$$\n        $$K_C = 2c + c^2 - 3c + 2 = c^2 - c + 2$$\n    -   By symmetry, every one of the $L$ cliques, when considered as a community, has the same degree sum $K_C = c^2 - c + 2$.\n\n**Change in Modularity upon Merging**\nThe modularity $Q_{\\gamma}$ can be expressed as a sum over communities $C$:\n$$Q_{\\gamma} = \\sum_{C} \\left( \\frac{e_C}{m} - \\gamma \\left(\\frac{K_C}{2m}\\right)^2 \\right)$$\nwhere $e_C$ is the number of internal edges in community $C$, and $K_C$ is the sum of degrees of nodes in $C$.\n\nWhen two communities, $C_1$ and $C_2$, are merged into a new community $C_{12}$, the change in modularity is given by:\n$$\\Delta Q_{\\gamma} = Q_{\\gamma}(C_{12}) - (Q_{\\gamma}(C_1) + Q_{\\gamma}(C_2))$$\nLet $e_{12}^{\\text{inter}}$ be the number of edges connecting $C_1$ and $C_2$. The internal edges of the new community are $e_{12} = e_1 + e_2 + e_{12}^{\\text{inter}}$, and the degree sum is $K_{12} = K_1 + K_2$. The change simplifies to:\n$$\\Delta Q_{\\gamma} = \\frac{e_{12}^{\\text{inter}}}{m} - \\frac{2\\gamma K_1 K_2}{(2m)^2} = \\frac{1}{m} \\left( e_{12}^{\\text{inter}} - \\frac{\\gamma K_1 K_2}{2m} \\right)$$\n\n**Applying to the Specific Partitions**\nWe are comparing partition (i), where each clique is a community, with partition (ii), where two adjacent cliques, say $C_1$ and $C_2$, are merged. We use the formula for $\\Delta Q_{\\gamma}$ to find the change.\n\n-   The number of edges between two adjacent cliques $C_1$ and $C_2$ is given as $e_{12}^{\\text{inter}} = 1$.\n-   The sum of degrees for each of these clique communities is $K_1 = K_2 = c^2 - c + 2$.\n-   The total number of edges is $m = L \\frac{c^2 - c + 2}{2}$, which implies $2m = L(c^2 - c + 2)$.\n\nSubstituting these into the expression for $\\Delta Q_{\\gamma}$:\n$$\\Delta Q_{\\gamma} = \\frac{1}{m} \\left( 1 - \\frac{\\gamma (c^2 - c + 2)(c^2 - c + 2)}{2m} \\right)$$\n$$\\Delta Q_{\\gamma} = \\frac{1}{m} \\left( 1 - \\frac{\\gamma (c^2 - c + 2)^2}{L(c^2 - c + 2)} \\right)$$\n$$\\Delta Q_{\\gamma} = \\frac{1}{m} \\left( 1 - \\frac{\\gamma (c^2 - c + 2)}{L} \\right)$$\n\n**Deriving the Threshold Condition**\nThe problem asks for the condition under which merging increases modularity, which means $\\Delta Q_{\\gamma} > 0$. We are instructed to use $\\gamma=1$.\n$$\\Delta Q_{1} = \\frac{1}{m} \\left( 1 - \\frac{c^2 - c + 2}{L} \\right) > 0$$\nSince $m$, the total number of edges, is positive, this inequality is equivalent to:\n$$1 - \\frac{c^2 - c + 2}{L} > 0$$\n$$1 > \\frac{c^2 - c + 2}{L}$$\nSince $L$ is the number of modules, $L > 0$. Also, for any $c \\ge 1$, the term $c^2-c+2 = c(c-1)+2$ is positive. We can multiply by $L$ without changing the inequality direction:\n$$L > c^2 - c + 2$$\n\nThis inequality gives the condition on the ring size $L$ for which merging two adjacent cliques is favorable compared to keeping them separate.\n\n**Minimal Ring Size Threshold $L^{\\ast}(c)$**\nThe problem asks for the minimal threshold $L^{\\ast}(c)$ such that for any $L > L^{\\ast}(c)$, merging is favored. Our derived condition is precisely of this form: $L > c^2 - c + 2$.\nTherefore, the threshold $L^{\\ast}(c)$ is the quantity on the right-hand side of the inequality.\n\n$$L^{\\ast}(c) = c^2 - c + 2$$\n\nFor any number of modules $L$ greater than this value, the modularity of the network is increased by merging a pair of adjacent cliques. This signifies that the partition with all cliques kept separate is not optimal for a sufficiently large ring.", "answer": "$$\n\\boxed{c^{2} - c + 2}\n$$", "id": "4549351"}, {"introduction": "Real-world biological analysis often benefits from integrating prior knowledge, and community detection is no exception. This problem explores how to guide modularity maximization using experimental evidence in the form of must-link and cannot-link constraints, effectively creating a semi-supervised learning framework [@problem_id:4549333]. By analyzing an augmented objective function, $Q_{\\text{aug}}$, you will confront the trade-offs between leveraging prior information and the risk of introducing biases that could obscure novel discoveries.", "problem": "A systems biologist seeks modules in a Protein-Protein Interaction (PPI) network by maximizing network modularity. Let the undirected, unweighted graph be represented by an adjacency matrix $A \\in \\{0,1\\}^{n \\times n}$ with degree sequence $\\{k_i\\}_{i=1}^n$ and total edge count $m = \\tfrac{1}{2} \\sum_{i} k_i$. The standard modularity under the configuration-model null is defined by\n$$\nQ(\\mathbf{g}) \\;=\\; \\frac{1}{2m} \\sum_{i,j} \\left( A_{ij} - \\frac{k_i k_j}{2m} \\right) \\, \\delta(g_i,g_j),\n$$\nwhere $g_i \\in \\{1,\\dots,K\\}$ is the community label of node $i$ and $\\delta(\\cdot,\\cdot)$ is the Kronecker delta. Suppose independent experiments yield pairwise constraints: a must-link set $\\mathcal{M}$ of node pairs believed to be in the same module (e.g., co-immunoprecipitation), and a cannot-link set $\\mathcal{C}$ of node pairs believed to be in different modules (e.g., antagonistic genetic interactions). To guide community detection, the biologist considers the augmented objective\n$$\nQ_{\\text{aug}}(\\mathbf{g};\\mu,\\lambda) \\;=\\; Q(\\mathbf{g}) \\;-\\; \\lambda \\sum_{(i,j)\\in \\mathcal{C}} \\delta(g_i,g_j) \\;-\\; \\mu \\sum_{(i,j)\\in \\mathcal{M}} \\big(1 - \\delta(g_i,g_j)\\big),\n$$\nwith nonnegative weights $\\mu$ and $\\lambda$.\n\nConsider the PPI subnetwork on $6$ proteins with edges forming two triangles joined by a single inter-triangle link: edges are $\\{(1,2),(2,3),(1,3)\\}$, $\\{(4,5),(5,6),(4,6)\\}$, and $(3,4)$. Let $\\mathcal{M}=\\{(3,4)\\}$ (a must-link from co-complex evidence) and $\\mathcal{C}=\\{(2,5)\\}$ (a cannot-link from antagonistic interaction). Compare the two partitions $\\mathbf{g}_A$ with communities $\\{1,2,3\\}$ and $\\{4,5,6\\}$ versus $\\mathbf{g}_B$ with communities $\\{1,2\\}$ and $\\{3,4,5,6\\}$, and assume $\\mu = 0.30$ and $\\lambda = 0.15$.\n\nFrom first principles and the definitions provided, analyze how must-link and cannot-link constraints guide the optimization of $Q_{\\text{aug}}$ and what risks they introduce, then select all correct statements below.\n\nA. Interpreting the augmented objective as adding pairwise Potts-model penalties that act like virtual positive affinity for must-links and virtual negative affinity for cannot-links, the constraints bias the optimizer toward partitions that satisfy them; in the example with $\\mu = 0.30$ and $\\lambda = 0.15$, $\\mathbf{g}_B$ achieves a larger $Q_{\\text{aug}}$ than $\\mathbf{g}_A$ because it satisfies the must-link $(3,4)$.\n\nB. Since constraints are experimentally derived, optimizing $Q_{\\text{aug}}$ cannot introduce bias; it strictly reduces estimator variance without affecting the expected rate of discovering novel modules.\n\nC. Sending $\\mu \\to \\infty$ and $\\lambda \\to \\infty$ is always optimal because it enforces ground truth; even if some constraints are noisy, this cannot harm identification of true biological modules.\n\nD. A principled mitigation for constraint-induced bias is to tune $(\\mu,\\lambda)$ by cross-validation on constraints: fit with a subset of $\\mathcal{M}$ and $\\mathcal{C}$ and evaluate predictive accuracy on held-out constrained pairs, thereby promoting out-of-sample generalization and preserving capacity to discover unexpected modules.\n\nE. Enforcing must-links by collapsing each must-linked pair into a single supernode is guaranteed not to affect modularity’s resolution limit and thus cannot create artificially large communities.\n\nF. Modifying the null model by redefining $P_{ij}=\\tfrac{k_i k_j}{2m}$ to force $P_{ij}=0$ for cannot-link pairs and large $P_{ij}$ for must-link pairs preserves the configuration-model interpretation and is universally preferable to adding penalty terms because it does not change the feasible set of partitions.\n\nSelect all that apply.", "solution": "First, we analyze the provided example network to compare the partitions $\\mathbf{g}_A$ and $\\mathbf{g}_B$.\n\nThe network has $n=6$ nodes. The edges are $\\{(1,2),(2,3),(1,3)\\}$, $\\{(4,5),(5,6),(4,6)\\}$, and $(3,4)$.\nThe total number of edges is $m = 7$.\nThe degrees of the nodes are:\n$k_1 = 2$\n$k_2 = 2$\n$k_3 = 3$\n$k_4 = 3$\n$k_5 = 2$\n$k_6 = 2$\nThe sum of degrees is $\\sum_{i=1}^6 k_i = 14 = 2m$, which is correct.\n\nThe standard modularity is given by $Q(\\mathbf{g}) = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left(\\frac{d_c}{2m}\\right)^2 \\right]$, where $L_c$ is the number of intra-community edges for community $c$ and $d_c$ is the sum of degrees of nodes in community $c$.\n\n**Analysis of Partition $\\mathbf{g}_A = \\{\\{1,2,3\\}, \\{4,5,6\\}\\}$**\n\n*   Community $1$: $C_1 = \\{1,2,3\\}$.\n    *   Internal edges $L_1$: $\\{(1,2), (2,3), (1,3)\\}$, so $L_1=3$.\n    *   Sum of degrees $d_1 = k_1+k_2+k_3 = 2+2+3 = 7$.\n*   Community $2$: $C_2 = \\{4,5,6\\}$.\n    *   Internal edges $L_2$: $\\{(4,5), (5,6), (4,6)\\}$, so $L_2=3$.\n    *   Sum of degrees $d_2 = k_4+k_5+k_6 = 3+2+2 = 7$.\n\nThe modularity is:\n$$ Q(\\mathbf{g}_A) = \\left[ \\frac{3}{7} - \\left(\\frac{7}{14}\\right)^2 \\right] + \\left[ \\frac{3}{7} - \\left(\\frac{7}{14}\\right)^2 \\right] = 2 \\left( \\frac{3}{7} - \\frac{1}{4} \\right) = 2 \\left( \\frac{12-7}{28} \\right) = \\frac{10}{28} = \\frac{5}{14} \\approx 0.3571 $$\n\n**Analysis of Partition $\\mathbf{g}_B = \\{\\{1,2\\}, \\{3,4,5,6\\}\\}$**\n\n*   Community $1$: $C_1 = \\{1,2\\}$.\n    *   Internal edges $L_1$: $\\{(1,2)\\}$, so $L_1=1$.\n    *   Sum of degrees $d_1 = k_1+k_2 = 2+2=4$.\n*   Community $2$: $C_2 = \\{3,4,5,6\\}$.\n    *   Internal edges $L_2$: $\\{(3,4), (4,5), (5,6), (4,6)\\}$, so $L_2=4$.\n    *   Sum of degrees $d_2 = k_3+k_4+k_5+k_6 = 3+3+2+2=10$.\n\nThe modularity is:\n$$ Q(\\mathbf{g}_B) = \\left[ \\frac{1}{7} - \\left(\\frac{4}{14}\\right)^2 \\right] + \\left[ \\frac{4}{7} - \\left(\\frac{10}{14}\\right)^2 \\right] = \\left( \\frac{1}{7} - \\frac{4}{49} \\right) + \\left( \\frac{4}{7} - \\frac{25}{49} \\right) $$\n$$ Q(\\mathbf{g}_B) = \\left( \\frac{7-4}{49} \\right) + \\left( \\frac{28-25}{49} \\right) = \\frac{3}{49} + \\frac{3}{49} = \\frac{6}{49} \\approx 0.1224 $$\nWithout constraints, $Q(\\mathbf{g}_A) > Q(\\mathbf{g}_B)$, so partition $\\mathbf{g}_A$ is preferred.\n\n**Analysis with Augmented Objective $Q_{\\text{aug}}$**\n\nThe constraints are a must-link $\\mathcal{M}=\\{(3,4)\\}$ and a cannot-link $\\mathcal{C}=\\{(2,5)\\}$. The weights are $\\mu = 0.30$ and $\\lambda = 0.15$. The augmented objective is $Q_{\\text{aug}} = Q - \\lambda \\sum_{(i,j)\\in \\mathcal{C}} \\delta(g_i,g_j) - \\mu \\sum_{(i,j)\\in \\mathcal{M}} (1 - \\delta(g_i,g_j))$.\n\n*   For $\\mathbf{g}_A = \\{\\{1,2,3\\}, \\{4,5,6\\}\\}$:\n    *   Must-link $(3,4)$: $g_3=1, g_4=2$. Violated. The penalty term is $\\mu(1-\\delta(g_3,g_4)) = \\mu(1-0) = \\mu$.\n    *   Cannot-link $(2,5)$: $g_2=1, g_5=2$. Satisfied. The penalty term is $\\lambda \\delta(g_2,g_5) = \\lambda(0)=0$.\n    *   $Q_{\\text{aug}}(\\mathbf{g}_A) = Q(\\mathbf{g}_A) - \\mu = \\frac{5}{14} - 0.30 \\approx 0.3571 - 0.30 = 0.0571$.\n\n*   For $\\mathbf{g}_B = \\{\\{1,2\\}, \\{3,4,5,6\\}\\}$:\n    *   Must-link $(3,4)$: $g_3=2, g_4=2$. Satisfied. The penalty term is $\\mu(1-\\delta(g_3,g_4)) = \\mu(1-1) = 0$.\n    *   Cannot-link $(2,5)$: $g_2=1, g_5=2$. Satisfied. The penalty term is $\\lambda \\delta(g_2,g_5) = \\lambda(0)=0$.\n    *   $Q_{\\text{aug}}(\\mathbf{g}_B) = Q(\\mathbf{g}_B) - 0 = \\frac{6}{49} \\approx 0.1224$.\n\nComparing the augmented modularity values, we find $Q_{\\text{aug}}(\\mathbf{g}_B) \\approx 0.1224 > Q_{\\text{aug}}(\\mathbf{g}_A) \\approx 0.0571$. The constraints, with the given weights, reverse the preference from $\\mathbf{g}_A$ to $\\mathbf{g}_B$.\n\nNow, we evaluate each statement.\n\n**A. Interpreting the augmented objective as adding pairwise Potts-model penalties that act like virtual positive affinity for must-links and virtual negative affinity for cannot-links, the constraints bias the optimizer toward partitions that satisfy them; in the example with $\\mu = 0.30$ and $\\lambda = 0.15$, $\\mathbf{g}_B$ achieves a larger $Q_{\\text{aug}}$ than $\\mathbf{g}_A$ because it satisfies the must-link $(3,4)$.**\nThe formulation $Q_{\\text{aug}}$ adds penalty terms that decrease the objective function's value when constraints are violated. Maximizing $Q_{\\text{aug}}$ is equivalent to maximizing $Q + \\mu \\sum_{(i,j)\\in \\mathcal{M}} \\delta(g_i,g_j) - \\lambda \\sum_{(i,j)\\in \\mathcal{C}} \\delta(g_i,g_j)$ plus a constant. This is a generalized Potts model where the modularity matrix provides baseline interactions and the constraints add large positive \"ferromagnetic\" couplings for must-links and large negative \"antiferromagnetic\" couplings for cannot-links. This biases the optimization towards partitions satisfying the constraints. Our calculation shows that with $\\mu = 0.30$, $Q_{\\text{aug}}(\\mathbf{g}_B) > Q_{\\text{aug}}(\\mathbf{g}_A)$. This flip in preference is caused by the penalty $\\mu=0.30$ applied to $\\mathbf{g}_A$ for violating the must-link $(3,4)$, while $\\mathbf{g}_B$ satisfies this link and incurs no penalty. The statement is accurate in its interpretation, its analysis of bias, and its conclusion about the specific example.\n**Verdict: Correct.**\n\n**B. Since constraints are experimentally derived, optimizing $Q_{\\text{aug}}$ cannot introduce bias; it strictly reduces estimator variance without affecting the expected rate of discovering novel modules.**\nThis statement is incorrect on multiple grounds. First, adding constraints to an objective function inherently introduces bias; the goal is to introduce a *beneficial* bias based on prior knowledge. The result of optimizing $Q_{\\text{aug}}$ is not, in expectation, the same as the result of optimizing $Q$. Second, experimental data is noisy and can be incorrect, so the introduced bias may be detrimental. Third, the notion that this process \"strictly reduces estimator variance without affecting bias\" is a misunderstanding of the bias-variance trade-off. Typically, adding constraints or regularization increases bias to achieve a reduction in variance. Fourth, by definition, forcing a solution to conform to existing knowledge (the constraints) can inhibit the discovery of novel patterns that contradict that knowledge.\n**Verdict: Incorrect.**\n\n**C. Sending $\\mu \\to \\infty$ and $\\lambda \\to \\infty$ is always optimal because it enforces ground truth; even if some constraints are noisy, this cannot harm identification of true biological modules.**\nThis is a dangerously absolute statement. Sending the weights $\\mu, \\lambda \\to \\infty$ converts the soft penalties into hard constraints that *must* be satisfied. The premise that experimental constraints represent \"ground truth\" is flawed; all experimental data are subject to noise and error. If a single constraint is incorrect, forcing the algorithm to satisfy it can lead to a severely distorted and biologically irrelevant partition, as the solution might have to accept a very low modularity score simply to satisfy the erroneous constraint. This would certainly harm the identification of true modules. For instance, if a must-link and a cannot-link constraint are transitively contradictory (e.g., must($i,j$), must($j,k$), cannot($i,k$)), no solution exists, and the problem becomes ill-posed.\n**Verdict: Incorrect.**\n\n**D. A principled mitigation for constraint-induced bias is to tune $(\\mu,\\lambda)$ by cross-validation on constraints: fit with a subset of $\\mathcal{M}$ and $\\mathcal{C}$ and evaluate predictive accuracy on held-out constrained pairs, thereby promoting out-of-sample generalization and preserving capacity to discover unexpected modules.**\nThis statement describes a standard and methodologically sound procedure from machine learning for hyperparameter tuning. The weights $\\mu$ and $\\lambda$ act as regularization parameters that control the trade-off between adhering to the network structure (via $Q$) and adhering to prior knowledge (the constraints). Using cross-validation—training on a subset of constraints and testing on a held-out subset—is the canonical way to select values for $\\mu$ and $\\lambda$ that prevent overfitting to potentially noisy training constraints. This process finds a balance that promotes generalization to unseen data and prevents the constraints from completely overwhelming the intrinsic structure of the network, thus preserving the potential to discover novel modules not explicitly encoded in the training constraints.\n**Verdict: Correct.**\n\n**E. Enforcing must-links by collapsing each must-linked pair into a single supernode is guaranteed not to affect modularity’s resolution limit and thus cannot create artificially large communities.**\nThis statement is false. Collapsing nodes into supernodes is a common heuristic, but it fundamentally alters the graph structure on which modularity is calculated. Modularity's resolution limit is a known artifact where the method fails to resolve communities smaller than a certain scale, which depends on the total size of the network. By creating supernodes, one is pre-aggregating parts of the network, which can directly create large initial entities. If must-links (which may be noisy) connect several small, distinct communities, this method will force them into a single, artificially large community, potentially exacerbating the resolution limit problem rather than being immune to it. The guarantee that it \"cannot create artificially large communities\" is the opposite of the potential outcome.\n**Verdict: Incorrect.**\n\n**F. Modifying the null model by redefining $P_{ij}=\\tfrac{k_i k_j}{2m}$ to force $P_{ij}=0$ for cannot-link pairs and large $P_{ij}$ for must-link pairs preserves the configuration-model interpretation and is universally preferable to adding penalty terms because it does not change the feasible set of partitions.**\nThis statement is incorrect for several reasons. First, the configuration model null hypothesis, $P_{ij} = k_i k_j / (2m)$, has a precise statistical meaning: it is the probability of an edge between nodes $i$ and $j$ in a random graph ensemble with a fixed degree sequence. Arbitrarily changing values of the matrix $P$ breaks this statistical foundation; the new null model is no longer a configuration model, so the claim that the interpretation is \"preserved\" is false. Second, no single method for incorporating constraints is \"universally preferable.\" Modifying the null model is one possible strategy, but adding penalty terms is another valid, flexible, and perhaps more transparent approach. Each has its own assumptions and behaviors. Third, the reason given (\"it does not change the feasible set of partitions\") is not a distinguishing feature, as the penalty-term approach also does not change the feasible set of partitions. Both methods alter the objective function over the same set of possible partitions.\n**Verdict: Incorrect.**\n\nFinal correct options are A and D.", "answer": "$$\\boxed{AD}$$", "id": "4549333"}]}