{"hands_on_practices": [{"introduction": "Threading methods identify compatible template structures for a query sequence by evaluating the fitness of the sequence-structure alignment, a process governed by a carefully designed scoring function. This exercise will guide you through the calculation of a realistic threading score, combining sequence-profile similarity derived from log-odds principles, structural environment compatibility, and affine gap penalties. By deconstructing this score, you will gain a concrete understanding of how disparate sources of biological information are integrated to assess the quality of a potential protein fold [@problem_id:4538342].", "problem": "A bioinformatics threading model scores a fixed query–template alignment by summing per-position sequence–profile log-likelihood ratios and environment-specific log-likelihood penalties, and then subtracting an environment-weighted affine gap cost. The foundational base for this scoring is the log-odds principle: for an aligned position $i$ and amino acid $a$, a sequence–profile contribution is given by the natural logarithm $\\ln\\!\\big(p_i(a)/q(a)\\big)$, where $p_i(a)$ is the Position-Specific Scoring Matrix (PSSM) probability at template position $i$ for residue $a$, and $q(a)$ is the background amino acid probability. Environment compatibility is treated analogously via $\\ln\\!\\big(\\pi_{s_i}(a)/q(a)\\big)$, where $\\pi_{s_i}(a)$ is the environment-specific propensity of residue $a$ in state $s_i$ (state $s_i \\in \\{\\text{exposed}, \\text{buried}\\}$), and gaps are penalized with an affine model $g_o + g_e(L-1)$ scaled by an environment multiplier $\\beta(s)$ for the state of the gapped template region. Natural logarithms must be used for all log-odds terms.\n\nConsider the query sequence $Q=(R,L,G,V,A)$ aligned to a template of length $6$ at positions $1,2,3,5,6$, with a single internal gap of length $L=1$ at template position $4$. Template environments are: position $1$ exposed, position $2$ buried, position $3$ buried, position $4$ buried, position $5$ exposed, position $6$ exposed.\n\nPer-position sequence–profile weights are: $w_1=1.0$, $w_2=1.2$, $w_3=0.8$, $w_5=1.0$, $w_6=0.9$. Per-position environment penalty weights are: $\\alpha_1=0.5$, $\\alpha_2=0.7$, $\\alpha_3=0.6$, $\\alpha_5=0.5$, $\\alpha_6=0.4$.\n\nBackground amino acid probabilities are: $q(R)=0.05$, $q(L)=0.09$, $q(G)=0.07$, $q(V)=0.07$, $q(A)=0.05$.\n\nPosition-specific profile probabilities $p_i(a)$ for the aligned residues are:\n- Position $1$ ($R$): $p_1(R)=0.10$.\n- Position $2$ ($L$): $p_2(L)=0.18$.\n- Position $3$ ($G$): $p_3(G)=0.035$.\n- Position $5$ ($V$): $p_5(V)=0.14$.\n- Position $6$ ($A$): $p_6(A)=0.10$.\n\nEnvironment propensities $\\pi_{s}(a)$ for the aligned residues are:\n- Exposed: $\\pi_{\\text{exposed}}(R)=0.10$, $\\pi_{\\text{exposed}}(V)=0.035$, $\\pi_{\\text{exposed}}(A)=0.075$.\n- Buried: $\\pi_{\\text{buried}}(L)=0.18$, $\\pi_{\\text{buried}}(G)=0.035$.\n\nAssume the environment background for these terms uses the same $q(a)$ given above. The affine gap parameters are $g_o=2.0$ and $g_e=0.4$, and the environment multipliers are $\\beta(\\text{buried})=1.3$ and $\\beta(\\text{exposed})=1.0$. The single internal gap occurs in a buried region (template position $4$).\n\nUsing the log-odds and affine-gap principles described above, compute the total threading score for this fixed alignment. Use the natural logarithm for all log terms and express the final numerical value rounded to four significant figures. No units are required.", "solution": "The problem provides a set of parameters and a scoring methodology to calculate the total score for a fixed alignment of a query protein sequence to a template structure. The problem is scientifically grounded, well-posed, and all necessary data for a unique solution are provided. Therefore, the problem is deemed valid.\n\nThe total threading score, $S$, is defined as the sum of weighted sequence–profile log-likelihood scores and weighted environment-specific log-likelihood scores, from which an environment-weighted affine gap cost is subtracted. The formula for the total score is:\n$$\nS = S_{\\text{profile}} + S_{\\text{env}} - G_{\\text{gap}}\n$$\nwhere $S_{\\text{profile}}$ is the total sequence–profile score, $S_{\\text{env}}$ is the total environment compatibility score, and $G_{\\text{gap}}$ is the gap penalty.\n\nThe alignment specifies that the query sequence $Q=(R,L,G,V,A)$ aligns with template positions $i \\in \\{1, 2, 3, 5, 6\\}$. A gap of length $L=1$ exists at template position $4$.\n\nFirst, we calculate the sequence–profile score, $S_{\\text{profile}}$. This is the sum of per-position scores, where each score is the log-odds ratio of the position-specific probability to the background probability, multiplied by a position-specific weight $w_i$.\n$$\nS_{\\text{profile}} = \\sum_{i \\in \\{1,2,3,5,6\\}} w_i \\ln\\left(\\frac{p_i(a_i)}{q(a_i)}\\right)\n$$\nHere, $a_i$ is the amino acid in the query sequence at the aligned position $i$.\n- Position $1$: Aligned pair is template-$1$ and query-R.\n  Term $1$: $w_1 \\ln\\left(\\frac{p_1(R)}{q(R)}\\right) = 1.0 \\times \\ln\\left(\\frac{0.10}{0.05}\\right) = 1.0 \\times \\ln(2)$\n- Position $2$: Aligned pair is template-$2$ and query-L.\n  Term $2$: $w_2 \\ln\\left(\\frac{p_2(L)}{q(L)}\\right) = 1.2 \\times \\ln\\left(\\frac{0.18}{0.09}\\right) = 1.2 \\times \\ln(2)$\n- Position $3$: Aligned pair is template-$3$ and query-G.\n  Term $3$: $w_3 \\ln\\left(\\frac{p_3(G)}{q(G)}\\right) = 0.8 \\times \\ln\\left(\\frac{0.035}{0.07}\\right) = 0.8 \\times \\ln(0.5) = -0.8 \\times \\ln(2)$\n- Position $5$: Aligned pair is template-$5$ and query-V.\n  Term $5$: $w_5 \\ln\\left(\\frac{p_5(V)}{q(V)}\\right) = 1.0 \\times \\ln\\left(\\frac{0.14}{0.07}\\right) = 1.0 \\times \\ln(2)$\n- Position $6$: Aligned pair is template-$6$ and query-A.\n  Term $6$: $w_6 \\ln\\left(\\frac{p_6(A)}{q(A)}\\right) = 0.9 \\times \\ln\\left(\\frac{0.10}{0.05}\\right) = 0.9 \\times \\ln(2)$\n\nSumming these terms gives $S_{\\text{profile}}$:\n$$\nS_{\\text{profile}} = (1.0 + 1.2 - 0.8 + 1.0 + 0.9) \\ln(2) = 3.3 \\ln(2)\n$$\n\nSecond, we calculate the environment compatibility score, $S_{\\text{env}}$. This is the sum of per-position scores based on the propensity of an amino acid for its local structural environment, weighted by $\\alpha_i$.\n$$\nS_{\\text{env}} = \\sum_{i \\in \\{1,2,3,5,6\\}} \\alpha_i \\ln\\left(\\frac{\\pi_{s_i}(a_i)}{q(a_i)}\\right)\n$$\nHere, $s_i$ is the environment state at template position $i$.\n- Position $1$: Residue R in an 'exposed' environment ($s_1=\\text{exposed}$).\n  Term $1$: $\\alpha_1 \\ln\\left(\\frac{\\pi_{\\text{exposed}}(R)}{q(R)}\\right) = 0.5 \\times \\ln\\left(\\frac{0.10}{0.05}\\right) = 0.5 \\times \\ln(2)$\n- Position $2$: Residue L in a 'buried' environment ($s_2=\\text{buried}$).\n  Term $2$: $\\alpha_2 \\ln\\left(\\frac{\\pi_{\\text{buried}}(L)}{q(L)}\\right) = 0.7 \\times \\ln\\left(\\frac{0.18}{0.09}\\right) = 0.7 \\times \\ln(2)$\n- Position $3$: Residue G in a 'buried' environment ($s_3=\\text{buried}$).\n  Term $3$: $\\alpha_3 \\ln\\left(\\frac{\\pi_{\\text{buried}}(G)}{q(G)}\\right) = 0.6 \\times \\ln\\left(\\frac{0.035}{0.07}\\right) = 0.6 \\times \\ln(0.5) = -0.6 \\times \\ln(2)$\n- Position $5$: Residue V in an 'exposed' environment ($s_5=\\text{exposed}$).\n  Term $5$: $\\alpha_5 \\ln\\left(\\frac{\\pi_{\\text{exposed}}(V)}{q(V)}\\right) = 0.5 \\times \\ln\\left(\\frac{0.035}{0.07}\\right) = 0.5 \\times \\ln(0.5) = -0.5 \\times \\ln(2)$\n- Position $6$: Residue A in an 'exposed' environment ($s_6=\\text{exposed}$).\n  Term $6$: $\\alpha_6 \\ln\\left(\\frac{\\pi_{\\text{exposed}}(A)}{q(A)}\\right) = 0.4 \\times \\ln\\left(\\frac{0.075}{0.05}\\right) = 0.4 \\times \\ln(1.5)$\n\nSumming these terms gives $S_{\\text{env}}$:\n$$\nS_{\\text{env}} = (0.5 + 0.7 - 0.6 - 0.5) \\ln(2) + 0.4 \\ln(1.5) = 0.1 \\ln(2) + 0.4 \\ln(1.5)\n$$\n\nThird, we calculate the affine gap penalty, $G_{\\text{gap}}$. A single gap of length $L=1$ occurs at template position $4$, which is in a 'buried' environment. The formula is:\n$$\nG_{\\text{gap}} = \\beta(s_{\\text{gap}}) \\left( g_o + g_e(L-1) \\right)\n$$\nUsing the given parameters: $g_o=2.0$, $g_e=0.4$, $\\beta(\\text{buried})=1.3$, and $L=1$.\n$$\nG_{\\text{gap}} = 1.3 \\times (2.0 + 0.4(1-1)) = 1.3 \\times (2.0 + 0) = 2.6\n$$\n\nFinally, we combine these components to find the total score $S$:\n$$\nS = S_{\\text{profile}} + S_{\\text{env}} - G_{\\text{gap}}\n$$\n$$\nS = 3.3 \\ln(2) + \\left(0.1 \\ln(2) + 0.4 \\ln(1.5)\\right) - 2.6\n$$\n$$\nS = 3.4 \\ln(2) + 0.4 \\ln(1.5) - 2.6\n$$\nTo obtain the numerical value, we use the approximations $\\ln(2) \\approx 0.693147$ and $\\ln(1.5) \\approx 0.405465$.\n$$\nS \\approx 3.4 \\times 0.693147 + 0.4 \\times 0.405465 - 2.6\n$$\n$$\nS \\approx 2.3566998 + 0.162186 - 2.6\n$$\n$$\nS \\approx 2.5188858 - 2.6\n$$\n$$\nS \\approx -0.0811142\n$$\nRounding the result to four significant figures gives $-0.08111$.", "answer": "$$\n\\boxed{-0.08111}\n$$", "id": "4538342"}, {"introduction": "Modern *ab initio* structure prediction is powerfully enhanced by converting co-evolutionary or deep learning-based distance predictions into guiding energy restraints. This practice demonstrates the critical process of translating a discrete probability distribution over inter-residue distances into a continuous, differentiable Gaussian potential that can guide conformational sampling algorithms. You will implement the full pipeline from moment-matching and entropy-based confidence weighting to the final energy calculation, a core technique in state-of-the-art folding algorithms [@problem_id:4538312].", "problem": "You are given a set of three-dimensional (3D) residue coordinates and, for selected residue pairs, a predicted discrete distance distribution over scalar distance bins. Using fundamental probability theory, you must convert each discrete predicted distribution into a single Gaussian restraint via moment matching and then compute the contribution of that restraint to the total energy as the negative log-likelihood under the Gaussian model. All distances are in Angstroms, and energies are dimensionless in natural units (nats) obtained from the natural logarithm.\n\nFundamental base and definitions to use:\n- The probability density function (PDF) of a univariate Gaussian with mean $\\mu$ and standard deviation $\\sigma$ evaluated at a scalar $x$ is\n$$\np(x \\mid \\mu,\\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right).\n$$\n- The negative log-likelihood for a single observation $x$ under this model is\n$$\n-\\log p(x\\mid \\mu,\\sigma) = \\frac{1}{2}\\log\\left(2\\pi\\sigma^2\\right) + \\frac{(x-\\mu)^2}{2\\sigma^2}.\n$$\n- For a discrete distribution over bin midpoints $\\{m_k\\}_{k=1}^K$ with probabilities $\\{p_k\\}_{k=1}^K$ satisfying $p_k \\ge 0$ and $\\sum_{k=1}^K p_k = 1$, the expectation and variance are\n$$\n\\mu = \\sum_{k=1}^K p_k m_k,\\quad \\mathrm{Var} = \\sum_{k=1}^K p_k \\left(m_k - \\mu\\right)^2.\n$$\n- The Shannon entropy (SE) of the discrete distribution is\n$$\nH = -\\sum_{k=1}^K p_k \\log p_k,\n$$\nwith the maximum entropy $H_{\\max} = \\log K$. Define an entropy-based confidence weight\n$$\nw = \\begin{cases}\n1 - \\frac{H}{H_{\\max}}, & K \\ge 2,\\\\\n1, & K = 1,\n\\end{cases}\n$$\nso that $w \\in [0,1]$, with $w=0$ for a uniform distribution and $w=1$ for a degenerate single-bin prediction.\n\nConstruction of Gaussian restraints and energy:\n1. For each residue pair, convert the discrete prediction to a Gaussian by moment matching as above to obtain $\\mu$ and $\\sigma = \\sqrt{\\mathrm{Var}}$.\n2. Apply a variance floor to ensure numerical stability: let $\\sigma_{\\min} > 0$ be given, and use $\\sigma \\leftarrow \\max(\\sigma, \\sigma_{\\min})$.\n3. Compute the Euclidean distance $d$ between the two residues’ 3D coordinates.\n4. Compute the energy contribution of the pair as the weighted negative log-likelihood\n$$\nE = w\\left[\\frac{1}{2}\\log\\left(2\\pi\\sigma^2\\right) + \\frac{(d-\\mu)^2}{2\\sigma^2}\\right].\n$$\n5. The total energy for a test case is the sum of $E$ over the specified pairs.\n\nAngle units are not involved. Distances must be computed in Angstroms and energies expressed as dimensionless numbers in natural logarithm units (nats). Use the natural logarithm.\n\nImplement a complete program that:\n- Hard-codes the test suite below.\n- Computes the total energy per test case following the above definitions.\n- Produces a single line of output containing the totals as a comma-separated list enclosed in square brackets, with each value rounded to exactly six decimal places, for example, $[1.234000,2.345000,3.456000]$.\n\nTest Suite:\nLet the coordinates be shared across all test cases:\n- Residue $1$: $(0.0, 0.0, 0.0)$\n- Residue $2$: $(4.0, 0.0, 0.0)$\n- Residue $3$: $(0.0, 3.0, 0.0)$\n- Residue $4$: $(0.0, 0.0, 5.0)$\n- Residue $5$: $(2.0, 2.0, 1.0)$\n\nLet the variance floor be $\\sigma_{\\min} = 0.5$ for all test cases.\n\n- Test Case $1$:\n  - Pairs and predicted discrete distributions (bin midpoints and probabilities):\n    - Pair $(1,2)$: midpoints $[3.0, 4.0, 5.0, 6.0]$, probabilities $[0.10, 0.70, 0.15, 0.05]$.\n    - Pair $(1,3)$: midpoints $[2.5, 3.0, 3.5]$, probabilities $[0.20, 0.60, 0.20]$.\n    - Pair $(4,5)$: midpoints $[4.0, 4.5, 5.0, 5.5]$, probabilities $[0.10, 0.20, 0.40, 0.30]$.\n- Test Case $2$ (edge case: uniform predictions should give zero contribution due to zero weight):\n  - Pairs:\n    - Pair $(1,4)$: midpoints $[4.0, 5.0, 6.0, 7.0]$, probabilities $[0.25, 0.25, 0.25, 0.25]$.\n    - Pair $(2,5)$: midpoints $[2.0, 3.0, 4.0]$, probabilities $[1/3, 1/3, 1/3]$.\n- Test Case $3$ (edge and high-confidence cases):\n  - Pairs:\n    - Pair $(3,4)$: midpoints $[7.9, 8.0, 8.1]$, probabilities $[0.05, 0.90, 0.05]$.\n    - Pair $(1,5)$: midpoints $[3.0]$, probabilities $[1.0]$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the total energies for Test Cases $1$, $2$, and $3$ as a comma-separated list enclosed in square brackets, with each float rounded to exactly six decimal places, for example, $[x_1,x_2,x_3]$ where each $x_i$ has six digits after the decimal point.", "solution": "The problem requires the computation of a total energy for a system of residues based on predicted distance distributions. This total energy is the sum of individual energy contributions from specified pairs of residues. Each contribution is calculated as a weighted negative log-likelihood, where a predicted discrete distance distribution is first converted into a continuous Gaussian potential via moment matching. The procedure is grounded in fundamental principles of probability theory and statistics, commonly applied in scoring functions for protein structure prediction.\n\nThe process for computing the energy contribution for a single residue pair $(i, j)$ is as follows:\n\nFirst, we determine the actual physical distance, $d$, between the two residues $i$ and $j$ using their given three-dimensional coordinates $\\vec{r}_i$ and $\\vec{r}_j$. The distance is the Euclidean norm of the difference vector between their positions:\n$$\nd = \\left\\| \\vec{r}_i - \\vec{r}_j \\right\\|_2 = \\sqrt{(x_i - x_j)^2 + (y_i - y_j)^2 + (z_i - z_j)^2}.\n$$\n\nSecond, we model the predicted discrete distance distribution as a univariate Gaussian distribution. The discrete distribution is defined by a set of $K$ bin midpoints, $\\{m_k\\}_{k=1}^K$, and their associated probabilities, $\\{p_k\\}_{k=1}^K$, where $p_k \\ge 0$ and $\\sum_{k=1}^K p_k = 1$. The parameters of the corresponding Gaussian distribution, the mean $\\mu$ and variance $\\mathrm{Var}$, are determined by matching the first and second moments of the discrete distribution:\n$$\n\\mu = \\mathbb{E}[m] = \\sum_{k=1}^K p_k m_k\n$$\n$$\n\\mathrm{Var} = \\mathbb{E}[(m - \\mu)^2] = \\sum_{k=1}^K p_k (m_k - \\mu)^2\n$$\nThe standard deviation, $\\sigma$, is the square root of the variance: $\\sigma = \\sqrt{\\mathrm{Var}}$.\n\nThird, to ensure numerical stability and to prevent the restraint from becoming infinitely sharp (which is physically unrealistic), a variance floor is applied. A minimum standard deviation, $\\sigma_{\\min} > 0$, is specified. The effective standard deviation, $\\sigma_{\\text{eff}}$, used for the energy calculation is the maximum of the calculated $\\sigma$ and the floor $\\sigma_{\\min}$:\n$$\n\\sigma_{\\text{eff}} = \\max(\\sigma, \\sigma_{\\min})\n$$\n\nFourth, a confidence weight, $w$, is computed to modulate the strength of the energy contribution based on the certainty of the prediction. This weight is derived from the Shannon entropy, $H$, of the discrete distribution. A distribution with high entropy is more uniform and represents an uncertain prediction, which should be down-weighted. The Shannon entropy is given by:\n$$\nH = -\\sum_{k=1}^K p_k \\log p_k\n$$\nwhere the convention $0 \\log 0 = 0$ is used. This is compared to the maximum possible entropy for a distribution with $K$ bins, which occurs for a uniform distribution ($p_k = 1/K$ for all $k$) and is equal to $H_{\\max} = \\log K$. The confidence weight $w$ is defined as:\n$$\nw = \\begin{cases}\n1 - \\frac{H}{H_{\\max}}, & \\text{if } K \\ge 2 \\\\\n1, & \\text{if } K = 1\n\\end{cases}\n$$\nThis definition ensures that $w \\in [0, 1]$. A perfectly certain prediction (a single bin with probability $1$) has $H = 0$ and thus $w = 1$. A maximally uncertain (uniform) prediction has $H = H_{\\max}$ and thus $w = 0$.\n\nFifth, the energy contribution, $E$, for the pair is calculated as the weighted negative log-likelihood of observing the actual distance $d$ under the derived Gaussian model $p(x | \\mu, \\sigma_{\\text{eff}})$. The negative log-likelihood, using the natural logarithm ($\\log$) to yield energy in nats, is:\n$$\n-\\log p(d \\mid \\mu, \\sigma_{\\text{eff}}) = \\frac{1}{2}\\log(2\\pi\\sigma_{\\text{eff}}^2) + \\frac{(d-\\mu)^2}{2\\sigma_{\\text{eff}}^2}\n$$\nThe final energy is this value multiplied by the confidence weight $w$:\n$$\nE = w \\left[ \\frac{1}{2}\\log(2\\pi\\sigma_{\\text{eff}}^2) + \\frac{(d-\\mu)^2}{2\\sigma_{\\text{eff}}^2} \\right]\n$$\nThe first term inside the brackets, $\\frac{1}{2}\\log(2\\pi\\sigma_{\\text{eff}}^2)$, is related to the normalization constant of the Gaussian and penalizes broader distributions (higher $\\sigma_{\\text{eff}}$). The second term, $\\frac{(d-\\mu)^2}{2\\sigma_{\\text{eff}}^2}$, is a quadratic penalty for the deviation of the actual distance $d$ from the predicted mean distance $\\mu$.\n\nFinally, the total energy for a given test case is the simple sum of the individual energy contributions $E$ from all residue pairs specified in that test case.\n\nThe implementation will systematically apply these steps for each pair in each test case. Numerical computations will be performed using the `numpy` library for efficient array-based calculations of distances, moments, and other mathematical expressions. The residue coordinates are provided as a shared set for all test cases, and the variance floor is specified as $\\sigma_{\\min} = 0.5$. The final result for each test case is the sum of energies for its constituent pairs, which is then formatted to the required precision.", "answer": "$$\n\\boxed{\\text{[1.139626, 0.000000, 13.916896]}}\n$$", "id": "4538312"}, {"introduction": "The success of a structure prediction pipeline, whether based on *ab initio* or threading principles, often depends on the accuracy of its intermediate predictions, such as inter-residue contacts. It is therefore essential to quantitatively evaluate the performance of any contact prediction method before relying on its output for model building. This problem introduces the standard metrics for this binary classification task—precision, recall, and the F1-score—allowing you to assess the quality of a set of predicted contacts against a known ground truth from a PDB structure [@problem_id:4538381].", "problem": "A protein of sequence length $L = 120$ is analyzed for long-range residue contacts in the context of ab initio and threading-based protein structure prediction. A residue contact between positions $i$ and $j$ is defined when the carbon-beta ($\\mathrm{C}\\beta$)–$\\mathrm{C}\\beta$ Euclidean distance (with glycine using carbon-alpha ($\\mathrm{C}\\alpha$)) in a curated Protein Data Bank (PDB) structure is less than a physically motivated threshold $d_c = 8\\,\\text{\\AA}$, and the sequence separation satisfies $|i - j| \\geq 24$. An ab initio predictor (sampling conformations under a statistical potential) and a threading-based predictor (aligning the sequence to structural templates) generate predicted contact pairs; at the decision threshold $d_c$ for predicted distances, the consensus predicted set consists of those pairs that either predictor estimates to be within $d_c$. For evaluation, consider only unordered residue index pairs with $i < j$ and $|i - j| \\geq 24$.\n\nThe set of true long-range contacts derived from the PDB structure is\n$$\n\\mathbb{T} = \\{(5,40),(7,85),(12,68),(15,98),(22,90),(27,60),(31,79),(33,75),(35,100),(42,70),(50,95),(62,88)\\}.\n$$\nThe set of predicted long-range contacts at threshold $d_c$ (consensus of ab initio and threading-based predictors) is\n$$\n\\mathbb{P} = \\{(5,40),(8,85),(12,68),(15,99),(22,90),(27,61),(31,79),(33,76),(35,100),(42,71),(50,95),(62,89),(10,55),(75,110)\\}.\n$$\n\nUsing the standard definitions of precision, recall, and F1-score for binary classification, compute the precision, recall, and F1-score for contact prediction restricted to the stated long-range criterion. Express your final answer as a row vector in the order (precision, recall, F1-score). Round each value to four significant figures. No units should be included in the final numerical answer.", "solution": "The problem requires the computation of precision, recall, and F1-score for a contact prediction task in protein structure analysis. These metrics are standard in binary classification and are defined in terms of true positives, false positives, and false negatives.\n\nLet $\\mathbb{T}$ be the set of true residue contacts (the \"ground truth\") and $\\mathbb{P}$ be the set of predicted residue contacts. The problem provides these sets as:\n$$\n\\mathbb{T} = \\{(5,40),(7,85),(12,68),(15,98),(22,90),(27,60),(31,79),(33,75),(35,100),(42,70),(50,95),(62,88)\\}\n$$\n$$\n\\mathbb{P} = \\{(5,40),(8,85),(12,68),(15,99),(22,90),(27,61),(31,79),(33,76),(35,100),(42,71),(50,95),(62,89),(10,55),(75,110)\\}\n$$\nThe problem is well-defined and all given residue pairs $(i,j)$ satisfy the long-range condition $|i-j| \\geq 24$.\n\nWe define the following quantities:\n1.  **True Positives ($TP$)**: The number of predicted contacts that are also true contacts. This is the size of the intersection of the two sets, $TP = |\\mathbb{T} \\cap \\mathbb{P}|$.\n2.  **False Positives ($FP$)**: The number of predicted contacts that are not true contacts. This is the number of elements in $\\mathbb{P}$ that are not in $\\mathbb{T}$, so $FP = |\\mathbb{P} \\setminus \\mathbb{T}| = |\\mathbb{P}| - TP$.\n3.  **False Negatives ($FN$)**: The number of true contacts that were not predicted. This is the number of elements in $\\mathbb{T}$ that are not in $\\mathbb{P}$, so $FN = |\\mathbb{T} \\setminus \\mathbb{P}| = |\\mathbb{T}| - TP$.\n\nFirst, we determine the intersection $\\mathbb{T} \\cap \\mathbb{P}$ by identifying the pairs that are present in both sets. A pair $(i,j)$ is considered a match only if the indices are identical in both sets.\n- $(5,40)$ is in both $\\mathbb{T}$ and $\\mathbb{P}$.\n- $(7,85) \\in \\mathbb{T}$, but $(7,85) \\notin \\mathbb{P}$. Note that $(8,85) \\in \\mathbb{P}$ is a different pair.\n- $(12,68)$ is in both $\\mathbb{T}$ and $\\mathbb{P}$.\n- $(15,98) \\in \\mathbb{T}$, but $(15,98) \\notin \\mathbb{P}$. Note that $(15,99) \\in \\mathbb{P}$ is a different pair.\n- $(22,90)$ is in both $\\mathbb{T}$ and $\\mathbb{P}$.\n- $(27,60) \\in \\mathbb{T}$, but $(27,60) \\notin \\mathbb{P}$. Note that $(27,61) \\in \\mathbb{P}$ is a different pair.\n- $(31,79)$ is in both $\\mathbb{T}$ and $\\mathbb{P}$.\n- $(33,75) \\in \\mathbb{T}$, but $(33,75) \\notin \\mathbb{P}$. Note that $(33,76) \\in \\mathbb{P}$ is a different pair.\n- $(35,100)$ is in both $\\mathbb{T}$ and $\\mathbb{P}$.\n- $(42,70) \\in \\mathbb{T}$, but $(42,70) \\notin \\mathbb{P}$. Note that $(42,71) \\in \\mathbb{P}$ is a different pair.\n- $(50,95)$ is in both $\\mathbb{T}$ and $\\mathbb{P}$.\n- $(62,88) \\in \\mathbb{T}$, but $(62,88) \\notin \\mathbb{P}$. Note that $(62,89) \\in \\mathbb{P}$ is a different pair.\n\nThe set of correctly predicted contacts (True Positives) is:\n$$\n\\mathbb{T} \\cap \\mathbb{P} = \\{(5,40), (12,68), (22,90), (31,79), (35,100), (50,95)\\}\n$$\nThe number of True Positives is $TP = |\\mathbb{T} \\cap \\mathbb{P}| = 6$.\n\nThe total number of true contacts is $|\\mathbb{T}| = 12$.\nThe total number of predicted contacts is $|\\mathbb{P}| = 14$.\n\nNow we can calculate $FP$ and $FN$:\n$FP = |\\mathbb{P}| - TP = 14 - 6 = 8$.\n$FN = |\\mathbb{T}| - TP = 12 - 6 = 6$.\n\nWith these values, we can compute precision ($P$), recall ($R$), and F1-score ($F_1$):\n**Precision ($P$)** is the fraction of predicted contacts that are correct:\n$$\nP = \\frac{TP}{TP + FP} = \\frac{TP}{|\\mathbb{P}|} = \\frac{6}{14} = \\frac{3}{7}\n$$\n**Recall ($R$)**, also known as sensitivity, is the fraction of true contacts that are correctly predicted:\n$$\nR = \\frac{TP}{TP + FN} = \\frac{TP}{|\\mathbb{T}|} = \\frac{6}{12} = \\frac{1}{2}\n$$\n**F1-score ($F_1$)** is the harmonic mean of precision and recall:\n$$\nF_1 = 2 \\cdot \\frac{P \\cdot R}{P + R} = \\frac{2TP}{2TP + FP + FN} = \\frac{2 \\cdot 6}{2 \\cdot 6 + 8 + 6} = \\frac{12}{12 + 14} = \\frac{12}{26} = \\frac{6}{13}\n$$\n\nFinally, we convert these fractions to decimal values and round to four significant figures as requested:\n$P = \\frac{3}{7} \\approx 0.428571... \\approx 0.4286$\n$R = \\frac{1}{2} = 0.5$. Expressed to four significant figures, this is $0.5000$.\n$F_1 = \\frac{6}{13} \\approx 0.461538... \\approx 0.4615$\n\nThe final answer is the row vector (precision, recall, F1-score).", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4286 & 0.5000 & 0.4615 \\end{pmatrix}}\n$$", "id": "4538381"}]}