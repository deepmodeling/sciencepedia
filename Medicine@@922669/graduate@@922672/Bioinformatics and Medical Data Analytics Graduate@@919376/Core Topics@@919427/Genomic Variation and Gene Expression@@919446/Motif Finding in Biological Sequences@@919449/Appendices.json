{"hands_on_practices": [{"introduction": "The Position Weight Matrix (PWM) is a cornerstone of motif representation, translating an alignment of binding sites into a probabilistic scoring model. This exercise delves into the construction of a PWM from raw nucleotide counts, demonstrating the crucial role of pseudocounts in stabilizing probability estimates. By comparing different pseudocount strategies, you will gain insight into how prior beliefs can influence model parameters, especially when data is sparse [@problem_id:4586777].", "problem": "A common approach to quantify motifs in deoxyribonucleic acid (DNA) binding site alignments uses a Position Weight Matrix (PWM), whose entries represent the log-odds of observing a base at a motif position relative to a known background distribution. To construct a PWM from observed counts at each position, it is standard to assume a multinomial sampling model for base occurrences and place a Dirichlet prior over the base probabilities at each position. The Dirichlet prior is conjugate to the multinomial, yielding a posterior distribution with analytically tractable properties.\n\nConsider a single motif column $j$ in an alignment of $N=5$ binding sites with observed counts $(n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j}) = (3, 0, 1, 1)$ and a known background distribution $b = (b_{A}, b_{C}, b_{G}, b_{T}) = (0.3, 0.2, 0.2, 0.3)$. Assume a Dirichlet prior over the base probabilities at column $j$, denoted $p_{j} = (p_{A,j}, p_{C,j}, p_{G,j}, p_{T,j})$, with two different pseudocount schemes that share the same total prior strength $\\alpha_{0}=1$:\n1. A uniform pseudocount scheme with prior parameters $\\alpha^{(u)} = (\\alpha_{A}^{(u)}, \\alpha_{C}^{(u)}, \\alpha_{G}^{(u)}, \\alpha_{T}^{(u)}) = (0.25, 0.25, 0.25, 0.25)$.\n2. A background-weighted pseudocount scheme with prior parameters $\\alpha^{(b)} = (\\alpha_{A}^{(b)}, \\alpha_{C}^{(b)}, \\alpha_{G}^{(b)}, \\alpha_{T}^{(b)}) = (0.3, 0.2, 0.2, 0.3)$.\n\nStarting from the multinomial likelihood and the properties of the Dirichlet prior, derive the posterior mean estimates of $p_{C,j}$ under both pseudocount schemes, then construct the corresponding PWM log-odds entries for cytosine at column $j$, defined as $w_{C,j} = \\log_{2}\\!\\big(p_{C,j}/b_{C}\\big)$. Finally, compute the difference between the uniform and background-weighted cytosine PWM entries, $w_{C,j}^{(u)} - w_{C,j}^{(b)}$, and provide its value. Round your final answer to four significant figures and express the final value in bits.", "solution": "The problem requires the calculation of the difference between two Position Weight Matrix (PWM) entries for cytosine ($C$) at a specific column $j$ of a DNA binding site alignment. The two entries are derived from two different prior assumptions (pseudocount schemes) within a Bayesian framework.\n\nThe problem is based on the conjugate prior relationship between the Dirichlet and multinomial distributions. Given a set of observed counts for the four DNA bases $\\{A, C, G, T\\}$ at a column $j$, denoted by the vector $n_j = (n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j})$, the likelihood of these counts is modeled by a multinomial distribution with parameters $p_j = (p_{A,j}, p_{C,j}, p_{G,j}, p_{T,j})$, where $p_{k,j}$ is the unknown probability of observing base $k$ at position $j$.\n\nA Dirichlet prior distribution is placed on the probability vector $p_j$. The prior is parameterized by a vector of pseudocounts $\\alpha = (\\alpha_{A}, \\alpha_{C}, \\alpha_{G}, \\alpha_{T})$. The posterior distribution of $p_j$ given the observed counts $n_j$ is also a Dirichlet distribution with updated parameters $\\alpha' = \\alpha + n_j = (\\alpha_{A}+n_{A,j}, \\alpha_{C}+n_{C,j}, \\alpha_{G}+n_{G,j}, \\alpha_{T}+n_{T,j})$.\n\nThe posterior mean estimate for the probability of a specific base $k$ at column $j$, denoted $\\hat{p}_{k,j}$, is given by the formula:\n$$\n\\hat{p}_{k,j} = E[p_{k,j} | n_j, \\alpha] = \\frac{\\alpha_k + n_{k,j}}{\\sum_{i \\in \\{A,C,G,T\\}} (\\alpha_i + n_{i,j})}\n$$\nLet $N = \\sum_{i} n_{i,j}$ be the total number of observed sites and $\\alpha_0 = \\sum_{i} \\alpha_i$ be the total prior strength (total pseudocount). The formula simplifies to:\n$$\n\\hat{p}_{k,j} = \\frac{n_{k,j} + \\alpha_k}{N + \\alpha_0}\n$$\nThe problem provides the following data:\n- Number of sites $N=5$.\n- Observed counts for column $j$: $(n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j}) = (3, 0, 1, 1)$. Specifically, $n_{C,j} = 0$.\n- Total prior strength $\\alpha_0 = 1$.\n- Background distribution $b = (b_{A}, b_{C}, b_{G}, b_{T}) = (0.3, 0.2, 0.2, 0.3)$. Specifically, $b_C = 0.2$.\n\nWe will now calculate the posterior mean probability of cytosine, $\\hat{p}_{C,j}$, for both pseudocount schemes.\n\n1.  **Uniform pseudocount scheme:**\n    The prior parameters are $\\alpha^{(u)} = (0.25, 0.25, 0.25, 0.25)$. The pseudocount for cytosine is $\\alpha_{C}^{(u)} = 0.25$.\n    The posterior mean estimate for $p_{C,j}$ is:\n    $$\n    \\hat{p}_{C,j}^{(u)} = \\frac{n_{C,j} + \\alpha_{C}^{(u)}}{N + \\alpha_0} = \\frac{0 + 0.25}{5 + 1} = \\frac{0.25}{6} = \\frac{1}{24}\n    $$\n    The corresponding PWM entry for cytosine, $w_{C,j}^{(u)}$, is defined as the log-odds score:\n    $$\n    w_{C,j}^{(u)} = \\log_{2}\\left(\\frac{\\hat{p}_{C,j}^{(u)}}{b_C}\\right) = \\log_{2}\\left(\\frac{1/24}{0.2}\\right) = \\log_{2}\\left(\\frac{1/24}{1/5}\\right) = \\log_{2}\\left(\\frac{5}{24}\\right)\n    $$\n\n2.  **Background-weighted pseudocount scheme:**\n    The prior parameters are $\\alpha^{(b)} = (0.3, 0.2, 0.2, 0.3)$. The pseudocount for cytosine is $\\alpha_{C}^{(b)} = 0.2$.\n    The posterior mean estimate for $p_{C,j}$ is:\n    $$\n    \\hat{p}_{C,j}^{(b)} = \\frac{n_{C,j} + \\alpha_{C}^{(b)}}{N + \\alpha_0} = \\frac{0 + 0.2}{5 + 1} = \\frac{0.2}{6} = \\frac{1/5}{6} = \\frac{1}{30}\n    $$\n    The corresponding PWM entry for cytosine, $w_{C,j}^{(b)}$, is:\n    $$\n    w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{\\hat{p}_{C,j}^{(b)}}{b_C}\\right) = \\log_{2}\\left(\\frac{1/30}{0.2}\\right) = \\log_{2}\\left(\\frac{1/30}{1/5}\\right) = \\log_{2}\\left(\\frac{5}{30}\\right) = \\log_{2}\\left(\\frac{1}{6}\\right)\n    $$\n\nFinally, we compute the difference between the two PWM entries, $w_{C,j}^{(u)} - w_{C,j}^{(b)}$.\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{5}{24}\\right) - \\log_{2}\\left(\\frac{1}{6}\\right)\n$$\nUsing the property of logarithms, $\\log(x) - \\log(y) = \\log(x/y)$, we have:\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{5/24}{1/6}\\right) = \\log_{2}\\left(\\frac{5}{24} \\times 6\\right) = \\log_{2}\\left(\\frac{30}{24}\\right) = \\log_{2}\\left(\\frac{5}{4}\\right)\n$$\nTo find the numerical value, we evaluate the expression:\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}(1.25)\n$$\nUsing the change of base formula, $\\log_2(x) = \\frac{\\ln(x)}{\\ln(2)}$:\n$$\n\\log_{2}(1.25) = \\frac{\\ln(1.25)}{\\ln(2)} \\approx \\frac{0.22314355}{0.69314718} \\approx 0.32192809 \\text{ bits}\n$$\nRounding the result to four significant figures gives $0.3219$.", "answer": "$$\\boxed{0.3219}$$", "id": "4586777"}, {"introduction": "A PWM is only useful if we can distinguish true binding sites from random high-scoring sequences. This practice bridges the gap between probabilistic scoring and statistical significance by tasking you with calculating score distributions and their associated $p$-values. You will determine the precise score threshold needed to achieve a specific Expected value ($E$-value), a fundamental skill for controlling false positives when scanning entire genomes for motif occurrences [@problem_id:4586666].", "problem": "A laboratory is scanning deoxyribonucleic acid (DNA) sequences for a transcription factor binding motif using a Position Weight Matrix (PWM). The PWM has width $w = 8$ and, at each position $i \\in \\{1,\\dots,8\\}$, assigns probability $\\theta_{i,A} = \\frac{1}{2}$ to base $A$ and probability $\\theta_{i,b} = \\frac{1}{6}$ to each non-$A$ base $b \\in \\{C,G,T\\}$. The background nucleotide distribution is independent and identically distributed with $b_{A} = b_{C} = b_{G} = b_{T} = \\frac{1}{4}$. The score $S(x_{1:8})$ of a length-$8$ word $x_{1:8}$ is defined as the sum of per-position log-likelihood ratios in natural logarithm units, that is $S(x_{1:8}) = \\sum_{i=1}^{8} \\ln\\!\\left(\\frac{\\theta_{i,x_{i}}}{b_{x_{i}}}\\right)$. A background $p$-value for a threshold $t$ is defined as the probability, under the background model, that $S(x_{1:8}) \\ge t$. An $E$-value is the expected number of threshold exceedances when scanning a sequence, and in this setting is modeled as the number of scored windows multiplied by the background $p$-value.\n\nStarting only from these definitions and the independence assumptions inherent in the background model, do the following:\n- Derive the set of distinct per-position score values and represent the total score $S(x_{1:8})$ as a function of the number $k$ of positions equal to $A$ in $x_{1:8}$.\n- Using the background model, derive the exact distribution of $k$ and express the exact background $p$-value $\\Pr(S \\ge t)$ in terms of a tail of this distribution when $t$ equals a score realizable by some $k$.\n- The laboratory scans both strands of a single DNA sequence of length $L = 32775$, scoring every possible window on both strands, for a total of $N = 2\\,(L - w + 1)$ windows. Determine the minimal score threshold $t^{\\ast}$, expressed in natural logarithm units, such that the expected number of background exceedances (the $E$-value) is exactly $1$.\n\nGive your final threshold $t^{\\ast}$ as an exact closed-form expression in natural logarithm units. Do not round.", "solution": "We begin from the score definition under a Position Weight Matrix (PWM) and a background model. By definition, for a length-$w$ word $x_{1:w}$, the log-likelihood ratio score is\n$$\nS(x_{1:w}) \\;=\\; \\sum_{i=1}^{w} \\ln\\!\\left(\\frac{\\theta_{i,x_{i}}}{b_{x_{i}}}\\right).\n$$\nHere $w = 8$, $\\theta_{i,A} = \\frac{1}{2}$ and $\\theta_{i,b} = \\frac{1}{6}$ for $b \\in \\{C,G,T\\}$ at every position $i$, and the background $b_{A} = b_{C} = b_{G} = b_{T} = \\frac{1}{4}$.\n\nFirst, we derive the distinct per-position score values. At any position $i$:\n- If $x_{i} = A$, then the per-position contribution is $\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{4}}\\right) = \\ln 2$.\n- If $x_{i} \\in \\{C,G,T\\}$, then the per-position contribution is $\\ln\\!\\left(\\frac{\\frac{1}{6}}{\\frac{1}{4}}\\right) = \\ln\\!\\left(\\frac{2}{3}\\right)$.\n\nThus, per position, the only two score values are $\\ln 2$ and $\\ln\\!\\left(\\frac{2}{3}\\right)$. Let $k$ denote the number of positions among the $8$ where $x_{i} = A$. Then the total score is\n$$\nS \\;=\\; k \\cdot \\ln 2 + (8 - k)\\cdot \\ln\\!\\left(\\frac{2}{3}\\right).\n$$\nThis can be equivalently rewritten as\n$$\nS \\;=\\; 8 \\cdot \\ln\\!\\left(\\frac{2}{3}\\right) + k \\cdot \\left[\\ln 2 - \\ln\\!\\left(\\frac{2}{3}\\right)\\right]\n\\;=\\; 8 \\cdot \\ln\\!\\left(\\frac{2}{3}\\right) + k \\cdot \\ln 3.\n$$\n\nNext, we derive the exact distribution of $k$ under the background model. Under the background, bases are independent across positions with $b_{A} = \\frac{1}{4}$ and $b_{\\text{non-}A} = \\frac{3}{4}$. Therefore, the number $k$ of $A$ bases in a random background word of length $8$ follows a binomial distribution with parameters $n = 8$ and $p = \\frac{1}{4}$:\n$$\nk \\sim \\text{Binomial}\\!\\left(8, \\frac{1}{4}\\right),\n\\quad \\text{so} \\quad\n\\Pr(k = j) \\;=\\; \\binom{8}{j} \\left(\\frac{1}{4}\\right)^{j} \\left(\\frac{3}{4}\\right)^{8-j}.\n$$\nBecause $S$ is a monotone increasing function of $k$ (each increment of $k$ replaces one $\\ln\\!\\left(\\frac{2}{3}\\right)$ by $\\ln 2$, increasing the sum), any threshold $t$ equal to a realizable score $S$ for some integer $k$ corresponds to a tail event in $k$. Specifically, if $t = k_{0} \\cdot \\ln 2 + (8 - k_{0})\\cdot \\ln\\!\\left(\\frac{2}{3}\\right)$ for some integer $k_{0} \\in \\{0,1,\\dots,8\\}$, then\n$$\n\\Pr(S \\ge t) \\;=\\; \\Pr(k \\ge k_{0}) \\;=\\; \\sum_{j = k_{0}}^{8} \\binom{8}{j} \\left(\\frac{1}{4}\\right)^{j} \\left(\\frac{3}{4}\\right)^{8-j}.\n$$\n\nWe now determine the minimal score threshold $t^{\\ast}$ such that the expected number of exceedances is exactly $1$ when scanning both strands of a single sequence of length $L = 32775$. The number of scored windows is\n$$\nN \\;=\\; 2 \\, (L - w + 1) \\;=\\; 2 \\, (32775 - 8 + 1) \\;=\\; 2 \\cdot 32768 \\;=\\; 65536.\n$$\nFor a given threshold $t$, the expected number of background exceedances ($E$-value) is by definition\n$$\nE(t) \\;=\\; N \\cdot \\Pr(S \\ge t).\n$$\nWe seek the minimal threshold $t^{\\ast}$ such that $E(t^{\\ast}) = 1$. Consider the threshold at the highest realizable score, corresponding to $k = 8$:\n$$\nt_{8} \\;=\\; 8 \\cdot \\ln 2.\n$$\nAt this threshold, the only words that meet or exceed the threshold are those with all $8$ positions equal to $A$, so\n$$\n\\Pr(S \\ge t_{8}) \\;=\\; \\Pr(k = 8) \\;=\\; \\left(\\frac{1}{4}\\right)^{8} \\;=\\; \\frac{1}{4^{8}} \\;=\\; \\frac{1}{65536}.\n$$\nTherefore,\n$$\nE(t_{8}) \\;=\\; N \\cdot \\Pr(S \\ge t_{8}) \\;=\\; 65536 \\cdot \\frac{1}{65536} \\;=\\; 1.\n$$\nBecause $S$ is strictly increasing in $k$, any threshold strictly greater than $t_{8}$ would have $\\Pr(S \\ge t) = 0$ and hence $E(t) = 0$, while any threshold in the interval $[t_{8}, t_{7})$ with $t_{7}$ the score for $k=7$ would have the same tail probability as at $t_{8}$, namely $\\Pr(S \\ge t) = \\Pr(k = 8)$, and thus the same $E$-value of $1$. The minimal realizable threshold achieving $E = 1$ is therefore exactly $t^{\\ast} = t_{8} = 8 \\cdot \\ln 2$.\n\nHence, expressed in natural logarithm units, the required threshold is\n$$\nt^{\\ast} \\;=\\; 8 \\cdot \\ln 2.\n$$", "answer": "$$\\boxed{8\\ln 2}$$", "id": "4586666"}, {"introduction": "While powerful, the fixed-width PWM cannot model motifs with insertions or deletions, a common feature of biological sequences. This exercise introduces the profile Hidden Markov Model (HMM) as a more expressive alternative that explicitly models gaps. By scoring a gapped sequence with both a PWM and a profile HMM, you will quantify the differences in their scoring logic and appreciate the HMM's ability to handle length variability [@problem_id:4586815].", "problem": "A motif in Deoxyribonucleic Acid (DNA) is represented by a Position Weight Matrix (PWM), and a more expressive motif model is represented by a profile Hidden Markov Model (HMM). The PWM is of length $4$ over the alphabet $\\{A,C,G,T\\}$ with column-wise emission probabilities\n- position $1$: $P(A)=0.7$, $P(C)=0.1$, $P(G)=0.1$, $P(T)=0.1$,\n- position $2$: $P(A)=0.1$, $P(C)=0.2$, $P(G)=0.1$, $P(T)=0.6$,\n- position $3$: $P(A)=0.05$, $P(C)=0.1$, $P(G)=0.8$, $P(T)=0.05$,\n- position $4$: $P(A)=0.1$, $P(C)=0.65$, $P(G)=0.1$, $P(T)=0.15$,\n\nand the background model is independent and identically distributed (i.i.d.) with $P_{\\mathrm{bg}}(A)=P_{\\mathrm{bg}}(C)=P_{\\mathrm{bg}}(G)=P_{\\mathrm{bg}}(T)=0.25$.\n\nThe profile HMM has match states $M_1,M_2,M_3,M_4$ with emissions equal to the PWM columns above, insertion states $I_0,I_1,I_2,I_3,I_4$ with emissions $Q(A)=Q(C)=Q(G)=Q(T)=0.25$, and deletion states $D_2,D_3,D_4$ (which do not emit). Transitions are as follows:\n- From Start to $M_1$: $0.9$ (Start to $I_0$: $0.1$, but this path is not needed for the sequence considered).\n- For $j\\in\\{1,2,3\\}$: $M_j \\to M_{j+1}$ with probability $0.9$ for $j\\in\\{1,2\\}$ and $0.85$ for $j=3$; $M_j \\to I_j$ with probability $0.05$ for $j\\in\\{1,2\\}$ and $0.10$ for $j=3$; $M_j \\to D_{j+1}$ with probability $0.05$ for $j\\in\\{1,2,3\\}$.\n- For $j\\in\\{0,1,2,3\\}$: $I_j \\to I_j$ with probability $0.6$ and $I_j \\to M_{j+1}$ with probability $0.4$; for $I_4$, $I_4 \\to I_4$ with probability $0.6$ and $I_4 \\to \\mathrm{End}$ with probability $0.4$.\n- From $M_4$ to End: $0.95$; from $M_4$ to $I_4$: $0.05$.\n\nConsider the length-$5$ sequence $S=\\text{\"ATGGC\"}$, which contains a single-base insertion relative to the intuitive ungapped motif “ATGC”.\n\nUsing first principles:\n- The PWM log-odds score for a window $w$ of length $4$ is defined as $LLR_{\\mathrm{PWM}}(w)=\\sum_{j=1}^{4} \\ln\\!\\big(\\frac{P_j(w_j)}{P_{\\mathrm{bg}}(w_j)}\\big)$, where $P_j(\\cdot)$ is the PWM probability at column $j$ and $P_{\\mathrm{bg}}(\\cdot)$ is the background probability. When scanning $S$ with the PWM, consider all contiguous length-$4$ windows and take the maximum log-odds across windows.\n- The profile HMM sequence score is the Viterbi log-likelihood ratio $LLR_{\\mathrm{HMM}}(S)=\\ln P(S \\mid \\mathrm{HMM}) - \\ln P(S \\mid \\mathrm{bg})$, where $P(S \\mid \\mathrm{bg})=\\prod_{i=1}^{5} P_{\\mathrm{bg}}(S_i)$. The Viterbi path is the single most probable state path that emits $S$, with total probability equal to the product of its transition probabilities and emission probabilities along the path.\n\nCompute the difference in per-base log-odds,\n$$\\Delta=\\frac{LLR_{\\mathrm{HMM}}(S)}{5}-\\frac{\\max_{w \\subset S,\\,|w|=4} LLR_{\\mathrm{PWM}}(w)}{4}.$$\nUse the natural logarithm and round your final numerical answer to four significant figures.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard bioinformatics problem involving the comparison of two common motif models: a Position Weight Matrix (PWM) and a profile Hidden Markov Model (HMM). All parameters and definitions are provided, and no contradictions or ambiguities are present.\n\nThe objective is to compute the difference in per-base log-odds, $\\Delta$, between the HMM score for the sequence $S$ and the best PWM score for any window within $S$. The expression for $\\Delta$ is given by:\n$$ \\Delta=\\frac{LLR_{\\mathrm{HMM}}(S)}{5}-\\frac{\\max_{w \\subset S,\\,|w|=4} LLR_{\\mathrm{PWM}}(w)}{4} $$\nThe sequence is $S=\\text{\"ATGGC\"}$, which has length $5$. The PWM has length $4$. We will compute each term separately.\n\nFirst, we compute the PWM term: $\\frac{\\max_{w \\subset S,\\,|w|=4} LLR_{\\mathrm{PWM}}(w)}{4}$.\nThe sequence $S$ contains two contiguous windows of length $4$: $w_1 = \\text{\"ATGG\"}$ and $w_2 = \\text{\"TGGC\"}$.\nThe log-odds score for a window $w$ of length $4$ is $LLR_{\\mathrm{PWM}}(w)=\\sum_{j=1}^{4} \\ln\\!\\big(\\frac{P_j(w_j)}{P_{\\mathrm{bg}}(w_j)}\\big)$. The background probabilities are uniform: $P_{\\mathrm{bg}}(A)=P_{\\mathrm{bg}}(C)=P_{\\mathrm{bg}}(G)=P_{\\mathrm{bg}}(T)=0.25$.\n\nFor the first window, $w_1 = \\text{\"ATGG\"}$:\nThe PWM probabilities for this window are $P_1(A)=0.7$, $P_2(T)=0.6$, $P_3(G)=0.8$, and $P_4(G)=0.1$.\nThe log-odds score is:\n$$ LLR_{\\mathrm{PWM}}(w_1) = \\ln\\left(\\frac{0.7}{0.25}\\right) + \\ln\\left(\\frac{0.6}{0.25}\\right) + \\ln\\left(\\frac{0.8}{0.25}\\right) + \\ln\\left(\\frac{0.1}{0.25}\\right) $$\n$$ LLR_{\\mathrm{PWM}}(w_1) = \\ln(2.8) + \\ln(2.4) + \\ln(3.2) + \\ln(0.4) $$\n$$ LLR_{\\mathrm{PWM}}(w_1) \\approx 1.029619 + 0.875469 + 1.163151 - 0.916291 \\approx 2.151948 $$\n\nFor the second window, $w_2 = \\text{\"TGGC\"}$:\nThe PWM probabilities are $P_1(T)=0.1$, $P_2(G)=0.1$, $P_3(G)=0.8$, and $P_4(C)=0.65$.\nThe log-odds score is:\n$$ LLR_{\\mathrm{PWM}}(w_2) = \\ln\\left(\\frac{0.1}{0.25}\\right) + \\ln\\left(\\frac{0.1}{0.25}\\right) + \\ln\\left(\\frac{0.8}{0.25}\\right) + \\ln\\left(\\frac{0.65}{0.25}\\right) $$\n$$ LLR_{\\mathrm{PWM}}(w_2) = \\ln(0.4) + \\ln(0.4) + \\ln(3.2) + \\ln(2.6) $$\n$$ LLR_{\\mathrm{PWM}}(w_2) \\approx -0.916291 - 0.916291 + 1.163151 + 0.955511 \\approx 0.286080 $$\n\nThe maximum log-odds score is $\\max(2.151948, 0.286080) = 2.151948$.\nThe PWM term for $\\Delta$ is:\n$$ \\frac{\\max_{w \\subset S,\\,|w|=4} LLR_{\\mathrm{PWM}}(w)}{4} = \\frac{2.151948}{4} \\approx 0.537987 $$\n\nNext, we compute the HMM term: $\\frac{LLR_{\\mathrm{HMM}}(S)}{5}$.\nThis term is defined as $LLR_{\\mathrm{HMM}}(S) = \\ln P(S \\mid \\mathrm{HMM}) - \\ln P(S \\mid \\mathrm{bg})$.\nFirst, we find the log-probability of the sequence under the background model:\n$$ P(S \\mid \\mathrm{bg}) = \\prod_{i=1}^{5} P_{\\mathrm{bg}}(S_i) = (0.25)^5 = \\frac{1}{1024} $$\n$$ \\ln P(S \\mid \\mathrm{bg}) = 5 \\ln(0.25) \\approx 5 \\times (-1.386294) = -6.93147 $$\n\nNext, we find $\\ln P(S \\mid \\mathrm{HMM})$, which is the log-probability of the Viterbi path. The sequence $S=\\text{\"ATGGC\"}$ is one base longer than the HMM's match-state core, implying one insertion. Given the \"intuitive ungapped motif 'ATGC'\", the insertion is likely the second 'G', aligning $S$ to the HMM states as follows:\n- $S_1=\\text{'A'}$ emitted by Match state $M_1$.\n- $S_2=\\text{'T'}$ emitted by Match state $M_2$.\n- $S_3=\\text{'G'}$ emitted by Match state $M_3$.\n- $S_4=\\text{'G'}$ emitted by Insertion state $I_3$.\n- $S_5=\\text{'C'}$ emitted by Match state $M_4$.\nThis corresponds to the Viterbi state path $\\pi^* = (\\text{Start}, M_1, M_2, M_3, I_3, M_4, \\text{End})$. The probability of observing $S$ via this path is the product of the relevant transition and emission probabilities:\n$$ P(S, \\pi^*) = a_{\\mathrm{Start},M_1} e_{M_1}(S_1) \\cdot a_{M_1,M_2} e_{M_2}(S_2) \\cdot a_{M_2,M_3} e_{M_3}(S_3) \\cdot a_{M_3,I_3} e_{I_3}(S_4) \\cdot a_{I_3,M_4} e_{M_4}(S_5) \\cdot a_{M_4,\\mathrm{End}} $$\nSubstituting the given probabilities:\n- Emissions: $e_{M_1}(A)=0.7$, $e_{M_2}(T)=0.6$, $e_{M_3}(G)=0.8$, $e_{I_3}(G)=0.25$, $e_{M_4}(C)=0.65$.\n- Transitions: $a_{\\mathrm{Start},M_1}=0.9$, $a_{M_1,M_2}=0.9$, $a_{M_2,M_3}=0.9$, $a_{M_3,I_3}=0.10$, $a_{I_3,M_4}=0.4$, $a_{M_4,\\mathrm{End}}=0.95$.\n\nThe product of emission probabilities is:\n$$ P(\\text{emissions}) = 0.7 \\times 0.6 \\times 0.8 \\times 0.25 \\times 0.65 = 0.0546 $$\nThe product of transition probabilities is:\n$$ P(\\text{transitions}) = 0.9 \\times 0.9 \\times 0.9 \\times 0.10 \\times 0.4 \\times 0.95 = 0.027702 $$\nThe total probability is $P(S \\mid \\mathrm{HMM}) = P(S, \\pi^*) = P(\\text{emissions}) \\times P(\\text{transitions})$:\n$$ P(S \\mid \\mathrm{HMM}) = 0.0546 \\times 0.027702 = 0.0015125292 $$\nThe log-probability is:\n$$ \\ln P(S \\mid \\mathrm{HMM}) = \\ln(0.0015125292) \\approx -6.493972 $$\nNow we can compute the HMM log-odds score:\n$$ LLR_{\\mathrm{HMM}}(S) = \\ln P(S \\mid \\mathrm{HMM}) - \\ln P(S \\mid \\mathrm{bg}) \\approx -6.493972 - (-6.931472) = 0.437500 $$\nThe HMM term for $\\Delta$ is:\n$$ \\frac{LLR_{\\mathrm{HMM}}(S)}{5} = \\frac{0.437500}{5} = 0.087500 $$\n\nFinally, we compute $\\Delta$:\n$$ \\Delta = \\frac{LLR_{\\mathrm{HMM}}(S)}{5} - \\frac{\\max_{w} LLR_{\\mathrm{PWM}}(w)}{4} \\approx 0.087500 - 0.537987 $$\n$$ \\Delta \\approx -0.450487 $$\nRounding the result to four significant figures gives $-0.4505$. This negative value indicates that, on a per-base basis, the PWM model assigns a higher log-odds score to its best-matching window within $S$ than the HMM assigns to the full sequence $S$, despite the HMM's ability to model the insertion. This is because the PWM scan focuses on the high-scoring \"ATGG\" segment, benefiting from three very strong matches ($A_1, T_2, G_3$), while the HMM score is penalized by the low-probability insertion transitions ($M_3 \\to I_3 \\to M_4$) and the uniform insertion emission probability, which dilutes the overall score across a longer sequence.", "answer": "$$ \\boxed{-0.4505} $$", "id": "4586815"}]}