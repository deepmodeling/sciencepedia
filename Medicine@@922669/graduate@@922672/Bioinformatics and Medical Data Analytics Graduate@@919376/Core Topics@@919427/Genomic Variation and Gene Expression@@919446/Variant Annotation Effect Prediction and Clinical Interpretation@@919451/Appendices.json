{"hands_on_practices": [{"introduction": "A crucial first step in evaluating any genomic variant is to assess the quality of the raw data from which it was called. Phred-scaled quality scores are the universal language for communicating error probabilities in sequencing. This exercise [@problem_id:4616850] challenges you to work from first principles, combining the independent error probabilities associated with base calling, read mapping, and genotype assignment to derive a single, comprehensive quality score for a variant call.", "problem": "An exome sequencing Single Nucleotide Variant (SNV) in a gene associated with cardiomyopathy has been detected with the following quality metrics extracted from the raw alignment and variant calling pipeline: base quality score for the variant-supporting nucleotide $Q_{b} = 30$, mapping quality score for the read carrying the variant $Q_{m} = 20$, and genotype quality score for the sample’s diploid genotype at this locus $Q_{g} = 40$. The Phred-scaled quality score transformation is defined as $Q = -10 \\log_{10} p$, where $p$ is the probability that the corresponding assertion is wrong.\n\nUsing the axioms of probability and assuming that base miscall, incorrect read mapping, and incorrect genotype assignment are independent failure modes, derive an expression for the overall variant call error probability $p_{\\text{err}}$ in terms of $p_{b}$, $p_{m}$, and $p_{g}$, where $p_{b}$, $p_{m}$, and $p_{g}$ are the error probabilities implied by $Q_{b}$, $Q_{m}$, and $Q_{g}$, respectively. Then convert $p_{\\text{err}}$ to a combined Phred-scaled score $Q_{\\text{combined}}$ using the same transformation. In your derivation, interpret $Q$ for base quality, mapping quality, and genotype quality explicitly in terms of their error probabilities, and justify the combination step from first principles.\n\nCompute the numerical value of $Q_{\\text{combined}}$ for the given $Q_{b}$, $Q_{m}$, and $Q_{g}$, and round your answer to four significant figures. Express the final answer as a Phred-scaled score without units.", "solution": "The problem requires the derivation of a combined Phred-scaled quality score, $Q_{\\text{combined}}$, from three independent quality metrics associated with a single nucleotide variant (SNV) call: base quality ($Q_{b}$), mapping quality ($Q_{m}$), and genotype quality ($Q_{g}$). The derivation must be based on first principles of probability.\n\nFirst, we must formalize the relationship between a Phred-scaled quality score, $Q$, and the error probability, $p$, it represents. The problem provides the definition:\n$$Q = -10 \\log_{10} p$$\nwhere $p$ is the probability that the assertion associated with the quality score is incorrect. To facilitate our derivation, we must invert this relationship to express the error probability $p$ as a function of the quality score $Q$.\n$$-\\frac{Q}{10} = \\log_{10} p$$\n$$p = 10^{-Q/10}$$\n\nNext, we interpret the specific quality scores provided in the context of their corresponding error probabilities.\n1.  The base quality score, $Q_{b}$, corresponds to the probability, $p_{b}$, that the nucleotide base at that specific position has been miscalled by the sequencing instrument. Thus, $p_{b} = 10^{-Q_{b}/10}$.\n2.  The mapping quality score, $Q_{m}$, corresponds to the probability, $p_{m}$, that the short read containing the variant has been incorrectly aligned to its position in the reference genome. Thus, $p_{m} = 10^{-Q_{m}/10}$.\n3.  The genotype quality score, $Q_{g}$, corresponds to the probability, $p_{g}$, that the diploid genotype assigned to the sample at this locus is incorrect. Thus, $p_{g} = 10^{-Q_{g}/10}$.\n\nThe ultimate goal is to determine the overall probability that the variant call is erroneous, $p_{\\text{err}}$. A variant call is considered valid and correct only if all underlying assertions are simultaneously correct. Let $C_{b}$, $C_{m}$, and $C_{g}$ be the events that the base call is correct, the read mapping is correct, and the genotype assignment is correct, respectively. The probabilities of these events are the complements of their respective error probabilities:\n$$P(C_{b}) = 1 - p_{b}$$\n$$P(C_{m}) = 1 - p_{m}$$\n$$P(C_{g}) = 1 - p_{g}$$\n\nThe problem states that the failure modes (base miscall, incorrect mapping, incorrect genotype) are independent. This statistical independence implies that the events of correctness, $C_{b}$, $C_{m}$, and $C_{g}$, are also independent. Therefore, the probability that the overall variant call is correct, $P(\\text{Correct})$, is the product of the probabilities of these independent events:\n$$P(\\text{Correct}) = P(C_{b} \\cap C_{m} \\cap C_{g}) = P(C_{b})P(C_{m})P(C_{g})$$\nSubstituting the expressions for the individual probabilities of correctness, we get:\n$$P(\\text{Correct}) = (1 - p_{b})(1 - p_{m})(1 - p_{g})$$\n\nThe overall variant call error probability, $p_{\\text{err}}$, is the probability that the call is *not* correct. This is the complement of $P(\\text{Correct})$:\n$$p_{\\text{err}} = 1 - P(\\text{Correct})$$\nSubstituting the expression for $P(\\text{Correct})$ yields the derived expression for $p_{\\text{err}}$ in terms of the individual error probabilities:\n$$p_{\\text{err}} = 1 - (1 - p_{b})(1 - p_{m})(1 - p_{g})$$\n\nNow, we can convert this overall error probability back into a combined Phred-scaled score, $Q_{\\text{combined}}$, using the original definition:\n$$Q_{\\text{combined}} = -10 \\log_{10}(p_{\\text{err}})$$\n$$Q_{\\text{combined}} = -10 \\log_{10}[1 - (1 - p_{b})(1 - p_{m})(1 - p_{g})]$$\nWe can also express this in terms of the initial quality scores $Q_{b}$, $Q_{m}$, and $Q_{g}$:\n$$Q_{\\text{combined}} = -10 \\log_{10}[1 - (1 - 10^{-Q_{b}/10})(1 - 10^{-Q_{m}/10})(1 - 10^{-Q_{g}/10})]$$\n\nWith the derived expression, we proceed to compute the numerical value for the given quality scores: $Q_{b} = 30$, $Q_{m} = 20$, and $Q_{g} = 40$.\n\nFirst, calculate the individual error probabilities:\n$$p_{b} = 10^{-Q_{b}/10} = 10^{-30/10} = 10^{-3} = 0.001$$\n$$p_{m} = 10^{-Q_{m}/10} = 10^{-20/10} = 10^{-2} = 0.01$$\n$$p_{g} = 10^{-Q_{g}/10} = 10^{-40/10} = 10^{-4} = 0.0001$$\n\nNext, calculate the overall error probability $p_{\\text{err}}$:\n$$p_{\\text{err}} = 1 - (1 - 0.001)(1 - 0.01)(1 - 0.0001)$$\n$$p_{\\text{err}} = 1 - (0.999)(0.99)(0.9999)$$\n$$p_{\\text{err}} = 1 - (0.98901)(0.9999)$$\n$$p_{\\text{err}} = 1 - 0.988911099$$\n$$p_{\\text{err}} = 0.011088901$$\n\nFinally, calculate the combined Phred score $Q_{\\text{combined}}$:\n$$Q_{\\text{combined}} = -10 \\log_{10}(0.011088901)$$\nUsing a calculator for the logarithm:\n$$\\log_{10}(0.011088901) \\approx -1.95511$$\n$$Q_{\\text{combined}} \\approx -10 \\times (-1.95511)$$\n$$Q_{\\text{combined}} \\approx 19.5511$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$Q_{\\text{combined}} \\approx 19.55$$\nThis combined score is significantly lower than $Q_b$ and $Q_g$ because the overall quality is dominated by the weakest link in the chain of evidence, which in this case is the mapping quality $Q_m = 20$. The overall error probability $p_{\\text{err}} \\approx 0.011$ is close to the largest individual error probability $p_m = 0.01$.", "answer": "$$\\boxed{19.55}$$", "id": "4616850"}, {"introduction": "Beyond the quality scores reported by the sequencing pipeline, a critical quality control step involves examining the read evidence at the variant locus itself. For a true heterozygous variant in a diploid organism, we expect a roughly balanced representation of reads supporting the reference and alternate alleles. This practice [@problem_id:4616746] provides a hands-on opportunity to calculate the allele balance from raw read counts and use statistical reasoning to determine if the observation is consistent with a true heterozygous genotype or may represent a sequencing artifact.", "problem": "A single-nucleotide variant is observed in a human germline sample processed through the Variant Call Format (VCF) pipeline. The depth field ($DP$) reports the total number of reads covering the locus, and the allele depth field ($AD$) reports the number of reads supporting the reference allele and the alternate allele in that order. The allele balance (AB) is defined as the proportion of reads assigned to the alternate allele among reads assigned to the alleles at the locus. Assume standard high-throughput sequencing where, under a true diploid heterozygous genotype, each read arises from one of two chromosomal copies and the assignment of a read to the reference or alternate allele is an independent trial; consequently, the alternate-allele read count under a heterozygous genotype follows a Binomial distribution with success probability $0.5$.\n\nYou are given $DP=80$ and $AD=\\{48,32\\}$. Using the definitions above and standard quality control (QC) heuristics for germline heterozygous single-nucleotide variants—namely, that a typical heterozygous filter requires allele balance in the interval $[0.3,0.7]$, an alternate-allele read count of at least $10$, and that the observed allele balance should be statistically consistent with $0.5$ at confidence level $0.95$ under a Gaussian approximation to the Binomial distribution—compute the allele balance $AB$ from these fields. Then, based on first principles and the provided assumptions, reason whether the heterozygous call is reliable under these typical QC thresholds. \n\nReport only the numerical value of $AB$ as a decimal fraction, rounded to four significant figures.", "solution": "The problem requires the calculation of the allele balance ($AB$) for a single-nucleotide variant and a subsequent evaluation of its reliability as a heterozygous call based on a set of standard quality control (QC) criteria.\n\nThe allele depth field $AD=\\{48, 32\\}$ specifies the number of reads supporting the reference allele, $N_{REF}$, and the alternate allele, $N_{ALT}$, respectively.\nThus, we have:\n$N_{REF} = 48$\n$N_{ALT} = 32$\n\nThe total number of reads supporting these two alleles is $n = N_{REF} + N_{ALT} = 48 + 32 = 80$. This is consistent with the given total depth $DP=80$.\n\nThe allele balance ($AB$) is defined as the proportion of reads assigned to the alternate allele. It is calculated as:\n$$AB = \\frac{N_{ALT}}{N_{REF} + N_{ALT}} = \\frac{32}{80} = 0.4$$\nThe problem requires this value to be reported as a decimal fraction rounded to four significant figures, which is $0.4000$.\n\nNext, we must assess whether this heterozygous call is reliable by evaluating it against the three provided QC heuristics.\n\n1.  **Criterion 1: Allele Balance Range**\n    The filter requires the allele balance to be within the interval $[0.3, 0.7]$. Our calculated allele balance is $AB=0.4$. Since $0.3 \\le 0.4 \\le 0.7$, this criterion is met.\n\n2.  **Criterion 2: Alternate Allele Read Count**\n    The filter requires the alternate-allele read count, $N_{ALT}$, to be at least $10$. Our observed count is $N_{ALT}=32$. Since $32 \\ge 10$, this criterion is also met.\n\n3.  **Criterion 3: Statistical Consistency**\n    This criterion requires the observed allele balance to be statistically consistent with the theoretical expectation for a true heterozygote ($p=0.5$) at a confidence level of $0.95$. We are instructed to use a Gaussian approximation to the Binomial distribution.\n\n    Let $p$ be the true proportion of alternate alleles. For a heterozygous diploid locus, the null hypothesis is $H_0: p = p_0 = 0.5$. The observed sample proportion is $\\hat{p} = AB = 0.4$. The number of trials is the total read count, $n=80$.\n\n    The Central Limit Theorem states that for a sufficiently large sample size $n$, the sampling distribution of the sample proportion $\\hat{p}$ can be approximated by a normal (Gaussian) distribution with mean $p$ and standard deviation (standard error) $SE = \\sqrt{\\frac{p(1-p)}{n}}$. The validity of this approximation is contingent on $np \\ge 5$ and $n(1-p) \\ge 5$. Under our null hypothesis, $n p_0 = 80 \\times 0.5 = 40$ and $n(1-p_0) = 80 \\times 0.5 = 40$. Both values are substantially greater than $5$, so the Gaussian approximation is well-justified.\n\n    We test for statistical consistency by constructing a $95\\%$ confidence interval (or more accurately, an acceptance region) for the sample proportion $\\hat{p}$ under the null hypothesis $p_0=0.5$. If our observed $\\hat{p}=0.4$ falls within this region, we consider it consistent.\n\n    The standard error under the null hypothesis is:\n    $$SE_0 = \\sqrt{\\frac{p_0(1-p_0)}{n}} = \\sqrt{\\frac{0.5 \\times (1-0.5)}{80}} = \\sqrt{\\frac{0.25}{80}} = \\sqrt{\\frac{1}{320}}$$\n    $$SE_0 \\approx 0.0559017$$\n\n    For a $95\\%$ confidence level, the significance level is $\\alpha = 1 - 0.95 = 0.05$. For a two-tailed test, we use the z-score $z_{\\alpha/2} = z_{0.025}$, which corresponds to the upper $2.5\\%$ tail of the standard normal distribution. The value is $z_{0.025} \\approx 1.96$.\n\n    The $95\\%$ acceptance region for $\\hat{p}$ is given by:\n    $$[p_0 - z_{\\alpha/2} \\cdot SE_0, p_0 + z_{\\alpha/2} \\cdot SE_0]$$\n    Substituting the values:\n    $$[0.5 - 1.96 \\times \\sqrt{\\frac{1}{320}}, 0.5 + 1.96 \\times \\sqrt{\\frac{1}{320}}]$$\n    $$[0.5 - 1.96 \\times 0.0559017, 0.5 + 1.96 \\times 0.0559017]$$\n    $$[0.5 - 0.109567, 0.5 + 0.109567]$$\n    $$[0.390433, 0.609567]$$\n\n    We compare our observed allele balance, $AB=0.4$, to this interval. Since $0.390433 \\le 0.4 \\le 0.609567$, the observed value falls within the $95\\%$ acceptance region. Therefore, the observed deviation from a perfect $0.5$ balance is not statistically significant at the $\\alpha=0.05$ level. This criterion is met.\n\n    An equivalent approach is to calculate the z-statistic for our observation and compare it to the critical value of $\\pm 1.96$:\n    $$z = \\frac{\\hat{p} - p_0}{SE_0} = \\frac{0.4 - 0.5}{\\sqrt{1/320}} = \\frac{-0.1}{0.0559017} \\approx -1.7888$$\n    Since $|-1.7888| < 1.96$, we fail to reject the null hypothesis, confirming the statistical consistency.\n\nIn conclusion, the variant call with $DP=80$ and $AD=\\{48,32\\}$ successfully passes all three specified QC filters:\n1.  Allele balance $AB=0.4$ is in $[0.3, 0.7]$.\n2.  Alternate allele count $N_{ALT}=32$ is $\\ge 10$.\n3.  The allele balance is statistically consistent with the expected value of $0.5$ for a heterozygous genotype at a $95\\%$ confidence level.\n\nBased on this comprehensive evaluation, the heterozygous call is deemed reliable under the given QC heuristics. The sole numerical value requested for the final answer is the allele balance $AB$.", "answer": "$$\\boxed{0.4000}$$", "id": "4616746"}, {"introduction": "Once a variant has passed quality control, its potential biological impact must be determined by translating its genomic coordinates into a functional context. This process is complicated by the fact that a single gene can produce multiple transcript isoforms through alternative splicing. This exercise [@problem_id:4616883] demonstrates the essential task of converting a variant from the standard Variant Call Format (VCF) to the clinically recognized Human Genome Variation Society (HGVS) notation, revealing how a single DNA change can have multiple, distinct predicted effects on the protein.", "problem": "A laboratory has identified a single-nucleotide variant using the Variant Call Format (VCF) on Genome Reference Consortium Human build 38 (GRCh38). The variant is specified by the standard VCF fields as follows: chromosome is \"chr12\", position is $112{,}036$, reference allele is \"G\", and alternate allele is \"A\". The gene lies on the positive strand and has three clinically curated transcripts with distinct coding sequence architectures. The aim is to convert this VCF variant to Human Genome Variation Society (HGVS) coding DNA (c.) and protein (p.) notation for each transcript accession and to quantify ambiguity at the protein level when multiple transcripts exist.\n\nUse the following scientifically sound and widely accepted bases:\n- Central dogma of molecular biology: deoxyribonucleic acid (DNA) is transcribed to ribonucleic acid (RNA) and translated to protein by interpreting consecutive triplets (codons) in the coding DNA sequence.\n- HGVS coding DNA numbering starts at the adenine of the canonical start codon \"ATG\" as $c.1$, incrementing by $1$ per coding base. Bases upstream of the coding DNA start are indexed as negative positions $c.-n$. Protein amino acid positions are counted from the initiator methionine as $p.1$.\n- A protein change $p.XmY$ denotes a substitution from amino acid $X$ at position $m$ to amino acid $Y$. If a variant is outside the coding sequence such that protein impact cannot be inferred, denote the protein annotation as $p.?$. If a codon changes its encoded amino acid, apply the standard genetic code to map triplets to amino acids.\n\nTranscript-specific data (all positions are genomic on GRCh38; all transcripts are on the positive strand):\n1. Transcript accession \"NM\\_000AAA.1\": The total number of coding bases preceding the variant position $112{,}036$ is $66$. The reference codon spanning coding DNA positions $c.67$ to $c.69$ is \"GAA\".\n2. Transcript accession \"NM\\_000BBB.2\": The total number of coding bases preceding the variant position $112{,}036$ is $63$. The reference codon spanning coding DNA positions $c.64$ to $c.66$ is \"GAT\".\n3. Transcript accession \"NM\\_000CCC.3\": The coding DNA start of the transcript is at genomic position $112{,}051$.\n\nTasks:\n- For each transcript, derive the HGVS coding DNA (c.) notation for the variant, using the definition of coding DNA numbering.\n- For \"NM\\_000AAA.1\" and \"NM\\_000BBB.2\", determine the HGVS protein (p.) notation by identifying the affected codon position and applying the standard genetic code before and after the single-nucleotide change \"G\" to \"A\" at the specified coding DNA position. For \"NM\\_000CCC.3\", determine the appropriate HGVS protein (p.) notation under HGVS rules.\n- Finally, compute the number of distinct HGVS protein-level notations produced across the three transcripts.\n\nExpress your final answer as a single integer (dimensionless). No rounding is required.", "solution": "The problem requires the conversion of a single-nucleotide variant, specified in Variant Call Format (VCF), into Human Genome Variation Society (HGVS) notation for three different transcripts of a gene. Subsequently, the number of distinct protein-level consequences must be quantified.\n\nThe genomic variant is located at `chr12:g.112036G>A` on the GRCh38 assembly. Since the gene is on the positive strand, the reference allele is 'G' and the alternate allele is 'A'. We will analyze each transcript individually.\n\n**Analysis for Transcript 1: \"NM_000AAA.1\"**\n\n*   **HGVS Coding DNA (c.) Notation**:\n    The problem states that there are $66$ coding bases in this transcript that occur before the genomic position $112,036$. According to HGVS rules, where numbering starts at $c.1$, the base at the variant's position is the $(66+1)$-th coding base. Therefore, the coding DNA position of the variant is $c.67$. The change is from 'G' to 'A'.\n    The HGVS coding DNA notation is `NM_000AAA.1:c.67G>A`.\n\n*   **HGVS Protein (p.) Notation**:\n    The variant is at coding position $c.67$. To find the affected amino acid position, we use the formula $m = \\lceil \\frac{c_{pos}}{3} \\rceil$, where $c_{pos}$ is the coding DNA position.\n    $$m = \\left\\lceil \\frac{67}{3} \\right\\rceil = \\lceil 22.333... \\rceil = 23$$\n    The variant affects the amino acid at protein position $p.23$.\n    The variant base at $c.67$ is the first base of the codon that spans positions $c.67$, $c.68$, and $c.69$. The problem provides the reference codon as \"GAA\". The substitution $c.67\\text{G}>\\text{A}$ changes this codon.\n    - Reference codon: GAA\n    - Altered codon: AAA\n    Applying the standard genetic code:\n    - GAA encodes Glutamic Acid (E).\n    - AAA encodes Lysine (K).\n    The change is a substitution from Glutamic Acid to Lysine at position $23$.\n    The HGVS protein notation is $p.\\text{Glu}23\\text{Lys}$, or using single-letter codes, $p.\\text{E}23\\text{K}$.\n\n**Analysis for Transcript 2: \"NM_000BBB.2\"**\n\n*   **HGVS Coding DNA (c.) Notation**:\n    There are $63$ coding bases preceding the genomic position $112,036$. The base at the variant's position is therefore the $(63+1)$-th coding base, which is $c.64$. The change is from 'G' to 'A'.\n    The HGVS coding DNA notation is `NM_000BBB.2:c.64G>A`.\n\n*   **HGVS Protein (p.) Notation**:\n    The variant is at coding position $c.64$. The affected amino acid position is:\n    $$m = \\left\\lceil \\frac{64}{3} \\right\\rceil = \\lceil 21.333... \\rceil = 22$$\n    The variant affects the amino acid at protein position $p.22$.\n    The variant base at $c.64$ is the first base of the codon spanning positions $c.64$, $c.65$, and $c.66$. The reference codon is given as \"GAT\". The substitution $c.64\\text{G}>\\text{A}$ changes this codon.\n    - Reference codon: GAT\n    - Altered codon: AAT\n    Applying the standard genetic code:\n    - GAT encodes Aspartic Acid (D).\n    - AAT encodes Asparagine (N).\n    The change is a substitution from Aspartic Acid to Asparagine at position $22$.\n    The HGVS protein notation is $p.\\text{Asp}22\\text{Asn}$, or using single-letter codes, $p.\\text{D}22\\text{N}$.\n\n**Analysis for Transcript 3: \"NM_000CCC.3\"**\n\n*   **HGVS Coding DNA (c.) Notation**:\n    The genomic position of the variant is $112,036$. The coding DNA start ($c.1$) is at genomic position $112,051$. The variant is upstream of the coding start site. The distance is:\n    $$112,051 - 112,036 = 15 \\text{ bases}$$\n    According to HGVS nomenclature, positions upstream of the start codon are numbered negatively from $c.1$. Thus, the variant is at position $c.1-15$, which is denoted as $c.-15$.\n    The HGVS coding DNA notation is `NM_000CCC.3:c.-15G>A`.\n\n*   **HGVS Protein (p.) Notation**:\n    The variant is located in the $5'$ untranslated region (UTR), outside the coding sequence. As per the problem's definition and standard HGVS rules, when a variant's effect on the protein sequence cannot be directly determined (as is the case for non-coding variants), the notation $p.?$ is used.\n    The HGVS protein notation is $p.?$.\n\n**Final Calculation: Number of Distinct Protein Notations**\n\nWe have derived the following three protein-level notations for the transcripts:\n1.  For \"NM_000AAA.1\": $p.\\text{E}23\\text{K}$ (a missense variant at position $23$)\n2.  For \"NM_000BBB.2\": $p.\\text{D}22\\text{N}$ (a missense variant at position $22$)\n3.  For \"NM_000CCC.3\": $p.?$ (an upstream variant with unknown protein consequence)\n\nThese three notations, $p.\\text{E}23\\text{K}$, $p.\\text{D}22\\text{N}$, and $p.?$, are all distinct from one another. They represent different types of consequences at different positions or a lack of a predictable coding change.\n\nTherefore, the number of distinct HGVS protein-level notations produced across the three transcripts is $3$.", "answer": "$$\\boxed{3}$$", "id": "4616883"}]}