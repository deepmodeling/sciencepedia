{"hands_on_practices": [{"introduction": "Before searching for genetic associations, it is essential to ensure the quality of the genotype data. This exercise introduces a fundamental quality control check: testing for Hardy-Weinberg Equilibrium (HWE). By comparing observed genotype frequencies to those expected under HWE, you can identify potential issues like genotyping errors or unmodeled population structure, which are critical to address for a valid Genome-Wide Association Study (GWAS) [@problem_id:4568653].", "problem": "A research team is performing genotype quality control for a Genome-Wide Association Study (GWAS) and evaluates Hardy–Weinberg Equilibrium (HWE) in the control cohort as part of variant-level filtering. Consider a single autosomal bi-allelic locus with alleles $A$ and $a$. In a set of $500$ unrelated controls of homogeneous ancestry, the observed genotype counts are $(AA, Aa, aa) = (320, 160, 20)$. Under the HWE null hypothesis, genotype frequencies are determined by the allele frequencies assuming random mating and no inbreeding. Using the Pearson chi-squared goodness-of-fit test and the standard asymptotic reference distribution appropriate when the allele frequency is estimated from the sample, compute the HWE chi-squared statistic from first principles starting with the definition of allele frequency and expected genotype counts. Then, using the chi-squared reference distribution, determine whether the associated $p$-value satisfies $p  10^{-4}$.\n\nProvide your final answer as a $1 \\times 2$ row matrix $\\big[\\chi^{2}, D\\big]$, where $\\chi^{2}$ is the computed HWE chi-squared statistic, and $D \\in \\{0,1\\}$ is an indicator equal to $1$ if the $p$-value is less than $10^{-4}$ and $0$ otherwise. No rounding is required, and no units are needed.", "solution": "The problem statement is first validated for scientific soundness, consistency, and completeness.\n\n**Step 1: Extract Givens**\n- Locus: Single autosomal bi-allelic locus with alleles $A$ and $a$.\n- Sample: $N=500$ unrelated controls of homogeneous ancestry.\n- Observed Genotype Counts: $(O_{AA}, O_{Aa}, O_{aa}) = (320, 160, 20)$.\n- Null Hypothesis ($H_0$): The locus is in Hardy-Weinberg Equilibrium (HWE).\n- Statistical Test: Pearson chi-squared goodness-of-fit test.\n- Reference Distribution: Asymptotic chi-squared distribution, with degrees of freedom adjusted for the estimation of allele frequency from the sample data.\n- Task 1: Compute the HWE chi-squared statistic ($\\chi^2$) from first principles.\n- Task 2: Determine if the p-value satisfies $p  10^{-4}$ and set an indicator variable $D$ accordingly ($D=1$ if true, $D=0$ if false).\n- Final Answer Format: A $1 \\times 2$ row matrix $[\\chi^2, D]$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is grounded in fundamental principles of population genetics (Hardy-Weinberg Equilibrium) and standard biostatistical methods (Pearson's chi-squared test). Testing for HWE is a routine and critical step in the quality control pipeline for Genome-Wide Association Studies (GWAS). The setup is scientifically realistic and correct.\n- **Well-Posed**: The problem is well-posed. It provides all necessary data (observed counts, sample size) to perform the required calculations. The statistical procedure and the quantities to be calculated are explicitly defined. The total sample size from the counts is $320+160+20=500$, which is consistent with the stated sample size $N=500$. A unique and meaningful solution exists.\n- **Objective**: The problem is stated using precise, objective, and quantitative language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\nThe solution proceeds by first estimating the allele frequencies from the observed data, then calculating the expected genotype counts under the HWE null hypothesis, and finally computing the chi-squared statistic.\n\n**1. Estimation of Allele Frequencies**\nThe total number of individuals in the sample is $N = 320 + 160 + 20 = 500$.\nSince each diploid individual carries two alleles, the total number of alleles in the sample is $2N = 1000$.\n\nThe number of $A$ alleles, $N_A$, is calculated from the genotype counts:\n$$N_A = (2 \\times \\text{count of } AA) + (1 \\times \\text{count of } Aa)$$\n$$N_A = (2 \\times 320) + 160 = 640 + 160 = 800$$\n\nThe number of $a$ alleles, $N_a$, is similarly calculated:\n$$N_a = (2 \\times \\text{count of } aa) + (1 \\times \\text{count of } Aa)$$\n$$N_a = (2 \\times 20) + 160 = 40 + 160 = 200$$\nAs a check, $N_A + N_a = 800 + 200 = 1000 = 2N$.\n\nThe frequencies of alleles $A$ and $a$, denoted by $p$ and $q$ respectively, are estimated from the sample:\n$$p = \\frac{N_A}{2N} = \\frac{800}{1000} = 0.8$$\n$$q = \\frac{N_a}{2N} = \\frac{200}{1000} = 0.2$$\nAs a check, $p+q = 0.8 + 0.2 = 1.0$.\n\n**2. Calculation of Expected Genotype Counts under HWE**\nUnder the HWE null hypothesis, the expected genotype frequencies are $p^2$ for $AA$, $2pq$ for $Aa$, and $q^2$ for $aa$. The expected genotype counts are these frequencies multiplied by the total sample size $N$.\n\nExpected count of $AA$:\n$$E_{AA} = N \\times p^2 = 500 \\times (0.8)^2 = 500 \\times 0.64 = 320$$\n\nExpected count of $Aa$:\n$$E_{Aa} = N \\times 2pq = 500 \\times 2 \\times 0.8 \\times 0.2 = 500 \\times 0.32 = 160$$\n\nExpected count of $aa$:\n$$E_{aa} = N \\times q^2 = 500 \\times (0.2)^2 = 500 \\times 0.04 = 20$$\nAs a check, the sum of expected counts is $320 + 160 + 20 = 500 = N$.\n\n**3. Calculation of the Pearson Chi-Squared Statistic**\nThe Pearson chi-squared statistic, $\\chi^2$, is calculated as the sum of the squared differences between observed ($O$) and expected ($E$) counts, each divided by the expected count:\n$$\\chi^2 = \\sum_{i \\in \\{\\text{genotypes}\\}} \\frac{(O_i - E_i)^2}{E_i}$$\nThe observed counts are $O_{AA} = 320$, $O_{Aa} = 160$, and $O_{aa} = 20$.\nThe expected counts are $E_{AA} = 320$, $E_{Aa} = 160$, and $E_{aa} = 20$.\n\nSubstituting these values into the formula:\n$$\\chi^2 = \\frac{(320 - 320)^2}{320} + \\frac{(160 - 160)^2}{160} + \\frac{(20 - 20)^2}{20}$$\n$$\\chi^2 = \\frac{0^2}{320} + \\frac{0^2}{160} + \\frac{0^2}{20} = 0 + 0 + 0 = 0$$\nThe computed chi-squared statistic is $\\chi^2 = 0$.\n\n**4. Determination of Degrees of Freedom and p-value**\nFor a chi-squared goodness-of-fit test, the degrees of freedom ($df$) are calculated as:\n$$df = (\\text{number of categories}) - 1 - (\\text{number of estimated parameters})$$\nIn this case, there are $3$ genotype categories ($AA, Aa, aa$). We estimated one parameter from the data, the allele frequency $p$ (since $q$ is determined by $p$ as $q=1-p$).\nTherefore, the degrees of freedom are:\n$$df = 3 - 1 - 1 = 1$$\n\nThe p-value is the probability of obtaining a test statistic at least as extreme as the one observed, assuming the null hypothesis is true. This corresponds to the upper tail of the chi-squared distribution with $1$ degree of freedom.\n$$p = P(\\chi^2_{df=1} \\ge 0)$$\nBy definition, the chi-squared statistic is always non-negative. The probability of obtaining a value greater than or equal to $0$ is $1$.\nThus, the p-value is $p=1$.\n\nThe problem requires determining if $p  10^{-4}$. We must check if $1  10^{-4}$, which is equivalent to checking if $1  0.0001$. This inequality is false.\nTherefore, the indicator variable $D$ is $0$.\n\nThe final answer is the row matrix $[\\chi^2, D] = [0, 0]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$", "id": "4568653"}, {"introduction": "A primary challenge in GWAS design is avoiding spurious associations caused by population stratification, a major source of confounding. This thought experiment demonstrates how systematic differences in allele frequencies and disease prevalence between underlying subpopulations can create a false-positive signal for a non-causal variant [@problem_id:4568675]. Working through this scenario will clarify why accounting for population ancestry is a non-negotiable step in robust association studies.", "problem": "Consider a genome-wide association study (GWAS) designed as a case-control study in a stratified population with two subpopulations, denoted $S_{1}$ and $S_{2}$. The disease prevalence in $S_{1}$ is $\\pi_{1} = 0.1$ and in $S_{2}$ is $\\pi_{2} = 0.2$. A single-nucleotide polymorphism (SNP) has minor allele frequency $q_{1} = 0.2$ in $S_{1}$ and $q_{2} = 0.5$ in $S_{2}$. The SNP has no causal effect on the disease, meaning that within each subpopulation the allele is independent of disease status.\n\nThe base population is an equal mixture of the two subpopulations, with mixture weights $w_{1} = 0.5$ and $w_{2} = 0.5$. Controls are sampled from the non-diseased individuals proportionally to their occurrence in the base population (that is, proportional to $w_{i}(1 - \\pi_{i})$ for subpopulation $S_{i}$). Cases, however, are oversampled from the higher-prevalence subpopulation $S_{2}$ by design: among cases, a fraction $\\alpha_{2} = 0.8$ are drawn from $S_{2}$ and a fraction $\\alpha_{1} = 0.2$ are drawn from $S_{1}$.\n\nDefine the naive allelic odds ratio as the ratio of the allele odds among cases to the allele odds among controls, computed by ignoring subpopulation labels and pooling all cases together and all controls together. Assume the large-sample limit so that expected frequencies equal observed proportions and that Hardy–Weinberg equilibrium holds within each subpopulation.\n\nUsing only these premises and definitions, compute the naive allelic odds ratio for the minor allele. Provide your final answer as an exact value. No rounding is required.", "solution": "The problem requires the calculation of the naive allelic odds ratio in a case-control study with population stratification. The analysis will proceed by first determining the minor allele frequency in the pooled case group and the pooled control group, and then using these frequencies to compute the odds ratio.\n\nLet $A$ denote the minor allele and $a$ denote the major allele. The minor allele frequency in subpopulation $S_i$ is $q_i$. The given values are $q_1 = 0.2$ and $q_2 = 0.5$. The disease prevalence in subpopulation $S_i$ is $\\pi_i$, with given values $\\pi_1 = 0.1$ and $\\pi_2 = 0.2$. The base population is an equal mixture of the two subpopulations, with weights $w_1 = w_2 = 0.5$.\n\nThe naive allelic odds ratio, $OR_{naive}$, is defined as the ratio of the odds of the minor allele in the pooled case group to the odds of the minor allele in the pooled control group. Let $q_{case}$ be the frequency of allele $A$ among all cases, and $q_{control}$ be the frequency of allele $A$ among all controls. The odds ratio is given by:\n$$\nOR_{naive} = \\frac{q_{case} / (1 - q_{case})}{q_{control} / (1 - q_{control})}\n$$\nThe core of the problem is to compute $q_{case}$ and $q_{control}$.\n\nFirst, we calculate the minor allele frequency in the pooled case group, $q_{case}$. The problem states that the final case group is composed of a fraction $\\alpha_1 = 0.2$ of individuals from subpopulation $S_1$ and a fraction $\\alpha_2 = 0.8$ from subpopulation $S_2$. Thus, $P(S_1|\\text{Case}) = \\alpha_1$ and $P(S_2|\\text{Case}) = \\alpha_2$.\nThe problem states that the SNP has no causal effect, which implies that within each subpopulation, the allele frequency is independent of disease status. Therefore, the allele frequency among cases from subpopulation $S_i$ is simply the allele frequency in that subpopulation, $q_i$.\nUsing the law of total probability, the overall minor allele frequency in the case group is:\n$$\nq_{case} = P(A|\\text{Case}) = P(A|\\text{Case}, S_1)P(S_1|\\text{Case}) + P(A|\\text{Case}, S_2)P(S_2|\\text{Case})\n$$\n$$\nq_{case} = q_1 \\alpha_1 + q_2 \\alpha_2\n$$\nSubstituting the given values:\n$$\nq_{case} = (0.2)(0.2) + (0.5)(0.8) = 0.04 + 0.40 = 0.44\n$$\nAs a fraction, $q_{case} = \\frac{44}{100} = \\frac{11}{25}$.\n\nNext, we calculate the minor allele frequency in the pooled control group, $q_{control}$. First, we must determine the composition of the control group. Controls are sampled from the non-diseased individuals proportionally to their occurrence in the base population. The proportion of non-diseased individuals in subpopulation $S_i$ within the total population is proportional to $w_i(1 - \\pi_i)$.\nThe proportion of controls from subpopulation $S_1$, denoted $\\beta_1$, is:\n$$\n\\beta_1 = P(S_1|\\text{Control}) = \\frac{w_1(1 - \\pi_1)}{w_1(1 - \\pi_1) + w_2(1 - \\pi_2)}\n$$\nThe proportion of controls from subpopulation $S_2$, denoted $\\beta_2$, is:\n$$\n\\beta_2 = P(S_2|\\text{Control}) = \\frac{w_2(1 - \\pi_2)}{w_1(1 - \\pi_1) + w_2(1 - \\pi_2)}\n$$\nSubstituting the given values $w_1=0.5$, $w_2=0.5$, $\\pi_1=0.1$, and $\\pi_2=0.2$:\n$$\n\\beta_1 = \\frac{0.5(1 - 0.1)}{0.5(1 - 0.1) + 0.5(1 - 0.2)} = \\frac{0.5(0.9)}{0.5(0.9) + 0.5(0.8)} = \\frac{0.45}{0.45 + 0.40} = \\frac{0.45}{0.85} = \\frac{45}{85} = \\frac{9}{17}\n$$\nAnd for $\\beta_2$:\n$$\n\\beta_2 = \\frac{0.5(0.8)}{0.85} = \\frac{0.40}{0.85} = \\frac{40}{85} = \\frac{8}{17}\n$$\nAs a check, $\\beta_1 + \\beta_2 = \\frac{9}{17} + \\frac{8}{17} = 1$.\n\nNow, we can find $q_{control}$ using the law of total probability, analogous to the calculation for $q_{case}$:\n$$\nq_{control} = P(A|\\text{Control}) = P(A|\\text{Control}, S_1)P(S_1|\\text{Control}) + P(A|\\text{Control}, S_2)P(S_2|\\text{Control})\n$$\n$$\nq_{control} = q_1 \\beta_1 + q_2 \\beta_2\n$$\nSubstituting the values for $q_i$ and $\\beta_i$:\n$$\nq_{control} = (0.2)\\left(\\frac{9}{17}\\right) + (0.5)\\left(\\frac{8}{17}\\right) = \\left(\\frac{1}{5}\\right)\\left(\\frac{9}{17}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{8}{17}\\right)\n$$\n$$\nq_{control} = \\frac{9}{85} + \\frac{4}{17} = \\frac{9}{85} + \\frac{4 \\times 5}{17 \\times 5} = \\frac{9}{85} + \\frac{20}{85} = \\frac{29}{85}\n$$\n\nFinally, we compute the naive allelic odds ratio.\nThe odds of the minor allele in cases is:\n$$\n\\text{Odds}_{case} = \\frac{q_{case}}{1 - q_{case}} = \\frac{11/25}{1 - 11/25} = \\frac{11/25}{14/25} = \\frac{11}{14}\n$$\nThe odds of the minor allele in controls is:\n$$\n\\text{Odds}_{control} = \\frac{q_{control}}{1 - q_{control}} = \\frac{29/85}{1 - 29/85} = \\frac{29/85}{56/85} = \\frac{29}{56}\n$$\nThe naive allelic odds ratio is the ratio of these odds:\n$$\nOR_{naive} = \\frac{\\text{Odds}_{case}}{\\text{Odds}_{control}} = \\frac{11/14}{29/56} = \\frac{11}{14} \\times \\frac{56}{29}\n$$\nSince $56 = 4 \\times 14$, the expression simplifies:\n$$\nOR_{naive} = \\frac{11}{\\cancel{14}} \\times \\frac{4 \\times \\cancel{14}}{29} = \\frac{11 \\times 4}{29} = \\frac{44}{29}\n$$\nThis result, greater than $1$, illustrates how population stratification can induce a spurious association where none exists within the subpopulations.", "answer": "$$\\boxed{\\frac{44}{29}}$$", "id": "4568675"}, {"introduction": "Identifying a statistically significant region in a GWAS is only the first step; the next challenge is to pinpoint the specific causal variant(s) from a group of highly correlated SNPs in Linkage Disequilibrium (LD). This practice introduces the statistical technique of conditional analysis, which helps dissect these complex signals [@problem_id:4568689]. By learning to calculate a conditional $Z$-score, you will understand how researchers can statistically adjust for the effects of nearby SNPs to refine association signals and move closer to identifying causal variants.", "problem": "In a genome-wide association study (GWAS), consider two single-nucleotide polymorphisms (SNPs) with additive genotype coding and summary test statistics reported as marginal standardized score statistics (marginal $Z$-scores). Under large-sample theory for generalized linear models with appropriately scaled genotypes and binary or quantitative phenotypes, the joint distribution of marginal $Z$-scores across correlated SNPs is well approximated by a multivariate normal distribution with mean zero under the null and covariance given by the linkage disequilibrium (LD) correlation matrix. Specifically, for two SNPs, let the vector of marginal $Z$-scores be $Z=(Z_1,Z_2)^{\\top}$ and the LD correlation be $r$, so that the covariance matrix is $\\Sigma=\\begin{pmatrix}1  r \\\\ r  1\\end{pmatrix}$. Using these foundations, derive the standardized conditional $Z$-statistic for the first SNP given the second as the properly normalized residual from projecting $Z_1$ onto $Z_2$. Then evaluate this conditional $Z$-statistic for the observed values $Z_1=8$, $Z_2=6$, and LD correlation $r=0.6$. Express the final answer as a single real number. No rounding is required. Define all acronyms upon first use, including Genome-Wide Association Study (GWAS), single-nucleotide polymorphism (SNP), and Linkage Disequilibrium (LD).", "solution": "The problem asks for the derivation and evaluation of a standardized conditional test statistic in the context of a Genome-Wide Association Study (GWAS). A GWAS is a method used in genetics to associate specific genetic variations, known as single-nucleotide polymorphisms (SNPs), with particular traits or diseases. The statistical correlation between alleles at different loci is termed Linkage Disequilibrium (LD).\n\nThe problem states that the joint distribution of the marginal standardized score statistics (marginal $Z$-scores) for two SNPs, denoted by the vector $Z = (Z_1, Z_2)^{\\top}$, is approximated by a bivariate normal distribution. Under the null hypothesis of no association for either SNP, the mean vector is zero. The covariance matrix is given by the LD correlation matrix. Therefore, the statistical model is:\n$$\n\\begin{pmatrix} Z_1 \\\\ Z_2 \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix} \\right)\n$$\nHere, $E[Z_1] = E[Z_2] = 0$, $\\text{Var}(Z_1) = \\text{Var}(Z_2) = 1$, and the correlation $\\text{Corr}(Z_1, Z_2) = r$, which is also the covariance since the variances are unity.\n\nThe task is to derive the standardized conditional $Z$-statistic for the first SNP given the second, $Z_{1|2}$. This statistic is described as the \"properly normalized residual from projecting $Z_1$ onto $Z_2$\". This implies a linear regression framework where we model $Z_1$ as a function of $Z_2$.\n\nThe linear projection of the random variable $Z_1$ onto $Z_2$ is its conditional expectation, $E[Z_1 | Z_2]$. For a bivariate normal distribution, the conditional expectation is a linear function of the conditioning variable. The general formula for the conditional distribution of $Z_1$ given $Z_2 = z_2$ is normal with mean $\\mu_{1|2}$ and variance $\\sigma_{1|2}^2$:\n$$\n\\mu_{1|2} = E[Z_1 | Z_2 = z_2] = E[Z_1] + \\frac{\\text{Cov}(Z_1, Z_2)}{\\text{Var}(Z_2)} (z_2 - E[Z_2])\n$$\n$$\n\\sigma_{1|2}^2 = \\text{Var}(Z_1 | Z_2 = z_2) = \\text{Var}(Z_1) \\left( 1 - \\text{Corr}(Z_1, Z_2)^2 \\right)\n$$\nSubstituting the specific parameters from our problem: $E[Z_1]=0$, $E[Z_2]=0$, $\\text{Var}(Z_2)=1$, $\\text{Cov}(Z_1, Z_2)=r$, and $\\text{Corr}(Z_1, Z_2)=r$.\n$$\nE[Z_1 | Z_2 = z_2] = 0 + \\frac{r}{1}(z_2 - 0) = r z_2\n$$\nThus, the linear projection of $Z_1$ onto $Z_2$ is $rZ_2$.\n\nThe residual, $R$, is the difference between the observed value $Z_1$ and its predicted value based on the projection, which is its conditional expectation:\n$$\nR = Z_1 - E[Z_1 | Z_2] = Z_1 - rZ_2\n$$\nThe problem requires this residual to be \"properly normalized\" to create a standardized conditional $Z$-statistic. A standardized statistic, by definition, has a mean of $0$ and a variance of $1$ under the null hypothesis. Let us find the unconditional mean and variance of the residual $R$.\nThe mean of the residual is:\n$$\nE[R] = E[Z_1 - rZ_2] = E[Z_1] - rE[Z_2] = 0 - r(0) = 0\n$$\nThe variance of the residual is:\n$$\n\\text{Var}(R) = \\text{Var}(Z_1 - rZ_2) = \\text{Var}(Z_1) + \\text{Var}(-rZ_2) + 2\\text{Cov}(Z_1, -rZ_2)\n$$\n$$\n\\text{Var}(R) = \\text{Var}(Z_1) + r^2\\text{Var}(Z_2) - 2r\\text{Cov}(Z_1, Z_2)\n$$\nSubstituting the known variances and covariance:\n$$\n\\text{Var}(R) = 1 + r^2(1) - 2r(r) = 1 + r^2 - 2r^2 = 1 - r^2\n$$\nThe residual $R = Z_1 - rZ_2$ is a linear combination of two jointly normal random variables, and is therefore itself normally distributed with mean $0$ and variance $1 - r^2$.\n\nTo obtain a standardized statistic (a $Z$-statistic) with unit variance, we must divide the residual by its standard deviation, which is $\\sqrt{\\text{Var}(R)} = \\sqrt{1 - r^2}$. The standardized conditional $Z$-statistic for SNP $1$ given SNP $2$, which we denote as $Z_{1|2}$, is therefore:\n$$\nZ_{1|2} = \\frac{R}{\\sqrt{\\text{Var}(R)}} = \\frac{Z_1 - rZ_2}{\\sqrt{1 - r^2}}\n$$\nThis derived expression represents the association signal of SNP $1$ after accounting for its LD with SNP $2$.\n\nNow, we evaluate this statistic using the provided observed values: $Z_1 = 8$, $Z_2 = 6$, and $r = 0.6$.\nSubstituting these values into the derived formula:\n$$\nZ_{1|2} = \\frac{8 - (0.6)(6)}{\\sqrt{1 - (0.6)^2}}\n$$\nFirst, we calculate the numerator:\n$$\n8 - (0.6)(6) = 8 - 3.6 = 4.4\n$$\nNext, we calculate the term inside the square root in the denominator:\n$$\n1 - (0.6)^2 = 1 - 0.36 = 0.64\n$$\nThe denominator is then:\n$$\n\\sqrt{0.64} = 0.8\n$$\nFinally, we compute the value of the conditional $Z$-statistic:\n$$\nZ_{1|2} = \\frac{4.4}{0.8} = \\frac{44}{8} = \\frac{11}{2} = 5.5\n$$\nThe resulting conditional $Z$-statistic is $5.5$.", "answer": "$$\\boxed{5.5}$$", "id": "4568689"}]}