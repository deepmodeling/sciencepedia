{"hands_on_practices": [{"introduction": "Mastering survival analysis begins with understanding its two fundamental nonparametric estimators: the Kaplan-Meier (KM) estimator for the survival function and the Nelson-Aalen (NA) estimator for the cumulative hazard. This exercise provides direct, hands-on practice in calculating both estimators from a raw dataset, including the complexities of tied event times and censoring. By computing both and comparing the results [@problem_id:4612121], you will gain a deeper appreciation for the intimate mathematical relationship between the survival and hazard functions.", "problem": "A clinical registry tracks time from diagnosis to a molecular relapse for a targeted therapy cohort in months, with right-censoring when patients are lost to follow-up or switch therapies. Assume independent, non-informative right-censoring and that at any time with ties, all events occur before censorings at the same recorded time. Let $T$ denote time-to-relapse, the survival function be $S(t)=\\Pr(Tt)$, the hazard be $h(t)$, and the cumulative hazard be $H(t)=\\int_{0}^{t} h(s)\\,ds$, so that $S(t)=\\exp(-H(t))$. Starting from these definitions and using standard nonparametric constructions justified by counting-process or likelihood arguments under right-censoring, you will estimate the cumulative hazard and survival.\n\nYou are given $n=10$ independent individuals with observed times (in months) and event indicators $\\delta$ ($\\delta=1$ for relapse, $\\delta=0$ for right-censoring):\n- Subject $1$: time $2.1$, $\\delta=1$.\n- Subject $2$: time $4.0$, $\\delta=1$.\n- Subject $3$: time $4.0$, $\\delta=1$.\n- Subject $4$: time $4.0$, $\\delta=0$.\n- Subject $5$: time $5.7$, $\\delta=1$.\n- Subject $6$: time $6.3$, $\\delta=0$.\n- Subject $7$: time $6.3$, $\\delta=1$.\n- Subject $8$: time $9.5$, $\\delta=1$.\n- Subject $9$: time $12.0$, $\\delta=0$.\n- Subject $10$: time $12.0$, $\\delta=1$.\n\nTasks:\n1. Using the above assumptions and foundational definitions, construct the nonparametric cumulative hazard estimator $\\hat H(t)$ and, via the survival–hazard relationship, the transformed survival estimator $\\tilde S(t)=\\exp(-\\hat H(t))$. Explicitly compute $\\hat H(t)$ and $\\tilde S(t)$ on the interval $[0,t_{\\star}]$ with $t_{\\star}=10$ months.\n2. Construct the Kaplan–Meier (KM) product-limit survival estimator $\\hat S_{\\mathrm{KM}}(t)$ and compute $\\hat S_{\\mathrm{KM}}(t_{\\star})$.\n3. Contrast, in words, the event-time jumps of $\\hat H(t)$ and the step sizes of $\\tilde S(t)$ with the Kaplan–Meier steps at the same event times, discussing how tied events and the presence of censoring at event times are handled in the risk sets and how this affects the multiplicative drops.\n\nAnswer specification: Report a single final quantity, the exact ratio $r=\\tilde S(t_{\\star})/\\hat S_{\\mathrm{KM}}(t_{\\star})$, in a closed-form analytic expression. Do not approximate and do not include units in your final reported ratio. No rounding is required. All intermediate computations and reasoning must be shown in your solution.", "solution": "The problem is subjected to validation against the established criteria.\n\n### Step 1: Extract Givens\n- A cohort of $n=10$ individuals is tracked for time-to-relapse, $T$.\n- Data is subject to independent, non-informative right-censoring.\n- Tie-breaking rule: at any given time, events are processed before censorings.\n- Survival function: $S(t) = \\Pr(T  t)$.\n- Hazard function: $h(t)$.\n- Cumulative hazard function: $H(t) = \\int_{0}^{t} h(s)\\,ds$.\n- Relationship: $S(t) = \\exp(-H(t))$.\n- Data for $n=10$ subjects (time in months, $\\delta=1$ for relapse, $\\delta=0$ for censoring):\n  - Subject $1$: $(2.1, 1)$\n  - Subject $2$: $(4.0, 1)$\n  - Subject $3$: $(4.0, 1)$\n  - Subject $4$: $(4.0, 0)$\n  - Subject $5$: $(5.7, 1)$\n  - Subject $6$: $(6.3, 0)$\n  - Subject $7$: $(6.3, 1)$\n  - Subject $8$: $(9.5, 1)$\n  - Subject $9$: $(12.0, 0)$\n  - Subject $10$: $(12.0, 1)$\n- Tasks:\n  1. Compute the nonparametric cumulative hazard estimator $\\hat{H}(t)$ and the transformed survival estimator $\\tilde{S}(t) = \\exp(-\\hat{H}(t))$ on the interval $[0, t_{\\star}]$ where $t_{\\star}=10$ months.\n  2. Compute the Kaplan-Meier (KM) product-limit survival estimator $\\hat{S}_{\\mathrm{KM}}(t)$ at $t_{\\star}=10$.\n  3. Conceptually contrast the estimators.\n- Final answer specification: Report the exact ratio $r = \\tilde{S}(t_{\\star})/\\hat{S}_{\\mathrm{KM}}(t_{\\star})$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard application of survival analysis, a core topic in biostatistics and bioinformatics. It uses the foundational Nelson-Aalen and Kaplan-Meier estimators, and the relationship between survival and hazard functions is definitional. All concepts are firmly established in statistical theory.\n- **Well-Posed:** The problem provides a complete dataset, explicit definitions, and a clear tie-breaking rule. The tasks are specific and lead to a unique, computable solution.\n- **Objective:** The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n- Based on this assessment, the problem is not invalidated by any of the listed flaws (e.g., scientific unsoundness, incompleteness, ambiguity).\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\nThe first step is to order the distinct event times and for each, determine the number of events and the size of the risk set. Let $t_{(j)}$ be the $j$-th ordered distinct time at which an event occurs. Let $d_j$ be the number of events (relapses) at $t_{(j)}$, and $Y_j$ be the number of individuals at risk just prior to $t_{(j)}$. The risk set at time $t$, $R(t)$, consists of all individuals $i$ whose observed time $T_i \\ge t$. Thus, $Y_j = |R(t_{(j)})|$.\n\nThe ordered observed times are $2.1, 4.0, 4.0, 4.0, 5.7, 6.3, 6.3, 9.5, 12.0, 12.0$.\nThe distinct event times are $2.1, 4.0, 5.7, 6.3, 9.5, 12.0$.\n\nWe construct a table to organize the calculations:\n- At time $t=0$, the risk set size is $Y=10$.\n- At event time $t_{(1)} = 2.1$:\n  - The risk set $R(2.1)$ comprises all $10$ subjects, so $Y_1=10$.\n  - One event occurs (Subject $1$), so $d_1=1$.\n  - No subjects are censored.\n- At event time $t_{(2)} = 4.0$:\n  - Subject $1$ is no longer at risk. The risk set $R(4.0)$ has $10-1=9$ subjects. So, $Y_2=9$.\n  - Two events occur (Subjects $2, 3$), so $d_2=2$.\n  - One subject (Subject $4$) is censored. Per the problem, this individual is in the risk set at time $4.0$.\n- At event time $t_{(3)} = 5.7$:\n  - At time $4.0$, $2$ events and $1$ censoring occurred. The number of subjects remaining is $9 - 2 - 1 = 6$.\n  - The risk set $R(5.7)$ has these $6$ subjects. So, $Y_3=6$.\n  - One event occurs (Subject $5$), so $d_3=1$.\n- At event time $t_{(4)} = 6.3$:\n  - After the event at $5.7$, $6-1=5$ subjects remain.\n  - The risk set $R(6.3)$ has these $5$ subjects. So, $Y_4=5$.\n  - One event occurs (Subject $7$), so $d_4=1$.\n  - One subject (Subject $6$) is censored at this time.\n- At event time $t_{(5)} = 9.5$:\n  - At time $6.3$, $1$ event and $1$ censoring occurred. The number of subjects remaining is $5 - 1 - 1 = 3$.\n  - The risk set $R(9.5)$ has these $3$ subjects. So, $Y_5=3$.\n  - One event occurs (Subject $8$), so $d_5=1$.\n- The next event time is $t_{(6)} = 12.0$, which is greater than $t_{\\star}=10$.\n\n**Task 1: Compute $\\hat{H}(10)$ and $\\tilde{S}(10)$**\nThe Nelson-Aalen estimator of the cumulative hazard function is given by the sum of the hazard increments at each event time:\n$$ \\hat{H}(t) = \\sum_{j: t_{(j)} \\le t} \\frac{d_j}{Y_j} $$\nWe need to calculate this at $t_{\\star}=10$. The relevant event times are $t_{(j)} \\le 10$, which are $2.1, 4.0, 5.7, 6.3,$ and $9.5$.\n$$ \\hat{H}(10) = \\frac{d_1}{Y_1} + \\frac{d_2}{Y_2} + \\frac{d_3}{Y_3} + \\frac{d_4}{Y_4} + \\frac{d_5}{Y_5} $$\nSubstituting the values we found:\n$$ \\hat{H}(10) = \\frac{1}{10} + \\frac{2}{9} + \\frac{1}{6} + \\frac{1}{5} + \\frac{1}{3} $$\nTo sum these fractions, we find a common denominator, which is $90$.\n$$ \\hat{H}(10) = \\frac{9}{90} + \\frac{20}{90} + \\frac{15}{90} + \\frac{18}{90} + \\frac{30}{90} = \\frac{9+20+15+18+30}{90} = \\frac{92}{90} = \\frac{46}{45} $$\nThe transformed survival estimator $\\tilde{S}(t)$ is defined as $\\exp(-\\hat{H}(t))$. At $t_{\\star}=10$:\n$$ \\tilde{S}(10) = \\exp(-\\hat{H}(10)) = \\exp\\left(-\\frac{46}{45}\\right) $$\n\n**Task 2: Compute $\\hat{S}_{\\mathrm{KM}}(10)$**\nThe Kaplan-Meier product-limit estimator for the survival function is given by:\n$$ \\hat{S}_{\\mathrm{KM}}(t) = \\prod_{j: t_{(j)} \\le t} \\left(1 - \\frac{d_j}{Y_j}\\right) $$\nWe calculate this at $t_{\\star}=10$, using the same event times and values for $d_j$ and $Y_j$.\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\left(1 - \\frac{d_1}{Y_1}\\right) \\left(1 - \\frac{d_2}{Y_2}\\right) \\left(1 - \\frac{d_3}{Y_3}\\right) \\left(1 - \\frac{d_4}{Y_4}\\right) \\left(1 - \\frac{d_5}{Y_5}\\right) $$\nSubstituting the values:\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\left(1 - \\frac{1}{10}\\right) \\left(1 - \\frac{2}{9}\\right) \\left(1 - \\frac{1}{6}\\right) \\left(1 - \\frac{1}{5}\\right) \\left(1 - \\frac{1}{3}\\right) $$\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\left(\\frac{9}{10}\\right) \\left(\\frac{7}{9}\\right) \\left(\\frac{5}{6}\\right) \\left(\\frac{4}{5}\\right) \\left(\\frac{2}{3}\\right) $$\nWe can simplify this product by canceling terms:\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\frac{9 \\cdot 7 \\cdot 5 \\cdot 4 \\cdot 2}{10 \\cdot 9 \\cdot 6 \\cdot 5 \\cdot 3} = \\frac{\\cancel{9} \\cdot 7 \\cdot \\cancel{5} \\cdot 4 \\cdot 2}{10 \\cdot \\cancel{9} \\cdot 6 \\cdot \\cancel{5} \\cdot 3} = \\frac{7 \\cdot 4 \\cdot 2}{10 \\cdot 6 \\cdot 3} = \\frac{56}{180} $$\nSimplifying the fraction by dividing the numerator and denominator by their greatest common divisor, which is $4$:\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\frac{14}{45} $$\n\n**Task 3: Contrast the Estimators**\nThe Nelson-Aalen estimator $\\hat{H}(t)$ is built on an additive scale. It is a step function that increases only at event times. The jump size at an event time $t_{(j)}$ is $\\Delta \\hat{H}(t_{(j)}) = d_j/Y_j$, which represents the empirical hazard, or instantaneous rate of failure, at that moment. For tied events, as at $t=4.0$ where $d_2=2$, the jump is larger ($2/9$) as it aggregates the risk from all events occurring at that instant.\n\nThe transformed survival estimator $\\tilde{S}(t) = \\exp(-\\hat{H}(t))$ inherits its structure from $\\hat{H}(t)$. It is a continuously decreasing function between events. At an event time $t_{(j)}$, it drops multiplicatively by a factor of $\\exp(-\\Delta \\hat{H}(t_{(j)})) = \\exp(-d_j/Y_j)$. So, $\\tilde{S}(t_{(j)}) = \\tilde{S}(t_{(j)}^{-}) \\times \\exp(-d_j/Y_j)$.\n\nThe Kaplan-Meier estimator $\\hat{S}_{\\mathrm{KM}}(t)$ is also a step function that drops only at event times. Its construction is inherently multiplicative. At an event time $t_{(j)}$, the survival probability is multiplied by the conditional probability of surviving past $t_{(j)}$, given survival until just before $t_{(j)}$. This conditional probability is estimated as $(Y_j - d_j)/Y_j = 1 - d_j/Y_j$. Thus, the multiplicative drop is by a factor of $(1 - d_j/Y_j)$. For tied events, this factor accounts for all $d_j$ failures simultaneously.\n\nThe relationship between the two survival estimators stems from the approximation $\\exp(-x) \\approx 1-x$ for small $x$. The Kaplan-Meier drop factor, $1-d_j/Y_j$, is the first-order Taylor expansion of the drop factor for $\\tilde{S}(t)$, $\\exp(-d_j/Y_j)$. Consequently, $\\hat{S}_{\\mathrm{KM}}(t)$ can be seen as an approximation to $\\tilde{S}(t)$, and they converge to the same true survival function $S(t)$ as the sample size increases. For any finite sample, $\\hat{S}_{\\mathrm{KM}}(t) \\le \\tilde{S}(t)$ because $1-x \\le \\exp(-x)$ for all $x \\ge 0$. In handling tied events and censoring, both methods use the same risk sets $Y_j$ and event counts $d_j$, ensuring consistency in their underlying data structures. The tie-handling rule (events before censoring) is critical for correctly calculating $Y_j$.\n\n**Final Calculation: The Ratio $r$**\nThe final task is to compute the ratio $r = \\tilde{S}(t_{\\star}) / \\hat{S}_{\\mathrm{KM}}(t_{\\star})$ at $t_{\\star}=10$.\n$$ r = \\frac{\\tilde{S}(10)}{\\hat{S}_{\\mathrm{KM}}(10)} = \\frac{\\exp\\left(-\\frac{46}{45}\\right)}{\\frac{14}{45}} $$\n$$ r = \\frac{45}{14} \\exp\\left(-\\frac{46}{45}\\right) $$\nThis is the final exact, closed-form expression for the ratio.", "answer": "$$\\boxed{\\frac{45}{14}\\exp\\left(-\\frac{46}{45}\\right)}$$", "id": "4612121"}, {"introduction": "Real-world cohort studies rarely have a clean, uniform start time for all subjects; often, individuals enter the study at different times, a phenomenon known as left-truncation or late entry. The validity of the Kaplan-Meier estimator hinges on correctly defining the risk set at each point in time, and left-truncation directly impacts this construction. This practice challenges you to compute survival probabilities under left-truncation and contrast the result with a naive analysis, demonstrating the critical importance of accounting for each subject's time at risk to avoid biased conclusions [@problem_id:4612158].", "problem": "A cohort study in bioinformatics tracks time from a molecular diagnosis to death for patients with a genomically defined cancer subtype. Patients become eligible and hence enter observation only after a biomarker panel is completed, which induces left truncation: a patient with late biomarker completion enters the risk set only after that time. For each patient, you are given an entry time $L_i$ (the time the patient first becomes observable), an exit time $T_i$ (the time of event or right-censoring), and an event indicator $\\delta_i$ where $\\delta_i = 1$ denotes a death and $\\delta_i = 0$ denotes right-censoring. All times are measured in months from molecular diagnosis.\n\nThe dataset for $6$ patients is:\n- Subject $1$: $L_1 = 6$, $T_1 = 20$, $\\delta_1 = 1$.\n- Subject $2$: $L_2 = 21$, $T_2 = 28$, $\\delta_2 = 0$.\n- Subject $3$: $L_3 = 10$, $T_3 = 30$, $\\delta_3 = 1$.\n- Subject $4$: $L_4 = 15$, $T_4 = 25$, $\\delta_4 = 0$.\n- Subject $5$: $L_5 = 19$, $T_5 = 22$, $\\delta_5 = 1$.\n- Subject $6$: $L_6 = 2$, $T_6 = 27$, $\\delta_6 = 1$.\n\nStarting from core definitions of the survival function and hazard function, derive the Kaplan–Meier (KM) estimator with left truncation by constructing appropriate risk sets and conditional failure probabilities. Then compute the survival probability at $t = 24$ months:\n- First, using left truncation (i.e., late entry) correctly.\n- Second, naively ignoring left truncation (i.e., treating all subjects as at risk from $t = 0$).\n\nFinally, report the numerical difference between these two survival probabilities at $t = 24$ months, defined as $S_{\\text{LT}}(24) - S_{\\text{naive}}(24)$, where $S_{\\text{LT}}$ is the KM survival with left truncation and $S_{\\text{naive}}$ is the KM survival ignoring left truncation. Express your final answer as an exact fraction. In your derivation, explicitly explain why the two estimates differ in terms of the construction of the risk sets and the implied hazard over the event times.", "solution": "The problem requires the calculation and comparison of two Kaplan-Meier (KM) survival estimates at time $t=24$ months: one correctly accounting for left-truncation (late entry) and another naively ignoring it. We begin by defining the core concepts.\n\nThe survival function, $S(t)$, is the probability that an individual survives beyond time $t$, i.e., $S(t) = P(T  t)$, where $T$ is the time-to-event random variable. The Kaplan-Meier estimator is a non-parametric method to estimate $S(t)$ from censored data. It is a product-limit estimator given by:\n$$\n\\hat{S}_{\\text{KM}}(t) = \\prod_{j: t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right)\n$$\nwhere $t_1  t_2  \\dots  t_k$ are the distinct times at which events (deaths) occur, $d_j$ is the number of events at time $t_j$, and $n_j$ is the number of individuals in the risk set just before time $t_j$.\n\nThe critical distinction between the two required calculations lies in the definition of the risk set. For a subject $i$, we are given an entry time $L_i$, an exit time $T_i$, and an event indicator $\\delta_i$. An event occurred if $\\delta_i=1$, and the subject was right-censored if $\\delta_i=0$.\n\nThe provided data is:\n- Subject $1$: $L_1 = 6$, $T_1 = 20$, $\\delta_1 = 1$ (Event).\n- Subject $2$: $L_2 = 21$, $T_2 = 28$, $\\delta_2 = 0$ (Censored).\n- Subject $3$: $L_3 = 10$, $T_3 = 30$, $\\delta_3 = 1$ (Event).\n- Subject $4$: $L_4 = 15$, $T_4 = 25$, $\\delta_4 = 0$ (Censored).\n- Subject $5$: $L_5 = 19$, $T_5 = 22$, $\\delta_5 = 1$ (Event).\n- Subject $6$: $L_6 = 2$, $T_6 = 27$, $\\delta_6 = 1$ (Event).\n\nThe distinct event times are $t=20$ (Subject $1$), $t=22$ (Subject $5$), $t=27$ (Subject $6$), and $t=30$ (Subject $3$). We order these as $t_1 = 20$, $t_2 = 22$, $t_3 = 27$, and $t_4 = 30$.\n\n**1. KM Estimator with Left Truncation, $S_{\\text{LT}}(t)$**\n\nIn the presence of left truncation, the risk set at time $t$, denoted $R(t)$, includes only those individuals who have entered the study ($L_i \\le t$) and have not yet experienced an event or been censored ($T_i \\ge t$). Therefore, the number of individuals at risk at event time $t_j$ is $n_j = |\\{i: L_i \\le t_j \\text{ and } T_i \\ge t_j\\}|$.\n\n- **At event time $t_1 = 20$**:\n  - Number of events $d_1 = 1$ (Subject $1$).\n  - The risk set consists of subjects with $L_i \\le 20$ and $T_i \\ge 20$.\n    - Subject $1$: $L_1=6 \\le 20$, $T_1=20 \\ge 20$. Yes.\n    - Subject $2$: $L_2=21 \\not\\le 20$. No. Not yet in the study.\n    - Subject $3$: $L_3=10 \\le 20$, $T_3=30 \\ge 20$. Yes.\n    - Subject $4$: $L_4=15 \\le 20$, $T_4=25 \\ge 20$. Yes.\n    - Subject $5$: $L_5=19 \\le 20$, $T_5=22 \\ge 20$. Yes.\n    - Subject $6$: $L_6=2 \\le 20$, $T_6=27 \\ge 20$. Yes.\n  - The number at risk is $n_1 = 5$.\n  - The survival probability past $t=20$ is $S_{\\text{LT}}(20) = 1 - \\frac{d_1}{n_1} = 1 - \\frac{1}{5} = \\frac{4}{5}$.\n\n- **At event time $t_2 = 22$**:\n  - Number of events $d_2 = 1$ (Subject $5$).\n  - The risk set consists of subjects with $L_i \\le 22$ and $T_i \\ge 22$.\n    - Subject $1$: Exited at $t=20$. No.\n    - Subject $2$: $L_2=21 \\le 22$, $T_2=28 \\ge 22$. Yes.\n    - Subject $3$: $L_3=10 \\le 22$, $T_3=30 \\ge 22$. Yes.\n    - Subject $4$: $L_4=15 \\le 22$, $T_4=25 \\ge 22$. Yes.\n    - Subject $5$: $L_5=19 \\le 22$, $T_5=22 \\ge 22$. Yes.\n    - Subject $6$: $L_6=2 \\le 22$, $T_6=27 \\ge 22$. Yes.\n  - The number at risk is $n_2 = 5$.\n  - The cumulative survival probability is $S_{\\text{LT}}(22) = S_{\\text{LT}}(20) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{4}{5} \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{4}{5} \\times \\frac{4}{5} = \\frac{16}{25}$.\n\nThe survival function is a step function that is constant between event times. The next event occurs at $t_3 = 27$. Therefore, for any time $t$ such that $22 \\le t  27$, the survival probability is $S_{\\text{LT}}(t) = S_{\\text{LT}}(22)$.\nWe need to find $S_{\\text{LT}}(24)$. Since $22 \\le 24  27$, we have:\n$$S_{\\text{LT}}(24) = S_{\\text{LT}}(22) = \\frac{16}{25}$$\n\n**2. Naive KM Estimator Ignoring Left Truncation, $S_{\\text{naive}}(t)$**\n\nWhen left truncation is ignored, we incorrectly assume all subjects are at risk from time $t=0$ (i.e., $L_i=0$ for all $i$). The risk set at time $t_j$ is simply the total number of subjects who have not yet had an event or been censored before $t_j$.\n\n- **At event time $t_1 = 20$**:\n  - Number of events $d_1 = 1$.\n  - All $6$ subjects are assumed to be at risk since none have been censored or had an event before $t=20$.\n  - The number at risk is $n_1 = 6$.\n  - The survival probability is $S_{\\text{naive}}(20) = 1 - \\frac{1}{6} = \\frac{5}{6}$.\n\n- **At event time $t_2 = 22$**:\n  - Number of events $d_2 = 1$.\n  - At time $t=20$, Subject $1$ had an event. The remaining $5$ subjects are at risk. No other censoring occurred between $t=20$ and $t=22$.\n  - The number at risk is $n_2 = 6 - 1 = 5$.\n  - The cumulative survival probability is $S_{\\text{naive}}(22) = S_{\\text{naive}}(20) \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{5}{6} \\times \\frac{4}{5} = \\frac{20}{30} = \\frac{2}{3}$.\n\nAgain, the survival function is constant between events. The next change to the risk set is Subject $4$ being censored at $t=25$, and the next event is at $t=27$. Therefore, for any time $t$ such that $22 \\le t  25$, the survival probability is $S_{\\text{naive}}(t) = S_{\\text{naive}}(22)$.\nWe need to find $S_{\\text{naive}}(24)$. Since $22 \\le 24  25$, we have:\n$$S_{\\text{naive}}(24) = S_{\\text{naive}}(22) = \\frac{2}{3}$$\n\n**3. Explanation and Difference**\n\nThe difference between the two estimates at $t=24$ months is:\n$$ S_{\\text{LT}}(24) - S_{\\text{naive}}(24) = \\frac{16}{25} - \\frac{2}{3} = \\frac{16 \\times 3}{75} - \\frac{2 \\times 25}{75} = \\frac{48 - 50}{75} = -\\frac{2}{75} $$\n\nThe discrepancy arises from the incorrect construction of the risk set in the naive approach. By ignoring left truncation (late entry), the naive method includes subjects in the risk set before they are actually under observation. For instance, at the first event time $t_1 = 20$, the naive risk set size is $n_1 = 6$. However, Subject $2$ only enters the study at $L_2=21$ and is thus not observable at $t=20$. The correct left-truncated estimator properly excludes this subject, yielding a smaller, correct risk set size of $n_1=5$.\n\nThe hazard at an event time $t_j$ is estimated by the conditional failure probability, $\\frac{d_j}{n_j}$.\n- At $t=20$, the naive approach estimates the hazard as $\\frac{1}{6}$, while the correct LT approach estimates it as $\\frac{1}{5}$.\nBy inflating the denominator ($n_j$), the naive method artificially dilutes the risk pool and systematically *underestimates* the true hazard at early time points. A lower estimated hazard translates to a higher (more optimistic) estimated survival probability. We see this in the first step: $S_{\\text{naive}}(20) = \\frac{5}{6} \\approx 0.833$ is greater than $S_{\\text{LT}}(20) = \\frac{4}{5} = 0.8$. This initial bias propagates through the product-limit calculation, leading to an incorrect final survival estimate. The left-truncated KM estimator correctly conditions on the information that a subject must have survived and entered the study to be at risk, providing an unbiased estimate of the survival function for the population.", "answer": "$$\n\\boxed{-\\frac{2}{75}}\n$$", "id": "4612158"}, {"introduction": "While estimating survival functions is a crucial first step, the ultimate goal of many studies is to understand how covariates, such as treatment exposure or biomarker status, influence outcomes. The Cox proportional hazards model provides a powerful framework for this, and its flexibility is greatly enhanced by its ability to incorporate time-dependent covariates. This hands-on practice demystifies the process by guiding you through the construction of risk sets and the evaluation of the partial likelihood for a subject whose covariate value changes over time, a foundational skill for sophisticated survival modeling [@problem_id:4612116].", "problem": "Consider a cohort in a translational oncology study where the time-to-progression is modeled using the Cox proportional hazards (PH) framework. Let the instantaneous hazard given a potentially time-dependent covariate be $h(t \\mid x(t)) = h_{0}(t)\\,\\exp(\\beta\\,x(t))$, where $h_{0}(t)$ is an unspecified baseline hazard, $\\beta$ is a regression coefficient, and $x(t)$ is a binary covariate indicating a treatment exposure that may change over time. All subjects enter observation at time $t=0$ and there is no left-truncation. Distinct event times are assumed and there are no ties.\n\nThere are $5$ subjects indexed by $i \\in \\{1,2,3,4,5\\}$. The observed failure (event) times and right-censoring times are:\n- Subject $1$: event at time $3$.\n- Subject $2$: right-censoring at time $10$.\n- Subject $3$: event at time $5$.\n- Subject $4$: event at time $6$.\n- Subject $5$: event at time $9$.\n\nThe binary covariate $x_{i}(t)$ is constant for subjects $1,3,4,5$ and piecewise constant for subject $2$:\n- $x_{1}(t) \\equiv 1$ for all $t \\ge 0$.\n- $x_{3}(t) \\equiv 0$ for all $t \\ge 0$.\n- $x_{4}(t) \\equiv 1$ for all $t \\ge 0$.\n- $x_{5}(t) \\equiv 0$ for all $t \\ge 0$.\n- $x_{2}(t)$ is $0$ for $t \\in [0,4)$, then $1$ for $t \\in [4,8)$, then $0$ for $t \\in [8,10)$.\n\nTasks:\n1. Split the record of subject $2$ into start–stop intervals over which $x_{2}(t)$ is constant.\n2. Using the principle that the risk set at time $t$ contains every subject under observation immediately before $t$, construct the risk sets $R(t)$ at each distinct event time.\n3. Starting from the hazard-based definition of likelihood contributions in survival analysis and using the Cox PH structure, derive the partial likelihood for the regression coefficient $\\beta$ for these data under the assumptions stated above.\n4. Evaluate the partial likelihood at $\\beta = \\ln(2)$ and express the final value as an exact fraction. No rounding is required. The final answer must be a single real-valued number represented as a single exact fraction with no units.", "solution": "The problem statement is validated as follows.\n\n### Step 1: Extract Givens\n- **Model**: Cox proportional hazards (PH) model for time-to-progression.\n- **Hazard function**: $h(t \\mid x(t)) = h_{0}(t)\\,\\exp(\\beta\\,x(t))$, where $h_{0}(t)$ is the baseline hazard, $\\beta$ is a regression coefficient, and $x(t)$ is a time-dependent binary covariate.\n- **Study entry**: All subjects enter at time $t=0$; no left-truncation.\n- **Events**: Distinct event times are assumed; no ties.\n- **Subjects**: $N=5$ subjects, indexed by $i \\in \\{1,2,3,4,5\\}$.\n- **Observed data**:\n  - Subject $1$: event at time $3$. $x_{1}(t) \\equiv 1$.\n  - Subject $2$: right-censoring at time $10$. $x_{2}(t)$ is piecewise constant: $0$ for $t \\in [0,4)$, $1$ for $t \\in [4,8)$, and $0$ for $t \\in [8,10)$.\n  - Subject $3$: event at time $5$. $x_{3}(t) \\equiv 0$.\n  - Subject $4$: event at time $6$. $x_{4}(t) \\equiv 1$.\n  - Subject $5$: event at time $9$. $x_{5}(t) \\equiv 0$.\n- **Tasks**:\n  1. Split the record for subject $2$.\n  2. Construct risk sets $R(t)$ at each event time.\n  3. Derive the partial likelihood $L(\\beta)$.\n  4. Evaluate $L(\\beta)$ at $\\beta = \\ln(2)$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Cox proportional hazards model, a cornerstone of survival analysis in biostatistics and medical research. The use of time-dependent covariates is a standard extension of this model. The scenario is a typical representation of a clinical or translational study. The problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary information: event/censoring times, covariate values (including their time-dependency), and a specific value of $\\beta$ for evaluation. The tasks are clearly defined and lead to a unique, computable result.\n- **Objective**: The problem statement is expressed in precise, objective mathematical and statistical terms without ambiguity or subjective elements.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is a standard, well-defined exercise in survival analysis. A full solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds by executing the four tasks outlined in the problem statement.\n\n**Task 1: Split the record of subject 2**\nSubject $2$ has a time-dependent covariate $x_{2}(t)$ that changes at times $t=4$ and $t=8$. To handle this in the Cox model, the observation period for subject $2$, which is from $t=0$ to $t=10$, is split into intervals where the covariate is constant. This is often represented in a \"start-stop\" data format.\n- Interval 1: For $t \\in [0,4)$, subject $2$ is at risk with covariate $x_{2}(t)=0$. The interval is $(0, 4)$.\n- Interval 2: For $t \\in [4,8)$, subject $2$ is at risk with covariate $x_{2}(t)=1$. The interval is $(4, 8)$.\n- Interval 3: For $t \\in [8,10)$, subject $2$ is at risk with covariate $x_{2}(t)=0$. The interval is $(8, 10)$, and the subject is censored at the end of this interval, $t=10$.\n\n**Task 2: Construct the risk sets**\nThe risk set $R(t)$ at time $t$ consists of all subjects who are under observation and have not yet experienced an event or been censored just prior to time $t$. The distinct ordered event times are $t_{(1)}=3$, $t_{(2)}=5$, $t_{(3)}=6$, and $t_{(4)}=9$.\n\n- **Event at $t=3$**: The event occurs for subject $1$.\n  At time $t=3$, all $5$ subjects have been under observation since $t=0$ and none have had an event or been censored.\n  Therefore, the risk set is $R(3) = \\{1, 2, 3, 4, 5\\}$.\n\n- **Event at $t=5$**: The event occurs for subject $3$.\n  At time $t=5$, subject $1$ has already had an event at $t=3$ and is no longer at risk. Subjects $2, 3, 4, 5$ are still at risk.\n  Therefore, the risk set is $R(5) = \\{2, 3, 4, 5\\}$.\n\n- **Event at $t=6$**: The event occurs for subject $4$.\n  At time $t=6$, subjects $1$ and $3$ have had events. Subjects $2, 4, 5$ are still at risk.\n  Therefore, the risk set is $R(6) = \\{2, 4, 5\\}$.\n\n- **Event at $t=9$**: The event occurs for subject $5$.\n  At time $t=9$, subjects $1, 3, 4$ have had events. Subjects $2$ and $5$ are still at risk (subject $2$ is censored at $t=10$).\n  Therefore, the risk set is $R(9) = \\{2, 5\\}$.\n\n**Task 3: Derive the partial likelihood**\nThe partial likelihood $L(\\beta)$ is the product of the conditional probabilities of observing the actual event at each event time, given the risk set at that time. For a single event at time $t_{(j)}$ for subject $i_j$ from risk set $R(t_{(j)})$, the contribution to the likelihood is:\n$$ \\frac{h(t_{(j)} \\mid x_{i_j}(t_{(j)}))}{\\sum_{k \\in R(t_{(j)})} h(t_{(j)} \\mid x_k(t_{(j)}))} = \\frac{h_0(t_{(j)})\\exp(\\beta x_{i_j}(t_{(j)}))}{\\sum_{k \\in R(t_{(j)})} h_0(t_{(j)})\\exp(\\beta x_k(t_{(j)}))} = \\frac{\\exp(\\beta x_{i_j}(t_{(j)}))}{\\sum_{k \\in R(t_{(j)})} \\exp(\\beta x_k(t_{(j)}))} $$\nThe total partial likelihood is the product of these terms over all $4$ event times.\n\n- **Contribution at $t=3$**: Subject $1$ has the event. $R(3) = \\{1, 2, 3, 4, 5\\}$.\n  The covariate for subject $1$ is $x_1(3)=1$. The covariates for the subjects in the risk set are:\n  $x_1(3)=1$, $x_2(3)=0$, $x_3(3)=0$, $x_4(3)=1$, $x_5(3)=0$.\n  The term is: $\\frac{\\exp(\\beta \\cdot 1)}{\\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 0)} = \\frac{\\exp(\\beta)}{2\\exp(\\beta) + 3}$.\n\n- **Contribution at $t=5$**: Subject $3$ has the event. $R(5) = \\{2, 3, 4, 5\\}$.\n  The covariate for subject $3$ is $x_3(5)=0$. The covariates for the subjects in the risk set are:\n  $x_2(5)=1$ (since $5 \\in [4, 8)$), $x_3(5)=0$, $x_4(5)=1$, $x_5(5)=0$.\n  The term is: $\\frac{\\exp(\\beta \\cdot 0)}{\\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 0)} = \\frac{1}{2\\exp(\\beta) + 2}$.\n\n- **Contribution at $t=6$**: Subject $4$ has the event. $R(6) = \\{2, 4, 5\\}$.\n  The covariate for subject $4$ is $x_4(6)=1$. The covariates for the subjects in the risk set are:\n  $x_2(6)=1$ (since $6 \\in [4, 8)$), $x_4(6)=1$, $x_5(6)=0$.\n  The term is: $\\frac{\\exp(\\beta \\cdot 1)}{\\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 0)} = \\frac{\\exp(\\beta)}{2\\exp(\\beta) + 1}$.\n\n- **Contribution at $t=9$**: Subject $5$ has the event. $R(9) = \\{2, 5\\}$.\n  The covariate for subject $5$ is $x_5(9)=0$. The covariates for the subjects in the risk set are:\n  $x_2(9)=0$ (since $9 \\in [8, 10)$), $x_5(9)=0$.\n  The term is: $\\frac{\\exp(\\beta \\cdot 0)}{\\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 0)} = \\frac{1}{1 + 1} = \\frac{1}{2}$.\n\nCombining these terms, the partial likelihood $L(\\beta)$ is:\n$$ L(\\beta) = \\left( \\frac{\\exp(\\beta)}{2\\exp(\\beta) + 3} \\right) \\left( \\frac{1}{2\\exp(\\beta) + 2} \\right) \\left( \\frac{\\exp(\\beta)}{2\\exp(\\beta) + 1} \\right) \\left( \\frac{1}{2} \\right) $$\n$$ L(\\beta) = \\frac{\\exp(2\\beta)}{2(2\\exp(\\beta) + 3)(2\\exp(\\beta) + 2)(2\\exp(\\beta) + 1)} $$\nSimplifying the denominator:\n$$ L(\\beta) = \\frac{\\exp(2\\beta)}{4(2\\exp(\\beta) + 3)(\\exp(\\beta) + 1)(2\\exp(\\beta) + 1)} $$\n\n**Task 4: Evaluate the partial likelihood at $\\beta = \\ln(2)$**\nWe need to calculate $L(\\ln(2))$.\nFirst, we evaluate $\\exp(\\beta)$ and $\\exp(2\\beta)$ at $\\beta=\\ln(2)$:\n$\\exp(\\beta) = \\exp(\\ln(2)) = 2$.\n$\\exp(2\\beta) = \\exp(2\\ln(2)) = \\exp(\\ln(2^2)) = \\exp(\\ln(4)) = 4$.\n\nNow, substitute these values into the expression for $L(\\beta)$:\n$$ L(\\ln(2)) = \\left( \\frac{2}{2(2) + 3} \\right) \\left( \\frac{1}{2(2) + 2} \\right) \\left( \\frac{2}{2(2) + 1} \\right) \\left( \\frac{1}{2} \\right) $$\n$$ L(\\ln(2)) = \\left( \\frac{2}{4 + 3} \\right) \\left( \\frac{1}{4 + 2} \\right) \\left( \\frac{2}{4 + 1} \\right) \\left( \\frac{1}{2} \\right) $$\n$$ L(\\ln(2)) = \\left( \\frac{2}{7} \\right) \\left( \\frac{1}{6} \\right) \\left( \\frac{2}{5} \\right) \\left( \\frac{1}{2} \\right) $$\n$$ L(\\ln(2)) = \\frac{2 \\cdot 1 \\cdot 2 \\cdot 1}{7 \\cdot 6 \\cdot 5 \\cdot 2} = \\frac{4}{420} $$\nSimplifying the fraction:\n$$ L(\\ln(2)) = \\frac{4 \\div 4}{420 \\div 4} = \\frac{1}{105} $$\nThe value of the partial likelihood at $\\beta = \\ln(2)$ is $\\frac{1}{105}$.", "answer": "$$\\boxed{\\frac{1}{105}}$$", "id": "4612116"}]}