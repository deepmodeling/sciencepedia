{"hands_on_practices": [{"introduction": "Before applying formal statistical tests, a well-chosen graphical diagnostic can provide powerful, intuitive insights into the proportional hazards (PH) assumption. The PH assumption implies a specific mathematical relationship between the survival functions of different groups, which can be visualized directly. This exercise [@problem_id:4555957] guides you through constructing a log-minus-log plot, a standard graphical method that transforms Kaplan-Meier survival curves in a way that, if the PH assumption holds, should result in parallel lines. Mastering this technique provides a crucial first step in any diagnostic evaluation.", "problem": "In a clinical genomics study in oncology, investigators analyze time-to-progression in patients stratified by a binary biomarker group defined by messenger ribonucleic acid (mRNA) expression (high versus low). The time-to-event variable is denoted by $T$, right-censoring is present, and the scientific question concerns assessing the Proportional Hazards (PH) assumption as it would apply in a Cox proportional hazards model. The investigators plan to use the Kaplan–Meier (KM) method to estimate group-specific survival functions $\\hat S_g(t)$ for each biomarker group $g$. Starting from the core definitions of survival analysis, namely the survival function $S(t) = \\Pr(T  t)$, the hazard function $h(t)$, and the cumulative hazard function $H(t)$, and using only nonparametric estimation together with monotone transformations, the goal is to translate the group-specific survival estimates into a graphical diagnostic for the PH assumption that yields a pattern interpretable as a group effect that does not vary with $t$. Which option best describes the correct construction of this diagnostic using transformed scales and how to interpret it under the PH assumption, while remaining faithful to KM-based estimation and right-censoring?\n\nA. For each group $g$, compute the KM estimate $\\hat S_g(t)$ on a common event-time grid. Then plot the complementary log-log transformation $y_g(t) = \\log\\!\\big(-\\log \\hat S_g(t)\\big)$ against $\\log t$ for all groups. Under PH, the curves $y_g(t)$ are expected to be approximately parallel across groups because the group effect enters as a constant vertical shift with respect to $t$. The constancy of the vertical gap across $t$ is interpretable as evidence of a time-invariant hazard ratio. Use the same $t$ axis for all groups, apply standard right-censoring handling intrinsic to KM, and avoid over-interpretation in regions with sparse risk sets.\n\nB. For each group $g$, compute $\\hat S_g(t)$ and plot $\\hat S_g(t)$ against $t$. Under PH, the curves should display a constant vertical gap across $t$; this gap can be read as the hazard ratio. Because KM already accounts for right-censoring, no further transformation is needed.\n\nC. For each group $g$, estimate the group-specific hazard function as $-\\frac{d}{dt}\\log \\hat S_g(t)$ and plot this against $t$. Under PH, the hazards should align after rescaling the time axis, so coincident curves confirm PH.\n\nD. For each group $g$, estimate the Nelson–Aalen cumulative hazard $\\hat H_g(t)$ and then plot $\\log \\hat H_g(t)$ against $t$. Under PH, the curves should be parallel with a constant vertical gap across $t$, which directly estimates the log hazard ratio; this approach is preferred to KM because it targets hazards.\n\nE. For each group $g$, compute $\\hat S_g(t)$ and plot $\\log \\hat S_g(t)$ against $\\log t$. Under PH, curves should be parallel because the proportionality of hazards implies proportionality of survival on the log scale, yielding a constant vertical gap interpretable as the log hazard ratio.", "solution": "### Derivation from First Principles\nThe objective is to find a transformation of the Kaplan-Meier (KM) survival function estimate, $\\hat{S}_g(t)$, that results in a graphical representation where parallel lines indicate that the proportional hazards (PH) assumption holds. We begin with the core definitions.\n\nLet $h_g(t)$ be the hazard function for group $g$, $H_g(t) = \\int_0^t h_g(u)du$ be the cumulative hazard function, and $S_g(t) = \\Pr(T  t)$ be the survival function. The fundamental relationship between these is $S_g(t) = \\exp(-H_g(t))$.\n\nThe Proportional Hazards (PH) assumption states that the hazard function for one group is a constant multiple of the hazard function for a reference group (let's denote it by subscript $0$). For any other group $g$, we have:\n$$h_g(t) = \\lambda_g \\cdot h_0(t)$$\nwhere $\\lambda_g$ is the hazard ratio, a constant that does not depend on time $t$.\n\nTo see how this assumption translates to other functions, we first integrate the hazard function to get the cumulative hazard:\n$$H_g(t) = \\int_0^t h_g(u)du = \\int_0^t \\lambda_g \\cdot h_0(u)du = \\lambda_g \\int_0^t h_0(u)du = \\lambda_g \\cdot H_0(t)$$\nThis shows that under the PH assumption, the cumulative hazard functions are also proportional.\n\nTo create a graphical diagnostic with parallel lines, we need an additive relationship. Taking the natural logarithm of both sides of the cumulative hazard proportionality equation yields:\n$$\\log H_g(t) = \\log(\\lambda_g \\cdot H_0(t)) = \\log H_0(t) + \\log \\lambda_g$$\nThis equation shows that if we plot $\\log H_g(t)$ against some function of time (e.g., $t$ or $\\log t$), the curves for different groups $g$ will be parallel, separated by a constant vertical distance of $\\log \\lambda_g$ (the log-hazard ratio).\n\nThe problem specifies starting with the Kaplan-Meier estimate of the survival function, $\\hat{S}_g(t)$. We must now relate the derived $\\log H_g(t)$ form to $S_g(t)$. From the definition $S_g(t) = \\exp(-H_g(t))$, we can solve for $H_g(t)$:\n$$ \\log S_g(t) = -H_g(t) \\implies H_g(t) = -\\log S_g(t) $$\nNote that since $S_g(t) \\in [0, 1]$, its logarithm $\\log S_g(t)$ is non-positive.\n\nNow, substitute this expression for $H_g(t)$ into our additive relationship:\n$$ \\log(-\\log S_g(t)) = \\log(-\\log S_0(t)) + \\log \\lambda_g $$\nThis transformation, $y(t) = \\log(-\\log S(t))$, is known as the complementary log-log (cloglog) transformation. This derivation proves that if the PH assumption holds, plotting the cloglog-transformed survival functions for different groups against a time-axis (like $t$ or $\\log t$) should produce approximately parallel curves. The constant vertical separation between the curve for group $g$ and the reference group $0$ is an estimate of the log-hazard ratio, $\\log \\lambda_g$.\n\nThe procedure is thus:\n1. For each group $g$, compute the nonparametric Kaplan-Meier estimate $\\hat{S}_g(t)$. This method correctly handles right-censored data.\n2. Apply the complementary log-log transformation to each estimate: $\\hat{y}_g(t) = \\log(-\\log \\hat{S}_g(t))$.\n3. Plot $\\hat{y}_g(t)$ versus $t$ or $\\log t$ for all groups on the same axes. The choice of $\\log t$ for the x-axis is common as it can help visualize behavior at early time points more clearly.\n4. Assess if the resulting curves are reasonably parallel. Parallelism supports the PH assumption, while crossing or systematically diverging/converging curves suggest a violation.\n\n### Evaluation of Options\n\nLet's evaluate each option based on this derivation.\n\n**A. For each group $g$, compute the KM estimate $\\hat S_g(t)$ on a common event-time grid. Then plot the complementary log-log transformation $y_g(t) = \\log\\!\\big(-\\log \\hat S_g(t)\\big)$ against $\\log t$ for all groups. Under PH, the curves $y_g(t)$ are expected to be approximately parallel across groups because the group effect enters as a constant vertical shift with respect to $t$. The constancy of the vertical gap across $t$ is interpretable as evidence of a time-invariant hazard ratio. Use the same $t$ axis for all groups, apply standard right-censoring handling intrinsic to KM, and avoid over-interpretation in regions with sparse risk sets.**\nThis option perfectly matches our derivation. It specifies the correct transformation, the correct plot, the correct interpretation of parallel lines as a constant vertical shift representing a time-invariant hazard ratio, and includes appropriate methodological cautions.\n**Verdict: Correct.**\n\n**B. For each group $g$, compute $\\hat S_g(t)$ and plot $\\hat S_g(t)$ against $t$. Under PH, the curves should display a constant vertical gap across $t$; this gap can be read as the hazard ratio. Because KM already accounts for right-censoring, no further transformation is needed.**\nThis describes a standard plot of KM curves. Under PH, $S_g(t) = [S_0(t)]^{\\lambda_g}$. The vertical gap is $S_0(t) - S_g(t) = S_0(t) - [S_0(t)]^{\\lambda_g}$, which is a function of $t$ and is not constant. Therefore, the curves are not parallel. Furthermore, the gap does not represent the hazard ratio.\n**Verdict: Incorrect.**\n\n**C. For each group $g$, estimate the group-specific hazard function as $-\\frac{d}{dt}\\log \\hat S_g(t)$ and plot this against $t$. Under PH, the hazards should align after rescaling the time axis, so coincident curves confirm PH.**\nWhile $h(t) = -\\frac{d}{dt}\\log S(t)$ is formally correct, estimating the hazard function $h(t)$ (a derivative) from a non-parametric step function $\\hat{S}_g(t)$ is highly unstable and not typically done directly. More critically, the PH assumption $h_g(t) = \\lambda_g \\cdot h_0(t)$ implies that the hazard curves are *proportional*, not that they align after a time-axis rescaling. Time-axis rescaling corresponds to an Accelerated Failure Time (AFT) model, which is a different class of model.\n**Verdict: Incorrect.**\n\n**D. For each group $g$, estimate the Nelson–Aalen cumulative hazard $\\hat H_g(t)$ and then plot $\\log \\hat H_g(t)$ against $t$. Under PH, the curves should be parallel with a constant vertical gap across $t$, which directly estimates the log hazard ratio; this approach is preferred to KM because it targets hazards.**\nThis describes a valid alternative diagnostic plot. As shown in the derivation, plotting $\\log H_g(t)$ versus time should yield parallel lines under PH. The Nelson-Aalen estimator is the proper tool for estimating $H_g(t)$ nonparametrically. However, the problem explicitly constrains the method to \"using the Kaplan–Meier (KM) method to estimate ... $\\hat{S}_g(t)$\" and \"translat[ing] the group-specific survival estimates\". Option A follows this constraint by transforming $\\hat{S}_g(t)$ itself. Option D deviates by proposing the use of a different primary estimator, the Nelson-Aalen estimator. The claim of preference is also a subjective judgment, not a direct answer to the posed methodological question.\n**Verdict: Incorrect.**\n\n**E. For each group $g$, compute $\\hat S_g(t)$ and plot $\\log \\hat S_g(t)$ against $\\log t$. Under PH, curves should be parallel because the proportionality of hazards implies proportionality of survival on the log scale, yielding a constant vertical gap interpretable as the log hazard ratio.**\nUnder PH, we have $\\log S_g(t) = \\lambda_g \\cdot \\log S_0(t)$. This is a relationship of proportionality, not a constant additive difference (parallelism). The vertical gap on a plot of $\\log S_g(t)$ vs. $\\log t$ would be $\\log S_g(t) - \\log S_0(t) = (\\lambda_g - 1)\\log S_0(t)$, which is dependent on time through $S_0(t)$ and therefore not constant. The curves will not be parallel unless $\\lambda_g=1$.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "4555957"}, {"introduction": "Moving from graphical checks to formal testing requires a systematic workflow, as different model violations can produce similar-looking diagnostic plots. A critical challenge is distinguishing between an incorrectly specified functional form for a continuous covariate and a genuine violation of the proportional hazards assumption. This practice [@problem_id:4555951] introduces the correct, two-step diagnostic procedure, utilizing different types of residuals for each task: martingale residuals to check functional form and Schoenfeld residuals to then assess for non-proportional hazards on a correctly specified model.", "problem": "A translational genomics team analyzes time-to-event outcomes in a cohort where the endpoint is time from enrollment to onset of a cardiovascular event. The working model is a Cox proportional hazards model with a continuous messenger ribonucleic acid (mRNA) expression score, denoted by $x_{1}$, a continuous inflammation biomarker, denoted by $x_{2}$, and standard clinical covariates (e.g., age, sex, comorbidity index). The hazard for an individual with covariate vector $x$ at time $t$ is modeled as $h(t \\mid x) = h_{0}(t)\\exp\\{x^{\\top}\\beta\\}$ under the proportional hazards assumption that the log hazard ratio $\\log\\{h(t \\mid x) / h(t \\mid x^{\\prime})\\}$ is constant in $t$ for any two covariate vectors $x$ and $x^{\\prime}$. The team is concerned that the continuous covariates $x_{1}$ and $x_{2}$ may not enter linearly on the log hazard scale and that misspecification of their functional forms could confound diagnostics for the proportional hazards assumption.\n\nBased only on the core definitions of hazard functions, partial likelihood estimation in the Cox model, and residuals as observed-minus-expected summaries under a fitted model, which of the following $2$-step diagnostic procedures most appropriately (i) addresses functional form misspecification for $x_{1}$ and $x_{2}$ using martingale residuals and (ii) reassesses the proportional hazards assumption using Schoenfeld residuals after refitting the model?\n\nA. Fit the Cox model with $x_{1}$ and $x_{2}$ entered linearly. For each continuous covariate, plot subject-level martingale residuals against the covariate and add a smooth. If a systematic pattern indicates nonlinearity, refit the model replacing the linear term with a flexible function (e.g., a restricted cubic spline) until the martingale residuals versus that covariate fluctuate randomly around zero without trend. Then, compute scaled Schoenfeld residuals for each covariate from the refitted model and test their independence from time (e.g., via a rank-based regression of residuals on a function of $t$) and inspect residual-vs-time smooths. If time dependence remains, consider a time-by-covariate interaction or stratification to address non-proportional hazards.\n\nB. Fit the Cox model with $x_{1}$ and $x_{2}$ entered linearly. First test proportional hazards by regressing scaled Schoenfeld residuals on time; only if a covariate shows time dependence, transform that covariate (e.g., logarithm for $x_{2}$) to reduce correlation with time. Because Schoenfeld residuals are invariant to functional misspecification, it is unnecessary to revisit martingale residuals after transforming.\n\nC. Fit the Cox model and compute deviance residuals; use their symmetry around zero to assess non-proportional hazards. Then, for covariates with skewed deviance residuals, check Schoenfeld residuals versus the covariate value to diagnose functional form and add quadratic terms if needed.\n\nD. Use a parametric accelerated failure time model to diagnose functional form by plotting score residuals against $x_{1}$ and $x_{2}$ and adjust their forms in that model. Then switch back to the Cox proportional hazards model and compute Schoenfeld residuals to assess proportional hazards without refitting the Cox model with the adjusted functional forms.", "solution": "### Principle-Based Derivation\nThe core of this problem lies in understanding the distinct roles of different types of residuals in diagnosing potential misspecifications in a Cox proportional hazards model. A critical principle in model building and diagnostics is to address more fundamental assumptions before proceeding to more specific ones. The functional form of covariates is a more fundamental aspect of the model specification, $x^{\\top}\\beta$, than the proportional hazards assumption, which relates the specified model to time. Misspecification of the functional form can induce spurious evidence of non-proportional hazards. Therefore, the logical diagnostic sequence is:\n1.  Verify the functional form of the covariates.\n2.  After ensuring the functional form is reasonably correct (and refitting the model if necessary), verify the proportional hazards assumption.\n\nWe must now evaluate the tools for each step.\n-   **Martingale Residuals**: The martingale residual for subject $i$ is defined as $M_i = \\delta_i - \\hat{E}_i$, where $\\delta_i$ is the event indicator ($1$ for an event, $0$ for censoring) and $\\hat{E}_i$ is the expected number of events for that subject under the fitted model, given by $\\hat{E}_i = \\hat{H}(T_i) = \\int_0^{T_i} \\exp(x_i^{\\top}\\hat{\\beta}) d\\hat{H}_0(u)$. The sum of all martingale residuals is zero. These residuals represent the \"excess\" number of events experienced by a subject compared to the model's expectation. A plot of martingale residuals against a covariate $x_k$ is the standard tool to check for nonlinearity. A systematic pattern (e.g., a curve) in this plot suggests that the assumed linear relationship between $x_k$ and the log-hazard is incorrect. The correct response is to adjust the functional form, for instance by using polynomial terms, transformations, or splines.\n-   **Schoenfeld Residuals**: These are defined for each covariate at each event time. For covariate $k$ and the $j$-th ordered event time $t_{(j)}$, the residual is the difference between the covariate value for the subject who failed, $x_{k(j)}$, and the risk-set-weighted average of the covariate for all subjects still at risk at $t_{(j)}$. The fundamental property is that, under the PH assumption, the expected value of the Schoenfeld residuals for a given covariate is constant over time (specifically, $0$). Therefore, a plot of Schoenfeld residuals against time (or a function of time) should show a random scatter around a horizontal line at zero. A non-zero slope or other systematic trend indicates a violation of the PH assumption for that covariate.\n\nBased on this, the correct procedure is to first use martingale residuals to check and fix the functional form of continuous covariates like $x_1$ and $x_2$. After refitting the model with the corrected functional forms, one should then use Schoenfeld residuals from this new, improved model to assess the proportional hazards assumption.\n\n### Option-by-Option Analysis\n\n**A.** This option proposes a sequence:\n1.  Fit an initial linear model. Plot martingale residuals against each continuous covariate ($x_{1}$, $x_{2}$) to check for nonlinearity.\n2.  If nonlinearity is detected, refit the model with a more flexible functional form (like a restricted cubic spline).\n3.  Using this refitted model, compute scaled Schoenfeld residuals and test their independence from time to assess the proportional hazards assumption.\n4.  If non-proportionality is found, consider appropriate remedies like time-by-covariate interactions.\n\nThis sequence is perfectly aligned with the established statistical principles. It addresses functional form first using the correct diagnostic (martingale residuals) and then assesses proportional hazards on the improved model using its specific diagnostic (Schoenfeld residuals).\n\n**Verdict: Correct.**\n\n**B.** This option proposes:\n1.  Test for proportional hazards first using Schoenfeld residuals.\n2.  It claims that transforming a covariate is the remedy for time-dependence in Schoenfeld residuals. This is a confusion of purpose; transformations address functional form, while time-interactions address non-proportionality.\n3.  It makes the factually incorrect statement that \"Schoenfeld residuals are invariant to functional misspecification.\" As explained, functional form misspecification can induce apparent non-proportionality, meaning Schoenfeld residuals are indeed affected.\n\nThis procedure reverses the correct diagnostic order and is based on a false premise.\n\n**Verdict: Incorrect.**\n\n**C.** This option proposes:\n1.  Use deviance residuals to assess non-proportional hazards. This is incorrect; while deviance residuals are useful for overall goodness-of-fit and outlier detection, Schoenfeld residuals are the specific tool for assessing the PH assumption.\n2.  Use Schoenfeld residuals plotted against the *covariate value* to diagnose functional form. This is also incorrect. Martingale residuals are plotted against the covariate to check functional form. Schoenfeld residuals are plotted against *time* to check the PH assumption.\n\nThis option fundamentally confuses the application of different residual types.\n\n**Verdict: Incorrect.**\n\n**D.** This option proposes a convoluted workflow:\n1.  Switch to a different model family, the accelerated failure time (AFT) model, to diagnose functional form. The optimal functional form for an AFT model (where covariates scale time) is not necessarily the same as for a Cox model (where covariates scale hazard). This is not a standard or direct way to diagnose the Cox model.\n2.  Compute Schoenfeld residuals from the original Cox model \"without refitting the Cox model with the adjusted functional forms.\" This is logically flawed. If a model is believed to be misspecified in its functional form, any subsequent diagnostic (like a PH test) performed on that same flawed model is unreliable. One must always refit the model after making a correction before proceeding to the next diagnostic step.\n\nThis procedure is illogical, mixes model families inappropriately, and omits the crucial step of refitting the model.\n\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "4555951"}, {"introduction": "In many modern bioinformatics and clinical studies, Cox models include numerous covariates, and it is good practice to check the proportional hazards assumption for each one. Performing many statistical tests simultaneously, however, inflates the probability of finding a \"significant\" violation purely by chance. This hands-on problem [@problem_id:4555985] addresses the multiple comparisons problem by demonstrating how to apply the Benjamini-Hochberg procedure to control the False Discovery Rate (FDR) across a set of Grambsch-Therneau tests, ensuring more robust and reliable conclusions in a realistic, multi-covariate setting.", "problem": "A translational oncology study fits a Cox proportional hazards model to overall survival in a cohort of $n = 410$ patients. The model includes $m = 10$ baseline covariates: age, sex, stage, tumor grade, treatment arm, body mass index, a five-gene expression signature score, smoking status, Charlson comorbidity index, and enrolling center. To diagnose the proportional hazards assumption for each covariate, the investigators compute covariate-specific Grambsch–Therneau tests based on scaled Schoenfeld residuals. Under the null hypothesis that the corresponding coefficient is time-invariant, each test yields a $p$-value. The observed covariate-specific $p$-values are:\n- age: $0.031$,\n- sex: $0.72$,\n- stage: $0.004$,\n- tumor grade: $0.058$,\n- treatment arm: $0.12$,\n- body mass index: $0.29$,\n- five-gene signature score: $0.0009$,\n- smoking status: $0.21$,\n- Charlson comorbidity index: $0.045$,\n- enrolling center: $0.36$.\n\nUsing only fundamental definitions of the Cox proportional hazards model, proportional hazards assumption, the notion of a $p$-value as the tail probability under a null hypothesis, and the definition of the false discovery rate as the expected proportion of false rejections among all rejections, compute the Benjamini–Hochberg adjusted $p$-values across these $m=10$ tests. Then, interpret which covariates show evidence against the proportional hazards assumption when controlling the false discovery rate at level $q = 0.10$.\n\nReport only the number of covariates that significantly violate the proportional hazards assumption at false discovery rate level $q = 0.10$ as your final answer. Do not round intermediate quantities; the final reported value must be an integer count.", "solution": "### Solution Derivation\nThe problem requires us to assess the evidence against the proportional hazards (PH) assumption for $m=10$ covariates in a Cox model. For each covariate, a Grambsch–Therneau test is performed, yielding a $p$-value. The null hypothesis for each test is that the PH assumption holds for that covariate. A small $p$-value suggests a violation of this assumption.\n\nSince we are performing $m=10$ simultaneous hypothesis tests, we must adjust for multiple comparisons to control the error rate. The problem specifies controlling the False Discovery Rate (FDR), the expected proportion of incorrectly rejected null hypotheses (false discoveries) among all rejected hypotheses. The chosen FDR level is $q = 0.10$. We will use the Benjamini–Hochberg (BH) procedure to achieve this control.\n\nThe Benjamini-Hochberg procedure involves the following steps:\n\n1.  Order the $m=10$ individual $p$-values from smallest to largest. Let these ordered $p$-values be denoted by $P_{(1)}, P_{(2)}, \\dots, P_{(m)}$.\n2.  Compute the BH-adjusted $p$-value for each test. The adjusted $p$-value for the $i$-th ordered test, $p_{adj,(i)}$, is given by the formula:\n    $$p_{adj,(i)} = \\min_{j=i, \\dots, m} \\left\\{ \\frac{m}{j} P_{(j)} \\right\\}$$\n    This ensures that the sequence of adjusted $p$-values is monotonically non-decreasing. A practical recursive method for this calculation is:\n    -   For the largest $p$-value ($i=m$): $p_{adj,(m)} = P_{(m)}$.\n    -   For all other $p$-values ($i = m-1, \\dots, 1$): $p_{adj,(i)} = \\min\\left(\\frac{m}{i}P_{(i)}, p_{adj,(i+1)}\\right)$.\n3.  Compare each adjusted $p$-value to the FDR level $q$. A test is declared significant if its adjusted $p$-value is less than or equal to $q$.\n\nLet's apply this procedure to the given data.\n\n**Step 1: Order the $p$-values**\nThe $m=10$ given $p$-values are: $0.031$, $0.72$, $0.004$, $0.058$, $0.12$, $0.29$, $0.0009$, $0.21$, $0.045$, $0.36$.\nOrdering them yields:\n-   $P_{(1)} = 0.0009$ (five-gene signature score)\n-   $P_{(2)} = 0.004$ (stage)\n-   $P_{(3)} = 0.031$ (age)\n-   $P_{(4)} = 0.045$ (Charlson comorbidity index)\n-   $P_{(5)} = 0.058$ (tumor grade)\n-   $P_{(6)} = 0.12$ (treatment arm)\n-   $P_{(7)} = 0.21$ (smoking status)\n-   $P_{(8)} = 0.29$ (body mass index)\n-   $P_{(9)} = 0.36$ (enrolling center)\n-   $P_{(10)} = 0.72$ (sex)\n\n**Step 2: Compute the BH-adjusted $p$-values**\nWe use $m=10$ and compute the adjusted $p$-values recursively, starting from $i=10$ down to $i=1$.\n\n-   For $i=10$: $p_{adj,(10)} = P_{(10)} = 0.72$.\n-   For $i=9$: $p_{adj,(9)} = \\min\\left(\\frac{10}{9}P_{(9)}, p_{adj,(10)}\\right) = \\min\\left(\\frac{10}{9} \\times 0.36, 0.72\\right) = \\min(0.4, 0.72) = 0.4$.\n-   For $i=8$: $p_{adj,(8)} = \\min\\left(\\frac{10}{8}P_{(8)}, p_{adj,(9)}\\right) = \\min\\left(\\frac{10}{8} \\times 0.29, 0.4\\right) = \\min(0.3625, 0.4) = 0.3625$.\n-   For $i=7$: $p_{adj,(7)} = \\min\\left(\\frac{10}{7}P_{(7)}, p_{adj,(8)}\\right) = \\min\\left(\\frac{10}{7} \\times 0.21, 0.3625\\right) = \\min(0.3, 0.3625) = 0.3$.\n-   For $i=6$: $p_{adj,(6)} = \\min\\left(\\frac{10}{6}P_{(6)}, p_{adj,(7)}\\right) = \\min\\left(\\frac{10}{6} \\times 0.12, 0.3\\right) = \\min(0.2, 0.3) = 0.2$.\n-   For $i=5$: $p_{adj,(5)} = \\min\\left(\\frac{10}{5}P_{(5)}, p_{adj,(6)}\\right) = \\min\\left(2 \\times 0.058, 0.2\\right) = \\min(0.116, 0.2) = 0.116$.\n-   For $i=4$: $p_{adj,(4)} = \\min\\left(\\frac{10}{4}P_{(4)}, p_{adj,(5)}\\right) = \\min\\left(2.5 \\times 0.045, 0.116\\right) = \\min(0.1125, 0.116) = 0.1125$.\n-   For $i=3$: $p_{adj,(3)} = \\min\\left(\\frac{10}{3}P_{(3)}, p_{adj,(4)}\\right) = \\min\\left(\\frac{10}{3} \\times 0.031, 0.1125\\right) = \\min\\left(\\frac{0.31}{3}, 0.1125\\right) \\approx \\min(0.10333, 0.1125) = 0.10333...$.\n-   For $i=2$: $p_{adj,(2)} = \\min\\left(\\frac{10}{2}P_{(2)}, p_{adj,(3)}\\right) = \\min\\left(5 \\times 0.004, 0.10333...\\right) = \\min(0.02, 0.10333...) = 0.02$.\n-   For $i=1$: $p_{adj,(1)} = \\min\\left(\\frac{10}{1}P_{(1)}, p_{adj,(2)}\\right) = \\min\\left(10 \\times 0.0009, 0.02\\right) = \\min(0.009, 0.02) = 0.009$.\n\n**Step 3: Compare adjusted p-values to the FDR level $q=0.10$**\nWe now identify which of the adjusted $p$-values are less than or equal to $q=0.10$.\n\n-   $p_{adj,(1)} = 0.009 \\leq 0.10$ (Significant). This corresponds to the **five-gene signature score**.\n-   $p_{adj,(2)} = 0.02 \\leq 0.10$ (Significant). This corresponds to **stage**.\n-   $p_{adj,(3)} \\approx 0.10333 > 0.10$ (Not significant). This corresponds to **age**.\n\nSince the adjusted $p$-values are monotonically increasing, no subsequent tests will be significant. The hypotheses corresponding to $P_{(1)}$ and $P_{(2)}$ are rejected. All other null hypotheses are not rejected.\n\nTherefore, two covariates show statistically significant evidence of violating the proportional hazards assumption when controlling the false discovery rate at the $10\\%$ level. These covariates are the five-gene signature score and stage.\n\nThe final requested answer is the count of these significant covariates. The count is $2$.", "answer": "$$\\boxed{2}$$", "id": "4555985"}]}