{"hands_on_practices": [{"introduction": "At the heart of neuronal energy metabolism lies the tricarboxylic acid ($TCA$) cycle, the final common pathway for the oxidation of carbohydrates, fats, and proteins. Understanding the precise energy yield from this process is foundational to any quantitative analysis of the brain's energy budget. This practice will guide you through a fundamental calculation: determining the total number of adenosine triphosphate ($ATP$) molecules generated from a single molecule of acetyl-CoA, using modern, experimentally-derived efficiencies for oxidative phosphorylation [@problem_id:4507748].", "problem": "In a mature cortical neuron at metabolic steady state, an acetyl coenzyme A (acetyl-CoA) molecule enters the tricarboxylic acid (TCA) cycle in the mitochondrial matrix and is fully oxidized. From well-established biochemistry, each turn of the TCA cycle per acetyl-CoA yields reduced nicotinamide adenine dinucleotide (NADH), reduced flavin adenine dinucleotide ($\\text{FADH}_2$), and guanosine triphosphate (GTP) via substrate-level phosphorylation. In neuronal mitochondria, oxidative phosphorylation (OXPHOS) couples the reoxidation of these reduced electron carriers to adenosine triphosphate (ATP) synthesis, characterized by an ATP-per-oxygen-atom-reduced stoichiometry (P/O ratio). Assume the following are valid under the stated neuronal conditions:\n- Each acetyl-CoA oxidized by the TCA cycle yields $3$ molecules of NADH, $1$ molecule of $\\text{FADH}_2$, and $1$ molecule of GTP.\n- The P/O ratio for NADH is $2.5$, meaning the reoxidation of one NADH via the electron transport chain and ATP synthase produces $2.5$ molecules of ATP.\n- The P/O ratio for $\\text{FADH}_2$ is $1.5$.\n- Guanosine triphosphate (GTP) produced in the TCA cycle is rapidly and efficiently converted to ATP by nucleoside diphosphate kinase with no net energetic cost, so count each GTP as one ATP equivalent.\n- Ignore all other energetic costs (for example, ion pumping unrelated to ATP synthesis, proton leak beyond that incorporated into the assumed P/O ratios, and transport overhead).\n\nUsing only these assumptions and starting from the foundational stoichiometry of the TCA cycle and the coupling of electron carrier reoxidation to ATP synthesis, compute the total number of ATP equivalents produced per acetyl-CoA oxidized. Express your answer as a single real number. No rounding is required.", "solution": "The user has asked for a critical validation of the provided problem statement, followed by a complete solution if the problem is valid.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- One molecule of acetyl coenzyme A (acetyl-CoA) is fully oxidized in the tricarboxylic acid (TCA) cycle.\n- Yield per acetyl-CoA from the TCA cycle: $3$ molecules of NADH, $1$ molecule of $\\text{FADH}_2$, and $1$ molecule of GTP.\n- P/O ratio for NADH: $2.5$ ATP per NADH.\n- P/O ratio for $\\text{FADH}_2$: $1.5$ ATP per $\\text{FADH}_2$.\n- Energetic equivalence: $1$ GTP is equivalent to $1$ ATP.\n- All other energetic costs are to be ignored.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on fundamental principles of cellular respiration, specifically the TCA cycle and oxidative phosphorylation. The stoichiometric values provided (yield of $3$ NADH, $1$ $\\text{FADH}_2$, $1$ GTP per acetyl-CoA) are the universally accepted values in biochemistry. The P/O ratios of $2.5$ for NADH and $1.5$ for $\\text{FADH}_2$ are the modern, experimentally supported consensus values, reflecting a more accurate understanding of proton motive force and ATP synthase function than older integer estimates. The assumed equivalence of GTP and ATP is standard practice in metabolic energy accounting. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly defined and provides all necessary information to calculate a unique numerical answer. The question is specific and unambiguous.\n- **Objective**: The problem is stated in precise, quantitative terms, free from subjective language or opinion.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, objective, and complete. I will proceed with the solution.\n\n### Solution\n\nThe objective is to calculate the total number of adenosine triphosphate (ATP) equivalents generated from the complete oxidation of one molecule of acetyl-CoA, based on the provided stoichiometric yields and P/O ratios.\n\nThe total ATP yield is the sum of the ATP produced from three sources originating from the TCA cycle: NADH, $\\text{FADH}_2$, and GTP. We will calculate the contribution from each.\n\n1.  **ATP from NADH:**\n    The problem states that the oxidation of one molecule of acetyl-CoA yields $3$ molecules of NADH. The P/O ratio for NADH is given as $2.5$, meaning each molecule of NADH that is reoxidized by the electron transport chain results in the synthesis of $2.5$ molecules of ATP.\n    The ATP yield from NADH is:\n    $$ \\text{ATP from NADH} = (\\text{molecules of NADH}) \\times (\\text{P/O ratio for NADH}) $$\n    $$ \\text{ATP from NADH} = 3 \\times 2.5 = 7.5 \\; \\text{ATP} $$\n\n2.  **ATP from $\\text{FADH}_2$:**\n    The TCA cycle yields $1$ molecule of $\\text{FADH}_2$ per acetyl-CoA. The P/O ratio for $\\text{FADH}_2$ is given as $1.5$.\n    The ATP yield from $\\text{FADH}_2$ is:\n    $$ \\text{ATP from } \\text{FADH}_2 = (\\text{molecules of } \\text{FADH}_2) \\times (\\text{P/O ratio for } \\text{FADH}_2) $$\n    $$ \\text{ATP from } \\text{FADH}_2 = 1 \\times 1.5 = 1.5 \\; \\text{ATP} $$\n\n3.  **ATP from GTP:**\n    The TCA cycle produces $1$ molecule of GTP via substrate-level phosphorylation. The problem specifies that GTP is energetically equivalent to ATP on a one-to-one basis.\n    The ATP yield from GTP is:\n    $$ \\text{ATP from GTP} = (\\text{molecules of GTP}) \\times (\\text{ATP equivalence factor}) $$\n    $$ \\text{ATP from GTP} = 1 \\times 1 = 1 \\; \\text{ATP} $$\n\n4.  **Total ATP Yield:**\n    The total number of ATP equivalents is the sum of the ATP generated from all three sources.\n    $$ \\text{Total ATP} = (\\text{ATP from NADH}) + (\\text{ATP from } \\text{FADH}_2) + (\\text{ATP from GTP}) $$\n    $$ \\text{Total ATP} = 7.5 + 1.5 + 1 $$\n    $$ \\text{Total ATP} = 9.0 + 1 $$\n    $$ \\text{Total ATP} = 10 $$\n\nTherefore, the complete oxidation of one molecule of acetyl-CoA under the specified conditions yields a total of $10$ ATP equivalents.", "answer": "$$\n\\boxed{10}\n$$", "id": "4507748"}, {"introduction": "While the first practice focused on energy supply, this exercise shifts our attention to the primary driver of energy demand in the brain: neural signaling. Every action potential, the basic unit of neural communication, incurs a metabolic cost to restore the ionic gradients that make it possible. In this problem, you will derive from first principles the $ATP$ cost of a single action potential, bridging the gap between the physics of membrane capacitance and the biochemistry of the $\\text{Na}^{+}/\\text{K}^{+}$ ATPase pump [@problem_id:4507832].", "problem": "A single action potential in an unmyelinated axon segment imposes an energetic cost to restore ionic gradients via the $\\text{Na}^+/\\text{K}^+$-ATPase. Consider a straight cylindrical axon segment of length $L$ and diameter $d$. The membrane capacitance per unit area is $c_{m}$, and the action potential causes a transmembrane voltage excursion of magnitude $\\Delta V$ from baseline to peak. Assume monovalent Sodium ($\\text{Na}^+$) ions carry charge $+e$, and that overlap between Sodium ($\\text{Na}^+$) influx and Potassium ($\\text{K}^+$) efflux during the spike increases the Sodium load above the minimal capacitive requirement by a dimensionless factor $\\alpha$. The $\\text{Na}^+/\\text{K}^+$-ATPase extrudes $3$ Sodium ions per Adenosine Triphosphate (ATP) hydrolyzed while importing $2$ Potassium ions, so the ATP molecules required to restore the Sodium load equal one third of the Sodium ions to be extruded.\n\nUsing only the fundamental relations of capacitance and charge, and the $\\text{Na}^+/\\text{K}^+$-ATPase stoichiometry, derive from first principles an expression for the total number of Adenosine Triphosphate (ATP) molecules consumed per action potential in this axon segment, and evaluate it for the following scientifically plausible parameters:\n- $L = 1.0 \\times 10^{-3} \\,\\mathrm{m}$,\n- $d = 5.0 \\times 10^{-7} \\,\\mathrm{m}$,\n- $c_{m} = 1.0 \\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$,\n- $\\Delta V = 1.0 \\times 10^{-1} \\,\\mathrm{V}$,\n- $\\alpha = 4.0$,\n- $e = 1.602176634 \\times 10^{-19} \\,\\mathrm{C}$.\n\nAssume the membrane area of the segment is $A = \\pi d L$, neglect any contributions from Chloride ($\\text{Cl}^{-}$), Calcium ($\\text{Ca}^{2+}$), and gating charges, and treat the intra- and extracellular media as ideal conductors for the purpose of the capacitance relation. Round your final numerical answer to three significant figures and express it as the number of molecules (no units).", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n-   Axon segment geometry: straight cylinder of length $L$ and diameter $d$.\n-   Membrane capacitance per unit area: $c_{m}$.\n-   Transmembrane voltage excursion magnitude: $\\Delta V$.\n-   Sodium ion charge: $+e$.\n-   Overlap factor for sodium load: $\\alpha$, a dimensionless factor.\n-   $\\text{Na}^+/\\text{K}^+$-ATPase stoichiometry: $3$ Sodium ions extruded per $1$ Adenosine Triphosphate (ATP) hydrolyzed.\n-   Relation for ATP cost: ATP molecules required = $\\frac{1}{3} \\times (\\text{Sodium ions to be extruded})$.\n-   Assumed membrane area: $A = \\pi d L$.\n-   Neglected factors: Contributions from Chloride ($\\text{Cl}^{-}$), Calcium ($\\text{Ca}^{2+}$), and gating charges.\n-   Idealization: Intra- and extracellular media are ideal conductors for capacitance relation.\n-   Parameter values for evaluation:\n    -   $L = 1.0 \\times 10^{-3} \\,\\mathrm{m}$\n    -   $d = 5.0 \\times 10^{-7} \\,\\mathrm{m}$\n    -   $c_{m} = 1.0 \\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$\n    -   $\\Delta V = 1.0 \\times 10^{-1} \\,\\mathrm{V}$\n    -   $\\alpha = 4.0$\n    -   $e = 1.602176634 \\times 10^{-19} \\,\\mathrm{C}$\n-   Final instruction: Round the numerical answer to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of cellular neurophysiology and basic physics (electromagnetism). The model presented is a standard, albeit simplified, representation of the metabolic cost of an action potential, based on the work of Hodgkin and Huxley. The relationship between charge, capacitance, and voltage ($Q = CV$) is a fundamental principle. The stoichiometry of the $\\text{Na}^+/\\text{K}^+$-ATPase is a well-established biological fact. The parameters provided ($L, d, c_m, \\Delta V, \\alpha, e$) are within physically and biologically plausible ranges for an unmyelinated axon. The problem is well-posed, providing all necessary information and a clear objective. The language is objective and precise. The units are consistent after proper conversion, as will be demonstrated in the solution. The problem requires the synthesis of concepts from physics and biology, making it a non-trivial exercise in biophysics.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived from first principles.\n\n### Derivation and Solution\n\nThe goal is to derive an expression for $N_{ATP}$, the total number of ATP molecules consumed per action potential in the specified axon segment.\n\n1.  **Membrane Surface Area ($A$)**: The axon segment is a cylinder of length $L$ and diameter $d$. The surface area of the membrane is given by the formula for the lateral surface area of a cylinder.\n    $$ A = \\pi d L $$\n\n2.  **Total Membrane Capacitance ($C$)**: The total capacitance of the segment is the product of the specific membrane capacitance ($c_m$, capacitance per unit area) and the total membrane area ($A$).\n    $$ C = c_m A = c_m \\pi d L $$\n\n3.  **Minimum Charge Transfer ($Q_{cap}$)**: An action potential involves a change in the transmembrane voltage by $\\Delta V$. According to the fundamental capacitance relation, the minimum amount of charge that must move across the membrane to effect this voltage change is:\n    $$ Q_{cap} = C \\Delta V = c_m \\pi d L \\Delta V $$\n    This represents the charge required to change the voltage across the membrane as if it were a simple capacitor.\n\n4.  **Total Sodium Ion Influx ($N_{Na, total}$)**: The charge influx is carried by monovalent sodium ions ($\\text{Na}^{+}$), each carrying a charge $+e$. The problem states that due to the temporal overlap of $\\text{Na}^{+}$ influx and $\\text{K}^{+}$ efflux currents during an action potential, the actual sodium load is a factor $\\alpha$ greater than the minimum capacitive requirement. First, we find the number of ions corresponding to $Q_{cap}$, let's call it $N_{Na, cap}$:\n    $$ N_{Na, cap} = \\frac{Q_{cap}}{e} = \\frac{c_m \\pi d L \\Delta V}{e} $$\n    The total number of sodium ions that actually enter the axon, $N_{Na, total}$, is then:\n    $$ N_{Na, total} = \\alpha N_{Na, cap} = \\frac{\\alpha c_m \\pi d L \\Delta V}{e} $$\n\n5.  **ATP Molecules Consumed ($N_{ATP}$)**: The increased intracellular sodium concentration is restored to its baseline level by the $\\text{Na}^+/\\text{K}^+$-ATPase pump. The stoichiometry given is that $3$ $\\text{Na}^{+}$ ions are extruded for every $1$ molecule of ATP hydrolyzed. Therefore, the number of ATP molecules required, $N_{ATP}$, is one-third of the total number of sodium ions that entered.\n    $$ N_{ATP} = \\frac{1}{3} N_{Na, total} $$\n    Substituting the expression for $N_{Na, total}$ from the previous step yields the final symbolic expression for the ATP cost:\n    $$ N_{ATP} = \\frac{\\alpha c_m \\pi d L \\Delta V}{3e} $$\n\n### Numerical Evaluation\n\nWe now evaluate this expression using the provided parameters. First, we must ensure all units are in the SI system. The specific capacitance $c_m$ is given in mixed units and requires conversion.\n$$ c_{m} = 1.0 \\frac{\\mu\\mathrm{F}}{\\mathrm{cm}^{2}} = 1.0 \\frac{10^{-6} \\,\\mathrm{F}}{(10^{-2} \\,\\mathrm{m})^{2}} = 1.0 \\frac{10^{-6} \\,\\mathrm{F}}{10^{-4} \\,\\mathrm{m}^{2}} = 1.0 \\times 10^{-2} \\frac{\\mathrm{F}}{\\mathrm{m}^{2}} $$\n\nThe other parameters are:\n-   $L = 1.0 \\times 10^{-3} \\,\\mathrm{m}$\n-   $d = 5.0 \\times 10^{-7} \\,\\mathrm{m}$\n-   $\\Delta V = 1.0 \\times 10^{-1} \\,\\mathrm{V}$\n-   $\\alpha = 4.0$ (dimensionless)\n-   $e = 1.602176634 \\times 10^{-19} \\,\\mathrm{C}$\n\nSubstituting these values into the derived expression for $N_{ATP}$:\n$$ N_{ATP} = \\frac{(4.0) (1.0 \\times 10^{-2} \\frac{\\mathrm{F}}{\\mathrm{m}^{2}}) \\pi (5.0 \\times 10^{-7} \\,\\mathrm{m}) (1.0 \\times 10^{-3} \\,\\mathrm{m}) (1.0 \\times 10^{-1} \\,\\mathrm{V})}{3 (1.602176634 \\times 10^{-19} \\,\\mathrm{C})} $$\nThe units in the numerator are $(\\frac{\\mathrm{F}}{\\mathrm{m}^{2}}) \\cdot \\mathrm{m} \\cdot \\mathrm{m} \\cdot \\mathrm{V} = \\mathrm{F} \\cdot \\mathrm{V} = \\mathrm{C}$, which cancels with the units of Coulombs in the denominator, resulting in a dimensionless number (a count of molecules), as expected.\n\nNow, we compute the numerical value:\n$$ N_{ATP} = \\frac{4.0 \\times \\pi \\times 5.0 \\times (10^{-2} \\times 10^{-7} \\times 10^{-3} \\times 10^{-1})}{3 \\times 1.602176634 \\times 10^{-19}} $$\n$$ N_{ATP} = \\frac{20.0 \\pi \\times 10^{-13}}{4.806529902 \\times 10^{-19}} $$\n$$ N_{ATP} = \\frac{2.0 \\pi \\times 10^{-12}}{4.806529902 \\times 10^{-19}} \\approx \\frac{6.2831853}{4.8065299} \\times 10^{7} $$\n$$ N_{ATP} \\approx 1.30721 \\times 10^{7} $$\n\nThe problem requires rounding the final answer to three significant figures.\n$$ N_{ATP} \\approx 1.31 \\times 10^{7} $$\nThis is the total number of ATP molecules consumed to restore the sodium gradient after a single action potential in the specified axon segment.", "answer": "$$ \\boxed{1.31 \\times 10^{7}} $$", "id": "4507832"}, {"introduction": "Having established the building blocks of energy supply and demand, we can now assemble them into a systems-level model of the brain's energy budget. Such models are crucial for understanding the metabolic constraints that shape neural computation and for interpreting macroscopic measurements like the Cerebral Metabolic Rate of Oxygen ($CMRO_2$). This computational exercise challenges you to build a model that predicts the maximum sustainable firing rate of a neural population, demonstrating the powerful trade-off between energy availability and information processing capacity [@problem_id:4507822].", "problem": "A cerebral cortical gray matter voxel contains a large population of neurons whose activity is sustained by adenosine triphosphate (ATP) generated via oxidative metabolism of oxygen. Cerebral Metabolic Rate of Oxygen (CMRO2) is defined as the oxygen consumption rate per unit mass of tissue. The goal is to evaluate a computational energy budget model that links firing rate, neurotransmitter cycling, and Cerebral Metabolic Rate of Oxygen (CMRO2) to predict metabolic constraints on cortical network activity.\n\nStarting from fundamental principles, use conservation of mass and energy with the following bases:\n- Oxidative phosphorylation converts oxygen into ATP at an average stoichiometric yield of $n_{\\mathrm{ATP/O2}}$ ATP molecules per oxygen molecule consumed.\n- Total ATP supply per unit mass equals oxygen consumption times $n_{\\mathrm{ATP/O2}}$.\n- Total ATP demand per unit mass equals the sum of a housekeeping (basal) term and a signaling term that scales with firing and synaptic activity.\n- Neurotransmitter cycling capacity imposes an independent upper bound on effective excitatory synaptic throughput because each excitatory vesicle contains a finite number of glutamate molecules that must be recycled.\n\nAssume the following definitions and units:\n- Let $\\mathrm{CMRO2}$ be oxygen consumption in $\\mathrm{\\mu mol\\ O_2\\ g^{-1}\\ min^{-1}}$.\n- Let $n_{\\mathrm{ATP/O2}}$ be the dimensionless ATP yield per oxygen molecule.\n- Let $N$ be neurons per gram in $\\mathrm{neurons\\ g^{-1}}$.\n- Let $B$ be basal ATP demand per neuron in $\\mathrm{mol\\ ATP\\ s^{-1}\\ neuron^{-1}}$.\n- Let $C_{\\mathrm{AP}}^{\\mathrm{ATP}}$ be ATP molecules per action potential (spike) per neuron.\n- Let $C_{\\mathrm{syn}}^{\\mathrm{ATP}}$ be ATP molecules per synaptic event.\n- Let $q$ be average synaptic events per spike per neuron (dimensionless).\n- Let $\\phi_e$ be the fraction of synaptic events that are excitatory (dimensionless in $[0,1]$).\n- Let $n_{\\mathrm{Glu}}$ be glutamate molecules per excitatory vesicle (dimensionless count).\n- Let $V_{\\mathrm{NT,max}}$ be the maximum neurotransmitter (NT) cycling capacity in $\\mathrm{\\mu mol\\ g^{-1}\\ min^{-1}}$.\n\nUse the Avogadro constant $N_A$ (molecules per mole) to convert between molecules and moles. The conservation framework requires that, at steady state, the sustainable population-averaged firing rate $r_{\\max}$ (in hertz) must satisfy both an energy-supply constraint and a neurotransmitter-cycling throughput constraint. Derive $r_{\\max}$ from first principles and compute it for each test case.\n\nYour program must:\n- Convert all molecule counts to moles using $N_A$.\n- Convert all $\\mathrm{\\mu mol\\ g^{-1}\\, min^{-1}}$ rates to $\\mathrm{mol\\, g^{-1}\\, s^{-1}}$.\n- Compute the maximum sustainable firing rate $r_{\\max}$ (in hertz) as the nonnegative rate that simultaneously satisfies energy balance and neurotransmitter cycling throughput.\n- Express the final firing rate in $\\mathrm{Hz}$, rounded to six decimal places.\n\nTest suite. For each case, use the parameter set listed below. All numbers are given in scientifically plausible ranges. Units are as defined above.\n- Case $1$ (baseline, happy path):\n  - $\\mathrm{CMRO2} = 1.8$\n  - $n_{\\mathrm{ATP/O2}} = 5.2$\n  - $N = 1.6 \\times 10^{7}$\n  - $B = 1.0 \\times 10^{-17}$\n  - $C_{\\mathrm{AP}}^{\\mathrm{ATP}} = 3.0 \\times 10^{9}$\n  - $C_{\\mathrm{syn}}^{\\mathrm{ATP}} = 1.0 \\times 10^{6}$\n  - $q = 2000$\n  - $\\phi_e = 0.8$\n  - $n_{\\mathrm{Glu}} = 3000$\n  - $V_{\\mathrm{NT,max}} = 0.30$\n- Case $2$ (boundary, oxygen supply equals basal demand):\n  - $\\mathrm{CMRO2} = 1.846153846 \\times 10^{-3}$\n  - $n_{\\mathrm{ATP/O2}} = 5.2$\n  - $N = 1.6 \\times 10^{7}$\n  - $B = 1.0 \\times 10^{-17}$\n  - $C_{\\mathrm{AP}}^{\\mathrm{ATP}} = 3.0 \\times 10^{9}$\n  - $C_{\\mathrm{syn}}^{\\mathrm{ATP}} = 1.0 \\times 10^{6}$\n  - $q = 2000$\n  - $\\phi_e = 0.8$\n  - $n_{\\mathrm{Glu}} = 3000$\n  - $V_{\\mathrm{NT,max}} = 0.30$\n- Case $3$ (high oxygen, neurotransmitter cycling limited):\n  - $\\mathrm{CMRO2} = 3.0$\n  - $n_{\\mathrm{ATP/O2}} = 5.2$\n  - $N = 1.6 \\times 10^{7}$\n  - $B = 1.0 \\times 10^{-17}$\n  - $C_{\\mathrm{AP}}^{\\mathrm{ATP}} = 3.0 \\times 10^{9}$\n  - $C_{\\mathrm{syn}}^{\\mathrm{ATP}} = 1.0 \\times 10^{6}$\n  - $q = 2000$\n  - $\\phi_e = 0.8$\n  - $n_{\\mathrm{Glu}} = 3000$\n  - $V_{\\mathrm{NT,max}} = 0.010$\n- Case $4$ (high synaptic burden):\n  - $\\mathrm{CMRO2} = 1.8$\n  - $n_{\\mathrm{ATP/O2}} = 5.2$\n  - $N = 1.6 \\times 10^{7}$\n  - $B = 1.0 \\times 10^{-17}$\n  - $C_{\\mathrm{AP}}^{\\mathrm{ATP}} = 3.0 \\times 10^{9}$\n  - $C_{\\mathrm{syn}}^{\\mathrm{ATP}} = 1.0 \\times 10^{6}$\n  - $q = 5000$\n  - $\\phi_e = 0.8$\n  - $n_{\\mathrm{Glu}} = 3000$\n  - $V_{\\mathrm{NT,max}} = 0.30$\n- Case $5$ (edge, anoxic limit):\n  - $\\mathrm{CMRO2} = 0.0$\n  - $n_{\\mathrm{ATP/O2}} = 5.2$\n  - $N = 1.6 \\times 10^{7}$\n  - $B = 1.0 \\times 10^{-17}$\n  - $C_{\\mathrm{AP}}^{\\mathrm{ATP}} = 3.0 \\times 10^{9}$\n  - $C_{\\mathrm{syn}}^{\\mathrm{ATP}} = 1.0 \\times 10^{6}$\n  - $q = 2000$\n  - $\\phi_e = 0.8$\n  - $n_{\\mathrm{Glu}} = 3000$\n  - $V_{\\mathrm{NT,max}} = 0.30$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the exact order of the cases (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the maximum sustainable firing rate in $\\mathrm{Hz}$ rounded to six decimal places.", "solution": "The problem statement is evaluated for validity according to the specified protocol.\n\n### Step 1: Extract Givens\nThe following data, variables, and conditions have been extracted verbatim from the problem statement:\n- **Variables and Definitions**:\n  - $\\mathrm{CMRO2}$: oxygen consumption in $\\mathrm{\\mu mol\\ O_2\\ g^{-1}\\ min^{-1}}$.\n  - $n_{\\mathrm{ATP/O2}}$: dimensionless ATP yield per oxygen molecule.\n  - $N$: neurons per gram in $\\mathrm{neurons\\ g^{-1}}$.\n  - $B$: basal ATP demand per neuron in $\\mathrm{mol\\ ATP\\ s^{-1}\\ neuron^{-1}}$.\n  - $C_{\\mathrm{AP}}^{\\mathrm{ATP}}$: ATP molecules per action potential (spike) per neuron.\n  - $C_{\\mathrm{syn}}^{\\mathrm{ATP}}$: ATP molecules per synaptic event.\n  - $q$: average synaptic events per spike per neuron (dimensionless).\n  - $\\phi_e$: fraction of synaptic events that are excitatory (dimensionless in $[0,1]$).\n  - $n_{\\mathrm{Glu}}$: glutamate molecules per excitatory vesicle (dimensionless count).\n  - $V_{\\mathrm{NT,max}}$: maximum neurotransmitter (NT) cycling capacity in $\\mathrm{\\mu mol\\ g^{-1}\\ min^{-1}}$.\n- **Constants**:\n  - $N_A$: Avogadro constant (molecules per mole).\n- **Fundamental Principles**:\n  - Oxidative phosphorylation converts oxygen to ATP with yield $n_{\\mathrm{ATP/O2}}$.\n  - Total ATP supply per unit mass is derived from oxygen consumption.\n  - Total ATP demand per unit mass is the sum of basal and signaling terms.\n  - Neurotransmitter cycling capacity imposes an independent upper bound on synaptic throughput.\n- **Objective**:\n  - Derive and compute the maximum sustainable population-averaged firing rate $r_{\\max}$ (in hertz) that satisfies both an energy-supply constraint and a neurotransmitter-cycling constraint.\n- **Requirements**:\n  - Convert all molecule counts to moles using $N_A$.\n  - Convert all rates from $\\mathrm{\\mu mol\\ g^{-1}\\, min^{-1}}$ to $\\mathrm{mol\\, g^{-1}\\, s^{-1}}$.\n  - The final rate $r_{\\max}$ must be non-negative.\n  - The final firing rate must be expressed in $\\mathrm{Hz}$, rounded to six decimal places.\n- **Test Cases**: Five sets of parameters are provided for computation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria:\n- **Scientifically Grounded**: The problem is based on the established principles of cerebral energy metabolism, specifically the energy budget model of neuronal activity. The concepts of $\\mathrm{CMRO2}$, ATP yield from oxygen (P/O ratio), basal versus activity-dependent energy costs, and neurotransmitter cycling are central to quantitative neuroscience. The model is a well-accepted simplification for estimating metabolic constraints. All specified parameters represent real, measurable biophysical quantities, and their given values fall within scientifically plausible ranges for mammalian cortical tissue. The problem is scientifically sound and free of pseudoscience.\n- **Well-Posed**: The problem is structured to find a maximum firing rate $r_{\\max}$ subject to two independent inequality constraints. The derived constraints are linear functions of the firing rate $r$, leading to a well-defined maximum value given by the minimum of the limits imposed by each constraint. A unique, stable, and meaningful solution exists for any non-negative set of input parameters.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. It relies on mathematical relationships and established physical constants, not subjective claims.\n\nThe problem does not exhibit any of the listed invalidity flaws. It is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, or ill-posed. Therefore, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived and presented.\n\n### Derivation of the Maximum Sustainable Firing Rate\nThe maximum sustainable firing rate, $r_{\\max}$, is constrained by two independent physiological limits: the rate of energy (ATP) supply and the rate of neurotransmitter (glutamate) cycling. The true maximum rate is the lower of the two limits. We will derive the maximum rate allowed by each constraint, $r_{\\mathrm{energy}}$ and $r_{\\mathrm{NT}}$, and then find $r_{\\max} = \\min(r_{\\mathrm{energy}}, r_{\\mathrm{NT}})$. All calculations will be performed in base SI units where appropriate (e.g., $\\mathrm{mol\\, g^{-1}\\, s^{-1}}$). The Avogadro constant, $N_A$, is approximately $6.02214076 \\times 10^{23} \\mathrm{mol}^{-1}$.\n\nFirst, we establish the conversion factor for rates given in $\\mathrm{\\mu mol\\, g^{-1}\\, min^{-1}}$ to $\\mathrm{mol\\, g^{-1}\\, s^{-1}}$:\n$$ 1\\, \\frac{\\mathrm{\\mu mol}}{\\mathrm{g \\cdot min}} = 1 \\times \\frac{10^{-6}\\, \\mathrm{mol}}{1\\, \\mathrm{\\mu mol}} \\times \\frac{1\\, \\mathrm{min}}{60\\, \\mathrm{s}} = \\frac{1}{60 \\times 10^6}\\, \\frac{\\mathrm{mol}}{\\mathrm{g \\cdot s}} $$\n\n**1. Energy Supply Constraint**\n\nAt steady state, the rate of ATP supply must be greater than or equal to the rate of ATP demand.\n$$ P_{\\mathrm{ATP, supply}} \\ge P_{\\mathrm{ATP, demand}} $$\n\nThe total ATP supply rate, $P_{\\mathrm{ATP, supply}}$, is derived from the cerebral metabolic rate of oxygen ($\\mathrm{CMRO2}$). Note that the stoichiometric yield $n_{\\mathrm{ATP/O2}}$ applies to molecules as well as moles.\n$$ P_{\\mathrm{ATP, supply}} \\left[\\frac{\\mathrm{mol\\, ATP}}{\\mathrm{g \\cdot s}}\\right] = \\mathrm{CMRO2} \\left[\\frac{\\mathrm{\\mu mol\\, O_2}}{\\mathrm{g \\cdot min}}\\right] \\times n_{\\mathrm{ATP/O2}} \\times \\frac{1}{60 \\times 10^6} $$\n\nThe total ATP demand, $P_{\\mathrm{ATP, demand}}$, is the sum of a basal (housekeeping) component and an activity-dependent component that scales with firing rate $r$ (in $\\mathrm{Hz}$ or $\\mathrm{s}^{-1}$).\n$$ P_{\\mathrm{ATP, demand}}(r) = P_{\\mathrm{ATP, basal}} + P_{\\mathrm{ATP, activity}}(r) $$\n\nThe basal demand for $N$ neurons per gram is:\n$$ P_{\\mathrm{ATP, basal}} \\left[\\frac{\\mathrm{mol\\, ATP}}{\\mathrm{g \\cdot s}}\\right] = N \\left[\\frac{\\mathrm{neurons}}{\\mathrm{g}}\\right] \\times B \\left[\\frac{\\mathrm{mol\\, ATP}}{\\mathrm{s \\cdot neuron}}\\right] $$\n\nThe activity-dependent demand consists of costs for action potentials ($C_{\\mathrm{AP}}^{\\mathrm{ATP}}$) and synaptic events ($C_{\\mathrm{syn}}^{\\mathrm{ATP}}$). The cost per spike per neuron, in moles of ATP, is the sum of the AP cost and the total synaptic cost, where there are $q$ synaptic events per spike.\n$$ C_{\\mathrm{spike}}^{\\mathrm{ATP}} \\left[\\frac{\\mathrm{mol\\, ATP}}{\\mathrm{spike \\cdot neuron}}\\right] = \\frac{C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q \\cdot C_{\\mathrm{syn}}^{\\mathrm{ATP}}}{N_A} $$\nThe total activity-dependent demand for $N$ neurons firing at an average rate $r$ is:\n$$ P_{\\mathrm{ATP, activity}}(r) \\left[\\frac{\\mathrm{mol\\, ATP}}{\\mathrm{g \\cdot s}}\\right] = N \\left[\\frac{\\mathrm{neurons}}{\\mathrm{g}}\\right] \\times r \\left[\\frac{\\mathrm{spikes}}{\\mathrm{s}}\\right] \\times C_{\\mathrm{spike}}^{\\mathrm{ATP}} \\left[\\frac{\\mathrm{mol\\, ATP}}{\\mathrm{spike \\cdot neuron}}\\right] $$\n$$ P_{\\mathrm{ATP, activity}}(r) = N \\cdot r \\cdot \\frac{C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q \\cdot C_{\\mathrm{syn}}^{\\mathrm{ATP}}}{N_A} $$\n\nThe energy balance inequality is:\n$$ \\frac{\\mathrm{CMRO2} \\cdot n_{\\mathrm{ATP/O2}}}{60 \\times 10^6} \\ge N \\cdot B + \\frac{N \\cdot r \\cdot (C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q \\cdot C_{\\mathrm{syn}}^{\\mathrm{ATP}})}{N_A} $$\nTo find the maximum rate $r_{\\mathrm{energy}}$, we solve for $r$ at equality. The ATP available for activity is the total supply minus basal demand, $\\Delta P_{\\mathrm{ATP}} = P_{\\mathrm{ATP, supply}} - P_{\\mathrm{ATP, basal}}$.\n$$ \\Delta P_{\\mathrm{ATP}} = \\frac{N \\cdot r_{\\mathrm{energy}} \\cdot (C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q \\cdot C_{\\mathrm{syn}}^{\\mathrm{ATP}})}{N_A} $$\n$$ r_{\\mathrm{energy}} = \\frac{\\Delta P_{\\mathrm{ATP}} \\cdot N_A}{N \\cdot (C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q \\cdot C_{\\mathrm{syn}}^{\\mathrm{ATP}})} = \\frac{N_A}{N \\cdot (C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q \\cdot C_{\\mathrm{syn}}^{\\mathrm{ATP}})} \\left( \\frac{\\mathrm{CMRO2} \\cdot n_{\\mathrm{ATP/O2}}}{60 \\times 10^6} - N \\cdot B \\right) $$\nSince the firing rate cannot be negative, if the basal demand exceeds the supply ($\\Delta P_{\\mathrm{ATP}}  0$), the activity-driven rate must be $0$.\n$$ r_{\\mathrm{energy}} = \\max\\left(0, \\frac{N_A}{N(C_{\\mathrm{AP}}^{\\mathrm{ATP}} + q C_{\\mathrm{syn}}^{\\mathrm{ATP}})} \\left( \\frac{\\mathrm{CMRO2} \\cdot n_{\\mathrm{ATP/O2}}}{60 \\times 10^6} - NB \\right)\\right) $$\n\n**2. Neurotransmitter Cycling Constraint**\n\nThe rate of glutamate release at excitatory synapses cannot exceed the maximum neurotransmitter cycling capacity, $V_{\\mathrm{NT,max}}$.\nThe demand for glutamate, $J_{\\mathrm{Glu}}(r)$, depends on the rate of excitatory synaptic events.\n$$ J_{\\mathrm{Glu}}(r) \\left[\\frac{\\mathrm{mol\\, Glu}}{\\mathrm{g \\cdot s}}\\right] = \\frac{N \\cdot r \\cdot q \\cdot \\phi_e \\cdot n_{\\mathrm{Glu}}}{N_A} $$\nThe maximum supply rate of glutamate, $J_{\\mathrm{Glu,max}}$, is given by $V_{\\mathrm{NT,max}}$ after unit conversion.\n$$ J_{\\mathrm{Glu,max}} \\left[\\frac{\\mathrm{mol\\, Glu}}{\\mathrm{g \\cdot s}}\\right] = V_{\\mathrm{NT,max}} \\left[\\frac{\\mathrm{\\mu mol}}{\\mathrm{g \\cdot min}}\\right] \\times \\frac{1}{60 \\times 10^6} $$\nThe constraint is $J_{\\mathrm{Glu}}(r) \\le J_{\\mathrm{Glu,max}}$. To find the maximum rate $r_{\\mathrm{NT}}$, we solve for $r$ at equality:\n$$ \\frac{N \\cdot r_{\\mathrm{NT}} \\cdot q \\cdot \\phi_e \\cdot n_{\\mathrm{Glu}}}{N_A} = \\frac{V_{\\mathrm{NT,max}}}{60 \\times 10^6} $$\n$$ r_{\\mathrm{NT}} = \\frac{N_A \\cdot V_{\\mathrm{NT,max}}}{60 \\times 10^6 \\cdot N \\cdot q \\cdot \\phi_e \\cdot n_{\\mathrm{Glu}}} $$\n\n**3. Final Maximum Sustainable Firing Rate**\n\nThe overall maximum sustainable firing rate, $r_{\\max}$, must satisfy both constraints simultaneously. It is therefore the minimum of the rates permitted by each individual constraint.\n$$ r_{\\max} = \\min(r_{\\mathrm{energy}}, r_{\\mathrm{NT}}) $$\nThis value will be computed for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other special libraries are needed beyond the Python standard library.\n\ndef solve():\n    \"\"\"\n    Computes the maximum sustainable firing rate for cortical neurons based on\n    energy supply and neurotransmitter cycling constraints.\n    \"\"\"\n    # Avogadro constant (molecules per mole)\n    NA = 6.02214076e23\n\n    # Conversion factor from umol/g/min to mol/g/s\n    RATE_CONV_FACTOR = 1.0 / (60.0 * 1e6)\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (CMRO2, n_ATP_O2, N, B, C_AP_ATP, C_syn_ATP, q, phi_e, n_Glu, V_NT_max)\n    test_cases = [\n        # Case 1 (baseline, happy path)\n        (1.8, 5.2, 1.6e7, 1.0e-17, 3.0e9, 1.0e6, 2000, 0.8, 3000, 0.30),\n        # Case 2 (boundary, oxygen supply equals basal demand)\n        (1.846153846e-3, 5.2, 1.6e7, 1.0e-17, 3.0e9, 1.0e6, 2000, 0.8, 3000, 0.30),\n        # Case 3 (high oxygen, neurotransmitter cycling limited)\n        (3.0, 5.2, 1.6e7, 1.0e-17, 3.0e9, 1.0e6, 2000, 0.8, 3000, 0.010),\n        # Case 4 (high synaptic burden)\n        (1.8, 5.2, 1.6e7, 1.0e-17, 3.0e9, 1.0e6, 5000, 0.8, 3000, 0.30),\n        # Case 5 (edge, anoxic limit)\n        (0.0, 5.2, 1.6e7, 1.0e-17, 3.0e9, 1.0e6, 2000, 0.8, 3000, 0.30),\n    ]\n\n    results = []\n    for case in test_cases:\n        cmro2, n_atp_o2, N, B, c_ap_atp, c_syn_atp, q, phi_e, n_glu, v_nt_max = case\n\n        # 1. Calculate the maximum firing rate based on the energy constraint (r_energy)\n        \n        # ATP supply rate in mol/g/s\n        p_atp_supply = cmro2 * n_atp_o2 * RATE_CONV_FACTOR\n        \n        # Basal ATP demand rate in mol/g/s\n        p_atp_basal = N * B\n        \n        # ATP available for activity\n        delta_p_atp = p_atp_supply - p_atp_basal\n        \n        r_energy = 0.0\n        if delta_p_atp > 0:\n            # Total ATP cost in molecules per spike per neuron\n            activity_cost_per_spike_molecules = c_ap_atp + q * c_syn_atp\n            \n            # Numerator of the r_energy formula\n            numerator_energy = delta_p_atp * NA\n            \n            # Denominator of the r_energy formula\n            denominator_energy = N * activity_cost_per_spike_molecules\n            \n            if denominator_energy > 0:\n                r_energy = numerator_energy / denominator_energy\n\n        # 2. Calculate the maximum firing rate based on the neurotransmitter cycling constraint (r_nt)\n\n        # Numerator of the r_nt formula\n        numerator_nt = NA * v_nt_max\n        \n        # Denominator of the r_nt formula, including the rate conversion factor\n        denominator_nt = (60.0 * 1e6) * N * q * phi_e * n_glu\n        \n        r_nt = 0.0\n        if denominator_nt > 0:\n            r_nt = numerator_nt / denominator_nt\n\n        # 3. The overall maximum sustainable rate is the minimum of the two constraints\n        r_max = min(r_energy, r_nt)\n        \n        # Append the formatted result\n        results.append(f\"{r_max:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4507822"}]}