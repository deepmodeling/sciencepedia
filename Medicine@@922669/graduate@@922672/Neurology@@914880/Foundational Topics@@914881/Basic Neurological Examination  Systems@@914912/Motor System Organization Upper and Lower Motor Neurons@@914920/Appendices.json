{"hands_on_practices": [{"introduction": "Before exploring complex motor commands, it is essential to understand the fundamental speed limits of the nervous system. This exercise challenges you to calculate the total latency of the patellar tendon reflex, a classic monosynaptic circuit, by summing the delays from sensory input to muscle output. By working through this problem [@problem_id:4498323], you will gain a quantitative appreciation for the biophysical constraints that govern even the simplest of our movements.", "problem": "A monosynaptic stretch reflex underlying the patellar tendon (knee-jerk) is mediated by a group $I_a$ afferent from the quadriceps muscle spindle that synapses directly onto a spinal lower motor neuron (alpha motor neuron) whose axon returns to the quadriceps. Upper motor neurons (corticospinal tract) can modulate the reflex, but they do not add required synaptic steps in the monosynaptic arc and are ignored for latency estimation. Starting from the definitions that conduction time equals distance divided by conduction velocity and that total reflex latency is the sum of all sequential delays along the arc, derive and compute the expected latency from the instant of patellar tendon tap to the onset of quadriceps contraction.\n\nAssume the following experimentally supported, physiologically plausible parameters for an adult:\n- The reflex arc consists of a group $I_a$ afferent with conduction velocity $v_{a} = 80 \\ \\mathrm{m/s}$ and an alpha lower motor neuron efferent with conduction velocity $v_{e} = 60 \\ \\mathrm{m/s}$.\n- The total peripheral axonal path length (afferent plus efferent) is $L_{\\mathrm{total}} = 1 \\ \\mathrm{m}$, with equal segment lengths so $L_{a} = 0.5 \\ \\mathrm{m}$ and $L_{e} = 0.5 \\ \\mathrm{m}$.\n- The central synaptic delay at the monosynaptic connection in the spinal cord is $t_{\\mathrm{syn}} = 0.5 \\ \\mathrm{ms}$.\n- The neuromuscular junction synaptic delay is $t_{\\mathrm{NMJ}} = 0.5 \\ \\mathrm{ms}$.\n- The excitation–contraction coupling time (from end-plate depolarization to detectable force onset in the quadriceps) is $t_{\\mathrm{EC}} = 15 \\ \\mathrm{ms}$.\n- The mechanical delay from tendon tap to muscle spindle activation is modeled as $t_{\\mathrm{mech}} = 1 \\ \\mathrm{ms}$.\n\nUsing only the fundamental definitions above and without invoking any additional shortcut formulas, compute the expected total latency from tap to mechanical contraction onset. Express your final answer in milliseconds and round your answer to four significant figures.", "solution": "The knee-jerk latency can be decomposed into sequential delays that follow from the organization of the monosynaptic reflex arc involving lower motor neurons and their afferent inputs. The foundational relationships we use are:\n\n1. Conduction time along a fiber equals distance divided by conduction velocity, i.e., if an action potential travels a distance $L$ at velocity $v$, then the time is\n$$\nt = \\frac{L}{v}.\n$$\n\n2. Total latency for a sequence of events in series is the sum of the component delays, so if events with durations $t_{1}, t_{2}, \\ldots, t_{n}$ occur sequentially, then the total duration is\n$$\nt_{\\mathrm{total}} = \\sum_{i=1}^{n} t_{i}.\n$$\n\nWe next itemize the components of the knee-jerk reflex latency:\n\n- Afferent conduction from the quadriceps muscle spindle to the spinal cord over distance $L_{a} = 0.5 \\ \\mathrm{m}$ at velocity $v_{a} = 80 \\ \\mathrm{m/s}$. The afferent conduction time is\n$$\nt_{a} = \\frac{L_{a}}{v_{a}} = \\frac{0.5 \\ \\mathrm{m}}{80 \\ \\mathrm{m/s}} = 0.00625 \\ \\mathrm{s} = 6.25 \\ \\mathrm{ms}.\n$$\n\n- Central synaptic delay at the monosynaptic connection is given as\n$$\nt_{\\mathrm{syn}} = 0.5 \\ \\mathrm{ms}.\n$$\n\n- Efferent conduction along the alpha lower motor neuron axon from spinal cord to quadriceps over $L_{e} = 0.5 \\ \\mathrm{m}$ at $v_{e} = 60 \\ \\mathrm{m/s}$:\n$$\nt_{e} = \\frac{L_{e}}{v_{e}} = \\frac{0.5 \\ \\mathrm{m}}{60 \\ \\mathrm{m/s}} = \\frac{1}{120} \\ \\mathrm{s} \\approx 0.008333\\ldots \\ \\mathrm{s} = 8.333\\ldots \\ \\mathrm{ms}.\n$$\n\n- Neuromuscular junction synaptic delay is given as\n$$\nt_{\\mathrm{NMJ}} = 0.5 \\ \\mathrm{ms}.\n$$\n\n- Excitation–contraction coupling time to detectable force onset is\n$$\nt_{\\mathrm{EC}} = 15 \\ \\mathrm{ms}.\n$$\n\n- Mechanical delay from tendon tap to muscle spindle activation is\n$$\nt_{\\mathrm{mech}} = 1 \\ \\mathrm{ms}.\n$$\n\nSumming these contributions yields the total latency:\n$$\nt_{\\mathrm{total}} = t_{\\mathrm{mech}} + t_{a} + t_{\\mathrm{syn}} + t_{e} + t_{\\mathrm{NMJ}} + t_{\\mathrm{EC}}.\n$$\nSubstituting numerical values (keeping all times in milliseconds) gives\n$$\nt_{\\mathrm{total}} = 1 \\ \\mathrm{ms} + 6.25 \\ \\mathrm{ms} + 0.5 \\ \\mathrm{ms} + 8.333\\ldots \\ \\mathrm{ms} + 0.5 \\ \\mathrm{ms} + 15 \\ \\mathrm{ms}.\n$$\nCompute the sum stepwise:\n$$\n1 + 6.25 = 7.25,\n$$\n$$\n7.25 + 0.5 = 7.75,\n$$\n$$\n7.75 + 8.333\\ldots = 16.083\\ldots,\n$$\n$$\n16.083\\ldots + 0.5 = 16.583\\ldots,\n$$\n$$\n16.583\\ldots + 15 = 31.583\\ldots.\n$$\nThus,\n$$\nt_{\\mathrm{total}} \\approx 31.583\\ldots \\ \\mathrm{ms}.\n$$\n\nRounding to four significant figures as instructed yields\n$$\nt_{\\mathrm{total}} = 31.58 \\ \\mathrm{ms}.\n$$\n\nThis value is consistent with established measurements for mechanical onset latency of the patellar reflex in healthy adults, reflecting the organization of the lower motor neuron pathway and its afferent input, while upper motor neuron influences are modulatory rather than obligatory for the monosynaptic conduction and synaptic steps contributing to latency.", "answer": "$$\\boxed{31.58}$$", "id": "4498323"}, {"introduction": "A single lower motor neuron (LMN) and its muscle fibers can only produce a fixed twitch force, so how does the nervous system generate a smooth and vast range of forces for different tasks? This practice [@problem_id:4498374] guides you through a computational model of an LMN pool to explore the answer. You will implement Henneman's size principle and rate coding to simulate how increasing drive from upper motor neurons (UMNs) systematically recruits more units and increases their firing rates to build force.", "problem": "You are given a mathematically specified model of a Lower Motor Neuron (LMN) pool innervating a single muscle. The LMN pool receives a common synaptic drive originating from Upper Motor Neurons (UMN). Recruitment follows Henneman’s size principle: units with lower recruitment threshold activate before higher-threshold units as common drive increases. Each recruited LMN generates a spike train with a rate that increases with synaptic drive, and each spike elicits a twitch force response that linearly superposes in time. The goal is to compute the instantaneous total muscle force at a specified time from first principles and quantify how increasing common synaptic drive changes the composition of active motor units (slow versus fast).\n\nFundamental base:\n- LMNs produce spike trains in response to synaptic input; the instantaneous firing rate increases monotonically with effective drive above threshold.\n- Twitch forces from individual motor unit action potentials superpose linearly in the muscle.\n- Henneman’s size principle: recruitment is ordered by threshold, with slow units generally having lower thresholds than fast units.\n\nModel specification:\n- There are $M=10$ motor units indexed by $i \\in \\{1,\\dots,10\\}$, with $i \\in \\{1,\\dots,6\\}$ classified as slow (type S) and $i \\in \\{7,\\dots,10\\}$ classified as fast (type F).\n- Each unit $i$ has a recruitment threshold $\\,\\theta_i\\,$ (dimensionless), a twitch amplitude $\\,A_i\\,$ (in Newtons), and a twitch time constant $\\,\\tau_i\\,$ (in seconds).\n- Each unit $i$ has a minimal firing rate $\\,r^{\\min}_i\\,$ (in Hertz), a maximal firing rate $\\,r^{\\max}_i\\,$ (in Hertz), and a gain $\\,k_i\\,$ (in Hertz per unit drive). When the common drive $\\,u(t)\\,$ is at a plateau $\\,U\\,$ (dimensionless) from time $\\,t=t_{\\mathrm{step}}\\,$ onward, the stationary firing rate for a recruited unit is modeled as\n$$\nr_i(U)=\\min\\left(r^{\\max}_i,\\;r^{\\min}_i+k_i\\,(U-\\theta_i)\\right)\\quad\\text{for}\\quad U\\ge \\theta_i,\n$$\nand the unit is not recruited (produces zero spikes) if $\\,U<\\theta_i$.\n- Each spike of unit $i$ at time $\\,s\\,$ produces a twitch force given by the causal alpha-function\n$$\nh_i(t-s)=\n\\begin{cases}\nA_i\\,\\dfrac{t-s}{\\tau_i}\\,e^{-\\frac{t-s}{\\tau_i}}, & t\\ge s, \\\\[6pt]\n0, & t<s,\n\\end{cases}\n$$\nso that individual twitches sum linearly in the instantaneous total force.\n- The common synaptic drive is a step function: $\\,u(t)=0\\,$ for $\\,t<t_{\\mathrm{step}}\\,$ and $\\,u(t)=U\\,$ for $\\,t\\ge t_{\\mathrm{step}}$. All recruited units begin spiking at $\\,t_{\\mathrm{rec},i}=t_{\\mathrm{step}}\\,$ and then fire periodically with interspike interval $\\,1/r_i(U)\\,$. The spike times for unit $i$ are $\\,t_{i,n}=t_{\\mathrm{rec},i}+\\dfrac{n}{r_i(U)}\\,$ for integers $\\,n\\ge 0\\,$ up to a specified observation time $\\,T_{\\mathrm{end}}\\,$.\n\nTotal force definition:\n- The instantaneous total force at time $\\,t\\,$ is defined by linear superposition over all twitches from all spikes that occur at or before $\\,t\\,$:\n$$\nF(t)=\\sum_{i=1}^{M}\\sum_{n:\\,t_{i,n}\\le t} h_i\\!\\bigl(t-t_{i,n}\\bigr).\n$$\n\nPool parameters:\n- For slow units ($i=1$ to $6$):\n  - Thresholds $\\,\\theta_i\\,$: $[0.10,\\,0.15,\\,0.20,\\,0.25,\\,0.30,\\,0.35]$.\n  - Twitch amplitudes $\\,A_i\\,$ in Newtons: $[0.50,\\,0.55,\\,0.60,\\,0.65,\\,0.70,\\,0.75]$.\n  - Twitch time constants $\\,\\tau_i\\,$ in seconds: $[0.090,\\,0.085,\\,0.080,\\,0.075,\\,0.070,\\,0.065]$.\n  - Minimal firing rates $\\,r^{\\min}_i\\,$ in Hertz: $[8,\\,8,\\,8,\\,8,\\,8,\\,8]$.\n  - Maximal firing rates $\\,r^{\\max}_i\\,$ in Hertz: $[25,\\,25,\\,25,\\,25,\\,25,\\,25]$.\n  - Gains $\\,k_i\\,$ in Hertz per unit drive: $[100,\\,100,\\,100,\\,100,\\,100,\\,100]$.\n- For fast units ($i=7$ to $10$):\n  - Thresholds $\\,\\theta_i\\,$: $[0.40,\\,0.50,\\,0.60,\\,0.70]$.\n  - Twitch amplitudes $\\,A_i\\,$ in Newtons: $[1.00,\\,1.20,\\,1.40,\\,1.60]$.\n  - Twitch time constants $\\,\\tau_i\\,$ in seconds: $[0.050,\\,0.045,\\,0.040,\\,0.035]$.\n  - Minimal firing rates $\\,r^{\\min}_i\\,$ in Hertz: $[12,\\,12,\\,12,\\,12]$.\n  - Maximal firing rates $\\,r^{\\max}_i\\,$ in Hertz: $[50,\\,50,\\,50,\\,50]$.\n  - Gains $\\,k_i\\,$ in Hertz per unit drive: $[150,\\,150,\\,150,\\,150]$.\n\nTiming:\n- The step onset time is $\\,t_{\\mathrm{step}}=0.50\\,\\mathrm{s}$.\n- The observation time is $\\,T_{\\mathrm{end}}=1.50\\,\\mathrm{s}$.\n\nTasks:\n1. Using only the fundamental base above, derive an algorithm to compute $\\,F(T_{\\mathrm{end}})\\,$ by explicitly summing twitch responses $\\,h_i\\!\\bigl(T_{\\mathrm{end}}-t_{i,n}\\bigr)\\,$ over all spikes $\\,t_{i,n}\\le T_{\\mathrm{end}}\\,$ for each test case.\n2. For each test case, also compute the composition of the active pool at $\\,T_{\\mathrm{end}}$ as the pair $\\,\\bigl(N_{\\mathrm{S}}(U),\\,N_{\\mathrm{F}}(U)\\bigr)\\,$ where $\\,N_{\\mathrm{S}}(U)\\,$ and $\\,N_{\\mathrm{F}}(U)\\,$ are integers counting the number of recruited slow and fast units, respectively, under plateau $\\,U$.\n3. Express the total force $\\,F(T_{\\mathrm{end}})\\,$ in Newtons, rounded to four decimal places. Express $\\,N_{\\mathrm{S}}(U)\\,$ and $\\,N_{\\mathrm{F}}(U)\\,$ as integers.\n\nTest suite:\n- Consider four plateau values $\\,U\\,$:\n  - Case $1$: $\\,U=0.00$ (no recruitment).\n  - Case $2$: $\\,U=0.32$ (low recruitment among slow units only).\n  - Case $3$: $\\,U=0.55$ (moderate recruitment including some fast units).\n  - Case $4$: $\\,U=0.75$ (high recruitment, near saturation).\n  \nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of the list corresponds to one test case and must itself be a list of the form $[F(T_{\\mathrm{end}}),N_{\\mathrm{S}}(U),N_{\\mathrm{F}}(U)]$. For example, $[[x_1,n_{S,1},n_{F,1}],[x_2,n_{S,2},n_{F,2}],\\dots]$, with each $\\,x_j\\,$ rounded to four decimal places in Newtons and each count an integer.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of motor control, mathematically well-posed, objective, and contains all necessary information to derive a unique solution. The model is a standard, albeit simplified, representation of a lower motor neuron (LMN) pool, incorporating Henneman's size principle, rate modulation, and linear superposition of twitch forces.\n\nThe objective is to compute the total instantaneous muscle force $F(t)$ at a specific observation time $T_{\\mathrm{end}}$, and to quantify the number of active slow-twitch ($N_{\\mathrm{S}}$) and fast-twitch ($N_{\\mathrm{F}}$) motor units for four distinct levels of constant synaptic drive $U$. The synaptic drive $u(t)$ is a step function, being $0$ for $t < t_{\\mathrm{step}}$ and a constant plateau $U$ for $t \\ge t_{\\mathrm{step}}$.\n\nThe algorithm to solve this problem is derived directly from the provided model specifications and fundamental principles. For each given test case, characterized by a plateau drive level $U$, the following computational steps are executed:\n\n1.  **Motor Unit Recruitment and Counting**:\n    The first step is to determine which of the $M=10$ motor units are recruited. According to Henneman's size principle, a motor unit $i$ becomes active if and only if the common drive $U$ meets or exceeds its recruitment threshold $\\theta_i$.\n    $$ \\text{Unit } i \\text{ is recruited if } U \\ge \\theta_i $$\n    We iterate through all units $i=1, \\dots, 10$. For each unit, we check this condition. We maintain two counters, $N_{\\mathrm{S}}(U)$ and $N_{\\mathrm{F}}(U)$, initialized to $0$. If unit $i$ is recruited:\n    - If $i \\in \\{1, \\dots, 6\\}$ (a slow unit), we increment $N_{\\mathrm{S}}(U)$.\n    - If $i \\in \\{7, \\dots, 10\\}$ (a fast unit), we increment $N_{\\mathrm{F}}(U)$.\n    This process yields the composition of the active motor unit pool for the drive level $U$.\n\n2.  **Firing Rate Calculation**:\n    For each unit $i$ that is recruited, we calculate its steady-state firing rate, $r_i(U)$, in Hertz. The problem specifies the relationship as:\n    $$ r_i(U) = \\min\\left(r^{\\max}_i, \\; r^{\\min}_i + k_i(U - \\theta_i)\\right) $$\n    where $r^{\\min}_i$ is the minimal firing rate, $r^{\\max}_i$ is the maximal rate, and $k_i$ is the gain. If a unit is not recruited ($U < \\theta_i$), its firing rate is $0$.\n\n3.  **Spike Train Generation**:\n    All recruited units begin firing at time $t_{\\mathrm{rec},i} = t_{\\mathrm{step}}$. They subsequently fire periodically with an inter-spike interval of $1/r_i(U)$. The time of the $n$-th spike (with $n$ starting from $0$) for unit $i$ is given by:\n    $$ t_{i,n} = t_{\\mathrm{step}} + \\frac{n}{r_i(U)} $$\n    Our goal is to compute the total force at $T_{\\mathrm{end}} = 1.50\\,\\mathrm{s}$. We only need to consider spikes that have occurred at or before this time, i.e., $t_{i,n} \\le T_{\\mathrm{end}}$. This inequality determines the range of spike indices $n$ to be summed over:\n    $$ t_{\\mathrm{step}} + \\frac{n}{r_i(U)} \\le T_{\\mathrm{end}} \\implies n \\le (T_{\\mathrm{end}} - t_{\\mathrm{step}}) \\cdot r_i(U) $$\n    Since $n$ must be an integer, the spikes to consider for each unit $i$ are indexed by $n = 0, 1, 2, \\ldots, n_{\\max,i}$, where $n_{\\max,i} = \\lfloor(T_{\\mathrm{end}} - t_{\\mathrm{step}}) \\cdot r_i(U)\\rfloor$.\n\n4.  **Total Force Calculation by Superposition**:\n    The total muscle force $F(T_{\\mathrm{end}})$ is the linear sum of the twitch force responses from all spikes up to time $T_{\\mathrm{end}}$. The twitch response $h_i(t-s)$ for a spike from unit $i$ at time $s$ is described by a causal alpha-function:\n    $$ h_i(\\Delta t) = A_i \\frac{\\Delta t}{\\tau_i} e^{-\\frac{\\Delta t}{\\tau_i}} \\quad \\text{for} \\quad \\Delta t \\ge 0 $$\n    where $\\Delta t = t-s$ is the time elapsed since the spike, $A_i$ is the twitch amplitude, and $\\tau_i$ is the twitch time constant.\n    \n    The contribution of a single spike from unit $i$ at time $t_{i,n}$ to the total force at time $T_{\\mathrm{end}}$ is $h_i(T_{\\mathrm{end}} - t_{i,n})$. To find the total force, we sum these contributions over all relevant spikes from all recruited motor units:\n    $$ F(T_{\\mathrm{end}}) = \\sum_{i=1}^{M} \\sum_{n: \\, t_{i,n} \\le T_{\\mathrm{end}}} h_i(T_{\\mathrm{end}} - t_{i,n}) $$\n    Using the results from the previous steps, this can be written algorithmically as:\n    $$ F(T_{\\mathrm{end}}) = \\sum_{i \\text{ s.t. } U \\ge \\theta_i} \\left( \\sum_{n=0}^{n_{\\max,i}} A_i \\frac{T_{\\mathrm{end}} - t_{i,n}}{\\tau_i} e^{-\\frac{T_{\\mathrm{end}} - t_{i,n}}{\\tau_i}} \\right) $$\n    The calculation proceeds by initializing a total force variable to $0$ and iterating through each recruited unit $i$. For each such unit, a nested loop iterates from $n=0$ to $n_{\\max,i}$, calculates the force of each twitch at $T_{\\mathrm{end}}$, and adds it to the total.\n\n5.  **Final Output Assembly**:\n    After calculating $F(T_{\\mathrm{end}})$, $N_{\\mathrm{S}}(U)$, and $N_{\\mathrm{F}}(U)$ for a given $U$, the force is rounded to four decimal places. The result for one test case is formatted as a list $[F(T_{\\mathrm{end}}), N_{\\mathrm{S}}(U), N_{\\mathrm{F}}(U)]$. This process is repeated for all specified values of $U$ in the test suite. The final output aggregates these lists into a single list of lists.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes total muscle force and active unit counts for a motor neuron pool model.\n    \"\"\"\n    \n    # Define motor unit parameters using 0-based indexing for 10 units.\n    # Units 0-5 are slow (S), 6-9 are fast (F).\n    \n    # Recruitment thresholds (dimensionless)\n    theta = np.array([0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.50, 0.60, 0.70])\n    \n    # Twitch amplitudes (Newtons)\n    A = np.array([0.50, 0.55, 0.60, 0.65, 0.70, 0.75, 1.00, 1.20, 1.40, 1.60])\n    \n    # Twitch time constants (seconds)\n    tau = np.array([0.090, 0.085, 0.080, 0.075, 0.070, 0.065, 0.050, 0.045, 0.040, 0.035])\n    \n    # Minimal firing rates (Hertz)\n    r_min = np.array([8, 8, 8, 8, 8, 8, 12, 12, 12, 12])\n    \n    # Maximal firing rates (Hertz)\n    r_max = np.array([25, 25, 25, 25, 25, 25, 50, 50, 50, 50])\n    \n    # Firing rate gains (Hertz per unit drive)\n    k = np.array([100, 100, 100, 100, 100, 100, 150, 150, 150, 150])\n\n    # Timing parameters\n    t_step = 0.50  # s\n    T_end = 1.50   # s\n\n    # Test suite: plateau values for common drive U\n    test_cases = [0.00, 0.32, 0.55, 0.75]\n    \n    overall_results = []\n\n    for U in test_cases:\n        total_force = 0.0\n        N_S = 0\n        N_F = 0\n\n        # Iterate through all M=10 motor units\n        for i in range(10):\n            # Step 1: Check for recruitment based on threshold\n            if U >= theta[i]:\n                # Step 2: Count recruited units by type\n                if i < 6:  # Slow units are indexed 0-5\n                    N_S += 1\n                else:      # Fast units are indexed 6-9\n                    N_F += 1\n\n                # Step 3: Calculate the stationary firing rate\n                rate = r_min[i] + k[i] * (U - theta[i])\n                firing_rate = min(r_max[i], rate)\n                \n                # If firing rate is non-positive, no spikes are generated.\n                if firing_rate <= 0:\n                    continue\n\n                # Step 4: Determine the spike times and their contribution to force\n                # Spikes at t_i,n = t_step + n / firing_rate must satisfy t_i,n <= T_end\n                # n <= (T_end - t_step) * firing_rate\n                duration = T_end - t_step\n                max_n = int(np.floor(duration * firing_rate))\n                \n                # Step 5: Sum twitch responses by linear superposition\n                for n in range(max_n + 1):\n                    spike_time = t_step + n / firing_rate\n                    time_since_spike = T_end - spike_time\n                    \n                    # Twitch force h_i(t-s) = A_i * ( (t-s)/tau_i ) * exp( -(t-s)/tau_i )\n                    # This is the alpha-function response.\n                    twitch_force_contribution = A[i] * (time_since_spike / tau[i]) * np.exp(-time_since_spike / tau[i])\n                    total_force += twitch_force_contribution\n\n        # Store the results for the current test case\n        rounded_force = round(total_force, 4)\n        case_result = [rounded_force, N_S, N_F]\n        overall_results.append(case_result)\n\n    # Format the final output string to match the required format `[[f1,s1,f1],[f2,s2,f2],...]`\n    # without extraneous spaces.\n    formatted_results = []\n    for res in overall_results:\n        formatted_results.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4498374"}, {"introduction": "What happens at the cellular level when upper motor neuron (UMN) control over lower motor neurons (LMNs) is lost? This advanced computational exercise [@problem_id:4498365] allows you to simulate the emergence of spasticity, a hallmark of UMN syndrome. By modeling the LMN membrane and the effect of persistent inward currents (PICs), you will investigate how chronic changes in neuromodulation create a state of hyperexcitability, providing a quantitative basis for understanding clinical reflex abnormalities.", "problem": "You are asked to construct a computational model that predicts, from first principles, how chronic upper motor neuron (UMN) lesions alter the excitability of lower motor neurons (LMNs) via upregulation of persistent inward currents (PICs) mediated by monoaminergic neuromodulation, and to use this model to quantify resultant spasticity patterns and reflex hyperexcitability. The setting is a single-compartment LMN membrane obeying a resistive-capacitive equation with an additional voltage-dependent inward current representing the PIC. All calculations must follow a physically and logically consistent framework grounded in core definitions of circuit dynamics and biophysical membrane currents.\n\nDefinitions:\n- Upper motor neuron (UMN) refers to descending motor pathways originating in the brain that modulate spinal circuitry.\n- Lower motor neuron (LMN) refers to spinal alpha motoneurons that innervate skeletal muscle fibers.\n- Persistent inward current (PIC) is a voltage-dependent inward current in LMNs mediated by L-type calcium channels and amplified by monoaminergic neuromodulation (primarily serotonin and norepinephrine).\n- Monoaminergic level is modeled by a scalar $\\;M\\;$ that increases under chronic UMN lesion and scales the PIC conductance and adds a depolarizing bias current.\n\nFundamental base:\n- The LMN membrane is modeled as a single isopotential compartment with capacitance $\\;C\\;$ and leak conductance $\\;g_L\\;$ and leak reversal potential $\\;E_L\\;$. By charge conservation and Ohm’s law, the membrane obeys\n$$\nC \\,\\frac{dV}{dt} \\;=\\; -g_L \\,\\big(V - E_L\\big) \\;+\\; I_{\\mathrm{ext}}(t) \\;+\\; I_{\\mathrm{PIC}}(V; M),\n$$\nwhere $\\;V\\;$ is the membrane voltage, $\\;I_{\\mathrm{ext}}(t)\\;$ is the external synaptic and reflex input current, and $\\;I_{\\mathrm{PIC}}(V; M)\\;$ is the voltage-dependent inward current whose strength depends on $\\;M\\;$.\n- The PIC current is modeled as a sigmoidal activation conductance times a driving force:\n$$\nI_{\\mathrm{PIC}}(V; M) \\;=\\; G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V)\\, \\big(E_{\\mathrm{PIC}} - V\\big),\n$$\nwith monoaminergic gain $\\;G(M) = 1 + \\alpha M\\;$, maximal PIC conductance $\\;g_{\\mathrm{PIC}}\\;$, PIC reversal potential $\\;E_{\\mathrm{PIC}}\\;$, and steady-state activation\n$$\ns_{\\infty}(V) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-\\frac{V - V_{1/2}}{k}\\right)}.\n$$\n- External input is decomposed into a constant synaptic drive $\\;I_{\\mathrm{syn}}\\;$, a depolarizing monoaminergic bias current $\\;I_{\\mathrm{bias}} = b\\,M\\;$, and a velocity-dependent Ia afferent stretch input modeled as $\\;I_{\\mathrm{Ia}} = k_{\\mathrm{Ia}}\\, v\\;$, where $\\;v\\;$ is muscle stretch velocity.\n- Spiking is modeled by a threshold-reset mechanism. When $\\;V\\;$ reaches threshold $\\;V_{\\mathrm{th}}\\;$, a spike is emitted and $\\;V\\;$ is reset to $\\;V_{\\mathrm{reset}}\\;$ and held for an absolute refractory period $\\;t_{\\mathrm{ref}}\\;$ before continuing.\n\nRequired computations:\n1. For a specified triplet of parameters $\\;(M, I_{\\mathrm{syn}}, v)\\;$, compute the steady firing rate in hertz (Hz) by integrating the membrane trajectory from $\\;V_{\\mathrm{reset}}\\;$ to $\\;V_{\\mathrm{th}}\\;$ under constant input $\\;I_{\\mathrm{ext}} = I_{\\mathrm{syn}} + I_{\\mathrm{bias}} + I_{\\mathrm{Ia}}\\;$. Specifically, the interspike interval $\\;T\\;$ must be obtained from the first principles definition\n$$\nT \\;=\\; \\int_{V_{\\mathrm{reset}}}^{V_{\\mathrm{th}}} \\frac{C \\, dV}{-g_L (V - E_L) + I_{\\mathrm{syn}} + bM + k_{\\mathrm{Ia}} v + G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V)\\, (E_{\\mathrm{PIC}} - V)} \\;+\\; t_{\\mathrm{ref}},\n$$\nwith the understanding that if the net drift becomes nonpositive anywhere on $\\;[V_{\\mathrm{reset}}, V_{\\mathrm{th}}]\\;$ then the neuron does not fire and the firing rate is defined to be $\\;0\\;$.\n2. For the same parameters, compute the minimal stretch velocity $\\;v_{\\mathrm{thresh}}\\;$ in $\\;\\mathrm{m/s}\\;$ required to just reach threshold. For a minimal crossing condition at threshold, enforce zero net drift at $\\;V_{\\mathrm{th}}\\;$ and solve for $\\;v\\;$:\n$$\nv_{\\mathrm{thresh}} \\;=\\; \\max\\!\\left(0,\\; \\frac{g_L \\big(V_{\\mathrm{th}} - E_L\\big) - I_{\\mathrm{syn}} - bM - G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V_{\\mathrm{th}})\\, \\big(E_{\\mathrm{PIC}} - V_{\\mathrm{th}}\\big)}{k_{\\mathrm{Ia}}}\\right).\n$$\n3. Define a spasticity index as the ratio of the firing rate at the specified $\\;v\\;$ to the threshold velocity:\n$$\n\\mathrm{SI} \\;=\\; \\frac{r}{v_{\\mathrm{thresh}}}.\n$$\nIf $\\;v_{\\mathrm{thresh}} = 0\\;$, cap $\\;\\mathrm{SI}\\;$ at $\\;10^9\\;$ to avoid divergence.\n\nPhysical units and constants:\n- Use $\\;C = 1.0\\;$ nanofarads ($\\mathrm{nF}$), $\\;g_L = 0.02\\;$ microsiemens ($\\mu\\mathrm{S}$), $\\;E_L = -65\\;$ millivolts ($\\mathrm{mV}$), $\\;V_{\\mathrm{th}} = -50\\;$ $\\mathrm{mV}$, $\\;V_{\\mathrm{reset}} = -55\\;$ $\\mathrm{mV}$, $\\;E_{\\mathrm{PIC}} = 120\\;$ $\\mathrm{mV}$, $\\;g_{\\mathrm{PIC}} = 0.0002\\;$ $\\mu\\mathrm{S}$, $\\;V_{1/2} = -60\\;$ $\\mathrm{mV}$, $\\;k = 4\\;$ $\\mathrm{mV}$, monoaminergic gain slope $\\;\\alpha = 1.5\\;$ (dimensionless), bias coefficient $\\;b = 0.02\\;$ nanoamperes per unit $\\;M\\;$ ($\\mathrm{nA}$), Ia input gain $\\;k_{\\mathrm{Ia}} = 0.3\\;$ $\\mathrm{nA}/(\\mathrm{m/s})$, and absolute refractory period $\\;t_{\\mathrm{ref}} = 5\\;$ milliseconds ($\\mathrm{ms}$). Note that using $\\;\\mu\\mathrm{S}\\;$ and $\\;\\mathrm{mV}\\;$ yields currents in $\\;\\mathrm{nA}\\;$, and $\\;C\\;$ in $\\;\\mathrm{nF}\\;$ ensures that the integral for time is in $\\;\\mathrm{ms}\\;$; convert to seconds when computing rates in hertz.\n\nTest suite:\nProvide five test cases as ordered triplets $\\;(M, I_{\\mathrm{syn}}, v)\\;$ in the units specified above:\n- Case $1$: $\\;(M = 0.2,\\; I_{\\mathrm{syn}} = 0.2\\; \\mathrm{nA},\\; v = 0.3\\; \\mathrm{m/s})$.\n- Case $2$: $\\;(M = 1.0,\\; I_{\\mathrm{syn}} = 0.2\\; \\mathrm{nA},\\; v = 0.3\\; \\mathrm{m/s})$.\n- Case $3$: $\\;(M = 0.0,\\; I_{\\mathrm{syn}} = 0.1\\; \\mathrm{nA},\\; v = 0.3\\; \\mathrm{m/s})$.\n- Case $4$: $\\;(M = 2.0,\\; I_{\\mathrm{syn}} = 0.15\\; \\mathrm{nA},\\; v = 0.1\\; \\mathrm{m/s})$.\n- Case $5$: $\\;(M = 1.5,\\; I_{\\mathrm{syn}} = -0.05\\; \\mathrm{nA},\\; v = 0.3\\; \\mathrm{m/s})$.\n\nAnswer specification:\n- For each test case, compute three quantities: the firing rate in $\\;\\mathrm{Hz}\\;$ as a float, the threshold velocity $\\;v_{\\mathrm{thresh}}\\;$ in $\\;\\mathrm{m/s}\\;$ as a float, and the spasticity index $\\;\\mathrm{SI}\\;$ as a float. Express each float rounded to three decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a list of lists, one inner list per test case in the same order as above. Each inner list must be the three rounded floats in the order $\\;[r\\;(\\mathrm{Hz}),\\; v_{\\mathrm{thresh}}\\;(\\mathrm{m/s}),\\; \\mathrm{SI}]\\;$, and the outer list must enclose all five inner lists. For example, the printed structure must look like $\\;[[x_1,y_1,z_1],[x_2,y_2,z_2],\\ldots,[x_5,y_5,z_5]]\\;$ with no extra text.", "solution": "We build the computational solution from first principles. The LMN is modeled as a resistive-capacitive element with a leak and an additional voltage-dependent inward current representing the persistent inward current (PIC), modulated by monoamines.\n\nPrinciples:\n1. By capacitance law, accumulation of charge on a capacitor obeys $\\;C \\, dV/dt = I_{\\mathrm{net}}\\;$. The net current is the sum of leak, external inputs, and PIC.\n2. Ohm’s law at the membrane gives the leak current $\\;I_L = -g_L (V - E_L)\\;$.\n3. The PIC is modeled as a conductance with steady-state activation $\\;s_{\\infty}(V)\\;$ and driving force $\\;(E_{\\mathrm{PIC}} - V)\\;$, scaled by monoaminergic gain $\\;G(M) = 1 + \\alpha M\\;$, so\n$$\nI_{\\mathrm{PIC}}(V; M) = G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V)\\, (E_{\\mathrm{PIC}} - V),\n$$\nwith $\\;s_{\\infty}(V) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{V - V_{1/2}}{k}\\right)}\\;$.\n4. External inputs include a constant synaptic drive $\\;I_{\\mathrm{syn}}\\;$, a monoaminergic bias $\\;I_{\\mathrm{bias}} = bM\\;$, and Ia input $\\;I_{\\mathrm{Ia}} = k_{\\mathrm{Ia}}\\, v\\;$ for muscle stretch velocity $\\;v\\;$.\n\nThus the voltage dynamics are\n$$\n\\frac{dV}{dt} = \\frac{-g_L (V - E_L) + I_{\\mathrm{syn}} + bM + k_{\\mathrm{Ia}} v + G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V)\\, (E_{\\mathrm{PIC}} - V)}{C}.\n$$\n\nFiring rate computation:\n- Under constant input parameters $\\;(M, I_{\\mathrm{syn}}, v)\\;$, the interspike interval $\\;T\\;$, excluding refractory effects, is the time for $\\;V\\;$ to evolve from $\\;V_{\\mathrm{reset}}\\;$ to $\\;V_{\\mathrm{th}}\\;$:\n$$\nT_{\\mathrm{drift}} = \\int_{V_{\\mathrm{reset}}}^{V_{\\mathrm{th}}} \\frac{C \\, dV}{-g_L (V - E_L) + I_{\\mathrm{syn}} + bM + k_{\\mathrm{Ia}} v + G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V)\\, (E_{\\mathrm{PIC}} - V)}.\n$$\n- If the net drift is nonpositive (i.e., the denominator becomes $\\;\\le 0\\;$) anywhere in the interval $\\;[V_{\\mathrm{reset}}, V_{\\mathrm{th}}]\\;$, the trajectory cannot reach threshold, and by definition the firing rate is $\\;0\\;$.\n- Include the absolute refractory period $\\;t_{\\mathrm{ref}}\\;$ to obtain the full interspike interval:\n$$\nT \\;=\\; T_{\\mathrm{drift}} \\;+\\; t_{\\mathrm{ref}}.\n$$\n- Units: with $\\;C\\;$ in $\\;\\mathrm{nF}\\;$ and currents in $\\;\\mathrm{nA}\\;$ and voltage in $\\;\\mathrm{mV}\\;$, the integral yields $\\;\\mathrm{ms}\\;$. Convert to seconds by dividing by $\\;1000\\;$ when computing the rate:\n$$\nr \\;=\\; \\frac{1}{T/1000} \\;=\\; \\frac{1000}{T} \\quad \\text{in} \\;\\mathrm{Hz}.\n$$\n\nReflex threshold velocity:\n- The minimal velocity to just reach threshold is obtained by enforcing zero net drift at threshold:\n$$\n0 \\;=\\; -g_L (V_{\\mathrm{th}} - E_L) + I_{\\mathrm{syn}} + bM + k_{\\mathrm{Ia}} v_{\\mathrm{thresh}} + G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V_{\\mathrm{th}})\\, (E_{\\mathrm{PIC}} - V_{\\mathrm{th}}).\n$$\n- Solving for velocity and clamping to nonnegative:\n$$\nv_{\\mathrm{thresh}} \\;=\\; \\max\\!\\left(0,\\; \\frac{g_L \\big(V_{\\mathrm{th}} - E_L\\big) - I_{\\mathrm{syn}} - bM - G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V_{\\mathrm{th}})\\, \\big(E_{\\mathrm{PIC}} - V_{\\mathrm{th}}\\big)}{k_{\\mathrm{Ia}}}\\right).\n$$\n\nSpasticity index:\n- Define $\\;\\mathrm{SI} = r / v_{\\mathrm{thresh}}\\;$ to capture how much firing is obtained per unit stretch. If $\\;v_{\\mathrm{thresh}} = 0\\;$, the ratio diverges; cap at $\\;10^9\\;$:\n$$\n\\mathrm{SI} \\;=\\; \\begin{cases}\n\\frac{r}{v_{\\mathrm{thresh}}}, & v_{\\mathrm{thresh}} > 0, \\\\\n10^9, & v_{\\mathrm{thresh}} = 0.\n\\end{cases}\n$$\n\nAlgorithm:\n- For each test case parameters $\\;(M, I_{\\mathrm{syn}}, v)\\;$:\n  1. Compute $\\;G(M) = 1 + \\alpha M\\;$ and $\\;I_{\\mathrm{bias}} = bM\\;$ and $\\;I_{\\mathrm{Ia}} = k_{\\mathrm{Ia}} v\\;$.\n  2. Define the drift function in the denominator of the integral,\n  $$\n  F(V) = -g_L (V - E_L) + I_{\\mathrm{syn}} + bM + k_{\\mathrm{Ia}} v + G(M)\\, g_{\\mathrm{PIC}} \\, s_{\\infty}(V)\\, (E_{\\mathrm{PIC}} - V).\n  $$\n  3. Check $\\;F(V) > 0\\;$ on $\\;[V_{\\mathrm{reset}}, V_{\\mathrm{th}}]\\;$ by sampling; if any $\\;F(V) \\le 0\\;$, set $\\;r = 0\\;$, otherwise numerically integrate $\\;T_{\\mathrm{drift}} = \\int C/F(V)\\, dV\\;$ with high-accuracy quadrature and add $\\;t_{\\mathrm{ref}}\\;$ to form $\\;T\\;$; then convert to $\\;r = 1000/T\\;$ in $\\;\\mathrm{Hz}\\;$.\n  4. Compute $\\;v_{\\mathrm{thresh}}\\;$ via the closed-form expression above using $s_{\\infty}(V_{\\mathrm{th}})\\;$, and clamp to $\\;\\ge 0\\;$.\n  5. Compute $\\;\\mathrm{SI}\\;$ as specified, capping at $\\;10^9\\;$ if $\\;v_{\\mathrm{thresh}} = 0\\;$.\n  6. Round each output to three decimals.\n\nTest coverage rationale:\n- Case $\\;1\\;$ is a typical baseline with mildly elevated monoamines.\n- Case $\\;2\\;$ represents chronic UMN lesion with higher $\\;M\\;$, predicting increased PIC and lowered reflex threshold.\n- Case $\\;3\\;$ tests a boundary of minimal monoaminergic tone and weak synaptic drive, often resulting in no firing unless stretch is sufficiently fast.\n- Case $\\;4\\;$ is a high monoaminergic case where reflex threshold becomes zero, illustrating hyperexcitability and spasticity.\n- Case $\\;5\\;$ includes net inhibitory synaptic drive to probe robustness and the requirement for higher stretch velocities for activation.\n\nOutput:\n- Produce one line: a single Python list of five inner lists; each inner list contains three floats $\\;[r\\;(\\mathrm{Hz}),\\; v_{\\mathrm{thresh}}\\;(\\mathrm{m/s}),\\; \\mathrm{SI}]\\;$ rounded to three decimals, ordered by the test case sequence.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Biophysical constants (units noted for clarity):\n# C: nF, g_L: uS, E_*: mV, g_PIC: uS, t_ref: ms, I_*: nA, k_Ia: nA/(m/s)\nC_nF = 1.0\ngL_uS = 0.02\nEL_mV = -65.0\nVth_mV = -50.0\nVreset_mV = -55.0\nEPIC_mV = 120.0\ngPIC_uS = 0.0002\nVhalf_mV = -60.0\nk_slope_mV = 4.0\nalpha = 1.5  # monoaminergic gain slope\nb_bias_nA_per_M = 0.02\nk_Ia_nA_per_ms = 0.3\nt_ref_ms = 5.0\n\ndef s_inf(V_mV: float) -> float:\n    \"\"\"Steady-state activation of PIC (dimensionless).\"\"\"\n    return 1.0 / (1.0 + np.exp(-(V_mV - Vhalf_mV) / k_slope_mV))\n\ndef drift_current_nA(V_mV: float, M: float, I_syn_nA: float, v_ms: float) -> float:\n    \"\"\"Net inward drift current in nA at voltage V under parameters.\"\"\"\n    G = 1.0 + alpha * M  # monoaminergic gain (dimensionless)\n    I_bias = b_bias_nA_per_M * M\n    I_Ia = k_Ia_nA_per_ms * v_ms\n    leak = -gL_uS * (V_mV - EL_mV)  # nA (since uS*mV = nA)\n    pic = G * gPIC_uS * s_inf(V_mV) * (EPIC_mV - V_mV)  # nA\n    return leak + I_syn_nA + I_bias + I_Ia + pic\n\ndef can_spike(M: float, I_syn_nA: float, v_ms: float) -> bool:\n    \"\"\"Check positivity of drift over [Vreset, Vth].\"\"\"\n    # Sample the interval uniformly; include endpoints cautiously\n    V_vals = np.linspace(Vreset_mV, Vth_mV, 200)\n    F_vals = drift_current_nA(V_vals, M, I_syn_nA, v_ms)\n    return np.all(F_vals > 0.0)\n\ndef interspike_interval_ms(M: float, I_syn_nA: float, v_ms: float) -> float:\n    \"\"\"Compute interspike interval in ms via quadrature; includes refractory.\"\"\"\n    # Integrand: C / F(V), units: nF / nA * mV -> ms\n    def integrand(V):\n        F = drift_current_nA(V, M, I_syn_nA, v_ms)\n        return C_nF / F\n    # Perform integration only if drift is positive across interval\n    if not can_spike(M, I_syn_nA, v_ms):\n        return np.inf\n    # Use high-accuracy quad; handle potential sharp changes near threshold\n    val, err = quad(lambda V: integrand(V), Vreset_mV, Vth_mV, epsabs=1e-9, epsrel=1e-9, limit=200)\n    return val + t_ref_ms\n\ndef firing_rate_hz(M: float, I_syn_nA: float, v_ms: float) -> float:\n    \"\"\"Compute firing rate in Hz.\"\"\"\n    T_ms = interspike_interval_ms(M, I_syn_nA, v_ms)\n    if not np.isfinite(T_ms) or T_ms <= 0.0:\n        return 0.0\n    return 1000.0 / T_ms\n\ndef v_threshold_ms(M: float, I_syn_nA: float) -> float:\n    \"\"\"Minimal stretch velocity (m/s) to achieve zero drift at Vth; clamp to >= 0.\"\"\"\n    G = 1.0 + alpha * M\n    s_th = s_inf(Vth_mV)\n    numerator = gL_uS * (Vth_mV - EL_mV) - I_syn_nA - b_bias_nA_per_M * M - G * gPIC_uS * s_th * (EPIC_mV - Vth_mV)\n    v_thr = numerator / k_Ia_nA_per_ms\n    return float(max(0.0, v_thr))\n\ndef spasticity_index(rate_hz: float, v_thr_ms: float) -> float:\n    \"\"\"Spasticity index r / v_thr, capped at 1e9 if v_thr==0.\"\"\"\n    if v_thr_ms == 0.0:\n        return 1e9\n    return rate_hz / v_thr_ms\n\ndef solve():\n    # Define the test cases from the problem statement: (M, I_syn (nA), v (m/s))\n    test_cases = [\n        (0.2, 0.2, 0.3),   # Case 1\n        (1.0, 0.2, 0.3),   # Case 2\n        (0.0, 0.1, 0.3),   # Case 3\n        (2.0, 0.15, 0.1),  # Case 4\n        (1.5, -0.05, 0.3), # Case 5\n    ]\n\n    results = []\n    for M, I_syn, v in test_cases:\n        r = firing_rate_hz(M, I_syn, v)\n        v_thr = v_threshold_ms(M, I_syn)\n        si = spasticity_index(r, v_thr)\n        # Round to three decimals as specified\n        r_r = round(r, 3)\n        v_r = round(v_thr, 3)\n        si_r = round(si, 3)\n        results.append([r_r, v_r, si_r])\n\n    # Final print statement in the exact required format.\n    # One single line with the outer list of inner lists, no extra text.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```", "id": "4498365"}]}