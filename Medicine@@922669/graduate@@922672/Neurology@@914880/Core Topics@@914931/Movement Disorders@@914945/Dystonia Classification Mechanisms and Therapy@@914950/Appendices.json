{"hands_on_practices": [{"introduction": "This exercise guides you through building a computational model of the basal ganglia-thalamocortical loops from the ground up [@problem_id:4476949]. By simulating the firing rates of key neural populations, you will directly observe how a specific dysfunction—reduced output from the Globus Pallidus internus ($GPi$)—leads to the disinhibition of the thalamus, a central hypothesis in the pathophysiology of dystonia. This practice develops essential skills in computational neuroscience and provides a dynamic intuition for circuit-level disorders.", "problem": "Construct a simplified, scientifically plausible rate model of basal ganglia–thalamocortical loops to explain, from first principles, how reduced firing rates in the Globus Pallidus internus (GPi) can yield sustained abnormal facilitation of thalamocortical activity in dystonia. The model must be implemented as a program that simulates the population firing rates of four nodes: Cortex (C), Thalamus (T), Subthalamic Nucleus (STN), and Globus Pallidus internus (GPi). Use the following foundational base and constraints without shortcut formulas beyond the fundamental modeling rules.\n\nFundamental base:\n- Population rate dynamics follow a first-order linear-threshold system grounded in Wilson–Cowan style rate models: each population has a firing rate $r_x(t)$ for node $x \\in \\{C, T, S, G\\}$, a baseline drive $b_x$ in $\\mathrm{Hz}$, synaptic inputs weighted by signed gains, and a single time constant $\\tau_x$ in $\\mathrm{s}$ controlling relaxation to a rectified input-output nonlinearity. Let the net synaptic input be the weighted sum of presynaptic population rates plus baseline drive. The rectification is approximated by a non-saturating half-wave linear function mapping inputs to nonnegative firing rates.\n- Excitatory projections are represented by positive synaptic weights and inhibitory projections by negative synaptic weights. The canonical loop relationships are: GPi inhibits Thalamus, Thalamus excites Cortex, Cortex excites Thalamus, Cortex excites Subthalamic Nucleus, and Subthalamic Nucleus excites GPi. A net inhibitory pathway from Cortex to GPi represents the cortico-striatal direct pathway.\n- The system must be simulated in discrete time with a small step size using an explicit numerical integration method and a rectified linear activation, ensuring that all firing rates remain nonnegative.\n\nScientific realism constraints:\n- Express all firing rates in $\\mathrm{Hz}$. Express all times in $\\mathrm{s}$. Use radians only if angles appear, which they do not in this problem.\n- Use the same time constant for all populations and do not include stochasticity.\n- The sustained abnormal facilitation criterion must be determined by a thalamic steady-state rate exceeding a specified threshold stably over a late portion of the simulation.\n\nYour task is to implement a program that:\n1. Initializes the four nodes with their baseline drives in $\\mathrm{Hz}$ and specified synaptic weights, then simulates the discrete-time population dynamics for the specified duration using the fundamental base described above.\n2. Estimates the steady-state firing rate for each node by computing the mean over the final $25\\%$ of the simulation window.\n3. Determines whether dystonic sustained abnormal facilitation occurs, defined as the mean thalamic firing rate over the final $25\\%$ of the simulation strictly exceeding a threshold equal to $(b_T + \\delta)$ where $b_T$ is the thalamic baseline drive and $\\delta$ is an offset in $\\mathrm{Hz}$ provided below.\n4. Produces one result per test case consisting of three values in order: the final-thalamic steady-state firing rate in $\\mathrm{Hz}$ (rounded to two decimal places), the final-cortical steady-state firing rate in $\\mathrm{Hz}$ (rounded to two decimal places), and a classification flag as an integer ($1$ for sustained abnormal facilitation and $0$ otherwise).\n\nModeling rules and definitions:\n- For each node $x$, use the same time constant $\\tau_x = \\tau$ with $\\tau$ in $\\mathrm{s}$.\n- Use an explicit discrete-time integration with step size $\\Delta t$ in $\\mathrm{s}$ over a total simulation time $T_{\\mathrm{sim}}$ in $\\mathrm{s}$.\n- Let the rectified linear activation be $F(I) = \\max(0, I)$ acting on the net input $I$.\n- The canonical directed edges and signed weights are:\n  - Cortical to Thalamic: $w_{CT} > 0$,\n  - Thalamic to Cortical: $w_{TC} > 0$,\n  - GPi to Thalamic: $w_{GT}  0$,\n  - Cortical to Subthalamic: $w_{CS} > 0$,\n  - Subthalamic to GPi: $w_{SG} > 0$,\n  - Cortical to GPi (net direct pathway): $w_{CG}  0$.\n\nImplementation specifics:\n- Use the same $\\tau$ for all nodes, with numerical values given in the test suite.\n- Use the mean over the final $25\\%$ of the simulation to estimate steady-state firing rates for Thalamus and Cortex.\n- Determine sustained abnormal facilitation by comparing the mean thalamic rate over the final $25\\%$ to $(b_T + \\delta)$ and set the classification flag to $1$ if it is strictly greater, else $0$.\n\nTest suite and parameters:\nAll test cases share the following fixed parameters unless otherwise specified:\n- Time constant: $\\tau = 0.05\\,\\mathrm{s}$,\n- Time step: $\\Delta t = 0.001\\,\\mathrm{s}$,\n- Total simulation time: $T_{\\mathrm{sim}} = 3.0\\,\\mathrm{s}$,\n- Threshold offset: $\\delta = 5\\,\\mathrm{Hz}$,\n- Baseline drives: $b_C = 5\\,\\mathrm{Hz}$, $b_T = 20\\,\\mathrm{Hz}$, $b_S = 15\\,\\mathrm{Hz}$,\n- Synaptic weights: $w_{CT} = 1.0$, $w_{TC} = 0.5$, $w_{GT} = -0.2$, $w_{CS} = 0.4$, $w_{SG} = 0.4$,\n- The cortico-striatal direct pathway weight $w_{CG}$ and GPi baseline $b_G$ vary per test case.\n\nProvide results for the following five test cases:\n- Case $1$ (nominal healthy-like GPi output): $w_{CG} = -0.5$, $b_G = 90\\,\\mathrm{Hz}$.\n- Case $2$ (dystonia-like reduced GPi output): $w_{CG} = -0.5$, $b_G = 50\\,\\mathrm{Hz}$.\n- Case $3$ (boundary condition, near-silenced GPi): $w_{CG} = -0.5$, $b_G = 0\\,\\mathrm{Hz}$.\n- Case $4$ (high GPi output): $w_{CG} = -0.5$, $b_G = 110\\,\\mathrm{Hz}$.\n- Case $5$ (dystonia with stronger cortico-striatal inhibition to GPi, simulated therapy via elevated GPi baseline): $w_{CG} = -0.7$, $b_G = 90\\,\\mathrm{Hz}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result should be a list in the form $[T_{\\mathrm{ss}}, C_{\\mathrm{ss}}, f]$, where $T_{\\mathrm{ss}}$ and $C_{\\mathrm{ss}}$ are the mean steady-state firing rates in $\\mathrm{Hz}$ over the final $25\\%$ of the simulation (rounded to two decimal places), and $f$ is the integer classification flag. The entire output should therefore be a single list of lists with no spaces, for example, $[[12.34,9.87,0],[\\dots]]$.", "solution": "The problem is valid. It presents a scientifically grounded, well-posed, and complete task to model a simplified basal ganglia–thalamocortical circuit and analyze its behavior under different parameterizations corresponding to healthy and dystonic states.\n\n### Principle-Based Design\n\nThe solution is based on a rate-based neural population model, a standard approach in computational neuroscience for studying the dynamics of large groups of neurons. The model consists of four interconnected populations (nodes), representing key structures in motor control loops: Cortex ($C$), Thalamus ($T$), Subthalamic Nucleus ($S$), and Globus Pallidus internus ($G$).\n\n**1. Model Dynamics**\n\nThe firing rate $r_x(t)$ of each population $x \\in \\{C, T, S, G\\}$ is governed by a first-order differential equation, a simplified form of the Wilson-Cowan model:\n$$\n\\tau \\frac{dr_x(t)}{dt} = -r_x(t) + F(I_x(t))\n$$\nwhere $\\tau$ is the population time constant, $I_x(t)$ is the total synaptic input to the population at time $t$, and $F(\\cdot)$ is a non-linear activation function. The shared time constant $\\tau=0.05\\,\\mathrm{s}$ dictates the speed at which each population's firing rate relaxes toward a value determined by its current input. The activation function is a rectified linear unit (ReLU), $F(I) = \\max(0, I)$, which ensures that firing rates are non-negative, a fundamental physical constraint.\n\n**2. Circuit Architecture and Input Currents**\n\nThe synaptic inputs $I_x(t)$ are calculated as a weighted sum of the firing rates of presynaptic populations, plus a baseline drive $b_x$ that represents background inputs. The circuit's connectivity is defined by synaptic weights $w_{yx}$, where $y$ is the source and $x$ is the destination. Positive weights ($w_{yx}>0$) denote excitatory connections, and negative weights ($w_{yx}0$) denote inhibitory connections. Based on the problem's specified canonical loop structure, the input currents are:\n\n-   **Cortex ($I_C$):** Receives excitatory input from the Thalamus.\n    $$ I_C(t) = b_C + w_{TC} r_T(t) $$\n-   **Thalamus ($I_T$):** Receives excitatory input from the Cortex and inhibitory input from the GPi. This is the primary output pathway of the basal ganglia.\n    $$ I_T(t) = b_T + w_{CT} r_C(t) + w_{GT} r_G(t) $$\n-   **Subthalamic Nucleus ($I_S$):** Receives excitatory input from the Cortex.\n    $$ I_S(t) = b_S + w_{CS} r_C(t) $$\n-   **Globus Pallidus internus ($I_G$):** Receives excitatory input from the STN and a net inhibitory input from the Cortex (representing the cortico-striatal \"direct pathway\").\n    $$ I_G(t) = b_G + w_{SG} r_S(t) + w_{CG} r_C(t) $$\n\nThe core hypothesis tested is that a reduction in the output of the GPi (modeled by reducing its baseline drive $b_G$) leads to disinhibition of the Thalamus. Since $w_{GT}$ is negative, a smaller $r_G(t)$ results in a larger input $I_T(t)$, facilitating increased thalamic and, subsequently, cortical activity, which is characteristic of dystonia.\n\n**3. Numerical Integration**\n\nTo simulate the system's evolution over time, the continuous differential equations are converted into discrete-time difference equations and solved numerically. The problem specifies the use of the explicit (forward) Euler method with a time step $\\Delta t = 0.001\\,\\mathrm{s}$. The update rule for the firing rate of any node $x$ from time step $i$ to $i+1$ is:\n$$\nr_x(t_i + \\Delta t) = r_x(t_i) + \\frac{\\Delta t}{\\tau} \\left[-r_x(t_i) + \\max(0, I_x(t_i))\\right]\n$$\nThe simulation starts with all firing rates at zero, $r_x(0)=0\\,\\mathrm{Hz}$, and is run for a total time of $T_{\\mathrm{sim}} = 3.0\\,\\mathrm{s}$, which is sufficient for the system to reach a steady state.\n\n**4. Analysis and Classification**\n\nThe steady-state firing rates, $C_{\\mathrm{ss}}$ and $T_{\\mathrm{ss}}$, are estimated by computing the mean firing rate of the Cortex and Thalamus, respectively, over the final 25% of the simulation interval (from $t=2.25\\,\\mathrm{s}$ to $t=3.0\\,\\mathrm{s}$). This averaging smooths out any minor oscillations around the fixed-point attractor.\n\nThe criterion for \"sustained abnormal facilitation,\" characteristic of dystonia, is defined as the steady-state thalamic firing rate exceeding a pathology threshold. This threshold is set at $b_T + \\delta = 20\\,\\mathrm{Hz} + 5\\,\\mathrm{Hz} = 25\\,\\mathrm{Hz}$. A classification flag $f$ is set to $1$ if $T_{\\mathrm{ss}} > 25\\,\\mathrm{Hz}$, and $0$ otherwise.\n\n**5. Implementation**\n\nThe program implements this model by first defining all fixed parameters and the five test cases. It then iterates through each test case, executing the simulation loop. Within the loop, it calculates the input currents and updates the firing rates of the four nodes at each time step. After the simulation, it computes the steady-state statistics, applies the classification criterion, rounds the results to two decimal places, and appends the formatted list $[T_{\\mathrm{ss}}, C_{\\mathrm{ss}}, f]$ to a results list. Finally, the program prints the complete list of lists in the specified compact string format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Simulates a simplified rate model of basal ganglia–thalamocortical loops\n    to investigate the mechanisms of dystonia.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    TAU = 0.05         # Time constant (s)\n    DT = 0.001         # Time step (s)\n    T_SIM = 3.0          # Total simulation time (s)\n    DELTA = 5.0          # Threshold offset for dystonia (Hz)\n\n    # Baseline drives (Hz)\n    B_C = 5.0\n    B_T = 20.0\n    B_S = 15.0\n\n    # Synaptic weights\n    W_CT = 1.0           # Cortex - Thalamus (+)\n    W_TC = 0.5           # Thalamus - Cortex (+)\n    W_GT = -0.2          # GPi - Thalamus (-)\n    W_CS = 0.4           # Cortex - STN (+)\n    W_SG = 0.4           # STN - GPi (+)\n\n    # --- Test Suite ---\n    test_cases = [\n        # Case 1 (nominal healthy-like GPi output)\n        {'w_cg': -0.5, 'b_g': 90.0},\n        # Case 2 (dystonia-like reduced GPi output)\n        {'w_cg': -0.5, 'b_g': 50.0},\n        # Case 3 (boundary condition, near-silenced GPi)\n        {'w_cg': -0.5, 'b_g': 0.0},\n        # Case 4 (high GPi output)\n        {'w_cg': -0.5, 'b_g': 110.0},\n        # Case 5 (dystonia with stronger cortico-striatal inhibition, simulated therapy)\n        {'w_cg': -0.7, 'b_g': 90.0},\n    ]\n\n    # --- Simulation Setup ---\n    num_steps = int(T_SIM / DT)\n    # The starting index for calculating the mean over the final 25% of the simulation\n    start_idx_ss = int(0.75 * num_steps)\n    \n    all_results = []\n\n    for case in test_cases:\n        w_cg = case['w_cg']\n        b_g = case['b_g']\n\n        # Initialize firing rate arrays. Size is num_steps + 1 to hold initial condition at t=0.\n        r_c = np.zeros(num_steps + 1)\n        r_t = np.zeros(num_steps + 1)\n        r_s = np.zeros(num_steps + 1)\n        r_g = np.zeros(num_steps + 1)\n        \n        # Pre-calculate the integration factor\n        integration_factor = DT / TAU\n\n        # --- Simulation Loop ---\n        for i in range(num_steps):\n            # Calculate net synaptic input to each node at step i\n            i_c = B_C + W_TC * r_t[i]\n            i_t = B_T + W_CT * r_c[i] + W_GT * r_g[i]\n            i_s = B_S + W_CS * r_c[i]\n            i_g = b_g + W_SG * r_s[i] + w_cg * r_c[i]\n\n            # Apply rectified linear activation function F(I) = max(0, I)\n            act_c = max(0.0, i_c)\n            act_t = max(0.0, i_t)\n            act_s = max(0.0, i_s)\n            act_g = max(0.0, i_g)\n\n            # Update firing rates for step i+1 using explicit Euler integration\n            r_c[i+1] = r_c[i] + integration_factor * (-r_c[i] + act_c)\n            r_t[i+1] = r_t[i] + integration_factor * (-r_t[i] + act_t)\n            r_s[i+1] = r_s[i] + integration_factor * (-r_s[i] + act_s)\n            r_g[i+1] = r_g[i] + integration_factor * (-r_g[i] + act_g)\n\n        # --- Analysis and Classification ---\n        # Estimate steady-state rates by averaging over the final 25% of the simulation\n        t_ss = np.mean(r_t[start_idx_ss:])\n        c_ss = np.mean(r_c[start_idx_ss:])\n        \n        # Determine the classification flag for sustained abnormal facilitation\n        dystonia_threshold = B_T + DELTA\n        flag = 1 if t_ss  dystonia_threshold else 0\n        \n        # Round the steady-state rates to two decimal places\n        t_ss_rounded = np.round(t_ss, 2)\n        c_ss_rounded = np.round(c_ss, 2)\n        \n        all_results.append([t_ss_rounded, c_ss_rounded, flag])\n\n    # Final print statement in the exact required format: a list of lists with no spaces\n    print(str(all_results).replace(' ', ''))\n\nsolve()\n```", "id": "4476949"}, {"introduction": "Building on the circuit model, this practice explores how we can probe the system's dysfunction in human subjects using Transcranial Magnetic Stimulation (TMS) [@problem_id:4476887]. You will analyze hypothetical TMS data to calculate the cortical silent period ($CSP$), a marker of $GABA_{B}$-mediated inhibition. This exercise demonstrates how a quantitative analysis of neurophysiological recordings can reveal key pathophysiological changes, such as the deficient cortical inhibition frequently observed in dystonia.", "problem": "A single-pulse Transcranial Magnetic Stimulation (TMS) experiment is performed over the primary motor cortex during a tonic voluntary contraction to probe intracortical inhibition in a musician with task-specific focal hand dystonia (adult-onset, focal, task-specific dystonia) and in an age-matched healthy control. The cortical silent period (CSP) is defined operationally as the interval from the onset of the motor-evoked potential (MEP) to the first sustained return of voluntary electromyographic (EMG) activity. You record $6$ artifact-free trials per participant at $130\\%$ of resting motor threshold during a stable contraction of approximately $20\\%$ of maximal voluntary contraction.\n\nFor each trial you identify the MEP onset time and the EMG resumption time, both referenced to the TMS pulse ($t=0$). The dystonia participant’s trials yield:\n- Trial $1$: MEP onset $22$ ms; EMG resumption $118$ ms.\n- Trial $2$: MEP onset $21$ ms; EMG resumption $119$ ms.\n- Trial $3$: MEP onset $23$ ms; EMG resumption $120$ ms.\n- Trial $4$: MEP onset $22$ ms; EMG resumption $115$ ms.\n- Trial $5$: MEP onset $22$ ms; EMG resumption $121$ ms.\n- Trial $6$: MEP onset $21$ ms; EMG resumption $116$ ms.\n\nThe healthy control’s trials yield:\n- Trial $1$: MEP onset $23$ ms; EMG resumption $175$ ms.\n- Trial $2$: MEP onset $22$ ms; EMG resumption $170$ ms.\n- Trial $3$: MEP onset $23$ ms; EMG resumption $168$ ms.\n- Trial $4$: MEP onset $22$ ms; EMG resumption $176$ ms.\n- Trial $5$: MEP onset $21$ ms; EMG resumption $169$ ms.\n- Trial $6$: MEP onset $22$ ms; EMG resumption $171$ ms.\n\nAssume the following well-tested physiological bases:\n- After the MEP, the net cortical inhibitory drive governing the CSP can be modeled as an exponentially decaying inhibitory current $I(t)=I_{0}\\exp(-t/\\tau)$ mediated predominantly by gamma-aminobutyric acid type B ($GABA_B$) receptors, with time constant $\\tau$.\n- Voluntary EMG resumes when $I(t)$ decays to a fixed threshold $I_{\\mathrm{th}}$ for the given task and participant.\n- A prior calibration at this TMS intensity in this muscle shows that the ratio $I_{0}/I_{\\mathrm{th}}=4.5$ is applicable for the present recordings.\n\nTasks:\n- From the dystonia participant’s trials, compute the mean CSP duration $\\overline{T}_{\\mathrm{CSP,dys}}$.\n- Using the exponential decay model and the provided ratio $I_{0}/I_{\\mathrm{th}}$, compute the corresponding inhibitory time constant $\\tau_{\\mathrm{dys}}$.\n\nReport only the value of $\\tau_{\\mathrm{dys}}$. Round your answer to four significant figures. Express the final value in milliseconds (ms). No additional outputs are required.", "solution": "The problem requires the calculation of the inhibitory time constant, $\\tau_{\\mathrm{dys}}$, for a participant with dystonia, based on data from a Transcranial Magnetic Stimulation (TMS) experiment. The solution proceeds in two main stages: first, the determination of the mean cortical silent period (CSP) from the provided trial data, and second, the application of a given biophysical model to relate this mean CSP to the time constant.\n\nFirst, we must calculate the duration of the cortical silent period, $T_{\\mathrm{CSP}}$, for each of the $6$ trials for the dystonia participant. The problem defines the CSP as the interval from the onset of the motor-evoked potential (MEP) to the return of voluntary electromyographic (EMG) activity. Let $t_{\\mathrm{MEP}}$ be the MEP onset time and $t_{\\mathrm{EMG}}$ be the EMG resumption time, both referenced to the TMS pulse at $t=0$. The CSP duration for a given trial is therefore $T_{\\mathrm{CSP}} = t_{\\mathrm{EMG}} - t_{\\mathrm{MEP}}$.\n\nThe trial data for the dystonia participant are:\n- Trial $1$: $t_{\\mathrm{MEP},1} = 22 \\text{ ms}$, $t_{\\mathrm{EMG},1} = 118 \\text{ ms}$. Thus, $T_{\\mathrm{CSP},1} = 118 - 22 = 96 \\text{ ms}$.\n- Trial $2$: $t_{\\mathrm{MEP},2} = 21 \\text{ ms}$, $t_{\\mathrm{EMG},2} = 119 \\text{ ms}$. Thus, $T_{\\mathrm{CSP},2} = 119 - 21 = 98 \\text{ ms}$.\n- Trial $3$: $t_{\\mathrm{MEP},3} = 23 \\text{ ms}$, $t_{\\mathrm{EMG},3} = 120 \\text{ ms}$. Thus, $T_{\\mathrm{CSP},3} = 120 - 23 = 97 \\text{ ms}$.\n- Trial $4$: $t_{\\mathrm{MEP},4} = 22 \\text{ ms}$, $t_{\\mathrm{EMG},4} = 115 \\text{ ms}$. Thus, $T_{\\mathrm{CSP},4} = 115 - 22 = 93 \\text{ ms}$.\n- Trial $5$: $t_{\\mathrm{MEP},5} = 22 \\text{ ms}$, $t_{\\mathrm{EMG},5} = 121 \\text{ ms}$. Thus, $T_{\\mathrm{CSP},5} = 121 - 22 = 99 \\text{ ms}$.\n- Trial $6$: $t_{\\mathrm{MEP},6} = 21 \\text{ ms}$, $t_{\\mathrm{EMG},6} = 116 \\text{ ms}$. Thus, $T_{\\mathrm{CSP},6} = 116 - 21 = 95 \\text{ ms}$.\n\nThe next step is to compute the mean CSP duration for the dystonia participant, denoted as $\\overline{T}_{\\mathrm{CSP,dys}}$. This is the arithmetic mean of the individual trial durations.\n$$\n\\overline{T}_{\\mathrm{CSP,dys}} = \\frac{1}{6} \\sum_{i=1}^{6} T_{\\mathrm{CSP},i}\n$$\n$$\n\\overline{T}_{\\mathrm{CSP,dys}} = \\frac{96 + 98 + 97 + 93 + 99 + 95}{6} \\text{ ms} = \\frac{578}{6} \\text{ ms} \\approx 96.333... \\text{ ms}\n$$\nIt is prudent to retain the exact fractional form $\\frac{578}{6}$ for intermediate calculations to avoid rounding errors.\n\nThe second stage of the problem involves the provided biophysical model. The net cortical inhibitory drive is modeled as an exponentially decaying current $I(t) = I_{0}\\exp(-t/\\tau)$, where $t$ is the time elapsed after the MEP onset. Voluntary EMG activity resumes when this inhibitory current $I(t)$ decays to a fixed threshold value $I_{\\mathrm{th}}$. This resumption occurs at time $t = T_{\\mathrm{CSP}}$. We use the mean value $\\overline{T}_{\\mathrm{CSP,dys}}$ as the representative time for this event.\n\nTherefore, the condition for EMG resumption is:\n$$\nI(\\overline{T}_{\\mathrm{CSP,dys}}) = I_{\\mathrm{th}}\n$$\nSubstituting the expression for $I(t)$ into this condition, with the time constant for the dystonia participant being $\\tau_{\\mathrm{dys}}$, we get:\n$$\nI_{0}\\exp(-\\overline{T}_{\\mathrm{CSP,dys}} / \\tau_{\\mathrm{dys}}) = I_{\\mathrm{th}}\n$$\nWe can rearrange this equation to isolate the exponential term:\n$$\n\\exp(-\\overline{T}_{\\mathrm{CSP,dys}} / \\tau_{\\mathrm{dys}}) = \\frac{I_{\\mathrm{th}}}{I_{0}}\n$$\nThe problem provides the ratio $I_{0}/I_{\\mathrm{th}} = 4.5$. This implies that the ratio $I_{\\mathrm{th}}/I_{0} = 1/4.5$. Substituting this value:\n$$\n\\exp(-\\overline{T}_{\\mathrm{CSP,dys}} / \\tau_{\\mathrm{dys}}) = \\frac{1}{4.5}\n$$\nTo solve for $\\tau_{\\mathrm{dys}}$, we take the natural logarithm of both sides:\n$$\n\\ln\\left(\\exp(-\\overline{T}_{\\mathrm{CSP,dys}} / \\tau_{\\mathrm{dys}})\\right) = \\ln\\left(\\frac{1}{4.5}\\right)\n$$\n$$\n-\\frac{\\overline{T}_{\\mathrm{CSP,dys}}}{\\tau_{\\mathrm{dys}}} = -\\ln(4.5)\n$$\nMultiplying by $-1$ and rearranging to solve for $\\tau_{\\mathrm{dys}}$:\n$$\n\\tau_{\\mathrm{dys}} = \\frac{\\overline{T}_{\\mathrm{CSP,dys}}}{\\ln(4.5)}\n$$\nNow, we substitute the calculated value of $\\overline{T}_{\\mathrm{CSP,dys}} = \\frac{578}{6}$ ms:\n$$\n\\tau_{\\mathrm{dys}} = \\frac{578/6}{\\ln(4.5)} \\text{ ms}\n$$\nUsing the numerical values:\n$$\n\\tau_{\\mathrm{dys}} \\approx \\frac{96.33333...}{\\ln(4.5)} \\approx \\frac{96.33333...}{1.5040773967...} \\approx 64.04830... \\text{ ms}\n$$\nThe problem requires the final answer to be rounded to four significant figures. The calculated value is $64.04830...$. The first four significant figures are $6$, $4$, $0$, and $4$. The fifth significant digit is $8$, which is greater than or equal to $5$, so we round up the fourth digit.\n$$\n\\tau_{\\mathrm{dys}} \\approx 64.05 \\text{ ms}\n$$\nThe data for the healthy control participant are superfluous for the requested calculation.", "answer": "$$\\boxed{64.05}$$", "id": "4476887"}, {"introduction": "The final practice shifts our focus from pathophysiology to therapy, specifically Deep Brain Stimulation (DBS) [@problem_id:4476946]. You will apply a quantitative model to optimize DBS parameters, navigating the crucial trade-off between therapeutic benefit and stimulation-induced side effects. This problem simulates the real-world challenge of programming a DBS device to maximize clinical utility, providing a framework for principled, model-based therapeutic adjustment in the very circuits explored in the preceding exercises [@problem_id:4476949] [@problem_id:4476887].", "problem": "Deep Brain Stimulation (DBS) for dystonia is commonly adjusted within a constrained therapeutic window to balance symptom control against off-target activation that produces adverse effects such as bradykinesia or dysarthria. Consider a current-controlled DBS system delivering monophasic pulses to the globus pallidus internus (GPi). Let the charge per pulse be defined by the fundamental relation $Q = I \\times PW$, where $Q$ is charge per pulse, $I$ is stimulation current amplitude, and $PW$ is pulse width. A well-tested model for neural recruitment uses a logistic dose–response function in the control variable $Q$, with the probability of a given effect $P(Q)$ represented as\n$$\nP(Q) = \\frac{1}{1 + \\exp\\!\\big(-k\\,(Q - Q_{0})\\big)},\n$$\nwhere $k$ is the slope (in $\\mathrm{nC}^{-1}$) and $Q_{0}$ is the inflection point (the characteristic charge per pulse for half-maximal effect). Assume the following empirically estimated parameters for this patient and electrode configuration:\n- Dystonia benefit (therapeutic effect): $Q_{b} = 200\\,\\mathrm{nC}$ and slope $k_{b} = 0.05\\,\\mathrm{nC}^{-1}$.\n- Bradykinesia side effect: $Q_{\\mathrm{bk}} = 230\\,\\mathrm{nC}$ and slope $k_{\\mathrm{bk}} = 0.05\\,\\mathrm{nC}^{-1}$.\n- Speech (dysarthria) side effect: $Q_{\\mathrm{sp}} = 260\\,\\mathrm{nC}$ and slope $k_{\\mathrm{sp}} = 0.05\\,\\mathrm{nC}^{-1}$.\n\nAt baseline, the system delivers $PW_{0} = 100\\,\\mu\\mathrm{s}$ and $I_{0} = 2.40\\,\\mathrm{mA}$, yielding $Q_{0} = I_{0}\\,PW_{0} = 240\\,\\mathrm{nC}$, at which bradykinesia is observed. To mitigate off-target effects while preserving benefit, the clinical team proposes shortening the pulse width to $PW_{\\mathrm{new}} = 60\\,\\mu\\mathrm{s}$ and adjusting the current amplitude to maximize net clinical utility defined by\n$$\nU(Q) = P_{\\mathrm{benefit}}(Q) - P_{\\mathrm{side}}(Q),\n$$\nwith $P_{\\mathrm{benefit}}(Q)$ modeled by the logistic function with parameters $(Q_{b}, k_{b})$ as above, and $P_{\\mathrm{side}}(Q)$ chosen according to the encountered adverse effect (either bradykinesia or speech), each modeled with its respective $(Q_{0}, k)$.\n\nUnder the assumption $k_{b} = k_{\\mathrm{side}}$ and equal weighting of benefit and side effects in $U(Q)$, derive the $Q$ that maximizes $U(Q)$ for each scenario (bradykinesia encountered vs. speech encountered), convert each optimal charge per pulse $Q^{\\ast}$ to the corresponding optimal current amplitude $I^{\\ast}$ at the proposed $PW_{\\mathrm{new}}$, and compute the difference $\\Delta I = I^{\\ast}_{\\mathrm{speech}} - I^{\\ast}_{\\mathrm{brady}}$. Express your final numerical answer for $\\Delta I$ in $\\mathrm{mA}$, and round to four significant figures.", "solution": "The objective is to find the optimal stimulation current amplitude $I^{\\ast}$ that maximizes the clinical utility function $U(Q)$ under two different side-effect scenarios. The utility is defined as the difference between the probability of a therapeutic benefit and the probability of a side effect, $U(Q) = P_{\\mathrm{benefit}}(Q) - P_{\\mathrm{side}}(Q)$.\n\nThe probabilities are modeled by logistic functions of the form\n$$\nP(Q) = \\frac{1}{1 + \\exp(-k(Q - Q_c))}\n$$\nwhere $k$ is the slope parameter and $Q_c$ is the characteristic charge (inflection point) for the given effect. The problem states that the slope parameter $k$ is the same for the benefit and side effects, $k_b = k_{\\mathrm{side}} = k = 0.05\\,\\mathrm{nC}^{-1}$.\n\nThe utility function is therefore\n$$\nU(Q) = \\frac{1}{1 + \\exp(-k(Q - Q_b))} - \\frac{1}{1 + \\exp(-k(Q - Q_{\\mathrm{side}}))}\n$$\nwhere $Q_b$ is the inflection point for the therapeutic benefit and $Q_{\\mathrm{side}}$ is the inflection point for the relevant side effect.\n\nTo find the optimal charge per pulse, $Q^{\\ast}$, that maximizes $U(Q)$, we must find the critical points by taking the derivative of $U(Q)$ with respect to $Q$ and setting it to zero.\n$$\n\\frac{dU}{dQ} = \\frac{d}{dQ} \\left( \\frac{1}{1 + \\exp(-k(Q - Q_b))} \\right) - \\frac{d}{dQ} \\left( \\frac{1}{1 + \\exp(-k(Q - Q_{\\mathrm{side}}))} \\right) = 0\n$$\nThe derivative of a single logistic function term is:\n$$\n\\frac{d}{dQ} \\left( \\frac{1}{1 + \\exp(-k(Q - Q_c))} \\right) = \\frac{k\\exp(-k(Q - Q_c))}{(1 + \\exp(-k(Q - Q_c)))^2}\n$$\nSetting the derivatives for the benefit and side-effect terms equal to each other gives:\n$$\n\\frac{k\\exp(-k(Q - Q_b))}{(1 + \\exp(-k(Q - Q_b)))^2} = \\frac{k\\exp(-k(Q - Q_{\\mathrm{side}}))}{(1 + \\exp(-k(Q - Q_{\\mathrm{side}})))^2}\n$$\nSince $k \\neq 0$, we can simplify. Let a function $g(x) = \\frac{\\exp(x)}{(1 + \\exp(x))^2}$. The equation becomes $g(-k(Q - Q_b)) = g(-k(Q - Q_{\\mathrm{side}}))$. The function $g(x)$ is an even function, meaning $g(x) = g(-x)$. Therefore, the equality holds if the arguments are equal or if they are negatives of each other.\n$1$. $-k(Q - Q_b) = -k(Q - Q_{\\mathrm{side}})$, which implies $Q_b = Q_{\\mathrm{side}}$. This is contradicted by the given data and corresponds to a minimum of $U(Q)$.\n$2$. $-k(Q - Q_b) = -[-k(Q - Q_{\\mathrm{side}})]$, which simplifies to $Q - Q_b = -(Q - Q_{\\mathrm{side}})$.\nSolving for $Q$:\n$$\nQ - Q_b = -Q + Q_{\\mathrm{side}}\n$$\n$$\n2Q = Q_b + Q_{\\mathrm{side}}\n$$\n$$\nQ^{\\ast} = \\frac{Q_b + Q_{\\mathrm{side}}}{2}\n$$\nThis result shows that the optimal charge is the arithmetic mean of the inflection points for the benefit and side-effect curves.\n\nNow, we apply this formula to the two scenarios.\n\nScenario 1: Bradykinesia as the side effect.\nThe parameters are $Q_b = 200\\,\\mathrm{nC}$ and $Q_{\\mathrm{side}} = Q_{\\mathrm{bk}} = 230\\,\\mathrm{nC}$.\nThe optimal charge is:\n$$\nQ^{\\ast}_{\\mathrm{brady}} = \\frac{200\\,\\mathrm{nC} + 230\\,\\mathrm{nC}}{2} = \\frac{430\\,\\mathrm{nC}}{2} = 215\\,\\mathrm{nC}\n$$\n\nScenario 2: Speech (dysarthria) as the side effect.\nThe parameters are $Q_b = 200\\,\\mathrm{nC}$ and $Q_{\\mathrm{side}} = Q_{\\mathrm{sp}} = 260\\,\\mathrm{nC}$.\nThe optimal charge is:\n$$\nQ^{\\ast}_{\\mathrm{speech}} = \\frac{200\\,\\mathrm{nC} + 260\\,\\mathrm{nC}}{2} = \\frac{460\\,\\mathrm{nC}}{2} = 230\\,\\mathrm{nC}\n$$\n\nNext, we convert these optimal charges to optimal current amplitudes using the new pulse width, $PW_{\\mathrm{new}} = 60\\,\\mu\\mathrm{s}$. The governing relation is $Q = I \\times PW$, so $I^{\\ast} = Q^{\\ast} / PW_{\\mathrm{new}}$.\nFor consistency in units, where current $I$ is in milliamperes ($\\mathrm{mA}$), charge $Q$ is in nanocoulombs ($\\mathrm{nC}$), and pulse width $PW$ is in microseconds ($\\mu\\mathrm{s}$):\n$$\nI[\\mathrm{mA}] = \\frac{Q[\\mathrm{nC}]}{PW[\\mu\\mathrm{s}]}\n$$\nFor the bradykinesia scenario:\n$$\nI^{\\ast}_{\\mathrm{brady}} = \\frac{Q^{\\ast}_{\\mathrm{brady}}}{PW_{\\mathrm{new}}} = \\frac{215\\,\\mathrm{nC}}{60\\,\\mu\\mathrm{s}} = \\frac{215}{60}\\,\\mathrm{mA}\n$$\nFor the speech scenario:\n$$\nI^{\\ast}_{\\mathrm{speech}} = \\frac{Q^{\\ast}_{\\mathrm{speech}}}{PW_{\\mathrm{new}}} = \\frac{230\\,\\mathrm{nC}}{60\\,\\mu\\mathrm{s}} = \\frac{230}{60}\\,\\mathrm{mA}\n$$\n\nFinally, we compute the difference $\\Delta I = I^{\\ast}_{\\mathrm{speech}} - I^{\\ast}_{\\mathrm{brady}}$:\n$$\n\\Delta I = \\frac{230}{60}\\,\\mathrm{mA} - \\frac{215}{60}\\,\\mathrm{mA} = \\frac{230 - 215}{60}\\,\\mathrm{mA} = \\frac{15}{60}\\,\\mathrm{mA} = 0.25\\,\\mathrm{mA}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta I = 0.2500\\,\\mathrm{mA}\n$$", "answer": "$$\n\\boxed{0.2500}\n$$", "id": "4476946"}]}