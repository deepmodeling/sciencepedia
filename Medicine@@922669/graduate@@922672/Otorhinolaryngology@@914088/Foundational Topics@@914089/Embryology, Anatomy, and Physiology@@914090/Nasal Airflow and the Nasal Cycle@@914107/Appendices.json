{"hands_on_practices": [{"introduction": "This first practice introduces a foundational concept in rhinomanometry: modeling the nasal passages as a simple electrical circuit analog. By treating each nasal cavity as a resistor obeying a linear pressure-flow relationship, we can use the principles of parallel circuits to compute the total nasal resistance. This exercise [@problem_id:5050048] provides a direct, hands-on calculation that bridges clinical measurements with the fundamental principles of fluid dynamics.", "problem": "In a subject undergoing a particular phase of the nasal cycle, each nasal passage behaves approximately as a rigid airway segment with steady, incompressible, Newtonian, laminar airflow over a narrow range of transnasal pressure. Assume that, within this range, each unilateral passage obeys a linear pressure–flow relationship of the form $\\Delta P = R\\,Q$, where $\\Delta P$ is the transnasal pressure difference, $Q$ is the volumetric flow rate through that passage, and $R$ is the corresponding unilateral nasal resistance, which can be treated as constant with respect to $Q$ over the specified range.\n\nAt a standardized reference transnasal pressure difference of $\\Delta P_{\\mathrm{ref}} = 150\\,\\mathrm{Pa}$, active anterior rhinomanometry (AAR) is performed by sealing one naris and measuring the contralateral volumetric flow. The following unilateral flows are obtained at $\\Delta P_{\\mathrm{ref}}$:\n- Left-only: $Q_{L}^{(\\mathrm{uni})} = 210\\,\\mathrm{mL/s}$,\n- Right-only: $Q_{R}^{(\\mathrm{uni})} = 90\\,\\mathrm{mL/s}$.\n\nAssuming the two passages are independent parallel flow paths that share the same $\\Delta P$ when both are patent, use conservation of mass and the linear pressure–flow relation to first express the total nasal resistance when both passages are open in terms of $\\Delta P_{\\mathrm{ref}}$, $Q_{L}^{(\\mathrm{uni})}$, and $Q_{R}^{(\\mathrm{uni})}$, and then compute its value. Express the final answer in $\\mathrm{Pa\\cdot s/cm^{3}}$ and round your result to three significant figures.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Linear pressure–flow relationship: $\\Delta P = R\\,Q$, where $\\Delta P$ is transnasal pressure difference, $Q$ is volumetric flow rate, and $R$ is unilateral nasal resistance.\n- Reference transnasal pressure difference: $\\Delta P_{\\mathrm{ref}} = 150\\,\\mathrm{Pa}$.\n- Unilateral flow through the left passage at $\\Delta P_{\\mathrm{ref}}$: $Q_{L}^{(\\mathrm{uni})} = 210\\,\\mathrm{mL/s}$.\n- Unilateral flow through the right passage at $\\Delta P_{\\mathrm{ref}}$: $Q_{R}^{(\\mathrm{uni})} = 90\\,\\mathrm{mL/s}$.\n- Assumption: The two nasal passages are independent parallel flow paths sharing the same $\\Delta P$.\n- Task: Express total nasal resistance ($R_T$) in terms of $\\Delta P_{\\mathrm{ref}}$, $Q_{L}^{(\\mathrm{uni})}$, and $Q_{R}^{(\\mathrm{uni})}$, then compute its value in $\\mathrm{Pa\\cdot s/cm^{3}}$ rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem uses a linear approximation ($\\Delta P = R\\,Q$) for nasal airflow, which is a standard and valid simplification used in clinical rhinomanometry, analogous to Ohm's law in electrical circuits. The concept of treating the two nasal passages as parallel resistances is a fundamental principle of fluid dynamics and circuit theory. The given physiological values are realistic.\n- **Well-Posed**: The problem provides all necessary data and a clear set of assumptions to determine a unique solution for the total resistance.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased technical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\nThe fundamental relationship provided is the linear pressure–flow model, analogous to Ohm's law for electrical circuits:\n$$\n\\Delta P = R\\,Q\n$$\nwhere $\\Delta P$ corresponds to voltage, $Q$ to current, and $R$ to resistance. From this relationship, the resistance $R$ can be calculated as the ratio of the pressure difference to the flow rate:\n$$\nR = \\frac{\\Delta P}{Q}\n$$\nThe problem provides data from active anterior rhinomanometry, where the flow through each nasal passage is measured independently at a reference pressure $\\Delta P_{\\mathrm{ref}} = 150\\,\\mathrm{Pa}$. We can use this information to calculate the individual resistances of the left ($R_L$) and right ($R_R$) nasal passages.\n\nFor the left passage:\n$$\nR_L = \\frac{\\Delta P_{\\mathrm{ref}}}{Q_{L}^{(\\mathrm{uni})}}\n$$\nFor the right passage:\n$$\nR_R = \\frac{\\Delta P_{\\mathrm{ref}}}{Q_{R}^{(\\mathrm{uni})}}\n$$\nThe problem states that when both passages are open (bilateral breathing), they function as independent parallel flow paths. For parallel paths, the total fluid flow is the sum of the individual flows, based on the principle of conservation of mass. If $Q_T$ is the total flow rate, then for a given shared pressure difference $\\Delta P$:\n$$\nQ_T = Q_L + Q_R\n$$\nThe total nasal resistance, $R_T$, is defined by the relationship for the entire system:\n$$\n\\Delta P = R_T Q_T \\implies Q_T = \\frac{\\Delta P}{R_T}\n$$\nSubstituting the expressions for the flows ($Q_T = \\frac{\\Delta P}{R_T}$, $Q_L = \\frac{\\Delta P}{R_L}$, $Q_R = \\frac{\\Delta P}{R_R}$) into the conservation of mass equation gives:\n$$\n\\frac{\\Delta P}{R_T} = \\frac{\\Delta P}{R_L} + \\frac{\\Delta P}{R_R}\n$$\nSince the pressure difference $\\Delta P$ is non-zero and common to all terms, we can divide by it, yielding the standard formula for combining resistances in parallel:\n$$\n\\frac{1}{R_T} = \\frac{1}{R_L} + \\frac{1}{R_R}\n$$\nThe first part of the task is to express $R_T$ in terms of the given experimental quantities: $\\Delta P_{\\mathrm{ref}}$, $Q_{L}^{(\\mathrm{uni})}$, and $Q_{R}^{(\\mathrm{uni})}$. We substitute the expressions for $R_L$ and $R_R$ into the parallel resistance formula:\n$$\n\\frac{1}{R_T} = \\frac{1}{\\frac{\\Delta P_{\\mathrm{ref}}}{Q_{L}^{(\\mathrm{uni})}}} + \\frac{1}{\\frac{\\Delta P_{\\mathrm{ref}}}{Q_{R}^{(\\mathrm{uni})}}}\n$$\n$$\n\\frac{1}{R_T} = \\frac{Q_{L}^{(\\mathrm{uni})}}{\\Delta P_{\\mathrm{ref}}} + \\frac{Q_{R}^{(\\mathrm{uni})}}{\\Delta P_{\\mathrm{ref}}} = \\frac{Q_{L}^{(\\mathrm{uni})} + Q_{R}^{(\\mathrm{uni})}}{\\Delta P_{\\mathrm{ref}}}\n$$\nInverting this expression gives the total resistance $R_T$ in terms of the given quantities, which completes the first part of the task:\n$$\nR_T = \\frac{\\Delta P_{\\mathrm{ref}}}{Q_{L}^{(\\mathrm{uni})} + Q_{R}^{(\\mathrm{uni})}}\n$$\nThis expression shows that the total resistance is the reference pressure divided by the simple sum of the unilateral flows measured at that pressure.\n\nThe second part of the task is to compute the numerical value of $R_T$. The given values are:\n- $\\Delta P_{\\mathrm{ref}} = 150\\,\\mathrm{Pa}$\n- $Q_{L}^{(\\mathrm{uni})} = 210\\,\\mathrm{mL/s}$\n- $Q_{R}^{(\\mathrm{uni})} = 90\\,\\mathrm{mL/s}$\n\nThe required unit for resistance is $\\mathrm{Pa\\cdot s/cm^{3}}$. We must ensure the units of flow are consistent. Since $1\\,\\mathrm{mL} = 1\\,\\mathrm{cm^{3}}$, the flow rates are already in the correct volumetric unit:\n- $Q_{L}^{(\\mathrm{uni})} = 210\\,\\mathrm{cm^3/s}$\n- $Q_{R}^{(\\mathrm{uni})} = 90\\,\\mathrm{cm^3/s}$\n\nFirst, we calculate the sum of the unilateral flows:\n$$\nQ_{L}^{(\\mathrm{uni})} + Q_{R}^{(\\mathrm{uni})} = 210\\,\\mathrm{cm^3/s} + 90\\,\\mathrm{cm^3/s} = 300\\,\\mathrm{cm^3/s}\n$$\nNow, we substitute the values into the derived expression for $R_T$:\n$$\nR_T = \\frac{150\\,\\mathrm{Pa}}{300\\,\\mathrm{cm^3/s}} = 0.5\\,\\mathrm{Pa\\cdot s/cm^3}\n$$\nThe problem requires the result to be rounded to three significant figures.\n$$\nR_T = 0.500\\,\\mathrm{Pa\\cdot s/cm^3}\n$$", "answer": "$$\n\\boxed{0.500}\n$$", "id": "5050048"}, {"introduction": "While the linear resistance model is useful, real nasal airflow is more complex, involving both viscous and inertial forces. This practice [@problem_id:5050081] introduces a more accurate, non-linear pressure-flow model (the Forchheimer equation) to describe the distinct aerodynamic behaviors of the congested and decongested nasal passages. By solving for the flow distribution at a given pressure, you will gain a deeper understanding of how the nasal cycle dynamically partitions airflow between the two sides.", "problem": "A patient undergoing active anterior rhinomanometry at rest is measured during a specific phase of the nasal cycle when the left side is relatively decongested and the right side is relatively congested. For each side, the measured relationship between transnasal pressure drop and volumetric flow is well approximated by a viscous–inertial (Forchheimer-type) fit, consistent with the combination of laminar viscous losses and form/inertial losses in intranasal passages. Specifically, the side-specific relationships are given by\n$$\\Delta P_L(Q_L) = a_L\\,Q_L + b_L\\,Q_L^{2},\\qquad \\Delta P_R(Q_R) = a_R\\,Q_R + b_R\\,Q_R^{2},$$\nwhere $\\Delta P_L$ and $\\Delta P_R$ are the pressure drops across the left and right nasal passages, and $Q_L$ and $Q_R$ are the corresponding unilateral volumetric flow rates. The measured fit parameters for this patient are\n$$a_L = 120\\ \\text{Pa}\\cdot \\text{s}\\cdot \\text{L}^{-1},\\quad b_L = 600\\ \\text{Pa}\\cdot \\text{s}^{2}\\cdot \\text{L}^{-2},$$\n$$a_R = 240\\ \\text{Pa}\\cdot \\text{s}\\cdot \\text{L}^{-1},\\quad b_R = 700\\ \\text{Pa}\\cdot \\text{s}^{2}\\cdot \\text{L}^{-2}.$$\nAssume steady, incompressible flow of air at room conditions and that the nasal cavities act as two parallel conduits between the same upstream and downstream compartments, so that the transnasal pressure drop is the same across both sides under simultaneous breathing. At a transnasal pressure drop of $\\Delta P^{\\ast} = 45\\ \\text{Pa}$, determine the flow partition ratio $Q_L/Q_R$. Express $Q_L$ and $Q_R$ in liters per second, and report the final ratio $Q_L/Q_R$ as a dimensionless number. Round your answer to four significant figures.", "solution": "The problem is first subjected to validation.\n\nStep 1: Extract Givens\nThe relationships between transnasal pressure drop ($\\Delta P$) and volumetric flow rate ($Q$) for the left (L) and right (R) nasal passages are given by Forchheimer-type equations:\n$$\n\\Delta P_L(Q_L) = a_L\\,Q_L + b_L\\,Q_L^{2}\n$$\n$$\n\\Delta P_R(Q_R) = a_R\\,Q_R + b_R\\,Q_R^{2}\n$$\nThe measured fit parameters are:\n$$\na_L = 120\\ \\text{Pa}\\cdot \\text{s}\\cdot \\text{L}^{-1}\n$$\n$$\nb_L = 600\\ \\text{Pa}\\cdot \\text{s}^{2}\\cdot \\text{L}^{-2}\n$$\n$$\na_R = 240\\ \\text{Pa}\\cdot \\text{s}\\cdot \\text{L}^{-1}\n$$\n$$\nb_R = 700\\ \\text{Pa}\\cdot \\text{s}^{2}\\cdot \\text{L}^{-2}\n$$\nThe problem states that the nasal cavities act as two parallel conduits, which implies the transnasal pressure drop is the same across both sides: $\\Delta P_L = \\Delta P_R$.\nThe specific transnasal pressure drop for the calculation is $\\Delta P^{\\ast} = 45\\ \\text{Pa}$.\nThe final answer for the ratio $Q_L/Q_R$ should be rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The use of a Forchheimer-type (or Rohrer's) equation to model pressure-flow relationships in the nasal passages is a standard and well-accepted practice in biomedical engineering and otolaryngology research. The concept of the nasal cycle and modeling the nasal cavities as parallel conduits are also standard physiological and biofluid-mechanical principles. The provided parameter values and pressure drop are within physically realistic ranges for human nasal breathing at rest.\nThe problem is well-posed. For a given positive pressure drop $\\Delta P^*$, each equation is a quadratic equation in the flow rate $Q$. These equations each yield a unique, positive, real solution for $Q$, which is a physically meaningful flow rate.\nThe problem is objective and self-contained, with all necessary data and conditions provided. The units are consistent.\nNo flaws are identified in the categories of Scientific or Factual Unsoundness, Non-Formalizable or Irrelevant, Incomplete or Contradictory Setup, Unrealistic or Infeasible, Ill-Posed or Poorly Structured, Pseudo-Profound/Trivial/Tautological, or Outside Scientific Verifiability.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe core physical principle is that the nasal passages act as parallel flow conduits. Therefore, at any instant, the pressure drop across the left passage, $\\Delta P_L$, must be equal to the pressure drop across the right passage, $\\Delta P_R$. The problem specifies that this common pressure drop is $\\Delta P^{\\ast} = 45\\ \\text{Pa}$.\nWe must solve for the flow rates $Q_L$ and $Q_R$ on each side under this condition.\n\nFor the left nasal passage, we have:\n$$\n\\Delta P_L(Q_L) = a_L Q_L + b_L Q_L^2 = \\Delta P^{\\ast}\n$$\nSubstituting the given values:\n$$\n120\\,Q_L + 600\\,Q_L^2 = 45\n$$\nThis is a quadratic equation for $Q_L$. We can rewrite it in the standard form $Ax^2 + Bx + C = 0$:\n$$\n600\\,Q_L^2 + 120\\,Q_L - 45 = 0\n$$\nWe solve for $Q_L$ using the quadratic formula, $Q_L = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$, where $A=600$, $B=120$, and $C=-45$.\n$$\nQ_L = \\frac{-120 \\pm \\sqrt{120^2 - 4(600)(-45)}}{2(600)}\n$$\n$$\nQ_L = \\frac{-120 \\pm \\sqrt{14400 + 108000}}{1200}\n$$\n$$\nQ_L = \\frac{-120 \\pm \\sqrt{122400}}{1200}\n$$\nSince the volumetric flow rate $Q_L$ must be a positive physical quantity, we take the positive root:\n$$\nQ_L = \\frac{-120 + \\sqrt{122400}}{1200} \\ \\text{L}\\cdot\\text{s}^{-1}\n$$\nCalculating the numerical value:\n$$\nQ_L \\approx \\frac{-120 + 349.8571}{1200} \\approx \\frac{229.8571}{1200} \\approx 0.1915476\\ \\text{L}\\cdot\\text{s}^{-1}\n$$\n\nFor the right nasal passage, we follow the same procedure:\n$$\n\\Delta P_R(Q_R) = a_R Q_R + b_R Q_R^2 = \\Delta P^{\\ast}\n$$\nSubstituting the given values:\n$$\n240\\,Q_R + 700\\,Q_R^2 = 45\n$$\nRewriting in standard quadratic form:\n$$\n700\\,Q_R^2 + 240\\,Q_R - 45 = 0\n$$\nWe solve for $Q_R$ using the quadratic formula with $A=700$, $B=240$, and $C=-45$.\n$$\nQ_R = \\frac{-240 \\pm \\sqrt{240^2 - 4(700)(-45)}}{2(700)}\n$$\n$$\nQ_R = \\frac{-240 \\pm \\sqrt{57600 + 126000}}{1400}\n$$\n$$\nQ_R = \\frac{-240 \\pm \\sqrt{183600}}{1400}\n$$\nAgain, we select the physically meaningful positive root:\n$$\nQ_R = \\frac{-240 + \\sqrt{183600}}{1400} \\ \\text{L}\\cdot\\text{s}^{-1}\n$$\nCalculating the numerical value:\n$$\nQ_R \\approx \\frac{-240 + 428.4857}{1400} \\approx \\frac{188.4857}{1400} \\approx 0.1346326\\ \\text{L}\\cdot\\text{s}^{-1}\n$$\nThe problem asks for the flow partition ratio $Q_L/Q_R$.\n$$\n\\frac{Q_L}{Q_R} \\approx \\frac{0.1915476}{0.1346326} \\approx 1.422750\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\n\\frac{Q_L}{Q_R} \\approx 1.423\n$$\nThis ratio is dimensionless, as expected. The higher flow on the left side is consistent with it being the \"decongested\" side, which has lower resistance-related coefficients ($a_L < a_R$ and $b_L < b_R$).", "answer": "$$\n\\boxed{1.423}\n$$", "id": "5050081"}, {"introduction": "Moving beyond lumped-parameter models, this advanced practice guides you through the construction of a multi-segment computational model to explore the spatial distribution of forces within the nasal cavity. You will calculate wall shear stress ($\\tau_w$) along a modeled nasal passage and correlate this fundamental biomechanical stimulus with key physiological responses, such as mechanosensation and mucociliary clearance [@problem_id:5050010]. This exercise exemplifies how computational methods can be used to investigate the complex interplay between nasal airflow physics and mucosal physiology.", "problem": "You are tasked with constructing a principled computational model of nasal airflow within the turbinate region to estimate spatial distributions of wall shear stress and to relate these distributions to mechanosensory stimulation and mucociliary transport. Your program must implement a pipeline that starts from fundamental fluid mechanical and physiological principles and produces quantitative outputs for a provided test suite.\n\nUse the following fundamental base and core definitions:\n\n- Assume air behaves as a Newtonian fluid with dynamic viscosity $\\mu$ and density $\\rho$, and that inspiratory flow in the turbinate passages is steady, incompressible, and predominantly laminar. The nasal lumen is modeled as a series of $N$ short internal-flow segments with local cross-sectional area $A_i$ and wetted perimeter $P_i$; the hydraulic diameter is $D_{h,i} = \\dfrac{4 A_i}{P_i}$.\n- Define the bulk mean velocity in segment $i$ as $U_i = \\dfrac{Q}{A_i}$, where $Q$ is the volumetric flow rate assumed constant along the series.\n- Define the Reynolds number for segment $i$ as $\\mathrm{Re}_i = \\dfrac{\\rho U_i D_{h,i}}{\\mu}$.\n- Use the Darcy–Weisbach (friction) formulation for internal flow. For laminar flow in ducts, the Darcy friction factor satisfies $f_{D,i} = \\dfrac{64}{\\mathrm{Re}_i}$. To ensure coverage beyond purely laminar regimes, for segments where $\\mathrm{Re}_i > 2000$, use a turbulent approximation $f_{D,i} = \\dfrac{0.3164}{\\mathrm{Re}_i^{0.25}}$.\n- The wall shear stress in segment $i$ is related to the friction factor by $\\tau_{w,i} = \\dfrac{f_{D,i} \\, \\rho \\, U_i^2}{8}$.\n- Model mechanosensory activation as occurring where $\\tau_{w,i}$ exceeds a threshold $\\tau_{\\mathrm{th}}$. The activated fraction is the arc-length fraction where $\\tau_{w,i} \\ge \\tau_{\\mathrm{th}}$.\n- Model mucociliary transport speed with a saturating Hill-type relation $v_{\\mathrm{muc},i} = v_{\\max} \\, \\dfrac{\\tau_{w,i}^{n}}{\\tau_{w,i}^{n} + \\tau_{50}^{n}}$.\n\nExplicit nasal cycle congestion is modeled by modifying the baseline geometry according to a congestion factor $c \\in [0,1]$:\n- $A_i(c) = A_{0,i} \\, \\left(1 - k_A \\, c \\right)$,\n- $P_i(c) = P_{0,i} \\, \\left(1 + k_P \\, c \\right)$,\nwhere $A_{0,i}$ and $P_{0,i}$ are baseline area and perimeter, and $k_A$ and $k_P$ are dimensionless sensitivity coefficients.\n\nUse the following scientifically plausible constants and baseline geometry:\n- Air density $\\rho = 1.12 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$ at $37\\,^{\\circ}\\mathrm{C}$ (nasal air temperature).\n- Dynamic viscosity $\\mu = 1.9 \\times 10^{-5} \\,\\mathrm{Pa}\\,\\mathrm{s}$.\n- Mucociliary parameters: $v_{\\max} = 2.0 \\times 10^{-4} \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\tau_{50} = 0.25 \\,\\mathrm{Pa}$, $n = 2$.\n- Mechanosensory threshold: $\\tau_{\\mathrm{th}} = 0.25 \\,\\mathrm{Pa}$.\n- Congestion sensitivities: $k_A = 0.5$, $k_P = 0.15$.\n- Number of segments $N = 10$, each of length $\\Delta s = 0.008 \\,\\mathrm{m}$ (total path length $L = N \\, \\Delta s$).\n- Baseline cross-sectional areas (in $\\mathrm{m}^2$): $A_{0,i} \\in \\{3.0 \\times 10^{-5}, 3.5 \\times 10^{-5}, 4.0 \\times 10^{-5}, 4.5 \\times 10^{-5}, 5.0 \\times 10^{-5}, 5.5 \\times 10^{-5}, 5.0 \\times 10^{-5}, 4.5 \\times 10^{-5}, 4.0 \\times 10^{-5}, 3.5 \\times 10^{-5}\\}$.\n- Baseline perimeters (in $\\mathrm{m}$): $P_{0,i} \\in \\{5.0 \\times 10^{-2}, 5.2 \\times 10^{-2}, 5.4 \\times 10^{-2}, 5.6 \\times 10^{-2}, 5.8 \\times 10^{-2}, 6.0 \\times 10^{-2}, 5.8 \\times 10^{-2}, 5.6 \\times 10^{-2}, 5.4 \\times 10^{-2}, 5.2 \\times 10^{-2}\\}$.\n\nYour program must, for each test case, compute:\n1. The distribution $\\tau_{w,i}$ along the $N$ segments,\n2. The distribution $v_{\\mathrm{muc},i}$ along the $N$ segments,\n3. The maximum wall shear stress $\\max_i \\tau_{w,i}$ in $\\mathrm{Pa}$,\n4. The activated arc-length fraction $\\dfrac{\\sum_{i=1}^{N} \\mathbf{1}_{\\{\\tau_{w,i} \\ge \\tau_{\\mathrm{th}}\\}} \\, \\Delta s}{L}$, expressed as a decimal,\n5. The mean mucociliary transport speed $\\dfrac{\\sum_{i=1}^{N} v_{\\mathrm{muc},i} \\, \\Delta s}{L}$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n6. The Pearson correlation coefficient (dimensionless) between $\\{\\tau_{w,i}\\}$ and $\\{v_{\\mathrm{muc},i}\\}$ across segments.\n\nTest Suite:\nUse the following three test cases spanning a happy path, a low-flow boundary, and a high-flow with severe congestion edge case. Each case provides the volumetric flow rate $Q$ in $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$ and congestion factor $c$:\n- Case $1$: $Q = 1.0 \\times 10^{-4}$, $c = 0.2$,\n- Case $2$: $Q = 2.0 \\times 10^{-5}$, $c = 0.0$,\n- Case $3$: $Q = 4.0 \\times 10^{-4}$, $c = 0.5$.\n\nAnswer Units and Output Specification:\n- Express the maximum wall shear stress in $\\mathrm{Pa}$, the activated fraction as a decimal in $[0,1]$, the mean mucociliary speed in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, and the Pearson correlation coefficient as a decimal in $[-1,1]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each per-test-case result must itself be a list in the order $[\\text{max\\_tau\\_Pa}, \\text{activated\\_fraction}, \\text{mean\\_v\\_mps}, \\text{pearson\\_r}]$. For example: $[[x_1,y_1,z_1,r_1],[x_2,y_2,z_2,r_2],[x_3,y_3,z_3,r_3]]$.", "solution": "The problem is deemed valid as it is scientifically grounded in established principles of fluid mechanics and biophysics, is well-posed with all necessary information provided, and is expressed in objective, formal language. The provided constants and parameters are physically plausible. The task is to construct and apply a computational model of nasal airflow to a set of test cases.\n\nThe modeling process is a sequential pipeline of calculations for each of the $N=10$ nasal segments. For a given test case defined by volumetric flow rate $Q$ and congestion factor $c$, the following steps are executed for each segment $i \\in \\{0, 1, \\dots, N-1\\}$.\n\nFirst, we define the physical constants and baseline geometric parameters.\n- Air density at $37\\,^{\\circ}\\mathrm{C}$: $\\rho = 1.12 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- Air dynamic viscosity: $\\mu = 1.9 \\times 10^{-5} \\,\\mathrm{Pa}\\,\\mathrm{s}$\n- Mucociliary transport parameters: $v_{\\max} = 2.0 \\times 10^{-4} \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\tau_{50} = 0.25 \\,\\mathrm{Pa}$, $n = 2$\n- Mechanosensory activation threshold: $\\tau_{\\mathrm{th}} = 0.25 \\,\\mathrm{Pa}$\n- Congestion sensitivity coefficients: $k_A = 0.5$, $k_P = 0.15$\n- Segment length: $\\Delta s = 0.008 \\,\\mathrm{m}$\n- Total number of segments: $N = 10$, giving a total path length $L = N \\Delta s = 0.08 \\,\\mathrm{m}$\n- Baseline cross-sectional areas (in $\\mathrm{m}^2$): $A_{0,i} = \\{3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 5.0, 4.5, 4.0, 3.5\\} \\times 10^{-5}$\n- Baseline perimeters (in $\\mathrm{m}$): $P_{0,i} = \\{5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 5.8, 5.6, 5.4, 5.2\\} \\times 10^{-2}$\n\nThe procedural steps for each segment $i$ are:\n\n1.  **Compute Congestion-Modified Geometry**: The cross-sectional area $A_i(c)$ and wetted perimeter $P_i(c)$ are adjusted from their baseline values $A_{0,i}$ and $P_{0,i}$ based on the congestion factor $c$.\n    $$A_i(c) = A_{0,i} \\, (1 - k_A \\, c)$$\n    $$P_i(c) = P_{0,i} \\, (1 + k_P \\, c)$$\n\n2.  **Calculate Hydraulic Diameter**: The hydraulic diameter $D_{h,i}$ for each segment is computed from its adjusted geometry.\n    $$D_{h,i} = \\frac{4 A_i(c)}{P_i(c)}$$\n\n3.  **Determine Bulk Mean Velocity**: The mean velocity $U_i$ in each segment is determined by the constant volumetric flow rate $Q$ and the local cross-sectional area $A_i(c)$.\n    $$U_i = \\frac{Q}{A_i(c)}$$\n\n4.  **Calculate Reynolds Number**: The Reynolds number $\\mathrm{Re}_i$ characterizes the flow regime in each segment.\n    $$\\mathrm{Re}_i = \\frac{\\rho U_i D_{h,i}}{\\mu}$$\n\n5.  **Determine Darcy Friction Factor**: The Darcy friction factor $f_{D,i}$ is calculated based on the Reynolds number. A conditional logic is applied to distinguish between laminar and turbulent flow regimes, with a threshold at $\\mathrm{Re} = 2000$.\n    $$f_{D,i} = \\begin{cases} \\dfrac{64}{\\mathrm{Re}_i} & \\text{if } \\mathrm{Re}_i \\le 2000 \\\\ \\dfrac{0.3164}{\\mathrm{Re}_i^{0.25}} & \\text{if } \\mathrm{Re}_i > 2000 \\end{cases}$$\n\n6.  **Calculate Wall Shear Stress**: The wall shear stress $\\tau_{w,i}$ is a key biomechanical quantity derived from the friction factor and local flow dynamics.\n    $$\\tau_{w,i} = \\frac{f_{D,i} \\, \\rho \\, U_i^2}{8}$$\n\n7.  **Calculate Mucociliary Transport Speed**: The mucociliary transport speed $v_{\\mathrm{muc},i}$ is modeled as a function of the wall shear stress using a Hill-type equation, representing a saturating physiological response.\n    $$v_{\\mathrm{muc},i} = v_{\\max} \\, \\frac{\\tau_{w,i}^{n}}{\\tau_{w,i}^{n} + \\tau_{50}^{n}}$$\n\nAfter computing the distributions $\\{\\tau_{w,i}\\}$ and $\\{v_{\\mathrm{muc},i}\\}$ across all $N$ segments, the following four aggregate metrics are calculated:\n\n1.  **Maximum Wall Shear Stress**: The peak stress experienced along the nasal passage.\n    $$\\max_i \\tau_{w,i}$$\n\n2.  **Activated Arc-Length Fraction**: The fraction of the total path length where the wall shear stress exceeds the mechanosensory threshold $\\tau_{\\mathrm{th}}$. Since $\\Delta s$ is constant, this simplifies to the fraction of segments meeting the criterion.\n    $$\\text{Activated Fraction} = \\frac{\\sum_{i=0}^{N-1} \\mathbf{1}_{\\{\\tau_{w,i} \\ge \\tau_{\\mathrm{th}}\\}} \\, \\Delta s}{L} = \\frac{\\text{count}(\\tau_{w,i} \\ge \\tau_{\\mathrm{th}})}{N}$$\n    where $\\mathbf{1}_{\\{\\cdot\\}}$ is the indicator function.\n\n3.  **Mean Mucociliary Transport Speed**: The length-weighted average of the transport speed. As $\\Delta s$ is constant, this is the arithmetic mean.\n    $$\\text{Mean Speed} = \\frac{\\sum_{i=0}^{N-1} v_{\\mathrm{muc},i} \\, \\Delta s}{L} = \\frac{1}{N} \\sum_{i=0}^{N-1} v_{\\mathrm{muc},i}$$\n\n4.  **Pearson Correlation Coefficient**: A statistical measure of the linear correlation between the wall shear stress distribution $\\{\\tau_{w,i}\\}$ and the mucociliary speed distribution $\\{v_{\\mathrm{muc},i}\\}$. It is calculated as:\n    $$r = \\frac{\\sum_{i=0}^{N-1} (\\tau_{w,i} - \\bar{\\tau}_w)(v_{\\mathrm{muc},i} - \\bar{v}_{\\mathrm{muc}})}{\\sqrt{\\sum_{i=0}^{N-1} (\\tau_{w,i} - \\bar{\\tau}_w)^2} \\sqrt{\\sum_{i=0}^{N-1} (v_{\\mathrm{muc},i} - \\bar{v}_{\\mathrm{muc}})^2}}$$\n    where $\\bar{\\tau}_w$ and $\\bar{v}_{\\mathrm{muc}}$ are the mean values of the respective distributions.\n\nThis entire procedure is applied to each of the three test cases provided in the problem statement to generate the final results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and applies a computational model of nasal airflow to estimate\n    wall shear stress and related physiological quantities.\n    \"\"\"\n    # Define scientifically plausible constants and parameters\n    RHO = 1.12  # Air density at 37 C (kg/m^3)\n    MU = 1.9e-5  # Air dynamic viscosity (Pa*s)\n    V_MAX = 2.0e-4  # Max mucociliary transport speed (m/s)\n    TAU_50 = 0.25  # Hill equation saturation constant (Pa)\n    N_HILL = 2.0  # Hill coefficient\n    TAU_TH = 0.25  # Mechanosensory threshold (Pa)\n    K_A = 0.5  # Congestion sensitivity for area (dimensionless)\n    K_P = 0.15  # Congestion sensitivity for perimeter (dimensionless)\n\n    # Define baseline geometry\n    N_SEGMENTS = 10\n    DS = 0.008  # Length of each segment (m)\n    L_TOTAL = N_SEGMENTS * DS  # Total path length (m)\n\n    A0_i = np.array([\n        3.0e-5, 3.5e-5, 4.0e-5, 4.5e-5, 5.0e-5,\n        5.5e-5, 5.0e-5, 4.5e-5, 4.0e-5, 3.5e-5\n    ])  # Baseline cross-sectional areas (m^2)\n\n    P0_i = np.array([\n        5.0e-2, 5.2e-2, 5.4e-2, 5.6e-2, 5.8e-2,\n        6.0e-2, 5.8e-2, 5.6e-2, 5.4e-2, 5.2e-2\n    ])  # Baseline perimeters (m)\n\n    # Define the test suite\n    test_cases = [\n        # (Q: volumetric flow rate m^3/s, c: congestion factor)\n        (1.0e-4, 0.2),  # Case 1: Happy path\n        (2.0e-5, 0.0),  # Case 2: Low-flow boundary\n        (4.0e-4, 0.5),  # Case 3: High-flow, severe congestion edge case\n    ]\n\n    all_results = []\n\n    for q_flow, c_factor in test_cases:\n        # 1. Compute Congestion-Modified Geometry\n        a_i = A0_i * (1 - K_A * c_factor)\n        p_i = P0_i * (1 - K_P * c_factor)\n\n        # 2. Calculate Hydraulic Diameter\n        d_h_i = (4 * a_i) / p_i\n\n        # 3. Determine Bulk Mean Velocity\n        u_i = q_flow / a_i\n\n        # 4. Calculate Reynolds Number\n        re_i = (RHO * u_i * d_h_i) / MU\n\n        # 5. Determine Darcy Friction Factor\n        # Using np.where for conditional logic based on Re\n        f_d_i = np.where(re_i <= 2000,\n                         64 / re_i,\n                         0.3164 / (re_i**0.25))\n\n        # 6. Calculate Wall Shear Stress\n        tau_w_i = (f_d_i * RHO * u_i**2) / 8\n\n        # 7. Calculate Mucociliary Transport Speed\n        v_muc_i = V_MAX * (tau_w_i**N_HILL) / (tau_w_i**N_HILL + TAU_50**N_HILL)\n\n        # ----- Compute Aggregate Metrics -----\n\n        # Metric 1: Maximum wall shear stress\n        max_tau_pa = np.max(tau_w_i)\n\n        # Metric 2: Activated arc-length fraction\n        activated_segments = np.sum(tau_w_i >= TAU_TH)\n        activated_fraction = activated_segments / N_SEGMENTS\n\n        # Metric 3: Mean mucociliary transport speed\n        mean_v_mps = np.mean(v_muc_i)\n\n        # Metric 4: Pearson correlation coefficient between tau_w and v_muc\n        # np.corrcoef returns a 2x2 matrix, we need the off-diagonal element\n        if np.std(tau_w_i) == 0 or np.std(v_muc_i) == 0:\n            # Handle case of zero standard deviation to avoid NaN\n            pearson_r = 1.0 if np.std(tau_w_i) == np.std(v_muc_i) else 0.0\n        else:\n            pearson_r = np.corrcoef(tau_w_i, v_muc_i)[0, 1]\n\n        # Collate results for the current test case\n        case_results = [max_tau_pa, activated_fraction, mean_v_mps, pearson_r]\n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    # The f-string formatting automatically handles standard representation of floats\n    output_str = f\"[\"\n    for i, res in enumerate(all_results):\n        output_str += f\"[{','.join(map(str, res))}]\"\n        if i < len(all_results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "5050010"}]}