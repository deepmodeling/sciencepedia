{"hands_on_practices": [{"introduction": "Our journey into the mechanics of hearing begins at the interface with the acoustic world: the middle ear. This first practice provides a foundational exercise in applying the principles of classical mechanics to model a key component, the tympanic membrane (TM). By treating the TM as an idealized circular membrane, you will derive its fundamental resonant frequency from first principles, a process that connects wave physics to auditory function [@problem_id:5007416]. This hands-on modeling exercise demonstrates how powerful, yet simplified, physical models can yield valuable predictions about the behavior of biological structures.", "problem": "An idealized model of the human Tympanic Membrane (TM) treats it as a thin, isotropic, circular, clamped membrane with uniform in-plane tension. Let the transverse displacement be $u(r,\\theta,t)$ on a domain of radius $a$, with uniform tension per unit length $T$ and uniform surface mass density $\\rho$ (mass per unit area). Starting from Newton’s second law applied to an infinitesimal membrane element and the definition of wave speed on a stretched membrane, derive the governing two-dimensional wave equation and from it obtain the expression for the fundamental (lowest) resonance frequency of a circular clamped membrane in terms of the first zero of the Bessel function of the first kind of order zero. Using this expression, compute the model-predicted fundamental resonance frequency for the TM with parameters $T = 20 \\ \\text{N/m}$, $\\rho = 0.10 \\ \\text{kg/m}^{2}$, and $a = 4.0 \\ \\text{mm}$, and compare it to a measured human mean fundamental of $f_{\\text{meas}} = 1.20 \\ \\text{kHz}$. Report the fractional deviation $\\delta = \\dfrac{f_{\\text{model}} - f_{\\text{meas}}}{f_{\\text{meas}}}$ as a pure decimal (dimensionless). Use the known numerical value of the first zero of $J_{0}$, namely $\\alpha_{01} \\approx 2.404825558$. Round your final reported $\\delta$ to four significant figures. Express the intermediate frequency in $\\text{Hz}$ if needed, but the final requested quantity $\\delta$ is dimensionless.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in classical mechanics and mathematical physics, well-posed with all necessary information provided, and objective in its formulation. The problem asks for the derivation of a standard physical model and a subsequent calculation based on provided parameters, which is a legitimate scientific exercise.\n\nThe problem asks for the derivation of the governing wave equation for a circular membrane, the solution for its fundamental frequency, and a numerical calculation.\n\n**1. Derivation of the 2D Wave Equation**\n\nLet $u(r, \\theta, t)$ be the transverse displacement of the membrane from its equilibrium plane. We consider an infinitesimal element of the membrane with area $dA$. According to Newton's second law, the net restoring force on this element, $dF_z$, is equal to its mass $dm$ times its acceleration $a_z$.\nThe mass of the element is $dm = \\rho \\, dA$, where $\\rho$ is the uniform surface mass density. The acceleration is $a_z = \\frac{\\partial^2 u}{\\partial t^2}$.\nThe net restoring force is due to the uniform tension $T$ acting along the perimeter of the element. For small displacements, the net vertical force on the element $dA$ is given by $dF_z = T (\\nabla^2 u) \\, dA$, where $\\nabla^2$ is the two-dimensional Laplacian operator.\n\nApplying Newton's second law, $dF_z = (dm)a_z$:\n$$T (\\nabla^2 u) \\, dA = (\\rho \\, dA) \\frac{\\partial^2 u}{\\partial t^2}$$\nDividing by $dA$ and rearranging gives:\n$$\\nabla^2 u = \\frac{\\rho}{T} \\frac{\\partial^2 u}{\\partial t^2}$$\nThe problem states that the wave speed on the membrane is $c = \\sqrt{T/\\rho}$. Therefore, $\\frac{1}{c^2} = \\frac{\\rho}{T}$. Substituting this into the equation yields the two-dimensional wave equation:\n$$\\nabla^2 u = \\frac{1}{c^2} \\frac{\\partial^2 u}{\\partial t^2}$$\nIn polar coordinates $(r, \\theta)$, the Laplacian is $\\nabla^2 = \\frac{\\partial^2}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial}{\\partial r} + \\frac{1}{r^2} \\frac{\\partial^2}{\\partial \\theta^2}$. Thus, the governing equation in polar coordinates is:\n$$\\frac{\\partial^2 u}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial u}{\\partial r} + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2} = \\frac{1}{c^2} \\frac{\\partial^2 u}{\\partial t^2}$$\n\n**2. Solution for the Fundamental Frequency**\n\nWe seek normal mode solutions of the form $u(r, \\theta, t) = \\Psi(r, \\theta) \\cos(\\omega t + \\phi)$, or using complex notation, $u(r, \\theta, t) = \\text{Re}[\\Psi(r, \\theta) e^{i\\omega t}]$. Substituting this into the wave equation gives the time-independent Helmholtz equation for the spatial part $\\Psi(r, \\theta)$:\n$$\\nabla^2 \\Psi + k^2 \\Psi = 0$$\nwhere $k = \\omega/c$ is the wave number. We use the method of separation of variables for $\\Psi(r, \\theta) = R(r)\\Theta(\\theta)$. Substituting this into the Helmholtz equation and rearranging gives:\n$$\\frac{r^2}{R} \\left(\\frac{d^2 R}{dr^2} + \\frac{1}{r} \\frac{d R}{dr}\\right) + k^2 r^2 = -\\frac{1}{\\Theta} \\frac{d^2 \\Theta}{d\\theta^2}$$\nThe left side depends only on $r$ and the right side only on $\\theta$, so both must equal a constant, say $m^2$.\nThe angular equation is $\\frac{d^2 \\Theta}{d\\theta^2} + m^2 \\Theta = 0$. For the displacement to be single-valued, $\\Theta(\\theta)$ must be periodic with period $2\\pi$, which requires $m$ to be an integer ($m=0, 1, 2, \\dots$).\nThe radial equation is:\n$$r^2 \\frac{d^2 R}{dr^2} + r \\frac{d R}{dr} + (k^2 r^2 - m^2) R = 0$$\nThis is Bessel's differential equation. Its solutions are the Bessel functions of the first kind, $J_m(kr)$, and the second kind, $Y_m(kr)$. Since the displacement must remain finite at the center of the membrane ($r=0$), and $Y_m(kr)$ diverges as $r \\to 0$, we must discard this part of the solution. Thus, $R(r) = J_m(kr)$.\n\nThe fundamental resonance frequency is the lowest possible frequency of vibration. This corresponds to the simplest vibrational mode, which is radially symmetric and has no nodal circles other than the boundary. A radially symmetric mode has no angular dependence, so we set $m=0$.\nThe solution for the radial part is then $R(r) = J_0(kr)$.\n\nThe membrane is clamped at its edge $r=a$, which imposes the boundary condition $u(a, \\theta, t) = 0$ for all $\\theta$ and $t$. This requires $R(a)=0$.\n$$J_0(ka) = 0$$\nThis equation implies that the argument $ka$ must be a zero of the Bessel function of the first kind of order zero, $J_0(x)$. Let the positive zeros of $J_0(x)$ be denoted by $\\alpha_{0n}$, where $n=1, 2, 3, \\ldots$.\nThe fundamental mode corresponds to the first zero, $\\alpha_{01}$.\n$$ka = \\alpha_{01}$$\nSubstituting $k = \\frac{\\omega}{c} = \\frac{2\\pi f}{c}$, where $f$ is the frequency:\n$$\\frac{2\\pi f a}{c} = \\alpha_{01}$$\nSolving for the fundamental frequency, $f = f_{\\text{model}}$:\n$$f_{\\text{model}} = \\frac{\\alpha_{01} c}{2\\pi a}$$\nSubstituting the expression for the wave speed, $c = \\sqrt{T/\\rho}$:\n$$f_{\\text{model}} = \\frac{\\alpha_{01}}{2\\pi a} \\sqrt{\\frac{T}{\\rho}}$$\nThis is the required expression for the fundamental resonance frequency.\n\n**3. Numerical Calculation and Comparison**\n\nThe problem provides the following values:\n- Tension, $T = 20 \\ \\text{N/m}$\n- Surface mass density, $\\rho = 0.10 \\ \\text{kg/m}^2$\n- Radius, $a = 4.0 \\ \\text{mm} = 4.0 \\times 10^{-3} \\ \\text{m}$\n- First zero of $J_0(x)$, $\\alpha_{01} \\approx 2.404825558$\n- Measured frequency, $f_{\\text{meas}} = 1.20 \\ \\text{kHz} = 1200 \\ \\text{Hz}$\n\nFirst, we calculate the wave speed $c$:\n$$c = \\sqrt{\\frac{T}{\\rho}} = \\sqrt{\\frac{20 \\ \\text{N/m}}{0.10 \\ \\text{kg/m}^2}} = \\sqrt{200} \\ \\text{m/s} \\approx 14.1421356 \\ \\text{m/s}$$\nNext, we compute the model-predicted fundamental frequency, $f_{\\text{model}}$:\n$$f_{\\text{model}} = \\frac{\\alpha_{01}}{2\\pi a} c = \\frac{2.404825558}{2\\pi (4.0 \\times 10^{-3} \\ \\text{m})} \\sqrt{200} \\ \\text{m/s}$$\n$$f_{\\text{model}} \\approx \\frac{2.404825558}{0.02513274} \\times 14.1421356 \\ \\text{Hz} \\approx 95.6847 \\times 14.1421356 \\ \\text{Hz} \\approx 1353.190 \\ \\text{Hz}$$\nThe fractional deviation $\\delta$ is given by:\n$$\\delta = \\frac{f_{\\text{model}} - f_{\\text{meas}}}{f_{\\text{meas}}}$$\nSubstituting the calculated and given values:\n$$\\delta = \\frac{1353.190 \\ \\text{Hz} - 1200 \\ \\text{Hz}}{1200 \\ \\text{Hz}} = \\frac{153.190}{1200}$$\n$$\\delta \\approx 0.1276583$$\nRounding to four significant figures, we get:\n$$\\delta \\approx 0.1277$$\nThe positive value indicates that this idealized model overestimates the fundamental resonance frequency of the human tympanic membrane by approximately $12.8\\%$. This discrepancy is expected, as the real TM is not a simple uniform, circular, clamped membrane but has a more complex geometry (it is cone-shaped), non-uniform thickness, and is attached to the ossicles, which adds a complex impedance load.", "answer": "$$\\boxed{0.1277}$$", "id": "5007416"}, {"introduction": "Moving from the middle ear into the cochlea, we encounter its primary function: decomposing complex sounds into their constituent frequencies. This next practice simulates a core task in auditory research, which is to quantify the sharpness of the cochlea's frequency tuning from basilar membrane (BM) vibration data. By deriving the relationship between a resonator's quality factor ($Q$) and its bandwidth, and then applying it to a set of hypothetical measurements, you will gain a concrete understanding of how to characterize the cochlea's performance as a biological spectrum analyzer [@problem_id:5007420]. This exercise bridges theoretical concepts of resonance with practical data analysis.", "problem": "A laser Doppler vibrometry experiment measures the frequency-dependent peak displacement amplitude of the basilar membrane (BM) at a basal cochlear location whose best (center) frequency is near $f_c = 8.0\\,\\mathrm{kHz}$. The stimulus is a continuous sinusoid delivered at a fixed drive level, and the middle ear is assumed to transmit a constant stapes velocity amplitude across frequency within the narrow band of interest, so that the measured BM displacement as a function of frequency is proportional to the magnitude of the local linear transfer function. The data below list frequency $f$ and BM peak displacement amplitude $A(f)$ at that location:\n- $(f, A)$ in $(\\mathrm{kHz}, \\mathrm{nm})$: $(6.3, 10.0)$, $(7.1, 15.0)$, $(8.0, 20.0)$, $(9.0, 15.5)$, $(10.0, 12.0)$, with additional off-peak points $(5.6, 7.5)$, $(11.2, 9.0)$, $(12.5, 7.0)$ confirming monotonic decay on the flanks.\n\nAssume the following methodological model and approximations:\n- Within a narrow range around the maximum, the place-specific BM response can be modeled as a lightly damped, approximately second-order, linear time-invariant (LTI) resonator driven at angular frequency $\\omega = 2\\pi f$ with natural angular frequency $\\omega_0 = 2\\pi f_c$ and quality factor $Q$.\n- The half-power points are defined by frequencies $f_1$ and $f_2$ at which the amplitude satisfies $A(f_{1,2}) = A_{\\max}/\\sqrt{2}$, where $A_{\\max} = \\max_f A(f)$.\n- Between adjacent measured frequencies, $A$ varies approximately linearly with $\\ln f$ (log-frequency interpolation), reflecting the near-constant slope of the tuning curve in logarithmic frequency around the peak for a lightly damped resonator.\n\nTasks:\n1) Starting from the standard second-order resonator magnitude near resonance and the half-power definition, derive an expression for the quality factor $Q$ in terms of the center frequency $f_c$ and the half-power bandwidth $\\mathrm{BW} = f_2 - f_1$. Your derivation must begin with fundamental definitions for a lightly damped second-order LTI system and the half-power criterion and proceed to an expression that relates $Q$ to $f_c$ and $\\mathrm{BW}$ without assuming that relation a priori.\n\n2) Using the provided BM displacement data and the log-frequency interpolation assumption, estimate $f_1$ and $f_2$, compute $\\mathrm{BW}$, and then compute $Q$ at this location using your derived expression. Treat $f_c$ as the frequency at which $A(f)$ attains its maximum within the measured set. Round your final numeric value of $Q$ to $4$ significant figures. Express the final answer as a pure number (dimensionless).", "solution": "We proceed in two parts: first deriving the expression relating the quality factor to center frequency and half-power bandwidth for a lightly damped second-order linear time-invariant (LTI) resonator, and then estimating the half-power bandwidth from the basilar membrane (BM) displacement data using the specified interpolation method.\n\nPart $1$: Derivation of $Q$ in terms of $f_c$ and $\\mathrm{BW}$.\n\n- Fundamental model: Near a single resonance, the place-specific BM response magnitude can be approximated by a second-order LTI resonator. Let the angular frequency be $\\omega = 2\\pi f$, the resonant angular frequency be $\\omega_0 = 2\\pi f_c$, and the quality factor be $Q$. A standard nondimensionalized magnitude-squared response for a lightly damped second-order system is\n$$\n|H(\\mathrm{j}\\omega)|^2 \\propto \\frac{1}{\\left(1 - \\left(\\frac{\\omega}{\\omega_0}\\right)^2\\right)^2 + \\left(\\frac{\\omega}{Q\\,\\omega_0}\\right)^2}.\n$$\n- For a lightly damped system, the maximum magnitude occurs near $\\omega \\approx \\omega_0$. Define the nondimensional frequency ratio $r = \\omega/\\omega_0$ and consider small deviations near the peak by writing $r = 1 + \\delta$ with $|\\delta| \\ll 1$. Then the denominator around $r \\approx 1$ can be expanded to leading order:\n$$\n1 - r^2 = 1 - (1 + \\delta)^2 = -2\\delta - \\delta^2 \\approx -2\\delta,\n$$\nand $r \\approx 1$ in the damping term. Therefore, near resonance,\n$$\n\\left(1 - r^2\\right)^2 + \\left(\\frac{r}{Q}\\right)^2 \\approx (2\\delta)^2 + \\frac{1}{Q^2} = 4\\delta^2 + \\frac{1}{Q^2}.\n$$\n- The maximum magnitude occurs at $\\delta = 0$, with denominator approximately $\\frac{1}{Q^2}$. The half-power criterion states that the magnitude-squared at the half-power points equals one-half of the peak magnitude-squared. Because the magnitude-squared is inversely proportional to the denominator, the half-power condition doubles the denominator relative to its value at the peak. Thus at the half-power points,\n$$\n4\\delta^2 + \\frac{1}{Q^2} = \\frac{2}{Q^2} \\quad \\Rightarrow \\quad 4\\delta^2 = \\frac{1}{Q^2} \\quad \\Rightarrow \\quad \\delta = \\pm \\frac{1}{2Q}.\n$$\n- The corresponding half-power angular frequencies are $\\omega_{1,2} = \\omega_0(1 \\pm \\frac{1}{2Q})$ to first order in small damping. Therefore, the half-power bandwidth in angular frequency is\n$$\n\\Delta \\omega \\equiv \\omega_2 - \\omega_1 \\approx \\omega_0\\left(1 + \\frac{1}{2Q}\\right) - \\omega_0\\left(1 - \\frac{1}{2Q}\\right) = \\frac{\\omega_0}{Q}.\n$$\n- Converting to ordinary frequency using $\\omega = 2\\pi f$ gives $\\Delta \\omega = 2\\pi \\Delta f$ and $\\omega_0 = 2\\pi f_c$, so\n$$\n2\\pi\\,\\mathrm{BW} = \\frac{2\\pi f_c}{Q} \\quad \\Rightarrow \\quad Q = \\frac{f_c}{\\mathrm{BW}},\n$$\nwhere $\\mathrm{BW} = f_2 - f_1$ is the half-power bandwidth. This is the desired relation under the lightly damped, near-resonance approximation.\n\nPart $2$: Estimation of $\\mathrm{BW}$ from BM displacement data and computation of $Q$.\n\n- Identify the maximum amplitude. From the data, the largest reported BM displacement amplitude is at $f = 8.0\\,\\mathrm{kHz}$ with $A = 20.0\\,\\mathrm{nm}$. Therefore $f_c = 8.0\\,\\mathrm{kHz}$ and\n$$\nA_{\\max} = 20.0\\,\\mathrm{nm}, \\qquad A_{\\text{half}} = \\frac{A_{\\max}}{\\sqrt{2}} = \\frac{20.0}{\\sqrt{2}}\\,\\mathrm{nm} = 14.14213562\\,\\mathrm{nm}.\n$$\n- Define the half-power frequencies $f_1$ (lower) and $f_2$ (upper) by $A(f_{1,2}) = A_{\\text{half}}$, and apply the assumption that $A$ varies linearly with $\\ln f$ between adjacent measured points.\n\nLower half-power frequency $f_1$:\n- On the lower side of the peak, the amplitudes bracket $A_{\\text{half}}$ between $(f, A) = (6.3\\,\\mathrm{kHz}, 10.0\\,\\mathrm{nm})$ and $(7.1\\,\\mathrm{kHz}, 15.0\\,\\mathrm{nm})$. Let $x = \\ln f$. Interpolate linearly in $x$:\n$$\nx_1 = \\ln(6.3), \\quad x_2 = \\ln(7.1), \\quad A_1 = 10.0, \\quad A_2 = 15.0.\n$$\nLet $t_{\\mathrm{L}} = \\dfrac{A_{\\text{half}} - A_1}{A_2 - A_1} = \\dfrac{14.14213562 - 10.0}{5.0} = 0.828427124.$ Then\n$$\nx_{\\mathrm{L}} = x_1 + t_{\\mathrm{L}}(x_2 - x_1) = \\ln(6.3) + 0.828427124\\left[\\ln(7.1) - \\ln(6.3)\\right].\n$$\nNumerically,\n$$\n\\ln(6.3) = 1.840549633,\\quad \\ln(7.1) = 1.960094784,\\quad x_{\\mathrm{L}} = 1.840549633 + 0.828427124\\cdot 0.119545151 = 1.939583904,\n$$\nso\n$$\nf_1 = \\exp(x_{\\mathrm{L}}) = \\exp(1.939583904) = 6.95581\\,\\mathrm{kHz}.\n$$\n\nUpper half-power frequency $f_2$:\n- On the upper side, the amplitudes bracket $A_{\\text{half}}$ between $(f, A) = (9.0\\,\\mathrm{kHz}, 15.5\\,\\mathrm{nm})$ and $(10.0\\,\\mathrm{kHz}, 12.0\\,\\mathrm{nm})$. With $x = \\ln f$,\n$$\nx_1' = \\ln(9.0), \\quad x_2' = \\ln(10.0), \\quad A_1' = 15.5, \\quad A_2' = 12.0.\n$$\nLet $t_{\\mathrm{U}} = \\dfrac{A_{\\text{half}} - A_1'}{A_2' - A_1'} = \\dfrac{14.14213562 - 15.5}{12.0 - 15.5} = 0.38796125.$ Then\n$$\nx_{\\mathrm{U}} = x_1' + t_{\\mathrm{U}}(x_2' - x_1') = \\ln(9.0) + 0.38796125\\left[\\ln(10.0) - \\ln(9.0)\\right].\n$$\nNumerically,\n$$\n\\ln(9.0) = 2.197224577,\\quad \\ln(10.0) = 2.302585093,\\quad x_{\\mathrm{U}} = 2.197224577 + 0.38796125\\cdot 0.105360516 = 2.238100375,\n$$\nso\n$$\nf_2 = \\exp(x_{\\mathrm{U}}) = \\exp(2.238100375) = 9.37544\\,\\mathrm{kHz}.\n$$\n\n- Compute the half-power bandwidth and $Q$:\n$$\n\\mathrm{BW} = f_2 - f_1 = 9.37544\\,\\mathrm{kHz} - 6.95581\\,\\mathrm{kHz} = 2.41963\\,\\mathrm{kHz}.\n$$\nUsing the derived relation $Q = \\dfrac{f_c}{\\mathrm{BW}}$ with $f_c = 8.0\\,\\mathrm{kHz}$,\n$$\nQ = \\frac{8.0\\,\\mathrm{kHz}}{2.41963\\,\\mathrm{kHz}} = 3.3063\\ldots\n$$\nRounding to $4$ significant figures yields\n$$\nQ = 3.306.\n$$\n\nAssumptions used and their justification:\n- The BM operates in a near-linear regime at the tested drive level, so the measured displacement amplitude is proportional to the magnitude of the local transfer function.\n- The near-peak response is well-approximated by a lightly damped second-order LTI resonator, which yields the relation $Q = f_c/\\mathrm{BW}$ via the half-power definition.\n- The interpolation in $\\ln f$ between sampled points approximates the locally smooth, approximately symmetric response in logarithmic frequency seen in cochlear tuning near best frequency.\n- The half-power criterion uses $A_{\\text{half}} = A_{\\max}/\\sqrt{2}$ because power is proportional to the square of sinusoidal amplitude, and the half-power points correspond to a $-3\\,\\mathrm{dB}$ change in amplitude.", "answer": "$$\\boxed{3.306}$$", "id": "5007420"}, {"introduction": "The remarkable sensitivity and sharp frequency tuning observed in the healthy cochlea cannot be explained by simple passive mechanics alone. This advanced practice introduces the pivotal concept of the \"cochlear amplifier\"—an active, nonlinear process powered by outer hair cells. You will implement a computational model based on the canonical normal form for a Hopf bifurcation, a powerful tool from dynamical systems theory used to describe the onset of oscillation and amplification in biological systems [@problem_id:5007423]. By deriving and numerically solving the model's input-output relationship, you will directly observe how active mechanical feedback generates the compressive nonlinearity that is a defining feature of normal hearing.", "problem": "Construct a self-contained, universal program that models the active cochlear amplifier using the canonical normal form of a supercritical Hopf oscillator near bifurcation, driven by a sinusoidal stimulus. The goal is to derive the steady-state input-output amplitude relation from first principles and numerically demonstrate compressive nonlinearity at moderate input intensities.\n\nStart from fundamental bases relevant to auditory physiology and mechanics:\n- Linear acoustics: a sinusoidal acoustic pressure at the tympanic membrane transmitted through middle ear mechanics can be represented as an effective sinusoidal force at a single cochlear place. Treat this effective drive amplitude as a scalar input magnitude denoted by $F \\ge 0$ (nondimensional).\n- Newtonian mechanics and dynamical systems: near the onset of oscillation in an active biological system (such as an Outer Hair Cell (OHC)-Basilar Membrane (BM) microdomain), the motion can be reduced by center manifold methods to a complex-amplitude equation with cubic nonlinearity. Represent the complex response amplitude at a cochlear place by $z(t) \\in \\mathbb{C}$.\n- Tonotopy as detuning: the place-dependent natural frequency maps cochlear place to characteristic frequency. In the single-place reduction, detuning between the natural frequency and the stimulus is embodied as a real parameter $\\Delta$.\n\nModel assumptions:\n- Use the canonical forced Hopf normal form for the complex amplitude $z(t)$: the system is poised near a Hopf bifurcation controlled by a real parameter $\\mu$ (nondimensional), with a sinusoidal external drive of angular frequency $\\omega$ and complex amplitude $F e^{i \\omega t}$. Let $\\omega_0$ denote the natural angular frequency at the cochlear place and let detuning be defined as $\\Delta = \\omega_0 - \\omega$ (nondimensional in this formulation by appropriate scaling).\n- Assume time-harmonic steady-state entrainment at the drive frequency in the locked regime. Define the steady-state output amplitude as $r = |a|$, where $z(t) = a e^{i \\omega t}$ is the complex response locked to the stimulus.\n\nTasks:\n1. From the forced Hopf normal form and the steady-state locked ansatz, derive a scalar algebraic equation relating the steady-state output amplitude $r$ to the input force magnitude $F$, the bifurcation parameter $\\mu$, and the detuning $\\Delta$. Do not assume any shortcut formulas; begin from the dynamical equation and systematically reduce to a scalar amplitude equation.\n2. Show analytically that, for near-critical operation and on-resonance ($\\mu \\approx 0$, $\\Delta \\approx 0$), the input-output relation exhibits compressive growth characterized by an input exponent less than $1$ at moderate amplitudes.\n3. Implement a numerical solver that, given $(\\mu, \\Delta)$ and a list of input amplitudes $F$, computes the physically relevant steady-state $r$ by solving the derived scalar equation. The solution selection must be consistent across $F$ values (continuation in $F$) and must return the nonnegative real $r$.\n4. For each test case below, compute the amplitudes at three specified input magnitudes and the log-log slope between two moderate inputs, defined as $s = \\dfrac{\\ln r_2 - \\ln r_1}{\\ln F_2 - \\ln F_1}$, where $(F_1, F_2)$ are the moderate inputs. All quantities are nondimensional.\n\nTest suite (nondimensional parameters):\n- Case $1$: near-critical, on-resonance. $\\mu = 0$, $\\Delta = 0$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$; compute and report $r$ for $F = 10^{-6}$, $10^{-4}$, $10^{-2}$, and the slope $s$ between $F_1 = 10^{-4}$ and $F_2 = 10^{-2}$.\n- Case $2$: near-critical, slight detuning. $\\mu = 0$, $\\Delta = 0.3$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$; same outputs.\n- Case $3$: subcritical (below bifurcation), on-resonance. $\\mu = -0.05$, $\\Delta = 0$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$; same outputs.\n- Case $4$: supercritical (above bifurcation), on-resonance. $\\mu = 0.05$, $\\Delta = 0$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$; same outputs.\n\nAnswer specification:\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case yields a list of four nondimensional floats in the order $[r(F{=}10^{-6}), r(F{=}10^{-4}), r(F{=}10^{-2}), s]$. For the four cases above, the final output must be a single line of the form $[[\\dots],[\\dots],[\\dots],[\\dots]]$ with no spaces.", "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the established theory of nonlinear dynamics and its application to auditory biophysics, specifically using the Hopf normal form to model the cochlear amplifier. The problem is well-posed, objective, and contains sufficient information to derive and compute a unique, meaningful solution under a standard interpretation of the model.\n\n### 1. Derivation of the Input-Output Amplitude Equation\n\nThe starting point is the canonical normal form for a forced supercritical Hopf oscillator, which describes the dynamics of the complex response amplitude $z(t)$ at a particular cochlear location:\n$$\n\\frac{dz}{dt} = (\\mu + i\\omega_0)z - |z|^2 z + F e^{i\\omega t}\n$$\nHere, $z(t) \\in \\mathbb{C}$ is the complex amplitude of the response. The parameter $\\mu$ is the real bifurcation parameter, which controls the system's proximity to the oscillation threshold (the Hopf bifurcation). For $\\mu < 0$, the system is a damped oscillator; for $\\mu > 0$, it is an active oscillator with a stable limit cycle. The parameter $\\omega_0$ is the natural angular frequency of the oscillator at the specific cochlear place. The term $-|z|^2 z$ is the lowest-order nonlinear saturation term that ensures a supercritical bifurcation. The system is driven by an external sinusoidal force of magnitude $F$ and angular frequency $\\omega$.\n\nWe seek a steady-state solution that is phase-locked to the driving force. Such a solution takes the form of a time-harmonic response at the drive frequency $\\omega$:\n$$\nz(t) = a e^{i\\omega t}\n$$\nwhere $a \\in \\mathbb{C}$ is a constant complex number representing the steady-state complex amplitude. The magnitude of the response is $r = |a|$.\n\nTo find the equation for $a$, we substitute the ansatz into the dynamical equation. The time derivative of the ansatz is:\n$$\n\\frac{dz}{dt} = \\frac{d}{dt}(a e^{i\\omega t}) = i\\omega a e^{i\\omega t}\n$$\nSubstituting this and $z(t)$ into the main equation yields:\n$$\ni\\omega a e^{i\\omega t} = (\\mu + i\\omega_0)(a e^{i\\omega t}) - |a e^{i\\omega t}|^2 (a e^{i\\omega t}) + F e^{i\\omega t}\n$$\nThe term $|a e^{i\\omega t}|^2$ simplifies to $|a|^2 |e^{i\\omega t}|^2 = |a|^2 \\cdot 1 = r^2$. The common factor $e^{i\\omega t}$ can be canceled from all terms, leaving an algebraic equation for $a$:\n$$\ni\\omega a = (\\mu + i\\omega_0)a - r^2 a + F\n$$\nRearranging the terms to solve for $F$:\n$$\nF = a (i\\omega - (\\mu + i\\omega_0) + r^2)\n$$\n$$\nF = a (-\\mu + r^2 + i(\\omega - \\omega_0))\n$$\nUsing the definition of the detuning parameter $\\Delta = \\omega_0 - \\omega$, we have $\\omega - \\omega_0 = -\\Delta$. The equation becomes:\n$$\nF = a (-\\mu + r^2 - i\\Delta)\n$$\nTo obtain a scalar equation for the real amplitude $r = |a|$, we take the magnitude of both sides:\n$$\n|F| = |a| |-\\mu + r^2 - i\\Delta|\n$$\nSince $F$ is a non-negative real magnitude, $|F| = F$. The magnitude of the complex number on the right is $\\sqrt{(r^2 - \\mu)^2 + (-\\Delta)^2}$. This gives:\n$$\nF = r \\sqrt{(r^2 - \\mu)^2 + \\Delta^2}\n$$\nSquaring both sides to eliminate the square root, we arrive at the final scalar algebraic equation relating the output amplitude $r$ to the input magnitude $F$ and the system parameters $\\mu$ and $\\Delta$:\n$$\nF^2 = r^2 [ (r^2 - \\mu)^2 + \\Delta^2 ]\n$$\nThis equation is a cubic polynomial in $x = r^2$:\n$$\nx [ (x - \\mu)^2 + \\Delta^2 ] = F^2\n$$\n$$\nx [ x^2 - 2\\mu x + \\mu^2 + \\Delta^2 ] = F^2\n$$\n$$\nx^3 - 2\\mu x^2 + (\\mu^2 + \\Delta^2)x - F^2 = 0\n$$\nThis completes the first task.\n\n### 2. Analytical Demonstration of Compressive Nonlinearity\n\nTo demonstrate compressive growth, we analyze the input-output relation $r(F)$ under near-critical ($\\mu \\approx 0$) and on-resonance ($\\Delta \\approx 0$) conditions. Setting $\\mu = 0$ and $\\Delta = 0$ in the derived amplitude equation:\n$$\nF^2 = r^2 [ (r^2 - 0)^2 + 0^2 ]\n$$\n$$\nF^2 = r^2 (r^4) = r^6\n$$\nSince $F$ and $r$ are non-negative real amplitudes, we can take the positive real root of this equation:\n$$\nr = (F^2)^{1/6} = F^{1/3}\n$$\nThis establishes a power-law relationship $r \\propto F^\\alpha$ with an exponent $\\alpha = 1/3$. Since the exponent $\\alpha < 1$, the output amplitude $r$ grows more slowly than the input amplitude $F$. This is the definition of compressive nonlinearity. A linear system would have an exponent of $\\alpha = 1$.\n\nThe log-log slope of the input-output function, defined as $s = d(\\ln r)/d(\\ln F)$, quantifies the degree of compression. For this ideal case:\n$$\ns = \\frac{d(\\ln(F^{1/3}))}{d(\\ln F)} = \\frac{d(\\frac{1}{3}\\ln F)}{d(\\ln F)} = \\frac{1}{3}\n$$\nThis constant slope of $1/3$ is a hallmark of a Hopf amplifier operating exactly at its critical point. For small but non-zero $\\mu$ and $\\Delta$, the system exhibits linear behavior ($r \\propto F$, $s=1$) at very low input levels and transitions to this compressive behavior ($r \\propto F^{1/3}$, $s \\approx 1/3$) at moderate-to-high input levels. This completes the second task.\n\n### 3. Numerical Solution and Implementation\n\nThe third and fourth tasks require implementing a numerical solver for the cubic equation in $x = r^2$ for given parameters $(\\mu, \\Delta, F)$ and computing the specified quantities for the test suite.\n\nThe numerical procedure is as follows:\n1.  For a given set of parameters $(\\mu, \\Delta, F)$, construct the coefficients of the cubic polynomial $P(x) = x^3 - 2\\mu x^2 + (\\mu^2 + \\Delta^2)x - F^2$. The coefficients are $[1, -2\\mu, \\mu^2 + \\Delta^2, -F^2]$.\n2.  Solve the equation $P(x)=0$ for its three roots using a standard numerical root-finding algorithm, such as the one provided by `numpy.roots`.\n3.  The roots for $x$ may be complex. Since $x = r^2$ and $r$ is a real, non-negative amplitude, we must filter the roots to select only those that are real and non-negative. A small numerical tolerance is used to identify real roots (i.e., those with a near-zero imaginary part).\n4.  In some parameter regimes (specifically for $\\mu > 0$ and small $F$), the system can be bistable, resulting in multiple positive real roots for $x$. The problem requires a consistent selection rule. We adopt the standard convention of selecting the largest positive real root. This corresponds to the stable high-amplitude response branch, which is typically the state of interest for an active amplifier.\n5.  With the selected root $x_{sol}$, the final amplitude is calculated as $r = \\sqrt{x_{sol}}$.\n6.  This procedure is repeated for each required input amplitude $F$. The log-log slope $s$ is then computed according to its definition, $s = (\\ln r_2 - \\ln r_1) / (\\ln F_2 - \\ln F_1)$, using the calculated amplitudes at the specified moderate inputs.\n\nThe following program implements this logic.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_hopf_amplitude(mu, delta, F):\n    \"\"\"\n    Solves for the steady-state amplitude r of a forced Hopf oscillator.\n    \n    The relationship between input F and output r is given by:\n    r^2 * [ (r^2 - mu)^2 + delta^2 ] = F^2\n\n    This is equivalent to a cubic equation in x = r^2:\n    x^3 - 2*mu*x^2 + (mu^2 + delta^2)*x - F^2 = 0\n    \n    Args:\n        mu (float): The bifurcation parameter.\n        delta (float): The detuning parameter.\n        F (float): The input force magnitude.\n\n    Returns:\n        float: The steady-state output amplitude r.\n    \"\"\"\n    F_sq = F**2\n    coeffs = [1.0, -2.0 * mu, mu**2 + delta**2, -F_sq]\n    \n    roots = np.roots(coeffs)\n    \n    # Filter for real, non-negative roots for x = r^2.\n    # A small tolerance is used for floating point comparisons.\n    real_non_negative_roots_x = []\n    for root in roots:\n        if abs(np.imag(root)) < 1e-12 and np.real(root) >= -1e-12:\n            real_non_negative_roots_x.append(np.real(root))\n    \n    if not real_non_negative_roots_x:\n        # This case is physically unexpected but handled for robustness.\n        return np.nan\n\n    # Select the physically relevant root. For a forced active oscillator, \n    # the largest real root corresponds to the stable, high-amplitude response branch.\n    # This provides a consistent selection rule as required.\n    x_sol = np.max(real_non_negative_roots_x)\n    \n    r = np.sqrt(x_sol)\n    return r\n\ndef calculate_log_log_slope(F1, r1, F2, r2):\n    \"\"\"Calculates the log-log slope s.\"\"\"\n    if r1 <= 0 or r2 <= 0 or F1 <= 0 or F2 <= 0:\n        return np.nan\n    s = (np.log(r2) - np.log(r1)) / (np.log(F2) - np.log(F1))\n    return s\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and format the output.\n    \"\"\"\n    test_cases = [\n        # (mu, delta)\n        (0.0, 0.0),    # Case 1: near-critical, on-resonance\n        (0.0, 0.3),    # Case 2: near-critical, slight detuning\n        (-0.05, 0.0),  # Case 3: subcritical, on-resonance\n        (0.05, 0.0)    # Case 4: supercritical, on-resonance\n    ]\n\n    F_report = [1e-6, 1e-4, 1e-2]\n    F1_slope, F2_slope = 1e-4, 1e-2\n\n    all_results = []\n    for mu, delta in test_cases:\n        # Calculate r for all required F values efficiently using a dictionary\n        F_values_needed = sorted(list(set(F_report + [F1_slope, F2_slope])))\n        r_values = {F: solve_hopf_amplitude(mu, delta, F) for F in F_values_needed}\n\n        # Extract values for the slope calculation\n        r1_slope = r_values[F1_slope]\n        r2_slope = r_values[F2_slope]\n        \n        # Calculate the slope\n        s = calculate_log_log_slope(F1_slope, r1_slope, r2_slope)\n        \n        # Assemble the list of results for the current case in the specified order\n        case_result = [r_values[F_report[0]], r_values[F_report[1]], r_values[F_report[2]], s]\n        all_results.append(case_result)\n\n    # Format the final output string according to the specification:\n    # A list of lists, with no spaces, e.g., [[r1,r2,s1],[r3,r4,s2]]\n    case_strs = []\n    for res_list in all_results:\n        # Use repr() for full precision floating point representation\n        inner_list_str = \",\".join(map(repr, res_list))\n        case_strs.append(f\"[{inner_list_str}]\")\n    \n    final_output = f\"[{','.join(case_strs)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "5007423"}]}