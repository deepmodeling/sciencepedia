{"hands_on_practices": [{"introduction": "In any measurement science, quantifying confidence is as important as the measurement itself. This practice delves into the theoretical underpinnings of the Phred quality score, the gold standard for quantifying base-calling accuracy in sequencing. By deriving the famous $Q = -10 \\log_{10}(p)$ formula from a set of intuitive first principles, you will gain a deeper appreciation for why a logarithmic scale is uniquely suited for representing error probabilities in a way that is both interpretable and mathematically robust [@problem_id:5159650].", "problem": "In a Sanger sequencing base-calling workflow used for molecular and immunodiagnostics, each called nucleotide is assigned an estimated error probability $p \\in (0,1)$ that the call is incorrect. A laboratory wishes to define a scalar quality score $Q(p)$ that quantifies confidence in a call from first principles so that downstream decisions (such as accepting or rejecting calls) can be made uniformly across runs and instruments. They require that $Q(p)$ satisfy the following conditions motivated by interpretability and compositionality of confidence: (i) $Q(p)$ is continuous, strictly decreasing in $p$, and maps the worst-case $p=1$ to a reference score $Q(1)=0$; (ii) multiplicative reductions in error probability should translate to fixed additive improvements in quality, specifically, there exists a positive constant $A$ such that for all $p \\in (0,1)$, reducing $p$ by a factor of $10$ increases quality by $A$, i.e., $Q(p/10)-Q(p)=A$; (iii) to fix the scale relative to common sequencing practice, the conventional high-confidence reference point satisfies $Q(10^{-2})=20$. Using only these requirements and standard properties of logarithms, derive the unique functional form of $Q(p)$ consistent with (i)–(iii). Then, invert this function to obtain $p(Q)$ and determine the error probability corresponding to the decision threshold $Q \\ge 20$. Express your final answer as a row matrix containing, in order, the analytic expression for $p(Q)$ and the error probability at the threshold. No approximations are required.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- The variable $p$ represents the estimated error probability of a called nucleotide, with $p \\in (0,1)$.\n- A scalar quality score $Q(p)$ is a function of $p$.\n- Condition (i): $Q(p)$ is continuous and strictly decreasing in $p$. It satisfies the boundary condition $Q(1)=0$.\n- Condition (ii): A multiplicative reduction in error probability leads to an additive increase in quality. Specifically, there exists a positive constant $A$ such that for all $p \\in (0,1)$, the functional equation $Q(p/10) - Q(p) = A$ holds.\n- Condition (iii): A reference point is given as $Q(10^{-2}) = 20$.\n- The tasks are to:\n    1. Derive the unique functional form of $Q(p)$.\n    2. Invert the function to obtain $p(Q)$.\n    3. Determine the error probability for the decision threshold $Q \\ge 20$.\n    4. Express the final answer as a row matrix containing $p(Q)$ and the error probability at the threshold.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes the conceptual basis for Phred quality scores, a fundamental and widely used metric in DNA sequencing and bioinformatics. The conditions are a formalization of the properties of these scores. The problem is scientifically sound and relevant to the field of molecular diagnostics.\n- **Well-Posed:** The problem provides a set of functional constraints and boundary conditions to uniquely determine a function. This is a classic well-posed problem in mathematical modeling. The conditions are sufficient and not contradictory. For instance, applying condition (ii) twice gives $Q(p/100) - Q(p) = 2A$. With $p=1$ and using condition (i) $Q(1)=0$, we get $Q(10^{-2}) = 2A$. Condition (iii) states $Q(10^{-2})=20$, which implies $2A=20$ or $A=10$. This shows the conditions are mutually consistent.\n- **Objective:** The problem is stated in precise mathematical language, free of ambiguity or subjectivity.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and internally consistent. The solution process may proceed.\n\n### Solution Derivation\nThe problem requires finding a function $Q(p)$ that satisfies a given set of properties. We begin with the functional equation from condition (ii):\n$$Q\\left(\\frac{p}{10}\\right) - Q(p) = A$$\nwhere $A$ is a positive constant. This equation relates a scaling of the function's argument to an additive shift in the function's value, which is characteristic of a logarithmic function.\n\nLet's apply this equation iteratively for a positive integer $n$.\n$$Q\\left(\\frac{p}{10}\\right) - Q(p) = A$$\n$$Q\\left(\\frac{p}{10^2}\\right) - Q\\left(\\frac{p}{10}\\right) = A$$\n$$\\vdots$$\n$$Q\\left(\\frac{p}{10^n}\\right) - Q\\left(\\frac{p}{10^{n-1}}\\right) = A$$\nSumming these $n$ equations yields a telescoping series on the left-hand side:\n$$\\left(Q\\left(\\frac{p}{10^n}\\right) - Q\\left(\\frac{p}{10^{n-1}}\\right)\\right) + \\dots + \\left(Q\\left(\\frac{p}{10}\\right) - Q(p)\\right) = nA$$\n$$Q\\left(\\frac{p}{10^n}\\right) - Q(p) = nA$$\nTo determine the constant $A$, we can use the other conditions. Let's set $p=1$ in the above relation. From condition (i), we know $Q(1)=0$.\n$$Q\\left(\\frac{1}{10^n}\\right) - Q(1) = nA$$\n$$Q(10^{-n}) = nA$$\nNow, we apply condition (iii), which states $Q(10^{-2}) = 20$. Using our derived relation for $n=2$, we have $Q(10^{-2}) = 2A$.\nEquating these gives:\n$$2A = 20$$\n$$A = 10$$\nSo, the constant $A$ is $10$.\n\nThe general form of a function satisfying $Q(p/10) - Q(p) = 10$ is logarithmic. Let us propose the form $Q(p) = C_1 \\log_{10}(p) + C_2$ and determine the constants $C_1$ and $C_2$.\nSubstituting this into the functional equation:\n$$\\left(C_1 \\log_{10}\\left(\\frac{p}{10}\\right) + C_2\\right) - (C_1 \\log_{10}(p) + C_2) = 10$$\n$$C_1 \\left(\\log_{10}(p) - \\log_{10}(10)\\right) - C_1 \\log_{10}(p) = 10$$\n$$C_1 \\log_{10}(p) - C_1(1) - C_1 \\log_{10}(p) = 10$$\n$$-C_1 = 10 \\implies C_1 = -10$$\nThis gives the functional form $Q(p) = -10 \\log_{10}(p) + C_2$.\nTo find the constant of integration $C_2$, we use the boundary condition from (i), $Q(1)=0$:\n$$Q(1) = -10 \\log_{10}(1) + C_2 = 0$$\nSince $\\log_{10}(1)=0$, this simplifies to $0 + C_2 = 0$, which yields $C_2=0$.\nThus, the unique function satisfying all three conditions is:\n$$Q(p) = -10 \\log_{10}(p)$$\nWe can verify that this function is continuous and strictly decreasing for $p \\in (0,1)$, as $\\log_{10}(p)$ is strictly increasing.\n\nThe second task is to find the inverse function, $p(Q)$. We solve the equation for $p$:\n$$Q = -10 \\log_{10}(p)$$\n$$-\\frac{Q}{10} = \\log_{10}(p)$$\nBy the definition of the base-$10$ logarithm, raising $10$ to the power of both sides gives:\n$$p(Q) = 10^{-Q/10}$$\n\nThe final task is to find the error probability $p$ corresponding to the decision threshold $Q \\ge 20$. Since $Q(p)$ is a strictly decreasing function of $p$, the inequality $Q \\ge 20$ is equivalent to $p \\le p(20)$. The error probability at the boundary of this threshold is found by substituting $Q=20$ into the expression for $p(Q)$:\n$$p(20) = 10^{-20/10} = 10^{-2}$$\nThis value is equal to $0.01$.\n\nThe final answer requires a row matrix containing the analytic expression for $p(Q)$ and the error probability at the threshold $Q=20$. These are $10^{-Q/10}$ and $10^{-2}$, respectively.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10^{-Q/10}  10^{-2}\n\\end{pmatrix}\n}\n$$", "id": "5159650"}, {"introduction": "Moving from individual base qualities to a decisive conclusion about an entire sequencing run requires a structured quality control framework. This exercise simulates a realistic scenario from a clinical diagnostics laboratory, where you must apply a multi-tiered Standard Operating Procedure (SOP) to a set of reads. By assessing both read-level and run-level quality criteria, you will practice the data analysis skills necessary to ensure that sequencing results meet the stringent standards required for diagnostic applications [@problem_id:5159597].", "problem": "A clinical molecular diagnostics laboratory performing dye-terminator Sanger sequencing validates run quality according to a Standard Operating Procedure (SOP). Base-calling quality is quantified by the Phred quality value (QV), defined for each base by the relationship $Q = -10 \\log_{10}(P_{e})$, where $P_{e}$ is the probability that the base call is incorrect. In this laboratory, a base is classified as “high quality” if $Q \\ge 30$, which corresponds to a base-call error probability of at most $10^{-3}$. The SOP sets two thresholds: (i) a read-level criterion requiring that, within the first $500$ bases of a read, at least a fraction $0.95$ of bases must be high quality; and (ii) a run-level criterion requiring that at least a fraction $0.90$ of reads in a run must satisfy the read-level criterion.\n\nFor a sequencing run comprising $40$ reads, the laboratory has precomputed for each read the count of positions among the first $500$ bases with $Q \\ge 30$. These counts (one per read, in order) are:\n$500, 499, 498, 497, 496, 495, 494, 493, 492, 491, 490, 489, 488, 487, 486, 485, 484, 483, 482, 481, 480, 479, 478, 477, 476, 475, 500, 500, 499, 498, 497, 495, 490, 480, 475, 476, 492, 472, 468, 451$.\n\nStarting from the definition of the Phred quality value and the SOP criteria, determine the run-level proportion (as a decimal fraction) of reads that meet the read-level criterion over the first $500$ bases, and assess whether the run complies with the SOP. Report only the computed proportion as your final response, rounded to four significant figures. Do not include any units.", "solution": "The problem asks us to determine the proportion of sequencing reads that meet a specified quality criterion and to assess whether the entire sequencing run complies with a higher-level Standard Operating Procedure (SOP). The solution requires a systematic application of the given criteria to the provided dataset.\n\nFirst, we formalize the criteria defined in the problem statement. The base-calling quality is given by the Phred quality value, $Q$, defined as $Q = -10 \\log_{10}(P_{e})$, where $P_{e}$ is the probability of an incorrect base call. The problem is self-contained, so we do not need to use this formula directly, but it provides the scientific context for the quality scores.\n\nA base is defined as \"high quality\" if its Phred score is $Q \\ge 30$. The analysis is restricted to the first $N_{bases} = 500$ bases of each read.\n\nThe read-level criterion is that at least a fraction $f_{read} = 0.95$ of these $500$ bases must be high quality. Let $C_{HQ}$ be the count of high-quality bases for a given read. For a read to pass this criterion, the following inequality must hold:\n$$ \\frac{C_{HQ}}{N_{bases}} \\ge f_{read} $$\nSubstituting the given values, we can find the minimum number of high-quality bases, $C_{HQ,min}$, required for a read to pass:\n$$ \\frac{C_{HQ}}{500} \\ge 0.95 $$\n$$ C_{HQ} \\ge 500 \\times 0.95 $$\n$$ C_{HQ} \\ge 475 $$\nTherefore, a read is considered to have passed the read-level quality check if it has at least $475$ bases with $Q \\ge 30$ within its first $500$ bases.\n\nNext, we are given a dataset for a sequencing run comprising $N_{reads} = 40$ reads. The data consists of the precomputed counts of high-quality bases, $C_{HQ}$, for each of these $40$ reads. We must now count how many of these reads satisfy the condition $C_{HQ} \\ge 475$. The provided list of counts is:\n$500, 499, 498, 497, 496, 495, 494, 493, 492, 491, 490, 489, 488, 487, 486, 485, 484, 483, 482, 481, 480, 479, 478, 477, 476, 475, 500, 500, 499, 498, 497, 495, 490, 480, 475, 476, 492, 472, 468, 451$.\n\nTo find the number of reads that meet the criterion, it is efficient to count the number of reads that fail. A read fails if its count of high-quality bases is less than $475$. We inspect the list for values $C_{HQ}  475$. The failing counts are:\n- $472$\n- $468$\n- $451$\n\nThere are $N_{fail} = 3$ reads that do not meet the read-level criterion. The total number of reads in the run is $N_{reads} = 40$. The number of reads that pass the criterion, $N_{pass}$, is therefore:\n$$ N_{pass} = N_{reads} - N_{fail} = 40 - 3 = 37 $$\n\nThe problem asks for the run-level proportion of reads that meet the read-level criterion. Let this proportion be $P_{pass}$. It is calculated as:\n$$ P_{pass} = \\frac{N_{pass}}{N_{reads}} = \\frac{37}{40} $$\nConverting this fraction to a decimal:\n$$ P_{pass} = 0.925 $$\n\nThe problem also requires an assessment of whether the run complies with the SOP. The run-level criterion states that at least a fraction $f_{run} = 0.90$ of reads must satisfy the read-level criterion. To check for compliance, we compare our calculated proportion $P_{pass}$ with the required fraction $f_{run}$:\n$$ P_{pass} \\ge f_{run} $$\n$$ 0.925 \\ge 0.90 $$\nThis inequality is true, which means the sequencing run does comply with the SOP.\n\nFinally, the question asks for a single numerical response: the computed proportion, rounded to four significant figures. The calculated proportion is $0.925$. To express this with four significant figures, we add a trailing zero: $0.9250$.", "answer": "$$\\boxed{0.9250}$$", "id": "5159597"}, {"introduction": "Accurate diagnosis often hinges on distinguishing a true genetic variant from a technical artifact. This advanced practice explores how physical processes, such as the degradation of DNA templates common in clinical samples, can create misleading signals in Sanger sequencing data. By modeling the quantitative signature of differential template degradation and comparing it to a true heterozygous state, you will develop the critical thinking skills needed to interpret complex electropherograms and avoid potential misdiagnoses [@problem_id:5159577].", "problem": "In deoxyribonucleic acid (DNA) Sanger sequencing by chain termination, the measured peak height at a called base is proportional to the abundance of chain-terminated extension products that end at that position with the corresponding dideoxynucleoside triphosphate (ddNTP). Consider a locus with a single nucleotide variant (SNV) where one allele is wild type and the other is a variant. Assume Polymerase Chain Reaction (PCR) produces extension products from both alleles and that, at the SNV position, the termination probability and downstream electrophoretic signal scaling are identical for the two nucleotides involved in the SNV. In downstream processing of clinical specimens such as formalin-fixed paraffin-embedded tissue, template fragmentation can be modeled as a Poisson breakage process along the template length: if the per-nucleotide breakage rate is $\\lambda$, then the probability that a template remains intact across a contiguous region of length $L$ is given by an exponential survival function in $L$.\n\nYou are asked to derive, from these bases, the expected pattern of variant-to-wild-type peak-height ratios across read length in two scenarios:\n\n- Scenario A (partial template degradation): the variant allele templates experience random breakage with per-nucleotide rate $\\lambda_{V} = 1.5 \\times 10^{-3}$, while the wild-type allele templates are effectively intact over the amplicon ($\\lambda_{W} = 0$). The initial molar concentrations of amplifiable templates for the two alleles before degradation are equal. Compute the expected variant-to-wild-type peak-height ratio at positions $L \\in \\{120, 360, 720\\}$ nucleotides from the primer.\n\n- Scenario B (true heterozygous without differential degradation): both alleles are equally intact over the amplicon such that any length-dependent survival or signal scaling is identical between alleles. Compute the expected variant-to-wild-type peak-height ratio at the same positions $L \\in \\{120, 360, 720\\}$.\n\nExpress the six ratios (first list Scenario A values in ascending $L$, then Scenario B values in ascending $L$) as decimal fractions and round your answer to four significant figures. The final answer must be provided as a single row vector.", "solution": "The problem requires the derivation of the expected variant-to-wild-type peak-height ratio in Sanger sequencing under two scenarios of template degradation. The derivation proceeds from first principles as laid out in the problem statement.\n\nThe fundamental premise is that the measured peak height, $H$, for a specific allele at a given nucleotide position is proportional to the abundance of Sanger extension products terminating at that position. This abundance, in turn, is dependent on the number of initial template molecules that are structurally intact up to that position, allowing for the polymerase to synthesize the extension product.\n\nLet $N_{W,0}$ and $N_{V,0}$ represent the initial molar concentrations of amplifiable wild-type (W) and variant (V) templates, respectively. The problem states these are equal, so we can denote this initial concentration as $N_0$.\n$N_{W,0} = N_{V,0} = N_0$.\n\nTemplate fragmentation is modeled as a Poisson breakage process with a per-nucleotide breakage rate $\\lambda$. The probability, $S(L)$, that a template molecule remains intact across a contiguous region of length $L$ (in nucleotides) from the sequencing primer is given by an exponential survival function:\n$$S(L) = \\exp(-\\lambda L)$$\nThe number of available templates of a given allele (W or V) that can be successfully extended to a length $L$ is the product of the initial number of templates and the survival probability up to that length.\n$$N_W(L) = N_0 S_W(L) = N_0 \\exp(-\\lambda_W L)$$\n$$N_V(L) = N_0 S_V(L) = N_0 \\exp(-\\lambda_V L)$$\nwhere $\\lambda_W$ and $\\lambda_V$ are the per-nucleotide breakage rates for the wild-type and variant alleles, respectively.\n\nThe peak height $H$ is proportional to the number of available templates. Let the proportionality constant be $k$. This constant includes factors such as PCR efficiency, termination probability, and signal scaling. The problem specifies that \"termination probability and downstream electrophoretic signal scaling are identical for the two nucleotides involved in the SNV.\" This implies that the constant $k$ is identical for both alleles at the position of interest.\n$$H_W(L) = k N_W(L)$$\n$$H_V(L) = k N_V(L)$$\nThe expected variant-to-wild-type peak-height ratio, $R(L)$, at a position $L$ nucleotides from the primer is therefore:\n$$R(L) = \\frac{H_V(L)}{H_W(L)} = \\frac{k N_V(L)}{k N_W(L)} = \\frac{N_0 \\exp(-\\lambda_V L)}{N_0 \\exp(-\\lambda_W L)}$$\nThe constants $k$ and $N_0$ cancel, yielding the general formula for the peak-height ratio:\n$$R(L) = \\frac{\\exp(-\\lambda_V L)}{\\exp(-\\lambda_W L)} = \\exp(-(\\lambda_V - \\lambda_W)L)$$\nThis general expression can now be applied to the two specified scenarios.\n\n**Scenario A: Partial template degradation**\nIn this scenario, the variant allele templates are subject to degradation while the wild-type allele templates are not.\nThe given parameters are:\n$\\lambda_V = 1.5 \\times 10^{-3}$\n$\\lambda_W = 0$\n\nSubstituting these values into the general formula for the ratio, $R_A(L)$:\n$$R_A(L) = \\exp(-(1.5 \\times 10^{-3} - 0)L) = \\exp(-1.5 \\times 10^{-3} L)$$\nWe are asked to compute this ratio for $L \\in \\{120, 360, 720\\}$.\n\nFor $L = 120$:\n$$R_A(120) = \\exp(-1.5 \\times 10^{-3} \\times 120) = \\exp(-0.18) \\approx 0.8352702$$\nRounded to four significant figures, this is $0.8353$.\n\nFor $L = 360$:\n$$R_A(360) = \\exp(-1.5 \\times 10^{-3} \\times 360) = \\exp(-0.54) \\approx 0.5827482$$\nRounded to four significant figures, this is $0.5827$.\n\nFor $L = 720$:\n$$R_A(720) = \\exp(-1.5 \\times 10^{-3} \\times 720) = \\exp(-1.08) \\approx 0.3395955$$\nRounded to four significant figures, this is $0.3396$.\n\nThe results for Scenario A show a decay in the variant allele signal relative to the wild-type signal as the read length increases, consistent with the differential degradation model.\n\n**Scenario B: True heterozygous without differential degradation**\nIn this scenario, both alleles are \"equally intact,\" meaning they experience identical degradation, if any. This implies that their per-nucleotide breakage rates are equal.\n$$\\lambda_V = \\lambda_W$$\nLet's call this common rate $\\lambda_{\\text{common}}$.\nSubstituting this condition into the general formula for the ratio, $R_B(L)$:\n$$R_B(L) = \\exp(-(\\lambda_V - \\lambda_W)L) = \\exp(-(\\lambda_{\\text{common}} - \\lambda_{\\text{common}})L) = \\exp(0 \\times L) = \\exp(0) = 1$$\nThe ratio is exactly $1$, regardless of the read length $L$. This is the expected outcome for a true heterozygous locus where there are no confounding factors like differential template degradation or measurement bias.\nThus, for $L \\in \\{120, 360, 720\\}$, the ratio is always $1$. Expressed to four significant figures, this ratio is $1.000$.\n\nFor $L = 120$: $R_B(120) = 1.000$\nFor $L = 360$: $R_B(360) = 1.000$\nFor $L = 720$: $R_B(720) = 1.000$\n\nThe final answer is a row vector of the six computed ratios, ordered as requested: Scenario A for $L \\in \\{120, 360, 720\\}$ followed by Scenario B for $L \\in \\{120, 360, 720\\}$.\nThe values are $\\{0.8353, 0.5827, 0.3396, 1.000, 1.000, 1.000\\}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8353  0.5827  0.3396  1.000  1.000  1.000\n\\end{pmatrix}\n}\n$$", "id": "5159577"}]}