{"hands_on_practices": [{"introduction": "A core strength of Surface Plasmon Resonance is its ability to quantify the mass of molecules binding to a sensor surface. This exercise guides you through the fundamental derivation that connects the measured optical signal—an effective refractive index change—to the surface mass density, $\\Gamma$. Mastering this calculation ([@problem_id:5166471]) will allow you to determine the theoretical detection limit of a biosensor, a critical skill for assay design and performance evaluation.", "problem": "A prism-coupled Surface Plasmon Resonance (SPR) biosensor is used to monitor the adsorption of a protein layer in an immunodiagnostic assay. Assume the following physically realistic conditions, which you should regard as the fundamental starting point for your derivation:\n\n- The local refractive index increment caused by a homogeneous solute of mass concentration $c$ obeys the de Feijter relation $\\Delta n(z) = \\left(\\frac{dn}{dc}\\right) c(z)$, where $\\frac{dn}{dc}$ is the refractive index increment for the solute in the surrounding buffer.\n- The adsorbed protein adlayer is uniform, with mass density $\\rho_{p}$ and physical thickness $t$ at the surface ($z=0$ to $z=t$), and zero elsewhere. You may assume $t \\ll \\Lambda$.\n- The evanescent field intensity decays exponentially away from the metal surface with characteristic length $\\Lambda$, so that the instrument’s effective refractive index perturbation equals the intensity-weighted spatial average, i.e., the sensed perturbation is proportional to $\\int_{0}^{\\infty} \\Delta n(z) \\exp(-z/\\Lambda)\\,dz$ normalized by $\\int_{0}^{\\infty} \\exp(-z/\\Lambda)\\,dz$.\n- The sensor’s resonance angle shift $\\Delta \\theta$ is linear in the effectively sensed refractive index change, with angular sensitivity $S$ defined by $\\Delta \\theta = S\\,\\Delta n_{\\mathrm{eff}}$. The minimum resolvable angle is $\\delta \\theta_{\\min}$.\n\nYou are given the following numerical constants:\n\n- Refractive index increment (de Feijter’s constant) for the protein: $\\left(\\frac{dn}{dc}\\right) = 0.185\\ \\mathrm{mL}\\ \\mathrm{g}^{-1}$.\n- Protein mass density: $\\rho_{p} = 1.35\\ \\mathrm{g}\\ \\mathrm{mL}^{-1}$.\n- Evanescent intensity decay length: $\\Lambda = 200\\ \\mathrm{nm}$.\n- Angular sensitivity: $S = 150\\ \\mathrm{deg}\\ \\mathrm{RIU}^{-1}$.\n- Minimum resolvable angle: $\\delta \\theta_{\\min} = 5.00 \\times 10^{-4}\\ \\mathrm{deg}$.\n- Protein molar mass: $M = 150\\ \\mathrm{kDa}$.\n- Avogadro’s constant: $N_{A} = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$.\n\nStarting strictly from the fundamental statements above, derive an expression for the minimum detectable surface mass density $\\Gamma_{\\min}$ (mass per unit area) and then compute the corresponding minimum detectable areal number density in molecules per square micrometer. Report the final result as a single number representing the count of molecules per square micrometer. Round your answer to three significant figures. Express the final count in molecules per square micrometer. Angles are given in degrees.", "solution": "The user has provided a problem to be solved based on the principles of Surface Plasmon Resonance (SPR). The first step is to validate the problem statement.\n\n### Step 1: Extract Givens\nThe verbatim givens are:\n-   **de Feijter relation**: The local refractive index increment $\\Delta n(z)$ caused by a homogeneous solute of mass concentration $c(z)$ is $\\Delta n(z) = \\left(\\frac{dn}{dc}\\right) c(z)$.\n-   **Refractive index increment**: $\\left(\\frac{dn}{dc}\\right) = 0.185\\ \\mathrm{mL}\\ \\mathrm{g}^{-1}$.\n-   **Protein adlayer**: Uniform layer with mass density $\\rho_{p}$ and physical thickness $t$ at the surface ($z=0$ to $z=t$), and zero elsewhere.\n-   **Protein mass density**: $\\rho_{p} = 1.35\\ \\mathrm{g}\\ \\mathrm{mL}^{-1}$.\n-   **Thin-layer approximation**: $t \\ll \\Lambda$.\n-   **Evanescent field**: The field intensity decays exponentially with characteristic length $\\Lambda$.\n-   **Decay length**: $\\Lambda = 200\\ \\mathrm{nm}$.\n-   **Effective refractive index perturbation**: The sensed perturbation is proportional to $\\int_{0}^{\\infty} \\Delta n(z) \\exp(-z/\\Lambda)\\,dz$ normalized by $\\int_{0}^{\\infty} \\exp(-z/\\Lambda)\\,dz$. We formalize this as the definition: $\\Delta n_{\\mathrm{eff}} = \\frac{\\int_{0}^{\\infty} \\Delta n(z) \\exp(-z/\\Lambda)\\,dz}{\\int_{0}^{\\infty} \\exp(-z/\\Lambda)\\,dz}$.\n-   **Angular sensitivity relation**: $\\Delta \\theta = S\\,\\Delta n_{\\mathrm{eff}}$.\n-   **Angular sensitivity**: $S = 150\\ \\mathrm{deg}\\ \\mathrm{RIU}^{-1}$.\n-   **Minimum resolvable angle**: $\\delta \\theta_{\\min} = 5.00 \\times 10^{-4}\\ \\mathrm{deg}$.\n-   **Protein molar mass**: $M = 150\\ \\mathrm{kDa}$.\n-   **Avogadro’s constant**: $N_{A} = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard, albeit simplified, model of an SPR experiment. The physical principles (evanescent wave sensing, refractive index relations) are sound. The provided numerical values are physically realistic for proteins and common SPR instrumentation. The problem is self-contained, with all necessary constants and relationships provided to derive a unique solution. There are no contradictions, ambiguities, or pseudo-scientific claims. The wording \"proportional to ... normalized by\" is slightly imprecise but its meaning, as the definition of the weighted average, is standard and clear in this context.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will now be derived.\n\n### Derivation\nOur goal is to find the minimum detectable areal number density of protein molecules on the sensor surface. We will begin by relating the minimum detectable angle shift, $\\delta \\theta_{\\min}$, to the corresponding minimum effective refractive index change, $\\Delta n_{\\mathrm{eff, min}}$.\n\nFrom the given angular sensitivity relation, $\\Delta \\theta = S\\,\\Delta n_{\\mathrm{eff}}$, we can write:\n$$\n\\Delta n_{\\mathrm{eff, min}} = \\frac{\\delta \\theta_{\\min}}{S}\n$$\n\nNext, we must derive an expression for $\\Delta n_{\\mathrm{eff}}$ based on the physical properties of the adsorbed protein layer. The effective refractive index change is defined as the intensity-weighted spatial average of the local refractive index change $\\Delta n(z)$:\n$$\n\\Delta n_{\\mathrm{eff}} = \\frac{\\int_{0}^{\\infty} \\Delta n(z) \\exp(-z/\\Lambda)\\,dz}{\\int_{0}^{\\infty} \\exp(-z/\\Lambda)\\,dz}\n$$\nThe integral in the denominator is:\n$$\n\\int_{0}^{\\infty} \\exp(-z/\\Lambda)\\,dz = [-\\Lambda \\exp(-z/\\Lambda)]_{0}^{\\infty} = 0 - (-\\Lambda \\exp(0)) = \\Lambda\n$$\nFor the numerator, we use the fact that the protein adlayer is a uniform film of thickness $t$. In this film ($0 \\le z \\le t$), the mass concentration $c(z)$ is equal to the protein's bulk density, $\\rho_{p}$. Outside the film ($z > t$), the concentration is zero. Thus, the local refractive index change is:\n$$\n\\Delta n(z) = \\begin{cases} \\left(\\frac{dn}{dc}\\right) \\rho_{p}  \\text{for } 0 \\le z \\le t \\\\ 0  \\text{for } z > t \\end{cases}\n$$\nThe integral in the numerator becomes:\n$$\n\\int_{0}^{\\infty} \\Delta n(z) \\exp(-z/\\Lambda)\\,dz = \\int_{0}^{t} \\left(\\frac{dn}{dc}\\right) \\rho_{p} \\exp(-z/\\Lambda)\\,dz = \\left(\\frac{dn}{dc}\\right) \\rho_{p} \\int_{0}^{t} \\exp(-z/\\Lambda)\\,dz\n$$\nEvaluating this integral:\n$$\n\\int_{0}^{t} \\exp(-z/\\Lambda)\\,dz = [-\\Lambda \\exp(-z/\\Lambda)]_{0}^{t} = -\\Lambda \\exp(-t/\\Lambda) - (-\\Lambda \\exp(0)) = \\Lambda (1 - \\exp(-t/\\Lambda))\n$$\nSubstituting these results back into the expression for $\\Delta n_{\\mathrm{eff}}$:\n$$\n\\Delta n_{\\mathrm{eff}} = \\frac{\\left(\\frac{dn}{dc}\\right) \\rho_{p} \\Lambda (1 - \\exp(-t/\\Lambda))}{\\Lambda} = \\left(\\frac{dn}{dc}\\right) \\rho_{p} (1 - \\exp(-t/\\Lambda))\n$$\nThe problem states that the adlayer is thin compared to the evanescent decay length, $t \\ll \\Lambda$. This allows for a first-order Taylor series approximation of the exponential term: $\\exp(-x) \\approx 1 - x$ for small $x$. With $x = t/\\Lambda$:\n$$\n\\exp(-t/\\Lambda) \\approx 1 - \\frac{t}{\\Lambda}\n$$\nSubstituting this approximation into the equation for $\\Delta n_{\\mathrm{eff}}$:\n$$\n\\Delta n_{\\mathrm{eff}} \\approx \\left(\\frac{dn}{dc}\\right) \\rho_{p} \\left(1 - \\left(1 - \\frac{t}{\\Lambda}\\right)\\right) = \\left(\\frac{dn}{dc}\\right) \\rho_{p} \\frac{t}{\\Lambda}\n$$\nThe surface mass density, $\\Gamma$, is defined as mass per unit area. For a uniform film of density $\\rho_{p}$ and thickness $t$, this is $\\Gamma = \\rho_{p} t$. Substituting this into the expression for $\\Delta n_{\\mathrm{eff}}$ yields the well-known thin-film approximation for SPR:\n$$\n\\Delta n_{\\mathrm{eff}} = \\frac{\\left(\\frac{dn}{dc}\\right) \\Gamma}{\\Lambda}\n$$\nThis equation relates the sensed optical signal ($\\Delta n_{\\mathrm{eff}}$) to the quantity of interest, the surface mass density $\\Gamma$. We can now find the minimum detectable surface mass density, $\\Gamma_{\\min}$, by setting $\\Delta n_{\\mathrm{eff}}$ to $\\Delta n_{\\mathrm{eff, min}}$:\n$$\n\\Delta n_{\\mathrm{eff, min}} = \\frac{\\delta \\theta_{\\min}}{S} = \\frac{\\left(\\frac{dn}{dc}\\right) \\Gamma_{\\min}}{\\Lambda}\n$$\nSolving for $\\Gamma_{\\min}$, we obtain the symbolic expression:\n$$\n\\Gamma_{\\min} = \\frac{\\delta \\theta_{\\min} \\Lambda}{S \\left(\\frac{dn}{dc}\\right)}\n$$\nThe problem asks for the minimum detectable areal number density, $N_{\\text{areal, min}}$, in units of molecules per square micrometer. We can convert mass density $\\Gamma_{\\min}$ (mass/area) to number density (molecules/area) using the molar mass $M$ (mass/mole) and Avogadro's constant $N_{A}$ (molecules/mole):\n$$\nN_{\\text{areal, min}} = \\frac{\\Gamma_{\\min}}{M} N_{A} = \\frac{\\delta \\theta_{\\min} \\Lambda N_{A}}{S \\left(\\frac{dn}{dc}\\right) M}\n$$\nNow we substitute the given numerical values. Careful unit management is crucial. We will convert all units to a consistent system (cm, g, s).\n-   $\\delta \\theta_{\\min} = 5.00 \\times 10^{-4}\\ \\mathrm{deg}$\n-   $\\Lambda = 200\\ \\mathrm{nm} = 200 \\times 10^{-7}\\ \\mathrm{cm} = 2.00 \\times 10^{-5}\\ \\mathrm{cm}$\n-   $N_{A} = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$\n-   $S = 150\\ \\mathrm{deg}\\ \\mathrm{RIU}^{-1}$\n-   $\\left(\\frac{dn}{dc}\\right) = 0.185\\ \\mathrm{mL}\\ \\mathrm{g}^{-1} = 0.185\\ \\mathrm{cm}^{3}\\ \\mathrm{g}^{-1}$\n-   $M = 150\\ \\mathrm{kDa} = 150 \\times 10^{3}\\ \\mathrm{g}\\ \\mathrm{mol}^{-1} = 1.50 \\times 10^{5}\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$\n\nThe units for $\\delta \\theta_{\\min}$ and $S$ will cancel, leaving their numerical values.\n$$\nN_{\\text{areal, min}} = \\frac{(5.00 \\times 10^{-4}) (2.00 \\times 10^{-5}\\ \\mathrm{cm}) (6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1})}{(150) (0.185\\ \\mathrm{cm}^{3}\\ \\mathrm{g}^{-1}) (1.50 \\times 10^{5}\\ \\mathrm{g}\\ \\mathrm{mol}^{-1})}\n$$\nNumerator calculation:\n$$\n(5.00 \\times 2.00 \\times 6.022) \\times 10^{-4-5+23}\\ \\mathrm{cm} \\cdot \\mathrm{mol}^{-1} = 60.22 \\times 10^{14}\\ \\mathrm{cm} \\cdot \\mathrm{mol}^{-1} = 6.022 \\times 10^{15}\\ \\mathrm{cm} \\cdot \\mathrm{mol}^{-1}\n$$\nDenominator calculation:\n$$\n(150 \\times 0.185 \\times 1.50) \\times 10^{5}\\ \\mathrm{cm}^{3} \\cdot \\mathrm{mol}^{-1} = 41.625 \\times 10^{5}\\ \\mathrm{cm}^{3} \\cdot \\mathrm{mol}^{-1} = 4.1625 \\times 10^{6}\\ \\mathrm{cm}^{3} \\cdot \\mathrm{mol}^{-1}\n$$\nDividing the numerator by the denominator:\n$$\nN_{\\text{areal, min}} = \\frac{6.022 \\times 10^{15}}{4.1625 \\times 10^{6}}\\ \\mathrm{cm}^{-2} \\approx 1.4467 \\times 10^{9}\\ \\mathrm{cm}^{-2}\n$$\nThe result is in molecules per square centimeter. The problem requests the answer in molecules per square micrometer ($\\mu\\mathrm{m}^{2}$). We use the conversion factor $1\\ \\mathrm{cm} = 10^{4}\\ \\mu\\mathrm{m}$, which implies $1\\ \\mathrm{cm}^{2} = (10^{4})^{2}\\ \\mu\\mathrm{m}^{2} = 10^{8}\\ \\mu\\mathrm{m}^{2}$.\n$$\nN_{\\text{areal, min}} = (1.4467 \\times 10^{9}\\ \\mathrm{cm}^{-2}) \\times \\left(\\frac{1\\ \\mathrm{cm}^{2}}{10^{8}\\ \\mu\\mathrm{m}^{2}}\\right) = 1.4467 \\times 10^{1}\\ \\mu\\mathrm{m}^{-2} = 14.467\\ \\mu\\mathrm{m}^{-2}\n$$\nRounding the final answer to three significant figures, we get $14.5$ molecules per square micrometer.", "answer": "$$\\boxed{14.5}$$", "id": "5166471"}, {"introduction": "In an ideal experiment, the SPR signal would only report the specific binding of your analyte. However, real-world data is often convoluted by artifacts, the most common of which is the bulk refractive index effect arising from a mismatch between the sample and running buffers. This practice ([@problem_id:5166534]) demonstrates the critical technique of reference subtraction, where a parallel ligand-free channel is used to measure and remove this non-specific signal, thereby ensuring the integrity of your final binding data.", "problem": "A prism-coupled metal film supporting a surface plasmon mode is interrogated by a monochromatic beam in a Surface Plasmon Resonance (SPR) instrument. The instrument reports a dimensionless sensor response, denoted by Response Units (RU), which is proportional to the shift in the resonance condition caused by changes in the dielectric properties at the metal–dielectric interface. Under small perturbations, the measured response is well approximated by a linear relation to the local refractive index near the surface. Consider an injection of an analyte in a sample buffer whose bulk refractive index differs from that of the running buffer. This bulk refractive index mismatch gives rise to an apparent change in the measured response even in the absence of binding.\n\nStarting from the dependence of the SPR resonance condition on the dielectric properties at the interface and the definition of a sensitivity coefficient as a partial derivative of the response with respect to the local refractive index, derive the linearized expression connecting the bulk refractive index change to the observed response change in terms of a sensitivity coefficient. Then, use this result to correct the signal of an active channel by referencing to a neighboring ligand-free channel.\n\nAssume the following experimentally determined quantities at a fixed time point within the steady-state of the injection:\n- The bulk refractive index change relative to the running buffer is $\\Delta n_{\\text{bulk}}=1.10 \\times 10^{-3}$ Refractive Index Unit (RIU).\n- The response-to-refractive-index sensitivity of the active channel is $S_{\\text{act}}=1.75 \\times 10^{4}$ RU/RIU.\n- The response-to-refractive-index sensitivity of the reference (ligand-free) channel is $S_{\\text{ref}}=1.60 \\times 10^{4}$ RU/RIU.\n- The raw observed response in the active channel at the selected time point is $R_{\\text{act,obs}}=215.8$ RU.\n- The raw observed response in the reference channel at the same time point is $R_{\\text{ref,obs}}=17.6$ RU.\n\nUsing the derived linearized relation and appropriate referencing to remove the bulk contribution, compute the corrected binding response in the active channel at the selected time point. Round your final numerical answer to four significant figures and express it in Response Units (RU).", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, unambiguous, and self-consistent. All provided data are physically realistic and pertinent to the field of surface plasmon resonance (SPR) for biomolecular interaction analysis. The problem is therefore deemed valid and a solution is subsequently derived.\n\nThe core of the problem lies in understanding how the measured SPR signal, denoted by Response Units ($RU$), is related to changes in the refractive index at the sensor surface. The problem states that for small perturbations, the response, $R$, is a linear function of the local refractive index, $n$.\n\nFirst, we formalize the relationship between response and refractive index. The sensitivity of the sensor, $S$, is defined as the partial derivative of the response with respect to the refractive index:\n$$S = \\frac{\\partial R}{\\partial n}$$\nFor a small change in refractive index, $\\Delta n$, the corresponding change in response, $\\Delta R$, can be approximated by the first-order term of a Taylor expansion:\n$$\\Delta R \\approx \\left( \\frac{\\partial R}{\\partial n} \\right) \\Delta n$$\nSubstituting the definition of sensitivity $S$, we arrive at the required linearized expression:\n$$\\Delta R \\approx S \\cdot \\Delta n$$\nIn an SPR binding experiment, the total change in refractive index at the sensor surface of an active channel (where a ligand is immobilized) is a superposition of two effects: the change due to the binding of analyte molecules to the ligand, $\\Delta n_{\\text{bind}}$, and the change due to the difference in the bulk refractive index between the sample buffer and the running buffer, $\\Delta n_{\\text{bulk}}$.\nThus, the total observed response in the active channel, $R_{\\text{act,obs}}$, is the sum of the response due to binding, $R_{\\text{act,bind}}$, and the response due to the bulk effect, $R_{\\text{act,bulk}}$:\n$$R_{\\text{act,obs}} = R_{\\text{act,bind}} + R_{\\text{act,bulk}}$$\nUsing the linearized model, these components can be written as:\n$$R_{\\text{act,bind}} = S_{\\text{act}} \\cdot \\Delta n_{\\text{bind}}$$\n$$R_{\\text{act,bulk}} = S_{\\text{act}} \\cdot \\Delta n_{\\text{bulk}}$$\nwhere $S_{\\text{act}}$ is the sensitivity of the active channel.\n\nThe objective is to determine the true binding response, designated as the corrected response $R_{\\text{corrected}}$, which corresponds to $R_{\\text{act,bind}}$. To do this, we must subtract the bulk contribution from the total observed signal:\n$$R_{\\text{corrected}} = R_{\\text{act,bind}} = R_{\\text{act,obs}} - R_{\\text{act,bulk}}$$\nTo estimate $R_{\\text{act,bulk}}$, we use a reference channel. This channel is identical to the active channel but lacks the immobilized ligand. Consequently, no specific binding occurs, and any observed response, $R_{\\text{ref,obs}}$, is due solely to the bulk refractive index change:\n$$R_{\\text{ref,obs}} = S_{\\text{ref}} \\cdot \\Delta n_{\\text{bulk}}$$\nwhere $S_{\\text{ref}}$ is the sensitivity of the reference channel.\n\nFrom the reference channel measurement, we can express the bulk refractive index change as:\n$$\\Delta n_{\\text{bulk}} = \\frac{R_{\\text{ref,obs}}}{S_{\\text{ref}}}$$\nSubstituting this into the expression for the bulk response in the active channel gives:\n$$R_{\\text{act,bulk}} = S_{\\text{act}} \\left( \\frac{R_{\\text{ref,obs}}}{S_{\\text{ref}}} \\right) = \\frac{S_{\\text{act}}}{S_{\\text{ref}}} R_{\\text{ref,obs}}$$\nThis equation provides a way to calculate the bulk effect in the active channel by scaling the response measured in the reference channel by the ratio of the channels' sensitivities.\n\nFinally, we substitute this back into the equation for the corrected response:\n$$R_{\\text{corrected}} = R_{\\text{act,obs}} - \\left( \\frac{S_{\\text{act}}}{S_{\\text{ref}}} \\right) R_{\\text{ref,obs}}$$\nThis is the general formula for reference-corrected binding response under the given assumptions.\n\nNow, we apply the provided experimental data:\n- Raw observed response in the active channel: $R_{\\text{act,obs}} = 215.8$ RU\n- Raw observed response in the reference channel: $R_{\\text{ref,obs}} = 17.6$ RU\n- Sensitivity of the active channel: $S_{\\text{act}} = 1.75 \\times 10^{4}$ RU/RIU\n- Sensitivity of the reference channel: $S_{\\text{ref}} = 1.60 \\times 10^{4}$ RU/RIU\n\nSubstituting these values into the derived formula:\n$$R_{\\text{corrected}} = 215.8 - \\left( \\frac{1.75 \\times 10^{4}}{1.60 \\times 10^{4}} \\right) \\times 17.6$$\nFirst, we calculate the ratio of the sensitivities:\n$$\\frac{S_{\\text{act}}}{S_{\\text{ref}}} = \\frac{1.75}{1.60} = 1.09375$$\nNext, we calculate the estimated bulk contribution in the active channel:\n$$R_{\\text{act,bulk}} = 1.09375 \\times 17.6 = 19.25$$\nFinally, we compute the corrected binding response by subtraction:\n$$R_{\\text{corrected}} = 215.8 - 19.25 = 196.55$$\nThe problem requires the final numerical answer to be rounded to four significant figures. The number $196.55$ when rounded to four significant figures becomes $196.6$.\nThe provided value for the bulk refractive index change, $\\Delta n_{\\text{bulk}} = 1.10 \\times 10^{-3}$ RIU, is consistent with the reference channel data, as $S_{\\text{ref}} \\times \\Delta n_{\\text{bulk}} = (1.60 \\times 10^{4}) \\times (1.10 \\times 10^{-3}) = 17.6$ RU, which matches $R_{\\text{ref,obs}}$. This confirms the internal consistency of the problem statement, but the referencing procedure correctly relies on the measured $R_{\\text{ref,obs}}$.", "answer": "$$\n\\boxed{196.6}\n$$", "id": "5166534"}, {"introduction": "Obtaining a visually pleasing curve fit is only the first step in rigorous kinetic analysis; it does not guarantee that the underlying model is correct. This advanced computational practice ([@problem_id:5166517]) introduces the critical skill of model validation through residual analysis. You will implement statistical tests to systematically diagnose model misspecification, learning to distinguish a truly representative model from one that merely provides a superficial fit, a cornerstone of robust biophysical characterization.", "problem": "You are given a task grounded in Surface Plasmon Resonance (SPR) for interaction analysis within molecular and immunodiagnostics. Surface Plasmon Resonance (SPR) sensorgrams report the binding response of an analyte to an immobilized ligand on a sensor surface as a function of time under step changes of analyte concentration. Assume a one-to-one (Langmuir) binding mechanism, where the surface-bound response $R(t)$ evolves under mass action kinetics. Your program must fit a globally shared one-to-one model across multiple analyte concentrations, compute standardized residuals, conceptually enable plotting standardized residuals versus both time and fitted signal (the program should compute residual arrays, but it must not produce any plots), and diagnose model misspecification using principled statistical criteria. All physical units must be respected: time in seconds, analyte concentration in molar ($\\mathrm{mol\\cdot L^{-1}}$), and response in Response Units (RU). The final diagnostic outputs must be booleans.\n\nFundamental base and core definitions to use:\n- The one-to-one Langmuir model is described by the ordinary differential equation (ODE) under mass action: $$\\frac{dR}{dt} = k_a\\,C(t)\\,\\big(R_{\\max} - R(t)\\big) - k_d\\,R(t),$$ where $R(t)$ is the surface response in RU, $k_a$ is the association rate constant in $\\mathrm{M^{-1}\\,s^{-1}}$, $k_d$ is the dissociation rate constant in $\\mathrm{s^{-1}}$, $R_{\\max}$ is the maximum binding capacity in RU, and $C(t)$ is the analyte concentration in $\\mathrm{mol\\cdot L^{-1}}$.\n- Under a step injection, $C(t)$ is piecewise constant: during association $C(t)=C_0$ and during dissociation $C(t)=0$.\n- For standardization of residuals, use the definition $$r_i^{\\ast} = \\frac{y_i - \\hat{y}_i}{\\sigma},$$ where $y_i$ is the measured signal, $\\hat{y}_i$ is the model prediction, and $\\sigma$ is the known standard deviation of measurement noise in RU.\n- Use the Durbin–Watson statistic to assess residual autocorrelation in time for each sensorgram: $$D = \\frac{\\sum_{i=2}^{n} \\big(r_i^{\\ast} - r_{i-1}^{\\ast}\\big)^2}{\\sum_{i=1}^{n} \\big(r_i^{\\ast}\\big)^2}.$$\n- Use the Pearson correlation coefficient between standardized residuals and fitted signal (aggregated across all concentrations) to assess systematic structure versus signal: compute the coefficient $r$ and its $p$-value under the null hypothesis of no correlation.\n\nYour program must implement the following logic:\n1. Derive the closed-form solution of the above ODE for a step input to generate predictions during association and dissociation for the one-to-one model. Use these predictions for fitting and residual computation.\n2. Fit the parameters $\\{k_a, k_d, R_{\\max}\\}$ globally across all concentrations of a given test case by nonlinear least squares, enforcing $k_a0$, $k_d0$, $R_{\\max}0$ using bounded optimization.\n3. Compute standardized residuals for each sensorgram using the known noise standard deviation $\\sigma$ provided for the test case.\n4. For each test case, compute:\n   - The Durbin–Watson statistic $D$ for each concentration’s residual time series, then take the arithmetic mean $\\bar{D}$ across concentrations.\n   - The Pearson correlation coefficient $r$ and two-sided $p$-value between all standardized residuals (stacked across concentrations) and the corresponding fitted signals.\n5. Diagnose model misspecification with the following decision rule per test case:\n   - Flag misspecification as true if either $\\bar{D}  D_{\\text{lower}}$ or the correlation test indicates systematic structure, defined as $p  \\alpha$ and $\\lvert r \\rvert \\ge r_{\\min}$.\n   - Use $D_{\\text{lower}} = 1.6$, $\\alpha = 0.01$, and $r_{\\min} = 0.2$.\n6. Produce as output a single line containing a comma-separated list of booleans, one per test case, enclosed in square brackets.\n\nAngle units are not applicable. Do not output plots; only compute the arrays that would be plotted and produce the boolean diagnostic per test case.\n\nTest suite (four independent cases, each internally fitted to a single-site model):\n- Case A (happy path, well-specified one-to-one):\n  - True model: single site with $k_a = 1.0 \\times 10^5~\\mathrm{M^{-1}\\,s^{-1}}$, $k_d = 1.0 \\times 10^{-3}~\\mathrm{s^{-1}}$, $R_{\\max} = 100~\\mathrm{RU}$.\n  - Concentrations: $[1.0 \\times 10^{-9}, 5.0 \\times 10^{-9}, 1.0 \\times 10^{-8}]~\\mathrm{mol\\cdot L^{-1}}$.\n  - Timing: association until $t_a = 60~\\mathrm{s}$, total duration $160~\\mathrm{s}$, time step $0.5~\\mathrm{s}$.\n  - Noise: Gaussian, independent, $\\sigma = 0.2~\\mathrm{RU}$.\n- Case B (misspecified: heterogeneous ligand with two-site kinetics, fitted as one-to-one):\n  - True model: two sites, parameters site $A$: $k_{a,A} = 1.0 \\times 10^5~\\mathrm{M^{-1}\\,s^{-1}}$, $k_{d,A} = 1.0 \\times 10^{-3}~\\mathrm{s^{-1}}$, $R_{\\max,A} = 70~\\mathrm{RU}$; site $B$: $k_{a,B} = 5.0 \\times 10^4~\\mathrm{M^{-1}\\,s^{-1}}$, $k_{d,B} = 5.0 \\times 10^{-4}~\\mathrm{s^{-1}}$, $R_{\\max,B} = 40~\\mathrm{RU}$.\n  - Concentrations: $[1.0 \\times 10^{-9}, 5.0 \\times 10^{-9}, 1.0 \\times 10^{-8}]~\\mathrm{mol\\cdot L^{-1}}$.\n  - Timing: association until $t_a = 60~\\mathrm{s}$, total duration $160~\\mathrm{s}$, time step $0.5~\\mathrm{s}$.\n  - Noise: Gaussian, independent, $\\sigma = 0.2~\\mathrm{RU}$.\n- Case C (boundary: very low concentration, short contact, single-site):\n  - True model: single site with $k_a = 1.0 \\times 10^5~\\mathrm{M^{-1}\\,s^{-1}}$, $k_d = 1.0 \\times 10^{-3}~\\mathrm{s^{-1}}$, $R_{\\max} = 50~\\mathrm{RU}$.\n  - Concentrations: $[2.0 \\times 10^{-10}, 5.0 \\times 10^{-10}]~\\mathrm{mol\\cdot L^{-1}}$.\n  - Timing: association until $t_a = 30~\\mathrm{s}$, total duration $120~\\mathrm{s}$, time step $0.5~\\mathrm{s}$.\n  - Noise: Gaussian, independent, $\\sigma = 0.3~\\mathrm{RU}$.\n- Case D (misspecified: baseline drift added to single-site, fitted as one-to-one without drift term):\n  - True model: single site with $k_a = 1.0 \\times 10^5~\\mathrm{M^{-1}\\,s^{-1}}$, $k_d = 1.0 \\times 10^{-3}~\\mathrm{s^{-1}}$, $R_{\\max} = 100~\\mathrm{RU}$, plus linear baseline drift added to the signal with slope $0.02~\\mathrm{RU\\,s^{-1}}$ over the entire duration.\n  - Concentrations: $[1.0 \\times 10^{-9}, 5.0 \\times 10^{-9}, 1.0 \\times 10^{-8}]~\\mathrm{mol\\cdot L^{-1}}$.\n  - Timing: association until $t_a = 60~\\mathrm{s}$, total duration $160~\\mathrm{s}$, time step $0.5~\\mathrm{s}$.\n  - Noise: Gaussian, independent, $\\sigma = 0.2~\\mathrm{RU}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_i$ is a boolean indicating whether misspecification was detected for the corresponding test case.", "solution": "We begin from the mass action kinetics definition for one-to-one binding under a step input. The governing ordinary differential equation (ODE) for the response $R(t)$ in Response Units (RU) under a constant analyte concentration $C_0$ (association) is\n$$\\frac{dR}{dt} = k_a\\,C_0\\,\\big(R_{\\max} - R(t)\\big) - k_d\\,R(t),$$\nand during dissociation with $C(t)=0$ it reduces to\n$$\\frac{dR}{dt} = -k_d\\,R(t).$$\nThe association ODE is linear and can be rewritten as\n$$\\frac{dR}{dt} + (k_a\\,C_0 + k_d) R(t) = k_a\\,C_0\\,R_{\\max},$$\nwith integrating factor $e^{(k_a\\,C_0 + k_d)t}$. The homogeneous solution is\n$$R_h(t) = A\\,e^{-(k_a\\,C_0 + k_d) t},$$\nand a particular solution is constant $R_p(t) = \\frac{k_a\\,C_0}{k_a\\,C_0 + k_d} R_{\\max}.$\nApplying the initial condition $R(0)=R_0$ (we set $R_0=0$ RU here), we get the association-phase solution\n$$R_{\\text{assoc}}(t) = R_{\\text{eq}} \\left(1 - e^{-k_{\\text{obs}} t}\\right) + R_0\\,e^{-k_{\\text{obs}} t},$$\nwhere $k_{\\text{obs}} = k_a\\,C_0 + k_d$ and $R_{\\text{eq}} = \\frac{k_a\\,C_0}{k_a\\,C_0 + k_d} R_{\\max}.$\nWith $R_0=0$, this simplifies to\n$$R_{\\text{assoc}}(t) = R_{\\text{eq}} \\left(1 - e^{-k_{\\text{obs}} t}\\right).$$\nAt the end of association (at $t=t_a$), the state is\n$$R(t_a) = R_{\\text{eq}} \\left(1 - e^{-k_{\\text{obs}} t_a}\\right).$$\nDuring dissociation with $C(t)=0$, the solution is pure exponential decay:\n$$R_{\\text{diss}}(t) = R(t_a)\\,e^{-k_d (t - t_a)}.$$\n\nThese closed-form expressions provide the prediction $\\hat{y}_i = \\hat{R}(t_i)$ for any given time point $t_i$ under piecewise constant input. For multiple concentrations, the model parameters $\\{k_a,k_d,R_{\\max}\\}$ are global and each concentration $C_j$ has its own $k_{\\text{obs},j} = k_a\\,C_j + k_d$ and $R_{\\text{eq},j} = \\frac{k_a\\,C_j}{k_a\\,C_j + k_d} R_{\\max}$.\n\nTo fit across multiple concentrations, we perform nonlinear least squares on the concatenated residuals. Let $\\mathcal{D} = \\{(t_{j,i}, y_{j,i}, C_j)\\}$ be all observed points indexed by concentration $j$ and time index $i$. The loss function is\n$$\\text{RSS}(k_a, k_d, R_{\\max}) = \\sum_{j}\\sum_{i} \\left[y_{j,i} - \\hat{R}(t_{j,i}; C_j, k_a, k_d, R_{\\max})\\right]^2,$$\nsubject to bounds $k_a0$, $k_d0$, $R_{\\max}0$. Bounded least-squares (for example, the Trust Region Reflective algorithm) is appropriate and numerically robust in this context. We use initial guesses near typical values to ensure convergence.\n\nHaving obtained fitted parameters, residuals are computed pointwise:\n$$e_{j,i} = y_{j,i} - \\hat{R}(t_{j,i}; C_j, \\hat{k}_a, \\hat{k}_d, \\hat{R}_{\\max}).$$\nUsing the known measurement noise standard deviation $\\sigma$ (instrumental noise level), standardized residuals are\n$$r_{j,i}^{\\ast} = \\frac{e_{j,i}}{\\sigma}.$$\n\nTo diagnose model misspecification, we use two complementary tests:\n\n$1.$ Durbin–Watson statistic per sensorgram (residuals versus time): For concentration $j$, with standardized residual sequence $\\{r_{j,1}^{\\ast},\\dots,r_{j,n_j}^{\\ast}\\}$ ordered by time,\n$$D_j = \\frac{\\sum_{i=2}^{n_j} \\big(r_{j,i}^{\\ast} - r_{j,i-1}^{\\ast}\\big)^2}{\\sum_{i=1}^{n_j} \\big(r_{j,i}^{\\ast}\\big)^2}.$$\nWe aggregate by the arithmetic mean\n$$\\bar{D} = \\frac{1}{m} \\sum_{j=1}^{m} D_j,$$\nwhere $m$ is the number of concentrations for the test case. Under white noise residuals, $D$ is approximately $2$. Values substantially below $2$ indicate positive autocorrelation (systematic time structure). We set the lower threshold $D_{\\text{lower}} = 1.6$ to flag notable positive autocorrelation.\n\n$2.$ Residuals versus fitted signal correlation: Stack standardized residuals across all concentrations into a single vector $\\mathbf{r}^{\\ast}$ and stack the corresponding fitted signals $\\hat{\\mathbf{y}}$. Compute the Pearson correlation coefficient\n$$r = \\frac{\\sum_{i} (r^{\\ast}_i - \\bar{r}^{\\ast}) (\\hat{y}_i - \\bar{\\hat{y}})}{\\sqrt{\\sum_{i} (r^{\\ast}_i - \\bar{r}^{\\ast})^2} \\sqrt{\\sum_{i} (\\hat{y}_i - \\bar{\\hat{y}})^2}},$$\nwith the associated two-sided $p$-value under the null hypothesis of zero correlation. Significant correlation suggests residuals vary systematically with the magnitude of the predicted signal (e.g., shape mismatch, heterogeneity, mass transport). We set $\\alpha = 0.01$ and require $\\lvert r \\rvert \\ge r_{\\min}$ with $r_{\\min} = 0.2$ to enforce both statistical significance and practical effect size.\n\nDecision rule per test case:\n- Misspecification is flagged true if either $\\bar{D}  D_{\\text{lower}}$ or $(p  \\alpha \\ \\text{and}\\ \\lvert r \\rvert \\ge r_{\\min})$; otherwise false.\n\nTest cases are simulated as specified, using the above closed-form solutions:\n- Case $A$ uses a single-site model with $k_a = 1.0\\times 10^{5}\\ \\mathrm{M^{-1}\\,s^{-1}}$, $k_d = 1.0\\times 10^{-3}\\ \\mathrm{s^{-1}}$, $R_{\\max} = 100\\ \\mathrm{RU}$, and concentrations $[1.0\\times 10^{-9}, 5.0\\times 10^{-9}, 1.0\\times 10^{-8}]\\ \\mathrm{mol\\cdot L^{-1}}$, with association until $t_a=60\\ \\mathrm{s}$, total $160\\ \\mathrm{s}$ at $0.5\\ \\mathrm{s}$ steps, and Gaussian noise $\\sigma=0.2\\ \\mathrm{RU}$. Residuals are expected to be approximately white and uncorrelated; we anticipate no misspecification: $\\bar{D}\\approx 2$ and nonsignificant correlation.\n- Case $B$ sums two single-site responses (sites $A$ and $B$) with $k_{a,A} = 1.0\\times 10^{5}$, $k_{d,A} = 1.0\\times 10^{-3}$, $R_{\\max,A} = 70\\ \\mathrm{RU}$, and $k_{a,B} = 5.0\\times 10^{4}$, $k_{d,B} = 5.0\\times 10^{-4}$, $R_{\\max,B} = 40\\ \\mathrm{RU}$, under the same concentrations and timing as Case $A$, with $\\sigma=0.2\\ \\mathrm{RU}$. Fitting a one-site model to this heterogeneous reality typically yields structured residuals (e.g., curvature and multi-exponential decay misfit), leading to $\\bar{D}  1.6$ and/or significant residual–signal correlation; we anticipate misspecification: true.\n- Case $C$ uses very low concentrations $[2.0\\times 10^{-10}, 5.0\\times 10^{-10}]\\ \\mathrm{mol\\cdot L^{-1}}$ with $k_a = 1.0\\times 10^{5}$, $k_d = 1.0\\times 10^{-3}$, $R_{\\max} = 50\\ \\mathrm{RU}$, association until $t_a=30\\ \\mathrm{s}$, total $120\\ \\mathrm{s}$ at $0.5\\ \\mathrm{s}$ steps, and $\\sigma=0.3\\ \\mathrm{RU}$. Although signals are small, the single-site model remains appropriate; residuals should be dominated by noise with minimal structure; we anticipate no misspecification: false.\n- Case $D$ uses the single-site model of Case $A$ but adds linear baseline drift with slope $0.02\\ \\mathrm{RU\\,s^{-1}}$ to the signal. The one-site model without drift will generally produce time-correlated residuals; we anticipate misspecification: true.\n\nAlgorithmic steps in the program:\n$1.$ Generate time vectors, association cutoff $t_a$, and concentration lists per case.\n$2.$ Simulate noisy sensorgrams with the specified true kinetic models:\n- Single-site: use $R_{\\text{assoc}}(t)$ and $R_{\\text{diss}}(t)$.\n- Two-site: sum of two single-site responses with site-specific parameters.\n- Drift: add $d\\,t$ where $d$ is the drift slope to the simulated signal.\nAdd Gaussian noise with standard deviation $\\sigma$ to all points.\n$3.$ Fit global parameters $\\{k_a,k_d,R_{\\max}\\}$ by minimizing $\\text{RSS}$ over all points across concentrations for the case via bounded least squares.\n$4.$ Compute standardized residuals per concentration and diagnostics:\n- Durbin–Watson $D_j$ per concentration and $\\bar{D}$.\n- Pearson correlation $r$ and $p$ between stacked standardized residuals and fitted signals.\n$5.$ Apply the decision rule with $D_{\\text{lower}} = 1.6$, $\\alpha=0.01$, $r_{\\min}=0.2$ to produce a boolean per case.\n$6.$ Print the results in the required single-line format: a list of booleans in square brackets.\n\nThis approach integrates the fundamental kinetic laws, closed-form solutions of the ODE under step inputs, and statistical diagnostics to detect model–data mismatch in an SPR experiment framework at advanced graduate level.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\nfrom scipy.stats import pearsonr\n\n# Reproducibility\nrng = np.random.default_rng(42)\n\ndef sensorgram_1to1(ka, kd, Rmax, C, t, ta):\n    \"\"\"\n    Compute 1:1 Langmuir sensorgram for a single concentration C over time t,\n    with association until ta and dissociation thereafter. Baseline at t=0 is 0 RU.\n    \"\"\"\n    kobs = ka * C + kd\n    # Association phase: t = ta\n    assoc_mask = t = ta\n    t_assoc = t[assoc_mask]\n    Req = (ka * C / kobs) * Rmax if kobs  0 else 0.0\n    R_assoc = Req * (1.0 - np.exp(-kobs * t_assoc))\n\n    # Dissociation phase: t  ta\n    diss_mask = t  ta\n    t_diss = t[diss_mask]\n    if t_assoc.size  0:\n        R_ta = Req * (1.0 - np.exp(-kobs * ta))\n    else:\n        R_ta = 0.0\n    R_diss = R_ta * np.exp(-kd * (t_diss - ta))\n\n    # Concatenate\n    R = np.empty_like(t, dtype=float)\n    R[assoc_mask] = R_assoc\n    R[diss_mask] = R_diss\n    return R\n\ndef sensorgram_two_site(paramsA, paramsB, C, t, ta):\n    \"\"\"\n    Sum of two independent 1:1 sites: paramsA = (kaA, kdA, RmaxA), paramsB = (kaB, kdB, RmaxB)\n    \"\"\"\n    kaA, kdA, RmaxA = paramsA\n    kaB, kdB, RmaxB = paramsB\n    R_A = sensorgram_1to1(kaA, kdA, RmaxA, C, t, ta)\n    R_B = sensorgram_1to1(kaB, kdB, RmaxB, C, t, ta)\n    return R_A + R_B\n\ndef fit_global_1to1(times, ta, concentrations, signals):\n    \"\"\"\n    Fit global 1:1 parameters (ka, kd, Rmax) across multiple concentrations by least squares.\n    times: array of time points (common across concentrations)\n    ta: association end time\n    concentrations: list/array of C values (M)\n    signals: list of arrays y_j for each concentration\n    Returns fitted params (ka, kd, Rmax) and fitted signals list.\n    \"\"\"\n    t = times\n    # Initial guess and bounds\n    x0 = np.array([8.0e4, 1.2e-3, 80.0])  # ka, kd, Rmax\n    lower_bounds = np.array([1.0e3, 1.0e-6, 1.0])\n    upper_bounds = np.array([1.0e7, 1.0e-1, 1.0e3])\n\n    # Build residual function stacking all concentrations\n    def residuals(x):\n        ka, kd, Rmax = x\n        res = []\n        for C, y in zip(concentrations, signals):\n            yhat = sensorgram_1to1(ka, kd, Rmax, C, t, ta)\n            res.append(y - yhat)\n        return np.concatenate(res)\n\n    result = least_squares(residuals, x0, bounds=(lower_bounds, upper_bounds), method='trf', max_nfev=5000, ftol=1e-12, xtol=1e-12, gtol=1e-12)\n    ka_fit, kd_fit, Rmax_fit = result.x\n    fitted_signals = [sensorgram_1to1(ka_fit, kd_fit, Rmax_fit, C, t, ta) for C in concentrations]\n    return ka_fit, kd_fit, Rmax_fit, fitted_signals\n\ndef durbin_watson(residuals):\n    \"\"\"\n    Compute Durbin-Watson statistic for a 1D residual series.\n    \"\"\"\n    diff = np.diff(residuals)\n    denom = np.sum(residuals ** 2)\n    if denom == 0:\n        return 2.0  # if all residuals zero, treat as no autocorrelation\n    return np.sum(diff ** 2) / denom\n\ndef diagnose_misspec(times, ta, concentrations, signals, noise_sigma, drift_slope=0.0):\n    \"\"\"\n    Fit global 1:1 model, compute standardized residuals, compute diagnostics,\n    and return boolean misspecification flag.\n    \"\"\"\n    # Fit\n    ka_fit, kd_fit, Rmax_fit, fitted_signals = fit_global_1to1(times, ta, concentrations, signals)\n\n    # Standardized residuals per concentration\n    std_residuals_list = []\n    DW_list = []\n    for y, yhat in zip(signals, fitted_signals):\n        res = (y - yhat) / noise_sigma\n        std_residuals_list.append(res)\n        DW_list.append(durbin_watson(res))\n\n    # Aggregate for correlation versus fitted signal\n    std_residuals_all = np.concatenate(std_residuals_list)\n    fitted_all = np.concatenate(fitted_signals)\n\n    # Pearson correlation and p-value\n    # Handle degenerate case: if fitted_all is constant, correlation is undefined - set to (0.0, 1.0)\n    if np.allclose(np.std(fitted_all), 0.0) or np.allclose(np.std(std_residuals_all), 0.0):\n        r_corr, p_corr = 0.0, 1.0\n    else:\n        r_corr, p_corr = pearsonr(std_residuals_all, fitted_all)\n\n    # Durbin-Watson average\n    D_bar = float(np.mean(DW_list))\n\n    # Decision rule\n    D_lower = 1.6\n    alpha = 0.01\n    r_min = 0.2\n\n    misspec = (D_bar  D_lower) or (p_corr  alpha and abs(r_corr) = r_min)\n    return misspec\n\ndef simulate_case_A():\n    # Single-site well-specified\n    ka = 1.0e5\n    kd = 1.0e-3\n    Rmax = 100.0\n    concentrations = np.array([1.0e-9, 5.0e-9, 1.0e-8])\n    ta = 60.0\n    dt = 0.5\n    t_end = 160.0\n    times = np.arange(0.0, t_end + 1e-12, dt)\n    sigma = 0.2\n    signals = []\n    for C in concentrations:\n        clean = sensorgram_1to1(ka, kd, Rmax, C, times, ta)\n        noisy = clean + rng.normal(0.0, sigma, size=clean.shape)\n        signals.append(noisy)\n    return times, ta, concentrations, signals, sigma\n\ndef simulate_case_B():\n    # Two-site heterogeneous ligand - misspec when fitted as single-site\n    paramsA = (1.0e5, 1.0e-3, 70.0)\n    paramsB = (5.0e4, 5.0e-4, 40.0)\n    concentrations = np.array([1.0e-9, 5.0e-9, 1.0e-8])\n    ta = 60.0\n    dt = 0.5\n    t_end = 160.0\n    times = np.arange(0.0, t_end + 1e-12, dt)\n    sigma = 0.2\n    signals = []\n    for C in concentrations:\n        clean = sensorgram_two_site(paramsA, paramsB, C, times, ta)\n        noisy = clean + rng.normal(0.0, sigma, size=clean.shape)\n        signals.append(noisy)\n    return times, ta, concentrations, signals, sigma\n\ndef simulate_case_C():\n    # Low concentration, short contact, single-site\n    ka = 1.0e5\n    kd = 1.0e-3\n    Rmax = 50.0\n    concentrations = np.array([2.0e-10, 5.0e-10])\n    ta = 30.0\n    dt = 0.5\n    t_end = 120.0\n    times = np.arange(0.0, t_end + 1e-12, dt)\n    sigma = 0.3\n    signals = []\n    for C in concentrations:\n        clean = sensorgram_1to1(ka, kd, Rmax, C, times, ta)\n        noisy = clean + rng.normal(0.0, sigma, size=clean.shape)\n        signals.append(noisy)\n    return times, ta, concentrations, signals, sigma\n\ndef simulate_case_D():\n    # Single-site plus linear baseline drift\n    ka = 1.0e5\n    kd = 1.0e-3\n    Rmax = 100.0\n    drift_slope = 0.02  # RU/s\n    concentrations = np.array([1.0e-9, 5.0e-9, 1.0e-8])\n    ta = 60.0\n    dt = 0.5\n    t_end = 160.0\n    times = np.arange(0.0, t_end + 1e-12, dt)\n    sigma = 0.2\n    signals = []\n    for C in concentrations:\n        clean = sensorgram_1to1(ka, kd, Rmax, C, times, ta) + drift_slope * times\n        noisy = clean + rng.normal(0.0, sigma, size=clean.shape)\n        signals.append(noisy)\n    return times, ta, concentrations, signals, sigma\n\ndef solve():\n    # Define the test cases from the problem statement.\n    cases = [\n        simulate_case_A(),\n        simulate_case_B(),\n        simulate_case_C(),\n        simulate_case_D(),\n    ]\n\n    results = []\n    for times, ta, concentrations, signals, sigma in cases:\n        misspec = diagnose_misspec(times, ta, concentrations, signals, sigma)\n        results.append(misspec)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "5166517"}]}