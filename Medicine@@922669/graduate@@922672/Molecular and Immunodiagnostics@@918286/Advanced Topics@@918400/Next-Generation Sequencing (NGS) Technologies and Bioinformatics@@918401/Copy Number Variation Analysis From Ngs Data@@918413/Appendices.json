{"hands_on_practices": [{"introduction": "The cornerstone of copy number variation (CNV) detection from read depth lies in a simple, powerful principle: the amount of sequencing data from a genomic region is proportional to the number of DNA copies of that region. This first practice solidifies this fundamental concept by guiding you through the calculation of the expected signal for key CNV events. By deriving the log-transformed fold-change for deletions, gains, and amplifications, you will build an intuition for the quantitative signals that underlie visual CNV plots and automated calling algorithms [@problem_id:5104032].", "problem": "A clinical molecular and immunodiagnostics laboratory implements a read-depth based copy number variation analysis pipeline on targeted Next-Generation Sequencing (NGS) data for immune checkpoint genes. Assume the following foundational relationships:\n- In read-depth based copy number inference, the expected per-bin read count is proportional to the true copy number $c$ at that locus when library preparation and capture efficiency are uniform across samples.\n- A matched diploid reference sample has baseline ploidy $p$ and is processed identically. After normalization for library size and technical covariates, the expected fold-change in normalized coverage between a test locus and the diploid baseline is the ratio $c/p$.\n- The pipeline reports the log-transformed fold-change using base $2$ to quantify copy number shifts.\n\nUnder these assumptions, consider three biologically plausible copy number states for a tumor sample with baseline ploidy $p=2$: a hemizygous deletion with $c=1$, a single-copy gain with $c=3$, and a high-level focal amplification with $c=6$. Starting from the proportionality of read counts to copy number and the definition of a base-$2$ logarithm applied to the fold-change, derive the expected log-transformed fold-change for each state. Then, briefly justify how the expected variance of the log-transformed fold-change would scale with depth under a count model appropriate for NGS (for example, a Poisson or an overdispersed Negative Binomial), making clear any assumptions needed.\n\nExpress your final answer as dimensionless base-$2$ log ratios for the three states $(c=1,\\,c=3,\\,c=6)$, in this order, rounded to four significant figures. Provide the three values as a single row matrix.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- The expected per-bin read count is proportional to the true copy number $c$.\n- A matched diploid reference sample has a baseline ploidy $p$.\n- The expected fold-change in normalized coverage is the ratio $c/p$.\n- The pipeline reports the log-transformed fold-change using base $2$.\n- The tumor sample has a baseline ploidy $p=2$.\n- Three copy number states are considered: a hemizygous deletion with $c=1$, a single-copy gain with $c=3$, and a high-level focal amplification with $c=6$.\n- The task is to derive the expected log-transformed fold-change for each state and to justify the scaling of its variance with sequencing depth.\n- The final answer for the three log-ratios must be rounded to four significant figures and presented as a row matrix.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the standard principles of copy number variation (CNV) analysis from Next-Generation Sequencing (NGS) data. The core assumption—that normalized read depth is proportional to the underlying copy number—is the fundamental basis of this entire class of bioinformatics methods. The use of a diploid reference, log-2 transformation of fold-changes, and the modeling of read counts with Poisson or Negative Binomial distributions are all established, standard practices in computational genomics. The specified copy number states ($c=1, 3, 6$) are biologically plausible phenomena observed in cancer genomes.\n- **Well-Posed:** The problem is clearly defined and provides all necessary information to compute the requested values. The relationship between copy number ($c$), ploidy ($p$), and the final reported value (log-2 fold-change) is explicitly stated. The question regarding variance scaling requires a qualitative justification based on known statistical properties, which is a standard exercise in this field.\n- **Objective:** The problem is stated in precise, objective language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and complete. It is deemed **valid**. The solution will now be derived.\n\nThe problem defines the quantitative relationship between copy number and the reported diagnostic value. Let $L$ represent the log-transformed fold-change. According to the givens, this value is computed as the base-$2$ logarithm of the fold-change, which is the ratio of the test sample's copy number, $c$, to the reference sample's baseline ploidy, $p$.\n\nThe formula is therefore:\n$$L = \\log_2\\left(\\frac{c}{p}\\right)$$\nThe problem specifies that the reference is a diploid sample, meaning it has two copies of the chromosome in question. The baseline ploidy for the reference is thus $p=2$. The problem also states the tumor sample's baseline ploidy is $p=2$, which is consistent with the reference being a matched normal sample. The calculation for the log-fold-change uses the reference ploidy.\n\nWe are asked to calculate the expected value of $L$ for three distinct copy number states in the tumor sample:\n1.  **Hemizygous deletion:** The copy number is $c=1$.\n2.  **Single-copy gain:** The copy number is $c=3$.\n3.  **High-level focal amplification:** The copy number is $c=6$.\n\nFor each case, we substitute the values of $c$ and $p$ into the formula.\n\nCase 1: Hemizygous deletion ($c=1$)\n$$L_1 = \\log_2\\left(\\frac{1}{2}\\right) = \\log_2(2^{-1}) = -1$$\nTo four significant figures, this is $-1.000$.\n\nCase 2: Single-copy gain ($c=3$)\n$$L_2 = \\log_2\\left(\\frac{3}{2}\\right) = \\log_2(1.5)$$\nUsing the change of base formula for logarithms, $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$:\n$$L_2 = \\frac{\\ln(1.5)}{\\ln(2)} \\approx \\frac{0.405465}{0.693147} \\approx 0.5849625$$\nRounding to four significant figures gives $0.5850$.\n\nCase 3: High-level focal amplification ($c=6$)\n$$L_3 = \\log_2\\left(\\frac{6}{2}\\right) = \\log_2(3)$$\n$$L_3 = \\frac{\\ln(3)}{\\ln(2)} \\approx \\frac{1.098612}{0.693147} \\approx 1.5849625$$\nRounding to four significant figures gives $1.585$.\n\nNext, we address the justification for how the variance of the log-transformed fold-change scales with sequencing depth. Let $N_T$ and $N_R$ be the normalized read counts for the test and reference samples in a given genomic bin, respectively. These are random variables. The log-ratio is $L = \\log_2(N_T/N_R)$. The variance of $L$ can be approximated using the formula for propagation of uncertainty (the Delta method). First, we convert to the natural logarithm for convenience, since $\\log_2(x) = \\ln(x)/\\ln(2)$, and thus $\\text{Var}(\\log_2(x)) = \\frac{1}{(\\ln 2)^2}\\text{Var}(\\ln(x))$.\n\nFor a function $f(N_T, N_R) = \\ln(N_T) - \\ln(N_R)$, assuming $N_T$ and $N_R$ are independent (a standard assumption for separately sequenced samples), the variance is:\n$$\\text{Var}(L) \\approx \\frac{1}{(\\ln 2)^2} \\left[ \\left(\\frac{\\partial f}{\\partial N_T}\\right)^2 \\text{Var}(N_T) + \\left(\\frac{\\partial f}{\\partial N_R}\\right)^2 \\text{Var}(N_R) \\right]$$\nThe partial derivatives, evaluated at the means $\\mu_T = \\mathbb{E}[N_T]$ and $\\mu_R = \\mathbb{E}[N_R]$, are $\\frac{\\partial f}{\\partial N_T} = \\frac{1}{\\mu_T}$ and $\\frac{\\partial f}{\\partial N_R} = -\\frac{1}{\\mu_R}$.\nSubstituting these gives:\n$$\\text{Var}(L) \\approx \\frac{1}{(\\ln 2)^2} \\left[ \\frac{\\text{Var}(N_T)}{\\mu_T^2} + \\frac{\\text{Var}(N_R)}{\\mu_R^2} \\right]$$\nThis shows that the variance of the log-ratio depends on the squared coefficient of variation (CV) of the read counts. The mean read count, $\\mu$, is directly proportional to the sequencing depth, $D$. Let's analyze the term $\\text{Var}(N)/\\mu^2$ under the suggested count models.\n\nAssumption 1: **Poisson Model.** For NGS counts, a simple model is the Poisson distribution, where $\\text{Var}(N) = \\mu$. In this case, the squared CV is:\n$$\\frac{\\text{Var}(N)}{\\mu^2} = \\frac{\\mu}{\\mu^2} = \\frac{1}{\\mu}$$\nSince $\\mu$ is proportional to sequencing depth $D$, we have $\\frac{1}{\\mu} \\propto \\frac{1}{D}$. Therefore, for a Poisson model, $\\text{Var}(L) \\propto \\frac{1}{D_T} + \\frac{1}{D_R}$. If both samples have comparable depth $D$, then $\\text{Var}(L) \\propto \\frac{1}{D}$. The variance scales inversely with sequencing depth.\n\nAssumption 2: **Negative Binomial (NB) Model.** Real NGS data often exhibit overdispersion, where the variance is greater than the mean. The NB model captures this with a dispersion parameter $\\alpha$, such that $\\text{Var}(N) = \\mu + \\alpha\\mu^2$. The squared CV is:\n$$\\frac{\\text{Var}(N)}{\\mu^2} = \\frac{\\mu + \\alpha\\mu^2}{\\mu^2} = \\frac{1}{\\mu} + \\alpha$$\nAgain, since $\\mu \\propto D$, this term is proportional to $\\frac{1}{D} + \\alpha$. The variance of the log-ratio thus behaves as $\\text{Var}(L) \\propto (\\frac{1}{D_T} + \\alpha_T) + (\\frac{1}{D_R} + \\alpha_R)$. As depth $D$ increases, the $\\frac{1}{D}$ term diminishes, but the variance approaches a non-zero floor determined by the dispersion parameters ($\\alpha_T + \\alpha_R$).\n\nIn both plausible models, the variance of the log-transformed fold-change decreases as sequencing depth increases. Higher depth leads to more precise and reliable copy number estimates. The NB model more realistically predicts that even at very high depth, some variance remains due to biological and technical factors other than pure counting (shot) noise. The fundamental scaling relationship is that variance is inversely related to depth.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1.000  0.5850  1.585\n\\end{pmatrix}\n}\n$$", "id": "5104032"}, {"introduction": "While predicting the signal from a known copy number is a crucial first step, the real-world task of a bioinformatician is the inverse: to infer the unknown copy number from an observed signal. This exercise challenges you to algebraically invert the foundational relationship between read depth and copy number. You will derive a formula to calculate the absolute copy number $c$ from a given log-ratio $r$ and a baseline ploidy $p$, a scenario commonly encountered when analyzing aneuploid cancer genomes with non-diploid baselines [@problem_id:5104093].", "problem": "In copy number variation analysis from Next-Generation Sequencing (NGS) read depth data, a standard assumption after appropriate bias correction (e.g., by genome-wide normalization for guanine-cytosine content and mappability) is that the expected read depth at a locus is proportional to the absolute deoxyribonucleic acid copy number at that locus. Let the absolute copy number at a locus in the sample be $c$, and let the tumor’s baseline ploidy be $p$. Suppose the expected read depth at copy number $x$ is $d_{x}$, and proportionality holds via an unknown assay-dependent constant $k$, so that $d_{x} = k x$. Let the observed segment’s depth be $d = d_{c}$ and the baseline segment depth be $d_{p} = d_{p}$. Define the log-transformed depth ratio $r$ as the base-$2$ logarithm of the ratio of observed depth to baseline depth, i.e., $r = \\log_{2}\\!\\left(\\frac{d}{d_{p}}\\right)$. \n\nUsing only these definitions and the proportionality premise $d_{x} = k x$, do the following:\n- Derive an expression that links the log-transformed depth ratio $r$ to the absolute copy number $c$ and the baseline ploidy $p$.\n- Algebraically invert this relationship to express $c$ explicitly as a function of $r$ and $p$.\n- Evaluate this expression for $p = 3.2$ and $r = -0.321928094$, and report the absolute copy number as a pure number. Round your final numerical result to four significant figures. Do not report any units and do not use a percentage sign anywhere in your answer.", "solution": "The problem requires the derivation of a relationship between the log-transformed depth ratio $r$, the absolute copy number $c$, and the baseline ploidy $p$, followed by the inversion of this relationship to solve for $c$, and a final numerical evaluation.\n\nFirst, the relevant definitions and premises are established.\nThe expected read depth $d_x$ at a locus with copy number $x$ is proportional to $x$ via a constant $k$:\n$$d_x = kx$$\nThe observed segment's depth $d$ corresponds to the absolute copy number $c$, so:\n$$d = d_c = kc$$\nThe baseline segment depth $d_p$ corresponds to the baseline ploidy $p$, so:\n$$d_p = kp$$\nThe log-transformed depth ratio $r$ is defined as:\n$$r = \\log_{2}\\!\\left(\\frac{d}{d_{p}}\\right)$$\n\nThe first task is to derive an expression linking $r$, $c$, and $p$. We substitute the expressions for $d$ and $d_p$ into the definition of $r$:\n$$r = \\log_{2}\\!\\left(\\frac{kc}{kp}\\right)$$\nThe unknown assay-dependent constant $k$ is present in both the numerator and the denominator, and since $k$ must be non-zero for the read depth to be meaningful, it can be cancelled out:\n$$r = \\log_{2}\\!\\left(\\frac{c}{p}\\right)$$\nThis is the derived expression that links the log-transformed depth ratio $r$ to the absolute copy number $c$ and the baseline ploidy $p$. It demonstrates that the log-ratio of read depths is equivalent to the log-ratio of the underlying copy numbers, a fundamental relationship in this type of analysis.\n\nThe second task is to algebraically invert this relationship to express $c$ explicitly as a function of $r$ and $p$. We begin with the derived equation:\n$$r = \\log_{2}\\!\\left(\\frac{c}{p}\\right)$$\nTo isolate the term containing $c$, we apply the base-$2$ exponential function to both sides of the equation. This is the inverse operation of the base-$2$ logarithm.\n$$2^r = 2^{\\log_{2}(c/p)}$$\nBy the definition of a logarithm, $a^{\\log_a(x)} = x$, so the right side simplifies to:\n$$2^r = \\frac{c}{p}$$\nFinally, to solve for $c$, we multiply both sides by $p$:\n$$c = p \\cdot 2^r$$\nThis equation expresses the absolute copy number $c$ as a function of the baseline ploidy $p$ and the log-transformed depth ratio $r$.\n\nThe third task is to evaluate this expression for the given values $p = 3.2$ and $r = -0.321928094$.\nWe substitute these values into the expression for $c$:\n$$c = 3.2 \\times 2^{-0.321928094}$$\nTo evaluate the term $2^{-0.321928094}$, we can recognize that the exponent is a specific logarithmic value. Let's verify if $r = \\log_2(4/5)$.\n$$ \\log_{2}\\!\\left(\\frac{4}{5}\\right) = \\log_{2}(4) - \\log_{2}(5) = 2 - \\log_{2}(5) $$\nUsing a standard value for $\\log_{2}(5) \\approx 2.321928094$, we get:\n$$ \\log_{2}\\!\\left(\\frac{4}{5}\\right) \\approx 2 - 2.321928094 = -0.321928094 $$\nThe value of the exponent corresponds exactly to $\\log_2(4/5)$. Therefore, we can substitute this back into the calculation for $c$:\n$$c = 3.2 \\times 2^{\\log_{2}(4/5)}$$\nAgain, using the property $a^{\\log_a(x)} = x$, the expression simplifies:\n$$c = 3.2 \\times \\frac{4}{5}$$\nConverting the fraction to a decimal, $\\frac{4}{5} = 0.8$:\n$$c = 3.2 \\times 0.8$$\nPerforming the multiplication:\n$$c = 2.56$$\nThe problem requires the final numerical result to be rounded to four significant figures. The calculated value $2.56$ can be expressed with four significant figures by adding a trailing zero: $2.560$.", "answer": "$$\\boxed{2.560}$$", "id": "5104093"}, {"introduction": "Clinical samples, particularly tumors, are rarely pure; they are mixtures of cancerous and normal cells. This cellular heterogeneity attenuates the CNV signal, posing a significant challenge for accurate analysis. This advanced practice introduces a mixture model to account for tumor purity $\\pi$, demonstrating how the presence of normal cells systematically reduces the amplitude of observed log-ratios. By learning to deconvolve this signal to solve for tumor purity, you will master a critical skill for robustly interpreting CNV data in a realistic clinical oncology context [@problem_id:5104100].", "problem": "In a targeted oncology assay using Next-Generation Sequencing (NGS), copy number variation (CNV) calling is performed by comparing normalized read depth in a tumor specimen to a matched normal control. Assume the following foundational principles: (i) normalized read depth is proportional to absolute DNA copy number in the assayed region, (ii) the tumor specimen consists of a mixture of tumor cells and non-tumor (normal) cells, with tumor purity $\\pi$ representing the fraction of tumor cells, (iii) the normal cells have baseline ploidy $p$, and (iv) the log-ratio signal is defined as the base-$2$ logarithm of the ratio of tumor coverage to normal coverage. Consider a genomic segment with a clonal tumor copy state $c_t$ and baseline ploidy $p$, and let $r$ denote the expected log-ratio signal for that segment under these assumptions.\n\nTask 1 (derivation): Starting from the proportionality of read depth to absolute copy number and the linearity of mixture contributions from tumor and normal cells, derive a closed-form expression for $r$ in terms of $\\pi$, $c_t$, and $p$.\n\nTask 2 (application to interpret amplitudes): In an immuno-oncology gene panel where $p=2$, two independent segments are observed with known clonal tumor states from orthogonal allele-specific analysis: Segment A has $c_t=1$ (single-copy loss) and Segment B has $c_t=3$ (single-copy gain). Their observed log-ratio amplitudes (computed from normalized read depths) are $r_A=-0.32193$ and $r_B=0.26303$, respectively. Under the model from Task 1, compute a single tumor purity $\\pi$ that is consistent with both segments.\n\nReport the final value of $\\pi$ rounded to three significant figures and express it as a decimal (unitless). Provide only the numeric value in your final answer.", "solution": "The problem statement has been critically examined and is deemed valid. It is scientifically grounded in the standard theoretical model for inferring copy number variation from bulk next-generation sequencing data, is well-posed with sufficient and consistent information for a unique solution, and is expressed in objective, formal language. There are no identifiable flaws related to scientific unsoundness, incompleteness, or ambiguity.\n\nThe solution proceeds in two parts as requested.\n\n**Task 1: Derivation of the log-ratio signal expression**\n\nLet $D$ denote the normalized read depth and $C$ denote the absolute DNA copy number of a genomic segment.\nFrom principle (i), the read depth is proportional to the copy number. We can express this relationship with a proportionality constant, $k$:\n$$D = kC$$\nFor the matched normal control sample, the cells are assumed to be diploid (or of a general baseline ploidy $p$), so the absolute copy number is $C_{normal} = p$. The corresponding normalized read depth is:\n$$D_{normal} = kp$$\nFor the tumor specimen, which is a mixture of cells, the overall read depth is determined by the average absolute copy number across the cell population. According to principle (ii), the specimen is composed of a fraction $\\pi$ of tumor cells and a fraction $(1-\\pi)$ of non-tumor (normal) cells. The tumor cells have a clonal copy state $c_t$, and the normal cells have a copy number $p$. The average absolute copy number in the tumor specimen, $C_{tumor\\_mix}$, is the weighted average of the copy numbers of the constituent cell types:\n$$C_{tumor\\_mix} = \\pi \\cdot c_t + (1-\\pi) \\cdot p$$\nConsequently, the expected normalized read depth for the tumor specimen is:\n$$D_{tumor\\_mix} = k \\cdot C_{tumor\\_mix} = k(\\pi c_t + (1-\\pi)p)$$\nThe log-ratio signal, $r$, is defined as the base-$2$ logarithm of the ratio of tumor coverage to normal coverage. Substituting the expressions for $D_{tumor\\_mix}$ and $D_{normal}$:\n$$r = \\log_2\\left(\\frac{D_{tumor\\_mix}}{D_{normal}}\\right) = \\log_2\\left(\\frac{k(\\pi c_t + (1-\\pi)p)}{kp}\\right)$$\nThe proportionality constant $k$, which depends on sequencing technology and library preparation, is cancelled out in the ratio. This cancellation is fundamental to the robustness of log-ratio based CNV analysis. The final closed-form expression for $r$ is:\n$$r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)p}{p}\\right)$$\nThis can be rearranged slightly to highlight the deviation from the baseline:\n$$r = \\log_2\\left(\\frac{\\pi c_t + p - \\pi p}{p}\\right) = \\log_2\\left(1 + \\frac{\\pi(c_t - p)}{p}\\right)$$\n\n**Task 2: Application to compute tumor purity**\n\nThe problem provides data for two segments from an assay with a baseline ploidy $p=2$. We are asked to compute a single tumor purity $\\pi$ consistent with the data from both segments.\n\nThe derived expression is $r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)p}{p}\\right)$. With $p=2$, this becomes:\n$$r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)2}{2}\\right)$$\n\nFor Segment A: $c_t = 1$ (single-copy loss) and $r_A = -0.32193$.\nSubstituting these values into the expression:\n$$-0.32193 = \\log_2\\left(\\frac{\\pi(1) + (1-\\pi)2}{2}\\right)$$\n$$-0.32193 = \\log_2\\left(\\frac{\\pi + 2 - 2\\pi}{2}\\right)$$\n$$-0.32193 = \\log_2\\left(\\frac{2 - \\pi}{2}\\right)$$\nTo solve for $\\pi$, we exponentiate both sides with base $2$:\n$$2^{-0.32193} = \\frac{2 - \\pi}{2}$$\nThe value $-0.32193$ is a high-precision approximation of $\\log_2(0.8)$. Therefore, $2^{-0.32193} \\approx 0.8$.\n$$0.8 = \\frac{2 - \\pi}{2}$$\n$$1.6 = 2 - \\pi$$\n$$\\pi = 2 - 1.6 = 0.4$$\n\nFor Segment B: $c_t = 3$ (single-copy gain) and $r_B = 0.26303$.\nWe perform a similar substitution to verify the consistency of $\\pi$.\n$$0.26303 = \\log_2\\left(\\frac{\\pi(3) + (1-\\pi)2}{2}\\right)$$\n$$0.26303 = \\log_2\\left(\\frac{3\\pi + 2 - 2\\pi}{2}\\right)$$\n$$0.26303 = \\log_2\\left(\\frac{2 + \\pi}{2}\\right)$$\nExponentiating both sides:\n$$2^{0.26303} = \\frac{2 + \\pi}{2}$$\nThe value $0.26303$ is a high-precision approximation of $\\log_2(1.2)$. Therefore, $2^{0.26303} \\approx 1.2$.\n$$1.2 = \\frac{2 + \\pi}{2}$$\n$$2.4 = 2 + \\pi$$\n$$\\pi = 2.4 - 2 = 0.4$$\nBoth segments independently yield a tumor purity of $\\pi = 0.4$. This confirms the internal consistency of the provided data under the derived model.\n\nThe question asks for the final value of $\\pi$ rounded to three significant figures. The value $0.4$ expressed to three significant figures is $0.400$.", "answer": "$$\\boxed{0.400}$$", "id": "5104100"}]}