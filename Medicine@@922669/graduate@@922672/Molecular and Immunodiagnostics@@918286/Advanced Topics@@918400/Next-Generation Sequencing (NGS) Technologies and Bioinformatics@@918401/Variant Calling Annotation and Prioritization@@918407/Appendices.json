{"hands_on_practices": [{"introduction": "The foundation of reliable variant calling lies in accurately assessing the quality of each base in a sequencing read. This exercise delves into the Phred quality score, the standard metric used in bioinformatics to quantify the probability of a base-calling error. By working through the logarithmic scale, you will gain a practical understanding of how these scores translate into concrete error probabilities, a crucial skill for filtering raw sequencing data and interpreting variant calls [@problem_id:5170233].", "problem": "In high-throughput sequencing used in molecular and immunodiagnostics, base calls are reported with a Phred quality score that encodes the posterior probability of an incorrect base call, which is essential for variant calling, annotation, and prioritization. Provide a precise definition of the Phred quality score as a logarithmic transformation of the base-call error probability, and, starting from this definition, derive the explicit mapping from the reported base quality $Q$ to the corresponding error probability $p$. Then, evaluate $p$ for $Q=30$ and $Q=20$. Express each $p$ as an exact base-$10$ decimal without rounding.", "solution": "The Phred quality score, denoted by $Q$, provides a quantitative measure of the quality of a base call in sequencing data. It is defined as the negative base-$10$ logarithm of the posterior probability, $p$, that the corresponding base call is incorrect. The mathematical definition is:\n$$Q = -10 \\log_{10}(p)$$\nThe negative sign ensures that a lower error probability $p$ corresponds to a higher quality score $Q$. The factor of $10$ scales the score into a convenient integer range.\n\nTo derive the explicit mapping from the quality score $Q$ to the error probability $p$, we must algebraically solve the defining equation for $p$.\nStarting with the definition:\n$$Q = -10 \\log_{10}(p)$$\nFirst, we isolate the logarithmic term by dividing both sides of the equation by $-10$:\n$$-\\frac{Q}{10} = \\log_{10}(p)$$\nNext, to eliminate the base-$10$ logarithm, we apply its inverse function, which is the base-$10$ exponential function. We raise $10$ to the power of each side of the equation:\n$$10^{\\left(-\\frac{Q}{10}\\right)} = 10^{\\log_{10}(p)}$$\nBy the definition of a logarithm and its inverse, $10^{\\log_{10}(p)} = p$. Therefore, we arrive at the explicit mapping from $Q$ to $p$:\n$$p = 10^{-\\frac{Q}{10}}$$\nThis equation allows for the direct calculation of the base-call error probability $p$ from a given Phred quality score $Q$.\n\nWe now use this derived formula to evaluate $p$ for the specified values of $Q$.\n\nFor a Phred quality score of $Q=30$:\nWe substitute $Q=30$ into the equation for $p$:\n$$p = 10^{-\\frac{30}{10}}$$\n$$p = 10^{-3}$$\nAs an exact base-$10$ decimal, this is:\n$$p = \\frac{1}{10^3} = \\frac{1}{1000} = 0.001$$\nThis corresponds to a $1$ in $1000$ chance of an incorrect base call, or a base-call accuracy of $99.9\\%$.\n\nFor a Phred quality score of $Q=20$:\nWe substitute $Q=20$ into the equation for $p$:\n$$p = 10^{-\\frac{20}{10}}$$\n$$p = 10^{-2}$$\nAs an exact base-$10$ decimal, this is:\n$$p = \\frac{1}{10^2} = \\frac{1}{100} = 0.01$$\nThis corresponds to a $1$ in $100$ chance of an incorrect base call, or a base-call accuracy of $99\\%$.\n\nThe evaluated probabilities for $Q=30$ and $Q=20$ are $0.001$ and $0.01$, respectively.", "answer": "$$\\boxed{\\begin{pmatrix} 0.001 & 0.01 \\end{pmatrix}}$$", "id": "5170233"}, {"introduction": "After a variant is identified, the pivotal next step is to predict its biological impact, a process known as annotation. This practice simulates the annotation of a single nucleotide variant (SNV) by tracing its effect from the DNA level to the protein level, guided by the central dogma of molecular biology. You will determine the resulting amino acid change and then apply quantitative physicochemical criteria to classify its potential functional significance, a key task in variant prioritization [@problem_id:5170206].", "problem": "A clinical Next-Generation Sequencing (NGS) assay identifies a Single Nucleotide Variant (SNV) in the Complementary DNA (cDNA) coding sequence of an immunoglobulin heavy chain variable region fragment. The cDNA (coding strand) sequence is:\n\nATGAAATTCGCTGACTTTGGACCCTAA\n\nAssume standard nuclear genetic code translation, and that translation initiates at the first base of the sequence shown. The SNV is at cDNA position $4$ (counting the first base of the sequence as position $1$), with reference base $\\mathrm{A}$ and alternate base $\\mathrm{G}$, i.e., $\\mathrm{A} \\rightarrow \\mathrm{G}$ at position $4$.\n\nStarting from core definitions of reading frame and codons under the Central Dogma of molecular biology, determine the codon affected by the SNV, the original and variant codons, and the corresponding amino acid substitution under the standard genetic code. Then, classify whether the change is conservative by physicochemical criteria defined as follows: a substitution is considered conservative if the absolute difference in the Kyte–Doolittle hydropathy index is less than or equal to $0.5$ and the side-chain charge class at physiological pH remains unchanged between the two amino acids; otherwise, it is non-conservative. For hydropathy, use the Kyte–Doolittle hydropathy index (unitless) values $H_{\\mathrm{Lys}}=-3.9$ for Lysine and $H_{\\mathrm{Glu}}=-3.5$ for Glutamate. For charge class, use the well-tested biochemical fact that Lysine is positively charged and Glutamate is negatively charged at physiological pH.\n\nCompute the absolute hydropathy difference $|\\Delta H|$ between the original and variant amino acids. Round your final numerical answer to $3$ significant figures. Express your final answer as a pure number without units.", "solution": "The Central Dogma of molecular biology dictates that a DNA sequence is transcribed into RNA, which is then translated into a protein. In this problem, we are given a cDNA sequence, which is equivalent to the mRNA sequence (with Thymine (T) instead of Uracil (U)). Translation proceeds by reading the sequence in non-overlapping groups of three nucleotides, called codons. The reading frame determines how the sequence is partitioned into codons.\n\nThe given cDNA sequence is: `ATGAAATTCGCTGACTTTGGACCCTAA`.\nTranslation is stated to initiate at the first base, so the reading frame starts at position $1$. The sequence is parsed into codons as follows:\n-   Codon 1: `ATG` (bases $1, 2, 3$)\n-   Codon 2: `AAA` (bases $4, 5, 6$)\n-   Codon 3: `TTC` (bases $7, 8, 9$)\n-   and so on.\n\nThe SNV is at position $4$, which is the first nucleotide of the second codon. The original (reference) sequence has an Adenine (`A`) at this position. The second codon is therefore `AAA`.\nThe SNV is an $\\mathrm{A} \\rightarrow \\mathrm{G}$ substitution at this position. The variant sequence at this location becomes `ATGGAA...`. The new, variant codon is `GAA`.\n\nNext, we translate the original and variant codons into their corresponding amino acids using the standard genetic code.\n-   Original codon `AAA`: This codon encodes the amino acid Lysine (Lys).\n-   Variant codon `GAA`: This codon encodes the amino acid Glutamic acid (Glu).\nThe resulting amino acid substitution is Lysine to Glutamic acid, denoted as Lys $\\rightarrow$ Glu.\n\nNow, we must classify this substitution as conservative or non-conservative based on the two specified criteria.\n1.  **Hydropathy Difference:** The absolute difference in the Kyte–Doolittle hydropathy index, $|\\Delta H|$, must be less than or equal to $0.5$.\n    The given hydropathy values are $H_{\\mathrm{Lys}} = -3.9$ and $H_{\\mathrm{Glu}} = -3.5$.\n    We compute the absolute difference:\n    $$|\\Delta H| = |H_{\\mathrm{Glu}} - H_{\\mathrm{Lys}}| = |-3.5 - (-3.9)| = |-3.5 + 3.9| = |0.4| = 0.4$$\n    The condition is $|\\Delta H| \\le 0.5$. Since $0.4 \\le 0.5$, this condition is met.\n\n2.  **Charge Class:** The side-chain charge class at physiological pH must remain unchanged.\n    The problem states that Lysine is a positively charged amino acid and Glutamate is a negatively charged amino acid at physiological pH.\n    The charge changes from positive to negative. Therefore, the charge class does not remain unchanged. This condition is not met.\n\nA substitution is defined as conservative only if **both** criteria are satisfied. Since the second criterion (unchanged charge class) is not met, the Lys $\\rightarrow$ Glu substitution is classified as non-conservative.\n\nThe problem asks for the computation of the absolute hydropathy difference $|\\Delta H|$ and to round the result to $3$ significant figures.\nThe calculated value is:\n$$|\\Delta H| = 0.4$$\nTo express this with $3$ significant figures, we write it as $0.400$.", "answer": "$$\\boxed{0.400}$$", "id": "5170206"}, {"introduction": "Deciding whether a variant is pathogenic is a complex process of evidence synthesis, mirroring the framework used in clinical guidelines. This exercise introduces a powerful Bayesian approach for integrating diverse data types—such as genetic segregation, case-control studies, and functional assays—into a single, coherent estimate of pathogenicity. By calculating a posterior probability from a set of likelihood ratios, you will practice the quantitative reasoning that underpins modern variant prioritization [@problem_id:5170293].", "problem": "A rare missense variant in a cytokine receptor gene implicated in primary immunodeficiency is being evaluated for pathogenicity using molecular and immunodiagnostic evidence. A gene- and variant-class–specific baseline prior probability of pathogenicity is available from historical curation: the prior probability is $P_{0} = 0.02$. Independent lines of evidence have been gathered and calibrated to quantitative likelihood ratios, each defined as $LR = \\frac{P(\\text{evidence} \\mid \\text{pathogenic})}{P(\\text{evidence} \\mid \\text{benign})}$. The available evidence and their calibrated likelihood ratios are:\n- Familial co-segregation analysis across three generations yields a Bayes factor for segregation $BF_{\\text{seg}} = 5.0$, to be treated as a likelihood ratio $LR_{\\text{seg}} = 5.0$.\n- Case-control enrichment in affected cohorts versus controls yields $LR_{\\text{case}} = 8.5$.\n- A functional cell-based assay shows signaling activity reduced to $15\\%$ of wild-type, and the assay calibration maps this result to $LR_{\\text{func}} = 12.0$.\n- Population constraint analysis indicates the variant’s observed allele frequency is somewhat higher than expected for a fully penetrant disorder; this maps to a benign-supporting likelihood ratio $LR_{\\text{pop}} = 0.2$.\n- An ensemble computational prediction calibrated against gold-standard variant sets yields $LR_{\\text{comp}} = 3.2$.\n\nAssume that, conditional on the true pathogenicity state, these evidence components are independent and multiplicative in the odds framework. Starting only from Bayes’ theorem and the definition of odds, derive an analytic expression for the posterior probability of pathogenicity $P_{1} = P(\\text{pathogenic} \\mid \\text{all evidence})$ in terms of $P_{0}$ and the provided likelihood ratios, and then compute its numerical value for the given data. Report both the prior probability $P_{0}$ and the posterior probability $P_{1}$ as decimals, each rounded to four significant figures. Percentages must be expressed as decimals.", "solution": "The problem asks for the derivation and calculation of the posterior probability of pathogenicity, `$P_1$`, given a prior probability `$P_0$` and several independent lines of evidence quantified as likelihood ratios (`$LR$`).\n\nLet `$H_P$` be the hypothesis that the variant is pathogenic and `$H_B$` be the hypothesis that the variant is benign. The problem provides the prior probability of pathogenicity:\n$$P(H_P) = P_0 = 0.02$$\nThe prior probability of the variant being benign is therefore:\n$$P(H_B) = 1 - P(H_P) = 1 - P_0 = 1 - 0.02 = 0.98$$\n\nThe relationship between probability and odds is given by `$O = \\frac{P}{1-P}$`. The prior odds of pathogenicity are:\n$$O_{\\text{prior}} = \\frac{P(H_P)}{P(H_B)} = \\frac{P_0}{1-P_0}$$\n\nBayes' theorem can be expressed in terms of odds and likelihood ratios. For a single piece of evidence `$E$`, the posterior odds are the product of the prior odds and the likelihood ratio for that evidence:\n$$\\text{Posterior Odds} = \\text{Prior Odds} \\times \\text{Likelihood Ratio}$$\n$$O_{\\text{posterior}} = O_{\\text{prior}} \\times LR$$\nwhere the likelihood ratio is defined as `$LR = \\frac{P(E \\mid H_P)}{P(E \\mid H_B)}$`.\n\nThe problem states that there are multiple independent lines of evidence, denoted collectively as `$\\mathcal{E} = \\{E_{\\text{seg}}, E_{\\text{case}}, E_{\\text{func}}, E_{\\text{pop}}, E_{\\text{comp}}\\}$`. The condition of independence, given the true pathogenic state, implies that the joint likelihood is the product of the individual likelihoods:\n$$P(\\mathcal{E} \\mid H_P) = \\prod_{i} P(E_i \\mid H_P)$$\n$$P(\\mathcal{E} \\mid H_B) = \\prod_{i} P(E_i \\mid H_B)$$\nTherefore, the total likelihood ratio `$LR_{\\text{total}}$` for all evidence combined is the product of the individual likelihood ratios:\n$$LR_{\\text{total}} = \\frac{P(\\mathcal{E} \\mid H_P)}{P(\\mathcal{E} \\mid H_B)} = \\frac{\\prod_{i} P(E_i \\mid H_P)}{\\prod_{i} P(E_i \\mid H_B)} = \\prod_{i} \\frac{P(E_i \\mid H_P)}{P(E_i \\mid H_B)} = \\prod_{i} LR_i$$\nSpecifically:\n$$LR_{\\text{total}} = LR_{\\text{seg}} \\times LR_{\\text{case}} \\times LR_{\\text{func}} \\times LR_{\\text{pop}} \\times LR_{\\text{comp}}$$\n\nThe posterior odds of pathogenicity, given all evidence, are:\n$$O_{\\text{posterior}} = O_{\\text{prior}} \\times LR_{\\text{total}} = \\frac{P_0}{1-P_0} \\times \\prod_{i} LR_i$$\n\nThe posterior probability, `$P_1 = P(H_P \\mid \\mathcal{E})$`, can be recovered from the posterior odds using the formula `$P_1 = \\frac{O_{\\text{posterior}}}{1 + O_{\\text{posterior}}}$`. Substituting the expression for `$O_{\\text{posterior}}$` gives the desired analytic expression for `$P_1$` in terms of `$P_0$` and the likelihood ratios:\n$$P_1 = \\frac{\\left(\\frac{P_0}{1-P_0}\\right) \\prod_{i} LR_i}{1 + \\left(\\frac{P_0}{1-P_0}\\right) \\prod_{i} LR_i}$$\nTo simplify, multiply the numerator and denominator by `$(1-P_0)``:\n$$P_1 = \\frac{P_0 \\prod_{i} LR_i}{(1-P_0) + P_0 \\prod_{i} LR_i}$$\n\nNow, we compute the numerical value. The given likelihood ratios are:\n`$LR_{\\text{seg}} = 5.0$`\n`$LR_{\\text{case}} = 8.5$`\n`$LR_{\\text{func}} = 12.0$`\n`$LR_{\\text{pop}} = 0.2$`\n`$LR_{\\text{comp}} = 3.2$`\n\nFirst, calculate the total likelihood ratio `$LR_{\\text{total}}$`:\n$$LR_{\\text{total}} = 5.0 \\times 8.5 \\times 12.0 \\times 0.2 \\times 3.2$$\n$$LR_{\\text{total}} = 326.4$$\n\nNext, we use the derived formula for `$P_1$`. Let `$X = P_0 \\times LR_{\\text{total}}$`.\n$$X = 0.02 \\times 326.4 = 6.528$$\nNow substitute `$X$` into the formula for `$P_1$`:\n$$P_1 = \\frac{X}{(1-P_0) + X} = \\frac{6.528}{(1-0.02) + 6.528} = \\frac{6.528}{0.98 + 6.528} = \\frac{6.528}{7.508}$$\n$$P_1 \\approx 0.8694725625998934$$\n\nThe problem requires reporting both `$P_0$` and `$P_1$` rounded to four significant figures.\nThe prior probability `$P_0 = 0.02$`. To four significant figures, this is `$0.02000$`.\nThe posterior probability `$P_1 \\approx 0.86947256...$`. Rounding to four significant figures gives `$0.8695$`.\n\nThus, the prior probability of pathogenicity is `$P_0 = 0.02000$`, and the posterior probability after considering all evidence is `$P_1 = 0.8695$`.", "answer": "$$\\boxed{\\begin{pmatrix} 0.02000 & 0.8695 \\end{pmatrix}}$$", "id": "5170293"}]}