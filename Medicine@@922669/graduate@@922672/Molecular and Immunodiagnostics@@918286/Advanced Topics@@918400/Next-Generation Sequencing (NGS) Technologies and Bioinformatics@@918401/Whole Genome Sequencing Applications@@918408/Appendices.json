{"hands_on_practices": [{"introduction": "Before interpreting any results from a Whole Genome Sequencing (WGS) pipeline, we must first rigorously assess its performance. This practice guides you through the fundamental process of evaluating a variant caller by comparing its predictions against a \"gold standard\" truth set. You will derive and calculate the core metrics of diagnostic accuracy—sensitivity, specificity, precision, and the $F_1$-score—to quantify the pipeline's reliability in distinguishing true variants from noise [@problem_id:5171851].", "problem": "A laboratory implementing Whole Genome Sequencing (WGS) for molecular and immunodiagnostics has developed a variant calling pipeline to detect genomic variants associated with immune function genes across a callable region of $1{,}200{,}000$ sites in a single sample. A curated gold-standard truth set for this sample indicates that $2{,}400$ sites are truly variant (positives) and the remaining sites are truly non-variant (negatives). The pipeline’s predictions are compared against the truth set at each site, yielding the following confusion counts: true positives $TP = 2{,}312$, false positives $FP = 64$, false negatives $FN = 88$, and true negatives $TN = 1{,}197{,}536$.\n\nStarting from core definitions in diagnostic testing and binary classification, where a “positive” event corresponds to “variant present at a site” and a “negative” event corresponds to “variant absent at a site,” derive expressions for sensitivity (true positive rate), specificity (true negative rate), precision (positive predictive value), recall, and the $F_{1}$-score in terms of $TP$, $FP$, $TN$, and $FN$. Then compute these five metrics for the given counts. Round each computed metric to four significant figures and express the results as decimal fractions. The final answer must be a single row vector listing sensitivity, specificity, precision, recall, and $F_{1}$-score in that order.", "solution": "The problem provides a set of confusion matrix counts from a whole genome sequencing (WGS) variant calling pipeline and asks for the derivation and computation of five standard performance metrics. First, we must validate the problem statement.\n\nThe givens are:\n- Total callable sites: $1,200,000$\n- True positives in truth set (actual variants): $2,400$\n- True negatives in truth set (actual non-variants): $1,200,000 - 2,400 = 1,197,600$\n- Pipeline confusion counts:\n  - True Positives ($TP$): $2,312$\n  - False Positives ($FP$): $64$\n  - False Negatives ($FN$): $88$\n  - True Negatives ($TN$): $1,197,536$\n\nWe check for internal consistency.\nThe total number of actual positives is the sum of variants correctly identified ($TP$) and variants missed ($FN$):\n$P = TP + FN = 2,312 + 88 = 2,400$. This matches the given number of true variant sites.\nThe total number of actual negatives is the sum of non-variants correctly identified ($TN$) and non-variants incorrectly called as variants ($FP$):\n$N = TN + FP = 1,197,536 + 64 = 1,197,600$. This matches the calculated number of true non-variant sites.\nThe total number of sites is $P + N = 2,400 + 1,197,600 = 1,200,000$, which matches the total callable region size.\nThe problem is self-contained, scientifically grounded in the field of bioinformatics and diagnostics, and internally consistent. It is a valid, well-posed problem.\n\nWe now proceed to the solution. The core task is to derive and calculate sensitivity, specificity, precision, recall, and the $F_1$-score. A \"positive\" event is the presence of a variant at a site, and a \"negative\" event is its absence.\n\n1.  **Sensitivity (True Positive Rate, TPR)**\n    Sensitivity measures the proportion of actual positives that are correctly identified by the test. It is the probability of a positive test result, given that the site is truly a variant. The total number of actual positives is $P = TP + FN$.\n    The expression for sensitivity is:\n    $$ \\text{Sensitivity} = \\frac{TP}{P} = \\frac{TP}{TP + FN} $$\n    The term **Recall** is a synonym for sensitivity in information retrieval and machine learning contexts. Therefore, the expression for recall is identical:\n    $$ \\text{Recall} = \\frac{TP}{TP + FN} $$\n\n2.  **Specificity (True Negative Rate, TNR)**\n    Specificity measures the proportion of actual negatives that are correctly identified by the test. It is the probability of a negative test result, given that the site is truly non-variant. The total number of actual negatives is $N = TN + FP$.\n    The expression for specificity is:\n    $$ \\text{Specificity} = \\frac{TN}{N} = \\frac{TN}{TN + FP} $$\n\n3.  **Precision (Positive Predictive Value, PPV)**\n    Precision measures the proportion of predicted positives that are actually positive. It is the probability that a site is truly a variant, given that the test result is positive. The total number of predicted positives is $TP + FP$.\n    The expression for precision is:\n    $$ \\text{Precision} = \\frac{TP}{TP + FP} $$\n\n4.  **$F_1$-Score**\n    The $F_1$-score is the harmonic mean of precision and recall. It is a balanced measure that accounts for both false positives and false negatives. The general formula for the $F$-score is $F_{\\beta} = (1+\\beta^2) \\frac{\\text{Precision} \\cdot \\text{Recall}}{(\\beta^2 \\cdot \\text{Precision}) + \\text{Recall}}$. The $F_1$-score sets $\\beta = 1$.\n    The expression for the $F_1$-score is:\n    $$ F_1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} $$\n    Substituting the expressions for precision and recall in terms of $TP$, $FP$, and $FN$:\n    $$ F_1 = 2 \\cdot \\frac{\\left( \\frac{TP}{TP+FP} \\right) \\cdot \\left( \\frac{TP}{TP+FN} \\right)}{\\left( \\frac{TP}{TP+FP} \\right) + \\left( \\frac{TP}{TP+FN} \\right)} = \\frac{2 \\cdot \\frac{TP^2}{(TP+FP)(TP+FN)}}{\\frac{TP(TP+FN) + TP(TP+FP)}{(TP+FP)(TP+FN)}} = \\frac{2 \\cdot TP^2}{TP(TP+FN) + TP(TP+FP)} $$\n    This simplifies to:\n    $$ F_1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} $$\n\nNow, we compute these five metrics using the provided counts: $TP = 2,312$, $FP = 64$, $FN = 88$, and $TN = 1,197,536$. We round each result to four significant figures.\n\n-   **Sensitivity / Recall**:\n    $$ \\text{Sensitivity} = \\text{Recall} = \\frac{2,312}{2,312 + 88} = \\frac{2,312}{2,400} = 0.963333... \\approx 0.9633 $$\n\n-   **Specificity**:\n    $$ \\text{Specificity} = \\frac{1,197,536}{1,197,536 + 64} = \\frac{1,197,536}{1,197,600} = 0.999946559... \\approx 0.9999 $$\n\n-   **Precision**:\n    $$ \\text{Precision} = \\frac{2,312}{2,312 + 64} = \\frac{2,312}{2,376} = 0.973063973... \\approx 0.9731 $$\n\n-   **$F_1$-Score**:\n    Using the simplified formula:\n    $$ F_1 = \\frac{2 \\cdot 2,312}{2 \\cdot 2,312 + 64 + 88} = \\frac{4,624}{4,624 + 152} = \\frac{4,624}{4,776} = 0.9681741... \\approx 0.9682 $$\n\nThe final computed values, rounded to four significant figures, are:\n- Sensitivity: $0.9633$\n- Specificity: $0.9999$\n- Precision: $0.9731$\n- Recall: $0.9633$\n- $F_1$-Score: $0.9682$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9633  0.9999  0.9731  0.9633  0.9682\n\\end{pmatrix}\n}\n$$", "id": "5171851"}, {"introduction": "Whole Genome Sequencing offers more than just the binary presence or absence of a variant; it provides quantitative insights into the cellular composition of a sample. This exercise delves into the analysis of tumor biopsies, which are often a mixture of cancerous and normal cells. By modeling the contributions of each cell type from first principles, you will derive a foundational equation that links the observed Variant Allele Fraction ($VAF$) to key biological parameters like tumor purity ($p$) and somatic copy number ($CN$) [@problem_id:5171705].", "problem": "A clinical molecular and immunodiagnostics laboratory uses Whole Genome Sequencing (WGS) to quantify somatic Single Nucleotide Variants (SNVs) in tumor biopsies that contain a mixture of tumor and normal cells. The Variant Allele Fraction (VAF) is defined as the expected fraction of sequencing reads that carry the variant allele among all reads covering the locus. Assume the following widely accepted model of WGS sampling and tumor-normal admixture:\n- Sequencing reads are sampled uniformly at random from allelic copies present in the sample, and read counts reflect the underlying allelic copy counts.\n- The biopsy is a mixture of tumor cells with fraction (tumor purity) $p$ and normal cells with fraction $(1-p)$.\n- Normal cells are diploid at the locus with total copy number $2$ and carry no variant alleles for a somatic SNV.\n- Tumor cells have total copy number $CN$ at the locus, and the somatic SNV is clonal (present in all tumor cells) and heterozygous, meaning it resides on exactly one of the $CN$ allelic copies in each tumor cell.\nUsing only these definitions and assumptions, derive a closed-form expression for the expected VAF as a function of $p$ and $CN$. Your final answer must be a single analytic expression. Do not introduce any additional variables beyond $p$ and $CN$. No rounding is required, and no units should be included in your final answer.", "solution": "The problem requires the derivation of a closed-form expression for the expected Variant Allele Fraction (VAF) in a mixed tumor-normal sample. The VAF is defined as the expected fraction of sequencing reads that carry the variant allele among all reads covering the locus. Based on the provided assumption that read counts are sampled uniformly and reflect the underlying allelic copy counts, the VAF can be modeled as the ratio of the total number of variant allelic copies to the total number of all allelic copies at the specific locus within the entire cell population of the biopsy.\n\nLet the tumor purity, which is the fraction of tumor cells in the biopsy, be denoted by $p$, where $0 \\le p \\le 1$. Consequently, the fraction of normal cells is $1-p$.\n\nWe will calculate the total number of variant alleles and the total number of all alleles at the locus in a representative sample. Since we are calculating a fraction, the absolute number of cells in the sample is irrelevant; we can work directly with the proportions of each cell type and their genetic content. The contributions to the total allele pool are weighted by the cell fractions and their respective copy numbers.\n\nFirst, we determine the numerator of the VAF expression: the total number of variant allelic copies.\nThe total number of variant alleles is the sum of contributions from the normal and tumor cell populations.\n- **Normal cells:** These cells constitute a fraction $1-p$ of the cell population. According to the problem statement, normal cells are diploid and carry no variant alleles for a somatic SNV. Therefore, their contribution to the count of variant alleles is proportional to $(1-p) \\times 0 = 0$.\n- **Tumor cells:** These cells constitute a fraction $p$ of the population. The problem states that the somatic SNV is clonal (present in all tumor cells) and heterozygous. Heterozygous in this context means the variant resides on exactly $1$ of the $CN$ total allelic copies in each tumor cell, where $CN$ is the total copy number in tumor cells at that locus. Thus, each tumor cell contributes exactly $1$ variant allele. Their contribution to the count of variant alleles is proportional to $p \\times 1 = p$.\n\nThe total proportional count of variant alleles in the mixed sample, which we can denote as $N_{var}$, is the sum of these contributions:\n$$ N_{var} \\propto p \\times 1 + (1-p) \\times 0 = p $$\n\nNext, we determine the denominator of the VAF expression: the total number of all allelic copies at the locus, including both variant and non-variant (wild-type) alleles.\n- **Normal cells:** These cells, making up a fraction $1-p$ of the population, are diploid. This means they have a total copy number of $2$ at the locus. Their contribution to the total allele count is proportional to $(1-p) \\times 2$.\n- **Tumor cells:** These cells, making up a fraction $p$ of the population, have a total copy number of $CN$ at the locus. Their contribution to the total allele count is proportional to $p \\times CN$.\n\nThe total proportional count of all alleles in the mixed sample, which we can denote as $N_{total}$, is the sum of the contributions from both normal and tumor cells:\n$$ N_{total} \\propto (1-p) \\times 2 + p \\times CN = 2(1-p) + p \\cdot CN $$\n\nThe expected VAF is the ratio of the total proportional count of variant alleles to the total proportional count of all alleles. The proportionality constant, which would relate to the total number of cells, cancels out in the ratio.\n$$ \\text{VAF} = \\frac{N_{var}}{N_{total}} = \\frac{p}{2(1-p) + p \\cdot CN} $$\nThis expression provides the expected VAF as a function of the tumor purity $p$ and the tumor-specific copy number $CN$, derived solely from the definitions and assumptions provided in the problem statement.", "answer": "$$\\boxed{\\frac{p}{2(1-p) + p \\cdot CN}}$$", "id": "5171705"}, {"introduction": "A typical human genome contains millions of variants, and the crucial challenge in clinical genomics is to filter this vast list down to a few plausible candidates for a rare disease. This hands-on practice demonstrates a powerful, principled approach using population genetics to set a rational filter threshold. You will learn to calculate the maximum credible population allele frequency for a pathogenic variant, taking into account disease prevalence and penetrance, providing a quantitative basis for using large-scale databases like gnomAD to prioritize variants [@problem_id:5171770].", "problem": "A clinical laboratory uses Whole-Genome Sequencing (WGS) to identify causal variants for a rare autosomal dominant primary immunodeficiency. To prioritize candidate variants, they apply population frequency filtering using the Genome Aggregation Database (gnomAD). From first principles of population genetics and clinical penetrance, derive a maximum credible population allele frequency threshold for a single pathogenic variant that is compatible with the observed disease burden under the following assumptions:\n- The disease prevalence in the general population is $P = \\frac{1}{50{,}000}$.\n- Under Hardy–Weinberg equilibrium (HWE) and the rare-allele approximation, the heterozygote genotype frequency for an allele with population frequency $q$ is approximately $2q$, and the homozygote frequency is negligible.\n- The disease is autosomal dominant, and the clinical penetrance for carriers of the pathogenic variant is $\\pi = 0.50$.\n- Due to locus and allelic heterogeneity, at most a fraction $f_{g} = 0.25$ of all disease cases are attributable to this gene, and at most a fraction $f_{v} = 0.05$ of the gene’s cases are attributable to the specific variant under evaluation.\n- Assume random mating, a stationary population, and that the disease risk from this variant is dominated by heterozygotes.\n\nUsing only the definitions of prevalence, penetrance, and Hardy–Weinberg equilibrium, set up an inequality that upper bounds the contribution of this single variant to the total disease prevalence, and solve it to obtain a closed-form expression for the maximum credible allele frequency $q_{\\max}$ in terms of $P$, $f_{g}$, $f_{v}$, and $\\pi$. Then evaluate $q_{\\max}$ numerically for the values above.\n\nBriefly explain how this threshold would be used with Genome Aggregation Database (gnomAD) data to filter variants in practice, including the rationale for checking ancestry-stratified allele counts.\n\nReport the final value of $q_{\\max}$ as a decimal fraction of alleles. Round your answer to $3$ significant figures.", "solution": "The fundamental base is Hardy–Weinberg equilibrium (HWE), the definition of disease prevalence, and the definition of clinical penetrance. Let $q$ denote the population allele frequency of a rare variant. Under HWE with $p \\approx 1 - q \\approx 1$ and the rare-allele approximation, the heterozygote genotype frequency is approximately $2pq \\approx 2q$, and the homozygote genotype frequency $q^{2}$ is negligible.\n\nFor an autosomal dominant pathogenic variant with clinical penetrance $\\pi$, the fraction of the population that is affected due to this single variant is approximately\n$$\n\\text{prevalence due to variant} \\approx \\pi \\times (2q) = 2\\pi q,\n$$\nwhere we have neglected $q^{2}$ because $q$ is small.\n\nLet $P$ be the overall disease prevalence in the population. Because of genetic heterogeneity, at most a fraction $f_{g}$ of all cases are attributable to the gene, and at most a fraction $f_{v}$ of the gene’s cases are attributable to the specific variant. Therefore, at most a fraction $f_{g} f_{v}$ of all disease cases in the population can be due to this variant. Consequently, the contribution of this variant to the total disease prevalence is upper bounded by\n$$\n\\text{prevalence due to variant} \\leq f_{g} f_{v} P.\n$$\nCombining this with the penetrance-weighted genotype frequency under HWE gives the inequality\n$$\n2 \\pi q \\leq f_{g} f_{v} P.\n$$\nSolving for $q$ yields the closed-form expression for the maximum credible allele frequency:\n$$\nq_{\\max} = \\frac{f_{g} f_{v} P}{2 \\pi}.\n$$\n\nWe now evaluate $q_{\\max}$ numerically for the given values $P = \\frac{1}{50{,}000}$, $f_{g} = 0.25$, $f_{v} = 0.05$, and $\\pi = 0.50$:\n$$\nq_{\\max} = \\frac{\\left(0.25\\right)\\left(0.05\\right)\\left(\\frac{1}{50{,}000}\\right)}{2 \\times 0.50}.\n$$\nFirst compute the numerator factor:\n$$\n0.25 \\times 0.05 = 0.0125,\n$$\nso\n$$\n0.0125 \\times \\frac{1}{50{,}000} = \\frac{0.0125}{50{,}000} = 2.5 \\times 10^{-7}.\n$$\nThe denominator is\n$$\n2 \\times 0.50 = 1.\n$$\nTherefore,\n$$\nq_{\\max} = \\frac{2.5 \\times 10^{-7}}{1} = 2.5 \\times 10^{-7}.\n$$\nRounded to $3$ significant figures, this is $2.50 \\times 10^{-7}$.\n\nApplication to Genome Aggregation Database (gnomAD) filtering: In practice, the laboratory would calculate $q_{\\max}$ for the disease model and use it as an upper bound to filter out variants whose observed population allele frequency in the Genome Aggregation Database (gnomAD) exceeds this threshold in any relevant ancestry group. Because disease risk and allele frequencies can vary by ancestry, and sampling variance can hide subpopulation-specific enrichment, the ancestry-stratified allele counts and frequencies should be checked; a variant that is below $q_{\\max}$ globally but exceeds $q_{\\max}$ in a particular ancestry would be deprioritized for individuals of that ancestry. Additional checks include evaluating confidence in the gnomAD frequency estimate (e.g., coverage and site-level quality), concordance of the variant’s predicted effect with the disease mechanism, and ensuring that the filtering respects the penetrance and heterogeneity assumptions used to compute $q_{\\max}$.", "answer": "$$\\boxed{2.50 \\times 10^{-7}}$$", "id": "5171770"}]}