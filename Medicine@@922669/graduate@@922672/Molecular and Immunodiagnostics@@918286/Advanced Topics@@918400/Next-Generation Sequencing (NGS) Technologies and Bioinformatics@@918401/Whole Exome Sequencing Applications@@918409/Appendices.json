{"hands_on_practices": [{"introduction": "The success of Whole Exome Sequencing begins with the efficiency of hybrid capture, the laboratory process that isolates the mere 1-2% of the genome that codes for proteins. This exercise models the physical chemistry of this enrichment, exploring how laboratory parameters like wash temperature affect the trade-off between capturing target DNA and rejecting non-specific off-target molecules [@problem_id:5171455]. By deriving the fold-enrichment, you will gain a quantitative understanding of how wet-lab choices directly influence the quality and cost-effectiveness of sequencing data.", "problem": "A clinical molecular diagnostics laboratory performs Whole Exome Sequencing (WES) hybrid capture on human genomic DNA for immunogenetics applications. Let the total mappable genome territory be $G = 3.2 \\times 10^{9}$ bases and the exome target territory be $B = 5.0 \\times 10^{7}$ bases. Define the target fraction of the genome as $f_{b} = B/G$. During capture prior to washing, an expected fraction $e_{\\mathrm{on},0}$ of on-target molecules hybridize productively to baits, and an expected fraction $e_{\\mathrm{off},0}$ of off-target molecules cross-hybridize. The wash step at temperature $T$ retains a bound duplex of melting temperature $T_{m}$ with probability $r(T,T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$, where $\\beta$ is a positive constant reflecting the exponential sensitivity of duplex stability to temperature above $T_{m}$. Assume the following experimentally supported parameters: $e_{\\mathrm{on},0} = 0.60$, $e_{\\mathrm{off},0} = 0.020$, $\\beta = 0.50$ in reciprocal degrees Celsius, on-target duplexes have $T_{m,\\mathrm{on}} = 80$ degrees Celsius, and the dominant off-target duplexes have $T_{m,\\mathrm{off}} = 66$ degrees Celsius.\n\nAssume that polymerase chain reaction (PCR) and sequencing are unbiased with respect to on-target versus off-target molecules, so that the fraction of on-target reads after capture and wash at temperature $T$, denoted $f_{\\mathrm{on}}(T)$, equals the fraction of on-target molecules among the retained captured molecules. Define the fold-enrichment at wash temperature $T$ as\n$$\n\\mathrm{FE}(T) = \\frac{f_{\\mathrm{on}}(T)}{f_{b}}.\n$$\nStarting from the definitions of $f_{b}$, $e_{\\mathrm{on},0}$, $e_{\\mathrm{off},0}$, and $r(T,T_{m})$, and using mass conservation of molecules through capture and wash, derive an expression for $\\mathrm{FE}(T)$ and use it to compute the multiplicative change in fold-enrichment when increasing the wash temperature from $T = 72$ degrees Celsius to $T = 76$ degrees Celsius. That is, compute\n$$\nR = \\frac{\\mathrm{FE}(76)}{\\mathrm{FE}(72)}.\n$$\nRound your answer to four significant figures. Express the final result as a dimensionless number.", "solution": "The goal is to derive $\\mathrm{FE}(T)$ from first principles of capture, retention, and proportional sequencing, and then compute the ratio $R = \\mathrm{FE}(76)/\\mathrm{FE}(72)$.\n\nFundamental definitions and assumptions:\n1. The target fraction of the genome is $f_{b} = B/G$.\n2. Prior to washing, the expected fraction of target molecules that become productively captured is $e_{\\mathrm{on},0}$; for off-target molecules the cross-hybridization fraction is $e_{\\mathrm{off},0}$.\n3. At wash temperature $T$, the retention probability for a duplex with melting temperature $T_{m}$ is $r(T,T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$, which is a well-tested empirical dependence reflecting exponential destabilization above $T_{m}$.\n4. The fraction of on-target reads after wash and sequencing, $f_{\\mathrm{on}}(T)$, equals the fraction of on-target molecules among the retained captured molecules, assuming unbiased downstream steps.\n\nLet the total number of input molecules be $N$. The expected number of captured on-target molecules before wash is $N \\cdot f_{b} \\cdot e_{\\mathrm{on},0}$, and the expected number of captured off-target molecules before wash is $N \\cdot (1 - f_{b}) \\cdot e_{\\mathrm{off},0}$. After washing at temperature $T$, the retained counts become\n$$\nC_{\\mathrm{on}}(T) = N \\cdot f_{b} \\cdot e_{\\mathrm{on},0} \\cdot r\\!\\big(T, T_{m,\\mathrm{on}}\\big),\n$$\n$$\nC_{\\mathrm{off}}(T) = N \\cdot (1 - f_{b}) \\cdot e_{\\mathrm{off},0} \\cdot r\\!\\big(T, T_{m,\\mathrm{off}}\\big).\n$$\nTherefore, the fraction of on-target molecules among retained captured molecules is\n$$\nf_{\\mathrm{on}}(T) = \\frac{C_{\\mathrm{on}}(T)}{C_{\\mathrm{on}}(T) + C_{\\mathrm{off}}(T)} = \\frac{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)}.\n$$\nBy definition, fold-enrichment is $\\mathrm{FE}(T) = f_{\\mathrm{on}}(T) / f_{b}$. Substituting the expression for $f_{\\mathrm{on}}(T)$:\n$$\n\\mathrm{FE}(T) = \\frac{1}{f_{b}} \\cdot \\frac{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)} = \\frac{e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)}.\n$$\nWe now evaluate $\\mathrm{FE}(T)$ at $T = 72$ and $T = 76$ degrees Celsius with the given parameters. First compute $f_{b}$:\n$$\nf_{b} = \\frac{B}{G} = \\frac{5.0 \\times 10^{7}}{3.2 \\times 10^{9}} = \\frac{5.0}{320} = 0.015625.\n$$\nThe retention function is $r(T, T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$ with $\\beta = 0.50$. For on-target duplexes with $T_{m,\\mathrm{on}} = 80$,\n$$\nr\\!\\big(72, 80\\big) = \\exp\\!\\big(-0.50 \\cdot \\max(0, 72 - 80)\\big) = \\exp(0) = 1,\n$$\n$$\nr\\!\\big(76, 80\\big) = \\exp\\!\\big(-0.50 \\cdot \\max(0, 76 - 80)\\big) = \\exp(0) = 1.\n$$\nFor off-target duplexes with $T_{m,\\mathrm{off}} = 66$,\n$$\nr\\!\\big(72, 66\\big) = \\exp\\!\\big(-0.50 \\cdot (72 - 66)\\big) = \\exp(-3),\n$$\n$$\nr\\!\\big(76, 66\\big) = \\exp\\!\\big(-0.50 \\cdot (76 - 66)\\big) = \\exp(-5).\n$$\nThe ratio $R$ is\n$$\nR = \\frac{\\mathrm{FE}(76)}{\\mathrm{FE}(72)} = \\frac{\\dfrac{e_{\\mathrm{on},0} \\, r\\!\\big(76, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(76, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(76, T_{m,\\mathrm{off}}\\big)}}{\\dfrac{e_{\\mathrm{on},0} \\, r\\!\\big(72, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(72, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(72, T_{m,\\mathrm{off}}\\big)}}.\n$$\nSince $r(T, T_{m,\\mathrm{on}})$ is 1 for both temperatures, this simplifies to:\n$$\nR = \\frac{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(72, T_{m,\\mathrm{off}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(76, T_{m,\\mathrm{off}}\\big)} = \\frac{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, \\exp(-3)}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, \\exp(-5)}.\n$$\nNow substitute the numerical values $f_{b} = 0.015625$, $e_{\\mathrm{on},0} = 0.60$, $e_{\\mathrm{off},0} = 0.020$:\n$$\nf_{b} \\, e_{\\mathrm{on},0} = 0.015625 \\times 0.60 = 0.009375,\n$$\n$$\n(1 - f_{b}) \\, e_{\\mathrm{off},0} = 0.984375 \\times 0.020 = 0.0196875.\n$$\nThus,\n$$\nR = \\frac{0.009375 + 0.0196875 \\, \\exp(-3)}{0.009375 + 0.0196875 \\, \\exp(-5)}.\n$$\nFor numerical evaluation, it is convenient to clear decimals by multiplying numerator and denominator by $3200$:\n$$\nR = \\frac{30 + 63 \\, \\exp(-3)}{30 + 63 \\, \\exp(-5)}.\n$$\nUsing $\\exp(-3) \\approx 0.049787$ and $\\exp(-5) \\approx 0.006738$,\n$$\nR \\approx \\frac{30 + 63 \\times 0.049787}{30 + 63 \\times 0.006738} \\approx \\frac{30 + 3.13658}{30 + 0.42449} \\approx \\frac{33.13658}{30.42449} \\approx 1.08914.\n$$\nRounding to four significant figures yields\n$$\nR \\approx 1.089.\n$$\nThis dimensionless value quantifies the predicted multiplicative increase in fold-enrichment when increasing wash temperature from $72$ to $76$ degrees Celsius under the stated model and parameters.", "answer": "$$\\boxed{1.089}$$", "id": "5171455"}, {"introduction": "After sequencing, the central challenge becomes distinguishing true genetic variation from the background noise of sequencing errors. This practice delves into the statistical foundation of variant calling, asking you to derive the probability of observing a variant given a specific read depth ($D$) and error rate ($\\epsilon$) [@problem_id:5171424]. Mastering this binomial model is crucial for understanding how bioinformatic tools make decisions and for appreciating the confidence and uncertainty associated with any variant call.", "problem": "In a Whole Exome Sequencing (WES) assay for a germline single-nucleotide variant in a diploid genome, consider a genomic locus that is truly heterozygous. Reads covering the locus have independent base-calling errors with per-base error rate $\\epsilon$, where an error means the true nucleotide is reported as one of the three incorrect nucleotides, each with equal probability. Assume each read is equally likely to derive from either the reference allele or the alternate allele, and that read sampling is independent across the $D$ covering reads. An “alternate read” is defined as a read whose observed base at the locus matches the true alternate allele, not merely a non-reference base. Using a binomial sampling model grounded in the independence of reads and the definition of heterozygosity as a true allele fraction of $\\frac{1}{2}$, derive from first principles the probability of observing at least $k$ alternate reads among $D$ total reads as a function of $D$, $k$, and $\\epsilon$. Express the final probability as a single closed-form analytic expression in terms of $D$, $k$, and $\\epsilon$. No numerical evaluation is required.", "solution": "### Solution Derivation\nThe problem requires the calculation of the probability of observing at least $k$ \"alternate reads\" in a sample of $D$ reads. The reads are independent, and each read has a certain probability of being an \"alternate read\". This is a classic scenario for a binomial distribution. Let $X$ be the random variable representing the number of alternate reads observed out of $D$ total reads. Then $X$ follows a binomial distribution, $X \\sim B(D, p)$, where $p$ is the probability that a single, randomly chosen read is an \"alternate read\". Our first task is to derive this probability $p$.\n\nA read can originate from either the reference allele or the alternate allele. Since the locus is heterozygous in a diploid genome, the probability of a read originating from the reference allele is $\\frac{1}{2}$, and the probability of it originating from the alternate allele is also $\\frac{1}{2}$. Let $R_{alt}$ be the event that a read is derived from the alternate allele, and $R_{ref}$ be the event that it is derived from the reference allele. We have:\n$P(R_{alt}) = \\frac{1}{2}$ and $P(R_{ref}) = \\frac{1}{2}$.\n\nLet $O_{alt}$ be the event that the observed base in the read is the alternate allele (i.e., it is an \"alternate read\"). We can find the total probability of $O_{alt}$ by conditioning on the true origin of the read, using the law of total probability:\n$$p = P(O_{alt}) = P(O_{alt} | R_{alt}) P(R_{alt}) + P(O_{alt} | R_{ref}) P(R_{ref})$$\n\nNow we must determine the two conditional probabilities:\n1.  $P(O_{alt} | R_{alt})$: This is the probability of observing the alternate allele, given the read truly comes from the alternate allele. This occurs if the base is read correctly, which happens with probability $1 - \\epsilon$.\n    $$P(O_{alt} | R_{alt}) = 1 - \\epsilon$$\n\n2.  $P(O_{alt} | R_{ref})$: This is the probability of observing the alternate allele, given the read truly comes from the reference allele. This can only happen if a sequencing error occurs. The probability of an error is $\\epsilon$. The problem states that when an error occurs, the machine reports one of the three incorrect nucleotides with equal probability. Since the true base is the reference, the alternate base is one of these three incorrect options. Thus, the probability of an error specifically resulting in the alternate base is $\\frac{1}{3}$. The combined probability is the product of the probability of an error and the probability of that error producing the alternate base.\n    $$P(O_{alt} | R_{ref}) = \\epsilon \\times \\frac{1}{3} = \\frac{\\epsilon}{3}$$\n\nSubstituting these conditional probabilities back into the equation for $p$:\n$$p = (1 - \\epsilon) \\left(\\frac{1}{2}\\right) + \\left(\\frac{\\epsilon}{3}\\right) \\left(\\frac{1}{2}\\right)$$\n$$p = \\frac{1}{2} - \\frac{\\epsilon}{2} + \\frac{\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{3\\epsilon}{6} + \\frac{\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{2\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{\\epsilon}{3}$$\n\nThe complementary probability, that a read is not an alternate read, is $1-p$:\n$$1-p = 1 - \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right) = \\frac{1}{2} + \\frac{\\epsilon}{3}$$\n\nNow that we have the probability $p$ for a single trial, we can model the total number of alternate reads $X$ in $D$ trials. The probability of observing exactly $i$ alternate reads in $D$ trials is given by the binomial probability mass function:\n$$P(X=i) = \\binom{D}{i} p^i (1-p)^{D-i}$$\n\nThe problem asks for the probability of observing at least $k$ alternate reads, which is $P(X \\ge k)$. This is the sum of probabilities of observing $k, k+1, \\dots, D$ alternate reads:\n$$P(X \\ge k) = \\sum_{i=k}^{D} P(X=i)$$\n$$P(X \\ge k) = \\sum_{i=k}^{D} \\binom{D}{i} p^i (1-p)^{D-i}$$\n\nSubstituting the expressions for $p$ and $1-p$ in terms of $\\epsilon$:\n$$P(X \\ge k) = \\sum_{i=k}^{D} \\binom{D}{i} \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right)^i \\left(\\frac{1}{2} + \\frac{\\epsilon}{3}\\right)^{D-i}$$\n\nThis expression represents the final answer. It is a single, closed-form analytic expression for the desired probability as a function of the given parameters $D$, $k$, and $\\epsilon$.", "answer": "$$\\boxed{\\sum_{i=k}^{D} \\binom{D}{i} \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right)^{i} \\left(\\frac{1}{2} + \\frac{\\epsilon}{3}\\right)^{D-i}}$$", "id": "5171424"}, {"introduction": "The ultimate goal of many diagnostic applications is to translate a list of variants into a clinically actionable insight. This exercise focuses on computing Tumor Mutational Burden (TMB), a critical biomarker for predicting response to immunotherapy, from processed WES data [@problem_id:4396805]. You will learn the importance of precise definitions in bioinformatics, such as distinguishing nonsynonymous variants and accounting for the 'callable territory,' to ensure that derived biomarkers are accurate and reproducible.", "problem": "A clinical laboratory performs Whole Exome Sequencing (WES) on a solid tumor and its matched normal to estimate the Tumor Mutational Burden (TMB), defined here as the number of nonsynonymous somatic single-nucleotide variants per megabase of callable coding sequence. The following fundamental bases are assumed: the Central Dogma of molecular biology establishes DNA as the heritable substrate from which protein-coding sequences (the exome) are derived; WES targets protein-coding regions (exons); single-nucleotide variants (SNVs) are point changes at a single base; the callable territory is the subset of targeted bases that meet prespecified quality criteria (for example, depth of coverage threshold, mapping quality, and mappability), ensuring that somatic variants can be confidently detected; and TMB, when defined as above, is a density of nonsynonymous somatic SNVs over the callable coding megabases.\n\nFor a single tumor sample, variant calling with a matched normal identifies a total of $N_{\\text{SNV}}^{\\text{total}}=512$ somatic single-nucleotide variants in targeted coding regions. Quality control and functional annotation yield the following partition within the targeted exome:\n- Within the callable coding territory, $N_{\\text{callable}}=438$ somatic SNVs are detected.\n- Of these callable SNVs, $N_{\\text{nonsyn}}=346$ are nonsynonymous and $N_{\\text{syn}}=92$ are synonymous.\n- Outside the callable territory (either low coverage or poor mappability), $N_{\\text{noncallable}}=74$ somatic SNVs are detected; these are excluded from the TMB calculation by definition of callable territory.\n\nThe callable coding territory length, after applying the laboratory’s quality filters, is $L_{\\text{callable}}=28.7$ megabases.\n\nStarting from the above fundamental bases, derive the analytic expression used to compute TMB under this definition and then compute the TMB for this sample using only the appropriate counts and territory length. Express your final answer in mutations per megabase and round your numerical result to four significant figures.", "solution": "The problem requires the derivation of an analytic expression for Tumor Mutational Burden (TMB) based on a specific definition and the subsequent calculation of its value for a given tumor sample. The process begins with a formal statement of the definition.\n\nThe problem defines Tumor Mutational Burden (TMB) as the number of nonsynonymous somatic single-nucleotide variants per megabase of callable coding sequence. Let us formalize this definition into a mathematical expression.\n\nLet $TMB$ represent the Tumor Mutational Burden.\nLet $N_{\\text{nonsyn}}$ be the count of nonsynonymous somatic single-nucleotide variants identified within the callable territory.\nLet $L_{\\text{callable}}$ be the length of the callable coding sequence, expressed in units of megabases (Mb).\n\nBased on the definition \"number... per megabase,\" TMB is a density, calculated as the ratio of the count of relevant variants to the length of the genomic territory over which they were counted. The analytic expression is therefore:\n$$\nTMB = \\frac{N_{\\text{nonsyn}}}{L_{\\text{callable}}}\n$$\nThe units of this quantity will be mutations per megabase (mut/Mb).\n\nThe problem provides the following data derived from the analysis of a tumor sample:\n- Total somatic SNVs in targeted coding regions: $N_{\\text{SNV}}^{\\text{total}} = 512$\n- Somatic SNVs within the callable coding territory: $N_{\\text{callable}} = 438$\n- Nonsynonymous somatic SNVs within the callable territory: $N_{\\text{nonsyn}} = 346$\n- Synonymous somatic SNVs within the callable territory: $N_{\\text{syn}} = 92$\n- Somatic SNVs outside the callable territory: $N_{\\text{noncallable}} = 74$\n- Callable coding territory length: $L_{\\text{callable}} = 28.7$ Mb\n\nTo compute the TMB, we must select the correct values from this list according to the derived formula. The definition explicitly requires the count of *nonsynonymous* SNVs. Therefore, we must use $N_{\\text{nonsyn}} = 346$. The other counts, such as synonymous SNVs ($N_{\\text{syn}}$), non-callable SNVs ($N_{\\text{noncallable}}$), and the total SNVs ($N_{\\text{SNV}}^{\\text{total}}$), are irrelevant to the calculation of TMB as defined in this problem statement. The denominator is explicitly the *callable* coding territory length, which is given as $L_{\\text{callable}} = 28.7$ Mb.\n\nSubstituting the appropriate values into the expression for TMB:\n$$\nTMB = \\frac{346}{28.7}\n$$\n\nNow, we perform the division to obtain a numerical value:\n$$\nTMB \\approx 12.0557491289... \\text{ mut/Mb}\n$$\n\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures of the result are $1$, $2$, $0$, and $5$. The fifth significant figure is $5$, which dictates that we round up the fourth significant figure. Thus, $12.05$ becomes $12.06$.\n\nThe final calculated TMB for this sample is $12.06$ mut/Mb.", "answer": "$$\\boxed{12.06}$$", "id": "4396805"}]}