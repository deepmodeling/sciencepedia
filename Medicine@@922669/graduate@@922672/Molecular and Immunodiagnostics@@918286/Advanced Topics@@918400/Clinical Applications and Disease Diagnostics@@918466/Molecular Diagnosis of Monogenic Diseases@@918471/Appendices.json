{"hands_on_practices": [{"introduction": "The foundation of any accurate molecular diagnosis using Next-Generation Sequencing (NGS) rests upon the quality of the raw sequencing data. This practice delves into the Phred quality score ($Q$), the industry standard for quantifying the probability of a base-calling error. By deriving the relationship between the score and error probability ($p$), you will gain a concrete understanding of what these quality metrics signify and how to translate them into the expected number of errors within a sequencing read [@problem_id:5134593].", "problem": "A clinical laboratory is using Next-Generation Sequencing (NGS) to detect pathogenic variants underlying a suspected monogenic disorder in Deoxyribonucleic Acid (DNA). Each base call in a read is annotated with a Phred quality score, a base-$10$ logarithmic transform of the base-calling error probability. Consider a single read of length $L$ whose base calls have a uniform mean quality score $Q$. Starting from the standard definition of the Phred quality score as a base-$10$ logarithmic transform of the base-calling error probability and using only the axioms of probability and linearity of expectation, perform the following:\n- Derive an explicit expression for the base-calling error probability $p$ as a function of the Phred score $Q$.\n- Model the total number of base-calling errors in the read as the sum of indicator random variables and derive the expected number of base errors in terms of $L$ and $p$.\n- Evaluate this expected number for a read with mean $Q=30$ and express your final result as a closed-form analytic expression in terms of $L$.\n\nNo rounding is required, and no units are needed in the final answer. Express the final result solely in terms of $L$ and universal constants.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- The context is Next-Generation Sequencing (NGS) for molecular diagnosis of monogenic diseases.\n- The Phred quality score, $Q$, is defined as a base-$10$ logarithmic transform of the base-calling error probability, $p$.\n- A single read of length $L$ is considered.\n- The read has a uniform mean quality score $Q$. This is interpreted to mean that each base in the read has a Phred score of $Q$.\n- The task is to derive an expression for $p$ as a function of $Q$.\n- The task is to model the total number of base-calling errors as a sum of indicator random variables and derive the expected number of base errors in terms of $L$ and $p$.\n- The task is to evaluate this expected number for $Q=30$ and express the result as a closed-form analytic expression in terms of $L$.\n- The derivation must use only the axioms of probability and linearity of expectation.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is grounded in the fundamental principles of bioinformatics and probability theory. The definition of the Phred quality score is standard in genomics. The application of indicator variables and linearity of expectation is a canonical method in probabilistic analysis. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. The givens ($L$, $Q$) are sufficient to derive the required expressions and final answer. The term \"uniform mean quality score $Q$\" is interpreted as each base having an identical score $Q$, which is a standard simplification that makes the problem uniquely solvable.\n- **Objective**: The problem is stated using precise, objective scientific language, free of any subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, and objective. A solution will be provided.\n\n### Derivation\n\nThe solution is developed in three parts as requested by the problem statement.\n\nFirst, we derive the expression for the base-calling error probability, $p$, as a function of the Phred quality score, $Q$. The problem states that $Q$ is a base-$10$ logarithmic transform of $p$. By convention in genomics, this relationship is defined as:\n$$\nQ = -10 \\log_{10}(p)\n$$\nThe negative sign ensures that a higher quality score $Q$ corresponds to a lower error probability $p$. To solve for $p$ in terms of $Q$, we rearrange the equation:\n$$\n-\\frac{Q}{10} = \\log_{10}(p)\n$$\nBy the definition of the base-$10$ logarithm, we can exponentiate both sides with base $10$:\n$$\np = 10^{-\\frac{Q}{10}}\n$$\nThis is the explicit expression for the base-calling error probability $p$ as a function of the Phred score $Q$.\n\nSecond, we model the total number of base-calling errors in the read of length $L$ and derive its expectation. Let the sequence of bases in the read be indexed from $i=1$ to $L$. For each base position $i$, we define an indicator random variable $X_i$ such that:\n$$\nX_i = \n\\begin{cases} \n1 & \\text{if the base call at position } i \\text{ is an error} \\\\\n0 & \\text{if the base call at position } i \\text{ is correct}\n\\end{cases}\n$$\nThe total number of errors in the read, denoted by the random variable $N$, is the sum of these indicator variables:\n$$\nN = \\sum_{i=1}^{L} X_i\n$$\nThe problem asks for the expected number of base errors, $E[N]$. By the linearity of expectation, the expectation of a sum of random variables is the sum of their individual expectations:\n$$\nE[N] = E\\left[\\sum_{i=1}^{L} X_i\\right] = \\sum_{i=1}^{L} E[X_i]\n$$\nThe expectation of an indicator random variable is the probability of the event it indicates. In this case, $E[X_i] = P(X_i = 1)$. The problem states that the read has a uniform mean quality score $Q$, which we have interpreted as each base having the same error probability $p$. Therefore, for all $i \\in \\{1, \\dots, L\\}$:\n$$\nE[X_i] = P(X_i = 1) = p\n$$\nSubstituting this into the sum for $E[N]$:\n$$\nE[N] = \\sum_{i=1}^{L} p = L \\cdot p\n$$\nThis is the expected number of base errors in the read in terms of its length $L$ and the per-base error probability $p$.\n\nThird, we evaluate this expected number for a read with a mean quality score of $Q=30$. We first calculate the corresponding error probability $p$ using the expression derived in the first part:\n$$\np = 10^{-\\frac{Q}{10}}\n$$\nSubstituting $Q=30$:\n$$\np = 10^{-\\frac{30}{10}} = 10^{-3}\n$$\nThis means an error probability of $1$ in $1000$. Now, we substitute this value of $p$ into our expression for the expected number of errors, $E[N]$:\n$$\nE[N] = L \\cdot p = L \\cdot 10^{-3}\n$$\nThis is the final closed-form analytic expression for the expected number of base errors in a read of length $L$ with a uniform Phred quality score of $30$.", "answer": "$$\n\\boxed{L \\cdot 10^{-3}}\n$$", "id": "5134593"}, {"introduction": "Beyond the quality of individual bases, the statistical power to detect a variant depends on the sequencing depth, or 'coverage'. This exercise simulates a critical decision in planning a diagnostic test: determining the minimum coverage needed to reliably detect a heterozygous variant. You will apply the binomial sampling model to calculate the required depth to achieve a specified sensitivity, linking fundamental probability theory to practical NGS experimental design [@problem_id:5134524].", "problem": "A targeted Next-Generation Sequencing (NGS) panel is being developed for molecular diagnosis of autosomal monogenic diseases. At a given locus with a true heterozygous single nucleotide variant (SNV), assume unbiased allelic representation, independent sampling of reads from the locus, negligible per-base sequencing error, and no allele-specific amplification. Under these assumptions, the number of reads supporting the alternate allele among the total on-target coverage obeys a binomial sampling model.\n\nVariant calling in the bioinformatic pipeline requires at least $k$ non-reference (alternate) reads to emit a heterozygous SNV call. Sensitivity is defined as the probability the pipeline emits a call when the variant is truly present at the locus. For a heterozygous SNV in a diploid region under unbiased sampling, the alternate allele fraction is $0.5$.\n\nGiven a minimum threshold of $k = 3$ alternate reads, derive from first principles the minimal integer on-target coverage $n$ such that the sensitivity for detecting the heterozygous SNV is at least $0.99$, that is, the probability of observing at least $3$ alternate reads is at least $0.99$ under the binomial sampling model. Express your final answer as an integer number of reads. No rounding is required beyond identifying the minimal integer $n$.", "solution": "The problem requires the determination of the minimal integer on-target coverage, denoted by $n$, to ensure a minimum sensitivity of $0.99$ for detecting a true heterozygous single nucleotide variant (SNV). The detection pipeline requires at least $k=3$ sequencing reads supporting the alternate allele.\n\nThe problem statement provides the following critical information and assumptions:\n1.  The number of reads supporting the alternate allele, let us call this random variable $X$, follows a binomial distribution.\n2.  The sampling of reads is independent.\n3.  For a true heterozygous SNV in a diploid genome with unbiased allelic representation, the probability of sampling a read corresponding to the alternate allele is $p = 0.5$.\n4.  The total number of reads covering the locus is $n$.\n5.  A variant call is made if the number of alternate reads $X$ is at least $k=3$.\n6.  The sensitivity, defined as the probability of making a correct call when the variant is present, must be at least $0.99$.\n\nBased on these points, the random variable $X$ is distributed according to a binomial distribution with parameters $n$ (number of trials) and $p$ (probability of success), which we write as $X \\sim B(n, p)$. The probability of observing exactly $j$ alternate reads in a total of $n$ reads is given by the probability mass function (PMF) of the binomial distribution:\n$$P(X=j) = \\binom{n}{j} p^j (1-p)^{n-j}$$\nIn our case, the probability of success $p$ is the alternate allele fraction, so $p=0.5$.\n\nThe sensitivity is the probability of observing at least $k=3$ alternate reads. Mathematically, this is expressed as $P(X \\ge 3)$. The problem requires this sensitivity to be at least $0.99$. Therefore, we must find the smallest integer $n$ that satisfies the inequality:\n$$P(X \\ge 3) \\ge 0.99$$\nCalculating this cumulative probability from the upper tail directly involves a sum with a variable number of terms dependent on $n$. It is computationally more straightforward to work with the complement event, $P(X < 3)$, which is the probability of observing $0$, $1$, or $2$ alternate reads.\nThe inequality can be rewritten as:\n$$1 - P(X < 3) \\ge 0.99$$\n$$P(X < 3) \\le 1 - 0.99$$\n$$P(X \\le 2) \\le 0.01$$\nThe term $P(X \\le 2)$ is the cumulative distribution function (CDF) evaluated at $X=2$, which is the sum of the probabilities for $X=0$, $X=1$, and $X=2$:\n$$P(X \\le 2) = P(X=0) + P(X=1) + P(X=2)$$\nSubstituting the binomial PMF with $p=0.5$ and $(1-p)=0.5$:\n$$P(X=0) = \\binom{n}{0} (0.5)^0 (0.5)^{n-0} = \\binom{n}{0} (0.5)^n$$\n$$P(X=1) = \\binom{n}{1} (0.5)^1 (0.5)^{n-1} = \\binom{n}{1} (0.5)^n$$\n$$P(X=2) = \\binom{n}{2} (0.5)^2 (0.5)^{n-2} = \\binom{n}{2} (0.5)^n$$\nSumming these probabilities gives:\n$$P(X \\le 2) = \\left[ \\binom{n}{0} + \\binom{n}{1} + \\binom{n}{2} \\right] (0.5)^n$$\nThe binomial coefficients are $\\binom{n}{0} = 1$, $\\binom{n}{1} = n$, and $\\binom{n}{2} = \\frac{n(n-1)}{2}$. Substituting these into the expression:\n$$P(X \\le 2) = \\left[ 1 + n + \\frac{n(n-1)}{2} \\right] (0.5)^n$$\nOur task is to find the minimum integer $n$ for which:\n$$\\left[ 1 + n + \\frac{n(n-1)}{2} \\right] (0.5)^n \\le 0.01$$\nThis inequality does not have a simple analytical solution for $n$. We must find the solution by evaluating the left-hand side for successive integer values of $n$ until the condition is met. Let $f(n) = \\left[ 1 + n + \\frac{n(n-1)}{2} \\right] (0.5)^n$. We seek the smallest integer $n$ such that $f(n) \\le 0.01$. The function $f(n)$ is a monotonically decreasing function for relevant $n$.\n\nLet's test some values of $n$:\nFor $n=10$:\n$f(10) = \\left[ 1 + 10 + \\frac{10(9)}{2} \\right] (0.5)^{10} = (1 + 10 + 45) \\frac{1}{1024} = \\frac{56}{1024} \\approx 0.0547$\nSince $0.0547 > 0.01$, the coverage $n=10$ is insufficient.\n\nLet's try a larger value, $n=13$:\n$f(13) = \\left[ 1 + 13 + \\frac{13(12)}{2} \\right] (0.5)^{13} = (1 + 13 + 78) \\frac{1}{8192} = \\frac{92}{8192} \\approx 0.01123$\nSince $0.01123 > 0.01$, the coverage $n=13$ is still insufficient. This corresponds to a sensitivity of $1 - 0.01123 = 0.98877$, which is just below the required $0.99$.\n\nLet's test the next integer, $n=14$:\n$f(14) = \\left[ 1 + 14 + \\frac{14(13)}{2} \\right] (0.5)^{14} = (1 + 14 + 91) \\frac{1}{16384} = \\frac{106}{16384} \\approx 0.00647$\nSince $0.00647 \\le 0.01$, the coverage $n=14$ meets the condition. This corresponds to a sensitivity of $1 - 0.00647 = 0.99353$, which is greater than or equal to $0.99$.\n\nSince the condition is not met for $n=13$ but is met for $n=14$, the minimal integer on-target coverage required is $14$.", "answer": "$$\\boxed{14}$$", "id": "5134524"}, {"introduction": "Identifying a variant is only the first step; the crucial challenge is interpreting its pathogenicity. This final practice introduces you to the power of Bayesian inference, a formal framework for updating our belief in a hypothesis as new evidence becomes available. You will see how segregation data from a family can be used to mathematically update a prior probability of pathogenicity, providing a quantitative basis for variant classification that mirrors the logic used in professional genetic guidelines [@problem_id:5134637].", "problem": "A clinical genetics laboratory is evaluating a rare missense variant observed in a family with an autosomal dominant monogenic disease. The proband is heterozygous for the variant. Assume the following model: the variant, if truly causal, confers complete penetrance of disease in heterozygous carriers, there are no phenocopies, and the other parent does not carry the variant. The laboratory has prior evidence (from functional assays, population rarity, and computational predictions consistent with disease mechanism in this gene) that sets the prior probability of pathogenicity at $P(\\text{pathogenic}) = 0.05$ before considering segregation data.\n\nSegregation testing was performed in $6$ biological children of the heterozygous transmitting parent. Of these, $3$ are clinically affected and all $3$ are variant carriers; the remaining $3$ are clinically unaffected and all $3$ are non-carriers. Assume independent meioses, and treat the affection statuses as given observations when evaluating genotype segregation consistency.\n\nUsing Bayesian updating from first principles of Mendelian transmission and Bayesâ€™ theorem, compute the posterior probability $P(\\text{pathogenic} \\mid \\text{data})$ that the variant is pathogenic after incorporating this segregation evidence. Express your final answer as a decimal between $0$ and $1$ and round your answer to four significant figures.", "solution": "The problem requires the calculation of the posterior probability that a genetic variant is pathogenic, given segregation data from a family. This will be accomplished using Bayes' theorem to update a prior probability with new evidence.\n\n### Step 1: Problem Validation\n\n**Extracted Givens:**\n- The disease is an autosomal dominant monogenic disease.\n- The transmitting parent (proband) is heterozygous for the variant.\n- The other parent does not carry the variant.\n- If the variant is pathogenic (causal), it is assumed to have:\n    - Complete penetrance in heterozygous carriers.\n    - No phenocopies (unaffected individuals cannot have the disease, which also implies affected individuals must have the causal mutation).\n- The prior probability of pathogenicity is $P(\\text{pathogenic}) = 0.05$.\n- Segregation data from $N=6$ biological children are:\n    - $3$ children are clinically affected and are variant carriers.\n    - $3$ children are clinically unaffected and are non-carriers.\n- Meioses are assumed to be independent.\n- The task is to compute the posterior probability $P(\\text{pathogenic} \\mid \\text{data})$ and round the result to four significant figures.\n\n**Validation Using Extracted Givens:**\n- **Scientific or Factual Unsoundness:** The problem is scientifically sound. It is based on established principles of Mendelian genetics (autosomal dominant inheritance, independent segregation) and probability theory (Bayes' theorem). The scenario represents a standard and realistic application of Bayesian inference in the field of clinical genetics for variant classification.\n- **Well-Posed:** The problem is well-posed. It provides all necessary data and simplifying assumptions (complete penetrance, no phenocopies) to allow for a unique and meaningful solution. The objective is clearly stated.\n- **Objective:** The problem is phrased in precise, objective, and quantitative language, free of any subjective or opinion-based statements.\n- **Incomplete or Contradictory Setup:** The problem is self-contained and free of contradictions. The data provided ($3$ affected carriers, $3$ unaffected non-carriers) are consistent with an autosomal dominant inheritance pattern.\n- **Unrealistic or Infeasible:** The assumptions, while idealizations (e.g., complete penetrance), are standard for creating a tractable model and are commonly used in genetic counseling and variant interpretation frameworks. The provided probabilities and family structure are plausible.\n\n**Verdict:** The problem is valid.\n\n### Step 2: Solution\n\nWe will use Bayes' theorem to update the probability of pathogenicity. Let $H_{path}$ be the hypothesis that the variant is pathogenic, and $H_{benign}$ be the hypothesis that the variant is benign (not pathogenic). Let $D$ represent the observed segregation data.\n\nBayes' theorem states:\n$$ P(H_{path} \\mid D) = \\frac{P(D \\mid H_{path}) P(H_{path})}{P(D)} $$\nThe total probability of the data, $P(D)$, can be expressed using the law of total probability:\n$$ P(D) = P(D \\mid H_{path}) P(H_{path}) + P(D \\mid H_{benign}) P(H_{benign}) $$\nThe prior probabilities are given:\n$P(H_{path}) = 0.05$\nSince these are the only two hypotheses, their probabilities must sum to $1$:\n$P(H_{benign}) = 1 - P(H_{path}) = 1 - 0.05 = 0.95$\n\nThe core of the calculation involves determining the likelihood of the data under each hypothesis, $P(D \\mid H_{path})$ and $P(D \\mid H_{benign})$.\n\n**Likelihood under the pathogenic hypothesis, $P(D \\mid H_{path})$:**\nIf the variant is pathogenic, the model assumptions apply:\n- The mating is between a heterozygous carrier (genotype $V/+$) and a non-carrier (genotype $+/+$).\n- For any child, the probability of inheriting the variant ($V$) is $P(V/+) = 1/2$, and the probability of not inheriting it is $P(+/+) = 1/2$.\n- Complete penetrance implies that if a child inherits the variant, they will be affected: $P(\\text{affected} \\mid V/+) = 1$.\n- No phenocopies implies that if a child does not inherit the variant, they will be unaffected: $P(\\text{unaffected} \\mid +/+) = 1$.\n\nTherefore, for any single child, there are only two possible outcomes:\n1.  Affected and a carrier: The probability is $P(\\text{affected carrier}) = P(V/+) \\times P(\\text{affected} \\mid V/+) = \\frac{1}{2} \\times 1 = \\frac{1}{2}$.\n2.  Unaffected and a non-carrier: The probability is $P(\\text{unaffected non-carrier}) = P(+/+) \\times P(\\text{unaffected} \\mid +/+) = \\frac{1}{2} \\times 1 = \\frac{1}{2}$.\n\nThe data $D$ consist of $3$ children of the first type and $3$ of the second. Since the meioses are independent, the probability of observing this specific combination for $6$ children is the product of their individual probabilities.\n$$ P(D \\mid H_{path}) = \\left(\\frac{1}{2}\\right)^3 \\times \\left(\\frac{1}{2}\\right)^3 = \\left(\\frac{1}{2}\\right)^6 = \\frac{1}{64} $$\nNote: Whether we consider ordered or unordered observations, the combinatorial factor would appear in both likelihood calculations and cancel out. For simplicity, we can analyze the likelihood of a specific sequence of outcomes consistent with the data.\n\n**Likelihood under the benign hypothesis, $P(D \\mid H_{benign})$:**\nIf the variant is benign, its inheritance is independent of the disease status. The disease is still an autosomal dominant trait, so the affected parent must be heterozygous for the true (but unknown) causal mutation.\n- The variant's segregation is independent: $P(V/+) = 1/2$ and $P(+/+) = 1/2$.\n- The disease's segregation is also independent: The affected parent transmits the disease-causing allele with probability $1/2$, so $P(\\text{affected}) = 1/2$ and $P(\\text{unaffected}) = 1/2$.\n\nSince the events are independent, we can find the probability for each of the four possible outcomes for a child:\n- $P(\\text{affected carrier}) = P(\\text{affected}) \\times P(V/+) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n- $P(\\text{unaffected non-carrier}) = P(\\text{unaffected}) \\times P(+/+) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n- $P(\\text{affected non-carrier}) = P(\\text{affected}) \\times P(+/+) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n- $P(\\text{unaffected carrier}) = P(\\text{unaffected}) \\times P(V/+) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n\nThe observed data $D$ consist of $3$ affected carriers and $3$ unaffected non-carriers. The likelihood of this observation is:\n$$ P(D \\mid H_{benign}) = \\left(\\frac{1}{4}\\right)^3 \\times \\left(\\frac{1}{4}\\right)^3 = \\left(\\frac{1}{4}\\right)^6 = \\frac{1}{4096} $$\n\n**Calculating the Posterior Probability:**\nNow we substitute these values into the Bayes' formula:\n$$ P(H_{path} \\mid D) = \\frac{P(D \\mid H_{path}) P(H_{path})}{P(D \\mid H_{path}) P(H_{path}) + P(D \\mid H_{benign}) P(H_{benign})} $$\n$$ P(H_{path} \\mid D) = \\frac{\\left(\\frac{1}{64}\\right) \\cdot (0.05)}{\\left(\\frac{1}{64}\\right) \\cdot (0.05) + \\left(\\frac{1}{4096}\\right) \\cdot (0.95)} $$\nTo simplify the fraction, we can multiply the numerator and denominator by $4096$:\n$$ P(H_{path} \\mid D) = \\frac{\\left(\\frac{4096}{64}\\right) \\cdot (0.05)}{\\left(\\frac{4096}{64}\\right) \\cdot (0.05) + \\left(\\frac{4096}{4096}\\right) \\cdot (0.95)} $$\nSince $\\frac{4096}{64} = 64$, we get:\n$$ P(H_{path} \\mid D) = \\frac{64 \\cdot 0.05}{64 \\cdot 0.05 + 1 \\cdot 0.95} $$\n$$ P(H_{path} \\mid D) = \\frac{3.2}{3.2 + 0.95} = \\frac{3.2}{4.15} $$\nThis fraction can be expressed as $\\frac{320}{415}$, which simplifies to $\\frac{64}{83}$ by dividing the numerator and denominator by $5$.\n$$ P(H_{path} \\mid D) = \\frac{64}{83} $$\nNow, we compute the decimal value and round to four significant figures as requested.\n$$ \\frac{64}{83} \\approx 0.771084337... $$\nRounding to four significant figures gives $0.7711$.\n\n**Alternative method using Bayes Factor:**\nThe Bayes Factor ($BF$) is the ratio of the likelihoods:\n$$ BF = \\frac{P(D \\mid H_{path})}{P(D \\mid H_{benign})} = \\frac{1/64}{1/4096} = \\frac{4096}{64} = 64 $$\nThe prior odds are:\n$$ \\text{Prior Odds} = \\frac{P(H_{path})}{P(H_{benign})} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19} $$\nThe posterior odds are the product of the prior odds and the Bayes Factor:\n$$ \\text{Posterior Odds} = \\text{Prior Odds} \\times BF = \\frac{1}{19} \\times 64 = \\frac{64}{19} $$\nFinally, convert the posterior odds back to a probability:\n$$ P(H_{path} \\mid D) = \\frac{\\text{Posterior Odds}}{1 + \\text{Posterior Odds}} = \\frac{64/19}{1 + 64/19} = \\frac{64/19}{(19+64)/19} = \\frac{64}{83} $$\nThis confirms the previous calculation. The final numerical value is approximately $0.7711$.", "answer": "$$ \\boxed{0.7711} $$", "id": "5134637"}]}