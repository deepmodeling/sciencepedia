{"hands_on_practices": [{"introduction": "A primary goal in molecular epidemiology is to assess how well a typing scheme can differentiate between unrelated isolates. The Hunter-Gaston Discriminatory Index ($D$) provides a robust, quantitative measure for this purpose, defined as the probability that two isolates selected at random will be assigned to different types. This exercise [@problem_id:5136243] provides hands-on practice in calculating this fundamental index from a given set of type frequencies, a critical skill for validating and comparing typing methodologies.", "problem": "In Multilocus Sequence Typing (MLST), isolates are assigned to sequence types based on allelic profiles across multiple housekeeping loci. The Hunter–Gaston discriminatory index (HGI), denoted by $D$, is defined as the probability that two isolates chosen uniformly at random without replacement from the population will be assigned to different sequence types under the typing scheme. Consider an MLST dataset comprising $N=60$ isolates partitioned into $k=10$ sequence types with counts given by $[12, 10, 9, 8, 6, 5, 4, 3, 2, 1]$. Using the definition of $D$ as the complement of the probability that two randomly selected isolates belong to the same sequence type, compute $D$ for this dataset. Express your final answer as an exact fraction.", "solution": "The problem requires the computation of the Hunter–Gaston discriminatory index, denoted by $D$, for a given dataset of isolates. The dataset consists of a total of $N=60$ isolates, which are partitioned into $k=10$ distinct sequence types. The number of isolates in each sequence type, denoted by $n_i$ for $i=1, 2, \\dots, k$, is given by the list $[12, 10, 9, 8, 6, 5, 4, 3, 2, 1]$. We verify that the sum of these counts equals the total number of isolates:\n$$ \\sum_{i=1}^{10} n_i = 12 + 10 + 9 + 8 + 6 + 5 + 4 + 3 + 2 + 1 = 60 = N $$\nThe data is self-consistent and sufficient for the calculation.\n\nThe problem defines the Hunter–Gaston index $D$ as the probability that two isolates chosen uniformly at random without replacement from the population will be assigned to different sequence types. It is further specified that $D$ should be computed as the complement of the probability that two randomly selected isolates belong to the *same* sequence type.\n\nLet $P(\\text{same})$ be the probability that two isolates selected uniformly at random and without replacement belong to the same sequence type. The discriminatory index $D$ is then given by:\n$$ D = 1 - P(\\text{same}) $$\n\nTo calculate $P(\\text{same})$, we first determine the total number of ways to choose two distinct isolates from the population of $N$ isolates. This is a combination problem, and the total number of pairs is given by the binomial coefficient $\\binom{N}{2}$.\nWith $N=60$, the total number of possible pairs is:\n$$ \\binom{N}{2} = \\binom{60}{2} = \\frac{60 \\times (60-1)}{2 \\times 1} = \\frac{60 \\times 59}{2} = 30 \\times 59 = 1770 $$\n\nNext, we determine the number of pairs of isolates that belong to the same sequence type. This is found by summing the number of ways to choose two isolates from within each sequence type. For a sequence type $i$ with $n_i$ isolates, the number of ways to choose two isolates is $\\binom{n_i}{2}$. The total number of same-type pairs is the sum over all $k$ types:\n$$ \\text{Number of same-type pairs} = \\sum_{i=1}^{k} \\binom{n_i}{2} $$\nThe given counts are $n_1=12$, $n_2=10$, $n_3=9$, $n_4=8$, $n_5=6$, $n_6=5$, $n_7=4$, $n_8=3$, $n_9=2$, and $n_{10}=1$. We compute each term $\\binom{n_i}{2} = \\frac{n_i(n_i-1)}{2}$:\n\\begin{itemize}\n    \\item For $n_1=12$: $\\binom{12}{2} = \\frac{12 \\times 11}{2} = 66$\n    \\item For $n_2=10$: $\\binom{10}{2} = \\frac{10 \\times 9}{2} = 45$\n    \\item For $n_3=9$: $\\binom{9}{2} = \\frac{9 \\times 8}{2} = 36$\n    \\item For $n_4=8$: $\\binom{8}{2} = \\frac{8 \\times 7}{2} = 28$\n    \\item For $n_5=6$: $\\binom{6}{2} = \\frac{6 \\times 5}{2} = 15$\n    \\item For $n_6=5$: $\\binom{5}{2} = \\frac{5 \\times 4}{2} = 10$\n    \\item For $n_7=4$: $\\binom{4}{2} = \\frac{4 \\times 3}{2} = 6$\n    \\item For $n_8=3$: $\\binom{3}{2} = \\frac{3 \\times 2}{2} = 3$\n    \\item For $n_9=2$: $\\binom{2}{2} = \\frac{2 \\times 1}{2} = 1$\n    \\item For $n_{10}=1$: $\\binom{1}{2} = \\frac{1 \\times 0}{2} = 0$\n\\end{itemize}\nThe total number of same-type pairs is the sum of these values:\n$$ \\sum_{i=1}^{10} \\binom{n_i}{2} = 66 + 45 + 36 + 28 + 15 + 10 + 6 + 3 + 1 + 0 = 210 $$\n\nThe probability $P(\\text{same})$ is the ratio of the number of same-type pairs to the total number of pairs:\n$$ P(\\text{same}) = \\frac{\\sum_{i=1}^{k} \\binom{n_i}{2}}{\\binom{N}{2}} = \\frac{210}{1770} $$\nThis fraction can be simplified. First, we cancel a factor of $10$:\n$$ P(\\text{same}) = \\frac{21}{177} $$\nTo simplify further, we test for common divisors. The sum of the digits of the numerator is $2+1=3$, and the sum of the digits of the denominator is $1+7+7=15$. Both are divisible by $3$.\n$$ P(\\text{same}) = \\frac{21 \\div 3}{177 \\div 3} = \\frac{7}{59} $$\nThe number $59$ is a prime number, so the fraction is now in its simplest form.\n\nFinally, we compute the Hunter–Gaston discriminatory index $D$:\n$$ D = 1 - P(\\text{same}) = 1 - \\frac{7}{59} = \\frac{59}{59} - \\frac{7}{59} = \\frac{59 - 7}{59} = \\frac{52}{59} $$\nThe value of the discriminatory index is $\\frac{52}{59}$. This is an exact fraction as required.\nThe general formula for the Hunter-Gaston index is often written as:\n$$ D = 1 - \\frac{\\sum_{i=1}^{k} n_i(n_i-1)}{N(N-1)} $$\nOur calculation is equivalent to this, since $\\sum \\binom{n_i}{2} / \\binom{N}{2} = (\\sum n_i(n_i-1)/2) / (N(N-1)/2) = \\sum n_i(n_i-1) / (N(N-1))$.\nUsing the intermediate values, $\\sum n_i(n_i-1) = 2 \\times 210 = 420$ and $N(N-1) = 60 \\times 59 = 3540$.\nThen $D = 1 - \\frac{420}{3540} = 1 - \\frac{42}{354} = 1 - \\frac{21}{177} = 1 - \\frac{7}{59} = \\frac{52}{59}$, which confirms the result.", "answer": "$$\n\\boxed{\\frac{52}{59}}\n$$", "id": "5136243"}, {"introduction": "When multiple typing methods are available, it is essential to understand how their results relate to one another. The Wallace coefficient provides a powerful, directional measure of concordance, answering the question: given that two isolates are clustered by scheme $A$, what is the probability they are also clustered by scheme $B$? This practice [@problem_id:5136193] demonstrates how to compute this coefficient from cross-tabulated data, offering insight into how a typing system's resolution compares to another.", "problem": "A clinical microbiology laboratory applies two molecular typing schemes to a set of $50$ bacterial isolates recovered during a suspected outbreak. Typing scheme $A$ is a core genome Multi-Locus Sequence Typing (cgMLST) clustering, and typing scheme $B$ is a Whole-Genome Single Nucleotide Polymorphism (SNP) distance-based clustering. The Wallace coefficient from $A$ to $B$, denoted $W_{A\\to B}$, is defined as the probability that two isolates that are assigned to the same type under scheme $A$ are also assigned to the same type under scheme $B$. Using the probabilistic definition of $W_{A\\to B}$ and pair-counting logic grounded in basic combinatorics, compute $W_{A\\to B}$ from the following cross-tabulated counts of isolates $n_{ij}$, where $i$ indexes the types in scheme $A$ and $j$ indexes the types in scheme $B$:\n$$\n\\begin{pmatrix}\n20 & 0 & 0 & 0 & 0 \\\\\n0 & 12 & 3 & 0 & 0 \\\\\n0 & 0 & 7 & 3 & 0 \\\\\n0 & 2 & 0 & 0 & 3\n\\end{pmatrix},\n$$\nwith row sums $\\sum_{j} n_{1j} = 20$, $\\sum_{j} n_{2j} = 15$, $\\sum_{j} n_{3j} = 10$, $\\sum_{j} n_{4j} = 5$ and a grand total $\\sum_{i,j} n_{ij} = 50$. Express the final value of $W_{A\\to B}$ as a reduced fraction. Additionally, briefly explain in words (no calculation required) how the directionality in $W_{A\\to B}$ captures concordance from scheme $A$ to scheme $B$ and why $W_{A\\to B}$ need not equal $W_{B\\to A}$.", "solution": "The problem asks for the computation of the Wallace coefficient from typing scheme $A$ to typing scheme $B$, denoted as $W_{A\\to B}$. The probabilistic definition provided is that $W_{A\\to B}$ is the probability that two isolates that are assigned to the same type under scheme $A$ are also assigned to the same type under scheme $B$. This can be formally expressed using combinatorics as the ratio of the number of pairs of isolates that are co-classified in the same type by both schemes to the total number of pairs co-classified by scheme $A$.\n\nLet $N$ be the total number of isolates, which is given as $N=50$. Let $n_{ij}$ be the number of isolates belonging to type $i$ under scheme $A$ and type $j$ under scheme $B$. The given data is a contingency table of these counts:\n$$\n\\mathbf{N} = \\begin{pmatrix}\n20 & 0 & 0 & 0 & 0 \\\\\n0 & 12 & 3 & 0 & 0 \\\\\n0 & 0 & 7 & 3 & 0 \\\\\n0 & 2 & 0 & 0 & 3\n\\end{pmatrix}\n$$\nThe number of ways to choose a pair of isolates from a group of $k$ isolates is given by the binomial coefficient $\\binom{k}{2} = \\frac{k(k-1)}{2}$.\n\nThe numerator of the Wallace coefficient, $W_{A\\to B}$, is the number of pairs of isolates that are concordant in both scheme $A$ and scheme $B$. This corresponds to pairs of isolates that fall within the same cell $(i, j)$ of the contingency table. The total count of such pairs is the sum of pairs from each cell:\n$$\n\\text{Numerator} = \\sum_{i,j} \\binom{n_{ij}}{2}\n$$\nThe denominator is the total number of pairs of isolates that are concordant in scheme $A$. This is found by considering the total number of isolates in each type of scheme $A$, which are given by the row sums $R_i = \\sum_{j} n_{ij}$. The total number of pairs concordant in scheme $A$ is the sum of pairs from each row:\n$$\n\\text{Denominator} = \\sum_{i} \\binom{R_i}{2}\n$$\nTherefore, the formula for the Wallace coefficient is:\n$$\nW_{A\\to B} = \\frac{\\sum_{i,j} \\binom{n_{ij}}{2}}{\\sum_{i} \\binom{R_i}{2}}\n$$\n\nFirst, we compute the numerator. We sum $\\binom{n_{ij}}{2}$ for all non-zero entries in the table. Note that $\\binom{k}{2} = 0$ for $k  2$.\nThe non-zero entries are $n_{11}=20$, $n_{22}=12$, $n_{23}=3$, $n_{33}=7$, $n_{34}=3$, $n_{42}=2$, and $n_{45}=3$.\n$$\n\\sum_{i,j} \\binom{n_{ij}}{2} = \\binom{20}{2} + \\binom{12}{2} + \\binom{3}{2} + \\binom{7}{2} + \\binom{3}{2} + \\binom{2}{2} + \\binom{3}{2}\n$$\nCalculating each term:\n$\\binom{20}{2} = \\frac{20 \\times 19}{2} = 190$\n$\\binom{12}{2} = \\frac{12 \\times 11}{2} = 66$\n$\\binom{3}{2} = \\frac{3 \\times 2}{2} = 3$\n$\\binom{7}{2} = \\frac{7 \\times 6}{2} = 21$\n$\\binom{2}{2} = \\frac{2 \\times 1}{2} = 1$\nThe numerator is the sum:\n$$\n\\text{Numerator} = 190 + 66 + 3 + 21 + 3 + 1 + 3 = 287\n$$\n\nNext, we compute the denominator. The row sums are given as $R_1 = 20$, $R_2 = 15$, $R_3 = 10$, and $R_4 = 5$.\n$$\n\\sum_{i} \\binom{R_i}{2} = \\binom{20}{2} + \\binom{15}{2} + \\binom{10}{2} + \\binom{5}{2}\n$$\nCalculating each term:\n$\\binom{20}{2} = \\frac{20 \\times 19}{2} = 190$\n$\\binom{15}{2} = \\frac{15 \\times 14}{2} = 105$\n$\\binom{10}{2} = \\frac{10 \\times 9}{2} = 45$\n$\\binom{5}{2} = \\frac{5 \\times 4}{2} = 10$\nThe denominator is the sum:\n$$\n\\text{Denominator} = 190 + 105 + 45 + 10 = 350\n$$\n\nFinally, we compute the Wallace coefficient $W_{A\\to B}$ as the ratio of the numerator to the denominator:\n$$\nW_{A\\to B} = \\frac{287}{350}\n$$\nTo express this as a reduced fraction, we find the prime factors of the numerator and denominator.\n$350 = 35 \\times 10 = (5 \\times 7) \\times (2 \\times 5) = 2 \\times 5^2 \\times 7$.\nFor the numerator, we test for divisibility by these primes. $287$ is not divisible by $2$ or $5$. Dividing by $7$: $287 \\div 7 = 41$. Since $41$ is a prime number, the prime factorization of $287$ is $7 \\times 41$.\n$$\nW_{A\\to B} = \\frac{7 \\times 41}{2 \\times 5^2 \\times 7} = \\frac{41}{2 \\times 25} = \\frac{41}{50}\n$$\n\nRegarding the conceptual explanation, the directionality of $W_{A\\to B}$ is crucial. It measures the concordance from a \"base\" partitioning ($A$) to a \"compared\" partitioning ($B$). It answers the question: \"Given that two isolates are considered the same by scheme $A$, what is the probability that they are also considered the same by scheme $B$?\" A high value of $W_{A\\to B}$ (close to $1$) implies that the clusters defined by scheme $A$ are largely preserved (or are subsets of clusters) in scheme $B$. In epidemiological terms, it indicates that scheme $B$ has a discriminatory power that is at least as high as scheme $A$. If scheme $B$ further subdivides the clusters of scheme $A$, $W_{A\\to B}$ will be less than $1$. If scheme $B$ lumps together distinct clusters from scheme $A$, $W_{A\\to B}$ will also be less than $1$.\n\nThe reason $W_{A\\to B}$ need not equal $W_{B\\to A}$ is that the coefficients are directional and their denominators are different. While both coefficients share the same numerator (the number of pairs concordant in both schemes, $\\sum_{i,j} \\binom{n_{ij}}{2}$), their denominators are conditioned on the pairs being concordant in one scheme or the other. Specifically, the denominator of $W_{A\\to B}$ is the number of pairs concordant in scheme $A$ ($\\sum_i \\binom{R_i}{2}$), whereas the denominator of $W_{B\\to A}$ is the number of pairs concordant in scheme $B$ ($\\sum_j \\binom{C_j}{2}$, where $C_j$ are the column sums). Unless the total number of pairs within clusters in scheme $A$ is identical to the total number of pairs within clusters in scheme $B$, the two Wallace coefficients will be different. This asymmetry correctly captures the directional nature of concordance; for instance, a high-resolution typing scheme ($B$) might be perfectly predictive of a low-resolution scheme's ($A$) results (so $W_{B\\to A}=1$, as all isolates in a B-cluster are in the same A-cluster), but the reverse would not be true ($W_{A\\to B}1$, as an A-cluster may be split into multiple B-clusters).", "answer": "$$\n\\boxed{\\frac{41}{50}}\n$$", "id": "5136193"}, {"introduction": "Defining outbreak clusters from genomic data like SNP distances requires an explicit clustering algorithm, and the choice of algorithm can profoundly impact epidemiological conclusions. Single-linkage clustering, which groups isolates based on the shortest path between them, is widely used but susceptible to a \"chaining effect\" where distinct clusters are incorrectly merged by intermediate isolates. This hands-on problem [@problem_id:5136242] uses a defined dataset to illustrate precisely how this effect occurs and why it is crucial for practitioners to understand the mechanics of their chosen clustering method.", "problem": "A hospital performs Whole Genome Sequencing (WGS) of bacterial isolates from two temporally separated suspected outbreaks. The sequencing reads are mapped to a common reference, and a validated variant-calling pipeline produces pairwise core-genome Single Nucleotide Polymorphism (SNP) distances. Let $d(i,j)$ denote the number of core-genome positions at which isolates $i$ and $j$ differ. In single-linkage clustering, isolates are modeled as vertices of a graph $G=(V,E)$, and an undirected edge $(i,j)\\in E$ is drawn if and only if $d(i,j)\\le T$ for a fixed SNP threshold $T$. Clusters are then defined as the connected components of $G$. This definition depends only on the existence of paths of edges constrained by the threshold $T$, not on pairwise constraints between all members of a component.\n\nAssume two outbreaks $A=\\{A_1,A_2,A_3\\}$ and $B=\\{B_1,B_2,B_3\\}$, and a newly sequenced intermediate isolate $X$. The observed core-genome SNP distances are as follows.\n\nWithin outbreak $A$: $d(A_1,A_2)=2$, $d(A_1,A_3)=3$, $d(A_2,A_3)=2$.\n\nWithin outbreak $B$: $d(B_1,B_2)=1$, $d(B_1,B_3)=2$, $d(B_2,B_3)=2$.\n\nBetween $A$ and $B$: $d(A_1,B_1)=9$, $d(A_1,B_2)=8$, $d(A_1,B_3)=9$, $d(A_2,B_1)=8$, $d(A_2,B_2)=7$, $d(A_2,B_3)=8$, $d(A_3,B_1)=9$, $d(A_3,B_2)=8$, $d(A_3,B_3)=9$.\n\nBetween $X$ and $A$: $d(X,A_1)=4$, $d(X,A_2)=3$, $d(X,A_3)=5$.\n\nBetween $X$ and $B$: $d(X,B_1)=4$, $d(X,B_2)=3$, $d(X,B_3)=5$.\n\nLet the single-linkage threshold be $T=3$ SNPs. Starting from the core definition of single-linkage clustering as connectivity in $G$ with edges drawn when $d(i,j)\\le T$, derive whether the addition of the intermediate isolate $X$ produces a chaining effect that merges the two outbreaks into a single cluster. Quantify the outcome by determining both the number of clusters and the largest pairwise SNP distance among isolates that end up in the same single-linkage cluster at $T=3$.\n\nWhich option correctly describes the final clustering under single-linkage at $T=3$ and quantifies the maximum pairwise SNP distance among co-clustered isolates?\n\nA. At $T=3$, single-linkage yields $1$ cluster containing all $7$ isolates, and the maximum pairwise SNP distance among co-clustered isolates is $9$.\n\nB. At $T=3$, single-linkage yields $2$ clusters, $\\{A_1,A_2,A_3\\}$ and $\\{B_1,B_2,B_3,X\\}$, because at least one cross-outbreak pair has $d(i,j)3$; the maximum pairwise SNP distance within any cluster is $3$.\n\nC. At $T=3$, single-linkage yields $1$ cluster containing all $7$ isolates, but the maximum pairwise SNP distance within that cluster is $3$ because single-linkage enforces a pairwise threshold for all co-clustered members.\n\nD. At $T=3$, single-linkage yields $3$ clusters because $d(X,A_1)=4$ and $d(X,B_1)=4$ prevent $X$ from connecting both outbreaks; the maximum pairwise SNP distance within each cluster is $\\le 3$.", "solution": "The core principle of single-linkage clustering is to construct a graph where an edge connects two isolates if their SNP distance is at or below a given threshold. Clusters are then the connected components of this graph. Here, the threshold is $T=3$.\n\nFirst, we identify all pairs of isolates with a distance $d(i,j) \\le 3$, which will form the edges of our graph:\n- **Within outbreak A**: All isolates are connected to each other as their pairwise distances are 2 or 3. This forms a connected component $\\{A_1, A_2, A_3\\}$.\n- **Within outbreak B**: All isolates are connected to each other as their pairwise distances are 1 or 2. This forms another connected component $\\{B_1, B_2, B_3\\}$.\n- **Between A and B**: The minimum distance is $d(A_2, B_2) = 7$, which is greater than $T$. Thus, there are no direct edges connecting outbreak A and outbreak B.\n- **Connections involving isolate X**: \n  - The distance to isolate $A_2$ is $d(X, A_2) = 3$. An edge $(X, A_2)$ exists.\n  - The distance to isolate $B_2$ is $d(X, B_2) = 3$. An edge $(X, B_2)$ exists.\n  - All other distances involving $X$ are greater than 3.\n\nBecause isolate $X$ is connected to both the A-group (via $A_2$) and the B-group (via $B_2$), it acts as a bridge. A path now exists between any isolate in A and any isolate in B, for example: $A_1 \\leftrightarrow A_2 \\leftrightarrow X \\leftrightarrow B_2 \\leftrightarrow B_1$. Consequently, all 7 isolates belong to a single connected component. This demonstrates the \"chaining effect\" of single-linkage clustering, where the intermediate isolate $X$ merges the two otherwise distinct outbreaks into one large cluster. Therefore, single-linkage yields 1 cluster.\n\nNext, we must find the maximum pairwise SNP distance among all co-clustered isolates. Since all 7 isolates are in one cluster, we need to find the maximum distance among all possible pairs. Reviewing the given distances, the largest values are between isolates from group A and group B. For example, $d(A_1, B_1) = 9$. This is the maximum pairwise distance within the merged cluster.\n\nTherefore, at $T=3$, single-linkage yields 1 cluster containing all 7 isolates, and the maximum pairwise SNP distance among these co-clustered isolates is 9. This matches option A.", "answer": "$$\\boxed{A}$$", "id": "5136242"}]}