{"hands_on_practices": [{"introduction": "The foundation of any accurate antibiogram is the careful curation of raw isolate data. To prevent bias from patients with multiple infections, we must include only the first isolate of a given species per patient within a defined period. This practice [@problem_id:4621300] will guide you through implementing this canonical \"first isolate\" rule, a critical skill for ensuring the statistical validity and clinical relevance of your cumulative susceptibility report.", "problem": "You are given patient-level microbiology isolate records with species categories, timestamps, and antimicrobial susceptibility results, and you must implement the canonical \"first isolate\" inclusion logic consistent with Clinical and Laboratory Standards Institute (CLSI) guidance, then compute per-species and per-antibiotic denominators for an aggregated antibiogram. The goal is to include only the earliest isolate per species per patient within each pre-defined analysis period and then count how many included isolates have a valid susceptibility result (interpretable as susceptible, intermediate, or resistant) for each species-antibiotic pair.\n\nFundamental base:\n- The set of isolates is denoted by $\\mathcal{I}$. Each isolate $i \\in \\mathcal{I}$ has fields: a patient identifier $p(i)$, a species identifier $s(i)$, a timestamp $t(i)$ measured in days, and an antimicrobial susceptibility function $r(i,a)$ for antibiotics $a$ in a fixed set $\\mathcal{A}$. The susceptibility function returns values in $\\{S, I, R\\}$ when tested, and returns a special missing value, denoted $\\varnothing$, when not tested or unavailable.\n- The time axis is partitioned into a set of half-open intervals (analysis periods) $\\{[b_k, e_k)\\}_{k=1}^{K}$, where each interval includes its left endpoint and excludes its right endpoint, and for all $k$, $b_k < e_k$, and the intervals are pairwise disjoint and collectively cover the timeline of interest.\n- The \"first isolate\" rule within an analysis period selects, for each triple $(p, s, k)$, the isolate $i \\in \\mathcal{I}$ with minimal $t(i)$ among those with $t(i) \\in [b_k, e_k)$ and $p(i)=p$, $s(i)=s$. If there is a tie in timestamps, the isolate with the minimal input index (stable tie-breaking by original order) is chosen.\n\nYou must compute the final denominator $D_{s,a}$ for each species $s$ and antibiotic $a$: the number of included isolates (after applying the \"first isolate\" rule within each period) that have a valid result $r(i,a) \\in \\{S, I, R\\}$. Missing results $\\varnothing$ and untested cases must not contribute to $D_{s,a}$.\n\nScientific realism requirements:\n- Species represent common clinically relevant bacteria.\n- Antibiotics represent commonly reported agents, with realistic combinations of tested and untested results per organism.\n\nMathematical specification:\n- Let $\\mathcal{P}$ denote the set of patients, $\\mathcal{S}$ denote the set of species, and $\\mathcal{A}$ denote the set of antibiotics. For a fixed ordering of species and antibiotics, define the output vector\n$$\n\\mathbf{D} = \\big[ D_{s_1,a_1}, D_{s_1,a_2}, \\ldots, D_{s_1,a_{|\\mathcal{A}|}}, D_{s_2,a_1}, \\ldots, D_{s_{|\\mathcal{S}|},a_{|\\mathcal{A}|}} \\big],\n$$\nwhere each $D_{s,a}$ is the count of included isolates for species $s$ that have $r(i,a) \\in \\{S,I,R\\}$.\n\nAnalysis periods:\n- Use $K=4$ analysis periods measured in days with boundaries\n$$\n[b_1,e_1) = [0,90), \\quad [b_2,e_2) = [90,180), \\quad [b_3,e_3) = [180,270), \\quad [b_4,e_4) = [270,365).\n$$\nAll timestamps are integer days in the range $[0,364]$.\n\nSpecies and antibiotics:\n- Species set (fixed order): $\\mathcal{S} = [\\text{EC}, \\text{SA}, \\text{PA}]$, representing Escherichia coli (EC), Staphylococcus aureus (SA), and Pseudomonas aeruginosa (PA).\n- Antibiotic set (fixed order): $\\mathcal{A} = [\\text{CIP}, \\text{CRO}, \\text{VAN}, \\text{TZP}]$, representing ciprofloxacin (CIP), ceftriaxone (CRO), vancomycin (VAN), and piperacillin-tazobactam (TZP).\n\nTest suite (each isolate is specified by $(p(i), s(i), t(i), r(i,\\cdot))$; susceptibility results use $\\{S,I,R\\}$ or $\\varnothing$ for not tested):\n- $i=1$: $(\\text{P1}, \\text{EC}, 10, \\{\\text{CIP}:S, \\text{CRO}:R, \\text{TZP}:S, \\text{VAN}:\\varnothing\\})$.\n- $i=2$: $(\\text{P1}, \\text{EC}, 20, \\{\\text{CIP}:R, \\text{CRO}:R, \\text{TZP}:I, \\text{VAN}:\\varnothing\\})$.\n- $i=3$: $(\\text{P1}, \\text{SA}, 85, \\{\\text{VAN}:S, \\text{CIP}:I\\})$.\n- $i=4$: $(\\text{P1}, \\text{SA}, 95, \\{\\text{VAN}:R, \\text{CIP}:S\\})$.\n- $i=5$: $(\\text{P2}, \\text{EC}, 100, \\{\\text{CIP}:S, \\text{CRO}:S\\})$.\n- $i=6$: $(\\text{P2}, \\text{EC}, 150, \\{\\text{CIP}:I, \\text{CRO}:R\\})$.\n- $i=7$: $(\\text{P2}, \\text{PA}, 150, \\{\\text{TZP}:R, \\text{CIP}:R\\})$.\n- $i=8$: $(\\text{P3}, \\text{EC}, 180, \\{\\text{CIP}:\\varnothing, \\text{CRO}:S\\})$.\n- $i=9$: $(\\text{P3}, \\text{EC}, 180, \\{\\text{CIP}:S, \\text{CRO}:I\\})$.\n- $i=10$: $(\\text{P3}, \\text{SA}, 260, \\{\\text{VAN}:R, \\text{CIP}:I\\})$.\n- $i=11$: $(\\text{P1}, \\text{EC}, 300, \\{\\text{CIP}:S, \\text{CRO}:S, \\text{TZP}:I\\})$.\n- $i=12$: $(\\text{P1}, \\text{PA}, 310, \\{\\text{TZP}:S, \\text{CIP}:I\\})$.\n- $i=13$: $(\\text{P2}, \\text{SA}, 50, \\{\\text{VAN}:S, \\text{CIP}:\\varnothing\\})$.\n- $i=14$: $(\\text{P2}, \\text{SA}, 60, \\{\\text{VAN}:R, \\text{CIP}:S\\})$.\n\nBoundary and edge-case coverage in the test suite:\n- Multiple isolates for the same patient-species within a period (e.g., $i=1$ and $i=2$; $i=13$ and $i=14$) to test first-isolate selection.\n- Ties in timestamp within a period (e.g., $i=8$ and $i=9$) to test stable tie-breaking by input order.\n- Species-antibiotic pairs with zero count due to untested pairs (e.g., $\\text{EC}$ with $\\text{VAN}$).\n- Cross-period inclusion of repeat patient-species combinations (e.g., $\\text{P1}$-$\\text{SA}$ in $i=3$ and $i=4$).\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The entries must be ordered first by species in the fixed order $\\mathcal{S} = [\\text{EC}, \\text{SA}, \\text{PA}]$ and, within each species, by antibiotic in the fixed order $\\mathcal{A} = [\\text{CIP}, \\text{CRO}, \\text{VAN}, \\text{TZP}]$. Each entry must be an integer count $D_{s,a}$ as defined above. The output must be exactly one line and contain only this bracketed list, with no additional characters or text.", "solution": "The problem requires the implementation of the \"first isolate\" rule, a standard procedure in clinical microbiology for constructing cumulative antibiograms, as defined by guidelines from organizations such as the Clinical and Laboratory Standards Institute (CLSI). The objective is to compute the denominator $D_{s,a}$ for each species-antibiotic pair, which represents the number of unique patient encounters (as defined by the rule) for which a valid susceptibility test result is available.\n\nThe solution is developed through a systematic, multi-step process:\n$1$. **Data Structuring**: The provided isolate records are formalized into a structured dataset.\n$2$. **Temporal Partitioning**: Isolates are assigned to predefined analysis periods based on their timestamps.\n$3$. **First Isolate Selection**: Within each period, isolates are grouped by patient and species, and a single \"first\" isolate is selected for each group based on a defined chronological rule.\n$4$. **Denominator Aggregation**: The selected isolates are aggregated to compute the final denominator counts $D_{s,a}$.\n\n**1. Data Structuring and Definitions**\nThe input consists of a set of isolates $\\mathcal{I}$. Each isolate $i \\in \\mathcal{I}$ is characterized by a tuple: $(p(i), s(i), t(i), R_i)$, where $p(i)$ is the patient identifier, $s(i)$ is the species identifier, $t(i)$ is the collection timestamp in days, and $R_i$ is a set of susceptibility results. We also associate an original input index with each isolate, starting from $i=1$, for stable tie-breaking. The susceptibility function $r(i,a)$ is defined as the result for antibiotic $a$ from the set $R_i$; if a result for $a$ is not in $R_i$, $r(i,a) = \\varnothing$.\n\nThe fixed sets of species and antibiotics are ordered as specified:\n- Species $\\mathcal{S} = [\\text{EC}, \\text{SA}, \\text{PA}]$\n- Antibiotics $\\mathcal{A} = [\\text{CIP}, \\text{CRO}, \\text{VAN}, \\text{TZP}]$\n\nThe $14$ isolates from the test suite are structured with their original input index $i_0 \\in \\{1, 2, ..., 14\\}$.\n\n**2. Temporal Partitioning**\nThe timeline is divided into $K=4$ disjoint, half-open analysis periods:\n- Period $1$: $[0, 90)$\n- Period $2$: $[90, 180)$\n- Period $3$: $[180, 270)$\n- Period $4$: $[270, 365)$\n\nEach isolate $i$ is assigned to the unique period $k$ for which its timestamp $t(i)$ satisfies $t(i) \\in [b_k, e_k)$. For a timestamp $t$, the period index can be computed as $k = \\min(\\lfloor t/90 \\rfloor, 3)$ for $t \\in [0, 364]$.\n\n**3. First Isolate Selection**\nThe core of the logic is to select only the first isolate for each patient-species combination within each analysis period. For each period $k$, we perform the following:\n- Group all isolates $i$ where $t(i) \\in [b_k, e_k)$ by their $(p(i), s(i))$ pair.\n- For each non-empty group corresponding to a patient-species pair $(p,s)$, select the single isolate $i^*$ that minimizes the timestamp $t(i)$.\n- In case of a tie where multiple isolates share the same minimal timestamp, the tie is broken by selecting the isolate with the minimal original input index $i_0$. This ensures a unique and deterministically chosen isolate.\n\nLet's apply this selection rule to the provided test suite.\n\n**Period 1: $t \\in [0, 90)$**\n- Isolates with timestamps in this range: $i=1, 2, 3, 13, 14$.\n- Group $(\\text{P1}, \\text{EC})$: $\\{i=1 (t=10), i=2 (t=20)\\}$. Minimum time is $t=10$. **Select isolate $1$**.\n- Group $(\\text{P1}, \\text{SA})$: $\\{i=3 (t=85)\\}$. Trivially, **select isolate $3$**.\n- Group $(\\text{P2}, \\text{SA})$: $\\{i=13 (t=50), i=14 (t=60)\\}$. Minimum time is $t=50$. **Select isolate $13$**.\n- Included from Period $1$: $\\{1, 3, 13\\}$.\n\n**Period 2: $t \\in [90, 180)$**\n- Isolates with timestamps in this range: $i=4, 5, 6, 7$.\n- Group $(\\text{P1}, \\text{SA})$: $\\{i=4 (t=95)\\}$. **Select isolate $4$**.\n- Group $(\\text{P2}, \\text{EC})$: $\\{i=5 (t=100), i=6 (t=150)\\}$. Minimum time is $t=100$. **Select isolate $5$**.\n- Group $(\\text{P2}, \\text{PA})$: $\\{i=7 (t=150)\\}$. **Select isolate $7$**.\n- Included from Period $2$: $\\{4, 5, 7\\}$.\n\n**Period 3: $t \\in [180, 270)$**\n- Isolates with timestamps in this range: $i=8, 9, 10$.\n- Group $(\\text{P3}, \\text{EC})$: $\\{i=8 (t=180, i_0=8), i=9 (t=180, i_0=9)\\}$. Tie in time at $t=180$. Break tie with index: $8 < 9$. **Select isolate $8$**.\n- Group $(\\text{P3}, \\text{SA})$: $\\{i=10 (t=260)\\}$. **Select isolate $10$**.\n- Included from Period $3$: $\\{8, 10\\}$.\n\n**Period 4: $t \\in [270, 365)$**\n- Isolates with timestamps in this range: $i=11, 12$.\n- Group $(\\text{P1}, \\text{EC})$: $\\{i=11 (t=300)\\}$. **Select isolate $11$**.\n- Group $(\\text{P1}, \\text{PA})$: $\\{i=12 (t=310)\\}$. **Select isolate $12$**.\n- Included from Period $4$: $\\{11, 12\\}$.\n\nThe complete set of included isolates is $\\{1, 3, 4, 5, 7, 8, 10, 11, 12, 13\\}$. Note that isolate $i=13$ was chronologically before $i=3$ or $i=4$, but belongs to a different patient, so it doesn't affect their selection. The rule is applied independently for each patient.\n\n**4. Denominator Aggregation**\nThe final step is to compute the denominators $D_{s,a}$ by iterating through the set of included isolates. For each included isolate $i$ and each antibiotic $a \\in \\mathcal{A}$, we increment the count $D_{s(i),a}$ if and only if the susceptibility result $r(i,a)$ is valid, i.e., $r(i,a) \\in \\{S, I, R\\}$. A missing result, $r(i,a) = \\varnothing$, does not contribute to the count.\n\nWe initialize a $3 \\times 4$ matrix for the denominators $D_{s,a}$, corresponding to the ordered sets $\\mathcal{S}$ and $\\mathcal{A}$, with all entries as $0$.\n\n- **Isolate 1 (EC)**: adds to $D_{\\text{EC,CIP}}, D_{\\text{EC,CRO}}, D_{\\text{EC,TZP}}$.\n- **Isolate 3 (SA)**: adds to $D_{\\text{SA,CIP}}, D_{\\text{SA,VAN}}$.\n- **Isolate 4 (SA)**: adds to $D_{\\text{SA,CIP}}, D_{\\text{SA,VAN}}$.\n- **Isolate 5 (EC)**: adds to $D_{\\text{EC,CIP}}, D_{\\text{EC,CRO}}$.\n- **Isolate 7 (PA)**: adds to $D_{\\text{PA,CIP}}, D_{\\text{PA,TZP}}$.\n- **Isolate 8 (EC)**: adds to $D_{\\text{EC,CRO}}$.\n- **Isolate 10 (SA)**: adds to $D_{\\text{SA,CIP}}, D_{\\text{SA,VAN}}$.\n- **Isolate 11 (EC)**: adds to $D_{\\text{EC,CIP}}, D_{\\text{EC,CRO}}, D_{\\text{EC,TZP}}$.\n- **Isolate 12 (PA)**: adds to $D_{\\text{PA,CIP}}, D_{\\text{PA,TZP}}$.\n- **Isolate 13 (SA)**: adds to $D_{\\text{SA,VAN}}$.\n\nSumming these contributions gives the final counts:\n\nFor $\\mathcal{S}_1 = \\text{EC}$:\n- $D_{\\text{EC,CIP}} = 1 (\\text{from } i=1) + 1 (\\text{from } i=5) + 1 (\\text{from } i=11) = 3$\n- $D_{\\text{EC,CRO}} = 1 (\\text{from } i=1) + 1 (\\text{from } i=5) + 1 (\\text{from } i=8) + 1 (\\text{from } i=11) = 4$\n- $D_{\\text{EC,VAN}} = 0$ (no included EC isolates were tested for VAN)\n- $D_{\\text{EC,TZP}} = 1 (\\text{from } i=1) + 1 (\\text{from } i=11) = 2$\n\nFor $\\mathcal{S}_2 = \\text{SA}$:\n- $D_{\\text{SA,CIP}} = 1 (\\text{from } i=3) + 1 (\\text{from } i=4) + 1 (\\text{from } i=10) = 3$\n- $D_{\\text{SA,CRO}} = 0$ (no included SA isolates were tested for CRO)\n- $D_{\\text{SA,VAN}} = 1 (\\text{from } i=3) + 1 (\\text{from } i=13) + 1 (\\text{from } i=4) + 1 (\\text{from } i=10) = 4$\n- $D_{\\text{SA,TZP}} = 0$ (no included SA isolates were tested for TZP)\n\nFor $\\mathcal{S}_3 = \\text{PA}$:\n- $D_{\\text{PA,CIP}} = 1 (\\text{from } i=7) + 1 (\\text{from } i=12) = 2$\n- $D_{\\text{PA,CRO}} = 0$ (no included PA isolates were tested for CRO)\n- $D_{\\text{PA,VAN}} = 0$ (no included PA isolates were tested for VAN)\n- $D_{\\text{PA,TZP}} = 1 (\\text{from } i=7) + 1 (\\text{from } i=12) = 2$\n\n**5. Final Output Vector**\nThe computed counts are arranged in a single vector $\\mathbf{D}$, ordered first by species ($\\text{EC}, \\text{SA}, \\text{PA}$) and then by antibiotic ($\\text{CIP}, \\text{CRO}, \\text{VAN}, \\text{TZP}$):\n$$\n\\mathbf{D} = [D_{\\text{EC,CIP}}, D_{\\text{EC,CRO}}, D_{\\text{EC,VAN}}, D_{\\text{EC,TZP}}, D_{\\text{SA,CIP}}, D_{\\text{SA,CRO}}, D_{\\text{SA,VAN}}, D_{\\text{SA,TZP}}, D_{\\text{PA,CIP}}, D_{\\text{PA,CRO}}, D_{\\text{PA,VAN}}, D_{\\text{PA,TZP}}]\n$$\nSubstituting the calculated values, we get:\n$$\n\\mathbf{D} = [3, 4, 0, 2, 3, 0, 4, 0, 2, 0, 0, 2]\n$$\nThis vector represents the final answer.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom collections import defaultdict\n\ndef solve():\n    \"\"\"\n    Implements the CLSI \"first isolate\" rule to compute antibiogram denominators.\n    \"\"\"\n\n    # Define the fixed order for species and antibiotics.\n    species_order = ['EC', 'SA', 'PA']\n    abx_order = ['CIP', 'CRO', 'VAN', 'TZP']\n    \n    # Represent the special 'not tested' value with Python's None.\n    # The susceptibility values S, I, R could be any non-None value.\n    S, I, R = \"S\", \"I\", \"R\"\n    NA = None\n    \n    # Test suite: list of isolates. Each is a dictionary containing its properties.\n    # The original input index is derived from the list position (0-based).\n    isolate_data = [\n        {'pid': 'P1', 'species': 'EC', 'time': 10, 'results': {'CIP': S, 'CRO': R, 'TZP': S, 'VAN': NA}},\n        {'pid': 'P1', 'species': 'EC', 'time': 20, 'results': {'CIP': R, 'CRO': R, 'TZP': I, 'VAN': NA}},\n        {'pid': 'P1', 'species': 'SA', 'time': 85, 'results': {'VAN': S, 'CIP': I}},\n        {'pid': 'P1', 'species': 'SA', 'time': 95, 'results': {'VAN': R, 'CIP': S}},\n        {'pid': 'P2', 'species': 'EC', 'time': 100, 'results': {'CIP': S, 'CRO': S}},\n        {'pid': 'P2', 'species': 'EC', 'time': 150, 'results': {'CIP': I, 'CRO': R}},\n        {'pid': 'P2', 'species': 'PA', 'time': 150, 'results': {'TZP': R, 'CIP': R}},\n        {'pid': 'P3', 'species': 'EC', 'time': 180, 'results': {'CIP': NA, 'CRO': S}},\n        {'pid': 'P3', 'species': 'EC', 'time': 180, 'results': {'CIP': S, 'CRO': I}},\n        {'pid': 'P3', 'species': 'SA', 'time': 260, 'results': {'VAN': R, 'CIP': I}},\n        {'pid': 'P1', 'species': 'EC', 'time': 300, 'results': {'CIP': S, 'CRO': S, 'TZP': I}},\n        {'pid': 'P1', 'species': 'PA', 'time': 310, 'results': {'TZP': S, 'CIP': I}},\n        {'pid': 'P2', 'species': 'SA', 'time': 50, 'results': {'VAN': S, 'CIP': NA}},\n        {'pid': 'P2', 'species': 'SA', 'time': 60, 'results': {'VAN': R, 'CIP': S}},\n    ]\n\n    # Add original input index for stable tie-breaking.\n    for i, isolate in enumerate(isolate_data):\n        isolate['index'] = i\n\n    # Define analysis periods and group isolates by period.\n    periods = {0: [], 1: [], 2: [], 3: []}\n    for isolate in isolate_data:\n        time = isolate['time']\n        if 0 <= time < 90:\n            period_index = 0\n        elif 90 <= time < 180:\n            period_index = 1\n        elif 180 <= time < 270:\n            period_index = 2\n        elif 270 <= time < 365:\n            period_index = 3\n        else:\n            continue  # Isolate is outside the analysis timeline\n        periods[period_index].append(isolate)\n\n    # Apply the \"first isolate\" rule.\n    included_isolates = []\n    for period_index in sorted(periods.keys()):\n        # Group isolates within the period by (patient, species).\n        groups = defaultdict(list)\n        for isolate in periods[period_index]:\n            key = (isolate['pid'], isolate['species'])\n            groups[key].append(isolate)\n        \n        # For each group, find the first isolate.\n        for key, group_isolates in groups.items():\n            # Select by minimum time, then by minimum original index for tie-breaking.\n            first_isolate = min(group_isolates, key=lambda x: (x['time'], x['index']))\n            included_isolates.append(first_isolate)\n\n    # Create mapping from names to indices for easy matrix access.\n    species_map = {name: i for i, name in enumerate(species_order)}\n    abx_map = {name: i for i, name in enumerate(abx_order)}\n\n    # Initialize denominator matrix to zeros.\n    denominators = np.zeros((len(species_order), len(abx_order)), dtype=int)\n    \n    # Calculate denominators from the included isolates.\n    for isolate in included_isolates:\n        s_idx = species_map.get(isolate['species'])\n        if s_idx is None:\n            continue\n            \n        for abx_name, a_idx in abx_map.items():\n            # A result is valid if it's not the 'not tested' value (None).\n            # The problem states valid results are S, I, or R.\n            # Here, any non-None value is considered tested.\n            if isolate['results'].get(abx_name) is not None:\n                denominators[s_idx, a_idx] += 1\n    \n    # Flatten the matrix into the final vector following the specified order.\n    final_vector = denominators.flatten().tolist()\n    \n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, final_vector))}]\")\n\nsolve()\n```", "id": "4621300"}, {"introduction": "Beyond basic data aggregation, a clinically useful antibiogram must incorporate specific expert rules to account for complex resistance mechanisms. One of the most important examples is the detection of inducible clindamycin resistance in *Staphylococcus aureus*, which can lead to treatment failure if not properly reported. This practice [@problem_id:4621315] challenges you to apply the logic for the D-test, a key step in refining susceptibility data to provide actionable clinical guidance.", "problem": "A clinical microbiology laboratory is assembling a cumulative susceptibility report (antibiogram) for Staphylococcus aureus over a defined analysis period. The laboratory follows the Clinical and Laboratory Standards Institute (CLSI) guidance that the disk diffusion D-zone test (D-test) should be performed to detect inducible macrolide-lincosamide-streptogramin B (iMLS\\_B) resistance in Staphylococcus aureus isolates that test resistant to erythromycin and susceptible to clindamycin. For antibiogram aggregation, the lab applies a first-isolate-per-patient rule to avoid duplication bias: only the earliest isolate per patient within the analysis period is included in counts and proportions.\n\nFundamental base:\n- iMLS\\_B resistance can render clindamycin clinically ineffective despite apparent in vitro susceptibility; detection relies on the D-test, which identifies a blunted, “D”-shaped zone around the clindamycin disk adjacent to an erythromycin disk.\n- Under CLSI guidance, the D-test is indicated for Staphylococcus aureus isolates with erythromycin resistant and clindamycin susceptible phenotype, denoted by $E = R$ and $C = S$, respectively.\n- An antibiogram should count only the first isolate per patient in the analysis period for organism-specific metrics.\n\nYou are given the following chronological list of Staphylococcus aureus isolates. For each patient, the first listed isolate is the earliest (subsequent entries for the same patient are later isolates in the period). Each entry states erythromycin ($E$) and clindamycin ($C$) categorical interpretations and, when applicable, the D-test outcome. Use only the earliest isolate per patient in all computations.\n\n- Patient A: earliest isolate: $E = R$, $C = S$; D-test: positive (blunted zone).\n- Patient B: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient B: later isolate: $E = R$, $C = S$; D-test: negative.\n- Patient C: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient D: earliest isolate: $E = R$, $C = R$.\n- Patient E: earliest isolate: $E = S$, $C = S$.\n- Patient F: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient G: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient H: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient I: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient J: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient J: later isolate: $E = R$, $C = S$; D-test: negative.\n- Patient K: earliest isolate: $E = S$, $C = R$.\n- Patient L: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient M: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient M: later isolate: $E = R$, $C = S$; D-test: positive.\n- Patient N: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient O: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient P: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient Q: earliest isolate: $E = R$, $C = R$.\n- Patient R: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient S: earliest isolate: $E = S$, $C = S$.\n- Patient T: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient U: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient V: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient W: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient X: earliest isolate: $E = R$, $C = S$; D-test: positive.\n- Patient X: later isolate: $E = R$, $C = S$; D-test: positive.\n- Patient Y: earliest isolate: $E = R$, $C = S$; D-test: negative.\n- Patient Z: earliest isolate: $E = R$, $C = S$; D-test: positive.\n\nTask:\n- Identify which earliest isolates per patient require D-testing based on the CLSI-indicated phenotype requirement $E = R$ and $C = S$.\n- Among those earliest isolates that require D-testing, compute the proportion (as a dimensionless decimal) that exhibit inducible resistance, defined by a positive D-test.\n\nRound your final proportion to four significant figures and express it as a decimal without a percentage symbol.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- The analysis is on *Staphylococcus aureus* isolates.\n- A cumulative susceptibility report (antibiogram) is being assembled.\n- The rule for duplicate isolates is the \"first-isolate-per-patient\" rule: only the earliest isolate per patient within the analysis period is included.\n- The D-zone test (D-test) is indicated for isolates with the phenotype: erythromycin resistant ($E=R$) and clindamycin susceptible ($C=S$). This is based on Clinical and Laboratory Standards Institute (CLSI) guidance.\n- Inducible macrolide-lincosamide-streptogramin B ($iMLS\\_B$) resistance is defined by a positive D-test result.\n- Data provided is a chronological list of isolates for $26$ patients (Patient A through Z), with susceptibility interpretations and D-test results where applicable. Subsequent isolates for a given patient are explicitly marked as \"later isolate\".\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on standard, authentic procedures in clinical microbiology, specifically the CLSI guidelines for testing inducible clindamycin resistance in *Staphylococcus aureus*. The D-test and the $E=R, C=S$ phenotype are fundamental concepts in this field. The problem is factually and scientifically sound.\n- **Well-Posed:** The problem provides all necessary data and clearly defined rules to arrive at a unique numerical answer. The instructions are unambiguous.\n- **Objective:** The problem statement is presented using precise, objective terminology standard to the field of clinical microbiology.\n- **Completeness and Consistency:** The dataset is complete for the task, and the rules (first-isolate rule, D-test indication) are consistent and can be applied without contradiction. For patients with multiple isolates (B, J, M, X), the data is structured chronologically, allowing for the unambiguous application of the first-isolate rule.\n- **Feasibility:** The scenario is realistic and common in clinical laboratory practice.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be generated.\n\n### Solution Derivation\nThe task requires calculating the proportion of isolates exhibiting inducible resistance among those that require D-testing. This involves a multi-step process: first, identifying the correct cohort of isolates based on the \"first-isolate-per-patient\" rule; second, selecting from this cohort the isolates that meet the criteria for D-testing; and third, calculating the proportion of those isolates that are D-test positive.\n\n1.  **Establish the analysis cohort:** The \"first-isolate-per-patient\" rule dictates that we only consider the earliest isolate for each of the $26$ unique patients (A through Z). The later isolates for Patients B, J, M, and X are excluded from all subsequent counts and calculations. This leaves a total of $N_{total} = 26$ isolates in our analysis set.\n\n2.  **Identify isolates requiring D-testing:** According to CLSI guidelines stated in the problem, a D-test is indicated for *Staphylococcus aureus* isolates that are resistant to erythromycin ($E=R$) and susceptible to clindamycin ($C=S$). We must filter our cohort of $26$ unique isolates to find those matching this specific phenotype.\n    Let's examine the earliest isolate for each patient:\n    - Patient A: $E=R, C=S$ (Requires D-test)\n    - Patient B: $E=R, C=S$ (Requires D-test)\n    - Patient C: $E=R, C=S$ (Requires D-test)\n    - Patient D: $E=R, C=R$ (Does not require D-test)\n    - Patient E: $E=S, C=S$ (Does not require D-test)\n    - Patient F: $E=R, C=S$ (Requires D-test)\n    - Patient G: $E=R, C=S$ (Requires D-test)\n    - Patient H: $E=R, C=S$ (Requires D-test)\n    - Patient I: $E=R, C=S$ (Requires D-test)\n    - Patient J: $E=R, C=S$ (Requires D-test)\n    - Patient K: $E=S, C=R$ (Does not require D-test)\n    - Patient L: $E=R, C=S$ (Requires D-test)\n    - Patient M: $E=R, C=S$ (Requires D-test)\n    - Patient N: $E=R, C=S$ (Requires D-test)\n    - Patient O: $E=R, C=S$ (Requires D-test)\n    - Patient P: $E=R, C=S$ (Requires D-test)\n    - Patient Q: $E=R, C=R$ (Does not require D-test)\n    - Patient R: $E=R, C=S$ (Requires D-test)\n    - Patient S: $E=S, C=S$ (Does not require D-test)\n    - Patient T: $E=R, C=S$ (Requires D-test)\n    - Patient U: $E=R, C=S$ (Requires D-test)\n    - Patient V: $E=R, C=S$ (Requires D-test)\n    - Patient W: $E=R, C=S$ (Requires D-test)\n    - Patient X: $E=R, C=S$ (Requires D-test)\n    - Patient Y: $E=R, C=S$ (Requires D-test)\n    - Patient Z: $E=R, C=S$ (Requires D-test)\n\n    The total number of isolates requiring a D-test, which will form the denominator of our proportion, is the count of isolates with the $E=R, C=S$ phenotype. Counting the list above, we find $N_{req} = 21$.\n\n3.  **Calculate the proportion of D-test positive isolates:** The numerator of our proportion is the number of isolates from the $N_{req}$ group that had a positive D-test result. We will examine the results for these $21$ isolates.\n    - Patient A: D-test positive\n    - Patient B: D-test negative\n    - Patient C: D-test positive\n    - Patient F: D-test positive\n    - Patient G: D-test negative\n    - Patient H: D-test positive\n    - Patient I: D-test positive\n    - Patient J: D-test negative\n    - Patient L: D-test positive\n    - Patient M: D-test negative (The earliest isolate's result is used)\n    - Patient N: D-test positive\n    - Patient O: D-test negative\n    - Patient P: D-test positive\n    - Patient R: D-test positive\n    - Patient T: D-test negative\n    - Patient U: D-test positive\n    - Patient V: D-test negative\n    - Patient W: D-test positive\n    - Patient X: D-test positive\n    - Patient Y: D-test negative\n    - Patient Z: D-test positive\n\n    Counting the number of positive D-tests gives the numerator, $N_{pos}$.\n    $N_{pos} = 13$.\n\n4.  **Compute the final proportion:** The proportion, $P$, of isolates exhibiting inducible resistance is the ratio of D-test positive isolates to the total number of isolates that required testing.\n    $$P = \\frac{N_{pos}}{N_{req}} = \\frac{13}{21}$$\n    To express this as a decimal rounded to four significant figures:\n    $$P \\approx 0.6190476...$$\n    The first four significant figures are $6$, $1$, $9$, and $0$. The fifth digit is $4$, which is less than $5$, so we round down. The trailing zero is significant and must be retained.\n    $$P \\approx 0.6190$$", "answer": "$$\\boxed{0.6190}$$", "id": "4621315"}, {"introduction": "A reported susceptibility percentage is an estimate, and its reliability depends on the number of isolates tested. To properly interpret and communicate this uncertainty, we must apply statistical principles, such as minimum isolate thresholds and confidence intervals. In this exercise [@problem_id:4621385], you will practice applying CLSI guidelines to determine which organisms to report and calculate confidence intervals, a crucial skill for assessing the statistical robustness of an antibiogram.", "problem": "A clinical microbiology laboratory is preparing a one-year cumulative antibiogram for a single adult acute-care hospital following Clinical and Laboratory Standards Institute (CLSI) M39 guidance. The dataset below lists, for a single antimicrobial agent, the number of unique-patient, first isolates per organism and the number of isolates interpreted as susceptible using U.S. Food and Drug Administration (FDA) and CLSI breakpoints. All isolates have been deduplicated as the first isolate per patient per organism across the analysis period, and mixed sources are combined in accordance with CLSI M39. The organisms and counts for levofloxacin are:\n- Escherichia coli: total isolates $n=180$, susceptible $x=126$.\n- Klebsiella pneumoniae: total isolates $n=52$, susceptible $x=39$.\n- Pseudomonas aeruginosa: total isolates $n=28$, susceptible $x=13$.\n- Staphylococcus aureus: total isolates $n=34$, susceptible $x=25$.\n- Proteus mirabilis: total isolates $n=31$, susceptible $x=17$.\n\nUsing the following foundational bases:\n- Binomial sampling for susceptibility calls with true proportion $p$ and observed susceptible count $X \\sim \\mathrm{Binomial}(n,p)$.\n- Score-based confidence interval inversion under the normal approximation for two-sided $95\\%$ confidence (Wilson method), with standard normal quantile $z=\\Phi^{-1}(1-0.05/2)$.\n- Exact Clopper–Pearson method only if $x=0$ or $x=n$.\n\nProceed as follows:\n1. Determine which organisms meet the CLSI M39 minimum isolate threshold for reporting in the cumulative antibiogram, taking the threshold to be $n \\ge 30$.\n2. For each organism that meets the threshold, compute the two-sided Wilson $95\\%$ confidence interval for the proportion susceptible, expressing the interval endpoints as proportions (decimals in $[0,1]$).\n3. Compute the width of each Wilson interval as the difference between its upper and lower endpoints, and then compute the sum of these widths over the organisms that meet the reporting threshold.\n\nReport only the final sum of widths as a pure number (no units). Use $z=1.96$ for the $95\\%$ confidence level. Round your final answer to four significant figures.", "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and complete. All data and conditions necessary for a unique and meaningful solution are provided. The context, involving a cumulative antibiogram analysis according to Clinical and Laboratory Standards Institute (CLSI) M39 guidance, is a standard and realistic application of biostatistics in clinical microbiology. The prescribed statistical methods—the binomial sampling model and the Wilson score confidence interval—are appropriate for this type of data. The problem is therefore valid, and we may proceed with a formal solution.\n\nThe task is to compute the sum of the widths of the $95\\%$ Wilson confidence intervals for the proportion of susceptible isolates for all organisms that meet the CLSI M39 reporting threshold.\n\n**Step 1: Identify Organisms Meeting the Reporting Threshold**\n\nThe problem states that the minimum isolate threshold for reporting is $n \\ge 30$. We examine each organism:\n- *Escherichia coli*: Total isolates $n=180$. Since $180 \\ge 30$, this organism is included.\n- *Klebsiella pneumoniae*: Total isolates $n=52$. Since $52 \\ge 30$, this organism is included.\n- *Pseudomonas aeruginosa*: Total isolates $n=28$. Since $28 < 30$, this organism is excluded.\n- *Staphylococcus aureus*: Total isolates $n=34$. Since $34 \\ge 30$, this organism is included.\n- *Proteus mirabilis*: Total isolates $n=31$. Since $31 \\ge 30$, this organism is included.\n\nThus, calculations will be performed for four organisms: *E. coli*, *K. pneumoniae*, *S. aureus*, and *P. mirabilis*.\n\n**Step 2: The Wilson Score Confidence Interval and its Width**\n\nThe Wilson score confidence interval for a binomial proportion $p$ is derived by inverting the score test. The endpoints of the interval are the values of $p$ that satisfy the equation:\n$$ \\frac{|\\hat{p} - p|}{\\sqrt{\\frac{p(1-p)}{n}}} = z $$\nwhere $n$ is the total number of trials (isolates), $x$ is the number of successes (susceptible isolates), $\\hat{p} = x/n$ is the sample proportion, and $z$ is the standard normal quantile for the desired confidence level. For a two-sided $95\\%$ confidence interval, we use $z = \\Phi^{-1}(1 - 0.05/2) \\approx 1.96$.\n\nSquaring both sides of the equation gives:\n$$ (\\hat{p} - p)^2 = z^2 \\frac{p(1-p)}{n} $$\nThis can be rearranged into a quadratic equation in the variable $p$:\n$$ n(\\hat{p}^2 - 2\\hat{p}p + p^2) = z^2(p - p^2) $$\n$$ (n+z^2)p^2 - (2n\\hat{p} + z^2)p + n\\hat{p}^2 = 0 $$\nThe two solutions for $p$, which are the lower ($p_L$) and upper ($p_U$) bounds of the confidence interval, are given by the quadratic formula:\n$$ p_{L,U} = \\frac{(2n\\hat{p} + z^2) \\mp \\sqrt{(2n\\hat{p} + z^2)^2 - 4(n+z^2)(n\\hat{p}^2)}}{2(n+z^2)} $$\nAfter algebraic simplification of the term under the square root, the endpoints become:\n$$ p_{L,U} = \\frac{n\\hat{p} + \\frac{z^2}{2} \\mp z\\sqrt{n\\hat{p}(1-\\hat{p}) + \\frac{z^2}{4}}}{n+z^2} $$\nSubstituting $\\hat{p} = x/n$, we have:\n$$ p_{L,U} = \\frac{x + \\frac{z^2}{2} \\mp z\\sqrt{\\frac{x(n-x)}{n} + \\frac{z^2}{4}}}{n+z^2} $$\nThe width of the confidence interval, $W$, is the difference between the upper and lower bounds, $W = p_U - p_L$:\n$$ W = p_U - p_L = \\frac{2z\\sqrt{\\frac{x(n-x)}{n} + \\frac{z^2}{4}}}{n+z^2} $$\nWe will use this formula to calculate the width for each qualifying organism, with the given value $z=1.96$. We have $z^2 = 1.96^2 = 3.8416$.\n\n**Step 3: Calculation of Widths for Each Eligible Organism**\n\n1.  **For *Escherichia coli*** ($n=180$, $x=126$):\n    $$ W_{1} = \\frac{2(1.96)\\sqrt{\\frac{126(180-126)}{180} + \\frac{3.8416}{4}}}{180 + 3.8416} = \\frac{3.92\\sqrt{\\frac{126 \\times 54}{180} + 0.9604}}{183.8416} $$\n    $$ W_{1} = \\frac{3.92\\sqrt{37.8 + 0.9604}}{183.8416} = \\frac{3.92\\sqrt{38.7604}}{183.8416} \\approx 0.1328419 $$\n\n2.  **For *Klebsiella pneumoniae*** ($n=52$, $x=39$):\n    $$ W_{2} = \\frac{2(1.96)\\sqrt{\\frac{39(52-39)}{52} + \\frac{3.8416}{4}}}{52 + 3.8416} = \\frac{3.92\\sqrt{\\frac{39 \\times 13}{52} + 0.9604}}{55.8416} $$\n    $$ W_{2} = \\frac{3.92\\sqrt{9.75 + 0.9604}}{55.8416} = \\frac{3.92\\sqrt{10.7104}}{55.8416} \\approx 0.2297255 $$\n\n3.  **For *Staphylococcus aureus*** ($n=34$, $x=25$):\n    $$ W_{3} = \\frac{2(1.96)\\sqrt{\\frac{25(34-25)}{34} + \\frac{3.8416}{4}}}{34 + 3.8416} = \\frac{3.92\\sqrt{\\frac{25 \\times 9}{34} + 0.9604}}{37.8416} $$\n    $$ W_{3} = \\frac{3.92\\sqrt{6.617647... + 0.9604}}{37.8416} = \\frac{3.92\\sqrt{7.578047...}}{37.8416} \\approx 0.2851700 $$\n\n4.  **For *Proteus mirabilis*** ($n=31$, $x=17$):\n    $$ W_{4} = \\frac{2(1.96)\\sqrt{\\frac{17(31-17)}{31} + \\frac{3.8416}{4}}}{31 + 3.8416} = \\frac{3.92\\sqrt{\\frac{17 \\times 14}{31} + 0.9604}}{34.8416} $$\n    $$ W_{4} = \\frac{3.92\\sqrt{7.677419... + 0.9604}}{34.8416} = \\frac{3.92\\sqrt{8.637819...}}{34.8416} \\approx 0.3306634 $$\n\n**Step 4: Summation of Widths**\n\nThe final step is to sum the widths calculated for the four organisms:\n$$ W_{total} = W_1 + W_2 + W_3 + W_4 $$\n$$ W_{total} \\approx 0.1328419 + 0.2297255 + 0.2851700 + 0.3306634 $$\n$$ W_{total} \\approx 0.9784008 $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ W_{total} \\approx 0.9784 $$", "answer": "$$\\boxed{0.9784}$$", "id": "4621385"}]}