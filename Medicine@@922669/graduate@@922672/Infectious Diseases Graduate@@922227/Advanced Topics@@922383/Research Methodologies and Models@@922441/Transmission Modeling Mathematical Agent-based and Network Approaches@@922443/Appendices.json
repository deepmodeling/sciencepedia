{"hands_on_practices": [{"introduction": "The basic reproduction number, $R_0$, is arguably the most important quantity in epidemiology. This exercise challenges you to derive the classic expression for $R_0$ not by rote memorization, but from the fundamental, individual-level stochastic processes that govern transmission and recovery. By explicitly calculating the expected number of secondary infections generated by a typical case, you will gain a deeper appreciation for how microscopic assumptions translate into macroscopic epidemic potential. [@problem_id:4700719]", "problem": "Consider a large, closed, homogeneously mixing population modeled at the individual level by the Susceptible–Infectious–Recovered (SIR) framework. A single infectious individual is introduced at time $t=0$ into an otherwise fully susceptible population of size $N$, so that $S(0)\\approx N$. Assume the following fundamental mechanisms:\n- While infectious, an individual generates potentially infectious contacts that lead to transmission events as a time-homogeneous Poisson process with instantaneous rate $\\lambda(t)=\\beta\\,\\frac{S(t)}{N}$, where $\\beta$ has units $\\mathrm{day}^{-1}$ and $S(t)$ is the number of susceptibles at time $t$.\n- Recovery of an infectious individual occurs as a memoryless event with constant hazard (rate) $\\gamma$ (in $\\mathrm{day}^{-1}$), so that the infectious period $T$ is exponentially distributed with survival function $\\Pr(Tt)=\\exp(-\\gamma t)$.\n\nStarting only from the definition of the basic reproduction number (the expected number of secondary infections generated by a typical infectious individual in an otherwise susceptible population), and the above mechanistic assumptions, derive an expression for the basic reproduction number $R_0$ in terms of $\\beta$ and $\\gamma$ by explicitly computing the expectation of the total number of transmission events produced over the random infectious period. Then, evaluate your expression for $\\beta=0.25$ $\\mathrm{day}^{-1}$ and $\\gamma=0.2$ $\\mathrm{day}^{-1}$. Provide the exact numerical value; do not round.\n\nFinally, based on your derived expression and a linearization argument about the disease-free equilibrium, state whether introduction of a single infectious case leads to invasion (initial growth of infection) and briefly justify the threshold condition in terms of your computed $R_0$. Your final numeric answer should be the computed value of $R_0$ with no units.", "solution": "The problem statement is a valid exercise in mathematical epidemiology. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive the requested quantities and draw the required conclusions.\n\nThe basic reproduction number, $R_0$, is defined as the expected number of secondary infections generated by a typical infectious individual in an otherwise completely susceptible population. We are asked to derive an expression for $R_0$ from this definition and the provided mechanistic assumptions.\n\nLet $K$ be the random variable for the number of secondary infections produced by a single index case. By definition, $R_0 = E[K]$.\n\nThe problem states that transmission events from an infectious individual occur as a time-homogeneous Poisson process. The instantaneous rate of this process is given as $\\lambda(t) = \\beta \\frac{S(t)}{N}$. For the calculation of $R_0$, we consider an individual introduced into a nearly fully susceptible population. Therefore, we can set $S(t) \\approx N$ for the entire duration of this individual's infectious period. This simplifies the rate of transmission to a constant:\n$$ \\lambda = \\beta \\frac{N}{N} = \\beta $$\nThe infectious period, $T$, is a random variable. The problem specifies that it is exponentially distributed with a constant hazard rate $\\gamma$. The probability density function (PDF) of $T$ is $f_T(t) = \\gamma \\exp(-\\gamma t)$ for $t \\ge 0$.\n\nTo find the expected number of secondary infections, $E[K]$, we can use the law of total expectation by conditioning on the duration of the infectious period, $T$.\n$$ R_0 = E[K] = E[E[K|T]] $$\nFor a fixed infectious period of duration $T=t$, the number of secondary infections, $K$, is a random variable from a Poisson process with constant rate $\\beta$ observed over an interval of length $t$. The expected number of events for such a process is the rate multiplied by the duration. Thus, the conditional expectation of $K$ given $T=t$ is:\n$$ E[K | T=t] = \\beta t $$\nThis implies that $E[K|T] = \\beta T$, where $T$ is still a random variable.\n\nNext, we take the expectation of this expression with respect to the distribution of $T$:\n$$ R_0 = E[\\beta T] = \\beta E[T] $$\nThe expected value, $E[T]$, of an exponentially distributed random variable with rate $\\gamma$ is the integral of $t$ times its PDF over its support:\n$$ E[T] = \\int_0^\\infty t f_T(t) dt = \\int_0^\\infty t \\gamma \\exp(-\\gamma t) dt $$\nThis is the definition of the mean of the exponential distribution, which is a standard result:\n$$ E[T] = \\frac{1}{\\gamma} $$\nSubstituting this result into the expression for $R_0$, we obtain the derived expression:\n$$ R_0 = \\beta \\left(\\frac{1}{\\gamma}\\right) = \\frac{\\beta}{\\gamma} $$\nThis expression confirms the classic result that the basic reproduction number is the product of the transmission rate per unit time and the average duration of infectiousness.\n\nNow, we evaluate this expression for the provided parameter values: $\\beta = 0.25 \\ \\mathrm{day}^{-1}$ and $\\gamma = 0.2 \\ \\mathrm{day}^{-1}$.\n$$ R_0 = \\frac{0.25}{0.2} = \\frac{25/100}{2/10} = \\frac{25}{100} \\times \\frac{10}{2} = \\frac{25}{20} = \\frac{5}{4} = 1.25 $$\nThe quantity $R_0$ is dimensionless, as the units of $\\beta$ and $\\gamma$ ($\\mathrm{day}^{-1}$) cancel.\n\nFinally, we assess whether the introduction of a single case leads to invasion. This is determined by analyzing the initial growth of the infected population, $I(t)$, near the disease-free equilibrium (DFE), where $(S, I, R) = (N, 0, 0)$. The differential equation governing the number of infectious individuals in the SIR model is:\n$$ \\frac{dI}{dt} = \\beta \\frac{S(t)I(t)}{N} - \\gamma I(t) = I(t) \\left( \\beta \\frac{S(t)}{N} - \\gamma \\right) $$\nFor the initial phase of an epidemic, we can linearize this equation around the DFE by setting $S(t) \\approx N$. The equation becomes:\n$$ \\frac{dI}{dt} \\approx I(t) \\left( \\beta \\frac{N}{N} - \\gamma \\right) = I(t) (\\beta - \\gamma) $$\nFor the infection to invade the population, the number of infected individuals must initially increase, meaning $\\frac{dI}{dt}  0$. Since $I(t)$ must be positive, this requires:\n$$ \\beta - \\gamma  0 \\implies \\beta  \\gamma \\implies \\frac{\\beta}{\\gamma}  1 $$\nSince we derived $R_0 = \\frac{\\beta}{\\gamma}$, the condition for invasion is precisely $R_0  1$. This is the fundamental threshold condition of epidemiology. If $R_0  1$, each primary infection generates, on average, more than one secondary infection, leading to exponential growth at the start of the outbreak. If $R_0  1$, each infection generates less than one new infection on average, and the outbreak dies out.\nIn this case, our computed value is $R_0 = 1.25$. Since $1.25  1$, the condition for invasion is satisfied. Therefore, the introduction of a single infectious case is expected to lead to an epidemic.", "answer": "$$\\boxed{1.25}$$", "id": "4700719"}, {"introduction": "Real-world pathogens rarely conform to the simplifying assumptions of single-type models, with asymptomatic transmission being a frequent and critical complication. This practice moves beyond homogeneous populations to explore the impact of such \"hidden\" transmission on the basic reproduction number, $R_0$. You will employ the powerful next-generation matrix framework to correctly calculate $R_0$ in a population with both symptomatic and asymptomatic individuals, learning how to quantify and correct for the bias that arises from neglecting population heterogeneity. [@problem_id:4700655]", "problem": "Consider a pathogen spreading in a fully susceptible population where each newly infected individual is either asymptomatic with probability $p_A$ or symptomatic with probability $1 - p_A$. All infected individuals have the same mean infectious period $\\tau$ and share identical contact patterns, but asymptomatic cases have a constant relative infectiousness $\\alpha$ compared to symptomatic cases. Let the per-capita transmission rate of symptomatic cases be $\\beta$, so that a symptomatic case produces on average $\\beta \\tau$ secondary infections if everyone is susceptible. Assume that the type of the secondary infection (asymptomatic or symptomatic) is independent of the type of the infector, with probability $p_A$ that any secondary infection is asymptomatic and $1 - p_A$ that it is symptomatic.\n\nAn investigator analyzes line-list data that only includes symptomatic cases and fits a single-type susceptible-infectious-recovered model ignoring asymptomatic infections entirely, implicitly setting $p_A = 0$. From this fit the investigator obtains the basic reproduction number estimate $R_{\\text{neg}} = \\beta \\tau$ based solely on symptomatic transmission.\n\nStarting from the definition of the basic reproduction number as the spectral radius of the next-generation operator in a multi-type epidemic process, derive the multiplicative bias in the estimated basic reproduction number when asymptomatic infections are neglected, as a function of $p_A$ and $\\alpha$. Then propose a multiplicative correction that maps $R_{\\text{neg}}$ to the true basic reproduction number. Express your final answer as a single closed-form analytic expression for the corrected basic reproduction number in terms of $R_{\\text{neg}}$, $p_A$, and $\\alpha$. Do not round.", "solution": "The problem will first be validated against the specified criteria.\n\n**Step 1: Extract Givens**\n- Pathogen spreads in a fully susceptible population.\n- Each newly infected individual is asymptomatic with probability $p_A$.\n- Each newly infected individual is symptomatic with probability $1 - p_A$.\n- All infected individuals have the same mean infectious period $\\tau$.\n- Asymptomatic cases have a constant relative infectiousness $\\alpha$ compared to symptomatic cases.\n- The per-capita transmission rate of symptomatic cases is $\\beta$.\n- A symptomatic case produces on average $\\beta \\tau$ secondary infections in a fully susceptible population.\n- The type of secondary infection is independent of the infector's type.\n- An investigator fits a model neglecting asymptomatic infections (implicitly setting $p_A=0$).\n- The investigator's estimate of the basic reproduction number is $R_{\\text{neg}} = \\beta \\tau$.\n- The task is to use the next-generation operator method to derive the multiplicative bias and find a correction for $R_{\\text{neg}}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses standard, well-established concepts from mathematical epidemiology, namely the basic reproduction number ($R_0$), multi-type disease models, and the next-generation matrix (NGM) method. These are fundamental tools for analyzing infectious disease transmission.\n- **Well-Posed:** The problem is clearly defined. It provides all necessary parameters ($p_A$, $\\alpha$, $\\beta$, $\\tau$) and asks for a specific derivation leading to a unique analytical expression.\n- **Objective:** The problem is phrased in precise, unbiased mathematical and epidemiological language. It contains no subjective or opinion-based statements.\n- **Completeness and Consistency:** The problem is self-contained. The provided information is sufficient to construct the NGM and derive the true $R_0$. The definition $R_{\\text{neg}} = \\beta \\tau$ is consistent with a single-type model considering only symptomatic individuals. There are no contradictions.\n- **Realism:** The scenario of under-counting or neglecting asymptomatic cases is a common and significant problem in real-world infectious disease surveillance and modeling. The parameters are symbolic and thus do not present physical inconsistencies.\n- **Structure and Triviality:** The problem requires a formal derivation using a standard but non-trivial method (NGM for a $2 \\times 2$ system). It is not a tautology and addresses a core conceptual issue in epidemiology.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, objective, and requires a formal, non-trivial derivation. The solution process will now proceed.\n\n**Solution Derivation**\nThe spread of the pathogen can be modeled as a multi-type branching process where the types of infected individuals are determined by their clinical presentation. Let's define two types of infected individuals:\n- Type 1: Asymptomatic (A)\n- Type 2: Symptomatic (S)\n\nThe basic reproduction number, $R_0$, is the spectral radius of the next-generation matrix, $K$. The element $K_{ij}$ of this matrix represents the expected number of new infections of type $i$ caused by a single infected individual of type $j$ in a completely susceptible population.\n\nLet's calculate the elements of the $2 \\times 2$ matrix $K$.\n\n**Infections caused by a Type 1 (Asymptomatic) individual:**\n- The per-capita transmission rate of a symptomatic case is $\\beta$.\n- The relative infectiousness of an asymptomatic case is $\\alpha$. Thus, its per-capita transmission rate is $\\alpha \\beta$.\n- The mean infectious period is $\\tau$.\n- The total average number of secondary infections produced by a single asymptomatic individual is $(\\alpha \\beta) \\tau$.\n- A fraction $p_A$ of these new infections will be asymptomatic (Type 1), and a fraction $1 - p_A$ will be symptomatic (Type 2).\n- Therefore:\n  - $K_{11}$ (Asymptomatic from Asymptomatic) = $p_A (\\alpha \\beta \\tau)$\n  - $K_{21}$ (Symptomatic from Asymptomatic) = $(1 - p_A) (\\alpha \\beta \\tau)$\n\n**Infections caused by a Type 2 (Symptomatic) individual:**\n- The per-capita transmission rate is $\\beta$.\n- The mean infectious period is $\\tau$.\n- The total average number of secondary infections produced by a single symptomatic individual is $\\beta \\tau$.\n- A fraction $p_A$ of these new infections will be asymptomatic (Type 1), and a fraction $1 - p_A$ will be symptomatic (Type 2).\n- Therefore:\n  - $K_{12}$ (Asymptomatic from Symptomatic) = $p_A (\\beta \\tau)$\n  - $K_{22}$ (Symptomatic from Symptomatic) = $(1 - p_A) (\\beta \\tau)$\n\nThe next-generation matrix $K$ is:\n$$\nK = \\begin{pmatrix} p_A \\alpha \\beta \\tau  p_A \\beta \\tau \\\\ (1 - p_A) \\alpha \\beta \\tau  (1 - p_A) \\beta \\tau \\end{pmatrix}\n$$\nThe problem provides the investigator's estimate $R_{\\text{neg}} = \\beta \\tau$. We can substitute this into the matrix:\n$$\nK = \\begin{pmatrix} p_A \\alpha R_{\\text{neg}}  p_A R_{\\text{neg}} \\\\ (1 - p_A) \\alpha R_{\\text{neg}}  (1 - p_A) R_{\\text{neg}} \\end{pmatrix}\n$$\nThis matrix can be expressed as the outer product of two vectors:\n$$\nK = R_{\\text{neg}} \\begin{pmatrix} p_A \\alpha  p_A \\\\ (1 - p_A) \\alpha  1 - p_A \\end{pmatrix} = \\begin{pmatrix} p_A \\\\ 1 - p_A \\end{pmatrix} \\begin{pmatrix} \\alpha R_{\\text{neg}}  R_{\\text{neg}} \\end{pmatrix}\n$$\nThis is a rank-$1$ matrix of the form $u v^T$, where $u = \\begin{pmatrix} p_A \\\\ 1 - p_A \\end{pmatrix}$ and $v^T = \\begin{pmatrix} \\alpha R_{\\text{neg}}  R_{\\text{neg}} \\end{pmatrix}$. A rank-$1$ matrix has only one non-zero eigenvalue, which is given by the trace of the matrix, or more generally by the scalar product $v^T u$.\n\nThe true basic reproduction number, $R_{0, \\text{true}}$, is the spectral radius $\\rho(K)$, which is the dominant eigenvalue of $K$.\n$$\nR_{0, \\text{true}} = v^T u = \\begin{pmatrix} \\alpha R_{\\text{neg}}  R_{\\text{neg}} \\end{pmatrix} \\begin{pmatrix} p_A \\\\ 1 - p_A \\end{pmatrix}\n$$\n$$\nR_{0, \\text{true}} = (\\alpha R_{\\text{neg}}) p_A + R_{\\text{neg}} (1 - p_A)\n$$\nFactoring out $R_{\\text{neg}}$:\n$$\nR_{0, \\text{true}} = R_{\\text{neg}} (\\alpha p_A + 1 - p_A) = R_{\\text{neg}} (1-p_A + p_A \\alpha)\n$$\nThis expression gives the true basic reproduction number, $R_{0, \\text{true}}$.\n\nThe multiplicative bias in the estimate $R_{\\text{neg}}$ arises from neglecting the contribution of asymptomatic cases. The ratio of the true value to the estimated value is:\n$$\n\\frac{R_{0, \\text{true}}}{R_{\\text{neg}}} = 1 - p_A + p_A \\alpha\n$$\nThis term represents the factor by which the naive estimate $R_{\\text{neg}}$ under- or overestimates the true value. If $\\alpha  1$, neglecting asymptomatic cases leads to an underestimation. If $\\alpha  1$, it leads to an overestimation. If $\\alpha=1$, there is no bias as all cases are equally infectious.\n\nThe problem asks for a multiplicative correction that maps $R_{\\text{neg}}$ to the true basic reproduction number. This is precisely the factor derived above. The corrected basic reproduction number is $R_{0, \\text{true}}$. The final analytical expression for the corrected number is therefore:\nCorrected $R_0 = R_{\\text{neg}} (1 - p_A + p_A \\alpha)$", "answer": "$$\n\\boxed{R_{\\text{neg}}(1 - p_A + p_A\\alpha)}\n$$", "id": "4700655"}, {"introduction": "While analytical models provide deep theoretical insights, agent-based models (ABMs) offer unparalleled flexibility to explore complex scenarios. However, this flexibility comes with the critical responsibility of verification: ensuring your code behaves as intended. This hands-on coding challenge tasks you with building and testing a simple ABM against known analytical benchmarks, a fundamental practice in computational modeling. By comparing simulation outputs to theoretical expectations, you will develop the essential skill of building confidence in the correctness of your simulation code. [@problem_id:4700645]", "problem": "You are tasked with designing verification tests for an Agent-Based Model (ABM) of infectious disease transmission by comparing event counts and state occupancy under controlled random seeds to analytically tractable benchmarks. The models must be constructed from first principles of continuous-time stochastic processes and network transmission, and results must be expressed in purely mathematical terms without invoking domain-specific shortcuts. Your program must be a complete, runnable implementation that executes simulations and computes quantitative discrepancies for a fixed test suite. The output must be a single line containing a list of floats (rounded to six decimal places) that represent the maximum absolute relative error across specified metrics for each test case.\n\nFundamental base:\n- A continuous-time Markov chain with state representing the count of infectious individuals, derived from independent exponential waiting times for events and the memoryless property of exponential distributions.\n- A Poisson process with rate equal to the sum of independent per-capita hazards, and the equivalence between exponential inter-event times and Poisson counting processes.\n- A star-graph network transmission process in which edges transmit infection with independent exponential times.\n\nModel classes:\n1. Well-mixed linear birth-death (branching) infection process with infinite susceptible pool. The infectious population $I(t)$ evolves as a continuous-time Markov chain with per-capita infection (birth) rate $b$ and per-capita recovery (death) rate $d$. The total infection event rate at time $t$ is $b \\, I(t)$ and the total recovery event rate is $d \\, I(t)$. The ABM must simulate events using exponentially distributed inter-event times with rate $(b+d)I(t)$ and event type selected with probability $b/(b+d)$ for infection and $d/(b+d)$ for recovery. The initial infectious count is $I(0)=I_0$. The process runs until time $T$ or extinction $I(t)=0$.\n\nAnalytic benchmarks for branching:\n- Expected occupancy at time $T$: $$\\mathbb{E}[I(T)] = I_0 \\, e^{(b-d)T}.$$\n- Expected number of infection events in $[0,T]$: $$\\mathbb{E}[N_{\\text{inf}}(0,T)] = \\int_0^T b \\, \\mathbb{E}[I(t)] \\, dt = \\begin{cases} b I_0 \\dfrac{e^{(b-d)T}-1}{b-d},  b \\neq d, \\\\ b I_0 T,  b=d, \\end{cases}$$\n- Expected number of recovery events in $[0,T]$: $$\\mathbb{E}[N_{\\text{rec}}(0,T)] = \\int_0^T d \\, \\mathbb{E}[I(t)] \\, dt = \\begin{cases} d I_0 \\dfrac{e^{(b-d)T}-1}{b-d},  b \\neq d, \\\\ d I_0 T,  b=d. \\end{cases}$$\n\n2. Star-network transmission with independent exponential edge hazards and no recovery. Consider a star graph with $M$ leaf nodes and one central node initially infectious. For each leaf, infection occurs independently with rate $\\beta$ along its edge to the center. If the center remains infectious and recovery is absent, the infection time on each edge is exponential with parameter $\\beta$, independent across leaves. The ABM must simulate leaf infection times and count leaves infected by time $T$. The occupancy at time $T$ is $I(T)=1 + N_{\\text{inf}}(0,T)$, where the central node remains infectious.\n\nAnalytic benchmarks for star network:\n- The probability that a given leaf is infected by time $T$ is $$p(T) = 1 - e^{-\\beta T}.$$\n- The expected number of infection events by time $T$ is $$\\mathbb{E}[N_{\\text{inf}}(0,T)] = M \\, p(T).$$\n- The expected occupancy at time $T$ is $$\\mathbb{E}[I(T)] = 1 + M \\, p(T).$$\n\nMetrics for verification:\n- For each test case, compute the maximum absolute relative error across the available analytic metrics. For branching cases, compute\n$$\\delta_I = \\frac{\\left| I(T) - \\mathbb{E}[I(T)] \\right|}{\\max(1, \\mathbb{E}[I(T)])}, \\quad \\delta_{\\text{inf}} = \\frac{\\left| N_{\\text{inf}}(0,T) - \\mathbb{E}[N_{\\text{inf}}(0,T)] \\right|}{\\max(1, \\mathbb{E}[N_{\\text{inf}}(0,T)])}, \\quad \\delta_{\\text{rec}} = \\frac{\\left| N_{\\text{rec}}(0,T) - \\mathbb{E}[N_{\\text{rec}}(0,T)] \\right|}{\\max(1, \\mathbb{E}[N_{\\text{rec}}(0,T)])},$$\nand report the single-case score as $$\\Delta = \\max\\{\\delta_I, \\delta_{\\text{inf}}, \\delta_{\\text{rec}}\\}.$$\n- For star-network cases, compute\n$$\\delta_I = \\frac{\\left| I(T) - \\mathbb{E}[I(T)] \\right|}{\\max(1, \\mathbb{E}[I(T)])}, \\quad \\delta_{\\text{inf}} = \\frac{\\left| N_{\\text{inf}}(0,T) - \\mathbb{E}[N_{\\text{inf}}(0,T)] \\right|}{\\max(1, \\mathbb{E}[N_{\\text{inf}}(0,T)])},$$\nand report $$\\Delta = \\max\\{\\delta_I, \\delta_{\\text{inf}}\\}.$$\n\nControlled random seeds:\n- All simulations must use fixed seeds for the Pseudo-Random Number Generator to ensure reproducibility.\n\nTest suite:\n- Case $1$ (branching, happy path): $(b, d, I_0, T, \\text{seed}) = (0.6, 0.2, 10, 5.0, 42)$.\n- Case $2$ (branching, boundary $b=d$): $(b, d, I_0, T, \\text{seed}) = (0.5, 0.5, 20, 4.0, 123)$.\n- Case $3$ (star network, independent edges): $(M, \\beta, T, \\text{seed}) = (100, 0.05, 10.0, 2021)$.\n- Case $4$ (star network, edge case $T=0$): $(M, \\beta, T, \\text{seed}) = (50, 1.0, 0.0, 7)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places, in the order of the test cases above (for example, $[x_1,x_2,x_3,x_4]$ where each $x_i$ is the $\\Delta$ for case $i$).\n\nNo physical units are involved. Angles are not used. Express all quantities as decimals or fractions as appropriate, without percentage signs.", "solution": "The problem requires the design and implementation of verification tests for two classes of Agent-Based Models (ABMs) for infectious disease transmission. The verification is performed by comparing the output of stochastic simulations, run with fixed random seeds for reproducibility, against known analytical benchmarks. The discrepancy is quantified using a specified relative error metric. The two models are a well-mixed linear birth-death process and a star-graph network transmission process.\n\nThe fundamental principle underlying these models is that of continuous-time stochastic processes. Events, such as infection or recovery, occur at random times. For a memoryless process, the waiting time until the next event follows an exponential distribution. If multiple independent events can occur, the time to the *next* event (of any-type) is exponentially distributed with a rate equal to the sum of the individual event rates. This is a cornerstone of the Gillespie Algorithm, which is the standard method for simulating such continuous-time Markov chains (CTMCs).\n\n**Model 1: Well-Mixed Linear Birth-Death Process**\n\nThis model describes the number of infectious individuals, $I(t)$, in a population where the supply of susceptibles is considered infinite. The process is a CTMC on the non-negative integers.\n- An **infection** (birth) event increases the count by $1$: $I \\to I+1$. With a per-capita rate of $b$, the total rate of infection events is $b I(t)$.\n- A **recovery** (death) event decreases the count by $1$: $I \\to I-1$. With a per-capita rate of $d$, the total rate of recovery events is $d I(t)$.\n\nThe total rate of any event occurring at time $t$ is the sum of the individual rates: $$\\lambda(t) = b I(t) + d I(t) = (b+d)I(t).$$\nThe time until the next event, $\\Delta t$, is an exponential random variable with rate $\\lambda(t)$, i.e., $\\Delta t \\sim \\text{Exponential}((b+d)I(t))$. Its probability density function is $f(\\tau) = \\lambda e^{-\\lambda \\tau}$.\n\nGiven that an event has occurred, the probability that it is an infection is the ratio of the infection rate to the total rate: $$P(\\text{infection} | \\text{event}) = \\frac{b I(t)}{(b+d)I(t)} = \\frac{b}{b+d}.$$\nSimilarly, the probability of a recovery is $P(\\text{recovery} | \\text{event}) = \\frac{d}{b+d}$.\n\nThe simulation algorithm proceeds as follows:\n$1$. Initialize time $t=0$, infectious count $I=I_0$, infection event count $N_{\\text{inf}}=0$, and recovery event count $N_{\\text{rec}}=0$.\n$2$. While the current time $t$ is less than the final time $T$ and the population is not extinct ($I0$):\n    a. Calculate the total event rate $\\lambda = (b+d)I$.\n    b. Generate a time step $\\Delta t$ by drawing from an exponential distribution with rate $\\lambda$. This can be computed as $\\Delta t = -(\\ln u_1) / \\lambda$, where $u_1 \\sim U(0,1)$ is a uniform random variate.\n    c. If $t + \\Delta t  T$, no further events occur within the simulation window. The loop terminates, and the final state is the current state $I$.\n    d. Otherwise, advance the simulation time: $t \\leftarrow t + \\Delta t$.\n    e. Determine the event type. Generate a second uniform random variate $u_2 \\sim U(0,1)$. If $u_2  b/(b+d)$, the event is an infection: $I \\leftarrow I+1$ and $N_{\\text{inf}} \\leftarrow N_{\\text{inf}}+1$. Otherwise, it is a recovery: $I \\leftarrow I-1$ and $N_{\\text{rec}} \\leftarrow N_{\\text{rec}}+1$.\n$3$. The simulation outputs are the final count $I(T)$ (which is the value of $I$ when the loop terminates), and the total event counts $N_{\\text{inf}}(0,T)$ and $N_{\\text{rec}}(0,T)$.\n\nThe analytical benchmarks provided are the solutions to the master equations for the expected values of the process. The expected number of infectious individuals, $\\mathbb{E}[I(t)]$, evolves according to the differential equation $\\frac{d}{dt}\\mathbb{E}[I(t)] = (b-d)\\mathbb{E}[I(t)]$. With the initial condition $\\mathbb{E}[I(0)] = I_0$, the solution is $\\mathbb{E}[I(T)] = I_0 e^{(b-d)T}$. The expected numbers of events are found by integrating the expected rates over time: $\\mathbb{E}[N_{\\text{event}}(0,T)] = \\int_0^T \\text{rate}_{\\text{event}}(t) dt = \\int_0^T k \\mathbb{E}[I(t)] dt$, where $k$ is the per-capita event rate ($b$ or $d$). This integration yields the formulas provided in the problem statement.\n\n**Model 2: Star-Network Transmission**\n\nThis model simplifies to a set of $M$ independent Bernoulli trials. A central node is infectious and never recovers. It is connected to $M$ susceptible leaf nodes. Infection spreads along each edge independently with a constant hazard rate $\\beta$.\nThe time to infection for any single leaf, $T_{\\text{inf}}$, is an exponential random variable with rate $\\beta$: $T_{\\text{inf}} \\sim \\text{Exponential}(\\beta)$.\nA leaf becomes infected by time $T$ if and only if its infection event occurs before or at time $T$, i.e., $T_{\\text{inf}} \\leq T$. The probability of this event is given by the cumulative distribution function (CDF) of the exponential distribution: $$p(T) = P(T_{\\textinf} \\leq T) = \\int_0^T \\beta e^{-\\beta \\tau} d\\tau = 1 - e^{-\\beta T}.$$\nSince all $M$ infection processes are independent, the total number of infected leaves by time $T$, denoted $N_{\\text{inf}}(0,T)$, follows a binomial distribution: $N_{\\text{inf}}(0,T) \\sim \\text{Binomial}(M, p(T))$.\n\nThe simulation algorithm is a direct implementation of this process:\n$1$. For each of the $M$ leaves, generate an independent infection time $T_i \\sim \\text{Exponential}(\\beta)$.\n$2$. Count the number of leaves for which $T_i \\leq T$. This count is the realization of $N_{\\text{inf}}(0,T)$ from the simulation.\n$3$. The final infectious population is $I(T) = 1 + N_{\\text{inf}}(0,T)$, since the central node remains infectious.\n\nThe analytical benchmarks are based on the expectation of the binomial distribution. The expected number of infections is $\\mathbb{E}[N_{\\text{inf}}(0,T)] = M \\times p(T)$. The expected total infectious population is $\\mathbb{E}[I(T)] = 1 + \\mathbb{E}[N_{\\text{inf}}(0,T)]$.\n\n**Verification Metrics and Implementation**\n\nFor each specified test case, the program will execute the corresponding simulation with the given parameters and random seed. It will then compute the analytical benchmarks using the provided formulas. The simulation outputs (e.g., $I(T)$, $N_{\\text{inf}}$) are compared to their expected values (e.g., $\\mathbb{E}[I(T)]$, $\\mathbb{E}[N_{\\text{inf}}]$) using the absolute relative error. The denominator, $\\max(1, \\mathbb{E}[\\cdot])$, is used to prevent division by zero or inflation of error when the expected value is small. The final score for each test case, $\\Delta$, is the maximum of these individual relative errors.\n\nThe implementation will consist of separate functions for each simulation model and benchmark calculation to maintain a clear and logical structure. A main `solve` function will iterate through the test suite, dispatching to the appropriate functions, calculating $\\Delta$ for each case, and formatting the collective results into the required output string. The use of `numpy` is essential for numerical calculations and for its pseudo-random number generator, which must be seeded for reproducibility.\n\nThe test cases are:\n- Case $1$ (branching): $(b, d, I_0, T, \\text{seed}) = (0.6, 0.2, 10, 5.0, 42)$.\n- Case $2$ (branching): $(b, d, I_0, T, \\text{seed}) = (0.5, 0.5, 20, 4.0, 123)$.\n- Case $3$ (star network): $(M, \\beta, T, \\text{seed}) = (100, 0.05, 10.0, 2021)$.\n- Case $4$ (star network): $(M, \\beta, T, \\text{seed}) = (50, 1.0, 0.0, 7)$.\n\nThe final code will systematically process these cases and produce a single line of output with the computed $\\Delta$ values.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n\n    def simulate_branching(b, d, I0, T, seed):\n        \"\"\"\n        Simulates the linear birth-death (branching) process.\n        This is an implementation of the Gillespie algorithm.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        t = 0.0\n        I = I0\n        n_inf = 0\n        n_rec = 0\n\n        while t  T and I > 0:\n            total_rate = (b + d) * I\n            if total_rate = 0:\n                break\n            \n            # Time to next event\n            dt = rng.exponential(1.0 / total_rate)\n\n            if t + dt > T:\n                # No more events occur before T\n                break\n            \n            t += dt\n            \n            # Determine event type\n            prob_inf = b / (b + d)\n            if rng.random()  prob_inf:\n                # Infection event (birth)\n                I += 1\n                n_inf += 1\n            else:\n                # Recovery event (death)\n                I -= 1\n                n_rec += 1\n        \n        # The state I at the end of the loop is the state at time T\n        return I, n_inf, n_rec\n\n    def benchmark_branching(b, d, I0, T):\n        \"\"\"\n        Calculates the analytical benchmarks for the branching process.\n        \"\"\"\n        exp_I_T = I0 * np.exp((b - d) * T)\n        \n        if b == d:\n            exp_n_inf = b * I0 * T\n            exp_n_rec = d * I0 * T\n        else:\n            common_factor = I0 * (np.exp((b - d) * T) - 1.0) / (b - d)\n            exp_n_inf = b * common_factor\n            exp_n_rec = d * common_factor\n            \n        return exp_I_T, exp_n_inf, exp_n_rec\n\n    def simulate_star(M, beta, T, seed):\n        \"\"\"\n        Simulates the star-network transmission process.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        \n        # For each of M leaves, draw an infection time from Exp(beta)\n        infection_times = rng.exponential(1.0 / beta, size=M)\n        \n        # Count how many get infected by time T\n        n_inf = np.sum(infection_times = T)\n        \n        # Total infectious population at T is 1 (center) + infected leaves\n        I_T = 1 + n_inf\n        \n        return I_T, n_inf\n\n    def benchmark_star(M, beta, T):\n        \"\"\"\n        Calculates the analytical benchmarks for the star-network process.\n        \"\"\"\n        p_T = 1.0 - np.exp(-beta * T)\n        exp_n_inf = M * p_T\n        exp_I_T = 1.0 + exp_n_inf\n        \n        return exp_I_T, exp_n_inf\n\n    def calculate_relative_error(sim_val, exp_val):\n        \"\"\"\n        Calculates the absolute relative error with a floor of 1 for the denominator.\n        \"\"\"\n        return np.abs(sim_val - exp_val) / np.max([1.0, exp_val])\n\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'branching', 'params': {'b': 0.6, 'd': 0.2, 'I0': 10, 'T': 5.0, 'seed': 42}},\n        {'type': 'branching', 'params': {'b': 0.5, 'd': 0.5, 'I0': 20, 'T': 4.0, 'seed': 123}},\n        {'type': 'star', 'params': {'M': 100, 'beta': 0.05, 'T': 10.0, 'seed': 2021}},\n        {'type': 'star', 'params': {'M': 50, 'beta': 1.0, 'T': 0.0, 'seed': 7}},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'branching':\n            p = case['params']\n            I_T_sim, n_inf_sim, n_rec_sim = simulate_branching(p['b'], p['d'], p['I0'], p['T'], p['seed'])\n            I_T_exp, n_inf_exp, n_rec_exp = benchmark_branching(p['b'], p['d'], p['I0'], p['T'])\n            \n            delta_I = calculate_relative_error(I_T_sim, I_T_exp)\n            delta_inf = calculate_relative_error(n_inf_sim, n_inf_exp)\n            delta_rec = calculate_relative_error(n_rec_sim, n_rec_exp)\n            \n            max_delta = max(delta_I, delta_inf, delta_rec)\n            results.append(max_delta)\n\n        elif case['type'] == 'star':\n            p = case['params']\n            I_T_sim, n_inf_sim = simulate_star(p['M'], p['beta'], p['T'], p['seed'])\n            I_T_exp, n_inf_exp = benchmark_star(p['M'], p['beta'], p['T'])\n\n            delta_I = calculate_relative_error(I_T_sim, I_T_exp)\n            delta_inf = calculate_relative_error(n_inf_sim, n_inf_exp)\n\n            max_delta = max(delta_I, delta_inf)\n            results.append(max_delta)\n\n    # Format results to six decimal places\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4700645"}]}