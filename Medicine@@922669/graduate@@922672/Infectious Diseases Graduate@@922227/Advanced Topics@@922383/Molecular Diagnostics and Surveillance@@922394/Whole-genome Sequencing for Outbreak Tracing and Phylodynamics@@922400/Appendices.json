{"hands_on_practices": [{"introduction": "The ability to trace outbreaks using genomics begins with understanding the transfer of genetic material between hosts. Pathogen transmission is often subject to a tight bottleneck, where only a few viral particles establish a new infection. This practice [@problem_id:4707057] uses first principles of probability to model this stochastic sampling process, providing a crucial foundation for interpreting shared genetic variants and understanding the role of chance in pathogen evolution during transmission.", "problem": "A donor in an acute viral outbreak harbors an intra-host single-nucleotide variant (iSNV) at frequency $f = 0.1$ among infectious virions. During transmission, the recipient infection is initiated by a tight bottleneck of size $b = 3$, meaning exactly $b$ virions found the new infection. Assume the following empirically grounded and widely used modeling assumptions in phylodynamics and whole-genome sequencing (WGS) for infectious diseases: the donor viral population is large so that virions can be treated as independent and identically distributed, each virion independently carries the iSNV with probability $f$, and the bottleneck is a simple random sample of $b$ virions from the donor population. Define “iSNV transmission” as the event that at least one of the $b$ founding virions carries the iSNV. Starting from the core axioms of probability and the definition of independent Bernoulli trials, derive the probability that the iSNV is transmitted under these assumptions, and then compute its value for $f=0.1$ and $b=3$. Express your final probability as a decimal and round your answer to four significant figures.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Frequency of an intra-host single-nucleotide variant (iSNV) in the donor: $f = 0.1$.\n-   Size of the transmission bottleneck: $b = 3$.\n-   Assumption 1: The donor viral population is large.\n-   Assumption 2: Virions are independent and identically distributed (i.i.d.).\n-   Assumption 3: Each virion independently carries the iSNV with probability $f$.\n-   Assumption 4: The bottleneck is a simple random sample of $b$ virions.\n-   Definition: \"iSNV transmission\" is the event that at least one of the $b$ founding virions carries the iSNV.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a standard and fundamental model in viral phylodynamics and population genetics, specifically the process of genetic drift through a population bottleneck.\n-   **Scientifically Grounded:** The model is a cornerstone of studying viral evolution and transmission. The use of a binomial sampling process to model a transmission bottleneck is a widely accepted and empirically supported simplification. The parameters given ($f=0.1$, $b=3$) are realistic for acute viral infections. The problem is free of pseudoscience.\n-   **Well-Posed:** All necessary variables ($f$, $b$), assumptions (i.i.d. Bernoulli trials), and definitions (\"iSNV transmission\") are explicitly provided. The problem is self-contained and structured to have a unique, meaningful solution.\n-   **Objective:** The problem is stated in precise, formal language without any subjective or opinion-based content.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid as it is scientifically sound, well-posed, and objective. A solution will be derived.\n\n### Derivation\nThe problem requires deriving the probability of iSNV transmission from the core axioms of probability and the definition of independent Bernoulli trials.\n\nLet $T$ be the event that the iSNV is transmitted. By definition, this means at least one of the $b$ virions that found the new infection carries the iSNV.\n\nCalculating the probability of $T$ directly would involve summing the probabilities of exactly $1$ virion carrying the iSNV, exactly $2$ virions carrying the iSNV, ..., up to exactly $b$ virions carrying the iSNV. A more direct approach is to calculate the probability of the complement event, $T^c$, and use the axiom of probability that $P(T) = 1 - P(T^c)$.\n\nThe complement event, $T^c$, is the event that the iSNV is *not* transmitted. This occurs if and only if *none* of the $b$ founding virions carry the iSNV.\n\nLet $A_i$ be the event that the $i$-th virion in the bottleneck sample carries the iSNV, for $i \\in \\{1, 2, \\dots, b\\}$.\nThe problem states that each virion independently carries the iSNV with probability $f$. This constitutes a sequence of $b$ independent Bernoulli trials, where \"success\" is defined as a virion carrying the iSNV.\nThe probability of success for any given trial is $P(A_i) = f$.\nThe probability of \"failure\" (the virion does not carry the iSNV), denoted by the event $A_i^c$, is $P(A_i^c) = 1 - P(A_i) = 1 - f$.\n\nThe event $T^c$ (no transmission) corresponds to all $b$ virions failing to carry the iSNV. This can be expressed as the intersection of the individual failure events:\n$$T^c = A_1^c \\cap A_2^c \\cap \\dots \\cap A_b^c$$\nBecause the problem states that the virions are independent (Assumption 3), the probability of the intersection of these events is the product of their individual probabilities:\n$$P(T^c) = P(A_1^c \\cap A_2^c \\cap \\dots \\cap A_b^c) = P(A_1^c) \\times P(A_2^c) \\times \\dots \\times P(A_b^c)$$\nSince the trials are identically distributed, $P(A_i^c) = 1 - f$ for all $i$. Therefore:\n$$P(T^c) = (1 - f) \\times (1 - f) \\times \\dots \\times (1 - f) \\quad (b \\text{ times})$$\n$$P(T^c) = (1 - f)^b$$\nThis expression gives the probability that none of the $b$ virions carry the iSNV. This result is equivalent to the probability of obtaining $k=0$ successes in a binomial distribution with $b$ trials and success probability $f$, which is $P(k=0) = \\binom{b}{0} f^0 (1-f)^{b-0} = (1-f)^b$.\n\nNow, we can find the probability of transmission, $P(T)$, using the complement rule:\n$$P(T) = 1 - P(T^c)$$\n$$P(T) = 1 - (1 - f)^b$$\nThis is the general formula for the probability of transmission of a variant at frequency $f$ through a bottleneck of size $b$, under the stated assumptions.\n\nWe are given the specific values $f = 0.1$ and $b = 3$. Substituting these into the derived formula:\n$$P(T) = 1 - (1 - 0.1)^3$$\n$$P(T) = 1 - (0.9)^3$$\nCalculating the power:\n$$(0.9)^3 = 0.9 \\times 0.9 \\times 0.9 = 0.81 \\times 0.9 = 0.729$$\nNow, substitute this value back:\n$$P(T) = 1 - 0.729$$\n$$P(T) = 0.271$$\nThe problem requires the answer to be expressed as a decimal rounded to four significant figures. The exact answer, $0.271$, has three significant figures. To express this with four significant figures, we must add a trailing zero, which is significant in this context.\n$$P(T) = 0.2710$$", "answer": "$$\\boxed{0.2710}$$", "id": "4707057"}, {"introduction": "While whole-genome sequencing (WGS) offers unprecedented detail, its power to resolve transmission pathways depends on the accumulation of genetic diversity over time. In rapid outbreaks, the evolutionary 'clock' may tick too slowly to leave a distinguishable trace for every transmission event. This exercise [@problem_id:4706980] asks you to estimate the amount of useful genetic information, or phylogenetic signal, we expect to find in a typical outbreak scenario, revealing the fundamental resolution limits of genomic epidemiology.", "problem": "A research team is using whole-genome sequencing to trace transmission in a short-duration outbreak of a haploid RNA virus. Mutations are modeled as a memoryless Poisson point process along each branch of the time-scaled phylogeny, with a constant per-site substitution rate $\\mu$ (substitutions per site per day), under the infinite-sites model and negligible recombination. In this setting, a site is phylogenetically informative for resolving branching order if and only if the mutation arose on an internal branch that subtends at least two sampled genomes, so that both the ancestral and derived alleles are each present in at least two sequences at the end of sampling.\n\nConsider a time-scaled phylogeny reconstructed from $12$ genomes sampled at the end of the outbreak, whose internal branches (each subtending at least two tips) have lengths $2.5$ days, $1.2$ days, and $0.8$ days. Terminal branches are long due to rapid, near-synchronous sampling but do not contribute to phylogenetically informative changes under the above criterion. The whole-genome alignment length is $L=30{,}000$ sites, and the per-site substitution rate is $\\mu = 1.1 \\times 10^{-6}$ substitutions per site per day.\n\nUsing only the above assumptions and quantities, estimate the expected number of phylogenetically informative sites in this dataset. Round your answer to three significant figures and express it as a pure number without units. Briefly explain the resolution limits that arise in short outbreaks in terms of your estimate.", "solution": "The problem is assessed as valid. It is scientifically grounded in the principles of molecular evolution, internally consistent, and provides all necessary data to compute the requested estimate.\n\nThe problem asks for the expected number of phylogenetically informative sites in a whole-genome dataset from a viral outbreak. The model for mutation accumulation is a Poisson process.\n\nFirst, we identify the given parameters:\n- The whole-genome alignment length is $L = 30,000$ sites.\n- The per-site substitution rate is $\\mu = 1.1 \\times 10^{-6}$ substitutions per site per day.\n- The number of sampled genomes is $12$.\n- The problem defines phylogenetically informative sites as those resulting from mutations on specific internal branches of the phylogeny. The lengths of these branches are given as $b_1 = 2.5$ days, $b_2 = 1.2$ days, and $b_3 = 0.8$ days.\n\nThe number of substitutions along any given branch of the phylogeny is a random variable that follows a Poisson distribution. The rate parameter, $\\lambda$, of this distribution is the product of the per-site substitution rate ($\\mu$), the number of sites ($L$), and the duration of the branch in time ($t$). Thus, the expected number of substitutions on a branch of length $t$ is $E[S] = \\mu \\times L \\times t$.\n\nThe problem states that phylogenetically informative sites arise from mutations occurring only on the specified internal branches. Under the infinite-sites model, each new mutation occurs at a unique site in the genome. Therefore, the expected number of phylogenetically informative sites, denoted $E[N_{\\text{inf}}]$, is equal to the total expected number of mutations occurring across all the specified internal branches.\n\nBy the linearity of expectation, the total expected number of mutations is the sum of the expected numbers on each individual branch. This is equivalent to multiplying the genomic substitution rate ($\\mu \\times L$) by the total length of all relevant branches.\n\nLet $T_{\\text{int}}$ be the total length of the internal branches where informative mutations can occur.\n$$T_{\\text{int}} = b_1 + b_2 + b_3$$\nSubstituting the given values:\n$$T_{\\text{int}} = 2.5 + 1.2 + 0.8 = 4.5 \\text{ days}$$\n\nNow, we can calculate the expected number of informative sites, $E[N_{\\text{inf}}]$:\n$$E[N_{\\text{inf}}] = \\mu \\times L \\times T_{\\text{int}}$$\n\nPlugging in the numerical values for the parameters:\n$$E[N_{\\text{inf}}] = (1.1 \\times 10^{-6} \\text{ site}^{-1} \\text{day}^{-1}) \\times (30,000 \\text{ sites}) \\times (4.5 \\text{ days})$$\n\nFirst, calculate the genome-wide substitution rate, $R_G$:\n$$R_G = \\mu \\times L = (1.1 \\times 10^{-6}) \\times (3 \\times 10^4) = 3.3 \\times 10^{-2} \\text{ substitutions per day}$$\n\nNow, multiply by the total internal branch length:\n$$E[N_{\\text{inf}}] = R_G \\times T_{\\text{int}} = (3.3 \\times 10^{-2}) \\times 4.5$$\n$$E[N_{\\text{inf}}] = 0.033 \\times 4.5 = 0.1485$$\n\nThe problem requires the answer to be rounded to three significant figures. The first three significant figures are $1$, $4$, and $8$. The next digit is $5$, so we round the last significant figure up.\n$$E[N_{\\text{inf}}] \\approx 0.149$$\n\nRegarding the resolution limits, this estimate provides a clear explanation. The expected number of phylogenetically informative sites, $E[N_{\\text{inf}}]$, is approximately $0.149$. Since this value is much less than $1$, it indicates that it is highly probable to observe zero such sites in any given realization of this outbreak. The actual number of informative sites, $N_{\\text{inf}}$, follows a Poisson distribution with mean $\\lambda = 0.1485$. The probability of observing zero informative sites is:\n$$P(N_{\\text{inf}} = 0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-0.1485) \\approx 0.862$$\nThis means there is an approximately $86\\%$ probability that the dataset will contain no sites that can help resolve the internal branching order of the phylogeny. Phylogenetic resolution, the ability to determine the tree topology, is critically dependent on these informative sites. Without them, the relationships between the sampled genomes cannot be determined, and the resulting phylogeny is an unresolved \"star-like\" topology. This scarcity of genetic variation accumulated over the short internal branches of a rapid outbreak poses a fundamental limit to the resolution of transmission tracing using genomic data.", "answer": "$$\\boxed{0.149}$$", "id": "4706980"}, {"introduction": "Genomic data alone is often insufficient for definitive transmission inference; it must be integrated with epidemiological information, such as the timing between cases. This practice [@problem_id:4706992] provides a hands-on introduction to Bayesian hypothesis testing, a powerful framework for formally combining genomic and temporal evidence. You will calculate the posterior probability of a direct transmission link, learning how to weigh competing scenarios in a quantitative and principled manner.", "problem": "In a hospital outbreak of an acute viral infection, whole-genome sequencing (WGS) reveals two cases with identical consensus sequences sampled $\\Delta t = 5$ days apart. Assume the following modeling framework to integrate genomic and epidemiological timing information for outbreak tracing: the serial interval (time from symptom onset in an infector to symptom onset in the infectee) is modeled by a Gamma distribution with mean $m = 4$ days and variance $v = 2$ days$^{2}$. Assume sampling delays are identical across cases so that sampling time differences equal serial interval sums along transmission chains. Further, suppose that, conditional on the chain length, serial intervals along a chain are independent and identically distributed. Motivated by the genomic identity over a short calendar time, adopt a two-hypothesis model in which either there is a single direct transmission ($N=1$) or exactly one intermediate host ($N=2$), with equal prior probabilities $P(N=1) = P(N=2) = \\tfrac{1}{2}$ and $P(N \\ge 3) = 0$. Under $N=n$, the $\\Delta t$ is the sum of $n$ independent serial intervals. In the small-window limit around $t=\\Delta t$, approximate event probabilities with the corresponding probability densities evaluated at $t$. Using only these assumptions and starting from fundamental definitions of the Gamma distribution’s mean and variance and the additivity of independent Gamma variables with common scale, compute the posterior probability that the two cases share a direct transmission link given $\\Delta t = 5$ days. Express your final answer as a decimal and round to four significant figures. Do not include any units in your final answer.", "solution": "The objective is to compute the posterior probability of direct transmission, $P(N=1)$, given the observation that the time difference between samples is $\\Delta t = 5$ days. This is a Bayesian inference problem, and the desired quantity is $P(N=1 | \\Delta t = 5)$.\n\nAccording to Bayes' theorem, the posterior probability is given by:\n$$ P(N=1 | \\Delta t = 5) = \\frac{P(\\Delta t = 5 | N=1) P(N=1)}{P(\\Delta t = 5)} $$\nThe denominator, the marginal probability of the observation, is found by summing over all possible hypotheses using the law of total probability:\n$$ P(\\Delta t = 5) = P(\\Delta t = 5 | N=1) P(N=1) + P(\\Delta t = 5 | N=2) P(N=2) $$\nThe problem states that we can approximate the probability of an event in a small window around $\\Delta t$ with the value of the probability density function (pdf) at that point. Let $f_n(t)$ be the pdf of the time difference $\\Delta t$ under the hypothesis of $n$ transmissions. Thus, we can write $P(\\Delta t=5 | N=n) \\propto f_n(5)$. The posterior probability becomes:\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{f_1(5) P(N=1)}{f_1(5) P(N=1) + f_2(5) P(N=2)} $$\nWe are given that the prior probabilities are equal, $P(N=1) = P(N=2) = \\frac{1}{2}$. Substituting these values simplifies the expression:\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{f_1(5) \\cdot \\frac{1}{2}}{f_1(5) \\cdot \\frac{1}{2} + f_2(5) \\cdot \\frac{1}{2}} = \\frac{f_1(5)}{f_1(5) + f_2(5)} $$\nTo solve this, we must first determine the pdfs $f_1(t)$ and $f_2(t)$.\n\nFirst, we find the parameters of the Gamma distribution for a single serial interval. Let a single serial interval $T$ be a random variable following a Gamma distribution, $T \\sim \\text{Gamma}(\\alpha, \\beta)$, with shape parameter $\\alpha  0$ and rate parameter $\\beta  0$. The pdf is $f(t; \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} t^{\\alpha-1} \\exp(-\\beta t)$. The mean $m$ and variance $v$ of this distribution are given by:\n$$ m = E[T] = \\frac{\\alpha}{\\beta} $$\n$$ v = \\text{Var}(T) = \\frac{\\alpha}{\\beta^2} $$\nWe are given $m = 4$ days and $v = 2$ days$^2$. We can solve for $\\alpha$ and $\\beta$:\n$$ \\frac{m}{v} = \\frac{\\alpha/\\beta}{\\alpha/\\beta^2} = \\beta \\implies \\beta = \\frac{4}{2} = 2 $$\nUsing $\\beta=2$, we can find $\\alpha$:\n$$ \\alpha = m \\cdot \\beta = 4 \\cdot 2 = 8 $$\nSo, a single serial interval is modeled by a $\\text{Gamma}(\\alpha=8, \\beta=2)$ distribution.\n\nUnder the hypothesis $N=1$, the time difference $\\Delta t$ is the duration of a single serial interval. Therefore, the distribution of $\\Delta t$ is $\\text{Gamma}(8, 2)$, and its pdf, $f_1(t)$, is:\n$$ f_1(t) = f(t; 8, 2) = \\frac{2^8}{\\Gamma(8)} t^{8-1} \\exp(-2t) = \\frac{256}{7!} t^7 \\exp(-2t) $$\n\nUnder the hypothesis $N=2$, $\\Delta t$ is the sum of two independent and identically distributed serial intervals, $\\Delta t = T_1 + T_2$, where $T_1, T_2 \\sim \\text{Gamma}(8, 2)$. A fundamental property of the Gamma distribution is that the sum of independent Gamma variables with the same rate parameter is also a Gamma variable. The new shape parameter is the sum of the individual shape parameters.\n$$ \\Delta t \\sim \\text{Gamma}(\\alpha_1+\\alpha_2, \\beta) = \\text{Gamma}(8+8, 2) = \\text{Gamma}(16, 2) $$\nThe pdf for this case, $f_2(t)$, is:\n$$ f_2(t) = f(t; 16, 2) = \\frac{2^{16}}{\\Gamma(16)} t^{16-1} \\exp(-2t) = \\frac{65536}{15!} t^{15} \\exp(-2t) $$\n\nNow we can compute the posterior probability by evaluating the ratio of these densities at $t = \\Delta t = 5$:\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{f_1(5)}{f_1(5) + f_2(5)} = \\frac{1}{1 + \\frac{f_2(5)}{f_1(5)}} $$\nLet's compute the ratio $R = \\frac{f_2(5)}{f_1(5)}$:\n$$ R = \\frac{\\frac{2^{16}}{15!} 5^{15} \\exp(-2 \\cdot 5)}{\\frac{2^8}{7!} 5^7 \\exp(-2 \\cdot 5)} = \\frac{2^{16} \\cdot 5^{15} \\cdot 7!}{2^8 \\cdot 5^7 \\cdot 15!} $$\nThe $\\exp(-10)$ terms cancel. Simplifying the powers and factorials:\n$$ R = \\frac{2^{16-8} \\cdot 5^{15-7}}{15!/7!} = \\frac{2^8 \\cdot 5^8}{15 \\cdot 14 \\cdot 13 \\cdot 12 \\cdot 11 \\cdot 10 \\cdot 9 \\cdot 8} = \\frac{(2 \\cdot 5)^8}{15 \\cdot 14 \\cdot 13 \\cdot 12 \\cdot 11 \\cdot 10 \\cdot 9 \\cdot 8} $$\n$$ R = \\frac{10^8}{259459200} = \\frac{100000000}{259459200} $$\nTo simplify this fraction, we can express the denominator in terms of its prime factors.\nThe denominator is $15!/7! = (3 \\cdot 5) \\cdot (2 \\cdot 7) \\cdot 13 \\cdot (2^2 \\cdot 3) \\cdot 11 \\cdot (2 \\cdot 5) \\cdot 3^2 \\cdot 2^3 = 2^7 \\cdot 3^4 \\cdot 5^2 \\cdot 7 \\cdot 11 \\cdot 13$.\nThe numerator is $10^8 = (2 \\cdot 5)^8 = 2^8 \\cdot 5^8$.\nThe ratio $R$ is therefore:\n$$ R = \\frac{2^8 \\cdot 5^8}{2^7 \\cdot 3^4 \\cdot 5^2 \\cdot 7 \\cdot 11 \\cdot 13} = \\frac{2 \\cdot 5^6}{3^4 \\cdot 7 \\cdot 11 \\cdot 13} = \\frac{2 \\cdot 15625}{81 \\cdot 1001} = \\frac{31250}{81081} $$\nNow, we substitute this back into the expression for the posterior probability:\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{1}{1 + R} = \\frac{1}{1 + \\frac{31250}{81081}} = \\frac{1}{\\frac{81081 + 31250}{81081}} = \\frac{81081}{112331} $$\nPerforming the division gives the final numerical answer:\n$$ P(N=1 | \\Delta t = 5) \\approx 0.721815... $$\nRounding to four significant figures, the posterior probability is $0.7218$.", "answer": "$$\\boxed{0.7218}$$", "id": "4706992"}]}