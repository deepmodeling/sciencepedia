{"hands_on_practices": [{"introduction": "The classic Susceptible-Infectious-Recovered (SIR) model provides the theoretical bedrock for understanding epidemic dynamics. This first practice moves beyond simply using pre-made formulas by challenging you to derive the fundamental \"final size relation\" directly from the model's differential equations. By connecting the basic reproduction number, $R_0$, to the total proportion of the population infected, you will gain a deeper appreciation for how epidemic dynamics shape the final outcome and how post-epidemic data can be used for inference [@problem_id:4697747].", "problem": "A closed population of size $N$ experiences an epidemic of a respiratory pathogen governed by the homogeneous Susceptible–Infectious–Recovered (SIR) model. The model uses mass-action transmission with per-contact transmission parameter $\\beta$ and recovery rate $\\gamma$, and the population fractions satisfy $s(t) + i(t) + r(t) = 1$, where $s(t) = S(t)/N$, $i(t) = I(t)/N$, and $r(t) = R(t)/N$. The dynamics are\n$$\\frac{ds}{dt} = -\\beta s i,\\qquad \\frac{di}{dt} = \\beta s i - \\gamma i,\\qquad \\frac{dr}{dt} = \\gamma i.$$\nThe basic reproduction number, defined as the expected number of secondary infections generated by a single typical infectious individual in a fully susceptible population, is $R_{0} = \\beta/\\gamma$.\n\nBefore the epidemic, serological data indicate that a fraction $r(0) = r_{0}$ of the population has pre-existing immunity due to prior exposure and cross-reactive responses, with $r_{0} = 0.12$. Thus the initially susceptible fraction is $s(0) = s_{0} = 0.88$, and $i(0)$ is negligible relative to $N$. After the epidemic concludes, the surveillance system reports an observed cumulative fraction of individuals ever infected of $z_{\\mathrm{obs}} = 0.246$. A validation study indicates that the case ascertainment fraction is $a = 0.60$, assumed constant over the course of the epidemic, so the true cumulative infected fraction is $z = z_{\\mathrm{obs}}/a$.\n\nStarting from the SIR equations and the definitions above (do not assume any pre-derived final-size relation), derive an analytic expression for the basic reproduction number $R_{0}$ in terms of $s_{0}$ and $z$, and then evaluate it numerically using the values $s_{0} = 0.88$, $z_{\\mathrm{obs}} = 0.246$, and $a = 0.60$. Express your final answer as a pure number rounded to four significant figures. Do not include units or a percent sign anywhere in your answer.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. It is based on the standard Susceptible–Infectious–Recovered (SIR) model, a fundamental framework in mathematical epidemiology. All provided data and definitions are clear, consistent, and plausible within this context. The task is to derive a standard result (the final size relation) from first principles and apply it, which is a valid and non-trivial exercise. Therefore, I will proceed with a full solution.\n\nThe objective is to derive an analytical expression for the basic reproduction number, $R_{0}$, in terms of the initial susceptible fraction, $s_{0}$, and the true cumulative infected fraction, $z$. Subsequently, this expression will be numerically evaluated.\n\nThe dynamics of the susceptible and infectious fractions are given by the SIR model equations:\n$$ \\frac{ds}{dt} = -\\beta s i $$\n$$ \\frac{di}{dt} = \\beta s i - \\gamma i $$\nTo find a relationship between the state variables $s$ and $i$ that is independent of time $t$, we can divide the second equation by the first:\n$$ \\frac{di}{ds} = \\frac{\\frac{di}{dt}}{\\frac{ds}{dt}} = \\frac{\\beta s i - \\gamma i}{-\\beta s i} $$\nFor the duration of the epidemic, we assume $i(t) > 0$, so we can simplify the expression by canceling the term $i$:\n$$ \\frac{di}{ds} = \\frac{\\beta s - \\gamma}{-\\beta s} = -1 + \\frac{\\gamma}{\\beta s} $$\nThe problem defines the basic reproduction number as $R_{0} = \\beta/\\gamma$. Substituting this into the equation gives:\n$$ \\frac{di}{ds} = -1 + \\frac{1}{R_{0}s} $$\nWe can solve this ordinary differential equation by separating variables and integrating:\n$$ \\int di = \\int \\left(-1 + \\frac{1}{R_{0}s}\\right) ds $$\n$$ i(s) = -s + \\frac{1}{R_{0}}\\ln(s) + C $$\nwhere $C$ is the constant of integration. We determine $C$ using the initial conditions at the beginning of the epidemic ($t=0$). The problem states an initial susceptible fraction $s(0) = s_{0}$ and a negligible initial infectious fraction, which we can approximate as $i(0) = 0$.\n$$ 0 = -s_{0} + \\frac{1}{R_{0}}\\ln(s_{0}) + C $$\nSolving for $C$:\n$$ C = s_{0} - \\frac{1}{R_{0}}\\ln(s_{0}) $$\nSubstituting this expression for $C$ back into the equation for $i(s)$ yields the trajectory of the epidemic in the $(s, i)$ phase plane:\n$$ i(s) = -s + \\frac{1}{R_{0}}\\ln(s) + s_{0} - \\frac{1}{R_{0}}\\ln(s_{0}) $$\n$$ i(s) = (s_{0} - s) - \\frac{1}{R_{0}} (\\ln(s_{0}) - \\ln(s)) = (s_{0} - s) - \\frac{1}{R_{0}}\\ln\\left(\\frac{s_{0}}{s}\\right) $$\nThe epidemic concludes as $t \\to \\infty$. At this point, the infectious population depletes, so $i(\\infty) = 0$. Let $s_{\\infty} = s(\\infty)$ be the fraction of the population that remains susceptible at the end of the epidemic. Setting $i(s_{\\infty})=0$ in the trajectory equation gives the final size relation:\n$$ 0 = (s_{0} - s_{\\infty}) - \\frac{1}{R_{0}}\\ln\\left(\\frac{s_{0}}{s_{\\infty}}\\right) $$\nThe problem defines $z$ as the true cumulative fraction of individuals ever infected. This corresponds to the total decrease in the susceptible fraction from the beginning to the end of the epidemic. Thus:\n$$ z = s_{0} - s_{\\infty} $$\nThis allows us to express the final susceptible fraction as $s_{\\infty} = s_{0} - z$. Substituting these two relations into the final size equation:\n$$ z - \\frac{1}{R_{0}}\\ln\\left(\\frac{s_{0}}{s_{0} - z}\\right) = 0 $$\nWe are asked to find an expression for $R_{0}$. Assuming an epidemic has occurred ($z > 0$), we can rearrange the equation:\n$$ R_{0} z = \\ln\\left(\\frac{s_{0}}{s_{0} - z}\\right) $$\n$$ R_{0} = \\frac{1}{z}\\ln\\left(\\frac{s_{0}}{s_{0} - z}\\right) $$\nThis is the required analytical expression for $R_{0}$ in terms of $s_{0}$ and $z$. An equivalent form is $R_{0} = -\\frac{1}{z}\\ln\\left(1 - \\frac{z}{s_{0}}\\right)$.\n\nNow, we proceed with the numerical evaluation. The problem provides the following values:\nInitial susceptible fraction: $s_{0} = 0.88$.\nObserved cumulative infected fraction: $z_{\\mathrm{obs}} = 0.246$.\nCase ascertainment fraction: $a = 0.60$.\n\nFirst, we calculate the true cumulative infected fraction $z$:\n$$ z = \\frac{z_{\\mathrm{obs}}}{a} = \\frac{0.246}{0.60} = 0.41 $$\nNext, we substitute the numerical values of $s_0$ and $z$ into the derived expression for $R_{0}$:\n$$ R_{0} = \\frac{1}{0.41} \\ln\\left(\\frac{0.88}{0.88 - 0.41}\\right) $$\n$$ R_{0} = \\frac{1}{0.41} \\ln\\left(\\frac{0.88}{0.47}\\right) $$\n$$ R_{0} \\approx \\frac{1}{0.41} \\ln(1.8723404) $$\n$$ R_{0} \\approx \\frac{1}{0.41} \\times 0.6272536 $$\n$$ R_{0} \\approx 1.5298867... $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ R_{0} \\approx 1.530 $$\nThis value is consistent with an epidemic occurring, as the effective reproduction number at the start, $R_{e}(0) = s_{0}R_{0} = 0.88 \\times 1.530 \\approx 1.346$, is greater than $1$.", "answer": "$$\\boxed{1.530}$$", "id": "4697747"}, {"introduction": "Real-world pathogens rarely fit the simple assumptions of the basic SIR model, and this exercise introduces crucial layers of complexity such as pre-symptomatic and asymptomatic transmission. You will learn to calculate $R_0$ by summing the contributions from different infectious stages, a common feature in models for diseases like influenza and COVID-19. You will then apply this more nuanced understanding to determine the herd immunity threshold required for a \"leaky\" vaccine that offers partial, rather than perfect, protection [@problem_id:4697715].", "problem": "Consider an acute directly transmitted infection spreading in a large, well-mixed host population of constant size. The host population is divided into compartments: susceptible $S$, exposed (infected but not yet infectious) $E$, pre-symptomatic infectious $P$, asymptomatic infectious $A$, symptomatic infectious $I$, and removed $R$. Only symptomatic infectious individuals $I$ are directly observed in surveillance; the compartments $E$, $P$, and $A$ are unobservable. Assume the disease-free equilibrium satisfies $S \\approx 1$.\n\nNew infections occur at a force of infection $\\lambda$ generated by infectious individuals in $P$, $A$, and $I$. Specifically, each individual in $P$, $A$, and $I$ produces infectious contacts at per-capita rates $\\beta_{P}$, $\\beta_{A}$, and $\\beta_{I}$ (in per-day units), respectively, into a fully susceptible population. The exposed class $E$ is not infectious.\n\nProgression and removal dynamics are as follows:\n- Exposed individuals $E$ leave $E$ at rate $\\sigma$ (per day). Upon leaving $E$, a fraction $f$ enters the pre-symptomatic infectious class $P$, and a fraction $1-f$ enters the asymptomatic infectious class $A$.\n- Pre-symptomatic infectious individuals $P$ progress to symptomatic infectious $I$ at rate $\\alpha$ (per day).\n- Asymptomatic infectious individuals $A$ recover (or are removed) at rate $\\gamma_{A}$ (per day).\n- Symptomatic infectious individuals $I$ recover (or are removed) at rate $\\gamma_{I}$ (per day).\n\nAssume the following parameter values:\n- $\\sigma = \\dfrac{1}{3}$, $\\alpha = \\dfrac{1}{2}$, $\\gamma_{A} = \\dfrac{1}{5}$, $\\gamma_{I} = \\dfrac{1}{4}$ (all in per-day units).\n- $\\beta_{P} = 0.30$, $\\beta_{A} = 0.20$, $\\beta_{I} = 0.35$ (per day).\n- $f = 0.60$.\n\nA vaccine that reduces susceptibility uniformly by a factor $\\varepsilon$ (a “leaky” vaccine) is introduced and administered to a fraction $p$ of the population at the disease-free equilibrium. Assume $\\varepsilon = 0.80$.\n\nStarting only from the core definition that the basic reproduction number $R_{0}$ is the expected number of secondary infections generated by a single newly infected individual introduced into a fully susceptible population, derive the contribution of unobservable stages to $R_{0}$ in this staged infection process and then determine the minimal vaccination fraction $p^{\\star}$ that prevents invasion (herd immunity threshold under leaky vaccination). Express the final answer for $p^{\\star}$ as a decimal number, rounded to four significant figures. Do not use a percentage sign.", "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Model Structure**: A compartmental model for an acute, directly transmitted infection with compartments for susceptible ($S$), exposed ($E$), pre-symptomatic infectious ($P$), asymptomatic infectious ($A$), symptomatic infectious ($I$), and removed ($R$) individuals. The host population is large, well-mixed, and of constant size.\n- **Disease-Free Equilibrium (DFE) Assumption**: $S \\approx 1$ at the DFE (using population fractions).\n- **Infectivity**: Individuals in compartments $P$, $A$, and $I$ are infectious with per-capita transmission rates $\\beta_{P}$, $\\beta_{A}$, and $\\beta_{I}$, respectively. The exposed class $E$ is not infectious.\n- **Progression and Removal**:\n    - Individuals leave $E$ at rate $\\sigma$. A fraction $f$ enters $P$, and $1-f$ enters $A$.\n    - Individuals leave $P$ and enter $I$ at rate $\\alpha$.\n    - Individuals leave $A$ (recover/remove) at rate $\\gamma_{A}$.\n    - Individuals leave $I$ (recover/remove) at rate $\\gamma_{I}$.\n- **Observability**: Only individuals in compartment $I$ are observable. $E$, $P$, and $A$ are unobservable.\n- **Parameter Values**:\n    - $\\sigma = \\frac{1}{3}$ per day\n    - $\\alpha = \\frac{1}{2}$ per day\n    - $\\gamma_{A} = \\frac{1}{5}$ per day\n    - $\\gamma_{I} = \\frac{1}{4}$ per day\n    - $\\beta_{P} = 0.30$ per day\n    - $\\beta_{A} = 0.20$ per day\n    - $\\beta_{I} = 0.35$ per day\n    - $f = 0.60$\n- **Vaccine Characteristics**:\n    - A \"leaky\" vaccine that reduces susceptibility by a factor $\\varepsilon = 0.80$.\n    - The vaccine is administered to a fraction $p$ of the population.\n- **Objective**:\n    1.  Derive the contribution of unobservable stages ($P$ and $A$) to the basic reproduction number, $R_0$.\n    2.  Determine the minimal vaccination fraction $p^{\\star}$ required to prevent epidemic invasion (herd immunity). The final answer for $p^{\\star}$ is to be a decimal rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a deterministic compartmental model, a standard and widely accepted framework in mathematical epidemiology for studying infectious disease dynamics. The concepts of $R_0$, staged infection, asymptomatic transmission, and leaky vaccines are well-established within the field.\n- **Well-Posed**: The model structure is clearly defined, and all necessary parameters are provided. The questions posed are specific and have a unique, determinable solution based on the provided information.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. The assumptions, such as a well-mixed population, are standard simplifications in this type of modeling and are explicitly stated.\n\nThe problem is a standard exercise in mathematical epidemiology. It does not violate any scientific principles, is not incomplete or contradictory, and is fully formalizable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\n**Derivation of the Basic Reproduction Number, $R_0$**\n\nThe basic reproduction number, $R_0$, is defined as the expected number of secondary infections produced by a single newly infected individual in a completely susceptible population. In this model, a newly infected individual enters the exposed compartment, $E$. We trace the expected number of new infections this individual will generate as they progress through the subsequent infectious stages.\n\nThe average time an individual spends in any compartment $X$ with a single exit rate $\\delta$ is given by $1/\\delta$.\n\n1.  An individual enters $E$ and spends an average of $1/\\sigma$ days in this compartment. The compartment $E$ is not infectious, so no secondary cases are generated at this stage.\n\n2.  Upon leaving $E$, the individual enters the pre-symptomatic compartment $P$ with probability $f$ or the asymptomatic compartment $A$ with probability $1-f$.\n\n3.  **Contribution from the Pre-symptomatic ($P$) and Symptomatic ($I$) Path**:\n    An individual who enters $P$ (which occurs with probability $f$) will spend an average of $1/\\alpha$ days in this stage. During this time, they cause new infections at a rate $\\beta_P$. The expected number of infections generated in stage $P$ is the product of the probability of entering this path, the duration, and the transmission rate:\n    $$ R_{0,P} = f \\times \\frac{1}{\\alpha} \\times \\beta_P = f \\frac{\\beta_P}{\\alpha} $$\n    After leaving $P$, the individual deterministically enters the symptomatic compartment $I$. They spend an average of $1/\\gamma_I$ days in stage $I$, causing new infections at a rate $\\beta_I$. The expected number of infections generated in stage $I$ by an individual who followed this path is:\n    $$ R_{0,I} = f \\times \\frac{1}{\\gamma_I} \\times \\beta_I = f \\frac{\\beta_I}{\\gamma_I} $$\n\n4.  **Contribution from the Asymptomatic ($A$) Path**:\n    An individual who enters $A$ (with probability $1-f$) will spend an average of $1/\\gamma_A$ days in this stage. During this time, they cause new infections at a rate $\\beta_A$. The expected number of infections generated in stage $A$ is:\n    $$ R_{0,A} = (1-f) \\times \\frac{1}{\\gamma_A} \\times \\beta_A = (1-f) \\frac{\\beta_A}{\\gamma_A} $$\n\nThe total basic reproduction number, $R_0$, is the sum of the expected contributions from all infectious stages over the entire course of infection:\n$$ R_0 = R_{0,P} + R_{0,I} + R_{0,A} $$\n$$ R_0 = f \\frac{\\beta_P}{\\alpha} + f \\frac{\\beta_I}{\\gamma_I} + (1-f) \\frac{\\beta_A}{\\gamma_A} $$\n\n**Contribution of Unobservable Stages to $R_0$**\n\nThe problem identifies the compartments $E$, $P$, and $A$ as unobservable. Of these, $P$ and $A$ are infectious. The contribution of these unobservable infectious stages to $R_0$ is the sum of the secondary cases they generate.\n$$ R_{0, \\text{unobs}} = R_{0,P} + R_{0,A} = f \\frac{\\beta_P}{\\alpha} + (1-f) \\frac{\\beta_A}{\\gamma_A} $$\nThis expression represents the derived contribution of unobservable stages to $R_0$.\n\n**Determination of the Minimal Vaccination Fraction $p^{\\star}$**\n\nFirst, we calculate the numerical value of $R_0$ using the given parameters:\n- $\\sigma = 1/3$\n- $\\alpha = 1/2$\n- $\\gamma_A = 1/5$\n- $\\gamma_I = 1/4$\n- $\\beta_P = 0.30$\n- $\\beta_A = 0.20$\n- $\\beta_I = 0.35$\n- $f = 0.60$\n\nThe contributions are:\n$$ R_{0,P} = 0.60 \\times \\frac{0.30}{1/2} = 0.60 \\times 0.60 = 0.36 $$\n$$ R_{0,A} = (1 - 0.60) \\times \\frac{0.20}{1/5} = 0.40 \\times 1.0 = 0.40 $$\n$$ R_{0,I} = 0.60 \\times \\frac{0.35}{1/4} = 0.60 \\times 1.40 = 0.84 $$\n\nThe total basic reproduction number is:\n$$ R_0 = 0.36 + 0.40 + 0.84 = 1.60 $$\n\nNow, we consider the effect of vaccination. A fraction $p$ of the population is vaccinated. The vaccine is \"leaky\" with efficacy $\\varepsilon=0.80$, meaning it reduces the susceptibility of a vaccinated individual by a factor of $\\varepsilon$. An unvaccinated individual has susceptibility $s_{u}=1$, while a vaccinated individual has susceptibility $s_{v} = 1 - \\varepsilon$.\n\nThe effective reproduction number, $R_v$, in this partially vaccinated population is the product of $R_0$ and the average susceptibility of the population, $\\bar{s}$:\n$$ \\bar{s} = (1-p)s_u + p s_v = (1-p)(1) + p(1-\\varepsilon) = 1-p+p-p\\varepsilon = 1-p\\varepsilon $$\n$$ R_v = R_0 \\times \\bar{s} = R_0 (1 - p\\varepsilon) $$\n\nTo prevent the epidemic from invading (i.e., to achieve herd immunity), the effective reproduction number must be less than or equal to $1$. The minimal vaccination fraction, $p^{\\star}$, is the value of $p$ for which $R_v = 1$.\n$$ R_0 (1 - p^{\\star}\\varepsilon) = 1 $$\nSolving for $p^{\\star}$:\n$$ 1 - p^{\\star}\\varepsilon = \\frac{1}{R_0} $$\n$$ p^{\\star}\\varepsilon = 1 - \\frac{1}{R_0} $$\n$$ p^{\\star} = \\frac{1}{\\varepsilon} \\left( 1 - \\frac{1}{R_0} \\right) $$\n\nWe substitute the numerical values for $\\varepsilon$ and $R_0$:\n$$ \\varepsilon = 0.80 $$\n$$ R_0 = 1.60 $$\n$$ p^{\\star} = \\frac{1}{0.80} \\left( 1 - \\frac{1}{1.60} \\right) $$\n$$ p^{\\star} = 1.25 \\left( 1 - 0.625 \\right) $$\n$$ p^{\\star} = 1.25 \\times 0.375 $$\n$$ p^{\\star} = 0.46875 $$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$ p^{\\star} \\approx 0.4688 $$\nThis is the minimal fraction of the population that must be vaccinated to ensure that, on average, a single infected individual introduced into the population generates fewer than one secondary infection, thus preventing an epidemic.", "answer": "$$\\boxed{0.4688}$$", "id": "4697715"}, {"introduction": "Theoretical models are essential, but practical epidemiology relies on robust statistical inference from often-imperfect data. This final practice places you in the role of a data analyst during an outbreak's early phase, working with contact tracing records that have incomplete case capture. You will derive the maximum likelihood estimator for $R_0$ from first principles and use it to inform public health strategy by calculating the necessary vaccination coverage for herd immunity [@problem_id:4697692].", "problem": "Consider the early phase of a directly transmitted infectious disease outbreak in a large, well-mixed population, so that depletion of susceptibles is negligible. Model the infection process as a Galton–Watson branching process in discrete generations with independent and identically distributed offspring. Assume the following data-generating process for the number of secondary infections:\n\n- For each infectious individual $i$, the true number of secondary infections $N_i$ they generate is an independent draw from a Poisson distribution with unknown mean $R_0$, where $R_0$ is the basic reproduction number.\n- Contact tracing is conducted with independent capture of each true secondary infection: conditional on $N_i$, each of the $N_i$ secondary infections is ascertained independently with known probability $p \\in (0,1]$, yielding an observed count $Y_i$ of traced secondary infections per index case.\n\nAssume that all $N_i$ and all tracing capture events are mutually independent across individuals. You are given early-phase contact tracing observations $\\{Y_i\\}$ and the known tracing capture probability $p$ for each test case. You are also given a vaccine that is uniformly deployed as a leaky vaccine that reduces susceptibility multiplicatively: if an individual is vaccinated with efficacy $e \\in [0,1]$, then their susceptibility to infection per potentially infectious contact is multiplied by $(1-e)$. In a uniformly vaccinated population with coverage $v \\in [0,1]$, the expected number of secondary infections per infectious individual in the vaccinated population equals the average of individual susceptibilities in the population times the unmitigated offspring mean. Herd immunity (i.e., a subcritical process) is achieved if and only if the expected number of secondary infections per infectious individual in the vaccinated population is strictly less than $1$.\n\nTasks:\n\n1. Starting only from the assumptions above and standard probability rules, derive the likelihood of $R_0$ given observed counts $\\{Y_i\\}_{i=1}^n$ and known capture probability $p$, and obtain the maximum likelihood estimator $\\hat{R}_0$ as a function of the data $\\{Y_i\\}$ and $p$.\n\n2. Using your estimator $\\hat{R}_0$, determine, for a given susceptibility-reducing efficacy $e$, the minimal vaccination coverage fraction $v^\\star \\in [0,1]$ (expressed as a decimal, not a percentage) required to make the branching process strictly subcritical in expectation under uniform vaccination. If $\\hat{R}_0 \\le 1$, define $v^\\star$ to be $0$. If, for $\\hat{R}_0 > 1$, no $v \\in [0,1]$ satisfies the subcriticality condition given $e$ (including the case $e=0$), then report $v^\\star$ as $1$ and mark herd immunity as unattainable. Otherwise, report the computed $v^\\star \\in (0,1]$ and mark herd immunity as attainable.\n\n3. Implement a program that, for each test case below, computes and returns a triple consisting of $\\hat{R}_0$, $v^\\star$, and a boolean indicating whether herd immunity is attainable under the given $e$ (true if attainable, false otherwise). Vaccination coverage must be reported as a decimal in $[0,1]$, not a percentage.\n\nTest suite:\n\n- Test case A:\n  - Observed traced offspring counts $Y = [$0$, $1$, $2$, $0$, $1$, $3$, $2$, $0$, $1$, $2$]$\n  - Tracing capture probability $p = $0.5$\n  - Vaccine efficacy $e = $0.8$\n- Test case B:\n  - Observed traced offspring counts $Y = [$0$, $0$, $1$, $0$, $0$, $1$, $0$, $0$, $1$, $0$]$\n  - Tracing capture probability $p = $0.2$\n  - Vaccine efficacy $e = $0.9$\n- Test case C (boundary behavior with no observed transmission):\n  - Observed traced offspring counts $Y = [$0$, $0$, $0$, $0$, $0$]$\n  - Tracing capture probability $p = $0.7$\n  - Vaccine efficacy $e = $0.7$\n- Test case D (stress case with higher apparent transmission and limited efficacy):\n  - Observed traced offspring counts $Y = [$4$, $1$, $3$, $2$, $5$, $3$, $4$, $2$, $1$, $3$, $2$, $4$]$\n  - Tracing capture probability $p = $0.6$\n  - Vaccine efficacy $e = $0.6$\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a three-element list of the form $[\\hat{R}_0, v^\\star, \\text{attainable}]$, where $\\hat{R}_0$ and $v^\\star$ are real numbers, and the attainability indicator is a boolean. For example, a valid overall output structure is $[[x_1,y_1,\\text{True}],[x_2,y_2,\\text{False}],[x_3,y_3,\\text{True}],[x_4,y_4,\\text{True}]]$. The vaccination coverage $v^\\star$ must be expressed as a decimal in $[0,1]$.", "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It is based on standard principles of mathematical epidemiology and statistical inference, specifically the use of Galton-Watson branching processes, Poisson distributions for offspring counts, and binomial thinning for observation processes. The definitions of vaccine efficacy, herd immunity, and the associated parameters are clear and consistent with the established literature. The tasks are mathematically well-defined, and the provided data are complete and consistent for solving them. Therefore, the problem is deemed valid and a full solution is warranted.\n\n### Part 1: Derivation of the Maximum Likelihood Estimator for $R_0$\n\nThe problem specifies a two-stage data-generating process for each observed count of traced secondary infections, $Y_i$.\n1.  The true number of secondary infections generated by an individual $i$, denoted $N_i$, is a random variable drawn from a Poisson distribution with mean $R_0$. The probability mass function (PMF) is:\n    $$P(N_i = k) = \\frac{e^{-R_0} R_0^k}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots$$\n2.  Each of these $N_i$ secondary infections is independently captured by contact tracing with probability $p$. Conditional on $N_i = k$, the number of observed infections, $Y_i$, follows a binomial distribution:\n    $$P(Y_i = y | N_i = k) = \\binom{k}{y} p^y (1-p)^{k-y} \\quad \\text{for } y = 0, 1, \\dots, k$$\n\nTo find the likelihood of $R_0$ given the observations $\\{Y_i = y_i\\}_{i=1}^n$, we must first determine the unconditional PMF of $Y_i$. This is found by marginalizing over the unobserved true counts $N_i$.\n$$P(Y_i = y) = \\sum_{k=y}^{\\infty} P(Y_i = y | N_i = k) P(N_i = k)$$\nThe sum starts from $k=y$ because the number of observed cases cannot exceed the true number of cases.\n\nSubstituting the PMFs for the binomial and Poisson distributions:\n$$P(Y_i = y) = \\sum_{k=y}^{\\infty} \\left[ \\frac{k!}{y!(k-y)!} p^y (1-p)^{k-y} \\right] \\left[ \\frac{e^{-R_0} R_0^k}{k!} \\right]$$\nWe can rearrange terms, taking factors not dependent on the summation index $k$ outside the sum:\n$$P(Y_i = y) = \\frac{e^{-R_0} p^y}{y!} \\sum_{k=y}^{\\infty} \\frac{1}{(k-y)!} (1-p)^{k-y} R_0^k$$\nLet us perform a change of index $j = k-y$, which implies $k = j+y$. As $k$ goes from $y$ to $\\infty$, $j$ goes from $0$ to $\\infty$.\n$$P(Y_i = y) = \\frac{e^{-R_0} p^y}{y!} \\sum_{j=0}^{\\infty} \\frac{1}{j!} (1-p)^j R_0^{j+y}$$\nWe can factor out $R_0^y$ from the sum:\n$$P(Y_i = y) = \\frac{e^{-R_0} p^y R_0^y}{y!} \\sum_{j=0}^{\\infty} \\frac{((1-p)R_0)^j}{j!}$$\nThe summation term is the Taylor series expansion of the exponential function, $\\sum_{j=0}^{\\infty} \\frac{x^j}{j!} = e^x$, with $x = (1-p)R_0$.\n$$P(Y_i = y) = \\frac{(pR_0)^y e^{-R_0}}{y!} e^{(1-p)R_0}$$\nSimplifying the exponential terms, $e^{-R_0} e^{(1-p)R_0} = e^{-R_0 + R_0 - pR_0} = e^{-pR_0}$.\n$$P(Y_i = y) = \\frac{(pR_0)^y e^{-pR_0}}{y!}$$\nThis is the PMF of a Poisson distribution with mean $pR_0$. This result, known as Poisson thinning, is a fundamental property of the Poisson process. Thus, $Y_i \\sim \\text{Poisson}(pR_0)$.\n\nThe observations $\\{Y_i\\}_{i=1}^n$ are independent and identically distributed. The likelihood function $L(R_0)$ for the parameter $R_0$ given the data $\\{y_i\\}_{i=1}^n$ is the product of the individual probabilities:\n$$L(R_0; \\{y_i\\}, p) = \\prod_{i=1}^n P(Y_i = y_i) = \\prod_{i=1}^n \\frac{(pR_0)^{y_i} e^{-pR_0}}{y_i!}$$\nFor maximization, we use the log-likelihood function $\\ell(R_0) = \\ln L(R_0)$:\n$$\\ell(R_0) = \\sum_{i=1}^n \\left( y_i \\ln(pR_0) - pR_0 - \\ln(y_i!) \\right)$$\n$$\\ell(R_0) = \\sum_{i=1}^n (y_i \\ln(p) + y_i \\ln(R_0) - pR_0 - \\ln(y_i!))$$\nTo find the maximum likelihood estimator (MLE) $\\hat{R}_0$, we differentiate $\\ell(R_0)$ with respect to $R_0$ and set the result to zero:\n$$\\frac{d\\ell}{dR_0} = \\sum_{i=1}^n \\left( \\frac{y_i}{R_0} - p \\right) = \\frac{1}{R_0}\\sum_{i=1}^n y_i - np = 0$$\nSolving for $R_0$:\n$$\\frac{1}{R_0}\\sum_{i=1}^n y_i = np \\implies \\hat{R}_0 = \\frac{\\sum_{i=1}^n y_i}{np}$$\nLet $\\bar{Y} = \\frac{1}{n} \\sum_{i=1}^n y_i$ be the sample mean of the observations. The MLE can be written as:\n$$\\hat{R}_0 = \\frac{\\bar{Y}}{p}$$\nThe second derivative, $\\frac{d^2\\ell}{dR_0^2} = -\\frac{1}{R_0^2}\\sum y_i$, is negative for $\\sum y_i > 0$, confirming that this is a maximum. If all $y_i=0$, then $\\hat{R}_0=0$, which is the correct boundary solution.\n\n### Part 2: Minimal Vaccination Coverage for Herd Immunity\n\nThe reproduction number in a uniformly vaccinated population, $R_v$, is given by the unmitigated reproduction number, $R_0$, multiplied by the average population susceptibility. With a fraction $v$ of the population vaccinated with a leaky vaccine of efficacy $e$, and a fraction $1-v$ unvaccinated, the average susceptibility is $(1-v) \\times 1 + v \\times (1-e) = 1-ve$.\nThus, the reproduction number in the vaccinated population is:\n$$R_v = R_0 (1-ve)$$\nHerd immunity is achieved if this process is strictly subcritical, meaning $R_v < 1$. We use our estimator $\\hat{R}_0$ in place of the true $R_0$:\n$$\\hat{R}_0 (1-ve) < 1$$\n\nWe must find the minimal vaccination coverage $v^\\star \\in [0,1]$ that satisfies this condition.\n\n**Case 1: Subcritical baseline ($\\hat{R}_0 \\le 1$)**\nIf the estimated basic reproduction number is already less than or equal to $1$, the epidemic is not self-sustaining. The problem states that in this scenario, the minimal required coverage is zero.\n$$v^\\star = 0$$\nIn this case, herd immunity is considered attainable.\n\n**Case 2: Supercritical baseline ($\\hat{R}_0 > 1$)**\nWe must solve the inequality for $v$:\n$$1 - ve < \\frac{1}{\\hat{R}_0}$$\n$$-ve < \\frac{1}{\\hat{R}_0} - 1$$\n$$ve > 1 - \\frac{1}{\\hat{R}_0}$$\nIf vaccine efficacy $e > 0$, we can divide by $e$:\n$$v > \\frac{1}{e} \\left(1 - \\frac{1}{\\hat{R}_0}\\right)$$\nThe minimal coverage $v^\\star$ would be the threshold value $v^\\star = \\frac{1}{e} \\left(1 - \\frac{1}{\\hat{R}_0}\\right)$. However, vaccination coverage must be in the interval $[0,1]$.\n-   If the calculated $v^\\star$ is less than or equal to $1$, then herd immunity is attainable with this coverage fraction.\n-   If the calculated $v^\\star$ is greater than $1$, it is impossible to achieve herd immunity, as even vaccinating the entire population ($v=1$) is insufficient. In this situation, the problem specifies to report $v^\\star=1$ and to mark herd immunity as unattainable. This condition $v^\\star > 1$ is equivalent to $\\frac{1}{e}(1 - 1/\\hat{R}_0) > 1 \\iff 1 - 1/\\hat{R}_0 > e \\iff \\hat{R}_0(1-e) > 1$. This means the reproduction number remains above $1$ even with $100\\%$ coverage.\n-   If vaccine efficacy $e=0$, the inequality becomes $0 > 1 - 1/\\hat{R}_0$. Since $\\hat{R}_0>1$, the right-hand side is positive, making the inequality false. No solution for $v$ exists, and herd immunity is unattainable. As per the problem rules, we report $v^\\star=1$.\n\nThis logic provides a complete algorithm for computing $\\hat{R}_0$, $v^\\star$, and the attainability of herd immunity for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases, calculating the MLE of R0,\n    the minimal vaccination coverage for herd immunity, and its attainability.\n    \"\"\"\n    \n    # Test suite defined in the problem statement\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"Y\": [0, 1, 2, 0, 1, 3, 2, 0, 1, 2],\n            \"p\": 0.5,\n            \"e\": 0.8\n        },\n        {\n            \"id\": \"B\",\n            \"Y\": [0, 0, 1, 0, 0, 1, 0, 0, 1, 0],\n            \"p\": 0.2,\n            \"e\": 0.9\n        },\n        {\n            \"id\": \"C\",\n            \"Y\": [0, 0, 0, 0, 0],\n            \"p\": 0.7,\n            \"e\": 0.7\n        },\n        {\n            \"id\": \"D\",\n            \"Y\": [4, 1, 3, 2, 5, 3, 4, 2, 1, 3, 2, 4],\n            \"p\": 0.6,\n            \"e\": 0.6\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Y = case[\"Y\"]\n        p = case[\"p\"]\n        e = case[\"e\"]\n        \n        # --- Part 1: Calculate the Maximum Likelihood Estimator R0_hat ---\n        \n        # The number of observations\n        n = len(Y)\n        \n        # The sample mean of the observed counts\n        # Using np.mean for robustness, though sum(Y)/n is equivalent\n        y_bar = np.mean(Y)\n        \n        # The MLE for R0 is derived as R0_hat = y_bar / p\n        r0_hat = y_bar / p\n        \n        # --- Part 2: Calculate minimal vaccination coverage v_star ---\n        \n        v_star = 0.0\n        is_attainable = False\n        \n        # Case 1: The process is already subcritical or critical\n        if r0_hat <= 1.0:\n            v_star = 0.0\n            is_attainable = True\n        \n        # Case 2: The process is supercritical\n        else: # r0_hat > 1.0\n            # Subcase 2a: Vaccine has zero efficacy. Herd immunity is unattainable.\n            # (R0_hat(1-v*0) = R0_hat > 1 for all v)\n            if e == 0:\n                v_star = 1.0\n                is_attainable = False\n            \n            # Subcase 2b: Vaccine has non-zero efficacy.\n            else: # e > 0\n                # Calculate the required coverage threshold\n                v_candidate = (1.0 / e) * (1.0 - (1.0 / r0_hat))\n                \n                # If the required coverage exceeds 100%, it's unattainable\n                if v_candidate > 1.0:\n                    v_star = 1.0\n                    is_attainable = False\n                \n                # Otherwise, it is attainable with the calculated coverage\n                else:\n                    v_star = v_candidate\n                    is_attainable = True\n                    \n        # Append the result triple for the current test case\n        results.append([r0_hat, v_star, is_attainable])\n    \n    # Format the final output string exactly as specified\n    # The str() of a list automatically includes brackets and commas.\n    # The str() of a boolean is capitalized, as in the example.\n    # The final f-string adds the outer brackets and comma separators.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```", "id": "4697692"}]}