{"hands_on_practices": [{"introduction": "A cornerstone of infectious disease epidemiology is quantifying the intrinsic transmissibility of a pathogen in a susceptible population, a concept captured by the basic reproduction number, $R_0$. For poliovirus, transmission is complex, involving both direct person-to-person contact and indirect environmental routes through fecal contamination. This first practice challenges you to build a mathematical model from first principles that incorporates both of these pathways to derive an expression for $R_0$ and the corresponding herd immunity threshold, providing a fundamental understanding of what it takes to stop the virus from spreading. [@problem_id:4681832]", "problem": "A densely populated urban settlement with inadequate sanitation is experiencing risk for poliovirus transmission. Consider a Susceptible–Infectious–Removed (SIR) model with an environmental contamination compartment. At the disease-free equilibrium, a single infectious person is introduced into a fully susceptible population at time $t=0$ with $S(0) \\approx N$. Transmission proceeds via two routes:\n\n- Direct oral–oral contact: an infectious individual makes $c$ potentially infectious contacts per day with randomly chosen persons, and each contact independently infects with probability $p_{d}$. Under homogeneous mixing with $S \\approx N$, the total rate of new infections generated by this index case via direct contact at time $t$ is $c\\,p_{d}$ while the individual remains infectious.\n- Environmental fecal–oral exposure: the environment has contamination level $E(t)$ that follows linear dynamics $dE/dt = \\sigma I(t) - \\delta E(t)$, where $I(t)$ is an indicator that the index case is infectious at time $t$, $\\sigma$ is the shedding rate into the environment, and $\\delta$ is the first-order decay rate of contamination. Under homogeneous mixing with $S \\approx N$, the total rate of new infections generated by this index case via the environmental route at time $t$ is $\\alpha\\,E(t)$, where $\\alpha$ is the per-unit contamination infection hazard to the population.\n\nAssume the infectious period duration is exponentially distributed with mean $T$, so the recovery rate is $\\gamma = 1/T$. Using only the definitions above and first principles (i.e., integrating the total new-infection hazards over the life history of a single typical infectious case and the linear impulse response of the environmental compartment), do the following:\n\n1. Define mathematically the basic reproduction number $R_{0}$ for this system as the expected number of secondary infections caused by a single typical infectious person introduced into a fully susceptible population, and derive $R_{0}$ in terms of $c$, $p_{d}$, $\\alpha$, $\\sigma$, $\\delta$, and $\\gamma$.\n2. From first principles under homogeneous mixing and sterilizing immunity, derive an expression for the herd immunity threshold $H$ in terms of $R_{0}$, and then evaluate $H$ numerically for the setting described below.\n\nUse the following parameter values, which are plausible for poliovirus in this setting: $c = 10$ contacts/day, $p_{d} = 0.012$, $\\alpha = 0.004$ per unit per day, $\\sigma = 5$ units/day, $\\delta = 0.5$ per day, and $T = 21$ days. Round your final numerical answer for $H$ to four significant figures and express it as a decimal (do not use a percent sign).", "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **Model:** Susceptible–Infectious–Removed (SIR) with an environmental contamination compartment ($E$).\n- **Initial State:** At time $t=0$, one infectious person is introduced into a fully susceptible population, $S(0) \\approx N$.\n- **Direct Transmission:**\n  - Contact rate: $c$\n  - Probability of infection per contact: $p_{d}$\n  - Rate of new direct infections from one case: $c p_{d}$\n- **Environmental Transmission:**\n  - Environmental dynamics: $\\frac{dE}{dt} = \\sigma I(t) - \\delta E(t)$, where $I(t)$ is an indicator that the index case is infectious.\n  - Shedding rate: $\\sigma$\n  - Contamination decay rate: $\\delta$\n  - Rate of new environmental infections from one case: $\\alpha E(t)$\n  - Per-unit contamination infection hazard: $\\alpha$\n- **Recovery:**\n  - The infectious period duration is exponentially distributed with a mean of $T$.\n  - The recovery rate is $\\gamma = 1/T$.\n- **Task 1:** Define the basic reproduction number $R_{0}$ and derive it in terms of $c$, $p_{d}$, $\\alpha$, $\\sigma$, $\\delta$, and $\\gamma$. $R_{0}$ is the expected number of secondary infections from a single typical case in a fully susceptible population.\n- **Task 2:** Derive the herd immunity threshold $H$ in terms of $R_{0}$ and evaluate it numerically.\n- **Parameter Values:**\n  - $c = 10 \\text{ days}^{-1}$\n  - $p_{d} = 0.012$\n  - $\\alpha = 0.004 \\text{ (unit} \\cdot \\text{day)}^{-1}$\n  - $\\sigma = 5 \\text{ units} \\cdot \\text{day}^{-1}$\n  - $\\delta = 0.5 \\text{ day}^{-1}$\n  - $T = 21 \\text{ days}$\n- **Numerical Precision:** Round the final value of $H$ to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing a standard epidemiological modeling framework (SIR with an environmental reservoir) appropriate for diseases with fecal-oral transmission like poliomyelitis. The concepts of the basic reproduction number ($R_0$) and the herd immunity threshold ($H$) are fundamental principles in infectious disease dynamics. All terms are clearly defined, and the parameters provided are specified as plausible and are dimensionally consistent. The problem is well-posed, objective, and self-contained, providing sufficient information for a unique solution. It does not violate any scientific principles, contain contradictions, or rely on subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Derivation of the Basic Reproduction Number, $R_0$\n\nThe basic reproduction number, $R_0$, is defined as the expected number of secondary infections produced by a single typical infectious individual in a completely susceptible population. It can be decomposed into two components corresponding to the two transmission routes:\n$$R_{0} = R_{0,d} + R_{0,e}$$\nwhere $R_{0,d}$ is the contribution from direct oral-oral contact and $R_{0,e}$ is the contribution from environmental fecal-oral exposure.\n\n**1. Direct Transmission Component ($R_{0,d}$):**\nAn infectious individual causes new infections through direct contact at a constant rate of $c p_{d}$, assuming the population is large and fully susceptible ($S/N \\approx 1$). The duration of the infectious period, let's call this random variable $\\tau$, is exponentially distributed with mean $T$. The recovery rate is $\\gamma = 1/T$, so the expected duration of the infectious period is $E[\\tau] = 1/\\gamma$.\n\nThe total number of secondary infections via the direct route for an individual who is infectious for a duration $\\tau$ is the rate multiplied by the duration, i.e., $c p_{d} \\tau$. To find the expected number of secondary infections for a typical case, we take the expectation over the random duration $\\tau$:\n$$R_{0,d} = E[c p_{d} \\tau] = c p_{d} E[\\tau]$$\nSubstituting $E[\\tau] = 1/\\gamma$, we get:\n$$R_{0,d} = \\frac{c p_{d}}{\\gamma}$$\n\n**2. Environmental Transmission Component ($R_{0,e}$):**\nThe rate of new infections from the environment is given by $\\alpha E(t)$. The total number of infections caused via the environment over the entire course of one individual's infection is the integral of this rate over all time:\n$$N_e = \\int_0^\\infty \\alpha E(t) dt$$\nTo find $R_{0,e}$, we need to find the expected value of $N_e$ over the distribution of infectious periods. First, let's find the total pathogen load contributed to the environment, $\\int_0^\\infty E(t) dt$. The dynamics of the environmental contamination $E(t)$ are given by the linear ordinary differential equation:\n$$\\frac{dE}{dt} = \\sigma I(t) - \\delta E(t)$$\nwhere $I(t)$ is an indicator function which is $1$ while the index case is infectious and $0$ otherwise. For an individual infectious for a duration $\\tau$ starting at $t=0$, we have $I(t)=1$ for $0 \\le t \\le \\tau$ and $I(t)=0$ for $t > \\tau$. We assume $E(0)=0$.\n\nWe can integrate the differential equation from $t=0$ to $t=\\infty$:\n$$\\int_0^\\infty \\frac{dE}{dt} dt = \\int_0^\\infty (\\sigma I(t) - \\delta E(t)) dt$$\n$$[E(t)]_0^\\infty = \\sigma \\int_0^\\infty I(t) dt - \\delta \\int_0^\\infty E(t) dt$$\nSince the contamination starts at zero ($E(0)=0$) and must eventually decay to zero after the source is removed ($E(\\infty)=0$), the left-hand side is $0$. The integral of the indicator function $I(t)$ is simply the duration $\\tau$.\n$$0 = \\sigma \\tau - \\delta \\int_0^\\infty E(t) dt$$\nSolving for the integrated contamination gives:\n$$\\int_0^\\infty E(t) dt = \\frac{\\sigma \\tau}{\\delta}$$\nThe total number of infections for this specific duration $\\tau$ is:\n$$N_e(\\tau) = \\alpha \\int_0^\\infty E(t) dt = \\frac{\\alpha \\sigma \\tau}{\\delta}$$\nTo find the expected number of secondary infections for a typical case, we take the expectation of $N_e(\\tau)$ over the random duration $\\tau$:\n$$R_{0,e} = E[N_e(\\tau)] = E\\left[\\frac{\\alpha \\sigma \\tau}{\\delta}\\right] = \\frac{\\alpha \\sigma}{\\delta} E[\\tau]$$\nSubstituting $E[\\tau] = 1/\\gamma$:\n$$R_{0,e} = \\frac{\\alpha \\sigma}{\\delta \\gamma}$$\n\n**3. Total Basic Reproduction Number ($R_0$):**\nSumming the two components gives the total expression for $R_0$:\n$$R_{0} = R_{0,d} + R_{0,e} = \\frac{c p_{d}}{\\gamma} + \\frac{\\alpha \\sigma}{\\delta \\gamma}$$\nThis can be factored as:\n$$R_{0} = \\frac{1}{\\gamma} \\left( c p_{d} + \\frac{\\alpha \\sigma}{\\delta} \\right)$$\n\n### Derivation and Calculation of the Herd Immunity Threshold, $H$\n\nThe herd immunity threshold ($H$) is the minimum proportion of a population that must be immune to an infection to prevent its spread. An epidemic cannot grow if the effective reproduction number, $R_{eff}$, is less than $1$. $R_{eff}$ is the number of secondary infections when a proportion of the population is already immune.\n\nFor a homogeneously mixing population, if a fraction $p$ of the population is immune (and thus not susceptible), the proportion of susceptible individuals is $1-p$. An infectious person's contacts will only lead to a new infection if the contact is with a susceptible person. Therefore, the effective reproduction number is reduced by the fraction of susceptibles in the population:\n$$R_{eff} = R_0 \\times (\\text{fraction susceptible}) = R_0 \\frac{S}{N}$$\nThe herd immunity threshold $H$ is the specific proportion of immune individuals at which $R_{eff}$ equals $1$. At this threshold, the proportion of susceptibles is $1-H$.\n$$1 = R_0 (1-H)$$\nSolving for $H$ gives the expression for the herd immunity threshold:\n$$1-H = \\frac{1}{R_0} \\implies H = 1 - \\frac{1}{R_0}$$\n\nNow, we will evaluate $H$ numerically using the provided parameter values.\nFirst, we determine the recovery rate $\\gamma$:\n$$T = 21 \\text{ days} \\implies \\gamma = \\frac{1}{T} = \\frac{1}{21} \\text{ days}^{-1}$$\nNext, we calculate $R_0$ using the derived formula and the given parameters:\n$c = 10$, $p_{d} = 0.012$, $\\alpha = 0.004$, $\\sigma = 5$, $\\delta = 0.5$.\n$$R_0 = \\frac{1}{1/21} \\left( (10)(0.012) + \\frac{(0.004)(5)}{0.5} \\right)$$\n$$R_0 = 21 \\left( 0.12 + \\frac{0.02}{0.5} \\right)$$\n$$R_0 = 21 (0.12 + 0.04)$$\n$$R_0 = 21 (0.16)$$\n$$R_0 = 3.36$$\nNow we can calculate the herd immunity threshold $H$:\n$$H = 1 - \\frac{1}{R_0} = 1 - \\frac{1}{3.36}$$\n$$H = 1 - 0.29761904...$$\n$$H = 0.70238095...$$\nRounding the result to four significant figures, as requested:\n$$H \\approx 0.7024$$", "answer": "$$\\boxed{0.7024}$$", "id": "4681832"}, {"introduction": "Moving from theoretical transmission dynamics to practical surveillance, a critical task in the polio endgame is tracking the silent circulation of vaccine-derived polioviruses (VDPVs). Genetic sequencing offers a powerful tool for this, allowing us to estimate how long a virus has been circulating based on the number of mutations it has accumulated relative to its vaccine ancestor. This exercise delves into the theory of the molecular clock, requiring you to derive the relationship between observed genetic divergence and time, and then apply it to estimate the circulation duration of a poliovirus isolate. [@problem_id:4681799]", "problem": "A core tool in poliovirus surveillance is molecular clock dating based on substitutions accumulating in the viral protein $1$ (VP$1$) coding region. Consider a poliovirus lineage derived from the oral poliovirus vaccine (OPV), where the vaccine strain sequence is the known ancestor at time $t=0$. Assume the following fundamental base: nucleotide substitutions accrue along the lineage as a time-homogeneous continuous-time Markov chain with a constant per-site substitution rate $\\mu$ (substitutions per site per year) and equal equilibrium base frequencies, i.e., the Jukes–Cantor model. Under this model, the accumulation of changes across sites is a Poisson process, and the observable proportion of differences from the ancestor is a function of the expected substitutions per site $B=\\mu t$.\n\nA surveillance laboratory sequences an isolate’s VP$1$ region of length $L=906$ nucleotides and observes $n=28$ nucleotide differences relative to the cognate Sabin vaccine strain. The molecular clock for poliovirus VP$1$ has been calibrated from longitudinal datasets to be approximately $\\mu = 1.00 \\times 10^{-2}$ substitutions per site per year.\n\nStarting from the continuous-time Markov chain description of nucleotide substitution with equal instantaneous rates among nucleotides, derive the relationship linking the observed Hamming distance proportion $\\hat{p}=n/L$ to the expected substitutions per site $B=\\mu t$ under a finite-sites correction, and then obtain the maximum likelihood estimate for the circulation time $t$. Compute the resulting $t$ using the data above and the given $\\mu$. Round your answer to four significant figures. Express the final result in years.", "solution": "The problem requires the derivation of the Jukes-Cantor (JC69) correction for genetic distance and its application to estimate the circulation time of a poliovirus lineage.\n\n### Step 1: Derivation of the Jukes-Cantor Correction Formula\n\nThe Jukes-Cantor model of nucleotide substitution is a continuous-time Markov chain on the state space of four nucleotides, $\\{A, C, G, T\\}$. It assumes that the rate of substitution from any nucleotide to any other nucleotide is a constant, denoted by $\\alpha$. The rate matrix $Q$ for this process is a $4 \\times 4$ matrix where the off-diagonal elements $Q_{ij}$ (for $i \\neq j$) are equal to $\\alpha$, and the diagonal elements $Q_{ii}$ are chosen such that each row sums to zero, i.e., $Q_{ii} = -3\\alpha$.\n\n$$\nQ = \\begin{pmatrix}\n-3\\alpha & \\alpha & \\alpha & \\alpha \\\\\n\\alpha & -3\\alpha & \\alpha & \\alpha \\\\\n\\alpha & \\alpha & -3\\alpha & \\alpha \\\\\n\\alpha & \\alpha & \\alpha & -3\\alpha\n\\end{pmatrix} = \\alpha (J - 4I)\n$$\n\nwhere $J$ is the $4 \\times 4$ matrix of all ones and $I$ is the $4 \\times 4$ identity matrix.\n\nThe problem states a per-site substitution rate of $\\mu$. This rate is the average rate of substitution, weighted by the stationary distribution of nucleotides. For the JC69 model, the stationary distribution is uniform, $\\pi_i = \\frac{1}{4}$ for each nucleotide $i$. The rate of leaving state $i$ is $\\sum_{j \\neq i} Q_{ij} = 3\\alpha$. The total rate of substitution per site is therefore:\n$$\n\\mu = \\sum_{i} \\pi_i \\left( \\sum_{j \\neq i} Q_{ij} \\right) = \\sum_{i} \\frac{1}{4} (3\\alpha) = 4 \\left( \\frac{1}{4} \\cdot 3\\alpha \\right) = 3\\alpha\n$$\nThis gives the relationship $\\alpha = \\frac{\\mu}{3}$. The rate matrix can be expressed in terms of $\\mu$ as:\n$$\nQ = \\frac{\\mu}{3} (J - 4I)\n$$\n\nThe matrix of transition probabilities over a time interval $t$, $P(t)$, is given by the matrix exponential $P(t) = \\exp(Qt)$.\n$$\nP(t) = \\exp\\left( \\frac{\\mu t}{3} (J - 4I) \\right) = \\exp\\left( -\\frac{4\\mu t}{3} I \\right) \\exp\\left( \\frac{\\mu t}{3} J \\right)\n$$\nThe first term is a scalar matrix $\\exp\\left(-\\frac{4\\mu t}{3}\\right)I$. For the second term, we use the property $J^k = 4^{k-1}J$ for $k \\ge 1$ and the Taylor series of the exponential function:\n$$\n\\exp(cJ) = I + \\sum_{k=1}^{\\infty} \\frac{(cJ)^k}{k!} = I + \\sum_{k=1}^{\\infty} \\frac{c^k 4^{k-1}}{k!} J = I + \\frac{J}{4} \\sum_{k=1}^{\\infty} \\frac{(4c)^k}{k!} = I + \\frac{J}{4} (\\exp(4c) - 1)\n$$\nSetting $c = \\frac{\\mu t}{3}$, we have $4c = \\frac{4\\mu t}{3}$.\n$$\n\\exp\\left(\\frac{\\mu t}{3}J\\right) = I + \\frac{J}{4}\\left(\\exp\\left(\\frac{4\\mu t}{3}\\right) - 1\\right)\n$$\nCombining the terms for $P(t)$:\n$$\nP(t) = \\exp\\left(-\\frac{4\\mu t}{3}\\right) \\left[ I + \\frac{J}{4}\\left(\\exp\\left(\\frac{4\\mu t}{3}\\right) - 1\\right) \\right] = \\exp\\left(-\\frac{4\\mu t}{3}\\right)I + \\frac{J}{4}\\left(1 - \\exp\\left(-\\frac{4\\mu t}{3}\\right)\\right)\n$$\nThe diagonal elements of $P(t)$, $P_{ii}(t)$, represent the probability that a nucleotide has not changed after time $t$.\n$$\nP_{ii}(t) = \\exp\\left(-\\frac{4\\mu t}{3}\\right) + \\frac{1}{4}\\left(1 - \\exp\\left(-\\frac{4\\mu t}{3}\\right)\\right) = \\frac{1}{4} + \\frac{3}{4}\\exp\\left(-\\frac{4\\mu t}{3}\\right)\n$$\nThe off-diagonal elements, $P_{ij}(t)$ for $i \\neq j$, represent the probability that a nucleotide has changed to a specific different nucleotide.\n$$\nP_{ij}(t) = \\frac{1}{4}\\left(1 - \\exp\\left(-\\frac{4\\mu t}{3}\\right)\\right)\n$$\nThe expected proportion of sites that show a difference after time $t$, let's call it $p(t)$, is the probability that a site is occupied by any nucleotide different from the ancestral one. This is $1 - P_{ii}(t)$.\n$$\np(t) = 1 - P_{ii}(t) = 1 - \\left( \\frac{1}{4} + \\frac{3}{4}\\exp\\left(-\\frac{4\\mu t}{3}\\right) \\right) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4\\mu t}{3}\\right)\\right)\n$$\nThe problem defines the expected number of substitutions per site as $B = \\mu t$. Substituting this into the equation gives the relationship between the expected proportion of differences and the genetic distance $B$.\n$$\np(B) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4B}{3}\\right)\\right)\n$$\nThis is the fundamental relationship required.\n\n### Step 2: Maximum Likelihood Estimation of Circulation Time $t$\n\nThe observation consists of $n$ differences in a sequence of length $L$. The number of differences $n$ can be modeled as a draw from a binomial distribution, $n \\sim \\text{Binom}(L, p)$, where $p$ is the true probability of a site being different. The likelihood function is $L(p | n, L) = \\binom{L}{n} p^n (1-p)^{L-n}$.\n\nThe maximum likelihood estimate (MLE) of the proportion $p$ is the observed sample proportion, $\\hat{p}$:\n$$\n\\hat{p} = \\frac{n}{L}\n$$\nTo find the MLE for the time $t$, we first invert the derived relationship to express $t$ as a function of $p$.\n$$\np = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4\\mu t}{3}\\right)\\right)\n$$\n$$\n\\frac{4p}{3} = 1 - \\exp\\left(-\\frac{4\\mu t}{3}\\right)\n$$\n$$\n\\exp\\left(-\\frac{4\\mu t}{3}\\right) = 1 - \\frac{4p}{3}\n$$\n$$\n-\\frac{4\\mu t}{3} = \\ln\\left(1 - \\frac{4p}{3}\\right)\n$$\n$$\nt(p) = -\\frac{3}{4\\mu}\\ln\\left(1 - \\frac{4p}{3}\\right)\n$$\nBy the invariance property of maximum likelihood estimators, the MLE for $t$, denoted $\\hat{t}$, is found by substituting $\\hat{p}$ into the expression for $t(p)$.\n$$\n\\hat{t} = -\\frac{3}{4\\mu}\\ln\\left(1 - \\frac{4\\hat{p}}{3}\\right) = -\\frac{3}{4\\mu}\\ln\\left(1 - \\frac{4n}{3L}\\right)\n$$\nThis formula provides the maximum likelihood estimate for the circulation time $t$.\n\n### Step 3: Calculation of Circulation Time\n\nWe are given the following data:\n- Number of nucleotide differences, $n = 28$.\n- Length of the VP1 coding region, $L = 906$ nucleotides.\n- Substitution rate, $\\mu = 1.00 \\times 10^{-2}$ substitutions per site per year.\n\nFirst, we compute the observed proportion of differences, $\\hat{p}$:\n$$\n\\hat{p} = \\frac{n}{L} = \\frac{28}{906}\n$$\nNow, substitute the values into the MLE formula for $\\hat{t}$:\n$$\n\\hat{t} = -\\frac{3}{4(1.00 \\times 10^{-2})} \\ln\\left(1 - \\frac{4}{3} \\cdot \\frac{28}{906}\\right)\n$$\n$$\n\\hat{t} = -\\frac{3}{0.04} \\ln\\left(1 - \\frac{112}{2718}\\right)\n$$\n$$\n\\hat{t} = -75 \\ln\\left(\\frac{2718-112}{2718}\\right) = -75 \\ln\\left(\\frac{2606}{2718}\\right)\n$$\nNow we compute the numerical value:\n$$\n\\hat{t} = -75 \\ln(0.9587932303\\dots)\n$$\n$$\n\\hat{t} = -75 (-0.042079603\\dots)\n$$\n$$\n\\hat{t} = 3.1559702\\dots\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\hat{t} \\approx 3.156 \\text{ years}\n$$\nThe estimated time of circulation for the virus lineage since its divergence from the vaccine strain is $3.156$ years.", "answer": "$$\\boxed{3.156}$$", "id": "4681799"}, {"introduction": "Effective public health action relies on synthesizing information from all available sources. In polio surveillance, decision-makers must weigh evidence from both clinical surveillance for Acute Flaccid Paralysis (AFP) and environmental surveillance of wastewater, both of which are imperfect. This final practice guides you through the construction of a Bayesian statistical framework to formally integrate these two data streams, allowing you to calculate the updated, or posterior, probability of viral circulation after observing the data, a critical skill for assessing eradication progress. [@problem_id:4681774]", "problem": "You are to implement a Bayesian decision-theoretic program that integrates Acute Flaccid Paralysis (AFP) surveillance and environmental surveillance to estimate the posterior probability of ongoing poliovirus circulation in a defined catchment during a fixed observation window. The latent state of interest is $C \\in \\{0,1\\}$, where $C=1$ indicates ongoing circulation within the window and $C=0$ indicates no ongoing circulation.\n\nFundamental base: Use Bayes' theorem and standard distributional models. Assume conditional independence of surveillance streams given the latent state. Let the AFP observations be modeled by a Poisson distribution and the environmental detection counts by a Binomial distribution, each with state-dependent parameters.\n\nDefinitions and modeling assumptions to be used as the base:\n- Let the prior probability of circulation be $P(C=1)=\\pi$, with $P(C=0)=1-\\pi$.\n- Let the number of detected AFP poliomyelitis cases in the window be $n_{\\mathrm{AFP}}$. Under $C=1$, model $n_{\\mathrm{AFP}}$ as a Poisson random variable with mean $\\lambda_1$ representing the expected number of detected AFP cases when circulation is ongoing. Under $C=0$, model $n_{\\mathrm{AFP}}$ as a Poisson random variable with mean $\\lambda_0$ representing false-positive or background detections when circulation is absent.\n- Let the number of environmental samples collected be $S$, of which $y_{\\mathrm{env}}$ test positive. Under $C=1$, model $y_{\\mathrm{env}}$ as a Binomial random variable with parameters $S$ and $p_1$, where $p_1$ is the per-sample probability of detection when circulation is ongoing. Under $C=0$, model $y_{\\mathrm{env}}$ as a Binomial random variable with parameters $S$ and $p_0$, where $p_0$ is the per-sample false-positive probability when circulation is absent.\n- Assume conditional independence of AFP and environmental observations given $C$.\n\nYour task:\n- For each test case, compute the posterior probability $P(C=1 \\mid \\text{data})$ using only the principles above. You must construct the likelihood under $C=1$ and under $C=0$ using the Poisson and Binomial probability mass functions and combine them with the prior via Bayes' theorem. Implement the computation in log space to ensure numerical stability, and handle edge cases such as $S=0$, $p \\in \\{0,1\\}$, and $\\pi \\in \\{0,1\\}$ in a mathematically consistent way.\n\nInput specification:\n- There is no external input. Your program must internally encode the following test suite of parameter sets. Each test case is an ordered tuple $(\\pi, \\lambda_1, \\lambda_0, S, p_1, p_0, n_{\\mathrm{AFP}}, y_{\\mathrm{env}})$ as defined above.\n\nTest suite covering typical, boundary, and edge cases:\n- Case $1$: $(0.5, 0.8, 0.01, 12, 0.3, 0.001, 0, 0)$\n- Case $2$: $(0.2, 1.2, 0.02, 8, 0.25, 0.001, 1, 0)$\n- Case $3$: $(0.1, 0.5, 0.005, 20, 0.4, 0.002, 0, 3)$\n- Case $4$: $(0.7, 2.0, 0.01, 50, 0.5, 0.001, 0, 0)$\n- Case $5$: $(0.4, 0.7, 0.02, 0, 0.0, 0.0, 0, 0)$\n- Case $6$: $(0.001, 0.3, 0.01, 10, 0.2, 0.001, 0, 1)$\n- Case $7$: $(0.99, 1.5, 0.01, 12, 0.3, 0.001, 2, 5)$\n\nOutput specification:\n- For each test case, compute the posterior probability of ongoing circulation $P(C=1 \\mid \\text{data})$ as a floating-point number. Round each posterior to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., [r1,r2,r3,r4,r5,r6,r7]), where $r_i$ is the rounded posterior for case $i$ in the order given above.\n\nScientific realism and units:\n- All parameters are dimensionless probabilities or expected counts over a fixed window; no physical units are required.\n- Angle units are not applicable.\n\nYour implementation must adhere strictly to the statistical modeling assumptions stated and the output format specified. The final outputs must be numeric floats rounded to $6$ decimal places, aggregated exactly as described.", "solution": "The problem requires the implementation of a Bayesian model to compute the posterior probability of poliovirus circulation, denoted by the latent state $C=1$, given surveillance data from two independent streams: Acute Flaccid Paralysis (AFP) case counts and environmental sample testing. The state $C=0$ represents the absence of circulation. The data consists of the number of observed AFP cases, $n_{\\mathrm{AFP}}$, and the number of positive environmental samples, $y_{\\mathrm{env}}$, from a total of $S$ samples.\n\nThe solution is derived from first principles using Bayes' theorem. The posterior probability of circulation is given by:\n$$\nP(C=1 \\mid n_{\\mathrm{AFP}}, y_{\\mathrm{env}}) = \\frac{P(n_{\\mathrm{AFP}}, y_{\\mathrm{env}} \\mid C=1) P(C=1)}{P(n_{\\mathrm{AFP}}, y_{\\mathrm{env}})}\n$$\nThe denominator is the marginal likelihood or evidence, obtained by the law of total probability:\n$$\nP(n_{\\mathrm{AFP}}, y_{\\mathrm{env}}) = P(n_{\\mathrm{AFP}}, y_{\\mathrm{env}} \\mid C=1) P(C=1) + P(n_{\\mathrm{AFP}}, y_{\\mathrm{env}} \\mid C=0) P(C=0)\n$$\nLet the prior probability of circulation be $P(C=1) = \\pi$, which implies $P(C=0) = 1-\\pi$. Let the likelihood of the data given a state $C=c$ be denoted $L_c = P(n_{\\mathrm{AFP}}, y_{\\mathrm{env}} \\mid C=c)$. The posterior can then be written as:\n$$\nP(C=1 \\mid \\text{data}) = \\frac{L_1 \\pi}{L_1 \\pi + L_0 (1-\\pi)}\n$$\nThe problem states that the two surveillance streams are conditionally independent given the circulation state $C$. Thus, the joint likelihood $L_c$ is the product of the individual likelihoods:\n$$\nL_c = P(n_{\\mathrm{AFP}} \\mid C=c) \\times P(y_{\\mathrm{env}} \\mid C=c)\n$$\nThe models for these likelihoods are specified:\n1.  **AFP Surveillance:** The number of cases $n_{\\mathrm{AFP}}$ follows a Poisson distribution.\n    -   If $C=1$, $n_{\\mathrm{AFP}} \\sim \\text{Poisson}(\\lambda_1)$, so $P(n_{\\mathrm{AFP}} \\mid C=1) = \\frac{e^{-\\lambda_1} \\lambda_1^{n_{\\mathrm{AFP}}}}{n_{\\mathrm{AFP}}!}$.\n    -   If $C=0$, $n_{\\mathrm{AFP}} \\sim \\text{Poisson}(\\lambda_0)$, so $P(n_{\\mathrm{AFP}} \\mid C=0) = \\frac{e^{-\\lambda_0} \\lambda_0^{n_{\\mathrm{AFP}}}}{n_{\\mathrm{AFP}}!}$.\n\n2.  **Environmental Surveillance:** The number of positive samples $y_{\\mathrm{env}}$ follows a Binomial distribution.\n    -   If $C=1$, $y_{\\mathrm{env}} \\sim \\text{Binomial}(S, p_1)$, so $P(y_{\\mathrm{env}} \\mid C=1) = \\binom{S}{y_{\\mathrm{env}}} p_1^{y_{\\mathrm{env}}} (1-p_1)^{S - y_{\\mathrm{env}}}$.\n    -   If $C=0$, $y_{\\mathrm{env}} \\sim \\text{Binomial}(S, p_0)$, so $P(y_{\\mathrm{env}} \\mid C=0) = \\binom{S}{y_{\\mathrm{env}}} p_0^{y_{\\mathrm{env}}} (1-p_0)^{S - y_{\\mathrm{env}}}$.\n\nDirect computation of these probabilities can lead to numerical underflow. A robust approach is to work in log-space. It is convenient to express the posterior probability in terms of the posterior odds. The posterior odds of circulation ($C=1$) versus no circulation ($C=0$) are:\n$$\n\\frac{P(C=1 \\mid \\text{data})}{P(C=0 \\mid \\text{data})} = \\frac{L_1}{L_0} \\times \\frac{\\pi}{1-\\pi}\n$$\nThis is the product of the Bayes factor ($L_1/L_0$) and the prior odds ($\\pi/(1-\\pi)$). The posterior probability $P(C=1 \\mid \\text{data})$ can be recovered from the posterior odds of $C=0$ versus $C=1$:\n$$\nP(C=1 \\mid \\text{data}) = \\frac{1}{1 + \\frac{P(C=0 \\mid \\text{data})}{P(C=1 \\mid \\text{data})}} = \\frac{1}{1 + \\frac{L_0(1-\\pi)}{L_1\\pi}}\n$$\nLet's define the log posterior odds of $C=0$ vs $C=1$ as $\\theta$:\n$$\n\\theta = \\log\\left(\\frac{L_0(1-\\pi)}{L_1\\pi}\\right) = \\log\\left(\\frac{L_0}{L_1}\\right) + \\log\\left(\\frac{1-\\pi}{\\pi}\\right)\n$$\nThen, $P(C=1 \\mid \\text{data}) = \\frac{1}{1 + e^{\\theta}}$. This formulation is numerically stable.\n\nThe term $\\log(L_0/L_1)$ is the log-Bayes factor. It is the difference of the log-likelihoods:\n$$\n\\log\\left(\\frac{L_0}{L_1}\\right) = \\log(L_0) - \\log(L_1)\n$$\nThe log-likelihood $\\log(L_c)$ is:\n$$\n\\log(L_c) = \\left(-\\lambda_c + n_{\\mathrm{AFP}}\\log(\\lambda_c) - \\log(n_{\\mathrm{AFP}}!)\\right) + \\left(\\log\\binom{S}{y_{\\mathrm{env}}} + y_{\\mathrm{env}}\\log(p_c) + (S-y_{\\mathrm{env}})\\log(1-p_c)\\right)\n$$\nWhen taking the difference $\\log(L_0) - \\log(L_1)$, the terms $\\log(n_{\\mathrm{AFP}}!)$ and $\\log\\binom{S}{y_{\\mathrm{env}}}$ cancel out, simplifying the expression for the log-Bayes factor:\n$$\n\\log\\left(\\frac{L_0}{L_1}\\right) = (\\lambda_1 - \\lambda_0) + n_{\\mathrm{AFP}}(\\log\\lambda_0 - \\log\\lambda_1) + y_{\\mathrm{env}}(\\log p_0 - \\log p_1) + (S-y_{\\mathrm{env}})(\\log(1-p_0) - \\log(1-p_1))\n$$\nTo handle edge cases where parameters or counts are zero (e.g., $n_{\\mathrm{AFP}}=0$, $p_0=0$), terms of the form $x\\log(y)$ must be evaluated carefully. The convention $0\\log(0) = 0$ is used, which is correctly handled by the `scipy.special.xlogy(x, y)` function.\n\nThe full expression for $\\theta$ is:\n$$\n\\theta = \\left((\\lambda_1 - \\lambda_0) + (x\\log y(n_{\\mathrm{AFP}}, \\lambda_0) - x\\log y(n_{\\mathrm{AFP}}, \\lambda_1))\\right) + \\left((x\\log y(y_{\\mathrm{env}}, p_0) - x\\log y(y_{\\mathrm{env}}, p_1)) + (x\\log y(S-y_{\\mathrm{env}}, 1-p_0) - x\\log y(S-y_{\\mathrm{env}}, 1-p_1))\\right) + (\\log(1-\\pi) - \\log(\\pi))\n$$\nEdge cases for the prior $\\pi$ are handled separately: if $\\pi=0$, the posterior $P(C=1|\\text{data})$ must be $0$; if $\\pi=1$, it must be $1$. The implementation encapsulates this logic for each test case, computes $\\theta$, and derives the final posterior probability.", "answer": "[0.006318,0.317480,0.999974,0.000000,0.252474,0.165439,1.000000]", "id": "4681774"}]}