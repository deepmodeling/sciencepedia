{"hands_on_practices": [{"introduction": "In the early stages of a suspected plague outbreak, rapid and accurate case identification is paramount for containment. This exercise demonstrates how to establish a scientifically grounded cutoff for a quantitative diagnostic test, such as a qPCR assay, by balancing the severe consequences of missing a true case against the costs of unnecessarily treating and isolating a false positive. You will apply Bayesian decision theory to derive an optimal cycle threshold ($Ct$) value that minimizes expected loss, a core skill in public health surveillance and emergency response [@problem_id:4707298].", "problem": "A field team responding to a suspected pneumonic plague cluster must operationalize a case definition for isolation and empiric treatment based on a rapid laboratory measure. Each symptomatic patient undergoes quantitative Polymerase Chain Reaction (qPCR) targeting the plasminogen activator gene of Yersinia pestis (Y. pestis), and the laboratory returns a cycle threshold (Ct). Lower $Ct$ indicates higher target load. Epidemiologic screening suggests a prior probability of true Yersinia pestis infection among screened symptomatic patients of $p=0.12$. To quantify decision consequences, the team models the expected loss for falsely negative classification (missed true case) as $C_{\\mathrm{FN}}=50$ (arbitrary loss units encompassing mortality risk, onward transmission, and reputational impact) and the expected loss for falsely positive classification (unnecessary isolation and treatment) as $C_{\\mathrm{FP}}=1$.\n\nEmpirical validation shows that, conditional on true infection, $Ct$ is approximately normally distributed as $X \\mid \\text{infected} \\sim \\mathcal{N}(\\mu_{1},\\sigma^{2})$ with $\\mu_{1}=21$ and $\\sigma=2.5$, and, conditional on not infected, $X \\mid \\text{not infected} \\sim \\mathcal{N}(\\mu_{0},\\sigma^{2})$ with $\\mu_{0}=34$ and the same $\\sigma=2.5$. Assume these distributions are scientifically calibrated and stable in the current operational context.\n\nStarting only from the definitions of expected loss minimization in binary classification, Bayes’ theorem, and the normal probability density function, derive the Bayes-optimal decision rule and solve analytically for the unique $Ct$ threshold $x^{\\ast}$ (in cycles) at which the action “classify as a plague case” switches to “do not classify as a plague case.” Provide the final numeric value of $x^{\\ast}$ in cycles. Round your answer to four significant figures and express the threshold in cycles.", "solution": "We frame the decision as a binary classification problem with two actions: classify as “case” (positive) versus “not case” (negative). Let $H_{1}$ denote “infected” and $H_{0}$ denote “not infected.” Given an observed $Ct$ value $x$, the expected loss for each action is derived from the foundational definitions:\n- The expected loss for choosing “case” is $L(+ \\mid x)=C_{\\mathrm{FP}}\\,P(H_{0}\\mid x)$.\n- The expected loss for choosing “not case” is $L(- \\mid x)=C_{\\mathrm{FN}}\\,P(H_{1}\\mid x)$.\n\nThe Bayes-optimal action is the one with smaller expected loss for the observed $x$. Therefore, choose “case” when\n$$\nL(+ \\mid x) < L(- \\mid x)\n\\quad\\Longleftrightarrow\\quad\nC_{\\mathrm{FP}}\\,P(H_{0}\\mid x) < C_{\\mathrm{FN}}\\,P(H_{1}\\mid x).\n$$\nEquivalently,\n$$\n\\frac{P(H_{1}\\mid x)}{P(H_{0}\\mid x)} > \\frac{C_{\\mathrm{FP}}}{C_{\\mathrm{FN}}}.\n$$\nBy Bayes’ theorem and the definition of the likelihood ratio,\n$$\n\\frac{P(H_{1}\\mid x)}{P(H_{0}\\mid x)} \\;=\\; \\frac{f_{1}(x)\\,p}{f_{0}(x)\\,(1-p)} \\;=\\; \\Lambda(x)\\,\\frac{p}{1-p},\n$$\nwhere $f_{1}(x)$ and $f_{0}(x)$ are the class-conditional probability density functions of $X$ under $H_{1}$ and $H_{0}$, respectively, and $\\Lambda(x)=\\frac{f_{1}(x)}{f_{0}(x)}$ is the likelihood ratio. The decision condition becomes\n$$\n\\Lambda(x) > \\eta,\n\\quad\\text{with}\\quad\n\\eta \\equiv \\frac{C_{\\mathrm{FP}}(1-p)}{C_{\\mathrm{FN}}\\,p}.\n$$\nThe Bayes-optimal rule is therefore: classify as “case” if $\\Lambda(x)>\\eta$ and as “not case” otherwise. The threshold $x^{\\ast}$ is the $Ct$ value solving $\\Lambda(x^{\\ast})=\\eta$.\n\nWith $X\\mid H_{i}\\sim \\mathcal{N}(\\mu_{i},\\sigma^{2})$ for $i\\in\\{0,1\\}$ and equal $\\sigma$, the normal densities are\n$$\nf_{i}(x) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{(x-\\mu_{i})^{2}}{2\\sigma^{2}}\\right).\n$$\nThus the likelihood ratio simplifies to\n$$\n\\Lambda(x)\n\\;=\\;\n\\frac{f_{1}(x)}{f_{0}(x)}\n\\;=\\;\n\\exp\\!\\left(-\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}\\right),\n$$\nbecause the prefactors $\\frac{1}{\\sigma\\sqrt{2\\pi}}$ cancel. Taking the natural logarithm on both sides of $\\Lambda(x^{\\ast})=\\eta$,\n$$\n\\ln \\Lambda(x^{\\ast}) = \\ln \\eta,\n$$\nand substituting the explicit form,\n$$\n-\\frac{(x^{\\ast}-\\mu_{1})^{2}-(x^{\\ast}-\\mu_{0})^{2}}{2\\sigma^{2}} = \\ln \\eta.\n$$\nExpand and simplify the quadratic difference:\n$$\n(x^{\\ast}-\\mu_{1})^{2}-(x^{\\ast}-\\mu_{0})^{2}\n=\n2x^{\\ast}(\\mu_{0}-\\mu_{1}) + (\\mu_{1}^{2}-\\mu_{0}^{2}).\n$$\nHence,\n$$\n-\\frac{2x^{\\ast}(\\mu_{0}-\\mu_{1}) + (\\mu_{1}^{2}-\\mu_{0}^{2})}{2\\sigma^{2}} = \\ln \\eta,\n$$\nwhich is linear in $x^{\\ast}$. Solving for $x^{\\ast}$ gives\n$$\nx^{\\ast}\n=\n\\frac{\\mu_{0}+\\mu_{1}}{2}\n\\;-\\;\n\\frac{\\sigma^{2}}{\\mu_{0}-\\mu_{1}}\\;\\ln \\eta.\n$$\nBecause $\\mu_{1}<\\mu_{0}$ and $\\sigma^{2}>0$, the likelihood ratio $\\Lambda(x)$ is strictly decreasing in $x$, so the decision rule is “case” for $x<x^{\\ast}$ and “not case” for $x\\ge x^{\\ast}$.\n\nNow substitute the given parameters $p=0.12$, $C_{\\mathrm{FN}}=50$, $C_{\\mathrm{FP}}=1$, $\\mu_{1}=21$, $\\mu_{0}=34$, and $\\sigma=2.5$:\nFirst compute the threshold on the likelihood ratio,\n$$\n\\eta\n=\n\\frac{C_{\\mathrm{FP}}(1-p)}{C_{\\mathrm{FN}}\\,p}\n=\n\\frac{1\\cdot(1-0.12)}{50\\cdot 0.12}\n=\n\\frac{0.88}{6}\n\\approx\n0.146667,\n$$\nand its natural logarithm,\n$$\n\\ln(\\eta) \\approx \\ln(0.146667) \\approx -1.9196.\n$$\nNext compute the geometric and variance terms,\n$$\n\\frac{\\mu_{0}+\\mu_{1}}{2}\n=\n\\frac{34+21}{2}\n=\n27.5,\n\\qquad\n\\frac{\\sigma^{2}}{\\mu_{0}-\\mu_{1}}\n=\n\\frac{(2.5)^{2}}{34-21}\n=\n\\frac{6.25}{13}\n\\approx 0.480769.\n$$\nTherefore,\n$$\nx^{\\ast}\n=\n27.5\n-\n\\left(0.480769\\right)\\,\\left(-1.9196\\right)\n\\approx\n27.5 + 0.9229\n=\n28.4229\\ldots.\n$$\nRounded to four significant figures and expressed in cycles, the Bayes-optimal $Ct$ threshold is $28.42$ cycles.", "answer": "$$\\boxed{28.42}$$", "id": "4707298"}, {"introduction": "Accurately assessing the severity of an outbreak is crucial for allocating resources and communicating risk, but naive estimates can be misleading when many patient outcomes are still unresolved. This problem introduces a more robust method for estimating the Case Fatality Rate (CFR) using a competing risks framework, where death and recovery are treated as competing events over time. By modeling the time to each outcome and accounting for right-censored data from patients with still-unknown outcomes, you will derive the Maximum Likelihood Estimator for the true underlying fatality risk [@problem_id:4707365].", "problem": "An outbreak of primary pneumonic plague caused by the bacterium Yersinia pestis is investigated in a remote district. Investigators conduct prospective follow-up on incident laboratory-confirmed cases to estimate the Case Fatality Rate (CFR), defined as the probability that a case eventually dies before recovery. The analysis is performed at calendar time $T$ using the following foundational assumptions:\n\n- Conditional on confirmation, the time-to-death and the time-to-recovery are independent and follow exponential distributions with constant hazards $\\lambda_{d}$ and $\\lambda_{r}$, respectively, reflecting a memoryless, time-homogeneous approximation of clinical course under the prevailing standard of care.\n- Right-censoring at time $T$ (administrative end of follow-up) is independent of the event process.\n- Outcomes are mutually exclusive and exhaustive: each case eventually either dies or recovers, and after one event occurs, the other cannot occur.\n\nAt time $T$, the surveillance dataset contains the following sufficient summaries:\n\n- Total number of incident confirmed cases enrolled: $N = 90$.\n- Number of observed deaths by time $T$: $D = 41$.\n- Number of observed recoveries by time $T$: $R = 23$.\n- Number of cases still hospitalized without a recorded outcome at time $T$: $U = N - D - R = 26$.\n- Total accumulated follow-up time across all $N$ cases up to $T$: $\\sum_{i=1}^{N} t_{i} = 505$ case-days.\n\nStarting only from the definitions of hazard, survival, and the likelihood for right-censored time-to-event data under the exponential model, derive the Maximum Likelihood Estimator (MLE) for the CFR in terms of the observable counts and compute its value from the data above. Express the CFR as a decimal (not a percentage), and round your final numerical answer to four significant figures.", "solution": "The Case Fatality Rate (CFR) is the probability that a case dies before recovering, $P(T_d < T_r)$. Given that the time-to-death $T_d$ and time-to-recovery $T_r$ are independent exponential random variables with rates $\\lambda_d$ and $\\lambda_r$ respectively, this probability is given by the standard competing risks formula:\n$$ \\text{CFR} = \\frac{\\lambda_d}{\\lambda_d + \\lambda_r} $$\nTo estimate the CFR, we must first find the Maximum Likelihood Estimators (MLEs) for the rates $\\lambda_d$ and $\\lambda_r$ from the observed data. The data consist of $D$ deaths, $R$ recoveries, and $U$ right-censored observations, with a total person-time at risk of $T_{\\text{total}} = \\sum t_i$.\nThe likelihood function for this type of data is:\n$$ L(\\lambda_d, \\lambda_r) \\propto \\lambda_d^D \\lambda_r^R \\exp(-(\\lambda_d + \\lambda_r) T_{\\text{total}}) $$\nThe log-likelihood is:\n$$ \\ell(\\lambda_d, \\lambda_r) = D \\ln(\\lambda_d) + R \\ln(\\lambda_r) - (\\lambda_d + \\lambda_r) T_{\\text{total}} $$\nMaximizing this with respect to each rate gives the MLEs:\n$$ \\frac{\\partial \\ell}{\\partial \\lambda_d} = \\frac{D}{\\lambda_d} - T_{\\text{total}} = 0 \\implies \\hat{\\lambda}_d = \\frac{D}{T_{\\text{total}}} $$\n$$ \\frac{\\partial \\ell}{\\partial \\lambda_r} = \\frac{R}{\\lambda_r} - T_{\\text{total}} = 0 \\implies \\hat{\\lambda}_r = \\frac{R}{T_{\\text{total}}} $$\nBy the invariance property of MLEs, the MLE for the CFR is:\n$$ \\widehat{\\text{CFR}} = \\frac{\\hat{\\lambda}_d}{\\hat{\\lambda}_d + \\hat{\\lambda}_r} = \\frac{D/T_{\\text{total}}}{D/T_{\\text{total}} + R/T_{\\text{total}}} = \\frac{D}{D+R} $$\nThis intuitive result shows that the best estimate for the CFR is the proportion of deaths among all resolved cases, under the assumption of constant hazards.\nUsing the provided data, $D=41$ and $R=23$:\n$$ \\widehat{\\text{CFR}} = \\frac{41}{41 + 23} = \\frac{41}{64} = 0.640625 $$\nRounding to four significant figures gives $0.6406$.", "answer": "$$\n\\boxed{0.6406}\n$$", "id": "4707365"}, {"introduction": "The initial phase of an epidemic is governed by stochastic events; a single introduction of *Yersinia pestis* could either die out by chance or ignite a major outbreak. This practice explores the use of a Galton-Watson branching process, a foundational tool in mathematical epidemiology, to model these early transmission dynamics and quantify the probability of a large-scale epidemic. You will implement a model that incorporates key real-world features like superspreading and assess the risk of transmission in specific high-risk settings [@problem_id:4707305].", "problem": "You are asked to construct a principled stochastic model of early human-to-human transmission of Yersinia pestis (plague) during a pneumonic outbreak using a Galton–Watson branching process. Work from foundational principles of stochastic processes and infectious disease transmission. Assume each infectious individual independently generates a random number of secondary infectious individuals according to a specified offspring distribution. Define the basic reproduction number ($R_0$) as the expected number of secondary cases generated by a single typical infectious case in a wholly susceptible population. Capture superspreading using an offspring distribution that can be either Poisson or Negative Binomial (NB), both parameterized to have mean $R_0$. Let $k$ denote the dispersion parameter for the Negative Binomial distribution. Assume that each secondary transmission independently involves a high-risk exposure (for example, an unprotected healthcare worker) with probability $f \\in [0,1]$, modeled by Bernoulli trials that are independent across transmissions and lineages.\n\nBase your derivations on the following core facts from the theory of branching processes and standard distributions:\n- In a Galton–Watson branching process with independent and identically distributed offspring, the probability generating function (PGF) $G(s)$ of the offspring distribution encodes the process. If $K$ is the number of offspring of a single individual, then $G(s) = \\mathbb{E}[s^{K}]$ for $s \\in [0,1]$.\n- The extinction probability $q$ for a process started by a single initial infectious case solves the fixed-point equation $q = G(q)$, which follows from independence of lineages.\n- If each offspring is independently “marked” (high-risk exposure) with probability $f$, then the probability $h$ that no marked individuals ever appear in the entire transmission tree started from one initial case solves $h = G((1 - f) \\, h)$, obtained by conditioning on the children and using independence and thinning.\n\nUse the following parameterizations of the offspring PGF:\n- Poisson offspring distribution with mean $R_0$: $G(s) = \\exp\\!\\left(R_0 (s - 1)\\right)$.\n- Negative Binomial offspring distribution with mean $R_0$ and dispersion $k$: $G(s) = \\left(1 + \\dfrac{R_0}{k} (1 - s)\\right)^{-k}$, which corresponds to the commonly used superspreading parameterization in infectious disease epidemiology.\n\nYour program must, for each provided test case, compute and return the following three quantities for an outbreak initiated by $n$ initial infectious individuals:\n1. The extinction probability $q$ for a single initial infectious case, computed as the smallest solution in $[0,1]$ to $q = G(q)$.\n2. The major-outbreak probability $1 - q$ for a single initial infectious case.\n3. The probability that at least one marked (high-risk) exposure occurs anywhere in the transmission trees arising from $n$ initial infectious cases, which equals $1 - h^{n}$, where $h$ solves $h = G((1 - f) \\, h)$.\n\nNumerically solve the fixed-point equations using reliable iterative methods on $[0,1]$ that converge to the appropriate solutions without relying on closed-form shortcuts. Use a convergence tolerance of at most $\\epsilon = 10^{-12}$ for the fixed-point solves and return results rounded to $6$ decimal places. All inputs are dimensionless. Express all probabilities as decimals in $[0,1]$.\n\nTest suite:\nProvide results for the following five test cases, each specified as a tuple $(\\text{dist}, R_0, k, n, f)$, where $\\text{dist} \\in \\{\\text{\"poisson\"}, \\text{\"nb\"}\\}$, $R_0 > 0$, $k > 0$ if applicable, $n \\in \\mathbb{N}$ with $n \\ge 1$, and $f \\in [0,1]$:\n- Case A: $\\text{\"nb\"}, R_0 = 0.7, k = 0.3, n = 1, f = 0.2$.\n- Case B: $\\text{\"nb\"}, R_0 = 1.6, k = 0.2, n = 1, f = 0.1$.\n- Case C: $\\text{\"poisson\"}, R_0 = 1.1, k$ ignored, $n = 3, f = 0.05$.\n- Case D: $\\text{\"nb\"}, R_0 = 3.0, k = 10.0, n = 5, f = 0.01$.\n- Case E: $\\text{\"nb\"}, R_0 = 1.2, k = 0.05, n = 2, f = 0.3$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the same order as above. Each inner list must contain the three floats $[q, 1 - q, 1 - h^{n}]$, each rounded to $6$ decimal places, with no extra spaces. For example, the printed output should look like:\n[[q_A,maj_A,mark_A],[q_B,maj_B,mark_B],[q_C,maj_C,mark_C],[q_D,maj_D,mark_D],[q_E,maj_E,mark_E]]\nwhere $q_{\\cdot}$, $\\text{maj}_{\\cdot}$, and $\\text{mark}_{\\cdot}$ are the computed values for the corresponding case.", "solution": "The problem requires the construction and analysis of a stochastic model for the early phase of a pneumonic plague outbreak. The chosen framework is the Galton-Watson branching process, a standard and powerful tool in mathematical epidemiology for modeling scenarios where the population of susceptibles is large enough to be considered effectively infinite.\n\nThe core of a Galton-Watson process is the offspring distribution, which describes the number of secondary infections caused by a single infectious individual. This distribution is concisely captured by its probability generating function (PGF). Let $K$ be a random variable representing the number of offspring from a single individual. The PGF, denoted $G(s)$, is defined as the expectation of $s^K$:\n$$G(s) = \\mathbb{E}[s^K] = \\sum_{j=0}^{\\infty} P(K=j) s^j$$\nfor a complex variable $s$ where the series converges, typically for $|s| \\le 1$. The mean of the distribution, which in this epidemiological context is the basic reproduction number $R_0$, can be recovered from the PGF as $R_0 = G'(1)$.\n\nThe problem specifies two possible offspring distributions:\n1.  **Poisson distribution:** This distribution assumes that secondary transmissions are independent events occurring at a constant average rate. Its PGF is given by:\n    $$G_{\\text{Poisson}}(s) = \\exp(R_0 (s - 1))$$\n    where $R_0$ is the mean number of offspring.\n\n2.  **Negative Binomial (NB) distribution:** This distribution is frequently used to model superspreading, as it allows for a higher variance than the Poisson distribution for the same mean. This property, known as overdispersion, is characteristic of many infectious diseases. The PGF is given by the parameterization:\n    $$G_{\\text{NB}}(s) = \\left(1 + \\frac{R_0}{k} (1 - s)\\right)^{-k}$$\n    Here, $R_0$ is the mean, and $k > 0$ is the dispersion parameter. Smaller values of $k$ correspond to greater overdispersion (i.e., a higher probability of superspreading events), while as $k \\to \\infty$, the NB distribution converges to the Poisson distribution with the same mean.\n\nThe first quantity to be computed is the **extinction probability**, $q$. This is the probability that a transmission chain initiated by a single infectious individual eventually dies out. By conditioning on the number of offspring in the first generation and invoking the independence of their subsequent lineages, we arrive at the fundamental self-consistency equation for $q$:\n$$q = \\sum_{j=0}^{\\infty} P(K=j) q^j = G(q)$$\nThe PGF $G(s)$ is a convex function on $[0,1]$ with $G(1) = 1$. If $R_0 = G'(1) \\le 1$, the only solution to $q = G(q)$ in the interval $[0,1]$ is $q=1$, signifying that extinction is certain. If $R_0 > 1$, there exists a unique solution $q \\in [0,1)$ which corresponds to the extinction probability. This solution is the smallest non-negative fixed point of $G(s)$. The complementary probability, $1-q$, represents the **major-outbreak probability** for a single infectious case.\n\nThe second part of the problem involves analyzing \"marked\" transmissions, which are high-risk exposures occurring with an independent probability $f$ for each secondary infection. We need to find the probability $h$ that no marked individuals ever appear in the transmission tree starting from a single case. We can derive an equation for $h$ by another conditioning argument. Consider a single potential offspring. For its lineage to be free of marked cases, two independent events must occur:\n1.  The transmission event itself must not be marked (probability $1-f$).\n2.  The entire subsequent transmission chain originating from this offspring must also be free of marked cases. By the recursive nature of the process, this probability is $h$.\nThus, for any given offspring, the probability that its entire lineage is \"clean\" (unmarked) is $(1-f)h$. To find the total probability $h$ for the initial case, we sum over all possibilities for the number of its offspring, $K=j$:\n$$h = \\sum_{j=0}^{\\infty} P(K=j) ((1-f)h)^j = G((1-f)h)$$\nThis gives us a new fixed-point equation for $h$. Similar to finding $q$, we seek the smallest non-negative solution.\n\nThe outbreak is started by $n$ initial infectious individuals. Since their transmission trees are assumed to evolve independently, the probability that none of the $n$ lineages produce any marked cases is $h^n$. The event of interest is its complement: the probability that at least one marked exposure occurs is $1 - h^n$.\n\nTo solve the fixed-point equations $x = F(x)$, we employ a numerical fixed-point iteration algorithm. Starting with an initial guess $x_0 = 0$, we iterate $x_{i+1} = F(x_i)$ until the change between successive iterations falls below a specified tolerance, $|x_{i+1} - x_i| < \\epsilon = 10^{-12}$. For the functions $F(s)=G(s)$ and $F(s)=G((1-f)s)$, which are PGFs or compositions involving PGFs, this iterative scheme started from $s=0$ is guaranteed to converge monotonically to the smallest non-negative fixed point.\n\nThe overall algorithm for each test case $(\\text{dist}, R_0, k, n, f)$ is as follows:\n1.  Select the appropriate PGF, $G(s)$, based on the distribution type $\\text{dist}$.\n2.  Define the function for the extinction probability, $F_q(s) = G(s)$. Solve $q = F_q(q)$ via fixed-point iteration starting from $s=0$.\n3.  Calculate the major-outbreak probability as $1 - q$.\n4.  Define the function for the no-marked-case probability, $F_h(s) = G((1-f)s)$. Solve $h = F_h(h)$ via fixed-point iteration starting from $s=0$.\n5.  Calculate the final probability of at least one marked transmission as $1 - h^n$.\n6.  Round the three resulting probabilities to $6$ decimal places.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for epidemiological quantities based on a Galton-Watson branching process model.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Each test case is a tuple: (distribution, R0, k, n, f)\n    # dist: 'poisson' or 'nb' (Negative Binomial)\n    # R0: Basic reproduction number\n    # k: Dispersion parameter for NB (ignored for Poisson)\n    # n: Number of initial infectious individuals\n    # f: Probability of a transmission being a \"marked\" high-risk exposure\n    test_cases = [\n        (\"nb\", 0.7, 0.3, 1, 0.2),\n        (\"nb\", 1.6, 0.2, 1, 0.1),\n        (\"poisson\", 1.1, None, 3, 0.05),\n        (\"nb\", 3.0, 10.0, 5, 0.01),\n        (\"nb\", 1.2, 0.05, 2, 0.3),\n    ]\n\n    TOLERANCE = 1e-12\n    MAX_ITER = 2000\n\n    def find_fixed_point(func, x0):\n        \"\"\"\n        Iteratively finds the fixed point of a function x = func(x).\n        \n        Args:\n            func: The function for which to find a fixed point.\n            x0: The initial guess.\n            \n        Returns:\n            The fixed point.\n        \"\"\"\n        x_prev = x0\n        for _ in range(MAX_ITER):\n            x_next = func(x_prev)\n            if abs(x_next - x_prev)  TOLERANCE:\n                return x_next\n            x_prev = x_next\n        # Return the last computed value if max iterations are reached without convergence\n        return x_next\n\n    def get_pgf(dist, R0, k):\n        \"\"\"\n        Returns the appropriate probability generating function (PGF).\n        \n        Args:\n            dist (str): 'poisson' or 'nb'.\n            R0 (float): Basic reproduction number.\n            k (float): Dispersion parameter for NB.\n            \n        Returns:\n            A function G(s) representing the PGF.\n        \"\"\"\n        if dist == \"poisson\":\n            return lambda s: np.exp(R0 * (s - 1.0))\n        elif dist == \"nb\":\n            if k is None or k = 0:\n                raise ValueError(\"Dispersion parameter k must be positive for NB distribution.\")\n            return lambda s: (1.0 + R0 / k * (1.0 - s))**(-k)\n        else:\n            raise ValueError(f\"Unknown distribution: {dist}\")\n\n    results_all_cases = []\n    \n    for dist, R0, k, n, f in test_cases:\n        # 1. Select the appropriate PGF G(s)\n        G = get_pgf(dist, R0, k)\n        \n        # 2. Compute extinction probability q\n        # q is the smallest non-negative root of q = G(q)\n        q_func = lambda s: G(s)\n        q = find_fixed_point(q_func, x0=0.0)\n        \n        # 3. Compute major-outbreak probability 1 - q\n        major_outbreak_prob = 1.0 - q\n        \n        # 4. Compute h, the probability of no marked cases from a single lineage\n        # h is the smallest non-negative root of h = G((1 - f) * h)\n        h_func = lambda s: G((1.0 - f) * s)\n        h = find_fixed_point(h_func, x0=0.0)\n        \n        # 5. Compute the probability of at least one marked case from n lineages\n        prob_at_least_one_marked = 1.0 - h**n\n        \n        # 6. Store and round results to 6 decimal places\n        case_results = [\n            round(q, 6),\n            round(major_outbreak_prob, 6),\n            round(prob_at_least_one_marked, 6)\n        ]\n        results_all_cases.append(case_results)\n\n    # Format the final output string as specified: [[q,maj,mark],[...],...]\n    output_parts = []\n    for res in results_all_cases:\n        # Format each inner list without spaces\n        inner_str = f\"[{res[0]},{res[1]},{res[2]}]\"\n        output_parts.append(inner_str)\n        \n    final_output = f\"[{','.join(output_parts)}]\"\n    # This print statement is for verification; the value is returned by the function.\n    # print(final_output)\n    return final_output\n\n# In a real scenario, this would be the main execution block\n# if __name__ == \"__main__\":\n#     solve()\n```", "answer": "```\n[[1.000000,0.000000,0.140000],[0.490895,0.509105,0.150091],[0.216668,0.783332,0.155737],[0.056086,0.943914,0.141151],[0.864332,0.135668,0.478339]]\n```", "id": "4707305"}]}