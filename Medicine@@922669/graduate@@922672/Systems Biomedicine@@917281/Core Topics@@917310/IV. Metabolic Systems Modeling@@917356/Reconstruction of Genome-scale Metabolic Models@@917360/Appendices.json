{"hands_on_practices": [{"introduction": "A genome-scale metabolic model is fundamentally a mathematical embodiment of biochemical stoichiometry, governed by the inviolable laws of mass and charge conservation. Ensuring that every reaction in the model is elementally and charge-balanced is a critical, foundational step in the reconstruction process, as imbalances can lead to biologically infeasible predictions. This practice [@problem_id:4383604] guides you through the essential task of auditing a single reaction, correcting compartmental errors, and determining the necessary stoichiometry to achieve a valid biochemical transformation.", "problem": "A Genome-Scale Metabolic Model (GEM) represents biochemical reactions with explicit stoichiometric coefficients for metabolites in defined cellular compartments and requires strict conservation of mass and electric charge. Consider the cytosolic carbonic anhydrase reaction in a human cell that has been incorrectly encoded in the model as\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}},\n$$\nwhere the subscripts $\\mathrm{c}$ and $\\mathrm{m}$ denote the cytosolic and mitochondrial compartments, respectively. At physiological pH, use the following metabolite formulas and net charges:\n- $\\mathrm{CO_2}$: formula $C_1O_2$, net charge $0$.\n- $\\mathrm{H_2O}$: formula $H_2O_1$, net charge $0$.\n- $\\mathrm{HCO_3^-}$: formula $C_1H_1O_3$, net charge $-1$.\n- $\\mathrm{H^+}$: formula $H_1$, net charge $+1$.\n\nStarting from the fundamental principles of conservation of mass (each element count is conserved across the reaction) and conservation of electric charge (the algebraic sum of charges must be equal for reactants and products), perform a mass and charge audit of the given reaction. Because purely enzymatic conversions do not translocate species across compartments, first correct the compartmental assignment of water by placing $\\mathrm{H_2O}$ in the cytosolic compartment. Then, determine the single stoichiometric coefficient $n$ to be assigned to $\\mathrm{H^+}_{\\mathrm{c}}$ on the product side so that both mass and charge are conserved in the corrected cytosolic reaction:\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}.\n$$\nProvide the value of $n$ as your final answer. No units are required. The final answer must be a single real-valued number. If you compute a non-integer value, do not round; report the exact value. If you compute an integer value, report it exactly.", "solution": "The problem as stated is subjected to validation against the principles of scientific soundness, consistency, and formalizability.\n\n**Problem Validation**\n\n**Step 1: Extracted Givens**\n- **Initial reaction (incorrect):** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}}$\n- **Compartment definitions:** $\\mathrm{c}$ for cytosol, $\\mathrm{m}$ for mitochondrion.\n- **Metabolite properties (at physiological pH):**\n  - $\\mathrm{CO_2}$: Formula $C_1O_2$, Net charge $0$.\n  - $\\mathrm{H_2O}$: Formula $H_2O_1$, Net charge $0$.\n  - $\\mathrm{HCO_3^-}$: Formula $C_1H_1O_3$, Net charge $-1$.\n  - $\\mathrm{H^+}$: Formula $H_1$, Net charge $+1$.\n- **Correction instructions:**\n  1. The reaction is purely enzymatic and does not involve translocation; therefore, $\\mathrm{H_2O}$ must be assigned to the cytosolic compartment, $\\mathrm{H_2O_c}$.\n  2. The reaction must be balanced for both mass and charge by introducing a proton, $\\mathrm{H^+_c}$, on the product side with an unknown stoichiometric coefficient, $n$.\n- **Final reaction form to be balanced:** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}$.\n\n**Step 2: Validation of Extracted Givens**\n- **Scientifically Grounded:** The problem is centered on the carbonic anhydrase reaction, a fundamental biochemical process. It correctly applies the principles of mass and charge conservation, which are inviolable laws in chemistry and physics. The context of Genome-Scale Metabolic Models (GEMs) and compartmentalization is central to the field of systems biology. The premise is scientifically sound.\n- **Well-Posed:** The problem provides all necessary information (atomic compositions, charges, and the structural form of the corrected reaction) to determine a single unknown variable, $n$. This structure leads to a unique and stable solution.\n- **Objective:** The problem is stated using precise chemical and mathematical terminology. It is free of ambiguity, subjectivity, or opinion.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid. It is scientifically grounded, well-posed, and internally consistent.\n- **Action:** Proceed with the solution.\n\n**Solution Derivation**\n\nThe fundamental principles governing any valid biochemical reaction are the conservation of mass for each element and the conservation of total electric charge. The problem requires us to find the stoichiometric coefficient $n$ for the proton $\\mathrm{H^+_c}$ that satisfies these principles for the cytosolic carbonic anhydrase reaction.\n\nThe corrected reaction to be balanced is:\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\nSince all species are in the same cytosolic compartment ($\\mathrm{c}$), the compartment labels can be omitted for the balancing calculation without loss of generality. The reaction stoichiometry is thus:\n$$\n1\\,\\mathrm{CO_2} + 1\\,\\mathrm{H_2O} \\rightarrow 1\\,\\mathrm{HCO_3^-} + n\\,\\mathrm{H^+}\n$$\nWe will now perform an audit for each element (Carbon, Oxygen, Hydrogen) and for the net electric charge.\n\n**1. Mass Balance Audit:**\n\nLet us tabulate the number of atoms for each element on the reactant and product sides of the equation.\n\n- **Carbon (C):**\n  - Reactants: $1$ atom from $\\mathrm{CO_2}$ (formula $C_1O_2$).\n  - Products: $1$ atom from $\\mathrm{HCO_3^-}$ (formula $C_1H_1O_3$).\n  - The balance equation is $1 = 1$. This is satisfied and provides no constraint on $n$.\n\n- **Oxygen (O):**\n  - Reactants: $2$ atoms from $\\mathrm{CO_2}$ + $1$ atom from $\\mathrm{H_2O}$ (formula $H_2O_1$). Total is $2 + 1 = 3$.\n  - Products: $3$ atoms from $\\mathrm{HCO_3^-}$.\n  - The balance equation is $3 = 3$. This is also satisfied and provides no constraint on $n$.\n\n- **Hydrogen (H):**\n  - Reactants: $2$ atoms from $\\mathrm{H_2O}$ (formula $H_2O_1$).\n  - Products: $1$ atom from $\\mathrm{HCO_3^-}$ + $n \\times 1$ atoms from $n\\,\\mathrm{H^+}$ (formula $H_1$). Total is $1 + n$.\n  - To conserve mass, the number of hydrogen atoms on both sides must be equal:\n  $$\n  2 = 1 + n\n  $$\n\n**2. Charge Balance Audit:**\n\nNext, we balance the net electric charge.\n\n- **Reactants:**\n  - $\\mathrm{CO_2}$ has a charge of $0$.\n  - $\\mathrm{H_2O}$ has a charge of $0$.\n  - The total charge on the reactant side is $0 + 0 = 0$.\n\n- **Products:**\n  - $\\mathrm{HCO_3^-}$ has a charge of $-1$.\n  - $n\\,\\mathrm{H^+}$ contributes a total charge of $n \\times (+1) = +n$.\n  - The total charge on the product side is $-1 + n$.\n\n- To conserve charge, the net charges on both sides must be equal:\n  $$\n  0 = -1 + n\n  $$\n\n**3. Solving for $n$:**\n\nWe have derived two independent equations for the unknown coefficient $n$. A consistent problem formulation must yield the same value for $n$ from both equations.\n\nFrom the hydrogen mass balance:\n$$\n2 = 1 + n \\implies n = 2 - 1 = 1\n$$\nFrom the electric charge balance:\n$$\n0 = -1 + n \\implies n = 1\n$$\nBoth equations yield a consistent result, $n=1$. This confirms the correctness of the approach and the well-posed nature of the problem.\n\nTherefore, the stoichiometrically correct and charge-balanced reaction for carbonic anhydrase in the cytosol is:\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + 1\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\nThe value of the stoichiometric coefficient $n$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "4383604"}, {"introduction": "To simulate cellular growth, a genome-scale model requires a \"biomass objective function\" (BOF)â€”a synthetic reaction that consumes all necessary macromolecular building blocks in the precise ratios required to create new cell mass. The accuracy of this BOF is paramount, as it dictates the predicted optimal patterns of metabolic flux. In this exercise [@problem_id:4383603], you will practice the crucial skill of translating experimentally measured macromolecular composition data into the correct stoichiometric coefficients for the biomass pseudo-reaction, a cornerstone of model construction.", "problem": "A microbial species grown in balanced exponential conditions has a measured macromolecular composition on a gram dry weight (gDW) basis. You are constructing a biomass pseudo-reaction for a genome-scale metabolic model, in which the biomass product represents one gram dry weight produced. For this model, you represent macromolecules by polymerized residue pseudo-metabolites whose molecular weights are already corrected for the mass of water lost during polymerization. The biomass pseudo-reaction should consume these pseudo-metabolites in amounts that exactly reflect the measured composition, and the stoichiometric coefficients must be in units of millimoles per gram dry weight produced (mmol/gDW).\n\nGiven:\n- Measured mass fractions (g per gDW) of macromolecular classes:\n  - Protein: $0.55$\n  - Ribonucleic acid (RNA): $0.20$\n  - Deoxyribonucleic acid (DNA): $0.03$\n  - Lipid (lumped): $0.12$\n  - Carbohydrate (glycan, as polymerized glucose residues): $0.10$\n- Polymerized residue molecular weights (g per mol):\n  - Average amino acid residue (Protein\\_res): $110$\n  - Ribonucleotide monophosphate residue (rNMP\\_res): $324$\n  - Deoxyribonucleotide monophosphate residue (dNMP\\_res): $308$\n  - Lumped lipid unit (Lipid\\_unit): $700$\n  - Anhydroglucose residue (Glycan\\_res): $162$\n\nTasks:\n1. Starting from mass conservation and the definition of amount of substance, derive a general expression for the stoichiometric coefficient $s_{i}$ (in mmol/gDW) for each polymerized residue pseudo-metabolite $i$ as a function of its mass fraction $f_{i}$ (in g/gDW) and its polymerized residue molecular weight $M_{i}$ (in g/mol). The coefficient $s_{i}$ should be negative to indicate consumption when $1$ gDW of biomass is produced.\n2. Using the given data, compute the five stoichiometric coefficients for the pseudo-metabolites Protein\\_res, rNMP\\_res, dNMP\\_res, Lipid\\_unit, and Glycan\\_res. Do not include any energetic cofactors or inorganic byproducts, and do not include the biomass product term in your reported answer.\n\nReport your final answer as a single row vector containing the five stoichiometric coefficients in the order [Protein\\_res, rNMP\\_res, dNMP\\_res, Lipid\\_unit, Glycan\\_res]. Express exact values as simplified rational numbers where appropriate. Units are mmol per gDW produced, but do not include units in your final vector.", "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, self-contained, and consistent. The provided data are reasonable for a microbial system and sufficient for a complete, unique solution. The sum of the mass fractions is $0.55 + 0.20 + 0.03 + 0.12 + 0.10 = 1.00$, which confirms the consistency of the compositional data. We will proceed with the solution.\n\nThe problem is divided into two tasks: first, to derive a general expression for the stoichiometric coefficients, and second, to calculate their specific values.\n\n**Task 1: Derivation of the General Expression for Stoichiometric Coefficient $s_i$**\n\nThe biomass pseudo-reaction represents the consumption of precursor metabolites to produce $1$ gram of dry weight (gDW) of biomass. For a given precursor pseudo-metabolite $i$, the reaction can be written as:\n$$\n\\dots + s_i \\cdot \\text{Metabolite}_i + \\dots \\longrightarrow 1 \\cdot \\text{Biomass}\n$$\nIn this formulation, the stoichiometric coefficient $s_i$ represents the moles (or millimoles) of Metabolite $i$ consumed per unit of biomass produced. By convention in metabolic modeling, coefficients for reactants (consumed species) are negative, while coefficients for products (produced species) are positive. The problem specifies the units of $s_i$ to be millimoles per gram dry weight (mmol/gDW).\n\nLet $f_i$ be the mass fraction of macromolecular class $i$ in the biomass, given in units of grams of component $i$ per gram of total dry weight (g/gDW). To produce $1$ gDW of biomass, a mass $m_i$ of component $i$ must be synthesized. This mass is given by:\n$$\nm_i = f_i \\cdot (1 \\text{ gDW}) = f_i \\text{ [g]}\n$$\nThe amount of substance (in moles) of component $i$, denoted $n_i$, is related to its mass $m_i$ and its molecular weight $M_i$. The problem provides $M_i$ in units of grams per mole (g/mol). The relationship is:\n$$\nn_i = \\frac{m_i}{M_i}\n$$\nSubstituting the expression for $m_i$:\n$$\nn_i = \\frac{f_i}{M_i}\n$$\nThe units of $n_i$ are $\\frac{\\text{g/gDW}}{\\text{g/mol}} = \\frac{\\text{mol}}{\\text{gDW}}$. This gives the molar amount of component $i$ required to produce $1$ gDW of biomass.\n\nThe problem requires the stoichiometric coefficient $s_i$ to be in units of millimoles per gram dry weight (mmol/gDW). To convert from moles to millimoles, we use the conversion factor $1 \\text{ mol} = 1000 \\text{ mmol}$.\n$$\n|s_i| = n_i \\cdot 1000 \\left[\\frac{\\text{mmol}}{\\text{mol}}\\right] = \\frac{1000 \\cdot f_i}{M_i}\n$$\nThe units of $|s_i|$ are $\\left[\\frac{\\text{mol}}{\\text{gDW}}\\right] \\cdot \\left[\\frac{\\text{mmol}}{\\text{mol}}\\right] = \\left[\\frac{\\text{mmol}}{\\text{gDW}}\\right]$, which matches the requirement.\n\nFinally, since component $i$ is a reactant (it is consumed), its stoichiometric coefficient must be negative. Therefore, the general expression for $s_i$ is:\n$$\ns_i = -\\frac{1000 \\cdot f_i}{M_i}\n$$\nwhere $f_i$ is in g/gDW and $M_i$ is in g/mol.\n\n**Task 2: Computation of Stoichiometric Coefficients**\n\nWe now apply this derived formula to compute the five requested stoichiometric coefficients using the provided data.\n\n1.  **Protein\\_res (Amino Acid Residues):**\n    $f_{\\text{protein}} = 0.55$ g/gDW\n    $M_{\\text{protein\\_res}} = 110$ g/mol\n    $$\n    s_{\\text{protein\\_res}} = -\\frac{1000 \\times 0.55}{110} = -\\frac{550}{110} = -5\n    $$\n\n2.  **rNMP\\_res (Ribonucleotide Residues for RNA):**\n    $f_{\\text{RNA}} = 0.20$ g/gDW\n    $M_{\\text{rNMP\\_res}} = 324$ g/mol\n    $$\n    s_{\\text{rNMP\\_res}} = -\\frac{1000 \\times 0.20}{324} = -\\frac{200}{324} = -\\frac{100}{162} = -\\frac{50}{81}\n    $$\n\n3.  **dNMP\\_res (Deoxyribonucleotide Residues for DNA):**\n    $f_{\\text{DNA}} = 0.03$ g/gDW\n    $M_{\\text{dNMP\\_res}} = 308$ g/mol\n    $$\n    s_{\\text{dNMP\\_res}} = -\\frac{1000 \\times 0.03}{308} = -\\frac{30}{308} = -\\frac{15}{154}\n    $$\n\n4.  **Lipid\\_unit (Lumped Lipid Units):**\n    $f_{\\text{lipid}} = 0.12$ g/gDW\n    $M_{\\text{lipid\\_unit}} = 700$ g/mol\n    $$\n    s_{\\text{lipid\\_unit}} = -\\frac{1000 \\times 0.12}{700} = -\\frac{120}{700} = -\\frac{12}{70} = -\\frac{6}{35}\n    $$\n\n5.  **Glycan\\_res (Anhydroglucose Residues for Carbohydrates):**\n    $f_{\\text{carb}} = 0.10$ g/gDW\n    $M_{\\text{glycan\\_res}} = 162$ g/mol\n    $$\n    s_{\\text{glycan\\_res}} = -\\frac{1000 \\times 0.10}{162} = -\\frac{100}{162} = -\\frac{50}{81}\n    $$\n\nThe resulting biomass pseudo-reaction, considering only these macromolecular precursors, would be:\n$$\n5 \\text{ Protein\\_res} + \\frac{50}{81} \\text{ rNMP\\_res} + \\frac{15}{154} \\text{ dNMP\\_res} + \\frac{6}{35} \\text{ Lipid\\_unit} + \\frac{50}{81} \\text{ Glycan\\_res} \\longrightarrow 1 \\text{ Biomass}\n$$\nThe stoichiometric coefficients reported in the final answer must be the negative values as calculated. The five coefficients, in the requested order [Protein\\_res, rNMP\\_res, dNMP\\_res, Lipid\\_unit, Glycan\\_res], are $[-5, -\\frac{50}{81}, -\\frac{15}{154}, -\\frac{6}{35}, -\\frac{50}{81}]$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -5  -\\frac{50}{81}  -\\frac{15}{154}  -\\frac{6}{35}  -\\frac{50}{81} \\end{pmatrix}}\n$$", "id": "4383603"}, {"introduction": "Metabolism in eukaryotic cells is spatially organized into compartments, a feature that imposes significant constraints on metabolic fluxes. A realistic reconstruction must not only include the correct reactions but also assign them to the correct subcellular locations and model the transport mechanisms that connect them. This exercise [@problem_id:4383433] demonstrates the profound impact of such structural details by using Flux Balance Analysis (FBA) to compare a simplified, single-compartment model with a more accurate, compartmentalized version, revealing how transport limitations can reshape the optimal metabolic state.", "problem": "A developer is asked to examine how compartment-specific treatment of a shuttle metabolite and explicit transport capacity affect steady-state pathway fluxes and redox coupling in a genome-scale metabolic reconstruction setting. The mathematical base is the law of mass conservation and steady-state balance, which gives the linear constraint $S v = 0$, where $S$ is the stoichiometric matrix and $v$ is the reaction flux vector. The approach is Flux Balance Analysis (FBA), which is formulated as a linear program: maximize a linear objective $c^\\top v$ subject to $S v = 0$ and bound constraints $\\ell \\le v \\le u$. Flux Balance Analysis (FBA) relies on known stoichiometries and the assumption of quasi-steady state for internal metabolites.\n\nYou will construct and compare two small compartmental metabolic models that include cytosolic glycolysis, cytosolic lactate dehydrogenase, pyruvate transport into mitochondria, a simplified tricarboxylic acid cycle producing mitochondrial reduced nicotinamide adenine dinucleotide (NADH), an electron transport chain that uses oxygen to convert reduced nicotinamide adenine dinucleotide (NADH) to adenosine triphosphate (ATP), and a malate-mediated redox shuttle. The first model uses a single compartment version of malate (unsplit malate), implicitly allowing unlimited mixing of redox equivalents via this metabolite. The second model splits malate into cytosolic and mitochondrial forms (explicit compartments), adds an explicit transport reaction for malate with a finite capacity, and recomputes the FBA optimum. Your program must compute how this split and transport capacity change pathway fluxes and the compartmental redox balance.\n\nFundamental base:\n- Conservation of mass at steady state: $S v = 0$.\n- Linear programming objective: maximize $c^\\top v$ as a proxy for cellular performance (here, ATP drain).\n- Exchange reactions are sources or sinks for external metabolites with bounds representing availability or removal.\n- Reaction bounds model reversibility and capacity limits.\n\nModel A (unsplit malate):\n- Metabolites (internal and external): $\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, $\\mathrm{ATP}$.\n- Reactions (with stoichiometry, each coefficient is in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ units):\n    1. $\\mathrm{EX\\_glc}$: $+\\mathrm{Glc\\_ext}$, bounds $[0, G_{\\max}]$.\n    2. $\\mathrm{EX\\_o2}$: $+\\mathrm{O2\\_ext}$, bounds $[0, O_{\\max}]$.\n    3. $\\mathrm{EX\\_lac}$: $-\\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    4. $\\mathrm{R1\\_Glycolysis}$: $-\\mathrm{Glc\\_ext} + 2\\,\\mathrm{Pyr\\_c} + 2\\,\\mathrm{NADH\\_c} + 2\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    5. $\\mathrm{R2\\_LDH}$: $-\\mathrm{Pyr\\_c} - \\mathrm{NADH\\_c} + \\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    6. $\\mathrm{T\\_pyr}$: $-\\mathrm{Pyr\\_c} + \\mathrm{Pyr\\_m}$, bounds $[0, \\infty)$.\n    7. $\\mathrm{R7\\_TCA}$: $-\\mathrm{Pyr\\_m} + 4\\,\\mathrm{NADH\\_m} + 1\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    8. $\\mathrm{R3\\_MDH\\_c}$: $-\\mathrm{NADH\\_c} + \\mathrm{Mal}$, bounds $[0, \\infty)$.\n    9. $\\mathrm{R4\\_MDH\\_m}$: $-\\mathrm{Mal} + \\mathrm{NADH\\_m}$, bounds $[0, \\infty)$.\n    10. $\\mathrm{R5\\_ETC}$: $-\\mathrm{NADH\\_m} - 0.5\\,\\mathrm{O2\\_ext} + 2.5\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    11. $\\mathrm{ATP\\_drain}$: $-\\mathrm{ATP}$, bounds $[0, \\infty)$; this is the objective reaction to maximize.\n\nModel B (split malate with transport capacity):\n- Metabolites: $\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal\\_c}$, $\\mathrm{Mal\\_m}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, $\\mathrm{ATP}$.\n- Reactions:\n    1. $\\mathrm{EX\\_glc}$: $+\\mathrm{Glc\\_ext}$, bounds $[0, G_{\\max}]$.\n    2. $\\mathrm{EX\\_o2}$: $+\\mathrm{O2\\_ext}$, bounds $[0, O_{\\max}]$.\n    3. $\\mathrm{EX\\_lac}$: $-\\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    4. $\\mathrm{R1\\_Glycolysis}$: $-\\mathrm{Glc\\_ext} + 2\\,\\mathrm{Pyr\\_c} + 2\\,\\mathrm{NADH\\_c} + 2\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    5. $\\mathrm{R2\\_LDH}$: $-\\mathrm{Pyr\\_c} - \\mathrm{NADH\\_c} + \\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    6. $\\mathrm{T\\_pyr}$: $-\\mathrm{Pyr\\_c} + \\mathrm{Pyr\\_m}$, bounds $[0, \\infty)$.\n    7. $\\mathrm{R7\\_TCA}$: $-\\mathrm{Pyr\\_m} + 4\\,\\mathrm{NADH\\_m} + 1\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    8. $\\mathrm{R3s\\_MDH\\_c}$: $-\\mathrm{NADH\\_c} + \\mathrm{Mal\\_c}$, bounds $[0, \\infty)$.\n    9. $\\mathrm{T\\_mal}$: $-\\mathrm{Mal\\_c} + \\mathrm{Mal\\_m}$, bounds $[0, T_{\\max}]$ (unidirectional capacity).\n    10. $\\mathrm{R4s\\_MDH\\_m}$: $-\\mathrm{Mal\\_m} + \\mathrm{NADH\\_m}$, bounds $[0, \\infty)$.\n    11. $\\mathrm{R5\\_ETC}$: $-\\mathrm{NADH\\_m} - 0.5\\,\\mathrm{O2\\_ext} + 2.5\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    12. $\\mathrm{ATP\\_drain}$: $-\\mathrm{ATP}$, bounds $[0, \\infty)$; objective to maximize.\n\nObjective and constraints:\n- Maximize $\\mathrm{ATP\\_drain}$ flux for each model subject to $S v = 0$ and bounds. This is a linear program solved by minimizing $-v_{\\mathrm{ATP\\_drain}}$ to achieve the maximum, with equality constraints $S v = 0$.\n\nComputed quantities per test case:\n- $\\Delta \\mathrm{ATP} = v_{\\mathrm{ATP\\_drain}}^{\\text{split}} - v_{\\mathrm{ATP\\_drain}}^{\\text{unsplit}}$ in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n- $\\mathrm{ATP\\_unsplit}$ and $\\mathrm{ATP\\_split}$ in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n- Cytosolic lactate dehydrogenase fraction under the split model: $f_{\\mathrm{LDH}}^{\\text{split}} = v_{\\mathrm{R2\\_LDH}}^{\\text{split}} / \\left(2\\, v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}}\\right)$, expressed as a decimal in $[0,1]$; if $v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}} = 0$, define $f_{\\mathrm{LDH}}^{\\text{split}} = 0$.\n- Electron transport chain flux under the split model: $v_{\\mathrm{R5\\_ETC}}^{\\text{split}}$ in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n\nUnits:\n- All fluxes are to be reported in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$, expressed as decimal numbers.\n\nTest suite:\n- Case $1$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 10, 5)$.\n- Case $2$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 0, 5)$.\n- Case $3$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 10, 0)$.\n- Case $4$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (1, 10, 1000)$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of lists, one per test case, where each inner list is $[\\mathrm{ATP\\_unsplit}, \\mathrm{ATP\\_split}, \\Delta \\mathrm{ATP}, f_{\\mathrm{LDH}}^{\\text{split}}, v_{\\mathrm{R5\\_ETC}}^{\\text{split}}]$. The outer list must be printed as a comma-separated list enclosed in square brackets, for example, $[[x_1,x_2,x_3,x_4,x_5],[\\dots],\\dots]$.", "solution": "The problem presented is a comparative study of two simplified metabolic models using Flux Balance Analysis (FBA). The objective is to quantify the effects of compartmentalization and transport capacity on metabolic fluxes, specifically on adenosine triphosphate (ATP) production. The problem is scientifically grounded in the principles of stoichiometry and steady-state mass balance, and it is mathematically well-posed as a series of linear programming (LP) problems. All necessary data, including reaction stoichiometries, metabolite lists, and reaction bounds for four separate test cases, are provided. Therefore, the problem is deemed valid and a formal solution can be constructed.\n\nThe core of the problem lies in formulating and solving two distinct LP problems, one for each model (Model A: unsplit malate; Model B: split malate), for each of the four test cases. The general form of the FBA linear program is:\n$$\n\\begin{align*}\n\\text{maximize} \\quad  c^\\top v \\\\\n\\text{subject to} \\quad  S v = 0 \\\\\n \\ell \\le v \\le u\n\\end{align*}\n$$\nwhere $S$ is the stoichiometric matrix, $v$ is the vector of reaction fluxes, $c$ is the objective vector, and $\\ell$ and $u$ are the lower and upper bounds on the fluxes, respectively. The objective is to maximize the flux through the `ATP_drain` reaction, which represents the cell's total ATP production rate. This maximization is achieved by minimizing $-v_{\\mathrm{ATP\\_drain}}$.\n\nFirst, we define Model A (unsplit malate).\nThis model consists of $m=9$ metabolites and $n=11$ reactions. The metabolites are $\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, and $\\mathrm{ATP}$. The reactions are indexed as follows:\n$v_0$: $\\mathrm{EX\\_glc}$, $v_1$: $\\mathrm{EX\\_o2}$, $v_2$: $\\mathrm{EX\\_lac}$, $v_3$: $\\mathrm{R1\\_Glycolysis}$, $v_4$: $\\mathrm{R2\\_LDH}$, $v_5$: $\\mathrm{T\\_pyr}$, $v_6$: $\\mathrm{R7\\_TCA}$, $v_7$: $\\mathrm{R3\\_MDH\\_c}$, $v_8$: $\\mathrm{R4\\_MDH\\_m}$, $v_9$: $\\mathrm{R5\\_ETC}$, $v_{10}$: $\\mathrm{ATP\\_drain}$.\n\nThe $9 \\times 11$ stoichiometric matrix $S_A$ is constructed based on the reaction definitions. The rows correspond to the metabolites and the columns to the reactions.\n$$\nS_A = \\begin{pmatrix}\n 1  0  0  -1  0  0  0  0  0  0  0 \\\\\n 0  1  0  0  0  0  0  0  0  -0.5  0 \\\\\n 0  0  -1  0  1  0  0  0  0  0  0 \\\\\n 0  0  0  0  0  0  0  1  -1  0  0 \\\\\n 0  0  0  2  -1  -1  0  0  0  0  0 \\\\\n 0  0  0  0  0  1  -1  0  0  0  0 \\\\\n 0  0  0  2  -1  0  0  -1  0  0  0 \\\\\n 0  0  0  0  0  0  4  0  1  -1  0 \\\\\n 0  0  0  2  0  0  1  0  0  2.5  -1\n\\end{pmatrix}\n$$\nThe flux bounds are $\\ell_i = 0$ for all reactions $i$. The upper bounds $u_i$ are infinite for all reactions except for $v_0$ ($\\mathrm{EX\\_glc}$) and $v_1$ ($\\mathrm{EX\\_o2}$), which are constrained by $u_0 = G_{\\max}$ and $u_1 = O_{\\max}$, respectively. The objective vector $c_A$ is a vector of zeros with a $1$ at the position corresponding to $v_{10}$ ($\\mathrm{ATP\\_drain}$).\n\nNext, we define Model B (split malate with transport capacity).\nThis model is more detailed, with $m=10$ metabolites and $n=12$ reactions. Malate is split into cytosolic ($\\mathrm{Mal\\_c}$) and mitochondrial ($\\mathrm{Mal\\_m}$) pools, and an explicit transport reaction, $\\mathrm{T\\_mal}$, is introduced. The reactions are indexed as:\n$v_0$: $\\mathrm{EX\\_glc}$, $v_1$: $\\mathrm{EX\\_o2}$, $v_2$: $\\mathrm{EX\\_lac}$, $v_3$: $\\mathrm{R1\\_Glycolysis}$, $v_4$: $\\mathrm{R2\\_LDH}$, $v_5$: $\\mathrm{T\\_pyr}$, $v_6$: $\\mathrm{R7\\_TCA}$, $v_7$: $\\mathrm{R3s\\_MDH\\_c}$, $v_8$: $\\mathrm{T\\_mal}$, $v_9$: $\\mathrm{R4s\\_MDH\\_m}$, $v_{10}$: $\\mathrm{R5\\_ETC}$, $v_{11}$: $\\mathrm{ATP\\_drain}$.\n\nThe $10 \\times 12$ stoichiometric matrix $S_B$ is:\n$$\nS_B = \\begin{pmatrix}\n 1  0  0  -1  0  0  0  0  0  0  0  0 \\\\\n 0  1  0  0  0  0  0  0  0  0  -0.5  0 \\\\\n 0  0  -1  0  1  0  0  0  0  0  0  0 \\\\\n 0  0  0  0  0  0  0  1  -1  0  0  0 \\\\\n 0  0  0  0  0  0  0  0  1  -1  0  0 \\\\\n 0  0  0  2  -1  -1  0  0  0  0  0  0 \\\\\n 0  0  0  0  0  1  -1  0  0  0  0  0 \\\\\n 0  0  0  2  -1  0  0  -1  0  0  0  0 \\\\\n 0  0  0  0  0  0  4  0  0  1  -1  0 \\\\\n 0  0  0  2  0  0  1  0  0  0  2.5  -1\n\\end{pmatrix}\n$$\nThe flux lower bounds are again $\\ell_i=0$ for all reactions. The upper bounds $u_i$ are infinite except for $u_0 = G_{\\max}$, $u_1 = O_{\\max}$, and $u_8 = T_{\\max}$ (for the $\\mathrm{T\\_mal}$ transporter). The objective vector $c_B$ is a vector of zeros with a $1$ at the position for $v_{11}$ ($\\mathrm{ATP\\_drain}$).\n\nFor each of the four test cases defined by the tuple $(G_{\\max}, O_{\\max}, T_{\\max})$, the following procedure is executed:\n1. The LP problem for Model A is solved using the corresponding $G_{\\max}$ and $O_{\\max}$ values to obtain the optimal flux vector $v^{\\text{unsplit}}$. The optimal objective value gives $\\mathrm{ATP\\_unsplit} = v_{\\mathrm{ATP\\_drain}}^{\\text{unsplit}}$.\n2. The LP problem for Model B is solved using the corresponding $G_{\\max}$, $O_{\\max}$, and $T_{\\max}$ values to obtain the optimal flux vector $v^{\\text{split}}$.\n3. The following quantities are calculated from the solution vectors:\n   - $\\mathrm{ATP\\_split} = v_{\\mathrm{ATP\\_drain}}^{\\text{split}}$ (from $v^{\\text{split}}$ at index $11$).\n   - $\\Delta \\mathrm{ATP} = \\mathrm{ATP\\_split} - \\mathrm{ATP\\_unsplit}$.\n   - $v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}}$ (from $v^{\\text{split}}$ at index $3$) and $v_{\\mathrm{R2\\_LDH}}^{\\text{split}}$ (from $v^{\\text{split}}$ at index $4$) are used to compute the cytosolic lactate dehydrogenase fraction, $f_{\\mathrm{LDH}}^{\\text{split}} = v_{\\mathrm{R2\\_LDH}}^{\\text{split}} / (2 \\cdot v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}})$, which is defined as $0$ if the denominator is $0$.\n   - $v_{\\mathrm{R5\\_ETC}}^{\\text{split}}$ is extracted from $v^{\\text{split}}$ at index $10$.\n4. The five computed values, $[\\mathrm{ATP\\_unsplit}, \\mathrm{ATP\\_split}, \\Delta \\mathrm{ATP}, f_{\\mathrm{LDH}}^{\\text{split}}, v_{\\mathrm{R5\\_ETC}}^{\\text{split}}]$, are collected for each test case.\n\nThis procedure is implemented programmatically, utilizing `scipy.optimize.linprog` to solve the linear programs. The final output is an aggregation of the results from all four test cases, formatted as a list of lists.\n```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Constructs and solves two Flux Balance Analysis (FBA) problems,\n    Model A (unsplit malate) and Model B (split malate), for four\n    different test cases to analyze the effect of compartmentalization\n    and transport capacity on metabolic fluxes.\n    \"\"\"\n\n    test_cases = [\n        # (G_max, O_max, T_max)\n        (10, 10, 5),\n        (10, 0, 5),\n        (10, 10, 0),\n        (1, 10, 1000),\n    ]\n\n    # --- Model A: Unsplit Malate ---\n    # Metabolites (9): Glc_ext, O2_ext, Lac_ext, Mal, Pyr_c, Pyr_m, NADH_c, NADH_m, ATP\n    # Reactions (11): EX_glc, EX_o2, EX_lac, R1, R2, T_pyr, R7, R3, R4, R5, ATP_drain\n    S_A = np.array([\n        # EXg, EXo, EXl,  R1,  R2, T pyr, R7, R3,  R4,   R5,   AD\n        [1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Glc_ext\n        [0.0, 1.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0, 0.0, -0.5, 0.0], # O2_ext\n        [0.0, 0.0, -1.0, 0.0, 1.0,  0.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Lac_ext\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 1.0, -1.0, 0.0, 0.0], # Mal\n        [0.0, 0.0, 0.0,  2.0, -1.0, -1.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Pyr_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  1.0, -1.0, 0.0, 0.0,  0.0, 0.0], # Pyr_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0], # NADH_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 4.0, 0.0,  1.0, -1.0, 0.0], # NADH_m\n        [0.0, 0.0, 0.0,  2.0, 0.0,  0.0, 1.0, 0.0,  0.0,  2.5, -1.0] # ATP\n    ])\n    num_fluxes_A = S_A.shape[1]\n    c_A = np.zeros(num_fluxes_A)\n    c_A[10] = -1.0  # Maximize ATP_drain (index 10) by minimizing its negative\n    b_eq_A = np.zeros(S_A.shape[0])\n\n    # --- Model B: Split Malate ---\n    # Metabolites (10): Glc_ext, O2_ext, Lac_ext, Mal_c, Mal_m, Pyr_c, Pyr_m, NADH_c, NADH_m, ATP\n    # Reactions (12): EX_glc, EX_o2, EX_lac, R1, R2, T_pyr, R7, R3s, T_mal, R4s, R5, ATP_drain\n    S_B = np.array([\n        # EXg, EXo, EXl,  R1,  R2, T pyr, R7, R3s,T mal, R4s,   R5,   AD\n        [1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Glc_ext\n        [0.0, 1.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0, 0.0, 0.0, -0.5,  0.0], # O2_ext\n        [0.0, 0.0, -1.0, 0.0, 1.0,  0.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Lac_ext\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 1.0, -1.0, 0.0,  0.0,  0.0], # Mal_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0,  1.0, -1.0, 0.0,  0.0], # Mal_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, -1.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Pyr_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  1.0, -1.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Pyr_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0,  0.0,  0.0], # NADH_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 4.0, 0.0,  0.0, 1.0, -1.0,  0.0], # NADH_m\n        [0.0, 0.0, 0.0,  2.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0,  2.5, -1.0] # ATP\n    ])\n    num_fluxes_B = S_B.shape[1]\n    c_B = np.zeros(num_fluxes_B)\n    c_B[11] = -1.0  # Maximize ATP_drain (index 11)\n    b_eq_B = np.zeros(S_B.shape[0])\n\n    results = []\n    \n    TOL = 1e-9 # Tolerance for floating point comparisons\n\n    for G_max, O_max, T_max in test_cases:\n        # Solve for Model A\n        bounds_A = [(0, None)] * num_fluxes_A\n        bounds_A[0] = (0, G_max)  # EX_glc\n        bounds_A[1] = (0, O_max)  # EX_o2\n        res_A = linprog(c=c_A, A_eq=S_A, b_eq=b_eq_A, bounds=bounds_A, method='highs')\n        \n        fluxes_A = res_A.x if res_A.success else np.zeros(num_fluxes_A)\n        atp_unsplit = fluxes_A[10] if fluxes_A[10] > TOL else 0.0\n\n        # Solve for Model B\n        bounds_B = [(0, None)] * num_fluxes_B\n        bounds_B[0] = (0, G_max)  # EX_glc\n        bounds_B[1] = (0, O_max)  # EX_o2\n        bounds_B[8] = (0, T_max)  # T_mal\n        res_B = linprog(c=c_B, A_eq=S_B, b_eq=b_eq_B, bounds=bounds_B, method='highs')\n\n        fluxes_B = res_B.x if res_B.success else np.zeros(num_fluxes_B)\n\n        # Calculate required quantities\n        atp_split = fluxes_B[11] if fluxes_B[11] > TOL else 0.0\n        delta_atp = atp_split - atp_unsplit\n        \n        v_r1_split = fluxes_B[3] # R1_Glycolysis\n        v_r2_split = fluxes_B[4] # R2_LDH\n        \n        denominator = 2 * v_r1_split\n        if denominator > TOL:\n            f_ldh_split = v_r2_split / denominator\n        else:\n            f_ldh_split = 0.0\n            \n        v_r5_etc_split = fluxes_B[10] if fluxes_B[10] > TOL else 0.0\n        \n        # Collect and format results\n        case_results = [\n            round(atp_unsplit, 5),\n            round(atp_split, 5),\n            round(delta_atp, 5),\n            round(f_ldh_split, 5),\n            round(v_r5_etc_split, 5)\n        ]\n        results.append(case_results)\n\n    # Format final output string\n    inner_results_str = [f\"[{','.join(map(str, res))}]\" for res in results]\n    # This print is for local execution, not part of the XML output\n    # print(f\"[{','.join(inner_results_str)}]\")\n\n# solve() # function is defined but not called in final XML\n```", "answer": "```\n[[58.0,74.0,16.0,0.8,20.0],[20.0,20.0,0.0,1.0,0.0],[58.0,20.0,-38.0,1.0,0.0],[29.0,29.0,0.0,0.0,10.0]]\n```", "id": "4383433"}]}