{"hands_on_practices": [{"introduction": "The most direct way to grasp the concept of an Elementary Flux Mode (EFM) is to compute it from first principles. This exercise challenges you to analyze a small, well-defined metabolic network and identify all its EFMs by direct inspection and application of the support-minimality criterion [@problem_id:4337330]. By working through this process, you will gain a concrete understanding of how EFMs represent the fundamental, non-decomposable steady-state pathways of a system.", "problem": "Consider a minimal intracellular conversion module in a mammalian cell involving three internal metabolites $A$, $B$, and $C$, with six exchange and transformation reactions. The stoichiometric matrix $S \\in \\mathbb{R}^{3 \\times 6}$ (rows ordered as $A$, $B$, $C$; columns ordered as reactions $v_{1},\\dots,v_{6}$) and the irreversibility pattern $I$ are given by\n$$\nS \\;=\\;\n\\begin{pmatrix}\n1 & -1 & 0 & 0 & -1 & 0 \\\\\n0 & 1 & -1 & 0 & 0 & -1 \\\\\n0 & 0 & 1 & -1 & 1 & 0\n\\end{pmatrix},\n\\qquad\nI \\;=\\; (1,\\,1,\\,1,\\,1,\\,1,\\,1),\n$$\nwhere $I_{i} = 1$ indicates reaction $i$ is irreversible, imposing $v_{i} \\ge 0$ for all $i \\in \\{1,\\dots,6\\}$. The reactions can be interpreted as follows: $v_{1}$ is uptake into $A$, $v_{2}$ is $A \\to B$, $v_{3}$ is $B \\to C$, $v_{4}$ is secretion from $C$, $v_{5}$ is $A \\to C$, and $v_{6}$ is secretion from $B$. Under the standard steady-state assumption for intracellular metabolites, the flux vector $v \\in \\mathbb{R}^{6}$ satisfies $S v = 0$ and $v \\ge 0$ componentwise.\n\nStarting from the fundamental definition that an Elementary Flux Mode (EFM) is a nonzero flux vector that lies in the flux cone $\\{v \\in \\mathbb{R}^{6} \\mid S v = 0,\\, v \\ge 0\\}$ and has minimal support with respect to set inclusion among feasible flux vectors, enumerate all EFMs of this network by inspection and verify minimality by testing all proper supports for feasibility. Provide the total number of EFMs as your final answer. Express your final answer as a unitless number. No rounding is required.", "solution": "The problem asks for the enumeration of all Elementary Flux Modes (EFMs) for a given metabolic network. The network's stoichiometry is described by the matrix $S \\in \\mathbb{R}^{3 \\times 6}$, and all reactions are irreversible.\n\nFirst, we establish the system of equations that define the flux cone. A flux vector $v = (v_1, v_2, v_3, v_4, v_5, v_6)^T$ must satisfy the steady-state condition $S v = 0$ and the non-negativity constraints $v_i \\ge 0$ for $i \\in \\{1, \\dots, 6\\}$.\n\nThe matrix equation $S v = 0$ translates to the following system of linear equations:\n1.  $v_1 - v_2 - v_5 = 0$\n2.  $v_2 - v_3 - v_6 = 0$\n3.  $v_3 - v_4 + v_5 = 0$\n\nAn Elementary Flux Mode (EFM) is a non-zero vector $v$ that satisfies these three equations and $v \\ge 0$, and whose support, $supp(v) = \\{i \\mid v_i \\neq 0\\}$, is minimal with respect to set inclusion. This means no other non-zero flux vector $v'$ exists such that $supp(v') \\subsetneq supp(v)$.\n\nThe problem suggests finding the EFMs \"by inspection,\" which corresponds to identifying the minimal, self-contained pathways from input to output. The only uptake reaction is $v_1$, so any EFM must have $v_1 > 0$. The secretion reactions are $v_4$ and $v_6$. Thus, any EFM must represent a pathway from the uptake of $A$ to the secretion of $B$ or $C$.\n\nWe identify three such simple pathways:\n\nPathway 1: $v_1 \\to v_2 \\to v_3 \\to v_4$. This corresponds to the overall conversion of external substrate to product $C$ via intermediate $B$. The active reactions are $v_1, v_2, v_3, v_4$. We assume $v_5=0$ and $v_6=0$.\nThe system of equations becomes:\n$v_1 - v_2 = 0 \\implies v_1 = v_2$\n$v_2 - v_3 = 0 \\implies v_2 = v_3$\n$v_3 - v_4 = 0 \\implies v_3 = v_4$\nThis leads to $v_1 = v_2 = v_3 = v_4$. Setting the flux to a normalized value of $1$, we obtain the candidate flux vector $e_1 = (1, 1, 1, 1, 0, 0)^T$. The support is $supp(e_1) = \\{1, 2, 3, 4\\}$.\n\nPathway 2: $v_1 \\to v_5 \\to v_4$. This is a direct conversion of $A$ to $C$. The active reactions are $v_1, v_5, v_4$. We assume $v_2=0, v_3=0, v_6=0$.\nThe system becomes:\n$v_1 - v_5 = 0 \\implies v_1 = v_5$\n$0 = 0$\n$-v_4 + v_5 = 0 \\implies v_4 = v_5$\nThis leads to $v_1 = v_5 = v_4$. For a normalized flux of $1$, we get the candidate vector $e_2 = (1, 0, 0, 1, 1, 0)^T$. The support is $supp(e_2) = \\{1, 4, 5\\}$.\n\nPathway 3: $v_1 \\to v_2 \\to v_6$. This pathway represents the conversion of external substrate to product $B$, which is then secreted. The active reactions are $v_1, v_2, v_6$. We assume $v_3=0, v_4=0, v_5=0$.\nThe system becomes:\n$v_1 - v_2 = 0 \\implies v_1 = v_2$\n$v_2 - v_6 = 0 \\implies v_2 = v_6$\n$0 = 0$\nThis leads to $v_1 = v_2 = v_6$. For a normalized flux of $1$, we get the candidate vector $e_3 = (1, 1, 0, 0, 0, 1)^T$. The support is $supp(e_3) = \\{1, 2, 6\\}$.\n\nNext, we must verify the minimality of the support for each candidate vector.\n\nFor $e_1$ with $supp(e_1) = \\{1, 2, 3, 4\\}$:\nIf we consider any proper subset of this support, the chain of reactions is broken. For example, let's test the support $\\{1, 2, 3\\}$ by setting $v_4=0$ (in addition to $v_5=0, v_6=0$). The third equation $v_3 - v_4 + v_5 = 0$ becomes $v_3=0$. This implies $v_2=v_3=0$ and $v_1=v_2=0$. Thus, only the zero flux is possible. This holds for any proper subset. Therefore, $supp(e_1)$ is minimal, and $e_1$ is an EFM.\n\nFor $e_2$ with $supp(e_2) = \\{1, 4, 5\\}$:\nLet's test the support $\\{1, 5\\}$ by setting $v_4=0$. The third equation $v_3 - v_4 + v_5 = 0$ (with $v_3=0$) becomes $v_5=0$. From the first equation, $v_1 - v_2 - v_5 = 0$ (with $v_2=0$), we get $v_1=v_5=0$. Again, only the zero flux is possible. This argument can be repeated for other proper subsets $\\{1, 4\\}$ and $\\{4, 5\\}$. Thus, $supp(e_2)$ is minimal, and $e_2$ is an EFM.\n\nFor $e_3$ with $supp(e_3) = \\{1, 2, 6\\}$:\nLet's test the support $\\{1, 2\\}$ by setting $v_6=0$. The second equation $v_2 - v_3 - v_6 = 0$ (with $v_3=0$) becomes $v_2=0$. The first equation $v_1 - v_2 - v_5 = 0$ (with $v_5=0$) gives $v_1=v_2=0$. Trivial flux only. This logic applies to all proper subsets. Thus, $supp(e_3)$ is minimal, and $e_3$ is an EFM.\n\nTo confirm that these are the *only* EFMs, we can solve the system of equations completely. We can express three dependent variables in terms of three free variables. Let's choose $v_4, v_5, v_6$ as free variables. From the equations:\n$v_3 = v_4 - v_5$\n$v_2 = v_3 + v_6 = v_4 - v_5 + v_6$\n$v_1 = v_2 + v_5 = (v_4 - v_5 + v_6) + v_5 = v_4 + v_6$\n\nThe non-negativity constraints $v_i \\ge 0$ impose conditions on the free variables:\n$v_4 \\ge 0, v_5 \\ge 0, v_6 \\ge 0$\n$v_3 \\ge 0 \\implies v_4 - v_5 \\ge 0 \\implies v_4 \\ge v_5$\n$v_2 \\ge 0 \\implies v_4 - v_5 + v_6 \\ge 0$ (This is automatically satisfied if $v_4 \\ge v_5$ and $v_6 \\ge 0$)\n$v_1 \\ge 0 \\implies v_4 + v_6 \\ge 0$ (Automatically satisfied if $v_4 \\ge 0, v_6 \\ge 0$)\n\nThe feasible flux cone is described by vectors $v = (v_4+v_6, v_4-v_5+v_6, v_4-v_5, v_4, v_5, v_6)^T$ with $v_4 \\ge v_5 \\ge 0$ and $v_6 \\ge 0$.\nTo find the extreme rays (the EFMs), we can re-parameterize to eliminate the inequality constraint $v_4 \\ge v_5$. Let $\\gamma = v_4 - v_5 \\ge 0$. Then $v_4 = v_5 + \\gamma$. Let's use $v_5, v_6, \\gamma$ as non-negative parameters.\nLet $v_5 = \\alpha, v_6 = \\beta, \\gamma = \\delta$, with $\\alpha, \\beta, \\delta \\ge 0$.\nThen $v_4 = \\alpha + \\delta$. Substituting these into the expressions for the other variables:\n$v_1 = (\\alpha+\\delta) + \\beta = \\alpha + \\beta + \\delta$\n$v_2 = (\\alpha+\\delta) - \\alpha + \\beta = \\beta + \\delta$\n$v_3 = (\\alpha+\\delta) - \\alpha = \\delta$\n$v_4 = \\alpha + \\delta$\n$v_5 = \\alpha$\n$v_6 = \\beta$\n\nAny flux vector $v$ in the cone can be written as a non-negative linear combination of three vectors:\n$$\nv = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\\\ v_5 \\\\ v_6 \\end{pmatrix} =\n\\alpha \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} +\n\\beta \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} +\n\\delta \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe three vectors in this decomposition are precisely the vectors $e_2$, $e_3$, and $e_1$ we found by inspection (with $\\delta$ corresponding to $e_1$, $\\alpha$ to $e_2$, and $\\beta$ to $e_3$).\nThese vectors form the set of extreme rays of the flux cone. As we have already verified their minimal support property, they are the complete set of EFMs.\n\nThere are exactly three Elementary Flux Modes.\n1.  EFM 1: $e_1 = (1, 1, 1, 1, 0, 0)^T$\n2.  EFM 2: $e_2 = (1, 0, 0, 1, 1, 0)^T$\n3.  EFM 3: $e_3 = (1, 1, 0, 0, 0, 1)^T$\n\nThe question asks for the total number of EFMs. The total number is $3$.", "answer": "$$\\boxed{3}$$", "id": "4337330"}, {"introduction": "While enumerating EFMs is a key skill, a deeper understanding comes from appreciating the geometric structure of the flux space they inhabit. This practice explores the critical role of irreversibility constraints in shaping the feasible flux cone [@problem_id:4337289]. You will demonstrate how adding a single such constraint can transform a non-pointed cone into a pointed cone with a well-defined vertex, a necessary condition for defining EFMs as its unique extreme rays.", "problem": "Consider a minimal internal cycle in a metabolic network used for Elementary Flux Mode (EFM) analysis, comprising $3$ reactions among $3$ internal metabolites $A$, $B$, and $C$: reaction $1$ interconverts $A$ and $B$, reaction $2$ interconverts $B$ and $C$, and reaction $3$ interconverts $C$ and $A$. The stoichiometric matrix $S \\in \\mathbb{R}^{3 \\times 3}$, with rows ordered as $\\{A,B,C\\}$ and columns as $\\{1,2,3\\}$, is\n$$\nS \\;=\\; \\begin{pmatrix}\n-1 & 0 & 1 \\\\\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{pmatrix}.\n$$\nIn steady state, feasible fluxes $v \\in \\mathbb{R}^{3}$ must satisfy the mass balance equations $S v = 0$. Define the flux cone without any irreversibility constraints as $C_{0} = \\{ v \\in \\mathbb{R}^{3} \\mid S v = 0 \\}$. The lineality space $\\mathcal{L}(C)$ of a cone $C$ is defined by $\\mathcal{L}(C) = C \\cap (-C)$, and a cone is pointed if and only if $\\mathcal{L}(C) = \\{0\\}$. Now add a single irreversibility constraint on reaction $1$, requiring $v_{1} \\ge 0$, and define the constrained flux cone as $C_{1} = \\{ v \\in \\mathbb{R}^{3} \\mid S v = 0,\\; v_{1} \\ge 0 \\}$.\n\nUsing only the definitions of steady state ($S v = 0$), flux cone, and lineality space, and without invoking any shortcut formulas, determine the dimension of the lineality space $\\dim\\big(\\mathcal{L}(C_{1})\\big)$ after imposing $v_{1} \\ge 0$. Report the value of $\\dim\\big(\\mathcal{L}(C_{1})\\big)$ as a single integer with no units. No rounding is required.", "solution": "The problem requires the determination of the dimension of the lineality space, $\\dim\\big(\\mathcal{L}(C_{1})\\big)$, for the given constrained flux cone $C_{1}$. We shall proceed by applying the definitions provided in the problem statement.\n\nThe constrained flux cone is defined as $C_{1} = \\{ v \\in \\mathbb{R}^{3} \\mid S v = 0,\\; v_{1} \\ge 0 \\}$. The stoichiometric matrix $S$ and the flux vector $v$ are given by:\n$$\nS \\;=\\; \\begin{pmatrix}\n-1 & 0 & 1 \\\\\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{pmatrix}, \\quad v \\;=\\; \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix}\n$$\nThe lineality space of a cone $C$ is defined as $\\mathcal{L}(C) = C \\cap (-C)$. We apply this definition to the cone $C_{1}$.\nA vector $v$ belongs to the lineality space $\\mathcal{L}(C_{1})$ if and only if $v \\in C_{1}$ and $v \\in (-C_{1})$.\n\nLet us first characterize the conditions for a vector $v$ to be in $C_{1}$. According to the definition of $C_1$:\n1. $S v = 0$\n2. $v_{1} \\ge 0$\n\nNext, let us characterize the conditions for a vector $v$ to be in the set $-C_{1}$. A vector $v$ is in $-C_{1}$ if the vector $-v$ is in $C_{1}$. For $-v$ to be in $C_{1}$, it must satisfy the defining conditions of $C_{1}$:\n1. $S(-v) = 0$\n2. $(-v)_{1} \\ge 0$, where $(-v)_{1}$ is the first component of the vector $-v$.\n\nThe first condition, $S(-v) = 0$, simplifies to $-S v = 0$ due to the linearity of matrix multiplication, which is equivalent to $S v = 0$.\nThe second condition, $(-v)_{1} \\ge 0$, means $-v_{1} \\ge 0$, which is equivalent to $v_{1} \\le 0$.\nTherefore, the set $-C_{1}$ is given by $-C_{1} = \\{ v \\in \\mathbb{R}^{3} \\mid S v = 0,\\; v_{1} \\le 0 \\}$.\n\nNow, we find the intersection $C_{1} \\cap (-C_{1})$, which is the lineality space $\\mathcal{L}(C_{1})$. A vector $v$ is in $\\mathcal{L}(C_{1})$ if it satisfies the conditions for being in both $C_{1}$ and $-C_{1}$ simultaneously. These conditions are:\n1. $S v = 0$ (from $C_1$)\n2. $v_{1} \\ge 0$ (from $C_1$)\n3. $S v = 0$ (from $-C_1$, this is redundant)\n4. $v_{1} \\le 0$ (from $-C_1$)\n\nCombining all conditions, a vector $v \\in \\mathcal{L}(C_{1})$ must satisfy:\n- $S v = 0$\n- $v_{1} \\ge 0$ and $v_{1} \\le 0$\n\nThe two inequalities $v_{1} \\ge 0$ and $v_{1} \\le 0$ can only be simultaneously true if $v_1 = 0$.\nThus, the lineality space $\\mathcal{L}(C_{1})$ is the set of all vectors $v \\in \\mathbb{R}^{3}$ such that $S v = 0$ and $v_{1} = 0$.\n$$\n\\mathcal{L}(C_{1}) = \\{ v \\in \\mathbb{R}^{3} \\mid S v = 0,\\; v_{1} = 0 \\}\n$$\nWe now solve this system of linear equations. The equation $S v = 0$ corresponds to:\n$$\n\\begin{pmatrix}\n-1 & 0 & 1 \\\\\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\nv_1 \\\\\nv_2 \\\\\nv_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\nThis gives the system of equations:\n$$\n\\begin{cases}\n-v_{1} + v_{3} = 0 \\\\\nv_{1} - v_{2} = 0 \\\\\nv_{2} - v_{3} = 0\n\\end{cases}\n$$\nWe must also enforce the condition $v_{1}=0$. Substituting $v_{1}=0$ into the system gives:\n$$\n\\begin{cases}\n-0 + v_{3} = 0 & \\implies v_{3} = 0 \\\\\n0 - v_{2} = 0 & \\implies v_{2} = 0 \\\\\nv_{2} - v_{3} = 0\n\\end{cases}\n$$\nFrom the first equation, we find $v_{3} = 0$. From the second equation, we find $v_{2} = 0$. Substituting $v_{2} = 0$ and $v_{3} = 0$ into the third equation gives $0 - 0 = 0$, which is consistent.\nThe only solution to this system of equations is $v_1 = 0$, $v_2 = 0$, and $v_3 = 0$.\nThis means the only vector in the lineality space $\\mathcal{L}(C_{1})$ is the zero vector:\n$$\nv = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe lineality space is therefore the trivial vector space, which contains only the origin:\n$$\n\\mathcal{L}(C_{1}) = \\left\\{ \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\}\n$$\nThe dimension of a vector space is the number of vectors in any basis for that space. The basis for the trivial vector space is the empty set, and its dimension is defined to be $0$.\nTherefore, the dimension of the lineality space is $0$.\n$$\n\\dim\\big(\\mathcal{L}(C_{1})\\big) = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "4337289"}, {"introduction": "Elementary Flux Modes are not just a theoretical concept; they are a powerful tool for practical metabolic engineering. This hands-on computational exercise guides you through using EFMs to identify Minimal Cut Sets (MCSs)—minimal sets of reaction knockouts that disable a specific metabolic function [@problem_id:4337272]. By implementing an algorithm to find target-carrying EFMs and their minimal hitting sets, you will bridge the gap between abstract network analysis and concrete strategies for rational strain design.", "problem": "You are given a set of small, irreversible biochemical reaction networks in steady state and a target reaction index for each network. The task is to compute all elementary flux modes that carry a positive flux through the target reaction and then compute all minimal cut sets that block the target reaction by intersecting every such elementary flux mode. The final answer must be a complete, runnable program.\n\nFoundational base:\n- Steady state implies that the internal metabolite balances satisfy $S v = 0$, where $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix, $m$ is the number of internal metabolites, $n$ is the number of reactions, and $v \\in \\mathbb{R}^{n}$ is the flux vector.\n- Irreversible reactions impose $v \\ge 0$ component-wise.\n- An elementary flux mode (EFM) is defined as a nonzero feasible flux vector $v$ that satisfies $S v = 0$, $v \\ge 0$ for irreversible reactions, where the support $\\mathrm{supp}(v) = \\{ j \\in \\{0,\\dots,n-1\\} \\mid v_j \\ne 0 \\}$ is minimal with respect to set inclusion among all feasible flux vectors. Elementary flux modes are rays of the convex cone defined by $S v = 0$, $v \\ge 0$, and for an irreversible network, every active reaction in an elementary flux mode has strictly positive flux.\n- A minimal cut set (MCS) for a given target reaction is a minimal set of reactions whose removal blocks all feasible flux vectors with strictly positive flux through the target reaction. Equivalently, the MCSs are exactly the minimal hitting sets (also called minimal transversals) of the family of supports of all elementary flux modes that carry strictly positive flux through the target reaction. Here, a set $C$ is a hitting set of a family $\\mathcal{F}$ of sets if $C \\cap F \\ne \\emptyset$ for all $F \\in \\mathcal{F}$, and $C$ is minimal if no proper subset of $C$ is a hitting set.\n\nYour program must:\n1) Enumerate all supports of elementary flux modes that carry strictly positive flux through the given target reaction for each test network, adhering to $S v = 0$ and $v \\ge 0$.\n2) Compute all minimal hitting sets of these supports to obtain all minimal cut sets for blocking the target reaction.\n3) Return, for each test network, the set of minimal cut sets as a list of sorted lists of zero-based reaction indices, sorted lexicographically.\n\nFormalization of the feasibility and minimality checks:\n- For a candidate support $J \\subseteq \\{0,\\dots,n-1\\}$ that contains the target index $t$, feasibility means the existence of a vector $x \\in \\mathbb{R}^{|J|}$ with $x \\ge \\mathbf{1}$ such that $S_{:,J} x = 0$. Because the constraint is homogeneous, the existence of a strictly positive solution with $x &gt; 0$ is equivalent to the existence of one with $x \\ge \\mathbf{1}$ after appropriate scaling. This ensures that every reaction in the candidate support is truly active with strictly positive flux.\n- Support minimality means that no proper subset $K \\subset J$ admits a strictly positive solution to $S_{:,K} x = 0$ with $x &gt; 0$.\n\nInput specification within the program:\n- There are three test networks. For each case, you are provided the stoichiometric matrix $S$ and the zero-based target reaction index $t$. All reactions are irreversible and subject to $v \\ge 0$.\n\nTest suite:\n- Case A (branched pathway to product):\n  - Metabolites: $A, B, C$ ($m = 3$).\n  - Reactions (all irreversible, $n = 6$):\n    - $R_0$: $S_{\\mathrm{ext}} \\to A$: column $[1, 0, 0]^\\top$.\n    - $R_1$: $A \\to B$: column $[-1, 1, 0]^\\top$.\n    - $R_2$: $B \\to C$: column $[0, -1, 1]^\\top$.\n    - $R_3$: $C \\to P_{\\mathrm{ext}}$ (target): column $[0, 0, -1]^\\top$.\n    - $R_4$: $A \\to C$: column $[-1, 0, 1]^\\top$.\n    - $R_5$: $B \\to \\mathrm{waste}$: column $[0, -1, 0]^\\top$.\n  - Target index: $t = 3$.\n\n- Case B (two routes to target via a conversion step):\n  - Metabolites: $A, B, C$ ($m = 3$).\n  - Reactions (all irreversible, $n = 5$):\n    - $R_0$: $S_{\\mathrm{ext}} \\to A$: column $[1, 0, 0]^\\top$.\n    - $R_1$: $A \\to B$: column $[-1, 1, 0]^\\top$.\n    - $R_2$: $A \\to C$: column $[-1, 0, 1]^\\top$.\n    - $R_3$: $B \\to P_{\\mathrm{ext}}$ (target): column $[0, -1, 0]^\\top$.\n    - $R_4$: $C \\to B$: column $[0, 1, -1]^\\top$.\n  - Target index: $t = 3$.\n\n- Case C (infeasible target flux):\n  - Metabolites: $A$ ($m = 1$).\n  - Reactions (all irreversible, $n = 1$):\n    - $R_0$: $A \\to P_{\\mathrm{ext}}$ (target): column $[-1]^\\top$.\n  - Target index: $t = 0$.\n\nOutput specification:\n- For each test case, output the list of minimal cut sets as a list of sorted lists of zero-based reaction indices, with the following ordering conventions:\n  - Inside each minimal cut set, reaction indices must be in strictly increasing order.\n  - The collection of minimal cut sets for a test case must be sorted lexicographically by these lists.\n  - The overall program output must be a single line containing a list of the three per-case results in the given order Case A, Case B, Case C.\n- The final output must be a single line in the exact format of a Python list literal, for example: $[\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$.\n\nAnswer types:\n- Each per-case result is a list of lists of integers. The top-level result is a list of length $3$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC]\").", "solution": "The problem requires the computation of minimal cut sets (MCSs) for a target reaction in several small, irreversible biochemical networks. This task is broken down into two principal stages: first, the enumeration of all elementary flux modes (EFMs) that involve the target reaction, and second, the computation of all minimal hitting sets of the supports of these EFMs. The problem correctly states that these minimal hitting sets are precisely the MCSs.\n\nThe solution will be implemented as a Python program structured into several functions, each addressing a specific part of the problem.\n\n### Part 1: Enumeration of Target-Flux-Carrying Elementary Flux Modes\n\nAn elementary flux mode is defined by the minimality of its support—the set of reactions with non-zero flux. For an irreversible network, all reactions in an EFM have strictly positive flux. A support set $J$ corresponds to an EFM if and only if:\n1.  **Feasibility**: There exists a flux vector $v > 0$ with $\\mathrm{supp}(v) = J$ such that $S v = 0$. As specified, this can be tested by checking for the existence of a solution to the linear system $S_{:,J} x = 0$ with the constraint $x \\ge 1$, which is a standard linear programming feasibility problem. Let $k = |J|$, the system is finding $x \\in \\mathbb{R}^k$ such that $S_{:,J} x = 0$ and $x \\ge 1$. This can be solved using `scipy.optimize.linprog` by setting the objective function to zero.\n2.  **Minimality**: No proper subset of $J$ is also a feasible support.\n\nThe algorithm to find all EFM supports containing a target reaction $t$ is as follows:\n- Generate all possible reaction subsets $J$ that include the target reaction $t$. This is achieved by taking the power set of all other reactions and adding $t$ to each subset.\n- For each candidate support $J$, check for feasibility using `scipy.optimize.linprog`. Collect all feasible supports.\n- From the list of feasible supports, filter for minimality. A feasible support $J$ is minimal if no other feasible support $K$ is a proper subset of $J$. This filtering is performed efficiently by first sorting the feasible supports by size and then, for each candidate, checking if it is a superset of any already confirmed minimal support.\n\n### Part 2: Computation of Minimal Cut Sets (Minimal Hitting Sets)\n\nOnce the set of relevant EFM supports, $\\mathcal{F} = \\{E_1, E_2, \\dots, E_p\\}$, is determined, the next step is to compute their minimal hitting sets (MHSs). A set $C$ is a hitting set of $\\mathcal{F}$ if it has a non-empty intersection with every set in $\\mathcal{F}$ (i.e., $\\forall E_i \\in \\mathcal{F}, C \\cap E_i \\ne \\emptyset$). An MCS is a hitting set that is minimal with respect to set inclusion.\n\nThe computation of MHSs can be performed using an iterative procedure known as the transversal algorithm. The algorithm proceeds as follows:\n- Initialize the collection of MHSs with the MHS of an empty family, which is the set containing only the empty set: $\\mathcal{H}_0 = \\{\\emptyset\\}$.\n- Iteratively process each EFM support $E_i \\in \\mathcal{F}$:\n  - For each existing MHS $H \\in \\mathcal{H}_{i-1}$ and each reaction $r \\in E_i$, form a new candidate hitting set $H' = H \\cup \\{r\\}$.\n  - The new collection of candidates is $\\mathcal{H}'_i = \\{ H \\cup \\{r\\} \\mid H \\in \\mathcal{H}_{i-1}, r \\in E_i \\}$.\n  - The next set of MHSs, $\\mathcal{H}_i$, is obtained by retaining only the minimal sets from $\\mathcal{H}'_i$.\n- After iterating through all EFM supports, the final collection $\\mathcal{H}_p$ is the set of all MCSs.\n\nThis process correctly computes all MCSs. If the set of target-carrying EFMs is empty (as in Case C, where the target flux is infeasible), the family $\\mathcal{F}$ is empty. The minimal hitting set of an empty family is the empty set $\\emptyset$, as the condition for being a hitting set is vacuously satisfied. Therefore, the set of MCSs is $\\{\\emptyset\\}$, which will be represented as `[[]]`.\n\n### Final Output Formatting\n\nThe resulting list of MCSs for each test case is sorted according to the problem's specifications: each individual MCS (a list of reaction indices) is sorted in increasing order, and the list of all MCSs is sorted lexicographically. The results for all test cases are then aggregated into a single list and printed in a dense, single-line format.\n\nThe following Python program implements this complete logic.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom itertools import combinations\n\ndef _check_feasibility(S, support):\n    \"\"\"\n    Checks if a given support is feasible by solving a linear programming problem.\n    A support J is feasible if there exists a flux vector v > 0 with supp(v) = J.\n    This is equivalent to checking if the system S_J * x = 0 has a solution with x >= 1.\n    \"\"\"\n    if not support:\n        return False\n    \n    S_J = S[:, support]\n    m, k = S_J.shape\n\n    # We are solving a feasibility problem, so the objective function is irrelevant.\n    # min c^T * x, where c is a vector of zeros.\n    c = np.zeros(k)\n\n    # Constraints are S_J * x = 0 and x >= 1.\n    bounds = [(1, None)] * k\n\n    # Solve the linear program. The 'highs' method is robust.\n    # We only care about whether a solution was found (res.success).\n    res = linprog(c, A_eq=S_J, b_eq=np.zeros(m), bounds=bounds, method='highs')\n    \n    return res.success\n\ndef find_target_efms(S, t):\n    \"\"\"\n    Enumerates all elementary flux mode supports that include the target reaction 't'.\n    It first finds all feasible supports containing 't' and then filters for minimality.\n    \"\"\"\n    num_reactions = S.shape[1]\n    other_reactions = [r for r in range(num_reactions) if r != t]\n    \n    feasible_supports = []\n    \n    # Iterate over all subsets of other_reactions to form candidate supports with 't'.\n    for i in range(len(other_reactions) + 1):\n        for combo in combinations(other_reactions, i):\n            support_candidate = sorted(list(combo) + [t])\n            if _check_feasibility(S, support_candidate):\n                feasible_supports.append(support_candidate)\n\n    # Filter for minimal supports to get EFMs.\n    # Sorting by length allows for efficient checking of minimality.\n    feasible_supports.sort(key=len)\n    \n    efm_supports = []\n    for J in feasible_supports:\n        is_minimal = True\n        # A support J is not minimal if it's a superset of an already found EFM.\n        for K in efm_supports:\n            if set(K).issubset(set(J)):\n                is_minimal = False\n                break\n        if is_minimal:\n            efm_supports.append(J)\n            \n    return efm_supports\n\ndef _minimize_sets(list_of_sets):\n    \"\"\"\n    Given a list of sets (represented as lists), returns a new list\n    containing only the minimal sets with respect to subset inclusion.\n    \"\"\"\n    if not list_of_sets:\n        return []\n\n    # Use frozensets for hashing and efficient storage.\n    set_versions = {frozenset(s) for s in list_of_sets}\n    \n    # Sort by size for efficient subset checking.\n    sorted_sets = sorted(list(set_versions), key=len)\n    \n    minimal_sets = []\n    for s_i in sorted_sets:\n        is_minimal = True\n        for m_j in minimal_sets:\n            if m_j.issubset(s_i):\n                is_minimal = False\n                break\n        if is_minimal:\n            minimal_sets.append(s_i)\n            \n    # Convert back to sorted lists of integers.\n    return [sorted(list(s)) for s in minimal_sets]\n\ndef compute_minimal_hitting_sets(family_of_sets):\n    \"\"\"\n    Computes all minimal hitting sets (transversals) for a family of sets\n    using an iterative transversal algorithm.\n    \"\"\"\n    # The minimal hitting set of an empty family is {emptyset}.\n    mhs = [[]]\n    \n    for s in family_of_sets:\n        new_mhs = []\n        for h in mhs:\n            for element in s:\n                # Form a new candidate hitting set by adding an element from the current set 's'.\n                new_h = h + [element]\n                new_mhs.append(new_h)\n        # Prune the generated candidates to keep only minimal ones for the next iteration.\n        mhs = _minimize_sets(new_mhs)\n        \n    return mhs\n\ndef compute_overall_mcs_for_case(S, t):\n    \"\"\"\n    Orchestrates the computation of MCS for a single network case.\n    1. Finds target-carrying EFMs.\n    2. Computes the minimal hitting sets of their supports.\n    3. Sorts the result as specified.\n    \"\"\"\n    # 1. Enumerate supports of elementary flux modes that use the target reaction.\n    efm_supports = find_target_efms(S, t)\n\n    # 2. Compute minimal hitting sets, which are the minimal cut sets.\n    mcs_list = compute_minimal_hitting_sets(efm_supports)\n    \n    # 3. Sort the final list of MCSs lexicographically.\n    mcs_list.sort()\n    \n    return mcs_list\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the computation, and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    \n    # Case A: Branched pathway to product\n    S_A = np.array([\n        [1., -1., 0., 0., -1., 0.],\n        [0., 1., -1., 0., 0., -1.],\n        [0., 0., 1., -1., 1., 0.]\n    ])\n    t_A = 3\n\n    # Case B: Two routes to target via a conversion step\n    S_B = np.array([\n        [1., -1., -1., 0., 0.],\n        [0., 1., 0., -1., 1.],\n        [0., 0., 1., 0., -1.]\n    ])\n    t_B = 3\n\n    # Case C: Infeasible target flux\n    S_C = np.array([[-1.]])\n    t_C = 0\n\n    test_cases = [ (S_A, t_A), (S_B, t_B), (S_C, t_C) ]\n\n    results = []\n    for S, t in test_cases:\n        result = compute_overall_mcs_for_case(S, t)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The string representation is modified to remove spaces for a compact output.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "4337272"}]}