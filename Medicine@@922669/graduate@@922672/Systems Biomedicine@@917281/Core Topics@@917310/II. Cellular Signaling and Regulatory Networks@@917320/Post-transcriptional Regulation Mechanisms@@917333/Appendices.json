{"hands_on_practices": [{"introduction": "A cornerstone of systems biology is the ability to translate complex biological processes into predictive mathematical models. This first exercise provides practice in this fundamental skill by starting from the first principles of mass-action kinetics. You will construct a dynamic model of the mRNA lifecycle, from transcription and processing in the nucleus to its eventual decay in the cytoplasm, to derive the factors that determine its final concentration [@problem_id:4376249]. This practice illustrates how a seemingly complex multi-step process can lead to a surprisingly simple and elegant steady-state outcome.", "problem": "Consider a two-compartment post-transcriptional regulation model in a single cell within the systems biomedicine framework. In the nuclear compartment, newly synthesized unprocessed precursor messenger ribonucleic acid (pre-mRNA) molecules are produced at transcription rate $\\alpha$ (units: molecules per unit time). These nuclear pre-mRNA molecules are processed to mature nuclear messenger ribonucleic acid (mRNA) at a first-order nuclear processing rate $k_{p}$ (units: per unit time). Mature nuclear mRNA is exported to the cytoplasm at a first-order export rate $k_{e}$ (units: per unit time). In the cytoplasmic compartment, mature mRNA is degraded at a first-order cytoplasmic decay rate $\\delta$ (units: per unit time). Assume the following foundational bases:\n- The Central Dogma of molecular biology establishes that messenger ribonucleic acid (mRNA) is synthesized from deoxyribonucleic acid (DNA), processed, and exported to the cytoplasm where it can be translated and degraded.\n- Under mass-action kinetics, the instantaneous rate of each unimolecular transition is proportional to the abundance of the substrate species involved, with proportionality constants given by the rate parameters.\n\nUse these bases to formulate a dynamical system for the abundances of nuclear pre-mRNA, mature nuclear mRNA, and cytoplasmic mature mRNA, treating the abundances as absolute molecule counts. Assume all parameters $\\alpha$, $k_{p}$, $k_{e}$, and $\\delta$ are positive constants, there is no nuclear degradation, and the system reaches a time-invariant steady state.\n\nStarting from the mass-action dynamical system you construct, derive the steady-state abundance of cytoplasmic mature mRNA as a closed-form analytic expression in terms of $\\alpha$, $k_{p}$, $k_{e}$, and $\\delta$. Express the final abundance in molecules. Provide your answer as a single closed-form expression and do not include units inside the expression. No numerical evaluation or rounding is required.", "solution": "The problem requires the derivation of the steady-state abundance of cytoplasmic mature messenger ribonucleic acid (mRNA) based on a two-compartment model of post-transcriptional regulation. The problem is valid as it is scientifically grounded in molecular biology, well-posed, and objective. It provides a complete set of parameters and constraints to formulate a solvable mathematical model.\n\nFirst, we define the variables representing the abundances (absolute molecule counts) of the species in the system as functions of time $t$.\nLet $P(t)$ be the abundance of nuclear pre-mRNA.\nLet $N(t)$ be the abundance of mature nuclear mRNA.\nLet $C(t)$ be the abundance of cytoplasmic mature mRNA.\n\nThe problem statement describes the following processes, which we translate into a system of ordinary differential equations (ODEs) based on the principle of mass-action kinetics:\n\n1.  **Nuclear pre-mRNA ($P(t)$):** Pre-mRNA is produced at a constant transcription rate $\\alpha$. It is consumed by being processed into mature nuclear mRNA at a first-order rate $k_{p}$, meaning the rate of consumption is $k_{p}P(t)$. The problem specifies no other production or consumption terms for $P(t)$.\n    The rate of change of $P(t)$ is given by:\n    $$ \\frac{dP}{dt} = \\alpha - k_{p}P(t) $$\n\n2.  **Mature nuclear mRNA ($N(t)$):** Mature nuclear mRNA is produced from the processing of pre-mRNA at a rate of $k_{p}P(t)$. It is consumed by being exported to the cytoplasm at a first-order rate $k_{e}$, meaning the rate of consumption is $k_{e}N(t)$. The problem states to assume no nuclear degradation.\n    The rate of change of $N(t)$ is given by:\n    $$ \\frac{dN}{dt} = k_{p}P(t) - k_{e}N(t) $$\n\n3.  **Cytoplasmic mature mRNA ($C(t)$):** Cytoplasmic mRNA is produced from the export of mature nuclear mRNA at a rate of $k_{e}N(t)$. It is consumed by degradation at a first-order rate $\\delta$, meaning the rate of consumption is $\\delta C(t)$.\n    The rate of change of $C(t)$ is given by:\n    $$ \\frac{dC}{dt} = k_{e}N(t) - \\delta C(t) $$\n\nThe problem asks for the steady-state abundance. At steady state, the system is time-invariant, which implies that the rate of change for each species is zero. We denote the steady-state abundances as $P_{ss}$, $N_{ss}$, and $C_{ss}$.\n$$ \\frac{dP}{dt} = 0, \\quad \\frac{dN}{dt} = 0, \\quad \\frac{dC}{dt} = 0 $$\n\nWe solve the resulting system of algebraic equations sequentially.\n\nFrom the equation for $P(t)$, we have:\n$$ 0 = \\alpha - k_{p}P_{ss} $$\nSolving for $P_{ss}$ yields:\n$$ k_{p}P_{ss} = \\alpha $$\n$$ P_{ss} = \\frac{\\alpha}{k_{p}} $$\n\nNext, we use the steady-state equation for $N(t)$:\n$$ 0 = k_{p}P_{ss} - k_{e}N_{ss} $$\n$$ k_{e}N_{ss} = k_{p}P_{ss} $$\nWe substitute the expression for $P_{ss}$ that we just found:\n$$ k_{e}N_{ss} = k_{p}\\left(\\frac{\\alpha}{k_{p}}\\right) = \\alpha $$\nSolving for $N_{ss}$ yields:\n$$ N_{ss} = \\frac{\\alpha}{k_{e}} $$\n\nFinally, we use the steady-state equation for $C(t)$ to find the desired quantity, $C_{ss}$:\n$$ 0 = k_{e}N_{ss} - \\delta C_{ss} $$\n$$ \\delta C_{ss} = k_{e}N_{ss} $$\nWe substitute the expression for $N_{ss}$:\n$$ \\delta C_{ss} = k_{e}\\left(\\frac{\\alpha}{k_{e}}\\right) = \\alpha $$\nSolving for $C_{ss}$ gives the steady-state abundance of cytoplasmic mature mRNA:\n$$ C_{ss} = \\frac{\\alpha}{\\delta} $$\n\nThis result indicates that at steady state, the total rate of production of mRNA ($\\alpha$) is exactly balanced by the total rate of degradation ($\\delta C_{ss}$). The intermediate processing and export steps, governed by rates $k_p$ and $k_e$, determine the steady-state levels of the precursor species but do not influence the final steady-state level of the cytoplasmic mRNA, provided that the pathway is linear and irreversible as specified.", "answer": "$$\\boxed{\\frac{\\alpha}{\\delta}}$$", "id": "4376249"}, {"introduction": "Building on the principles of kinetic modeling, this next practice challenges you to connect theoretical parameters to real-world experimental data. Modern studies of gene regulation rely on high-throughput methods like RNA-sequencing and ribosome profiling, which provide a snapshot of the transcriptome and translatome. This exercise asks you to predict the distinct signatures these methods would produce when specific post-transcriptional control points—such as translation initiation or mRNA decay—are perturbed [@problem_id:4376234]. Mastering this connection between underlying mechanisms and experimental observables is essential for designing experiments and interpreting genomic data.", "problem": "A cell line is subjected to three independent perturbations that selectively alter post-transcriptional parameters while keeping transcription initiation unchanged. Let $\\alpha$ denote the transcriptional synthesis rate of mature messenger ribonucleic acid (mRNA), $\\delta$ the first-order mRNA decay rate, $k_p$ the average translation initiation rate per mRNA (new ribosome loading events per unit time), and $k_e$ the average elongation rate (codons per unit time). Assume that the coding sequence has fixed length $L_c$ (codons), that translation termination is not rate-limiting, that ribosome drop-off is negligible, and that ribosome crowding does not saturate initiation (initiation-limited or dilute-traffic regime). Also assume that the system reaches quasi-steady state for mRNA abundance and ribosome loading after each perturbation, and that transcriptional initiation remains constant, i.e., $\\alpha$ is unchanged across conditions.\n\nThe three perturbations are:\n- P1: Selective increase in $k_p$ with $k_e$ and $\\delta$ unchanged.\n- P2: Selective decrease in $k_e$ with $k_p$ and $\\delta$ unchanged.\n- P3: Selective increase in $\\delta$ with $k_p$ and $k_e$ unchanged.\n\nYou collect RNA sequencing (RNA-seq) and ribosome profiling (Ribo-seq) data after each perturbation. For each gene, denote by $M$ the RNA-seq exonic readout proportional to mature mRNA abundance, by $R$ the Ribo-seq ribosome footprint readout proportional to the total number of ribosomes bound to coding sequences, and by $\\mathrm{TE}$ the translation efficiency computed as the ratio $R/M$. As a proxy for transcriptional initiation changes, you also monitor the intronic read fraction from RNA-seq; increases in intronic reads indicate changes in nascent transcription.\n\nBased on definitions, conservation principles, and steady-state arguments for mRNA and translating ribosomes, select all options that describe joint RNA-seq and Ribo-seq signatures that are consistent with post-transcriptional control under the stated perturbations and with $\\alpha$ constant.\n\nA. Under P1, $M$ remains approximately constant, $R$ increases across coding regions without pronounced $5'$ pile-up, $\\mathrm{TE}$ increases, and intronic reads remain unchanged.\n\nB. Under P3, $M$ decreases, $R$ decreases proportionally so that $\\mathrm{TE}$ remains approximately unchanged, ribosome density per mRNA is similar, and intronic reads remain unchanged.\n\nC. Under P2, $M$ remains approximately constant, $R$ increases with evidence of slower elongation (e.g., higher ribosome density and site-specific accumulations), $\\mathrm{TE}$ increases, and intronic reads remain unchanged.\n\nD. A pattern of increased intronic read fraction in RNA-seq, proportional increases in $M$ and $R$, and unchanged $\\mathrm{TE}$ indicates $\\alpha$ increased while post-transcriptional parameters were unchanged; this is consistent with the stated premise that $\\alpha$ is constant and post-transcriptional control dominates.\n\nSelect all that apply.", "solution": "This problem requires predicting the observable effects of specific post-transcriptional perturbations on RNA-seq and Ribo-seq data. To do this, we first establish the mathematical relationships between the model parameters ($\\alpha$, $\\delta$, $k_p$, $k_e$) and the experimental readouts ($M$, $R$, $\\mathrm{TE}$).\n\n1.  **mRNA Abundance ($M$)**: The steady-state abundance of an mRNA species ($m_{ss}$) is determined by the balance between its synthesis rate ($\\alpha$) and its decay rate ($\\delta$). The governing equation is $\\frac{dm}{dt} = \\alpha - \\delta m$. At steady state ($\\frac{dm}{dt}=0$), we have $m_{ss} = \\frac{\\alpha}{\\delta}$. The RNA-seq readout $M$ is proportional to this abundance, so $M \\propto \\frac{\\alpha}{\\delta}$.\n\n2.  **Ribosome Footprint Count ($R$)**: The Ribo-seq readout $R$ is proportional to the total number of ribosomes translating a given mRNA species. This total is the product of the number of mRNA molecules ($m_{ss}$) and the average number of ribosomes per mRNA molecule. The number of ribosomes on a single mRNA is given by the initiation rate ($k_p$) multiplied by the time a ribosome spends on the transcript (the transit time, $\\tau_{transit}$). The transit time is the length of the coding sequence ($L_c$) divided by the elongation rate ($k_e$), so $\\tau_{transit} = \\frac{L_c}{k_e}$.\n    Therefore, the total number of ribosomes is $N_{ribo} = m_{ss} \\times \\left(k_p \\times \\frac{L_c}{k_e}\\right)$.\n    Substituting $m_{ss} = \\frac{\\alpha}{\\delta}$, we get $N_{ribo} = \\frac{\\alpha}{\\delta} \\times k_p \\times \\frac{L_c}{k_e}$.\n    Since $R \\propto N_{ribo}$ and $L_c$ is a constant for a given gene, we have $R \\propto \\frac{\\alpha \\cdot k_p}{\\delta \\cdot k_e}$.\n\n3.  **Translation Efficiency ($\\mathrm{TE}$)**: $\\mathrm{TE}$ is defined as the ratio $R/M$. Using the proportionalities derived above:\n    $$ \\mathrm{TE} \\propto \\frac{R}{M} \\propto \\frac{\\frac{\\alpha \\cdot k_p}{\\delta \\cdot k_e}}{\\frac{\\alpha}{\\delta}} = \\frac{k_p}{k_e} $$\n\n4.  **Intronic Reads**: These are used as a proxy for the rate of nascent transcription, $\\alpha$. If $\\alpha$ is constant, intronic read levels should be unchanged.\n\nNow we evaluate each option based on the premise that $\\alpha$ is constant and only the specified post-transcriptional parameter changes.\n\n-   **A. Perturbation P1 ($k_p \\uparrow$; $\\delta, k_e$ constant)**:\n    -   $M \\propto \\frac{\\alpha}{\\delta}$: Unchanged.\n    -   $R \\propto \\frac{\\alpha \\cdot k_p}{\\delta \\cdot k_e}$: Increases, as $k_p$ increases.\n    -   $\\mathrm{TE} \\propto \\frac{k_p}{k_e}$: Increases, as $k_p$ increases.\n    -   Intronic reads: Unchanged, as $\\alpha$ is constant.\n    -   This matches the description in option A. **Therefore, A is correct.**\n\n-   **B. Perturbation P3 ($\\delta \\uparrow$; $k_p, k_e$ constant)**:\n    -   $M \\propto \\frac{\\alpha}{\\delta}$: Decreases, as $\\delta$ increases.\n    -   $R \\propto \\frac{\\alpha \\cdot k_p}{\\delta \\cdot k_e}$: Decreases, as $\\delta$ increases. The change is proportional to the change in $M$.\n    -   $\\mathrm{TE} \\propto \\frac{k_p}{k_e}$: Unchanged.\n    -   Ribosome density per mRNA is proportional to $\\frac{k_p}{k_e}$ and is therefore unchanged.\n    -   Intronic reads: Unchanged, as $\\alpha$ is constant.\n    -   This matches the description in option B. **Therefore, B is correct.**\n\n-   **C. Perturbation P2 ($k_e \\downarrow$; $\\delta, k_p$ constant)**:\n    -   $M \\propto \\frac{\\alpha}{\\delta}$: Unchanged.\n    -   $R \\propto \\frac{\\alpha \\cdot k_p}{\\delta \\cdot k_e}$: Increases, as $k_e$ decreases.\n    -   $\\mathrm{TE} \\propto \\frac{k_p}{k_e}$: Increases, as $k_e$ decreases.\n    -   Slower elongation ($k_e \\downarrow$) increases ribosome transit time, leading to higher ribosome density on the transcript.\n    -   Intronic reads: Unchanged, as $\\alpha$ is constant.\n    -   This matches the description in option C. **Therefore, C is correct.**\n\n-   **D. Analysis of the statement**: This option describes a scenario where intronic reads increase, which signifies an increase in transcription rate ($\\alpha \\uparrow$). It correctly deduces that if post-transcriptional parameters are constant, $M$ and $R$ will increase proportionally, and $\\mathrm{TE}$ will be unchanged. This accurately describes a transcriptional change. However, the statement concludes that this signature \"is consistent with the stated premise that $\\alpha$ is constant and post-transcriptional control dominates.\" This is a logical contradiction. The evidence described (increased intronic reads) directly refutes the premise of constant $\\alpha$. **Therefore, D is incorrect.**", "answer": "$$\\boxed{ABC}$$", "id": "4376234"}, {"introduction": "The final practice moves into the advanced realm of computational systems biology, where a key challenge is to infer regulatory relationships from complex observational data. In biological systems, it is rare for only one parameter to change, and simple correlations can be misleading due to confounding variables. This exercise introduces a principled approach using causal graphical models to disentangle direct regulatory effects from indirect, mediated effects and confounding influences [@problem_id:4376240]. By implementing a regression-based causal model, you will practice a powerful technique for moving beyond correlation to infer the specific regulatory functions of an RNA-binding protein.", "problem": "You are given per-transcript measurements relevant to post-transcriptional regulation by a specific RNA-binding protein (RBP). The goal is to infer causal regulatory effects from observed features using a principled model that accounts for measured confounders. The scientific base includes the Central Dogma of Molecular Biology, the definition of messenger ribonucleic acid (mRNA) half-life as the expected time until degradation, and ribosome density as a proxy for translation efficiency, together with standard causal graphical modeling assumptions. Enhanced CrossLinking and ImmunoPrecipitation (eCLIP) occupancy is used as a proxy for the probability of RBP binding on a transcript. All changes are defined as differences relative to appropriate matched controls, so that residual baseline offsets are effectively zero and intercepts can be omitted.\n\nAssume there exist measured confounders that jointly affect eCLIP occupancy, mRNA half-life change, and ribosome density change. Let the variables be:\n- eCLIP occupancy $O$ (scaled in $[0,1]$, unitless),\n- mRNA half-life change $H$ (log$_2$ fold-change, unitless),\n- ribosome density change $R$ (log$_2$ fold-change, unitless),\n- a vector of measured confounders $C = (C_1, C_2)$ (unitless).\n\nYou are to assume the following linear structural equations with independent, zero-mean noise terms and no intercepts (because all variables are changes relative to control):\n- $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$ with $\\mathbb{E}[\\varepsilon_H \\mid O, C] = 0$,\n- $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$ with $\\mathbb{E}[\\varepsilon_R \\mid O, H, C] = 0$.\n\nUnder the back-door criterion, when conditioning on measured confounders $C$, the causal effect of $O$ on $H$ is identified by the partial regression coefficient $\\beta_{OH}$. Under standard identifiability conditions for controlled direct effects, the direct causal effect of $O$ on $R$ not mediated by $H$ is identified by the partial regression coefficient $\\gamma_{OR}$ in a multiple regression of $R$ on $(O, H, C)$.\n\nYour task is to implement a program that, for each provided dataset, estimates:\n- the adjusted causal effect of eCLIP occupancy on half-life, $\\beta_{OH}$, via least squares regression of $H$ on $(O, C_1, C_2)$ without an intercept, and\n- the adjusted direct causal effect of eCLIP occupancy on ribosome density, $\\gamma_{OR}$, via least squares regression of $R$ on $(O, H, C_1, C_2)$ without an intercept.\n\nAll datasets are small, deterministic, and scientifically plausible. They are designed to satisfy linearity and to include slight noise terms to avoid exact collinearity, while keeping the results interpretable. Each dataset corresponds to transcripts indexed by $i = 1, \\dots, n$.\n\nTest suite. For each case below, use the exact arrays as given. All numbers are unitless.\n\nCase A (general, identifiable, mediated and direct effects present):\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.01,\\,0.39,\\,0.82,\\,-0.02,\\,0.40,\\,0.81\\,]$\n- $R$: $[\\,0.087,\\,0.613,\\,1.174,\\,0.146,\\,0.70,\\,1.247\\,]$\n\nCase B (no direct effect on $R$, only mediated through $H$):\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.175,\\,0.505,\\,0.860,\\,0.330,\\,0.680,\\,1.025\\,]$\n- $R$: $[\\,0.090,\\,0.454,\\,0.838,\\,0.164,\\,0.544,\\,0.920\\,]$\n\nCase C (negative direct effect on $R$, weak effect on $H$):\n- $O$: $[\\,0.1,\\,0.3,\\,0.5,\\,0.7,\\,0.9\\,]$\n- $C_1$: $[\\,0,\\,1,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,0,\\,2,\\,1,\\,0\\,]$\n- $H$: $[\\, -0.19,\\,0.34,\\,-0.36,\\,0.17,\\,0.695\\,]$\n- $R$: $[\\,0.05,\\,0.05,\\,-0.05,\\,-0.05,\\,-0.05\\,]$\n\nAlgorithmic requirements:\n- For each case, construct the design matrices for the two regressions as specified, omitting the intercept column.\n- Use ordinary least squares to estimate coefficients. If the design matrix is not full rank, use the minimum-norm least squares solution returned by a numerically stable solver.\n- Extract $\\beta_{OH}$ as the coefficient multiplying $O$ in the model for $H$.\n- Extract $\\gamma_{OR}$ as the coefficient multiplying $O$ in the model for $R$.\n\nAngle units do not apply. There are no physical units; all quantities are dimensionless. Percentages must not be used; use decimals as given.\n\nOutput specification:\n- For each case, return a list with two floats $[\\,\\widehat{\\beta}_{OH},\\,\\widehat{\\gamma}_{OR}\\,]$, each rounded to three decimal places.\n- Aggregate the three case results into a single line printed by the program as a list of lists, with no extra text. The exact format must be:\n\"[ [bA,gA], [bB,gB], [bC,gC] ]\" but without spaces except those necessary to separate numbers by commas and brackets, and each number shown with exactly three decimal digits, for example: \"[[0.500,0.400],[0.600,0.000],[0.100,-0.500]]\".\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets as described above.", "solution": "The user has provided a problem in the domain of systems biomedicine, focusing on post-transcriptional gene regulation. The task is to estimate causal parameters from observational data using a specified linear structural model.\n\nThe problem has been validated and is determined to be sound. It is scientifically grounded in molecular biology and employs standard statistical methods for causal inference, specifically, regression analysis for adjusting for confounders. The problem is well-posed, objective, and provides all necessary data and specifications for a unique solution.\n\nThe core of the problem is to estimate two parameters, $\\beta_{OH}$ and $\\gamma_{OR}$, from a set of linear structural equations:\n1. $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$\n2. $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$\n\nwhere $O$ represents eCLIP occupancy, $H$ is mRNA half-life change, $R$ is ribosome density change, and $C=(C_1, C_2)$ is a vector of measured confounders. The models are to be fitted without an intercept, as all variables are defined as changes relative to a control.\n\nThe estimation method prescribed is Ordinary Least Squares (OLS). For a general linear model of the form $y = X\\beta + \\varepsilon$, the OLS estimator $\\hat{\\beta}$ for the parameter vector $\\beta$ is the vector that minimizes the sum of squared residuals, $\\|y - X\\hat{\\beta}\\|_2^2$. This is found by solving the normal equations $X^\\top X \\hat{\\beta} = X^\\top y$. A numerically stable way to solve this, which also handles cases where the design matrix $X$ is not of full column rank, is to use a solver based on Singular Value Decomposition (SVD), such as the `numpy.linalg.lstsq` function. This function returns the minimum-norm solution in rank-deficient cases, as required.\n\nWe must perform two separate regressions for each provided dataset.\n\nFirst, to estimate $\\beta_{OH}$, we consider the model for $H$:\n$$ H = \\beta_{OH} O + \\beta_{C_1H} C_1 + \\beta_{C_2H} C_2 + \\varepsilon_H $$\nThis corresponds to a linear regression problem where the response vector, $y_H$, is the set of observations for $H$. The design matrix, $X_H$, is constructed by arranging the observation vectors for $O$, $C_1$, and $C_2$ as its columns.\n$$ y_H = \\begin{pmatrix} H_1 \\\\ \\vdots \\\\ H_n \\end{pmatrix}, \\quad X_H = \\begin{pmatrix} O_1 & C_{1,1} & C_{2,1} \\\\ \\vdots & \\vdots & \\vdots \\\\ O_n & C_{1,n} & C_{2,n} \\end{pmatrix} $$\nThe vector of coefficients to be estimated is $\\beta_H = [\\beta_{OH}, \\beta_{C_1H}, \\beta_{C_2H}]^{\\top}$. By solving the linear system $X_H \\beta_H = y_H$ using least squares, we obtain the estimate $\\hat{\\beta}_H$. The desired parameter estimate, $\\widehat{\\beta}_{OH}$, is the first element of the vector $\\hat{\\beta}_H$.\n\nSecond, to estimate $\\gamma_{OR}$, we use the model for $R$:\n$$ R = \\gamma_{OR} O + \\gamma_{HR} H + \\gamma_{C_1R} C_1 + \\gamma_{C_2R} C_2 + \\varepsilon_R $$\nHere, the response vector, $y_R$, is the set of observations for $R$. The design matrix, $X_R$, is constructed from the observation vectors for $O$, $H$, $C_1$, and $C_2$. It is crucial to note that the *measured* values of $H$ are used as a predictor in this regression, consistent with the identification strategy for controlled direct effects.\n$$ y_R = \\begin{pmatrix} R_1 \\\\ \\vdots \\\\ R_n \\end{pmatrix}, \\quad X_R = \\begin{pmatrix} O_1 & H_1 & C_{1,1} & C_{2,1} \\\\ \\vdots & \\vdots & \\vdots & \\vdots \\\\ O_n & H_n & C_{1,n} & C_{2,n} \\end{pmatrix} $$\nThe coefficient vector is $\\gamma_R = [\\gamma_{OR}, \\gamma_{HR}, \\gamma_{C_1R}, \\gamma_{C_2R}]^{\\top}$. Solving the system $X_R \\gamma_R = y_R$ via least squares yields the estimate $\\hat{\\gamma}_R$. The direct causal effect estimate, $\\widehat{\\gamma}_{OR}$, is the first element of $\\hat{\\gamma}_R$.\n\nThis procedure is applied to each of the three provided cases (A, B, and C). The resulting estimates for $\\beta_{OH}$ and $\\gamma_{OR}$ are collected and rounded to three decimal places. The final implementation will automate this process for all test cases and format the output as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates causal effects from transcriptional data using OLS regression.\n\n    For each test case, the function performs two linear regressions without intercept:\n    1. Regresses H on (O, C1, C2) to find beta_OH.\n    2. Regresses R on (O, H, C1, C2) to find gamma_OR.\n\n    The results are formatted and printed as specified in the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.01, 0.39, 0.82, -0.02, 0.40, 0.81]),\n            'R': np.array([0.087, 0.613, 1.174, 0.146, 0.70, 1.247]),\n        },\n        {\n            'name': 'B',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.175, 0.505, 0.860, 0.330, 0.680, 1.025]),\n            'R': np.array([0.090, 0.454, 0.838, 0.164, 0.544, 0.920]),\n        },\n        {\n            'name': 'C',\n            'O': np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n            'C1': np.array([0, 1, 0, 1, 2]),\n            'C2': np.array([1, 0, 2, 1, 0]),\n            'H': np.array([-0.19, 0.34, -0.36, 0.17, 0.695]),\n            'R': np.array([0.05, 0.05, -0.05, -0.05, -0.05]),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract data for the current case\n        O, C1, C2, H, R = case['O'], case['C1'], case['C2'], case['H'], case['R']\n\n        # --- Regression 1: Estimate beta_OH ---\n        # Model: H = beta_OH*O + beta_C1H*C1 + beta_C2H*C2\n        # Design matrix X_H, response vector y_H = H\n        X_H = np.vstack([O, C1, C2]).T \n        \n        # Solve for coefficients using least squares.\n        # np.linalg.lstsq returns a tuple, the first element is the solution vector.\n        coeffs_H = np.linalg.lstsq(X_H, H, rcond=None)[0]\n        beta_OH = coeffs_H[0]\n\n        # --- Regression 2: Estimate gamma_OR ---\n        # Model: R = gamma_OR*O + gamma_HR*H + gamma_C1R*C1 + gamma_C2R*C2\n        # Design matrix X_R, response vector y_R = R\n        X_R = np.vstack([O, H, C1, C2]).T\n\n        # Solve for coefficients using least squares.\n        coeffs_R = np.linalg.lstsq(X_R, R, rcond=None)[0]\n        gamma_OR = coeffs_R[0]\n        \n        all_results.append((beta_OH, gamma_OR))\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to three decimal places.\n    # The final string is a list of lists, e.g., [[bA,gA],[bB,gB],...].\n    results_str_list = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in all_results]\n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "4376240"}]}