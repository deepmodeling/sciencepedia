{"hands_on_practices": [{"introduction": "This first exercise is a fundamental building block in quantitative biology. It challenges you to derive the complete time-course of gene expression from first principles, combining the equilibrium statistical mechanics of transcription factor binding with the kinetics of messenger RNA (mRNA) synthesis and degradation. By solving this, you will construct the dynamic response of a gene to a constant stimulus, a core model used throughout systems biology [@problem_id:4393067].", "problem": "A single gene in a mammalian cell nucleus is regulated by an activator transcription factor (TF). The promoter has $n$ identical binding sites that behave in an all-or-none cooperative manner: the promoter is transcriptionally active if and only if all $n$ sites are occupied by TF. Assume that transcription factor binding and unbinding to the promoter reach thermodynamic equilibrium on a timescale that is fast compared to messenger ribonucleic acid (mRNA) synthesis and degradation. The gene produces mRNA with a synthesis rate proportional to the probability that the promoter is in the active state, and mRNA is degraded by first-order kinetics. Starting from core physical chemistry and biochemistry principles—mass-action binding equilibrium for the promoter–TF interaction, the law of detailed balance, and the central dogma (Deoxyribonucleic Acid (DNA) is transcribed to mRNA)—derive the closed-form expression for the mRNA time course $x(t)$ when the TF concentration is clamped to a constant value $\\bar{T}$ at time $t=0$ and the initial mRNA is $x(0)=0$.\n\nAssume the following:\n- The dissociation constant for a single TF binding site is $K$.\n- Cooperative binding is effectively all-or-none: the active promoter state requires simultaneous occupation by $n$ TF molecules.\n- The mRNA synthesis rate constant is $k_{\\mathrm{tr}}$ (in molecules per cell per unit time), proportional to the probability the promoter is active.\n- The mRNA degradation rate constant is $\\gamma$ (in per unit time).\n- The TF concentration $\\bar{T}$ and dissociation constant $K$ are expressed in the same concentration units.\n- Express the final mRNA concentration function $x(t)$ in molecules per cell.\n\nYour answer must be a single closed-form analytic expression for $x(t)$ in terms of $k_{\\mathrm{tr}}$, $\\gamma$, $\\bar{T}$, $K$, $n$, and $t$. Do not present an inequality, equation to be solved, or a numerical value. No rounding is required.", "solution": "The problem requires the derivation of the time course of messenger ribonucleic acid (mRNA) concentration, denoted by $x(t)$, for a gene regulated by an activator transcription factor (TF). The derivation must be based on first principles of biochemistry and physical chemistry.\n\nFirst, we model the state of the gene's promoter. The problem states that the promoter has $n$ identical binding sites for the TF and that binding is an \"all-or-none cooperative manner\". This means we can model the promoter as existing in only two states: a free, inactive state ($P_{\\text{free}}$) and a fully bound, active state where all $n$ sites are occupied ($P_{\\text{active}}$). Intermediate states with partial occupancy are considered negligible. The reversible binding reaction is:\n$$ P_{\\text{free}} + nT \\rightleftharpoons P_{\\text{active}} $$\nwhere $T$ represents the TF molecule.\n\nThe problem states that this binding-unbinding process reaches thermodynamic equilibrium rapidly compared to the timescales of transcription and translation. We can therefore apply the law of mass action to this equilibrium. The overall dissociation constant, $K_{D}$, for this reaction is given by:\n$$ K_{D} = \\frac{[P_{\\text{free}}][T]^{n}}{[P_{\\text{active}}]} $$\nwhere $[...]$ denotes concentration.\n\nThe problem provides a dissociation constant $K$ for a single TF binding site. For an \"all-or-none\" or perfectly cooperative process involving $n$ identical sites, the overall dissociation constant $K_{D}$ is related to the single-site constant $K$ by $K_{D} = K^{n}$. This is a standard assumption in modeling high-cooperativity systems, reflecting the multiplicative effect of individual binding affinities in a concerted binding event. Substituting this into our equilibrium equation gives:\n$$ K^{n} = \\frac{[P_{\\text{free}}][T]^{n}}{[P_{\\text{active}}]} $$\n\nThe promoter is transcriptionally active only when it is in the $P_{\\text{active}}$ state. The probability of the promoter being active, $p_{\\text{active}}$, is the fraction of the total promoter population that is in the active state:\n$$ p_{\\text{active}} = \\frac{[P_{\\text{active}}]}{[P_{\\text{total}}]} = \\frac{[P_{\\text{active}}]}{[P_{\\text{free}}] + [P_{\\text{active}}]} $$\nFrom the equilibrium expression, we can express $[P_{\\text{free}}]$ in terms of $[P_{\\text{active}}]$:\n$$ [P_{\\text{free}}] = [P_{\\text{active}}] \\frac{K^{n}}{[T]^{n}} $$\nSubstituting this into the equation for $p_{\\text{active}}$:\n$$ p_{\\text{active}} = \\frac{[P_{\\text{active}}]}{[P_{\\text{active}}] \\frac{K^{n}}{[T]^{n}} + [P_{\\text{active}}]} $$\nBy canceling the $[P_{\\text{active}}]$ term from the numerator and denominator, we obtain:\n$$ p_{\\text{active}} = \\frac{1}{\\frac{K^{n}}{[T]^{n}} + 1} = \\frac{[T]^{n}}{K^{n} + [T]^{n}} $$\nThis is the well-known Hill function, describing the probabilistic response of the promoter to TF concentration. The problem states that the TF concentration is clamped at a constant value $\\bar{T}$ for $t \\ge 0$. Therefore, the probability of activation is constant in time:\n$$ p_{\\text{active}} = \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} $$\n\nNext, we formulate the differential equation governing the mRNA concentration, $x(t)$. The rate of change of $x(t)$ is the difference between its synthesis rate and its degradation rate.\n$$ \\frac{dx}{dt} = (\\text{synthesis rate}) - (\\text{degradation rate}) $$\nThe synthesis rate is given as proportional to the probability of the promoter being active, with a rate constant $k_{\\mathrm{tr}}$.\n$$ \\text{synthesis rate} = k_{\\mathrm{tr}} \\cdot p_{\\text{active}} = k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} $$\nThe degradation of mRNA follows first-order kinetics with a rate constant $\\gamma$.\n$$ \\text{degradation rate} = \\gamma x(t) $$\nCombining these terms, we have the following first-order linear ordinary differential equation (ODE):\n$$ \\frac{dx}{dt} = k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} - \\gamma x(t) $$\nLet the constant synthesis term be denoted by $C_S = k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}}$. The ODE becomes:\n$$ \\frac{dx}{dt} + \\gamma x(t) = C_S $$\nThis is a standard form of a linear ODE. The general solution can be found using an integrating factor or by summing the homogeneous and particular solutions. The homogeneous solution to $\\frac{dx_h}{dt} + \\gamma x_h = 0$ is $x_h(t) = A \\exp(-\\gamma t)$, where $A$ is an integration constant. For the particular solution, since the right-hand side is constant, we can assume a constant particular solution $x_p(t) = B$. Substituting this into the ODE gives $0 + \\gamma B = C_S$, so $B = \\frac{C_S}{\\gamma}$.\nThe general solution is the sum of the homogeneous and particular solutions:\n$$ x(t) = x_h(t) + x_p(t) = A \\exp(-\\gamma t) + \\frac{C_S}{\\gamma} $$\n\nTo determine the constant $A$, we apply the initial condition specified in the problem: $x(0) = 0$.\n$$ x(0) = A \\exp(-\\gamma \\cdot 0) + \\frac{C_S}{\\gamma} = A \\cdot 1 + \\frac{C_S}{\\gamma} = 0 $$\nThis gives $A = -\\frac{C_S}{\\gamma}$.\n\nSubstituting $A$ back into the general solution, we find the specific solution for $x(t)$:\n$$ x(t) = -\\frac{C_S}{\\gamma} \\exp(-\\gamma t) + \\frac{C_S}{\\gamma} = \\frac{C_S}{\\gamma} (1 - \\exp(-\\gamma t)) $$\nFinally, we substitute the full expression for $C_S$:\n$$ x(t) = \\frac{1}{\\gamma} \\left( k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} \\right) (1 - \\exp(-\\gamma t)) $$\nThis expression can be written more compactly as:\n$$ x(t) = \\frac{k_{\\mathrm{tr}}}{\\gamma} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} (1 - \\exp(-\\gamma t)) $$\nThis is the closed-form analytical expression for the mRNA concentration as a function of time, based on the given parameters and principles.", "answer": "$$\\boxed{\\frac{k_{\\mathrm{tr}}}{\\gamma} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} (1 - \\exp(-\\gamma t))}$$", "id": "4393067"}, {"introduction": "Once a model is formulated, a key task is to connect it to experimental data. This practice delves into the mathematical properties of the Hill function, exploring how different graphical representations can be used to estimate its critical parameters, like the cooperativity coefficient $n$. You will analyze log-log and log-logit plots, powerful tools that transform the sigmoidal Hill curve into linear forms, making parameter inference more intuitive and robust [@problem_id:4393066].", "problem": "A single gene promoter is activated by a Transcription Factor (TF) $X$ that binds cooperatively as an $n$-mer to $n$ sites in an all-or-none fashion: transcription occurs only when all $n$ sites are occupied. Assume rapid binding and unbinding relative to transcription initiation so that binding can be treated at thermodynamic equilibrium. Under mass action, the statistical weight of the fully bound (active) promoter relative to the empty (inactive) promoter scales as $\\left(\\frac{x}{K}\\right)^{n}$, where $x$ denotes the concentration $[X]$ and $K$ is a concentration scale that sets the midpoint of activation. Partially bound states are transcriptionally inactive in this model. There is negligible basal leak, so the transcription rate satisfies $r(x) = r_{\\max} \\, p_{\\mathrm{on}}(x)$, where $p_{\\mathrm{on}}(x)$ is the probability that the promoter is in the fully bound state and $r_{\\max}$ is the maximal rate.\n\nYou perform the following plots as $x$ varies:\n\n- Plot $1$: a log-log plot of $y_{1}(x) = \\log r(x)$ versus $\\log x$.\n- Plot $2$: a log-log plot of $y_{2}(x) = \\log\\!\\left(\\frac{r(x)}{r_{\\max}}\\right)$ versus $\\log x$.\n- Plot $3$: a log-logit plot defined by $y_{3}(x) = \\log\\!\\left(\\frac{\\frac{r(x)}{r_{\\max}}}{1 - \\frac{r(x)}{r_{\\max}}}\\right)$ versus $\\log x$.\n\nThroughout, $\\log$ denotes the natural logarithm, and a “local slope” at a concentration $x_{\\ast}$ means the derivative $\\left.\\frac{d y_{i}}{d \\log x}\\right|_{x = x_{\\ast}}$.\n\nWhich statements are correct under the stated assumptions or under the explicit modifications described?\n\nA. On Plot $1$, the local slope evaluated at $x = K$ equals $n/2$.\n\nB. On Plot $2$, the local slope in the regime $x \\ll K$ approaches $n$.\n\nC. On Plot $3$ (with negligible basal leak), the local slope equals $n$ for all $x$.\n\nD. If the basal leak is nonzero (so $r_{0}  0$) but the same binding mechanism holds, and one instead uses the dynamic-range normalized variable $z(x) = \\frac{r(x) - r_{0}}{r_{\\max} - r_{0}}$ in the logit, i.e., plots $y(x) = \\log\\!\\left(\\frac{z(x)}{1 - z(x)}\\right)$ versus $\\log x$, then the local slope equals $n$ for all $x$.\n\nE. On Plot $1$, the local slope evaluated at $x = K$ equals $n$.\n\nF. On Plot $3$ (with negligible basal leak), the local slope in the regime $x \\ll K$ approaches $n/2$.", "solution": "The problem statement is first validated for scientific soundness, self-consistency, and clarity.\n\n### Step 1: Extract Givens\n-   A transcription factor $X$ binds cooperatively as an $n$-mer to $n$ sites on a promoter.\n-   Binding is all-or-none; transcription occurs only when all $n$ sites are occupied.\n-   Binding is at thermodynamic equilibrium.\n-   The statistical weight of the fully bound state relative to the empty state is $\\left(\\frac{x}{K}\\right)^{n}$, where $x = [X]$.\n-   $K$ is the concentration at which activation is at its midpoint.\n-   Partially bound states are transcriptionally inactive.\n-   Basal leak is negligible, meaning transcription rate is zero when the promoter is not fully bound.\n-   The transcription rate is $r(x) = r_{\\max} \\, p_{\\mathrm{on}}(x)$, where $p_{\\mathrm{on}}(x)$ is the probability of the promoter being in the fully bound state.\n-   Plot $1$: $y_{1}(x) = \\log r(x)$ versus $\\log x$.\n-   Plot $2$: $y_{2}(x) = \\log\\!\\left(\\frac{r(x)}{r_{\\max}}\\right)$ versus $\\log x$.\n-   Plot $3$: $y_{3}(x) = \\log\\!\\left(\\frac{\\frac{r(x)}{r_{\\max}}}{1 - \\frac{r(x)}{r_{\\max}}}\\right)$ versus $\\log x$.\n-   $\\log$ denotes the natural logarithm.\n-   Local slope at $x_{\\ast}$ is defined as $\\left.\\frac{d y_{i}}{d \\log x}\\right|_{x = x_{\\ast}}$.\n-   Option D introduces a non-zero basal leak $r_0 > 0$ and a normalized variable $z(x) = \\frac{r(x) - r_{0}}{r_{\\max} - r_{0}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a classic model of cooperative transcriptional activation, which leads to the Hill equation. This model is a cornerstone of systems biology and is scientifically sound. The assumptions, such as all-or-none binding and thermodynamic equilibrium, are standard simplifications used to derive the functional form of the response.\n\nLet the statistical weight of the empty promoter be $w_0 = 1$. The statistical weight of the fully bound promoter is given as $w_n = \\left(\\frac{x}{K}\\right)^{n}$. All intermediate states are inactive and, in the all-or-none model, are considered to have negligible statistical weight. The partition function $Z$ is the sum of the weights of all possible states: $Z = w_0 + w_n = 1 + \\left(\\frac{x}{K}\\right)^{n}$.\n\nThe probability of the promoter being in the fully bound (active) state is the ratio of the weight of the active state to the partition function:\n$$p_{\\mathrm{on}}(x) = \\frac{w_n}{Z} = \\frac{\\left(\\frac{x}{K}\\right)^{n}}{1 + \\left(\\frac{x}{K}\\right)^{n}} = \\frac{x^n}{K^n + x^n}$$\nAt $x=K$, $p_{\\mathrm{on}}(K) = \\frac{K^n}{K^n + K^n} = \\frac{1}{2}$. This is consistent with the definition of $K$ as the concentration for midpoint activation.\n\nThe transcription rate is $r(x) = r_{\\max} p_{\\mathrm{on}}(x) = r_{\\max} \\frac{x^n}{K^n + x^n}$. The problem is well-posed, with all terms clearly defined. The questions are mathematical properties of this function, which can be uniquely determined. The problem is objective and contains no scientific or logical contradictions.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The solution will now be derived.\n\n### Derivation of Local Slopes\nThe \"local slope\" is defined as $\\frac{d y}{d \\log x}$. Using the chain rule, with $u = \\log x$, we have $x = e^u$ and $\\frac{dx}{du} = e^u = x$. Therefore, the derivative operator is $\\frac{d}{d \\log x} = x \\frac{d}{dx}$.\n\nFirst, let's analyze the functions to be plotted.\n$y_1(x) = \\log r(x) = \\log \\left(r_{\\max} \\frac{x^n}{K^n + x^n}\\right) = \\log r_{\\max} + n\\log x - \\log(K^n + x^n)$.\n$y_2(x) = \\log\\left(\\frac{r(x)}{r_{\\max}}\\right) = \\log(p_{\\mathrm{on}}(x)) = n\\log x - \\log(K^n + x^n)$.\n\nThe local slope for Plot $1$ and Plot $2$, denoted $S_1(x)$ and $S_2(x)$ respectively, are identical because they differ only by a constant, $\\log r_{\\max}$, whose derivative is zero.\n$$S_{1,2}(x) = \\frac{d y_2}{d \\log x} = x \\frac{d}{dx} \\left( n\\log x - \\log(K^n + x^n) \\right)$$\n$$S_{1,2}(x) = x \\left( \\frac{n}{x} - \\frac{nx^{n-1}}{K^n + x^n} \\right) = n - \\frac{nx^n}{K^n + x^n} = n \\left( \\frac{K^n + x^n - x^n}{K^n + x^n} \\right)$$\n$$S_{1,2}(x) = n \\frac{K^n}{K^n + x^n}$$\n\nNow, let's analyze Plot $3$. The function is $y_3(x) = \\log\\left(\\frac{p_{\\mathrm{on}}(x)}{1 - p_{\\mathrm{on}}(x)}\\right)$. Let's compute the argument of the logarithm:\n$$\\frac{p_{\\mathrm{on}}(x)}{1 - p_{\\mathrm{on}}(x)} = \\frac{\\frac{x^n}{K^n + x^n}}{1 - \\frac{x^n}{K^n + x^n}} = \\frac{\\frac{x^n}{K^n + x^n}}{\\frac{K^n + x^n - x^n}{K^n + x^n}} = \\frac{x^n}{K^n} = \\left(\\frac{x}{K}\\right)^n$$\nSo, $y_3(x) = \\log\\left(\\left(\\frac{x}{K}\\right)^n\\right) = n \\log\\left(\\frac{x}{K}\\right) = n(\\log x - \\log K)$.\nThe local slope for Plot $3$, $S_3(x)$, is:\n$$S_3(x) = \\frac{d y_3}{d \\log x} = \\frac{d}{d \\log x}(n\\log x - n\\log K) = n \\frac{d(\\log x)}{d \\log x} - 0 = n$$\n\n### Option-by-Option Analysis\n\n**A. On Plot $1$, the local slope evaluated at $x = K$ equals $n/2$.**\nThe local slope for Plot $1$ is $S_1(x) = n \\frac{K^n}{K^n + x^n}$.\nEvaluating at $x=K$:\n$$S_1(K) = n \\frac{K^n}{K^n + K^n} = n \\frac{K^n}{2K^n} = \\frac{n}{2}$$\nThis statement is **Correct**.\n\n**B. On Plot $2$, the local slope in the regime $x \\ll K$ approaches $n$.**\nThe local slope for Plot $2$ is $S_2(x) = n \\frac{K^n}{K^n + x^n}$.\nIn the regime $x \\ll K$, we can analyze the limit as $x \\to 0$:\n$$\\lim_{x \\to 0} S_2(x) = \\lim_{x \\to 0} n \\frac{K^n}{K^n + x^n} = n \\frac{K^n}{K^n + 0} = n$$\nThe slope approaches $n$ for low concentrations. This statement is **Correct**.\n\n**C. On Plot $3$ (with negligible basal leak), the local slope equals $n$ for all $x$.**\nWe derived the local slope for Plot $3$ as $S_3(x) = n$. This value is a constant, independent of $x$.\nThis statement is **Correct**.\n\n**D. If the basal leak is nonzero (so $r_{0}  0$) but the same binding mechanism holds, and one instead uses the dynamic-range normalized variable $z(x) = \\frac{r(x) - r_{0}}{r_{\\max} - r_{0}}$ in the logit, i.e., plots $y(x) = \\log\\!\\left(\\frac{z(x)}{1 - z(x)}\\right)$ versus $\\log x$, then the local slope equals $n$ for all $x$.**\nWith a basal leak $r_0$, the total rate is the sum of the basal rate and the TF-induced rate. The maximum induced rate is $r_{\\max} - r_0$.\nSo, the full rate expression is $r(x) = r_0 + (r_{\\max} - r_0)p_{\\mathrm{on}}(x)$.\nLet's compute the normalized variable $z(x)$:\n$$z(x) = \\frac{r(x) - r_0}{r_{\\max} - r_0} = \\frac{\\left(r_0 + (r_{\\max} - r_0)p_{\\mathrm{on}}(x)\\right) - r_0}{r_{\\max} - r_0} = \\frac{(r_{\\max} - r_0)p_{\\mathrm{on}}(x)}{r_{\\max} - r_0} = p_{\\mathrm{on}}(x)$$\nThe variable $z(x)$ is therefore identical to the probability of the promoter being active, $p_{\\mathrm{on}}(x)$. The plot is of $y(x) = \\log\\left(\\frac{p_{\\mathrm{on}}(x)}{1 - p_{\\mathrm{on}}(x)}\\right)$ versus $\\log x$. This is exactly the same plot as Plot $3$.\nAs shown for option C, the local slope of this plot is $n$ for all $x$.\nThis statement is **Correct**.\n\n**E. On Plot $1$, the local slope evaluated at $x = K$ equals $n$.**\nAs determined in the analysis of option A, the local slope of Plot $1$ at $x=K$ is $\\frac{n}{2}$. This statement claims the slope is $n$.\nThis statement is **Incorrect**.\n\n**F. On Plot $3$ (with negligible basal leak), the local slope in the regime $x \\ll K$ approaches $n/2$.**\nAs determined in the analysis of option C, the local slope of Plot $3$ is exactly $n$ for all values of $x$. Therefore, in the regime $x \\ll K$, the slope is also $n$.\nThis statement is **Incorrect**.", "answer": "$$\\boxed{ABCD}$$", "id": "4393066"}, {"introduction": "Having mastered the behavior of a single regulated gene, we now explore how this component can generate complex systemic properties when integrated into a network. This exercise guides you through the analysis of a genetic positive-feedback loop, a common motif in cellular decision-making. Through numerical simulation, you will discover how the combination of cooperative activation and self-regulation can give rise to bistability, allowing a cell to exist in two distinct stable states [@problem_id:4393065].", "problem": "A single gene product engages in positive feedback by activating its own transcription through cooperative binding to its promoter. Assume that transcriptional activation arises from the equilibrium occupancy of the promoter by an activator whose concentration is denoted by $A$ (in $\\mathrm{nM}$), under the rapid-equilibrium approximation and cooperative binding of order $n$ with dissociation constant $K$ (in $\\mathrm{nM}$). Let there be a basal production rate $\\alpha_0$ (in $\\mathrm{nM}/\\mathrm{h}$), a maximal activation-amplified production contribution $\\alpha$ (in $\\mathrm{nM}/\\mathrm{h}$), and a first-order degradation rate constant $\\delta$ (in $\\mathrm{h}^{-1}$). The continuous-time dynamics of the activator concentration $A(t)$ is governed by a one-dimensional ordinary differential equation constructed from these components.\n\nStarting from the foundational base comprising: (i) mass-action binding equilibrium for promoter occupancy with cooperativity, (ii) the Central Dogma of molecular biology (DNA $\\rightarrow$ RNA $\\rightarrow$ protein) asserting that transcriptional activity determines production rate, and (iii) linear first-order degradation, derive the regulatory activation function as a saturating, monotonically increasing function of $A$ that arises from cooperative promoter occupancy, and formulate the dynamical equation for $A(t)$. Then, focus on steady states and their stability.\n\nFor a given parameter set $(\\alpha_0,\\alpha,\\delta,K,n)$, define the steady-state equation $f(A)=0$ for $A\\ge 0$ by equating total production to degradation. A steady state $A^\\ast$ is stable if the one-dimensional stability criterion holds, namely if the derivative $\\frac{d f}{d A}(A^\\ast)$ is negative, and it is unstable if the derivative is positive. Under strong positive feedback with sufficient cooperativity, multiple steady states can exist, including bistability with two stable steady states separated by one unstable steady state.\n\nYour program must:\n- Implement the derived regulatory function based on the equilibrium occupancy with cooperativity and construct $f(A)$ from the production and degradation terms.\n- Numerically find all nonnegative steady states $A^\\ast$ (roots of $f(A)$ for $A\\ge 0$) by scanning a sufficiently large interval and bracketing sign changes, then refining roots with a robust solver.\n- Classify each steady state as stable or unstable using the sign of $\\frac{d f}{d A}$ at the root.\n- For each test case, return the number of stable steady states and the sorted list (ascending) of the stable steady-state concentrations, expressed in $\\mathrm{nM}$ as floating-point values.\n\nUse the following test suite with scientifically plausible parameters:\n- Test case $1$: $(\\alpha_0,\\alpha,\\delta,K,n)=(2,120,1,20,4)$ with $A$ in $\\mathrm{nM}$, rates in $\\mathrm{nM}/\\mathrm{h}$ and $\\mathrm{h}^{-1}$.\n- Test case $2$: $(\\alpha_0,\\alpha,\\delta,K,n)=(2,15,1,20,4)$ with $A$ in $\\mathrm{nM}$, rates in $\\mathrm{nM}/\\mathrm{h}$ and $\\mathrm{h}^{-1}$.\n- Test case $3$: $(\\alpha_0,\\alpha,\\delta,K,n)=(2,120,8,20,4)$ with $A$ in $\\mathrm{nM}$, rates in $\\mathrm{nM}/\\mathrm{h}$ and $\\mathrm{h}^{-1}$.\n- Test case $4$: $(\\alpha_0,\\alpha,\\delta,K,n)=(2,120,1,20,1)$ with $A$ in $\\mathrm{nM}$, rates in $\\mathrm{nM}/\\mathrm{h}$ and $\\mathrm{h}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of case-wise items, enclosed in square brackets. Each case-wise item must itself be a list of the form $[\\text{num\\_stable},[\\text{stable\\_root}_1,\\text{stable\\_root}_2,\\ldots]]$ with no spaces. For example, for two cases the format would be $[[2,[a,b]],[1,[c]]]$ where $a$, $b$, and $c$ are floating-point concentrations in $\\mathrm{nM}$ expressed as decimals. The final output must follow this exact format for the four test cases specified above.", "solution": "The problem requires an analysis of the steady states and their stability for a genetic auto-regulatory network. The core task involves deriving the governing differential equation, identifying the steady-state condition, and implementing a numerical algorithm to find and classify the steady states for given parameter sets.\n\nFirst, we formulate the mathematical model based on the provided physical and biological principles. The concentration of the activator protein, denoted by $A$, changes over time according to the balance between its production and degradation. This can be expressed as a one-dimensional ordinary differential equation (ODE):\n$$ \\frac{dA}{dt} = \\text{Rate of Production} - \\text{Rate of Degradation} $$\n\nThe degradation process is described as a first-order reaction with a rate constant $\\delta$. Thus, the rate of degradation is proportional to the concentration $A$:\n$$ \\text{Rate of Degradation} = \\delta A $$\n\nThe production of the activator is regulated by the activator itself. There is a basal production rate, $\\alpha_0$, which occurs even in the absence of the activator. Additionally, the activator enhances its own production by binding to its promoter. This binding is described as a cooperative process of order $n$. Under the rapid-equilibrium approximation, the fraction of promoters occupied by the activator, $\\theta$, is given by the Hill function:\n$$ \\theta(A) = \\frac{A^n}{K^n + A^n} $$\nHere, $K$ is the dissociation constant, representing the concentration of $A$ at which the promoter occupancy is half-maximal. The activated production rate is proportional to this occupancy fraction, with a maximal activation-amplified contribution of $\\alpha$. The total production rate is the sum of the basal and activated rates:\n$$ \\text{Rate of Production} = \\alpha_0 + \\alpha \\cdot \\theta(A) = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} $$\n\nCombining the production and degradation terms, we obtain the complete dynamical equation for $A(t)$:\n$$ \\frac{dA}{dt} = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} - \\delta A $$\n\nSteady states of the system are the concentrations $A^\\ast$ at which the net rate of change is zero, i.e., $\\frac{dA}{dt} = 0$. This condition defines the steady-state equation $f(A) = 0$, where:\n$$ f(A) = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} - \\delta A $$\nThe non-negative roots $A^\\ast \\ge 0$ of this equation correspond to the steady-state concentrations. Graphically, these are the intersection points of the sigmoidal production curve, $P(A) = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n}$, and the linear degradation line, $D(A) = \\delta A$.\n\nThe stability of a steady state $A^\\ast$ is determined by the system's response to small perturbations around $A^\\ast$. For a one-dimensional system, this is given by the sign of the derivative of $f(A)$ evaluated at the steady state. A steady state $A^\\ast$ is stable if $\\frac{df}{dA}(A^\\ast)  0$, meaning perturbations decay and the system returns to $A^\\ast$. It is unstable if $\\frac{df}{dA}(A^\\ast)  0$, meaning perturbations are amplified, driving the system away from $A^\\ast$.\n\nTo find the derivative, we differentiate $f(A)$ with respect to $A$:\n$$ \\frac{df}{dA} = \\frac{d}{dA} \\left( \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} - \\delta A \\right) $$\nUsing the quotient rule for the Hill function term, we get:\n$$ \\frac{df}{dA} = \\alpha \\frac{(nA^{n-1})(K^n + A^n) - (A^n)(nA^{n-1})}{(K^n + A^n)^2} - \\delta = \\alpha \\frac{nK^nA^{n-1}}{(K^n + A^n)^2} - \\delta $$\n\nThe numerical implementation proceeds as follows:\n$1$.  For each parameter set $(\\alpha_0, \\alpha, \\delta, K, n)$, define the functions for $f(A)$ and $\\frac{df}{dA}$.\n$2$.  Determine a suitable search interval for the roots $A^\\ast$. A safe upper bound for any steady state is given by the maximum possible production rate divided by the degradation constant, $A_{\\text{max}} = (\\alpha_0 + \\alpha) / \\delta$. We scan a slightly larger interval, for instance, from $0$ to $1.5 \\cdot A_{\\text{max}} + 10$.\n$3$.  Scan this interval with a small step size to identify pairs of consecutive points where $f(A)$ changes sign. Each such pair brackets a root.\n$4$.  For each bracket found, use a robust numerical root-finding algorithm, such as the Brent-Dekker method (implemented in `scipy.optimize.brentq`), to find the precise value of the root $A^\\ast$.\n$5$.  For each root $A^\\ast$, calculate the derivative $\\frac{df}{dA}(A^\\ast)$.\n$6$.  If $\\frac{df}{dA}(A^\\ast)  0$, the root is classified as stable.\n$7$.  The stable roots for each case are collected, sorted in ascending order, and formatted along with their count as specified in the problem statement.\nThis procedure systematically finds all non-negative steady states and determines their stability, allowing us to characterize the system's behavior (monostable vs. bistable) for each set of parameters.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the stable steady states of a genetic auto-activation circuit.\n\n    The function iterates through a set of test cases, each defined by parameters\n    (alpha0, alpha, delta, K, n). For each case, it finds the non-negative roots\n    of the steady-state equation f(A) = 0 and classifies them as stable or unstable.\n\n    The steady-state equation is:\n    f(A) = alpha0 + alpha * A^n / (K^n + A^n) - delta * A\n\n    A steady state A* is stable if df/dA(A*)  0. The derivative is:\n    df/dA = alpha * n * K^n * A^(n-1) / (K^n + A^n)^2 - delta\n    \"\"\"\n    test_cases = [\n        # (alpha0, alpha, delta, K, n)\n        (2, 120, 1, 20, 4),\n        (2, 15, 1, 20, 4),\n        (2, 120, 8, 20, 4),\n        (2, 120, 1, 20, 1)\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        alpha0, alpha, delta, K, n = case\n\n        # To avoid potential overflow with large powers, use log-exp trick if needed,\n        # but standard float64 is sufficient for these parameters.\n        # Define f(A) and its derivative df/dA\n        def f(A):\n            if A  0:\n                return np.inf  # We only care about A = 0\n            A_n = A**n\n            K_n = K**n\n            return alpha0 + alpha * A_n / (K_n + A_n) - delta * A\n\n        def dfdA(A):\n            if A  0:\n                return 0 # Value for A0 is not relevant for stability analysis.\n            \n            # Handle A=0 case for A**(n-1) when n=1, where it's A**0=1.\n            # a**(b-1) for a=0, b=1 should be 1. np.power(0,0) is 1.\n            A_pow_n_minus_1 = np.power(A, n - 1)\n            \n            K_n = K**n\n            A_n = A**n\n            \n            numerator = alpha * n * K_n * A_pow_n_minus_1\n            denominator = (K_n + A_n)**2\n            \n            if denominator == 0:\n                # Should not happen for K0 or A0. If K=0 and A=0, it's a singularity.\n                # All K in test cases are  0.\n                return -delta\n            \n            return numerator / denominator - delta\n\n        # Root finding using a bracketing scan followed by a robust solver\n        roots = []\n        \n        # A generous but informed search range\n        A_max_bound = (alpha0 + alpha) / delta\n        search_domain_max = A_max_bound * 1.5 + 50\n        \n        # Scan for intervals where f(A) changes sign\n        scan_step = 0.01\n        A_scan_points = np.arange(0, search_domain_max, scan_step)\n        \n        # Ensure the first point's value is calculated\n        f_prev = f(A_scan_points[0])\n\n        for i in range(1, len(A_scan_points)):\n            a = A_scan_points[i-1]\n            b = A_scan_points[i]\n            f_curr = f(b)\n            if np.sign(f_curr) != np.sign(f_prev):\n                # A bracket [a, b] is found\n                try:\n                    root = brentq(f, a, b)\n                    # Add root if it's not a duplicate from a previous bracket\n                    if not any(np.isclose(root, r) for r in roots):\n                        roots.append(root)\n                except ValueError:\n                    # brentq might fail if signs are not opposite, though our check prevents this.\n                    # This can happen if one value is exactly zero.\n                    if f_prev == 0:\n                        if not any(np.isclose(a, r) for r in roots):\n                            roots.append(a)\n            f_prev = f_curr\n\n        # If alpha0 is exactly 0, A=0 is a trivial root. Not the case here.\n        # Check f(0) in case the first root is missed by the scan.\n        # f(0) is alpha0, which is  0 for all cases. So no root at A=0.\n\n        # Classify each found root and collect the stable ones\n        stable_roots = []\n        for root in roots:\n            derivative_at_root = dfdA(root)\n            if derivative_at_root  0:\n                stable_roots.append(root)\n        \n        stable_roots.sort()\n\n        # Store the result for the current case\n        case_result = [len(stable_roots), stable_roots]\n        all_results.append(case_result)\n\n    # Format the final output string as specified: [[num,[root1,...]],...]\n    # without any spaces.\n    result_strings = []\n    for num_stable, roots_list in all_results:\n        # Convert each root to a string, then join them with commas\n        roots_str = f\"[{','.join(map(str, roots_list))}]\"\n        result_strings.append(f\"[{num_stable},{roots_str}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "4393065"}]}