{"hands_on_practices": [{"introduction": "Before analyzing an entire genetic circuit, it is essential to understand the quantitative behavior of its fundamental building blocks. This practice focuses on the Hill repression function, the mathematical model describing how one gene's protein product inhibits the expression of another. You will explore the concept of ultrasensitivity—the sharp, switch-like response of a gene to its repressor—which is a critical prerequisite for creating a robust bistable switch, and learn to quantify this responsiveness using the formal definition of log-sensitivity [@problem_id:4347539].", "problem": "In a canonical two-gene genetic toggle switch, each gene represses the other via transcription factor binding to an operator site, reducing the rate of transcription when bound. Under quasi-equilibrium binding governed by the law of mass action, the fraction of time that the operator is unbound can be modeled by a Hill-type repression function. Consider a repressor with concentration $x$ acting on a promoter whose normalized activity is given by the Hill repression function $f(x) = \\frac{1}{1 + (x/K)^{n}}$, where $K$ is the dissociation constant (the concentration at which the promoter is half active), and $n$ is the effective Hill coefficient reflecting cooperativity or multi-site binding.\n\nAssume $K = 50\\ \\text{nM}$ and $n = 2$. Work within a systems biomedicine framework, starting from binding equilibrium and basic definitions of sensitivity in input-output modules of genetic circuits. Proceed as follows:\n\n1. Using the definition of local log-sensitivity $S(x)$ of the input-output map, $S(x) = \\frac{d \\ln f(x)}{d \\ln x}$, derive a closed-form expression for $S(x)$ in terms of $x$, $K$, and $n$.\n\n2. Compute $f(25\\ \\text{nM})$, $f(50\\ \\text{nM})$, and $f(100\\ \\text{nM})$ exactly (do not round), and interpret how these values reflect the steepness of the response around $x = K$ that is necessary for robust bistability in a genetic toggle switch.\n\n3. Evaluate your expression for $S(x)$ at $x = K$ for $n = 2$. Express your final sensitivity value as a dimensionless number. No rounding is required. Report only the value of $S(K)$ as your final answer.", "solution": "The problem asks for a multi-step analysis of a Hill-type repression function commonly found in models of genetic circuits.\n\n**1. Derivation of the Log-Sensitivity $S(x)$**\n\nThe local log-sensitivity $S(x)$ is defined as the logarithmic derivative of the output $f(x)$ with respect to the input $x$:\n$$S(x) = \\frac{d \\ln f(x)}{d \\ln x}$$\nUsing the chain rule for derivatives, this can be expressed as:\n$$S(x) = \\frac{d \\ln f(x)/dx}{d \\ln x/dx} = \\frac{f'(x)/f(x)}{1/x} = \\frac{x f'(x)}{f(x)}$$\nFirst, we find the natural logarithm of $f(x)$:\n$$\\ln f(x) = \\ln\\left(\\frac{1}{1 + (x/K)^n}\\right) = - \\ln\\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)$$\nNow, we differentiate $\\ln f(x)$ with respect to $x$:\n$$\\frac{d}{dx} \\ln f(x) = - \\frac{1}{1 + (x/K)^n} \\cdot \\frac{d}{dx}\\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)$$\n$$\\frac{d}{dx} \\ln f(x) = - \\frac{1}{1 + (x/K)^n} \\cdot \\left(\\frac{n x^{n-1}}{K^n}\\right)$$\nWe can now compute $S(x)$ by multiplying this result by $x$:\n$$S(x) = x \\cdot \\frac{d \\ln f(x)}{dx} = x \\left[ - \\frac{1}{1 + (x/K)^n} \\cdot \\left(\\frac{n x^{n-1}}{K^n}\\right) \\right]$$\n$$S(x) = - \\frac{n x^n / K^n}{1 + (x/K)^n}$$\nThis simplifies to the closed-form expression for the log-sensitivity:\n$$S(x) = - \\frac{n (x/K)^n}{1 + (x/K)^n}$$\n\n**2. Calculation and Interpretation of Promoter Activity**\n\nWe are given $K = 50\\ \\text{nM}$ and $n = 2$. The promoter activity function is $f(x) = \\frac{1}{1 + (x/50)^2}$.\n\nAt $x = 25\\ \\text{nM}$ (i.e., $x = K/2$):\n$$f(25) = \\frac{1}{1 + (25/50)^2} = \\frac{1}{1 + (1/2)^2} = \\frac{1}{1 + 1/4} = \\frac{1}{5/4} = \\frac{4}{5}$$\n\nAt $x = 50\\ \\text{nM}$ (i.e., $x = K$):\n$$f(50) = \\frac{1}{1 + (50/50)^2} = \\frac{1}{1 + 1^2} = \\frac{1}{2}$$\nThis confirms the definition of $K$ as the concentration yielding half-maximal repression (or half-activity).\n\nAt $x = 100\\ \\text{nM}$ (i.e., $x = 2K$):\n$$f(100) = \\frac{1}{1 + (100/50)^2} = \\frac{1}{1 + 2^2} = \\frac{1}{1 + 4} = \\frac{1}{5}$$\n\nInterpretation: The calculations show that as the repressor concentration $x$ doubles from $25\\ \\text{nM}$ to $50\\ \\text{nM}$, the promoter activity drops from $80\\%$ ($4/5$) to $50\\%$ ($1/2$). As the concentration doubles again to $100\\ \\text{nM}$, the activity drops further to $20\\%$ ($1/5$). This sharp change in promoter activity over a relatively narrow range of repressor concentrations is known as an ultrasensitive or switch-like response. The Hill coefficient $n  1$ (here, $n=2$) is what generates this steepness. In a genetic toggle switch, this ultrasensitivity is a critical requirement for achieving bistability, where the system can stably exist in two distinct states (one gene 'on' and the other 'off', and vice versa). The steep response curves allow the nullclines of the two repressors to intersect at three points, with the two outer points representing the stable steady states of the switch.\n\n**3. Evaluation of Sensitivity at $x = K$**\n\nThe final task is to evaluate the log-sensitivity $S(x)$ at the specific point $x = K$ for the given Hill coefficient $n = 2$. We use the expression for $S(x)$ derived in the first part:\n$$S(x) = - \\frac{n (x/K)^n}{1 + (x/K)^n}$$\nSubstituting $x=K$ into the expression:\n$$S(K) = - \\frac{n (K/K)^n}{1 + (K/K)^n} = - \\frac{n \\cdot 1^n}{1 + 1^n} = - \\frac{n}{2}$$\nFor the given value $n=2$:\n$$S(K) = - \\frac{2}{2} = -1$$\nThis value, $S(K) = -1$, represents the maximal local sensitivity of the Hill function for $n=2$. It indicates that at the half-repression point, a small fractional change in the input concentration $x$ results in an equal but opposite fractional change in the output activity $f(x)$. For example, a $1\\%$ increase in $x$ around $K$ leads to approximately a $1\\%$ decrease in $f(x)$.", "answer": "$$\\boxed{-1}$$", "id": "4347539"}, {"introduction": "With an understanding of the components, we can now analyze the dynamics of the complete toggle switch system. This exercise introduces linear stability analysis, a cornerstone of dynamical systems theory used to determine if a system will return to an equilibrium state after a small perturbation. You will apply this powerful analytical technique to the symmetric fixed point of the toggle switch, where both repressor proteins are present at equal concentrations, to classify its stability and understand its role within the larger dynamics of the circuit [@problem_id:4347512].", "problem": "Consider a canonical two-gene mutual-repression genetic toggle switch under symmetric parameters. Let $x(t)$ and $y(t)$ denote the nondimensionalized concentrations of two repressor proteins, obtained by scaling their physical concentrations by a characteristic degradation rate so that the degradation terms are unity. Assume cooperative repression with Hill coefficient $n$ and a maximal production parameter $\\beta0$, yielding the following system of ordinary differential equations (ODEs):\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta}{1 + y^{n}} \\;-\\; x, \n\\qquad \n\\frac{dy}{dt} \\;=\\; \\frac{\\beta}{1 + x^{n}} \\;-\\; y.\n$$\nThese equations are grounded in the Central Dogma of Molecular Biology and the Hill formalism for transcriptional regulation: production is a decreasing Hill function of the opposing repressor, and removal is a first-order degradation process. A symmetric fixed point $(x^{\\ast}, y^{\\ast}) = (s, s)$ exists whenever $s$ satisfies the fixed-point balance of production and degradation.\n\nTasks:\n- Starting from the system above, derive the scalar fixed-point equation that $s$ must satisfy at the symmetric fixed point, expressed in terms of $n$ and $\\beta$.\n- Compute the Jacobian matrix of the system at $(x^{\\ast}, y^{\\ast}) = (s,s)$, and then derive closed-form expressions for its two eigenvalues in terms of $n$, $\\beta$, and $s$.\n- For the specific parameter values $n = 2$ and $\\beta = \\frac{5}{8}$, solve exactly for the symmetric fixed point $s$, evaluate the Jacobian at $(s,s)$, compute the two eigenvalues as exact values, and use them to classify the linear stability of the symmetric fixed point.\n\nAnswer form requirement:\n- The final answer must consist only of the two eigenvalues arranged as a single row matrix in a $\\begin{pmatrix}$ environment, with exact values (no rounding required). No units are required.", "solution": "The problem requires an analysis of a symmetric genetic toggle switch. The analysis involves finding the symmetric fixed point, computing the Jacobian matrix at this point, deriving its eigenvalues, and then applying this framework to a specific set of parameters to determine the stability of the fixed point.\n\nThe system of ordinary differential equations is given by:\n$$\n\\frac{dx}{dt} \\;=\\; f(x, y) \\;=\\; \\frac{\\beta}{1 + y^{n}} \\;-\\; x\n$$\n$$\n\\frac{dy}{dt} \\;=\\; g(x, y) \\;=\\; \\frac{\\beta}{1 + x^{n}} \\;-\\; y\n$$\n\n**1. Derivation of the Scalar Fixed-Point Equation**\n\nA fixed point $(x^{\\ast}, y^{\\ast})$ of the system is a point where the time derivatives are zero: $\\frac{dx}{dt} = 0$ and $\\frac{dy}{dt} = 0$. For a symmetric fixed point, we have the condition $x^{\\ast} = y^{\\ast} = s$. Substituting this into either of the two equations yields the same condition. Using the first equation:\n$$\n\\frac{dx}{dt}\\bigg|_{(s,s)} = \\frac{\\beta}{1 + s^{n}} - s = 0\n$$\nRearranging this equation gives the scalar fixed-point equation that $s$ must satisfy:\n$$\ns = \\frac{\\beta}{1 + s^{n}}\n$$\nThis can also be written as $s(1 + s^{n}) = \\beta$.\n\n**2. Jacobian Matrix and Eigenvalues**\n\nTo analyze the linear stability of the fixed point, we compute the Jacobian matrix $J$ of the system, which is defined as:\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y} \\end{pmatrix}\n$$\nWe calculate the four partial derivatives from the functions $f(x, y)$ and $g(x, y)$:\n$$\n\\frac{\\partial f}{\\partial x} = -1\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{d}{dy}\\left(\\beta(1+y^n)^{-1}\\right) = \\beta(-1)(1+y^n)^{-2}(ny^{n-1}) = -\\frac{\\beta n y^{n-1}}{(1+y^n)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{d}{dx}\\left(\\beta(1+x^n)^{-1}\\right) = \\beta(-1)(1+x^n)^{-2}(nx^{n-1}) = -\\frac{\\beta n x^{n-1}}{(1+x^n)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -1\n$$\nNow, we evaluate this Jacobian matrix at the symmetric fixed point $(s, s)$:\n$$\nJ(s, s) = \\begin{pmatrix} -1  -\\frac{\\beta n s^{n-1}}{(1+s^n)^2} \\\\ -\\frac{\\beta n s^{n-1}}{(1+s^n)^2}  -1 \\end{pmatrix}\n$$\nWe can simplify the off-diagonal terms using the fixed-point relation $\\beta = s(1+s^n)$. Substituting this for $\\beta$:\n$$\n-\\frac{\\beta n s^{n-1}}{(1+s^n)^2} = -\\frac{s(1+s^n) n s^{n-1}}{(1+s^n)^2} = -\\frac{n s^{n}}{1+s^n}\n$$\nLet's define a term $a = -\\frac{n s^{n}}{1+s^n}$. The Jacobian at $(s,s)$ simplifies to:\n$$\nJ(s, s) = \\begin{pmatrix} -1  a \\\\ a  -1 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are found by solving the characteristic equation $\\det(J(s,s) - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -1 - \\lambda  a \\\\ a  -1 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1 - \\lambda)^2 - a^2 = 0\n$$\n$$\n(1 + \\lambda)^2 = a^2\n$$\n$$\n1 + \\lambda = \\pm a \\quad \\implies \\quad \\lambda = -1 \\pm a\n$$\nThis gives two eigenvalues, $\\lambda_1$ and $\\lambda_2$:\n$$\n\\lambda_1 = -1 + a = -1 - \\frac{n s^{n}}{1+s^n}\n$$\n$$\n\\lambda_2 = -1 - a = -1 - \\left(-\\frac{n s^{n}}{1+s^n}\\right) = -1 + \\frac{n s^{n}}{1+s^n}\n$$\n\n**3. Analysis for Specific Parameters ($n=2$, $\\beta=5/8$)**\n\nFirst, we solve for the symmetric fixed point $s$ using the specific parameters $n=2$ and $\\beta=\\frac{5}{8}$ in the fixed-point equation $s(1 + s^{n}) = \\beta$:\n$$\ns(1 + s^2) = \\frac{5}{8}\n$$\nMultiplying by $8$ to clear the fraction gives a cubic equation in $s$:\n$$\n8s(1+s^2) = 5 \\quad \\implies \\quad 8s^3 + 8s - 5 = 0\n$$\nWe seek a real, positive root for $s$ (as it represents a physical concentration). By the rational root theorem, we can test for simple rational roots. Let's test $s = \\frac{1}{2}$:\n$$\n8\\left(\\frac{1}{2}\\right)^3 + 8\\left(\\frac{1}{2}\\right) - 5 = 8\\left(\\frac{1}{8}\\right) + 4 - 5 = 1 + 4 - 5 = 0\n$$\nThus, $s = \\frac{1}{2}$ is a root. To find other potential real roots, we perform polynomial division of $8s^3+8s-5$ by $(s - \\frac{1}{2})$ or, more easily, by $(2s-1)$:\n$$\n(2s-1)(4s^2 + 2s + 5) = 8s^3 + 4s^2 + 10s - 4s^2 - 2s - 5 = 8s^3 + 8s - 5\n$$\nThe quadratic factor is $4s^2 + 2s + 5$. Its discriminant is $\\Delta = b^2 - 4ac = 2^2 - 4(4)(5) = 4 - 80 = -76$. Since $\\Delta  0$, the quadratic factor has no real roots. Therefore, $s = \\frac{1}{2}$ is the unique real solution for the symmetric fixed point.\n\nNext, we compute the eigenvalues for $n=2$ and $s=\\frac{1}{2}$. First, we evaluate the term $\\frac{n s^{n}}{1+s^n}$:\n$$\n\\frac{n s^{n}}{1+s^n} = \\frac{2 \\left(\\frac{1}{2}\\right)^2}{1+\\left(\\frac{1}{2}\\right)^2} = \\frac{2 \\left(\\frac{1}{4}\\right)}{1+\\frac{1}{4}} = \\frac{\\frac{1}{2}}{\\frac{5}{4}} = \\frac{1}{2} \\cdot \\frac{4}{5} = \\frac{2}{5}\n$$\nNow we substitute this value into the expressions for the eigenvalues:\n$$\n\\lambda_1 = -1 - \\frac{2}{5} = -\\frac{5}{5} - \\frac{2}{5} = -\\frac{7}{5}\n$$\n$$\n\\lambda_2 = -1 + \\frac{2}{5} = -\\frac{5}{5} + \\frac{2}{5} = -\\frac{3}{5}\n$$\nThe two eigenvalues are $\\lambda_1 = -\\frac{7}{5}$ and $\\lambda_2 = -\\frac{3}{5}$.\n\nFinally, we classify the stability of the symmetric fixed point $(s,s) = (\\frac{1}{2}, \\frac{1}{2})$. Since both eigenvalues are real and negative ($\\lambda_1  0$ and $\\lambda_2  0$), the fixed point is a stable node. All trajectories starting sufficiently close to this point will converge to it as $t \\to \\infty$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{7}{5}  -\\frac{3}{5} \\end{pmatrix}}\n$$", "id": "4347512"}, {"introduction": "While analytical methods provide deep insight, they are often limited to specific states or parameter regimes. To uncover the full behavioral repertoire of the toggle switch, including its hallmark bistability, we must turn to computational exploration. In this practice, you will write a program to numerically find all possible steady states of the system and classify their stability, revealing how the circuit transitions from having a single stable outcome (monostability) to two distinct stable states (bistability) as a key synthesis parameter is varied [@problem_id:4347510].", "problem": "Consider a symmetric, nondimensionalized model of a genetic toggle switch composed of two genes that mutually inhibit each other. Let the concentrations of the two repressors be denoted by $x$ and $y$. The dynamics are governed by Hill-type inhibition with cooperativity $n$ and maximal production rate $\\beta$ scaled by first-order degradation. The ordinary differential equation (ODE) system is\n$$\n\\frac{dx}{dt} = \\frac{\\beta}{1 + y^n} - x, \\qquad \\frac{dy}{dt} = \\frac{\\beta}{1 + x^n} - y,\n$$\nwhere $\\beta \\ge 0$ and $n \\ge 1$. This model is derived from the Central Dogma of Molecular Biology (transcription, translation, degradation) and the empirically validated Hill repression formula, and is widely used in systems biomedicine to study genetic toggle switches.\n\nA fixed point $(x^\\ast, y^\\ast)$ satisfies\n$$\nx^\\ast = \\frac{\\beta}{1 + (y^\\ast)^n}, \\qquad y^\\ast = \\frac{\\beta}{1 + (x^\\ast)^n}.\n$$\n\nLocal stability of a fixed point is determined by the Jacobian matrix of the right-hand side evaluated at $(x^\\ast, y^\\ast)$. A fixed point is locally asymptotically stable if and only if both eigenvalues of the Jacobian have strictly negative real parts.\n\nYour task is to, for the case $n = 2$, compute numerically the fixed points and classify their local stability for three values of $\\beta$: $\\beta = 1$, $\\beta = 3$, and $\\beta = 10$. Use algorithmic root-finding to identify all fixed points in the biologically relevant domain $x \\ge 0$, $y \\ge 0$. Then, compute the Jacobian at each fixed point and classify stability via its eigenvalues.\n\nRequirements and constraints:\n- Use $n = 2$ throughout.\n- For each $\\beta$, search for fixed points in the domain $x \\in [0, \\beta]$ and $y \\in [0, \\beta]$.\n- For numerical classification, declare a fixed point stable if the real parts of both Jacobian eigenvalues are $ 0$, and unstable otherwise.\n- When aggregating results, sort fixed points by ascending $x$.\n\nTest suite:\n- Case $1$: $\\beta = 1$.\n- Case $2$: $\\beta = 3$.\n- Case $3$: $\\beta = 10$.\n\nFinal output specification:\n- For each test case, return a list with two elements: the integer number of fixed points found and a list of booleans indicating the stability of each fixed point (in the same order as sorted by ascending $x$).\n- Aggregate the results from all test cases into a single line printed as a comma-separated list enclosed in square brackets. For example, the final output must look like \n$$\n[[k_1, [s_{11}, s_{12}, ...]], [k_2, [...]], [k_3, [...]]]\n$$\nwhere $k_i$ are integers and $s_{ij}$ are booleans. No other text should be printed.", "solution": "The problem requires a numerical analysis to find and classify the fixed points of a genetic toggle switch model for a cooperativity of $n=2$ and three different values of the production rate, $\\beta$.\n\n**1. Fixed Point Identification**\nA fixed point $(x^\\ast, y^\\ast)$ is a solution to the system of nonlinear algebraic equations where the time derivatives are zero:\n$$\nx^\\ast = \\frac{\\beta}{1 + (y^\\ast)^2}, \\qquad y^\\ast = \\frac{\\beta}{1 + (x^\\ast)^2}\n$$\nThese equations are solved numerically. We define a vector function $\\vec{F}(x, y) = (x - \\beta/(1+y^2), y - \\beta/(1+x^2))$ and find its roots where $\\vec{F}(x,y) = \\vec{0}$. To ensure all physically relevant solutions (where $x, y \\ge 0$) are found, a numerical root-finding algorithm is used, starting from multiple initial guesses within the search domain $[0, \\beta] \\times [0, \\beta]$. Guesses should include the symmetric case (where $x=y$) and asymmetric cases (where $x$ is high and $y$ is low, and vice versa).\n\n**2. Stability Classification**\nThe local stability of each fixed point is determined by the eigenvalues of the system's Jacobian matrix evaluated at that point. For $n=2$, the Jacobian matrix $J$ is:\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\frac{\\beta}{1+y^2} - x)  \\frac{\\partial}{\\partial y}(\\frac{\\beta}{1+y^2} - x) \\\\ \\frac{\\partial}{\\partial x}(\\frac{\\beta}{1+x^2} - y)  \\frac{\\partial}{\\partial y}(\\frac{\\beta}{1+x^2} - y) \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{2\\beta y}{(1 + y^2)^2} \\\\ -\\frac{2\\beta x}{(1 + x^2)^2}  -1 \\end{pmatrix}\n$$\nFor each found fixed point $(x^\\ast, y^\\ast)$, we compute the eigenvalues of $J(x^\\ast, y^\\ast)$. A fixed point is classified as stable if and only if the real parts of both eigenvalues are strictly negative ($\\text{Re}(\\lambda_i)  0$). Otherwise, it is classified as unstable.\n\n**3. Execution for Test Cases**\nThis two-step process is performed for each given value of $\\beta$:\n- **Case 1 ($\\beta=1$):** This value is below the bifurcation threshold for bistability ($\\beta_{crit}=2$ for $n=2$). The numerical search finds a single, symmetric fixed point ($x^\\ast=y^\\ast$) which is stable.\n- **Case 2 ($\\beta=3$)  Case 3 ($\\beta=10$):** Both values are above the bifurcation threshold. For each case, the numerical search finds three fixed points: two stable asymmetric fixed points (one with $x^\\ast > y^\\ast$ and one with $y^\\ast > x^\\ast$, corresponding to the \"on/off\" states) and one unstable symmetric fixed point ($x^\\ast = y^\\ast$).\n\nThe final results are aggregated after sorting the unique fixed points by their $x$-coordinate.", "answer": "[[1, [True]],[3, [True, False, True]],[3, [True, False, True]]]", "id": "4347510"}]}