{"hands_on_practices": [{"introduction": "One of the foundational approaches to community detection is divisive clustering, where the network is progressively split into smaller groups. The Girvan-Newman algorithm is a canonical example of this method, leveraging the graph-theoretic concept of edge betweenness centrality to identify and remove the 'bridges' that connect communities. This practice [@problem_id:4329316] offers a concrete, step-by-step walkthrough of the algorithm's first iteration, providing hands-on experience in calculating betweenness and understanding its role in partitioning a protein-protein interaction network.", "problem": "Consider an undirected, unweighted protein-protein interaction (PPI) network in systems biomedicine with nodes $A, B, C, D, E, F, G, H$. This network represents two protein complexes connected by a linker protein. The edges are labeled as follows, each denoting a binary interaction: edge $1$: $(A,B)$, edge $2$: $(A,C)$, edge $3$: $(B,C)$, edge $4$: $(C,D)$, edge $5$: $(D,E)$, edge $6$: $(E,F)$, edge $7$: $(E,G)$, edge $8$: $(F,G)$, edge $9$: $(E,H)$. The topology consists of a left triad $A$–$B$–$C$ with a tail to $D$, and a right triad $E$–$F$–$G$ with a tail to $H$, bridged by edge $(D,E)$. Execute one iteration of the Girvan–Newman community detection algorithm: compute the edge betweenness centrality for each labeled edge based on shortest paths among all unordered pairs of distinct nodes, then identify the single edge to remove (if multiple edges are tied for removal, break ties by choosing the smallest edge index). Report the index of the edge to be removed as an integer. The final answer must be a single number. No rounding is necessary.", "solution": "The problem is valid as it presents a well-defined question in graph theory applied to a plausible network structure from systems biomedicine. All necessary information is provided, the terms are unambiguous, and the required task is computationally feasible and leads to a unique solution.\n\nThe task is to perform one iteration of the Girvan–Newman algorithm. This involves calculating the edge betweenness centrality for every edge in the network and then removing the edge with the highest centrality score. If there is a tie, the edge with the smallest index is removed.\n\nThe network consists of $8$ nodes, $V = \\{A, B, C, D, E, F, G, H\\}$, and $9$ undirected, unweighted edges:\n- edge $1$: $(A,B)$\n- edge $2$: $(A,C)$\n- edge $3$: $(B,C)$\n- edge $4$: $(C,D)$\n- edge $5$: $(D,E)$\n- edge $6$: $(E,F)$\n- edge $7$: $(E,G)$\n- edge $8$: $(F,G)$\n- edge $9$: $(E,H)$\n\nThe topology of the network consists of two 3-node cliques, $\\{A, B, C\\}$ and $\\{E, F, G\\}$, connected by a bridge structure. Specifically, node $C$ is connected to node $D$, which is connected to node $E$. Additionally, node $H$ is a leaf node connected to node $E$.\n\nThe edge betweenness centrality, $C_B(e)$, of an edge $e$ is defined as the sum of the fraction of shortest paths between all pairs of distinct nodes that pass through $e$.\n$$C_B(e) = \\sum_{u, v \\in V, u \\neq v} \\frac{\\sigma_{uv}(e)}{\\sigma_{uv}}$$\nwhere $\\sigma_{uv}$ is the total number of shortest paths between nodes $u$ and $v$, and $\\sigma_{uv}(e)$ is the number of those shortest paths that pass through edge $e$. Since the graph is undirected, we consider each unordered pair $\\{u, v\\}$ once.\n\nDue to the simple, acyclic nature of the connections between the cliques, for any pair of nodes $\\{u, v\\}$ in this specific graph, there is only one shortest path between them. Therefore, $\\sigma_{uv} = 1$ for all pairs $\\{u, v\\}$. The formula simplifies to counting the number of shortest paths that pass through each edge.\n\nWe will calculate $C_B(e)$ for each of the $9$ edges by identifying the pairs of nodes whose unique shortest path traverses that edge.\n\n1.  **Edge 5: $(D,E)$**\n    This edge is a bridge connecting the subgraph containing nodes $S_1 = \\{A, B, C, D\\}$ to the subgraph containing nodes $S_2 = \\{E, F, G, H\\}$. Any shortest path between a node $u \\in S_1$ and a node $v \\in S_2$ must pass through the edge $(D,E)$.\n    The number of nodes in $S_1$ is $|S_1| = 4$. The number of nodes in $S_2$ is $|S_2| = 4$.\n    The number of such pairs is $|S_1| \\times |S_2| = 4 \\times 4 = 16$.\n    Thus, $C_B(D,E) = 16$.\n\n2.  **Edge 4: $(C,D)$**\n    This edge is a bridge connecting the clique $\\{A, B, C\\}$ to the rest of the network, $\\{D, E, F, G, H\\}$. Let $S_1' = \\{A, B, C\\}$ and $S_2' = \\{D, E, F, G, H\\}$. Any shortest path between a node $u \\in S_1'$ and a node $v \\in S_2'$ must pass through the edge $(C,D)$.\n    The number of nodes in $S_1'$ is $|S_1'| = 3$. The number of nodes in $S_2'$ is $|S_2'| = 5$.\n    The number of such pairs is $|S_1'| \\times |S_2'| = 3 \\times 5 = 15$.\n    Thus, $C_B(C,D) = 15$.\n\n3.  **Edge 9: $(E,H)$**\n    This is a leaf edge. Any shortest path from node $H$ to any other node in the network must pass through $(E,H)$. There are $7$ other nodes: $\\{A, B, C, D, E, F, G\\}$.\n    Thus, $C_B(E,H) = 7$.\n\n4.  **Edges 1: $(A,B)$ and 8: $(F,G)$**\n    These edges are part of 3-node cliques. Consider edge $(A,B)$. A shortest path containing $(A,B)$ cannot also contain node $C$, as the path could be shortened by replacing the subpath $A-C-B$ (length $2$) with $A-B$ (length $1$) or vice versa. For example, a path $X-\\dots-C-A-B-\\dots-Y$ could be shortened to $X-\\dots-C-B-\\dots-Y$. This means no shortest path passes *through* the edge $(A,B)$ to connect other nodes. The only shortest path that uses edge $(A,B)$ is the path between $A$ and $B$ themselves.\n    Therefore, only the pair $\\{A,B\\}$ contributes to the centrality of $(A,B)$.\n    $C_B(A,B) = 1$.\n    By symmetry, for edge $(F,G)$, only the pair $\\{F,G\\}$ contributes.\n    $C_B(F,G) = 1$.\n\n5.  **Edges 2: $(A,C)$ and 3: $(B,C)$**\n    By the network's symmetry with respect to nodes $A$ and $B$, $C_B(A,C) = C_B(B,C)$. Let's calculate $C_B(A,C)$.\n    The shortest paths traversing $(A,C)$ are those connecting $A$ to nodes on the \"other side\" of $C$, and the path for the pair $\\{A,C\\}$ itself.\n    The nodes on the other side of $C$ from $A$ are $\\{B, D, E, F, G, H\\}$.\n    -   The shortest path from $A$ to $B$ is the direct edge $(A,B)$.\n    -   The shortest paths from $A$ to the set $\\{D, E, F, G, H\\}$ all begin with $A-C-D-\\dots$. There are $5$ such destination nodes.\n    -   The shortest path for the pair $\\{A,C\\}$ is the edge $(A,C)$ itself.\n    So, $5$ paths to nodes $\\{D, \\dots, H\\}$ plus the path for $\\{A,C\\}$ use this edge.\n    $C_B(A,C) = 5 + 1 = 6$.\n    By symmetry, $C_B(B,C) = 6$.\n\n6.  **Edges 6: $(E,F)$ and 7: $(E,G)$**\n    By symmetry of the network with respect to nodes $F$ and $G$, $C_B(E,F) = C_B(E,G)$. Let's calculate $C_B(E,F)$.\n    The shortest paths traversing $(E,F)$ are those connecting $F$ to nodes on the \"other side\" of $E$, and the path for the pair $\\{E,F\\}$ itself.\n    The nodes on the other side of $E$ from $F$ are $\\{A, B, C, D, H\\}$.\n    -   The shortest paths from $F$ to these $5$ nodes all begin with $F-E-\\dots$ (e.g., $F-E-D-C-A$). There are $5$ such paths.\n    -   The shortest path for the pair $\\{E,F\\}$ is the edge $(E,F)$ itself.\n    So, $C_B(E,F) = 5 + 1 = 6$.\n    By symmetry, $C_B(E,G) = 6$.\n\nSummary of edge betweenness centrality scores:\n-   $C_B(\\text{edge 1, } (A,B)) = 1$\n-   $C_B(\\text{edge 2, } (A,C)) = 6$\n-   $C_B(\\text{edge 3, } (B,C)) = 6$\n-   $C_B(\\text{edge 4, } (C,D)) = 15$\n-   $C_B(\\text{edge 5, } (D,E)) = 16$\n-   $C_B(\\text{edge 6, } (E,F)) = 6$\n-   $C_B(\\text{edge 7, } (E,G)) = 6$\n-   $C_B(\\text{edge 8, } (F,G)) = 1$\n-   $C_B(\\text{edge 9, } (E,H)) = 7$\n\nThe maximum centrality score is $16$, which corresponds to edge $(D,E)$. There are no ties for the maximum value.\nThe index of edge $(D,E)$ is given as $5$.\nTherefore, the single edge to be removed in the first iteration of the Girvan–Newman algorithm is edge $5$.", "answer": "$$\\boxed{5}$$", "id": "4329316"}, {"introduction": "While divisive methods are intuitive, many modern community detection algorithms focus on optimizing a quality function, with modularity being the most prominent. However, standard modularity suffers from a 'resolution limit,' often failing to identify small but well-defined communities. To address this, a resolution parameter, $\\gamma$, can be introduced into the modularity formula. This exercise [@problem_id:4329295] delves into this crucial concept, challenging you to determine the exact critical value of $\\gamma$ that favors a finer partition, thereby building an intuition for tuning algorithms to detect gene modules at different scales.", "problem": "Consider a Weighted Gene Coexpression Network (WGCN) on six genes with symmetric weighted adjacency matrix entries specified for $i \\neq j$ and $w_{ii} = 0$:\n- Within the trio $\\{1,2,3\\}$, $w_{12} = w_{13} = w_{23} = 0.8$.\n- Between $\\{1,2,3\\}$ and $\\{4,5\\}$, all weights are $0.1$, i.e., $w_{14} = w_{15} = w_{24} = w_{25} = w_{34} = w_{35} = 0.1$.\n- Within the pair $\\{4,5\\}$, $w_{45} = 0.9$.\n- Between each of $\\{1,2,3,4,5\\}$ and gene $6$, all weights are $0.2$, i.e., $w_{16} = w_{26} = w_{36} = w_{46} = w_{56} = 0.2$.\n\nLet $s_i = \\sum_{j} w_{ij}$ denote the node strength and $2m = \\sum_{i} s_i$ the total strength. Use the weighted configuration model null expectation for $i \\neq j$, $p_{ij} = \\frac{s_i s_j}{2m}$, and $p_{ii} = 0$. Using the generalized modularity with resolution parameter $\\gamma$, compute the modularity $Q(\\gamma)$ for the following two candidate partitions:\n- Partition $\\mathcal{P}_A$: communities $\\{1,2,3\\}$ and $\\{4,5,6\\}$.\n- Partition $\\mathcal{P}_B$: communities $\\{1,2,3\\}$, $\\{4,5\\}$, and $\\{6\\}$.\n\nDerive exact expressions (in terms of $\\gamma$) for $Q_A(\\gamma)$ and $Q_B(\\gamma)$ under the stated null model, and determine the exact critical value $\\gamma^{\\ast}$ at which $Q_A(\\gamma^{\\ast}) = Q_B(\\gamma^{\\ast})$. Within your derivation, explain from first principles how the choice of $\\gamma$ affects the resolution of small gene modules in a WGCN, and how one would select $\\gamma$ to resolve modules like $\\{4,5\\}$ and $\\{6\\}$. Express your final answer as the exact value of $\\gamma^{\\ast}$. No rounding is required.", "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides a complete set of data and definitions from the field of network science to allow for a unique, verifiable solution.\n\nThe problem requires the calculation and comparison of the generalized modularity, $Q(\\gamma)$, for two different partitions of a weighted network. The generalized modularity is defined as:\n$$Q(\\gamma) = \\frac{1}{2m} \\sum_{i,j} \\left[ w_{ij} - \\gamma \\frac{s_i s_j}{2m} \\right] \\delta(c_i, c_j)$$\nwhere $w_{ij}$ is the weight of the edge between nodes $i$ and $j$, $s_i = \\sum_{k} w_{ik}$ is the strength of node $i$, $2m = \\sum_{i} s_i$ is the total strength of the network, $c_i$ is the community assignment of node $i$, $\\delta(c_i, c_j)$ is the Kronecker delta which is $1$ if $c_i = c_j$ and $0$ otherwise, and $\\gamma$ is the resolution parameter.\n\nThis expression can be conveniently rewritten by summing over the communities $C$ in a partition $\\mathcal{P}$:\n$$Q(\\gamma) = \\sum_{C \\in \\mathcal{P}} \\left[ \\frac{L_C}{2m} - \\gamma \\left( \\frac{S_C}{2m} \\right)^2 \\right]$$\nwhere $L_C = \\sum_{i,j \\in C} w_{ij}$ is the sum of weights of all links within community $C$ (counting each link twice due to symmetry), and $S_C = \\sum_{i \\in C} s_i$ is the sum of strengths of all nodes in community $C$.\n\nFirst, we calculate the node strengths $s_i$ for the six genes based on the provided weighted adjacency matrix $W$.\nThe non-zero off-diagonal weights are: $w_{12} = w_{13} = w_{23} = 0.8$; $w_{14} = w_{15} = w_{24} = w_{25} = w_{34} = w_{35} = 0.1$; $w_{45} = 0.9$; and $w_{16} = w_{26} = w_{36} = w_{46} = w_{56} = 0.2$. The matrix is symmetric ($w_{ij} = w_{ji}$) and $w_{ii} = 0$.\n\nThe node strengths are:\n$s_1 = w_{12} + w_{13} + w_{14} + w_{15} + w_{16} = 0.8 + 0.8 + 0.1 + 0.1 + 0.2 = 2.0$\n$s_2 = w_{21} + w_{23} + w_{24} + w_{25} + w_{26} = 0.8 + 0.8 + 0.1 + 0.1 + 0.2 = 2.0$\n$s_3 = w_{31} + w_{32} + w_{34} + w_{35} + w_{36} = 0.8 + 0.8 + 0.1 + 0.1 + 0.2 = 2.0$\n$s_4 = w_{41} + w_{42} + w_{43} + w_{45} + w_{46} = 0.1 + 0.1 + 0.1 + 0.9 + 0.2 = 1.4$\n$s_5 = w_{51} + w_{52} + w_{53} + w_{54} + w_{56} = 0.1 + 0.1 + 0.1 + 0.9 + 0.2 = 1.4$\n$s_6 = w_{61} + w_{62} + w_{63} + w_{64} + w_{65} = 0.2 + 0.2 + 0.2 + 0.2 + 0.2 = 1.0$\n\nThe total network strength $2m$ is the sum of all node strengths:\n$$2m = s_1 + s_2 + s_3 + s_4 + s_5 + s_6 = 3 \\times 2.0 + 2 \\times 1.4 + 1.0 = 6.0 + 2.8 + 1.0 = 9.8$$\n\nNext, we define the communities for the two partitions and calculate their respective $S_C$ and $L_C$ values.\nLet $C_1 = \\{1,2,3\\}$, $C_2 = \\{4,5\\}$, $C_3 = \\{6\\}$, and $C_{23} = \\{4,5,6\\}$.\nPartition $\\mathcal{P}_A$ consists of communities $\\{C_1, C_{23}\\}$.\nPartition $\\mathcal{P}_B$ consists of communities $\\{C_1, C_2, C_3\\}$.\n\nFor community $C_1 = \\{1,2,3\\}$:\n$S_{C_1} = s_1 + s_2 + s_3 = 2.0 + 2.0 + 2.0 = 6.0$\n$L_{C_1} = 2(w_{12} + w_{13} + w_{23}) = 2(0.8 + 0.8 + 0.8) = 2(2.4) = 4.8$\n\nFor community $C_2 = \\{4,5\\}$:\n$S_{C_2} = s_4 + s_5 = 1.4 + 1.4 = 2.8$\n$L_{C_2} = 2(w_{45}) = 2(0.9) = 1.8$\n\nFor community $C_3 = \\{6\\}$:\n$S_{C_3} = s_6 = 1.0$\n$L_{C_3} = 0$ (since there are no self-loops)\n\nFor community $C_{23} = \\{4,5,6\\}$:\n$S_{C_{23}} = s_4 + s_5 + s_6 = 1.4 + 1.4 + 1.0 = 3.8$\n$L_{C_{23}}$ is the sum of internal links within $\\{4,5,6\\}$, which includes links within $\\{4,5\\}$ and links between $\\{4,5\\}$ and $\\{6\\}$:\n$L_{C_{23}} = L_{C_2} + 2(w_{46} + w_{56}) = 1.8 + 2(0.2 + 0.2) = 1.8 + 0.8 = 2.6$\n\nNow, we can write the modularity expressions for each partition.\nFor partition $\\mathcal{P}_A = \\{\\{1,2,3\\}, \\{4,5,6\\}\\}$:\n$$Q_A(\\gamma) = \\left[ \\frac{L_{C_1}}{2m} - \\gamma \\left(\\frac{S_{C_1}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_{23}}}{2m} - \\gamma \\left(\\frac{S_{C_{23}}}{2m}\\right)^2 \\right]$$\n$$Q_A(\\gamma) = \\frac{4.8}{9.8} - \\gamma \\left(\\frac{6.0}{9.8}\\right)^2 + \\frac{2.6}{9.8} - \\gamma \\left(\\frac{3.8}{9.8}\\right)^2$$\n$$Q_A(\\gamma) = \\frac{7.4}{9.8} - \\frac{\\gamma}{(9.8)^2} (6.0^2 + 3.8^2) = \\frac{74}{98} - \\frac{\\gamma}{96.04} (36 + 14.44)$$\n$$Q_A(\\gamma) = \\frac{37}{49} - \\gamma \\frac{50.44}{96.04} = \\frac{37}{49} - \\gamma \\frac{1261}{2401}$$\n\nFor partition $\\mathcal{P}_B = \\{\\{1,2,3\\}, \\{4,5\\}, \\{6\\}\\}$:\n$$Q_B(\\gamma) = \\left[ \\frac{L_{C_1}}{2m} - \\gamma \\left(\\frac{S_{C_1}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{2m} - \\gamma \\left(\\frac{S_{C_2}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_3}}{2m} - \\gamma \\left(\\frac{S_{C_3}}{2m}\\right)^2 \\right]$$\n$$Q_B(\\gamma) = \\frac{4.8}{9.8} - \\gamma \\left(\\frac{6.0}{9.8}\\right)^2 + \\frac{1.8}{9.8} - \\gamma \\left(\\frac{2.8}{9.8}\\right)^2 + \\frac{0}{9.8} - \\gamma \\left(\\frac{1.0}{9.8}\\right)^2$$\n$$Q_B(\\gamma) = \\frac{6.6}{9.8} - \\frac{\\gamma}{(9.8)^2} (6.0^2 + 2.8^2 + 1.0^2) = \\frac{66}{98} - \\frac{\\gamma}{96.04} (36 + 7.84 + 1)$$\n$$Q_B(\\gamma) = \\frac{33}{49} - \\gamma \\frac{44.84}{96.04} = \\frac{33}{49} - \\gamma \\frac{1121}{2401}$$\n\nWe need to find the critical value $\\gamma^{\\ast}$ where $Q_A(\\gamma^{\\ast}) = Q_B(\\gamma^{\\ast})$.\n$$\\frac{37}{49} - \\gamma^{\\ast} \\frac{1261}{2401} = \\frac{33}{49} - \\gamma^{\\ast} \\frac{1121}{2401}$$\n$$\\frac{37}{49} - \\frac{33}{49} = \\gamma^{\\ast} \\left( \\frac{1261}{2401} - \\frac{1121}{2401} \\right)$$\n$$\\frac{4}{49} = \\gamma^{\\ast} \\left( \\frac{140}{2401} \\right)$$\nSince $2401 = 49^2$:\n$$\\frac{4}{49} = \\gamma^{\\ast} \\frac{140}{49^2}$$\nMultiplying both sides by $49$:\n$$4 = \\gamma^{\\ast} \\frac{140}{49}$$\nSolving for $\\gamma^{\\ast}$:\n$$\\gamma^{\\ast} = 4 \\times \\frac{49}{140} = \\frac{196}{140}$$\nSimplifying the fraction:\n$$\\gamma^{\\ast} = \\frac{196 \\div 28}{140 \\div 28} = \\frac{7}{5}$$\n\nThe resolution parameter $\\gamma$ controls the balance between the observed internal community density (the $L_C$ term) and the penalty for a community's existence based on the null model (the $S_C^2$ term). A larger $\\gamma$ imposes a stronger penalty on communities, particularly those with a large total strength $S_C$, because the penalty term scales quadratically with $S_C$. This phenomenon is known as the \"resolution limit\" of modularity, where small, well-defined communities might be merged into larger ones if $\\gamma$ is too small (classically, $\\gamma=1$).\n\nThe transition from partition $\\mathcal{P}_A$ to $\\mathcal{P}_B$ involves splitting the community $C_{23}=\\{4,5,6\\}$ into two smaller communities, $C_2=\\{4,5\\}$ and $C_3=\\{6\\}$. For $\\gamma < \\gamma^{\\ast}$, we have $Q_A(\\gamma) > Q_B(\\gamma)$, meaning the coarser partition $\\mathcal{P}_A$ is preferred. For $\\gamma > \\gamma^{\\ast}$, we have $Q_B(\\gamma) > Q_A(\\gamma)$, meaning the finer partition $\\mathcal{P}_B$ is preferred. Thus, $\\gamma^{\\ast}$ is the critical resolution at which the algorithm is indifferent between keeping $\\{4,5,6\\}$ as a single module and splitting it. To resolve the smaller modules $\\{4,5\\}$ and $\\{6\\}$, one must select a resolution parameter $\\gamma > \\gamma^{\\ast} = \\frac{7}{5}$. At higher resolutions, the penalty for the large size of the merged community $\\{4,5,6\\}$ becomes great enough to favor the split, despite the loss of the internal links between $\\{4,5\\}$ and $\\{6\\}$ from the modularity score.", "answer": "$$\\boxed{\\frac{7}{5}}$$", "id": "4329295"}, {"introduction": "The community structures we seek in systems biology are inferred from experimental data that is often incomplete and noisy. It is crucial to understand how such imperfections affect the output of our algorithms. This problem [@problem_id:4329349] models this real-world challenge by considering false negative ($p$) and false positive ($r$) error rates in a protein interaction network. By deriving an expression for the modularity of the expected network, you will gain a quantitative understanding of how data quality directly impacts the detectability of biological modules.", "problem": "You are analyzing a small Protein-Protein Interaction (PPI) network in a systems biomedicine study. Six proteins, labeled $1,2,3,4,5,6$, form two putative complexes: $\\{1,2,3\\}$ and $\\{4,5,6\\}$. In the underlying biological interaction network, an undirected, unweighted edge exists between two proteins if and only if they are members of the same complex, and there are no interactions between proteins in different complexes. Let the true adjacency matrix be denoted by $A \\in \\mathbb{R}^{6 \\times 6}$, with $A_{ij} = 1$ if proteins $i$ and $j$ interact and $A_{ij} = 0$ otherwise, and let the true degree vector be $k \\in \\mathbb{R}^{6}$ with $k_i = \\sum_{j=1}^{6} A_{ij}$.\n\nIn the measurement process, each true interaction is missed independently with probability $p \\in (0,1)$, and each non-interaction is reported spuriously (false positive) independently with probability $r \\in (0,1)$. The measured adjacency is thus a random matrix $\\tilde{A}$, where for $i \\neq j$, a true edge is observed with probability $1-p$, and a true non-edge is observed with probability $r$. Define the expected measured adjacency matrix $\\bar{A}$ element-wise by $\\bar{A}_{ij} = \\mathbb{E}[\\tilde{A}_{ij}]$ for $i \\neq j$ and $\\bar{A}_{ii} = 0$. The expected degree vector is $\\bar{k}$ with $\\bar{k}_i = \\sum_{j=1}^{6} \\bar{A}_{ij}$, and the expected total edge weight is $m = \\sum_{1 \\leq i < j \\leq 6} \\bar{A}_{ij}$.\n\nTasks:\n1. Construct the true adjacency matrix $A$ and true degree vector $k$ based on the stated complexes.\n2. Using independence of measurement errors, write the entries of $\\bar{A}$ in terms of $p$ and $r$.\n3. Consider the partition $c$ that assigns proteins $\\{1,2,3\\}$ to one community and $\\{4,5,6\\}$ to the other. Starting from the core definition of modularity for undirected weighted graphs with a given partition, derive a closed-form symbolic expression, in terms of $p$ and $r$ only, for the modularity $Q(\\bar{A}, c)$ of the expected measured network with respect to this partition.\n4. Briefly explain, grounded in first principles of network modeling and community detection, how missing interactions (parameter $p$) and measurement noise (parameter $r$) alter $\\bar{A}$ and the downstream community detection behavior.\n\nProvide your final answer as the single simplified expression for $Q(\\bar{A}, c)$ in terms of $p$ and $r$. No numerical substitution is required. No units are to be reported. The final answer must be a single closed-form expression.", "solution": "The problem is deemed valid as it is scientifically grounded in network theory and systems biology, is well-posed with a unique solvable structure, and is stated objectively. All required information is provided and is internally consistent.\n\nThe solution proceeds by following the four specified tasks.\n\n### Task 1: True Adjacency Matrix and Degree Vector\n\nThe network consists of $6$ proteins, forming two complexes (communities), $C_1 = \\{1, 2, 3\\}$ and $C_2 = \\{4, 5, 6\\}$. An edge exists if and only if two proteins are in the same complex. This means the network is composed of two disjoint $3$-cliques (complete graphs on $3$ vertices).\n\nThe true adjacency matrix $A \\in \\mathbb{R}^{6 \\times 6}$ is defined as $A_{ij}=1$ if an edge exists between proteins $i$ and $j$, and $A_{ij}=0$ otherwise. By convention, $A_{ii}=0$. The matrix $A$ is block-diagonal:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}\n$$\nThe true degree $k_i$ of a protein $i$ is the number of interactions it has, given by $k_i = \\sum_{j=1}^{6} A_{ij}$. Each protein in $C_1$ is connected to the other $2$ proteins in $C_1$. Similarly, each protein in $C_2$ is connected to the other $2$ proteins in $C_2$. Therefore, the degree of every protein is $2$.\nThe true degree vector $k \\in \\mathbb{R}^6$ is:\n$$\nk = \\begin{pmatrix} 2 & 2 & 2 & 2 & 2 & 2 \\end{pmatrix}^T\n$$\n\n### Task 2: Expected Measured Adjacency Matrix\n\nThe measured adjacency matrix $\\tilde{A}$ is a random matrix. The expected measured adjacency matrix $\\bar{A}$ has entries $\\bar{A}_{ij} = \\mathbb{E}[\\tilde{A}_{ij}]$ for $i \\neq j$. Since $\\tilde{A}_{ij}$ is a Bernoulli random variable (it can only be $0$ or $1$), its expectation is the probability that $\\tilde{A}_{ij}=1$.\n\nWe consider two cases for $i \\neq j$:\n1.  A true interaction exists ($A_{ij}=1$): This occurs when proteins $i$ and $j$ are in the same complex. The interaction is observed with probability $1-p$. Thus, $\\mathbb{P}(\\tilde{A}_{ij}=1 | A_{ij}=1) = 1-p$.\n2.  No true interaction exists ($A_{ij}=0$): This occurs when proteins $i$ and $j$ are in different complexes. A spurious interaction is reported with probability $r$. Thus, $\\mathbb{P}(\\tilde{A}_{ij}=1 | A_{ij}=0) = r$.\n\nCombining these, the entries of $\\bar{A}$ are:\n-   $\\bar{A}_{ij} = 1-p$ if $i$ and $j$ are in the same complex ($i \\neq j$).\n-   $\\bar{A}_{ij} = r$ if $i$ and $j$ are in different complexes.\n-   $\\bar{A}_{ii} = 0$ for all $i$.\n\n### Task 3: Modularity of the Expected Network\n\nThe modularity $Q$ for a weighted, undirected graph partitioned into communities is given by:\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\nwhere $c$ indexes the communities, $L_c$ is the sum of weights of edges within community $c$, $K_c$ is the sum of the strengths (weighted degrees) of all nodes in community $c$, and $m$ is the sum of all edge weights in the network.\n\nFirst, we calculate the necessary quantities for the expected network $\\bar{A}$.\n-   **Total edge weight $m$**:\n    $m = \\sum_{1 \\le i < j \\le 6} \\bar{A}_{ij}$. There are $\\binom{3}{2}=3$ pairs within $C_1$ and $3$ pairs within $C_2$. These $6$ intra-community pairs have weight $1-p$. There are $3 \\times 3 = 9$ inter-community pairs, which have weight $r$.\n    $$ m = 6(1-p) + 9r $$\n-   **Node strength (expected degree) $\\bar{k}_i$**:\n    For any node $i \\in C_1$ (e.g., $i=1$), it has $2$ intra-community connections (to nodes $2, 3$) and $3$ inter-community connections (to nodes $4, 5, 6$).\n    $$ \\bar{k}_i = 2(1-p) + 3r \\quad \\text{for } i \\in C_1 $$\n    By symmetry, the same holds for any node in $C_2$. Let $\\bar{k}_{node} = 2(1-p) + 3r$. So $\\bar{k}_i = \\bar{k}_{node}$ for all $i=1, \\dots, 6$.\n-   **Sum of weights within communities, $L_c$**:\n    For $C_1$, there are $3$ edges, each with weight $1-p$. So, $L_{C_1} = 3(1-p)$.\n    Similarly, for $C_2$, $L_{C_2} = 3(1-p)$.\n-   **Sum of strengths within communities, $K_c$**:\n    For $C_1$, $K_{C_1} = \\sum_{i \\in C_1} \\bar{k}_i = 3 \\times \\bar{k}_{node} = 3(2(1-p) + 3r)$.\n    Similarly, for $C_2$, $K_{C_2} = 3(2(1-p) + 3r)$.\n\nThe total sum of strengths is $2m = \\sum_{i=1}^6 \\bar{k}_i = 6 \\bar{k}_{node} = 6(2(1-p)+3r) = 12(1-p)+18r$, which matches our calculation for $m$.\n\nNow, we compute the modularity $Q(\\bar{A}, c)$. Since the two communities $C_1$ and $C_2$ are symmetric, we can write:\n$$\nQ = 2 \\left[ \\frac{L_{C_1}}{m} - \\left( \\frac{K_{C_1}}{2m} \\right)^2 \\right]\n$$\nSubstitute the expressions in terms of $p$ and $r$:\n$$\nQ = 2 \\left[ \\frac{3(1-p)}{6(1-p) + 9r} - \\left( \\frac{3(2(1-p) + 3r)}{2(6(1-p) + 9r)} \\right)^2 \\right]\n$$\nFactor out a $3$ from the denominators:\n$$\nQ = 2 \\left[ \\frac{3(1-p)}{3(2(1-p) + 3r)} - \\left( \\frac{3(2(1-p) + 3r)}{2 \\cdot 3(2(1-p) + 3r)} \\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{1-p}{2(1-p) + 3r} - \\left( \\frac{1}{2} \\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{1-p}{2(1-p) + 3r} - \\frac{1}{4} \\right]\n$$\n$$\nQ = \\frac{2(1-p)}{2(1-p) + 3r} - \\frac{1}{2}\n$$\nCombine the terms by finding a common denominator:\n$$\nQ = \\frac{2 \\cdot 2(1-p) - 1 \\cdot (2(1-p) + 3r)}{2(2(1-p) + 3r)}\n$$\n$$\nQ = \\frac{4(1-p) - 2(1-p) - 3r}{2(2(1-p) + 3r)}\n$$\n$$\nQ = \\frac{2(1-p) - 3r}{2(2(1-p) + 3r)}\n$$\nThis is the final simplified symbolic expression for the modularity.\n\n### Task 4: Explanation of Parameter Effects\n\nThe parameters $p$ and $r$ represent two distinct types of measurement error: false negatives (missing true interactions) and false positives (reporting spurious interactions), respectively.\n\n1.  **Effect on $\\bar{A}$**:\n    -   The parameter $p \\in (0,1)$ controls the rate of missing true interactions. An increase in $p$ reduces the weight of intra-community edges in the expected network $\\bar{A}$ from $1$ towards $0$ (specifically, the weight is $1-p$). This weakens the \"signal\" that defines the communities, making them less cohesive.\n    -   The parameter $r \\in (0,1)$ controls the rate of spurious interactions. An increase in $r$ adds weight to the inter-community edges, which are absent in the true network. This introduces \"noise\" that blurs the boundaries between communities, effectively connecting previously separate modules.\n\n2.  **Effect on Community Detection**:\n    -   Community detection algorithms, particularly those based on modularity optimization, function by identifying partitions of the network that have a high density of internal edges and a low density of external edges compared to a random null model.\n    -   Increasing $p$ diminishes the internal cohesion (numerator of the first term in the modularity formula), while increasing $r$ introduces external connections (which both decreases the numerator and increases the denominator in the modularity score). Both effects degrade the quality of the community structure by reducing the contrast between intra- and inter-community connectivity.\n    -   The derived expression for modularity, $Q = \\frac{2(1-p) - 3r}{2(2(1-p) + 3r)}$, quantitatively captures this degradation. For the community structure to be detectable ($Q > 0$), the numerator must be positive, which implies $2(1-p) - 3r > 0$, or $2p+3r < 2$. This inequality shows the trade-off between the two error types. In this specific topology, the modularity is more sensitive to false positives ($r$, coefficient $3$) than to false negatives ($p$, coefficient $2$), because there are more non-edges ($9$) that can become noise than true edges ($6$) that can be lost as signal. When $1-p = r$, the expected graph becomes a complete graph with uniform edge weights, and the community structure is completely lost, yielding a negative modularity score.", "answer": "$$\n\\boxed{\\frac{2(1-p) - 3r}{2(2(1-p) + 3r)}}\n$$", "id": "4329349"}]}