{"hands_on_practices": [{"introduction": "A cornerstone of the diseasome concept is quantifying the similarity between diseases. This exercise guides you through a foundational method for calculating this similarity based on shared clinical phenotypes, using the structured vocabulary of the Human Phenotype Ontology (HPO). You will apply the Resnik similarity measure, which is grounded in the information-theoretic concept of Information Content, to determine the relatedness of diseases at a molecular level. Completing this practice will equip you with a core skill for constructing and interpreting phenotype-driven disease networks. [@problem_id:4393308]", "problem": "You are given two diseases, $X$ and $Y$, each annotated with a set of Human Phenotype Ontology (HPO) terms. The Human Phenotype Ontology (HPO) is organized as a directed acyclic graph (DAG) with “is-a” relationships, and the semantic similarity between two HPO terms will be computed using the Resnik measure grounded in Information Content (IC). The disease–disease similarity will be aggregated using the Best-Match Average, defined as the mean of the maximal term–term similarities computed in both directions.\n\nFundamental definitions for this problem:\n- For any HPO term $t$, let $p(t)$ denote its empirical probability of annotation; the Information Content (IC) is defined by $\\mathrm{IC}(t) = -\\ln p(t)$, where $\\ln$ is the natural logarithm.\n- For two HPO terms $t_i$ and $t_j$, the Resnik semantic similarity is defined as the maximum IC among their common ancestors in the DAG: $\\mathrm{sim}_{\\mathrm{Resnik}}(t_i, t_j) = \\max\\{\\mathrm{IC}(u) : u \\in \\mathrm{Anc}(t_i) \\cap \\mathrm{Anc}(t_j)\\}$, where $\\mathrm{Anc}(t)$ denotes the set of ancestors of $t$ including $t$ itself.\n- To aggregate the term–term similarities into a disease–disease similarity using Best-Match Average, proceed as follows: for each term in one disease’s set, take its maximum similarity to any term in the other disease’s set and average across that set; repeat this in the reverse direction; then take the mean of the two directional averages.\n\nConsider the following fragment of the HPO DAG with specified ancestor sets and probabilities. Let $r$ denote the root term “Phenotypic abnormality” with $p(r) = 1$. The mid-level terms are:\n- $p_1$: “Cardiovascular abnormality” with $p(p_1) = \\exp(-1)$,\n- $p_2$: “Neurological abnormality” with $p(p_2) = \\exp(-1.2)$,\n- $d$: “Autonomic nervous system abnormality” with $p(d) = \\exp(-1.6)$.\n\nAdditional internal phenotype terms:\n- $c_1$: “Cardiac conduction phenotype” with $p(c_1) = \\exp(-2.0)$,\n- $c_2$: “Cardiac muscle phenotype” with $p(c_2) = \\exp(-1.8)$,\n- $n_2$: “Motor coordination phenotype” with $p(n_2) = \\exp(-2.0)$.\n\nLeaf-level HPO terms annotated to diseases:\n- Disease $X$ is annotated with $T_X = \\{a_1, a_2, a_3\\}$ where:\n  - $a_1$: “Arrhythmia” with $p(a_1) = \\exp(-3.0)$ and $\\mathrm{Anc}(a_1) = \\{a_1, c_1, p_1, r\\}$,\n  - $a_2$: “Cardiomyopathy” with $p(a_2) = \\exp(-2.5)$ and $\\mathrm{Anc}(a_2) = \\{a_2, c_2, p_1, r\\}$,\n  - $a_3$: “Syncope” with $p(a_3) = \\exp(-2.2)$ and $\\mathrm{Anc}(a_3) = \\{a_3, d, p_2, p_1, r\\}$.\n- Disease $Y$ is annotated with $T_Y = \\{b_1, b_2\\}$ where:\n  - $b_1$: “Orthostatic hypotension” with $p(b_1) = \\exp(-3.1)$ and $\\mathrm{Anc}(b_1) = \\{b_1, d, p_2, r\\}$,\n  - $b_2$: “Ataxia” with $p(b_2) = \\exp(-2.7)$ and $\\mathrm{Anc}(b_2) = \\{b_2, n_2, p_2, r\\}$.\n\nTasks:\n1. Compute the Information Content $\\mathrm{IC}(t)$ for every term $t$ that can serve as a common ancestor between any pair from $T_X \\times T_Y$.\n2. Compute all pairwise Resnik semantic similarities $\\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_j)$ for $a_i \\in T_X$ and $b_j \\in T_Y$ using the most informative common ancestor definition above.\n3. Aggregate the term–term similarities into a single disease–disease similarity score for $(X, Y)$ using Best-Match Average as described. Express the final disease–disease similarity score as a single exact number. No rounding is required and no units should be used.", "solution": "The solution proceeds in three steps as requested by the problem statement.\n\n**1. Compute the Information Content (IC)**\nThe IC is defined as $\\mathrm{IC}(t) = -\\ln p(t)$. Given that the probabilities are of the form $p(t) = \\exp(-k)$, the IC simplifies to $\\mathrm{IC}(t) = -\\ln(\\exp(-k)) = k$.\nWe need the ICs for all terms that are potential common ancestors between any term in $T_X$ and any term in $T_Y$. By inspecting the ancestor sets, these terms are $r$, $p_1$, $p_2$, and $d$.\n\n- $\\mathrm{IC}(r) = -\\ln(p(r)) = -\\ln(1) = 0$.\n- $\\mathrm{IC}(p_1) = -\\ln(p(p_1)) = -\\ln(\\exp(-1)) = 1$.\n- $\\mathrm{IC}(p_2) = -\\ln(p(p_2)) = -\\ln(\\exp(-1.2)) = 1.2$.\n- $\\mathrm{IC}(d) = -\\ln(p(d)) = -\\ln(\\exp(-1.6)) = 1.6$.\n\n**2. Compute Pairwise Resnik Semantic Similarities**\nThe Resnik similarity is $\\mathrm{sim}_{\\mathrm{Resnik}}(t_i, t_j) = \\max\\{\\mathrm{IC}(u) : u \\in \\mathrm{Anc}(t_i) \\cap \\mathrm{Anc}(t_j)\\}$. We must compute this for all $6$ pairs $(a_i, b_j)$ where $a_i \\in T_X$ and $b_j \\in T_Y$.\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_1)$:**\n  $\\mathrm{Anc}(a_1) \\cap \\mathrm{Anc}(b_1) = \\{a_1, c_1, p_1, r\\} \\cap \\{b_1, d, p_2, r\\} = \\{r\\}$.\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_1) = \\max\\{\\mathrm{IC}(r)\\} = 0$.\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_2)$:**\n  $\\mathrm{Anc}(a_1) \\cap \\mathrm{Anc}(b_2) = \\{a_1, c_1, p_1, r\\} \\cap \\{b_2, n_2, p_2, r\\} = \\{r\\}$.\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_2) = \\max\\{\\mathrm{IC}(r)\\} = 0$.\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_1)$:**\n  $\\mathrm{Anc}(a_2) \\cap \\mathrm{Anc}(b_1) = \\{a_2, c_2, p_1, r\\} \\cap \\{b_1, d, p_2, r\\} = \\{r\\}$.\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_1) = \\max\\{\\mathrm{IC}(r)\\} = 0$.\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_2)$:**\n  $\\mathrm{Anc}(a_2) \\cap \\mathrm{Anc}(b_2) = \\{a_2, c_2, p_1, r\\} \\cap \\{b_2, n_2, p_2, r\\} = \\{r\\}$.\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_2) = \\max\\{\\mathrm{IC}(r)\\} = 0$.\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_1)$:**\n  $\\mathrm{Anc}(a_3) \\cap \\mathrm{Anc}(b_1) = \\{a_3, d, p_2, p_1, r\\} \\cap \\{b_1, d, p_2, r\\} = \\{d, p_2, r\\}$.\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_1) = \\max\\{\\mathrm{IC}(d), \\mathrm{IC}(p_2), \\mathrm{IC}(r)\\} = \\max\\{1.6, 1.2, 0\\} = 1.6$.\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_2)$:**\n  $\\mathrm{Anc}(a_3) \\cap \\mathrm{Anc}(b_2) = \\{a_3, d, p_2, p_1, r\\} \\cap \\{b_2, n_2, p_2, r\\} = \\{p_2, r\\}$.\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_2) = \\max\\{\\mathrm{IC}(p_2), \\mathrm{IC}(r)\\} = \\max\\{1.2, 0\\} = 1.2$.\n\nThe matrix of pairwise similarities is:\n$$\n\\begin{array}{c|cc}\n\\mathrm{sim}_{\\mathrm{Resnik}} & b_1 & b_2 \\\\\n\\hline\na_1 & 0   & 0 \\\\\na_2 & 0   & 0 \\\\\na_3 & 1.6 & 1.2 \\\\\n\\end{array}\n$$\n\n**3. Aggregate using Best-Match Average (BMA)**\nThe BMA similarity is the mean of the two directional averages.\nLet the directional average from a set $A$ to a set $B$ be denoted by $\\mathrm{sim}_{avg}(A \\to B)$.\n$$\n\\mathrm{sim}_{BMA}(X, Y) = \\frac{1}{2} \\left( \\mathrm{sim}_{avg}(T_X \\to T_Y) + \\mathrm{sim}_{avg}(T_Y \\to T_X) \\right)\n$$\nwhere\n$$\n\\mathrm{sim}_{avg}(T_X \\to T_Y) = \\frac{1}{|T_X|} \\sum_{a_i \\in T_X} \\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_j)\n$$\nand\n$$\n\\mathrm{sim}_{avg}(T_Y \\to T_X) = \\frac{1}{|T_Y|} \\sum_{b_j \\in T_Y} \\max_{a_i \\in T_X} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_j)\n$$\n\nFirst, we compute the directional average from $T_X$ to $T_Y$. $|T_X| = 3$.\n- For $a_1$: $\\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_j) = \\max\\{0, 0\\} = 0$.\n- For $a_2$: $\\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_j) = \\max\\{0, 0\\} = 0$.\n- For $a_3$: $\\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_j) = \\max\\{1.6, 1.2\\} = 1.6$.\n$$\n\\mathrm{sim}_{avg}(T_X \\to T_Y) = \\frac{1}{3} (0 + 0 + 1.6) = \\frac{1.6}{3}\n$$\n\nNext, we compute the directional average from $T_Y$ to $T_X$. $|T_Y| = 2$.\n- For $b_1$: $\\max_{a_i \\in T_X} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_1) = \\max\\{0, 0, 1.6\\} = 1.6$.\n- For $b_2$: $\\max_{a_i \\in T_X} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_2) = \\max\\{0, 0, 1.2\\} = 1.2$.\n$$\n\\mathrm{sim}_{avg}(T_Y \\to T_X) = \\frac{1}{2} (1.6 + 1.2) = \\frac{2.8}{2} = 1.4\n$$\n\nFinally, we compute the BMA similarity score.\n$$\n\\mathrm{sim}_{BMA}(X, Y) = \\frac{1}{2} \\left( \\frac{1.6}{3} + 1.4 \\right)\n$$\nTo express this as an exact fraction:\n$$\n\\frac{1.6}{3} = \\frac{16/10}{3} = \\frac{16}{30} = \\frac{8}{15}\n$$\n$$\n1.4 = \\frac{14}{10} = \\frac{7}{5}\n$$\n$$\n\\mathrm{sim}_{BMA}(X, Y) = \\frac{1}{2} \\left( \\frac{8}{15} + \\frac{7}{5} \\right) = \\frac{1}{2} \\left( \\frac{8}{15} + \\frac{21}{15} \\right) = \\frac{1}{2} \\left( \\frac{29}{15} \\right) = \\frac{29}{30}\n$$\nThe final disease–disease similarity score is $\\frac{29}{30}$.", "answer": "$$\\boxed{\\frac{29}{30}}$$", "id": "4393308"}, {"introduction": "Once a diseasome network is constructed, a primary goal is to identify the most influential diseases. This exercise introduces you to network centrality, a fundamental concept for ranking the importance of nodes. You will compare two powerful measures on a toy diseasome: weighted degree centrality, a local measure of connectivity, and eigenvector centrality, which captures a disease's influence by considering its connections to other important diseases. This practice will deepen your understanding of how different topological perspectives can reveal a disease's systemic role. [@problem_id:4393332]", "problem": "In systems biomedicine, the human diseasome network is the disease–disease projection of a bipartite disease–gene association network, where two diseases are connected if they share protein-coding genes. Consider a toy, undirected, weighted diseasome network with three diseases $D_A$, $D_B$, and $D_C$. The edge weight $w_{ij}$ equals the number of shared protein-coding genes between diseases $i$ and $j$, with $w_{AB} = 1$, $w_{AC} = 1$, $w_{BC} = 3$, and $w_{ii} = 0$ for all $i$. The weighted adjacency matrix is the real symmetric matrix $A$ with entries $a_{ij} = w_{ij}$.\n\nStarting from the spectral theorem for real symmetric matrices and the Perron–Frobenius theorem (PF) for irreducible nonnegative matrices, define eigenvector centrality (EC) as the positive eigenvector associated with the largest eigenvalue of $A$. Normalize the EC vector so that its entries sum to $1$ (that is, use $\\ell_{1}$ normalization). Define weighted degree centrality (DC) as $s_i = \\sum_{j} a_{ij}$ and normalize by the total strength, $\\hat{s}_i = s_i / \\sum_{k} s_k$, so that the normalized DC entries also sum to $1$.\n\nUsing these foundations, derive the normalized EC and normalized DC for the network above. Then compute the difference between the normalized EC of $D_A$ and the normalized DC of $D_A$. Express your final answer as a unitless real number and round your answer to four significant figures.", "solution": "The first step is to construct the weighted adjacency matrix $A$ for the network of three diseases $D_A$, $D_B$, and $D_C$. Let the diseases correspond to indices $1$, $2$, and $3$ respectively. The entries of the matrix $a_{ij}$ are the weights $w_{ij}$. Given $w_{AB} = 1$, $w_{AC} = 1$, $w_{BC} = 3$, and $w_{ii}=0$, and knowing the network is undirected ($w_{ij} = w_{ji}$), the matrix $A$ is:\n$$\nA = \\begin{pmatrix} a_{AA} & a_{AB} & a_{AC} \\\\ a_{BA} & a_{BB} & a_{BC} \\\\ a_{CA} & a_{CB} & a_{CC} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 3 \\\\ 1 & 3 & 0 \\end{pmatrix}\n$$\nThis matrix is real, symmetric, non-negative, and irreducible (as the corresponding graph is connected), so the Perron–Frobenius theorem applies.\n\nFirst, we calculate the normalized weighted degree centrality (DC). The unnormalized degree centrality (strength) $s_i$ for a node $i$ is the sum of the weights of its incident edges, which is the sum of the entries in the corresponding row of the adjacency matrix: $s_i = \\sum_{j} a_{ij}$.\nFor disease $D_A$: $s_A = a_{11} + a_{12} + a_{13} = 0 + 1 + 1 = 2$.\nFor disease $D_B$: $s_B = a_{21} + a_{22} + a_{23} = 1 + 0 + 3 = 4$.\nFor disease $D_C$: $s_C = a_{31} + a_{32} + a_{33} = 1 + 3 + 0 = 4$.\n\nThe total strength is the sum of all individual strengths: $\\sum_k s_k = s_A + s_B + s_C = 2 + 4 + 4 = 10$.\nThe normalized degree centrality $\\hat{s}_i$ is given by $\\hat{s}_i = s_i / \\sum_k s_k$.\nFor disease $D_A$, the normalized degree centrality is:\n$$\nDC_A = \\hat{s}_A = \\frac{2}{10} = \\frac{1}{5} = 0.2\n$$\n\nNext, we calculate the normalized eigenvector centrality (EC). This requires finding the eigenvector corresponding to the largest eigenvalue of the matrix $A$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\begin{pmatrix} -\\lambda & 1 & 1 \\\\ 1 & -\\lambda & 3 \\\\ 1 & 3 & -\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant:\n$$\n-\\lambda((-\\lambda)(-\\lambda) - 3 \\cdot 3) - 1(1(-\\lambda) - 3 \\cdot 1) + 1(1 \\cdot 3 - (-\\lambda) \\cdot 1) = 0 \\\\\n-\\lambda(\\lambda^2 - 9) - (-\\lambda - 3) + (3 + \\lambda) = 0 \\\\\n-\\lambda^3 + 9\\lambda + \\lambda + 3 + 3 + \\lambda = 0 \\\\\n-\\lambda^3 + 11\\lambda + 6 = 0 \\\\\n\\lambda^3 - 11\\lambda - 6 = 0\n$$\nBy inspection, we can test integer factors of $-6$. For $\\lambda = -3$: $(-3)^3 - 11(-3) - 6 = -27 + 33 - 6 = 0$. Thus, $(\\lambda+3)$ is a factor. Performing polynomial division of $(\\lambda^3 - 11\\lambda - 6)$ by $(\\lambda+3)$ yields $\\lambda^2 - 3\\lambda - 2$.\nThe remaining eigenvalues are the roots of $\\lambda^2 - 3\\lambda - 2 = 0$. Using the quadratic formula:\n$$\n\\lambda = \\frac{-(-3) \\pm \\sqrt{(-3)^2 - 4(1)(-2)}}{2} = \\frac{3 \\pm \\sqrt{9+8}}{2} = \\frac{3 \\pm \\sqrt{17}}{2}\n$$\nThe three eigenvalues are $\\lambda_1 = \\frac{3 + \\sqrt{17}}{2}$, $\\lambda_2 = \\frac{3 - \\sqrt{17}}{2}$, and $\\lambda_3 = -3$.\nNumerically, $\\sqrt{17} \\approx 4.123$, so $\\lambda_1 \\approx 3.562$, $\\lambda_2 \\approx -0.562$, and $\\lambda_3 = -3$. The largest eigenvalue is $\\lambda_{\\text{max}} = \\frac{3 + \\sqrt{17}}{2}$.\n\nNow, we find the eigenvector $\\mathbf{v} = (v_A, v_B, v_C)^T$ corresponding to $\\lambda_{\\text{max}}$ by solving $(A - \\lambda_{\\text{max}} I)\\mathbf{v} = \\mathbf{0}$.\n$$\n\\begin{pmatrix} -\\lambda_{\\text{max}} & 1 & 1 \\\\ 1 & -\\lambda_{\\text{max}} & 3 \\\\ 1 & 3 & -\\lambda_{\\text{max}} \\end{pmatrix} \\begin{pmatrix} v_A \\\\ v_B \\\\ v_C \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nFrom the second row: $v_A - \\lambda_{\\text{max}} v_B + 3v_C = 0$.\nFrom the third row: $v_A + 3v_B - \\lambda_{\\text{max}} v_C = 0$.\nSubtracting the second equation from the third gives $(3 + \\lambda_{\\text{max}})v_B - (3 + \\lambda_{\\text{max}})v_C = 0$. Since $\\lambda_{\\text{max}} \\neq -3$, this implies $v_B = v_C$.\nSubstituting $v_C = v_B$ into the second equation: $v_A - \\lambda_{\\text{max}}v_B + 3v_B = 0$, which gives $v_A = (\\lambda_{\\text{max}} - 3)v_B$.\nThe eigenvector is proportional to $\\mathbf{v'} = ((\\lambda_{\\text{max}} - 3), 1, 1)^T$.\nLet's find the value of the first component:\n$$\n\\lambda_{\\text{max}} - 3 = \\frac{3 + \\sqrt{17}}{2} - 3 = \\frac{3 + \\sqrt{17} - 6}{2} = \\frac{\\sqrt{17} - 3}{2}\n$$\nSo, the unnormalized eigenvector is $\\mathbf{v'} = \\left(\\frac{\\sqrt{17} - 3}{2}, 1, 1\\right)^T$. As $\\sqrt{17} > 3$, all components are positive, as guaranteed by the Perron-Frobenius theorem.\n\nTo get the EC vector, we normalize $\\mathbf{v'}$ using the $\\ell_1$ norm, i.e., making the sum of its entries equal to $1$.\nThe sum of the components is:\n$$\nS = \\frac{\\sqrt{17} - 3}{2} + 1 + 1 = \\frac{\\sqrt{17} - 3 + 2 + 2}{2} = \\frac{\\sqrt{17} + 1}{2}\n$$\nThe normalized EC for disease $D_A$ is the first component of $\\mathbf{v'}$ divided by the sum $S$:\n$$\nEC_A = \\frac{(\\sqrt{17} - 3)/2}{(\\sqrt{17} + 1)/2} = \\frac{\\sqrt{17} - 3}{\\sqrt{17} + 1}\n$$\nTo simplify, we rationalize the denominator:\n$$\nEC_A = \\frac{\\sqrt{17} - 3}{\\sqrt{17} + 1} \\times \\frac{\\sqrt{17} - 1}{\\sqrt{17} - 1} = \\frac{17 - \\sqrt{17} - 3\\sqrt{17} + 3}{17 - 1} = \\frac{20 - 4\\sqrt{17}}{16} = \\frac{5 - \\sqrt{17}}{4}\n$$\n\nFinally, we compute the difference between the normalized EC of $D_A$ and the normalized DC of $D_A$.\n$$\n\\text{Difference} = EC_A - DC_A = \\frac{5 - \\sqrt{17}}{4} - \\frac{1}{5}\n$$\nCombining the terms:\n$$\n\\text{Difference} = \\frac{5(5 - \\sqrt{17}) - 4(1)}{20} = \\frac{25 - 5\\sqrt{17} - 4}{20} = \\frac{21 - 5\\sqrt{17}}{20}\n$$\nTo provide a numerical answer rounded to four significant figures, we approximate the value:\n$$\n\\sqrt{17} \\approx 4.1231056\n$$\n$$\n\\text{Difference} \\approx \\frac{21 - 5(4.1231056)}{20} = \\frac{21 - 20.615528}{20} = \\frac{0.384472}{20} = 0.0192236\n$$\nRounding to four significant figures gives $0.01922$.", "answer": "$$\\boxed{0.01922}$$", "id": "4393332"}, {"introduction": "Constructing a diseasome network from underlying bipartite data, such as disease-gene associations, requires statistical rigor to avoid spurious connections. Simply counting shared genes can be misleading, as some genes are linked to many diseases simply because they are well-studied. This advanced exercise introduces a powerful solution: using a null model, the Bipartite Configuration Model (BiCM), to assess the statistical significance of a shared gene link. By calculating a $z$-score for each connection, you will learn to distinguish high-confidence disease relationships from those that could arise by chance, a critical skill for robust network inference. [@problem_id:4393323]", "problem": "In systems biomedicine, the human diseasome network is often constructed by projecting a bipartite disease–gene association graph onto the disease layer. Let a bipartite graph have a disease set $\\mathcal{D}=\\{D_{1},D_{2},D_{3},D_{4}\\}$ and a gene set $\\mathcal{G}=\\{G_{1},G_{2},G_{3},G_{4},G_{5}\\}$. The adjacency between diseases and genes is given by a binary matrix $B \\in \\{0,1\\}^{4 \\times 5}$ defined by the following nonzero entries: $B_{1,1}=1$, $B_{1,2}=1$, $B_{1,4}=1$; $B_{2,1}=1$, $B_{2,3}=1$, $B_{2,4}=1$; $B_{3,1}=1$, $B_{3,3}=1$, $B_{3,5}=1$; $B_{4,2}=1$, $B_{4,3}=1$, $B_{4,5}=1$. This corresponds to diseases $D_{1}$ connected to genes $\\{G_{1},G_{2},G_{4}\\}$, $D_{2}$ to $\\{G_{1},G_{3},G_{4}\\}$, $D_{3}$ to $\\{G_{1},G_{3},G_{5}\\}$, and $D_{4}$ to $\\{G_{2},G_{3},G_{5}\\}$.\n\nYou will analyze how degree-corrected normalization affects identification of high-confidence disease–disease edges in the projected network. Use as foundational base the standard definitions of bipartite projections, degree sequences, and the bipartite configuration model (BiCM) understood as a maximum-entropy null model preserving expected degrees.\n\nProceed as follows, starting from first principles and without invoking any pre-packaged projection formulas. First, define the raw weighted disease–disease projection weight $w^{(0)}_{ij}$ as the number of shared genes between $D_{i}$ and $D_{j}$, expressed in terms of $B$. Then define and compute a degree-corrected resource allocation (RA) weight $w^{(\\mathrm{RA})}_{ij}$ that downweights contributions from high-degree genes, using the gene degree $k_{g}=\\sum_{i} B_{i g}$.\n\nNext, to assess statistical confidence, adopt the bipartite configuration model (BiCM) in which disease–gene incidences are independent Bernoulli variables with probabilities $\\{p_{i g}\\}$ constrained to reproduce the expected disease degrees $k_{i}=\\sum_{g} B_{i g}$ and gene degrees $k_{g}$. Using the widely used stub-matching approximation consistent with the BiCM constraints and the law of total expectation, derive an analytic expression for the expected co-occurrence $\\mathbb{E}[X_{i j}]$ of shared genes between $D_{i}$ and $D_{j}$ and its variance $\\mathrm{Var}(X_{i j})$ under independence across genes, in terms of $\\{k_{i}\\}$, $\\{k_{g}\\}$, and the total number of edges $m=\\sum_{i,g} B_{i g}$. Use these to compute a $z$-score $z_{i j}=\\big(w^{(0)}_{i j}-\\mathbb{E}[X_{i j}]\\big)/\\sqrt{\\mathrm{Var}(X_{i j})}$ for each disease pair.\n\nDefine “high-confidence” edges in two ways: (a) naive criterion, where a pair is high-confidence if $w^{(0)}_{i j} \\geq 2$; and (b) degree-corrected statistical criterion, where a pair is high-confidence if $z_{i j} \\geq 2$ (one-sided positive deviation). Evaluate both criteria on this dataset.\n\nFinally, let $N_{\\mathrm{naive}}$ be the number of disease pairs deemed high-confidence by the naive criterion, and let $N_{\\mathrm{BiCM}}$ be the number deemed high-confidence by the BiCM $z$-score criterion. Report the difference $\\Delta=N_{\\mathrm{naive}}-N_{\\mathrm{BiCM}}$ as your final answer. Provide your final answer as an exact integer, with no units.", "solution": "The problem asks for an analysis of a given disease-gene bipartite network. We are given the disease set $\\mathcal{D}=\\{D_{1}, D_{2}, D_{3}, D_{4}\\}$ and the gene set $\\mathcal{G}=\\{G_{1}, G_{2}, G_{3}, G_{4}, G_{5}\\}$. The associations are defined by a binary adjacency matrix $B$, where $B_{ig}=1$ if disease $D_i$ is associated with gene $G_g$. Based on the provided list of non-zero entries, the matrix $B$ is:\n$$\nB = \\begin{pmatrix}\n1 & 1 & 0 & 1 & 0 \\\\\n1 & 0 & 1 & 1 & 0 \\\\\n1 & 0 & 1 & 0 & 1 \\\\\n0 & 1 & 1 & 0 & 1\n\\end{pmatrix}\n$$\nThe rows correspond to diseases $D_1$ to $D_4$ and columns to genes $G_1$ to $G_5$.\n\nFirst, we calculate the degrees of all nodes. The degree of a disease node $D_i$, denoted $k_i$, is the number of genes associated with it. This is the sum of entries in row $i$ of $B$. The degree of a gene node $G_g$, denoted $k_g$, is the number of diseases associated with it. This is the sum of entries in column $g$ of $B$.\n\nDisease degrees:\n$k_1 = \\sum_{g=1}^{5} B_{1g} = 1+1+0+1+0 = 3$\n$k_2 = \\sum_{g=1}^{5} B_{2g} = 1+0+1+1+0 = 3$\n$k_3 = \\sum_{g=1}^{5} B_{3g} = 1+0+1+0+1 = 3$\n$k_4 = \\sum_{g=1}^{5} B_{4g} = 0+1+1+0+1 = 3$\nThe disease degree sequence is $\\{k_i\\} = (3, 3, 3, 3)$.\n\nGene degrees:\n$k_{G_1} = \\sum_{i=1}^{4} B_{i1} = 1+1+1+0 = 3$\n$k_{G_2} = \\sum_{i=1}^{4} B_{i2} = 1+0+0+1 = 2$\n$k_{G_3} = \\sum_{i=1}^{4} B_{i3} = 0+1+1+1 = 3$\n$k_{G_4} = \\sum_{i=1}^{4} B_{i4} = 1+1+0+0 = 2$\n$k_{G_5} = \\sum_{i=1}^{4} B_{i5} = 0+0+1+1 = 2$\nThe gene degree sequence is $\\{k_g\\} = (3, 2, 3, 2, 2)$.\n\nThe total number of edges in the network, $m$, is the sum of all degrees in one partition:\n$m = \\sum_{i=1}^{4} k_i = 3+3+3+3 = 12$.\nThis must equal the sum of degrees in the other partition: $\\sum_{g=1}^{5} k_g = 3+2+3+2+2 = 12$. The counts are consistent.\n\nThe raw weighted projection weight $w^{(0)}_{ij}$ between two diseases $D_i$ and $D_j$ is the number of genes they share. This can be calculated from the adjacency matrix $B$ as:\n$$\nw^{(0)}_{ij} = \\sum_{g=1}^{5} B_{ig}B_{jg}\n$$\nThis is the dot product of the $i$-th and $j$-th rows of $B$. We calculate these for all $\\binom{4}{2}=6$ unique pairs of diseases ($i < j$):\n$w^{(0)}_{12} = \\sum_g B_{1g}B_{2g} = 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0 = 2$\n$w^{(0)}_{13} = \\sum_g B_{1g}B_{3g} = 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 1$\n$w^{(0)}_{14} = \\sum_g B_{1g}B_{4g} = 1 \\cdot 0 + 1 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 1$\n$w^{(0)}_{23} = \\sum_g B_{2g}B_{3g} = 1 \\cdot 1 + 0 \\cdot 0 + 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 2$\n$w^{(0)}_{24} = \\sum_g B_{2g}B_{4g} = 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 1$\n$w^{(0)}_{34} = \\sum_g B_{3g}B_{4g} = 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0 + 1 \\cdot 1 = 2$\n\nThe problem then asks to define and compute the degree-corrected resource allocation (RA) weight $w^{(\\mathrm{RA})}_{ij}$. The standard definition is:\n$$\nw^{(\\mathrm{RA})}_{ij} = \\sum_{g=1}^{5} \\frac{B_{ig}B_{jg}}{k_g}\n$$\nUsing the previously calculated gene degrees $\\{k_g\\} = (3, 2, 3, 2, 2)$:\n$w^{(\\mathrm{RA})}_{12} = \\frac{1}{k_{G_1}} + \\frac{1}{k_{G_4}} = \\frac{1}{3} + \\frac{1}{2} = \\frac{5}{6}$\n$w^{(\\mathrm{RA})}_{13} = \\frac{1}{k_{G_1}} = \\frac{1}{3}$\n$w^{(\\mathrm{RA})}_{14} = \\frac{1}{k_{G_2}} = \\frac{1}{2}$\n$w^{(\\mathrm{RA})}_{23} = \\frac{1}{k_{G_1}} + \\frac{1}{k_{G_3}} = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$\n$w^{(\\mathrm{RA})}_{24} = \\frac{1}{k_{G_3}} = \\frac{1}{3}$\n$w^{(\\mathrm{RA})}_{34} = \\frac{1}{k_{G_3}} + \\frac{1}{k_{G_5}} = \\frac{1}{3} + \\frac{1}{2} = \\frac{5}{6}$\n\nNext, we evaluate the two criteria for \"high-confidence\" edges.\n(a) The naive criterion is $w^{(0)}_{ij} \\geq 2$. The pairs satisfying this condition are $(1,2)$, $(2,3)$, and $(3,4)$. Thus, the number of high-confidence pairs by the naive criterion is $N_{\\mathrm{naive}} = 3$.\n\n(b) The degree-corrected statistical criterion is based on a z-score derived from the BiCM null model. The z-score is $z_{ij} = (w^{(0)}_{ij} - \\mathbb{E}[X_{ij}])/\\sqrt{\\mathrm{Var}(X_{ij})}$, where $X_{ij}$ is the random variable for the number of shared genes.\n\nUnder the BiCM, using the stub-matching approximation, the probability of an edge between disease $D_i$ and gene $G_g$ is $p_{ig} = \\frac{k_i k_g}{m}$. The event that $D_i$ and $D_j$ both link to $G_g$ has probability $p_{ig}p_{jg}$, treating the formation of edges $(i,g)$ and $(j,g)$ as independent events. Let $X_{ijg}$ be the indicator variable for this event. Then $\\mathbb{E}[X_{ijg}] = p_{ig}p_{jg} = \\frac{k_i k_j k_g^2}{m^2}$.\nThe total expected number of shared genes is $\\mathbb{E}[X_{ij}] = \\mathbb{E}[\\sum_g X_{ijg}] = \\sum_g \\mathbb{E}[X_{ijg}]$.\n$$\n\\mathbb{E}[X_{ij}] = \\sum_{g=1}^{5} \\frac{k_i k_j k_g^2}{m^2} = \\frac{k_i k_j}{m^2} \\sum_{g=1}^{5} k_g^2\n$$\nSince all disease degrees are $k_i=3$, the product $k_i k_j = 3 \\times 3 = 9$ for any pair $(i,j)$. We have $m=12$ and $\\sum_{g} k_g^2 = 3^2 + 2^2 + 3^2 + 2^2 + 2^2 = 9+4+9+4+4 = 30$.\n$$\n\\mathbb{E}[X_{ij}] = \\frac{9}{12^2} \\times 30 = \\frac{9}{144} \\times 30 = \\frac{1}{16} \\times 30 = \\frac{15}{8} = 1.875\n$$\nThis expectation is the same for all disease pairs.\n\nFor the variance, the problem specifies the assumption of independence across genes. This means $\\mathrm{Var}(X_{ij}) = \\mathrm{Var}(\\sum_g X_{ijg}) = \\sum_g \\mathrm{Var}(X_{ijg})$. Since $X_ {ijg}$ is a Bernoulli variable with success probability $p_{g} = p_{ig}p_{jg}$, its variance is $p_{g}(1-p_{g})$.\n$$\n\\mathrm{Var}(X_{ij}) = \\sum_{g=1}^{5} \\left(\\frac{k_i k_j k_g^2}{m^2}\\right) \\left(1 - \\frac{k_i k_j k_g^2}{m^2}\\right)\n$$\nSubstituting $k_i k_j=9$ and $m=12$:\n$$\n\\mathrm{Var}(X_{ij}) = \\sum_{g=1}^{5} \\left(\\frac{9 k_g^2}{144}\\right) \\left(1 - \\frac{9 k_g^2}{144}\\right) = \\sum_{g=1}^{5} \\frac{k_g^2}{16} \\left(1 - \\frac{k_g^2}{16}\\right)\n$$\nThe gene degrees squared are $\\{k_g^2\\} = (9, 4, 9, 4, 4)$.\nTerm for $g=1$ ($k_{G_1}^2=9$): $\\frac{9}{16} (1 - \\frac{9}{16}) = \\frac{9}{16} \\times \\frac{7}{16} = \\frac{63}{256}$.\nTerm for $g=2$ ($k_{G_2}^2=4$): $\\frac{4}{16} (1 - \\frac{4}{16}) = \\frac{1}{4} \\times \\frac{3}{4} = \\frac{3}{16} = \\frac{48}{256}$.\nTerm for $g=3$ ($k_{G_3}^2=9$): $\\frac{9}{16} (1 - \\frac{9}{16}) = \\frac{63}{256}$.\nTerm for $g=4$ ($k_{G_4}^2=4$): $\\frac{4}{16} (1 - \\frac{4}{16}) = \\frac{48}{256}$.\nTerm for $g=5$ ($k_{G_5}^2=4$): $\\frac{4}{16} (1 - \\frac{4}{16}) = \\frac{48}{256}$.\nSumming these terms:\n$$\n\\mathrm{Var}(X_{ij}) = \\frac{63+48+63+48+48}{256} = \\frac{270}{256} = \\frac{135}{128}\n$$\nThe standard deviation is $\\sigma_{ij} = \\sqrt{\\mathrm{Var}(X_{ij})} = \\sqrt{\\frac{135}{128}}$.\n\nNow we compute the z-scores $z_{ij} = (w^{(0)}_{ij} - \\mathbb{E}[X_{ij}])/\\sigma_{ij}$.\nThe pairs have $w^{(0)}_{ij}$ of either $1$ or $2$.\nFor pairs with $w^{(0)}_{ij} = 2$: $(1,2)$, $(2,3)$, $(3,4)$.\n$z_{ij} = \\frac{2 - 1.875}{\\sqrt{135/128}} = \\frac{0.125}{\\sqrt{135/128}} = \\frac{1/8}{\\sqrt{135/128}}$.\nTo check if $z_{ij} \\geq 2$, we test if $\\frac{1}{8} \\geq 2\\sqrt{\\frac{135}{128}}$. Squaring both sides gives $\\frac{1}{64} \\geq 4 \\times \\frac{135}{128} = \\frac{135}{32}$, which is false. So $z_{ij} < 2$.\n\nFor pairs with $w^{(0)}_{ij} = 1$: $(1,3)$, $(1,4)$, $(2,4)$.\n$z_{ij} = \\frac{1 - 1.875}{\\sqrt{135/128}} = \\frac{-0.875}{\\sqrt{135/128}}$. This value is negative and thus is less than $2$.\n\nNo disease pair satisfies the condition $z_{ij} \\geq 2$. Therefore, the number of high-confidence pairs by the BiCM criterion is $N_{\\mathrm{BiCM}} = 0$.\n\nFinally, we compute the required difference $\\Delta = N_{\\mathrm{naive}} - N_{\\mathrm{BiCM}}$.\n$$\n\\Delta = 3 - 0 = 3\n$$\nThis result highlights that the naive thresholding method can overestimate the significance of links. The BiCM null model, by accounting for degree-based expectations, provides a more rigorous statistical assessment, revealing that the observed co-occurrences are not statistically significant in this network.", "answer": "$$\n\\boxed{3}\n$$", "id": "4393323"}]}