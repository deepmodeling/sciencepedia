{"hands_on_practices": [{"introduction": "A core concept in network medicine is that disease-causing genes often form a \"disease module\"—a connected and often densely intra-connected component within the larger protein-protein interaction network. To formally identify such modules, we need a quantitative measure of community structure. This practice introduces modularity, $Q$, a standard metric that evaluates how well a network is divided into communities by comparing the fraction of edges within communities to what would be expected in a randomized network with the same degree distribution. By manually calculating $Q$ for different partitions, you will build a concrete intuition for what defines a strong, cohesive network community. [@problem_id:4369095]", "problem": "In network-based disease module identification within systems biomedicine, communities are often inferred by maximizing a quality function that compares observed intramodule connectivity to a degree-preserving null model. Consider an undirected, unweighted, loopless protein-protein interaction network of $8$ gene products represented by the adjacency matrix $\\mathbf{A}$ with node labels $\\{1,2,3,4,5,6,7,8\\}$:\n$$\n\\mathbf{A}=\n\\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 1 & 0 & 0 & 0 & 0\\\\\n1 & 1 & 0 & 1 & 1 & 0 & 0 & 0\\\\\n0 & 1 & 1 & 0 & 1 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 1 & 0 & 1 & 1 & 0\\\\\n0 & 0 & 0 & 1 & 1 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 0 & 1 & 1 & 0 & 1\\\\\n0 & 0 & 0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}.\n$$\nTwo candidate partitions are proposed for a putative disease module search:\n- Partition $\\mathcal{P}_{A}$ with communities $\\{1,2,3,4\\}$ and $\\{5,6,7,8\\}$,\n- Partition $\\mathcal{P}_{B}$ with communities $\\{1,2,3\\}$ and $\\{4,5,6,7,8\\}$.\n\nUsing the standard definition of modularity $Q$ based on the configuration-model null (where expected edges under the null preserve node degrees), compute $Q$ for each partition solely from the information given, and select the higher-modularity partition. Then, in one sentence, interpret what the higher-modularity partition implies about plausible disease modules in this network in terms of intra-community connectivity versus degree-driven expectation.\n\nReport only the higher modularity value $Q_{\\max}$ as your final numerical answer, rounded to four significant figures. Express your answer as a pure number (no units).", "solution": "The problem is valid as it is scientifically grounded in network science, well-posed with all necessary information, and stated objectively. We can proceed with the calculation.\n\nThe modularity $Q$ of a partition of a network into communities is a measure of the strength of the division. It is defined as the fraction of edges that fall within the given communities minus the expected such fraction if edges were distributed at random, preserving node degrees (the configuration model). For an unweighted, undirected network, the formula is:\n$$\nQ = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\frac{k_i k_j}{2m} \\right] \\delta(c_i, c_j)\n$$\nwhere $m$ is the total number of edges, $A_{ij}$ is the adjacency matrix element between nodes $i$ and $j$, $k_i$ is the degree of node $i$, $c_i$ is the community of node $i$, and $\\delta(c_i, c_j)$ is the Kronecker delta. An equivalent and more practical formula sums over the communities:\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\nwhere $L_c$ is the number of edges entirely within community $c$, and $K_c$ is the sum of the degrees of all nodes in community $c$.\n\nFirst, we determine the properties of the entire network from the given adjacency matrix $\\mathbf{A}$. The degree $k_i$ of each node $i$ is the sum of the entries in the $i$-th row of $\\mathbf{A}$:\n$k_1 = 1+1 = 2$\n$k_2 = 1+1+1 = 3$\n$k_3 = 1+1+1+1 = 4$\n$k_4 = 1+1+1+1 = 4$\n$k_5 = 1+1+1+1 = 4$\n$k_6 = 1+1+1+1 = 4$\n$k_7 = 1+1+1 = 3$\n$k_8 = 1+1 = 2$\n\nThe total number of edges $m$ is half the sum of all degrees:\n$$\nm = \\frac{1}{2}\\sum_{i=1}^{8} k_i = \\frac{1}{2}(2+3+4+4+4+4+3+2) = \\frac{26}{2} = 13\n$$\n\nNow, we compute the modularity for each proposed partition.\n\n**Partition $\\mathcal{P}_{A}$:**\nThe communities are $C_1 = \\{1,2,3,4\\}$ and $C_2 = \\{5,6,7,8\\}$.\n\nFor community $C_1$:\nThe sum of degrees is $K_{C_1} = k_1+k_2+k_3+k_4 = 2+3+4+4 = 13$.\nThe number of internal edges $L_{C_1}$ are the edges with both endpoints in $C_1$. These are $(1,2)$, $(1,3)$, $(2,3)$, $(2,4)$, and $(3,4)$. Thus, $L_{C_1} = 5$.\n\nFor community $C_2$:\nThe sum of degrees is $K_{C_2} = k_5+k_6+k_7+k_8 = 4+4+3+2 = 13$.\nThe number of internal edges $L_{C_2}$ are the edges with both endpoints in $C_2$. These are $(5,6)$, $(5,7)$, $(6,7)$, $(6,8)$, and $(7,8)$. Thus, $L_{C_2} = 5$.\n\nThe modularity $Q_A$ for partition $\\mathcal{P}_A$ is:\n$$\nQ_A = \\left[ \\frac{L_{C_1}}{m} - \\left( \\frac{K_{C_1}}{2m} \\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{m} - \\left( \\frac{K_{C_2}}{2m} \\right)^2 \\right]\n$$\n$$\nQ_A = \\left[ \\frac{5}{13} - \\left( \\frac{13}{2 \\times 13} \\right)^2 \\right] + \\left[ \\frac{5}{13} - \\left( \\frac{13}{2 \\times 13} \\right)^2 \\right]\n$$\n$$\nQ_A = 2 \\times \\left[ \\frac{5}{13} - \\left( \\frac{1}{2} \\right)^2 \\right] = 2 \\times \\left[ \\frac{5}{13} - \\frac{1}{4} \\right] = 2 \\times \\left[ \\frac{20-13}{52} \\right] = 2 \\times \\frac{7}{52} = \\frac{14}{52} = \\frac{7}{26}\n$$\nNumerically, $Q_A \\approx 0.26923$.\n\n**Partition $\\mathcal{P}_{B}$:**\nThe communities are $C'_1 = \\{1,2,3\\}$ and $C'_2 = \\{4,5,6,7,8\\}$.\n\nFor community $C'_1$:\nThe sum of degrees is $K_{C'_1} = k_1+k_2+k_3 = 2+3+4 = 9$.\nThe internal edges are $(1,2)$, $(1,3)$, and $(2,3)$. Thus, $L_{C'_1} = 3$.\n\nFor community $C'_2$:\nThe sum of degrees is $K_{C'_2} = k_4+k_5+k_6+k_7+k_8 = 4+4+4+3+2 = 17$.\nThe internal edges are $(4,5)$, $(4,6)$, $(5,6)$, $(5,7)$, $(6,7)$, $(6,8)$, and $(7,8)$. Thus, $L_{C'_2} = 7$.\n(As a check, the number of edges between communities is $A_{24}+A_{34}+A_{35} = 1+1+1 = 3$. Total edges $m = L_{C'_1} + L_{C'_2} + (\\text{edges between}) = 3+7+3 = 13$, which is correct).\n\nThe modularity $Q_B$ for partition $\\mathcal{P}_B$ is:\n$$\nQ_B = \\left[ \\frac{L_{C'_1}}{m} - \\left( \\frac{K_{C'_1}}{2m} \\right)^2 \\right] + \\left[ \\frac{L_{C'_2}}{m} - \\left( \\frac{K_{C'_2}}{2m} \\right)^2 \\right]\n$$\n$$\nQ_B = \\left[ \\frac{3}{13} - \\left( \\frac{9}{26} \\right)^2 \\right] + \\left[ \\frac{7}{13} - \\left( \\frac{17}{26} \\right)^2 \\right]\n$$\n$$\nQ_B = \\frac{3}{13} + \\frac{7}{13} - \\frac{9^2}{26^2} - \\frac{17^2}{26^2} = \\frac{10}{13} - \\frac{81+289}{676} = \\frac{10}{13} - \\frac{370}{676}\n$$\nTo compare, we bring to a common denominator of $676 = 13 \\times 52$:\n$$\nQ_B = \\frac{10 \\times 52}{676} - \\frac{370}{676} = \\frac{520 - 370}{676} = \\frac{150}{676} = \\frac{75}{338}\n$$\nNumerically, $Q_B \\approx 0.22189$.\n\nComparing the two modularity values:\n$Q_A = \\frac{7}{26} = \\frac{91}{338}$\n$Q_B = \\frac{75}{338}$\nSince $91 > 75$, we have $Q_A > Q_B$. The higher-modularity partition is $\\mathcal{P}_A$.\n\nThe higher modularity value is $Q_{\\max} = Q_A = \\frac{7}{26} \\approx 0.2692307...$\nRounding to four significant figures, $Q_{\\max} \\approx 0.2692$.\n\nThe higher modularity of partition $\\mathcal{P}_A$ implies that its communities exhibit stronger internal connectivity relative to the random expectation based on node degrees, suggesting it is the more plausible representation of distinct disease-related modules in this protein interaction network.", "answer": "$$\n\\boxed{0.2692}\n$$", "id": "4369095"}, {"introduction": "While general community detection is useful, disease module identification often leverages prior biological knowledge, such as a set of known disease-associated genes. The Prize-Collecting Steiner Tree (PCST) framework is a powerful method that directly incorporates this information by assigning \"prizes\" to nodes we wish to include and \"costs\" to the edges we use to connect them. This exercise challenges you to find the optimal disease module by manually solving a PCST problem, forcing you to navigate the fundamental trade-off between collecting valuable nodes and minimizing the cost of the resulting subnetwork. [@problem_id:4369080]", "problem": "In network-based disease module identification within systems biomedicine, the Prize-Collecting Steiner Tree (PCST) is used to select a connected subnetwork that balances the inclusion of biologically relevant nodes (with nonnegative node prizes) against uncertainty costs on edges. Consider the following small protein-protein interaction graph modeled as an undirected graph $G = (V, E)$, with three disease seed genes and two potential Steiner genes:\n- Nodes: $V = \\{A, B, C, D, E\\}$.\n- Seed set: $S = \\{A, B, C\\}$.\n- Node prizes $p(v)$: $p(A) = 6$, $p(B) = 5$, $p(C) = 5$, $p(D) = 1$, $p(E) = 1$.\n- Edge costs $c(e)$ on the following edges:\n  - $c(A, D) = 2$, $c(D, B) = 1$, $c(B, E) = 2$, $c(E, C) = 2$,\n  - $c(A, B) = 6$, $c(B, C) = 6$, $c(A, C) = 7$,\n  - $c(A, E) = 5$, $c(D, C) = 5$.\n\nA feasible disease module is any connected tree $T$ whose node set $V(T) \\subseteq V$ includes all seeds $A$, $B$, and $C$ (additional nodes such as $D$ and $E$ may be included), and whose edge set $E(T) \\subseteq E$ induces connectivity of $V(T)$ within $G$. The PCST objective for a tree $T$ is\n$$\n\\Phi(T) \\;=\\; \\sum_{v \\in V(T)} p(v) \\;-\\; \\sum_{e \\in E(T)} c(e).\n$$\n\nStarting only from the above definitions and data, compute manually the optimal PCST, i.e., the connected tree $T^{\\star}$ that maximizes $\\Phi(T)$ under the constraint that $\\{A, B, C\\} \\subseteq V(T)$. Your answer must be the exact maximal objective value $\\Phi(T^{\\star})$ as a single real number. In your reasoning, justify rigorously why all plausible alternative trees are suboptimal relative to $T^{\\star}$ by comparing their objective values or by bounding arguments based on shortest-path distances and induced connectivity.\n\nExpress the final answer as an exact integer. Do not round.", "solution": "### Step 1: Extract Givens\nThe problem provides the following information for a Prize-Collecting Steiner Tree (PCST) analysis on an undirected graph $G = (V, E)$:\n-   **Node set**: $V = \\{A, B, C, D, E\\}$.\n-   **Seed set**: $S = \\{A, B, C\\}$, which must be included in the solution tree.\n-   **Node prizes**, $p(v)$: $p(A) = 6$, $p(B) = 5$, $p(C) = 5$, $p(D) = 1$, $p(E) = 1$.\n-   **Edge costs**, $c(e)$:\n    -   $c(A, D) = 2$\n    -   $c(D, B) = 1$\n    -   $c(B, E) = 2$\n    -   $c(E, C) = 2$\n    -   $c(A, B) = 6$\n    -   $c(B, C) = 6$\n    -   $c(A, C) = 7$\n    -   $c(A, E) = 5$\n    -   $c(D, C) = 5$\n-   **Objective function**: For a feasible tree $T=(V(T), E(T))$ where $S \\subseteq V(T)$, maximize $\\Phi(T) = \\sum_{v \\in V(T)} p(v) - \\sum_{e \\in E(T)} c(e)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using a standard optimization model (PCST) from systems biomedicine. It is well-posed, providing all necessary data (prizes, costs, graph structure) and a clear, unambiguous objective function and constraints. The set of feasible trees is finite, guaranteeing that a maximum objective value exists. The problem is self-contained, objective, and does not violate any scientific or mathematical principles. There are no contradictions or missing pieces of essential information. The data values are numerically consistent. Therefore, the problem is deemed **valid**.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will proceed.\n\n### Solution Derivation\nThe task is to find a connected tree $T^{\\star}$ that maximizes the objective function $\\Phi(T)$ under the constraint that the set of seed nodes $S = \\{A, B, C\\}$ is a subset of the tree's node set, $V(T^{\\star})$. The other nodes, $D$ and $E$, are potential Steiner nodes that can be included if they improve the objective value.\n\nA systematic approach is to evaluate all possible compositions of the tree's vertex set, $V(T)$, that satisfy the constraint. Since $S$ must be included, the possible sets for $V(T)$ are:\n1.  $V_1 = \\{A, B, C\\}$\n2.  $V_2 = \\{A, B, C, D\\}$\n3.  $V_3 = \\{A, B, C, E\\}$\n4.  $V_4 = \\{A, B, C, D, E\\}$\n\nFor each of these node sets, we must find the tree $T$ that maximizes $\\Phi(T)$. For a fixed node set $V(T)$, the total prize $\\sum p(v)$ is constant. To maximize $\\Phi(T)$, we must therefore minimize the total edge cost $\\sum c(e)$. The minimum-cost set of edges that connects a given set of nodes forms a Minimum Spanning Tree (MST) on the subgraph induced by those nodes. We will calculate $\\Phi(T)$ for the optimal tree in each of these four cases.\n\n**Case 1: $V(T) = \\{A, B, C\\}$**\nThe tree must connect only the seed nodes.\n-   **Total Prize**: $P_1 = p(A) + p(B) + p(C) = 6 + 5 + 5 = 16$.\n-   **Minimum Edge Cost**: We need to find the MST on the subgraph induced by $\\{A, B, C\\}$. The available edges are $(A,B)$ with cost $6$, $(B,C)$ with cost $6$, and $(A,C)$ with cost $7$. To connect $3$ nodes, we need $2$ edges. Using Kruskal's algorithm, we select the two cheapest edges that do not form a cycle: $(A,B)$ and $(B,C)$.\n    -   The edge set for the MST is $E_1 = \\{(A,B), (B,C)\\}$.\n    -   Total cost is $C_1 = c(A,B) + c(B,C) = 6 + 6 = 12$.\n-   **Objective Value**: $\\Phi_1 = P_1 - C_1 = 16 - 12 = 4$.\n\n**Case 2: $V(T) = \\{A, B, C, D\\}$**\nThe tree includes the seed nodes and Steiner node $D$.\n-   **Total Prize**: $P_2 = p(A) + p(B) + p(C) + p(D) = 6 + 5 + 5 + 1 = 17$.\n-   **Minimum Edge Cost**: We find the MST on the subgraph induced by $\\{A, B, C, D\\}$. The available edges and their costs are: $(D,B)$ cost $1$, $(A,D)$ cost $2$, $(D,C)$ cost $5$, $(A,B)$ cost $6$, $(B,C)$ cost $6$, $(A,C)$ cost $7$.\n    -   Applying Kruskal's algorithm (selecting edges in increasing order of cost):\n        1. Select $(D,B)$, cost $1$.\n        2. Select $(A,D)$, cost $2$.\n        3. Select $(D,C)$, cost $5$. (The other cheap edges like $(A,B)$, cost $6$, would form a cycle with already selected edges).\n    -   The edge set for the MST is $E_2 = \\{(D,B), (A,D), (D,C)\\}$. This tree connects all four nodes.\n    -   Total cost is $C_2 = c(D,B) + c(A,D) + c(D,C) = 1 + 2 + 5 = 8$.\n-   **Objective Value**: $\\Phi_2 = P_2 - C_2 = 17 - 8 = 9$.\n\n**Case 3: $V(T) = \\{A, B, C, E\\}$**\nThe tree includes the seed nodes and Steiner node $E$.\n-   **Total Prize**: $P_3 = p(A) + p(B) + p(C) + p(E) = 6 + 5 + 5 + 1 = 17$.\n-   **Minimum Edge Cost**: We find the MST on the subgraph induced by $\\{A, B, C, E\\}$. The available edges and their costs are: $(B,E)$ cost $2$, $(E,C)$ cost $2$, $(A,E)$ cost $5$, $(A,B)$ cost $6$, $(B,C)$ cost $6$, $(A,C)$ cost $7$.\n    -   Applying Kruskal's algorithm:\n        1. Select $(B,E)$, cost $2$.\n        2. Select $(E,C)$, cost $2$.\n        3. Select $(A,E)$, cost $5$.\n    -   The edge set for the MST is $E_3 = \\{(B,E), (E,C), (A,E)\\}$. This tree connects all four nodes.\n    -   Total cost is $C_3 = c(B,E) + c(E,C) + c(A,E) = 2 + 2 + 5 = 9$.\n-   **Objective Value**: $\\Phi_3 = P_3 - C_3 = 17 - 9 = 8$.\n\n**Case 4: $V(T) = \\{A, B, C, D, E\\}$**\nThe tree includes all nodes from the graph $G$.\n-   **Total Prize**: $P_4 = p(A) + p(B) + p(C) + p(D) + p(E) = 6 + 5 + 5 + 1 + 1 = 18$.\n-   **Minimum Edge Cost**: We find the MST on the entire graph $G$. The edges sorted by cost are: $(D,B)$ cost $1$; $(A,D)$ cost $2$; $(B,E)$ cost $2$; $(E,C)$ cost $2$; $(A,E)$ cost $5$; $(D,C)$ cost $5$; etc.\n    -   Applying Kruskal's algorithm:\n        1. Select $(D,B)$, cost $1$.\n        2. Select $(A,D)$, cost $2$.\n        3. Select $(B,E)$, cost $2$. (No cycle is formed. Order of selection for edges of same cost, like $(B,E)$ and $(E,C)$, doesn't affect total cost).\n        4. Select $(E,C)$, cost $2$. (No cycle is formed. All $5$ nodes are now connected).\n    -   The edge set for the MST is $E_4 = \\{(D,B), (A,D), (B,E), (E,C)\\}$.\n    -   Total cost is $C_4 = c(D,B) + c(A,D) + c(B,E) + c(E,C) = 1 + 2 + 2 + 2 = 7$.\n-   **Objective Value**: $\\Phi_4 = P_4 - C_4 = 18 - 7 = 11$.\n\n### Conclusion\nBy comparing the objective values from all possible valid configurations of the tree, we can identify the maximum.\n-   $\\Phi_1 = 4$\n-   $\\Phi_2 = 9$\n-   $\\Phi_3 = 8$\n-   $\\Phi_4 = 11$\n\nThe maximum objective value is $\\Phi_{\\max} = 11$. This value is achieved by the tree $T^{\\star}$ with node set $V(T^{\\star}) = \\{A, B, C, D, E\\}$ and edge set $E(T^{\\star}) = \\{(D,B), (A,D), (B,E), (E,C)\\}$. This exhaustive analysis proves that any other feasible tree is suboptimal. For any given node set, any tree other than the MST would have a higher edge cost and thus a lower objective value. Since we have considered all valid node sets and found their respective optimal scores, the highest of these scores is the global optimum.", "answer": "$$\\boxed{11}$$", "id": "4369080"}, {"introduction": "After running an algorithm to identify a disease module, the output is typically a ranked list of candidate genes. The crucial final step is to evaluate how well this ranking recovers known disease genes. This practice focuses on two of the most important metrics for this task: the Area Under the Receiver Operating Characteristic curve (AUROC) and the Area Under the Precision-Recall curve (AUPRC). By calculating these values from scratch for a hypothetical ranked list, you will gain a deeper understanding of how they work and, critically, why the AUPRC is often a more informative metric in the context of typical biological datasets, which are characterized by a large imbalance between a small number of positive examples (disease genes) and a vast number of negatives. [@problem_id:4369048]", "problem": "A protein-protein interaction network is used to identify a disease module by scoring genes with a diffusion-based ranking seeded by known disease genes. A subset of genes is annotated as known disease-associated ($\\text{positive}$), and all other genes are considered non-disease-associated ($\\text{negative}$). You are given a single predicted ranking (with unique scores) in descending order of confidence produced by the network-based disease module identification pipeline. From first principles, compute both the Area Under the Receiver Operating Characteristic curve (AUROC) and the Area Under the Precision–Recall curve (AUPRC), and explain why these two metrics can differ in the presence of class imbalance and early false positives.\n\nUse the following dataset of $12$ genes with their scores and labels, ordered from highest to lowest score:\n- Gene $N\\_A$ (negative), score $0.97$\n- Gene $D\\_1$ (positive), score $0.95$\n- Gene $D\\_2$ (positive), score $0.93$\n- Gene $D\\_3$ (positive), score $0.90$\n- Gene $N\\_B$ (negative), score $0.85$\n- Gene $N\\_C$ (negative), score $0.82$\n- Gene $N\\_D$ (negative), score $0.79$\n- Gene $N\\_E$ (negative), score $0.76$\n- Gene $N\\_F$ (negative), score $0.73$\n- Gene $N\\_G$ (negative), score $0.70$\n- Gene $N\\_H$ (negative), score $0.68$\n- Gene $N\\_I$ (negative), score $0.65$\n\nKnown disease genes are $D\\_1$, $D\\_2$, and $D\\_3$ (positives). All $N\\_*$ genes are negatives. Start from the definitions of true positive rate, false positive rate, precision, and recall constructed by thresholding a ranked list, and define the Receiver Operating Characteristic (ROC) and Precision–Recall (PR) curves accordingly as functions of the threshold. Then derive the expressions for the area under each curve in the discrete ranking setting.\n\nCompute the AUROC and the AUPRC for this ranking. Round your AUROC and AUPRC to four significant figures. Express both final values as decimals without any units. In addition, in your solution, provide a short interpretation of why the two values differ for this dataset.", "solution": "We begin by formalizing binary classification from a ranked list. Let there be $P$ positives and $N$ negatives. For any threshold $t$ applied to the ranking, let $\\text{TP}(t)$, $\\text{FP}(t)$, $\\text{TN}(t)$, and $\\text{FN}(t)$ denote the counts of true positives, false positives, true negatives, and false negatives among items scoring above threshold $t$ (predicted positive) versus below or equal to $t$ (predicted negative).\n\nThe true positive rate (TPR, also called sensitivity or recall) and false positive rate (FPR) at threshold $t$ are defined as\n$$\n\\text{TPR}(t) = \\frac{\\text{TP}(t)}{P}, \\qquad \\text{FPR}(t) = \\frac{\\text{FP}(t)}{N}.\n$$\nThe precision at threshold $t$ is\n$$\n\\text{Precision}(t) = \\frac{\\text{TP}(t)}{\\text{TP}(t) + \\text{FP}(t)},\n$$\nand the recall (as above) is $\\text{Recall}(t) = \\text{TPR}(t) = \\text{TP}(t)/P$.\n\nThe Receiver Operating Characteristic (ROC) curve is the set of points $\\left(\\text{FPR}(t), \\text{TPR}(t)\\right)$ obtained by sweeping $t$ from above the maximum score (yielding $\\text{TPR} = 0$, $\\text{FPR} = 0$) down to below the minimum score (yielding $\\text{TPR} = 1$, $\\text{FPR} = 1$). The Precision–Recall (PR) curve is the set of points $\\left(\\text{Recall}(t), \\text{Precision}(t)\\right)$ constructed similarly.\n\nIn the discrete ranking setting with unique scores, as the threshold traverses each item, $\\text{TP}(t)$ and $\\text{FP}(t)$ change by increments of $1$ depending on whether the next item is positive or negative. Thus, the ROC curve is a monotone staircase in the $\\text{FPR}$–$\\text{TPR}$ plane, and the PR curve is a monotone staircase in the $\\text{Recall}$–$\\text{Precision}$ plane. The areas under these curves can be computed by summing the areas of rectangles and trapezoids determined by the steps.\n\nThere are two widely used exact characterizations for the area in this discrete case:\n1. The AUROC equals the probability that a randomly selected positive has a higher score than a randomly selected negative, which, for unique scores, is the fraction of positive–negative pairs that are correctly ordered. This can be derived by noting that the ROC curve’s area equals the Mann–Whitney statistic normalized by $P \\times N$, itself equivalent to integrating the staircase ROC by summing the widths $\\Delta \\text{FPR} = 1/N$ for each negative and the corresponding heights in $\\text{TPR}$ accumulated by positives. Formally,\n$$\n\\text{AUROC} = \\frac{1}{P N} \\sum_{\\text{positives } i} \\sum_{\\text{negatives } j} \\mathbf{1}\\{s_i > s_j\\},\n$$\nwhere $s_i$ and $s_j$ are scores and $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n\n2. The area under the PR curve under the stepwise interpolation known as Average Precision (AP) can be computed by summing over the recall increments at each positive:\n$$\n\\text{AUPRC} = \\sum_{k=1}^{P} \\left( R_k - R_{k-1} \\right) \\cdot \\Pi_k,\n$$\nwhere $R_k$ is the recall after retrieving the $k$-th positive in the ranking, $R_0 = 0$, and $\\Pi_k$ is the precision at the rank where the $k$-th positive appears. This formula follows from integrating the PR staircase by treating precision as constant over the interval in recall spanned between successive positives.\n\nWe now apply these definitions to the given ranking. First, count positives and negatives. The positives are $D\\_1$, $D\\_2$, $D\\_3$, so $P = 3$. All $N\\_*$ genes are negatives, totaling $N = 9$ (one negative above and eight negatives below the positives).\n\nCompute AUROC via pairwise orderings. There are $P \\times N = 3 \\times 9 = 27$ positive–negative pairs. Examine how many negatives lie below each positive:\n- For $D\\_1$ (rank $2$): all negatives except $N\\_A$ lie below. Since there are $9$ negatives total and $1$ lies above, there are $9 - 1 = 8$ negatives below $D\\_1$.\n- For $D\\_2$ (rank $3$): similarly, $8$ negatives lie below $D\\_2$.\n- For $D\\_3$ (rank $4$): similarly, $8$ negatives lie below $D\\_3$.\n\nThus, the number of correctly ordered positive–negative pairs is $8 + 8 + 8 = 24$. Therefore,\n$$\n\\text{AUROC} = \\frac{24}{27} = \\frac{8}{9}.\n$$\n\nNext, compute AUPRC (Average Precision). Identify the ranks of positives and, at each, compute $\\Pi_k$ (precision) and $R_k$ (recall).\n- After retrieving $D\\_1$ (first positive) at rank $2$: $\\text{TP} = 1$, $\\text{FP} = 1$. Precision $\\Pi_1 = \\frac{1}{1+1} = \\frac{1}{2}$, recall $R_1 = \\frac{1}{3}$.\n- After retrieving $D\\_2$ (second positive) at rank $3$: $\\text{TP} = 2$, $\\text{FP} = 1$. Precision $\\Pi_2 = \\frac{2}{2+1} = \\frac{2}{3}$, recall $R_2 = \\frac{2}{3}$.\n- After retrieving $D\\_3$ (third positive) at rank $4$: $\\text{TP} = 3$, $\\text{FP} = 1$. Precision $\\Pi_3 = \\frac{3}{3+1} = \\frac{3}{4}$, recall $R_3 = \\frac{3}{3} = 1$.\n\nUsing $R_0 = 0$ and the AP summation,\n$$\n\\text{AUPRC} = (R_1 - R_0)\\Pi_1 + (R_2 - R_1)\\Pi_2 + (R_3 - R_2)\\Pi_3 = \\left(\\frac{1}{3}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{3}\\right)\\left(\\frac{2}{3}\\right) + \\left(\\frac{1}{3}\\right)\\left(\\frac{3}{4}\\right).\n$$\nCompute exactly:\n$$\n\\text{AUPRC} = \\frac{1}{6} + \\frac{2}{9} + \\frac{1}{4} = \\frac{6}{36} + \\frac{8}{36} + \\frac{9}{36} = \\frac{23}{36}.\n$$\n\nNumerical values and rounding to four significant figures:\n- $\\text{AUROC} = \\frac{8}{9} \\approx 0.888888\\ldots \\Rightarrow 0.8889$ (four significant figures).\n- $\\text{AUPRC} = \\frac{23}{36} \\approx 0.638888\\ldots \\Rightarrow 0.6389$ (four significant figures).\n\nInterpretation of the discrepancy: The AUROC is high because, pairwise, almost all positives are ranked above almost all negatives; only one negative ($N\\_A$) lies above the positives, yielding $24$ out of $27$ correctly ordered pairs. However, the AUPRC is substantially lower because precision at early recall is penalized by the single early false positive ($N\\_A$) that appears before any positive. This lowers precision at the first positive to $\\frac{1}{2}$ and continues to depress precision at subsequent positives to $\\frac{2}{3}$ and $\\frac{3}{4}$. In class-imbalanced settings typical of systems biomedicine, where positives ($P = 3$) are rare relative to negatives ($N = 9$), AUROC can remain high due to strong global rank separation, while AUPRC is more sensitive to early false positives and the prevalence of positives, thereby providing a more conservative view of ranking quality for top-of-list retrieval relevant to disease module identification.", "answer": "$$\\boxed{\\begin{pmatrix}0.8889 & 0.6389\\end{pmatrix}}$$", "id": "4369048"}]}