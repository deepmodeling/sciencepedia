{"hands_on_practices": [{"introduction": "Understanding immunotherapy begins at the level of a single T cell's decision to attack a target. This practice [@problem_id:4355764] invites you to model the complex signal integration that occurs at the immunological synapse. By applying principles of receptor-ligand kinetics, you will calculate the precise amount of tumor antigen required for T-cell activation, quantifying how checkpoint blockade tips the balance in favor of an anti-tumor response.", "problem": "A cytotoxic T lymphocyte engages a tumor cell within an immunological synapse. A minimal receptor-level model integrates stimulatory and inhibitory cues to determine whether the T cell surpasses an activation threshold. The three principal membrane-proximal inputs considered are T Cell Receptor (TCR) engagement with peptide–Major Histocompatibility Complex (peptide–MHC), co-stimulation via Cluster of Differentiation 28 (CD28) binding to Cluster of Differentiation 80/86 (CD80/CD86), and inhibition via Programmed Cell Death Protein 1 (PD-1) binding to Programmed Death-Ligand 1 (PD-L1). Assume all bindings occur in two dimensions at the synaptic interface and reach rapid equilibrium relative to signaling.\n\nUse the following foundations:\n- The law of mass action at equilibrium for a receptor–ligand pair in two dimensions: the two-dimensional dissociation constant satisfies $K_{d}^{2D} = \\dfrac{[R]_{\\mathrm{free}}[L]_{\\mathrm{free}}}{[RL]}$, where all bracketed quantities are areal densities.\n- The net dimensionless signaling input is modeled as $S = w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$, where $\\theta_{\\mathrm{X}}$ denotes the fractional occupancy of receptor $\\mathrm{X}$ and $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$ is the effective inhibitory engagement under blockade.\n\nExperimental co-administration of a PD-1 blocking antibody renders a fraction $b$ of PD-1 receptors unavailable for ligand binding. Model this as $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = (1-b)\\,\\theta_{\\mathrm{PD1}}$, i.e., blockade reduces the effective inhibitory engagement proportionally to the fraction of unblocked receptors. The T cell activates when $S$ equals an activation threshold $\\Theta_{\\mathrm{act}}$.\n\nAssume:\n- The peptide–MHC areal density on the tumor membrane is $A$ (unknown, in molecules per $\\mu\\mathrm{m}^{2}$).\n- The CD80 areal density on the tumor membrane is $B = 60$ molecules per $\\mu\\mathrm{m}^{2}$.\n- The PD-L1 areal density on the tumor membrane is $P = 100$ molecules per $\\mu\\mathrm{m}^{2}$.\n- Two-dimensional dissociation constants: $K_{d,\\mathrm{TCR}}^{2D} = 80$ molecules per $\\mu\\mathrm{m}^{2}$, $K_{d,\\mathrm{CD28}}^{2D} = 40$ molecules per $\\mu\\mathrm{m}^{2}$, $K_{d,\\mathrm{PD1}}^{2D} = 50$ molecules per $\\mu\\mathrm{m}^{2}$.\n- Weights: $w_{\\mathrm{TCR}} = 1.0$, $w_{\\mathrm{CD28}} = 0.5$, $w_{\\mathrm{PD1}} = 0.8$.\n- PD-1 blockade fraction: $b = 0.75$.\n- Activation threshold: $\\Theta_{\\mathrm{act}} = 0.7$.\n\nAssume ligand depletion by binding is negligible at the synapse for each pairwise interaction. Starting from the equilibrium definition of the dissociation constant and the stated signal integration model, determine the minimal peptide–MHC areal density $A^{\\ast}$ such that $S = \\Theta_{\\mathrm{act}}$ at steady state. Express your final answer as a single real number in molecules per $\\mu\\mathrm{m}^{2}$, and round your answer to four significant figures.", "solution": "The user wants me to solve the following problem.\n\nA cytotoxic T lymphocyte engages a tumor cell within an immunological synapse. A minimal receptor-level model integrates stimulatory and inhibitory cues to determine whether the T cell surpasses an activation threshold. The three principal membrane-proximal inputs considered are T Cell Receptor (TCR) engagement with peptide–Major Histocompatibility Complex (peptide–MHC), co-stimulation via Cluster of Differentiation 28 (CD28) binding to Cluster of Differentiation 80/86 (CD80/CD86), and inhibition via Programmed Cell Death Protein 1 (PD-1) binding to Programmed Death-Ligand 1 (PD-L1). Assume all bindings occur in two dimensions at the synaptic interface and reach rapid equilibrium relative to signaling.\n\nUse the following foundations:\n- The law of mass action at equilibrium for a receptor–ligand pair in two dimensions: the two-dimensional dissociation constant satisfies $K_{d}^{2D} = \\dfrac{[R]_{\\mathrm{free}}[L]_{\\mathrm{free}}}{[RL]}$, where all bracketed quantities are areal densities.\n- The net dimensionless signaling input is modeled as $S = w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$, where $\\theta_{\\mathrm{X}}$ denotes the fractional occupancy of receptor $\\mathrm{X}$ and $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$ is the effective inhibitory engagement under blockade.\n\nExperimental co-administration of a PD-1 blocking antibody renders a fraction $b$ of PD-1 receptors unavailable for ligand binding. Model this as $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = (1-b)\\,\\theta_{\\mathrm{PD1}}$, i.e., blockade reduces the effective inhibitory engagement proportionally to the fraction of unblocked receptors. The T cell activates when $S$ equals an activation threshold $\\Theta_{\\mathrm{act}}$.\n\nAssume:\n- The peptide–MHC areal density on the tumor membrane is $A$ (unknown, in molecules per $\\mu\\mathrm{m}^{2}$).\n- The CD80 areal density on the tumor membrane is $B = 60$ molecules per $\\mu\\mathrm{m}^{2}$.\n- The PD-L1 areal density on the tumor membrane is $P = 100$ molecules per $\\mu\\mathrm{m}^{2}$.\n- Two-dimensional dissociation constants: $K_{d,\\mathrm{TCR}}^{2D} = 80$ molecules per $\\mu\\mathrm{m}^{2}$, $K_{d,\\mathrm{CD28}}^{2D} = 40$ molecules per $\\mu\\mathrm{m}^{2}$, $K_{d,\\mathrm{PD1}}^{2D} = 50$ molecules per $\\mu\\mathrm{m}^{2}$.\n- Weights: $w_{\\mathrm{TCR}} = 1.0$, $w_{\\mathrm{CD28}} = 0.5$, $w_{\\mathrm{PD1}} = 0.8$.\n- PD-1 blockade fraction: $b = 0.75$.\n- Activation threshold: $\\Theta_{\\mathrm{act}} = 0.7$.\n\nAssume ligand depletion by binding is negligible at the synapse for each pairwise interaction. Starting from the equilibrium definition of the dissociation constant and the stated signal integration model, determine the minimal peptide–MHC areal density $A^{\\ast}$ such that $S = \\Theta_{\\mathrm{act}}$ at steady state. Express your final answer as a single real number in molecules per $\\mu\\mathrm{m}^{2}$, and round your answer to four significant figures.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n\n- **Law of mass action:** $K_{d}^{2D} = \\dfrac{[R]_{\\mathrm{free}}[L]_{\\mathrm{free}}}{[RL]}$\n- **Net signaling input model:** $S = w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$\n- **Effective PD-1 signaling:** $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = (1-b)\\,\\theta_{\\mathrm{PD1}}$\n- **Activation condition:** $S = \\Theta_{\\mathrm{act}}$\n- **Ligand areal densities:**\n    - Peptide–MHC: $A$ (unknown)\n    - CD80/CD86: $B = 60 \\, \\text{molecules}/\\mu\\mathrm{m}^{2}$\n    - PD-L1: $P = 100 \\, \\text{molecules}/\\mu\\mathrm{m}^{2}$\n- **Two-dimensional dissociation constants:**\n    - $K_{d,\\mathrm{TCR}}^{2D} = 80 \\, \\text{molecules}/\\mu\\mathrm{m}^{2}$\n    - $K_{d,\\mathrm{CD28}}^{2D} = 40 \\, \\text{molecules}/\\mu\\mathrm{m}^{2}$\n    - $K_{d,\\mathrm{PD1}}^{2D} = 50 \\, \\text{molecules}/\\mu\\mathrm{m}^{2}$\n- **Signaling weights:**\n    - $w_{\\mathrm{TCR}} = 1.0$\n    - $w_{\\mathrm{CD28}} = 0.5$\n    - $w_{\\mathrm{PD1}} = 0.8$\n- **Blockade fraction:** $b = 0.75$\n- **Activation threshold:** $\\Theta_{\\mathrm{act}} = 0.7$\n- **Key assumption:** Ligand depletion by binding is negligible ($[L]_{\\mathrm{free}} \\approx [L]_{\\mathrm{total}}$).\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem is based on standard, albeit simplified, models of receptor-ligand kinetics (law of mass action) and signal integration used in computational immunology and systems biology. The biological entities (TCR, PD-1, etc.) and the context (checkpoint blockade) are central to modern immunotherapy. The model is a valid theoretical construct.\n- **Well-Posed:** The problem provides a clear objective (find $A^*$) and a sufficient set of equations and parameters to establish a unique relationship between the variables.\n- **Objective:** The problem statement is quantitative and free of subjective or ambiguous language.\n- **Flaw Checklist:**\n    1.  *Scientific/Factual Unsoundness:* None. The model is a simplification but does not violate fundamental principles.\n    2.  *Non-Formalizable/Irrelevant:* None. The problem is a formal mathematical exercise within the specified field.\n    3.  *Incomplete/Contradictory Setup:* None. The problem is self-contained. The \"negligible ligand depletion\" assumption is explicitly stated and is necessary for a straightforward solution.\n    4.  *Unrealistic/Infeasible:* None. The parameter values are within plausible ranges for such biophysical models.\n    5.  *Ill-Posed/Poorly Structured:* None. It leads to a solvable algebraic equation for the unknown variable.\n    6.  *Pseudo-Profound/Trivial:* None. The problem requires a multi-step derivation that is non-trivial.\n    7.  *Outside Scientific Verifiability:* None. The model is, in principle, testable.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. A full solution will be provided.\n\n### **Solution**\n\nThe goal is to find the minimal peptide–MHC areal density, which we will denote as $A^{\\ast}$, that satisfies the T-cell activation condition $S = \\Theta_{\\mathrm{act}}$. The total signal $S$ is given by the linear integration model:\n$$S = w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$$\nThe activation condition is therefore:\n$$w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = \\Theta_{\\mathrm{act}}$$\nOur first step is to express the fractional occupancies $\\theta_{\\mathrm{X}}$ in terms of the given parameters. The fractional occupancy of a receptor $\\mathrm{R}$ is defined as $\\theta_{\\mathrm{R}} = \\frac{[\\mathrm{RL}]}{[\\mathrm{R}]_{\\mathrm{total}}}$, where $[\\mathrm{R}]_{\\mathrm{total}} = [\\mathrm{R}]_{\\mathrm{free}} + [\\mathrm{RL}]$. From the law of mass action, $K_{d}^{2D} = \\frac{[\\mathrm{R}]_{\\mathrm{free}}[\\mathrm{L}]_{\\mathrm{free}}}{[\\mathrm{RL}]}$, we can write $[\\mathrm{R}]_{\\mathrm{free}} = \\frac{K_{d}^{2D}[\\mathrm{RL}]}{[\\mathrm{L}]_{\\mathrm{free}}}$.\n\nSubstituting this into the total receptor concentration gives:\n$$[\\mathrm{R}]_{\\mathrm{total}} = \\frac{K_{d}^{2D}[\\mathrm{RL}]}{[\\mathrm{L}]_{\\mathrm{free}}} + [\\mathrm{RL}] = [\\mathrm{RL}] \\left( \\frac{K_{d}^{2D}}{[\\mathrm{L}]_{\\mathrm{free}}} + 1 \\right) = [\\mathrm{RL}] \\frac{K_{d}^{2D} + [\\mathrm{L}]_{\\mathrm{free}}}{[\\mathrm{L}]_{\\mathrm{free}}}$$\nRearranging to find the fractional occupancy $\\theta_{\\mathrm{R}} = \\frac{[\\mathrm{RL}]}{[\\mathrm{R}]_{\\mathrm{total}}}$:\n$$\\theta_{\\mathrm{R}} = \\frac{[\\mathrm{L}]_{\\mathrm{free}}}{K_{d}^{2D} + [\\mathrm{L}]_{\\mathrm{free}}}$$\nThe problem states that we can assume ligand depletion is negligible. This implies that the free ligand concentration is approximately equal to the total ligand concentration, i.e., $[\\mathrm{L}]_{\\mathrm{free}} \\approx [\\mathrm{L}]_{\\mathrm{total}}$. For each receptor-ligand pair, we can use the total ligand areal density in the formula for $\\theta$.\n\nLet's calculate the fractional occupancies for the co-stimulatory and inhibitory receptors.\n\nFor the CD28-CD80 interaction:\nThe ligand is CD80, with total areal density $B = 60$. The dissociation constant is $K_{d,\\mathrm{CD28}}^{2D} = 40$.\n$$\\theta_{\\mathrm{CD28}} = \\frac{B}{K_{d,\\mathrm{CD28}}^{2D} + B} = \\frac{60}{40 + 60} = \\frac{60}{100} = 0.6$$\n\nFor the PD-1-PD-L1 interaction:\nThe ligand is PD-L1, with total areal density $P = 100$. The dissociation constant is $K_{d,\\mathrm{PD1}}^{2D} = 50$.\n$$\\theta_{\\mathrm{PD1}} = \\frac{P}{K_{d,\\mathrm{PD1}}^{2D} + P} = \\frac{100}{50 + 100} = \\frac{100}{150} = \\frac{2}{3}$$\nThe effective inhibitory signal is modulated by the blocking antibody fraction $b = 0.75$.\n$$\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = (1-b)\\,\\theta_{\\mathrm{PD1}} = (1 - 0.75) \\left(\\frac{2}{3}\\right) = (0.25) \\left(\\frac{2}{3}\\right) = \\frac{1}{4} \\cdot \\frac{2}{3} = \\frac{2}{12} = \\frac{1}{6}$$\nNow, we substitute these values, along with the given weights and activation threshold, into the activation condition equation to solve for the required TCR fractional occupancy, $\\theta_{\\mathrm{TCR}}$.\n$w_{\\mathrm{TCR}} = 1.0$, $w_{\\mathrm{CD28}} = 0.5$, $w_{\\mathrm{PD1}} = 0.8$, $\\Theta_{\\mathrm{act}} = 0.7$.\n$$(1.0)\\,\\theta_{\\mathrm{TCR}} + (0.5)(0.6) - (0.8)\\left(\\frac{1}{6}\\right) = 0.7$$\n$$\\theta_{\\mathrm{TCR}} + 0.3 - \\frac{0.8}{6} = 0.7$$\nLet's work with fractions to maintain precision. $0.3 = \\frac{3}{10}$, $0.8 = \\frac{8}{10} = \\frac{4}{5}$, and $0.7 = \\frac{7}{10}$.\n$$\\theta_{\\mathrm{TCR}} + \\frac{3}{10} - \\left(\\frac{4}{5} \\cdot \\frac{1}{6}\\right) = \\frac{7}{10}$$\n$$\\theta_{\\mathrm{TCR}} + \\frac{3}{10} - \\frac{4}{30} = \\frac{7}{10}$$\n$$\\theta_{\\mathrm{TCR}} + \\frac{3}{10} - \\frac{2}{15} = \\frac{7}{10}$$\nNow, we isolate $\\theta_{\\mathrm{TCR}}$:\n$$\\theta_{\\mathrm{TCR}} = \\frac{7}{10} - \\frac{3}{10} + \\frac{2}{15} = \\frac{4}{10} + \\frac{2}{15} = \\frac{2}{5} + \\frac{2}{15}$$\nTo add these fractions, we find a common denominator, which is $15$.\n$$\\theta_{\\mathrm{TCR}} = \\frac{2 \\cdot 3}{5 \\cdot 3} + \\frac{2}{15} = \\frac{6}{15} + \\frac{2}{15} = \\frac{8}{15}$$\nFinally, we find the peptide–MHC areal density, $A^{\\ast}$, that gives this required TCR occupancy. The ligand for TCR is peptide–MHC, with density $A$.\n$$\\theta_{\\mathrm{TCR}} = \\frac{A^{\\ast}}{K_{d,\\mathrm{TCR}}^{2D} + A^{\\ast}}$$\nWe have $\\theta_{\\mathrm{TCR}} = \\frac{8}{15}$ and $K_{d,\\mathrm{TCR}}^{2D} = 80$.\n$$\\frac{8}{15} = \\frac{A^{\\ast}}{80 + A^{\\ast}}$$\nWe solve for $A^{\\ast}$ by cross-multiplication:\n$$8(80 + A^{\\ast}) = 15 A^{\\ast}$$\n$$640 + 8 A^{\\ast} = 15 A^{\\ast}$$\n$$640 = 15 A^{\\ast} - 8 A^{\\ast}$$\n$$640 = 7 A^{\\ast}$$\n$$A^{\\ast} = \\frac{640}{7}$$\nThe problem asks for a real number rounded to four significant figures.\n$$A^{\\ast} \\approx 91.42857...$$\nRounding to four significant figures gives:\n$$A^{\\ast} \\approx 91.43$$\nThe minimal peptide–MHC areal density required for T-cell activation under these conditions is $91.43$ molecules per $\\mu\\mathrm{m}^{2}$.", "answer": "$$\\boxed{91.43}$$", "id": "4355764"}, {"introduction": "The immune system is not a monolith; it is a diverse population of individual cells with varying capabilities. This exercise [@problem_id:4355753] bridges the gap between single-cell measurements and population-level dynamics, a central theme in systems biomedicine. You will build a model that incorporates heterogeneity in T-cell cytotoxicity and PD-1 expression to predict the overall tumor response, demonstrating how macroscopic outcomes emerge from microscopic diversity.", "problem": "You are asked to integrate single-cell measurements of cytotoxic T lymphocyte phenotypes into a mechanistic tumor–immune model to predict the effect of antibody blockade of the checkpoint receptor Programmed Cell Death Protein 1 (PD-1). Your program must, for each specified test case, compute and report the tumor size fold-change after a fixed time horizon.\n\nFundamental base and modeling assumptions:\n- The law of mass action for receptor–ligand binding implies that, for a drug concentration $D$ and dissociation constant $K_d$, the equilibrium fractional occupancy is $O = \\frac{D}{D + K_d}$.\n- Tumor growth follows logistic dynamics with intrinsic growth rate $r$ and carrying capacity $K$, yielding a baseline equation $dX/dt = r X \\left(1 - \\frac{X}{K}\\right)$ for tumor cell count $X(t)$.\n- Effector T cells kill tumor cells with an effective per-capita tumor-cell death coefficient that is reduced by PD-1 signaling in the absence of therapy and relieved proportionally to receptor occupancy under therapy. At the cell level, single-cell measurements provide per-cell cytotoxic coefficients and PD-1 expression levels. The overall effective killing coefficient is given by a weighted integration over the single-cell population according to their relative frequencies.\n\nFormally, define:\n- $X(t)$ as the tumor cell count at time $t$ (in days).\n- $r$ as the intrinsic tumor growth rate (in day$^{-1}$).\n- $K$ as the tumor carrying capacity (in cells).\n- $E_0$ as the effective effector T cell count (in cells) contributing to killing.\n- $\\{k_i\\}_{i=1}^n$ as single-cell cytotoxic coefficients (in cell$^{-1}$ day$^{-1}$), each corresponding to one observed T cell.\n- $\\{p_i\\}_{i=1}^n$ as single-cell PD-1 expression levels (dimensionless, nonnegative).\n- $\\{w_i\\}_{i=1}^n$ as nonnegative weights summing to $1$, representing the fraction of effector cells with phenotype $i$.\n- $\\theta$ as a dimensionless scaling constant translating PD-1 expression level into inhibitory impact on cytotoxicity.\n- $D$ as the anti-PD-1 drug concentration (in the same concentration units as $K_d$).\n- $K_d$ as the dissociation constant (in the same concentration units as $D$).\n- $T_h$ as the time horizon over which to predict tumor burden (in days).\n- $X_0$ as the initial tumor cell count at $t = 0$ (in cells).\n\nModel the effective population-level killing coefficient $K_{\\mathrm{eff}}$ (in day$^{-1}$) by combining single-cell heterogeneity according to\n- compute occupancy $O = \\frac{D}{D + K_d}$,\n- compute per-cell inhibition factor as a multiplicative reduction on cytotoxicity that is proportional to the unoccupied PD-1 fraction,\n- combine single-cell contributions via weighted averaging and scale by $E_0$.\n\nWith $K_{\\mathrm{eff}}$ defined, the tumor dynamics with immune killing is\n$$\n\\frac{dX}{dt} = r X \\left(1 - \\frac{X}{K}\\right) - K_{\\mathrm{eff}} X.\n$$\n\nTask:\n- For each test case, compute the tumor fold change $F = \\frac{X(T_h)}{X_0}$ as a real number (unitless), using the above modeling assumptions. Time must be in days, $r$ in day$^{-1}$, $K$ and $X_0$ in cells, $D$ and $K_d$ in the same concentration units, and $k_i$ in cell$^{-1}$ day$^{-1}$. Do not report a percentage; report a decimal ratio.\n\nTest suite:\nProvide results for the following four parameter sets. Each test case gives $(r, K, X_0, E_0, \\theta, K_d, D, T_h, \\{k_i\\}, \\{p_i\\}, \\{w_i\\})$.\n\n- Case 1 (general therapy at half-occupancy):\n  - $r = 0.02$ (day$^{-1}$)\n  - $K = 1.0 \\times 10^{11}$ (cells)\n  - $X_0 = 1.0 \\times 10^{9}$ (cells)\n  - $E_0 = 5.0 \\times 10^{7}$ (cells)\n  - $\\theta = 5.0$ (dimensionless)\n  - $K_d = 30.0$ (concentration units)\n  - $D = 30.0$ (same units as $K_d$)\n  - $T_h = 60.0$ (days)\n  - $\\{k_i\\} = [1.5 \\times 10^{-9}, 2.0 \\times 10^{-9}, 0.8 \\times 10^{-9}, 3.0 \\times 10^{-9}]$ (cell$^{-1}$ day$^{-1}$)\n  - $\\{p_i\\} = [0.6, 0.2, 0.9, 0.4]$ (dimensionless)\n  - $\\{w_i\\} = [0.25, 0.35, 0.15, 0.25]$ (dimensionless, sums to $1$)\n\n- Case 2 (no therapy control):\n  - Identical to Case 1 except $D = 0.0$.\n\n- Case 3 (saturating therapy):\n  - Identical to Case 1 except $D = 10000.0$.\n\n- Case 4 (boundary case with no PD-1 expression and net growth neutralization):\n  - $r = 0.02$ (day$^{-1}$)\n  - $K = 1.0 \\times 10^{11}$ (cells)\n  - $X_0 = 1.0 \\times 10^{9}$ (cells)\n  - $E_0 = 2.0 \\times 10^{7}$ (cells)\n  - $\\theta = 5.0$ (dimensionless)\n  - $K_d = 30.0$ (concentration units)\n  - $D = 0.0$ (same units as $K_d$)\n  - $T_h = 60.0$ (days)\n  - $\\{k_i\\} = [1.0 \\times 10^{-9}, 1.0 \\times 10^{-9}, 1.0 \\times 10^{-9}]$ (cell$^{-1}$ day$^{-1}$)\n  - $\\{p_i\\} = [0.0, 0.0, 0.0]$ (dimensionless)\n  - $\\{w_i\\} = [0.3, 0.4, 0.3]$ (dimensionless, sums to $1$)\n\nRequired final output format:\n- Your program should produce a single line of output containing the four fold-change results $F$ for the above test cases, as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), in this order: Case 1, Case 2, Case 3, Case 4.\n\nNotes:\n- Ensure scientific realism by adhering strictly to the specified units.\n- The algorithm must be general and must not hard-code closed-form answers for specific cases.\n- The only acceptable outputs are real-valued decimal numbers.", "solution": "The problem is deemed valid after a thorough review. It is scientifically grounded within the context of mechanistic modeling in systems biomedicine, well-posed, objective, and contains all necessary information to derive a unique solution.\n\nThe task is to compute the tumor size fold-change, $F = X(T_h)/X_0$, after a time horizon $T_h$, based on a provided ordinary differential equation (ODE) model of tumor-immune dynamics. The model integrates single-cell data on T cell cytotoxicity and checkpoint receptor expression.\n\nThe core of the problem lies in correctly formulating the effective killing coefficient, $K_{\\mathrm{eff}}$, and solving the resulting tumor growth ODE.\n\n**1. Formulation of the Effective Killing Coefficient ($K_{\\mathrm{eff}}$)**\n\nThe model describes tumor growth impeded by T cell-mediated killing, where the killing efficacy is modulated by the PD-1/PD-L1 checkpoint pathway and its blockade by an antibody drug.\n\nFirst, we calculate the fractional occupancy, $O$, of the PD-1 receptor by the drug. Following the law of mass action at equilibrium, this is given by:\n$$\nO = \\frac{D}{D + K_d}\n$$\nwhere $D$ is the drug concentration and $K_d$ is its dissociation constant. The fraction of unoccupied receptors, which are available to mediate an inhibitory signal, is thus $1 - O$.\n\nNext, we must formalize the per-cell effective cytotoxic coefficient. The problem states this involves a \"multiplicative reduction on cytotoxicity that is proportional to the unoccupied PD-1 fraction\". The strength of this inhibitory signal is also proportional to the PD-1 expression level, $p_i$, and a scaling constant, $\\theta$. A standard and robust formalization for such inhibitory effects in biochemical systems, which avoids non-physical outcomes like negative cytotoxicity, is a saturating inhibition function. We model the effective cytotoxic coefficient for a T cell of phenotype $i$, denoted $k'_i$, as:\n$$\nk'_i = \\frac{k_i}{1 + \\theta p_i (1 - O)}\n$$\nHere, $k_i$ is the intrinsic single-cell cytotoxic coefficient. The term $\\theta p_i (1 - O)$ represents the magnitude of the active, unbound PD-1 inhibitory signal. When this signal is zero (either because $p_i=0$ or $O=1$), $k'_i = k_i$, meaning cytotoxicity is maximal. As the signal increases, the denominator grows, reducing $k'_i$ in a saturating manner.\n\nThe population-level effective killing coefficient, $K_{\\mathrm{eff}}$, is a first-order rate constant (units: day$^{-1}$) in the tumor dynamics equation. It is obtained by taking the weighted average of the single-cell effective coefficients, $\\bar{k'} = \\sum_{i=1}^n w_i k'_i$, and scaling by the total number of effective effector T cells, $E_0$.\n$$\nK_{\\mathrm{eff}} = E_0 \\cdot \\bar{k'} = E_0 \\sum_{i=1}^n w_i k'_i = E_0 \\sum_{i=1}^n w_i \\frac{k_i}{1 + \\theta p_i (1 - O)}\n$$\nThis formulation is dimensionally consistent: $K_{\\mathrm{eff}}$ (day$^{-1}$) = $E_0$ (cells) $\\times \\bar{k'}$ (cell$^{-1}$ day$^{-1}$).\n\n**2. Solving the Tumor Growth Differential Equation**\n\nThe tumor cell count, $X(t)$, evolves according to the equation:\n$$\n\\frac{dX}{dt} = r X \\left(1 - \\frac{X}{K}\\right) - K_{\\mathrm{eff}} X\n$$\nThis equation combines logistic growth (first term) and immune-mediated killing (second term). We can rearrange this into the canonical form of a logistic equation:\n$$\n\\frac{dX}{dt} = (r - K_{\\mathrm{eff}})X - \\frac{r}{K}X^2 = (r - K_{\\mathrm{eff}})X \\left(1 - \\frac{X}{K \\frac{r - K_{\\mathrm{eff}}}{r}}\\right)\n$$\nLet's define the effective growth rate $r' = r - K_{\\mathrm{eff}}$ and the effective carrying capacity $K' = K \\frac{r'}{r} = K(1 - K_{\\mathrm{eff}}/r)$. The ODE becomes:\n$$\n\\frac{dX}{dt} = r' X \\left(1 - \\frac{X}{K'}\\right)\n$$\nThis is a standard logistic ODE with the known analytical solution:\n$$\nX(t) = \\frac{K'}{1 + \\left(\\frac{K'}{X_0} - 1\\right) e^{-r't}}\n$$\nwhere $X_0$ is the initial tumor cell count at $t=0$.\n\nA special case arises when $r' = r - K_{\\mathrm{eff}} = 0$. In this scenario, the immune killing exactly neutralizes the intrinsic tumor growth rate. The ODE simplifies to $\\frac{dX}{dt} = -\\frac{r}{K}X^2$. Integrating this separable equation from $t=0$ to $t=T_h$ yields the solution:\n$$\nX(T_h) = \\frac{X_0 K}{K + r T_h X_0}\n$$\nThis special-case formula is also the limit of the general solution as $r' \\to 0$ and is crucial for numerical stability.\n\n**3. Algorithm**\n\nFor each test case, the fold-change $F = X(T_h)/X_0$ is computed as follows:\n1.  Calculate the drug-receptor occupancy: $O = D / (D + K_d)$.\n2.  Calculate the population-level effective killing coefficient: $K_{\\mathrm{eff}} = E_0 \\sum_{i=1}^n \\frac{w_i k_i}{1 + \\theta p_i (1-O)}$.\n3.  Calculate the effective growth rate: $r' = r - K_{\\mathrm{eff}}$.\n4.  If $|r'|$ is close to zero (e.g., $|r'|  10^{-12}$), use the special-case formula to find $X(T_h)$:\n    $X(T_h) = (X_0 K) / (K + r T_h X_0)$.\n5.  Otherwise, calculate the effective carrying capacity $K' = K (r'/r)$ and use the general logistic solution to find $X(T_h)$:\n    $X(T_h) = K' / (1 + (K'/X_0 - 1) e^{-r' T_h})$.\n6.  Compute the final fold-change: $F = X(T_h) / X_0$.\n\nThis procedure is applied to each of the four provided parameter sets.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes tumor fold change for multiple immunotherapy scenarios.\n    \"\"\"\n\n    # Test cases defined as tuples of parameters:\n    # (r, K, X0, E0, theta, Kd, D, Th, k_i_list, p_i_list, w_i_list)\n    test_cases = [\n        # Case 1 (general therapy at half-occupancy)\n        (0.02, 1.0e11, 1.0e9, 5.0e7, 5.0, 30.0, 30.0, 60.0,\n         [1.5e-9, 2.0e-9, 0.8e-9, 3.0e-9],\n         [0.6, 0.2, 0.9, 0.4],\n         [0.25, 0.35, 0.15, 0.25]),\n\n        # Case 2 (no therapy control)\n        (0.02, 1.0e11, 1.0e9, 5.0e7, 5.0, 30.0, 0.0, 60.0,\n         [1.5e-9, 2.0e-9, 0.8e-9, 3.0e-9],\n         [0.6, 0.2, 0.9, 0.4],\n         [0.25, 0.35, 0.15, 0.25]),\n\n        # Case 3 (saturating therapy)\n        (0.02, 1.0e11, 1.0e9, 5.0e7, 5.0, 30.0, 10000.0, 60.0,\n         [1.5e-9, 2.0e-9, 0.8e-9, 3.0e-9],\n         [0.6, 0.2, 0.9, 0.4],\n         [0.25, 0.35, 0.15, 0.25]),\n\n        # Case 4 (boundary case with no PD-1 expression and net growth neutralization)\n        (0.02, 1.0e11, 1.0e9, 2.0e7, 5.0, 30.0, 0.0, 60.0,\n         [1.0e-9, 1.0e-9, 1.0e-9],\n         [0.0, 0.0, 0.0],\n         [0.3, 0.4, 0.3]),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        r, K, X0, E0, theta, Kd, D, Th, k_i_list, p_i_list, w_i_list = case\n\n        k_i = np.array(k_i_list)\n        p_i = np.array(p_i_list)\n        w_i = np.array(w_i_list)\n\n        # 1. Calculate drug-receptor occupancy\n        # Handle the case where D + Kd might be zero, although unlikely with positive Kd.\n        if D + Kd == 0:\n            occupancy = 1.0 if D > 0 else 0.0\n        else:\n            occupancy = D / (D + Kd)\n\n        # 2. Calculate population-level effective killing coefficient\n        # k'_i = k_i / (1 + theta * p_i * (1 - O))\n        k_i_eff = k_i / (1 + theta * p_i * (1 - occupancy))\n\n        # K_eff = E0 * sum(w_i * k'_i)\n        K_eff = E0 * np.sum(w_i * k_i_eff)\n\n        # 3. Calculate effective growth rate\n        r_prime = r - K_eff\n\n        # 4  5. Solve for X(Th) using analytical solution\n        # Use a small tolerance for the check r_prime == 0\n        if np.abs(r_prime)  1e-12:\n            # Special case for r_prime = 0\n            if (K + r * Th * X0) == 0:\n                # This case is physically unrealistic and implies infinite tumor size\n                # but handle to avoid division by zero.\n                X_Th = float('inf')\n            else:\n                X_Th = (X0 * K) / (K + r * Th * X0)\n        else:\n            # General logistic solution\n            K_prime = K * (r_prime / r)\n            \n            # Avoid division by zero if X0 is zero\n            if X0 == 0:\n                X_Th = 0.0\n            else:\n                denom_term = K_prime / X0 - 1\n                X_Th = K_prime / (1 + denom_term * np.exp(-r_prime * Th))\n        \n        # 6. Compute fold-change\n        if X0 == 0:\n            fold_change = 1.0 # Define as 1 if initial size is 0\n        else:\n            fold_change = X_Th / X0\n            \n        results.append(fold_change)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```", "id": "4355753"}, {"introduction": "A crucial challenge in immuno-oncology is interpreting radiographic scans, where an initial increase in tumor size can represent either true disease progression or a temporary, inflammation-driven flare known as pseudoprogression. This computational exercise [@problem_id:4355760] puts you in the role of a clinical modeler, tasking you with simulating these complex dynamics. By implementing a model that distinguishes viable tumor from inflammatory infiltrate, you will learn to apply objective criteria to differentiate these clinically critical scenarios.", "problem": "You are tasked with designing and implementing a program that models radiographic response under immune checkpoint blockade and classifies whether an observed early increase in the measured lesion size represents pseudoprogression rather than true progression, drawing on a mechanistic model consistent with Response Evaluation Criteria in Solid Tumors (RECIST) principles. Build the model and classification rule from first principles and well-tested assumptions as follows.\n\nBase modeling assumptions and definitions:\n- Let the latent viable tumor burden be denoted by $x(t)$, defined as a dimensionless normalized sum of diameters representing viable tumor. Under immune checkpoint blockade, assume logistic growth with immune-mediated cytotoxicity modeled by mass-action interaction with effector activity. Specifically,\n$$\n\\frac{dx}{dt} = r\\,x(t)\\left(1 - \\frac{x(t)}{K}\\right) - k\\,E_{\\mathrm{kill}}(t)\\,x(t),\n$$\nwhere $r$ is the baseline per capita growth rate, $K$ is the carrying capacity, $k$ is the effective kill coefficient, and $E_{\\mathrm{kill}}(t)$ is the time-dependent effector activity induced by checkpoint blockade.\n- Let the inflammatory and edema component be denoted by $y(t)$, representing non-viable tissue changes that can transiently enlarge radiographic size after therapy initiation. Assume this component is driven by an acute infiltration impulse that decays exponentially, and is cleared with first-order kinetics:\n$$\n\\frac{dy}{dt} = \\alpha\\,u(t) - \\beta\\,y(t), \\quad u(t) = u_0\\,e^{-\\lambda t},\n$$\nwhere $\\alpha$ scales infiltration magnitude, $\\beta$ is the clearance rate, and $u_0$ with $\\lambda$ define the amplitude and decay of the acute drive.\n- The effector activity induced by checkpoint blockade increases towards a plateau according to a standard approach-to-steady-state:\n$$\nE_{\\mathrm{kill}}(t) = E_0 + (E_{\\max} - E_0)\\left(1 - e^{-\\gamma t}\\right),\n$$\nwith $E_0$ the pre-therapy baseline, $E_{\\max}$ the maximal activity, and $\\gamma$ the activation rate constant.\n- The measured normalized sum of diameters $S(t)$ (unitless, normalized) combines viable tumor and inflammatory components with additive measurement noise:\n$$\nS(t) = x(t) + c\\,y(t) + \\varepsilon(t), \\quad \\varepsilon(t) \\sim \\mathcal{N}(0,\\sigma^2),\n$$\nwhere $c$ scales the contribution of inflammation to the measured size, and $\\sigma$ is the noise standard deviation.\n\nRECIST-inspired operational definitions for classification:\n- Define the baseline measurement $S_b = S(t_0)$ at the first time point $t_0$.\n- Define a progression threshold factor $\\tau = 0.2$ so that candidate progression at time $t_i$ occurs if $S(t_i) \\geq S_b(1+\\tau)$.\n- Define confirmation of progression if at the subsequent scheduled time point $t_{i+1}$, the inequality $S(t_{i+1}) \\geq S_b(1+\\tau)$ also holds.\n- Define pseudoprogression operationally as: a candidate progression time $t_i$ exists, progression is not confirmed at $t_{i+1}$, and the latent viable tumor burden is non-increasing over the interval, i.e., $x(t_{i+1}) \\leq x(t_i)$.\n\nYour program must:\n1. Implement the system of ordinary differential equations for $x(t)$ and $y(t)$ using the parameters provided in each test case.\n2. Compute $S(t)$ at specified discrete time points by adding independent Gaussian noise with variance $\\sigma^2$ to the deterministic $x(t) + c\\,y(t)$.\n3. Apply the classification rule above to return a boolean indicating pseudoprogression for each test case. If candidate progression occurs at the last available time point so that confirmation is impossible, classify as not pseudoprogression.\n\nTime points:\n- Use the discrete time vector $t = [\\,0,\\,1,\\,2,\\,3,\\,4\\,]$ (unitless time).\n\nTest suite:\nProvide four parameter sets that collectively probe distinct scenarios. All parameters are dimensionless and normalized.\n\n- Test Case A (happy path: pseudoprogression due to transient inflammation with underlying tumor decreasing):\n    - $r = 0.4$, $K = 100$, $k = 0.3$, $E_0 = 0.05$, $E_{\\max} = 0.9$, $\\gamma = 1.5$,\n    - $\\alpha = 1.0$, $\\beta = 2.0$, $u_0 = 100.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: early $S(t)$ crosses $S_b(1+\\tau)$, drops below at the next time point, and $x(t)$ is non-increasing across that interval.\n\n- Test Case B (true progression: sustained increase with minimal inflammation, underlying tumor increasing):\n    - $r = 0.6$, $K = 100$, $k = 0.05$, $E_0 = 0.05$, $E_{\\max} = 0.3$, $\\gamma = 1.0$,\n    - $\\alpha = 1.0$, $\\beta = 2.0$, $u_0 = 5.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: $S(t)$ surpasses $S_b(1+\\tau)$ and remains above at the next time point, with $x(t)$ increasing.\n\n- Test Case C (edge case: unconfirmed candidate progression driven by transient inflammation, but underlying tumor increasing):\n    - $r = 0.5$, $K = 100$, $k = 0.1$, $E_0 = 0.02$, $E_{\\max} = 0.2$, $\\gamma = 1.0$,\n    - $\\alpha = 1.0$, $\\beta = 2.0$, $u_0 = 80.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: $S(t)$ crosses $S_b(1+\\tau)$ then falls below, but $x(t)$ increases; therefore not pseudoprogression.\n\n- Test Case D (boundary: candidate progression occurs only at the last time point, hence cannot be confirmed):\n    - $r = 0.07$, $K = 200$, $k = 0.0$, $E_0 = 0.0$, $E_{\\max} = 0.0$, $\\gamma = 1.0$,\n    - $\\alpha = 0.5$, $\\beta = 2.0$, $u_0 = 5.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: $S(t)$ crosses $S_b(1+\\tau)$ only at $t=4$, with no $t=5$ to confirm; therefore not pseudoprogression.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,\\text{result}_1,\\,\\text{result}_2,\\,\\text{result}_3,\\,\\text{result}_4\\,]$), where each $\\text{result}_i$ is a boolean classification for the corresponding test case.\n\nNo physical units are used; all variables are dimensionless or normalized. Angles are not used. Express and compute all quantities as pure numbers, and ensure that the final printed output matches the specified format exactly.", "solution": "The problem requires the design and implementation of a computational model to distinguish between pseudoprogression and true progression in cancer immunotherapy, based on a set of coupled ordinary differential equations (ODEs) and RECIST-inspired classification rules.\n\nThe solution proceeds in two main stages: first, numerically solving the system of ODEs for the latent state variables, and second, applying the specified classification logic to the observable, noisy measurements.\n\nThe mathematical model is defined by a system of two first-order ODEs for the latent viable tumor burden, $x(t)$, and the inflammatory component, $y(t)$:\n$$\n\\frac{dx}{dt} = r\\,x(t)\\left(1 - \\frac{x(t)}{K}\\right) - k\\,E_{\\mathrm{kill}}(t)\\,x(t)\n$$\n$$\n\\frac{dy}{dt} = \\alpha\\,u_0\\,e^{-\\lambda t} - \\beta\\,y(t)\n$$\nThe dynamics of $x(t)$ are governed by logistic growth, with a tumor-killing term proportional to the product of the tumor burden and the effector activity, $E_{\\mathrm{kill}}(t)$. The dynamics of $y(t)$ are driven by a transient inflammatory impulse, $u(t) = u_0\\,e^{-\\lambda t}$, and are subject to first-order clearance. The therapy-induced effector activity, $E_{\\mathrm{kill}}(t)$, follows a saturating exponential increase towards a maximum level $E_{\\max}$:\n$$\nE_{\\mathrm{kill}}(t) = E_0 + (E_{\\max} - E_0)\\left(1 - e^{-\\gamma t}\\right)\n$$\nThe observable, the measured sum of lesion diameters $S(t)$, is a linear combination of the latent states with additive Gaussian noise $\\varepsilon(t) \\sim \\mathcal{N}(0, \\sigma^2)$:\n$$\nS(t) = x(t) + c\\,y(t) + \\varepsilon(t)\n$$\nGiven the initial conditions $x(0)$ and $y(0)$, and a set of parameters, this system of ODEs does not have a simple analytical solution. Therefore, a numerical approach is required. We will use a robust numerical ODE solver, specifically the `solve_ivp` function from the `scipy.integrate` library, which implements methods like the Runge-Kutta family to approximate the solution at discrete time points. The problem specifies the evaluation times as $t = [\\,0,\\,1,\\,2,\\,3,\\,4\\,]$.\n\nThe core of the implementation for each test case is as follows:\n1.  **Define the ODE System**: A function is defined to compute the derivatives $[dx/dt, dy/dt]$ given the current time $t$, the state vector $[x, y]$, and the set of model parameters.\n2.  **Solve Numerically**: `solve_ivp` is called with the ODE system function, the time interval $[0, 4]$, the initial conditions $[x(0), y(0)]$, and the specific time points $t=[\\,0,\\,1,\\,2,\\,3,\\,4\\,]$ for which the solution is required. The solver returns the values of $x(t_i)$ and $y(t_i)$ at these points.\n3.  **Construct Observable Signal**: The deterministic part of the signal, $x(t_i) + c\\,y(t_i)$, is computed. To simulate measurement uncertainty, independent and identically distributed random values are drawn from a Gaussian distribution $\\mathcal{N}(0, \\sigma^2)$ and added to the deterministic signal at each time point, yielding the final measured values $S(t_i)$. For reproducibility, the random number generator is initialized with a fixed seed.\n4.  **Apply Classification Rule**: The boolean classification for pseudoprogression is determined by applying the given operational rules. Let $S_b = S(t_0)$ be the baseline measurement and $\\tau = 0.2$ be the progression factor. A boolean flag, `is_pseudoprogression`, is initialized to `False`. The algorithm then iterates through the time points $t_i$ for $i \\in \\{1, 2, 3\\}$. The loop terminates before the last point because confirmation requires a subsequent measurement, $t_{i+1}$. For each $t_i$, the following three conditions are checked:\n    a.  **Candidate Progression**: $S(t_i) \\geq S_b(1+\\tau)$.\n    b.  **Non-confirmation**: $S(t_{i+1})  S_b(1+\\tau)$.\n    c.  **Non-increasing Latent Tumor**: $x(t_{i+1}) \\leq x(t_i)$.\n\nIf all three conditions are met for any $t_i$ in the checked range, pseudoprogression is identified. The flag `is_pseudoprogression` is set to `True`, and the search for that test case terminates. If the loop completes without finding such an instance, the flag remains `False`. This logic correctly handles the boundary condition where candidate progression occurs at the last time point ($t_4$), as the loop for `i` will not include this index.\n\nThis entire procedure is encapsulated and repeated for each of the four provided test cases, and the final boolean results are aggregated into a list.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Models radiographic response under immune checkpoint blockade and classifies pseudoprogression.\n    \"\"\"\n    # Define common parameters for the simulation\n    time_points = np.array([0.0, 1.0, 2.0, 3.0, 4.0])\n    recist_tau = 0.2\n\n    # Define the four test cases with their specific parameters\n    test_cases = [\n        # Test Case A: Pseudoprogression expected\n        {\n            'r': 0.4, 'K': 100, 'k': 0.3, 'E0': 0.05, 'Emax': 0.9, 'gamma': 1.5,\n            'alpha': 1.0, 'beta': 2.0, 'u0': 100.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        },\n        # Test Case B: True progression expected\n        {\n            'r': 0.6, 'K': 100, 'k': 0.05, 'E0': 0.05, 'Emax': 0.3, 'gamma': 1.0,\n            'alpha': 1.0, 'beta': 2.0, 'u0': 5.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        },\n        # Test Case C: Unconfirmed progression, but not pseudoprogression (x(t) increases)\n        {\n            'r': 0.5, 'K': 100, 'k': 0.1, 'E0': 0.02, 'Emax': 0.2, 'gamma': 1.0,\n            'alpha': 1.0, 'beta': 2.0, 'u0': 80.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        },\n        # Test Case D: Boundary case (progression at last time point)\n        {\n            'r': 0.07, 'K': 200, 'k': 0.0, 'E0': 0.0, 'Emax': 0.0, 'gamma': 1.0,\n            'alpha': 0.5, 'beta': 2.0, 'u0': 5.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        }\n    ]\n\n    # Initialize a random number generator with a fixed seed for reproducible noise\n    rng = np.random.default_rng(0)\n\n    final_results = []\n\n    def ode_system(t, z, p):\n        \"\"\"\n        Defines the system of ordinary differential equations for tumor and inflammation.\n        z: state vector [x, y]\n        p: dictionary of parameters\n        \"\"\"\n        x, y = z\n        E_kill = p['E0'] + (p['Emax'] - p['E0']) * (1.0 - np.exp(-p['gamma'] * t))\n        dxdt = p['r'] * x * (1.0 - x / p['K']) - p['k'] * E_kill * x\n        dydt = p['alpha'] * p['u0'] * np.exp(-p['lam'] * t) - p['beta'] * y\n        return [dxdt, dydt]\n\n    for params in test_cases:\n        # Set initial conditions for the current case\n        z0 = [params['x0'], params['y0']]\n\n        # Solve the ODE system numerically\n        solution = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, params),\n            t_span=(time_points[0], time_points[-1]),\n            y0=z0,\n            t_eval=time_points,\n            method='RK45',\n            dense_output=True\n        )\n        x_t = solution.y[0]\n        y_t = solution.y[1]\n\n        # Generate noisy measurements for S(t)\n        noise = rng.normal(0, params['sigma'], size=len(time_points))\n        S_t = x_t + params['c'] * y_t + noise\n\n        # Apply classification logic\n        is_pseudoprogression = False\n        S_baseline = S_t[0]\n        progression_threshold = S_baseline * (1.0 + recist_tau)\n\n        # Iterate through time points to check for pseudoprogression signature.\n        # The loop runs up to the second to last time point, as a subsequent\n        # time point is needed for confirmation.\n        for i in range(1, len(time_points) - 1):\n            # 1. Check for candidate progression at time t_i\n            candidate_progression = (S_t[i] >= progression_threshold)\n            \n            if candidate_progression:\n                # 2. Check for non-confirmation at the next time point t_{i+1}\n                progression_not_confirmed = (S_t[i+1]  progression_threshold)\n                \n                # 3. Check for non-increasing latent tumor burden over the interval\n                tumor_non_increasing = (x_t[i+1] = x_t[i])\n                \n                if progression_not_confirmed and tumor_non_increasing:\n                    is_pseudoprogression = True\n                    break  # An instance of pseudoprogression is found\n\n        final_results.append(is_pseudoprogression)\n\n    # Format the final output as specified\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str.replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```", "id": "4355760"}]}