{"hands_on_practices": [{"introduction": "The first step in any network-based analysis is transforming raw patient data into a meaningful network structure. This foundational exercise guides you through this crucial process, starting from a hypothetical gene-expression matrix. By calculating cosine similarity to build a patient similarity network and then evaluating a simple partition using modularity, you will practice the complete workflow from feature data to a quantitatively assessed patient stratification [@problem_id:4368693].", "problem": "You are given an $m \\times p$ feature matrix $X$ of normalized gene-expression intensities for $m$ patients across $p$ genes, intended to model a bipartite patient-gene network where an edge between patient $i$ and gene $j$ has weight $X_{ij}$. Consider the systems biomedicine task of network-based patient stratification via projection from the bipartite graph to a patient-patient similarity graph and subsequent community assessment. Let $m=p=4$ and\n$$\nX \\;=\\;\n\\begin{pmatrix}\n4 & 4 & 0 & 0 \\\\\n2 & 2 & 0 & 0 \\\\\n0 & 0 & 3 & 3 \\\\\n0 & 0 & 1.5 & 1.5\n\\end{pmatrix}.\n$$\nConstruct the patient-patient projection using cosine similarity on the rows of $X$, that is, let $W_{ij}$ denote the cosine similarity between the patient vectors $x_i$ and $x_j$ in $\\mathbb{R}^p$. Form an undirected weighted adjacency by setting $A_{ij} = W_{ij}$ for $i \\neq j$ and $A_{ii} = 0$. Using only fundamental definitions, compute the weighted degree (strength) $s_i$ of each patient node, propose a simple $2$-cluster assignment of patients justified by the connectivity structure for a similarity threshold of $0.5$, and then evaluate the quality of this assignment using the standard weighted Newman-Girvan (NG) modularity with the configuration model null for undirected graphs. Report the final modularity value $Q$ for your $2$-cluster partition. Express the final $Q$ exactly as a rational number (no rounding) and do not include any units.", "solution": "The problem requires a sequence of network analysis tasks on a given gene-expression matrix $X$. The steps are: 1) Construct a patient-patient similarity network using cosine similarity, 2) Identify a meaningful 2-cluster partition, and 3) Evaluate this partition using Newman-Girvan modularity.\n\nThe rows of the gene-expression matrix $X$ represent the patient vectors $x_i \\in \\mathbb{R}^4$ for $i \\in \\{1, 2, 3, 4\\}$:\n$x_1 = (4, 4, 0, 0)$\n$x_2 = (2, 2, 0, 0)$\n$x_3 = (0, 0, 3, 3)$\n$x_4 = (0, 0, 1.5, 1.5)$\n\nFirst, we construct the patient-patient similarity matrix $W$ using cosine similarity, $W_{ij} = \\frac{x_i \\cdot x_j}{\\|x_i\\| \\|x_j\\|}$.\n\nWe compute the Euclidean norms of the patient vectors:\n$\\|x_1\\| = \\sqrt{4^2 + 4^2} = \\sqrt{32} = 4\\sqrt{2}$\n$\\|x_2\\| = \\sqrt{2^2 + 2^2} = \\sqrt{8} = 2\\sqrt{2}$\n$\\|x_3\\| = \\sqrt{3^2 + 3^2} = \\sqrt{18} = 3\\sqrt{2}$\n$\\|x_4\\| = \\sqrt{1.5^2 + 1.5^2} = \\sqrt{2.25 + 2.25} = \\sqrt{4.5} = \\frac{3\\sqrt{2}}{2}$\n\nNext, we compute the dot products and the corresponding cosine similarities $W_{ij}$ for $i \\neq j$:\n$W_{12} = \\frac{x_1 \\cdot x_2}{\\|x_1\\| \\|x_2\\|} = \\frac{4(2) + 4(2)}{(4\\sqrt{2})(2\\sqrt{2})} = \\frac{16}{16} = 1$\n$W_{34} = \\frac{x_3 \\cdot x_4}{\\|x_3\\| \\|x_4\\|} = \\frac{3(1.5) + 3(1.5)}{(3\\sqrt{2})(3\\sqrt{2}/2)} = \\frac{9}{9} = 1$\nAll other pairwise dot products between non-identical patient vectors are zero (e.g., $x_1 \\cdot x_3 = 0$), so all other off-diagonal similarities are $0$.\n\nThe weighted adjacency matrix $A$ is formed by setting $A_{ij} = W_{ij}$ for $i \\neq j$ and $A_{ii} = 0$:\n$$\nA =\n\\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\nThis graph consists of two disconnected components: an edge of weight 1 between patients 1 and 2, and an edge of weight 1 between patients 3 and 4.\n\nThe weighted degree (strength) $s_i$ for each node $i$ is $s_i = \\sum_j A_{ij}$:\n$s_1 = 1$, $s_2 = 1$, $s_3 = 1$, $s_4 = 1$.\nThe total weight of the graph is $2w = \\sum_i s_i = 4$.\n\nThe problem asks for a 2-cluster assignment justified by connectivity. The graph structure clearly reveals two pairs of perfectly similar patients, $\\{1, 2\\}$ and $\\{3, 4\\}$, with no connection between the pairs. This naturally suggests the partition:\nCluster $C_1 = \\{1, 2\\}$\nCluster $C_2 = \\{3, 4\\}$\n\nFinally, we evaluate this partition using Newman-Girvan modularity $Q$:\n$$\nQ = \\frac{1}{2w} \\sum_{i,j} \\left( A_{ij} - \\frac{s_i s_j}{2w} \\right) \\delta(c_i, c_j)\n$$\nwhere $c_i$ is the community of node $i$ and $\\delta(c_i, c_j)=1$ if $c_i = c_j$ and $0$ otherwise. The sum is over all pairs of nodes within the same community.\n\nFor community $C_1 = \\{1, 2\\}$:\nThe contribution to the sum is $\\sum_{i,j \\in C_1} ( A_{ij} - \\frac{s_i s_j}{4} ) = (A_{12} - \\frac{s_1 s_2}{4}) + (A_{21} - \\frac{s_2 s_1}{4}) = (1 - \\frac{1 \\cdot 1}{4}) + (1 - \\frac{1 \\cdot 1}{4}) = \\frac{3}{4} + \\frac{3}{4} = \\frac{3}{2}$.\nNote: A common formulation sums over all pairs including self-loops, with $A_{ii}=0$. This is equivalent to summing only off-diagonal edges and adding the diagonal terms separately. A more direct way is to calculate the fraction of edges within the community minus the expected fraction.\nLet's use the definition of $Q = \\sum_c (e_c - a_c^2)$, where $e_c$ is the fraction of edges within community $c$ and $a_c$ is the fraction of stubs connected to community $c$.\nFraction of edges in $C_1$: $e_1 = \\frac{A_{12}}{w} = \\frac{1}{2}$. Fraction of edges in $C_2$: $e_2 = \\frac{A_{34}}{w} = \\frac{1}{2}$.\nFraction of stubs for $C_1$: $a_1 = \\frac{s_1+s_2}{2w} = \\frac{1+1}{4} = \\frac{1}{2}$. Fraction of stubs for $C_2$: $a_2 = \\frac{s_3+s_4}{2w} = \\frac{1+1}{4} = \\frac{1}{2}$.\n$Q = (e_1 - a_1^2) + (e_2 - a_2^2) = (\\frac{1}{2} - (\\frac{1}{2})^2) + (\\frac{1}{2} - (\\frac{1}{2})^2) = (\\frac{1}{2} - \\frac{1}{4}) + (\\frac{1}{2} - \\frac{1}{4}) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$.\n\nLet's re-verify with the initial summation formula. The sum is over all pairs $(i,j)$ in the same community.\nFor $C_1 = \\{1, 2\\}$:\n$\\left( A_{11} - \\frac{s_1^2}{4} \\right) + \\left( A_{22} - \\frac{s_2^2}{4} \\right) + \\left( A_{12} - \\frac{s_1 s_2}{4} \\right) + \\left( A_{21} - \\frac{s_2 s_1}{4} \\right)$\n$= \\left( 0 - \\frac{1}{4} \\right) + \\left( 0 - \\frac{1}{4} \\right) + \\left( 1 - \\frac{1}{4} \\right) + \\left( 1 - \\frac{1}{4} \\right) = -\\frac{1}{2} + \\frac{3}{2} = 1$.\nFor $C_2 = \\{3, 4\\}$, the calculation is identical, contributing $1$.\nTotal sum = $1 + 1 = 2$.\n$Q = \\frac{1}{2w} \\times (\\text{Total sum}) = \\frac{1}{4} \\times 2 = \\frac{1}{2}$.\n\nBoth methods give the same result. The modularity of the partition is $\\frac{1}{2}$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "4368693"}, {"introduction": "A patient similarity network's value is determined by its ability to reflect underlying biological reality. This practice focuses on characterizing a network's structure and testing its alignment with known patient subtypes. You will compute degree assortativity and a homophily measure to quantitatively assess whether the network's topology meaningfully captures the stratification, a critical skill for validating any network model [@problem_id:4368718].", "problem": "In systems biomedicine, network-based patient stratification leverages a Patient Similarity Network (PSN) that encodes pairwise similarity relationships among patients. Consider an undirected, simple PSN with $6$ patients labeled $P_{1},\\dots,P_{6}$, constructed by thresholding a multi-omics similarity score such that an edge indicates a high similarity between the connected patients. The network is represented by the symmetric adjacency matrix $A \\in \\{0,1\\}^{6 \\times 6}$:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 1 & 0 \\\\\n1 & 1 & 0 & 0 & 0 & 0 \\\\\n1 & 0 & 0 & 0 & 1 & 1 \\\\\n0 & 1 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}.\n$$\nEach patient has a known disease subtype label, with $P_{1},P_{2},P_{3}$ assigned to subtype $\\mathcal{S}_{A}$ and $P_{4},P_{5},P_{6}$ assigned to subtype $\\mathcal{S}_{B}$. Using first principles of graph-based analysis, compute the following and interpret how they reflect stratification quality:\n\n1. The degree distribution, reported as the vector $(k_{1},k_{2},k_{3},k_{4},k_{5},k_{6})$ where $k_{i}$ is the degree of patient $P_{i}$.\n\n2. The degree assortativity coefficient, defined as the Pearson correlation coefficient between the degrees at the two ends of each edge in the undirected network.\n\n3. A normalized homophily measure for subtype labels, defined as the observed fraction of edges that connect patients of the same subtype minus the expected fraction under random mixing given the subtype proportions in the node set.\n\nRound the degree assortativity coefficient and the normalized homophily measure to four significant figures. Express the final answer as a single row matrix listing $(k_{1},k_{2},k_{3},k_{4},k_{5},k_{6},r,H)$ in that order, where $r$ is the degree assortativity coefficient and $H$ is the normalized homophily measure. No physical units are required.", "solution": "The problem asks for the computation of three key network metrics for a given Patient Similarity Network (PSN): the degree distribution, the degree assortativity, and a normalized homophily measure.\n\n**1. Degree Distribution**\nThe degree $k_i$ of a node is the sum of its corresponding row (or column) in the adjacency matrix $A$.\n- $k_1 = A_{12}+A_{13}+A_{14} = 1+1+1 = 3$\n- $k_2 = A_{21}+A_{23}+A_{25} = 1+1+1 = 3$\n- $k_3 = A_{31}+A_{32} = 1+1 = 2$\n- $k_4 = A_{41}+A_{45}+A_{46} = 1+1+1 = 3$\n- $k_5 = A_{52}+A_{54}+A_{56} = 1+1+1 = 3$\n- $k_6 = A_{64}+A_{65} = 1+1 = 2$\n\nThe degree distribution vector is $(k_1, k_2, k_3, k_4, k_5, k_6) = (3, 3, 2, 3, 3, 2)$.\n\n**2. Degree Assortativity Coefficient ($r$)**\nThe degree assortativity coefficient $r$ is the Pearson correlation of degrees across all edges. The total number of edges is $M = \\frac{1}{2} \\sum k_i = \\frac{1}{2}(3+3+2+3+3+2) = 8$. We list the edges and the degrees of the nodes they connect:\n- Edge (1,2): degrees (3,3)\n- Edge (1,3): degrees (3,2)\n- Edge (1,4): degrees (3,3)\n- Edge (2,3): degrees (3,2)\n- Edge (2,5): degrees (3,3)\n- Edge (4,5): degrees (3,3)\n- Edge (4,6): degrees (3,2)\n- Edge (5,6): degrees (3,2)\nLet $x$ and $y$ be the two lists of degrees at either end of the edges:\n$x = (3, 3, 3, 3, 3, 3, 3, 3)$\n$y = (3, 2, 3, 2, 3, 3, 2, 2)$\nThe Pearson correlation is $r = \\frac{\\sum (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum(x_i - \\bar{x})^2 \\sum(y_i - \\bar{y})^2}}$.\nHere, $\\bar{x} = 3$. So $\\sum(x_i - \\bar{x}) = 0$.\n$\\bar{y} = \\frac{4 \\times 3 + 4 \\times 2}{8} = \\frac{12+8}{8} = 2.5$.\n$\\sum(x_i - \\bar{x})(y_i - \\bar{y}) = \\sum 0 \\times (y_i - \\bar{y}) = 0$.\nThis suggests an issue with this simple formulation. Let's use the standard formula for network assortativity:\n$$ r = \\frac{M^{-1}\\sum_{\\text{edges}} j_i k_i - [M^{-1}\\sum_{\\text{edges}} \\frac{1}{2}(j_i+k_i)]^2}{M^{-1}\\sum_{\\text{edges}} \\frac{1}{2}(j_i^2+k_i^2) - [M^{-1}\\sum_{\\text{edges}} \\frac{1}{2}(j_i+k_i)]^2} $$\nwhere $(j_i, k_i)$ are the degrees of the nodes for the $i$-th edge.\n- $\\sum j_i k_i = 4 \\times (3 \\times 3) + 4 \\times (3 \\times 2) = 36 + 24 = 60$. Average: $60/8 = 7.5$.\n- $\\sum \\frac{1}{2}(j_i+k_i) = 4 \\times \\frac{1}{2}(3+3) + 4 \\times \\frac{1}{2}(3+2) = 12 + 10 = 22$. Average: $22/8 = 2.75$.\n- $\\sum \\frac{1}{2}(j_i^2+k_i^2) = 4 \\times \\frac{1}{2}(3^2+3^2) + 4 \\times \\frac{1}{2}(3^2+2^2) = 36 + 26 = 62$. Average: $62/8 = 7.75$.\nPlugging these into the formula:\n$$ r = \\frac{7.5 - (2.75)^2}{7.75 - (2.75)^2} = \\frac{7.5 - 7.5625}{7.75 - 7.5625} = \\frac{-0.0625}{0.1875} = -\\frac{1}{3} \\approx -0.3333 $$\nThe negative assortativity indicates that high-degree nodes (degree 3) tend to connect to low-degree nodes (degree 2).\n\n**3. Normalized Homophily Measure ($H$)**\nHomophily measures the tendency of nodes to connect to similar nodes. Here, similarity is defined by sharing a subtype label. $H = f_{\\text{obs}} - f_{\\text{exp}}$.\n\n- **Observed Fraction ($f_{\\text{obs}}$):**\nWe count the number of edges connecting nodes of the same subtype.\nSubtype $\\mathcal{S}_A = \\{1, 2, 3\\}$. Intra-subtype edges: (1,2), (1,3), (2,3). There are 3 such edges.\nSubtype $\\mathcal{S}_B = \\{4, 5, 6\\}$. Intra-subtype edges: (4,5), (4,6), (5,6). There are 3 such edges.\nTotal intra-subtype edges = $3 + 3 = 6$.\nThe remaining 2 edges, (1,4) and (2,5), are inter-subtype.\nThe observed fraction of same-subtype edges is $f_{\\text{obs}} = \\frac{6}{8} = 0.75$.\n\n- **Expected Fraction ($f_{\\text{exp}}$):**\nThis is the fraction of same-subtype edges expected in a random network with the same degree distribution (configuration model).\nThe total number of edge \"stubs\" is $2M=16$.\nNumber of stubs from subtype $\\mathcal{S}_A$: $k_1+k_2+k_3 = 3+3+2 = 8$.\nNumber of stubs from subtype $\\mathcal{S}_B$: $k_4+k_5+k_6 = 3+3+2 = 8$.\nThe probability that a randomly chosen stub belongs to $\\mathcal{S}_A$ is $p_A = 8/16 = 0.5$.\nThe probability that a randomly chosen stub belongs to $\\mathcal{S}_B$ is $p_B = 8/16 = 0.5$.\nThe expected fraction of edges connecting two nodes of the same subtype is $f_{\\text{exp}} = p_A^2 + p_B^2 = (0.5)^2 + (0.5)^2 = 0.25 + 0.25 = 0.5$.\n\n- **Normalized Homophily ($H$):**\n$$ H = f_{\\text{obs}} - f_{\\text{exp}} = 0.75 - 0.5 = 0.2500 $$\nThe positive value of $H$ indicates strong homophily. Patients of the same subtype are much more likely to be connected than expected by chance, suggesting the network structure meaningfully captures the given stratification.\n\n**Final Answer**\nThe final result is the row matrix $(k_1, k_2, k_3, k_4, k_5, k_6, r, H)$.\n$(3, 3, 2, 3, 3, 2, -0.3333, 0.2500)$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 3 & 3 & 2 & 3 & 3 & 2 & -0.3333 & 0.2500 \\end{pmatrix} } $$", "id": "4368718"}, {"introduction": "Patient stratification is often most powerful when it integrates information from multiple data sources, such as genomics and proteomics. This advanced exercise introduces Similarity Network Fusion (SNF), a state-of-the-art algorithm for this task. By performing a manual iteration of the SNF diffusion process, you will gain a mechanistic understanding of how it synergistically combines information from different networks to create a single, more robust patient similarity map [@problem_id:4368745].", "problem": "You are studying Similarity Network Fusion (SNF) for patient stratification across two heterogeneous data modalities. You are given two symmetric patient affinity matrices $W^{(1)}$ and $W^{(2)}$ for $n=3$ patients, with zero diagonal, constructed from two independent omics data types. The goal is to perform exactly one SNF diffusion iteration starting from $W^{(1)}$ and $W^{(2)}$, using only fundamental definitions of graph-based normalization and diffusion, and to quantify how the fused inter-patient similarity between patients $1$ and $2$ changes after one iteration.\n\nAssume the following, which are standard and well-tested in graph-based data integration and Markov diffusion on networks:\n\n1. Each layer $m \\in \\{1,2\\}$ yields an affinity matrix $W^{(m)} \\in \\mathbb{R}^{3 \\times 3}$, where $W^{(m)}$ is symmetric, nonnegative, and satisfies $W^{(m)}_{ii}=0$. From $W^{(m)}$, define a row-stochastic, self-regularized transition matrix $P^{(m)}$ by setting $P^{(m)}_{ii}=\\frac{1}{2}$ for all $i$, and for $i \\neq j$,\n$$\nP^{(m)}_{ij} \\;=\\; \\frac{W^{(m)}_{ij}}{2 \\sum_{k \\neq i} W^{(m)}_{ik}}.\n$$\nThis yields a valid Markov transition matrix where each row sums to $1$ and exactly half of the probability mass remains at the node (self-retention), implementing local regularization.\n\n2. For each layer $m$, construct a $K$-nearest neighbor kernel $S^{(m)}$ with $K=1$ using the local neighborhood $\\mathcal{N}^{(m)}_i$ of node $i$ in $W^{(m)}$ (excluding self-loops). Specifically,\n$$\nS^{(m)}_{ij} \\;=\\;\n\\begin{cases}\n\\dfrac{W^{(m)}_{ij}}{\\sum_{k \\in \\mathcal{N}^{(m)}_i} W^{(m)}_{ik}}, & \\text{if } j \\in \\mathcal{N}^{(m)}_i \\\\\n0, & \\text{otherwise}\n\\end{cases}\n\\quad\\text{with } S^{(m)}_{ii}=0.\n$$\nWith $K=1$ and no ties, each row of $S^{(m)}$ has exactly one off-diagonal entry equal to $1$ (its nearest neighbor) and all other entries equal to $0$.\n\n3. Perform one SNF diffusion update using the cross-diffusion principle grounded in Markov propagation on graphs. For $M=2$ layers, update each layer by diffusing its $P^{(m)}$ through the other layer’s structure:\n$$\n\\widetilde{P}^{(m)} \\;=\\; S^{(m)} \\, P^{(\\ell)} \\, \\big(S^{(m)}\\big)^{\\top}, \\quad \\text{where } \\ell \\neq m.\n$$\nThen renormalize $\\widetilde{P}^{(m)}$ to $P_{\\text{new}}^{(m)}$ by setting $P_{\\text{new}}^{(m)}{}_{ii}=\\frac{1}{2}$ for all $i$ and rescaling each row’s off-diagonal entries to sum to $\\frac{1}{2}$, preserving row-stochasticity and the self-retention of $\\frac{1}{2}$.\n\n4. Define the one-step fused similarity as the simple average\n$$\n\\overline{P} \\;=\\; \\frac{1}{2}\\Big(P_{\\text{new}}^{(1)} + P_{\\text{new}}^{(2)}\\Big).\n$$\n\nThe given affinity matrices are\n$$\nW^{(1)} \\;=\\;\n\\begin{pmatrix}\n0 & 0.8 & 0.2 \\\\\n0.8 & 0 & 0.3 \\\\\n0.2 & 0.3 & 0\n\\end{pmatrix},\n\\qquad\nW^{(2)} \\;=\\;\n\\begin{pmatrix}\n0 & 0.4 & 0.7 \\\\\n0.4 & 0 & 0.1 \\\\\n0.7 & 0.1 & 0\n\\end{pmatrix}.\n$$\n\nTasks:\n- Using only the definitions above, carry out one full SNF iteration: construct $P^{(1)}$ and $P^{(2)}$ from $W^{(1)}$ and $W^{(2)}$, construct $S^{(1)}$ and $S^{(2)}$ with $K=1$, compute $\\widetilde{P}^{(1)}$ and $\\widetilde{P}^{(2)}$, renormalize to $P_{\\text{new}}^{(1)}$ and $P_{\\text{new}}^{(2)}$, and then compute $\\overline{P}$. Clearly show the normalization and update steps.\n- Briefly interpret how the local neighborhoods of patients $1$, $2$, and $3$ are altered across layers by comparing $S^{(1)}$ and $S^{(2)}$ and by inspecting $P_{\\text{new}}^{(1)}$ and $P_{\\text{new}}^{(2)}$.\n\nAnswer specification:\nReport only the scalar fused similarity between patients $1$ and $2$ after one iteration, that is $\\overline{P}_{12}$, as a single exact reduced fraction. Do not include any units. Do not round; an exact fraction is required as the final answer.", "solution": "The problem requires performing one full iteration of the Similarity Network Fusion (SNF) algorithm to calculate the fused similarity, $\\overline{P}_{12}$, between patients 1 and 2. We will follow the defined steps: constructing initial transition matrices, creating local affinity kernels, performing the diffusion update, renormalizing, and finally, averaging the results.\n\n**Step 1: Construct Initial Transition Matrices $P^{(1)}$ and $P^{(2)}$**\nFor $W^{(1)}$, the off-diagonal row sums are $(1.0, 1.1, 0.5)$.\nFor $W^{(2)}$, the off-diagonal row sums are $(1.1, 0.5, 0.8)$.\nUsing the formula $P^{(m)}_{ij} = \\frac{W^{(m)}_{ij}}{2 \\sum_{k \\neq i} W^{(m)}_{ik}}$ for $i \\neq j$ and $P^{(m)}_{ii}=1/2$:\n$$\nP^{(1)} = \\begin{pmatrix} 1/2 & \\frac{0.8}{2(1.0)} & \\frac{0.2}{2(1.0)} \\\\ \\frac{0.8}{2(1.1)} & 1/2 & \\frac{0.3}{2(1.1)} \\\\ \\frac{0.2}{2(0.5)} & \\frac{0.3}{2(0.5)} & 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 2/5 & 1/10 \\\\ 4/11 & 1/2 & 3/22 \\\\ 1/5 & 3/10 & 1/2 \\end{pmatrix}\n$$\n$$\nP^{(2)} = \\begin{pmatrix} 1/2 & \\frac{0.4}{2(1.1)} & \\frac{0.7}{2(1.1)} \\\\ \\frac{0.4}{2(0.5)} & 1/2 & \\frac{0.1}{2(0.5)} \\\\ \\frac{0.7}{2(0.8)} & \\frac{0.1}{2(0.8)} & 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 2/11 & 7/22 \\\\ 2/5 & 1/2 & 1/10 \\\\ 7/16 & 1/16 & 1/2 \\end{pmatrix}\n$$\n\n**Step 2: Construct Local Affinity Kernels $S^{(1)}$ and $S^{(2)}$**\nFor $K=1$, each row of $S^{(m)}$ will have a '1' at the column of its nearest neighbor and '0's elsewhere (off-diagonal).\n- For $W^{(1)}$: NN of 1 is 2; NN of 2 is 1; NN of 3 is 2.\n- For $W^{(2)}$: NN of 1 is 3; NN of 2 is 1; NN of 3 is 1.\n$$ S^{(1)} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}, \\qquad S^{(2)} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 1 & 0 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix} $$\nThe two data types imply different local structures: layer 1 suggests a strong (1,2) link, while layer 2 suggests a hub-spoke structure with patient 1 as the hub.\n\n**Step 3: Compute Updated Matrices $\\widetilde{P}^{(1)}$ and $\\widetilde{P}^{(2)}$**\nThe update rule is $\\widetilde{P}^{(m)} = S^{(m)} P^{(\\ell)} (S^{(m)})^{\\top}$.\n$$ \\widetilde{P}^{(1)} = S^{(1)} P^{(2)} (S^{(1)})^{\\top} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} P^{(2)} \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 2/5 & 1/2 \\\\ 2/11 & 1/2 & 2/11 \\\\ 1/2 & 2/5 & 1/2 \\end{pmatrix} $$\n$$ \\widetilde{P}^{(2)} = S^{(2)} P^{(1)} (S^{(2)})^{\\top} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 1 & 0 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix} P^{(1)} \\begin{pmatrix} 0 & 1 & 1 \\\\ 0 & 0 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 1/5 & 1/5 \\\\ 1/10 & 1/2 & 1/2 \\\\ 1/10 & 1/2 & 1/2 \\end{pmatrix} $$\n\n**Step 4: Renormalize to obtain $P_{\\text{new}}^{(1)}$ and $P_{\\text{new}}^{(2)}$**\nThe diagonal is set to $1/2$, and off-diagonal elements in each row are scaled to sum to $1/2$.\n- For $\\widetilde{P}^{(1)}$: Off-diagonal row sums are $(9/10, 4/11, 9/10)$. Scaling factors are $(5/9, 11/8, 5/9)$.\n$$ P_{\\text{new}}^{(1)} = \\begin{pmatrix} 1/2 & (2/5)(5/9) & (1/2)(5/9) \\\\ (2/11)(11/8) & 1/2 & (2/11)(11/8) \\\\ (1/2)(5/9) & (2/5)(5/9) & 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 2/9 & 5/18 \\\\ 1/4 & 1/2 & 1/4 \\\\ 5/18 & 2/9 & 1/2 \\end{pmatrix} $$\n- For $\\widetilde{P}^{(2)}$: Off-diagonal row sums are $(2/5, 3/5, 3/5)$. Scaling factors are $(5/4, 5/6, 5/6)$.\n$$ P_{\\text{new}}^{(2)} = \\begin{pmatrix} 1/2 & (1/5)(5/4) & (1/5)(5/4) \\\\ (1/10)(5/6) & 1/2 & (1/2)(5/6) \\\\ (1/10)(5/6) & (1/2)(5/6) & 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 1/4 & 1/4 \\\\ 1/12 & 1/2 & 5/12 \\\\ 1/12 & 5/12 & 1/2 \\end{pmatrix} $$\n\n**Step 5: Compute the Fused Similarity $\\overline{P}_{12}$**\nThe fused similarity is the average of the updated matrices: $\\overline{P} = \\frac{1}{2}(P_{\\text{new}}^{(1)} + P_{\\text{new}}^{(2)})$.\nWe only need the $(1,2)$ element:\n$$ \\overline{P}_{12} = \\frac{1}{2} \\left( P_{\\text{new}, 12}^{(1)} + P_{\\text{new}, 12}^{(2)} \\right) = \\frac{1}{2} \\left( \\frac{2}{9} + \\frac{1}{4} \\right) $$\n$$ \\overline{P}_{12} = \\frac{1}{2} \\left( \\frac{8}{36} + \\frac{9}{36} \\right) = \\frac{1}{2} \\left( \\frac{17}{36} \\right) = \\frac{17}{72} $$\nThe fused similarity between patients 1 and 2 is $\\frac{17}{72}$.", "answer": "$$\\boxed{\\frac{17}{72}}$$", "id": "4368745"}]}