{"hands_on_practices": [{"introduction": "The interaction between a drug and its protein target is the fundamental event in pharmacology, governed by principles of chemical equilibrium. This exercise guides you through deriving the foundational Hill-Langmuir equation, which quantitatively describes target occupancy as a function of drug concentration and binding affinity, starting from the law of mass action [@problem_id:4336175]. By coupling this equilibrium model with a dynamic pharmacokinetic profile, you will practice calculating how the engagement of multiple targets evolves over time, providing a quantitative snapshot of a drug's polypharmacological effects.", "problem": "In a tissue-level drug-target interaction network, a single small-molecule ligand $L$ engages three distinct target nodes $T_{1}$, $T_{2}$, and $T_{3}$ via independent edges $L + T_{i} \\rightleftharpoons LT_{i}$, for $i \\in \\{1,2,3\\}$. The system is studied under conditions where binding kinetics for each target are fast relative to the time variation of the ligand concentration and targets are non-depleting, such that the free ligand concentration equals the pharmacokinetic concentration profile. The pharmacokinetic concentration profile of the ligand is given by the biexponential function\n$$\n[L](t) = 1.2 \\times 10^{4}\\,\\exp(-0.3\\,t) + 3.0 \\times 10^{3}\\,\\exp(-0.02\\,t),\n$$\nwhere $t$ is time in $\\mathrm{h}$ and $[L](t)$ is in $\\mathrm{nM}$. The equilibrium dissociation constants for the three target edges are $K_{d,1} = 50\\,\\mathrm{nM}$, $K_{d,2} = 500\\,\\mathrm{nM}$, and $K_{d,3} = 5000\\,\\mathrm{nM}$.\n\nStarting strictly from the law of mass action for reversible binding, the definition of the equilibrium dissociation constant $K_{d,i}$, and the conservation of target mass, derive an expression for the fractional occupancy $\\theta_{i}(t)$ of each target edge in terms of $[L](t)$ and $K_{d,i}$. Then, using that expression, construct the weighted network occupancy\n$$\nO(t) = w_{1}\\,\\theta_{1}(t) + w_{2}\\,\\theta_{2}(t) + w_{3}\\,\\theta_{3}(t),\n$$\nwith edge weights $w_{1} = 0.5$, $w_{2} = 0.3$, and $w_{3} = 0.2$, and evaluate $O(t)$ at $t = 24\\,\\mathrm{h}$. Report $O(24\\,\\mathrm{h})$ as a unitless decimal fraction, rounded to four significant figures.", "solution": "The problem statement is evaluated as scientifically grounded, well-posed, objective, and complete. All provided data, conditions, and assumptions are physically and mathematically consistent, forming a standard problem in chemical kinetics and pharmacology. The problem is therefore deemed valid and a solution will be provided.\n\nThe first task is to derive the expression for the fractional occupancy, $\\theta_{i}(t)$, for each target edge. The analysis starts from the fundamental principles stipulated.\n\nFor each target $T_i$, the reversible binding of the ligand $L$ is described by the equilibrium:\n$$\nL + T_{i} \\rightleftharpoons LT_{i}\n$$\nwhere $i \\in \\{1,2,3\\}$.\n\nThe law of mass action applied at equilibrium defines the equilibrium dissociation constant, $K_{d,i}$:\n$$\nK_{d,i} = \\frac{[L][T_i]}{[LT_i]}\n$$\nIn this expression, $[L]$ is the concentration of the free ligand, $[T_i]$ is the concentration of the free target, and $[LT_i]$ is the concentration of the ligand-target complex.\n\nThe principle of conservation of mass for the target requires that the total concentration of target, $[T_i]_{\\text{total}}$, is the sum of the free and bound forms:\n$$\n[T_i]_{\\text{total}} = [T_i] + [LT_i]\n$$\nThe fractional occupancy, $\\theta_i$, is defined as the fraction of the total target population that is bound to the ligand:\n$$\n\\theta_i = \\frac{[LT_i]}{[T_i]_{\\text{total}}}\n$$\nSubstituting the expression for target conservation into the denominator gives:\n$$\n\\theta_i = \\frac{[LT_i]}{[T_i] + [LT_i]}\n$$\nTo express $\\theta_i$ in terms of $[L]$ and $K_{d,i}$, we first rearrange the definition of $K_{d,i}$ to solve for the free target concentration, $[T_i]$:\n$$\n[T_i] = K_{d,i} \\frac{[LT_i]}{[L]}\n$$\nNow, substitute this expression for $[T_i]$ into the denominator of the equation for $\\theta_i$:\n$$\n\\theta_i = \\frac{[LT_i]}{K_{d,i} \\frac{[LT_i]}{[L]} + [LT_i]}\n$$\nAssuming a non-trivial amount of binding ($[LT_i]  0$), we can factor out $[LT_i]$ from the denominator and cancel it with the numerator:\n$$\n\\theta_i = \\frac{1}{\\frac{K_{d,i}}{[L]} + 1}\n$$\nMultiplying the numerator and denominator by $[L]$ yields the final, more common form, known as the Hill-Langmuir equation:\n$$\n\\theta_i = \\frac{[L]}{[L] + K_{d,i}}\n$$\nThe problem states that binding kinetics are fast and targets are non-depleting, which justifies using this equilibrium expression at any given time $t$ and equating the free ligand concentration $[L]$ with the given pharmacokinetic concentration profile $[L](t)$. Thus, the time-dependent fractional occupancy for each target is:\n$$\n\\theta_i(t) = \\frac{[L](t)}{[L](t) + K_{d,i}}\n$$\nThis completes the derivation.\n\nThe second task is to evaluate the weighted network occupancy, $O(t)$, at $t = 24\\,\\mathrm{h}$. First, we must calculate the ligand concentration $[L](t)$ at $t=24\\,\\mathrm{h}$.\nThe pharmacokinetic profile is given by:\n$$\n[L](t) = 1.2 \\times 10^{4}\\,\\exp(-0.3\\,t) + 3.0 \\times 10^{3}\\,\\exp(-0.02\\,t)\n$$\nSubstituting $t = 24\\,\\mathrm{h}$:\n$$\n[L](24) = 1.2 \\times 10^{4}\\,\\exp(-0.3 \\times 24) + 3.0 \\times 10^{3}\\,\\exp(-0.02 \\times 24)\n$$\n$$\n[L](24) = 1.2 \\times 10^{4}\\,\\exp(-7.2) + 3.0 \\times 10^{3}\\,\\exp(-0.48)\n$$\nEvaluating the exponential terms and calculating the concentration:\n$$\n[L](24) \\approx (1.2 \\times 10^{4})(7.4658 \\times 10^{-4}) + (3.0 \\times 10^{3})(0.61878)\n$$\n$$\n[L](24) \\approx 8.9590 + 1856.35\n$$\n$$\n[L](24) \\approx 1865.31\\,\\mathrm{nM}\n$$\nLet's denote this value as $L_{24}$. So, $L_{24} \\approx 1865.31\\,\\mathrm{nM}$.\n\nNext, we calculate the fractional occupancy for each target at $t=24\\,\\mathrm{h}$ using the derived formula and the given $K_d$ values: $K_{d,1} = 50\\,\\mathrm{nM}$, $K_{d,2} = 500\\,\\mathrm{nM}$, and $K_{d,3} = 5000\\,\\mathrm{nM}$.\nFor target $T_1$:\n$$\n\\theta_1(24) = \\frac{L_{24}}{L_{24} + K_{d,1}} = \\frac{1865.31}{1865.31 + 50} = \\frac{1865.31}{1915.31} \\approx 0.97389\n$$\nFor target $T_2$:\n$$\n\\theta_2(24) = \\frac{L_{24}}{L_{24} + K_{d,2}} = \\frac{1865.31}{1865.31 + 500} = \\frac{1865.31}{2365.31} \\approx 0.78861\n$$\nFor target $T_3$:\n$$\n\\theta_3(24) = \\frac{L_{24}}{L_{24} + K_{d,3}} = \\frac{1865.31}{1865.31 + 5000} = \\frac{1865.31}{6865.31} \\approx 0.27170\n$$\nFinally, we calculate the weighted network occupancy $O(24\\,\\mathrm{h})$ using the given weights $w_{1} = 0.5$, $w_{2} = 0.3$, and $w_{3} = 0.2$:\n$$\nO(t) = w_{1}\\,\\theta_{1}(t) + w_{2}\\,\\theta_{2}(t) + w_{3}\\,\\theta_{3}(t)\n$$\n$$\nO(24) = (0.5)\\,\\theta_{1}(24) + (0.3)\\,\\theta_{2}(24) + (0.2)\\,\\theta_{3}(24)\n$$\n$$\nO(24) \\approx (0.5)(0.97389) + (0.3)(0.78861) + (0.2)(0.27170)\n$$\n$$\nO(24) \\approx 0.486945 + 0.236583 + 0.054340\n$$\n$$\nO(24) \\approx 0.777868\n$$\nRounding the result to four significant figures, as requested:\n$$\nO(24\\,\\mathrm{h}) \\approx 0.7779\n$$", "answer": "$$\\boxed{0.7779}$$", "id": "4336175"}, {"introduction": "Building on the concept of target occupancy, we now consider the cumulative impact of a drug over a full dosing period, a crucial factor for determining its overall therapeutic window. Many drugs engage both efficacy-driving targets and toxicity-mediating off-targets, and their net effect must be integrated over time. This practice introduces the concept of the Area Under the Effect Curve (AUEC) as a quantitative measure of a drug's benefit-risk profile, requiring you to solve for the cumulative engagement in a dynamic PK/PD system [@problem_id:4336195].", "problem": "A small-molecule drug engages multiple protein targets in a human system and is administered as a single intravenous bolus. The system can be modeled using a one-compartment Pharmacokinetics (PK) model with first-order elimination and fast binding kinetics that achieve quasi-equilibrium at the effect site. Assume the free plasma concentration approximates the effect-site concentration. The Pharmacodynamics (PD) target engagement for each target is modeled by the standard mass-action equilibrium occupancy. The cumulative network-level target engagement over a finite horizon is defined as a weighted sum of target occupancies to reflect beneficial and harmful pathway contributions.\n\nConsider the following scientifically plausible and self-consistent setting:\n- The dose is $D = 100$ mg, the volume of distribution is $V = 10$ L, the molecular weight is $M = 500$ g/mol, and the free (unbound) fraction in plasma is $f_u = 0.5$. The elimination rate constant is $k = 0.2$ h$^{-1}$.\n- There are two targets: target $\\mathrm{E}$ (efficacy-relevant) with equilibrium dissociation constant $K_{d,E} = 100$ nM and target $\\mathrm{T}$ (toxicity-relevant) with equilibrium dissociation constant $K_{d,T} = 1000$ nM.\n- Let the free drug concentration over time be $C_{\\mathrm{free}}(t)$ and the occupancy (fractional engagement) of target $i \\in \\{\\mathrm{E}, \\mathrm{T}\\}$ be $\\theta_i(t) = \\dfrac{C_{\\mathrm{free}}(t)}{K_{d,i} + C_{\\mathrm{free}}(t)}$, which follows from equilibrium mass-action binding when target abundance is much lower than ligand concentration.\n- Define the network-level engagement function as $\\theta(t) = w_E\\,\\theta_E(t) - w_T\\,\\theta_T(t)$, with weights $w_E = 1.0$ and $w_T = 0.5$ representing, respectively, the strength of efficacy-driving engagement and the penalty for toxicity-driving engagement.\n- The time horizon is $T = 24$ h.\n\nStarting from the above foundational PK-PD definitions and laws of mass action, compute the cumulative target engagement\n$$\\int_0^T \\theta(t)\\,dt.$$\nExpress your answer in hours and round your final numerical result to four significant figures. In addition to performing the calculation, the solution must articulate the scientific relevance of the cumulative engagement integral for efficacy and toxicity in multi-target drugs, grounded in the stated model and assumptions.", "solution": "The problem is valid as it is scientifically grounded in established pharmacokinetic (PK) and pharmacodynamic (PD) principles, is well-posed with all necessary information provided, and uses objective, formalizable language.\n\nFirst, we address the scientific relevance of the quantity to be computed. The cumulative target engagement, represented by the integral $\\int_0^T \\theta(t)\\,dt$, is a fundamental concept in systems pharmacology for quantifying the overall effect of a drug over a specific time period. The integrand, $\\theta(t) = w_E\\,\\theta_E(t) - w_T\\,\\theta_T(t)$, represents the net instantaneous effect of the drug, balancing its beneficial action on an efficacy target (E) with its harmful action on a toxicity target (T). The integral of this function, often called the \"area under the effect curve,\" aggregates this net effect over the entire time horizon $T$. The term $\\int_0^T w_E\\,\\theta_E(t)\\,dt$ quantifies the total beneficial engagement, which is hypothesized to correlate with the overall therapeutic outcome. Conversely, the term $\\int_0^T w_T\\,\\theta_T(t)\\,dt$ quantifies the total toxic engagement, which is related to the cumulative burden of adverse effects. Therefore, the total integral $\\int_0^T \\theta(t)\\,dt$ serves as a crucial PK/PD metric for the drug's therapeutic index over a finite period. Maximizing this value is a key objective in drug design and dose optimization, as it aims to maximize the therapeutic benefit while minimizing the toxicological risk, reflecting a favorable benefit-risk profile for the drug.\n\nNow, we proceed with the calculation.\n\nThe first step is to determine the time course of the free drug concentration, $C_{\\mathrm{free}}(t)$. For a one-compartment model with a single intravenous bolus, the total plasma concentration decays exponentially according to the equation:\n$C_{\\mathrm{total}}(t) = C_{\\mathrm{total}}(0) \\exp(-kt)$\nwhere $k$ is the elimination rate constant and $C_{\\mathrm{total}}(0)$ is the initial total concentration.\n\nWe calculate $C_{\\mathrm{total}}(0)$ from the dose $D$ and the volume of distribution $V$. First, we must ensure consistent units. We convert the dose from mass to moles and then calculate the molar concentration.\nDose in grams: $D = 100$ mg $= 0.1$ g.\nMolecular weight: $M = 500$ g/mol.\nNumber of moles of drug: $n = \\frac{D}{M} = \\frac{0.1\\,\\text{g}}{500\\,\\text{g/mol}} = 2 \\times 10^{-4}$ mol.\nInitial total concentration: $C_{\\mathrm{total}}(0) = \\frac{n}{V} = \\frac{2 \\times 10^{-4}\\,\\text{mol}}{10\\,\\text{L}} = 2 \\times 10^{-5}$ M.\n\nThe equilibrium dissociation constants $K_d$ are given in nanomolar (nM) units. We convert $C_{\\mathrm{total}}(0)$ to nM:\n$C_{\\mathrm{total}}(0) = 2 \\times 10^{-5}\\,\\text{mol/L} \\times \\frac{10^9\\,\\text{nmol/mol}}{1} = 20000$ nM.\n\nThe problem states that the free plasma concentration approximates the effect-site concentration. The free concentration is related to the total concentration by the free fraction $f_u$:\n$C_{\\mathrm{free}}(t) = f_u \\times C_{\\mathrm{total}}(t)$.\nThe initial free concentration, which we denote as $C_0$, is:\n$C_0 = C_{\\mathrm{free}}(0) = f_u \\times C_{\\mathrm{total}}(0) = 0.5 \\times 20000\\,\\text{nM} = 10000$ nM.\n\nThus, the function for the free drug concentration over time is:\n$C_{\\mathrm{free}}(t) = C_0 \\exp(-kt) = 10000 \\exp(-0.2t)$, where $t$ is in hours.\n\nThe problem asks to compute the cumulative target engagement:\n$$I = \\int_0^T \\theta(t)\\,dt = \\int_0^T \\left(w_E\\,\\theta_E(t) - w_T\\,\\theta_T(t)\\right) dt$$\nSubstituting the expression for target occupancy $\\theta_i(t) = \\dfrac{C_{\\mathrm{free}}(t)}{K_{d,i} + C_{\\mathrm{free}}(t)}$, we get:\n$$I = \\int_0^T \\left( w_E \\frac{C_{\\mathrm{free}}(t)}{K_{d,E} + C_{\\mathrm{free}}(t)} - w_T \\frac{C_{\\mathrm{free}}(t)}{K_{d,T} + C_{\\mathrm{free}}(t)} \\right) dt$$\nWe can split the integral into two parts:\n$$I = w_E \\int_0^T \\frac{C_0 \\exp(-kt)}{K_{d,E} + C_0 \\exp(-kt)} dt - w_T \\int_0^T \\frac{C_0 \\exp(-kt)}{K_{d,T} + C_0 \\exp(-kt)} dt$$\nLet's solve the general form of the integral, $\\int \\frac{C_0 \\exp(-kt)}{K_{d} + C_0 \\exp(-kt)} dt$. We use the substitution method. Let $u = K_{d} + C_0 \\exp(-kt)$. Then, the differential is $du = -k C_0 \\exp(-kt) dt$, which implies $C_0 \\exp(-kt) dt = -\\frac{1}{k} du$.\nThe integral becomes:\n$$\\int \\frac{1}{u} \\left(-\\frac{1}{k}\\right) du = -\\frac{1}{k} \\ln|u|$$\nSubstituting back for $u$ and evaluating the definite integral from $0$ to $T$:\n$$\\int_0^T \\frac{C_0 \\exp(-kt)}{K_{d} + C_0 \\exp(-kt)} dt = \\left[ -\\frac{1}{k} \\ln\\left(K_{d} + C_0 \\exp(-kt)\\right) \\right]_0^T$$\n$$= -\\frac{1}{k} \\left[ \\ln\\left(K_{d} + C_0 \\exp(-kT)\\right) - \\ln\\left(K_{d} + C_0 \\exp(-k \\cdot 0)\\right) \\right]$$\n$$= \\frac{1}{k} \\left[ \\ln\\left(K_{d} + C_0\\right) - \\ln\\left(K_{d} + C_0 \\exp(-kT)\\right) \\right] = \\frac{1}{k} \\ln\\left(\\frac{K_{d} + C_0}{K_{d} + C_0 \\exp(-kT)}\\right)$$\nNow we apply this result to both the efficacy and toxicity components of the total integral $I$:\n$$I = \\frac{w_E}{k} \\ln\\left(\\frac{K_{d,E} + C_0}{K_{d,E} + C_0 \\exp(-kT)}\\right) - \\frac{w_T}{k} \\ln\\left(\\frac{K_{d,T} + C_0}{K_{d,T} + C_0 \\exp(-kT)}\\right)$$\nWe substitute the given numerical values:\n$C_0 = 10000$ nM\n$k = 0.2$ h$^{-1}$\n$T = 24$ h\n$w_E = 1.0$\n$w_T = 0.5$\n$K_{d,E} = 100$ nM\n$K_{d,T} = 1000$ nM\n\nThe exponential term is $kT = 0.2 \\times 24 = 4.8$.\nSo, $\\exp(-kT) = \\exp(-4.8)$.\n\nFor the efficacy component:\n$$I_E = \\frac{1.0}{0.2} \\ln\\left(\\frac{100 + 10000}{100 + 10000 \\exp(-4.8)}\\right) = 5 \\ln\\left(\\frac{10100}{100 + 10000 \\exp(-4.8)}\\right)$$\n$$I_E \\approx 5 \\ln\\left(\\frac{10100}{100 + 10000 \\times 0.00822975}\\right) = 5 \\ln\\left(\\frac{10100}{182.2975}\\right) \\approx 5 \\ln(55.4042) \\approx 5 \\times 4.014704 \\approx 20.07352$$\n\nFor the toxicity component:\n$$I_T = \\frac{0.5}{0.2} \\ln\\left(\\frac{1000 + 10000}{1000 + 10000 \\exp(-4.8)}\\right) = 2.5 \\ln\\left(\\frac{11000}{1000 + 10000 \\exp(-4.8)}\\right)$$\n$$I_T \\approx 2.5 \\ln\\left(\\frac{11000}{1000 + 82.2975}\\right) = 2.5 \\ln\\left(\\frac{11000}{1082.2975}\\right) \\approx 2.5 \\ln(10.16357) \\approx 2.5 \\times 2.318817 \\approx 5.79704$$\n\nThe total cumulative engagement is the difference:\n$$I = I_E - I_T \\approx 20.07352 - 5.79704 = 14.27648$$\nThe unit of the occupancy $\\theta_i$ is dimensionless, and time $t$ is in hours (h), so the unit of the integral is hours.\nRounding the result to four significant figures gives $14.28$.\nThe final result is expressed in hours.", "answer": "$$\\boxed{14.28}$$", "id": "4336195"}, {"introduction": "The scale of the human proteome and chemical space makes experimental DTI screening exhaustive and expensive, necessitating computational prediction models. However, evaluating these models is non-trivial because known interactions are vastly outnumbered by non-interactions, creating severe class imbalance. This exercise challenges you to demonstrate from first principles why the Area Under the Precision-Recall Curve (AUPRC) is a more informative metric than the Area Under the Receiver Operating Characteristic (AUROC) in this common scenario, and to derive the AUPRC of a random classifier to establish a meaningful performance baseline [@problem_id:4336153].", "problem": "In the evaluation of Drug-Target Interaction (DTI) predictors on highly imbalanced bipartite graphs, two commonly used metrics are the Area Under the Receiver Operating Characteristic (AUROC) and the Area Under the Precision-Recall Curve (AUPRC). Consider a DTI screening task in which a scoring function assigns to each drug-target pair a continuous score intended to reflect the probability of interaction. Let $Y \\in \\{0,1\\}$ denote the true interaction label and $S \\in \\mathbb{R}$ the score. For a threshold $ \\tau \\in \\mathbb{R}$, the induced classifier predicts positive when $S \\ge \\tau$. The Receiver Operating Characteristic (ROC) curve plots the True Positive Rate (TPR) versus the False Positive Rate (FPR) as $\\tau$ varies, while the Precision-Recall (PR) curve plots Precision versus Recall as $\\tau$ varies. Here, Recall is $\\mathbb{P}(S \\ge \\tau \\mid Y=1)$ and Precision is $\\mathbb{P}(Y=1 \\mid S \\ge \\tau)$.\n\nUsing only the core probabilistic definitions above and the law of total probability, justify from first principles why AUROC is relatively insensitive to class imbalance, whereas AUPRC directly depends on the baseline positive rate $ \\pi = \\mathbb{P}(Y=1)$. Then, under the assumption of a random, non-informative scoring function such that $S \\perp Y$ (score is independent of the label), derive the expected AUPRC in terms of $ \\pi $.\n\nFinally, consider a realistic DTI bipartite setting with $N_D = 1200$ drugs and $N_T = 18000$ targets, and $M = 150000$ known interacting pairs, with all unknown pairs treated as negatives for evaluation. Compute the expected AUPRC of the random scoring model in this setting by first expressing the baseline positive rate as $ \\pi = \\frac{M}{N_D N_T} $ and then substituting it into your derived expression. Express your final answer as a reduced fraction. The quantity is dimensionless, so no units are required.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of statistical machine learning and performance evaluation, specifically within the context of systems biomedicine. The problem is well-posed, providing all necessary definitions and data for a unique solution. The language is objective and the scenario is realistic for the DTI domain.\n\nThe problem asks for a three-part solution: first, to justify from first principles the differential sensitivity of AUROC and AUPRC to class imbalance; second, to derive the expected AUPRC for a non-informative random classifier; and third, to compute this value for a specific DTI scenario.\n\n**Part 1: Sensitivity of AUROC and AUPRC to Class Imbalance**\n\nWe begin with the probabilistic definitions provided. The baseline positive rate, or class prevalence, is $\\pi = \\mathbb{P}(Y=1)$. The prevalence of the negative class is therefore $\\mathbb{P}(Y=0) = 1-\\pi$.\n\nFirst, consider the Area Under the Receiver Operating Characteristic (AUROC). The ROC curve is a plot of the True Positive Rate (TPR) against the False Positive Rate (FPR). The definitions of these rates are:\n-   True Positive Rate (also called Recall): $\\text{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)$\n-   False Positive Rate: $\\text{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=0)$\n\nBoth TPR and FPR are conditional probabilities, where the conditioning event is the true class label ($Y=1$ for TPR, $Y=0$ for FPR). The calculation of TPR only involves the scores of the positive instances, and the calculation of FPR only involves the scores of the negative instances. Neither definition directly involves the class prevalence $\\pi$. The ROC curve's shape is determined by the separation between the score distributions for the positive and negative classes, $\\mathbb{P}(S|Y=1)$ and $\\mathbb{P}(S|Y=0)$. Since both axes of the ROC plot are independent of $\\pi$, the curve itself and its area, AUROC, are insensitive to class imbalance.\n\nNext, consider the Area Under the Precision-Recall Curve (AUPRC). The PR curve is a plot of Precision against Recall. We already have the definition of Recall, which is the TPR. The definition of Precision is:\n-   Precision: $\\text{Precision}(\\tau) = \\mathbb{P}(Y=1 \\mid S \\ge \\tau)$\n\nTo understand its dependence on $\\pi$, we use Bayes' theorem to expand the definition of Precision:\n$$ \\text{Precision}(\\tau) = \\frac{\\mathbb{P}(S \\ge \\tau \\mid Y=1) \\mathbb{P}(Y=1)}{\\mathbb{P}(S \\ge \\tau)} $$\nThe denominator, $\\mathbb{P}(S \\ge \\tau)$, can be expanded using the law of total probability:\n$$ \\mathbb{P}(S \\ge \\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)\\mathbb{P}(Y=1) + \\mathbb{P}(S \\ge \\tau \\mid Y=0)\\mathbb{P}(Y=0) $$\nSubstituting the definitions for TPR, FPR, and $\\pi$:\n$$ \\mathbb{P}(S \\ge \\tau) = \\text{TPR}(\\tau) \\cdot \\pi + \\text{FPR}(\\tau) \\cdot (1-\\pi) $$\nNow, substituting this back into the expression for Precision, and noting that $\\text{Recall}(\\tau) = \\text{TPR}(\\tau)$:\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\cdot \\pi + \\text{FPR}(\\tau) \\cdot (1-\\pi)} $$\nThis equation demonstrates that Precision is an explicit function of the class prevalence $\\pi$. In a highly imbalanced setting where the number of negatives is much larger than the number of positives, $\\pi$ is very small, and $(1-\\pi)$ is close to $1$. The denominator becomes dominated by the term $\\text{FPR}(\\tau) \\cdot (1-\\pi)$. A small FPR, which might be acceptable in a balanced setting, can cause a dramatic drop in precision when the negative class is vast. Since one of the axes (Precision) of the PR curve is directly dependent on $\\pi$, the entire curve and its area, AUPRC, are sensitive to class imbalance.\n\n**Part 2: Expected AUPRC for a Random, Non-Informative Scoring Function**\n\nThe problem states that the scoring function is random and non-informative, which is formalized as the score $S$ being statistically independent of the true label $Y$, denoted $S \\perp Y$.\nThis independence implies that the conditional probability of obtaining a score $S \\ge \\tau$ is the same regardless of the true class label:\n$$ \\mathbb{P}(S \\ge \\tau \\mid Y=1) = \\mathbb{P}(S \\ge \\tau \\mid Y=0) $$\nUsing the definitions of TPR and FPR, this means:\n$$ \\text{TPR}(\\tau) = \\text{FPR}(\\tau) $$\nFor any given threshold $\\tau$, a random classifier yields the same rate of positives from both the true positive and true negative populations. This is the hallmark of a non-informative model. The ROC curve for such a classifier is the diagonal line from $(0,0)$ to $(1,1)$, yielding an AUROC of $0.5$.\n\nNow we analyze the AUPRC. We substitute the condition $\\text{FPR}(\\tau) = \\text{TPR}(\\tau)$ (or $\\text{FPR}(\\tau) = \\text{Recall}(\\tau)$) into the equation for Precision derived in Part 1:\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\cdot \\pi + \\text{Recall}(\\tau) \\cdot (1-\\pi)} $$\nFor any threshold $\\tau$ such that $\\text{Recall}(\\tau)  0$, we can factor $\\text{Recall}(\\tau)$ out of the denominator:\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\left[ \\pi + (1-\\pi) \\right]} $$\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\cdot 1} $$\n$$ \\text{Precision}(\\tau) = \\pi $$\nThis result shows that for a non-informative classifier, the precision is constant and equal to the baseline positive rate $\\pi$ for any value of recall greater than $0$. As the threshold $\\tau$ is varied from its maximum to its minimum value, the recall ranges from $0$ to $1$. The PR curve is therefore a horizontal line at a height of $\\pi$ over the recall interval $[0, 1]$.\nThe area under this curve, AUPRC, is the area of a rectangle with height $\\pi$ and width $1$.\n$$ \\text{AUPRC}_{\\text{random}} = \\text{height} \\times \\text{width} = \\pi \\times 1 = \\pi $$\nThus, the expected AUPRC for a random classifier is simply the baseline positive rate $\\pi$.\n\n**Part 3: Calculation for the Specific DTI Setting**\n\nThe problem provides the following values for a DTI screening task:\n-   Number of drugs, $N_D = 1200$\n-   Number of targets, $N_T = 18000$\n-   Number of known interacting pairs (positives), $M = 150000$\n\nThe total number of possible drug-target pairs is $N_{total} = N_D \\times N_T$. The baseline positive rate $\\pi$ is the fraction of true positives in the entire dataset:\n$$ \\pi = \\frac{M}{N_D N_T} $$\nWe substitute the given numerical values into this expression:\n$$ \\pi = \\frac{150000}{1200 \\times 18000} $$\nTo simplify this fraction, we can cancel common factors.\n$$ \\pi = \\frac{150000}{21600000} $$\nWe can cancel four zeros (a factor of $10^4$) from the numerator and the denominator:\n$$ \\pi = \\frac{15}{2160} $$\nNow we can reduce this fraction. The numerator is $15 = 3 \\times 5$. The denominator $2160$ is divisible by $5$ (since it ends in $0$) and by $3$ (since the sum of its digits $2+1+6+0=9$ is divisible by $3$). Let's divide both by $15$:\n$$ 2160 \\div 15 = (2160 \\div 3) \\div 5 = 720 \\div 5 = 144 $$\nSo, the fraction simplifies to:\n$$ \\pi = \\frac{1}{144} $$\nAs derived in Part 2, the expected AUPRC of the random scoring model is equal to this baseline positive rate $\\pi$. Therefore, the expected AUPRC is $\\frac{1}{144}$. This fraction is fully reduced.", "answer": "$$\n\\boxed{\\frac{1}{144}}\n$$", "id": "4336153"}]}