{"hands_on_practices": [{"introduction": "Before we can declare a gene or drug pair as synthetically lethal, we must first have a quantitative way to measure their interaction. This exercise introduces the Bliss independence model, a fundamental framework in pharmacology for defining synergy as a stronger-than-expected effect. You will use experimental growth rate data from a hypothetical drug screen to calculate cell viability and compute the Bliss synergy score, providing a concrete metric for the strength of the interaction [@problem_id:4354444].", "problem": "A cell population of size $N_0$ proliferates according to exponential growth under each condition, consistent with first principles for well-mixed populations in the absence of resource limitation: $N(t) = N_0 \\exp(\\mu t)$, where $N(t)$ is the cell number at time $t$ and $\\mu$ is the net per-capita growth rate. In a drug-combination experiment evaluating potential synthetic lethality, the following net growth rates (in $\\text{h}^{-1}$) are measured over $t = 72$ hours:\n- Control (vehicle): $\\mu_C = \\frac{\\ln 2}{24}$.\n- Agent $A$ alone: $\\mu_A = 0.015$.\n- Agent $B$ alone: $\\mu_B = 0.020$.\n- Combination $A+B$: $\\mu_{AB} = -0.005$.\n\nDefine the normalized viability under condition $X \\in \\{A, B, AB\\}$ as the ratio $W_X = \\frac{N_X(t)}{N_C(t)}$, where $N_C(t)$ is the control cell count at time $t$. Under the assumption of independence of effects (Bliss independence), the expected combined viability in the absence of interaction equals the product of the single-agent viabilities. The Bliss synergy score is defined as the deviation of the observed combined viability from this independence expectation at time $t$.\n\nUsing only the exponential growth law and the independence principle, compute the Bliss synergy score at $t = 72$ hours. Round your answer to four significant figures and report it as a unitless decimal number.\n\nAdditionally, adopt the following operational criterion for synthetic lethality: the combination is called synthetically lethal if (i) both single agents are non-lethal, quantified as $W_A  \\theta$ and $W_B  \\theta$ with $\\theta = 0.2$, (ii) the combination is lethal, quantified as $W_{AB}  \\lambda$ with $\\lambda = 0.1$, and (iii) the Bliss deviation is strictly negative. Based on your computed quantities, determine whether the combination qualifies as synthetically lethal under these criteria. Your final reported answer should be only the Bliss synergy score rounded as specified; do not include any units or categorical labels in the final answer.", "solution": "The problem requires the calculation of the Bliss synergy score for a drug combination and an assessment of whether the combination is synthetically lethal based on a given set of criteria. The starting point is the exponential growth law for cell populations.\n\nFirst, I will validate the problem statement.\n**Step 1: Extract Givens**\n- Cell growth model: $N(t) = N_0 \\exp(\\mu t)$\n- Time point for analysis: $t = 72$ hours\n- Net growth rates ($\\text{h}^{-1}$):\n  - Control: $\\mu_C = \\frac{\\ln 2}{24}$\n  - Agent A: $\\mu_A = 0.015$\n  - Agent B: $\\mu_B = 0.020$\n  - Combination A+B: $\\mu_{AB} = -0.005$\n- Normalized viability definition: $W_X = \\frac{N_X(t)}{N_C(t)}$ for $X \\in \\{A, B, AB\\}$\n- Bliss independence model: Expected combined viability $W_{AB, \\text{exp}} = W_A \\cdot W_B$\n- Bliss synergy score definition: The deviation of the observed combined viability ($W_{AB, \\text{obs}}$) from the independence expectation ($W_{AB, \\text{exp}}$).\n- Synthetic lethality criteria:\n  - (i) Non-lethal single agents: $W_A  \\theta$ and $W_B  \\theta$, with $\\theta = 0.2$.\n  - (ii) Lethal combination: $W_{AB}  \\lambda$, with $\\lambda = 0.1$.\n  - (iii) Synergistic interaction: The Bliss deviation is strictly negative.\n- Final answer requirement: Report the Bliss synergy score rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using standard models (exponential growth) and concepts (Bliss independence, synergy score) from quantitative pharmacology and systems biology. The provided growth rates are physically realistic for in-vitro cell culture experiments; for instance, $\\mu_C$ corresponds to a $24$-hour doubling time, a common value. The problem is well-posed, providing all necessary definitions, constants, and data for a unique solution. The language is objective and precise. There are no internal contradictions or missing pieces of information. The problem is not trivial, as it requires careful application of the provided definitions and a multi-step calculation.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with a full solution.\n\nThe normalized viability $W_X$ for condition $X$ at time $t$ is defined as the ratio of the cell number under condition $X$ to the cell number in the control condition. Using the exponential growth law, this can be expressed in terms of the growth rates:\n$$W_X(t) = \\frac{N_X(t)}{N_C(t)} = \\frac{N_0 \\exp(\\mu_X t)}{N_0 \\exp(\\mu_C t)} = \\exp((\\mu_X - \\mu_C) t)$$\nThis expression is valid for $X \\in \\{A, B, AB\\}$. The analysis is performed at $t=72$ hours.\n\nFirst, we calculate the viabilities of the single agents, $W_A$ and $W_B$.\nFor Agent A:\n$$W_A = \\exp\\left((\\mu_A - \\mu_C)t\\right) = \\exp\\left(\\left(0.015 - \\frac{\\ln 2}{24}\\right) \\cdot 72\\right)$$\n$$W_A = \\exp\\left(0.015 \\cdot 72 - \\frac{\\ln 2}{24} \\cdot 72\\right) = \\exp(1.08 - 3\\ln 2) = \\exp(1.08) \\exp(-\\ln(2^3)) = \\frac{\\exp(1.08)}{8}$$\nFor Agent B:\n$$W_B = \\exp\\left((\\mu_B - \\mu_C)t\\right) = \\exp\\left(\\left(0.020 - \\frac{\\ln 2}{24}\\right) \\cdot 72\\right)$$\n$$W_B = \\exp\\left(0.020 \\cdot 72 - \\frac{\\ln 2}{24} \\cdot 72\\right) = \\exp(1.44 - 3\\ln 2) = \\exp(1.44) \\exp(-\\ln 8) = \\frac{\\exp(1.44)}{8}$$\n\nNext, we calculate the observed viability of the combination, $W_{AB, \\text{obs}}$.\n$$W_{AB, \\text{obs}} = \\exp\\left((\\mu_{AB} - \\mu_C)t\\right) = \\exp\\left(\\left(-0.005 - \\frac{\\ln 2}{24}\\right) \\cdot 72\\right)$$\n$$W_{AB, \\text{obs}} = \\exp\\left(-0.005 \\cdot 72 - \\frac{\\ln 2}{24} \\cdot 72\\right) = \\exp(-0.36 - 3\\ln 2) = \\exp(-0.36) \\exp(-\\ln 8) = \\frac{\\exp(-0.36)}{8}$$\n\nThe Bliss independence model posits that the expected viability of the combination is the product of the individual viabilities:\n$$W_{AB, \\text{exp}} = W_A \\cdot W_B = \\left(\\frac{\\exp(1.08)}{8}\\right) \\cdot \\left(\\frac{\\exp(1.44)}{8}\\right) = \\frac{\\exp(1.08 + 1.44)}{64} = \\frac{\\exp(2.52)}{64}$$\n\nThe Bliss synergy score, $S_{\\text{Bliss}}$, is the deviation of the observed viability from the expected viability. The problem states that for synthetic lethality (a form of synergy), this deviation must be negative. Synergy implies the observed effect (cell killing or growth inhibition) is stronger than expected, which means the observed viability is lower than the expected viability ($W_{AB, \\text{obs}}  W_{AB, \\text{exp}}$). Therefore, the score must be defined as:\n$$S_{\\text{Bliss}} = W_{AB, \\text{obs}} - W_{AB, \\text{exp}}$$\nSubstituting the expressions we derived:\n$$S_{\\text{Bliss}} = \\frac{\\exp(-0.36)}{8} - \\frac{\\exp(2.52)}{64}$$\n\nNow, we compute the numerical value.\n$W_{AB, \\text{obs}} = \\frac{\\exp(-0.36)}{8} \\approx \\frac{0.6976763}{8} \\approx 0.0872095$\n$W_{AB, \\text{exp}} = \\frac{\\exp(2.52)}{64} \\approx \\frac{12.427179}{64} \\approx 0.1941747$\n$$S_{\\text{Bliss}} \\approx 0.0872095 - 0.1941747 \\approx -0.1069652$$\nRounding to four significant figures, the Bliss synergy score is $-0.1070$.\n\nAs a component of the reasoning process, we assess the criteria for synthetic lethality.\n(i) Non-lethal single agents: Check if $W_A  0.2$ and $W_B  0.2$.\n$W_A = \\frac{\\exp(1.08)}{8} \\approx \\frac{2.94468}{8} \\approx 0.3681$. Since $0.3681  0.2$, this is met.\n$W_B = \\frac{\\exp(1.44)}{8} \\approx \\frac{4.22070}{8} \\approx 0.5276$. Since $0.5276  0.2$, this is met.\nCondition (i) is satisfied.\n\n(ii) Lethal combination: Check if $W_{AB}  0.1$.\n$W_{AB, \\text{obs}} \\approx 0.0872$. Since $0.0872  0.1$, condition (ii) is satisfied.\n\n(iii) Synergistic interaction: Check if the Bliss deviation is strictly negative.\n$S_{\\text{Bliss}} \\approx -0.1070$. Since $-0.1070  0$, condition (iii) is satisfied.\n\nAll three criteria are met, so the combination qualifies as synthetically lethal under the provided operational definition. The final answer is the Bliss synergy score itself.", "answer": "$$\\boxed{-0.1070}$$", "id": "4354444"}, {"introduction": "High-throughput genetic screens generate vast amounts of data on cell viability following gene knockouts, and distinguishing true synthetic lethal interactions from random noise requires a robust statistical approach. This practice will guide you through the analysis of genetic interaction data using a linear model, the standard method in the field. You will learn to test for a statistically significant interaction term that serves as the quantitative signature of synthetic lethality [@problem_id:4354529].", "problem": "You are given replicate viability measurements across four genotypes for two genes, denoted by binary indicators $a \\in \\{0,1\\}$ and $b \\in \\{0,1\\}$. The genotype $(a,b) = (0,0)$ is wild-type, $(1,0)$ carries a loss-of-function in gene $A$, $(0,1)$ carries a loss-of-function in gene $B$, and $(1,1)$ carries loss-of-function in both $A$ and $B$. Viability is measured as a unitless fraction in the open interval $(0,1]$, with higher values indicating greater survival. Define the essentiality of a genotype replicate as $E = -\\log(v)$, where $v$ is the measured viability. Under independence of effects on survival, viability for the double mutant is multiplicative relative to single mutants and the wild-type, yielding an additive expectation on essentiality after a logarithmic transformation. Synthetic lethality is present if the double mutant essentiality exceeds the additive expectation by a statistically significant positive interaction term.\n\nYour task is to implement the following procedure for each test case:\n- For each set of replicate viability measurements per genotype, compute essentialities $E = -\\log(v)$.\n- Compute differences in essentiality across genotypes, including the main effects and the excess double-mutant essentiality beyond additivity, using group means.\n- Fit a linear model to essentiality at the replicate level with terms for an intercept, the main effects of $a$ and $b$, and their interaction $ab$. Use Ordinary Least Squares (OLS) with the standard assumptions of linear models: $E[\\varepsilon] = 0$, $\\operatorname{Var}(\\varepsilon) = \\sigma^2$, and independent, identically distributed errors.\n- Test whether the interaction coefficient is strictly greater than $0$ using a one-sided $t$-test at significance level $\\alpha = 0.05$. Let the null hypothesis be $H_0: \\beta_{AB} = 0$ and the alternative $H_1: \\beta_{AB}  0$. Decide synthetic lethality as true if the estimated interaction term is positive and the one-sided $p$-value is less than or equal to $\\alpha$.\n\nThere are no physical units in this problem. All viability values are decimals and must be treated as fractions in $(0,1]$. Angles are not used. Percentages are not used.\n\nUse the following test suite of replicate viability values (each element is a replicate). For each test case, the order of the four lists is wild-type $(a=0,b=0)$, single mutant $A$ $(a=1,b=0)$, single mutant $B$ $(a=0,b=1)$, double mutant $AB$ $(a=1,b=1)$:\n- Test case $1$ (strong synthetic lethality expectation):\n  $[0.92, 0.90, 0.91, 0.89, 0.93, 0.90]$,\n  $[0.81, 0.79, 0.80, 0.82, 0.78, 0.80]$,\n  $[0.86, 0.84, 0.85, 0.83, 0.86, 0.85]$,\n  $[0.35, 0.32, 0.34, 0.31, 0.33, 0.34]$.\n- Test case $2$ (approximately additive, no interaction):\n  $[0.91, 0.90, 0.92, 0.89, 0.91, 0.90]$,\n  $[0.80, 0.81, 0.79, 0.80, 0.82, 0.78]$,\n  $[0.85, 0.84, 0.86, 0.85, 0.83, 0.85]$,\n  $[0.74, 0.75, 0.76, 0.73, 0.75, 0.74]$.\n- Test case $3$ (slight positive interaction with higher variance; borderline significance):\n  $[0.90, 0.85, 0.95, 0.88, 0.92]$,\n  $[0.80, 0.75, 0.85, 0.78, 0.82]$,\n  $[0.86, 0.80, 0.90, 0.83, 0.87]$,\n  $[0.70, 0.76, 0.72, 0.68, 0.79]$.\n- Test case $4$ (antagonistic interaction; less lethal together):\n  $[0.91, 0.90, 0.92, 0.89, 0.91, 0.90]$,\n  $[0.82, 0.81, 0.83, 0.80, 0.82, 0.81]$,\n  $[0.86, 0.85, 0.87, 0.84, 0.86, 0.85]$,\n  $[0.82, 0.81, 0.83, 0.80, 0.82, 0.82]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a boolean indicating whether synthetic lethality is detected for the corresponding test case in order $1$ through $4$. For example, output of the form $[r_1, r_2, r_3, r_4]$ with each $r_i \\in \\{\\text{True}, \\text{False}\\}$.", "solution": "The problem requires the implementation of a statistical procedure to detect synthetic lethality between two genes, A and B, from replicate viability measurements. The core principle is to model genetic interactions within a linear model framework and test for a significant, positive interaction term, which is the quantitative signature of synthetic lethality.\n\nFirst, the raw viability measurements, $v$, are transformed into essentiality scores, $E$, via the logarithmic transformation $E = -\\log(v)$. This transformation is crucial because it converts the null hypothesis of independent multiplicative effects on viability into an additive model for essentiality. A deviation from this additivity, specifically a greater-than-expected essentiality in the double mutant, indicates a synthetic lethal interaction.\n\nThe experiment corresponds to a $2 \\times 2$ factorial design, with factors being the functional status of gene A (indicator $a \\in \\{0,1\\}$) and gene B (indicator $b \\in \\{0,1\\}$). The essentiality $E$ of any replicate is modeled by the linear equation:\n$$E = \\beta_0 + \\beta_A a + \\beta_B b + \\beta_{AB} ab + \\varepsilon$$\nwhere $\\beta_0$ is the intercept (wild-type essentiality), $\\beta_A$ and $\\beta_B$ are the main effects of mutations in gene A and B, respectively, $\\beta_{AB}$ is the interaction term, and $\\varepsilon$ is a random error term assumed to be normally distributed with mean $0$ and constant variance $\\sigma^2$.\n\nUnder this model, the mean essentialities for the four genotypes are:\n- Wild-type $(a=0, b=0)$: $\\mu_{00} = \\beta_0$\n- Single mutant A $(a=1, b=0)$: $\\mu_{10} = \\beta_0 + \\beta_A$\n- Single mutant B $(a=0, b=1)$: $\\mu_{01} = \\beta_0 + \\beta_B$\n- Double mutant AB $(a=1, b=1)$: $\\mu_{11} = \\beta_0 + \\beta_A + \\beta_B + \\beta_{AB}$\n\nThe Ordinary Least Squares (OLS) estimates for these parameters can be derived from the sample means of essentiality for each genotype group, denoted $\\bar{E}_{00}, \\bar{E}_{10}, \\bar{E}_{01}, \\bar{E}_{11}$:\n- $\\hat{\\beta}_0 = \\bar{E}_{00}$\n- $\\hat{\\beta}_A = \\bar{E}_{10} - \\bar{E}_{00}$\n- $\\hat{\\beta}_B = \\bar{E}_{01} - \\bar{E}_{00}$\n- $\\hat{\\beta}_{AB} = \\bar{E}_{11} - (\\bar{E}_{10} - \\bar{E}_{00}) - (\\bar{E}_{01} - \\bar{E}_{00}) - \\bar{E}_{00} = \\bar{E}_{11} - \\bar{E}_{10} - \\bar{E}_{01} + \\bar{E}_{00}$\n\nThe interaction term $\\beta_{AB}$ quantifies the deviation from additivity. A positive $\\beta_{AB}$ means the essentiality of the double mutant is greater than the sum of the individual effects, which defines synthetic lethality. We test this formally using a one-sided $t$-test with the null hypothesis $H_0: \\beta_{AB} = 0$ (additivity) and the alternative hypothesis $H_1: \\beta_{AB}  0$ (synthetic lethality).\n\nThe $t$-statistic is calculated as:\n$$t = \\frac{\\hat{\\beta}_{AB}}{\\text{SE}(\\hat{\\beta}_{AB})}$$\nThe standard error of the interaction coefficient estimate, $\\text{SE}(\\hat{\\beta}_{AB})$, is derived from the variance of the linear combination of sample means:\n$$\\text{SE}(\\hat{\\beta}_{AB}) = \\sqrt{\\text{Var}(\\bar{E}_{11} - \\bar{E}_{10} - \\bar{E}_{01} + \\bar{E}_{00})}$$\nAssuming independent samples and homoscedasticity (constant variance $\\sigma^2$ across groups), this becomes:\n$$\\text{SE}(\\hat{\\beta}_{AB}) = \\sqrt{\\sigma^2 \\left( \\frac{1}{n_{00}} + \\frac{1}{n_{10}} + \\frac{1}{n_{01}} + \\frac{1}{n_{11}} \\right)}$$\nwhere $n_{ij}$ is the number of replicates for genotype $(i,j)$. The unknown population variance $\\sigma^2$ is estimated using the pooled variance from all four groups, which is the Mean Squared Error (MSE) from the model:\n$$\\hat{\\sigma}^2 = \\frac{\\sum_{i,j} \\sum_{k=1}^{n_{ij}} (E_{ijk} - \\bar{E}_{ij})^2}{n - p}$$\nHere, $E_{ijk}$ is the essentiality of the $k$-th replicate of genotype $(i,j)$, $n$ is the total number of replicates ($n = n_{00} + n_{10} + n_{01} + n_{11}$), and $p=4$ is the number of parameters in the model. The denominator $n-p$ represents the degrees of freedom ($df$) for the $t$-test.\n\nAfter calculating the $t$-statistic, we determine the one-sided $p$-value, which is the probability of observing a value as extreme or more extreme than our statistic, assuming the null hypothesis is true: $p = P(T_{df}  t)$, where $T_{df}$ is a random variable following a $t$-distribution with $df$ degrees of freedom.\n\nThe final decision rule is applied: synthetic lethality is determined to be present if the estimated interaction term is positive ($\\hat{\\beta}_{AB}  0$) and the $p$-value is less than or equal to the specified significance level, $\\alpha = 0.05$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Main function to process test cases for synthetic lethality detection.\n    \"\"\"\n    # Test suite of replicate viability values.\n    # Order: wild-type (0,0), single mutant A (1,0),\n    # single mutant B (0,1), double mutant AB (1,1).\n    test_cases = [\n        # Test case 1 (strong synthetic lethality expectation)\n        (\n            [0.92, 0.90, 0.91, 0.89, 0.93, 0.90],\n            [0.81, 0.79, 0.80, 0.82, 0.78, 0.80],\n            [0.86, 0.84, 0.85, 0.83, 0.86, 0.85],\n            [0.35, 0.32, 0.34, 0.31, 0.33, 0.34],\n        ),\n        # Test case 2 (approximately additive, no interaction)\n        (\n            [0.91, 0.90, 0.92, 0.89, 0.91, 0.90],\n            [0.80, 0.81, 0.79, 0.80, 0.82, 0.78],\n            [0.85, 0.84, 0.86, 0.85, 0.83, 0.85],\n            [0.74, 0.75, 0.76, 0.73, 0.75, 0.74],\n        ),\n        # Test case 3 (slight positive interaction with higher variance; borderline significance)\n        (\n            [0.90, 0.85, 0.95, 0.88, 0.92],\n            [0.80, 0.75, 0.85, 0.78, 0.82],\n            [0.86, 0.80, 0.90, 0.83, 0.87],\n            [0.70, 0.76, 0.72, 0.68, 0.79],\n        ),\n        # Test case 4 (antagonistic interaction; less lethal together)\n        (\n            [0.91, 0.90, 0.92, 0.89, 0.91, 0.90],\n            [0.82, 0.81, 0.83, 0.80, 0.82, 0.81],\n            [0.86, 0.85, 0.87, 0.84, 0.86, 0.85],\n            [0.82, 0.81, 0.83, 0.80, 0.82, 0.82],\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        v_00, v_10, v_01, v_11 = case\n        result = is_synthetic_lethal(v_00, v_10, v_01, v_11)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef is_synthetic_lethal(v_00, v_10, v_01, v_11, alpha=0.05):\n    \"\"\"\n    Tests for synthetic lethality based on viability measurements.\n\n    Args:\n        v_00: Replicate viabilities for wild-type (a=0, b=0).\n        v_10: Replicate viabilities for single mutant A (a=1, b=0).\n        v_01: Replicate viabilities for single mutant B (a=0, b=1).\n        v_11: Replicate viabilities for double mutant AB (a=1, b=1).\n        alpha: Significance level for the hypothesis test.\n\n    Returns:\n        A boolean indicating if synthetic lethality is detected.\n    \"\"\"\n    # Step 1: Compute essentialities E = -log(v)\n    e_00 = -np.log(np.array(v_00))\n    e_10 = -np.log(np.array(v_10))\n    e_01 = -np.log(np.array(v_01))\n    e_11 = -np.log(np.array(v_11))\n\n    # Get group sizes\n    n_00, n_10, n_01, n_11 = len(e_00), len(e_10), len(e_01), len(e_11)\n    n_total = n_00 + n_10 + n_01 + n_11\n\n    # Step 2: Compute mean essentialities\n    mean_e_00 = np.mean(e_00)\n    mean_e_10 = np.mean(e_10)\n    mean_e_01 = np.mean(e_01)\n    mean_e_11 = np.mean(e_11)\n\n    # Step 3: Compute interaction coefficient estimate\n    hat_beta_ab = mean_e_11 - mean_e_10 - mean_e_01 + mean_e_00\n\n    # Step 4: Compute pooled variance (Mean Squared Error)\n    ss_00 = np.sum((e_00 - mean_e_00)**2)\n    ss_10 = np.sum((e_10 - mean_e_10)**2)\n    ss_01 = np.sum((e_01 - mean_e_01)**2)\n    ss_11 = np.sum((e_11 - mean_e_11)**2)\n    \n    ssr = ss_00 + ss_10 + ss_01 + ss_11\n    \n    num_params = 4\n    df = n_total - num_params\n    \n    if df = 0:\n        # Not enough data to estimate variance\n        return False\n        \n    pooled_variance = ssr / df\n\n    # Step 5: Compute standard error of the interaction coefficient\n    var_sum_term = (1/n_00) + (1/n_10) + (1/n_01) + (1/n_11)\n    se_hat_beta_ab = np.sqrt(pooled_variance * var_sum_term)\n\n    # Step 6: Compute t-statistic\n    if se_hat_beta_ab == 0:\n        # If SE is zero, a positive coefficient implies infinite evidence.\n        t_stat = np.inf if hat_beta_ab > 0 else 0\n    else:\n        t_stat = hat_beta_ab / se_hat_beta_ab\n\n    # Step 7  8: Compute one-sided p-value from t-distribution survival function\n    p_value = t.sf(t_stat, df)\n\n    # Step 9: Make decision\n    # Synthetic lethality requires a positive interaction term AND\n    # statistical significance.\n    is_lethal = (hat_beta_ab > 0) and (p_value = alpha)\n    \n    return is_lethal\n\nsolve()\n\n```", "id": "4354529"}, {"introduction": "Beyond analyzing experimental data, systems biology offers powerful tools to predict genetic interactions *in silico* using computational models. This exercise introduces Flux Balance Analysis (FBA), a constraint-based method to simulate metabolic function. You will identify synthetic lethal pairs by systematically knocking out reactions in a model network and observing the impact on biomass production, thereby learning how network topology and redundancy give rise to synthetic lethal relationships [@problem_id:4354454].", "problem": "You are given the task of identifying synthetic lethal reaction pairs in small metabolic networks using steady-state constraint-based modeling. The starting point is the fundamental steady-state mass balance for intracellular metabolites represented by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ and a flux vector $v \\in \\mathbb{R}^{n}$, constrained by the linear system\n$$\nS v = 0,\n$$\nwith flux bounds\n$$\n\\ell \\le v \\le u,\n$$\nwhere $\\ell, u \\in \\mathbb{R}^{n}$ are the lower and upper bounds, respectively. The biomass production is modeled by a linear objective function $\\max \\; c^{\\top} v$, where $c \\in \\mathbb{R}^{n}$ is zero everywhere except for the biomass drain reaction(s). Viability is defined by the existence of a feasible steady state with maximal objective value strictly greater than a threshold $\\tau$, where $\\tau$ is a small positive scalar.\n\nA synthetic lethal reaction pair is defined here as an unordered pair of distinct reactions $\\{i,j\\}$ satisfying the following four conditions:\n1. The wild-type (no deletions) maximal objective value is strictly greater than $\\tau$.\n2. The maximal objective value after deletion of reaction $i$ alone is strictly greater than $\\tau$.\n3. The maximal objective value after deletion of reaction $j$ alone is strictly greater than $\\tau$.\n4. The maximal objective value after simultaneous deletion of reactions $i$ and $j$ is less than or equal to $\\tau$ (including infeasibility).\n\nA deletion of reaction $k$ is implemented by enforcing $v_k = 0$.\n\nFor all computations, use the following threshold $\\tau$: $\\tau = 10^{-6}$. All linear programs should be solved as exact maximization of $c^{\\top} v$ subject to $S v = 0$ and $\\ell \\le v \\le u$. If a linear program is infeasible, treat its maximal objective as $0$.\n\nYou must implement a program that, for each test case below, enumerates all unordered reaction index pairs $\\{i,j\\}$ with $0 \\le i lt; j \\le n-1$ that satisfy the synthetic lethality definition above. Use zero-based indexing for reactions. Report each pair as a two-element list $[i,j]$. For each test case, return a list of such pairs, sorted in lexicographic order. The final output must aggregate the lists for all provided test cases in order, producing a single line that is a list containing one element per test case.\n\nTest Suite:\nEach test case provides $(S, \\ell, u, c)$ explicitly.\n\nTest case $1$ (redundant parallel routes to biomass):\n- Metabolites (rows of $S$): $[A, B, C, BM]$.\n- Reactions (columns of $S$): $0:$ uptake $\\rightarrow A$, $1:$ $A \\rightarrow B$, $2:$ $A \\rightarrow C$, $3:$ $B \\rightarrow BM$, $4:$ $C \\rightarrow BM$, $5:$ $BM \\rightarrow$ drain.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{4 \\times 6}$:\n$$\nS = \\begin{bmatrix}\n1  -1  -1  0  0  0 \\\\\n0  1  0  -1  0  0 \\\\\n0  0  1  0  -1  0 \\\\\n0  0  0  1  1  -1\n\\end{bmatrix}.\n$$\n- Bounds $\\ell, u \\in \\mathbb{R}^{6}$:\n$$\n\\ell = [0, 0, 0, 0, 0, 0], \\quad u = [10, 1000, 1000, 1000, 1000, 1000].\n$$\n- Objective vector $c \\in \\mathbb{R}^{6}$:\n$$\nc = [0, 0, 0, 0, 0, 1].\n$$\n\nTest case $2$ (single essential linear pathway, no synthetic lethality expected):\n- Metabolites (rows of $S$): $[A, D, BM]$.\n- Reactions (columns of $S$): $0:$ uptake $\\rightarrow A$, $1:$ $A \\rightarrow D$, $2:$ $D \\rightarrow BM$, $3:$ $BM \\rightarrow$ drain.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{3 \\times 4}$:\n$$\nS = \\begin{bmatrix}\n1  -1  0  0 \\\\\n0  1  -1  0 \\\\\n0  0  1  -1\n\\end{bmatrix}.\n$$\n- Bounds $\\ell, u \\in \\mathbb{R}^{4}$:\n$$\n\\ell = [0, 0, 0, 0], \\quad u = [10, 1000, 1000, 1000].\n$$\n- Objective vector $c \\in \\mathbb{R}^{4}$:\n$$\nc = [0, 0, 0, 1].\n$$\n\nTest case $3$ (reversible interconversion supporting rerouting):\n- Metabolites (rows of $S$): $[A, B, C, BM]$.\n- Reactions (columns of $S$): $0:$ uptake $\\rightarrow A$, $1:$ $A \\rightarrow B$, $2:$ $B \\leftrightarrow C$ (reversible), $3:$ $B \\rightarrow BM$, $4:$ $C \\rightarrow BM$, $5:$ $BM \\rightarrow$ drain.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{4 \\times 6}$:\n$$\nS = \\begin{bmatrix}\n1  -1  0  0  0  0 \\\\\n0  1  -1  -1  0  0 \\\\\n0  0  1  0  -1  0 \\\\\n0  0  0  1  1  -1\n\\end{bmatrix}.\n$$\n- Bounds $\\ell, u \\in \\mathbb{R}^{6}$:\n$$\n\\ell = [0, 0, -1000, 0, 0, 0], \\quad u = [10, 1000, 1000, 1000, 1000, 1000].\n$$\n- Objective vector $c \\in \\mathbb{R}^{6}$:\n$$\nc = [0, 0, 0, 0, 0, 1].\n$$\n\nYour program must:\n- Solve the linear program for each test case to compute the maximal objective.\n- Determine all synthetic lethal pairs per the definition, using $\\tau = 10^{-6}$.\n- Produce a single line of output containing the lists for all test cases as a comma-separated list enclosed in square brackets, with no spaces. For example, a valid output format is $[[[i_1,j_1],[i_2,j_2]],[],[[k_1,\\ell_1]]]$.\n\nThe final answer must be a complete, runnable program as specified. No physical units, angles, or percentages are involved in this problem. All numerical values are given explicitly above without units, and all outputs are lists of integers.", "solution": "The problem is assessed to be **valid**. It is scientifically grounded in the well-established field of constraint-based modeling of metabolic networks, specifically Flux Balance Analysis (FBA). The problem is well-posed, providing a clear, formal definition of synthetic lethality and all necessary parameters ($S, \\ell, u, c, \\tau$) to solve for it. The definitions are mathematically precise and objective, with no ambiguities, contradictions, or reliance on non-scientific premises.\n\nThe core of this problem is to identify synthetic lethal reaction pairs by systematically simulating the effect of single and double reaction deletions on a metabolic network's ability to produce biomass. This is achieved using Flux Balance Analysis (FBA), a mathematical approach for analyzing metabolic fluxes at steady-state.\n\nThe metabolic network is described by the steady-state mass balance equation:\n$$\nS v = 0\n$$\nwhere $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix for $m$ metabolites and $n$ reactions, and $v \\in \\mathbb{R}^{n}$ is the vector of reaction fluxes. The fluxes are further constrained by lower and upper bounds:\n$$\n\\ell \\le v \\le u\n$$\nThe cellular objective, typically biomass production, is assumed to be a linear combination of fluxes, which we seek to maximize:\n$$\n\\max \\quad c^{\\top} v\n$$\nwhere the vector $c \\in \\mathbb{R}^{n}$ defines the objective function. This formulation constitutes a Linear Program (LP).\n\nA reaction $k$ is deleted (or \"knocked out\") by setting its corresponding flux $v_k$ to zero. This is implemented by modifying its bounds such that $\\ell_k = u_k = 0$.\n\nThe problem defines a synthetic lethal pair $\\{i, j\\}$ based on four conditions related to network viability. Viability is determined by comparing the maximal objective value (biomass production) against a small positive threshold, $\\tau = 10^{-6}$. Let $Z(\\mathcal{K})$ denote the maximal objective value for a network where the set of reactions $\\mathcal{K}$ has been deleted.\nThe conditions for a pair $\\{i, j\\}$ to be synthetic lethal are:\n1.  Wild-type viability: $Z(\\emptyset)  \\tau$\n2.  Single-mutant $i$ viability: $Z(\\{i\\})  \\tau$\n3.  Single-mutant $j$ viability: $Z(\\{j\\})  \\tau$\n4.  Double-mutant lethality: $Z(\\{i, j\\}) \\le \\tau$\n\nTo solve this, a systematic computational procedure is followed for each test case:\n\nFirst, we require a function to solve the FBA problem for a given set of parameters. Standard LP solvers are typically designed for minimization problems of the form $\\min a^{\\top}x$. To solve our maximization problem $\\max c^{\\top}v$, we can equivalently solve $\\min (-c)^{\\top}v$. The optimal value of the maximization is then the negative of the result from the minimization. If the LP is infeasible, the problem states to treat the maximal objective as $0$.\n\nThe algorithm for identifying synthetic lethal pairs is as follows:\n\n1.  **Solve for Wild-Type (WT) Growth**: An LP is solved using the original, unmodified bounds $\\ell$ and $u$. Let the result be $Z_{WT} = Z(\\emptyset)$. If $Z_{WT} \\le \\tau$, the wild-type network is non-viable. According to condition $1$, no synthetic lethal pairs can exist, so the process terminates for this test case, yielding an empty list.\n\n2.  **Evaluate Single Deletions**: For each reaction $k \\in \\{0, 1, \\dots, n-1\\}$, a single-deletion LP is solved. A temporary set of bounds $(\\ell', u')$ is created where $\\ell'_k = u'_k = 0$, and the maximal objective $Z_k = Z(\\{k\\})$ is computed.\n\n3.  **Identify Non-Essential Reactions**: A reaction $k$ is non-essential if its deletion does not render the network non-viable, i.e., $Z_k  \\tau$. Conditions $2$ and $3$ of the synthetic lethality definition require that both reactions in a synthetic lethal pair must be non-essential. We therefore compile a list of all non-essential reaction indices.\n\n4.  **Evaluate Double Deletions**: We iterate through all unique unordered pairs $\\{i, j\\}$ of non-essential reactions, ensuring $i  j$ to maintain lexicographical order and avoid redundant computations. For each pair, a double-deletion LP is solved by setting the bounds for both reaction $i$ and $j$ to zero ($\\ell'_i = u'_i = 0$ and $\\ell'_j = u'_j = 0$).\n\n5.  **Classify Synthetic Lethal Pairs**: Let the result of the double-deletion LP for the pair $\\{i, j\\}$ be $Z_{ij} = Z(\\{i, j\\})$. If $Z_{ij} \\le \\tau$, this satisfies condition $4$. Since conditions $1$, $2$, and $3$ are already satisfied by the preceding steps, the pair $\\{i, j\\}$ is classified as synthetic lethal and added to our results list.\n\nThis procedure exhaustively checks all valid candidate pairs against the four criteria, ensuring a correct and complete enumeration of synthetic lethal pairs for each provided metabolic network model. The final implementation will utilize `numpy` for efficient array and matrix operations, and `scipy.optimize.linprog` to solve the required linear programs.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    Identifies synthetic lethal reaction pairs in metabolic networks using FBA.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([\n                [1, -1, -1, 0, 0, 0],\n                [0, 1, 0, -1, 0, 0],\n                [0, 0, 1, 0, -1, 0],\n                [0, 0, 0, 1, 1, -1]\n            ]),\n            np.array([0, 0, 0, 0, 0, 0], dtype=float),\n            np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float),\n            np.array([0, 0, 0, 0, 0, 1], dtype=float)\n        ),\n        # Test case 2\n        (\n            np.array([\n                [1, -1, 0, 0],\n                [0, 1, -1, 0],\n                [0, 0, 1, -1]\n            ]),\n            np.array([0, 0, 0, 0], dtype=float),\n            np.array([10, 1000, 1000, 1000], dtype=float),\n            np.array([0, 0, 0, 1], dtype=float)\n        ),\n        # Test case 3\n        (\n            np.array([\n                [1, -1, 0, 0, 0, 0],\n                [0, 1, -1, -1, 0, 0],\n                [0, 0, 1, 0, -1, 0],\n                [0, 0, 0, 1, 1, -1]\n            ]),\n            np.array([0, 0, -1000, 0, 0, 0], dtype=float),\n            np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float),\n            np.array([0, 0, 0, 0, 0, 1], dtype=float)\n        )\n    ]\n    \n    tau = 1e-6\n    all_results = []\n\n    for S, l, u, c in test_cases:\n        sl_pairs = find_synthetic_lethal_pairs(S, l, u, c, tau)\n        all_results.append(sl_pairs)\n\n    # Format output to be a single string without spaces.\n    results_as_strings = []\n    for res in all_results:\n        # Convert list to string and remove spaces\n        res_str = str(res).replace(\" \", \"\")\n        results_as_strings.append(res_str)\n\n    print(f\"[{','.join(results_as_strings)}]\")\n\ndef solve_fba(c_obj, S, l_bounds, u_bounds):\n    \"\"\"\n    Solves the FBA linear program: max c'v s.t. Sv=0, l = v = u.\n    Returns the maximal objective value. Treats infeasible cases as 0.\n    \"\"\"\n    m, n = S.shape\n    b_eq = np.zeros(m)\n    bounds = list(zip(l_bounds, u_bounds))\n\n    # linprog minimizes, so we minimize -c'v to maximize c'v\n    res = linprog(-c_obj, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if res.success:\n        # Return the maximum value (negate the minimized value)\n        return -res.fun\n    else:\n        # Per problem spec, treat infeasible or failed optimization as 0 growth.\n        return 0.0\n\ndef find_synthetic_lethal_pairs(S, l, u, c, tau):\n    \"\"\"\n    Finds all synthetic lethal reaction pairs for a given metabolic model.\n    \"\"\"\n    n_reactions = S.shape[1]\n\n    # 1. Check wild-type viability\n    wt_growth = solve_fba(c, S, l, u)\n    if wt_growth = tau:\n        return []\n\n    # 2. Evaluate all single knockouts\n    single_ko_growths = []\n    for i in range(n_reactions):\n        l_ko = np.copy(l)\n        u_ko = np.copy(u)\n        l_ko[i], u_ko[i] = 0.0, 0.0\n        growth = solve_fba(c, S, l_ko, u_ko)\n        single_ko_growths.append(growth)\n\n    # 3. Identify non-essential reactions (Conditions 2  3)\n    non_essential_indices = [\n        i for i, g in enumerate(single_ko_growths) if g  tau\n    ]\n\n    # 4. Evaluate double knockouts of non-essential reactions\n    sl_pairs = []\n    for i_idx, i in enumerate(non_essential_indices):\n        for j in non_essential_indices[i_idx + 1:]:\n            # Pair is (i, j) with i  j, ensuring lexicographical order and uniqueness\n            l_dko = np.copy(l)\n            u_dko = np.copy(u)\n            l_dko[i], u_dko[i] = 0.0, 0.0\n            l_dko[j], u_dko[j] = 0.0, 0.0\n            \n            dko_growth = solve_fba(c, S, l_dko, u_dko)\n            \n            # 5. Check for synthetic lethality (Condition 4)\n            if dko_growth = tau:\n                sl_pairs.append([i, j])\n                \n    return sl_pairs\n\nif __name__ == '__main__':\n    solve()\n```", "id": "4354454"}]}