{"hands_on_practices": [{"introduction": "To begin our exploration of network control, we start with the foundational principles of linear time-invariant (LTI) systems. This state-space approach is highly effective for analyzing the local behavior of biological systems around a steady state, where dynamics can be accurately linearized. This first exercise provides direct practice with the Kalman rank condition, a cornerstone of control theory, allowing you to determine if a small gene module can be fully steered by an external input [@problem_id:4364519].", "problem": "A two-gene signaling module in a cellular pathway is linearized around a homeostatic equilibrium to study small-signal regulation by an external control input representing a drug infusion. The linearized state-space model is a Single-Input Linear Time-Invariant (LTI) system given by $\\dot{x}(t)=A x(t)+B u(t)$, where $x(t)\\in\\mathbb{R}^{2}$ are deviations of gene activities from steady state and $u(t)\\in\\mathbb{R}$ is the control input. The matrices are\n$$\nA=\\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\nUsing only foundational definitions of controllability for Linear Time-Invariant systems, compute the rank of the controllability matrix associated with $\\left(A,B\\right)$ and conclude whether the linearized gene module is controllable in the small-signal sense about the equilibrium. Report your final answer as the rank of the controllability matrix $\\operatorname{rank}\\mathcal{C}$ as a single integer with no units. No rounding is required.", "solution": "The problem asks for an assessment of the controllability of a linearized two-gene signaling module described by a Linear Time-Invariant (LTI) state-space model. The model is given by the equation $\\dot{x}(t)=A x(t)+B u(t)$, where the state dimension is $n=2$. The provided matrices are:\n$$\nA=\\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\n$$\nThe controllability of an LTI system is determined by the rank of its controllability matrix, denoted as $\\mathcal{C}$. For a system of dimension $n$, the controllability matrix is constructed as:\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB  A^2B  \\cdots  A^{n-1}B \\end{bmatrix}\n$$\nThe system is controllable if and only if the controllability matrix $\\mathcal{C}$ has full rank, which means $\\operatorname{rank}(\\mathcal{C}) = n$. This is known as the Kalman rank condition for controllability.\n\nFor the given system, the state dimension is $n=2$. Therefore, the controllability matrix is given by:\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB \\end{bmatrix}\n$$\nThe first column of $\\mathcal{C}$ is the input matrix $B$ itself:\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\nThe second column of $\\mathcal{C}$ is the product of the state matrix $A$ and the input matrix $B$. We compute this product:\n$$\nAB = \\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}\n$$\nNow, we can construct the controllability matrix $\\mathcal{C}$ by concatenating the column vectors $B$ and $AB$:\n$$\n\\mathcal{C} = \\begin{bmatrix} 0  1 \\\\ 1  -3 \\end{bmatrix}\n$$\nTo determine the rank of the $2 \\times 2$ matrix $\\mathcal{C}$, we can compute its determinant. A square matrix has full rank if and only if its determinant is non-zero.\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = 0 - 1 = -1\n$$\nSince $\\det(\\mathcal{C}) = -1 \\neq 0$, the columns of the matrix $\\mathcal{C}$ are linearly independent. For a $2 \\times 2$ matrix, this means it has a rank of $2$.\n$$\n\\operatorname{rank}(\\mathcal{C}) = 2\n$$\nAccording to the Kalman rank condition, the system is controllable if $\\operatorname{rank}(\\mathcal{C})$ is equal to the dimension of the state space, $n$. In this case, we have found that $\\operatorname{rank}(\\mathcal{C}) = 2$, and the state dimension is $n=2$. Since $\\operatorname{rank}(\\mathcal{C}) = n$, the system is completely controllable. This implies that it is possible to steer the state of the linearized gene module from any initial state to any desired final state in finite time using an appropriate control input $u(t)$.\n\nThe problem asks for the rank of the controllability matrix, which we have computed to be $2$.", "answer": "$$\\boxed{2}$$", "id": "4364519"}, {"introduction": "While state-space analysis is powerful, biological networks are often large and their kinetic parameters are difficult to measure precisely, making a purely structural approach essential. Structural controllability theory enables us to identify the minimum number of \"driver nodes\" required to control a network based solely on its wiring diagram. This practice will guide you through applying a key graph-theoretic tool—maximum matching—to pinpoint these critical control points within a model signaling network [@problem_id:4364459].", "problem": "A signaling network in systems biomedicine is linearized around a steady operating point, so that its dynamics can be represented by a linear time-invariant (LTI) system with state matrix sparsity encoded by a directed graph on seven nodes labeled $1$ through $7$. An edge $i \\to j$ denotes that the state of node $i$ directly influences the state of node $j$ in the linearized model. The directed edges are:\n- $1 \\to 2$\n- $1 \\to 3$\n- $2 \\to 3$\n- $3 \\to 4$\n- $3 \\to 5$\n- $4 \\to 6$\n- $5 \\to 6$\n- $6 \\to 7$\n- $7 \\to 5$\n\nUsing only fundamental definitions of structural controllability of directed networks and the graph-theoretic notion of matching on the bipartite representation of a directed graph, construct a maximum matching and deduce the minimal number of driver nodes implied by the unmatched nodes. Report only the minimal number of driver nodes as a single integer with no units.", "solution": "The problem asks for the minimal number of driver nodes required to control a given directed network, based on the principles of structural controllability and graph-theoretic matching.\n\nThe fundamental principle connecting structural controllability to graph theory states that the minimum number of driver nodes, denoted as $N_D$, required for full control of a directed network with $N$ nodes is given by the equation:\n$$N_D = \\max(1, N - |M^*|)$$\nwhere $|M^*|$ is the size (cardinality) of a maximum matching in the directed graph. The driver nodes themselves are the nodes that are not targeted by any edge in the maximum matching.\n\nFirst, we must formalize the network structure as a directed graph $G = (V, E)$, where $V$ is the set of nodes and $E$ is the set of directed edges.\nFrom the problem statement, the set of nodes is $V = \\{1, 2, 3, 4, 5, 6, 7\\}$, so the total number of nodes is $N=7$.\nThe set of directed edges is $E = \\{(1, 2), (1, 3), (2, 3), (3, 4), (3, 5), (4, 6), (5, 6), (6, 7), (7, 5)\\}$.\n\nTo find a maximum matching in the directed graph $G$, we construct a corresponding bipartite graph, $G_B = (V_A \\cup V_B, E')$. This graph consists of two disjoint sets of vertices, $V_A$ and $V_B$, each being a copy of the original node set $V$. Let $V_A = \\{x_1, x_2, x_3, x_4, x_5, x_6, x_7\\}$ and $V_B = \\{y_1, y_2, y_3, y_4, y_5, y_6, y_7\\}$. For each directed edge $i \\to j$ in the original graph $G$, we add an undirected edge between vertex $x_i$ in $V_A$ and vertex $y_j$ in $V_B$.\n\nThe edges $E'$ in the bipartite graph $G_B$ are therefore:\n\\begin{itemize}\n    \\item $(x_1, y_2)$ from the edge $1 \\to 2$\n    \\item $(x_1, y_3)$ from the edge $1 \\to 3$\n    \\item $(x_2, y_3)$ from the edge $2 \\to 3$\n    \\item $(x_3, y_4)$ from the edge $3 \\to 4$\n    \\item $(x_3, y_5)$ from the edge $3 \\to 5$\n    \\item $(x_4, y_6)$ from the edge $4 \\to 6$\n    \\item $(x_5, y_6)$ from the edge $5 \\to 6$\n    \\item $(x_6, y_7)$ from the edge $6 \\to 7$\n    \\item $(x_7, y_5)$ from the edge $7 \\to 5$\n\\end{itemize}\n\nA matching $M$ in $G_B$ is a subset of $E'$ such that no two edges in $M$ share a common vertex. A maximum matching $M^*$ is a matching with the largest possible number of edges. We need to find the size of such a matching, $|M^*|$.\n\nLet's analyze the structure of $G_B$. The vertex $y_1$ in the set $V_B$ has no incident edges. This is because in the original graph $G$, node $1$ has an in-degree of $0$ (no edges point to it). A vertex with no edges cannot be part of any matching. Therefore, $y_1$ must be an unmatched vertex in any matching $M$. Since a matching consists of pairs of vertices, one from $V_A$ and one from $V_B$, the maximum possible size of any matching is limited by the number of vertices that can be matched. As $y_1$ cannot be matched, the size of the maximum matching $|M^*|$ can be at most $N-1 = 7-1 = 6$.\n\nNow, we need to determine if a matching of size $6$ exists. We can construct such a matching by inspection. Let's select a set of $6$ edges from $E'$ that have no common vertices.\nConsider the following set of edges, which we will call $M_{test}$:\n\\begin{itemize}\n    \\item $(x_1, y_2)$\n    \\item $(x_2, y_3)$\n    \\item $(x_3, y_4)$\n    \\item $(x_7, y_5)$\n    \\item $(x_4, y_6)$\n    \\item $(x_6, y_7)$\n\\end{itemize}\nLet's verify if $M_{test}$ is a valid matching.\nThe vertices from $V_A$ used are $\\{x_1, x_2, x_3, x_4, x_6, x_7\\}$. All are distinct.\nThe vertices from $V_B$ used are $\\{y_2, y_3, y_4, y_5, y_6, y_7\\}$. All are distinct.\nSince no vertex is used more than once, $M_{test}$ is a valid matching. The size of this matching is $|M_{test}| = 6$.\n\nSince we have established that the maximum possible size of a matching is at most $6$, and we have found a valid matching of size $6$, we can conclude that the size of the maximum matching is $|M^*| = 6$.\n\nThe unmatched vertices in this matching are $x_5$ from $V_A$ and $y_1$ from $V_B$. The set of driver nodes corresponds to the set of unmatched vertices in $V_B$. In this case, the only unmatched vertex in $V_B$ is $y_1$, which corresponds to node $1$ in the original network. The number of such nodes is $1$.\n\nFinally, we apply the formula for the minimal number of driver nodes:\n$$N_D = \\max(1, N - |M^*|)$$\nSubstituting the values we have found:\n$$N_D = \\max(1, 7 - 6) = \\max(1, 1) = 1$$\nThe minimal number of driver nodes required to ensure structural controllability of the network is $1$.", "answer": "$$\\boxed{1}$$", "id": "4364459"}, {"introduction": "Having explored both state-space and structural viewpoints, we now examine a critical nuance where these perspectives intersect. A network may be deemed structurally observable, yet lose this property due to specific, finely-tuned values of its interaction strengths—a phenomenon known as parameter cancellation. This final exercise demonstrates how such cancellations can render a system's internal states unobservable from its output, highlighting that network topology alone does not always tell the full story [@problem_id:1451365].", "problem": "In systems biology, understanding which components of a cellular network can be inferred from measurements of other components is a fundamental problem of observability. Consider a simplified linear model of a three-protein signaling module, P1, P2, and P3, whose concentration deviations from steady state are represented by the state variables $x_1(t)$, $x_2(t)$, and $x_3(t)$, respectively.\n\nThe proteins interact in a network motif known as a coherent feed-forward loop: P1 influences both P2 and P3, and P2 also influences P3. The dynamics of the system can be described by the following system of linear ordinary differential equations:\n$$\n\\begin{aligned}\n\\dot{x}_1 = -k_1 x_1 \\\\\n\\dot{x}_2 = k_{21} x_1 - k_2 x_2 \\\\\n\\dot{x}_3 = k_{31} x_1 + k_{32} x_2 - k_3 x_3\n\\end{aligned}\n$$\nHere, $k_1, k_2, k_3$ are positive constants representing the first-order degradation or inactivation rates of P1, P2, and P3, respectively. The positive constants $k_{21}, k_{31}, k_{32}$ represent the strengths of the regulatory interactions. This can be written in state-space form as $\\dot{\\mathbf{x}} = A\\mathbf{x}$.\n\nAssume an experimental setup allows for the continuous measurement of the concentration of protein P3, such that the system output is given by $y = x_3$. For a generic choice of non-zero kinetic parameters, the system is structurally observable. However, for certain specific relationships between the parameters, a phenomenon known as parameter cancellation can occur, rendering the system unobservable.\n\nWhich of the following conditions on the kinetic parameters causes the system to become unobservable?\n\nA. $k_{31}(k_1 - k_2) = k_{32}k_{21}$\n\nB. $k_{31}(k_1 + k_2) = k_{32}k_{21}$\n\nC. $k_{21}(k_2 - k_3) = k_{31}k_{32}$\n\nD. $k_1 k_{21} + k_2 k_{32} = k_3 k_{31}$\n\nE. $k_{31} = k_{32} + k_{21}$", "solution": "We write the system in state-space form $\\dot{\\mathbf{x}} = A \\mathbf{x}$ with output $y = C \\mathbf{x}$, where\n$$\nA = \\begin{pmatrix}\n-k_{1}  0  0 \\\\\nk_{21}  -k_{2}  0 \\\\\nk_{31}  k_{32}  -k_{3}\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 0  0  1 \\end{pmatrix}.\n$$\nThe pair $(A,C)$ is observable if and only if the observability matrix has full rank. For a $3$-state SISO system, the observability matrix is\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nC A \\\\\nC A^{2}\n\\end{pmatrix}.\n$$\nWe compute each block explicitly:\n- The first block is $C = \\begin{pmatrix} 0  0  1 \\end{pmatrix}$.\n- The second block is $C A$, which equals the third row of $A$:\n$$\nC A = \\begin{pmatrix} k_{31}  k_{32}  -k_{3} \\end{pmatrix}.\n$$\n- The third block is $C A^{2} = (C A) A$, i.e., the third row of $A^{2}$. Using row-by-column multiplication,\n$$\nC A^{2} = \\begin{pmatrix}\nk_{32} k_{21} - k_{31} (k_{1} + k_{3})  -k_{32} (k_{2} + k_{3})  k_{3}^{2}\n\\end{pmatrix}.\n$$\nThus\n$$\n\\mathcal{O} =\n\\begin{pmatrix}\n0  0  1 \\\\\nk_{31}  k_{32}  -k_{3} \\\\\nk_{32} k_{21} - k_{31} (k_{1} + k_{3})  -k_{32} (k_{2} + k_{3})  k_{3}^{2}\n\\end{pmatrix}.\n$$\nThe system is unobservable exactly when $\\det(\\mathcal{O}) = 0$. Expanding the determinant along the first row (whose first two entries are zero) yields\n$$\n\\det(\\mathcal{O}) = \\det\n\\begin{pmatrix}\nk_{31}  k_{32} \\\\\nk_{32} k_{21} - k_{31} (k_{1} + k_{3})  -k_{32} (k_{2} + k_{3})\n\\end{pmatrix}.\n$$\nCompute this $2 \\times 2$ determinant:\n$$\n\\det(\\mathcal{O}) = k_{31} \\bigl(-k_{32} (k_{2} + k_{3})\\bigr) - k_{32} \\bigl(k_{32} k_{21} - k_{31} (k_{1} + k_{3})\\bigr).\n$$\nSimplifying,\n$$\n\\det(\\mathcal{O}) = -k_{31} k_{32} (k_{2} + k_{3}) - k_{32}^{2} k_{21} + k_{32} k_{31} (k_{1} + k_{3})\n= k_{31} k_{32} (k_{1} - k_{2}) - k_{32}^{2} k_{21}.\n$$\nFactor out $k_{32}$:\n$$\n\\det(\\mathcal{O}) = k_{32} \\bigl( k_{31} (k_{1} - k_{2}) - k_{32} k_{21} \\bigr).\n$$\nFor generic non-zero kinetic parameters, $k_{32} \\neq 0$, so unobservability arises precisely when the bracketed factor vanishes:\n$$\nk_{31} (k_{1} - k_{2}) - k_{32} k_{21} = 0 \\quad \\Longleftrightarrow \\quad k_{31} (k_{1} - k_{2}) = k_{32} k_{21}.\n$$\nThis matches option A and does not depend on $k_{3}$. None of the other listed relations cause the determinant to vanish generically.", "answer": "$$\\boxed{A}$$", "id": "1451365"}]}