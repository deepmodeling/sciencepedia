{"hands_on_practices": [{"introduction": "To analyze biological pathways with mathematical rigor, we first need to translate them into a formal structure. This exercise [@problem_id:4373543] guides you through creating the incidence matrix, the cornerstone of Petri net analysis, which captures the net effect of each reaction on every species in the system. Mastering this conversion from a graphical or descriptive model to a matrix is the essential first step toward unlocking powerful analytical methods.", "problem": "Consider a Place/Transition (P/T) Petri net that models an enzyme-mediated conversion with recycling. The set of places is $\\{S, E, ES, P\\}$, representing the substrate $S$, free enzyme $E$, enzyme-substrate complex $ES$, and product $P$. The set of transitions is $\\{t_1, t_2, t_3\\}$ with the following biology-grounded meaning and arc structure, all arc weights equal to $1$:\n\nTransition $t_1$ (binding): inputs $S$ and $E$; outputs $ES$. Concretely, arcs are $S \\xrightarrow{1} t_1$, $E \\xrightarrow{1} t_1$, and $t_1 \\xrightarrow{1} ES$.\n\nTransition $t_2$ (catalysis): input $ES$; outputs $E$ and $P$. Concretely, arcs are $ES \\xrightarrow{1} t_2$, and $t_2 \\xrightarrow{1} E$, $t_2 \\xrightarrow{1} P$.\n\nTransition $t_3$ (recycling): input $P$; output $S$. Concretely, arcs are $P \\xrightarrow{1} t_3$, and $t_3 \\xrightarrow{1} S$.\n\nAdopt the place order $(S, E, ES, P)$ as rows and the transition order $(t_1, t_2, t_3)$ as columns for all matrices. Using first principles of P/T Petri nets, construct the post-incidence matrix $C^{+}$, the pre-incidence matrix $C^{-}$, and the incidence (stoichiometric) matrix $C$. For each entry $c_{ij}$ of $C$, interpret its sign and magnitude in terms of species consumption and production for place $i$ under transition $j$.\n\nFinally, determine the dimension over the real numbers of the right nullspace of $C$, that is, the dimension of the set $\\{x \\in \\mathbb{R}^{3} \\mid Cx = 0\\}$. Report this dimension as your final answer. No rounding is required and no physical units apply.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of systems biology and network theory, well-posed, objective, and provides a complete and consistent setup for constructing and analyzing a Petri net model.\n\nThe problem asks for the construction of the pre-incidence, post-incidence, and incidence matrices for a given Place/Transition (P/T) Petri net, an interpretation of the incidence matrix entries, and the dimension of the right nullspace of the incidence matrix. The system consists of a set of places $P_{set} = \\{S, E, ES, P\\}$ and a set of transitions $T_{set} = \\{t_1, t_2, t_3\\}$. The row ordering for matrices is specified as $(S, E, ES, P)$, and the column ordering is $(t_1, t_2, t_3)$. All arc weights are given as $1$.\n\nFirst, we construct the pre-incidence matrix, denoted as $C^{-}$. The entry $C^{-}_{ij}$ is the weight of the arc from place $i$ to transition $j$, representing the number of tokens consumed from place $i$ when transition $j$ fires. The matrix dimensions are $4 \\times 3$, corresponding to the $4$ places and $3$ transitions.\n\nFor transition $t_1$ (binding), the inputs are $S$ and $E$. Therefore, one token is consumed from place $S$ and one from place $E$. The first column of $C^{-}$ is $[1, 1, 0, 0]^T$.\nFor transition $t_2$ (catalysis), the input is $ES$. Therefore, one token is consumed from place $ES$. The second column of $C^{-}$ is $[0, 0, 1, 0]^T$.\nFor transition $t_3$ (recycling), the input is $P$. Therefore, one token is consumed from place $P$. The third column of $C^{-}$ is $[0, 0, 0, 1]^T$.\n\nCombining these columns, the pre-incidence matrix $C^{-}$ is:\n$$ C^{-} = \\begin{pmatrix} 1  0  0 \\\\ 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n\nNext, we construct the post-incidence matrix, denoted as $C^{+}$. The entry $C^{+}_{ij}$ is the weight of the arc from transition $j$ to place $i$, representing the number of tokens produced into place $i$ when transition $j$ fires.\n\nFor transition $t_1$, the output is $ES$. Therefore, one token is produced into place $ES$. The first column of $C^{+}$ is $[0, 0, 1, 0]^T$.\nFor transition $t_2$, the outputs are $E$ and $P$. Therefore, one token is produced into place $E$ and one into place $P$. The second column of $C^{+}$ is $[0, 1, 0, 1]^T$.\nFor transition $t_3$, the output is $S$. Therefore, one token is produced into place $S$. The third column of $C^{+}$ is $[1, 0, 0, 0]^T$.\n\nCombining these columns, the post-incidence matrix $C^{+}$ is:\n$$ C^{+} = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\\\ 0  1  0 \\end{pmatrix} $$\n\nThe incidence matrix, $C$, also known as the stoichiometric matrix, represents the net change in the number of tokens in each place for each transition. It is calculated as $C = C^{+} - C^{-}$.\n\n$$ C = C^{+} - C^{-} = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\\\ 0  1  0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} -1  0  1 \\\\ -1  1  0 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n\nThe interpretation of each entry $c_{ij}$ of the incidence matrix $C$ is as follows:\nA negative value $c_{ij} = -k$ means that the firing of transition $j$ results in a net consumption of $k$ tokens from place $i$.\nA positive value $c_{ij} = +k$ means that the firing of transition $j$ results in a net production of $k$ tokens into place $i$.\nA value of $c_{ij} = 0$ means that the firing of transition $j$ results in no net change of tokens in place $i$.\n\nLet's interpret the columns of $C$:\nColumn $1$ (for $t_1$): $[-1, -1, 1, 0]^T$. The firing of $t_1$ consumes $1$ token of $S$ and $1$ token of $E$, and produces $1$ token of $ES$. The amount of $P$ is unchanged.\nColumn $2$ (for $t_2$): $[0, 1, -1, 1]^T$. The firing of $t_2$ consumes $1$ token of $ES$, and produces $1$ token of $E$ and $1$ token of $P$. The amount of $S$ is unchanged.\nColumn $3$ (for $t_3$): $[1, 0, 0, -1]^T$. The firing of $t_3$ consumes $1$ token of $P$ and produces $1$ token of $S$. The amounts of $E$ and $ES$ are unchanged.\nThis interpretation is consistent with the biological meaning of the transitions.\n\nFinally, we must determine the dimension of the right nullspace of $C$. The right nullspace (or kernel) of $C$ is the set of vectors $x \\in \\mathbb{R}^{3}$ such that $Cx = 0$. The dimension of this vector space is the nullity of $C$, denoted $\\text{nullity}(C)$.\nAccording to the rank-nullity theorem, for a matrix $C$ with $n$ columns, we have:\n$$ \\text{rank}(C) + \\text{nullity}(C) = n $$\nIn our case, the matrix $C$ has $n=3$ columns. Thus, $\\text{nullity}(C) = 3 - \\text{rank}(C)$. We find the rank of $C$ by reducing it to row echelon form.\n\n$$ C = \\begin{pmatrix} -1  0  1 \\\\ -1  1  0 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n\nPerform elementary row operations:\n$R_2 \\leftarrow R_2 - R_1$:\n$$ \\begin{pmatrix} -1  0  1 \\\\ 0  1  -1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n$R_3 \\leftarrow R_3 + R_1$:\n$$ \\begin{pmatrix} -1  0  1 \\\\ 0  1  -1 \\\\ 0  -1  1 \\\\ 0  1  -1 \\end{pmatrix} $$\n$R_3 \\leftarrow R_3 + R_2$:\n$$ \\begin{pmatrix} -1  0  1 \\\\ 0  1  -1 \\\\ 0  0  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n$R_4 \\leftarrow R_4 - R_2$:\n$$ \\begin{pmatrix} -1  0  1 \\\\ 0  1  -1 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\nThe row echelon form of $C$ has two non-zero rows. The number of non-zero rows in the row echelon form is the rank of the matrix. Therefore, $\\text{rank}(C) = 2$.\n\nNow, we can calculate the nullity:\n$$ \\text{nullity}(C) = 3 - \\text{rank}(C) = 3 - 2 = 1 $$\nThe dimension of the right nullspace of $C$ is $1$. This corresponds to one linearly independent T-invariant, which is a sequence of transition firings that leaves the marking of the net unchanged. Solving for the nullspace vector $x = [x_1, x_2, x_3]^T$ from the row-reduced system:\n$-x_1 + x_3 = 0 \\implies x_1 = x_3$\n$x_2 - x_3 = 0 \\implies x_2 = x_3$\nSo, any vector in the nullspace is of the form $[k, k, k]^T$ for any scalar $k$. A basis for this space is the vector $[1, 1, 1]^T$. The dimension of this space is $1$.", "answer": "$$\\boxed{1}$$", "id": "4373543"}, {"introduction": "With the mathematical structure in place, the next step is to understand how the system state evolves over time. This practice [@problem_id:4373517] simulates the 'token game,' where you will manually step through a sequence of reaction events, applying the rules of enabling and firing. This fundamental exercise builds a strong intuition for the network's dynamic behavior and the crucial role of resource availability in controlling pathway activity.", "problem": "Consider a discrete Petri net model of a minimal phosphorylation cycle relevant to cellular signaling in systems biomedicine. The Petri net is defined by the tuple $\\mathcal{N} = (P, T, \\mathrm{Pre}, \\mathrm{Post})$, with places $P = \\{p_1,\\dots,p_9\\}$ representing molecular pools and enzymes, transitions $T = \\{t_1,t_2,t_3\\}$ representing reaction events, and arc-weight functions $\\mathrm{Pre}: P \\times T \\to \\mathbb{N}$ and $\\mathrm{Post}: P \\times T \\to \\mathbb{N}$ encoding stoichiometric consumption and production, respectively. Places correspond to the following species: $p_1$ is unphosphorylated substrate $\\mathrm{S}$, $p_2$ is phosphorylated substrate $\\mathrm{S_p}$, $p_3$ is Adenosine triphosphate (ATP), $p_4$ is Adenosine diphosphate (ADP), $p_5$ is inorganic phosphate ($\\mathrm{P_i}$), $p_6$ is water ($\\mathrm{H_2O}$), $p_7$ is kinase enzyme $E_k$, $p_8$ is phosphatase enzyme $E_p$, and $p_9$ is ATP synthase $E_a$. Tokens represent discrete molecular counts.\n\nThe initial marking $M_0$ is specified in the place order $(p_1,p_2,p_3,p_4,p_5,p_6,p_7,p_8,p_9)$ as\n$$\nM_0 = \\big(4,\\,1,\\,3,\\,0,\\,2,\\,2,\\,1,\\,1,\\,1\\big).\n$$\n\nArc weights are defined as follows.\n- Transition $t_1$ (phosphorylation by $E_k$): consumes $1$ token from $p_1$ ($\\mathrm{S}$), $1$ token from $p_3$ (ATP), and $1$ token from $p_7$ ($E_k$); produces $1$ token to $p_2$ ($\\mathrm{S_p}$), $1$ token to $p_4$ (ADP), and returns $1$ token to $p_7$ ($E_k$). Formally,\n$$\n\\mathrm{Pre}(\\cdot,t_1) = (1,\\,0,\\,1,\\,0,\\,0,\\,0,\\,1,\\,0,\\,0), \\quad\n\\mathrm{Post}(\\cdot,t_1) = (0,\\,1,\\,0,\\,1,\\,0,\\,0,\\,1,\\,0,\\,0).\n$$\n- Transition $t_2$ (dephosphorylation by $E_p$): consumes $1$ token from $p_2$ ($\\mathrm{S_p}$), $1$ token from $p_6$ ($\\mathrm{H_2O}$), and $1$ token from $p_8$ ($E_p$); produces $1$ token to $p_1$ ($\\mathrm{S}$), $1$ token to $p_5$ ($\\mathrm{P_i}$), and returns $1$ token to $p_8$ ($E_p$). Formally,\n$$\n\\mathrm{Pre}(\\cdot,t_2) = (0,\\,1,\\,0,\\,0,\\,0,\\,1,\\,0,\\,1,\\,0), \\quad\n\\mathrm{Post}(\\cdot,t_2) = (1,\\,0,\\,0,\\,0,\\,1,\\,0,\\,0,\\,1,\\,0).\n$$\n- Transition $t_3$ (ATP synthesis by $E_a$): consumes $1$ token from $p_4$ (ADP), $1$ token from $p_5$ ($\\mathrm{P_i}$), and $1$ token from $p_9$ ($E_a$); produces $1$ token to $p_3$ (ATP) and returns $1$ token to $p_9$ ($E_a$). Formally,\n$$\n\\mathrm{Pre}(\\cdot,t_3) = (0,\\,0,\\,0,\\,1,\\,1,\\,0,\\,0,\\,0,\\,1), \\quad\n\\mathrm{Post}(\\cdot,t_3) = (0,\\,0,\\,1,\\,0,\\,0,\\,0,\\,0,\\,0,\\,1).\n$$\n\nA transition $t \\in T$ is enabled in a marking $M$ if and only if $M(p) \\ge \\mathrm{Pre}(p,t)$ for all $p \\in P$. If $t$ fires at marking $M$, the new marking is $M' = M + \\mathrm{Post}(\\cdot,t) - \\mathrm{Pre}(\\cdot,t)$.\n\nYou are given the attempted firing sequence\n$$\n\\sigma = (t_1,\\, t_2,\\, t_2,\\, t_1,\\, t_2,\\, t_3,\\, t_2,\\, t_1,\\, t_2,\\, t_3).\n$$\nStarting from $M_0$, process $\\sigma$ left-to-right. At each step, verify whether the transition is enabled at the current marking by strictly applying the enabling condition. If it is enabled, fire it and update the marking; if it is disabled, it must not fire and no state change occurs at that step. Under these rules, compute the resulting marking $M_{\\mathrm{final}}$ after processing the entire sequence and express it as a single row matrix in the place order $(p_1,p_2,p_3,p_4,p_5,p_6,p_7,p_8,p_9)$. Also, as part of your derivation, explicitly verify that no disabled transition fires at its attempted step.\n\nProvide only the final marking as your final answer. No rounding is required. Units are counts (dimensionless) and should not be included in the final boxed answer.", "solution": "The problem presents a discrete Petri net model of a biochemical phosphorylation cycle and asks to determine the final marking of the net after a given sequence of attempted transition firings.\n\nFirst, a validation of the problem statement is in order. The problem is scientifically grounded, describing a standard biochemical motif using a well-established formalism from systems biology. All necessary components—the Petri net structure $(P, T, \\mathrm{Pre}, \\mathrm{Post})$, the initial marking $M_0$, the enabling condition, and the firing rule—are provided without ambiguity or contradiction. The problem is well-posed, leading to a unique, deterministically computable result. Therefore, the problem is deemed valid and a solution can be formulated.\n\nThe state of the Petri net is given by its marking vector $M$, which represents the number of tokens in each place. A transition $t$ is enabled if the number of tokens in each of its input places is at least the weight of the corresponding input arc. Formally, $t$ is enabled at marking $M$ if and only if $M \\ge \\mathrm{Pre}(\\cdot, t)$ (component-wise inequality). If an enabled transition $t$ fires, the marking is updated according to the state equation $M_{\\text{new}} = M_{\\text{old}} + \\mathrm{Post}(\\cdot, t) - \\mathrm{Pre}(\\cdot, t)$. If a transition is not enabled, it cannot fire, and the marking remains unchanged.\n\nLet us define the change vector $\\Delta_t = \\mathrm{Post}(\\cdot, t) - \\mathrm{Pre}(\\cdot, t)$ for each transition:\n$$\n\\Delta_{t_1} = (0,1,0,1,0,0,1,0,0) - (1,0,1,0,0,0,1,0,0) = (-1, 1, -1, 1, 0, 0, 0, 0, 0)\n$$\n$$\n\\Delta_{t_2} = (1,0,0,0,1,0,0,1,0) - (0,1,0,0,0,1,0,1,0) = (1, -1, 0, 0, 1, -1, 0, 0, 0)\n$$\n$$\n\\Delta_{t_3} = (0,0,1,0,0,0,0,0,1) - (0,0,0,1,1,0,0,0,1) = (0, 0, 1, -1, -1, 0, 0, 0, 0)\n$$\nThe initial marking is $M_0 = (4, 1, 3, 0, 2, 2, 1, 1, 1)$. We will now process the firing sequence $\\sigma = (t_1, t_2, t_2, t_1, t_2, t_3, t_2, t_1, t_2, t_3)$ step by step.\n\nStep 1: Attempt to fire $t_1$.\nCurrent marking $M_0 = (4, 1, 3, 0, 2, 2, 1, 1, 1)$.\nRequirement for $t_1$: $\\mathrm{Pre}(\\cdot, t_1) = (1, 0, 1, 0, 0, 0, 1, 0, 0)$.\nVerification: $M_0 \\ge \\mathrm{Pre}(\\cdot, t_1)$ since $4 \\ge 1$ for $p_1$, $3 \\ge 1$ for $p_3$, and $1 \\ge 1$ for $p_7$. All other requirements are for $0$ tokens.\nVerdict: $t_1$ is **enabled**.\nNew marking: $M_1 = M_0 + \\Delta_{t_1} = (4, 1, 3, 0, 2, 2, 1, 1, 1) + (-1, 1, -1, 1, 0, 0, 0, 0, 0) = (3, 2, 2, 1, 2, 2, 1, 1, 1)$.\n\nStep 2: Attempt to fire $t_2$.\nCurrent marking $M_1 = (3, 2, 2, 1, 2, 2, 1, 1, 1)$.\nRequirement for $t_2$: $\\mathrm{Pre}(\\cdot, t_2) = (0, 1, 0, 0, 0, 1, 0, 1, 0)$.\nVerification: $M_1 \\ge \\mathrm{Pre}(\\cdot, t_2)$ since $2 \\ge 1$ for $p_2$, $2 \\ge 1$ for $p_6$, and $1 \\ge 1$ for $p_8$.\nVerdict: $t_2$ is **enabled**.\nNew marking: $M_2 = M_1 + \\Delta_{t_2} = (3, 2, 2, 1, 2, 2, 1, 1, 1) + (1, -1, 0, 0, 1, -1, 0, 0, 0) = (4, 1, 2, 1, 3, 1, 1, 1, 1)$.\n\nStep 3: Attempt to fire $t_2$.\nCurrent marking $M_2 = (4, 1, 2, 1, 3, 1, 1, 1, 1)$.\nRequirement for $t_2$: $\\mathrm{Pre}(\\cdot, t_2) = (0, 1, 0, 0, 0, 1, 0, 1, 0)$.\nVerification: $M_2 \\ge \\mathrm{Pre}(\\cdot, t_2)$ since $1 \\ge 1$ for $p_2$, $1 \\ge 1$ for $p_6$, and $1 \\ge 1$ for $p_8$.\nVerdict: $t_2$ is **enabled**.\nNew marking: $M_3 = M_2 + \\Delta_{t_2} = (4, 1, 2, 1, 3, 1, 1, 1, 1) + (1, -1, 0, 0, 1, -1, 0, 0, 0) = (5, 0, 2, 1, 4, 0, 1, 1, 1)$.\n\nStep 4: Attempt to fire $t_1$.\nCurrent marking $M_3 = (5, 0, 2, 1, 4, 0, 1, 1, 1)$.\nRequirement for $t_1$: $\\mathrm{Pre}(\\cdot, t_1) = (1, 0, 1, 0, 0, 0, 1, 0, 0)$.\nVerification: $M_3 \\ge \\mathrm{Pre}(\\cdot, t_1)$ since $5 \\ge 1$ for $p_1$, $2 \\ge 1$ for $p_3$, and $1 \\ge 1$ for $p_7$.\nVerdict: $t_1$ is **enabled**.\nNew marking: $M_4 = M_3 + \\Delta_{t_1} = (5, 0, 2, 1, 4, 0, 1, 1, 1) + (-1, 1, -1, 1, 0, 0, 0, 0, 0) = (4, 1, 1, 2, 4, 0, 1, 1, 1)$.\n\nStep 5: Attempt to fire $t_2$.\nCurrent marking $M_4 = (4, 1, 1, 2, 4, 0, 1, 1, 1)$.\nRequirement for $t_2$: $\\mathrm{Pre}(\\cdot, t_2) = (0, 1, 0, 0, 0, 1, 0, 1, 0)$.\nVerification: The number of tokens in place $p_6$ is $M_4(p_6)=0$. The transition requires $\\mathrm{Pre}(p_6, t_2)=1$ token. Since $0  1$, the condition is not met.\nVerdict: $t_2$ is **disabled**.\nNew marking: The marking does not change. $M_5 = M_4 = (4, 1, 1, 2, 4, 0, 1, 1, 1)$.\n\nStep 6: Attempt to fire $t_3$.\nCurrent marking $M_5 = (4, 1, 1, 2, 4, 0, 1, 1, 1)$.\nRequirement for $t_3$: $\\mathrm{Pre}(\\cdot, t_3) = (0, 0, 0, 1, 1, 0, 0, 0, 1)$.\nVerification: $M_5 \\ge \\mathrm{Pre}(\\cdot, t_3)$ since $2 \\ge 1$ for $p_4$, $4 \\ge 1$ for $p_5$, and $1 \\ge 1$ for $p_9$.\nVerdict: $t_3$ is **enabled**.\nNew marking: $M_6 = M_5 + \\Delta_{t_3} = (4, 1, 1, 2, 4, 0, 1, 1, 1) + (0, 0, 1, -1, -1, 0, 0, 0, 0) = (4, 1, 2, 1, 3, 0, 1, 1, 1)$.\n\nStep 7: Attempt to fire $t_2$.\nCurrent marking $M_6 = (4, 1, 2, 1, 3, 0, 1, 1, 1)$.\nRequirement for $t_2$: $\\mathrm{Pre}(\\cdot, t_2) = (0, 1, 0, 0, 0, 1, 0, 1, 0)$.\nVerification: The number of tokens in place $p_6$ is $M_6(p_6)=0$, while $\\mathrm{Pre}(p_6, t_2)=1$. The condition is not satisfied.\nVerdict: $t_2$ is **disabled**.\nNew marking: The marking does not change. $M_7 = M_6 = (4, 1, 2, 1, 3, 0, 1, 1, 1)$.\n\nStep 8: Attempt to fire $t_1$.\nCurrent marking $M_7 = (4, 1, 2, 1, 3, 0, 1, 1, 1)$.\nRequirement for $t_1$: $\\mathrm{Pre}(\\cdot, t_1) = (1, 0, 1, 0, 0, 0, 1, 0, 0)$.\nVerification: $M_7 \\ge \\mathrm{Pre}(\\cdot, t_1)$ since $4 \\ge 1$ for $p_1$, $2 \\ge 1$ for $p_3$, and $1 \\ge 1$ for $p_7$.\nVerdict: $t_1$ is **enabled**.\nNew marking: $M_8 = M_7 + \\Delta_{t_1} = (4, 1, 2, 1, 3, 0, 1, 1, 1) + (-1, 1, -1, 1, 0, 0, 0, 0, 0) = (3, 2, 1, 2, 3, 0, 1, 1, 1)$.\n\nStep 9: Attempt to fire $t_2$.\nCurrent marking $M_8 = (3, 2, 1, 2, 3, 0, 1, 1, 1)$.\nRequirement for $t_2$: $\\mathrm{Pre}(\\cdot, t_2) = (0, 1, 0, 0, 0, 1, 0, 1, 0)$.\nVerification: The number of tokens in place $p_6$ is $M_8(p_6)=0$, which is less than the required $\\mathrm{Pre}(p_6, t_2)=1$.\nVerdict: $t_2$ is **disabled**.\nNew marking: The marking does not change. $M_9 = M_8 = (3, 2, 1, 2, 3, 0, 1, 1, 1)$.\n\nStep 10: Attempt to fire $t_3$.\nCurrent marking $M_9 = (3, 2, 1, 2, 3, 0, 1, 1, 1)$.\nRequirement for $t_3$: $\\mathrm{Pre}(\\cdot, t_3) = (0, 0, 0, 1, 1, 0, 0, 0, 1)$.\nVerification: $M_9 \\ge \\mathrm{Pre}(\\cdot, t_3)$ since $2 \\ge 1$ for $p_4$, $3 \\ge 1$ for $p_5$, and $1 \\ge 1$ for $p_9$.\nVerdict: $t_3$ is **enabled**.\nNew marking: $M_{10} = M_9 + \\Delta_{t_3} = (3, 2, 1, 2, 3, 0, 1, 1, 1) + (0, 0, 1, -1, -1, 0, 0, 0, 0) = (3, 2, 2, 1, 2, 0, 1, 1, 1)$.\n\nThe sequence $\\sigma$ has been fully processed. The final marking is $M_{\\mathrm{final}} = M_{10}$.\n$$\nM_{\\mathrm{final}} = (3, 2, 2, 1, 2, 0, 1, 1, 1)\n$$\nThis vector represents the counts of species in the order $(p_1, \\dots, p_9)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  2  2  1  2  0  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "4373517"}, {"introduction": "Beyond simulating specific scenarios, we can uncover universal laws that govern the system's behavior under any condition. This practice [@problem_id:4373556] introduces P-invariants, which are derived from the incidence matrix to identify conserved quantities within the network. Calculating and interpreting these invariants reveals fundamental biological principles, such as the conservation of total enzyme, providing a powerful method for model validation and deeper system insight.", "problem": "Consider the following biochemical reaction scheme for a competitive inhibition mechanism of an enzyme, encoded as a Petri net (PN, Petri net) with places representing molecular species and transitions representing reaction events. The places are $S$ (substrate), $E$ (free enzyme), $I$ (inhibitor), $C$ (enzyme–substrate complex), $EI$ (enzyme–inhibitor complex), and $P$ (product). The transitions are:\n- $t_{1}$: binding, $E + S \\to C$;\n- $t_{2}$: unbinding, $C \\to E + S$;\n- $t_{3}$: catalysis, $C \\to E + P$;\n- $t_{4}$: inhibitor binding, $E + I \\to EI$;\n- $t_{5}$: inhibitor unbinding, $EI \\to E + I$.\n\nTokens represent molecule counts. Construct the incidence matrix $C$ for this PN using the standard definition $C = C^{+} - C^{-}$, where $C^{-}$ and $C^{+}$ are the pre- and post-incidence matrices. Using the definition of a place-invariant (P-invariant), that is, a nonnegative integer vector $y$ satisfying $y^{\\top} C = 0$, compute a basis (in minimal integer form) of the space of P-invariants and interpret each basis vector as a conserved molecular total. Use only the foundational definitions of PN incidence and P-invariants as your starting point.\n\nGiven the initial marking $M(0)$ with ordering $(S,E,I,C,EI,P)$ equal to $(1500, 200, 100, 0, 50, 0)$ molecules, determine the conserved total number of enzyme moieties $E_{\\text{tot}}$ implied by your P-invariants. Express your final answer as a single number in molecules. No rounding is required.", "solution": "The problem asks for the construction of the incidence matrix for a Petri net (PN) model of enzyme competitive inhibition, the computation and interpretation of its P-invariants, and the calculation of a specific conserved quantity based on an initial state.\n\nThe system is defined by a set of places $P = \\{S, E, I, C, EI, P\\}$ and a set of transitions $T = \\{t_1, t_2, t_3, t_4, t_5\\}$. The number of places is $|P|=6$ and the number of transitions is $|T|=5$. We will order the places as a vector $(S, E, I, C, EI,P)^{\\top}$.\n\nThe transitions are given as:\n- $t_{1}$: $E + S \\to C$\n- $t_{2}$: $C \\to E + S$\n- $t_{3}$: $C \\to E + P$\n- $t_{4}$: $E + I \\to EI$\n- $t_{5}$: $EI \\to E + I$\n\nFirst, we construct the incidence matrix $C$, which is a $6 \\times 5$ matrix. The matrix $C$ is defined as $C = C^{+} - C^{-}$, where $C^{-}$ is the pre-incidence matrix (input stoichiometry) and $C^{+}$ is the post-incidence matrix (output stoichiometry).\n\nThe columns of $C^{-}$ correspond to the reactants of each transition:\n- $t_1$: Consumes $1S$ and $1E$.\n- $t_2$: Consumes $1C$.\n- $t_3$: Consumes $1C$.\n- $t_4$: Consumes $1E$ and $1I$.\n- $t_5$: Consumes $1EI$.\n\nThe columns of $C^{+}$ correspond to the products of each transition:\n- $t_1$: Produces $1C$.\n- $t_2$: Produces $1S$ and $1E$.\n- $t_3$: Produces $1E$ and $1P$.\n- $t_4$: Produces $1EI$.\n- $t_5$: Produces $1E$ and $1I$.\n\nBased on this, the pre- and post-incidence matrices are:\n$$\nC^{-} = \n\\bordermatrix{  t_1  t_2  t_3  t_4  t_5 \\cr\nS  1  0  0  0  0 \\cr\nE  1  0  0  1  0 \\cr\nI  0  0  0  1  0 \\cr\nC  0  1  1  0  0 \\cr\nEI 0  0  0  0  1 \\cr\nP  0  0  0  0  0 }\n\\quad \\text{and} \\quad\nC^{+} = \n\\bordermatrix{  t_1  t_2  t_3  t_4  t_5 \\cr\nS  0  1  0  0  0 \\cr\nE  0  1  1  0  1 \\cr\nI  0  0  0  0  1 \\cr\nC  1  0  0  0  0 \\cr\nEI 0  0  0  1  0 \\cr\nP  0  0  1  0  0 }\n$$\nThe incidence matrix $C = C^{+} - C^{-}$ is therefore:\n$$\nC = \\begin{pmatrix}\n0-1  1-0  0-0  0-0  0-0 \\\\\n0-1  1-0  1-0  0-1  1-0 \\\\\n0-0  0-0  0-0  0-1  1-0 \\\\\n1-0  0-1  0-1  0-0  0-0 \\\\\n0-0  0-0  0-0  1-0  0-1 \\\\\n0-0  0-0  1-0  0-0  0-0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1  1  0  0  0 \\\\\n-1  1  1  -1  1 \\\\\n0  0  0  -1  1 \\\\\n1  -1  -1  0  0 \\\\\n0  0  0  1  -1 \\\\\n0  0  1  0  0\n\\end{pmatrix}\n$$\nNext, we find the basis for the space of P-invariants. A P-invariant is a non-negative integer vector $y \\in \\mathbb{N}_0^6$ such that $y^{\\top}C = 0$. This is equivalent to finding a basis for the left null space of $C$. The equation $y^{\\top}C=0$ means that we are looking for linear combinations of the rows of $C$ that sum to the zero vector. Let the rows of $C$ be denoted $C_{S,:}, C_{E,:}, C_{I,:}, C_{C,:}, C_{EI,:}, C_{P,:}$.\n\nBy inspection of the rows of $C$:\n1.  Consider the rows for $I$ and $EI$:\n    $C_{I,:} + C_{EI,:} = (0, 0, 0, -1, 1) + (0, 0, 0, 1, -1) = (0, 0, 0, 0, 0)$.\n    This gives the P-invariant $y_1 = (0, 0, 1, 0, 1, 0)^{\\top}$. This vector is in minimal integer form.\n2.  Consider the rows for $E$, $C$, and $EI$:\n    $C_{E,:} + C_{C,:} + C_{EI,:} = (-1, 1, 1, -1, 1) + (1, -1, -1, 0, 0) + (0, 0, 0, 1, -1) = (0, 0, 0, 0, 0)$.\n    This gives the P-invariant $y_2 = (0, 1, 0, 1, 1, 0)^{\\top}$. This vector is in minimal integer form.\n3.  Consider the rows for $S$, $C$, and $P$:\n    $C_{S,:} + C_{C,:} + C_{P,:} = (-1, 1, 0, 0, 0) + (1, -1, -1, 0, 0) + (0, 0, 1, 0, 0) = (0, 0, 0, 0, 0)$.\n    This gives the P-invariant $y_3 = (1, 0, 0, 1, 0, 1)^{\\top}$. This vector is in minimal integer form.\n\nThese three vectors $y_1$, $y_2$, and $y_3$ are linearly independent and form a basis for the space of P-invariants. The dimension of the P-invariant space is $3$.\n\nThe interpretation of each basis vector is as follows. If $M$ is the marking (token count) vector, $M = (M(S), M(E), M(I), M(C), M(EI), M(P))^{\\top}$, then for any P-invariant $y$, the quantity $y^{\\top}M$ is a conserved total.\n- For $y_1=(0,0,1,0,1,0)^{\\top}$: The conserved quantity is $y_1^{\\top}M = M(I) + M(EI)$. This represents the total number of inhibitor molecules, $I_{\\text{tot}}$, which is constant because the inhibitor is only exchanged between its free form ($I$) and its enzyme-bound form ($EI$).\n- For $y_2=(0,1,0,1,1,0)^{\\top}$: The conserved quantity is $y_2^{\\top}M = M(E) + M(C) + M(EI)$. This represents the total number of enzyme moieties, $E_{\\text{tot}}$, which is constant because the enzyme is only exchanged between its free form ($E$), its substrate-bound form ($C$), and its inhibitor-bound form ($EI$).\n- For $y_3=(1,0,0,1,0,1)^{\\top}$: The conserved quantity is $y_3^{\\top}M = M(S) + M(C) + M(P)$. This represents the total number of substrate moieties, $S_{\\text{tot}}$. A substrate molecule ($S$) can be part of the complex ($C$) or can have been converted into product ($P$). This sum is conserved throughout the reaction process.\n\nFinally, we are asked to determine the value of the conserved total number of enzyme moieties, $E_{\\text{tot}}$, given the initial marking $M(0)$. The ordering of the marking is given as $(S, E, I, C, EI, P)$.\n$M(0) = (M(S)_0, M(E)_0, M(I)_0, M(C)_0, M(EI)_0, M(P)_0) = (1500, 200, 100, 0, 50, 0)$.\n\nThe total number of enzyme moieties is given by the P-invariant $y_2$. The conserved quantity is $E_{\\text{tot}} = y_2^{\\top}M$. Since this quantity is conserved, its value can be calculated at time $t=0$:\n$E_{\\text{tot}} = y_2^{\\top}M(0) = M(E)_0 + M(C)_0 + M(EI)_0$\nSubstituting the given initial values:\n$E_{\\text{tot}} = 200 + 0 + 50 = 250$\n\nThe total number of enzyme moieties is $250$ molecules.", "answer": "$$\\boxed{250}$$", "id": "4373556"}]}