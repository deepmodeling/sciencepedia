{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we return to a cornerstone of systems biology: the genetic toggle switch. This simple circuit, composed of two mutually repressing genes, provides a powerful yet tractable model for understanding how stable, distinct cell fates emerge from underlying gene regulatory networks. By performing a linear stability analysis, this exercise [@problem_id:4398469] challenges you to derive from first principles the precise conditions under which the system transitions from a single stable state to two, mathematically revealing the birth of the \"valleys\" in the Waddington landscape.", "problem": "Consider a symmetric two-gene toggle switch used to model cell-fate decisions in the Waddington epigenetic landscape. Let the concentrations of the two transcription factors be $x$ and $y$, and assume mutual repression with identical Hill exponents. The dynamics are modeled by the ordinary differential equations (ODEs)\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1+y^{n}} \\;-\\; \\beta\\,x, \n\\qquad\n\\dot{y} \\;=\\; \\frac{\\alpha}{1+x^{n}} \\;-\\; \\beta\\,y,\n$$\nwhere $\\alpha>0$ is the maximal synthesis rate, $\\beta>0$ is the linear degradation rate, and $n>0$ is the Hill coefficient representing repression cooperativity. Within the Waddington epigenetic landscape modeling framework, stable attractors correspond to valleys (cell fates) and unstable fixed points correspond to ridges. In symmetric toggles, bistability with two distinct valleys arises when the symmetric fixed point loses stability and a double-well landscape emerges.\n\nStarting from the fundamental definitions of fixed points and linear stability for dynamical systems, and without assuming any shortcut formulas, determine the exact parametric condition at which the symmetric fixed point transitions from stable to unstable. Express your final answer as a closed-form analytic expression for the critical synthesis rate $\\alpha_{\\mathrm{c}}$ in terms of $\\beta$ and $n$. Your answer must be a single expression. If your expression involves parameters, do not substitute numerical values. No rounding is required.", "solution": "The problem requires the determination of the parametric condition for the stability transition of the symmetric fixed point in a two-gene toggle switch model. This condition is to be expressed as a critical synthesis rate $\\alpha_{\\mathrm{c}}$ as a function of the degradation rate $\\beta$ and the Hill coefficient $n$. The derivation must be from first principles.\n\nThe dynamics of the system are described by the following set of ordinary differential equations (ODEs):\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1+y^{n}} \\;-\\; \\beta\\,x\n$$\n$$\n\\dot{y} \\;=\\; \\frac{\\alpha}{1+x^{n}} \\;-\\; \\beta\\,y\n$$\nwhere $x$ and $y$ are the concentrations of the two transcription factors. The parameters are the maximal synthesis rate $\\alpha > 0$, the degradation rate $\\beta > 0$, and the Hill coefficient $n > 0$.\n\nFirst, we identify the symmetric fixed point of the system. A fixed point is a state $(x^*, y^*)$ where $\\dot{x}=0$ and $\\dot{y}=0$. A symmetric fixed point is characterized by $x^* = y^*$. Let us denote this common concentration value as $z^*$. Substituting $x = y = z^*$ into the first ODE and setting the derivative to zero yields:\n$$\n0 \\;=\\; \\frac{\\alpha}{1+(z^*)^{n}} \\;-\\; \\beta\\,z^*\n$$\nThis equation provides a relationship between the fixed point concentration $z^*$ and the system parameters:\n$$\n\\alpha \\;=\\; \\beta z^* (1 + (z^*)^n)\n$$\n\nNext, we perform a linear stability analysis to determine the conditions under which this fixed point is stable. The stability is determined by the eigenvalues of the Jacobian matrix $J$ of the system, evaluated at the fixed point. The Jacobian matrix is defined as:\n$$\nJ(x,y) \\;=\\; \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x} & \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix}\n$$\nThe required partial derivatives are:\n$$\n\\frac{\\partial \\dot{x}}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha}{1+y^{n}} - \\beta x \\right) \\;=\\; -\\beta\n$$\n$$\n\\frac{\\partial \\dot{x}}{\\partial y} \\;=\\; \\frac{\\partial}{\\partial y} \\left( \\frac{\\alpha}{1+y^{n}} - \\beta x \\right) \\;=\\; -\\frac{\\alpha n y^{n-1}}{(1+y^n)^2}\n$$\nDue to the symmetry of the system, we have:\n$$\n\\frac{\\partial \\dot{y}}{\\partial y} \\;=\\; -\\beta\n$$\n$$\n\\frac{\\partial \\dot{y}}{\\partial x} \\;=\\; -\\frac{\\alpha n x^{n-1}}{(1+x^n)^2}\n$$\nEvaluating the Jacobian matrix $J$ at the symmetric fixed point $(z^*, z^*)$:\n$$\nJ^* \\;=\\; J(z^*, z^*) \\;=\\; \\begin{pmatrix} -\\beta & -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\\\ -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} & -\\beta \\end{pmatrix}\n$$\nLet's denote the off-diagonal term as $C$:\n$$\nC \\;=\\; -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2}\n$$\nThe Jacobian matrix is then $J^* = \\begin{pmatrix} -\\beta & C \\\\ C & -\\beta \\end{pmatrix}$. The eigenvalues $\\lambda$ of this matrix are found by solving the characteristic equation $\\det(J^* - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\beta - \\lambda & C \\\\ C & -\\beta - \\lambda \\end{pmatrix} \\;=\\; (-\\beta - \\lambda)^2 - C^2 \\;=\\; 0\n$$\nThis gives $(\\lambda + \\beta)^2 = C^2$, so $\\lambda + \\beta = \\pm C$. The two eigenvalues are:\n$$\n\\lambda_1 \\;=\\; -\\beta + C \\quad \\text{and} \\quad \\lambda_2 \\;=\\; -\\beta - C\n$$\nA fixed point is stable if the real parts of all its eigenvalues are negative. Since all parameters are real, the eigenvalues are real. As $\\alpha > 0$, $\\beta > 0$, $n > 0$, and $z^* > 0$, the term $C$ is strictly negative. Therefore, $\\lambda_2 = -\\beta - C = -\\beta + |C|$ and $\\lambda_1 = -\\beta + C = -\\beta - |C|$.\nThe eigenvalue $\\lambda_1 = -\\beta - |C|$ is always negative. The stability of the fixed point is thus determined by the sign of $\\lambda_2$.\nThe fixed point is stable if $\\lambda_2 < 0$, which implies $-\\beta + |C| < 0$, or $|C| < \\beta$.\nThe fixed point becomes unstable if $\\lambda_2 > 0$, which implies $|C| > \\beta$.\nThe transition from a stable to an unstable fixed point, which corresponds to a pitchfork bifurcation in this symmetric system, occurs precisely when $\\lambda_2 = 0$. The condition for this transition is:\n$$\n|C| \\;=\\; \\beta\n$$\nSubstituting the expression for $C$:\n$$\n\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\;=\\; \\beta\n$$\nThis equation defines the bifurcation boundary. To express this condition solely in terms of the parameters, we eliminate $z^*$ using the fixed point equation $\\alpha = \\beta z^* (1 + (z^*)^n)$. Substituting this into the bifurcation condition:\n$$\n\\frac{[\\beta z^* (1+(z^*)^n)] n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\;=\\; \\beta\n$$\nFor $\\beta > 0$, we can cancel $\\beta$ from both sides:\n$$\n\\frac{n (z^*)^n (1+(z^*)^n)}{(1+(z^*)^n)^2} \\;=\\; 1\n$$\n$$\n\\frac{n(z^*)^n}{1+(z^*)^n} \\;=\\; 1\n$$\nSolving for $(z^*)^n$:\n$$\nn(z^*)^n \\;=\\; 1 + (z^*)^n \\quad \\implies \\quad (n-1)(z^*)^n \\;=\\; 1 \\quad \\implies \\quad (z^*)^n \\;=\\; \\frac{1}{n-1}\n$$\nThis equation shows that a real positive solution for $z^*$ at the bifurcation point exists only if $n-1 > 0$, i.e., $n>1$. This is the well-known requirement for cooperativity to enable bistability.\nThe concentration at the bifurcation point is $z^* = \\left(\\frac{1}{n-1}\\right)^{1/n}$.\n\nThe critical synthesis rate, $\\alpha_c$, is the value of $\\alpha$ at this bifurcation point. We use the fixed point relation again:\n$$\n\\alpha_c \\;=\\; \\beta z^* (1 + (z^*)^n)\n$$\nSubstituting the expressions for $z^*$ and $(z^*)^n$ at the bifurcation:\n$$\n\\alpha_c \\;=\\; \\beta \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\nSimplifying the second term in parentheses:\n$$\n1 + \\frac{1}{n-1} \\;=\\; \\frac{n-1+1}{n-1} \\;=\\; \\frac{n}{n-1}\n$$\nSubstituting this back into the expression for $\\alpha_c$:\n$$\n\\alpha_c \\;=\\; \\beta \\left(\\frac{n}{n-1}\\right) \\left(\\frac{1}{n-1}\\right)^{1/n}\n$$\nFinally, we combine the terms involving $n-1$ to obtain the closed-form expression:\n$$\n\\alpha_c \\;=\\; \\frac{\\beta n}{(n-1)^{1} (n-1)^{1/n}} \\;=\\; \\frac{\\beta n}{(n-1)^{1+1/n}} \\;=\\; \\frac{\\beta n}{(n-1)^{(n+1)/n}}\n$$\nThis is the analytical expression for the critical synthesis rate at which the symmetric monostable state transitions to a bistable state.", "answer": "$$\n\\boxed{\\frac{\\beta n}{(n-1)^{(n+1)/n}}}\n$$", "id": "4398469"}, {"introduction": "Having established how multiple cell fates can emerge, we now turn to quantifying the stability of these states. A key feature of Waddington's landscape is that attractors are not only stable, but they exhibit 'canalization'—a robustness that pulls perturbed cells back to their fate. This practice [@problem_id:4398483] provides a concrete, numerically-specified gene regulatory network and asks you to calculate its local stability, connecting the abstract concept of eigenvalues to a quantitative measure of canalization strength, which represents the steepness of the landscape's valley.", "problem": "Consider a two-gene Gene Regulatory Network (GRN) modeled as a deterministic Ordinary Differential Equation (ODE) system representing mutual repression in a Waddington epigenetic landscape context. Let the state vector be $x = (x_{1}, x_{2})^{\\top}$, where $x_{i}$ denotes the copy number of messenger RNA (mRNA) for gene $i$. The dynamics are given by\n$$\n\\frac{dx_{1}}{dt} = f_{1}(x_{1}, x_{2}) = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1}, \\quad\n\\frac{dx_{2}}{dt} = f_{2}(x_{1}, x_{2}) = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2}.\n$$\nAssume the following empirically calibrated parameters, consistent with a progenitor attractor in a Waddington epigenetic landscape: $\\alpha_{1} = \\alpha_{2} = 6.25$ (molecules$\\cdot$hour$^{-1}$), $\\delta_{1} = \\delta_{2} = 1$ (hour$^{-1}$), $K_{12} = K_{21} = 10$ (molecules), $n_{12} = n_{21} = 2$, and a measured fixed point $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}) = (5, 5)$ (molecules) satisfying $f(x^{\\ast}) = 0$.\n\nStarting from the definition of a fixed point and the multivariate Taylor expansion of $f$ about $x^{\\ast}$, linearize the dynamics near $x^{\\ast}$ to obtain the Jacobian matrix evaluated at $x^{\\ast}$. Then, compute the eigenvalues of this Jacobian and use them to determine the local stability of the fixed point under small perturbations. Define the canalization strength $C$ as the smallest restoring rate, namely\n$$\nC = \\min_{i:\\,\\Re(\\lambda_{i}) < 0} \\big(-\\Re(\\lambda_{i})\\big),\n$$\nwhere $\\lambda_{i}$ are the eigenvalues of the Jacobian at $x^{\\ast}$ and $\\Re(\\cdot)$ denotes the real part. Interpret $C$ as quantifying the weakest local pull back to the attractor in the Waddington epigenetic landscape. Express your final answer for $C$ in hour$^{-1}$ and round your result to four significant figures.", "solution": "The problem asks for the calculation of the canalization strength $C$ for a given fixed point of a two-gene regulatory network. The procedure involves linearizing the system dynamics around the specified fixed point, calculating the eigenvalues of the corresponding Jacobian matrix, and then applying the given definition for $C$.\n\nThe system of Ordinary Differential Equations (ODEs) is given by:\n$$\n\\frac{dx_{1}}{dt} = f_{1}(x_{1}, x_{2}) = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1}\n$$\n$$\n\\frac{dx_{2}}{dt} = f_{2}(x_{1}, x_{2}) = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2}\n$$\nThe parameters are provided as: $\\alpha_{1} = \\alpha_{2} = 6.25$, $\\delta_{1} = \\delta_{2} = 1$, $K_{12} = K_{21} = 10$, and $n_{12} = n_{21} = 2$. The fixed point is $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast})^{\\top} = (5, 5)^{\\top}$.\n\nFirst, we linearize the system around the fixed point $x^{\\ast}$ by computing the Jacobian matrix $J(x^{\\ast})$. The Jacobian matrix $J$ is a matrix of all first-order partial derivatives of the vector function $f = (f_1, f_2)^{\\top}$:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial x_{1}} & \\frac{\\partial f_{1}}{\\partial x_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial x_{1}} & \\frac{\\partial f_{2}}{\\partial x_{2}} \\end{pmatrix}\n$$\nWe compute each element of the Jacobian matrix.\n\nFor the diagonal elements:\n$$\n\\frac{\\partial f_{1}}{\\partial x_{1}} = \\frac{\\partial}{\\partial x_{1}} \\left( \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1} \\right) = -\\delta_{1}\n$$\n$$\n\\frac{\\partial f_{2}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2} \\right) = -\\delta_{2}\n$$\n\nFor the off-diagonal elements:\n$$\n\\frac{\\partial f_{1}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\alpha_{1} \\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{-1} - \\delta_{1} x_{1} \\right) = -\\alpha_{1} \\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{-2} \\cdot \\left( \\frac{n_{21} x_{2}^{n_{21}-1}}{K_{21}^{n_{21}}} \\right)\n$$\n$$\n\\frac{\\partial f_{1}}{\\partial x_{2}} = - \\frac{\\alpha_{1} n_{21}}{K_{21}} \\frac{\\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}-1}}{\\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{2}}\n$$\nBy symmetry of the equations, the other off-diagonal element is:\n$$\n\\frac{\\partial f_{2}}{\\partial x_{1}} = - \\frac{\\alpha_{2} n_{12}}{K_{12}} \\frac{\\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}-1}}{\\left(1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}\\right)^{2}}\n$$\nNow, we evaluate the Jacobian matrix at the fixed point $x^{\\ast}=(5, 5)$ using the given parameter values:\n$J_{11} = -\\delta_{1} = -1$\n$J_{22} = -\\delta_{2} = -1$\n\nFor $J_{12}$:\n$$\nJ_{12}(x^{\\ast}) = - \\frac{6.25 \\times 2}{10} \\frac{\\left(\\frac{5}{10}\\right)^{2-1}}{\\left(1 + \\left(\\frac{5}{10}\\right)^{2}\\right)^{2}} = -1.25 \\frac{0.5}{(1 + 0.5^2)^2} = -1.25 \\frac{0.5}{(1 + 0.25)^2} = -1.25 \\frac{0.5}{1.25^2} = - \\frac{0.5}{1.25} = -0.4\n$$\nDue to the symmetry of the problem's parameters and fixed point, $J_{21}(x^{\\ast}) = J_{12}(x^{\\ast}) = -0.4$.\n\nThe Jacobian matrix evaluated at the fixed point is:\n$$\nJ(x^{\\ast}) = \\begin{pmatrix} -1 & -0.4 \\\\ -0.4 & -1 \\end{pmatrix}\n$$\nNext, we find the eigenvalues $\\lambda$ of $J(x^{\\ast})$ by solving the characteristic equation $\\det(J(x^{\\ast}) - \\lambda I) = 0$, where $I$ is the identity matrix.\n$$\n\\det \\begin{pmatrix} -1-\\lambda & -0.4 \\\\ -0.4 & -1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1-\\lambda)(-1-\\lambda) - (-0.4)(-0.4) = 0\n$$\n$$\n(\\lambda + 1)^{2} - 0.16 = 0\n$$\n$$\n(\\lambda + 1)^{2} = 0.16\n$$\nTaking the square root of both sides gives:\n$$\n\\lambda + 1 = \\pm\\sqrt{0.16} = \\pm 0.4\n$$\nThis gives two real eigenvalues:\n$$\n\\lambda_{1} = -1 + 0.4 = -0.6\n$$\n$$\n\\lambda_{2} = -1 - 0.4 = -1.4\n$$\nSince both eigenvalues are real and negative ($\\Re(\\lambda_{1}) = -0.6 < 0$ and $\\Re(\\lambda_{2}) = -1.4 < 0$), the fixed point is a stable node. This is consistent with its interpretation as a progenitor attractor in the Waddington landscape.\n\nThe canalization strength $C$ is defined as the smallest restoring rate:\n$$\nC = \\min_{i:\\,\\Re(\\lambda_{i}) < 0} \\big(-\\Re(\\lambda_{i})\\big)\n$$\nThe real parts of the eigenvalues are $\\Re(\\lambda_{1}) = -0.6$ and $\\Re(\\lambda_{2}) = -1.4$. The restoring rates are the negatives of these real parts:\n$$\n-\\Re(\\lambda_{1}) = 0.6\n$$\n$$\n-\\Re(\\lambda_{2}) = 1.4\n$$\nThe canalization strength $C$ is the minimum of these values:\n$$\nC = \\min(0.6, 1.4) = 0.6\n$$\nThe units of the Jacobian entries are (rate of change of concentration) / (concentration), which is (molecules$\\cdot$hour$^{-1}$)/molecules = hour$^{-1}$. Therefore, the eigenvalues and $C$ have units of hour$^{-1}$.\n\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nC = 0.6000 \\, \\text{hour}^{-1}\n$$\nThis value represents the weakest local restoring rate, which characterizes the \"shallowness\" of the attractor basin along its least stable direction.", "answer": "$$\\boxed{0.6000}$$", "id": "4398483"}, {"introduction": "Our final practice moves from the static analysis of attractors to the dynamic process of transitioning between them, a process central to development and cellular reprogramming. In the real biological world, these transitions are not deterministic but are driven by inherent molecular noise, allowing cells to escape one valley and explore others. This computational exercise [@problem_id:4398501] tasks you with simulating noise-induced fate transitions on a predefined landscape, allowing you to quantitatively explore the fundamental trade-off between the speed of reprogramming and the fidelity of reaching the desired target fate.", "problem": "Consider a minimal two-gene Waddington epigenetic landscape modeled as an overdamped stochastic gradient flow on a synthetic potential that supports three cell fate basins: a starting fate, a desired target fate, and an off-target fate. The state is a two-dimensional vector $\\mathbf{z}(t) = (x(t), y(t))$. The dynamics are governed by the Langevin equation in the Itô interpretation: \n$$\n\\frac{d\\mathbf{z}}{dt} = -\\nabla U(\\mathbf{z}) + \\sqrt{2\\varepsilon}\\,\\boldsymbol{\\xi}(t),\n$$\nwhere $U(\\mathbf{z})$ is the effective landscape potential, $\\varepsilon$ is the scalar noise strength, and $\\boldsymbol{\\xi}(t)$ is Gaussian white noise with independent components and unit variance. The potential $U(\\mathbf{z})$ is constructed as a sum of three Gaussian wells that represent the starting, target, and off-target fates, plus a weak quadratic confining term:\n$$\nU(\\mathbf{z}) = k \\|\\mathbf{z}\\|^2 - \\sum_{i \\in \\{S,B,C\\}} A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right),\n$$\nwith centers $\\mathbf{z}_S = (-1.2, 0.0)$, $\\mathbf{z}_B = (0.9, 0.9)$, $\\mathbf{z}_C = (0.9, -0.9)$, depths $A_S = 3.0$, $A_B = 6.0$, $A_C = 5.2$, Gaussian width $\\sigma = 0.3$, and confinement $k = 0.05$. The initial condition is $\\mathbf{z}(0) = \\mathbf{z}_S$, and time is dimensionless.\n\nYou will simulate the stochastic differential equation numerically using the Euler–Maruyama scheme on a fixed time grid with step size $\\Delta t = 0.01$ up to a maximum time $T_{\\max} = 50.0$. Let the hit radius be $r_{\\mathrm{hit}} = 0.25$. A trajectory is said to have reached a fate if it first enters the closed ball of radius $r_{\\mathrm{hit}}$ around either $\\mathbf{z}_B$ (target) or $\\mathbf{z}_C$ (off-target). For each noise strength $\\varepsilon$ and for a fixed number of independent trajectories $N = 150$, define the following quantitative metrics:\n\n- Speed metric $S(\\varepsilon)$: the median of the first hitting times to either fate among trajectories that hit within time $T_{\\max}$. If no trajectory hits either fate within $T_{\\max}$, set $S(\\varepsilon) = T_{\\max}$.\n- Fidelity metric $F(\\varepsilon)$: the fraction, expressed as a decimal between $0$ and $1$, of the trajectories that hit a fate and that hit the target fate $\\mathbf{z}_B$. If no trajectory hits either fate within $T_{\\max}$, set $F(\\varepsilon) = 0$.\n\nUse the following test suite for the noise strength parameter:\n- $\\varepsilon = 0.0$ (deterministic boundary),\n- $\\varepsilon = 0.02$ (low noise),\n- $\\varepsilon = 0.06$ (moderate noise),\n- $\\varepsilon = 0.15$ (high noise).\n\nAll simulations must be performed with a fixed pseudorandom seed to ensure reproducibility. Your program should implement the Euler–Maruyama discretization for the above system and compute $(S(\\varepsilon), F(\\varepsilon))$ for each $\\varepsilon$ in the test suite. Time is dimensionless, and all quantities must be treated as dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of four pairs, each pair itself a comma-separated list of two floats in the order $[S(\\varepsilon),F(\\varepsilon)]$, enclosed in square brackets, for example:\n$$\n\\text{[}[S(\\varepsilon_1),F(\\varepsilon_1)],[S(\\varepsilon_2),F(\\varepsilon_2)],[S(\\varepsilon_3),F(\\varepsilon_3)],[S(\\varepsilon_4),F(\\varepsilon_4)]\\text{]}.\n$$\nThe final outputs for each test case must be floats, and the program must not print any other text.", "solution": "The problem requires the numerical simulation of a two-dimensional stochastic differential equation (SDE) modeling cell fate determination in a Waddington landscape. The solution proceeds by first deriving the explicit form of the equations of motion, then implementing a suitable numerical integration scheme, and finally computing the specified statistical metrics from the simulation output.\n\nThe state of the system is given by the vector $\\mathbf{z}(t) = (x(t), y(t))$, and its dynamics are governed by the overdamped Langevin equation in the Itô interpretation:\n$$\nd\\mathbf{z} = -\\nabla U(\\mathbf{z}) dt + \\sqrt{2\\varepsilon}\\,d\\mathbf{W}(t)\n$$\nwhere $\\mathbf{z}$ is the state vector, $U(\\mathbf{z})$ is the potential energy landscape, $\\varepsilon$ is the noise strength, and $d\\mathbf{W}(t)$ represents increments of a vector-valued Wiener process, with components being independent Gaussian white noise.\n\nThe potential $U(\\mathbf{z})$ is defined as:\n$$\nU(\\mathbf{z}) = k \\|\\mathbf{z}\\|^2 - \\sum_{i \\in \\{S,B,C\\}} A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right)\n$$\nThe first step is to compute the gradient of the potential, $\\nabla U(\\mathbf{z})$, which defines the deterministic force $\\mathbf{F}(\\mathbf{z}) = -\\nabla U(\\mathbf{z})$. Using standard vector calculus, the gradient is found to be:\n$$\n\\nabla U(\\mathbf{z}) = \\nabla \\left(k \\|\\mathbf{z}\\|^2\\right) - \\sum_{i \\in \\{S,B,C\\}} \\nabla \\left( A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right) \\right)\n$$\n$$\n\\nabla U(\\mathbf{z}) = 2k\\mathbf{z} + \\frac{1}{\\sigma^2} \\sum_{i \\in \\{S,B,C\\}} A_i (\\mathbf{z} - \\mathbf{z}_i) \\exp\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right)\n$$\nThe SDE is solved numerically using the Euler–Maruyama method, which is a standard scheme for stochastic integrators. The discretized update rule for the state vector $\\mathbf{z}_n$ at time step $n$ to $\\mathbf{z}_{n+1}$ at time step $n+1$ is given by:\n$$\n\\mathbf{z}_{n+1} = \\mathbf{z}_n - \\nabla U(\\mathbf{z}_n)\\Delta t + \\sqrt{2\\varepsilon\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\nHere, $\\Delta t$ is the time step size and $\\boldsymbol{\\eta}_n$ is a two-dimensional random vector whose components are independent random variables drawn from a standard normal distribution, $N(0,1)$. This equation forms the core of the simulation.\n\nThe overall simulation algorithm is structured as follows. For each prescribed noise level $\\varepsilon$ from the test suite $\\{0.0, 0.02, 0.06, 0.15\\}$:\n$1$. Initialize two empty lists, one for storing the first hitting times of successful trajectories, and another for storing which fate ('B' or 'C') was hit.\n$2$. For each of the $N=150$ independent trajectories:\n    a. Set the initial condition $\\mathbf{z}(0) = \\mathbf{z}_S = (-1.2, 0.0)$.\n    b. Iterate forward in time from $t=0$ to $T_{\\max}=50.0$ in steps of $\\Delta t=0.01$.\n    c. In each step, update the position vector $\\mathbf{z}$ using the Euler–Maruyama rule derived above. A fixed pseudorandom seed is used to ensure the sequence of random numbers $\\boldsymbol{\\eta}_n$ is reproducible.\n    d. After each update, check if the new position $\\mathbf{z}$ has entered the hitting region of either the target fate $\\mathbf{z}_B = (0.9, 0.9)$ or the off-target fate $\\mathbf{z}_C = (0.9, -0.9)$. A hit is registered if $\\|\\mathbf{z} - \\mathbf{z}_B\\| \\le r_{\\mathrm{hit}}$ or $\\|\\mathbf{z} - \\mathbf{z}_C\\| \\le r_{\\mathrm{hit}}$, where the hit radius is $r_{\\mathrm{hit}} = 0.25$.\n    e. If a hit occurs, the current time is recorded as the first hitting time, the corresponding fate is noted, and the simulation for that trajectory is terminated.\n    f. If the trajectory does not hit any fate by the time $t$ reaches $T_{\\max}$, it is not included in the hit statistics.\n\n$3$. After all $N$ trajectories for a given $\\varepsilon$ have been simulated, the specified metrics are calculated:\n    - **Speed $S(\\varepsilon)$**: If any trajectories hit a fate, $S(\\varepsilon)$ is the median of the collected hitting times. If no trajectories hit, $S(\\varepsilon)$ is set to $T_{\\max}$, which is $50.0$.\n    - **Fidelity $F(\\varepsilon)$**: If any trajectories hit a fate, $F(\\varepsilon)$ is the ratio of the number of trajectories that hit the target fate $\\mathbf{z}_B$ to the total number of trajectories that hit either fate. If no trajectories hit, $F(\\varepsilon)$ is set to $0.0$.\n\nThis entire process is repeated for each value of $\\varepsilon$ in the test suite. The implementation uses the `numpy` library for efficient vectorized operations. The final result is a list of pairs $[S(\\varepsilon), F(\\varepsilon)]$ for each $\\varepsilon$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates cell fate transitions on a Waddington landscape and computes\n    speed and fidelity metrics for different noise levels.\n    \"\"\"\n    # Set a fixed seed for reproducibility as required by the problem\n    np.random.seed(42)\n\n    # --- Problem Parameters ---\n    # Potential parameters\n    k = 0.05\n    sigma = 0.3\n    sigma_sq = sigma**2\n    z_S = np.array([-1.2, 0.0])\n    z_B = np.array([0.9, 0.9])\n    z_C = np.array([0.9, -0.9])\n    A_S = 3.0\n    A_B = 6.0\n    A_C = 5.2\n\n    # Simulation parameters\n    dt = 0.01\n    T_max = 50.0\n    N = 150  # Number of trajectories\n\n    # Hitting criteria\n    r_hit = 0.25\n    r_hit_sq = r_hit**2\n\n    # Test cases for the noise strength parameter\n    test_cases = [0.0, 0.02, 0.06, 0.15]\n\n    def grad_U(z):\n        \"\"\"\n        Computes the gradient of the potential U at a given position z.\n        The parameters of the potential are taken from the enclosing scope.\n        \"\"\"\n        grad = 2 * k * z\n        \n        # Contribution from well S\n        diff_S = z - z_S\n        sq_dist_S = np.dot(diff_S, diff_S)\n        exp_S = np.exp(-sq_dist_S / (2 * sigma_sq))\n        grad += (A_S / sigma_sq) * exp_S * diff_S\n        \n        # Contribution from well B\n        diff_B = z - z_B\n        sq_dist_B = np.dot(diff_B, diff_B)\n        exp_B = np.exp(-sq_dist_B / (2 * sigma_sq))\n        grad += (A_B / sigma_sq) * exp_B * diff_B\n\n        # Contribution from well C\n        diff_C = z - z_C\n        sq_dist_C = np.dot(diff_C, diff_C)\n        exp_C = np.exp(-sq_dist_C / (2 * sigma_sq))\n        grad += (A_C / sigma_sq) * exp_C * diff_C\n        \n        return grad\n\n    results = []\n    # Loop over each noise strength\n    for epsilon in test_cases:\n        hitting_times = []\n        hit_fates = []\n        \n        noise_magnitude = np.sqrt(2 * epsilon * dt)\n        \n        # Run N independent trajectories\n        for _ in range(N):\n            z = z_S.copy()\n            num_steps = int(T_max / dt)\n            \n            for i in range(num_steps):\n                # Calculate deterministic force component\n                force_dt = -grad_U(z) * dt\n                \n                # Calculate stochastic displacement component\n                if epsilon > 0:\n                    random_displacement = noise_magnitude * np.random.randn(2)\n                else:\n                    random_displacement = np.array([0.0, 0.0])\n                \n                # Update position using Euler-Maruyama step\n                z += force_dt + random_displacement\n                \n                # Check for hitting a fate\n                if np.sum((z - z_B)**2) = r_hit_sq:\n                    hit_time = (i + 1) * dt\n                    hitting_times.append(hit_time)\n                    hit_fates.append('B')\n                    break  # End this trajectory\n                \n                if np.sum((z - z_C)**2) = r_hit_sq:\n                    hit_time = (i + 1) * dt\n                    hitting_times.append(hit_time)\n                    hit_fates.append('C')\n                    break  # End this trajectory\n        \n        # --- Calculate metrics for this epsilon ---\n        num_hits = len(hitting_times)\n        \n        if num_hits == 0:\n            speed_metric = T_max\n            fidelity_metric = 0.0\n        else:\n            # Speed metric: median of hitting times for successful trajectories\n            speed_metric = np.median(hitting_times)\n            \n            # Fidelity metric: fraction of successful hits that reached target B\n            num_hits_B = hit_fates.count('B')\n            fidelity_metric = num_hits_B / num_hits\n\n        results.append([float(speed_metric), float(fidelity_metric)])\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4398501"}]}