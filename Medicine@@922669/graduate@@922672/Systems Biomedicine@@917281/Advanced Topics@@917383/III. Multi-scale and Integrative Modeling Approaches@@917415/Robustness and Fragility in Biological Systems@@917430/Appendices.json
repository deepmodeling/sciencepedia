{"hands_on_practices": [{"introduction": "Negative feedback is a ubiquitous and fundamental mechanism for achieving stability and robustness in biological systems. This exercise provides a hands-on derivation to quantify this principle, demonstrating precisely how a feedback loop can buffer a system's output against fluctuations in its input signals. By calculating the system's sensitivity, you will gain a concrete understanding of how engineers and nature alike use feedback to build resilient systems [@problem_id:4384434].", "problem": "A minimal biosynthetic control module is modeled as follows. Let $x(t)$ denote the concentration of a gene product. Under mass-action kinetics, $x(t)$ is produced at rate $k_{u}\\,u(t)$ from an upstream controller signal $u(t)$ and is degraded by a first-order process at rate $k_{d}\\,x(t)$, where $k_{u}0$ and $k_{d}0$. A linear negative feedback is implemented by the controller such that $u(t)=u_{0}-K\\,x(t)$ with $K \\ge 0$, where $u_{0}$ is a constant set-point command.\n\nStarting from the definitions of mass-action production and first-order loss, and using the definition of steady state $\\dot{x}=0$, derive the steady-state $x^{\\ast}$ as a function of $k_{u}$, $k_{d}$, $K$, and $u_{0}$. Define the absolute steady-state input sensitivity as $S_{u}=\\frac{\\partial x^{\\ast}}{\\partial u_{0}}$, and, using only these foundations, obtain a closed-form expression for $S_{u}$ and explain how it depends on $K$ in terms of robustness to variations in $u_{0}$.\n\nProvide as your final answer only the algebraic expression for $S_{u}$ in terms of $k_{u}$, $k_{d}$, and $K$. Do not include units. No rounding is required.", "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It describes a standard, minimal model of a negative feedback loop commonly used in systems biology, based on established kinetic principles. All parameters and objectives are clearly defined, and there are no internal contradictions or missing information. The problem is valid.\n\nThe dynamic behavior of the gene product concentration, denoted by $x(t)$, is governed by the balance between its production and degradation. The rate of change, $\\dot{x} = \\frac{dx}{dt}$, is described by the following ordinary differential equation:\n$$\n\\frac{dx}{dt} = \\text{Production Rate} - \\text{Degradation Rate}\n$$\nAccording to the problem statement, the production rate is driven by the controller signal $u(t)$ under mass-action kinetics, given by $k_{u}\\,u(t)$. The degradation is a first-order process with rate $k_{d}\\,x(t)$. Therefore, the governing equation is:\n$$\n\\frac{dx}{dt} = k_{u}\\,u(t) - k_{d}\\,x(t)\n$$\nThe controller implements a linear negative feedback, where the signal $u(t)$ is defined as:\n$$\nu(t) = u_{0} - K\\,x(t)\n$$\nHere, $u_{0}$ is a constant set-point command and $K \\ge 0$ is the feedback gain. Substituting this expression for $u(t)$ into the rate equation yields:\n$$\n\\frac{dx}{dt} = k_{u}\\,(u_{0} - K\\,x(t)) - k_{d}\\,x(t)\n$$\nExpanding this equation gives:\n$$\n\\frac{dx}{dt} = k_{u}\\,u_{0} - k_{u}\\,K\\,x(t) - k_{d}\\,x(t)\n$$\nThe problem requires finding the steady-state concentration, $x^{\\ast}$. By definition, the steady state is the condition where the concentration no longer changes over time, meaning $\\frac{dx}{dt} = 0$. Let $x^{\\ast}$ be the value of $x$ at steady state. The equation becomes:\n$$\n0 = k_{u}\\,u_{0} - k_{u}\\,K\\,x^{\\ast} - k_{d}\\,x^{\\ast}\n$$\nTo solve for $x^{\\ast}$, we group the terms containing $x^{\\ast}$:\n$$\nk_{u}\\,K\\,x^{\\ast} + k_{d}\\,x^{\\ast} = k_{u}\\,u_{0}\n$$\nFactoring out $x^{\\ast}$ on the left-hand side gives:\n$$\nx^{\\ast}(k_{u}\\,K + k_{d}) = k_{u}\\,u_{0}\n$$\nIsolating $x^{\\ast}$, we obtain the expression for the steady-state concentration as a function of the system parameters:\n$$\nx^{\\ast} = \\frac{k_{u}\\,u_{0}}{k_{d} + k_{u}\\,K}\n$$\nNext, we are asked to find the absolute steady-state input sensitivity, $S_{u}$, which is defined as the partial derivative of the steady-state concentration $x^{\\ast}$ with respect to the input command $u_{0}$:\n$$\nS_{u} = \\frac{\\partial x^{\\ast}}{\\partial u_{0}}\n$$\nWe apply this definition to the derived expression for $x^{\\ast}$. The parameters $k_{u}$, $k_{d}$, and $K$ are constants with respect to $u_{0}$.\n$$\nS_{u} = \\frac{\\partial}{\\partial u_{0}} \\left( \\frac{k_{u}\\,u_{0}}{k_{d} + k_{u}\\,K} \\right)\n$$\nSince the term $\\frac{k_{u}}{k_{d} + k_{u}\\,K}$ is a constant multiplier of $u_{0}$, the differentiation is straightforward:\n$$\nS_{u} = \\frac{k_{u}}{k_{d} + k_{u}\\,K}\n$$\nThis is the closed-form expression for the sensitivity $S_{u}$.\n\nFinally, we must explain how this sensitivity depends on the feedback gain $K$. The quantity $S_{u}$ measures how much the steady-state output $x^{\\ast}$ changes for a unit change in the input signal $u_{0}$. A smaller value of $S_{u}$ indicates that the system output is less affected by variations or perturbations in the input command, a property known as robustness.\n\nAnalyzing the expression for $S_{u}$, the numerator, $k_{u}$, is a positive constant. The denominator is $k_{d} + k_{u}\\,K$. Since $k_{u}  0$ and $k_{d}  0$, and the feedback gain $K \\ge 0$, the denominator is strictly positive.\nAs the feedback gain $K$ increases from $0$, the term $k_{u}\\,K$ increases. This causes the entire denominator, $k_{d} + k_{u}\\,K$, to increase. Consequently, the value of the fraction $S_{u}$ decreases.\n\nIn the absence of feedback ($K=0$), the sensitivity is at its maximum value, $S_{u} = \\frac{k_{u}}{k_{d}}$, which corresponds to the open-loop sensitivity. As the strength of the negative feedback ($K$) increases, the sensitivity $S_{u}$ is suppressed. Therefore, negative feedback reduces the sensitivity of the system's output to variations in its input command signal, thereby enhancing the system's robustness. This demonstrates a fundamental principle of control theory as applied to biological systems: negative feedback is a key mechanism for achieving robustness.", "answer": "$$\n\\boxed{\\frac{k_{u}}{k_{d} + k_{u} K}}\n$$", "id": "4384434"}, {"introduction": "While some systems are robust, others are inherently fragile, poised near critical thresholds or 'tipping points'. This practice explores such fragility by analyzing a simple system that exhibits a bifurcation, where a small change in a parameter can cause the number of stable states to suddenly change. You will identify this critical point and compute the system's robustness margin, defined by the basin of attraction, providing a quantitative measure of how much perturbation the stable state can withstand before collapse [@problem_id:4384463].", "problem": "A single-species regulatory module is modeled at the phenomenological level by the one-dimensional ordinary differential equation (ODE) $$\\dot{x}=\\mu - x^{2},$$ where $x$ is the concentration of an effector species and $\\mu$ is a control parameter representing net production drive due to upstream signals and environmental conditions. The system is subject to instantaneous state perturbations along the $x$ coordinate (for example, a transient knockdown or overexpression pulse that displaces $x$ at $t=0$ but does not change $\\mu$).\n\nUsing only core definitions from dynamical systems theory for one-dimensional flows, answer the following:\n\n1. Determine the value of the parameter $\\mu$ at which the number of steady states changes. Your derivation must start from the definition of a steady state as a zero of the vector field and assess the qualitative change in the set of steady states as $\\mu$ varies.\n\n2. Define robustness of a steady state against instantaneous state perturbations as the minimal perturbation magnitude in $x$ required to drive the system from the stable steady state to trajectories that do not return to that steady state. Compute this minimal perturbation magnitude $\\Delta x_{\\text{crit}}(\\mu)$ as a function of $\\mu$ whenever a stable steady state exists. Your derivation must identify the basin boundary in state space and use the geometry of the flow to determine the escape condition.\n\nProvide your final answer as a two-entry row matrix containing the bifurcation parameter value and the robustness margin, in the form $\\left(\\mu_{c},\\,\\Delta x_{\\text{crit}}(\\mu)\\right)$. No rounding is required for this problem. Do not include units in your final answer.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. It is a standard exercise in one-dimensional dynamical systems theory and bifurcation analysis, directly applicable to phenomenological models in systems biology.\n\nThe analysis proceeds in two parts as requested.\n\n**Part 1: Determination of the Bifurcation Parameter Value**\n\nA steady state of the system, denoted by $x^*$, is a point in the state space where the rate of change of the state variable is zero. For the given one-dimensional ordinary differential equation (ODE), this condition is expressed as $\\dot{x} = 0$.\n\nThe governing equation is:\n$$\n\\dot{x} = f(x; \\mu) = \\mu - x^{2}\n$$\nwhere $x$ is the state variable and $\\mu$ is a control parameter.\n\nTo find the steady states, we set $\\dot{x} = 0$:\n$$\n\\mu - (x^*)^{2} = 0\n$$\nSolving for $x^*$, we obtain:\n$$\n(x^*)^{2} = \\mu\n$$\nThis equation determines the steady states as a function of the parameter $\\mu$. We must analyze the real solutions for $x^*$, as concentration must be a real quantity.\n\n1.  If $\\mu  0$, there are two distinct real steady states:\n    $$\n    x_{1,2}^* = \\pm\\sqrt{\\mu}\n    $$\n2.  If $\\mu = 0$, there is a single real steady state:\n    $$\n    x^* = 0\n    $$\n3.  If $\\mu  0$, there are no real solutions for $x^*$, meaning the system has no steady states.\n\nA qualitative change in the number of steady states occurs as the parameter $\\mu$ passes through the value where the number of real roots of the equation $(x^*)^2 = \\mu$ changes. This transition happens precisely at $\\mu = 0$. For $\\mu  0$, there are zero steady states. At $\\mu = 0$, one steady state appears. For $\\mu  0$, this single state splits into two distinct steady states. This type of bifurcation, where a pair of steady states (one stable, one unstable) is created, is known as a saddle-node bifurcation.\n\nTherefore, the value of the parameter $\\mu$ at which the number of steady states changes is $\\mu_c = 0$.\n\n**Part 2: Calculation of the Robustness Margin**\n\nFirst, we must identify the stable steady state for the system. The stability of a steady state $x^*$ in a one-dimensional system is determined by the sign of the derivative of the vector field, $f'(x^*) = \\frac{df}{dx}\\bigg|_{x=x^*}$. A steady state is stable if $f'(x^*)  0$ and unstable if $f'(x^*)  0$.\n\nThe derivative of $f(x; \\mu) = \\mu - x^2$ is:\n$$\nf'(x) = -2x\n$$\nA stable steady state exists only for $\\mu  0$, where we have two steady states, $x_1^* = \\sqrt{\\mu}$ and $x_2^* = -\\sqrt{\\mu}$. We evaluate the stability of each:\n\n1.  For $x_1^* = \\sqrt{\\mu}$:\n    $$\n    f'(\\sqrt{\\mu}) = -2\\sqrt{\\mu}\n    $$\n    Since $\\mu  0$, $\\sqrt{\\mu}  0$, and thus $f'(\\sqrt{\\mu})  0$. This steady state is **stable**. Let us denote it as $x^*_{\\text{stable}} = \\sqrt{\\mu}$.\n\n2.  For $x_2^* = -\\sqrt{\\mu}$:\n    $$\n    f'(-\\sqrt{\\mu}) = -2(-\\sqrt{\\mu}) = 2\\sqrt{\\mu}\n    $$\n    Since $\\mu  0$, $2\\sqrt{\\mu}  0$, and thus $f'(-\\sqrt{\\mu})  0$. This steady state is **unstable**. Let us denote it as $x^*_{\\text{unstable}} = -\\sqrt{\\mu}$.\n\nThe problem defines robustness, $\\Delta x_{\\text{crit}}(\\mu)$, as the minimal perturbation magnitude that drives the system from the stable steady state to a trajectory that does not return. This requires identifying the basin of attraction of the stable steady state $x^*_{\\text{stable}} = \\sqrt{\\mu}$.\n\nThe flow on the real line is governed by the sign of $\\dot{x} = \\mu - x^2$. The roots of this quadratic are $\\pm\\sqrt{\\mu}$.\n- For $x  \\sqrt{\\mu}$, $\\dot{x}  0$, so trajectories move towards $x^*_{\\text{stable}}$.\n- For $-\\sqrt{\\mu}  x  \\sqrt{\\mu}$, $\\dot{x}  0$, so trajectories move towards $x^*_{\\text{stable}}$.\n- For $x  -\\sqrt{\\mu}$, $\\dot{x}  0$, so trajectories move away from the interval $[-\\sqrt{\\mu}, \\infty)$ and towards $-\\infty$.\n\nThe unstable steady state $x^*_{\\text{unstable}} = -\\sqrt{\\mu}$ acts as a separatrix. It is the boundary of the basin of attraction for the stable steady state $x^*_{\\text{stable}}$. The basin of attraction for $x^*_{\\text{stable}}$ is the interval $(-\\sqrt{\\mu}, \\infty)$. A trajectory starting at any point $x_0  -\\sqrt{\\mu}$ will converge to $\\sqrt{\\mu}$. A trajectory starting at $x_0  -\\sqrt{\\mu}$ will escape to $-\\infty$.\n\nThe system is initially at the stable steady state $x^*_{\\text{stable}} = \\sqrt{\\mu}$. A perturbation $\\Delta x$ displaces the system to a new state $x_{\\text{new}} = \\sqrt{\\mu} + \\Delta x$.\nTo escape the basin of attraction, the perturbed state must be pushed to or past the basin boundary.\nA positive perturbation ($\\Delta x  0$) results in $x_{\\text{new}}  \\sqrt{\\mu}$, which is still within the basin of attraction. The system will simply relax back to $\\sqrt{\\mu}$.\nTherefore, an escape can only be caused by a negative perturbation ($\\Delta x  0$).\n\nThe critical condition for escape is when the perturbed state reaches the basin boundary:\n$$\nx_{\\text{new}} = x^*_{\\text{unstable}}\n$$\n$$\n\\sqrt{\\mu} + \\Delta x = -\\sqrt{\\mu}\n$$\nSolving for the critical perturbation, $\\Delta x_{\\text{crit}}$, we find:\n$$\n\\Delta x_{\\text{crit}} = -2\\sqrt{\\mu}\n$$\nThe problem asks for the minimal perturbation *magnitude*. The magnitude is the absolute value of this perturbation:\n$$\n|\\Delta x_{\\text{crit}}| = |-2\\sqrt{\\mu}|\n$$\nSince this analysis is valid for $\\mu  0$, $\\sqrt{\\mu}$ is real and positive. Thus, the magnitude is:\n$$\n\\Delta x_{\\text{crit}}(\\mu) = 2\\sqrt{\\mu}\n$$\nThis is the minimal perturbation magnitude required to move the system from $x=\\sqrt{\\mu}$ to the boundary of its basin of attraction, causing it to escape. This function is defined for $\\mu0$, which is precisely the condition for a stable steady state to exist.\n\nCombining the results for both parts, we have the bifurcation parameter value $\\mu_c = 0$ and the robustness margin $\\Delta x_{\\text{crit}}(\\mu) = 2\\sqrt{\\mu}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  2\\sqrt{\\mu} \\end{pmatrix}}\n$$", "id": "4384463"}, {"introduction": "The principles of robustness extend from simple motifs to the complex architecture of entire cellular networks. This practice introduces a powerful computational method, Flux Balance Analysis (FBA), to assess the robustness of a metabolic network's function in the face of genetic perturbations. By simulating gene knockouts and measuring their impact on the optimal growth rate, you will learn how to computationally quantify network-level robustness and identify critical components and redundant pathways [@problem_id:4384444].", "problem": "Consider a toy metabolic network analyzed by Flux Balance Analysis (FBA). Flux Balance Analysis (FBA) uses a steady-state mass balance model of metabolism to compute an optimal flux distribution that maximizes a specified objective (commonly biomass growth) subject to stoichiometric constraints and reaction bounds. The fundamental base is the law of mass conservation at steady state, encoded as the linear system constraint $$S \\, v = 0,$$ where $$S$$ is the stoichiometric matrix and $$v$$ is the vector of reaction fluxes. Each reaction flux $$v_i$$ is also constrained by lower and upper bounds $$\\ell_i \\le v_i \\le u_i$$. The objective is to maximize $$c^\\top v$$, where $$c$$ is the objective coefficient vector selecting the biomass-producing reaction. Gene knockouts are modeled by deleting reactions they control, implemented by setting the associated reaction bounds to $$0 \\le v_i \\le 0$$.\n\nThe network contains three internal metabolites $$A$$, $$B$$, and $$C$$, and five irreversible reactions $$R_1,\\dots,R_5$$ given by:\n- $$R_1$$: Uptake of $$A$$ into the cell, producing $$A$$ internally; this reaction is bounded above by the environment-dependent uptake limit $$U_A$$ and has lower bound $$0$$.\n- $$R_2$$: Conversion $$A \\to B$$.\n- $$R_3$$: Conversion $$B \\to C$$.\n- $$R_4$$: Conversion $$C \\to \\text{Biomass}$$; this is the biomass-producing reaction, which defines the growth rate.\n- $$R_5$$: Alternate shortcut $$A \\to C$$.\n\nThe stoichiometric matrix $$S \\in \\mathbb{R}^{3 \\times 5}$$ for internal metabolites $$A$$, $$B$$, $$C$$ and reactions $$R_1,\\dots,R_5$$ is\n$$\nS = \\begin{bmatrix}\n1  -1  0  0  -1 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  1\n\\end{bmatrix}.\n$$\nThe objective is to maximize the biomass flux, with objective vector\n$$\nc = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix}.\n$$\n\nAll reactions $$R_2, R_3, R_4, R_5$$ are irreversible with bounds $$0 \\le v_i \\le U_i$$, where $$U_i$$ is an upper bound parameter. Reaction $$R_1$$ has bounds $$0 \\le v_1 \\le U_A$$. Gene-to-reaction mapping is:\n- $$G_{\\text{upt}} \\mapsto R_1$$,\n- $$G_{A \\to B} \\mapsto R_2$$,\n- $$G_{B \\to C} \\mapsto R_3$$,\n- $$G_{C \\to Bio} \\mapsto R_4$$,\n- $$G_{A \\to C\\_\\text{alt}} \\mapsto R_5$$.\n\nFor a given environment, define the wild-type optimal growth rate $$z_{\\text{wt}} = \\max_{v} \\{ c^\\top v : S v = 0, \\ \\ell \\le v \\le u \\}$$ in units of per hour $$\\left(1/\\text{h}\\right)$$. For each single gene knockout $$g$$, delete its associated reaction(s) by setting their bounds to $$0 \\le v_i \\le 0$$, and compute $$z_g$$ under the same environment. Define the relative growth for knockout $$g$$ as $$r_g = z_g / z_{\\text{wt}}$$ when $$z_{\\text{wt}}  0$$, and by convention set $$r_g = 0$$ when $$z_{\\text{wt}} = 0$$ (to avoid division by zero). For a given environment, define the robustness metrics:\n- Minimal relative growth across knockouts $$r_{\\min} = \\min_g r_g$$,\n- Mean relative growth across knockouts $$\\bar{r} = \\frac{1}{N} \\sum_{g} r_g$$ for $$N$$ genes,\n- Fraction of knockouts with relative growth at or above a threshold $$\\alpha$$, namely $$f_\\alpha = \\frac{1}{N} \\left| \\{ g : r_g \\ge \\alpha \\} \\right|$$, expressed as a decimal.\n\nUse linear programming to solve each FBA problem. Angles are not used. All growth rates must be expressed in $$1/\\text{h}$$. The threshold is $$\\alpha = 0.5$$.\n\nTest Suite (each environment specifies upper bounds $$U_A, U_{R2}, U_{R3}, U_{R5}$$; all other reaction upper bounds are set to $$1000$$; all lower bounds are $$0$$):\n1. Environment $$1$$ (happy path with alternate route capacity-limited main path): $$U_A = 10$$, $$U_{R2} = 5$$, $$U_{R3} = 1000$$, $$U_{R5} = 1000$$.\n2. Environment $$2$$ (substrate-limited): $$U_A = 1$$, $$U_{R2} = 5$$, $$U_{R3} = 1000$$, $$U_{R5} = 1000$$.\n3. Environment $$3$$ (alternate route disabled): $$U_A = 10$$, $$U_{R2} = 5$$, $$U_{R3} = 1000$$, $$U_{R5} = 0$$.\n4. Environment $$4$$ (no substrate; boundary case): $$U_A = 0$$, $$U_{R2} = 5$$, $$U_{R3} = 1000$$, $$U_{R5} = 1000$$.\n\nYour program must compute, for each environment, the triple $$[r_{\\min}, \\bar{r}, f_\\alpha]$$ using the procedure above. The final output must be a single line containing the concatenated results for environments $$1$$ through $$4$$ in order, as a comma-separated list enclosed in square brackets, for example $$[x_1,x_2,\\dots,x_{12}]$$, where the entries are floats. All growth rates are in $$1/\\text{h}$$ and fractions are decimals in $$[0,1]$$. No other text should be printed.", "solution": "The goal is to characterize robustness of growth rate to single gene knockout using Flux Balance Analysis (FBA), grounded in the law of mass conservation and linear optimization. At steady state, intracellular metabolite concentrations satisfy $$S v = 0$$, where $$S$$ is the stoichiometric matrix and $$v$$ the flux vector. Each reaction flux $$v_i$$ is bounded by $$\\ell_i \\le v_i \\le u_i$$. The biomass growth rate is the objective $$c^\\top v$$, where $$c$$ selects the biomass reaction. Flux Balance Analysis is formulated as a linear program:\n$$\n\\text{maximize } c^\\top v \\quad \\text{subject to } S v = 0, \\ \\ell \\le v \\le u.\n$$\nThis can be solved via linear programming by minimizing $$-c^\\top v$$ subject to the same constraints.\n\nWe model gene knockouts by reaction deletions: if a gene controls reaction $$i$$, we set its bounds to $$0 \\le v_i \\le 0$$, removing its contribution. For each environment, we compute the wild-type optimal growth $$z_{\\text{wt}}$$, then for each gene $$g$$ we compute $$z_g$$ under the knockout and derive the relative growth $$r_g = z_g / z_{\\text{wt}}$$ if $$z_{\\text{wt}}  0$$, or set $$r_g = 0$$ otherwise.\n\nNetwork specification provides $$S$$ and $$c$$:\n$$\nS = \\begin{bmatrix}\n1  -1  0  0  -1 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  1\n\\end{bmatrix}, \\quad\nc = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix}.\n$$\nReactions $$R_1,\\dots,R_5$$ represent uptake, pathway steps, the biomass reaction, and an alternative shortcut. All are irreversible with lower bounds $$\\ell_i = 0$$, and upper bounds defined per environment: $$u_1 = U_A$$, $$u_2 = U_{R2}$$, $$u_3 = U_{R3}$$, $$u_4 = 1000$$, $$u_5 = U_{R5}$$. Genes map to reactions as $$G_{\\text{upt}} \\mapsto R_1$$, $$G_{A \\to B} \\mapsto R_2$$, $$G_{B \\to C} \\mapsto R_3$$, $$G_{C \\to Bio} \\mapsto R_4$$, $$G_{A \\to C\\_\\text{alt}} \\mapsto R_5$$.\n\nFor each environment, the procedure is:\n1. Formulate the wild-type linear program: minimize $$-c^\\top v$$ subject to $$S v = 0$$ and bounds $$\\ell \\le v \\le u$$. Solve to obtain $$z_{\\text{wt}} = c^\\top v^\\star$$, the optimal biomass flux in $$1/\\text{h}$$.\n2. For each gene knockout, modify bounds for associated reactions to $$0 \\le v_i \\le 0$$, solve the linear program to obtain $$z_g$$, then compute $$r_g$$. If $$z_{\\text{wt}} = 0$$, set all $$r_g = 0$$ to avoid division by zero and to represent no growth baseline.\n3. Compute robustness metrics: $$r_{\\min} = \\min_g r_g$$, $$\\bar{r} = \\frac{1}{N} \\sum_g r_g$$ with $$N = 5$$ genes, and $$f_\\alpha = \\frac{1}{N} \\left| \\{ g : r_g \\ge \\alpha \\} \\right|$$ with $$\\alpha = 0.5$$.\n\nScientific interpretation for the chosen test environments:\n- Environment $$1$$ with $$U_A = 10$$ and $$U_{R2} = 5$$ allows the main path $$A \\to B \\to C \\to \\text{Biomass}$$ to carry at most $$5$$ units through $$R_2$$, but the alternate $$A \\to C$$ path can supplement up to $$1000$$, enabling total uptake-driven growth; thus most knockouts are nonessential except uptake and biomass conversion. Deleting the alternate path reduces achievable growth when $$U_A$$ exceeds the main path bottleneck, yielding a relative growth of $$0.5$$ for that knockout.\n- Environment $$2$$ with $$U_A = 1$$ is substrate-limited; the alternate path is not needed because the main path capacity exceeds substrate availability, so alternate path deletion has no effect.\n- Environment $$3$$ disables the alternate path with $$U_{R5} = 0$$; the main path bottleneck at $$U_{R2} = 5$$ caps wild-type growth at $$5$$ even when $$U_A = 10$$, and knockouts of the main path steps cause zero growth, reflecting fragility.\n- Environment $$4$$ has no substrate with $$U_A = 0$$; wild-type growth is zero, and by convention relative growths are set to $$0$$.\n\nAlgorithmic implementation uses linear programming (for example, the Highs methods in standard solvers) to solve each optimization reliably. The final program computes the metrics for all environments and prints a single-line comma-separated list $$[r_{\\min}^{(1)}, \\bar{r}^{(1)}, f_\\alpha^{(1)}, r_{\\min}^{(2)}, \\bar{r}^{(2)}, f_\\alpha^{(2)}, r_{\\min}^{(3)}, \\bar{r}^{(3)}, f_\\alpha^{(3)}, r_{\\min}^{(4)}, \\bar{r}^{(4)}, f_\\alpha^{(4)}]$$. All growth rates are expressed in $$1/\\text{h}$$ and fractions are decimals.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef fba_optimal_growth(S, c, bounds):\n    \"\"\"\n    Solve the FBA problem: maximize c^T v subject to S v = 0 and bounds.\n    Implemented as minimizing -c^T v.\n    Returns the optimal objective value (growth rate) and the flux vector.\n    \"\"\"\n    # Convert maximization to minimization\n    obj = -c  # minimize -c^T v\n    A_eq = S\n    b_eq = np.zeros(S.shape[0])\n\n    # SciPy linprog expects bounds as a list of (lower, upper) for each variable\n    res = linprog(c=obj, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method=\"highs\")\n    if res.success:\n        growth = float(c @ res.x)\n        return growth, res.x\n    else:\n        # Infeasible or failed optimization implies zero growth in this simplified context\n        return 0.0, np.zeros(S.shape[1])\n\ndef robustness_metrics_for_environment(U_A, U_R2, U_R3, U_R5, alpha=0.5):\n    \"\"\"\n    Compute robustness metrics (min relative growth, mean relative growth, fraction = alpha)\n    for a given environment defined by upper bounds.\n    \"\"\"\n    # Stoichiometric matrix S (3 metabolites x 5 reactions)\n    S = np.array([\n        [1, -1,  0,  0, -1],  # A balance: R1 produces A; R2 and R5 consume A\n        [0,  1, -1,  0,  0],  # B balance: R2 produces B; R3 consumes B\n        [0,  0,  1, -1,  1],  # C balance: R3 produces C; R4 consumes C; R5 produces C\n    ], dtype=float)\n\n    # Objective: maximize v4 (biomass)\n    c = np.array([0, 0, 0, 1, 0], dtype=float)\n\n    # Default upper bounds\n    U_R4 = 1000.0  # Biomass reaction upper bound\n    # Lower bounds are zero for all reactions (irreversible)\n    lb = [0.0, 0.0, 0.0, 0.0, 0.0]\n    ub = [float(U_A), float(U_R2), float(U_R3), float(U_R4), float(U_R5)]\n    bounds_wt = list(zip(lb, ub))\n\n    # Wild-type optimal growth\n    z_wt, _ = fba_optimal_growth(S, c, bounds_wt)\n\n    # Gene to reaction index mapping\n    gene_to_rxn = {\n        \"G_upt\": 0,         # R1\n        \"G_AtoB\": 1,        # R2\n        \"G_BtoC\": 2,        # R3\n        \"G_CtoBio\": 3,      # R4\n        \"G_AtoC_alt\": 4,    # R5\n    }\n\n    # Compute growth under each single gene knockout\n    rel_growths = []\n    genes = [\"G_upt\", \"G_AtoB\", \"G_BtoC\", \"G_CtoBio\", \"G_AtoC_alt\"]\n    for g in genes:\n        rxn_idx = gene_to_rxn[g]\n        bounds_ko = bounds_wt.copy()\n        bounds_ko[rxn_idx] = (0.0, 0.0)  # delete the reaction\n        z_ko, _ = fba_optimal_growth(S, c, bounds_ko)\n        if z_wt > 0.0:\n            rel_growths.append(z_ko / z_wt)\n        else:\n            # By convention when wild-type growth is zero, set relative growth to zero\n            rel_growths.append(0.0)\n\n    rel_growths = np.array(rel_growths, dtype=float)\n    r_min = float(np.min(rel_growths))\n    r_mean = float(np.mean(rel_growths))\n    frac_alpha = float(np.mean(rel_growths >= alpha))\n\n    return r_min, r_mean, frac_alpha\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is (U_A, U_R2, U_R3, U_R5)\n    test_cases = [\n        (10.0, 5.0, 1000.0, 1000.0),  # Environment 1\n        (1.0, 5.0, 1000.0, 1000.0),   # Environment 2\n        (10.0, 5.0, 1000.0, 0.0),     # Environment 3\n        (0.0, 5.0, 1000.0, 1000.0),   # Environment 4\n    ]\n\n    alpha = 0.5\n    results = []\n    for U_A, U_R2, U_R3, U_R5 in test_cases:\n        rmin, rmean, frac = robustness_metrics_for_environment(U_A, U_R2, U_R3, U_R5, alpha=alpha)\n        results.extend([rmin, rmean, frac])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4384444"}]}