{"hands_on_practices": [{"introduction": "This exercise provides a foundational look into how cellular states can be modeled as attractors in a dynamical system. By analyzing a simple one-dimensional ordinary differential equation, you will practice the core techniques of identifying fixed points and classifying their stability. This hands-on analysis is crucial for understanding how the state space is partitioned into basins of attraction, which ultimately determine cellular fate based on initial conditions [@problem_id:4326573].", "problem": "Consider a well-mixed population of cells whose macroscopic phenotype can be represented by a single, dimensionless state variable $x \\in \\mathbb{R}$ that summarizes the activity of a regulatory program (for example, a normalized gene expression module). Assume that the temporal evolution of $x$ for each cell is governed by the autonomous Ordinary Differential Equation (ODE)\n$$\n\\frac{dx}{dt} \\;=\\; x\\,(1 - x)\\,(x - a),\n$$\nwhere the parameter $a \\in (0,1)$ encodes a tunable biochemical threshold. In systems biomedicine, cellular states correspond to fixed points (equilibria) of the state dynamics, their stability determines phenotypic robustness, and basins of attraction partition initial conditions according to their long-term fates.\n\nUsing only fundamental definitions from one-dimensional dynamical systems and the notion of linearization near fixed points, do the following:\n\n1. Derive the fixed points of the system from the definition of equilibrium ($dx/dt = 0$).\n2. Classify the stability (stable versus unstable) of each fixed point by analyzing the sign of the linearized flow near each fixed point.\n3. Identify the basins of attraction associated with each stable fixed point by determining the sign of the vector field across the real line.\n\nFinally, assume that the initial cell states $x(0)$ are supported on the interval $[0,1]$ and are independently drawn from a Beta distribution with shape parameters $\\alpha  0$ and $\\beta  0$, having probability density\n$$\n\\rho(x) \\;=\\; \\frac{x^{\\alpha - 1}\\,(1 - x)^{\\beta - 1}}{B(\\alpha,\\beta)} \\quad \\text{for } x \\in [0,1],\n$$\nwhere $B(\\alpha,\\beta) = \\displaystyle \\int_{0}^{1} t^{\\alpha - 1}\\,(1 - t)^{\\beta - 1}\\,dt$ is the Euler Beta function. Let $B_{z}(\\alpha,\\beta) = \\displaystyle \\int_{0}^{z} t^{\\alpha - 1}\\,(1 - t)^{\\beta - 1}\\,dt$ denote the (unregularized) incomplete Beta function. Compute, in closed form, the fraction of initial states in $[0,1]$ that converge to the high-expression state $x = 1$ as a function of $a$, $\\alpha$, and $\\beta$. Express your final answer as a single analytic expression. Do not provide intermediate results in your final answer. No rounding is required, and there are no physical units to report.", "solution": "The problem is well-posed, scientifically grounded, and presents a complete set of givens. It is a standard problem in one-dimensional dynamical systems with an application to population dynamics in systems biology. Therefore, we proceed with the solution.\n\nThe temporal evolution of the cellular state variable $x$ is governed by the ordinary differential equation:\n$$\n\\frac{dx}{dt} = f(x) = x(1 - x)(x - a)\n$$\nwhere $a \\in (0,1)$ is a parameter.\n\n**1. Derivation of Fixed Points**\n\nBy definition, fixed points (or equilibria) of the system are the values of $x$, denoted $x^*$, for which the rate of change is zero. We set $\\frac{dx}{dt} = 0$:\n$$\nx^*(1 - x^*)(x^* - a) = 0\n$$\nThe solutions to this equation are the roots of the polynomial on the left-hand side. By inspection, the fixed points are:\n$$\nx_1^* = 0\n$$\n$$\nx_2^* = a\n$$\n$$\nx_3^* = 1\n$$\n\n**2. Classification of Fixed Point Stability**\n\nThe stability of a one-dimensional fixed point $x^*$ is determined by the sign of the derivative of the vector field, $f'(x) = \\frac{df}{dx}$, evaluated at $x^*$. A fixed point is stable if $f'(x^*)  0$ and unstable if $f'(x^*)  0$.\n\nFirst, we compute the derivative of $f(x)$. Let's expand $f(x)$ for easier differentiation:\n$$\nf(x) = (x - x^2)(x - a) = x^2 - ax - x^3 + ax^2 = -x^3 + (1+a)x^2 - ax\n$$\nThe derivative is:\n$$\nf'(x) = \\frac{d}{dx} \\left( -x^3 + (1+a)x^2 - ax \\right) = -3x^2 + 2(1+a)x - a\n$$\nNow, we evaluate $f'(x)$ at each of the three fixed points.\n\n- **For $x_1^* = 0$**:\n$$\nf'(0) = -3(0)^2 + 2(1+a)(0) - a = -a\n$$\nSince it is given that $a \\in (0,1)$, we have $a  0$, and therefore $f'(0)  0$. The fixed point at $x^* = 0$ is **stable**.\n\n- **For $x_3^* = 1$**:\n$$\nf'(1) = -3(1)^2 + 2(1+a)(1) - a = -3 + 2 + 2a - a = a - 1\n$$\nSince $a \\in (0,1)$, we have $a  1$, and therefore $f'(1)  0$. The fixed point at $x^* = 1$ is **stable**. This is the \"high-expression state\" mentioned in the problem.\n\n- **For $x_2^* = a$**:\n$$\nf'(a) = -3a^2 + 2(1+a)a - a = -3a^2 + 2a + 2a^2 - a = a - a^2 = a(1-a)\n$$\nSince $a \\in (0,1)$, both $a  0$ and $1-a  0$. Thus, their product $f'(a) = a(1-a)  0$. The fixed point at $x^* = a$ is **unstable**.\n\n**3. Identification of Basins of Attraction**\n\nThe fixed points $0$, $a$, and $1$ partition the real line. The unstable fixed point $x^* = a$ acts as a separatrix, dividing the state space into regions that flow towards different stable attractors. To determine the basins of attraction, we analyze the sign of $\\frac{dx}{dt} = f(x)$ in the intervals between the fixed points.\n\n- For $x \\in (a, 1)$: Here $x  0$, $1-x  0$, and $x-a  0$. Thus, $f(x) = (+)(+)(+)  0$. The flow is to the right, so any initial condition in $(a,1)$ will converge to $x=1$.\n- For $x \\in (0, a)$: Here $x  0$, $1-x  0$, and $x-a  0$. Thus, $f(x) = (+)(+)(-)  0$. The flow is to the left, so any initial condition in $(0,a)$ will converge to $x=0$.\n- For $x  1$: Here $x  0$, $1-x  0$, and $x-a  0$. Thus, $f(x) = (+)(-)(+)  0$. The flow is to the left, so any initial condition in $(1, \\infty)$ will converge to $x=1$.\n- For $x  0$: Here $x  0$, $1-x  0$, and $x-a  0$. Thus, $f(x) = (-)(+)(-)  0$. The flow is to the right, so any initial condition in $(-\\infty, 0)$ will converge to $x=0$.\n\nThe basin of attraction for the stable fixed point at $x^*=0$ is $(-\\infty, a)$.\nThe basin of attraction for the stable fixed point at $x^*=1$ (the high-expression state) is $(a, \\infty)$.\n\n**4. Computation of the Fraction Converging to the High-Expression State**\n\nThe problem asks for the fraction of initial cell states that converge to the high-expression state $x=1$. These are the initial states $x(0)$ that lie within the basin of attraction of $x=1$, which is the interval $(a, \\infty)$.\n\nThe initial states are drawn from a Beta distribution with probability density function $\\rho(x)$, which is non-zero only on the interval $[0,1]$. Therefore, we are interested in the fraction of the initial population whose state $x(0)$ lies in the intersection of the basin of attraction and the support of the distribution: $(a, \\infty) \\cap [0,1]$. Since $a \\in (0,1)$, this intersection is the interval $(a, 1]$.\n\nThe fraction of cells, $F$, that converge to $x=1$ is the probability that $x(0) \\in (a, 1]$. This probability is found by integrating the PDF $\\rho(x)$ over this interval:\n$$\nF = P(a  x \\le 1) = \\int_a^1 \\rho(x) \\, dx\n$$\nSubstituting the given expression for $\\rho(x)$:\n$$\nF = \\int_a^1 \\frac{x^{\\alpha - 1}(1 - x)^{\\beta - 1}}{B(\\alpha,\\beta)} \\, dx = \\frac{1}{B(\\alpha,\\beta)} \\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx\n$$\nThe integral $\\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx$ can be expressed using the definitions of the complete and incomplete Beta functions. We know that:\n$$\n\\int_0^1 t^{\\alpha - 1}(1 - t)^{\\beta - 1} \\, dt = B(\\alpha,\\beta)\n$$\nAnd\n$$\n\\int_0^a t^{\\alpha - 1}(1 - t)^{\\beta - 1} \\, dt = B_a(\\alpha,\\beta)\n$$\nWe can write the integral from $a$ to $1$ as:\n$$\n\\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx = \\int_0^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx - \\int_0^a x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx\n$$\nSubstituting the definitions:\n$$\n\\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx = B(\\alpha,\\beta) - B_a(\\alpha,\\beta)\n$$\nFinally, we substitute this result back into the expression for the fraction $F$:\n$$\nF = \\frac{1}{B(\\alpha,\\beta)} \\left( B(\\alpha,\\beta) - B_a(\\alpha,\\beta) \\right) = 1 - \\frac{B_a(\\alpha,\\beta)}{B(\\alpha,\\beta)}\n$$\nThis is the final closed-form expression for the fraction of initial states that converge to the high-expression state $x=1$.", "answer": "$$\n\\boxed{1 - \\frac{B_{a}(\\alpha, \\beta)}{B(\\alpha, \\beta)}}\n$$", "id": "4326573"}, {"introduction": "Building on the concept of stable states, this practice explores their origin through the lens of a classic genetic toggle switch. You will analyze how a simple circuit of two mutually repressing genes can give rise to bistability, a hallmark of binary cell-fate decisions. The core task involves deriving the critical condition for a symmetry-breaking bifurcation, a fundamental mechanism by which a system transitions from a single stable state to two distinct, stable states [@problem_id:4326416].", "problem": "Consider a symmetric two-gene mutually repressive module, modeled at the level of coarse-grained protein concentrations by the following system of coupled ordinary differential equations (ODEs):\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1 + y^{n}} \\;-\\; x, \\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha}{1 + x^{n}} \\;-\\; y,\n$$\nwhere $x$ and $y$ denote dimensionless concentrations of two transcription factors that repress each other, $\\alpha  0$ is a dimensionless maximal synthesis parameter scaled by the degradation rate, and $n \\geq 1$ is the Hill cooperativity index of repression. The system is symmetric under the exchange $x \\leftrightarrow y$, and cellular states correspond to the steady states of this dynamical system, with cellular state transitions corresponding to bifurcations of these steady states under parameter variation.\n\nStarting from the fundamental definitions of steady states as solutions satisfying $\\frac{dx}{dt} = 0$ and $\\frac{dy}{dt} = 0$, and linear stability analysis via the Jacobian matrix of the right-hand side evaluated at a steady state, derive the steady-state equations and characterize their intersections. Then, using linearization and eigenvalue-based stability criteria, determine the condition under which the symmetric steady state loses stability to a pair of asymmetric steady states through a symmetry-breaking bifurcation. Based on this, identify the parameter regimes that produce bistability (two stable asymmetric states coexisting with an unstable symmetric state).\n\nExpress your final result as an exact, closed-form analytic expression for the critical synthesis parameter $\\alpha_{\\mathrm{crit}}(n)$ as a function of the Hill coefficient $n$, which marks the onset of bistability of the symmetric equilibrium. No numerical approximation is required, and no units are necessary because the problem is fully dimensionless. Your final boxed answer must be a single analytic expression.", "solution": "The problem is valid. It is a well-posed, scientifically grounded problem from the field of systems biology, asking for the derivation of a bifurcation condition for a classic model of a genetic toggle switch.\n\nThe system of ordinary differential equations (ODEs) describing the dynamics of the two protein concentrations $x$ and $y$ is given by:\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y\n$$\nwhere $\\alpha  0$ and $n \\geq 1$ are parameters.\n\nFirst, we determine the steady states $(x^*, y^*)$ of the system by setting the time derivatives to zero: $\\frac{dx}{dt} = 0$ and $\\frac{dy}{dt} = 0$. This yields the following pair of algebraic equations, which define the nullclines of the system:\n$$\nx^* = \\frac{\\alpha}{1 + (y^*)^n} \\quad (1)\n$$\n$$\ny^* = \\frac{\\alpha}{1 + (x^*)^n} \\quad (2)\n$$\nThe steady states are the intersection points of these two nullclines.\n\nDue to the symmetry of the equations under the exchange $x \\leftrightarrow y$, we can seek a symmetric steady state where $x^* = y^*$. Let us denote this symmetric state concentration as $x_s$. Substituting $y^* = x_s$ and $x^* = x_s$ into equation (1) gives:\n$$\nx_s = \\frac{\\alpha}{1 + x_s^n}\n$$\nThis equation can be rearranged to define $x_s$ implicitly as a function of the parameters $\\alpha$ and $n$:\n$$\nx_s(1 + x_s^n) = \\alpha\n$$\nFor $\\alpha  0$ and $n \\ge 1$, the function $f(x_s) = x_s(1+x_s^n)$ is monotonically increasing for $x_s \\ge 0$, which guarantees the existence of a unique symmetric steady state for any given $\\alpha$.\n\nNext, we perform linear stability analysis to determine the conditions under which this symmetric steady state is stable. The stability is determined by the eigenvalues of the Jacobian matrix $J$ of the system, evaluated at the steady state $(x_s, x_s)$. The vector field is given by $F(x,y) = (\\frac{\\alpha}{1 + y^{n}} - x, \\frac{\\alpha}{1 + x^{n}} - y)$. The Jacobian matrix is:\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1 + y^{n}} - x)  \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1 + y^{n}} - x) \\\\ \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1 + x^{n}} - y)  \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1 + x^{n}} - y) \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\alpha n y^{n-1}}{(1 + y^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{(1 + x^n)^2}  -1 \\end{pmatrix}\n$$\nEvaluating this matrix at the symmetric steady state $(x_s, x_s)$:\n$$\nJ_s = J(x_s, x_s) = \\begin{pmatrix} -1  -\\frac{\\alpha n x_s^{n-1}}{(1 + x_s^n)^2} \\\\ -\\frac{\\alpha n x_s^{n-1}}{(1 + x_s^n)^2}  -1 \\end{pmatrix}\n$$\nTo simplify the off-diagonal terms, we use the steady-state relation $\\alpha = x_s(1 + x_s^n)$. Substituting this into the off-diagonal elements gives:\n$$\n-\\frac{\\alpha n x_s^{n-1}}{(1 + x_s^n)^2} = -\\frac{x_s(1 + x_s^n) n x_s^{n-1}}{(1 + x_s^n)^2} = -\\frac{n x_s^n}{1 + x_s^n}\n$$\nLet's define a dimensionless quantity $\\beta = \\frac{n x_s^n}{1 + x_s^n}$. The Jacobian at the symmetric steady state becomes:\n$$\nJ_s = \\begin{pmatrix} -1  -\\beta \\\\ -\\beta  -1 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $J_s$ are the roots of the characteristic equation $\\det(J_s - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -1 - \\lambda  -\\beta \\\\ -\\beta  -1 - \\lambda \\end{pmatrix} = (-1 - \\lambda)^2 - (-\\beta)^2 = (1 + \\lambda)^2 - \\beta^2 = 0\n$$\nThis gives $1 + \\lambda = \\pm \\beta$, so the two eigenvalues are:\n$$\n\\lambda_1 = -1 - \\beta\n$$\n$$\n\\lambda_2 = -1 + \\beta\n$$\nFor the steady state to be stable, the real part of all eigenvalues must be negative. Since $n \\ge 1$ and $x_s  0$ (as $\\alpha  0$), we have $\\beta = \\frac{n x_s^n}{1 + x_s^n}  0$. Consequently, $\\lambda_1 = -1 - \\beta$ is always negative. The stability of the symmetric state is therefore determined entirely by the sign of $\\lambda_2$.\nThe state is stable if $\\lambda_2  0$, which means $-1 + \\beta  0$, or $\\beta  1$.\nThe state becomes unstable if $\\lambda_2  0$, which means $-1 + \\beta  0$, or $\\beta  1$.\n\nA symmetry-breaking bifurcation occurs when the symmetric steady state loses its stability. This happens precisely at the point where $\\lambda_2$ crosses zero, i.e., $\\lambda_2 = 0$. This critical condition is $\\beta = 1$. Substituting the expression for $\\beta$:\n$$\n\\frac{n x_s^n}{1 + x_s^n} = 1\n$$\n$$\nn x_s^n = 1 + x_s^n\n$$\n$$\n(n - 1) x_s^n = 1\n$$\nThis equation only has a solution for $x_s  0$ if $n-1  0$, i.e., $n  1$. For $n=1$, we have $\\beta = \\frac{x_s}{1+x_s}  1$ for all $x_s  0$, so the symmetric state is always stable and no bistability occurs. For the bifurcation to exist, we require $n  1$.\nSolving for the steady state value $x_s$ at the bifurcation point:\n$$\nx_s^n = \\frac{1}{n-1} \\implies x_s = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}\n$$\nThe problem asks for the critical synthesis parameter $\\alpha_{\\mathrm{crit}}(n)$ that marks this bifurcation. We can find this by substituting the critical value of $x_s$ back into the steady-state equation $\\alpha = x_s(1 + x_s^n)$.\n$$\n\\alpha_{\\mathrm{crit}}(n) = (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\nSimplifying the term in the parenthesis:\n$$\n1 + \\frac{1}{n-1} = \\frac{n-1 + 1}{n-1} = \\frac{n}{n-1}\n$$\nSubstituting this back, we obtain the final expression for $\\alpha_{\\mathrm{crit}}(n)$:\n$$\n\\alpha_{\\mathrm{crit}}(n) = (n-1)^{-1/n} \\left(\\frac{n}{n-1}\\right) = \\frac{n}{(n-1)^{1} (n-1)^{1/n}} = \\frac{n}{(n-1)^{1 + 1/n}}\n$$\nThis can be written as:\n$$\n\\alpha_{\\mathrm{crit}}(n) = \\frac{n}{(n-1)^{\\frac{n+1}{n}}}\n$$\nFor $\\alpha  \\alpha_{\\mathrm{crit}}(n)$, the system exhibits bistability, with two stable asymmetric states and one unstable symmetric state. For $\\alpha  \\alpha_{\\mathrm{crit}}(n)$ (and $n  1$), the system is monostable, with a single stable symmetric state. The value $\\alpha_{\\mathrm{crit}}(n)$ thus marks the onset of bistability.", "answer": "$$\\boxed{\\frac{n}{(n-1)^{\\frac{n+1}{n}}}}$$", "id": "4326416"}, {"introduction": "This practice shifts our focus from deterministic dynamics to the essential role of stochasticity in driving state transitions. We will conceptualize cellular states as valleys in an effective potential landscape and model transitions as noise-driven barrier crossings, described by a Langevin equation. You will derive the steady-state probability distribution and apply Kramers' theory to estimate the rate of switching between states, connecting microscopic fluctuations to macroscopic cellular behavior [@problem_id:4326517].", "problem": "In systems biomedicine, coarse-grained cellular states can be represented as basins of attraction (stable minima) on an effective epigenetic landscape, and noise-driven state transitions can be modeled as stochastic barrier crossings. Consider a one-dimensional effective potential describing two cellular states,\n$$\nU(x) = \\frac{x^4}{4} - \\frac{x^2}{2},\n$$\nand an overdamped stochastic dynamics for a scalar state variable $x(t)$ governed by the Langevin Stochastic Differential Equation (SDE),\n$$\ndx_t = -U'(x_t)\\,dt + \\sigma\\,dW_t,\n$$\nwhere $U'(x)$ is the derivative of $U(x)$, $\\sigma$ is the noise amplitude, and $W_t$ is a standard Wiener process. The corresponding Fokker–Planck Equation (FPE) for the probability density $p(x,t)$ is a well-tested description of the time evolution of $p(x,t)$.\n\nTask:\n1. Starting strictly from the FPE associated to the given SDE and the condition of zero stationary probability flux, derive the steady-state probability density $p_{\\mathrm{ss}}(x)$ up to a multiplicative constant. Do not assume any shortcut formula; derive from first principles (FPE and flux balance).\n2. Using a numerical discretization on a symmetric finite interval $[-L,L]$ with $L$ chosen to ensure negligible tail probability for all test cases, normalize the derived $p_{\\mathrm{ss}}(x)$ and compute integrals over regions that correspond to the barrier and the two wells. Use $L$ large enough to make the numerical normalization accurate; set $L = 3.5$ and discretize $[-L,L]$ uniformly with $N = 100001$ grid points.\n3. Using Kramers’ approximation for overdamped barrier crossing in the small-noise regime, derive the transition rate between the two wells in terms of the potential curvature at the minimum and at the barrier top and the barrier height. Start from the classical assumptions and derive the approximation; do not use an unmotivated shortcut formula.\n4. Implement a program that performs the following for each specified value of $\\sigma$:\n   - Numerically construct the unnormalized $p_{\\mathrm{ss}}(x)$ from the derived expression and normalize it on $[-L,L]$.\n   - Compute the probability mass in the barrier region defined by $\\{|x| \\le r\\}$ with $r = 0.25$.\n   - Compute the probability mass in the left well region defined by $\\{x  -r\\}$ and in the right well region defined by $\\{x  r\\}$.\n   - Compute the Kramers transition rate between wells from your derived approximation in the overdamped limit.\n\nFundamental base to use:\n- The overdamped Langevin SDE $dx_t = -U'(x_t)\\,dt + \\sigma\\,dW_t$.\n- The associated Fokker–Planck Equation for $p(x,t)$.\n- The concept of stationary zero-flux solutions for the FPE.\n- The classical small-noise overdamped Kramers approximation that relates transition rates to barrier height and local curvatures.\n\nTest suite:\n- Case $1$: $\\sigma = 0.05$.\n- Case $2$: $\\sigma = 0.20$.\n- Case $3$: $\\sigma = 0.70$.\n\nFor each test case, your program must output a list containing, in order: the Kramers rate (float), the barrier-region probability mass (float), the left-region probability mass (float), and the right-region probability mass (float). Aggregate the lists for all three test cases into a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\texttt{[[a,b,c,d],[e,f,g,h],[i,j,k,l]]}$. No physical units are required and no angles are involved; all outputs are dimensionless floats.", "solution": "The problem is a valid exercise in stochastic dynamics and statistical physics, specifically addressing the modeling of state transitions in a bistable system. We will first perform the required theoretical derivations and then outline the numerical implementation. Every mathematical expression, including all variables, numbers, and symbols, will be typeset in LaTeX.\n\nThe system's state is described by the scalar variable $x(t)$, whose dynamics are governed by the overdamped Langevin equation:\n$$\ndx_t = -U'(x_t)\\,dt + \\sigma\\,dW_t\n$$\nThe potential is a symmetric double-well potential given by:\n$$\nU(x) = \\frac{x^4}{4} - \\frac{x^2}{2}\n$$\nThe derivative of the potential, which represents the deterministic force, is $U'(x) = x^3 - x$.\n\n### 1. Derivation of the Steady-State Probability Density\n\nThe time evolution of the probability density $p(x,t)$ of the state variable $x$ is described by the Fokker-Planck Equation (FPE). For a general 1D Langevin equation $dx_t = A(x_t)dt + B(x_t)dW_t$, the FPE is:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [A(x)p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [B(x)^2 p(x,t)]\n$$\nIn our case, the drift term is $A(x) = -U'(x)$ and the diffusion term is a constant, $B(x) = \\sigma$. Substituting these into the FPE yields:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [-U'(x)p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [\\sigma^2 p(x,t)]\n$$\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\frac{\\partial}{\\partial x} [U'(x)p(x,t)] + \\frac{\\sigma^2}{2}\\frac{\\partial^2 p(x,t)}{\\partial x^2}\n$$\nThis equation can be written as a continuity equation, $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$, where $J(x,t)$ is the probability flux. By factoring out one partial derivative with respect to $x$, we identify the flux:\n$$\n\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ -U'(x)p(x,t) - \\frac{\\sigma^2}{2}\\frac{\\partial p(x,t)}{\\partial x} \\right]\n$$\nSo, the probability flux is:\n$$\nJ(x,t) = -U'(x)p(x,t) - \\frac{\\sigma^2}{2}\\frac{\\partial p(x,t)}{\\partial x}\n$$\nAt steady state, the probability density becomes time-independent, $p_{\\mathrm{ss}}(x)$, so $\\frac{\\partial p}{\\partial t} = 0$. This implies that the steady-state flux, $J_{\\mathrm{ss}}(x)$, must be constant with respect to $x$, i.e., $\\frac{\\partial J_{\\mathrm{ss}}}{\\partial x} = 0$.\n\nThe problem specifies the condition of \"zero stationary probability flux,\" which corresponds to a system in thermal equilibrium with detailed balance. Setting $J_{\\mathrm{ss}}(x) = 0$:\n$$\n-U'(x)p_{\\mathrm{ss}}(x) - \\frac{\\sigma^2}{2}\\frac{dp_{\\mathrm{ss}}(x)}{dx} = 0\n$$\nThis is a first-order separable ordinary differential equation for $p_{\\mathrm{ss}}(x)$. We rearrange it to solve for $p_{\\mathrm{ss}}(x)$:\n$$\n\\frac{dp_{\\mathrm{ss}}}{p_{\\mathrm{ss}}} = -\\frac{2U'(x)}{\\sigma^2} dx\n$$\nIntegrating both sides gives:\n$$\n\\int \\frac{1}{p_{\\mathrm{ss}}} dp_{\\mathrm{ss}} = -\\frac{2}{\\sigma^2} \\int U'(x) dx\n$$\n$$\n\\ln(p_{\\mathrm{ss}}(x)) = -\\frac{2}{\\sigma^2} U(x) + C'\n$$\nwhere $C'$ is the constant of integration. Exponentiating both sides, we obtain the unnormalized steady-state probability density:\n$$\np_{\\mathrm{ss}}(x) = e^{C'} \\exp\\left(-\\frac{2U(x)}{\\sigma^2}\\right)\n$$\nThis is the Boltzmann-Gibbs distribution. Letting $C = e^{C'}$ be a normalization constant, we have:\n$$\np_{\\mathrm{ss}}(x) = C \\exp\\left(-\\frac{2U(x)}{\\sigma^2}\\right)\n$$\nThe constant $C$ is determined by the normalization condition $\\int_{-\\infty}^{\\infty} p_{\\mathrm{ss}}(x) dx = 1$. The unnormalized distribution is $\\tilde{p}_{\\mathrm{ss}}(x) = \\exp\\left(-\\frac{2U(x)}{\\sigma^2}\\right)$.\n\n### 2. Derivation of the Kramers Transition Rate\n\nKramers' theory provides an approximation for the rate of escape from a metastable state (a potential well) by thermal activation over a potential barrier. The theory is valid in the small-noise regime, where the thermal energy is much smaller than the barrier height. In our Langevin equation, the friction coefficient is $\\gamma=1$ and the diffusion coefficient is $D = \\sigma^2/2$. The small-noise condition is $\\Delta U \\gg D$, or $2\\Delta U / \\sigma^2 \\gg 1$.\n\nThe transition rate $k$ is defined as the probability flux out of a well divided by the population within that well, $k = J/N_A$. We consider the transition from the left well (A) to the right well (B). The steady-state flux $J$ is constant. From the flux equation, we have:\n$$\nJ = -U'(x)p(x) - \\frac{\\sigma^2}{2}\\frac{dp(x)}{dx}\n$$\nWe can rearrange and multiply by an integrating factor $e^{2U(x)/\\sigma^2}$:\n$$\nJ e^{2U(x)/\\sigma^2} = -p(x)U'(x)e^{2U(x)/\\sigma^2} - \\frac{\\sigma^2}{2}\\frac{dp(x)}{dx} e^{2U(x)/\\sigma^2} = -\\frac{\\sigma^2}{2}\\frac{d}{dx}\\left( p(x)e^{2U(x)/\\sigma^2} \\right)\n$$\nIntegrating this from a point $x_1$ deep in well A to a point $x_2$ deep in well B:\n$$\nJ \\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' = -\\frac{\\sigma^2}{2} \\left[ p(x_2)e^{2U(x_2)/\\sigma^2} - p(x_1)e^{2U(x_1)/\\sigma^2} \\right]\n$$\nTo calculate the rate, we assume a quasi-steady state where there is a source deep in well A maintaining its equilibrium population and a sink deep in well B, such that $p(x_2) \\to 0$. Within well A, the population is assumed to be in local equilibrium: $p(x) \\approx N_A \\frac{e^{-2U(x)/\\sigma^2}}{Z_A}$ for $x \\approx x_1$, where $N_A$ is the total population in well A and $Z_A = \\int_A e^{-2U(x)/\\sigma^2}dx$ is the partition function for that well. Setting $p(x_2)=0$ and substituting for $p(x_1)$:\n$$\nJ \\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' = \\frac{\\sigma^2}{2} p(x_1)e^{2U(x_1)/\\sigma^2} = \\frac{\\sigma^2}{2} \\left( N_A \\frac{e^{-2U(x_1)/\\sigma^2}}{Z_A} \\right) e^{2U(x_1)/\\sigma^2} = \\frac{\\sigma^2 N_A}{2 Z_A}\n$$\nThe transition rate $k = J/N_A$ is then:\n$$\nk = \\frac{\\sigma^2}{2} \\frac{1}{Z_A \\left( \\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' \\right)}\n$$\nThe two integrals are evaluated using the saddle-point (Laplace's) method, which is accurate for small $\\sigma$.\nThe potential minima are at $x_{min} = \\pm 1$ and the barrier top is at $x_{bar} = 0$.\nThe integral $Z_A$ is dominated by the minimum of $U(x)$ in well A at $x_{min}$. We approximate $U(x)$ quadratically around $x_{min}$: $U(x) \\approx U(x_{min}) + \\frac{1}{2}U''(x_{min})(x-x_{min})^2$. Let $\\omega_{min}^2 = U''(x_{min})$.\n$$\nZ_A = \\int_A e^{-2U(x)/\\sigma^2} dx \\approx \\int_{-\\infty}^{\\infty} e^{-\\frac{2}{\\sigma^2}[U(x_{min}) + \\frac{1}{2}\\omega_{min}^2(x-x_{min})^2]} dx = e^{-2U(x_{min})/\\sigma^2} \\sqrt{\\frac{2\\pi\\sigma^2}{2\\omega_{min}^2}} = e^{-2U(x_{min})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{min}}\n$$\nThe integral $\\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx'$ is dominated by the maximum of $U(x')$, i.e., the barrier top at $x_{bar}$. We approximate $U(x)$ quadratically around $x_{bar}$: $U(x) \\approx U(x_{bar}) - \\frac{1}{2}|U''(x_{bar})|(x-x_{bar})^2$. Let $\\omega_{bar}^2 = |U''(x_{bar})|$.\n$$\n\\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' \\approx \\int_{-\\infty}^{\\infty} e^{\\frac{2}{\\sigma^2}[U(x_{bar}) - \\frac{1}{2}\\omega_{bar}^2(x-x_{bar})^2]} dx' = e^{2U(x_{bar})/\\sigma^2} \\sqrt{\\frac{2\\pi\\sigma^2}{2\\omega_{bar}^2}} = e^{2U(x_{bar})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{bar}}\n$$\nSubstituting these approximations back into the expression for $k$:\n$$\nk \\approx \\frac{\\sigma^2}{2} \\frac{1}{\\left(e^{-2U(x_{min})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{min}}\\right) \\left(e^{2U(x_{bar})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{bar}}\\right)} = \\frac{\\sigma^2}{2} \\frac{\\omega_{min}\\omega_{bar}}{\\sigma^2\\pi} e^{-2(U(x_{bar})-U(x_{min}))/\\sigma^2}\n$$\nThis simplifies to the final expression for the Kramers rate in the overdamped limit (with friction $\\gamma=1$):\n$$\nk = \\frac{\\omega_{min}\\omega_{bar}}{2\\pi} \\exp\\left(-\\frac{2\\Delta U}{\\sigma^2}\\right)\n$$\nwhere $\\Delta U = U(x_{bar}) - U(x_{min})$ is the barrier height.\n\n### 3. Application to the Specific Potential\n\nFor $U(x) = x^4/4 - x^2/2$:\n-   Extrema: $U'(x) = x^3 - x = 0 \\implies x = 0, \\pm 1$.\n-   Second derivative: $U''(x) = 3x^2 - 1$.\n-   Minima are at $x_{min} = \\pm 1$. The potential value is $U(\\pm 1) = 1/4 - 1/2 = -1/4$.\n-   Barrier top is at $x_{bar} = 0$. The potential value is $U(0) = 0$.\n-   Barrier height: $\\Delta U = U(0) - U(-1) = 0 - (-1/4) = 1/4$.\n-   Curvature at minimum: $\\omega_{min}^2 = U''(\\pm 1) = 3(1)^2 - 1 = 2 \\implies \\omega_{min} = \\sqrt{2}$.\n-   Curvature at barrier: $\\omega_{bar}^2 = |U''(0)| = |-1| = 1 \\implies \\omega_{bar} = 1$.\n\nSubstituting these values into the rate formula:\n$$\nk = \\frac{\\sqrt{2} \\cdot 1}{2\\pi} \\exp\\left(-\\frac{2(1/4)}{\\sigma^2}\\right) = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{2\\sigma^2}\\right)\n$$\nThis formula will be used to compute the transition rate. Note that this approximation is most accurate for small $\\sigma$. For $\\sigma=0.7$, the condition $2\\Delta U/\\sigma^2 = 0.5/(0.7^2) \\approx 1.02$ is not much larger than $1$, so the Kramers formula is expected to be less accurate.\n\n### 4. Numerical Computation Plan\n\nFor each given value of $\\sigma$:\n1.  **Kramers Rate:** Compute $k$ using the derived formula.\n2.  **Numerical Integration:**\n    a.  Define a discrete grid of $N=100001$ points for $x$ on the interval $[-L, L]$ with $L=3.5$.\n    b.  Compute the unnormalized probability density $\\tilde{p}_{\\mathrm{ss}}(x_i) = \\exp\\left(-\\frac{2(x_i^4/4 - x_i^2/2)}{\\sigma^2}\\right)$ at each grid point $x_i$.\n    c.  Compute the normalization constant $Z = \\int_{-L}^{L} \\tilde{p}_{\\mathrm{ss}}(x) dx$ using numerical integration (e.g., the trapezoidal rule).\n    d.  Obtain the normalized probability density $p_{\\mathrm{ss}}(x_i) = \\tilde{p}_{\\mathrm{ss}}(x_i) / Z$.\n    e.  Define the regions of interest using the boundary parameter $r=0.25$: left well ($x  -r$), barrier ($-r \\le x \\le r$), and right well ($x  r$).\n    f.  Compute the probability mass in each region by integrating $p_{\\mathrm{ss}}(x)$ over the corresponding subinterval, again using numerical integration.\n    -   $P_{\\text{barrier}} = \\int_{-r}^{r} p_{\\mathrm{ss}}(x) dx$\n    -   $P_{\\text{left}} = \\int_{-L}^{-r} p_{\\mathrm{ss}}(x) dx$\n    -   $P_{\\text{right}} = \\int_{r}^{L} p_{\\mathrm{ss}}(x) dx$\n\nDue to the symmetry of the potential $U(x)$, we expect $P_{\\text{left}} \\approx P_{\\text{right}}$. The sum of the three probabilities should be close to $1$.", "answer": "```python\nimport numpy as np\n# scipy is listed as an allowed library, but numpy's trapz is sufficient and standard.\n# from scipy.integrate import trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating Kramers' rate and regional probabilities\n    for a particle in a double-well potential.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L = 3.5  # Interval [-L, L]\n    N = 100001  # Number of grid points\n    r = 0.25  # Barrier region radius {|x| = r}\n    test_cases = [0.05, 0.20, 0.70]  # Noise amplitudes (sigma)\n\n    # --- Analytical values from derivation for Kramers Rate ---\n    # U(x) = x^4/4 - x^2/2\n    # Minima at x_min = +/- 1, barrier at x_bar = 0\n    # U(x_min) = -1/4, U(x_bar) = 0 = Delta_U = 1/4\n    # U''(x) = 3x^2 - 1\n    # omega_min^2 = U''(1) = 2  = omega_min = sqrt(2)\n    # omega_bar^2 = |U''(0)| = 1 = omega_bar = 1\n    sqrt_2 = np.sqrt(2)\n    two_pi = 2 * np.pi\n    \n    # --- Grid for numerical integration ---\n    x_grid = np.linspace(-L, L, N)\n\n    def potential(x):\n        \"\"\"The double-well potential U(x).\"\"\"\n        return x**4 / 4 - x**2 / 2\n\n    # --- Lists to store results ---\n    all_results = []\n\n    for sigma in test_cases:\n        # 1. Compute Kramers Rate\n        # k = (omega_min * omega_bar) / (2*pi) * exp(-2 * Delta_U / sigma^2)\n        # k = (sqrt(2) * 1) / (2*pi) * exp(-2 * (1/4) / sigma^2)\n        exponent = -1 / (2 * sigma**2)\n        kramers_rate = (sqrt_2 / two_pi) * np.exp(exponent)\n\n        # 2. Compute Probability Masses\n        # Unnormalized steady-state probability density\n        p_unnormalized = np.exp(-2 * potential(x_grid) / sigma**2)\n        \n        # Normalization constant Z using trapezoidal rule\n        Z = np.trapz(p_unnormalized, x_grid)\n        \n        # Normalized probability density\n        p_ss = p_unnormalized / Z\n\n        # Define masks for the integration regions\n        barrier_mask = np.abs(x_grid) = r\n        left_mask = x_grid  -r\n        right_mask = x_grid  r\n\n        # Compute probability mass in each region\n        # np.trapz(y, x) integrates y(x) dx\n        prob_barrier = np.trapz(p_ss[barrier_mask], x_grid[barrier_mask])\n        prob_left = np.trapz(p_ss[left_mask], x_grid[left_mask])\n        prob_right = np.trapz(p_ss[right_mask], x_grid[right_mask])\n        \n        # Store results for this case\n        case_results = [kramers_rate, prob_barrier, prob_left, prob_right]\n        all_results.append(case_results)\n\n    # --- Format and print the final output ---\n    # The required format is a list of lists, string-formatted without spaces.\n    # Ex: [[a,b,c,d],[e,f,g,h],[i,j,k,l]]\n    inner_strs = []\n    for sublist in all_results:\n        # Format numbers to be clean and comma-separated\n        formatted_numbers = \",\".join(f\"{x:.8e}\" for x in sublist)\n        inner_strs.append(f\"[{formatted_numbers}]\")\n    \n    final_output = f\"[{','.join(inner_strs)}]\"\n    print(final_output)\n\nsolve()\n\n```", "id": "4326517"}]}