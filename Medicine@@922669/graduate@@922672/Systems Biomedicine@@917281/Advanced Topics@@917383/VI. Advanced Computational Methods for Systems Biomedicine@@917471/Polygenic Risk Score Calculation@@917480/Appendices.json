{"hands_on_practices": [{"introduction": "Before a Polygenic Risk Score (PRS) can be calculated, it is essential to harmonize the data from the source Genome-Wide Association Study (GWAS) with the target cohort's genotype data. This exercise [@problem_id:4375618] simulates a critical bioinformatics task: resolving inconsistencies in allele reporting, particularly for strand-ambiguous SNPs. Mastering this process by aligning alleles and their corresponding effect sizes is fundamental to preventing systematic errors that can invalidate PRS results.", "problem": "A Single Nucleotide Polymorphism (SNP) is a genomic locus where one nucleotide varies among individuals. In genotype data, alleles are reported with respect to a genome build and strand. The Genome Reference Consortium Human (GRCh) build defines a reference coordinate system and a positive strand; reported alleles on the negative strand are the reverse complements of the positive-strand alleles under the base-pairing rules $A \\leftrightarrow T$ and $C \\leftrightarrow G$. A SNP is strand-ambiguous if its allele pair is either $\\{A,T\\}$ or $\\{C,G\\}$; under reverse complement, these allele sets map to themselves, making orientation impossible to resolve from allele labels alone. Allele frequency for a given allele is the proportion of that allele among all chromosomes in the sample, denoted $p$. Under Hardy–Weinberg Equilibrium (HWE), genotype counts reflect allele frequencies, but orientation errors can swap the identity of the counted allele, causing systematic misalignment between Genome-Wide Association Study (GWAS) effect alleles and target genotypes, which biases a Polygenic Risk Score (PRS).\n\nYou are harmonizing GWAS summary statistics to a target cohort genotyped and lifted over to Genome Reference Consortium Human $38$ (GRCh$38$) on the positive strand. You have an ancestry-matched reference panel with allele frequencies. Your harmonization must ensure that effect alleles and their effect sizes from the GWAS align to the target cohort’s allele coding, preventing strand misalignment. Consider three SNPs with the following information (GWAS summary statistics report an effect allele, other allele, an effect size $\\beta_{\\mathrm{GWAS}}$, and an effect-allele frequency $p_{\\mathrm{GWAS}}$; the target cohort provides the allele set on the GRCh$38$ positive strand and the frequency of the first allele listed as $p_{\\mathrm{target}}$; the reference panel provides the positive-strand frequency of the same first allele as $p_{\\mathrm{ref}}$):\n\n- Variant $\\mathrm{rs101}$: GRCh$38$ positive-strand alleles $\\{A,G\\}$; GWAS reports effect allele $T$, other allele $C$, $\\beta_{\\mathrm{GWAS}} = +0.05$, $p_{\\mathrm{GWAS}} = 0.30$; target cohort alleles $\\{A,G\\}$ with $p_{\\mathrm{target}}(A) = 0.70$; reference panel $p_{\\mathrm{ref}}(A) = 0.68$.\n- Variant $\\mathrm{rs202}$ (strand-ambiguous): GRCh$38$ positive-strand alleles $\\{C,G\\}$; GWAS reports effect allele $C$, other allele $G$, $\\beta_{\\mathrm{GWAS}} = -0.10$, $p_{\\mathrm{GWAS}} = 0.10$; target cohort alleles $\\{C,G\\}$ with $p_{\\mathrm{target}}(C) = 0.90$; reference panel $p_{\\mathrm{ref}}(C) = 0.88$.\n- Variant $\\mathrm{rs303}$ (strand-ambiguous): GRCh$38$ positive-strand alleles $\\{A,T\\}$; GWAS reports effect allele $A$, other allele $T$, $\\beta_{\\mathrm{GWAS}} = +0.02$, $p_{\\mathrm{GWAS}} = 0.49$; target cohort alleles $\\{A,T\\}$ with $p_{\\mathrm{target}}(A) = 0.51$; reference panel $p_{\\mathrm{ref}}(A) = 0.50$.\n\nLet the harmonization decision threshold be $\\delta = 0.05$ for comparing frequencies and the exclusion band around half be $\\eta = 0.05$. A correct pipeline must:\n- Map GWAS alleles to the GRCh$38$ positive strand using reverse complements where appropriate.\n- Use allele frequency comparisons to decide orientation for strand-ambiguous SNPs when resolvable, and exclude them when they cannot be resolved (e.g., near half).\n- Avoid flipping non-ambiguous SNPs solely due to between-cohort allele frequency differences.\n- Flip the sign of $\\beta_{\\mathrm{GWAS}}$ when the effect allele mapping implies exchanging the counted allele with its complement or the other allele.\n\nWhich pipeline below correctly harmonizes all three variants, preventing misalignment while retaining resolvable SNPs, given the data above?\n\nA. Realign all GWAS alleles to GRCh$38$ positive strand via reverse complement. For strand-ambiguous SNPs, keep all; flip the sign of $\\beta_{\\mathrm{GWAS}}$ only if $|p_{\\mathrm{GWAS}} - p_{\\mathrm{target}}|  \\delta$; otherwise, keep orientation. Never exclude any strand-ambiguous SNPs.\n\nB. Realign GWAS alleles to GRCh$38$ positive strand. For strand-ambiguous SNPs, decide orientation by comparing $p_{\\mathrm{GWAS}}$ to $p_{\\mathrm{ref}}$: if $|p_{\\mathrm{GWAS}} - p_{\\mathrm{ref}}|  \\delta$, keep orientation; otherwise, flip sign of $\\beta_{\\mathrm{GWAS}}$. Exclude an ambiguous SNP only if $\\min\\{|p_{\\mathrm{GWAS}} - 0.5|, |p_{\\mathrm{ref}} - 0.5|\\}  \\eta$.\n\nC. Realign GWAS alleles to GRCh$38$ positive strand. For non-ambiguous SNPs, match alleles by identity and keep; do not use frequency to flip. For strand-ambiguous SNPs, compute $d_{1} = |p_{\\mathrm{GWAS}} - p_{\\mathrm{target}}|$ and $d_{2} = |p_{\\mathrm{GWAS}} - (1 - p_{\\mathrm{target}})|$. If $d_{1}  \\delta$ and $d_{2} \\ge \\delta$, keep orientation; if $d_{2}  \\delta$ and $d_{1} \\ge \\delta$, flip the sign of $\\beta_{\\mathrm{GWAS}}$; if both $d_{1}$ and $d_{2}$ are $ \\delta$ or both $ \\ge \\delta$, exclude the SNP. Additionally, exclude any ambiguous SNP if either $|p_{\\mathrm{GWAS}} - 0.5|  \\eta$ or $|p_{\\mathrm{ref}} - 0.5|  \\eta$.\n\nD. Ignore strand information. For all SNPs, if the allele sets match between GWAS and target reports, keep and never flip. For strand-ambiguous SNPs, always keep. Flip the sign of $\\beta_{\\mathrm{GWAS}}$ whenever $p_{\\mathrm{GWAS}}  p_{\\mathrm{target}}$; otherwise, keep orientation.", "solution": "The user wants me to act as a meticulous STEM professor and solve a problem on the harmonization of genetic data for Polygenic Risk Score (PRS) calculation.\n\n### Problem Statement Validation\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n\n- **Context**: Harmonization of Genome-Wide Association Study (GWAS) summary statistics to a target cohort genotyped on GRCh38 positive strand.\n- **Base-pairing rules**: $A \\leftrightarrow T$ and $C \\leftrightarrow G$.\n- **Strand-ambiguous SNP**: Allele pair is $\\{A,T\\}$ or $\\{C,G\\}$.\n- **Data for Variant rs101**:\n    - GRCh38 positive-strand alleles: $\\{A,G\\}$\n    - GWAS: effect allele $T$, other allele $C$, $\\beta_{\\mathrm{GWAS}} = +0.05$, $p_{\\mathrm{GWAS}} = 0.30$\n    - Target: alleles $\\{A,G\\}$, $p_{\\mathrm{target}}(A) = 0.70$\n    - Reference: $p_{\\mathrm{ref}}(A) = 0.68$\n- **Data for Variant rs202** (strand-ambiguous):\n    - GRCh38 positive-strand alleles: $\\{C,G\\}$\n    - GWAS: effect allele $C$, other allele $G$, $\\beta_{\\mathrm{GWAS}} = -0.10$, $p_{\\mathrm{GWAS}} = 0.10$\n    - Target: alleles $\\{C,G\\}$, $p_{\\mathrm{target}}(C) = 0.90$\n    - Reference: $p_{\\mathrm{ref}}(C) = 0.88$\n- **Data for Variant rs303** (strand-ambiguous):\n    - GRCh38 positive-strand alleles: $\\{A,T\\}$\n    - GWAS: effect allele $A$, other allele $T$, $\\beta_{\\mathrm{GWAS}} = +0.02$, $p_{\\mathrm{GWAS}} = 0.49$\n    - Target: alleles $\\{A,T\\}$, $p_{\\mathrm{target}}(A) = 0.51$\n    - Reference: $p_{\\mathrm{ref}}(A) = 0.50$\n- **Thresholds**:\n    - Frequency comparison threshold: $\\delta = 0.05$\n    - Exclusion band around half: $\\eta = 0.05$\n- **Required Pipeline Rules**:\n    1. Map GWAS alleles to GRCh38 positive strand via reverse complements.\n    2. Use allele frequency to decide orientation for resolvable strand-ambiguous SNPs.\n    3. Exclude unresolvable strand-ambiguous SNPs (e.g., frequencies near $0.5$).\n    4. Do not flip non-ambiguous SNPs based on frequency differences alone.\n    5. Flip the sign of $\\beta_{\\mathrm{GWAS}}$ if the effect allele is swapped.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is well-grounded in the principles of bioinformatics and statistical genetics. The concepts of strand ambiguity, allele harmonization, reverse complements, allele frequencies, and their application in PRS are central to the field. The use of GRCh builds, GWAS summary statistics, and reference panels reflects standard practice.\n- **Well-Posed**: The problem is well-posed. It provides all necessary data (alleles, frequencies, effect sizes, thresholds) and a clear set of rules and objectives to derive a unique solution for how to handle each of the three variants.\n- **Objective**: The problem statement is written in precise, objective, and technical language, free of subjective claims.\n- **Completeness and Consistency**: The problem is self-contained. The data provided for each SNP is complete. The rules outlined are consistent with each other and with standard bioinformatic procedures. For instance, the frequencies provided are plausible and designed to test specific harmonization scenarios (a clear strand flip, a clear allele swap, and an unresolvable case).\n- **Realism**: The scenarios are realistic. For rs101, GWAS reports alleles $\\{T, C\\}$, which are the reverse complements of the target's $\\{A,G\\}$, indicating a report from the opposite strand. For rs202, the GWAS frequency ($p=0.10$) is approximately $1$ minus the reference frequency ($p=0.88$), indicating a probable allele swap. For rs303, frequencies are close to $0.5$, a classic case for exclusion.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is scientifically sound, well-posed, and all necessary information is provided. I will proceed with the solution derivation.\n\n### Solution Derivation\n\nThe goal is to align the GWAS summary statistics to the GRCh38 positive-strand reference frame of the target cohort. This requires determining the correct effect allele and effect size ($\\beta$) for each variant in this frame.\n\n**Analysis of Variant rs101 (Non-ambiguous)**\n\n1.  **Identify Allele Mapping**: The GRCh38 positive-strand alleles are $\\{A,G\\}$. The GWAS reports alleles $\\{T,C\\}$. According to the base-pairing rules ($A \\leftrightarrow T$, $G \\leftrightarrow C$), the GWAS alleles are the reverse complements of the positive-strand alleles. This indicates the GWAS data was reported on the negative strand.\n2.  **Determine Harmonized Effect Allele**: The GWAS effect allele is $T$. Its reverse complement is $A$. Therefore, in the GRCh38 positive-strand frame, the effect allele is $A$.\n3.  **Determine Harmonized Effect Size**: The effect size $\\beta_{\\mathrm{GWAS}} = +0.05$ corresponds to the GWAS effect allele $T$. Since we mapped $T$ to $A$ without swapping it for the other allele on its strand (i.e., we did not swap $T$ for $C$), we do not flip the sign of $\\beta$. The harmonized effect size is $\\beta = +0.05$.\n4.  **Frequency Check (Sanity Check, not for decision-making per rules)**: The frequency of the GWAS effect allele $T$ is $p_{\\mathrm{GWAS}}(T) = 0.30$. This implies the frequency of its corresponding positive-strand allele, $A$, is also $0.30$ in the GWAS cohort. This is very different from $p_{\\mathrm{ref}}(A) = 0.68$ but close to $1-p_{\\mathrm{ref}}(A) = 1-0.68 = 0.32$. This suggests a possible allele label swap in the original GWAS, but the problem's rules state, \"Avoid flipping non-ambiguous SNPs solely due to between-cohort allele frequency differences.\" We must follow the allele-identity-based mapping.\n5.  **Conclusion for rs101**: Keep. The harmonized effect allele is $A$ with $\\beta = +0.05$.\n\n**Analysis of Variant rs202 (Strand-ambiguous)**\n\n1.  **Identify Ambiguity**: The allele pair is $\\{C,G\\}$, which is strand-ambiguous. Allele identities alone are insufficient to determine orientation.\n2.  **Use Frequencies to Resolve**: We must compare the GWAS allele frequency to a reference frequency to infer the correct allele alignment. We are given $p_{\\mathrm{GWAS}}(C) = 0.10$ and $p_{\\mathrm{ref}}(C) = 0.88$.\n    - **Possibility 1 (No Flip)**: The GWAS effect allele $C$ corresponds to the reference allele $C$. We compare their frequencies: $|p_{\\mathrm{GWAS}}(C) - p_{\\mathrm{ref}}(C)| = |0.10 - 0.88| = 0.78$.\n    - **Possibility 2 (Flip)**: The GWAS effect allele $C$ corresponds to the reference's *other* allele, $G$. We compare the frequency of the GWAS effect allele $C$ to the frequency of the reference allele $G$. $p_{\\mathrm{ref}}(G) = 1 - p_{\\mathrm{ref}}(C) = 1 - 0.88 = 0.12$. The difference is $|p_{\\mathrm{GWAS}}(C) - p_{\\mathrm{ref}}(G)| = |0.10 - 0.12| = 0.02$.\n3.  **Decision**: The difference $0.02$ is less than the threshold $\\delta = 0.05$, while $0.78$ is much larger. This strongly supports \"Possibility 2,\" meaning the GWAS report of allele $C$ corresponds to allele $G$ in the reference frame.\n4.  **Determine Harmonized Allele and Effect Size**: The original effect allele was $C$. The harmonization implies it should be $G$. We must flip the effect allele. Consequently, we must also flip the sign of $\\beta$.\n    - Original: Effect allele $C$, $\\beta_{\\mathrm{GWAS}} = -0.10$.\n    - Harmonized: Effect allele $G$, $\\beta = -(-0.10) = +0.10$.\n5.  **Check for Exclusion**: We must check if the allele frequencies are too close to $0.5$. The exclusion band is controlled by $\\eta = 0.05$.\n    - $|p_{\\mathrm{GWAS}}(C) - 0.5| = |0.10 - 0.5| = 0.40$. This is not $ \\eta$.\n    - $|p_{\\mathrm{ref}}(C) - 0.5| = |0.88 - 0.5| = 0.38$. This is not $ \\eta$.\n    - The SNP is not in the exclusion zone and is resolvable.\n6.  **Conclusion for rs202**: Keep, but flip. The harmonized effect allele is $G$ with $\\beta = +0.10$.\n\n**Analysis of Variant rs303 (Strand-ambiguous)**\n\n1.  **Identify Ambiguity**: The allele pair is $\\{A,T\\}$, which is strand-ambiguous.\n2.  **Use Frequencies to Resolve**: We are given $p_{\\mathrm{GWAS}}(A) = 0.49$ and $p_{\\mathrm{ref}}(A) = 0.50$.\n    - **Possibility 1 (No Flip)**: GWAS $A$ corresponds to reference $A$. Difference: $|p_{\\mathrm{GWAS}}(A) - p_{\\mathrm{ref}}(A)| = |0.49 - 0.50| = 0.01$.\n    - **Possibility 2 (Flip)**: GWAS $A$ corresponds to reference $T$. $p_{\\mathrm{ref}}(T) = 1 - p_{\\mathrm{ref}}(A) = 1 - 0.50 = 0.50$. Difference: $|p_{\\mathrm{GWAS}}(A) - p_{\\mathrm{ref}}(T)| = |0.49 - 0.50| = 0.01$.\n3.  **Decision**: Both differences are $0.01$, which is less than $\\delta = 0.05$. We cannot distinguish between the two possibilities. The SNP is unresolvable by this frequency comparison.\n4.  **Check for Exclusion**: We check if the frequencies are within the exclusion band $[0.5 - \\eta, 0.5 + \\eta]$, which is $[0.45, 0.55]$.\n    - $|p_{\\mathrm{GWAS}}(A) - 0.5| = |0.49 - 0.5| = 0.01$. This is $ \\eta=0.05$.\n    - $|p_{\\mathrm{ref}}(A) - 0.5| = |0.50 - 0.5| = 0.00$. This is $ \\eta=0.05$.\n    - Both frequencies fall within the exclusion range. This confirms the SNP is unresolvable and poses a high risk of misalignment.\n5.  **Conclusion for rs303**: Exclude.\n\n### Option-by-Option Analysis\n\nNow I will evaluate each proposed pipeline.\n\n**A. Realign all GWAS alleles to GRCh38 positive strand via reverse complement. For strand-ambiguous SNPs, keep all; flip the sign of $\\beta_{\\mathrm{GWAS}}$ only if $|p_{\\mathrm{GWAS}} - p_{\\mathrm{target}}|  \\delta$; otherwise, keep orientation. Never exclude any strand-ambiguous SNPs.**\nThis pipeline is fundamentally flawed. Its directive to \"Never exclude any strand-ambiguous SNPs\" is dangerous and incorrect. As demonstrated with rs303, SNPs with frequencies near $0.5$ are unresolvable and must be removed to prevent introducing errors into the PRS. Therefore, this option is incorrect.\n**Verdict: Incorrect**\n\n**B. Realign GWAS alleles to GRCh38 positive strand. For strand-ambiguous SNPs, decide orientation by comparing $p_{\\mathrm{GWAS}}$ to $p_{\\mathrm{ref}}$: if $|p_{\\mathrm{GWAS}} - p_{\\mathrm{ref}}|  \\delta$, keep orientation; otherwise, flip sign of $\\beta_{\\mathrm{GWAS}}$. Exclude an ambiguous SNP only if $\\min\\{|p_{\\mathrm{GWAS}} - 0.5|, |p_{\\mathrm{ref}} - 0.5|\\}  \\eta$.**\nThe logic for deciding orientation is incomplete and not robust. The rule is \"if $|p_{\\mathrm{GWAS}} - p_{\\mathrm{ref}}|  \\delta$, keep; otherwise, flip\". It does not explicitly check if a flip is warranted by comparing $p_{\\mathrm{GWAS}}$ to $(1-p_{\\mathrm{ref}})$. For rs303, $|p_{\\mathrm{GWAS}}(A) - p_{\\mathrm{ref}}(A)| = |0.49 - 0.50| = 0.01  \\delta$. This pipeline would decide to \"keep orientation\". The exclusion rule would then correctly remove it, but the initial decision logic is flawed. A robust pipeline should recognize the ambiguity, not make an arbitrary choice. The logic presented in C is more comprehensive.\n**Verdict: Incorrect**\n\n**C. Realign GWAS alleles to GRCh38 positive strand. For non-ambiguous SNPs, match alleles by identity and keep; do not use frequency to flip. For strand-ambiguous SNPs, compute $d_{1} = |p_{\\mathrm{GWAS}} - p_{\\mathrm{target}}|$ and $d_{2} = |p_{\\mathrm{GWAS}} - (1 - p_{\\mathrm{target}})|$. If $d_{1}  \\delta$ and $d_{2} \\ge \\delta$, keep orientation; if $d_{2}  \\delta$ and $d_{1} \\ge \\delta$, flip the sign of $\\beta_{\\mathrm{GWAS}}$; if both $d_{1}$ and $d_{2}$ are $ \\delta$ or both $ \\ge \\delta$, exclude the SNP. Additionally, exclude any ambiguous SNP if either $|p_{\\mathrm{GWAS}} - 0.5|  \\eta$ or $|p_{\\mathrm{ref}} - 0.5|  \\eta$.**\nThis pipeline accurately describes the correct procedure.\n- **For rs101 (non-ambiguous)**: It correctly states to match alleles by identity (via reverse complement) and not use frequency to decide a flip. This matches our conclusion.\n- **For rs202 (ambiguous)**: Using its logic with $p_{\\mathrm{target}}(C)=0.90$ and $p_{\\mathrm{GWAS}}(C)=0.10$:\n    - $d_1 = |0.10 - 0.90| = 0.80$.\n    - $d_2 = |0.10 - (1 - 0.90)| = |0.10 - 0.10| = 0.00$.\n    - Since $d_2  \\delta=0.05$ and $d_1 \\ge \\delta=0.05$, the rule is to \"flip the sign of $\\beta_{\\mathrm{GWAS}}$\". This perfectly matches our conclusion.\n- **For rs303 (ambiguous)**: It has two rules that lead to exclusion.\n    - First, the additional exclusion rule: $|p_{\\mathrm{GWAS}}(A) - 0.5| = |0.49-0.5| = 0.01  \\eta=0.05$. So it is excluded. This matches our conclusion.\n    - Second, the main decision logic with $p_{\\mathrm{target}}(A)=0.51$ and $p_{\\mathrm{GWAS}}(A)=0.49$:\n        - $d_1 = |0.49 - 0.51| = 0.02$.\n        - $d_2 = |0.49 - (1 - 0.51)| = |0.49 - 0.49| = 0.00$.\n        - Since both $d_1  \\delta$ and $d_2  \\delta$, the rule is to \"exclude the SNP\". This also matches our conclusion.\nThe pipeline is comprehensive, robust, and correctly processes all three variants according to established principles.\n**Verdict: Correct**\n\n**D. Ignore strand information. For all SNPs, if the allele sets match between GWAS and target reports, keep and never flip. For strand-ambiguous SNPs, always keep. Flip the sign of $\\beta_{\\mathrm{GWAS}}$ whenever $p_{\\mathrm{GWAS}}  p_{\\mathrm{target}}$; otherwise, keep orientation.**\nThis pipeline is incorrect on multiple fundamental levels.\n- \"Ignore strand information\" is a critical error. For rs101, this would lead to a failure to map the alleles correctly.\n- \"if the allele sets match... keep and never flip\" is also wrong. For rs202, the sets match, but a flip is necessary, as shown by frequency data.\n- The rule \"Flip... whenever $p_{\\mathrm{GWAS}}  p_{\\mathrm{target}}$\" is arbitrary and lacks a sound scientific basis for determining allele alignment. For rs202, $p_{\\mathrm{GWAS}}(C) = 0.10  p_{\\target}(C) = 0.90$ so it would flip beta, but this is a coincidence; the underlying logic is flawed and would fail in other cases. For rs303, it would also incorrectly flip beta instead of excluding the SNP.\n**Verdict: Incorrect**", "answer": "$$\\boxed{C}$$", "id": "4375618"}, {"introduction": "Genome-Wide Association Studies identify numerous genetic variants associated with a trait, but many nearby variants are correlated due to Linkage Disequilibrium (LD) and provide redundant information. This practice [@problem_id:4375562] walks through the 'clumping' algorithm, a common procedure to prune correlated SNPs and select a set of representative genetic markers. This step is crucial for building a parsimonious and effective PRS from GWAS summary statistics.", "problem": "In a single locus region on chromosome $1$, consider seven single nucleotide polymorphisms (SNPs) with genomic base-pair positions, genome-wide association study $p$-values, and pairwise linkage disequilibrium (LD) measured by the squared correlation $r^2$, as listed below. Use a clumping procedure with a symmetric genomic window of $\\pm 120{,}000$ base pairs around each SNP (inclusive of the boundary) and an LD threshold of $r^2 \\ge 0.20$. Clumping is performed by ranking SNPs by ascending $p$-value, iteratively selecting the next unpruned SNP as an index SNP, and then pruning any other SNPs that lie within the specified window of that index SNP and have $r^2$ with that index SNP greater than or equal to the LD threshold. Once a SNP is pruned it cannot be selected later, and index SNPs are never pruned by later, less significant SNPs. All SNPs listed are eligible; there is no $p$-value exclusion aside from the ranking used for clumping.\n\nSNPs and data:\n- rsA at position $10{,}050{,}000$ with $p=3.0 \\times 10^{-6}$ and effect size (per effect allele) $\\beta=0.10$.\n- rsB at position $10{,}115{,}000$ with $p=1.5 \\times 10^{-7}$ and $\\beta=0.14$.\n- rsC at position $10{,}170{,}000$ with $p=2.0 \\times 10^{-4}$ and $\\beta=-0.06$.\n- rsD at position $10{,}240{,}000$ with $p=4.0 \\times 10^{-6}$ and $\\beta=0.09$.\n- rsE at position $10{,}300{,}000$ with $p=6.0 \\times 10^{-3}$ and $\\beta=0.04$.\n- rsF at position $10{,}380{,}000$ with $p=9.0 \\times 10^{-8}$ and $\\beta=0.12$.\n- rsG at position $10{,}500{,}000$ with $p=1.5 \\times 10^{-2}$ and $\\beta=-0.05$.\n\nNonzero pairwise $r^2$ values for SNP pairs lying within $\\pm 120{,}000$ base pairs of each other are:\n- $r^2(\\mathrm{rsA},\\mathrm{rsB})=0.80$, $r^2(\\mathrm{rsA},\\mathrm{rsC})=0.18$.\n- $r^2(\\mathrm{rsB},\\mathrm{rsC})=0.15$.\n- $r^2(\\mathrm{rsC},\\mathrm{rsD})=0.22$.\n- $r^2(\\mathrm{rsD},\\mathrm{rsE})=0.05$.\n- $r^2(\\mathrm{rsE},\\mathrm{rsF})=0.35$.\n- $r^2(\\mathrm{rsF},\\mathrm{rsG})=0.05$.\n\nFor any SNP pair not listed above, either the genomic distance exceeds $\\pm 120{,}000$ base pairs (so it is outside the clumping window for that pair) or $r^2$ is effectively negligible (less than $0.01$) and thus below threshold.\n\nAn individual has the following genotypes coded as the count of the GWAS effect allele for each SNP: rsA $=2$, rsB $=1$, rsC $=0$, rsD $=1$, rsE $=2$, rsF $=0$, rsG $=2$. Assume the effect alleles used to code genotypes match the effect alleles for which the GWAS effect sizes $\\beta$ are reported.\n\nStarting from the above information and definitions common in systems biomedicine, first determine the set of retained SNPs after LD clumping under the stated window and threshold. Then, using only the retained SNPs, form the polygenic risk score (PRS) for this individual as a weighted sum over retained variants, with weights given by the corresponding $\\beta$ and additive genotype coding. Report the final PRS as a single real number. Round your answer to four significant figures. The PRS is dimensionless; express it without any unit.", "solution": "The solution involves two sequential procedures: first, performing LD clumping to identify an independent set of SNPs, and second, calculating the polygenic risk score (PRS) for the individual using only this retained set of SNPs.\n\n**Part 1: LD Clumping**\n\nThe clumping procedure is iterative, starting with the SNP with the smallest $p$-value.\n\nFirst, we rank all SNPs in ascending order of their GWAS $p$-values:\n1.  rsF ($p = 9.0 \\times 10^{-8}$)\n2.  rsB ($p = 1.5 \\times 10^{-7}$)\n3.  rsA ($p = 3.0 \\times 10^{-6}$)\n4.  rsD ($p = 4.0 \\times 10^{-6}$)\n5.  rsC ($p = 2.0 \\times 10^{-4}$)\n6.  rsE ($p = 6.0 \\times 10^{-3}$)\n7.  rsG ($p = 1.5 \\times 10^{-2}$)\n\nWe initialize the set of all SNPs as unpruned: $S = \\{\\text{rsA, rsB, rsC, rsD, rsE, rsF, rsG}\\}$. We iterate through the ranked list, selecting index SNPs and pruning others.\n\n**Iteration 1:**\n-   Select the top-ranked unpruned SNP as the first index SNP: **rsF**. This SNP is retained.\n-   The position of rsF is $10{,}380{,}000$. The genomic window is $[10{,}380{,}000 - 120{,}000, 10{,}380{,}000 + 120{,}000]$, which is $[10{,}260{,}000, 10{,}500{,}000]$.\n-   Check other SNPs in the set $S$ that fall within this window and have an $r^2$ with rsF greater than or equal to $0.20$.\n    -   rsE (pos $10{,}300{,}000$): It is in the window. The LD is $r^2(\\mathrm{rsE},\\mathrm{rsF})=0.35$. Since $0.35 \\ge 0.20$, **rsE is pruned**.\n    -   rsG (pos $10{,}500{,}000$): It is in the window. The LD is $r^2(\\mathrm{rsF},\\mathrm{rsG})=0.05$. Since $0.05  0.20$, rsG is not pruned at this step.\n-   Status: Retained: $\\{\\text{rsF}\\}$; Pruned: $\\{\\text{rsE}\\}$; Unpruned: $\\{\\text{rsA, rsB, rsC, rsD, rsG}\\}$.\n\n**Iteration 2:**\n-   Select the next top-ranked unpruned SNP as the index SNP: **rsB**. This SNP is retained.\n-   The position of rsB is $10{,}115{,}000$. The window is $[10{,}115{,}000 - 120{,}000, 10{,}115{,}000 + 120{,}000]$, which is $[9{,}995{,}000, 10{,}235{,}000]$.\n-   Check other currently unpruned SNPs that fall within this window and have high LD with rsB.\n    -   rsA (pos $10{,}050{,}000$): It is in the window. The LD is $r^2(\\mathrm{rsA},\\mathrm{rsB})=0.80$. Since $0.80 \\ge 0.20$, **rsA is pruned**.\n    -   rsC (pos $10{,}170{,}000$): It is in the window. The LD is $r^2(\\mathrm{rsB},\\mathrm{rsC})=0.15$. Since $0.15  0.20$, rsC is not pruned.\n-   Status: Retained: $\\{\\text{rsF, rsB}\\}$; Pruned: $\\{\\text{rsE, rsA}\\}$; Unpruned: $\\{\\text{rsC, rsD, rsG}\\}$.\n\n**Iteration 3:**\n-   The next SNP in the p-value list is rsA, but it has been pruned. We move to the next one, which is **rsD**. This SNP is retained.\n-   The position of rsD is $10{,}240{,}000$. The window is $[10{,}240{,}000 - 120{,}000, 10{,}240{,}000 + 120{,}000]$, which is $[10{,}120{,}000, 10{,}360{,}000]$.\n-   Check other currently unpruned SNPs in this window.\n    -   rsC (pos $10{,}170{,}000$): It is in the window. The LD is $r^2(\\mathrm{rsC},\\mathrm{rsD})=0.22$. Since $0.22 \\ge 0.20$, **rsC is pruned**.\n-   Status: Retained: $\\{\\text{rsF, rsB, rsD}\\}$; Pruned: $\\{\\text{rsE, rsA, rsC}\\}$; Unpruned: $\\{\\text{rsG}\\}$.\n\n**Iteration 4:**\n-   The next SNPs in the p-value list are rsC and rsE, but both have been pruned. The next unpruned SNP is **rsG**. This SNP is retained.\n-   The position of rsG is $10{,}500{,}000$. The window is $[10{,}380{,}000, 10{,}620{,}000]$.\n-   There are no other unpruned SNPs in this window to check.\n-   Status: Retained: $\\{\\text{rsF, rsB, rsD, rsG}\\}$; Pruned: $\\{\\text{rsE, rsA, rsC}\\}$; Unpruned: $\\emptyset$.\n\nThe set of unpruned SNPs is now empty, so the clumping process terminates.\nThe final set of retained SNPs is $\\{\\text{rsB, rsD, rsF, rsG}\\}$.\n\n**Part 2: Polygenic Risk Score (PRS) Calculation**\n\nThe PRS is calculated as a weighted sum of the individual's genotypes for the retained SNPs, where the weights are the effect sizes ($\\beta$).\nThe formula is:\n$$ \\text{PRS} = \\sum_{i \\in \\{\\text{retained}\\}} \\beta_i G_i $$\nwhere $G_i$ is the genotype (count of the effect allele) for SNP $i$.\n\nThe data for the retained SNPs are:\n-   rsB: $\\beta_B = 0.14$, $G_B=1$\n-   rsD: $\\beta_D = 0.09$, $G_D=1$\n-   rsF: $\\beta_F = 0.12$, $G_F=0$\n-   rsG: $\\beta_G = -0.05$, $G_G=2$\n\nSubstituting these values into the PRS formula:\n$$ \\text{PRS} = (\\beta_B \\times G_B) + (\\beta_D \\times G_D) + (\\beta_F \\times G_F) + (\\beta_G \\times G_G) $$\n$$ \\text{PRS} = (0.14 \\times 1) + (0.09 \\times 1) + (0.12 \\times 0) + (-0.05 \\times 2) $$\n$$ \\text{PRS} = 0.14 + 0.09 + 0 - 0.10 $$\n$$ \\text{PRS} = 0.23 - 0.10 $$\n$$ \\text{PRS} = 0.13 $$\n\nThe problem requires the answer to be rounded to four significant figures. To express $0.13$ with four significant figures, we write it as $0.1300$.", "answer": "$$\n\\boxed{0.1300}\n$$", "id": "4375562"}, {"introduction": "Once a set of harmonized and independent SNPs has been selected, the final step is to compute the Polygenic Risk Score (PRS) for each individual and place it on a meaningful scale. This problem [@problem_id:4375612] provides hands-on practice with the fundamental additive formula for PRS calculation. It also demonstrates the essential process of standardizing the raw score, which allows for the comparison of an individual's genetic risk against a reference cohort.", "problem": "In systems biomedicine, the additive genetic model for complex traits represents the aggregate effect of many loci as a linear predictor on an unobserved liability. Under this model, a Polygenic Risk Score (PRS) is constructed from Single Nucleotide Polymorphism (SNP) genotypes coded as allele dosages and locus-specific weights derived from a Genome-Wide Association Study (GWAS). Consider three SNPs with effect-size weights $w=(0.05,\\,-0.02,\\,0.03)$, where each entry corresponds to the contribution per additional effect allele at that locus to the underlying liability. A cohort of $N=5$ individuals has SNP dosage vectors\n$x_{\\mathrm{A}}=(2,\\,1,\\,0)$,\n$x_{\\mathrm{B}}=(1,\\,0,\\,1)$,\n$x_{\\mathrm{C}}=(0,\\,2,\\,2)$,\n$x_{\\mathrm{D}}=(2,\\,0,\\,2)$,\n$x_{\\mathrm{E}}=(0,\\,1,\\,0)$,\nwith the entries for each $x$ denoting the count of effect alleles $\\{0,1,2\\}$ at each of the three loci. Using the additive genetic model and treating this cohort as the normalization population, compute the PRS for individual $\\mathrm{A}$ and then standardize this score by subtracting the cohort mean and dividing by the cohort standard deviation, using the population variance (divide by $N$, not $N-1$). Express the final standardized score for individual $\\mathrm{A}$ as a decimal and round your answer to $4$ significant figures.", "solution": "The additive genetic model for complex traits posits that the liability contributed by genetic variation can be approximated as a linear combination of locus-specific effects and allele dosages. Let the Polygenic Risk Score (PRS) for individual $i$ be denoted by $S_{i}$, and let $w=(w_{1},w_{2},w_{3})$ be the vector of SNP weights, and $x_{i}=(x_{i1},x_{i2},x_{i3})$ be the genotype dosage vector for individual $i$. The PRS is defined from first principles of the linear predictor as\n$$\nS_{i}=\\sum_{j=1}^{3} w_{j}\\,x_{ij}.\n$$\nTo place this PRS on a standardized scale that is comparable across the cohort, we compute the cohort mean\n$$\n\\mu=\\frac{1}{N}\\sum_{i=1}^{N} S_{i},\n$$\nthe population variance\n$$\n\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N} \\left(S_{i}-\\mu\\right)^{2},\n$$\nand the standard deviation $\\sigma=\\sqrt{\\sigma^{2}}$. The standardized score (a $z$-score on the liability scale induced by the linear predictor) for individual $i$ is then\n$$\nZ_{i}=\\frac{S_{i}-\\mu}{\\sigma}.\n$$\n\nWe now compute $S_{i}$ for each cohort member using $w=(0.05,\\,-0.02,\\,0.03)$.\n\n- Individual $\\mathrm{A}$ has $x_{\\mathrm{A}}=(2,\\,1,\\,0)$, so\n$$\nS_{\\mathrm{A}}=0.05\\cdot 2 + (-0.02)\\cdot 1 + 0.03\\cdot 0 = 0.10 - 0.02 + 0 = 0.08.\n$$\n- Individual $\\mathrm{B}$ has $x_{\\mathrm{B}}=(1,\\,0,\\,1)$, so\n$$\nS_{\\mathrm{B}}=0.05\\cdot 1 + (-0.02)\\cdot 0 + 0.03\\cdot 1 = 0.05 + 0 + 0.03 = 0.08.\n$$\n- Individual $\\mathrm{C}$ has $x_{\\mathrm{C}}=(0,\\,2,\\,2)$, so\n$$\nS_{\\mathrm{C}}=0.05\\cdot 0 + (-0.02)\\cdot 2 + 0.03\\cdot 2 = 0 - 0.04 + 0.06 = 0.02.\n$$\n- Individual $\\mathrm{D}$ has $x_{\\mathrm{D}}=(2,\\,0,\\,2)$, so\n$$\nS_{\\mathrm{D}}=0.05\\cdot 2 + (-0.02)\\cdot 0 + 0.03\\cdot 2 = 0.10 + 0 + 0.06 = 0.16.\n$$\n- Individual $\\mathrm{E}$ has $x_{\\mathrm{E}}=(0,\\,1,\\,0)$, so\n$$\nS_{\\mathrm{E}}=0.05\\cdot 0 + (-0.02)\\cdot 1 + 0.03\\cdot 0 = 0 - 0.02 + 0 = -0.02.\n$$\n\nThe cohort PRS values are $\\{0.08,\\,0.08,\\,0.02,\\,0.16,\\,-0.02\\}$. The cohort size is $N=5$, hence the mean is\n$$\n\\mu=\\frac{1}{5}\\left(0.08+0.08+0.02+0.16-0.02\\right)=\\frac{0.32}{5}=0.064.\n$$\nWe compute the deviations and their squares:\n$$\n\\begin{aligned}\nS_{\\mathrm{A}}-\\mu = 0.08-0.064=0.016,  (S_{\\mathrm{A}}-\\mu)^{2} = 0.000256, \\\\\nS_{\\mathrm{B}}-\\mu = 0.08-0.064=0.016,  (S_{\\mathrm{B}}-\\mu)^{2} = 0.000256, \\\\\nS_{\\mathrm{C}}-\\mu = 0.02-0.064=-0.044,  (S_{\\mathrm{C}}-\\mu)^{2} = 0.001936, \\\\\nS_{\\mathrm{D}}-\\mu = 0.16-0.064=0.096,  (S_{\\mathrm{D}}-\\mu)^{2} = 0.009216, \\\\\nS_{\\mathrm{E}}-\\mu = -0.02-0.064=-0.084,  (S_{\\mathrm{E}}-\\mu)^{2} = 0.007056.\n\\end{aligned}\n$$\nSumming these squared deviations gives\n$$\n\\sum_{i=1}^{5}\\left(S_{i}-\\mu\\right)^{2} = 0.000256+0.000256+0.001936+0.009216+0.007056 = 0.01872.\n$$\nThus the population variance and standard deviation are\n$$\n\\sigma^{2}=\\frac{1}{5}\\cdot 0.01872 = 0.003744, \\qquad \\sigma=\\sqrt{0.003744}.\n$$\nThe standardized score for individual $\\mathrm{A}$ is\n$$\nZ_{\\mathrm{A}}=\\frac{S_{\\mathrm{A}}-\\mu}{\\sigma}=\\frac{0.016}{\\sqrt{0.003744}}.\n$$\nEvaluating the square root, $\\sqrt{0.003744}\\approx 0.061188234$, so\n$$\nZ_{\\mathrm{A}}\\approx \\frac{0.016}{0.061188234}\\approx 0.261488.\n$$\nRounded to $4$ significant figures, the standardized score for individual $\\mathrm{A}$ is $0.2615$.", "answer": "$$\\boxed{0.2615}$$", "id": "4375612"}]}