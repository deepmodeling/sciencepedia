{"hands_on_practices": [{"introduction": "A single gene activating its own expression is one of the simplest and most powerful network motifs. This positive-feedback loop is the core of many biological switches, enabling cells to make irreversible decisions and maintain distinct states, a property known as bistability. This practice will guide you through a classic dynamical systems analysis to uncover the precise mathematical conditions under which this motif can function as a robust genetic switch [@problem_id:4365984].", "problem": "Consider a positive-feedback network motif in systems biomedicine: a single self-activating gene whose product concentration $X(t)$ evolves according to a deterministic ordinary differential equation (ODE),\n$$\n\\frac{dX}{dt} \\;=\\; \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} \\;-\\; \\beta\\,X,\n$$\nwhere $\\alpha > 0$ is the maximal synthesis rate, $K > 0$ is the activation threshold, $n \\geq 1$ is the Hill cooperativity, and $\\beta > 0$ is the first-order degradation rate constant. Assume a well-stirred, constant-volume cell in which the Hill function $\\frac{X^{n}}{K^{n}+X^{n}}$ captures cooperative binding of $X$ to its own promoter. Use the standard definitions of steady state (roots of the right-hand side of the ODE) and local stability in one dimension (sign of the derivative of the right-hand side with respect to $X$ evaluated at the steady state).\n\nStarting from these definitions and the given ODE, complete the following in a logically consistent derivation grounded in these fundamentals:\n1. Derive the steady-state condition for $X$ and identify all possible steady states in terms of the parameters $\\alpha$, $\\beta$, $K$, and $n$.\n2. Determine the condition under which a saddle-node bifurcation occurs for $n > 1$, by requiring a double root of the steady-state equation. Use this double-root condition to find the critical concentration $X^{\\ast}$ at which the nullcline just touches the degradation line, and from it derive the corresponding critical value of $\\alpha$, denoted $\\alpha_{\\mathrm{SN}}(n,K,\\beta)$.\n3. Using the sign of the derivative of the right-hand side of the ODE at each steady state, explain why for $n > 1$ and $\\alpha > \\alpha_{\\mathrm{SN}}(n,K,\\beta)$ the system exhibits multiple stable equilibria with distinct basins of attraction.\n\nAs your final output, provide only the closed-form analytic expression for $\\alpha_{\\mathrm{SN}}(n,K,\\beta)$. Do not include units in the final expression. No numerical rounding is required.", "solution": "The problem asks for a multi-part derivation concerning a single-gene positive-feedback network motif described by a deterministic ordinary differential equation (ODE).\n\nThe governing ODE is:\n$$\n\\frac{dX}{dt} \\;=\\; f(X) \\;=\\; \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} \\;-\\; \\beta\\,X\n$$\nwhere $X(t)$ is the concentration of the gene product, and the parameters $\\alpha > 0$, $K > 0$, $n \\geq 1$, and $\\beta > 0$ are the maximal synthesis rate, activation threshold, Hill cooperativity, and degradation rate constant, respectively.\n\n### Step 1: Problem Validation\n\nThe problem is first validated against the required criteria.\n\n**1. Extract Givens:**\n*   ODE: $\\frac{dX}{dt} = \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} - \\beta\\,X$\n*   Parameters: $\\alpha > 0$, $K > 0$, $n \\geq 1$, $\\beta > 0$.\n*   Definition of Steady State: Points $X_{ss}$ where $\\frac{dX}{dt} = 0$.\n*   Definition of Local Stability (1D): Determined by the sign of $\\frac{df}{dX}$ evaluated at the steady state $X_{ss}$. A steady state is stable if $\\frac{df}{dX}  0$ and unstable if $\\frac{df}{dX} > 0$.\n\n**2. Validate Using Extracted Givens:**\n*   **Scientifically Grounded:** The model is a cornerstone of systems biology, representing a self-activating gene with cooperative binding (Hill kinetics) and first-order degradation. This is a well-established and scientifically sound model. The concepts of steady state, stability, and saddle-node bifurcation are fundamental principles of dynamical systems theory.\n*   **Well-Posed:** The problem is well-posed. It asks for specific, derivable quantities and a logical explanation based on the provided model and definitions. The questions are mathematically precise and lead to a unique set of answers.\n*   **Objective:** The language is formal, quantitative, and free of any subjective or ambiguous terminology.\n\n**3. Verdict and Action:**\nThe problem is deemed **valid**. It is scientifically sound, well-posed, and objective. The solution process may proceed.\n\n### Derivation of Solution\n\nThe solution is derived in three parts as requested.\n\n#### 1. Steady-State Condition\n\nA steady state, denoted $X_{ss}$, is a concentration at which the rate of change is zero. We set $\\frac{dX}{dt} = 0$:\n$$\n\\alpha\\,\\frac{X_{ss}^{n}}{K^{n} + X_{ss}^{n}} \\;-\\; \\beta\\,X_{ss} \\;=\\; 0\n$$\nThis equation can be rearranged:\n$$\nX_{ss} \\left( \\alpha\\,\\frac{X_{ss}^{n-1}}{K^{n} + X_{ss}^{n}} \\;-\\; \\beta \\right) \\;=\\; 0\n$$\nThis equation immediately yields one possible steady-state solution:\n$$\nX_{ss,1} = 0\n$$\nFor any non-zero steady states ($X_{ss} > 0$), we must satisfy the condition:\n$$\n\\alpha\\,\\frac{X_{ss}^{n-1}}{K^{n} + X_{ss}^{n}} \\;=\\; \\beta\n$$\nThis can be rewritten to define the non-zero steady states as the points of intersection between the synthesis rate curve, scaled by $1/X$, and the constant degradation rate $\\beta$:\n$$\n\\alpha\\,\\frac{X_{ss}^{n-1}}{K^{n} + X_{ss}^{n}} = \\beta \\quad \\text{or equivalently} \\quad \\alpha\\,\\frac{X_{ss}^{n}}{K^{n} + X_{ss}^{n}} = \\beta X_{ss}\n$$\nThe number of positive solutions depends on the parameters $\\alpha$, $\\beta$, $K$, and $n$. So, the steady states are $X=0$ and the positive roots of the equation $\\alpha X^{n-1} = \\beta(K^n + X^n)$.\n\n#### 2. Saddle-Node Bifurcation Condition\n\nA saddle-node bifurcation occurs when two steady states (one stable, one unstable) merge and annihilate. Mathematically, this corresponds to a point $X^{\\ast}$ that is a double root of the steady-state equation. This means that at $X^{\\ast}$, both the function $f(X)$ and its derivative $f'(X)$ are zero.\nLet $f(X) = \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} - \\beta\\,X$.\nThe conditions for the bifurcation are:\n1.  $f(X^{\\ast}) = \\alpha\\,\\frac{(X^{\\ast})^{n}}{K^{n} + (X^{\\ast})^{n}} - \\beta\\,X^{\\ast} = 0$\n2.  $f'(X^{\\ast}) = 0$\n\nFirst, we compute the derivative $f'(X)$:\n$$\nf'(X) = \\frac{d}{dX} \\left( \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} - \\beta\\,X \\right) = \\alpha \\frac{d}{dX}\\left(\\frac{X^n}{K^n+X^n}\\right) - \\beta\n$$\nUsing the quotient rule:\n$$\n\\frac{d}{dX}\\left(\\frac{X^n}{K^n+X^n}\\right) = \\frac{n X^{n-1}(K^n+X^n) - X^n(n X^{n-1})}{(K^n+X^n)^2} = \\frac{n K^n X^{n-1}}{(K^n+X^n)^2}\n$$\nSo, the derivative is:\n$$\nf'(X) = \\frac{\\alpha n K^n X^{n-1}}{(K^n+X^n)^2} - \\beta\n$$\nNow we set $f'(X^{\\ast}) = 0$:\n$$\n\\frac{\\alpha n K^n (X^{\\ast})^{n-1}}{(K^n+(X^{\\ast})^n)^2} = \\beta\n$$\nWe now have a system of two equations for the two unknowns, $X^{\\ast}$ and the critical value of $\\alpha$, which we denote $\\alpha_{\\mathrm{SN}}$. We solve for $X^{\\ast} > 0$ as the bifurcation cannot happen at $X=0$ since $f'(0) = -\\beta  0$.\n\nFrom condition $1$ ($f(X^{\\ast})=0$ for $X^{\\ast} > 0$):\n$$\n\\alpha_{\\mathrm{SN}} = \\beta X^{\\ast} \\frac{K^n+(X^{\\ast})^n}{(X^{\\ast})^n} \\quad (\\text{Eq. A})\n$$\nFrom condition $2$ ($f'(X^{\\ast})=0$):\n$$\n\\alpha_{\\mathrm{SN}} = \\beta \\frac{(K^n+(X^{\\ast})^n)^2}{n K^n (X^{\\ast})^{n-1}} \\quad (\\text{Eq. B})\n$$\nEquating the expressions for $\\alpha_{\\mathrm{SN}}$ from (A) and (B):\n$$\n\\beta X^{\\ast} \\frac{K^n+(X^{\\ast})^n}{(X^{\\ast})^n} = \\beta \\frac{(K^n+(X^{\\ast})^n)^2}{n K^n (X^{\\ast})^{n-1}}\n$$\nWe can cancel $\\beta$ and one factor of $(K^n+(X^{\\ast})^n)$ from both sides, as it is strictly positive:\n$$\n\\frac{X^{\\ast}}{(X^{\\ast})^n} = \\frac{K^n+(X^{\\ast})^n}{n K^n (X^{\\ast})^{n-1}}\n$$\nMultiplying both sides by $(X^{\\ast})^n$:\n$$\nX^{\\ast} = \\frac{(K^n+(X^{\\ast})^n) X^{\\ast}}{n K^n}\n$$\nSince we are looking for $X^{\\ast} > 0$, we can divide by $X^{\\ast}$:\n$$\n1 = \\frac{K^n+(X^{\\ast})^n}{n K^n}\n$$\n$$\nn K^n = K^n + (X^{\\ast})^n\n$$\nSolving for $(X^{\\ast})^n$:\n$$\n(X^{\\ast})^n = (n-1) K^n\n$$\nThis gives the critical concentration $X^{\\ast}$ at which the bifurcation occurs. This requires $n > 1$.\n$$\nX^{\\ast} = K (n-1)^{\\frac{1}{n}}\n$$\nNow, we substitute this back into Eq. A to find $\\alpha_{\\mathrm{SN}}$.\n$$\n\\alpha_{\\mathrm{SN}} = \\beta X^{\\ast} \\frac{K^n + (X^{\\ast})^n}{(X^{\\ast})^n} = \\beta \\left(K (n-1)^{\\frac{1}{n}}\\right) \\frac{K^n + (n-1)K^n}{(n-1)K^n}\n$$\n$$\n\\alpha_{\\mathrm{SN}} = \\beta K (n-1)^{\\frac{1}{n}} \\frac{n K^n}{(n-1)K^n} = \\beta K (n-1)^{\\frac{1}{n}} \\frac{n}{n-1}\n$$\n$$\n\\alpha_{\\mathrm{SN}} = \\beta n K \\frac{(n-1)^{\\frac{1}{n}}}{(n-1)^1} = \\beta n K (n-1)^{\\frac{1}{n}-1} = \\beta n K (n-1)^{\\frac{1-n}{n}}\n$$\nThis can be written more cleanly as:\n$$\n\\alpha_{\\mathrm{SN}}(n,K,\\beta) = \\frac{\\beta n K}{(n-1)^{\\frac{n-1}{n}}}\n$$\n\n#### 3. Multiple Stable Equilibria for $\\alpha > \\alpha_{\\mathrm{SN}}$\n\nFor $n > 1$, the synthesis rate term $S(X) = \\alpha \\frac{X^n}{K^n+X^n}$ is a sigmoidal (S-shaped) function of $X$. It starts at $S(0)=0$ with an initial slope of $S'(0)=0$, increases, and saturates at $S(\\infty)=\\alpha$. The degradation rate $D(X) = \\beta X$ is a straight line passing through the origin with a constant positive slope $\\beta$.\n\nThe steady states are the intersections of the curves $y=S(X)$ and $y=D(X)$.\n*   $X_{ss,1} = 0$ is always a steady state. Its stability is determined by $f'(0) = S'(0) - \\beta = 0 - \\beta = -\\beta$. Since $\\beta > 0$, $f'(0)  0$, so the zero steady state is always stable.\n\nThe condition $\\alpha = \\alpha_{\\mathrm{SN}}$ corresponds to the case where the line $y=\\beta X$ is exactly tangent to the sigmoidal curve $y=S(X)$ at the point $X = X^{\\ast}$.\n\nWhen we increase the synthesis rate such that $\\alpha > \\alpha_{\\mathrm{SN}}$, the sigmoidal curve $y=S(X)$ is scaled upwards. Because the initial slope of $S(X)$ is zero and its saturation value is higher, the line $y=\\beta X$ will now intersect the curve $y=S(X)$ at two positive concentrations, in addition to the intersection at the origin. Let's call these steady states $X_{ss,1}=0$, $X_{ss,2}$ (lower positive), and $X_{ss,3}$ (higher positive), ordered as $0 = X_{ss,1}  X_{ss,2}  X_{ss,3}$.\n\nWe analyze the stability of these three steady states using the sign of $f'(X_{ss}) = S'(X_{ss}) - \\beta$.\n1.  **At $X_{ss,1} = 0$**: We already showed this is stable ($f'(0)  0$).\n2.  **At $X_{ss,2}$**: At this lower positive intersection, the sigmoidal curve $S(X)$ must cross the line $\\beta X$ from below. This implies that the slope of the sigmoid at this point must be greater than the slope of the line: $S'(X_{ss,2}) > \\beta$. Therefore, $f'(X_{ss,2}) = S'(X_{ss,2}) - \\beta > 0$. This steady state is **unstable**.\n3.  **At $X_{ss,3}$**: At this higher positive intersection, the sigmoidal curve $S(X)$ must cross the line $\\beta X$ from above. This implies that the slope of the sigmoid at this point must be less than the slope of the line: $S'(X_{ss,3})  \\beta$. Therefore, $f'(X_{ss,3}) = S'(X_{ss,3}) - \\beta  0$. This steady state is **stable**.\n\nThus, for $n > 1$ and $\\alpha > \\alpha_{\\mathrm{SN}}(n,K,\\beta)$, the system has three steady states arranged in a stable-unstable-stable configuration. This is the hallmark of bistability.\n\nThe two stable equilibria, $X_{ss,1}=0$ (an \"OFF\" state) and $X_{ss,3}>0$ (an \"ON\" state), have distinct basins of attraction. The unstable steady state $X_{ss,2}$ acts as a threshold or separatrix.\n*   If the initial concentration $X(0)$ is in the interval $[0, X_{ss,2})$, the system will evolve to the stable steady state at $X_{ss,1}=0$. This interval is the basin of attraction for the OFF state.\n*   If the initial concentration $X(0)$ is in the interval $(X_{ss,2}, \\infty)$, the system will evolve to the stable steady state at $X_{ss,3}$. This interval is the basin of attraction for the ON state.\n\nThe existence of two stable equilibria with distinct basins of attraction means the system exhibits multistability, allowing it to act as a switch or a memory module, depending on its history of stimulation.", "answer": "$$\n\\boxed{\\frac{\\beta n K}{(n-1)^{\\frac{n-1}{n}}}}\n$$", "id": "4365984"}, {"introduction": "While positive feedback creates switches, negative feedback is the cornerstone of homeostasis, allowing systems to maintain a stable set point. However, biological processes are not instantaneous; transcription, translation, and transport all introduce time delays. This exercise demonstrates how such a delay can fundamentally change the behavior of a negative-feedback loop, transforming it from a simple stabilizer into a source of sustained oscillations, the basis of biological clocks and rhythmic processes [@problem_id:4365931].", "problem": "A single-gene negative feedback motif is modeled as a delayed regulatory system with explicit synthesis delay, representative of transcription-translation processing time in cell biology. Let the concentration of a gene product be denoted by $X(t)$ and suppose its temporal evolution obeys the scalar delay differential equation\n$$\n\\frac{dX}{dt} \\;=\\; f\\!\\left(X(t-\\tau)\\right) \\;-\\; \\beta\\, X(t),\n$$\nwhere $\\beta > 0$ is the first-order degradation rate constant and $f$ is a smooth production function implementing negative feedback, meaning $f$ is strictly decreasing near a relevant steady state. Assume there exists a steady state $X^{\\ast}$ satisfying $f(X^{\\ast})=\\beta\\,X^{\\ast}$, and define the local feedback slope $\\alpha \\equiv f'(X^{\\ast})  0$. In the limit $\\tau=0$, the negative feedback motif achieves homeostasis at $X^{\\ast}$.\n\nStarting from fundamental principles of linearization around $X^{\\ast}$, the definition of stability via exponential ansatz, and the separation of real and imaginary parts of complex roots, analyze how a finite delay $\\tau > 0$ can destabilize $X^{\\ast}$ through an oscillatory instability. Under the biologically realistic parameter condition $|\\alpha| > \\beta > 0$, derive a closed-form analytic expression for the smallest positive delay $\\tau_{c}$ at which the steady state $X^{\\ast}$ loses stability via a Hopf bifurcation, expressed purely in terms of $\\alpha$ and $\\beta$. Your final answer must be a single analytic expression. No rounding is required, and no units should be included in the final expression.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded, well-posed, and contains all necessary information to derive a unique, meaningful solution. The model and the question are standard in the field of dynamical systems applied to biology.\n\nThe temporal evolution of the gene product concentration, denoted by $X(t)$, is governed by the delay differential equation:\n$$\n\\frac{dX}{dt} = f\\left(X(t-\\tau)\\right) - \\beta X(t)\n$$\nHere, $\\beta > 0$ is the degradation rate constant, $\\tau > 0$ is the time delay, and $f$ is the production function. The system has a steady state $X^{\\ast}$ defined by the condition that the rate of change is zero:\n$$\n\\frac{dX}{dt} = 0 \\implies f(X^{\\ast}) = \\beta X^{\\ast}\n$$\nTo analyze the stability of this steady state, we linearize the system around $X^{\\ast}$. Let $x(t) = X(t) - X^{\\ast}$ be a small perturbation from the steady state. Substituting $X(t) = X^{\\ast} + x(t)$ into the governing equation gives:\n$$\n\\frac{d}{dt}(X^{\\ast} + x(t)) = f\\left(X^{\\ast} + x(t-\\tau)\\right) - \\beta (X^{\\ast} + x(t))\n$$\nSince $X^{\\ast}$ is a constant, $\\frac{d(X^{\\ast})}{dt} = 0$. The left-hand side becomes $\\frac{dx}{dt}$. For the term $f(X^{\\ast} + x(t-\\tau))$, we perform a first-order Taylor expansion around $X^{\\ast}$:\n$$\nf\\left(X^{\\ast} + x(t-\\tau)\\right) \\approx f(X^{\\ast}) + f'(X^{\\ast}) x(t-\\tau)\n$$\nThe problem defines the local feedback slope as $\\alpha \\equiv f'(X^{\\ast})$. Since the feedback is negative, $\\alpha  0$. The linearized equation becomes:\n$$\n\\frac{dx}{dt} \\approx \\left( f(X^{\\ast}) + \\alpha x(t-\\tau) \\right) - \\beta (X^{\\ast} + x(t))\n$$\nUsing the steady-state condition $f(X^{\\ast}) = \\beta X^{\\ast}$, we simplify the equation:\n$$\n\\frac{dx}{dt} = \\beta X^{\\ast} + \\alpha x(t-\\tau) - \\beta X^{\\ast} - \\beta x(t)\n$$\nThis yields the linear delay differential equation for the perturbation $x(t)$:\n$$\n\\frac{dx}{dt} = \\alpha x(t-\\tau) - \\beta x(t)\n$$\nTo determine the stability of the zero solution $x(t) = 0$ (which corresponds to the stability of the steady state $X^{\\ast}$), we use the exponential ansatz $x(t) = C e^{\\lambda t}$, where $\\lambda$ is a complex eigenvalue and $C$ is a constant. Substituting this into the linearized equation gives:\n$$\n\\lambda C e^{\\lambda t} = \\alpha C e^{\\lambda (t-\\tau)} - \\beta C e^{\\lambda t}\n$$\nDividing by $C e^{\\lambda t}$ (assuming $C \\neq 0$) yields the characteristic equation for the eigenvalues $\\lambda$:\n$$\n\\lambda = \\alpha e^{-\\lambda \\tau} - \\beta\n$$\nThe steady state $X^{\\ast}$ is stable if all eigenvalues $\\lambda$ have negative real parts, i.e., $\\text{Re}(\\lambda)  0$. A loss of stability occurs when at least one eigenvalue or a pair of complex conjugate eigenvalues crosses the imaginary axis. A Hopf bifurcation corresponds to a pair of complex conjugate eigenvalues crossing the imaginary axis with non-zero speed. At the bifurcation point, the real part of these eigenvalues is zero. We thus set $\\lambda = i\\omega$, where $\\omega$ is the real-valued angular frequency of the resulting oscillations. We can assume $\\omega > 0$ without loss of generality, as the eigenvalues appear in complex conjugate pairs.\n\nSubstituting $\\lambda = i\\omega$ into the characteristic equation:\n$$\ni\\omega = \\alpha e^{-i\\omega\\tau} - \\beta\n$$\nWe use Euler's formula, $e^{-i\\omega\\tau} = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$, to separate the real and imaginary parts of the equation:\n$$\ni\\omega + \\beta = \\alpha (\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n$$\n\\beta + i\\omega = \\alpha\\cos(\\omega\\tau) - i\\alpha\\sin(\\omega\\tau)\n$$\nEquating the real and imaginary parts on both sides gives a system of two equations:\n1. Real part: $\\beta = \\alpha\\cos(\\omega\\tau)$\n2. Imaginary part: $\\omega = -\\alpha\\sin(\\omega\\tau)$\n\nFrom these two equations, we can solve for the bifurcation frequency $\\omega$ and the critical delay $\\tau_c$. From equation (1), we have $\\cos(\\omega\\tau) = \\frac{\\beta}{\\alpha}$. From equation (2), we have $\\sin(\\omega\\tau) = -\\frac{\\omega}{\\alpha}$. Using the trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$\n\\left(\\frac{\\beta}{\\alpha}\\right)^2 + \\left(-\\frac{\\omega}{\\alpha}\\right)^2 = 1\n$$\n$$\n\\frac{\\beta^2}{\\alpha^2} + \\frac{\\omega^2}{\\alpha^2} = 1\n$$\n$$\n\\beta^2 + \\omega^2 = \\alpha^2\n$$\nSolving for $\\omega^2$:\n$$\n\\omega^2 = \\alpha^2 - \\beta^2\n$$\nFor an oscillatory instability to occur, we need a real, non-zero frequency $\\omega$, which requires $\\omega^2 > 0$. This means $\\alpha^2 - \\beta^2 > 0$, or $\\alpha^2 > \\beta^2$. Since both $|\\alpha|$ and $\\beta$ are positive, this is equivalent to $|\\alpha| > \\beta$, a condition explicitly given in the problem statement. Thus, the frequency of oscillation at the bifurcation point is:\n$$\n\\omega = \\sqrt{\\alpha^2 - \\beta^2}\n$$\nNow we solve for the delay $\\tau$. We have the conditions:\n$$\n\\cos(\\omega\\tau) = \\frac{\\beta}{\\alpha} \\quad \\text{and} \\quad \\sin(\\omega\\tau) = -\\frac{\\omega}{\\alpha}\n$$\nGiven that $\\alpha  0$ and $\\beta > 0$, the ratio $\\frac{\\beta}{\\alpha}$ is negative. Thus, $\\cos(\\omega\\tau)  0$.\nGiven $\\omega > 0$ and $\\alpha  0$, the ratio $-\\frac{\\omega}{\\alpha}$ is positive. Thus, $\\sin(\\omega\\tau) > 0$.\nAn angle whose cosine is negative and sine is positive must lie in the second quadrant. The values of $\\omega\\tau$ satisfying these conditions are given by:\n$$\n\\omega\\tau = \\arccos\\left(\\frac{\\beta}{\\alpha}\\right) + 2\\pi k\n$$\nfor any integer $k \\geq 0$. The principal value of the $\\arccos$ function for a negative argument lies in the interval $(\\frac{\\pi}{2}, \\pi]$, which corresponds to an angle in the second quadrant, satisfying our sign conditions.\n\nThe possible values for the delay $\\tau$ are:\n$$\n\\tau = \\frac{1}{\\omega} \\left( \\arccos\\left(\\frac{\\beta}{\\alpha}\\right) + 2\\pi k \\right)\n$$\nWe are asked for the smallest positive delay, $\\tau_c$, at which stability is lost. This corresponds to the smallest positive value of $\\tau$, which is obtained by setting $k=0$:\n$$\n\\tau_c = \\frac{1}{\\omega} \\arccos\\left(\\frac{\\beta}{\\alpha}\\right)\n$$\nSubstituting the expression for $\\omega= \\sqrt{\\alpha^2 - \\beta^2}$:\n$$\n\\tau_c = \\frac{1}{\\sqrt{\\alpha^2 - \\beta^2}} \\arccos\\left(\\frac{\\beta}{\\alpha}\\right)\n$$\nThis is the closed-form analytic expression for the critical delay $\\tau_c$ in terms of $\\alpha$ and $\\beta$.", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{\\alpha^2 - \\beta^2}} \\arccos\\left(\\frac{\\beta}{\\alpha}\\right)}\n$$", "id": "4365931"}, {"introduction": "Beyond simple switches and oscillators, network motifs can perform sophisticated signal processing tasks. The coherent feed-forward loop (FFL) is a prime example, often acting as a \"persistence detector\" that filters out transient noise while responding to sustained signals. Moving from analytical derivation to computational practice, this exercise challenges you to build and simulate a model of this FFL, using nondimensionalization to identify the key parameter regimes that enable this powerful filtering function [@problem_id:4366014].", "problem": "Consider the coherent Feed-Forward Loop (FFL) network motif in gene regulation, where an upstream signal activates transcription factor $X$, which activates transcription factor $Y$, and both $X$ and $Y$ are required (logical AND) to activate the target gene product $Z$. Let the dimensional dynamics follow ordinary differential equations that are standard in systems biomedicine for regulated gene expression: production is monotonic in the regulator via a Hill function and proteins decay with first-order kinetics. Start from the fundamental base that gene product dynamics can be modeled by\n$$\n\\frac{dX}{dt} = k_X\\,H_S\\!\\left(S(t)\\right) - \\frac{X}{\\tau_X},\\quad\n\\frac{dY}{dt} = k_Y\\,H_X\\!\\left(X\\right) - \\frac{Y}{\\tau_Y},\\quad\n\\frac{dZ}{dt} = k_Z\\,H_{\\text{AND}}\\!\\left(X,Y\\right) - \\frac{Z}{\\tau_Z},\n$$\nwhere $H_S$, $H_X$, and $H_Y$ are Hill-type activation functions with dissociation constants $K_S$, $K_X$, and $K_Y$, respectively, $H_{\\text{AND}}$ is the logical AND implemented by multiplication of the underlying Hill activations, $k_X$, $k_Y$, $k_Z$ are maximal production rates, and $\\tau_X$, $\\tau_Y$, $\\tau_Z$ are characteristic decay times. The input signal is a rectangular pulse $S(t)$ of amplitude $S_0$ and duration $T_{\\text{on}}$, i.e., $S(t)=S_0$ for $0 \\le t  T_{\\text{on}}$ and $S(t)=0$ for $t \\ge T_{\\text{on}}$. Assume the Hill coefficient is $n$ for all regulatory interactions.\n\nUsing nondimensionalization, define $x=X/K_X$, $y=Y/K_Y$, $z=Z/K_Z$, and dimensionless time $t^*=t/\\tau_Z$. Let $s(t^*)=S(t)/K_S$ be the dimensionless input amplitude. Derive and implement the dimensionless system in your program using\n$$\n\\frac{dx}{dt^*} = a_X\\,h\\!\\left(s(t^*)\\right) - \\rho_X\\,x,\\quad\n\\frac{dy}{dt^*} = a_Y\\,h\\!\\left(x\\right) - \\rho_Y\\,y,\\quad\n\\frac{dz}{dt^*} = a_Z\\,\\big[h\\!\\left(x\\right)\\,h\\!\\left(y\\right)\\big] - z,\n$$\nwith $h(u)=\\dfrac{u^n}{1+u^n}$, $a_X=\\dfrac{k_X\\,\\tau_Z}{K_X}$, $a_Y=\\dfrac{k_Y\\,\\tau_Z}{K_Y}$, $a_Z=\\dfrac{k_Z\\,\\tau_Z}{K_Z}$, and the time-scale ratios $\\rho_X=\\dfrac{\\tau_Z}{\\tau_X}$, $\\rho_Y=\\dfrac{\\tau_Z}{\\tau_Y}$. The initial conditions are $x(0)=0$, $y(0)=0$, $z(0)=0$.\n\nDefine the persistence detection criterion as follows: for a given parameter set and two pulse durations, a \"short\" duration $T_{\\text{short}}$ and a \"long\" duration $T_{\\text{long}}$, persistence detection is classified as robust if both conditions hold:\n- The maximum of $z(t^*)$ over $t^*\\in[0,T_{\\text{sim}}]$ under the short pulse ($T_{\\text{on}}=T_{\\text{short}}$) does not exceed a low threshold $\\theta_{\\text{low}}$, i.e., $\\max z_{\\text{short}}\\le \\theta_{\\text{low}}$.\n- The maximum of $z(t^*)$ over $t^*\\in[0,T_{\\text{sim}}]$ under the long pulse ($T_{\\text{on}}=T_{\\text{long}}$) exceeds a high threshold $\\theta_{\\text{high}}$, i.e., $\\max z_{\\text{long}}\\ge \\theta_{\\text{high}}$.\n\nUse the following thresholds in dimensionless units: $\\theta_{\\text{low}}=0.25$ and $\\theta_{\\text{high}}=0.60$. The dimensionless input $s(t^*)$ equals $s_0$ for $0 \\le t^*  T_{\\text{on}}$ and $0$ otherwise, where $s_0=S_0/K_S$.\n\nYour program must simulate the dimensionless system for each parameter set twice (once with $T_{\\text{on}}=T_{\\text{short}}$ and once with $T_{\\text{on}}=T_{\\text{long}}$), compute the maxima of $z(t^*)$ in each run over the interval $t^*\\in[0,T_{\\text{sim}}]$, and output a boolean for each parameter set indicating whether the persistence detection is robust according to the criterion.\n\nTest suite (each tuple is $(a_X,a_Y,a_Z,\\rho_X,\\rho_Y,n,s_0,T_{\\text{short}},T_{\\text{long}},T_{\\text{sim}})$):\n- Case A (general \"happy path\"): $(4.0,4.0,5.0,6.0,0.4,2,3.0,0.2,2.5,5.0)$.\n- Case B (both regulators fast, expected non-robust): $(4.0,4.0,4.0,6.0,6.0,2,3.0,0.2,2.5,5.0)$.\n- Case C (weak $Y$ and $Z$ production, borderline): $(3.0,1.5,2.0,4.0,1.2,2,2.0,0.4,2.0,4.0)$.\n- Case D (very slow $Y$ requiring longer input, edge): $(4.0,4.0,5.0,4.0,0.2,2,3.0,0.2,5.0,8.0)$.\n- Case E (weak input amplitude, expected non-robust): $(4.0,4.0,4.0,6.0,0.5,2,0.8,1.0,3.0,5.0)$.\n\nAlgorithmic requirements:\n- Implement the piecewise constant input $s(t^*)$ exactly as specified.\n- Use numerical integration to solve the system over $[0,T_{\\text{sim}}]$ for each run.\n- Compute $\\max z$ for the short and long pulses and apply the thresholds.\n- Aggregate boolean results for all cases into a single line.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4,result_5]$), where each $result_i$ is either $True$ or $False$. There are no physical units, and all quantities are dimensionless.", "solution": "The problem requires the analysis of a coherent Type-1 Feed-Forward Loop (FFL), a common network motif in gene regulation. The specific task is to determine if the network acts as a robust persistence detector for a given set of parameters. A persistence detector is a system that responds to long-duration input signals but filters out short, transient ones. The analysis will be performed on a non-dimensionalized system of ordinary differential equations (ODEs).\n\nFirst, let us re-state the dimensionless system of ODEs given in the problem statement, which models the concentrations of the gene products $x$, $y$, and $z$:\n$$\n\\frac{dx}{dt^*} = a_X\\,h\\!\\left(s(t^*)\\right) - \\rho_X\\,x\n$$\n$$\n\\frac{dy}{dt^*} = a_Y\\,h\\!\\left(x\\right) - \\rho_Y\\,y\n$$\n$$\n\\frac{dz}{dt^*} = a_Z\\,\\big[h\\!\\left(x\\right)\\,h\\!\\left(y\\right)\\big] - z\n$$\nThe system is subject to the initial conditions $x(0)=0$, $y(0)=0$, and $z(0)=0$.\n\nThe components of these equations are defined as follows:\n-   $t^*$ is the dimensionless time.\n-   $x(t^*)$, $y(t^*)$, and $z(t^*)$ are the dimensionless concentrations of the gene products $X$, $Y$, and $Z$.\n-   $s(t^*)$ is the dimensionless input signal, which is a rectangular pulse: $s(t^*) = s_0$ for $0 \\le t^*  T_{\\text{on}}$ and $s(t^*) = 0$ for $t^* \\ge T_{\\text{on}}$. $T_{\\text{on}}$ represents the dimensionless duration of the pulse.\n-   $h(u) = \\frac{u^n}{1+u^n}$ is the dimensionless Hill activation function, where $n$ is the Hill coefficient. This function describes the sigmoidal response of gene expression to the concentration of a regulator $u$.\n-   The term $h(x)h(y)$ models the logical AND gate, where both $X$ and $Y$ are required to activate $Z$.\n-   $a_X, a_Y, a_Z$ are dimensionless maximum production rates.\n-   $\\rho_X = \\tau_Z/\\tau_X$ and $\\rho_Y = \\tau_Z/\\tau_Y$ are ratios of characteristic decay times. A large value of $\\rho_i$ means that species $i$ decays much faster than species $Z$, indicating a fast response time. Conversely, a small $\\rho_i$ indicates a slow response.\n\nThe problem defines a quantitative criterion for robust persistence detection. For each parameter set, the system's response to both a \"short\" pulse ($T_{\\text{on}} = T_{\\text{short}}$) and a \"long\" pulse ($T_{\\text{on}} = T_{\\text{long}}$) must be evaluated. The criterion is met if:\n1.  The maximum concentration of the output, $\\max z_{\\text{short}}$, achieved during the simulation interval $[0, T_{\\text{sim}}]$ in response to the short pulse does not exceed a low threshold: $\\max z_{\\text{short}} \\le \\theta_{\\text{low}}$, where $\\theta_{\\text{low}} = 0.25$.\n2.  The maximum concentration, $\\max z_{\\text{long}}$, in response to the long pulse exceeds a high threshold: $\\max z_{\\text{long}} \\ge \\theta_{\\text{high}}$, where $\\theta_{\\text{high}} = 0.60$.\n\nTo solve this, we must numerically integrate the system of ODEs for each of the five test cases provided. For each test case, two separate simulations are required: one with the short pulse duration and one with the long pulse duration.\n\nThe overall algorithmic procedure is as follows:\n1.  For each parameter set $(a_X, a_Y, a_Z, \\rho_X, \\rho_Y, n, s_0, T_{\\text{short}}, T_{\\text{long}}, T_{\\text{sim}})$:\n    a.  Define the ODE system function. This function, say `odes(t, state, params)`, will compute the time derivatives $(dx/dt^*, dy/dt^*, dz/dt^*)$ given the current time $t^*$, the state vector `state` $= [x, y, z]$, and the relevant parameters. A crucial part of this function is implementing the piecewise nature of the input signal $s(t^*)$.\n    b.  **Short Pulse Simulation**:\n        i.  Set the pulse duration parameter $T_{\\text{on}}$ to $T_{\\text{short}}$.\n        ii. Use a numerical ODE solver, such as `scipy.integrate.solve_ivp`, to solve the system from $t^*=0$ to $t^*=T_{\\text{sim}}$ with initial conditions $[0, 0, 0]$.\n        iii. From the solution, extract the trajectory for $z(t^*)$ and find its maximum value, $\\max z_{\\text{short}}$.\n    c.  **Long Pulse Simulation**:\n        i.  Set the pulse duration parameter $T_{\\text{on}}$ to $T_{\\text{long}}$.\n        ii. Repeat the numerical integration over the same interval $[0, T_{\\text{sim}}]$.\n        iii. Find the maximum value of the resulting $z(t^*)$ trajectory, $\\max z_{\\text{long}}$.\n    d.  **Apply Criterion**:\n        i.  Evaluate the boolean expression $(\\max z_{\\text{short}} \\le \\theta_{\\text{low}})$ AND $(\\max z_{\\text{long}} \\ge \\theta_{\\text{high}})$.\n        ii. Store the resulting boolean value (`True` or `False`).\n2.  After processing all test cases, compile the list of boolean results.\n3.  Format the final output as a comma-separated string of boolean values enclosed in square brackets.\n\nThe implementation will utilize the `solve_ivp` function from the `scipy.integrate` library, which provides a robust and efficient way to solve initial value problems for systems of ODEs. The function dynamically adjusts its step size to meet error tolerances, ensuring an accurate solution profile from which the maximum of $z(t^*)$ can be reliably determined. The logic for the piecewise-constant input signal $s(t^*)$ will be encoded directly into the function that defines the ODE system, making it accessible to the solver at each time step.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coherent FFL persistence detection problem for a suite of test cases.\n    \"\"\"\n    # Define dimensionless thresholds for persistence detection\n    theta_low = 0.25\n    theta_high = 0.60\n\n    # Test suite: each tuple is (a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_short, T_long, T_sim)\n    test_cases = [\n        # Case A (general \"happy path\")\n        (4.0, 4.0, 5.0, 6.0, 0.4, 2, 3.0, 0.2, 2.5, 5.0),\n        # Case B (both regulators fast, expected non-robust)\n        (4.0, 4.0, 4.0, 6.0, 6.0, 2, 3.0, 0.2, 2.5, 5.0),\n        # Case C (weak Y and Z production, borderline)\n        (3.0, 1.5, 2.0, 4.0, 1.2, 2, 2.0, 0.4, 2.0, 4.0),\n        # Case D (very slow Y requiring longer input, edge)\n        (4.0, 4.0, 5.0, 4.0, 0.2, 2, 3.0, 0.2, 5.0, 8.0),\n        # Case E (weak input amplitude, expected non-robust)\n        (4.0, 4.0, 4.0, 6.0, 0.5, 2, 0.8, 1.0, 3.0, 5.0),\n    ]\n\n    results = []\n\n    def hill(u, n):\n        \"\"\"Dimensionless Hill activation function.\"\"\"\n        # Add a small epsilon to avoid division by zero or log(0) issues if u is negative,\n        # although concentrations should be non-negative.\n        u_pow_n = np.power(max(0, u), n)\n        return u_pow_n / (1.0 + u_pow_n)\n\n    def ffl_odes(t, state, params):\n        \"\"\"\n        Defines the system of ordinary differential equations for the coherent FFL.\n        \"\"\"\n        x, y, z = state\n        a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_on = params\n\n        # Implement the rectangular pulse for the input signal s(t*)\n        current_s = s0 if 0 = t  T_on else 0.0\n\n        h_s = hill(current_s, n)\n        h_x = hill(x, n)\n        h_y = hill(y, n)\n\n        dxdt = a_X * h_s - rho_X * x\n        dydt = a_Y * h_x - rho_Y * y\n        dzdt = a_Z * h_x * h_y - z\n\n        return [dxdt, dydt, dzdt]\n\n    for case in test_cases:\n        a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_short, T_long, T_sim = case\n        \n        # Initial conditions for all simulations\n        y0 = [0.0, 0.0, 0.0]\n        t_span = [0, T_sim]\n\n        # --- Short pulse simulation ---\n        params_short = (a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_short)\n        sol_short = solve_ivp(\n            fun=ffl_odes,\n            t_span=t_span,\n            y0=y0,\n            args=(params_short,),\n            dense_output=True # Ensures we can find a smooth maximum\n        )\n        z_short_trajectory = sol_short.y[2]\n        max_z_short = np.max(z_short_trajectory) if z_short_trajectory.size > 0 else 0.0\n        \n        # --- Long pulse simulation ---\n        params_long = (a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_long)\n        sol_long = solve_ivp(\n            fun=ffl_odes,\n            t_span=t_span,\n            y0=y0,\n            args=(params_long,),\n            dense_output=True\n        )\n        z_long_trajectory = sol_long.y[2]\n        max_z_long = np.max(z_long_trajectory) if z_long_trajectory.size > 0 else 0.0\n\n        # --- Apply persistence detection criterion ---\n        is_robust = (max_z_short = theta_low) and (max_z_long >= theta_high)\n        results.append(is_robust)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4366014"}]}