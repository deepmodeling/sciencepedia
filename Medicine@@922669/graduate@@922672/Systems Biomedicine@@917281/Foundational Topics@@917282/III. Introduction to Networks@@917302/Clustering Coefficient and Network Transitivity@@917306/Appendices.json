{"hands_on_practices": [{"introduction": "To appreciate the significance of clustering in real biological networks, we must first understand what to expect in a network without any inherent clustering structure. The Erdős–Rényi random graph provides a fundamental baseline for this comparison. This exercise [@problem_id:4327825] guides you through a first-principles derivation of network transitivity in this model, revealing how this global property is directly linked to the simple probability of edge formation.", "problem": "A simplified baseline model for a biomolecular interaction network treats the network as an undirected, simple graph generated by the Erdős–Rényi (ER) model, where every possible pair of distinct biomolecular entities (nodes) is connected independently with probability $p$ in a graph on $n$ nodes, denoted $G(n,p)$. In systems biomedicine, network transitivity (also known as the global clustering coefficient) quantifies the propensity of triadic closure: the tendency that if two biomolecules both interact with a third, they also interact with each other. The global transitivity is defined using two motif counts: the total number of triangles and the total number of connected triples (wedges). A triangle is an unordered triple of distinct nodes $\\{i,j,k\\}$ with all three possible edges present. A connected triple (wedge) is an unordered triple of distinct nodes with exactly two edges present that share a common center node, and we count wedges by summing, at each node, the number of unordered neighbor pairs.\n\nLet $N_{\\triangle}$ denote the total number of triangles in $G(n,p)$ and let $N_{\\wedge}$ denote the total number of wedges in $G(n,p)$, obtained by summing over nodes the number of unordered neighbor pairs. The global transitivity is then defined as $T = \\dfrac{3 N_{\\triangle}}{N_{\\wedge}}$, where the factor of $3$ accounts for the three wedges contained in each triangle, one centered at each vertex of the triangle.\n\nStarting only from the ER generative assumptions (edge independence with probability $p$), the combinatorial definitions above, and standard properties of binomially distributed degrees in $G(n,p)$, derive expressions for the expected number of triangles $\\mathbb{E}[N_{\\triangle}]$ and the expected number of wedges $\\mathbb{E}[N_{\\wedge}]$. Then compute the ratio\n$$\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]},$$\nexpressed as a closed-form analytic expression in terms of $n$ and $p$. Provide only this ratio as your final answer. No rounding is required and no units are involved.", "solution": "The problem asks for the derivation of the ratio $\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]}$ in an Erdős–Rényi (ER) graph $G(n,p)$, where $N_{\\triangle}$ is the number of triangles and $N_{\\wedge}$ is the number of wedges (connected triples). We proceed by first calculating the expected value of each quantity.\n\nFirst, let us calculate the expected number of triangles, $\\mathbb{E}[N_{\\triangle}]$.\nA triangle is formed by a set of three distinct nodes, say $\\{i, j, k\\}$, if the edges $(i,j)$, $(j,k)$, and $(k,i)$ all exist in the graph. In the $G(n,p)$ model, each possible edge exists independently with probability $p$.\n\nThe total number of ways to choose an unordered set of $3$ distinct nodes from the $n$ nodes in the graph is given by the binomial coefficient $\\binom{n}{3}$.\nLet us define an indicator random variable $I_{ijk}$ for each distinct triple of nodes $\\{i, j, k\\}$. The variable $I_{ijk}$ is defined as:\n$$\nI_{ijk} = \\begin{cases} 1  \\text{if nodes } \\{i, j, k\\} \\text{ form a triangle} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe total number of triangles in the graph, $N_{\\triangle}$, is the sum of these indicator variables over all possible distinct triples:\n$$\nN_{\\triangle} = \\sum_{1 \\le i  j  k \\le n} I_{ijk}\n$$\nBy linearity of expectation, the expected number of triangles is:\n$$\n\\mathbb{E}[N_{\\triangle}] = \\mathbb{E}\\left[\\sum_{1 \\le i  j  k \\le n} I_{ijk}\\right] = \\sum_{1 \\le i  j  k \\le n} \\mathbb{E}[I_{ijk}]\n$$\nThe expected value of an indicator variable is the probability of the event it indicates. The event that $\\{i, j, k\\}$ forms a triangle occurs if and only if the three edges $(i,j)$, $(j,k)$, and $(k,i)$ are all present. Due to the independence of edges in the ER model, the probability of this is $p \\times p \\times p = p^3$.\n$$\n\\mathbb{E}[I_{ijk}] = P(I_{ijk}=1) = p^3\n$$\nThe number of terms in the summation is the total number of distinct triples, which is $\\binom{n}{3}$. Therefore, the expected number of triangles is:\n$$\n\\mathbb{E}[N_{\\triangle}] = \\binom{n}{3} p^3 = \\frac{n(n-1)(n-2)}{3 \\cdot 2 \\cdot 1} p^3 = \\frac{n(n-1)(n-2)}{6} p^3\n$$\n\nNext, we calculate the expected number of wedges, $\\mathbb{E}[N_{\\wedge}]$.\nThe problem provides a specific counting method for $N_{\\wedge}$: \"summing, at each node, the number of unordered neighbor pairs\". Let $k_j$ be the degree of node $j$. The number of unordered pairs of neighbors of node $j$ is $\\binom{k_j}{2}$. Thus, the total number of wedges is given by:\n$$\nN_{\\wedge} = \\sum_{j=1}^{n} \\binom{k_j}{2}\n$$\nThis quantity counts the number of paths of length $2$ in the graph. Using linearity of expectation, we have:\n$$\n\\mathbb{E}[N_{\\wedge}] = \\mathbb{E}\\left[\\sum_{j=1}^{n} \\binom{k_j}{2}\\right] = \\sum_{j=1}^{n} \\mathbb{E}\\left[\\binom{k_j}{2}\\right]\n$$\nDue to the symmetry of the $G(n,p)$ model, the expected value $\\mathbb{E}\\left[\\binom{k_j}{2}\\right]$ is the same for all nodes $j$. We can therefore calculate it for an arbitrary node and multiply by $n$.\n$$\n\\mathbb{E}[N_{\\wedge}] = n \\cdot \\mathbb{E}\\left[\\binom{k_1}{2}\\right]\n$$\nLet us find an alternative way to express this expectation. A wedge, or a path of length $2$, is defined by a central node and two of its neighbors. Let's consider a specific ordered triple of distinct nodes $(i, j, k)$. This forms a wedge with $j$ as the center if edges $(i,j)$ and $(k,j)$ exist. The number of possible ordered triples of distinct nodes is $n(n-1)(n-2)$.\nThe total number of wedges, $N_{\\wedge}$, can be seen as the number of pairs of edges that share a vertex. Let $W_{ijk}$ be an indicator variable that is $1$ if the path $i-j-k$ exists (i.e., edges $(i,j)$ and $(j,k)$ are present).\nThe total number of such paths of length $2$, counted by ordered triples of nodes, would be $\\sum_{(i,j,k)} W_{ijk}$. The expectation is $n(n-1)(n-2)p^2$. However, the quantity $N_{\\wedge}$ corresponds to unordered pairs of neighbors at each center.\nAn unordered pair of neighbors $\\{i,k\\}$ of a central node $j$ corresponds to exactly one wedge centered at $j$. The number of ways to choose a central node $j$ is $n$. The number of ways to choose two other distinct nodes $i$ and $k$ to be the endpoints is $\\binom{n-1}{2}$.\nLet's define an indicator random variable $W_{j, \\{i,k\\}}$ for each potential wedge, where $j$ is the center and $\\{i,k\\}$ are the endpoints.\n$$\nW_{j, \\{i,k\\}} = \\begin{cases} 1  \\text{if edges } (i,j) \\text{ and } (k,j) \\text{ exist} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe total number of wedges is the sum of these indicators over all possible choices of a center $j$ and a pair of endpoints $\\{i,k\\}$:\n$$\nN_{\\wedge} = \\sum_{j=1}^{n} \\sum_{1 \\le i  k \\le n, i,k \\ne j} W_{j, \\{i,k\\}}\n$$\nBy linearity of expectation:\n$$\n\\mathbb{E}[N_{\\wedge}] = \\sum_{j=1}^{n} \\sum_{1 \\le i  k \\le n, i,k \\ne j} \\mathbb{E}[W_{j, \\{i,k\\}}]\n$$\nFor any such potential wedge, the two edges $(i,j)$ and $(k,j)$ are distinct and thus exist independently with probability $p$. Therefore:\n$$\n\\mathbb{E}[W_{j, \\{i,k\\}}] = P(\\text{edge }(i,j)\\text{ exists AND edge }(k,j)\\text{ exists}) = p \\cdot p = p^2\n$$\nThe total number of potential wedges is the number of ways to choose a center node ($n$ ways) times the number of ways to choose two endpoints from the remaining $n-1$ nodes ($\\binom{n-1}{2}$ ways).\n$$\n\\mathbb{E}[N_{\\wedge}] = n \\cdot \\binom{n-1}{2} \\cdot p^2 = n \\cdot \\frac{(n-1)(n-2)}{2} p^2\n$$\n\nFinally, we compute the required ratio.\nWe have derived:\n$$\n\\mathbb{E}[N_{\\triangle}] = \\frac{n(n-1)(n-2)}{6} p^3\n$$\n$$\n\\mathbb{E}[N_{\\wedge}] = \\frac{n(n-1)(n-2)}{2} p^2\n$$\nThe ratio is therefore:\n$$\n\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]} = \\frac{3 \\left( \\frac{n(n-1)(n-2)}{6} p^3 \\right)}{\\frac{n(n-1)(n-2)}{2} p^2}\n$$\nAssuming $n \\ge 3$, the term $n(n-1)(n-2)$ is non-zero and cancels out from the numerator and the denominator.\n$$\n\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]} = \\frac{\\frac{3}{6} p^3}{\\frac{1}{2} p^2} = \\frac{\\frac{1}{2} p^3}{\\frac{1}{2} p^2}\n$$\nThe factors of $\\frac{1}{2}$ cancel, and the powers of $p$ simplify:\n$$\n\\frac{p^3}{p^2} = p\n$$\nThis result indicates that for an ER random graph, the expected transitivity is simply the edge probability $p$. This reflects the fact that the formation of edges is independent, so the existence of a wedge does not alter the probability of the third, closing edge.", "answer": "$$\\boxed{p}$$", "id": "4327825"}, {"introduction": "While often discussed interchangeably, different measures of network clustering capture distinct aspects of a network's topology. This practice [@problem_id:4327826] focuses on the important distinction between the average of local clustering coefficients and the global network transitivity. By analyzing the impact of adding a single, triangle-closing edge, you will develop a hands-on understanding of how these two key metrics can respond differently to the same local structural perturbation.", "problem": "In a Protein-Protein Interaction (PPI) network representing a single cell type, consider a simple modification around a single high-degree hub protein. The network has $N$ proteins (nodes) and an undirected simple graph structure. One protein $h$ is a hub with degree $k$, where $k \\geq 2$ and $k \\ll N$ is not assumed. Two specific neighbors of $h$, labeled $u$ and $v$, currently have degree $1$ each (their only interaction is with $h$), and there is no interaction between $u$ and $v$. You introduce a single additional interaction (edge) between $u$ and $v$, thereby closing exactly one triangle $h$-$u$-$v$-$h$. The rest of the network is unchanged by this intervention.\n\nLet $\\bar{C}$ denote the average of node-wise local clustering coefficients (with the standard convention that nodes of degree less than $2$ have local clustering coefficient $0$), and let $C_T$ denote the network transitivity, defined as three times the number of triangles divided by the number of connected triples of vertices, where a connected triple is defined with respect to a designated center node.\n\nAssume that before adding the edge between $u$ and $v$, the network has a total of $T_0$ triangles and a total of $W_0$ connected triples, with $W_0  0$. After the edge is added, all changes arise only from the local neighborhood of $h$, $u$, and $v$ as described above.\n\nUsing only standard definitions, derive exact symbolic expressions for the changes $\\Delta \\bar{C}$ and $\\Delta C_T$ induced by adding the single edge between $u$ and $v$, expressed solely in terms of $N$, $k$, $T_0$, and $W_0$. Provide your final answer as a single row matrix $\\big(\\Delta \\bar{C},\\, \\Delta C_T\\big)$ containing closed-form expressions. Do not approximate or round; an exact analytic expression is required.", "solution": "The problem asks for the change in two network metrics, the average local clustering coefficient ($\\bar{C}$) and the network transitivity ($C_T$), resulting from the addition of a single edge to a given network. Let the initial state of the network be denoted by subscript $0$ and the final state after adding the edge $(u, v)$ be denoted by subscript $1$.\n\nThe network is an undirected simple graph with $N$ nodes. Initially, it contains a hub node $h$ with degree $k_{h,0} = k \\ge 2$. Two of its neighbors, $u$ and $v$, have an initial degree of $1$, so their only connections are to $h$. Thus, the edges $(u, h)$ and $(v, h)$ exist in the initial graph, and these are the only edges incident to $u$ and $v$. There is no initial edge between $u$ and $v$. A new edge $(u, v)$ is added, forming the triangle $h-u-v$.\n\n**Part 1: Calculation of the change in average local clustering coefficient, $\\Delta \\bar{C}$**\n\nThe average local clustering coefficient is defined as $\\bar{C} = \\frac{1}{N} \\sum_{i=1}^{N} C_i$, where $C_i$ is the local clustering coefficient of node $i$. The change is $\\Delta \\bar{C} = \\bar{C}_1 - \\bar{C}_0 = \\frac{1}{N} \\sum_{i=1}^{N} (C_{i,1} - C_{i,0}) = \\frac{1}{N} \\sum_{i=1}^{N} \\Delta C_i$.\n\nThe local clustering coefficient for a node $i$ with degree $k_i \\ge 2$ is $C_i = \\frac{2E_i}{k_i(k_i-1)}$, where $E_i$ is the number of edges between the neighbors of node $i$. By convention, if $k_i  2$, $C_i = 0$.\n\nWe must identify which nodes experience a change in their local clustering coefficient. A node's $C_i$ value changes if either its degree $k_i$ changes, or the number of edges between its neighbors $E_i$ changes. The addition of the edge $(u, v)$ only affects the degrees of nodes $u$ and $v$. The number of edges between neighbors can only change for nodes that have both $u$ and $v$ as neighbors. The only such node is $h$. Therefore, we only need to compute $\\Delta C_i$ for $i \\in \\{h, u, v\\}$. For any other node $j \\notin \\{h, u, v\\}$, its degree is unchanged, and the new edge $(u,v)$ does not connect any two of its neighbors (since this would imply $j$ is connected to both $u$ and $v$, which is impossible given $k_{u,0}=1$ and $k_{v,0}=1$), so $\\Delta C_j = 0$.\n\nThe total change is $\\sum_{i=1}^{N} \\Delta C_i = \\Delta C_h + \\Delta C_u + \\Delta C_v$.\n\n1.  **Node $u$**:\n    -   Initial state: $k_{u,0} = 1$. By convention, $C_{u,0} = 0$.\n    -   Final state: The edge $(u, v)$ is added. The degree becomes $k_{u,1} = k_{u,0} + 1 = 2$. The neighbors of $u$ are now $\\{h, v\\}$. There is an edge between $h$ and $v$ because $v$ is a neighbor of $h$. So, the number of edges between the neighbors of $u$ is $E_u = 1$.\n    -   $C_{u,1} = \\frac{2E_u}{k_{u,1}(k_{u,1}-1)} = \\frac{2 \\times 1}{2(2-1)} = 1$.\n    -   $\\Delta C_u = C_{u,1} - C_{u,0} = 1 - 0 = 1$.\n\n2.  **Node $v$**:\n    -   By symmetry with node $u$, the calculation is identical.\n    -   Initial state: $k_{v,0} = 1$, so $C_{v,0} = 0$.\n    -   Final state: $k_{v,1} = 2$. Neighbors are $\\{h, u\\}$. The edge $(h, u)$ exists. $E_v = 1$.\n    -   $C_{v,1} = \\frac{2 E_v}{k_{v,1}(k_{v,1}-1)} = \\frac{2 \\times 1}{2(2-1)} = 1$.\n    -   $\\Delta C_v = C_{v,1} - C_{v,0} = 1 - 0 = 1$.\n\n3.  **Node $h$**:\n    -   Initial state: Degree is $k_{h,0} = k$. Let $T_{h,0}$ be the number of triangles involving $h$, which is equal to the number of edges between its neighbors. $C_{h,0} = \\frac{2T_{h,0}}{k(k-1)}$.\n    -   Final state: The degree of $h$ is unchanged, $k_{h,1} = k$. The set of its neighbors is also unchanged. The new edge $(u, v)$ connects two of its neighbors. This increases the number of triangles involving $h$ by exactly one (the triangle $h-u-v$).\n    -   The new number of triangles is $T_{h,1} = T_{h,0} + 1$.\n    -   $C_{h,1} = \\frac{2T_{h,1}}{k(k-1)} = \\frac{2(T_{h,0} + 1)}{k(k-1)}$.\n    -   $\\Delta C_h = C_{h,1} - C_{h,0} = \\frac{2(T_{h,0} + 1)}{k(k-1)} - \\frac{2T_{h,0}}{k(k-1)} = \\frac{2}{k(k-1)}$.\n\nCombining these changes:\n$\\Delta \\bar{C} = \\frac{1}{N}(\\Delta C_h + \\Delta C_u + \\Delta C_v) = \\frac{1}{N}\\left(\\frac{2}{k(k-1)} + 1 + 1\\right) = \\frac{1}{N}\\left(2 + \\frac{2}{k(k-1)}\\right)$.\nSimplifying the expression:\n$\\Delta \\bar{C} = \\frac{2}{N}\\left(1 + \\frac{1}{k(k-1)}\\right) = \\frac{2}{N}\\left(\\frac{k(k-1) + 1}{k(k-1)}\\right) = \\frac{2(k^2 - k + 1)}{N k(k-1)}$.\n\n**Part 2: Calculation of the change in network transitivity, $\\Delta C_T$**\n\nNetwork transitivity is defined as $C_T = \\frac{3 \\times (\\text{number of triangles})}{(\\text{number of connected triples})} = \\frac{3T}{W}$.\nThe change is $\\Delta C_T = C_{T,1} - C_{T,0} = \\frac{3T_1}{W_1} - \\frac{3T_0}{W_0}$.\nThe problem provides the initial values $T_0$ and $W_0$. We need to find the final values $T_1$ and $W_1$.\n\n1.  **Change in the number of triangles ($\\Delta T$)**:\n    -   A new triangle is formed by adding an edge $(u, v)$ if there is at least one node $x$ that is a common neighbor to both $u$ and $v$ in the initial graph.\n    -   From the problem statement, $u$ and $v$ are neighbors of $h$. The initial degrees of $u$ and $v$ are $k_{u,0}=1$ and $k_{v,0}=1$, with their only connection being to $h$. Thus, $h$ is the only common neighbor of $u$ and $v$.\n    -   Adding the edge $(u, v)$ therefore creates exactly one new triangle, $h-u-v$.\n    -   $\\Delta T = T_1 - T_0 = 1$, so $T_1 = T_0 + 1$.\n\n2.  **Change in the number of connected triples ($\\Delta W$)**:\n    -   A connected triple is a path of length 2, centered at some node $i$. The total number of connected triples in a graph is $W = \\sum_{i \\in V} \\binom{k_i}{2}$.\n    -   The change $\\Delta W$ is given by $\\Delta W = W_1 - W_0 = \\sum_{i \\in V} \\left( \\binom{k_{i,1}}{2} - \\binom{k_{i,0}}{2} \\right)$.\n    -   The degrees of all nodes are unchanged, except for $u$ and $v$.\n    -   For node $u$: $k_{u,0}=1$, $k_{u,1}=2$. Change in triples centered at $u$ is $\\binom{2}{2} - \\binom{1}{2} = 1 - 0 = 1$.\n    -   For node $v$: $k_{v,0}=1$, $k_{v,1}=2$. Change in triples centered at $v$ is $\\binom{2}{2} - \\binom{1}{2} = 1 - 0 = 1$.\n    -   For all other nodes $j \\notin \\{u, v\\}$, $k_{j,1}=k_{j,0}$, so the contribution to the sum is $0$.\n    -   The total change is $\\Delta W = 1 + 1 = 2$.\n    -   So, $W_1 = W_0 + 2$.\n\nNow, we can compute $\\Delta C_T$:\n$\\Delta C_T = \\frac{3T_1}{W_1} - \\frac{3T_0}{W_0} = \\frac{3(T_0 + 1)}{W_0 + 2} - \\frac{3T_0}{W_0}$.\nTo simplify, we find a common denominator:\n$\\Delta C_T = 3 \\left( \\frac{(T_0 + 1)W_0 - T_0(W_0 + 2)}{W_0(W_0 + 2)} \\right)$.\n$\\Delta C_T = 3 \\left( \\frac{T_0 W_0 + W_0 - T_0 W_0 - 2T_0}{W_0(W_0 + 2)} \\right)$.\n$\\Delta C_T = \\frac{3(W_0 - 2T_0)}{W_0(W_0 + 2)}$.\n\nThe derived expressions for $\\Delta \\bar{C}$ and $\\Delta C_T$ are in terms of the allowed variables $N$, $k$, $T_0$, and $W_0$.\n\nThe final answer is a row matrix containing these two expressions.\nThe first element is $\\Delta \\bar{C} = \\frac{2(k^2 - k + 1)}{N k(k-1)}$.\nThe second element is $\\Delta C_T = \\frac{3(W_0 - 2T_0)}{W_0(W_0 + 2)}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2(k^2 - k + 1)}{N k (k-1)}  \\frac{3(W_0 - 2T_0)}{W_0 (W_0 + 2)} \\end{pmatrix}}$$", "id": "4327826"}, {"introduction": "Ultimately, the analysis of biological networks requires moving from theoretical concepts to computational implementation and statistical inference. This exercise [@problem_id:4327878] bridges this gap by tasking you with creating an estimator for the clustering spectrum, a refined measure that describes clustering as a function of node degree. You will also apply the bootstrap method to quantify the statistical uncertainty of your estimates, a critical step for any rigorous analysis of finite network data.", "problem": "You will implement, from first principles, an estimator for the clustering spectrum in undirected simple networks and quantify its finite-sample uncertainty using resampling. Work entirely in purely mathematical terms and produce a single, reproducible set of results for a fixed small test suite of networks.\n\nConsider an undirected simple network on $n$ nodes with a symmetric $n \\times n$ adjacency matrix $A$ with diagonal entries equal to $0$ and off-diagonal entries in $\\{0,1\\}$. For a node $i$, let its degree be $k_i$, and define its local clustering coefficient as the fraction of connected neighbor pairs among all possible neighbor pairs of node $i$, with the convention that this fraction is $0$ when $k_i  2$. Let the clustering spectrum $C(k)$ be the average of the local clustering coefficients over all nodes with degree equal to $k$, taken only for $k \\ge 2$.\n\nYour tasks are:\n- Starting from the core definitions above (undirected simple graph; degree; connected neighbor pairs; local clustering coefficient per node; grouping by degree), devise and implement an estimator for the clustering spectrum $C(k)$ in finite networks.\n- Quantify finite-sample uncertainty for $C(k)$ using a nonparametric bootstrap over nodes within the same degree class $k$, as follows. For each degree value $k$ that occurs with at least one node and with $k \\ge 2$, generate $B$ bootstrap replicates by resampling with replacement the set of nodes of degree $k$ (resample exactly as many nodes as are in that degree class), compute the mean local clustering coefficient for each resample, and then use the empirical $\\alpha/2$ and $1-\\alpha/2$ quantiles of the bootstrap means to form a two-sided confidence interval at nominal level $1-\\alpha$. Use $B = 10000$, $\\alpha = 0.05$, and a fixed random seed $s = 12345$ to ensure reproducibility. Express all confidence levels as decimals (e.g., $0.95$), not using a percentage sign.\n- Treat only $k \\ge 2$ when reporting $C(k)$; do not report degree values $k$ that are absent in the network, and do not report $k  2$.\n- The network transitivity (also called global clustering) is defined as the ratio of the number of closed connected triplets to the total number of connected triplets in the network. While you do not need to compute the network transitivity in the output, your derivation should be consistent with this definition in how local clustering is computed.\n\nYour program must implement the above for the following test suite of undirected simple networks, specified by their node sets and edges. In each case, nodes are labeled $0,1,2,\\dots,n-1$.\n\nTest case $1$ (a small clustered module with a pendant node): $n=5$, edges $\\{(0,1),(1,2),(2,0),(1,3),(2,3),(1,4)\\}$.\n\nTest case $2$ (heterogeneous clustering at $k=2$): $n=6$, edges $\\{(0,1),(1,2),(2,0),(3,4),(3,5)\\}$.\n\nTest case $3$ (a $4$-cycle with no triangles): $n=4$, edges $\\{(0,1),(1,2),(2,3),(3,0)\\}$.\n\nTest case $4$ (complete graph on $5$ nodes): $n=5$, edges are all unordered pairs $(i,j)$ with $0 \\le i  j \\le 4$.\n\nImplementation and numerical requirements:\n- Assume undirected simple graphs, so the adjacency matrix $A$ is symmetric with zeros on the diagonal.\n- For each test case, compute the clustering spectrum values $C(k)$ for all $k \\ge 2$ present in that network and the associated two-sided confidence interval at nominal level $0.95$ using the bootstrap procedure described above with $B=10000$ and seed $s=12345$.\n- Round all reported means and confidence interval endpoints to $6$ decimal places. No physical units are involved.\n\nFinal output format:\n- Aggregate the results from all test cases into a single line. Each reported entry must be a list of the form $[c, k, \\widehat{C(k)}, L, U]$, where $c$ is the integer test case index in $\\{1,2,3,4\\}$, $k$ is the integer degree, $\\widehat{C(k)}$ is the bootstrap mean estimate rounded to $6$ decimal places, and $L$ and $U$ are the lower and upper confidence bounds rounded to $6$ decimal places.\n- Your program should produce a single line of output containing all such entries concatenated in a single comma-separated list enclosed in square brackets (for example, $[[1,2,0.5,0.3,0.7],[1,3,0.4,0.2,0.6],\\dots]$). Do not print anything else.", "solution": "The problem requires the implementation of an estimator for the clustering spectrum of several networks, including a quantification of its uncertainty using a non-parametric bootstrap. The problem is well-defined, scientifically sound, and provides all necessary information for a unique, reproducible solution.\n\n### Mathematical Formulation\n\nAn undirected simple network is represented by a graph $G=(V, E)$, where $V$ is a set of $n$ nodes and $E$ is a set of edges. It can be described by a symmetric $n \\times n$ adjacency matrix $A$, where $A_{ij} = 1$ if nodes $i$ and $j$ are connected and $A_{ij} = 0$ otherwise. For a simple graph, diagonal entries $A_{ii}$ are $0$.\n\nThe degree of a node $i$, denoted $k_i$, is the number of connections it has:\n$$k_i = \\sum_{j=1}^{n} A_{ij}$$\n\nThe local clustering coefficient of a node $i$, $c_i$, quantifies the density of connections among its neighbors. It is defined as the fraction of existing edges between the neighbors of node $i$ out of all possible edges between them. Let $N_i = \\{j \\in V \\mid A_{ij}=1\\}$ be the set of neighbors of node $i$. The number of possible edges between these $k_i$ neighbors is given by $\\binom{k_i}{2}$. The number of actual edges between neighbors is equivalent to the number of triangles in the graph that include node $i$, which we denote as $T_i$.\n\nThe local clustering coefficient is thus:\n$$c_i = \\frac{T_i}{\\binom{k_i}{2}} = \\frac{T_i}{\\frac{1}{2} k_i(k_i - 1)}$$\nBy convention, if $k_i  2$, there are no possible pairs of neighbors, so we define $c_i = 0$.\n\nA computationally efficient method to find $T_i$ uses matrix algebra. The number of paths of length 3 from node $i$ back to itself is given by the $i$-th diagonal element of the matrix $A^3$, i.e., $(A^3)_{ii}$. Each triangle involving node $i$, say $i-j-l-i$, corresponds to two such paths ($i \\to j \\to l \\to i$ and $i \\to l \\to j \\to i$). Therefore, the number of triangles $T_i$ is half of this value:\n$$T_i = \\frac{1}{2}(A^3)_{ii}$$\nSubstituting this into the formula for $c_i$, we obtain a direct expression in terms of the adjacency matrix:\n$$c_i = \\frac{\\frac{1}{2}(A^3)_{ii}}{\\frac{1}{2} k_i(k_i - 1)} = \\frac{(A^3)_{ii}}{k_i(k_i - 1)} \\quad \\text{for } k_i \\ge 2$$\nThis formulation is consistent with the definition of network transitivity, which also depends on the count of closed triplets (triangles).\n\nThe clustering spectrum, $C(k)$, is the average local clustering coefficient over all nodes that have a specific degree $k$. Let $V_k = \\{i \\in V \\mid k_i = k\\}$ be the set of nodes with degree $k$. The clustering spectrum is defined for $k \\ge 2$ as:\n$$C(k) = \\frac{1}{|V_k|} \\sum_{i \\in V_k} c_i$$\nprovided that the set $V_k$ is not empty.\n\n### Uncertainty Quantification via Non-Parametric Bootstrap\n\nTo quantify the finite-sample uncertainty in the estimate of $C(k)$, we employ a non-parametric bootstrap procedure. This method resamples the observed data to simulate the sampling distribution of the statistic of interest.\n\nFor each degree class $k \\ge 2$ present in the network:\n1.  Identify the set of local clustering coefficients for all nodes in this class: $S_k = \\{c_i \\mid i \\in V_k\\}$.\n2.  Generate $B=10000$ bootstrap replicates. Each replicate, $S_k^{*(b)}$ for $b=1, \\dots, B$, is a new set of size $|V_k|$ created by sampling with replacement from the original set $S_k$. This is equivalent to resampling the nodes within the degree class and using their pre-computed coefficients.\n3.  For each bootstrap replicate, compute its mean: $\\bar{c}_k^{*(b)} = \\frac{1}{|V_k|} \\sum_{c' \\in S_k^{*(b)}} c'$.\n4.  The bootstrap estimate of the clustering spectrum, $\\widehat{C(k)}$, is the mean of the distribution of these bootstrap means:\n    $$\\widehat{C(k)} = \\frac{1}{B} \\sum_{b=1}^{B} \\bar{c}_k^{*(b)}$$\n5.  A two-sided $(1-\\alpha)$ confidence interval is constructed using the percentile method. With $\\alpha=0.05$, the lower bound $L$ and upper bound $U$ are the $2.5$-th and $97.5$-th percentiles of the sorted distribution of bootstrap means $\\{\\bar{c}_k^{*(b)}\\}_{b=1}^B$.\n\n### Algorithmic Procedure\n\nThe overall algorithm for each test case is as follows:\n1.  **Construct Adjacency Matrix**: Given the number of nodes $n$ and the list of edges, construct the $n \\times n$ adjacency matrix $A$.\n2.  **Compute Degrees**: Calculate the degree $k_i$ for each node $i$ by summing the rows (or columns) of $A$.\n3.  **Compute $A^3$**: Use matrix exponentiation to find $A^3 = A \\times A \\times A$.\n4.  **Calculate Local Clustering Coefficients**: For each node $i$, calculate $c_i$ using the formula $c_i = (A^3)_{ii} / (k_i(k_i - 1))$ if $k_i \\ge 2$, and $c_i=0$ otherwise.\n5.  **Group by Degree**: Identify the unique degrees $k \\ge 2$ present in the network.\n6.  **Perform Bootstrap Analysis**: For each such degree $k$:\n    a. Collect the coefficients $\\{c_i\\}$ for all nodes with degree $k$.\n    b. If the number of such nodes is one, the bootstrap distribution is a delta function at that single coefficient value. Thus, the mean, lower bound, and upper bound are all equal to this value.\n    c. If there is more than one node, perform the bootstrap procedure as described above with $B=10000$ replicates and a fixed random seed $s=12345$ for reproducibility.\n    d. Calculate the bootstrap mean estimate $\\widehat{C(k)}$ and the $0.025$ and $0.975$ quantiles for the confidence interval $[L, U]$.\n7.  **Format Output**: Collect the results from all test cases. For each degree class $k$ analyzed in test case $c$, create a list $[c, k, \\widehat{C(k)}, L, U]$, rounding the floating-point values to $6$ decimal places. Concatenate all such lists into a single list for the final output.\n\nThis methodology provides a complete, robust, and reproducible analysis of the clustering spectrum and its statistical uncertainty for the specified networks.", "answer": "[[1, 2, 1.0, 1.0, 1.0], [1, 3, 0.666667, 0.666667, 0.666667], [1, 4, 0.333333, 0.333333, 0.333333], [2, 2, 0.750017, 0.25, 1.0], [3, 2, 0.0, 0.0, 0.0], [4, 4, 1.0, 1.0, 1.0]]", "id": "4327878"}]}