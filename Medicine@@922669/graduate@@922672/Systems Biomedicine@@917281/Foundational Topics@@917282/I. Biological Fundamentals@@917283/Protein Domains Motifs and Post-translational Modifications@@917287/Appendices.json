{"hands_on_practices": [{"introduction": "Understanding how proteins function at a molecular level begins with the biophysics of recognition—how a specific domain binds its target motif. We can quantify this process using thermodynamics, which dissects the binding energy into components related to bond formation ($ \\Delta H $, enthalpy) and changes in system order ($ \\Delta S $, entropy). This first practice uses hypothetical data, similar to that from Isothermal Titration Calorimetry (ITC), to calculate the Gibbs free energy ($ \\Delta G $) of binding and determine the fundamental forces driving a domain-motif interaction. [@problem_id:4379776]", "problem": "A modular signaling protein domain that recognizes post-translationally modified peptide motifs is assayed by Isothermal Titration Calorimetry (ITC). Specifically, a 14-3-3 domain binds a phosphorylated serine-containing motif from a metabolic regulator. The experiment is performed at constant temperature and pressure, with the solution buffered such that no phase changes occur and the solvent behaves ideally for the purposes of calorimetry.\n\nFundamental thermodynamic definitions for processes at constant temperature and pressure include the Gibbs free energy $G$, enthalpy $H$, entropy $S$, and the relation of spontaneous binding to the sign of the Gibbs free energy change $\\Delta G$. ITC directly reports the molar enthalpy change $\\Delta H$ for binding, and the temperature-scaled entropy term $-T\\Delta S$ can be determined from the temperature dependence of the equilibrium binding isotherm. Under these conditions, the sign and relative magnitudes of the enthalpic and entropic contributions determine whether binding is predominantly enthalpy-driven or entropy-driven.\n\nFor the phosphorylated motif–14-3-3 domain interaction at $T = 298 \\ \\text{K}$, the measured quantities are:\n- $\\Delta H = -51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$,\n- $-T\\Delta S = +22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$.\n\nUsing only fundamental thermodynamic relations appropriate to constant temperature and pressure, compute the Gibbs free energy change $\\Delta G$ for binding. Then, based on the signs and magnitudes of $\\Delta H$ and $-T\\Delta S$, determine whether the binding is enthalpy-driven or entropy-driven and justify your conclusion in terms of molecular interactions typical of phosphorylated motif recognition by modular domains.\n\nExpress the final numerical value of $\\Delta G$ in $\\text{kJ} \\ \\text{mol}^{-1}$ and round your answer to four significant figures. Provide the interpretation in your working, but the final reported value must be only the numerical $\\Delta G$.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of chemical thermodynamics as applied to biophysical chemistry, specifically protein-ligand binding. The problem is well-posed, providing all necessary data ($\\Delta H$ and $-T\\Delta S$) to calculate the Gibbs free energy change ($\\Delta G$) using a fundamental and contextually appropriate equation. The provided values are realistic for the described biological interaction. The problem is objective and free of ambiguity. Therefore, a solution can be constructed.\n\nThe primary task is to compute the Gibbs free energy change, $\\Delta G$, for the binding event and to determine the thermodynamic driving force of the interaction. The relationship between Gibbs free energy, enthalpy ($H$), and entropy ($S$) at constant temperature ($T$) and pressure is given by the Gibbs-Helmholtz equation:\n$$\n\\Delta G = \\Delta H - T\\Delta S\n$$\nThis equation is fundamental to determining the spontaneity of a process. A negative value of $\\Delta G$ indicates a spontaneous process, while a positive value indicates a non-spontaneous process.\n\nThe problem provides the following experimentally measured quantities for the binding of a phosphorylated motif to a 14-3-3 domain at a temperature of $T = 298 \\ \\text{K}$:\n1.  The molar enthalpy change, $\\Delta H = -51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$.\n2.  The entropic contribution to the free energy, $-T\\Delta S = +22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$.\n\nThe Gibbs-Helmholtz equation can be conveniently rewritten to directly use the provided terms:\n$$\n\\Delta G = (\\Delta H) + (-T\\Delta S)\n$$\nSubstituting the given values into this equation:\n$$\n\\Delta G = (-51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}) + (+22.6 \\ \\text{kJ} \\ \\text{mol}^{-1})\n$$\n$$\n\\Delta G = -28.6 \\ \\text{kJ} \\ \\text{mol}^{-1}\n$$\nThe problem requests the final answer to be rounded to four significant figures. The calculated value of $-28.6$ has three significant figures. To express this with four significant figures, we add a trailing zero:\n$$\n\\Delta G = -28.60 \\ \\text{kJ} \\ \\text{mol}^{-1}\n$$\nThe sign of $\\Delta G$ is negative, which confirms that the binding process is spontaneous under the specified conditions.\n\nNext, we must determine whether the binding is enthalpy-driven or entropy-driven. We analyze the contributions of the enthalpic and entropic terms to the overall free energy change.\n-   The enthalpic term is $\\Delta H = -51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$. This term is negative, indicating that the process is exothermic and energetically favorable. This favorable contribution promotes binding.\n-   The entropic term is $-T\\Delta S = +22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$. This term is positive, meaning the $T\\Delta S$ term is negative ($T\\Delta S = -22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$). Since $T$ is positive, the entropy change itself, $\\Delta S$, must be negative. A negative $\\Delta S$ signifies an increase in order, which is unfavorable for a spontaneous process. This unfavorable contribution opposes binding.\n\nThe binding is considered **enthalpy-driven** because the large, favorable enthalpic change ($|\\Delta H| = 51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$) is the dominant driving force and successfully overcomes the opposing, unfavorable entropic change (here represented by $|-T\\Delta S| = 22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$). The net result is a spontaneous reaction ($\\Delta G < 0$).\n\nThe molecular justification for this thermodynamic profile is rooted in the types of interactions formed and the change in system order.\n-   **Favorable Enthalpy ($\\Delta H < 0$):** The large negative enthalpy change arises from the formation of strong, specific non-covalent interactions in the binding pocket that release energy. For a 14-3-3 domain binding a phosphorylated serine, these interactions characteristically include:\n    1.  Strong electrostatic interactions (salt bridges) between the dianionic phosphate group ($-\\text{PO}_3^{2-}$) on the phosphoserine and a constellation of positively charged residues (e.g., arginine, lysine) within the domain's binding cleft.\n    2.  An extensive network of hydrogen bonds between the peptide backbone, peptide side chains, and polar residues of the protein.\n    - These highly specific and directional interactions are energetically more favorable than the interactions the individual molecules made with the solvent (water), leading to a net release of heat.\n\n-   **Unfavorable Entropy ($\\Delta S < 0$):** The negative entropy change, which opposes binding, is primarily due to an increase in the order of the system.\n    1.  **Loss of Translational and Rotational Freedom:** Two independent molecules (the protein domain and the peptide motif) associate to form a single, less mobile complex, reducing the overall translational and rotational entropy.\n    2.  **Loss of Conformational Freedom:** The flexible, unstructured peptide motif becomes locked into a specific, ordered conformation upon binding. Likewise, flexible loops on the surface of the protein domain may also become more rigid. This \"freezing\" of motional degrees of freedom represents a significant decrease in conformational entropy.\n    - While the displacement of ordered water molecules from the binding surfaces (the hydrophobic effect) can contribute a favorable (positive) change to $\\Delta S$, in this case, the overall entropy change is negative. This indicates that the ordering effects from the association and conformational restriction of the biomolecules are dominant.\n\nIn summary, the binding is a classic case of an enthalpy-driven interaction, where the formation of strong, specific electrostatic and hydrogen-bonding interactions provides the energy to \"pay\" the entropic penalty of forming an ordered complex.", "answer": "$$\n\\boxed{-28.60}\n$$", "id": "4379776"}, {"introduction": "Moving from a static view of binding to dynamic regulation, we explore how the state of a protein is controlled by continuous post-translational modifications. This regulation often achieves a steady state determined by the competing activities of enzymes, such as kinases and phosphatases, in a \"push-pull\" mechanism. This exercise guides you through modeling such a kinetic system to predict the steady-state phosphorylation level of a protein, demonstrating how domain-mediated scaffolding can fine-tune the final regulatory outcome. [@problem_id:4379708]", "problem": "A cytosolic protein $P$ contains a single serine motif that can be phosphorylated, producing the phosphorylated state $P_{p}$. A Serine/Threonine kinase $K$ recognizes a docking motif via its Src Homology 2 (SH2) domain, and a serine/threonine phosphatase $F$ is recruited to a scaffold through its tryptophan (WW) domain. Under physiological conditions of approximately constant adenosine triphosphate (ATP), low substrate occupancy, and constant enzyme concentrations, the phosphorylation and dephosphorylation fluxes of this motif can be modeled as pseudo-first-order processes with respect to $[P]$ and $[P_{p}]$, respectively.\n\nThe SH2 domain-mediated recruitment of $K$ to a scaffold peptide $S$ modulates the effective catalytic rate constant for phosphorylation. Let the dissociation constant of the SH2–$S$ interaction be $K_{d}^{D} = 2.0\\,\\mu\\text{M}$ and the free scaffold peptide concentration be $[S] = 5.0\\,\\mu\\text{M}$. Assuming a single binding site and $[S] \\gg [K]_{\\text{tot}}$, the fraction of kinase molecules with an occupied docking site is $f_{D} = \\dfrac{[S]}{K_{d}^{D} + [S]}$. When the docking site is occupied, the effective pseudo-first-order phosphorylation rate constant is $k_{\\text{kin}}^{\\text{on}} = 0.08\\,\\text{s}^{-1}$; when unoccupied, it is $k_{\\text{kin}}^{\\text{off}} = 0.01\\,\\text{s}^{-1}$. The overall effective phosphorylation rate constant is the weighted average $k_{\\text{kin}} = f_{D}\\,k_{\\text{kin}}^{\\text{on}} + (1 - f_{D})\\,k_{\\text{kin}}^{\\text{off}}$.\n\nSimilarly, the WW domain-mediated recruitment of phosphatase $F$ to a scaffold motif $M$ modulates the effective dephosphorylation rate constant. Let the dissociation constant of the WW–$M$ interaction be $K_{d}^{WW} = 10\\,\\mu\\text{M}$ and the free scaffold motif concentration be $[M] = 20\\,\\mu\\text{M}$. The fraction of phosphatase molecules bound through the WW domain is $f_{WW} = \\dfrac{[M]}{K_{d}^{WW} + [M]}$. The basal pseudo-first-order dephosphorylation rate constant in the absence of WW-mediated recruitment is $k_{\\text{phos},0} = 0.06\\,\\text{s}^{-1}$. When the WW domain is occupied, the local microenvironment reduces the catalytic rate by a factor $r = 0.5$, so the effective dephosphorylation rate constant is $k_{\\text{phos}} = (1 - f_{WW})\\,k_{\\text{phos},0} + f_{WW}\\,(r\\,k_{\\text{phos},0})$.\n\nAt steady state, the mass-action balance for the motif satisfies\n$$\n\\frac{d[P_{p}]}{dt} = k_{\\text{kin}}[P] - k_{\\text{phos}}[P_{p}] = 0,\n$$\nwhich implies a constant ratio $\\dfrac{[P_{p}]}{[P]} = \\dfrac{k_{\\text{kin}}}{k_{\\text{phos}}}$.\n\nCompute the steady-state ratio $\\dfrac{[P_{p}]}{[P]}$ using the information above. Express your final answer as a dimensionless decimal number and round your result to four significant figures.", "solution": "The user wants to determine the steady-state ratio of phosphorylated protein to unphosphorylated protein, $\\dfrac{[P_{p}]}{[P]}$, based on a provided model of enzyme kinetics modulated by scaffolding.\n\nThe problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Phosphorylation modulation by kinase $K$:\n  - Dissociation constant for SH2–$S$ interaction: $K_{d}^{D} = 2.0\\,\\mu\\text{M}$\n  - Free scaffold peptide concentration: $[S] = 5.0\\,\\mu\\text{M}$\n  - Fraction of kinase with occupied docking site: $f_{D} = \\dfrac{[S]}{K_{d}^{D} + [S]}$\n  - Pseudo-first-order phosphorylation rate constant (docking site occupied): $k_{\\text{kin}}^{\\text{on}} = 0.08\\,\\text{s}^{-1}$\n  - Pseudo-first-order phosphorylation rate constant (docking site unoccupied): $k_{\\text{kin}}^{\\text{off}} = 0.01\\,\\text{s}^{-1}$\n  - Overall effective phosphorylation rate constant: $k_{\\text{kin}} = f_{D}\\,k_{\\text{kin}}^{\\text{on}} + (1 - f_{D})\\,k_{\\text{kin}}^{\\text{off}}$\n\n- Dephosphorylation modulation by phosphatase $F$:\n  - Dissociation constant for WW–$M$ interaction: $K_{d}^{WW} = 10\\,\\mu\\text{M}$\n  - Free scaffold motif concentration: $[M] = 20\\,\\mu\\text{M}$\n  - Fraction of phosphatase bound via WW domain: $f_{WW} = \\dfrac{[M]}{K_{d}^{WW} + [M]}$\n  - Basal pseudo-first-order dephosphorylation rate constant: $k_{\\text{phos},0} = 0.06\\,\\text{s}^{-1}$\n  - Catalytic rate reduction factor upon WW domain occupation: $r = 0.5$\n  - Effective dephosphorylation rate constant: $k_{\\text{phos}} = (1 - f_{WW})\\,k_{\\text{phos},0} + f_{WW}\\,(r\\,k_{\\text{phos},0})$\n\n- Steady-state condition:\n  - $\\dfrac{d[P_{p}]}{dt} = k_{\\text{kin}}[P] - k_{\\text{phos}}[P_{p}] = 0$\n  - Steady-state ratio: $\\dfrac{[P_{p}]}{[P]} = \\dfrac{k_{\\text{kin}}}{k_{\\text{phos}}}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a standard biochemical model of a phosphorylation-dephosphorylation cycle. The use of SH2 and WW domains for protein-protein interaction and scaffolding, the modulation of enzyme activity by such interactions, and the application of pseudo-first-order kinetics under conditions of low substrate concentration are all well-established principles in molecular biology and enzyme kinetics. The parameter values are physiologically plausible. The model is a valid and common simplification used in systems biology.\n- **Well-Posed:** All necessary constants, concentrations, and formulas are provided to calculate the required ratio. The problem is self-contained and leads to a unique solution.\n- **Objective:** The language is precise and quantitative. The problem is based on established kinetic models and free of subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived.\n\nThe solution requires calculating the overall effective rate constants for phosphorylation ($k_{\\text{kin}}$) and dephosphorylation ($k_{\\text{phos}}$) and then finding their ratio.\n\nFirst, we calculate the fraction of kinase molecules with an occupied docking site, $f_{D}$.\nGiven $K_{d}^{D} = 2.0\\,\\mu\\text{M}$ and $[S] = 5.0\\,\\mu\\text{M}$:\n$$\nf_{D} = \\frac{[S]}{K_{d}^{D} + [S]} = \\frac{5.0\\,\\mu\\text{M}}{2.0\\,\\mu\\text{M} + 5.0\\,\\mu\\text{M}} = \\frac{5.0}{7.0} = \\frac{5}{7}\n$$\n\nNext, we use this fraction to calculate the overall effective phosphorylation rate constant, $k_{\\text{kin}}$.\nGiven $k_{\\text{kin}}^{\\text{on}} = 0.08\\,\\text{s}^{-1}$ and $k_{\\text{kin}}^{\\text{off}} = 0.01\\,\\text{s}^{-1}$:\n$$\nk_{\\text{kin}} = f_{D}\\,k_{\\text{kin}}^{\\text{on}} + (1 - f_{D})\\,k_{\\text{kin}}^{\\text{off}}\n$$\n$$\nk_{\\text{kin}} = \\left(\\frac{5}{7}\\right) (0.08\\,\\text{s}^{-1}) + \\left(1 - \\frac{5}{7}\\right) (0.01\\,\\text{s}^{-1})\n$$\n$$\nk_{\\text{kin}} = \\left(\\frac{5}{7}\\right) (0.08\\,\\text{s}^{-1}) + \\left(\\frac{2}{7}\\right) (0.01\\,\\text{s}^{-1})\n$$\n$$\nk_{\\text{kin}} = \\frac{5 \\times 0.08 + 2 \\times 0.01}{7}\\,\\text{s}^{-1} = \\frac{0.40 + 0.02}{7}\\,\\text{s}^{-1} = \\frac{0.42}{7}\\,\\text{s}^{-1} = 0.06\\,\\text{s}^{-1}\n$$\n\nNow, we calculate the fraction of phosphatase molecules bound through the WW domain, $f_{WW}$.\nGiven $K_{d}^{WW} = 10\\,\\mu\\text{M}$ and $[M] = 20\\,\\mu\\text{M}$:\n$$\nf_{WW} = \\frac{[M]}{K_{d}^{WW} + [M]} = \\frac{20\\,\\mu\\text{M}}{10\\,\\mu\\text{M} + 20\\,\\mu\\text{M}} = \\frac{20}{30} = \\frac{2}{3}\n$$\n\nUsing this fraction, we calculate the effective dephosphorylation rate constant, $k_{\\text{phos}}$.\nGiven $k_{\\text{phos},0} = 0.06\\,\\text{s}^{-1}$ and $r = 0.5$:\n$$\nk_{\\text{phos}} = (1 - f_{WW})\\,k_{\\text{phos},0} + f_{WW}\\,(r\\,k_{\\text{phos},0})\n$$\nThe expression can be factored:\n$$\nk_{\\text{phos}} = k_{\\text{phos},0} \\left( (1 - f_{WW}) + r\\,f_{WW} \\right) = k_{\\text{phos},0} \\left( 1 - f_{WW} + r\\,f_{WW} \\right) = k_{\\text{phos},0} \\left( 1 - (1-r)f_{WW} \\right)\n$$\nSubstituting the values:\n$$\nk_{\\text{phos}} = (0.06\\,\\text{s}^{-1}) \\left( 1 - (1-0.5)\\left(\\frac{2}{3}\\right) \\right)\n$$\n$$\nk_{\\text{phos}} = (0.06\\,\\text{s}^{-1}) \\left( 1 - (0.5)\\left(\\frac{2}{3}\\right) \\right) = (0.06\\,\\text{s}^{-1}) \\left( 1 - \\frac{1}{3} \\right)\n$$\n$$\nk_{\\text{phos}} = (0.06\\,\\text{s}^{-1}) \\left( \\frac{2}{3} \\right) = 0.04\\,\\text{s}^{-1}\n$$\n\nFinally, we compute the steady-state ratio $\\dfrac{[P_{p}]}{[P]}$.\n$$\n\\frac{[P_{p}]}{[P]} = \\frac{k_{\\text{kin}}}{k_{\\text{phos}}} = \\frac{0.06\\,\\text{s}^{-1}}{0.04\\,\\text{s}^{-1}} = \\frac{6}{4} = 1.5\n$$\nThe problem requires the answer to be expressed as a dimensionless decimal number rounded to four significant figures.\n$$\n1.5 \\implies 1.500\n$$", "answer": "$$\n\\boxed{1.500}\n$$", "id": "4379708"}, {"introduction": "To understand protein function on a broader scale, we can investigate how domain architectures evolve and diverge across entire protein families. The linear arrangement of domains changes over evolutionary time, and quantifying these differences is a central task in bioinformatics for inferring functional relationships. This final, computational practice introduces the Jaccard index as a powerful tool to measure the similarity between different domain architectures, providing a quantitative framework for comparative and evolutionary analysis. [@problem_id:4379742]", "problem": "You are given a set of paralogous protein pairs. Each protein is represented by an ordered list of domain identifiers (e.g., curated names or Protein Families (Pfam) identifiers), which together form a domain architecture. Using definitions from set theory and sequence organization, construct comparative domain architecture maps for each pair and compute three Jaccard similarity indices to quantify divergence. The objective is to quantify similarity in domain content, multiplicity, and order.\n\nFundamental base:\n- Proteins are linear polymers of amino acids; proteins often contain modular subunits called domains that recur across proteins and are associated with specific functions. The linear order of domains along a protein is the domain architecture.\n- Paralogs arise from gene duplication and may diverge in domain architecture over evolutionary time.\n- The Jaccard index between two sets $X$ and $Y$ is defined as $J(X,Y) = \\frac{|X \\cap Y|}{|X \\cup Y|}$.\n- A multiset generalizes a set by allowing multiple instances of an element; a generalized Jaccard index for multisets $M$ and $N$ with element-wise counts $n_M(d)$ and $n_N(d)$ is $J(M,N) = \\frac{\\sum_d \\min\\{n_M(d), n_N(d)\\}}{\\sum_d \\max\\{n_M(d), n_N(d)\\}}$.\n\nDefinitions to implement:\n- Let a protein architecture be an ordered list $A = [a_1, a_2, \\dots, a_m]$ of domain identifiers and similarly $B = [b_1, b_2, \\dots, b_n]$.\n- Define the unique domain content sets $U_A = \\{a_i \\mid i \\in \\{1,\\dots,m\\}\\}$ and $U_B = \\{b_j \\mid j \\in \\{1,\\dots,n\\}\\}$.\n- Define domain multiplicity counts as $n_A(d)$ equal to the number of occurrences of domain $d$ in $A$, and $n_B(d)$ similarly for $B$.\n- Define adjacency sets (ordered bigrams) as $S_A = \\{(a_i, a_{i+1}) \\mid i \\in \\{1,\\dots,m-1\\}\\}$ and $S_B = \\{(b_j, b_{j+1}) \\mid j \\in \\{1,\\dots,n-1\\}\\}$, where each element is an ordered pair of consecutive domain types. Repeats are allowed; for example, if $a_i = a_{i+1}$ then the pair $(a_i, a_{i+1})$ is $(d,d)$ and is included once per adjacency position in the set definition (sets remove duplicates).\n- Compute three Jaccard similarity indices for each pair:\n  - Content Jaccard $J_c = \\frac{|U_A \\cap U_B|}{|U_A \\cup U_B|}$.\n  - Multiset Jaccard $J_m = \\frac{\\sum_d \\min\\{n_A(d), n_B(d)\\}}{\\sum_d \\max\\{n_A(d), n_B(d)\\}}$, where the sum is over all domain identifiers $d$ present in either $A$ or $B$.\n  - Adjacency Jaccard $J_a = \\frac{|S_A \\cap S_B|}{|S_A \\cup S_B|}$.\n\nBoundary conventions:\n- If the denominator in any Jaccard index is $0$ (for example, both $U_A$ and $U_B$ are empty, or both $S_A$ and $S_B$ are empty, or all multiset counts are zero), define that Jaccard index to be $1$.\n\nAngle units are not applicable. There are no physical units.\n\nYour task:\n- For each test case below, compute $J_c$, $J_m$, and $J_a$ following the definitions above.\n- Round each of the three floating-point results to exactly $6$ decimal places.\n\nTest suite (each item is a pair of architectures $(A,B)$, with each architecture given as an ordered list of domain identifiers):\n- Case $1$: $A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$.\n- Case $2$: $A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}]$, $B = [\\text{\"RRM\"}, \\text{\"WD40\"}]$.\n- Case $3$: $A = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"PH\"}, \\text{\"FHA\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$.\n- Case $4$: $A = [\\text{\"zf-C2H2\"}]$, $B = [\\text{\"zf-C2H2\"}, \\text{\"zf-C2H2\"}]$.\n- Case $5$: $A = [\\ ]$ (empty list), $B = [\\ ]$ (empty list).\n- Case $6$: $A = [\\text{\"SH3\"}, \\text{\"Pro-rich\"}, \\text{\"SH2\"}]$, $B = [\\text{\"SH2\"}, \\text{\"Pro-rich\"}, \\text{\"SH3\"}]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is a three-element list in the order $[J_c, J_m, J_a]$ for the corresponding case. Each float must be rounded to exactly $6$ decimal places.\n- For example, a valid overall format for two cases would look like $[[0.123456,0.654321,1.000000],[1.000000,0.000000,0.500000]]$.", "solution": "### Step 1: Extract Givens\n\nThe problem provides the following data, definitions, and conditions:\n- **Paralogous proteins**: Pairs of proteins arising from gene duplication.\n- **Protein domain architecture**: An ordered list of domain identifiers. Let two architectures be $A = [a_1, a_2, \\dots, a_m]$ and $B = [b_1, b_2, \\dots, b_n]$.\n- **Unique domain content set**: For architecture $A$, this is $U_A = \\{a_i \\mid i \\in \\{1,\\dots,m\\}\\}$. For $B$, it is $U_B = \\{b_j \\mid j \\in \\{1,\\dots,n\\}\\}$.\n- **Domain multiplicity count**: For a domain $d$ in architecture $A$, the count is $n_A(d)$. For $B$, it is $n_B(d)$.\n- **Adjacency set**: For architecture $A$, it is the set of ordered bigrams $S_A = \\{(a_i, a_{i+1}) \\mid i \\in \\{1,\\dots,m-1\\}\\}$. For $B$, it is $S_B = \\{(b_j, b_{j+1}) \\mid j \\in \\{1,\\dots,n-1\\}\\}$.\n- **Content Jaccard Index ($J_c$)**: $J_c = \\frac{|U_A \\cap U_B|}{|U_A \\cup U_B|}$.\n- **Multiset Jaccard Index ($J_m$)**: $J_m = \\frac{\\sum_d \\min\\{n_A(d), n_B(d)\\}}{\\sum_d \\max\\{n_A(d), n_B(d)\\}}$, summed over all domains $d$ in either $A$ or $B$.\n- **Adjacency Jaccard Index ($J_a$)**: $J_a = \\frac{|S_A \\cap S_B|}{|S_A \\cup S_B|}$.\n- **Boundary convention**: If the denominator of any Jaccard index is $0$, the index is defined to be $1$.\n- **Rounding**: All final floating-point results must be rounded to exactly $6$ decimal places.\n- **Test suite**:\n    - Case $1$: $A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$\n    - Case $2$: $A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}]$, $B = [\\text{\"RRM\"}, \\text{\"WD40\"}]$\n    - Case $3$: $A = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"PH\"}, \\text{\"FHA\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$\n    - Case $4$: $A = [\\text{\"zf-C2H2\"}]$, $B = [\\text{\"zf-C2H2\"}, \\text{\"zf-C2H2\"}]$\n    - Case $5$: $A = [\\ ]$, $B = [\\ ]$\n    - Case $6$: $A = [\\text{\"SH3\"}, \\text{\"Pro-rich\"}, \\text{\"SH2\"}]$, $B = [\\text{\"SH2\"}, \\text{\"Pro-rich\"}, \\text{\"SH3\"}]$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is well-grounded in computational biology and bioinformatics. The concepts of protein domains, domain architectures, paralogs, and the use of set-based similarity metrics like the Jaccard index are standard and scientifically sound methods for comparing protein sequences.\n- **Well-Posed**: The problem is mathematically well-posed. It provides explicit, unambiguous definitions for all three required metrics ($J_c, J_m, J_a$), including the necessary sets and counting functions. All input data (the test cases) are provided. The boundary condition for division by zero is clearly specified. This ensures that a unique and stable solution exists for each test case.\n- **Objective**: The problem is stated in precise, objective language. The definitions are formal and do not rely on subjective interpretation.\n- **Flaw Checklist**: The problem does not exhibit any of the listed flaws. It is scientifically valid, formalizable, complete, feasible, well-structured, non-trivial, and verifiable.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be developed.\n\n### Solution Derivation\n\nThe task is to compute three distinct Jaccard similarity indices for each given pair of protein domain architectures, $(A, B)$. These indices quantify similarity based on unique domain content ($J_c$), domain multiplicity ($J_m$), and domain order/adjacency ($J_a$). We will systematically apply the provided definitions for each test case.\n\nLet's illustrate the procedure with Case $3$:\n$A = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"PH\"}, \\text{\"FHA\"}]$\\\n$B = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$\n\n**1. Content Jaccard Index ($J_c$)**\nThis index compares the sets of unique domains, ignoring counts and order.\nFirst, we construct the unique domain content sets, $U_A$ and $U_B$:\n$U_A = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"FHA\"}\\}$\n$U_B = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}\\}$\n\nNext, we find their intersection and union:\n$U_A \\cap U_B = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}\\}$\n$U_A \\cup U_B = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"FHA\"}, \\text{\"SH2\"}\\}$\n\nThe cardinalities of these sets are $|U_A \\cap U_B| = 2$ and $|U_A \\cup U_B| = 4$.\nThe Content Jaccard index is:\n$$ J_c = \\frac{|U_A \\cap U_B|}{|U_A \\cup U_B|} = \\frac{2}{4} = 0.5 $$\n\n**2. Multiset Jaccard Index ($J_m$)**\nThis index accounts for the number of times each domain appears.\nWe first identify all unique domains across both architectures, which is the set $U_A \\cup U_B$: $\\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"FHA\"}, \\text{\"SH2\"}\\}$.\nWe then compute the counts $n_A(d)$ and $n_B(d)$ for each domain $d$ in this set.\n\n- For $d = \\text{\"Pkinase\"}$: $n_A(d) = 1$, $n_B(d) = 1$. $\\min=1$, $\\max=1$.\n- For $d = \\text{\"PH\"}$: $n_A(d) = 2$, $n_B(d) = 2$. $\\min=2$, $\\max=2$.\n- For $d = \\text{\"FHA\"}$: $n_A(d) = 1$, $n_B(d) = 0$. $\\min=0$, $\\max=1$.\n- For $d = \\text{\"SH2\"}$: $n_A(d) = 0$, $n_B(d) = 1$. $\\min=0$, $\\max=1$.\n\nThe numerator is the sum of minimums:\n$$ \\sum_d \\min\\{n_A(d), n_B(d)\\} = 1 + 2 + 0 + 0 = 3 $$\nThe denominator is the sum of maximums:\n$$ \\sum_d \\max\\{n_A(d), n_B(d)\\} = 1 + 2 + 1 + 1 = 5 $$\nThe Multiset Jaccard index is:\n$$ J_m = \\frac{3}{5} = 0.6 $$\n\n**3. Adjacency Jaccard Index ($J_a$)**\nThis index compares the ordering of domains by examining sets of adjacent pairs (bigrams).\nFirst, we construct the adjacency sets $S_A$ and $S_B$. An architecture of length $k$ will have $k-1$ adjacencies.\nFor $A = [a_1, a_2, a_3, a_4]$, $S_A = \\{(a_1, a_2), (a_2, a_3), (a_3, a_4)\\}$.\n$S_A = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"FHA\"})\\}$\nFor $B = [b_1, b_2, b_3, b_4]$, $S_B = \\{(b_1, b_2), (b_2, b_3), (b_3, b_4)\\}$.\n$S_B = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"SH2\"}), (\\text{\"SH2\"}, \\text{\"PH\"})\\}$\n\nNext, we find the intersection and union of these sets of pairs:\n$S_A \\cap S_B = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"})\\}$\n$S_A \\cup S_B = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"FHA\"}), (\\text{\"PH\"}, \\text{\"SH2\"}), (\\text{\"SH2\"}, \\text{\"PH\"})\\}$\n\nThe cardinalities are $|S_A \\cap S_B| = 1$ and $|S_A \\cup S_B| = 5$.\nThe Adjacency Jaccard index is:\n$$ J_a = \\frac{|S_A \\cap S_B|}{|S_A \\cup S_B|} = \\frac{1}{5} = 0.2 $$\n\nThe procedure is applied systematically to all test cases to derive the final results. Special attention is given to boundary cases. For example, in Case $5$, both architectures $A$ and $B$ are empty lists. This leads to empty sets for unique domains and adjacencies, and zero-valued count sums for the multiset index. In all three instances, the denominator of the Jaccard formula becomes $0$. By the specified boundary convention, $J_c, J_m$, and $J_a$ are all defined to be $1$. Similarly, for Case $4$, the first architecture has length $1$, so its adjacency set $S_A$ is empty.\nThis comprehensive, step-by-step application of the given rigorous definitions ensures the correct computation of the three similarity indices for each pair of protein architectures. The implementation will formalize this logic.", "answer": "[[1.000000,1.000000,1.000000],[0.000000,0.000000,0.000000],[0.500000,0.600000,0.200000],[1.000000,0.500000,0.000000],[1.000000,1.000000,1.000000],[1.000000,1.000000,0.000000]]", "id": "4379742"}]}