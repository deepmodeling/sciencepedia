{"hands_on_practices": [{"introduction": "To master fluid resuscitation, one must first grasp the fundamental forces governing fluid exchange at the microvascular level. The Starling principle provides the foundational framework, describing how fluid moves between capillaries and the surrounding tissue. This exercise [@problem_id:5106996] allows you to isolate and quantify the primary therapeutic effect of colloid solutions: the increase in plasma oncotic pressure. By calculating the resulting change in fluid flux, you will gain a concrete understanding of how colloids directly counteract edema and \"pull\" fluid back into the vascular space.", "problem": "A hemodynamically monitored postoperative patient is being resuscitated. You are told that for the next short interval, transcapillary hydrostatic pressures remain constant and interstitial oncotic pressure does not change appreciably. Consider transvascular fluid exchange modeled by the Starling principle with a single lumped microvascular unit characterized by a total capillary filtration coefficient $K_f$ and a solvent reflection coefficient $\\sigma$ for albumin. For this patient, $K_f = 0.6\\,\\text{mL}\\,\\text{min}^{-1}\\,\\text{mmHg}^{-1}$ and $\\sigma = 0.9$. A bolus of concentrated albumin increases plasma oncotic pressure by $\\Delta \\pi_c = +5\\,\\text{mmHg}$ over this interval, while the interstitial oncotic pressure and all hydrostatic pressures are unchanged. Take the sign convention that a positive transcapillary volume flux $J_v$ denotes filtration from capillary to interstitium.\n\nUsing only fundamental definitions of transcapillary exchange and standard physiologic laws of microvascular fluid transport, determine the change in net transcapillary volume flux $\\Delta J_v$ produced by this albumin-induced rise in plasma oncotic pressure. Express your final answer in $\\text{mL}\\,\\text{min}^{-1}$ and round your answer to three significant figures.", "solution": "The problem is valid. It is scientifically grounded in the principles of microvascular physiology, is well-posed with sufficient information for a unique solution, and is stated objectively.\n\nThe fundamental principle governing transvascular fluid exchange is the Starling equation. The net transcapillary volume flux, denoted by $J_v$, is given by:\n$$J_v = K_f [ \\Delta P - \\sigma \\Delta \\pi ]$$\nwhere $\\Delta P$ is the net hydrostatic pressure gradient and $\\Delta \\pi$ is the net oncotic pressure gradient across the capillary wall. Expanding these terms, the equation is:\n$$J_v = K_f [ (P_c - P_i) - \\sigma (\\pi_c - \\pi_i) ]$$\nIn this equation:\n- $J_v$ is the net transcapillary volume flux, with a positive value indicating net filtration (fluid movement from capillary to interstitium).\n- $K_f$ is the capillary filtration coefficient, representing the hydraulic conductivity of the capillary wall.\n- $P_c$ is the capillary hydrostatic pressure.\n- $P_i$ is the interstitial hydrostatic pressure.\n- $\\sigma$ is the solvent reflection coefficient, which describes the effectiveness of the oncotic pressure gradient in promoting fluid movement. A value of $1$ means the membrane is impermeable to the solute (e.g., proteins), while a value of $0$ means it is freely permeable.\n- $\\pi_c$ is the capillary (plasma) oncotic pressure, generated primarily by plasma proteins like albumin.\n- $\\pi_i$ is the interstitial oncotic pressure, generated by proteins in the interstitial fluid.\n\nThe problem asks for the change in the net transcapillary volume flux, $\\Delta J_v$, resulting from a specific change in the plasma oncotic pressure, $\\Delta \\pi_c$. Let the initial state be denoted by subscript $1$ and the final state by subscript $2$.\n\nThe initial flux is:\n$$J_{v,1} = K_f [ (P_c - P_i) - \\sigma (\\pi_{c,1} - \\pi_i) ]$$\nThe problem states that a bolus of albumin increases the plasma oncotic pressure by $\\Delta \\pi_c$. All other pressures ($P_c$, $P_i$, $\\pi_i$) and coefficients ($K_f$, $\\sigma$) are constant over the short interval. Therefore, the new plasma oncotic pressure is $\\pi_{c,2} = \\pi_{c,1} + \\Delta \\pi_c$.\n\nThe final flux is:\n$$J_{v,2} = K_f [ (P_c - P_i) - \\sigma (\\pi_{c,2} - \\pi_i) ]$$\nSubstituting the expression for $\\pi_{c,2}$:\n$$J_{v,2} = K_f [ (P_c - P_i) - \\sigma ((\\pi_{c,1} + \\Delta \\pi_c) - \\pi_i) ]$$\n$$J_{v,2} = K_f [ (P_c - P_i) - \\sigma (\\pi_{c,1} - \\pi_i) - \\sigma \\Delta \\pi_c ]$$\n\nThe change in flux, $\\Delta J_v$, is the difference between the final and initial fluxes:\n$$\\Delta J_v = J_{v,2} - J_{v,1}$$\n$$\\Delta J_v = \\left( K_f [ (P_c - P_i) - \\sigma (\\pi_{c,1} - \\pi_i) - \\sigma \\Delta \\pi_c ] \\right) - \\left( K_f [ (P_c - P_i) - \\sigma (\\pi_{c,1} - \\pi_i) ] \\right)$$\nBy distributing $K_f$ and identifying common terms, we can see that the terms corresponding to the initial state cancel out:\n$$\\Delta J_v = \\underbrace{K_f [ (P_c - P_i) - \\sigma (\\pi_{c,1} - \\pi_i) ]}_{J_{v,1}} - K_f \\sigma \\Delta \\pi_c - \\underbrace{K_f [ (P_c - P_i) - \\sigma (\\pi_{c,1} - \\pi_i) ]}_{J_{v,1}}$$\nThis simplifies to:\n$$\\Delta J_v = - K_f \\sigma \\Delta \\pi_c$$\nThis derived expression shows that the change in flux is directly proportional to the change in plasma oncotic pressure, modulated by the filtration and reflection coefficients. The negative sign indicates that an increase in plasma oncotic pressure ($\\Delta \\pi_c > 0$) leads to a decrease in net filtration flux (i.e., it promotes fluid absorption into the capillary).\n\nNow, we substitute the given values into this equation:\n- $K_f = 0.6\\,\\text{mL}\\,\\text{min}^{-1}\\,\\text{mmHg}^{-1}$\n- $\\sigma = 0.9$\n- $\\Delta \\pi_c = +5\\,\\text{mmHg}$\n\n$$\\Delta J_v = - (0.6\\,\\text{mL}\\,\\text{min}^{-1}\\,\\text{mmHg}^{-1}) \\times (0.9) \\times (5\\,\\text{mmHg})$$\nFirst, we calculate the product of the numerical values:\n$$0.6 \\times 0.9 \\times 5 = 0.54 \\times 5 = 2.7$$\nThe units of $\\text{mmHg}$ cancel, leaving the final units as $\\text{mL}\\,\\text{min}^{-1}$.\n$$\\Delta J_v = -2.7\\,\\text{mL}\\,\\text{min}^{-1}$$\nThe problem requires the answer to be rounded to three significant figures. The value $-2.7$ can be expressed as $-2.70$ to meet this requirement. The negative sign signifies a reduction in filtration, or an increase in absorption, of $2.70\\,\\text{mL}\\,\\text{min}^{-1}$.", "answer": "$$\\boxed{-2.70}$$", "id": "5106996"}, {"introduction": "Beyond managing volume, the choice of resuscitation fluid has profound effects on a patient's acid-base balance. The Stewart physicochemical approach offers a powerful lens for analyzing these effects, moving beyond traditional methods by focusing on the Strong Ion Difference (SID) as a primary determinant of pH. This problem [@problem_id:5106929] simulates a common clinical challenge, asking you to use patient data to diagnose a post-resuscitation metabolic acidosis. By calculating the SID, you will learn to identify and quantify the impact of chloride-rich fluids, a crucial skill for preventing iatrogenic complications.", "problem": "An adult patient in the surgical intensive care unit received emergent resuscitation for hemorrhagic shock primarily with a chloride-rich crystalloid (isotonic sodium chloride) and a saline-based colloid. Shortly after fluid resuscitation, an arterial blood gas (ABG) and serum electrolytes are obtained. The ABG reports a pH of $7.32$ and a partial pressure of carbon dioxide ($P_{\\text{CO}_2}$) of $40\\ \\text{mmHg}$. Serum electrolytes show sodium ($\\text{Na}^+$) of $140\\ \\text{mEq/L}$, chloride ($\\text{Cl}^-$) of $114\\ \\text{mEq/L}$, and potassium ($\\text{K}^+$) of $4\\ \\text{mEq/L}$. Assume albumin is within normal limits and lactate is not elevated, and ignore calcium and magnesium for the simplified strong ion analysis. Using first principles that include electroneutrality and water dissociation in the Stewart physicochemical framework, and well-tested relationships for acid–base physiology, determine whether the observed derangement is consistent with hyperchloremia-induced non–anion gap metabolic acidosis after resuscitation, and quantify the strong ion difference (SID)-based deficit by comparing the patient’s simplified SID to a normal physiologic reference. For this purpose, take the normal simplified SID to be $40\\ \\text{mEq/L}$. Report only the magnitude of the SID deficit as your final answer, expressed in $\\text{mEq/L}$. No rounding is necessary.", "solution": "The problem statement will first be validated for scientific soundness, completeness, and objectivity before any attempt at a solution is made.\n\n### Step 1: Extract Givens\nThe following data and conditions are provided in the problem statement:\n- **Patient Context**: Adult in surgical intensive care unit, post-resuscitation for hemorrhagic shock.\n- **Resuscitation Fluids**: Chloride-rich crystalloid (isotonic sodium chloride) and a saline-based colloid.\n- **Arterial Blood Gas (ABG)**: $\\text{pH} = 7.32$; Partial pressure of carbon dioxide, $P_{\\text{CO}_2} = 40\\ \\text{mmHg}$.\n- **Serum Electrolytes**: Sodium, $[\\text{Na}^+] = 140\\ \\text{mEq/L}$; Chloride, $[\\text{Cl}^-] = 114\\ \\text{mEq/L}$; Potassium, $[\\text{K}^+] = 4\\ \\text{mEq/L}$.\n- **Assumptions and Simplifications**: Albumin is within normal limits; lactate is not elevated; calcium and magnesium are to be ignored for a simplified strong ion analysis.\n- **Analytical Framework**: Stewart physicochemical framework, incorporating electroneutrality and water dissociation.\n- **Reference Value**: Normal simplified Strong Ion Difference (SID) is taken as $40\\ \\text{mEq/L}$.\n- **Objective**: Determine if the findings are consistent with hyperchloremia-induced non–anion gap metabolic acidosis and quantify the SID-based deficit.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established validation criteria.\n\n1.  **Scientifically Grounded**: The problem is firmly rooted in the Stewart model of acid-base physiology, a well-established and sophisticated framework used in critical care medicine. The concepts of Strong Ion Difference (SID), electroneutrality, and the role of chloride-rich fluids in inducing metabolic acidosis are standard topics in advanced medical physiology and anesthesia. The provided physiological values (pH, $P_{\\text{CO}_2}$, and electrolytes) are clinically plausible for the described scenario. The problem is scientifically sound.\n\n2.  **Well-Posed**: The problem is well-posed. It provides all necessary data (concentrations of the relevant strong ions, a reference SID value) to perform the required calculation. The objective is clearly defined: to calculate the patient's simplified SID, compare it to a normal value, and quantify the deficit. A unique, meaningful solution exists.\n\n3.  **Objective**: The problem is stated in precise, objective, and clinical language. It is free of subjectivity or opinion.\n\n4.  **No Flaws**: The problem does not violate any fundamental principles, is not metaphorical, is complete, and contains realistic data. It is well-structured and verifiable within the domain of medical physiology.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be formulated based on the provided data and principles.\n\n### Solution Formulation\n\nThe Stewart model of acid-base balance is based on three independent variables that determine the state of all dependent variables, including the hydrogen ion concentration, $[\\text{H}^+]$ (and thus pH), in plasma:\n1.  The Strong Ion Difference (SID).\n2.  The total concentration of weak nonvolatile acids ($A_{tot}$), primarily albumin and phosphate.\n3.  The partial pressure of carbon dioxide ($P_{\\text{CO}_2}$).\n\nThe fundamental principle is the law of electroneutrality, which mandates that the sum of all positive charges must equal the sum of all negative charges in any aqueous solution.\n\nThe Strong Ion Difference (SID) is defined as the charge difference between all fully dissociated (strong) cations and all fully dissociated (strong) anions. A simplified, apparent SID ($\\text{SID}_{\\text{app}}$) can be calculated from the most abundant strong ions. As per the problem's instructions, we will use a simplified SID calculation involving only sodium, potassium, and chloride.\n\nLet the patient's simplified SID be denoted as $\\text{SID}_{\\text{patient}}$. It is calculated as the sum of the concentrations of the measured strong cations minus the concentration of the measured strong anion:\n$$ \\text{SID}_{\\text{patient}} = ([\\text{Na}^+] + [\\text{K}^+]) - [\\text{Cl}^-] $$\n\nUsing the given electrolyte values:\n- $[\\text{Na}^+] = 140\\ \\text{mEq/L}$\n- $[\\text{K}^+] = 4\\ \\text{mEq/L}$\n- $[\\text{Cl}^-] = 114\\ \\text{mEq/L}$\n\nWe substitute these values into the equation:\n$$ \\text{SID}_{\\text{patient}} = (140\\ \\text{mEq/L} + 4\\ \\text{mEq/L}) - 114\\ \\text{mEq/L} $$\n$$ \\text{SID}_{\\text{patient}} = 144\\ \\text{mEq/L} - 114\\ \\text{mEq/L} $$\n$$ \\text{SID}_{\\text{patient}} = 30\\ \\text{mEq/L} $$\n\nThe patient's simplified SID is calculated to be $30\\ \\text{mEq/L}$. According to the Stewart model, a decrease in the SID forces a compensatory change in the concentrations of dependent ions to maintain electroneutrality. Specifically, to balance the smaller positive charge surplus from strong ions, the body must either decrease the concentration of cations or increase the concentration of anions. The primary mechanism is an increase in $[\\text{H}^+]$ via a shift in the water dissociation equilibrium ($H_2O \\rightleftharpoons H^+ + OH^-$), resulting in metabolic acidosis.\n\nThe patient's measured pH is $7.32$, which constitutes an acidemia. The $P_{\\text{CO}_2}$ is $40\\ \\text{mmHg}$, which is within the normal range, indicating the primary disorder is metabolic, not respiratory. The patient's calculated SID of $30\\ \\text{mEq/L}$ is lower than the normal SID of $40\\ \\text{mEq/L}$. This reduction in SID is the physicochemical cause of the observed metabolic acidosis. The high chloride level ($[\\text{Cl}^-]=114\\ \\text{mEq/L}$) is the reason for the low SID, making hyperchloremia the specific etiology. This clinical picture is entirely consistent with hyperchloremia-induced non–anion gap metabolic acidosis following resuscitation with chloride-rich fluids.\n\nThe problem asks for the quantification of the SID deficit, which is the difference between the normal reference SID and the patient's calculated SID.\n\nLet $\\text{SID}_{\\text{normal}} = 40\\ \\text{mEq/L}$.\nThe SID deficit is given by:\n$$ \\text{SID}_{\\text{deficit}} = \\text{SID}_{\\text{normal}} - \\text{SID}_{\\text{patient}} $$\n$$ \\text{SID}_{\\text{deficit}} = 40\\ \\text{mEq/L} - 30\\ \\text{mEq/L} $$\n$$ \\text{SID}_{\\text{deficit}} = 10\\ \\text{mEq/L} $$\n\nThe magnitude of the SID deficit is $10\\ \\text{mEq/L}$. This quantifies the contribution of the change in strong ions to the patient's metabolic acidosis.", "answer": "$$\\boxed{10}$$", "id": "5106929"}, {"introduction": "While static principles like the Starling equation and SID analysis are essential, a complete understanding of fluid therapy requires a dynamic perspective. How a fluid is distributed and eliminated over time determines its efficacy and duration of action. This advanced practice [@problem_id:5106944] introduces you to pharmacokinetic modeling, a cornerstone of modern physiological analysis. By developing and applying a two-compartment model, you will simulate and directly compare the intravascular persistence of crystalloids versus colloids, providing a quantitative basis for their distinct clinical applications and reinforcing the core concepts of volume kinetics.", "problem": "A patient with body weight $70\\ \\text{kg}$ has extracellular fluid equal to $0.20$ of body weight. Assume the extracellular fluid is partitioned into a central intravascular compartment (plasma) with fraction $0.25$ of extracellular fluid and a peripheral interstitial compartment with fraction $0.75$ of extracellular fluid. Let the central compartment volume be $V_1$ in liters and the peripheral compartment volume be $V_2$ in liters. The fluid kinetics are modeled by a two-compartment system based on conservation of mass and concentration-driven exchange, where $m_1(t)$ and $m_2(t)$ (both in liters) denote the excess fluid volume above baseline in the central and peripheral compartments at time $t$ (in minutes). Fluid is infused into the central compartment at a constant rate during an infusion period and zero thereafter. For isotonic crystalloid, use transfer rate constants $k_{12} = 0.2\\ \\text{min}^{-1}$ and $k_{21} = 0.1\\ \\text{min}^{-1}$. For colloid, model reduced transcapillary escape using a reflection coefficient $\\sigma = 0.8$ by replacing $k_{12}$ with $(1-\\sigma)k_{12}$ while keeping $k_{21}$ unchanged. Assume initial conditions $m_1(0) = 0$ and $m_2(0) = 0$.\n\nDerive from first principles and implement the time evolution governed by the following system of Ordinary Differential Equations (ODEs):\n$$\n\\frac{dm_1}{dt} = u(t) - k_{12}\\,\\frac{m_1(t)}{V_1} + k_{21}\\,\\frac{m_2(t)}{V_2}, \\quad\n\\frac{dm_2}{dt} = k_{12}\\,\\frac{m_1(t)}{V_1} - k_{21}\\,\\frac{m_2(t)}{V_2},\n$$\nwhere $u(t)$ is a piecewise-constant infusion rate defined by $u(t) = \\frac{B}{T_{\\text{inf}}}$ for $0 \\le t \\le T_{\\text{inf}}$ and $u(t) = 0$ for $t > T_{\\text{inf}}$, with $B$ the infused volume in liters and $T_{\\text{inf}}$ the infusion duration in minutes.\n\nCompute $V_1$ and $V_2$ from the given body weight and fractions. Then, for each test case specified below, simulate the system for both isotonic crystalloid and colloid, and report the intravascular retained fluid volume $m_1(T)$ in liters at the specified observation time $T$. Express all reported values in liters, rounded to three decimal places.\n\nUse the following test suite, where each case is a triple $(B, T_{\\text{inf}}, T)$ in units of liters and minutes:\n- Case $1$: $(1.0, 15, 30)$,\n- Case $2$: $(0.5, 5, 5)$,\n- Case $3$: $(1.0, 10, 240)$,\n- Case $4$: $(0.25, 1, 10)$,\n- Case $5$: $(0.0, 10, 60)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a two-element list `[x_crystalloid, x_colloid]` of the intravascular retained fluid volumes in liters evaluated at time $T$. For example, the overall format must be\n`[[x_c1,x_o1],[x_c2,x_o2],[x_c3,x_o3],[x_c4,x_o4],[x_c5,x_o5]]`,\nwith each $x$ the rounded float in liters.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in compartment modeling, a standard physiological and pharmacokinetic methodology. The problem is well-posed, providing a system of linear ordinary differential equations with constant coefficients, well-defined initial conditions, and a piecewise constant forcing function. All necessary parameters are provided, and there are no internal contradictions. The task is objective and clearly specified.\n\nA solution is therefore possible and will be derived from first principles as requested.\n\nFirst, we calculate the baseline volumes of the central compartment, $V_1$, and the peripheral compartment, $V_2$.\nThe patient's body weight is $70\\ \\text{kg}$.\nThe total extracellular fluid volume, $V_{\\text{ECF}}$, is $0.20$ of the body weight:\n$$V_{\\text{ECF}} = 0.20 \\times 70\\,\\text{kg} = 14\\,\\text{L}$$\nThe central compartment (plasma) volume, $V_1$, is $0.25$ of $V_{\\text{ECF}}$:\n$$V_1 = 0.25 \\times 14\\,\\text{L} = 3.5\\,\\text{L}$$\nThe peripheral compartment (interstitial) volume, $V_2$, is $0.75$ of $V_{\\text{ECF}}$:\n$$V_2 = 0.75 \\times 14\\,\\text{L} = 10.5\\,\\text{L}$$\n\nThe fluid kinetics are described by the system of linear first-order Ordinary Differential Equations (ODEs):\n$$\n\\frac{dm_1}{dt} = u(t) - k_{12}\\,\\frac{m_1(t)}{V_1} + k_{21}\\,\\frac{m_2(t)}{V_2} \\\\\n\\frac{dm_2}{dt} = k_{12}\\,\\frac{m_1(t)}{V_1} - k_{21}\\,\\frac{m_2(t)}{V_2}\n$$\nwith initial conditions $m_1(0) = 0$ and $m_2(0) = 0$. Let us define the rate constants per unit volume as $k_1 = k_{12}/V_1$ and $k_2 = k_{21}/V_2$. The system becomes:\n$$\n\\frac{dm_1}{dt} = u(t) - k_1 m_1(t) + k_2 m_2(t) \\\\\n\\frac{dm_2}{dt} = k_1 m_1(t) - k_2 m_2(t)\n$$\nSumming the two equations yields $\\frac{d}{dt}(m_1(t) + m_2(t)) = u(t)$. Integrating from $t=0$ and applying the initial conditions gives the conservation of mass equation: $m_1(t) + m_2(t) = \\int_0^t u(\\tau)d\\tau$.\n\nThe solution is determined in two phases corresponding to the piecewise definition of the infusion rate $u(t)$.\n\nPhase 1: Infusion Period ($0 \\le t \\le T_{\\text{inf}}$)\nDuring this phase, the infusion rate is constant: $u(t) = u_0 = B/T_{\\text{inf}}$. The mass conservation gives $m_1(t) + m_2(t) = u_0 t$. We can express $m_2(t)$ as $m_2(t) = u_0 t - m_1(t)$ and substitute it into the first ODE:\n$$ \\frac{dm_1}{dt} = u_0 - k_1 m_1 + k_2 (u_0 t - m_1) $$\n$$ \\frac{dm_1}{dt} + (k_1+k_2)m_1 = u_0(1+k_2 t) $$\nThis is a linear first-order ODE of the form $\\frac{dy}{dt} + P(t)y = Q(t)$. Let $K = k_1+k_2$. The equation is $\\frac{dm_1}{dt} + K m_1 = u_0(1+k_2 t)$.\nThe general solution is the sum of the homogeneous solution, $m_{1h}(t) = C e^{-Kt}$, and a particular solution, $m_{1p}(t)$. We guess a particular solution of the form $m_{1p}(t) = At+D$. Substituting into the ODE:\n$$ A + K(At+D) = u_0(1+k_2 t) $$\n$$ KAt + (A+KD) = u_0 k_2 t + u_0 $$\nEquating coefficients of powers of $t$:\n- $t^1$: $KA = u_0 k_2 \\implies A = \\frac{u_0 k_2}{K}$\n- $t^0$: $A+KD = u_0 \\implies D = \\frac{u_0 - A}{K} = \\frac{u_0 - u_0 k_2/K}{K} = \\frac{u_0(K-k_2)}{K^2} = \\frac{u_0 k_1}{K^2}$\nSo, the general solution is $m_1(t) = C e^{-Kt} + \\frac{u_0 k_2}{K}t + \\frac{u_0 k_1}{K^2}$.\nUsing the initial condition $m_1(0)=0$:\n$$ 0 = C e^0 + 0 + \\frac{u_0 k_1}{K^2} \\implies C = -\\frac{u_0 k_1}{K^2} $$\nThe solution for $m_1(t)$ in the infusion phase is:\n$$ m_1(t) = \\frac{u_0 k_1}{K^2}(1 - e^{-Kt}) + \\frac{u_0 k_2}{K}t, \\quad \\text{for } 0 \\le t \\le T_{\\text{inf}} $$\n\nPhase 2: Post-Infusion Period ($t > T_{\\text{inf}}$)\nFor $t > T_{\\text{inf}}$, the infusion stops, so $u(t) = 0$. The total infused volume is $B$. The mass conservation becomes $m_1(t) + m_2(t) = B$. The ODE system is now homogeneous:\n$$ \\frac{dm_1}{dt} = -k_1 m_1 + k_2 (B-m_1) = - (k_1+k_2)m_1 + k_2 B $$\n$$ \\frac{dm_1}{dt} + K m_1 = k_2 B $$\nThe general solution is $m_1(t) = C' e^{-K(t-T_{\\text{inf}})} + \\frac{k_2 B}{K}$. The constant $C'$ is determined by the condition at the transition time $t=T_{\\text{inf}}$. The value $m_1(T_{\\text{inf}})$ is obtained from the Phase 1 solution:\n$$ m_1(T_{\\text{inf}}) = \\frac{u_0 k_1}{K^2}(1 - e^{-KT_{\\text{inf}}}) + \\frac{u_0 k_2}{K}T_{\\text{inf}} $$\nSubstituting $u_0 = B/T_{\\text{inf}}$, we get $m_1(T_{\\text{inf}}) = \\frac{B k_1}{K^2 T_{\\text{inf}}}(1 - e^{-KT_{\\text{inf}}}) + \\frac{B k_2}{K}$.\nAt $t=T_{\\text{inf}}$, we must have $m_1(T_{\\text{inf}}) = C' + \\frac{k_2 B}{K}$, so $C' = m_1(T_{\\text{inf}}) - \\frac{k_2 B}{K} = \\frac{B k_1}{K^2 T_{\\text{inf}}}(1 - e^{-KT_{\\text{inf}}})$.\nThe solution for $m_1(t)$ in the post-infusion phase is:\n$$ m_1(t) = \\frac{k_2 B}{K} + \\left[ \\frac{B k_1}{K^2 T_{\\text{inf}}}(1 - e^{-KT_{\\text{inf}}}) \\right] e^{-K(t-T_{\\text{inf}})}, \\quad \\text{for } t > T_{\\text{inf}} $$\n\nThe parameters for the two fluid types are:\n- Isotonic Crystalloid: $k_{12} = 0.2\\,\\text{min}^{-1}$, $k_{21} = 0.1\\,\\text{min}^{-1}$.\n- Colloid: $k_{12,c} = (1-\\sigma)k_{12} = (1-0.8) \\times 0.2 = 0.04\\,\\text{min}^{-1}$, $k_{21,c} = k_{21} = 0.1\\,\\text{min}^{-1}$.\n\nThe algorithm to solve the problem is as follows:\n1. For each test case $(B, T_{\\text{inf}}, T)$, perform calculations for both crystalloid and colloid fluids.\n2. For each fluid type, calculate $k_1 = k_{12}/V_1$ and $k_2 = k_{21}/V_2$, and then $K=k_1+k_2$.\n3. If the total infused volume $B=0$, the result is $0$.\n4. If the observation time $T \\le T_{\\text{inf}}$, use the Phase 1 formula for $m_1(T)$.\n5. If $T > T_{\\text{inf}}$, use the Phase 2 formula for $m_1(T)$.\n6. Report the results $m_1(T)$ for crystalloid and colloid, rounded to three decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_m1(B, T_inf, T, k12, k21, V1, V2):\n    \"\"\"\n    Calculates the intravascular retained fluid volume m1 at time T.\n\n    Args:\n        B (float): Total infused volume in liters.\n        T_inf (float): Infusion duration in minutes.\n        T (float): Observation time in minutes.\n        k12 (float): Transfer rate constant from central to peripheral (min^-1).\n        k21 (float): Transfer rate constant from peripheral to central (min^-1).\n        V1 (float): Central compartment volume in liters.\n        V2 (float): Peripheral compartment volume in liters.\n\n    Returns:\n        float: The value of m1(T) in liters.\n    \"\"\"\n    # Trivial case: no infusion means no excess fluid.\n    if B == 0.0:\n        return 0.0\n    \n    # This case is not in the test suite, but to avoid division by zero.\n    # If T_inf is 0, we'd have a bolus, which requires a different starting point.\n    # The limit of the infusion-based formula as T_inf -> 0 works, but direct\n    # implementation can cause division by zero. The test cases do not have T_inf=0.\n    if T_inf == 0.0:\n        # A bolus injection of volume B at t=0 would mean m1(0)=B and m2(0)=0.\n        # This is a different initial value problem than stated.\n        # The problem statement implies T_inf > 0, defining u(t).\n        # We handle B=0, which is sufficient for the test suite.\n        return 0.0\n        \n    u0 = B / T_inf\n    k1 = k12 / V1\n    k2 = k21 / V2\n    K = k1 + k2\n\n    if T <= T_inf:\n        # Phase 1: During infusion (0 <= t <= T_inf)\n        # m1(t) = (u0*k1/K**2) * (1 - exp(-K*t)) + (u0*k2/K) * t\n        term1 = (u0 * k1 / (K**2)) * (1 - np.exp(-K * T))\n        term2 = (u0 * k2 / K) * T\n        m1 = term1 + term2\n    else:\n        # Phase 2: Post-infusion (t > T_inf)\n        # m1(t) = (k2*B/K) + [ (B*k1)/(K**2 * T_inf) * (1-exp(-K*T_inf)) ] * exp(-K*(t-T_inf))\n        \n        # This term (1-exp(-x))/x can be unstable for small x.\n        # np.expm1(y)/y computes (e^y-1)/y accurately.\n        # Let x = K*T_inf, y = -x. (1-e^-x)/x = (1-e^y)/(-y) = (e^y-1)/y\n        if K * T_inf < 1e-6: # Use Taylor expansion for stability\n            kt_inf_term = 1.0 - (K * T_inf / 2.0)\n        else:\n            kt_inf_term = (1 - np.exp(-K * T_inf)) / (K * T_inf)\n\n        C_factor = (B * k1 / K) * kt_inf_term\n        \n        m1 = (k2 * B / K) + C_factor * np.exp(-K * (T - T_inf))\n        \n    return m1\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define patient and model constants\n    body_weight = 70.0  # kg\n    ecf_fraction = 0.20\n    plasma_fraction_of_ecf = 0.25\n    \n    # Calculate compartment volumes\n    V_ecf = body_weight * ecf_fraction\n    V1 = V_ecf * plasma_fraction_of_ecf\n    V2 = V_ecf * (1 - plasma_fraction_of_ecf)\n\n    # Define rate constants for each fluid type\n    k12_cryst = 0.2\n    k21_cryst = 0.1\n    sigma_colloid = 0.8\n    k12_colloid = (1 - sigma_colloid) * k12_cryst\n    k21_colloid = k21_cryst\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 15.0, 30.0),\n        (0.5, 5.0, 5.0),\n        (1.0, 10.0, 240.0),\n        (0.25, 1.0, 10.0),\n        (0.0, 10.0, 60.0),\n    ]\n\n    results = []\n    for B, T_inf, T in test_cases:\n        # Calculate results for both crystalloid and colloid\n        m1_cryst = calculate_m1(B, T_inf, T, k12_cryst, k21_cryst, V1, V2)\n        m1_colloid = calculate_m1(B, T_inf, T, k12_colloid, k21_colloid, V1, V2)\n        \n        results.append([m1_cryst, m1_colloid])\n\n    # Format the final output string exactly as specified.\n    # Values are formatted to three decimal places.\n    formatted_pairs = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "5106944"}]}