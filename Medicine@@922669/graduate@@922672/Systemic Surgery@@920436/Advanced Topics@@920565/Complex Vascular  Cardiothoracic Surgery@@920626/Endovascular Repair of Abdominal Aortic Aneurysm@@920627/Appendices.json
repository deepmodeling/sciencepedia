{"hands_on_practices": [{"introduction": "Before exploring the mechanics of endovascular repair, we must first quantify the problem it solves: the risk of aneurysm rupture. This exercise applies the fundamental Law of Laplace to estimate the circumferential or \"hoop\" stress within an aneurysm wall, providing a tangible link between aneurysm size, blood pressure, and mechanical failure risk. Mastering this calculation provides a foundational, biomechanically-informed perspective on clinical decision-making for Abdominal Aortic Aneurysm (AAA) management [@problem_id:5114552].", "problem": "A patient with an Abdominal Aortic Aneurysm (AAA) is considered for Endovascular Aneurysm Repair (EVAR). Assume the aneurysm segment can be locally approximated as a thin-walled cylindrical vessel under static internal pressurization. Starting from mechanical equilibrium for a cylindrical vessel segment and the definition of Cauchy stress, derive the expression for circumferential (hoop) wall stress in terms of internal pressure, inner radius, and wall thickness. Then, using a measured maximum aneurysm diameter of $5.5$ cm, an estimated uniform wall thickness of $2$ mm, and a Mean Arterial Pressure (MAP) of $100$ mmHg, compute the circumferential wall stress at the location of maximum diameter. For unit conversion, use $1$ mmHg $=133.322$ Pa. Express the final stress in megapascal (MPa) and round your answer to four significant figures. Finally, briefly discuss (qualitatively, no numerical answer required) at least two important limitations of the thin-wall assumption when applied to heterogeneous AAA walls, particularly in the presence of Intraluminal Thrombus (ILT) and anisotropic mural composition.", "solution": "The problem statement is evaluated as scientifically grounded, well-posed, objective, and complete. It is based on fundamental principles of continuum mechanics applied to a standard biomechanical approximation. The provided data are clinically realistic and sufficient for a unique solution. Therefore, the problem is deemed valid.\n\nThe solution proceeds in three parts: first, the derivation of the hoop stress formula; second, the numerical calculation of the stress for the given parameters; and third, a qualitative discussion of the model's limitations.\n\n**Part 1: Derivation of Circumferential (Hoop) Stress**\n\nWe model the aneurysm as a thin-walled cylindrical pressure vessel of inner radius $R$, wall thickness $h$, and length $L$. The vessel is subjected to a uniform internal gauge pressure $P$. To find the circumferential stress, also known as hoop stress ($\\sigma_{\\theta}$), we analyze the mechanical equilibrium of a semicircular segment of the vessel.\n\nConsider a free-body diagram of half of the cylinder, created by making a longitudinal cut through the central axis. The internal pressure $P$ acts perpendicularly to the inner surface. The net force due to this pressure, $F_P$, pushes the two halves of the cylinder apart. This force is calculated by integrating the pressure over the projected area of the inner surface onto the plane of the cut. The projected area is a rectangle of width $2R$ and length $L$.\n\nThe force due to pressure is given by:\n$$\nF_P = P \\times (\\text{Projected Area}) = P \\times (2R \\times L)\n$$\n\nThis outward-acting force must be balanced by the internal tensile forces within the vessel wall at the points where the cut was made. The stress acting along the circumference is the hoop stress, $\\sigma_{\\theta}$. This stress is a component of the Cauchy stress tensor. Assuming the stress is uniformly distributed through the wall thickness (a key aspect of the thin-wall approximation), the total restoring force, $F_{wall}$, is the product of the hoop stress and the cross-sectional area of the wall material that was cut. The cut exposes two rectangular wall sections, each with an area of $h \\times L$.\n\nThe total area of the resisting wall material is:\n$$\nA_{wall} = 2 \\times (h \\times L)\n$$\n\nThe total restoring force from the wall tension is therefore:\n$$\nF_{wall} = \\sigma_{\\theta} \\times A_{wall} = \\sigma_{\\theta} \\times (2hL)\n$$\n\nFor the vessel segment to be in static equilibrium, the force due to pressure must be equal to the restoring force in the wall:\n$$\nF_P = F_{wall}\n$$\n$$\nP \\times (2RL) = \\sigma_{\\theta} \\times (2hL)\n$$\n\nWe can cancel the terms $2$ and $L$ from both sides of the equation:\n$$\nPR = \\sigma_{\\theta}h\n$$\n\nSolving for the hoop stress, $\\sigma_{\\theta}$, we obtain the desired expression, which is a form of the Law of Laplace for a cylindrical membrane:\n$$\n\\sigma_{\\theta} = \\frac{PR}{h}\n$$\n\n**Part 2: Numerical Calculation of Wall Stress**\n\nWe are given the following parameters:\nMaximum aneurysm diameter, $D = 5.5$ cm.\nWall thickness, $h = 2$ mm.\nMean Arterial Pressure (MAP), $P_{MAP} = 100$ mmHg.\nConversion factor: $1$ mmHg $= 133.322$ Pa.\n\nFirst, we must convert all given values to consistent SI units (meters, Pascals).\n\nThe inner radius $R$ is half of the diameter:\n$$\nR = \\frac{D}{2} = \\frac{5.5 \\text{ cm}}{2} = 2.75 \\text{ cm} = 0.0275 \\text{ m}\n$$\n\nThe wall thickness $h$:\n$$\nh = 2 \\text{ mm} = 0.002 \\text{ m}\n$$\n\nThe internal pressure $P$ in Pascals (Pa), where $1$ Pa $= 1$ N/m$^2$:\n$$\nP = 100 \\text{ mmHg} \\times \\frac{133.322 \\text{ Pa}}{1 \\text{ mmHg}} = 13332.2 \\text{ Pa}\n$$\n\nThe thin-wall assumption is generally considered valid for $R/h > 10$. In this case, $R/h = 0.0275 / 0.002 = 13.75$, which is greater than $10$, so the use of the derived formula is arithmetically consistent with the problem's premise.\n\nNow, we substitute these values into the hoop stress formula:\n$$\n\\sigma_{\\theta} = \\frac{P R}{h} = \\frac{(13332.2 \\text{ Pa}) \\times (0.0275 \\text{ m})}{0.002 \\text{ m}}\n$$\n$$\n\\sigma_{\\theta} = \\frac{366.6355 \\text{ Pa} \\cdot \\text{m}}{0.002 \\text{ m}} = 183317.75 \\text{ Pa}\n$$\n\nThe problem requires the final answer in megapascals (MPa), where $1$ MPa $= 10^6$ Pa.\n$$\n\\sigma_{\\theta} = 183317.75 \\text{ Pa} \\times \\frac{1 \\text{ MPa}}{10^6 \\text{ Pa}} = 0.18331775 \\text{ MPa}\n$$\n\nRounding the result to four significant figures as requested:\n$$\n\\sigma_{\\theta} \\approx 0.1833 \\text{ MPa}\n$$\n\n**Part 3: Discussion of Model Limitations**\n\nThe thin-wall assumption, while useful for a first-order approximation, has significant limitations when applied to the complex reality of a diseased Abdominal Aortic Aneurysm (AAA) wall.\n\n1.  **Heterogeneous Structure and Intraluminal Thrombus (ILT):** The model assumes a single, homogeneous material with uniform thickness. A real AAA is a heterogeneous structure. Crucially, a majority of large AAAs contain an Intraluminal Thrombus (ILT), a laminated, porous biomaterial composed of fibrin and blood cells that accumulates on the inner wall. The ILT has vastly different mechanical properties from the aortic wall itself. It is generally weaker and more compliant. By occupying a significant portion of the aneurysm lumen, the ILT alters the geometry and, more importantly, the stress distribution. It can act as a cushion, reducing the stress transmitted to the underlying vessel wall. Ignoring the ILT and modeling the structure as a simple thin wall leads to a misrepresentation of the mechanical environment, typically resulting in an overestimation of the peak wall stress if the same inner radius is used. Furthermore, the ILT itself can exert biomechanical and biochemical effects on the wall, influencing its degradation.\n\n2.  **Anisotropic and Non-linear Material Properties:** The derivation implicitly assumes the wall material is isotropic (has the same mechanical properties in all directions) and linearly elastic. The aortic wall is a biological composite, primarily made of elastin and collagen fibers arranged in specific orientations, which makes it highly anisotropic. It is significantly stiffer in the circumferential direction than in the longitudinal direction to withstand hoop stress. The stress-strain relationship is also highly non-linear; the wall becomes much stiffer at higher strains as collagen fibers are recruited. The simple thin-wall formula ($\\sigma_\\theta = PR/h$) does not account for this anisotropy or non-linearity, leading to inaccurate stress and strain predictions. AAA pathology further involves enzymatic degradation of elastin and collagen, which not only weakens the wall but also alters its anisotropic characteristics in a spatially non-uniform manner. This localized, heterogeneous degradation creates weak spots where stress concentrates, which a uniform model cannot capture. Accurate stress analysis requires advanced constitutive models (e.g., hyperelastic anisotropic models) and computational methods like Finite Element Analysis (FEA) on patient-specific geometries.", "answer": "$$\n\\boxed{0.1833}\n$$", "id": "5114552"}, {"introduction": "Once an aneurysm is excluded by a stent-graft, the long-term success of the repair depends on the device remaining securely in place. This practice problem delves into the core mechanics of device fixation, focusing on the frictional forces generated in the proximal sealing zone. By deriving the minimal required seal length from first principles, you will connect concepts like radial force, material friction, and hemodynamic loads to prevent the critical failure mode of graft migration [@problem_id:5114518].", "problem": "An endovascular aneurysm repair (EVAR) for an Abdominal Aortic Aneurysm (AAA) relies on a proximal seal between the stent-graft and the infrarenal aortic neck to resist axial dislodgement. Consider a cylindrical seal zone of length $L$ and circumference $C$ in which the stent-graft exerts a uniform radial contact pressure $p_{r}$ against the aortic wall. The interface exhibits Coulomb friction characterized by a friction coefficient $\\mu$, and the seal must resist a peak axial dislodging force $F$ under a design safety factor $S$.\n\nStarting from the definitions of Coulomb friction and the relation between contact pressure and normal force over a surface, derive from first principles an expression for the minimal seal length $L_{\\min}$ that ensures axial mechanical resistance under the safety factor criterion. Then, using the derived expression, compute $L_{\\min}$ for an infrarenal neck of diameter $D = 24 \\ \\mathrm{mm}$ with uniform radial contact pressure $p_{r} = 25 \\ \\mathrm{kPa}$, friction coefficient $\\mu = 0.25$, peak axial force $F = 4.0 \\ \\mathrm{N}$, and safety factor $S = 2.0$. Express the final length in millimeters and round your answer to three significant figures.", "solution": "The problem is valid. It presents a scientifically grounded, well-posed problem in biomechanics that can be solved using fundamental principles of mechanics. All necessary data are provided, and the objective is clearly defined.\n\nThe task is to first derive an expression for the minimal seal length, $L_{\\min}$, and then compute its value for the given parameters. The derivation proceeds from first principles.\n\nThe model is a cylindrical seal zone of length $L$ and diameter $D$. A uniform radial contact pressure $p_r$ is exerted by the stent-graft onto the aortic wall over this area. The total normal force $N$ acting on the interface is the product of the uniform pressure $p_r$ and the contact area $A$.\n\nThe contact area $A$ of the cylindrical surface is the product of its circumference $C$ and its length $L$. The circumference is given by $C = \\pi D$.\n$$A = C L = \\pi D L$$\nThe total normal force $N$ is therefore:\n$$N = p_r A = p_r (\\pi D L)$$\nAccording to the Coulomb friction model, the maximum static frictional force $F_{fric, max}$ that the interface can generate is proportional to the total normal force $N$. The constant of proportionality is the coefficient of static friction $\\mu$.\n$$F_{fric, max} = \\mu N$$\nSubstituting the expression for $N$, we obtain the maximal resistive force as a function of the seal length $L$:\n$$F_{fric, max} = \\mu (p_r \\pi D L)$$\nThe problem specifies a design safety factor $S$. This requires that the mechanical resistance provided by the friction must be at least $S$ times the peak axial dislodging force $F$. To find the minimal seal length, $L_{\\min}$, we establish an equality where the maximal frictional force is exactly equal to the required safe dislodging force.\n$$F_{fric, max} = S F$$\nBy substituting our expression for $F_{fric, max}$ with $L = L_{\\min}$, we have:\n$$\\mu p_r \\pi D L_{\\min} = S F$$\nSolving for the minimal seal length, $L_{\\min}$, we arrive at the required analytical expression:\n$$L_{\\min} = \\frac{S F}{\\mu p_r \\pi D}$$\nThis expression is derived from the first principles of contact pressure and Coulomb friction as requested.\n\nNext, we compute the numerical value of $L_{\\min}$ using the provided data. The given values are:\nDiameter, $D = 24 \\ \\mathrm{mm}$\nRadial contact pressure, $p_r = 25 \\ \\mathrm{kPa}$\nFriction coefficient, $\\mu = 0.25$\nPeak axial force, $F = 4.0 \\ \\mathrm{N}$\nSafety factor, $S = 2.0$\n\nTo ensure dimensional consistency, all values must be converted to a consistent system of units, such as the SI system (meters, Newtons, Pascals).\n$D = 24 \\ \\mathrm{mm} = 24 \\times 10^{-3} \\ \\mathrm{m}$\n$p_r = 25 \\ \\mathrm{kPa} = 25 \\times 10^3 \\ \\mathrm{Pa} = 25 \\times 10^3 \\ \\mathrm{N/m^2}$\n$F = 4.0 \\ \\mathrm{N}$\n$\\mu = 0.25$\n$S = 2.0$\n\nSubstituting these values into the derived expression for $L_{\\min}$:\n$$L_{\\min} = \\frac{(2.0) (4.0 \\ \\mathrm{N})}{(0.25) (25 \\times 10^3 \\ \\mathrm{N/m^2}) \\pi (24 \\times 10^{-3} \\ \\mathrm{m})}$$\nWe can simplify the expression by calculating the product in the denominator:\n$$L_{\\min} = \\frac{8.0}{(0.25 \\times 25 \\times 24) \\times \\pi \\times 10^3 \\times 10^{-3}} \\ \\mathrm{m}$$\n$$L_{\\min} = \\frac{8.0}{150 \\pi} \\ \\mathrm{m}$$\n$$L_{\\min} = \\frac{4}{75 \\pi} \\ \\mathrm{m}$$\nNow, we calculate the numerical value:\n$$L_{\\min} \\approx \\frac{4}{75 \\times 3.14159...} \\ \\mathrm{m} \\approx \\frac{4}{235.619...} \\ \\mathrm{m}$$\n$$L_{\\min} \\approx 0.0169765... \\ \\mathrm{m}$$\nThe problem asks for the final length to be expressed in millimeters. To convert from meters to millimeters, we multiply by $10^3$:\n$$L_{\\min} \\approx 0.0169765... \\times 1000 \\ \\mathrm{mm} = 16.9765... \\ \\mathrm{mm}$$\nFinally, rounding the answer to three significant figures as required:\n$$L_{\\min} \\approx 17.0 \\ \\mathrm{mm}$$", "answer": "$$\\boxed{17.0}$$", "id": "5114518"}, {"introduction": "Deterministic models provide essential insights, but real-world biological systems are fraught with variability and uncertainty. This advanced exercise challenges you to move beyond single-value calculations by building a Monte Carlo simulation to assess migration risk under these conditions. You will learn to propagate uncertainty in key biomechanical parameters to generate a probabilistic estimate of device failure, a crucial skill for modern medical device analysis and reliability engineering [@problem_id:5114511].", "problem": "You are tasked with constructing a quantitative Monte Carlo model, grounded in first principles, to evaluate how uncertainty in proximal neck friction coefficient and neck compliance affects the predicted risk of stent-graft migration in Endovascular Aneurysm Repair (EVAR). The goal is to propagate uncertainty from specified prior distributions of these parameters to a risk estimate and to quantify sensitivity.\n\nUse the following fundamental base and core definitions without introducing shortcut formulas not derivable from these bases:\n\n- Coulomb friction law: the frictional resistance force is given by $F_{\\mathrm{fric}} = \\mu \\, N$, where $\\mu$ is the friction coefficient and $N$ is the normal force.\n- Pressure-to-force relation: a pressure $P$ acting over an area $A$ produces a force $F = P \\, A$.\n- Proximal neck compliance definition: let the fractional diameter change per unit pressure be $C_n$ (units $\\mathrm{mmHg}^{-1}$), so for a pressure increment $\\Delta P$ (in $\\mathrm{mmHg}$), the fractional diameter change is $\\Delta D / D_0 = C_n \\, \\Delta P$, where $D_0$ is the baseline diameter.\n- Oversizing definition: let $s$ be the initial fractional oversizing (dimensionless) of the stent-graft relative to the baseline neck diameter. Compliance reduces effective oversizing as pressure increases.\n- All forces must be expressed in Newtons ($\\mathrm{N}$). Convert pressure from millimeters of mercury to Pascals using $1 \\ \\mathrm{mmHg} = 133.322 \\ \\mathrm{Pa}$.\n- Use the following approximations for modeling axial load and normal force:\n  1. The axial load due to pulsatile pressure difference across the graft is $F_{\\mathrm{axial}} = \\gamma \\, \\Delta P_{\\mathrm{Pa}} \\, A$, where $\\gamma$ is a shape factor (dimensionless), $\\Delta P_{\\mathrm{Pa}}$ is the pressure difference in Pascals after conversion, and $A = \\pi D_0^2 / 4$ is the cross-sectional area.\n  2. The normal force arises from stent radial support; approximate the radial support per unit length as $k_{\\mathrm{stent}} \\, s_{\\mathrm{eff}}$, where $k_{\\mathrm{stent}}$ has units $\\mathrm{N/m}$ and $s_{\\mathrm{eff}}$ is the effective oversizing fraction after compliance. The total normal force over contact length $L$ is $N = k_{\\mathrm{stent}} \\, s_{\\mathrm{eff}} \\, L$.\n  3. Effective oversizing is reduced by compliance under pressure: $s_{\\mathrm{eff}} = \\max\\{0, s - C_n \\, \\Delta P_{\\mathrm{mmHg}}\\}$, where $\\Delta P_{\\mathrm{mmHg}}$ is the pressure difference expressed in $\\mathrm{mmHg}$.\n\nDefine migration as occurring when $F_{\\mathrm{axial}}  F_{\\mathrm{fric}}$. For a given pair $(\\mu, C_n)$, assign the migration indicator $I(\\mu, C_n) = 1$ if migration occurs and $0$ otherwise.\n\nYou must implement a Monte Carlo simulation that draws $(\\mu, C_n)$ from specified prior distributions and estimates:\n- The migration probability $\\hat{p} = \\mathbb{E}[I(\\mu, C_n)]$ as the sample mean of $I$.\n- The standard error of $\\hat{p}$ computed as $\\sqrt{\\hat{p}(1-\\hat{p})/n}$, where $n$ is the number of Monte Carlo samples.\n- The global sensitivity of the migration indicator to each parameter using the Spearman rank correlation between $I$ and each parameter ($\\mu$ and $C_n$), reported as two separate correlation coefficients $S_\\mu$ and $S_{C_n}$.\n\nAll variables and constants must be handled with explicit units:\n- Use $D_0$ in meters ($\\mathrm{m}$), $L$ in meters ($\\mathrm{m}$), $k_{\\mathrm{stent}}$ in Newtons per meter ($\\mathrm{N/m}$), $\\Delta P_{\\mathrm{mmHg}}$ in millimeters of mercury ($\\mathrm{mmHg}$), $\\Delta P_{\\mathrm{Pa}}$ in Pascals ($\\mathrm{Pa}$), and $\\gamma$ dimensionless.\n\nPriors for the uncertain parameters:\n- Friction coefficient $\\mu$ follows a truncated normal distribution with mean $\\mu_{\\mathrm{mean}}$ and standard deviation $\\sigma_\\mu$, truncated to $[\\mu_{\\min}, \\mu_{\\max}]$.\n- Neck compliance $C_n$ follows a lognormal distribution with parameters $(\\mu_{\\ln}, \\sigma_{\\ln})$, where sampling is performed via $C_n = \\exp(Z)$ for $Z \\sim \\mathcal{N}(\\mu_{\\ln}, \\sigma_{\\ln}^2)$, giving $C_n$ in $\\mathrm{mmHg}^{-1}$.\n\nFixed deterministic parameters shared across tests unless specified otherwise:\n- Baseline neck diameter: $D_0 = 0.024 \\ \\mathrm{m}$.\n- Contact length: $L = 0.03 \\ \\mathrm{m}$.\n- Stent radial support stiffness per unit length: $k_{\\mathrm{stent}} = 500 \\ \\mathrm{N/m}$.\n- Shape factor: $\\gamma = 0.6$.\n- Pressure difference: $\\Delta P_{\\mathrm{mmHg}} = 40 \\ \\mathrm{mmHg}$ and $\\Delta P_{\\mathrm{Pa}} = 40 \\times 133.322 \\ \\mathrm{Pa}$.\n- Initial oversizing fraction $s$ as specified per test case.\n\nDesign a test suite that covers different regimes of uncertainty and operating conditions. Each test case is a tuple specifying $(n, \\mu_{\\mathrm{mean}}, \\sigma_\\mu, \\mu_{\\min}, \\mu_{\\max}, \\mu_{\\ln}, \\sigma_{\\ln}, s)$. Use the following test suite:\n\n1. General case (large sample, moderate priors, typical oversizing):\n   - $(n, \\mu_{\\mathrm{mean}}, \\sigma_\\mu, \\mu_{\\min}, \\mu_{\\max}, \\mu_{\\ln}, \\sigma_{\\ln}, s) = (100000, 0.35, 0.10, 0.10, 0.80, \\ln(5 \\times 10^{-4}), 0.5, 0.10)$.\n2. Boundary estimation case (small sample, low oversizing):\n   - $(n, \\mu_{\\mathrm{mean}}, \\sigma_\\mu, \\mu_{\\min}, \\mu_{\\max}, \\mu_{\\ln}, \\sigma_{\\ln}, s) = (2000, 0.35, 0.10, 0.10, 0.80, \\ln(5 \\times 10^{-4}), 0.5, 0.05)$.\n3. High compliance uncertainty case (wider compliance prior):\n   - $(n, \\mu_{\\mathrm{mean}}, \\sigma_\\mu, \\mu_{\\min}, \\mu_{\\max}, \\mu_{\\ln}, \\sigma_{\\ln}, s) = (50000, 0.35, 0.10, 0.10, 0.80, \\ln(5 \\times 10^{-4}), 0.9, 0.10)$.\n4. High friction case (higher friction mean and narrower spread):\n   - $(n, \\mu_{\\mathrm{mean}}, \\sigma_\\mu, \\mu_{\\min}, \\mu_{\\max}, \\mu_{\\ln}, \\sigma_{\\ln}, s) = (50000, 0.50, 0.05, 0.10, 0.80, \\ln(5 \\times 10^{-4}), 0.5, 0.08)$.\n\nFor each test case, compute and return a list of four values: $[\\hat{p}, \\mathrm{SE}(\\hat{p}), S_\\mu, S_{C_n}]$, where $\\hat{p}$ and $\\mathrm{SE}(\\hat{p})$ are decimals, and $S_\\mu$, $S_{C_n}$ are correlation coefficients (decimals). Round all four values for each test case to six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list of the per-test-case lists, enclosed in square brackets. For example, the output should look like: \"[[p1,se1,s_mu1,s_c1],[p2,se2,s_mu2,s_c2],...]\" with numeric values rounded as specified.", "solution": "The problem is valid. It presents a well-posed, scientifically grounded task to construct a quantitative Monte Carlo model for assessing stent-graft migration risk in endovascular aneurysm repair. All parameters, definitions, and physical principles are clearly and consistently specified. The model is a simplified but mechanistically sound representation of a real-world biomedical engineering problem. We proceed with the solution.\n\nThe core of the problem is to determine the probability of migration, which occurs when the axial displacement force, `$F_{\\mathrm{axial}}$`, exceeds the frictional resistance force, `$F_{\\mathrm{fric}}$`. We will first derive the expressions for these forces based on the provided principles and then outline the Monte Carlo simulation procedure.\n\n**1. Derivation of Forces**\n\n**Axial Force ($F_{\\mathrm{axial}}$)**\nThe axial force is the primary driver of migration. It is approximated as a function of the pulsatile pressure difference `$\\Delta P$`. According to the problem statement:\n$$F_{\\mathrm{axial}} = \\gamma \\, \\Delta P_{\\mathrm{Pa}} \\, A$$\nwhere `$\\gamma$` is a dimensionless shape factor, `$\\Delta P_{\\mathrm{Pa}}$` is the pressure difference in Pascals, and `$A$` is the cross-sectional area of the aorta at the proximal neck.\n\nThe area `$A$` is calculated from the baseline neck diameter `$D_0$`:\n$$A = \\frac{\\pi D_0^2}{4}$$\nThe pressure difference is given in millimeters of mercury (`$\\mathrm{mmHg}$`) and must be converted to Pascals (`$\\mathrm{Pa}$`).\n$$\\Delta P_{\\mathrm{Pa}} = \\Delta P_{\\mathrm{mmHg}} \\times 133.322 \\ \\mathrm{Pa/mmHg}$$\nAll parameters determining `$F_{\\mathrm{axial}}$` are fixed constants:\n- `$\\gamma = 0.6$`\n- `$\\Delta P_{\\mathrm{mmHg}} = 40 \\ \\mathrm{mmHg}$`\n- `$D_0 = 0.024 \\ \\mathrm{m}$`\n\nWe can pre-calculate the constant value of `$F_{\\mathrm{axial}}$`:\nFirst, the pressure in Pascals:\n$$\\Delta P_{\\mathrm{Pa}} = 40 \\ \\mathrm{mmHg} \\times 133.322 \\ \\mathrm{Pa/mmHg} = 5332.88 \\ \\mathrm{Pa}$$\nNext, the cross-sectional area:\n$$A = \\frac{\\pi (0.024 \\ \\mathrm{m})^2}{4} \\approx 4.52389 \\times 10^{-4} \\ \\mathrm{m}^2$$\nFinally, the axial force:\n$$F_{\\mathrm{axial}} = 0.6 \\times 5332.88 \\ \\mathrm{Pa} \\times (4.52389 \\times 10^{-4} \\ \\mathrm{m}^2) \\approx 1.4463 \\ \\mathrm{N}$$\nThis axial force is a constant threshold against which the stochastic frictional force will be compared in every trial of the simulation.\n\n**Frictional Resistance Force ($F_{\\mathrm{fric}}$)**\nThe frictional force opposes the axial force and is determined by the Coulomb friction law:\n$$F_{\\mathrm{fric}} = \\mu \\, N$$\nwhere `$\\mu$` is the coefficient of friction (an uncertain parameter) and `$N$` is the normal force exerted by the stent-graft on the aortic wall.\n\nThe normal force `$N$` is generated by the radial expansion of the stent and is given by:\n$$N = k_{\\mathrm{stent}} \\, s_{\\mathrm{eff}} \\, L$$\nHere, `$k_{\\mathrm{stent}} = 500 \\ \\mathrm{N/m}$` is the stent's radial support stiffness per unit length, `$L = 0.03 \\ \\mathrm{m}$` is the contact length, and `$s_{\\mathrm{eff}}$` is the effective fractional oversizing.\n\nThe effective oversizing `$s_{\\mathrm{eff}}$` accounts for the reduction in oversizing due to the aortic neck's compliance under pressure. It is defined as:\n$$s_{\\mathrm{eff}} = \\max\\{0, s - C_n \\, \\Delta P_{\\mathrm{mmHg}}\\}$$\nIn this expression, `$s$` is the initial fractional oversizing (a parameter for each test case), `$\\Delta P_{\\mathrm{mmHg}} = 40 \\ \\mathrm{mmHg}$` is the constant pressure difference, and `$C_n$` is the neck compliance (the second uncertain parameter).\n\nCombining these equations, the full expression for the frictional force is:\n$$F_{\\mathrm{fric}} = \\mu \\cdot (k_{\\mathrm{stent}} \\cdot L \\cdot \\max\\{0, s - C_n \\cdot \\Delta P_{\\mathrm{mmHg}}\\})$$\nThis expression explicitly links the two uncertain parameters, `$\\mu$` and `$C_n$`, to the resulting frictional force.\n\n**2. Monte Carlo Simulation and Analysis**\n\nThe simulation aims to estimate the probability of migration and the sensitivity of this outcome to the uncertain parameters `$\\mu$` and `$C_n$`.\n\n**Migration Criterion**\nMigration is defined to occur if `$F_{\\mathrm{axial}}  F_{\\mathrm{fric}}$`. We define a binary migration indicator `$I(\\mu, C_n)$` for each random draw:\n$$\nI(\\mu, C_n) =\n\\begin{cases}\n1  \\text{if } F_{\\mathrm{axial}}  F_{\\mathrm{fric}}(\\mu, C_n) \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\n**Simulation Algorithm**\nFor each test case, specified by the tuple `$(n, \\mu_{\\mathrm{mean}}, \\sigma_\\mu, \\mu_{\\min}, \\mu_{\\max}, \\mu_{\\ln}, \\sigma_{\\ln}, s)$`, we perform the following steps:\n1.  **Generate Samples**: Draw `$n$` random samples for the uncertain parameters:\n    -   `$\\mu_i \\text{ for } i=1, \\dots, n$`: from a normal distribution with mean `$\\mu_{\\mathrm{mean}}$` and standard deviation `$\\sigma_\\mu$`, truncated to the interval `$[\\mu_{\\min}, \\mu_{\\max}]$`.\n    -   `$C_{n,i} \\text{ for } i=1, \\dots, n$`: from a lognormal distribution by generating `$Z_i \\sim \\mathcal{N}(\\mu_{\\ln}, \\sigma_{\\ln}^2)$` and setting `$C_{n,i} = \\exp(Z_i)$`.\n2.  **Evaluate Indicator**: For each sample pair `$(\\mu_i, C_{n,i})$`, calculate `$F_{\\mathrm{fric},i}$` using the derived formula and the test case parameter `$s$`. Then, evaluate the indicator `$I_i = I(\\mu_i, C_{n,i})$` by comparing `$F_{\\mathrm{fric},i}$` to the constant `$F_{\\mathrm{axial}}$`.\n3.  **Estimate Migration Probability**: The probability of migration, `$\\hat{p}$`, is estimated as the sample mean of the indicators:\n    $$\\hat{p} = \\frac{1}{n} \\sum_{i=1}^n I_i$$\n4.  **Estimate Standard Error**: The standard error of the probability estimate is calculated as:\n    $$\\mathrm{SE}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$$\n5.  **Estimate Sensitivity**: The global sensitivity of the migration outcome to each parameter is quantified using the Spearman rank correlation coefficient. We compute:\n    -   `$S_\\mu = \\rho(\\mathrm{rank}(\\boldsymbol{\\mu}), \\mathrm{rank}(\\mathbf{I}))$`, where `$\\boldsymbol{\\mu}$` and `$\\mathbf{I}$` are the vectors of `$n$` samples of the friction coefficient and the indicator, respectively.\n    -   `$S_{C_n} = \\rho(\\mathrm{rank}(\\mathbf{C_n}), \\mathrm{rank}(\\mathbf{I}))$`, where `$\\mathbf{C_n}$` is the vector of `$n$` samples of the neck compliance.\n\nA negative value for `$S_\\mu$` is expected, as higher friction `$\\mu$` increases `$F_{\\mathrm{fric}}$` and thus makes migration less likely. A positive value for `$S_{C_n}}$` is expected, as higher compliance `$C_n$` reduces `$s_{\\mathrm{eff}}$`, which reduces `$F_{\\mathrm{fric}}$` and makes migration more likely.\n\nThis procedure is repeated for each of the four test cases provided, and the four resulting values `$[\\hat{p}, \\mathrm{SE}(\\hat{p}), S_\\mu, S_{C_n}]$` are collected and formatted as the final output. The implementation will use vectorized operations for efficiency.", "answer": "```python\nimport numpy as np\nfrom scipy.stats import truncnorm, spearmanr\n\ndef solve():\n    \"\"\"\n    Constructs and runs a Monte Carlo simulation to evaluate stent-graft migration risk.\n    \"\"\"\n    # Test cases: (n, mu_mean, sigma_mu, mu_min, mu_max, mu_ln, sigma_ln, s)\n    test_cases = [\n        (100000, 0.35, 0.10, 0.10, 0.80, np.log(5e-4), 0.5, 0.10),\n        (2000, 0.35, 0.10, 0.10, 0.80, np.log(5e-4), 0.5, 0.05),\n        (50000, 0.35, 0.10, 0.10, 0.80, np.log(5e-4), 0.9, 0.10),\n        (50000, 0.50, 0.05, 0.10, 0.80, np.log(5e-4), 0.5, 0.08),\n    ]\n\n    # Fixed deterministic parameters\n    D0 = 0.024  # m, Baseline neck diameter\n    L = 0.030   # m, Contact length\n    k_stent = 500.0  # N/m, Stent radial support stiffness per unit length\n    gamma = 0.6  # dimensionless, Shape factor\n    Delta_P_mmHg = 40.0  # mmHg, Pressure difference\n    mmHg_to_Pa = 133.322 # Pa/mmHg\n\n    # Pre-calculate constant axial force\n    Delta_P_Pa = Delta_P_mmHg * mmHg_to_Pa\n    A = np.pi * D0**2 / 4.0\n    F_axial = gamma * Delta_P_Pa * A\n\n    np.random.seed(42) # for reproducibility of results\n    \n    all_results = []\n\n    for case in test_cases:\n        n, mu_mean, sigma_mu, mu_min, mu_max, mu_ln, sigma_ln, s = case\n\n        # 1. Generate random samples for uncertain parameters\n        \n        # Friction coefficient mu from a truncated normal distribution\n        a, b = (mu_min - mu_mean) / sigma_mu, (mu_max - mu_mean) / sigma_mu\n        mu_dist = truncnorm(a, b, loc=mu_mean, scale=sigma_mu)\n        mu_samples = mu_dist.rvs(n)\n\n        # Neck compliance C_n from a lognormal distribution\n        # C_n = exp(Z) where Z ~ N(mu_ln, sigma_ln^2)\n        Z_samples = np.random.normal(loc=mu_ln, scale=sigma_ln, size=n)\n        Cn_samples = np.exp(Z_samples)\n\n        # 2. Calculate forces and migration indicator for each sample\n        \n        # Effective oversizing, s_eff\n        s_eff = np.maximum(0, s - Cn_samples * Delta_P_mmHg)\n        \n        # Normal force, N\n        N = k_stent * s_eff * L\n        \n        # Frictional force, F_fric\n        F_fric = mu_samples * N\n        \n        # Migration indicator, I\n        I = (F_axial  F_fric).astype(int)\n\n        # 3. Calculate output statistics\n        \n        # Migration probability\n        p_hat = np.mean(I)\n        \n        # Standard error of the probability estimate\n        # Handle case where n=0 to avoid division by zero, though not expected here.\n        if n  0:\n            se_p = np.sqrt(p_hat * (1 - p_hat) / n)\n        else:\n            se_p = 0.0\n\n        # Spearman rank correlations for sensitivity\n        # Handle the case where the indicator array has zero variance (p_hat=0 or 1)\n        if p_hat == 0.0 or p_hat == 1.0:\n            S_mu = 0.0\n            S_Cn = 0.0\n        else:\n            S_mu_res = spearmanr(mu_samples, I)\n            S_Cn_res = spearmanr(Cn_samples, I)\n            # spearmanr returns (correlation, p-value), we only need correlation\n            S_mu = S_mu_res[0] if not np.isnan(S_mu_res[0]) else 0.0\n            S_Cn = S_Cn_res[0] if not np.isnan(S_Cn_res[0]) else 0.0\n\n        # 4. Format and store results\n        case_results = [\n            round(p_hat, 6),\n            round(se_p, 6),\n            round(S_mu, 6),\n            round(S_Cn, 6),\n        ]\n        all_results.append(case_results)\n\n    # Print results in the specified format\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "5114511"}]}