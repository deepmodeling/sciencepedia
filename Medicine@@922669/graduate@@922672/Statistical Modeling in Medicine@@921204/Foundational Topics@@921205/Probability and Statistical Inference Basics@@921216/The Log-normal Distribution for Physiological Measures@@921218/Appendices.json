{"hands_on_practices": [{"introduction": "Understanding a statistical distribution goes beyond its formula; it involves being able to derive its fundamental properties. This first practice challenges you to connect the theoretical underpinnings of the log-normal distribution to a vital clinical application: establishing reference intervals. By deriving the formula for its percentiles from first principles, you will solidify your understanding of how the parameters on the logarithmic scale, $\\mu$ and $\\sigma^2$, translate into meaningful values on the original scale of measurement [@problem_id:4990452].", "problem": "A clinical laboratory is establishing a reference interval for fasting plasma triglyceride concentration, denoted by the random variable $X$ (measured in $\\mathrm{mg/dL}$), in an ostensibly healthy adult population. Empirical evidence suggests that $X$ is strictly positive and right-skewed, and that the natural logarithm of $X$ is approximately Gaussian. Accordingly, model $X$ as log-normal with parameters $(\\mu, \\sigma^2)$, meaning that $Y=\\ln X$ follows a normal distribution with mean $\\mu$ and variance $\\sigma^2$. In this setting, reference limits are specified by population percentiles.\n\nUsing only the definitions of the cumulative distribution function and quantiles, the fact that $\\ln(\\cdot)$ is a strictly increasing (monotone) function on $(0,\\infty)$, and the distributional assumption for $Y$, derive from first principles a general expression for the $p$th percentile $q_{p}$ of $X$ in terms of $p$, $\\mu$, and $\\sigma$. Then, for $p=0.95$, compute the corresponding reference limit when $(\\mu, \\sigma^2) = (\\ln 100, 0.25)$. Express your final value in $\\mathrm{mg/dL}$ and round your answer to four significant figures.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n-   The random variable $X$ represents fasting plasma triglyceride concentration.\n-   $X$ is strictly positive, $X > 0$.\n-   $X$ is modeled as a log-normal distribution with parameters $(\\mu, \\sigma^2)$.\n-   $Y = \\ln X$ follows a normal distribution with mean $\\mu$ and variance $\\sigma^2$, denoted $Y \\sim N(\\mu, \\sigma^2)$.\n-   Reference limits are defined as population percentiles.\n-   The task is to derive the $p$-th percentile of $X$, denoted $q_p$, from first principles.\n-   The derivation must use:\n    1.  The definition of the cumulative distribution function (CDF).\n    2.  The definition of quantiles (percentiles).\n    3.  The property that $\\ln(\\cdot)$ is a strictly increasing function on $(0, \\infty)$.\n    4.  The distributional assumption for $Y$.\n-   The expression for $q_p$ must be in terms of $p$, $\\mu$, and $\\sigma$.\n-   A specific calculation is required for $p=0.95$ with parameters $(\\mu, \\sigma^2) = (\\ln 100, 0.25)$.\n-   The final numerical answer must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is sound. Modeling right-skewed, positive-valued physiological data (like triglyceride levels) with a log-normal distribution is a standard and well-accepted method in biostatistics and clinical medicine.\n-   **Well-Posed:** The problem is well-posed. It provides all necessary information and definitions to derive a unique analytical expression and compute a specific numerical value.\n-   **Objective:** The problem is stated using precise, objective, and formal mathematical and statistical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard derivation and application problem in mathematical statistics. A solution will be provided.\n\n**Derivation of the $p$-th percentile of $X$**\n\nLet $X$ be a random variable following a log-normal distribution with parameters $(\\mu, \\sigma^2)$. This means that the random variable $Y = \\ln(X)$ follows a normal distribution with mean $\\mu$ and variance $\\sigma^2$, i.e., $Y \\sim N(\\mu, \\sigma^2)$. We wish to find the $p$-th percentile of $X$, which we denote as $q_p$.\n\nBy the definition of a percentile, $q_p$ is the value such that the probability of $X$ being less than or equal to $q_p$ is $p$. In terms of the cumulative distribution function (CDF) of $X$, denoted $F_X(x)$, this is expressed as:\n$$F_X(q_p) = P(X \\le q_p) = p$$\n\nSince the natural logarithm function, $\\ln(\\cdot)$, is strictly increasing on its domain $(0, \\infty)$, the inequality $X \\le q_p$ is equivalent to the inequality $\\ln(X) \\le \\ln(q_p)$. Therefore, we can write the probability as:\n$$P(X \\le q_p) = P(\\ln(X) \\le \\ln(q_p))$$\n\nSubstituting $Y = \\ln(X)$, we get:\n$$P(Y \\le \\ln(q_p)) = p$$\n\nThis expression is the CDF of the random variable $Y$, denoted $F_Y(y)$, evaluated at $y = \\ln(q_p)$:\n$$F_Y(\\ln(q_p)) = p$$\n\nTo evaluate $F_Y$, we standardize the normal variable $Y$. Let $Z$ be a standard normal random variable, $Z \\sim N(0, 1)$, defined as $Z = \\frac{Y - \\mu}{\\sigma}$. The CDF of $Z$ is denoted by $\\Phi(z) = P(Z \\le z)$.\n\nWe can express the CDF of $Y$ in terms of $\\Phi$:\n$$F_Y(y) = P(Y \\le y) = P\\left(\\frac{Y - \\mu}{\\sigma} \\le \\frac{y - \\mu}{\\sigma}\\right) = P\\left(Z \\le \\frac{y - \\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{y - \\mu}{\\sigma}\\right)$$\n\nSubstituting $y = \\ln(q_p)$ into this relationship, we have:\n$$F_Y(\\ln(q_p)) = \\Phi\\left(\\frac{\\ln(q_p) - \\mu}{\\sigma}\\right)$$\n\nCombining our equations, we arrive at:\n$$p = \\Phi\\left(\\frac{\\ln(q_p) - \\mu}{\\sigma}\\right)$$\n\nTo solve for $q_p$, we first apply the inverse CDF of the standard normal distribution, which is the quantile function $\\Phi^{-1}(p)$, to both sides. Let $z_p = \\Phi^{-1}(p)$ be the $p$-th quantile of the standard normal distribution.\n$$\\Phi^{-1}(p) = \\frac{\\ln(q_p) - \\mu}{\\sigma}$$\n$$z_p = \\frac{\\ln(q_p) - \\mu}{\\sigma}$$\n\nNow, we solve for $\\ln(q_p)$:\n$$z_p \\sigma = \\ln(q_p) - \\mu$$\n$$\\ln(q_p) = \\mu + z_p \\sigma$$\n\nFinally, we exponentiate both sides to solve for $q_p$:\n$$q_p = \\exp(\\mu + z_p \\sigma)$$\n\nReplacing $z_p$ with its definition, $\\Phi^{-1}(p)$, we obtain the general expression for the $p$-th percentile of a log-normal distribution:\n$$q_p = \\exp(\\mu + \\sigma \\Phi^{-1}(p))$$\n\n**Calculation for the specified case**\n\nWe are asked to compute the $95$-th percentile, so $p=0.95$. The given parameters are $\\mu = \\ln 100$ and $\\sigma^2 = 0.25$.\nFirst, we find the standard deviation $\\sigma$:\n$$\\sigma = \\sqrt{\\sigma^2} = \\sqrt{0.25} = 0.5$$\n\nNext, we need the value of $\\Phi^{-1}(0.95)$, which is the $z$-score that corresponds to a cumulative probability of $0.95$. From standard normal tables or statistical software, this value is:\n$$z_{0.95} = \\Phi^{-1}(0.95) \\approx 1.64485$$\n\nNow, we substitute the values of $\\mu$, $\\sigma$, and $z_{0.95}$ into our derived formula for $q_p$:\n$$q_{0.95} = \\exp(\\ln 100 + 0.5 \\times \\Phi^{-1}(0.95))$$\n$$q_{0.95} \\approx \\exp(\\ln 100 + 0.5 \\times 1.64485)$$\n\nWe can simplify the expression using properties of exponents:\n$$q_{0.95} = \\exp(\\ln 100) \\times \\exp(0.5 \\times 1.64485)$$\n$$q_{0.95} = 100 \\times \\exp(0.822425)$$\n\nNow, we compute the numerical value:\n$$\\exp(0.822425) \\approx 2.27596$$\n$$q_{0.95} \\approx 100 \\times 2.27596 = 227.596$$\n\nThe problem requires rounding the final answer to four significant figures. The first four significant figures are $2$, $2$, $7$, and $5$. The fifth digit is $9$, so we round up the fourth digit.\n$$q_{0.95} \\approx 227.6$$\nThe unit is $\\mathrm{mg/dL}$.", "answer": "$$\n\\boxed{227.6}\n$$", "id": "4990452"}, {"introduction": "Moving from describing a population to comparing groups, this practice explores the log-normal distribution's role in regression modeling. When analyzing right-skewed outcomes like biomarker concentrations, log-linear models are invaluable, but interpreting their coefficients requires care. This exercise will guide you through the essential skill of converting a model's output—an estimated coefficient and its standard error—into a clinically intuitive fold-change and its corresponding confidence interval [@problem_id:4990433].", "problem": "Consider a randomized clinical study of an antihypertensive therapy where the urinary albumin-to-creatinine ratio (UACR) is measured in $n$ patients before randomization and at a fixed follow-up time point. Empirical evidence and physiological considerations support that strictly positive concentration-type measures such as UACR are right-skewed and well-modeled by a log-normal distribution: if $Y$ denotes UACR, then $\\ln(Y)$ is modeled as Gaussian. A log-linear regression model is fitted for the follow-up UACR (adjusted for baseline UACR and age) on the natural logarithmic scale,\n$$\n\\ln(Y_{i}) = \\alpha + \\beta T_{i} + \\gamma \\ln(Y_{i,\\text{baseline}}) + \\delta \\ln(\\text{Age}_{i}) + \\varepsilon_{i},\n$$\nwhere $T_{i} \\in \\{0,1\\}$ is the treatment indicator, $\\varepsilon_{i}$ are independently and identically distributed with $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$, and $\\alpha$, $\\beta$, $\\gamma$, and $\\delta$ are regression coefficients. In this model, the parameter $\\beta$ represents the additive effect on the mean of $\\ln(Y)$ due to treatment, and the fold-change in the geometric mean of $Y$ comparing treatment versus control is $\\exp(\\beta)$.\n\nSuppose the maximum likelihood estimator (MLE) $\\hat{\\beta}$ and its estimated standard error $\\operatorname{SE}(\\hat{\\beta})$ from the fitted model are $\\hat{\\beta} = 0.300$ and $\\operatorname{SE}(\\hat{\\beta}) = 0.120$. Assume standard regularity conditions ensuring that the MLE is approximately normal for large samples. Let $\\alpha = 0.05$. Using only foundational definitions and well-tested facts about the log-normal model, the normal approximation for MLEs, and monotone transformations, compute the $100(1-\\alpha)\\%$ confidence interval for the fold-change $\\exp(\\beta)$.\n\nExpress the final confidence interval endpoints as dimensionless decimal numbers and round your answer to four significant figures. Report the two endpoints as your final answer.", "solution": "The user has provided a problem in statistical inference which, upon thorough review, is deemed valid. The problem is scientifically grounded in standard biostatistical modeling, is well-posed with a unique and stable solution, and is expressed in objective, formal language. While there is a minor notational ambiguity in the use of the symbol $\\alpha$ for both a model parameter and a significance level, the context readily disambiguates its meaning, with $\\alpha=0.05$ clearly designating the significance level for the confidence interval. The problem is self-contained and free of contradictions. I will now proceed with a complete solution.\n\nThe objective is to compute a $100(1-\\alpha)\\%$ confidence interval for the fold-change parameter, $\\exp(\\beta)$, based on estimates from a log-linear regression model.\n\nThe provided information consists of:\n1.  The maximum likelihood estimate (MLE) of the treatment effect coefficient, $\\hat{\\beta} = 0.300$.\n2.  The estimated standard error of this estimator, $\\operatorname{SE}(\\hat{\\beta}) = 0.120$.\n3.  The significance level for the confidence interval, $\\alpha = 0.05$, which corresponds to a $100(1-0.05)\\% = 95\\%$ confidence level.\n4.  The assumption that, for a large sample size $n$, the sampling distribution of the MLE $\\hat{\\beta}$ is approximately normal.\n\nThe solution proceeds in two main steps: first, we construct a confidence interval for the parameter $\\beta$ on the log scale; second, we transform this interval to obtain the confidence interval for the fold-change $\\exp(\\beta)$.\n\nStep 1: Construct the $95\\%$ confidence interval for $\\beta$.\n\nThe problem states that under standard regularity conditions, the MLE $\\hat{\\beta}$ is approximately normally distributed. Specifically, the distribution of $\\hat{\\beta}$ can be approximated as:\n$$ \\hat{\\beta} \\sim \\mathcal{N}\\left(\\beta, \\left[\\operatorname{SE}(\\hat{\\beta})\\right]^2\\right) $$\nFrom this, we can construct the standardized quantity $Z$:\n$$ Z = \\frac{\\hat{\\beta} - \\beta}{\\operatorname{SE}(\\hat{\\beta})} \\sim \\mathcal{N}(0, 1) $$\nA $100(1-\\alpha)\\%$ confidence interval for $\\beta$ is an interval $[\\beta_L, \\beta_U]$ such that $P(\\beta_L \\le \\beta \\le \\beta_U) = 1-\\alpha$. This can be constructed from the pivotal quantity $Z$. We find the critical value $z_{1-\\alpha/2}$ from the standard normal distribution such that $P(-z_{1-\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1-\\alpha$.\nFor a significance level of $\\alpha = 0.05$, we require the quantile $z_{1-0.05/2} = z_{0.975}$. This is a standard, well-established value:\n$$ z_{0.975} \\approx 1.96 $$\nUsing this critical value, the $95\\%$ confidence interval for $\\beta$ is given by the formula:\n$$ \\left[ \\hat{\\beta} - z_{1-\\alpha/2} \\operatorname{SE}(\\hat{\\beta}), \\; \\hat{\\beta} + z_{1-\\alpha/2} \\operatorname{SE}(\\hat{\\beta}) \\right] $$\nSubstituting the given numerical values:\n$$ \\left[ 0.300 - 1.96 \\times 0.120, \\; 0.300 + 1.96 \\times 0.120 \\right] $$\nFirst, we calculate the margin of error:\n$$ \\text{Margin of Error} = 1.96 \\times 0.120 = 0.2352 $$\nNow, we compute the lower and upper bounds for the confidence interval of $\\beta$:\n$$ \\beta_L = 0.300 - 0.2352 = 0.0648 $$\n$$ \\beta_U = 0.300 + 0.2352 = 0.5352 $$\nThus, the $95\\%$ confidence interval for $\\beta$ is $[0.0648, 0.5352]$.\n\nStep 2: Transform the confidence interval to the scale of the fold-change $\\exp(\\beta)$.\n\nThe parameter of interest is the fold-change in the geometric mean, which is given by $\\exp(\\beta)$. A fundamental property of confidence intervals is that they can be transformed by monotone functions. If $[L, U]$ is a $100(1-\\alpha)\\%$ confidence interval for a parameter $\\theta$, and $g(\\cdot)$ is a strictly increasing function, then $[g(L), g(U)]$ is a $100(1-\\alpha)\\%$ confidence interval for $g(\\theta)$.\n\nIn this problem, the function is the natural exponential function, $g(\\beta) = \\exp(\\beta)$. This function is strictly increasing for all real numbers. Therefore, we can obtain the confidence interval for the fold-change $\\exp(\\beta)$ by exponentiating the endpoints of the confidence interval for $\\beta$.\n\nThe lower bound of the confidence interval for $\\exp(\\beta)$ is:\n$$ \\exp(\\beta_L) = \\exp(0.0648) $$\nThe upper bound of the confidence interval for $\\exp(\\beta)$ is:\n$$ \\exp(\\beta_U) = \\exp(0.5352) $$\n\nNow, we compute the numerical values for these endpoints:\n$$ \\text{Lower bound} = \\exp(0.0648) \\approx 1.0669528 $$\n$$ \\text{Upper bound} = \\exp(0.5352) \\approx 1.7077836 $$\nThe problem requires the final answer to be rounded to four significant figures.\n- For the lower bound, $1.0669528...$, the first four significant figures are $1.066$. The fifth digit is $9$, so we round up the fourth digit. The rounded value is $1.067$.\n- For the upper bound, $1.7077836...$, the first four significant figures are $1.707$. The fifth digit is $7$, so we round up the fourth digit. The rounded value is $1.708$.\n\nTherefore, the $95\\%$ confidence interval for the fold-change $\\exp(\\beta)$ is approximately $[1.067, 1.708]$. These endpoints are presented as the final answer.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.067 & 1.708\n\\end{pmatrix}\n}\n$$", "id": "4990433"}, {"introduction": "A proficient data analyst knows that choosing a statistical model is not arbitrary. While the log-normal distribution is a default for many physiological measures, other distributions like the gamma might provide a better fit. This final practice is a computational exercise in model selection, where you will fit both log-normal and gamma models to various datasets and use the Akaike Information Criterion ($AIC$) to compare their performance [@problem_id:4990408]. This will hone your practical coding skills and instill the crucial habit of critically evaluating, rather than blindly accepting, model assumptions.", "problem": "You are given three independent datasets of serum triglyceride measurements recorded in milligrams per deciliter (mg/dL). Assume each dataset is a random sample of size $n$ drawn independently and identically distributed (i.i.d.) from a strictly positive physiological measure. Consider two parametric models for the sampling distribution: the log-normal model and the gamma model. Under the log-normal model, the natural logarithm of the observed value is modeled as normally distributed, whereas under the gamma model, the observed value itself is modeled by a shape-scale family. The task is to fit both models to each dataset by maximum likelihood, compute the maximized log-likelihood for each fitted model, and then use Akaike Information Criterion (AIC) to compare the models. Finally, you must report for each dataset the difference $AIC_{\\text{gamma}} - AIC_{\\text{lognormal}}$.\n\nFoundational base and definitions to be used:\n- Independence and identical distribution (i.i.d.) of samples.\n- The log-normal density for a single observation $x \\gt 0$ with parameters $\\mu \\in \\mathbb{R}$ and $\\sigma \\gt 0$ is given by\n$$\nf_{\\text{LN}}(x \\mid \\mu, \\sigma) = \\frac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\left( - \\frac{(\\ln x - \\mu)^2}{2\\sigma^2} \\right).\n$$\n- The gamma density for a single observation $x \\gt 0$ with shape $k \\gt 0$ and scale $\\theta \\gt 0$ is\n$$\nf_{\\Gamma}(x \\mid k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\Gamma(k)\\,\\theta^k}.\n$$\n- Maximum likelihood estimation (MLE): choose parameter values that maximize the joint likelihood over the sample.\n- Akaike Information Criterion (AIC): for a model with $p$ free parameters and maximized log-likelihood $\\ell(\\hat{\\theta})$, define\n$$\nAIC = 2p - 2\\ell(\\hat{\\theta}).\n$$\nLower $AIC$ indicates better expected out-of-sample predictive performance among the candidate models.\n\nDerivation tasks you must carry out algorithmically:\n- For the log-normal model, derive and implement the maximum likelihood estimators $\\hat{\\mu}$ and $\\hat{\\sigma}$ from the sample $\\{x_i\\}_{i=1}^n$ and compute the maximized log-likelihood $\\ell_{\\text{LN}}(\\hat{\\mu}, \\hat{\\sigma})$.\n- For the gamma model, derive and implement the maximum likelihood estimators $\\hat{k}$ and $\\hat{\\theta}$ from the sample $\\{x_i\\}_{i=1}^n$ and compute the maximized log-likelihood $\\ell_{\\Gamma}(\\hat{k}, \\hat{\\theta})$. Note that the gamma shape $\\hat{k}$ does not admit a closed-form solution and must be obtained by solving a smooth nonlinear equation; use a stable numerical root-finding method grounded in the derivative of the digamma function.\n- Compute $AIC_{\\text{LN}}$ and $AIC_{\\Gamma}$ using the number of freely estimated parameters $p = 2$ for each model and report the difference $AIC_{\\Gamma} - AIC_{\\text{LN}}$ for each dataset.\n\nScientific realism requirements:\n- Serum triglyceride values must be strictly positive and plausible in mg/dL, covering typical fasting values and clinically elevated values.\n- The log-normal model is appropriate for multiplicative biological variability; the gamma model is appropriate for positive skewed data with scale heterogeneity.\n\nTest suite (datasets in mg/dL):\n- Dataset $1$ (moderate variability, $n = 15$): $\\{60, 65, 68, 72, 76, 80, 85, 90, 95, 100, 110, 120, 130, 140, 155\\}$.\n- Dataset $2$ (small sample, $n = 5$): $\\{55, 80, 95, 140, 220\\}$.\n- Dataset $3$ (heavy tail, $n = 15$): $\\{70, 85, 90, 100, 120, 140, 160, 180, 210, 250, 300, 400, 600, 900, 1500\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each element equal to the difference $AIC_{\\Gamma} - AIC_{\\text{LN}}$ for the corresponding dataset, rounded to $6$ decimal places. For example, an output with three datasets must look like $\\left[ d_1, d_2, d_3 \\right]$ where each $d_i$ is a float rounded to $6$ decimal places.\n\nNo angles are involved. No percentages are required. Physical units are mg/dL for the datasets; the reported $AIC$ differences are unitless. Ensure each dataset is treated as i.i.d. positive samples, and ensure numerical methods maintain positivity of parameter estimates.", "solution": "The problem requires a statistical comparison of two parametric models, the log-normal and gamma distributions, for three datasets of serum triglyceride levels. The comparison will be based on the Akaike Information Criterion (AIC), which necessitates fitting each model via maximum likelihood estimation (MLE).\n\nThe procedure is as follows:\n$1$. For each dataset, derive and compute the maximum likelihood estimates for the parameters of the log-normal model.\n$2$. Compute the maximized log-likelihood for the fitted log-normal model.\n$3$. For each dataset, derive and compute the maximum likelihood estimates for the parameters of the gamma model. This will involve numerical optimization.\n$4$. Compute the maximized log-likelihood for the fitted gamma model.\n$5$. For each model and dataset, calculate the AIC.\n$6$. Report the difference $AIC_{\\text{gamma}} - AIC_{\\text{lognormal}}$.\n\nLet a given dataset be denoted by $\\{x_i\\}_{i=1}^n$, where each $x_i > 0$.\n\n**1. Log-Normal Model Fitting**\n\nThe probability density function (PDF) for a log-normal distribution is given by:\n$$f_{\\text{LN}}(x \\mid \\mu, \\sigma) = \\frac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\left( - \\frac{(\\ln x - \\mu)^2}{2\\sigma^2} \\right)$$\nThe likelihood function for an i.i.d. sample $\\{x_i\\}_{i=1}^n$ is the product of the individual densities:\n$$L_{\\text{LN}}(\\mu, \\sigma \\mid \\{x_i\\}) = \\prod_{i=1}^n \\frac{1}{x_i \\sigma \\sqrt{2\\pi}} \\exp\\left( - \\frac{(\\ln x_i - \\mu)^2}{2\\sigma^2} \\right)$$\nThe log-likelihood function, $\\ell_{\\text{LN}} = \\ln L_{\\text{LN}}$, is:\n$$\\ell_{\\text{LN}}(\\mu, \\sigma) = \\sum_{i=1}^n \\left[ -\\ln x_i - \\ln\\sigma - \\frac{1}{2}\\ln(2\\pi) - \\frac{(\\ln x_i - \\mu)^2}{2\\sigma^2} \\right]$$\n$$\\ell_{\\text{LN}}(\\mu, \\sigma) = -\\sum_{i=1}^n \\ln x_i - n\\ln\\sigma - \\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^n (\\ln x_i - \\mu)^2$$\nMaximizing this log-likelihood with respect to $\\mu$ and $\\sigma$ is equivalent to maximizing the log-likelihood for a normal distribution for the log-transformed data $y_i = \\ln x_i$. The MLEs for the parameters of a normal distribution are the sample mean and sample variance. Therefore, the MLEs for $\\mu$ and $\\sigma^2$ are:\n$$\\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^n \\ln x_i$$\n$$\\hat{\\sigma}^2 = \\frac{1}{n} \\sum_{i=1}^n (\\ln x_i - \\hat{\\mu})^2$$\nThe MLE for $\\sigma$ is $\\hat{\\sigma} = \\sqrt{\\hat{\\sigma}^2}$. Substituting these estimates back into the log-likelihood function yields the maximized log-likelihood:\n$$\\ell_{\\text{LN}}(\\hat{\\mu}, \\hat{\\sigma}) = -\\sum_{i=1}^n \\ln x_i - n\\ln\\hat{\\sigma} - \\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2\\hat{\\sigma}^2} \\sum_{i=1}^n (\\ln x_i - \\hat{\\mu})^2$$\nSince $\\sum_{i=1}^n (\\ln x_i - \\hat{\\mu})^2 = n\\hat{\\sigma}^2$, the expression simplifies to:\n$$\\ell_{\\text{LN}}(\\hat{\\mu}, \\hat{\\sigma}) = -\\sum_{i=1}^n \\ln x_i - n\\ln\\hat{\\sigma} - \\frac{n}{2}(\\ln(2\\pi) + 1)$$\n\n**2. Gamma Model Fitting**\n\nThe PDF for a gamma distribution is given by:\n$$f_{\\Gamma}(x \\mid k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\Gamma(k)\\,\\theta^k}$$\nThe log-likelihood function for an i.i.d. sample is:\n$$\\ell_{\\Gamma}(k, \\theta) = \\sum_{i=1}^n \\left[ (k-1)\\ln x_i - \\frac{x_i}{\\theta} - \\ln\\Gamma(k) - k\\ln\\theta \\right]$$\n$$\\ell_{\\Gamma}(k, \\theta) = (k-1)\\sum_{i=1}^n \\ln x_i - \\frac{1}{\\theta}\\sum_{i=1}^n x_i - n\\ln\\Gamma(k) - nk\\ln\\theta$$\nTo find the MLEs, we take partial derivatives with respect to $k$ and $\\theta$ and set them to zero. The partial derivative with respect to $\\theta$ is:\n$$\\frac{\\partial\\ell_{\\Gamma}}{\\partial\\theta} = \\frac{1}{\\theta^2}\\sum_{i=1}^n x_i - \\frac{nk}{\\theta} = 0$$\nThis yields the relationship $\\hat{\\theta} = \\frac{\\sum x_i}{nk} = \\frac{\\bar{x}}{\\hat{k}}$, where $\\bar{x}$ is the sample mean.\nSubstituting this into the partial derivative with respect to $k$ and setting it to zero results in a non-linear equation for $\\hat{k}$. Simplifying the score equation gives:\n$$\\ln(\\hat{k}) - \\psi(\\hat{k}) = \\ln(\\bar{x}) - \\frac{1}{n}\\sum_{i=1}^n \\ln x_i$$\nHere, $\\psi(k) = \\frac{d}{dk}\\ln\\Gamma(k)$ is the digamma function. Let $s = \\ln(\\bar{x}) - \\overline{\\ln x}$. The equation to solve is $g(k) = \\ln(k) - \\psi(k) - s = 0$. This equation does not have a closed-form solution and must be solved numerically. We use the Newton-Raphson method, an iterative root-finding algorithm:\n$$k_{j+1} = k_j - \\frac{g(k_j)}{g'(k_j)}$$\nThe derivative of $g(k)$ is $g'(k) = \\frac{1}{k} - \\psi'(k)$, where $\\psi'(k)$ is the trigamma function. The function $\\ln(k) - \\psi(k)$ is monotonically increasing for $k > 0$, ensuring a unique solution for $\\hat{k}$. A robust initial guess for $k$ is used to start the iteration.\nOnce $\\hat{k}$ is found, $\\hat{\\theta}$ is calculated as $\\hat{\\theta} = \\bar{x}/\\hat{k}$. The maximized log-likelihood is then:\n$$\\ell_{\\Gamma}(\\hat{k}, \\hat{\\theta}) = (\\hat{k}-1)\\sum_{i=1}^n \\ln x_i - \\frac{1}{\\hat{\\theta}}\\sum_{i=1}^n x_i - n\\ln\\Gamma(\\hat{k}) - n\\hat{k}\\ln\\hat{\\theta}$$\nFor numerical stability, $\\ln\\Gamma(k)$ is computed using the log-gamma function, `gammaln`.\n\n**3. Model Comparison using AIC**\n\nThe Akaike Information Criterion is defined as $AIC = 2p - 2\\ell(\\hat{\\theta})$, where $p$ is the number of estimated parameters and $\\ell(\\hat{\\theta})$ is the maximized log-likelihood. For both the log-normal model $(\\mu, \\sigma)$ and the gamma model $(k, \\theta)$, the number of parameters is $p=2$.\n$$AIC_{\\text{LN}} = 2(2) - 2\\ell_{\\text{LN}}(\\hat{\\mu}, \\hat{\\sigma}) = 4 - 2\\ell_{\\text{LN}}$$\n$$AIC_{\\Gamma} = 2(2) - 2\\ell_{\\Gamma}(\\hat{k}, \\hat{\\theta}) = 4 - 2\\ell_{\\Gamma}$$\nThe desired quantity is the difference:\n$$AIC_{\\Gamma} - AIC_{\\text{LN}} = (4 - 2\\ell_{\\Gamma}) - (4 - 2\\ell_{\\text{LN}}) = 2\\ell_{\\text{LN}} - 2\\ell_{\\Gamma}$$\nA negative value for this difference suggests the gamma model provides a better fit according to AIC, while a positive value favors the log-normal model.\n\nThe algorithm will be applied to each of the three provided datasets to compute this difference.", "answer": "$$\n\\boxed{[0.129332, -0.518602, 3.310636]}\n$$", "id": "4990408"}]}