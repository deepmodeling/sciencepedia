{"hands_on_practices": [{"introduction": "The parameters of an Accelerated Failure Time (AFT) model provide a powerful summary of how covariates affect survival, but their direct interpretation can be abstract. This exercise bridges the gap between theory and practice by asking you to derive fundamental survival metrics—the median and interquartile range—directly from the model's components. By completing this practice [@problem_id:4772574], you will gain a concrete understanding of how the linear predictor $x^{\\top}\\beta$ and the baseline error distribution jointly determine the location and spread of the predicted survival time distribution.", "problem": "A biostatistician is analyzing time-to-event outcomes using an Accelerated Failure Time (AFT) model. Let $T$ denote a positive survival time and $x \\in \\mathbb{R}^{p}$ denote a fixed covariate vector with linear predictor $x^{\\top}\\beta$. The AFT model is specified by the log-linear representation\n$$\n\\log T \\mid x \\;=\\; x^{\\top}\\beta \\;+\\; \\varepsilon,\n$$\nwhere $\\varepsilon$ is independent of $x$ and follows a baseline error distribution. Consider two baseline specifications for $\\varepsilon$:\n\n1. Log-normal AFT: $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2})$ with $\\sigma>0$.\n2. Log-logistic AFT: $\\varepsilon \\sim \\text{Logistic}(0,s)$ with location $0$, scale $s>0$, and cumulative distribution function $F_{\\varepsilon}(u)=\\left(1+\\exp\\!\\left(-u/s\\right)\\right)^{-1}$.\n\nFor each baseline specification, derive the median and the interquartile range (IQR) of $T\\mid x$ as explicit functions of $x^{\\top}\\beta$ and the corresponding baseline parameter(s) ($\\sigma$ for the log-normal model, $s$ for the log-logistic model). Express your answers in closed form, using only standard functions and constants (for example, you may use $\\Phi^{-1}$ for the quantile function of the standard normal distribution and $\\ln$ for the natural logarithm). Provide your final result as four expressions in the following order: log-normal median, log-normal IQR, log-logistic median, log-logistic IQR. Do not round your answer.", "solution": "The problem is valid as it is well-posed, scientifically grounded in established statistical theory (Accelerated Failure Time models), and presented with objective, formal language. All necessary information is provided, and there are no contradictions.\n\nThe Accelerated Failure Time (AFT) model is defined by the log-linear relationship between the survival time $T$, a covariate vector $x$, and an error term $\\varepsilon$:\n$$\n\\log T = x^{\\top}\\beta + \\varepsilon\n$$\nwhere $\\varepsilon$ is independent of $x$ and follows a specified baseline error distribution. This equation implies that the survival time $T$ can be expressed as:\n$$\nT = \\exp(x^{\\top}\\beta + \\varepsilon) = \\exp(x^{\\top}\\beta)\\exp(\\varepsilon)\n$$\nTo find the quantiles of $T$ given $x$, we can first find the quantiles of $\\log T$. Let $q_p(V)$ denote the $p$-th quantile of a random variable $V$ for $p \\in (0, 1)$. Since $x^{\\top}\\beta$ is a constant with respect to the distribution of $\\varepsilon$, the $p$-th quantile of $\\log T$ is:\n$$\nq_p(\\log T) = x^{\\top}\\beta + q_p(\\varepsilon)\n$$\nThe exponential function is strictly monotonic, so the quantiles of $T$ can be obtained by exponentiating the quantiles of $\\log T$:\n$$\nq_p(T) = \\exp(q_p(\\log T)) = \\exp(x^{\\top}\\beta + q_p(\\varepsilon)) = \\exp(x^{\\top}\\beta)\\exp(q_p(\\varepsilon))\n$$\nThe median is the $p=0.5$ quantile, $q_{0.5}(T)$. The interquartile range (IQR) is the difference between the third quartile ($p=0.75$) and the first quartile ($p=0.25$):\n$$\n\\text{IQR}(T) = q_{0.75}(T) - q_{0.25}(T) = \\exp(x^{\\top}\\beta)\\left(\\exp(q_{0.75}(\\varepsilon)) - \\exp(q_{0.25}(\\varepsilon))\\right)\n$$\nWe now apply this general framework to the two specified baseline distributions for $\\varepsilon$.\n\n### 1. Log-normal AFT Model\nHere, the error term follows a normal distribution, $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$, with $\\sigma > 0$. Let $Z \\sim \\mathcal{N}(0, 1)$ be a standard normal variable, so $\\varepsilon = \\sigma Z$. The $p$-th quantile of $\\varepsilon$ is found by $P(\\varepsilon \\le q_p(\\varepsilon)) = p$.\n$$\nP(\\sigma Z \\le q_p(\\varepsilon)) = P(Z \\le q_p(\\varepsilon)/\\sigma) = p\n$$\nLet $\\Phi$ be the cumulative distribution function (CDF) of the standard normal distribution. Then $\\Phi(q_p(\\varepsilon)/\\sigma) = p$, which implies $q_p(\\varepsilon)/\\sigma = \\Phi^{-1}(p)$, where $\\Phi^{-1}$ is the quantile function of the standard normal distribution.\n$$\nq_p(\\varepsilon) = \\sigma \\Phi^{-1}(p)\n$$\n**Median of $T \\mid x$:**\nFor the median, $p=0.5$. The median of a standard normal distribution is $0$, so $\\Phi^{-1}(0.5) = 0$.\n$$\nq_{0.5}(\\varepsilon) = \\sigma \\Phi^{-1}(0.5) = \\sigma \\cdot 0 = 0\n$$\nThe median of $T \\mid x$ is therefore:\n$$\n\\text{Median}(T \\mid x) = \\exp(x^{\\top}\\beta + 0) = \\exp(x^{\\top}\\beta)\n$$\n**Interquartile Range (IQR) of $T \\mid x$:**\nFor the IQR, we need the quartiles for $p=0.25$ and $p=0.75$.\n$$\nq_{0.75}(\\varepsilon) = \\sigma \\Phi^{-1}(0.75)\n$$\n$$\nq_{0.25}(\\varepsilon) = \\sigma \\Phi^{-1}(0.25)\n$$\nDue to the symmetry of the normal distribution about $0$, we have $\\Phi^{-1}(0.25) = -\\Phi^{-1}(1-0.25) = -\\Phi^{-1}(0.75)$.\nSubstituting these into the general formula for the IQR of $T$:\n$$\n\\text{IQR}(T \\mid x) = \\exp(x^{\\top}\\beta) \\left( \\exp(\\sigma \\Phi^{-1}(0.75)) - \\exp(-\\sigma \\Phi^{-1}(0.75)) \\right)\n$$\nUsing the identity $2\\sinh(y) = \\exp(y) - \\exp(-y)$, this can be written more compactly as:\n$$\n\\text{IQR}(T \\mid x) = 2\\exp(x^{\\top}\\beta)\\sinh(\\sigma\\Phi^{-1}(0.75))\n$$\n\n### 2. Log-logistic AFT Model\nHere, the error term follows a logistic distribution, $\\varepsilon \\sim \\text{Logistic}(0, s)$, with scale $s > 0$ and CDF $F_{\\varepsilon}(u) = (1+\\exp(-u/s))^{-1}$. To find the $p$-th quantile of $\\varepsilon$, $q_p(\\varepsilon)$, we set $F_{\\varepsilon}(q_p(\\varepsilon)) = p$ and solve for $q_p(\\varepsilon)$:\n$$\np = \\frac{1}{1 + \\exp(-q_p(\\varepsilon)/s)} \\implies 1 + \\exp(-q_p(\\varepsilon)/s) = \\frac{1}{p}\n$$\n$$\n\\exp(-q_p(\\varepsilon)/s) = \\frac{1}{p} - 1 = \\frac{1-p}{p}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{q_p(\\varepsilon)}{s} = \\ln\\left(\\frac{1-p}{p}\\right) = -\\ln\\left(\\frac{p}{1-p}\\right)\n$$\n$$\nq_p(\\varepsilon) = s \\ln\\left(\\frac{p}{1-p}\\right)\n$$\n**Median of $T \\mid x$:**\nFor the median, $p=0.5$.\n$$\nq_{0.5}(\\varepsilon) = s \\ln\\left(\\frac{0.5}{1-0.5}\\right) = s \\ln(1) = 0\n$$\nThe logistic distribution is symmetric about its location parameter, which is $0$ in this case. The median of $T \\mid x$ is:\n$$\n\\text{Median}(T \\mid x) = \\exp(x^{\\top}\\beta + 0) = \\exp(x^{\\top}\\beta)\n$$\n**Interquartile Range (IQR) of $T \\mid x$:**\nFor the IQR, we need the quartiles for $p=0.25$ and $p=0.75$.\n$$\nq_{0.75}(\\varepsilon) = s \\ln\\left(\\frac{0.75}{0.25}\\right) = s \\ln(3)\n$$\n$$\nq_{0.25}(\\varepsilon) = s \\ln\\left(\\frac{0.25}{0.75}\\right) = s \\ln(1/3) = -s \\ln(3)\n$$\nSubstituting these into the general formula for the IQR of $T$:\n$$\n\\text{IQR}(T \\mid x) = \\exp(x^{\\top}\\beta)\\left(\\exp(s \\ln(3)) - \\exp(-s \\ln(3))\\right)\n$$\nUsing the property $\\exp(a \\ln b) = b^a$, this simplifies to:\n$$\n\\text{IQR}(T \\mid x) = \\exp(x^{\\top}\\beta)(3^s - 3^{-s})\n$$\n\nThe four required expressions in the specified order (log-normal median, log-normal IQR, log-logistic median, log-logistic IQR) are:\n1. $\\exp(x^{\\top}\\beta)$\n2. $2\\exp(x^{\\top}\\beta)\\sinh(\\sigma\\Phi^{-1}(0.75))$\n3. $\\exp(x^{\\top}\\beta)$\n4. $\\exp(x^{\\top}\\beta)(3^s - 3^{-s})$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp(x^{\\top}\\beta)  2\\exp(x^{\\top}\\beta)\\sinh(\\sigma\\Phi^{-1}(0.75))  \\exp(x^{\\top}\\beta)  \\exp(x^{\\top}\\beta)(3^{s} - 3^{-s}) \\end{pmatrix}}\n$$", "id": "4772574"}, {"introduction": "Beyond point estimates, a crucial part of statistical modeling is quantifying the uncertainty of our findings. In clinical applications of AFT models, this often means constructing a confidence interval for the time ratio to assess a treatment's efficacy. This practice [@problem_id:4949753] guides you through using the delta method to derive a confidence interval for the time ratio $\\theta = \\exp(\\beta_j)$ and applying it to a practical scenario, solidifying your ability to translate statistical output into clinically meaningful conclusions.", "problem": "A randomized clinical trial assesses whether a new therapy prolongs time to disease relapse relative to standard care. An Accelerated Failure Time (AFT) model is fit to the data, where the conditional logarithm of the event time $T$ given a covariate vector $\\boldsymbol{x}$ satisfies $\\ln(T) = \\boldsymbol{x}^{\\top}\\boldsymbol{\\beta} + \\sigma \\varepsilon$, with $\\varepsilon$ having a baseline distribution with mean $0$ and variance $1$, and $\\sigma \\gt 0$. The treatment indicator is the $j$th component $x_{j} \\in \\{0,1\\}$, with $x_{j} = 1$ for new therapy and $x_{j} = 0$ for standard care. The time ratio associated with a one-unit increase in $x_{j}$ is $\\theta = \\exp(\\beta_{j})$, which quantifies the multiplicative change in the typical event time under treatment versus control.\n\nAssume that the maximum likelihood estimator $\\widehat{\\beta}_{j}$ is asymptotically normal with asymptotic variance given by the corresponding diagonal entry of the estimated covariance matrix, so that $\\widehat{\\beta}_{j} \\approx \\mathcal{N}(\\beta_{j}, \\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}))$. Using only the definition of the AFT model, large-sample normality of maximum likelihood estimators, and the delta method for smooth transformations, derive a large-sample $(1-\\alpha)$ confidence interval for the time ratio $\\theta = \\exp(\\beta_{j})$ expressed entirely in terms of $\\widehat{\\beta}_{j}$, $\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})$, and the standard normal quantile $z_{1-\\alpha/2}$. Then, for a study in which the fitted model yields $\\widehat{\\beta}_{j} = 0.182$ and $\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}) = 0.0049$, evaluate the $(1-\\alpha)$ confidence interval for $\\theta$ at confidence level $0.95$ and report its two endpoints. Round your two numerical endpoints to four significant figures. Finally, state the clinical efficacy interpretation of this interval in terms of multiplicative change in time to relapse under the new therapy versus standard care.", "solution": "The problem requires the derivation of a large-sample confidence interval for the time ratio $\\theta$ in an Accelerated Failure Time (AFT) model, a numerical evaluation of this interval, and its clinical interpretation.\n\nFirst, we validate the problem statement.\nStep 1: Extract Givens.\n- The AFT model is defined by $\\ln(T) = \\boldsymbol{x}^{\\top}\\boldsymbol{\\beta} + \\sigma \\varepsilon$, where $\\varepsilon$ has mean $0$ and variance $1$, and $\\sigma  0$.\n- The covariate $x_{j} \\in \\{0, 1\\}$ is the treatment indicator ($1$ for new therapy, $0$ for standard care).\n- The time ratio is defined as $\\theta = \\exp(\\beta_{j})$.\n- The maximum likelihood estimator $\\widehat{\\beta}_{j}$ is asymptotically normal: $\\widehat{\\beta}_{j} \\approx \\mathcal{N}(\\beta_{j}, \\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}))$.\n- The task is to derive a $(1-\\alpha)$ confidence interval for $\\theta$.\n- The derivation should use the delta method.\n- The final expression for the interval should be in terms of $\\widehat{\\beta}_{j}$, $\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})$, and $z_{1-\\alpha/2}$.\n- For numerical evaluation: $\\widehat{\\beta}_{j} = 0.182$, $\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}) = 0.0049$, and the confidence level is $0.95$.\n- The final numerical endpoints must be rounded to four significant figures.\n- A clinical interpretation of the interval is required.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, as it uses standard and well-established concepts from statistical theory, namely Accelerated Failure Time models, maximum likelihood estimation, the delta method, and confidence interval construction. These are core topics in biostatistics and survival analysis. The problem is well-posed, providing all necessary information and assumptions to derive a unique analytical expression and compute a specific numerical result. The language is objective and formal. The problem does not violate any of the invalidity criteria. It is a standard, solvable problem in statistical modeling.\n\nStep 3: Verdict and Action.\nThe problem is valid. We proceed with the solution.\n\n**Part 1: Derivation of the Confidence Interval for $\\theta$**\n\nWe are given that the maximum likelihood estimator $\\widehat{\\beta}_{j}$ for the parameter $\\beta_{j}$ is asymptotically normally distributed:\n$$ \\widehat{\\beta}_{j} \\sim \\mathcal{N}\\left(\\beta_{j}, \\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})\\right) $$\nFrom this, we can construct a pivotal quantity that follows a standard normal distribution:\n$$ \\frac{\\widehat{\\beta}_{j} - \\beta_{j}}{\\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}} \\approx \\mathcal{N}(0, 1) $$\nLet $\\mathrm{SE}(\\widehat{\\beta}_{j}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}$ be the standard error of $\\widehat{\\beta}_{j}$. A large-sample $(1-\\alpha)$ confidence interval for $\\beta_{j}$ is constructed based on this pivot. For a standard normal distribution, the interval $(-z_{1-\\alpha/2}, z_{1-\\alpha/2})$ contains $(1-\\alpha)$ of the probability mass, where $z_{1-\\alpha/2}$ is the $(1-\\alpha/2)$-quantile of the standard normal distribution. Thus, we have:\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\widehat{\\beta}_{j} - \\beta_{j}}{\\mathrm{SE}(\\widehat{\\beta}_{j})} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\nRearranging the inequalities to isolate $\\beta_{j}$ yields the confidence interval for $\\beta_{j}$:\n$$ \\left[ \\widehat{\\beta}_{j} - z_{1-\\alpha/2} \\mathrm{SE}(\\widehat{\\beta}_{j}), \\quad \\widehat{\\beta}_{j} + z_{1-\\alpha/2} \\mathrm{SE}(\\widehat{\\beta}_{j}) \\right] $$\nSubstituting back $\\mathrm{SE}(\\widehat{\\beta}_{j}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}$, the interval for $\\beta_{j}$ is:\n$$ \\left[ \\widehat{\\beta}_{j} - z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}, \\quad \\widehat{\\beta}_{j} + z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})} \\right] $$\nThe problem asks for a confidence interval for the time ratio $\\theta = \\exp(\\beta_{j})$. The transformation $g(\\beta_j) = \\exp(\\beta_j)$ is a smooth, strictly increasing (monotonic) function. A valid confidence interval for a transformed parameter can be obtained by applying the transformation to the endpoints of the confidence interval for the original parameter. This procedure is theoretically justified by the delta method. Applying the delta method to the function $h(\\theta) = \\ln(\\theta)$ shows that the variance of $\\ln(\\widehat{\\theta}) = \\widehat{\\beta}_{j}$ is approximately equal to the variance of $\\widehat{\\beta}_{j}$, validating the construction of the interval on the log-scale (i.e., for $\\beta_j$) and then back-transforming.\n\nApplying the exponential function to the lower and upper bounds of the interval for $\\beta_{j}$, we obtain the $(1-\\alpha)$ confidence interval for $\\theta$:\n$$ \\left[ \\exp\\left(\\widehat{\\beta}_{j} - z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}\\right), \\quad \\exp\\left(\\widehat{\\beta}_{j} + z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}\\right) \\right] $$\nThis is the required general expression for the confidence interval for the time ratio $\\theta$.\n\n**Part 2: Numerical Evaluation of the Confidence Interval**\n\nWe are given the following values:\n- Estimated coefficient: $\\widehat{\\beta}_{j} = 0.182$\n- Estimated variance: $\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}) = 0.0049$\n- Confidence level: $1-\\alpha = 0.95$\n\nFirst, we calculate the standard error of $\\widehat{\\beta}_{j}$:\n$$ \\mathrm{SE}(\\widehat{\\beta}_{j}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})} = \\sqrt{0.0049} = 0.07 $$\nFor a $0.95$ confidence level, $\\alpha = 0.05$, so $\\alpha/2 = 0.025$. The relevant standard normal quantile is:\n$$ z_{1-\\alpha/2} = z_{1-0.025} = z_{0.975} $$\nThe standard value for $z_{0.975}$ is approximately $1.960$.\n\nNext, we calculate the bounds for the confidence interval for $\\beta_{j}$:\nLower bound for $\\beta_{j}$:\n$$ L_{\\beta} = \\widehat{\\beta}_{j} - z_{0.975} \\mathrm{SE}(\\widehat{\\beta}_{j}) = 0.182 - 1.960 \\times 0.07 = 0.182 - 0.1372 = 0.0448 $$\nUpper bound for $\\beta_{j}$:\n$$ U_{\\beta} = \\widehat{\\beta}_{j} + z_{0.975} \\mathrm{SE}(\\widehat{\\beta}_{j}) = 0.182 + 1.960 \\times 0.07 = 0.182 + 0.1372 = 0.3192 $$\nNow, we exponentiate these bounds to find the confidence interval for $\\theta = \\exp(\\beta_{j})$:\nLower bound for $\\theta$:\n$$ L_{\\theta} = \\exp(L_{\\beta}) = \\exp(0.0448) \\approx 1.045815... $$\nUpper bound for $\\theta$:\n$$ U_{\\theta} = \\exp(U_{\\beta}) = \\exp(0.3192) \\approx 1.376040... $$\nRounding these endpoints to four significant figures gives:\n$$ L_{\\theta} \\approx 1.046 $$\n$$ U_{\\theta} \\approx 1.376 $$\nThe $95\\%$ confidence interval for the time ratio $\\theta$ is approximately $[1.046, 1.376]$.\n\n**Part 3: Clinical Efficacy Interpretation**\n\nThe time ratio $\\theta = \\exp(\\beta_j)$ represents the multiplicative factor by which the event time is changed for a patient receiving the new therapy ($x_j=1$) compared to one receiving standard care ($x_j=0$), all other covariates being equal. A value of $\\theta  1$ indicates that the new therapy prolongs the time to relapse, $\\theta  1$ indicates it shortens the time, and $\\theta = 1$ indicates no effect.\n\nOur calculated $95\\%$ confidence interval for $\\theta$ is $[1.046, 1.376]$. The entire interval lies above $1$. This indicates a statistically significant positive effect of the new therapy. The clinical interpretation is as follows: We are $95\\%$ confident that the new therapy multiplies the median time to disease relapse by a factor between $1.046$ and $1.376$, compared to standard care. In other words, the new therapy is associated with an increase in the median time to relapse of between $4.6\\%$ and $37.6\\%$. Since the null value of $\\theta=1$ (no effect) is not contained within the confidence interval, this result provides strong evidence that the new therapy is superior to standard care in prolonging the time to disease relapse in this patient population.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.046  1.376\n\\end{pmatrix}\n}\n$$", "id": "4949753"}, {"introduction": "A model's predictions are only as reliable as its underlying assumptions, making diagnostic checks a critical step in any analysis. This exercise [@problem_id:4949812] introduces Cox-Snell residuals, a universal tool for evaluating any parametric survival model, including AFT models. By reasoning from first principles, you will understand why these residuals are expected to follow a standard exponential distribution under a correctly specified model, forming the basis for powerful graphical diagnostics.", "problem": "A clinical oncology study models time to radiographic progression $T_i$ for patient $i$ using an Accelerated Failure Time (AFT) model, where $\\log T_i = \\mathbf{x}_i^\\top \\boldsymbol{\\beta} + \\epsilon_i$, $\\mathbf{x}_i$ is a $p$-dimensional covariate vector, $\\boldsymbol{\\beta}$ is a coefficient vector, and $\\epsilon_i$ follows a continuous baseline distribution with survival function $S_0(\\cdot)$. The conditional survival function is $S(t \\mid \\mathbf{x}) = \\mathbb{P}(T > t \\mid \\mathbf{x})$. Patients are subject to independent right censoring by $C_i$, yielding observed time $\\tilde T_i = \\min(T_i, C_i)$ and event indicator $\\delta_i = \\mathbf{1}\\{T_i \\le C_i\\}$. After fitting the AFT model to obtain an estimator $\\hat S(t \\mid \\mathbf{x})$ of $S(t \\mid \\mathbf{x})$, define the Cox-Snell residual for subject $i$ as $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$.\n\nFrom first principles, use the definitions of survival function $S(t \\mid \\mathbf{x})$, cumulative hazard $H(t \\mid \\mathbf{x}) = -\\log S(t \\mid \\mathbf{x})$, and the monotone transform properties of continuous random variables to reason about the expected distributional behavior of $\\hat R_i$ under a correctly specified AFT model with consistent estimation of the conditional survival $S(t \\mid \\mathbf{x})$. Assume independent right censoring. Which of the following statements are correct?\n\nA. Under correct specification and exact parameters, for uncensored subjects the random variables $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ are independent and identically distributed with cumulative distribution function $F_R(r) = 1 - \\exp(-r)$ and density $f_R(r) = \\exp(-r)$ for $r \\ge 0$.\n\nB. In an AFT model, the conditional survival satisfies $S(t \\mid \\mathbf{x}) = S_0\\!\\big(t \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})\\big)$; therefore $R_i = H_0\\!\\big(T_i \\exp(\\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}})\\big)$, and under the true model, $R_i$ is $\\mathrm{Exponential}(1)$.\n\nC. With independent right censoring, using $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$ yields residuals that are right-censored at $\\hat R_i$ whenever $\\delta_i = 0$, and the Kaplan–Meier estimator of the residual survival should approximately follow $\\exp(-r)$ if the model is correctly specified.\n\nD. Because time is modeled on the log scale in an AFT model, the appropriate Cox-Snell residual is $R_i = -\\log \\hat S(\\log T_i \\mid \\mathbf{x}_i)$, which is $\\mathrm{Normal}(0,1)$ under correct specification.\n\nE. If the baseline time-to-event distribution is $\\mathrm{Weibull}$ with shape parameter $k$, then the Cox-Snell residuals have a $\\mathrm{Gamma}(k,1)$ distribution under correct specification.\n\nSelect all that apply.", "solution": "The validity of the problem statement must first be assessed.\n\n### Step 1: Extract Givens\n-   **Model**: Accelerated Failure Time (AFT) model for time-to-event $T_i$.\n-   **Equation**: $\\log T_i = \\mathbf{x}_i^\\top \\boldsymbol{\\beta} + \\epsilon_i$.\n-   **Variables**: $\\mathbf{x}_i$ is a $p$-dimensional covariate vector; $\\boldsymbol{\\beta}$ is the coefficient vector; $\\epsilon_i$ is an error term from a continuous baseline distribution.\n-   **Baseline Survival**: $S_0(\\cdot)$ is the survival function corresponding to the baseline distribution of the error term.\n-   **Conditional Survival**: $S(t \\mid \\mathbf{x}) = \\mathbb{P}(T > t \\mid \\mathbf{x})$.\n-   **Censoring**: Independent right censoring by $C_i$.\n-   **Observed Data**: $\\tilde T_i = \\min(T_i, C_i)$ and event indicator $\\delta_i = \\mathbf{1}\\{T_i \\le C_i\\}$.\n-   **Estimator**: $\\hat S(t \\mid \\mathbf{x})$ is an estimator of $S(t \\mid \\mathbf{x})$.\n-   **Cox-Snell Residual Definition**: $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$.\n-   **Question**: Determine the correct statements about the distributional behavior of $\\hat R_i$ under a correctly specified model with consistent estimation.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on well-established principles of survival analysis, specifically AFT models and Cox-Snell residuals. All concepts are standard in statistical theory and its application in medical research.\n-   **Well-Posed**: The problem asks for the derivation of theoretical properties under a standard set of assumptions (correct model specification, consistent estimation). A unique set of correct conclusions can be derived from these premises.\n-   **Objective**: The language is formal and devoid of subjectivity.\n-   **Flaw Checklist**: The problem does not violate any scientific principles, is formally stated, complete, realistic for a theoretical context, and well-posed. The definitions are standard.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation from First Principles\nThe fundamental principle underpinning the properties of Cox-Snell residuals is the probability integral transform (PIT). For a continuous random variable $T$ with cumulative distribution function (CDF) $F(t) = \\mathbb{P}(T \\le t)$ and survival function $S(t) = 1 - F(t)$, the random variable $U = F(T)$ is uniformly distributed on $[0,1]$. Equivalently, $1-S(T)$ is uniform on $[0,1]$, and so is $U' = S(T)$.\n\nLet's prove this for $U' = S(T)$. Since $T$ is continuous, $S(t)$ is a strictly decreasing function. For any $u \\in (0, 1)$, we can find the CDF of $U'$:\n$$ \\mathbb{P}(U' \\le u) = \\mathbb{P}(S(T) \\le u) $$\nBecause $S(\\cdot)$ is strictly decreasing, its inverse $S^{-1}(\\cdot)$ exists and is also strictly decreasing.\n$$ \\mathbb{P}(S(T) \\le u) = \\mathbb{P}(T \\ge S^{-1}(u)) = S(S^{-1}(u)) = u $$\nThis is the CDF of a $\\mathrm{Uniform}(0,1)$ distribution.\n\nNow, consider the random variable $R = -\\log(U')$. If $U' \\sim \\mathrm{Uniform}(0,1)$, its CDF is $F_{U'}(u) = u$ for $u \\in [0,1]$. The CDF of $R$ for $r \\ge 0$ is:\n$$ F_R(r) = \\mathbb{P}(R \\le r) = \\mathbb{P}(-\\log U' \\le r) = \\mathbb{P}(\\log U' \\ge -r) = \\mathbb{P}(U' \\ge e^{-r}) $$\nSince $U' \\sim \\mathrm{Uniform}(0,1)$, $\\mathbb{P}(U' \\ge v) = 1 - v$ for $v \\in [0,1]$. Thus:\n$$ F_R(r) = 1 - e^{-r} $$\nThis is the CDF of a standard exponential distribution, i.e., $\\mathrm{Exponential}(1)$, which has a rate parameter of $\\lambda=1$. Its probability density function (PDF) is $f_R(r) = e^{-r}$ for $r \\ge 0$.\n\nThis result can be applied to survival analysis. For a given subject with covariates $\\mathbf{x}_i$, the time-to-event $T_i$ is a random variable with conditional survival function $S(t \\mid \\mathbf{x}_i)$. Under the assumption that the model is correctly specified, the \"true\" Cox-Snell residual, defined for an uncensored observation as $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$, must follow an $\\mathrm{Exponential}(1)$ distribution. This is because $S(T_i \\mid \\mathbf{x}_i)$ follows a $\\mathrm{Uniform}(0,1)$ distribution by the PIT. This property holds irrespective of the specific form of the baseline survival function $S_0(\\cdot)$, as long as it is continuous.\n\nThe estimated residual $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$ is what is computed in practice. If the model is correct and the estimators for the parameters are consistent, then $\\hat S(t \\mid \\mathbf{x}_i)$ is a consistent estimator of $S(t \\mid \\mathbf{x}_i)$, and the distribution of $\\hat R_i$ for uncensored subjects will be approximately $\\mathrm{Exponential}(1)$.\n\n### Option-by-Option Analysis\n\n**A. Under correct specification and exact parameters, for uncensored subjects the random variables $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ are independent and identically distributed with cumulative distribution function $F_R(r) = 1 - \\exp(-r)$ and density $f_R(r) = \\exp(-r)$ for $r \\ge 0$.**\n\nAs derived above, for any single subject $i$, the random variable $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ follows an $\\mathrm{Exponential}(1)$ distribution, provided the model $S(t \\mid \\mathbf{x}_i)$ is correct. The CDF of an $\\mathrm{Exponential}(1)$ distribution is indeed $F_R(r) = 1 - \\exp(-r)$ and its density is $f_R(r) = \\exp(-r)$ for $r \\ge 0$.\nThe problem assumes a standard study setup where subjects are independent. Since the transformation from $T_i$ to $R_i$ is specific to each subject, the resulting residuals $R_i$ are also independent.\nFurthermore, the transformation maps the distribution of each $T_i$ (which depends on $\\mathbf{x}_i$) to the *same* standard distribution, $\\mathrm{Exponential}(1)$. Therefore, the residuals $R_i$ are identically distributed. The statement is a direct consequence of the PIT.\n\nVerdict: **Correct**.\n\n**B. In an AFT model, the conditional survival satisfies $S(t \\mid \\mathbf{x}) = S_0\\!\\big(t \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})\\big)$; therefore $R_i = H_0\\!\\big(T_i \\exp(\\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}})\\big)$, and under the true model, $R_i$ is $\\mathrm{Exponential}(1)$.**\n\nLet's derive the AFT survival function from the model $\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\epsilon$. This implies $T = e^{\\epsilon} e^{\\mathbf{x}^\\top \\boldsymbol{\\beta}}$. Let $T_0 = e^{\\epsilon}$ be the baseline event time, which has survival function $S_0(\\cdot)$. Then $T = T_0 e^{\\mathbf{x}^\\top \\boldsymbol{\\beta}}$.\nThe conditional survival is:\n$$ S(t \\mid \\mathbf{x}) = \\mathbb{P}(T > t \\mid \\mathbf{x}) = \\mathbb{P}(T_0 e^{\\mathbf{x}^\\top \\boldsymbol{\\beta}} > t) = \\mathbb{P}(T_0 > t e^{-\\mathbf{x}^\\top \\boldsymbol{\\beta}}) = S_0(t e^{-\\mathbf{x}^\\top \\boldsymbol{\\beta}}) $$\nThe statement claims $S(t \\mid \\mathbf{x}) = S_0\\!\\big(t \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})\\big)$. This has the wrong sign in the exponent. This form would imply that a positive coefficient $\\beta_j$ shortens survival, which is contrary to the typical interpretation of the AFT model (where it \"accelerates\" or stretches time).\nConsequently, the expression for the residual is also incorrect. The correct true residual is $R_i = -\\log S(T_i \\mid \\mathbf{x}_i) = -\\log S_0(T_i e^{-\\mathbf{x}_i^\\top \\boldsymbol{\\beta}})$. Let $H_0(t) = -\\log S_0(t)$ be the baseline cumulative hazard. Then $R_i = H_0(T_i e^{-\\mathbf{x}_i^\\top \\boldsymbol{\\beta}})$. The statement gives an incorrect formula $R_i = H_0\\!\\big(T_i \\exp(\\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}})\\big)$ which uses the wrong sign and mixes estimated parameters ($\\hat{\\boldsymbol{\\beta}}$) with a statement about the true model. While a correctly defined residual is $\\mathrm{Exponential}(1)$, the entire chain of reasoning presented in this option is flawed.\n\nVerdict: **Incorrect**.\n\n**C. With independent right censoring, using $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$ yields residuals that are right-censored at $\\hat R_i$ whenever $\\delta_i = 0$, and the Kaplan–Meier estimator of the residual survival should approximately follow $\\exp(-r)$ if the model is correctly specified.**\n\nWhen an observation is right-censored, we observe $\\tilde T_i = C_i$ and know that the true event time $T_i > C_i$. The calculated residual is $\\hat R_i = -\\log \\hat S(C_i \\mid \\mathbf{x}_i)$. The true, unobserved residual is $R_i^* = -\\log \\hat S(T_i \\mid \\mathbf{x}_i)$. Since $T_i > C_i$ and the survival function $\\hat S$ is decreasing, we have $\\hat S(T_i \\mid \\mathbf{x}_i)  \\hat S(C_i \\mid \\mathbf{x}_i)$. Taking the negative logarithm reverses the inequality: $R_i^* > \\hat R_i$. This means that for a censored observation, the calculated residual $\\hat R_i$ is a lower bound for the true event residual $R_i^*$. This is the definition of right-censoring for the residuals. The censoring indicator $\\delta_i$ applies to the residuals as well.\nSince the true residuals $R_i$ follow an $\\mathrm{Exponential}(1)$ distribution (with survival function $S(r) = e^{-r}$), the set of calculated residuals $\\{\\hat R_i, \\delta_i\\}$ forms a right-censored sample from a distribution that is approximately $\\mathrm{Exponential}(1)$. To check this, one can compute the Kaplan-Meier estimator of the survival function from this censored sample. If the model is correctly specified, this empirical survival curve should closely follow the theoretical $\\mathrm{Exponential}(1)$ survival curve, $S(r) = e^{-r}$. This is a standard graphical diagnostic technique for survival models.\n\nVerdict: **Correct**.\n\n**D. Because time is modeled on the log scale in an AFT model, the appropriate Cox-Snell residual is $R_i = -\\log \\hat S(\\log T_i \\mid \\mathbf{x}_i)$, which is $\\mathrm{Normal}(0,1)$ under correct specification.**\n\nThe definition of the Cox-Snell residual is $H(\\tilde T \\mid \\mathbf{x}) = -\\log S(\\tilde T \\mid \\mathbf{x})$, where $H$ and $S$ are the cumulative hazard and survival functions defined on the original time scale $t$. The argument must be a time, so evaluating $\\hat S$ at $\\log T_i$ is incorrect; the domain of $\\hat S$ is time, not log-time. Secondly, as established, the distribution of correctly defined Cox-Snell residuals is $\\mathrm{Exponential}(1)$, not $\\mathrm{Normal}(0,1)$. Residuals on the log-time scale, like $\\log T_i - \\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}}$, might be expected to be normal if the error term $\\epsilon_i$ was assumed to follow a normal distribution, but these are not Cox-Snell residuals. This statement confuses different types of residuals and their properties.\n\nVerdict: **Incorrect**.\n\n**E. If the baseline time-to-event distribution is $\\mathrm{Weibull}$ with shape parameter $k$, then the Cox-Snell residuals have a $\\mathrm{Gamma}(k,1)$ distribution under correct specification.**\n\nThe general derivation via the PIT shows that the Cox-Snell residuals $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ are distributed as $\\mathrm{Exponential}(1)$ regardless of the baseline distribution, as long as it is continuous. We can verify this for the Weibull case. Let the baseline be $T_0 \\sim \\mathrm{Weibull}(\\lambda_0, k)$, so $S_0(t) = \\exp(-(\\lambda_0 t)^k)$. The conditional survival is $S(t \\mid \\mathbf{x}) = S_0(t e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}}) = \\exp(-(\\lambda_0 t e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})^k)$. The residual is $R = -\\log S(T \\mid \\mathbf{x}) = (\\lambda_0 T e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})^k$. We know $T$ given $\\mathbf{x}$ follows a Weibull distribution with shape $k$ and scale $(\\lambda_0 e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})^{-1}$. Let $Y = T \\cdot (\\lambda_0 e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})$. The random variable $Y$ follows a standard Weibull distribution with shape $k$ and scale $1$, so its survival function is $\\mathbb{P}(Yy) = \\exp(-y^k)$. The residual is $R = Y^k$.\nThe CDF of $R$ is $\\mathbb{P}(R \\le r) = \\mathbb{P}(Y^k \\le r) = \\mathbb{P}(Y \\le r^{1/k}) = 1 - \\exp(-(r^{1/k})^k) = 1 - \\exp(-r)$.\nThis is the CDF of an $\\mathrm{Exponential}(1)$ distribution, which is a $\\mathrm{Gamma}(1,1)$ distribution. The statement claims the distribution is $\\mathrm{Gamma}(k,1)$, which is only true for the special case $k=1$ (i.e., an exponential baseline). For any other shape parameter $k \\ne 1$, the claim is false. The distribution is invariant.\n\nVerdict: **Incorrect**.", "answer": "$$\\boxed{AC}$$", "id": "4949812"}]}