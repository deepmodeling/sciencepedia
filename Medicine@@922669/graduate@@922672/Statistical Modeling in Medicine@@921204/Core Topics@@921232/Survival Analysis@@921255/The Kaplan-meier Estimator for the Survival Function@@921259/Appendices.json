{"hands_on_practices": [{"introduction": "Before we can estimate a survival curve, we must first translate raw patient data into a structured format suitable for analysis. This foundational exercise guides you through creating a summary table from a list of observed times and statuses. You will practice identifying unique event times and, for each one, determining the number of subjects at risk ($Y_j$), the number of events ($d_j$), and the number of individuals censored between events, which are the essential inputs for the Kaplan-Meier calculation [@problem_id:1961488].", "problem": "A clinical trial is conducted to evaluate the efficacy of a new drug, \"Neurostabil,\" in preventing the recurrence of a neurological symptom. Fifteen subjects participate in the study, which is planned for a duration of 12 months. For each subject, the data is recorded as a pair `(time, status)`, where `time` is the number of months until either the symptom recurs (an event) or the subject is censored, and `status` is an indicator variable (1 for an event, 0 for censored). A subject is censored if they drop out of the study or if the study ends before they experience an event.\n\nThe data for the 15 subjects are as follows:\n(3, 1), (5, 1), (12, 0), (7, 1), (4, 0), (9, 1), (7, 1), (10, 0), (11, 1), (12, 0), (3, 1), (7, 1), (8, 0), (5, 0), (9, 1)\n\nTo prepare for a Kaplan-Meier survival analysis, you are asked to summarize this data. Let $t_1  t_2  \\dots  t_k$ be the sequence of unique, ordered event times. For each distinct event time $t_j$ (where $j=1, \\dots, k$), we define the following quantities:\n- $Y_j$: The number of subjects at risk just prior to time $t_j$. A subject is considered at risk if they have not yet had an event or been censored before time $t_j$.\n- $d_j$: The number of subjects who experience an event at time $t_j$.\n- $c_j$: The number of subjects who are censored in the time interval $[t_{j-1}, t_j)$, where $t_0 = 0$.\n\nDetermine the sequence of triples $(Y_j, d_j, c_j)$ for all distinct event times. Present your answer as a matrix where the $j$-th row contains the triple for the $j$-th event time.", "solution": "We have a total of 15 subjects. Let the distinct ordered event times be $t_{1}t_{2}\\dotst_{k}$. From the data, the times with events (status equal to 1) are $3,5,7,9,11$. Sorting and counting multiplicities gives:\n- $t_{1}=3$ with $d_{1}=2$ events,\n- $t_{2}=5$ with $d_{2}=1$ event,\n- $t_{3}=7$ with $d_{3}=3$ events,\n- $t_{4}=9$ with $d_{4}=2$ events,\n- $t_{5}=11$ with $d_{5}=1$ event.\nThus $k=5$ and $(d_{1},d_{2},d_{3},d_{4},d_{5})=(2,1,3,2,1)$.\n\nCensoring times (status equal to 0) are $4,5,8,10,12,12$. By definition, for each $j$, $c_{j}$ counts the number censored in the interval $[t_{j-1},t_{j})$, where $t_{0}=0$. Therefore:\n- $c_{1}$ counts censoring in $[0,3)$: none, so $c_{1}=0$.\n- $c_{2}$ counts censoring in $[3,5)$: time $4$ only, so $c_{2}=1$.\n- $c_{3}$ counts censoring in $[5,7)$: time $5$ only, so $c_{3}=1$.\n- $c_{4}$ counts censoring in $[7,9)$: time $8$ only, so $c_{4}=1$.\n- $c_{5}$ counts censoring in $[9,11)$: time $10$ only, so $c_{5}=1$.\nCensorings at time $12$ lie in $[11,\\infty)$ and thus do not contribute to any $c_{j}$ for $j=1,\\dots,5$.\n\nBy definition, $Y_{j}$ is the number at risk just prior to $t_{j}$. Using $n=15$ and the recursive update that removes events at $t_{j-1}$ and censorings in $[t_{j-1},t_{j})$, we have:\n$$\nY_{1}=n-c_{1}=15-0=15,\n$$\nand for $j\\geq 2$,\n$$\nY_{j}=Y_{j-1}-d_{j-1}-c_{j}.\n$$\nCompute successively:\n- $Y_{2}=Y_{1}-d_{1}-c_{2}=15-2-1=12$,\n- $Y_{3}=Y_{2}-d_{2}-c_{3}=12-1-1=10$,\n- $Y_{4}=Y_{3}-d_{3}-c_{4}=10-3-1=6$,\n- $Y_{5}=Y_{4}-d_{4}-c_{5}=6-2-1=3$.\n\nCollecting $(Y_{j},d_{j},c_{j})$ for $j=1,\\dots,5$ in the order of event times $t_{j}=(3,5,7,9,11)$ yields the matrix with rows\n$(15,2,0)$, $(12,1,1)$, $(10,3,1)$, $(6,2,1)$, $(3,1,1)$.", "answer": "$$\\boxed{\\begin{pmatrix}\n15  2  0 \\\\\n12  1  1 \\\\\n10  3  1 \\\\\n6  2  1 \\\\\n3  1  1\n\\end{pmatrix}}$$", "id": "1961488"}, {"introduction": "Once survival data is organized, we can compute the Kaplan-Meier survival function, $\\hat{S}(t)$. This practice demonstrates the core product-limit formula, where the estimated survival probability is updated at each event time based on the proportion of individuals who survive that time point. You will gain hands-on experience applying this formula and see how to handle practical complexities like ties between event and censoring times [@problem_id:4806038].", "problem": "A randomized clinical study follows $n=5$ independent patients under right-censoring. For patient $i$, let $T_i$ denote the true event time and $C_i$ denote the censoring time, and define the observed pair $(Y_i,\\delta_i)$ by $Y_i=\\min\\{T_i,C_i\\}$ and $\\delta_i=\\mathbf{1}\\{T_i \\leq C_i\\}$. Assume non-informative right-censoring, meaning the event time is independent of the censoring time and censoring does not alter the distribution of $T_i$. The observed data are $(Y_i,\\delta_i)$ equal to $(2,1)$, $(4,0)$, $(4,1)$, $(6,1)$, $(7,0)$.\n\nStarting from the definition of the survival function $S(t)=\\mathbb{P}(Tt)$ and the principle that the survival function can be expressed as a product of conditional survival probabilities across observed event times under independent right-censoring, derive the nonparametric estimator of $S(t)$ based on the risk set and event counts at each distinct observed event time. In the presence of ties between event and censoring times, treat events as occurring before censorings at the same time when forming the at-risk counts.\n\nCompute the estimated survival $\\hat{S}(t)$ at each distinct event time present in the dataset, and report the values in increasing order of the event times $t=2$, $t=4$, and $t=6$. Provide exact values as fractions with no rounding.", "solution": "The problem is valid as it is scientifically grounded in the principles of survival analysis, well-posed with all necessary data and assumptions, and objectively stated. It presents a standard application of the Kaplan-Meier method for estimating a survival function from right-censored data.\n\nThe survival function, $S(t)$, is defined as the probability that the event time $T$ is greater than some time $t$:\n$$S(t) = \\mathbb{P}(T  t)$$\nThe Kaplan-Meier method provides a non-parametric estimate of this function from observed data that may be censored. The core principle is to express the survival function as a product of conditional probabilities over the observed event times.\n\nLet $t_{(1)}  t_{(2)}  \\dots  t_{(k)}$ be the $k$ distinct event times observed in the sample. The probability of surviving past a time $t$, where $t_{(j)} \\le t  t_{(j+1)}$, is equivalent to the probability of surviving past the last observed event time, $t_{(j)}$. This can be expressed using the chain rule of probability:\n$$\nS(t) = \\mathbb{P}(T  t_{(j)}) = \\mathbb{P}(T  t_{(1)} \\text{ and } T  t_{(2)} \\text{ and } \\dots \\text{ and } T  t_{(j)})\n$$\n$$\nS(t) = \\mathbb{P}(T  t_{(1)}) \\times \\mathbb{P}(T  t_{(2)} | T  t_{(1)}) \\times \\dots \\times \\mathbb{P}(T  t_{(j)} | T  t_{(j-1)})\n$$\nThis can be written in product form as:\n$$S(t) = \\prod_{i: t_{(i)} \\le t} \\mathbb{P}(T  t_{(i)} | T  t_{(i-1)}), \\quad \\text{with } t_{(0)} = 0$$\nEach term $\\mathbb{P}(T  t_{(i)} | T  t_{(i-1)})$ is the conditional probability of surviving past time $t_{(i)}$, given survival up to that point. This can be rewritten as $1 - \\mathbb{P}(T = t_{(i)} | T \\ge t_{(i)})$, where the latter term is the conditional probability of an event at $t_{(i)}$, i.e., the hazard at that time.\n\nUnder the assumption of non-informative censoring, we can estimate this conditional probability from the data. We define the following quantities for each distinct event time $t_{(i)}$:\n- The risk set, $R(t_{(i)})$, is the set of all individuals who are still under observation just prior to time $t_{(i)}$.\n- The number at risk, $n_i$, is the size of the risk set, $n_i = |R(t_{(i)})| = |\\{j: Y_j \\ge t_{(i)}\\}|$.\n- The number of events, $d_i$, is the number of individuals who experience the event at time $t_{(i)}$, $d_i = |\\{j: Y_j = t_{(i)}, \\delta_j = 1\\}|$.\n\nThe estimate for the conditional probability of an event at $t_{(i)}$ is the proportion $\\frac{d_i}{n_i}$. Consequently, the estimated conditional probability of surviving past $t_{(i)}$ is $1 - \\frac{d_i}{n_i}$.\n\nSubstituting these estimates into the product form gives the Kaplan-Meier product-limit estimator for the survival function:\n$$\\hat{S}(t) = \\prod_{i: t_{(i)} \\le t} \\left(1 - \\frac{d_i}{n_i}\\right)$$\nBy convention, $\\hat{S}(0) = 1$. The survival function estimate is a step function that is constant between event times and changes value only at the observed event times.\n\nNow, we apply this to the given data. The total number of patients is $n=5$. The observed data pairs $(Y_i, \\delta_i)$ are $(2,1), (4,0), (4,1), (6,1), (7,0)$.\nThe distinct observed times are $2, 4, 6, 7$. The event times (where $\\delta_i=1$) are $t=2, 4, 6$.\n\nWe construct a life table to organize the calculation:\n\n**1. Time interval $t \\in [0, 2)$**\nThe initial number of patients at risk is $n=5$. No events have occurred.\n$\\hat{S}(t) = 1$ for $t  2$.\n\n**2. First event time, $t=2$**\n- The number of individuals at risk just before time $t=2$ is $n_2 = 5$. All patients are still in the study.\n- The number of events at $t=2$ is $d_2 = 1$.\n- The conditional survival probability is $1 - \\frac{d_2}{n_2} = 1 - \\frac{1}{5} = \\frac{4}{5}$.\n- The estimated survival function at $t=2$ is $\\hat{S}(2) = \\hat{S}(0) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = 1 \\times \\frac{4}{5} = \\frac{4}{5}$.\n- After this time point, $1$ patient has had an event. The number of patients remaining at risk is $5 - 1 = 4$.\n\n**3. Second event time, $t=4$**\n- At time $t=4$, there is one event $(4,1)$ and one censoring $(4,0)$.\n- The number of individuals at risk just before time $t=4$ includes all those with observed times $Y_i \\ge 4$. These are the patients with data $(4,0), (4,1), (6,1), (7,0)$. Thus, the number at risk is $n_4 = 4$.\n- The number of events at $t=4$ is $d_4 = 1$.\n- Per the problem's tie-breaking rule, the event is processed before the censoring. The risk set $n_4=4$ correctly includes both individuals.\n- The conditional survival probability is $1 - \\frac{d_4}{n_4} = 1 - \\frac{1}{4} = \\frac{3}{4}$.\n- The estimated survival function at $t=4$ is $\\hat{S}(4) = \\hat{S}(2) \\times \\left(1 - \\frac{d_4}{n_4}\\right) = \\frac{4}{5} \\times \\frac{3}{4} = \\frac{3}{5}$.\n- After this time point, $1$ patient has had an event and $1$ has been censored. The number of patients remaining at risk is an initial $4$ minus $1$ event and $1$ censoring, leaving $4 - 1 - 1 = 2$.\n\n**4. Third event time, $t=6$**\n- The number of individuals at risk just before time $t=6$ includes those with observed times $Y_i \\ge 6$. These are the patients with data $(6,1)$ and $(7,0)$. Thus, the number at risk is $n_6 = 2$.\n- The number of events at $t=6$ is $d_6 = 1$.\n- The conditional survival probability is $1 - \\frac{d_6}{n_6} = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n- The estimated survival function at $t=6$ is $\\hat{S}(6) = \\hat{S}(4) \\times \\left(1 - \\frac{d_6}{n_6}\\right) = \\frac{3}{5} \\times \\frac{1}{2} = \\frac{3}{10}$.\n- After this time point, $1$ patient has had an event. The number remaining is $2 - 1 = 1$.\n\nThe final observation is a censoring at $t=7$. The survival estimate does not change at a censoring time, so $\\hat{S}(t) = \\frac{3}{10}$ for all $t \\ge 6$.\n\nThe requested values are the estimated survival probabilities at the distinct event times $t=2, 4, 6$.\n- $\\hat{S}(2) = \\frac{4}{5}$\n- $\\hat{S}(4) = \\frac{3}{5}$\n- $\\hat{S}(6) = \\frac{3}{10}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{3}{5}  \\frac{3}{10}\n\\end{pmatrix}\n}\n$$", "id": "4806038"}, {"introduction": "A point estimate for the survival curve is informative, but its utility in scientific inference depends on our ability to quantify its uncertainty. This final exercise moves from estimation to precision by introducing Greenwood's formula for the variance of the Kaplan-Meier estimator. Mastering this calculation is the key to constructing confidence intervals for the survival curve and is a critical step towards formal hypothesis testing [@problem_id:4989554].", "problem": "In a prospective clinical cohort, six patients are followed for time-to-event with right-censoring. For patient $i$, the observed pair is $(X_i,\\delta_i)$, where $X_i$ is the observed time and $\\delta_i \\in \\{0,1\\}$ indicates censoring ($\\delta_i=0$) or an event ($\\delta_i=1$). The data are\n$$(X,\\delta)=\\big((2,1),(3,0),(4,1),(5,1),(6,0),(7,1)\\big).$$\nAssume independent and identically distributed event times across patients and independent, non-informative right-censoring, so that the risk sets formed from the observed sample faithfully represent the conditional survival probabilities.\n\nStarting from the definition of the survival function $S(t)=\\mathbb{P}(Tt)$ and the factorization of survival into conditional survival probabilities across distinct event times, derive the product-limit estimator (Kaplan-Meier (KM) estimator) $\\hat{S}(t)$ evaluated at $t=5$ based on the observed risk sets and event counts. Then, using asymptotic variance theory grounded in the variance of multiplicative estimators under independent increments and a first-order delta method on $\\ln\\hat{S}(t)$, obtain Greenwood’s variance estimate for $\\hat{S}(5)$ and compute the associated standard error.\n\nReport two quantities:\n- Greenwood’s variance estimate of $\\hat{S}(5)$, and\n- the standard error of $\\hat{S}(5)$.\n\nRound both values to four significant figures. No units are required, and express any proportion as a decimal or fraction (do not use a percentage sign).", "solution": "The problem is well-posed and scientifically sound, providing a complete dataset and standard assumptions for estimating a survival function and its variance. We proceed with the solution.\n\nThe survival function, $S(t) = \\mathbb{P}(T  t)$, represents the probability that the time to event $T$ is greater than some time $t$. The Kaplan-Meier (KM) estimator, $\\hat{S}(t)$, provides a non-parametric estimate of $S(t)$ from time-to-event data that may be right-censored. It is a product-limit estimator based on conditional probabilities at each distinct event time.\n\nFirst, we organize the given data $(X_i,\\delta_i)$ for the $6$ patients:\n$$(X,\\delta)=\\big((2,1),(3,0),(4,1),(5,1),(6,0),(7,1)\\big).$$\nHere, $\\delta_i=1$ denotes an event and $\\delta_i=0$ denotes censoring. We must identify the distinct event times, $t_{(j)}$, and for each, determine the number of individuals at risk just prior to that time, $n_j$, and the number of events at that time, $d_j$. Let $N_0=6$ be the initial number of patients.\n\nThe distinct event times are $t=2$, $t=4$, $t=5$, and $t=7$.\nLet's construct a life table:\n\\begin{itemize}\n    \\item At event time $t_{(1)}=2$: The risk set includes all individuals who have not had an event or been censored before time $2$. All $6$ patients are at risk. Thus, $n_1=6$. One event occurs at this time, so $d_1=1$.\n    \\item A patient is censored at time $t=3$. This individual is removed from the risk set for subsequent event times.\n    \\item At event time $t_{(2)}=4$: The risk set consists of individuals with observed times $X_i \\ge 4$. The patient who had an event at $t=2$ and the patient censored at $t=3$ are removed from the initial $6$. Thus, $n_2 = 6 - 1 - 1 = 4$. One event occurs at $t=4$, so $d_2=1$.\n    \\item At event time $t_{(3)}=5$: The risk set consists of individuals with $X_i \\ge 5$. The patient who had an event at $t=4$ is removed from the previous risk set of $4$. Thus, $n_3 = 4 - 1 = 3$. One event occurs at $t=5$, so $d_3=1$.\n    \\item A patient is censored at time $t=6$. This individual is removed from the risk set.\n    \\item At event time $t_{(4)}=7$: The risk set consists of individuals with $X_i \\ge 7$. The patient who had an event at $t=5$ and the patient censored at $t=6$ are removed. Thus, $n_4=3-1-1=1$. One event occurs at $t=7$, so $d_4=1$.\n\\end{itemize}\n\nThe life table is summarized as:\n\n| Event Time $t_{(j)}$ | Number at Risk $n_j$ | Number of Events $d_j$ |\n|:--------------------:|:---------------------:|:-----------------------:|\n| 2                    | 6                     | 1                      |\n| 4                    | 4                     | 1                      |\n| 5                    | 3                     | 1                      |\n| 7                    | 1                     | 1                      |\n\nThe Kaplan-Meier estimator $\\hat{S}(t)$ is given by the product of conditional survival probabilities up to time $t$:\n$$ \\hat{S}(t) = \\prod_{j: t_{(j)} \\le t} \\left(1 - \\frac{d_j}{n_j}\\right) $$\nWe are asked to evaluate this at $t=5$. The event times less than or equal to $5$ are $t_{(1)}=2$, $t_{(2)}=4$, and $t_{(3)}=5$.\n$$ \\hat{S}(5) = \\left(1 - \\frac{d_1}{n_1}\\right) \\times \\left(1 - \\frac{d_2}{n_2}\\right) \\times \\left(1 - \\frac{d_3}{n_3}\\right) $$\nSubstituting the values from the life table:\n$$ \\hat{S}(5) = \\left(1 - \\frac{1}{6}\\right) \\times \\left(1 - \\frac{1}{4}\\right) \\times \\left(1 - \\frac{1}{3}\\right) = \\frac{5}{6} \\times \\frac{3}{4} \\times \\frac{2}{3} = \\frac{30}{72} = \\frac{5}{12} $$\n\nNext, we derive Greenwood's variance estimate for $\\hat{S}(5)$. The formula for the variance of the KM estimator is derived using the delta method on the log-transformed survival function, $\\ln(\\hat{S}(t))$. The variance of $\\ln(\\hat{S}(t))$ is approximated as the sum of the variances of the logarithms of the conditional survival probabilities, under the assumption of independent increments.\n$$ \\hat{V}(\\ln \\hat{S}(t)) \\approx \\sum_{j: t_{(j)} \\le t} \\frac{d_j}{n_j(n_j - d_j)} $$\nApplying the delta method again to transform back from $\\ln(\\hat{S}(t))$ to $\\hat{S}(t)$, we get Greenwood's formula:\n$$ \\hat{V}(\\hat{S}(t)) = [\\hat{S}(t)]^2 \\hat{V}(\\ln \\hat{S}(t)) = [\\hat{S}(t)]^2 \\sum_{j: t_{(j)} \\le t} \\frac{d_j}{n_j(n_j - d_j)} $$\nFor $t=5$, we need to compute the summation term for $j=1, 2, 3$:\n$$ \\sum_{j: t_{(j)} \\le 5} \\frac{d_j}{n_j(n_j - d_j)} = \\frac{d_1}{n_1(n_1 - d_1)} + \\frac{d_2}{n_2(n_2 - d_2)} + \\frac{d_3}{n_3(n_3 - d_3)} $$\n$$ = \\frac{1}{6(6-1)} + \\frac{1}{4(4-1)} + \\frac{1}{3(3-1)} $$\n$$ = \\frac{1}{30} + \\frac{1}{12} + \\frac{1}{6} $$\nTo sum these fractions, we find a common denominator, which is $60$:\n$$ = \\frac{2}{60} + \\frac{5}{60} + \\frac{10}{60} = \\frac{17}{60} $$\nNow we can compute the variance of $\\hat{S}(5)$:\n$$ \\hat{V}(\\hat{S}(5)) = [\\hat{S}(5)]^2 \\left(\\frac{17}{60}\\right) = \\left(\\frac{5}{12}\\right)^2 \\left(\\frac{17}{60}\\right) = \\frac{25}{144} \\times \\frac{17}{60} $$\nSimplifying the expression:\n$$ \\hat{V}(\\hat{S}(5)) = \\frac{25 \\times 17}{144 \\times 60} = \\frac{5 \\times 17}{144 \\times 12} = \\frac{85}{1728} $$\nAs a decimal, this is $85 \\div 1728 \\approx 0.0491898...$\nRounding to four significant figures, Greenwood's variance estimate is:\n$$ \\hat{V}(\\hat{S}(5)) \\approx 0.04919 $$\n\nThe standard error (SE) is the square root of the variance:\n$$ \\text{SE}(\\hat{S}(5)) = \\sqrt{\\hat{V}(\\hat{S}(5))} = \\sqrt{\\frac{85}{1728}} $$\nAs a decimal, this is $\\sqrt{0.0491898...} \\approx 0.2217877...$\nRounding to four significant figures, the standard error is:\n$$ \\text{SE}(\\hat{S}(5)) \\approx 0.2218 $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.04919  0.2218\n\\end{pmatrix}\n}\n$$", "id": "4989554"}]}