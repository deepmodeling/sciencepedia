{"hands_on_practices": [{"introduction": "A cornerstone of pharmacodynamics is the ability to quantitatively describe the relationship between drug concentration and its observed effect. This practice is designed to build this essential skill by using real-world data scenarios. You will apply nonlinear least-squares fitting, a powerful statistical method, to estimate the three critical parameters of the Hill equation: the maximal effect ($E_{\\max}$), potency ($EC_{50}$), and the Hill coefficient ($n$), which provides insight into the cooperativity of the drug-receptor interaction [@problem_id:4584147].", "problem": "You are tasked with estimating key pharmacodynamic parameters from effect versus concentration measurements using principles appropriate for Clinical Pharmacology and the principles of pharmacodynamics (PD). The scenario is rooted in receptor theory and the law of mass action, where a drugâ€™s effect arises from binding to a finite population of targets, the effect saturates as available targets become fully occupied, and the steepness of the concentration-effect relationship reflects cooperative interactions in binding or signaling. Starting from these foundational ideas, construct a nonlinear least-squares estimator for three parameters that characterize a saturable, monotonic, sigmoidal concentration-effect relationship: the maximal effect $E_{\\max}$, the half-maximal concentration $EC_{50}$, and the slope parameter often called the Hill coefficient $n$. The quantities $E_{\\max}$ and $EC_{50}$ must be strictly positive with physical units $E_{\\max}$ in arbitrary units (a.u.) of effect and $EC_{50}$ in $\\mathrm{mg}/\\mathrm{L}$, and the Hill coefficient $n$ must be strictly positive and dimensionless. The data below provide measured drug concentration (in $\\mathrm{mg}/\\mathrm{L}$) and observed effect (in a.u.), and your program must fit a three-parameter receptor-occupancy-consistent model derived from the law of mass action and the proportionality between effect and fractional occupancy, without assuming any linearization or transformation of the measurements.\n\nYour estimator must:\n1. Minimize the sum of squared residuals between the observed effect and the model-predicted effect at each given concentration.\n2. Enforce the constraints $E_{\\max} \\gt 0$, $EC_{50} \\gt 0$, and $n \\gt 0$ during optimization.\n3. Provide robust initial guesses derived from the data alone, without using any ground-truth parameters.\n4. Return the fitted parameters $E_{\\max}$ (in a.u.), $EC_{50}$ (in $\\mathrm{mg}/\\mathrm{L}$), and $n$ (dimensionless), each rounded to $3$ decimals.\n\nIn addition, quantitatively encode an interpretation of the Hill coefficient $n$ in terms of cooperative behavior using the following classification rule with a tolerance $\\tau = 0.05$: output $-1$ if $n \\lt 1 - \\tau$ (negative cooperativity), $0$ if $|n - 1| \\le \\tau$ (noncooperative), and $+1$ if $n \\gt 1 + \\tau$ (positive cooperativity). The classification code must be an integer.\n\nUse the following test suite comprising four independent datasets. For each dataset, concentrations are in $\\mathrm{mg}/\\mathrm{L}$ and effects are in a.u. Provide estimates for each dataset separately.\n\nDataset A (wide range, moderate slope):\n- Concentrations: $\\{0.25, 0.5, 1, 2, 4, 8, 16\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- Effects: $\\{3.828, 9.520, 21.710, 42.270, 65.880, 83.580, 93.070\\}$ a.u.\n\nDataset B (boundary near noncooperative):\n- Concentrations: $\\{0.05, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- Effects: $\\{4.545, 8.333, 14.286, 25.000, 33.333, 40.000, 45.455\\}$ a.u.\n\nDataset C (high cooperativity, steep transition):\n- Concentrations: $\\{0.10, 0.20, 0.50, 1.00, 2.00, 3.00, 5.00, 10.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- Effects: $\\{0.008, 0.128, 4.706, 40.000, 75.294, 79.024, 79.872, 79.992\\}$ a.u.\n\nDataset D (poor saturation within observed range):\n- Concentrations: $\\{1.00, 2.00, 5.00, 10.00, 20.00, 50.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- Effects: $\\{0.891, 1.765, 4.286, 8.182, 15.000, 30.000\\}$ a.u.\n\nAngle units are not applicable. The final outputs must be expressed strictly in the units specified above.\n\nYour program must produce a single line of output containing the results as a nested comma-separated list of quadruples, one quadruple per dataset, each of the form $[E_{\\max}, EC_{50}, n, \\text{coop\\_code}]$. The entire output must be enclosed in square brackets, and every floating-point value must be rounded to $3$ decimals. For example, an output for two datasets would look like $[[e_{1},c_{1},n_{1},k_{1}],[e_{2},c_{2},n_{2},k_{2}]]$, where $e_{i}$, $c_{i}$, and $n_{i}$ are floats and $k_{i}$ is an integer.\n\nYour program must run deterministically and must not read any external input.", "solution": "The problem is to estimate the pharmacodynamic parameters of a drug from its measured concentration-effect relationship. The problem statement is scientifically sound, well-posed, and internally consistent. It accurately describes a standard task in clinical pharmacology, parameterizing a sigmoidal dose-response curve.\n\nThe foundational principle is the law of mass action applied to drug-receptor binding. The relationship between drug concentration $C$ and the resulting physiological effect $E$ is described by the Hill-Langmuir equation. This model assumes that the effect is proportional to the fraction of receptors occupied by the drug. For a system involving $n$ binding sites, the effect $E$ as a function of concentration $C$ is given by:\n$$\nE(C) = \\frac{E_{\\max} \\cdot C^n}{EC_{50}^n + C^n}\n$$\nThe three parameters to be determined are:\n1.  $E_{\\max}$: The maximal effect, representing the effect at saturating drug concentrations. It must be positive ($E_{\\max}  0$) and has units of effect (a.u.).\n2.  $EC_{50}$: The half-maximal effective concentration, which is the drug concentration that produces $50\\%$ of the maximal effect. It must be positive ($EC_{50}  0$) and has units of concentration ($\\mathrm{mg}/\\mathrm{L}$).\n3.  $n$: The Hill coefficient, a dimensionless parameter that describes the steepness of the curve and reflects the cooperativity of the drug-receptor interaction. It must be positive ($n  0$).\n\nThe estimation of these parameters, collectively denoted by the vector $\\theta = [E_{\\max}, EC_{50}, n]$, is performed using the method of nonlinear least-squares. This involves finding the parameter values that minimize the sum of squared residuals (SSR) between the observed effect data $E_{\\text{obs},i}$ and the model-predicted effect $E(C_i, \\theta)$ at each corresponding concentration $C_i$. The objective function to be minimized is:\n$$\n\\text{SSR}(\\theta) = \\sum_{i=1}^{N} \\left[E_{\\text{obs},i} - E(C_i, \\theta)\\right]^2 = \\sum_{i=1}^{N} \\left[E_{\\text{obs},i} - \\frac{E_{\\max} \\cdot C_i^n}{EC_{50}^n + C_i^n}\\right]^2\n$$\nThis optimization problem is solved numerically. The `scipy.optimize.curve_fit` function, which implements the Levenberg-Marquardt algorithm, is an appropriate and robust tool for this task.\n\nA critical aspect of nonlinear optimization is the provision of good initial guesses for the parameters. Based on the properties of the Hill equation, we can derive these guesses directly from the data:\n-   **Initial guess for $E_{\\max}$ ($E_{\\max,0}$)**: A reasonable starting point is the maximum observed effect in the dataset, $E_{\\max,0} = \\max(E_{\\text{obs}})$. This is a robust choice, although it may be an underestimate if the data do not show full saturation.\n-   **Initial guess for $EC_{50}$ ($EC_{50,0}$)**: By definition, $EC_{50}$ is the concentration at which the effect is half-maximal. Thus, a logical guess is the concentration $C_i$ from the dataset where the corresponding observed effect $E_{\\text{obs},i}$ is closest to $E_{\\max,0} / 2$.\n-   **Initial guess for $n$ ($n_0$)**: A neutral and common starting value for the Hill coefficient is $n_0 = 1$, which corresponds to the non-cooperative Michaelis-Menten model.\n\nThe problem mandates the physical constraints $E_{\\max}  0$, $EC_{50}  0$, and $n  0$. These are enforced by providing lower bounds of $0$ for all three parameters to the `curve_fit` function.\n\nFinally, the fitted Hill coefficient $n$ is interpreted in terms of binding cooperativity. Using the specified tolerance $\\tau = 0.05$, the classification is as follows:\n-   Negative cooperativity (code $-1$): $n  1 - \\tau = 0.95$.\n-   Noncooperative (code $0$): $|n - 1| \\le \\tau$, which is $0.95 \\le n \\le 1.05$.\n-   Positive cooperativity (code $+1$): $n  1 + \\tau = 1.05$.\n\nThe procedure is applied independently to each of the four provided datasets. For each dataset, the algorithm will:\n1.  Define the concentration and effect data arrays.\n2.  Calculate the initial parameter guesses ($p_0 = [E_{\\max,0}, EC_{50,0}, n_0]$).\n3.  Perform the constrained nonlinear least-squares fit using `curve_fit` to find the optimal parameters.\n4.  Classify the resulting Hill coefficient $n$ to determine the cooperativity code.\n5.  Format the final parameters ($E_{\\max}$, $EC_{50}$, $n$) rounded to $3$ decimal places, along with the integer cooperativity code, into the specified output structure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits a three-parameter Hill equation to pharmacodynamic data and classifies cooperativity.\n    \"\"\"\n    \n    # Define the Hill equation model for the concentration-effect relationship.\n    # The parameters are E_max, EC50, and n (Hill coefficient).\n    # Using np.asarray ensures inputs are arrays and handles C_safe**n correctly for scalars.\n    def hill_equation(C, E_max, EC50, n):\n        C_safe = np.asarray(C, dtype=float)\n        # To prevent 0**n issues for n0 (though n is constrained 0),\n        # we add a small epsilon. Since concentrations are positive, this has no effect.\n        # This also guards against potential warnings or DomainErrors in some math libraries.\n        numerator = E_max * (C_safe**n)\n        denominator = EC50**n + C_safe**n\n        # Avoid division by zero, although denominator is always  0 \n        # due to the bounds EC50  0.\n        return np.divide(numerator, denominator, out=np.zeros_like(numerator), where=denominator!=0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C\": np.array([0.25, 0.5, 1, 2, 4, 8, 16]),\n            \"E\": np.array([3.828, 9.520, 21.710, 42.270, 65.880, 83.580, 93.070])\n        },\n        {\n            \"C\": np.array([0.05, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00]),\n            \"E\": np.array([4.545, 8.333, 14.286, 25.000, 33.333, 40.000, 45.455])\n        },\n        {\n            \"C\": np.array([0.10, 0.20, 0.50, 1.00, 2.00, 3.00, 5.00, 10.00]),\n            \"E\": np.array([0.008, 0.128, 4.706, 40.000, 75.294, 79.024, 79.872, 79.992])\n        },\n        {\n            \"C\": np.array([1.00, 2.00, 5.00, 10.00, 20.00, 50.00]),\n            \"E\": np.array([0.891, 1.765, 4.286, 8.182, 15.000, 30.000])\n        }\n    ]\n\n    all_results = []\n    \n    # Process each dataset\n    for case in test_cases:\n        C_data = case[\"C\"]\n        E_data = case[\"E\"]\n\n        # 1. Generate robust initial guesses from the data.\n        #    - E_max_0: Maximum observed effect.\n        #    - EC50_0: Concentration where effect is closest to half of E_max_0.\n        #    - n_0: Neutral guess of 1.0 (non-cooperative).\n        E_max_0 = np.max(E_data)\n        if E_max_0 = 0: E_max_0 = 1.0 # Fallback for pathological data\n        \n        half_max_effect = E_max_0 / 2.0\n        # Find index of the effect value closest to half_max_effect\n        idx = np.argmin(np.abs(E_data - half_max_effect))\n        EC50_0 = C_data[idx]\n        if EC50_0 = 0: EC50_0 = np.mean(C_data) # Fallback\n\n        n_0 = 1.0\n        \n        p0 = [E_max_0, EC50_0, n_0]\n\n        # 2. Define the bounds for the parameters (Emax  0, EC50  0, n  0).\n        bounds = ([0, 0, 0], [np.inf, np.inf, np.inf])\n\n        # 3. Perform nonlinear least-squares fitting.\n        try:\n            popt, _ = curve_fit(hill_equation, C_data, E_data, p0=p0, bounds=bounds, maxfev=10000)\n            E_max_fit, EC50_fit, n_fit = popt\n        except RuntimeError:\n            # In case the fit fails, though it shouldn't for these datasets.\n            E_max_fit, EC50_fit, n_fit = np.nan, np.nan, np.nan\n\n        # 4. Classify the Hill coefficient for cooperativity.\n        tau = 0.05\n        if n_fit  1 - tau:\n            coop_code = -1\n        elif n_fit  1 + tau:\n            coop_code = 1\n        else:\n            coop_code = 0\n            \n        # 5. Store the formatted result quadruple.\n        # The formatting to 3 decimal places happens during string creation.\n        result_quad = [E_max_fit, EC50_fit, n_fit, coop_code]\n        all_results.append(result_quad)\n\n    # 6. Format the final output string as specified.\n    # Each sublist is formatted as a string with no spaces, e.g., '[1.234,5.678,9.012,1]'\n    # Then these strings are joined by commas and enclosed in outer brackets.\n    list_of_quad_strings = []\n    for quad in all_results:\n        # Format floats to 3 decimal places exactly for the output.\n        quad_str = f\"[{quad[0]:.3f},{quad[1]:.3f},{quad[2]:.3f},{quad[3]}]\"\n        list_of_quad_strings.append(quad_str)\n    \n    final_output_string = f\"[{','.join(list_of_quad_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n\n```", "id": "4584147"}, {"introduction": "In clinical practice, patients are often treated with multiple medications, making the understanding of drug-drug interactions paramount. This exercise delves into the foundational principles of competitive binding at the receptor level, a common mechanism for such interactions. By calculating the concentration of a partial agonist required to modulate the effect of a full agonist, you will gain a quantitative appreciation for how the relative affinities ($K_A$, $K_P$) and intrinsic efficacies ($\\varepsilon$) of competing ligands dictate the net physiological response [@problem_id:4584191].", "problem": "Consider a single receptor population with total receptor concentration $R_T$ in a well-mixed system at equilibrium. Two ligands bind to the same orthosteric site and compete for occupancy: a full agonist $A$ with equilibrium dissociation constant $K_A$ and a partial agonist $P$ with equilibrium dissociation constant $K_P$. Assume binding obeys the law of mass action, and let the efficacy per occupied receptor (intrinsic efficacy) be $\\varepsilon_A$ for the full agonist $A$ and $\\varepsilon_P$ for the partial agonist $P$. The observable effect $E$ arises from a stimulus that is directly proportional to the efficacy-weighted fractional receptor occupancy, so that the effect is proportional to $\\varepsilon_A$ times the fraction of receptors occupied by $A$ plus $\\varepsilon_P$ times the fraction of receptors occupied by $P$. This linear transduction assumption is valid when the downstream signaling is not saturated and the receptor reserve is negligible. Pharmacodynamics (PD) seeks to relate ligand concentration to effect via these receptor-level processes.\n\nA preparation is exposed to a fixed concentration of full agonist $A$ equal to $[A] = 10 \\ \\mathrm{nM}$, with $K_A = 5 \\ \\mathrm{nM}$. The partial agonist $P$ has $K_P = 20 \\ \\mathrm{nM}$. The intrinsic efficacies are $\\varepsilon_A = 1.00$ and $\\varepsilon_P = 0.30$. Determine the concentration $[P]$ of the partial agonist required to reduce the effect in the presence of $A$ to $0.60$ times the effect produced by $A$ alone at the same $[A]$ (and with $P$ absent).\n\nExpress your final answer for $[P]$ in nanomolar ($\\mathrm{nM}$). Round your answer to three significant figures.", "solution": "The user wants me to validate and solve a quantitative pharmacodynamics problem involving competitive receptor binding.\n\n### Step 1: Extract Givens\n-   Total receptor concentration: $R_T$\n-   System is well-mixed and at equilibrium.\n-   Ligand 1: Full agonist $A$.\n-   Ligand 2: Partial agonist $P$.\n-   Binding site: Both ligands compete for the same orthosteric site.\n-   Equilibrium dissociation constant for $A$: $K_A = 5 \\ \\mathrm{nM}$\n-   Equilibrium dissociation constant for $P$: $K_P = 20 \\ \\mathrm{nM}$\n-   Concentration of $A$: $[A] = 10 \\ \\mathrm{nM}$ (fixed)\n-   Intrinsic efficacy of $A$: $\\varepsilon_A = 1.00$\n-   Intrinsic efficacy of $P$: $\\varepsilon_P = 0.30$\n-   The observable effect $E$ is proportional to the efficacy-weighted fractional receptor occupancy.\n-   The goal is to find the concentration $[P]$ that makes the effect in the presence of both $A$ and $P$, denoted $E_{A+P}$, equal to $0.60$ times the effect produced by $A$ alone, denoted $E_A$. That is, $E_{A+P} = 0.60 \\cdot E_A$.\n-   The final answer for $[P]$ should be in nanomolar ($\\mathrm{nM}$) and rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the law of mass action and the Clark model of receptor occupancy, extended for two competitive ligands. The concepts of intrinsic efficacy, dissociation constants, and a linear stimulus-effect relationship are fundamental and standard principles in classical pharmacodynamics. All premises are scientifically sound.\n-   **Well-Posed**: The problem is self-contained. It provides all necessary parameters ($K_A$, $K_P$, $\\varepsilon_A$, $\\varepsilon_P$, $[A]$) and a clear target condition ($E_{A+P} = 0.60 \\cdot E_A$) to establish a solvable algebraic equation for the single unknown, $[P]$. A unique solution is expected.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased technical language. There are no subjective elements.\n-   **Other Flaws**: The problem does not violate any other validation criteria. It is not incomplete, contradictory, unrealistic, or ill-posed. The numerical values are plausible for drug-receptor interactions.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with a full solution.\n\nThe solution begins by deriving the expressions for receptor occupancy in a competitive binding scenario. At equilibrium, the binding of ligands $A$ and $P$ to the receptor $R$ is described by:\n$R + A \\rightleftharpoons RA$\n$R + P \\rightleftharpoons RP$\n\nThe dissociation constants are defined as:\n$$K_A = \\frac{[R][A]}{[RA]}$$\n$$K_P = \\frac{[R][P]}{[RP]}$$\nwhere $[R]$, $[A]$, $[P]$, $[RA]$, and $[RP]$ represent the molar concentrations of free receptors, free ligand $A$, free ligand $P$, agonist-receptor complexes, and partial-agonist-receptor-complexes, respectively.\n\nThe total concentration of receptors, $R_T$, is the sum of free and bound receptors:\n$$[R_T] = [R] + [RA] + [RP]$$\nFrom the definitions of the dissociation constants, we can express the concentrations of bound receptors in terms of the free receptor concentration $[R]$:\n$$[RA] = \\frac{[R][A]}{K_A}$$\n$$[RP] = \\frac{[R][P]}{K_P}$$\nSubstituting these into the conservation equation for receptors gives:\n$$[R_T] = [R] + \\frac{[R][A]}{K_A} + \\frac{[R][P]}{K_P} = [R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P} \\right)$$\nThe fractional occupancy of receptors by the full agonist $A$, denoted $f_A$, is the ratio of $[RA]$ to $[R_T]$:\n$$f_A = \\frac{[RA]}{[R_T]} = \\frac{\\frac{[R][A]}{K_A}}{[R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P} \\right)} = \\frac{\\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}}$$\nSimilarly, the fractional occupancy by the partial agonist $P$, denoted $f_P$, is:\n$$f_P = \\frac{[RP]}{[R_T]} = \\frac{\\frac{[R][P]}{K_P}}{[R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P} \\right)} = \\frac{\\frac{[P]}{K_P}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}}$$\nThe problem states that the effect $E$ is proportional to the efficacy-weighted sum of fractional occupancies. Let $k$ be the proportionality constant. The total effect in the presence of both ligands, $E_{A+P}$, is:\n$$E_{A+P} = k (\\varepsilon_A f_A + \\varepsilon_P f_P) = k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A} + \\varepsilon_P \\frac{[P]}{K_P}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}} \\right)$$\nThe effect of the agonist $A$ alone, $E_A$, is found by setting $[P]=0$ in the above expressions:\n$$f_{A, \\text{alone}} = \\frac{\\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A}}$$\n$$E_A = k (\\varepsilon_A f_{A, \\text{alone}}) = k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A}} \\right)$$\nThe problem requires us to find the concentration $[P]$ for which $E_{A+P} = 0.60 \\cdot E_A$:\n$$k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A} + \\varepsilon_P \\frac{[P]}{K_P}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}} \\right) = 0.60 \\cdot k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A}} \\right)$$\nThe proportionality constant $k$ cancels from both sides. To simplify the equation, let's define normalized concentrations: $a = \\frac{[A]}{K_A}$ and $p = \\frac{[P]}{K_P}$. The equation becomes:\n$$\\frac{\\varepsilon_A a + \\varepsilon_P p}{1 + a + p} = 0.60 \\left( \\frac{\\varepsilon_A a}{1 + a} \\right)$$\nWe can now substitute the given values. First, we calculate the values for $a$ and the right-hand side of the equation.\nGiven $[A] = 10 \\ \\mathrm{nM}$ and $K_A = 5 \\ \\mathrm{nM}$:\n$$a = \\frac{10}{5} = 2$$\nGiven $\\varepsilon_A = 1.00$:\n$$\\text{Right-Hand Side} = 0.60 \\left( \\frac{1.00 \\cdot 2}{1 + 2} \\right) = 0.60 \\left( \\frac{2}{3} \\right) = 0.40$$\nNow, we set the left-hand side equal to this value:\n$$\\frac{\\varepsilon_A a + \\varepsilon_P p}{1 + a + p} = 0.40$$\nSubstitute the known values for $\\varepsilon_A$, $\\varepsilon_P$, and $a$: $\\varepsilon_A=1.00$, $\\varepsilon_P=0.30$, and $a=2$.\n$$\\frac{(1.00)(2) + (0.30)p}{1 + 2 + p} = 0.40$$\n$$\\frac{2 + 0.30 p}{3 + p} = 0.40$$\nNow, we solve this algebraic equation for $p$:\n$$2 + 0.30 p = 0.40(3 + p)$$\n$$2 + 0.30 p = 1.2 + 0.40 p$$\nRearranging the terms to isolate $p$:\n$$2 - 1.2 = 0.40 p - 0.30 p$$\n$$0.8 = 0.10 p$$\n$$p = \\frac{0.8}{0.10} = 8$$\nFinally, we find the concentration $[P]$ using the definition of $p$ and the given value of $K_P = 20 \\ \\mathrm{nM}$:\n$$p = \\frac{[P]}{K_P} \\implies [P] = p \\cdot K_P$$\n$$[P] = 8 \\cdot 20 \\ \\mathrm{nM} = 160 \\ \\mathrm{nM}$$\nThe result is an integer, so rounding to three significant figures gives $160$. This is equivalent to $1.60 \\times 10^2$.", "answer": "$$\n\\boxed{160}\n$$", "id": "4584191"}, {"introduction": "The effect of a drug is often not directly and instantaneously coupled to its concentration in the body; rather, it is mediated through complex biological pathways that have their own intrinsic dynamics. This problem introduces the concept of indirect response models, which are crucial for describing drug effects that modulate the synthesis or degradation of an endogenous mediator. By analyzing a system where a drug inhibits the production of a response mediator, you will learn to predict the time course of the effect and the new steady-state response, providing a deeper understanding of the temporal aspects of pharmacodynamics [@problem_id:4584200].", "problem": "A pharmacodynamic (PD) indirect response model is considered in which a drug inhibits the zero-order production of a response mediator. The mediator amount is denoted by $R(t)$, the zero-order production rate constant by $k_{\\text{in}}$, and the first-order loss rate constant by $k_{\\text{out}}$. Prior to drug administration the system is at baseline, so that $R(0^{-})$ equals the drug-free steady state. At time $t=0$, a constant drug concentration $C$ is established and maintained thereafter. Drug effect on the production process follows a maximum inhibitory effect model with an inhibitory function $I(C)$ that depends on the maximum inhibitory effect $I_{\\max}$ and the concentration producing half-maximal inhibition $IC_{50}$.\n\nStarting from fundamental definitions for an indirect response with inhibition of input and mass balance for the response mediator, derive the time course $R(t)$ for $t \\ge 0$ under a constant concentration $C$, and use this to compute the following two quantities:\n- The time at which the mediator has achieved $95\\%$ of its total asymptotic change from baseline under the constant $C$ (define this as the operational \"time to steady state\"). Express the time in hours.\n- The fractional suppression of $R$ at steady state relative to baseline under the constant $C$ (expressed as a decimal fraction, not a percentage).\n\nUse the following parameter values: $k_{\\text{in}} = 50$ units$\\cdot$h$^{-1}$, $k_{\\text{out}} = 0.2$ h$^{-1}$, $I_{\\max} = 0.9$, $IC_{50} = 2$ mg$\\cdot$L$^{-1}$, and $C = 4$ mg$\\cdot$L$^{-1}$. Round your final numerical results to four significant figures. In your final answer, report both values as a single $1 \\times 2$ row vector in the order: time (hours), fractional suppression. Do not include units in the final answer box.", "solution": "The problem requires the derivation and analysis of a pharmacodynamic (PD) indirect response model where a drug inhibits the production of a response mediator.\n\nFirst, we establish the ordinary differential equation (ODE) governing the amount of the response mediator, $R(t)$. The rate of change of $R(t)$, denoted $\\frac{dR}{dt}$, is the difference between the rate of production (input) and the rate of loss (output).\n\nThe rate of production is given as a zero-order process with rate constant $k_{\\text{in}}$. This production is inhibited by a drug with a constant concentration $C$. The inhibitory effect is described by a maximum inhibitory effect ($I_{\\max}$) model, where the fractional inhibition is given by the function $I(C)$:\n$$I(C) = \\frac{I_{\\max} \\cdot C}{IC_{50} + C}$$\nThe inhibited rate of production is therefore $k_{\\text{in}} \\cdot (1 - I(C))$.\n\nThe rate of loss is a first-order process with rate constant $k_{\\text{out}}$. This rate is proportional to the current amount of the mediator, so the rate of loss is $k_{\\text{out}} \\cdot R(t)$.\n\nCombining these, the mass-balance ODE is:\n$$\\frac{dR(t)}{dt} = k_{\\text{in}} \\cdot (1 - I(C)) - k_{\\text{out}} \\cdot R(t)$$\n\nNext, we determine the initial condition, $R(0)$. The problem states that prior to drug administration ($t  0$), the system is at a drug-free steady state (baseline). In this state, $C=0$, so $I(C) = I(0) = 0$. At steady state, $\\frac{dR}{dt} = 0$. Let the baseline response be $R_{base}$. The ODE becomes:\n$$0 = k_{\\text{in}} \\cdot (1 - 0) - k_{\\text{out}} \\cdot R_{base}$$\nSolving for $R_{base}$ gives:\n$$R_{base} = \\frac{k_{\\text{in}}}{k_{\\text{out}}}$$\nSince the amount of the mediator $R$ cannot change instantaneously, the initial condition at $t=0$ is $R(0) = R_{base}$.\n\nNow we solve the ODE for $t \\ge 0$ with the constant drug concentration $C$. The ODE can be rearranged into the standard form for a first-order linear ODE:\n$$\\frac{dR(t)}{dt} + k_{\\text{out}} \\cdot R(t) = k_{\\text{in}} \\cdot (1 - I(C))$$\nThe right-hand side is constant for a given $C$. The general solution to this type of equation is the sum of a particular solution and the homogeneous solution.\nThe particular solution is the new steady state under the drug's influence, which we denote as $R_{ss,C}$. At this new steady state, $\\frac{dR}{dt} = 0$:\n$$0 = k_{\\text{in}} \\cdot (1 - I(C)) - k_{\\text{out}} \\cdot R_{ss,C}$$\nSolving for $R_{ss,C}$ yields:\n$$R_{ss,C} = \\frac{k_{\\text{in}} \\cdot (1 - I(C))}{k_{\\text{out}}} = R_{base} \\cdot (1 - I(C))$$\nThe homogeneous equation is $\\frac{dR}{dt} + k_{\\text{out}} \\cdot R(t) = 0$, which has the solution $A\\exp(-k_{\\text{out}}t)$ for some constant $A$.\nThe full solution is therefore:\n$$R(t) = R_{ss,C} + A \\exp(-k_{\\text{out}}t)$$\nWe find the constant $A$ using the initial condition $R(0) = R_{base}$:\n$$R(0) = R_{ss,C} + A \\exp(0) = R_{ss,C} + A$$\n$$A = R(0) - R_{ss,C} = R_{base} - R_{ss,C}$$\nSubstituting $A$ back into the general solution gives the explicit time course for the response mediator:\n$$R(t) = R_{ss,C} + (R_{base} - R_{ss,C}) \\exp(-k_{\\text{out}}t)$$\n\nNow we can compute the two requested quantities using the given parameter values: $k_{\\text{in}} = 50$ units$\\cdot$h$^{-1}$, $k_{\\text{out}} = 0.2$ h$^{-1}$, $I_{\\max} = 0.9$, $IC_{50} = 2$ mg$\\cdot$L$^{-1}$, and $C = 4$ mg$\\cdot$L$^{-1}$.\n\nFirst, we calculate the necessary intermediate values:\n$$R_{base} = \\frac{k_{\\text{in}}}{k_{\\text{out}}} = \\frac{50}{0.2} = 250 \\text{ units}$$\n$$I(C) = \\frac{I_{\\max} \\cdot C}{IC_{50} + C} = \\frac{0.9 \\cdot 4}{2 + 4} = \\frac{3.6}{6} = 0.6$$\n$$R_{ss,C} = R_{base} \\cdot (1 - I(C)) = 250 \\cdot (1 - 0.6) = 250 \\cdot 0.4 = 100 \\text{ units}$$\n\nThe first quantity is the time at which the mediator has achieved $95\\%$ of its total asymptotic change. The total change is from $R_{base}$ to $R_{ss,C}$. The change at time $t$ is $R(t) - R_{base}$. The total asymptotic change is $R_{ss,C} - R_{base}$. We seek the time $t_{95\\%}$ such that:\n$$R(t_{95\\%}) - R_{base} = 0.95 \\cdot (R_{ss,C} - R_{base})$$\nFrom our solution for $R(t)$, we can write:\n$$R(t) - R_{base} = (R_{ss,C} - R_{base}) - (R_{ss,C} - R_{base})\\exp(-k_{\\text{out}}t) = (R_{ss,C} - R_{base})(1 - \\exp(-k_{\\text{out}}t))$$\nEquating the two expressions for the change at $t_{95\\%}$:\n$$(R_{ss,C} - R_{base})(1 - \\exp(-k_{\\text{out}}t_{95\\%})) = 0.95 \\cdot (R_{ss,C} - R_{base})$$\nAssuming $R_{ss,C} \\neq R_{base}$, we can divide by this term:\n$$1 - \\exp(-k_{\\text{out}}t_{95\\%}) = 0.95$$\n$$\\exp(-k_{\\text{out}}t_{95\\%}) = 0.05$$\nTaking the natural logarithm of both sides:\n$$-k_{\\text{out}}t_{95\\%} = \\ln(0.05)$$\n$$t_{95\\%} = -\\frac{\\ln(0.05)}{k_{\\text{out}}}$$\nSubstituting the value for $k_{\\text{out}}$:\n$$t_{95\\%} = -\\frac{\\ln(0.05)}{0.2} = \\frac{\\ln(20)}{0.2} \\approx \\frac{2.99573227}{0.2} \\approx 14.978661 \\text{ h}$$\nRounding to four significant figures, the time is $14.98$ hours.\n\nThe second quantity is the fractional suppression of $R$ at steady state relative to baseline. This is defined as the reduction in $R$ from baseline divided by the baseline value.\n$$\\text{Fractional Suppression} = \\frac{R_{base} - R_{ss,C}}{R_{base}} = 1 - \\frac{R_{ss,C}}{R_{base}}$$\nUsing our expressions for $R_{base}$ and $R_{ss,C}$:\n$$\\text{Fractional Suppression} = 1 - \\frac{R_{base} \\cdot (1 - I(C))}{R_{base}} = 1 - (1 - I(C)) = I(C)$$\nThus, the fractional suppression at steady state is simply equal to the fractional inhibition of the production rate, $I(C)$.\nUsing our previously calculated value for $I(C)$:\n$$\\text{Fractional Suppression} = 0.6$$\nAs a decimal fraction expressed to four significant figures, this is $0.6000$.\n\nThe two final values are the time to $95\\%$ of steady-state effect, $14.98$ hours, and the fractional suppression at steady state, $0.6000$.", "answer": "$$\\boxed{\\begin{pmatrix} 14.98  0.6000 \\end{pmatrix}}$$", "id": "4584200"}]}