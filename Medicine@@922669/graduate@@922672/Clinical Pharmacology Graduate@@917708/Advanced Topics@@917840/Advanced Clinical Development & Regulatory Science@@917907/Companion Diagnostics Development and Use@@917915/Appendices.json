{"hands_on_practices": [{"introduction": "A cornerstone of companion diagnostic development is establishing its clinical validity—the ability to accurately distinguish between patient populations, such as responders and non-responders to a therapy. This practice [@problem_id:4542008] guides you through a fundamental analysis using the Receiver Operating Characteristic (ROC) curve. By modeling biomarker scores with normal distributions, you will derive an analytical expression for the Area Under the Curve (AUC), a key metric that quantifies the overall discriminatory power of the diagnostic test.", "problem": "A targeted oncology therapy requires a companion diagnostic to establish clinical validity for enriching patients likely to respond. A continuous biomarker score $S$ is produced by the companion diagnostic for each patient prior to treatment initiation. In a pivotal trial used to assess clinical validity, the binary clinical outcome $Y$ is defined as responder ($Y=1$) versus non-responder ($Y=0$). Under a large-sample regime and stable assay performance, it is reasonable to model the conditional distributions\n$$\nS \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2}), \\quad S \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2}),\n$$\nwith independent draws across patients and independence between draws from the two groups. The test positivity rule is that a patient is classified as positive for treatment if $S \\geq c$ for a threshold $c \\in \\mathbb{R}$.\n\nStarting only from the core definitions of sensitivity, specificity, and the Receiver Operating Characteristic (ROC) curve, derive an analytical expression for the area under the ROC curve (AUC) implied by the model above, expressed in terms of $\\mu_{1}, \\mu_{0}, \\sigma_{1}, \\sigma_{0}$. Then, using the parameter values $\\mu_{1}=2.0$, $\\sigma_{1}=0.6$, $\\mu_{0}=1.0$, and $\\sigma_{0}=0.5$, compute the numerical value of the AUC. Express the final AUC as a unitless number and round your answer to four significant figures.", "solution": "The problem requires the derivation of an analytical expression for the area under the Receiver Operating Characteristic (ROC) curve (AUC) for a specific probabilistic model and the subsequent computation of its numerical value.\n\nFirst, we establish the fundamental definitions based on the problem statement. A continuous biomarker score $S$ is modeled with conditional normal distributions based on the binary clinical outcome $Y$, where $Y=1$ indicates a responder and $Y=0$ indicates a non-responder.\n$$\nS \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})\n$$\n$$\nS \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})\n$$\nA test is considered positive if a patient's score $S$ is at or above a given threshold $c \\in \\mathbb{R}$, i.e., $S \\ge c$.\n\nThe performance of this diagnostic test at a threshold $c$ is quantified by its sensitivity and specificity. Sensitivity, also known as the True Positive Rate (TPR), is the probability that a responder is correctly classified as positive.\n$$\n\\text{TPR}(c) = P(S \\ge c \\mid Y=1)\n$$\nSpecificity is the probability that a non-responder is correctly classified as negative.\n$$\n\\text{Specificity}(c) = P(S  c \\mid Y=0)\n$$\nThe False Positive Rate (FPR) is defined as $1 - \\text{Specificity}$, which is the probability that a non-responder is incorrectly classified as positive.\n$$\n\\text{FPR}(c) = 1 - P(S  c \\mid Y=0) = P(S \\ge c \\mid Y=0)\n$$\nThe ROC curve is the parametric plot of $\\text{TPR}(c)$ versus $\\text{FPR}(c)$ as the threshold $c$ is varied over all possible real values. The AUC is the area under this curve.\n\nA fundamental and elegant result from statistical theory states that the AUC is equivalent to the probability that a randomly chosen individual from the positive group (responders, $Y=1$) will have a higher score than a randomly chosen individual from the negative group (non-responders, $Y=0$). Let $S_1$ denote the score for a random responder and $S_0$ denote the score for a random non-responder. Then, based on the problem's setup, $S_1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})$ and $S_0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$, and they are independent. The AUC can thus be expressed as:\n$$\n\\text{AUC} = P(S_1  S_0)\n$$\nThis identity can be rigorously shown by integrating the ROC curve. The AUC is $\\int_0^1 \\text{TPR} \\,d(\\text{FPR})$. Making a change of variables to the threshold $c$, and noting that as $c$ varies from $-\\infty$ to $+\\infty$, the FPR varies from $1$ to $0$:\n$$\n\\text{AUC} = \\int_{\\text{FPR}=1}^{\\text{FPR}=0} \\text{TPR}(c) \\, d(\\text{FPR}(c)) = \\int_{-\\infty}^{\\infty} \\text{TPR}(c) \\left(-\\frac{d(\\text{FPR}(c))}{dc}\\right) dc\n$$\nWith $\\text{FPR}(c) = \\int_c^\\infty f_0(s)ds$, where $f_0$ is the PDF of $S \\mid Y=0$, we have $-\\frac{d(\\text{FPR}(c))}{dc} = f_0(c)$. So,\n$$\n\\text{AUC} = \\int_{-\\infty}^{\\infty} P(S_1 \\ge c) f_0(c) dc = P(S_1  S_0)\n$$\nTo calculate this probability, we define a new random variable $D = S_1 - S_0$. Since $S_1$ and $S_0$ are independent normal random variables, their difference $D$ is also normally distributed.\nThe mean of $D$ is the difference of the means:\n$$\nE[D] = E[S_1] - E[S_0] = \\mu_{1} - \\mu_{0}\n$$\nThe variance of $D$, due to the independence of $S_1$ and $S_0$, is the sum of the variances:\n$$\n\\text{Var}(D) = \\text{Var}(S_1 - S_0) = \\text{Var}(S_1) + (-1)^{2}\\text{Var}(S_0) = \\sigma_{1}^{2} + \\sigma_{0}^{2}\n$$\nThus, the distribution of the difference is $D \\sim \\mathcal{N}(\\mu_{1} - \\mu_{0}, \\sigma_{1}^{2} + \\sigma_{0}^{2})$.\n\nThe AUC is the probability $P(D  0)$. To find this probability, we standardize the random variable $D$ to a standard normal variable $Z \\sim \\mathcal{N}(0, 1)$:\n$$\nZ = \\frac{D - E[D]}{\\sqrt{\\text{Var}(D)}} = \\frac{D - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\n$$\nThe inequality $D  0$ can be rewritten in terms of $Z$:\n$$\nZ  \\frac{0 - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}} \\implies Z  -\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\n$$\nLet $\\Phi(z)$ denote the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi(z) = P(Z \\le z)$. Using the property $P(Z  a) = 1 - \\Phi(a)$ and the symmetry property $\\Phi(-a) = 1 - \\Phi(a)$, it follows that $P(Z  -a) = \\Phi(a)$.\nTherefore, the AUC is:\n$$\n\\text{AUC} = P\\left(Z  -\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right) = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right)\n$$\nThis is the required analytical expression for the AUC in terms of the model parameters.\n\nNext, we substitute the given numerical values: $\\mu_{1}=2.0$, $\\sigma_{1}=0.6$, $\\mu_{0}=1.0$, and $\\sigma_{0}=0.5$.\nThe argument of the CDF $\\Phi$ is calculated as:\n$$\n\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}} = \\frac{2.0 - 1.0}{\\sqrt{(0.6)^{2} + (0.5)^{2}}} = \\frac{1.0}{\\sqrt{0.36 + 0.25}} = \\frac{1.0}{\\sqrt{0.61}}\n$$\nWe compute the numerical value of this argument:\n$$\n\\frac{1.0}{\\sqrt{0.61}} \\approx \\frac{1.0}{0.78102497} \\approx 1.28037\n$$\nFinally, we evaluate the standard normal CDF at this value:\n$$\n\\text{AUC} = \\Phi(1.28037) \\approx 0.899797\n$$\nRounding this result to four significant figures, as requested, gives $0.8998$.", "answer": "$$\n\\boxed{0.8998}\n$$", "id": "4542008"}, {"introduction": "While an ideal diagnostic is perfectly accurate, real-world companion diagnostics are imperfect, leading to patient misclassification. This practice [@problem_id:4541995] explores the profound impact of these imperfections on the interpretation of clinical trial results. You will model a scenario where a test with known sensitivity and specificity is used to select patients for a targeted therapy, and calculate how the inclusion of false-positive patients dilutes the true treatment effect, altering the observed relative risk.", "problem": "A Phase III randomized controlled trial evaluates a targeted kinase inhibitor that is hypothesized to reduce the 12-month progression risk only in patients harboring a specific oncogenic mutation. A Companion Diagnostic (CDx) is used to enroll patients who test positive for the mutation. The CDx is imperfect, inducing misclassification. Assume the following scientifically grounded quantities and relationships.\n\nFundamental base and core definitions to employ:\n- Bayes' theorem: for events $A$ and $B$ with $\\Pr(B) \\neq 0$, $\\Pr(A \\mid B) = \\frac{\\Pr(B \\mid A)\\Pr(A)}{\\Pr(B)}$.\n- Diagnostic sensitivity and specificity: sensitivity $\\mathrm{Se}$ is $\\Pr(\\text{test positive} \\mid \\text{truly biomarker-positive})$, specificity $\\mathrm{Sp}$ is $\\Pr(\\text{test negative} \\mid \\text{truly biomarker-negative})$.\n- Positive Predictive Value (PPV): $\\Pr(\\text{truly biomarker-positive} \\mid \\text{test positive})$.\n- Relative Risk (RR): for a treatment versus a control, $\\mathrm{RR} = \\frac{\\text{risk under treatment}}{\\text{risk under control}}$.\n\nTrial design and parameters:\n- The true biomarker prevalence in the screened population is $p = 0.3$.\n- The CDx sensitivity is $\\mathrm{Se} = 0.85$ and the specificity is $\\mathrm{Sp} = 0.90$.\n- Among truly biomarker-positive patients, the 12-month progression risk under control is $r_{1} = 0.35$.\n- Among truly biomarker-negative patients, the 12-month progression risk under control is $r_{0} = 0.12$.\n- The kinase inhibitor acts only in truly biomarker-positive patients, yielding a constant multiplicative effect on risk with treatment relative risk $\\mathrm{RR}_{t} = 0.55$ in that subgroup; there is no effect in truly biomarker-negative patients (relative risk equals $1$ in that subgroup).\n- Patients who test CDx-positive are randomized 1:1 to treatment or control; risk is evaluated over 12 months.\n\nStarting from Bayes' theorem and the definitions of sensitivity, specificity, Positive Predictive Value, and Relative Risk, derive a closed-form expression for the observed Relative Risk within the CDx-positive stratum, $\\mathrm{RR}_{\\text{obs}}$, that accounts for the composition of truly biomarker-positive and false-positive patients induced by the imperfect CDx. Then, using the numerical parameter values above, compute the numerical value of $\\mathrm{RR}_{\\text{obs}}$. Express your answer as a dimensionless ratio and round to four significant figures.", "solution": "The objective is to derive a closed-form expression for the observed Relative Risk, $\\mathrm{RR}_{\\text{obs}}$, in the stratum of patients who test positive with the Companion Diagnostic (CDx), and then to compute its numerical value.\n\nLet us define the following events:\n- $M^{+}$: The event that a patient is truly biomarker-positive.\n- $M^{-}$: The event that a patient is truly biomarker-negative.\n- $T^{+}$: The event that a patient tests positive with the CDx.\n- $T^{-}$: The event that a patient tests negative with the CDx.\n- $D$: The event that a patient experiences disease progression within $12$ months.\n- $Tr$: The event that a patient is randomized to the treatment arm.\n- $C$: The event that a patient is randomized to the control arm.\n\nThe problem provides the following parameters:\n- True biomarker prevalence: $\\Pr(M^{+}) = p = 0.3$. Consequently, $\\Pr(M^{-}) = 1 - p = 0.7$.\n- CDx sensitivity: $\\mathrm{Se} = \\Pr(T^{+} \\mid M^{+}) = 0.85$.\n- CDx specificity: $\\mathrm{Sp} = \\Pr(T^{-} \\mid M^{-}) = 0.90$. From this, we can deduce the false positive rate: $\\Pr(T^{+} \\mid M^{-}) = 1 - \\mathrm{Sp} = 1 - 0.90 = 0.10$.\n- Risk in truly positive patients on control: $r_{1} = \\Pr(D \\mid M^{+}, C) = 0.35$.\n- Risk in truly negative patients on control: $r_{0} = \\Pr(D \\mid M^{-}, C) = 0.12$.\n- Relative risk of treatment in truly positive patients: $\\mathrm{RR}_{t} = \\frac{\\Pr(D \\mid M^{+}, Tr)}{\\Pr(D \\mid M^{+}, C)} = 0.55$.\n- Relative risk of treatment in truly negative patients: $\\frac{\\Pr(D \\mid M^{-}, Tr)}{\\Pr(D \\mid M^{-}, C)} = 1$.\n\nThe observed Relative Risk, $\\mathrm{RR}_{\\text{obs}}$, is the ratio of progression risk in the treatment arm to the progression risk in the control arm, conditioned on patients being in the CDx-positive stratum ($T^{+}$).\n$$\n\\mathrm{RR}_{\\text{obs}} = \\frac{\\Pr(D \\mid T^{+}, Tr)}{\\Pr(D \\mid T^{+}, C)}\n$$\n\nFirst, we must characterize the composition of the CDx-positive ($T^{+}$) population. This population is a mixture of truly biomarker-positive patients (true positives) and truly biomarker-negative patients (false positives). The proportion of true positives among those who test positive is the Positive Predictive Value (PPV), denoted here as $\\pi_{\\text{PPV}}$.\n$$\n\\pi_{\\text{PPV}} = \\Pr(M^{+} \\mid T^{+})\n$$\nUsing Bayes' theorem and the law of total probability, we can express $\\pi_{\\text{PPV}}$ in terms of the given parameters. The denominator, $\\Pr(T^{+})$, is calculated as:\n$$\n\\Pr(T^{+}) = \\Pr(T^{+} \\mid M^{+})\\Pr(M^{+}) + \\Pr(T^{+} \\mid M^{-})\\Pr(M^{-})\n$$\nSubstituting the given definitions:\n$$\n\\Pr(T^{+}) = \\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp}) \\cdot (1 - p)\n$$\nThe PPV is then:\n$$\n\\pi_{\\text{PPV}} = \\Pr(M^{+} \\mid T^{+}) = \\frac{\\Pr(T^{+} \\mid M^{+})\\Pr(M^{+})}{\\Pr(T^{+})} = \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\n$$\nThe proportion of false positives in the CDx-positive group is $\\Pr(M^{-} \\mid T^{+}) = 1 - \\pi_{\\text{PPV}}$.\n\nNext, we derive the expression for the observed risk in the control arm, $R_{\\text{control, obs}} = \\Pr(D \\mid T^{+}, C)$. This is a weighted average of the risks for the true-positive and false-positive subgroups, where the weights are their respective proportions within the $T^{+}$ cohort.\n$$\nR_{\\text{control, obs}} = \\Pr(D \\mid M^{+}, C)\\Pr(M^{+} \\mid T^{+}) + \\Pr(D \\mid M^{-}, C)\\Pr(M^{-} \\mid T^{+})\n$$\nSubstituting the defined terms:\n$$\nR_{\\text{control, obs}} = r_{1} \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})\n$$\n\nSimilarly, we derive the expression for the observed risk in the treatment arm, $R_{\\text{treat, obs}} = \\Pr(D \\mid T^{+}, Tr)$.\nThe risk for a truly positive patient on treatment is $\\Pr(D \\mid M^{+}, Tr) = \\mathrm{RR}_{t} \\cdot \\Pr(D \\mid M^{+}, C) = \\mathrm{RR}_{t} \\cdot r_{1}$.\nThe risk for a truly negative patient on treatment is $\\Pr(D \\mid M^{-}, Tr) = 1 \\cdot \\Pr(D \\mid M^{-}, C) = r_{0}$.\nThe observed risk in the treatment arm is the weighted average:\n$$\nR_{\\text{treat, obs}} = \\Pr(D \\mid M^{+}, Tr)\\Pr(M^{+} \\mid T^{+}) + \\Pr(D \\mid M^{-}, Tr)\\Pr(M^{-} \\mid T^{+})\n$$\nSubstituting the defined terms:\n$$\nR_{\\text{treat, obs}} = (\\mathrm{RR}_{t} \\cdot r_{1}) \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})\n$$\n\nFinally, we can write the closed-form expression for the observed Relative Risk, $\\mathrm{RR}_{\\text{obs}}$:\n$$\n\\mathrm{RR}_{\\text{obs}} = \\frac{R_{\\text{treat, obs}}}{R_{\\text{control, obs}}} = \\frac{(\\mathrm{RR}_{t} \\cdot r_{1}) \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})}{r_{1} \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})}\n$$\nSubstituting the expression for $\\pi_{\\text{PPV}}$ yields the full closed-form expression in terms of the fundamental parameters:\n$$\n\\mathrm{RR}_{\\text{obs}} = \\frac{(\\mathrm{RR}_{t} \\cdot r_{1}) \\left(\\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right) + r_{0} \\left(1 - \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right)}{r_{1} \\left(\\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right) + r_{0} \\left(1 - \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right)}\n$$\nThis is the required closed-form expression.\n\nNow, we compute the numerical value using the provided parameters:\n$p = 0.3$, $\\mathrm{Se} = 0.85$, $\\mathrm{Sp} = 0.90$, $r_{1} = 0.35$, $r_{0} = 0.12$, $\\mathrm{RR}_{t} = 0.55$.\n\n1.  Calculate the probability of a positive test, $\\Pr(T^{+})$:\n    $$\n    \\Pr(T^{+}) = (0.85)(0.3) + (1 - 0.90)(1 - 0.3) = 0.255 + (0.10)(0.7) = 0.255 + 0.070 = 0.325\n    $$\n\n2.  Calculate the Positive Predictive Value, $\\pi_{\\text{PPV}}$:\n    $$\n    \\pi_{\\text{PPV}} = \\Pr(M^{+} \\mid T^{+}) = \\frac{\\Pr(T^{+} \\mid M^{+})\\Pr(M^{+})}{\\Pr(T^{+})} = \\frac{0.255}{0.325} = \\frac{51}{65}\n    $$\n    Thus, the proportion of false positives is $1 - \\pi_{\\text{PPV}} = 1 - \\frac{51}{65} = \\frac{14}{65}$.\n\n3.  Calculate the observed risk in the control arm ($R_{\\text{control, obs}}$):\n    $$\n    R_{\\text{control, obs}} = r_{1} \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}}) = (0.35)\\left(\\frac{51}{65}\\right) + (0.12)\\left(\\frac{14}{65}\\right)\n    $$\n    $$\n    R_{\\text{control, obs}} = \\frac{(0.35)(51) + (0.12)(14)}{65} = \\frac{17.85 + 1.68}{65} = \\frac{19.53}{65} \\approx 0.30046\n    $$\n\n4.  Calculate the observed risk in the treatment arm ($R_{\\text{treat, obs}}$):\n    $$\n    R_{\\text{treat, obs}} = (\\mathrm{RR}_{t} \\cdot r_{1}) \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}}) = ((0.55)(0.35))\\left(\\frac{51}{65}\\right) + (0.12)\\left(\\frac{14}{65}\\right)\n    $$\n    $$\n    R_{\\text{treat, obs}} = \\frac{(0.55)(0.35)(51) + (0.12)(14)}{65} = \\frac{(0.1925)(51) + 1.68}{65} = \\frac{9.8175 + 1.68}{65} = \\frac{11.4975}{65} \\approx 0.17688\n    $$\n\n5.  Calculate the observed Relative Risk ($\\mathrm{RR}_{\\text{obs}}$):\n    $$\n    \\mathrm{RR}_{\\text{obs}} = \\frac{R_{\\text{treat, obs}}}{R_{\\text{control, obs}}} = \\frac{11.4975/65}{19.53/65} = \\frac{11.4975}{19.53} \\approx 0.5886994367...\n    $$\nRounding to four significant figures, the observed Relative Risk is $0.5887$. This value is greater than the true relative risk in the biomarker-positive subgroup ($\\mathrm{RR}_{t} = 0.55$) due to the inclusion of false-positive patients who do not benefit from the treatment, thus diluting the observed treatment effect.", "answer": "$$\n\\boxed{0.5887}\n$$", "id": "4541995"}, {"introduction": "The journey of a companion diagnostic does not end with its initial validation; ensuring consistent performance across different manufacturing lots is a critical aspect of quality management. This exercise [@problem_id:4542006] places you in the role of a quality engineer tasked with setting tolerance limits for the assay. You will determine the maximum allowable systematic bias from lot-to-lot reagent variability that can be permitted while still guaranteeing that the diagnostic meets its required targets for sensitivity and specificity in the clinic.", "problem": "A biotechnology firm is developing a Companion Diagnostic (CDx) to identify patients eligible for a targeted therapy based on a continuous biomarker concentration measured in milligrams per liter. As part of quality management, Quality Control (QC) data show that the assay’s analytical imprecision can be approximated by a Gaussian error term with zero mean and standard deviation $\\sigma_{A}$. Biological variability of the biomarker among non-diseased and diseased populations is also approximated by Gaussian distributions with known means and standard deviations. A new reagent lot may introduce a constant calibration bias $\\delta$ (lot-to-lot variability) applied additively to every measurement.\n\nAssume the following scientifically plausible parameters inferred from QC and clinical validation studies:\n- Analytical imprecision: $\\sigma_{A} = 0.2$ mg/L.\n- Non-diseased population: true biomarker $X_{N} \\sim \\mathcal{N}(\\mu_{N}, \\sigma_{N}^{2})$ with $\\mu_{N} = 1.5$ mg/L and $\\sigma_{N} = 0.4$ mg/L.\n- Diseased population: true biomarker $X_{D} \\sim \\mathcal{N}(\\mu_{D}, \\sigma_{D}^{2})$ with $\\mu_{D} = 3.5$ mg/L and $\\sigma_{D} = 0.5$ mg/L.\n- Measured biomarker is $Y = X + \\epsilon_{A} + \\delta$, where $\\epsilon_{A} \\sim \\mathcal{N}(0, \\sigma_{A}^{2})$ is independent of $X$.\n- The CDx calls a patient “test-positive” when $Y \\geq T$ with a fixed decision threshold $T = 2.55$ mg/L.\n\nQuality management requires the CDx to maintain diagnostic sensitivity (probability of a positive test in the diseased population) of at least 0.95 and diagnostic specificity (probability of a negative test in the non-diseased population) of at least 0.98 even in the presence of lot bias $\\delta$.\n\nUsing only fundamental definitions of sensitivity and specificity as probabilities under the appropriate Gaussian models and the fact that independent Gaussian variances add, derive the largest allowable absolute lot bias $|\\delta|_{\\max}$ such that for any bias $\\delta$ with $|\\delta| \\leq |\\delta|_{\\max}$ both sensitivity $\\geq 0.95$ and specificity $\\geq 0.98$ are guaranteed. Round your final answer to three significant figures and express it in milligrams per liter (mg/L). The final answer must be a single real number.", "solution": "The problem requires finding the largest allowable absolute lot bias, denoted as $|\\delta|_{\\max}$, such that the companion diagnostic (CDx) maintains specified performance levels for sensitivity and specificity. The core of the solution involves modeling the distribution of the measured biomarker and using these models to derive the acceptable range for the bias $\\delta$.\n\nFirst, we define the statistical distributions of the measured biomarker, $Y$, for both the non-diseased and diseased populations. The measured value is given by the model $Y = X + \\epsilon_{A} + \\delta$, where $X$ is the true biomarker value, $\\epsilon_{A}$ is the Gaussian analytical error, and $\\delta$ is the constant lot bias. Since $X$ and $\\epsilon_{A}$ are independent Gaussian random variables, their sum is also a Gaussian random variable. The constant bias $\\delta$ shifts the mean of the distribution but does not affect its variance.\n\nFor the non-diseased population, the true biomarker level $X_N$ follows the distribution $\\mathcal{N}(\\mu_{N}, \\sigma_{N}^{2})$. The measured biomarker for this population, $Y_N = X_N + \\epsilon_{A} + \\delta$, will therefore follow a Gaussian distribution with mean $E[Y_N] = E[X_N] + E[\\epsilon_A] + \\delta = \\mu_N + 0 + \\delta = \\mu_N + \\delta$ and variance $\\text{Var}(Y_N) = \\text{Var}(X_N) + \\text{Var}(\\epsilon_A) = \\sigma_N^2 + \\sigma_A^2$. Let us denote this total variance as $\\sigma_{T,N}^2$.\nSo, $Y_N \\sim \\mathcal{N}(\\mu_N + \\delta, \\sigma_{T,N}^2)$, where $\\sigma_{T,N} = \\sqrt{\\sigma_N^2 + \\sigma_A^2}$.\n\nFor the diseased population, the true biomarker level $X_D$ follows the distribution $\\mathcal{N}(\\mu_{D}, \\sigma_{D}^{2})$. The measured biomarker for this population, $Y_D = X_D + \\epsilon_{A} + \\delta$, will similarly follow a Gaussian distribution with mean $E[Y_D] = E[X_D] + E[\\epsilon_A] + \\delta = \\mu_D + 0 + \\delta = \\mu_D + \\delta$ and variance $\\text{Var}(Y_D) = \\text{Var}(X_D) + \\text{Var}(\\epsilon_A) = \\sigma_D^2 + \\sigma_A^2$. Let us denote this total variance as $\\sigma_{T,D}^2$.\nSo, $Y_D \\sim \\mathcal{N}(\\mu_D + \\delta, \\sigma_{T,D}^2)$, where $\\sigma_{T,D} = \\sqrt{\\sigma_D^2 + \\sigma_A^2}$.\n\nNext, we express the diagnostic sensitivity and specificity as functions of the bias $\\delta$. Let $T$ be the decision threshold.\nDiagnostic sensitivity (Se) is the probability of a positive test ($Y \\geq T$) in the diseased population:\n$$ \\text{Se}(\\delta) = P(Y_D \\geq T) $$\nTo calculate this probability, we standardize the random variable $Y_D$:\n$$ \\text{Se}(\\delta) = P\\left(\\frac{Y_D - (\\mu_D + \\delta)}{\\sigma_{T,D}} \\geq \\frac{T - (\\mu_D + \\delta)}{\\sigma_{T,D}}\\right) = P\\left(Z \\geq \\frac{T - \\mu_D - \\delta}{\\sigma_{T,D}}\\right) $$\nwhere $Z \\sim \\mathcal{N}(0, 1)$ is the standard normal variable. In terms of the standard normal cumulative distribution function (CDF), $\\Phi(z) = P(Z \\leq z)$, this is:\n$$ \\text{Se}(\\delta) = 1 - \\Phi\\left(\\frac{T - \\mu_D - \\delta}{\\sigma_{T,D}}\\right) $$\n\nDiagnostic specificity (Sp) is the probability of a negative test ($Y  T$) in the non-diseased population:\n$$ \\text{Sp}(\\delta) = P(Y_N  T) $$\nStandardizing the random variable $Y_N$:\n$$ \\text{Sp}(\\delta) = P\\left(\\frac{Y_N - (\\mu_N + \\delta)}{\\sigma_{T,N}}  \\frac{T - (\\mu_N + \\delta)}{\\sigma_{T,N}}\\right) = P\\left(Z  \\frac{T - \\mu_N - \\delta}{\\sigma_{T,N}}\\right) $$\nIn terms of the CDF, this is:\n$$ \\text{Sp}(\\delta) = \\Phi\\left(\\frac{T - \\mu_N - \\delta}{\\sigma_{T,N}}\\right) $$\n\nNow, we apply the performance constraints: $\\text{Se}(\\delta) \\geq 0.95$ and $\\text{Sp}(\\delta) \\geq 0.98$.\n\nThe sensitivity constraint implies:\n$$ 1 - \\Phi\\left(\\frac{T - \\mu_D - \\delta}{\\sigma_{T,D}}\\right) \\geq 0.95 \\implies \\Phi\\left(\\frac{T - \\mu_D - \\delta}{\\sigma_{T,D}}\\right) \\leq 0.05 $$\nApplying the inverse CDF (quantile function), $\\Phi^{-1}$:\n$$ \\frac{T - \\mu_D - \\delta}{\\sigma_{T,D}} \\leq \\Phi^{-1}(0.05) $$\nSolving for $\\delta$, we find the lower bound for the allowable bias:\n$$ T - \\mu_D - \\delta \\leq \\sigma_{T,D} \\Phi^{-1}(0.05) \\implies \\delta \\geq T - \\mu_D - \\sigma_{T,D} \\Phi^{-1}(0.05) $$\nLet's call this lower bound $\\delta_{\\text{low}}$. A decreasing (more negative) bias $\\delta$ decreases the mean of $Y_D$, thus reducing sensitivity. This constraint correctly sets a lower limit on $\\delta$.\n\nThe specificity constraint implies:\n$$ \\Phi\\left(\\frac{T - \\mu_N - \\delta}{\\sigma_{T,N}}\\right) \\geq 0.98 $$\nApplying the inverse CDF:\n$$ \\frac{T - \\mu_N - \\delta}{\\sigma_{T,N}} \\geq \\Phi^{-1}(0.98) $$\nSolving for $\\delta$, we find the upper bound for the allowable bias:\n$$ T - \\mu_N - \\delta \\geq \\sigma_{T,N} \\Phi^{-1}(0.98) \\implies \\delta \\leq T - \\mu_N - \\sigma_{T,N} \\Phi^{-1}(0.98) $$\nLet's call this upper bound $\\delta_{\\text{high}}$. An increasing (more positive) bias $\\delta$ increases the mean of $Y_N$, increasing the false positive rate and thus reducing specificity. This constraint correctly sets an upper limit on $\\delta$.\n\nThe problem requires that the performance criteria are met for any $\\delta$ such that $|\\delta| \\leq |\\delta|_{\\max}$. This means the symmetric interval $[-|\\delta|_{\\max}, |\\delta|_{\\max}]$ must be contained within the allowable interval $[\\delta_{\\text{low}}, \\delta_{\\text{high}}]$. This requires two conditions:\n$1.$ $-|\\delta|_{\\max} \\geq \\delta_{\\text{low}} \\implies |\\delta|_{\\max} \\leq -\\delta_{\\text{low}}$\n$2.$ $|\\delta|_{\\max} \\leq \\delta_{\\text{high}}$\nCombining these, we get $|\\delta|_{\\max} = \\min(-\\delta_{\\text{low}}, \\delta_{\\text{high}})$.\n\nNow we substitute the given numerical values:\n- $\\mu_N = 1.5$ mg/L, $\\sigma_N = 0.4$ mg/L\n- $\\mu_D = 3.5$ mg/L, $\\sigma_D = 0.5$ mg/L\n- $\\sigma_A = 0.2$ mg/L\n- $T = 2.55$ mg/L\n\nFirst, calculate the total standard deviations:\n$\\sigma_{T,N} = \\sqrt{\\sigma_N^2 + \\sigma_A^2} = \\sqrt{(0.4)^2 + (0.2)^2} = \\sqrt{0.16 + 0.04} = \\sqrt{0.20}$ mg/L.\n$\\sigma_{T,D} = \\sqrt{\\sigma_D^2 + \\sigma_A^2} = \\sqrt{(0.5)^2 + (0.2)^2} = \\sqrt{0.25 + 0.04} = \\sqrt{0.29}$ mg/L.\n\nWe use the standard normal quantile values:\n$\\Phi^{-1}(0.05) \\approx -1.64485$\n$\\Phi^{-1}(0.98) \\approx 2.05374$\n\nCalculate $\\delta_{\\text{low}}$:\n$$ \\delta_{\\text{low}} = T - \\mu_D - \\sigma_{T,D} \\Phi^{-1}(0.05) \\approx 2.55 - 3.5 - \\sqrt{0.29} \\times (-1.64485) $$\n$$ \\delta_{\\text{low}} \\approx -0.95 - (0.538516) \\times (-1.64485) \\approx -0.95 + 0.88583 \\approx -0.06417 \\text{ mg/L} $$\n\nCalculate $\\delta_{\\text{high}}$:\n$$ \\delta_{\\text{high}} = T - \\mu_N - \\sigma_{T,N} \\Phi^{-1}(0.98) \\approx 2.55 - 1.5 - \\sqrt{0.20} \\times (2.05374) $$\n$$ \\delta_{\\text{high}} \\approx 1.05 - (0.447214) \\times (2.05374) \\approx 1.05 - 0.91845 \\approx 0.13155 \\text{ mg/L} $$\n\nThe allowable range for the bias is $\\delta \\in [-0.06417, 0.13155]$.\nWe need to find the largest $|\\delta|_{\\max}$ such that $[-|\\delta|_{\\max}, |\\delta|_{\\max}] \\subseteq [\\delta_{\\text{low}}, \\delta_{\\text{high}}]$.\n$|\\delta|_{\\max} = \\min(-\\delta_{\\text{low}}, \\delta_{\\text{high}}) = \\min(-(-0.06417), 0.13155) = \\min(0.06417, 0.13155)$.\nTherefore, $|\\delta|_{\\max} \\approx 0.06417$ mg/L.\n\nThe problem asks for the answer rounded to three significant figures.\n$|\\delta|_{\\max} \\approx 0.0642$ mg/L.", "answer": "$$\n\\boxed{0.0642}\n$$", "id": "4542006"}]}