{"hands_on_practices": [{"introduction": "The journey of a gene therapy from the lab to the patient involves careful quantification at every step. This first exercise bridges the gap between the prescribed clinical dose and the practical reality of drug preparation, where not all viral particles are therapeutically active and not all prepared material reaches the patient. By working through a mass-balance calculation, you will learn to account for critical manufacturing and delivery parameters, such as the full capsid fraction and infusion recovery, to determine the total number of vector particles required for administration [@problem_id:5017038].", "problem": "Adeno-Associated Virus (AAV) vectors for in vivo gene transfer are often dosed in vector genomes per kilogram ($\\mathrm{vg/kg}$), where a \"vector genome\" (vg) denotes one packaged single-stranded deoxyribonucleic acid (DNA) molecule within a full AAV capsid as quantified by a genome-specific assay. Consider a manufacturing lot characterized by a full capsid fraction $f_{\\mathrm{full}}$ (the fraction of total capsids that contain a packaged genome) and an infusion recovery fraction $r$ (the fraction of capsids loaded into the delivery system that are actually delivered into the patient; losses to dead volume and adsorption are $1 - r$). Assume the clinical target dose definition is the number of vector genomes actually delivered into the patient per kilogram of body mass.\n\nStarting only from the definitions above and mass balance, derive an expression for the total number of physical AAV particles that must be loaded into the syringe (i.e., capsids regardless of genome content) to achieve a target dose $D$ $\\mathrm{vg/kg}$ in a patient of body mass $W$ $\\mathrm{kg}$, given $f_{\\mathrm{full}}$ and $r$. Then evaluate this expression for $W = 68$ $\\mathrm{kg}$, $D = 2.5 \\times 10^{14}$ $\\mathrm{vg/kg}$, $f_{\\mathrm{full}} = 0.65$, and $r = 0.88$.\n\nRound your numerical result to three significant figures and express the final particle count in scientific notation as a count of particles (no unit symbols in the boxed answer).", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of biopharmaceutical manufacturing and clinical pharmacology for gene therapies, well-posed with sufficient and consistent information, and articulated with objective, formal language. The provided numerical values are plausible within the context of AAV gene therapy development. No flaws related to scientific unsoundness, incompleteness, or ambiguity are present. We may therefore proceed with a formal solution.\n\nLet the total number of physical AAV particles (capsids, both full and empty) that must be loaded into the syringe be denoted by $N_{\\text{total, loaded}}$.\nThe problem provides the following definitions and values:\n- The target dose, $D$, is the number of vector genomes (vg) actually delivered per kilogram of patient body mass.\n- The patient's body mass is $W$.\n- The full capsid fraction, $f_{\\text{full}}$, is the ratio of the number of vector genomes (full capsids) to the total number of physical particles in the drug product.\n- The infusion recovery fraction, $r$, is the fraction of loaded particles that are delivered to the patient.\n\nOur derivation proceeds by relating the final delivered dose to the initial loaded material through a series of logical steps based on these definitions.\n\nFirst, we determine the total number of vector genomes that must be delivered to the patient to meet the target dose. Let this quantity be $N_{\\text{vg, delivered}}$. Based on the definition of the target dose $D$ and the patient's mass $W$, this is:\n$$N_{\\text{vg, delivered}} = D \\times W$$\n\nSecond, we must account for losses during the infusion process. The recovery fraction $r$ quantifies the proportion of material that is successfully delivered. This fraction applies to the entire particle population, including the sub-population of full capsids (vector genomes). Let $N_{\\text{vg, loaded}}$ be the number of vector genomes loaded into the syringe. The number of vector genomes delivered is then related to the number loaded by:\n$$N_{\\text{vg, delivered}} = r \\times N_{\\text{vg, loaded}}$$\n\nBy combining these first two steps, we can determine the number of vector genomes that must be loaded into the syringe. We equate the expressions for $N_{\\text{vg, delivered}}$:\n$$D \\times W = r \\times N_{\\text{vg, loaded}}$$\nSolving for $N_{\\text{vg, loaded}}$ yields:\n$$N_{\\text{vg, loaded}} = \\frac{D \\times W}{r}$$\nThis expression gives the number of *full capsids* that need to be drawn into the syringe.\n\nThird, the problem asks for the *total number of physical particles* (capsids), not just the number of full capsids. This is where the full capsid fraction, $f_{\\text{full}}$, becomes necessary. The fraction $f_{\\text{full}}$ is defined as the ratio of full capsids to total capsids for the particle population loaded into the syringe:\n$$f_{\\text{full}} = \\frac{\\text{Number of full capsids (vector genomes) loaded}}{\\text{Total number of physical particles loaded}} = \\frac{N_{\\text{vg, loaded}}}{N_{\\text{total, loaded}}}$$\n\nFinally, we solve for the desired quantity, $N_{\\text{total, loaded}}$. Rearranging the equation above gives:\n$$N_{\\text{total, loaded}} = \\frac{N_{\\text{vg, loaded}}}{f_{\\text{full}}}$$\nWe now substitute our previously derived expression for $N_{\\text{vg, loaded}}$:\n$$N_{\\text{total, loaded}} = \\frac{1}{f_{\\text{full}}} \\left( \\frac{D \\times W}{r} \\right) = \\frac{D \\times W}{r \\times f_{\\text{full}}}$$\nThis is the final symbolic expression for the total number of physical AAV particles that must be loaded.\n\nNow, we evaluate this expression using the provided numerical values:\n- $D = 2.5 \\times 10^{14} \\, \\mathrm{vg/kg}$\n- $W = 68 \\, \\mathrm{kg}$\n- $f_{\\text{full}} = 0.65$\n- $r = 0.88$\n\nSubstituting these values into the derived formula:\n$$N_{\\text{total, loaded}} = \\frac{(2.5 \\times 10^{14}) \\times 68}{0.88 \\times 0.65}$$\nFirst, we compute the numerator:\n$$(2.5 \\times 10^{14}) \\times 68 = 170 \\times 10^{14} = 1.7 \\times 10^{16}$$\nNext, we compute the denominator:\n$$0.88 \\times 0.65 = 0.572$$\nNow, we perform the division:\n$$N_{\\text{total, loaded}} = \\frac{1.7 \\times 10^{16}}{0.572} \\approx 2.97199300699... \\times 10^{16}$$\nThe problem requires the result to be rounded to three significant figures. The fourth significant figure is $1$, so we round down.\n$$N_{\\text{total, loaded}} \\approx 2.97 \\times 10^{16}$$\nThis is the total number of physical AAV particles that must be loaded into the syringe to achieve the specified target dose.", "answer": "$$\\boxed{2.97 \\times 10^{16}}$$", "id": "5017038"}, {"introduction": "Beyond physical quantity, the true measure of a gene therapy is its biological activity, or potency, which can vary between manufacturing lots. This practice introduces the concept of an 'effective dose,' a crucial tool for normalizing clinical doses based on lot-specific transduction efficiency. Using a simplified but powerful model where each vector genome acts as an independent trial, you will derive how to adjust a clinical dose to reflect its true biological potential, a fundamental skill in ensuring consistent patient outcomes [@problem_id:4534399].", "problem": "A liver-directed gene therapy using Adeno-Associated Virus (AAV) vectors is dosed on a per body weight basis and quantified as vector genomes per kilogram ($\\mathrm{vg/kg}$). Let the clinical dose be denoted by $D$ (in $\\mathrm{vg/kg}$), and let the lot-specific transduction efficiency be denoted by $E$, defined as the fraction of administered vector genomes that result in productive transduction of target hepatocytes under clinical conditions. Assume the following fundamental base:\n- Each administered vector genome behaves as an independent trial with identical probability $E$ of productive transduction.\n- Within the clinically relevant dose range, the pharmacodynamic effect is proportional to the expected number of productive transductions.\n- The normalized effective dose $D_{\\mathrm{eff}}$ is defined as the expected number of productive transductions per kilogram that would be achieved by a reference lot with $E=1$, so that $D_{\\mathrm{eff}}$ adjusts $D$ for potency differences due to $E$ but retains the same physical unit ($\\mathrm{vg/kg}$).\n\nStarting only from these definitions and the properties of expectations for independent Bernoulli trials, derive an expression for $D_{\\mathrm{eff}}$ in terms of $D$ and $E$. Then evaluate $D_{\\mathrm{eff}}$ for $E=0.6$ and $D=1\\times 10^{13}$ $\\mathrm{vg/kg}$. Express the final numerical value in $\\mathrm{vg/kg}$, and provide the exact value with no rounding.", "solution": "The problem requires the derivation of an expression for the normalized effective dose, $D_{\\mathrm{eff}}$, and its subsequent calculation.\n\nLet $M$ be the body weight of a subject in kg. The total number of vector genomes administered is $N$. Given the dose $D$ in $\\mathrm{vg/kg}$, we have:\n$$N = D \\times M$$\nEach of these $N$ vector genomes is an independent trial. Let $X_i$ be a Bernoulli random variable representing the outcome for the $i$-th vector genome, for $i = 1, 2, ..., N$. We define $X_i=1$ if the genome results in a productive transduction and $X_i=0$ otherwise. The probability of success is given as the transduction efficiency, $E$.\n$$P(X_i = 1) = E$$\n$$P(X_i = 0) = 1 - E$$\nThe expected value of each individual trial is:\n$$\\mathbb{E}[X_i] = 1 \\cdot P(X_i=1) + 0 \\cdot P(X_i=0) = E$$\nThe total number of productive transductions in the subject is the sum of these random variables:\n$$T = \\sum_{i=1}^{N} X_i$$\nBy the linearity of expectation, the expected total number of productive transductions, $\\mathbb{E}[T]$, is:\n$$\\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} \\mathbb{E}[X_i] = \\sum_{i=1}^{N} E = N \\times E$$\nSubstituting the expression for $N$:\n$$\\mathbb{E}[T] = (D \\times M) \\times E$$\nThe problem concerns quantities normalized per kilogram of body weight. The expected number of productive transductions per kilogram is therefore $\\frac{\\mathbb{E}[T]}{M}$.\n$$ \\text{Expected transductions per kg} = \\frac{(D \\times M) \\times E}{M} = D \\times E $$\nNow, we apply the definition of the normalized effective dose, $D_{\\mathrm{eff}}$. The problem states that the pharmacodynamic effect is proportional to the expected number of productive transductions. The concept of an effective dose is to find the dose of a reference material that produces the same effect as a given dose of a test material.\n\n-   The effect of the test material, administered at dose $D$ with efficiency $E$, is proportional to $D \\times E$.\n-   The effect of the reference material, which has an efficiency $E_{\\mathrm{ref}}=1$, administered at dose $D_{\\mathrm{eff}}$, is proportional to $D_{\\mathrm{eff}} \\times E_{\\mathrm{ref}} = D_{\\mathrm{eff}} \\times 1 = D_{\\mathrm{eff}}$.\n\nTo have an equivalent effect, we must equate these quantities:\n$$D_{\\mathrm{eff}} = D \\times E$$\nThis expression is the derived relationship. It correctly adjusts the clinical dose $D$ by the potency factor $E$ and maintains the physical units of $D$ ($\\mathrm{vg/kg}$), as required by the problem statement.\n\nNow, we evaluate $D_{\\mathrm{eff}}$ for the given values:\n-   $D = 1 \\times 10^{13}\\ \\mathrm{vg/kg}$\n-   $E = 0.6$\n\nSubstituting these values into our derived expression:\n$$D_{\\mathrm{eff}} = (1 \\times 10^{13}) \\times 0.6$$\n$$D_{\\mathrm{eff}} = 0.6 \\times 10^{13}$$\nTo express this in standard scientific notation ($a \\times 10^b$ where $1 \\le |a| < 10$), we rewrite $0.6$ as $6 \\times 10^{-1}$:\n$$D_{\\mathrm{eff}} = (6 \\times 10^{-1}) \\times 10^{13} = 6 \\times 10^{13-1} = 6 \\times 10^{12}$$\nThe normalized effective dose is $6 \\times 10^{12}\\ \\mathrm{vg/kg}$.", "answer": "$$ \\boxed{6 \\times 10^{12}} $$", "id": "4534399"}, {"introduction": "Ultimately, the success of a gene therapy is assessed by measuring its effect in the patient, a process fraught with measurement noise and sampling variability. This advanced practice delves into the statistical analysis of clinical biopsy data, a core task for a clinical pharmacologist. You will learn how to convert a raw laboratory measurement—vector genomes per microgram of DNA—into a more direct biological endpoint, the fraction of transduced cells, and how to rigorously quantify the uncertainty in this estimate using both parametric (binomial) and non-parametric (bootstrap) statistical methods [@problem_id:4534370].", "problem": "A clinical gene therapy trial quantifies adeno-associated virus vector genomes in tissue biopsies as vector genomes per microgram deoxyribonucleic acid (DNA), denoted $G$ in units of $\\mathrm{genomes}/\\mu\\mathrm{g}$. The clinical pharmacology quantity of interest is the tissue transduction fraction $p$, defined as the probability that a randomly sampled diploid cell in the tissue is transduced. Assume the following widely accepted bases: the mass of a diploid human genome is approximately $m_{\\text{diploid}} = 6.6\\ \\mathrm{pg}$, so the number of diploid genomes per $\\mu\\mathrm{g}$ of DNA is $n = \\left\\lfloor \\frac{10^6\\ \\mathrm{pg}}{6.6\\ \\mathrm{pg}} + 0.5 \\right\\rfloor$ diploid genomes. Let $\\lambda$ denote the average vector genome copies per transduced cell. A measured $G$ thus corresponds to an estimated transduced cell count $k = \\left\\lfloor \\frac{G}{\\lambda} + 0.5 \\right\\rfloor$ among $n$ diploid genomes, which induces a binomial model for transduction with parameter $p$.\n\nYou are to compute two types of two-sided confidence intervals for $p$ at significance level $\\alpha$ (so confidence level $1-\\alpha$), for each test case below:\n\n- Binomial model interval: Treat $k$ as the number of successes in $n$ Bernoulli trials with success probability $p$, and compute the exact two-sided interval based on the binomial model. Ensure $k$ is clipped to the range $[0,n]$.\n- Bootstrap interval: Given a list of replicate measurements of $G$, perform a nonparametric bootstrap with $B$ resamples of the replicate set. In each resample, compute the resampled mean $\\bar{G}$, map it to a fraction $\\hat{p}_{\\text{resample}} = \\frac{\\bar{G}}{\\lambda\\,n}$, clip to $[0,1]$, and then take the $(\\alpha/2)$ and $(1-\\alpha/2)$ quantiles of the bootstrap distribution to form the interval.\n\nAll outputs for $p$ must be expressed as decimals (fractions), not using a percentage sign. The confidence interval endpoints must be rounded to six decimal places. There are no angle units. Physical units appear only in intermediate quantities ($\\mu\\mathrm{g}$ and $\\mathrm{pg}$ for DNA mass, and $\\mathrm{genomes}/\\mu\\mathrm{g}$ for $G$); the final reported intervals for $p$ are dimensionless fractions.\n\nTest suite parameter values (for each case, provide $G$, $\\lambda$, $\\alpha$, $B$, and the replicate list of $G$ values):\n\n- Case $1$: $G = 15000$, $\\lambda = 1$, $\\alpha = 0.05$, $B = 5000$, replicates $[14000, 16000, 15500, 15000, 14500]$.\n- Case $2$: $G = 50$, $\\lambda = 1$, $\\alpha = 0.05$, $B = 5000$, replicates $[0, 30, 70, 100, 50]$.\n- Case $3$: $G = 30000$, $\\lambda = 2$, $\\alpha = 0.05$, $B = 5000$, replicates $[28000, 31000, 29000]$.\n- Case $4$: $G = 140000$, $\\lambda = 1$, $\\alpha = 0.05$, $B = 5000$, replicates $[135000, 140000, 145000, 142000]$.\n- Case $5$: $G = 0$, $\\lambda = 1$, $\\alpha = 0.05$, $B = 5000$, replicates $[0, 0, 0]$.\n\nYour program must compute, for each case, two intervals:\n- The binomial-model interval for $p$ as $[L_{\\text{bin}}, U_{\\text{bin}}]$.\n- The bootstrap interval for $p$ as $[L_{\\text{boot}}, U_{\\text{boot}}]$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a four-element list in the order $[L_{\\text{bin}}, U_{\\text{bin}}, L_{\\text{boot}}, U_{\\text{boot}}]$, with each number rounded to six decimal places. For example, the output should look like $[[0.012345,0.067890,0.010000,0.070000],[\\dots],\\dots]$.", "solution": "The problem requires the computation of two types of two-sided confidence intervals for a tissue transduction fraction, $p$, based on measurements of vector genomes in tissue biopsies. The problem is well-posed, scientifically grounded, and provides all necessary parameters and methods.\n\nFirst, we establish a key constant: the number of diploid genomes, $n$, contained within one microgram ($1\\ \\mu\\mathrm{g}$) of deoxyribonucleic acid (DNA). Given that the mass of a single diploid human genome is $m_{\\text{diploid}} = 6.6\\ \\mathrm{pg}$ and $1\\ \\mu\\mathrm{g} = 10^6\\ \\mathrm{pg}$, we can calculate $n$ as the nearest integer to the ratio of these masses:\n$$n = \\left\\lfloor \\frac{10^6\\ \\mathrm{pg}}{6.6\\ \\mathrm{pg}} + 0.5 \\right\\rfloor = \\left\\lfloor 151515.15\\dots + 0.5 \\right\\rfloor = \\lfloor 151515.65\\dots \\rfloor = 151515$$\nThis value of $n = 151515$ represents the total number of cells (trials) in our statistical models.\n\nThe two intervals to be computed are a binomial model-based interval and a nonparametric bootstrap interval. Both will be calculated for a confidence level of $1-\\alpha$.\n\n### 1. Binomial Model Confidence Interval\n\nThis approach models the transduction of cells as a series of $n$ independent Bernoulli trials, where each trial corresponds to a single cell and has a success probability $p$ (the cell being transduced).\n\nThe number of \"successes\" (transduced cells), $k$, is estimated from the measured vector genome concentration $G$ (in $\\mathrm{genomes}/\\mu\\mathrm{g}$) and the average number of vector genomes per transduced cell, $\\lambda$. The total number of vector genomes in $1\\ \\mu\\mathrm{g}$ of DNA is $G$, and the total number of genomes from transduced cells is $k \\times \\lambda$. Equating these gives $k \\approx G/\\lambda$. The problem specifies using a round-to-nearest-integer rule:\n$$k = \\left\\lfloor \\frac{G}{\\lambda} + 0.5 \\right\\rfloor$$\nAs $k$ represents a count of cells out of a total of $n$, it must be constrained to the valid range $[0, n]$. So, $k$ is clipped: $k = \\max(0, \\min(n, k))$.\n\nGiven $k$ successes in $n$ trials, we compute the exact two-sided $(1-\\alpha)$ confidence interval for $p$, known as the Clopper-Pearson interval. This interval $[L_{\\text{bin}}, U_{\\text{bin}}]$ is constructed by inverting a two-sided binomial test.\n\nThe lower bound, $L_{\\text{bin}}$, is the value of $p$ for which the probability of observing $k$ or more successes is equal to $\\alpha/2$:\n$$P(X \\ge k | p=L_{\\text{bin}}) = \\sum_{i=k}^{n} \\binom{n}{i} L_{\\text{bin}}^i (1-L_{\\text{bin}})^{n-i} = \\frac{\\alpha}{2}$$\nThe upper bound, $U_{\\text{bin}}$, is the value of $p$ for which the probability of observing $k$ or fewer successes is equal to $\\alpha/2$:\n$$P(X \\le k | p=U_{\\text{bin}}) = \\sum_{i=0}^{k} \\binom{n}{i} U_{\\text{bin}}^i (1-U_{\\text{bin}})^{n-i} = \\frac{\\alpha}{2}$$\n\nThese equations can be solved using the quantiles of the Beta distribution, due to the relationship between the binomial cumulative distribution function (CDF) and the regularized incomplete beta function. The interval endpoints are:\n$$L_{\\text{bin}} = \\text{BetaInv}\\left(\\frac{\\alpha}{2}, k, n - k + 1\\right)$$\n$$U_{\\text{bin}} = \\text{BetaInv}\\left(1 - \\frac{\\alpha}{2}, k + 1, n - k\\right)$$\nwhere $\\text{BetaInv}(q, a, b)$ is the $q$-th quantile of a Beta distribution with shape parameters $a$ and $b$. Special edge cases are $L_{\\text{bin}}=0$ if $k=0$ and $U_{\\text{bin}}=1$ if $k=n$. These will be computed using the `scipy.stats.beta.ppf` function.\n\n### 2. Bootstrap Confidence Interval\n\nThis method uses the empirical distribution of a set of replicate measurements of $G$ to construct a confidence interval for $p$ without assuming an underlying binomial distribution for the cell counts. It is a data-driven, non-parametric approach.\n\nThe procedure is as follows:\n1.  Start with the list of replicate measurements of $G$.\n2.  Perform a large number of bootstrap iterations, $B$.\n3.  In each iteration $j=1, \\dots, B$:\n    a. Create a bootstrap resample by drawing $N$ values with replacement from the original list of $N$ replicates.\n    b. Compute the mean of this resample, $\\bar{G}_j$.\n    c. Convert this mean value to a bootstrap estimate of the transduction fraction, $\\hat{p}_j$, using the relationship $G = p \\lambda n$:\n    $$\\hat{p}_j = \\frac{\\bar{G}_j}{\\lambda n}$$\n    d. Clip the estimate to the valid probability range: $\\hat{p}_j = \\max(0, \\min(1, \\hat{p}_j))$.\n4.  The $B$ values of $\\hat{p}_j$ form an empirical probability distribution for $p$.\n5.  The percentile bootstrap interval, $[L_{\\text{boot}}, U_{\\text{boot}}]$, is formed by taking the quantiles of this distribution.\n    $$L_{\\text{boot}} = \\text{Quantile}(\\{\\hat{p}_j\\}_{j=1}^B, \\alpha/2)$$\n    $$U_{\\text{boot}} = \\text{Quantile}(\\{\\hat{p}_j\\}_{j=1}^B, 1 - \\alpha/2)$$\nThis procedure will be implemented using `numpy` for resampling and quantile calculation.\n\nFor each test case, we will compute these four values ($L_{\\text{bin}}, U_{\\text{bin}}, L_{\\text{boot}}, U_{\\text{boot}}$), round them to six decimal places, and format the output as specified.", "answer": "```\n[[0.098801,0.099329,0.095701,0.102300],[0.000257,0.000412,0.000000,0.000594],[0.098801,0.099329,0.093954,0.103009],[0.923869,0.924295,0.907503,0.940502],[0.000000,0.000024,0.000000,0.000000]]\n```", "id": "4534370"}]}