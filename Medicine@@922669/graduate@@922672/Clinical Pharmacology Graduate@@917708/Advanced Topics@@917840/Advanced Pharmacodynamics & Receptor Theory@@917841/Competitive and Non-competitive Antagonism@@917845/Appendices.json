{"hands_on_practices": [{"introduction": "This exercise takes us back to the foundational principles of receptor pharmacology. By applying the law of mass action to a scenario of competitive binding, you will derive the mathematical basis for the effect of a competitive antagonist on agonist potency. This practice is essential for understanding precisely why a competitive antagonist causes a rightward shift in the agonist's dose-response curve without depressing the maximum possible effect, establishing the theoretical cornerstone for all subsequent quantitative analysis [@problem_id:4542832].", "problem": "A full agonist $A$ produces a response in a tissue where there are no spare receptors, and the transduction from occupancy to response is linear such that the response $E$ is proportional to the fraction of receptors occupied by $A$. The agonist binds reversibly to a single class of non-interacting receptors with Hill coefficient $n_{H}=1$. In the absence of any antagonist, the half-maximal effective concentration (EC50) $EC_{50,0}$ equals the agonist equilibrium dissociation constant $K_{A}$. A reversible competitive antagonist $B$ with equilibrium dissociation constant $K_{B}$ is added at a fixed concentration $[B]$. Assume the Law of Mass Action applies to both $A$ and $B$ binding to the same site, and that there are no allosteric effects.\n\nGiven $K_{B} = 10$ nM and $[B] = 30$ nM, use first principles of receptor occupancy at equilibrium to derive the apparent half-maximal effective concentration in the presence of antagonist, $EC_{50,\\mathrm{app}}$, in terms of $EC_{50,0}$, $K_{B}$, and $[B]$. Then compute the numerical value of the fold-shift $r \\equiv \\dfrac{EC_{50,\\mathrm{app}}}{EC_{50,0}}$ for the given $K_{B}$ and $[B]$. Finally, determine whether the maximum effect changes by calculating the ratio $\\rho \\equiv \\dfrac{E_{\\max,\\mathrm{app}}}{E_{\\max,0}}$ under these assumptions.\n\nProvide exact values; no rounding is required. Report your final answer as a row matrix with two entries $\\big(r,\\ \\rho\\big)$, both dimensionless numbers without units.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the established principles of receptor pharmacology, specifically the model of reversible competitive antagonism. It is well-posed, with a complete and consistent set of definitions, assumptions, and data necessary to derive a unique solution. The language is objective and free of ambiguity.\n\nThe derivation begins from the first principles of receptor-ligand binding at equilibrium. Let $[R]$ be the concentration of free receptors, $[A]$ be the concentration of the agonist $A$, and $[B]$ be the concentration of the competitive antagonist $B$. The agonist and antagonist bind to the same receptor site.\n\nThe binding reactions are:\n$R + A \\rightleftharpoons RA$\n$R + B \\rightleftharpoons RB$\n\nThe equilibrium dissociation constants for the agonist ($K_A$) and antagonist ($K_B$) are defined by the Law of Mass Action:\n$$K_A = \\frac{[R][A]}{[RA]}$$\n$$K_B = \\frac{[R][B]}{[RB]}$$\n\nThe total concentration of receptors, $[R_T]$, is the sum of free receptors, agonist-bound receptors ($[RA]$), and antagonist-bound receptors ($[RB]$):\n$$[R_T] = [R] + [RA] + [RB]$$\n\nThe response $E$ is stated to be directly proportional to the fractional occupancy of receptors by the agonist, $p_A$. The fractional occupancy is defined as:\n$$p_A = \\frac{[RA]}{[R_T]}$$\n\nTo derive an expression for $p_A$, we first express $[R]$ and $[RB]$ in terms of $[RA]$ and constants. From the definition of $K_A$, we have $[R] = \\frac{K_A [RA]}{[A]}$. From the definition of $K_B$, we have $[RB] = \\frac{[R][B]}{K_B}$. Substituting the expression for $[R]$ into the expression for $[RB]$ yields:\n$$[RB] = \\frac{\\left(\\frac{K_A [RA]}{[A]}\\right)[B]}{K_B} = [RA]\\frac{K_A [B]}{K_B [A]}$$\n\nNow we substitute the expressions for $[R]$ and $[RB]$ into the total receptor conservation equation:\n$$[R_T] = \\frac{K_A [RA]}{[A]} + [RA] + [RA]\\frac{K_A [B]}{K_B [A]}$$\n\nFactoring out $[RA]$:\n$$[R_T] = [RA] \\left( 1 + \\frac{K_A}{[A]} + \\frac{K_A [B]}{K_B [A]} \\right)$$\n\nThe fractional occupancy $p_A$ is therefore:\n$$p_A = \\frac{[RA]}{[R_T]} = \\frac{1}{1 + \\frac{K_A}{[A]} + \\frac{K_A [B]}{K_B [A]}}$$\n\nTo simplify this expression, multiply the numerator and denominator by $[A]$:\n$$p_A = \\frac{[A]}{[A] + K_A + \\frac{K_A [B]}{K_B}}$$\n\nThis can be rearranged into a more standard form:\n$$p_A = \\frac{[A]}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + [A]}$$\n\nThe pharmacological response $E$ is proportional to $p_A$. Let $E_{\\max}$ be the maximum possible response, which occurs when $p_A = 1$. Given the linear transduction, we have $E = E_{\\max} \\cdot p_A$.\n$$E = E_{\\max} \\frac{[A]}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + [A]}$$\n\nIn the absence of the antagonist, $[B]=0$. The response is $E_0$:\n$$E_0 = E_{\\max,0} \\frac{[A]}{K_A + [A]}$$\nThe half-maximal effective concentration in the absence of antagonist, $EC_{50,0}$, is the concentration $[A]$ at which $E_0 = \\frac{1}{2} E_{\\max,0}$.\n$$\\frac{1}{2} E_{\\max,0} = E_{\\max,0} \\frac{EC_{50,0}}{K_A + EC_{50,0}} \\implies \\frac{1}{2} = \\frac{EC_{50,0}}{K_A + EC_{50,0}}$$\n$$K_A + EC_{50,0} = 2 \\cdot EC_{50,0} \\implies K_A = EC_{50,0}$$\nThis confirms the condition given in the problem statement.\n\nNow we determine the apparent maximum effect, $E_{\\max,\\mathrm{app}}$, in the presence of the antagonist. This is the limit of the response $E$ as $[A] \\rightarrow \\infty$:\n$$E_{\\max,\\mathrm{app}} = \\lim_{[A] \\to \\infty} E_{\\max} \\frac{[A]}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + [A]}$$\nDividing the numerator and denominator by $[A]$:\n$$E_{\\max,\\mathrm{app}} = E_{\\max} \\lim_{[A] \\to \\infty} \\frac{1}{\\frac{K_A}{[A]} \\left(1 + \\frac{[B]}{K_B}\\right) + 1} = E_{\\max} \\left(\\frac{1}{0 + 1}\\right) = E_{\\max}$$\nSince the intrinsic maximum response $E_{\\max}$ is a property of the agonist-receptor system, it is the same as $E_{\\max,0}$. Thus, $E_{\\max,\\mathrm{app}} = E_{\\max,0}$. A reversible competitive antagonist does not change the maximum effect. The ratio $\\rho$ is therefore:\n$$\\rho \\equiv \\frac{E_{\\max,\\mathrm{app}}}{E_{\\max,0}} = \\frac{E_{\\max,0}}{E_{\\max,0}} = 1$$\n\nNext, we derive the apparent half-maximal effective concentration, $EC_{50,\\mathrm{app}}$. This is the agonist concentration $[A]$ that produces half of the maximum response $E_{\\max,\\mathrm{app}}$ in the presence of the antagonist.\n$$E = \\frac{1}{2} E_{\\max,\\mathrm{app}} = \\frac{1}{2} E_{\\max}$$\nSubstituting this into the response equation with the antagonist:\n$$\\frac{1}{2} E_{\\max} = E_{\\max} \\frac{EC_{50,\\mathrm{app}}}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + EC_{50,\\mathrm{app}}}$$\n$$\\frac{1}{2} = \\frac{EC_{50,\\mathrm{app}}}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + EC_{50,\\mathrm{app}}}$$\n$$K_A \\left(1 + \\frac{[B]}{K_B}\\right) + EC_{50,\\mathrm{app}} = 2 \\cdot EC_{50,\\mathrm{app}}$$\n$$EC_{50,\\mathrm{app}} = K_A \\left(1 + \\frac{[B]}{K_B}\\right)$$\nSubstituting $EC_{50,0}$ for $K_A$, we obtain the desired expression:\n$$EC_{50,\\mathrm{app}} = EC_{50,0} \\left(1 + \\frac{[B]}{K_B}\\right)$$\nThis is a form of the Gaddum-Schild equation.\n\nThe fold-shift, $r$, is defined as the ratio $\\frac{EC_{50,\\mathrm{app}}}{EC_{50,0}}$.\n$$r \\equiv \\frac{EC_{50,\\mathrm{app}}}{EC_{50,0}} = \\frac{EC_{50,0} \\left(1 + \\frac{[B]}{K_B}\\right)}{EC_{50,0}} = 1 + \\frac{[B]}{K_B}$$\n\nWe are given $K_B = 10$ nM and $[B] = 30$ nM. We can now compute the numerical value of $r$. The units (nM) cancel out.\n$$r = 1 + \\frac{30}{10} = 1 + 3 = 4$$\n\nThe two dimensionless numbers required are $r = 4$ and $\\rho = 1$.", "answer": "$$\\boxed{\\begin{pmatrix} 4 & 1 \\end{pmatrix}}$$", "id": "4542832"}, {"introduction": "Moving from pure theory to practical data interpretation, this problem simulates the analysis of a typical experimental dataset. You will work with agonist concentrations required to achieve specific effects, both with and without an antagonist present. This exercise [@problem_id:4542830] challenges you to first verify the hallmark of competitive antagonism—a constant dose ratio across different effect levels, which signifies a parallel shift—before proceeding to calculate the antagonist's equilibrium dissociation constant, $K_B$.", "problem": "A full agonist $A$ acts at a single receptor population with a Hill coefficient approximately $1$ (unitary slope) and produces a maximal effect $E_{\\max}$. In the absence of antagonist, the concentration of $A$ required to produce fractional effects $E/E_{\\max} \\in \\{0.2, 0.5, 0.8\\}$ are $[A]_{0.2} = 2.5\\,\\text{nM}$, $[A]_{0.5} = 10\\,\\text{nM}$, and $[A]_{0.8} = 40\\,\\text{nM}$, respectively. In the presence of a fixed concentration of a reversible antagonist $B$ at $[B] = 64\\,\\text{nM}$, the concentrations of $A$ required to achieve the same fractional effects are $[A]'_{0.2} = 16\\,\\text{nM}$, $[A]'_{0.5} = 64\\,\\text{nM}$, and $[A]'_{0.8} = 256\\,\\text{nM}$. Assume mass-action equilibrium binding, a single homogeneous receptor class, no spare receptors, and that the observed effect is directly proportional to agonist receptor occupancy under these conditions.\n\nUsing only fundamental definitions and equilibrium reasoning:\n- Compute the dose ratio at each effect level, defined as $\\text{DR}(E) = \\dfrac{[A]'_{E}}{[A]_{E}}$.\n- On the basis of your computations and the assumed mechanism, assess whether the rightward shifts are parallel and consistent with competitive antagonism.\n- Under the assumption that the interaction is purely competitive, estimate the antagonist equilibrium dissociation constant $K_{B}$.\n\nExpress the final answer as the single numerical value of $K_{B}$ in $\\text{nM}$, rounded to three significant figures.", "solution": "The problem will be validated against the required criteria before a solution is attempted.\n\n### Step 1: Extract Givens\n- Agonist: $A$, a full agonist.\n- Receptor characteristics: Single population, Hill coefficient approximately $1$.\n- Maximal effect: $E_{\\max}$.\n- Data in the absence of antagonist:\n  - For fractional effect $E/E_{\\max} = 0.2$, the agonist concentration is $[A]_{0.2} = 2.5\\,\\text{nM}$.\n  - For fractional effect $E/E_{\\max} = 0.5$, the agonist concentration is $[A]_{0.5} = 10\\,\\text{nM}$.\n  - For fractional effect $E/E_{\\max} = 0.8$, the agonist concentration is $[A]_{0.8} = 40\\,\\text{nM}$.\n- Antagonist: $B$, a reversible antagonist.\n- Antagonist concentration: $[B] = 64\\,\\text{nM}$ (fixed).\n- Data in the presence of antagonist:\n  - For fractional effect $E/E_{\\max} = 0.2$, the agonist concentration is $[A]'_{0.2} = 16\\,\\text{nM}$.\n  - For fractional effect $E/E_{\\max} = 0.5$, the agonist concentration is $[A]'_{0.5} = 64\\,\\text{nM}$.\n  - For fractional effect $E/E_{\\max} = 0.8$, the agonist concentration is $[A]'_{0.8} = 256\\,\\text{nM}$.\n- Assumptions:\n  - Mass-action equilibrium binding.\n  - A single homogeneous receptor class.\n  - No spare receptors.\n  - The observed effect is directly proportional to agonist receptor occupancy.\n- Required computations:\n  1. Compute the dose ratio, $\\text{DR}(E) = \\dfrac{[A]'_{E}}{[A]_{E}}$, at each effect level.\n  2. Assess if the shifts are parallel and consistent with competitive antagonism.\n  3. Estimate the antagonist equilibrium dissociation constant $K_{B}$ under the assumption of competitive antagonism.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in classical receptor theory and pharmacology. The provided data and assumptions are standard for analyzing agonist-antagonist interactions *in vitro*. Let us first verify the internal consistency of the data in the absence of the antagonist.\n\nThe assumptions (Hill coefficient $\\approx 1$, no spare receptors, effect proportional to occupancy) imply that the fractional effect $f_E = E/E_{\\max}$ follows the Hill-Langmuir equation, where the fractional effect is equal to the fractional receptor occupancy $p_A$:\n$$f_E = p_A = \\frac{[A]}{[A] + K_A}$$\nwhere $K_A$ is the equilibrium dissociation constant of the agonist $A$. By definition, the concentration of agonist that produces $50\\%$ of the maximal effect is the $EC_{50}$. Under the given assumptions, $EC_{50} = K_A$. From the data, $[A]_{0.5} = 10\\,\\text{nM}$, so we infer $K_A = 10\\,\\text{nM}$.\n\nLet's check if the other two data points are consistent with this value of $K_A$. The relationship can be rearranged to solve for $[A]$:\n$$[A] = K_A \\left( \\frac{f_E}{1 - f_E} \\right)$$\nFor $f_E = 0.2$: $[A]_{0.2} = (10\\,\\text{nM}) \\left( \\frac{0.2}{1 - 0.2} \\right) = (10\\,\\text{nM}) \\left( \\frac{0.2}{0.8} \\right) = 2.5\\,\\text{nM}$. This matches the provided data.\nFor $f_E = 0.8$: $[A]_{0.8} = (10\\,\\text{nM}) \\left( \\frac{0.8}{1 - 0.8} \\right) = (10\\,\\text{nM}) \\left( \\frac{0.8}{0.2} \\right) = 40\\,\\text{nM}$. This also matches the provided data.\n\nThe data are internally consistent and conform to the specified theoretical model. The problem is well-posed, objective, and complete.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution\nThe problem requires an analysis of agonist dose-response data in the absence and presence of an antagonist to characterize the nature of the antagonism and determine the antagonist's dissociation constant, $K_B$.\n\nThe three tasks will be addressed sequentially.\n\n**1. Compute the dose ratio at each effect level.**\n\nThe dose ratio, $\\text{DR}$, is defined as the ratio of an agonist concentration required to produce a given effect in the presence of an antagonist, $[A]'_{E}$, to the agonist concentration required to produce the same effect in the absence of the antagonist, $[A]_{E}$.\n$$\\text{DR}(E) = \\frac{[A]'_{E}}{[A]_{E}}$$\n\nWe are given data for three levels of fractional effect, $f_E = E/E_{\\max} \\in \\{0.2, 0.5, 0.8\\}$. We compute the dose ratio for each level.\n\nFor $f_E = 0.2$:\n$$\\text{DR}(0.2) = \\frac{[A]'_{0.2}}{[A]_{0.2}} = \\frac{16\\,\\text{nM}}{2.5\\,\\text{nM}} = 6.4$$\n\nFor $f_E = 0.5$:\n$$\\text{DR}(0.5) = \\frac{[A]'_{0.5}}{[A]_{0.5}} = \\frac{64\\,\\text{nM}}{10\\,\\text{nM}} = 6.4$$\n\nFor $f_E = 0.8$:\n$$\\text{DR}(0.8) = \\frac{[A]'_{0.8}}{[A]_{0.8}} = \\frac{256\\,\\text{nM}}{40\\,\\text{nM}} = 6.4$$\n\n**2. Assess whether the shifts are consistent with competitive antagonism.**\n\nThe calculations show that the dose ratio is constant across all measured effect levels: $\\text{DR}(0.2) = \\text{DR}(0.5) = \\text{DR}(0.8) = 6.4$. A dose ratio that is independent of the level of effect is the defining characteristic of simple competitive antagonism. This indicates that in a plot of effect versus $\\log([\\text{Agonist}])$, the dose-response curve in the presence of the antagonist is shifted parallel to the right compared to the curve in the absence of the antagonist. The maximal effect, $E_{\\max}$, is unchanged. Therefore, the data are fully consistent with a mechanism of competitive antagonism.\n\n**3. Estimate the antagonist equilibrium dissociation constant $K_B$.**\n\nFor a simple competitive antagonist $B$, the interaction with the agonist $A$ at the receptor is described by the Schild equation:\n$$\\text{DR} = 1 + \\frac{[B]}{K_B}$$\nwhere $[B]$ is the concentration of the antagonist and $K_B$ is its equilibrium dissociation constant. This equation directly relates the empirically determined dose ratio to the antagonist's affinity for the receptor.\n\nWe have determined that the dose ratio is $\\text{DR} = 6.4$ for a fixed antagonist concentration of $[B] = 64\\,\\text{nM}$. We can now solve for $K_B$.\n$$6.4 = 1 + \\frac{64\\,\\text{nM}}{K_B}$$\nSubtracting $1$ from both sides gives:\n$$5.4 = \\frac{64\\,\\text{nM}}{K_B}$$\nRearranging the equation to solve for $K_B$:\n$$K_B = \\frac{64\\,\\text{nM}}{5.4}$$\n$$K_B = 11.85185... \\,\\text{nM}$$\nThe problem asks for the answer to be rounded to three significant figures.\n$$K_B \\approx 11.9\\,\\text{nM}$$\nThe equilibrium dissociation constant of the antagonist $B$ is estimated to be $11.9\\,\\text{nM}$.", "answer": "$$\n\\boxed{11.9}\n$$", "id": "4542830"}, {"introduction": "This final practice advances your skills from manual calculation to computational analysis, a critical capability in modern pharmacology. You are tasked with building a program to perform a complete Schild analysis, which involves transforming experimental data and applying linear regression to determine antagonist potency. This advanced exercise [@problem_id:4542753] will prepare you to analyze real-world datasets, interpret the meaning of the Schild plot's slope, and employ robust operational measures like the $pA_2$ value, even in situations that deviate from ideal competitive antagonism.", "problem": "You are tasked with building a program that implements quantitative analysis of competitive and non-competitive antagonism using the Schild method at the advanced graduate level. The analysis must be driven from first principles of the law of mass action and the definition of agonist potency shift (dose ratio), and must be applicable to a general input of antagonist concentration and experimentally observed dose ratios. Your program must, for each provided test case, construct the Schild plot, estimate the slope using ordinary least squares (OLS), and compute the equilibrium dissociation constant of the antagonist $K_B$ together with $pA_2 = -\\log_{10} K_B$, adhering to a scientifically sound operational definition that remains valid whether the slope is equal to $1$ (purely competitive antagonism) or deviates from $1$ (non-competitive or insurmountable behavior).\n\nFundamental base to be used:\n- The law of mass action at equilibrium relates ligand concentrations to receptor occupancy.\n- The dose ratio $DR$ is defined as the ratio of the agonist concentration producing a specified level of effect (for example, the half-maximal effect) in the presence of antagonist to the concentration producing the same effect in the absence of antagonist.\n- For surmountable competitive antagonism, mass action implies a predictable shift of the agonist concentration-effect curve, which can be interrogated via the Schild plot constructed from $DR$ and antagonist concentration.\n- The Schild analysis uses base-$10$ logarithms and linear regression on transformed variables.\n\nProgram requirements:\n1. For each test case, you will be given a list of antagonist concentrations in nanomolar ($\\mathrm{nM}$) and corresponding experimentally observed dose ratios $DR$. Your program must convert antagonist concentrations to molar units ($\\mathrm{M}$) using $1\\,\\mathrm{nM} = 10^{-9}\\,\\mathrm{M}$.\n2. Construct the Schild plot by transforming the data to $x = \\log_{10}([B]\\,\\mathrm{in}\\,\\mathrm{M})$ and $y = \\log_{10}(DR - 1)$ for each point, where $[B]$ is the antagonist concentration.\n3. Estimate the slope $m$ and the $y$-intercept $c$ of the linear relationship $y = m\\,x + c$ by ordinary least squares (OLS).\n4. Compute two estimates related to $K_B$ and $pA_2$:\n   - A $y$-intercept-based estimate $K_B^{(y)}$ defined by the competitive antagonism identity at unit slope: if $m \\approx 1$ then the $y$-intercept equals $-\\log_{10} K_B$, so $K_B^{(y)} = 10^{-c}$ in $\\mathrm{M}$. Your program must compute $K_B^{(y)}$ regardless of slope for reporting purposes.\n   - An operational estimate based on the $x$-intercept at $y = 0$ (the point where $DR = 2$), which is robust to slope deviations: since $y = 0$ implies $x_0 = -c/m$, define $K_B^{(x)} = 10^{x_0}$ in $\\mathrm{M}$ and $pA_2 = -\\log_{10} K_B^{(x)} = -x_0 = c/m$.\n5. Numerical values must be computed using base-$10$ logarithms. All outputs for $K_B$ must be expressed in $\\mathrm{M}$, and $pA_2$ must be expressed as a decimal (without a percentage sign).\n\nTest suite:\nUse the following three scientifically plausible cases. Each list is written as ordered tuples $\\{[B]\\,\\mathrm{in}\\,\\mathrm{nM}, DR\\}$, and all numbers are to be taken exactly as given.\n\n- Case $1$ (canonical competitive-like data): $\\{[10, 30, 100, 300], [1.2, 1.6, 3.0, 7.0]\\}$\n- Case $2$ (insurmountable/non-competitive-like behavior with a slope less than $1$): $\\{[10, 30, 100, 300], [2.0, 3.16, 6.01, 13.82]\\}$\n- Case $3$ (boundary case with dose ratios close to $1$ at low antagonist concentrations): $\\{[1, 3, 10, 30], [1.001, 1.003, 1.01, 1.03]\\}$\n\nFinal output format:\n- For each case, produce the list $[m, K_B^{(y)}, K_B^{(x)}, pA_2]$ where $m$ is the OLS slope (unitless), $K_B^{(y)}$ and $K_B^{(x)}$ are in $\\mathrm{M}$, and $pA_2$ is unitless (decimal).\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, with each case’s list enclosed in its own square brackets and no spaces. For example: $[[m_1,K_{B,1}^{(y)},K_{B,1}^{(x)},pA_{2,1}],[m_2,K_{B,2}^{(y)},K_{B,2}^{(x)},pA_{2,2}],[m_3,K_{B,3}^{(y)},K_{B,3}^{(x)},pA_{2,3}]]$.", "solution": "The problem of quantifying antagonist affinity using Schild analysis is a cornerstone of classical pharmacology. The request is to implement a computational procedure for this analysis based on first principles, applicable to both ideal and non-ideal antagonism, and to apply it to a given set of test cases. The problem is scientifically valid, well-posed, and all necessary information for its resolution is provided.\n\n**Theoretical Foundation: The Law of Mass Action and Receptor Occupancy**\n\nThe interaction between a drug and its receptor at equilibrium is governed by the law of mass action. Let us consider an agonist $A$ and a competitive antagonist $B$ that reversibly bind to the same receptor site $R$. The respective dissociation constants are $K_A$ and $K_B$.\n\nThe equilibria are:\n$$ A + R \\rightleftharpoons AR \\quad \\text{with} \\quad K_A = \\frac{[A][R]}{[AR]} $$\n$$ B + R \\rightleftharpoons BR \\quad \\text{with} \\quad K_B = \\frac{[B][R]}{[BR]} $$\n\nHere, $[A]$, $[B]$, and $[R]$ represent the molar concentrations of the free agonist, free antagonist, and free receptor, respectively. $[AR]$ and $[BR]$ are the concentrations of the agonist-receptor and antagonist-receptor complexes. The total receptor concentration, $[R]_T$, is the sum of all receptor states:\n$$ [R]_T = [R] + [AR] + [BR] $$\n\nThe physiological or pharmacological effect is typically considered to be a function of the agonist-receptor occupancy, $p_{AR} = \\frac{[AR]}{[R]_T}$. We can express $p_{AR}$ in terms of the ligand concentrations and dissociation constants. By rearranging the equilibrium equations, we have $[R] = K_A \\frac{[AR]}{[A]}$ and $[BR] = \\frac{[B][R]}{K_B} = \\frac{[B]}{K_B} K_A \\frac{[AR]}{[A]}$. Substituting these into the expression for $[R]_T$:\n$$ [R]_T = K_A \\frac{[AR]}{[A]} + [AR] + \\frac{[B]}{K_B} K_A \\frac{[AR]}{[A]} = [AR] \\left( 1 + \\frac{K_A}{[A]} \\left( 1 + \\frac{[B]}{K_B} \\right) \\right) $$\nThe fractional occupancy by the agonist is therefore:\n$$ p_{AR} = \\frac{[AR]}{[R]_T} = \\frac{1}{1 + \\frac{K_A}{[A]} \\left( 1 + \\frac{[B]}{K_B} \\right)} = \\frac{[A]}{[A] + K_A \\left( 1 + \\frac{[B]}{K_B} \\right)} $$\n\n**Derivation of the Schild Equation**\n\nThe dose ratio, $DR$, is defined as the ratio of agonist concentrations required to produce the same effect in the presence ($[A]''$) and absence ($[A]'$) of the antagonist. Since the effect is assumed to be identical, the receptor occupancy $p_{AR}$ must also be identical in both conditions.\n\nIn the absence of antagonist ($[B] = 0$), the occupancy is:\n$$ p_{AR} = \\frac{[A]'}{[A]' + K_A} $$\nIn the presence of antagonist concentration $[B]$, the occupancy is:\n$$ p_{AR} = \\frac{[A]''}{[A]'' + K_A \\left( 1 + \\frac{[B]}{K_B} \\right)} $$\nEquating the two expressions for $p_{AR}$ and solving for the ratio of agonist concentrations yields:\n$$ \\frac{[A]' + K_A}{[A]'} = \\frac{[A]'' + K_A \\left( 1 + \\frac{[B]}{K_B} \\right)}{[A]''} $$\n$$ 1 + \\frac{K_A}{[A]'} = 1 + \\frac{K_A}{[A]''} \\left( 1 + \\frac{[B]}{K_B} \\right) $$\n$$ \\frac{[A]''}{[A]'} = 1 + \\frac{[B]}{K_B} $$\nBy definition, $DR = \\frac{[A]''}{[A]'}$, leading to the Gaddum-Schild equation for ideal competitive antagonism:\n$$ DR = 1 + \\frac{[B]}{K_B} $$\n\n**The Schild Plot and Its Interpretation**\n\nFor analysis, this equation is transformed by rearrangement and application of the base-10 logarithm. A prerequisite for this transformation is that $DR > 1$, which is expected in the presence of an antagonist.\n$$ DR - 1 = \\frac{[B]}{K_B} $$\n$$ \\log_{10}(DR - 1) = \\log_{10}([B]) - \\log_{10}(K_B) $$\nThis equation is in the form of a straight line, $y = m\\,x + c$, where:\n-   The independent variable is $x = \\log_{10}([B])$, with $[B]$ expressed in molar units ($\\mathrm{M}$).\n-   The dependent variable is $y = \\log_{10}(DR - 1)$.\n-   The theoretical slope is $m = 1$.\n-   The theoretical y-intercept is $c = -\\log_{10}(K_B)$.\n\nThe plot of $y$ versus $x$ is the Schild plot. A slope of unity ($m=1$) is a defining characteristic of simple, reversible, competitive antagonism. Deviations from unity suggest more complex mechanisms, such as non-competitive antagonism, allosteric modulation, or experimental artifacts.\n\n**Operational Definitions for Antagonist Potency**\n\nThe problem requires the calculation of antagonist potency using definitions that are robust to deviations from the ideal model.\n\n1.  **Slope ($m$) and Intercept ($c$)**: These are estimated from the experimental data points $(\\log_{10}([B]_i), \\log_{10}(DR_i - 1))$ using Ordinary Least Squares (OLS) linear regression.\n\n2.  **Y-Intercept-Based Affinity Estimate ($K_B^{(y)}$)**: This estimate is derived assuming the ideal competitive model holds ($m=1$), where $c = -\\log_{10}(K_B)$. Therefore, $K_B^{(y)}$ is calculated from the experimentally determined intercept $c$ as $K_B^{(y)} = 10^{-c}$. This value represents the antagonist dissociation constant *if* the antagonism were purely competitive.\n\n3.  **X-Intercept-Based Affinity Estimate ($pA_2$ and $K_B^{(x)}$)**: A more general, operational measure of antagonist potency is the $pA_2$ value. The $pA_2$ is defined as the negative base-$10$ logarithm of the molar concentration of an antagonist that produces a dose ratio of $2$.\n    -   When $DR = 2$, the transformed variable $y = \\log_{10}(2-1) = \\log_{10}(1) = 0$.\n    -   We find the corresponding $x$-value, denoted $x_0$, by setting $y=0$ in the regression line equation: $0 = m\\,x_0 + c$, which gives $x_0 = -c/m$.\n    -   By definition, $pA_2 = -x_0$, so $pA_2 = c/m$. This value is dimensionally consistent (it is the negative log of a concentration) and represents the potency of the antagonist in producing a two-fold shift, irrespective of the slope.\n    -   The corresponding molar concentration is the operational dissociation constant, $K_B^{(x)} = 10^{x_0} = 10^{-c/m}$. This is the experimentally determined concentration of antagonist yielding $DR = 2$. For ideal competitive antagonism where $m=1$, $pA_2 = c$ and $K_B^{(x)} = 10^{-c} = K_B^{(y)}$, meaning the two estimates converge.\n\n**Computational Method: Ordinary Least Squares (OLS)**\n\nGiven a set of $N$ data points $(x_i, y_i)$, OLS regression finds the slope $m$ and intercept $c$ that minimize the sum of squared vertical errors. The analytical solution for $m$ and $c$ is:\n$$ m = \\frac{N \\sum_{i=1}^{N} x_i y_i - (\\sum_{i=1}^{N} x_i)(\\sum_{i=1}^{N} y_i)}{N \\sum_{i=1}^{N} x_i^2 - (\\sum_{i=1}^{N} x_i)^2} $$\n$$ c = \\bar{y} - m \\bar{x} \\quad \\text{where} \\quad \\bar{x} = \\frac{1}{N}\\sum_{i=1}^{N} x_i \\quad \\text{and} \\quad \\bar{y} = \\frac{1}{N}\\sum_{i=1}^{N} y_i $$\nThese formulas will be applied to the log-transformed data for each test case to derive the required parameters. The antagonist concentrations $[B]$ must first be converted from nanomolar ($\\mathrm{nM}$) to molar ($\\mathrm{M}$) by multiplying by $10^{-9}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_antagonism(B_nM, DR):\n    \"\"\"\n    Performs Schild analysis on a set of antagonist concentrations and dose ratios.\n\n    Args:\n        B_nM (list or np.ndarray): List of antagonist concentrations in nanomolar (nM).\n        DR (list or np.ndarray): List of corresponding dose ratios.\n\n    Returns:\n        list: A list containing [m, K_B_y, K_B_x, pA2], where:\n              - m: OLS slope of the Schild plot.\n              - K_B_y: Intercept-based estimate of K_B in Molar.\n              - K_B_x: Intercept-based estimate of K_B in Molar.\n              - pA2: Operational pA2 value.\n    \"\"\"\n    # 1. Convert antagonist concentration from nM to M.\n    B_M = np.array(B_nM) * 1e-9\n\n    # 2. Construct the Schild plot a, i.e., transform data.\n    # x = log10([B] in M)\n    # y = log10(DR - 1)\n    # The problem guarantees DR > 1 for all test cases.\n    x = np.log10(B_M)\n    y = np.log10(np.array(DR) - 1.0)\n\n    # 3. Estimate slope (m) and intercept (c) using OLS.\n    N = len(x)\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n\n    # OLS formulas:\n    # m = sum((xi - x_mean) * (yi - y_mean)) / sum((xi - x_mean)^2)\n    # c = y_mean - m * x_mean\n    numerator = np.sum((x - x_mean) * (y - y_mean))\n    denominator = np.sum((x - x_mean)**2)\n    \n    # Check for denominator being zero, although unlikely with given data.\n    if denominator == 0:\n        # Undefined slope, cannot proceed. Handle as an error case.\n        return [np.nan, np.nan, np.nan, np.nan]\n        \n    m = numerator / denominator\n    c = y_mean - m * x_mean\n\n    # 4. Compute the required estimates for K_B and pA2.\n    \n    # Y-intercept-based estimate for K_B (assumes slope = 1)\n    # K_B = 10^(-c)\n    K_B_y = 10**(-c)\n\n    # Check for slope being zero to avoid division by zero in the next step.\n    # With the given data where DR increases with [B], m will be positive.\n    if m == 0:\n        K_B_x = np.nan\n        pA2 = np.nan\n    else:\n        # Operational estimate based on x-intercept (robust to slope deviations)\n        # pA2 is the x-value where y=0 (DR=2), but with the sign flipped.\n        # y = m*x + c => x_intercept = -c/m\n        # pA2 = -x_intercept = c/m\n        pA2 = c / m\n        \n        # K_B_x is the molar concentration corresponding to pA2.\n        # K_B_x = 10^(-pA2) = 10^(-c/m)\n        K_B_x = 10**(-pA2)\n\n    return [m, K_B_y, K_B_x, pA2]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: tuple of ([B] in nM, [DR])\n    test_cases = [\n        # Case 1 (canonical competitive-like data)\n        ([10, 30, 100, 300], [1.2, 1.6, 3.0, 7.0]),\n        # Case 2 (insurmountable/non-competitive-like behavior)\n        ([10, 30, 100, 300], [2.0, 3.16, 6.01, 13.82]),\n        # Case 3 (boundary case with DRs close to 1)\n        ([1, 3, 10, 30], [1.001, 1.003, 1.01, 1.03])\n    ]\n\n    all_results = []\n    for B_nM, DR in test_cases:\n        result = analyze_antagonism(B_nM, DR)\n        all_results.append(result)\n\n    # Format the final output string as specified: no spaces between list elements.\n    case_strings = []\n    for res in all_results:\n        # Format each number to avoid excessively long representations.\n        # This part is for clean output; standard float conversion is also fine.\n        inner_str = '[' + ','.join(f'{v:.7g}' for v in res) + ']'\n        case_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(case_strings) + ']'\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "4542753"}]}