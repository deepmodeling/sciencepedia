{"hands_on_practices": [{"introduction": "A cornerstone of clinical pharmacology is understanding the relationship between drug dose and clinical effect. For nondepolarizing neuromuscular blockers, this relationship is often steep, and this exercise [@problem_id:4538445] allows you to quantify this steepness using the Hill equation. By calculating the dose adjustment needed to move from a 95% to a 99% block, you will develop an intuition for how cooperativity at the receptor level translates into critical dosing decisions in the operating room.", "problem": "A clinician measures the patient-specific effective dose that produces ninety-five percent neuromuscular block for rocuronium, denoted as $\\mathrm{ED}_{95}$, to be $0.3\\,\\mathrm{mg/kg}$ following a rapid bolus at induction. For nondepolarizing neuromuscular blockers, assume a standard pharmacodynamic model in which the fractional effect at the neuromuscular junction is governed by receptor occupancy with cooperative binding characterized by a Hill coefficient $n$, and that at the initial distribution time scale effect-site concentration is proportional to administered dose. Using a Hill coefficient of $n=3$, determine the dose required to achieve ninety-nine percent neuromuscular block. Round your answer to three significant figures and express the dose in $\\mathrm{mg/kg}$.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. Therefore, it is deemed valid. We proceed with the solution.\n\nThe relationship between the administered dose of a drug and the resulting physiological effect can be modeled using the Hill equation. In this context, the effect $E$ is the fractional neuromuscular block, which ranges from $0$ (no block) to $1$ (complete block). The problem states that at the initial time scale of a rapid bolus, the effect-site concentration, $C$, is proportional to the administered dose, $D$. This can be expressed as $C = kD$, where $k$ is a constant of proportionality.\n\nThe standard concentration-response Hill equation is:\n$$E = \\frac{E_{\\text{max}} \\cdot C^n}{EC_{50}^n + C^n}$$\nHere, $E_{\\text{max}}$ is the maximum possible effect, $EC_{50}$ is the concentration that produces $50\\%$ of the maximum effect, and $n$ is the Hill coefficient. For fractional effect, we normalize the maximum effect to $E_{\\text{max}} = 1$. Substituting $C = kD$ and letting $\\mathrm{ED}_{50}$ be the dose that produces a $50\\%$ effect (at which point $C=EC_{50}=k \\cdot \\mathrm{ED}_{50}$), the equation becomes a dose-response relationship:\n$$E = \\frac{(kD)^n}{(k \\cdot \\mathrm{ED}_{50})^n + (kD)^n} = \\frac{k^n D^n}{k^n \\mathrm{ED}_{50}^n + k^n D^n} = \\frac{D^n}{\\mathrm{ED}_{50}^n + D^n}$$\nThis equation relates the fractional effect $E$ to the dose $D$. The parameters characterizing this relationship for a specific patient and drug are the Hill coefficient $n$ and the dose for $50\\%$ effect, $\\mathrm{ED}_{50}$.\n\nTo find an unknown dose, it is advantageous to rearrange the equation to isolate the constant parameter $\\mathrm{ED}_{50}$:\n$$E (\\mathrm{ED}_{50}^n + D^n) = D^n$$\n$$E \\cdot \\mathrm{ED}_{50}^n = D^n - E \\cdot D^n$$\n$$E \\cdot \\mathrm{ED}_{50}^n = D^n(1 - E)$$\n$$\\mathrm{ED}_{50}^n = D^n \\frac{1 - E}{E}$$\nSince $\\mathrm{ED}_{50}$ and $n$ are constants for this specific clinical scenario, the quantity $D^n \\frac{1 - E}{E}$ must have the same value for any pair of dose and effect $(D, E)$ on the dose-response curve.\n\nWe are given a dose-effect pair: the dose producing a $95\\%$ block ($\\mathrm{ED}_{95}$) is $0.3\\,\\mathrm{mg/kg}$. Let this be $(D_1, E_1)$, where $D_1 = 0.3$ and $E_1 = 0.95$. We wish to find the dose required for a $99\\%$ block, let's call it $\\mathrm{ED}_{99}$. This is our second pair $(D_2, E_2)$, where $D_2 = \\mathrm{ED}_{99}$ is the unknown and $E_2 = 0.99$. The Hill coefficient is given as $n=3$.\n\nWe can equate the expressions for $\\mathrm{ED}_{50}^n$ for both pairs:\n$$D_1^n \\frac{1 - E_1}{E_1} = D_2^n \\frac{1 - E_2}{E_2}$$\nSubstituting the symbolic notation for the doses:\n$$(\\mathrm{ED}_{95})^n \\frac{1 - E_1}{E_1} = (\\mathrm{ED}_{99})^n \\frac{1 - E_2}{E_2}$$\nWe can now solve for $\\mathrm{ED}_{99}$:\n$$(\\mathrm{ED}_{99})^n = (\\mathrm{ED}_{95})^n \\left( \\frac{1 - E_1}{E_1} \\right) \\left( \\frac{E_2}{1 - E_2} \\right)$$\n$$\\mathrm{ED}_{99} = \\mathrm{ED}_{95} \\left[ \\frac{(1 - E_1)E_2}{E_1(1 - E_2)} \\right]^{1/n}$$\nNow, we substitute the given numerical values: $D_1 = \\mathrm{ED}_{95} = 0.3$, $E_1 = 0.95$, $E_2 = 0.99$, and $n=3$.\n$$\\mathrm{ED}_{99} = 0.3 \\left[ \\frac{(1 - 0.95)(0.99)}{(0.95)(1 - 0.99)} \\right]^{1/3}$$\n$$\\mathrm{ED}_{99} = 0.3 \\left[ \\frac{(0.05)(0.99)}{(0.95)(0.01)} \\right]^{1/3}$$\nLet's simplify the term inside the brackets:\n$$\\frac{(0.05)(0.99)}{(0.95)(0.01)} = \\frac{5 \\times 10^{-2} \\times 99 \\times 10^{-2}}{95 \\times 10^{-2} \\times 1 \\times 10^{-2}} = \\frac{5 \\times 99}{95 \\times 1} = \\frac{495}{95} = \\frac{99}{19}$$\nSo, the expression for $\\mathrm{ED}_{99}$ is:\n$$\\mathrm{ED}_{99} = 0.3 \\left( \\frac{99}{19} \\right)^{1/3}$$\nTo obtain the numerical answer, we calculate the value:\n$$\\frac{99}{19} \\approx 5.210526$$\n$$\\left( \\frac{99}{19} \\right)^{1/3} \\approx (5.210526)^{1/3} \\approx 1.73350$$\n$$\\mathrm{ED}_{99} \\approx 0.3 \\times 1.73350 \\approx 0.52005$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\mathrm{ED}_{99} \\approx 0.520$$\nThe required dose is $0.520\\,\\mathrm{mg/kg}$.", "answer": "$$\\boxed{0.520}$$", "id": "4538445"}, {"introduction": "The duration of a drug's effect is governed by its pharmacokinetics, particularly its rate of elimination. This practice [@problem_id:4538479] delves into the metabolic breakdown of succinylcholine, a classic clinical scenario where genetic variability has profound consequences. By applying principles of enzyme kinetics, you will derive the quantitative relationship between enzyme activity and drug half-life, providing a clear model for why patients with butyrylcholinesterase deficiency experience prolonged neuromuscular blockade.", "problem": "A single intravenous bolus of succinylcholine is administered to an adult with normal plasma butyrylcholinesterase (BChE) activity. In plasma, hydrolysis of succinylcholine is catalyzed by BChE and follows Michaelis–Menten kinetics. Let the succinylcholine concentration be denoted by $[S](t)$, the catalytic rate constant by $k_{\\text{cat}}$, the total enzyme concentration by $E_{\\text{tot}}$, and the Michaelis constant by $K_{M}$.\n\nAssume the following foundational facts:\n- The reaction velocity is given by $v = -\\frac{d[S]}{dt} = \\frac{k_{\\text{cat}} E_{\\text{tot}} [S]}{K_{M} + [S]}$.\n- In the clinically relevant post-bolus range for succinylcholine, $[S] \\ll K_{M}$ so that the kinetics may be approximated by a first-order decay in $[S]$.\n- The elimination half-life under normal BChE activity is $2$ minutes.\n\nA patient has a genetic variant that reduces BChE activity such that the effective $E_{\\text{tot}}$ is $25\\%$ of normal. Using the enzyme kinetics framework above and the first-order approximation justified by $[S] \\ll K_{M}$, derive how the change in $E_{\\text{tot}}$ modifies the first-order rate constant and thus the elimination half-life. What is the predicted elimination half-life of succinylcholine in this patient? Express your final answer in minutes and round your answer to four significant figures.", "solution": "The problem is valid as it is scientifically grounded in established principles of enzyme kinetics and clinical pharmacology, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe rate of hydrolysis of succinylcholine, $[S]$, catalyzed by butyrylcholinesterase (BChE) is described by the Michaelis–Menten equation:\n$$v = -\\frac{d[S]}{dt} = \\frac{k_{\\text{cat}} E_{\\text{tot}} [S]}{K_{M} + [S]}$$\nwhere $v$ is the reaction velocity, $k_{\\text{cat}}$ is the catalytic rate constant, $E_{\\text{tot}}$ is the total enzyme concentration, and $K_{M}$ is the Michaelis constant.\n\nThe problem states that in the clinically relevant concentration range following a bolus injection, the substrate concentration is much less than the Michaelis constant, i.e., $[S] \\ll K_{M}$. This condition allows for a simplification of the denominator in the rate equation:\n$$K_{M} + [S] \\approx K_{M}$$\nSubstituting this approximation into the Michaelis–Menten equation yields:\n$$-\\frac{d[S]}{dt} \\approx \\frac{k_{\\text{cat}} E_{\\text{tot}} [S]}{K_{M}}$$\nThis equation can be rearranged to highlight its kinetic order:\n$$\\frac{d[S]}{dt} \\approx -\\left(\\frac{k_{\\text{cat}} E_{\\text{tot}}}{K_{M}}\\right) [S]$$\nThis is the differential equation for a first-order decay process, $\\frac{d[S]}{dt} = -k_{1}[S]$, where the apparent first-order rate constant, $k_{1}$, is given by:\n$$k_{1} = \\frac{k_{\\text{cat}} E_{\\text{tot}}}{K_{M}}$$\nThis expression explicitly shows how the first-order rate constant, $k_{1}$, is directly proportional to the total enzyme concentration, $E_{\\text{tot}}$, assuming $k_{\\text{cat}}$ and $K_{M}$ are constant.\n\nThe elimination half-life, $t_{1/2}$, for a first-order process is related to the rate constant $k_1$ by the well-known formula:\n$$t_{1/2} = \\frac{\\ln(2)}{k_{1}}$$\nSubstituting the expression for $k_{1}$:\n$$t_{1/2} = \\frac{\\ln(2)}{\\frac{k_{\\text{cat}} E_{\\text{tot}}}{K_{M}}} = \\frac{\\ln(2) K_{M}}{k_{\\text{cat}} E_{\\text{tot}}}$$\nThis derivation shows that the elimination half-life, $t_{1/2}$, is inversely proportional to the total enzyme concentration, $E_{\\text{tot}}$.\n\nLet us denote the parameters for a person with normal BChE activity with the subscript \"normal\" and for the patient with the genetic variant with the subscript \"variant\". We are given:\n$$t_{1/2, \\text{normal}} = 2 \\text{ minutes}$$\nThe genetic variant reduces the effective total enzyme concentration to $25\\%$ of the normal value:\n$$E_{\\text{tot, variant}} = 0.25 \\times E_{\\text{tot, normal}}$$\nThe parameters $k_{\\text{cat}}$ and $K_{M}$ are intrinsic properties of the enzyme and are assumed to be unaffected by the genetic variant, which only alters the quantity of effective enzyme.\n\nFirst, we determine how the rate constant is modified. The ratio of the variant rate constant to the normal rate constant is:\n$$\\frac{k_{1, \\text{variant}}}{k_{1, \\text{normal}}} = \\frac{\\frac{k_{\\text{cat}} E_{\\text{tot, variant}}}{K_{M}}}{\\frac{k_{\\text{cat}} E_{\\text{tot, normal}}}{K_{M}}} = \\frac{E_{\\text{tot, variant}}}{E_{\\text{tot, normal}}}$$\nSubstituting the given relationship for the enzyme concentrations:\n$$\\frac{k_{1, \\text{variant}}}{k_{1, \\text{normal}}} = \\frac{0.25 \\times E_{\\text{tot, normal}}}{E_{\\text{tot, normal}}} = 0.25$$\nThus, the first-order rate constant in the patient with the variant is $25\\%$ of the normal rate constant.\n\nNext, we determine the effect on the half-life. We can establish a ratio between the half-lives for the variant and normal cases:\n$$\\frac{t_{1/2, \\text{variant}}}{t_{1/2, \\text{normal}}} = \\frac{\\frac{\\ln(2)}{k_{1, \\text{variant}}}}{\\frac{\\ln(2)}{k_{1, \\text{normal}}}} = \\frac{k_{1, \\text{normal}}}{k_{1, \\text{variant}}}$$\nFrom the previous step, we know that $\\frac{k_{1, \\text{normal}}}{k_{1, \\text{variant}}} = \\frac{1}{0.25} = 4$. Therefore:\n$$\\frac{t_{1/2, \\text{variant}}}{t_{1/2, \\text{normal}}} = 4$$\nThis demonstrates that the half-life in the patient with the variant is four times longer than the normal half-life.\n\nWe can now calculate the predicted half-life for the patient with the BChE variant:\n$$t_{1/2, \\text{variant}} = 4 \\times t_{1/2, \\text{normal}}$$\n$$t_{1/2, \\text{variant}} = 4 \\times 2 \\text{ minutes} = 8 \\text{ minutes}$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, the result of $8$ minutes must be expressed as $8.000$ minutes.", "answer": "$$\\boxed{8.000}$$", "id": "4538479"}, {"introduction": "Modern pharmacology increasingly relies on integrated mathematical models to understand and predict the outcomes of complex drug interactions. This capstone exercise [@problem_id:4538394] challenges you to construct a comprehensive pharmacokinetic/pharmacodynamic model for the reversal of rocuronium-induced blockade by the encapsulating agent sugammadex. Through this simulation, you will gain insight into the dynamic interplay between drug distribution, binding, and effect, and learn how computational approaches are used to optimize reversal strategies in clinical practice.", "problem": "You are asked to implement a program that constructs and simulates a minimal but mechanistically principled pharmacokinetic/pharmacodynamic (PK/PD) model linking depth of neuromuscular block, quantified as Post-Tetanic Count (PTC), to the dose of the reversal agent sugammadex and computes the recovery time to a Train-of-Four (TOF) ratio of $0.9$. Train-of-Four (TOF) is defined as the ratio of the amplitude of the fourth twitch to the first during a four-stimulus train; in this model, we approximate the TOF ratio as the fraction of neuromuscular transmission not blocked in the effect site. Post-Tetanic Count (PTC) is the count of detectable responses to post-tetanic stimulation and is inversely related to depth of block.\n\nYour simulation must start from the following fundamental laws and core definitions:\n\n- First-order elimination for rocuronium and sugammadex: if $A(t)$ is the amount of drug in the central compartment at time $t$, then $\\frac{dA}{dt} = -k_\\mathrm{el} \\, A$, where $k_\\mathrm{el}$ is the first-order elimination rate constant.\n- Law of Mass Action for reversible binding between rocuronium ($R$) and sugammadex ($S$) with $1{:}1$ stoichiometry to form a complex ($RS$):\n  $$ R + S \\xrightleftharpoons[k_\\mathrm{off}]{k_\\mathrm{on}} RS $$\n  with association rate constant $k_\\mathrm{on}$ and dissociation rate constant $k_\\mathrm{off}$, and equilibrium dissociation constant $K_d = \\frac{k_\\mathrm{off}}{k_\\mathrm{on}}$.\n- Effect-site link model for rocuronium: the effect-site concentration $C_e(t)$ follows\n  $$ \\frac{dC_e}{dt} = k_{e0} \\left(C_R(t) - C_e(t)\\right), $$\n  where $C_R(t)$ is the free rocuronium concentration in the central compartment and $k_{e0}$ is the effect-site equilibration rate constant.\n- Sigmoid $E_\\mathrm{max}$ model for fractional neuromuscular block $E(t)$ as a function of effect-site concentration:\n  $$ E(t) = \\frac{C_e(t)^\\gamma}{C_{50}^\\gamma + C_e(t)^\\gamma}, $$\n  where $C_{50}$ is the effect-site concentration producing half-maximal block and $\\gamma$ is the Hill coefficient. The TOF ratio is approximated as $R_\\mathrm{TOF}(t) = 1 - E(t)$ near recovery.\n- Empirical monotonic mapping from PTC to the initial effect-site concentration $C_e(0)$ via the unblocked fraction $1 - E$:\n  $$ \\mathrm{PTC} \\approx \\mathrm{PTC}_{\\max} \\cdot (1 - E)^\\alpha, \\quad \\text{so that} \\quad C_e(0) = C_{50} \\left(\\left(\\frac{\\mathrm{PTC}_{\\max}}{\\mathrm{PTC}}\\right)^{\\frac{1}{\\alpha}} - 1\\right)^{\\frac{1}{\\gamma}}. $$\n  Assume pseudo steady state prior to reversal so that the initial free central concentration satisfies $C_R(0) = C_e(0)$.\n\nModeling assumptions and parameterization to be used in all simulations:\n\n- Drug species and units:\n  - Concentrations are in micromoles per liter ($\\mu\\mathrm{mol}/\\mathrm{L}$) and amounts in micromoles ($\\mu\\mathrm{mol}$).\n  - Molecular weights: rocuronium $MW_R = 610\\,\\mathrm{g/mol}$, sugammadex $MW_S = 2178\\,\\mathrm{g/mol}$. Conversion from milligrams to micromoles uses $n_\\mu = \\frac{m_\\mathrm{mg}\\cdot 1000}{MW_{\\mu\\mathrm{g}/\\mu\\mathrm{mol}}}$, noting that $MW_{\\mu\\mathrm{g}/\\mu\\mathrm{mol}}$ equals the molecular weight in $\\mathrm{g/mol}$.\n- Compartments:\n  - A shared central volume of distribution per kilogram $V_c^\\ast = 0.2\\,\\mathrm{L/kg}$, yielding $V_c = V_c^\\ast \\cdot W$ for body weight $W$ in kilograms.\n  - Rocuronium has an additional peripheral amount compartment $A_{R,p}(t)$ to capture redistribution with intercompartmental rate constants $k_{12}$ and $k_{21}$; binding occurs in the central compartment only.\n  - Effect-site is a hypothetical link compartment that does not alter mass balance in the central compartment.\n- Kinetic parameters (all rates in $\\mathrm{min}^{-1}$ unless stated):\n  - Rocuronium elimination half-life $t_{1/2,R} = 90\\,\\mathrm{min}$ so $k_{\\mathrm{el},R} = \\ln(2) / t_{1/2,R}$.\n  - Sugammadex elimination half-life $t_{1/2,S} = 120\\,\\mathrm{min}$ so $k_{\\mathrm{el},S} = \\ln(2) / t_{1/2,S}$.\n  - Complex elimination $k_{\\mathrm{el},RS} = k_{\\mathrm{el},S}$.\n  - Intercompartmental exchange for rocuronium $k_{12} = 0.3$, $k_{21} = 0.2$.\n  - Effect-site equilibration $k_{e0} = 0.2$.\n  - Binding kinetics: choose $k_\\mathrm{on} = 1.0\\,\\mathrm{L}/(\\mu\\mathrm{mol}\\cdot\\mathrm{min})$, $K_d = 0.1\\,\\mu\\mathrm{mol}/\\mathrm{L}$, so $k_\\mathrm{off} = K_d \\cdot k_\\mathrm{on} = 0.1$.\n- Pharmacodynamic parameters:\n  - $C_{50} = 1.0\\,\\mu\\mathrm{mol}/\\mathrm{L}$, $\\gamma = 3.0$.\n  - PTC mapping parameters $\\mathrm{PTC}_{\\max} = 15$, $\\alpha = 1.0$.\n\nInitial conditions at $t = 0$:\n\n- Compute $C_e(0)$ from the given PTC using the mapping above. Set initial free central rocuronium concentration $C_R(0) = C_e(0)$.\n- Central amounts:\n  - $A_{R,f}(0) = C_R(0)\\cdot V_c$,\n  - $A_{R,p}(0) = \\frac{k_{12}}{k_{21}} A_{R,f}(0)$ (pseudo steady state between central and peripheral prior to reversal),\n  - $A_{S,f}(0) = \\frac{\\mathrm{Dose}_{S,\\mathrm{mg/kg}}\\cdot W \\cdot 1000}{MW_S}$,\n  - $A_{RS}(0) = 0$.\n- Effect-site concentration $C_e(0)$ as computed.\n\nDynamics to simulate for $t \\in [0, 30]$ minutes (inclusive):\n\n- Let $C_R(t) = \\frac{A_{R,f}(t)}{V_c}$ and $C_S(t) = \\frac{A_{S,f}(t)}{V_c}$.\n- The ordinary differential equations (ODEs) are:\n  $$ \\frac{dA_{R,f}}{dt} = -k_{\\mathrm{el},R} A_{R,f} - k_{12} A_{R,f} + k_{21} A_{R,p} - k_\\mathrm{on}\\, \\frac{A_{R,f}}{V_c}\\, \\frac{A_{S,f}}{V_c}\\, V_c + k_\\mathrm{off} A_{RS}, $$\n  $$ \\frac{dA_{R,p}}{dt} = k_{12} A_{R,f} - k_{21} A_{R,p}, $$\n  $$ \\frac{dA_{S,f}}{dt} = -k_{\\mathrm{el},S} A_{S,f} - k_\\mathrm{on}\\, \\frac{A_{R,f}}{V_c}\\, \\frac{A_{S,f}}{V_c}\\, V_c + k_\\mathrm{off} A_{RS}, $$\n  $$ \\frac{dA_{RS}}{dt} = k_\\mathrm{on}\\, \\frac{A_{R,f}}{V_c}\\, \\frac{A_{S,f}}{V_c}\\, V_c - \\left(k_\\mathrm{off} + k_{\\mathrm{el},RS}\\right) A_{RS}, $$\n  $$ \\frac{dC_e}{dt} = k_{e0}\\left(\\frac{A_{R,f}}{V_c} - C_e\\right). $$\n- At each time $t$, compute the TOF ratio as\n  $$ R_\\mathrm{TOF}(t) = 1 - \\frac{C_e(t)^\\gamma}{C_{50}^\\gamma + C_e(t)^\\gamma}. $$\n\nStopping condition:\n\n- Define the recovery time as the earliest $t \\in [0,30]$ such that $R_\\mathrm{TOF}(t) \\ge 0.9$. If this is not achieved by $t = 30$ minutes, return a sentinel value of $-1.0$.\n\nAngle units do not apply. All physical quantities that require units are specified above. The required outputs are times in minutes.\n\nTest suite to implement and evaluate:\n\nEach test case is a tuple $(W, \\mathrm{PTC}, \\mathrm{Dose}_{S,\\mathrm{mg/kg}})$ representing body weight in kilograms, initial PTC (dimensionless count), and sugammadex bolus dose in milligrams per kilogram.\n\n- Case A (moderate block): $(70, 10, 2)$\n- Case B (deep block): $(70, 2, 4)$\n- Case C (deep block, underdose): $(70, 2, 2)$\n- Case D (very deep block, high dose): $(70, 1, 16)$\n- Case E (deep block in higher weight): $(100, 2, 4)$\n\nFinal output specification:\n\n- Your program should produce a single line of output containing the recovery times for the test cases in the order A, B, C, D, E, formatted as a comma-separated list enclosed in square brackets, with each time expressed in minutes rounded to two decimals. If recovery is not achieved by $30$ minutes, output $-1.0$ for that case. For example: \"[$t_A,t_B,t_C,t_D,t_E$]\".", "solution": "The problem requires the construction and simulation of a pharmacokinetic/pharmacodynamic (PK/PD) model to determine the time to recovery from neuromuscular blockade after administration of the reversal agent sugammadex. The analysis proceeds by first establishing the mathematical model, defining the initial state based on pre-reversal conditions, and then numerically solving the system of differential equations that describe the dynamics post-reversal.\n\nThe state of the system at any time $t$ is described by a vector of $5$ variables: the amounts of free rocuronium in the central compartment, $A_{R,f}(t)$, and peripheral compartment, $A_{R,p}(t)$; the amount of free sugammadex in the central compartment, $A_{S,f}(t)$; the amount of the rocuronium-sugammadex complex, $A_{RS}(t)$; and the concentration of rocuronium in the effect-site compartment, $C_e(t)$. The evolution of these state variables is governed by a system of coupled ordinary differential equations (ODEs).\n\nThe amount of free rocuronium in the central compartment, $A_{R,f}$, changes due to first-order elimination (rate constant $k_{\\mathrm{el},R}$), intercompartmental transfer to and from the peripheral compartment (rate constants $k_{12}$ and $k_{21}$), binding to sugammadex (association rate constant $k_\\mathrm{on}$), and dissociation from the complex (dissociation rate constant $k_\\mathrm{off}$). The concentrations of free rocuronium, $C_R(t) = A_{R,f}(t)/V_c$, and free sugammadex, $C_S(t) = A_{S,f}(t)/V_c$, are determined by the respective amounts and the central volume of distribution $V_c$. The rate of change of $A_{R,f}$ is:\n$$ \\frac{dA_{R,f}}{dt} = -k_{\\mathrm{el},R} A_{R,f} - k_{12} A_{R,f} + k_{21} A_{R,p} - k_\\mathrm{on}\\, C_R\\, C_S\\, V_c + k_\\mathrm{off} A_{RS} $$\nThe amount of rocuronium in the peripheral compartment, $A_{R,p}$, changes only due to intercompartmental transfer:\n$$ \\frac{dA_{R,p}}{dt} = k_{12} A_{R,f} - k_{21} A_{R,p} $$\nThe amount of free sugammadex, $A_{S,f}$, changes due to first-order elimination (rate constant $k_{\\mathrm{el},S}$) and a change in binding state:\n$$ \\frac{dA_{S,f}}{dt} = -k_{\\mathrm{el},S} A_{S,f} - k_\\mathrm{on}\\, C_R\\, C_S\\, V_c + k_\\mathrm{off} A_{RS} $$\nThe amount of the rocuronium-sugammadex complex, $A_{RS}$, is formed by binding and removed by dissociation and first-order elimination (rate constant $k_{\\mathrm{el},RS}$):\n$$ \\frac{dA_{RS}}{dt} = k_\\mathrm{on}\\, C_R\\, C_S\\, V_c - \\left(k_\\mathrm{off} + k_{\\mathrm{el},RS}\\right) A_{RS} $$\nFinally, the effect-site concentration, $C_e$, which drives the neuromuscular block, equilibrates with the central compartment concentration $C_R$ according to a first-order link model with rate constant $k_{e0}$:\n$$ \\frac{dC_e}{dt} = k_{e0}\\left(C_R - C_e\\right) $$\nThe system is parameterized with constants derived from literature values. Elimination rate constants are calculated from half-lives via $k_\\mathrm{el} = \\ln(2)/t_{1/2}$. Specifically, $k_{\\mathrm{el},R} = \\ln(2)/90\\,\\mathrm{min}^{-1}$ and $k_{\\mathrm{el},S} = \\ln(2)/120\\,\\mathrm{min}^{-1}$. Other fixed parameters include $k_{12}=0.3\\,\\mathrm{min}^{-1}$, $k_{21}=0.2\\,\\mathrm{min}^{-1}$, $k_{e0}=0.2\\,\\mathrm{min}^{-1}$, $k_\\mathrm{on}=1.0\\,\\mathrm{L}/(\\mu\\mathrm{mol}\\cdot\\mathrm{min})$, and $k_\\mathrm{off}=0.1\\,\\mathrm{min}^{-1}$.\n\nThe simulation starts at $t=0$, the moment of sugammadex administration. The initial conditions for each test case $(W, \\mathrm{PTC}, \\mathrm{Dose}_{S,\\mathrm{mg/kg}})$ are determined as follows. The patient-specific central volume is $V_c = V_c^\\ast \\cdot W = 0.2 \\cdot W$. The initial depth of block, given by the Post-Tetanic Count ($\\mathrm{PTC}$), is used to calculate the initial effect-site concentration $C_e(0)$ using the provided empirical formula:\n$$ C_e(0) = C_{50} \\left(\\left(\\frac{\\mathrm{PTC}_{\\max}}{\\mathrm{PTC}}\\right)^{\\frac{1}{\\alpha}} - 1\\right)^{\\frac{1}{\\gamma}} $$\nwhere $C_{50} = 1.0\\,\\mu\\mathrm{mol}/\\mathrm{L}$, $\\gamma = 3.0$, $\\mathrm{PTC}_{\\max} = 15$, and $\\alpha = 1.0$. A pseudo steady-state is assumed prior to reversal, so the initial free central rocuronium concentration is $C_R(0) = C_e(0)$, and the peripheral amount is $A_{R,p}(0) = \\frac{k_{12}}{k_{21}} A_{R,f}(0)$. The initial amount of free rocuronium is $A_{R,f}(0) = C_R(0) \\cdot V_c$. The initial amount of sugammadex, $A_{S,f}(0)$, is calculated from the administered dose, patient weight $W$, and sugammadex molecular weight $MW_S$:\n$$ A_{S,f}(0) = \\frac{\\mathrm{Dose}_{S,\\mathrm{mg/kg}}\\cdot W \\cdot 1000}{MW_S} $$\nInitially, no complex has formed, so $A_{RS}(0) = 0$. This fully defines the initial state vector $\\mathbf{y}(0) = [A_{R,f}(0), A_{R,p}(0), A_{S,f}(0), A_{RS}(0), C_e(0)]$.\n\nThe objective is to find the recovery time, defined as the first time $t \\in [0, 30]$ minutes at which the Train-of-Four (TOF) ratio, $R_\\mathrm{TOF}(t)$, reaches $0.9$. The TOF ratio is related to the fractional block $E(t)$ by $R_\\mathrm{TOF}(t) = 1 - E(t)$. The block $E(t)$ is given by the sigmoid $E_\\mathrm{max}$ model:\n$$ E(t) = \\frac{C_e(t)^\\gamma}{C_{50}^\\gamma + C_e(t)^\\gamma} $$\nThis defines the recovery condition $R_\\mathrm{TOF}(t) \\geq 0.9$.\nTo solve the problem, the system of ODEs is treated as an initial value problem (IVP) and integrated numerically using an appropriate solver, such as `scipy.integrate.solve_ivp`. An event-detection mechanism is employed to precisely locate the time of recovery. An event function $g(t, \\mathbf{y}) = R_\\mathrm{TOF}(t) - 0.9$ is defined, and the solver is configured to stop integration when this function crosses zero from a negative to a positive value. If the event occurs, the time is recorded. If the TOF ratio does not reach $0.9$ by $t=30$ minutes, a sentinel value of $-1.0$ is recorded. This procedure is systematically applied to each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Constructs and simulates a PK/PD model for rocuronium reversal by sugammadex\n    to compute recovery times to a TOF ratio of 0.9 for several test cases.\n    \"\"\"\n\n    # 1. Define constants and parameters independent of test cases\n    # Molecular weights (g/mol)\n    MW_R = 610.0\n    MW_S = 2178.0\n\n    # Pharmacokinetic parameters\n    t_half_R = 90.0  # min\n    t_half_S = 120.0 # min\n    k_el_R = np.log(2) / t_half_R\n    k_el_S = np.log(2) / t_half_S\n    k_el_RS = k_el_S  # Complex elimination same as sugammadex\n    k12 = 0.3        # min^-1\n    k21 = 0.2        # min^-1\n    ke0 = 0.2        # min^-1\n    kon = 1.0        # L/(umol*min)\n    Kd = 0.1         # umol/L\n    koff = Kd * kon  # min^-1\n    Vc_star = 0.2    # L/kg\n\n    # Pharmacodynamic parameters\n    C50 = 1.0        # umol/L\n    gamma = 3.0\n    PTC_max = 15.0\n    alpha = 1.0\n\n    # Store fixed parameters in a tuple for passing to functions\n    params_fixed = (k_el_R, k12, k21, k_el_S, kon, koff, k_el_RS, ke0, C50, gamma)\n\n    # 2. Define ODE system function\n    def model_ode(t, y, Vc, k_el_R, k12, k21, k_el_S, kon, koff, k_el_RS, ke0, C50, gamma):\n        \"\"\"\n        Defines the system of ordinary differential equations for the PK/PD model.\n        State vector y = [A_Rf, A_Rp, A_Sf, A_RS, Ce]\n        \"\"\"\n        A_Rf, A_Rp, A_Sf, A_RS, Ce = y\n\n        # Concentrations in central compartment (umol/L)\n        C_R = A_Rf / Vc\n        C_S = A_Sf / Vc\n\n        # Binding/dissociation rates (umol/min)\n        binding_rate = kon * C_R * C_S * Vc\n        dissociation_rate = koff * A_RS\n\n        # Derivatives (umol/min for amounts, umol/L/min for concentration)\n        dA_Rf_dt = -k_el_R * A_Rf - k12 * A_Rf + k21 * A_Rp - binding_rate + dissociation_rate\n        dA_Rp_dt = k12 * A_Rf - k21 * A_Rp\n        dA_Sf_dt = -k_el_S * A_Sf - binding_rate + dissociation_rate\n        dA_RS_dt = binding_rate - dissociation_rate - k_el_RS * A_RS\n        dCe_dt = ke0 * (C_R - Ce)\n\n        return [dA_Rf_dt, dA_Rp_dt, dA_Sf_dt, dA_RS_dt, dCe_dt]\n\n    # 3. Define event function for recovery\n    def recovery_event(t, y, Vc, k_el_R, k12, k21, k_el_S, kon, koff, k_el_RS, ke0, C50, gamma):\n        \"\"\"\n        Event function to detect when TOF ratio >= 0.9.\n        \"\"\"\n        Ce = y[4]\n        # Ensure Ce is non-negative to avoid math domain errors\n        Ce = max(0, Ce)\n        E = Ce**gamma / (C50**gamma + Ce**gamma)\n        R_TOF = 1.0 - E\n        return R_TOF - 0.9\n\n    recovery_event.terminal = True  # Stop integration when event is found\n    recovery_event.direction = 1     # Trigger only when function goes from negative to positive\n\n    # 4. Define test cases and run simulation loop\n    test_cases = [\n        (70, 10, 2),   # Case A: moderate block\n        (70, 2, 4),    # Case B: deep block\n        (70, 2, 2),    # Case C: deep block, underdose\n        (70, 1, 16),   # Case D: very deep block, high dose\n        (100, 2, 4),   # Case E: deep block in higher weight\n    ]\n\n    results = []\n    t_span = (0, 30.0)\n\n    for W, PTC, Dose_S_mg_kg in test_cases:\n        # Calculate case-specific parameters and initial conditions\n        Vc = Vc_star * W\n\n        # Initial effect-site concentration from PTC\n        base = (PTC_max / PTC)**(1.0 / alpha) - 1.0\n        # The problem statement ensures base >= 0 for all test cases\n        Ce0 = C50 * (base**(1.0 / gamma))\n\n        # Initial amounts (umol) and concentrations (umol/L)\n        CR0 = Ce0\n        A_Rf_0 = CR0 * Vc\n        A_Rp_0 = (k12 / k21) * A_Rf_0\n        A_Sf_0 = (Dose_S_mg_kg * W * 1000.0) / MW_S\n        A_RS_0 = 0.0\n\n        y0 = [A_Rf_0, A_Rp_0, A_Sf_0, A_RS_0, Ce0]\n\n        # Package all parameters for the solver\n        all_params = (Vc,) + params_fixed\n\n        # Solve the Initial Value Problem (IVP)\n        sol = solve_ivp(\n            fun=model_ode,\n            t_span=t_span,\n            y0=y0,\n            method='RK45',\n            events=recovery_event,\n            args=all_params\n        )\n\n        # Extract result\n        if sol.t_events[0].size > 0:\n            recovery_time = sol.t_events[0][0]\n            results.append(f\"{recovery_time:.2f}\")\n        else:\n            results.append(\"-1.0\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4538394"}]}