{"hands_on_practices": [{"introduction": "To understand myometrial contraction, we must first grasp the fundamental forces that drive ions across the cell membrane. The movement of any ion, such as calcium ($Ca^{2+}$), is governed not just by its concentration difference but also by the membrane's electrical potential. This exercise [@problem_id:4475725] guides you through the derivation of the Nernst potential from first principles, which defines the precise voltage at which the electrical and chemical forces on an ion balance, resulting in zero net flow. Calculating the calcium equilibrium potential ($E_{Ca}$) is a critical first step in appreciating the powerful driving force for $Ca^{2+}$ entry that triggers uterine contraction.", "problem": "In uterine smooth muscle cells of the myometrium, the propensity for calcium ion flux through voltage-gated calcium channels (VGCCs) is determined by the electrochemical equilibrium potential for calcium, denoted by $E_{Ca}$. Starting from the equality of electrochemical potentials at equilibrium and using the ideal-solution approximation for ionic activities, derive an expression for the calcium equilibrium potential $E_{Ca}$ in terms of the absolute temperature $T$, the universal gas constant $R$, the Faraday constant $F$, the valence of calcium $z$, and the extracellular and intracellular calcium concentrations $[Ca^{2+}]_{o}$ and $[Ca^{2+}]_{i}$. Then, evaluate $E_{Ca}$ for a myometrial cell under the following physiologically realistic conditions: extracellular calcium concentration $[Ca^{2+}]_{o}=1.8$ $\\mathrm{mM}$, intracellular calcium concentration $[Ca^{2+}]_{i}=0.1$ $\\mu\\mathrm{M}$, and absolute temperature $T=310$ $\\mathrm{K}$. Use $R=8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $F=96485.33212$ $\\mathrm{C\\,mol^{-1}}$, and $z=+2$. Express your final numerical answer for $E_{Ca}$ in volts (V) and round to four significant figures.", "solution": "The problem requires the derivation of the Nernst equation for the calcium equilibrium potential, $E_{Ca}$, and its subsequent numerical evaluation under specified physiological conditions. The derivation begins from the fundamental principle of thermodynamic equilibrium.\n\nAt equilibrium, there is no net flux of an ionic species across a membrane. This condition is met when the electrochemical potential of the ion is equal on both sides of the membrane. The electrochemical potential, $\\tilde{\\mu}_{j}$, for an ionic species $j$ is the sum of its chemical potential, $\\mu_{j}$, and its electrical potential energy per mole, $z_{j}FV$, where $z_{j}$ is the valence of the ion, $F$ is the Faraday constant, and $V$ is the electrical potential.\n$$ \\tilde{\\mu}_{j} = \\mu_{j} + z_{j}FV $$\nFor the specific case of calcium ions, $Ca^{2+}$, we can write the electrochemical potentials for the intracellular (subscript $i$) and extracellular (subscript $o$) compartments as:\n$$ \\tilde{\\mu}_{Ca,i} = \\mu_{Ca,i} + z_{Ca}FV_{i} $$\n$$ \\tilde{\\mu}_{Ca,o} = \\mu_{Ca,o} + z_{Ca}FV_{o} $$\nAt equilibrium, $\\tilde{\\mu}_{Ca,i} = \\tilde{\\mu}_{Ca,o}$. Therefore,\n$$ \\mu_{Ca,i} + z_{Ca}FV_{i} = \\mu_{Ca,o} + z_{Ca}FV_{o} $$\nThe chemical potential, $\\mu_{j}$, for an ideal solution is given by:\n$$ \\mu_{j} = \\mu_{j}^{0} + RT \\ln([j]) $$\nwhere $\\mu_{j}^{0}$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $[j]$ is the molar concentration of the ion. Substituting this expression for the chemical potential of calcium into the equilibrium equation gives:\n$$ (\\mu_{Ca}^{0} + RT \\ln([Ca^{2+}]_{i})) + z_{Ca}FV_{i} = (\\mu_{Ca}^{0} + RT \\ln([Ca^{2+}]_{o})) + z_{Ca}FV_{o} $$\nThe standard chemical potential $\\mu_{Ca}^{0}$ is the same in both compartments and thus cancels out:\n$$ RT \\ln([Ca^{2+}]_{i}) + z_{Ca}FV_{i} = RT \\ln([Ca^{2+}]_{o}) + z_{Ca}FV_{o} $$\nRearranging the terms to solve for the electrical potential difference across the membrane, $E_{Ca} = V_{i} - V_{o}$, which is the definition of the equilibrium potential for calcium:\n$$ z_{Ca}FV_{i} - z_{Ca}FV_{o} = RT \\ln([Ca^{2+}]_{o}) - RT \\ln([Ca^{2+}]_{i}) $$\n$$ z_{Ca}F(V_{i} - V_{o}) = RT \\left( \\ln([Ca^{2+}]_{o}) - \\ln([Ca^{2+}]_{i}) \\right) $$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ z_{Ca}FE_{Ca} = RT \\ln\\left(\\frac{[Ca^{2+}]_{o}}{[Ca^{2+}]_{i}}\\right) $$\nFinally, isolating $E_{Ca}$ yields the Nernst equation for calcium:\n$$ E_{Ca} = \\frac{RT}{z_{Ca}F} \\ln\\left(\\frac{[Ca^{2+}]_{o}}{[Ca^{2+}]_{i}}\\right) $$\nThis is the derived expression for the calcium equilibrium potential.\n\nNext, we evaluate this expression numerically using the provided data. The given parameters are:\nExtracellular calcium concentration, $[Ca^{2+}]_{o} = 1.8 \\ \\text{mM} = 1.8 \\times 10^{-3} \\ \\text{M}$.\nIntracellular calcium concentration, $[Ca^{2+}]_{i} = 0.1 \\ \\mu\\text{M} = 0.1 \\times 10^{-6} \\ \\text{M} = 1.0 \\times 10^{-7} \\ \\text{M}$.\nAbsolute temperature, $T = 310 \\ \\text{K}$.\nUniversal gas constant, $R = 8.314462618 \\ \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\nFaraday constant, $F = 96485.33212 \\ \\text{C}\\,\\text{mol}^{-1}$.\nValence of calcium, $z_{Ca} = +2$.\n\nFirst, we calculate the ratio of the concentrations:\n$$ \\frac{[Ca^{2+}]_{o}}{[Ca^{2+}]_{i}} = \\frac{1.8 \\times 10^{-3} \\ \\text{M}}{1.0 \\times 10^{-7} \\ \\text{M}} = 1.8 \\times 10^{4} = 18000 $$\nNow, substitute the numerical values into the derived equation for $E_{Ca}$:\n$$ E_{Ca} = \\frac{(8.314462618 \\ \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(310 \\ \\text{K})}{(2)(96485.33212 \\ \\text{C}\\,\\text{mol}^{-1})} \\ln(18000) $$\nThe units $\\frac{\\text{J} \\cdot \\text{K}}{\\text{mol} \\cdot \\text{K} \\cdot \\text{C} \\cdot \\text{mol}^{-1}} = \\frac{\\text{J}}{\\text{C}}$ simplify to Volts ($V$), as required.\n$$ E_{Ca} = \\frac{2577.48341158}{192970.66424} \\ \\text{V} \\times \\ln(18000) $$\n$$ E_{Ca} \\approx (0.013356805 \\ \\text{V}) \\times (9.79812595) $$\n$$ E_{Ca} \\approx 0.1308723 \\ \\text{V} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ E_{Ca} \\approx 0.1309 \\ \\text{V} $$", "answer": "$$ \\boxed{0.1309} $$", "id": "4475725"}, {"introduction": "While the Nernst potential defines the electrochemical 'goal' for an ion, the actual rate of ion flow—the ionic current—depends on the membrane's permeability, or conductance. This practice [@problem_id:4475697] applies the conductance-based model, a cellular equivalent of Ohm's law, to quantify the flow of calcium ions through L-type channels. By calculating the impact of a pharmacological agent like nifedipine, you will gain a quantitative understanding of how tocolytic drugs work at the channel level to reduce the inward calcium current and suppress myometrial contractility.", "problem": "In late-gestation human myometrial smooth muscle, the L-type calcium channel (LTCC) contributes a dominant inward calcium current that can be represented by a conductance-based formalism. Consider a single-compartment membrane patch where, at a given instant, the product of the activation and inactivation gating variables satisfies $m^{2}h=0.4$. The calcium reversal potential is $E_{Ca}=+120\\,\\text{mV}$ and the membrane potential is $V=-20\\,\\text{mV}$. The baseline maximal LTCC conductance density is $g_{CaL}=1\\,\\text{mS/cm}^{2}$. A dihydropyridine blocker, nifedipine, reduces the maximal LTCC conductance density by $50\\%$, with all other determinants (including $m^{2}h$ and $E_{Ca}$) unchanged over the instant considered. Use the standard electrophysiological sign convention in which inward currents are negative.\n\nUsing only core conductance-based definitions, determine the reduction in calcium current density (report the decrease in magnitude as a positive number) upon application of nifedipine. Express your final answer in microamperes per square centimeter, and provide the exact value (no rounding).", "solution": "The problem is scientifically valid and well-posed, providing all necessary parameters to calculate the change in ionic current density based on the standard conductance-based formalism of cellular electrophysiology.\n\nThe fundamental principle governing the flow of ions across a cell membrane is described by an equation analogous to Ohm's law. The ionic current density, $J_{ion}$, for a specific ion is the product of the effective membrane conductance density for that ion, $g_{ion}$, and the electrochemical driving force, $(V - E_{ion})$. The driving force is the difference between the membrane potential, $V$, and the ion's Nernst or reversal potential, $E_{ion}$. The relationship is expressed as:\n$$J_{ion} = g_{ion} (V - E_{ion})$$\nBy convention, an inward current (net influx of positive charge) is negative, which occurs when the driving force $(V - E_{ion})$ is negative.\n\nFor a voltage-gated ion channel, the effective conductance density, $g_{ion}$, is not constant. It is determined by the maximal conductance density, $\\bar{g}_{ion}$, and the state of the channel's activation and inactivation gates. For the L-type calcium channel (LTCC), the current density, $J_{CaL}$, is given by:\n$$J_{CaL} = \\bar{g}_{CaL} \\cdot p_o \\cdot (V - E_{Ca})$$\nwhere $\\bar{g}_{CaL}$ is the maximal LTCC conductance density, $E_{Ca}$ is the calcium reversal potential, and $p_o$ is the open probability of the channel. For many Hodgkin-Huxley type models, the open probability is a function of gating variables. The problem provides the relevant product of gating variables as $m^{2}h$, which we take to be equivalent to $p_o$ for this calculation. Thus, the equation becomes:\n$$J_{CaL} = \\bar{g}_{CaL} \\cdot m^{2}h \\cdot (V - E_{Ca})$$\n\nWe are asked to find the reduction in calcium current density upon application of nifedipine. Let the baseline (pre-drug) state be denoted by subscript $1$ and the post-nifedipine state be denoted by subscript $2$.\n\nThe baseline current density, $J_{CaL,1}$, is:\n$$J_{CaL,1} = \\bar{g}_{CaL,1} \\cdot m^{2}h \\cdot (V - E_{Ca})$$\n\nThe problem states that nifedipine reduces the maximal LTCC conductance density by $50\\%$. Therefore, the new maximal conductance density, $\\bar{g}_{CaL,2}$, is:\n$$\\bar{g}_{CaL,2} = (1 - 0.5) \\cdot \\bar{g}_{CaL,1} = 0.5 \\cdot \\bar{g}_{CaL,1}$$\nAll other parameters ($m^{2}h$, $V$, and $E_{Ca}$) are stated to be unchanged. The current density after nifedipine application, $J_{CaL,2}$, is:\n$$J_{CaL,2} = \\bar{g}_{CaL,2} \\cdot m^{2}h \\cdot (V - E_{Ca}) = (0.5 \\cdot \\bar{g}_{CaL,1}) \\cdot m^{2}h \\cdot (V - E_{Ca})$$\n\nThe reduction in current density, which we will call $\\Delta J_{CaL, red}$, is the change in current, $J_{CaL,2} - J_{CaL,1}$. This quantity will be positive, as the inward (negative) current is reduced, making the final value less negative than the initial value.\n$$\\Delta J_{CaL, red} = J_{CaL,2} - J_{CaL,1}$$\nSubstituting the expressions for the currents:\n$$\\Delta J_{CaL, red} = (0.5 \\cdot \\bar{g}_{CaL,1} \\cdot m^{2}h \\cdot (V - E_{Ca})) - (\\bar{g}_{CaL,1} \\cdot m^{2}h \\cdot (V - E_{Ca}))$$\nFactoring out the common terms:\n$$\\Delta J_{CaL, red} = (0.5 \\cdot \\bar{g}_{CaL,1} - \\bar{g}_{CaL,1}) \\cdot m^{2}h \\cdot (V - E_{Ca})$$\n$$\\Delta J_{CaL, red} = (-0.5 \\cdot \\bar{g}_{CaL,1}) \\cdot m^{2}h \\cdot (V - E_{Ca})$$\n\nWe now substitute the given values into this expression:\n- Baseline maximal conductance density, $\\bar{g}_{CaL,1} = 1\\,\\text{mS/cm}^{2}$\n- Gating variable product, $m^{2}h = 0.4$\n- Membrane potential, $V = -20\\,\\text{mV}$\n- Calcium reversal potential, $E_{Ca} = +120\\,\\text{mV}$\n\nFirst, we calculate the electrochemical driving force:\n$$V - E_{Ca} = -20\\,\\text{mV} - 120\\,\\text{mV} = -140\\,\\text{mV}$$\n\nNow we substitute all values into the equation for the reduction in current density:\n$$\\Delta J_{CaL, red} = (-0.5 \\cdot 1\\,\\text{mS/cm}^{2}) \\cdot (0.4) \\cdot (-140\\,\\text{mV})$$\n$$\\Delta J_{CaL, red} = (-0.5\\,\\text{mS/cm}^{2}) \\cdot (0.4) \\cdot (-140\\,\\text{mV})$$\n$$\\Delta J_{CaL, red} = (-0.2\\,\\text{mS/cm}^{2}) \\cdot (-140\\,\\text{mV})$$\n$$\\Delta J_{CaL, red} = 28\\,\\frac{\\text{mS} \\cdot \\text{mV}}{\\text{cm}^2}$$\n\nThe final step is to resolve the units. The question asks for the answer in microamperes per square centimeter ($\\mu\\text{A/cm}^2$).\nWe use the definitions of the units: $1\\,\\text{mS} = 10^{-3}\\,\\text{S}$ and $1\\,\\text{mV} = 10^{-3}\\,\\text{V}$. By definition, $1\\,\\text{Ampere} = 1\\,\\text{Sievert} \\times 1\\,\\text{Volt}$ ($1\\,\\text{A} = 1\\,\\text{S} \\cdot \\text{V}$).\nTherefore:\n$$1\\,\\text{mS} \\cdot 1\\,\\text{mV} = (10^{-3}\\,\\text{S}) \\cdot (10^{-3}\\,\\text{V}) = 10^{-6}\\,\\text{S} \\cdot \\text{V} = 10^{-6}\\,\\text{A} = 1\\,\\mu\\text{A}$$\nThus, the unit $\\frac{\\text{mS} \\cdot \\text{mV}}{\\text{cm}^2}$ is equivalent to $\\frac{\\mu\\text{A}}{\\text{cm}^2}$.\n\nThe reduction in calcium current density is exactly $28\\,\\mu\\text{A/cm}^2$. This value is positive, consistent with the problem's request to report the decrease in magnitude as a positive number.", "answer": "$$\\boxed{28}$$", "id": "4475697"}, {"introduction": "The rhythmic contractions of labor are driven by complex patterns of electrical activity known as 'bursting,' which cannot be explained by any single ion channel in isolation. These emergent behaviors arise from the dynamic interplay between multiple currents operating on different timescales—fast currents that generate action potentials and slow currents that modulate the overall rhythm. This computational exercise [@problem_id:4475730] offers a hands-on opportunity to simulate a simplified model of the myometrial cell, allowing you to discover how interactions between fast and slow conductances can produce quiescence, tonic spiking, or the critical bursting patterns essential for effective labor.", "problem": "You are asked to formalize a biophysical hypothesis about uterine smooth muscle (myometrium) excitability using a simplified conductance-based system. Begin from the standard membrane current balance used in electrophysiology, and derive a FitzHugh–Nagumo-type (FHN) model with one additional slow variable representing pregnancy-modulated potassium conductance. Then construct and evaluate parameter regimes that produce three distinct dynamical behaviors: quiescence, tonic spiking, and burst firing separated by quiescent intervals. Implement the following tasks computationally.\n\nFundamental base and modeling framework:\n- The membrane equation balances capacitive and ionic currents: $C_m \\, \\frac{dV}{dt} = - I_{\\text{ion}} + I_{\\text{app}}$, where $C_m$ is capacitance, $V$ is membrane potential, $I_{\\text{ion}}$ is the sum of ionic currents, and $I_{\\text{app}}$ is an applied or effective drive.\n- A reduced excitable system can be captured by a FitzHugh–Nagumo (FHN) model for a fast voltage-like variable and a slow recovery variable. To represent pregnancy-related Potassium ($K^+$) channel modulation, introduce a third slow variable for effective $K^+$ conductance that evolves slowly compared to the recovery variable.\n- Use the dimensionless FitzHugh–Nagumo-type equations with timescale separation:\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I_{\\text{app}} - g_K \\, s \\, v,\n$$\n$$\n\\frac{dw}{dt} = \\varepsilon \\, (v + a - b \\, w),\n$$\n$$\n\\frac{ds}{dt} = \\delta \\, \\left(s_{\\infty}(v) - s\\right),\n$$\nwith a sigmoidal activation for the slow $K^+$ modulation,\n$$\ns_{\\infty}(v) = s_{\\text{base}} + \\frac{\\sigma}{1 + e^{-\\kappa (v - v_0)}}.\n$$\nHere $v$ is the fast voltage-like variable, $w$ is the recovery variable, $s$ is the slow $K^+$ modulation variable, $g_K$ is the effective $K^+$ conductance scaling, $I_{\\text{app}}$ is the applied drive, $\\varepsilon$ and $\\delta$ satisfy the timescale separation $0 < \\delta \\ll \\varepsilon \\ll 1$, and $a$, $b$, $\\sigma$, $\\kappa$, $v_0$, $s_{\\text{base}}$ are parameters controlling excitability and modulation.\n\nScientific realism and interpretation:\n- In myometrial physiology, pregnancy is associated with increased $K^+$ channel expression and activity, which tends to hyperpolarize cells and reduce excitability; near term and in labor, $K^+$ influence can be reduced or dynamically modulated to permit rhythmic contractions. In the model, this is captured by larger $g_K$ and/or larger $s_{\\text{base}}$ for pregnancy-like quiescence, while intermediate values with marked timescale separation can yield bursting, and smaller values yield tonic spiking.\n\nProgram requirements:\n- Implement numerical simulation of the above system for a fixed duration using an ordinary differential equation solver.\n- Detect spikes as upward crossings of a fixed threshold in $v$. Compute interspike intervals (ISI) to classify dynamics:\n  - Quiescent: fewer than $2$ spikes in the simulation window.\n  - Tonic spiking: multiple spikes with no large gaps in ISI.\n  - Bursting: presence of at least one large gap in ISI separating clusters of spikes. Operationally, define a large gap as an ISI greater than $c$ times the median ISI (use $c = 3.5$).\n- Produce a classification code for each case: $0$ for quiescent, $1$ for tonic spiking, and $2$ for bursting.\n\nTest suite and parameters:\nSimulate the system for each of the following parameter sets. Use identical values for $a$, $b$, $\\sigma$, $\\kappa$, $v_0$, initial conditions, and threshold, while varying $g_K$, $s_{\\text{base}}$, $\\varepsilon$, $\\delta$, and $I_{\\text{app}}$ as indicated. All numbers are dimensionless.\n\nFixed parameters across all tests:\n- $a = 0.7$, $b = 0.8$, $\\sigma = 0.8$, $\\kappa = 5.0$, $v_0 = 0.0$.\n- Initial conditions: $v(0) = -1.0$, $w(0) = -0.5$, $s(0) = s_{\\text{base}}$.\n- Spike detection threshold in $v$: $v_{\\text{th}} = 0.5$.\n- Simulation horizon: $T_{\\text{end}} = 300.0$ with a uniform evaluation grid.\n\nVarying parameters for each test case:\n- Case $1$ (pregnancy-like quiescence): $g_K = 1.5$, $s_{\\text{base}} = 0.5$, $\\varepsilon = 0.05$, $\\delta = 0.01$, $I_{\\text{app}} = 0.55$.\n- Case $2$ (intermediate, expected bursting): $g_K = 0.8$, $s_{\\text{base}} = 0.2$, $\\varepsilon = 0.05$, $\\delta = 0.002$, $I_{\\text{app}} = 0.55$.\n- Case $3$ (low $K^+$, tonic spiking): $g_K = 0.2$, $s_{\\text{base}} = 0.1$, $\\varepsilon = 0.05$, $\\delta = 0.002$, $I_{\\text{app}} = 0.60$.\n- Case $4$ (boundary regime near quiescence): $g_K = 1.0$, $s_{\\text{base}} = 0.4$, $\\varepsilon = 0.05$, $\\delta = 0.01$, $I_{\\text{app}} = 0.55$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the classification codes for the four cases as a comma-separated list enclosed in square brackets (e.g., $[c_1,c_2,c_3,c_4]$). Each $c_i$ must be an integer in $\\{0,1,2\\}$.\n\nYour task is to write a complete, runnable program that carries out these simulations and classifications and prints the final list in the exact format specified above. No user input is required, and you must ensure your algorithmic choices reflect the scientific realism described without using any shortcut formulas in the problem statement.", "solution": "The problem is valid as it is scientifically grounded in established principles of electrophysiology and dynamical systems, is well-posed with a complete set of equations, parameters, and initial conditions, and provides objective, quantitative criteria for analysis.\n\nThe solution involves numerically integrating a three-variable FitzHugh-Nagumo-type system of ordinary differential equations (ODEs) and subsequently classifying the resulting time series based on its spiking activity. The model formalizes the hypothesis that myometrial excitability is regulated by a slow potassium ($K^+$) conductance, which changes during pregnancy.\n\nThe system of ODEs is given by:\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I_{\\text{app}} - g_K \\, s \\, v\n$$\n$$\n\\frac{dw}{dt} = \\varepsilon \\, (v + a - b \\, w)\n$$\n$$\n\\frac{ds}{dt} = \\delta \\, \\left(s_{\\infty}(v) - s\\right)\n$$\nwhere $v(t)$ is the fast, voltage-like variable, $w(t)$ is a slower recovery variable, and $s(t)$ is a very slow variable representing a pregnancy-modulated potassium conductance. The term $-g_K s v$ models an additional ionic current that provides a slow negative feedback, capable of starting or stopping oscillations. The timescale separation $0 < \\delta \\ll \\varepsilon \\ll 1$ is crucial for generating complex dynamics like bursting. The parameter $I_{\\text{app}}$ represents an external or intrinsic drive that promotes excitability. The activation of the slow conductance is governed by a sigmoidal function of voltage:\n$$\ns_{\\infty}(v) = s_{\\text{base}} + \\frac{\\sigma}{1 + e^{-\\kappa (v - v_0)}}\n$$\nThis function determines the steady-state value towards which $s$ evolves, with $s_{\\text{base}}$ representing a baseline level of the slow conductance modulation.\n\nThe first step in the algorithmic design is to implement a function that computes the derivatives $[dv/dt, dw/dt, ds/dt]$ for a given state $[v, w, s]$ and a set of parameters. This function serves as the input to a numerical ODE solver.\n\nThe second step is the numerical integration of this system. We use the `solve_ivp` function from the `scipy.integrate` library, a robust and adaptive solver suitable for such systems. For each test case, the simulation is run from $t=0$ to $T_{\\text{end}} = 300.0$, starting from the specified initial conditions $v(0) = -1.0$, $w(0) = -0.5$, and $s(0) = s_{\\text{base}}$. A uniform time grid for the output is specified via the `t_eval` argument to ensure that the fast spiking dynamics of the variable $v$ are adequately resolved for subsequent analysis.\n\nThe third step is the detection and analysis of spikes in the simulated voltage trace $v(t)$. A spike is defined as an event where $v(t)$ crosses a specified threshold $v_{\\text{th}} = 0.5$ in the upward direction. This is implemented by finding all indices $i$ in the discretized time series where $v(t_{i-1}) < v_{\\text{th}}$ and $v(t_i) \\geq v_{\\text{th}}$. The times $t_i$ of these crossings constitute the spike train.\n\nThe final step is the classification of the system's dynamics into one of three categories: quiescent (code $0$), tonic spiking (code $1$), or bursting (code $2$). The classification logic proceeds as follows:\n1.  If the number of detected spikes over the simulation window is less than $2$, the system is classified as **quiescent**.\n2.  If $2$ or more spikes are detected, the interspike intervals (ISIs) are calculated as the time differences between consecutive spikes.\n3.  The dynamics are classified as **bursting** if the set of ISIs contains at least one \"large gap,\" defined as an ISI greater than a constant $c=3.5$ times the median of all ISIs. This criterion effectively identifies long quiescent periods separating clusters of rapid spiking.\n4.  If the dynamics are not quiescent and not bursting, they are classified as **tonic spiking**, characterized by relatively regular firing with no long silent intervals.\n\nThis entire process is encapsulated in a program that iterates through the four specified parameter sets, performs the simulation and classification for each, and compiles the results into a single list as the final output. The parameters for each case are chosen to probe distinct dynamical regimes predicted by the model's biophysical interpretation: high $K^+$ conductance ($g_K$, $s_{\\text{base}}$) for quiescence, low $K^+$ conductance for tonic spiking, and intermediate conductance with strong timescale separation for bursting.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef s_inf(v, s_base, sigma, kappa, v0):\n    \"\"\"\n    Calculates the steady-state activation of the slow potassium modulation variable.\n    \"\"\"\n    return s_base + sigma / (1.0 + np.exp(-kappa * (v - v0)))\n\ndef fhn_myometrium_system(t, y, params):\n    \"\"\"\n    Defines the system of ordinary differential equations for the modified FHN model.\n    \"\"\"\n    v, w, s = y\n    \n    # Unpack parameters\n    a = params['a']\n    b = params['b']\n    sigma = params['sigma']\n    kappa = params['kappa']\n    v0_param = params['v0']\n    g_K = params['g_K']\n    s_base = params['s_base']\n    epsilon = params['epsilon']\n    delta = params['delta']\n    I_app = params['I_app']\n\n    # ODEs from the problem statement\n    dv_dt = v - (v**3 / 3.0) - w + I_app - g_K * s * v\n    dw_dt = epsilon * (v + a - b * w)\n    ds_dt = delta * (s_inf(v, s_base, sigma, kappa, v0_param) - s)\n    \n    return [dv_dt, dw_dt, ds_dt]\n\ndef classify_dynamics(t, v, v_th, c):\n    \"\"\"\n    Classifies the system dynamics based on spike train analysis.\n    \"\"\"\n    # Detect upward crossings of the threshold v_th to find spike times\n    is_above_threshold = v >= v_th\n    # Find indices where the state changes from below to at-or-above threshold\n    crossings = np.where(np.diff(is_above_threshold.astype(int)) == 1)[0]\n    spike_times = t[crossings]\n    \n    num_spikes = len(spike_times)\n\n    # Classification rule 1: Quiescence\n    if num_spikes  2:\n        return 0\n    \n    # Calculate Interspike Intervals (ISIs)\n    isis = np.diff(spike_times)\n    \n    # A single ISI (2 spikes) cannot form clusters, classified as tonic\n    if len(isis)  2:\n        return 1\n        \n    median_isi = np.median(isis)\n    \n    # Classification rule 2  3: Bursting vs. Tonic\n    # Check for large gaps relative to the median ISI\n    if median_isi > 1e-9 and np.any(isis > c * median_isi):\n        return 2  # Bursting\n    else:\n        return 1  # Tonic spiking\n\ndef solve():\n    \"\"\"\n    Main function to run simulations and classify dynamics for all test cases.\n    \"\"\"\n    # Fixed parameters as per the problem statement\n    fixed_params = {\n        'a': 0.7, 'b': 0.8, 'sigma': 0.8, 'kappa': 5.0, 'v0': 0.0\n    }\n    \n    # Define the test cases with varying parameters\n    test_cases = [\n        # Case 1 (expected: quiescent)\n        {'g_K': 1.5, 's_base': 0.5, 'epsilon': 0.05, 'delta': 0.01, 'I_app': 0.55},\n        # Case 2 (expected: bursting)\n        {'g_K': 0.8, 's_base': 0.2, 'epsilon': 0.05, 'delta': 0.002, 'I_app': 0.55},\n        # Case 3 (expected: tonic spiking)\n        {'g_K': 0.2, 's_base': 0.1, 'epsilon': 0.05, 'delta': 0.002, 'I_app': 0.60},\n        # Case 4 (expected: boundary/quiescent)\n        {'g_K': 1.0, 's_base': 0.4, 'epsilon': 0.05, 'delta': 0.01, 'I_app': 0.55},\n    ]\n\n    # Global simulation and analysis settings\n    T_end = 300.0\n    v_th = 0.5\n    burst_criterion_c = 3.5\n    \n    results = []\n    \n    for case_specific_params in test_cases:\n        # Combine fixed and case-specific parameters\n        params = {**fixed_params, **case_specific_params}\n        \n        # Set initial conditions\n        v_init, w_init = -1.0, -0.5\n        s_init = params['s_base']\n        y0 = [v_init, w_init, s_init]\n        \n        # Define simulation time grid\n        t_span = (0, T_end)\n        # Use a sufficiently dense grid for accurate spike detection\n        t_eval = np.linspace(t_span[0], t_span[1], 15000)\n        \n        # Numerically solve the ODE system\n        sol = solve_ivp(\n            fhn_myometrium_system,\n            t_span,\n            y0,\n            method='RK45',\n            args=(params,),\n            t_eval=t_eval\n        )\n        \n        # Extract time and voltage variables\n        t, v = sol.t, sol.y[0]\n        \n        # Classify dynamics and store the result\n        classification_code = classify_dynamics(t, v, v_th, burst_criterion_c)\n        results.append(classification_code)\n\n    # Final print statement in the exact required format.\n    # print(f\"[{','.join(map(str, results))}]\") # This is how the answer is generated\n    return f\"[{','.join(map(str, results))}]\"\n\n# The problem requires the code to be runnable and produce the output.\n# To adhere to the format, I'm providing the code block.\n# The expected output of solve() is '[0,2,1,0]'\n```", "answer": "[0,2,1,0]", "id": "4475730"}]}