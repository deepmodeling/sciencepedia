{"hands_on_practices": [{"introduction": "Effective global health strategy relies on our ability to predict the impact of interventions. This first practice focuses on a common intervention: transport vouchers designed to increase access to facility-based care. By using fundamental epidemiological principles like relative risk, you will learn to model how shifting the place of delivery can lead to a measurable reduction in population-wide maternal mortality [@problem_id:4446929].", "problem": "A low-income country is implementing a transport voucher program designed to increase the proportion of births occurring in health facilities by reducing financial barriers to travel. Facility delivery is known to have a protective effect on maternal death compared to non-facility delivery. Assume the following:\n\n- The effect measure is the Relative Risk (RR), defined as $RR = \\frac{r_{\\text{facility}}}{r_{\\text{non-facility}}}$, where $r_{\\text{facility}}$ is the risk of maternal death per delivery in a facility and $r_{\\text{non-facility}}$ is the risk of maternal death per delivery outside a facility.\n- The protective effect of facility delivery is constant and equal to $RR = 0.85$.\n- Prior to the voucher program, the fraction of births occurring in facilities is $c_{0} = 0.55$. After the voucher program, the expected fraction of births in facilities is $c_{1} = 0.75$.\n- The population-average risk of maternal death per delivery is given by the law of total probability applied to delivery location: $r(c) = c \\cdot r_{\\text{facility}} + (1 - c) \\cdot r_{\\text{non-facility}}$ for any coverage fraction $c$.\n- The transport voucher program only influences the coverage fraction $c$ and does not change $RR$, $r_{\\text{facility}}$, or $r_{\\text{non-facility}}$ themselves beyond the shift in delivery location.\n\nStarting from these definitions and assumptions, derive an expression for the proportional reduction in the population-average risk of maternal death when coverage increases from $c_{0}$ to $c_{1}$. Then compute the numerical value using $RR = 0.85$, $c_{0} = 0.55$, and $c_{1} = 0.75$. Express the final mortality reduction as a decimal fraction with no units, and round your answer to four significant figures.", "solution": "We begin from the definition of Relative Risk (RR), which relates the risk in facilities to the risk outside facilities:\n$$RR = \\frac{r_{\\text{facility}}}{r_{\\text{non-facility}}}.$$\nThis implies\n$$r_{\\text{facility}} = RR \\cdot r_{\\text{non-facility}}.$$\n\nBy the law of total probability, the population-average risk of maternal death per delivery at a facility coverage level $c$ is\n$$r(c) = c \\, r_{\\text{facility}} + (1 - c) \\, r_{\\text{non-facility}}.$$\nSubstituting $r_{\\text{facility}} = RR \\cdot r_{\\text{non-facility}}$ gives\n\\begin{align*}\nr(c) &= c \\, (RR \\cdot r_{\\text{non-facility}}) + (1 - c) \\, r_{\\text{non-facility}} \\\\\n&= r_{\\text{non-facility}} \\left( c \\, RR + (1 - c) \\right) \\\\\n&= r_{\\text{non-facility}} \\left( 1 - c (1 - RR) \\right).\n\\end{align*}\n\nLet $c_{0}$ be the pre-program coverage and $c_{1}$ be the post-program coverage. The proportional reduction in the population-average risk due to the change from $c_{0}$ to $c_{1}$ is defined as\n$$\\Delta = 1 - \\frac{r(c_{1})}{r(c_{0})}.$$\nUsing the expression for $r(c)$ derived above,\n\\begin{align*}\n\\frac{r(c_{1})}{r(c_{0})} &= \\frac{r_{\\text{non-facility}} \\left( 1 - c_{1} (1 - RR) \\right)}{r_{\\text{non-facility}} \\left( 1 - c_{0} (1 - RR) \\right)} \\\\\n&= \\frac{1 - c_{1} (1 - RR)}{1 - c_{0} (1 - RR)}.\n\\end{align*}\nTherefore,\n$$\\Delta = 1 - \\frac{1 - c_{1} (1 - RR)}{1 - c_{0} (1 - RR)}.$$\n\nNow, insert the numerical values $RR = 0.85$, $c_{0} = 0.55$, and $c_{1} = 0.75$. First compute $1 - RR$:\n$$1 - RR = 1 - 0.85 = 0.15.$$\nCompute the numerator term:\n\\begin{align*}\n1 - c_{1} (1 - RR) &= 1 - 0.75 \\times 0.15 \\\\\n&= 1 - 0.1125 \\\\\n&= 0.8875.\n\\end{align*}\nCompute the denominator term:\n\\begin{align*}\n1 - c_{0} (1 - RR) &= 1 - 0.55 \\times 0.15 \\\\\n&= 1 - 0.0825 \\\\\n&= 0.9175.\n\\end{align*}\nThus,\n\\begin{align*}\n\\frac{r(c_{1})}{r(c_{0})} &= \\frac{0.8875}{0.9175}.\n\\end{align*}\nIt is convenient to express this ratio exactly by factoring out $10{,}000$ and simplifying:\n\\begin{align*}\n\\frac{0.8875}{0.9175} &= \\frac{8875}{9175} = \\frac{355}{367}.\n\\end{align*}\nTherefore, the proportional reduction is\n\\begin{align*}\n\\Delta &= 1 - \\frac{355}{367} = \\frac{367 - 355}{367} = \\frac{12}{367}.\n\\end{align*}\nConvert to a decimal fraction and round to four significant figures:\n\\begin{align*}\n\\frac{12}{367} &\\approx 0.032698... \\\\\n\\Delta &\\approx 0.03270 \\quad \\text{(four significant figures)}.\n\\end{align*}\n\nThis value represents the expected proportional reduction in maternal mortality (as a decimal fraction) resulting from increasing facility delivery coverage from $c_{0} = 0.55$ to $c_{1} = 0.75$, given $RR = 0.85$ for facility delivery versus non-facility delivery.", "answer": "$$\\boxed{0.03270}$$", "id": "4446929"}, {"introduction": "Behind every population-level statistic are individual-level risks. The 'second delay'—the time it takes to reach a health facility—is a critical determinant of survival in obstetric emergencies. This exercise uses the principles of survival analysis to model the risk of death during transport, allowing you to quantify the direct relationship between time and survival probability [@problem_id:4446995].", "problem": "A health ministry is evaluating a national ambulance upgrade to reduce the second delay (delay in reaching appropriate care) in the Three Delays framework for maternal survival. Consider women with severe postpartum hemorrhage (PPH) being transported from rural primary centers to comprehensive emergency obstetric care. Assume that during transport there is no effective hemostatic intervention, so the instantaneous hazard (risk) of death at time $t$ conditional on survival to $t$ is time-homogeneous.\n\nUsing the core survival analysis definitions only, begin with the definition of the survival function $S(t) = \\mathbb{P}(T \\ge t)$ for a nonnegative time-to-death random variable $T$, the probability density function $f(t)$, and the hazard function $h(t) = \\lim_{\\Delta t \\to 0^{+}} \\frac{\\mathbb{P}(t \\le T < t + \\Delta t \\mid T \\ge t)}{\\Delta t}$. Under the assumption of a constant hazard $h(t) = \\lambda$ (with $\\lambda$ measured in per minute), derive the closed-form expression for $S(t)$ from these definitions.\n\nThen, for a transport time of $t = 90$ minutes and a constant hazard of $\\lambda = 0.002$ per minute, compute the survival probability $S(t)$ implied by your derivation. Express your final numerical answer as a unitless decimal rounded to four significant figures.", "solution": "The task is to first derive the survival function $S(t)$ under the assumption of a constant hazard rate $h(t) = \\lambda$, and then to compute the survival probability for a specific case.\n\nPart 1: Derivation of the Survival Function $S(t)$\n\nWe begin with the definitions provided for the survival function $S(t)$, the probability density function $f(t)$, and the hazard function $h(t)$. Let $T$ be a non-negative continuous random variable representing the time to death.\n\nThe survival function is defined as the probability that the event (death) has not occurred by time $t$:\n$$S(t) = \\mathbb{P}(T \\ge t)$$\n\nThe hazard function, or instantaneous failure rate, is defined as:\n$$h(t) = \\lim_{\\Delta t \\to 0^{+}} \\frac{\\mathbb{P}(t \\le T < t + \\Delta t \\mid T \\ge t)}{\\Delta t}$$\nThis represents the instantaneous risk of death at time $t$, given survival up to time $t$.\n\nUsing the definition of conditional probability, $\\mathbb{P}(A|B) = \\frac{\\mathbb{P}(A \\cap B)}{\\mathbb{P}(B)}$, we can rewrite the probability term in the hazard function definition:\n$$\\mathbb{P}(t \\le T < t + \\Delta t \\mid T \\ge t) = \\frac{\\mathbb{P}(\\{t \\le T < t + \\Delta t\\} \\cap \\{T \\ge t\\})}{\\mathbb{P}(T \\ge t)}$$\nThe intersection of the event that death occurs in the interval $[t, t + \\Delta t)$ and the event that death occurs at or after time $t$ is simply the event that death occurs in the interval $[t, t + \\Delta t)$. Therefore:\n$$\\mathbb{P}(t \\le T < t + \\Delta t \\mid T \\ge t) = \\frac{\\mathbb{P}(t \\le T < t + \\Delta t)}{\\mathbb{P}(T \\ge t)}$$\nThe denominator is, by definition, the survival function $S(t)$. The numerator can be expressed in terms of the survival function as the probability of surviving up to time $t$ minus the probability of surviving up to time $t + \\Delta t$:\n$$\\mathbb{P}(t \\le T < t + \\Delta t) = \\mathbb{P}(T \\ge t) - \\mathbb{P}(T \\ge t + \\Delta t) = S(t) - S(t + \\Delta t)$$\nSubstituting these expressions back into the definition of the hazard function:\n$$h(t) = \\lim_{\\Delta t \\to 0^{+}} \\frac{S(t) - S(t + \\Delta t)}{S(t) \\Delta t} = \\frac{1}{S(t)} \\lim_{\\Delta t \\to 0^{+}} \\frac{S(t) - S(t + \\Delta t)}{\\Delta t}$$\nWe recognize the limit term as being related to the definition of the derivative of $S(t)$. Specifically:\n$$\\frac{dS(t)}{dt} = S'(t) = \\lim_{\\Delta t \\to 0} \\frac{S(t + \\Delta t) - S(t)}{\\Delta t}$$\nTherefore, the limit in our expression for $h(t)$ is:\n$$\\lim_{\\Delta t \\to 0^{+}} \\frac{S(t) - S(t + \\Delta t)}{\\Delta t} = - \\lim_{\\Delta t \\to 0^{+}} \\frac{S(t + \\Delta t) - S(t)}{\\Delta t} = -S'(t)$$\nThis gives the fundamental relationship between the hazard function and the survival function:\n$$h(t) = -\\frac{S'(t)}{S(t)} = -\\frac{d}{dt} \\ln(S(t))$$\nThe problem states the assumption of a time-homogeneous (constant) hazard rate, $h(t) = \\lambda$. Substituting this into the equation yields a first-order ordinary differential equation:\n$$\\lambda = -\\frac{S'(t)}{S(t)}$$\n$$ \\frac{dS(t)}{dt} \\frac{1}{S(t)} = -\\lambda$$\nWe can solve this equation by separating variables and integrating from time $0$ to $t$:\n$$\\int_{S(0)}^{S(t)} \\frac{1}{S(u)} dS(u) = \\int_0^t -\\lambda du$$\nThe integration yields:\n$$[\\ln(S(u))]_{S(0)}^{S(t)} = [-\\lambda u]_0^t$$\n$$\\ln(S(t)) - \\ln(S(0)) = -\\lambda t$$\nBy definition, the probability of surviving past time $t=0$ is $1$, so $S(0) = \\mathbb{P}(T \\ge 0) = 1$. Since $\\ln(1) = 0$, the equation simplifies to:\n$$\\ln(S(t)) = -\\lambda t$$\nExponentiating both sides gives the closed-form expression for the survival function under a constant hazard rate:\n$$S(t) = \\exp(-\\lambda t)$$\nThis demonstrates that a constant hazard rate implies an exponential survival distribution.\n\nPart 2: Calculation of the Survival Probability\n\nWe are given the following values:\n- Transport time, $t = 90$ minutes.\n- Constant hazard rate, $\\lambda = 0.002$ per minute.\n\nWe use the derived formula $S(t) = \\exp(-\\lambda t)$ to compute the survival probability. First, we calculate the product of the hazard rate and the time:\n$$\\lambda t = (0.002 \\, \\text{min}^{-1}) \\times (90 \\, \\text{min}) = 0.18$$\nThis product is a unitless quantity, as required for the argument of the exponential function. Now we compute the survival probability:\n$$S(90) = \\exp(-0.18)$$\nUsing a calculator, we find the numerical value:\n$$S(90) \\approx 0.8352702114$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $8$, $3$, $5$, and $2$. The fifth significant figure is $7$, which is $5$ or greater, so we round up the fourth digit.\n$$S(90) \\approx 0.8353$$\nThis is the probability that a woman with severe PPH survives the $90$-minute transport under the modeled conditions.", "answer": "$$\n\\boxed{0.8353}\n$$", "id": "4446995"}, {"introduction": "Moving from analysis to action, effective health system design requires optimizing the placement of resources to maximize access for the population. This final practice challenges you to think like a health planner, using graph theory and shortest-path algorithms to model a referral network. Your goal is to strategically place new CEmONC facilities to minimize travel times for the greatest number of women, providing a concrete example of how computational methods can guide life-saving policy decisions [@problem_id:4446990].", "problem": "Design and implement a program that models referral travel time to Comprehensive Emergency Obstetric and Neonatal Care (CEmONC) facilities across multiple districts as weighted graphs and selects two new facility locations to minimize the population-weighted median time to reach any CEmONC facility. The scientific foundation is the widely accepted \"Three Delays Model\" in maternal health, in which reduction of the second delay (delay in reaching appropriate care) is achieved by decreasing travel time to CEmONC. The mathematical foundation is graph theory and shortest paths on weighted graphs.\n\nUse the following fundamental bases and definitions:\n- Let a district referral network be represented by a connected, undirected weighted graph $G = (V, E)$, with node set $V = \\{0, 1, \\ldots, n-1\\}$ and edge set $E \\subseteq V \\times V$. Each edge $(u, v) \\in E$ has an associated positive weight $w(u, v) > 0$ that represents the travel time in minutes along the road segment connecting $u$ and $v$.\n- Let the subset $F \\subseteq V$ denote nodes that currently host CEmONC-capable facilities. Let $C \\subseteq V$ denote candidate nodes eligible for the addition of new CEmONC facilities. Assume $F \\cap C = \\emptyset$.\n- Let $p: V \\to \\mathbb{R}_{>0}$ denote population weights (for example, the number of women at risk of obstetric emergencies residing near each node). For each node $v \\in V$, define $p(v)$ as its population weight.\n- For any set of facility nodes $S \\subseteq V$, define the nearest-facility travel time for node $v$ as $d_S(v)$, the length in minutes of the shortest path from $v$ to any node in $S$, computed as the minimum over all paths that connect $v$ to any facility node in $S$. All paths are evaluated as the sum of edge weights, and all edge weights are strictly positive. Use Dijkstra’s shortest path algorithm from first principles to compute $d_S(v)$.\n- Define the population-weighted median travel time to facilities for a set $S$ as follows. Let the multiset $\\{(d_S(v), p(v)) \\mid v \\in V\\}$ be sorted by $d_S(v)$ in nondecreasing order. Let $P_{\\text{tot}} = \\sum_{v \\in V} p(v)$ and let $m$ be the smallest value of $d_S(v)$ such that the cumulative sum of $p(v)$ over all nodes with $d_S(v)$ not exceeding $m$ is at least $P_{\\text{tot}}/2$. Then $m$ is the population-weighted median travel time in minutes. In the case of ties that yield identical medians, break ties by selecting the configuration with the smallest population-weighted mean travel time $\\bar{t}_S = \\left(\\sum_{v \\in V} p(v) \\cdot d_S(v)\\right) / P_{\\text{tot}}$.\n\nYour program must:\n1. For each test case, compute the baseline population-weighted median travel time $m_{\\text{base}}$ using the current facilities $F$.\n2. Among all unordered pairs $\\{c_1, c_2\\}$ where $c_1, c_2 \\in C$ and $c_1 \\neq c_2$, evaluate $S = F \\cup \\{c_1, c_2\\}$ and compute $m_S$. Select the pair that minimizes $m_S$. If multiple pairs yield the same minimal $m_S$, select the pair that minimizes $\\bar{t}_S$.\n3. Report the optimized population-weighted median $m_{\\text{opt}}$ for the selected pair and the improvement $\\Delta = m_{\\text{base}} - m_{\\text{opt}}$, expressed in minutes. If $\\Delta$ is negative due to numerical precision, treat it as $0$.\n4. Express all travel times in minutes, rounded to one decimal place.\n\nTest suite and parameters:\n- Test Case $1$ (general \"happy path\" case):\n  - Nodes: $n = 9$, $V = \\{0,1,2,3,4,5,6,7,8\\}$.\n  - Edges $E$ (each tuple is $(u, v, w)$ with $w$ in minutes):\n    - $(0, 1, 12)$, $(1, 2, 10)$, $(2, 3, 8)$, $(3, 4, 15)$, $(4, 5, 7)$, $(5, 6, 9)$, $(6, 7, 11)$, $(7, 8, 13)$,\n    - $(0, 3, 20)$, $(1, 4, 17)$, $(2, 5, 14)$, $(3, 6, 12)$, $(4, 7, 10)$, $(5, 8, 9)$.\n  - Current facilities $F = \\{0\\}$.\n  - Candidate nodes $C = \\{3, 4, 6, 8\\}$.\n  - Population weights $p(v)$ in persons: $p = [800, 1200, 1500, 1000, 2000, 1300, 900, 1100, 1600]$.\n- Test Case $2$ (boundary case with near-symmetric coverage and multiple ties):\n  - Nodes: $n = 6$, $V = \\{0,1,2,3,4,5\\}$.\n  - Edges $E$:\n    - $(0, 1, 5)$, $(1, 2, 5)$, $(2, 3, 5)$, $(3, 4, 5)$, $(4, 5, 5)$, $(0, 5, 25)$.\n  - Current facilities $F = \\{2, 4\\}$.\n  - Candidate nodes $C = \\{1, 3, 5\\}$.\n  - Population weights $p = [500, 500, 500, 500, 500, 500]$.\n- Test Case $3$ (edge case with highly concentrated population at an existing facility):\n  - Nodes: $n = 8$, $V = \\{0,1,2,3,4,5,6,7\\}$.\n  - Edges $E$:\n    - $(0, 1, 3)$, $(1, 2, 4)$, $(2, 3, 6)$, $(3, 4, 7)$, $(4, 5, 8)$, $(5, 6, 9)$, $(6, 7, 10)$.\n  - Current facilities $F = \\{0\\}$.\n  - Candidate nodes $C = \\{2, 5, 7\\}$.\n  - Population weights $p = [10000, 10, 10, 10, 10, 10, 10, 10]$.\n\nAlgorithmic requirements:\n- Implement Dijkstra’s shortest path algorithm with nonnegative edge weights directly. For the nearest-facility computation, implement the multi-source variant by initializing all nodes in $F$ with distance $0$ and applying the standard relaxation process.\n- For each candidate pair, recompute nearest-facility distances and the population-weighted median and mean as defined.\n- Ensure computational correctness through deterministic tie-breaking.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of the form $[m_{\\text{base}}, m_{\\text{opt}}, \\Delta, c_1, c_2]$, where $m_{\\text{base}}$, $m_{\\text{opt}}$, and $\\Delta$ are floats rounded to one decimal place (minutes), and $c_1$, $c_2$ are integers denoting the selected candidate nodes. Aggregate the three test case results into a single list, as in $[[m_{\\text{base}}, m_{\\text{opt}}, \\Delta, c_1, c_2],[\\ldots],[\\ldots]]$.", "solution": "The solution is designed to find an optimal pair of new CEmONC facility locations from a set of candidates by minimizing the population-weighted median travel time across a district's referral network.\n\n**1. Model Representation**\nThe district's referral network is modeled as a connected, undirected graph $G = (V, E)$.\n- The nodes $V = \\{0, 1, \\ldots, n-1\\}$ represent key locations (e.g., villages, towns, road junctions).\n- The edges $(u, v) \\in E$ represent road segments, with weights $w(u,v)$ corresponding to travel time in minutes.\n- The population at each node $v$ is given by a weight $p(v)$.\n- A subset of nodes $F \\subseteq V$ represents locations with existing CEmONC facilities.\n- A disjoint subset $C \\subseteq V$ ($F \\cap C = \\emptyset$) represents candidate locations for new facilities.\n\n**2. Core Algorithmic Components**\n\n**a. Nearest-Facility Travel Time Calculation**\nTo calculate the travel time from each node $v \\in V$ to its nearest facility in a set $S \\subseteq V$, a multi-source Dijkstra's algorithm is employed. The distance $d_S(v)$ is the shortest path from $v$ to any node in $S$. The algorithm is initialized as follows:\n- A distance array `dist` of size $n$ is initialized with $d[v] = 0$ for all $v \\in S$ and $d[v] = \\infty$ for all $v \\notin S$.\n- A min-priority queue is initialized with all facility nodes $s \\in S$, each with priority a distance of $0$.\nThe algorithm then proceeds identically to the standard Dijkstra's algorithm, iteratively extracting the node with the minimum distance from the priority queue and relaxing its outgoing edges until all reachable nodes have their shortest path distances finalized. This correctly finds $d_S(v) = \\min_{s \\in S} \\text{shortest\\_path}(v, s)$ for all $v \\in V$.\n\n**b. Population-Weighted Median and Mean Calculation**\nGiven the set of distances $\\{d_S(v) \\mid v \\in V\\}$ and population weights $\\{p(v) \\mid v \\in V\\}$, the population-weighted median and mean are calculated.\n- **Population-Weighted Median ($m_S$)**:\n  1. We form a multiset of tuples $(d_S(v), p(v))$ for all $v \\in V$.\n  2. This multiset is sorted in non-decreasing order based on the travel time $d_S(v)$.\n  3. The total population $P_{\\text{tot}} = \\sum_{v \\in V} p(v)$ is computed.\n  4. We iterate through the sorted tuples, accumulating the population weights. The median $m_S$ is the travel time of the first tuple $(d_S(v_i), p(v_i))$ for which the cumulative population sum reaches or exceeds $P_{\\text{tot}} / 2$.\n- **Population-Weighted Mean ($\\bar{t}_S$)**:\n  This is used for tie-breaking and is calculated as the weighted average:\n  $$ \\bar{t}_S = \\frac{\\sum_{v \\in V} p(v) \\cdot d_S(v)}{P_{\\text{tot}}} $$\n\n**3. Optimization Procedure**\nThe overall algorithm evaluates each possible scenario to find the optimal pair of new facilities.\n1. **Baseline Calculation**: First, the baseline population-weighted median travel time, $m_{\\text{base}}$, is computed using the initial set of facilities $F$. This involves running the multi-source Dijkstra with $S=F$ and then calculating the median.\n\n2. **Iterative Optimization**:\n   - The program generates all unique, unordered pairs $\\{c_1, c_2\\}$ of candidate nodes from the set $C$.\n   - For each pair, a new temporary facility set $S = F \\cup \\{c_1, c_2\\}$ is formed.\n   - The metrics $m_S$ and $\\bar{t}_S$ are computed for this set $S$.\n   - These metrics are compared against the best-found metrics so far. A pair $\\{c_1, c_2\\}$ becomes the new optimum if:\n     - Its median $m_S$ is strictly less than the current best median.\n     - OR, its median $m_S$ is equal to the current best median, but its mean $\\bar{t}_S$ is strictly less than the current best mean.\n     - For determinism in case of ties in both median and mean, we can select the lexicographically smallest pair (e.g., by sorting the node indices). The implementation handles this implicitly by iterating in a fixed order.\n\n3. **Final Result Generation**: Once all pairs have been evaluated, the optimal pair $\\{c_1^*, c_2^*\\}$ is identified. The optimized median is $m_{\\text{opt}} = m_{F \\cup \\{c_1^*, c_2^*\\}}$. The improvement is calculated as $\\Delta = m_{\\text{base}} - m_{\\text{opt}}$. If numerical precision causes $\\Delta$ to be a small negative number, it is floored at $0.0$. The final output for each test case is the list $[m_{\\text{base}}, m_{\\text{opt}}, \\Delta, c_1^*, c_2^*]$, with travel times rounded to one decimal place.\n\nThis structured approach ensures that all constraints are met and the globally optimal pair of new facility locations (according to the problem's criteria) is found.", "answer": "```python\nimport numpy as np\nimport heapq\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Main function to process test cases for CEmONC facility placement optimization.\n    \"\"\"\n\n    test_cases = [\n        # Test Case 1\n        {\n            \"n\": 9,\n            \"edges\": [\n                (0, 1, 12), (1, 2, 10), (2, 3, 8), (3, 4, 15), (4, 5, 7), \n                (5, 6, 9), (6, 7, 11), (7, 8, 13), (0, 3, 20), (1, 4, 17), \n                (2, 5, 14), (3, 6, 12), (4, 7, 10), (5, 8, 9)\n            ],\n            \"F\": {0},\n            \"C\": {3, 4, 6, 8},\n            \"p\": [800, 1200, 1500, 1000, 2000, 1300, 900, 1100, 1600]\n        },\n        # Test Case 2\n        {\n            \"n\": 6,\n            \"edges\": [\n                (0, 1, 5), (1, 2, 5), (2, 3, 5), (3, 4, 5), (4, 5, 5), (0, 5, 25)\n            ],\n            \"F\": {2, 4},\n            \"C\": {1, 3, 5},\n            \"p\": [500, 500, 500, 500, 500, 500]\n        },\n        # Test Case 3\n        {\n            \"n\": 8,\n            \"edges\": [\n                (0, 1, 3), (1, 2, 4), (2, 3, 6), (3, 4, 7), (4, 5, 8), \n                (5, 6, 9), (6, 7, 10)\n            ],\n            \"F\": {0},\n            \"C\": {2, 5, 7},\n            \"p\": [10000, 10, 10, 10, 10, 10, 10, 10]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n, edges, F, C, p = case[\"n\"], case[\"edges\"], case[\"F\"], case[\"C\"], np.array(case[\"p\"])\n        \n        adj = [[] for _ in range(n)]\n        for u, v, w in edges:\n            adj[u].append((v, w))\n            adj[v].append((u, w))\n\n        def multi_source_dijkstra(facility_nodes):\n            \"\"\"\n            Computes shortest path from all nodes to the nearest facility.\n            \"\"\"\n            dist = np.full(n, np.inf)\n            pq = []\n            for facility in facility_nodes:\n                dist[facility] = 0\n                heapq.heappush(pq, (0, facility))\n\n            while pq:\n                d, u = heapq.heappop(pq)\n\n                if d > dist[u]:\n                    continue\n\n                for v, weight in adj[u]:\n                    if dist[u] + weight  dist[v]:\n                        dist[v] = dist[u] + weight\n                        heapq.heappush(pq, (dist[v], v))\n            return dist\n\n        def calculate_metrics(distances, populations):\n            \"\"\"\n            Calculates population-weighted median and mean travel times.\n            \"\"\"\n            total_pop = np.sum(populations)\n            median_threshold = total_pop / 2.0\n\n            # For median calculation\n            data = sorted(zip(distances, populations))\n            \n            cumulative_pop = 0\n            weighted_median = 0\n            for d, pop_weight in data:\n                cumulative_pop += pop_weight\n                if cumulative_pop >= median_threshold:\n                    weighted_median = d\n                    break\n            \n            # For mean calculation\n            weighted_sum = np.dot(distances, populations)\n            weighted_mean = weighted_sum / total_pop if total_pop > 0 else 0\n\n            return weighted_median, weighted_mean\n\n        # 1. Compute baseline metrics\n        base_distances = multi_source_dijkstra(F)\n        m_base, _ = calculate_metrics(base_distances, p)\n\n        # 2. Find optimal pair\n        best_median = float('inf')\n        best_mean = float('inf')\n        best_pair = None\n\n        candidate_pairs = list(combinations(sorted(list(C)), 2))\n        \n        for pair in candidate_pairs:\n            c1, c2 = pair\n            current_facilities = F.union({c1, c2})\n            \n            distances = multi_source_dijkstra(current_facilities)\n            m_s, t_bar_s = calculate_metrics(distances, p)\n\n            if m_s  best_median:\n                best_median = m_s\n                best_mean = t_bar_s\n                best_pair = pair\n            elif m_s == best_median:\n                if t_bar_s  best_mean:\n                    best_mean = t_bar_s\n                    best_pair = pair\n        \n        # In case no improvement is possible, ensure variables are set\n        if best_pair is None:\n            # This happens if C has fewer than 2 elements, or if we want to handle no improvement case.\n            # Here, we can assume there's always an 'optimal' choice even if it's not an improvement.\n            # If C is not empty, the loop will run. If C has 2 members, `candidate_pairs` is empty.\n            if candidate_pairs:\n                best_pair = candidate_pairs[0]\n                current_facilities = F.union(set(best_pair))\n                distances = multi_source_dijkstra(current_facilities)\n                m_opt_val, _ = calculate_metrics(distances, p)\n            else: # No valid pairs to test\n                m_opt_val = m_base\n                best_pair = (-1, -1) # Placeholder for no valid choice\n        else:\n            m_opt_val = best_median\n\n        # 3. Report results\n        delta = m_base - m_opt_val\n        delta = max(0.0, delta)\n\n        result = [\n            round(m_base, 1),\n            round(m_opt_val, 1),\n            round(delta, 1),\n            best_pair[0],\n            best_pair[1]\n        ]\n        all_results.append(result)\n\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "4446990"}]}