{"hands_on_practices": [{"introduction": "Gene prioritization often relies on quantifying how similar a patient's set of symptoms is to the known disease profile of a gene. This begins with the fundamental task of comparing individual phenotypic terms from an ontology like the Human Phenotype Ontology (HPO). Instead of using an arbitrary formula, we can derive a robust similarity measure from information-theoretic first principles, defining similarity as a normalized ratio of shared information to total information. By working through this derivation [@problem_id:4368586], you will gain a foundational understanding of how concepts like Information Content ($IC$) and the Lowest Common Ancestor ($LCA$) are used to translate an ontology's structure into a meaningful, quantitative metric.", "problem": "In phenotype-driven gene prioritization, Human Phenotype Ontology (HPO) terms are used to quantify phenotypic similarity between a patient and candidate genes. Let a term be denoted by $t$, and define its information content as $IC(t) := -\\ln p(t)$, where $p(t)$ is the empirical probability of observing $t$ under annotation propagation along the ontology’s subsumption hierarchy (the “true path rule”). For two HPO terms $t_1$ and $t_2$, write $LCA(t_1,t_2)$ for their lowest common ancestor in the ontology’s directed acyclic graph, and let $IC(LCA)$ denote the information content of this ancestor.\n\nTask A (derivation): Starting from the following fundamental base:\n- the Shannon self-information definition $IC(t) = -\\ln p(t)$,\n- the true path rule for ontologies ensuring that annotations propagate to ancestors, and\n- the design principle that a semantic similarity should be a symmetric, scale-free function of the “shared information” and the individual information contents, bounded in $[0,1]$, and equal to $1$ if and only if $t_1=t_2$,\n\nderive a closed-form expression for a symmetric similarity $s(t_1,t_2)$ that depends only on $IC(t_1)$, $IC(t_2)$, and $IC(LCA)$, where the “shared information” between $t_1$ and $t_2$ is taken to be $IC(LCA)$ (the information content of their most informative common ancestor). Your derivation must justify the choice of normalization from first principles and produce a single explicit formula for $s(t_1,t_2)$.\n\nTask B (evaluation): For $IC(t_1)=7$, $IC(t_2)=4$, and $IC(LCA)=3$, compute the similarity $s(t_1,t_2)$. Express your final numerical result as an exact reduced fraction. No units are required.", "solution": "The problem is divided into two tasks: (A) deriving a closed-form expression for a semantic similarity measure $s(t_1, t_2)$ based on a set of axiomatic constraints, and (B) evaluating this measure for a given set of information content values.\n\n### Task A: Derivation of the Similarity Measure\n\nThe objective is to derive a closed-form expression for a symmetric similarity measure $s(t_1, t_2)$ between two ontology terms $t_1$ and $t_2$. The derivation must be based on first principles and adhere to the specified constraints.\n\nThe fundamental principles and constraints are:\n1.  The similarity $s(t_1, t_2)$ is a function of the information contents $IC(t_1)$, $IC(t_2)$, and $IC(LCA)$, where $LCA$ is the lowest common ancestor of $t_1$ and $t_2$.\n2.  The information content of a term $t$ is $IC(t) = -\\ln p(t)$, where $p(t)$ is its probability.\n3.  The shared information between $t_1$ and $t_2$ is defined as the information content of their lowest common ancestor, $IC(LCA(t_1, t_2))$.\n4.  The similarity measure must satisfy the following properties:\n    a. Symmetry: $s(t_1, t_2) = s(t_2, t_1)$.\n    b. Boundedness: $0 \\le s(t_1, t_2) \\le 1$.\n    c. Identity: $s(t_1, t_2) = 1$ if and only if $t_1 = t_2$.\n\nA widely adopted approach for constructing a similarity measure is to define it as a normalized ratio of the information shared by two entities to the total information they represent.\n\nLet us define the shared information, as specified, as $I_{shared} = IC(LCA(t_1, t_2))$.\nLet us represent the total information content of the individual terms, $t_1$ and $t_2$, by the sum of their individual information contents: $I_{total} = IC(t_1) + IC(t_2)$.\n\nBased on this principle, a preliminary form of the similarity measure could be a ratio of the shared information to the total information. However, such a simple ratio must be correctly normalized to satisfy the identity property. Let's formulate the similarity measure with a normalization constant $C$:\n$$s(t_1, t_2) = C \\cdot \\frac{I_{shared}}{I_{total}} = C \\cdot \\frac{IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)}$$\n\nWe determine the normalization constant $C$ by applying the identity property (4c): $s(t, t) = 1$.\nIf $t_1 = t_2 = t$, then the lowest common ancestor of a term with itself is the term itself, i.e., $LCA(t, t) = t$.\nConsequently, $IC(LCA(t, t)) = IC(t)$.\n\nSubstituting these into the similarity formula, we get:\n$$s(t, t) = C \\cdot \\frac{IC(t)}{IC(t) + IC(t)} = C \\cdot \\frac{IC(t)}{2 \\cdot IC(t)}$$\nFor any term $t$ with non-zero information content (i.e., $p(t) < 1$), this simplifies to:\n$$s(t, t) = C \\cdot \\frac{1}{2}$$\nTo satisfy the identity condition $s(t, t) = 1$, we must have:\n$$C \\cdot \\frac{1}{2} = 1 \\implies C = 2$$\n\nThis justifies the choice of the normalization constant. The derived closed-form expression for the similarity measure is therefore:\n$$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)}$$\nThis is commonly known as Lin's similarity measure.\n\nWe must verify that this expression satisfies all the stated properties:\n- **Symmetry**: The $LCA$ operator is symmetric, i.e., $LCA(t_1, t_2) = LCA(t_2, t_1)$, and addition is commutative. Thus, $s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)} = \\frac{2 \\cdot IC(LCA(t_2, t_1))}{IC(t_2) + IC(t_1)} = s(t_2, t_1)$. The property holds.\n- **Boundedness**: Information content $IC(t) = -\\ln p(t)$ is always non-negative, since $p(t) \\in (0, 1]$. Thus, $s(t_1, t_2) \\ge 0$. The \"true path rule\" implies that if a concept $t_1$ exists, all its ancestors, including $LCA(t_1, t_2)$, must also exist in its annotation path. This means a child term is at least as specific as its parent, so $p(t_1) \\le p(LCA(t_1, t_2))$ and $p(t_2) \\le p(LCA(t_1, t_2))$. Taking $-\\ln$ of these inequalities reverses their direction: $IC(t_1) \\ge IC(LCA(t_1, t_2))$ and $IC(t_2) \\ge IC(LCA(t_1, t_2))$. Summing these gives $IC(t_1) + IC(t_2) \\ge 2 \\cdot IC(LCA(t_1, t_2))$. Therefore, $s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)} \\le 1$. The property $0 \\le s(t_1, t_2) \\le 1$ holds.\n- **Identity**: By construction, $s(t, t) = 1$. Conversely, if $s(t_1, t_2) = 1$, then $2 \\cdot IC(LCA) = IC(t_1) + IC(t_2)$. Since we know $IC(t_1) \\ge IC(LCA)$ and $IC(t_2) \\ge IC(LCA)$, this equality can only hold if $IC(t_1) = IC(LCA)$ and $IC(t_2) = IC(LCA)$. Within a standard ontology where child terms are strictly more specific than their parents, this implies that $t_1$ and $t_2$ are not descendants of $LCA$ but are the same node as $LCA$, which in turn means $t_1 = t_2 = LCA$. The property holds.\n- **Scale-free**: The measure is a ratio of terms with the same units (bits or nats of information), making it a dimensionless, scale-free quantity.\n\nThe derived formula satisfies all conditions.\n\n### Task B: Evaluation of the Similarity Measure\n\nGiven the numerical values:\n- $IC(t_1) = 7$\n- $IC(t_2) = 4$\n- $IC(LCA) = 3$\n\nFirst, we check for consistency with the ontology structure. We must have $IC(t_1) \\ge IC(LCA)$ and $IC(t_2) \\ge IC(LCA)$. Indeed, $7 \\ge 3$ and $4 \\ge 3$, so the values are consistent.\n\nWe now use the derived formula to compute the similarity $s(t_1, t_2)$:\n$$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA)}{IC(t_1) + IC(t_2)}$$\nSubstituting the given values:\n$$s(t_1, t_2) = \\frac{2 \\cdot 3}{7 + 4}$$\n$$s(t_1, t_2) = \\frac{6}{11}$$\nThe numbers $6$ and $11$ are coprime, so the fraction is already in its reduced form.", "answer": "$$\\boxed{\\frac{6}{11}}$$", "id": "4368586"}, {"introduction": "The Information Content ($IC$) of a phenotype term is a cornerstone of many similarity metrics, but its value depends critically on how the underlying term probabilities are calculated from an annotation corpus. A naive approach can lead to scientifically unsound results. This practice [@problem_id:4368546] presents a scenario that illustrates a common pitfall: using raw, direct annotation counts versus counts that respect the ontology's \"true path rule.\" By working through the example, you will see firsthand how failing to propagate annotations up the hierarchy can invert the expected informativeness of terms and ultimately lead to the misranking of candidate genes.", "problem": "In phenotype-driven gene prioritization using the Human Phenotype Ontology (HPO), the ontology is a directed acyclic graph with an “is-a” hierarchy that obeys the true path rule: if a gene is annotated to a term $t$, it is implicitly annotated to all ancestors of $t$. Consider a background corpus of $N=1000$ genes with direct term annotations forming the following small ontology fragment: a root has two children $t_{1}$ and $t_{2}$; $t_{1}$ has children $t_{1a}$ and $t_{1b}$; $t_{2}$ has child $t_{2a}$. The directly assigned annotations in the corpus are:\n- $300$ genes directly annotated to $t_{1a}$,\n- $300$ genes directly annotated to $t_{1b}$,\n- $5$ genes directly annotated to $t_{1}$,\n- $10$ genes directly annotated to $t_{2a}$,\n- $0$ genes directly annotated to $t_{2}$ or to any other term in this fragment.\n\nYou must compare two background term probability estimates for a term $t$, denoted $p(t)$:\n- Raw term frequency: $p_{\\mathrm{raw}}(t)$ equals the fraction of genes directly annotated to $t$.\n- Term frequency plus descendants (true-path closure): $p_{\\mathrm{clo}}(t)$ equals the fraction of genes annotated to $t$ or to any descendant of $t$.\n\nAssume a patient with a single HPO query term $Q=\\{t_{1a}\\}$. Two candidate genes are given:\n- Gene $G_{A}$ is directly annotated to $t_{1}$.\n- Gene $G_{B}$ is directly annotated to $t_{1a}$.\n\nDefine the similarity between $Q$ and a candidate gene $g$ by summing, over query terms, the Information Content (IC) of the Most Informative Common Ancestor (MICA) of the query term and the gene’s annotation, where IC is defined as $\\mathrm{IC}(t)=-\\ln p(t)$ using the natural logarithm, and $\\mathrm{MICA}(q,a)$ is the ancestor shared by $q$ and $a$ with the largest IC under the chosen $p(t)$. For this setup, the similarity score for $g$ reduces to $\\mathrm{IC}(\\mathrm{MICA}(t_{1a},a_{g}))$, where $a_{g}$ is the single annotation of $g$.\n\nUsing the corpus above, compute the scores under $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$ and determine the induced ranking between $G_{A}$ and $G_{B}$ under each $p(t)$ definition. Which option is correct?\n\nA. Under $p_{\\mathrm{raw}}(t)$, $G_{A}$ ranks above $G_{B}$; under $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.\n\nB. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.\n\nC. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.\n\nD. Under $p_{\\mathrm{raw}}(t)$, $G_{B}$ ranks above $G_{A}$; under $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.", "solution": "The user has provided a computational problem in bioinformatics requiring the prioritization of genes based on phenotypic similarity using the Human Phenotype Ontology (HPO). I will first validate the problem statement and then proceed to a full derivation and evaluation of the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Ontology:** A directed acyclic graph (DAG) with an \"is-a\" hierarchy.\n-   **True Path Rule:** If a gene is annotated to a term $t$, it is implicitly annotated to all ancestors of $t$.\n-   **Corpus Size:** $N=1000$ genes.\n-   **Ontology Fragment:** A root term has children $t_1$ and $t_2$. $t_1$ has children $t_{1a}$ and $t_{1b}$. $t_2$ has child $t_{2a}$.\n-   **Direct Annotation Counts:**\n    -   $n_{\\mathrm{direct}}(t_{1a}) = 300$\n    -   $n_{\\mathrm{direct}}(t_{1b}) = 300$\n    -   $n_{\\mathrm{direct}}(t_1) = 5$\n    -   $n_{\\mathrm{direct}}(t_{2a}) = 10$\n    -   $n_{\\mathrm{direct}}(t_2) = 0$\n    -   $0$ genes directly annotated to any other term in this fragment.\n-   **Probability Definitions:**\n    -   Raw term frequency: $p_{\\mathrm{raw}}(t) = n_{\\mathrm{direct}}(t) / N$.\n    -   Term frequency plus descendants (closure): $p_{\\mathrm{clo}}(t) = n_{\\mathrm{clo}}(t) / N$, where $n_{\\mathrm{clo}}(t)$ is the count of genes annotated to $t$ or any descendant of $t$.\n-   **Patient Query:** $Q = \\{t_{1a}\\}$.\n-   **Candidate Genes:**\n    -   $G_A$ is directly annotated to $a_A = t_1$.\n    -   $G_B$ is directly annotated to $a_B = t_{1a}$.\n-   **Similarity Score:**\n    -   Information Content (IC): $\\mathrm{IC}(t) = -\\ln p(t)$.\n    -   Most Informative Common Ancestor (MICA): $\\mathrm{MICA}(q,a)$ is the common ancestor of $q$ and $a$ with the largest IC.\n    -   Score for a gene $g$: $\\mathrm{Score}(g) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, a_g))$. A higher score corresponds to a higher rank.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem uses standard, well-established concepts from bioinformatics for phenotype-driven gene prioritization, including HPO, the true path rule, Information Content (IC), and Most Informative Common Ancestor (MICA). These are fundamental to semantic similarity measures.\n-   **Well-Posed:** All necessary data and definitions are provided to compute the required scores and determine the rankings. The total count of directly annotated genes is $300+300+5+10 = 615$, which is less than the total corpus size of $N=1000$. This is realistic, as not all genes in a background set are necessarily annotated. The setup is self-contained and consistent.\n-   **Objective:** The problem is stated in precise, quantitative terms, free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. I will now proceed with the solution.\n\n### Derivation of the Solution\n\nThe task is to compute the similarity scores for genes $G_A$ and $G_B$ relative to the query term $t_{1a}$ under two different probability models, $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, and determine the resulting ranking.\n\nThe score for a gene $g$ with annotation $a_g$ is given by $\\mathrm{Score}(g) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, a_g))$.\n-   For gene $G_A$, the annotation is $a_A = t_1$. The score is $\\mathrm{Score}(G_A) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, t_1))$.\n-   For gene $G_B$, the annotation is $a_B = t_{1a}$. The score is $\\mathrm{Score}(G_B) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, t_{1a}))$.\n\nLet's analyze each probability model separately.\n\n**1. Analysis under Raw Term Frequency, $p_{\\mathrm{raw}}(t)$**\n\nFirst, we calculate the probabilities and the corresponding Information Content (IC) values for the relevant terms. The total number of genes is $N=1000$.\n-   $p_{\\mathrm{raw}}(t_{1a}) = \\frac{n_{\\mathrm{direct}}(t_{1a})}{N} = \\frac{300}{1000} = 0.3$.\n-   $p_{\\mathrm{raw}}(t_1) = \\frac{n_{\\mathrm{direct}}(t_1)}{N} = \\frac{5}{1000} = 0.005$.\n\nThe IC values are:\n-   $\\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n-   $\\mathrm{IC}_{\\mathrm{raw}}(t_1) = -\\ln(0.005) \\approx 5.298$.\n\nAn important observation is that $\\mathrm{IC}_{\\mathrm{raw}}(t_1) > \\mathrm{IC}_{\\mathrm{raw}}(t_{1a})$, even though $t_1$ is an ancestor of $t_{1a}$. This inversion of informativeness is a known artifact of using raw direct-annotation frequencies.\n\nNow we compute the scores for $G_A$ and $G_B$:\n\n**Score for $G_A$:**\n-   We need to find $\\mathrm{MICA}(t_{1a}, t_1)$. The set of common ancestors of $t_{1a}$ and $t_1$ (inclusive of the terms themselves if they are ancestors) is $\\{t_1, \\text{Root}\\}$.\n-   The problem does not specify the number of direct annotations for the root, and it is standard to assume $n_{\\mathrm{direct}}(\\text{Root}) = 0$. This would make $p_{\\mathrm{raw}}(\\text{Root}) = 0$ and $\\mathrm{IC}_{\\mathrm{raw}}(\\text{Root}) = \\infty$. In practice, such terms are excluded from MICA consideration, or a floor probability is used. We will consider only ancestors with finite IC.\n-   The only common ancestor with a non-zero probability is $t_1$. Thus, $\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_1) = t_1$.\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_A) = \\mathrm{IC}_{\\mathrm{raw}}(\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_1)) = \\mathrm{IC}_{\\mathrm{raw}}(t_1) = -\\ln(0.005) \\approx 5.298$.\n\n**Score for $G_B$:**\n-   We need to find $\\mathrm{MICA}(t_{1a}, t_{1a})$. The problem definition of MICA is \"the ancestor shared by $q$ and $a$ with the largest IC\".\n-   If we apply this definition literally, the set of common ancestors of $t_{1a}$ with itself is $\\{t_{1a}, t_1, \\text{Root}\\}$. The ICs are $\\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) \\approx 1.204$ and $\\mathrm{IC}_{\\mathrm{raw}}(t_1) \\approx 5.298$. Due to the IC inversion, the MICA would be $t_1$, not $t_{1a}$, leading to the same score as $G_A$. This is counter-intuitive; a perfect match should be maximally similar.\n-   The standard convention for semantic similarity is that the similarity of a term with itself is its own information content, which implies that $\\mathrm{MICA}(t, t) = t$. We adopt this standard interpretation, as it resolves the ambiguity and is the only path that allows for a strict ranking as implied by the options.\n-   Therefore, $\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_{1a}) = t_{1a}$.\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_B) = \\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n\n**Ranking under $p_{\\mathrm{raw}}(t)$:**\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_A) \\approx 5.298$.\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_B) \\approx 1.204$.\n-   Since $\\mathrm{Score}_{\\mathrm{raw}}(G_A) > \\mathrm{Score}_{\\mathrm{raw}}(G_B)$, $G_A$ ranks above $G_B$.\n\n**2. Analysis under Closure Term Frequency, $p_{\\mathrm{clo}}(t)$**\n\nFirst, we calculate the propagated gene counts, $n_{\\mathrm{clo}}(t)$, by summing direct annotations at a term and all its descendants according to the true path rule.\n-   $n_{\\mathrm{clo}}(t_{1a}) = n_{\\mathrm{direct}}(t_{1a}) = 300$.\n-   $n_{\\mathrm{clo}}(t_1) = n_{\\mathrm{direct}}(t_1) + n_{\\mathrm{direct}}(t_{1a}) + n_{\\mathrm{direct}}(t_{1b}) = 5 + 300 + 300 = 605$.\n-   (For completeness, other terms: $n_{\\mathrm{clo}}(t_{1b}) = 300$; $n_{\\mathrm{clo}}(t_{2a})=10$; $n_{\\mathrm{clo}}(t_2)=10$; $n_{\\mathrm{clo}}(\\text{Root})=615$).\n\nNow, calculate the probabilities $p_{\\mathrm{clo}}(t)$ and ICs.\n-   $p_{\\mathrm{clo}}(t_{1a}) = \\frac{300}{1000} = 0.3$.\n-   $p_{\\mathrm{clo}}(t_1) = \\frac{605}{1000} = 0.605$.\n\nThe IC values are:\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_1) = -\\ln(0.605) \\approx 0.5025$.\n\nUsing the closure frequency restores the expected monotonicity of IC: $p_{\\mathrm{clo}}(t_{1a}) < p_{\\mathrm{clo}}(t_1)$, so $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) > \\mathrm{IC}_{\\mathrm{clo}}(t_1)$. The child term is more informative than its parent.\n\nNow we compute the scores for $G_A$ and $G_B$:\n\n**Score for $G_A$:**\n-   We need $\\mathrm{MICA}(t_{1a}, t_1)$. The common ancestors are $\\{t_1, \\text{Root}\\}$.\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_1) \\approx 0.5025$. The IC of the root would be even lower, as its probability is higher.\n-   $\\mathrm{MICA}_{\\mathrm{clo}}(t_{1a}, t_1) = t_1$.\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_A) = \\mathrm{IC}_{\\mathrm{clo}}(t_1) = -\\ln(0.605) \\approx 0.5025$.\n\n**Score for $G_B$:**\n-   We need $\\mathrm{MICA}(t_{1a}, t_{1a})$. The common ancestors are $\\{t_{1a}, t_1, \\text{Root}\\}$.\n-   The ICs are $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) \\approx 1.204$ and $\\mathrm{IC}_{\\mathrm{clo}}(t_1) \\approx 0.5025$.\n-   The MICA is the one with the largest IC, which is $t_{1a}$. $\\mathrm{MICA}_{\\mathrm{clo}}(t_{1a}, t_{1a}) = t_{1a}$.\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_B) = \\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n\n**Ranking under $p_{\\mathrm{clo}}(t)$:**\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_A) \\approx 0.5025$.\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_B) \\approx 1.204$.\n-   Since $\\mathrm{Score}_{\\mathrm{clo}}(G_B) > \\mathrm{Score}_{\\mathrm{clo}}(G_A)$, $G_B$ ranks above $G_A$.\n\n### Summary and Option Evaluation\n\n-   Under $p_{\\mathrm{raw}}(t)$, $G_A$ ranks above $G_B$.\n-   Under $p_{\\mathrm{clo}}(t)$, $G_B$ ranks above $G_A$.\n\nThis demonstrates how the choice of background probability model, particularly its handling of the ontology structure, critically impacts gene prioritization. The raw frequency model can produce counter-intuitive results due to IC inversion, while the closure model respects the specificity hierarchy of the ontology.\n\nNow, we evaluate the provided options:\n\n**A. Under $p_{\\mathrm{raw}}(t)$, $G_{A}$ ranks above $G_{B}$; under $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.**\nThis matches our derived result.\n\n**B. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.**\nThis is incorrect. The ranking under $p_{\\mathrm{raw}}(t)$ is the opposite.\n\n**C. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.**\nThis is incorrect. The ranking under $p_{\\mathrm{clo}}(t)$ is the opposite.\n\n**D. Under $p_{\\mathrm{raw}}(t)$, $G_{B}$ ranks above $G_{A}$; under $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.**\nThis is the reverse of our derived result and is incorrect.\n\nTherefore, option A is the only correct statement.", "answer": "$$\\boxed{A}$$", "id": "4368546"}, {"introduction": "Real-world diagnostic cases involve comparing a patient's set of multiple phenotypes against genes that are often associated with a complex spectrum of traits. This requires an aggregation strategy to distill numerous term-to-term comparisons into a single, cohesive gene score. The choice of aggregation method is not neutral; different methods embody different assumptions about what constitutes a \"good\" match. This exercise [@problem_id:4368668] challenges you to compare two common scoring functions, the Best Match Average (BMA) and a simpler log-linear sum, to see how they differentially score genes with perfect but pleiotropic matches versus partial but more specific matches. This will sharpen your critical understanding of how algorithmic design choices can influence diagnostic prioritization.", "problem": "A clinical genomics team applies phenotype-driven gene prioritization using the Human Phenotype Ontology (HPO). Consider a toy ontology fragment that is a rooted directed acyclic graph where the root is the term \"Phenotypic abnormality\" with probability $p(\\text{root}) = 1$. Two major branches descend from the root: \"Neurological abnormality\" with $p(\\text{Neurological}) = 0.2$ and \"Musculoskeletal abnormality\" with $p(\\text{Musculoskeletal}) = 0.1$. The following leaf terms and their empirical population frequencies are specified, consistent with the ontology hierarchy:\n- \"Seizures\" $p(\\text{Seizures}) = 0.05$ (child of \"Neurological abnormality\"),\n- \"Peripheral neuropathy\" $p(\\text{Peripheral neuropathy}) = 0.02$ (child of \"Neurological abnormality\"),\n- \"Muscle weakness\" $p(\\text{Muscle weakness}) = 0.03$ (child of \"Musculoskeletal abnormality\").\n\nA patient presents with the HPO set $Q = \\{\\text{Peripheral neuropathy}, \\text{Muscle weakness}\\}$. Two candidate genes have HPO annotations:\n- Gene $A$: $\\{\\text{Peripheral neuropathy}, \\text{Muscle weakness}, \\text{Retinal degeneration}, \\text{Hepatosplenomegaly}, \\text{Renal cysts}, \\text{Pulmonary fibrosis}\\}$,\n- Gene $B$: $\\{\\text{Seizures}, \\text{Muscle weakness}\\}$.\n\nAssume each of the four additional terms for Gene $A$ (\"Retinal degeneration,\" \"Hepatosplenomegaly,\" \"Renal cysts,\" \"Pulmonary fibrosis\") belongs to top-level branches distinct from \"Neurological abnormality\" and \"Musculoskeletal abnormality\" (e.g., \"Eye abnormality,\" \"Abnormality of the abdomen,\" \"Abnormality of the kidney,\" \"Abnormality of the respiratory system\"), such that for any $q \\in Q$ the Most Informative Common Ancestor (MICA) between $q$ and any of these four terms is the root.\n\nUse the following fundamental, widely accepted definitions:\n- Information Content (IC): for any HPO term $t$, $\\mathrm{IC}(t) = -\\ln\\big(p(t)\\big)$,\n- Resnik semantic similarity: for terms $u,v$, $s(u,v) = \\mathrm{IC}\\big(\\mathrm{MICA}(u,v)\\big)$.\n\nDefine two set-to-set aggregation strategies:\n1. Best Match Average (BMA): for a patient set $Q$ and a gene set $G$, the BMA score is\n$$\nS_{\\mathrm{BMA}}(Q,G) = \\frac{1}{2}\\left(\\frac{1}{|Q|}\\sum_{q\\in Q}\\max_{g\\in G}s(q,g) + \\frac{1}{|G|}\\sum_{g\\in G}\\max_{q\\in Q}s(q,g)\\right).\n$$\n2. Naive Bayes log-linear score: under the independence assumption for the patient’s phenotypes and a log-linear likelihood ratio mapping to semantic similarity, the gene score is\n$$\nS_{\\mathrm{NB}}(Q,G) = \\sum_{q\\in Q}\\max_{g\\in G}s(q,g).\n$$\n\nCompute the following divergence index, which quantifies how the two aggregation strategies differentially favor Gene $A$ versus Gene $B$:\n$$\n\\Delta = \\big(S_{\\mathrm{NB}}(Q,G_A) - S_{\\mathrm{NB}}(Q,G_B)\\big) - \\big(S_{\\mathrm{BMA}}(Q,G_A) - S_{\\mathrm{BMA}}(Q,G_B)\\big).\n$$\nUse the natural logarithm for all $\\ln(\\cdot)$ operations. Express your final answer as a dimensionless number and round your answer to four significant figures.", "solution": "The problem is validated against the specified criteria before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Ontology and Probabilities:**\n    - Root term: \"Phenotypic abnormality\", $p(\\text{root}) = 1$.\n    - Parent term 1: \"Neurological abnormality\", $p(\\text{Neurological}) = 0.2$.\n    - Parent term 2: \"Musculoskeletal abnormality\", $p(\\text{Musculoskeletal}) = 0.1$.\n    - Leaf term 1: \"Seizures\", $p(\\text{Seizures}) = 0.05$. It is a child of \"Neurological abnormality\".\n    - Leaf term 2: \"Peripheral neuropathy\", $p(\\text{Peripheral neuropathy}) = 0.02$. It is a child of \"Neurological abnormality\".\n    - Leaf term 3: \"Muscle weakness\", $p(\\text{Muscle weakness}) = 0.03$. It is a child of \"Musculoskeletal abnormality\".\n- **Phenotype and Gene Sets:**\n    - Patient phenotype set: $Q = \\{\\text{Peripheral neuropathy}, \\text{Muscle weakness}\\}$. Thus, $|Q| = 2$.\n    - Gene A annotation set: $G_A = \\{\\text{Peripheral neuropathy}, \\text{Muscle weakness}, \\text{Retinal degeneration}, \\text{Hepatosplenomegaly}, \\text{Renal cysts}, \\text{Pulmonary fibrosis}\\}$. Thus, $|G_A| = 6$.\n    - Gene B annotation set: $G_B = \\{\\text{Seizures}, \\text{Muscle weakness}\\}$. Thus, $|G_B| = 2$.\n- **MICA Assumption:** For any term $q \\in Q$, the Most Informative Common Ancestor (MICA) between $q$ and any of the four terms in $G_A$ not in $Q$ (i.e., \"Retinal degeneration,\" \"Hepatosplenomegaly,\" \"Renal cysts,\" \"Pulmonary fibrosis\") is the root term.\n- **Definitions:**\n    - Information Content (IC): $\\mathrm{IC}(t) = -\\ln(p(t))$.\n    - Resnik semantic similarity: $s(u,v) = \\mathrm{IC}(\\mathrm{MICA}(u,v))$.\n    - Best Match Average (BMA) score: $S_{\\mathrm{BMA}}(Q,G) = \\frac{1}{2}\\left(\\frac{1}{|Q|}\\sum_{q\\in Q}\\max_{g\\in G}s(q,g) + \\frac{1}{|G|}\\sum_{g\\in G}\\max_{q\\in Q}s(q,g)\\right)$.\n    - Naive Bayes (NB) score: $S_{\\mathrm{NB}}(Q,G) = \\sum_{q\\in Q}\\max_{g\\in G}s(q,g)$.\n- **Target Quantity:**\n    - Divergence index: $\\Delta = \\big(S_{\\mathrm{NB}}(Q,G_A) - S_{\\mathrm{NB}}(Q,G_B)\\big) - \\big(S_{\\mathrm{BMA}}(Q,G_A) - S_{\\mathrm{BMA}}(Q,G_B)\\big)$.\n- **Calculation and Formatting:**\n    - Use natural logarithm ($\\ln$).\n    - Round the final answer to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on established concepts in bioinformatics and medical genetics, specifically phenotype-driven gene prioritization using the Human Phenotype Ontology (HPO), semantic similarity (Resnik), and common aggregation strategies (BMA, naive log-likelihood). The ontology structure and probabilities, though simplified, are consistent with real-world principles (e.g., $p(\\text{child}) \\le p(\\text{parent})$: $0.05 < 0.2$, $0.02 < 0.2$, $0.03 < 0.1$).\n- **Well-Posed:** All necessary data, definitions, and constraints are provided to compute a unique, meaningful solution for the divergence index $\\Delta$.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n- **Flaw Checklist:** The problem does not violate any of the listed flaws. It is factually sound within its defined model, is formalizable, complete, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\nThe solution is derived by systematically applying the provided definitions to the given data.\n\n**1. Calculate Information Content (IC) for Relevant Terms**\nThe IC is calculated as $\\mathrm{IC}(t) = -\\ln(p(t))$ for each required HPO term.\n- $\\mathrm{IC}(\\text{root}) = -\\ln(1) = 0$.\n- $\\mathrm{IC}(\\text{Neurological abnormality}) = -\\ln(0.2)$. Let's denote this term as \"Neuro\".\n- $\\mathrm{IC}(\\text{Musculoskeletal abnormality}) = -\\ln(0.1)$. Let's denote this term as \"Musculo\".\n- $\\mathrm{IC}(\\text{Peripheral neuropathy}) = -\\ln(0.02)$. Let's denote this term as \"PN\".\n- $\\mathrm{IC}(\\text{Muscle weakness}) = -\\ln(0.03)$. Let's denote this term as \"MW\".\n- $\\mathrm{IC}(\\text{Seizures}) = -\\ln(0.05)$.\n\n**2. Determine MICAs and Resnik Similarities**\nThe Resnik similarity $s(u,v)$ is the IC of the Most Informative Common Ancestor (MICA) of terms $u$ and $v$.\n- For any term $t$, $\\mathrm{MICA}(t,t) = t$. Thus, $s(t,t) = \\mathrm{IC}(t)$.\n- MICA(\"PN\", \"Seizures\") = \"Neuro\". Both are children of \"Neurological abnormality\".\n- MICA(\"PN\", \"MW\") = root. \"PN\" is under \"Neuro\" and \"MW\" is under \"Musculo\". Their MICA is the root.\n- By the problem statement, for any $q \\in Q$ and $g' \\in \\{\\text{Retinal degeneration, ...}\\}$, $\\mathrm{MICA}(q, g') = \\text{root}$. Thus, $s(q,g') = \\mathrm{IC}(\\text{root}) = 0$.\n\n**3. Calculate the Sum of Best Matches from Patient to Gene Sets ($S_Q(G)$)**\nThis term, $S_Q(G) = \\sum_{q\\in Q}\\max_{g\\in G}s(q,g)$, is the basis for the $S_{\\mathrm{NB}}$ score and the first part of the $S_{\\mathrm{BMA}}$ score.\n- Patient set $Q = \\{\\text{PN}, \\text{MW}\\}$.\n\nFor Gene A ($G_A$):\n- For $q = \\text{PN}$: $\\max_{g\\in G_A}s(\\text{PN},g) = s(\\text{PN},\\text{PN}) = \\mathrm{IC}(\\text{PN})$. The other similarity values are $s(\\text{PN},\\text{MW})=0$ and $s(\\text{PN},\\text{other})=0$.\n- For $q = \\text{MW}$: $\\max_{g\\in G_A}s(\\text{MW},g) = s(\\text{MW},\\text{MW}) = \\mathrm{IC}(\\text{MW})$.\n- $S_Q(G_A) = \\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})$.\n\nFor Gene B ($G_B$):\n- For $q = \\text{PN}$: $\\max_{g\\in G_B}s(\\text{PN},g) = \\max(s(\\text{PN},\\text{Seizures}), s(\\text{PN},\\text{MW})) = \\max(\\mathrm{IC}(\\text{Neuro}), \\mathrm{IC}(\\text{root})) = \\mathrm{IC}(\\text{Neuro})$.\n- For $q = \\text{MW}$: $\\max_{g\\in G_B}s(\\text{MW},g) = \\max(s(\\text{MW},\\text{Seizures}), s(\\text{MW},\\text{MW})) = \\max(\\mathrm{IC}(\\text{root}), \\mathrm{IC}(\\text{MW})) = \\mathrm{IC}(\\text{MW})$.\n- $S_Q(G_B) = \\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})$.\n\n**4. Calculate Naive Bayes Scores ($S_{\\mathrm{NB}}$) and their Difference**\n$S_{\\mathrm{NB}}(Q,G) = S_Q(G)$.\n- $S_{\\mathrm{NB}}(Q,G_A) = \\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})$.\n- $S_{\\mathrm{NB}}(Q,G_B) = \\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})$.\n- The difference is:\n  $S_{\\mathrm{NB}}(Q,G_A) - S_{\\mathrm{NB}}(Q,G_B) = (\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})) - (\\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})) = \\mathrm{IC}(\\text{PN}) - \\mathrm{IC}(\\text{Neuro})$.\n\n**5. Calculate the Sum of Best Matches from Gene to Patient Sets ($S_G(Q)$)**\nThis term, $S_G(Q) = \\sum_{g\\in G}\\max_{q\\in Q}s(q,g)$, is required for the second part of the $S_{\\mathrm{BMA}}$ score.\n\nFor Gene A ($G_A$):\n- For $g = \\text{PN}$: $\\max_{q\\in Q}s(q,\\text{PN}) = \\max(s(\\text{PN},\\text{PN}), s(\\text{MW},\\text{PN})) = \\max(\\mathrm{IC}(\\text{PN}), 0) = \\mathrm{IC}(\\text{PN})$.\n- For $g = \\text{MW}$: $\\max_{q\\in Q}s(q,\\text{MW}) = \\max(s(\\text{PN},\\text{MW}), s(\\text{MW},\\text{MW})) = \\max(0, \\mathrm{IC}(\\text{MW})) = \\mathrm{IC}(\\text{MW})$.\n- For the $4$ other genes $g'$ in $G_A$: $\\max_{q\\in Q}s(q,g') = \\max(s(\\text{PN},g'), s(\\text{MW},g')) = \\max(0,0) = 0$.\n- $S_G(G_A,Q) = \\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW}) + 4 \\times 0 = \\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})$.\n\nFor Gene B ($G_B$):\n- For $g = \\text{Seizures}$: $\\max_{q\\in Q}s(q,\\text{Seizures}) = \\max(s(\\text{PN},\\text{Seizures}), s(\\text{MW},\\text{Seizures})) = \\max(\\mathrm{IC}(\\text{Neuro}), 0) = \\mathrm{IC}(\\text{Neuro})$.\n- For $g = \\text{MW}$: $\\max_{q\\in Q}s(q,\\text{MW}) = \\mathrm{IC}(\\text{MW})$, as calculated before.\n- $S_G(G_B,Q) = \\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})$.\n\n**6. Calculate Best Match Average Scores ($S_{\\mathrm{BMA}}$) and their Difference**\n$S_{\\mathrm{BMA}}(Q,G) = \\frac{1}{2}\\left(\\frac{S_Q(G)}{|Q|} + \\frac{S_G(Q)}{|G|}\\right)$. We have $|Q|=2$, $|G_A|=6$, $|G_B|=2$.\n\n- $S_{\\mathrm{BMA}}(Q,G_A) = \\frac{1}{2}\\left(\\frac{\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})}{2} + \\frac{\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})}{6}\\right) = \\frac{1}{2}\\left(\\frac{1}{2}+\\frac{1}{6}\\right)(\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})) = \\frac{1}{2}\\left(\\frac{4}{6}\\right)(\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})) = \\frac{1}{3}(\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW}))$.\n\n- $S_{\\mathrm{BMA}}(Q,G_B) = \\frac{1}{2}\\left(\\frac{\\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})}{2} + \\frac{\\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})}{2}\\right) = \\frac{1}{2}(\\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW}))$.\n\n- The difference is:\n  $S_{\\mathrm{BMA}}(Q,G_A) - S_{\\mathrm{BMA}}(Q,G_B) = \\frac{1}{3}(\\mathrm{IC}(\\text{PN}) + \\mathrm{IC}(\\text{MW})) - \\frac{1}{2}(\\mathrm{IC}(\\text{Neuro}) + \\mathrm{IC}(\\text{MW})) = \\frac{1}{3}\\mathrm{IC}(\\text{PN}) - \\frac{1}{2}\\mathrm{IC}(\\text{Neuro}) + (\\frac{1}{3}-\\frac{1}{2})\\mathrm{IC}(\\text{MW}) = \\frac{1}{3}\\mathrm{IC}(\\text{PN}) - \\frac{1}{2}\\mathrm{IC}(\\text{Neuro}) - \\frac{1}{6}\\mathrm{IC}(\\text{MW})$.\n\n**7. Calculate the Final Divergence Index ($\\Delta$)**\n$\\Delta = \\big(S_{\\mathrm{NB}}(Q,G_A) - S_{\\mathrm{NB}}(Q,G_B)\\big) - \\big(S_{\\mathrm{BMA}}(Q,G_A) - S_{\\mathrm{BMA}}(Q,G_B)\\big)$.\n- $\\Delta = (\\mathrm{IC}(\\text{PN}) - \\mathrm{IC}(\\text{Neuro})) - \\left(\\frac{1}{3}\\mathrm{IC}(\\text{PN}) - \\frac{1}{2}\\mathrm{IC}(\\text{Neuro}) - \\frac{1}{6}\\mathrm{IC}(\\text{MW})\\right)$\n- $\\Delta = (1 - \\frac{1}{3})\\mathrm{IC}(\\text{PN}) + (-1 + \\frac{1}{2})\\mathrm{IC}(\\text{Neuro}) + \\frac{1}{6}\\mathrm{IC}(\\text{MW})$\n- $\\Delta = \\frac{2}{3}\\mathrm{IC}(\\text{PN}) - \\frac{1}{2}\\mathrm{IC}(\\text{Neuro}) + \\frac{1}{6}\\mathrm{IC}(\\text{MW})$\n\n**8. Substitute Numerical Values and Compute the Final Answer**\n- $\\Delta = \\frac{2}{3}(-\\ln(0.02)) - \\frac{1}{2}(-\\ln(0.2)) + \\frac{1}{6}(-\\ln(0.03))$\n- $\\Delta = -\\frac{2}{3}\\ln(0.02) + \\frac{1}{2}\\ln(0.2) - \\frac{1}{6}\\ln(0.03)$\n- Using a calculator:\n  - $\\ln(0.02) \\approx -3.912023$\n  - $\\ln(0.2) \\approx -1.609438$\n  - $\\ln(0.03) \\approx -3.506558$\n- $\\Delta \\approx -\\frac{2}{3}(-3.912023) + \\frac{1}{2}(-1.609438) - \\frac{1}{6}(-3.506558)$\n- $\\Delta \\approx 2.608015 - 0.804719 + 0.584426$\n- $\\Delta \\approx 2.387722$\nRounding to four significant figures, we get $2.388$.", "answer": "$$\n\\boxed{2.388}\n$$", "id": "4368668"}]}