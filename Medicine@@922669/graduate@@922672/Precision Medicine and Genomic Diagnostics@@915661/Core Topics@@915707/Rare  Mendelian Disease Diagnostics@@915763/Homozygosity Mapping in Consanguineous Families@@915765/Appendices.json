{"hands_on_practices": [{"introduction": "The cornerstone of homozygosity mapping is the direct relationship between the theoretical inbreeding coefficient, $F$, and its physical manifestation in an individual's genome. This exercise solidifies this foundational link, asking you to translate the probability of autozygosity at a single locus into an expectation across the entire genome. By working through this problem, you will see how a simple pedigree-based calculation informs the entire strategy for prioritizing and filtering variants in the search for a recessive disease gene. [@problem_id:5039749]", "problem": "A child with unexplained intellectual disability is the offspring of first cousins. In consanguineous pedigrees, the inbreeding coefficient $F$ of an individual is defined as the probability that the two alleles at a randomly chosen autosomal locus in that individual are identical by descent (autozygous). Assume the autosomal genome comprises a very large number of loci such that the expected fraction of loci that are autozygous equals the per-locus probability of autozygosity.\n\nGiven $F=0.0625$ for first-cousin mating, compute the expected fraction of the autosomal genome that is autozygous for the child. Provide your answer as a decimal rounded to four significant figures. Then, based on the principles of identity by descent and departures from Hardy–Weinberg equilibrium under inbreeding, briefly explain how this expectation informs the prioritization of recessive candidate variants during exome or genome analysis in this clinical context. No additional numerical outputs are required; ensure the single numerical answer specified above is clearly provided.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of population and medical genetics, specifically concerning inbreeding and its consequences. The terms are well-defined, the provided data ($F=0.0625$) is factually correct for the given relationship, and the question is well-posed, though the numerical part is a direct application of the provided definitions. The problem as a whole requires both a calculation and a substantive conceptual explanation, making it a valid test of understanding.\n\nThe problem asks for two parts: a numerical computation of the expected fraction of the child's autosomal genome that is autozygous, and a conceptual explanation of how this expectation informs the analysis of genomic data.\n\n**Part 1: Numerical Computation**\n\nThe inbreeding coefficient, denoted by the symbol $F$, is defined in the problem as the probability that the two alleles at a randomly chosen autosomal locus in an individual are identical by descent (IBD). An individual possessing two alleles at a locus that are IBD is said to be autozygous at that locus.\n\nTherefore, for any single locus, the probability of autozygosity is given by:\n$$\nP(\\text{autozygous at a locus}) = F\n$$\n\nThe problem states to assume that \"the expected fraction of loci that are autozygous equals the per-locus probability of autozygosity.\" Let $\\mathcal{F}_{\\text{autozygous}}$ represent the expected fraction of the autosomal genome that is autozygous. Based on the provided assumption, we can establish the following equality:\n$$\n\\mathcal{F}_{\\text{autozygous}} = E[\\text{fraction of autozygous loci}] = P(\\text{autozygous at a locus})\n$$\nCombining these statements, we arrive at the direct relationship:\n$$\n\\mathcal{F}_{\\text{autozygous}} = F\n$$\nThe problem states that the child is the offspring of first cousins and provides the corresponding inbreeding coefficient as $F = 0.0625$. This value is derived from pedigree analysis, where the probability of inheriting the same ancestral allele through both the maternal and paternal lines is calculated to be $\\frac{1}{16}$.\n\nSubstituting the given value of $F$ into our equation:\n$$\n\\mathcal{F}_{\\text{autozygous}} = 0.0625\n$$\nThe problem requires the answer as a decimal rounded to four significant figures. The value $0.0625$ is already expressed with exactly four significant figures ($6$, $2$, $5$, and the implied zero after). Therefore, no rounding is necessary. The expected fraction of the autosomal genome that is autozygous for the child is $0.0625$.\n\n**Part 2: Conceptual Explanation**\n\nThe numerical result, $\\mathcal{F}_{\\text{autozygous}} = 0.0625$ or $\\frac{1}{16}$, signifies that approximately $6.25\\%$ of the child's autosomal genome is expected to be autozygous. These autozygous regions are segments of DNA, often called runs of homozygosity (ROH), where the allele on the maternal chromosome and the allele on the paternal chromosome are physically identical copies inherited from a common ancestor. In this case, the common ancestors are one of the two pairs of shared grandparents of the first-cousin parents.\n\nThis increased homozygosity represents a departure from the genotype frequencies predicted by the Hardy–Weinberg principle for a randomly mating population. The genotype frequencies at a biallelic locus with allele frequencies $p$ and $q$ are modified by the inbreeding coefficient $F$ as follows:\n- Frequency of Homozygote $AA$: $p^2(1-F) + pF = p^2 + Fpq$\n- Frequency of Homozygote $aa$: $q^2(1-F) + qF = q^2 + Fpq$\n- Frequency of Heterozygote $Aa$: $2pq(1-F)$\n\nThe terms $+Fpq$ show an increase in homozygotes above the random-mating expectation, while the $(1-F)$ factor shows a decrease in heterozygotes.\n\nThis principle has a profound implication for recessive diseases and the analysis of genomic data. Autosomal recessive disorders are caused by having two pathogenic alleles at a specific locus. Most pathogenic alleles for severe recessive conditions are very rare in the general population. For a rare pathogenic allele with frequency $q$, the probability of an individual in a large, randomly mating population being affected (genotype $aa$) is $q^2$. If $q$ is very small, $q^2$ is extremely small.\n\nHowever, in an individual with an inbreeding coefficient $F$, the probability of being affected is $q^2(1-F) + qF$. For a rare allele where $q$ is small, the $q^2$ term is negligible, and the probability is dominated by the $qF$ term. This means that the risk of manifesting a rare recessive disease is substantially increased in the offspring of consanguineous unions. The disease-causing alleles, if carried by a common ancestor, have a probability of $F$ of becoming homozygous in the child.\n\nThis theoretical expectation directly informs the prioritization of candidate variants during exome or genome analysis for a child with an unexplained disorder, like the one described. The most plausible genetic cause is a rare, autosomal recessive condition. The causative variant is therefore expected to be in a homozygous state. Furthermore, it is highly likely that this homozygous pathogenic variant lies within one of the autozygous genomic regions (runs of homozygosity) that constitute the expected $6.25\\%$ of the child's genome.\n\nConsequently, the analytic strategy is to:\n1.  Identify all homozygous variants in the child's genome sequence.\n2.  Filter this list to retain only those variants that are rare or absent in population frequency databases.\n3.  Further prioritize these rare, homozygous variants based on their predicted functional impact (e.g., nonsense, frameshift, missense in a conserved domain).\n\nThis approach, sometimes referred to as \"homozygosity mapping,\" uses the increased probability of autozygosity as a powerful filter to drastically narrow the search space for a causal mutation. It transforms the challenge of finding one or two pathogenic variants among millions of benign variants into a more manageable task, thereby increasing the diagnostic yield and efficiency of genomic testing in consanguineous families.", "answer": "$$\n\\boxed{0.0625}\n$$", "id": "5039749"}, {"introduction": "Moving from theory to application, this practice places you in the role of a genomic data analyst tasked with identifying Runs of Homozygosity (ROH). You will implement a computational algorithm to scan synthetic SNP data, apply a minimum length threshold to filter for meaningful segments, and quantify the results. This hands-on exercise is designed to provide direct experience with the core bioinformatic methodology of homozygosity mapping and to bridge the gap between theoretical models and observed genomic data. [@problem_id:4350445]", "problem": "You are given a synthetic Single Nucleotide Polymorphism (SNP) array dataset for one individual across multiple chromosomes, along with the individual's inbreeding coefficient $F$ and an exponential breakage rate parameter $\\lambda$ for autozygous tracts. You must compute the distribution of Runs of Homozygosity (ROH) lengths using a clearly defined detection rule, then summarize the observed fraction of the genome within ROH and compare it to an expected value derived from first principles.\n\nFundamental base and definitions to be used:\n- A Run of Homozygosity (ROH) is a contiguous genomic segment wherein all assayed loci are homozygous in the individual.\n- The inbreeding coefficient $F$ is defined as the probability that the two alleles at a locus are identical by descent in the individual; thus the expected fraction of the genome that is autozygous (disregarding detection constraints) is $F$.\n- Under the Poisson recombination model across the genetic map, the lengths of autozygous tracts arising from a specific consanguinity loop behave as independent exponential random variables in Morgans, with rate $\\lambda$ (per Morgan), where $\\lambda$ equals twice the number of meioses separating the two homologous paths to the shared ancestor. Thus the survival function for tract length $L$ is $\\Pr(L \\ge \\tau) = \\exp(-\\lambda \\tau)$ for threshold $\\tau$ in Morgans.\n- If ROH detection applies a minimum length threshold $L_{\\min}$ to reduce false positives from background linkage disequilibrium, then the expected fraction of the genome that will be captured by ROH detection is $F \\cdot \\Pr(L \\ge \\tau)$ with $\\tau = L_{\\min}$ in Morgans, i.e., $F \\cdot \\exp(-\\lambda \\cdot \\tau)$.\n\nDetection rule and required computations:\n- Consider a chromosome with SNP positions given in centiMorgans (cM) and genotypes coded as $0$, $1$, or $2$, representing $BB$, $AB$, and $AA$ respectively. A site is homozygous if its genotype equals $0$ or $2$, and heterozygous if it equals $1$.\n- A ROH on a chromosome is defined as a maximal contiguous block of consecutive SNPs with no heterozygous sites. The length of a ROH is the difference (in cM) between the last and first SNP positions in the block. Single-SNP blocks have length $0$ and do not pass any positive threshold.\n- Only ROH with length greater than or equal to a specified minimum length $L_{\\min}$ (in cM) are counted. The observed genome-wide ROH fraction is the sum of lengths (in cM) of all detected ROH divided by the sum of chromosome genetic lengths (in cM).\n- The expected captured ROH fraction, accounting for the detection threshold, is $F \\cdot \\exp(-\\lambda \\cdot \\tau)$ where $\\tau = L_{\\min}/100$ is the threshold in Morgans. This value must be bounded to the interval $[0,1]$.\n- You must also compute the number of detected ROH and the mean ROH length in cM (defined as $0$ if no ROH are detected).\n\nUnits and rounding:\n- All positions and lengths are in centiMorgans (cM). Convert $L_{\\min}$ to Morgans by dividing by $100$ when evaluating the exponential model.\n- Fractions must be reported as decimals (not percentages).\n- Round the observed fraction, expected fraction, and absolute difference to $6$ decimal places. Round the mean ROH length to $3$ decimals. The number of ROH is an integer.\n\nTest suite:\n- Use the following three chromosomes across all test cases:\n  - Chromosome $1$: length $100$ cM, positions $[0,10,20,30,40,50,60,70,80,90,100]$.\n  - Chromosome $2$: length $90$ cM, positions $[0,15,30,45,60,75,90]$.\n  - Chromosome $3$: length $110$ cM, positions $[0,10,20,30,40,50,65,80,95,110]$.\n- Test Case $1$ (happy path):\n  - $F = 0.0625$, $\\lambda = 8$, $L_{\\min} = 10$ cM.\n  - Genotypes:\n    - Chromosome $1$: $[1,1,1,0,2,0,1,1,1,1,1]$.\n    - Chromosome $2$: $[1,1,1,1,1,1,1]$.\n    - Chromosome $3$: $[1,1,1,1,1,1,1,1,1,1]$.\n- Test Case $2$ (boundary where no ROH meets a higher threshold):\n  - $F = 0.0625$, $\\lambda = 8$, $L_{\\min} = 25$ cM.\n  - Genotypes identical to Test Case $1$.\n- Test Case $3$ (edge case of near-complete homozygosity):\n  - $F = 0.98$, $\\lambda = 1$, $L_{\\min} = 5$ cM.\n  - Genotypes:\n    - Chromosome $1$: $[2,2,2,2,2,2,2,2,2,2,2]$.\n    - Chromosome $2$: $[2,2,2,2,2,2,2]$.\n    - Chromosome $3$: $[2,2,2,2,2,2,2,2,2,2]$.\n- Test Case $4$ (multiple ROH across chromosomes):\n  - $F = 0.125$, $\\lambda = 4$, $L_{\\min} = 10$ cM.\n  - Genotypes:\n    - Chromosome $1$: $[1,1,1,1,1,1,1,0,0,1,1]$.\n    - Chromosome $2$: $[1,1,1,1,0,0,1]$.\n    - Chromosome $3$: $[1,1,0,0,0,0,1,1,1,1]$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for all test cases as a Python-style list of lists. For each test case, output a list with five values in the following order:\n  - Observed ROH fraction (rounded to $6$ decimals),\n  - Expected ROH fraction (rounded to $6$ decimals),\n  - Absolute difference (rounded to $6$ decimals),\n  - Number of detected ROH (integer),\n  - Mean ROH length in cM (rounded to $3$ decimals).\n- The overall output must be a single line like $[[a_1,b_1,c_1,d_1,e_1],[a_2,b_2,c_2,d_2,e_2],...]$ with no additional text.", "solution": "The problem requires the analysis of synthetic Single Nucleotide Polymorphism (SNP) data to identify Runs of Homozygosity (ROH), compute observed statistics, and compare them against theoretical expectations derived from a given model of inbreeding. The solution proceeds by first validating the problem statement and then developing a systematic algorithm based on the provided definitions and principles.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Definitions:**\n    *   A Run of Homozygosity (ROH) is a maximal contiguous block of consecutive SNPs with no heterozygous sites (genotype code $1$).\n    *   The inbreeding coefficient $F$ is the prior probability of autozygosity.\n    *   The length $L$ of an autozygous tract follows an exponential distribution with rate $\\lambda$ per Morgan, with survival function $\\Pr(L \\ge \\tau) = \\exp(-\\lambda \\tau)$.\n*   **Detection Rules:**\n    *   Genotypes are coded as $0$ (homozygous $BB$), $1$ (heterozygous $AB$), or $2$ (homozygous $AA$).\n    *   The length of an ROH is the genetic distance in centiMorgans (cM) between the last and first SNP in the run. Single-SNP runs have length $0$.\n    *   A minimum length threshold, $L_{\\min}$ (in cM), is applied; only ROHs with length $\\ge L_{\\min}$ are considered \"detected\".\n*   **Required Computations:**\n    1.  **Observed ROH fraction:** $\\frac{\\sum \\text{lengths of detected ROHs}}{\\sum \\text{chromosome genetic lengths}}$, all in cM.\n    2.  **Expected ROH fraction:** $F \\cdot \\exp(-\\lambda \\cdot \\tau)$, where $\\tau = L_{\\min} / 100$. This value is bounded to $[0, 1]$.\n    3.  **Absolute difference:** The absolute difference between the observed and expected fractions.\n    4.  **Number of detected ROHs:** An integer count.\n    5.  **Mean ROH length:** The total length of detected ROHs divided by their count (defined as $0$ if no ROH are detected).\n*   **Data and Parameters:**\n    *   A fixed set of three chromosomes with specified genetic lengths and SNP positions.\n    *   Four test cases, each with a unique set of parameters ($F$, $\\lambda$, $L_{\\min}$) and genotype data.\n*   **Formatting:**\n    *   Fractions and their difference are rounded to $6$ decimal places.\n    *   Mean ROH length is rounded to $3$ decimal places.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n*   **Scientifically Grounded:** The problem uses standard concepts from population and statistical genetics, including ROH, inbreeding coefficient ($F$), and the exponential model for the length of segments identical by descent. These are simplified but fundamentally sound principles.\n*   **Well-Posed:** All definitions, data, and computational rules are provided explicitly and without ambiguity. The problem is self-contained and provides a clear path to a unique solution for each test case.\n*   **Objective:** The problem statement is free of subjective language and relies entirely on formalizable, quantitative definitions.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is scientifically grounded, well-posed, and objective. We may proceed with a principled solution.\n\n### Algorithmic Solution Design\n\nThe solution is structured to process each test case by applying the specified rules in a series of logical steps.\n\n**1. Data Representation**\nThe static chromosome data (lengths and SNP positions) and the per-case parameters ($F$, $\\lambda$, $L_{\\min}$) and genotype data are organized for processing. The total genetic length of the genome is the sum of the individual chromosome lengths: $100 + 90 + 110 = 300$ cM.\n\n**2. ROH Detection Algorithm**\nFor each chromosome within a test case, we implement an algorithm to identify all maximal runs of homozygous SNPs.\n*   A chromosome's SNP genotypes are scanned sequentially. A genotype is homozygous if it is not equal to $1$.\n*   We use a stateful iteration. When a homozygous SNP is encountered, we mark its index as the potential start of a run.\n*   The run continues as long as consecutive SNPs remain homozygous.\n*   The run terminates when a heterozygous SNP is found or the end of the chromosome's SNP list is reached.\n*   Upon termination of a homozygous run from a `start_index` to an `end_index`, the length of the run is calculated if `end_index` $\\ge$ `start_index`. The length $L_{ROH}$ is defined as the difference in genetic map position: $L_{ROH} = \\text{position}[\\text{end\\_index}] - \\text{position}[\\text{start\\_index}]$. Note that for a single-SNP run, `start_index` = `end_index`, yielding a length of $0$, consistent with the problem definition.\n*   This process is repeated for all chromosomes to generate a list of all potential ROHs and their lengths.\n\n**3. Filtering and Aggregation of Observed Statistics**\nThe list of potential ROHs is filtered based on the minimum length criterion, $L_{\\min}$.\n*   A list of \"detected\" ROH lengths is created, containing only those $L_{ROH}$ for which $L_{ROH} \\ge L_{\\min}$.\n*   From this list, the following observed statistics are computed:\n    *   Total detected ROH length, $\\sum L_{detected}$.\n    *   Number of detected ROHs, $N_{detected}$.\n    *   Observed ROH fraction: $f_{obs} = \\frac{\\sum L_{detected}}{\\text{Total Genome Length}}$. This is rounded to $6$ decimal places.\n    *   Mean ROH length: $\\bar{L}_{detected} = \\frac{\\sum L_{detected}}{N_{detected}}$ if $N_{detected}  0$, otherwise $0$. This is rounded to $3$ decimal places.\n\n**4. Calculation of Expected Statistics**\nThe theoretical expectation for the fraction of the genome covered by detectable ROHs is calculated based on the provided model.\n*   The minimum length threshold is converted from centiMorgans to Morgans: $\\tau = L_{\\min} / 100$.\n*   The expected fraction, $f_{exp}$, is calculated as the product of the inbreeding coefficient and the probability that an autozygous segment exceeds the length threshold:\n    $$f_{exp} = F \\cdot \\exp(-\\lambda \\tau)$$\n*   This value is rounded to $6$ decimal places. Per the problem statement, it is implicitly bounded within $[0, 1]$.\n\n**5. Final Outputs**\nThe final required outputs for each test case are assembled:\n*   The rounded observed fraction, $f_{obs}$.\n*   The rounded expected fraction, $f_{exp}$.\n*   The absolute difference, $|f_{obs} - f_{exp}|$, rounded to $6$ decimal places.\n*   The integer count of detected ROHs, $N_{detected}$.\n*   The rounded mean ROH length, $\\bar{L}_{detected}$.\n\nThis structured approach ensures that all definitions and constraints from the problem statement are correctly and systematically applied to produce the final results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for ROH analysis and print results.\n    \"\"\"\n    \n    # Define the genomic scaffold (constant across all test cases)\n    # Chromosome lengths and SNP positions in centiMorgans (cM)\n    chromosome_data = [\n        {\n            \"id\": 1,\n            \"length_cm\": 100.0,\n            \"positions_cm\": [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]\n        },\n        {\n            \"id\": 2,\n            \"length_cm\": 90.0,\n            \"positions_cm\": [0, 15, 30, 45, 60, 75, 90]\n        },\n        {\n            \"id\": 3,\n            \"length_cm\": 110.0,\n            \"positions_cm\": [0, 10, 20, 30, 40, 50, 65, 80, 95, 110]\n        }\n    ]\n\n    total_genome_length_cm = sum(c[\"length_cm\"] for c in chromosome_data)\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"params\": {\"F\": 0.0625, \"lambda\": 8, \"L_min_cm\": 10},\n            \"genotypes\": [\n                [1, 1, 1, 0, 2, 0, 1, 1, 1, 1, 1],  # Chr 1\n                [1, 1, 1, 1, 1, 1, 1],              # Chr 2\n                [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]      # Chr 3\n            ]\n        },\n        {\n            \"params\": {\"F\": 0.0625, \"lambda\": 8, \"L_min_cm\": 25},\n            \"genotypes\": [\n                [1, 1, 1, 0, 2, 0, 1, 1, 1, 1, 1],  # Chr 1\n                [1, 1, 1, 1, 1, 1, 1],              # Chr 2\n                [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]      # Chr 3\n            ]\n        },\n        {\n            \"params\": {\"F\": 0.98, \"lambda\": 1, \"L_min_cm\": 5},\n            \"genotypes\": [\n                [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],  # Chr 1\n                [2, 2, 2, 2, 2, 2, 2],              # Chr 2\n                [2, 2, 2, 2, 2, 2, 2, 2, 2, 2]      # Chr 3\n            ]\n        },\n        {\n            \"params\": {\"F\": 0.125, \"lambda\": 4, \"L_min_cm\": 10},\n            \"genotypes\": [\n                [1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1],  # Chr 1\n                [1, 1, 1, 1, 0, 0, 1],              # Chr 2\n                [1, 1, 0, 0, 0, 0, 1, 1, 1, 1]      # Chr 3\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        F = case[\"params\"][\"F\"]\n        lambda_val = case[\"params\"][\"lambda\"]\n        L_min_cm = case[\"params\"][\"L_min_cm\"]\n        genotypes_by_chr = case[\"genotypes\"]\n\n        detected_roh_lengths = []\n\n        for i, chr_info in enumerate(chromosome_data):\n            positions = chr_info[\"positions_cm\"]\n            genotypes = genotypes_by_chr[i]\n            \n            start_index = None\n            for j, genotype in enumerate(genotypes):\n                is_homozygous = (genotype != 1)\n\n                if is_homozygous and start_index is None:\n                    start_index = j\n                \n                if (not is_homozygous or j == len(genotypes) - 1) and start_index is not None:\n                    end_index = j - 1 if not is_homozygous else j\n                    \n                    if end_index = start_index:\n                        roh_length = positions[end_index] - positions[start_index]\n                        if roh_length = L_min_cm:\n                            detected_roh_lengths.append(roh_length)\n                    \n                    start_index = None\n\n        # Calculate observed statistics\n        total_detected_roh_length = sum(detected_roh_lengths)\n        num_detected_roh = len(detected_roh_lengths)\n\n        obs_fraction = total_detected_roh_length / total_genome_length_cm if total_genome_length_cm > 0 else 0\n        mean_roh_length = total_detected_roh_length / num_detected_roh if num_detected_roh > 0 else 0\n\n        # Calculate expected statistics\n        tau_Morgans = L_min_cm / 100.0\n        exp_fraction = F * np.exp(-lambda_val * tau_Morgans)\n        \n        # Calculate absolute difference\n        abs_diff = abs(obs_fraction - exp_fraction)\n\n        # Format results according to specifications\n        result_for_case = [\n            round(obs_fraction, 6),\n            round(exp_fraction, 6),\n            round(abs_diff, 6),\n            num_detected_roh,\n            round(mean_roh_length, 3)\n        ]\n        results.append(result_for_case)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4350445"}, {"introduction": "Real-world genomic data is rarely perfect; genotyping errors can introduce apparent heterozygous calls within a truly autozygous region, complicating ROH detection. This practice addresses this critical challenge by moving from a rigid definition of homozygosity to a more realistic, statistical one. You will derive a model for genotyping error and use it to establish a quality control threshold, learning how to balance the need to detect true ROHs against the risk of including false positives. [@problem_id:4350448]", "problem": "A clinical laboratory is performing homozygosity mapping in a consanguineous family to localize a recessive disease locus. In a run of homozygosity (ROH), a truly autozygous region should be homozygous at every biallelic single-nucleotide polymorphism (SNP), but laboratory genotyping errors can produce spurious heterozygous genotype calls. Consider a candidate ROH in a proband that spans $3500$ informative biallelic SNP markers. Assume the following foundational model:\n\n- Each SNP is truly homozygous within the ROH.\n- Genotype calling errors arise as independent per-allele base-calling flips: each allele independently flips to the other allele with probability $\\epsilon$, and remains correct with probability $1 - \\epsilon$.\n- Across markers, errors are independent and identically distributed.\n- The laboratory sets a one-sided exceedance risk tolerance $\\alpha$ for the number of heterozygous calls observed within a true ROH: the maximum heterozygous allowance is the smallest integer $k$ such that the probability that the observed heterozygous count within a true ROH exceeds $k$ is at most $\\alpha$. To make this computable in routine diagnostics, the laboratory uses a normal approximation to the binomial distribution without continuity correction.\n\nGiven $\\epsilon = 1.5 \\times 10^{-3}$, $n = 3500$, and $\\alpha = 0.01$ (all probabilities expressed as decimals), do the following:\n\n1. From first principles of independent per-allele errors at a biallelic SNP, derive the per-marker probability that a truly homozygous SNP is called heterozygous, then compute the expected number $E$ of false heterozygous genotype calls within this ROH.\n2. Using a binomial model for the count of false heterozygous calls and the stated normal approximation, compute the integer maximum heterozygous allowance $H_{\\max}$ defined as the smallest integer $k$ for which the one-sided exceedance probability is at most $\\alpha$.\n\nRound $E$ to four significant figures. Report $H_{\\max}$ as an integer. Provide your final result as a row matrix $\\begin{pmatrix} E  H_{\\max} \\end{pmatrix}$ without units.", "solution": "The user has provided a problem in statistical genetics concerning homozygosity mapping. The first step is to validate the problem statement.\n\n### Step 1: Extract Givens\n-   Number of informative biallelic SNP markers, $n = 3500$.\n-   All SNPs are truly homozygous within the candidate Run of Homozygosity (ROH).\n-   Independent per-allele base-calling error probability, $\\epsilon = 1.5 \\times 10^{-3}$.\n-   Probability of an allele being called correctly, $1 - \\epsilon$.\n-   One-sided exceedance risk tolerance for the count of heterozygous calls, $\\alpha = 0.01$.\n-   Maximum heterozygous allowance, $H_{\\max}$, is defined as the smallest integer $k$ such that the probability of the observed heterozygous count exceeding $k$ is at most $\\alpha$.\n-   The calculation must use a normal approximation to the binomial distribution without continuity correction.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The model of genotyping error, while simplified, is a standard representation used in bioinformatics and statistical genetics for quality control and data analysis. Homozygosity mapping is a well-established technique for identifying recessive disease loci in consanguineous pedigrees. The parameters provided ($n$, $\\epsilon$, $\\alpha$) are realistic for a typical genotyping array experiment. The problem is well-posed, providing all necessary information and specifying the exact statistical approximation to be used, which ensures a unique solution. The language is objective and precise. The problem is self-contained and free from internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Part 1: Expected Number of False Heterozygous Calls\nLet us first derive the probability, $p_{\\text{het}}$, that a single, truly homozygous SNP marker is incorrectly called as heterozygous. Assume the true genotype is $A/A$. The two alleles are read independently. An incorrect call, or a \"flip\" to the alternative allele $B$, occurs with probability $\\epsilon$. A correct call occurs with a probability of $1 - \\epsilon$.\n\nA heterozygous call ($A/B$) is made if one of the two alleles is read correctly and the other is read incorrectly. There are two mutually exclusive ways for this to happen:\n1.  The first allele is read correctly ($A$) and the second is read incorrectly ($B$). The probability of this event is $(1 - \\epsilon) \\times \\epsilon$.\n2.  The first allele is read incorrectly ($B$) and the second is read correctly ($A$). The probability of this event is $\\epsilon \\times (1 - \\epsilon)$.\n\nThe total probability of a false heterozygous call for a single marker is the sum of these probabilities:\n$$p_{\\text{het}} = (1 - \\epsilon)\\epsilon + \\epsilon(1 - \\epsilon) = 2\\epsilon(1 - \\epsilon)$$\nGiven $\\epsilon = 1.5 \\times 10^{-3}$:\n$$p_{\\text{het}} = 2(1.5 \\times 10^{-3})(1 - 1.5 \\times 10^{-3}) = 2(0.0015)(0.9985) = 0.0029955$$\nLet $X$ be the random variable representing the total number of false heterozygous calls across the $n=3500$ markers. Since the errors at each marker are independent and identically distributed, $X$ follows a binomial distribution with parameters $n$ and $p_{\\text{het}}$:\n$$X \\sim \\text{Binomial}(n, p_{\\text{het}})$$\nThe expected number of false heterozygous calls, $E$, is the expectation of $X$:\n$$E = E[X] = n p_{\\text{het}}$$\nSubstituting the given values:\n$$E = 3500 \\times 0.0029955 = 10.48425$$\nThe problem requires this value to be rounded to four significant figures.\n$$E \\approx 10.48$$\n\n### Part 2: Maximum Heterozygous Allowance ($H_{\\max}$)\nThe maximum heterozygous allowance, $H_{\\max}$, is defined as the smallest integer $k$ such that the probability of observing more than $k$ false heterozygous calls is at most $\\alpha$. Mathematically:\n$$H_{\\max} = \\min \\{k \\in \\mathbb{Z} \\mid P(X > k) \\leq \\alpha\\}$$\nWe are instructed to use a normal approximation to the binomial distribution for $X$. Let $Y$ be a normal random variable approximating $X$, so $Y \\sim N(\\mu, \\sigma^2)$, where:\n-   Mean: $\\mu = n p_{\\text{het}} = 10.48425$\n-   Variance: $\\sigma^2 = n p_{\\text{het}}(1 - p_{\\text{het}})$\n\nFirst, we compute the variance and standard deviation:\n$$\\sigma^2 = 10.48425 \\times (1 - 0.0029955) = 10.48425 \\times 0.9970045 \\approx 10.45289$$\n$$\\sigma = \\sqrt{10.45289} \\approx 3.233093$$\nThe condition $P(X > k) \\leq \\alpha$ is approximated by $P(Y > k) \\leq \\alpha$, with $\\alpha = 0.01$. We standardize the normal variable $Y$ to a standard normal variable $Z \\sim N(0, 1)$ where $Z = (Y - \\mu)/\\sigma$.\n$$P\\left(Z  \\frac{k - \\mu}{\\sigma}\\right) \\leq \\alpha$$\nLet $z_{\\alpha}$ be the upper-tail critical value of the standard normal distribution such that $P(Z  z_{\\alpha}) = \\alpha$. This is equivalent to $P(Z \\leq z_{\\alpha}) = 1 - \\alpha$. For $\\alpha = 0.01$, we need the value $z_{0.01}$ corresponding to a cumulative probability of $0.99$. From standard normal tables or a calculator, this value is:\n$$z_{0.01} \\approx 2.3263$$\nFor the inequality $P(Z  (k - \\mu)/\\sigma) \\leq \\alpha$ to hold, we must have:\n$$\\frac{k - \\mu}{\\sigma} \\geq z_{\\alpha}$$\nSolving for $k$:\n$$k \\geq \\mu + z_{\\alpha}\\sigma$$\nSubstituting the computed values for $\\mu$, $\\sigma$, and $z_{0.01}$:\n$$k \\geq 10.48425 + (2.32634787 \\times 3.23309302)$$\n$$k \\geq 10.48425 + 7.5202633$$\n$$k \\geq 18.0045133$$\nSince $H_{\\max}$ is the smallest integer $k$ that satisfies this condition, we must round up to the next integer.\n$$H_{\\max} = 19$$\nThe final results are $E \\approx 10.48$ and $H_{\\max} = 19$.", "answer": "$$\\boxed{\\begin{pmatrix} 10.48  19 \\end{pmatrix}}$$", "id": "4350448"}]}