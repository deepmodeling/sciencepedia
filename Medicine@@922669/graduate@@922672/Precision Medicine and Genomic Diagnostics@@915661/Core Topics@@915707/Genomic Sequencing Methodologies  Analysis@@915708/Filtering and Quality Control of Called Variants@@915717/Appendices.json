{"hands_on_practices": [{"introduction": "A crucial first step in evaluating a candidate variant for a rare disease is to check its frequency in large population databases. If a variant is more common in the general population than the disease itself, it is unlikely to be the primary cause. This exercise [@problem_id:4340090] will guide you through the process of calculating a maximum credible allele frequency ($p_{\\max}$) based on disease prevalence, penetrance, and genetic heterogeneity, providing a powerful quantitative filter for your candidate variants.", "problem": "A clinical genetics team is evaluating a single-nucleotide variant observed in the Genome Aggregation Database (gnomAD). The disease of interest is autosomal dominant, with population prevalence $P = 1 \\times 10^{-4}$, and the variant has incomplete penetrance in heterozygotes, with penetrance $f = 0.8$. The disease is genetically heterogeneous across multiple genes; the gene harboring this variant is estimated to account for a fraction $g = 0.2$ of all cases. Within that gene, no single pathogenic variant is expected to account for more than a fraction $a = 0.05$ of cases in that gene. Assume Hardy-Weinberg equilibrium and that the allele frequency $p$ is sufficiently small that the homozygote frequency is negligible compared to the heterozygote frequency.\n\nThe ancestry-specific allele frequencies from gnomAD are:\n- African/African American: $3.3 \\times 10^{-6}$\n- Latino/Admixed American: $2.8 \\times 10^{-6}$\n- Non-Finnish European: $1.1 \\times 10^{-6}$\n- East Asian: $8.2 \\times 10^{-7}$\n- South Asian: $9.5 \\times 10^{-7}$\n\nThe overall gnomAD allele frequency is $1.9 \\times 10^{-6}$, but for clinical filtering you must consider the highest ancestry-specific frequency rather than the overall frequency.\n\nStarting from fundamental definitions, use Hardy-Weinberg genotype frequencies and penetrance to derive an inequality ensuring that the expected prevalence contributed by one variant does not exceed its maximal allowed share of disease prevalence given $g$ and $a$. From this inequality, obtain the maximum credible allele frequency threshold $p_{\\max}$ for a single autosomal dominant variant under these assumptions.\n\nThen, compute the ratio $R$ of the largest ancestry-specific observed allele frequency to $p_{\\max}$. Round your final numeric answer for $R$ to four significant figures. Express your final answer as a pure number with no units.", "solution": "The foundational starting point is the Hardy-Weinberg equilibrium for a bi-allelic locus with allele frequency $p$ for the variant and $q = 1 - p$ for the reference allele. The genotype frequencies are $p^{2}$ (homozygous variant), $2pq$ (heterozygous), and $q^{2}$ (homozygous reference). For a rare variant, $p \\ll 1$, so $q \\approx 1$ and $2pq \\approx 2p$, while $p^{2}$ is negligible compared to $2p$.\n\nFor an autosomal dominant disorder with penetrance $f$ in heterozygotes (and with homozygotes exceedingly rare when $p$ is small), the expected proportion of the population affected due to this single variant is\n$$\n\\text{variant-contributed prevalence} \\approx f \\left(2p(1-p) + p^{2}\\right).\n$$\nFor small $p$, $2p(1-p) + p^{2} = 2p - p^{2} \\approx 2p$, so\n$$\n\\text{variant-contributed prevalence} \\approx 2 f p.\n$$\n\nThe total disease prevalence is $P$. Genetic heterogeneity implies that the gene containing this variant accounts for a fraction $g$ of cases. Within that gene, the maximum allelic contribution $a$ indicates that no single variant accounts for more than an $a$ fraction of cases attributable to the gene. Therefore, the maximal allowed prevalence attributable to any one variant in this gene is\n$$\n\\text{allowed variant prevalence} = a \\cdot g \\cdot P.\n$$\n\nTo ensure that the variant is not too common to be a plausible cause of a dominant disease under these assumptions, we require\n$$\nf \\left(2p(1-p) + p^{2}\\right) \\leq a g P.\n$$\nUsing the small-$p$ approximation, this simplifies to\n$$\n2 f p \\leq a g P.\n$$\nSolving for $p$ yields the maximum credible allele frequency threshold:\n$$\np_{\\max} = \\frac{a g P}{2 f}.\n$$\n\nInsert the given values $a = 0.05$, $g = 0.2$, $P = 1 \\times 10^{-4}$, and $f = 0.8$:\n$$\na g P = 0.05 \\times 0.2 \\times 1 \\times 10^{-4} = 1 \\times 10^{-6},\n$$\nand\n$$\n2 f = 1.6.\n$$\nTherefore,\n$$\np_{\\max} = \\frac{1 \\times 10^{-6}}{1.6} = 6.25 \\times 10^{-7}.\n$$\n\nWe must compare ancestry-specific observed allele frequencies to $p_{\\max}$ using the highest ancestry-specific frequency. From the provided values, the largest ancestry-specific allele frequency is African/African American at $3.3 \\times 10^{-6}$. Define the ratio\n$$\nR = \\frac{\\max\\{\\text{ancestry-specific AF}\\}}{p_{\\max}} = \\frac{3.3 \\times 10^{-6}}{6.25 \\times 10^{-7}}.\n$$\nCompute $R$:\n$$\nR = \\frac{3.3}{0.625} = 5.28.\n$$\n\nRound $R$ to four significant figures:\n$$\nR \\approx 5.280.\n$$\n\nNote on approximation validity: at $p_{\\max} \\approx 6.25 \\times 10^{-7}$, the squared term $p^{2} \\approx 3.90625 \\times 10^{-13}$ is negligible relative to $2p \\approx 1.25 \\times 10^{-6}$, justifying the use of the small-$p$ approximation.", "answer": "$$\\boxed{5.280}$$", "id": "4340090"}, {"introduction": "After confirming a variant is sufficiently rare, the next step is to scrutinize its technical quality for signs of sequencing artifacts. Strand bias, where a variant is disproportionately supported by reads from only one DNA strand, is a classic red flag. This practice [@problem_id:4340072] delves into the statistical engine behind the Fisher Strand ($FS$) score, requiring you to compute a $p$-value from first principles using Fisher’s exact test to quantify the evidence for strand bias.", "problem": "A single nucleotide variant call is made at a locus using short-read sequencing, and strand-specific counts are observed for the reference and alternate alleles. To assess strand bias, the Fisher Strand (FS) annotation is defined as the Phred-scaled probability derived from Fisher’s exact test of independence between allele and strand in a $2 \\times 2$ contingency table with fixed margins. Starting from the definition of Fisher’s exact test under the null hypothesis of independence (with conditioned margins and the associated hypergeometric sampling framework), derive the exact two-sided $p$-value for the following table of observed counts:\n- Reference allele forward reads: $12$\n- Reference allele reverse reads: $8$\n- Alternate allele forward reads: $2$\n- Alternate allele reverse reads: $6$\nThen, apply the standard Phred scaling transformation used in sequencing quality scoring to obtain the Fisher Strand ($FS$) value from the derived $p$-value. Report the final $FS$ rounded to four significant figures. No units are required.", "solution": "The problem requires the calculation of the Fisher Strand ($FS$) score for a given set of allele counts from a sequencing experiment. This involves performing Fisher's exact test on a $2 \\times 2$ contingency table to obtain a two-sided $p$-value, followed by a Phred-scaling transformation.\n\nFirst, we formalize the provided data into a $2 \\times 2$ contingency table. The table represents the counts of reference (Ref) and alternate (Alt) alleles on the forward (Fwd) and reverse (Rev) strands. Let the cell counts be denoted by $a, b, c, d$:\n- $a$: Reference allele, forward reads = $12$\n- $b$: Alternate allele, forward reads = $2$\n- $c$: Reference allele, reverse reads = $8$\n- $d$: Alternate allele, reverse reads = $6$\n\nThe contingency table is:\n$$\n\\begin{array}{c|cc|c}\n  \\text{Reference}  \\text{Alternate}  \\text{Total} \\\\\n\\hline\n\\text{Forward Strand}  a=12  b=2  R_1 = 14 \\\\\n\\text{Reverse Strand}  c=8  d=6  R_2 = 14 \\\\\n\\hline\n\\text{Total}  C_1=20  C_2=8  N=28\n\\end{array}\n$$\nThe row totals are $R_1 = a+b = 12+2=14$ and $R_2 = c+d = 8+6=14$. The column totals are $C_1 = a+c = 12+8=20$ and $C_2 = b+d = 2+6=8$. The grand total is $N=a+b+c+d=28$.\n\nFisher's exact test evaluates the null hypothesis of independence between the row variable (strand) and the column variable (allele type). Under this hypothesis, given the fixed marginal totals ($R_1, R_2, C_1, C_2$), the probability of observing a specific table configuration is given by the hypergeometric probability mass function. If we consider one cell count, say $b$, as the random variable, the probability of observing a table with $b=k$ is:\n$$ P(b=k) = \\frac{\\binom{C_2}{k} \\binom{N-C_2}{R_1-k}}{\\binom{N}{R_1}} $$\nHere, $R_1=14$, $C_2=8$, and $N=28$. The possible values for $k$ are constrained by the margins: $k$ must satisfy $k \\ge 0$, $k \\le C_2=8$, $k \\le R_1=14$, and $R_1-k \\le N-C_2=20$ (which implies $k \\ge 14-20=-6$). Thus, $k$ can range from $\\max(0, -6)=0$ to $\\min(8, 14)=8$.\n\nWe must calculate the probability for each possible table, where $k$ ranges from $0$ to $8$:\nThe constant denominator is $\\binom{N}{R_1} = \\binom{28}{14} = \\frac{28!}{14!14!} = 40,116,600$.\nThe probability for a table with $k$ alternate alleles on the forward strand is $P(k) = \\frac{\\binom{8}{k} \\binom{20}{14-k}}{40,116,600}$. Let $Num(k) = \\binom{8}{k} \\binom{20}{14-k}$ be the numerator.\n\nThe numerators for each possible value of $k$ are:\n- $k=0: Num(0) = \\binom{8}{0} \\binom{20}{14} = 1 \\times 38,760 = 38,760$\n- $k=1: Num(1) = \\binom{8}{1} \\binom{20}{13} = 8 \\times 77,520 = 620,160$\n- $k=2: Num(2) = \\binom{8}{2} \\binom{20}{12} = 28 \\times 125,970 = 3,527,160$\n- $k=3: Num(3) = \\binom{8}{3} \\binom{20}{11} = 56 \\times 167,960 = 9,405,760$\n- $k=4: Num(4) = \\binom{8}{4} \\binom{20}{10} = 70 \\times 184,756 = 12,932,920$\n- $k=5: Num(5) = \\binom{8}{5} \\binom{20}{9} = 56 \\times 167,960 = 9,405,760$\n- $k=6: Num(6) = \\binom{8}{6} \\binom{20}{8} = 28 \\times 125,970 = 3,527,160$\n- $k=7: Num(7) = \\binom{8}{7} \\binom{20}{7} = 8 \\times 77,520 = 620,160$\n- $k=8: Num(8) = \\binom{8}{8} \\binom{20}{6} = 1 \\times 38,760 = 38,760$\n\nThe observed table corresponds to $k=2$, with a numerator of $Num(2)=3,527,160$. The two-sided $p$-value is the sum of probabilities of all tables that are as extreme or more extreme than the observed table. \"More extreme\" is defined as having a probability equal to or less than the probability of the observed table. This means we sum the probabilities for all values of $k$ such that $P(k) \\le P(2)$, which is equivalent to $Num(k) \\le Num(2)$.\n\nBy comparing the numerators, we identify the values of $k$ that satisfy this condition:\n- $Num(0) = 38,760 \\le 3,527,160$\n- $Num(1) = 620,160 \\le 3,527,160$\n- $Num(2) = 3,527,160 \\le 3,527,160$\n- $Num(3) = 9,405,760  3,527,160$\n- $Num(4) = 12,932,920  3,527,160$\n- $Num(5) = 9,405,760  3,527,160$\n- $Num(6) = 3,527,160 \\le 3,527,160$\n- $Num(7) = 620,160 \\le 3,527,160$\n- $Num(8) = 38,760 \\le 3,527,160$\nThe set of $k$ values for the p-value calculation is $\\{0, 1, 2, 6, 7, 8\\}$.\n\nThe two-sided $p$-value is the sum of these probabilities:\n$$ p\\text{-value} = \\sum_{k \\in \\{0, 1, 2, 6, 7, 8\\}} P(k) = \\frac{\\sum_{k \\in \\{0, 1, 2, 6, 7, 8\\}} Num(k)}{\\binom{28}{14}} $$\nThe sum of the numerators is:\n$$ \\sum Num(k) = 38,760 + 620,160 + 3,527,160 + 3,527,160 + 620,160 + 38,760 = 8,372,160 $$\nThe $p$-value is therefore:\n$$ p\\text{-value} = \\frac{8,372,160}{40,116,600} $$\nThis fraction simplifies to $\\frac{24}{115}$. Numerically, this is approximately $0.20869565...$.\n\nThe Fisher Strand ($FS$) score is the Phred-scaled $p$-value, defined by the transformation $Q = -10 \\log_{10}(P)$.\n$$ FS = -10 \\log_{10}(p\\text{-value}) = -10 \\log_{10}\\left(\\frac{24}{115}\\right) $$\nCalculating the value:\n$$ FS = -10 \\log_{10}(0.20869565...) \\approx -10 \\times (-0.680487...) \\approx 6.80487... $$\nThe problem requires the final answer to be rounded to four significant figures.\nThe first four significant figures of $6.80487...$ are $6$, $8$, $0$, and $4$. The fifth significant figure is $8$, which is $\\ge 5$, so we round up the fourth significant figure.\n$$ FS \\approx 6.805 $$", "answer": "$$\\boxed{6.805}$$", "id": "4340072"}, {"introduction": "Ultimately, making a confident call requires synthesizing multiple lines of evidence rather than relying on a single metric. A formal and powerful way to do this is through a Bayesian framework, which allows you to update your prior belief about a variant in light of new data. In this exercise [@problem_id:4340151], you will apply Bayes’ theorem to integrate a prior probability with observed quality scores ($QD$ and $FS$) to compute the posterior probability that a variant is a true positive, transforming qualitative assessments into a quantitative measure of confidence.", "problem": "A clinical laboratory is assessing whether to report a single nucleotide variant in a clinically actionable gene, observed in a tumor sample. The laboratory performs quality control using two orthogonal metrics: Quality by Depth ($QD$) and Fisher Strand bias ($FS$). Quality by Depth ($QD$) is the variant quality score normalized by read depth, and Fisher Strand bias ($FS$) is the Phred-scaled Fisher's exact test statistic for strand bias. Based on prior gene-level evidence and case phenotype, the laboratory assigns a prior probability $P(T)$ that the call is a true positive (a real biological variant) of $P(T) = 0.40$. The prior probability that the call is an artifact is therefore $P(A) = 1 - P(T)$.\n\nFrom calibration against Genome in a Bottle (GIAB) truth sets and orthogonal validation, the laboratory has estimated the following conditional distributions for these metrics:\n\n- For true positives, $QD$ is modeled as a Gaussian (normal) distribution with mean $\\mu_{QD,T} = 18$ and standard deviation $\\sigma_{QD,T} = 3$, and $FS$ is modeled as a log-normal distribution with $\\ln(FS)$ having mean $\\mu_{\\ln FS,T} = 2.5$ and standard deviation $\\sigma_{\\ln FS,T} = 0.6$.\n\n- For artifacts, $QD$ is modeled as a Gaussian distribution with mean $\\mu_{QD,A} = 10$ and standard deviation $\\sigma_{QD,A} = 2$, and $FS$ is modeled as a log-normal distribution with $\\ln(FS)$ having mean $\\mu_{\\ln FS,A} = 3.5$ and standard deviation $\\sigma_{\\ln FS,A} = 0.7$.\n\nAssume that, conditional on truth status (true positive versus artifact), the metrics $QD$ and $FS$ are independent. The observed metrics for this variant are $QD = 12$ and $FS = 35$.\n\nUsing Bayes’ theorem and the stated models, compute the adjusted posterior probability $P(T \\mid QD = 12, FS = 35)$ that the call is a true positive. The laboratory’s reporting policy is to report the variant if and only if the posterior probability is at least $0.95$. Provide the posterior probability as a decimal fraction. Round your answer to four significant figures. No units are required.", "solution": "The problem requires the computation of the posterior probability that a genomic variant call is a true positive, given measurements from two quality control metrics, $QD$ and $FS$. This is a classic application of Bayes' theorem.\n\nLet $T$ be the event that the variant call is a true positive, and $A$ be the event that it is an artifact. Let $D$ represent the observed data, which consists of the measured values $QD_{obs} = 12$ and $FS_{obs} = 35$. We are asked to compute the posterior probability $P(T \\mid D) = P(T \\mid QD=12, FS=35)$.\n\nAccording to Bayes' theorem, the posterior probability is given by:\n$$ P(T \\mid D) = \\frac{P(D \\mid T) P(T)}{P(D)} $$\n\nThe denominator, $P(D)$, is the marginal probability of the evidence, which can be expressed using the law of total probability:\n$$ P(D) = P(D \\mid T) P(T) + P(D \\mid A) P(A) $$\nThus, the full formula for the posterior probability is:\n$$ P(T \\mid D) = \\frac{P(D \\mid T) P(T)}{P(D \\mid T) P(T) + P(D \\mid A) P(A)} $$\n\nThe problem provides the prior probabilities:\n- Prior probability of a true positive: $P(T) = 0.40$\n- Prior probability of an artifact: $P(A) = 1 - P(T) = 1 - 0.40 = 0.60$\n\nThe terms $P(D \\mid T)$ and $P(D \\mid A)$ are the likelihoods of observing the data given that the variant is a true positive or an artifact, respectively. Since $QD$ and $FS$ are continuous variables, we use their probability density functions (PDFs), which we will denote by $f(\\cdot)$.\n\nThe problem states that, conditional on the truth status, $QD$ and $FS$ are independent. Therefore, the joint likelihood is the product of the individual likelihoods:\n$$ P(D \\mid C) = f(QD=12, FS=35 \\mid C) = f_{QD}(12 \\mid C) \\cdot f_{FS}(35 \\mid C) $$\nwhere $C$ can be either $T$ or $A$.\n\nWe now calculate the four required density values.\n\n**1. Likelihood components for a True Positive (T):**\n- **Metric $QD$:** The distribution is Gaussian, $QD \\mid T \\sim \\mathcal{N}(\\mu_{QD,T} = 18, \\sigma_{QD,T}^2 = 3^2)$. The PDF is $f(q) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(q-\\mu)^2}{2\\sigma^2}\\right)$. At $q=12$:\n$$ f_{QD}(12 \\mid T) = \\frac{1}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{(12-18)^2}{2 \\cdot 3^2}\\right) = \\frac{1}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{36}{18}\\right) = \\frac{1}{3\\sqrt{2\\pi}} \\exp(-2) $$\n- **Metric $FS$:** The distribution is Log-normal, meaning $\\ln(FS) \\mid T \\sim \\mathcal{N}(\\mu_{\\ln FS,T} = 2.5, \\sigma_{\\ln FS,T}^2 = 0.6^2)$. The PDF is $f(f) = \\frac{1}{f\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(f)-\\mu)^2}{2\\sigma^2}\\right)$. At $f=35$:\n$$ f_{FS}(35 \\mid T) = \\frac{1}{35 \\cdot 0.6 \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(35)-2.5)^2}{2 \\cdot 0.6^2}\\right) = \\frac{1}{21\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(35)-2.5)^2}{0.72}\\right) $$\nThe total likelihood for a true positive is $L_T = P(D \\mid T) = f_{QD}(12 \\mid T) \\cdot f_{FS}(35 \\mid T)$.\n$$ L_T = \\left(\\frac{1}{3\\sqrt{2\\pi}} \\exp(-2)\\right) \\left(\\frac{1}{21\\sqrt{2\\pi}}\\right) \\exp\\left(-\\frac{(\\ln(35)-2.5)^2}{0.72}\\right) = \\frac{1}{63 \\cdot 2\\pi} \\exp\\left(-2 - \\frac{(\\ln(35)-2.5)^2}{0.72}\\right) $$\n\n**2. Likelihood components for an Artifact (A):**\n- **Metric $QD$:** The distribution is Gaussian, $QD \\mid A \\sim \\mathcal{N}(\\mu_{QD,A} = 10, \\sigma_{QD,A}^2 = 2^2)$. At $q=12$:\n$$ f_{QD}(12 \\mid A) = \\frac{1}{2\\sqrt{2\\pi}} \\exp\\left(-\\frac{(12-10)^2}{2 \\cdot 2^2}\\right) = \\frac{1}{2\\sqrt{2\\pi}} \\exp\\left(-\\frac{4}{8}\\right) = \\frac{1}{2\\sqrt{2\\pi}} \\exp(-0.5) $$\n- **Metric $FS$:** The distribution is Log-normal, meaning $\\ln(FS) \\mid A \\sim \\mathcal{N}(\\mu_{\\ln FS,A} = 3.5, \\sigma_{\\ln FS,A}^2 = 0.7^2)$. At $f=35$:\n$$ f_{FS}(35 \\mid A) = \\frac{1}{35 \\cdot 0.7 \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(35)-3.5)^2}{2 \\cdot 0.7^2}\\right) = \\frac{1}{24.5\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(35)-3.5)^2}{0.98}\\right) $$\nThe total likelihood for an artifact is $L_A = P(D \\mid A) = f_{QD}(12 \\mid A) \\cdot f_{FS}(35 \\mid A)$.\n$$ L_A = \\left(\\frac{1}{2\\sqrt{2\\pi}} \\exp(-0.5)\\right) \\left(\\frac{1}{24.5\\sqrt{2\\pi}}\\right) \\exp\\left(-\\frac{(\\ln(35)-3.5)^2}{0.98}\\right) = \\frac{1}{49 \\cdot 2\\pi} \\exp\\left(-0.5 - \\frac{(\\ln(35)-3.5)^2}{0.98}\\right) $$\n\n**3. Numerical evaluation and calculation of the posterior probability:**\nWe have the priors $P(T)=0.4$ and $P(A)=0.6$. Now we substitute numerical values. We use $\\ln(35) \\approx 3.555348$.\n- Numerator term: $P(D \\mid T) P(T) = L_T \\cdot P(T)$\nExponent for $L_T$: $-2 - \\frac{(3.555348 - 2.5)^2}{0.72} \\approx -2 - 1.546889 = -3.546889$.\n$L_T = \\frac{1}{126\\pi} \\exp(-3.546889) \\approx \\frac{1}{395.84} \\cdot 0.028816 \\approx 7.2796 \\times 10^{-5}$.\n$P(D \\mid T) P(T) \\approx (7.2796 \\times 10^{-5}) \\cdot 0.4 = 2.9118 \\times 10^{-5}$.\n\n- Denominator term for A: $P(D \\mid A) P(A) = L_A \\cdot P(A)$\nExponent for $L_A$: $-0.5 - \\frac{(3.555348 - 3.5)^2}{0.98} \\approx -0.5 - 0.003126 = -0.503126$.\n$L_A = \\frac{1}{98\\pi} \\exp(-0.503126) \\approx \\frac{1}{307.88} \\cdot 0.60464 \\approx 1.9642 \\times 10^{-3}$.\n$P(D \\mid A) P(A) \\approx (1.9642 \\times 10^{-3}) \\cdot 0.6 = 1.1785 \\times 10^{-3}$.\n\nNow, we compute the posterior probability:\n$$ P(T \\mid D) = \\frac{P(D \\mid T) P(T)}{P(D \\mid T) P(T) + P(D \\mid A) P(A)} \\approx \\frac{2.9118 \\times 10^{-5}}{2.9118 \\times 10^{-5} + 1.1785 \\times 10^{-3}} $$\n$$ P(T \\mid D) \\approx \\frac{2.9118 \\times 10^{-5}}{1.2076 \\times 10^{-3}} \\approx 0.02411685 $$\n\nRounding the result to four significant figures gives $0.02412$. This very low probability indicates that the variant is overwhelmingly likely to be an artifact, based on the provided data and models.", "answer": "$$\\boxed{0.02412}$$", "id": "4340151"}]}