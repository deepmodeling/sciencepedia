{"hands_on_practices": [{"introduction": "This first practice establishes the quantitative foundation for understanding how genetic variation impacts drug disposition. You will derive and apply the fundamental pharmacokinetic equations that link drug clearance ($CL$) and volume of distribution ($V$) to total drug exposure (Area Under the Curve, $AUC$) and elimination half-life ($t_{1/2}$). By calculating the specific changes that result from a genetically-driven reduction in clearance, you will solidify your understanding of the direct consequences of a common pharmacogenomic scenario. [@problem_id:4314309]", "problem": "A single oral dose is administered of a small-molecule drug used in a pharmacogenomics (PGx) context of precision medicine. Assume linear, one-compartment pharmacokinetics with first-order elimination, and that the patient’s physiology satisfies the basic mass balance assumptions underlying Absorption, Distribution, Metabolism, and Excretion (ADME). The administered dose is $D=100$ mg, the apparent systemic clearance is $CL=10$ L/h, and the absolute bioavailability is $F=0.5$. The apparent volume of distribution is $V=40$ L. The patient is later found to carry a genotype associated with reduced hepatic enzyme activity that lowers metabolic capacity such that $CL$ is reduced multiplicatively by a factor of $0.5$ (i.e., a $50\\%$ reduction), while $V$ and $F$ remain unchanged.\n\nStarting from the definition of clearance as the proportionality constant linking elimination rate to concentration under first-order elimination, and using the one-compartment model and the mass balance for the amount of drug in the body, derive a general expression for the area under the plasma concentration–time curve (AUC) after a single dose as a function of $F$, $D$, and $CL$. Then, derive a general expression for the elimination half-life $t_{1/2}$ in terms of $CL$ and $V$.\n\nUsing these derived expressions:\n1. Compute the baseline AUC before the genotype is known.\n2. Compute the AUC after the genotype reduces $CL$ by a factor of $0.5$.\n3. Compute the baseline $t_{1/2}$ before the genotype is known.\n4. Compute the $t_{1/2}$ after the genotype reduces $CL$ by a factor of $0.5$.\n\nExpress AUC in mg·h/L and $t_{1/2}$ in hours. Round all numerical results to four significant figures. Provide your final result as a row vector containing, in order, the baseline AUC, post-genotype AUC, baseline $t_{1/2}$, and post-genotype $t_{1/2}$.", "solution": "The problem is valid as it is scientifically grounded in standard pharmacokinetic principles, self-contained, and well-posed. All necessary data and definitions for a unique solution are provided. We begin by deriving the general expressions as requested.\n\nFirst, we derive the expression for the area under the plasma concentration–time curve ($AUC$). The fundamental principle of mass balance dictates that the total amount of drug eliminated from the body must equal the total amount of drug that reaches the systemic circulation. The amount of drug reaching the systemic circulation is the product of the administered dose, $D$, and the absolute bioavailability, $F$.\n$$\n\\text{Amount absorbed} = F \\cdot D\n$$\nThe rate of elimination of the drug from the body is defined as the product of the systemic clearance, $CL$, and the plasma drug concentration, $C(t)$.\n$$\n\\text{Rate of elimination} = CL \\cdot C(t)\n$$\nThe total amount of drug eliminated over all time is the integral of the elimination rate from time $t=0$ to $t=\\infty$.\n$$\n\\text{Total amount eliminated} = \\int_{0}^{\\infty} CL \\cdot C(t) \\, dt\n$$\nAssuming that clearance $CL$ is constant over the measurement period, it can be factored out of the integral.\n$$\n\\text{Total amount eliminated} = CL \\int_{0}^{\\infty} C(t) \\, dt\n$$\nThe term $\\int_{0}^{\\infty} C(t) \\, dt$ is the definition of the area under the plasma concentration–time curve from time zero to infinity, denoted as $AUC$.\n$$\n\\text{Total amount eliminated} = CL \\cdot AUC\n$$\nEquating the amount absorbed with the amount eliminated gives:\n$$\nF \\cdot D = CL \\cdot AUC\n$$\nSolving for $AUC$, we obtain the general expression:\n$$\nAUC = \\frac{F \\cdot D}{CL}\n$$\nNext, we derive the general expression for the elimination half-life, $t_{1/2}$. For a one-compartment model with first-order elimination, the decline in the amount of drug in the body, $A(t)$, after the absorption phase is complete is described by the differential equation:\n$$\n\\frac{dA(t)}{dt} = -k_e A(t)\n$$\nwhere $k_e$ is the first-order elimination rate constant. The solution to this equation is an exponential decay function:\n$$\nA(t) = A_0 \\exp(-k_e t)\n$$\nwhere $A_0$ is the amount of drug at the beginning of the elimination phase. The half-life, $t_{1/2}$, is defined as the time required for the amount of drug to decrease to one-half of its initial value, i.e., $A(t_{1/2}) = A_0 / 2$.\n$$\n\\frac{A_0}{2} = A_0 \\exp(-k_e t_{1/2})\n$$\n$$\n\\frac{1}{2} = \\exp(-k_e t_{1/2})\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k_e t_{1/2} \\implies -\\ln(2) = -k_e t_{1/2}\n$$\nThis gives the relationship between $t_{1/2}$ and $k_e$:\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_e}\n$$\nTo relate $t_{1/2}$ to $CL$ and the apparent volume of distribution, $V$, we use the two definitions for the rate of elimination:\nRate of elimination $= k_e A(t)$ and Rate of elimination $= CL \\cdot C(t)$.\nWe also use the definition of the apparent volume of distribution: $A(t) = V \\cdot C(t)$.\nEquating the two expressions for the elimination rate:\n$$\nk_e A(t) = CL \\cdot C(t)\n$$\nSubstituting $A(t) = V \\cdot C(t)$:\n$$\nk_e V C(t) = CL \\cdot C(t)\n$$\nAssuming $C(t) \\neq 0$, we can divide by $C(t)$ to find the relationship between $k_e$, $V$, and $CL$:\n$$\nk_e = \\frac{CL}{V}\n$$\nSubstituting this expression for $k_e$ into the equation for $t_{1/2}$:\n$$\nt_{1/2} = \\frac{\\ln(2)}{CL/V} = \\frac{V \\ln(2)}{CL}\n$$\nNow, we use these derived expressions to compute the required values.\n\nThe given baseline parameters are:\nDose, $D = 100$ mg\nBioavailability, $F = 0.5$\nBaseline clearance, $CL_{base} = 10$ L/h\nVolume of distribution, $V = 40$ L\n\n1. Compute the baseline AUC ($AUC_{base}$).\nUsing the derived formula for $AUC$:\n$$\nAUC_{base} = \\frac{F \\cdot D}{CL_{base}} = \\frac{0.5 \\cdot 100 \\text{ mg}}{10 \\text{ L/h}} = \\frac{50}{10} \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}} = 5 \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}}\n$$\nRounding to four significant figures, this is $5.000$ mg·h/L.\n\n2. Compute the post-genotype AUC ($AUC_{pgx}$).\nThe genotype reduces $CL$ multiplicatively by a factor of $0.5$. The new clearance, $CL_{pgx}$, is:\n$$\nCL_{pgx} = CL_{base} \\times 0.5 = 10 \\text{ L/h} \\times 0.5 = 5 \\text{ L/h}\n$$\nThe parameters $F$ and $D$ are unchanged.\n$$\nAUC_{pgx} = \\frac{F \\cdot D}{CL_{pgx}} = \\frac{0.5 \\cdot 100 \\text{ mg}}{5 \\text{ L/h}} = \\frac{50}{5} \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}} = 10 \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}}\n$$\nRounding to four significant figures, this is $10.00$ mg·h/L.\n\n3. Compute the baseline $t_{1/2}$ ($t_{1/2, base}$).\nUsing the derived formula for $t_{1/2}$:\n$$\nt_{1/2, base} = \\frac{V \\ln(2)}{CL_{base}} = \\frac{40 \\text{ L} \\cdot \\ln(2)}{10 \\text{ L/h}} = 4 \\ln(2) \\text{ h}\n$$\nUsing the value $\\ln(2) \\approx 0.693147$, we get:\n$$\nt_{1/2, base} \\approx 4 \\times 0.693147 \\text{ h} \\approx 2.772588 \\text{ h}\n$$\nRounding to four significant figures, this is $2.773$ h.\n\n4. Compute the post-genotype $t_{1/2}$ ($t_{1/2, pgx}$).\nThe volume of distribution, $V$, is unchanged. The clearance is $CL_{pgx} = 5$ L/h.\n$$\nt_{1/2, pgx} = \\frac{V \\ln(2)}{CL_{pgx}} = \\frac{40 \\text{ L} \\cdot \\ln(2)}{5 \\text{ L/h}} = 8 \\ln(2) \\text{ h}\n$$\nUsing the value $\\ln(2) \\approx 0.693147$, we get:\n$$\nt_{1/2, pgx} \\approx 8 \\times 0.693147 \\text{ h} \\approx 5.545176 \\text{ h}\n$$\nRounding to four significant figures, this is $5.545$ h.\n\nThe final results are:\nBaseline AUC: $5.000$ mg·h/L\nPost-genotype AUC: $10.00$ mg·h/L\nBaseline $t_{1/2}$: $2.773$ h\nPost-genotype $t_{1/2}$: $5.545$ h\n\nThese are presented in a row vector as required.", "answer": "$$\n\\boxed{\\begin{pmatrix} 5.000 & 10.00 & 2.773 & 5.545 \\end{pmatrix}}\n$$", "id": "4314309"}, {"introduction": "Building on foundational principles, this exercise moves from theory to direct clinical application in precision medicine. You will analyze a classic pharmacogenomics case involving thiopurine drugs, where variants in the TPMT and NUDT15 genes dramatically alter drug metabolism. Your task is to calculate a precise dose adjustment factor for a patient with reduced enzyme activity, with the goal of matching the systemic exposure ($AUC$) of a normal metabolizer to mitigate toxicity risks. This practice directly illustrates how quantitative reasoning is used to create genotype-guided dosing recommendations. [@problem_id:4314292]", "problem": "A thiopurine is eliminated under linear pharmacokinetics by intracellular detoxification steps controlled by Thiopurine S-methyltransferase (TPMT) and Nudix Hydrolase 15 (NUDT15). You may assume that the net intrinsic clearance is limited by nonredundant steps in series such that the overall clearance is proportional to a combined enzymatic activity index equal to the product of the normalized enzyme activities. Let the activities of both enzymes in a reference normal metabolizer be normalized to $1$. A patient is a pharmacogenomics (PGx) carrier with TPMT heterozygous deficiency, having $50\\%$ activity, and is a NUDT15 poor metabolizer, having $10\\%$ activity. Assume bioavailability and distribution properties are unchanged by genotype.\n\nUse the following foundational facts:\n- For linear pharmacokinetics, the area under the concentration–time curve (AUC) satisfies $ \\mathrm{AUC} = \\dfrac{D}{CL} $, where $D$ is dose and $CL$ is clearance.\n- If $CL$ is proportional to a combined enzymatic activity index $I$, then $CL = k\\,I$ for some genotype-independent proportionality constant $k$.\n- The combined activity index $I$ for this drug is the product of the normalized TPMT and NUDT15 activities.\n\nLet $D_{\\mathrm{std}}$ be the standard dose for a normal metabolizer, and let $r \\in [0,1]$ be the initial dosing factor such that the genotype-guided initial dose is $D_{\\mathrm{geno}} = r\\,D_{\\mathrm{std}}$. Determine the value of $r$ required to target an identical $\\mathrm{AUC}$ as in a normal metabolizer.\n\nExpress the final answer as a single decimal number with no units. No rounding is required; report the exact value.", "solution": "The problem statement is deemed valid as it is scientifically grounded in the principles of pharmacokinetics and pharmacogenomics, well-posed with sufficient information to derive a unique solution, and objective in its formulation.\n\nThe objective is to determine the dosing factor $r$ for a patient with specific genetic variants so that their systemic drug exposure, measured by the area under the concentration–time curve ($\\mathrm{AUC}$), is identical to that of a normal metabolizer receiving a standard dose $D_{\\mathrm{std}}$. The core relationship is $\\mathrm{AUC}_{\\mathrm{geno}} = \\mathrm{AUC}_{\\mathrm{std}}$.\n\nFirst, we define the parameters for a normal metabolizer, denoted by the subscript 'std'.\nThe normalized activities for the enzymes are given as $1$.\nTPMT activity: $I_{\\mathrm{TPMT, std}} = 1$.\nNUDT15 activity: $I_{\\mathrm{NUDT15, std}} = 1$.\n\nThe combined enzymatic activity index $I$ is the product of the individual normalized activities:\n$$I_{\\mathrm{std}} = I_{\\mathrm{TPMT, std}} \\times I_{\\mathrm{NUDT15, std}} = 1 \\times 1 = 1$$\nThe clearance $CL$ is proportional to this index, with a proportionality constant $k$:\n$$CL_{\\mathrm{std}} = k \\, I_{\\mathrm{std}} = k \\times 1 = k$$\nThe standard dose is $D_{\\mathrm{std}}$. The resulting AUC for a normal metabolizer is:\n$$\\mathrm{AUC}_{\\mathrm{std}} = \\frac{D_{\\mathrm{std}}}{CL_{\\mathrm{std}}} = \\frac{D_{\\mathrm{std}}}{k}$$\n\nNext, we define the parameters for the patient with the specified genotype, denoted by the subscript 'geno'.\nThe patient has TPMT heterozygous deficiency, corresponding to $50\\%$ of normal activity.\nThe normalized TPMT activity is $I_{\\mathrm{TPMT, geno}} = 0.50$.\nThe patient is a NUDT15 poor metabolizer, corresponding to $10\\%$ of normal activity.\nThe normalized NUDT15 activity is $I_{\\mathrm{NUDT15, geno}} = 0.10$.\n\nThe combined enzymatic activity index for this patient is:\n$$I_{\\mathrm{geno}} = I_{\\mathrm{TPMT, geno}} \\times I_{\\mathrm{NUDT15, geno}} = 0.50 \\times 0.10 = 0.05$$\nThe patient's clearance is calculated using the same proportionality constant $k$, as it is genotype-independent:\n$$CL_{\\mathrm{geno}} = k \\, I_{\\mathrm{geno}} = k \\times 0.05 = 0.05k$$\nThe genotype-guided dose for the patient is $D_{\\mathrm{geno}} = r \\, D_{\\mathrm{std}}$, where $r$ is the dose adjustment factor we need to find.\nThe resulting AUC for the patient is:\n$$\\mathrm{AUC}_{\\mathrm{geno}} = \\frac{D_{\\mathrm{geno}}}{CL_{\\mathrm{geno}}} = \\frac{r \\, D_{\\mathrm{std}}}{0.05k}$$\n\nTo achieve the therapeutic goal, the AUCs must be equivalent:\n$$\\mathrm{AUC}_{\\mathrm{geno}} = \\mathrm{AUC}_{\\mathrm{std}}$$\nSubstituting the expressions for each AUC:\n$$\\frac{r \\, D_{\\mathrm{std}}}{0.05k} = \\frac{D_{\\mathrm{std}}}{k}$$\nThe terms $D_{\\mathrm{std}}$ and $k$ are positive constants and can be cancelled from both sides of the equation:\n$$\\frac{r}{0.05} = 1$$\nSolving for $r$:\n$$r = 0.05$$\nThis means the patient should receive a dose that is $5\\%$ of the standard dose to achieve the same systemic exposure as a normal metabolizer. The value $r = 0.05$ lies within the specified range $[0, 1]$.", "answer": "$$\\boxed{0.05}$$", "id": "4314292"}, {"introduction": "The previous exercises assumed that key pharmacokinetic parameters were already known. This advanced computational practice challenges you to work as a pharmacometrician and estimate these parameters from raw experimental data. You will implement a one-compartment pharmacokinetic model, fit it to concentration-time data from two different genotype groups, and use the Akaike Information Criterion (AIC) to select the most appropriate statistical error model. This hands-on modeling exercise demystifies how parameters like clearance ($CL$) and volume of distribution ($V$) are determined in research, providing insight into the methods that generate the evidence for pharmacogenomic guidelines. [@problem_id:4314265]", "problem": "You must implement a program that, for two genotype groups with single-dose oral concentration–time observations, fits a one-compartment oral absorption pharmacokinetic model under multiple plausible error structures, selects the most appropriate error model using Akaike Information Criterion, and reports the group-specific parameter estimates and their differences. The context is pharmacogenomics, where genetic variation affects parameters of absorption, distribution, metabolism, and excretion (ADME), particularly clearance, within precision medicine and genomic diagnostics. The program must be fully self-contained and deterministic, using only the data provided herein and standard numerical optimization.\n\nUse the following scientifically standard mass balance description for a one-compartment model with first-order absorption:\n- Let the amount in the gastrointestinal tract be $A_g(t)$ and the amount in the central compartment be $A_c(t)$.\n- The absorption rate constant is $k_a$ in $\\mathrm{h}^{-1}$, the clearance is $CL$ in $\\mathrm{L}\\,\\mathrm{h}^{-1}$, and the volume of distribution is $V$ in $\\mathrm{L}$.\n- The elimination rate constant is $k_e = CL/V$ in $\\mathrm{h}^{-1}$.\n- The administered oral dose is $D$ in $\\mathrm{mg}$ with bioavailability $F$ (unitless).\n- The initial conditions are $A_g(0) = F\\,D$ and $A_c(0) = 0$.\n- The ordinary differential equations are\n$$\\frac{dA_g(t)}{dt} = -k_a\\,A_g(t),$$\n$$\\frac{dA_c(t)}{dt} = k_a\\,A_g(t) - k_e\\,A_c(t),$$\nand the plasma concentration is $C(t) = \\frac{A_c(t)}{V}$ in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$.\n\nModel fitting must proceed by maximizing the Gaussian likelihood of the observed concentrations, equivalently minimizing the negative log-likelihood. Let the observed concentration at sampling time $t_i$ be $y_i$ and the corresponding model prediction be $\\hat{y}_i$. For each observation, define an observation-specific standard deviation $\\sigma_i$ according to an error model. The negative log-likelihood (up to an additive constant) is\n$$\n\\mathrm{NLL}(k_a,CL,V) = \\frac{1}{2}\\sum_{i=1}^{n}\\left[\\ln\\left(2\\pi\\,\\sigma_i^2\\right) + \\frac{\\left(y_i - \\hat{y}_i\\right)^2}{\\sigma_i^2}\\right].\n$$\nYou must consider three candidate error models:\n1. Additive error: $\\sigma_i = \\sigma_a$.\n2. Proportional error: $\\sigma_i = \\sigma_p\\,\\hat{y}_i$.\n3. Combined additive and proportional error: $\\sigma_i = \\sqrt{\\sigma_a^2 + \\left(\\sigma_p\\,\\hat{y}_i\\right)^2}$.\n\nUse the following fixed error magnitudes expressed in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$ for $\\sigma_a$ and unitless for $\\sigma_p$:\n- $\\sigma_a = 0.05$,\n- $\\sigma_p = 0.10$.\n\nModel selection must use the Akaike Information Criterion for the fitted parameters:\n$$\n\\mathrm{AIC} = 2k + 2\\,\\mathrm{NLL}\n$$\nwhere $k$ is the number of free parameters estimated, here $k=3$ (namely $k_a$, $CL$, $V$). For each genotype group, fit all three error models, compute their Akaike Information Criterion, and select the model with the smallest Akaike Information Criterion as the most appropriate. Report the parameter estimates under the selected model for each group.\n\nUse the following dosing and sampling specifications:\n- Dose $D = 100\\,\\mathrm{mg}$.\n- Bioavailability $F = 1$.\n- Sampling times in hours: $[0.25, 0.5, 1, 2, 4, 6, 8, 12, 24]$.\n\nThe observed concentrations in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$ are:\n- Genotype group $G_1$: $[0.36, 0.62, 0.92, 1.08, 0.90, 0.69, 0.52, 0.29, 0.05]$.\n- Genotype group $G_2$: $[0.31, 0.55, 0.86, 1.13, 1.12, 1.01, 0.88, 0.67, 0.29]$.\n\nPhysiologically and numerically plausible constraints must be enforced on parameters:\n- $k_a > 0$,\n- $CL > 0$,\n- $V > 0$.\nYou must ensure numerical stability for cases where $k_a$ is close to $k_e$ by using the appropriate limiting behavior to avoid division by zero.\n\nYour program must:\n- Implement the above model and fitting procedure for each genotype group independently.\n- For each genotype group, evaluate all three error models, select the one with the smallest Akaike Information Criterion, and return the corresponding parameter estimates.\n- Compute and report the differences between genotype groups as $(\\Delta k_a, \\Delta CL, \\Delta V) = (k_{a,G_2} - k_{a,G_1}, CL_{G_2} - CL_{G_1}, V_{G_2} - V_{G_1})$.\n\nUnits specification for final answers:\n- Report $k_a$ in $\\mathrm{h}^{-1}$, $CL$ in $\\mathrm{L}\\,\\mathrm{h}^{-1}$, and $V$ in $\\mathrm{L}$.\n- Express all outputs as floating-point numbers rounded to three decimal places. Do not print units; they are implied by position.\n\nTest suite and coverage:\n- Test case $T_1$: Additive error model with $\\sigma_a = 0.05$ and $\\sigma_p = 0$ on both groups.\n- Test case $T_2$: Proportional error model with $\\sigma_a = 0$ and $\\sigma_p = 0.10$ on both groups.\n- Test case $T_3$: Combined error model with $\\sigma_a = 0.05$ and $\\sigma_p = 0.10$ on both groups.\nFor each group, select the best-performing test case by Akaike Information Criterion and use its estimates. This set probes homoscedastic and heteroscedastic assumptions and provides coverage across typical pharmacokinetic error structures.\n\nFinal output format:\nYour program should produce a single line of output containing the nine results as a comma-separated list enclosed in square brackets:\n$[k_{a,G_1},CL_{G_1},V_{G_1},k_{a,G_2},CL_{G_2},V_{G_2},\\Delta k_a,\\Delta CL,\\Delta V]$,\nrounded to three decimal places, in the units specified above, with no extra characters or lines.", "solution": "The problem requires fitting a one-compartment oral absorption pharmacokinetic model to concentration-time data from two distinct genotype groups, $G_1$ and $G_2$. The goal is to estimate the key pharmacokinetic parameters for each group, select the most appropriate error model for each using the Akaike Information Criterion (AIC), and report the parameter estimates and their differences. This approach is standard in pharmacogenomic studies to quantify the impact of genetic variants on drug disposition.\n\nThe process is executed in several steps: defining the concentration model, establishing the statistical framework for parameter estimation, performing numerical optimization, and applying a model selection criterion.\n\nThe one-compartment model with first-order absorption is described by a system of linear ordinary differential equations for the amount of drug in the gut, $A_g(t)$, and the central compartment, $A_c(t)$:\n$$\n\\frac{dA_g(t)}{dt} = -k_a\\,A_g(t)\n$$\n$$\n\\frac{dA_c(t)}{dt} = k_a\\,A_g(t) - k_e\\,A_c(t)\n$$\nwith initial conditions $A_g(0) = F\\,D$ and $A_c(0) = 0$. The parameters are the absorption rate constant $k_a$, the elimination rate constant $k_e$, the dose $D$, and the bioavailability $F$. The plasma concentration is given by $C(t) = A_c(t)/V$, where $V$ is the volume of distribution. The elimination rate constant $k_e$ is defined as the ratio of clearance $CL$ to the volume of distribution, $k_e = CL/V$.\n\nThe analytical solution to this system, which provides the model-predicted concentration $\\hat{y}(t) = C(t)$, is given by the Bateman function. For the case where $k_a \\neq k_e$:\n$$\nC(t) = \\frac{F D k_a}{V(k_a - k_e)} \\left( e^{-k_e t} - e^{-k_a t} \\right)\n$$\nThis equation is numerically unstable when $k_a$ is close to $k_e$. In the specific case where $k_a = k_e$, the solution becomes:\n$$\nC(t) = \\frac{F D k_a}{V} t\\,e^{-k_a t}\n$$\nTo ensure numerical stability, the implementation switches to this limiting form when $|k_a - k_e|$ is smaller than a defined tolerance. The parameters to be estimated for each genotype group are $\\theta = (k_a, CL, V)$.\n\nParameter estimation is performed by maximizing the Gaussian likelihood of the observed data, which is equivalent to minimizing the negative log-likelihood (NLL). The NLL is given by:\n$$\n\\mathrm{NLL}(\\theta) = \\frac{1}{2}\\sum_{i=1}^{n}\\left[\\ln\\left(2\\pi\\,\\sigma_i^2\\right) + \\frac{\\left(y_i - \\hat{y}_i\\right)^2}{\\sigma_i^2}\\right]\n$$\nwhere $y_i$ are the observed concentrations, $\\hat{y}_i$ are the model-predicted concentrations, and $\\sigma_i$ is the standard deviation of the $i$-th measurement, defined by an error model. Three candidate error models are evaluated, using the fixed, provided constants $\\sigma_a = 0.05$ and $\\sigma_p = 0.10$:\n1.  **Additive Error:** $\\sigma_i = \\sigma_a$. This model assumes a constant error variance across all concentration levels.\n2.  **Proportional Error:** $\\sigma_i = \\sigma_p\\,\\hat{y}_i$. This model assumes the error variance increases in proportion to the concentration.\n3.  **Combined Error:** $\\sigma_i = \\sqrt{\\sigma_a^2 + (\\sigma_p\\,\\hat{y}_i)^2}$. This model combines both additive and proportional components, accommodating constant error at low concentrations and proportional error at high concentrations.\n\nNumerical optimization is used to find the parameter set $\\theta$ that minimizes the NLL for a given dataset and error model. The `scipy.optimize.minimize` function with the `Nelder-Mead` algorithm is employed for this task. To enforce the physiological constraints that all parameters must be positive (i.e., $k_a > 0, CL > 0, V > 0$), optimization is performed on the natural logarithm of the parameters: $(\\ln(k_a), \\ln(CL), \\ln(V))$. This transformation maps the constrained positive domain to the unconstrained real domain, improving the stability and efficiency of the optimization.\n\nAfter fitting all three error models for a given genotype group, the Akaike Information Criterion (AIC) is used for model selection. The AIC provides a principled trade-off between model goodness-of-fit (represented by the NLL) and model complexity (represented by the number of estimated parameters). The formula is:\n$$\n\\mathrm{AIC} = 2k + 2\\,\\mathrm{NLL}\n$$\nAs specified, the number of estimated pharmacokinetic parameters is $k=3$ ($k_a, CL, V$) for all models, since the error parameters $\\sigma_a$ and $\\sigma_p$ are fixed constants rather than estimated variables. For each genotype group, the model with the minimum AIC value is chosen as the most plausible description of the data.\n\nThe overall workflow is as follows:\n1.  For each genotype group ($G_1$ and $G_2$), the three error models are fitted to its respective concentration-time data by minimizing the corresponding NLL function.\n2.  The AIC is calculated for each of the three fits.\n3.  The model yielding the lowest AIC is selected as the best-fit model for that group, and its estimated parameters ($k_a, CL, V$) are retained.\n4.  Finally, the differences between the parameters of the two groups are calculated: $(\\Delta k_a, \\Delta CL, \\Delta V) = (k_{a,G_2} - k_{a,G_1}, CL_{G_2} - CL_{G_1}, V_{G_2} - V_{G_1})$.\n5.  The nine resulting values are formatted and reported as a single comma-separated list.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Fits a one-compartment oral absorption PK model to data from two genotype groups,\n    selects the best error model via AIC for each, and reports the final parameter estimates\n    and their differences.\n    \"\"\"\n    # --- Givens from the problem statement ---\n    D = 100.0  # Dose in mg\n    F = 1.0    # Bioavailability (unitless)\n    SIGMA_A = 0.05  # Additive error component in mg/L\n    SIGMA_P = 0.10  # Proportional error component (unitless)\n    K_PARAMS = 3  # Number of estimated parameters (ka, CL, V)\n\n    # Observation data\n    T_OBS = np.array([0.25, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 12.0, 24.0])\n    Y_OBS_G1 = np.array([0.36, 0.62, 0.92, 1.08, 0.90, 0.69, 0.52, 0.29, 0.05])\n    Y_OBS_G2 = np.array([0.31, 0.55, 0.86, 1.13, 1.12, 1.01, 0.88, 0.67, 0.29])\n\n    def concentration_model(t, params):\n        \"\"\"\n        Calculates plasma concentration C(t) for a one-compartment oral model.\n        params: a tuple or list [ka, CL, V].\n        \"\"\"\n        ka, cl, v = params\n        \n        # This function should only be called with positive parameters from the optimizer\n        ke = cl / v\n        \n        # Use limiting form for numerical stability when ka is close to ke\n        if np.isclose(ka, ke, rtol=1e-5, atol=1e-8):\n            conc = (F * D / v) * ka * t * np.exp(-ka * t)\n        else:\n            # Standard Bateman function for one-compartment oral absorption\n            conc = (F * D * ka) / (v * (ka - ke)) * (np.exp(-ke * t) - np.exp(-ka * t))\n        \n        return conc\n\n    def nll_objective(log_params, t_obs, y_obs, error_model):\n        \"\"\"\n        Negative log-likelihood function to be minimized by the optimizer.\n        Uses log-transformed parameters to ensure positivity.\n        \"\"\"\n        params = np.exp(log_params)\n        \n        y_hat = concentration_model(t_obs, params)\n        \n        # Calculate squared standard deviation (variance) based on the error model\n        if error_model == 'additive':\n            sigma_sq = SIGMA_A**2\n        elif error_model == 'proportional':\n            # Clamp to a small positive value to avoid log(0) or division by zero\n            sigma_sq = np.maximum((SIGMA_P * y_hat)**2, 1e-12)\n        elif error_model == 'combined':\n            sigma_sq = SIGMA_A**2 + (SIGMA_P * y_hat)**2\n        else:\n            # This case should not be reached with the current implementation\n            raise ValueError(\"Invalid error model specified.\")\n\n        # Calculate negative log-likelihood\n        # NLL = 0.5 * sum(log(2*pi*sigma^2) + (y_obs - y_hat)^2 / sigma^2)\n        nll_val = 0.5 * np.sum(np.log(2 * np.pi * sigma_sq) + ((y_obs - y_hat)**2 / sigma_sq))\n        \n        # Return a large number if NLL is not finite, guiding the optimizer\n        if not np.isfinite(nll_val):\n            return np.inf\n\n        return nll_val\n\n    def fit_group_data(y_obs, t_obs):\n        \"\"\"\n        Fits the PK model to a single group's data across all three error models,\n        selects the best model using AIC, and returns the corresponding parameters.\n        \"\"\"\n        # Initial guess for log-transformed parameters: [log(ka), log(CL), log(V)]\n        initial_guess_log = np.log([1.0, 10.0, 65.0])\n        error_models = ['additive', 'proportional', 'combined']\n        \n        best_aic = np.inf\n        best_params = None\n        \n        for model in error_models:\n            res = minimize(\n                nll_objective,\n                initial_guess_log,\n                args=(t_obs, y_obs, model),\n                method='Nelder-Mead',\n                options={'xatol': 1e-8, 'disp': False}\n            )\n            \n            if res.success:\n                min_nll = res.fun\n                aic = 2 * K_PARAMS + 2 * min_nll\n                \n                if aic  best_aic:\n                    best_aic = aic\n                    best_params = np.exp(res.x) # Convert optimal log-params back to linear space\n    \n        return best_params\n\n    # --- Main Execution Logic ---\n    \n    # Fit data for Genotype Group 1\n    params_g1 = fit_group_data(Y_OBS_G1, T_OBS)\n    \n    # Fit data for Genotype Group 2\n    params_g2 = fit_group_data(Y_OBS_G2, T_OBS)\n    \n    # Calculate differences between group parameters\n    diffs = params_g2 - params_g1\n    \n    # Combine all results into a single array for printing\n    all_results = np.concatenate((params_g1, params_g2, diffs))\n\n    # Format results to three decimal places as specified\n    formatted_results = [f\"{x:.3f}\" for x in all_results]\n    \n    # Print the final output in the required single-line format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4314265"}]}