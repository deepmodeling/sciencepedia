{"hands_on_practices": [{"introduction": "Understanding the clinical impact of pharmacogenomics begins with quantifying how genetic variations alter drug exposure. This first practice exercise asks you to derive, from first principles, the change in a drug's Area Under the Curve ($AUC$) when a primary metabolic pathway, like CYP2D6, is genetically nonfunctional. By working through this problem [@problem_id:4329846], you will solidify your understanding of the direct relationship between metabolic clearance ($CL$) and systemic drug exposure, a cornerstone of pharmacogenomic-guided dosing.", "problem": "A clinician is optimizing therapy for a patient in a precision medicine context based on pharmacogenomic results. The patient’s genotype indicates nonfunctional cytochrome P450 (CYP) 2D6 alleles consistent with a cytochrome P450 2D6 poor metabolizer (PM) phenotype. Consider a drug administered as a single intravenous bolus dose to avoid confounding by absorption, where elimination is exclusively through metabolic clearance pathways. Under baseline conditions in an extensive metabolizer (EM), the total clearance is the sum of pathway-specific clearances. The fraction metabolized by cytochrome P450 2D6 is defined as $f_m^{\\mathrm{CYP2D6}} = \\frac{CL_{\\mathrm{CYP2D6}}}{CL_{\\mathrm{total}}}$ and is measured to be $f_m^{\\mathrm{CYP2D6}} = 0.9$ for this drug.\n\nAssume the following fundamental base under linear pharmacokinetics:\n- The Area Under the Curve (AUC) from time zero to infinity following an intravenous bolus dose $D$ is $ \\mathrm{AUC} = \\frac{D}{CL_{\\mathrm{total}}}$.\n- In the cytochrome P450 2D6 poor metabolizer phenotype, $CL_{\\mathrm{CYP2D6}} \\approx 0$.\n- There is no compensatory change in non-cytochrome P450 2D6 pathways, and the volume of distribution remains unchanged.\n\nUsing these assumptions and definitions, derive from first principles the expected fold increase in $ \\mathrm{AUC}$ in the cytochrome P450 2D6 poor metabolizer relative to the extensive metabolizer. Provide your final answer as a pure number with no units. Do not round; report the exact value.", "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n**Step 1: Extract Givens**\n- Patient phenotype: Cytochrome P450 2D6 poor metabolizer (PM).\n- Baseline (control) phenotype: Extensive metabolizer (EM).\n- Drug administration: Single intravenous (IV) bolus dose, $D$.\n- Elimination: Exclusively via metabolic clearance.\n- Total clearance ($CL_{\\mathrm{total}}$): Sum of pathway-specific clearances.\n- Fraction metabolized by cytochrome P450 2D6 in an EM: $f_m^{\\mathrm{CYP2D6}} = \\frac{CL_{\\mathrm{CYP2D6}}}{CL_{\\mathrm{total}}} = 0.9$.\n- Area Under the Curve (AUC) from time zero to infinity: $\\mathrm{AUC} = \\frac{D}{CL_{\\mathrm{total}}}$.\n- Clearance via CYP2D6 in a PM: $CL_{\\mathrm{CYP2D6}} \\approx 0$.\n- Ancillary assumptions: No compensatory change in non-cytochrome P450 2D6 pathways; volume of distribution remains unchanged.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically and mathematically sound.\n- **Scientifically Grounded:** The problem is based on core, established principles of pharmacokinetics and pharmacogenomics. The role of Cytochrome P450 enzymes, particularly CYP2D6, in drug metabolism and the impact of genetic polymorphisms (e.g., PM phenotype) on drug exposure (measured by AUC) are fundamental concepts in precision medicine.\n- **Well-Posed:** The problem is clearly defined, with all necessary parameters and relationships provided to derive a unique, meaningful solution. The question asks for a specific, calculable quantity (fold increase in AUC).\n- **Objective:** The language is formal, precise, and objective, using standard scientific terminology.\n- **Complete and Consistent:** The assumptions provided (linear pharmacokinetics, no change in other pathways) are explicit and create a self-contained, solvable system without contradictions. The assumption that $CL_{\\mathrm{CYP2D6}} \\approx 0$ for a PM with nonfunctional alleles is a standard and valid approximation in this context.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived from first principles as requested.\n\n**Derivation**\nThe objective is to determine the fold increase in the Area Under the Curve ($\\mathrm{AUC}$) in a poor metabolizer (PM) relative to an extensive metabolizer (EM). This quantity is the ratio $\\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}}$.\n\nThe relationship between dose ($D$), total clearance ($CL_{\\mathrm{total}}$), and $\\mathrm{AUC}$ is given as:\n$$ \\mathrm{AUC} = \\frac{D}{CL_{\\mathrm{total}}} $$\n\nSince the dose $D$ is administered as a single IV bolus and is assumed to be the same for both phenotype scenarios, the ratio of AUCs can be expressed as:\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{\\left(\\frac{D}{CL_{\\mathrm{total, PM}}}\\right)}{\\left(\\frac{D}{CL_{\\mathrm{total, EM}}}\\right)} = \\frac{CL_{\\mathrm{total, EM}}}{CL_{\\mathrm{total, PM}}} $$\nHere, $CL_{\\mathrm{total, EM}}$ is the total clearance in an extensive metabolizer, and $CL_{\\mathrm{total, PM}}$ is the total clearance in a poor metabolizer.\n\nThe total drug clearance is the sum of the clearances through all metabolic pathways. We can partition the total clearance in the EM into the component mediated by CYP2D6 ($CL_{\\mathrm{CYP2D6, EM}}$) and the component mediated by all other pathways ($CL_{\\mathrm{other}}$):\n$$ CL_{\\mathrm{total, EM}} = CL_{\\mathrm{CYP2D6, EM}} + CL_{\\mathrm{other}} $$\n\nThe fraction of drug metabolized by CYP2D6 in the EM is given as $f_m^{\\mathrm{CYP2D6}} = 0.9$. By definition:\n$$ f_m^{\\mathrm{CYP2D6}} = \\frac{CL_{\\mathrm{CYP2D6, EM}}}{CL_{\\mathrm{total, EM}}} $$\nFrom this, we can express the CYP2D6-mediated clearance in the EM as:\n$$ CL_{\\mathrm{CYP2D6, EM}} = f_m^{\\mathrm{CYP2D6}} \\cdot CL_{\\mathrm{total, EM}} $$\n\nThe clearance via other pathways, $CL_{\\mathrm{other}}$, can then be expressed in terms of the total clearance and $f_m^{\\mathrm{CYP2D6}}$:\n$$ CL_{\\mathrm{other}} = CL_{\\mathrm{total, EM}} - CL_{\\mathrm{CYP2D6, EM}} = CL_{\\mathrm{total, EM}} - (f_m^{\\mathrm{CYP2D6}} \\cdot CL_{\\mathrm{total, EM}}) $$\n$$ CL_{\\mathrm{other}} = (1 - f_m^{\\mathrm{CYP2D6}}) \\cdot CL_{\\mathrm{total, EM}} $$\n\nNow, we must define the total clearance in the PM patient. The problem states that for a PM, the CYP2D6 pathway is nonfunctional, so $CL_{\\mathrm{CYP2D6, PM}} \\approx 0$. It is also assumed that there are no compensatory changes in other elimination pathways. Therefore, the clearance via other pathways is the same in the PM as in the EM. The total clearance in the PM is:\n$$ CL_{\\mathrm{total, PM}} = CL_{\\mathrm{CYP2D6, PM}} + CL_{\\mathrm{other}} \\approx 0 + CL_{\\mathrm{other}} = CL_{\\mathrm{other}} $$\nSubstituting the expression for $CL_{\\mathrm{other}}$ from the EM case:\n$$ CL_{\\mathrm{total, PM}} = (1 - f_m^{\\mathrm{CYP2D6}}) \\cdot CL_{\\mathrm{total, EM}} $$\n\nFinally, we can calculate the fold increase in AUC by substituting this expression for $CL_{\\mathrm{total, PM}}$ into our ratio:\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{CL_{\\mathrm{total, EM}}}{CL_{\\mathrm{total, PM}}} = \\frac{CL_{\\mathrm{total, EM}}}{(1 - f_m^{\\mathrm{CYP2D6}}) \\cdot CL_{\\mathrm{total, EM}}} $$\nThe term $CL_{\\mathrm{total, EM}}$ cancels from the numerator and denominator, yielding the general relationship:\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{1}{1 - f_m^{\\mathrm{CYP2D6}}} $$\n\nPlugging in the given value $f_m^{\\mathrm{CYP2D6}} = 0.9$:\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{1}{1 - 0.9} = \\frac{1}{0.1} = 10 $$\n\nThus, the expected fold increase in AUC in the cytochrome P450 2D6 poor metabolizer relative to the extensive metabolizer is $10$.", "answer": "$$\\boxed{10}$$", "id": "4329846"}, {"introduction": "Real-world clinical scenarios rarely involve just one variable; they are a complex interplay of genetics, co-medications, and patient physiology. This exercise [@problem_id:4329774] models a common clinical challenge: predicting the effect of a CYP2D6 inhibitor in patients with different metabolic capacities (Poor, Extensive, and Ultra-rapid Metabolizers). You will apply the principles of competitive enzyme inhibition to see how a drug-drug interaction's impact is not uniform, but is instead powerfully modulated by the patient's underlying pharmacogenomic profile.", "problem": "A clinical pharmacology team is predicting drug–drug interaction risk for a victim antidepressant that is eliminated by two parallel pathways: Cytochrome P450 (CYP) 2D6–mediated hepatic metabolism and non–CYP routes (primarily renal excretion). Clinical genotyping assigns individuals to functional groups based on CYP2D6 diplotype: extensive metabolizer (EM), poor metabolizer (PM), and ultra-rapid metabolizer (UM). Assume the following is known from in vitro–in vivo extrapolation and clinical phenotyping:\n- In EMs, the baseline CYP2D6-mediated clearance is $14$ L/h and the baseline non–CYP clearance is $6$ L/h. The total baseline clearance in EMs is therefore the sum of these parallel pathways.\n- Genotype modifies only the CYP2D6-mediated component multiplicatively: PMs have a $0.1\\times$ activity scalar relative to EMs, and UMs have a $2.0\\times$ activity scalar relative to EMs. The non–CYP route is genotype-independent.\n- A strong, reversible competitive inhibitor of CYP2D6 is co-administered. Its unbound hepatic inlet concentration is $I_u = 1.0\\,\\mu\\mathrm{M}$ and its inhibition constant is $K_i = 0.20\\,\\mu\\mathrm{M}$. For reversible competitive inhibition under linear (first-order) pharmacokinetics at low substrate concentrations, the intrinsic clearance contributed by the inhibited enzyme scales by the factor $1/(1 + I_u/K_i)$, while other parallel pathways are unaffected.\n- For this drug and dose, oral bioavailability and dose are unchanged by the inhibitor, and protein binding is unchanged. Under linear pharmacokinetics, the Area Under the plasma concentration–time Curve (AUC) satisfies $AUC = F \\cdot \\mathrm{Dose} / CL$.\n\nUsing only the principles that (i) total clearance is the sum of parallel pathways, (ii) reversible competitive inhibition scales the inhibited pathway’s clearance by $1/(1 + I_u/K_i)$, and (iii) $AUC$ is inversely proportional to total clearance when $F$ and dose are constant, compute the AUC fold-change $AUC'/AUC$ (with inhibitor divided by without inhibitor) for each genotype group (EM, PM, UM). Choose the option that reports the correct ordered triple $\\left(\\text{EM}, \\text{PM}, \\text{UM}\\right)$, rounded to two decimal places.\n\nA. $\\left(2.40,\\;1.19,\\;3.19\\right)$\n\nB. $\\left(2.40,\\;1.33,\\;3.00\\right)$\n\nC. $\\left(6.00,\\;1.20,\\;6.00\\right)$\n\nD. $\\left(2.00,\\;1.20,\\;4.00\\right)$", "solution": "The problem statement is evaluated for validity.\n\n**Step 1: Extract Givens**\n- Drug elimination pathways: Cytochrome P450 (CYP) 2D6–mediated hepatic metabolism and non–CYP routes.\n- Genotype groups based on CYP2D6 diplotype: extensive metabolizer (EM), poor metabolizer (PM), and ultra-rapid metabolizer (UM).\n- For EMs, baseline CYP2D6-mediated clearance, $CL_{CYP,EM} = 14$ L/h.\n- For EMs, baseline non–CYP clearance, $CL_{non-CYP} = 6$ L/h.\n- Total baseline clearance is the sum of parallel pathways.\n- Genotype modification scalars relative to EMs for the CYP2D6 pathway: $S_{PM} = 0.1$ for PMs and $S_{UM} = 2.0$ for UMs. The scalar for EMs is implicitly $S_{EM} = 1.0$.\n- The non–CYP route is genotype-independent.\n- A reversible competitive inhibitor of CYP2D6 is co-administered.\n- Unbound hepatic inlet concentration of the inhibitor, $I_u = 1.0\\,\\mu\\mathrm{M}$.\n- Inhibition constant of the inhibitor, $K_i = 0.20\\,\\mu\\mathrm{M}$.\n- Scaling factor for the inhibited enzyme's intrinsic clearance: $1/(1 + I_u/K_i)$.\n- Parallel pathways (non-CYP) are unaffected by the inhibitor.\n- Oral bioavailability ($F$) and dose are constant.\n- Protein binding is unchanged.\n- Area Under the Curve (AUC) relationship: $AUC = F \\cdot \\mathrm{Dose} / CL$.\n- The question asks for the AUC fold-change, $AUC'/AUC$, for each genotype group (EM, PM, UM), presented as an ordered triple $(\\text{EM}, \\text{PM}, \\text{UM})$ rounded to two decimal places.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on established principles of pharmacokinetics and pharmacogenomics, including parallel clearance pathways, the impact of genetic polymorphisms on enzyme activity (CYP2D6 phenotypes), and the mechanism of competitive enzyme inhibition. The mathematical models provided are standard in the field.\n- **Well-Posed:** The problem provides all necessary data and defines all relationships required to calculate the requested AUC fold-changes. The objective is clear.\n- **Objective:** The language is technical and precise, free from subjective or ambiguous terms.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. It is a well-structured quantitative problem in clinical pharmacology.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation**\nThe analysis is based on three core principles outlined in the problem:\n1.  Total clearance ($CL_{tot}$) is the sum of parallel clearance pathways. For any genotype group $g$, the baseline total clearance is $CL_{tot,g} = CL_{CYP,g} + CL_{non-CYP}$.\n2.  The effect of a reversible competitive inhibitor on the CYP2D6 pathway is to scale its clearance by a factor of $1/(1 + I_u/K_i)$. The total clearance in the presence of the inhibitor is $CL'_{tot,g} = CL'_{CYP,g} + CL_{non-CYP}$, where $CL'_{CYP,g} = CL_{CYP,g} \\cdot \\frac{1}{1 + I_u/K_i}$.\n3.  The Area Under the Curve ($AUC$) is inversely proportional to total clearance ($CL_{tot}$) when bioavailability ($F$) and dose are constant. The AUC fold-change is given by the ratio $\\frac{AUC'}{AUC} = \\frac{F \\cdot \\mathrm{Dose} / CL'_{tot,g}}{F \\cdot \\mathrm{Dose} / CL_{tot,g}} = \\frac{CL_{tot,g}}{CL'_{tot,g}}$.\n\nFirst, we calculate the clearance values for each genotype group, both at baseline and in the presence of the inhibitor.\n\nThe non-CYP clearance is constant for all groups: $CL_{non-CYP} = 6$ L/h.\n\nThe inhibition scaling factor for the CYP2D6 pathway is:\n$$ \\text{Inhibition Factor} = \\frac{1}{1 + I_u/K_i} = \\frac{1}{1 + (1.0\\,\\mu\\mathrm{M}) / (0.20\\,\\mu\\mathrm{M})} = \\frac{1}{1 + 5} = \\frac{1}{6} $$\n\nNow, we compute the AUC fold-change for each genotype.\n\n**1. Extensive Metabolizer (EM)**\n- Baseline CYP2D6 clearance: $CL_{CYP,EM} = 14$ L/h.\n- Baseline total clearance: $CL_{tot,EM} = CL_{CYP,EM} + CL_{non-CYP} = 14\\,\\text{L/h} + 6\\,\\text{L/h} = 20$ L/h.\n- Inhibited CYP2D6 clearance: $CL'_{CYP,EM} = CL_{CYP,EM} \\times \\frac{1}{6} = 14 \\times \\frac{1}{6} = \\frac{14}{6} = \\frac{7}{3}$ L/h.\n- Total clearance with inhibitor: $CL'_{tot,EM} = CL'_{CYP,EM} + CL_{non-CYP} = \\frac{7}{3}\\,\\text{L/h} + 6\\,\\text{L/h} = \\frac{7}{3} + \\frac{18}{3} = \\frac{25}{3}$ L/h.\n- AUC fold-change:\n$$ \\frac{AUC'_{EM}}{AUC_{EM}} = \\frac{CL_{tot,EM}}{CL'_{tot,EM}} = \\frac{20}{25/3} = \\frac{20 \\times 3}{25} = \\frac{60}{25} = 2.4 $$\nRounded to two decimal places, the value is $2.40$.\n\n**2. Poor Metabolizer (PM)**\n- Baseline CYP2D6 clearance: $CL_{CYP,PM} = S_{PM} \\times CL_{CYP,EM} = 0.1 \\times 14\\,\\text{L/h} = 1.4$ L/h.\n- Baseline total clearance: $CL_{tot,PM} = CL_{CYP,PM} + CL_{non-CYP} = 1.4\\,\\text{L/h} + 6\\,\\text{L/h} = 7.4$ L/h.\n- Inhibited CYP2D6 clearance: $CL'_{CYP,PM} = CL_{CYP,PM} \\times \\frac{1}{6} = 1.4 \\times \\frac{1}{6} = \\frac{1.4}{6} = \\frac{7}{30}$ L/h.\n- Total clearance with inhibitor: $CL'_{tot,PM} = CL'_{CYP,PM} + CL_{non-CYP} = \\frac{7}{30}\\,\\text{L/h} + 6\\,\\text{L/h} = \\frac{7}{30} + \\frac{180}{30} = \\frac{187}{30}$ L/h.\n- AUC fold-change:\n$$ \\frac{AUC'_{PM}}{AUC_{PM}} = \\frac{CL_{tot,PM}}{CL'_{tot,PM}} = \\frac{7.4}{187/30} = \\frac{7.4 \\times 30}{187} = \\frac{222}{187} \\approx 1.187165... $$\nRounded to two decimal places, the value is $1.19$.\n\n**3. Ultra-rapid Metabolizer (UM)**\n- Baseline CYP2D6 clearance: $CL_{CYP,UM} = S_{UM} \\times CL_{CYP,EM} = 2.0 \\times 14\\,\\text{L/h} = 28$ L/h.\n- Baseline total clearance: $CL_{tot,UM} = CL_{CYP,UM} + CL_{non-CYP} = 28\\,\\text{L/h} + 6\\,\\text{L/h} = 34$ L/h.\n- Inhibited CYP2D6 clearance: $CL'_{CYP,UM} = CL_{CYP,UM} \\times \\frac{1}{6} = 28 \\times \\frac{1}{6} = \\frac{28}{6} = \\frac{14}{3}$ L/h.\n- Total clearance with inhibitor: $CL'_{tot,UM} = CL'_{CYP,UM} + CL_{non-CYP} = \\frac{14}{3}\\,\\text{L/h} + 6\\,\\text{L/h} = \\frac{14}{3} + \\frac{18}{3} = \\frac{32}{3}$ L/h.\n- AUC fold-change:\n$$ \\frac{AUC'_{UM}}{AUC_{UM}} = \\frac{CL_{tot,UM}}{CL'_{tot,UM}} = \\frac{34}{32/3} = \\frac{34 \\times 3}{32} = \\frac{102}{32} = \\frac{51}{16} = 3.1875 $$\nRounded to two decimal places, the value is $3.19$.\n\nThe calculated ordered triple of AUC fold-changes $(\\text{EM}, \\text{PM}, \\text{UM})$ is $(2.40, 1.19, 3.19)$.\n\n**Option-by-Option Analysis**\n\n- **A. $\\left(2.40,\\;1.19,\\;3.19\\right)$**: This option exactly matches the calculated values for EM, PM, and UM, respectively.\n  - EM: $2.40$ (Correct)\n  - PM: $1.19$ (Correct)\n  - UM: $3.19$ (Correct)\n  **Verdict: Correct**\n\n- **B. $\\left(2.40,\\;1.33,\\;3.00\\right)$**: The value for EM is correct, but the values for PM and UM are incorrect.\n  - PM: Calculated value is $1.19$, not $1.33$.\n  - UM: Calculated value is $3.19$, not $3.00$.\n  **Verdict: Incorrect**\n\n- **C. $\\left(6.00,\\;1.20,\\;6.00\\right)$**: All values are incorrect. The value $6.00$ represents the inverse of the inhibition factor ($1 / (1/6) = 6$), which would be the AUC fold-change only if the *entire* drug clearance were mediated by CYP2D6 and there were no parallel non-CYP pathway. The PM value is close but not accurate ($1.20$ vs $1.19$).\n  **Verdict: Incorrect**\n\n- **D. $\\left(2.00,\\;1.20,\\;4.00\\right)$**: All values are incorrect. These values do not appear to be derivable from any simple misinterpretation of the provided principles, except for the PM value being a slightly different rounding of the correct answer.\n  **Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "4329774"}, {"introduction": "The ultimate goal of precision medicine is to synthesize diverse patient data into a single, actionable recommendation, such as an optimized drug dose. This final practice challenges you to build a comprehensive dosing algorithm for the immunosuppressant tacrolimus from the ground up [@problem_id:4329867]. By integrating pharmacogenomic data (CYP3A5 status), patient-specific variables like body weight and hematocrit, and potential drug-drug interactions, you will construct a pharmacokinetic model that predicts the precise daily dose needed to achieve a target therapeutic concentration.", "problem": "Develop a self-contained program that computes the initial daily tacrolimus dose to achieve a specified whole-blood trough concentration target, grounded in first-principles pharmacokinetic reasoning and pharmacogenomic modifiers within precision medicine. Use a one-compartment, extravascular dosing model with first-order absorption and first-order elimination. The drug tacrolimus is primarily metabolized by Cytochrome P450 (CYP) isoforms, with Cytochrome P450 family 3 subfamily A member 5 (CYP3A5) genotype modifiers influencing hepatic clearance. The algorithm must incorporate body weight, hematocrit, and the presence of concomitant inhibitors or inducers of Cytochrome P450 (CYP) metabolism. Follow these core definitions and well-tested foundations without employing any shortcut formulas:\n- Mass balance for a one-compartment system with absorption and elimination.\n- First-order absorption characterized by absorption rate constant $k_a$.\n- First-order elimination characterized by elimination rate constant $k$, where $k = CL / V$.\n- Allometric scaling of clearance and volume relative to a reference body weight.\n- The relationship between dose, bioavailability, and systemic exposure at steady state.\n- The influence of hematocrit on whole-blood distribution volume.\n- Pharmacogenomic variation in CYP3A5 expression status.\n- Modulation of clearance by drug-drug interactions via inhibitors and inducers of CYP-mediated metabolism.\n\nYour program must implement the following scientifically realistic parameterization and assumptions, all in specified units:\n- Reference body weight $W_{ref} = 70$ kg.\n- Reference hematocrit $Hct_{ref} = 0.45$ (unitless fraction).\n- Reference whole-blood apparent clearance for a Cytochrome P450 family 3 subfamily A member 5 (CYP3A5) nonexpresser at $W_{ref}$: $CL_{ref} = 3.5$ L/h.\n- Reference whole-blood apparent volume of distribution at $W_{ref}$: $V_{ref} = 60$ L.\n- Oral bioavailability $F = 0.25$ (unitless).\n- Absorption rate constant $k_a = 2.0$ h$^{-1}$.\n- Clearance allometry: $CL = CL_{ref} \\cdot \\left(\\dfrac{W}{W_{ref}}\\right)^{0.75} \\cdot g \\cdot m$, where $W$ is body weight in kg, $g$ is the genotype factor, and $m$ is the concomitant interaction multiplier.\n- Volume allometry with hematocrit adjustment: $V = V_{ref} \\cdot \\left(\\dfrac{W}{W_{ref}}\\right)^{1.0} \\cdot \\left(1 + \\beta \\cdot (Hct - Hct_{ref})\\right)$, with $\\beta = 1.0$.\n- Genotype factor $g$: use $g = 1.0$ for CYP3A5 nonexpresser and $g = 1.6$ for CYP3A5 expresser.\n- Concomitant interaction multiplier $m$ categories: \"none\" $\\rightarrow m = 1.0$, \"moderate\\_inhibitor\" $\\rightarrow m = 0.7$, \"strong\\_inhibitor\" $\\rightarrow m = 0.5$, \"moderate\\_inducer\" $\\rightarrow m = 1.5$, \"strong\\_inducer\" $\\rightarrow m = 2.0$.\n- Dosing interval $\\tau$ in hours.\n- Target whole-blood trough concentration $C_{tr}$ specified in ng/mL. Convert ng/mL to mg/L via $1$ ng/mL $= 0.001$ mg/L for calculations.\n\nYour program must:\n- Derive from the above foundations an expression for the per-dose amount $D$ (in mg) that attains the specified $C_{tr}$ at steady state for dosing interval $\\tau$, and then compute the daily dose (mg/day) as $D \\cdot \\dfrac{24}{\\tau}$.\n- Accept no user input; hard-code the test suite below.\n- Produce the final daily dose in mg/day for each test case as a float rounded to three decimals.\n- Use the following test suite covering general, boundary, and edge scenarios:\n    1. CYP3A5 nonexpresser, $W = 70$ kg, $Hct = 0.45$, interaction \"none\", $C_{tr} = 6$ ng/mL, $\\tau = 12$ h.\n    2. CYP3A5 expresser, $W = 70$ kg, $Hct = 0.45$, interaction \"none\", $C_{tr} = 6$ ng/mL, $\\tau = 12$ h.\n    3. CYP3A5 expresser, $W = 70$ kg, $Hct = 0.45$, interaction \"strong\\_inhibitor\", $C_{tr} = 6$ ng/mL, $\\tau = 12$ h.\n    4. CYP3A5 nonexpresser, $W = 90$ kg, $Hct = 0.40$, interaction \"strong\\_inducer\", $C_{tr} = 8$ ng/mL, $\\tau = 12$ h.\n    5. CYP3A5 expresser, $W = 50$ kg, $Hct = 0.25$, interaction \"moderate\\_inhibitor\", $C_{tr} = 5$ ng/mL, $\\tau = 24$ h.\n    6. CYP3A5 nonexpresser, $W = 120$ kg, $Hct = 0.55$, interaction \"none\", $C_{tr} = 7$ ng/mL, $\\tau = 12$ h.\n\nRequired output format:\n- Your program should produce a single line of output containing the daily dose results for the six test cases as a comma-separated list enclosed in square brackets in mg/day, each rounded to three decimals (for example, $\"[2.835,5.701,2.115,13.149,4.849,4.608]\"$). Express all dose values in mg/day with three decimal places.", "solution": "The user-provided problem is assessed to be **valid**. It is scientifically grounded in established principles of pharmacokinetics and pharmacogenomics, is well-posed with a complete and consistent set of definitions and parameters, and is expressed in objective, formal language. The solution will proceed by deriving the necessary equations from first principles as stipulated.\n\nThe objective is to compute the initial daily dose of tacrolimus required to achieve a target steady-state trough concentration ($C_{tr}$). The calculation is based on a one-compartment pharmacokinetic (PK) model with first-order absorption and first-order elimination, incorporating patient-specific covariates.\n\nThe concentration of a drug in the body following a single oral dose ($D$) can be described by the Bateman function, which is the solution to the differential equations governing a one-compartment model with first-order absorption. The concentration $C(t)$ at time $t$ is given by:\n$$ C(t) = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( e^{-kt} - e^{-k_a t} \\right) $$\nwhere $F$ is the oral bioavailability, $D$ is the dose, $k_a$ is the first-order absorption rate constant, $V$ is the apparent volume of distribution, and $k$ is the first-order elimination rate constant. The problem requires a derivation from foundational principles, which are the mass balance equations for the absorption site and the central compartment. The above equation is the integrated form of these balances.\n\nFor a regimen of multiple doses administered at a constant interval $\\tau$, the drug accumulates in the body until it reaches a steady state. At steady state, the concentration profile over a dosing interval is the superposition of the concentration curves from an infinite series of prior doses. The concentration $C_{ss}(t)$ at time $t$ within a dosing interval ($0 \\le t \\le \\tau$) at steady state is:\n$$ C_{ss}(t) = \\sum_{n=0}^{\\infty} C_{single\\_dose}(t + n\\tau) = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( \\frac{e^{-kt}}{1 - e^{-k\\tau}} - \\frac{e^{-k_a t}}{1 - e^{-k_a \\tau}} \\right) $$\nThis expression is derived by applying the geometric series summation formula $\\sum_{n=0}^{\\infty} r^n = (1-r)^{-1}$ to the terms resulting from the superposition.\n\nThe trough concentration, $C_{tr}$ (or $C_{min,ss}$), is the minimum concentration at steady state, which occurs at the end of the dosing interval, just before the next dose is administered, i.e., at $t = \\tau$. Substituting $t = \\tau$ into the steady-state concentration equation yields:\n$$ C_{tr} = C_{ss}(\\tau) = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( \\frac{e^{-k\\tau}}{1 - e^{-k\\tau}} - \\frac{e^{-k_a \\tau}}{1 - e^{-k_a \\tau}} \\right) $$\nFor computational purposes, it is often more stable to express the fractions as $(e^{x}-1)^{-1}$. The equation for trough concentration becomes:\n$$ C_{tr} = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( \\frac{1}{e^{k\\tau}-1} - \\frac{1}{e^{k_a\\tau}-1} \\right) $$\n\nTo calculate the required dose $D$ to achieve a target $C_{tr}$, we rearrange the above equation to solve for $D$:\n$$ D = \\frac{C_{tr} \\cdot V \\cdot (k_a - k)}{F \\cdot k_a \\left( \\frac{1}{e^{k\\tau}-1} - \\frac{1}{e^{k_a\\tau}-1} \\right)} $$\nThis is the dose per administration interval $\\tau$.\n\nThe pharmacokinetic parameters $V$ and $k$ are patient-specific. The elimination rate constant $k$ is defined by the ratio of the apparent clearance ($CL$) to the apparent volume of distribution ($V$):\n$$ k = \\frac{CL}{V} $$\n$CL$ and $V$ are determined by allometric scaling from reference values, adjusted for genetic and other factors:\n1.  **Apparent Clearance ($CL$)**:\n    $$ CL = CL_{ref} \\cdot \\left(\\frac{W}{W_{ref}}\\right)^{0.75} \\cdot g \\cdot m $$\n    where $W$ is the patient's body weight, $W_{ref}$ is the reference weight ($70$ kg), $CL_{ref}$ is the reference clearance ($3.5$ L/h), $g$ is the pharmacogenomic factor for CYP3A5 expression, and $m$ is the multiplier for concomitant drug interactions.\n\n2.  **Apparent Volume of Distribution ($V$)**:\n    $$ V = V_{ref} \\cdot \\left(\\frac{W}{W_{ref}}\\right)^{1.0} \\cdot \\left(1 + \\beta \\cdot (Hct - Hct_{ref})\\right) $$\n    where $V_{ref}$ is the reference volume ($60$ L), $Hct$ is the patient's hematocrit, $Hct_{ref}$ is the reference hematocrit ($0.45$), and $\\beta$ is a scaling coefficient ($1.0$).\n\nThe final step is to calculate the total daily dose. Given the dose $D$ is administered every $\\tau$ hours, the number of doses per day is $24/\\tau$. The total daily dose is therefore:\n$$ D_{daily} = D \\cdot \\frac{24}{\\tau} $$\n\nThe overall algorithm is as follows for each test case:\n1.  Identify patient-specific inputs: body weight ($W$), hematocrit ($Hct$), CYP3A5 genotype, and concomitant medication status.\n2.  Determine the corresponding numerical factors $g$ and $m$.\n3.  Calculate patient-specific $CL$ and $V$ using the provided allometric equations.\n4.  Calculate the elimination rate constant $k = CL/V$.\n5.  Convert the target trough concentration $C_{tr}$ from ng/mL to mg/L using the given conversion factor ($1$ ng/mL $= 0.001$ mg/L).\n6.  Substitute all parameters ($C_{tr}$, $V$, $k$, $k_a$, $F$, $\\tau$) into the derived equation to calculate the single dose amount $D$.\n7.  Calculate the total daily dose $D_{daily}$.\n8.  Round the final result to three decimal places.\nThis procedure provides a complete, principled solution grounded in the problem's specifications.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the initial daily tacrolimus dose to achieve a specified\n    whole-blood trough concentration target based on a one-compartment\n    pharmacokinetic model with pharmacogenomic and patient-specific modifiers.\n    \"\"\"\n\n    # --- Fixed Model Parameters ---\n    W_ref = 70.0       # Reference body weight (kg)\n    Hct_ref = 0.45     # Reference hematocrit (unitless fraction)\n    CL_ref = 3.5       # Reference whole-blood clearance for CYP3A5 nonexpresser (L/h)\n    V_ref = 60.0       # Reference whole-blood volume of distribution (L)\n    F = 0.25           # Oral bioavailability (unitless)\n    k_a = 2.0          # Absorption rate constant (h^-1)\n    beta = 1.0         # Hematocrit scaling coefficient\n\n    # --- Factor Mappings ---\n    genotype_factors = {\n        'CYP3A5 nonexpresser': 1.0,\n        'CYP3A5 expresser': 1.6\n    }\n    interaction_multipliers = {\n        'none': 1.0,\n        'moderate_inhibitor': 0.7,\n        'strong_inhibitor': 0.5,\n        'moderate_inducer': 1.5,\n        'strong_inducer': 2.0\n    }\n\n    # --- Test Suite ---\n    test_cases = [\n        # (genotype, W, Hct, interaction, C_tr, tau)\n        ('CYP3A5 nonexpresser', 70.0, 0.45, 'none', 6.0, 12.0),\n        ('CYP3A5 expresser', 70.0, 0.45, 'none', 6.0, 12.0),\n        ('CYP3A5 expresser', 70.0, 0.45, 'strong_inhibitor', 6.0, 12.0),\n        ('CYP3A5 nonexpresser', 90.0, 0.40, 'strong_inducer', 8.0, 12.0),\n        ('CYP3A5 expresser', 50.0, 0.25, 'moderate_inhibitor', 5.0, 24.0),\n        ('CYP3A5 nonexpresser', 120.0, 0.55, 'none', 7.0, 12.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        genotype, W, Hct, interaction, C_tr_ng_mL, tau = case\n\n        # 1. Determine numerical factors g and m\n        g = genotype_factors[genotype]\n        m = interaction_multipliers[interaction]\n\n        # 2. Calculate patient-specific CL and V\n        # Allometric scaling for Clearance (CL)\n        CL = CL_ref * ((W / W_ref) ** 0.75) * g * m\n        # Allometric scaling for Volume of Distribution (V) with Hct adjustment\n        V = V_ref * ((W / W_ref) ** 1.0) * (1 + beta * (Hct - Hct_ref))\n\n        # 3. Calculate elimination rate constant k\n        # Ensure V is not zero to avoid division errors, though a valid V should be positive.\n        if V <= 0:\n            raise ValueError(\"Volume of distribution must be positive.\")\n        k = CL / V\n\n        # 4. Convert target concentration units\n        # 1 ng/mL = 0.001 mg/L\n        C_tr_mg_L = C_tr_ng_mL * 0.001\n\n        # 5. Calculate single dose D based on the derived formula\n        # D = (C_tr * V * (ka - k)) / (F * ka * ( (1/(e^(k*tau)-1)) - (1/(e^(ka*tau)-1)) ))\n        \n        # Check for k == k_a to avoid division by zero, although highly unlikely with given parameters.\n        if np.isclose(k, k_a):\n             # This case requires a different PK model solution, but it's not expected here.\n            raise ValueError(\"Elimination rate constant k cannot be equal to absorption rate constant k_a.\")\n\n        term1 = 1 / (np.exp(k * tau) - 1)\n        term2 = 1 / (np.exp(k_a * tau) - 1)\n        \n        denominator_bracket = term1 - term2\n        \n        # Ensure denominator is not zero\n        if np.isclose(denominator_bracket, 0):\n            # This would imply k is close to ka, already checked\n            raise ValueError(\"Denominator in dose calculation is zero.\")\n\n        numerator = C_tr_mg_L * V * (k_a - k)\n        denominator = F * k_a * denominator_bracket\n\n        Dose_per_interval = numerator / denominator\n\n        # 6. Calculate total daily dose\n        Daily_dose = Dose_per_interval * (24.0 / tau)\n\n        # 7. Append rounded result\n        results.append(round(Daily_dose, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```", "id": "4329867"}]}