{"hands_on_practices": [{"introduction": "Next-generation sequencing of a tumor biopsy provides a snapshot of its genomic landscape, but this snapshot is a composite image, mixing signals from both cancer and healthy cells. This exercise challenges you to deconstruct this mixed signal to reveal the underlying tumor biology, specifically focusing on the emergence of drug resistance. By applying first principles of allele counting, you will calculate the Cancer Cell Fraction (CCF) for a resistance mutation, a critical metric for distinguishing between a clonal event present in all tumor cells and a subclonal event that has arisen in a subset of cells during therapy. [@problem_id:4390906]", "problem": "A patient with metastatic non-small cell lung cancer is found pre-treatment to harbor a clonal epidermal growth factor receptor (EGFR) exon 19 deletion. After progression on therapy, a tumor re-biopsy is performed. Targeted next-generation sequencing reports an EGFR T790M variant allele fraction (VAF) of $0.2$, and independent pathology review establishes tumor purity $p=0.5$. Copy-number analysis at the EGFR locus shows total tumor copy number $C_{t}=2$ with no loss of heterozygosity. Assume the following: normal (non-cancer) cells are diploid with $2$ copies per locus; sequencing reads are an unbiased sample of alleles; the T790M substitution, when present in a cancer cell, is present on a single allele (multiplicity $m=1$); and the EGFR exon 19 deletion remains clonal, providing the background on which T790M emerges. Let the cancer cell fraction (CCF) $f$ denote the fraction of cancer cells carrying T790M. Using only first principles of tumor-normal admixture and allele counting, derive an expression for $f$ in terms of the observed VAF, $p$, $C_{t}$, and $m$, then compute $f$ for the given values. State whether the inferred $f$ is more consistent with clonal emergence ($f$ approximately $1$) or subclonal emergence ($f$ less than $1$), and justify your reasoning qualitatively. Report the numeric value of $f$ as a pure number between $0$ and $1$. No rounding instruction is required; report the exact value implied by the given numbers.", "solution": "The problem statement has been rigorously validated and is deemed valid. It is scientifically grounded, well-posed, and objective. It presents a standard, realistic problem in cancer genomics that can be solved using first principles. All necessary data and assumptions are provided, and there are no contradictions or ambiguities.\n\nThe problem requires the derivation of the cancer cell fraction ($f$) of a subclonal mutation from sequencing data. We are given the following parameters:\n- The observed variant allele fraction of the EGFR T790M mutation, $\\text{VAF} = 0.2$.\n- The tumor purity of the sample, $p = 0.5$. This is the fraction of cells in the sample that are cancer cells.\n- The total copy number of the EGFR locus in tumor cells, $C_{t} = 2$.\n- The multiplicity of the T790M mutation in a mutated cancer cell, $m = 1$. This means the mutation is heterozygous in the cells that carry it.\n\nWe are also given the following assumptions, which are standard in this type of analysis:\n- Normal, non-cancerous cells are diploid, meaning their copy number at the locus is $C_{n} = 2$.\n- Sequencing provides an unbiased sampling of all alleles present in the tissue sample.\n\nThe variant allele fraction (VAF) is defined as the ratio of the number of sequencing reads mapping to the variant allele to the total number of reads mapping to that genomic locus. Assuming unbiased sampling, this ratio reflects the proportion of variant alleles to the total number of alleles at that locus in the tissue sample.\n\nLet us construct an expression for the VAF based on the admixture of tumor and normal cells. The total sample is composed of a fraction $p$ of tumor cells and a fraction $1-p$ of normal cells.\n\nThe numerator of the VAF corresponds to the contribution of the variant allele (T790M). The variant allele is present only in a fraction $f$ of the cancer cells.\nThe number of variant alleles in the sample is proportional to:\n(fraction of cancer cells) $\\times$ (fraction of cancer cells with the mutation) $\\times$ (number of variant alleles per mutated cancer cell)\n$$ \\text{Number of variant alleles} \\propto p \\cdot f \\cdot m $$\n\nThe denominator of the VAF corresponds to the total number of alleles at the EGFR locus from all cells in the sample (both tumor and normal).\nThe total number of alleles from the tumor cell population is proportional to:\n(fraction of cancer cells) $\\times$ (total copy number in a cancer cell)\n$$ \\text{Total alleles from tumor cells} \\propto p \\cdot C_{t} $$\nThe total number of alleles from the normal cell population is proportional to:\n(fraction of normal cells) $\\times$ (total copy number in a normal cell)\n$$ \\text{Total alleles from normal cells} \\propto (1-p) \\cdot C_{n} $$\nThe total number of alleles in the entire sample is the sum of these two contributions:\n$$ \\text{Total alleles in sample} \\propto p \\cdot C_{t} + (1-p) \\cdot C_{n} $$\n\nThe VAF is the ratio of these quantities:\n$$ \\text{VAF} = \\frac{p \\cdot f \\cdot m}{p \\cdot C_{t} + (1-p) \\cdot C_{n}} $$\n\nThis is the general expression relating VAF to the biological parameters of the tumor sample. The problem asks us to derive an expression for the cancer cell fraction, $f$. We can rearrange the equation to solve for $f$:\n$$ f = \\frac{\\text{VAF} \\cdot (p \\cdot C_{t} + (1-p) \\cdot C_{n})}{p \\cdot m} $$\n\nNow, we can substitute the given numerical values into this expression to compute $f$:\n$\\text{VAF} = 0.2$\n$p = 0.5$\n$C_{t} = 2$\n$m = 1$\n$C_{n} = 2$\n\nPlugging these values into the equation for $f$:\n$$ f = \\frac{0.2 \\cdot (0.5 \\cdot 2 + (1-0.5) \\cdot 2)}{0.5 \\cdot 1} $$\nFirst, we evaluate the term in the parentheses, which represents the average cellular ploidy of the locus in the sample:\n$$ p \\cdot C_{t} + (1-p) \\cdot C_{n} = 0.5 \\cdot 2 + 0.5 \\cdot 2 = 1 + 1 = 2 $$\nThis result is expected, as both tumor and normal cells are diploid at this locus, so the average copy number is 2 irrespective of purity.\n\nNow, substituting this back into the expression for $f$:\n$$ f = \\frac{0.2 \\cdot 2}{0.5 \\cdot 1} $$\n$$ f = \\frac{0.4}{0.5} $$\n$$ f = 0.8 $$\n\nThe calculated cancer cell fraction is $f=0.8$. This means that the T790M mutation is present in $80\\%$ of the cancer cells in the biopsied tumor population.\n\nThe problem asks whether this finding is more consistent with clonal or subclonal emergence.\n- A **clonal mutation** is one that is present in all, or nearly all, of the cancer cells. In this mathematical framework, this would correspond to $f \\approx 1$.\n- A **subclonal mutation** is one that is present in a distinct subpopulation of the cancer cells. This corresponds to $f  1$.\n\nSince our calculated value is $f=0.8$, which is demonstrably less than $1$, the emergence of the T790M mutation is subclonal. The initial EGFR exon 19 deletion was clonal, meaning it was present in $100\\%$ of the cells that founded the tumor. After treatment, a subpopulation of these cancer cells ($80\\%$ of the current cancer cell population) has acquired a secondary T790M mutation, which is a classic pattern of acquired drug resistance. The remaining $20\\%$ of cancer cells are part of the original clone that did not acquire this specific resistance mutation.", "answer": "$$\\boxed{0.8}$$", "id": "4390906"}, {"introduction": "A primary goal of cancer genomics is to move beyond simply cataloging mutations to understanding their functional impact and identifying therapeutic vulnerabilities. This practice immerses you in the world of functional genomics, using data from a simulated CRISPR-Cas9 screen to pinpoint synthetic lethal interactionsâ€”a cornerstone of modern precision oncology. You will apply statistical analysis to log-fold change data from BRCA1-deficient and proficient cell lines to quantify differential gene essentiality and identify high-confidence therapeutic targets, mirroring the real-world process of drug discovery. [@problem_id:4390888]", "problem": "A pooled Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) negative-selection screen measures the impact of gene disruption on cell viability via log-fold changes (LFCs) in single-guide RNA abundance over time. In such screens, more negative log-fold changes indicate stronger depletion and thus greater essentiality. Consider two isogenic cell contexts: Breast Cancer Type 1 susceptibility gene (BRCA1)-deficient and BRCA1-proficient. For each gene $g$ in a set of $5$ genes, the screen yields $3$ LFC replicates in the BRCA1-deficient context and $3$ LFC replicates in the BRCA1-proficient context. Assume replicates are independent and approximately normally distributed with equal within-gene variance across the two contexts.\n\nYou are given the following replicate log-fold changes (LFCs) for each gene:\n- Gene $1$ (PARP1): BRCA1-deficient $[-2.1, -2.0, -1.9]$; BRCA1-proficient $[-0.6, -0.5, -0.4]$.\n- Gene $2$ (POLQ): BRCA1-deficient $[-1.3, -1.2, -1.1]$; BRCA1-proficient $[-0.4, -0.3, -0.2]$.\n- Gene $3$ (RAD52): BRCA1-deficient $[-0.9, -0.8, -0.7]$; BRCA1-proficient $[-0.30, -0.25, -0.20]$.\n- Gene $4$ (ATR): BRCA1-deficient $[-1.2, -1.1, -1.0]$; BRCA1-proficient $[-1.00, -0.95, -0.90]$.\n- Gene $5$ (RPL3): BRCA1-deficient $[-1.10, -1.05, -1.00]$; BRCA1-proficient $[-1.10, -1.05, -1.00]$.\n\nDefine, for gene $g$, the mean log-fold change in the BRCA1-deficient context as $\\bar{L}_{\\mathrm{def},g}$ and in the BRCA1-proficient context as $\\bar{L}_{\\mathrm{prof},g}$. The differential essentiality is defined as\n$$\n\\Delta_g = \\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}.\n$$\nA gene is considered a synthetic lethality candidate if it satisfies both $\\Delta_g \\leq -0.5$ and a two-sample pooled-variance $t$-statistic $t_g \\leq -3$, where\n$$\nt_g = \\frac{\\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{n_{\\mathrm{def}}}+\\frac{1}{n_{\\mathrm{prof}}}\\right)}},\n\\quad\ns_{p,g}^{2} = \\frac{(n_{\\mathrm{def}}-1)s_{\\mathrm{def},g}^{2}+(n_{\\mathrm{prof}}-1)s_{\\mathrm{prof},g}^{2}}{n_{\\mathrm{def}}+n_{\\mathrm{prof}}-2},\n$$\nwith $n_{\\mathrm{def}}=n_{\\mathrm{prof}}=3$, and $s_{\\mathrm{def},g}^{2}$ and $s_{\\mathrm{prof},g}^{2}$ the sample variances of the LFC replicates in the respective contexts.\n\nLet $\\mathcal{C}$ be the set of genes that meet both criteria. Compute\n$$\nS = \\sum_{g \\in \\mathcal{C}} |\\Delta_g|.\n$$\nExpress $S$ as a dimensionless number and round your answer to four significant figures.", "solution": "The user has requested a detailed solution to a problem involving the analysis of CRISPR screen data to identify synthetic lethality candidates. The first step, as per the instructions, is to validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Experiment Type**: Pooled CRISPR negative-selection screen.\n- **Cell Contexts**: BRCA1-deficient and BRCA1-proficient isogenic cells.\n- **Genes**: A set of $5$ genes, labeled $g=1, \\dots, 5$.\n- **Data per Gene**: $n_{\\mathrm{def}} = 3$ LFC replicates in the BRCA1-deficient context and $n_{\\mathrm{prof}} = 3$ LFC replicates in the BRCA1-proficient context.\n- **Data Values**:\n  - Gene $1$: def $[-2.1, -2.0, -1.9]$; prof $[-0.6, -0.5, -0.4]$.\n  - Gene $2$: def $[-1.3, -1.2, -1.1]$; prof $[-0.4, -0.3, -0.2]$.\n  - Gene $3$: def $[-0.9, -0.8, -0.7]$; prof $[-0.30, -0.25, -0.20]$.\n  - Gene $4$: def $[-1.2, -1.1, -1.0]$; prof $[-1.00, -0.95, -0.90]$.\n  - Gene $5$: def $[-1.10, -1.05, -1.00]$; prof $[-1.10, -1.05, -1.00]$.\n- **Assumptions**: Replicates are independent, approximately normally distributed, with equal within-gene variance across contexts.\n- **Definitions**:\n  - Mean LFCs: $\\bar{L}_{\\mathrm{def},g}$ and $\\bar{L}_{\\mathrm{prof},g}$.\n  - Differential essentiality: $\\Delta_g = \\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}$.\n- **Candidate Criteria**: A gene $g$ is a synthetic lethality candidate if it belongs to the set $\\mathcal{C}$, which requires satisfying two conditions:\n  1. $\\Delta_g \\leq -0.5$\n  2. $t_g \\leq -3$\n- **Formulas**:\n  - Pooled variance: $s_{p,g}^{2} = \\frac{(n_{\\mathrm{def}}-1)s_{\\mathrm{def},g}^{2}+(n_{\\mathrm{prof}}-1)s_{\\mathrm{prof},g}^{2}}{n_{\\mathrm{def}}+n_{\\mathrm{prof}}-2}$.\n  - $t$-statistic: $t_g = \\frac{\\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{n_{\\mathrm{def}}}+\\frac{1}{n_{\\mathrm{prof}}}\\right)}}$.\n- **Required Calculation**: Compute $S = \\sum_{g \\in \\mathcal{C}} |\\Delta_g|$ and round to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the field of functional genomics and precision oncology. CRISPR screens, the concept of synthetic lethality (especially in the context of BRCA deficiency and PARP inhibitors like PARP1), and the statistical methods (two-sample $t$-test with pooled variance) are standard and scientifically sound.\n- **Well-Posedness**: The problem provides all necessary data, explicit formulas, and unambiguous criteria. A unique solution can be deterministically calculated.\n- **Objectivity**: The language is precise and quantitative, free of any subjective or speculative elements.\n- **Flaw Analysis**: The problem does not violate any of the specified invalidity criteria. It is complete, consistent, realistic, and formally structured.\n\n**Step 3: Verdict and Action**\n- **Verdict**: The problem is valid.\n- **Action**: Proceed with the solution.\n\n### Solution\n\nThe objective is to identify which of the $5$ genes satisfy the two given criteria for being a synthetic lethality candidate and then to sum the absolute values of their differential essentiality scores, $\\Delta_g$.\n\nThe sample variance for a set of $n$ measurements $\\{x_i\\}$ with mean $\\bar{x}$ is given by $s^2 = \\frac{1}{n-1}\\sum_{i=1}^n(x_i - \\bar{x})^2$.\nGiven $n_{\\mathrm{def}} = n_{\\mathrm{prof}} = 3$, the formulas for the pooled variance and the $t$-statistic simplify:\nThe pooled variance is:\n$$\ns_{p,g}^{2} = \\frac{(3-1)s_{\\mathrm{def},g}^{2}+(3-1)s_{\\mathrm{prof},g}^{2}}{3+3-2} = \\frac{2s_{\\mathrm{def},g}^{2}+2s_{\\mathrm{prof},g}^{2}}{4} = \\frac{s_{\\mathrm{def},g}^{2}+s_{\\mathrm{prof},g}^{2}}{2}\n$$\nThe $t$-statistic is:\n$$\nt_g = \\frac{\\Delta_g}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{3}+\\frac{1}{3}\\right)}} = \\frac{\\Delta_g}{\\sqrt{\\frac{2s_{p,g}^{2}}{3}}}\n$$\n\nWe will now analyze each gene.\n\n**Gene 1 (PARP1)**\n- Data: def: $[-2.1, -2.0, -1.9]$; prof: $[-0.6, -0.5, -0.4]$.\n- Mean LFCs:\n  - $\\bar{L}_{\\mathrm{def},1} = \\frac{-2.1 - 2.0 - 1.9}{3} = -2.0$.\n  - $\\bar{L}_{\\mathrm{prof},1} = \\frac{-0.6 - 0.5 - 0.4}{3} = -0.5$.\n- Differential essentiality: $\\Delta_1 = \\bar{L}_{\\mathrm{def},1} - \\bar{L}_{\\mathrm{prof},1} = -2.0 - (-0.5) = -1.5$.\n- Criterion 1: $\\Delta_1 = -1.5 \\leq -0.5$. This is satisfied.\n- Sample variances:\n  - $s_{\\mathrm{def},1}^{2} = \\frac{1}{2}[(-2.1 - (-2.0))^2 + (-2.0 - (-2.0))^2 + (-1.9 - (-2.0))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = \\frac{0.02}{2} = 0.01$.\n  - $s_{\\mathrm{prof},1}^{2} = \\frac{1}{2}[(-0.6 - (-0.5))^2 + (-0.5 - (-0.5))^2 + (-0.4 - (-0.5))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = \\frac{0.02}{2} = 0.01$.\n- Pooled variance: $s_{p,1}^{2} = \\frac{0.01 + 0.01}{2} = 0.01$.\n- $t$-statistic: $t_1 = \\frac{-1.5}{\\sqrt{0.01 \\cdot (\\frac{2}{3})}} = \\frac{-1.5}{0.1\\sqrt{2/3}} = -15\\sqrt{\\frac{3}{2}} = -\\frac{15\\sqrt{6}}{2} \\approx -18.37$.\n- Criterion 2: $t_1 \\approx -18.37 \\leq -3$. This is satisfied.\n- Conclusion: Gene $1$ is a candidate. $|\\Delta_1| = 1.5$.\n\n**Gene 2 (POLQ)**\n- Data: def: $[-1.3, -1.2, -1.1]$; prof: $[-0.4, -0.3, -0.2]$.\n- Mean LFCs:\n  - $\\bar{L}_{\\mathrm{def},2} = \\frac{-1.3 - 1.2 - 1.1}{3} = -1.2$.\n  - $\\bar{L}_{\\mathrm{prof},2} = \\frac{-0.4 - 0.3 - 0.2}{3} = -0.3$.\n- Differential essentiality: $\\Delta_2 = -1.2 - (-0.3) = -0.9$.\n- Criterion 1: $\\Delta_2 = -0.9 \\leq -0.5$. This is satisfied.\n- Sample variances:\n  - $s_{\\mathrm{def},2}^{2} = \\frac{1}{2}[(-1.3 - (-1.2))^2 + (-1.2 - (-1.2))^2 + (-1.1 - (-1.2))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = 0.01$.\n  - $s_{\\mathrm{prof},2}^{2} = \\frac{1}{2}[(-0.4 - (-0.3))^2 + (-0.3 - (-0.3))^2 + (-0.2 - (-0.3))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = 0.01$.\n- Pooled variance: $s_{p,2}^{2} = \\frac{0.01 + 0.01}{2} = 0.01$.\n- $t$-statistic: $t_2 = \\frac{-0.9}{\\sqrt{0.01 \\cdot (\\frac{2}{3})}} = \\frac{-0.9}{0.1\\sqrt{2/3}} = -9\\sqrt{\\frac{3}{2}} = -\\frac{9\\sqrt{6}}{2} \\approx -11.02$.\n- Criterion 2: $t_2 \\approx -11.02 \\leq -3$. This is satisfied.\n- Conclusion: Gene $2$ is a candidate. $|\\Delta_2| = 0.9$.\n\n**Gene 3 (RAD52)**\n- Data: def: $[-0.9, -0.8, -0.7]$; prof: $[-0.30, -0.25, -0.20]$.\n- Mean LFCs:\n  - $\\bar{L}_{\\mathrm{def},3} = \\frac{-0.9 - 0.8 - 0.7}{3} = -0.8$.\n  - $\\bar{L}_{\\mathrm{prof},3} = \\frac{-0.30 - 0.25 - 0.20}{3} = -0.25$.\n- Differential essentiality: $\\Delta_3 = -0.8 - (-0.25) = -0.55$.\n- Criterion 1: $\\Delta_3 = -0.55 \\leq -0.5$. This is satisfied.\n- Sample variances:\n  - $s_{\\mathrm{def},3}^{2} = \\frac{1}{2}[(-0.9 - (-0.8))^2 + (-0.8 - (-0.8))^2 + (-0.7 - (-0.8))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = 0.01$.\n  - $s_{\\mathrm{prof},3}^{2} = \\frac{1}{2}[(-0.30 - (-0.25))^2 + (-0.25 - (-0.25))^2 + (-0.20 - (-0.25))^2] = \\frac{1}{2}[(-0.05)^2 + 0^2 + (0.05)^2] = \\frac{0.005}{2} = 0.0025$.\n- Pooled variance: $s_{p,3}^{2} = \\frac{0.01 + 0.0025}{2} = 0.00625$.\n- $t$-statistic: $t_3 = \\frac{-0.55}{\\sqrt{0.00625 \\cdot (\\frac{2}{3})}} = \\frac{-0.55}{\\sqrt{0.0125/3}} \\approx \\frac{-0.55}{0.06455} \\approx -8.52$.\n- Criterion 2: $t_3 \\approx -8.52 \\leq -3$. This is satisfied.\n- Conclusion: Gene $3$ is a candidate. $|\\Delta_3| = 0.55$.\n\n**Gene 4 (ATR)**\n- Data: def: $[-1.2, -1.1, -1.0]$; prof: $[-1.00, -0.95, -0.90]$.\n- Mean LFCs:\n  - $\\bar{L}_{\\mathrm{def},4} = \\frac{-1.2 - 1.1 - 1.0}{3} = -1.1$.\n  - $\\bar{L}_{\\mathrm{prof},4} = \\frac{-1.00 - 0.95 - 0.90}{3} = -0.95$.\n- Differential essentiality: $\\Delta_4 = -1.1 - (-0.95) = -0.15$.\n- Criterion 1: $\\Delta_4 = -0.15 \\leq -0.5$. This is not satisfied.\n- Conclusion: Gene $4$ is not a candidate.\n\n**Gene 5 (RPL3)**\n- Data: def: $[-1.10, -1.05, -1.00]$; prof: $[-1.10, -1.05, -1.00]$.\n- Mean LFCs:\n  - $\\bar{L}_{\\mathrm{def},5} = \\frac{-1.10 - 1.05 - 1.00}{3} = -1.05$.\n  - $\\bar{L}_{\\mathrm{prof},5} = \\frac{-1.10 - 1.05 - 1.00}{3} = -1.05$.\n- Differential essentiality: $\\Delta_5 = -1.05 - (-1.05) = 0$.\n- Criterion 1: $\\Delta_5 = 0 \\leq -0.5$. This is not satisfied.\n- Conclusion: Gene $5$ is not a candidate.\n\n**Final Calculation**\nThe set of candidate genes is $\\mathcal{C} = \\{\\text{Gene } 1, \\text{Gene } 2, \\text{Gene } 3\\}$.\nThe sum $S$ is calculated as:\n$$\nS = \\sum_{g \\in \\mathcal{C}} |\\Delta_g| = |\\Delta_1| + |\\Delta_2| + |\\Delta_3|\n$$\n$$\nS = |-1.5| + |-0.9| + |-0.55| = 1.5 + 0.9 + 0.55 = 2.95\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nS = 2.950\n$$", "answer": "$$\\boxed{2.950}$$", "id": "4390888"}, {"introduction": "The accumulation of mutations in a cancer genome is not random; it is the result of distinct mutational processes, each leaving a characteristic \"signature\". This advanced computational practice explores how to read these signatures to understand a tumor's history. You will implement a foundational model in cancer genomics, using Nonnegative Least Squares (NNLS) to deconvolve an observed mutational spectrum into the contributions of known signatures, thereby linking the genomic data back to the underlying biological or environmental causes of the cancer. [@problem_id:4390897]", "problem": "You are given a computational task grounded in the analysis of mutational signatures in cancer, a central task in precision medicine and genomic diagnostics. The biological premise is that somatic mutations in cancer genomes arise from multiple mutational processes, each leaving a characteristic pattern across the 96 Single Base Substitution (SBS) channels. The SBS channels are defined by the six possible base substitutions, each in the context of the immediately flanking bases, yielding a 96-channel categorization. By the principle that independent mutational processes superimpose their effects, the total observed mutation count vector can be modeled as a nonnegative linear combination of known signatures.\n\nFundamental base and assumptions: The Central Dogma of Molecular Biology posits that deoxyribonucleic acid (DNA) mutations alter genomic sequence, and well-tested empirical observations in cancer genomics show that mutational processes produce characteristic, approximately additive patterns across SBS channels. Let $y \\in \\mathbb{R}^{96}_{\\ge 0}$ denote the observed mutation counts per SBS channel. Let $S_1 \\in \\mathbb{R}^{96}_{\\ge 0}$ and $S_2 \\in \\mathbb{R}^{96}_{\\ge 0}$ denote two known mutational signatures, each normalized so that $\\sum_{i=1}^{96} S_{j,i} = 1$ for $j \\in \\{1,2\\}$. The exposures $x_1 \\ge 0$ and $x_2 \\ge 0$ quantify the contributions of signatures $S_1$ and $S_2$ to $y$. The linear model is $y \\approx x_1 S_1 + x_2 S_2$, with the unexplained component $r = y - x_1 S_1 - x_2 S_2$ capturing processes not represented by $S_1$ and $S_2$. To estimate $(x_1, x_2)$, formulate the Nonnegative Least Squares (NNLS) problem: minimize the squared Euclidean norm $\\lVert y - A x \\rVert_2^2$ subject to $x \\ge 0$, where $A \\in \\mathbb{R}^{96 \\times 2}$ has columns $S_1$ and $S_2$ and $x = (x_1, x_2)^\\top$. Interpret the residual norm fraction $f = \\lVert r \\rVert_2 / \\lVert y \\rVert_2$ as the fraction of the total signal unexplained by the two signatures. All counts are dimensionless numbers; no physical units are involved. All angles, if any, are irrelevant; none are used.\n\nYour task is to write a program that, for each specified test case, constructs $S_1$, $S_2$, the corresponding $y$, solves the NNLS problem for $(x_1, x_2)$, and computes $f$. The final output for each test case must be the list $[x_1, x_2, f]$ with each value rounded to six decimal places. Aggregate the results from all test cases into a single line as a comma-separated list enclosed in square brackets, where each element is the list for one test case, for example, $[[x_{1,1}, x_{2,1}, f_1],[x_{1,2}, x_{2,2}, f_2],\\dots]$.\n\nDefine signatures and test cases as follows to ensure reproducibility and coverage:\n\n- Signature construction:\n  - For $i \\in \\{1,2,\\dots,96\\}$, define the unnormalized vectors $b_1(i) = i$ and $b_2(i) = 97 - i$.\n  - Normalize to obtain signatures $S_1(i) = b_1(i) / \\sum_{k=1}^{96} b_1(k)$ and $S_2(i) = b_2(i) / \\sum_{k=1}^{96} b_2(k)$.\n  - Let $A$ be the matrix with columns $S_1$ and $S_2$.\n\n- Test suite:\n  1. Happy path exact mixture: $y_1 = 50 \\, S_1 + 30 \\, S_2$.\n  2. Boundary condition with one exposure zero: $y_2 = 100 \\, S_2$.\n  3. Noisy measurement favoring one signature: $y_3 = 60 \\, S_1 + n$, where $n(i) = 0.1 \\times \\left( (i \\bmod 5) / 5.0 \\right)$ for $i \\in \\{1,\\dots,96\\}$.\n  4. Near-collinearity-induced redistribution: define $S_2'(i) = \\left( 0.8 \\, S_1(i) + 0.2 \\, S_2(i) \\right)$ and renormalize so that $\\sum_{i=1}^{96} S_2'(i) = 1$ by dividing by its sum; let $y_4 = 40 \\, S_1 + 40 \\, S_2'$. Solve exposures against $A$ whose columns remain $S_1$ and $S_2$.\n  5. Out-of-span unexplained process: define $b_3(i) = 1 + 0.5 \\times ((i \\bmod 2))$ and $S_3(i) = b_3(i) / \\sum_{k=1}^{96} b_3(k)$; let $y_5 = 80 \\, S_3$. Solve exposures against $A$ whose columns are $S_1$ and $S_2$.\n\n- For each test case $t \\in \\{1,2,3,4,5\\}$:\n  - Solve $x_t = (x_{1,t}, x_{2,t})^\\top = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$.\n  - Compute $f_t = \\lVert y_t - A x_t \\rVert_2 / \\lVert y_t \\rVert_2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the list $[x_{1,t}, x_{2,t}, f_t]$ for the corresponding test case. All values must be rounded to six decimal places and expressed as decimal numbers without percentage signs. No user input or external files are allowed. The computation must be purely numerical and logically follows from the linear mixture model of mutational signatures under nonnegativity constraints.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of cancer genomics, specifically mutational signature analysis. The problem is well-posed, providing a complete and consistent mathematical formulation based on the Nonnegative Least Squares (NNLS) framework. The language is objective and precise, and all parameters and test conditions are explicitly defined, allowing for a unique and verifiable numerical solution. The problem is a non-trivial application of numerical optimization that correctly formalizes a real-world scientific question.\n\nThe task is to solve for the exposures, $x_1$ and $x_2$, of two mutational signatures, $S_1$ and $S_2$, that best explain an observed mutation count vector $y$. This is formulated as a Nonnegative Least Squares (NNLS) optimization problem:\n$$\n\\text{minimize } \\lVert y - Ax \\rVert_2^2 \\quad \\text{subject to} \\quad x \\ge 0\n$$\nwhere the matrix $A \\in \\mathbb{R}^{96 \\times 2}$ has the signatures $S_1$ and $S_2$ as its columns, $y \\in \\mathbb{R}^{96}$ is the observed mutation count vector, and $x = [x_1, x_2]^\\top$ is the vector of unknown exposures. The dimension $96$ corresponds to the number of Single Base Substitution (SBS) channels.\n\nThe solution proceeds in two main stages: first, the construction of the signature matrix $A$, and second, the iterative processing of each test case.\n\n**1. Construction of the Signature Matrix $A$**\n\nThe signatures $S_1$ and $S_2$ are derived from unnormalized base vectors $b_1$ and $b_2$, defined over the channels $i \\in \\{1, 2, \\dots, 96\\}$.\n- $b_1(i) = i$\n- $b_2(i) = 97 - i$\n\nThese vectors must be normalized to sum to $1$. The normalization constant is the sum of the vector's elements. For $b_1$, this is the sum of an arithmetic series:\n$$\n\\sum_{k=1}^{96} b_1(k) = \\sum_{k=1}^{96} k = \\frac{96 \\times (96 + 1)}{2} = \\frac{96 \\times 97}{2} = 4656\n$$\nBy symmetry, the sum for $b_2$ is identical:\n$$\n\\sum_{k=1}^{96} b_2(k) = \\sum_{k=1}^{96} (97 - k) = 96 \\times 97 - \\sum_{k=1}^{96} k = 9312 - 4656 = 4656\n$$\nThe normalized signatures are thus:\n$$\nS_1 = \\frac{b_1}{4656} \\quad \\text{and} \\quad S_2 = \\frac{b_2}{4656}\n$$\nThe matrix $A$ is then constructed by setting $S_1$ and $S_2$ as its columns: $A = [S_1 | S_2]$.\n\n**2. Processing of Test Cases**\n\nFor each of the five test cases, the following steps are performed:\na. **Construct the observation vector $y_t$** according to the specific rules for case $t \\in \\{1, \\dots, 5\\}$.\nb. **Solve the NNLS problem**: We find the optimal exposure vector $x_t = [x_{1,t}, x_{2,t}]^\\top$ by solving $x_t = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$. This is a standard convex optimization problem, which can be solved efficiently using numerical algorithms such as the active-set method implemented in SciPy's `scipy.optimize.nnls` function.\nc. **Compute the residual fraction $f_t$**: After finding $x_t$, the residual vector is $r_t = y_t - A x_t$. The residual fraction, which quantifies the proportion of the signal unexplained by the model, is calculated as the ratio of the Euclidean norms:\n$$\nf_t = \\frac{\\lVert r_t \\rVert_2}{\\lVert y_t \\rVert_2} = \\frac{\\lVert y_t - A x_t \\rVert_2}{\\lVert y_t \\rVert_2}\n$$\nIf $\\lVert y_t \\rVert_2 = 0$, $f_t$ is defined as $0$.\n\nThe five test cases are designed to probe different aspects of the model:\n- **Case 1**: $y_1 = 50 \\, S_1 + 30 \\, S_2$. An exact mixture. We expect the solution to be $x_1 \\approx 50$, $x_2 \\approx 30$, and $f_1 \\approx 0$.\n- **Case 2**: $y_2 = 100 \\, S_2$. A boundary condition. We expect $x_1 \\approx 0$, $x_2 \\approx 100$, and $f_2 \\approx 0$.\n- **Case 3**: $y_3 = 60 \\, S_1 + n$, where $n$ is a small, structured noise vector. We expect $x_1$ to be close to $60$, $x_2$ close to $0$, and $f_3$ to be small but non-zero.\n- **Case 4**: A case of near-collinearity. The signal is $y_4 = 40 \\, S_1 + 40 \\, S_2'$, where $S_2'$ is a linear combination of $S_1$ and $S_2$. Specifically, $S_2' = 0.8 S_1 + 0.2 S_2$ (since the sum is already $1$, renormalization is not needed). Thus, $y_4 = 40 S_1 + 40(0.8 S_1 + 0.2 S_2) = 72 S_1 + 8 S_2$. We expect the solver to find $x_1 \\approx 72$, $x_2 \\approx 8$, and $f_4 \\approx 0$.\n- **Case 5**: An out-of-span signal, $y_5 = 80 \\, S_3$, where $S_3$ is a signature with an alternating pattern, distinct from the linear trends of $S_1$ and $S_2$. We expect a poor fit, resulting in a large residual fraction $f_5$.\n\nThe final output for each case is the list $[x_{1,t}, x_{2,t}, f_t]$, with each value rounded to six decimal places. These lists are aggregated into a final list of lists.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs mutational signatures, generates test case data, solves the\n    Nonnegative Least Squares (NNLS) problem for each case, and computes\n    the residual norm fraction.\n    \"\"\"\n\n    # 1. Construct the base signatures S1, S2, and the matrix A.\n    # The channels are indexed i from 1 to 96.\n    i = np.arange(1, 97, dtype=float)\n\n    # Define unnormalized vectors b1 and b2.\n    b1 = i\n    b2 = 97.0 - i\n\n    # Normalize to obtain signatures S1 and S2.\n    # The normalization constant is the sum of an arithmetic series.\n    norm_const = np.sum(b1)  # 96 * 97 / 2 = 4656.0\n    S1 = b1 / norm_const\n    S2 = b2 / norm_const\n\n    # Construct the signature matrix A.\n    A = np.stack([S1, S2], axis=1)\n\n    # List to store results from all test cases.\n    all_results = []\n\n    # --- Test Case Generation and Processing ---\n\n    # Case 1: Happy path exact mixture\n    y1 = 50.0 * S1 + 30.0 * S2\n    \n    # Case 2: Boundary condition with one exposure zero\n    y2 = 100.0 * S2\n    \n    # Case 3: Noisy measurement favoring one signature\n    # n(i) = 0.1 * ((i mod 5) / 5.0) for i in {1,...,96}\n    noise_indices = np.arange(1, 97)\n    n = 0.1 * ((noise_indices % 5) / 5.0)\n    y3 = 60.0 * S1 + n\n    \n    # Case 4: Near-collinearity-induced redistribution\n    # S2' = (0.8 * S1 + 0.2 * S2), renormalized.\n    # The sum of S2_prime_unnorm is already 1, so renormalization is trivial.\n    S2_prime_unnorm = 0.8 * S1 + 0.2 * S2\n    norm_s2p = np.sum(S2_prime_unnorm)\n    S2_prime = S2_prime_unnorm / norm_s2p\n    y4 = 40.0 * S1 + 40.0 * S2_prime\n    \n    # Case 5: Out-of-span unexplained process\n    # b3(i) = 1 + 0.5 * ((i mod 2))\n    b3_indices = np.arange(1, 97)\n    b3 = 1.0 + 0.5 * (b3_indices % 2)\n    S3 = b3 / np.sum(b3)\n    y5 = 80.0 * S3\n\n    test_cases_y = [y1, y2, y3, y4, y5]\n\n    for y in test_cases_y:\n        # Solve the NNLS problem: min ||Ax - y||_2^2 subject to x = 0\n        x, residual_norm = nnls(A, y)\n        \n        # Compute the residual fraction f\n        y_norm = np.linalg.norm(y)\n        f = residual_norm / y_norm if y_norm > 0 else 0.0\n        \n        # Get exposures x1 and x2\n        x1 = x[0]\n        x2 = x[1]\n        \n        # Append the rounded results\n        result = [round(x1, 6), round(x2, 6), round(f, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list gives the desired '[...]' format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "4390897"}]}