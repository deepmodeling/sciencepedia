{"hands_on_practices": [{"introduction": "A core task in cancer genomics is translating raw sequencing data into meaningful metrics of aneuploidy, a process complicated by the presence of normal cells in a tumor sample. This exercise provides hands-on practice with the fundamental linear mixture model used to deconvolve bulk data. Mastering this allows you to calculate tumor-specific copy numbers and quantify genomic instability through standard metrics like Somatic Copy Number Alteration (SCNA) burden [@problem_id:4322031].", "problem": "A bulk whole-genome sequencing assay is performed on a single solid tumor sample within a precision oncology workflow. The tumor cell fraction (purity) is estimated to be $p = 0.7$. Assume the following foundational facts:\n- The observed absolute copy number per genomic segment in a bulk sample arises from a linear mixture of contributions from normal cells (diploid with copy number $2$) and tumor cells. The tumor contribution is captured by the tumor-average copy number for that segment, and the normal contribution is fixed at $2$.\n- Somatic Copy Number Alteration (SCNA) is defined as any deviation of the tumor-average copy number from the diploid state $2$.\n- Aneuploidy at the arm level refers to copy number imbalance affecting a substantial fraction of a chromosome arm with a consistent direction (gain or loss).\n\nTo focus the calculation, consider that the “genome under consideration” consists of exactly the following four chromosome arms, with their lengths and segmentation provided. Lengths are in megabase (Mb). For each segment, an absolute bulk copy number estimate is provided, which is the observable produced by the mixture of tumor and normal cells.\n\n- Chromosome arm $1\\mathrm{p}$ (length $120$ Mb):\n  - Segment $[0, 60)$ Mb: observed absolute copy number $2.7$.\n  - Segment $[60, 120)$ Mb: observed absolute copy number $2.0$.\n\n- Chromosome arm $1\\mathrm{q}$ (length $150$ Mb):\n  - Segment $[0, 120)$ Mb: observed absolute copy number $1.3$.\n  - Segment $[120, 150)$ Mb: observed absolute copy number $2.0$.\n\n- Chromosome arm $3\\mathrm{p}$ (length $100$ Mb):\n  - Segment $[0, 40)$ Mb: observed absolute copy number $2.35$.\n  - Segment $[40, 100)$ Mb: observed absolute copy number $2.0$.\n\n- Chromosome arm $7\\mathrm{q}$ (length $160$ Mb):\n  - Segment $[0, 160)$ Mb: observed absolute copy number $2.56$.\n\nUsing only the foundational mixture principle stated above, proceed as follows:\n\n1. For each segment, derive the tumor-average copy number from the observed absolute copy number and the purity $p$, and then compute the segment’s SCNA amplitude as the absolute deviation of the tumor-average copy number from $2$.\n\n2. Define an “arm-level aneuploidy event” as present on a chromosome arm if at least $0.6$ of the arm’s length shows SCNAs with a consistent direction (gain if tumor-average copy number $> 2$, loss if $< 2$), and the mean absolute deviation across that consistently directed portion is at least $0.5$ in copy units. Count the total number of arm-level aneuploidy events across the four arms to obtain $N$.\n\n3. Define the SCNA burden $B$ over the genome under consideration as the amplitude-weighted fraction of the genome altered:\n   $$B \\equiv \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{(\\mathrm{tumor})} - 2|}{\\sum_{i} \\ell_{i}},$$\n   where $\\ell_{i}$ is the length of segment $i$ and $C_{i}^{(\\mathrm{tumor})}$ is the tumor-average copy number for segment $i$.\n\n4. Define a composite score $S \\equiv N + B$.\n\nCompute $S$ for the provided data. Express the final answer as a pure number (dimensionless). Round your answer to four significant figures.", "solution": "## Solution\n\nThe solution proceeds in four steps as outlined in the problem statement.\n\n### Step 1: Derive Tumor-Average Copy Number and SCNA Amplitude\n\nThe observed absolute copy number, $C_{\\text{obs}}$, is given by the linear mixture model:\n$$C_{\\text{obs}} = p \\cdot C_{\\text{tumor}} + (1-p) \\cdot C_{\\text{normal}}$$\nGiven $p = 0.7$ and $C_{\\text{normal}} = 2$, the equation becomes:\n$$C_{\\text{obs}} = 0.7 \\cdot C_{\\text{tumor}} + (1-0.7) \\cdot 2 = 0.7 \\cdot C_{\\text{tumor}} + 0.6$$\nRearranging to solve for the tumor-average copy number, $C_{\\text{tumor}}$, we get:\n$$C_{\\text{tumor}} = \\frac{C_{\\text{obs}} - 0.6}{0.7}$$\nThe SCNA amplitude for each segment is defined as the absolute deviation from the diploid state, $|C_{\\text{tumor}} - 2|$. We compute these values for each segment.\n\n- **Arm $1\\mathrm{p}$, Segment $[0, 60)$ Mb**: $\\ell_1 = 60$ Mb, $C_{\\text{obs},1} = 2.7$.\n  $$C_{\\text{tumor},1} = \\frac{2.7 - 0.6}{0.7} = \\frac{2.1}{0.7} = 3$$\n  SCNA Amplitude: $|3 - 2| = 1$. This is a gain.\n\n- **Arm $1\\mathrm{p}$, Segment $[60, 120)$ Mb**: $\\ell_2 = 60$ Mb, $C_{\\text{obs},2} = 2.0$.\n  $$C_{\\text{tumor},2} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA Amplitude: $|2 - 2| = 0$. This is diploid.\n\n- **Arm $1\\mathrm{q}$, Segment $[0, 120)$ Mb**: $\\ell_3 = 120$ Mb, $C_{\\text{obs},3} = 1.3$.\n  $$C_{\\text{tumor},3} = \\frac{1.3 - 0.6}{0.7} = \\frac{0.7}{0.7} = 1$$\n  SCNA Amplitude: $|1 - 2| = 1$. This is a loss.\n\n- **Arm $1\\mathrm{q}$, Segment $[120, 150)$ Mb**: $\\ell_4 = 30$ Mb, $C_{\\text{obs},4} = 2.0$.\n  $$C_{\\text{tumor},4} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA Amplitude: $|2 - 2| = 0$. This is diploid.\n\n- **Arm $3\\mathrm{p}$, Segment $[0, 40)$ Mb**: $\\ell_5 = 40$ Mb, $C_{\\text{obs},5} = 2.35$.\n  $$C_{\\text{tumor},5} = \\frac{2.35 - 0.6}{0.7} = \\frac{1.75}{0.7} = 2.5$$\n  SCNA Amplitude: $|2.5 - 2| = 0.5$. This is a gain.\n\n- **Arm $3\\mathrm{p}$, Segment $[40, 100)$ Mb**: $\\ell_6 = 60$ Mb, $C_{\\text{obs},6} = 2.0$.\n  $$C_{\\text{tumor},6} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA Amplitude: $|2 - 2| = 0$. This is diploid.\n\n- **Arm $7\\mathrm{q}$, Segment $[0, 160)$ Mb**: $\\ell_7 = 160$ Mb, $C_{\\text{obs},7} = 2.56$.\n  $$C_{\\text{tumor},7} = \\frac{2.56 - 0.6}{0.7} = \\frac{1.96}{0.7} = 2.8$$\n  SCNA Amplitude: $|2.8 - 2| = 0.8$. This is a gain.\n\n### Step 2: Count Arm-Level Aneuploidy Events ($N$)\n\nAn arm-level aneuploidy event requires that at least $0.6$ of the arm's length has a consistent SCNA direction (gain or loss) and the mean absolute deviation in that region is at least $0.5$.\n\n- **Arm $1\\mathrm{p}$ (Total length $120$ Mb)**: There is a gain in a segment of length $60$ Mb. The fraction of the arm altered is $\\frac{60}{120} = 0.5$. Since $0.5 < 0.6$, arm $1\\mathrm{p}$ does not have an arm-level event.\n\n- **Arm $1\\mathrm{q}$ (Total length $150$ Mb)**: There is a loss in a segment of length $120$ Mb. The fraction of the arm altered is $\\frac{120}{150} = 0.8$. Since $0.8 \\ge 0.6$, the first condition is met. The mean absolute deviation across this portion is the amplitude of the single segment, which is $1$. Since $1 \\ge 0.5$, the second condition is met. Thus, arm $1\\mathrm{q}$ has an arm-level aneuploidy event.\n\n- **Arm $3\\mathrm{p}$ (Total length $100$ Mb)**: There is a gain in a segment of length $40$ Mb. The fraction of the arm altered is $\\frac{40}{100} = 0.4$. Since $0.4 < 0.6$, arm $3\\mathrm{p}$ does not have an arm-level event.\n\n- **Arm $7\\mathrm{q}$ (Total length $160$ Mb)**: There is a gain across the entire arm, length $160$ Mb. The fraction of the arm altered is $\\frac{160}{160} = 1.0$. Since $1.0 \\ge 0.6$, the first condition is met. The mean absolute deviation is the amplitude of the segment, which is $0.8$. Since $0.8 \\ge 0.5$, the second condition is met. Thus, arm $7\\mathrm{q}$ has an arm-level aneuploidy event.\n\nThe total number of arm-level aneuploidy events is the sum of events on arms $1\\mathrm{q}$ and $7\\mathrm{q}$.\n$$N = 1 + 1 = 2$$\n\n### Step 3: Calculate SCNA Burden ($B$)\n\nThe SCNA burden $B$ is the amplitude-weighted fraction of the genome altered:\n$$B = \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{(\\mathrm{tumor})} - 2|}{\\sum_{i} \\ell_{i}}$$\nThe numerator is the sum of the products of each segment's length and its SCNA amplitude. We only need to sum over segments with non-zero amplitude.\n$$ \\text{Numerator} = (60 \\cdot 1) + (120 \\cdot 1) + (40 \\cdot 0.5) + (160 \\cdot 0.8) $$\n$$ \\text{Numerator} = 60 + 120 + 20 + 128 = 328 $$\nThe denominator is the total length of the genome under consideration.\n$$ \\text{Denominator} = \\ell_{1\\mathrm{p}} + \\ell_{1\\mathrm{q}} + \\ell_{3\\mathrm{p}} + \\ell_{7\\mathrm{q}} = 120 + 150 + 100 + 160 = 530 $$\nThe SCNA burden is:\n$$B = \\frac{328}{530} \\approx 0.6188679...$$\n\n### Step 4: Calculate Composite Score ($S$)\n\nThe composite score $S$ is defined as $N + B$.\n$$ S = 2 + \\frac{328}{530} \\approx 2 + 0.6188679... = 2.6188679... $$\nThe problem requires rounding the result to four significant figures. The first four significant figures are $2$, $6$, $1$, and $8$. The fifth digit is $8$, so we round up the fourth digit.\n$$ S \\approx 2.619 $$", "answer": "$$\n\\boxed{2.619}\n$$", "id": "4322031"}, {"introduction": "Beyond measuring total copy number, analyzing allele-specific frequencies can reveal more subtle but crucial genomic events like copy-neutral Loss of Heterozygosity (LOH). This practice introduces a powerful statistical method, Bayesian model comparison, to rigorously weigh the evidence for competing biological hypotheses. By calculating the Bayes factor, you will learn to quantify the support for LOH versus retained heterozygosity based on allele counts from a mixed tumor sample [@problem_id:4322015].", "problem": "A tumor sample from a patient is analyzed by high-depth targeted sequencing at a germline heterozygous single-nucleotide polymorphism (SNP) with alleles denoted $A$ and $B$. The tumor purity, defined as the fraction of nucleated cells in the specimen that are cancer cells, is $p = 0.70$. Consider two competing models for the locus in the cancer cells:\n\n- Model $\\mathcal{M}_0$ (no loss of heterozygosity): The cancer cells are disomic and heterozygous $A/B$ at the locus. In the noncancer cells (fraction $1-p$), the genotype is also $A/B$.\n\n- Model $\\mathcal{M}_1$ (copy-neutral loss of heterozygosity via mitotic recombination): The cancer cells are disomic but homozygous at the locus due to mitotic recombination generating uniparental disomy; they are $A/A$ or $B/B$ with equal prior probability. The noncancer cells (fraction $1-p$) are $A/B$.\n\nAssume that sequencing reads are independent and identically distributed Bernoulli trials with success probability equal to the true underlying fraction of the $B$ allele in the cell mixture, and that there is no allelic mapping bias or overdispersion beyond binomial sampling. At the SNP, a total of $N = 100$ reads are obtained, of which $k = 20$ report the $B$ allele.\n\nUsing equal model priors for $\\mathcal{M}_0$ and $\\mathcal{M}_1$, compute the base-$10$ logarithm of the Bayes factor $K$ in favor of $\\mathcal{M}_1$ over $\\mathcal{M}_0$, where $K$ is defined as the ratio of marginal likelihoods of the observed data under $\\mathcal{M}_1$ and $\\mathcal{M}_0$. Round your answer to four significant figures. Express your answer as a pure number with no units.", "solution": "The problem requires the computation of the base-$10$ logarithm of the Bayes factor, $K$, which compares two models for the genetic state of a tumor at a specific locus. The Bayes factor is the ratio of the marginal likelihoods of the observed data under each model.\n\nFirst, we establish the framework for the likelihood calculation. The data, $D$, consists of observing $k=20$ reads for the $B$ allele out of a total of $N=100$ sequencing reads. The problem states that the reads are independent and identically distributed Bernoulli trials. This implies that the number of $B$ allele reads, $k$, follows a binomial distribution, conditional on the true fraction of the $B$ allele, $\\theta$, in the sequenced DNA pool. The probability mass function (PMF) for observing $k$ successes in $N$ trials is given by:\n$$P(k|\\theta, N) = \\binom{N}{k} \\theta^k (1-\\theta)^{N-k}$$\n\nThe expected fraction of the $B$ allele, $\\theta$, depends on the model under consideration. The total DNA in the sample is a mixture of DNA from cancer cells (with fraction $p$) and noncancer cells (with fraction $1-p$). The overall allele fraction $\\theta$ is the weighted average of the fractions in the two cell populations. All noncancer cells are germline heterozygous $A/B$, so the fraction of the $B$ allele in this population is $0.5$.\n\nLet's analyze each model separately.\n\n**Model $\\mathcal{M}_0$: No Loss of Heterozygosity**\nUnder this model, the cancer cells retain their heterozygous $A/B$ genotype.\n- Fraction of $B$ allele in cancer cells: $0.5$.\n- Fraction of $B$ allele in noncancer cells: $0.5$.\n\nThe overall fraction of the $B$ allele, $\\theta_0$, is:\n$$\\theta_0 = p \\times (0.5) + (1-p) \\times (0.5) = 0.5p + 0.5 - 0.5p = 0.5$$\nThe likelihood of the data under model $\\mathcal{M}_0$ is the probability of observing $k$ reads for the $B$ allele given $\\theta_0 = 0.5$:\n$$P(D|\\mathcal{M}_0) = P(k=20 | \\theta_0=0.5, N=100) = \\binom{100}{20} (0.5)^{20} (1-0.5)^{100-20} = \\binom{100}{20} (0.5)^{100}$$\n\n**Model $\\mathcal{M}_1$: Copy-Neutral Loss of Heterozygosity**\nThis model is a mixture of two sub-models, which we denote $\\mathcal{M}_{1,A/A}$ (cancer cells are homozygous $A/A$) and $\\mathcal{M}_{1,B/B}$ (cancer cells are homozygous $B/B$). The problem states these have equal prior probability, $P(\\mathcal{M}_{1,A/A}|\\mathcal{M}_1) = P(\\mathcal{M}_{1,B/B}|\\mathcal{M}_1) = 0.5$.\n\nThe marginal likelihood for $\\mathcal{M}_1$ is computed using the law of total probability:\n$$P(D|\\mathcal{M}_1) = P(D|\\mathcal{M}_{1,A/A})P(\\mathcal{M}_{1,A/A}|\\mathcal{M}_1) + P(D|\\mathcal{M}_{1,B/B})P(\\mathcal{M}_{1,B/B}|\\mathcal{M}_1)$$\n$$P(D|\\mathcal{M}_1) = 0.5 \\times P(D|\\mathcal{M}_{1,A/A}) + 0.5 \\times P(D|\\mathcal{M}_{1,B/B})$$\n\nWe need to calculate the likelihood for each sub-model.\n- **Sub-model $\\mathcal{M}_{1,A/A}$**: Cancer cells are $A/A$.\n  - Fraction of $B$ allele in cancer cells: $0$.\n  - Fraction of $B$ allele in noncancer cells: $0.5$.\n  - The overall fraction of the $B$ allele, $\\theta_{1,A/A}$, is:\n    $$\\theta_{1,A/A} = p \\times (0) + (1-p) \\times (0.5) = 0.5(1-p)$$\n  - The likelihood for this sub-model is:\n    $$P(D|\\mathcal{M}_{1,A/A}) = \\binom{N}{k} (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k}$$\n\n- **Sub-model $\\mathcal{M}_{1,B/B}$**: Cancer cells are $B/B$.\n  - Fraction of $B$ allele in cancer cells: $1$.\n  - Fraction of $B$ allele in noncancer cells: $0.5$.\n  - The overall fraction of the $B$ allele, $\\theta_{1,B/B}$, is:\n    $$\\theta_{1,B/B} = p \\times (1) + (1-p) \\times (0.5) = p + 0.5 - 0.5p = 0.5(1+p)$$\n  - The likelihood for this sub-model is:\n    $$P(D|\\mathcal{M}_{1,B/B}) = \\binom{N}{k} (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k}$$\n\nCombining these, the marginal likelihood for $\\mathcal{M}_1$ is:\n$$P(D|\\mathcal{M}_1) = 0.5 \\binom{N}{k} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]$$\n\nNow we can compute the Bayes factor, $K$, in favor of $\\mathcal{M}_1$ over $\\mathcal{M}_0$:\n$$K = \\frac{P(D|\\mathcal{M}_1)}{P(D|\\mathcal{M}_0)} = \\frac{0.5 \\binom{N}{k} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]}{\\binom{N}{k} (0.5)^N}$$\nThe combinatorial term $\\binom{N}{k}$ cancels out:\n$$K = \\frac{0.5 \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]}{(0.5)^N} = 2^{N-1} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]$$\n\nWe substitute the given numerical values: $p = 0.70$, $N=100$, and $k=20$.\nFirst, calculate the allele fractions for model $\\mathcal{M}_1$:\n$$\\theta_{1,A/A} = 0.5(1-0.70) = 0.5(0.30) = 0.15$$\n$$1 - \\theta_{1,A/A} = 1 - 0.15 = 0.85$$\n$$\\theta_{1,B/B} = 0.5(1+0.70) = 0.5(1.70) = 0.85$$\n$$1 - \\theta_{1,B/B} = 1 - 0.85 = 0.15$$\nSubstituting these into the expression for $K$:\n$$K = 2^{100-1} \\left[ (0.15)^{20} (0.85)^{100-20} + (0.85)^{20} (0.15)^{100-20} \\right]$$\n$$K = 2^{99} \\left[ (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right]$$\n\nThe final step is to compute the base-$10$ logarithm of $K$:\n$$\\log_{10}(K) = \\log_{10}\\left(2^{99} \\left[ (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right]\\right)$$\nUsing the properties of logarithms:\n$$\\log_{10}(K) = 99 \\log_{10}(2) + \\log_{10}\\left( (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right)$$\nLet's evaluate the two terms inside the sum separately.\nLet $T_1 = (0.15)^{20} (0.85)^{80}$ and $T_2 = (0.85)^{20} (0.15)^{80}$.\n$$\\log_{10}(T_1) = 20 \\log_{10}(0.15) + 80 \\log_{10}(0.85)$$\n$$\\log_{10}(T_2) = 20 \\log_{10}(0.85) + 80 \\log_{10}(0.15)$$\nUsing standard values $\\log_{10}(0.15) \\approx -0.8239$ and $\\log_{10}(0.85) \\approx -0.07058$:\n$$\\log_{10}(T_1) \\approx 20(-0.8239) + 80(-0.07058) = -16.478 - 5.6464 = -22.1244$$\n$$\\log_{10}(T_2) \\approx 20(-0.07058) + 80(-0.8239) = -1.4116 - 65.912 = -67.3236$$\nSince $\\log_{10}(T_2)$ is much more negative than $\\log_{10}(T_1)$, $T_2$ is many orders of magnitude smaller than $T_1$. Therefore, the sum $T_1 + T_2 \\approx T_1$. We can formalize this:\n$$T_1 + T_2 = T_1 \\left(1 + \\frac{T_2}{T_1}\\right)$$\n$$\\log_{10}(T_1 + T_2) = \\log_{10}(T_1) + \\log_{10}\\left(1 + \\frac{T_2}{T_1}\\right)$$\nThe ratio $\\frac{T_2}{T_1} = \\frac{10^{-67.3236}}{10^{-22.1244}} = 10^{-45.1992}$, which is a number extremely close to zero. The term $\\log_{10}(1 + 10^{-45.1992})$ is infinitesimally small and can be safely neglected.\nThus, $\\log_{10}(T_1+T_2) \\approx \\log_{10}(T_1)$.\n\nNow, we compute $\\log_{10}(K)$:\n$$\\log_{10}(K) \\approx 99 \\log_{10}(2) + \\log_{10}(T_1)$$\n$$\\log_{10}(K) \\approx 99 \\log_{10}(2) + 20 \\log_{10}(0.15) + 80 \\log_{10}(0.85)$$\nUsing higher precision values:\n$\\log_{10}(2) \\approx 0.3010300$\n$\\log_{10}(0.15) \\approx -0.8239087$\n$\\log_{10}(0.85) \\approx -0.0705811$\n$$\\log_{10}(K) \\approx 99(0.3010300) + 20(-0.8239087) + 80(-0.0705811)$$\n$$\\log_{10}(K) \\approx 29.80197 - 16.478174 - 5.646488$$\n$$\\log_{10}(K) \\approx 7.677308$$\nRounding the result to four significant figures gives $7.677$.", "answer": "$$\\boxed{7.677}$$", "id": "4322015"}, {"introduction": "A major challenge in genomic analysis is distinguishing true biological signals from technical artifacts, such as those arising from GC-content bias or poor mappability. This advanced practice guides you through implementing a Bayesian classifier, mirroring the work of a professional bioinformatician. You will build a model that integrates multiple data types and prior knowledge to create a robust quality-control filter for copy number alterations, an essential component of any clinical genomics pipeline [@problem_id:4321978].", "problem": "You are tasked with implementing a statistically principled quality-control classifier to distinguish true segment-level Copy-Number Alteration (CNA) events from artifacts in sequencing data, in the setting of Precision Medicine and Genomic Diagnostics. The context is that CNA segments are called using coverage and allelic imbalance; however, coverage may be distorted by Global Content (GC) bias and mappability, and allelic imbalance may be confounded by allelic mapping bias. Your job is to produce a runnable program that, for a small test suite of segments, outputs a decision for each segment indicating whether it is more likely a true CNA than an artifact. Although the topic also relates to Structural Variant (SV) calling, the quantitative features used here are segment-level depth and B-Allele Frequency (BAF), which are directly affected by chromosomal aneuploidy and rearrangements.\n\nFundamental building blocks and assumptions:\n- Sequencing read counts over windows follow a Poisson-like process, and under aggregation across $n$ windows with effective mappability $m$, the mean log$_2$-ratio deviation $d$ can be approximated by a Normal distribution due to the Central Limit Theorem. Specifically, under any fixed hypothesis, $d \\sim \\mathcal{N}(\\mu_D, \\sigma_D^2)$, with variance\n$$\n\\sigma_D^2 \\;=\\; \\frac{\\sigma_0^2}{n\\,m},\n$$\nwhere $\\sigma_0$ is a per-window baseline standard deviation at $m=1$.\n- For heterozygous single-nucleotide polymorphisms (SNPs), the mean B-Allele Frequency (BAF) deviation from $0.5$, denoted $b$, averaged across $k$ informative loci, is approximated by a Normal distribution $b \\sim \\mathcal{N}(\\mu_B, \\sigma_B^2)$ with\n$$\n\\sigma_B^2 \\;=\\; \\frac{0.25}{k},\n$$\nusing the Binomial variance around $0.5$ and averaging over $k$ loci.\n- The mixing of tumor and normal genomes at tumor purity $\\pi$ yields an expected total copy-number in the segment\n$$\nE[\\text{copy}] \\;=\\; \\pi\\,c \\;+\\; (1-\\pi)\\cdot 2,\n$$\nwhere $c$ is the tumor copy-number in the segment and the normal is diploid ($2$ copies). The expected log$_2$-ratio under a true CNA is then\n$$\n\\mu_{D,1} \\;=\\; \\log_2\\!\\left(\\frac{\\pi\\,c + 2(1-\\pi)}{2}\\right).\n$$\n- Under an artifact hypothesis driven by GC bias, the expected log$_2$-ratio is modeled as\n$$\n\\mu_{D,0} \\;=\\; \\beta_g \\, g,\n$$\nwhere $g$ is the mean standardized GC content for the segment and $\\beta_g$ is the GC-bias coefficient capturing the linear effect of GC on log$_2$-ratio.\n- For BAF under a true CNA, with the tumor major-allele count $c_A$ and minor-allele count $c_B = c - c_A$, the expected B-allele fraction (taking the B allele as the minor) in the tumor-normal mixture is\n$$\n\\text{AF}_B \\;=\\; \\frac{\\pi\\,c_B + (1-\\pi)\\cdot 1}{\\pi\\,c + (1-\\pi)\\cdot 2},\n$$\nand the expected absolute BAF deviation is\n$$\n\\mu_{B,1} \\;=\\; \\left|\\,\\text{AF}_B - 0.5\\,\\right|.\n$$\nUnder the artifact hypothesis, a small mapping bias produces a non-zero mean absolute deviation\n$$\n\\mu_{B,0} \\;=\\; b_0.\n$$\n- Assume conditional independence of $d$ and $b$ given a hypothesis. The likelihood for a segment under hypothesis $H\\in\\{0,1\\}$ is the product of the two Normals. Use a Bayesian decision rule with a prior log-odds favoring a true CNA that penalizes strong GC-correlation and low mappability:\n$$\n\\log\\frac{P(H=1)}{P(H=0)} \\;=\\; \\eta_0 \\;-\\; \\eta_r\\,|r| \\;-\\; \\eta_m\\,(1-m),\n$$\nwhere $r$ is the absolute empirical correlation between window-level depth and GC content in the segment, and $\\eta_0,\\eta_r,\\eta_m$ are constants. The posterior log-odds is the sum of this prior log-odds and the log-likelihood ratio (true CNA over artifact). Classify a segment as a true CNA if and only if the posterior probability exceeds $0.5$, equivalently if the posterior log-odds is positive.\n\nMathematical summary to implement:\n- For each segment, compute\n$$\n\\text{LLR}_D \\;=\\; \\log \\frac{\\phi(d;\\mu_{D,1},\\sigma_D^2)}{\\phi(d;\\mu_{D,0},\\sigma_D^2)},\\qquad\n\\text{LLR}_B \\;=\\; \\log \\frac{\\phi(b;\\mu_{B,1},\\sigma_B^2)}{\\phi(b;\\mu_{B,0},\\sigma_B^2)},\n$$\nwhere $\\phi(x;\\mu,\\sigma^2)$ is the Normal density.\n- Posterior log-odds\n$$\n\\Lambda \\;=\\; \\text{LLR}_D \\;+\\; \\text{LLR}_B \\;+\\; \\eta_0 \\;-\\; \\eta_r\\,|r| \\;-\\; \\eta_m\\,(1-m).\n$$\n- Decision is $H_1$ (true CNA) if $\\Lambda > 0$, else $H_0$ (artifact).\n\nUse the following fixed constants in all test cases:\n- $\\sigma_0 = 0.2$,\n- $b_0 = 0.01$,\n- $\\eta_0 = 0.0$,\n- $\\eta_r = 3.0$,\n- $\\eta_m = 1.5$.\n\nFor each test case $i$, you are given a tuple of parameters in the order\n$$\n(n,\\; d,\\; g,\\; m,\\; \\pi,\\; c,\\; c_A,\\; k,\\; b,\\; r,\\; \\beta_g).\n$$\nImplement the classifier above and return a boolean indicating whether the segment is a true CNA.\n\nTest suite (each line is one test case; numbers are decimals):\n- Case $1$: $(200,\\; 0.36,\\; 0.1,\\; 0.95,\\; 0.6,\\; 3,\\; 2,\\; 150,\\; 0.11,\\; 0.05,\\; 0.18)$\n- Case $2$: $(120,\\; 0.27,\\; 1.2,\\; 0.98,\\; 0.7,\\; 2,\\; 1,\\; 100,\\; 0.012,\\; 0.85,\\; 0.22)$\n- Case $3$: $(30,\\; -0.12,\\; -0.6,\\; 0.6,\\; 0.5,\\; 2,\\; 1,\\; 20,\\; 0.02,\\; 0.4,\\; 0.22)$\n- Case $4$: $(180,\\; 0.02,\\; 0.0,\\; 0.97,\\; 0.7,\\; 2,\\; 2,\\; 160,\\; 0.33,\\; 0.08,\\; 0.2)$\n- Case $5$: $(100,\\; -0.21,\\; -0.1,\\; 0.9,\\; 0.3,\\; 1,\\; 1,\\; 80,\\; 0.09,\\; 0.1,\\; 0.2)$\n\nFinal output format:\n- Your program should produce a single line of output containing the classification results for the test cases, in order, as a comma-separated list of booleans enclosed in square brackets, for example, `[True,False,...]`.\n- There must be exactly one line printed and no other text.\n\nNotes:\n- All computations must follow the equations above.\n- Angles do not appear; no physical units are required.\n- The output type for each test case is a boolean.", "solution": "This problem requires implementing a Bayesian classifier to distinguish true Copy-Number Alteration (CNA) segments from artifacts based on sequencing depth and B-Allele Frequency (BAF) data. The decision is based on the posterior log-odds, $\\Lambda$, of a segment being a true CNA ($H=1$) versus an artifact ($H=0$). A segment is classified as a true CNA if and only if $\\Lambda > 0$. The posterior log-odds is the sum of the prior log-odds and the log-likelihood ratio (LLR):\n$$\n\\Lambda = \\log\\frac{P(H=1|\\text{data})}{P(H=0|\\text{data})} = \\log\\frac{P(\\text{data}|H=1)}{P(\\text{data}|H=0)} + \\log\\frac{P(H=1)}{P(H=0)}\n$$\nThe problem defines the data as conditionally independent observations of the log$_2$-ratio deviation, $d$, and the B-allele frequency deviation, $b$. Therefore, the log-likelihood ratio is the sum of the LLRs for each feature: $\\text{LLR}_D + \\text{LLR}_B$.\n\nThe overall computational procedure for each segment is as follows:\n\n1.  **Compute the Prior Log-Odds**: The prior belief in a true CNA is modeled to penalize segments with strong correlation between read depth and GC-content, and segments with low mappability, which are common sources of artifacts. The prior log-odds is given by:\n    $$\n    \\log\\frac{P(H=1)}{P(H=0)} = \\eta_0 - \\eta_r |r| - \\eta_m (1-m)\n    $$\n    where $r$ is the empirical depth-GC correlation, $m$ is the segment's effective mappability, and $\\eta_0$, $\\eta_r$, and $\\eta_m$ are given constants.\n\n2.  **Compute the Log-Likelihood Ratio (LLR)**: This term quantifies the evidence provided by the data.\n    -   The observed log$_2$-ratio, $d$, is modeled as $d \\sim \\mathcal{N}(\\mu_D, \\sigma_D^2)$.\n    -   The observed absolute BAF deviation, $b$, is modeled as $b \\sim \\mathcal{N}(\\mu_B, \\sigma_B^2)$.\n\n    For a generic variable $x$ assumed to be drawn from a Normal distribution $\\mathcal{N}(\\mu, \\sigma^2)$, the log-likelihood ratio comparing hypothesis $H_1$ (mean $\\mu_1$) and $H_0$ (mean $\\mu_0$) with a shared variance $\\sigma^2$ is:\n    $$\n    \\text{LLR} = \\log \\frac{\\phi(x;\\mu_1,\\sigma^2)}{\\phi(x;\\mu_0,\\sigma^2)} = \\frac{1}{2\\sigma^2} \\left[ (x-\\mu_0)^2 - (x-\\mu_1)^2 \\right]\n    $$\n\n    a.  **Log-Ratio LLR ($\\text{LLR}_D$)**:\n        The variance $\\sigma_D^2$ depends on the number of windows $n$, mappability $m$, and baseline deviation $\\sigma_0$:\n        $$\n        \\sigma_D^2 = \\frac{\\sigma_0^2}{n \\cdot m}\n        $$\n        The mean under the true CNA hypothesis ($H_1$) depends on the tumor copy-number $c$ and purity $\\pi$:\n        $$\n        \\mu_{D,1} = \\log_2\\left(\\frac{\\pi c + 2(1-\\pi)}{2}\\right)\n        $$\n        The mean under the artifact hypothesis ($H_0$) is a linear function of the standardized GC content $g$ with coefficient $\\beta_g$:\n        $$\n        \\mu_{D,0} = \\beta_g \\cdot g\n        $$\n        The LLR for the log-ratio is then:\n        $$\n        \\text{LLR}_D = \\frac{1}{2\\sigma_D^2} \\left[ (d-\\mu_{D,0})^2 - (d-\\mu_{D,1})^2 \\right]\n        $$\n\n    b.  **BAF LLR ($\\text{LLR}_B$)**:\n        The variance $\\sigma_B^2$ depends on the number of heterozygous loci $k$:\n        $$\n        \\sigma_B^2 = \\frac{0.25}{k}\n        $$\n        The mean absolute BAF deviation under the true CNA hypothesis ($H_1$) depends on the tumor copy numbers of the major ($c_A$) and minor ($c_B = c - c_A$) alleles, and purity $\\pi$. The expected B-allele fraction in the mixture is:\n        $$\n        \\text{AF}_B = \\frac{\\pi c_B + (1-\\pi) \\cdot 1}{\\pi c + (1-\\pi) \\cdot 2}\n        $$\n        From this, the expected absolute deviation is:\n        $$\n        \\mu_{B,1} = |\\text{AF}_B - 0.5|\n        $$\n        The mean under the artifact hypothesis ($H_0$) is a small constant mapping bias $b_0$:\n        $$\n        \\mu_{B,0} = b_0\n        $$\n        The LLR for the BAF deviation is then:\n        $$\n        \\text{LLR}_B = \\frac{1}{2\\sigma_B^2} \\left[ (b-\\mu_{B,0})^2 - (b-\\mu_{B,1})^2 \\right]\n        $$\n\n3.  **Compute the Posterior Log-Odds and Classify**:\n    All components are summed to get the final posterior log-odds:\n    $$\n    \\Lambda = \\text{LLR}_D + \\text{LLR}_B + \\eta_0 - \\eta_r |r| - \\eta_m (1-m)\n    $$\n    The classification rule is:\n    $$\n    \\text{Decision} = \\begin{cases} \\text{True CNA} & \\text{if } \\Lambda > 0 \\\\ \\text{Artifact} & \\text{if } \\Lambda \\le 0 \\end{cases}\n    $$\nThis full calculation is applied to each test case using the provided parameters and constants. The constants used are $\\sigma_0 = 0.2$, $b_0 = 0.01$, $\\eta_0 = 0.0$, $\\eta_r = 3.0$, and $\\eta_m = 1.5$. The following Python code implements this classifier.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Bayesian classifier to distinguish true CNA events from artifacts in sequencing data.\n    \"\"\"\n\n    # Define the fixed constants from the problem statement.\n    sigma_0 = 0.2\n    b_0 = 0.01\n    eta_0 = 0.0\n    eta_r = 3.0\n    eta_m = 1.5\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (n, d, g, m, pi, c, c_A, k, b, r, beta_g)\n    test_cases = [\n        (200.0, 0.36, 0.1, 0.95, 0.6, 3.0, 2.0, 150.0, 0.11, 0.05, 0.18),\n        (120.0, 0.27, 1.2, 0.98, 0.7, 2.0, 1.0, 100.0, 0.012, 0.85, 0.22),\n        (30.0, -0.12, -0.6, 0.6, 0.5, 2.0, 1.0, 20.0, 0.02, 0.4, 0.22),\n        (180.0, 0.02, 0.0, 0.97, 0.7, 2.0, 2.0, 160.0, 0.33, 0.08, 0.2),\n        (100.0, -0.21, -0.1, 0.9, 0.3, 1.0, 1.0, 80.0, 0.09, 0.1, 0.2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for clarity\n        n, d, g, m, pi, c, c_A, k, b, r, beta_g = case\n\n        # 1. Calculate Log-Likelihood Ratio for log2-ratio (d)\n        \n        # Variances\n        sigma_D_sq = sigma_0**2 / (n * m)\n        \n        # Mean under H1 (true CNA)\n        # Expected total copy number in the mixture\n        expected_copy = pi * c + 2 * (1 - pi)\n        # log2-ratio relative to diploid (2 copies)\n        mu_D1 = np.log2(expected_copy / 2.0)\n        \n        # Mean under H0 (artifact)\n        mu_D0 = beta_g * g\n        \n        # Log-likelihood ratio for d\n        # LLR = log(phi(x; mu1, s^2) / phi(x; mu0, s^2)) = ((x-mu0)^2 - (x-mu1)^2) / (2*s^2)\n        llr_d = ((d - mu_D0)**2 - (d - mu_D1)**2) / (2 * sigma_D_sq)\n\n        # 2. Calculate Log-Likelihood Ratio for BAF deviation (b)\n\n        # Variance\n        sigma_B_sq = 0.25 / k\n        \n        # Mean under H1 (true CNA)\n        c_B = c - c_A # Tumor minor-allele count\n        # Expected B-allele frequency in the mixture\n        af_b_num = pi * c_B + (1 - pi) * 1\n        af_b_den = pi * c + (1 - pi) * 2\n        af_b = af_b_num / af_b_den\n        mu_B1 = abs(af_b - 0.5)\n\n        # Mean under H0 (artifact)\n        mu_B0 = b_0\n\n        # Log-likelihood ratio for b\n        llr_b = ((b - mu_B0)**2 - (b - mu_B1)**2) / (2 * sigma_B_sq)\n\n        # 3. Calculate Prior Log-Odds\n        prior_log_odds = eta_0 - eta_r * abs(r) - eta_m * (1 - m)\n        \n        # 4. Calculate Posterior Log-Odds (Lambda)\n        Lambda = llr_d + llr_b + prior_log_odds\n        \n        # 5. Classify based on Lambda\n        is_true_cna = Lambda > 0\n        results.append(is_true_cna)\n    \n    return results\n\nif __name__ == '__main__':\n    final_results = solve()\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in final_results)}]\")\n\n```", "answer": "[True,False,False,False,True]", "id": "4321978"}]}