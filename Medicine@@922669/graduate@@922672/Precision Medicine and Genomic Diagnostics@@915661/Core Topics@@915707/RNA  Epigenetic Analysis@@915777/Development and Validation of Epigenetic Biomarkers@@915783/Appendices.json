{"hands_on_practices": [{"introduction": "We begin with the fundamental building block of any epigenetic study: the data from a single Cytosine-phosphate-Guanine (CpG) site. This hands-on computational exercise [@problem_id:4332324] demonstrates how to apply a binomial statistical model to not only estimate the methylation proportion, $p$, from sequencing counts but also to quantify the uncertainty in that estimate. By calculating an exact Clopper-Pearson confidence interval, you will learn to make robust, statistically-sound classifications of a site's methylation status, a critical step that moves beyond simple point estimates.", "problem": "You are asked to formalize the post-alignment statistical evaluation module of a bisulfite sequencing pipeline that, in practice, would use the Bismark software to perform read alignment and methylation calling. In the context of cytosine-phosphate-guanine (CpG) methylation biomarker development for precision medicine, assume that for each CpG site, the methylation caller produces non-negative integer counts of methylated reads and unmethylated reads. Under the standard modeling assumption that each read overlapping a CpG site yields an independent Bernoulli outcome (methylated or unmethylated) with an unknown parameter $p$ representing the true methylation proportion at that CpG, the total number of methylated reads $X$ out of $n$ total reads at that site is modeled as a realization of a Binomial random variable with parameters $(n,p)$.\n\nYour task is to write a complete program that, for a fixed set of CpG sites, computes the point estimate of the methylation proportion and an exact two-sided equal-tailed confidence interval (CI) for the methylation proportion using the Clopper–Pearson method at significance level $\\alpha$, then classifies each CpG into one of three categories based on the interval and user-specified thresholds for hypomethylation and hypermethylation. Specifically, the program must:\n\n- For each CpG with methylated count $x$ and unmethylated count $y$, compute the total coverage $n = x + y$.\n- Exclude CpGs with coverage $n$ strictly less than a minimum coverage threshold $n_{\\min}$ by returning a sentinel result as specified below.\n- For CpGs passing coverage filtering, compute the methylation point estimate $\\hat{p} = x / n$.\n- Compute the two-sided exact Clopper–Pearson $(1 - \\alpha)$ confidence interval $\\left[L, U\\right]$ for $p$ by inverting the Binomial model.\n- Classify the CpG using interval-based logic with thresholds $t_{\\text{low}}$ and $t_{\\text{high}}$, where $0 \\le t_{\\text{low}} < t_{\\text{high}} \\le 1$:\n  - If $U < t_{\\text{low}}$, classify as hypomethylated and return the class code $0$.\n  - Else if $L > t_{\\text{high}}$, classify as hypermethylated and return the class code $2$.\n  - Otherwise, classify as ambiguous and return the class code $1$.\n\nFor CpGs that do not meet minimum coverage, return the sentinel list $[-1.0, -1.0, -1.0, -1]$.\n\nEvery floating-point output must be rounded to six decimal places. All methylation proportions, confidence interval bounds, and thresholds must be expressed as decimals in $[0,1]$ (not as percentages).\n\nUse the following fixed parameters for all test cases:\n- Significance level $\\alpha = 0.05$ for a $(1 - \\alpha) = 0.95$ confidence interval.\n- Minimum coverage $n_{\\min} = 5$.\n- Thresholds $t_{\\text{low}} = 0.30$ and $t_{\\text{high}} = 0.70$.\n\nTest suite to implement and evaluate:\n- Case $1$: $(x, y) = (12, 8)$, so $n = 20$.\n- Case $2$: $(x, y) = (0, 20)$, so $n = 20$.\n- Case $3$: $(x, y) = (20, 0)$, so $n = 20$.\n- Case $4$: $(x, y) = (1, 2)$, so $n = 3$.\n- Case $5$: $(x, y) = (3, 7)$, so $n = 10$.\n- Case $6$: $(x, y) = (15, 15)$, so $n = 30$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no embedded spaces. Each test case result must be a list of four values in the form $[\\hat{p}, L, U, c]$, where $\\hat{p}$ is the methylation proportion estimate, $L$ and $U$ are the lower and upper Clopper–Pearson bounds, and $c$ is the classification code as defined above. The final output must be formatted exactly as:\n\"[[p1,L1,U1,c1],[p2,L2,U2,c2],[p3,L3,U3,c3],[p4,L4,U4,c4],[p5,L5,U5,c5],[p6,L6,U6,c6]]\"\nwith all floating-point numbers rounded to six decimal places and no spaces anywhere in the string.", "solution": "The problem requires the formalization and implementation of a statistical evaluation module for bisulfite sequencing data, a common task in epigenetic research. We will proceed by first validating the problem's scientific and mathematical soundness, and then constructing a solution based on established statistical principles.\n\n### Problem Formulation and Model\n\nThe problem is centered on the analysis of DNA methylation at specific CpG sites. For each site, the data consists of the number of methylated reads, $x$, and unmethylated reads, $y$, obtained from bisulfite sequencing.\n\nThe total number of reads covering the site, or coverage, is $n = x+y$. We model each read as an independent Bernoulli trial, where the outcome is \"methylated\" with a constant, unknown probability $p$, representing the true methylation proportion at that CpG site. Under this model, the total number of methylated reads, $X$, for a given coverage $n$, is a random variable following a binomial distribution:\n$$ X \\sim \\text{Binomial}(n, p) $$\nwhere the probability mass function is given by:\n$$ P(X=k | n, p) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n\nThe task is to perform the following steps for a series of CpG sites defined by $(x,y)$ counts:\n1.  Apply a minimum coverage filter.\n2.  Compute a point estimate for the methylation proportion, $p$.\n3.  Compute a two-sided confidence interval for $p$.\n4.  Classify the CpG site's methylation status based on the confidence interval.\n\n### Step-by-Step Solution Derivations\n\n#### 1. Coverage Filtering\nA minimum coverage is necessary for reliable statistical inference. The problem specifies a minimum coverage threshold $n_{\\min}$. Any CpG site with coverage $n = x+y < n_{\\min}$ is excluded from further analysis. For such sites, a sentinel result of $[-1.0, -1.0, -1.0, -1]$ is returned. The provided value is $n_{\\min}=5$.\n\n#### 2. Point Estimation\nFor CpG sites that pass the coverage filter ($n \\ge n_{\\min}$), we estimate the true methylation proportion $p$. The maximum likelihood estimate (MLE) for the binomial proportion parameter $p$ is the sample proportion:\n$$ \\hat{p} = \\frac{x}{n} $$\nThis serves as our point estimate for the methylation level.\n\n#### 3. Clopper-Pearson Confidence Interval\nA point estimate $\\hat{p}$ provides a single value but no information about its uncertainty. A confidence interval (CI) provides a range of plausible values for the true parameter $p$. The problem specifies the Clopper-Pearson method, which produces an \"exact\" interval by inverting the binomial test.\n\nFor a $(1-\\alpha)$ confidence level, the two-sided equal-tailed Clopper-Pearson interval $[L, U]$ is constructed such that the lower bound $L$ and upper bound $U$ satisfy the following equations:\n$$ P(X \\ge x | n, L) = \\sum_{k=x}^{n} \\binom{n}{k} L^k (1-L)^{n-k} = \\frac{\\alpha}{2} $$\n$$ P(X \\le x | n, U) = \\sum_{k=0}^{x} \\binom{n}{k} U^k (1-U)^{n-k} = \\frac{\\alpha}{2} $$\nThese equations define $L$ as the largest proportion for which observing $x$ or more methylated reads is not surprisingly rare (not less than $\\alpha/2$), and $U$ as the smallest proportion for which observing $x$ or fewer methylated reads is not surprisingly rare.\n\nThese equations are solved for $L$ and $U$. The cumulative distribution function (CDF) of the binomial distribution is related to the regularized incomplete beta function $I_z(a,b)$ as follows:\n$$ \\sum_{k=x}^{n} \\binom{n}{k} p^k (1-p)^{n-k} = I_p(x, n-x+1) $$\n$$ \\sum_{k=0}^{x} \\binom{n}{k} p^k (1-p)^{n-k} = 1 - I_p(x+1, n-x) $$\nSubstituting these into the defining equations for the CI bounds yields:\n$$ I_L(x, n-x+1) = \\frac{\\alpha}{2} $$\n$$ 1 - I_U(x+1, n-x) = \\frac{\\alpha}{2} \\implies I_U(x+1, n-x) = 1 - \\frac{\\alpha}{2} $$\nSolving for $L$ and $U$ requires finding the inverse of the regularized incomplete beta function, which is the quantile function (or percent point function, PPF) of the Beta distribution.\nThus, $L$ is the $\\alpha/2$ quantile of a Beta distribution with shape parameters $(x, n-x+1)$, and $U$ is the $(1-\\alpha/2)$ quantile of a Beta distribution with shape parameters $(x+1, n-x)$.\n\nThe bounds are given by:\n$$ L = \\text{Beta.PPF}\\left(\\frac{\\alpha}{2}; x, n-x+1\\right) $$\n$$ U = \\text{Beta.PPF}\\left(1-\\frac{\\alpha}{2}; x+1, n-x\\right) $$\n\nSpecial edge cases must be handled:\n-   If $x=0$, the lower bound is $L=0$.\n-   If $x=n$, the upper bound is $U=1$.\n\nThe problem specifies $\\alpha=0.05$, so we compute a $95\\%$ confidence interval using $\\alpha/2=0.025$ and $1-\\alpha/2=0.975$.\n\n#### 4. Interval-Based Classification\nThe final step is to classify each CpG site into one of three categories: hypomethylated, ambiguous, or hypermethylated. This classification is not based on the point estimate $\\hat{p}$, but on the confidence interval $[L, U]$, which incorporates statistical uncertainty. This is a more conservative and robust approach.\n\nGiven thresholds $t_{\\text{low}}$ and $t_{\\text{high}}$ (with $0 \\le t_{\\text{low}} < t_{\\text{high}} \\le 1$), the classification rules are:\n-   **Hypomethylated (Code $0$)**: If we are confident that the true proportion $p$ is below $t_{\\text{low}}$. This occurs when the entire confidence interval lies below the threshold: $U < t_{\\text{low}}$.\n-   **Hypermethylated (Code $2$)**: If we are confident that the true proportion $p$ is above $t_{\\text{high}}$. This occurs when the entire confidence interval lies above the threshold: $L > t_{\\text{high}}$.\n-   **Ambiguous (Code $1$)**: In all other cases. This includes intervals that span one or both thresholds, indicating that the data are insufficient to make a high-confidence call of hypo- or hyper-methylation.\n\nThe problem specifies $t_{\\text{low}}=0.30$ and $t_{\\text{high}}=0.70$.\n\nThis systematic procedure combines point estimation with rigorous uncertainty quantification to produce a robust classification, which is a critical component in the development of reliable epigenetic biomarkers. The implementation will follow these derived steps.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Computes methylation statistics and classifies CpG sites based on bisulfite sequencing read counts.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    alpha = 0.05\n    n_min = 5\n    t_low = 0.30\n    t_high = 0.70\n\n    # --- Test Suite ---\n    test_cases = [\n        (12, 8),   # Case 1\n        (0, 20),   # Case 2\n        (20, 0),   # Case 3\n        (1, 2),    # Case 4\n        (3, 7),    # Case 5\n        (15, 15),  # Case 6\n    ]\n\n    results = []\n    for x, y in test_cases:\n        n = x + y\n\n        # Step 1: Coverage Filtering\n        if n < n_min:\n            results.append([-1.0, -1.0, -1.0, -1])\n            continue\n\n        # Step 2: Point Estimate\n        p_hat = x / n\n\n        # Step 3: Clopper-Pearson Confidence Interval\n        alpha_half = alpha / 2.0\n\n        # Handle edge cases for L and U bounds\n        if x == 0:\n            lower_bound = 0.0\n        else:\n            lower_bound = beta.ppf(alpha_half, x, n - x + 1)\n\n        if x == n:\n            upper_bound = 1.0\n        else:\n            upper_bound = beta.ppf(1 - alpha_half, x + 1, n - x)\n        \n        # Step 4: Interval-Based Classification\n        if upper_bound < t_low:\n            classification_code = 0  # Hypomethylated\n        elif lower_bound > t_high:\n            classification_code = 2  # Hypermethylated\n        else:\n            classification_code = 1  # Ambiguous\n            \n        results.append([p_hat, lower_bound, upper_bound, classification_code])\n\n    # --- Format final output string ---\n    results_str_list = []\n    for res in results:\n        if res == [-1.0, -1.0, -1.0, -1]:\n            # Handle sentinel case formatting as specified\n            results_str_list.append(\"[-1.0,-1.0,-1.0,-1]\")\n        else:\n            p_hat, l_bound, u_bound, code = res\n            # Round floats to six decimal places for all other cases\n            p_str = f\"{p_hat:.6f}\"\n            l_str = f\"{l_bound:.6f}\"\n            u_str = f\"{u_bound:.6f}\"\n            c_str = str(code)\n            results_str_list.append(f\"[{p_str},{l_str},{u_str},{c_str}]\")\n\n    # Combine all results into a single line string\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "4332324"}, {"introduction": "Moving from a single site to an epigenome-wide association study (EWAS) introduces a major statistical hurdle: the problem of multiple comparisons. When you test millions of hypotheses, many will appear significant by chance alone, yielding numerous false positives even if the individual $p$-values are low. This practice [@problem_id:4332313] walks you through the application of the Benjamini-Hochberg procedure, a powerful technique to control the False Discovery Rate (FDR) and identify a reliable set of candidate biomarkers.", "problem": "In developing a blood-based epigenetic biomarker panel for a complex disease, you measure differential DNA methylation at a set of cytosine-phosphate-guanine (CpG) dinucleotides across cases and controls. For each CpG site, you estimate the effect size as the difference in methylation fraction between cases and controls and compute a two-sided hypothesis test for no difference, yielding a valid p-value under the null. Assume the independence (or positive dependence) conditions under which the Benjamini–Hochberg (BH) procedure controls the False Discovery Rate (FDR). False Discovery Rate (FDR) is defined as the expected proportion of false discoveries among all declared discoveries.\n\nYou obtain the following CpG-wise results (effect sizes are not needed for the multiple testing calculation but are shown for completeness): CpG-A: effect size $+0.12$, $p$-value $0.0205$; CpG-B: effect size $-0.07$, $p$-value $0.043$; CpG-C: effect size $+0.04$, $p$-value $0.0317$; CpG-D: effect size $-0.15$, $p$-value $0.00082$; CpG-E: effect size $+0.03$, $p$-value $0.081$; CpG-F: effect size $-0.10$, $p$-value $0.0127$; CpG-G: effect size $+0.05$, $p$-value $0.0047$; CpG-H: effect size $-0.11$, $p$-value $0.00031$; CpG-I: effect size $+0.02$, $p$-value $0.150$; CpG-J: effect size $-0.06$, $p$-value $0.0068$; CpG-K: effect size $+0.09$, $p$-value $0.00095$; CpG-L: effect size $-0.08$, $p$-value $0.0021$.\n\nUsing the Benjamini–Hochberg control of the False Discovery Rate at target level $q=0.05$, compute the BH decision threshold, defined as the largest $p$-value $t$ such that all $p$-values less than or equal to $t$ are called significant under FDR level $q$. Report $t$ as a plain number. Round your answer to four significant figures.", "solution": "The goal is to determine, under the Benjamini–Hochberg (BH) procedure at target False Discovery Rate (FDR) level $q=0.05$, the largest $p$-value threshold $t$ such that declaring all tests with $p \\leq t$ as significant controls the FDR at the specified level.\n\nFoundationally, the False Discovery Rate (FDR) is the expected value of the ratio of false discoveries to total discoveries. The BH procedure is a well-tested method that controls the FDR at level $q$ when the null $p$-values are independent (or satisfy certain positive dependence conditions). The BH construction works by ranking the $m$ observed $p$-values in ascending order, $p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(m)}$, and identifying the largest index $k$ such that $p_{(k)} \\leq \\frac{k}{m} q$. Then the decision threshold is $t = p_{(k)}$, and the discoveries are all tests with $p \\leq t$.\n\nWe have $m=12$ tests. Extract the $p$-values (ignoring effect sizes for the multiplicity adjustment): $0.0205, 0.043, 0.0317, 0.00082, 0.081, 0.0127, 0.0047, 0.00031, 0.150, 0.0068, 0.00095, 0.0021$.\n\nSort them in ascending order:\n- $p_{(1)}=0.00031$\n- $p_{(2)}=0.00082$\n- $p_{(3)}=0.00095$\n- $p_{(4)}=0.0021$\n- $p_{(5)}=0.0047$\n- $p_{(6)}=0.0068$\n- $p_{(7)}=0.0127$\n- $p_{(8)}=0.0205$\n- $p_{(9)}=0.0317$\n- $p_{(10)}=0.043$\n- $p_{(11)}=0.081$\n- $p_{(12)}=0.150$.\n\nCompute the BH critical values $\\frac{k}{m}q = \\frac{k}{12}\\cdot 0.05$ for $k=1,\\dots,12$ and compare:\n- $k=1$: $\\frac{1}{12}\\cdot 0.05 \\approx 0.004166\\overline{6}$, and $0.00031 \\leq 0.004166\\overline{6}$, satisfied.\n- $k=2$: $\\frac{2}{12}\\cdot 0.05 \\approx 0.008333\\overline{3}$, and $0.00082 \\leq 0.008333\\overline{3}$, satisfied.\n- $k=3$: $\\frac{3}{12}\\cdot 0.05 = 0.0125$, and $0.00095 \\leq 0.0125$, satisfied.\n- $k=4$: $\\frac{4}{12}\\cdot 0.05 \\approx 0.016666\\overline{6}$, and $0.0021 \\leq 0.016666\\overline{6}$, satisfied.\n- $k=5$: $\\frac{5}{12}\\cdot 0.05 \\approx 0.020833\\overline{3}$, and $0.0047 \\leq 0.020833\\overline{3}$, satisfied.\n- $k=6$: $\\frac{6}{12}\\cdot 0.05 = 0.025$, and $0.0068 \\leq 0.025$, satisfied.\n- $k=7$: $\\frac{7}{12}\\cdot 0.05 \\approx 0.029166\\overline{6}$, and $0.0127 \\leq 0.029166\\overline{6}$, satisfied.\n- $k=8$: $\\frac{8}{12}\\cdot 0.05 \\approx 0.033333\\overline{3}$, and $0.0205 \\leq 0.033333\\overline{3}$, satisfied.\n- $k=9$: $\\frac{9}{12}\\cdot 0.05 = 0.0375$, and $0.0317 \\leq 0.0375$, satisfied.\n- $k=10$: $\\frac{10}{12}\\cdot 0.05 \\approx 0.041666\\overline{6}$, and $0.043 \\nleq 0.041666\\overline{6}$, not satisfied.\n- $k=11$: $\\frac{11}{12}\\cdot 0.05 \\approx 0.045833\\overline{3}$, and $0.081 \\nleq 0.045833\\overline{3}$, not satisfied.\n- $k=12$: $\\frac{12}{12}\\cdot 0.05 = 0.05$, and $0.150 \\nleq 0.05$, not satisfied.\n\nThe largest $k$ satisfying $p_{(k)} \\leq \\frac{k}{12}\\cdot 0.05$ is $k=9$. Therefore, the BH decision threshold is\n$$\nt = p_{(9)} = 0.0317\n$$\nRounding to four significant figures gives $0.03170$.", "answer": "$$\\boxed{0.03170}$$", "id": "4332313"}, {"introduction": "After identifying statistically significant CpG sites, the final and perhaps most critical challenge is correct interpretation. An observed association between methylation and disease could be a true epigenetic signal, or it could be an artifact of underlying genetic variation, a phenomenon known as confounding. This practice [@problem_id:4332306] explores the crucial concept of methylation Quantitative Trait Loci (meQTLs), demonstrating how a genetic variant can directly influence methylation levels and create a spurious association with a disease outcome. Learning to recognize and account for this type of confounding is paramount to developing valid biomarkers.", "problem": "In precision medicine and genomic diagnostics, methylation quantitative trait loci are central to interpreting disease-associated epigenetic variation. Consider the following foundations and scenario.\n\nFoundations:\n- A Cytosine-phosphate-Guanine (CpG) dinucleotide is the primary genomic context for five-methylcytosine (5mC). By chemical definition, methylation at the $5$ position of cytosine requires that a cytosine base be present in a CpG dyad. If a Single Nucleotide Polymorphism (SNP) converts the cytosine to thymine ($\\mathrm{C}\\rightarrow\\mathrm{T}$) or the guanine partner to adenine ($\\mathrm{G}\\rightarrow\\mathrm{A}$), the CpG site is abolished and cannot carry 5mC on the mutated strand.\n- Sodium bisulfite conversion deaminates unmethylated cytosines to uracil, which are read as thymine by polymerases and sequencing, whereas methylated cytosines are protected. Therefore, after conversion and sequencing or array hybridization, a thymine signal can reflect either an originally unmethylated cytosine or a true thymine introduced by a SNP; the assay by itself cannot distinguish these sources without additional sequence context.\n- A quantitative trait locus is a genomic locus where genetic variation explains variance in a quantitative phenotype. A methylation quantitative trait locus (meQTL) refers to the case where the quantitative trait is the DNA methylation level at one or more CpG sites.\n\nScenario:\nYou perform a case-control epigenome-wide association study (EWAS) of a CpG site $C^{\\ast}$ proximal to a disease gene. A nearby variant $V$ is a CpG-disrupting SNP such that the alternate allele abolishes the cytosine in $C^{\\ast}$ when present. Let $G\\in\\{0,1,2\\}$ denote the genotype coded as the number of CpG-disrupting alleles at $V$. Assume the per-allele baseline methylation probability at an intact CpG is $m_{0}$ with $0<m_{0}<1$, and assume that an abolished CpG allele contributes zero methylation because the substrate cytosine is absent. Further assume random mating and no epigenetic effect of disease on $C^{\\ast}$.\n\nYou observe that cases are enriched for the CpG-disrupting allele because a disease-associated SNP $D$ is in nonzero linkage disequilibrium with $V$. Specifically, the genotype distributions at $V$ are:\n- Among cases: $\\Pr(G=0)=0.25$, $\\Pr(G=1)=0.50$, $\\Pr(G=2)=0.25$.\n- Among controls: $\\Pr(G=0)=0.49$, $\\Pr(G=1)=0.42$, $\\Pr(G=2)=0.09$.\nTake $m_{0}=0.70$ for concreteness.\n\nQuestion:\nWhich of the following statements correctly define methylation quantitative trait loci and accurately explain how SNPs can cause methylation differences that mimic disease associations at CpG-disrupting variants, as well as appropriate analytic strategies to distinguish and mitigate such effects? Select all that apply.\n\nA. A methylation quantitative trait locus is a locus where genetic variation associates with quantitative DNA methylation levels at one or more CpG sites in cis or trans; a CpG-disrupting SNP ($\\mathrm{C}\\rightarrow\\mathrm{T}$ or $\\mathrm{G}\\rightarrow\\mathrm{A}$) removes the methyl-acceptor cytosine on the affected allele, forcing allele-specific hypomethylation. If disease status is associated with the disrupting allele via linkage disequilibrium, a case-control methylation difference can arise without any causal epigenetic effect. Filtering probes that overlap the SNP, adjusting for genotype at $V$ in regression, and leveraging allele-specific methylation in heterozygotes are principled ways to mitigate or diagnose this confounding.\n\nB. A methylation quantitative trait locus is defined by association between DNA methylation and gene expression. CpG-disrupting variants cannot influence measured methylation after sodium bisulfite conversion because all cytosines are read as thymines if unmethylated, so genotypes do not confound methylation measurement. Therefore, controlling for genotype is unnecessary when testing disease effects.\n\nC. A methylation quantitative trait locus requires that disease directly changes methylation at the locus; CpG-disrupting variants affect only probe hybridization but not the underlying DNA methylation biology, so filtering variants with minor allele frequency below $0.05$ is sufficient to eliminate spurious associations regardless of linkage disequilibrium with disease variants.\n\nD. A methylation quantitative trait locus is an association between genotype and methylation but only in promoter regions; CpG-disrupting variants increase measured methylation by blocking sodium bisulfite conversion, and thus will artifactually inflate methylation in carriers. Adjusting only for estimated cell-type composition removes this bias.\n\nE. In the scenario above, even with no true disease effect on methylation, the difference in genotype distributions induces an expected lower methylation among cases purely due to the loss of intact CpG alleles. A linear model of methylation on disease and $G$ removes this bias because the expectation of methylation is a linear function of the number of intact alleles under the stated assumptions. Analysis of allele-specific methylation using phased reads that span both $V$ and $C^{\\ast}$ can empirically show methylation on the intact allele and absence on the disrupted allele, distinguishing sequence-driven from epigenetic disease effects.", "solution": "The problem statement has been validated and found to be scientifically sound, well-posed, and objective. It presents a realistic scenario in the field of statistical genomics and epigenetics. We can now proceed with the solution.\n\nThe core of this problem is a classic case of confounding in an epigenome-wide association study (EWAS). We are told there is no direct causal effect of the disease on methylation at CpG site $C^{\\ast}$. However, a genetic variant $V$ disrupts the CpG site, and this variant is in linkage disequilibrium (LD) with a true disease-associated variant $D$. This leads to different genotype distributions for $V$ in cases versus controls, which in turn creates a spurious association between disease status and methylation at $C^{\\ast}$.\n\nLet $M$ be the measured methylation level, which can range from $0$ to $1$. The genotype $G \\in \\{0, 1, 2\\}$ represents the number of CpG-disrupting alleles an individual carries. The problem states that the methylation probability on an intact allele is $m_0 = 0.70$, and an abolished allele contributes zero methylation. The total methylation level is the average of the two alleles.\n\nThe expected methylation level conditional on genotype $G$ is:\n- For $G=0$ (two intact alleles): $$E[M|G=0] = \\frac{m_0 + m_0}{2} = m_0$$\n- For $G=1$ (one intact, one abolished allele): $$E[M|G=1] = \\frac{m_0 + 0}{2} = \\frac{m_0}{2}$$\n- For $G=2$ (two abolished alleles): $$E[M|G=2] = \\frac{0 + 0}{2} = 0$$\n\nWe can now calculate the expected methylation in the case and control groups using the law of total expectation and the given genotype frequencies.\n\nExpected methylation in cases:\n$$E[M|\\text{Case}] = \\sum_{g=0}^{2} E[M|G=g] \\cdot \\Pr(G=g|\\text{Case})$$\n$$E[M|\\text{Case}] = (m_0 \\cdot \\Pr(G=0|\\text{Case})) + (\\frac{m_0}{2} \\cdot \\Pr(G=1|\\text{Case})) + (0 \\cdot \\Pr(G=2|\\text{Case}))$$\nUsing the provided probabilities for cases ($\\Pr(G=0)=0.25$, $\\Pr(G=1)=0.50$, $\\Pr(G=2)=0.25$) and $m_0 = 0.70$:\n$$E[M|\\text{Case}] = (0.70 \\cdot 0.25) + (\\frac{0.70}{2} \\cdot 0.50) + (0 \\cdot 0.25)$$\n$$E[M|\\text{Case}] = (0.175) + (0.35 \\cdot 0.50) + 0 = 0.175 + 0.175 = 0.35$$\n\nExpected methylation in controls:\n$$E[M|\\text{Control}] = \\sum_{g=0}^{2} E[M|G=g] \\cdot \\Pr(G=g|\\text{Control})$$\nUsing the provided probabilities for controls ($\\Pr(G=0)=0.49$, $\\Pr(G=1)=0.42$, $\\Pr(G=2)=0.09$) and $m_0 = 0.70$:\n$$E[M|\\text{Control}] = (0.70 \\cdot 0.49) + (\\frac{0.70}{2} \\cdot 0.42) + (0 \\cdot 0.09)$$\n$$E[M|\\text{Control}] = (0.343) + (0.35 \\cdot 0.42) + 0 = 0.343 + 0.147 = 0.49$$\n\nOur calculation shows that the expected methylation in cases ($0.35$) is substantially lower than in controls ($0.49$). This apparent \"hypomethylation\" in cases is not due to an epigenetic effect of the disease but is entirely a consequence of the higher frequency of the CpG-disrupting allele in the case group. This confirms the confounding scenario described. We will now evaluate each option.\n\n***\n\n**A. A methylation quantitative trait locus is a locus where genetic variation associates with quantitative DNA methylation levels at one or more CpG sites in cis or trans; a CpG-disrupting SNP ($\\mathrm{C}\\rightarrow\\mathrm{T}$ or $\\mathrm{G}\\rightarrow\\mathrm{A}$) removes the methyl-acceptor cytosine on the affected allele, forcing allele-specific hypomethylation. If disease status is associated with the disrupting allele via linkage disequilibrium, a case-control methylation difference can arise without any causal epigenetic effect. Filtering probes that overlap the SNP, adjusting for genotype at $V$ in regression, and leveraging allele-specific methylation in heterozygotes are principled ways to mitigate or diagnose this confounding.**\n\n- **Analysis:** This statement consists of four parts, all of which are correct.\n  1. The definition of a methylation quantitative trait locus (meQTL) is accurate: it describes an association between genetic variation (genotype) and methylation levels. This can be local (`cis`) or distant (`trans`).\n  2. The mechanism of a CpG-disrupting SNP is described correctly. By removing the cytosine (or the adjacent guanine), the substrate for methylation is eliminated on that allele, leading to a forced methylation level of $0$ on that specific DNA strand (allele-specific hypomethylation).\n  3. The explanation for the spurious association is precisely the confounding scenario detailed in the problem and our derivation above. The LD between the meQTL variant ($V$) and the disease variant ($D$) creates an association between disease and methylation that is not causal.\n  4. The proposed mitigation and diagnostic strategies are all standard best practices in the field. Filtering probes that overlap known SNPs is a crucial quality control step in EWAS. Adjusting for the genotype of the confounding SNP in a regression model is the standard statistical approach to remove the confounding. Analyzing allele-specific methylation in heterozygotes is a powerful method to experimentally confirm that the methylation difference is driven by the genetic sequence itself.\n- **Verdict:** Correct.\n\n***\n\n**B. A methylation quantitative trait locus is defined by association between DNA methylation and gene expression. CpG-disrupting variants cannot influence measured methylation after sodium bisulfite conversion because all cytosines are read as thymines if unmethylated, so genotypes do not confound methylation measurement. Therefore, controlling for genotype is unnecessary when testing disease effects.**\n\n- **Analysis:** This statement is incorrect on multiple fundamental points.\n  1. The definition provided is for an expression quantitative trait methylation (eQTM), not an meQTL. An meQTL links genotype to methylation.\n  2. The claim that CpG-disrupting variants \"cannot influence measured methylation\" is false. If a SNP changes a cytosine to a thymine ($\\mathrm{C}\\rightarrow\\mathrm{T}$), that position in the genome now contains a true thymine. In a bisulfite sequencing experiment, this will be read as a 'T', just like an unmethylated cytosine that was converted to uracil and then read as 'T'. This means the SNP directly causes the measured methylation at that allele to be $0$, profoundly influencing the measurement. The assertion that genotypes do not confound methylation measurement is the opposite of the truth.\n  3. Consequently, the conclusion that controlling for genotype is unnecessary is dangerously wrong.\n- **Verdict:** Incorrect.\n\n***\n\n**C. A methylation quantitative trait locus requires that disease directly changes methylation at the locus; CpG-disrupting variants affect only probe hybridization but not the underlying DNA methylation biology, so filtering variants with minor allele frequency below $0.05$ is sufficient to eliminate spurious associations regardless of linkage disequilibrium with disease variants.**\n\n- **Analysis:** This statement is incorrect.\n  1. The definition is wrong. An meQTL is defined by a genotype-methylation association, independent of disease. A disease-methylation association is studied in an EWAS.\n  2. The claim that CpG-disrupting variants affect \"only probe hybridization but not the underlying DNA methylation biology\" is false. While they can affect hybridization on microarrays, their primary effect is biological: they remove the cytosine that is the substrate for the DNA methyltransferase enzymes. This is a fundamental change to the biology of methylation at that site.\n  3. The proposed solution is inadequate. Filtering based on a fixed minor allele frequency (MAF) threshold like $0.05$ is not a targeted or effective way to handle this type of confounding. The confounding SNP in the scenario is common in both cases ($p=0.50$) and controls ($p=0.30$), so it would not be filtered out. Confounding can occur with SNPs of any frequency.\n- **Verdict:** Incorrect.\n\n***\n\n**D. A methylation quantitative trait locus is an association between genotype and methylation but only in promoter regions; CpG-disrupting variants increase measured methylation by blocking sodium bisulfite conversion, and thus will artifactually inflate methylation in carriers. Adjusting only for estimated cell-type composition removes this bias.**\n\n- **Analysis:** This statement is incorrect.\n  1. The definition of meQTL is incorrectly restricted to \"only in promoter regions\". meQTLs are found throughout the genome.\n  2. The described effect is the opposite of what occurs. A CpG-disrupting variant leads to a thymine being present at the cytosine position (either directly through a $\\mathrm{C}\\rightarrow\\mathrm{T}$ SNP, or effectively by making the site non-CpG for a $\\mathrm{G}\\rightarrow\\mathrm{A}$ SNP). This T is interpreted as an unmethylated signal, thus *decreasing* the measured methylation level (beta value), not increasing it.\n  3. The proposed solution is irrelevant to the problem. Adjusting for cell-type composition is a critical step in EWAS to correct for confounding by cell-type heterogeneity, but it is a separate issue from confounding by genotype at the CpG site itself. It will not remove the genetic bias described.\n- **Verdict:** Incorrect.\n\n***\n\n**E. In the scenario above, even with no true disease effect on methylation, the difference in genotype distributions induces an expected lower methylation among cases purely due to the loss of intact CpG alleles. A linear model of methylation on disease and $G$ removes this bias because the expectation of methylation is a linear function of the number of intact alleles under the stated assumptions. Analysis of allele-specific methylation using phased reads that span both $V$ and $C^{\\ast}$ can empirically show methylation on the intact allele and absence on the disrupted allele, distinguishing sequence-driven from epigenetic disease effects.**\n\n- **Analysis:** This statement is entirely correct and provides a precise quantitative and methodological summary.\n  1. The first sentence correctly identifies the outcome of the confounding: \"expected lower methylation among cases\", which our initial calculation confirmed ($0.35$ vs. $0.49$).\n  2. The second sentence correctly justifies the use of a linear model. The expected methylation, $E[M|G] = m_0 - (m_0/2)G$, is a linear function of the genotype dosage $G$. Therefore, including $G$ as a covariate in a regression model `Methylation ~ Disease + G` is a statistically valid method to adjust for the confounding effect of the genotype.\n  3. The third sentence describes a sophisticated and powerful experimental approach for validation. Allele-specific analysis, by separating reads from the reference (intact) and alternate (disrupted) alleles, provides direct empirical evidence for the genetic mechanism. This is a definitive way to distinguish this type of artifact from a true regulatory epigenetic change associated with disease.\n- **Verdict:** Correct.", "answer": "$$\\boxed{AE}$$", "id": "4332306"}]}