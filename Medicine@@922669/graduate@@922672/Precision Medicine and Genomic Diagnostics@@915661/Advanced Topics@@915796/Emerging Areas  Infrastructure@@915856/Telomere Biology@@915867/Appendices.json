{"hands_on_practices": [{"introduction": "This first practice introduces a fundamental concept in telomere biology: telomeres as a mitotic clock that determines the replicative lifespan of a cell. By applying a straightforward linear model, you will calculate the replicative capacity of a somatic cell population based on its initial telomere length, a critical minimum length, and the rate of shortening per division. This exercise ([@problem_id:4389203]) grounds your understanding in the basic quantitative principles that govern cellular aging.", "problem": "A clinical genomics laboratory seeks to estimate the replicative capacity of a somatic cell population as part of a precision medicine workup to stratify risk for bone marrow failure. Consider the following biologically grounded model of telomere dynamics:\n\n- Due to the chromosome end-replication problem and oxidative damage, telomere length shortens by a fixed amount per mitotic division. Let the per-division length decrement be modeled as the sum of an intrinsic replication loss and an oxidative component, so that the per-division loss is $\\Delta L = \\delta + \\alpha r$, where $\\delta$ is the intrinsic end-replication loss (in base pairs per division), $\\alpha$ is the oxidative susceptibility coefficient (in base pairs per division per unit of oxidative burden), and $r$ is a dimensionless index of reactive oxygen species (ROS) burden.\n- A cell remains proliferatively competent as long as its telomere length $L(n)$ after $n$ divisions remains above a viability threshold $L_{\\text{min}}$. Senescence is triggered when $L(n) = L_{\\text{min}}$.\n- Assume a linear shortening model without telomerase activity or lengthening events: $L(n+1) = L(n) - \\Delta L$ with $L(0) = L_0$.\n\nThe laboratory has measured the following parameters for this patient’s cells:\n- Baseline telomere length: $L_0 = 9.8$ kilobases.\n- Minimum viable length: $L_{\\text{min}} = 3.5$ kilobases.\n- Intrinsic end-replication loss: $\\delta = 50$ base pairs per division.\n- Oxidative susceptibility: $\\alpha = 8$ base pairs per division per ROS unit.\n- ROS burden (dimensionless): $r = 2.5$.\n\nUsing only the principles stated above, derive an expression for the maximum number of additional mitotic divisions the average cell can undergo before reaching $L_{\\text{min}}$ under this model, and then compute its value using the given parameters. Treat the number of divisions as a real-valued quantity (do not round down to an integer in the derivation). Ensure unit consistency by converting all telomere lengths to base pairs before computing. Express your final answer as a dimensionless number rounded to four significant figures. Do not include units in your final answer.", "solution": "The fundamental biological basis is that, in the absence of telomerase, DNA polymerase cannot fully replicate the lagging strand ends, leading to progressive telomere shortening each cell division. Additional oxidative stress increases the damage per division. We adopt a linear, deterministic model:\n$$\nL(n+1) = L(n) - \\Delta L, \\quad \\text{with} \\quad \\Delta L = \\delta + \\alpha r, \\quad L(0) = L_0.\n$$\nThis recurrence solves to a linear trajectory:\n$$\nL(n) = L_0 - n \\Delta L.\n$$\nReplicative senescence occurs when the telomere length reaches the critical threshold:\n$$\nL(n^\\ast) = L_{\\min}.\n$$\nSolving for the division count $n^\\ast$ that achieves this threshold yields:\n$$\nL_0 - n^\\ast \\Delta L = L_{\\min} \\quad \\Rightarrow \\quad n^\\ast = \\frac{L_0 - L_{\\min}}{\\Delta L}.\n$$\nUnder the stated assumptions, the replicative capacity (as a real-valued estimate of the maximum number of additional divisions) is therefore\n$$\nN = \\frac{L_0 - L_{\\min}}{\\delta + \\alpha r}.\n$$\n\nNext, ensure unit consistency. Convert kilobases to base pairs. One kilobase equals $10^{3}$ base pairs. Thus,\n$$\nL_0 = 9.8 \\times 10^{3} \\ \\text{bp}, \\quad L_{\\min} = 3.5 \\times 10^{3} \\ \\text{bp}.\n$$\nCompute the per-division loss:\n$$\n\\Delta L = \\delta + \\alpha r = 50 + 8 \\times 2.5 = 50 + 20 = 70 \\ \\text{bp/division}.\n$$\nCompute the numerator:\n$$\nL_0 - L_{\\min} = 9.8 \\times 10^{3} - 3.5 \\times 10^{3} = 6.3 \\times 10^{3} \\ \\text{bp} = 6300 \\ \\text{bp}.\n$$\nTherefore,\n$$\nN = \\frac{6300}{70} = 90.\n$$\nThe model’s real-valued estimate is exactly $90.000\\ldots$. Expressed to four significant figures as requested, one appropriate representation in scientific notation is\n$$\n9.000 \\times 10^{1}.\n$$\nThis is dimensionless, consistent with the requirement to omit units in the final answer.", "answer": "$$\\boxed{9.000 \\times 10^{1}}$$", "id": "4389203"}, {"introduction": "Real biological processes are rarely deterministic. Building upon the linear model, this next practice introduces stochasticity to better reflect the inherent variability in telomere shortening. You will model the per-division length change as a random variable following a Normal distribution, allowing you to predict the entire distribution of telomere lengths after a certain number of cell divisions ([@problem_id:4389190]). This probabilistic approach is essential for understanding population heterogeneity and assessing the risk of cells reaching a critically short telomere length.", "problem": "You are tasked with constructing a probabilistic model of telomere shortening suitable for precision medicine and genomic diagnostics. Let the per-division telomere length change be modeled by independent and identically distributed random variables $\\Delta L_1, \\Delta L_2, \\ldots, \\Delta L_N$, where each $\\Delta L_k$ follows a Normal distribution (also called a Gaussian distribution) with mean $\\mu$ and variance $\\sigma^2$. The telomere length after $k$ divisions is defined recursively by $L_k = L_{k-1} - \\Delta L_k$ with an initial length $L_0$ given in base pairs, and all changes are measured in base pairs per division. Assume the $\\Delta L_k$ are independent of each other and of $L_0$. All lengths must be expressed in base pairs (bp) and all variances in square base pairs (bp$^2$). All probabilities must be expressed as decimals (not percentages).\n\nStarting from these definitions and the well-tested facts of probability theory, derive the distribution of $L_N$, including its mean and variance, and then compute the following diagnostic quantities for each provided test case:\n- The mean of $L_N$ in base pairs.\n- The variance of $L_N$ in base pairs squared.\n- The probability that the telomere length is at or below a diagnostic threshold $L_{\\text{crit}}$ at division $N$, that is $\\mathbb{P}(L_N \\le L_{\\text{crit}})$, expressed as a decimal.\n- The quantiles of $L_N$ at specified cumulative probabilities $q_1, \\ldots, q_m$, each in base pairs.\n\nYour program must implement the derived formulas and produce numerical outputs for the following test suite (all lengths in base pairs and rates in base pairs per division):\n1. $L_0 = 10000$, $\\mu = 50$, $\\sigma = 20$, $N = 100$, $L_{\\text{crit}} = 3000$, quantiles at $q \\in \\{0.025, 0.5, 0.975\\}$.\n2. $L_0 = 8000$, $\\mu = 100$, $\\sigma = 0$, $N = 30$, $L_{\\text{crit}} = 4500$, quantiles at $q \\in \\{0.1, 0.9\\}$. This case tests the deterministic limit.\n3. $L_0 = 9000$, $\\mu = 70$, $\\sigma = 30$, $N = 0$, $L_{\\text{crit}} = 8500$, quantiles at $q \\in \\{0.25, 0.75\\}$. This case tests zero divisions.\n4. $L_0 = 5000$, $\\mu = -10$, $\\sigma = 15$, $N = 50$, $L_{\\text{crit}} = 3000$, quantiles at $q \\in \\{0.05, 0.95\\}$. This case tests net elongation on average.\n5. $L_0 = 12000$, $\\mu = 60$, $\\sigma = 60$, $N = 150$, $L_{\\text{crit}} = 2000$, quantiles at $q \\in \\{0.01, 0.99\\}$.\n\nScientific realism constraints: The model must be derived using only fundamental probabilistic properties such as linearity of expectation, additivity of variance under independence, and the stability of the Normal family under summation and affine transformations. Do not assume any ad hoc formulas beyond these fundamental facts.\n\nEdge case requirement: If the variance of $L_N$ is zero (for example, when $N = 0$ or $\\sigma = 0$), treat $L_N$ as a degenerate distribution concentrated at its mean. For this case, define $\\mathbb{P}(L_N \\le L_{\\text{crit}})$ to be $1$ if the mean is less than or equal to $L_{\\text{crit}}$ and $0$ otherwise, and define every requested quantile to be equal to the mean.\n\nOutput specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a sublist in order, formatted as $[\\text{mean},\\text{variance},\\text{probability},q_1,\\ldots,q_m]$. All numbers must be rounded to exactly $6$ decimal places. The final output must therefore be a single line string of the form $[[\\cdots],[\\cdots],\\ldots]$ with no extra whitespace. All lengths must be in base pairs and all variances in base pairs squared.", "solution": "The problem requires us to model telomere length after $N$ divisions and compute several diagnostic quantities. We start by deriving the probability distribution of the final telomere length, $L_N$.\n\n**1. Mathematical Formulation**\nThe telomere length after $k$ divisions is given by the recursive formula $L_k = L_{k-1} - \\Delta L_k$, where $\\Delta L_k$ is the length change at division $k$. Unrolling this recursion, we can express the final length $L_N$ in terms of the initial length $L_0$ and the sum of all changes:\n$$L_N = L_0 - \\sum_{k=1}^{N} \\Delta L_k$$\nLet $S_N = \\sum_{k=1}^{N} \\Delta L_k$ represent the total length lost. Then, $L_N = L_0 - S_N$.\n\n**2. Distribution of Total Loss ($S_N$)**\nEach length change $\\Delta L_k$ is an independent and identically distributed (i.i.d.) random variable from a Normal distribution, $\\Delta L_k \\sim \\mathcal{N}(\\mu, \\sigma^2)$. A key property of the Normal distribution is its stability under summation: the sum of independent Normal variables is also Normal.\n- **Mean of $S_N$**: By the linearity of expectation, the mean of the sum is the sum of the means:\n  $$\\mathbb{E}[S_N] = \\mathbb{E}\\left[\\sum_{k=1}^{N} \\Delta L_k\\right] = \\sum_{k=1}^{N} \\mathbb{E}[\\Delta L_k] = \\sum_{k=1}^{N} \\mu = N\\mu$$\n- **Variance of $S_N$**: Because the variables are independent, the variance of the sum is the sum of the variances:\n  $$\\mathrm{Var}(S_N) = \\mathrm{Var}\\left(\\sum_{k=1}^{N} \\Delta L_k\\right) = \\sum_{k=1}^{N} \\mathrm{Var}(\\Delta L_k) = \\sum_{k=1}^{N} \\sigma^2 = N\\sigma^2$$\nThus, the total loss $S_N$ follows the distribution $S_N \\sim \\mathcal{N}(N\\mu, N\\sigma^2)$.\n\n**3. Distribution of Final Length ($L_N$)**\nSince $L_N = L_0 - S_N$ is an affine transformation of the Normally distributed variable $S_N$, $L_N$ itself is also Normally distributed.\n- **Mean of $L_N$**:\n  $$\\mu_N = \\mathbb{E}[L_N] = \\mathbb{E}[L_0 - S_N] = L_0 - \\mathbb{E}[S_N] = L_0 - N\\mu$$\n- **Variance of $L_N$**:\n  $$\\sigma_N^2 = \\mathrm{Var}(L_N) = \\mathrm{Var}(L_0 - S_N) = \\mathrm{Var}(-S_N) = (-1)^2 \\mathrm{Var}(S_N) = N\\sigma^2$$\nTherefore, the final telomere length follows the distribution:\n$$L_N \\sim \\mathcal{N}(L_0 - N\\mu, N\\sigma^2)$$\n\n**4. Formulas for Diagnostic Quantities**\nUsing the derived distribution, we can find the required quantities:\n- **Mean of $L_N$**: $\\mu_N = L_0 - N\\mu$\n- **Variance of $L_N$**: $\\sigma_N^2 = N\\sigma^2$\n- **Probability $\\mathbb{P}(L_N \\le L_{\\text{crit}})$**: This is the cumulative distribution function (CDF) of $L_N$ evaluated at $L_{\\text{crit}}$. We can standardize the variable:\n  $$\\mathbb{P}(L_N \\le L_{\\text{crit}}) = \\Phi\\left(\\frac{L_{\\text{crit}} - \\mu_N}{\\sigma_N}\\right)$$\n  where $\\Phi$ is the CDF of the standard Normal distribution $\\mathcal{N}(0, 1)$ and $\\sigma_N = \\sqrt{N\\sigma^2}$. This formula is for cases where $\\sigma_N > 0$.\n- **Quantiles of $L_N$**: The $q$-th quantile, $x_q$, is found using the inverse CDF (or percent-point function, PPF):\n  $$x_q = \\mu_N + \\sigma_N \\Phi^{-1}(q)$$\n  where $\\Phi^{-1}(q)$ is the inverse CDF of the standard Normal distribution.\n\n**5. Handling Zero Variance**\nAs specified, if $\\sigma_N^2 = N\\sigma^2 = 0$ (which occurs if $N=0$ or $\\sigma=0$), the distribution is degenerate (a point mass) at the mean $\\mu_N$.\n- The probability $\\mathbb{P}(L_N \\le L_{\\text{crit}})$ is $1$ if $\\mu_N \\le L_{\\text{crit}}$, and $0$ otherwise.\n- All quantiles are equal to the mean, $x_q = \\mu_N$.\n\nThese formulas are then implemented in the provided Python code to compute the numerical results for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Constructs a probabilistic model of telomere shortening and computes\n    diagnostic quantities for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L0, mu, sigma, N, L_crit, quantiles_q_list)\n    test_cases = [\n        (10000, 50, 20, 100, 3000, [0.025, 0.5, 0.975]),\n        (8000, 100, 0, 30, 4500, [0.1, 0.9]),\n        (9000, 70, 30, 0, 8500, [0.25, 0.75]),\n        (5000, -10, 15, 50, 3000, [0.05, 0.95]),\n        (12000, 60, 60, 150, 2000, [0.01, 0.99]),\n    ]\n\n    # A list to store the results for all test cases.\n    all_results = []\n\n    for case in test_cases:\n        L0, mu, sigma, N, L_crit, qs = case\n\n        # Calculate the mean and variance of the telomere length distribution after N divisions.\n        # mu_N = E[L_N] = L0 - N*mu\n        # var_N = Var(L_N) = N*sigma^2\n        mu_N = float(L0 - N * mu)\n        var_N = float(N * sigma**2)\n\n        # Handle the edge case of zero variance (degenerate distribution).\n        if var_N  1e-12: # Use a small tolerance for floating point comparison\n            # Probability is 1 if the constant value is = L_crit, else 0.\n            prob = 1.0 if mu_N = L_crit else 0.0\n            # All quantiles are equal to the mean for a degenerate distribution.\n            quantile_values = [mu_N] * len(qs)\n        else:\n            # For non-degenerate Normal distributions:\n            std_N = np.sqrt(var_N)\n            \n            # Probability P(L_N = L_crit) is the CDF at L_crit.\n            prob = norm.cdf(L_crit, loc=mu_N, scale=std_N)\n            \n            # Quantiles are calculated using the inverse CDF (percent-point function).\n            quantile_values = norm.ppf(qs, loc=mu_N, scale=std_N)\n            if not isinstance(quantile_values, np.ndarray):\n                quantile_values = [quantile_values]\n\n        # Assemble the results for the current case.\n        case_result = [mu_N, var_N, prob] + list(quantile_values)\n        all_results.append(case_result)\n\n    # Format the final output string as per the problem specification:\n    # [[val,val,...],[val,val,...]] with 6 decimal places and no whitespace.\n    output_parts = []\n    for res in all_results:\n        # Format each number to 6 decimal places.\n        formatted_numbers = [f\"{val:.6f}\" for val in res]\n        # Create the string for the inner list, e.g., \"[1.0,2.0]\"\n        output_parts.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    # Join the inner list strings and wrap in outer brackets.\n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "4389190"}, {"introduction": "After modeling telomere dynamics, a crucial step in precision medicine is interpreting an individual's measurement in a clinical context. A raw telomere length value is of limited use without comparison to a relevant reference population. This final practice ([@problem_id:4389172]) guides you through the process of calculating an age-adjusted z-score, a standardized metric that quantifies how much an individual's telomere length deviates from the norm for their age, while properly accounting for both biological and technical sources of variation.", "problem": "A clinical laboratory specializing in precision medicine and genomic diagnostics measures leukocyte telomere length in kilobases (kb) using Flow Fluorescence In Situ Hybridization (Flow-FISH). In a well-characterized control cohort, the age-dependent reference mean telomere length is modeled by a linear regression $L_{\\text{ref}}(a) = \\beta_{0} + \\beta_{1} a$, where $a$ is age in years, and residuals about this mean at any fixed age are approximately Gaussian with variance $\\sigma_{\\text{ref}}^{2}$. For an individual patient, multiple technical replicates are measured; each replicate is modeled as a Gaussian draw around the individual’s true telomere length with independent measurement variance $\\sigma_{m}^{2}$.\n\nAn individual aged $a = 52$ years has $n = 6$ independent technical replicates with replicate mean $\\hat{L} = 7.95$ kb and replicate sample variance $s^{2} = 0.0729$ kb$^{2}$, used as an unbiased estimator of $\\sigma_{m}^{2}$. The reference parameters are $\\beta_{0} = 10.8$ kb, $\\beta_{1} = -0.042$ kb$\\cdot$year$^{-1}$, and $\\sigma_{\\text{ref}} = 0.65$ kb.\n\nUsing the modeling assumptions stated, compute the age-adjusted telomere $z$-score for this patient’s sample, where the $z$-score is defined as the standardized residual of the observed sample mean relative to the age-matched reference mean, accounting for uncertainty from both inter-individual biological spread and finite-replicate measurement error. Round your final answer to four significant figures and report it as a unitless number.", "solution": "The goal is to standardize the observed sample mean telomere length against the age-matched reference, accounting for stochasticity from two sources: inter-individual biological variation around the regression and technical measurement error of the finite-replicate mean.\n\nFundamental base:\n1. Age-dependent reference mean telomere length is $L_{\\text{ref}}(a) = \\beta_{0} + \\beta_{1} a$.\n2. At fixed age $a$, the true individual telomere length $L_{\\text{true}}$ is modeled by $L_{\\text{true}} \\sim \\mathcal{N}\\!\\left(L_{\\text{ref}}(a), \\sigma_{\\text{ref}}^{2}\\right)$, reflecting inter-individual biological variation.\n3. Conditional on $L_{\\text{true}}$, each technical replicate $L_{i}$ is modeled as $L_{i} \\sim \\mathcal{N}\\!\\left(L_{\\text{true}}, \\sigma_{m}^{2}\\right)$ with independence across replicates. The sample mean $\\hat{L}$ over $n$ replicates then satisfies $\\hat{L} \\mid L_{\\text{true}} \\sim \\mathcal{N}\\!\\left(L_{\\text{true}}, \\sigma_{m}^{2}/n\\right)$.\n\nBy the law of total variance and independence of the biological and measurement components, the marginal distribution of the residual $\\hat{L} - L_{\\text{ref}}(a)$ is Gaussian with variance\n$$\n\\operatorname{Var}\\left(\\hat{L} - L_{\\text{ref}}(a)\\right) \\;=\\; \\sigma_{\\text{ref}}^{2} \\;+\\; \\frac{\\sigma_{m}^{2}}{n}.\n$$\nTherefore, the age-adjusted $z$-score for the sample mean is\n$$\nz \\;=\\; \\frac{\\hat{L} - L_{\\text{ref}}(a)}{\\sqrt{\\sigma_{\\text{ref}}^{2} + \\sigma_{m}^{2}/n}}.\n$$\n\nWe first compute the age-matched reference mean:\n$$\nL_{\\text{ref}}(52) \\;=\\; \\beta_{0} + \\beta_{1} a \\;=\\; 10.8 + (-0.042)\\cdot 52 \\;=\\; 10.8 - 2.184 \\;=\\; 8.616.\n$$\nThe observed residual of the sample mean is\n$$\n\\hat{L} - L_{\\text{ref}}(52) \\;=\\; 7.95 - 8.616 \\;=\\; -0.666.\n$$\n\nNext, estimate the measurement variance term for the mean. The replicate sample variance is $s^{2} = 0.0729$, used as the estimator of $\\sigma_{m}^{2}$. Hence the contribution of measurement error to the variance of the mean is\n$$\n\\frac{\\sigma_{m}^{2}}{n} \\;\\approx\\; \\frac{s^{2}}{n} \\;=\\; \\frac{0.0729}{6} \\;=\\; 0.01215.\n$$\nThe reference residual variance is\n$$\n\\sigma_{\\text{ref}}^{2} \\;=\\; (0.65)^{2} \\;=\\; 0.4225.\n$$\nCombine the two sources of variance:\n$$\n\\sigma_{\\text{tot}}^{2} \\;=\\; \\sigma_{\\text{ref}}^{2} + \\frac{\\sigma_{m}^{2}}{n} \\;\\approx\\; 0.4225 + 0.01215 \\;=\\; 0.43465.\n$$\nThus the standard deviation for the standardized residual is\n$$\n\\sigma_{\\text{tot}} \\;=\\; \\sqrt{0.43465} \\;\\approx\\; 0.65928.\n$$\nFinally, compute the $z$-score:\n$$\nz \\;=\\; \\frac{-0.666}{0.65928} \\;\\approx\\; -1.0102.\n$$\n\nRounded to four significant figures, the unitless age-adjusted telomere $z$-score is $-1.010$.", "answer": "$$\\boxed{-1.010}$$", "id": "4389172"}]}