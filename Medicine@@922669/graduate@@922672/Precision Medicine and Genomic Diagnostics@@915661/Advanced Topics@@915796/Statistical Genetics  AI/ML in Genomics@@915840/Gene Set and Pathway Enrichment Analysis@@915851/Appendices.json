{"hands_on_practices": [{"introduction": "The foundational method for pathway analysis is Over-Representation Analysis (ORA), which determines if a predefined list of \"interesting\" genes is significantly enriched for members of a particular pathway. This practice delves into the statistical engine behind ORA, Fisher's Exact Test, which uses a $2 \\times 2$ contingency table to calculate the exact probability of observing the enrichment by chance. By working through this calculation from first principles, you will gain a deep understanding of how ORA quantifies statistical significance based on the hypergeometric distribution, a cornerstone of bioinformatics. [@problem_id:4343610]", "problem": "A precision oncology study uses targeted RNA sequencing (RNA-seq) on a curated panel of $N$ genes to identify differentially expressed genes that may implicate actionable pathways. Consider a single pathway gene set with membership count $K$ within this panel. From the experimental pipeline, a total of $M$ genes are called differentially expressed under a specified false discovery rate control, and $x$ of these $M$ genes belong to the pathway gene set. A $2 \\times 2$ contingency table is constructed with rows indicating differential expression call (yes/no) and columns indicating pathway membership (yes/no). Fisher’s exact test (FET) evaluates the enrichment of differential expression in the pathway by conditioning on fixed margins and quantifying sampling without replacement according to the hypergeometric model.\n\nIn a specific tumor sample profiled on a $N = 30$-gene panel, a curated pathway contains $K = 9$ of these genes. The pipeline calls $M = 8$ genes as differentially expressed, of which $x = 5$ are members of the pathway. The resulting $2 \\times 2$ table is:\n- Differential expression yes and pathway yes: $5$\n- Differential expression yes and pathway no: $3$\n- Differential expression no and pathway yes: $4$\n- Differential expression no and pathway no: $18$\n\nStarting from the fundamental principle of sampling without replacement and the conditioning approach underlying Fisher’s exact test, compute the exact one-sided $p$-value for enrichment, defined as the probability of observing $X \\geq x$ pathway members among the $M$ differentially expressed genes, given the fixed margins. Show the full derivation from first principles and the complete step-by-step calculation. Round your final $p$-value to four significant figures. No units are required.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and internally consistent. It describes a standard application of Fisher's exact test for gene set enrichment analysis, a fundamental technique in bioinformatics and precision medicine. All necessary data are provided, and there are no contradictions. Therefore, the problem is valid and a solution can be derived.\n\nThe core of the problem is to calculate a one-sided $p$-value for enrichment using Fisher's exact test. This test is appropriate for analyzing contingency tables where the row and column totals (margins) are considered fixed. The underlying probability model is the hypergeometric distribution, which describes the probability of drawing a certain number of \"successes\" in a sample drawn without replacement from a finite population.\n\nIn this context, the population consists of $N$ genes on the panel. The \"successes\" are the $K$ genes that belong to the curated pathway. We draw a sample of size $M$, which represents the genes called as differentially expressed. We want to find the probability of observing a certain number of pathway genes, $k$, within this sample.\n\nThe probability mass function of the hypergeometric distribution for observing exactly $k$ successes is given by:\n$$\nP(X=k) = \\frac{\\binom{K}{k} \\binom{N-K}{M-k}}{\\binom{N}{M}}\n$$\nWhere:\n- $N$ is the total number of genes in the population (the panel size).\n- $K$ is the total number of genes with the property of interest (pathway members) in the population.\n- $M$ is the number of genes drawn in the sample (differentially expressed genes).\n- $k$ is the number of genes with the property of interest in the sample.\n\nFrom the problem statement, we are given:\n- $N = 30$\n- $K = 9$\n- $M = 8$\n- The observed number of pathway members among the differentially expressed genes is $x = 5$.\n\nThe one-sided $p$-value for enrichment is the probability of observing a result at least as extreme as the one observed, in the direction of enrichment. This means we must calculate the probability of observing $x$ or more pathway genes among the differentially expressed set, given the fixed margins. Mathematically, this is $P(X \\ge x)$, where $X$ is the random variable representing the number of pathway genes among the $M$ differentially expressed genes.\n\nFor our specific values, the $p$-value is:\n$$\np = P(X \\ge 5) = \\sum_{k=5}^{\\min(K,M)} P(X=k)\n$$\nSince $K=9$ and $M=8$, the maximum possible number of pathway genes in the sample is $\\min(9, 8) = 8$. Therefore, the sum is:\n$$\np = P(X=5) + P(X=6) + P(X=7) + P(X=8)\n$$\nWe calculate each term using the hypergeometric formula:\n$$\nP(X=k) = \\frac{\\binom{9}{k} \\binom{30-9}{8-k}}{\\binom{30}{8}} = \\frac{\\binom{9}{k} \\binom{21}{8-k}}{\\binom{30}{8}}\n$$\n\nFirst, we calculate the denominator, which is the total number of ways to choose $M=8$ genes from the panel of $N=30$:\n$$\n\\binom{N}{M} = \\binom{30}{8} = \\frac{30!}{8!(30-8)!} = \\frac{30!}{8!22!} = \\frac{30 \\times 29 \\times 28 \\times 27 \\times 26 \\times 25 \\times 24 \\times 23}{8 \\times 7 \\times 6 \\times 5 \\times 4 \\times 3 \\times 2 \\times 1} = 5,852,925\n$$\nThis is the total number of possible combinations of $8$ differentially expressed genes.\n\nNext, we calculate the numerator for each term in the sum:\n1. For $k=5$ (the observed outcome):\nThe number of ways to choose $5$ pathway genes from $9$ and $3$ non-pathway genes from $21$ is:\n$$\n\\binom{9}{5}\\binom{21}{8-5} = \\binom{9}{5}\\binom{21}{3} = \\left(\\frac{9 \\times 8 \\times 7 \\times 6}{4 \\times 3 \\times 2 \\times 1}\\right) \\times \\left(\\frac{21 \\times 20 \\times 19}{3 \\times 2 \\times 1}\\right) = 126 \\times 1330 = 167,580\n$$\n\n2. For $k=6$:\nThe number of ways to choose $6$ pathway genes from $9$ and $2$ non-pathway genes from $21$ is:\n$$\n\\binom{9}{6}\\binom{21}{8-6} = \\binom{9}{3}\\binom{21}{2} = \\left(\\frac{9 \\times 8 \\times 7}{3 \\times 2 \\times 1}\\right) \\times \\left(\\frac{21 \\times 20}{2 \\times 1}\\right) = 84 \\times 210 = 17,640\n$$\n\n3. For $k=7$:\nThe number of ways to choose $7$ pathway genes from $9$ and $1$ non-pathway gene from $21$ is:\n$$\n\\binom{9}{7}\\binom{21}{8-7} = \\binom{9}{2}\\binom{21}{1} = \\left(\\frac{9 \\times 8}{2 \\times 1}\\right) \\times \\left(21\\right) = 36 \\times 21 = 756\n$$\n\n4. For $k=8$:\nThe number of ways to choose $8$ pathway genes from $9$ and $0$ non-pathway genes from $21$ is:\n$$\n\\binom{9}{8}\\binom{21}{8-8} = \\binom{9}{1}\\binom{21}{0} = \\left(9\\right) \\times \\left(1\\right) = 9\n$$\n\nNow, we sum these counts and divide by the total number of combinations to get the $p$-value:\n$$\np = \\frac{167,580 + 17,640 + 756 + 9}{5,852,925} = \\frac{185,985}{5,852,925}\n$$\nPerforming the final division:\n$$\np \\approx 0.031776507...\n$$\nThe problem requires rounding the result to four significant figures. The fifth significant figure is $7$, so we round up the fourth significant figure.\n$$\np \\approx 0.03178\n$$", "answer": "$$\n\\boxed{0.03178}\n$$", "id": "4343610"}, {"introduction": "In genomics, we rarely test just one hypothesis; instead, we analyze thousands of genes or pathways at once. This massive parallel testing increases the likelihood of finding false positives, and the raw $p$-values from individual tests can be misleading. This exercise introduces the standard and essential procedure for correcting for multiple comparisons: the Benjamini–Hochberg method, which controls the False Discovery Rate (FDR). Mastering this hands-on practice will equip you to confidently identify a list of statistically robust pathway hits from a large-scale experiment. [@problem_id:4343651]", "problem": "A molecular tumor board is prioritizing targeted therapies based on pathway-level signals from a gene set enrichment analysis in a cohort of patients profiled by next-generation sequencing. A competitive enrichment test produced raw pathway $p$-values for $m$ distinct pathways. The study plans to control the False Discovery Rate (FDR) using the Benjamini–Hochberg step-up procedure at level $\\alpha = 0.05$, under the usual assumptions required for its validity in high-throughput genomics (for example, independent or positively dependent test statistics across pathways).\n\nYou are given the following list of pathways and their raw $p$-values (pathway names are for biomedical context; only the $p$-values matter for the multiple testing procedure):\n\n- Homologous recombination: $0.019$\n- Mismatch repair: $0.0025$\n- Phosphoinositide 3-kinase-Akt (PI3K-Akt) signaling: $0.041$\n- Mitogen-activated protein kinase (MAPK) signaling: $0.052$\n- Cell cycle: $0.011$\n- Tumor protein 53 (p53) signaling: $0.0009$\n- Vascular endothelial growth factor (VEGF) signaling: $0.034$\n- Janus kinase-signal transducer and activator of transcription (JAK-STAT) signaling: $0.028$\n- Transforming growth factor beta (TGF-$\\beta$) signaling: $0.071$\n- Wnt signaling: $0.12$\n- Notch signaling: $0.006$\n- Hedgehog signaling: $0.0041$\n\nTasks:\n1. Compute the Benjamini–Hochberg adjusted $p$-values for all $m$ pathways.\n2. Identify which pathways are significant at FDR level $\\alpha = 0.05$ based on these adjusted $p$-values.\n\nProvide as your final answer only the number of significant pathways. Do not include any units. No rounding is required beyond the precision implied by the given $p$-values.", "solution": "The problem as stated is valid. It presents a clear, self-contained, and scientifically grounded task that is central to the field of bioinformatics and statistical genomics. The problem provides a list of raw $p$-values from a gene set enrichment analysis and asks for the application of the standard Benjamini–Hochberg (BH) procedure to control the False Discovery Rate (FDR). This is a well-posed problem with a unique, correct solution derived from an established statistical algorithm. All necessary data (the set of $p$-values) and parameters (the FDR level $\\alpha$) are provided.\n\nThe objective is to identify which of the $m$ tested pathways are statistically significant after correcting for multiple comparisons, using the BH procedure at an FDR level of $\\alpha = 0.05$. The number of pathways, and thus the number of hypothesis tests, is $m=12$.\n\nThe Benjamini–Hochberg procedure involves the following steps:\n\n1.  **Order the $p$-values**: Let the raw $p$-values be denoted by $p_1, p_2, \\ldots, p_m$. These values are sorted in ascending order and denoted as $p_{(1)} \\le p_{(2)} \\le \\ldots \\le p_{(m)}$. The rank of the sorted $p$-value $p_{(i)}$ is $i$.\n\nThe given raw $p$-values are: $0.019$, $0.0025$, $0.041$, $0.052$, $0.011$, $0.0009$, $0.034$, $0.028$, $0.071$, $0.12$, $0.006$, and $0.0041$.\n\nSorting these $m=12$ values gives:\n- $p_{(1)} = 0.0009$ (Tumor protein 53 (p53) signaling)\n- $p_{(2)} = 0.0025$ (Mismatch repair)\n- $p_{(3)} = 0.0041$ (Hedgehog signaling)\n- $p_{(4)} = 0.006$ (Notch signaling)\n- $p_{(5)} = 0.011$ (Cell cycle)\n- $p_{(6)} = 0.019$ (Homologous recombination)\n- $p_{(7)} = 0.028$ (Janus kinase-signal transducer and activator of transcription (JAK-STAT) signaling)\n- $p_{(8)} = 0.034$ (Vascular endothelial growth factor (VEGF) signaling)\n- $p_{(9)} = 0.041$ (Phosphoinositide 3-kinase-Akt (PI3K-Akt) signaling)\n- $p_{(10)} = 0.052$ (Mitogen-activated protein kinase (MAPK) signaling)\n- $p_{(11)} = 0.071$ (Transforming growth factor beta (TGF-$\\beta$) signaling)\n- $p_{(12)} = 0.12$ (Wnt signaling)\n\n2.  **Compute the adjusted $p$-values**: The BH adjusted $p$-value, denoted $p_{adj}$, for the $i$-th sorted raw $p$-value is calculated to ensure that the list of adjusted $p$-values is monotonically non-decreasing. For each raw $p$-value $p_{(i)}$, we first compute a value $q_{(i)} = \\frac{m \\cdot p_{(i)}}{i}$. The adjusted $p$-value $p_{adj,(i)}$ is then found by enforcing monotonicity. Starting from the largest raw $p$-value:\n$$p_{adj,(m)} = q_{(m)} = p_{(m)}$$\nAnd for $i = m-1, m-2, \\dots, 1$:\n$$p_{adj,(i)} = \\min(p_{adj,(i+1)}, q_{(i)}) = \\min\\left(p_{adj,(i+1)}, \\frac{m \\cdot p_{(i)}}{i}\\right)$$\nThis is equivalent to the more compact formula $p_{adj,(i)} = \\min_{j=i}^{m} \\left(\\frac{m \\cdot p_{(j)}}{j}\\right)$.\n\nLet us compute the values for $i=1, \\dots, 12$:\n- For $i=1$: $q_{(1)} = \\frac{12 \\times 0.0009}{1} = 0.0108$\n- For $i=2$: $q_{(2)} = \\frac{12 \\times 0.0025}{2} = 0.015$\n- For $i=3$: $q_{(3)} = \\frac{12 \\times 0.0041}{3} = 0.0164$\n- For $i=4$: $q_{(4)} = \\frac{12 \\times 0.006}{4} = 0.018$\n- For $i=5$: $q_{(5)} = \\frac{12 \\times 0.011}{5} = 0.0264$\n- For $i=6$: $q_{(6)} = \\frac{12 \\times 0.019}{6} = 0.038$\n- For $i=7$: $q_{(7)} = \\frac{12 \\times 0.028}{7} \\approx 0.048$\n- For $i=8$: $q_{(8)} = \\frac{12 \\times 0.034}{8} = 0.051$\n- For $i=9$: $q_{(9)} = \\frac{12 \\times 0.041}{9} \\approx 0.05467$\n- For $i=10$: $q_{(10)} = \\frac{12 \\times 0.052}{10} = 0.0624$\n- For $i=11$: $q_{(11)} = \\frac{12 \\times 0.071}{11} \\approx 0.07745$\n- For $i=12$: $q_{(12)} = \\frac{12 \\times 0.12}{12} = 0.12$\n\nNow we enforce the monotonicity condition by working backwards from $i=12$:\n- $p_{adj,(12)} = q_{(12)} = 0.12$\n- $p_{adj,(11)} = \\min(p_{adj,(12)}, q_{(11)}) = \\min(0.12, 0.07745\\ldots) = 0.07745\\ldots$\n- $p_{adj,(10)} = \\min(p_{adj,(11)}, q_{(10)}) = \\min(0.07745\\ldots, 0.0624) = 0.0624$\n- $p_{adj,(9)} = \\min(p_{adj,(10)}, q_{(9)}) = \\min(0.0624, 0.05467\\ldots) = 0.05467\\ldots$\n- $p_{adj,(8)} = \\min(p_{adj,(9)}, q_{(8)}) = \\min(0.05467\\ldots, 0.051) = 0.051$\n- $p_{adj,(7)} = \\min(p_{adj,(8)}, q_{(7)}) = \\min(0.051, 0.048) = 0.048$\n- $p_{adj,(6)} = \\min(p_{adj,(7)}, q_{(6)}) = \\min(0.048, 0.038) = 0.038$\n- $p_{adj,(5)} = \\min(p_{adj,(6)}, q_{(5)}) = \\min(0.038, 0.0264) = 0.0264$\n- $p_{adj,(4)} = \\min(p_{adj,(5)}, q_{(4)}) = \\min(0.0264, 0.018) = 0.018$\n- $p_{adj,(3)} = \\min(p_{adj,(4)}, q_{(3)}) = \\min(0.018, 0.0164) = 0.0164$\n- $p_{adj,(2)} = \\min(p_{adj,(3)}, q_{(2)}) = \\min(0.0164, 0.015) = 0.015$\n- $p_{adj,(1)} = \\min(p_{adj,(2)}, q_{(1)}) = \\min(0.015, 0.0108) = 0.0108$\n\nThe adjusted $p$-values for each pathway are:\n- p53 signaling ($p=0.0009$): $p_{adj} = 0.0108$\n- Mismatch repair ($p=0.0025$): $p_{adj} = 0.015$\n- Hedgehog signaling ($p=0.0041$): $p_{adj} = 0.0164$\n- Notch signaling ($p=0.006$): $p_{adj} = 0.018$\n- Cell cycle ($p=0.011$): $p_{adj} = 0.0264$\n- Homologous recombination ($p=0.019$): $p_{adj} = 0.038$\n- JAK-STAT signaling ($p=0.028$): $p_{adj} = 0.048$\n- VEGF signaling ($p=0.034$): $p_{adj} = 0.051$\n- PI3K-Akt signaling ($p=0.041$): $p_{adj} \\approx 0.0547$\n- MAPK signaling ($p=0.052$): $p_{adj} = 0.0624$\n- TGF-$\\beta$ signaling ($p=0.071$): $p_{adj} \\approx 0.0775$\n- Wnt signaling ($p=0.12$): $p_{adj} = 0.12$\n\n3.  **Identify significant pathways**: A pathway is considered significant if its adjusted $p$-value is less than or equal to the specified FDR level $\\alpha$. Here, $\\alpha=0.05$.\n\nWe compare each pathway's adjusted $p$-value to $0.05$:\n- p53 signaling: $0.0108 \\le 0.05$ (Significant)\n- Mismatch repair: $0.015 \\le 0.05$ (Significant)\n- Hedgehog signaling: $0.0164 \\le 0.05$ (Significant)\n- Notch signaling: $0.018 \\le 0.05$ (Significant)\n- Cell cycle: $0.0264 \\le 0.05$ (Significant)\n- Homologous recombination: $0.038 \\le 0.05$ (Significant)\n- JAK-STAT signaling: $0.048 \\le 0.05$ (Significant)\n- VEGF signaling: $0.051 > 0.05$ (Not significant)\n- PI3K-Akt signaling: $0.0547 > 0.05$ (Not significant)\n- MAPK signaling: $0.0624 > 0.05$ (Not significant)\n- TGF-$\\beta$ signaling: $0.0775 > 0.05$ (Not significant)\n- Wnt signaling: $0.12 > 0.05$ (Not significant)\n\nBy counting the number of pathways that meet the significance criterion, we find there are $7$ significant pathways.", "answer": "$$\\boxed{7}$$", "id": "4343651"}, {"introduction": "While ORA relies on a discrete list of \"hit\" genes, \"second-generation\" methods like Gene Set Enrichment Analysis (GSEA) leverage the entire ranked profile of all genes, offering a more sensitive, threshold-free approach. GSEA asks whether the genes of a particular pathway are randomly distributed throughout a ranked list or tend to accumulate at the top or bottom. This exercise demystifies the GSEA algorithm by guiding you through the calculation of its core component, the running-sum statistic, to derive the final Enrichment Score (ES) on a small, illustrative dataset. [@problem_id:4343666]", "problem": "A precision oncology study aims to evaluate pathway activity signatures in a cohort of patients using Gene Set Enrichment Analysis (GSEA). The study produces a ranked list of genes according to a phenotype association score, and a pathway gene set is evaluated by the GSEA running-sum statistic. Consider the following small, synthetic ranked list of $N=10$ genes to illustrate the computation of the enrichment score. The genes $g_1, g_2, \\dots, g_{10}$ are ranked from $1$ (top) to $10$ (bottom) with associated weights (signed correlations with the phenotype, already ordered by descending value):\n\n- Rank $1$: gene $g_1$ with weight $0.80$\n- Rank $2$: gene $g_2$ with weight $0.75$\n- Rank $3$: gene $g_3$ with weight $0.60$\n- Rank $4$: gene $g_4$ with weight $0.40$\n- Rank $5$: gene $g_5$ with weight $0.35$\n- Rank $6$: gene $g_6$ with weight $0.20$\n- Rank $7$: gene $g_7$ with weight $0.15$\n- Rank $8$: gene $g_8$ with weight $0.10$\n- Rank $9$: gene $g_9$ with weight $0.05$\n- Rank $10$: gene $g_{10}$ with weight $0.02$\n\nLet the pathway gene set be $S=\\{g_1, g_3, g_7, g_9\\}$.\n\nUsing the canonical weighted running-sum definition of Gene Set Enrichment Analysis (GSEA) with exponent $p=1$, compute the enrichment score (ES) for $S$ on this ranked list, and identify the rank position at which the maximum deviation from zero occurs to determine the ES. Round your final ES to four significant figures. No units are required.", "solution": "The problem requires the computation of the Enrichment Score (ES) for a given gene set $S$ using the weighted Gene Set Enrichment Analysis (GSEA) method. The ES is the maximum deviation from zero of a running-sum statistic calculated by walking down a ranked list of genes.\n\nThe key parameters are:\n- Total number of genes in the ranked list, $N=10$.\n- The gene set of interest, $S=\\{g_1, g_3, g_7, g_9\\}$.\n- The number of genes in the set $S$, denoted as $N_H = |S| = 4$.\n- The number of genes not in the set $S$, denoted as $N_M = N - N_H = 10 - 4 = 6$.\n- The weight for each gene $g_j$ is its correlation $r_j$. The problem specifies a weighting exponent $p=1$. Since all given correlations are positive, the term $|r_j|^p$ simplifies to $r_j$.\n\nThe GSEA running sum, $ES_{sum}(i)$, is calculated iteratively for each gene at rank $i=1, \\dots, N$. The calculation uses two different update steps depending on whether the gene at rank $i$, $g_i$, is in the set $S$ (a \"hit\") or not (a \"miss\").\n\nFor a \"hit\" (i.e., $g_i \\in S$), the running sum is incremented by a value proportional to the gene's weight. The increment is given by:\n$$\n\\text{Increment} = \\frac{|r_i|^p}{N_R}\n$$\nwhere $N_R$ is a normalization factor equal to the sum of the weighted correlations for all genes in the set $S$:\n$$\nN_R = \\sum_{g_j \\in S} |r_j|^p\n$$\nGiven $p=1$ and all $r_j > 0$, we have:\n$$\nN_R = \\sum_{g_j \\in S} r_j = r_1 + r_3 + r_7 + r_9 = 0.80 + 0.60 + 0.15 + 0.05 = 1.60\n$$\n\nFor a \"miss\" (i.e., $g_i \\notin S$), the running sum is decremented by a constant value:\n$$\n\\text{Decrement} = \\frac{1}{N_M} = \\frac{1}{6}\n$$\n\nWe now calculate the running sum $ES_{sum}(i)$ for each rank $i$, starting with $ES_{sum}(0) = 0$.\n\n1.  **Rank $i=1$**: Gene $g_1 \\in S$. This is a hit.\n    $ES_{sum}(1) = ES_{sum}(0) + \\frac{r_1}{N_R} = 0 + \\frac{0.80}{1.60} = \\frac{1}{2}$.\n\n2.  **Rank $i=2$**: Gene $g_2 \\notin S$. This is a miss.\n    $ES_{sum}(2) = ES_{sum}(1) - \\frac{1}{N_M} = \\frac{1}{2} - \\frac{1}{6} = \\frac{3}{6} - \\frac{1}{6} = \\frac{2}{6} = \\frac{1}{3}$.\n\n3.  **Rank $i=3$**: Gene $g_3 \\in S$. This is a hit.\n    $ES_{sum}(3) = ES_{sum}(2) + \\frac{r_3}{N_R} = \\frac{1}{3} + \\frac{0.60}{1.60} = \\frac{1}{3} + \\frac{3}{8} = \\frac{8}{24} + \\frac{9}{24} = \\frac{17}{24}$.\n\n4.  **Rank $i=4$**: Gene $g_4 \\notin S$. This is a miss.\n    $ES_{sum}(4) = ES_{sum}(3) - \\frac{1}{N_M} = \\frac{17}{24} - \\frac{1}{6} = \\frac{17}{24} - \\frac{4}{24} = \\frac{13}{24}$.\n\n5.  **Rank $i=5$**: Gene $g_5 \\notin S$. This is a miss.\n    $ES_{sum}(5) = ES_{sum}(4) - \\frac{1}{N_M} = \\frac{13}{24} - \\frac{1}{6} = \\frac{13}{24} - \\frac{4}{24} = \\frac{9}{24} = \\frac{3}{8}$.\n\n6.  **Rank $i=6$**: Gene $g_6 \\notin S$. This is a miss.\n    $ES_{sum}(6) = ES_{sum}(5) - \\frac{1}{N_M} = \\frac{3}{8} - \\frac{1}{6} = \\frac{9}{24} - \\frac{4}{24} = \\frac{5}{24}$.\n\n7.  **Rank $i=7$**: Gene $g_7 \\in S$. This is a hit.\n    $ES_{sum}(7) = ES_{sum}(6) + \\frac{r_7}{N_R} = \\frac{5}{24} + \\frac{0.15}{1.60} = \\frac{5}{24} + \\frac{3}{32} = \\frac{20}{96} + \\frac{9}{96} = \\frac{29}{96}$.\n\n8.  **Rank $i=8$**: Gene $g_8 \\notin S$. This is a miss.\n    $ES_{sum}(8) = ES_{sum}(7) - \\frac{1}{N_M} = \\frac{29}{96} - \\frac{1}{6} = \\frac{29}{96} - \\frac{16}{96} = \\frac{13}{96}$.\n\n9.  **Rank $i=9$**: Gene $g_9 \\in S$. This is a hit.\n    $ES_{sum}(9) = ES_{sum}(8) + \\frac{r_9}{N_R} = \\frac{13}{96} + \\frac{0.05}{1.60} = \\frac{13}{96} + \\frac{1}{32} = \\frac{13}{96} + \\frac{3}{96} = \\frac{16}{96} = \\frac{1}{6}$.\n\n10. **Rank $i=10$**: Gene $g_{10} \\notin S$. This is a miss.\n    $ES_{sum}(10) = ES_{sum}(9) - \\frac{1}{N_M} = \\frac{1}{6} - \\frac{1}{6} = 0$. Note that the final value is correctly $0$.\n\nThe Enrichment Score (ES) is the maximum absolute deviation of the running sum from zero. We must find $\\max_{1 \\le i \\le N} |ES_{sum}(i)|$.\nThe sequence of running-sum values is:\n$ES_{sum}(1) = \\frac{1}{2} = 0.5$\n$ES_{sum}(2) = \\frac{1}{3} \\approx 0.3333$\n$ES_{sum}(3) = \\frac{17}{24} \\approx 0.7083$\n$ES_{sum}(4) = \\frac{13}{24} \\approx 0.5417$\n$ES_{sum}(5) = \\frac{3}{8} = 0.375$\n$ES_{sum}(6) = \\frac{5}{24} \\approx 0.2083$\n$ES_{sum}(7) = \\frac{29}{96} \\approx 0.3021$\n$ES_{sum}(8) = \\frac{13}{96} \\approx 0.1354$\n$ES_{sum}(9) = \\frac{1}{6} \\approx 0.1667$\n$ES_{sum}(10) = 0$\n\nAll calculated running-sum values are non-negative, so the maximum absolute deviation is simply the maximum value in the sequence. By inspection, the maximum value is $ES_{sum}(3) = \\frac{17}{24}$. This maximum deviation occurs at rank $3$.\n\nThe Enrichment Score is $ES = \\frac{17}{24}$.\nTo provide the final answer, we convert this fraction to a decimal and round to four significant figures.\n$ES = \\frac{17}{24} \\approx 0.708333...$\nRounding to four significant figures gives $0.7083$.", "answer": "$$\n\\boxed{0.7083}\n$$", "id": "4343666"}]}