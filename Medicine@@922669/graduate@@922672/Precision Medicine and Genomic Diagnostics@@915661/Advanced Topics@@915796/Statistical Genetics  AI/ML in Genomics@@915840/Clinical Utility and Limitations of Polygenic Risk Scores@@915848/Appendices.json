{"hands_on_practices": [{"introduction": "The fundamental building block of polygenic scoring is the aggregation of genetic information into a single, quantitative measure of liability. This first exercise [@problem_id:4326881] walks you through the core calculation of a linear Polygenic Risk Score (PRS). By combining an individual's genotype dosages with effect sizes derived from a genome-wide association study (GWAS), you will construct a raw score and then standardize it, which is essential for placing an individual's genetic risk into the broader context of a reference population.", "problem": "In a precision medicine clinic, a linear polygenic score is used to summarize common-variant liability for a complex trait under an additive genetic model. An individual has risk-allele dosages $x=(2,1,0,2,1)$ at $5$ independent single-nucleotide polymorphisms (SNPs), and the corresponding per-allele effect size estimates from an external genome-wide association study (GWAS) are $\\hat{\\beta}=(0.08,-0.05,0.12,0.02,0.09)$. Assume the usual additive model in which each locus contributes independently and additively to the log-risk on the liability scale, the risk-allele dosages are accurate counts per locus, and the $5$ loci have been linkage disequilibrium pruned in the discovery study so that weights can be combined linearly without double-counting correlated signals. Using the conventional definition of a linear polygenic score that aggregates locus-specific contributions via a weighted sum, construct the individual’s unstandardized score $S$ from these inputs. Then, using a reference population score distribution with mean $\\mu=0.15$ and standard deviation $\\sigma=0.10$, compute the individual’s standardized value $z$ relative to that reference. Round both reported values to four significant figures. Report your final answer as a row vector containing $S$ and $z$ in that order. No units are required.", "solution": "The user has asked for the calculation of an unstandardized and standardized polygenic score based on provided genetic data.\n\n### Step 1: Problem Validation\n\nFirst, the problem statement is validated against the required criteria.\n\n**Extracted Givens:**\n-   **Model:** A linear polygenic score based on an additive genetic model.\n-   **Risk-allele dosages vector:** $x = (2, 1, 0, 2, 1)$ for $5$ independent single-nucleotide polymorphisms (SNPs).\n-   **Per-allele effect size estimates vector:** $\\hat{\\beta} = (0.08, -0.05, 0.12, 0.02, 0.09)$.\n-   **Definition of unstandardized score ($S$):** A weighted sum of locus-specific contributions, which translates to the dot product of the dosage and effect size vectors.\n-   **Reference population parameters:** Mean score $\\mu = 0.15$ and standard deviation $\\sigma = 0.10$.\n-   **Task:**\n    1.  Calculate the unstandardized score $S$.\n    2.  Calculate the standardized score $z$.\n    3.  Round both values to four significant figures.\n    4.  Report the results as a row vector $[S, z]$.\n\n**Validation Verdict:**\nThe problem is deemed **valid**.\n-   **Scientifically Grounded:** The described methodology for calculating a polygenic score is standard practice in statistical genetics and precision medicine. The additive model, use of effect sizes from genome-wide association studies (GWAS), and standardization are all well-established concepts.\n-   **Well-Posed:** All necessary data and definitions are provided for a unique solution. The vectors $x$ and $\\hat{\\beta}$ have consistent dimensions.\n-   **Objective:** The problem is stated using precise, quantitative language, free of ambiguity or subjective claims.\n-   The problem does not violate any other criteria for invalidity (e.g., it is not incomplete, contradictory, unrealistic, or trivial).\n\nThe solution process can proceed.\n\n### Step 2: Calculation of the Unstandardized Polygenic Score ($S$)\n\nThe problem defines the unstandardized polygenic score, $S$, as a weighted sum of the risk-allele dosages, where the weights are the corresponding per-allele effect sizes. This can be expressed as the dot product of the dosage vector $x$ and the effect size vector $\\hat{\\beta}$. For $n$ SNPs, the formula is:\n$$S = \\sum_{i=1}^{n} x_i \\hat{\\beta}_i = x \\cdot \\hat{\\beta}$$\nIn this case, we have $n=5$ SNPs. The given vectors are:\n$$x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\\\ x_5 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}$$\n$$\\hat{\\beta} = \\begin{pmatrix} \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\\\ \\hat{\\beta}_3 \\\\ \\hat{\\beta}_4 \\\\ \\hat{\\beta}_5 \\end{pmatrix} = \\begin{pmatrix} 0.08 \\\\ -0.05 \\\\ 0.12 \\\\ 0.02 \\\\ 0.09 \\end{pmatrix}$$\nThe calculation is as follows:\n$$S = (x_1 \\times \\hat{\\beta}_1) + (x_2 \\times \\hat{\\beta}_2) + (x_3 \\times \\hat{\\beta}_3) + (x_4 \\times \\hat{\\beta}_4) + (x_5 \\times \\hat{\\beta}_5)$$\n$$S = (2 \\times 0.08) + (1 \\times -0.05) + (0 \\times 0.12) + (2 \\times 0.02) + (1 \\times 0.09)$$\n$$S = 0.16 - 0.05 + 0 + 0.04 + 0.09$$\n$$S = 0.11 + 0.04 + 0.09$$\n$$S = 0.24$$\nThe problem requires this value to be rounded to four significant figures. The value $0.24$ has two significant figures. To express it with four, we add trailing zeros:\n$$S = 0.2400$$\n\n### Step 3: Calculation of the Standardized Polygenic Score ($z$)\n\nThe standardized score, or $z$-score, measures how many standard deviations an individual's score is from the mean of a reference population. The formula is:\n$$z = \\frac{S - \\mu}{\\sigma}$$\nUsing the calculated unstandardized score $S = 0.24$ and the given reference population parameters $\\mu = 0.15$ and $\\sigma = 0.10$:\n$$z = \\frac{0.24 - 0.15}{0.10}$$\n$$z = \\frac{0.09}{0.10}$$\n$$z = 0.9$$\nThe problem requires this value to also be rounded to four significant figures. The value $0.9$ has one significant figure. To express it with four, we add trailing zeros:\n$$z = 0.9000$$\n\n### Step 4: Final Answer Formulation\n\nThe final answer is to be reported as a row vector containing the rounded values of $S$ and $z$ in that order.\nThe required vector is $(S, z)$, which is $(0.2400, 0.9000)$. This is represented using the `pmatrix` environment in LaTeX.", "answer": "$$\\boxed{\\begin{pmatrix} 0.2400  0.9000 \\end{pmatrix}}$$", "id": "4326881"}, {"introduction": "Once a PRS is constructed, its clinical utility hinges on its ability to accurately discriminate between individuals who will develop a disease and those who will not. This practice [@problem_id:4326807] delves into evaluating this discriminatory power using the Area Under the Receiver Operating Characteristic Curve (AUC). You will derive the theoretical AUC from the statistical properties of the PRS distributions in cases and controls, providing a direct link between the mean separation of scores and this key performance metric.", "problem": "A biobank study evaluates the classification performance of a Polygenic Risk Score (PRS) for a binary disease outcome using Area Under the Receiver Operating Characteristic Curve (AUC). By design, the PRS is standardized within ancestry strata, and the study uses independent training and test cohorts. In the target population, the PRS distributions among cases and controls are approximately Gaussian with a common standard deviation. Specifically, assume that the PRS among cases is distributed as $S_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ and among controls as $S_{0} \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$, with $S_{1}$ and $S_{0}$ independent. The AUC is defined as the probability that a randomly sampled case has a higher PRS than a randomly sampled control, that is, $\\text{AUC} = \\mathbb{P}(S_{1}  S_{0})$.\n\nUsing this definition and only standard properties of Gaussian random variables and the standard normal cumulative distribution function, compute the model-implied AUC for parameter values $\\mu_{1} = 0.4$, $\\mu_{0} = 0.0$, and $\\sigma = 0.2$ (all numbers dimensionless). In an external validation dataset, the empirically observed AUC is $\\text{AUC}_{\\text{emp}} = 0.88$.\n\nReport the absolute deviation between the model-implied AUC and the empirical AUC, defined as $D = |\\text{AUC}_{\\text{model}} - \\text{AUC}_{\\text{emp}}|$. Express your final answer as a decimal without a percentage sign and round to four significant figures.", "solution": "The problem requires the computation of the absolute deviation between a model-implied Area Under the Receiver Operating Characteristic Curve ($\\text{AUC}_{\\text{model}}$) and an empirically observed one ($\\text{AUC}_{\\text{emp}}$). The first step is to derive and calculate $\\text{AUC}_{\\text{model}}$ from the given distributional assumptions.\n\nThe problem states that the Polygenic Risk Score (PRS) for cases, $S_{1}$, follows a normal distribution $S_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$, and the PRS for controls, $S_{0}$, follows a normal distribution $S_{0} \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$. The variables $S_{1}$ and $S_{0}$ are given to be independent.\n\nThe $\\text{AUC}$ is defined as the probability that a randomly sampled case will have a higher PRS than a randomly sampled control. This can be written as:\n$$\n\\text{AUC}_{\\text{model}} = \\mathbb{P}(S_{1}  S_{0})\n$$\nThis is equivalent to finding the probability that the difference between the two scores is positive, $\\mathbb{P}(S_{1} - S_{0}  0)$.\n\nLet us define a new random variable $Y = S_{1} - S_{0}$. Since $S_{1}$ and $S_{0}$ are independent Gaussian random variables, their difference, $Y$, is also a Gaussian random variable. We can determine the parameters of this new distribution.\n\nThe mean of $Y$ is the difference of the individual means:\n$$\n\\mathbb{E}[Y] = \\mathbb{E}[S_{1} - S_{0}] = \\mathbb{E}[S_{1}] - \\mathbb{E}[S_{0}] = \\mu_{1} - \\mu_{0}\n$$\nThe variance of $Y$ is the sum of the individual variances due to the independence of $S_{1}$ and $S_{0}$:\n$$\n\\text{Var}(Y) = \\text{Var}(S_{1} - S_{0}) = \\text{Var}(S_{1}) + (-1)^{2}\\text{Var}(S_{0}) = \\text{Var}(S_{1}) + \\text{Var}(S_{0}) = \\sigma^{2} + \\sigma^{2} = 2\\sigma^{2}\n$$\nSo, the distribution of the difference is $Y \\sim \\mathcal{N}(\\mu_{1} - \\mu_{0}, 2\\sigma^{2})$.\n\nWe need to compute $\\mathbb{P}(Y  0)$. To do this, we standardize $Y$ to obtain a standard normal variable $Z \\sim \\mathcal{N}(0, 1)$, using the transformation:\n$$\nZ = \\frac{Y - \\mathbb{E}[Y]}{\\sqrt{\\text{Var}(Y)}} = \\frac{Y - (\\mu_{1} - \\mu_{0})}{\\sqrt{2\\sigma^{2}}} = \\frac{Y - (\\mu_{1} - \\mu_{0})}{\\sigma\\sqrt{2}}\n$$\nWe can now rewrite the probability in terms of $Z$:\n$$\n\\mathbb{P}(Y  0) = \\mathbb{P}\\left(\\frac{Y - (\\mu_{1} - \\mu_{0})}{\\sigma\\sqrt{2}}  \\frac{0 - (\\mu_{1} - \\mu_{0})}{\\sigma\\sqrt{2}}\\right) = \\mathbb{P}\\left(Z  -\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\n$$\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi(z) = \\mathbb{P}(Z \\le z)$. The probability can be expressed as:\n$$\n\\mathbb{P}\\left(Z  -\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right) = 1 - \\Phi\\left(-\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\n$$\nUsing the symmetry property of the standard normal CDF, $\\Phi(-z) = 1 - \\Phi(z)$, we can rewrite the expression:\n$$\n1 - \\Phi\\left(-\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right) = 1 - \\left(1 - \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\\right) = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\n$$\nTherefore, the general formula for the model-implied $\\text{AUC}$ is:\n$$\n\\text{AUC}_{\\text{model}} = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\n$$\nWe are given the parameter values $\\mu_{1} = 0.4$, $\\mu_{0} = 0.0$, and $\\sigma = 0.2$. Substituting these into the formula:\n$$\n\\text{AUC}_{\\text{model}} = \\Phi\\left(\\frac{0.4 - 0.0}{0.2 \\times \\sqrt{2}}\\right) = \\Phi\\left(\\frac{0.4}{0.2\\sqrt{2}}\\right) = \\Phi\\left(\\frac{2}{\\sqrt{2}}\\right) = \\Phi(\\sqrt{2})\n$$\nThe numerical value of $\\sqrt{2}$ is approximately $1.41421356...$. The value of the standard normal CDF at this point is:\n$$\n\\text{AUC}_{\\text{model}} \\approx \\Phi(1.41421356) \\approx 0.92135043\n$$\nThe problem states that the empirically observed value is $\\text{AUC}_{\\text{emp}} = 0.88$. We are required to find the absolute deviation, $D$:\n$$\nD = |\\text{AUC}_{\\text{model}} - \\text{AUC}_{\\text{emp}}|\n$$\nSubstituting the values:\n$$\nD = |0.92135043... - 0.88| = |0.04135043...| = 0.04135043...\n$$\nThe final answer must be rounded to four significant figures. The first four significant figures of $0.04135043...$ are $4$, $1$, $3$, and $5$. The subsequent digit is $0$, which means we do not round up the last significant digit.\n$$\nD \\approx 0.04135\n$$", "answer": "$$\\boxed{0.04135}$$", "id": "4326807"}, {"introduction": "A major challenge in deploying PRS clinically is their potential for miscalibration when applied to populations different from the one they were trained in. This exercise [@problem_id:4326811] addresses the critical issue of portability, specifically how a PRS model calibrated in one population can yield inaccurate absolute risk estimates in another with a different baseline disease prevalence. By working from first principles, you will derive the necessary adjustments to the model's intercept on the log-odds scale, a crucial skill for ensuring the accuracy and equity of PRS in diverse clinical settings.", "problem": "A Polygenic Risk Score (PRS) model trained and calibrated in a European-ancestry (EUR) cohort is used to predict the absolute probability of a complex disease via a logistic link. Let the score for an individual be $S$, and suppose the EUR-trained model produces a linear predictor $L = b_{0} + b_{1} S$ and estimated risk $\\operatorname{logit}^{-1}(L)$, where $\\operatorname{logit}(p) = \\ln\\!\\left(\\frac{p}{1-p}\\right)$ and $\\operatorname{logit}^{-1}(x) = \\frac{1}{1+\\exp(-x)}$. Assume that in the EUR cohort, the model is well-calibrated (i.e., the average predicted risk equals the observed prevalence), with disease prevalence $p_{\\mathrm{EUR}} = 0.1$. The model is transported to a target cohort in which the disease prevalence is exactly twice as high, $p_{\\mathrm{target}} = 0.2$. Assume that the per-standard-deviation effect size of the PRS on the log-odds scale and the distribution of $S$ are transportable across cohorts (i.e., case-control log-likelihood ratios conditional on $S$ are invariant), so that any miscalibration arises solely from the change in baseline disease prevalence.\n\nDefine the standard logistic calibration model applied in the target cohort as\n$$\n\\operatorname{logit}\\!\\big(P(Y=1 \\mid L)\\big) = a + c\\,L,\n$$\nwhere $a$ is the calibration intercept (calibration-in-the-large) and $c$ is the calibration slope. Starting from the definitions of odds and the logit link and without invoking any pre-stated transport equations, derive the values of $a$ and $c$ implied by a pure prevalence shift, and then prescribe a principled recalibration method to recover calibrated absolute risks in the target cohort by modifying the original model.\n\nReport the numerical value of the calibration intercept $a$ for this scenario, rounded to four significant figures. No units are required for the final answer.", "solution": "We begin from first principles of logistic regression, odds, and Bayes theorem for updating odds. The logistic model implies that for an individual with score $S$, the log-odds of disease in the EUR cohort are\n$$\n\\operatorname{logit}\\!\\big(P_{\\mathrm{EUR}}(Y=1 \\mid S)\\big) = b_{0} + b_{1} S = L.\n$$\nEquivalently, the odds in the EUR cohort are\n$$\n\\frac{P_{\\mathrm{EUR}}(Y=1 \\mid S)}{1 - P_{\\mathrm{EUR}}(Y=1 \\mid S)} = \\exp(L).\n$$\nThe intercept $b_{0}$ encodes the baseline (prior) odds of disease, while $b_{1} S$ represents the log-likelihood ratio contributed by the PRS under the assumption that the case-control log-likelihood ratio conditional on $S$ is invariant across cohorts. Let the marginal prevalence in the EUR cohort be $p_{\\mathrm{EUR}}$ and in the target cohort be $p_{\\mathrm{target}}$. Their corresponding prior odds are\n$$\nO_{\\mathrm{EUR}} = \\frac{p_{\\mathrm{EUR}}}{1 - p_{\\mathrm{EUR}}}, \\qquad O_{\\mathrm{target}} = \\frac{p_{\\mathrm{target}}}{1 - p_{\\mathrm{target}}}.\n$$\n\nUnder the assumption that only the prior probability changes across cohorts (i.e., transportability of the likelihood function conditional on $S$), Bayes theorem implies that posterior odds are prior odds multiplied by the likelihood ratio. Because $b_{1} S$ represents the log-likelihood ratio component, changing only the prior odds from $O_{\\mathrm{EUR}}$ to $O_{\\mathrm{target}}$ multiplies the EUR posterior odds by a constant factor $\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}$ for every value of $S$. Therefore, the target-cohort posterior odds given $S$ satisfy\n$$\n\\frac{P_{\\mathrm{target}}(Y=1 \\mid S)}{1 - P_{\\mathrm{target}}(Y=1 \\mid S)} \\;=\\; \\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}} \\times \\frac{P_{\\mathrm{EUR}}(Y=1 \\mid S)}{1 - P_{\\mathrm{EUR}}(Y=1 \\mid S)} \\;=\\; \\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}} \\times \\exp(L).\n$$\nTaking the natural logarithm,\n$$\n\\operatorname{logit}\\!\\big(P_{\\mathrm{target}}(Y=1 \\mid S)\\big) \\;=\\; \\ln\\!\\left(\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}\\right) + L.\n$$\nComparing to the calibration model $\\operatorname{logit}(P(Y=1 \\mid L)) = a + c\\,L$, we see that the prevalence shift induces a pure additive shift in the logit by the constant\n$$\na \\;=\\; \\ln\\!\\left(\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}\\right) \\;=\\; \\big[\\ln(O_{\\mathrm{target}}) - \\ln(O_{\\mathrm{EUR}})\\big] \\;=\\; \\operatorname{logit}(p_{\\mathrm{target}}) - \\operatorname{logit}(p_{\\mathrm{EUR}}),\n$$\nwith slope\n$$\nc \\;=\\; 1,\n$$\nbecause the likelihood ratio term $b_{1} S$ remains unchanged. Thus, under a pure prevalence change, the calibration slope is $1$ and the calibration intercept equals the difference in logits of the target and source prevalences.\n\nA principled recalibration method follows directly: modify only the intercept of the original model. If the original EUR model is $\\operatorname{logit}(P_{\\mathrm{EUR}}(Y=1 \\mid S)) = b_{0} + b_{1} S$, define the recalibrated target model as\n$$\n\\operatorname{logit}(P_{\\mathrm{target}}(Y=1 \\mid S)) \\;=\\; \\big(b_{0} + a\\big) + b_{1} S,\n$$\nwhere\n$$\na \\;=\\; \\operatorname{logit}(p_{\\mathrm{target}}) - \\operatorname{logit}(p_{\\mathrm{EUR}}) \\;=\\; \\ln\\!\\left(\\frac{p_{\\mathrm{target}}}{1 - p_{\\mathrm{target}}}\\right) - \\ln\\!\\left(\\frac{p_{\\mathrm{EUR}}}{1 - p_{\\mathrm{EUR}}}\\right).\n$$\nEquivalently, to obtain calibrated absolute risks in the target population from EUR predictions with linear predictor $L$, compute $\\operatorname{logit}^{-1}(L + a)$.\n\nWe now compute the numerical value of $a$ for $p_{\\mathrm{EUR}} = 0.1$ and $p_{\\mathrm{target}} = 0.2$:\n$$\nO_{\\mathrm{EUR}} \\;=\\; \\frac{0.1}{1 - 0.1} \\;=\\; \\frac{0.1}{0.9} \\;=\\; \\frac{1}{9},\n$$\n$$\nO_{\\mathrm{target}} \\;=\\; \\frac{0.2}{1 - 0.2} \\;=\\; \\frac{0.2}{0.8} \\;=\\; \\frac{1}{4}.\n$$\nHence,\n$$\na \\;=\\; \\ln\\!\\left(\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}\\right) \\;=\\; \\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{9}}\\right) \\;=\\; \\ln\\!\\left(\\frac{9}{4}\\right) \\;=\\; \\ln(9) - \\ln(4).\n$$\nUsing $\\ln(9) \\approx 2.197224577$ and $\\ln(4) \\approx 1.386294361$,\n$$\na \\;\\approx\\; 2.197224577 - 1.386294361 \\;=\\; 0.810930216.\n$$\nRounded to four significant figures, $a \\approx 0.8109$.\n\nIn summary: under a two-fold prevalence increase with transportable effect sizes, the calibration slope is $1$, the calibration intercept is $a = \\operatorname{logit}(0.2) - \\operatorname{logit}(0.1) = \\ln(9/4)$, and recalibration is achieved by adding $a$ to the original intercept (or equivalently adding $a$ to the linear predictor $L$ before applying the inverse logit).", "answer": "$$\\boxed{0.8109}$$", "id": "4326811"}]}