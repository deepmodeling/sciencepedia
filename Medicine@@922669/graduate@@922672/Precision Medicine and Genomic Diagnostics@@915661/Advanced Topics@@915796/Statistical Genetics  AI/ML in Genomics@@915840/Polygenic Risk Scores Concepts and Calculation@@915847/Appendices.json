{"hands_on_practices": [{"introduction": "At its core, a Polygenic Risk Score (PRS) is a weighted sum of an individual's genetic variants, representing their aggregated genetic liability for a particular trait or disease. This first practice establishes the fundamental mechanics of calculating a raw PRS from a given set of genetic variants and their associated weights [@problem_id:4369012]. To transform this raw number into a clinically meaningful metric, we must contextualize it within a reference population, which is accomplished by standardizing the score into a $z$-score, a skill you will also master here.", "problem": "In the context of precision medicine, a Polygenic Risk Score (PRS) aggregates contributions across many Single-Nucleotide Polymorphisms (SNPs) under an additive genetic model, where per-allele effects estimated from Genome-Wide Association Studies (GWAS) are combined with an individual’s effect-allele genotype dosages produced by imputation. Consider a PRS constructed from $5$ SNPs, with GWAS per-allele log-odds weights aligned to the effect alleles and the individual’s corresponding effect-allele dosages as follows:\n- SNP $1$: weight $0.137$, dosage $1.8$.\n- SNP $2$: weight $-0.052$, dosage $0.7$.\n- SNP $3$: weight $0.221$, dosage $2.0$.\n- SNP $4$: weight $0.018$, dosage $1.2$.\n- SNP $5$: weight $-0.095$, dosage $0.3$.\n\nAssume the additive model holds, strand alignment is correct, and no further shrinkage or scaling has been applied beyond what is stated. The reference population PRS distribution for this exact specification (same SNP set, weights, and allele coding) has mean $\\mu = 0.312$ and standard deviation (SD) $\\sigma = 0.274$.\n\nCompute the individual’s PRS using these inputs, then standardize it to a $z$-score using the provided reference mean and SD. Report only the final standardized PRS ($z$-score), rounded to $4$ significant figures.", "solution": "The problem first requires the computation of an individual's Polygenic Risk Score (PRS) based on an additive genetic model. The PRS is calculated as the sum of the products of the per-allele effect weights ($w_i$) and the corresponding effect-allele dosages ($d_i$) for a set of $N$ Single-Nucleotide Polymorphisms (SNPs). The formula for the PRS is:\n$$PRS = \\sum_{i=1}^{N} w_i d_i$$\nIn this problem, we are given the weights and dosages for $N=5$ SNPs:\n1. SNP $1$: weight $w_1 = 0.137$, dosage $d_1 = 1.8$\n2. SNP $2$: weight $w_2 = -0.052$, dosage $d_2 = 0.7$\n3. SNP $3$: weight $w_3 = 0.221$, dosage $d_3 = 2.0$\n4. SNP $4$: weight $w_4 = 0.018$, dosage $d_4 = 1.2$\n5. SNP $5$: weight $w_5 = -0.095$, dosage $d_5 = 0.3$\n\nWe calculate the individual's PRS by substituting these values into the formula:\n$$PRS = (w_1 d_1) + (w_2 d_2) + (w_3 d_3) + (w_4 d_4) + (w_5 d_5)$$\n$$PRS = (0.137 \\times 1.8) + (-0.052 \\times 0.7) + (0.221 \\times 2.0) + (0.018 \\times 1.2) + (-0.095 \\times 0.3)$$\nFirst, we compute each product term:\n- Term $1$: $0.137 \\times 1.8 = 0.2466$\n- Term $2$: $-0.052 \\times 0.7 = -0.0364$\n- Term $3$: $0.221 \\times 2.0 = 0.4420$\n- Term $4$: $0.018 \\times 1.2 = 0.0216$\n- Term $5$: $-0.095 \\times 0.3 = -0.0285$\n\nNext, we sum these terms to obtain the total PRS:\n$$PRS = 0.2466 - 0.0364 + 0.4420 + 0.0216 - 0.0285$$\n$$PRS = 0.6453$$\n\nThe second part of the problem is to standardize this raw PRS to a $z$-score using the provided reference population mean ($\\mu$) and standard deviation ($\\sigma$). The formula for the $z$-score is:\n$$z = \\frac{X - \\mu}{\\sigma}$$\nwhere $X$ is the individual's score, which is the calculated PRS.\nThe given reference population parameters are:\n- Mean $\\mu = 0.312$\n- Standard Deviation $\\sigma = 0.274$\n\nSubstituting the calculated PRS and the given population parameters into the $z$-score formula:\n$$z = \\frac{0.6453 - 0.312}{0.274}$$\n$$z = \\frac{0.3333}{0.274}$$\n$$z \\approx 1.21642335766$$\n\nThe problem requires the final answer to be rounded to $4$ significant figures. The calculated value is approximately $1.2164$. The first four significant figures are $1$, $2$, $1$, and $6$. The fifth digit is $4$, which is less than $5$, so we round down by keeping the fourth significant digit as is.\nTherefore, the standardized PRS, or $z$-score, rounded to $4$ significant figures is $1.216$.", "answer": "$$\\boxed{1.216}$$", "id": "4369012"}, {"introduction": "A robust PRS depends critically on the careful selection of genetic variants from a genome-wide association study (GWAS). Because many nearby variants are correlated due to Linkage Disequilibrium (LD), simply including all associated variants would inflate the score by double-counting the same genetic signal. This exercise walks you through LD clumping, a key bioinformatic algorithm used to prune a list of variants, ensuring that the final PRS is built from a set of approximately independent genetic signals [@problem_id:4369034].", "problem": "A polygenic risk score (PRS) for a disease is defined as the linear combination of single-nucleotide polymorphism (SNP) genotypes weighted by their genome-wide association study (GWAS) effect sizes. Formally, for a set of SNPs with aligned effect alleles, the PRS for an individual is $ \\sum_{i} w_{i} \\, G_{i} $, where $ G_{i} $ is the allele dosage for SNP $ i $ and $ w_{i} $ is its weight. To avoid redundancy due to linkage disequilibrium (LD), LD clumping is applied to select approximately independent index SNPs based on statistical significance and pairwise LD.\n\nConsider a single locus with six SNPs $ G_{1}, G_{2}, G_{3}, G_{4}, G_{5}, G_{6} $. The genome-wide association study (GWAS) provides per-SNP marginal log-odds effect sizes $ \\hat{\\beta}_{i} $ and $ p $-values $ p_{i} $:\n- $ \\hat{\\beta}_{1} = 0.07 $, $ p_{1} = 3.0 \\times 10^{-4} $,\n- $ \\hat{\\beta}_{2} = -0.11 $, $ p_{2} = 1.0 \\times 10^{-5} $,\n- $ \\hat{\\beta}_{3} = 0.02 $, $ p_{3} = 3.0 \\times 10^{-3} $,\n- $ \\hat{\\beta}_{4} = 0.05 $, $ p_{4} = 1.2 \\times 10^{-4} $,\n- $ \\hat{\\beta}_{5} = 0.13 $, $ p_{5} = 8.0 \\times 10^{-8} $,\n- $ \\hat{\\beta}_{6} = -0.03 $, $ p_{6} = 9.0 \\times 10^{-4} $.\n\nThe LD matrix $ R $ for these SNPs (with entries $ r_{ij} $ equal to the Pearson correlation of dosages between $ G_{i} $ and $ G_{j} $) is:\n$$\nR = \\begin{pmatrix}\n1  0.62  0.10  0.18  0.48  0.05 \\\\\n0.62  1  0.08  0.22  0.65  0.12 \\\\\n0.10  0.08  1  0.09  0.06  0.11 \\\\\n0.18  0.22  0.09  1  0.35  0.15 \\\\\n0.48  0.65  0.06  0.35  1  0.20 \\\\\n0.05  0.12  0.11  0.15  0.20  1\n\\end{pmatrix}.\n$$\n\nPerform LD clumping with the following parameters:\n- inclusion $ p $-value threshold $ p_{\\max} = 5.0 \\times 10^{-4} $,\n- LD threshold $ r_{\\text{thr}}^{2} = 0.20 $,\n- a single-window assumption that all six SNPs reside within one clumping window.\n\nClumping is defined as:\n1. Restrict to SNPs with $ p_{i} \\leq p_{\\max} $.\n2. Rank the remaining SNPs by ascending $ p_{i} $.\n3. Iteratively select the most significant remaining SNP as the index variant; remove any remaining SNP $ j $ that satisfies $ r_{ij}^{2} \\geq r_{\\text{thr}}^{2} $ relative to the selected index SNP $ i $. Continue until no SNPs remain.\n\nAssume effect alleles are aligned and that PRS weights for selected index SNPs are their GWAS marginal log-odds $ \\hat{\\beta}_{i} $ without further shrinkage or reweighting. Execute the clumping procedure and report the resulting PRS weights $ w_{i} $ in a single row matrix (LaTeX $ \\texttt{pmatrix} $), ordered by the sequence in which the index SNPs are selected. No rounding is required.", "solution": "The objective is to apply LD clumping to select approximately independent index SNPs and then assign the PRS weights equal to their GWAS effect sizes. We start from the definition of the polygenic risk score as $ \\sum_{i} w_{i} G_{i} $, with weights $ w_{i} $ typically taken as the marginal GWAS effect sizes under a linear combination model, and from the definition of LD clumping based on removing SNPs in high squared correlation $ r^{2} $ with a chosen index SNP.\n\nStep 1: Apply the inclusion $ p $-value threshold $ p_{\\max} = 5.0 \\times 10^{-4} $. The SNPs with $ p_{i} \\leq p_{\\max} $ are:\n- $ G_{5} $ with $ p_{5} = 8.0 \\times 10^{-8} $,\n- $ G_{2} $ with $ p_{2} = 1.0 \\times 10^{-5} $,\n- $ G_{4} $ with $ p_{4} = 1.2 \\times 10^{-4} $,\n- $ G_{1} $ with $ p_{1} = 3.0 \\times 10^{-4} $.\nThe SNPs $ G_{3} $ and $ G_{6} $ are excluded since $ p_{3} = 3.0 \\times 10^{-3} $ and $ p_{6} = 9.0 \\times 10^{-4} $ exceed $ p_{\\max} $.\n\nStep 2: Rank the included SNPs by ascending $ p $-value:\n- First: $ G_{5} $ ($ p_{5} = 8.0 \\times 10^{-8} $),\n- Second: $ G_{2} $ ($ p_{2} = 1.0 \\times 10^{-5} $),\n- Third: $ G_{4} $ ($ p_{4} = 1.2 \\times 10^{-4} $),\n- Fourth: $ G_{1} $ ($ p_{1} = 3.0 \\times 10^{-4} $).\n\nStep 3: Iterative clumping with threshold $ r_{\\text{thr}}^{2} = 0.20 $.\n- Select $ G_{5} $ as the first index SNP. Compute $ r_{5j}^{2} $ for each remaining SNP $ j \\in \\{2,4,1\\} $ using the LD matrix:\n  - $ r_{5,2} = 0.65 \\Rightarrow r_{5,2}^{2} = 0.65^{2} = 0.4225 \\geq 0.20 $, so remove $ G_{2} $.\n  - $ r_{5,4} = 0.35 \\Rightarrow r_{5,4}^{2} = 0.35^{2} = 0.1225  0.20 $, so keep $ G_{4} $.\n  - $ r_{5,1} = 0.48 \\Rightarrow r_{5,1}^{2} = 0.48^{2} = 0.2304 \\geq 0.20 $, so remove $ G_{1} $.\n  After this step, the remaining SNP set is $ \\{ G_{4} \\} $.\n- Select $ G_{4} $ as the second index SNP. There are no other SNPs left to evaluate for removal.\n\nThus, the selected index SNPs, in order of selection, are $ G_{5} $ followed by $ G_{4} $.\n\nStep 4: Assign PRS weights $ w_{i} = \\hat{\\beta}_{i} $ for the selected index SNPs, using the provided GWAS effect sizes:\n- For $ G_{5} $, $ \\hat{\\beta}_{5} = 0.13 $, so $ w_{5} = 0.13 $.\n- For $ G_{4} $, $ \\hat{\\beta}_{4} = 0.05 $, so $ w_{4} = 0.05 $.\n\nReport the weights in the order of selection as a single row matrix. Therefore, the PRS weights vector is\n$$\n\\begin{pmatrix}\n0.13  0.05\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.13  0.05\\end{pmatrix}}$$", "id": "4369034"}, {"introduction": "Real-world genomic data is rarely perfect, and an individual's true genotype at every variant is not always known with certainty. This challenge is addressed through genotype imputation, which provides probabilities for carrying 0, 1, or 2 copies of an allele instead of a definite count. This practice demonstrates how to incorporate this uncertainty by calculating an \"expected\" allele dosage to compute a more accurate PRS [@problem_id:4369030]. You will also learn the importance of mean-centering the score against a reference population's average genetic risk, a crucial step for unbiased interpretation.", "problem": "In a case-control study of a complex disease, risk is modeled on the log-odds scale using an additive genetic architecture across independent biallelic loci. Consider three single-nucleotide variants indexed by $j \\in \\{1,2,3\\}$, each with a per-allele log-odds effect size $\\beta_{j}$ and an imputed genotype for one individual summarized by the posterior probabilities $\\big(P_{j,0},P_{j,1},P_{j,2}\\big)$ for carrying $0$, $1$, or $2$ copies of the minor allele. Assume a reference population in Hardy–Weinberg equilibrium with minor-allele frequency $f_{j}$ at each locus.\n\nStarting from the definition of the expectation of a discrete random variable and the Hardy–Weinberg principle for genotype frequencies, construct the individual’s mean-centered Polygenic Risk Score (PRS) on the log-odds scale relative to the reference population by: (i) replacing each unobserved genotype count with its conditional expectation given the imputation posterior, and (ii) subtracting the population mean genotype count at each locus. Then, evaluate this mean-centered PRS numerically for the following data:\n- Per-allele log-odds effect sizes: $\\beta_{1}=0.15$, $\\beta_{2}=-0.07$, $\\beta_{3}=0.04$.\n- Imputation posterior probabilities:\n  - Locus $1$: $\\big(P_{1,0},P_{1,1},P_{1,2}\\big)=\\big(0.02,0.18,0.80\\big)$,\n  - Locus $2$: $\\big(P_{2,0},P_{2,1},P_{2,2}\\big)=\\big(0.60,0.35,0.05\\big)$,\n  - Locus $3$: $\\big(P_{3,0},P_{3,1},P_{3,2}\\big)=\\big(0.10,0.30,0.60\\big)$.\n- Reference population minor-allele frequencies: $f_{1}=0.45$, $f_{2}=0.20$, $f_{3}=0.40$.\n\nProvide the final numerical value of the mean-centered PRS as a single real number. Round your answer to four significant figures. No units are required.", "solution": "A Polygenic Risk Score (PRS) under an additive model is a weighted sum of allele counts across multiple genetic loci. On the log-odds scale, the score is given by $PRS = \\sum_{j} \\beta_j G_j$, where $\\beta_j$ is the per-allele effect size and $G_j$ is the genotype count. The problem requires constructing a mean-centered PRS, which adjusts the individual's score by the population average:\n$$\nPRS_{centered} = \\sum_{j} \\beta_j (G_{j, \\text{ind}} - E[G_{j, \\text{pop}}])\n$$\n\n**Step 1: Calculate the individual's expected genotype count ($\\hat{G}_j$) for each locus.**\nSince the individual's genotypes are imputed, we replace the unknown count $G_{j, \\text{ind}}$ with its conditional expectation given the posterior probabilities $(P_{j,0}, P_{j,1}, P_{j,2})$:\n$$\n\\hat{G}_j = E[G_j | \\text{data}] = (0 \\cdot P_{j,0}) + (1 \\cdot P_{j,1}) + (2 \\cdot P_{j,2}) = P_{j,1} + 2P_{j,2}\n$$\n- For Locus 1: $\\hat{G}_1 = 0.18 + 2(0.80) = 1.78$\n- For Locus 2: $\\hat{G}_2 = 0.35 + 2(0.05) = 0.45$\n- For Locus 3: $\\hat{G}_3 = 0.30 + 2(0.60) = 1.50$\n\n**Step 2: Calculate the population mean genotype count ($E[G_{j, \\text{pop}}]$) for each locus.**\nFor a population in Hardy-Weinberg equilibrium (HWE) with minor-allele frequency $f_j$, the mean genotype count is simply $2f_j$.\n- For Locus 1: $E[G_{1, \\text{pop}}] = 2f_1 = 2(0.45) = 0.90$\n- For Locus 2: $E[G_{2, \\text{pop}}] = 2f_2 = 2(0.20) = 0.40$\n- For Locus 3: $E[G_{3, \\text{pop}}] = 2f_3 = 2(0.40) = 0.80$\n\n**Step 3: Calculate the total mean-centered PRS.**\nWe sum the contributions from each locus using the formula $\\beta_j (\\hat{G}_j - 2f_j)$:\n$$\nPRS_{centered} = \\beta_1(\\hat{G}_1 - 2f_1) + \\beta_2(\\hat{G}_2 - 2f_2) + \\beta_3(\\hat{G}_3 - 2f_3)\n$$\n$$\nPRS_{centered} = 0.15(1.78 - 0.90) + (-0.07)(0.45 - 0.40) + 0.04(1.50 - 0.80)\n$$\n$$\nPRS_{centered} = 0.15(0.88) - 0.07(0.05) + 0.04(0.70)\n$$\n$$\nPRS_{centered} = 0.132 - 0.0035 + 0.028 = 0.1565\n$$\n\nThe final answer, rounded to four significant figures, is $0.1565$.", "answer": "$$ \\boxed{0.1565} $$", "id": "4369030"}]}