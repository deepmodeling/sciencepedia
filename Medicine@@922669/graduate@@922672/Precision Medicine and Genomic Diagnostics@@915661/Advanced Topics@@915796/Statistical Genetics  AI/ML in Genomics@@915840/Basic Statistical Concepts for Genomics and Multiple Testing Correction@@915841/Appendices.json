{"hands_on_practices": [{"introduction": "Before exploring solutions, it is essential to understand the scale of the multiple testing problem. This first exercise uses a hypothetical genomic screen to quantify what happens when thousands of statistical tests are performed without any form of correction [@problem_id:4317840]. By deriving the expected number of false positives from first principles, you will gain a concrete appreciation for why conventional significance thresholds like $p  0.05$ are insufficient for high-throughput data analysis.", "problem": "In a high-throughput genomic diagnostic screen relevant to precision medicine, suppose a laboratory evaluates $m=10{,}000$ independent hypotheses, each corresponding to a distinct variant’s association with a therapy response phenotype. For the purpose of quantifying the baseline false positive behavior of an unadjusted analysis, assume that all null hypotheses are true and that the computed $p$-values are independent and exactly uniformly distributed on $[0,1]$ under the null. The laboratory plans to call a variant a discovery if its unadjusted $p$-value is at most the fixed threshold $\\alpha=0.001$.\n\nStarting only from the definitions that under a true null the $p$-value has distribution $\\mathrm{Uniform}(0,1)$, that independence across tests holds, and that the Family-Wise Error Rate (FWER) is the probability of at least one false discovery across the family of tests, derive from first principles:\n- the expected number of unadjusted discoveries at threshold $\\alpha$, and\n- the Family-Wise Error Rate (FWER) at threshold $\\alpha$.\n\nExpress your final answer as a single ordered pair $\\left(E, F\\right)$, where $E$ is the expected number of unadjusted discoveries and $F$ is the FWER. No rounding is required, and no units are needed.", "solution": "The user wants to solve a problem about statistical metrics in genomics.\n\n### Step 1: Problem Validation\n\nI will first validate the problem statement according to the specified procedure.\n\n#### Step 1.1: Extract Givens\n\n-   Number of independent hypotheses: $m=10{,}000$\n-   Condition: All null hypotheses are true.\n-   Distribution of p-values: Independent and identically distributed as $\\mathrm{Uniform}(0,1)$.\n-   Discovery threshold: A discovery is declared if the p-value is at most $\\alpha=0.001$.\n-   Definition of Family-Wise Error Rate (FWER): The probability of at least one false discovery.\n-   Required output: Derive from first principles (a) the expected number of unadjusted discoveries, $E$, and (b) the Family-Wise Error Rate, $F$.\n\n#### Step 1.2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded:** The problem is firmly grounded in the fundamental principles of statistical hypothesis testing, specifically in the context of multiple comparisons. The assumptions—that under the null hypothesis, p-values are independent and follow a $\\mathrm{Uniform}(0,1)$ distribution—are cornerstones of this field. The scenario described (the \"global null\" where all nulls are true) is a standard theoretical construct used to evaluate the worst-case performance of a multiple testing procedure in terms of Type I error control.\n-   **Well-Posed:** The problem is well-posed. It provides all necessary parameters ($m$, $\\alpha$), distributions, and definitions to uniquely determine the quantities of interest ($E$ and $F$).\n-   **Objective:** The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n-   **Completeness and Consistency:** The setup is complete and internally consistent. No information is missing, and no constraints are contradictory.\n-   **Realism:** The values for the number of tests ($m=10{,}000$) and the significance threshold ($\\alpha=0.001$) are realistic for high-throughput screening in genomics.\n-   **Conclusion:** The problem is valid. It is a standard, fundamental problem in biostatistics that tests core concepts.\n\n### Step 2: Derivation of the Solution\n\nSince the problem is valid, I will now derive the required quantities from first principles.\n\n#### Derivation of the Expected Number of Discoveries ($E$)\n\nLet $p_i$ denote the p-value for the $i$-th hypothesis, where $i \\in \\{1, 2, \\ldots, m\\}$. We are given that $p_i \\sim \\mathrm{Uniform}(0,1)$.\n\nA discovery is made for hypothesis $i$ if its p-value satisfies $p_i \\le \\alpha$. Let us define an indicator random variable, $D_i$, for this event:\n$$\nD_i = \n\\begin{cases} \n1  \\text{if } p_i \\le \\alpha \\\\\n0  \\text{if } p_i  \\alpha \n\\end{cases}\n$$\nThe variable $D_i$ follows a Bernoulli distribution, $D_i \\sim \\mathrm{Bernoulli}(\\pi)$, where the success probability $\\pi$ is the probability of making a discovery for a single test. This probability is given by:\n$$\n\\pi = P(D_i = 1) = P(p_i \\le \\alpha)\n$$\nSince $p_i$ is uniformly distributed on the interval $[0,1]$, its cumulative distribution function (CDF) is $F(x) = x$ for $x \\in [0,1]$. Therefore,\n$$\n\\pi = P(p_i \\le \\alpha) = \\int_{0}^{\\alpha} 1 \\, dx = \\alpha\n$$\nThe expected value of this Bernoulli random variable is $E[D_i] = \\pi = \\alpha$.\n\nThe total number of discoveries, which we can denote by $V$, is the sum of the individual indicator variables over all $m$ tests:\n$$\nV = \\sum_{i=1}^{m} D_i\n$$\nThe expected number of unadjusted discoveries, $E$, is the expectation of $V$. By the linearity of expectation, we have:\n$$\nE = E[V] = E\\left[\\sum_{i=1}^{m} D_i\\right] = \\sum_{i=1}^{m} E[D_i]\n$$\nSince $E[D_i] = \\alpha$ for all $i$, the sum becomes:\n$$\nE = \\sum_{i=1}^{m} \\alpha = m \\alpha\n$$\nSubstituting the given values $m = 10{,}000$ and $\\alpha = 0.001$:\n$$\nE = 10{,}000 \\times 0.001 = 10\n$$\n\n#### Derivation of the Family-Wise Error Rate (FWER)\n\nThe problem states that all null hypotheses are true. Consequently, any discovery is, by definition, a false discovery (a Type I error). The FWER is defined as the probability of making at least one false discovery.\n$$\n\\text{FWER} = P(\\text{at least one discovery}) = P(V \\ge 1)\n$$\nIt is more direct to calculate the probability of the complementary event, which is making zero discoveries, $P(V=0)$.\n$$\nP(V=0) = P(D_1=0 \\text{ and } D_2=0 \\text{ and } \\ldots \\text{ and } D_m=0)\n$$\nThe probability of not making a discovery on a single test is:\n$$\nP(D_i = 0) = P(p_i  \\alpha) = 1 - P(p_i \\le \\alpha) = 1 - \\alpha\n$$\nThe problem states that the p-values are independent. This implies that the events $\\{D_i=0\\}$ are also independent across all $i$. Therefore, the probability of all $m$ tests yielding no discovery is the product of their individual probabilities:\n$$\nP(V=0) = \\prod_{i=1}^{m} P(D_i=0) = \\prod_{i=1}^{m} (1-\\alpha) = (1-\\alpha)^m\n$$\nThe FWER, which we denote as $F$, is then:\n$$\nF = \\text{FWER} = 1 - P(V=0) = 1 - (1-\\alpha)^m\n$$\nSubstituting the given values $m = 10{,}000$ and $\\alpha = 0.001$:\n$$\nF = 1 - (1 - 0.001)^{10000} = 1 - (0.999)^{10000}\n$$\nThe problem does not require a numerical approximation, so this exact form is the final expression for the FWER.\n\nThe final answer is the ordered pair $(E, F)$.\n$$\nE = 10\n$$\n$$\nF = 1 - (0.999)^{10000}\n$$", "answer": "$$\n\\boxed{\n(10, 1 - (0.999)^{10000})\n}\n$$", "id": "4317840"}, {"introduction": "The most direct response to the challenge of multiple testing is to control the probability of making even one false positive across all tests, a metric known as the Family-Wise Error Rate (FWER). This practice guides you through the derivation of two foundational methods for FWER control: the universally applicable Bonferroni correction and the slightly more powerful Šidák correction, which assumes independence [@problem_id:4317801]. Comparing these methods reveals the fundamental trade-off between a procedure's underlying assumptions and its statistical power.", "problem": "A precision medicine genome-wide association study evaluates the relationship between germline Single-Nucleotide Polymorphisms (SNPs) and a quantitative phenotype. Suppose there are $m=1{,}000{,}000$ hypothesis tests, and the study aims to control the Family-Wise Error Rate (FWER) at level $\\alpha=0.05$ across all tests.\n\nStarting from first principles, use only the definition of FWER as the probability of at least one false positive among all true null hypotheses and basic probability laws to:\n\n1) Derive the per-test $p$-value cutoff for a procedure that controls FWER using an inequality that does not require any assumptions about dependence among tests (the Bonferroni procedure).\n\n2) Derive the per-test $p$-value cutoff for a procedure that controls FWER exactly under the assumption that the $m$ tests are mutually independent (the Šidák procedure).\n\nThen, evaluate both cutoffs numerically for $m=1{,}000{,}000$ and $\\alpha=0.05$, and briefly compare their stringency for discovery in terms of which threshold is more conservative and by approximately how much on a relative scale. Round your two numerical cutoffs to four significant figures. Express the final thresholds as $p$-value cutoffs (unitless).", "solution": "The Family-Wise Error Rate (FWER) is defined as the probability of at least one false positive among all tests of true null hypotheses. Let $V$ be the number of false positives and let $A_{i}$ be the event of a false positive on test $i$. Then\n$$\n\\mathrm{FWER}=\\mathbb{P}(V\\geq 1)=\\mathbb{P}\\Big(\\bigcup_{i=1}^{m}A_{i}\\Big).\n$$\n\nBonferroni procedure (valid without dependence assumptions):\nBy the union bound (subadditivity of probability), for any events $A_{1},\\dots,A_{m}$,\n$$\n\\mathbb{P}\\Big(\\bigcup_{i=1}^{m}A_{i}\\Big)\\leq \\sum_{i=1}^{m}\\mathbb{P}(A_{i}).\n$$\nIf each test uses a per-test significance cutoff $t$ (i.e., rejects when $p_{i}\\leq t$), then under true nulls $\\mathbb{P}(A_{i}) = t$. Therefore,\n$$\n\\mathrm{FWER}\\leq \\sum_{i=1}^{m} t = m t.\n$$\nTo ensure $\\mathrm{FWER}\\leq \\alpha$, it suffices to set $m t \\leq \\alpha$, yielding the Bonferroni threshold\n$$\nt_{\\mathrm{Bonf}}=\\frac{\\alpha}{m}.\n$$\n\nŠidák procedure (exact under independence):\nAssume the $m$ tests are mutually independent and each has per-test cutoff $t$. Under the global null, the probability that no false positive occurs is the product of the probabilities that each individual null is not falsely rejected:\n$$\n\\mathbb{P}(V=0)=\\prod_{i=1}^{m} \\mathbb{P}(A_{i}^{c})=(1-t)^{m}.\n$$\nHence\n$$\n\\mathrm{FWER}=\\mathbb{P}(V\\geq 1)=1-\\mathbb{P}(V=0)=1-(1-t)^{m}.\n$$\nTo achieve $\\mathrm{FWER}=\\alpha$, we solve $1-(1-t)^{m}=\\alpha$, which gives the Šidák threshold\n$$\nt_{\\mathrm{Sidak}}=1-(1-\\alpha)^{1/m}.\n$$\n\nNumerical evaluation for $m=1{,}000{,}000$ and $\\alpha=0.05$:\nFirst, the Bonferroni cutoff is\n$$\nt_{\\mathrm{Bonf}}=\\frac{0.05}{1{,}000{,}000}=5.0\\times 10^{-8}.\n$$\nNext, the Šidák cutoff is\n$$\nt_{\\mathrm{Sidak}}=1-(1-0.05)^{1/1{,}000{,}000}=1-0.95^{10^{-6}}.\n$$\nUsing the natural logarithm to evaluate $0.95^{10^{-6}}$,\n$$\n0.95^{10^{-6}}=\\exp\\!\\big(10^{-6}\\ln(0.95)\\big),\n$$\nwith $\\ln(0.95)=-0.0512932943875\\ldots$, so\n$$\n10^{-6}\\ln(0.95)=-5.12932943875\\ldots\\times 10^{-8}.\n$$\nFor such a small magnitude, using the approximation $\\exp(x) \\approx 1+x+\\frac{x^{2}}{2}$, hence\n$$\n0.95^{10^{-6}}=\\exp\\!\\big(-5.1293\\ldots\\times 10^{-8}\\big)\\approx 1-5.12932943875\\times 10^{-8}+\\frac{(5.12932943875\\times 10^{-8})^{2}}{2},\n$$\nand the quadratic correction is approximately $1.315\\times 10^{-15}$, negligible at four significant figures. Therefore\n$$\nt_{\\mathrm{Sidak}}\\approx 5.1293294386\\times 10^{-8}.\n$$\nRounding both thresholds to four significant figures gives\n$$\nt_{\\mathrm{Bonf}}=5.000\\times 10^{-8},\\quad t_{\\mathrm{Sidak}}=5.129\\times 10^{-8}.\n$$\n\nInterpretation of stringency for discovery:\nBoth procedures control the Family-Wise Error Rate at $\\alpha=0.05$ across $m=1{,}000{,}000$ tests, leading to extremely small per-test cutoffs typical of genome-wide scans. The Bonferroni cutoff is slightly smaller than the Šidák cutoff, hence more stringent (more conservative). The relative difference is approximately\n$$\n\\frac{t_{\\mathrm{Sidak}}-t_{\\mathrm{Bonf}}}{t_{\\mathrm{Bonf}}}\\approx \\frac{5.129\\times 10^{-8}-5.000\\times 10^{-8}}{5.000\\times 10^{-8}}\\approx 2.58\\times 10^{-2},\n$$\nthat is, about a 2.6 percent increase in the allowable $p$-value under the independence-based Šidák correction. In practice, genomic tests exhibit dependence due to linkage disequilibrium, so both thresholds tend to be conservative relative to the effective number of independent tests, with Bonferroni being the more conservative of the two.", "answer": "$$\\boxed{(5.000 \\times 10^{-8}, 5.129 \\times 10^{-8})}$$", "id": "4317801"}, {"introduction": "In many genomic studies, controlling the *proportion* of false discoveries among all reported discoveries is a more practical and powerful goal than eliminating them entirely. This exercise introduces the concept of the False Discovery Rate (FDR) and the seminal Benjamini-Hochberg (BH) and Benjamini-Yekutieli (BY) procedures used to control it [@problem_id:4317734]. Applying these methods will provide direct insight into how controlling FDR can lead to more discoveries than controlling FWER, and how assumptions about statistical dependence among tests influence the outcome.", "problem": "A targeted germline sequencing study in precision oncology evaluates $m=8$ candidate genes for association with a binary clinical endpoint, yielding ordered $p$-values $p_{(1)} \\leq p_{(2)} \\leq \\cdots \\leq p_{(8)}$. The ordered $p$-values are\n$$\np_{(1)}=0.004,\\; p_{(2)}=0.006,\\; p_{(3)}=0.011,\\; p_{(4)}=0.018,\\; p_{(5)}=0.032,\\; p_{(6)}=0.041,\\; p_{(7)}=0.072,\\; p_{(8)}=0.12.\n$$\nAt nominal level $\\alpha=0.1$, apply two step-up multiple testing procedures that control the False Discovery Rate (FDR): the Benjamini–Hochberg (BH) procedure, which controls FDR under independence or certain positive dependence structures, and the Benjamini–Yekutieli (BY) procedure, which controls FDR under arbitrary dependence. Determine, for each procedure, which hypotheses are rejected at level $\\alpha$, and let $D_{\\mathrm{BH}}$ and $D_{\\mathrm{BY}}$ denote the number of rejections under BH and BY, respectively. Report the single numerical value $D_{\\mathrm{BH}}-D_{\\mathrm{BY}}$. Express your final answer as an integer. No rounding is required.", "solution": "The user provided a valid problem statement.\n\n### Step 1: Extract Givens\n- Number of hypotheses being tested: $m=8$.\n- Ordered $p$-values: $p_{(1)}=0.004, p_{(2)}=0.006, p_{(3)}=0.011, p_{(4)}=0.018, p_{(5)}=0.032, p_{(6)}=0.041, p_{(7)}=0.072, p_{(8)}=0.12$.\n- Desired False Discovery Rate (FDR) control level: $\\alpha=0.1$.\n- Procedures to apply: Benjamini–Hochberg (BH) and Benjamini–Yekutieli (BY).\n- Quantities to determine: $D_{\\mathrm{BH}}$, the number of rejections under the BH procedure, and $D_{\\mathrm{BY}}$, the number of rejections under the BY procedure.\n- Final value to report: $D_{\\mathrm{BH}} - D_{\\mathrm{BY}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard application of two fundamental statistical procedures for multiple testing correction, which are central to genomic data analysis. All necessary data are provided, the terminology is precise, and the setup is free from any contradictions, ambiguities, or factual inaccuracies. The problem requires a direct and rigorous application of established algorithms, leading to a unique, verifiable solution.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe problem requires the application of two distinct multiple hypothesis testing procedures, the Benjamini-Hochberg (BH) and Benjamini-Yekutieli (BY) procedures, to control the False Discovery Rate (FDR) at a nominal level $\\alpha=0.1$. We are given $m=8$ ordered $p$-values from a genomic study.\n\nFirst, we apply the Benjamini-Hochberg (BH) procedure. This is a step-up procedure that controls FDR under the assumption that the tests are independent or satisfy positive regression dependency. The procedure is as follows: given the ordered $p$-values $p_{(1)} \\leq p_{(2)} \\leq \\cdots \\leq p_{(m)}$, we find the largest integer $k$ such that\n$$p_{(k)} \\leq \\frac{k}{m} \\alpha$$\nIf such a $k$ exists, we reject the null hypotheses corresponding to the $p$-values $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$. The number of rejections is $D_{\\mathrm{BH}} = k$. If no such $k$ exists, no hypotheses are rejected.\n\nIn this problem, $m=8$ and $\\alpha=0.1$. The BH threshold for each ordered $p$-value $p_{(k)}$ is $\\frac{k}{8}(0.1) = 0.0125 \\cdot k$. Let us test the condition for each $k$ from $k=1$ to $k=8$.\n\nFor $k=1$: $p_{(1)} = 0.004$. The threshold is $0.0125 \\times 1 = 0.0125$. Since $0.004 \\leq 0.0125$, the condition holds.\nFor $k=2$: $p_{(2)} = 0.006$. The threshold is $0.0125 \\times 2 = 0.025$. Since $0.006 \\leq 0.025$, the condition holds.\nFor $k=3$: $p_{(3)} = 0.011$. The threshold is $0.0125 \\times 3 = 0.0375$. Since $0.011 \\leq 0.0375$, the condition holds.\nFor $k=4$: $p_{(4)} = 0.018$. The threshold is $0.0125 \\times 4 = 0.05$. Since $0.018 \\leq 0.05$, the condition holds.\nFor $k=5$: $p_{(5)} = 0.032$. The threshold is $0.0125 \\times 5 = 0.0625$. Since $0.032 \\leq 0.0625$, the condition holds.\nFor $k=6$: $p_{(6)} = 0.041$. The threshold is $0.0125 \\times 6 = 0.075$. Since $0.041 \\leq 0.075$, the condition holds.\nFor $k=7$: $p_{(7)} = 0.072$. The threshold is $0.0125 \\times 7 = 0.0875$. Since $0.072 \\leq 0.0875$, the condition holds.\nFor $k=8$: $p_{(8)} = 0.12$. The threshold is $0.0125 \\times 8 = 0.1$. Since $0.12  0.1$, the condition does not hold.\n\nThe largest value of $k$ for which the condition $p_{(k)} \\leq \\frac{k}{m} \\alpha$ is satisfied is $k=7$. Therefore, under the BH procedure, we reject the null hypotheses corresponding to the $7$ smallest $p$-values. The number of rejected hypotheses is $D_{\\mathrm{BH}} = 7$.\n\nNext, we apply the Benjamini-Yekutieli (BY) procedure. This procedure is more stringent and controls the FDR under arbitrary dependence structures among the tests. It modifies the BH procedure by introducing a correction factor, $C(m)$, which is the $m$-th harmonic number. The procedure is as follows: find the largest integer $k$ such that\n$$p_{(k)} \\leq \\frac{k}{m \\cdot C(m)} \\alpha$$\nwhere $C(m) = \\sum_{i=1}^{m} \\frac{1}{i}$. The number of rejections is $D_{\\mathrm{BY}}=k$.\n\nFor $m=8$, the correction factor is $C(8) = H_8$, the $8$-th harmonic number.\n$$C(8) = \\sum_{i=1}^{8} \\frac{1}{i} = \\frac{1}{1} + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} + \\frac{1}{6} + \\frac{1}{7} + \\frac{1}{8}$$\nCalculating this sum using a common denominator of $840$:\n$$C(8) = \\frac{840}{840} + \\frac{420}{840} + \\frac{280}{840} + \\frac{210}{840} + \\frac{168}{840} + \\frac{140}{840} + \\frac{120}{840} + \\frac{105}{840} = \\frac{840+420+280+210+168+140+120+105}{840} = \\frac{2283}{840} = \\frac{761}{280}$$\nIn decimal form, $C(8) \\approx 2.717857$.\nThe BY threshold for each ordered $p$-value $p_{(k)}$ is $\\frac{k}{m \\cdot C(m)} \\alpha = \\frac{k}{8 \\cdot (761/280)} (0.1) = \\frac{k \\cdot 0.1}{(761/35)} = \\frac{3.5 \\cdot k}{761}$.\n\nLet us test the condition for each $k$:\nThreshold for $k$: $T_k = \\frac{3.5k}{761}$.\nFor $k=1$: $p_{(1)} = 0.004$. Threshold is $T_1 = \\frac{3.5}{761} \\approx 0.004599$. Since $0.004 \\leq T_1$, the condition holds.\nFor $k=2$: $p_{(2)} = 0.006$. Threshold is $T_2 = \\frac{7.0}{761} \\approx 0.009198$. Since $0.006 \\leq T_2$, the condition holds.\nFor $k=3$: $p_{(3)} = 0.011$. Threshold is $T_3 = \\frac{10.5}{761} \\approx 0.013798$. Since $0.011 \\leq T_3$, the condition holds.\nFor $k=4$: $p_{(4)} = 0.018$. Threshold is $T_4 = \\frac{14.0}{761} \\approx 0.018397$. Since $0.018 \\leq T_4$, the condition holds.\nFor $k=5$: $p_{(5)} = 0.032$. Threshold is $T_5 = \\frac{17.5}{761} \\approx 0.022996$. Since $0.032  T_5$, the condition does not hold.\nSince the condition fails for $k=5$, we do not need to check for $k  5$.\n\nThe largest value of $k$ for which the condition $p_{(k)} \\leq \\frac{k}{m \\cdot C(m)} \\alpha$ is satisfied is $k=4$. Therefore, under the BY procedure, we reject the null hypotheses corresponding to the $4$ smallest $p$-values. The number of rejected hypotheses is $D_{\\mathrm{BY}} = 4$.\n\nThe problem asks for the value of $D_{\\mathrm{BH}} - D_{\\mathrm{BY}}$.\n$D_{\\mathrm{BH}} = 7$\n$D_{\\mathrm{BY}} = 4$\nThe difference is $D_{\\mathrm{BH}} - D_{\\mathrm{BY}} = 7 - 4 = 3$.", "answer": "$$\\boxed{3}$$", "id": "4317734"}]}