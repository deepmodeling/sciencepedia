{"hands_on_practices": [{"introduction": "The cornerstone of Mendelian randomization is the use of a genetic variant as an instrumental variable to infer causality. In the simplest scenario involving a single genetic instrument, the causal effect is estimated using the Wald ratio. This exercise provides a foundational opportunity to compute this estimate and, just as importantly, to quantify its statistical uncertainty using the delta method, a versatile tool for error propagation in non-linear functions of random variables [@problem_id:4357996].", "problem": "A precision medicine study in genomic diagnostics aims to estimate the causal effect of a standardized plasma biomarker $X$ on a standardized disease trait $Y$ using Mendelian Randomization (MR). A single genetic variant $G$ (a Single-Nucleotide Polymorphism, SNP) is used as an instrument. Assume the following core instrumental variable assumptions hold: relevance ($G$ associates with $X$), independence ($G$ is independent of confounders of $X$ and $Y$), and exclusion restriction ($G$ affects $Y$ only through $X$). The associations are estimated in a two-sample setting with independent sampling errors and large-sample normality. Let $\\hat{\\beta}_{GX}$ denote the estimated association of $G$ with $X$ and $\\hat{\\beta}_{GY}$ the estimated association of $G$ with $Y$. You are given $\\hat{\\beta}_{GX} = 0.08$ (standard deviation units per allele), $\\hat{\\beta}_{GY} = -0.016$ (standard deviation units per allele), $\\text{SE}(\\hat{\\beta}_{GX}) = 0.01$ and $\\text{SE}(\\hat{\\beta}_{GY}) = 0.005$, where $\\text{SE}$ denotes Standard Error. \n\nUnder the linear structural model consistent with the assumptions above, compute the Wald estimator of the causal effect of $X$ on $Y$ and its standard error using the first-order multivariate delta method, assuming independence of $\\hat{\\beta}_{GX}$ and $\\hat{\\beta}_{GY}$. Round both the estimator and its standard error to four significant figures. Express your final answer as a two-entry row vector $\\begin{pmatrix}\\text{estimate}  \\text{standard error}\\end{pmatrix}$ with no units.", "solution": "The goal is to estimate the causal effect of $X$ on $Y$ using Mendelian Randomization (MR) with a single instrument $G$. Under the instrumental variable assumptions—relevance, independence, and exclusion restriction—and a linear structural model, the causal effect at the population level is identified by the ratio of the instrument–outcome association to the instrument–exposure association. The corresponding sample estimator is the Wald estimator, which is the ratio of the estimated associations.\n\nLet $\\hat{\\beta}_{GX}$ denote the estimated association of $G$ with $X$ and $\\hat{\\beta}_{GY}$ the estimated association of $G$ with $Y$. The Wald estimator is\n$$\n\\hat{\\beta}_{YX}^{\\text{Wald}} = \\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}}.\n$$\nWith $\\hat{\\beta}_{GX} = 0.08$ and $\\hat{\\beta}_{GY} = -0.016$, we compute\n$$\n\\hat{\\beta}_{YX}^{\\text{Wald}} = \\frac{-0.016}{0.08} = -0.2.\n$$\n\nNext, we compute the standard error of the ratio estimator using the first-order multivariate delta method. Define the function $g(a,b) = \\frac{a}{b}$ with $(a,b)$ corresponding to $(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX})$. The gradient of $g$ at $(a,b)$ is\n$$\n\\nabla g(a,b) = \\left( \\frac{\\partial g}{\\partial a}, \\frac{\\partial g}{\\partial b} \\right) = \\left( \\frac{1}{b}, -\\frac{a}{b^{2}} \\right).\n$$\nAssuming the two-sample setting with independent sampling errors so that $\\operatorname{Cov}(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX}) = 0$, and denoting $\\operatorname{Var}(\\hat{\\beta}_{GY}) = \\text{SE}(\\hat{\\beta}_{GY})^{2}$ and $\\operatorname{Var}(\\hat{\\beta}_{GX}) = \\text{SE}(\\hat{\\beta}_{GX})^{2}$, the delta-method approximation to the variance of $g(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX})$ is\n$$\n\\operatorname{Var}\\!\\left(\\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}}\\right) \\approx \\left(\\frac{1}{\\hat{\\beta}_{GX}}\\right)^{2} \\operatorname{Var}(\\hat{\\beta}_{GY}) + \\left(\\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}^{2}}\\right)^{2} \\operatorname{Var}(\\hat{\\beta}_{GX}).\n$$\nSubstituting the given values $\\hat{\\beta}_{GX} = 0.08$, $\\hat{\\beta}_{GY} = -0.016$, $\\text{SE}(\\hat{\\beta}_{GX}) = 0.01$, and $\\text{SE}(\\hat{\\beta}_{GY}) = 0.005$:\n$$\n\\operatorname{Var}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx \\frac{(0.005)^{2}}{(0.08)^{2}} + \\frac{(-0.016)^{2} (0.01)^{2}}{(0.08)^{4}}.\n$$\nCompute each term symbolically, then numerically:\n- First term:\n$$\n\\frac{(0.005)^{2}}{(0.08)^{2}} = \\frac{0.000025}{0.0064} = 0.00390625.\n$$\n- Second term:\n$$\n\\frac{(-0.016)^{2} (0.01)^{2}}{(0.08)^{4}} = \\frac{0.000256 \\times 0.0001}{0.00004096} = \\frac{2.56 \\times 10^{-8}}{4.096 \\times 10^{-5}} = 6.25 \\times 10^{-4} = 0.000625.\n$$\nSumming the two terms,\n$$\n\\operatorname{Var}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx 0.00390625 + 0.000625 = 0.00453125.\n$$\nTherefore, the standard error is\n$$\n\\text{SE}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx \\sqrt{0.00453125} \\approx 0.06731,\n$$\nrounded to four significant figures.\n\nThe Wald estimate itself is exactly $-0.2$, which rounded to four significant figures is $-0.2000$. The requested final answer is the two-entry row vector containing the estimate and its standard error, both rounded to four significant figures and expressed with no units:\n$$\n\\begin{pmatrix}\n-0.2000  0.06731\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-0.2000  0.06731\\end{pmatrix}}$$", "id": "4357996"}, {"introduction": "While single-instrument analyses are instructive, most modern MR studies leverage multiple genetic variants to increase statistical power and the robustness of their conclusions. The standard method for combining information from multiple independent instruments is the Inverse-Variance Weighted (IVW) approach. This practice will guide you through the process of calculating a pooled causal estimate and its confidence interval, demonstrating how to synthesize evidence from several instruments into a single, more precise result [@problem_id:4358027].", "problem": "A research team in precision medicine seeks to estimate the causal effect of a continuous biomarker exposure on a binary disease outcome using Mendelian Randomization (MR). The team has identified four independent Single-Nucleotide Polymorphism (SNP) instruments strongly associated with the exposure and has collected two-sample summary association estimates. For each SNP $j \\in \\{1,2,3,4\\}$, they report the genetic associations with the exposure $\\hat{\\beta}_{GX,j}$ and with the outcome $\\hat{\\beta}_{GY,j}$, along with the corresponding standard errors $\\mathrm{SE}(\\hat{\\beta}_{GX,j})$ and $\\mathrm{SE}(\\hat{\\beta}_{GY,j})$. The MR assumptions of relevance, independence, and exclusion restriction are judged to be plausible, and the samples used for exposure and outcome associations are independent.\n\nThe available summary data are:\n- SNP $1$: $\\hat{\\beta}_{GX,1} = 0.08$, $\\mathrm{SE}(\\hat{\\beta}_{GX,1}) = 0.004$; $\\hat{\\beta}_{GY,1} = 0.032$, $\\mathrm{SE}(\\hat{\\beta}_{GY,1}) = 0.015$.\n- SNP $2$: $\\hat{\\beta}_{GX,2} = 0.12$, $\\mathrm{SE}(\\hat{\\beta}_{GX,2}) = 0.005$; $\\hat{\\beta}_{GY,2} = 0.050$, $\\mathrm{SE}(\\hat{\\beta}_{GY,2}) = 0.020$.\n- SNP $3$: $\\hat{\\beta}_{GX,3} = 0.05$, $\\mathrm{SE}(\\hat{\\beta}_{GX,3}) = 0.003$; $\\hat{\\beta}_{GY,3} = 0.020$, $\\mathrm{SE}(\\hat{\\beta}_{GY,3}) = 0.012$.\n- SNP $4$: $\\hat{\\beta}_{GX,4} = 0.10$, $\\mathrm{SE}(\\hat{\\beta}_{GX,4}) = 0.004$; $\\hat{\\beta}_{GY,4} = 0.036$, $\\mathrm{SE}(\\hat{\\beta}_{GY,4}) = 0.018$.\n\nAssume a linear causal model linking the SNP-outcome association to the product of the SNP-exposure association and a single causal effect parameter, plus random error with variance known up to the reported outcome standard errors, and assume the No Measurement Error (NOME) approximation holds for the exposure associations in the sense that uncertainty in $\\hat{\\beta}_{GX,j}$ is negligible for weighting. Under these assumptions, use the Inverse-Variance Weighted (IVW) approach (weighted least squares through the origin with weights proportional to the inverse of the outcome association variances) to compute:\n- the IVW point estimate of the causal effect, and\n- the corresponding $95\\%$ confidence interval using a normal approximation.\n\nRound each of the three numbers (the point estimate, the lower confidence bound, and the upper confidence bound) to four significant figures. Express your final numerical answers as decimals with no units.", "solution": "The core principle of the Inverse-Variance Weighted (IVW) method is to perform a weighted linear regression of the SNP-outcome associations ($\\hat{\\beta}_{GY,j}$) on the SNP-exposure associations ($\\hat{\\beta}_{GX,j}$), constrained to pass through the origin. The model for each SNP $j$ is:\n$$ \\hat{\\beta}_{GY,j} = \\beta_{IVW} \\hat{\\beta}_{GX,j} + \\epsilon_j $$\nwhere $\\beta_{IVW}$ is the causal effect estimate we seek to find.\n\nThe problem specifies that the weights are proportional to the inverse of the outcome association variances. This, combined with the No Measurement Error (NOME) assumption (i.e., treating $\\hat{\\beta}_{GX,j}$ as fixed and known), leads to the standard IVW estimator. The weight for the $j$-th instrument is $w_j = 1 / \\mathrm{SE}(\\hat{\\beta}_{GY,j})^2$.\n\nThe formula for the IVW point estimate, $\\hat{\\beta}_{IVW}$, is the solution to the weighted least squares problem:\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum_{j=1}^{J} w_j \\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\sum_{j=1}^{J} w_j \\hat{\\beta}_{GX,j}^2} = \\frac{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}}{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}} $$\nwhere $J=4$ is the number of SNPs.\n\nThe standard error of the IVW estimate, assuming the instruments are independent and the NOME assumption holds, is given by:\n$$ \\mathrm{SE}(\\hat{\\beta}_{IVW}) = \\sqrt{\\frac{1}{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}}} $$\n\nWe will calculate the numerator and denominator terms for the $\\hat{\\beta}_{IVW}$ formula for each of the $J=4$ SNPs. Let $N_j = \\frac{\\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}$ and $D_j = \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}$.\n\nFor SNP $1$:\n$\\hat{\\beta}_{GX,1} = 0.08$, $\\hat{\\beta}_{GY,1} = 0.032$, $\\mathrm{SE}(\\hat{\\beta}_{GY,1}) = 0.015$.\n$N_1 = \\frac{0.08 \\times 0.032}{0.015^2} = \\frac{0.00256}{0.000225} = \\frac{512}{45}$\n$D_1 = \\frac{0.08^2}{0.015^2} = \\frac{0.0064}{0.000225} = \\frac{256}{9}$\n\nFor SNP $2$:\n$\\hat{\\beta}_{GX,2} = 0.12$, $\\hat{\\beta}_{GY,2} = 0.050$, $\\mathrm{SE}(\\hat{\\beta}_{GY,2}) = 0.020$.\n$N_2 = \\frac{0.12 \\times 0.050}{0.020^2} = \\frac{0.006}{0.0004} = 15$\n$D_2 = \\frac{0.12^2}{0.020^2} = \\frac{0.0144}{0.0004} = 36$\n\nFor SNP $3$:\n$\\hat{\\beta}_{GX,3} = 0.05$, $\\hat{\\beta}_{GY,3} = 0.020$, $\\mathrm{SE}(\\hat{\\beta}_{GY,3}) = 0.012$.\n$N_3 = \\frac{0.05 \\times 0.020}{0.012^2} = \\frac{0.001}{0.000144} = \\frac{125}{18}$\n$D_3 = \\frac{0.05^2}{0.012^2} = \\frac{0.0025}{0.000144} = \\frac{625}{36}$\n\nFor SNP $4$:\n$\\hat{\\beta}_{GX,4} = 0.10$, $\\hat{\\beta}_{GY,4} = 0.036$, $\\mathrm{SE}(\\hat{\\beta}_{GY,4}) = 0.018$.\n$N_4 = \\frac{0.10 \\times 0.036}{0.018^2} = \\frac{0.0036}{0.000324} = \\frac{100}{9}$\n$D_4 = \\frac{0.10^2}{0.018^2} = \\frac{0.01}{0.000324} = \\frac{2500}{81}$\n\nNow, we sum these terms:\n$$ \\sum_{j=1}^{4} N_j = \\frac{512}{45} + 15 + \\frac{125}{18} + \\frac{100}{9} = \\frac{1024 + 1350 + 625 + 1000}{90} = \\frac{3999}{90} $$\n$$ \\sum_{j=1}^{4} D_j = \\frac{256}{9} + 36 + \\frac{625}{36} + \\frac{2500}{81} = \\frac{9216 + 11664 + 5625 + 10000}{324} = \\frac{36505}{324} $$\n\nThe IVW point estimate is:\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum N_j}{\\sum D_j} = \\frac{3999/90}{36505/324} = \\frac{3999}{90} \\times \\frac{324}{36505} \\approx 0.3943673 $$\nRounding to four significant figures, the point estimate is $0.3944$.\n\nThe standard error of the estimate is:\n$$ \\mathrm{SE}(\\hat{\\beta}_{IVW}) = \\frac{1}{\\sqrt{\\sum D_j}} = \\frac{1}{\\sqrt{36505/324}} \\approx 0.0942103 $$\n\nTo compute the $95\\%$ confidence interval, we use the normal approximation:\n$$ CI_{95\\%} = \\hat{\\beta}_{IVW} \\pm z_{0.975} \\times \\mathrm{SE}(\\hat{\\beta}_{IVW}) $$\nThe critical value from the standard normal distribution for a $95\\%$ confidence level is $z_{0.975} \\approx 1.96$.\n\nThe margin of error is:\n$$ ME = 1.96 \\times 0.0942103 \\approx 0.1846522 $$\n\nThe lower and upper bounds of the confidence interval are:\nLower Bound: $LB = 0.3943673 - 0.1846522 = 0.2097151$\nUpper Bound: $UB = 0.3943673 + 0.1846522 = 0.5790195$\n\nRounding these bounds to four significant figures:\nLower Bound $\\approx 0.2097$\nUpper Bound $\\approx 0.5790$ (the trailing zero is significant)\n\nThe final results, rounded to four significant figures, are:\n-   IVW point estimate: $0.3944$\n-   $95\\%$ CI lower bound: $0.2097$\n-   $95\\%$ CI upper bound: $0.5790$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3944  0.2097  0.5790 \\end{pmatrix}}\n$$", "id": "4358027"}, {"introduction": "A key assumption of the IVW method is that all instruments are valid, meaning they affect the outcome only through the exposure (the \"no horizontal pleiotropy\" assumption). This exercise introduces Cochran's $Q$ statistic, an essential diagnostic test for assessing heterogeneity among the causal estimates from individual instruments. Significant heterogeneity can suggest that one or more instruments are pleiotropic, potentially biasing the IVW estimate, making this test a critical step in evaluating the credibility of an MR analysis [@problem_id:4358003].", "problem": "A two-sample Mendelian randomization analysis is conducted to estimate the causal effect of low-density lipoprotein cholesterol (LDL-C; exposure, denoted $X$) on coronary artery disease risk (outcome, denoted $Y$) using $5$ independent Single Nucleotide Polymorphisms (SNPs). The ratio estimate for SNP $i$ is denoted $\\hat{\\beta}_{i}$ and its inverse-variance weight is $w_{i} = 1/\\operatorname{Var}(\\hat{\\beta}_{i})$. Assume genome-wide association study (GWAS) summary associations were obtained from non-overlapping samples, instruments satisfy relevance, independence, and exclusion restriction, and the sampling model for $\\hat{\\beta}_{i}$ is approximately normal with variance known up to its estimate used in $w_{i}$. Using the inverse-variance weighted (IVW) framework for meta-analysis of ratio estimates and the standard Cochran’s $Q$ heterogeneity statistic, assess instrument heterogeneity.\n\nYou are given the SNP-level data as $5$ pairs $(\\hat{\\beta}_{i}, w_{i})$ for $i=1,\\dots,5$:\n$(\\hat{\\beta}_{1}, w_{1}) = (0.12, 120)$, $(\\hat{\\beta}_{2}, w_{2}) = (0.18, 300)$, $(\\hat{\\beta}_{3}, w_{3}) = (0.09, 180)$, $(\\hat{\\beta}_{4}, w_{4}) = (0.23, 240)$, $(\\hat{\\beta}_{5}, w_{5}) = (0.15, 160)$.\n\nStarting from the core definitions of inverse-variance weighting under normal errors and the definition of Cochran’s $Q$ as the weighted sum of squared deviations from the IVW mean, compute the heterogeneity statistic $Q$ and its upper-tail $p$-value under the chi-square distribution with $k-1$ degrees of freedom, where $k$ is the number of SNPs. Then determine whether the heterogeneity is statistically significant at significance level $\\alpha = 0.05$.\n\nExpress the final answer as the heterogeneity $p$-value rounded to four significant figures, written as a decimal number (no percent sign).", "solution": "The core task is to calculate Cochran's $Q$ statistic, which measures the heterogeneity among the individual SNP-specific causal estimates. The null hypothesis ($H_0$) for the $Q$ test is that all instruments are estimating the same true causal effect, and any observed variation is due to chance (sampling error).\n\nThe first step is to compute the inverse-variance weighted (IVW) pooled estimate of the causal effect, $\\hat{\\beta}_{IVW}$, which is a weighted average of the individual ratio estimates $\\hat{\\beta}_i$. The formula is:\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum_{i=1}^{k} w_i \\hat{\\beta}_i}{\\sum_{i=1}^{k} w_i} $$\nwhere $k=5$ is the number of SNPs.\n\nWe calculate the numerator, the sum of weighted estimates:\n$$ \\sum_{i=1}^{5} w_i \\hat{\\beta}_i = (120)(0.12) + (300)(0.18) + (180)(0.09) + (240)(0.23) + (160)(0.15) $$\n$$ \\sum_{i=1}^{5} w_i \\hat{\\beta}_i = 14.4 + 54.0 + 16.2 + 55.2 + 24.0 = 163.8 $$\n\nNext, we calculate the denominator, the sum of the weights:\n$$ \\sum_{i=1}^{5} w_i = 120 + 300 + 180 + 240 + 160 = 1000 $$\n\nNow, we can compute the IVW estimate:\n$$ \\hat{\\beta}_{IVW} = \\frac{163.8}{1000} = 0.1638 $$\n\nWith the pooled estimate $\\hat{\\beta}_{IVW}$, we can now calculate Cochran's $Q$ statistic. The formula for $Q$ is the weighted sum of squared deviations of the individual estimates from the pooled estimate:\n$$ Q = \\sum_{i=1}^{k} w_i (\\hat{\\beta}_i - \\hat{\\beta}_{IVW})^2 $$\n\nWe compute each term in the summation:\nFor $i=1$: $w_1(\\hat{\\beta}_1 - \\hat{\\beta}_{IVW})^2 = 120(0.12 - 0.1638)^2 = 120(-0.0438)^2 = 120(0.00191844) \\approx 0.2302128$\nFor $i=2$: $w_2(\\hat{\\beta}_2 - \\hat{\\beta}_{IVW})^2 = 300(0.18 - 0.1638)^2 = 300(0.0162)^2 = 300(0.00026244) \\approx 0.0787320$\nFor $i=3$: $w_3(\\hat{\\beta}_3 - \\hat{\\beta}_{IVW})^2 = 180(0.09 - 0.1638)^2 = 180(-0.0738)^2 = 180(0.00544644) \\approx 0.9803592$\nFor $i=4$: $w_4(\\hat{\\beta}_4 - \\hat{\\beta}_{IVW})^2 = 240(0.23 - 0.1638)^2 = 240(0.0662)^2 = 240(0.00438244) \\approx 1.0517856$\nFor $i=5$: $w_5(\\hat{\\beta}_5 - \\hat{\\beta}_{IVW})^2 = 160(0.15 - 0.1638)^2 = 160(-0.0138)^2 = 160(0.00019044) \\approx 0.0304704$\n\nSumming these values gives the $Q$ statistic:\n$$ Q = 0.2302128 + 0.0787320 + 0.9803592 + 1.0517856 + 0.0304704 = 2.37156 $$\n\nUnder the null hypothesis of homogeneity, the $Q$ statistic follows a chi-square ($\\chi^2$) distribution with $k-1$ degrees of freedom. Here, $k=5$, so the degrees of freedom are $df = 5-1=4$.\n\nWe need to find the $p$-value, which is the probability of obtaining a $Q$ value of $2.37156$ or greater from a $\\chi^2$ distribution with $4$ degrees of freedom. This is the upper-tail probability:\n$$ p = P(\\chi^2_4 \\geq 2.37156) $$\n\nUsing a standard statistical software or a $\\chi^2$ distribution table, we find the cumulative distribution function $F(2.37156)$ for $\\chi^2_4$ is approximately $0.3322$. The $p$-value is $1 - F(2.37156)$.\n$$ p = 1 - P(\\chi^2_4  2.37156) \\approx 1 - 0.332201 = 0.667799 $$\n\nRounding the $p$-value to four significant figures gives $0.6678$.\n\nSince $p \\approx 0.6678 > 0.05$, we fail to reject the null hypothesis of homogeneity. This indicates that there is no statistically significant evidence of heterogeneity among the instrument-specific causal estimates at the $5\\%$ significance level.", "answer": "$$ \\boxed{0.6678} $$", "id": "4358003"}]}