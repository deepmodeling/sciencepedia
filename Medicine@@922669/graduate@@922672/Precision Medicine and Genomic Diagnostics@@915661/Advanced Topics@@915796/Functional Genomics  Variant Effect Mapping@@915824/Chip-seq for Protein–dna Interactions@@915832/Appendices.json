{"hands_on_practices": [{"introduction": "Quantitative comparisons of protein binding across different conditions or patient samples are a primary goal of many ChIP-seq experiments. However, technical variability arising from differences in immunoprecipitation efficiency and sequencing depth can obscure true biological changes. This exercise [@problem_id:4321532] demonstrates how to use exogenous spike-in controls—a gold standard for robust normalization—to calculate scaling factors that correct for these technical artifacts, ensuring that downstream comparisons are accurate and meaningful.", "problem": "A laboratory is performing Chromatin Immunoprecipitation followed by high-throughput sequencing (ChIP-seq) to quantify protein-DNA interactions, with a constant amount of exogenous spike-in control chromatin added to each sample prior to immunoprecipitation (IP). The foundational assumption is that, for each sample, the number of spike-in aligned reads is proportional to the sample-specific sequencing depth and global IP yield, while the spike-in input amount is the same across samples. Two samples, labeled sample $\\mathrm{A}$ and sample $\\mathrm{B}$, were processed in parallel with identical protocols and equal spike-in input amounts. After alignment, the spike-in read counts are $1.0 \\times 10^{6}$ for sample $\\mathrm{A}$ and $6.0 \\times 10^{5}$ for sample $\\mathrm{B}$. Raw IP peak read counts (unique alignments to the host genome) for three peaks $p_{1}$, $p_{2}$, and $p_{3}$ are provided as follows: for sample $\\mathrm{A}$, $p_{1}: 15000$, $p_{2}: 6200$, $p_{3}: 3100$; for sample $\\mathrm{B}$, $p_{1}: 9000$, $p_{2}: 4200$, $p_{3}: 2100$.\n\nUsing only the fundamental principle that equal spike-in input amounts imply that observed spike-in counts reflect multiplicative sample-specific scaling factors (library size and IP yield) and that normalization should rescale each sample’s counts so that the spike-in counts match a chosen reference, compute the normalization scaling factors for samples $\\mathrm{A}$ and $\\mathrm{B}$ by taking sample $\\mathrm{A}$’s spike-in as the reference. Then apply these scaling factors to rescale the IP peak counts for both samples.\n\nProvide your final answer as a single row matrix containing, in order: the scaling factor for sample $\\mathrm{A}$, the scaling factor for sample $\\mathrm{B}$, the three rescaled peak counts for sample $\\mathrm{A}$ in the order $p_{1}, p_{2}, p_{3}$, followed by the three rescaled peak counts for sample $\\mathrm{B}$ in the order $p_{1}, p_{2}, p_{3}$. Express all quantities exactly; no rounding is required, and no units should be included in the final answer.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n- **Samples:** Sample $\\mathrm{A}$ and Sample $\\mathrm{B}$.\n- **Spike-in Control:** A constant amount of exogenous spike-in control chromatin is added to each sample. The input amount is identical for both samples.\n- **Spike-in Read Counts:**\n  - Sample $\\mathrm{A}$ ($S_A$): $1.0 \\times 10^{6}$\n  - Sample $\\mathrm{B}$ ($S_B$): $6.0 \\times 10^{5}$\n- **Raw IP Peak Read Counts:**\n  - Sample $\\mathrm{A}$:\n    - Peak $p_{1}^{A}$: $15000$\n    - Peak $p_{2}^{A}$: $6200$\n    - Peak $p_{3}^{A}$: $3100$\n  - Sample $\\mathrm{B}$:\n    - Peak $p_{1}^{B}$: $9000$\n    - Peak $p_{2}^{B}$: $4200$\n    - Peak $p_{3}^{B}$: $2100$\n- **Normalization Principle:** The observed spike-in counts reflect multiplicative sample-specific scaling factors. Normalization rescales each sample’s counts so that the spike-in counts match a chosen reference.\n- **Reference for Normalization:** The spike-in count from sample $\\mathrm{A}$ is the reference.\n- **Task:** Compute normalization scaling factors for samples $\\mathrm{A}$ and $\\mathrm{B}$, and apply these factors to rescale the raw IP peak counts for both samples.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is scientifically sound. The use of exogenous spike-in controls is a standard and robust method for normalizing high-throughput sequencing data, particularly in ChIP-seq, to correct for technical variability such as immunoprecipitation efficiency and sequencing depth. The described principles are fundamental to this technique.\n- **Well-Posed:** The problem is well-posed. All necessary numerical data and the specific normalization procedure are provided. The objective is clearly stated, leading to a unique and meaningful solution.\n- **Objective:** The problem is stated with objective, quantitative language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid as it is scientifically grounded, well-posed, and objective. A solution will be derived.\n\n**Derivation of the Solution**\nLet $R_{raw, i}$ be the raw read count for a given genomic region (either a spike-in control region or a target peak) in sample $i$. This observed count is the product of the true abundance of the target DNA fragment, $T_i$, and a sample-specific efficiency factor, $k_i$. This factor $k_i$ encapsulates all sources of multiplicative bias for sample $i$, including library size and immunoprecipitation (IP) yield.\n$$R_{raw, i} = k_i T_i$$\nThe spike-in DNA is added in an equal amount, $T_{spike}$, to both samples. Therefore, the observed spike-in read counts, $S_A$ and $S_B$, are given by:\n$$S_A = k_A T_{spike}$$\n$$S_B = k_B T_{spike}$$\nThe purpose of normalization is to correct for the different efficiency factors, $k_A$ and $k_B$. We achieve this by calculating a normalization scaling factor, $f_i$, for each sample. This factor is designed to adjust the measured counts such that the spike-in counts for all samples become equal to a chosen reference value, $S_{ref}$.\nThe problem specifies that sample $\\mathrm{A}$'s spike-in count serves as the reference. Thus, $S_{ref} = S_A$.\nThe rescaled count, $R_{norm, i}$, is obtained by multiplying the raw count by the scaling factor:\n$$R_{norm, i} = f_i R_{raw, i}$$\nFor the spike-in counts, the normalization condition is:\n$$f_A S_A = S_{ref}$$\n$$f_B S_B = S_{ref}$$\nFirst, we compute the scaling factor for sample $\\mathrm{A}$, $f_A$.\n$$f_A S_A = S_A$$\nThis implies that the scaling factor for the reference sample is $f_A = 1$.\n\nNext, we compute the scaling factor for sample $\\mathrm{B}$, $f_B$.\n$$f_B S_B = S_A$$\n$$f_B = \\frac{S_A}{S_B}$$\nSubstituting the given values:\n$$f_B = \\frac{1.0 \\times 10^{6}}{6.0 \\times 10^{5}} = \\frac{10}{6} = \\frac{5}{3}$$\nNow, we apply these scaling factors to the raw IP peak counts for each sample. Let $p_{i, norm}^{j}$ be the normalized count for peak $p_i$ in sample $j$.\n\nFor sample $\\mathrm{A}$, with $f_A = 1$:\nThe normalized counts are identical to the raw counts.\n- Normalized $p_{1}^{A} = f_A \\times p_{1}^{A} = 1 \\times 15000 = 15000$\n- Normalized $p_{2}^{A} = f_A \\times p_{2}^{A} = 1 \\times 6200 = 6200$\n- Normalized $p_{3}^{A} = f_A \\times p_{3}^{A} = 1 \\times 3100 = 3100$\n\nFor sample $\\mathrm{B}$, with $f_B = \\frac{5}{3}$:\n- Normalized $p_{1}^{B} = f_B \\times p_{1}^{B} = \\frac{5}{3} \\times 9000 = 5 \\times 3000 = 15000$\n- Normalized $p_{2}^{B} = f_B \\times p_{2}^{B} = \\frac{5}{3} \\times 4200 = 5 \\times 1400 = 7000$\n- Normalized $p_{3}^{B} = f_B \\times p_{3}^{B} = \\frac{5}{3} \\times 2100 = 5 \\times 700 = 3500$\n\nThe final result consists of the scaling factors and the rescaled peak counts in the specified order:\n1. Scaling factor for sample $\\mathrm{A}$: $f_A = 1$\n2. Scaling factor for sample $\\mathrm{B}$: $f_B = \\frac{5}{3}$\n3. Rescaled peak counts for sample $\\mathrm{A}$: $15000$, $6200$, $3100$\n4. Rescaled peak counts for sample $\\mathrm{B}$: $15000$, $7000$, $3500$\n\nThese eight values are to be presented in a single row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\frac{5}{3} & 15000 & 6200 & 3100 & 15000 & 7000 & 3500\n\\end{pmatrix}\n}\n$$", "id": "4321532"}, {"introduction": "Once ChIP-seq data is properly normalized, a central task is to identify the specific DNA sequence motif that the transcription factor recognizes. This is accomplished using a Position Weight Matrix (PWM), a probabilistic model that captures the binding preferences of the factor at each position. In this practice [@problem_id:4321569], you will apply the fundamental concept of the log-likelihood ratio to score a candidate DNA sequence, determining whether it represents a likely binding site based on its match to the PWM versus a background model.", "problem": "A clinical genomics laboratory is investigating whether a specific six-nucleotide site in a patient’s tumor genome is likely to be bound by a transcription factor implicated in immunotherapy response, based on Chromatin Immunoprecipitation followed by sequencing (ChIP-seq). The binding model is encoded by a Position Weight Matrix (PWM), which gives, for each position, the conditional probability of observing nucleotide $\\mathrm{A}$, $\\mathrm{C}$, $\\mathrm{G}$, or $\\mathrm{T}$ in truly bound sites. The genome-wide background nucleotide distribution is non-uniform. Assume independence across positions under both the binding model and the background model, and use the log-likelihood ratio framework rooted in binary hypothesis testing between a binding model and a background model.\n\nThe PWM for the transcription factor (length $6$) estimated from high-confidence ChIP-seq peaks is:\n\n- Position $1$: $\\mathrm{A}: 0.45$, $\\mathrm{C}: 0.15$, $\\mathrm{G}: 0.10$, $\\mathrm{T}: 0.30$\n- Position $2$: $\\mathrm{A}: 0.10$, $\\mathrm{C}: 0.40$, $\\mathrm{G}: 0.40$, $\\mathrm{T}: 0.10$\n- Position $3$: $\\mathrm{A}: 0.35$, $\\mathrm{C}: 0.25$, $\\mathrm{G}: 0.15$, $\\mathrm{T}: 0.25$\n- Position $4$: $\\mathrm{A}: 0.05$, $\\mathrm{C}: 0.05$, $\\mathrm{G}: 0.80$, $\\mathrm{T}: 0.10$\n- Position $5$: $\\mathrm{A}: 0.50$, $\\mathrm{C}: 0.10$, $\\mathrm{G}: 0.30$, $\\mathrm{T}: 0.10$\n- Position $6$: $\\mathrm{A}: 0.20$, $\\mathrm{C}: 0.40$, $\\mathrm{G}: 0.20$, $\\mathrm{T}: 0.20$\n\nThe background nucleotide distribution (estimated genome-wide) is:\n$$\nq(\\mathrm{A}) = 0.30,\\quad q(\\mathrm{C}) = 0.20,\\quad q(\\mathrm{G}) = 0.20,\\quad q(\\mathrm{T}) = 0.30.\n$$\n\nThe candidate genomic site is the sequence $\\mathrm{S} = \\mathrm{A}\\mathrm{C}\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{C}$ aligned left-to-right with positions $1$ through $6$ of the PWM.\n\nAn empirical threshold $\\tau$ for likely binding, chosen from Receiver Operating Characteristic calibration to control False Discovery Rate (FDR) at $0.05$, is $\\tau = 3.5$ in natural-log units.\n\nUsing only the foundational definitions of likelihood under independence and the log-likelihood ratio as a Bayes factor between the binding and background models, compute the motif log-likelihood score for $\\mathrm{S}$ and assess whether $\\mathrm{S}$ is likely bound by comparing the score to $\\tau$. Report two quantities:\n- The log-likelihood ratio score in natural logarithm units, rounded to four significant figures.\n- The binding indicator $\\mathbb{I}_{\\text{bound}}$, defined as $1$ if the score is greater than or equal to $\\tau$ and $0$ otherwise.\n\nIf you provide both quantities, write them as a two-entry row in a single matrix. No physical units are associated with the score.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the established principles of bioinformatics and statistical genomics, specifically using Position Weight Matrices (PWMs) and log-likelihood ratios for scoring DNA sequence motifs. The problem is well-posed, with all necessary data (PWM, background probabilities, candidate sequence, and a decision threshold) provided. The definitions are clear, and the objective is unambiguous. The provided probabilities in the PWM for each position and in the background distribution sum to $1$, ensuring they are proper probability distributions. There are no contradictions, ambiguities, or factual errors.\n\nThe problem requires the computation of a log-likelihood ratio score for a given DNA sequence, which is a standard method for testing two competing hypotheses:\n- $H_1$: The sequence $S$ is generated by a binding site model, represented by the Position Weight Matrix (PWM).\n- $H_0$: The sequence $S$ is generated by a background model, represented by genome-wide nucleotide frequencies.\n\nLet the DNA sequence of length $L=6$ be denoted as $S = s_1s_2...s_L$. The problem states to assume independence between nucleotide positions for both models.\n\nThe likelihood of observing the sequence $S$ under the binding model ($H_1$) is the product of the probabilities of observing each nucleotide $s_i$ at its respective position $i$ according to the PWM. Let $P_i(b)$ be the probability of nucleotide $b$ at position $i$ in the PWM.\n$$\nL(S|H_1) = P(S|H_1) = \\prod_{i=1}^{6} P_i(s_i)\n$$\n\nThe likelihood of observing the sequence $S$ under the background model ($H_0$) is the product of the background probabilities of each nucleotide in the sequence. Let $q(b)$ be the background probability of nucleotide $b$.\n$$\nL(S|H_0) = P(S|H_0) = \\prod_{i=1}^{6} q(s_i)\n$$\n\nThe likelihood ratio (LR) is the ratio of these two likelihoods. A score based on this ratio, often called a log-odds score, is a form of Bayes factor comparing the evidence for $H_1$ versus $H_0$.\n$$\n\\text{LR}(S) = \\frac{L(S|H_1)}{L(S|H_0)} = \\frac{\\prod_{i=1}^{6} P_i(s_i)}{\\prod_{i=1}^{6} q(s_i)} = \\prod_{i=1}^{6} \\frac{P_i(s_i)}{q(s_i)}\n$$\n\nThe problem asks for the log-likelihood ratio (LLR) score in natural logarithm units. This is calculated by taking the natural logarithm of the LR.\n$$\n\\text{LLR}(S) = \\ln(\\text{LR}(S)) = \\ln \\left( \\prod_{i=1}^{6} \\frac{P_i(s_i)}{q(s_i)} \\right) = \\sum_{i=1}^{6} \\ln \\left( \\frac{P_i(s_i)}{q(s_i)} \\right)\n$$\n\nThe candidate sequence is $S = \\mathrm{A}\\mathrm{C}\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{C}$. We now extract the relevant probabilities from the given PWM and background distribution for each position in $S$.\n\n- For position $i=1$, $s_1=\\mathrm{A}$: $P_1(\\mathrm{A}) = 0.45$, $q(\\mathrm{A}) = 0.30$.\n- For position $i=2$, $s_2=\\mathrm{C}$: $P_2(\\mathrm{C}) = 0.40$, $q(\\mathrm{C}) = 0.20$.\n- For position $i=3$, $s_3=\\mathrm{A}$: $P_3(\\mathrm{A}) = 0.35$, $q(\\mathrm{A}) = 0.30$.\n- For position $i=4$, $s_4=\\mathrm{G}$: $P_4(\\mathrm{G}) = 0.80$, $q(\\mathrm{G}) = 0.20$.\n- For position $i=5$, $s_5=\\mathrm{A}$: $P_5(\\mathrm{A}) = 0.50$, $q(\\mathrm{A}) = 0.30$.\n- For position $i=6$, $s_6=\\mathrm{C}$: $P_6(\\mathrm{C}) = 0.40$, $q(\\mathrm{C}) = 0.20$.\n\nWe compute the LLR score by summing the individual log-ratios for each position:\n$$\n\\text{LLR}(S) = \\ln\\left(\\frac{0.45}{0.30}\\right) + \\ln\\left(\\frac{0.40}{0.20}\\right) + \\ln\\left(\\frac{0.35}{0.30}\\right) + \\ln\\left(\\frac{0.80}{0.20}\\right) + \\ln\\left(\\frac{0.50}{0.30}\\right) + \\ln\\left(\\frac{0.40}{0.20}\\right)\n$$\n$$\n\\text{LLR}(S) = \\ln(1.5) + \\ln(2) + \\ln\\left(\\frac{7}{6}\\right) + \\ln(4) + \\ln\\left(\\frac{5}{3}\\right) + \\ln(2)\n$$\nUsing the property $\\ln(a) + \\ln(b) = \\ln(ab)$, we can also compute this as:\n$$\n\\text{LLR}(S) = \\ln\\left(1.5 \\times 2 \\times \\frac{7}{6} \\times 4 \\times \\frac{5}{3} \\times 2\\right) = \\ln\\left(3 \\times \\frac{7}{6} \\times 4 \\times \\frac{5}{3} \\times 2\\right) = \\ln\\left(\\frac{140}{3}\\right)\n$$\nNumerically evaluating the sum of logarithms:\n$$\n\\text{LLR}(S) \\approx 0.405465 + 0.693147 + 0.154151 + 1.386294 + 0.510826 + 0.693147\n$$\n$$\n\\text{LLR}(S) \\approx 3.84303\n$$\nRounding to four significant figures as required, the score is $3.843$.\n\nThe second task is to assess whether the site is likely bound. This is done by comparing the computed score to the given threshold $\\tau = 3.5$.\nThe binding indicator $\\mathbb{I}_{\\text{bound}}$ is defined as:\n$$\n\\mathbb{I}_{\\text{bound}} =\n\\begin{cases}\n1 & \\text{if } \\text{LLR}(S) \\ge \\tau \\\\\n0 & \\text{if } \\text{LLR}(S) < \\tau\n\\end{cases}\n$$\nWe compare our computed score to the threshold:\n$$\n3.843 \\ge 3.5\n$$\nThis inequality is true. Therefore, the binding indicator is $\\mathbb{I}_{\\text{bound}} = 1$. The sequence $S$ is considered likely to be bound by the transcription factor.\n\nThe two quantities to be reported are the log-likelihood ratio score ($3.843$) and the binding indicator ($1$).", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.843 & 1\n\\end{pmatrix}\n}\n$$", "id": "4321569"}, {"introduction": "This advanced practice integrates the principles of motif scoring and quantitative analysis to address a key challenge in precision genomics: evaluating the functional impact of non-coding genetic variants. You will develop a computational pipeline [@problem_id:4321558] that synthesizes two critical lines of evidence: the predicted change in binding affinity from a PWM score, and the observed allele-specific binding from ChIP-seq read counts. This exercise builds a critical skill in linking sequence variation to changes in molecular function, which is foundational to interpreting regulatory variants in disease.", "problem": "You are to implement a principled, self-contained computational pipeline that, given a Position Weight Matrix (PWM) and Chromatin Immunoprecipitation sequencing (ChIP-seq) read counts supporting allele-specific binding at single-nucleotide variants within an enhancer, evaluates whether each variant is likely to impact transcription factor binding. Your program must produce quantitative outputs for each test case and a final decision indicator that integrates predicted motif affinity change and observed allele-specific binding evidence.\n\nFundamental base and allowed assumptions:\n- A Position Weight Matrix (PWM) encodes, for each position $i \\in \\{1,\\dots,L\\}$ of a motif of length $L$, the probability $P(x,i)$ of observing nucleotide $x \\in \\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$ at that position. Let the background probability of nucleotide $x$ be $b(x)$.\n- Under the standard independence model, the evidence that a sequence $s = s_1 s_2 \\dots s_L$ is generated by the motif rather than the background is given by a log-likelihood ratio score $S(s)$ relative to the background.\n- A single-nucleotide variant at position $k$ within the motif window changes $s_k$ to an alternative base, producing an alternative sequence $s^{\\text{alt}}$. The change in score is $\\Delta S = S(s^{\\text{alt}}) - S(s)$, and the relative binding affinity ratio under the likelihood model is $\\exp(\\Delta S)$.\n- Observed allele-specific binding is modeled as follows: for replicate $j \\in \\{1,\\dots,R\\}$ at a heterozygous site within the enhancer, let $r_j$ be the ChIP-seq reads supporting the reference allele and $a_j$ be the reads supporting the alternative allele, counted over reads that overlap the variant. Under the null hypothesis of no allele-specific binding, the allelic identity of each read is treated as an independent Bernoulli trial with probability $p=0.5$ for either allele, yielding a binomial model. Replicates are independent and can be combined by summation of counts.\n- For large total counts, use the normal approximation to the binomial to compute a two-sided $p$-value for the deviation from $p=0.5$.\n- To quantify effect size in observed data, use the log base $2$ fold-change of alternative over reference allele counts with a pseudocount.\n\nInput specification embedded in the test suite:\n- Motif length is $L = 6$. The Position Weight Matrix (PWM) $P(x,i)$ is specified as probabilities for nucleotides in the order $\\text{A},\\text{C},\\text{G},\\text{T}$ for each position $i\\in\\{1,2,3,4,5,6\\}$:\n  - Position $1$: $[0.1, 0.7, 0.1, 0.1]$\n  - Position $2$: $[0.7, 0.1, 0.1, 0.1]$\n  - Position $3$: $[0.1, 0.7, 0.1, 0.1]$\n  - Position $4$: $[0.1, 0.1, 0.7, 0.1]$\n  - Position $5$: $[0.1, 0.1, 0.1, 0.7]$\n  - Position $6$: $[0.1, 0.1, 0.7, 0.1]$\n- The background distribution is uniform, $b(\\text{A})=b(\\text{C})=b(\\text{G})=b(\\text{T})=0.25$.\n- Use natural logarithms for scores and the exponential function for mapping scores to affinity ratios. Use log base $2$ for the observed fold-change.\n- Use a pseudocount $\\alpha_{\\text{pc}}=0.5$ when computing the log base $2$ fold-change of alternative over reference allele counts.\n- Use a two-sided significance threshold $\\alpha = 0.01$ for the allele-specific binding test.\n- Combine replicates by summing counts across replicates before computing the test statistic.\n\nTasks to implement for each test case:\n1. Compute the motif log-likelihood ratio score $S(s)$ of the reference sequence $s$ of length $L$ under the PWM relative to the background.\n2. Compute the alternative sequence $s^{\\text{alt}}$ by replacing the base at position $k$ (zero-based index) with the alternative nucleotide. Compute $S(s^{\\text{alt}})$.\n3. Compute the score change $\\Delta S = S(s^{\\text{alt}}) - S(s)$.\n4. Compute the predicted relative binding affinity ratio $\\exp(\\Delta S)$.\n5. For observed data, let $R = \\sum_{j=1}^{R} r_j$, $A = \\sum_{j=1}^{R} a_j$, and $N = R + A$. Under the null hypothesis $p=0.5$, compute a normal-approximation $z$-statistic and the corresponding two-sided $p$-value. If $N=0$, define the $p$-value to be $1$.\n6. Compute the observed allele-specific effect size as $\\log_2\\left(\\dfrac{A + \\alpha_{\\text{pc}}}{R + \\alpha_{\\text{pc}}}\\right)$.\n7. Produce a decision indicator equal to the integer $1$ if and only if the two-sided $p$-value is less than $\\alpha$ and the direction of the predicted change $\\Delta S$ agrees with the observed direction $\\operatorname{sign}(A-R)$; otherwise output $0$.\n\nTest suite:\nProvide results for the following $5$ cases. In each case, the reference sequence $s$ is length $L=6$, the variant index $k$ is zero-based, and replicates are listed as pairs $(r_j,a_j)$:\n\n- Case $1$: $s=\\text{CACGTG}$, $k=3$, alternative base $\\text{A}$, replicates $\\{(40,10),(30,8)\\}$.\n- Case $2$: $s=\\text{TACGTG}$, $k=0$, alternative base $\\text{C}$, replicates $\\{(12,28),(15,35)\\}$.\n- Case $3$: $s=\\text{CACGTA}$, $k=5$, alternative base $\\text{G}$, replicates $\\{(18,20),(22,26)\\}$.\n- Case $4$: $s=\\text{CACGTG}$, $k=3$, alternative base $\\text{T}$, replicates $\\{(25,0),(20,0)\\}$.\n- Case $5$: $s=\\text{CACGTG}$, $k=2$, alternative base $\\text{A}$, replicates $\\{(1,0),(0,1)\\}$.\n\nAngle units are not applicable. No physical units are involved.\n\nRequired final output format:\n- For each test case, compute and output a list in the order $[\\Delta S,\\ \\exp(\\Delta S),\\ \\log_2\\text{ fold-change of }(A/R)\\ \\text{with }\\alpha_{\\text{pc}}=0.5,\\ \\text{two-sided }p\\text{-value},\\ \\text{indicator}]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list for one test case, for example `[\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]`.", "solution": "The problem statement poses a valid and well-defined computational task within the domain of genomic diagnostics. It requires the integration of sequence-based biophysical modeling (using a Position Weight Matrix) with statistical analysis of experimental data (ChIP-seq read counts) to assess the functional consequence of single-nucleotide variants on transcription factor binding. The problem is scientifically grounded in established principles of molecular biology and bioinformatics, is mathematically and logically self-consistent, and provides all necessary data and parameters for a unique solution to be computed for each test case.\n\nThe following is a principled, step-by-step derivation of the computational pipeline.\n\n**Problem Validation**\n\n**Step 1: Extracted Givens**\n- **Model Parameters**:\n    - Motif length: $L = 6$.\n    - Position Weight Matrix (PWM) $P(x,i)$ for $x \\in \\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$ and $i \\in \\{1, \\dots, 6\\}$:\n        - Position $1$: $[0.1, 0.7, 0.1, 0.1]$\n        - Position $2$: $[0.7, 0.1, 0.1, 0.1]$\n        - Position $3$: $[0.1, 0.7, 0.1, 0.1]$\n        - Position $4$: $[0.1, 0.1, 0.7, 0.1]$\n        - Position $5$: $[0.1, 0.1, 0.1, 0.7]$\n        - Position $6$: $[0.1, 0.1, 0.7, 0.1]$\n    - Background nucleotide probabilities: uniform, $b(\\text{A})=b(\\text{C})=b(\\text{G})=b(\\text{T})=0.25$.\n- **Computational Rules**:\n    - Log-likelihood ratio score $S(s)$ uses the natural logarithm.\n    - Relative binding affinity ratio is $\\exp(\\Delta S)$.\n    - Observed allele-specific effect size is $\\log_2\\left(\\frac{A + \\alpha_{\\text{pc}}}{R + \\alpha_{\\text{pc}}}\\right)$ with pseudocount $\\alpha_{\\text{pc}}=0.5$.\n    - Allele-specific binding (ASB) significance is tested using a normal approximation to the binomial model under the null hypothesis $p=0.5$.\n    - A two-sided significance threshold of $\\alpha = 0.01$ is used for the ASB test.\n    - Replicates are combined by summing read counts $(r_j, a_j)$. Let $R = \\sum r_j$ and $A = \\sum a_j$.\n    - If total reads $N=R+A=0$, the $p$-value is defined as $1$.\n- **Tasks & Output**:\n    1. Compute $S(s)$.\n    2. Compute $S(s^{\\text{alt}})$.\n    3. Compute $\\Delta S = S(s^{\\text{alt}}) - S(s)$.\n    4. Compute $\\exp(\\Delta S)$.\n    5. Compute the two-sided $p$-value for ASB.\n    6. Compute the observed $\\log_2$ fold-change.\n    7. Compute a decision indicator: $1$ if $p\\text{-value} < \\alpha$ and $\\operatorname{sign}(\\Delta S)$ matches $\\operatorname{sign}(A-R)$, otherwise $0$.\n    - The output for each case is a list: $[\\Delta S, \\exp(\\Delta S), \\log_2\\text{ fold-change}, p\\text{-value}, \\text{indicator}]$.\n- **Test Suite**:\n    - Case $1$: $s=\\text{CACGTG}$, $k=3$, alternative base $\\text{A}$, replicates $\\{(40,10),(30,8)\\}$.\n    - Case $2$: $s=\\text{TACGTG}$, $k=0$, alternative base $\\text{C}$, replicates $\\{(12,28),(15,35)\\}$.\n    - Case $3$: $s=\\text{CACGTA}$, $k=5$, alternative base $\\text{G}$, replicates $\\{(18,20),(22,26)\\}$.\n    - Case $4$: $s=\\text{CACGTG}$, $k=3$, alternative base $\\text{T}$, replicates $\\{(25,0),(20,0)\\}$.\n    - Case $5$: $s=\\text{CACGTG}$, $k=2$, alternative base $\\text{A}$, replicates $\\{(1,0),(0,1)\\}$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is valid. It is scientifically grounded, well-posed, and objective. It contains no scientific or factual unsoundness, is formalizable and relevant, provides a complete and non-contradictory setup, describes a computationally feasible task, is well-structured, and is not trivial. It fulfills all criteria for a valid problem.\n\n**Step 3: Verdict and Action**\nThe problem is valid. Proceeding to solution.\n\n**Computational Methodology**\n\nThe analysis integrates a theoretical prediction of binding affinity change with an empirical measurement of allele-specific binding.\n\n**1. Motif Scoring and Predicted Affinity Change ($\\Delta S$ and $\\exp(\\Delta S)$)**\n\nThe binding affinity of a transcription factor to a DNA sequence $s = s_1s_2...s_L$ can be modeled using a Position Weight Matrix (PWM). The score $S(s)$ represents the log-likelihood ratio of the sequence being generated by the motif model versus a background model. Assuming independence between positions, this score is:\n$$S(s) = \\sum_{i=1}^{L} \\log \\left( \\frac{P(s_i, i)}{b(s_i)} \\right)$$\nwhere $P(s_i, i)$ is the probability of nucleotide $s_i$ at position $i$ from the PWM and $b(s_i)$ is the background probability of $s_i$. The problem specifies the natural logarithm ($\\log$).\n\nA single-nucleotide variant replaces the reference base $s_k$ at a specific position $k$ with an alternative base $s_k^{\\text{alt}}$, yielding an alternative sequence $s^{\\text{alt}}$. The change in score, $\\Delta S$, is:\n$$\\Delta S = S(s^{\\text{alt}}) - S(s) = \\left( \\sum_{i=1}^{L} \\log \\frac{P(s^{\\text{alt}}_i, i)}{b(s^{\\text{alt}}_i)} \\right) - \\left( \\sum_{i=1}^{L} \\log \\frac{P(s_i, i)}{b(s_i)} \\right)$$\nSince the sequences differ only at position $k$, all other terms in the summation cancel, leaving:\n$$\\Delta S = \\log \\left( \\frac{P(s_k^{\\text{alt}}, k)}{b(s_k^{\\text{alt}})} \\right) - \\log \\left( \\frac{P(s_k, k)}{b(s_k)} \\right)$$\nGiven the uniform background where $b(x) = 0.25$ for all nucleotides $x$, this further simplifies to:\n$$\\Delta S = \\log(P(s_k^{\\text{alt}}, k)) - \\log(P(s_k, k))$$\nThis $\\Delta S$ value predicts the change in binding energy. A positive $\\Delta S$ predicts stronger binding for the alternative allele, while a negative $\\Delta S$ predicts weaker binding. The predicted relative binding affinity ratio is given by the biophysical model as $\\exp(\\Delta S)$.\n\n**2. Analysis of Allele-Specific Binding (ASB)**\n\nThe experimental evidence for differential binding is derived from ChIP-seq data at heterozygous sites. We test the null hypothesis ($H_0$) that there is no difference in binding between the reference and alternative alleles. Under $H_0$, a read overlapping the variant has an equal probability ($p=0.5$) of originating from the chromosome carrying the reference allele or the one carrying the alternative allele.\n\nLet $R = \\sum r_j$ and $A = \\sum a_j$ be the total read counts supporting the reference and alternative alleles, respectively, summed across all replicates. The total number of informative reads is $N = R+A$. The number of reads for one allele (e.g., $A$) follows a binomial distribution, $A \\sim \\text{Binomial}(N, p=0.5)$.\n\nFor large $N$, this distribution can be approximated by a normal distribution with mean $\\mu = Np = 0.5N$ and standard deviation $\\sigma = \\sqrt{Np(1-p)} = \\sqrt{N(0.5)(0.5)} = 0.5\\sqrt{N}$.\n\nA $z$-statistic is computed to measure the deviation of the observed count $A$ from its expected value under $H_0$:\n$$z = \\frac{A - \\mu}{\\sigma} = \\frac{A - 0.5(R+A)}{0.5\\sqrt{R+A}} = \\frac{0.5A - 0.5R}{0.5\\sqrt{R+A}} = \\frac{A-R}{\\sqrt{R+A}}$$\nThis expression is valid for $N > 0$. If $N=0$, no data is available, and the $p$-value is defined as $1$. The two-sided $p$-value, which quantifies the probability of observing a deviation at least as extreme as the one measured, is calculated from the standard normal cumulative distribution function (CDF), $\\Phi(z)$:\n$$p\\text{-value} = 2 \\times P(Z \\ge |z|) = 2 \\times (1 - \\Phi(|z|))$$\n\n**3. Observed Allelic Effect Size**\n\nTo quantify the magnitude of the observed allelic imbalance, we compute the log-base-2 fold-change of the alternative-to-reference allele counts. A pseudocount, $\\alpha_{\\text{pc}}=0.5$, is added to each count to stabilize the ratio, especially when one count is zero.\n$$\\text{log}_2\\text{ Fold-Change} = \\log_2\\left(\\frac{A + \\alpha_{\\text{pc}}}{R + \\alpha_{\\text{pc}}}\\right)$$\n\n**4. Integrated Decision Indicator**\n\nA final decision synthesizes the predictive model and the experimental data. A variant is flagged as having a functional impact on binding (indicator = $1$) if and only if two conditions are met:\n1.  **Statistical Significance**: The observed allele-specific binding is statistically significant, i.e., the $p$-value is less than the specified threshold, $p < \\alpha = 0.01$.\n2.  **Concordance of Effect**: The direction of the predicted binding affinity change is consistent with the direction of the observed allelic imbalance. This is true if the sign of $\\Delta S$ matches the sign of the observed difference in counts, $(A-R)$.\n    - $\\Delta S > 0$ (predicts stronger binding for alt) and $A > R$ (observes more alt reads).\n    - $\\Delta S < 0$ (predicts weaker binding for alt) and $A < R$ (observes fewer alt reads).\n    - $\\Delta S = 0$ and $A = R$.\n    Mathematically, this condition is $\\operatorname{sign}(\\Delta S) = \\operatorname{sign}(A-R)$. If either condition fails, the indicator is set to $0$.\n\nThis pipeline provides a rigorous framework for evaluating the functional consequences of putative regulatory variants.", "answer": "```\n[[-1.9459, 0.1429, -1.9307, 2.9772e-08, 1], [1.9459, 7.0000, 1.2072, 1.4770e-04, 1], [1.9459, 7.0000, 0.1990, 0.5174, 0], [-1.9459, 0.1429, -6.5092, 1.9634e-11, 1], [-1.9459, 0.1429, 0.0000, 1.0000, 0]]\n```", "id": "4321558"}]}