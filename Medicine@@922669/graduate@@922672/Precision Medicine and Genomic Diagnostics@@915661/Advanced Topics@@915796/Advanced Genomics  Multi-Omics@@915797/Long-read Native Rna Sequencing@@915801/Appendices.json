{"hands_on_practices": [{"introduction": "Long-read native RNA sequencing begins by recording a raw electrical signal as an RNA molecule passes through a nanopore. This practice helps build a fundamental intuition for the data life cycle by contrasting the storage size of this raw signal with its final, basecalled FASTQ representation. By performing this calculation [@problem_id:4355994], you can appreciate the scale of data compression that basecalling achieves and the importance of efficient data management in sequencing workflows.", "problem": "A precision medicine workflow uses long-read native ribonucleic acid (RNA) sequencing signals to detect isoforms and RNA modifications. The instrument outputs a digitized ionic current trace for each read and later produces basecalled sequences with per-base quality scores. Assume the following scientifically grounded conditions:\n\n- There are $N$ reads, each with an average duration of $T$ seconds.\n- The raw signal is uniformly sampled at $f_{s}$ hertz, quantized at $16$ bits per sample.\n- Basecalling yields, on average for native RNA, $v$ bases per second over the duration $T$ of each read.\n- Basecalled sequences are stored in FASTA with quality scores (FASTQ) format, which uses four lines per read: a header line, a sequence line, a plus line, and a quality line. Characters are encoded in American Standard Code for Information Interchange (ASCII), so each character, including line terminators, occupies $1$ byte.\n- For each read, the header line contains $h$ characters followed by one line terminator, the sequence line contains $L$ characters (equal to the number of bases) followed by one line terminator, the plus line contains $p$ characters followed by one line terminator, and the quality line contains $L$ characters followed by one line terminator.\n\nUsing only these fundamentals, compute the ratio of the total raw signal storage to the total FASTQ storage across all reads under the following parameters: $N = 3{,}000$, $T = 60$ seconds, $f_{s} = 4{,}000$ hertz, $16$-bit samples, $v = 75$ bases per second, $h = 100$ characters, and $p = 1$ character. Express the final result as a dimensionless ratio and round your answer to $4$ significant figures.", "solution": "The goal is to derive the ratio of total raw signal storage to total FASTQ storage from first principles of digital sampling and text encoding.\n\nStart by quantifying the raw signal storage. Each readâ€™s signal is sampled at $f_{s}$ hertz for $T$ seconds, yielding $T f_{s}$ samples. Each sample is quantized at $16$ bits, which is $\\frac{16}{8} = 2$ bytes per sample. Therefore, the raw bytes per read are\n$$\n\\text{Raw bytes per read} = T f_{s} \\times 2.\n$$\nAcross $N$ reads, the total raw storage is\n$$\nR_{\\text{raw}} = N \\times T f_{s} \\times 2.\n$$\n\nNext, quantify the FASTQ storage per read from the definition of FASTQ structure. The sequence length in bases for a read is\n$$\nL = v T,\n$$\nbecause $v$ bases are produced per second over $T$ seconds. In FASTQ, each character (including line terminators) is one byte in American Standard Code for Information Interchange (ASCII). The four lines per read contribute:\n- Header line: $h$ characters $+$ $1$ line terminator $\\Rightarrow h + 1$ bytes.\n- Sequence line: $L$ characters $+$ $1$ line terminator $\\Rightarrow L + 1$ bytes.\n- Plus line: $p$ characters $+$ $1$ line terminator $\\Rightarrow p + 1$ bytes.\n- Quality line: $L$ characters $+$ $1$ line terminator $\\Rightarrow L + 1$ bytes.\n\nThus, the FASTQ bytes per read are\n$$\n\\text{FASTQ bytes per read} = (h + 1) + (L + 1) + (p + 1) + (L + 1) = h + p + 4 + 2L.\n$$\nAcross $N$ reads, the total FASTQ storage is\n$$\nR_{\\text{fastq}} = N \\times \\left(h + p + 4 + 2L\\right) = N \\times \\left(h + p + 4 + 2 v T\\right).\n$$\n\nThe desired ratio of total raw signal storage to total FASTQ storage is\n$$\n\\frac{R_{\\text{raw}}}{R_{\\text{fastq}}}\n= \\frac{N \\times T f_{s} \\times 2}{N \\times \\left(h + p + 4 + 2 v T\\right)}\n= \\frac{2 T f_{s}}{h + p + 4 + 2 v T}.\n$$\n\nNow substitute the given numerical values:\n- $T = 60$,\n- $f_{s} = 4{,}000$,\n- $v = 75$,\n- $h = 100$,\n- $p = 1$.\n\nCompute the numerator:\n$$\n2 T f_{s} = 2 \\times 60 \\times 4{,}000 = 480{,}000.\n$$\n\nCompute the denominator:\n$$\nh + p + 4 + 2 v T = 100 + 1 + 4 + 2 \\times 75 \\times 60 = 105 + 9{,}000 = 9{,}105.\n$$\n\nTherefore, the ratio is\n$$\n\\frac{R_{\\text{raw}}}{R_{\\text{fastq}}} = \\frac{480{,}000}{9{,}105} \\approx 52.71828\\ldots\n$$\n\nRounded to $4$ significant figures, the dimensionless ratio is\n$$\n52.72.\n$$", "answer": "$$\\boxed{52.72}$$", "id": "4355994"}, {"introduction": "After basecalling transforms the raw signal into a sequence of nucleotides, the critical next step is to assess its quality. The Phred quality score, or $Q$-score, is the industry standard for this purpose, but its logarithmic scale can feel abstract. This exercise [@problem_id:4356052] makes the concept tangible by asking you to calculate the concrete reduction in basecalling errors from an improvement in average $Q$-score, directly linking the quality metric to the accuracy of the final sequence data.", "problem": "In a precision oncology assay using long-read native ribonucleic acid (RNA) sequencing by Oxford Nanopore Technologies (ONT), a laboratory is evaluating whether to upgrade its basecalling model. For a representative full-length messenger RNA (mRNA) target of length $L=10000$ nucleotides, the current pipeline yields an average per-base quality score (Q-score) of $Q_{A}=10$. A proposed model upgrade is expected to raise the average per-base Q-score to $Q_{B}=15$. Assume that per-base errors are independent across positions within a read and that the per-base error probability is uniform across the read.\n\nStarting from the standard definition connecting the quality score to the per-base error probability and the basic probabilistic model for independent errors along a sequence, compute the expected absolute decrease in the number of mismatched bases per read when moving from pipeline $A$ to pipeline $B$. Express your final answer as the number of expected mismatches per read and round your answer to four significant figures.", "solution": "The problem asks for the expected absolute decrease in the number of mismatched bases per read when upgrading a sequencing pipeline. To solve this, we must first relate the provided quality scores ($Q$-scores) to the per-base error probabilities.\n\nThe Phred quality score, $Q$, is defined in terms of the probability of an incorrect base call, $P_e$, by the following logarithmic relationship:\n$$\nQ = -10 \\log_{10}(P_e)\n$$\nThis equation can be rearranged to solve for the per-base error probability, $P_e$, as a function of the Q-score, $Q$:\n$$\n-\\frac{Q}{10} = \\log_{10}(P_e)\n$$\n$$\nP_e = 10^{-Q/10}\n$$\nWe are given two different pipelines, A (current) and B (proposed), with average per-base Q-scores $Q_A = 10$ and $Q_B = 15$, respectively. We can calculate the per-base error probability for each pipeline.\n\nFor pipeline A:\n$$\nP_{e,A} = 10^{-Q_A/10} = 10^{-10/10} = 10^{-1} = 0.1\n$$\nThis means that for the current pipeline, there is a $1$ in $10$ chance of an error at any given base.\n\nFor pipeline B:\n$$\nP_{e,B} = 10^{-Q_B/10} = 10^{-15/10} = 10^{-1.5}\n$$\nThis is the per-base error probability for the proposed upgraded pipeline.\n\nThe problem states that the mRNA target has a length of $L = 10000$ nucleotides and that per-base errors are independent and uniformly distributed. The number of errors in a read can be modeled as a sum of Bernoulli trials, one for each nucleotide position. The expected number of mismatched bases (errors), $E$, in a read of length $L$ is the product of the length and the per-base error probability $P_e$:\n$$\nE = L \\times P_e\n$$\nUsing this formula, we can calculate the expected number of errors for both pipelines.\n\nExpected number of errors for pipeline A:\n$$\nE_A = L \\times P_{e,A} = 10000 \\times 0.1 = 1000\n$$\nSo, on average, a read of length $10000$ nucleotides generated by pipeline A is expected to contain $1000$ errors.\n\nExpected number of errors for pipeline B:\n$$\nE_B = L \\times P_{e,B} = 10000 \\times 10^{-1.5}\n$$\nWe can simplify this expression:\n$$\nE_B = 10^4 \\times 10^{-1.5} = 10^{4 - 1.5} = 10^{2.5} = 10^2 \\times 10^{0.5} = 100 \\sqrt{10}\n$$\nNumerically, $\\sqrt{10} \\approx 3.16227766$. Therefore:\n$$\nE_B \\approx 100 \\times 3.16227766 = 316.227766\n$$\n\nThe problem asks for the expected absolute decrease in the number of mismatched bases per read, which is the difference between the expected number of errors from pipeline A and pipeline B.\n$$\n\\Delta E = E_A - E_B\n$$\nSubstituting the calculated values:\n$$\n\\Delta E = 1000 - 100 \\sqrt{10}\n$$\nNow, we compute the numerical value:\n$$\n\\Delta E \\approx 1000 - 316.227766 = 683.772234\n$$\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures are $6$, $8$, $3$, and $7$. The fifth digit is $7$, so we round up the fourth digit.\n$$\n\\Delta E \\approx 683.8\n$$\nThus, upgrading the basecalling model from pipeline A to pipeline B is expected to decrease the number of mismatched bases by approximately $683.8$ per read of length $10000$.", "answer": "$$\n\\boxed{683.8}\n$$", "id": "4356052"}, {"introduction": "A primary advantage of long-read sequencing is its power to resolve complex transcript structures, a task where short reads often fail. This exercise explores this benefit by modeling the probability that a single read can span multiple distinguishing exon-exon junctions, thereby unambiguously identifying a specific isoform. By comparing the performance of short versus long reads in this hypothetical scenario [@problem_id:4356011], you will quantitatively grasp why read length is a critical factor in studying the full diversity of the transcriptome.", "problem": "In long-read native ribonucleic acid (RNA) sequencing for precision medicine and genomic diagnostics, resolving transcript isoforms often requires that a single read span all discriminative exon-exon junctions. Consider a simple exon-junction model in which there are exactly $3$ discriminative junctions separating isoforms within a local transcript region. Assume the distances between adjacent discriminative junctions are independent and identically distributed exponential random variables with mean $\\mu = 300$ base pairs (bp), reflecting a junction density that is approximately stationary along the transcript. Under this model, the total span $D$ needed to cover all $3$ junctions (that is, from the most $5'$ of the three junctions to the most $3'$ of the three junctions) is the sum of $2$ independent exponential variables and thus follows a gamma distribution with shape parameter $2$ and rate $\\lambda = 1/\\mu$.\n\nAssume a read of fixed length $L$ is positioned with a translation-invariant uniform offset relative to the discriminative region, so that conditional on $D=d \\leq L$, the probability that the read spans all junctions equals the fraction of possible offsets that fully contain the interval of width $d$, namely $(L-d)/L$, and is $0$ otherwise. Let $p_\\text{span}(L)$ denote the resulting expectation of this probability over the distribution of $D$. Define the per-read isoform ambiguity as $A(L) = 1 - p_\\text{span}(L)$.\n\nCompute the expected reduction in isoform ambiguity when the mean read length increases from $L_{1} = 150$ bp (short-read regime) to $L_{2} = 2000$ bp (long-read regime), under the assumptions above and neglecting transcript boundary effects. Report the reduction as the single real number\n$$\\Delta A \\equiv A(L_{1}) - A(L_{2}) = p_\\text{span}(L_{2}) - p_\\text{span}(L_{1}).$$\nUse $\\mu = 300$ bp, and treat $L_{1}$ and $L_{2}$ as exact fixed lengths. Round your final answer to four significant figures and express it as a unitless decimal fraction.", "solution": "The user wants to compute the reduction in isoform ambiguity, $\\Delta A$, when increasing read length from $L_1 = 150$ bp to $L_2 = 2000$ bp.\n\nFirst, we formalize the problem based on the provided information. The reduction in ambiguity is defined as:\n$$ \\Delta A = A(L_1) - A(L_2) $$\nwhere $A(L) = 1 - p_\\text{span}(L)$ is the isoform ambiguity for a read of length $L$. Substituting this definition, we get:\n$$ \\Delta A = (1 - p_\\text{span}(L_1)) - (1 - p_\\text{span}(L_2)) = p_\\text{span}(L_2) - p_\\text{span}(L_1) $$\nOur primary task is to derive an expression for $p_\\text{span}(L)$, the probability that a read of length $L$ spans all $3$ discriminative junctions.\n\nThe total span $D$ required to cover all $3$ junctions is the sum of the $2$ distances between them. These distances are given as independent and identically distributed exponential random variables with mean $\\mu = 300$ bp. The sum of $k$ i.i.d. exponential random variables with rate $\\lambda$ follows a gamma distribution with shape parameter $k$ and rate parameter $\\lambda$. Here, $k=2$ and the rate $\\lambda$ is the reciprocal of the mean $\\mu$:\n$$ \\lambda = \\frac{1}{\\mu} = \\frac{1}{300} \\, \\text{bp}^{-1} $$\nThe probability density function (PDF) of the total span $D$ is given by the gamma distribution PDF for $d \\ge 0$:\n$$ f_D(d) = \\frac{\\lambda^k d^{k-1} \\exp(-\\lambda d)}{\\Gamma(k)} $$\nWith $k=2$ and $\\Gamma(2) = 1! = 1$, the PDF simplifies to:\n$$ f_D(d) = \\lambda^2 d \\exp(-\\lambda d) $$\n\nThe problem states that for a given span $D=d$, the probability that a read of length $L$ fully contains this span is $(L-d)/L$ if $d \\le L$, and $0$ if $d > L$.\nThe overall spanning probability, $p_\\text{span}(L)$, is the expectation of this conditional probability over the distribution of $D$:\n$$ p_\\text{span}(L) = \\mathbb{E}[P(\\text{span} | D)] = \\int_{0}^{\\infty} P(\\text{span} | D=d) f_D(d) \\, \\mathrm{d}d $$\nGiven the conditional probability, the integral's upper limit is $L$:\n$$ p_\\text{span}(L) = \\int_{0}^{L} \\frac{L-d}{L} f_D(d) \\, \\mathrm{d}d $$\nSubstituting the PDF $f_D(d)$:\n$$ p_\\text{span}(L) = \\int_{0}^{L} \\left(1 - \\frac{d}{L}\\right) (\\lambda^2 d \\exp(-\\lambda d)) \\, \\mathrm{d}d $$\nWe can split this into two parts:\n$$ p_\\text{span}(L) = \\lambda^2 \\int_{0}^{L} d \\exp(-\\lambda d) \\, \\mathrm{d}d - \\frac{\\lambda^2}{L} \\int_{0}^{L} d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d $$\nThese integrals can be solved using integration by parts. A more direct approach is to relate them to the cumulative distribution function (CDF) and partial expectation of the gamma distribution.\nLet's define $p_\\text{span}(L) = \\int_0^L f_D(d) \\, \\mathrm{d}d - \\frac{1}{L}\\int_0^L d f_D(d) \\, \\mathrm{d}d$.\nThe first term is the CDF of the Gamma($k=2, \\lambda$) distribution, $F_D(L) = P(D \\le L)$. For integer $k$, the CDF is $F_D(L; k, \\lambda) = 1 - \\exp(-\\lambda L) \\sum_{j=0}^{k-1} \\frac{(\\lambda L)^j}{j!}$.\nFor $k=2$:\n$$ F_D(L) = 1 - \\exp(-\\lambda L) \\left( \\frac{(\\lambda L)^0}{0!} + \\frac{(\\lambda L)^1}{1!} \\right) = 1 - \\exp(-\\lambda L)(1 + \\lambda L) $$\nThe second term involves the integral $\\int_0^L d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d$. Using integration by parts, $\\int u \\, \\mathrm{d}v = uv - \\int v \\, \\mathrm{d}u$:\nLet $u = d^n$ and $\\mathrm{d}v = \\exp(-\\lambda d)\\mathrm{d}d$. The general indefinite integral is:\n$$ \\int d^n \\exp(-\\lambda d) \\, \\mathrm{d}d = -\\frac{\\exp(-\\lambda d)}{\\lambda^{n+1}} \\sum_{i=0}^{n} \\frac{n!}{(n-i)!} (\\lambda d)^{n-i} $$\nFor $n=1$: $\\int d \\exp(-\\lambda d) \\, \\mathrm{d}d = -\\frac{\\exp(-\\lambda d)}{\\lambda^2}(\\lambda d + 1)$.\nFor $n=2$: $\\int d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d = -\\frac{\\exp(-\\lambda d)}{\\lambda^3}(\\lambda^2 d^2 + 2\\lambda d + 2)$.\n\nEvaluating the definite integrals from $0$ to $L$:\n$$ \\int_{0}^{L} d \\exp(-\\lambda d) \\, \\mathrm{d}d = \\left[ -\\frac{\\exp(-\\lambda d)}{\\lambda^2}(\\lambda d + 1) \\right]_{0}^{L} = \\frac{1}{\\lambda^2} - \\frac{\\exp(-\\lambda L)}{\\lambda^2}(\\lambda L + 1) $$\n$$ \\int_{0}^{L} d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d = \\left[ -\\frac{\\exp(-\\lambda d)}{\\lambda^3}(\\lambda^2 d^2 + 2\\lambda d + 2) \\right]_{0}^{L} = \\frac{2}{\\lambda^3} - \\frac{\\exp(-\\lambda L)}{\\lambda^3}(\\lambda^2 L^2 + 2\\lambda L + 2) $$\nSubstituting these back into the expression for $p_\\text{span}(L)$:\n$$ p_\\text{span}(L) = \\lambda^2 \\left( \\frac{1}{\\lambda^2} - \\frac{\\exp(-\\lambda L)}{\\lambda^2}(\\lambda L + 1) \\right) - \\frac{\\lambda^2}{L} \\left( \\frac{2}{\\lambda^3} - \\frac{\\exp(-\\lambda L)}{\\lambda^3}(\\lambda^2 L^2 + 2\\lambda L + 2) \\right) $$\n$$ p_\\text{span}(L) = \\left( 1 - \\exp(-\\lambda L)(\\lambda L + 1) \\right) - \\frac{2}{\\lambda L} \\left( 1 - \\exp(-\\lambda L)\\left(\\frac{\\lambda^2 L^2}{2} + \\lambda L + 1\\right) \\right) $$\nThis simplifies to a more elegant form. Let's re-group the terms from the expanded integrals:\n$$ p_\\text{span}(L) = 1 - (\\lambda L+1)\\exp(-\\lambda L) - \\frac{2}{\\lambda L} + \\frac{\\exp(-\\lambda L)}{\\lambda L}(\\lambda^2 L^2 + 2\\lambda L + 2) $$\n$$ p_\\text{span}(L) = 1 - (\\lambda L+1)\\exp(-\\lambda L) - \\frac{2}{\\lambda L} + \\exp(-\\lambda L)(\\lambda L + 2 + \\frac{2}{\\lambda L}) $$\n$$ p_\\text{span}(L) = 1 - \\frac{2}{\\lambda L} - \\lambda L \\exp(-\\lambda L) - \\exp(-\\lambda L) + \\lambda L \\exp(-\\lambda L) + 2 \\exp(-\\lambda L) + \\frac{2}{\\lambda L} \\exp(-\\lambda L) $$\n$$ p_\\text{span}(L) = 1 - \\frac{2}{\\lambda L} + \\exp(-\\lambda L) + \\frac{2}{\\lambda L} \\exp(-\\lambda L) $$\n$$ p_\\text{span}(L) = 1 - \\frac{2}{\\lambda L}(1 - \\exp(-\\lambda L)) + \\exp(-\\lambda L) $$\n\nNow we can compute $p_\\text{span}(L)$ for $L_1=150$ bp and $L_2=2000$ bp.\nThe parameter $\\lambda = 1/300$ bp$^{-1}$.\n\nFor $L_1 = 150$ bp:\nThe dimensionless product is $\\lambda L_1 = \\frac{1}{300} \\times 150 = 0.5$.\n$$ p_\\text{span}(L_1) = 1 - \\frac{2}{0.5}(1 - \\exp(-0.5)) + \\exp(-0.5) $$\n$$ p_\\text{span}(L_1) = 1 - 4(1 - \\exp(-0.5)) + \\exp(-0.5) = 1 - 4 + 4\\exp(-0.5) + \\exp(-0.5) $$\n$$ p_\\text{span}(L_1) = 5\\exp(-0.5) - 3 $$\n\nFor $L_2 = 2000$ bp:\nThe dimensionless product is $\\lambda L_2 = \\frac{1}{300} \\times 2000 = \\frac{20}{3}$.\n$$ p_\\text{span}(L_2) = 1 - \\frac{2}{20/3}(1 - \\exp(-20/3)) + \\exp(-20/3) $$\n$$ p_\\text{span}(L_2) = 1 - \\frac{6}{20}(1 - \\exp(-20/3)) + \\exp(-20/3) = 1 - 0.3 + 0.3\\exp(-20/3) + \\exp(-20/3) $$\n$$ p_\\text{span}(L_2) = 0.7 + 1.3\\exp(-20/3) $$\n\nThe required quantity is $\\Delta A = p_\\text{span}(L_2) - p_\\text{span}(L_1)$.\n$$ \\Delta A = (0.7 + 1.3\\exp(-20/3)) - (5\\exp(-0.5) - 3) $$\n$$ \\Delta A = 3.7 + 1.3\\exp(-20/3) - 5\\exp(-0.5) $$\n\nNow we substitute the numerical values for the exponential functions:\n$\\exp(-0.5) \\approx 0.6065306597$\n$\\exp(-20/3) \\approx 0.0012712499$\n\n$$ p_\\text{span}(L_1) \\approx 5 \\times 0.6065306597 - 3 = 3.0326532985 - 3 = 0.0326532985 $$\n$$ p_\\text{span}(L_2) \\approx 0.7 + 1.3 \\times 0.0012712499 = 0.7 + 0.0016526249 = 0.7016526249 $$\n\n$$ \\Delta A \\approx 0.7016526249 - 0.0326532985 = 0.6689993264 $$\n\nRounding the result to four significant figures, we get $0.6690$.", "answer": "$$\\boxed{0.6690}$$", "id": "4356011"}]}