{"hands_on_practices": [{"introduction": "Understanding somatic mosaicism begins with connecting the biological event of a mutation to its quantitative signature in genomic data. This first exercise models a simplified but fundamental scenario: a single mutation arising during early embryogenesis. By deriving the expected Variant Allele Fraction ($VAF$) from first principles [@problem_id:4315994], you will establish the foundational relationship between the fraction of cells carrying a mutation and the allele frequency observed in a bulk tissue sample.", "problem": "In a diploid human tissue, somatic mosaicism can arise when a mutation occurs during early embryogenesis and is propagated to all descendant cells of the mutated progenitor. Consider a simplified developmental model with symmetric cell divisions, no cell loss, no selection, and equal contribution of each early blastomere to the eventual tissue. At the $8$-cell stage of embryogenesis, a single autosomal heterozygous single-nucleotide variant appears de novo in exactly $1$ of the $8$ blastomeres. Assume the following: the tissue sample collected in adulthood consists of a very large number of cells drawn uniformly at random from the organism, there is no aneuploidy, each somatic cell contributes exactly $2$ alleles at the locus, and sequencing reads are an unbiased proxy for allele copy counts with no allele-specific bias. Using only fundamental definitions of clone fraction (the fraction of cells carrying the mutation) and the definition of Variant Allele Fraction (VAF, the fraction of sequencing reads supporting the variant among all reads at the locus), derive from first principles the expected VAF in the bulk tissue sample under these assumptions. Express your final VAF as an exact fraction.", "solution": "The goal is to derive the expected Variant Allele Fraction (VAF) in a bulk tissue sample. We will proceed by first defining the clone fraction based on the developmental model and then relating it to the VAF using the provided genetic and sequencing assumptions.\n\nLet $C_F$ denote the clone fraction, defined as the fraction of cells in the tissue that carry the mutation. The problem states that embryogenesis proceeds from an $8$-cell stage, with a de novo mutation arising in exactly $1$ of the $8$ blastomeres. Key assumptions are that all cell divisions are symmetric, there is no cell loss or selection, and each of the $8$ blastomeres contributes equally to the final tissue mass. Under these idealized conditions, the proportional representation of the lineage from each blastomere is preserved in the adult tissue. Therefore, the fraction of cells descended from the single mutated blastomere is equal to the initial fraction of mutated blastomeres.\n\n$$\nC_F = \\frac{\\text{Number of mutated progenitor cells}}{\\text{Total number of progenitor cells}} = \\frac{1}{8}\n$$\n\nNext, we define the VAF. The VAF is the fraction of sequencing reads that support the variant allele. The problem stipulates that sequencing reads are an unbiased proxy for allele copy counts. Therefore, the VAF is equivalent to the proportion of variant alleles among all alleles at the specified locus within the sampled cell population.\n\n$$\n\\text{VAF} = \\frac{\\text{Total number of variant alleles in the sample}}{\\text{Total number of all alleles at the locus in the sample}}\n$$\n\nLet us consider a large, representative sample of $N$ cells from the tissue.\nThe number of cells carrying the mutation (the mosaic clone) is given by $N_m$:\n$$\nN_m = C_F \\times N = \\frac{1}{8} N\n$$\nThe number of cells not carrying the mutation (wild-type) is given by $N_w$:\n$$\nN_w = (1 - C_F) \\times N = \\left(1 - \\frac{1}{8}\\right) N = \\frac{7}{8} N\n$$\n\nThe problem specifies that the organism is diploid and there is no aneuploidy, so each somatic cell contains exactly $2$ alleles at any given autosomal locus. The mutation is a heterozygous single-nucleotide variant. This means:\n-   Each of the $N_m$ mutated cells has a genotype consisting of one variant allele (V) and one wild-type allele (W).\n-   Each of the $N_w$ non-mutated cells has a genotype consisting of two wild-type alleles (W, W).\n\nWe can now calculate the total number of variant alleles in the sample. These are found only in the mutated cells. Since each of the $N_m$ mutated cells is heterozygous, each contributes exactly $1$ variant allele.\n$$\n\\text{Total variant alleles} = N_m \\times 1 = \\frac{1}{8} N\n$$\n\nNext, we calculate the total number of all alleles (variant and wild-type) in the sample of $N$ cells. Since every cell is diploid, each contributes $2$ alleles to the locus.\n$$\n\\text{Total alleles} = N \\times 2 = 2N\n$$\n\nFinally, we can compute the VAF by taking the ratio of the total number of variant alleles to the total number of all alleles.\n$$\n\\text{VAF} = \\frac{\\frac{1}{8} N}{2N}\n$$\nThe variable $N$, representing the total number of cells, cancels out, which is expected as the VAF is an intensive property of the tissue, independent of the sample size (for a sufficiently large sample).\n$$\n\\text{VAF} = \\frac{1/8}{2} = \\frac{1}{16}\n$$\n\nThis result can also be expressed directly through the relationship between VAF and clone fraction for a diploid autosomal heterozygous mutation. The VAF is the product of the fraction of cells containing the mutation ($C_F$) and the fraction of alleles within those cells that are the variant. For a heterozygous mutation, this latter fraction is $\\frac{1}{2}$.\n$$\n\\text{VAF} = C_F \\times \\frac{1}{2} = \\frac{1}{8} \\times \\frac{1}{2} = \\frac{1}{16}\n$$\nThe derivation from first principles confirms this relationship. The expected VAF in the bulk tissue sample is therefore $\\frac{1}{16}$.", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "4315994"}, {"introduction": "Detecting a mosaic clone, especially a rare one, is fundamentally a sampling problem. Before investing in deep sequencing or complex analyses, it is crucial to determine if the experimental design has enough statistical power to find what you are looking for. This practice [@problem_id:4316031] guides you through a classic power calculation, using basic probability to determine the minimum number of cells one must analyze to detect a clone of a given size with a specified confidence level.", "problem": "In the analysis of somatic mosaicism for precision medicine and genomic diagnostics, consider a tissue in which a pathogenic clone occupies a fraction $f$ of cells. You perform single-cell sampling followed by perfectly sensitive and specific genotyping, such that each cell independently has probability $f$ of belonging to the clone and, if sampled, the clone status is correctly ascertained. Detection is defined as observing at least one clone-positive cell among the sampled cells. Assume independent sampling across cells.\n\nStarting from the foundational principles of probability for independent Bernoulli trials and the binomial distribution, derive the criterion for the number of sampled cells $N$ required to ensure that the probability of detection is at least a target value $p$. Then, for a clone fraction $f = 0.02$ and target detection probability $p = 0.95$, determine the smallest integer $N$ that satisfies this criterion. Report your final answer as the smallest integer number of cells. No rounding to significant figures is required because the quantity is an exact integer count.", "solution": "The problem describes a series of independent Bernoulli trials. For each of the $N$ cells sampled, the outcome is binary: the cell either belongs to the pathogenic clone (a \"success\") or it does not (a \"failure\"). The probability of success for any single trial is given as $f$.\n\nLet $X$ be the random variable representing the number of clone-positive cells observed in a sample of $N$ cells. Since the trials are independent and the probability of success is constant, $X$ follows a binomial distribution, denoted as $X \\sim \\text{Binomial}(N, f)$. The probability mass function for this distribution is given by:\n$$P(X=k) = \\binom{N}{k} f^k (1-f)^{N-k}$$\nwhere $k$ is the number of successes, with $k \\in \\{0, 1, 2, \\dots, N\\}$.\n\nDetection is defined as observing at least one clone-positive cell. This corresponds to the event $X \\ge 1$. The probability of detection is therefore $P(X \\ge 1)$. A direct calculation would involve summing the probabilities for $k=1, 2, \\dots, N$:\n$$P(X \\ge 1) = \\sum_{k=1}^{N} \\binom{N}{k} f^k (1-f)^{N-k}$$\nThis summation is cumbersome. It is more efficient to calculate the probability of the complementary event, which is failing to detect any clone-positive cells. This corresponds to the event $X=0$.\n$$P(X \\ge 1) = 1 - P(X=0)$$\nUsing the binomial probability mass function, we calculate $P(X=0)$:\n$$P(X=0) = \\binom{N}{0} f^0 (1-f)^{N-0} = 1 \\cdot 1 \\cdot (1-f)^N = (1-f)^N$$\nThus, the probability of detection is:\n$$P(\\text{detection}) = 1 - (1-f)^N$$\nThe problem requires that this probability of detection be at least $p$. This gives us the inequality:\n$$1 - (1-f)^N \\ge p$$\nThis inequality is the general criterion for the number of sampled cells $N$. To solve for $N$, we first rearrange the inequality:\n$$1 - p \\ge (1-f)^N$$\nTo isolate $N$, we can take the natural logarithm of both sides. Since $f$ and $p$ are probabilities between $0$ and $1$ (and not equal to $0$ or $1$ in this context), the terms $(1-p)$ and $(1-f)$ are both positive and less than $1$. The natural logarithm function, $\\ln(x)$, is monotonically increasing, so applying it to both sides preserves the direction of the inequality.\n$$\\ln(1-p) \\ge \\ln((1-f)^N)$$\nUsing the logarithm property $\\ln(a^b) = b \\ln(a)$, we get:\n$$\\ln(1-p) \\ge N \\ln(1-f)$$\nTo solve for $N$, we must divide by $\\ln(1-f)$. It is critical to note that since $0 < f < 1$, the term $1-f$ is between $0$ and $1$, which means $\\ln(1-f)$ is a negative number. When dividing an inequality by a negative number, the direction of the inequality must be reversed.\n$$N \\ge \\frac{\\ln(1-p)}{\\ln(1-f)}$$\nThis is the final derived criterion for $N$.\n\nNow, we must find the smallest integer $N$ that satisfies this criterion for the given values $f = 0.02$ and $p = 0.95$.\nSubstituting these values into the inequality:\n$$N \\ge \\frac{\\ln(1 - 0.95)}{\\ln(1 - 0.02)}$$\n$$N \\ge \\frac{\\ln(0.05)}{\\ln(0.98)}$$\nWe can evaluate the logarithms to find the numerical bound for $N$.\nThe natural logarithm of $0.05$ is approximately $-2.99573227355$.\nThe natural logarithm of $0.98$ is approximately $-0.02020270731$.\n$$N \\ge \\frac{-2.99573227355}{-0.02020270731}$$\n$$N \\ge 148.283$$\nThe problem requires the smallest integer number of cells, $N$, that satisfies this condition. Since $N$ must be an integer and greater than or equal to $148.283$, the smallest integer value is $149$.\nTo verify, if $N=148$, $P(\\text{detection}) = 1 - (0.98)^{148} \\approx 1 - 0.0505 \\approx 0.9495 < 0.95$.\nIf $N=149$, $P(\\text{detection}) = 1 - (0.98)^{149} \\approx 1 - 0.0495 \\approx 0.9505 \\ge 0.95$.\nTherefore, the smallest integer number of cells required is $149$.", "answer": "$$\\boxed{149}$$", "id": "4316031"}, {"introduction": "After detecting a variant, the next step is to accurately quantify the size of the mosaic clone. While simple ratios of read counts provide a rough estimate, a more rigorous approach is to use a statistical model that formally accounts for sampling variability and prior knowledge. In this advanced exercise [@problem_id:4316014], you will employ a Bayesian framework to estimate the clone fraction, deriving the posterior distribution that represents our updated belief about the parameter after observing the sequencing data.", "problem": "A somatic single-nucleotide variant is profiled by high-depth targeted sequencing in a heterogeneous tissue sample. Assume that the variant is present in a fraction $f$ of cells (the clone fraction) and the locus is in a constant total copy-number state $C$ across all cells. Under the simplifying assumption that among the $C$ chromosomal copies per cell, exactly one copy carries the variant in the cells that harbor the mutation and no copies carry the variant in the other cells, each sequencing read is an independent draw from a Bernoulli process with success probability $p = f/C$ for observing the alternate allele. Let $a$ and $r$ denote the observed counts of alternate and reference reads, respectively, so that the total number of reads is $n = a + r$. Condition on $n$ and model $A \\sim \\mathrm{Binomial}(n, p)$, where $A$ is the alternate read count.\n\nTo encode prior uncertainty about the per-read alternate probability, place a $\\mathrm{Beta}(\\alpha,\\beta)$ prior on $p$, where $\\alpha > 0$ and $\\beta > 0$. Assume that sequencing reads are independent and identically distributed conditional on $(p,n)$, and that the prior on $p$ is independent of $n$.\n\nStarting from Bayesâ€™ theorem, the probability mass function of the binomial distribution, and the probability density function of the beta distribution, derive the posterior distribution of $p$ given $(a,r)$ and hyperparameters $(\\alpha,\\beta)$. Then, using the linear transformation $f = C p$, compute the posterior mean of the clone fraction $f$ in closed form as a function of $(\\alpha,\\beta,a,r,C)$.\n\nProvide your final result as a single closed-form analytic expression for the posterior mean $\\mathbb{E}[f \\mid a,r,\\alpha,\\beta,C]$. No numerical evaluation is required, and no units are involved. Do not use percentages.", "solution": "The objective is to compute the posterior mean of the clone fraction, $\\mathbb{E}[f \\mid a, r, \\alpha, \\beta, C]$. This requires a two-step process: first, we determine the posterior distribution of the parameter $p$, and second, we use this distribution to find the posterior mean of $f$.\n\nThe derivation begins with Bayes' theorem, which states that the posterior probability distribution is proportional to the product of the likelihood and the prior distribution.\n$$ \\pi(p \\mid a, r) \\propto P(a \\mid p, n) \\cdot \\pi(p) $$\nHere, $\\pi(p \\mid a, r)$ is the posterior probability density function (PDF) of $p$ given the observed data $a$ and $r$ (and thus $n=a+r$). $P(a \\mid p, n)$ is the likelihood of observing $a$ alternate reads in $n$ total reads, and $\\pi(p)$ is the prior PDF of $p$.\n\nThe likelihood function is given by the probability mass function (PMF) of the Binomial distribution, $A \\sim \\mathrm{Binomial}(n, p)$. The probability of observing $a$ alternate reads and $r = n-a$ reference reads in a total of $n$ reads is:\n$$ P(a \\mid p, n) = \\binom{n}{a} p^a (1-p)^{n-a} $$\nSince we are concerned with the distribution of $p$, we can treat the binomial coefficient $\\binom{n}{a}$ as a normalizing constant that does not depend on $p$. Thus, the likelihood is proportional to:\n$$ P(a \\mid p, n) \\propto p^a (1-p)^{n-a} $$\nSubstituting $n-a = r$, we get:\n$$ P(a \\mid p, n) \\propto p^a (1-p)^r $$\n\nThe prior distribution for $p$ is given as a Beta distribution, $p \\sim \\mathrm{Beta}(\\alpha, \\beta)$. The PDF is:\n$$ \\pi(p) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} p^{\\alpha-1} (1-p)^{\\beta-1} $$\nfor $0 < p < 1$. The term involving the Gamma function, $\\Gamma(\\cdot)$, constitutes the normalizing constant, often written as $1/B(\\alpha, \\beta)$ where $B(\\cdot, \\cdot)$ is the Beta function. In the context of Bayes' theorem, we only need the kernel of the distribution, which is the part dependent on the parameter $p$:\n$$ \\pi(p) \\propto p^{\\alpha-1} (1-p)^{\\beta-1} $$\n\nNow, we multiply the likelihood and the prior to find the posterior distribution:\n$$ \\pi(p \\mid a, r) \\propto \\left( p^a (1-p)^r \\right) \\cdot \\left( p^{\\alpha-1} (1-p)^{\\beta-1} \\right) $$\nCombining the terms with the same base:\n$$ \\pi(p \\mid a, r) \\propto p^{a+\\alpha-1} (1-p)^{r+\\beta-1} $$\nThis expression is the kernel of a Beta distribution. By inspection, we can identify the parameters of this posterior distribution. A distribution $\\mathrm{Beta}(\\alpha', \\beta')$ has a kernel proportional to $p^{\\alpha'-1}(1-p)^{\\beta'-1}$. Comparing this form to our result, we can identify the posterior parameters as:\n$$ \\alpha' = a + \\alpha $$\n$$ \\beta' = r + \\beta $$\nTherefore, the posterior distribution of $p$ is a Beta distribution:\n$$ p \\mid a, r, \\alpha, \\beta \\sim \\mathrm{Beta}(a+\\alpha, r+\\beta) $$\nThis result is expected, as the Beta distribution is the conjugate prior for the Binomial likelihood.\n\nThe next step is to compute the posterior mean of the clone fraction $f$. We are given the linear relationship $f = C p$. Using the property of linearity of expectation, the posterior mean of $f$ is:\n$$ \\mathbb{E}[f \\mid a, r, \\alpha, \\beta, C] = \\mathbb{E}[C p \\mid a, r, \\alpha, \\beta] $$\n$$ \\mathbb{E}[f \\mid a, r, \\alpha, \\beta, C] = C \\cdot \\mathbb{E}[p \\mid a, r, \\alpha, \\beta] $$\nWe need to find the mean of the posterior distribution of $p$. The mean of a general Beta distribution, $\\mathrm{Beta}(\\alpha', \\beta')$, is given by the formula:\n$$ \\mathbb{E}[X] = \\frac{\\alpha'}{\\alpha' + \\beta'} \\quad \\text{for } X \\sim \\mathrm{Beta}(\\alpha', \\beta') $$\nFor our posterior distribution, $p \\mid a, r, \\alpha, \\beta \\sim \\mathrm{Beta}(a+\\alpha, r+\\beta)$, the mean is:\n$$ \\mathbb{E}[p \\mid a, r, \\alpha, \\beta] = \\frac{a+\\alpha}{(a+\\alpha) + (r+\\beta)} = \\frac{a+\\alpha}{a+r+\\alpha+\\beta} $$\n\nSubstituting this result back into the expression for the posterior mean of $f$:\n$$ \\mathbb{E}[f \\mid a, r, \\alpha, \\beta, C] = C \\cdot \\frac{a+\\alpha}{a+r+\\alpha+\\beta} $$\nThis is the final closed-form expression for the posterior mean of the clone fraction. It represents a weighted average of the observed data and the prior belief. The numerator is a sum of the observed alternate read count $a$ and the prior \"pseudo-count\" $\\alpha$. The denominator is the sum of all observed reads $a+r$ and all prior \"pseudo-counts\" $\\alpha+\\beta$. This is then scaled by the copy number $C$.", "answer": "$$\n\\boxed{C \\frac{a+\\alpha}{a+r+\\alpha+\\beta}}\n$$", "id": "4316014"}]}