{"hands_on_practices": [{"introduction": "A fundamental question in planning any metagenomic study is whether the sequencing depth is sufficient to detect and characterize a target pathogen. The concept of genome coverage provides a quantitative answer, linking experimental parameters like sequencing yield and pathogen abundance to the expected depth of data for a specific microbe. This exercise [@problem_id:4358557] guides you through a first-principles derivation of the coverage formula, a cornerstone calculation for experimental design in genomics.", "problem": "A clinical Whole Metagenome Shotgun (WMS) sequencing run using Next Generation Sequencing (NGS) produces $N$ independent reads of fixed length $L$ base pairs from a heterogeneous sample. Suppose a fraction $f$ of the sequenced reads originates from a single pathogen species whose haploid genome length is $G$ base pairs. Assume unbiased, uniform sampling of molecules across the sample, that read origins are correctly assigned to the pathogen when appropriate, and that end effects are negligible relative to $L \\ll G$. Using only fundamental definitions of sequencing yield and genome coverage, derive a closed-form analytic expression for the expected average genome coverage $C$ (dimensionless fold value) of the pathogen in terms of $N$, $L$, $f$, and $G$. Then, compute the numerical value of $C$ for $N = 5.0 \\times 10^{7}$ reads, $L = 150$ base pairs, $f = 10^{-3}$, and $G = 5$ megabases, where $1$ megabase equals $10^{6}$ base pairs. Express your final numerical answer as a dimensionless fold coverage and round to four significant figures.", "solution": "The user has provided a problem statement. I will now perform the mandatory validation procedure.\n\n### Step 1: Extract Givens\n- $N$: total number of independent reads\n- $L$: fixed length of each read in base pairs\n- $f$: fraction of reads originating from a single pathogen species\n- $G$: haploid genome length of the pathogen in base pairs\n- $C$: expected average genome coverage of the pathogen\n- Assumption: unbiased, uniform sampling of molecules\n- Assumption: read origins are correctly assigned\n- Assumption: end effects are negligible ($L \\ll G$)\n- Numerical values for computation:\n  - $N = 5.0 \\times 10^{7}$ reads\n  - $L = 150$ base pairs\n  - $f = 10^{-3}$\n  - $G = 5$ megabases, where $1$ megabase equals $10^{6}$ base pairs\n- Task 1: Derive a closed-form analytic expression for $C$ in terms of $N$, $L$, $f$, and $G$.\n- Task 2: Compute the numerical value of $C$ and round to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n\n- **Scientifically Grounded**: The problem is grounded in the fundamental principles of genomics and bioinformatics, specifically the concepts of shotgun sequencing and genome coverage. The scenario is a standard representation of a metagenomic experiment.\n- **Well-Posed**: The problem is well-posed. It provides all necessary parameters and simplifying assumptions (e.g., uniform sampling, negligible end effects) to derive a unique, meaningful solution for the expected average coverage.\n- **Objective**: The problem is stated in precise, objective, and quantitative terms. It is free of any subjective or opinion-based content.\n- **Flaw Checklist**: The problem does not exhibit any of the listed flaws.\n  1. It is scientifically and factually sound.\n  2. It is directly formalizable and highly relevant to the specified topic.\n  3. It is complete and internally consistent.\n  4. The provided numerical values are realistic for a modern Next Generation Sequencing (NGS) experiment.\n  5. It is well-structured and leads to a unique solution.\n  6. It is a fundamental but non-trivial conceptual problem in bioinformatics.\n  7. The derivation and result are mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\nThe problem asks for the derivation of the expected average genome coverage, $C$, of a pathogen from a metagenomic sequencing dataset, followed by a numerical calculation.\n\nFirst, we define the total amount of sequencing data generated in the experiment. The experiment produces $N$ reads, each of length $L$. Therefore, the total number of base pairs sequenced (the total yield) is the product of the number of reads and the length per read.\n$$\n\\text{Total Yield} = N \\times L\n$$\n\nNext, we determine the portion of this total yield that corresponds to the pathogen of interest. The problem states that a fraction $f$ of the reads originates from the pathogen. Since sampling is unbiased, this fraction also represents the proportion of the total sequenced bases that belong to the pathogen. The total number of base pairs sequenced from the pathogen, which we can denote as $B_{pathogen}$, is therefore:\n$$\nB_{pathogen} = f \\times (\\text{Total Yield}) = f \\times N \\times L\n$$\n\nThe average genome coverage, $C$, is defined as the total number of bases sequenced for a specific genome divided by the length of that genome. This gives a dimensionless \"fold\" value indicating, on average, how many times each base in the genome has been sequenced. Using the pathogen's genome length, $G$, we can write the definition of coverage as:\n$$\nC = \\frac{B_{pathogen}}{G}\n$$\n\nSubstituting the expression for $B_{pathogen}$ into the definition of $C$, we arrive at the closed-form analytic expression for the expected average genome coverage of the pathogen:\n$$\nC = \\frac{f \\times N \\times L}{G}\n$$\nThis completes the first part of the task.\n\nFor the second part, we must compute the numerical value of $C$ using the provided data. The given values are:\n- $N = 5.0 \\times 10^{7}$ reads\n- $L = 150$ base pairs (bp)\n- $f = 10^{-3}$\n- $G = 5$ megabases. We must convert this to base pairs. Since $1$ megabase is $10^{6}$ base pairs, $G = 5 \\times 10^{6}$ bp.\n\nNow, we substitute these values into our derived formula:\n$$\nC = \\frac{(10^{-3}) \\times (5.0 \\times 10^{7}) \\times (150)}{5 \\times 10^{6}}\n$$\n\nLet's simplify the expression.\nFirst, we calculate the numerator:\n$$\n\\text{Numerator} = 10^{-3} \\times 5.0 \\times 10^{7} \\times 150 = 5.0 \\times 10^{(7-3)} \\times 150 = 5.0 \\times 10^{4} \\times 150\n$$\n$$\n\\text{Numerator} = (5.0 \\times 150) \\times 10^{4} = 750 \\times 10^{4} = 7.5 \\times 10^{2} \\times 10^{4} = 7.5 \\times 10^{6}\n$$\n\nThe denominator is:\n$$\n\\text{Denominator} = 5 \\times 10^{6}\n$$\n\nNow, we compute the ratio for $C$:\n$$\nC = \\frac{7.5 \\times 10^{6}}{5 \\times 10^{6}} = \\frac{7.5}{5} = 1.5\n$$\n\nThe result is a dimensionless fold coverage of $1.5$X. The problem requires the answer to be rounded to four significant figures. To express $1.5$ with four significant figures, we add trailing zeros.\n$$\nC = 1.500\n$$\nThe assumptions of uniform sampling and correct read assignment are critical for this calculation, as they allow us to directly use the fraction $f$ to quantify the pathogen-specific sequencing yield. The assumption $L \\ll G$ ($150 \\ll 5 \\times 10^{6}$) justifies ignoring edge effects, such as reads that might extend off the end of a linear chromosome, which is a standard simplification in this type of analysis.", "answer": "$$\\boxed{1.500}$$", "id": "4358557"}, {"introduction": "In clinical metatranscriptomics, the vast majority of RNA in a sample is often non-informative host ribosomal RNA (rRNA), which can overwhelm the signal from low-abundance pathogens. Experimental techniques to deplete rRNA are therefore essential for enriching the proportion of useful sequence data. This problem [@problem_id:4358568] illustrates the quantitative impact of this crucial laboratory step, showing how to calculate the expected gain in pathogen reads after depletion.", "problem": "In a metatranscriptomic next-generation sequencing (mNGS) workflow for pathogen identification, a total RNA sample from a clinical specimen contains an initial ribosomal RNA (rRNA) fraction of $0.85$ and a non-ribosomal RNA (non-rRNA) fraction of $0.15$. The sample undergoes enzymatic rRNA depletion with efficiency $0.95$, where efficiency is defined as the fraction of rRNA molecules removed while leaving non-rRNA species (including viral RNA) unaffected. Library preparation and sequencing are performed so that the final read depth is normalized to be equal across the depleted and non-depleted libraries. Assume that sequencing reads are sampled randomly and proportionally to the molecular composition of the input library, and that rRNA depletion introduces no off-target loss or bias among non-rRNA species.\n\nUsing only first-principles definitions of mixture fractions, removal efficiency, and proportional sampling, derive the post-depletion fraction of non-rRNA in the depleted library and the expected fold-increase in viral reads relative to an otherwise identical non-depleted library at equal read depth. Express the non-rRNA fraction as a decimal between $0$ and $1$, and express the viral read gain as a unitless fold-change. Round both quantities to four significant figures.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of molecular biology and next-generation sequencing, specifically RNA-seq sample preparation. The provided data are internally consistent, and the problem is well-posed, objective, and contains sufficient information for a unique solution. The question can be formalized and solved using first principles of mixture fractions and proportional sampling.\n\nLet us define the initial state of the total RNA sample. The total number of RNA molecules is $N_{total}$. This sample is a two-component mixture of ribosomal RNA (rRNA) and non-ribosomal RNA (non-rRNA).\n\nThe initial fraction of rRNA is given as $F_{rRNA, pre} = 0.85$.\nThe initial fraction of non-rRNA is given as $F_{non-rRNA, pre} = 0.15$.\nThe sum of these fractions is $F_{rRNA, pre} + F_{non-rRNA, pre} = 0.85 + 0.15 = 1$, as expected.\n\nThe initial number of molecules for each component can be expressed as:\nInitial number of rRNA molecules: $N_{rRNA, pre} = F_{rRNA, pre} \\times N_{total}$\nInitial number of non-rRNA molecules: $N_{non-rRNA, pre} = F_{non-rRNA, pre} \\times N_{total}$\n\nThe sample undergoes enzymatic rRNA depletion with an efficiency of $\\eta = 0.95$. Efficiency is defined as the fraction of rRNA molecules removed. The process is specified to leave non-rRNA species unaffected.\n\nThe number of rRNA molecules removed is $\\eta \\times N_{rRNA, pre}$.\nThe number of rRNA molecules remaining after depletion is:\n$$N_{rRNA, post} = N_{rRNA, pre} - (\\eta \\times N_{rRNA, pre}) = (1 - \\eta) N_{rRNA, pre}$$\nSubstituting the initial fraction definition:\n$$N_{rRNA, post} = (1 - \\eta) F_{rRNA, pre} N_{total}$$\n\nSince non-rRNA species are unaffected, their number remains constant:\n$$N_{non-rRNA, post} = N_{non-rRNA, pre} = F_{non-rRNA, pre} N_{total}$$\n\nThe total number of molecules in the library after depletion, $N_{total, post}$, is the sum of the remaining rRNA and non-rRNA molecules:\n$$N_{total, post} = N_{rRNA, post} + N_{non-rRNA, post}$$\n$$N_{total, post} = (1 - \\eta) F_{rRNA, pre} N_{total} + F_{non-rRNA, pre} N_{total}$$\n$$N_{total, post} = \\left[ (1 - \\eta) F_{rRNA, pre} + F_{non-rRNA, pre} \\right] N_{total}$$\n\nThe first quantity to be derived is the post-depletion fraction of non-rRNA, $F_{non-rRNA, post}$. This is the ratio of the number of non-rRNA molecules after depletion to the total number of molecules after depletion.\n$$F_{non-rRNA, post} = \\frac{N_{non-rRNA, post}}{N_{total, post}} = \\frac{F_{non-rRNA, pre} N_{total}}{\\left[ (1 - \\eta) F_{rRNA, pre} + F_{non-rRNA, pre} \\right] N_{total}}$$\nThe term $N_{total}$ cancels, yielding a general formula:\n$$F_{non-rRNA, post} = \\frac{F_{non-rRNA, pre}}{(1 - \\eta) F_{rRNA, pre} + F_{non-rRNA, pre}}$$\nSubstituting the given numerical values: $F_{rRNA, pre} = 0.85$, $F_{non-rRNA, pre} = 0.15$, and $\\eta = 0.95$.\n$$F_{non-rRNA, post} = \\frac{0.15}{(1 - 0.95) \\times 0.85 + 0.15}$$\n$$F_{non-rRNA, post} = \\frac{0.15}{0.05 \\times 0.85 + 0.15} = \\frac{0.15}{0.0425 + 0.15} = \\frac{0.15}{0.1925}$$\n$$F_{non-rRNA, post} \\approx 0.779220779...$$\nRounding to four significant figures, the post-depletion fraction of non-rRNA is $0.7792$.\n\nThe second quantity to be derived is the expected fold-increase in viral reads, which we denote as $G$. Viral RNA is a component of the non-rRNA fraction. The problem states that sequencing reads are sampled randomly and proportionally to the molecular composition of the input library. This implies that the fraction of reads corresponding to a particular RNA species is equal to the molecular fraction of that species in the library being sequenced. The problem also states that depletion introduces no off-target loss or bias among non-rRNA species, which means the relative composition of the non-rRNA pool is unchanged.\n\nLet $c_{v}$ be the constant proportion of viral RNA within the non-rRNA fraction.\nThe molecular fraction of viral RNA in the non-depleted (pre-depletion) library is:\n$$F_{viral, pre} = \\frac{N_{viral, pre}}{N_{total}} = \\frac{c_v \\times N_{non-rRNA, pre}}{N_{total}} = c_v \\times F_{non-rRNA, pre}$$\nThe molecular fraction of viral RNA in the depleted (post-depletion) library is:\n$$F_{viral, post} = \\frac{N_{viral, post}}{N_{total, post}} = \\frac{c_v \\times N_{non-rRNA, post}}{N_{total, post}} = c_v \\times F_{non-rRNA, post}$$\nThe number of viral molecules is unchanged, $N_{viral, post} = N_{viral, pre}$, as it is part of the unaffected non-rRNA pool.\n\nThe fold-increase in viral reads, $G$, is the ratio of the fraction of viral reads in the depleted library to the fraction of viral reads in the non-depleted library. Since read fractions are proportional to molecular fractions, this is:\n$$G = \\frac{F_{viral, post}}{F_{viral, pre}} = \\frac{c_v \\times F_{non-rRNA, post}}{c_v \\times F_{non-rRNA, pre}}$$\nThe term $c_v$ cancels out, demonstrating that the result is independent of the initial abundance of the virus. The fold-increase is thus the ratio of the non-rRNA fraction after depletion to the non-rRNA fraction before depletion.\n$$G = \\frac{F_{non-rRNA, post}}{F_{non-rRNA, pre}}$$\nUsing the previously calculated unrounded value for $F_{non-rRNA, post}$ and the given value for $F_{non-rRNA, pre}$:\n$$G = \\frac{0.779220779...}{0.15} \\approx 5.19480519...$$\nRounding to four significant figures, the fold-increase is $5.195$.\n\nThe physical interpretation is that by removing a large portion of the non-target rRNA molecules, the remaining non-rRNA molecules (including viral RNA) are concentrated, making up a larger proportion of the final library. The gain in sequencing reads for any non-rRNA species is therefore equal to the enrichment factor of the total non-rRNA pool.\n\nThe two requested quantities are the post-depletion fraction of non-rRNA, rounded to four significant figures, and the viral read gain, rounded to four significant figures.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7792 & 5.195\n\\end{pmatrix}\n}\n$$", "id": "4358568"}, {"introduction": "Multiplexing samples on modern sequencers is efficient but carries the risk of index misassignment, where reads from one sample are incorrectly attributed to another, potentially causing false-positive pathogen calls. Quantifying this \"read hopping\" from high-biomass controls to low-biomass clinical samples is a critical quality control step in diagnostic metagenomics. This practice [@problem_id:4358600] provides a probabilistic model to estimate the expected number of contaminant reads, informing how to interpret low-level signals.", "problem": "A clinical laboratory performing metagenomic next-generation sequencing (mNGS) for pathogen identification multiplexes cerebrospinal fluid specimens for suspected central nervous system infections. In one sequencing run, there are $N = 96$ libraries: $N_{\\text{high}} = 1$ high-abundance positive-control library containing Escherichia coli DNA and $N_{\\text{low}} = 95$ low-biomass clinical libraries. The high-abundance library contributes $R_{\\text{high}} = 5.0 \\times 10^{6}$ reads mapping to Escherichia coli. The effective per-read index misassignment (index hopping plus any equivalent barcode misassignment) rate is $r = 0.002$ for this run. Assume that when a read is misassigned, it is equally likely to be assigned to any library other than its true origin, and that misassignments originating from low-biomass libraries into the high-abundance library are negligible for the purpose of this calculation.\n\nUsing only fundamental probability definitions of expected value applied to independent Bernoulli trials, derive from first principles the expected number of Escherichia coli contaminant reads in a single low-biomass library that result solely from misassignment of reads originating in the high-abundance library. State any additional minimal assumptions needed to make the calculation well-defined.\n\nRound your final result to four significant figures. Express the final expected number in reads.", "solution": "The problem statement is first validated for scientific soundness, consistency, and completeness before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe following quantities and conditions are provided in the problem statement:\n- Total number of libraries in the sequencing run: $N = 96$.\n- Number of high-abundance positive-control libraries: $N_{\\text{high}} = 1$.\n- Number of low-biomass clinical libraries: $N_{\\text{low}} = 95$.\n- Number of reads from the high-abundance library mapping to *Escherichia coli*: $R_{\\text{high}} = 5.0 \\times 10^{6}$.\n- Effective per-read index misassignment rate: $r = 0.002$.\n- Condition 1: When a read is misassigned, it is equally likely to be assigned to any library other than its true origin.\n- Condition 2: Misassignments originating from low-biomass libraries into the high-abundance library are negligible.\n- Task: Derive from first principles the expected number of *E. coli* contaminant reads in a single low-biomass library.\n- Constraint: The derivation must use fundamental probability definitions of expected value applied to independent Bernoulli trials.\n- Final Output: The result must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is set in the context of metagenomic next-generation sequencing (mNGS), a standard technique in modern genomic diagnostics. Index misassignment (or index hopping) is a well-documented artifact in multiplexed sequencing experiments. The values given for the number of libraries ($N=96$), number of reads for a control ($R_{\\text{high}} = 5.0 \\times 10^{6}$), and the misassignment rate ($r=0.002$) are realistic for a typical sequencing run on platforms like those from Illumina. The subject matter is directly relevant to the specified topic of *metagenomic sequencing for pathogen identification*.\n- **Well-Posed**: The problem is clearly stated and contains sufficient information to derive a unique solution. The numbers are consistent ($N_{\\text{high}} + N_{\\text{low}} = 1 + 95 = 96 = N$). The conditions provide a clear probabilistic model.\n- **Objective**: The problem is stated using precise, objective scientific language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically sound, self-contained, well-posed, and objective. It does not violate any of the invalidity criteria. Therefore, the problem is deemed **valid**, and a solution will be derived.\n\n### Solution Derivation\n\nThe objective is to calculate the expected number of reads that originate from the high-abundance *E. coli* control library but are incorrectly assigned to a specific low-biomass library due to index misassignment. We will derive this from first principles as requested.\n\nLet us consider a single read from the $R_{\\text{high}}$ reads originating in the high-abundance library. We are interested in the event that this specific read is misassigned and ends up in one particular low-biomass library. Let's refer to this specific library as the \"target library\".\n\nThe process can be modeled as a sequence of $R_{\\text{high}}$ independent Bernoulli trials, where each trial corresponds to one read. For each trial (i.e., for each read), a \"success\" is defined as the read being misassigned to our specific target library.\n\nLet $p$ be the probability of success for a single trial. This event occurs if two independent conditions are met:\n1.  The read is misassigned. The probability of this is given as the index misassignment rate, $P(\\text{misassigned}) = r$.\n2.  Given that the read is misassigned, it is assigned to our specific target library. The problem states that a misassigned read is equally likely to be assigned to any library other than its true origin. There are $N$ libraries in total, so there are $N-1$ possible destinations for a misassigned read. Since there are $N_{\\text{low}} = 95$ low-biomass libraries, and $N-1 = 96-1 = 95$, the set of possible destinations is exactly the set of all low-biomass libraries. The probability of the misassigned read landing in any one specific target library is therefore $P(\\text{to target} | \\text{misassigned}) = \\frac{1}{N-1}$.\n\nThe probability $p$ of a single read from the high-abundance library contaminating the specific target library is the product of the probabilities of these two events:\n$$p = P(\\text{misassigned}) \\times P(\\text{to target} | \\text{misassigned}) = r \\cdot \\frac{1}{N-1}$$\n\nNow, let $X$ be the random variable representing the total number of contaminant reads in the target library. We can express $X$ as the sum of $R_{\\text{high}}$ independent and identically distributed (i.i.d.) indicator random variables, $X_i$, for $i = 1, 2, \\dots, R_{\\text{high}}$:\n$$X = \\sum_{i=1}^{R_{\\text{high}}} X_i$$\nwhere $X_i=1$ if the $i$-th read is a \"success\" (contaminates the target library) and $X_i=0$ otherwise.\n\nThe expected value of a single indicator variable $X_i$ is, by definition:\n$$E[X_i] = (1 \\cdot P(X_i=1)) + (0 \\cdot P(X_i=0)) = P(X_i=1) = p$$\n\nBy the linearity of expectation, the expected value of the sum is the sum of the expected values:\n$$E[X] = E\\left[\\sum_{i=1}^{R_{\\text{high}}} X_i\\right] = \\sum_{i=1}^{R_{\\text{high}}} E[X_i]$$\nSince all $X_i$ are i.i.d., $E[X_i] = p$ for all $i$. Therefore:\n$$E[X] = \\sum_{i=1}^{R_{\\text{high}}} p = R_{\\text{high}} \\cdot p$$\n\nSubstituting the expression for $p$, we get the final formula for the expected number of contaminant reads:\n$$E[X] = R_{\\text{high}} \\cdot \\frac{r}{N-1}$$\n\nThis derivation from first principles adheres to the problem's constraints. The minimal assumptions made, which are largely explicit or implicit in the problem statement, are:\n1.  The misassignment of each of the $R_{\\text{high}}$ reads is an independent event (as stipulated by \"independent Bernoulli trials\").\n2.  The misassignment rate $r$ is constant for all reads originating from the high-abundance library.\n3.  A misassigned read's destination follows a discrete uniform probability distribution over the $N-1$ possible alternative libraries.\n\nWe can now substitute the given numerical values into the derived formula:\n- $R_{\\text{high}} = 5.0 \\times 10^{6}$\n- $r = 0.002$\n- $N = 96$, so $N-1 = 95$\n\n$$E[X] = (5.0 \\times 10^{6}) \\cdot \\frac{0.002}{95}$$\n$$E[X] = \\frac{5.0 \\times 10^{6} \\times 2 \\times 10^{-3}}{95} = \\frac{10 \\times 10^{3}}{95} = \\frac{10000}{95}$$\n$$E[X] \\approx 105.263157...$$\n\nThe problem requires the final result to be rounded to four significant figures.\n$$E[X] \\approx 105.3$$\n\nThe expected number of *Escherichia coli* contaminant reads in a single low-biomass library is $105.3$.", "answer": "$$\\boxed{105.3}$$", "id": "4358600"}]}