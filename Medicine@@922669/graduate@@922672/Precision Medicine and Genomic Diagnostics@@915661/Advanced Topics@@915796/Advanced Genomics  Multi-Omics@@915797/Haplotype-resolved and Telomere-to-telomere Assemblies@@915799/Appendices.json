{"hands_on_practices": [{"introduction": "The ultimate goal of a telomere-to-telomere (T2T) assembly is to produce a sequence that is not only complete but also exceptionally accurate. In precision medicine, where every base can have clinical significance, quantifying this accuracy is paramount. This exercise grounds your understanding of assembly quality in its most fundamental metric: the Phred-like quality value ($QV$), which provides a universal, logarithmic scale to express base-level error probabilities. By deriving the $QV$ function from first principles, you will gain a deeper appreciation for this cornerstone of genomics and its direct application in setting quality standards for clinical-grade assemblies [@problem_id:4348221].", "problem": "A telomere-to-telomere (T2T) haplotype-resolved assembly intended for precision oncology reporting must be benchmarked by its base-level consensus accuracy. The assembly accuracy is communicated on the Phred-like quality value (QV) scale that is widely used in genomic diagnostics. In this scale, a smaller consensus error probability per base, denoted by $e \\in (0,1)$, maps to a larger $QV$. The Phred-like mapping is defined by two fundamental properties of logarithmic decibel-like representations used for probabilities:\n1) Multiplicative changes in error probability correspond to additive changes on the scale: for any $e_{1}, e_{2} \\in (0,1)$, the difference $QV(e_{2}) - QV(e_{1})$ depends only on the ratio $e_{2}/e_{1}$ and is proportional to $\\log_{10}(e_{1}/e_{2})$ with proportionality constant $10$.\n2) The scale is anchored so that the worst possible consensus, $e=1$, has $QV(1)=0$.\n\nStarting only from these two properties and standard probability rules, derive an explicit expression for $QV$ as a function of $e$. Then, modeling the number of consensus base errors in an independently and identically distributed $1$ megabase segment as having expected value equal to $N e$ with $N=10^{6}$ bases, determine the minimal $QV$ threshold required to achieve fewer than one expected error per megabase. Express the final $QV$ as a single unitless number; no rounding is required.", "solution": "The problem is evaluated as valid, as it is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. The concepts of Phred-like quality scores (QV) and error probability are central to genomics, and the problem asks for a rigorous derivation and application of these principles.\n\nThe solution proceeds in two parts. First, we derive the explicit functional form of $QV(e)$ from the two given properties. Second, we use this function to determine the minimal quality score that satisfies the specified accuracy requirement.\n\nPart 1: Derivation of $QV(e)$\n\nThe problem defines the Phred-like quality value, $QV$, as a function of the consensus error probability per base, $e \\in (0,1)$. The function is defined by two properties.\n\nProperty 1 states that for any two error probabilities $e_1, e_2 \\in (0,1)$, the difference in their quality scores is proportional to the logarithm of their ratio:\n$$QV(e_{2}) - QV(e_{1}) = 10 \\log_{10}\\left(\\frac{e_{1}}{e_{2}}\\right)$$\nUsing the property of logarithms $\\log(a/b) = \\log(a) - \\log(b)$, we can rewrite the expression as:\n$$QV(e_{2}) - QV(e_{1}) = 10 \\left( \\log_{10}(e_{1}) - \\log_{10}(e_{2}) \\right)$$\nRearranging the terms of this equation to group variables of the same index gives:\n$$QV(e_{2}) + 10 \\log_{10}(e_{2}) = QV(e_{1}) + 10 \\log_{10}(e_{1})$$\nThis equation demonstrates that the quantity $QV(e) + 10 \\log_{10}(e)$ has the same value regardless of the specific error probability $e$ chosen. Therefore, this quantity must be a constant, which we will denote by $C$.\n$$QV(e) + 10 \\log_{10}(e) = C$$\nFrom this, we can express $QV(e)$ as:\n$$QV(e) = C - 10 \\log_{10}(e)$$\nTo determine the constant $C$, we use Property 2, which provides an anchor point for the scale. Property 2 states that for the worst possible consensus, where the error probability is $e=1$, the quality score is $QV(1)=0$. Substituting $e=1$ into our expression for $QV(e)$:\n$$QV(1) = C - 10 \\log_{10}(1)$$\nSince $\\log_{10}(1) = 0$, the equation simplifies to:\n$$0 = C - 10(0)$$\n$$C = 0$$\nHaving found that the constant of integration is $0$, we can write the final, explicit expression for the quality score as a function of error probability:\n$$QV(e) = -10 \\log_{10}(e)$$\nThis is the standard definition of the Phred quality score.\n\nPart 2: Determination of the Minimal $QV$ Threshold\n\nThe problem requires determining the minimal $QV$ threshold to ensure fewer than one expected error per megabase. A megabase corresponds to a segment of $N = 10^6$ bases. The problem states that the errors are independently and identically distributed, and the expected number of consensus base errors, denoted $E[\\text{errors}]$, in this segment is given by $N e$.\n\nThe condition is \"fewer than one expected error per megabase\", which translates to the strict inequality:\n$$E[\\text{errors}] < 1$$\nSubstituting the expression for the expected value, we get:\n$$N e < 1$$\nGiven $N = 10^6$, the inequality for the error probability $e$ becomes:\n$$10^6 e < 1$$\n$$e < \\frac{1}{10^6}$$\n$$e < 10^{-6}$$\nThe function $QV(e) = -10 \\log_{10}(e)$ is a monotonically decreasing function of $e$. This means that a smaller value of $e$ corresponds to a larger value of $QV$. Therefore, the inequality for $e$ can be transformed into an inequality for $QV$:\n$$QV(e) > QV(10^{-6})$$\nThe minimal $QV$ threshold is the value of $QV$ at the boundary of this condition, where $e = 10^{-6}$. We calculate this threshold value:\n$$QV_{\\text{threshold}} = -10 \\log_{10}(10^{-6})$$\nUsing the logarithm power rule, $\\log_{b}(x^y) = y \\log_{b}(x)$:\n$$QV_{\\text{threshold}} = -10 \\times (-6) \\log_{10}(10)$$\nSince $\\log_{10}(10) = 1$:\n$$QV_{\\text{threshold}} = -10 \\times (-6) \\times 1 = 60$$\nThus, to achieve an expected error rate of less than one base per million, the Phred-like quality score of the assembly must be greater than $60$. The minimal threshold is therefore $60$.", "answer": "$$\\boxed{60}$$", "id": "4348221"}, {"introduction": "Beyond base-level accuracy, a key feature of a genome assembly is its contiguity—the extent to which the genome is reconstructed in long, unbroken pieces. Metrics such as $N50$, $NG50$, and $E$-size were developed to quantify this. However, as assemblies approach the perfection of T2T, these traditional statistics can become misleading. This problem challenges you to not only calculate these metrics but, more importantly, to critically evaluate their limitations, exploring how they can mask serious structural errors like chimeric joins and haplotype phase switches [@problem_id:4348167]. Developing this critical perspective is essential for accurately assessing the true quality of a modern genome assembly.", "problem": "A phased de novo assembly of a diploid genome used for precision oncology profiling claims telomere-to-telomere (T2T) contiguity, meaning no assembly gaps remain across chromosomes. The estimated haploid genome size is $G = 300$ megabases (Mb). The contig lengths obtained when pooling sequences from both haplotypes are $150$ Mb, $130$ Mb, $90$ Mb, $80$ Mb, $50$ Mb, and $40$ Mb. From first principles, contiguity metrics are defined based on ordering contigs by length and either integrating cumulative length relative to a target total or taking expectations under uniform base sampling across the assembly. In a T2T context, however, gaps are absent but structural misassemblies may remain.\n\nWhich option correctly defines $N50$, $NG50$, and $E$-size, computes their values for the provided assembly, and explains a core limitation of these metrics for evaluating T2T assemblies, particularly when haplotypes are pooled?\n\nA. $N50$ is the contig length at which the cumulative assembled length first reaches $50\\%$ of the total assembled length; $NG50$ is the contig length at which the cumulative assembled length first reaches $50\\%$ of the haploid genome size $G$; $E$-size is the expected contig length when selecting a base uniformly at random from the assembly. For the given lengths, $N50 = 130$ Mb, $NG50 = 150$ Mb, and $E$-size $= \\dfrac{\\sum_i l_i^2}{\\sum_i l_i} = \\dfrac{58000}{540} \\approx 107.41$ Mb. These metrics quantify contiguity but do not assess structural correctness or haplotype phase fidelity; in gapless T2T assemblies, chimeric joins and phase switches can inflate $N50$, $NG50$, and $E$-size even when misassemblies persist, and pooling haplotypes further increases these values relative to per-haplotype assessments.\n\nB. $N50$ is the average of the longest $50\\%$ of contigs; $NG50$ is identical to $N50$ because both use $50\\%$ of the assembled length; $E$-size is the arithmetic mean contig length. For the given lengths, $N50 = 150$ Mb, $NG50 = 150$ Mb, and $E$-size $= \\dfrac{540}{6} = 90$ Mb. In a T2T assembly, the absence of gaps implies no misassemblies, so these metrics are both necessary and sufficient to judge correctness.\n\nC. $N50$ is the contig length at which cumulative assembled length reaches $50\\%$ of the diploid genome size $2G$; $NG50$ must be computed against $2G$ for diploid, so here it is the contig crossing $300$ Mb; $E$-size is the geometric mean of contig lengths. For the given lengths, $N50 = 150$ Mb, $NG50 = 130$ Mb, and $E$-size $= (150 \\cdot 130 \\cdot 90 \\cdot 80 \\cdot 50 \\cdot 40)^{1/6} \\approx 91$ Mb. Because $NG50$ uses $2G$, it is robust to haplotype pooling and reflects correctness in T2T assemblies.\n\nD. $N50$ is the median contig length; $NG50$ equals $G/2$ by definition regardless of contig ordering; $E$-size is the maximum contig length. For the given lengths, $N50 = 85$ Mb, $NG50 = 150$ Mb, and $E$-size $= 150$ Mb. In T2T assemblies, very high $N50$ or $E$-size directly demonstrates absence of misassemblies, making further validation unnecessary.", "solution": "Option A is the correct answer. This can be demonstrated by defining each metric, calculating its value for the given assembly, and evaluating the provided explanation of their limitations.\n\n**1. Definitions and Calculations**\n\nFirst, the provided contig lengths are sorted in descending order: 150 Mb, 130 Mb, 90 Mb, 80 Mb, 50 Mb, and 40 Mb.\nThe total assembled length is $L_{total} = 150 + 130 + 90 + 80 + 50 + 40 = 540$ Mb.\nThe estimated haploid genome size is $G = 300$ Mb.\n\n*   **N50**: This is the length of the contig such that 50% of the *total assembled length* ($L_{total}$) is contained in contigs of this length or longer.\n    -   Target length = $0.5 \\times L_{total} = 0.5 \\times 540 \\text{ Mb} = 270$ Mb.\n    -   Cumulative lengths: The first contig is 150 Mb. The sum of the first two is $150 + 130 = 280$ Mb.\n    -   Since the cumulative length surpasses 270 Mb with the second contig, the N50 is the length of that contig: **130 Mb**.\n\n*   **NG50**: This is the length of the contig such that 50% of the *estimated genome size* ($G$) is contained in contigs of this length or longer.\n    -   Target length = $0.5 \\times G = 0.5 \\times 300 \\text{ Mb} = 150$ Mb.\n    -   Cumulative lengths: The first contig is 150 Mb.\n    -   The cumulative length meets the target with the first contig. Therefore, the NG50 is the length of that contig: **150 Mb**.\n\n*   **E-size (Expected contig length)**: This is the length-weighted average contig size, calculated as $E = \\frac{\\sum_i l_i^2}{\\sum_i l_i}$.\n    -   $\\sum l_i^2 = 150^2 + 130^2 + 90^2 + 80^2 + 50^2 + 40^2 = 22500 + 16900 + 8100 + 6400 + 2500 + 1600 = 58000 \\text{ Mb}^2$.\n    -   $E = \\frac{58000 \\text{ Mb}^2}{540 \\text{ Mb}} \\approx \\textbf{107.41 Mb}$.\n\nThe definitions and calculated values in Option A ($N50=130$ Mb, $NG50=150$ Mb, $E$-size $\\approx 107.41$ Mb) are all correct.\n\n**2. Evaluation of Limitations**\n\nOption A correctly states that these metrics quantify contiguity but not structural correctness. In a T2T assembly, which is by definition gapless, the primary remaining errors are large-scale structural misassemblies, such as chimeric joins (incorrectly linking unrelated genomic segments) or haplotype phase switches (incorrectly swapping between parental chromosomes). Such errors create artificially long contigs, which *inflate* the values of N50, NG50, and E-size, giving a misleadingly optimistic view of assembly quality. The statement that pooling haplotypes exacerbates this is also correct, as it can hide phase switches within a single contig.\n\n**3. Analysis of Incorrect Options**\n\n*   **Option B**: Incorrectly defines N50 as an average and E-size as the arithmetic mean. It also incorrectly claims T2T assemblies have no misassemblies.\n*   **Option C**: Incorrectly defines N50 and NG50 relative to the diploid genome size ($2G$). The standard is total assembled length for N50 and haploid genome size ($G$) for NG50.\n*   **Option D**: Incorrectly defines N50 as the median and E-size as the maximum length. It also makes the false assertion that high contiguity metrics prove the absence of misassemblies.\n\nTherefore, Option A is the only choice that provides correct definitions, calculations, and a sound scientific interpretation of the metrics' limitations in the context of modern T2T assemblies.", "answer": "$$\\boxed{A}$$", "id": "4348167"}, {"introduction": "If simple contiguity metrics are insufficient to guarantee a correct T2T assembly, how do we find the errors that might remain? The answer lies in the integrative analysis of multiple, independent data types. This practice places you in the role of a genome detective, tasked with interpreting the tell-tale signatures of structural misassemblies as they appear in long-read alignments, paired-end mappings, and Hi-C contact maps. By learning to recognize the distinct patterns of inversions and translocations, you will understand how we validate the structural integrity of an assembly and build confidence in its use for downstream discovery and diagnostics [@problem_id:4348197].", "problem": "A telomere-to-telomere (T2T) haplotype-resolved assembly of a human genome is being evaluated for misassemblies using long-read alignments, paired-end short-read mappings, and High-throughput Chromosome Conformation Capture (Hi-C) contact maps that are phased by single-nucleotide polymorphisms to separate haplotype contacts. Consider one contig from haplotype H$1$ that contains two suspicious adjacencies (junctions) J$A$ and J$B$. The following observations are made:\n\n- Long-read alignments across J$A$ show split reads whose first segment maps to chromosome $1$ on the forward strand and whose second segment maps to a more proximal locus on chromosome $1$ on the reverse strand; the segments are immediately adjacent in the contig but align to reference loci in an order that is reversed with respect to the reference coordinate system. Paired-end short reads spanning J$A$ are enriched for away-facing orientations (for example, $\\mathrm{R}\\mathrm{F}$) and have apparent insert sizes exceeding the library mean by a large margin. The haplotype-resolved Hi-C map for H$1$ exhibits mirror-symmetric off-diagonal stripes centered on the two breakpoints flanking J$A$, superimposed on the expected decay of contact probability $P(s)$ with genomic separation $s$ along chromosome $1$.\n\n- Long-read alignments across J$B$ show split reads whose segments map to adjacent positions in the contig but to nonhomologous chromosomes in the reference, namely one segment to chromosome $1$ and the other to chromosome $8$. The haplotype-resolved Hi-C map for H$1$ shows a discrete interchromosomal contact block linking the chromosome $1$ locus to the chromosome $8$ locus; this block is absent in the haplotype H$2$ map, which shows only background noise between these loci.\n\nAssume the following well-tested facts as the fundamental base: in a correctly assembled linear chromosome, adjacent bases in the assembly correspond to adjacent loci in the true genome, so that long reads map contiguously without splits; paired-end reads have library-specific orientation and insert-size constraints; and in Hi-C data, contact probability $P(s)$ decays with increasing genomic distance $s$ and is enriched for cis contacts within the same chromosome and within the same haplotype phase, while structural rearrangements create characteristic off-diagonal or interchromosomal contact enrichments.\n\nWhich assignment of misassembly types to J$A$ and J$B$ best fits these data?\n\nA. J$A$ is a relocation (intrachromosomal transposition without orientation flip), and J$B$ is an inversion.\n\nB. J$A$ is an inversion (orientation flip within the same chromosome), and J$B$ is a translocation (interchromosomal adjacency).\n\nC. J$A$ is a relocation (intrachromosomal transposition), and J$B$ is a translocation, because symmetric stripes in Hi-C arise from any intrachromosomal adjacency.\n\nD. J$A$ is a translocation and J$B$ is a relocation, because interchromosomal Hi-C blocks can reflect repetitive sequence bleed-through rather than adjacency.\n\nE. Both J$A$ and J$B$ are relocations, because off-diagonal Hi-C enrichments indicate physical proximity irrespective of chromosome identity.", "solution": "The problem statement must first be validated for scientific soundness, clarity, and completeness.\n\n**Step 1: Extract Givens**\n\n-   **System**: A telomere-to-telomere (T2T) haplotype-resolved assembly of a human genome.\n-   **Data Types**: Long-read alignments, paired-end short-read mappings, and haplotype-resolved High-throughput Chromosome Conformation Capture (Hi-C) contact maps.\n-   **Contig**: A single contig from haplotype H$1$.\n-   **Junction J$A$ Observations**:\n    1.  **Long-reads**: Split reads across J$A$. First segment maps to chromosome $1$ (forward strand). Second segment maps to a more proximal locus on chromosome $1$ (reverse strand). Segments are adjacent in the contig, but the reference loci order is reversed.\n    2.  **Paired-end reads**: Enriched for away-facing orientations (e.g., $\\mathrm{R}\\mathrm{F}$). Apparent insert sizes are much larger than the library mean.\n    3.  **Hi-C (H$1$)**: Mirror-symmetric off-diagonal stripes centered on breakpoints, superimposed on the typical $P(s)$ vs. $s$ decay on chromosome $1$.\n-   **Junction J$B$ Observations**:\n    1.  **Long-reads**: Split reads across J$B$. Segments are adjacent in the contig but map to nonhomologous chromosomes: one to chromosome $1$, the other to chromosome $8$.\n    2.  **Hi-C (H$1$)**: A discrete interchromosomal contact block linking the chromosome $1$ locus and the chromosome $8$ locus.\n    3.  **Hi-C (H$2$)**: The interchromosomal block is absent; only background noise is observed.\n-   **Fundamental Principles**:\n    1.  Correct assemblies have contiguous long-read mappings.\n    2.  Correct assemblies adhere to paired-end library constraints (orientation, insert size).\n    3.  Hi-C contact probability $P(s)$ decays with genomic distance $s$, is enriched for cis-contacts, and shows characteristic patterns for structural rearrangements.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is scientifically grounded, well-posed, and objective.\n-   **Scientific Grounding**: The problem uses standard terminology, data types (long-reads, short-reads, Hi-C), and concepts from the field of genome assembly and structural variation analysis. The described data signatures for different types of rearrangements are canonical and factually correct.\n-   **Well-Posedness**: The problem provides a set of specific observations and asks for the best-fitting explanation (misassembly types) from a given set of options. The information is sufficient and self-contained to arrive at a logical conclusion.\n-   **Objectivity**: The problem describes data patterns using precise, technical language (e.g., \"away-facing orientations\", \"interchromosomal contact block\") without subjective or ambiguous phrasing.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. A solution can be derived.\n\n**Derivation of the Solution**\n\nThe nature of the misassemblies at junctions J$A$ and J$B$ can be deduced by interpreting the provided multi-modal genomic data.\n\n**Analysis of Junction J$A$**\n\n1.  **Long-Read Evidence**: The long reads are split. One segment maps to a locus on chromosome $1$ on the forward strand, while the adjacent segment in the contig maps to a different locus on chromosome $1$ but on the *reverse* strand. The fact that the order of the mapped loci in the reference is reversed relative to their order in the contig, combined with the change in strand orientation (forward to reverse), is the classic signature of an **inversion**. The assembler has erroneously joined the sequence flanking one side of an inverted segment to the sequence flanking the other side.\n\n2.  **Paired-End Short-Read Evidence**: Reads spanning an inversion breakpoint will often map in an abnormal orientation. The standard orientation for paired-end reads is inward-facing (`F-R`, or `--> <--`). An inversion boundary causes one of the flanking sequences to be inverted, leading to read pairs mapping in an outward-facing or away-facing orientation (e.g., `R-F` or `<-- -->`). The reported enrichment for `R-F` orientation confirms the presence of an inversion. The large apparent insert size is also expected, as the reads span the junction in the assembled contig but map to what are now distant loci in the linear reference genome coordinate system. This evidence strongly supports an **inversion**.\n\n3.  **Hi-C Evidence**: Hi-C measures 3D proximity. An inversion folds a chromosome segment back on itself, bringing the ends of the inverted region into close spatial proximity. When plotted against the linear reference genome, this creates characteristic off-diagonal interaction signals. The description of \"mirror-symmetric off-diagonal stripes centered on the two breakpoints\" is consistent with the \"bow-tie\" or \"X-shape\" pattern that is a hallmark of a chromosomal **inversion** in a Hi-C map.\n\n*Conclusion for J$A$*: All three sources of evidence—long-reads, paired-end reads, and Hi-C—converge on the conclusion that J$A$ represents an **inversion**.\n\n**Analysis of Junction J$B$**\n\n1.  **Long-Read Evidence**: The split reads at J$B$ have segments mapping to two different chromosomes: chromosome $1$ and chromosome $8$. An adjacency in a contig that corresponds to an adjacency between two different chromosomes in the true genome is the definition of an interchromosomal **translocation**.\n\n2.  **Hi-C Evidence**: In a genome-wide Hi-C contact map, interactions between different chromosomes (interchromosomal) appear in off-diagonal blocks. These are typically sparse, representing a low background of random contacts. A translocation brings a region from one chromosome into permanent physical adjacency with a region of another chromosome. This results in a new, strong, localized enrichment of contacts between the two chromosomes, which appears as a \"discrete interchromosomal contact block\". This is the canonical Hi-C signature for a **translocation**.\n\n3.  **Haplotype-Resolved Evidence**: The fact that this contact block is present in the H$1$ haplotype map but absent in the H$2$ map indicates that the translocation is a real, heterozygous structural variant present on the chromosome copy corresponding to H$1$. This rules out a global assembly or mapping artifact and reinforces the conclusion that J$B$ represents a **translocation**.\n\n*Conclusion for J$B$*: The long-read and haplotype-resolved Hi-C data unequivocally identify J$B$ as a **translocation**.\n\n**Summary**: J$A$ is an inversion. J$B$ is a translocation.\n\n**Evaluation of Options**\n\n-   **A. J$A$ is a relocation (intrachromosomal transposition without orientation flip), and J$B$ is an inversion.**\n    -   This is incorrect. J$A$ is an inversion due to the orientation flip signature. J$B$ is a translocation, not an inversion. **Incorrect**.\n\n-   **B. J$A$ is an inversion (orientation flip within the same chromosome), and J$B$ is a translocation (interchromosomal adjacency).**\n    -   This assignment aligns perfectly with the analysis. J$A$'s characteristics (split reads with orientation flip, `R-F` pairs, symmetric Hi-C stripes) point to an inversion. J$B$'s characteristics (split reads across chromosomes, interchromosomal Hi-C block) point to a translocation. **Correct**.\n\n-   **C. J$A$ is a relocation (intrachromosomal transposition), and J$B$ is a translocation, because symmetric stripes in Hi-C arise from any intrachromosomal adjacency.**\n    -   J$A$ is misidentified; the evidence points to an inversion, not a simple relocation. The reasoning provided is also flawed; the specific pattern of \"mirror-symmetric stripes\" is characteristic of inversions, not all intrachromosomal rearrangements. **Incorrect**.\n\n-   **D. J$A$ is a translocation and J$B$ is a relocation, because interchromosomal Hi-C blocks can reflect repetitive sequence bleed-through rather than adjacency.**\n    -   The entire assignment is incorrect. J$A$ is an intrachromosomal event (inversion). J$B$ is an interchromosomal event (translocation). While the caveat about repetitive sequences is a valid concern in Hi-C analysis, it is contradicted here by the converging evidence from long reads and the haplotype-specific nature of the signal. **Incorrect**.\n\n-   **E. Both J$A$ and J$B$ are relocations, because off-diagonal Hi-C enrichments indicate physical proximity irrespective of chromosome identity.**\n    -   This option uses a vague term (\"relocations\") and misinterprets the data. J$A$ is specifically an inversion. J$B$ is a translocation. The reasoning is overly simplistic, as the *pattern* of Hi-C enrichment, not just its presence, is diagnostic of the rearrangement type. **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "4348197"}]}