{"hands_on_practices": [{"introduction": "Integrating diverse single-cell datasets begins with robust, modality-specific normalization. For single-cell RNA sequencing (scRNA-seq), a primary challenge is to account for variations in library size, or sequencing depth, across cells. This practice introduces the standard log-normalization workflow, a foundational procedure that transforms raw transcript counts into a stabilized, comparable measure of gene expression, which is essential for nearly all downstream analyses. [@problem_id:4607704]", "problem": "A clinical study aims to integrate single-cell RNA sequencing (scRNA-seq) and single-cell Assay for Transposase-Accessible Chromatin using sequencing (scATAC-seq) profiles to discover gene regulatory programs associated with therapy response in a heterogeneous tumor microenvironment. To construct a joint latent space, the scRNA-seq modality must first be transformed to a stabilized, relative abundance scale that is comparable across cells of varying sequencing depths. In scRNA-seq, Unique Molecular Identifier (UMI) counts $c_{ig}$ for gene $g$ in cell $i$ are proportional to the number of captured transcript molecules, and the total $\\sum_{g} c_{ig}$ reflects the library size for cell $i$.\n\nStarting from the following well-tested processing steps grounded in standard practice for single-cell transcript quantification:\n- Relative abundance is obtained by dividing the raw count for a gene by the cell’s total UMI count, yielding a fraction $c_{ig} / \\sum_{g} c_{ig}$.\n- To render the scale interpretable and mitigate the extreme sparsity typical in single-cell data while maintaining comparability across cells, this fraction is rescaled to counts per $10^{4}$ by multiplying by $10^{4}$.\n- To stabilize variance and dampen the influence of highly expressed genes, apply a logarithm with base $2$ to the rescaled quantity, adding a pseudocount of $1$ before the log to avoid taking a logarithm of zero.\n\nUsing these definitions, derive the symbolic expression for the log-normalized expression $\\tilde{x}_{ig}$ and then compute its value for a cell with raw UMI count $c_{ig} = 50$ for a particular gene and total UMI count $\\sum_{g} c_{ig} = 5000$. Express your final answer as a dimensionless value and round to four significant figures.", "solution": "The problem statement is a valid and well-posed request within the domain of bioinformatics and computational biology. It describes a standard procedure for single-cell RNA sequencing (scRNA-seq) data normalization, a critical preprocessing step for downstream analyses such as multi-omics integration. All provided information is scientifically sound, self-contained, and sufficient to derive a unique solution.\n\nThe task is to first derive the symbolic expression for the log-normalized expression, denoted as $\\tilde{x}_{ig}$, for gene $g$ in cell $i$, and then to compute its numerical value given specific UMI counts. We will follow the prescribed sequence of operations.\n\nLet $c_{ig}$ be the raw Unique Molecular Identifier (UMI) count for gene $g$ in cell $i$.\nLet $C_i = \\sum_{g} c_{ig}$ be the total UMI count for cell $i$, which is also referred to as the library size of the cell.\n\nThe normalization process consists of three defined steps:\n\nStep 1: Compute the relative abundance of the gene's transcripts in the cell. This is achieved by dividing the raw count for the gene by the total UMI count for the cell.\n$$ \\text{Relative Abundance} = \\frac{c_{ig}}{C_i} = \\frac{c_{ig}}{\\sum_{g} c_{ig}} $$\n\nStep 2: Rescale the relative abundance to a common scale, typically \"counts per 10,000\" (CP10k) or \"transcripts per 10,000\" (TP10k), to facilitate comparison across cells with different library sizes. This is done by multiplying the relative abundance by a scale factor of $10^4$.\n$$ \\text{Rescaled Value} = \\left( \\frac{c_{ig}}{\\sum_{g} c_{ig}} \\right) \\times 10^4 $$\n\nStep 3: Apply a log-transformation to the rescaled value. This transformation helps to stabilize the variance across genes with different expression levels and reduces the skewness of the data distribution. A pseudocount of $1$ is added before taking the logarithm to ensure that the argument of the logarithm is always positive, thus avoiding issues with genes that have zero counts. The base of the logarithm is specified as $2$.\nThe log-normalized expression $\\tilde{x}_{ig}$ is therefore:\n$$ \\tilde{x}_{ig} = \\log_{2}\\left( \\left( \\frac{c_{ig}}{\\sum_{g} c_{ig}} \\right) \\times 10^4 + 1 \\right) $$\nThis is the required symbolic expression.\n\nNow, we will compute the value of $\\tilde{x}_{ig}$ for the given data:\n- Raw UMI count for the gene of interest: $c_{ig} = 50$\n- Total UMI count for the cell: $\\sum_{g} c_{ig} = 5000$\n\nSubstituting these values into the symbolic expression:\n$$ \\tilde{x}_{ig} = \\log_{2}\\left( \\left( \\frac{50}{5000} \\right) \\times 10^4 + 1 \\right) $$\n\nFirst, we calculate the fraction:\n$$ \\frac{50}{5000} = \\frac{5}{500} = \\frac{1}{100} = 0.01 $$\n\nNext, we perform the rescaling:\n$$ 0.01 \\times 10^4 = 0.01 \\times 10000 = 100 $$\n\nThen, we add the pseudocount of $1$:\n$$ 100 + 1 = 101 $$\n\nFinally, we take the logarithm with base $2$:\n$$ \\tilde{x}_{ig} = \\log_{2}(101) $$\n\nTo compute the numerical value, we can use the change of base formula for logarithms, $\\log_{b}(a) = \\frac{\\ln(a)}{\\ln(b)}$:\n$$ \\tilde{x}_{ig} = \\frac{\\ln(101)}{\\ln(2)} $$\n\nUsing standard values for natural logarithms:\n$$ \\ln(101) \\approx 4.6151205168 $$\n$$ \\ln(2) \\approx 0.6931471806 $$\n\n$$ \\tilde{x}_{ig} \\approx \\frac{4.6151205168}{0.6931471806} \\approx 6.6582115934 $$\n\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $6$, $6$, $5$, and $8$. The fifth significant figure is $2$, which is less than $5$, so we round down (i.e., we do not change the last digit).\n\nTherefore, the log-normalized expression value is approximately $6.658$. This value is dimensionless, as the units of counts in the numerator and denominator of the initial fraction cancel out.", "answer": "$$\n\\boxed{6.658}\n$$", "id": "4607704"}, {"introduction": "Similar to transcriptomics, single-cell chromatin accessibility data from methods like scATAC-seq requires its own specialized feature engineering to become meaningful. Due to the sparse nature of accessibility data, a different strategy is needed to highlight biologically relevant regulatory elements. This exercise demonstrates the application of the term frequency-inverse document frequency (TF-IDF) transformation, a technique adapted from natural language processing to weigh chromatin peaks by both their abundance within a cell and their rarity across a population. [@problem_id:4381593]", "problem": "In single-cell Assay for Transposase-Accessible Chromatin using sequencing (scATAC-seq), integration with single-cell ribonucleic acid sequencing (scRNA-seq) for precision medicine and genomic diagnostics often requires constructing a feature representation of chromatin accessibility that is robust to variability in sequencing depth across cells and prevalence of peaks across the population. A widely used approach adapts term-frequency inverse-document-frequency (TF-IDF), originally from information retrieval, to weight each peak in each cell.\n\nConsider a dataset with $N$ cells and a peak $j$ that is observed (nonzero fragments) in $n_{j}$ cells. For a given cell $i$, let $x_{ij}$ denote the fragment count for peak $j$ and let $\\sum_{k} x_{ik}$ denote the total fragment count across all peaks in the feature space for cell $i$. Use the foundational definitions:\n- Term frequency is the within-cell relative abundance, defined as the fraction of fragments assigned to peak $j$ in cell $i$.\n- Inverse document frequency is the global rarity weight, defined by the natural logarithm of the ratio of the total number of cells to the number of cells in which peak $j$ is observed.\n\nStarting from these definitions, construct the combined TF-IDF weight for peak $j$ in cell $i$ and apply it to the following scientifically realistic scenario used in multi-omics integration pipelines:\n- Total number of cells $N = 1200$.\n- For the specific peak $j^{\\ast}$, the number of cells with $x_{ij^{\\ast}} > 0$ is $n_{j^{\\ast}} = 96$.\n- For the specific cell $i^{\\ast}$, the count for the peak is $x_{i^{\\ast} j^{\\ast}} = 9$ and the total fragments across all peaks is $\\sum_{k} x_{i^{\\ast} k} = 1875$.\n\nCompute the TF-IDF weight for $\\left(i^{\\ast}, j^{\\ast}\\right)$ using the natural logarithm. Round your final numerical answer to four significant figures. Do not include any units in your final answer.", "solution": "The problem asks for the computation of a Term-Frequency Inverse-Document-Frequency (TF-IDF) weight for a specific peak in a specific cell from a single-cell Assay for Transposase-Accessible Chromatin using sequencing (scATAC-seq) dataset. I will first validate the problem statement and then proceed to the solution if it is valid.\n\n### Step 1: Extract Givens\nThe data and definitions provided in the problem statement are:\n-   Total number of cells: $N$\n-   Number of cells where peak $j$ is observed: $n_j$\n-   Fragment count for peak $j$ in cell $i$: $x_{ij}$\n-   Total fragment count across all peaks in cell $i$: $\\sum_{k} x_{ik}$\n-   Definition of Term Frequency (TF) for peak $j$ in cell $i$: \"the fraction of fragments assigned to peak $j$ in cell $i$.\"\n-   Definition of Inverse Document Frequency (IDF) for peak $j$: \"the natural logarithm of the ratio of the total number of cells to the number of cells in which peak $j$ is observed.\"\n-   Specific scenario values:\n    -   Total cells: $N = 1200$\n    -   For a specific peak $j^{\\ast}$, the number of cells with nonzero fragments is $n_{j^{\\ast}} = 96$.\n    -   For a specific cell $i^{\\ast}$, the fragment count for peak $j^{\\ast}$ is $x_{i^{\\ast} j^{\\ast}} = 9$.\n    -   For the same cell $i^{\\ast}$, the total fragment count is $\\sum_{k} x_{i^{\\ast} k} = 1875$.\n-   The task is to compute the TF-IDF weight for the pair $(i^{\\ast}, j^{\\ast})$ and round the numerical result to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n-   **Scientifically Grounded**: The problem describes the TF-IDF transformation, a well-established method used in computational biology to normalize and weight features in high-dimensional single-cell data like scATAC-seq. The application to integrating scATAC-seq with scRNA-seq for precision medicine is a current and relevant topic. The definitions and numerical values are scientifically realistic.\n-   **Well-Posed**: The problem provides explicit definitions for TF and IDF, all necessary numerical values ($N$, $n_{j^{\\ast}}$, $x_{i^{\\ast}j^{\\ast}}$, and $\\sum_k x_{i^{\\ast}k}$), and a clear objective. A unique solution exists and is computable.\n-   **Objective**: The problem is stated in precise, objective language, free of bias or subjective claims.\n-   **Incomplete or Contradictory Setup**: The problem is self-contained and provides all necessary information for the calculation. There are no contradictions.\n-   **Unrealistic or Infeasible**: The provided numerical values are plausible for a typical scATAC-seq experiment.\n\nThe problem statement is scientifically sound, well-posed, objective, and complete.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. The solution will be derived based on the provided definitions and data.\n\n### Solution Derivation\nThe TF-IDF weight, which we denote as $W_{ij}$ for peak $j$ in cell $i$, is the product of the Term Frequency ($\\text{TF}_{ij}$) and the Inverse Document Frequency ($\\text{IDF}_j$).\n$$ W_{ij} = \\text{TF}_{ij} \\times \\text{IDF}_j $$\n\nFirst, we formalize the Term Frequency based on its definition: \"the fraction of fragments assigned to peak $j$ in cell $i$.\" This translates to the mathematical expression:\n$$ \\text{TF}_{ij} = \\frac{x_{ij}}{\\sum_{k} x_{ik}} $$\nThis term quantifies the relative abundance of the peak's accessibility signal within a single cell, normalized by the cell's total sequencing depth.\n\nNext, we formalize the Inverse Document Frequency: \"the natural logarithm of the ratio of the total number of cells to the number of cells in which peak $j$ is observed.\" This translates to:\n$$ \\text{IDF}_j = \\ln\\left(\\frac{N}{n_j}\\right) $$\nThis term gives higher weight to peaks that are rare across the cell population, thereby highlighting features that may be specific to certain cell subpopulations.\n\nCombining these two expressions, the full formula for the TF-IDF weight is:\n$$ W_{ij} = \\left( \\frac{x_{ij}}{\\sum_{k} x_{ik}} \\right) \\times \\ln\\left(\\frac{N}{n_j}\\right) $$\n\nNow, we apply this formula to the specific case of cell $i^{\\ast}$ and peak $j^{\\ast}$ using the provided numerical values:\n-   $N = 1200$\n-   $n_{j^{\\ast}} = 96$\n-   $x_{i^{\\ast} j^{\\ast}} = 9$\n-   $\\sum_{k} x_{i^{\\ast} k} = 1875$\n\nFirst, we compute the $\\text{TF}_{i^{\\ast}j^{\\ast}}$ component:\n$$ \\text{TF}_{i^{\\ast}j^{\\ast}} = \\frac{x_{i^{\\ast} j^{\\ast}}}{\\sum_{k} x_{i^{\\ast} k}} = \\frac{9}{1875} = 0.0048 $$\n\nNext, we compute the $\\text{IDF}_{j^{\\ast}}$ component:\n$$ \\text{IDF}_{j^{\\ast}} = \\ln\\left(\\frac{N}{n_{j^{\\ast}}}\\right) = \\ln\\left(\\frac{1200}{96}\\right) = \\ln(12.5) $$\nUsing a calculator for the natural logarithm:\n$$ \\ln(12.5) \\approx 2.5257286 $$\n\nFinally, we compute the TF-IDF weight $W_{i^{\\ast}j^{\\ast}}$ by multiplying the two components:\n$$ W_{i^{\\ast}j^{\\ast}} = \\text{TF}_{i^{\\ast}j^{\\ast}} \\times \\text{IDF}_{j^{\\ast}} = 0.0048 \\times \\ln(12.5) $$\n$$ W_{i^{\\ast}j^{\\ast}} \\approx 0.0048 \\times 2.5257286 \\approx 0.012123497 $$\n\nThe problem requires the final answer to be rounded to four significant figures. The first significant digit is the $1$ in the hundredths place. The first four significant digits are $1, 2, 1, 2$. The fifth significant digit is $3$, which is less than $5$, so we round down.\n$$ W_{i^{\\ast}j^{\\ast}} \\approx 0.01212 $$\nThis is the final numerical answer.", "answer": "$$\\boxed{0.01212}$$", "id": "4381593"}, {"introduction": "Once individual modalities are preprocessed, the core challenge of integration is to synthesize them into a single, cohesive biological representation. The Weighted Nearest Neighbor (WNN) algorithm offers an elegant solution by constructing a unified cell-cell similarity graph that balances the information from each data type. This practice provides a hands-on walk-through of the WNN method, where you will calculate cell-specific modality weights and use them to define an integrated distance metric, revealing cellular relationships that might be missed by any single modality alone. [@problem_id:4607733]", "problem": "Consider five single cells, labeled $C_{1}, C_{2}, C_{3}, C_{4}, C_{5}$. For each pair of cells, you are given their modality-specific dissimilarities measured as Euclidean distances after standard normalization in the Ribonucleic Acid (RNA) space and in the Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq) space. The goal is to construct a fused directed $k$-Nearest Neighbors (kNN) graph using the Weighted Nearest Neighbor (WNN) integration approach for $k=2$.\n\nFundamental base to use:\n- A $k$-Nearest Neighbors graph on a metric space assigns to each query point its $k$ smallest-distance neighbors under the specified query-to-candidate distance.\n- Weighted Nearest Neighbor integration defines, for each query cell, an integrated query-to-candidate dissimilarity as a convex combination of modality-specific dissimilarities, with modality weights reflecting the query cell’s modality-specific signal strength. The weights are determined from the provided per-cell signal-to-noise values by normalization so that they are nonnegative and sum to $1$ for each query cell.\n\nData:\n- Pairwise RNA distances $d_{\\mathrm{RNA}}(C_{i}, C_{j})$ for $i<j$:\n  - $d_{\\mathrm{RNA}}(C_{1}, C_{2}) = 1.2$, $d_{\\mathrm{RNA}}(C_{1}, C_{3}) = 3.5$, $d_{\\mathrm{RNA}}(C_{1}, C_{4}) = 2.0$, $d_{\\mathrm{RNA}}(C_{1}, C_{5}) = 3.0$.\n  - $d_{\\mathrm{RNA}}(C_{2}, C_{3}) = 2.8$, $d_{\\mathrm{RNA}}(C_{2}, C_{4}) = 1.5$, $d_{\\mathrm{RNA}}(C_{2}, C_{5}) = 2.7$.\n  - $d_{\\mathrm{RNA}}(C_{3}, C_{4}) = 3.2$, $d_{\\mathrm{RNA}}(C_{3}, C_{5}) = 1.1$.\n  - $d_{\\mathrm{RNA}}(C_{4}, C_{5}) = 2.9$.\n- Pairwise ATAC-seq distances $d_{\\mathrm{ATAC}}(C_{i}, C_{j})$ for $i<j$:\n  - $d_{\\mathrm{ATAC}}(C_{1}, C_{2}) = 2.6$, $d_{\\mathrm{ATAC}}(C_{1}, C_{3}) = 2.9$, $d_{\\mathrm{ATAC}}(C_{1}, C_{4}) = 3.4$, $d_{\\mathrm{ATAC}}(C_{1}, C_{5}) = 1.3$.\n  - $d_{\\mathrm{ATAC}}(C_{2}, C_{3}) = 1.0$, $d_{\\mathrm{ATAC}}(C_{2}, C_{4}) = 2.2$, $d_{\\mathrm{ATAC}}(C_{2}, C_{5}) = 2.5$.\n  - $d_{\\mathrm{ATAC}}(C_{3}, C_{4}) = 2.4$, $d_{\\mathrm{ATAC}}(C_{3}, C_{5}) = 2.0$.\n  - $d_{\\mathrm{ATAC}}(C_{4}, C_{5}) = 1.7$.\n- Modality-specific signal-to-noise values for each cell $C_{i}$:\n  - RNA signal strengths: $s_{\\mathrm{RNA}}(C_{1}) = 4$, $s_{\\mathrm{RNA}}(C_{2}) = 6$, $s_{\\mathrm{RNA}}(C_{3}) = 3$, $s_{\\mathrm{RNA}}(C_{4}) = 9$, $s_{\\mathrm{RNA}}(C_{5}) = 2$.\n  - ATAC-seq signal strengths: $s_{\\mathrm{ATAC}}(C_{1}) = 1$, $s_{\\mathrm{ATAC}}(C_{2}) = 7$, $s_{\\mathrm{ATAC}}(C_{3}) = 8$, $s_{\\mathrm{ATAC}}(C_{4}) = 3$, $s_{\\mathrm{ATAC}}(C_{5}) = 3$.\n\nTasks:\n1. Using the Weighted Nearest Neighbor principle described above, derive the per-cell modality weights and compute, for each query cell $C_{i}$, the integrated directed dissimilarity to each other cell $C_{j}$ as a convex combination of $d_{\\mathrm{RNA}}(C_{i}, C_{j})$ and $d_{\\mathrm{ATAC}}(C_{i}, C_{j})$ with the derived weights for $C_{i}$.\n2. For $k=2$, determine the fused directed $k$-Nearest Neighbors graph by selecting, for each $C_{i}$, the two cells $C_{j}$ with the smallest integrated directed dissimilarities. List each cell’s integrated neighbor set.\n3. Finally, compute the total number of mutual nearest neighbor pairs in the fused graph, where an unordered pair $\\{C_{i}, C_{j}\\}$ counts if $C_{j}$ is in $C_{i}$’s two-neighbor set and $C_{i}$ is in $C_{j}$’s two-neighbor set. Express the final answer as a single integer. No rounding is required.", "solution": "The problem statement is parsed and validated.\n\n### Step 1: Extract Givens\n- **Cells**: Five single cells, labeled $C_{1}, C_{2}, C_{3}, C_{4}, C_{5}$.\n- **Data Modalities**: Ribonucleic Acid (RNA) and Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq).\n- **Pairwise RNA distances $d_{\\mathrm{RNA}}(C_{i}, C_{j})$**:\n  - $d_{\\mathrm{RNA}}(C_{1}, C_{2}) = 1.2$, $d_{\\mathrm{RNA}}(C_{1}, C_{3}) = 3.5$, $d_{\\mathrm{RNA}}(C_{1}, C_{4}) = 2.0$, $d_{\\mathrm{RNA}}(C_{1}, C_{5}) = 3.0$.\n  - $d_{\\mathrm{RNA}}(C_{2}, C_{3}) = 2.8$, $d_{\\mathrm{RNA}}(C_{2}, C_{4}) = 1.5$, $d_{\\mathrm{RNA}}(C_{2}, C_{5}) = 2.7$.\n  - $d_{\\mathrm{RNA}}(C_{3}, C_{4}) = 3.2$, $d_{\\mathrm{RNA}}(C_{3}, C_{5}) = 1.1$.\n  - $d_{\\mathrm{RNA}}(C_{4}, C_{5}) = 2.9$.\n- **Pairwise ATAC-seq distances $d_{\\mathrm{ATAC}}(C_{i}, C_{j})$**:\n  - $d_{\\mathrm{ATAC}}(C_{1}, C_{2}) = 2.6$, $d_{\\mathrm{ATAC}}(C_{1}, C_{3}) = 2.9$, $d_{\\mathrm{ATAC}}(C_{1}, C_{4}) = 3.4$, $d_{\\mathrm{ATAC}}(C_{1}, C_{5}) = 1.3$.\n  - $d_{\\mathrm{ATAC}}(C_{2}, C_{3}) = 1.0$, $d_{\\mathrm{ATAC}}(C_{2}, C_{4}) = 2.2$, $d_{\\mathrm{ATAC}}(C_{2}, C_{5}) = 2.5$.\n  - $d_{\\mathrm{ATAC}}(C_{3}, C_{4}) = 2.4$, $d_{\\mathrm{ATAC}}(C_{3}, C_{5}) = 2.0$.\n  - $d_{\\mathrm{ATAC}}(C_{4}, C_{5}) = 1.7$.\n- **Modality-specific signal-to-noise values**:\n  - RNA signal strengths: $s_{\\mathrm{RNA}}(C_{1}) = 4$, $s_{\\mathrm{RNA}}(C_{2}) = 6$, $s_{\\mathrm{RNA}}(C_{3}) = 3$, $s_{\\mathrm{RNA}}(C_{4}) = 9$, $s_{\\mathrm{RNA}}(C_{5}) = 2$.\n  - ATAC-seq signal strengths: $s_{\\mathrm{ATAC}}(C_{1}) = 1$, $s_{\\mathrm{ATAC}}(C_{2}) = 7$, $s_{\\mathrm{ATAC}}(C_{3}) = 8$, $s_{\\mathrm{ATAC}}(C_{4}) = 3$, $s_{\\mathrm{ATAC}}(C_{5}) = 3$.\n- **Methodology**: Fused directed $k$-Nearest Neighbors (kNN) graph for $k=2$ using the Weighted Nearest Neighbor (WNN) integration approach. The integrated dissimilarity is a convex combination of modality-specific dissimilarities. Weights for each cell are derived from signal-to-noise values by normalization to sum to $1$.\n- **Tasks**:\n  1. Derive per-cell modality weights and compute integrated directed dissimilarities.\n  2. Determine the fused directed $2$-NN graph.\n  3. Compute the total number of mutual nearest neighbor pairs.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on the Weighted Nearest Neighbor (WNN) algorithm, a well-established and widely used method in the field of bioinformatics for single-cell multi-omics data integration. The concepts of kNN graphs, Euclidean distance, and convex combinations are standard in data science and mathematics. The modalities (RNA, ATAC-seq) are real-world biotechnologies. Thus, the problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary data (pairwise distances for both modalities, signal strengths for each cell, and the value of $k$). The instructions are specific and lead to a single, verifiable answer. The structure is logical and self-contained.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. There are no subjective or value-based statements.\n- **Other Flaws**: The problem does not violate any other validation criteria. It is directly relevant to bioinformatics, complete, realistic for a toy problem, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution\nThe solution proceeds by following the three tasks outlined in the problem statement. The provided modality-specific distances are Euclidean, hence symmetric: $d(C_{i}, C_{j}) = d(C_{j}, C_{i})$.\n\n**Task 1: Derive per-cell modality weights and compute integrated dissimilarities.**\n\nFirst, we calculate the modality weights for each cell $C_{i}$. For a given cell $C_i$, the weights for RNA and ATAC-seq modalities, denoted $w_{\\mathrm{RNA}}(C_{i})$ and $w_{\\mathrm{ATAC}}(C_{i})$, are determined by normalizing the respective signal strengths $s_{\\mathrm{RNA}}(C_{i})$ and $s_{\\mathrm{ATAC}}(C_{i})$ to sum to $1$.\nThe formula for the weights is:\n$$w_{\\mathrm{RNA}}(C_{i}) = \\frac{s_{\\mathrm{RNA}}(C_{i})}{s_{\\mathrm{RNA}}(C_{i}) + s_{\\mathrm{ATAC}}(C_{i})}, \\quad w_{\\mathrm{ATAC}}(C_{i}) = \\frac{s_{\\mathrm{ATAC}}(C_{i})}{s_{\\mathrm{RNA}}(C_{i}) + s_{\\mathrm{ATAC}}(C_{i})}$$\n\n- For $C_{1}$: $s_{\\mathrm{RNA}}(C_{1}) = 4, s_{\\mathrm{ATAC}}(C_{1}) = 1$.\n  $w_{\\mathrm{RNA}}(C_{1}) = \\frac{4}{4+1} = \\frac{4}{5}$, $w_{\\mathrm{ATAC}}(C_{1}) = \\frac{1}{4+1} = \\frac{1}{5}$.\n- For $C_{2}$: $s_{\\mathrm{RNA}}(C_{2}) = 6, s_{\\mathrm{ATAC}}(C_{2}) = 7$.\n  $w_{\\mathrm{RNA}}(C_{2}) = \\frac{6}{6+7} = \\frac{6}{13}$, $w_{\\mathrm{ATAC}}(C_{2}) = \\frac{7}{6+7} = \\frac{7}{13}$.\n- For $C_{3}$: $s_{\\mathrm{RNA}}(C_{3}) = 3, s_{\\mathrm{ATAC}}(C_{3}) = 8$.\n  $w_{\\mathrm{RNA}}(C_{3}) = \\frac{3}{3+8} = \\frac{3}{11}$, $w_{\\mathrm{ATAC}}(C_{3}) = \\frac{8}{3+8} = \\frac{8}{11}$.\n- For $C_{4}$: $s_{\\mathrm{RNA}}(C_{4}) = 9, s_{\\mathrm{ATAC}}(C_{4}) = 3$.\n  $w_{\\mathrm{RNA}}(C_{4}) = \\frac{9}{9+3} = \\frac{9}{12} = \\frac{3}{4}$, $w_{\\mathrm{ATAC}}(C_{4}) = \\frac{3}{9+3} = \\frac{3}{12} = \\frac{1}{4}$.\n- For $C_{5}$: $s_{\\mathrm{RNA}}(C_{5}) = 2, s_{\\mathrm{ATAC}}(C_{5}) = 3$.\n  $w_{\\mathrm{RNA}}(C_{5}) = \\frac{2}{2+3} = \\frac{2}{5}$, $w_{\\mathrm{ATAC}}(C_{5}) = \\frac{3}{2+3} = \\frac{3}{5}$.\n\nNext, we compute the integrated directed dissimilarity $d_{\\mathrm{WNN}}(C_{i}, C_{j})$ from each query cell $C_{i}$ to each candidate cell $C_{j}$ ($i \\neq j$) using the formula:\n$$d_{\\mathrm{WNN}}(C_{i}, C_{j}) = w_{\\mathrm{RNA}}(C_{i}) \\cdot d_{\\mathrm{RNA}}(C_{i}, C_{j}) + w_{\\mathrm{ATAC}}(C_{i}) \\cdot d_{\\mathrm{ATAC}}(C_{i}, C_{j})$$\nSince distances are symmetric, $d_{\\mathrm{RNA}}(C_{i}, C_{j}) = d_{\\mathrm{RNA}}(C_{j}, C_{i})$ and $d_{\\mathrm{ATAC}}(C_{i}, C_{j}) = d_{\\mathrm{ATAC}}(C_{j}, C_{i})$.\n\nCalculations for each query cell $C_{i}$:\n\n- **Query $C_{1}$** ($w_{\\mathrm{RNA}}=\\frac{4}{5}, w_{\\mathrm{ATAC}}=\\frac{1}{5}$):\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{2}) = \\frac{4}{5}(1.2) + \\frac{1}{5}(2.6) = \\frac{4.8 + 2.6}{5} = \\frac{7.4}{5} = 1.48$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{3}) = \\frac{4}{5}(3.5) + \\frac{1}{5}(2.9) = \\frac{14.0 + 2.9}{5} = \\frac{16.9}{5} = 3.38$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{4}) = \\frac{4}{5}(2.0) + \\frac{1}{5}(3.4) = \\frac{8.0 + 3.4}{5} = \\frac{11.4}{5} = 2.28$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{5}) = \\frac{4}{5}(3.0) + \\frac{1}{5}(1.3) = \\frac{12.0 + 1.3}{5} = \\frac{13.3}{5} = 2.66$\n\n- **Query $C_{2}$** ($w_{\\mathrm{RNA}}=\\frac{6}{13}, w_{\\mathrm{ATAC}}=\\frac{7}{13}$):\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{1}) = \\frac{6}{13}(1.2) + \\frac{7}{13}(2.6) = \\frac{7.2 + 18.2}{13} = \\frac{25.4}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{3}) = \\frac{6}{13}(2.8) + \\frac{7}{13}(1.0) = \\frac{16.8 + 7.0}{13} = \\frac{23.8}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{4}) = \\frac{6}{13}(1.5) + \\frac{7}{13}(2.2) = \\frac{9.0 + 15.4}{13} = \\frac{24.4}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{5}) = \\frac{6}{13}(2.7) + \\frac{7}{13}(2.5) = \\frac{16.2 + 17.5}{13} = \\frac{33.7}{13}$\n\n- **Query $C_{3}$** ($w_{\\mathrm{RNA}}=\\frac{3}{11}, w_{\\mathrm{ATAC}}=\\frac{8}{11}$):\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{1}) = \\frac{3}{11}(3.5) + \\frac{8}{11}(2.9) = \\frac{10.5 + 23.2}{11} = \\frac{33.7}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{2}) = \\frac{3}{11}(2.8) + \\frac{8}{11}(1.0) = \\frac{8.4 + 8.0}{11} = \\frac{16.4}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{4}) = \\frac{3}{11}(3.2) + \\frac{8}{11}(2.4) = \\frac{9.6 + 19.2}{11} = \\frac{28.8}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{5}) = \\frac{3}{11}(1.1) + \\frac{8}{11}(2.0) = \\frac{3.3 + 16.0}{11} = \\frac{19.3}{11}$\n\n- **Query $C_{4}$** ($w_{\\mathrm{RNA}}=\\frac{3}{4}, w_{\\mathrm{ATAC}}=\\frac{1}{4}$):\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{1}) = \\frac{3}{4}(2.0) + \\frac{1}{4}(3.4) = \\frac{6.0 + 3.4}{4} = \\frac{9.4}{4} = 2.35$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{2}) = \\frac{3}{4}(1.5) + \\frac{1}{4}(2.2) = \\frac{4.5 + 2.2}{4} = \\frac{6.7}{4} = 1.675$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{3}) = \\frac{3}{4}(3.2) + \\frac{1}{4}(2.4) = \\frac{9.6 + 2.4}{4} = \\frac{12.0}{4} = 3.0$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{5}) = \\frac{3}{4}(2.9) + \\frac{1}{4}(1.7) = \\frac{8.7 + 1.7}{4} = \\frac{10.4}{4} = 2.6$\n\n- **Query $C_{5}$** ($w_{\\mathrm{RNA}}=\\frac{2}{5}, w_{\\mathrm{ATAC}}=\\frac{3}{5}$):\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{1}) = \\frac{2}{5}(3.0) + \\frac{3}{5}(1.3) = \\frac{6.0 + 3.9}{5} = \\frac{9.9}{5} = 1.98$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{2}) = \\frac{2}{5}(2.7) + \\frac{3}{5}(2.5) = \\frac{5.4 + 7.5}{5} = \\frac{12.9}{5} = 2.58$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{3}) = \\frac{2}{5}(1.1) + \\frac{3}{5}(2.0) = \\frac{2.2 + 6.0}{5} = \\frac{8.2}{5} = 1.64$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{4}) = \\frac{2}{5}(2.9) + \\frac{3}{5}(1.7) = \\frac{5.8 + 5.1}{5} = \\frac{10.9}{5} = 2.18$\n\n**Task 2: Determine the fused directed $k$-Nearest Neighbors graph for $k=2$.**\n\nFor each cell $C_{i}$, we identify the two cells $C_{j}$ with the smallest values of $d_{\\mathrm{WNN}}(C_{i}, C_{j})$.\n\n- **Neighbors of $C_{1}$**:\n  - Distances: $d(C_{1}, C_{2})=1.48$, $d(C_{1}, C_{4})=2.28$, $d(C_{1}, C_{5})=2.66$, $d(C_{1}, C_{3})=3.38$.\n  - The two nearest neighbors are $C_{2}$ and $C_{4}$. Neighbor set $N(C_{1}) = \\{C_{2}, C_{4}\\}$.\n\n- **Neighbors of $C_{2}$**:\n  - Distances: $d(C_{2}, C_{3})=\\frac{23.8}{13} \\approx 1.831$, $d(C_{2}, C_{4})=\\frac{24.4}{13} \\approx 1.877$, $d(C_{2}, C_{1})=\\frac{25.4}{13} \\approx 1.954$, $d(C_{2}, C_{5})=\\frac{33.7}{13} \\approx 2.592$.\n  - The two nearest neighbors are $C_{3}$ and $C_{4}$. Neighbor set $N(C_{2}) = \\{C_{3}, C_{4}\\}$.\n\n- **Neighbors of $C_{3}$**:\n  - Distances: $d(C_{3}, C_{2})=\\frac{16.4}{11} \\approx 1.491$, $d(C_{3}, C_{5})=\\frac{19.3}{11} \\approx 1.755$, $d(C_{3}, C_{4})=\\frac{28.8}{11} \\approx 2.618$, $d(C_{3}, C_{1})=\\frac{33.7}{11} \\approx 3.064$.\n  - The two nearest neighbors are $C_{2}$ and $C_{5}$. Neighbor set $N(C_{3}) = \\{C_{2}, C_{5}\\}$.\n\n- **Neighbors of $C_{4}$**:\n  - Distances: $d(C_{4}, C_{2})=1.675$, $d(C_{4}, C_{1})=2.35$, $d(C_{4}, C_{5})=2.6$, $d(C_{4}, C_{3})=3.0$.\n  - The two nearest neighbors are $C_{2}$ and $C_{1}$. Neighbor set $N(C_{4}) = \\{C_{1}, C_{2}\\}$.\n\n- **Neighbors of $C_{5}$**:\n  - Distances: $d(C_{5}, C_{3})=1.64$, $d(C_{5}, C_{1})=1.98$, $d(C_{5}, C_{4})=2.18$, $d(C_{5}, C_{2})=2.58$.\n  - The two nearest neighbors are $C_{3}$ and $C_{1}$. Neighbor set $N(C_{5}) = \\{C_{1}, C_{3}\\}$.\n\nSummary of the $2$-NN sets:\n- $N(C_{1}) = \\{C_{2}, C_{4}\\}$\n- $N(C_{2}) = \\{C_{3}, C_{4}\\}$\n- $N(C_{3}) = \\{C_{2}, C_{5}\\}$\n- $N(C_{4}) = \\{C_{1}, C_{2}\\}$\n- $N(C_{5}) = \\{C_{1}, C_{3}\\}$\n\n**Task 3: Compute the total number of mutual nearest neighbor pairs.**\n\nAn unordered pair $\\{C_{i}, C_{j}\\}$ is a mutual nearest neighbor pair if $C_{j}$ is in the $2$-NN set of $C_{i}$ (i.e., $C_{j} \\in N(C_i)$) and $C_{i}$ is in the $2$-NN set of $C_{j}$ (i.e., $C_{i} \\in N(C_j)$). We check all $\\binom{5}{2}=10$ unordered pairs.\n\n- $\\{C_{1}, C_{2}\\}$: $C_{2} \\in N(C_{1})$? Yes. $C_{1} \\in N(C_{2})$? No. Not mutual.\n- $\\{C_{1}, C_{3}\\}$: $C_{3} \\in N(C_{1})$? No. Not mutual.\n- $\\{C_{1}, C_{4}\\}$: $C_{4} \\in N(C_{1})$? Yes. $C_{1} \\in N(C_{4})$? Yes. **This is a mutual pair.**\n- $\\{C_{1}, C_{5}\\}$: $C_{5} \\in N(C_{1})$? No. (Even though $C_{1} \\in N(C_{5})$, it's not mutual).\n- $\\{C_{2}, C_{3}\\}$: $C_{3} \\in N(C_{2})$? Yes. $C_{2} \\in N(C_{3})$? Yes. **This is a mutual pair.**\n- $\\{C_{2}, C_{4}\\}$: $C_{4} \\in N(C_{2})$? Yes. $C_{2} \\in N(C_{4})$? Yes. **This is a mutual pair.**\n- $\\{C_{2}, C_{5}\\}$: $C_{5} \\in N(C_{2})$? No. Not mutual.\n- $\\{C_{3}, C_{4}\\}$: $C_{4} \\in N(C_{3})$? No. Not mutual.\n- $\\{C_{3}, C_{5}\\}$: $C_{5} \\in N(C_{3})$? Yes. $C_{3} \\in N(C_{5})$? Yes. **This is a mutual pair.**\n- $\\{C_{4}, C_{5}\\}$: $C_{5} \\in N(C_{4})$? No. Not mutual.\n\nThe mutual nearest neighbor pairs are $\\{C_{1}, C_{4}\\}$, $\\{C_{2}, C_{3}\\}$, $\\{C_{2}, C_{4}\\}$, and $\\{C_{3}, C_{5}\\}$.\nThe total number of mutual nearest neighbor pairs is $4$.", "answer": "$$\\boxed{4}$$", "id": "4607733"}]}