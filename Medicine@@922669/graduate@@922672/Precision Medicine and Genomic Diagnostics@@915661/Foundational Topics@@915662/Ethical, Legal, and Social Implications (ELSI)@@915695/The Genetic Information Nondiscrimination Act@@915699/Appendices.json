{"hands_on_practices": [{"introduction": "Before analyzing the impacts of the Genetic Information Nondiscrimination Act (GINA), we must first master its foundational concepts. This exercise challenges you to apply the statutory definitions to a realistic dataset containing mixed health and personal information. Correctly distinguishing what legally constitutes \"genetic information\" is the critical first step in developing any GINA compliance strategy. [@problem_id:4486137]", "problem": "An employer’s wellness program vendor has provided a mixed dataset about individual employees that includes: (i) direct-to-consumer ancestry percentage results derived from analysis of saliva-based deoxyribonucleic acid (DNA), (ii) a self-reported family history of breast cancer in first-degree relatives, and (iii) hemoglobin A$_{1c}$ (HbA$_{1c}$) values used for diabetes screening and monitoring. The employer’s compliance team must determine which elements constitute “genetic information” under the Genetic Information Nondiscrimination Act (GINA), justify that determination from first principles, and set out redaction steps to avoid non-permissible employer acquisition of genetic information. \n\nStarting from the statutory core definitions that govern the analysis in this context (the definition of “genetic information” and “genetic test” under GINA), select the option that most accurately identifies which elements are “genetic information,” explains why under those definitions, and proposes legally sound redaction steps tailored to the employment context.\n\nA. Both the ancestry percentage results and the family history of breast cancer are “genetic information,” while HbA$_{1c}$ values are not; ancestry results are the output of an individual’s genetic test, and family history is the “manifestation of a disease or disorder in family members.” HbA$_{1c}$, although a protein-related laboratory value, does not detect genotypes, mutations, or chromosomal changes, so it is not a “genetic test” under GINA. Redaction steps: instruct the vendor and any health plan partners not to transmit ancestry percentage outputs or family medical history to the employer; include GINA “safe harbor” language in all requests; require only aggregated, de-identified non-genetic wellness metrics if needed; segregate and purge any inadvertently received genetic information; train staff and configure systems to block intake of genetic information.\n\nB. All three items are “genetic information” because GINA includes analysis of proteins or metabolites, so HbA$_{1c}$ counts alongside ancestry and family history; therefore, the employer must redact ancestry percentages, family history, and HbA$_{1c}$ from any dataset transmitted to the employer, and may only receive fully de-identified population summaries with no individual-level values.\n\nC. None of the items are “genetic information” because ancestry percentages reflect ethnicity rather than disease risk, family history is biographical, and HbA$_{1c}$ is a routine medical value; therefore, no redactions are necessary, and the employer may request, require, or purchase all three categories for wellness compliance.\n\nD. Only family history of breast cancer is “genetic information”; ancestry percentages are not covered because they do not report mutations or disease, and HbA$_{1c}$ is a routine clinical test. Redaction steps: block only family medical history, allow ancestry percent outputs and HbA$_{1c}$ to be received and used by the employer.\n\nE. Ancestry percentages and HbA$_{1c}$ are “genetic information,” while family history is governed solely by health privacy rules; redaction steps: remove ancestry and HbA$_{1c}$, retain family history for leave administration and wellness eligibility determinations, and notify employees that family history may be used in employment decisions.", "solution": "The problem asks for an analysis of three types of employee data—(i) direct-to-consumer ancestry percentages, (ii) self-reported family history of breast cancer, and (iii) Hemoglobin A$_{1c}$ (HbA$_{1c}$) values—to determine which constitute \"genetic information\" under the U.S. Genetic Information Nondiscrimination Act (GINA), and to propose appropriate redaction steps for an employer. The analysis must be based on the statutory definitions of \"genetic information\" and \"genetic test\".\n\n### Step 1: Validation of the Problem Statement\n\n**Givens:**\n1.  **Data Items:** A mixed dataset containing:\n    *   (i) Direct-to-consumer ancestry percentage results derived from analysis of saliva-based deoxyribonucleic acid (DNA).\n    *   (ii) A self-reported family history of breast cancer in first-degree relatives.\n    *   (iii) Hemoglobin A$_{1c}$ (HbA$_{1c}$) values used for diabetes screening and monitoring.\n2.  **Context:** The data is held by an employer’s wellness program vendor. The employer's compliance team needs to manage this data.\n3.  **Task:**\n    *   Identify which data items are \"genetic information\" under GINA.\n    *   Justify the determination using GINA's core definitions (\"genetic information\" and \"genetic test\").\n    *   Propose redaction steps to ensure employer compliance.\n\n**Validation:**\n1.  **Scientifically and Legally Grounded:** The problem is grounded in a specific, real-world U.S. federal statute, the Genetic Information Nondiscrimination Act of 2008. The data types described (DNA-based ancestry, family medical history, and HbA$_{1c}$) are common forms of health and personal data. The scenario presents a realistic compliance challenge for employers. The legal and scientific premises are sound.\n2.  **Well-Posed:** The question is well-posed. It requires the application of specific legal definitions to a set of facts to arrive at a conclusion about legal status and required actions. This structure allows for a unique, correct, and meaningful solution based on established legal principles.\n3.  **Objective:** The problem is stated in precise, objective, and unbiased language. It describes a factual scenario and requests a-principle-based legal analysis.\n\n**Verdict:** The problem statement is valid. It is scientifically and legally sound, well-posed, and objective. I will proceed to the solution.\n\n### Step 2: Derivation from First Principles\n\nTo solve the problem, we must apply the core definitions from GINA and its implementing regulations (e.g., 29 C.F.R. Part 1635) to each of the three data elements.\n\n**First Principles: GINA Definitions**\n\n1.  **Genetic Information (29 C.F.R. § 1635.3(c))**: The term \"genetic information\" means information about:\n    *   An individual’s genetic tests.\n    *   The genetic tests of family members of such individual.\n    *   The manifestation of a disease or disorder in family members of such individual (i.e., family medical history).\n\n2.  **Genetic Test (29 C.F.R. § 1635.3(f))**: The term \"genetic test\" means an analysis of human DNA, RNA, chromosomes, proteins, or metabolites that detects genotypes, genetic variations, or chromosomal changes.\n    *   **Regulatory Exclusion**: The regulations explicitly state that a \"genetic test\" does **not** include \"an analysis of proteins or metabolites that is directly related to a manifested disease, disorder,or pathological condition that could reasonably be detected by a health care professional\".\n\n**Analysis of Data Elements:**\n\n*   **(i) Direct-to-consumer ancestry percentage results from DNA analysis:**\n    *   These results are the output of an \"analysis of human DNA\". This analysis detects genetic variations (e.g., single-nucleotide polymorphisms, or SNPs) to infer ancestry.\n    *   This squarely fits the definition of a \"genetic test\". The purpose of the test (ancestry vs. health) is irrelevant to the definition.\n    *   Therefore, the ancestry percentage results are the output of an individual's \"genetic test\" and constitute **\"genetic information\"** under GINA.\n\n*   **(ii) Self-reported family history of breast cancer:**\n    *   This is information about the \"manifestation of a disease or disorder [breast cancer] in family members\".\n    *   This squarely fits the third prong of the definition of \"genetic information\".\n    *   Therefore, the family history of breast cancer is **\"genetic information\"** under GINA.\n\n*   **(iii) Hemoglobin A$_{1c}$ (HbA$_{1c}$) values:**\n    *   The HbA$_{1c}$ test measures the amount of glycated hemoglobin, which is a protein. Thus, it is an \"analysis of proteins\".\n    *   However, the test is used for diabetes screening and monitoring. Diabetes is a \"manifested disease, disorder, or pathological condition\". The test result (HbA$_{1c}$ level) is \"directly related\" to this manifested condition.\n    *   Because of this, the HbA$_{1c}$ test falls under the regulatory exclusion. It is **not** considered a \"genetic test\" for the purposes of GINA.\n    *   Therefore, the HbA$_{1c}$ value is **not \"genetic information\"** under GINA. It is, however, protected health information (PHI) under other laws like HIPAA.\n\n**Summary and Required Actions:**\n*   **Genetic Information:** Ancestry results and family history.\n*   **Not Genetic Information:** HbA$_{1c}$ values.\n\nUnder GINA Title II, an employer is prohibited from requesting, requiring, or purchasing genetic information with respect to an employee or family member of the employee. To comply, the employer must ensure it does not acquire the ancestry results or the family history.\n\n**Legally Sound Redaction/Compliance Steps:**\n1.  **Prevention:** The primary strategy is to prevent receipt of the information. This involves contractually and operationally instructing the wellness vendor not to transmit any data identified as \"genetic information\" to the employer.\n2.  **Safe Harbor:** All requests for health information (e.g., from the wellness program) should include GINA \"safe harbor\" language, which explicitly warns the provider not to share genetic information.\n3.  **Data Minimization:** If any individual data is received, it should be strictly limited to non-genetic information (e.g., HbA$_{1c}$ values, if permissible under wellness program rules). Aggregated and de-identified data is a safer alternative.\n4.  **Mitigation:** If genetic information is inadvertently received, it must be segregated, purged if possible, and not used for any employment-related purpose. Staff must be trained to handle such situations and systems configured to prevent intake.\n\n### Step 3: Option-by-Option Analysis\n\n**A. Both the ancestry percentage results and the family history of breast cancer are “genetic information,” while HbA$_{1c}$ values are not; ancestry results are the output of an individual’s genetic test, and family history is the “manifestation of a disease or disorder in family members.” HbA$_{1c}$, although a protein-related laboratory value, does not detect genotypes, mutations, or chromosomal changes, so it is not a “genetic test” under GINA. Redaction steps: instruct the vendor and any health plan partners not to transmit ancestry percentage outputs or family medical history to the employer; include GINA “safe harbor” language in all requests; require only aggregated, de-identified non-genetic wellness metrics if needed; segregate and purge any inadvertently received genetic information; train staff and configure systems to block intake of genetic information.**\n*   **Analysis:** This option correctly identifies that ancestry results and family history are genetic information, while HbA$_{1c}$ is not. The justifications are correct: ancestry results are from a genetic test, and family history is the manifestation of disease in family members. The reasoning for HbA$_{1c}$ is also technically correct, as the test measures a protein concentration related to a metabolic state, not a genotype. The proposed redaction and compliance steps are comprehensive and legally sound, covering prevention, safe harbor, data minimization, and mitigation.\n*   **Verdict:** Correct.\n\n**B. All three items are “genetic information” because GINA includes analysis of proteins or metabolites, so HbA$_{1c}$ counts alongside ancestry and family history; therefore, the employer must redact ancestry percentages, family history, and HbA$_{1c}$ from any dataset transmitted to the employer, and may only receive fully de-identified population summaries with no individual-level values.**\n*   **Analysis:** This option is incorrect because it misclassifies HbA$_{1c}$ as genetic information. It relies on the \"analysis of proteins\" language but fails to apply the critical regulatory exclusion for tests related to a manifested disease.\n*   **Verdict:** Incorrect.\n\n**C. None of the items are “genetic information” because ancestry percentages reflect ethnicity rather than disease risk, family history is biographical, and HbA$_{1c}$ is a routine medical value; therefore, no redactions are necessary, and the employer may request, require, or purchase all three categories for wellness compliance.**\n*   **Analysis:** This option is fundamentally flawed. It misunderstands the scope of GINA. The definition of \"genetic test\" is not limited by purpose (e.g., disease risk). \"Family history\" is explicitly defined as genetic information. Permitting the employer to \"request, require, or purchase\" this information would lead to direct GINA violations.\n*   **Verdict:** Incorrect.\n\n**D. Only family history of breast cancer is “genetic information”; ancestry percentages are not covered because they do not report mutations or disease, and HbA$_{1c}$ is a routine clinical test. Redaction steps: block only family medical history, allow ancestry percent outputs and HbA$_{1c}$ to be received and used by the employer.**\n*   **Analysis:** This option incorrectly excludes ancestry results from the definition of genetic information. An analysis of DNA is a genetic test regardless of its purpose. Allowing the employer to receive ancestry outputs would be a GINA violation.\n*   **Verdict:** Incorrect.\n\n**E. Ancestry percentages and HbA$_{1c}$ are “genetic information,” while family history is governed solely by health privacy rules; redaction steps: remove ancestry and HbA$_{1c}$, retain family history for leave administration and wellness eligibility determinations, and notify employees that family history may be used in employment decisions.**\n*   **Analysis:** This option is incorrect on multiple counts. It wrongly includes HbA$_{1c}$ and wrongly excludes family history from GINA's definition. Family history is a core component of \"genetic information\" under GINA. The proposed action to \"retain family history\" and \"use\" it in employment decisions is a flagrant and severe violation of GINA's non-discrimination provisions.\n*   **Verdict:** Incorrect.", "answer": "$$\\boxed{A}$$", "id": "4486137"}, {"introduction": "GINA's prohibitions on health insurers were not created in a vacuum; they directly address the strong financial incentive to use genetic data for risk-based underwriting. This practice guides you through a simplified actuarial model to quantify the financial advantage a health plan could realize by discriminating based on genotype. By calculating this \"expected loss differential,\" you will gain a concrete, quantitative understanding of the market forces that GINA was designed to regulate. [@problem_id:4390608]", "problem": "A health plan considers a one-year catastrophic clinical event, denoted by the event $E$, that incurs a cost of $C$ dollars if it occurs and $0$ otherwise. The plan contemplates using genotype $G \\in \\{1,0\\}$ to underwrite, where $G=1$ indicates carriage of a genetic variant associated with elevated risk for $E$. Let the following hold in the covered population drawn independently and identically distributed:\n- The prevalence of the risk genotype is $P(G=1)=q$ and $P(G=0)=1-q$.\n- The event risks are $P(E \\mid G=1)=p_{1}$ and $P(E \\mid G=0)=p_{0}$, with $p_{1} > p_{0}$.\n- If $E$ occurs, the cost to the plan is $C$, otherwise it is $0$.\n\nFor concreteness, take $q=0.10$, $p_{1}=0.40$, $p_{0}=0.05$, and $C=100{,}000$.\n\nDefine the plan’s expected loss as the expected claims cost per potential applicant drawn from this population. Under compliance with the Genetic Information Nondiscrimination Act (GINA), the plan may not use genetic information in underwriting and thus enrolls the entire population without conditioning on $G$. In a hypothetical non-compliant scenario where the plan is allowed to underwrite on genetic information using $P(E \\mid G)$, suppose it excludes all applicants with $G=1$ (thereby enrolling only those with $G=0$).\n\nUsing only fundamental probability definitions (e.g., expectation and the law of total probability), derive and compute the expected loss differential per potential applicant, defined as\n$$\\Delta L \\equiv \\text{(expected loss without using genetic information)} - \\text{(expected loss with underwriting on }G\\text{)}.$$\nExpress the final expected loss differential in dollars. Do not round your answer.\n\nThen, using the statutory baseline of the Genetic Information Nondiscrimination Act (GINA), explain succinctly why exploiting any such actuarial differential based on $P(E \\mid G)$ is prohibited in health insurance underwriting, even if it would reduce $\\Delta L$.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard, albeit simplified, model from actuarial science and population genetics. All necessary data and definitions are provided, and there are no internal contradictions. We may therefore proceed with the solution.\n\nLet the random variable $X$ represent the cost incurred by the health plan for a single potential applicant. The problem states that $X = C$ if the catastrophic event $E$ occurs, and $X = 0$ otherwise. The expected loss for the plan, per potential applicant, is the expected value of this cost, $E[X]$. Using the definition of expected value:\n$$E[X] = C \\cdot P(E) + 0 \\cdot P(\\text{not } E) = C \\cdot P(E)$$\nThe core of the problem is to calculate $P(E)$ under two different underwriting scenarios.\n\nWe are given the following values:\n- The cost of the event, $C = \\$100,000$.\n- The prevalence of the risk genotype, $P(G=1) = q = 0.10$.\n- The prevalence of the non-risk genotype, $P(G=0) = 1-q = 0.90$.\n- The conditional probability of the event given the risk genotype, $P(E \\mid G=1) = p_{1} = 0.40$.\n- The conditional probability of the event given the non-risk genotype, $P(E \\mid G=0) = p_{0} = 0.05$.\n\nFirst, we calculate the expected loss without using genetic information, which corresponds to the GINA-compliant scenario. In this case, the plan enrolls the entire population of potential applicants. The overall probability of the event $E$ in the population must be calculated using the law of total probability, conditioning on the genotype $G$:\n$$P(E) = P(E \\mid G=1)P(G=1) + P(E \\mid G=0)P(G=0)$$\nSubstituting the symbolic variables:\n$$P(E) = p_{1}q + p_{0}(1-q)$$\nThe expected loss in this scenario, which we denote $L_{\\text{GINA}}$, is therefore:\n$$L_{\\text{GINA}} = C \\cdot P(E) = C(p_{1}q + p_{0}(1-q))$$\nUsing the provided numerical values:\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.40 \\cdot 0.10 + 0.05 \\cdot (1-0.10))$$\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.04 + 0.05 \\cdot 0.90)$$\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.04 + 0.045)$$\n$$L_{\\text{GINA}} = 100,000 \\cdot 0.085 = 8,500$$\nSo, the expected loss per potential applicant under GINA is $\\$8,500$.\n\nNext, we calculate the expected loss in the hypothetical non-compliant scenario where the plan underwrites on genetic information. The plan excludes all applicants with $G=1$ and enrolls only those with $G=0$. The expected loss is defined \"per potential applicant,\" meaning the total expected cost is averaged over the entire original population, not just the enrolled subgroup.\nIndividuals with genotype $G=1$, who constitute a fraction $q$ of the population, are not enrolled. Thus, their contribution to the plan's cost is $\\$0$.\nIndividuals with genotype $G=0$, who constitute a fraction $1-q$ of the population, are enrolled. For this sub-population, the probability of event $E$ is $p_0$. The expected cost from this group, averaged over the entire population, is $C \\cdot p_{0} \\cdot P(G=0) = C p_{0} (1-q)$.\nThe total expected loss in this underwriting scenario, which we denote $L_{\\text{underwriting}}$, is the sum of the expected costs from the two groups:\n$$L_{\\text{underwriting}} = (\\text{cost from } G=1 \\text{ group}) + (\\text{cost from } G=0 \\text{ group})$$\n$$L_{\\text{underwriting}} = 0 + C \\cdot p_{0}(1-q) = C p_{0}(1-q)$$\nUsing the provided numerical values:\n$$L_{\\text{underwriting}} = 100,000 \\cdot 0.05 \\cdot (1-0.10)$$\n$$L_{\\text{underwriting}} = 100,000 \\cdot 0.05 \\cdot 0.90$$\n$$L_{\\text{underwriting}} = 5,000 \\cdot 0.90 = 4,500$$\nSo, the expected loss per potential applicant with genetic underwriting is $\\$4,500$.\n\nFinally, we compute the expected loss differential, $\\Delta L$:\n$$\\Delta L = L_{\\text{GINA}} - L_{\\text{underwriting}}$$\nSymbolically:\n$$\\Delta L = C(p_{1}q + p_{0}(1-q)) - C p_{0}(1-q)$$\n$$\\Delta L = C p_{1}q$$\nThis result is intuitive: the reduction in expected loss comes precisely from excluding the high-risk group ($G=1$), so the differential is equal to the expected loss contribution from that group ($C \\cdot P(E \\text{ and } G=1) = C \\cdot P(E|G=1)P(G=1) = C p_1 q$).\nUsing the numerical values:\n$$\\Delta L = 8,500 - 4,500 = 4,000$$\nAlternatively, using the symbolic formula:\n$$\\Delta L = 100,000 \\cdot 0.40 \\cdot 0.10 = 100,000 \\cdot 0.04 = 4,000$$\nThe expected loss differential per potential applicant is $\\$4,000$.\n\nThe second part of the query requires an explanation of the statutory prohibition against this practice. The Genetic Information Nondiscrimination Act (GINA) of $2008$ is a United States federal law that establishes a legal baseline to prevent discrimination based on genetic information. Title I of GINA specifically applies to health insurance. It prohibits group health plans and health insurers from using an individual's genetic information (such as the status of genotype $G$ in this problem) for underwriting purposes. This includes decisions regarding eligibility, coverage, and premium or contribution amounts. The hypothetical scenario, where the plan denies enrollment to individuals with $G=1$, is a direct and unambiguous violation of this statutory prohibition. The law was enacted as a matter of public policy to promote access to genetic testing and personalized medicine without fear of reprisal from insurers or employers. It reflects a societal decision that the right to health coverage should not be contingent on one's genetic predispositions, thereby superseding any purely actuarial or financial incentives, such as the $\\Delta L$ calculated here, that a plan might have to discriminate.", "answer": "$$\\boxed{4000}$$", "id": "4390608"}, {"introduction": "As artificial intelligence becomes integral to diagnostics, ensuring GINA compliance requires more than just avoiding the direct use of genetic data. This advanced exercise simulates the challenge of \"proxy discrimination,\" where algorithms might inadvertently learn to use non-genetic features as stand-ins for protected genetic information. You will implement a sophisticated auditing framework using information theory to unmask these hidden dependencies, a crucial skill for building ethical and legally compliant models in precision medicine. [@problem_id:4390560]", "problem": "You are tasked with constructing and implementing a principled auditing framework for a predictive diagnostic model in the domain of precision medicine and genomic diagnostics, grounded in the Genetic Information Nondiscrimination Act (GINA). The audit must quantify whether a model’s input features act as proxies for genetic information, using information-theoretic measures and hypothesis testing from first principles, and then decide compliance based on mathematically defined thresholds.\n\nContextual framing: the Genetic Information Nondiscrimination Act (GINA) prohibits the use of genetic information in certain decision-making contexts. To audit a model’s features for prohibited dependence on genetic information, you will formalize a measure of informativeness and a compliance threshold using core definitions from information theory and classical statistical testing of independence.\n\nFoundational definitions to use:\n- Let the genetic variable be a discrete random variable $G$ taking values in a finite set, and let a feature $F$ be a discrete random variable taking values in a finite set. The audit evaluates each feature $F$ with respect to $G$.\n- The Shannon mutual information (MI) between $F$ and $G$ is defined as\n$$\nI(F;G) \\equiv \\sum_{f} \\sum_{g} p_{F,G}(f,g) \\log\\left(\\frac{p_{F,G}(f,g)}{p_{F}(f)\\,p_{G}(g)}\\right),\n$$\nwhere $p_{F,G}(f,g)$ denotes the joint probability mass function and $p_{F}(f)$, $p_{G}(g)$ denote the marginals. All logarithms are natural, so $I(F;G)$ is measured in nats.\n- Given a dataset of size $n$ with observed pairs $(f_i,g_i)$ for $i=1,\\dots,n$, you will use the empirical distribution obtained from counts to compute the plug-in estimate $\\hat{I}(F;G)$.\n\nCompliance threshold derived from a well-tested statistical fact:\n- For testing independence between two discrete variables, the likelihood ratio statistic is asymptotically distributed as a chi-square random variable. Specifically, under the null hypothesis of independence, the statistic $2n\\,\\hat{I}(F;G)$ converges in distribution to a chi-square with degrees of freedom equal to $(|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$, where $|\\mathcal{F}|$ is the number of distinct categories of $F$ and $|\\mathcal{G}|$ is the number of distinct categories of $G$.\n- Use this asymptotic result to define a compliance threshold at a chosen significance level $0<\\alpha<1$. For degrees of freedom $d \\equiv (|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$, let $q_{1-\\alpha}(d)$ denote the $(1-\\alpha)$ quantile of the chi-square distribution with $d$ degrees of freedom. The audit decides a feature $F$ is compliant if the empirical mutual information satisfies $\\hat{I}(F;G) \\le \\tau_{\\alpha}$ where $\\tau_{\\alpha}$ is the threshold derived from the independence test at level $\\alpha$, and non-compliant otherwise. If $d=0$ (for example, a constant feature), take the feature to be compliant because it cannot carry information about $G$.\n\nAlgorithmic requirements:\n- For each test case, compute $\\hat{I}(F;G)$ for each feature using empirical counts.\n- For each feature, compute the degrees of freedom $d$ and the threshold $\\tau_{\\alpha}$ implied by the chi-square independence test at significance level $\\alpha$.\n- A feature is non-compliant if $\\hat{I}(F;G) > \\tau_{\\alpha}$ with $d>0$, and compliant otherwise.\n- For each test case, output the integer count of non-compliant features across all features in that test case.\n\nData specifications and test suite:\n- All variables are discrete and unitless. No physical units or angle units are involved. No percentages should be output; fractions and probabilities are implicit in the empirical computations.\n\nYou must implement the following four test cases exactly as specified below. In each case, construct the arrays for $G$ and the features so that the indicated joint structures hold. The features in each case are denoted $F^{(1)},F^{(2)},F^{(3)}$, and the audit is performed independently for each $F^{(j)}$ relative to $G$.\n\nTest case $1$ (happy path; exact independence and a constant feature):\n- Sample size $n=120$.\n- Genetic variable $G$ is binary with $60$ instances of $0$ followed by $60$ instances of $1$.\n- Feature $F^{(1)}$ is binary and exactly independent of $G$ with joint counts\n$$\n\\left[\\begin{array}{cc}\n30 & 30\\\\\n30 & 30\n\\end{array}\\right],\n$$\nmeaning $30$ instances of $(F^{(1)}=0,G=0)$, $30$ of $(F^{(1)}=0,G=1)$, $30$ of $(F^{(1)}=1,G=0)$, and $30$ of $(F^{(1)}=1,G=1)$.\n- Feature $F^{(2)}$ is constant with value $0$ for all $120$ samples.\n- Feature $F^{(3)}$ is ternary and exactly independent of $G$ with joint counts\n$$\n\\left[\\begin{array}{cc}\n20 & 20\\\\\n20 & 20\\\\\n20 & 20\n\\end{array}\\right],\n$$\nacross the $3\\times 2$ grid of $(F^{(3)},G)$.\n- Significance level $\\alpha=0.05$.\n\nTest case $2$ (strong proxy use):\n- Sample size $n=100$.\n- Genetic variable $G$ is binary with $50$ instances of $0$ followed by $50$ instances of $1$.\n- Feature $F^{(1)}$ is a perfect proxy: $F^{(1)}=G$ for all $100$ samples.\n- Feature $F^{(2)}$ is a near-perfect proxy: start with $F^{(2)}=G$ for all samples, then flip the first $5$ entries of $F^{(2)}$ (changing $0$ to $1$ and $1$ to $0$).\n- Feature $F^{(3)}$ is binary and exactly independent of $G$ with joint counts\n$$\n\\left[\\begin{array}{cc}\n25 & 25\\\\\n25 & 25\n\\end{array}\\right].\n$$\n- Significance level $\\alpha=0.01$.\n\nTest case $3$ (borderline small dependence; should be compliant):\n- Sample size $n=50$.\n- Genetic variable $G$ is binary with $25$ instances of $0$ followed by $25$ instances of $1$.\n- Feature $F^{(1)}$ is binary with mild dependence on $G$ through joint counts\n$$\n\\left[\\begin{array}{cc}\n15 & 11\\\\\n10 & 14\n\\end{array}\\right],\n$$\nyielding $29$ matches between $F^{(1)}$ and $G$ out of $50$.\n- Feature $F^{(2)}$ is binary and nearly independent of $G$ with joint counts\n$$\n\\left[\\begin{array}{cc}\n13 & 12\\\\\n12 & 13\n\\end{array}\\right].\n$$\n- Feature $F^{(3)}$ is constant with value $0$ for all $50$ samples.\n- Significance level $\\alpha=0.05$.\n\nTest case $4$ (multiclass genetics; a derived binary indicator proxy):\n- Sample size $n=90$.\n- Genetic variable $G$ is ternary with $30$ instances each of $0$, $1$, and $2$.\n- Feature $F^{(1)}$ is a binary indicator proxy defined deterministically by $F^{(1)}=\\mathbb{1}\\{G=2\\}$, so $F^{(1)}=1$ exactly when $G=2$ and $F^{(1)}=0$ otherwise.\n- Feature $F^{(2)}$ is ternary and exactly independent of $G$ with joint counts\n$$\n\\left[\\begin{array}{ccc}\n10 & 10 & 10\\\\\n10 & 10 & 10\\\\\n10 & 10 & 10\n\\end{array}\\right],\n$$\nacross the $3\\times 3$ grid of $(F^{(2)},G)$.\n- Feature $F^{(3)}$ is constant with value $0$ for all $90$ samples.\n- Significance level $\\alpha=0.05$.\n\nProgram output specification:\n- Implement the audit and apply it to the four test cases in the order listed.\n- For each test case, produce a single integer equal to the count of features that are non-compliant under the thresholding rule.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where $r_i$ is the integer count for test case $i$.\n\nThe program must be complete, self-contained, and must not require any user input, external files, or network access. It must conform exactly to the execution environment and library constraints specified separately.", "solution": "The problem of auditing a predictive model for compliance with the Genetic Information Nondiscrimination Act (GINA) is a well-posed and scientifically grounded task. It requires the application of established principles from information theory and statistical hypothesis testing to a clearly defined set of data. The problem provides all necessary definitions, constants, and data structures to derive a unique, verifiable solution. The premises are factually sound, the terminology is precise, and the objective is unambiguous. Therefore, the problem is valid.\n\nThe solution proceeds by first establishing the theoretical framework and then applying it to the specified test cases.\n\n**1. Theoretical Framework**\n\nThe core of the audit is to quantify the statistical dependence between a model feature, represented by a discrete random variable $F$, and genetic information, represented by a discrete random variable $G$. The chosen measure for this dependence is the Shannon Mutual Information (MI), defined as:\n\n$$I(F;G) \\equiv \\sum_{f \\in \\mathcal{F}} \\sum_{g \\in \\mathcal{G}} p_{F,G}(f,g) \\log\\left(\\frac{p_{F,G}(f,g)}{p_{F}(f)\\,p_{G}(g)}\\right)$$\n\nHere, $p_{F,G}(f,g)$ is the joint probability mass function (PMF) of $(F,G)$, and $p_F(f)$ and $p_G(g)$ are the respective marginal PMFs. All logarithms are natural, so MI is measured in nats. Mutual information is non-negative, $I(F;G) \\ge 0$, and equals zero if and only if $F$ and $G$ are statistically independent.\n\nGiven a dataset of $n$ observations, we do not know the true PMFs. Instead, we use the empirical distributions derived from observed frequencies. Let $N(f,g)$ be the count of observations where the feature has value $f$ and the genetic variable has value $g$. These counts form a contingency table. The empirical joint PMF is $\\hat{p}_{F,G}(f,g) = N(f,g)/n$. The empirical marginals are $\\hat{p}_F(f) = \\sum_g \\hat{p}_{F,G}(f,g)$ and $\\hat{p}_G(g) = \\sum_f \\hat{p}_{F,G}(f,g)$. Substituting these into the MI formula gives the plug-in estimate, $\\hat{I}(F;G)$.\n\nObserving a non-zero empirical MI, $\\hat{I}(F;G) > 0$, is not sufficient to conclude dependence, as this could arise from random sampling fluctuations even if the variables are truly independent. A statistical test is required to assess the significance of the observed dependence. The problem specifies using the likelihood-ratio test (G-test) for independence in contingency tables. A key result in statistics states that, under the null hypothesis ($H_0$) of independence, the test statistic $2n\\,\\hat{I}(F;G)$ is asymptotically distributed as a chi-square ($\\chi^2$) random variable.\n\nThe degrees of freedom, $d$, for this $\\chi^2$ distribution are determined by the size of the contingency table:\n\n$$d = (|\\mathcal{F}| - 1)(|\\mathcal{G}| - 1)$$\n\nwhere $|\\mathcal{F}|$ and $|\\mathcal{G}|$ are the number of distinct categories for the feature $F$ and the genetic variable $G$, respectively.\n\nFor a chosen significance level $\\alpha$, we can find a critical value $q_{1-\\alpha}(d)$ from the $\\chi^2$ distribution with $d$ degrees of freedom, such that $P(\\chi^2(d) > q_{1-\\alpha}(d)) = \\alpha$. We would reject the null hypothesis of independence if the observed test statistic is greater than this critical value:\n\n$$2n\\,\\hat{I}(F;G) > q_{1-\\alpha}(d)$$\n\nThis framework is used to define a compliance rule. A feature is deemed non-compliant if the evidence for its dependence on $G$ is statistically significant at level $\\alpha$. Rearranging the inequality above, a feature $F$ is non-compliant if its empirical mutual information exceeds a derived threshold $\\tau_{\\alpha}$:\n\n$$\\hat{I}(F;G) > \\tau_{\\alpha} \\quad \\text{where} \\quad \\tau_{\\alpha} = \\frac{q_{1-\\alpha}(d)}{2n}$$\n\nA special case arises when $d=0$. This occurs if either $|\\mathcal{F}|=1$ or $|\\mathcal{G}|=1$, meaning one of the variables is constant. A constant feature cannot carry any information about another variable, so $\\hat{I}(F;G)$ is necessarily $0$. In this case, the feature is automatically considered compliant.\n\n**2. Algorithmic Procedure**\n\nFor each feature in each test case, the following algorithm is executed:\n\n1.  Construct the contingency table of observed joint counts for the feature $F^{(j)}$ and the genetic variable $G$.\n2.  From the table, determine the number of categories $|\\mathcal{F}|$ and $|\\mathcal{G}|$ from its dimensions.\n3.  Calculate the degrees of freedom $d = (|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$.\n4.  If $d=0$, the feature is compliant. The audit for this feature concludes.\n5.  If $d>0$, proceed. Calculate the total sample size $n$ by summing all counts in the table.\n6.  Compute the empirical mutual information $\\hat{I}(F;G)$ from the contingency table. The calculation must handle cases where counts are $0$, as the corresponding term $p\\log(p/p_1p_2)$ is $0$.\n7.  Using the given significance level $\\alpha$, find the critical value $q_{1-\\alpha}(d)$ from the $\\chi^2$ distribution with $d$ degrees of freedom.\n8.  Calculate the compliance threshold $\\tau_{\\alpha} = q_{1-\\alpha}(d) / (2n)$.\n9.  Compare the empirical MI with the threshold. If $\\hat{I}(F;G) > \\tau_{\\alpha}$, the feature is classified as non-compliant. Otherwise, it is compliant.\n10. The final result for each test case is the total count of its non-compliant features.\n\nThis procedure rigorously implements the GINA compliance audit as specified, translating the principles of information theory and hypothesis testing into a concrete decision-making algorithm.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Constructs and implements a principled auditing framework for a predictive \n    diagnostic model based on the Genetic Information Nondiscrimination Act (GINA).\n    \"\"\"\n\n    def calculate_mi(contingency_table: np.ndarray) -> float:\n        \"\"\"\n        Calculates the empirical mutual information from a contingency table of counts.\n\n        Args:\n            contingency_table: A 2D numpy array of joint counts.\n\n        Returns:\n            The mutual information in nats.\n        \"\"\"\n        total_n = np.sum(contingency_table)\n        if total_n == 0:\n            return 0.0\n\n        joint_pmf = contingency_table / total_n\n        \n        # Calculate marginal probabilities\n        p_F = np.sum(joint_pmf, axis=1, keepdims=True)\n        p_G = np.sum(joint_pmf, axis=0, keepdims=True)\n\n        # To avoid division by zero or log(0), we only compute over non-zero joint probabilities.\n        # Where joint_pmf is 0, the term in the sum is 0, so we can ignore it.\n        non_zero_indices = joint_pmf > 0\n        \n        p = joint_pmf[non_zero_indices]\n        p_outer_product = (p_F @ p_G)[non_zero_indices]\n\n        # Mutual information I(F;G) = D_KL(P(F,G) || P(F)P(G))\n        mi = np.sum(p * np.log(p / p_outer_product))\n        \n        return mi\n\n    def audit_feature(feature_data, alpha: float) -> bool:\n        \"\"\"\n        Audits a single feature for compliance.\n\n        Args:\n            feature_data: A 2D list/numpy array representing the contingency table, \n                          or the string 'constant'.\n            alpha: The significance level for the test.\n\n        Returns:\n            True if the feature is non-compliant, False otherwise.\n        \"\"\"\n        # A constant feature is always compliant.\n        if isinstance(feature_data, str) and feature_data == 'constant':\n            return False\n\n        contingency_table = np.array(feature_data, dtype=float)\n        \n        num_f, num_g = contingency_table.shape\n        d = (num_f - 1) * (num_g - 1)\n\n        # If degrees of freedom is 0, the feature is compliant.\n        if d == 0:\n            return False\n            \n        n = np.sum(contingency_table)\n\n        # Compute empirical mutual information\n        mi_hat = calculate_mi(contingency_table)\n\n        # Compute the threshold tau_alpha\n        chi2_critical_value = chi2.ppf(1 - alpha, d)\n        tau_alpha = chi2_critical_value / (2 * n)\n        \n        # A feature is non-compliant if its empirical MI exceeds the threshold.\n        is_non_compliant = mi_hat > tau_alpha\n        \n        return is_non_compliant\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[30, 30], [30, 30]],\n                'constant',\n                [[20, 20], [20, 20], [20, 20]],\n            ]\n        },\n        {\n            \"alpha\": 0.01,\n            \"features\": [\n                [[50, 0], [0, 50]],\n                [[45, 5], [5, 45]],\n                [[25, 25], [25, 25]],\n            ]\n        },\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[15, 11], [10, 14]],\n                [[13, 12], [12, 13]],\n                'constant',\n            ]\n        },\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[30, 30, 0], [0, 0, 30]],\n                [[10, 10, 10], [10, 10, 10], [10, 10, 10]],\n                'constant',\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        features = case[\"features\"]\n        non_compliant_count = 0\n        for feature_data in features:\n            if audit_feature(feature_data, alpha):\n                non_compliant_count += 1\n        results.append(non_compliant_count)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4390560"}]}