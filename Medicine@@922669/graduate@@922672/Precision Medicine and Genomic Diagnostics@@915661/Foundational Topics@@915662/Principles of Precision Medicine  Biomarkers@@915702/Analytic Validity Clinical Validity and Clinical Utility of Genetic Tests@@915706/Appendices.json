{"hands_on_practices": [{"introduction": "Before a genetic test can inform clinical decisions, we must first establish its analytic validity—its ability to measure the intended analyte accurately and reliably. This first exercise delves into precision, a cornerstone of analytic validity, by dissecting the sources of variability in a quantitative assay. You will use a nested random-effects model to distinguish between repeatability (consistency under the same conditions) and reproducibility (consistency across different operators and instruments), and quantify these using the coefficient of variation [@problem_id:4316319].", "problem": "You are asked to formalize analytic precision for a quantitative genetic test (e.g., Next-Generation Sequencing (NGS) variant allele fraction), and compute summary precision metrics under a nested measurement system. The objective is to define and quantify repeatability and reproducibility using nested variance components across instruments and operators.\n\nStarting point and core definitions:\n- Analytic validity is the ability of a test to measure what it purports to measure. For a continuous assay output modeled as a random variable $Y$, precision is characterized by variability of $Y$ under controlled conditions.\n- Repeatability is the variability observed when the test is repeated under the same conditions (same instrument, same operator, same reagents, same environment) and is quantified by the within-condition error variance.\n- Reproducibility is the variability observed when the test is performed under changed conditions that are expected in routine use (e.g., different instruments, different operators), and is quantified by the aggregate variability across those sources.\n- Coefficient of Variation (CV) is a scale-free precision metric defined as $CV = \\sqrt{\\mathrm{Var}(Y)} \\,/\\, \\mu$, where $\\mu$ is the mean level of $Y$. It is expressed here as a decimal, not with a percentage sign.\n\nHierarchical measurement system model:\n- Consider the additive random-effects model $Y_{ijk} = \\mu + I_i + O_{j(i)} + \\epsilon_{ijk}$, where $I_i$ is the random effect of instrument $i$, $O_{j(i)}$ is the random effect of operator $j$ nested within instrument $i$, and $\\epsilon_{ijk}$ is the residual repeatability error for replicate $k$. Assume $I_i$, $O_{j(i)}$, and $\\epsilon_{ijk}$ are mutually independent, mean-zero random variables with variances $\\sigma_I^2$, $\\sigma_{O(I)}^2$, and $\\sigma_e^2$, respectively. Under independence and additivity, the variance attributable to each condition set arises from summing the relevant variance components.\n\nTask:\n- Write a program that, for each test case, computes three quantities:\n  1. Repeatability $CV$ using only the residual component $\\,\\sigma_e^2\\,$.\n  2. Operator-within-instrument $CV$ using $\\,\\sigma_{O(I)}^2 + \\sigma_e^2\\,$.\n  3. Reproducibility $CV$ across instruments and operators using $\\,\\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2\\,$.\n- Use the definition $CV = \\sqrt{\\mathrm{Var}} \\,/\\, \\mu$ for each of the above and treat $\\,\\mu\\,$ as the grand mean level. If $\\,|\\mu| < \\varepsilon\\,$ for some small threshold $\\,\\varepsilon = 10^{-12}\\,$, return a not-a-number indicator for the corresponding $CV$ to avoid division instability.\n- All $CV$ values must be expressed as decimals (unitless) and rounded to six decimal places.\n\nInput specification for each test case:\n- The program must use the following test suite parameter sets, each specified as $(\\mu, \\sigma_I^2, \\sigma_{O(I)}^2, \\sigma_e^2)$:\n  - Case A (general scenario): $(\\mu = 0.25, \\sigma_I^2 = 0.0004, \\sigma_{O(I)}^2 = 0.0001, \\sigma_e^2 = 0.00005)$.\n  - Case B (no instrument variability): $(\\mu = 0.50, \\sigma_I^2 = 0, \\sigma_{O(I)}^2 = 0.0002, \\sigma_e^2 = 0.0001)$.\n  - Case C (near-zero mean edge case): $(\\mu = 0.01, \\sigma_I^2 = 0.000001, \\sigma_{O(I)}^2 = 0.000002, \\sigma_e^2 = 0.000001)$.\n  - Case D (boundary with zero residual and operator variance): $(\\mu = 0.30, \\sigma_I^2 = 0.0009, \\sigma_{O(I)}^2 = 0, \\sigma_e^2 = 0)$.\n  - Case E (high mean, small variances): $(\\mu = 0.90, \\sigma_I^2 = 0.00005, \\sigma_{O(I)}^2 = 0.00005, \\sigma_e^2 = 0.00002)$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case in order (A through E), and is itself a list of three decimals rounded to six places: $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots,[a_5,b_5,c_5]]$ where each $a_i$, $b_i$, $c_i$ is a float.\n\nNo physical units apply because coefficients of variation are dimensionless. Angles are not used. All decimals must be presented as unitless fractions (no percentage sign).", "solution": "We begin from the perspective of analytic validity in precision medicine and genomic diagnostics. A quantitative assay output, such as variant allele fraction from Next-Generation Sequencing (NGS), is modeled as a random variable $Y$ with mean level $\\mu$ and variability driven by multiple sources. Repeatability and reproducibility are distinct aspects of analytic precision. Repeatability is the variability when all controllable conditions are held constant, whereas reproducibility aggregates variability when conditions vary across instruments and operators, representing realistic inter-condition variability.\n\nTo compute coefficients of variation (CVs), we employ the scale-free precision metric defined as $CV = \\sqrt{\\mathrm{Var}(Y)} \\,/\\, \\mu$. This metric is appropriate because it normalizes the dispersion to the mean level, making comparisons more meaningful across different magnitudes of $\\mu$. We express CVs as decimals (not percentages) to avoid ambiguity.\n\nModel formulation and fundamental base:\n- We posit a hierarchical additive random-effects model for a measurement $Y_{ijk}$:\n  $$Y_{ijk} = \\mu + I_i + O_{j(i)} + \\epsilon_{ijk},$$\n  where $I_i$ is the instrument effect for instrument $i$, $O_{j(i)}$ is the operator effect for operator $j$ nested within instrument $i$, and $\\epsilon_{ijk}$ is the residual (within-condition) error for replicate $k$ under fixed instrument and operator. Assume the random effects are mutually independent and centered: $\\mathbb{E}[I_i] = 0$, $\\mathbb{E}[O_{j(i)}] = 0$, $\\mathbb{E}[\\epsilon_{ijk}] = 0$, with variances $\\mathrm{Var}(I_i) = \\sigma_I^2$, $\\mathrm{Var}(O_{j(i)}) = \\sigma_{O(I)}^2$, and $\\mathrm{Var}(\\epsilon_{ijk}) = \\sigma_e^2$.\n\n- Using the independence of additive random effects and the variance properties (for independent variables $X$ and $Z$, $\\mathrm{Var}(X+Z) = \\mathrm{Var}(X) + \\mathrm{Var}(Z)$), the total variance under a given set of conditions is the sum of the variances of the included effects.\n\nFrom first principles, we construct CVs for specific condition sets:\n1. Repeatability CV:\n   - Definition: Same instrument, same operator, same environment. Only residual error contributes.\n   - Variance: $$\\mathrm{Var}_{\\text{repeat}}(Y) = \\sigma_e^2.$$\n   - CV: $$CV_{\\text{repeat}} = \\frac{\\sqrt{\\sigma_e^2}}{\\mu}.$$\n\n2. Operator-within-instrument CV:\n   - Definition: Variation across operators nested within a fixed instrument, plus residual error. This represents intermediate precision across operators while holding instrument constant.\n   - Variance: $$\\mathrm{Var}_{\\text{operator}}(Y) = \\sigma_{O(I)}^2 + \\sigma_e^2.$$\n   - CV: $$CV_{\\text{operator}} = \\frac{\\sqrt{\\sigma_{O(I)}^2 + \\sigma_e^2}}{\\mu}.$$\n\n3. Reproducibility CV (across instruments and operators):\n   - Definition: Variation across instruments and operators, reflecting realistic inter-condition variability under routine implementation.\n   - Variance: $$\\mathrm{Var}_{\\text{reprod}}(Y) = \\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2.$$\n   - CV: $$CV_{\\text{reprod}} = \\frac{\\sqrt{\\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2}}{\\mu}.$$\n\nNumerical stability:\n- When $|\\mu|$ is too small, division by $\\mu$ destabilizes the CV. We introduce a threshold $\\varepsilon = 10^{-12}$ and return a not-a-number indicator if $|\\mu| < \\varepsilon$.\n\nAlgorithmic design:\n- For each case with parameters $(\\mu, \\sigma_I^2, \\sigma_{O(I)}^2, \\sigma_e^2)$:\n  - Compute $v_{\\text{repeat}} = \\sigma_e^2$, $v_{\\text{operator}} = \\sigma_{O(I)}^2 + \\sigma_e^2$, and $v_{\\text{reprod}} = \\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2$.\n  - If $|\\mu| \\ge \\varepsilon$, compute each $CV$ as $\\sqrt{v}/\\mu$; otherwise return not-a-number.\n  - Round each $CV$ to six decimal places.\n- Aggregate the three $CV$ values for each case into a list and output the list of lists for all cases.\n\nTest suite and expected behavior:\n- Case A: $(\\mu = 0.25, \\sigma_I^2 = 0.0004, \\sigma_{O(I)}^2 = 0.0001, \\sigma_e^2 = 0.00005)$.\n  - $CV_{\\text{repeat}} \\approx 0.028284$, $CV_{\\text{operator}} \\approx 0.048990$, $CV_{\\text{reprod}} \\approx 0.093808$.\n- Case B: $(\\mu = 0.50, \\sigma_I^2 = 0, \\sigma_{O(I)}^2 = 0.0002, \\sigma_e^2 = 0.0001)$.\n  - $CV_{\\text{repeat}} \\approx 0.020000$, $CV_{\\text{operator}} \\approx 0.034641$, $CV_{\\text{reprod}} \\approx 0.034641$.\n- Case C: $(\\mu = 0.01, \\sigma_I^2 = 0.000001, \\sigma_{O(I)}^2 = 0.000002, \\sigma_e^2 = 0.000001)$.\n  - $CV_{\\text{repeat}} \\approx 0.100000$, $CV_{\\text{operator}} \\approx 0.173205$, $CV_{\\text{reprod}} \\approx 0.200000$.\n- Case D: $(\\mu = 0.30, \\sigma_I^2 = 0.0009, \\sigma_{O(I)}^2 = 0, \\sigma_e^2 = 0)$.\n  - $CV_{\\text{repeat}} \\approx 0.000000$, $CV_{\\text{operator}} \\approx 0.000000$, $CV_{\\text{reprod}} \\approx 0.100000$.\n- Case E: $(\\mu = 0.90, \\sigma_I^2 = 0.00005, \\sigma_{O(I)}^2 = 0.00005, \\sigma_e^2 = 0.00002)$.\n  - $CV_{\\text{repeat}} \\approx 0.004969$, $CV_{\\text{operator}} \\approx 0.009296$, $CV_{\\text{reprod}} \\approx 0.012172$.\n\nContextual integration:\n- These CVs quantify analytic precision components central to analytic validity. Clinical validity connects assay output $Y$ to the presence or risk of a clinical condition (e.g., pathogenic variant), and clinical utility evaluates net patient benefit under decision use. Robust analytic precision under repeatability and reproducibility supports, but does not alone establish, clinical validity or utility; those require separate evidence regarding sensitivity, specificity, predictive values, and outcomes.\n\nThe program will implement the computations as described and produce a single-line nested list of rounded decimals for all cases.", "answer": "```python\nimport numpy as np\n\ndef compute_cvs(mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error, eps=1e-12):\n    \"\"\"\n    Compute repeatability, operator-within-instrument, and reproducibility CVs.\n    CV = sqrt(variance_component)/mu, returned as floats.\n    If |mu| < eps, return np.nan for the corresponding CV to avoid instability.\n    \"\"\"\n    # Variance components for each precision definition\n    var_repeat = sigma2_error\n    var_operator = sigma2_oper_in_instr + sigma2_error\n    var_reprod = sigma2_instr + sigma2_oper_in_instr + sigma2_error\n\n    if abs(mu) < eps:\n        return [float('nan'), float('nan'), float('nan')]\n\n    cv_repeat = np.sqrt(var_repeat) / mu\n    cv_operator = np.sqrt(var_operator) / mu\n    cv_reprod = np.sqrt(var_reprod) / mu\n\n    # Round to six decimal places\n    return [round(cv_repeat, 6), round(cv_operator, 6), round(cv_reprod, 6)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (mu, sigma_I^2, sigma_{O(I)}^2, sigma_e^2)\n    test_cases = [\n        (0.25, 0.0004, 0.0001, 0.00005),    # Case A\n        (0.50, 0.0,    0.0002, 0.0001),     # Case B\n        (0.01, 0.000001, 0.000002, 0.000001),  # Case C\n        (0.30, 0.0009, 0.0,    0.0),        # Case D\n        (0.90, 0.00005, 0.00005, 0.00002),  # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error = case\n        cvs = compute_cvs(mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error)\n        results.append(cvs)\n\n    # Final print statement in the exact required format.\n    # Nested list printed as a single line with comma-separated elements.\n    # Ensure standard Python list representation.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "4316319"}, {"introduction": "A test that perfectly detects a genetic variant does not automatically predict disease with certainty, a crucial distinction in the assessment of clinical validity. This gap is often due to biological factors like incomplete penetrance, where carrying a variant does not guarantee the development of the associated condition. This practice challenges you to derive the positive predictive value for disease risk by integrating the test's analytic performance with the variant's population frequency and its penetrance, highlighting how true clinical validity is a function of both technology and biology [@problem_id:4316344].", "problem": "A germline variant $V$ is known, from prior clinical validity studies, to increase risk for a disease $D$ with incomplete penetrance. Let the carrier fraction (prevalence of individuals who carry $V$) in the target population be $f \\in (0,1)$. The penetrance is defined as the conditional probability $\\pi = \\mathbb{P}(D \\mid V)$, where $0 < \\pi < 1$. Assume that, in this population and for the indication considered, disease $D$ arises only via $V$ (that is, $\\mathbb{P}(D \\mid \\neg V) = 0$), so that incomplete penetrance is the sole source of genotype–phenotype discordance.\n\nA laboratory test $T$ detects $V$ with analytic sensitivity $\\alpha = \\mathbb{P}(T^{+} \\mid V)$ and analytic specificity $\\sigma = \\mathbb{P}(T^{-} \\mid \\neg V)$, where $0 < \\alpha \\leq 1$ and $0 < \\sigma \\leq 1$. Assume the test reads $T^{+}$ if and only if it detects $V$.\n\nUsing only the fundamental definitions of conditional probability, the law of total probability, and Bayes’ theorem, derive an explicit expression for the positive predictive value (PPV) for disease risk, defined here as $\\mathbb{P}(D \\mid T^{+})$, in terms of $\\alpha$, $\\sigma$, $f$, and $\\pi$. Your final answer must be a single closed-form expression. Do not introduce any unprovided parameters and do not approximate. Express your final answer as a symbolic mathematical expression; no rounding is required.", "solution": "The objective is to derive an expression for the positive predictive value (PPV) for disease risk, which is defined as the conditional probability $\\mathbb{P}(D \\mid T^{+})$. We are given the following quantities:\n-   Carrier fraction: $f = \\mathbb{P}(V)$\n-   Disease penetrance for carriers: $\\pi = \\mathbb{P}(D \\mid V)$\n-   Disease penetrance for non-carriers: $\\mathbb{P}(D \\mid \\neg V) = 0$\n-   Analytic sensitivity of the test $T$: $\\alpha = \\mathbb{P}(T^{+} \\mid V)$\n-   Analytic specificity of the test $T$: $\\sigma = \\mathbb{P}(T^{-} \\mid \\neg V)$\n\nFrom the definition of conditional probability, the PPV is given by:\n$$\n\\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(D \\cap T^{+})}{\\mathbb{P}(T^{+})}\n$$\nWe will derive expressions for the numerator, $\\mathbb{P}(D \\cap T^{+})$, and the denominator, $\\mathbb{P}(T^{+})$, in terms of the given parameters.\n\nFirst, let's analyze the numerator, the joint probability $\\mathbb{P}(D \\cap T^{+})$. We can express this using the law of total probability by conditioning on the presence ($V$) or absence ($\\neg V$) of the germline variant.\n$$\n\\mathbb{P}(D \\cap T^{+}) = \\mathbb{P}(D \\cap T^{+} \\mid V)\\mathbb{P}(V) + \\mathbb{P}(D \\cap T^{+} \\mid \\neg V)\\mathbb{P}(\\neg V)\n$$\nThe problem's structure implies that, conditional on the genetic status (presence or absence of $V$), the test result ($T^{+}$) and the disease state ($D$) are independent events. This is because the test's outcome is determined by the presence of $V$, and the disease state is also determined by the presence of $V$. There is no other path of influence between $T$ and $D$ described. Therefore, we can write:\n$$\n\\mathbb{P}(D \\cap T^{+} \\mid V) = \\mathbb{P}(D \\mid V) \\mathbb{P}(T^{+} \\mid V)\n$$\nand\n$$\n\\mathbb{P(D \\cap T^{+} \\mid \\neg V)} = \\mathbb{P}(D \\mid \\neg V) \\mathbb{P}(T^{+} \\mid \\neg V)\n$$\nWe are given $\\mathbb{P}(D \\mid V) = \\pi$ and $\\mathbb{P}(T^{+} \\mid V) = \\alpha$. We are also given the critical condition that the disease only arises from the variant, $\\mathbb{P}(D \\mid \\neg V) = 0$.\nSubstituting these into the expression for the numerator:\n$$\n\\mathbb{P}(D \\cap T^{+}) = (\\pi \\cdot \\alpha) \\mathbb{P}(V) + (0 \\cdot \\mathbb{P}(T^{+} \\mid \\neg V)) \\mathbb{P}(\\neg V)\n$$\nSince $\\mathbb{P}(V) = f$, the expression simplifies to:\n$$\n\\mathbb{P}(D \\cap T^{+}) = \\pi \\alpha f\n$$\n\nNext, we analyze the denominator, the total probability of a positive test result, $\\mathbb{P}(T^{+})$. Again, we use the law of total probability, conditioning on the presence or absence of the variant $V$.\n$$\n\\mathbb{P}(T^{+}) = \\mathbb{P}(T^{+} \\mid V)\\mathbb{P}(V) + \\mathbb{P}(T^{+} \\mid \\neg V)\\mathbb{P}(\\neg V)\n$$\nWe substitute the known quantities:\n-   $\\mathbb{P}(T^{+} \\mid V) = \\alpha$\n-   $\\mathbb{P}(V) = f$\n-   $\\mathbb{P}(\\neg V) = 1 - \\mathbb{P}(V) = 1 - f$\nThe term $\\mathbb{P}(T^{+} \\mid \\neg V)$ is the false positive rate. It can be derived from the analytic specificity $\\sigma = \\mathbb{P}(T^{-} \\mid \\neg V)$. Since there are only two test outcomes, positive ($T^{+}$) and negative ($T^{-}$), it follows that $\\mathbb{P}(T^{+} \\mid \\neg V) = 1 - \\mathbb{P}(T^{-} \\mid \\neg V) = 1 - \\sigma$.\n\nSubstituting these into the expression for the denominator:\n$$\n\\mathbb{P}(T^{+}) = \\alpha f + (1 - \\sigma)(1 - f)\n$$\n\nFinally, we combine the expressions for the numerator and the denominator to obtain the final expression for the PPV, $\\mathbb{P}(D \\mid T^{+})$:\n$$\n\\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(D \\cap T^{+})}{\\mathbb{P}(T^{+})} = \\frac{\\pi \\alpha f}{\\alpha f + (1 - \\sigma)(1 - f)}\n$$\nThis expression for the positive predictive value for disease risk is entirely in terms of the provided parameters $\\alpha$, $\\sigma$, $f$, and $\\pi$.", "answer": "$$\\boxed{\\frac{\\pi \\alpha f}{\\alpha f + (1 - \\sigma)(1 - f)}}$$", "id": "4316344"}, {"introduction": "The ultimate measure of a test's value is its clinical utility: does using it lead to a net improvement in patient outcomes? This question requires a careful balancing of benefits and harms. In this final exercise, you will construct a decision-analytic model to evaluate a test-and-treat strategy, weighing the benefit of disease prevention against the harms of treatment. Your goal is to derive the minimum sensitivity ($Se$) and specificity ($Sp$) a test must achieve for its use to be considered beneficial, establishing a quantitative threshold for clinical utility [@problem_id:4316262].", "problem": "A genomic screening test is proposed to guide preventive therapy for a binary disease outcome over a fixed time horizon in a population with untreated baseline event risk $\\pi \\in (0,1)$. The test’s clinical validity is characterized by sensitivity $(\\text{sensitivity, } Se)$ and specificity $(\\text{specificity, } Sp)$ with respect to the future disease event during the horizon; that is, $P(T=1 \\mid Y=1)=Se$ and $P(T=1 \\mid Y=0)=1-Sp$, where $T$ denotes the test result and $Y$ denotes the event.\n\nA treat-if-positive strategy is adopted: individuals with $T=1$ receive a preventive treatment; those with $T=0$ do not. The treatment reduces the absolute probability of the event multiplicatively by a relative risk factor $RR \\in (0,1)$ among treated individuals (i.e., if an untreated individual’s event probability is $p$, then under treatment it becomes $RR \\cdot p$). Every treated individual incurs an expected disutility $h \\ge 0$ measured on the same scale as absolute risk of the event (that is, $h$ is interpreted as an equivalent absolute risk increase of an event per treated person due to harms such as adverse effects, burden, or opportunity costs). Assume linear additivity of utility components and independence needed to apply standard frequency definitions for $Se$ and $Sp$.\n\nDefine the per-capita net utility of the test-guided strategy as the expected absolute risk reduction from prevented events minus the expected treatment harm. Using only fundamental definitions of sensitivity, specificity, relative risk, and expected value, derive a threshold analysis that yields the minimum $Se$ required for net utility to be positive given a fixed $Sp$, and the minimum $Sp$ required for net utility to be positive given a fixed $Se$. Express both thresholds in closed form as functions of $\\pi$, $RR$, $h$, and the corresponding fixed accuracy parameter. State any necessary regularity conditions on parameters for the thresholds to be finite and interpretable. Provide your final answer as a pair $\\left(Se_{\\min}, Sp_{\\min}\\right)$ in a single row matrix. No numerical evaluation is required; the answer must be an exact symbolic expression without units.", "solution": "### Derivation of Net Utility\n\nThe per-capita net utility, $U$, is the difference between the expected absolute risk reduction (the benefit) and the expected treatment harm (the cost).\n$$U = E[\\text{Risk Reduction}] - E[\\text{Harm}]$$\n\n**1. Expected Treatment Harm**\nHarm of magnitude $h$ is incurred by every treated individual. The treatment rule is to treat if the test is positive ($T=1$). Therefore, the per-capita expected harm is the harm per person, $h$, multiplied by the probability of being treated, $P(T=1)$.\nWe find $P(T=1)$ using the law of total probability:\n$$P(T=1) = P(T=1 \\mid Y=1)P(Y=1) + P(T=1 \\mid Y=0)P(Y=0)$$\nSubstituting the given definitions: $P(Y=1) = \\pi$, $P(Y=0) = 1-\\pi$, $P(T=1 \\mid Y=1) = Se$, and $P(T=1 \\mid Y=0) = 1-Sp$.\n$$P(T=1) = Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)$$\nThe expected harm is:\n$$E[\\text{Harm}] = h \\cdot P(T=1) = h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)]$$\n\n**2. Expected Absolute Risk Reduction**\nRisk reduction occurs only in individuals who are treated and would have otherwise developed the disease. These are the \"true positive\" cases, where $T=1$ and $Y=1$.\nFor an individual with $Y=1$, the probability of the event is $1$. With treatment, this probability becomes $RR \\cdot 1 = RR$. The absolute risk reduction for such an individual is $1 - RR$.\nThe benefit is realized only for this group, so the per-capita expected risk reduction is this individual benefit, $1-RR$, multiplied by the proportion of such individuals in the population, $P(T=1, Y=1)$.\nUsing the definition of conditional probability:\n$$P(T=1, Y=1) = P(T=1 \\mid Y=1)P(Y=1) = Se \\cdot \\pi$$\nThe expected risk reduction is:\n$$E[\\text{Risk Reduction}] = (1-RR) \\cdot P(T=1, Y=1) = (1-RR) \\cdot Se \\cdot \\pi$$\n\n**3. Net Utility Expression**\nCombining the harm and benefit terms, the net utility $U$ is:\n$$U = (1-RR) \\cdot Se \\cdot \\pi - h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)]$$\n\n### Threshold Analysis\n\nThe condition for the test-guided strategy to have positive net utility is $U > 0$.\n$$(1-RR) \\cdot Se \\cdot \\pi - h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)] > 0$$\n$$(1-RR) \\cdot Se \\cdot \\pi > h \\cdot Se \\cdot \\pi + h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n\n**Derivation of Minimum Sensitivity ($Se_{\\min}$)**\nWe rearrange the inequality to solve for $Se$, holding $Sp$ fixed.\n$$(1-RR) \\cdot Se \\cdot \\pi - h \\cdot Se \\cdot \\pi > h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n$$Se \\cdot \\pi \\cdot (1 - RR - h) > h \\cdot (1-Sp) \\cdot (1-\\pi)$$\nFor a physically meaningful threshold to exist, the coefficient of $Se$ must be positive. That is, $1-RR-h > 0$, or $h < 1-RR$. This is a necessary regularity condition, implying that the benefit of treating a person known to be destined for the event must exceed the harm of the treatment itself. If this condition holds, we can divide by $\\pi \\cdot (1 - RR - h)$ (which is positive since $\\pi \\in (0,1)$) without changing the inequality's direction.\n$$Se > \\frac{h \\cdot (1-Sp) \\cdot (1-\\pi)}{\\pi \\cdot (1-RR-h)}$$\nThus, the minimum required sensitivity is:\n$$Se_{\\min} = \\frac{h \\cdot (1-Sp) \\cdot (1-\\pi)}{\\pi \\cdot (1-RR-h)}$$\nThis threshold is interpretable (i.e., finite and positive) under the condition $h < 1-RR$. If $h \\ge 1-RR$, the net utility cannot be made positive for any $Se \\in [0,1]$, so no meaningful threshold exists.\n\n**Derivation of Minimum Specificity ($Sp_{\\min}$)**\nWe rearrange the inequality to solve for $Sp$, holding $Se$ fixed.\n$$(1-RR) \\cdot Se \\cdot \\pi > h \\cdot Se \\cdot \\pi + h \\cdot (1-\\pi) - h \\cdot Sp \\cdot (1-\\pi)$$\n$$h \\cdot Sp \\cdot (1-\\pi) > h \\cdot Se \\cdot \\pi + h \\cdot (1-\\pi) - (1-RR) \\cdot Se \\cdot \\pi$$\n$$h \\cdot Sp \\cdot (1-\\pi) > h(1-\\pi) - Se \\cdot \\pi \\cdot (1-RR-h)$$\nFor this derivation, we assume $h > 0$. If $h=0$, the harm is zero, and the utility $U = (1-RR)Se\\pi$ is positive for any $Se > 0$, irrespective of $Sp$. In that case, $Sp_{\\min}=0$.\nAssuming $h > 0$ and noting $1-\\pi > 0$, we can divide by $h \\cdot (1-\\pi)$:\n$$Sp > 1 - \\frac{Se \\cdot \\pi \\cdot (1-RR-h)}{h \\cdot (1-\\pi)}$$\nThus, the minimum required specificity is:\n$$Sp_{\\min} = 1 - \\frac{Se \\cdot \\pi \\cdot (1-RR-h)}{h \\cdot (1-\\pi)}$$\nThis threshold is interpretable (i.e., $Sp_{\\min} < 1$) under the same regularity condition as before, $h < 1-RR$. If $h \\ge 1-RR$, the term being subtracted from $1$ is negative or zero, implying $Sp_{\\min} \\ge 1$, which requires a perfect or unattainable specificity. Thus, the necessary conditions for a useful, non-trivial threshold are $h>0$ and $h < 1-RR$.\n\nThe final answer is the pair of derived expressions for $Se_{\\min}$ and $Sp_{\\min}$.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{h(1-Sp)(1-\\pi)}{\\pi(1-RR-h)} & 1 - \\frac{Se \\cdot \\pi (1-RR-h)}{h(1-\\pi)} \\end{pmatrix} } $$", "id": "4316262"}]}