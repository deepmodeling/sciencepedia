{"hands_on_practices": [{"introduction": "The journey of any rigorous clinical trial begins with a crucial planning phase. This exercise guides you through the fundamental task of power analysis to determine the appropriate sample size for a study. By deriving the formula from first principles, you will gain a deeper appreciation for how target effect size ($d$), statistical power ($1-\\beta$), and the significance level ($\\alpha$) collectively dictate the required number of participants, ensuring your research is both ethical and efficient.[@problem_id:4730090]", "problem": "A psychiatry research team is planning a $2$-arm parallel-group Randomized Controlled Trial (RCT) to compare Mindfulness-Based Cognitive Therapy (MBCT) to a structurally equivalent health education control in adults with recurrent major depressive disorder. The primary outcome is a continuous symptom severity score (e.g., a validated depression scale) measured at post-treatment. Based on prior literature in mindfulness-based interventions, the team targets a Standardized Mean Difference (SMD) of $d=0.40$ between arms. Assume the following:\n- Outcomes in each arm are independently and identically distributed as approximately normal with equal variances.\n- The allocation ratio is $1{:}1$.\n- A two-sided Type I error rate of $\\alpha=0.05$ and power $1-\\beta=0.80$ are required.\n- A large-sample normal approximation to the two-sample $t$-test is acceptable for planning.\n\nStarting from first principles of hypothesis testing and the definition of the Standardized Mean Difference (SMD), derive the sample size formula needed to detect the targeted effect and then compute the minimal total sample size required for the trial. You must:\n- Explicitly derive the expression for the required per-arm sample size in terms of $d$, $\\alpha$, and $\\beta$, without invoking any pre-memorized shortcut formulas.\n- Evaluate the expression at $d=0.40$, $\\alpha=0.05$, and $1-\\beta=0.80$, using standard normal critical values.\n- Report the final answer as the minimal integer total sample size $N_{\\text{total}}$ that achieves the specified operating characteristics (i.e., take the smallest integer that satisfies the requirement). Provide only the total sample size as the answer.", "solution": "The problem is subjected to validation against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Study Design: $2$-arm parallel-group Randomized Controlled Trial (RCT).\n-   Intervention: Mindfulness-Based Cognitive Therapy (MBCT).\n-   Control: Structurally equivalent health education control.\n-   Population: Adults with recurrent major depressive disorder.\n-   Primary Outcome: A continuous symptom severity score.\n-   Targeted Effect Size: Standardized Mean Difference (SMD), $d=0.40$.\n-   Assumptions:\n    1.  Outcomes in each arm are independently and identically distributed as approximately normal with equal variances.\n    2.  Allocation ratio is $1{:}1$.\n    3.  Two-sided Type I error rate of $\\alpha=0.05$.\n    4.  Power $1-\\beta=0.80$.\n    5.  A large-sample normal approximation to the two-sample $t$-test is acceptable.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is well-grounded in the fundamental principles of biostatistics, specifically power and sample size calculation for clinical trials. The parameters and context are standard and realistic for psychiatric research.\n-   **Well-Posedness**: The problem provides all necessary information ($\\alpha$, $\\beta$, $d$, allocation ratio, and test type) to derive a unique and meaningful solution.\n-   **Objectivity**: The problem is stated in precise, quantitative, and unbiased language.\n-   **Completeness and Consistency**: The problem is self-contained and free of contradictions. The assumptions are mutually consistent and standard for this type of calculation.\n\n**Step 3: Verdict and Action**\nThe problem is assessed as **valid**. It is scientifically sound, well-posed, and objective. A rigorous solution can and will be derived.\n\n### Derivation and Solution\n\nLet $\\mu_I$ and $\\mu_C$ be the true mean symptom scores for the intervention (MBCT) and control arms, respectively. Let $\\sigma^2$ be the common variance of the scores in each arm. The sample size in each arm is denoted by $n$, as the allocation is $1{:}1$. The total sample size is $N_{\\text{total}} = 2n$.\n\nThe null hypothesis ($H_0$) and the two-sided alternative hypothesis ($H_A$) are:\n$$ H_0: \\mu_I = \\mu_C \\quad (\\text{i.e., } \\mu_I - \\mu_C = 0) $$\n$$ H_A: \\mu_I \\neq \\mu_C \\quad (\\text{i.e., } \\mu_I - \\mu_C \\neq 0) $$\n\nLet $\\bar{X}_I$ and $\\bar{X}_C$ be the sample means from the two arms. The problem allows for a large-sample normal approximation, so the test statistic is based on the normal distribution. The test statistic $Z$ is constructed from the difference in sample means:\n$$ Z = \\frac{(\\bar{X}_I - \\bar{X}_C) - (\\mu_I - \\mu_C)}{\\sqrt{\\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n}}} = \\frac{\\bar{X}_I - \\bar{X}_C - (\\mu_I - \\mu_C)}{\\sigma\\sqrt{\\frac{2}{n}}} $$\nUnder the null hypothesis ($H_0$), $\\mu_I - \\mu_C = 0$, so the statistic simplifies to:\n$$ Z_{H_0} = \\frac{\\bar{X}_I - \\bar{X}_C}{\\sigma\\sqrt{\\frac{2}{n}}} $$\nUnder $H_0$, $Z_{H_0}$ follows the standard normal distribution, $N(0, 1)$.\n\nThe Type I error rate, $\\alpha$, is the probability of rejecting $H_0$ when it is true. For a two-sided test with a significance level of $\\alpha=0.05$, we reject $H_0$ if $|Z_{H_0}| > z_{1-\\alpha/2}$, where $z_{1-\\alpha/2}$ is the upper $(1-\\alpha/2)$-quantile of the standard normal distribution. Here, this is $z_{0.975}$.\n\nPower, $1-\\beta$, is the probability of correctly rejecting $H_0$ when the alternative hypothesis $H_A$ is true. We evaluate power for a specific alternative defined by the Standardized Mean Difference, $d = \\frac{\\mu_I - \\mu_C}{\\sigma}$. Let $\\delta = \\mu_I - \\mu_C$. Then $d = \\delta/\\sigma$.\nUnder this specific alternative, the test statistic $Z_{H_0}$ is no longer standard normal. Its mean is:\n$$ E[Z_{H_0}] = E\\left[\\frac{\\bar{X}_I - \\bar{X}_C}{\\sigma\\sqrt{\\frac{2}{n}}}\\right] = \\frac{E[\\bar{X}_I - \\bar{X}_C]}{\\sigma\\sqrt{\\frac{2}{n}}} = \\frac{\\delta}{\\sigma\\sqrt{\\frac{2}{n}}} = \\frac{d\\sigma}{\\sigma\\sqrt{\\frac{2}{n}}} = d\\sqrt{\\frac{n}{2}} $$\nThe power is the probability that the observed statistic falls in the rejection region, given $H_A$ is true.\n$$ 1 - \\beta = P(|Z_{H_0}| > z_{1-\\alpha/2} | H_A) $$\nFor a positive effect size $d>0$, the probability of the statistic falling in the lower tail rejection region is negligible. The power is thus dominated by the upper tail:\n$$ 1 - \\beta \\approx P(Z_{H_0} > z_{1-\\alpha/2} | H_A) $$\nTo evaluate this probability, we standardize $Z_{H_0}$ using its non-zero mean under $H_A$:\n$$ 1 - \\beta \\approx P\\left( \\frac{Z_{H_0} - d\\sqrt{\\frac{n}{2}}}{1} > z_{1-\\alpha/2} - d\\sqrt{\\frac{n}{2}} \\right) $$\nThe term on the left inside the probability is now a standard normal variable. Let $Z' \\sim N(0, 1)$.\n$$ 1 - \\beta \\approx P\\left( Z' > z_{1-\\alpha/2} - d\\sqrt{\\frac{n}{2}} \\right) $$\nBy definition of power, we also have $1 - \\beta = P(Z' > z_{\\beta}) = P(Z' > -z_{1-\\beta})$. Equating the arguments gives:\n$$ -z_{1-\\beta} = z_{1-\\alpha/2} - d\\sqrt{\\frac{n}{2}} $$\nNow, we derive the expression for $n$:\n$$ d\\sqrt{\\frac{n}{2}} = z_{1-\\alpha/2} + z_{1-\\beta} $$\n$$ \\sqrt{n} = \\frac{\\sqrt{2}(z_{1-\\alpha/2} + z_{1-\\beta})}{d} $$\n$$ n = \\frac{2(z_{1-\\alpha/2} + z_{1-\\beta})^2}{d^2} $$\nThis is the required formula for the sample size per arm.\n\nNext, we evaluate this expression for the given parameters: $d=0.40$, $\\alpha=0.05$, and $1-\\beta=0.80$.\nThis implies $\\beta=0.20$.\nWe require the standard normal quantiles:\n- For the two-sided significance level $\\alpha=0.05$, the critical value is $z_{1-\\alpha/2} = z_{1-0.025} = z_{0.975} \\approx 1.95996$.\n- For the power $1-\\beta=0.80$, the critical value is $z_{1-\\beta} = z_{0.80} \\approx 0.84162$.\n\nSubstituting these values into the derived formula for $n$:\n$$ n = \\frac{2(1.95996 + 0.84162)^2}{(0.40)^2} $$\n$$ n = \\frac{2(2.80158)^2}{0.16} $$\n$$ n = \\frac{2(7.84885...)}{0.16} $$\n$$ n = \\frac{15.6977...}{0.16} $$\n$$ n \\approx 98.11 $$\nSince the number of participants must be an integer, and the power must be at least $0.80$, we must round the calculated value of $n$ up to the next integer.\n$$ n_{\\text{per arm}} = \\lceil 98.11 \\rceil = 99 $$\nThe minimal required sample size for each of the two arms is $99$.\nThe total sample size is the sum of the sample sizes in both arms:\n$$ N_{\\text{total}} = n_{\\text{per arm}} + n_{\\text{per arm}} = 99 + 99 = 198 $$\n\nThus, a minimal total sample size of $198$ participants ($99$ per arm) is required to achieve $80\\%$ power to detect a standardized mean difference of $0.40$ at a two-sided significance level of $0.05$.", "answer": "$$\n\\boxed{198}\n$$", "id": "4730090"}, {"introduction": "After a trial is complete, the focus shifts from planning to interpretation. It is not enough to know if an effect is statistically significant; we must also understand its clinical utility. This practice introduces the Number Needed to Treat (NNT), a powerful metric that translates statistical results into a tangible measure of therapeutic effort, helping clinicians and policymakers assess the real-world impact of an intervention like Mindfulness-Based Cognitive Therapy.[@problem_id:4730132]", "problem": "A hospital-based randomized controlled trial (RCT) compared an $8$-week Mindfulness-Based Cognitive Therapy (MBCT), a type of Mindfulness-Based Intervention (MBI), to an active control condition of stress management education (SME) for adults with Generalized Anxiety Disorder (GAD). Remission was defined a priori as achieving and maintaining a score of $\\leq 4$ on the Generalized Anxiety Disorder $7$-item scale (GAD-$7$) for at least $4$ consecutive weeks at the end of the acute phase.\n\nIn the per-protocol analysis, $n_1 = 200$ participants were randomized to MBCT and $n_0 = 200$ to SME. Of those, $k_1 = 72$ achieved remission in the MBCT arm and $k_0 = 48$ achieved remission in the SME arm. Assume the standard causal inference conditions induced by randomization, including exchangeability, consistency, and the Stable Unit Treatment Value Assumption (SUTVA). Treat individual remission outcomes as realizations of independent Bernoulli random variables within each arm.\n\nUsing only foundational definitions of event probability, absolute risk reduction as the difference in remission probabilities, and the clinical utility metric defined as the number of patients that need to be treated with MBCT instead of SME to obtain one additional remission on average, derive the appropriate estimator and compute its value from the data. Report the Number Needed to Treat (NNT) using the conventional reporting rule that it is the smallest integer greater than or equal to the exact reciprocal of the absolute risk reduction. Provide the NNT as a single number. In addition, interpret whether the result meets a prespecified service-level threshold for clinical significance of $10$ or less on this metric, justifying your conclusion from first principles.\n\nYour final answer must be a single number with no units. Do not use a percentage sign anywhere. If any rounding is necessary, apply only the conventional NNT reporting rule specified above.", "solution": "The problem statement has been rigorously validated and found to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard biostatistical analysis scenario based on data from a randomized controlled trial (RCT). All necessary information is provided, and the definitions are clear and consistent with established principles in clinical epidemiology and causal inference. Therefore, a complete and reasoned solution can be provided.\n\nThe objective is to compute the Number Needed to Treat (NNT) and interpret its clinical significance based on a given threshold.\n\nFirst, we define the parameters of interest. Let $p_1$ be the true probability of remission for a participant in the Mindfulness-Based Cognitive Therapy (MBCT) arm, and let $p_0$ be the true probability of remission for a participant in the stress management education (SME) arm. The problem states that individual remission outcomes are to be treated as independent Bernoulli random variables.\n\nThe data provided from the per-protocol analysis are:\n-   Number of participants in the MBCT arm: $n_{1} = 200$.\n-   Number of remissions in the MBCT arm: $k_{1} = 72$.\n-   Number of participants in the SME arm: $n_{0} = 200$.\n-   Number of remissions in the SME arm: $k_{0} = 48$.\n\nThe unbiased and maximum likelihood estimators for the true remission probabilities, $p_1$ and $p_0$, are the sample proportions in each arm. Let $\\hat{p}_1$ and $\\hat{p}_0$ denote these estimators.\n\nThe estimated probability of remission in the MBCT arm is:\n$$\n\\hat{p}_1 = \\frac{k_{1}}{n_{1}} = \\frac{72}{200} = 0.36\n$$\nThe estimated probability of remission in the SME arm is:\n$$\n\\hat{p}_0 = \\frac{k_{0}}{n_{0}} = \\frac{48}{200} = 0.24\n$$\n\nThe Absolute Risk Reduction (ARR) is defined as the difference in the probability of a favorable outcome between the treatment and control groups. In this case, the favorable outcome is remission.\n$$\nARR = p_1 - p_0\n$$\nThe sample estimate of the ARR, denoted $\\widehat{ARR}$, is calculated using the sample proportions:\n$$\n\\widehat{ARR} = \\hat{p}_1 - \\hat{p}_0 = 0.36 - 0.24 = 0.12\n$$\nThis value, $\\widehat{ARR}=0.12$, represents a $12$ percentage point increase in the remission rate attributable to MBCT compared to SME.\n\nNext, we derive the NNT from first principles as requested. The NNT is defined as the number of patients that need to be treated with the intervention (MBCT) instead of the control (SME) to achieve one additional favorable outcome (remission) on average.\n\nLet $N$ be the number of patients treated. If these $N$ patients receive MBCT, the expected number of remissions is $E[\\text{Remissions}_{\\text{MBCT}}] = N \\times p_1$. If the same $N$ patients receive SME, the expected number of remissions is $E[\\text{Remissions}_{\\text{SME}}] = N \\times p_0$.\n\nThe expected number of *additional* remissions gained by treating these $N$ patients with MBCT instead of SME is the difference of these expectations:\n$$\nE[\\text{Additional Remissions}] = (N \\times p_1) - (N \\times p_0) = N \\times (p_1 - p_0) = N \\times ARR\n$$\nTo find the NNT, we set the expected number of additional remissions to $1$:\n$$\n1 = NNT \\times ARR\n$$\nSolving for NNT gives the formula:\n$$\nNNT = \\frac{1}{ARR}\n$$\nThe estimator for the NNT is therefore the reciprocal of the estimated ARR:\n$$\n\\widehat{NNT}_{\\text{exact}} = \\frac{1}{\\widehat{ARR}}\n$$\nUsing the calculated $\\widehat{ARR}$, we compute the exact value of the NNT estimate:\n$$\n\\widehat{NNT}_{\\text{exact}} = \\frac{1}{0.12} = \\frac{1}{12/100} = \\frac{100}{12} = \\frac{25}{3} \\approx 8.333...\n$$\nThe problem specifies the conventional reporting rule for NNT: it must be reported as the smallest integer greater than or equal to the exact value. This is equivalent to applying the ceiling function, $\\lceil \\cdot \\rceil$.\n$$\nNNT_{\\text{reported}} = \\lceil \\widehat{NNT}_{\\text{exact}} \\rceil = \\lceil \\frac{25}{3} \\rceil = \\lceil 8.333... \\rceil = 9\n$$\nThe calculated NNT is $9$. This means that, on average, for every $9$ patients with GAD treated with MBCT instead of SME, one additional patient will experience remission.\n\nFinally, we must interpret this result against the prespecified service-level threshold for clinical significance, which is an NNT of $10$ or less. Our calculated NNT is $9$. Since $9 \\leq 10$, the result meets the threshold for clinical significance. A lower NNT indicates a more effective treatment, as fewer patients need to be treated to see one additional benefit. The finding that MBCT is superior to SME with an NNT of $9$ is therefore considered clinically meaningful according to the trial's a priori criterion.", "answer": "$$\n\\boxed{9}\n$$", "id": "4730132"}, {"introduction": "Beyond evaluating a primary outcome, a key question in intervention research is understanding the \"dose-response\" relationship: does more engagement lead to better outcomes? This advanced exercise simulates a common research scenario, tasking you with processing raw app-based practice data to quantify adherence and then fitting a sophisticated, theory-driven dose-response model. This practice moves beyond simple linear relationships to explore more realistic, saturating effects, reflecting the nuanced reality of how behavioral interventions work.[@problem_id:4730080]", "problem": "You are provided with app-based home practice logs from participants receiving a mindfulness-based intervention and symptom scores from a validated psychiatric scale before and after the intervention. The aim is to quantify adherence from app logs and to compute the relationship between total practice minutes (\"dose\") and symptom change using a dose-response model grounded in general principles rather than a preset formula. Your solution must implement a complete program that carries out the following tasks from first principles.\n\nFundamental base and definitions:\n- Adherence in psychotherapy is defined as the extent to which a participant's behavior corresponds with agreed recommendations from a healthcare provider. In the present context, the recommendation is to practice daily. The logs contain daily practice minutes. Missing entries indicate that a log was not recorded for that day.\n- For each participant $i$, let $N$ denote the number of scheduled days in the intervention period, $m_{i,d}$ denote recorded minutes of practice on day $d$ (with missing represented explicitly as a specialized missing token), and $\\theta$ denote a daily minutes threshold to count a day as adherent.\n- Define dose $D_i$ for participant $i$ as the cumulative minutes of all recorded days, treating missing logs as $0$ minutes. Define adherence proportion $A_i$ for participant $i$ as the number of days with $m_{i,d} \\ge \\theta$ divided by $N$.\n- Let $S_{i,\\text{pre}}$ and $S_{i,\\text{post}}$ denote the pre- and post-intervention symptom scores. Define symptom change $Y_i = S_{i,\\text{pre}} - S_{i,\\text{post}}$, so that larger $Y_i$ represents greater symptom improvement (in scale points).\n\nDose-response model to be derived and fitted:\n- Assume a monotonic, concave dose-response function $f(D)$ satisfying $f(0) = 0$, having a finite asymptotic maximum effect $E_{\\max}$, and possessing a characteristic dose $EC_{50}$ defined such that $f(EC_{50}) = \\frac{1}{2} E_{\\max}$. Under independent Gaussian residuals for observed $Y_i$ around the mean function $f(D_i)$, derive an appropriate parametric form for $f(D)$ that obeys these properties. Then, fit its parameters by maximum likelihood estimation (Gaussian), which is equivalent to nonlinear least squares under the stated residual assumptions.\n- As a comparator, also fit a linear model $g(D) = \\beta_0 + \\beta_1 D$ under Gaussian residuals, and compute the coefficient of determination $R^2$ for both the derived dose-response model and the linear model. Decide whether the derived dose-response model explains at least as much variance as the linear model by comparing the $R^2$ values.\n\nAdherence quantification details:\n- Treat missing daily logs explicitly as \"missing\" and do not count them as adherent days. For dose computation, treat missing as $0$ minutes. This corresponds to a conservative assumption often used in clinical data analysis when missingness reflects non-practice.\n- Adherence thresholds and scheduled days vary across test cases, as specified below.\n\nUnits and output specification:\n- Practice minutes must be handled and reported in minutes.\n- Symptom changes must be handled and reported in scale points.\n- The program must output, for each test case, a list containing: the mean adherence across participants (decimal, rounded to three decimals), the estimated $E_{\\max}$ (scale points, rounded to three decimals), the estimated $EC_{50}$ (minutes, rounded to three decimals), and a boolean that is true if the derived dose-response model has $R^2$ greater than or equal to the linear model and false otherwise.\n- Aggregate all test case results into a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[[x1,y1,z1,b1],[x2,y2,z2,b2],[x3,y3,z3,b3]]\"), with floats rounded to three decimals and booleans unmodified.\n\nTest suite:\n- Test Case $1$ (\"happy path\", moderate doses, minimal missingness):\n  - Scheduled days $N = 14$; adherence threshold $\\theta = 10$ minutes per day.\n  - Participants: $6$.\n  - Daily practice minutes per participant (lists of length $14$; values in minutes; missing represented by literal \"None\"):\n    - P$1$: [$0$, $0$, $15$, $0$, $0$, $10$, $0$, $5$, $0$, $0$, $0$, $0$, $0$, $0$]\n    - P$2$: [$0$, $10$, $10$, $0$, $20$, $0$, $0$, $10$, $5$, $0$, $0$, $25$, $0$, $0$]\n    - P$3$: [$15$, $15$, $0$, $0$, $30$, $0$, $0$, $20$, $20$, $0$, $10$, $20$, $0$, $0$]\n    - P$4$: [$20$, $20$, $20$, $0$, $30$, $0$, $20$, $20$, $20$, $10$, $20$, $20$, $0$, $0$]\n    - P$5$: [$25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $0$, $0$]\n    - P$6$: [$30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $20$, $0$]\n  - Symptom scores:\n    - Pre: [$18$, $18$, $18$, $18$, $18$, $18$]\n    - Post: [$16.767$, $15.017$, $14.0$, $13.543$, $12.567$, $12.464$]\n- Test Case $2$ (boundary with substantial missingness and low doses):\n  - Scheduled days $N = 14$; adherence threshold $\\theta = 10$ minutes per day.\n  - Participants: $5$.\n  - Daily practice minutes per participant (missing as \"None\"):\n    - P$1$: [None, None, $0$, None, $0$, None, None, $0$, None, None, $0$, None, None, None]\n    - P$2$: [None, $0$, None, $0$, None, $0$, None, $0$, None, $0$, None, $0$, None, $0$]\n    - P$3$: [None, $0$, $10$, $0$, None, $0$, $0$, None, $10$, $0$, None, $0$, None, $0$]\n    - P$4$: [$10$, None, $0$, $10$, None, $0$, $10$, None, $0$, $10$, $0$, None, $0$, None]\n    - P$5$: [None, $15$, None, $15$, $0$, None, $0$, $15$, None, $0$, $15$, None, $0$, None]\n  - Symptom scores:\n    - Pre: [$17$, $16$, $20$, $15$, $19$]\n    - Post: [$17.0$, $16.1$, $18.9$, $13.4$, $16.7$]\n- Test Case $3$ (high doses and saturation, longer schedule):\n  - Scheduled days $N = 28$; adherence threshold $\\theta = 15$ minutes per day.\n  - Participants: $5$.\n  - Daily practice minutes per participant:\n    - P$1$: [$20$, $20$, $0$, $0$, $20$, $0$, $20$, $0$, $0$, $20$, $0$, $0$, $20$, $0$, $20$, $0$, $0$, $0$, $20$, $0$, $0$, $0$, $20$, $0$, $0$, $0$, $20$, $0$]\n    - P$2$: [$20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$]\n    - P$3$: [$20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $20$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$]\n    - P$4$: [$25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $25$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$]\n    - P$5$: [$30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $30$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$]\n  - Symptom scores:\n    - Pre: [$20$, $20$, $20$, $20$, $20$]\n    - Post: [$15.4$, $14.8$, $14.0$, $13.2$, $13.0$]\n\nComputational and output requirements:\n- Implement the adherence quantification and dose computation exactly as defined above.\n- Derive and fit the dose-response model parameters under Gaussian residuals as specified. Also fit the linear comparator. Compute $R^2$ for both models.\n- For each test case, output a list of four elements: mean adherence (decimal), $E_{\\max}$ (scale points), $EC_{50}$ (minutes), and a boolean indicating whether the derived dose-response model has $R^2 \\ge$ the linear model. All floats must be rounded to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[result_case1],[result_case2],[result_case3]]\").\n\nNo user input is to be read; the program must use the test suite provided above and execute deterministically.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of dose-response modeling, a standard methodology in clinical research. The problem is well-posed, providing all necessary definitions, data, and constraints to arrive at a unique, meaningful solution. It is objective, using precise-language and quantitative measures. All data are self-contained and consistent.\n\nHerein, a complete solution is provided, following a step-by-step derivation and computational plan.\n\n### Step 1: Quantification of Adherence, Dose, and Symptom Change\n\nThe initial step involves processing the raw data provided for each test case to compute the primary variables required for modeling. For each participant $i$ out of a total of $P$ participants:\n\n1.  **Dose ($D_i$)**: The dose is defined as the total cumulative minutes of practice over the intervention period of $N$ days. As specified, daily logs with missing entries (represented by a `None` token) are treated as having $0$ minutes of practice. Let $m_{i,d}$ be the recorded minutes for participant $i$ on day $d$. The dose $D_i$ is calculated as:\n    $$D_i = \\sum_{d=1}^{N} \\tilde{m}_{i,d}$$\n    where $\\tilde{m}_{i,d} = m_{i,d}$ if a value is recorded, and $\\tilde{m}_{i,d} = 0$ if the log for day $d$ is missing.\n\n2.  **Adherence Proportion ($A_i$)**: Adherence is defined relative to a daily practice threshold, $\\theta$. A participant is considered \"adherent\" on a given day $d$ if their recorded practice time meets or exceeds this threshold, i.e., $m_{i,d} \\ge \\theta$. Missing days are not counted as adherent. The adherence proportion for participant $i$ is the fraction of days they were adherent over the total scheduled period $N$:\n    $$A_i = \\frac{1}{N} \\sum_{d=1}^{N} \\mathbb{I}(m_{i,d} \\ge \\theta)$$\n    where $\\mathbb{I}(\\cdot)$ is the indicator function, which equals $1$ if the condition is true and $0$ otherwise. The condition is only evaluated for non-missing $m_{i,d}$. The mean adherence for the cohort is the average of individual adherence proportions: $\\bar{A} = \\frac{1}{P} \\sum_{i=1}^{P} A_i$.\n\n3.  **Symptom Change ($Y_i$)**: The outcome variable is the change in symptom score from pre-intervention ($S_{i,\\text{pre}}$) to post-intervention ($S_{i,\\text{post}}$). A positive value indicates symptom improvement.\n    $$Y_i = S_{i,\\text{pre}} - S_{i,\\text{post}}$$\n\nThese calculations yield a set of paired data points $(D_i, Y_i)$ for each participant, which form the basis for the dose-response modeling.\n\n### Step 2: Derivation and Specification of the Dose-Response Model\n\nThe problem requires the derivation of a parametric function $f(D)$ to model the relationship between dose $D$ and symptom change $Y$, subject to a set of specific biophysical constraints:\n1.  **Monotonicity**: The effect cannot decrease with increasing dose.\n2.  **Concavity**: The rate of improvement decreases as the dose increases (diminishing returns).\n3.  **Zero Effect at Zero Dose**: $f(0) = 0$.\n4.  **Finite Saturation**: The effect approaches a maximum, $E_{\\max}$, as the dose becomes very large ($D \\to \\infty$).\n5.  **Characteristic Dose ($EC_{50}$)**: The dose at which half of the maximum effect is achieved, i.e., $f(EC_{50}) = \\frac{1}{2} E_{\\max}$.\n\nA functional form that elegantly satisfies all these properties is the standard hyperbola, commonly known as the Michaelis-Menten or Emax model in pharmacology and enzyme kinetics. We propose the following form for $f(D)$:\n$$f(D; E_{\\max}, EC_{50}) = \\frac{E_{\\max} \\cdot D}{EC_{50} + D}$$\nVerification of properties:\n-   $f(0) = \\frac{E_{\\max} \\cdot 0}{EC_{50} + 0} = 0$. (Property 3 is met)\n-   $\\lim_{D\\to\\infty} f(D) = \\lim_{D\\to\\infty} \\frac{E_{\\max} \\cdot D}{EC_{50} + D} = \\lim_{D\\to\\infty} \\frac{E_{\\max}}{EC_{50}/D + 1} = E_{\\max}$. (Property 4 is met)\n-   $f(EC_{50}) = \\frac{E_{\\max} \\cdot EC_{50}}{EC_{50} + EC_{50}} = \\frac{E_{\\max} \\cdot EC_{50}}{2 \\cdot EC_{50}} = \\frac{1}{2} E_{\\max}$. (Property 5 is met)\n-   The first derivative with respect to $D$ is $f'(D) = \\frac{E_{\\max} \\cdot EC_{50}}{(EC_{50} + D)^2}$. Assuming a therapeutic effect where $E_{\\max} > 0$ and $EC_{50} > 0$, we have $f'(D) > 0$ for all $D \\ge 0$, confirming the function is monotonically increasing. (Property 1 is met)\n-   The second derivative is $f''(D) = -2 \\frac{E_{\\max} \\cdot EC_{50}}{(EC_{50} + D)^3}$. For $D \\ge 0$, $f''(D)  0$, confirming the function is concave. (Property 2 is met)\n\nThis function, $f(D)$, with parameters $E_{\\max}$ and $EC_{50}$, will be fitted to the data.\n\n### Step 3: Model Fitting and Comparison\n\nThe parameters for both the derived dose-response model and the linear comparator model are estimated by minimizing the sum of squared residuals, which is equivalent to maximum likelihood estimation under the assumption of independent and identically distributed Gaussian residuals.\n\n-   **Derived Model**: Find $(\\hat{E}_{\\max}, \\hat{EC}_{50})$ that minimize $\\sum_{i=1}^{P} (Y_i - f(D_i; E_{\\max}, EC_{50}))^2$.\n-   **Linear Model**: The comparator model is $g(D) = \\beta_0 + \\beta_1 D$. We find $(\\hat{\\beta}_0, \\hat{\\beta}_1)$ that minimize $\\sum_{i=1}^{P} (Y_i - (\\beta_0 + \\beta_1 D_i))^2$.\n\nThese minimization problems will be solved numerically using the Levenberg-Marquardt algorithm, as implemented in `scipy.optimize.curve_fit`.\n\nTo compare the models, we compute the coefficient of determination, $R^2$, for each fit. $R^2$ quantifies the proportion of the variance in the dependent variable ($Y_i$) that is predictable from the independent variable ($D_i$).\n\n$$R^2 = 1 - \\frac{SS_{\\text{res}}}{SS_{\\text{tot}}}$$\nwhere:\n-   The total sum of squares is $SS_{\\text{tot}} = \\sum_{i=1}^{P} (Y_i - \\bar{Y})^2$, with $\\bar{Y}$ being the mean of the observed symptom changes.\n-   The residual sum of squares is $SS_{\\text{res}} = \\sum_{i=1}^{P} (Y_i - \\hat{Y}_i)^2$, where $\\hat{Y}_i$ are the model's predicted values ($f(D_i)$ or $g(D_i)$).\n\nWe will compute $R^2_{\\text{Emax}}$ for the derived model and $R^2_{\\text{linear}}$ for the linear model. The final boolean result for each test case is determined by the condition $R^2_{\\text{Emax}} \\ge R^2_{\\text{linear}}$.\n\nThe implementation will process each test case sequentially, performing these calculations and collating the resultsâ€”mean adherence, $\\hat{E}_{\\max}$, $\\hat{EC}_{50}$, and the boolean comparisonâ€”into the specified final output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the dose-response modeling problem for all specified test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"N\": 14, \"theta\": 10,\n            \"minutes\": [\n                [0, 0, 15, 0, 0, 10, 0, 5, 0, 0, 0, 0, 0, 0],\n                [0, 10, 10, 0, 20, 0, 0, 10, 5, 0, 0, 25, 0, 0],\n                [15, 15, 0, 0, 30, 0, 0, 20, 20, 0, 10, 20, 0, 0],\n                [20, 20, 20, 0, 30, 0, 20, 20, 20, 10, 20, 20, 0, 0],\n                [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 0, 0],\n                [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 0]\n            ],\n            \"scores_pre\": [18, 18, 18, 18, 18, 18],\n            \"scores_post\": [16.767, 15.017, 14.0, 13.543, 12.567, 12.464]\n        },\n        {\n            \"N\": 14, \"theta\": 10,\n            \"minutes\": [\n                [None, None, 0, None, 0, None, None, 0, None, None, 0, None, None, None],\n                [None, 0, None, 0, None, 0, None, 0, None, 0, None, 0, None, 0],\n                [None, 0, 10, 0, None, 0, 0, None, 10, 0, None, 0, None, 0],\n                [10, None, 0, 10, None, 0, 10, None, 0, 10, 0, None, 0, None],\n                [None, 15, None, 15, 0, None, 0, 15, None, 0, 15, None, 0, None]\n            ],\n            \"scores_pre\": [17, 16, 20, 15, 19],\n            \"scores_post\": [17.0, 16.1, 18.9, 13.4, 16.7]\n        },\n        {\n            \"N\": 28, \"theta\": 15,\n            \"minutes\": [\n                [20, 20, 0, 0, 20, 0, 20, 0, 0, 20, 0, 0, 20, 0, 20, 0, 0, 0, 20, 0, 0, 0, 20, 0, 0, 0, 20, 0],\n                [20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                [20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 0, 0, 0, 0, 0, 0, 0, 0],\n                [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 0, 0, 0, 0, 0, 0, 0, 0],\n                [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 0, 0, 0, 0, 0, 0, 0, 0]\n            ],\n            \"scores_pre\": [20, 20, 20, 20, 20],\n            \"scores_post\": [15.4, 14.8, 14.0, 13.2, 13.0]\n        }\n    ]\n    \n    # Emax dose-response model\n    def emax_model(D, E_max, EC_50):\n        return (E_max * D) / (EC_50 + D)\n\n    # Linear comparator model\n    def linear_model(D, beta_0, beta_1):\n        return beta_0 + beta_1 * D\n\n    # R-squared calculation\n    def calculate_r_squared(y_true, y_pred):\n        ss_tot = np.sum((y_true - np.mean(y_true))**2)\n        ss_res = np.sum((y_true - y_pred)**2)\n        if ss_tot == 0:\n            return 1.0 if ss_res == 0 else 0.0\n        return 1 - (ss_res / ss_tot)\n\n    all_results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        theta = case[\"theta\"]\n        minutes_data = case[\"minutes\"]\n        scores_pre = np.array(case[\"scores_pre\"])\n        scores_post = np.array(case[\"scores_post\"])\n\n        num_participants = len(minutes_data)\n        doses = np.zeros(num_participants)\n        adherence_proportions = np.zeros(num_participants)\n\n        for i in range(num_participants):\n            participant_minutes = minutes_data[i]\n            total_minutes = 0\n            adherent_days = 0\n            for m in participant_minutes:\n                if m is not None:\n                    total_minutes += m\n                    if m >= theta:\n                        adherent_days += 1\n            doses[i] = total_minutes\n            adherence_proportions[i] = adherent_days / N\n        \n        mean_adherence = np.mean(adherence_proportions)\n        symptom_changes = scores_pre - scores_post\n\n        try:\n            p0_emax = [np.max(symptom_changes), np.median(doses)]\n            params_emax, _ = curve_fit(emax_model, doses, symptom_changes, p0=p0_emax, maxfev=5000)\n            E_max_fit, EC_50_fit = params_emax\n        except RuntimeError:\n            E_max_fit, EC_50_fit = np.nan, np.nan\n\n        try:\n            p0_linear = [0, 1]\n            params_linear, _ = curve_fit(linear_model, doses, symptom_changes, p0=p0_linear)\n            beta0_fit, beta1_fit = params_linear\n        except RuntimeError:\n            beta0_fit, beta1_fit = np.nan, np.nan\n\n        y_pred_emax = emax_model(doses, E_max_fit, EC_50_fit)\n        r2_emax = calculate_r_squared(symptom_changes, y_pred_emax)\n\n        y_pred_linear = linear_model(doses, beta0_fit, beta1_fit)\n        r2_linear = calculate_r_squared(symptom_changes, y_pred_linear)\n        \n        is_emax_better_or_equal = r2_emax >= r2_linear\n\n        result_case = [\n            round(mean_adherence, 3),\n            round(E_max_fit, 3),\n            round(EC_50_fit, 3),\n            is_emax_better_or_equal\n        ]\n        all_results.append(result_case)\n\n    # Format the final output string as a list of lists, with lowercase booleans and no spaces.\n    output_parts = []\n    for res in all_results:\n        # res is [float, float, float, bool]\n        # str(True).lower() -> 'true'\n        part_str = f\"[{res[0]},{res[1]},{res[2]},{str(res[3]).lower()}]\"\n        output_parts.append(part_str)\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "4730080"}]}