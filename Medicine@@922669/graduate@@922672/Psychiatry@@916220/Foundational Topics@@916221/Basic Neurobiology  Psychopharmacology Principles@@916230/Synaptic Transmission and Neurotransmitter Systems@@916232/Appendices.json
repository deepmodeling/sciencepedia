{"hands_on_practices": [{"introduction": "To understand how neurons compute, we must first master the biophysics of ion flow through their channels. This foundational exercise guides you through the derivation of the Nernst potential for chloride ions, the equilibrium point that governs inhibitory currents. By calculating this potential and comparing it to the neuron's resting state, you will determine whether a $\\text{GABA}_\\text{A}$ synapse provides hyperpolarizing or shunting inhibition—a critical distinction that defines its functional impact on neuronal excitability [@problem_id:4764395].", "problem": "An inhibitory postsynaptic conductance mediated by gamma-aminobutyric acid type A ($\\text{GABA}_\\text{A}$) receptors is selectively permeable to chloride ions ($\\text{Cl}^-$). Assume that bicarbonate permeability is negligible and that the extracellular chloride concentration is $[\\text{Cl}^-]_{\\mathrm{o}} = 120\\,\\mathrm{mM}$ and the intracellular chloride concentration is $[\\text{Cl}^-]_{\\mathrm{i}} = 15\\,\\mathrm{mM}$. The bath temperature is $37\\,^{\\circ}\\mathrm{C}$, and the neuron’s membrane potential is $V_{m} = -65\\,\\mathrm{mV}$. \n\nStarting from the equality of electrochemical potentials at equilibrium for a monovalent anion, derive the reversal potential for the $\\text{GABA}_\\text{A}$ current in terms of fundamental constants and the given concentrations. Then, evaluate it numerically at $37\\,^{\\circ}\\mathrm{C}$ using standard physical constants. Using first principles relating membrane current to driving force, determine whether opening this conductance at $V_{m} = -65\\,\\mathrm{mV}$ produces hyperpolarizing inhibition versus shunting inhibition.\n\nAnswer specification:\n- Report the reversal potential in $\\mathrm{mV}$, rounded to four significant figures.\n- Encode the qualitative classification as $1$ for hyperpolarizing inhibition and $0$ for shunting inhibition.\n- Provide your final answer as a row vector with two entries, where the first entry is the reversal potential (in $\\mathrm{mV}$, number only) and the second entry is the inhibition code ($1$ or $0$). Do not include units in the final boxed answer.", "solution": "The reversal potential of an ion-selective conductance equals the membrane potential $V$ at which the net current through that conductance is zero. For a channel selective to a single ionic species with valence $z$, that condition corresponds to electrochemical equilibrium, where the electrochemical potentials inside and outside are equal. The electrochemical potential $\\mu$ of an ion is given by\n$$\n\\mu = \\mu^{0} + RT \\ln a + z F \\psi,\n$$\nwhere $\\mu^{0}$ is a standard chemical potential, $R$ is the universal gas constant, $T$ is absolute temperature, $a$ is the activity (approximated by concentration for dilute solutions), $z$ is the valence, $F$ is the Faraday constant, and $\\psi$ is the electric potential.\n\nAt equilibrium for chloride ($z=-1$), the inside and outside electrochemical potentials are equal:\n$$\n\\mu^{0} + RT \\ln [\\text{Cl}^-]_{\\mathrm{i}} - F \\psi_{\\mathrm{i}} \\;=\\; \\mu^{0} + RT \\ln [\\text{Cl}^-]_{\\mathrm{o}} - F \\psi_{\\mathrm{o}}.\n$$\nCanceling $\\mu^{0}$ and rearranging gives\n$$\nRT \\ln \\frac{[\\text{Cl}^-]_{\\mathrm{i}}}{[\\text{Cl}^-]_{\\mathrm{o}}} \\;=\\; F(\\psi_{\\mathrm{i}} - \\psi_{\\mathrm{o}}).\n$$\nIdentifying the membrane potential as $V = \\psi_{\\mathrm{i}} - \\psi_{\\mathrm{o}}$, the chloride reversal potential $E_{\\text{Cl}}$ is\n$$\nE_{\\text{Cl}} \\;=\\; \\frac{RT}{F} \\ln \\frac{[\\text{Cl}^-]_{\\mathrm{i}}}{[\\text{Cl}^-]_{\\mathrm{o}}}.\n$$\nThis expression is equivalent to $E_{\\text{Cl}} = \\frac{RT}{zF} \\ln \\frac{[\\text{Cl}^-]_{\\mathrm{o}}}{[\\text{Cl}^-]_{\\mathrm{i}}}$ with $z=-1$.\n\nNext, evaluate at $T = 37\\,^{\\circ}\\mathrm{C} = 310.15\\,\\mathrm{K}$, with $R$ and $F$ kept symbolic until substitution. Define the concentration ratio\n$$\n\\frac{[\\text{Cl}^-]_{\\mathrm{i}}}{[\\text{Cl}^-]_{\\mathrm{o}}} \\;=\\; \\frac{15}{120} \\;=\\; \\frac{1}{8}.\n$$\nTherefore,\n$$\nE_{\\text{Cl}} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{1}{8}\\right) \\;=\\; -\\,\\frac{RT}{F} \\ln 8.\n$$\nSubstitute $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $T = 310.15\\,\\mathrm{K}$, and $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$:\n$$\n\\frac{RT}{F} \\;\\approx\\; \\frac{(8.314462618)(310.15)}{96485.33212}\\,\\mathrm{V} \\;\\approx\\; 0.02674\\,\\mathrm{V}.\n$$\nCompute $\\ln 8 \\approx 2.07944$, hence\n$$\nE_{\\text{Cl}} \\;\\approx\\; -\\,(0.02674)\\,(2.07944)\\,\\mathrm{V} \\;\\approx\\; -0.0556\\,\\mathrm{V} \\;=\\; -55.6\\,\\mathrm{mV}.\n$$\nRounded to four significant figures, $E_{\\text{Cl}} \\approx -55.60\\,\\mathrm{mV}$.\n\nTo classify the inhibitory effect at $V_{m} = -65\\,\\mathrm{mV}$, use the relation between current and driving force for a conductance $g$:\n$$\nI \\;=\\; g \\,(V_{m} - E_{\\mathrm{rev}}).\n$$\nOpening a chloride conductance drives $V_{m}$ toward $E_{\\text{Cl}}$. If $E_{\\text{Cl}}  V_{m}$ (more negative than $V_{m}$), activation hyperpolarizes the membrane. If $E_{\\text{Cl}}  V_{m}$ (less negative), activation depolarizes but still increases membrane conductance, producing shunting inhibition. Here,\n$$\nE_{\\text{Cl}} \\approx -55.60\\,\\mathrm{mV} \\;\\; V_{m} = -65\\,\\mathrm{mV},\n$$\nso opening $\\text{GABA}_\\text{A}$ channels at rest will depolarize toward $-55.60\\,\\mathrm{mV}$ rather than hyperpolarize. The inhibitory effect is therefore shunting. According to the encoding rule ($1$ for hyperpolarizing, $0$ for shunting), the code is $0$.\n\nThus the requested outputs are the reversal potential in $\\mathrm{mV}$ and the inhibition code as a row vector.", "answer": "$$\\boxed{\\begin{pmatrix}-55.60  0\\end{pmatrix}}$$", "id": "4764395"}, {"introduction": "A neuron is not a simple switch; it is a sophisticated integrator of countless excitatory and inhibitory signals. This practice elevates our analysis from a single ion channel to a whole-neuron model, investigating how shunting inhibition powerfully modulates the integration process. By deriving how a shunting conductance alters the amplitude of an excitatory postsynaptic potential (EPSP), you will gain a rigorous, quantitative understanding of how inhibition can perform divisive normalization—a key computational function in neural circuits [@problem_id:4764446].", "problem": "Consider a single-compartment neuron used to model cortical synaptic integration in psychiatry-relevant circuits. The membrane is passive and obeys conservation of charge with ohmic membrane and synaptic currents. At baseline, the neuron has a leak conductance $g_{L}$ with reversal potential $E_{L}$ and membrane capacitance $C$. Excitatory synaptic activation (for example, via $\\alpha$-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid receptors) is modeled as a conductance step of amplitude $g_{E}$ with reversal potential $E_{E}$. A tonic inhibitory conductance (for example, via gamma-aminobutyric acid type A ($\\text{GABA}_\\text{A}$) receptors) is present with amplitude $g_{I}$ and reversal potential $E_{I}$. Assume that the inhibitory reversal equals the leak reversal, that is $E_{I}=E_{L}$, so that inhibition is shunting.\n\nStarting only from the following core facts: (i) each conductance contributes an ohmic current of the form $I_{x}=g_{x}\\left(V-E_{x}\\right)$, (ii) charge conservation requires that the sum of capacitive and ohmic currents equals zero, and (iii) steady-state is defined by $dV/dt=0$, perform the following:\n\n1. Derive the effective membrane resistance in the absence of excitatory activation but in the presence of tonic shunting inhibition, and use this to explain whether the resting membrane potential changes when $g_{I}$ is added with $E_{I}=E_{L}$.\n2. Derive from first principles the steady-state amplitude of the excitatory postsynaptic potential (EPSP) produced by the conductance step $g_{E}$ both without inhibition and with tonic shunting inhibition.\n3. Demonstrate how shunting inhibition alters linear synaptic summation by considering two simultaneous excitatory conductance steps $g_{E1}$ and $g_{E2}$ with the same reversal potential $E_{E}$; argue how the combined steady-state depolarization is affected relative to the no-inhibition case.\n4. Define the multiplicative reduction factor $r_{\\text{shunt}}$ as the ratio of the steady-state EPSP amplitude with shunting inhibition to that without inhibition for a single excitatory conductance step $g_{E}$. Provide $r_{\\text{shunt}}$ as a closed-form analytic expression in terms of $g_{L}$, $g_{E}$, and $g_{I}$.\n\nYour final answer must be the exact expression for $r_{\\text{shunt}}$. No numerical evaluation is required. Express the final answer as a dimensionless expression. Do not include any units. No rounding is required.", "solution": "The problem statement is found to be valid. It is scientifically grounded in the principles of biophysics and computational neuroscience, specifically using the standard single-compartment passive membrane model. The problem is well-posed, objective, and contains all necessary information to derive the requested quantities without ambiguity or contradiction.\n\nWe begin from the principle of charge conservation for a single-compartment neuron, as stipulated by core fact (ii). The total current flowing out of the compartment must be zero. This current is the sum of the capacitive current and the various ohmic ionic currents. The general equation is:\n$$C \\frac{dV}{dt} + \\sum_{x} I_{x} = 0$$\nwhere $C$ is the membrane capacitance, $V$ is the membrane potential, and $I_x$ are the individual ionic currents. Using core fact (i), each ohmic current is of the form $I_{x} = g_{x}(V - E_{x})$, where $g_x$ is the conductance and $E_x$ is the reversal potential for ion species or channel type $x$. For the system described, this equation becomes:\n$$C \\frac{dV}{dt} + I_{L} + I_{I} + I_{E} = 0$$\n$$C \\frac{dV}{dt} + g_{L}(V - E_{L}) + g_{I}(V - E_{I}) + g_{E}(V - E_{E}) = 0$$\n\n1. To derive the effective membrane resistance and its effect on the resting potential in the presence of tonic shunting inhibition, we consider the case without excitatory activation, so $g_{E}=0$. The problem states that the inhibition is shunting, which is defined by the condition $E_{I} = E_{L}$. Substituting these into the general equation gives:\n$$C \\frac{dV}{dt} + g_{L}(V - E_{L}) + g_{I}(V - E_{L}) = 0$$\nCombining the terms with the common factor $(V - E_{L})$ yields:\n$$C \\frac{dV}{dt} + (g_{L} + g_{I})(V - E_{L}) = 0$$\nThis is a first-order linear ordinary differential equation for $V(t)$. The form of this equation shows that the total membrane conductance in this state is $g_{\\text{total}} = g_{L} + g_{I}$. The effective membrane resistance, $R_{\\text{eff}}$, is the inverse of the total conductance:\n$$R_{\\text{eff}} = \\frac{1}{g_{\\text{total}}} = \\frac{1}{g_{L} + g_{I}}$$\nTo find the resting membrane potential, $V_{\\text{rest}}$, we apply the steady-state condition from core fact (iii), which is $\\frac{dV}{dt} = 0$.\n$$(g_{L} + g_{I})(V_{\\text{rest}} - E_{L}) = 0$$\nSince the conductances $g_{L}$ and $g_{I}$ are non-negative and $g_L$ is implicitly positive for a physically realistic cell, their sum is positive. Therefore, the only way for the equation to hold is if $V_{\\text{rest}} - E_{L} = 0$, which means $V_{\\text{rest}} = E_{L}$. In the absence of any inhibition ($g_I=0$), the resting potential would also be $E_{L}$. Thus, adding a tonic shunting inhibitory conductance ($E_{I} = E_{L}$) does not change the value of the resting membrane potential. However, it does decrease the effective membrane resistance from $\\frac{1}{g_L}$ to $\\frac{1}{g_L+g_I}$, making the membrane \"leakier\".\n\n2. We now derive the steady-state amplitude of the excitatory postsynaptic potential ($\\Delta V_{\\text{EPSP}}$) produced by a conductance step $g_{E}$. The EPSP amplitude is the difference between the steady-state potential with excitatory input, $V_{\\text{ss}}$, and the resting potential, $V_{\\text{rest}} = E_{L}$. So, $\\Delta V_{\\text{EPSP}} = V_{\\text{ss}} - E_{L}$.\n\nCase A: Without inhibition ($g_{I} = 0$).\nAt steady-state ($\\frac{dV}{dt}=0$) with $g_E0$:\n$$g_{L}(V_{\\text{ss, no-I}} - E_{L}) + g_{E}(V_{\\text{ss, no-I}} - E_{E}) = 0$$\nSolving for $V_{\\text{ss, no-I}}$:\n$$V_{\\text{ss, no-I}}(g_{L} + g_{E}) = g_{L}E_{L} + g_{E}E_{E}$$\n$$V_{\\text{ss, no-I}} = \\frac{g_{L}E_{L} + g_{E}E_{E}}{g_{L} + g_{E}}$$\nThe EPSP amplitude is:\n$$\\Delta V_{\\text{no-I}} = V_{\\text{ss, no-I}} - E_{L} = \\frac{g_{L}E_{L} + g_{E}E_{E}}{g_{L} + g_{E}} - E_{L} = \\frac{g_{L}E_{L} + g_{E}E_{E} - E_{L}(g_{L} + g_{E})}{g_{L} + g_{E}} = \\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{E}}$$\n\nCase B: With tonic shunting inhibition ($g_{I}  0$, $E_{I} = E_{L}$).\nAt steady-state ($\\frac{dV}{dt}=0$) with $g_E0$ and $g_I0$:\n$$g_{L}(V_{\\text{ss, shunt}} - E_{L}) + g_{I}(V_{\\text{ss, shunt}} - E_{L}) + g_{E}(V_{\\text{ss, shunt}} - E_{E}) = 0$$\n$$(g_{L} + g_{I})(V_{\\text{ss, shunt}} - E_{L}) + g_{E}(V_{\\text{ss, shunt}} - E_{E}) = 0$$\nSolving for $V_{\\text{ss, shunt}}$:\n$$V_{\\text{ss, shunt}}(g_{L} + g_{I} + g_{E}) = (g_{L} + g_{I})E_{L} + g_{E}E_{E}$$\n$$V_{\\text{ss, shunt}} = \\frac{(g_{L} + g_{I})E_{L} + g_{E}E_{E}}{g_{L} + g_{I} + g_{E}}$$\nThe EPSP amplitude is:\n$$\\Delta V_{\\text{shunt}} = V_{\\text{ss, shunt}} - E_{L} = \\frac{(g_{L} + g_{I})E_{L} + g_{E}E_{E}}{g_{L} + g_{I} + g_{E}} - E_{L} = \\frac{(g_{L} + g_{I})E_{L} + g_{E}E_{E} - E_{L}(g_{L} + g_{I} + g_{E})}{g_{L} + g_{I} + g_{E}} = \\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{I} + g_{E}}$$\n\n3. To demonstrate how shunting inhibition alters linear synaptic summation, we consider two simultaneous excitatory inputs, $g_{E1}$ and $g_{E2}$. The combined depolarization is calculated by replacing $g_E$ with $g_{E1} + g_{E2}$ in the formulas from part 2.\nWithout inhibition, the combined depolarization is:\n$$\\Delta V_{\\text{combo, no-I}} = \\frac{(g_{E1} + g_{E2})(E_{E} - E_{L})}{g_{L} + g_{E1} + g_{E2}}$$\nWith shunting inhibition, the combined depolarization is:\n$$\\Delta V_{\\text{combo, shunt}} = \\frac{(g_{E1} + g_{E2})(E_{E} - E_{L})}{g_{L} + g_{I} + g_{E1} + g_{E2}}$$\nThe denominator in the shunting case is strictly larger than in the no-inhibition case (for $g_I  0$). Therefore, $\\Delta V_{\\text{combo, shunt}}  \\Delta V_{\\text{combo, no-I}}$. Shunting inhibition reduces the depolarization produced by the sum of excitatory inputs.\n\nMore subtly, shunting inhibition alters the linearity of summation. Synaptic summation is inherently sublinear because each active synaptic conductance increases the total membrane conductance (the denominator), thereby reducing the voltage change produced by any other concurrently active synapse. The combined steady-state depolarization $\\Delta V(g_{E1}+g_{E2})$ is less than the arithmetic sum of the individual depolarizations $\\Delta V(g_{E1}) + \\Delta V(g_{E2})$. Shunting inhibition introduces a large, tonic conductance $g_I$ that is present regardless of synaptic activity. This \"pre-shunts\" the membrane. The total conductance during synaptic activity is $g_L + g_I + g_{E1} + g_{E2}$. Because $g_I$ adds a large constant value to the denominator, the *relative* change in total conductance caused by the synaptic inputs ($g_{E1}$, $g_{E2}$) is smaller than in the no-inhibition case. This reduction in the relative impact of synaptic conductances on the overall denominator makes the summation more linear (i.e., closer to arithmetic summation, although the absolute magnitude of the response is reduced).\n\n4. Finally, we define the multiplicative reduction factor $r_{\\text{shunt}}$ as the ratio of the steady-state EPSP amplitude with shunting inhibition to that without it, for a single excitatory conductance step $g_E$.\n$$r_{\\text{shunt}} = \\frac{\\Delta V_{\\text{shunt}}}{\\Delta V_{\\text{no-I}}}$$\nUsing the results from part 2:\n$$\\Delta V_{\\text{shunt}} = \\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{I} + g_{E}}$$\n$$\\Delta V_{\\text{no-I}} = \\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{E}}$$\nWe form the ratio:\n$$r_{\\text{shunt}} = \\frac{\\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{I} + g_{E}}}{\\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{E}}}$$\nAssuming $g_{E}  0$ and $E_{E} \\neq E_{L}$, the term $g_{E}(E_{E} - E_{L})$ cancels in the numerator and denominator:\n$$r_{\\text{shunt}} = \\frac{1 / (g_{L} + g_{I} + g_{E})}{1 / (g_{L} + g_{E})}$$\nSimplifying this complex fraction gives the final expression:\n$$r_{\\text{shunt}} = \\frac{g_{L} + g_{E}}{g_{L} + g_{I} + g_{E}}$$\nThis expression is dimensionless, as it is a ratio of conductances. It is always less than $1$ for $g_I  0$, quantifying the divisive or multiplicative nature of shunting inhibition on synaptic efficacy.", "answer": "$$\\boxed{\\frac{g_{L} + g_{E}}{g_{L} + g_{I} + g_{E}}}$$", "id": "4764446"}, {"introduction": "The ultimate goal of systems neuroscience is to link molecular mechanisms to network function and behavior. This final practice bridges this gap by scaling up our analysis to a recurrent excitatory-inhibitory network, a cornerstone model for cortical computation. You will derive the network's steady-state response and then use this model to computationally explore how N-Methyl-D-Aspartate (NMDA) receptor hypofunction—a leading hypothesis in schizophrenia—alters a simulated biomarker analogous to mismatch negativity (MMN), directly connecting a synaptic parameter to a system-level psychiatric correlate [@problem_id:4764412].", "problem": "You are tasked with computing the expected change in mismatch negativity amplitude when N-Methyl-D-Aspartate (NMDA) conductance is reduced by a fraction $p$, within a simplified cortical network model composed of recurrent excitation and inhibition. Mismatch negativity is treated here as a low-frequency event-related potential component that scales with the steady-state pyramidal cell population response to a deviant stimulus relative to a standard stimulus. The network is represented by two interacting populations: an excitatory (pyramidal) population with activity $r_E$ and an inhibitory (interneuron) population with activity $r_I$. The network operates under a linear, steady-state approximation of a rate model. The relationship between external input and population activity is governed by the following foundational elements:\n\n- The excitatory population receives external drive $u$ representing the deviant-minus-standard difference in input. The mismatch negativity amplitude $A$ is related to the excitatory population activity by $A = k_{\\mathrm{LFP}} \\, r_E$, where $k_{\\mathrm{LFP}}$ is a conversion factor expressed in microvolts per unit rate.\n- The NMDA-mediated component of recurrent excitation contributes a fraction $\\rho$ to the effective recurrent excitatory weight. A reduction in NMDA conductance by a decimal fraction $p$ reduces the effective excitatory recurrent weight $w_{EE}$ according to $w_{EE}' = w_{EE}^{(0)} \\, \\big( 1 - p \\rho \\big)$, where $w_{EE}^{(0)}$ is the baseline excitatory recurrent weight.\n- The inhibitory and excitatory populations interact via weights $w_{EI}$ (inhibitory projection onto excitatory population), $w_{IE}$ (excitatory projection onto inhibitory population), and $w_{II}$ (inhibitory self-coupling). The gains of the population transfer functions at the operating point are $\\alpha_E$ and $\\alpha_I$ for excitatory and inhibitory populations, respectively.\n\nStarting from the linear, steady-state approximation and the above definitions, derive the steady-state excitatory response $r_E$ to an external input $u$ in terms of the parameters $\\alpha_E$, $\\alpha_I$, $w_{EE}$, $w_{EI}$, $w_{IE}$, and $w_{II}$. Then compute the baseline mismatch negativity amplitude $A_0$ using $w_{EE}^{(0)}$ and the post-reduction amplitude $A_1$ using $w_{EE}'$. Report both the absolute change $\\Delta A = A_1 - A_0$ (in microvolts) and the fractional change $\\delta = \\frac{A_1 - A_0}{A_0}$ (as a decimal). If $A_0 = 0$, define $\\delta = 0$.\n\nAll physical amplitude values must be expressed in microvolts, and fractional changes must be decimals (no percentage signs). Your program must implement the derived relationships without relying on any pre-specified shortcut formulas beyond the foundational definitions stated above.\n\nUse the following test suite of parameter sets, where every numeric value is given in the appropriate units or is dimensionless as specified. For each test case, $p = 0.30$ is the NMDA conductance reduction decimal fraction.\n\n- Test case $1$ (typical operating regime):\n  - $\\alpha_E = 0.50$, $\\alpha_I = 0.40$\n  - $w_{EE}^{(0)} = 0.60$, $w_{EI} = 0.50$, $w_{IE} = 0.70$, $w_{II} = 0.40$\n  - $\\rho = 0.60$\n  - $u = 1.00$ (dimensionless input difference)\n  - $k_{\\mathrm{LFP}} = 5.00$ microvolts per unit rate\n\n- Test case $2$ (high NMDA fraction, stronger inhibition):\n  - $\\alpha_E = 0.60$, $\\alpha_I = 0.60$\n  - $w_{EE}^{(0)} = 0.50$, $w_{EI} = 0.90$, $w_{IE} = 1.00$, $w_{II} = 0.50$\n  - $\\rho = 0.90$\n  - $u = 0.70$ (dimensionless input difference)\n  - $k_{\\mathrm{LFP}} = 6.00$ microvolts per unit rate\n\n- Test case $3$ (no NMDA contribution, sanity check):\n  - $\\alpha_E = 0.55$, $\\alpha_I = 0.45$\n  - $w_{EE}^{(0)} = 0.70$, $w_{EI} = 0.60$, $w_{IE} = 0.60$, $w_{II} = 0.50$\n  - $\\rho = 0.00$\n  - $u = 1.20$ (dimensionless input difference)\n  - $k_{\\mathrm{LFP}} = 4.00$ microvolts per unit rate\n\n- Test case $4$ (near boundary of high recurrence, stability preserved):\n  - $\\alpha_E = 0.90$, $\\alpha_I = 0.30$\n  - $w_{EE}^{(0)} = 0.90$, $w_{EI} = 0.80$, $w_{IE} = 0.80$, $w_{II} = 0.10$\n  - $\\rho = 0.70$\n  - $u = 0.80$ (dimensionless input difference)\n  - $k_{\\mathrm{LFP}} = 2.00$ microvolts per unit rate\n\n- Test case $5$ (zero deviant input, boundary case for fractional change definition):\n  - $\\alpha_E = 0.50$, $\\alpha_I = 0.50$\n  - $w_{EE}^{(0)} = 0.60$, $w_{EI} = 0.70$, $w_{IE} = 0.70$, $w_{II} = 0.60$\n  - $\\rho = 0.50$\n  - $u = 0.00$ (dimensionless input difference)\n  - $k_{\\mathrm{LFP}} = 5.00$ microvolts per unit rate\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result represented as a two-element list $[\\Delta A, \\delta]$. Each numeric value must be rounded to exactly six decimal places. For example, the output format must be of the form $[[x_1,y_1],[x_2,y_2],\\dots]$, where all $x_i$ are in microvolts and all $y_i$ are decimals.", "solution": "The central task is to determine the absolute and fractional change in mismatch negativity (MMN) amplitude, denoted $\\Delta A$ and $\\delta$ respectively, following a pharmacologically-induced reduction in NMDA receptor conductance. The MMN amplitude $A$ is modeled as being directly proportional to the steady-state firing rate $r_E$ of an excitatory (pyramidal) cell population, $A = k_{\\mathrm{LFP}} r_E$. We must first derive an analytical expression for $r_E$ from the provided linear, steady-state rate model of a cortical microcircuit.\n\n**1. Formulation of the Network Model**\n\nThe network consists of an excitatory population with activity $r_E$ and an inhibitory population with activity $r_I$. Their activities at steady-state are described by a system of two linear equations. The activity of a population is its gain ($\\alpha_E$ or $\\alpha_I$) multiplied by the total input it receives.\n\nThe total input to the excitatory population consists of recurrent excitation ($w_{EE}r_E$), recurrent inhibition ($-w_{EI}r_I$), and an external stimulus ($u$). The steady-state equation for the excitatory population is:\n$$r_E = \\alpha_E (w_{EE} r_E - w_{EI} r_I + u) \\quad (1)$$\n\nThe total input to the inhibitory population consists of excitation from the pyramidal cells ($w_{IE}r_E$) and self-inhibition ($-w_{II}r_I$). It receives no direct external stimulus. The steady-state equation for the inhibitory population is:\n$$r_I = \\alpha_I (w_{IE} r_E - w_{II} r_I) \\quad (2)$$\nIn these equations, all recurrent weights ($w_{EE}$, $w_{EI}$, $w_{IE}$, $w_{II}$) are defined as positive-valued scalars.\n\n**2. Derivation of the Steady-State Excitatory Response ($r_E$)**\n\nTo find the response $r_E$ to the input $u$, we must solve this system of two linear equations. First, we rearrange the equations to group the variables $r_E$ and $r_I$:\n\nFrom equation $(1)$:\n$$r_E - \\alpha_E w_{EE} r_E + \\alpha_E w_{EI} r_I = \\alpha_E u$$\n$$(1 - \\alpha_E w_{EE}) r_E + (\\alpha_E w_{EI}) r_I = \\alpha_E u \\quad (3)$$\n\nFrom equation $(2)$:\n$$r_I - \\alpha_I w_{IE} r_E + \\alpha_I w_{II} r_I = 0$$\n$$(-\\alpha_I w_{IE}) r_E + (1 + \\alpha_I w_{II}) r_I = 0 \\quad (4)$$\n\nThis system can be expressed in matrix form $\\mathbf{M} \\mathbf{r} = \\mathbf{b}$:\n$$\n\\begin{pmatrix} 1 - \\alpha_E w_{EE}  \\alpha_E w_{EI} \\\\ -\\alpha_I w_{IE}  1 + \\alpha_I w_{II} \\end{pmatrix}\n\\begin{pmatrix} r_E \\\\ r_I \\end{pmatrix}\n=\n\\begin{pmatrix} \\alpha_E u \\\\ 0 \\end{pmatrix}\n$$\n\nWe can solve for $r_E$ using Cramer's rule. The solution for $r_E$ is the ratio of two determinants:\n$$r_E = \\frac{\\det \\begin{pmatrix} \\alpha_E u  \\alpha_E w_{EI} \\\\ 0  1 + \\alpha_I w_{II} \\end{pmatrix}}{\\det \\begin{pmatrix} 1 - \\alpha_E w_{EE}  \\alpha_E w_{EI} \\\\ -\\alpha_I w_{IE}  1 + \\alpha_I w_{II} \\end{pmatrix}}$$\n\nThe determinant of the numerator matrix is:\n$$\\det(\\mathbf{M}_{\\text{num}}) = (\\alpha_E u)(1 + \\alpha_I w_{II}) - (\\alpha_E w_{EI})(0) = \\alpha_E u (1 + \\alpha_I w_{II})$$\n\nThe determinant of the denominator matrix (the system matrix $\\mathbf{M}$) is:\n$$\\det(\\mathbf{M}) = (1 - \\alpha_E w_{EE})(1 + \\alpha_I w_{II}) - (\\alpha_E w_{EI})(-\\alpha_I w_{IE})$$\n$$\\det(\\mathbf{M}) = (1 - \\alpha_E w_{EE})(1 + \\alpha_I w_{II}) + \\alpha_E \\alpha_I w_{EI} w_{IE}$$\nFor the network to be stable and produce a finite response, this determinant must be positive. This holds for all parameter sets provided.\n\nCombining these results, we obtain the analytical expression for the steady-state excitatory firing rate:\n$$r_E(w_{EE}) = \\frac{\\alpha_E u (1 + \\alpha_I w_{II})}{(1 - \\alpha_E w_{EE})(1 + \\alpha_I w_{II}) + \\alpha_E \\alpha_I w_{EI} w_{IE}}$$\nThis function explicitly shows the dependence of the response on the excitatory recurrent weight $w_{EE}$.\n\n**3. Computational Algorithm**\n\nThe procedure to compute the required quantities for each test case is as follows:\n\n1.  **Define Baseline and Perturbed States:** The baseline state is defined by the initial excitatory self-coupling weight, $w_{EE}^{(0)}$. The perturbed state corresponds to a reduction in NMDA conductance by a fraction $p$, which reduces the excitatory self-coupling weight to a new value, $w'_{EE}$.\n\n2.  **Calculate Baseline Response and Amplitude:**\n    The baseline excitatory response, $r_{E,0}$, is computed using the derived formula with $w_{EE} = w_{EE}^{(0)}$:\n    $$r_{E,0} = r_E(w_{EE}^{(0)})$$\n    The baseline MMN amplitude is then:\n    $$A_0 = k_{\\mathrm{LFP}} \\, r_{E,0}$$\n\n3.  **Calculate Perturbed Weight:**\n    The effective excitatory recurrent weight after NMDA conductance reduction is given by:\n    $$w'_{EE} = w_{EE}^{(0)} (1 - p \\rho)$$\n    where $p=0.30$ and $\\rho$ is the fraction of the recurrent connection mediated by NMDA receptors.\n\n4.  **Calculate Post-Reduction Response and Amplitude:**\n    The post-reduction excitatory response, $r_{E,1}$, is computed using the derived formula with $w_{EE} = w'_{EE}$:\n    $$r_{E,1} = r_E(w'_{EE})$$\n    The post-reduction MMN amplitude is:\n    $$A_1 = k_{\\mathrm{LFP}} \\, r_{E,1}$$\n\n5.  **Compute Change Metrics:**\n    The absolute change in amplitude is the difference between the post-reduction and baseline amplitudes:\n    $$\\Delta A = A_1 - A_0$$\n    The fractional change in amplitude is the absolute change normalized by the baseline amplitude:\n    $$\\delta = \\frac{\\Delta A}{A_0} = \\frac{A_1 - A_0}{A_0}$$\n    A special condition is defined for the case where the baseline amplitude is zero: if $A_0 = 0$, then $\\delta = 0$. This occurs when the differential input $u=0$, as seen in Test Case $5$.\n\nThis algorithm is implemented in the provided Python code. A function encapsulates the calculation of $r_E$, which is then called for both the baseline ($w_{EE}^{(0)}$) and perturbed ($w'_{EE}$) weight values to find $A_0$ and $A_1$, from which $\\Delta A$ and $\\delta$ are derived. The final results are rounded and formatted to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected change in mismatch negativity amplitude based on a \n    simplified cortical network model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (alpha_E, alpha_I, w_EE_0, w_EI, w_IE, w_II, rho, u, k_LFP)\n    test_cases = [\n        (0.50, 0.40, 0.60, 0.50, 0.70, 0.40, 0.60, 1.00, 5.00), # Test case 1\n        (0.60, 0.60, 0.50, 0.90, 1.00, 0.50, 0.90, 0.70, 6.00), # Test case 2\n        (0.55, 0.45, 0.70, 0.60, 0.60, 0.50, 0.00, 1.20, 4.00), # Test case 3\n        (0.90, 0.30, 0.90, 0.80, 0.80, 0.10, 0.70, 0.80, 2.00), # Test case 4\n        (0.50, 0.50, 0.60, 0.70, 0.70, 0.60, 0.50, 0.00, 5.00), # Test case 5\n    ]\n    \n    p = 0.30 # NMDA conductance reduction decimal fraction\n    results = []\n\n    def calculate_r_E(params, w_EE):\n        \"\"\"\n        Calculates the steady-state excitatory response r_E.\n        \n        Args:\n            params (tuple): A tuple containing the network parameters.\n            w_EE (float): The effective excitatory recurrent weight.\n            \n        Returns:\n            float: The steady-state excitatory firing rate.\n        \"\"\"\n        alpha_E, alpha_I, _, w_EI, w_IE, w_II, _, u, _ = params\n        \n        if u == 0.0:\n            return 0.0\n\n        numerator = alpha_E * u * (1.0 + alpha_I * w_II)\n        \n        denominator = (1.0 - alpha_E * w_EE) * (1.0 + alpha_I * w_II) + alpha_E * alpha_I * w_EI * w_IE\n        \n        # A non-positive denominator implies network instability, but problem parameters avoid this.\n        if denominator = 0:\n            return np.inf\n\n        return numerator / denominator\n\n    for case in test_cases:\n        alpha_E, alpha_I, w_EE_0, w_EI, w_IE, w_II, rho, u, k_LFP = case\n        \n        # 1. Baseline calculation\n        r_E0 = calculate_r_E(case, w_EE_0)\n        A_0 = k_LFP * r_E0\n        \n        # 2. Post-reduction calculation\n        w_EE_prime = w_EE_0 * (1.0 - p * rho)\n        r_E1 = calculate_r_E(case, w_EE_prime)\n        A_1 = k_LFP * r_E1\n        \n        # 3. Compute absolute and fractional changes\n        delta_A = A_1 - A_0\n        \n        if A_0 == 0.0:\n            delta_frac = 0.0\n        else:\n            delta_frac = delta_A / A_0\n            \n        results.append((delta_A, delta_frac))\n\n    # Final print statement in the exact required format.\n    # Each value is formatted to six decimal places.\n    output_str = f\"[{','.join(f'[{res[0]:.6f},{res[1]:.6f}]' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "4764412"}]}