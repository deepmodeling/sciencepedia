{"hands_on_practices": [{"introduction": "The primary goal of an oncolytic virus is to self-replicate within a tumor, destroying cancer cells in the process. To quantify the potential for a virus to successfully establish an infection and spread, we can adapt a fundamental concept from epidemiology: the basic reproduction number, $R_0$. This exercise [@problem_id:5037701] guides you through a first-principles derivation of the tumor-specific basic reproduction number, $R_{0,\\mathrm{tumor}}$, helping to reveal which parameters most critically govern viral fitness in the tumor microenvironment.", "problem": "In the early-invasion phase of an Oncolytic Virus Therapy where an oncolytic virus is applied to a spatially well-mixed tumor, consider the following mechanistic scenario grounded in standard viral dynamics and mass-action contact assumptions. A single infected tumor cell undergoes lysis at an exponentially distributed time with rate $\\delta$. At the moment of lysis, it releases exactly $p$ infectious virions into the extracellular space. Each free virion behaves independently and is subject to two mutually exclusive, memoryless hazards: (i) physical or innate immune clearance at rate $c$, and (ii) successful infection of a susceptible tumor cell at rate $\\beta$. Upon a successful infection event, one new infected tumor cell is created and the infecting virion is consumed. Assume the susceptible tumor cell pool is effectively constant at this early-invasion stage so that the per-virion infection hazard is the constant $\\beta$ (that is, any explicit target-cell abundance factor has been absorbed into $\\beta$). Neglect any additional processes not listed (for example, no continuous virion production prior to lysis, and no loss processes other than those specified).\n\nStarting only from the above fundamental, well-tested premises—exponential waiting times, mass-action contact leading to linear per-virion infection hazard, and independence across virions—derive a closed-form analytic expression for the tumor-specific basic reproduction number $R_{0,\\mathrm{tumor}}$ (the expected number of secondary infected tumor cells caused by a single initially infected tumor cell in an otherwise susceptible tumor) in terms of $\\beta$, $p$, $c$, and $\\delta$. Express your final answer as a dimensionless analytic expression. No numerical approximation is required.", "solution": "The problem is assessed to be scientifically grounded, well-posed, objective, and internally consistent. It represents a standard problem in mathematical virology. Therefore, a solution can be derived.\n\nThe problem asks for the derivation of the basic reproduction number, $R_{0,\\mathrm{tumor}}$, which is defined as the expected number of secondary infected tumor cells produced by a single initially infected tumor cell in a fully susceptible population. We can calculate this value by decomposing the infection life cycle into its constituent steps and applying the principles of probability and expectation.\n\nThe overall process is:\n$1$. An infected cell lyses, releasing virions.\n$2$. These virions then attempt to infect new susceptible cells.\n\nLet us express $R_{0,\\mathrm{tumor}}$ as the product of two quantities:\n$$R_{0,\\mathrm{tumor}} = (\\text{Expected number of virions released per infected cell}) \\times (\\text{Probability that a single virion causes a new infection})$$\n\nFirst, we determine the expected number of virions released. The problem states that a single infected cell undergoes lysis at a rate $\\delta$. Importantly, it specifies that this is the only process the infected cell is subject to; there are no other competing events, such as clearance of the infected cell itself before it can lyse. Therefore, the lysis of the infected cell is a certain event, with a probability of $1$. The rate $\\delta$ determines the waiting time for this event (which is exponentially distributed with mean $1/\\delta$), but it does not affect the certainty of its occurrence. Upon lysis, the cell releases exactly $p$ virions. Thus, the expected number of virions released by a single infected cell over its entire lifetime is exactly $p$.\n\nSecond, we determine the probability that a single one of these released virions successfully causes a secondary infection. Upon release, each virion is subject to two independent, mutually exclusive, memoryless (exponentially distributed) hazards:\n$1$. Physical or immune clearance, which occurs at a constant rate $c$.\n$2$. Successful infection of a susceptible cell, which occurs at a constant rate $\\beta$.\n\nThis is a classic competing risks problem. For any given virion, we want to find the probability that the \"infection\" event happens before the \"clearance\" event. Let $T_I$ be the time to infection and $T_C$ be the time to clearance. According to the problem statement, $T_I \\sim \\text{Exponential}(\\beta)$ and $T_C \\sim \\text{Exponential}(c)$. The probability that infection occurs before clearance is $P(T_I  T_C)$.\n\nThis probability can be calculated as the ratio of the rate of the event of interest (infection) to the total rate of all possible events. The total rate of any event happening to the virion is $\\lambda_{\\text{total}} = \\beta + c$.\nThe probability of a successful infection is therefore:\n$$P(\\text{infection}) = \\frac{\\beta}{\\beta + c}$$\n\nNow, we can combine these two results to find $R_{0,\\mathrm{tumor}}$. A single infected cell produces $p$ virions, and each virion has a probability of $\\frac{\\beta}{\\beta+c}$ of causing a new infection. Since each virion acts independently, the total expected number of secondary infections is the sum of the expected outcomes for each virion:\n$$R_{0,\\mathrm{tumor}} = p \\times P(\\text{infection})$$\n$$R_{0,\\mathrm{tumor}} = p \\frac{\\beta}{\\beta + c}$$\n\nIt is critical to note that the parameter $\\delta$, the rate of infected cell lysis, does not appear in the final expression for $R_{0,\\mathrm{tumor}}$. This is a correct and necessary consequence of the model's assumptions. The basic reproduction number $R_0$ is a cumulative measure of the total number of offspring produced by a single infectious individual over its entire infectious period. In this burst model, where lysis is a guaranteed event that releases a fixed number of virions, the rate $\\delta$ only affects the timing (i.e., the generation interval) of the secondary infections, not the total number produced. The total number is determined solely by the burst size $p$ and the subsequent fate of the released virions, which depends on the competition between infection ($\\beta$) and clearance ($c$). The problem's request to express the answer in terms of $\\delta$ is inconsistent with the physical and mathematical logic of the specified model. The derived expression is the only one that correctly follows from the stated premises.", "answer": "$$\\boxed{\\frac{p \\beta}{\\beta + c}}$$", "id": "5037701"}, {"introduction": "Oncolytic viruses are rarely used as a standalone treatment; their true potential often emerges in combination with other anti-cancer agents. A key challenge in translational medicine is to determine whether a combination is merely additive or truly synergistic, where the combined effect is greater than the sum of its parts. This practice [@problem_id:5037603] introduces a standard pharmacological framework, Loewe additivity, to analyze hypothetical experimental data and compute an interaction index, providing a quantitative basis for identifying and prioritizing effective combination therapies.", "problem": "A translational medicine team investigates whether combining an Oncolytic Virus (OV) with a Janus kinase (JAK) pathway inhibitor enhances tumor cell killing relative to monotherapies. They assess fractional viability $v \\in [0,1]$ (ratio of live cells to untreated control) in a human melanoma cell line at $72$ hours post-treatment. The OV is dosed by Multiplicity of Infection (MOI), and the JAK inhibitor is dosed in micromolar. The monotherapy dose–response data (mean fractional viability) are:\n\n- OV alone: doses $d_{V} \\in \\{\\,0.01,\\,0.03,\\,0.10,\\,0.30,\\,1.00\\,\\}$ (MOI) give $v_{V} \\in \\{\\,0.95,\\,0.86,\\,0.62,\\,0.28,\\,0.12\\,\\}$.\n- JAK inhibitor alone: doses $d_{J} \\in \\{\\,0.01,\\,0.03,\\,0.10,\\,0.30,\\,1.00\\,\\}$ ($\\mu\\mathrm{M}$) give $v_{J} \\in \\{\\,0.99,\\,0.92,\\,0.74,\\,0.45,\\,0.25\\,\\}$.\n\nIn the combination matrix, the dose pair $(d_{V}, d_{J}) = (0.10, 0.30)$ yields an observed fractional viability $v_{\\mathrm{comb}} = 0.25$.\n\nUsing the foundational pharmacologic definition of Loewe additivity at a matched effect level, compute the interaction index at the combination dose pair $(d_{V}, d_{J}) = (0.10, 0.30)$, taking the target effect level to be the observed combination effect. Treat the effect as $E = 1 - v$. To estimate the single-agent doses that would achieve the same target effect when given alone, assume local log-linear behavior of $v$ as a function of $\\ln(d)$ between the two adjacent monotherapy points that bracket the target viability. For the OV, use the segment between $d_{V} = 0.30$ with $v_{V} = 0.28$ and $d_{V} = 1.00$ with $v_{V} = 0.12$. For the JAK inhibitor, use the exact monotherapy point that matches the target viability if present.\n\nRound your final interaction index to four significant figures. Express the final index as a dimensionless number. Additionally, infer whether the interaction indicates synergy or antagonism qualitatively from its deviation from unity, but report only the computed interaction index.", "solution": "The problem will be validated by first extracting the given information and then checking its scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\n-   **Subject**: Combination therapy with an Oncolytic Virus (OV) and a Janus kinase (JAK) pathway inhibitor.\n-   **Endpoint**: Fractional viability $v \\in [0, 1]$ at $72$ hours.\n-   **OV Monotherapy Data**:\n    -   Doses $d_{V} \\in \\{\\,0.01,\\,0.03,\\,0.10,\\,0.30,\\,1.00\\,\\}$ (Multiplicity of Infection, MOI).\n    -   Corresponding viabilities $v_{V} \\in \\{\\,0.95,\\,0.86,\\,0.62,\\,0.28,\\,0.12\\,\\}$.\n-   **JAK Inhibitor Monotherapy Data**:\n    -   Doses $d_{J} \\in \\{\\,0.01,\\,0.03,\\,0.10,\\,0.30,\\,1.00\\,\\}$ ($\\mu\\mathrm{M}$).\n    -   Corresponding viabilities $v_{J} \\in \\{\\,0.99,\\,0.92,\\,0.74,\\,0.45,\\,0.25\\,\\}$.\n-   **Combination Data**:\n    -   Dose pair $(d_{V}, d_{J}) = (0.10, 0.30)$.\n    -   Observed combination viability $v_{\\mathrm{comb}} = 0.25$.\n-   **Analysis Method**:\n    -   Use the Loewe additivity model to compute the interaction index, $\\Omega$.\n    -   The effect is defined as $E = 1 - v$.\n    -   The target effect level is the observed combination effect.\n-   **Interpolation Rules**:\n    -   For estimating isoeffective doses, assume local log-linear behavior of $v$ as a function of $\\ln(d)$.\n    -   For the OV, use the data segment between $d_{V} = 0.30$ (with $v_{V} = 0.28$) and $d_{V} = 1.00$ (with $v_{V} = 0.12$).\n    -   For the JAK inhibitor, use an exact monotherapy point if it matches the target viability.\n-   **Reporting Requirement**:\n    -   Round the final interaction index to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n1.  **Scientific or Factual Soundness**: The problem is well-grounded in pharmacology and translational medicine. The concepts of dose-response, fractional viability, Loewe additivity, and interaction index are standard in drug combination studies. The data values are realistic for a cell-based assay.\n2.  **Non-Formalizable or Irrelevant**: The problem is formalizable and directly relevant to the specified topic of oncolytic virus therapies.\n3.  **Incomplete or Contradictory Setup**: The problem provides all necessary data and definitions to perform the calculation. The instructions for interpolation are explicit and unambiguous. There are no contradictions.\n4.  **Unrealistic or Infeasible**: The doses and viability values are plausible. The scenario is a standard in vitro experiment.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The use of log-linear interpolation and the defined target effect lead to a unique solution.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires a multi-step calculation involving the application of a specific drug interaction model and interpolation, which is a non-trivial task.\n7.  **Outside Scientific Verifiability**: The calculations are based on established mathematical and pharmacological principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be provided.\n\nThe Loewe additivity model provides a framework for evaluating drug interactions. The interaction index, $\\Omega$, quantifies the nature of the interaction (synergy, additivity, or antagonism). For a two-drug combination, the index is defined as:\n$$ \\Omega = \\frac{d_1}{D_1} + \\frac{d_2}{D_2} $$\nHere, $d_1$ and $d_2$ are the doses of the drugs in the combination that produce a certain effect. $D_1$ and $D_2$ are the doses of each drug individually that would be required to produce the same effect. In this problem, the two agents are the Oncolytic Virus (OV) and the JAK inhibitor (J). The formula is:\n$$ \\Omega = \\frac{d_V}{D_V} + \\frac{d_J}{D_J} $$\nwhere $d_V = 0.10$ and $d_J = 0.30$. The terms $D_V$ and $D_J$ represent the doses of the OV and JAK inhibitor, respectively, that would elicit the same effect as the combination when administered alone.\n\nThe problem specifies the effect $E$ as $E = 1 - v$, where $v$ is the fractional viability. The observed viability of the combination is $v_{\\mathrm{comb}} = 0.25$. Therefore, the target effect level is:\n$$ E_{\\mathrm{target}} = 1 - v_{\\mathrm{comb}} = 1 - 0.25 = 0.75 $$\nThis corresponds to a target viability level of $v_{\\mathrm{target}} = 0.25$. We must find the doses $D_V$ and $D_J$ that individually result in a viability of $0.25$.\n\nFirst, we determine $D_J$, the dose of the JAK inhibitor that yields $v_J = 0.25$. The problem allows using an exact monotherapy point if available. Examining the JAK inhibitor data, $d_{J} = \\{0.01, 0.03, 0.10, 0.30, 1.00\\}$ and $v_{J} = \\{0.99, 0.92, 0.74, 0.45, 0.25\\}$. We see that a dose of $d_J = 1.00 \\, \\mu\\mathrm{M}$ results in a viability of $0.25$. Therefore:\n$$ D_J = 1.00 $$\n\nNext, we determine $D_V$, the dose of the OV that yields $v_V = 0.25$. The OV monotherapy data does not contain an exact point where viability is $0.25$. We must use the specified log-linear interpolation method. This model assumes a linear relationship between viability $v$ and the natural logarithm of the dose, $\\ln(d)$. The equation of the line is $v = m \\ln(d) + c$.\nWe are instructed to use the two points that bracket the target viability $v_{\\mathrm{target}} = 0.25$:\nPoint 1: $(d_{V1}, v_{V1}) = (0.30, 0.28)$\nPoint 2: $(d_{V2}, v_{V2}) = (1.00, 0.12)$\n\nThe equation for linear interpolation between $(\\ln(d_{V1}), v_{V1})$ and $(\\ln(d_{V2}), v_{V2})$ is:\n$$ \\frac{v - v_{V1}}{\\ln(d) - \\ln(d_{V1})} = \\frac{v_{V2} - v_{V1}}{\\ln(d_{V2}) - \\ln(d_{V1})} $$\nWe need to find the dose $d = D_V$ for which $v = v_{\\mathrm{target}} = 0.25$. Substituting the known values:\n$$ \\frac{0.25 - 0.28}{\\ln(D_V) - \\ln(0.30)} = \\frac{0.12 - 0.28}{\\ln(1.00) - \\ln(0.30)} $$\n$$ \\frac{-0.03}{\\ln(D_V) - \\ln(0.30)} = \\frac{-0.16}{0 - \\ln(0.30)} $$\n$$ \\frac{-0.03}{\\ln(D_V) - \\ln(0.30)} = \\frac{0.16}{\\ln(0.30)} $$\nNow, we solve for $\\ln(D_V)$:\n$$ \\ln(D_V) - \\ln(0.30) = \\frac{-0.03}{0.16} \\ln(0.30) $$\n$$ \\ln(D_V) = \\ln(0.30) - \\frac{0.03}{0.16} \\ln(0.30) $$\n$$ \\ln(D_V) = \\left(1 - \\frac{0.03}{0.16}\\right) \\ln(0.30) $$\n$$ \\frac{0.03}{0.16} = \\frac{3}{16} = 0.1875 $$\n$$ \\ln(D_V) = (1 - 0.1875) \\ln(0.30) = 0.8125 \\ln(0.30) $$\nTo find $D_V$, we exponentiate both sides:\n$$ D_V = \\exp(0.8125 \\ln(0.30)) = (0.30)^{0.8125} $$\nCalculating this value:\n$$ D_V \\approx 0.3759807 $$\n\nNow we have all components to calculate the interaction index $\\Omega$:\n-   Combination OV dose: $d_V = 0.10$\n-   Combination JAK inhibitor dose: $d_J = 0.30$\n-   Isoeffective OV dose: $D_V \\approx 0.3759807$\n-   Isoeffective JAK inhibitor dose: $D_J = 1.00$\n\nSubstituting these into the formula for $\\Omega$:\n$$ \\Omega = \\frac{0.10}{0.3759807} + \\frac{0.30}{1.00} $$\n$$ \\Omega \\approx 0.2659711 + 0.30 $$\n$$ \\Omega \\approx 0.5659711 $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\Omega \\approx 0.5660 $$\nAn interaction index less than $1$ indicates synergy, meaning the combination is more effective than would be expected from the individual activities of the drugs. An index equal to $1$ represents additivity, and an index greater than $1$ represents antagonism. The computed value of $0.5660$ indicates a synergistic interaction.", "answer": "$$\\boxed{0.5660}$$", "id": "5037603"}, {"introduction": "Beyond direct cell killing, a critical mechanism of oncolytic virus therapy is the stimulation of a robust, systemic anti-tumor immune response. By causing immunogenic cell death, OVs release a cascade of tumor antigens that can be presented by dendritic cells to prime cytotoxic T lymphocytes. This advanced computational exercise [@problem_id:5037688] tasks you with building a mechanistic model that connects antigen availability to T cell clonal expansion, allowing you to predict the breadth of the resulting immune response—a key indicator of therapeutic success and long-term patient benefit.", "problem": "You are tasked with constructing and implementing a mechanistic model for predicting the breadth of cytotoxic T lymphocyte (CTL) response following oncolytic virus therapy. The model must link antigen abundance released by tumor lysis, dendritic cell (DC) maturation, and T cell clonal expansion. The output of your program will be the predicted breadth, defined as the count of T cell clones that expand by at least a specified fold by a specified time horizon, for each test case. All time quantities must be interpreted in days, all rates in per day, and antigen abundance in an arbitrary nonnegative unit; the requested outputs are unitless integers.\n\nStart from the following fundamental base and assumptions, consistent with immunology and chemical kinetics:\n\n1. Antigen abundance and DC maturation:\n   - Let there be a set of epitopes with abundances $\\{a_{e}\\}_{e=1}^{E}$ produced by tumor cell lysis. Let $A_{\\mathrm{total}} = \\sum_{e=1}^{E} a_{e}$ denote the total antigen load available for pattern-recognition.\n   - DC maturation is driven by the fractional occupancy of cooperative Pattern Recognition Receptors (PRR) under equilibrium mass-action kinetics. Assume $h$ identical cooperative binding events and a dissociation constant $K$ for effective activation. Use the equilibrium fractional occupancy formula derived from these assumptions to obtain a dimensionless maturation level $m \\in [0,1]$ as a function of $A_{\\mathrm{total}}$, $K$, and $h$.\n\n2. Clone-specific signaling:\n   - For a T cell clone $i$, let it recognize epitope $e(i)$ with affinity parameter $\\alpha_{i} \\ge 0$. Assume the instantaneous stimulatory signal $s_{i}$ that drives clonal proliferation is proportional to the dendritic cell maturation level $m$, the epitope-specific antigen abundance $a_{e(i)}$, and the clone-specific affinity $\\alpha_{i}$. Include a constant cross-presentation efficiency factor $c > 0$ such that $s_{i} = m \\cdot c \\cdot \\alpha_{i} \\cdot a_{e(i)}$.\n\n3. Clonal expansion dynamics:\n   - Assume that the net per capita proliferation rate of clone $i$ follows a saturating transduction relation with half-saturation parameter $\\sigma > 0$ and maximal stimulation rate $r_{\\max} > 0$, and includes a baseline loss (death/exhaustion) rate $d \\ge 0$. Using these assumptions, form $r_{i}$ as an increasing saturable function of $s_{i}$ that tends to $r_{\\max} - d$ at high $s_{i}$ and to $-d$ as $s_{i} \\to 0$.\n   - Over a fixed time horizon $T > 0$, approximate clonal size dynamics as exponential with rate $r_{i}$, so that the fold expansion is $F_{i} = \\exp(r_{i} T)$.\n   - A clone $i$ contributes to the breadth if and only if $F_{i} \\ge F_{\\min}$, where $F_{\\min} > 0$ is a specified fold-change threshold.\n\nYour task:\n- From the principles above, derive explicit expressions needed to compute $m$, $s_{i}$, $r_{i}$, and $F_{i}$, and implement them to compute the breadth for multiple test cases.\n- Each test case specifies the epitope abundances $\\{a_{e}\\}$, kinetic and dynamic parameters $(K, h, c, r_{\\max}, \\sigma, d, T, F_{\\min})$, and a list of T cell clones $(e(i), \\alpha_{i})$ with epitope indices starting from $1$.\n- For each test case, compute the breadth as the integer count of clones $i$ satisfying $F_{i} \\ge F_{\\min}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[1,2,3]\".\n\nTest suite:\nProvide results for the following three test cases. Use the exact parameter values as listed. All times are in days, all rates in per day, antigen abundance in an arbitrary nonnegative unit, and the outputs are unitless integers:\n\n- Test case $1$ (general, multi-epitope, mixed affinities):\n  - Epitope abundances: $\\{a_{e}\\} = [\\,2.0,\\,0.5,\\,1.0\\,]$.\n  - Parameters: $K = 1.0$, $h = 2$, $c = 1.0$, $r_{\\max} = 1.2$, $\\sigma = 0.8$, $d = 0.2$, $T = 5.0$, $F_{\\min} = 2.0$.\n  - Clones: $[(e(1)=1,\\ \\alpha_{1}=1.0),\\ (e(2)=2,\\ \\alpha_{2}=0.8),\\ (e(3)=3,\\ \\alpha_{3}=0.6),\\ (e(4)=2,\\ \\alpha_{4}=0.0),\\ (e(5)=1,\\ \\alpha_{5}=0.3)]$.\n\n- Test case $2$ (boundary with no antigen):\n  - Epitope abundances: $\\{a_{e}\\} = [\\,0.0,\\,0.0\\,]$.\n  - Parameters: $K = 1.0$, $h = 2$, $c = 1.0$, $r_{\\max} = 1.0$, $\\sigma = 0.5$, $d = 0.2$, $T = 5.0$, $F_{\\min} = 1.5$.\n  - Clones: $[(e(1)=1,\\ \\alpha_{1}=1.0),\\ (e(2)=2,\\ \\alpha_{2}=0.5)]$.\n\n- Test case $3$ (near-saturation antigen with nontrivial loss rate):\n  - Epitope abundances: $\\{a_{e}\\} = [\\,10.0\\,]$.\n  - Parameters: $K = 0.5$, $h = 2$, $c = 1.0$, $r_{\\max} = 0.9$, $\\sigma = 0.7$, $d = 0.4$, $T = 3.0$, $F_{\\min} = 2.5$.\n  - Clones: $[(e(1)=1,\\ \\alpha_{1}=0.3),\\ (e(2)=1,\\ \\alpha_{2}=0.15)]$.\n\nFinal output format:\n- Your program must output a single line containing a list of three integers corresponding to the breadth for Test cases $1$, $2$, and $3$, respectively, in the exact format \"[b1,b2,b3]\".", "solution": "The problem presents a valid, well-posed, and scientifically grounded task to model the breadth of a T cell response. It is based on established principles of immunology and biochemical kinetics, with all necessary parameters and conditions provided. We first derive the explicit mathematical formulas for the model components as described, then apply them to the given test cases.\n\nThe modeling process can be broken down into a sequence of computational steps:\n\n**1. Dendritic Cell (DC) Maturation Level ($m$)**\n\nThe maturation of DCs is assumed to be driven by the total antigen load, $A_{\\mathrm{total}}$, released from lysed tumor cells. This process is modeled as an equilibrium binding phenomenon with cooperativity.\nGiven a set of epitope abundances $\\{a_{e}\\}_{e=1}^{E}$, the total antigen load is the sum:\n$$A_{\\mathrm{total}} = \\sum_{e=1}^{E} a_{e}$$\nThe maturation level, $m$, is described as the fractional occupancy of Pattern Recognition Receptors (PRRs) following mass-action kinetics with $h$ cooperative binding events and a dissociation constant $K$. This is a classic cooperative binding model, for which the fractional occupancy is given by the Hill equation:\n$$m = \\frac{(A_{\\mathrm{total}} / K)^h}{1 + (A_{\\mathrm{total}} / K)^h} = \\frac{A_{\\mathrm{total}}^h}{K^h + A_{\\mathrm{total}}^h}$$\nThis yields a dimensionless maturation level $m \\in [0, 1]$, which acts as a global signal reflecting the overall level of danger perceived by the innate immune system.\n\n**2. Clone-Specific T Cell Stimulatory Signal ($s_i$)**\n\nThe activation signal for a specific T cell clone $i$ depends on three factors: the global DC maturation level ($m$), the abundance of its specific cognate epitope ($a_{e(i)}$), and its T-cell receptor affinity for that epitope-MHC complex ($\\alpha_i$). The problem specifies a direct multiplicative relationship, including a cross-presentation efficiency factor $c > 0$. The resulting stimulatory signal $s_i$ for clone $i$, which recognizes epitope $e(i)$, is:\n$$s_{i} = m \\cdot c \\cdot \\alpha_{i} \\cdot a_{e(i)}$$\nThis captures the requirement for both a general \"danger\" context (high $m$) and a specific antigen signal (high $a_{e(i)}$ and $\\alpha_i$) to effectively stimulate a T cell clone.\n\n**3. Net Clonal Proliferation Rate ($r_i$)**\n\nThe per capita net proliferation rate, $r_i$, of clone $i$ is modeled as a saturating function of the stimulatory signal $s_i$. The problem states it should approach a maximal rate of $r_{\\max} - d$ for high $s_i$ and a net loss rate of $-d$ as $s_i \\to 0$. A standard function that satisfies these criteria is the Michaelis-Menten form for the proliferative component, combined with an independent loss term $d$:\n$$r_{i} = \\left( r_{\\max} \\frac{s_i}{\\sigma + s_i} \\right) - d$$\nHere, $r_{\\max}$ is the maximal proliferation rate, $\\sigma > 0$ is the half-saturation constant (the signal strength $s_i$ at which the proliferation rate is half its maximum), and $d \\ge 0$ is the constant per capita rate of cell loss due to factors like death or exhaustion.\n\n**4. Clonal Expansion and Breadth Calculation**\n\nThe expansion of each T cell clone is approximated as exponential growth over a fixed time horizon $T > 0$. The fold change in the size of clone $i$ is therefore:\n$$F_{i} = \\exp(r_{i} T)$$\nA clone $i$ is counted towards the therapeutic breadth if its expansion meets or exceeds a minimum threshold, $F_{\\min}$. The condition is:\n$$F_{i} \\ge F_{\\min}$$\nTo avoid potential floating-point issues with large exponents and to simplify computation, we can take the natural logarithm of both sides:\n$$\\ln(F_{i}) \\ge \\ln(F_{\\min})$$\n$$r_{i} T \\ge \\ln(F_{\\min})$$\n$$r_{i} \\ge \\frac{\\ln(F_{\\min})}{T}$$\nThis inequality provides a direct threshold on the net proliferation rate $r_i$ for a clone to be considered significantly expanded.\nThe breadth of the response is the total number of clones that satisfy this condition.\n\n**Computational Algorithm**\n\nFor each test case, we implement the following algorithm:\n1.  Read the epitope abundances $\\{a_{e}\\}$, parameters $(K, h, c, r_{\\max}, \\sigma, d, T, F_{\\min})$, and the list of T cell clones $(e(i), \\alpha_i)$. Note that the provided epitope indices $e(i)$ are $1$-based and must be converted to $0$-based indices for array access.\n2.  Calculate the total antigen load $A_{\\mathrm{total}} = \\sum a_e$.\n3.  Calculate the DC maturation level $m = A_{\\mathrm{total}}^h / (K^h + A_{\\mathrm{total}}^h)$.\n4.  Calculate the rate threshold for successful expansion: $r_{\\mathrm{threshold}} = \\ln(F_{\\min}) / T$.\n5.  Initialize a counter for breadth to $0$.\n6.  Iterate through each T cell clone $i$:\n    a. Identify its target epitope $e(i)$ and retrieve the corresponding abundance $a_{e(i)}$.\n    b. Calculate the stimulatory signal $s_i = m \\cdot c \\cdot \\alpha_i \\cdot a_{e(i)}$.\n    c. Calculate the net proliferation rate $r_i = r_{\\max} \\frac{s_i}{\\sigma + s_i} - d$.\n    d. If $r_i \\ge r_{\\mathrm{threshold}}$, increment the breadth counter.\n7.  The final value of the breadth counter is the result for the test case.\n\nThis procedure is applied to all test cases provided.\n- For Test Case 1, we expect a broad response due to multiple antigens and high-affinity clones.\n- For Test Case 2, with $A_{\\mathrm{total}}=0$, $m$ will be $0$, leading to $s_i=0$ and $r_i=-d$ for all clones. As $F_{\\min} \\ge 1$ (since $1.51$), $\\ln(F_{\\min})  0$, so the required rate is positive. No clone can meet this threshold, so the breadth must be $0$.\n- For Test Case 3, high antigen load ensures near-maximal DC maturation ($m \\approx 1$). The final breadth will depend on whether the signal $s_i$ for each clone is strong enough to drive a proliferation rate $r_i$ that overcomes both the loss rate $d$ and the expansion threshold $F_{\\min}$.", "answer": "```python\nimport numpy as np\n\ndef calculate_breadth(abundances, params, clones):\n    \"\"\"\n    Calculates the T cell response breadth for a single test case.\n\n    Args:\n        abundances (list): A list of epitope abundances {a_e}.\n        params (dict): A dictionary of model parameters (K, h, c, r_max, sigma, d, T, F_min).\n        clones (list): A list of tuples, where each tuple is (epitope_idx, alpha)\n                       for a T cell clone. Epitope indices are 1-based.\n\n    Returns:\n        int: The calculated breadth, an integer count of qualifying clones.\n    \"\"\"\n    K = params['K']\n    h = params['h']\n    c = params['c']\n    r_max = params['r_max']\n    sigma = params['sigma']\n    d = params['d']\n    T = params['T']\n    F_min = params['F_min']\n\n    # 1. Calculate total antigen load and DC maturation level (m)\n    A_total = sum(abundances)\n    \n    # Avoid division by zero if K=0 and A_total=0\n    # The limit is 0 in this case.\n    if K == 0 and A_total == 0:\n        m = 0.0\n    # For h=0, the Hill equation is 1/(1+1) = 0.5. For very large A_total, m - 1.\n    elif K  0 and A_total == 0:\n        m = 0.0\n    else:\n        # Use np.power for safe exponentiation\n        A_total_h = np.power(A_total, h)\n        K_h = np.power(K, h)\n        m = A_total_h / (K_h + A_total_h)\n\n    # 2. Calculate the threshold rate for successful expansion\n    # We must have F_min  0 per the problem spec.\n    # If F_min = 1, ln(F_min) = 0 making the threshold non-positive.\n    # If T=0, this is undefined, but T0 here.\n    r_threshold = np.log(F_min) / T\n\n    breadth = 0\n    \n    # 3. Iterate through each clone to check if it contributes to the breadth\n    for clone in clones:\n        epitope_idx, alpha_i = clone\n        # Epitope indices are 1-based, convert to 0-based for list access\n        a_ei = abundances[epitope_idx - 1]\n\n        # 3a. Calculate stimulatory signal (s_i)\n        s_i = m * c * alpha_i * a_ei\n\n        # 3b. Calculate net proliferation rate (r_i)\n        if sigma + s_i == 0: # Avoid division by zero if sigma and s_i are both 0.\n            prolif_term = 0.0\n        else:\n            prolif_term = r_max * (s_i / (sigma + s_i))\n        r_i = prolif_term - d\n\n        # 3c. Check if the clone's expansion meets the threshold\n        if r_i = r_threshold:\n            breadth += 1\n            \n    return breadth\n\ndef solve():\n    \"\"\"\n    Defines the test cases and runs the simulation for each to produce the final output.\n    \"\"\"\n    test_cases = [\n        {\n            \"abundances\": [2.0, 0.5, 1.0],\n            \"params\": {'K': 1.0, 'h': 2, 'c': 1.0, 'r_max': 1.2, 'sigma': 0.8, 'd': 0.2, 'T': 5.0, 'F_min': 2.0},\n            \"clones\": [(1, 1.0), (2, 0.8), (3, 0.6), (2, 0.0), (1, 0.3)]\n        },\n        {\n            \"abundances\": [0.0, 0.0],\n            \"params\": {'K': 1.0, 'h': 2, 'c': 1.0, 'r_max': 1.0, 'sigma': 0.5, 'd': 0.2, 'T': 5.0, 'F_min': 1.5},\n            \"clones\": [(1, 1.0), (2, 0.5)]\n        },\n        {\n            \"abundances\": [10.0],\n            \"params\": {'K': 0.5, 'h': 2, 'c': 1.0, 'r_max': 0.9, 'sigma': 0.7, 'd': 0.4, 'T': 3.0, 'F_min': 2.5},\n            \"clones\": [(1, 0.3), (1, 0.15)]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_breadth(case[\"abundances\"], case[\"params\"], case[\"clones\"])\n        results.append(result)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solution\nsolve()\n```", "id": "5037688"}]}