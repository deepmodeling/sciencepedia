{"hands_on_practices": [{"introduction": "Before implementing a large-scale pharmacogenomic screening program, it is essential to estimate the number of individuals in a population who might carry clinically significant variants. This practice applies the Hardy-Weinberg Equilibrium, a foundational principle of population genetics, to predict genotype frequencies from a known allele frequency. By working through this calculation [@problem_id:5023504], you will gain a practical understanding of how to forecast the prevalence of pharmacogenomic variants in a patient cohort, a crucial first step for resource allocation and strategic planning.", "problem": "A translational medicine team is planning clinical implementation of preemptive pharmacogenomic testing for the gene dihydropyrimidine dehydrogenase (DPD), encoded by the gene symbol DPYD, to guide fluoropyrimidine dosing. Consider a single biallelic loss-of-function variant in DPYD with minor allele frequency $p=0.01$ in the clinic’s patient population. Assume the population is large, randomly mating, and in Hardy–Weinberg Equilibrium (HWE), and that there is no selection, mutation, migration, or genotyping error affecting the locus. Let the major (reference) allele frequency be $1-p$. \n\nUsing only the principles of HWE and the relationship between allele and genotype frequencies, derive the expected genotype frequencies for the homozygous variant, heterozygous, and homozygous reference genotypes in terms of $p$. Then, for a clinic cohort of $50{,}000$ patients, compute the expected total number of patients who carry at least one copy of the variant allele (that is, the sum of expected heterozygotes and expected homozygous variant individuals). \n\nRound your final answer to three significant figures and express the final count in patients.", "solution": "The Hardy–Weinberg Equilibrium (HWE) provides a fundamental relationship between allele frequencies and genotype frequencies for a biallelic locus in a large, randomly mating population with no evolutionary forces acting. Let the variant allele frequency be $p$, and the reference allele frequency be $q=1-p$. Under HWE, the genotype frequencies arise from the binomial expansion of the mating probabilities based on allele frequencies.\n\nStarting from the core definitions:\n- The total allele frequency sums to one: $p+q=1$.\n- Under random mating, the probability of forming a genotype equals the product of the constituent allele probabilities.\n\nTherefore, the expected genotype frequencies are:\n- Homozygous variant: $p \\times p = p^{2}$.\n- Heterozygous: two ways to obtain one variant and one reference allele, yielding $2pq=2p(1-p)$.\n- Homozygous reference: $q \\times q = q^{2}=(1-p)^{2}$.\n\nThese relationships follow from the binomial $(p+q)^{2}=p^{2}+2pq+q^{2}$.\n\nFor $p=0.01$, compute $q$:\n$$\nq=1-p=1-0.01=0.99.\n$$\nCompute the genotype frequencies:\n- Homozygous variant frequency:\n$$\np^{2}=(0.01)^{2}=0.0001.\n$$\n- Heterozygous frequency:\n$$\n2pq=2 \\cdot 0.01 \\cdot 0.99=0.0198.\n$$\n- Homozygous reference frequency (for completeness):\n$$\nq^{2}=(0.99)^{2}=0.9801.\n$$\n\nPatients carrying at least one variant allele are the union of heterozygotes and homozygous variants, with expected frequency\n$$\nf_{\\text{carriers}}=2pq+p^{2}=0.0198+0.0001=0.0199.\n$$\n\nFor a clinic cohort of $N=50{,}000$ patients, the expected number of carriers is\n$$\nN \\times f_{\\text{carriers}}=50{,}000 \\times 0.0199=995.\n$$\n\nRounding to three significant figures yields $995$. The final count is expressed in patients, as requested.", "answer": "$$\\boxed{995}$$", "id": "5023504"}, {"introduction": "A pharmacogenomic test is only as useful as it is reliable, and its performance is not absolute but depends on the prevalence of the variant in the population being tested. This exercise guides you through the calculation of the Positive Predictive Value (PPV), a critical metric that quantifies the probability that a patient with a positive test result is a true carrier [@problem_id:5023448]. Understanding PPV is fundamental for interpreting test results in a clinical context and for making informed risk-benefit decisions, such as whether to prescribe a drug with a high risk of adverse events.", "problem": "A translational medicine clinic is implementing pre-prescription pharmacogenomic testing for Human Leukocyte Antigen (HLA)-B$\\ast$57:01 to mitigate abacavir hypersensitivity. In a well-characterized adult population, the prevalence of HLA-B$\\ast$57:01 carriage is $p = 0.06$. The assay used has sensitivity $s = 0.99$ and specificity $t = 0.995$, values established by external proficiency testing. Assume independence between test errors and carrier status, and that the population is representative of the clinic’s patient cohort.\n\nStarting from first principles, use the definitions of sensitivity, specificity, and Bayes’ theorem to derive an expression for the positive predictive value, defined as $\\mathrm{PPV} = \\mathbb{P}(\\text{carrier} \\mid \\text{test positive})$, in terms of $p$, $s$, and $t$. Then evaluate the expression for $p = 0.06$, $s = 0.99$, and $t = 0.995$. Express $\\mathrm{PPV}$ as a decimal without a percent sign, and round your final answer to four significant figures.\n\nFinally, based on your computed $\\mathrm{PPV}$, briefly interpret the clinical implications for test-positive individuals in the context of abacavir prescribing decisions, focusing on how the predictive value affects risk management and clinical workflow. Your interpretation should be included in your reasoning, not in the final numerical answer.", "solution": "We begin by defining the relevant events and translating the given information into the language of conditional probability.\nLet $C$ be the event that a randomly chosen individual from the population is a carrier of the HLA-B$\\ast$57:01 allele.\nLet $C^c$ be the complement event, meaning the individual is not a carrier.\nLet $T+$ be the event that the individual's test result is positive.\nLet $T-$ be the event that the individual's test result is negative.\n\nFrom the problem statement, we are given:\n1.  The prevalence of the allele: $\\mathbb{P}(C) = p = 0.06$. From this, the probability of not being a carrier is $\\mathbb{P}(C^c) = 1 - p = 1 - 0.06 = 0.94$.\n2.  The sensitivity of the assay: $s = \\mathbb{P}(T+ \\mid C) = 0.99$. This is the probability of a positive test for a true carrier (a true positive).\n3.  The specificity of the assay: $t = \\mathbb{P}(T- \\mid C^c) = 0.995$. This is the probability of a negative test for a true non-carrier (a true negative).\n\nThe problem asks for the Positive Predictive Value ($\\mathrm{PPV}$), which is defined as the probability that an individual is a carrier given that they have tested positive. In our notation, this is $\\mathbb{P}(C \\mid T+)$.\n\nWe will derive the expression for $\\mathrm{PPV}$ using Bayes' theorem, which states:\n$$\n\\mathbb{P}(C \\mid T+) = \\frac{\\mathbb{P}(T+ \\mid C) \\mathbb{P}(C)}{\\mathbb{P}(T+)}\n$$\n\nThe denominator, $\\mathbb{P}(T+)$, is the total probability of a positive test. We can calculate this using the law of total probability, which involves marginalizing over the carrier status:\n$$\n\\mathbb{P}(T+) = \\mathbb{P}(T+ \\mid C) \\mathbb{P}(C) + \\mathbb{P}(T+ \\mid C^c) \\mathbb{P}(C^c)\n$$\nWe already have expressions for $\\mathbb{P}(T+ \\mid C)$ and $\\mathbb{P}(C)$. We need to find $\\mathbb{P}(T+ \\mid C^c)$, which is the probability of a positive test for a non-carrier (a false positive). This is the complement of the specificity, $t$.\n$$\n\\mathbb{P}(T+ \\mid C^c) = 1 - \\mathbb{P}(T- \\mid C^c) = 1 - t\n$$\nNow, substituting the symbolic variables ($p$, $s$, $t$) into the law of total probability:\n$$\n\\mathbb{P}(T+) = s \\cdot p + (1 - t)(1 - p)\n$$\nSubstituting this denominator back into the Bayes' theorem formula for $\\mathrm{PPV}$:\n$$\n\\mathrm{PPV} = \\mathbb{P}(C \\mid T+) = \\frac{\\mathbb{P}(T+ \\mid C) \\mathbb{P}(C)}{\\mathbb{P}(T+ \\mid C) \\mathbb{P}(C) + \\mathbb{P}(T+ \\mid C^c) \\mathbb{P}(C^c)}\n$$\nThis gives the final derived expression in terms of $p$, $s$, and $t$:\n$$\n\\mathrm{PPV} = \\frac{s \\cdot p}{s \\cdot p + (1 - t)(1 - p)}\n$$\nNow we evaluate this expression using the provided numerical values: $p = 0.06$, $s = 0.99$, and $t = 0.995$.\n\nFirst, calculate the numerator (the probability of a true positive result in the population):\n$$\ns \\cdot p = 0.99 \\times 0.06 = 0.0594\n$$\nNext, calculate the second term in the denominator (the probability of a false positive result in the population):\n$$\n(1 - t)(1 - p) = (1 - 0.995)(1 - 0.06) = 0.005 \\times 0.94 = 0.0047\n$$\nNow, calculate the total probability of a positive test:\n$$\n\\mathbb{P}(T+) = 0.0594 + 0.0047 = 0.0641\n$$\nFinally, we can compute the $\\mathrm{PPV}$:\n$$\n\\mathrm{PPV} = \\frac{0.0594}{0.0641} \\approx 0.926677067...\n$$\nRounding to four significant figures, we get:\n$$\n\\mathrm{PPV} \\approx 0.9267\n$$\n\n**Clinical Interpretation:**\nA Positive Predictive Value of $0.9267$ signifies that for a patient in this population who receives a positive test result for HLA-B$\\ast$57:01, there is a $92.67\\%$ probability that they are a true carrier of the allele. Conversely, there is a $1 - 0.9267 = 0.0733$, or $7.33\\%$, chance that the positive result is a false positive.\n\nIn the context of abacavir prescription, this high $\\mathrm{PPV}$ has direct and critical implications for risk management. Abacavir is strictly contraindicated in individuals who are true carriers of HLA-B$\\ast$57:01 due to the high risk of a severe and potentially life-threatening hypersensitivity reaction. The test's ability to correctly identify carriers with over $92\\%$ certainty provides strong justification for a definitive clinical action.\n\nThe established clinical workflow is to avoid prescribing abacavir to any patient with a positive test. The small risk of a false positive ($7.33\\%$) means that a small fraction of individuals who are not actually at risk might be denied abacavir. This is considered an acceptable trade-off because the consequence of a false negative (incorrectly treating a true carrier) is catastrophic, while the consequence of a false positive (unnecessarily withholding abacavir from a non-carrier) is minimal, as effective alternative antiretroviral therapies are readily available. The high $\\mathrm{PPV}$ confirms that the test is an effective tool for risk stratification, allowing clinicians to confidently prevent nearly all cases of abacavir hypersensitivity in their patient cohort.", "answer": "$$\\boxed{0.9267}$$", "id": "5023448"}, {"introduction": "Translating a patient's complex genetic data into a clear, actionable clinical recommendation is a core task in applied pharmacogenomics. This practice demonstrates the standardized 'activity score' method, pioneered by consortia like the Clinical Pharmacogenetics Implementation Consortium (CPIC), to convert a $CYP2D6$ genotype—including complexities like copy number variations—into a functional phenotype [@problem_id:5023493]. Mastering this calculation allows you to see how raw genetic information is processed into a simple classification, such as 'Normal Metabolizer,' which directly guides drug selection and dosing.", "problem": "In a clinical pharmacogenomics implementation workflow for Cytochrome P450 Family 2 Subfamily D Member 6 (CYP2D6), a patient’s genotype is reported as $\\ast 1 / \\ast 10$ with a duplication of the $\\ast 1$ allele, yielding a total gene copy number of $3$. Each CYP2D6 allele is assigned a function value $f(\\cdot)$ reflecting its relative contribution to enzyme activity, where $f(\\ast 1)=1$ and $f(\\ast 10)=0.25$. In copy number variation, each gene copy contributes additively to the overall activity. Clinical Pharmacogenetics Implementation Consortium (CPIC) phenotype categories are assigned from the activity score $S$ using the following thresholds: poor metabolizer if $S=0$, intermediate metabolizer if $0.25 \\leq S \\leq 1$, normal metabolizer if $1.25 \\leq S \\leq 2.25$, and ultrarapid metabolizer if $S2.25$. Using these implementation rules and facts, compute the CYP2D6 activity score $S$ for this patient and determine the phenotype category according to the CPIC thresholds. Report as your final answer only the numerical value of $S$. No rounding is required.", "solution": "The primary task is to compute the $CYP2D6$ activity score, denoted by $S$, for a patient with a specified genotype and then determine the corresponding metabolizer phenotype.\n\nFirst, we must correctly interpret the patient's genotype. The genotype is given as $\\ast 1 / \\ast 10$ with a duplication of the $\\ast 1$ allele. This notation describes the genetic makeup across the two homologous chromosomes. One chromosome carries the $\\ast 10$ allele. The other chromosome carries the $\\ast 1$ allele, which has been duplicated, meaning there are two copies of the $\\ast 1$ allele on that same chromosome. Therefore, the patient's complete set of $CYP2D6$ alleles consists of two copies of $\\ast 1$ and one copy of $\\ast 10$. This is consistent with the stated total gene copy number of $3$.\n\nThe problem states that the total activity score, $S$, is calculated by summing the function values, $f(\\cdot)$, of each individual gene copy present. The formula is therefore:\n$$S = \\sum_{i=1}^{N} f(\\text{allele}_i)$$\nwhere $N$ is the total number of gene copies.\n\nIn this case, the alleles are $\\{\\ast 1, \\ast 1, \\ast 10\\}$, and the total copy number is $N=3$. The activity score $S$ is calculated as:\n$$S = f(\\ast 1) + f(\\ast 1) + f(\\ast 10)$$\n\nThe problem provides the specific function values for each allele type:\n- $f(\\ast 1) = 1$\n- $f(\\ast 10) = 0.25$\n\nSubstituting these values into the equation for $S$:\n$$S = 1 + 1 + 0.25$$\n\nPerforming the addition gives the final activity score:\n$$S = 2.25$$\n\nNext, we determine the patient's metabolizer phenotype by comparing the calculated activity score $S=2.25$ to the provided CPIC thresholds:\n- Poor metabolizer: $S=0$\n- Intermediate metabolizer: $0.25 \\leq S \\leq 1$\n- Normal metabolizer: $1.25 \\leq S \\leq 2.25$\n- Ultrarapid metabolizer: $S  2.25$\n\nSince our calculated score is $S=2.25$, it falls within the range for a normal metabolizer ($1.25 \\leq 2.25 \\leq 2.25$). The patient is classified as a Normal Metabolizer.\n\nThe question requires reporting only the numerical value of $S$ as the final answer.\nThe computed activity score is $2.25$.", "answer": "$$\\boxed{2.25}$$", "id": "5023493"}]}