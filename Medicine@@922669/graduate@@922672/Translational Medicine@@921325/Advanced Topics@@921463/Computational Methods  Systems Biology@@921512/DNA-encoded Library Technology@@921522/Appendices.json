{"hands_on_practices": [{"introduction": "The immense power of DNA-Encoded Library (DEL) technology stems from its ability to generate astronomically large chemical libraries through combinatorial synthesis. This exercise provides a foundational understanding of how a library's theoretical size is determined and, just as importantly, how real-world chemical inefficiencies diminish the actual number of successfully created compounds. By calculating both the potential library size and the fraction of sequences lost to reaction failures, you will gain a practical appreciation for the engineering trade-offs inherent in DEL design [@problem_id:5011254].", "problem": "A discovery campaign in translational medicine employs DNA-encoded library (DEL) technology to enumerate small molecules for screening against a clinically validated protein target. The library is designed by appending building blocks across sequential synthesis cycles, with each appended building block covalently coupled to a unique DNA tag recording the synthetic history. In this design, the number of unique small molecules that can, in principle, be formed is determined by the Cartesian product of building block choices across cycles, assuming that every unique path through the synthesis tree yields a chemically and informationally unique construct.\n\nConsider a DEL constructed in $c=4$ cycles with per-cycle building block set sizes $[200, 400, 800, 1600]$. Each cycle involves a coupling and encoding step, and each intended coupling has an independent per-cycle reaction failure probability $p=0.02$ (expressed as a decimal), such that a failure at any cycle aborts growth and removes that partial sequence from the final pooled library of fully assembled constructs.\n\nUsing only the definitions of combinatorial enumeration and independence of Bernoulli events:\n- Compute the total enumerated library size that would be achieved in the absence of any failures.\n- Compute the expected fraction of enumerated sequences that are lost from the final library due to cumulative reaction failures across all cycles.\n\nExpress your final answers together, in the order $(\\text{library size}, \\text{lost fraction})$. Report the library size as an exact integer, and round the lost fraction to six significant figures. Do not include units in the final reported pair.", "solution": "The problem is deemed valid as it is scientifically grounded in the principles of combinatorial chemistry and probability theory, well-posed with all necessary information provided, and objective in its formulation. It presents a standard, formalizable scenario in the context of DNA-encoded library (DEL) technology.\n\nThe solution is partitioned into two components as requested by the problem statement: first, the computation of the total enumerated library size, and second, the computation of the expected fraction of lost sequences.\n\nLet $c$ be the number of synthesis cycles, given as $c=4$.\nLet $n_i$ be the number of unique building blocks available for cycle $i$, for $i \\in \\{1, 2, 3, 4\\}$. The given set sizes are:\n$n_1 = 200$\n$n_2 = 400$\n$n_3 = 800$\n$n_4 = 1600$\nLet $p$ be the independent, per-cycle reaction failure probability, given as $p=0.02$.\n\n**Part 1: Total Enumerated Library Size**\n\nThe problem states that the total number of unique small molecules, $N_{total}$, is the Cartesian product of the building block choices across all cycles. This corresponds to the fundamental principle of counting, where the total number of outcomes for a sequence of independent events is the product of the number of outcomes for each event.\n\nThus, the total enumerated library size is calculated as the product of the number of building blocks in each cycle:\n$$N_{total} = n_1 \\times n_2 \\times n_3 \\times n_4$$\nSubstituting the given values:\n$$N_{total} = 200 \\times 400 \\times 800 \\times 1600$$\nTo compute this product:\n$$N_{total} = (2 \\times 10^2) \\times (4 \\times 10^2) \\times (8 \\times 10^2) \\times (16 \\times 10^2)$$\n$$N_{total} = (2 \\times 4 \\times 8 \\times 16) \\times 10^{2+2+2+2}$$\n$$N_{total} = 1024 \\times 10^8$$\n$$N_{total} = 102,400,000,000$$\nThis is the total theoretical library size in the absence of any synthesis failures.\n\n**Part 2: Expected Fraction of Lost Sequences**\n\nA sequence is considered \"lost\" if a reaction failure occurs at any of the $c=4$ cycles. Conversely, a sequence is successfully formed only if all $c$ reaction steps are successful.\n\nThe per-cycle failure probability is $p=0.02$. Therefore, the per-cycle success probability, $s$, is:\n$$s = 1 - p = 1 - 0.02 = 0.98$$\nSince the reaction steps at each cycle are independent events (a Bernoulli trial for each cycle), the probability that a single, specific synthetic path is successfully completed through all $c=4$ cycles, $P_{success}$, is the product of the individual success probabilities:\n$$P_{success} = s \\times s \\times s \\times s = s^c = (1-p)^c$$\nSubstituting the given values:\n$$P_{success} = (0.98)^4$$\nCalculating this value:\n$$(0.98)^2 = 0.9604$$\n$$(0.98)^4 = (0.9604)^2 = 0.92236816$$\nThis probability, $P_{success}$, represents the expected fraction of the total enumerated sequences that are successfully synthesized to completion.\n\nThe problem asks for the expected fraction of lost sequences, $F_{lost}$. This is the complement of the expected fraction of successful sequences:\n$$F_{lost} = 1 - P_{success}$$\n$$F_{lost} = 1 - (0.98)^4$$\n$$F_{lost} = 1 - 0.92236816 = 0.07763184$$\nThe problem requires this fraction to be rounded to six significant figures. The first six significant digits of $0.07763184$ are $7, 7, 6, 3, 1, 8$. The digit following this sequence is $4$, which is less than $5$, so we do not round up the last significant digit.\nTherefore, the rounded fraction of lost sequences is:\n$$F_{lost} \\approx 0.0776318$$\n\nThe final answers are the pair $(\\text{library size}, \\text{lost fraction})$.\nThe library size is the exact integer $102,400,000,000$.\nThe lost fraction, rounded to six significant figures, is $0.0776318$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n102400000000 & 0.0776318\n\\end{pmatrix}\n}\n$$", "id": "5011254"}, {"introduction": "After an affinity selection experiment, the DNA tags corresponding to binding molecules are often present in minute quantities, far too low for direct sequencing. The next critical step is Polymerase Chain Reaction (PCR) amplification to increase the copy number of these tags to a detectable level. This practice explores the kinetics of this exponential process, challenging you to determine the necessary number of PCR cycles and to consider the risks of over-amplification, such as the 'plateau effect' and chimera formation, which can distort the final results [@problem_id:5011227].", "problem": "A translational medicine team uses Deoxyribonucleic Acid-Encoded Library (DEL) technology to identify small-molecule binders against a clinically relevant membrane receptor. After affinity selection and stringent washing, the recovered Deoxyribonucleic Acid (DNA) barcodes are to be amplified by Polymerase Chain Reaction (PCR) prior to Next-Generation Sequencing (NGS). In a pilot amplification, the per-cycle amplification efficiency was measured to be a constant fold increase of $e=1.9$ over the early cycles, under conditions where reagents are not limiting and the template abundance remains within the exponential phase.\n\nStarting from the fundamental recursion that each cycle multiplies the current template count by the per-cycle efficiency, and treating cycles as discrete steps, derive the minimal integer number of cycles $n$ required to reach at least $10^{6}$ template copies from an initial $10^{3}$ molecules, assuming the efficiency $e$ is constant up to $n$. Then, using well-tested observations about PCR kinetics—specifically that exponential amplification transitions to a plateau as reagents deplete and that template-switching events leading to chimeric amplicons increase as cycle number approaches the plateau—provide a brief assessment of the likelihood of entering the plateau phase and of chimera formation at the computed $n$ under standard high-fidelity amplification conditions used in DEL workflows.\n\nReport the minimal integer $n$ as your final answer. No rounding is required beyond identifying the minimal integer, and no units are involved in the answer.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of molecular biology, specifically Polymerase Chain Reaction (PCR) kinetics, and is well-posed, with sufficient and consistent information to derive a unique solution for the primary question.\n\nThe problem asks for two parts: first, the derivation of the minimal number of PCR cycles required to achieve a certain amplification threshold, and second, a qualitative assessment of the state of the reaction at that number of cycles.\n\nFirst, we will derive the minimal integer number of cycles, $n$.\nLet $N_k$ be the number of DNA template copies after cycle $k$. The initial number of molecules is given as $N_0 = 10^3$. The problem states that each cycle multiplies the current template count by a per-cycle amplification efficiency. The problem denotes this efficiency as $e$, but to avoid any ambiguity with Euler's number, we shall denote the efficiency by the symbol $E$. The given value is $E=1.9$.\n\nThe process is described by the recurrence relation:\n$$N_k = E \\cdot N_{k-1}$$\nfor $k \\ge 1$.\n\nBy unrolling this recursion, we can express the number of copies after $n$ cycles, $N_n$, in terms of the initial number of copies, $N_0$:\n$$N_n = E \\cdot N_{n-1} = E \\cdot (E \\cdot N_{n-2}) = \\dots = E^n \\cdot N_0$$\n\nThe objective is to find the minimal integer $n$ such that the number of template copies is at least $10^6$. This can be expressed as the inequality:\n$$N_n \\ge 10^6$$\n\nSubstituting the expression for $N_n$ and the given values for $N_0$ and $E$:\n$$(1.9)^n \\cdot 10^3 \\ge 10^6$$\n\nTo solve for $n$, we first isolate the term containing the exponent:\n$$(1.9)^n \\ge \\frac{10^6}{10^3}$$\n$$(1.9)^n \\ge 10^3$$\n\nNext, we take the natural logarithm ($\\ln$) of both sides of the inequality. Since the natural logarithm is a monotonically increasing function, the direction of the inequality is preserved.\n$$\\ln((1.9)^n) \\ge \\ln(10^3)$$\n\nUsing the logarithmic property $\\ln(a^b) = b \\ln(a)$, we get:\n$$n \\ln(1.9) \\ge 3 \\ln(10)$$\n\nSince $\\ln(1.9) > \\ln(1) = 0$, its value is positive. We can therefore divide both sides by $\\ln(1.9)$ without changing the direction of the inequality:\n$$n \\ge \\frac{3 \\ln(10)}{\\ln(1.9)}$$\n\nTo find the minimal integer $n$, we must evaluate the right-hand side of this inequality.\n$$n \\ge \\frac{3 \\ln(10)}{\\ln(1.9)} \\approx \\frac{3 \\times 2.302585}{0.641854} \\approx \\frac{6.907755}{0.641854} \\approx 10.7622$$\n\nSince the number of cycles $n$ must be an integer, the smallest integer value for $n$ that satisfies the condition $n \\ge 10.7622$ is $11$.\nTherefore, the minimal integer number of cycles required is $n=11$.\n\nSecond, we provide a brief assessment of the reaction state at $n=11$ cycles.\nA standard PCR has three phases: an exponential phase, a linear phase, and a plateau phase. The exponential phase, where efficiency is high and constant, typically occurs during the early cycles. The transition to the plateau phase happens as critical reagents like dNTPs and primers are consumed, and the polymerase loses activity. The product concentration at which this transition occurs is typically in the range of $10^{11}$ to $10^{12}$ molecules per standard reaction volume.\n\nLet's calculate the approximate number of amplicons at $n=11$ cycles:\n$$N_{11} = N_0 \\cdot E^{11} = 10^3 \\cdot (1.9)^{11} \\approx 10^3 \\cdot 1218.5 = 1.2185 \\times 10^6 \\text{ molecules}$$\nThis number of molecules ($ \\approx 10^6 - 10^7$) is several orders of magnitude below the typical concentration at which reactions enter the plateau phase ($ \\approx 10^{11} - 10^{12}$). Therefore, for an initial template count of $10^3$, a PCR with $n=11$ cycles is very likely to still be in the early to middle stages of the exponential phase. The likelihood of the reaction entering the plateau phase is extremely low.\n\nChimera formation, the creation of hybrid amplicons from different templates, is an artifact whose frequency increases with PCR cycle number. It is particularly pronounced as the reaction approaches the plateau phase due to the high concentration of PCR products, which can act as primers on other templates (template-switching). Since at $n=11$ cycles the reaction is far from the plateau and product concentration is still relatively low, the rate of chimera formation would be expected to be minimal. In DEL-NGS workflows, specialized high-fidelity polymerases and protocols are used to further suppress such events. Consequently, the likelihood of significant chimera formation at $n=11$ cycles under these stringent conditions is also very low.", "answer": "$$\\boxed{11}$$", "id": "5011227"}, {"introduction": "Next-Generation Sequencing (NGS) of an amplified DEL pool generates millions of reads, but this is still just a sample of the total molecular population. A fundamental question in any DEL campaign is whether the sequencing depth was sufficient to detect the binders identified during selection. This problem delves into the statistics of random sampling, allowing you to derive the probability that a true high-affinity ligand is completely missed simply due to the stochastic nature of the sequencing process, a crucial concept for designing robust experiments and interpreting results [@problem_id:5011222].", "problem": "In a DNA-encoded library (DEL) screen within translational medicine, affinity selection against a target yields a pool of bound compounds, each tagged by a unique DNA barcode representing one of $10^{8}$ distinct compounds. Suppose that subsequent Next-Generation Sequencing (NGS) produces $M$ independent reads, and each read maps uniformly at random to one of the $10^{8}$ barcodes, consistent with equal representation and random sampling of amplicons (sampling with replacement and no read-to-read dependence). Consider a specific barcode corresponding to a true high-affinity ligand present in the bound pool. Using only the core definitions of independent Bernoulli trials and the binomial model for repeated independent sampling, derive the exact probability that this true high-affinity ligand is completely missed (zero occurrences) in the $M$ reads due to undersampling. Express your final result as a closed-form analytic expression in terms of $M$ and $10^{8}$. No numerical approximation is required, and no units are involved. The final answer must be a single expression.", "solution": "The problem statement will first be validated for scientific soundness, clarity, and logical consistency.\n\n### Step 1: Extract Givens\n- Total number of distinct DNA barcodes, $N$: $10^{8}$.\n- Total number of independent Next-Generation Sequencing (NGS) reads: $M$.\n- Sampling model: Each read maps uniformly at random to one of the $N$ barcodes. This constitutes sampling with replacement, and each read is an independent event.\n- Objective: Derive the exact probability that a specific, pre-determined barcode (representing a true high-affinity ligand) is observed zero times in the $M$ reads.\n- Constraint: The derivation must be based on the principles of independent Bernoulli trials and the binomial model.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is scientifically grounded. It presents a simplified but standard statistical model used in the analysis of high-throughput sequencing data, specifically in the context of DNA-encoded library (DEL) screening. The concepts of uniform random sampling, independent trials, and calculating the probability of non-detection are fundamental to bioinformatics and statistical genomics. The numbers provided ($10^{8}$ compounds, variable $M$ reads) are representative of the scale of modern DEL experiments.\n2.  **Well-Posedness**: The problem is well-posed. All necessary information is provided to construct a probability model and derive a unique solution. The parameters ($M$ and $10^8$) are clearly defined, and the question asks for a specific probability under a fully specified sampling model.\n3.  **Objectivity**: The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n\nThe problem statement does not violate any criteria for invalidity. It is a well-defined problem in applied probability, relevant to the field of translational medicine. It is not incomplete, contradictory, unrealistic, or ill-posed.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Derivation\nThe problem asks for the probability that a specific barcode is not observed in a set of $M$ independent NGS reads. This scenario can be modeled as a sequence of $M$ independent Bernoulli trials.\n\nA single Bernoulli trial is an experiment with exactly two possible outcomes: \"success\" or \"failure\". Let's define the trial and its outcomes in the context of one NGS read:\n- A single trial is the event of sequencing one read.\n- There are $N = 10^{8}$ possible barcodes a read can map to.\n- The sampling is uniform and random, so the probability of a single read mapping to any specific barcode is $\\frac{1}{N}$.\n\nLet's focus on the specific barcode of interest. We can define a \"success\" and \"failure\" for a single trial (one read) as follows:\n- **Failure**: The read maps to the specific barcode of interest.\n- **Success**: The read maps to any of the other $N-1$ barcodes.\n\nThe probability of a \"failure\" in a single trial, which we will denote by $p$, is the probability of hitting the specific barcode:\n$$p = \\frac{1}{N} = \\frac{1}{10^{8}}$$\nThe probability of a \"success\" in a single trial, which we will denote by $1-p$, is the probability of not hitting the specific barcode:\n$$1 - p = 1 - \\frac{1}{N} = 1 - \\frac{1}{10^{8}}$$\n\nThe problem asks for the probability that the specific barcode is completely missed in $M$ reads. This is equivalent to the event that we have $M$ \"successes\" (as defined above) in $M$ independent trials. Since the trials (reads) are independent, the probability of this compound event is the product of the probabilities of each individual event.\n\nLet $P(\\text{miss on all } M \\text{ reads})$ be the desired probability.\n$$P(\\text{miss on all } M \\text{ reads}) = \\underbrace{(1-p) \\times (1-p) \\times \\dots \\times (1-p)}_{M \\text{ times}}$$\n$$P(\\text{miss on all } M \\text{ reads}) = (1-p)^{M}$$\nSubstituting the value of $p$, we get:\n$$P(\\text{miss on all } M \\text{ reads}) = \\left(1 - \\frac{1}{10^{8}}\\right)^{M}$$\n\nThis result can be formally derived using the binomial distribution, as requested. The binomial distribution gives the probability of observing exactly $k$ \"failures\" (as per our initial definition of failure) in $M$ independent Bernoulli trials. Let $X$ be the random variable representing the number of times our specific barcode is observed in $M$ reads. The probability mass function for a binomial distribution is:\n$$P(X=k) = \\binom{M}{k} p^{k} (1-p)^{M-k}$$\nHere:\n- $M$ is the number of trials (reads).\n- $k$ is the number of occurrences of our specific barcode.\n- $p = \\frac{1}{10^{8}}$ is the probability of a single read mapping to our specific barcode.\n- $1-p = 1 - \\frac{1}{10^{8}}$ is the probability of a single read not mapping to our specific barcode.\n\nWe are interested in the probability of zero occurrences, so we set $k=0$.\n$$P(X=0) = \\binom{M}{0} p^{0} (1-p)^{M-0}$$\nThe components of this expression are:\n- The binomial coefficient $\\binom{M}{0} = \\frac{M!}{0!(M-0)!} = 1$.\n- The term $p^{0} = \\left(\\frac{1}{10^{8}}\\right)^{0} = 1$.\n- The term $(1-p)^{M} = \\left(1 - \\frac{1}{10^{8}}\\right)^{M}$.\n\nSubstituting these back into the formula for $P(X=0)$:\n$$P(X=0) = 1 \\cdot 1 \\cdot \\left(1 - \\frac{1}{10^{8}}\\right)^{M}$$\n$$P(X=0) = \\left(1 - \\frac{1}{10^{8}}\\right)^{M}$$\nThis is the final, closed-form analytic expression for the probability that the true high-affinity ligand is completely missed in $M$ reads.", "answer": "$$\\boxed{\\left(1 - \\frac{1}{10^{8}}\\right)^{M}}$$", "id": "5011222"}]}