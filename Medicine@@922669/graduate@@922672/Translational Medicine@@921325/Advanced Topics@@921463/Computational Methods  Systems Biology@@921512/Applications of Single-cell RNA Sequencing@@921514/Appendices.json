{"hands_on_practices": [{"introduction": "Translational studies are often constrained by significant financial and logistical resources. Therefore, robust experimental design is not just a statistical formality but a critical necessity for maximizing the likelihood of a successful outcome. This practice challenges you to step into the role of a study designer, balancing a fixed budget against key experimental parameters like the number of patients ($n_p$), cells per patient ($n_c$), and sequencing depth per cell ($r$). By modeling how these choices impact statistical power, you will learn to make principled, data-driven decisions that optimize the allocation of resources to detect a biologically meaningful effect [@problem_id:4991028].", "problem": "A translational study aims to use single-cell RNA sequencing (scRNA-seq) to detect a $1.5$-fold change in the normalized expression of a predefined gene between two balanced clinical groups (responders versus non-responders). The following design choices must be made: the number of patients per group, the number of cells per patient, and the sequencing depth per cell. The total cost must include an overhead per patient, a library preparation cost per cell, and a sequencing cost per million reads.\n\nAssume the following scientifically grounded measurement model and facts:\n\n- Unique Molecular Identifier (UMI) counts per cell for the target gene follow a Poisson sampling model based on the Central Dogma and sequencing-by-synthesis: if a cell receives $r$ million reads, the gene’s expected counts per cell is $\\theta r$ and the variance is $\\theta r$, where $\\theta$ is the expected counts per million reads per cell (counts per million, CPM).\n- The per-cell normalized expression estimate for the gene is the counts-per-million $Y/r$, which has expectation $\\theta$ and variance $\\theta/r$ due to Poisson sampling.\n- Averaging over $n_c$ cells from a patient (independently sampled and quality-controlled within a single cell type) yields a patient-level normalized estimator with measurement variance $\\theta/(r n_c)$ by the Central Limit Theorem.\n- Between-patient biological variability in the normalized expression has variance $\\sigma_b^2$ (assumed independent of sequencing depth and the number of cells sampled per patient).\n- For a two-arm balanced design with $n_p$ patients per group, the difference in group means (responders minus non-responders) has variance $2(\\sigma_b^2 + \\theta/(r n_c))/n_p$ under independence across patients and arms.\n- For a fixed Type I error rate, the statistical power of a normal-approximate two-sample test is a strictly increasing function of the noncentrality parameter, which scales as the true mean difference divided by the standard error.\n\nYou are given the following design and cost parameters:\n- Budget $B = 1.0 \\times 10^{5}$ United States dollars.\n- Overhead cost per patient $H = 5.0 \\times 10^{2}$ United States dollars.\n- Library preparation cost per cell $L = 1.0 \\times 10^{-1}$ United States dollars.\n- Sequencing cost per million reads $S = 8$ United States dollars.\n- Minimum cells per patient $n_c = 200$ cells (to ensure stable patient-level estimates).\n- Baseline expression level $\\theta = 100$ counts per million reads per cell.\n- Between-patient variance $\\sigma_b^2 = 64$ (counts per million)$^{2}$.\n\nAssume equal allocation across the two arms and treat $n_p$ and $r$ as continuous positive variables for optimization. The total cost for two arms is\n$$\nC = 2 n_p \\big(H + n_c L + n_c S r\\big),\n$$\nwhich must not exceed the budget $B$.\n\nStarting strictly from the stated measurement model and variance decomposition, and using only the above facts, derive the allocation of reads per cell $r$ that maximizes power subject to the budget constraint when the number of cells per patient is fixed at $n_c=200$. Compute the optimal $r$ in units of “million reads per cell.” Round your final numerical answer to three significant figures.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. All necessary parameters and models for a unique and meaningful solution are provided. We may therefore proceed with the derivation.\n\nThe objective is to maximize the statistical power of a two-sample test for a difference in mean gene expression between two groups. According to the problem statement, statistical power is a strictly increasing function of the noncentrality parameter, which in turn is proportional to the inverse of the standard error of the estimated difference. Maximizing power is therefore equivalent to minimizing the variance of the difference in group means.\n\nThe variance of the difference in group means, $V$, is given as:\n$$V = \\frac{2}{n_p} \\left(\\sigma_b^2 + \\frac{\\theta}{r n_c}\\right)$$\nwhere $n_p$ is the number of patients per group, $\\sigma_b^2$ is the between-patient biological variance, $\\theta$ is the baseline expression level, $r$ is the sequencing depth per cell in million reads, and $n_c$ is the number of cells per patient.\n\nThis optimization is subject to a total budget constraint, $C \\le B$. To maximize power, we must utilize the entire budget, so the constraint becomes an equality:\n$$C = 2 n_p \\big(H + n_c L + n_c S r\\big) = B$$\nHere, $B$ is the total budget, $H$ is the overhead cost per patient, $L$ is the library preparation cost per cell, and $S$ is the sequencing cost per million reads.\n\nThe number of cells per patient is fixed at $n_c = 200$. The variables to be optimized are $n_p$ and $r$. We can express $n_p$ in terms of $r$ using the budget constraint:\n$$n_p = \\frac{B}{2 \\big(H + n_c L + n_c S r\\big)}$$\nSubstituting this expression for $n_p$ into the variance equation $V$ allows us to formulate the variance as a function of a single variable, $r$:\n$$V(r) = \\frac{2}{\\frac{B}{2 \\big(H + n_c L + n_c S r\\big)}} \\left(\\sigma_b^2 + \\frac{\\theta}{r n_c}\\right)$$\n$$V(r) = \\frac{4}{B} \\big(H + n_c L + n_c S r\\big) \\left(\\sigma_b^2 + \\frac{\\theta}{r n_c}\\right)$$\nTo find the value of $r$ that minimizes $V(r)$, we can equivalently minimize the function $f(r) = \\frac{B}{4} V(r)$, as $\\frac{4}{B}$ is a positive constant.\n$$f(r) = \\big(H + n_c L + n_c S r\\big) \\left(\\sigma_b^2 + \\frac{\\theta}{r n_c}\\right)$$\nWe expand this expression:\n$$f(r) = (H + n_c L)\\sigma_b^2 + \\frac{(H + n_c L)\\theta}{r n_c} + (n_c S r)\\sigma_b^2 + \\frac{(n_c S r)\\theta}{r n_c}$$\n$$f(r) = (H + n_c L)\\sigma_b^2 + \\frac{(H + n_c L)\\theta}{r n_c} + n_c S \\sigma_b^2 r + S \\theta$$\nTo find the minimum, we compute the first derivative of $f(r)$ with respect to $r$ and set it to zero.\n$$\\frac{df}{dr} = \\frac{d}{dr} \\left[ (H + n_c L)\\sigma_b^2 + S \\theta + n_c S \\sigma_b^2 r + \\frac{(H + n_c L)\\theta}{n_c} r^{-1} \\right]$$\n$$\\frac{df}{dr} = n_c S \\sigma_b^2 - \\frac{(H + n_c L)\\theta}{n_c r^2}$$\nSetting the derivative to zero yields the optimal value of $r$:\n$$n_c S \\sigma_b^2 = \\frac{(H + n_c L)\\theta}{n_c r^2}$$\n$$r^2 = \\frac{(H + n_c L)\\theta}{(n_c)^2 S \\sigma_b^2}$$\nSince $r$ must be positive, we take the positive root:\n$$r_{opt} = \\sqrt{\\frac{(H + n_c L)\\theta}{(n_c)^2 S \\sigma_b^2}} = \\frac{1}{n_c} \\sqrt{\\frac{(H + n_c L)\\theta}{S \\sigma_b^2}}$$\nTo confirm this is a minimum, we examine the second derivative:\n$$\\frac{d^2f}{dr^2} = \\frac{2(H + n_c L)\\theta}{n_c r^3}$$\nGiven that all parameters ($H$, $n_c$, $L$, $\\theta$) are positive, and $r > 0$, the second derivative is positive, which confirms that $r_{opt}$ corresponds to a minimum of the variance function.\n\nNow, we substitute the given numerical values:\n- $H = 5.0 \\times 10^2 = 500$\n- $L = 1.0 \\times 10^{-1} = 0.1$\n- $S = 8$\n- $n_c = 200$\n- $\\theta = 100$\n- $\\sigma_b^2 = 64$\n\nWe calculate the terms in the expression for $r_{opt}$:\n$$H + n_c L = 500 + 200 \\times 0.1 = 500 + 20 = 520$$\n$$S \\sigma_b^2 = 8 \\times 64 = 512$$\nSubstituting these into the equation for $r_{opt}$:\n$$r_{opt} = \\frac{1}{200} \\sqrt{\\frac{520 \\times 100}{512}} = \\frac{1}{200} \\sqrt{\\frac{52000}{512}}$$\n$$r_{opt} = \\frac{1}{200} \\sqrt{101.5625}$$\n$$r_{opt} = \\frac{10.0778125...}{200} \\approx 0.05038906...$$\nThe problem requires the answer to be rounded to three significant figures. The first three significant figures are $5$, $0$, and $3$. The following digit is $8$, so we round up the third significant figure.\n$$r_{opt} \\approx 0.0504$$\nThe optimal sequencing depth is $0.0504$ million reads per cell.", "answer": "$$\n\\boxed{0.0504}\n$$", "id": "4991028"}, {"introduction": "While droplet-based single-cell technologies enable massive throughput, they introduce specific technical artifacts that must be understood and controlled. One of the most common is the formation of 'doublets,' where two or more cells are encapsulated in the same droplet, leading to a mixed transcriptomic signal that can corrupt downstream analyses like cell-type identification. This exercise applies the Poisson distribution, a cornerstone model for random, independent events, to predict the doublet rate as a function of the mean cell loading density, $\\lambda$. Mastering this calculation provides the theoretical foundation for making a critical trade-off between cell throughput and data purity in your own experiments [@problem_id:4990977].", "problem": "A translational oncology study is deploying droplet-based single-cell RNA sequencing (scRNA-seq; single-cell Ribonucleic Acid sequencing) to profile tumor-infiltrating immune cells from patient biopsies. To limit artifacts in cell-type inference, the team needs to estimate the expected doublet rate under standard microfluidic loading, which assumes independent cell capture events per droplet and low occupancy such that the number of cells per droplet follows a Poisson distribution with mean $\\lambda$ cells per droplet.\n\nStarting from the definition of the Poisson probability mass function for occupancy, and using the interpretation that a doublet is any droplet with at least two captured cells, derive the expected doublet probability for a Poisson mean $\\lambda$. Then, for a run tuned to $\\lambda = 0.08$, compute the numerical value of this probability.\n\nRound your final numerical answer to four significant figures. Express the answer as a decimal number without a percent sign and without any units.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the standard Poisson model for cell loading in droplet-based microfluidics, a cornerstone of single-cell sequencing analysis. The problem is well-posed, providing all necessary definitions (Poisson distribution, doublet definition), parameters ($\\lambda$), and constraints (rounding) to arrive at a unique, meaningful solution. The language is objective and the scenario is realistic within the field of translational medicine.\n\nLet $K$ be the random variable representing the number of cells captured in a single droplet. According to the problem statement, $K$ follows a Poisson distribution with mean $\\lambda$. The probability mass function (PMF) for $K$ is given by:\n$$P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\nwhere $k$ is a non-negative integer ($k=0, 1, 2, \\dots$), representing the number of cells in a droplet.\n\nA \"doublet\" is defined as any droplet containing at least two cells. This corresponds to the event $K \\geq 2$. The probability of this event, which we denote as $P_{\\text{doublet}}$, is what we need to derive.\n$$P_{\\text{doublet}} = P(K \\geq 2)$$\n\nCalculating this probability directly would involve an infinite sum: $P(K=2) + P(K=3) + P(K=4) + \\dots$. It is more straightforward to use the complement rule. The sum of probabilities for all possible outcomes must be $1$:\n$$\\sum_{k=0}^{\\infty} P(K=k) = P(K=0) + P(K=1) + P(K=2) + \\dots = 1$$\nTherefore, the probability of having at least two cells is $1$ minus the probability of having fewer than two cells:\n$$P(K \\geq 2) = 1 - P(K < 2)$$\nThe event $K < 2$ consists of two mutually exclusive outcomes: having zero cells ($K=0$) or having exactly one cell ($K=1$).\n$$P(K < 2) = P(K=0) + P(K=1)$$\nWe can calculate these two probabilities using the Poisson PMF:\nThe probability of a droplet being empty ($k=0$) is:\n$$P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)$$\nThe probability of a droplet containing a single cell (a \"singlet\", $k=1$) is:\n$$P(K=1) = \\frac{\\lambda^1 \\exp(-\\lambda)}{1!} = \\frac{\\lambda \\exp(-\\lambda)}{1} = \\lambda \\exp(-\\lambda)$$\nSubstituting these into the expression for $P(K < 2)$:\n$$P(K < 2) = \\exp(-\\lambda) + \\lambda \\exp(-\\lambda) = (1+\\lambda)\\exp(-\\lambda)$$\nFinally, we can derive the general expression for the expected doublet probability:\n$$P_{\\text{doublet}} = 1 - P(K < 2) = 1 - (1+\\lambda)\\exp(-\\lambda)$$\nThis completes the first part of the problem.\n\nFor the second part, we are asked to compute the numerical value of this probability for a run tuned to a mean occupancy of $\\lambda = 0.08$. We substitute this value into the derived formula:\n$$P_{\\text{doublet}} = 1 - (1+0.08)\\exp(-0.08)$$\n$$P_{\\text{doublet}} = 1 - 1.08 \\exp(-0.08)$$\nNow, we compute the numerical value:\n$$\\exp(-0.08) \\approx 0.923116346$$\n$$P_{\\text{doublet}} \\approx 1 - 1.08 \\times 0.923116346$$\n$$P_{\\text{doublet}} \\approx 1 - 0.996965654$$\n$$P_{\\text{doublet}} \\approx 0.003034346$$\nThe problem requires rounding the final answer to four significant figures. The first significant figure in $0.003034346$ is $3$. The first four significant figures are $3$, $0$, $3$, and $4$. The fifth significant figure is $3$. Since $3 < 5$, we round down, which means we keep the fourth significant figure as is.\nThe rounded numerical value is $0.003034$.", "answer": "$$\n\\boxed{0.003034}\n$$", "id": "4990977"}, {"introduction": "The raw output of a modern scRNA-seq experiment is a digital count matrix, but not all variation in these counts is biologically meaningful. To correctly interpret this data, it is crucial to understand the fundamental statistical processes that generate it. This problem guides you through a first-principles derivation of the expected number of molecules detected per cell and, more importantly, uses the law of total variance to formally dissect the observed variability. You will learn to distinguish the true biological heterogeneity in mRNA content between cells from the technical 'sampling noise' that arises from the probabilistic nature of molecular capture [@problem_id:4991002].", "problem": "A translational medicine team plans to deploy single-cell RNA sequencing (scRNA-seq) using a three-prime ($3'$) counting assay to quantify transcriptional states across patient-derived tumor cells before and after therapy. In this workflow, each messenger ribonucleic acid (mRNA) molecule present in a cell is independently captured, reverse transcribed, and assigned a Unique Molecular Identifier (UMI), after which Polymerase Chain Reaction (PCR) amplification and sequencing are performed. Define the capture efficiency as the per-molecule probability that an mRNA present in a cell is successfully converted into a UMI-observable complementary deoxyribonucleic acid (cDNA) molecule. Assume:\n- Each cell contains on average $10{,}000$ mRNA molecules.\n- The capture efficiency is $10\\%$.\n- Sequencing depth is saturating so that every captured molecule is observed at least once.\n- The UMI space is sufficiently large that UMI collisions are negligible at the cell-wide level.\n\nUsing only first principles of probabilistic sampling from independent trials and the definition that a $3'$ counting assay yields at most one UMI per successfully captured original mRNA molecule, estimate the expected number of detected UMIs per cell. Then, briefly explain, from first principles and using symbolic expressions where appropriate, at least two distinct sources of variance in detected UMI counts across nominally identical cells, identifying their mechanistic origins and how they contribute via the law of total variance.\n\nProvide your expected value as a single number with no units and do not round.", "solution": "The problem is scientifically grounded, well-posed, and all necessary parameters for the calculation of the expected value are provided. The assumptions are standard simplifications used in modeling single-cell sequencing experiments. Therefore, the problem is valid.\n\nThe first task is to estimate the expected number of detected Unique Molecular Identifiers (UMIs) per cell.\nLet $N$ be the random variable representing the total number of messenger ribonucleic acid (mRNA) molecules in a single cell. The problem states that the average number of mRNA molecules per cell is $10{,}000$. This corresponds to the expected value of $N$.\n$$E[N] = 10000$$\nLet $p$ be the capture efficiency, defined as the per-molecule probability that an mRNA is successfully captured and converted into an observable complementary deoxyribonucleic acid (cDNA) molecule. The problem states this efficiency is $10\\%$.\n$$p = 0.10$$\nThe problem states that the process involves independent capture trials for each mRNA molecule. For a single cell containing exactly $n$ mRNA molecules, the capture process can be modeled as a series of $n$ independent Bernoulli trials, where the probability of success (capture) for each trial is $p$.\nLet $U$ be the random variable representing the number of detected UMIs in a cell. The problem's assumptions—that sequencing depth is saturating, UMI collisions are negligible, and a $3'$ assay yields at most one UMI per captured mRNA—imply that the number of detected UMIs is exactly equal to the number of successfully captured mRNA molecules.\nFor a cell with a fixed number of molecules $N=n$, the number of detected UMIs, $U$, follows a binomial distribution:\n$$U | (N=n) \\sim \\text{Binomial}(n, p)$$\nThe expected number of UMIs for a cell with exactly $n$ molecules is the expectation of this binomial distribution:\n$$E[U | N=n] = n p$$\nHowever, the number of mRNA molecules, $N$, is itself a random variable that varies from cell to cell, with a known mean $E[N]$. To find the overall expected number of UMIs per cell, we must use the law of total expectation (also known as the tower property), which states $E[U] = E[E[U|N]]$.\nFirst, we find the conditional expectation $E[U|N]$, which is a function of the random variable $N$:\n$$E[U|N] = N p$$\nNext, we take the expectation of this expression with respect to the distribution of $N$:\n$$E[U] = E[Np]$$\nSince $p$ is a constant, it can be factored out of the expectation:\n$$E[U] = p E[N]$$\nSubstituting the given values:\n$$E[U] = 0.10 \\times 10000 = 1000$$\nThe expected number of detected UMIs per cell is $1000$.\n\nThe second task is to explain at least two distinct sources of variance in detected UMI counts across nominally identical cells and relate them to the law of total variance.\nThe law of total variance states that for two random variables $U$ and $N$, the variance of $U$ can be decomposed as:\n$$\\text{Var}(U) = E[\\text{Var}(U|N)] + \\text{Var}(E[U|N])$$\nThis equation provides a framework for identifying the two primary sources of variance in UMI counts.\n\nSource 1: Technical Variance from the Sampling Process.\nThis source of variance is represented by the first term in the law of total variance, $E[\\text{Var}(U|N)]$.\n- **Mechanistic Origin:** This variance arises from the stochastic nature of the molecular capture process. For a cell with a fixed number of mRNA molecules, $N=n$, the capture of each molecule is a random event. Not every molecule will be captured, and the specific subset of molecules that are captured will vary randomly from one identical experiment to another. This is an inherent technical limitation of a probabilistic sampling process.\n- **Mathematical Contribution:** For a fixed $N=n$, the conditional distribution of $U$ is $\\text{Binomial}(n,p)$. The variance of this distribution is $\\text{Var}(U|N=n) = n p (1-p)$. Therefore, the conditional variance as a function of the random variable $N$ is $\\text{Var}(U|N) = N p (1-p)$. The contribution to total variance is the expectation of this term: $E[\\text{Var}(U|N)] = E[N p (1-p)] = E[N]p(1-p)$. This component is often called \"sampling noise\" or \"shot noise\" and is directly related to the count-based nature of the data.\n\nSource 2: Biological Variance in Cellular mRNA Content.\nThis source of variance is represented by the second term in the law of total variance, $\\text{Var}(E[U|N])$.\n- **Mechanistic Origin:** This variance arises from the true biological heterogeneity among the cell population. Even \"nominally identical\" cells are not truly identical. They differ in size, metabolic activity, cell cycle stage, and stochastic gene expression, all of which lead to cell-to-cell differences in the total number of mRNA molecules, $N$. This pre-existing biological variation in the input material is a key signal that scRNA-seq experiments often aim to characterize.\n- **Mathematical Contribution:** We previously established that the conditional expectation is $E[U|N] = Np$. This term represents the \"true\" signal from a cell (its mRNA content, $N$) as scaled by the technical efficiency ($p$). The variance of this term, $\\text{Var}(E[U|N]) = \\text{Var}(Np)$, captures how the biological variance in $N$ propagates to the observed UMI counts. Since $p$ is a constant, this becomes $\\text{Var}(E[U|N]) = p^2 \\text{Var}(N)$. This term shows that the biological variance, $\\text{Var}(N)$, contributes to the observed variance, but its effect is attenuated by the square of the capture efficiency.\n\nIn summary, the total observed variance in UMI counts, $\\text{Var}(U)$, is the sum of a technical component, $E[N]p(1-p)$, which is noise from the measurement process, and a biological component, $p^2 \\text{Var}(N)$, which reflects the true heterogeneity in the cell population.", "answer": "$$\\boxed{1000}$$", "id": "4991002"}]}