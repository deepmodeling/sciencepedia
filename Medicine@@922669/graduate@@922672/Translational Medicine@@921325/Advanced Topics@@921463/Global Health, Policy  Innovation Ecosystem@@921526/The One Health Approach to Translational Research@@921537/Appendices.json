{"hands_on_practices": [{"introduction": "Understanding the One Health approach begins with quantifying the fundamental event of zoonotic disease: the transmission of a pathogen from an animal reservoir to a human. This exercise challenges you to derive the rate of spillover from first principles, connecting core epidemiological parameters like population size, prevalence, contact rates, and transmission probability. By calculating the expected number of cross-species transmission events, you will build a foundational tool for quantitative risk assessment at the human-animal interface [@problem_id:5069077].", "problem": "A zoonotic respiratory pathogen is undergoing early spillover surveillance in a peri-urban interface under the One Health (OH) approach, which integrates human, domestic animal, and wildlife health. Consider two host species: humans, denoted by $H$, and bats, denoted by $B$. The contact matrix entry $C_{ij}$ is defined as the per-source-individual rate of potentially infectious contacts from species $i$ to species $j$, measured in contacts per individual per day. Assume contacts follow a memoryless process and each contact independently results in pathogen transfer with per-contact transmission probability $q$. Let $N_{i}$ be the total population size of species $i$, and $p_{i}$ be the fraction of infectious individuals in species $i$.\n\nYou are given the following scenario data for the $B \\to H$ direction: $N_{B} = 30{,}000$, $p_{B} = 0.003$, $C_{BH} = 0.025~\\text{day}^{-1}$, and $q = 0.06$. Starting from the core definitions of contact rate and per-contact transmission probability, derive an expression for the expected number of cross-species transmission events per unit time from bats to humans in the early phase when $p_{B}$ is small. Use your derivation to compute the expected number of successful $B \\to H$ transmission events per day. Round your final numerical answer to four significant figures and express it in events per day.", "solution": "The problem is first validated against the established criteria.\n\n### Step 1: Extract Givens\n- Host species: Humans ($H$), Bats ($B$).\n- $C_{ij}$: The per-source-individual rate of potentially infectious contacts from species $i$ to species $j$, measured in contacts per individual per day.\n- $q$: The per-contact transmission probability.\n- $N_{i}$: The total population size of species $i$.\n- $p_{i}$: The fraction of infectious individuals in species $i$.\n- Contact process: Memoryless, with each contact being an independent event for transmission.\n- Scenario data for $B \\to H$ transmission:\n  - $N_{B} = 30,000$\n  - $p_{B} = 0.003$\n  - $C_{BH} = 0.025~\\text{day}^{-1}$\n  - $q = 0.06$\n- Objective: Derive an expression for the expected number of cross-species transmission events per unit time from bats to humans, and then compute this value per day.\n- Rounding: The final numerical answer must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is examined for validity.\n- **Scientific Grounding**: The problem employs standard concepts from mathematical epidemiology, such as contact rates, prevalence, population size, and transmission probability. The framework of a One Health approach to zoonotic spillover is a well-established concept in public health and translational medicine. The given parameters are hypothetical but lie within a plausible range for an early-stage zoonotic event. The problem is scientifically sound.\n- **Well-Posedness**: The problem clearly defines all variables and provides all necessary data to compute the required quantity. The objective is unambiguous, and a unique, meaningful solution can be determined.\n- **Objectivity**: The language is precise and technical, free of subjective or opinion-based assertions.\n- **Consistency and Completeness**: The problem is self-contained. The provided data are consistent with one another and sufficient for the derivation and calculation. There are no contradictions or missing pieces of critical information. The statement that $p_B$ is small is consistent with the value $p_B = 0.003$.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A reasoned solution will be provided.\n\n### Derivation and Solution\nThe objective is to derive an expression for the expected number of successful cross-species transmission events from the bat population ($B$) to the human population ($H$) per unit time. We denote this quantity by $\\Lambda_{BH}$. The derivation proceeds from the fundamental definitions provided.\n\n1.  **Number of Infectious Source Individuals**: The total population of bats is $N_{B}$, and the fraction of infectious bats is $p_{B}$. Therefore, the absolute number of infectious bats, $I_{B}$, capable of transmitting the pathogen is the product of these two quantities:\n    $$I_{B} = N_{B} p_{B}$$\n\n2.  **Total Rate of Cross-Species Contacts**: The term $C_{BH}$ is defined as the per-source-individual rate of contacts from species $B$ to species $H$. This means a single bat makes $C_{BH}$ contacts with the human population per day. To find the total rate of contacts originating from the entire infectious bat population, we multiply the number of infectious bats, $I_{B}$, by the per-individual contact rate, $C_{BH}$.\n    $$\\text{Total contact rate} = I_{B} \\times C_{BH} = (N_{B} p_{B}) C_{BH}$$\n    The units of this expression are $(\\text{individuals}) \\times (\\frac{\\text{contacts}}{\\text{individual} \\cdot \\text{day}}) = \\frac{\\text{contacts}}{\\text{day}}$. This represents the total number of potentially infectious contacts from the bat population to the human population per day.\n\n3.  **Expected Number of Transmission Events**: Each contact is an independent opportunity for transmission, with a success probability of $q$. Since the contact process is memoryless, the total number of transmission events can be modeled as a sequence of Bernoulli trials. The expected number of successes (transmissions) is the total number of trials (contacts) multiplied by the probability of success per trial ($q$).\n    Therefore, the expected number of new infections in humans per day, $\\Lambda_{BH}$, is:\n    $$\\Lambda_{BH} = (\\text{Total contact rate}) \\times q$$\n    Substituting the expression from the previous step, we arrive at the final derived expression:\n    $$\\Lambda_{BH} = N_{B} p_{B} C_{BH} q$$\n\nThis expression represents the expected number of cross-species transmission events per unit time from bats to humans.\n\nNow, we substitute the given numerical values into this expression to compute the specific rate for the scenario.\n- $N_{B} = 30,000$\n- $p_{B} = 0.003$\n- $C_{BH} = 0.025~\\text{day}^{-1}$\n- $q = 0.06$\n\nFirst, calculate the number of infectious bats:\n$$I_{B} = 30,000 \\times 0.003 = 90$$\nSo there are $90$ infectious bats.\n\nNext, calculate the total rate of potentially infectious contacts per day:\n$$\\text{Total contact rate} = 90 \\times 0.025~\\text{day}^{-1} = 2.25~\\text{day}^{-1}$$\n\nFinally, calculate the expected number of successful transmission events per day:\n$$\\Lambda_{BH} = 2.25~\\text{day}^{-1} \\times 0.06 = 0.135~\\text{day}^{-1}$$\n\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $0.135$. To express this with four significant figures, we add a trailing zero.\n$$\\Lambda_{BH} \\approx 0.1350~\\text{events per day}$$", "answer": "$$\\boxed{0.1350}$$", "id": "5069077"}, {"introduction": "Beyond direct contact, the environment forms a critical nexus for pathogen transmission, linking human and animal populations. This practice moves into the domain of environmental health, asking you to model the fate and transport of a waterborne pathogen along a river. You will derive the classic advection-decay partial differential equation from mass conservation principles and use its solution to predict downstream pathogen concentrations, a key skill for designing and interpreting environmental surveillance systems [@problem_id:5069008].", "problem": "A translational medicine team using the One Health framework needs a mathematically principled tool to propagate waterborne pathogen signals measured at an upstream environmental surveillance station to downstream communities. Consider a one-dimensional river reach with constant flow speed $u$ and first-order net loss rate $\\delta$ that aggregates inactivation, predation, and other attenuation processes. Let $V(x,t)$ denote the pathogen genome concentration in genome copies per liter (gc/L) at position $x$ (in kilometers) and time $t$ (in hours). Assume spatially uniform $u$ and $\\delta$, negligible dispersion relative to advection, and a semi-infinite domain $x \\ge 0$. Assume an initially clean river, $V(x,0)=0$ for all $x \\ge 0$, and a prescribed upstream boundary concentration time-series $V(0,t)=V_{\\text{in}}(t)$ for $t \\ge 0$. Angles in any trigonometric function must be provided in radians.\n\nStarting only from conservation of mass in a control volume and the assumption of first-order loss, derive the governing one-dimensional advection–decay partial differential equation and then solve it for $V(x,t)$ using appropriate characteristic curves and boundary data. Show that your solution respects causality (no upstream influence arrives before the advective travel time) and quantify explicitly how decay attenuates the signal with travel time. Use this principled solution to compute specific downstream concentrations for the test suite defined below.\n\nFundamental base to use:\n- Conservation of mass for a scalar concentration field transported by advection and subject to first-order decay.\n- Method of characteristics for first-order linear partial differential equations.\n\nYour program must implement your derived solution to compute the downstream concentration $V(x,t)$ for each test case. For all outputs, express concentration values in genome copies per liter (gc/L) as decimal numbers, rounded to six decimal places. Do not print the unit string; just print the numeric values. If the solution implies zero concentration before advective arrival, output $0.000000$.\n\nTest suite to evaluate:\n- Case $1$ (step inflow, general case): $u=5$ km/h, $\\delta=0.2$ h$^{-1}$, $x=10$ km, $t=5$ h, $V_{\\text{in}}(t)=V_0$ for $t \\ge 0$ with $V_0=1000$ gc/L.\n- Case $2$ (no decay edge case): $u=10$ km/h, $\\delta=0$, $x=15$ km, $t=2$ h, $V_{\\text{in}}(t)=V_0$ for $t \\ge 0$ with $V_0=500$ gc/L.\n- Case $3$ (pre-arrival causality edge case): $u=10$ km/h, $\\delta=0.1$ h$^{-1}$, $x=25$ km, $t=1$ h, $V_{\\text{in}}(t)=V_0$ for $t \\ge 0$ with $V_0=200$ gc/L.\n- Case $4$ (finite-duration rectangular pulse): $u=3$ km/h, $\\delta=0.35$ h$^{-1}$, $x=6$ km, $t=3$ h, $V_{\\text{in}}(t)=V_0$ for $0 \\le t \\le \\tau$ and $0$ otherwise, with $V_0=100$ gc/L and $\\tau=2$ h.\n- Case $5$ (diurnally varying inflow in radians): $u=6$ km/h, $\\delta=0.05$ h$^{-1}$, $x=12$ km, $t=5$ h, $V_{\\text{in}}(t)=A + B \\sin(\\omega t)$ with $A=500$ gc/L, $B=500$ gc/L, and $\\omega=2\\pi/24$ rad/h.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[v_1,v_2,v_3,v_4,v_5]$, where each $v_i$ is the downstream concentration value for Case $i$, rounded to six decimal places as specified. Angles must be evaluated in radians, and all computations use the specified units without conversion.", "solution": "The user-provided problem is evaluated as scientifically sound, well-posed, objective, and self-contained. It is a canonical problem in transport phenomena, grounded in the fundamental principle of mass conservation. The parameters and conditions are physically realistic and mathematically sufficient for deriving a unique, stable, and meaningful solution. The problem is therefore deemed valid.\n\nThe solution is developed in three stages: first, the governing partial differential equation (PDE) is derived from the principle of mass conservation; second, the PDE is solved using the method of characteristics subject to the specified initial and boundary conditions; and third, the derived analytical solution is used to compute the results for the provided test cases.\n\n**1. Derivation of the Governing Advection-Decay Equation**\n\nWe start from the principle of conservation of mass for the pathogen concentration, $V(x,t)$, within a one-dimensional river section. Let us consider an infinitesimal control volume (CV) of length $\\Delta x$ located between positions $x$ and $x+\\Delta x$. Let the cross-sectional area of the river be a constant $A_c$.\n\nThe total mass of the pathogen within this CV is given by the integral of the concentration over the volume:\n$$ M(t) = \\int_{x}^{x+\\Delta x} A_c V(x', t) \\, dx' $$\n\nThe rate of change of this mass over time is $\\frac{dM}{dt}$. According to the principle of mass conservation, this rate of change must equal the rate of mass entering the CV minus the rate of mass leaving the CV, plus any sources or sinks within the volume.\n$$ \\frac{dM}{dt} = (\\text{Mass Flux In}) - (\\text{Mass Flux Out}) - (\\text{Mass Loss Rate}) $$\n\nBringing the time derivative inside the integral (Leibniz integral rule for fixed boundaries) gives:\n$$ \\frac{dM}{dt} = \\int_{x}^{x+\\Delta x} A_c \\frac{\\partial V(x', t)}{\\partial t} \\, dx' $$\n\nThe transport of pathogens is governed by advection with a constant flow speed $u$. The mass flux (mass per unit time) at any position is the product of concentration, flow speed, and cross-sectional area.\n- Mass Flux In at $x$: $J(x,t) = A_c u V(x,t)$\n- Mass Flux Out at $x+\\Delta x$: $J(x+\\Delta x, t) = A_c u V(x+\\Delta x, t)$\n\nThe pathogen concentration also decreases due to a first-order net loss process with rate constant $\\delta$. The rate of mass loss within the CV is proportional to the local concentration, integrated over the volume:\n$$ \\text{Mass Loss Rate} = \\int_{x}^{x+\\Delta x} A_c \\delta V(x', t) \\, dx' $$\n\nSubstituting these terms into the mass balance equation:\n$$ \\int_{x}^{x+\\Delta x} A_c \\frac{\\partial V(x', t)}{\\partial t} \\, dx' = A_c u V(x,t) - A_c u V(x+\\Delta x, t) - \\int_{x}^{x+\\Delta x} A_c \\delta V(x', t) \\, dx' $$\n\nSince the cross-sectional area $A_c$ is constant and non-zero, it can be cancelled from all terms. We then divide the entire equation by $\\Delta x$:\n$$ \\frac{1}{\\Delta x} \\int_{x}^{x+\\Delta x} \\frac{\\partial V(x', t)}{\\partial t} \\, dx' = -u \\left( \\frac{V(x+\\Delta x, t) - V(x, t)}{\\Delta x} \\right) - \\frac{1}{\\Delta x} \\int_{x}^{x+\\Delta x} \\delta V(x', t) \\, dx' $$\n\nTaking the limit as $\\Delta x \\to 0$:\n- The left-hand term, by the Mean Value Theorem for Integrals, becomes $\\frac{\\partial V(x, t)}{\\partial t}$.\n- The first term on the right-hand side becomes, by the definition of the partial derivative, $-u \\frac{\\partial V(x, t)}{\\partial x}$.\n- The second term on the right-hand side, also by the Mean Value Theorem for Integrals, becomes $-\\delta V(x, t)$.\n\nCombining these results yields the one-dimensional advection-decay equation:\n$$ \\frac{\\partial V}{\\partial t} = -u \\frac{\\partial V}{\\partial x} - \\delta V $$\nRearranging to the standard form gives the governing PDE:\n$$ \\frac{\\partial V}{\\partial t} + u \\frac{\\partial V}{\\partial x} = -\\delta V $$\n\n**2. Solution by the Method of Characteristics**\n\nThe PDE is a first-order linear hyperbolic equation. We solve it using the method of characteristics. The goal is to find curves in the $(x,t)$ plane along which the PDE simplifies to an ordinary differential equation (ODE).\n\nConsider a trajectory $(x(s), t(s))$ parameterized by $s$. The total derivative of $V$ along this trajectory is:\n$$ \\frac{dV}{ds} = \\frac{\\partial V}{\\partial t} \\frac{dt}{ds} + \\frac{\\partial V}{\\partial x} \\frac{dx}{ds} $$\n\nComparing this with the governing PDE, we define the characteristic curves by the system of ODEs:\n$$ \\frac{dt}{ds} = 1 $$\n$$ \\frac{dx}{ds} = u $$\nBy this choice, the PDE simplifies to:\n$$ \\frac{dV}{ds} = -\\delta V $$\n\nWe can solve this system. Choosing $s=t$ without loss of generality (by setting the integration constant to $0$ in $t=s+c_1$):\n- $\\frac{dx}{dt} = u \\implies x(t) = ut + C_1$. These are the characteristic lines.\n- $\\frac{dV}{dt} = -\\delta V \\implies V(t) = C_2 e^{-\\delta t}$. This describes how $V$ changes along a characteristic line.\n\nTo find the solution at a point $(x,t)$, we trace the characteristic line passing through it back to where its value is known from the initial or boundary conditions. The characteristic line is given by $x - ut = \\text{constant}$.\n\nThe domain is $x \\ge 0$ and $t \\ge 0$. The conditions are $V(x,0)=0$ (initial condition) and $V(0,t)=V_{\\text{in}}(t)$ (boundary condition).\n\nFor any point $(x,t)$ in the domain, we must determine if its characteristic originates from the $t=0$ axis or the $x=0$ axis.\nThe advective travel time from the upstream boundary at $x=0$ to a position $x$ is $\\tau_{travel} = x/u$.\n\nCase I: $t \\le x/u$.\nThe characteristic line passing through $(x,t)$ is $X(\\tau) = x - u(t-\\tau)$. At $\\tau=0$, this line intersects the $x$-axis at $X(0) = x - ut \\ge 0$. Thus, the characteristic originates from the initial condition line ($t=0$). The value of $V$ at $(x,t)$ is determined by its value at $(x-ut, 0)$, attenuated over the time interval of length $t$.\n$$ V(x,t) = V(x-ut, 0) \\cdot e^{-\\delta t} $$\nGiven the initial condition $V(x,0)=0$, the solution in this region is:\n$$ V(x,t) = 0 \\quad \\text{for } t \\le x/u $$\nThis result demonstrates causality: no signal can reach position $x$ before the advective travel time has elapsed.\n\nCase II: $t  x/u$.\nThe characteristic line passing through $(x,t)$ must originate from the boundary at $x=0$. To find the time of origin, $t_0$, we set $X(t_0)=0$ on the characteristic line equation: $0 = x - u(t - t_0)$. Solving for $t_0$ gives $t_0 = t - x/u$. Since $tx/u$, we have $t_0  0$, confirming the origin is on the positive $t$-axis.\nThe value of $V$ at $(x,t)$ is determined by its boundary value at $(0, t_0)$, which is $V(0, t_0) = V_{\\text{in}}(t_0)$, attenuated over the travel time $t-t_0 = x/u$.\n$$ V(x,t) = V(0, t_0) \\cdot e^{-\\delta (t-t_0)} = V_{\\text{in}}(t - x/u) \\cdot e^{-\\delta (x/u)} $$\nThe solution is thus the input signal at the source, delayed by the travel time $t_0 = t - x/u$, and its amplitude is attenuated by the factor $e^{-\\delta(x/u)}$, which depends on the decay rate $\\delta$ and the travel time $x/u$.\n\nCombining both cases, the general solution is:\n$$\nV(x,t) = \\begin{cases}\n    0  \\text{if } t \\le x/u \\\\\n    V_{\\text{in}}(t - x/u) \\cdot e^{-\\delta (x/u)}  \\text{if } t  x/u\n\\end{cases}\n$$\n\n**3. Application to Test Cases**\n\nThe derived formula is applied to each test case.\n\n- **Case 1:** $u=5$ km/h, $\\delta=0.2$ h$^{-1}$, $x=10$ km, $t=5$ h, $V_{\\text{in}}(t')=1000$ for $t' \\ge 0$.\n  - Travel time $\\tau_{travel} = x/u = 10/5 = 2$ h.\n  - Since $t=5  \\tau_{travel}=2$, we use the second part of the solution.\n  - Time of origin $t_0 = t - \\tau_{travel} = 5 - 2 = 3$ h.\n  - $V_{\\text{in}}(3) = 1000$.\n  - $V(10,5) = 1000 \\cdot e^{-0.2 \\cdot (10/5)} = 1000 \\cdot e^{-0.4} \\approx 670.320046$ gc/L.\n\n- **Case 2:** $u=10$ km/h, $\\delta=0$ h$^{-1}$, $x=15$ km, $t=2$ h, $V_{\\text{in}}(t')=500$ for $t' \\ge 0$.\n  - Travel time $\\tau_{travel} = x/u = 15/10 = 1.5$ h.\n  - Since $t=2  \\tau_{travel}=1.5$, we proceed.\n  - Time of origin $t_0 = t - \\tau_{travel} = 2 - 1.5 = 0.5$ h.\n  - $V_{\\text{in}}(0.5) = 500$.\n  - $V(15,2) = 500 \\cdot e^{-0 \\cdot (15/10)} = 500 \\cdot e^{0} = 500$ gc/L.\n\n- **Case 3:** $u=10$ km/h, $\\delta=0.1$ h$^{-1}$, $x=25$ km, $t=1$ h, $V_{\\text{in}}(t')=200$ for $t' \\ge 0$.\n  - Travel time $\\tau_{travel} = x/u = 25/10 = 2.5$ h.\n  - Since $t=1 \\le \\tau_{travel}=2.5$, the wavefront has not yet arrived.\n  - $V(25,1) = 0$ gc/L.\n\n- **Case 4:** $u=3$ km/h, $\\delta=0.35$ h$^{-1}$, $x=6$ km, $t=3$ h, $V_{\\text{in}}(t')=100$ for $0 \\le t' \\le 2$ h, $0$ otherwise.\n  - Travel time $\\tau_{travel} = x/u = 6/3 = 2$ h.\n  - Since $t=3  \\tau_{travel}=2$, we proceed.\n  - Time of origin $t_0 = t - \\tau_{travel} = 3 - 2 = 1$ h.\n  - We evaluate the input function at $t_0=1$. Since $0 \\le 1 \\le 2$, $V_{\\text{in}}(1) = 100$.\n  - $V(6,3) = 100 \\cdot e^{-0.35 \\cdot (6/3)} = 100 \\cdot e^{-0.7} \\approx 49.658530$ gc/L.\n\n- **Case 5:** $u=6$ km/h, $\\delta=0.05$ h$^{-1}$, $x=12$ km, $t=5$ h, $V_{\\text{in}}(t')=500 + 500 \\sin(\\frac{2\\pi}{24} t')$.\n  - Travel time $\\tau_{travel} = x/u = 12/6 = 2$ h.\n  - Since $t=5  \\tau_{travel}=2$, we proceed.\n  - Time of origin $t_0 = t - \\tau_{travel} = 5 - 2 = 3$ h.\n  - $V_{\\text{in}}(3) = 500 + 500 \\sin(\\frac{2\\pi}{24} \\cdot 3) = 500 + 500 \\sin(\\frac{\\pi}{4}) = 500(1 + \\frac{\\sqrt{2}}{2})$.\n  - $V(12,5) = 500(1 + \\frac{\\sqrt{2}}{2}) \\cdot e^{-0.05 \\cdot (12/6)} = 500(1 + \\frac{\\sqrt{2}}{2}) \\cdot e^{-0.1} \\approx 772.321701$ gc/L.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_downstream_concentration(\n    u: float,\n    delta: float,\n    x: float,\n    t: float,\n    v_in_function,\n    params: dict\n) - float:\n    \"\"\"\n    Computes the downstream pathogen concentration V(x,t) based on the \n    analytical solution to the 1D advection-decay equation.\n\n    The solution is:\n    V(x,t) = 0                                     if t = x/u\n    V(x,t) = V_in(t - x/u) * exp(-delta * (x/u))   if t  x/u\n    \"\"\"\n    # Problem constraints imply u  0 and x = 0.\n    # A check for u = 0 is good practice but not strictly needed here.\n    if u = 0:\n        return 0.0\n\n    travel_time = x / u\n    \n    # Causality check: If the observation time t is less than or equal to the\n    # travel time, the upstream signal has not yet arrived.\n    if t = travel_time:\n        return 0.0\n    \n    # If the signal has arrived, calculate the time of origin at x=0.\n    t_origin = t - travel_time\n    \n    # Calculate the inlet concentration at the time of origin.\n    # The parameters for the specific V_in function are passed via the params dict.\n    v_at_origin = v_in_function(t_origin, **params)\n    \n    # Calculate the decay factor over the travel duration.\n    decay_factor = np.exp(-delta * travel_time)\n    \n    # The final concentration is the advected, decayed source concentration.\n    v_downstream = v_at_origin * decay_factor\n    \n    return v_downstream\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite by applying the derived\n    analytical solution for each case.\n    \"\"\"\n    # Define the V_in functions for different inflow scenarios.\n    \n    def v_in_step(t_prime: float, V0: float) - float:\n        \"\"\"Step function inflow.\"\"\"\n        return V0 if t_prime = 0 else 0.0\n\n    def v_in_pulse(t_prime: float, V0: float, tau: float) - float:\n        \"\"\"Rectangular pulse inflow.\"\"\"\n        return V0 if 0 = t_prime = tau else 0.0\n\n    def v_in_sine(t_prime: float, A: float, B: float, omega: float) - float:\n        \"\"\"Sinusoidal inflow.\"\"\"\n        # Angles in radians, as specified.\n        return A + B * np.sin(omega * t_prime)\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains: (u, delta, x, t, function_handle, parameters_dict)\n    test_cases = [\n        # Case 1: step inflow, general case\n        (5.0, 0.2, 10.0, 5.0, v_in_step, {'V0': 1000.0}),\n        \n        # Case 2: no decay edge case\n        (10.0, 0.0, 15.0, 2.0, v_in_step, {'V0': 500.0}),\n        \n        # Case 3: pre-arrival causality edge case\n        (10.0, 0.1, 25.0, 1.0, v_in_step, {'V0': 200.0}),\n        \n        # Case 4: finite-duration rectangular pulse\n        (3.0, 0.35, 6.0, 3.0, v_in_pulse, {'V0': 100.0, 'tau': 2.0}),\n        \n        # Case 5: diurnally varying inflow\n        (6.0, 0.05, 12.0, 5.0, v_in_sine, {'A': 500.0, 'B': 500.0, 'omega': 2 * np.pi / 24})\n    ]\n\n    results = []\n    for case in test_cases:\n        u, delta, x, t, func, params = case\n        result = compute_downstream_concentration(u, delta, x, t, func, params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Values are rounded to six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\n# Execute the solution.\nsolve()\n```", "id": "5069008"}, {"introduction": "The ultimate challenge in translational research is not just managing existing threats but anticipating their evolution. This capstone exercise delves into the evolutionary dynamics of antimicrobial resistance, a quintessential One Health problem, by modeling competition between susceptible and resistant genotypes across multiple host species. You will linearize a multi-host system to find the rate of resistance emergence and use this powerful analytical tool to evaluate the impact of different intervention strategies [@problem_id:5069047].", "problem": "You are asked to formalize and implement a deterministic multi-host evolutionary dynamics model consistent with the One Health approach, in which resistant and susceptible genotypes compete and mix across hosts. The goal is to quantify how specified interventions alter the early-time rate of resistance emergence. Your solution must begin from widely accepted population genetics and mass-action mixing principles, derive the appropriate linearization to isolate an interpretable rate, and then implement a programmatic computation of this rate for several test scenarios. The final output must aggregate results for all test cases into a single line as specified below.\n\nFundamental base and definitions:\n- Consider $H$ host compartments indexed by $i \\in \\{1,\\dots,H\\}$, each with two genotypes: susceptible ($S$) and resistant ($R$). Let $x_i(t) \\in [0,1]$ denote the fraction of genotype $R$ in host $i$ at time $t$ (in days).\n- Let $w_{i,S}$ and $w_{i,R}$ denote within-host reproductive fitnesses (per day) of $S$ and $R$ in host $i$, respectively. Define the selection coefficient $s_i$ via $w_{i,R} - w_{i,S} = s_i$ (per day).\n- Let $\\mu_{S \\to R}$ and $\\mu_{R \\to S}$ denote per-day mutation rates from $S$ to $R$ and from $R$ to $S$, respectively.\n- Let $m_{j i} \\ge 0$ (per day) denote the mass-action mixing rate by which host $j$ contributes to host $i$ for genotype mixing. The mixing term is expressed as $\\sum_{j \\ne i} m_{j i}\\big(x_j - x_i\\big)$, which drives $x_i$ toward a weighted average of other hosts, conserving total population across hosts in a coarse-grained sense.\n\nModel equations:\n- Under replicator-mutator dynamics with mass-action inter-host mixing, the fraction $x_i(t)$ follows\n$$\n\\frac{dx_i}{dt} = x_i(1 - x_i)\\, s_i + \\mu_{S \\to R} (1 - x_i) - \\mu_{R \\to S}\\, x_i + \\sum_{j \\ne i} m_{j i}\\big(x_j - x_i\\big).\n$$\n- Early-time emergence is governed by the linearization near $x_i \\approx 0$. Linearizing the above around the resistance-rare state yields\n$$\n\\frac{dx_i}{dt} \\approx \\underbrace{s_i\\, x_i - (\\mu_{S \\to R} + \\mu_{R \\to S})\\, x_i - \\left(\\sum_{j \\ne i} m_{j i}\\right) x_i + \\sum_{j \\ne i} m_{j i} x_j}_{\\text{homogeneous linear part}} + \\underbrace{\\mu_{S \\to R}}_{\\text{constant source}},\n$$\nwhich can be written compactly as\n$$\n\\frac{d\\mathbf{x}}{dt} = A\\, \\mathbf{x} + \\mathbf{b}, \\quad \\text{with} \\quad \\mathbf{x} = (x_1, \\dots, x_H)^\\top,\n$$\nwhere\n$$\nA_{i i} = s_i - (\\mu_{S \\to R} + \\mu_{R \\to S}) - \\sum_{j \\ne i} m_{j i}, \\quad A_{i j} = m_{j i} \\ \\text{for} \\ i \\ne j, \\quad \\mathbf{b}_i = \\mu_{S \\to R}.\n$$\n- The constant source vector $\\mathbf{b}$ sets an injection scale but does not determine the asymptotic growth rate near zero. A principled and interpretable early-time rate of resistance emergence is the dominant eigenvalue (largest real part) of $A$, denoted $\\lambda_{\\max}(A)$, with units of per day. This quantity governs the exponential tendency of small resistance fractions under the homogeneous linear dynamics and is widely used in stability and invasion analysis.\n\nTask:\n1. For each test case, construct the matrix $A$ from the provided baseline parameters ($s_i$, $\\mu_{S \\to R}$, $\\mu_{R \\to S}$, $m_{j i}$), and compute the baseline emergence rate $r_{\\text{base}} = \\lambda_{\\max}(A_{\\text{base}})$ in per day.\n2. Apply the specified intervention strategy (modified $s_i$ and $m_{j i}$), construct $A_{\\text{int}}$, and compute $r_{\\text{int}} = \\lambda_{\\max}(A_{\\text{int}})$ in per day.\n3. Report the fractional change in the rate due to intervention as a dimensionless decimal\n$$\n\\Delta = \\frac{r_{\\text{base}} - r_{\\text{int}}}{\\lvert r_{\\text{base}} \\rvert}.\n$$\nIf $r_{\\text{base}}  0$, a positive $\\Delta$ indicates reduction in early-time resistance emergence. All rates are per day and the fractional change $\\Delta$ is dimensionless; no percentage signs should be used.\n\nTest suite (use $H=3$ hosts; interpret host $1$ as human, host $2$ as livestock, host $3$ as wildlife):\n- Test case $1$ (happy path; moderate inter-host mixing; stewardship reduces selection and biosecurity reduces mixing):\n  - Baseline: $s = [0.08, -0.02, 0.00]$ per day, $\\mu_{S \\to R} = 10^{-7}$ per day, $\\mu_{R \\to S} = 10^{-6}$ per day,\n    $M_{\\text{base}} = \\begin{bmatrix} 0  0.02  0.005 \\\\ 0.02  0  0.003 \\\\ 0.005  0.003  0 \\end{bmatrix}$ per day, where $M_{j i} = m_{j i}$.\n  - Intervention: $s' = [0.01, -0.02, 0.00]$ per day,\n    $M_{\\text{int}} = \\begin{bmatrix} 0  0.005  0.002 \\\\ 0.005  0  0.003 \\\\ 0.002  0.003  0 \\end{bmatrix}$ per day.\n- Test case $2$ (boundary; zero mixing; stewardship removes advantage in one host):\n  - Baseline: $s = [0.03, -0.01, -0.01]$ per day, $\\mu_{S \\to R} = 10^{-7}$ per day, $\\mu_{R \\to S} = 10^{-6}$ per day,\n    $M_{\\text{base}} = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ per day.\n  - Intervention: $s' = [0.00, -0.01, -0.01]$ per day,\n    $M_{\\text{int}} = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ per day.\n- Test case $3$ (higher mixing and modest selection; combined vaccination and stewardship reduce both mixing and selection):\n  - Baseline: $s = [0.02, 0.01, 0.01]$ per day, $\\mu_{S \\to R} = 5 \\times 10^{-7}$ per day, $\\mu_{R \\to S} = 10^{-6}$ per day,\n    $M_{\\text{base}} = \\begin{bmatrix} 0  0.015  0.01 \\\\ 0.015  0  0.012 \\\\ 0.01  0.012  0 \\end{bmatrix}$ per day.\n  - Intervention: $s' = [0.005, 0.005, 0.005]$ per day,\n    $M_{\\text{int}} = 0.4 \\times M_{\\text{base}}$ per day (that is, a $60\\%$ reduction in mixing rates, expressed by multiplying entries by $0.4$).\n- Test case $4$ (edge; extremely low de novo mutation to confirm rate measure’s independence from constant injection):\n  - Baseline: same $s$ and $M_{\\text{base}}$ as in test case $1$, but $\\mu_{S \\to R} = 10^{-12}$ per day and $\\mu_{R \\to S} = 10^{-6}$ per day.\n  - Intervention: same $s'$ and $M_{\\text{int}}$ as in test case $1$.\n\nImplementation and output specification:\n- Your program must construct $A$ and compute $\\lambda_{\\max}(A)$ for each baseline and intervention pair, compute $\\Delta$ for each test case, and aggregate results across all test cases into a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\texttt{[result1,result2,result3,result4]}$.\n- All rates must be handled in units of per day. The final reported values are the dimensionless fractional changes $\\Delta$ for each test case.", "solution": "The objective is to quantify the impact of several intervention strategies on the early-time emergence of a resistant genotype in a multi-host system. The problem is framed within the One Health paradigm, considering interactions between human, livestock, and wildlife populations. The core of the analysis lies in a system of ordinary differential equations that model the fraction of the resistant genotype, $x_i(t)$, in each host compartment $i$.\n\nThe provided model is:\n$$\n\\frac{dx_i}{dt} = x_i(1 - x_i)\\, s_i + \\mu_{S \\to R} (1 - x_i) - \\mu_{R \\to S}\\, x_i + \\sum_{j \\ne i} m_{j i}\\big(x_j - x_i\\big)\n$$\nwhere $s_i$ is the selection coefficient, $\\mu_{S \\to R}$ and $\\mu_{R \\to S}$ are mutation rates, and $m_{ji}$ are inter-host mixing rates.\n\nTo analyze the initial emergence of resistance, the dynamics are linearized around the resistance-rare state, where all $x_i \\approx 0$. This leads to the linear system:\n$$\n\\frac{d\\mathbf{x}}{dt} = A\\, \\mathbf{x} + \\mathbf{b}\n$$\nThe rate of emergence is determined by the properties of the matrix $A$, which captures the homogeneous part of the linearized dynamics. The constant vector $\\mathbf{b}$ represents a source term due to de novo mutations and does not influence the exponential growth rate. The principled measure for the early-time emergence rate is the dominant eigenvalue of $A$, denoted $r = \\lambda_{\\max}(A)$, which corresponds to the eigenvalue with the largest real part. A positive $r$ indicates that small fractions of resistance will tend to grow exponentially, while a negative $r$ indicates they will decay.\n\nThe main task is to compute the fractional change in this emergence rate, $\\Delta$, resulting from an intervention. This is calculated as:\n$$\n\\Delta = \\frac{r_{\\text{base}} - r_{\\text{int}}}{\\lvert r_{\\text{base}} \\rvert}\n$$\nwhere $r_{\\text{base}} = \\lambda_{\\max}(A_{\\text{base}})$ and $r_{\\text{int}} = \\lambda_{\\max}(A_{\\text{int}})$ are the emergence rates for the baseline and intervention scenarios, respectively. A positive $\\Delta$ signifies a successful intervention that reduces the rate of resistance emergence. The logic proceeds in three main steps for each test case.\n\n**Step 1: Construction of the System Matrix $A$**\n\nThe matrix $A$ of size $H \\times H$ (where $H=3$ for all test cases) is constructed based on the model parameters. Its elements are defined by:\n$$\nA_{ii} = s_i - (\\mu_{S \\to R} + \\mu_{R \\to S}) - \\sum_{j \\ne i} m_{j i}\n$$\n$$\nA_{ij} = m_{j i} \\quad \\text{for} \\quad i \\ne j\n$$\n\nHere, $i$ and $j$ are $1$-based indices from $1$ to $H$.\n- The diagonal element $A_{ii}$ aggregates influences on host $i$'s resistance fraction. It includes positive selection ($s_i$), decay due to net back-mutation (the term $-(\\mu_{S \\to R} + \\mu_{R \\to S})$ is a slight simplification, but as derived in the problem statement from linearization, it represents the net effect of mutation on the $x_i$ population), and dilution from mixing with other host populations (the term $-\\sum_{j \\ne i} m_{j i}$).\n- The off-diagonal element $A_{ij}$ represents the contribution from host $j$ to host $i$ via mixing, with rate $m_{ji}$. The problem specifies that the provided mixing matrices $M$ follow the convention $M_{ji} = m_{ji}$. Therefore, to construct $A$, the off-diagonal element $A_{ij}$ is taken from the entry in the $j$-th row and $i$-th column of the given matrix $M$. This corresponds to using the transpose of $M$ for the off-diagonal part of $A$. The diagonal term's summation, $\\sum_{j \\ne i} m_{j i}$, is the sum of the $i$-th column of $M$ (as the diagonal entries of $M$ are zero).\n\n**Step 2: Computation of the Emergence Rate $r = \\lambda_{\\max}(A)$**\n\nOnce the matrix $A$ is constructed for a given scenario (baseline or intervention), its eigenvalues are computed numerically. The emergence rate $r$ is the maximum value among the real parts of all computed eigenvalues. This value dictates the long-term behavior of the linearized system: if $r  0$, the system is unstable at the resistance-free state, and resistance is expected to emerge and grow.\n\n**Step 3: Calculation of the Fractional Change $\\Delta$**\n\nFor each test case, we compute $r_{\\text{base}}$ using the baseline parameters and $r_{\\text{int}}$ using the intervention parameters. The fractional change $\\Delta$ is then calculated using the specified formula. This dimensionless quantity provides a standardized measure of the intervention's effectiveness.\n\nThe entire procedure is implemented programmatically. A function is designed to take the set of parameters for a scenario ($s$, $\\mu$s, $M$), construct the corresponding matrix $A$, and return its dominant eigenvalue. This function is called for both the baseline and intervention configurations of each test case. The resulting rates are then used to compute $\\Delta$. The final output aggregates the values of $\\Delta$ from all test cases into a single formatted string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the computation for all test cases.\n    \"\"\"\n\n    def get_emergence_rate(s, mu_sr, mu_rs, M, H=3):\n        \"\"\"\n        Constructs the matrix A and computes its dominant eigenvalue (emergence rate).\n\n        Args:\n            s (np.ndarray): Array of selection coefficients for each host.\n            mu_sr (float): Mutation rate from susceptible to resistant.\n            mu_rs (float): Mutation rate from resistant to susceptible.\n            M (np.ndarray): Mixing matrix where M[j, i] is the rate m_ji.\n            H (int): Number of hosts.\n\n        Returns:\n            float: The dominant eigenvalue of matrix A.\n        \"\"\"\n        # Initialize the H x H matrix A\n        A = np.zeros((H, H))\n        \n        # Total mutation effect on the resistant fraction\n        mu_tot = mu_sr + mu_rs\n        \n        # Calculate column sums of M for the diagonal part of A.\n        # Since M_diag is zero, sum(M[:, i]) is equivalent to sum_{j!=i} m_ji.\n        col_sums_M = np.sum(M, axis=0)\n\n        for i in range(H):\n            # Set the diagonal elements of A\n            A[i, i] = s[i] - mu_tot - col_sums_M[i]\n            for j in range(H):\n                if i != j:\n                    # Set the off-diagonal elements of A.\n                    # A_ij = m_ji which is given as M_ji.\n                    # In 0-based numpy, A[i, j] = M[j, i].\n                    A[i, j] = M[j, i]\n\n        # Compute eigenvalues of A\n        eigenvalues = np.linalg.eigvals(A)\n        \n        # The emergence rate is the largest real part of the eigenvalues\n        r = np.max(np.real(eigenvalues))\n        \n        return r\n\n    def calculate_delta(params_base, params_int):\n        \"\"\"\n        Calculates the fractional change in emergence rate for a test case.\n\n        Args:\n            params_base (dict): Dictionary of baseline parameters.\n            params_int (dict): Dictionary of intervention parameters.\n\n        Returns:\n            float: The fractional change delta.\n        \"\"\"\n        r_base = get_emergence_rate(**params_base)\n        r_int = get_emergence_rate(**params_int)\n        \n        if np.abs(r_base) == 0:\n            # Handle the undefined case, though not expected in these tests.\n            # A large number could signify an infinite relative change.\n            return np.inf if r_base != r_int else 0.0\n\n        delta = (r_base - r_int) / np.abs(r_base)\n        return delta\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"baseline\": {\n                \"s\": np.array([0.08, -0.02, 0.00]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.02, 0.005],\n                    [0.02, 0, 0.003],\n                    [0.005, 0.003, 0]\n                ])\n            },\n            \"intervention\": {\n                \"s\": np.array([0.01, -0.02, 0.00]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.005, 0.002],\n                    [0.005, 0, 0.003],\n                    [0.002, 0.003, 0]\n                ])\n            }\n        },\n        # Test case 2\n        {\n            \"baseline\": {\n                \"s\": np.array([0.03, -0.01, -0.01]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.zeros((3, 3))\n            },\n            \"intervention\": {\n                \"s\": np.array([0.00, -0.01, -0.01]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.zeros((3, 3))\n            }\n        },\n        # Test case 3\n        {\n            \"baseline\": {\n                \"s\": np.array([0.02, 0.01, 0.01]),\n                \"mu_sr\": 5e-7, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.015, 0.01],\n                    [0.015, 0, 0.012],\n                    [0.01, 0.012, 0]\n                ])\n            },\n            \"intervention\": {\n                \"s\": np.array([0.005, 0.005, 0.005]),\n                \"mu_sr\": 5e-7, \"mu_rs\": 1e-6,\n                \"M\": 0.4 * np.array([\n                    [0, 0.015, 0.01],\n                    [0.015, 0, 0.012],\n                    [0.01, 0.012, 0]\n                ])\n            }\n        },\n        # Test case 4\n        {\n            \"baseline\": {\n                \"s\": np.array([0.08, -0.02, 0.00]),\n                \"mu_sr\": 1e-12, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.02, 0.005],\n                    [0.02, 0, 0.003],\n                    [0.005, 0.003, 0]\n                ])\n            },\n            \"intervention\": {\n                \"s\": np.array([0.01, -0.02, 0.00]),\n                \"mu_sr\": 1e-12, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.005, 0.002],\n                    [0.005, 0, 0.003],\n                    [0.002, 0.003, 0]\n                ])\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case[\"baseline\"], case[\"intervention\"])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```", "id": "5069047"}]}