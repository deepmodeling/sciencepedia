{"hands_on_practices": [{"introduction": "The foundation of understanding a disease's natural history is accurately measuring its occurrence. However, in many studies, case-finding relies on algorithms or diagnostic criteria with imperfect sensitivity and specificity, leading to biased estimates of incidence. This exercise [@problem_id:5034713] provides a practical walkthrough of how to use data from a validation substudy to quantify and correct for this misclassification bias, a crucial skill for interpreting data from registries and large cohorts.", "problem": "A longitudinal natural history study of a neurodegenerative disease enrolls $N_{\\text{total}}$ individuals at risk and follows them for a variable duration, accumulating a total person-time of $PT$ person-years. An incident event is defined as the first diagnosis meeting prespecified criteria within the observation window. A case-finding algorithm applied to the cohort flags $N_{\\text{obs}}$ individuals as incident cases. Because the algorithm is imperfect, a separate validation study was conducted using gold-standard adjudication. In the validation study, the algorithm was applied to $n_{\\text{cases}}$ adjudicated incident cases and $n_{\\text{non}}$ adjudicated non-cases, producing $TP$ true positives among cases and $TN$ true negatives among non-cases. The sensitivity and specificity of the algorithm are defined respectively as $\\mathrm{Se} = \\Pr(\\text{flag} = 1 \\mid \\text{true case} = 1)$ and $\\mathrm{Sp} = \\Pr(\\text{flag} = 0 \\mid \\text{true case} = 0)$.\n\nAssume the following:\n- Misclassification is nondifferential with respect to person-time and independent across individuals.\n- Each individual can contribute at most one incident event in the window.\n- The denominator $PT$ is measured without error.\n\nStarting from the core definitions of sensitivity, specificity, and incidence rate, derive the expected bias in the naive incidence rate estimator $r_{\\text{obs}} = N_{\\text{obs}}/PT$ relative to the true incidence rate $r_{\\text{true}} = N_{\\text{true}}/PT$, where $N_{\\text{true}}$ is the true number of incident events. Then, using the validation-derived estimates of sensitivity and specificity, compute the misclassification-corrected incidence rate.\n\nUse the following study numbers:\n- $N_{\\text{total}} = 1500$, $PT = 1400$ person-years, and $N_{\\text{obs}} = 180$.\n- Validation counts: $n_{\\text{cases}} = 80$ adjudicated true incident cases with $TP = 68$ flagged positive by the algorithm, and $n_{\\text{non}} = 320$ adjudicated true non-cases with $TN = 288$ flagged negative by the algorithm.\n\nInstructions:\n- Express the corrected incidence rate in units of cases per $1000$ person-years.\n- Round the corrected incidence rate to four significant figures.\n- Provide both the symbolic bias expression and the numerical corrected rate as your final answer.", "solution": "The problem is valid as it is scientifically grounded in epidemiological principles, well-posed with sufficient and consistent data, and objectively stated. We can proceed with the solution.\n\nThe solution requires two parts: first, a symbolic derivation of the expected bias in the observed incidence rate, and second, the calculation of a corrected incidence rate using the provided data.\n\nLet $N_{\\text{total}}$ be the total number of individuals in the cohort.\nLet $N_{\\text{true}}$ be the true number of incident cases.\nLet $N_{\\text{obs}}$ be the observed number of incident cases flagged by the algorithm.\nThe number of true non-cases is $N_{\\text{total}} - N_{\\text{true}}$.\n\nThe algorithm's performance is characterized by its sensitivity ($\\mathrm{Se}$) and specificity ($\\mathrm{Sp}$):\n$\\mathrm{Se} = \\Pr(\\text{flagged positive} \\mid \\text{true case})$\n$\\mathrm{Sp} = \\Pr(\\text{flagged negative} \\mid \\text{true non-case})$\nFrom these, we can derive the probability of a false positive, which is $1 - \\mathrm{Sp} = \\Pr(\\text{flagged positive} \\mid \\text{true non-case})$.\n\nThe observed number of cases, $N_{\\text{obs}}$, is the sum of true positives (true cases correctly flagged) and false positives (true non-cases incorrectly flagged). The expected value of $N_{\\text{obs}}$, conditioned on the true number of cases $N_{\\text{true}}$, is:\n$$E[N_{\\text{obs}} \\mid N_{\\text{true}}] = N_{\\text{true}} \\cdot \\mathrm{Se} + (N_{\\text{total}} - N_{\\text{true}}) \\cdot (1 - \\mathrm{Sp})$$\nTaking the expectation over the distribution of $N_{\\text{true}}$:\n$$E[N_{\\text{obs}}] = E[N_{\\text{true}}] \\cdot \\mathrm{Se} + (N_{\\text{total}} - E[N_{\\text{true}}]) \\cdot (1 - \\mathrm{Sp})$$\nThe true incidence rate is $r_{\\text{true}} = E[N_{\\text{true}}]/PT$, and the expected observed incidence rate is $E[r_{\\text{obs}}] = E[N_{\\text{obs}}]/PT$, where $PT$ is the total person-time and treated as a constant.\nDividing the equation for $E[N_{\\text{obs}}]$ by $PT$:\n$$E[r_{\\text{obs}}] = \\frac{E[N_{\\text{true}}]}{PT} \\cdot \\mathrm{Se} + \\frac{N_{\\text{total}} - E[N_{\\text{true}}]}{PT} \\cdot (1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}} \\cdot \\mathrm{Se} + \\left(\\frac{N_{\\text{total}}}{PT} - \\frac{E[N_{\\text{true}}]}{PT}\\right) \\cdot (1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}} \\cdot \\mathrm{Se} + \\left(\\frac{N_{\\text{total}}}{PT} - r_{\\text{true}}\\right) \\cdot (1 - \\mathrm{Sp})$$\nExpanding this expression:\n$$E[r_{\\text{obs}}] = r_{\\text{true}} \\cdot \\mathrm{Se} + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp}) - r_{\\text{true}}(1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}}(\\mathrm{Se} - (1 - \\mathrm{Sp})) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 1) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\nThe expected bias, $B$, is defined as $E[r_{\\text{obs}}] - r_{\\text{true}}$.\n$$B = \\left( r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 1) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp}) \\right) - r_{\\text{true}}$$\n$$B = r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 1 - 1) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\n$$B = r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 2) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\nThis is the symbolic expression for the expected bias.\n\nNext, we compute the misclassification-corrected incidence rate. First, we estimate $\\mathrm{Se}$ and $\\mathrm{Sp}$ from the validation study data.\nGiven: $n_{\\text{cases}} = 80$ true cases, $TP = 68$ true positives.\nGiven: $n_{\\text{non}} = 320$ true non-cases, $TN = 288$ true negatives.\nThe point estimates for sensitivity and specificity are:\n$$\\widehat{\\mathrm{Se}} = \\frac{TP}{n_{\\text{cases}}} = \\frac{68}{80} = 0.85$$\n$$\\widehat{\\mathrm{Sp}} = \\frac{TN}{n_{\\text{non}}} = \\frac{288}{320} = \\frac{9}{10} = 0.90$$\nTo find the corrected incidence rate, we can first find the corrected number of true cases, $N_{\\text{true}}$, by rearranging the initial equation and substituting the observed count $N_{\\text{obs}}$ for its expectation:\n$$N_{\\text{obs}} \\approx N_{\\text{true}} \\cdot \\widehat{\\mathrm{Se}} + (N_{\\text{total}} - N_{\\text{true}}) \\cdot (1 - \\widehat{\\mathrm{Sp}})$$\n$$N_{\\text{obs}} \\approx N_{\\text{true}}(\\widehat{\\mathrm{Se}} + \\widehat{\\mathrm{Sp}} - 1) + N_{\\text{total}}(1 - \\widehat{\\mathrm{Sp}})$$\nSolving for $N_{\\text{true}}$:\n$$N_{\\text{true}} \\approx \\frac{N_{\\text{obs}} - N_{\\text{total}}(1 - \\widehat{\\mathrm{Sp}})}{\\widehat{\\mathrm{Se}} + \\widehat{\\mathrm{Sp}} - 1}$$\nWe are given $N_{\\text{obs}} = 180$, $N_{\\text{total}} = 1500$, and $PT = 1400$ person-years. We also have our estimates $\\widehat{\\mathrm{Se}} = 0.85$ and $\\widehat{\\mathrm{Sp}} = 0.90$.\nThe denominator term is $\\widehat{\\mathrm{Se}} + \\widehat{\\mathrm{Sp}} - 1 = 0.85 + 0.90 - 1 = 0.75$.\nThe numerator term is $N_{\\text{obs}} - N_{\\text{total}}(1 - \\widehat{\\mathrm{Sp}}) = 180 - 1500(1 - 0.90) = 180 - 1500(0.10) = 180 - 150 = 30$.\nSubstituting these values:\n$$N_{\\text{true}} \\approx \\frac{30}{0.75} = \\frac{30}{3/4} = 40$$\nThe corrected estimate for the number of true incident cases is $40$.\nThe corrected incidence rate, $r_{\\text{true}}$, is this count divided by the total person-time:\n$$r_{\\text{true}} = \\frac{N_{\\text{true}}}{PT} = \\frac{40}{1400} = \\frac{1}{35} \\text{ cases per person-year}$$\nThe problem requires the rate in units of cases per $1000$ person-years.\n$$r_{\\text{true, per 1000 PY}} = \\frac{1}{35} \\times 1000 = \\frac{1000}{35} = \\frac{200}{7} \\approx 28.571428...$$\nRounding to four significant figures, the corrected incidence rate is $28.57$ cases per $1000$ person-years.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nr_{\\text{true}} (\\mathrm{Se} + \\mathrm{Sp} - 2) + \\frac{N_{\\text{total}}}{PT}(1-\\mathrm{Sp}) & 28.57\n\\end{pmatrix}\n}\n$$", "id": "5034713"}, {"introduction": "Once we can accurately count events, the next step is to model the time until they occur. A classic challenge in natural history studies is \"delayed entry,\" where patients are enrolled long after their disease onset, creating a biased sample of survivors. This practice [@problem_id:5034704] offers a hands-on demonstration of this bias by comparing a naive survival analysis with one that properly accounts for left-truncation, illustrating why the correct definition of the risk set is essential for valid inference.", "problem": "A prospective natural history cohort study in translational medicine seeks to estimate survival from disease onset to a clinically relevant failure event. Because patients are referred from community settings, many enroll late; longer survivors tend to be referred later. Consider eight consecutively enrolled patients with their entry times and outcomes recorded in months since disease onset. Right censoring is non-informative. The time origin is disease onset. Define the event time as $T_i$, the right-censoring time as $C_i$, the study entry (delayed entry) time as $L_i$, and the observed exit time as $R_i = \\min\\{T_i, C_i\\}$. The data are:\n- Participant $1$: $L_1 = 0.5$, event at $T_1 = 6$.\n- Participant $2$: $L_2 = 1$, event at $T_2 = 9$.\n- Participant $3$: $L_3 = 3$, censored at $C_3 = 15$.\n- Participant $4$: $L_4 = 5$, event at $T_4 = 11$.\n- Participant $5$: $L_5 = 12$, censored at $C_5 = 18$.\n- Participant $6$: $L_6 = 10$, event at $T_6 = 14$.\n- Participant $7$: $L_7 = 8$, censored at $C_7 = 12$.\n- Participant $8$: $L_8 = 9$, event at $T_8 = 13$.\n\nThe disease’s true underlying survival function from onset is exponential with rate $\\lambda = \\ln(2)/12$ per month, so the true survival at $t=12$ months is $S(12) = \\exp(-\\lambda \\cdot 12)$. Assume the following estimation conventions:\n- The Kaplan–Meier (KM) estimator treats every enrolled participant as if at risk from $t=0$ and uses the observed risk sets formed by all participants with $R_i \\ge t$, regardless of their $L_i$.\n- The left-truncated Kaplan–Meier estimator accounts for delayed entry by defining the risk set at time $t$ as those with $L_i \\le t \\le R_i$.\n\nCompute both the standard Kaplan–Meier estimator and the left-truncated Kaplan–Meier estimator of the survival probability at $t^{\\star} = 12$ months since onset. Then compute the ratio of their absolute biases at $t^{\\star}$, defined as\n$\\left|\\hat{S}_{\\mathrm{KM}}(12) - S(12)\\right| \\big/ \\left|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)\\right|$.\nExpress your final answer as a single number with no units.", "solution": "The user wants to solve a problem in survival analysis by validating the problem statement, then calculating and comparing two estimators for survival probability.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **Participants**: $8$ individuals in a prospective cohort study.\n-   **Time Origin**: Disease onset ($t=0$).\n-   **Variables**:\n    -   $L_i$: Delayed entry (left-truncation) time for participant $i$.\n    -   $T_i$: Time to event for participant $i$.\n    -   $C_i$: Time to right-censoring for participant $i$.\n    -   $R_i = \\min\\{T_i, C_i\\}$: Observed exit time for participant $i$.\n    -   $\\delta_i$: Event indicator ($1$ if event, $0$ if censored).\n-   **Data (in months)**:\n    -   Participant $1$: $L_1 = 0.5$, $T_1 = 6$ ($R_1=6, \\delta_1=1$).\n    -   Participant $2$: $L_2 = 1$, $T_2 = 9$ ($R_2=9, \\delta_2=1$).\n    -   Participant $3$: $L_3 = 3$, $C_3 = 15$ ($R_3=15, \\delta_3=0$).\n    -   Participant $4$: $L_4 = 5$, $T_4 = 11$ ($R_4=11, \\delta_4=1$).\n    -   Participant $5$: $L_5 = 12$, $C_5 = 18$ ($R_5=18, \\delta_5=0$).\n    -   Participant $6$: $L_6 = 10$, $T_6 = 14$ ($R_6=14, \\delta_6=1$).\n    -   Participant $7$: $L_7 = 8$, $C_7 = 12$ ($R_7=12, \\delta_7=0$).\n    -   Participant $8$: $L_8 = 9$, $T_8 = 13$ ($R_8=13, \\delta_8=1$).\n-   **True Survival Model**: Exponential distribution with rate $\\lambda = \\frac{\\ln(2)}{12}$ per month. The survival function is $S(t) = \\exp(-\\lambda t)$.\n-   **Target Time**: $t^{\\star} = 12$ months.\n-   **Estimator Definitions**:\n    -   Standard Kaplan-Meier ($\\hat{S}_{\\mathrm{KM}}$): Risk set at time $t$ is $\\{i: R_i \\ge t\\}$.\n    -   Left-Truncated Kaplan-Meier ($\\hat{S}_{\\mathrm{LT\\text{-}KM}}$): Risk set at time $t$ is $\\{i: L_i \\le t \\le R_i\\}$.\n-   **Objective**: Compute the ratio of absolute biases: $\\frac{|\\hat{S}_{\\mathrm{KM}}(12) - S(12)|}{|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)|}$.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientific Grounding**: The problem is based on fundamental concepts of survival analysis, specifically handling left-truncated and right-censored data, which is a standard topic in biostatistics and translational medicine. The scenario is scientifically realistic.\n-   **Well-Posed**: The problem is well-posed. All data ($L_i$, $R_i$, $\\delta_i$), the true distribution parameter ($\\lambda$), and the definitions of the estimators are provided. This allows for a unique numerical solution.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased language.\n-   **Completeness and Consistency**: The data are complete for the required calculations. For every participant, the entry time $L_i$ is less than the exit time $R_i$, which is a necessary condition. The problem is self-contained and internally consistent.\n\n**1.3. Verdict and Action**\n\nThe problem is deemed **valid**. The solution process will proceed.\n\n### Step 2: Solution\n\nThe problem requires the computation of three quantities: the true survival probability $S(12)$, the standard Kaplan-Meier estimate $\\hat{S}_{\\mathrm{KM}}(12)$, and the left-truncated Kaplan-Meier estimate $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12)$. From these, the ratio of absolute biases will be calculated.\n\n**2.1. True Survival Probability $S(12)$**\nThe true survival function is given as $S(t) = \\exp(-\\lambda t)$, with the rate parameter $\\lambda = \\frac{\\ln(2)}{12}$. We evaluate this at the target time $t^{\\star} = 12$.\n$$S(12) = \\exp\\left(-\\frac{\\ln(2)}{12} \\times 12\\right) = \\exp(-\\ln(2)) = \\frac{1}{\\exp(\\ln(2))} = \\frac{1}{2}$$\nSo, the true survival probability at $12$ months is $S(12) = 0.5$.\n\n**2.2. Standard Kaplan-Meier Estimate $\\hat{S}_{\\mathrm{KM}}(12)$**\nThe standard Kaplan-Meier estimator is given by the product-limit formula $\\hat{S}(t) = \\prod_{t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right)$, where $t_j$ are the distinct event times, $d_j$ is the number of events at $t_j$, and $n_j$ is the number of individuals at risk. For the standard KM estimator, the risk set at time $t$ consists of all individuals with an observed exit time $R_i \\ge t$. The distinct event times observed in the data are $6, 9, 11, 13, 14$. We only need to consider event times up to $t^{\\star} = 12$.\n\n-   **Event at $t_1 = 6$**:\n    -   The number at risk, $n_1$, is the count of individuals with $R_i \\ge 6$. All $8$ participants satisfy this. Thus, $n_1 = 8$.\n    -   The number of events is $d_1 = 1$ (Participant $1$).\n    -   The survival probability estimate is $\\hat{S}_{\\mathrm{KM}}(6) = 1 - \\frac{1}{8} = \\frac{7}{8}$.\n\n-   **Event at $t_2 = 9$**:\n    -   The number at risk, $n_2$, is the count of individuals with $R_i \\ge 9$. Participant $1$ has exited. The remaining $7$ participants satisfy this. Thus, $n_2 = 7$.\n    -   The number of events is $d_2 = 1$ (Participant $2$).\n    -   The survival probability estimate is $\\hat{S}_{\\mathrm{KM}}(9) = \\hat{S}_{\\mathrm{KM}}(6) \\times \\left(1 - \\frac{1}{7}\\right) = \\frac{7}{8} \\times \\frac{6}{7} = \\frac{6}{8} = \\frac{3}{4}$.\n\n-   **Event at $t_3 = 11$**:\n    -   The number at risk, $n_3$, is the count of individuals with $R_i \\ge 11$. Participants $1$ and $2$ have exited. The remaining $6$ participants satisfy this. Thus, $n_3 = 6$.\n    -   The number of events is $d_3 = 1$ (Participant $4$).\n    -   The survival probability estimate is $\\hat{S}_{\\mathrm{KM}}(11) = \\hat{S}_{\\mathrm{KM}}(9) \\times \\left(1 - \\frac{1}{6}\\right) = \\frac{3}{4} \\times \\frac{5}{6} = \\frac{15}{24} = \\frac{5}{8}$.\n\nThe next event occurs at $t = 13$. For any time $t$ in the interval $[11, 13)$, the survival estimate remains constant. Therefore, at $t^{\\star} = 12$:\n$$\\hat{S}_{\\mathrm{KM}}(12) = \\hat{S}_{\\mathrm{KM}}(11) = \\frac{5}{8} = 0.625$$\nNote that the censoring of Participant $7$ at $t=12$ does not change the estimate at $t=12$; it only affects the size of the risk set for subsequent event times.\n\n**2.3. Left-Truncated Kaplan-Meier Estimate $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12)$**\nFor the left-truncated Kaplan-Meier estimator, the risk set at an event time $t_j$ is defined as the set of individuals who are under observation at that time, i.e., $\\{i: L_i \\le t_j \\le R_i\\}$.\n\n-   **Event at $t_1 = 6$**:\n    -   The risk set consists of individuals with $L_i \\le 6 \\le R_i$. These are Participants $1$ ($0.5 \\le 6 \\le 6$), $2$ ($1 \\le 6 \\le 9$), $3$ ($3 \\le 6 \\le 15$), and $4$ ($5 \\le 6 \\le 11$). Thus, $n_1 = 4$.\n    -   The number of events is $d_1 = 1$.\n    -   The survival probability estimate is $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(6) = 1 - \\frac{1}{4} = \\frac{3}{4}$.\n\n-   **Event at $t_2 = 9$**:\n    -   The risk set consists of individuals with $L_i \\le 9 \\le R_i$. These are Participants $2$ ($1 \\le 9 \\le 9$), $3$ ($3 \\le 9 \\le 15$), $4$ ($5 \\le 9 \\le 11$), $7$ ($8 \\le 9 \\le 12$), and $8$ ($9 \\le 9 \\le 13$). Thus, $n_2 = 5$.\n    -   The number of events is $d_2 = 1$.\n    -   The survival probability estimate is $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(9) = \\hat{S}_{\\mathrm{LT\\text{-}KM}}(6) \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{3}{4} \\times \\frac{4}{5} = \\frac{3}{5}$.\n\n-   **Event at $t_3 = 11$**:\n    -   The risk set consists of individuals with $L_i \\le 11 \\le R_i$. These are Participants $3$ ($3 \\le 11 \\le 15$), $4$ ($5 \\le 11 \\le 11$), $6$ ($10 \\le 11 \\le 14$), $7$ ($8 \\le 11 \\le 12$), and $8$ ($9 \\le 11 \\le 13$). Thus, $n_3 = 5$.\n    -   The number of events is $d_3 = 1$.\n    -   The survival probability estimate is $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(11) = \\hat{S}_{\\mathrm{LT\\text{-}KM}}(9) \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{3}{5} \\times \\frac{4}{5} = \\frac{12}{25}$.\n\nThe next event occurs at $t = 13$. For any time $t$ in $[11, 13)$, the estimate is constant. At $t^{\\star} = 12$:\n$$\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) = \\hat{S}_{\\mathrm{LT\\text{-}KM}}(11) = \\frac{12}{25} = 0.48$$\n\n**2.4. Ratio of Absolute Biases**\nThe absolute bias of an estimator $\\hat{S}(t)$ is $|\\hat{S}(t) - S(t)|$.\n\n-   **Absolute bias of the standard KM estimator**:\n$$|\\hat{S}_{\\mathrm{KM}}(12) - S(12)| = \\left|\\frac{5}{8} - \\frac{1}{2}\\right| = \\left|\\frac{5}{8} - \\frac{4}{8}\\right| = \\frac{1}{8}$$\n\n-   **Absolute bias of the left-truncated KM estimator**:\n$$|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)| = \\left|\\frac{12}{25} - \\frac{1}{2}\\right| = \\left|\\frac{24}{50} - \\frac{25}{50}\\right| = \\left|-\\frac{1}{50}\\right| = \\frac{1}{50}$$\n\n-   **Ratio of the absolute biases**:\n$$\\frac{|\\hat{S}_{\\mathrm{KM}}(12) - S(12)|}{|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)|} = \\frac{1/8}{1/50} = \\frac{1}{8} \\times 50 = \\frac{50}{8} = \\frac{25}{4} = 6.25$$\n\nThe analysis shows that the standard Kaplan-Meier estimator, which ignores the delayed entry times, overestimates the survival probability, resulting in a substantial bias. The left-truncated Kaplan-Meier estimator, which properly accounts for the delayed entry, provides a much more accurate estimate, as reflected by its considerably smaller bias.", "answer": "$$\\boxed{6.25}$$", "id": "5034704"}, {"introduction": "A primary goal of many natural history studies is to identify biomarkers or clinical factors that predict disease progression. The Cox proportional hazards model is the cornerstone for this type of analysis, allowing us to quantify the effect of covariates on event risk. This exercise [@problem_id:5034739] takes you under the hood of the model, guiding you through the derivation of the partial likelihood in the presence of delayed entry and its application to a concrete dataset, solidifying your understanding of how risk factors are modeled with time-to-event data.", "problem": "A natural history registry for a progressive neuromuscular disease follows individuals from biological disease onset, but practical observation begins after diagnosis, inducing left truncation (delayed entry). Let individual $i$ enter observation at time $a_{i} \\geq 0$ (measured from disease onset) and exit at event time $t_{i}$ if the event occurs, or at censoring time $c_{i}$ otherwise. Let $\\delta_{i} \\in \\{0,1\\}$ indicate whether the event occurred ($\\delta_{i}=1$) or the subject was right-censored ($\\delta_{i}=0$). Suppose the event times are distinct and time is continuous. Assume the Cox proportional hazards (PH) model with possibly time-dependent covariates,\n$$\nh\\!\\left(t \\mid X_{i}(t)\\right) \\;=\\; h_{0}(t)\\,\\exp\\!\\big(\\beta^{\\top} X_{i}(t)\\big),\n$$\nwhere $h_{0}(t)$ is the unspecified baseline hazard, $X_{i}(t)$ is the covariate vector for individual $i$ at time $t$, and $\\beta$ is the vector of regression coefficients. Define the left-truncated risk set at time $t$ as $R(t) = \\{j : a_{j} \\leq t \\leq y_{j}\\}$, where $y_{j} = t_{j}$ if $\\delta_{j}=1$ and $y_{j} = c_{j}$ if $\\delta_{j}=0$.\n\nTask:\n1. Starting from the definition of the hazard function $h(t \\mid X)$, the survival function $S(t \\mid X)$, and the product-integral construction of the joint likelihood under independent individuals, derive the partial likelihood for $\\beta$ in the presence of left truncation by conditioning on the order of observed event times and the risk sets $R(t)$.\n2. Consider the following dataset of $n=4$ individuals with a single time-invariant covariate $x_{i}$:\n   - Individual $1$: $a_{1} = 2$, $t_{1} = 6$, $\\delta_{1} = 1$, $x_{1} = 1.0$.\n   - Individual $2$: $a_{2} = 0.5$, $t_{2} = 4$, $\\delta_{2} = 1$, $x_{2} = 0.5$.\n   - Individual $3$: $a_{3} = 3$, $c_{3} = 7$, $\\delta_{3} = 0$, $x_{3} = 0.0$.\n   - Individual $4$: $a_{4} = 5$, $t_{4} = 9$, $\\delta_{4} = 1$, $x_{4} = 2.0$.\n   Using your derived expression, evaluate the partial likelihood at $\\beta = \\ln(2)$ and compute its numerical value. Round your answer to four significant figures. Express the result as a unitless decimal.\n3. State the assumptions required for valid inference in this setting and explain why they are necessary in the context of natural history studies with delayed diagnosis and right censoring.\n\nAnswer form requirement: Provide the single numerical value for the partial likelihood, rounded to four significant figures, in the specified format. No units are required for the likelihood.", "solution": "The user has provided a problem in three parts concerning the Cox proportional hazards model with left-truncated and right-censored data. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Model**: Cox proportional hazards (PH) model, $h(t \\mid X_{i}(t)) = h_{0}(t)\\,\\exp(\\beta^{\\top} X_{i}(t))$, where $h_{0}(t)$ is the baseline hazard, $X_{i}(t)$ is the covariate vector, and $\\beta$ is the vector of regression coefficients.\n-   **Data Structure**: Left-truncated, right-censored survival data.\n-   **Variables for individual $i$**:\n    -   $a_{i} \\geq 0$: Entry time (left-truncation time).\n    -   $t_{i}$: Event time if event occurs.\n    -   $c_{i}$: Censoring time if right-censored.\n    -   $\\delta_{i} \\in \\{0,1\\}$: Event indicator, with $\\delta_{i}=1$ for an event and $\\delta_{i}=0$ for censoring.\n    -   $y_{j} = t_{j}$ if $\\delta_{j}=1$; $y_{j} = c_{j}$ if $\\delta_{j}=0$.\n-   **Risk Set Definition**: The left-truncated risk set at time $t$ is $R(t) = \\{j : a_{j} \\leq t \\leq y_{j}\\}$.\n-   **Assumption**: Event times are distinct and time is continuous.\n-   **Task 1**: Derive the partial likelihood for $\\beta$ in the presence of left truncation.\n-   **Task 2**: Evaluate the partial likelihood for a specific dataset at $\\beta = \\ln(2)$.\n    -   Dataset for $n=4$ individuals with a single time-invariant covariate $x_{i}$:\n        -   Individual $1$: $a_{1} = 2$, $t_{1} = 6$, $\\delta_{1} = 1$, $x_{1} = 1.0$.\n        -   Individual $2$: $a_{2} = 0.5$, $t_{2} = 4$, $\\delta_{2} = 1$, $x_{2} = 0.5$.\n        -   Individual $3$: $a_{3} = 3$, $c_{3} = 7$, $\\delta_{3} = 0$, $x_{3} = 0.0$.\n        -   Individual $4$: $a_{4} = 5$, $t_{4} = 9$, $\\delta_{4} = 1$, $x_{4} = 2.0$.\n-   **Task 3**: State the necessary assumptions for valid inference and explain their relevance.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard scenario in biostatistics and clinical research: analyzing survival data from a natural history study where subjects are recruited after disease onset (left truncation) and may be lost to follow-up or the study may end before an event occurs (right censoring). The Cox model is the canonical method for such analysis. The provided data are complete and consistent, and the tasks are well-defined and lead to a unique, meaningful solution. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Part 1: Derivation of the Partial Likelihood\nLet $T_i$ be the true event time for individual $i$ and $X_i(t)$ be their covariate vector at time $t$. The hazard function is $h(t \\mid X_i(t)) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\le T_i < t+\\Delta t \\mid T_i \\ge t, X_i(t))}{\\Delta t}$. In the Cox model, this is given by $h(t \\mid X_i(t)) = h_0(t) \\exp(\\beta^\\top X_i(t))$. The corresponding survival function is $S(t \\mid X_i) = \\exp(-\\int_0^t h(u \\mid X_i(u)) du)$.\n\nFor a dataset with left truncation and right censoring, the observation for individual $i$ consists of the entry time $a_i$, the observed exit time $y_i$ (which is either an event time $t_i$ or a censoring time $c_i$), and the event indicator $\\delta_i$. The crucial point is that individual $i$ is only included in the study if they survived until their entry time, $T_i \\ge a_i$. Therefore, the likelihood contribution for individual $i$ is conditional on this fact.\n\nThe unconditional likelihood contribution for an individual with observation $(y_i, \\delta_i)$ would be $L_i^{uc} = f(y_i|X_i)^{\\delta_i} S(y_i|X_i)^{1-\\delta_i} = [h(y_i|X_i)S(y_i|X_i)]^{\\delta_i} S(y_i|X_i)^{1-\\delta_i} = h(y_i|X_i)^{\\delta_i}S(y_i|X_i)$.\nThe conditional likelihood, given survival to $a_i$, is:\n$$L_i = P(\\text{data}_i \\mid T_i \\ge a_i) = \\frac{h(y_i|X_i)^{\\delta_i} S(y_i|X_i)}{P(T_i \\ge a_i)} = \\frac{h(y_i|X_i)^{\\delta_i} S(y_i|X_i)}{S(a_i|X_i)}$$\nThe ratio of survival functions can be written as:\n$$\\frac{S(y_i|X_i)}{S(a_i|X_i)} = \\frac{\\exp(-\\int_0^{y_i} h_0(u)\\exp(\\beta^\\top X_i(u))du)}{\\exp(-\\int_0^{a_i} h_0(u)\\exp(\\beta^\\top X_i(u))du)} = \\exp\\left(-\\int_{a_i}^{y_i} h_0(u)\\exp(\\beta^\\top X_i(u))du\\right)$$\nAssuming independence between individuals, the full likelihood for the entire dataset is $L_{full}(\\beta, h_0) = \\prod_{i=1}^n L_i$. This full likelihood depends on the unknown non-parametric baseline hazard function $h_0(t)$.\n\nCox's partial likelihood approach circumvents the need to estimate $h_0(t)$ by making a conditional argument at each event time. Let the ordered distinct event times be $t_{(1)} < t_{(2)} < \\dots < t_{(k)}$. At each event time $t_{(j)}$, we consider the set of individuals who are \"at risk\" of having the event at that moment. This is the risk set $R(t_{(j)})$, which, in the presence of left truncation, consists of all individuals $l$ who have entered the study by time $t_{(j)}$ ($a_l \\le t_{(j)}$) and have not yet experienced an event or been censored ($y_l \\ge t_{(j)}$). This matches the provided definition $R(t) = \\{j : a_{j} \\leq t \\leq y_{j}\\}$.\n\nGiven that exactly one event occurs at time $t_{(j)}$ among the individuals in the risk set $R(t_{(j)})$, the conditional probability that the event happened to the specific individual $i$ (who is the one observed to have the event at $t_{(j)}$) is:\n$$P(\\text{individual } i \\text{ fails at } t_{(j)} \\mid \\text{one failure from } R(t_{(j)}) \\text{ at } t_{(j)} ) = \\frac{h(t_{(j)} \\mid X_i(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} h(t_{(j)} \\mid X_l(t_{(j)}))}$$\nSubstituting the Cox model formulation:\n$$ \\frac{h_0(t_{(j)}) \\exp(\\beta^\\top X_i(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} h_0(t_{(j)}) \\exp(\\beta^\\top X_l(t_{(j)}))} = \\frac{\\exp(\\beta^\\top X_i(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} \\exp(\\beta^\\top X_l(t_{(j)}))} $$\nThe baseline hazard $h_0(t_{(j)})$ cancels. The partial likelihood $L_P(\\beta)$ is the product of these conditional probabilities over all observed events. Let the set of individuals who experience an event be denoted by $\\mathcal{D} = \\{i : \\delta_i = 1\\}$. The partial likelihood is:\n$$ L_P(\\beta) = \\prod_{i \\in \\mathcal{D}} \\frac{\\exp(\\beta^\\top X_i(t_i))}{\\sum_{j \\in R(t_i)} \\exp(\\beta^\\top X_j(t_i))} $$\nThis is the required expression. The left truncation is fully accounted for by the correct definition of the risk set $R(t)$.\n\n### Part 2: Evaluation of the Partial Likelihood\nThe dataset has events at times $t=4$ (Individual $2$), $t=6$ (Individual $1$), and $t=9$ (Individual $4$). The covariate is a single time-invariant variable $x_i$, and $\\beta = \\ln(2)$.\nThe partial likelihood is the product of three terms, one for each event.\n$L_P(\\beta) = L_1 \\times L_2 \\times L_3$, corresponding to the events at $t=4, 6, 9$.\n\n1.  **Event at $t_2=4$ (Individual 2)**\n    The risk set $R(4)$ consists of individuals $j$ for whom $a_j \\le 4 \\le y_j$.\n    -   Individual $1$: $a_1=2, y_1=6$. Condition $2 \\le 4 \\le 6$ is true. In $R(4)$. $x_1 = 1.0$.\n    -   Individual $2$: $a_2=0.5, y_2=4$. Condition $0.5 \\le 4 \\le 4$ is true. In $R(4)$. $x_2 = 0.5$.\n    -   Individual $3$: $a_3=3, y_3=7$. Condition $3 \\le 4 \\le 7$ is true. In $R(4)$. $x_3 = 0.0$.\n    -   Individual $4$: $a_4=5, y_4=9$. Condition $5 \\le 4$ is false. Not in $R(4)$.\n    So, $R(4) = \\{1, 2, 3\\}$. Correct.\n    The term for this event is:\n    $$L_1 = \\frac{\\exp(\\beta x_2)}{\\exp(\\beta x_1) + \\exp(\\beta x_2) + \\exp(\\beta x_3)}$$\n    With $\\beta = \\ln(2)$, the terms $\\exp(\\beta x_i)$ become $\\exp(x_i \\ln(2)) = 2^{x_i}$.\n    $$L_1 = \\frac{2^{0.5}}{2^{1.0} + 2^{0.5} + 2^{0.0}} = \\frac{\\sqrt{2}}{2 + \\sqrt{2} + 1} = \\frac{\\sqrt{2}}{3 + \\sqrt{2}}$$\n\n2.  **Event at $t_1=6$ (Individual 1)**\n    The risk set $R(6)$ consists of individuals $j$ for whom $a_j \\le 6 \\le y_j$.\n    -   Individual $1$: $a_1=2, y_1=6$. Condition $2 \\le 6 \\le 6$ is true. In $R(6)$. $x_1 = 1.0$.\n    -   Individual $2$: $a_2=0.5, y_2=4$. Condition $6 \\le 4$ is false. Not in $R(6)$.\n    -   Individual $3$: $a_3=3, y_3=7$. Condition $3 \\le 6 \\le 7$ is true. In $R(6)$. $x_3 = 0.0$.\n    -   Individual $4$: $a_4=5, y_4=9$. Condition $5 \\le 6 \\le 9$ is true. In $R(6)$. $x_4 = 2.0$.\n    So, $R(6) = \\{1, 3, 4\\}$. Correct.\n    The term for this event is:\n    $$L_2 = \\frac{\\exp(\\beta x_1)}{\\exp(\\beta x_1) + \\exp(\\beta x_3) + \\exp(\\beta x_4)} = \\frac{2^{1.0}}{2^{1.0} + 2^{0.0} + 2^{2.0}} = \\frac{2}{2 + 1 + 4} = \\frac{2}{7}$$\n\n3.  **Event at $t_4=9$ (Individual 4)**\n    The risk set $R(9)$ consists of individuals $j$ for whom $a_j \\le 9 \\le y_j$.\n    -   Individual $1$: $y_1=6$. Condition $9 \\le 6$ is false.\n    -   Individual $2$: $y_2=4$. Condition $9 \\le 4$ is false.\n    -   Individual $3$: $y_3=7$. Condition $9 \\le 7$ is false.\n    -   Individual $4$: $a_4=5, y_4=9$. Condition $5 \\le 9 \\le 9$ is true. In $R(9)$. $x_4 = 2.0$.\n    So, $R(9) = \\{4\\}$. Correct.\n    The term for this event is:\n    $$L_3 = \\frac{\\exp(\\beta x_4)}{\\exp(\\beta x_4)} = \\frac{2^{2.0}}{2^{2.0}} = \\frac{4}{4} = 1$$\n\nThe total partial likelihood is the product of these three terms:\n$$L_P(\\ln(2)) = L_1 \\times L_2 \\times L_3 = \\left( \\frac{\\sqrt{2}}{3 + \\sqrt{2}} \\right) \\times \\left( \\frac{2}{7} \\right) \\times 1 = \\frac{2\\sqrt{2}}{7(3 + \\sqrt{2})}$$\nTo compute the numerical value, we can first rationalize the denominator:\n$$L_P(\\ln(2)) = \\frac{2\\sqrt{2}}{7(3 + \\sqrt{2})} \\times \\frac{3 - \\sqrt{2}}{3 - \\sqrt{2}} = \\frac{2\\sqrt{2}(3 - \\sqrt{2})}{7(3^2 - (\\sqrt{2})^2)} = \\frac{6\\sqrt{2} - 2(2)}{7(9-2)} = \\frac{6\\sqrt{2} - 4}{49}$$\nUsing the numerical value $\\sqrt{2} \\approx 1.41421356$:\n$$L_P(\\ln(2)) \\approx \\frac{6(1.41421356) - 4}{49} = \\frac{8.48528136 - 4}{49} = \\frac{4.48528136}{49} \\approx 0.091536354$$\nRounding to four significant figures, the result is $0.09154$.\n\n### Part 3: Assumptions for Valid Inference\nFor valid inference using the Cox model with left-truncated and right-censored data, several key assumptions are required.\n\n1.  **Proportional Hazards (PH)**: The hazard ratio between any two individuals is constant over time, i.e., $h(t|X_i)/h(t|X_j)$ is independent of $t$.\n    *   **Necessity**: This is the fundamental assumption of the Cox model. It allows the effect of covariates ($\\beta$) to be separated from the effect of time ($h_0(t)$), which enables the construction of the partial likelihood where $h_0(t)$ cancels out. In a natural history study, this implies that a covariate's multiplicative effect on risk (e.g., of disease progression) does not change over the course of the illness. Violation requires more complex models, such as those with time-dependent coefficients.\n\n2.  **Independent Censoring**: The mechanism causing an individual to be right-censored must be independent of their underlying risk of the event. An individual's censoring time provides no information about their event time beyond what is available in the covariates.\n    *   **Necessity**: If censoring is informative (e.g., patients who are sicker are more likely to drop out of the study), the remaining sample becomes biased. The observed event rates will not be representative of the true rates, leading to biased estimates of $\\beta$. In a natural history study, right censoring may occur due to study termination (non-informative) or loss to follow-up. If loss to follow-up is related to disease severity, this assumption is violated.\n\n3.  **Independent (or Non-Informative) Left Truncation**: The time of entry into the study, $a_i$, must be independent of the event time $T_i$, conditional on covariates. This is a strong assumption. A weaker, sufficient condition is that, for any individual in the risk set at time $t$, their entry time $a_i < t$ does not predict their future risk.\n    *   **Necessity**: The partial likelihood relies on conditioning on the risk sets at each event time. This implicitly assumes that the process determining who is in the risk set (i.e., the truncation process) is non-informative about the relative risks of the individuals currently being observed. In the context of a natural history study where entry is at diagnosis, this assumption is violated if the timing of diagnosis is related to the aggressiveness of the disease. For instance, if patients with more aggressive disease are diagnosed earlier, then at any given time $t$, the risk set will be depleted of individuals who had early aggressive disease, leading to a biased sample and potentially underestimating risk effects.\n\n4.  **Independence of Individuals**: The event times of different individuals in the study are statistically independent.\n    *   **Necessity**: The total likelihood is constructed as a product of individual likelihood contributions. This step is only valid if the observations are independent. In a natural history study, this is usually a reasonable assumption, unless there are unmeasured confounding factors that cluster within groups of subjects (e.g., genetic factors within families, or shared environmental exposures).", "answer": "$$\\boxed{0.09154}$$", "id": "5034739"}]}