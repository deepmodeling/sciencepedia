{"hands_on_practices": [{"introduction": "The foundation of any non-inferiority (NI) trial is its margin, the pre-specified boundary of acceptable inferiority. This margin can be defined on a relative scale (e.g., risk ratio) or an absolute scale (e.g., risk difference), and the choice has profound implications. This exercise demonstrates the crucial skill of translating a margin from one scale to another, revealing its dependence on the baseline event rate and highlighting the importance of this relationship for robust trial design and sensitivity analysis. [@problem_id:5065077]", "problem": "A translational medicine team is designing a non-inferiority (NI) trial comparing an investigational therapy to a standard-of-care control on an undesirable binary clinical endpoint (e.g., a serious adverse event). The NI margin has been justified on the risk ratio (RR) scale as $\\Delta_{\\text{NI}} = 1.3$, meaning the investigational therapy will be considered non-inferior if its event probability does not exceed $1.3$ times the control event probability. The design team wishes to express the same NI margin on the risk difference (RD) scale to facilitate sample size planning under absolute risk assumptions and to make monitoring rules interpretable on an absolute scale.\n\nStarting only from the fundamental definitions of the risk ratio $RR = \\frac{p_{T}}{p_{C}}$ and the risk difference $RD = p_{T} - p_{C}$, where $p_{T}$ and $p_{C}$ denote the event probabilities for the test (investigational) and control arms respectively, derive the risk difference NI margin as a function of $p_C$ and then compute its numerical value at a control event rate of $p_C = 0.20$. Express the final numerical translation as a decimal proportion without using a percentage sign.\n\nThen, explain how the dependence of the risk difference margin on $p_C$ should inform trial design choices, including implications for margin robustness when $p_C$ is uncertain at the planning stage and how this sensitivity might affect sample size under absolute-risk-driven assumptions. Your explanation should be grounded in first principles and must not invoke any pre-given conversion formulas. The numerical answer does not require rounding; provide the exact value.", "solution": "We begin by establishing the mathematical relationship between the non-inferiority (NI) margins on the risk ratio ($RR$) and risk difference ($RD$) scales, starting from first principles.\n\nThe problem provides the following definitions:\nThe risk ratio is defined as $RR = \\frac{p_T}{p_C}$.\nThe risk difference is defined as $RD = p_T - p_C$.\nHere, $p_T$ is the event probability in the investigational therapy arm, and $p_C$ is the event probability in the standard-of-care control arm.\n\nThe non-inferiority margin on the risk ratio scale is given as $\\Delta_{\\text{NI(RR)}} = 1.3$. This margin defines the boundary of acceptable inferiority. An investigational therapy is considered non-inferior if the true risk ratio is not greater than this value. At this boundary, the event probability in the test arm, which we can denote as $p_{T, \\text{margin}}$, is precisely $1.3$ times the probability in the control arm.\nMathematically, this boundary condition is expressed as:\n$$p_{T, \\text{margin}} = \\Delta_{\\text{NI(RR)}} \\times p_C$$\n\nThe non-inferiority margin on the risk difference scale, $\\Delta_{\\text{NI(RD)}}$, is the value of the risk difference, $p_T - p_C$, evaluated at this same boundary of non-inferiority. To find this, we substitute the expression for $p_{T, \\text{margin}}$ into the definition of the risk difference:\n$$\\Delta_{\\text{NI(RD)}} = p_{T, \\text{margin}} - p_C$$\n$$\\Delta_{\\text{NI(RD)}} = (\\Delta_{\\text{NI(RR)}} \\times p_C) - p_C$$\n\nFactoring out $p_C$ gives the general expression for the risk difference NI margin as a function of the control event rate $p_C$ and the risk ratio NI margin $\\Delta_{\\text{NI(RR)}}$:\n$$\\Delta_{\\text{NI(RD)}} = p_C (\\Delta_{\\text{NI(RR)}} - 1)$$\nThis is the derived function for the risk difference NI margin.\n\nNext, we compute the numerical value of this margin for the specific case where the control event rate is $p_C = 0.20$ and the risk ratio margin is $\\Delta_{\\text{NI(RR)}} = 1.3$.\nSubstituting these values into our derived formula:\n$$\\Delta_{\\text{NI(RD)}} = 0.20 \\times (1.3 - 1)$$\n$$\\Delta_{\\text{NI(RD)}} = 0.20 \\times 0.3$$\n$$\\Delta_{\\text{NI(RD)}} = 0.06$$\nThus, a risk ratio margin of $1.3$ with a control event rate of $20\\%$ is equivalent to an absolute risk difference margin of $6\\%$, or $0.06$.\n\nThe dependence of the risk difference margin on $p_C$, as shown by the formula $\\Delta_{\\text{NI(RD)}} = p_C (\\Delta_{\\text{NI(RR)}} - 1)$, has critical implications for trial design.\n\nFirst, it affects margin robustness. A constant relative margin ($\\Delta_{\\text{NI(RR)}}$) implies a variable absolute margin ($\\Delta_{\\text{NI(RD)}}$) that is directly proportional to the baseline risk $p_C$. If the true control event rate in the trial population is lower than the assumed $p_C = 0.20$, the equivalent absolute risk margin becomes more stringent. For instance, if the true $p_C$ is $0.10$, the RD margin shrinks to $\\Delta_{\\text{NI(RD)}} = 0.10 \\times (1.3 - 1) = 0.03$. Conversely, if $p_C$ is higher, say $0.30$, the margin becomes more lenient: $\\Delta_{\\text{NI(RD)}} = 0.30 \\times (1.3 - 1) = 0.09$. This means the clinical acceptability of a risk ratio margin is implicitly tied to an assumed baseline risk. Trial designers must conduct sensitivity analyses to ensure that the implied absolute risk increase remains clinically acceptable across a plausible range of $p_C$ values that might be observed in the trial.\n\nSecond, this dependence profoundly impacts sample size calculations. The sample size ($N$) for a non-inferiority trial is highly sensitive to the magnitude of the NI margin. For a test of two proportions, the required sample size is inversely proportional to the square of the margin, i.e., $N \\propto (\\Delta_{\\text{NI(RD)}})^{-2}$. The sample size is also dependent on the variance of the endpoint, which for binomial proportions is a function of the event probabilities themselves (approximately proportional to $p_C(1-p_C)$). Combining these dependencies, and assuming equal allocation and that the true rates $p_T$ and $p_C$ are close, the total sample size $N$ can be approximated as being proportional to:\n$$N \\propto \\frac{p_C(1-p_C) + p_T(1-p_T)}{(\\Delta_{\\text{NI(RD)}})^2}$$\nSubstituting our derived expression for $\\Delta_{\\text{NI(RD)}}$ and assuming $p_T \\approx p_C$ for the variance term:\n$$N \\propto \\frac{2 p_C(1-p_C)}{[p_C(\\Delta_{\\text{NI(RR)}} - 1)]^2} = \\frac{2 p_C(1-p_C)}{p_C^2 (\\Delta_{\\text{NI(RR)}} - 1)^2} = \\frac{2(1-p_C)}{p_C(\\Delta_{\\text{NI(RR)}} - 1)^2}$$\nSince $\\Delta_{\\text{NI(RR)}}$ is a fixed constant for the design, this reveals that the necessary sample size $N$ is approximately proportional to $\\frac{1-p_C}{p_C}$. This demonstrates a strong inverse relationship between the sample size and the control event rate $p_C$. If the actual control event rate during the trial is lower than the rate assumed for planning ($p_C = 0.20$), the required sample size to maintain statistical power will be substantially larger. For instance, halving $p_C$ from $0.20$ to $0.10$ would approximately double the required sample size. Therefore, uncertainty in $p_C$ at the planning stage translates to significant risk of conducting an underpowered study. Trial designers must account for this by either choosing a conservative (i.e., low) estimate for $p_C$ in their primary sample size calculation or planning for adaptive measures such as sample size re-estimation based on the observed control rate.", "answer": "$$\n\\boxed{0.06}\n$$", "id": "5065077"}, {"introduction": "Once the non-inferiority margin is established, a trial must be meticulously planned to ensure it has sufficient statistical power to yield a conclusive result. The cornerstone of this planning is the sample size calculation, a process that integrates the margin, expected outcomes, and desired levels of statistical confidence. This practice provides a detailed, step-by-step guide to calculating the required sample size for a two-arm non-inferiority trial, a fundamental task for any trial designer. [@problem_id:4843404]", "problem": "A two-arm parallel non-inferiority trial is planned to compare a new therapy to a control on a binary clinical endpoint. Let $p_C$ and $p_T$ denote the control and treatment event probabilities, respectively. The non-inferiority margin on the risk difference scale is $\\Delta > 0$, and the non-inferiority hypothesis is formulated as $H_0: p_T - p_C \\leq -\\Delta$ versus $H_1: p_T - p_C > -\\Delta$. Assume independent Bernoulli outcomes and equal allocation of $n$ subjects per arm.\n\nStarting from the Central Limit Theorem (CLT) applied to independent binomial samples, model the difference in sample proportions by a normal approximation with mean $p_T - p_C$ and variance $\\frac{p_T(1 - p_T)}{n} + \\frac{p_C(1 - p_C)}{n}$. Use a one-sided type I error rate $\\alpha$ and target power $1 - \\beta$. To account for the discreteness of the binomial difference, include a continuity correction equal to one half the step size of the difference in proportions when both arms have size $n$, that is, subtract $1/(2n)$ from the numerator of the standardized test statistic.\n\nUnder the planning alternative $p_C = 0.20$ and $p_T = 0.22$, with margin $\\Delta = 0.05$, significance level $\\alpha = 0.025$ (one-sided), and power $1 - \\beta = 0.90$, determine the required per-arm sample size $n$ using the continuity-corrected normal approximation. Specifically, find the minimal integer $n$ such that the continuity-corrected standardized non-inferiority statistic equals the sum of the corresponding upper-tail quantiles of the Standard Normal Distribution (SND), and report this minimal $n$ as your final answer. Express the final answer as a single integer. No unit is required.", "solution": "The problem requires a sample size calculation for a two-arm non-inferiority trial with a binary outcome. The hypotheses are given as:\n$$ H_0: p_T - p_C \\leq -\\Delta $$\n$$ H_1: p_T - p_C > -\\Delta $$\n\nWe are given the planning values under the alternative hypothesis $H_1$: $p_{C,A} = 0.20$ and $p_{T,A} = 0.22$. The true difference under this alternative is $d_A = p_{T,A} - p_{C,A} = 0.22 - 0.20 = 0.02$. The non-inferiority margin is $\\Delta = 0.05$.\n\nThe required one-sided significance level is $\\alpha = 0.025$, and the power is $1-\\beta = 0.90$ (so $\\beta = 0.10$). The corresponding upper-tail quantiles of the standard normal distribution (SND) are:\n$z_\\alpha = z_{0.025} \\approx 1.959964$\n$z_\\beta = z_{0.10} \\approx 1.281552$\n\nThe problem specifies a particular formulation where the expected value of the standardized statistic under the alternative equals $z_\\alpha + z_\\beta$. The effect size is the distance between the alternative hypothesis ($d_A$) and the null boundary ($-\\Delta$), which is $d_A - (-\\Delta) = d_A + \\Delta$. The problem specifies a continuity correction (C.C.) of $1/(2n)$ to be subtracted from this effect size. The standard deviation of the difference in proportions, $\\hat{p}_T - \\hat{p}_C$, is calculated under the alternative. Let its variance be $\\sigma_A^2 = \\frac{V_A}{n}$, where $V_A = p_{T,A}(1-p_{T,A}) + p_{C,A}(1-p_{C,A})$.\n\nThe condition given in the problem translates to the equation:\n$$ \\frac{(d_A + \\Delta) - C.C.}{\\sigma_A} = z_\\alpha + z_\\beta $$\n$$ \\frac{d_A + \\Delta - \\frac{1}{2n}}{\\frac{\\sqrt{V_A}}{\\sqrt{n}}} = z_\\alpha + z_\\beta $$\nThis is the equation we must solve for $n$. First, we calculate the constant terms:\n$d_A + \\Delta = 0.02 + 0.05 = 0.07$.\n$V_A = 0.22(1-0.22) + 0.20(1-0.20) = 0.22(0.78) + 0.20(0.80) = 0.1716 + 0.1600 = 0.3316$.\n$\\sqrt{V_A} = \\sqrt{0.3316} \\approx 0.5758472$.\n$z_\\alpha + z_\\beta \\approx 1.959964 + 1.281552 = 3.241516$.\n\nThe equation becomes:\n$$ \\left(0.07 - \\frac{1}{2n}\\right)\\sqrt{n} = (z_\\alpha + z_\\beta)\\sqrt{V_A} $$\n$$ 0.07\\sqrt{n} - \\frac{1}{2\\sqrt{n}} = (3.241516)(0.5758472) \\approx 1.866785 $$\nLet $y = \\sqrt{n}$ and $K = 1.866785$.\n$$ 0.07y - \\frac{0.5}{y} = K $$\nMultiplying by $y$ (since $y=\\sqrt{n}>0$) gives a quadratic equation in $y$:\n$$ 0.07y^2 - Ky - 0.5 = 0 $$\nWe solve for $y$ using the quadratic formula $y = \\frac{-b + \\sqrt{b^2-4ac}}{2a}$, with $a=0.07$, $b=-K$, and $c=-0.5$. Since $y>0$, we take the positive root.\n$$ y = \\frac{K + \\sqrt{(-K)^2 - 4(0.07)(-0.5)}}{2(0.07)} $$\n$$ y = \\frac{K + \\sqrt{K^2 + 0.14}}{0.14} $$\nSubstitute the value of $K$:\n$K^2 \\approx (1.866785)^2 \\approx 3.484863$.\n$$ y = \\frac{1.866785 + \\sqrt{3.484863 + 0.14}}{0.14} $$\n$$ y = \\frac{1.866785 + \\sqrt{3.624863}}{0.14} $$\n$$ y \\approx \\frac{1.866785 + 1.9039073}{0.14} = \\frac{3.7706923}{0.14} \\approx 26.933516 $$\nSince $y = \\sqrt{n}$, we have $n = y^2$:\n$$ n \\approx (26.933516)^2 \\approx 725.414 $$\nThe sample size $n$ must be an integer. To meet the power requirement, we must round up to the next integer.\n$$ n = \\lceil 725.414 \\rceil = 726 $$\nTherefore, the minimal required sample size per arm is $726$.", "answer": "$$\\boxed{726}$$", "id": "4843404"}, {"introduction": "Interpreting the results of a non-inferiority trial requires awareness of unique analytical pitfalls. A critical example is the effect of the intention-to-treat (ITT) principle, which, while conservative in superiority trials, can be anti-conservative in the NI setting by biasing the result toward a false claim of non-inferiority. This exercise provides a hands-on derivation to quantify how patient non-adherence attenuates the true treatment effect under an ITT analysis, a vital lesson in avoiding misinterpretation of trial outcomes. [@problem_id:5065051]", "problem": "A randomized, active-control non-inferiority trial in translational medicine evaluates a new therapy versus standard care on a binary adverse outcome. Let the risk difference be defined on the intention-to-treat scale as $RD = p_T - p_C$, where $p_T$ and $p_C$ are the risks under new therapy and control, respectively. Assume the per-protocol causal effect is $RD_{\\text{true}} = -0.06$, meaning the new therapy reduces risk by $0.06$ compared with control. The non-inferiority margin on the risk difference scale is $\\delta = -0.05$.\n\nSuppose there is all-or-nothing nonadherence with symmetric contamination: in each randomized arm, a fraction $\\pi = 0.15$ actually receives the opposite therapy, while the remaining fraction $1 - \\pi$ receives the therapy corresponding to their randomized assignment. Randomization is $1:1$, and nonadherence is unrelated to prognosis beyond treatment actually received. Intention-To-Treat (ITT) analysis compares outcomes by randomized assignment, ignoring adherence.\n\nStarting from core definitions of mixture risks under randomization and adherence, derive the ITT estimand $RD_{\\text{obs}}$ as a function of $RD_{\\text{true}}$ and $\\pi$, and use it to quantify the bias toward non-inferiority induced by ITT under contamination, defined as\n$$B \\equiv \\big(RD_{\\text{obs}} - \\delta\\big) - \\big(RD_{\\text{true}} - \\delta\\big).$$\nProvide your final answer as a single exact decimal with no units. Do not round.", "solution": "The objective is to derive the Intention-To-Treat (ITT) estimand, $RD_{\\text{obs}}$, as a function of the true per-protocol risk difference, $RD_{\\text{true}}$, and the nonadherence fraction, $\\pi$. Subsequently, we must calculate the bias, $B$.\n\nThe ITT analysis compares outcomes based on the initial randomization assignment, regardless of the treatment actually received. We define the observed risks in each randomized arm. Let $P(\\text{Outcome} | \\text{Rand T})$ be the probability of the adverse outcome in the group randomized to the new therapy, and $P(\\text{Outcome} | \\text{Rand C})$ be the probability in the group randomized to the control.\n\nIn the group randomized to the new therapy (Arm T), a fraction $1 - \\pi$ receives the new therapy (with risk $p_T$) and a fraction $\\pi$ receives the control therapy due to contamination (with risk $p_C$). The overall risk in this arm is a weighted average:\n$$P(\\text{Outcome} | \\text{Rand T}) = (1 - \\pi) p_T + \\pi p_C$$\n\nSimilarly, in the group randomized to the control (Arm C), a fraction $1 - \\pi$ receives the control therapy (with risk $p_C$) and a fraction $\\pi$ receives the new therapy due to contamination (with risk $p_T$). The overall risk in this arm is:\n$$P(\\text{Outcome} | \\text{Rand C}) = \\pi p_T + (1 - \\pi) p_C$$\n\nThe observed risk difference from an ITT analysis, $RD_{\\text{obs}}$, is the difference between these two observed risks:\n$$RD_{\\text{obs}} = P(\\text{Outcome} | \\text{Rand T}) - P(\\text{Outcome} | \\text{Rand C})$$\nSubstituting the expressions for the observed risks:\n$$RD_{\\text{obs}} = \\big[ (1 - \\pi) p_T + \\pi p_C \\big] - \\big[ \\pi p_T + (1 - \\pi) p_C \\big]$$\nWe can group the terms by $p_T$ and $p_C$:\n$$RD_{\\text{obs}} = p_T (1 - \\pi - \\pi) + p_C (\\pi - (1 - \\pi))$$\n$$RD_{\\text{obs}} = p_T (1 - 2\\pi) + p_C (\\pi - 1 + \\pi)$$\n$$RD_{\\text{obs}} = p_T (1 - 2\\pi) - p_C (1 - 2\\pi)$$\nFactoring out the common term $(1 - 2\\pi)$:\n$$RD_{\\text{obs}} = (p_T - p_C) (1 - 2\\pi)$$\nBy definition, the true per-protocol risk difference is $RD_{\\text{true}} = p_T - p_C$. Therefore, we can express the observed ITT risk difference as:\n$$RD_{\\text{obs}} = RD_{\\text{true}} (1 - 2\\pi)$$\nThis equation shows that symmetric nonadherence attenuates the true effect by a factor of $(1 - 2\\pi)$, biasing the result towards the null hypothesis of no difference ($RD = 0$).\n\nNext, we calculate the bias, $B$, as defined in the problem statement:\n$$B \\equiv \\big(RD_{\\text{obs}} - \\delta\\big) - \\big(RD_{\\text{true}} - \\delta\\big)$$\nSimplifying this expression, the non-inferiority margin $\\delta$ cancels out:\n$$B = RD_{\\text{obs}} - \\delta - RD_{\\text{true}} + \\delta$$\n$$B = RD_{\\text{obs}} - RD_{\\text{true}}$$\nThis bias represents the difference between the observed ITT effect and the true per-protocol effect.\n\nNow, we substitute our derived expression for $RD_{\\text{obs}}$ into the formula for $B$:\n$$B = \\big[ RD_{\\text{true}} (1 - 2\\pi) \\big] - RD_{\\text{true}}$$\n$$B = RD_{\\text{true}} - 2\\pi \\cdot RD_{\\text{true}} - RD_{\\text{true}}$$\n$$B = -2\\pi \\cdot RD_{\\text{true}}$$\n\nFinally, we substitute the given numerical values, $\\pi = 0.15$ and $RD_{\\text{true}} = -0.06$, to find the value of $B$:\n$$B = -2 \\times (0.15) \\times (-0.06)$$\n$$B = -0.30 \\times (-0.06)$$\n$$B = 0.018$$", "answer": "$$\\boxed{0.018}$$", "id": "5065051"}]}