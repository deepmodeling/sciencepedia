{"hands_on_practices": [{"introduction": "A primary motivation for employing master protocols is to accelerate clinical development by improving operational efficiency. This is particularly evident in patient accrual, where a unified screening infrastructure can identify and enroll eligible patients for multiple substudies far more quickly than siloed, independent trials. This hands-on exercise [@problem_id:5028933] allows you to quantify this advantage by modeling patient arrivals with a Poisson process, a foundational tool in clinical trial operations, to calculate the expected reduction in trial duration.", "problem": "A health system is planning to evaluate three candidate therapies under a master protocol in translational oncology. Each therapy targets a distinct, mutually exclusive biomarker-defined subtype of the same disease, and each subtype has the same prevalence. The system has a centralized prescreening capability that can test for all three biomarkers simultaneously, and an alternative plan with three independent trials in which each trial runs its own separate screening pipeline limited by the same overall resource constraints.\n\nAssume the following scientifically grounded scenario:\n- The flow of patients entering prescreening is well approximated by a homogeneous Poisson process with annual rate $A$ patients per year.\n- Each screened patient is independently positive for the biomarker criterion relevant to any single therapy with probability $p$, and the therapy-specific biomarkers are mutually exclusive across patients. Thus, for any fixed therapy, the positivity probability is $p$.\n- Under the master protocol with shared screening, all three biomarkers are assessed for each screened patient in one pass, and any patient found positive for a given biomarker is allocated to the corresponding therapy arm immediately.\n- Under the three independent trials with separate pipelines, the total prescreening capacity is split equally across the three trials, so each trial screens at rate $A/3$ and assesses only its own biomarker.\n\nSuppose each therapy requires $n$ eligible patients to reach the interim analysis of a signal-seeking stage, and all three arms run concurrently until each accrues $n$ eligible patients. Starting from the core definition of a homogeneous Poisson process and the law of rare events for independent Bernoulli thinning, derive the expression for the expected calendar time to reach $n$ eligible patients per arm under each strategy, and then compute the expected calendar time reduction (in years) achieved by the master protocol relative to the independent trials.\n\nUse the parameters $A=600$ patients per year, $p=0.2$, and $n=150$ eligible patients per therapy. Round your final answer to four significant figures and express your result in years.", "solution": "The foundation of this problem is the properties of a homogeneous Poisson process. The stream of patients arriving for screening is modeled as a Poisson process with a constant rate $A$.\n\nA key theorem of stochastic processes states that if a Poisson process with rate $\\lambda$ is \"thinned\" by subjecting each event to an independent Bernoulli trial with probability of success $p$, the resulting process of \"successes\" is also a homogeneous Poisson process with a new, lower rate of $\\lambda' = \\lambda p$. This is known as Poisson thinning or splitting.\n\n**Strategy 1: Master Protocol**\n\nUnder the master protocol, all incoming patients are screened from a single pool at a rate of $A$ patients per year. Each patient is assessed for all three mutually exclusive biomarkers. For any single therapy arm, a randomly selected patient is eligible if they are positive for that arm's specific biomarker. This occurs with probability $p$.\n\nWe can therefore model the arrival of eligible patients for any specific arm (e.g., arm $i$) as a thinned Poisson process.\nThe original rate is $\\lambda_{total} = A$.\nThe probability of being eligible for arm $i$ is $p$.\nThe rate of arrival of eligible patients for arm $i$ is therefore:\n$$ \\lambda_{MP} = A \\cdot p $$\nThe time to accrue $n$ patients for this arm, let us call it $T_{MP}$, is the waiting time for the $n$-th event in a Poisson process with rate $\\lambda_{MP}$. This waiting time follows an Erlang distribution, which is a special case of the Gamma distribution. The expected value of this waiting time is given by the number of events $n$ divided by the rate $\\lambda_{MP}$.\nThus, the expected calendar time to accrue $n$ patients for a single arm under the master protocol is:\n$$ E[T_{MP}] = \\frac{n}{\\lambda_{MP}} = \\frac{n}{Ap} $$\n\n**Strategy 2: Independent Trials**\n\nUnder the independent trials strategy, the total screening capacity $A$ is divided equally among the three trials. Each trial thus operates its own screening pipeline with an input flow of patients at a rate of $A/3$. Each pipeline screens only for its one specific biomarker.\n\nFor a single one of these independent trials, the arrival process of eligible patients is again a thinned Poisson process.\nThe original rate for this single trial is $\\lambda_{trial} = \\frac{A}{3}$.\nThe probability of a patient being eligible is $p$.\nThe rate of arrival of eligible patients for this single trial is:\n$$ \\lambda_{Ind} = \\lambda_{trial} \\cdot p = \\frac{A}{3} \\cdot p = \\frac{Ap}{3} $$\nThe expected calendar time to accrue $n$ patients for this arm, $E[T_{Ind}]$, is similarly given by $n$ divided by the rate $\\lambda_{Ind}$:\n$$ E[T_{Ind}] = \\frac{n}{\\lambda_{Ind}} = \\frac{n}{Ap/3} = \\frac{3n}{Ap} $$\n\n**Expected Calendar Time Reduction**\n\nThe expected calendar time reduction, $\\Delta T$, achieved by the master protocol relative to the independent trials is the difference between their expected accrual times.\n$$ \\Delta T = E[T_{Ind}] - E[T_{MP}] $$\nSubstituting the derived expressions:\n$$ \\Delta T = \\frac{3n}{Ap} - \\frac{n}{Ap} = \\frac{2n}{Ap} $$\nThis expression represents the expected time savings in years. The master protocol is three times as efficient in patient accrual per arm ($ \\lambda_{MP} = 3 \\lambda_{Ind} $), so the expected time for each arm is one-third as long. The reduction in time is therefore two-thirds of the time required for the independent trial strategy.\n\n**Numerical Calculation**\n\nWe are given the following parameters:\n- Annual screening rate, $A = 600$ patients/year.\n- Biomarker positivity probability, $p = 0.2$.\n- Required patients per arm, $n = 150$.\n\nSubstituting these values into the derived expression for $\\Delta T$:\n$$ \\Delta T = \\frac{2 \\times 150}{600 \\times 0.2} $$\nFirst, calculate the denominator:\n$$ 600 \\times 0.2 = 120 $$\nNow, calculate the fraction:\n$$ \\Delta T = \\frac{2 \\times 150}{120} = \\frac{300}{120} = \\frac{30}{12} $$\nSimplifying the fraction:\n$$ \\Delta T = \\frac{5 \\times 6}{2 \\times 6} = \\frac{5}{2} = 2.5 $$\nThe expected calendar time reduction is $2.5$ years. The problem requires the answer to be rounded to four significant figures. Therefore, the final numerical answer is $2.500$.", "answer": "$$\\boxed{2.500}$$", "id": "5028933"}, {"introduction": "The scientific premise of many basket and umbrella trials hinges on accurately identifying patients with a specific biomarker. However, the diagnostic assays used for this purpose are not infallible and are subject to misclassification errors, meaning some patients without the biomarker are included (false positives) and some with it are missed. This practice [@problem_id:5028949] delves into the statistical consequences of this reality, guiding you to derive how an imperfect assay systematically dilutes the observed treatment effect, a critical concept for correctly interpreting the outcomes of biomarker-driven trials.", "problem": "In a platform master protocol evaluating a targeted therapy versus control in a single biomarker-defined module, patients are screened using a binary assay for a predictive biomarker. Let the true biomarker status be $S \\in \\{0,1\\}$ and the observed test result be $B \\in \\{0,1\\}$. The assay has sensitivity $Se = \\mathbb{P}(B=1 \\mid S=1)$ and specificity $Sp = \\mathbb{P}(B=0 \\mid S=0)$. Patients with $B=1$ are randomized 1:1 to targeted therapy ($T=1$) or control ($T=0$), and the primary analysis compares response risk between $T=1$ and $T=0$ within the $B=1$ subgroup. Assume the following data-generating model on the additive risk scale: for a binary outcome $Y \\in \\{0,1\\}$,\n$ \\mathbb{E}[Y \\mid T,S] = \\mu + \\tau T + \\gamma S + \\psi\\, T S, $\nwith $T \\perp S$ by randomization and $\\mathbb{E}[\\varepsilon \\mid T,S] = 0$ for $\\varepsilon = Y - \\mathbb{E}[Y \\mid T,S]$. Suppose the therapy is purely predictive, so that the treatment effect is present only in true biomarker-positives, i.e., $\\psi = \\Delta$ for some constant $\\Delta \\in (0,1)$, while $\\tau = 0$. Let the true biomarker prevalence in the screened population be $\\pi = \\mathbb{P}(S=1)$.\n\nDefine the expected dilution of treatment effect due to biomarker misclassification in this two-arm comparison as the multiplicative attenuation factor $D$ relating the observed risk difference within the $B=1$ subgroup, $\\text{RD}_{\\text{obs}} = \\mathbb{E}[Y \\mid T=1,B=1] - \\mathbb{E}[Y \\mid T=0,B=1]$, to the true effect among biomarker-positives, $\\Delta$, i.e., $D = \\text{RD}_{\\text{obs}} / \\Delta$.\n\nStarting from the definitions of sensitivity, specificity, and Bayesâ€™ theorem, derive $D$ in terms of $Se$, $Sp$, and $\\pi$. Then, using $Se = 0.9$, $Sp = 0.95$, and $\\pi = 0.2$, compute $D$. Express the final answer as a single real number. Do not use a percent sign. No rounding is required; provide the exact value if it is a rational number.", "solution": "The problem requires the derivation of the dilution factor $D$ for the treatment effect in a biomarker-selected population, where the biomarker assay is imperfect. The dilution factor is defined as $D = \\frac{\\text{RD}_{\\text{obs}}}{\\Delta}$, where $\\text{RD}_{\\text{obs}}$ is the observed risk difference in the assay-positive subgroup ($B=1$) and $\\Delta$ is the true treatment effect in the biomarker-positive subgroup ($S=1$).\n\nFirst, we express the observed risk difference, $\\text{RD}_{\\text{obs}}$, using its definition:\n$$ \\text{RD}_{\\text{obs}} = \\mathbb{E}[Y \\mid T=1,B=1] - \\mathbb{E}[Y \\mid T=0,B=1] $$\nTo evaluate the conditional expectations, we use the law of total expectation, conditioning on the true biomarker status $S \\in \\{0, 1\\}$. For a generic treatment status $T$, the expectation is:\n$$ \\mathbb{E}[Y \\mid T, B=1] = \\sum_{s \\in \\{0,1\\}} \\mathbb{E}[Y \\mid T, B=1, S=s] \\cdot \\mathbb{P}(S=s \\mid T, B=1) $$\nA standard assumption in this context is that the observed biomarker status $B$ is conditionally independent of the outcome $Y$ given the true status $S$ and the treatment $T$. This means the assay result itself does not influence the outcome once we know the true biological state. Therefore, $\\mathbb{E}[Y \\mid T, B=1, S=s] = \\mathbb{E}[Y \\mid T, S=s]$.\nFurthermore, since treatment $T$ is assigned by randomization after the biomarker status $B$ is observed, $T$ is independent of pre-randomization variables, including both $B$ and $S$. Thus, $\\mathbb{P}(S=s \\mid T, B=1) = \\mathbb{P}(S=s \\mid B=1)$.\n\nThe expression for the conditional expectation simplifies to:\n$$ \\mathbb{E}[Y \\mid T, B=1] = \\mathbb{E}[Y \\mid T, S=1] \\cdot \\mathbb{P}(S=1 \\mid B=1) + \\mathbb{E}[Y \\mid T, S=0] \\cdot \\mathbb{P}(S=0 \\mid B=1) $$\nThe term $\\mathbb{P}(S=1 \\mid B=1)$ is the positive predictive value ($PPV$) of the assay. Let us denote $PPV = \\mathbb{P}(S=1 \\mid B=1)$, so $\\mathbb{P}(S=0 \\mid B=1) = 1 - PPV$.\n\nNext, we substitute the given data-generating model for the outcome, $\\mathbb{E}[Y \\mid T,S] = \\mu + \\tau T + \\gamma S + \\psi TS$. The problem states that the therapy is purely predictive, so $\\tau=0$ and the interaction effect is $\\psi = \\Delta$.\nFor true biomarker-positives ($S=1$):\n$$ \\mathbb{E}[Y \\mid T, S=1] = \\mu + (0)T + \\gamma(1) + \\Delta T(1) = \\mu + \\gamma + \\Delta T $$\nFor true biomarker-negatives ($S=0$):\n$$ \\mathbb{E}[Y \\mid T, S=0] = \\mu + (0)T + \\gamma(0) + \\Delta T(0) = \\mu $$\nSubstituting these into the expression for $\\mathbb{E}[Y \\mid T, B=1]$:\n$$ \\mathbb{E}[Y \\mid T, B=1] = (\\mu + \\gamma + \\Delta T) \\cdot PPV + \\mu \\cdot (1 - PPV) $$\nExpanding and simplifying this expression:\n$$ \\mathbb{E}[Y \\mid T, B=1] = \\mu \\cdot PPV + \\gamma \\cdot PPV + \\Delta T \\cdot PPV + \\mu - \\mu \\cdot PPV $$\n$$ \\mathbb{E}[Y \\mid T, B=1] = \\mu + \\gamma \\cdot PPV + (\\Delta \\cdot PPV)T $$\nThis expression gives the expected outcome in the assay-positive group as a linear function of treatment $T$.\n\nNow, we can compute the terms for the observed risk difference, $\\text{RD}_{\\text{obs}}$.\nFor the treatment group ($T=1$):\n$$ \\mathbb{E}[Y \\mid T=1, B=1] = \\mu + \\gamma \\cdot PPV + \\Delta \\cdot PPV $$\nFor the control group ($T=0$):\n$$ \\mathbb{E}[Y \\mid T=0, B=1] = \\mu + \\gamma \\cdot PPV $$\nThe observed risk difference is the difference between these two expectations:\n$$ \\text{RD}_{\\text{obs}} = (\\mu + \\gamma \\cdot PPV + \\Delta \\cdot PPV) - (\\mu + \\gamma \\cdot PPV) = \\Delta \\cdot PPV $$\nThis result shows that the observed treatment effect is the true effect $\\Delta$ attenuated by the positive predictive value of the assay.\n\nThe dilution factor $D$ is defined as $D = \\frac{\\text{RD}_{\\text{obs}}}{\\Delta}$. Substituting our result for $\\text{RD}_{\\text{obs}}$:\n$$ D = \\frac{\\Delta \\cdot PPV}{\\Delta} = PPV $$\nSo, the dilution factor is simply the positive predictive value, $D = \\mathbb{P}(S=1 \\mid B=1)$.\n\nThe next step is to express $PPV$ in terms of the given parameters: sensitivity $Se = \\mathbb{P}(B=1 \\mid S=1)$, specificity $Sp = \\mathbb{P}(B=0 \\mid S=0)$, and prevalence $\\pi = \\mathbb{P}(S=1)$.\nUsing Bayes' theorem:\n$$ PPV = \\mathbb{P}(S=1 \\mid B=1) = \\frac{\\mathbb{P}(B=1 \\mid S=1) \\mathbb{P}(S=1)}{\\mathbb{P}(B=1)} $$\nThe numerator is $Se \\cdot \\pi$. The denominator, $\\mathbb{P}(B=1)$, is the overall probability of testing positive, which can be found using the law of total probability:\n$$ \\mathbb{P}(B=1) = \\mathbb{P}(B=1 \\mid S=1)\\mathbb{P}(S=1) + \\mathbb{P}(B=1 \\mid S=0)\\mathbb{P}(S=0) $$\nWe are given $\\mathbb{P}(S=1) = \\pi$, so $\\mathbb{P}(S=0) = 1-\\pi$. We also know $\\mathbb{P}(B=1 \\mid S=1) = Se$. The term $\\mathbb{P}(B=1 \\mid S=0)$ is the false positive rate, which is $1 - \\mathbb{P}(B=0 \\mid S=0) = 1 - Sp$.\nSubstituting these into the expression for $\\mathbb{P}(B=1)$:\n$$ \\mathbb{P}(B=1) = Se \\cdot \\pi + (1 - Sp)(1 - \\pi) $$\nTherefore, the expression for the dilution factor $D$ is:\n$$ D = PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)} $$\nThis completes the symbolic derivation.\n\nFinally, we compute the numerical value of $D$ using the provided values: $Se = 0.9$, $Sp = 0.95$, and $\\pi = 0.2$.\nFirst, calculate the terms in the formula:\n-   The proportion of true positives among all screened patients (correctly identified positives):\n    $Se \\cdot \\pi = 0.9 \\cdot 0.2 = 0.18$\n-   The proportion of false positives among all screened patients (incorrectly identified positives):\n    $(1 - Sp) \\cdot (1 - \\pi) = (1 - 0.95) \\cdot (1 - 0.2) = 0.05 \\cdot 0.8 = 0.04$\nThe total proportion of patients testing positive is the sum of these two:\n$\\mathbb{P}(B=1) = 0.18 + 0.04 = 0.22$.\nNow, we can calculate $D$:\n$$ D = \\frac{0.18}{0.22} $$\nTo express this as an exact rational number, we simplify the fraction:\n$$ D = \\frac{18}{22} = \\frac{9}{11} $$\nThe dilution factor is $\\frac{9}{11}$. This means that due to the assay's imperfections (specifically, its non-perfect PPV), the observed treatment effect in the assay-positive group is expected to be only $\\frac{9}{11}$ (approximately $81.8\\%$) of the true effect that exists in the biomarker-positive population.", "answer": "$$\\boxed{\\frac{9}{11}}$$", "id": "5028949"}, {"introduction": "Platform trials are dynamic and designed to adapt over long periods, often by adding new experimental arms to test novel therapies against a common control. This flexibility, however, introduces a unique statistical challenge: the standard of care delivered to the control arm can change over time, leading to \"temporal drift\" in patient outcomes. This exercise [@problem_id:5028986] asks you to quantify the analytical bias that can arise in a treatment effect estimate if this drift is naively ignored, illustrating the critical importance of using contemporaneous controls in platform trial analysis.", "problem": "Consider a master protocol platform trial in translational medicine with a control arm whose instantaneous event hazard, denoted by the hazard function $h_{C}(t)$, undergoes a drift due to changes in standard-of-care at time $t = 12$ months. Specifically, assume $h_{C}(t) = h_{0}$ for $0 \\leq t < 12$ months and $h_{C}(t) = h_{0}(1+\\delta)$ for $t \\geq 12$ months, with $\\delta > -1$ to ensure positivity of the hazard. An experimental arm $E$ opens at $t = 18$ months. Assume the Cox Proportional Hazards (CPH) model holds relative to the contemporaneous control after $t = 18$ months, so that for $t \\geq 18$ months the experimental hazard is $h_{E}(t) = \\theta \\, h_{C}(t)$, with a time-invariant true hazard ratio $\\theta > 0$. \n\nSuppose the analysis naively ignores drift by treating the control hazard as the pre-drift baseline $h_{0}$ when estimating the log-hazard ratio for $E$ versus control, rather than using the contemporaneous control hazard $h_{C}(t)$ prevailing at $t \\geq 18$ months. Define the log-hazard ratio parameter as $\\beta = \\ln(\\text{HR})$. Derive the bias in the log-hazard ratio, defined as $\\widehat{\\beta}_{\\text{naive}} - \\beta_{\\text{true}}$, that arises from ignoring drift under the described scenario. Express your final answer as a closed-form analytic expression in terms of $\\delta$ only. No rounding is required, and no units should be reported.", "solution": "The objective is to compute the bias in the log-hazard ratio, defined as $\\widehat{\\beta}_{\\text{naive}} - \\beta_{\\text{true}}$, which arises from using a misspecified baseline hazard for the control arm.\n\nFirst, let us establish the true log-hazard ratio, $\\beta_{\\text{true}}$. The problem states that for time $t \\geq 18$ months, the experimental arm's hazard, $h_{E}(t)$, is related to the contemporaneous control arm's hazard, $h_{C}(t)$, by the Cox Proportional Hazards (CPH) model:\n$$h_{E}(t) = \\theta \\, h_{C}(t)$$\nwhere $\\theta$ is the true, time-invariant hazard ratio ($\\text{HR}_{\\text{true}}$). The true log-hazard ratio is the natural logarithm of the true hazard ratio:\n$$\\beta_{\\text{true}} = \\ln(\\text{HR}_{\\text{true}}) = \\ln(\\theta)$$\n\nNext, we determine the expression for the naively estimated log-hazard ratio, $\\widehat{\\beta}_{\\text{naive}}$. The naive analysis is performed for the period when the experimental arm is active, i.e., for $t \\geq 18$ months. During this period, the true hazard for the experimental arm is given by $h_{E}(t) = \\theta \\, h_{C}(t)$.\n\nThe control hazard, $h_{C}(t)$, is itself subject to a drift. For $t < 12$ months, $h_{C}(t) = h_{0}$. For $t \\geq 12$ months, the hazard changes to $h_{C}(t) = h_{0}(1+\\delta)$. Since the analysis period is $t \\geq 18$ months, the relevant contemporaneous control hazard is:\n$$h_{C}(t) = h_{0}(1+\\delta) \\quad \\text{for } t \\geq 18$$\nSubstituting this into the expression for the experimental hazard, we find the true hazard for arm $E$ during the analysis period:\n$$h_{E}(t) = \\theta \\, [h_{0}(1+\\delta)] \\quad \\text{for } t \\geq 18$$\n\nThe naive analysis makes a critical error: it assumes the control hazard is the pre-drift baseline $h_{0}$ instead of the correct contemporaneous hazard $h_{0}(1+\\delta)$. The naive analysis therefore calculates an estimated hazard ratio, $\\widehat{\\text{HR}}_{\\text{naive}}$, by comparing the true experimental hazard to this incorrect baseline:\n$$\\widehat{\\text{HR}}_{\\text{naive}} = \\frac{\\text{True Hazard of Arm } E \\text{ for } t \\geq 18}{\\text{Assumed Hazard of Control Arm}} = \\frac{h_{E}(t)}{h_{0}}$$\nSubstituting the expression for $h_{E}(t)$:\n$$\\widehat{\\text{HR}}_{\\text{naive}} = \\frac{\\theta \\, h_{0}(1+\\delta)}{h_{0}} = \\theta(1+\\delta)$$\nThe naively estimated log-hazard ratio is the natural logarithm of this quantity:\n$$\\widehat{\\beta}_{\\text{naive}} = \\ln(\\widehat{\\text{HR}}_{\\text{naive}}) = \\ln(\\theta(1+\\delta))$$\n\nFinally, we can calculate the bias as the difference between the naive estimate and the true value:\n$$\\text{Bias} = \\widehat{\\beta}_{\\text{naive}} - \\beta_{\\text{true}}$$\nSubstituting the derived expressions for $\\widehat{\\beta}_{\\text{naive}}$ and $\\beta_{\\text{true}}$:\n$$\\text{Bias} = \\ln(\\theta(1+\\delta)) - \\ln(\\theta)$$\nUsing the logarithmic property $\\ln(a \\cdot b) = \\ln(a) + \\ln(b)$, we can expand the first term:\n$$\\text{Bias} = (\\ln(\\theta) + \\ln(1+\\delta)) - \\ln(\\theta)$$\nThe $\\ln(\\theta)$ terms cancel, leaving the final expression for the bias:\n$$\\text{Bias} = \\ln(1+\\delta)$$\nThis expression depends only on the drift parameter $\\delta$, as required by the problem statement. The condition $\\delta > -1$ ensures that $1+\\delta > 0$, so the logarithm is well-defined.", "answer": "$$\n\\boxed{\\ln(1+\\delta)}\n$$", "id": "5028986"}]}