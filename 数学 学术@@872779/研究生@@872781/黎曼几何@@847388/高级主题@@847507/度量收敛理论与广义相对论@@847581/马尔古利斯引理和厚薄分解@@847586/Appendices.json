{"hands_on_practices": [{"introduction": "Margulis引理通常是在曲率有标准化界限（例如 $-1 \\le K \\le 0$）的背景下陈述的。然而，在实际研究中，我们会遇到具有各种曲率范围的流形。本练习将引导你通过度量缩放的基本技巧，将一个标准化的Margulis常数应用于具有任意负曲率上界的流形，从而确定其“薄部”的有效阈值。这个计算是连接抽象理论与具体几何应用的关键一步。[@problem_id:3000746]", "problem": "设 $(M,g)$ 是一个完备、连通的 $n$ 维黎曼流形，其截面曲率 $K_{g}$ 满足 $-b^{2} \\leq K_{g} \\leq 0$，其中 $b0$ 为某个固定的常数。考虑度量的常数重标度 $\\bar{g}=\\frac{1}{b^{2}}\\,g$。回顾以下基本事实：\n\n1. 如果一个黎曼度量乘以一个正常数 $c0$，那么长度和距离将按因子 $\\sqrt{c}$ 进行缩放；即，对任意点 $p,q \\in M$，有 $d_{c g}(p,q)=\\sqrt{c}\\,d_{g}(p,q)$。\n\n2. 在常数重标度 $g \\mapsto c g$ 下，截面曲率按 $K_{c g}=\\frac{1}{c}\\,K_{g}$ 进行缩放。\n\n3. Margulis 引理（在其非正曲率形式下）保证了对于给定的度量，存在一个正常数（一个“Margulis 常数”），该常数控制了基本群的小位移部分：对任意点 $x \\in M$，由满足 $d_{\\bar{g}}(x,\\gamma x)  \\mu_{\\bar{g}}$ 的元素 $\\gamma$ 生成的子群是几乎幂零的，这就产生了厚薄分解的阈值。具体来说，设 $\\mu_{\\bar{g}}0$ 表示 $(M,\\bar{g})$ 的任意一个有效的 Margulis 常数。\n\n仅使用上述缩放事实以及 Margulis 常数作为小位移阈值的定义，推导 $(M,g)$ 的有效薄部阈值 $\\varepsilon_{g}$ 关于 $b$ 和 $\\mu_{\\bar{g}}$ 的显式闭式解析表达式。你的最终答案必须是单个表达式，且不应包含任何不等式或单位。无需进行数值四舍五入。", "solution": "题目要求我们推导黎曼流形 $(M,g)$ 的薄部阈值 $\\varepsilon_{g}$ 的表达式，该表达式用与重标度度量 $\\bar{g} = \\frac{1}{b^2} g$ 相关的参数表示。推导将仅依赖于所提供的缩放定律和 Margulis 常数的定义。\n\n设 $(M,g)$ 是一个完备、连通的 $n$ 维黎曼流形，其截面曲率 $K_{g}$ 满足 $-b^{2} \\leq K_{g} \\leq 0$，其中 $b0$ 为一个常数。\n新度量 $\\bar{g}$ 通过对原度量 $g$ 进行缩放来定义：\n$$\\bar{g} = \\frac{1}{b^{2}} g$$\n这是形式为 $\\bar{g} = c g$ 的常数重标度，其中缩放常数为 $c = \\frac{1}{b^{2}}$。\n\n题目介绍了重标度度量 $\\bar{g}$ 的 Margulis 常数 $\\mu_{\\bar{g}}  0$。这个常数定义了流形相对于度量 $\\bar{g}$ 的“薄部”的阈值。如果存在一个非平凡的 Deck 变换 $\\gamma \\in \\pi_{1}(M)$，使其在 $x$ 点的位移小于 $\\mu_{\\bar{g}}$，则点 $x \\in M$ 位于薄部。在数学上，这个条件是：\n$$d_{\\bar{g}}(x, \\gamma x)  \\mu_{\\bar{g}}$$\n此处，$d_{\\bar{g}}(p,q)$ 表示在度量 $\\bar{g}$ 中点 $p$ 和 $q$ 之间的距离。值 $\\mu_{\\bar{g}}$ 是定义流形 $(M, \\bar{g})$ 薄区域的位移阈值。\n\n我们的目标是找到原始流形 $(M,g)$ 的相应阈值 $\\varepsilon_{g}$。这意味着我们必须找到值 $\\varepsilon_{g}$，使得条件 $d_{g}(x, \\gamma x)  \\varepsilon_{g}$ 等价于条件 $d_{\\bar{g}}(x, \\gamma x)  \\mu_{\\bar{g}}$。\n\n为了关联这两个条件，我们使用给定的距离缩放定律（事实 1）：对于任何正常数 $c  0$，度量 $g$ 和 $cg$ 的距离函数由以下公式关联：\n$$d_{c g}(p,q) = \\sqrt{c} \\, d_{g}(p,q)$$\n在我们的例子中，缩放常数为 $c = \\frac{1}{b^2}$。将此规则应用于我们的度量 $\\bar{g}$ 和 $g$，我们得到：\n$$d_{\\bar{g}}(p,q) = d_{\\frac{1}{b^2} g}(p,q) = \\sqrt{\\frac{1}{b^2}} \\, d_{g}(p,q)$$\n因为给定 $b  0$，我们可以简化平方根：\n$$\\sqrt{\\frac{1}{b^2}} = \\frac{1}{|b|} = \\frac{1}{b}$$\n这给了我们两个距离函数之间的直接关系：\n$$d_{\\bar{g}}(p,q) = \\frac{1}{b} d_{g}(p,q)$$\n这个关系对任意两点都有效，包括 $x$ 和 $\\gamma x$。因此，对于 Deck 变换 $\\gamma$ 在点 $x$ 的位移，我们有：\n$$d_{\\bar{g}}(x, \\gamma x) = \\frac{1}{b} d_{g}(x, \\gamma x)$$\n现在我们可以将此表达式代入度量 $\\bar{g}$ 的薄部条件中：\n$$d_{\\bar{g}}(x, \\gamma x)  \\mu_{\\bar{g}} \\implies \\frac{1}{b} d_{g}(x, \\gamma x)  \\mu_{\\bar{g}}$$\n为了找到以位移 $d_{g}(x, \\gamma x)$ 表示的条件，我们将不等式两边同乘以 $b$。由于 $b  0$，不等式方向保持不变：\n$$d_{g}(x, \\gamma x)  b \\mu_{\\bar{g}}$$\n这个不等式 $d_{g}(x, \\gamma x)  b \\mu_{\\bar{g}}$ 定义了关于原度量 $g$ 的薄部条件。题目要求的是 $(M,g)$ 的有效薄部阈值 $\\varepsilon_{g}$。通过将我们推导出的不等式与一般形式 $d_{g}(x, \\gamma x)  \\varepsilon_{g}$ 进行比较，我们可以直接确定 $\\varepsilon_{g}$。\n因此，度量 $g$ 的阈值为：\n$$\\varepsilon_{g} = b \\mu_{\\bar{g}}$$\n这就是 $(M,g)$ 的薄部阈值关于给定数量 $b$ 和 $\\mu_{\\bar{g}}$ 的显式闭式解析表达式。", "answer": "$$\\boxed{b \\mu_{\\bar{g}}}$$", "id": "3000746"}, {"introduction": "根据Margulis引理，负曲率流形的薄部由“尖点邻域”和围绕短闭测地线的“管状邻域”构成。本练习将带你深入探索一个管状邻域的几何结构。通过在测地线周围的Fermi坐标系中推导其边界环面的诱导度量，并计算两条基本闭曲线——“经线”和“纬线”的长度，你将对薄部的局部几何形态有一个具体而深刻的认识。[@problem_id:3000729]", "problem": "设 $(M,g)$ 是一个常截面曲率为 $-1$ 的完备可定向双曲 $3$–流形。设 $\\gamma \\subset M$ 是一条长度为 $\\ell  0$ 的闭测地线，并固定一个半径 $r  0$，其值小于 $M$ 的 Margulis 常数，使得嵌入的 Margulis 管 $T_{r}(\\gamma) = \\{ p \\in M \\mid d(p,\\gamma) \\leq r \\}$ 是良定义的。用 $S_{r}(\\gamma) = \\partial T_{r}(\\gamma)$ 表示与 $\\gamma$ 的双曲距离为 $r$ 的边界环面。假设沿 $\\gamma$ 的和乐是纯双曲的（即，不存在绕 $\\gamma$ 轴的旋转分量），因此 $\\gamma$ 周围的局部模型由一个无扭转的测地轴给出。\n\n从黎曼指数映射、测地线周围的费米坐标以及常曲率 $-1$ 中的雅可比方程的定义出发，推导 $S_{r}(\\gamma)$ 上的诱导黎曼度量，并将其用绕 $\\gamma$ 法向圆的角参数 $\\theta$ 和沿 $\\gamma$ 的弧长参数 $t$ 的坐标表示。然后，仅使用所得的几何结构，计算 $S_{r}(\\gamma)$ 上以下两条简单闭曲线的精确长度：\n\n1. 经线，定义为固定 $t$ 并让 $\\theta$ 绕整个角度范围运行一周所得到的闭环。\n2. 纬线，定义为固定 $\\theta$ 并让 $t$ 沿 $\\gamma$ 运行一周所得到的闭环。\n\n将这两个长度表示为 $r$ 和 $\\ell$ 的闭式解析表达式。最终答案不需要数值近似。", "solution": "该问题要求推导双曲 $3$-流形中闭测地线周围 Margulis 管边界上的诱导度量，然后计算其经线和纬线的长度。流形 $(M,g)$ 的常截面曲率为 $K=-1$。其万有覆盖是双曲空间 $\\mathbb{H}^3$。长度为 $\\ell$ 的闭测地线 $\\gamma \\subset M$ 提升为一条测地线 $\\tilde{\\gamma} \\subset \\mathbb{H}^3$，管状邻域 $T_r(\\gamma)$ 提升为 $\\tilde{\\gamma}$ 的一个管状邻域。\n\n我们可以通过在适应于测地线 $\\tilde{\\gamma}$ 的坐标系中工作来确定度量。我们使用费米坐标，推广为柱面型坐标系 $(t, r, \\theta)$。这里，$t$ 是沿测地线 $\\tilde{\\gamma}$ 的弧长参数，$r$ 是从一点到 $\\tilde{\\gamma}$ 的测地距离，$\\theta$ 是在 $\\tilde{\\gamma}$ 上一点的法平面中的角坐标。$\\tilde{\\gamma}$ 邻域中的一点 $p \\in \\mathbb{H}^3$ 可参数化为\n$$p(t, r, \\theta) = \\exp_{\\tilde{\\gamma}(t)}(r N(t, \\theta))$$\n其中 $\\tilde{\\gamma}(t)$ 是测地线的单位速度参数化，$N(t, \\theta)$ 是在 $\\tilde{\\gamma}(t)$ 处的单位法向量。问题陈述沿 $\\gamma$ 的和乐是纯双曲的，这意味着没有旋转扭曲。这使我们能够为沿 $\\tilde{\\gamma}$ 的法丛定义一个平行正交标架 $\\{E_1(t), E_2(t)\\}$。因此，我们可以写出 $N(t, \\theta) = \\cos(\\theta)E_1(t) + \\sin(\\theta)E_2(t)$。\n\n度量张量 $g$ 由坐标曲线的切向量的内积确定：$\\frac{\\partial p}{\\partial t}$、$\\frac{\\partial p}{\\partial r}$ 和 $\\frac{\\partial p}{\\partial \\theta}$。这些向量可以使用雅可比场的理论进行分析。沿测地线 $\\alpha(s)$ 的雅可比场 $J(s)$ 衡量了一族测地线的无穷小变分。对于常截面曲率 $K=-1$ 的空间，雅可比场 $J(s)$ 满足雅可比方程：\n$$J''(s) - J(s) = 0$$\n其中微分是关于测地线的弧长参数 $s$ 进行的。\n\n我们来分析从 $\\tilde{\\gamma}(t)$ 发出的径向测地线上的切向量，其参数化为 $\\alpha(s) = \\exp_{\\tilde{\\gamma}(t)}(s N(t, \\theta))$，其中 $s \\in [0, r]$。\n\n1.  向量 $\\frac{\\partial p}{\\partial r}$ 是该径向测地线 $\\alpha(s)$ 在 $s=r$ 处的切向量。根据定义，它是一个单位向量。因此，$\\|\\frac{\\partial p}{\\partial r}\\|^2 = 1$。根据高斯引理，它与 $\\frac{\\partial p}{\\partial t}$ 和 $\\frac{\\partial p}{\\partial \\theta}$ 正交。\n\n2.  在 $p(t, r, \\theta)$ 处的向量 $\\frac{\\partial p}{\\partial \\theta}$ 是沿 $\\alpha(s)$ 的一个雅可比场 $J_\\theta(s)$。它在 $s=0$（即在 $\\tilde{\\gamma}(t)$ 处）的初始条件是：\n    $$J_\\theta(0) = \\frac{\\partial}{\\partial \\theta} \\exp_{\\tilde{\\gamma}(t)}(0 \\cdot N(t, \\theta)) = 0$$\n    $$J_\\theta'(0) = \\frac{D}{d\\theta} \\left(\\frac{d}{ds} \\exp_{\\tilde{\\gamma}(t)}(s N(t, \\theta))\\right)\\Big|_{s=0} = \\frac{\\partial N(t, \\theta)}{\\partial \\theta} = -\\sin(\\theta)E_1(t) + \\cos(\\theta)E_2(t)$$\n    $J'' - J = 0$ 的通解是 $J(s) = A \\cosh(s) + B \\sinh(s)$。条件 $J_\\theta(0)=0$ 意味着 $A=0$。条件 $J_\\theta'(0) = B \\cosh(0) = B$ 意味着 $B = \\frac{\\partial N}{\\partial \\theta}$。所以，$J_\\theta(s) = \\frac{\\partial N}{\\partial \\theta} \\sinh(s)$。在 $s=r$ 处，其范数为：\n    $$\\left\\|\\frac{\\partial p}{\\partial \\theta}\\right\\|^2 = \\|J_\\theta(r)\\|^2 = \\left\\| \\frac{\\partial N}{\\partial \\theta} \\sinh(r) \\right\\|^2 = \\sinh^2(r) \\left\\| \\frac{\\partial N}{\\partial \\theta} \\right\\|^2 = \\sinh^2(r)$$\n    因为 $\\|\\frac{\\partial N}{\\partial \\theta}\\| = \\|-\\sin(\\theta)E_1(t) + \\cos(\\theta)E_2(t)\\| = 1$。\n\n3.  在 $p(t, r, \\theta)$ 处的向量 $\\frac{\\partial p}{\\partial t}$ 是沿 $\\alpha(s)$ 的一个雅可比场 $J_t(s)$。其初始条件是：\n    $$J_t(0) = \\frac{\\partial}{\\partial t} \\exp_{\\tilde{\\gamma}(t)}(0 \\cdot N(t, \\theta)) = \\frac{d\\tilde{\\gamma}}{dt}(t) = \\tilde{\\gamma}'(t)$$\n    $$J_t'(0) = \\frac{D}{dt} \\left(\\frac{d}{ds} \\exp_{\\tilde{\\gamma}(t)}(s N(t, \\theta))\\right)\\Big|_{s=0} = \\frac{D}{dt} N(t, \\theta) = \\frac{D}{dt}(\\cos(\\theta)E_1(t) + \\sin(\\theta)E_2(t)) = 0$$\n    条件 $J_t'(0)=0$ 成立，因为标架 $\\{E_1(t), E_2(t)\\}$ 是沿 $\\tilde{\\gamma}$ 平行移动的（这是“无扭转”和乐的结果）。对于 $J_t(0)=\\tilde{\\gamma}'(t)$ 和 $J_t'(0)=0$，$J'' - J = 0$ 的解是 $J_t(s) = \\tilde{\\gamma}'(t) \\cosh(s)$。在 $s=r$ 处，其范数为：\n    $$\\left\\|\\frac{\\partial p}{\\partial t}\\right\\|^2 = \\|J_t(r)\\|^2 = \\|\\tilde{\\gamma}'(t) \\cosh(r)\\|^2 = \\cosh^2(r) \\|\\tilde{\\gamma}'(t)\\|^2 = \\cosh^2(r)$$\n    因为 $\\tilde{\\gamma}(t)$ 是一条单位速度测地线。\n\n这些切向量相互正交。根据高斯引理，$\\langle \\frac{\\partial p}{\\partial r}, \\frac{\\partial p}{\\partial \\theta} \\rangle = 0$ 且 $\\langle \\frac{\\partial p}{\\partial r}, \\frac{\\partial p}{\\partial t} \\rangle = 0$。正交性 $\\langle \\frac{\\partial p}{\\partial t}, \\frac{\\partial p}{\\partial \\theta} \\rangle = 0$ 是因为初始向量 $J_t(0)=\\tilde{\\gamma}'(t)$ 和 $J_\\theta'(0)=\\frac{\\partial N}{\\partial \\theta}$ 是正交的，并且它们各自的雅可比演化在该坐标系中保持了这种正交性。\n\n因此，在管状邻域坐标 $(t,r,\\theta)$ 中的度量是对角的：\n$$ds^2 = \\left\\|\\frac{\\partial p}{\\partial t}\\right\\|^2 dt^2 + \\left\\|\\frac{\\partial p}{\\partial r}\\right\\|^2 dr^2 + \\left\\|\\frac{\\partial p}{\\partial \\theta}\\right\\|^2 d\\theta^2 = \\cosh^2(r) dt^2 + dr^2 + \\sinh^2(r) d\\theta^2$$\nMargulis 管 $S_r(\\gamma)$ 的边界是通过保持半径 $r$ 恒定所定义的曲面。该曲面上的诱导度量是通过令 $dr=0$ 得到的：\n$$g_{S_r(\\gamma)} = \\cosh^2(r) dt^2 + \\sinh^2(r) d\\theta^2$$\n这就是环面 $S_r(\\gamma)$ 上的度量，其坐标为 $t \\in [0, \\ell]$ 和 $\\theta \\in [0, 2\\pi]$。\n\n我们现在计算指定曲线的长度。\n\n1.  **经线长度 ($L_m$)**: 经线定义为固定 $t$（例如 $t=t_0$），并让 $\\theta$ 从 $0$ 变化到 $2\\pi$。该曲线参数化为 $c_m(\\theta) = (t_0, \\theta)$，其中 $\\theta \\in [0, 2\\pi]$。在 $(t, \\theta)$ 坐标下，切向量为 $\\dot{c}_m(\\theta) = (0, 1)$。弧长微元为：\n    $$ds_m = \\sqrt{\\cosh^2(r) \\left(\\frac{dt}{d\\theta}\\right)^2 + \\sinh^2(r) \\left(\\frac{d\\theta}{d\\theta}\\right)^2} d\\theta = \\sqrt{\\cosh^2(r) \\cdot 0^2 + \\sinh^2(r) \\cdot 1^2} d\\theta = \\sinh(r) d\\theta$$\n    总长度是积分：\n    $$L_m = \\int_{0}^{2\\pi} \\sinh(r) d\\theta = \\sinh(r) [\\theta]_{0}^{2\\pi} = 2\\pi\\sinh(r)$$\n\n2.  **纬线长度 ($L_l$)**: 纬线定义为固定 $\\theta$（例如 $\\theta=\\theta_0$），并让 $t$ 从 $0$ 变化到 $\\ell$。该曲线参数化为 $c_l(t) = (t, \\theta_0)$，其中 $t \\in [0, \\ell]$。切向量为 $\\dot{c}_l(t) = (1, 0)$。弧长微元为：\n    $$ds_l = \\sqrt{\\cosh^2(r) \\left(\\frac{dt}{dt}\\right)^2 + \\sinh^2(r) \\left(\\frac{d\\theta}{dt}\\right)^2} dt = \\sqrt{\\cosh^2(r) \\cdot 1^2 + \\sinh^2(r) \\cdot 0^2} dt = \\cosh(r) dt$$\n    总长度是积分：\n    $$L_l = \\int_{0}^{\\ell} \\cosh(r) dt = \\cosh(r) [t]_{0}^{\\ell} = \\ell\\cosh(r)$$\n\n因此，经线和纬线的长度分别为 $2\\pi\\sinh(r)$ 和 $\\ell\\cosh(r)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\pi\\sinh(r) \\ell\\cosh(r)\n\\end{pmatrix}\n}\n$$", "id": "3000729"}, {"introduction": "我们已经学习了如何确定薄部的阈值，并探讨了其几何构成。现在，是时候将这些知识整合起来，对整个流形进行分解了。这个练习将理论与计算相结合，要求你设计一个算法，对一个给定的三角化双曲3-流形执行厚薄分解。你需要将关于尖点和测地线管状邻域的几何知识转化为具体的计算步骤，从而将流形中的每一个基本单元（单纯形）分类为“厚”或“薄”。[@problem_id:3000754]", "problem": "给定一个三角剖分的完备双曲 $3$-流形的简化离散模型，要求您设计并实现一个算法，以根据 Margulis 引理计算其 $\\epsilon$-厚薄分解。该分解将流形分割为一个薄部和一个厚部，薄部中的单射半径很小，而厚部中的单射半径有下界。此任务的基本依据包括：(i) 黎曼流形上某点的单射半径的定义，即以该点为基点的最短非平凡测地环路长度的一半；以及 (ii) Margulis 引理所预测的薄部组件的定性结构，即对于足够小的 $\\epsilon$，$\\epsilon$-薄部由尖点的邻域和围绕短闭合测地线的管道组成。尖点区域的模型几何是欧几里得 $2$-环面与一条射线的乘积，而围绕闭合测地线的管状邻域的模型几何则是由具有双曲度量的实心环面组成，它们分别通过极限球面截面和子午环路的几何形状，为单射半径估计值提供下界。\n\n输入模型与算法任务：\n1. 一个三角剖分由一个包含顶点索引的有限四面体列表和一个顶点属性列表指定。每个顶点具有：\n   - 尖点属性或无。尖点属性由沿尖点射线测量的非负高度 $h \\in \\mathbb{R}_{\\ge 0}$ 建模。高度 $h$ 处的尖点截面是一个欧几里得 $2$-环面，它是通过基准环面沿射线方向进行指数缩放得到的。\n   - 到每条短闭合测地线轴的距离列表。对于第 $j$ 条测地线，距离为 $d_j \\in \\mathbb{R}_{\\ge 0}$。\n2. 在参考高度 $0$ 处，尖点截面的基准最短斜率长度，记为 $L_0 \\in \\mathbb{R}_{0}$。\n3. 短闭合测地线的长度列表，记为 $\\ell_j \\in \\mathbb{R}_{0}$，其中 $j=1,\\dots,k$。\n4. 一个正参数 $\\epsilon \\in \\mathbb{R}_{0}$。\n\n您的算法必须对每个顶点，使用以下信息推导其单射半径的下界估计值：\n- 高度为 $h$ 处的尖点模型以及基准斜率长度 $L_0$；极限球面截面是一个平坦环面，其最短本原斜率长度随高度缩放，相应尖点处的单射半径是该最短斜率长度的一半。\n- 围绕长度为 $\\ell_j$ 的测地线的管状模型；距轴距离为 $d_j$ 的邻域有一个子午环路，以及一个通过沿轴投影到闭合测地线上获得的环路；此类点处的单射半径是这些相关环路中最短者长度的一半。\n\n通过适当组合这些基于模型的下界，定义每个顶点的单射半径估计值。如果一个顶点的单射半径严格小于 $\\epsilon/2$，则将其分类为 $\\epsilon$-薄，否则分类为 $\\epsilon$-厚。如果一个四面体的至少一个顶点是 $\\epsilon$-薄的，则该四面体被分类为 $\\epsilon$-薄，否则为 $\\epsilon$-厚。\n\n您的程序必须在以下测试套件上实现此分类，并使用明确的数值参数。在每种情况下，报告被判定为 $\\epsilon$-薄的四面体索引列表，按升序排序。\n\n测试套件：\n- 情况 1：\n  - $\\epsilon = 0.2$，$L_0 = 1.0$，一条测地线，长度 $\\ell_1 = 0.3$。\n  - 顶点（索引从 $0$ 到 $6$）：\n    - $v_0$：尖点高度 $h = 2.0$，距离 $[d_1] = [0.3]$。\n    - $v_1$：尖点高度 $h = 0.5$，距离 $[d_1] = [0.01]$。\n    - $v_2$：无尖点，距离 $[d_1] = [0.4]$。\n    - $v_3$：无尖点，距离 $[d_1] = [0.0]$。\n    - $v_4$：尖点高度 $h = 1.0$，距离 $[d_1] = [1.0]$。\n    - $v_5$：无尖点，距离 $[d_1] = [2.0]$。\n    - $v_6$：无尖点，距离 $[d_1] = [3.0]$。\n  - 四面体：\n    - $t_0 = [0,1,2,3]$，$t_1 = [1,2,4,3]$，$t_2 = [2,4,1,0]$，$t_3 = [2,4,5,6]$。\n\n- 情况 2：与情况 1 相同的三角剖分和顶点数据，但 $\\epsilon = 0.3$ 且 $L_0 = 1.0$。\n\n- 情况 3：\n  - $\\epsilon = 0.08$，$L_0 = 1.2$，两条测地线，长度 $\\ell_1 = 0.2$，$\\ell_2 = 0.5$。\n  - 顶点（索引从 $0$ 到 $7$）：\n    - $v_0$：尖点高度 $h = 3.0$，距离 $[d_1,d_2] = [0.2,2.0]$。\n    - $v_1$：无尖点，距离 $[d_1,d_2] = [0.01,0.5]$。\n    - $v_2$：无尖点，距离 $[d_1,d_2] = [0.3,0.3]$。\n    - $v_3$：无尖点，距离 $[d_1,d_2] = [0.0,0.0]$。\n    - $v_4$：尖点高度 $h = 0.2$，距离 $[d_1,d_2] = [1.0,0.7]$。\n    - $v_5$：无尖点，距离 $[d_1,d_2] = [1.5,1.5]$。\n    - $v_6$：尖点高度 $h = 4.0$，距离 $[d_1,d_2] = [0.5,0.5]$。\n    - $v_7$：无尖点，距离 $[d_1,d_2] = [3.0,3.0]$。\n  - 四面体：\n    - $t_0 = [0,1,2,3]$，$t_1 = [1,2,4,5]$，$t_2 = [2,4,5,3]$，$t_3 = [2,4,5,6]$，$t_4 = [2,4,5,7]$。\n\n- 情况 4：\n  - $\\epsilon = 0.1$，$L_0 = 1.0$，无测地线。\n  - 顶点（索引从 $0$ 到 $3$）：$v_0,v_1,v_2,v_3$ 均无尖点且距离列表为空。\n  - 四面体：\n    - $t_0 = [0,1,2,3]$，$t_1 = [0,2,3,1]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个条目是相应测试用例的薄四面体索引列表。例如，一个有效的输出形如 $[[0,1],[2],[]]$，内部列表中没有空格。角度（若有）必须以弧度处理；无需报告物理单位。", "solution": "用户提供了一个问题陈述，要求为一个双曲 $3$-流形的简化模型实现厚薄分解算法。提供解决方案的一个关键前提是验证该问题陈述。\n\n### 步骤1：提取已知条件\n\n问题提供了以下数据、定义和条件：\n- **输入数据**：\n    - 一个三角剖分，由一个有限的四面体列表（通过顶点索引定义）和一个带属性的顶点列表指定。\n    - 顶点属性：每个顶点或者有尖点属性（高度 $h \\in \\mathbb{R}_{\\ge 0}$），或者没有。此外，还有一个到 $k$ 个短闭合测地线轴的距离列表 $d_j \\in \\mathbb{R}_{\\ge 0}$。\n    - 在参考高度 $h=0$ 处，尖点截面的基准最短斜率长度，记为 $L_0 \\in \\mathbb{R}_{0}$。\n    - $k$ 条短闭合测地线的长度列表，$\\ell_j \\in \\mathbb{R}_{0}$。\n    - 一个正参数 $\\epsilon \\in \\mathbb{R}_{0}$。\n- **算法任务**：\n    - 对每个顶点，估计其单射半径。\n    - 单射半径估计值需从两个模型推导得出：\n        1.  **尖点模型**：尖点处的单射半径是相应极限球面截面最短斜率长度的一半。该长度从基准长度 $L_0$ 开始随高度 $h$ 指数缩放。\n        2.  **管状模型**：在长度为 $\\ell_j$ 的测地线附近一点的单射半径是两个相关环路中最短者长度的一半：(i) “沿轴投影到闭合测地线上获得的环路” 和 (ii) “子午环路”。\n- **分类规则**：\n    - 如果一个顶点的单射半径估计值严格小于 $\\epsilon/2$，则将其分类为 $\\epsilon$-薄。否则，为 $\\epsilon$-厚。\n    - 如果一个四面体至少有一个顶点是 $\\epsilon$-薄的，则该四面体被分类为 $\\epsilon$-薄。否则，为 $\\epsilon$-厚。\n- **输出**：对于每个测试用例，输出一个排序后的 $\\epsilon$-薄四面体索引列表。\n- **测试套件**：提供了四个具体的测试用例及所有必要的数值参数。\n\n### 步骤2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题在双曲几何理论和 Margulis 引理方面有坚实的科学基础。厚薄分解是一个基本概念。尖点区域和测地线管状邻域中的单射半径模型是该领域使用的标准（尽管是简化的）近似方法。\n- **良构性**：问题是良构的。给定一组输入和一套明确的规则，输出是唯一确定的。\n- **客观性**：问题以客观术语陈述，使用数学定义和数值数据。\n\n然而，有一个模糊点必须得到解决，属于**病态或结构不良**（第5项）。管状模型中环路的描述在数学上不够精确：\n1.  短语“沿轴投影到闭合测地线上获得的环路”在句法上有问题且有多种解释。\n2.  问题提到了“子午环路”，但没有提供其长度作为与测地线轴距离的函数的公式。\n\n作为该领域的教授，我有责任通过采用科学上的标准解释来解决这种模糊性，问题陈述很可能假定这是背景知识。\n1.  在长度为 $\\ell_j$ 的闭合测地线的管状邻域中，距离轴 $d_j$ 的一个点有一个以其为基点的非平凡测地环路，该环路与轴自由同伦。在双曲 $3$-空间中，此环路的长度由 $\\ell_j \\cosh(d_j)$ 给出。这是对第一种环路类型最严谨的解释。\n2.  距离轴 $d_j$ 的子午环路（一个环绕测地线轴的圆）的长度由 $2\\pi \\sinh(d_j)$ 给出。\n\n有了这些标准公式，问题就变得完全明确了。“推导下界估计值”的指令被解释为使用这些特定模型来计算单射半径的估计值，根据定义，单射半径是最短非平凡环路长度的一半。因此，我们的估计是真实单射半径的一个上界，因为我们只考虑了所有可能环路的一个子集。然后将分类规则应用于此估计值。\n\n### 步骤3：结论与行动\n\n该问题被视为**有效**，但这取决于使用双曲几何的标准公式对模糊部分进行规范化。我现在将基于此解释继续提供解决方案。\n\n### 算法解决方案\n\n该算法通过首先将每个顶点分类为薄或厚来确定薄四面体的集合。\n\n**1. 单射半径估计**\n\n对于每个顶点 $v_i$，我们通过找到所有适用模型（所有测地线的尖点和管状邻域）的半径估计值的最小值，来计算其单射半径的估计值 $r_{est}(v_i)$。\n\n- **尖点贡献**：如果顶点 $v_i$ 具有高度为 $h_i$ 的尖点属性，则极限球面上的最短环路长度为 $L(h_i) = L_0 e^{-h_i}$。相应的单射半径贡献为：\n$$r_{cusp,i} = \\frac{1}{2} L_0 e^{-h_i}$$\n如果顶点没有尖点属性，则此贡献视为无穷大。\n\n- **测地线贡献**：对于每条测地线 $j$（长度为 $\\ell_j$），顶点 $v_i$ 距离其轴为 $d_{ij}$。两个候选环路长度为 $L_{axis} = \\ell_j \\cosh(d_{ij})$ 和 $L_{meridian} = 2\\pi \\sinh(d_{ij})$。来自该测地线的单射半径贡献为：\n$$r_{geo,ij} = \\frac{1}{2} \\min(\\ell_j \\cosh(d_{ij}), 2\\pi \\sinh(d_{ij}))$$\n如果距离 $d_{ij}$ 为 $0$，则该点位于测地线轴上。子午线长度变为 $2\\pi \\sinh(0) = 0$，这正确地意味着单射半径为 $0$。\n\n- **综合估计**：顶点 $v_i$ 的总单射半径估计值是所有贡献的最小值：\n$$r_{est}(v_i) = \\min \\left( r_{cusp,i}, \\min_{j} \\{ r_{geo,ij} \\} \\right)$$\n如果一个顶点没有尖点属性，也没有指定的到测地线的距离，其 $r_{est}$ 实际上是无穷大，从而将其置于厚部。\n\n**2. 分类**\n\n- **顶点分类**：如果顶点 $v_i$ 的估计单射半径满足条件：\n$$r_{est}(v_i)  \\frac{\\epsilon}{2}$$\n则将其分类为 $\\epsilon$-薄。\n- **四面体分类**：如果四面体 $t_k$ 的至少一个顶点是 $\\epsilon$-薄的，则该四面体被分类为 $\\epsilon$-薄。\n\n**3. 测试用例的实现**\n\n将所描述的算法应用于每个测试用例。\n\n**情况 1：** $\\epsilon=0.2$，$L_0=1.0$，$\\ell_1=0.3$。阈值 $\\epsilon/2 = 0.1$。\n- $v_0$：$h=2.0, d_1=0.3$。$r_{est}(v_0) = \\min(\\frac{1}{2}e^{-2}, \\frac{1}{2}\\min(0.3\\cosh0.3, 2\\pi\\sinh0.3)) \\approx 0.0677  0.1$。薄。\n- $v_1$：$h=0.5, d_1=0.01$。$r_{est}(v_1) = \\min(\\frac{1}{2}e^{-0.5}, \\frac{1}{2}\\min(0.3\\cosh0.01, 2\\pi\\sinh0.01)) \\approx 0.0314  0.1$。薄。\n- $v_2$：无尖点，$d_1=0.4$。$r_{est}(v_2) = \\frac{1}{2}\\min(0.3\\cosh0.4, 2\\pi\\sinh0.4) \\approx 0.1622  0.1$。厚。\n- $v_3$：无尖点，$d_1=0.0$。$r_{est}(v_3) = \\frac{1}{2}\\min(0.3\\cosh0, 2\\pi\\sinh0) = 0  0.1$。薄。\n- $v_4, v_5, v_6$ 被确定为厚。\n- 薄顶点：$\\{0, 1, 3\\}$。\n- 薄四面体：$t_0=[0,1,2,3]$、$t_1=[1,2,4,3]$、$t_2=[2,4,1,0]$ 至少包含一个薄顶点。$t_3=[2,4,5,6]$ 不包含。结果：`[0,1,2]`。\n\n**情况 2：** $\\epsilon=0.3$，$L_0=1.0$，$\\ell_1=0.3$。阈值 $\\epsilon/2 = 0.15$。\n- 使用情况 1 中的相同 $r_{est}$ 值：\n- $v_0 (0.0677)$、$v_1 (0.0314)$、$v_3 (0)$ 小于 $0.15$。薄。\n- $v_2 (0.1622)$、$v_4, v_5, v_6$ 大于 $0.15$。厚。\n- 薄顶点：$\\{0, 1, 3\\}$。\n- 薄四面体：$t_0, t_1, t_2$。结果：`[0,1,2]`。\n\n**情况 3：** $\\epsilon=0.08$，$L_0=1.2$，$\\ell_1=0.2, \\ell_2=0.5$。阈值 $\\epsilon/2 = 0.04$。\n- $v_0$：$h=3.0$, $d=[0.2, 2.0]$。$r_{est}(v_0) \\approx 0.0299  0.04$。薄。\n- $v_1$：无尖点，$d=[0.01, 0.5]$。$r_{est}(v_1) \\approx 0.0314  0.04$。薄。\n- $v_2$：无尖点，$d=[0.3, 0.3]$。$r_{est}(v_2) \\approx 0.1045  0.04$。厚。\n- $v_3$：无尖点，$d=[0.0, 0.0]$。$r_{est}(v_3) = 0  0.04$。薄。\n- $v_4$：$h=0.2, d=[1.0, 0.7]$。$r_{est}(v_4) \\approx 0.1543  0.04$。厚。\n- $v_5$：无尖点，$d=[1.5, 1.5]$。$r_{est}(v_5) \\approx 0.2352  0.04$。厚。\n- $v_6$：$h=4.0, d=[0.5, 0.5]$。$r_{est}(v_6) \\approx 0.0110  0.04$。薄。\n- $v_7$：无尖点，$d=[3.0, 3.0]$。$r_{est}(v_7) \\approx 1.0068  0.04$。厚。\n- 薄顶点：$\\{0, 1, 3, 6\\}$。\n- 薄四面体：$t_0=[0,1,2,3]$、$t_1=[1,2,4,5]$、$t_2=[2,4,5,3]$、$t_3=[2,4,5,6]$。结果：`[0,1,2,3]`。\n\n**情况 4：** $\\epsilon=0.1$，$L_0=1.0$，无测地线。阈值 $\\epsilon/2=0.05$。\n- 所有顶点都没有尖点属性，也没有测地线。它们的单射半径估计值为无穷大。\n- 所有顶点都是厚的。\n- 没有薄的四面体。结果：`[]`。\n\n以下程序实现了此逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"epsilon\": 0.2,\n            \"L0\": 1.0,\n            \"geodesic_lengths\": [0.3],\n            \"vertices\": [\n                {\"h\": 2.0, \"d\": [0.3]},\n                {\"h\": 0.5, \"d\": [0.01]},\n                {\"h\": None, \"d\": [0.4]},\n                {\"h\": None, \"d\": [0.0]},\n                {\"h\": 1.0, \"d\": [1.0]},\n                {\"h\": None, \"d\": [2.0]},\n                {\"h\": None, \"d\": [3.0]},\n            ],\n            \"tetrahedra\": [\n                [0, 1, 2, 3],\n                [1, 2, 4, 3],\n                [2, 4, 1, 0],\n                [2, 4, 5, 6],\n            ]\n        },\n        # Case 2\n        {\n            \"epsilon\": 0.3,\n            \"L0\": 1.0,\n            \"geodesic_lengths\": [0.3],\n            \"vertices\": [\n                {\"h\": 2.0, \"d\": [0.3]},\n                {\"h\": 0.5, \"d\": [0.01]},\n                {\"h\": None, \"d\": [0.4]},\n                {\"h\": None, \"d\": [0.0]},\n                {\"h\": 1.0, \"d\": [1.0]},\n                {\"h\": None, \"d\": [2.0]},\n                {\"h\": None, \"d\": [3.0]},\n            ],\n            \"tetrahedra\": [\n                [0, 1, 2, 3],\n                [1, 2, 4, 3],\n                [2, 4, 1, 0],\n                [2, 4, 5, 6],\n            ]\n        },\n        # Case 3\n        {\n            \"epsilon\": 0.08,\n            \"L0\": 1.2,\n            \"geodesic_lengths\": [0.2, 0.5],\n            \"vertices\": [\n                {\"h\": 3.0, \"d\": [0.2, 2.0]},\n                {\"h\": None, \"d\": [0.01, 0.5]},\n                {\"h\": None, \"d\": [0.3, 0.3]},\n                {\"h\": None, \"d\": [0.0, 0.0]},\n                {\"h\": 0.2, \"d\": [1.0, 0.7]},\n                {\"h\": None, \"d\": [1.5, 1.5]},\n                {\"h\": 4.0, \"d\": [0.5, 0.5]},\n                {\"h\": None, \"d\": [3.0, 3.0]},\n            ],\n            \"tetrahedra\": [\n                 [0, 1, 2, 3],\n                 [1, 2, 4, 5],\n                 [2, 4, 5, 3],\n                 [2, 4, 5, 6],\n                 [2, 4, 5, 7],\n            ]\n        },\n        # Case 4\n        {\n            \"epsilon\": 0.1,\n            \"L0\": 1.0,\n            \"geodesic_lengths\": [],\n            \"vertices\": [\n                {\"h\": None, \"d\": []},\n                {\"h\": None, \"d\": []},\n                {\"h\": None, \"d\": []},\n                {\"h\": None, \"d\": []},\n            ],\n            \"tetrahedra\": [\n                [0, 1, 2, 3],\n                [0, 2, 3, 1],\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = classify_tetrahedra(\n            case[\"epsilon\"],\n            case[\"L0\"],\n            case[\"geodesic_lengths\"],\n            case[\"vertices\"],\n            case[\"tetrahedra\"]\n        )\n        results.append(result)\n\n    # Format the final output string exactly as required.\n    formatted_results = [str(res).replace(' ', '') for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef classify_tetrahedra(epsilon, L0, geodesic_lengths, vertices, tetrahedra):\n    \"\"\"\n    Computes the thick-thin decomposition for a single test case.\n    \"\"\"\n    thin_vertices = set()\n    epsilon_threshold = epsilon / 2.0\n\n    for i, v_attr in enumerate(vertices):\n        h = v_attr.get(\"h\")\n        distances = v_attr.get(\"d\", [])\n\n        r_est = float('inf')\n\n        # Cusp contribution\n        if h is not None:\n            r_cusp = 0.5 * L0 * np.exp(-h)\n            r_est = min(r_est, r_cusp)\n\n        # Geodesic contributions\n        for j, dist in enumerate(distances):\n            l_j = geodesic_lengths[j]\n            \n            # Length of loop homotopic to the geodesic axis\n            l_axis = l_j * np.cosh(dist)\n            # Length of meridional loop\n            l_meridian = 2 * np.pi * np.sinh(dist)\n            \n            r_geo = 0.5 * min(l_axis, l_meridian)\n            r_est = min(r_est, r_geo)\n        \n        if r_est  epsilon_threshold:\n            thin_vertices.add(i)\n\n    thin_tet_indices = []\n    for i, tet_verts in enumerate(tetrahedra):\n        is_thin = False\n        for v_idx in tet_verts:\n            if v_idx in thin_vertices:\n                is_thin = True\n                break\n        if is_thin:\n            thin_tet_indices.append(i)\n    \n    # The problem requires the list of indices to be sorted.\n    thin_tet_indices.sort()\n    return thin_tet_indices\n\nsolve()\n```", "id": "3000754"}]}