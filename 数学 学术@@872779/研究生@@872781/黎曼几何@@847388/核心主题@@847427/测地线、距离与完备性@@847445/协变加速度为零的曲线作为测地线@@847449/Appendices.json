{"hands_on_practices": [{"introduction": "将抽象的测地线条件 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma} = 0$ 转化为具体坐标系下的微分方程组，是黎曼几何中的一项基本功。本练习 [@problem_id:2977052] 将引导你从一个给定的度规张量出发，一步步计算克氏符，并最终推导出测地线方程。这个过程将加深你对协变加速度、联络和度规之间内在联系的理解。", "problem": "考虑光滑曲面 $\\mathbb{R}^{2}$，其上配备了全局坐标 $(u,v)$ 和黎曼度量\n$$\ng \\;=\\; \\exp\\!\\big(2\\,u^{2}v\\big)\\,\\big(du\\otimes du \\;+\\; dv\\otimes dv\\big).\n$$\n从第一性原理出发，以列维-奇维塔联络的定义性质（无挠和度量兼容）及其所蕴含的坐标表达式为起点，完成以下步骤：\n1. 确定度量分量 $g_{ij}$，相对于坐标标架 $\\{\\partial_{u},\\partial_{v}\\}$。\n2. 计算逆度量分量 $g^{ij}$。\n3. 计算与 $g$ 相关的列维-奇维塔联络的所有克里斯托费尔符号 $\\Gamma^{k}_{\\;ij}$。\n4. 对于光滑曲线 $\\gamma(t)=(u(t),v(t))$，将自平行条件 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}=0$ 用坐标写成关于 $u(t)$ 和 $v(t)$ 的两个耦合的二阶常微分方程。\n\n答案要求：以一个二分量行向量的形式给出最终答案，其分量为这两个自平行方程的左侧，用 $u$、$v$、$\\dot{u}$、$\\dot{v}$、$\\ddot{u}$ 和 $\\ddot{v}$ 的符号形式表示，不进行数值计算。", "solution": "该问题要求推导给定在 $\\mathbb{R}^{2}$ 上的黎曼度量的测地线方程。我们将遵循指定的步骤顺序，从第一性原理出发。令坐标表示为 $x^{1} = u$ 和 $x^{2} = v$。坐标基向量为 $\\partial_{1} = \\partial_{u}$ 和 $\\partial_{2} = \\partial_{v}$。\n\n第1步：确定度量分量 $g_{ij}$。\n给定的黎曼度量为\n$$ g = \\exp(2u^{2}v)(du \\otimes du + dv \\otimes dv) $$\n在坐标基 $\\{\\partial_{u}, \\partial_{v}\\}$ 中，度量张量的分量 $g_{ij}$ 定义为 $g_{ij} = g(\\partial_{i}, \\partial_{j})$。我们可以从给定的 $g$ 的表达式中直接读出这些分量，该表达式是在对偶基 $\\{du, dv\\}$ 中写出的。\n分量 $g_{11}$（也写作 $g_{uu}$）是 $du \\otimes du$ 的系数：\n$$ g_{11} = g_{uu} = \\exp(2u^{2}v) $$\n分量 $g_{22}$（也写作 $g_{vv}$）是 $dv \\otimes dv$ 的系数：\n$$ g_{22} = g_{vv} = \\exp(2u^{2}v) $$\n非对角分量 $g_{12}$ 和 $g_{21}$ 分别是 $du \\otimes dv$ 和 $dv \\otimes du$ 的系数。由于这些项不存在，它们的系数为 $0$：\n$$ g_{12} = g_{uv} = 0 $$\n$$ g_{21} = g_{vu} = 0 $$\n度量是对角的，这简化了计算。我们可以将度量分量矩阵写为：\n$$ [g_{ij}] = \\begin{pmatrix} \\exp(2u^{2}v)  0 \\\\ 0  \\exp(2u^{2}v) \\end{pmatrix} $$\n\n第2步：计算逆度量分量 $g^{ij}$。\n逆度量分量 $g^{ij}$ 是矩阵 $[g^{ij}]$ 的元素，该矩阵是矩阵 $[g_{ij}]$ 的逆矩阵。对于对角矩阵，其逆矩阵通过取每个对角元素的倒数得到。\n$$ [g^{ij}] = [g_{ij}]^{-1} = \\begin{pmatrix} \\exp(2u^{2}v)  0 \\\\ 0  \\exp(2u^{2}v) \\end{pmatrix}^{-1} = \\begin{pmatrix} \\exp(-2u^{2}v)  0 \\\\ 0  \\exp(-2u^{2}v) \\end{pmatrix} $$\n因此，各个分量为：\n$$ g^{11} = \\exp(-2u^{2}v) $$\n$$ g^{22} = \\exp(-2u^{2}v) $$\n$$ g^{12} = g^{21} = 0 $$\n\n第3步：计算所有克里斯托费尔符号 $\\Gamma^{k}_{\\;ij}$。\n第二类克里斯托费尔符号 $\\Gamma^{k}_{\\;ij}$（对于列维-奇维塔联络）由度量分量确定。列维-奇维塔联络的定义性质（无挠和度量兼容）导出了以下用度量及其导数表示的克里斯托费尔符号的显式公式：\n$$ \\Gamma^{k}_{\\;ij} = \\frac{1}{2} g^{kl} (\\partial_{i} g_{jl} + \\partial_{j} g_{il} - \\partial_{l} g_{ij}) $$\n其中 $\\partial_{i}$ 表示关于坐标 $x^{i}$ 的偏导数。这里，$i, j, k, l$ 的取值范围是 $\\{1, 2\\}$，其中 $x^{1}=u$ 和 $x^{2}=v$。为了简化记法，令 $F(u,v) = \\exp(2u^{2}v)$。那么 $g_{11} = g_{22} = F$ 且 $g^{11} = g^{22} = F^{-1}$。\n所需的度量分量的偏导数为：\n$$ \\partial_{1}g_{11} = \\partial_{u}F = (4uv)\\exp(2u^{2}v) = 4uvF $$\n$$ \\partial_{2}g_{11} = \\partial_{v}F = (2u^{2})\\exp(2u^{2}v) = 2u^{2}F $$\n$$ \\partial_{1}g_{22} = \\partial_{u}F = 4uvF $$\n$$ \\partial_{2}g_{22} = \\partial_{v}F = 2u^{2}F $$\n所有其他导数，例如 $\\partial_{i}g_{12}$，均为 $0$。\n由于 $g^{kl}$ 是对角的，在 $\\Gamma^{k}_{\\;ij}$ 的公式中，对 $l$ 的求和仅在 $l=k$ 时有一项非零。因此，公式简化为：\n$$ \\Gamma^{k}_{\\;ij} = \\frac{1}{2} g^{kk} (\\partial_{i} g_{jk} + \\partial_{j} g_{ik} - \\partial_{k} g_{ij}) $$\n我们现在计算每个符号。由于联络的对称性，$\\Gamma^{k}_{\\;ij} = \\Gamma^{k}_{\\;ji}$。\n$$ \\Gamma^{1}_{\\;11} = \\frac{1}{2}g^{11}(\\partial_{1}g_{11}+\\partial_{1}g_{11}-\\partial_{1}g_{11}) = \\frac{1}{2}g^{11}\\partial_{1}g_{11} = \\frac{1}{2}F^{-1}(4uvF) = 2uv $$\n$$ \\Gamma^{1}_{\\;12} = \\frac{1}{2}g^{11}(\\partial_{1}g_{21}+\\partial_{2}g_{11}-\\partial_{1}g_{12}) = \\frac{1}{2}g^{11}(0+\\partial_{2}g_{11}-0) = \\frac{1}{2}F^{-1}(2u^{2}F) = u^{2} $$\n$$ \\Gamma^{1}_{\\;22} = \\frac{1}{2}g^{11}(\\partial_{2}g_{21}+\\partial_{2}g_{11}-\\partial_{1}g_{22}) = \\frac{1}{2}g^{11}(0+0-\\partial_{1}g_{22}) = -\\frac{1}{2}F^{-1}(4uvF) = -2uv $$\n$$ \\Gamma^{2}_{\\;11} = \\frac{1}{2}g^{22}(\\partial_{1}g_{12}+\\partial_{1}g_{21}-\\partial_{2}g_{11}) = \\frac{1}{2}g^{22}(0+0-\\partial_{2}g_{11}) = -\\frac{1}{2}F^{-1}(2u^{2}F) = -u^{2} $$\n$$ \\Gamma^{2}_{\\;12} = \\frac{1}{2}g^{22}(\\partial_{1}g_{22}+\\partial_{2}g_{12}-\\partial_{2}g_{12}) = \\frac{1}{2}g^{22}(\\partial_{1}g_{22}) = \\frac{1}{2}F^{-1}(4uvF) = 2uv $$\n$$ \\Gamma^{2}_{\\;22} = \\frac{1}{2}g^{22}(\\partial_{2}g_{22}+\\partial_{2}g_{22}-\\partial_{2}g_{22}) = \\frac{1}{2}g^{22}\\partial_{2}g_{22} = \\frac{1}{2}F^{-1}(2u^{2}F) = u^{2} $$\n\n第4步：推导自平行方程。\n一条自平行曲线（测地线）$\\gamma(t)$ 是指其切向量 $\\dot{\\gamma}(t)$ 沿着自身平行移动。这个条件写作 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma} = 0$，其中 $\\nabla$ 是列维-奇维塔联络。对于曲线 $\\gamma(t) = (x^{1}(t), x^{2}(t)) = (u(t),v(t))$，此条件的坐标表达式是测地线方程：\n$$ \\frac{d^{2}x^{k}}{dt^{2}} + \\sum_{i,j=1}^{2} \\Gamma^{k}_{\\;ij} \\frac{dx^{i}}{dt} \\frac{dx^{j}}{dt} = 0 $$\n这给出了一个关于 $k=1,2$ 的两个耦合的二阶常微分方程组。我们使用简写 $\\dot{u} = \\frac{du}{dt}$，$\\ddot{u} = \\frac{d^{2}u}{dt^{2}}$，等等。\n对于 $k=1$（$u$-分量方程）：\n$$ \\ddot{u} + \\Gamma^{1}_{\\;11}\\dot{u}^{2} + 2\\Gamma^{1}_{\\;12}\\dot{u}\\dot{v} + \\Gamma^{1}_{\\;22}\\dot{v}^{2} = 0 $$\n代入计算出的克里斯托费尔符号：\n$$ \\ddot{u} + (2uv)\\dot{u}^{2} + 2(u^{2})\\dot{u}\\dot{v} + (-2uv)\\dot{v}^{2} = 0 $$\n$$ \\ddot{u} + 2uv\\dot{u}^{2} + 2u^{2}\\dot{u}\\dot{v} - 2uv\\dot{v}^{2} = 0 $$\n对于 $k=2$（$v$-分量方程）：\n$$ \\ddot{v} + \\Gamma^{2}_{\\;11}\\dot{u}^{2} + 2\\Gamma^{2}_{\\;12}\\dot{u}\\dot{v} + \\Gamma^{2}_{\\;22}\\dot{v}^{2} = 0 $$\n代入计算出的克里斯托费尔符号：\n$$ \\ddot{v} + (-u^{2})\\dot{u}^{2} + 2(2uv)\\dot{u}\\dot{v} + (u^{2})\\dot{v}^{2} = 0 $$\n$$ \\ddot{v} - u^{2}\\dot{u}^{2} + 4uv\\dot{u}\\dot{v} + u^{2}\\dot{v}^{2} = 0 $$\n问题要求的是这两个方程的左侧。\n第一个分量是 $\\ddot{u} + 2uv\\dot{u}^{2} + 2u^{2}\\dot{u}\\dot{v} - 2uv\\dot{v}^{2}$。\n第二个分量是 $\\ddot{v} - u^{2}\\dot{u}^{2} + 4uv\\dot{u}\\dot{v} + u^{2}\\dot{v}^{2}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\ddot{u} + 2uv\\dot{u}^{2} + 2u^{2}\\dot{u}\\dot{v} - 2uv\\dot{v}^{2}  \\ddot{v} - u^{2}\\dot{u}^{2} + 4uv\\dot{u}\\dot{v} + u^{2}\\dot{v}^{2} \\end{pmatrix}}\n$$", "id": "2977052"}, {"introduction": "协变加速度与坐标加速度的一个关键区别在于，一个在特定坐标系下看起来是“直”的路径（即其坐标二阶导数为零）不一定是测地线。这个问题 [@problem_id:2976986] 使用著名的庞加莱上半平面模型，提供了一个绝佳的例子来说明这一反直觉但至关重要的概念。通过计算你会发现，即使路径的坐标加速度为零，其几何（协变）加速度也可能非零，这揭示了空间本身的曲率。", "problem": "考虑上半平面流形 $\\mathcal{H}=\\{(x,y)\\in\\mathbb{R}^{2}\\,|\\,y0\\}$，其上赋予了在标准坐标 $(x,y)$ 下由 $g=\\frac{1}{y^{2}}\\left(dx^{2}+dy^{2}\\right)$ 定义的黎曼度量 $g$。设 $\\gamma:\\mathbb{R}\\to\\mathcal{H}$ 是由 $\\gamma(t)=(t,y_{0})$ 给出的曲线，其中 $y_{0}0$ 是一个固定的常数，因此在该坐标下速度 $\\dot{\\gamma}(t)$ 是恒定的。\n\n从黎曼度量、Levi-Civita 联络以及沿曲线的协变导数的定义出发，确定 $\\gamma$ 的协变加速度 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}$，并用 $(x,y)$ 坐标基表示，并将其表示为关于 $y_{0}$ 的单个解析表达式。你的最终答案必须是 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}$ 的坐标行向量，并明确地用 $y_{0}$ 表示。无需四舍五入。最终答案无需单位。", "solution": "该问题要求确定上半平面流形 $\\mathcal{H}$ 上给定曲线 $\\gamma(t)=(t, y_0)$ 的协变加速度 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}$。\n\n设坐标为 $(x^1, x^2) = (x, y)$。给定的黎曼度量为 $g=\\frac{1}{y^{2}}\\left(dx^{2}+dy^{2}\\right)$。度量张量的分量可以从线元 $ds^2 = g_{ij} dx^i dx^j$ 中读出：\n$$ g_{ij} = \\begin{pmatrix} \\frac{1}{y^2}  0 \\\\ 0  \\frac{1}{y^2} \\end{pmatrix} $$\n其逆矩阵为：\n$$ g^{ij} = \\begin{pmatrix} y^2  0 \\\\ 0  y^2 \\end{pmatrix} $$\n曲线 $\\gamma(t)$ 的协变加速度的第 $k$ 个分量由下式给出：\n$$ (\\nabla_{\\dot{\\gamma}}\\dot{\\gamma})^k = \\frac{d^2\\gamma^k}{dt^2} + \\Gamma^k_{ij} \\frac{d\\gamma^i}{dt} \\frac{d\\gamma^j}{dt} $$\n其中 $\\Gamma^k_{ij}$ 是克里斯托费尔符号。\n\n给定的曲线为 $\\gamma(t) = (\\gamma^1(t), \\gamma^2(t)) = (t, y_0)$。其速度分量为：\n$$ \\frac{d\\gamma^1}{dt} = \\frac{dx}{dt} = 1 $$\n$$ \\frac{d\\gamma^2}{dt} = \\frac{dy}{dt} = 0 $$\n其坐标加速度分量为：\n$$ \\frac{d^2\\gamma^1}{dt^2} = 0, \\quad \\frac{d^2\\gamma^2}{dt^2} = 0 $$\n由于 $\\frac{d\\gamma^2}{dt}=0$，协变加速度的表达式简化为：\n$$ (\\nabla_{\\dot{\\gamma}}\\dot{\\gamma})^k = \\frac{d^2\\gamma^k}{dt^2} + \\Gamma^k_{11} \\left(\\frac{d\\gamma^1}{dt}\\right)^2 = \\ddot{\\gamma}^k + \\Gamma^k_{11}(1)^2 = \\Gamma^k_{11} $$\n因此，我们只需要计算克里斯托费尔符号 $\\Gamma^1_{11}$ 和 $\\Gamma^2_{11}$。\n\n克里斯托费尔符号由以下公式计算：\n$$ \\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{jl}}{\\partial x^i} + \\frac{\\partial g_{il}}{\\partial x^j} - \\frac{\\partial g_{ij}}{\\partial x^l} \\right) $$\n度量分量仅依赖于 $x^2=y$，因此关于 $x^1=x$ 的偏导数为零。关于 $x^2=y$ 的非零偏导数是：\n$$ \\frac{\\partial g_{11}}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{1}{y^2}\\right) = -\\frac{2}{y^3} $$\n$$ \\frac{\\partial g_{22}}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{1}{y^2}\\right) = -\\frac{2}{y^3} $$\n计算 $\\Gamma^1_{11}$：\n$$ \\Gamma^1_{11} = \\frac{1}{2} g^{1l} \\left( \\frac{\\partial g_{1l}}{\\partial x^1} + \\frac{\\partial g_{1l}}{\\partial x^1} - \\frac{\\partial g_{11}}{\\partial x^l} \\right) = \\frac{1}{2} g^{11} \\left( 2\\frac{\\partial g_{11}}{\\partial x^1} - \\frac{\\partial g_{11}}{\\partial x^1} \\right) = \\frac{1}{2} g^{11} \\frac{\\partial g_{11}}{\\partial x} = 0 $$\n因为 $g_{11}$ 不依赖于 $x$。\n计算 $\\Gamma^2_{11}$：\n$$ \\Gamma^2_{11} = \\frac{1}{2} g^{2l} \\left( \\frac{\\partial g_{1l}}{\\partial x^1} + \\frac{\\partial g_{1l}}{\\partial x^1} - \\frac{\\partial g_{11}}{\\partial x^l} \\right) = \\frac{1}{2} g^{22} \\left( 2\\frac{\\partial g_{12}}{\\partial x^1} - \\frac{\\partial g_{11}}{\\partial x^2} \\right) = \\frac{1}{2} y^2 \\left( 0 - \\frac{\\partial g_{11}}{\\partial y} \\right) = -\\frac{1}{2} y^2 \\left( -\\frac{2}{y^3} \\right) = \\frac{1}{y} $$\n现在我们计算协变加速度的分量。这些符号需要在曲线 $\\gamma(t)$ 上求值，即 $y=y_0$。\n对于 $k=1$：\n$$ (\\nabla_{\\dot{\\gamma}}\\dot{\\gamma})^1 = \\Gamma^1_{11} = 0 $$\n对于 $k=2$：\n$$ (\\nabla_{\\dot{\\gamma}}\\dot{\\gamma})^2 = \\Gamma^2_{11} = \\left.\\frac{1}{y}\\right|_{y=y_0} = \\frac{1}{y_0} $$\n协变加速度向量是 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma} = (\\nabla_{\\dot{\\gamma}}\\dot{\\gamma})^1 \\frac{\\partial}{\\partial x} + (\\nabla_{\\dot{\\gamma}}\\dot{\\gamma})^2 \\frac{\\partial}{\\partial y} = 0 \\cdot \\frac{\\partial}{\\partial x} + \\frac{1}{y_0} \\frac{\\partial}{\\partial y}$。\n因此，协变加速度的坐标行向量是 $\\left( 0, \\frac{1}{y_0} \\right)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0  \\frac{1}{y_0} \\end{pmatrix} } $$", "id": "2976986"}, {"introduction": "在许多实际应用中，测地线通常是通过数值方法计算或验证的，这构成了从解析理论到计算实践的桥梁。本练习 [@problem_id:2976975] 将指导你编写一个程序，以数值方式检验球面上的给定曲线是否为测地线。这个过程不仅能巩固你对协变加速度定义的理解，还能让你掌握在几何问题中应用有限差分和插值等重要数值技术的实践技能。", "problem": "给定单位 $2$-球面（即 $\\mathbb{R}^3$ 中与原点距离为 $1$ 的点的集合），其标准黎曼度量在球坐标 $(\\theta,\\phi)$ 中表示为 $g = d\\theta^2 + \\sin^2(\\theta)\\, d\\phi^2$，其中 $\\theta \\in (0,\\pi)$ 是极角，$\\phi \\in [0,2\\pi)$ 是方位角。此流形上的一条光滑曲线 $\\gamma(t) = (\\theta(t),\\phi(t))$ 是测地线，当且仅当其协变加速度为零，即对于所有 $t$，关于 $g$ 的 Levi-Civita 联络的协变导数 $\\nabla_{\\dot{\\gamma}(t)} \\dot{\\gamma}(t)$ 是零向量。\n\n任务：编写一个程序，通过从第一性原理出发计算每条曲线上沿线的协变加速度，并将其范数与预设容差进行比较，来验证几条数值指定的曲线是否为测地线。计算必须遵循以下要求。\n\n- 基本原理。\n  - 使用与度量 $g$ 相关联的 Levi-Civita 联络。\n  - 从度量 $g$ 和 Levi-Civita 联络的定义（无挠且度量兼容）出发，在 $(\\theta,\\phi)$ 坐标图的规则网格上计算该联络的 Christoffel 符号 $\\Gamma^k_{ij}$。利用这些 Christoffel 符号，在 $(\\theta,\\phi)$ 中构建双线性插值，以沿曲线计算 $\\Gamma^k_{ij}$ 的值。\n  - 对于曲线 $\\gamma(t)=(\\theta(t),\\phi(t))$，使用一致的二阶精度有限差分方法，从 $t$ 的均匀离散化中计算其速度 $\\dot{\\gamma}(t)$ 和加速度 $\\ddot{\\gamma}(t)$。然后，使用 Christoffel 符号以及 $\\dot{\\gamma}(t)$ 和 $\\ddot{\\gamma}(t)$ 的分量，在局部坐标中计算协变加速度向量 $\\nabla_{\\dot{\\gamma}(t)} \\dot{\\gamma}(t)$。\n  - 使用由 $g$ 导出的范数测量协变加速度的大小，即逐点量 $\\|\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}\\|_g = \\sqrt{ g_{ij}(\\gamma(t))\\, a^i(t)\\, a^j(t) }$，其中 $a^i(t)$ 是 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}$ 在时间 $t$ 的坐标分量。\n\n- 离散化与插值。\n  - 在 $\\theta$ 和 $\\phi$ 中构建一个矩形网格：\n    - $\\theta$ 在 $[\\theta_{\\min},\\theta_{\\max}]$ 区间内均匀分布，其中 $\\theta_{\\min} = 0.2$，$\\theta_{\\max} = \\pi - 0.2$，且至少有 $128$ 个点。\n    - $\\phi$ 在 $[0,2\\pi)$ 区间内均匀分布，且至少有 $256$ 个点。不包括端点 $2\\pi$ 以避免与 $\\phi=0$ 重复。\n  - 在此网格上，计算并存储度量 $g$ 的 Levi-Civita 联络的 Christoffel 符号 $\\Gamma^k_{ij}(\\theta,\\phi)$。然后为沿曲线计算 $\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}$ 所需的每个符号构建 $(\\theta,\\phi)$ 上的双线性插值器。\n  - 对于下面的每条曲线，将 $t \\in [0,1]$ 均匀离散化为至少 $1000$ 个点，使用二阶精度有限差分计算 $\\dot{\\gamma}(t)$ 和 $\\ddot{\\gamma}(t)$，并使用插值得到的 Christoffel 符号计算沿离散化曲线的协变加速度。\n\n- 验证规则与容差。\n  - 固定容差 $\\tau = 10^{-3}$。\n  - 对于每条曲线，计算在离散的 $t$ 值上协变加速度的 $g$-范数的最大值。当且仅当该最大值小于或等于 $\\tau$ 时，声明该曲线为数值验证的测地线。\n  - 所有计算中角度必须以弧度处理。\n\n- 测试集。\n  - 情况 A（赤道大圆）：$\\theta(t) = \\frac{\\pi}{2}$ 且 $\\phi(t) = \\frac{\\pi}{5} + \\pi t$。\n  - 情况 B（非测地线的纬线）：$\\theta(t) = \\frac{\\pi}{3}$ 且 $\\phi(t) = \\frac{\\pi}{5} + \\pi t$。\n  - 情况 C（子午线大圆）：$\\theta(t) = \\frac{\\pi}{4} + \\frac{\\pi}{2} t$ 且 $\\phi(t) = 1$。\n  - 情况 D（轻微扰动的赤道）：$\\theta(t) = \\frac{\\pi}{2} + 10^{-6} \\sin(6\\pi t)$ 且 $\\phi(t) = \\frac{\\pi}{5} + \\pi t$。\n\n- 输出规格。\n  - 对于 A、B、C、D 四种情况，按顺序为每一种情况生成一个布尔值，指示该曲线是否根据上述规则被验证为测地线。\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},{\\tt True},{\\tt True}]$。\n\n注。\n- 所有时间导数必须使用与二阶精度一致的方法，在均匀的时间步长上计算。\n- Christoffel 符号的插值必须在 $(\\theta,\\phi)$ 坐标图上，使用所构建网格上的双线性插值来执行。\n- 确保所有曲线样本点都保持在插值域 $[\\theta_{\\min},\\theta_{\\max}] \\times [0,2\\pi)$ 内，以避免外插。", "solution": "我们从黎曼几何的基本定义开始。具有度量 $g = d\\theta^2 + \\sin^2(\\theta)\\, d\\phi^2$ 的单位 $2$-球面拥有一个唯一的 Levi-Civita 联络，其特征是无挠且与度量兼容。在局部坐标 $(\\theta,\\phi)$ 中，Levi-Civita 联络由 Christoffel 符号 $\\Gamma^k_{ij}$ 描述，这些符号是度量系数及其一阶导数的函数。对于给定的度量，可以通过标准方法计算出非零的 Christoffel 符号。度量张量的分量为 $g_{\\theta\\theta} = 1$，$g_{\\phi\\phi} = \\sin^2(\\theta)$，以及 $g_{\\theta\\phi} = g_{\\phi\\theta} = 0$。逆度量的分量为 $g^{\\theta\\theta} = 1$ 和 $g^{\\phi\\phi} = \\csc^2(\\theta)$，且 $g^{\\theta\\phi} = g^{\\phi\\theta} = 0$。使用 Levi-Civita 联络系数的公式，\n$$\n\\Gamma^k_{ij} = \\tfrac{1}{2} g^{k\\ell} \\left( \\partial_i g_{j\\ell} + \\partial_j g_{i\\ell} - \\partial_\\ell g_{ij} \\right),\n$$\n以及导数 $\\partial_\\theta g_{\\phi\\phi} = 2 \\sin(\\theta) \\cos(\\theta)$（而 $g_{ij}$ 的所有其他一阶导数均为零），我们得到仅有的非零 Christoffel 符号：\n$$\n\\Gamma^\\theta_{\\phi\\phi} = -\\sin(\\theta)\\cos(\\theta), \\quad \\Gamma^\\phi_{\\theta\\phi} = \\Gamma^\\phi_{\\phi\\theta} = \\cot(\\theta).\n$$\n所有其他的 $\\Gamma^k_{ij}$ 均为零。\n\n给定一条光滑曲线 $\\gamma(t) = (\\theta(t),\\phi(t))$，其速度沿自身的协变导数在局部坐标中表示为\n$$\n\\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^k = \\ddot{x}^k + \\Gamma^k_{ij} \\dot{x}^i \\dot{x}^j,\n$$\n其中 $x^1 = \\theta$ 和 $x^2 = \\phi$，并且对指标 $i$ 和 $j$ 使用了爱因斯坦求和约定。这个表达式源于协变导数在坐标中的定义，它将几何加速度与经过联络校正的坐标加速度联系起来。根据测地线的定义属性，对于仿射参数化，有 $\\nabla_{\\dot{\\gamma}} \\dot{\\gamma} = 0$。\n\n为了数值验证一条曲线是否为测地线，我们按以下步骤进行。\n\n- 网格与插值。在 $(\\theta,\\phi)$ 中构建一个矩形网格，其中 $\\theta \\in [\\theta_{\\min},\\theta_{\\max}]$ 且 $\\phi \\in [0,2\\pi)$，$\\theta_{\\min} = 0.2$ 且 $\\theta_{\\max} = \\pi - 0.2$。选择 $n_\\theta \\ge 128$ 和 $n_\\phi \\ge 256$ 个均匀间隔的点，其中 $\\phi$ 不包含端点 $2\\pi$。在每个网格点上，计算 Christoffel 符号。对于 $2$-球面，只有 $\\Gamma^\\theta_{\\phi\\phi}(\\theta,\\phi) = -\\sin(\\theta)\\cos(\\theta)$ 和 $\\Gamma^\\phi_{\\theta\\phi}(\\theta,\\phi) = \\Gamma^\\phi_{\\phi\\theta}(\\theta,\\phi) = \\cot(\\theta)$ 是非零的，并且仅依赖于 $\\theta$。为这些分量构建双线性插值器（依赖于 $\\theta$ 和 $\\phi$），并将其余分量视为恒为零。\n\n- 时间离散化与有限差分。对于在 $t \\in [0,1]$ 上定义的每个测试曲线 $\\gamma(t) = (\\theta(t),\\phi(t))$，使用 $N \\ge 1000$ 个点和步长 $\\Delta t = 1/(N-1)$ 对 $t$ 进行均匀离散化。使用二阶精度的有限差分格式计算 $\\dot{\\gamma}(t)$ 和 $\\ddot{\\gamma}(t)$。一种标准方法是对内部点使用中心差分，对端点使用单侧差分；例如，对 $t$ 应用两次数值梯度算子可以得到具有二阶内部精度的 $\\dot{\\gamma}$ 和 $\\ddot{\\gamma}$ 的近似值。\n\n- 协变加速度及其范数。在每个离散的时间点，在 $(\\theta(t),\\phi(t))$ 处计算插值得到的 Christoffel 符号，并使用上述公式计算 $\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}$ 的分量。计算由 $g$ 导出的范数：\n$$\n\\|\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\|_g = \\sqrt{ g_{\\theta\\theta}(\\gamma(t)) \\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^\\theta{}^2 + g_{\\phi\\phi}(\\gamma(t)) \\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^\\phi{}^2 } = \\sqrt{ \\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^\\theta{}^2 + \\sin^2(\\theta(t)) \\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^\\phi{}^2 }.\n$$\n然后取所有离散 $t$ 值的最大值。\n\n- 验证规则。使用指定的容差 $\\tau = 10^{-3}$，如果 $\\|\\nabla_{\\dot{\\gamma}}\\dot{\\gamma}\\|_g$ 在离散 $t$ 值上的最大值小于或等于 $\\tau$，则声明该曲线为数值验证的测地线。\n\n我们将此方法应用于四个测试用例：\n\n- 情况 A：$\\theta(t) = \\frac{\\pi}{2}$ 且 $\\phi(t) = \\frac{\\pi}{5} + \\pi t$。此处 $\\dot{\\theta} = 0$，$\\ddot{\\theta} = 0$，$\\dot{\\phi} = \\pi$ 且 $\\ddot{\\phi} = 0$。由于 $\\Gamma^\\theta_{\\phi\\phi}(\\frac{\\pi}{2}) = 0$ 且 $\\Gamma^\\phi_{\\theta\\phi}(\\frac{\\pi}{2}) = 0$，协变加速度分量为零，因此范数在舍入误差范围内数值上为零。最大范数预计远小于 $\\tau$，得出 ${\\tt True}$。\n\n- 情况 B：$\\theta(t) = \\frac{\\pi}{3}$ 且 $\\phi(t) = \\frac{\\pi}{5} + \\pi t$。此处 $\\dot{\\theta} = 0$，$\\ddot{\\theta} = 0$，$\\dot{\\phi} = \\pi$ 且 $\\ddot{\\phi} = 0$，但 $\\Gamma^\\theta_{\\phi\\phi}(\\frac{\\pi}{3}) = -\\sin(\\frac{\\pi}{3})\\cos(\\frac{\\pi}{3}) = -\\frac{\\sqrt{3}}{4} \\approx -0.4330127$。因此 $\\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^\\theta = \\Gamma^\\theta_{\\phi\\phi} (\\dot{\\phi})^2 \\approx -0.4330127 \\cdot \\pi^2 \\approx -4.276056$，且 $\\left(\\nabla_{\\dot{\\gamma}} \\dot{\\gamma}\\right)^\\phi = 0$。范数约为 $4.276056 \\gg \\tau$，得出 ${\\tt False}$。\n\n- 情况 C：$\\theta(t) = \\frac{\\pi}{4} + \\frac{\\pi}{2} t$ 且 $\\phi(t) = 1$。此处 $\\dot{\\phi} = 0$，$\\ddot{\\phi} = 0$，因此唯一不平凡的分量是 $\\dot{\\theta} = \\frac{\\pi}{2}$ 和 $\\ddot{\\theta} = 0$。由于唯一的非零 Christoffel 符号的下标要么是 $(\\phi,\\phi)$，要么是混合的 $(\\theta,\\phi)$，所有 $\\Gamma^k_{ij} \\dot{x}^i \\dot{x}^j$ 项都因 $\\dot{\\phi} = 0$ 而为零。因此，协变加速度在离散化误差范围内数值上为零，最大范数远小于 $\\tau$，得出 ${\\tt True}$。\n\n- 情况 D：$\\theta(t) = \\frac{\\pi}{2} + 10^{-6} \\sin(6\\pi t)$ 且 $\\phi(t) = \\frac{\\pi}{5} + \\pi t$。此处 $\\dot{\\theta}$ 和 $\\ddot{\\theta}$ 很小，其中 $\\ddot{\\theta}$ 的振幅为 $(6\\pi)^2 \\cdot 10^{-6} \\approx 3.55 \\times 10^{-4}$。在 $\\theta = \\frac{\\pi}{2}$ 附近，混合 Christoffel 项的贡献被抑制，因为 $\\cot(\\theta) \\approx 0$，并且 $\\Gamma^\\theta_{\\phi\\phi}$ 在 $\\frac{\\pi}{2}$ 处为零。因此，协变加速度的 $g$-范数保持在 $10^{-4}$ 的量级，因而低于 $\\tau$。这得出 ${\\tt True}$。\n\n算法实现细节：\n\n- 我们选择 $n_\\theta = 201$ 和 $n_\\phi = 256$ 来构建网格。$\\phi$ 网格省略了端点 $2\\pi$ 以避免重复。我们计算非零 Christoffel 符号的数组，并使用规则网格插值例程在 $(\\theta,\\phi)$ 中构建双线性插值器。\n- 对于时间离散化，选择 $[0,1]$ 上的 $N = 1001$ 个均匀间隔的点，以确保数值微分的准确性。使用二阶精度的梯度计算来近似 $\\dot{\\gamma}$ 和 $\\ddot{\\gamma}$。\n- 在每个离散时间点，计算插值得到的 Christoffel 符号，并通过坐标表达式组装协变加速度。计算 $g$-范数并取其最大值。与 $\\tau$ 比较，为每个情况生成布尔结果。\n- 最终输出是包含 A、B、C、D 顺序的布尔值列表的单行文本。\n\n通过这些步骤，程序为指定的测试集生成 ${\\tt [True,False,True,True]}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import RegularGridInterpolator\n\ndef build_christoffel_interpolators(theta_grid, phi_grid):\n    \"\"\"\n    Build bilinear interpolators for the nonzero Christoffel symbols on S^2 with metric\n    g = dtheta^2 + sin^2(theta) dphi^2 in coordinates (theta, phi).\n    Nonzero components:\n      Gamma^theta_{phi phi} = -sin(theta) * cos(theta)\n      Gamma^phi_{theta phi} = Gamma^phi_{phi theta} = cot(theta) = cos(theta)/sin(theta)\n    All others are zero.\n    \"\"\"\n    # Create meshgrid for evaluation; values depend only on theta but define full 2D arrays.\n    TH, PH = np.meshgrid(theta_grid, phi_grid, indexing='ij')\n    sinTH = np.sin(TH)\n    cosTH = np.cos(TH)\n\n    # Allocate arrays for the nonzero components on the grid\n    Gamma_theta_phiphi = -sinTH * cosTH  # shape (n_theta, n_phi)\n    # Avoid division by zero; grid chosen away from poles, but guard numerically anyway.\n    with np.errstate(divide='ignore', invalid='ignore'):\n        Gamma_phi_thetaphi = np.where(sinTH != 0.0, cosTH / sinTH, 0.0)\n\n    # Build interpolators; inputs are (theta, phi)\n    interp_G_th_phph = RegularGridInterpolator(\n        (theta_grid, phi_grid), Gamma_theta_phiphi, bounds_error=True, method='linear'\n    )\n    interp_G_ph_thph = RegularGridInterpolator(\n        (theta_grid, phi_grid), Gamma_phi_thetaphi, bounds_error=True, method='linear'\n    )\n    # Gamma^phi_{phi theta} is the same as Gamma^phi_{theta phi}\n    interp_G_ph_phth = interp_G_ph_thph\n\n    return interp_G_th_phph, interp_G_ph_thph, interp_G_ph_phth\n\ndef covariant_acceleration_norms(theta, phi, dtheta, dphi, ddtheta, ddphi,\n                                 interp_G_th_phph, interp_G_ph_thph, interp_G_ph_phth):\n    \"\"\"\n    Compute the g-norm of the covariant acceleration along a discretized curve on S^2.\n\n    Inputs:\n      theta, phi: arrays of shape (N,)\n      dtheta, dphi: first derivatives wrt t, arrays (N,)\n      ddtheta, ddphi: second derivatives wrt t, arrays (N,)\n      interpolators for the nonzero Christoffel symbols.\n\n    Returns:\n      norms: array of shape (N,) containing the g-norm at each sample\n    \"\"\"\n    pts = np.column_stack((theta, phi))  # shape (N, 2)\n\n    # Evaluate nonzero Christoffel components at the curve points\n    G_th_phph = interp_G_th_phph(pts)        # Gamma^theta_{phi phi}\n    G_ph_thph = interp_G_ph_thph(pts)        # Gamma^phi_{theta phi}\n    G_ph_phth = interp_G_ph_phth(pts)        # Gamma^phi_{phi theta}\n\n    # Assemble covariant acceleration components:\n    # a^theta = ddtheta + Gamma^theta_{phi phi} * (dphi)^2\n    a_theta = ddtheta + G_th_phph * (dphi ** 2)\n\n    # a^phi = ddphi + Gamma^phi_{theta phi} * dtheta * dphi + Gamma^phi_{phi theta} * dphi * dtheta\n    # Since the two mixed symbols are equal, this is ddphi + 2 * Gamma^phi_{theta phi} * dtheta * dphi\n    a_phi = ddphi + (G_ph_thph + G_ph_phth) * dtheta * dphi\n\n    # Metric components at points: g_theta_theta = 1, g_phi_phi = sin^2(theta)\n    sin_theta = np.sin(theta)\n    g_norms = np.sqrt(a_theta ** 2 + (sin_theta ** 2) * (a_phi ** 2))\n    return g_norms\n\ndef finite_differences(y, t):\n    \"\"\"\n    Compute first and second derivatives of y(t) using second-order accurate finite differences.\n    Uses numpy.gradient twice, which is second-order accurate in the interior and first-order at boundaries.\n    \"\"\"\n    dy = np.gradient(y, t, edge_order=2)\n    ddy = np.gradient(dy, t, edge_order=2)\n    return dy, ddy\n\ndef check_curve_is_geodesic(theta_func, phi_func, t_grid, tol,\n                            interp_G_th_phph, interp_G_ph_thph, interp_G_ph_phth):\n    \"\"\"\n    Evaluate a curve defined by (theta(t), phi(t)) on t_grid, compute covariant acceleration norms,\n    and return True if the maximum norm is less than or equal to tol.\n    \"\"\"\n    theta = theta_func(t_grid)\n    phi = phi_func(t_grid)\n\n    dtheta, ddtheta = finite_differences(theta, t_grid)\n    dphi, ddphi = finite_differences(phi, t_grid)\n\n    norms = covariant_acceleration_norms(theta, phi, dtheta, dphi, ddtheta, ddphi,\n                                         interp_G_th_phph, interp_G_ph_thph, interp_G_ph_phth)\n    max_norm = float(np.max(norms))\n    return max_norm = tol\n\ndef solve():\n    # Grid parameters\n    theta_min = 0.2\n    theta_max = np.pi - 0.2\n    n_theta = 201\n    n_phi = 256\n\n    theta_grid = np.linspace(theta_min, theta_max, n_theta)\n    phi_grid = np.linspace(0.0, 2.0 * np.pi, n_phi, endpoint=False)\n\n    # Build Christoffel interpolators\n    interp_G_th_phph, interp_G_ph_thph, interp_G_ph_phth = build_christoffel_interpolators(theta_grid, phi_grid)\n\n    # Time discretization\n    N = 1001\n    t = np.linspace(0.0, 1.0, N)\n\n    # Tolerance\n    tau = 1e-3\n\n    # Define test curves (angles in radians)\n    # Case A: Equatorial great circle\n    theta_A = lambda tt: np.full_like(tt, 0.5 * np.pi)\n    phi_A = lambda tt: (np.pi / 5.0) + np.pi * tt\n\n    # Case B: Non-geodesic latitude\n    theta_B = lambda tt: np.full_like(tt, np.pi / 3.0)\n    phi_B = lambda tt: (np.pi / 5.0) + np.pi * tt\n\n    # Case C: Meridian great circle\n    theta_C = lambda tt: (np.pi / 4.0) + (0.5 * np.pi) * tt\n    phi_C = lambda tt: np.full_like(tt, 1.0)\n\n    # Case D: Slightly perturbed equator\n    theta_D = lambda tt: (0.5 * np.pi) + (1e-6) * np.sin(6.0 * np.pi * tt)\n    phi_D = lambda tt: (np.pi / 5.0) + np.pi * tt\n\n    test_cases = [\n        (theta_A, phi_A),\n        (theta_B, phi_B),\n        (theta_C, phi_C),\n        (theta_D, phi_D),\n    ]\n\n    results = []\n    for theta_func, phi_func in test_cases:\n        ok = check_curve_is_geodesic(theta_func, phi_func, t, tau,\n                                     interp_G_th_phph, interp_G_ph_thph, interp_G_ph_phth)\n        results.append(ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join('True' if r else 'False' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2976975"}]}