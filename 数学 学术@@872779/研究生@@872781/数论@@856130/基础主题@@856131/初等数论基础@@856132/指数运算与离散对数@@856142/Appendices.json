{"hands_on_practices": [{"introduction": "离散对数问题的计算复杂度在很大程度上取决于群阶的因子分解。Pohlig-Hellman 算法利用了这一特性，当群阶是光滑数（即其素因子都很小）时，它是一种极其高效的“分而治之”策略。这个练习将指导你完成一个具体的计算，将一个大问题分解到与群阶素因子对应的子群中，分别求解，最后用中国剩余定理重构最终解 [@problem_id:3015900]。", "problem": "设素数 $p = 241$，且 $m = p - 1$。考虑阶为 $m$ 的循环乘法群 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 和离散对数问题：给定 $g = 7$ 和 $h = 104$，确定指数 $x \\in \\{0,1,\\dots,m-1\\}$ 使得 $g^{x} \\equiv h \\pmod{p}$。整数 $m$ 分解为 $m = 240 = 2^{4} \\cdot 3 \\cdot 5$，这是一个平滑数。从群阶、离散对数和 $m$ 的素数幂次分解的基本定义出发，应用 Pohlig–Hellman 算法来计算 $x$，步骤如下：\n1. 验证 $g$ 在 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 中的阶为 $m$。\n2. 在相应的素数幂次子群中使用指数运算计算 $x \\bmod 2^{4}$、$x \\bmod 3$ 和 $x \\bmod 5$。\n3. 通过中国剩余定理（CRT）重构 $x \\bmod m$。\n最后，验证重构的 $x$ 满足 $g^{x} \\equiv h \\pmod{p}$。将最终答案表示为精确整数 $x$（无四舍五入）。", "solution": "问题陈述是求解一个离散对数问题的明确定义的实例，其中有限循环群的阶是一个平滑数。给出了必要的已知条件：素数模 $p=241$，生成元 $g=7$，目标元素 $h=104$，以及群阶的因式分解 $m = p-1 = 240 = 2^4 \\cdot 3 \\cdot 5$。使用 Pohlig-Hellman 算法并验证结果的说明是清晰且数学上合理的。因此，该问题是有效的。\n\n我们被要求找到一个整数 $x \\in \\{0, 1, \\dots, 239\\}$ 使得 $7^x \\equiv 104 \\pmod{241}$。\n\n\\textbf{第一步：验证 g=7 的阶}\n\n群 $(\\mathbb{Z}/241\\mathbb{Z})^{\\times}$ 的阶是 $m = 240$。为确认 $g=7$ 是一个生成元，其阶必须是 $240$。这需要证明对于 $m$ 的每个不同素因子 $q$，都有 $g^{m/q} \\not\\equiv 1 \\pmod{p}$。$m=240$ 的素因子是 $2$、$3$ 和 $5$。\n\n对于 $q=2$，指数是 $m/2 = 120$。我们计算 $7^{120} \\pmod{241}$：\n$7^2 = 49$\n$7^4 \\equiv (49)^2 = 2401 = 10(241)-9 \\equiv -9 \\pmod{241}$\n$7^8 \\equiv (-9)^2 = 81 \\pmod{241}$\n$7^{16} \\equiv 81^2 = 6561 = 27(241)+54 \\equiv 54 \\pmod{241}$\n$7^{32} \\equiv 54^2 = 2916 = 12(241)+24 \\equiv 24 \\pmod{241}$\n$7^{40} = 7^{32} \\cdot 7^8 \\equiv 24 \\cdot 81 = 1944 = 8(241)+16 \\equiv 16 \\pmod{241}$\n$7^{80} = (7^{40})^2 \\equiv 16^2 = 256 \\equiv 15 \\pmod{241}$。由于 $15 \\not\\equiv 1$，这覆盖了 $q=3$ 的情况 ($m/3=80$)。\n$7^{120} = 7^{80} \\cdot 7^{40} \\equiv 15 \\cdot 16 = 240 \\equiv -1 \\pmod{241}$。由于 $-1 \\not\\equiv 1$，这覆盖了 $q=2$ 的情况。\n\n对于 $q=5$，指数是 $m/5 = 48$。我们计算 $7^{48} \\pmod{241}$：\n$7^{48} = 7^{32} \\cdot 7^{16} \\equiv 24 \\cdot 54 = 1296 = 5(241)+91 \\equiv 91 \\pmod{241}$。由于 $91 \\not\\equiv 1$，这覆盖了 $q=5$ 的情况。\n\n由于对于 $q \\in \\{2,3,5\\}$ 都有 $g^{m/q} \\not\\equiv 1 \\pmod{p}$，所以 $g=7$ 的阶是 $m=240$。\n\n\\textbf{第二步：计算 x 模 m 的素数幂次因子}\n\nPohlig-Hellman 算法将问题简化为求解关于 $x$ 模 $m$ 的每个素数幂次因子的同余方程；在本例中，即模 $2^4=16$、$3$ 和 $5$。\n\n\\textbf{2a. 计算 $x \\pmod{16}$}\n我们想要求出 $x \\pmod{16}$。我们定义 $g_1 = g^{m/16} = 7^{240/16} = 7^{15}$ 和 $h_1 = h^{m/16} = 104^{15}$。原始同余式 $g^x \\equiv h$ 意味着 $g_1^x \\equiv h_1$。\n$g_1 = 7^{15} = 7^{8+4+2+1} \\equiv 81 \\cdot (-9) \\cdot 49 \\cdot 7 \\pmod{241}$。\n$81 \\cdot (-9) = -729 = -3(241)-6 \\equiv -6 \\pmod{241}$。\n$49 \\cdot 7 = 343 = 1(241)+102 \\equiv 102 \\pmod{241}$。\n$g_1 \\equiv -6 \\cdot 102 = -612 = -3(241)+111 \\equiv 111 \\pmod{241}$。\n\n$h_1 = 104^{15} \\pmod{241}$。我们需要计算 $104$ 的幂：\n$104^2 \\equiv (104)^2 = 10816 = 44(241)+212 \\equiv -29 \\pmod{241}$。\n$104^4 \\equiv (-29)^2 = 841 = 3(241)+118 \\equiv 118 \\pmod{241}$。\n$104^8 \\equiv 118^2 = 13924 = 57(241)+187 \\equiv -54 \\pmod{241}$。\n$h_1 = 104^{8+4+2+1} \\equiv (-54) \\cdot 118 \\cdot (-29) \\cdot 104 \\pmod{241}$。\n$(-54) \\cdot 118 = -6372 = -26(241)-106 \\equiv -106 \\pmod{241}$。\n$(-29) \\cdot 104 = -3016 = -12(241)-124 \\equiv -124 \\pmod{241}$。\n$h_1 \\equiv (-106) \\cdot (-124) = 13144 = 54(241)+130 \\equiv 130 \\pmod{241}$。\n\n我们需要解 $111^x \\equiv 130 \\pmod{241}$。$g_1=111$ 的阶是 $16$。我们检查 $111$ 的幂：$111^8 \\equiv (111^4)^2 \\equiv (177)^2 = 31329 = 130(241)-1 \\equiv -1 \\pmod{241}$。\n由于 $130 = 241-111 \\equiv -111 \\pmod{241}$，同余式为 $111^x \\equiv -111 \\pmod{241}$。\n这意味着 $111^{x-1} \\equiv -1 \\equiv 111^8 \\pmod{241}$。由于 $111$ 的阶是 $16$，我们有 $x-1 \\equiv 8 \\pmod{16}$，这给出 $x \\equiv 9 \\pmod{16}$。\n\n\\textbf{2b. 计算 $x \\pmod 3$}\n我们定义 $g_2 = g^{m/3} = 7^{80}$ 和 $h_2 = h^{m/3} = 104^{80}$。\n从第一步可知，$g_2 = 7^{80} \\equiv 15 \\pmod{241}$。\n对于 $h_2$，我们需要计算 $104$ 的幂：\n$104^{16} \\equiv 24 \\pmod{241}$。\n$104^{32} \\equiv 24^2 = 576 = 2(241)+94 \\equiv 94 \\pmod{241}$。\n$104^{64} \\equiv 94^2 = 8836 = 36(241)+160 \\equiv 160 \\pmod{241}$。\n$h_2 = 104^{64+16} \\equiv 160 \\cdot 24 = 3840 = 15(241)+225 \\equiv 225 \\pmod{241}$。\n我们解 $15^x \\equiv 225 \\pmod{241}$。通过观察，$15^2 = 225$，所以 $x \\equiv 2 \\pmod 3$。\n\n\\textbf{2c. 计算 $x \\pmod 5$}\n我们定义 $g_3 = g^{m/5} = 7^{48}$ 和 $h_3 = h^{m/5} = 104^{48}$。\n从第一步可知，$g_3 = 7^{48} \\equiv 91 \\pmod{241}$。\n$h_3 = 104^{48} = 104^{32+16} \\equiv 94 \\cdot 24 = 2256 = 9(241)+87 \\equiv 87 \\pmod{241}$。\n我们解 $91^x \\equiv 87 \\pmod{241}$。我们测试 $91$ 的幂：\n$91^1 \\equiv 91 \\pmod{241}$。\n$91^2 = 8281 = 34(241)+87 \\equiv 87 \\pmod{241}$。\n因此，$x \\equiv 2 \\pmod 5$。\n\n\\textbf{第三步：通过中国剩余定理重构 x}\n我们有以下同余方程组：\n1) $x \\equiv 9 \\pmod{16}$\n2) $x \\equiv 2 \\pmod 3$\n3) $x \\equiv 2 \\pmod 5$\n\n由 (2) 和 (3)，因为 $3$ 和 $5$ 互素，所以 $x \\equiv 2 \\pmod{3 \\cdot 5}$，即 $x \\equiv 2 \\pmod{15}$。\n我们可以写成 $x = 15k + 2$，其中 $k$ 是某个整数。将此代入 (1)：\n$15k + 2 \\equiv 9 \\pmod{16}$\n$15k \\equiv 7 \\pmod{16}$\n因为 $15 \\equiv -1 \\pmod{16}$，这变成：\n$-k \\equiv 7 \\pmod{16}$\n$k \\equiv -7 \\equiv 9 \\pmod{16}$\n所以，$k = 16j + 9$，其中 $j$ 是某个整数。将此代回 $x$ 的表达式中：\n$x = 15(16j + 9) + 2 = 240j + 135 + 2 = 240j + 137$。\n在范围 $\\{0, 1, \\dots, 239\\}$ 内的唯一解是 $x = 137$。\n\n\\textbf{第四步：验证}\n我们必须验证 $7^{137} \\equiv 104 \\pmod{241}$。\n指数的二进制展开是 $137_{10} = 10001001_2 = 128 + 8 + 1$。\n我们通过平方来计算所需的 $7$ 的幂：\n$7^1 \\equiv 7$\n$7^2 \\equiv 49$\n$7^4 \\equiv -9$\n$7^8 \\equiv 81$\n$7^{16} \\equiv 54$\n$7^{32} \\equiv 24$\n$7^{64} \\equiv 94$\n$7^{128} \\equiv 94^2 = 8836 = 36(241)+160 \\equiv 160 \\pmod{241}$。\n\n现在我们计算最终的乘积：\n$7^{137} = 7^{128} \\cdot 7^8 \\cdot 7^1 \\pmod{241}$\n$7^{137} \\equiv 160 \\cdot 81 \\cdot 7 \\pmod{241}$\n$160 \\cdot 81 = 12960 = 53(241)+187 \\equiv 187 \\pmod{241}$。\n$7^{137} \\equiv 187 \\cdot 7 = 1309 = 5(241)+104 \\equiv 104 \\pmod{241}$。\n结果得到验证。x 的值为 137。", "answer": "$$\\boxed{137}$$", "id": "3015900"}, {"introduction": "对于大素数域，当群阶不是光滑数时，Pohlig-Hellman 算法不再有效，我们需要更强大的工具。指标演算法 (Index Calculus) 是解决此类问题最有效的亚指数时间算法。通过这个练习，你将学习如何构建一个关于“因子基”中元素的离散对数数据库，并通过求解线性方程组来计算目标元素的对数 [@problem_id:3015903]，这深刻揭示了该问题在代数和计算方面的联系。", "problem": "考虑素数模 $p=101$ 的有限域 $\\mathbb{F}_{p}$。令 $G=\\mathbb{F}_{p}^{\\times}$ 表示模 $p$ 的非零余数的乘法群，已知该群为阶是 $p-1=100$ 的循环群。令 $g=2\\in G$ 且 $h=29\\in G$。在本题中，您将执行一个指标演算法的小规模实例，以确定离散对数 $x\\in\\{0,1,\\dots,99\\}$，使得 $g^{x}\\equiv h\\pmod{p}$。\n\n仅使用以下基础要素：\n- 循环群和素数模下的原根的定义。\n- 循环群中离散对数 $\\log_{g}(y)$ 的定义，其特征为 $g^{\\log_{g}(y)}\\equiv y\\pmod{p}$。\n- 乘法群 $G$ 的阶为 $p-1$ 这一事实，意味着指数运算在模 $p-1$ 下进行。\n- 同态性质 $\\log_{g}(ab)\\equiv\\log_{g}(a)+\\log_{g}(b)\\pmod{p-1}$ 对 $a,b\\in G$ 成立（由群结构和离散对数的定义导出）。\n\n执行以下步骤计算离散对数 $\\log_{g}(h)$：\n\n1. 从群阶的第一性原理出发，通过检验排除 $p-1$ 的真因数的必要阶条件，来论证 $g=2$ 是否为 $G$ 的生成元（原根）。\n2. 固定因子基 $B=\\{2,3,5,7\\}$。构造形如 $g^{k}\\equiv\\prod_{q\\in B}q^{e_{q}}\\pmod{p}$ 的显式关系，其中右侧是 $B$-光滑的（即其素因子均在 $B$ 中）。每个这样的关系都会产生一个关于未知数 $\\{\\log_{g}(q)\\}_{q\\in B}$ 模 $p-1$ 的线性同余方程。\n3. 使用您构造的关系求解至少 $q\\in\\{3,5,7\\}$ 的 $\\log_{g}(q)$（注意，根据底的定义，$\\log_{g}(2)=1$）。\n4. 找一个小的指数 $t$ 使得 $h\\cdot g^{t}$ 是 $B$-光滑的。利用群同态性质将 $\\log_{g}(h)$ 与已知的 $\\log_{g}(q)$ 值和 $t$ 联系起来。\n5. 提供整数 $x=\\log_{g}(h)$ 的精确形式。无需四舍五入。\n\n您的最终答案必须是一个精确形式的单个整数。不涉及单位。", "solution": "该问题是计算数论中一个定义明确的练习，具体涉及离散对数问题。所有给定条件一致，问题具有科学性、客观性和良构性。因此，该问题被认为是有效的，并将提供解答。\n\n问题要求在乘法群 $G = \\mathbb{F}_{101}^{\\times}$ 中求离散对数 $x = \\log_{g}(h)$，其中 $g=2$，$h=29$。模数是素数 $p=101$，所以该群是阶为 $p-1=100$ 的循环群。$x$ 的值必须是集合 $\\{0, 1, \\dots, 99\\}$ 中的一个整数。我们遵循问题中概述的步骤。\n\n**第1步：论证 $g=2$ 是一个生成元**\n\n要证明 $g=2$ 是 $G=\\mathbb{F}_{101}^{\\times}$ 的一个生成元（原根），我们必须证明它的阶是 $|G|=p-1=100$。根据拉格朗日定理，任何元素的阶必须整除群的阶。要证明阶恰好为 $100$，只需证明对于 $100$ 的每个素因子 $q$，我们有 $g^{100/q} \\not\\equiv 1 \\pmod{101}$。\n\n$100$ 的素数分解是 $100 = 2^2 \\cdot 5^2$。不同的素因子是 $q=2$ 和 $q=5$。我们必须检查两个条件：\n1. $2^{100/2} \\equiv 2^{50} \\not\\equiv 1 \\pmod{101}$\n2. $2^{100/5} \\equiv 2^{20} \\not\\equiv 1 \\pmod{101}$\n\n我们计算 $2$ 在模 $101$ 下的这些幂：\n$2^1 = 2$\n$2^2 = 4$\n$2^3 = 8$\n$2^4 = 16$\n$2^5 = 32$\n$2^6 = 64$\n$2^7 = 128 \\equiv 27 \\pmod{101}$\n$2^{10} = 2^3 \\cdot 2^7 \\equiv 8 \\cdot 27 = 216 = 2 \\cdot 101 + 14 \\equiv 14 \\pmod{101}$\n\n使用这个结果，我们计算 $2^{20}$：\n$2^{20} = (2^{10})^2 \\equiv 14^2 = 196 = 196 - 101 = 95 \\pmod{101}$。\n由于 $95 \\not\\equiv 1 \\pmod{101}$，第二个条件满足。\n\n接下来，我们计算 $2^{50}$：\n$2^{50} = (2^{20})^2 \\cdot 2^{10} \\equiv 95^2 \\cdot 14 \\pmod{101}$。\n$95 \\equiv -6 \\pmod{101}$，所以 $95^2 \\equiv (-6)^2 = 36 \\pmod{101}$。\n$2^{50} \\equiv 36 \\cdot 14 = 504 \\pmod{101}$。\n$504 = 4 \\cdot 101 + 100$，所以 $504 \\equiv 100 \\pmod{101}$。\n由于 $100 \\not\\equiv 1 \\pmod{101}$，第一个条件也满足。\n\n两个条件都成立，所以 $g=2$ 的阶是 $100$。因此，$g=2$ 是 $\\mathbb{F}_{101}^{\\times}$ 的一个生成元。\n\n**第2步：构造线性关系**\n\n我们使用因子基 $B=\\{2,3,5,7\\}$ 来寻找关系。我们寻找 $g=2$ 的幂，使其在模 $101$ 下是 $B$-光滑的。令 $\\log_2(q)$ 表示以 $2$ 为底 $q$ 的离散对数。\n每个关系 $g^k \\equiv \\prod_{q \\in B} q^{e_q} \\pmod{101}$ 都会产生一个线性同余方程 $k \\equiv \\sum_{q \\in B} e_q \\log_2(q) \\pmod{100}$。\n\n根据定义，$\\log_2(2) = 1$。\n我们通过计算 $2$ 的幂来寻找关系：\n- $2^7 \\equiv 27 = 3^3 \\pmod{101}$。取 $\\log_2$ 得：\n$7 \\equiv 3 \\log_2(3) \\pmod{100}$。（关系1）\n- $2^9 \\equiv 512 \\equiv 7 \\pmod{101}$。取 $\\log_2$ 得：\n$9 \\equiv \\log_2(7) \\pmod{100}$。（关系2）\n- $2^{17} = 2^{10} \\cdot 2^7 \\equiv 14 \\cdot 27 = 378 = 3 \\cdot 101 + 75 \\equiv 75 = 3 \\cdot 5^2 \\pmod{101}$。取 $\\log_2$ 得：\n$17 \\equiv \\log_2(3) + 2 \\log_2(5) \\pmod{100}$。（关系3）\n- 为了找到另一个关系，我们寻找一个与 $5$ 的幂同余的 $2$ 的幂。从我们之前的计算 $2^{20} \\equiv 95 \\pmod{101}$，我们可以找到 $2^{24}$：\n$2^{24} = 2^{20} \\cdot 2^4 \\equiv 95 \\cdot 16 \\equiv (-6) \\cdot 16 = -96 \\equiv 5 \\pmod{101}$。取 $\\log_2$ 得：\n$24 \\equiv \\log_2(5) \\pmod{100}$。（关系4）\n\n**第3步：求解因子基的离散对数**\n\n我们得到了一个关于未知数 $\\log_2(3)$、$\\log_2(5)$ 和 $\\log_2(7)$ 的线性同余方程组。\n从关系2：\n$\\log_2(7) \\equiv 9 \\pmod{100}$。\n\n从关系4：\n$\\log_2(5) \\equiv 24 \\pmod{100}$。\n\n现在我们使用关系1来求 $\\log_2(3)$：\n$3 \\log_2(3) \\equiv 7 \\pmod{100}$。\n为了解出 $\\log_2(3)$，我们需要求 $3$ 模 $100$ 的乘法逆元。使用扩展欧几里得算法：\n$100 = 33 \\cdot 3 + 1 \\implies 1 = 100 - 33 \\cdot 3$。\n这意味着 $-33 \\cdot 3 \\equiv 1 \\pmod{100}$。由于 $-33 \\equiv 67 \\pmod{100}$，所以 $3$ 的逆元是 $67$。\n将同余式两边乘以 $67$：\n$\\log_2(3) \\equiv 7 \\cdot 67 \\pmod{100}$。\n$7 \\cdot 67 = 469$。\n$469 = 4 \\cdot 100 + 69$，所以 $\\log_2(3) \\equiv 69 \\pmod{100}$。\n\n我们可以使用关系3来验证这些值：\n$\\log_2(3) + 2 \\log_2(5) \\equiv 69 + 2(24) = 69 + 48 = 117 \\equiv 17 \\pmod{100}$。\n这与关系 $17 \\equiv \\log_2(3) + 2 \\log_2(5) \\pmod{100}$ 一致。\n\n因子基元素的离散对数是：\n$\\log_2(2) = 1$\n$\\log_2(3) = 69$\n$\\log_2(5) = 24$\n$\\log_2(7) = 9$\n\n**第4步：求 $h=29$ 的离散对数**\n\n我们现在寻找一个小的整数指数 $t$，使得 $h \\cdot g^t = 29 \\cdot 2^t$ 在模 $101$ 下是 $B$-光滑的。\n- 对于 $t=0$：$29 \\cdot 2^0 = 29$。不是 $B$-光滑的。\n- 对于 $t=1$：$29 \\cdot 2^1 = 58$。不是 $B$-光滑的。\n- 对于 $t=2$：$29 \\cdot 2^2 = 29 \\cdot 4 = 116$。模 $101$ 后，这是 $116 - 101 = 15$。\n$15 = 3 \\cdot 5$。这是 $B$-光滑的。\n\n所以我们有关系 $29 \\cdot 2^2 \\equiv 3 \\cdot 5 \\pmod{101}$。\n应用对数同态性质 $\\log_g(ab) \\equiv \\log_g(a) + \\log_g(b) \\pmod{p-1}$：\n$\\log_2(29 \\cdot 2^2) \\equiv \\log_2(3 \\cdot 5) \\pmod{100}$\n$\\log_2(29) + \\log_2(2^2) \\equiv \\log_2(3) + \\log_2(5) \\pmod{100}$\n令 $x = \\log_2(29)$。同余式变为：\n$x + 2 \\equiv \\log_2(3) + \\log_2(5) \\pmod{100}$\n\n**第5步：计算 $x$ 的最终值**\n\n代入我们在第3步中找到的值：\n$x + 2 \\equiv 69 + 24 \\pmod{100}$\n$x + 2 \\equiv 93 \\pmod{100}$\n$x \\equiv 93 - 2 \\pmod{100}$\n$x \\equiv 91 \\pmod{100}$\n\n所求的离散对数是 $x=91$。我们可以验证这个结果：我们必须检查是否 $2^{91} \\equiv 29 \\pmod{101}$。根据费马小定理，$2^{100} \\equiv 1 \\pmod{101}$。\n$2^{91} \\equiv 2^{-9} \\pmod{101}$。我们之前计算过 $2^9 \\equiv 7 \\pmod{101}$。所以我们需要计算 $7^{-1} \\pmod{101}$。再次对 $101$ 和 $7$ 使用扩展欧几里得算法：\n$101 = 14 \\cdot 7 + 3$\n$7 = 2 \\cdot 3 + 1$\n$1 = 7 - 2 \\cdot 3 = 7 - 2(101 - 14 \\cdot 7) = 7 - 2 \\cdot 101 + 28 \\cdot 7 = 29 \\cdot 7 - 2 \\cdot 101$。\n因此，$29 \\cdot 7 \\equiv 1 \\pmod{101}$，这意味着 $7^{-1} \\equiv 29 \\pmod{101}$。\n因此，$2^{91} \\equiv 2^{-9} \\equiv (2^9)^{-1} \\equiv 7^{-1} \\equiv 29 \\pmod{101}$。解答正确。", "answer": "$$\\boxed{91}$$", "id": "3015903"}, {"introduction": "离散对数问题不仅限于素数域 $\\mathbb{F}_p$。将其推广到模素数幂 $p^k$ 的乘法群 $U_{p^k}$ 中，会遇到新的结构和挑战。这个练习要求你首先推导一个算法，利用 $U_{p^k}$ 的循环结构分解来解决问题，然后将其应用于一个具体实例 [@problem_id:3015905]。这不仅能加深你对 $U_{p^k}$ 群结构的理解，还能锻炼你综合运用同态、提升技术和中国剩余定理解决问题的能力。", "problem": "考虑模素数幂的乘法单位群。设 $p$ 是一个奇素数且 $k \\geq 2$。记 $U_{p^{k}}$ 为模 $p^{k}$ 的单位群，其阶为 $\\varphi(p^{k}) = (p-1)p^{k-1}$。自然约化映射 $U_{p^{k}} \\to U_{p}$ 是一个满群同态，其核的大小为 $p^{k-1}$，并且对于奇素数 $p$，群 $U_{p^{k}}$ 是循环群。基于这些事实，可以通过利用 $U_{p^{k}}$ 分解为其阶为 $p-1$ 的挠部分和阶为 $p^{k-1}$ 的主单位部分，来推导出求解离散对数问题 $G^{x} \\equiv a \\pmod{p^{k}}$ 的策略。你的任务有两部分：\n\n1. 从上述基本事实出发，推导一个显式算法，该算法通过投影到 $U_{p}$ 来确定 $x$ 模 $(p-1)$ 的值，通过分离主单位分量（例如，通过将两边都取 $(p-1)$ 次幂）来确定 $x$ 模 $p^{k-1}$ 的值，然后使用中国剩余定理将这两个同余式组合成 $x$ 模 $(p-1)p^{k-1}$ 的值。\n\n2. 将你的算法应用于 $p=3$，$k=3$，$G=2$ 和 $a=14$ 的具体实例，并计算满足 $G^{x} \\equiv a \\pmod{3^{3}}$ 的唯一代表元 $x \\in \\{0,1,\\dots,\\varphi(3^{3})-1\\}$。将你的最终答案表示为一个精确整数。不需要四舍五入。", "solution": "任务首先是为奇素数 $p$ 和整数 $k \\geq 2$ 推导一个求解离散对数问题 $G^{x} \\equiv a \\pmod{p^{k}}$ 的算法，然后将此算法应用于一个具体的数值实例。\n\n### 第一部分：算法推导\n\n问题是找到一个整数 $x$ 满足 $G^{x} \\equiv a \\pmod{p^{k}}$，其中 $p$ 是一个奇素数，$k \\geq 2$，$G, a$ 是乘法单位群 $U_{p^{k}}$ 中的元素。由于对于奇素数 $p$，$U_{p^{k}}$ 是循环群，其阶为 $\\varphi(p^{k}) = (p-1)p^{k-1}$。对数 $x$ 在该阶的模下是唯一确定的。策略是分别求出 $x$ 模 $p-1$ 和模 $p^{k-1}$ 的值，然后因为 $\\gcd(p-1, p^{k-1}) = 1$，使用中国剩余定理（CRT）将结果合并。\n\n**步骤1：确定 $x$ 模 $p-1$**\n\n我们考虑同余式 $G^{x} \\equiv a \\pmod{p^{k}}$。这意味着该同余式对模 $p$ 也成立：\n$$G^{x} \\equiv a \\pmod{p}$$\n令 $x_1$ 为 $x$ 除以 $p-1$ 的余数，所以 $x \\equiv x_1 \\pmod{p-1}$。我们可以写成 $x = q(p-1) + x_1$，其中 $q$ 是某个整数。将此代入同余式得到：\n$$G^{q(p-1) + x_1} \\equiv (G^{p-1})^q G^{x_1} \\equiv a \\pmod{p}$$\n根据费马小定理，$G^{p-1} \\equiv 1 \\pmod{p}$ （假设 $p \\nmid G$，这是成立的，因为 $G \\in U_{p^k}$）。同余式简化为：\n$$G^{x_1} \\equiv a \\pmod{p}$$\n这是一个在群 $U_p$ 中的离散对数问题，该群的阶为 $p-1$。解出 $x_1$ 提供了第一个条件：$x \\equiv x_1 \\pmod{p-1}$。\n\n**步骤2：确定 $x$ 模 $p^{k-1}$**\n\n为了分离出 $x$ 中与 $p$ 的幂相关的分量，我们将原同余式两边同时取 $p-1$ 次幂：\n$$(G^{p-1})^{x} \\equiv a^{p-1} \\pmod{p^{k}}$$\n令 $H = G^{p-1} \\pmod{p^{k}}$ 和 $b = a^{p-1} \\pmod{p^{k}}$。根据费马小定理，$H$ 和 $b$ 都与 $1 \\pmod{p}$ 同余，所以它们属于主单位子群 $K = \\{z \\in U_{p^{k}} \\mid z \\equiv 1 \\pmod{p}\\}$。这个子群是阶为 $p^{k-1}$ 的循环群。现在要解的同余式是 $H^{x} \\equiv b \\pmod{p^{k}}$。由于我们正在处理的群的阶是 $p^{k-1}$，这将确定 $x$ 模 $p^{k-1}$ 的值。令这个值为 $x_2$。\n\n我们可以使用迭代提升法来求解 $x_2$。设 $x_2$ 的 $p$ 进制展开为 $x_2 = y_0 + y_1p + y_2p^2 + \\dots + y_{k-2}p^{k-2}$，其中 $y_i \\in \\{0, 1, \\dots, p-1\\}$。\n\n首先，我们通过考虑模 $p^2$ 的同余式来求 $y_0 = x_2 \\pmod{p}$。\n由于 $H \\equiv 1 \\pmod p$ 且 $b \\equiv 1 \\pmod p$，我们可以写成 $H = 1 + c_1 p$ 和 $b = 1 + d_1 p$，其中 $c_1, d_1$ 是某个整数。同余式 $H^{x_2} \\equiv b \\pmod{p^2}$ 变为：\n$$(1+c_1 p)^{x_2} \\equiv 1+d_1 p \\pmod{p^2}$$\n使用二项式展开，$(1+c_1 p)^{x_2} \\equiv 1 + x_2 c_1 p \\pmod{p^2}$。因此：\n$$1 + x_2 c_1 p \\equiv 1+d_1 p \\pmod{p^2} \\implies x_2 c_1 p \\equiv d_1 p \\pmod{p^2}$$\n这简化为 $x_2 c_1 \\equiv d_1 \\pmod{p}$，从而确定了 $y_0 = x_2 \\pmod p$。\n\n接下来，假设我们已经求出 $x_2^{(i-1)} = y_0 + \\dots + y_{i-2}p^{i-2}$，我们通过考虑模 $p^{i+1}$ 的同余式来求 $y_{i-1}$。我们想在 $x_2^{(i)} = x_2^{(i-1)} + y_{i-1}p^{i-1}$ 中解出 $y_{i-1}$。同余式为：\n$$H^{x_2^{(i-1)} + y_{i-1}p^{i-1}} \\equiv b \\pmod{p^{i+1}}$$\n$$H^{x_2^{(i-1)}} (H^{p^{i-1}})^{y_{i-1}} \\equiv b \\pmod{p^{i+1}}$$\n这可以被重新整理以解出 $y_{i-1}$。我们重复这个过程，直到找到所有系数 $y_0, \\dots, y_{k-2}$，从而确定 $x_2 = x \\pmod{p^{k-1}}$。\n\n**步骤3：使用中国剩余定理进行组合**\n\n我们有以下同余方程组：\n$$x \\equiv x_1 \\pmod{p-1}$$\n$$x \\equiv x_2 \\pmod{p^{k-1}}$$\n由于 $\\gcd(p-1, p^{k-1})=1$，因此 $x$ 在模 $(p-1)p^{k-1} = \\varphi(p^k)$ 下有唯一解。由第二个同余式，我们可以写出 $x = x_2 + m \\cdot p^{k-1}$，其中 $m$ 是某个整数。将此代入第一个同余式：\n$$x_2 + m \\cdot p^{k-1} \\equiv x_1 \\pmod{p-1}$$\n$$m \\cdot p^{k-1} \\equiv x_1 - x_2 \\pmod{p-1}$$\n我们通过求 $p^{k-1}$ 模 $p-1$ 的模逆元来解出 $m$：\n$$m \\equiv (x_1 - x_2)(p^{k-1})^{-1} \\pmod{p-1}$$\n令 $m_0$ 为 $m$ 的最小非负整数解。那么 $x$ 的最终解是 $x = x_2 + m_0 \\cdot p^{k-1}$。\n\n### 第二部分：应用于具体实例\n\n我们给定 $p=3$，$k=3$，$G=2$ 和 $a=14$。需要求解的同余式是 $2^{x} \\equiv 14 \\pmod{27}$。$U_{27}$ 群的阶是 $\\varphi(27)=18$。我们需要求 $x \\pmod{18}$，这可以通过求 $x \\pmod 2$ 和 $x \\pmod 9$ 来实现。\n\n**步骤1：确定 $x$ 模 $2$**\n\n将同余式模 $3$ 简化：\n$$2^x \\equiv 14 \\pmod 3$$\n$$(-1)^x \\equiv 2 \\pmod 3$$\n$$(-1)^x \\equiv -1 \\pmod 3$$\n这意味着 $x$ 必须是奇数。因此，$x_1=1$。\n$$x \\equiv 1 \\pmod 2$$\n\n**步骤2：确定 $x$ 模 $9$**\n\n我们需要求解 $x \\pmod{3^{3-1}}$，即 $x \\pmod 9$。首先，我们将原同余式两边取 $p-1=2$ 次幂：\n$$(2^2)^x \\equiv 14^2 \\pmod{27}$$\n$$4^x \\equiv 196 \\pmod{27}$$\n由于 $196 = 7 \\times 27 + 7$，我们有 $196 \\equiv 7 \\pmod{27}$。同余式变为：\n$$4^x \\equiv 7 \\pmod{27}$$\n我们现在使用提升法求解 $x_2 = x \\pmod 9$。令 $x = y_0 + 3y_1$。\n\n首先，在模 $p^2=9$ 下求解：\n$$4^x \\equiv 7 \\pmod 9$$\n注意到 $4 = 1+3$，我们使用二项式展开 $(1+3)^x \\equiv 1+3x \\pmod 9$。\n$$1+3x \\equiv 7 \\pmod 9$$\n$$3x \\equiv 6 \\pmod 9$$\n这个线性同余方程的解为 $x \\equiv 2, 5, 8 \\pmod 9$。所有这些解都满足 $x \\equiv 2 \\pmod 3$。所以，$y_0 = 2$。\n因此，我们知道 $x = 2 + 3y_1$，其中 $y_1$ 是某个整数。\n\n接下来，我们将此代入模 $27$ 的同余式中以求出 $y_1$：\n$$4^{2+3y_1} \\equiv 7 \\pmod{27}$$\n$$4^2 \\cdot (4^3)^{y_1} \\equiv 7 \\pmod{27}$$\n$$16 \\cdot (64)^{y_1} \\equiv 7 \\pmod{27}$$\n由于 $64 = 2 \\times 27 + 10$，我们有 $64 \\equiv 10 \\pmod{27}$。\n$$16 \\cdot 10^{y_1} \\equiv 7 \\pmod{27}$$\n我们需要 $16 \\pmod{27}$ 的逆元。扩展欧几里得算法给出 $16^{-1} \\equiv 22 \\pmod{27}$。两边同乘以 $22$：\n$$10^{y_1} \\equiv 7 \\times 22 \\pmod{27}$$\n$$10^{y_1} \\equiv 154 \\pmod{27}$$\n由于 $154 = 5 \\times 27 + 19$，我们有 $154 \\equiv 19 \\pmod{27}$。\n$$10^{y_1} \\equiv 19 \\pmod{27}$$\n我们测试 $y_1 \\in \\{0, 1, 2\\}$ 的值：\n$10^0 \\equiv 1 \\pmod{27}$\n$10^1 \\equiv 10 \\pmod{27}$\n$10^2 = 100 = 3 \\times 27 + 19 \\equiv 19 \\pmod{27}$\n所以，$y_1 = 2$。\n\n求出 $y_0=2$ 和 $y_1=2$ 后，我们可以确定 $x_2$：\n$$x_2 = y_0 + 3y_1 = 2 + 3(2) = 8$$\n因此，$x \\equiv 8 \\pmod 9$。\n\n**步骤3：使用中国剩余定理（CRT）组合**\n\n我们有方程组：\n$$x \\equiv 1 \\pmod 2$$\n$$x \\equiv 8 \\pmod 9$$\n由第二个同余式，得 $x = 8 + 9k$，其中 $k$ 是某个整数。代入第一个同余式：\n$$8 + 9k \\equiv 1 \\pmod 2$$\n$$0 + k \\equiv 1 \\pmod 2$$\n$$k \\equiv 1 \\pmod 2$$\n$k$ 的最小非负整数值是 $1$。\n将 $k=1$ 代回 $x$ 的表达式中：\n$$x = 8 + 9(1) = 17$$\n解必须在范围 $\\{0, 1, \\dots, 17\\}$ 内，所以 $x=17$ 是唯一解。\n\n我们来检验最终答案：\n$2^{17} = 2^9 \\cdot 2^8 \\pmod{27}$。\n$2^9 = 512 = 19 \\times 27 - 1 \\equiv -1 \\pmod{27}$。\n$2^8 = 256 = 9 \\times 27 + 13 \\equiv 13 \\pmod{27}$。\n$2^{17} \\equiv (-1) \\times 13 = -13 \\equiv 14 \\pmod{27}$。\n解是正确的。", "answer": "$$\\boxed{17}$$", "id": "3015905"}]}