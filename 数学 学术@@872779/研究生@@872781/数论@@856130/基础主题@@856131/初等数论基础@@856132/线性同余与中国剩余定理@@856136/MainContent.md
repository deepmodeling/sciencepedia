## 引言
[线性同余](@entry_id:150485)是数论中的一个基本概念，构成了模算术的基石。从古老的数学谜题到现代的数字[密码学](@entry_id:139166)，求解此[类方程](@entry_id:144428)组的能力已证明是不可或缺的。然而，许多讨论往往止于简单情形，未能深入揭示其背后深刻的[代数结构](@entry_id:137052)，以及其应用的广度与深度，从而留下知识上的空白。本文旨在填补这一空白，对[线性同余](@entry_id:150485)理论及著名的[中国剩余定理](@entry_id:144030)（CRT）进行一次全面的探索。

本文分为三个章节，旨在引导读者从理论走向实践。在第一章“原理与机制”中，我们将建立坚实的理论基础，从整数模n环的[代数结构](@entry_id:137052)出发，系统地发展出求解单个及多个[线性同余](@entry_id:150485)方程的方法，并最终深入剖析[中国剩余定理](@entry_id:144030)——它既是计算工具，也是结构性原理。第二章“应用与跨学科联系”将展示[中国剩余定理](@entry_id:144030)非凡的通用性，阐明其在加速密码学计算、构建抽象代数对象，甚至为数理逻辑和物理学提供基础工具中的关键作用。最后的“动手实践”部分则提供了一系列精选问题，让读者能够应用所学概念，巩固对这些强大技术的掌握。通过这三个章节的学习，您将深刻体会到，这个古老的定理如何在当代科学技术中依然保持着旺盛的生命力，并成为一个不可或缺的工具。

## 原理与机制

本章旨在深入探讨[线性同余](@entry_id:150485)理论的核心原理及其求解机制。我们将从整数模$n$环的基本[代数结构](@entry_id:137052)出发，系统地建立求解单个及多个[线性同余](@entry_id:150485)方程的理论框架。随后，我们将阐述中国剩余定理（Chinese Remainder Theorem, CRT）不仅作为一种求解工具，更作为一种揭示[模算术](@entry_id:143700)深层结构的强大理论。最后，我们将讨论处理一般线性[同余[方程](@entry_id:154048)组](@entry_id:193238)的普适条件，并[对相关](@entry_id:203353)算法的计算复杂性进行分析。

### [代数结构](@entry_id:137052)：整数模n环

数论中的许多概念都可以通过代数语言得到更深刻的理解。[线性同余](@entry_id:150485)理论的核心舞台是**整数模$n$环**，记作 $\mathbb{Z}/n\mathbb{Z}$。

这个结构建立在**[同余关系](@entry_id:272002)**之上。对于一个正整数 $n$，我们称两个整数 $a$ 和 $b$ **模$n$[同余](@entry_id:143700)**，记作 $a \equiv b \pmod{n}$，当且仅当它们的差 $a-b$ 是 $n$ 的整数倍，即 $n \mid (a-b)$ [@problem_id:3017103]。不难验证，这是一种等价关系（[自反性、对称性、传递性](@entry_id:140945)），它将整数集 $\mathbb{Z}$划分为 $n$ 个互不相交的**[等价类](@entry_id:156032)**，称为**[剩余类](@entry_id:185226)**或**[同余类](@entry_id:635978)**。每个[等价类](@entry_id:156032) $[a]$ 包含所有与 $a$ 模 $n$ 同余的整数，即 $[a] = \{ a + kn : k \in \mathbb{Z} \}$。

集合 $\mathbb{Z}/n\mathbb{Z}$ 正是由这 $n$ 个不同的[剩余类](@entry_id:185226)构成的：$\{[0], [1], \dots, [n-1]\}$。我们可以在这个集合上定义加法和乘法运算 [@problem_id:3017092]：
$$ [a] + [b] := [a+b] $$
$$ [a] \cdot [b] := [ab] $$
这些运算是**良定义的**，因为运算结果不依赖于我们选择哪个代表元。例如，若 $[a] = [a']$ 且 $[b] = [b']$，则 $a' = a+k_1n$ 且 $b' = b+k_2n$，那么 $a'b' = (a+k_1n)(b+k_2n) = ab + n(ak_2+bk_1+k_1k_2n)$，显然 $[a'b'] = [ab]$。

[同余关系](@entry_id:272002)与整数的加法和乘法运算是相容的。如果 $a \equiv b \pmod{m}$ 且 $c \equiv d \pmod{m}$，那么 $a+c \equiv b+d \pmod{m}$ 并且 $ac \equiv bd \pmod{m}$ [@problem_id:3017103]。这保证了上述在[剩余类](@entry_id:185226)上的运算是有效的。在这些运算下，$\mathbb{Z}/n\mathbb{Z}$ 构成了一个**[交换环](@entry_id:148261)**，其加法单位元是 $[0]$，乘法单位元是 $[1]$。

从加法结构来看，$(\mathbb{Z}/n\mathbb{Z}, +)$ 是一个 $n$ 阶**循环群**，由 $[1]$ 生成，因为任何元素 $[k]$ 都可以通过将 $[1]$ 与自身相加 $k$ 次得到 [@problem_id:3017092]。

在实际计算中，我们经常从每个[剩余类](@entry_id:185226)中选取一个代表元。任何一个包含 $n$ 个整数且它们模 $n$ 两两不[同余](@entry_id:143700)的集合，被称为一个**[完全剩余系](@entry_id:188246)**模$n$。最常见的例子是 $\{0, 1, \dots, n-1\}$。对一个模$n$的周期函数求和时，遍历一个[完全剩余系](@entry_id:188246)等价于遍历所有 $n$ 个[剩余类](@entry_id:185226) [@problem_id:3017098]。

乘法结构则更为复杂。并非所有 $\mathbb{Z}/n\mathbb{Z}$ 中的非零元素都有乘法[逆元](@entry_id:140790)。一个元素 $[a] \in \mathbb{Z}/n\mathbb{Z}$ 是一个**单位**（即存在乘法逆元），当且仅当存在一个 $[x]$ 使得 $ax \equiv 1 \pmod{n}$。根据[线性同余](@entry_id:150485)的基本理论（稍后详述），这个方程有解的充要条件是 $\gcd(a, n) = 1$ [@problem_id:3017092]。$\mathbb{Z}/n\mathbb{Z}$ 中所有单位构成的集合在乘法下形成一个群，称为**[单位群](@entry_id:184012)**，记作 $(\mathbb{Z}/n\mathbb{Z})^\times$。这个[群的阶](@entry_id:137115)数由欧拉phi函数 $\varphi(n)$ 给出。

相应地，一个**[既约剩余系](@entry_id:635195)**模$n$是 $\varphi(n)$ 个整数的集合，其中每个元素都与 $n$ [互质](@entry_id:143119)，并且它们模 $n$ 两两不同余。这个集合的元素恰好是[单位群](@entry_id:184012) $(\mathbb{Z}/n\mathbb{Z})^\times$ 中每个元素的一个代表元 [@problem_id:3017098]。例如，模 $12$ 的一个[既约剩余系](@entry_id:635195)是 $\{1, 5, 7, 11\}$。

如果 $n$ 是一个素数 $p$，那么所有非零元素 $[1], [2], \dots, [p-1]$ 都与 $p$ 互质，因此都是单位。在这种情况下，$\mathbb{Z}/p\mathbb{Z}$ 中每个非零元素都有乘法逆元，这使得 $\mathbb{Z}/p\mathbb{Z}$ 成为一个**域**。反之，如果 $\mathbb{Z}/n\mathbb{Z}$ 是一个域，那么每个非零元素都必须是单位，这意味着对所有 $a \in \{1, \dots, n-1\}$ 都有 $\gcd(a,n)=1$，这只在 $n$ 是素数时才成立 [@problem_id:3017092]。

如果 $n$ 是[合数](@entry_id:263553)，例如 $n=ab$ 其中 $1 \lt a, b \lt n$，那么 $[a]$ 和 $[b]$ 是非零元素，但它们的乘积 $[a][b] = [ab] = [n] = [0]$。这样的元素被称为**[零因子](@entry_id:151051)**。[零因子](@entry_id:151051)的存在意味着乘法逆元不一定存在，也导致了乘法消去律的失效。

### 求解单个[线性同余](@entry_id:150485)方程

最基本的[同余](@entry_id:143700)问题是求解形如 $ax \equiv b \pmod{n}$ 的**[线性同余](@entry_id:150485)方程**，其中 $a, b, n$ 是给定的整数 ($n>0$)，而 $x$ 是未知整数。

首先要解决的问题是：何时有解？该同余方程等价于存在一个整数 $y$ 使得 $ax - b = ny$，即 $ax - ny = b$。这是一个线性的**[丢番图方程](@entry_id:148433)**。根据[贝祖定理](@entry_id:166732)，这个方程有整数解 $(x, y)$ 的**充要条件**是 $a$ 和 $n$ 的最大公约数整除 $b$，即 $\gcd(a, n) \mid b$ [@problem_id:3017087]。

一旦确定有解，如何找到解？设 $d = \gcd(a, n)$。由于 $d \mid b$，我们可以将原方程两边以及模数同时除以 $d$ 吗？不完全是。正确的做法是利用**[扩展欧几里得算法](@entry_id:153449)**。该算法可以找到整数 $x'$ 和 $y'$ 使得 $ax' + ny' = d$。由于 $d \mid b$，设 $b = k d$。那么，将贝祖等式两边乘以 $k$，我们得到 $a(x'k) + n(y'k) = kd = b$。这表明 $a(x'k) \equiv b \pmod{n}$。因此，一个[特解](@entry_id:149080)是 $x_p = x'k = x'(b/d)$。

**示例：** 求解 $518x \equiv 1722 \pmod{4620}$ [@problem_id:3017087]。
首先，使用[欧几里得算法](@entry_id:138330)计算 $\gcd(518, 4620) = 14$。
其次，检验可解性条件：$14 \mid 1722$吗？$1722 \div 14 = 123$，整除。所以方程有解。
然后，使用[扩展欧几里得算法](@entry_id:153449)找到 $518x' + 4620y' = 14$ 的解。逆向[回代](@entry_id:146909)可得 $518(-107) + 4620(12) = 14$。
一个[特解](@entry_id:149080)是 $x_p = (-107) \times (1722/14) = -107 \times 123 = -13161$。

接下来，我们需要确定解的个数和通解形式。如果 $x_p$ 是一个[特解](@entry_id:149080)，那么所有其他解 $x$ 满足 $ax \equiv ax_p \pmod{n}$，即 $n \mid a(x-x_p)$。这等价于 $\frac{n}{d} \mid \frac{a}{d}(x-x_p)$。由于 $\gcd(a/d, n/d) = 1$，根据[欧几里得引理](@entry_id:261512)，我们必然有 $\frac{n}{d} \mid (x-x_p)$。这意味着所有解构成了模 $\frac{n}{d}$ 的一个[同余类](@entry_id:635978)。通解可以表示为 $x \equiv x_p \pmod{n/d}$。

在模 $n$ 的意义下，这一个[同余类](@entry_id:635978)会给出多少个不同的解呢？解集为 $\{x_p + t \cdot \frac{n}{d} \mid t \in \mathbb{Z}\}$。当 $t$ 取值 $0, 1, \dots, d-1$ 时，我们会得到 $d$ 个模 $n$ 不[同余](@entry_id:143700)的解。因此，当方程可解时，它恰好有 $d = \gcd(a, n)$ 个模 $n$ 不[同余](@entry_id:143700)的解 [@problem_id:3017081]。

**示例（续）：** 对于 $518x \equiv 1722 \pmod{4620}$，我们有 $d=14$ 个解。通解为 $x \equiv -13161 \pmod{4620/14}$，即 $x \equiv -13161 \pmod{330}$。为了找到最小非负解，我们计算 $-13161 \pmod{330}$，得到 $39$。所以最小非负解是 $39$ [@problem_id:3017087]。

这个理论也阐明了模算术中的**消去律** [@problem_id:3017103]。从 $ax \equiv ay \pmod{n}$ 不能直接得到 $x \equiv y \pmod{n}$。正确的形式是：
若 $ax \equiv ay \pmod{n}$ 且 $d=\gcd(a, n)$，则 $x \equiv y \pmod{n/d}$。
仅当 $a$ 与 $n$ [互质](@entry_id:143119)（即 $d=1$）时，我们才能安全地进行消去，得到 $x \equiv y \pmod{n}$。

### [中国剩余定理](@entry_id:144030)

当我们需要同时满足多个[线性同余](@entry_id:150485)方程时，问题就升级为一个[同余方程组](@entry_id:154048)。中国剩余定理（CRT）是解决此类问题的基石。

#### 经典形式：[互质模数](@entry_id:274776)

假设我们有一个[方程组](@entry_id:193238)：
$$
\begin{cases}
    x \equiv r_1 \pmod{n_1} \\
    x \equiv r_2 \pmod{n_2} \\
    \vdots \\
    x \equiv r_k \pmod{n_k}
\end{cases}
$$
其中模数 $n_1, n_2, \dots, n_k$ 是**[两两互质](@entry_id:154147)**的正整数。CRT断言，这个[方程组](@entry_id:193238)在模 $N = n_1n_2\cdots n_k$ 的意义下有**唯一解**。

**存在性与[构造性证明](@entry_id:157587)**是该定理的核心 [@problem_id:3017097]。对于每个 $i \in \{1, \dots, k\}$，我们定义 $N_i = N/n_i$。由于 $n_j$ [两两互质](@entry_id:154147)，我们有 $\gcd(N_i, n_i) = 1$。因此，$N_i$ 存在一个模 $n_i$ 的乘法逆元，我们记作 $y_i$，即 $N_i y_i \equiv 1 \pmod{n_i}$。

现在构造一个解：
$$ x = \sum_{i=1}^{k} r_i N_i y_i $$
让我们验证这个 $x$ 是否满足第 $j$ 个方程。当我们对 $x$ 取模 $n_j$ 时，注意到对于所有 $i \neq j$，$n_j$ 是 $N_i$ 的一个因子，所以 $N_i \equiv 0 \pmod{n_j}$。因此，求和式中除了第 $j$ 项之外的所有项都消失了：
$$ x \equiv r_j N_j y_j \pmod{n_j} $$
根据 $y_j$ 的定义， $N_j y_j \equiv 1 \pmod{n_j}$，所以上式简化为：
$$ x \equiv r_j \cdot 1 \equiv r_j \pmod{n_j} $$
这表明我们构造的 $x$ 确实是[方程组](@entry_id:193238)的一个解。

**唯一性**则源于：若 $x$ 和 $x'$ 都是解，则对每个 $i$ 都有 $x \equiv x' \pmod{n_i}$，即 $n_i \mid (x-x')$。由于 $n_i$ [两两互质](@entry_id:154147)，它们的乘积 $N$ 也必然整除 $x-x'$。因此 $x \equiv x' \pmod{N}$。

**示例：** [求解方程组](@entry_id:152624) $x \equiv 17 \pmod{29}, x \equiv 12 \pmod{31}, x \equiv 25 \pmod{37}, x \equiv 9 \pmod{43}$ [@problem_id:3017097]。
这里 $n_1=29, n_2=31, n_3=37, n_4=43$。$N = 1430309$。
$N_1 = 49321$, $N_2 = 46139$, $N_3 = 38657$, $N_4 = 33263$。
分别计算[逆元](@entry_id:140790)：$y_1 \equiv 49321^{-1} \equiv 18 \pmod{29}$， $y_2 \equiv 17 \pmod{31}$， $y_3 \equiv 23 \pmod{37}$， $y_4 \equiv 9 \pmod{43}$。
解为 $x \equiv 17 \cdot 49321 \cdot 18 + 12 \cdot 46139 \cdot 17 + 25 \cdot 38657 \cdot 23 + 9 \cdot 33263 \cdot 9 \pmod{1430309}$。
计算可得 $x \equiv 49426660 \pmod{1430309}$，最小非负解为 $796154$。

#### 结构性启示

CRT 的意义远不止于一个计算工具。它揭示了环 $\mathbb{Z}/n\mathbb{Z}$ 的深层结构。当 $n = n_1n_2\cdots n_k$ 且 $n_i$ [两两互质](@entry_id:154147)时，CRT 实际上建立了一个**[环同构](@entry_id:147982)** [@problem_id:3017092] [@problem_id:3017098]：
$$ \phi: \mathbb{Z}/n\mathbb{Z} \to \mathbb{Z}/n_1\mathbb{Z} \times \mathbb{Z}/n_2\mathbb{Z} \times \cdots \times \mathbb{Z}/n_k\mathbb{Z} $$
$$ [x]_n \mapsto ([x]_{n_1}, [x]_{n_2}, \dots, [x]_{n_k}) $$
这个映射将模 $n$ 的算术问题分解为在更小的、互不相关的模 $n_i$ 环上的一系列独立问题。

这个同构也诱导了[单位群](@entry_id:184012)的同构：
$$ (\mathbb{Z}/n\mathbb{Z})^\times \cong (\mathbb{Z}/n_1\mathbb{Z})^\times \times \cdots \times (\mathbb{Z}/n_k\mathbb{Z})^\times $$
这意味着，一个数 $x$ 与 $n$ [互质](@entry_id:143119)，当且仅当它与每一个因子 $n_i$ 都[互质](@entry_id:143119) [@problem_id:3017098]。这也解释了为何[欧拉函数](@entry_id:634684) $\varphi(n)$ 在参数[互质](@entry_id:143119)时是[积性函数](@entry_id:168587)：$\varphi(n) = \prod \varphi(n_i)$。

在此同构框架下，我们可以定义一组非常特殊的元素——**正交[幂等元](@entry_id:153117)** [@problem_id:3017084]。对于每个 $i \in \{1, \dots, k\}$，考虑笛卡尔积环中的元素 $(0, \dots, 1, \dots, 0)$（第 $i$ 个分量为 1，其余为 0）。根据 CRT，存在唯一的 $e_i \in \mathbb{Z}/n\mathbb{Z}$，它在同构映射下的像就是这个元组。换言之，$e_i$ 满足：
$$ e_i \equiv 1 \pmod{n_i} \quad \text{且对所有 } j \neq i \text{ 有 } e_i \equiv 0 \pmod{n_j} $$
这些元素具有以下优美的性质：
1.  **[幂等性](@entry_id:190768) (Idempotent)**: $e_i^2 \equiv e_i \pmod{n}$。
2.  **正交性 (Orthogonal)**: $e_i e_j \equiv 0 \pmod{n}$ 对于 $i \neq j$。
3.  **[单位分解](@entry_id:150115) (Resolution of unity)**: $\sum_{i=1}^{k} e_i \equiv 1 \pmod{n}$。

使用我们之前构造 CRT 解的思路，可以得到 $e_i$ 的显式表达式：$e_i = N_i y_i$，其中 $N_i = n/n_i$ 且 $y_i \equiv N_i^{-1} \pmod{n_i}$。

**示例：** 对于 $n=12=4 \cdot 3$ [@problem_id:3017084]。
$n_1=4, n_2=3$。
$e_1$ 满足 $e_1 \equiv 1 \pmod 4$ 和 $e_1 \equiv 0 \pmod 3$。构造：$N_1=12/4=3$，$3^{-1} \equiv 3 \pmod 4$。所以 $e_1 = 3 \cdot 3 = 9$。
$e_2$ 满足 $e_2 \equiv 1 \pmod 3$ 和 $e_2 \equiv 0 \pmod 4$。构造：$N_2=12/3=4$，$4^{-1} \equiv 1 \pmod 3$。所以 $e_2 = 4 \cdot 1 = 4$。
我们得到[幂等元](@entry_id:153117)对 $(9, 4)$。可以验证：$9^2 = 81 \equiv 9 \pmod{12}$，$4^2 = 16 \equiv 4 \pmod{12}$，$9 \cdot 4 = 36 \equiv 0 \pmod{12}$，$9+4=13 \equiv 1 \pmod{12}$。

### 一般线性[同余[方程](@entry_id:154048)组](@entry_id:193238)

现在我们考虑最一般的情形：一个[方程组](@entry_id:193238) $a_i x \equiv b_i \pmod{n_i}$，其中模数 $n_i$ 不一定[两两互质](@entry_id:154147)。

#### $\mathbb{Z}/p^e\mathbb{Z}$ 的结构

根据 CRT 的[环同构](@entry_id:147982)，任何关于模 $n$ 的问题都可以分解为关于其素数幂因子 $p^e$ 的问题。因此，理解环 $\mathbb{Z}/p^e\mathbb{Z}$ ($e \ge 2$) 的结构至关重要 [@problem_id:3017081]。

在这个环中，元素可以分为两类：
- **单位**: 那些与 $p^e$ [互质](@entry_id:143119)的数，即不被 $p$ 整除的数。它们有乘法逆元。
- **非单位**: 那些被 $p$ 整除的数。它们都是[零因子](@entry_id:151051)。更有趣的是，它们都是**[幂零元](@entry_id:152299)**。一个元素 $[a]$ 是幂零的，如果存在正整数 $k$ 使得 $[a]^k = [0]$。若 $p \mid a$，则 $a=p a'$，那么 $a^e = p^e (a')^e \equiv 0 \pmod{p^e}$，所以 $[a]$ 是幂零的 [@problem_id:3017092]。

在 $\mathbb{Z}/p^e\mathbb{Z}$ 中求解 $ax \equiv b \pmod{p^e}$，其可解性可以用 **$p$-adic 赋值** $v_p(\cdot)$ 来简洁地描述。$v_p(m)$ 是指素数 $p$ 在 $m$ 的素数分解中出现的次数。
方程 $ax \equiv b \pmod{p^e}$ 有解当且仅当 $v_p(\gcd(a, p^e)) \le v_p(b)$。注意到 $\gcd(a, p^e) = p^{\min(v_p(a), e)}$，所以条件等价于 $\min(v_p(a), e) \le v_p(b)$。当解存在时，解的个数为 $\gcd(a, p^e) = p^{\min(v_p(a), e)}$。
这与 $n$ 是素数（即 $e=1$，域的情形）的巨大差异形成了对比。在域中，若 $a \not\equiv 0$，总有唯一解；若 $a \equiv 0$，则要么无解（若 $b \not\equiv 0$），要么所有元素都是解（若 $b \equiv 0$）。但在 $\mathbb{Z}/p^e\mathbb{Z}$ 中，由于[幂零元](@entry_id:152299)的存在，解的数量可以是介于 $1$ 和 $p^e$ 之间的 $p$ 的幂 [@problem_id:3017081]。

#### 非[互质模数](@entry_id:274776)系统

考虑系统 $x \equiv r_i \pmod{n_i}$，其中 $n_i$ 不一定互质。
一个解 $x$ 必须同时满足 $x \equiv r_i \pmod{n_i}$ 和 $x \equiv r_j \pmod{n_j}$。这意味着 $x-r_i$ 是 $n_i$ 的倍数， $x-r_j$ 是 $n_j$ 的倍数。因此，它们的差 $(x-r_j)-(x-r_i) = r_i-r_j$ 必须是 $\gcd(n_i, n_j)$ 的倍数。
所以，一个**必要条件**是 $r_i \equiv r_j \pmod{\gcd(n_i, n_j)}$ 对所有 $i \neq j$ 成立。可以证明这个**成对相容性条件**也是**充分的** [@problem_id:3017100]。
当[方程组](@entry_id:193238)可解时，其解在模 $\operatorname{lcm}(n_1, \dots, n_k)$ 的意义下是唯一的。
求解方法通常是**[迭代法](@entry_id:194857)**：先解前两个方程得到一个等价的新方程，其模数为 $\operatorname{lcm}(n_1, n_2)$，然后用这个新方程与第三个方程配对，以此类推。

**示例：** 求解 $x \equiv 35 \pmod{84}, x \equiv 77 \pmod{126}, x \equiv 149 \pmod{198}$ [@problem_id:3017100]。
首先检验相容性：
- $\gcd(84, 126)=42$，$35 \equiv 77 \pmod{42}$ (因为 $77-35=42$)
- $\gcd(84, 198)=6$，$35 \equiv 5 \pmod 6$, $149 \equiv 5 \pmod 6$
- $\gcd(126, 198)=18$，$77 \equiv 5 \pmod{18}$, $149 \equiv 5 \pmod{18}$
所有条件满足，系统有解。
迭代求解：$x = 35 + 84k_1 \implies 35+84k_1 \equiv 77 \pmod{126} \implies 84k_1 \equiv 42 \pmod{126}$。
两边和模数同除以 $\gcd(84, 126)=42$，得 $2k_1 \equiv 1 \pmod 3$，解得 $k_1 \equiv 2 \pmod 3$。
代回得 $x = 35 + 84(2+3j) = 203 + 252j$，即 $x \equiv 203 \pmod{252}$。
再与第三个方程联立：$x \equiv 149 \pmod{198}$。解得 $x \equiv 2723 \pmod{2772}$。最小非负解为 $2723$。

最后，对于最一般的系统 $a_i x \equiv b_i \pmod{n_i}$ [@problem_id:3017083]，求解过程分两步：
1.  **化简**: 对每个 $i$，求解单个方程 $a_i x \equiv b_i \pmod{n_i}$。这要求 $\gcd(a_i, n_i) \mid b_i$。若满足，该方程等价于 $x \equiv c_i \pmod{n_i'}$，其中 $n_i' = n_i/\gcd(a_i, n_i)$。
2.  **求解新系统**: 求解化简后的系统 $x \equiv c_i \pmod{n_i'}$。这要求满足成对相容性条件 $c_i \equiv c_j \pmod{\gcd(n_i', n_j')}$。

这两个条件合在一起，构成了最一般线性[同余[方程](@entry_id:154048)组](@entry_id:193238)可解的充要条件。

### 算法考量与复杂度

从理论转向实践，求解 CRT 问题的计算效率是一个重要课题，尤其是在密码学和计算机代数中，模数数量 $k$ 和它们的位长 $B$ 可能很大。

我们主要比较两种算法 [@problem_id:3017088]：
1.  **混合[基数表示法](@entry_id:636584) (Garner's Algorithm)**: 这是一种迭代算法，它将解 $x$ 表示为 $x = v_1 + v_2 n_1 + v_3 n_1 n_2 + \cdots$ 的形式，然后逐个计算系数 $v_i$。该方法概念简单，但对于大量的模数，其计算成本较高。如果需要预计算所有成对的[模逆元](@entry_id:149786) $n_i^{-1} \pmod{n_j}$，时间和[空间复杂度](@entry_id:136795)都会达到 $\Theta(k^2)$ 的级别。具体来说，预计算需要 $\Theta(k^2 M(B)\log B)$ 时间和 $\Theta(k^2 B)$ 存储空间，其中 $M(L)$ 是 $L$ 位整数乘法的复杂度。

2.  **基于树的快速算法**: 这种方法利用了分治策略。它首先通过一个**乘积树**自底向上计算出所有模数的[子集](@entry_id:261956)乘积，最终得到根节点的 $N$。然后通过一个**剩[余树](@entry_id:266671)**自顶向下进行多点求值，高效地计算出 CRT 公式中需要的各项。这种方法利用了快速多项式算术（如 FFT），总时间复杂度可以达到 $O(M(kB)\log k)$。对于使用[准线性](@entry_id:637689)时间乘法（如 [Schönhage-Strassen](@entry_id:637082) 算法，$M(L) \approx L\log L \log\log L$）的情况，当 $k$ 很大时，这种方法在时间上远优于朴素的 Garner 算法。其工作内存需求也可以优化到 $O(kB)$。

**结论**：对于模数数量 $k$ 较大的情况，基于树的快速 CRT 算法在渐进意义上具有显著的速度和空间优势。而混合[基数](@entry_id:754020)法因其实现相对简单，在 $k$ 较小或模数固定的重复计算场景下仍有其价值。