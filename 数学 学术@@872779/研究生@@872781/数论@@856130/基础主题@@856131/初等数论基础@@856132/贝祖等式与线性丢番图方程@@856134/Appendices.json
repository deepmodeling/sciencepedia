{"hands_on_practices": [{"introduction": "理论联系实际是掌握丢番图方程的关键。这个练习将带你超越寻找任意整数解的范畴，专注于满足实际约束（如非负性）的解。我们将把方程 $5x+7y=100$ 的求解过程，看作是在第一象限中寻找一条线段上的整数点，这不仅能让你掌握求解技巧，还能让你对解的结构有更直观的几何理解。[@problem_id:3009031]", "problem": "设 $a$ 和 $b$ 为互质正整数；即，它们的最大公约数 (gcd) 满足 $\\gcd(a,b)=1$。根据贝祖等式 (Bézout’s identity)，存在整数 $u$ 和 $v$ 使得 $au+bv=1$。仅使用以下基本事实来分析方程 $5x+7y=100$：线性丢番图方程 $au+bv=c$ 的整数解集非空当且仅当 $\\gcd(a,b)$ 整除 $c$；且当解集非空时，它构成由从贝祖对获得的方向向量生成的一维整格的仿射平移。\n\n具体而言，通过明确描述解格并考察其与第一象限中连接 $(0,100/7)$ 和 $(20,0)$ 的线段的交集，确定满足 $5x+7y=100$ 且 $x\\geq 0$ 和 $y\\geq 0$ 的整数组 $(x,y)\\in\\mathbb{Z}^{2}$ 的数量。你的最终答案必须是此类非负整数解的数量。", "solution": "题目陈述已经过验证，被认为是合理的。这是一个初等数论中的良构问题，没有科学或逻辑上的缺陷，并且提供了所有必要的信息。\n\n我们的任务是求线性丢番图方程\n$$5x + 7y = 100$$\n在 $x \\ge 0$ 和 $y \\ge 0$ 条件下的非负整数解 $(x, y)$ 的数量。\n\n首先，我们必须确认整数解是存在的。根据线性丢番图方程的性质，形如 $ax+by=c$ 的方程有整数解，当且仅当系数的最大公约数 $\\gcd(a,b)$ 能整除常数项 $c$。在本例中，$a=5$，$b=7$，$c=100$。最大公约数为 $\\gcd(5, 7)=1$。因为 $1$ 能整除任何整数，所以它当然能整除 $100$。因此，整数解存在。\n\n下一步是求方程的一个特解 $(x_0, y_0)$。我们首先求相关贝祖等式 $5u + 7v = 1$ 的一个特解 $(u_0, v_0)$。这可以通过使用扩展欧几里得算法或通过观察法完成。通过观察，我们可以看到\n$$5(3) + 7(-2) = 15 - 14 = 1$$\n所以，$5u+7v=1$ 的一个特解是 $(u_0, v_0) = (3, -2)$。\n\n为了求得原方程 $5x+7y=100$ 的一个特解，我们可以将等式 $5(3) + 7(-2) = 1$ 两边乘以 $100$：\n$$100 \\times (5(3) + 7(-2)) = 100 \\times 1$$\n$$5(3 \\times 100) + 7(-2 \\times 100) = 100$$\n$$5(300) + 7(-200) = 100$$\n这给了我们一个特解 $(x_0, y_0) = (300, -200)$。\n\n题目要求我们描述整个整数解格的特征。对于 $ax+by=c$，其通解由以下公式给出\n$$x = x_0 + k \\frac{b}{\\gcd(a,b)}$$\n$$y = y_0 - k \\frac{a}{\\gcd(a,b)}$$\n其中 $k$ 是任意整数。\n对于我们的方程，$a=5$，$b=7$，$\\gcd(5,7)=1$，以及 $(x_0, y_0) = (300, -200)$，通解为：\n$$x(k) = 300 + 7k$$\n$$y(k) = -200 - 5k$$\n对任意整数 $k \\in \\mathbb{Z}$。这组点 $(x(k), y(k))$ 构成了我们所求的一维整数解格。\n\n我们必须找到满足非负约束条件 $x \\ge 0$ 和 $y \\ge 0$ 的解的数量。这些约束定义了题目陈述中提到的第一象限内的线段，其端点为 $(0, 100/7)$ 和 $(20, 0)$。我们将这些约束应用于我们的通解：\n\n1.  约束条件 $x \\ge 0$ 意味着：\n    $$300 + 7k \\ge 0$$\n    $$7k \\ge -300$$\n    $$k \\ge -\\frac{300}{7}$$\n    由于 $300/7 \\approx 42.857$，且 $k$ 必须是整数，该不等式变为 $k \\ge -42$。\n\n2.  约束条件 $y \\ge 0$ 意味着：\n    $$-200 - 5k \\ge 0$$\n    $$-200 \\ge 5k$$\n    $$k \\le -40$$\n\n对整数 $k$ 合并这两个不等式，我们得到 $-42 \\le k \\le -40$。满足这个条件的整数 $k$ 是 $-42$、$-41$ 和 $-40$。\n\n恰好有三个这样的整数值 $k$。每个 $k$ 值都对应一个唯一的非负整数解 $(x,y)$。因此，解的数量就是 $k$ 的可能值的数量，即 $3$。\n\n这三个解是：\n\\begin{itemize}\n    \\item 对于 $k=-42$：$x = 300 + 7(-42) = 300 - 294 = 6$，$y = -200 - 5(-42) = -200 + 210 = 10$。解为：$(6,10)$。\n    \\item 对于 $k=-41$：$x = 300 + 7(-41) = 300 - 287 = 13$，$y = -200 - 5(-41) = -200 + 205 = 5$。解为：$(13,5)$。\n    \\item 对于 $k=-40$：$x = 300 + 7(-40) = 300 - 280 = 20$，$y = -200 - 5(-40) = -200 + 200 = 0$。解为：$(20,0)$。\n\\end{itemize}\n这三个整点是解格中位于第一象限指定线段上的点。这样的数对 $(x,y)$ 的数量是 $3$。", "answer": "$$\\boxed{3}$$", "id": "3009031"}, {"introduction": "贝祖等式最强大的应用之一是在模算术领域，特别是在求解模乘法逆元时。这个概念是现代密码学（如RSA算法）和编码理论的基石。本练习将向你展示如何将一个模同余式 $97x \\equiv 1 \\pmod{256}$ 转化为一个线性丢番图方程并求解，从而揭示抽象理论与具体应用之间的深刻联系。[@problem_id:3009032]", "problem": "考虑整数模 $256$ 的环。仅使用最大公约数（Greatest Common Divisor, gcd）的定义、贝祖等式（Bézout identity）和构造性扩展欧几里得算法，确定满足 $97x \\equiv 1 \\pmod{256}$ 的最小非负整数 $x$。通过推导 $97$ 和 $256$ 的贝祖系数来证明此 $x$ 的存在性，通过扩展欧几里得算法从这些系数中显式计算出 $x$，然后基于整除性和最大公约数，通过第一性原理论证来验证解类在模 $256$ 下是唯一的。你的最终答案必须是最小的非负代表元 $x$。无需四舍五入。", "solution": "给定的问题是确定满足线性同余方程 $97x \\equiv 1 \\pmod{256}$ 的最小非负整数 $x$。求解过程必须证明此 $x$ 的存在性，使用扩展欧几里得算法显式计算它，并验证解类在模 $256$ 下的唯一性。\n\n首先，我们建立给定的同余方程与线性丢番图方程之间的关系。根据定义，同余方程 $97x \\equiv 1 \\pmod{256}$ 等价于 $256$ 整除 $97x - 1$。这意味着存在一个整数，我们称之为 $y'$，使得 $97x - 1 = 256y'$。整理这个方程得到 $97x - 256y' = 1$。令 $y = -y'$，我们可以将其表示为线性丢番图方程的标准形式：\n$$97x + 256y = 1$$\n因此，求解同余方程等价于找到该方程的一个整数解 $(x, y)$。\n\n形式为 $ax + by = c$ 的方程是否存在整数解，由贝祖等式（Bézout's identity）决定。该等式指出，这样的方程有整数解 $x$ 和 $y$ 的充要条件是 $a$ 和 $b$ 的最大公约数（记为 $\\gcd(a, b)$）是 $c$ 的一个因子。在我们的例子中，$a=97$，$b=256$，$c=1$。因此，解存在的充要条件是 $\\gcd(97, 256)$ 整除 $1$。因为 $\\gcd(97, 256)$ 必须是一个正整数，所以这个条件等价于 $\\gcd(97, 256) = 1$。\n\n我们使用欧几里得算法来计算 $97$ 和 $256$ 的最大公约数。\n$$256 = 2 \\cdot 97 + 62$$\n$$97 = 1 \\cdot 62 + 35$$\n$$62 = 1 \\cdot 35 + 27$$\n$$35 = 1 \\cdot 27 + 8$$\n$$27 = 3 \\cdot 8 + 3$$\n$$8 = 2 \\cdot 3 + 2$$\n$$3 = 1 \\cdot 2 + 1$$\n$$2 = 2 \\cdot 1 + 0$$\n序列中最后一个非零余数是 $1$。因此，我们确切地证明了 $\\gcd(97, 256) = 1$。根据贝祖等式，这保证了存在整数 $x$ 和 $y$ 满足 $97x + 256y = 1$。将此方程模 $256$ 得到 $97x \\equiv 1 \\pmod{256}$，这证实了模逆元 $x$ 的存在性。\n\n接下来，我们采用构造性扩展欧几里得算法来寻找 $x$ 的一个特解。这是通过回顾欧几里得算法的步骤，将最大公约数 $1$ 表示为 $97$ 和 $256$ 的线性组合来实现的。\n\n从算法的倒数第二步，我们有 $1 = 3 - 1 \\cdot 2$。\n我们将前一步的余数 $2 = 8 - 2 \\cdot 3$ 代入这个表达式中：\n$$1 = 3 - 1 \\cdot (8 - 2 \\cdot 3) = 3 - 8 + 2 \\cdot 3 = 3 \\cdot 3 - 1 \\cdot 8$$\n接下来，我们代入 $3 = 27 - 3 \\cdot 8$：\n$$1 = 3 \\cdot (27 - 3 \\cdot 8) - 1 \\cdot 8 = 3 \\cdot 27 - 9 \\cdot 8 - 1 \\cdot 8 = 3 \\cdot 27 - 10 \\cdot 8$$\n接下来，我们代入 $8 = 35 - 1 \\cdot 27$：\n$$1 = 3 \\cdot 27 - 10 \\cdot (35 - 1 \\cdot 27) = 3 \\cdot 27 - 10 \\cdot 35 + 10 \\cdot 27 = 13 \\cdot 27 - 10 \\cdot 35$$\n接下来，我们代入 $27 = 62 - 1 \\cdot 35$：\n$$1 = 13 \\cdot (62 - 1 \\cdot 35) - 10 \\cdot 35 = 13 \\cdot 62 - 13 \\cdot 35 - 10 \\cdot 35 = 13 \\cdot 62 - 23 \\cdot 35$$\n接下来，我们代入 $35 = 97 - 1 \\cdot 62$：\n$$1 = 13 \\cdot 62 - 23 \\cdot (97 - 1 \\cdot 62) = 13 \\cdot 62 - 23 \\cdot 97 + 23 \\cdot 62 = 36 \\cdot 62 - 23 \\cdot 97$$\n最后，我们代入 $62 = 256 - 2 \\cdot 97$：\n$$1 = 36 \\cdot (256 - 2 \\cdot 97) - 23 \\cdot 97 = 36 \\cdot 256 - 72 \\cdot 97 - 23 \\cdot 97$$\n这可以简化为所需的形式：\n$$1 = 36 \\cdot 256 - 95 \\cdot 97$$\n重新整理以匹配 $97x + 256y = 1$ 的形式，我们得到：\n$$97(-95) + 256(36) = 1$$\n从这个方程中，我们确定 $x$ 的一个特解为 $x_0 = -95$。这个值满足同余方程 $97 \\cdot (-95) \\equiv 1 \\pmod{256}$。问题要求最小的非负整数 $x$。我们通过计算 $x_0$ 模 $256$ 的值来找到它：\n$$x \\equiv -95 \\pmod{256}$$\n$$x \\equiv -95 + 256 \\pmod{256}$$\n$$x \\equiv 161 \\pmod{256}$$\n因此，最小的非负整数解是 $x = 161$。\n\n最后，我们必须为解类在模 $256$ 下的唯一性提供一个第一性原理的论证。我们假设 $x_1$ 和 $x_2$ 都是该同余方程的整数解。\n$$97x_1 \\equiv 1 \\pmod{256}$$\n$$97x_2 \\equiv 1 \\pmod{256}$$\n根据自反性，$1 \\equiv 97x_2 \\pmod{256}$。根据传递性，我们有 $97x_1 \\equiv 97x_2 \\pmod{256}$。\n从两边减去 $97x_2$ 得到：\n$$97x_1 - 97x_2 \\equiv 0 \\pmod{256}$$\n$$97(x_1 - x_2) \\equiv 0 \\pmod{256}$$\n根据模同余的定义，这意味着 $256$ 整除乘积 $97(x_1 - x_2)$，我们记作 $256 | 97(x_1 - x_2)$。\n我们已经确定 $\\gcd(97, 256) = 1$。数论中的一个基本引理（贝祖等式的一个推论，常被称为欧几里得引理）指出，如果一个整数 $n$ 整除乘积 $ab$ 并且与 $a$ 互质（即 $\\gcd(n, a) = 1$），那么 $n$ 必须整除 $b$。在我们的情况下，$n=256$，$a=97$，$b=(x_1 - x_2)$。\n因为 $256 | 97(x_1 - x_2)$ 且 $\\gcd(256, 97) = 1$，我们必须得出结论 $256 | (x_1 - x_2)$。\n根据定义，这个整除条件等价于 $x_1 \\equiv x_2 \\pmod{256}$。\n这证明了原同余方程的任意两个解在模 $256$ 下必定是同余的。因此，虽然存在无限多个整数解，但它们都属于模 $256$ 下的同一个、唯一的同余类。这个类的最小非负代表元是在整数模 $256$ 环中的唯一解，也就是我们找到的值 $x=161$。\n我们可以验证这个结果：$97 \\times 161 = 15617$。除以 $256$，我们发现 $15617 = 61 \\times 256 + 1$，这证实了 $97 \\times 161 \\equiv 1 \\pmod{256}$。", "answer": "$$\\boxed{161}$$", "id": "3009032"}, {"introduction": "掌握了求解方法及其应用之后，我们可以进一步探索解集的几何结构。一个线性丢番图方程的所有整数解在坐标平面上构成一个无限的点阵。本练习将挑战你从这个点阵中找出离原点最近的那个解，即最小化其欧几里得范数 $\\sqrt{x^2+y^2}$。[@problem_id:3009026] 这个过程不仅需要扎实的代数技巧，还需要对解的参数化形式进行分析和优化。", "problem": "考虑整数环 $\\mathbb{Z}$ 上的线性丢番图方程 $123x+456y=789$。仅使用最大公约数和贝祖等式（即对于整数 $a,b$，存在整数 $u,v$ 使得 $au+bv=\\gcd(a,b)$）的基本定义，推导出 $ax+by=c$ 可解的充分必要条件，通过明确计算 $d=\\gcd(123,456)$ 将其应用于本例，然后给出所有整数解的完整参数化表示。在所有整数解中，确定具有最小欧几里得长度的解，并报告此最小欧几里得范数的精确值。以精确形式表示最终答案，不要四舍五入。", "solution": "该问题要求分析并求解线性丢番图方程 $123x+456y=789$。这包括几个步骤：推导可解性的一般条件，将其应用于具体方程，找到所有整数解的完整集合，最后确定具有最小欧几里得范数的解。\n\n首先，我们推导一般线性丢番图方程 $ax+by=c$（其中 $a, b, c$ 为整数，我们寻求整数解 $(x, y)$）可解的充分必要条件。\n令 $d = \\gcd(a, b)$。根据最大公约数的定义，$d$ 整除 $a$ 和 $b$。因此，对于某些整数 $a'$ 和 $b'$，我们可以写成 $a = da'$ 和 $b = db'$。\n将这些代入方程得到 $da'x + db'y = c$，可以因式分解为 $d(a'x + b'y) = c$。\n由于 $a', b', x, y$ 都是整数，项 $(a'x + b'y)$ 是一个整数。为使等式成立，$d$ 必须整除 $c$。这证明了条件 $d|c$（即 $\\gcd(a, b)$ 整除 $c$）是存在整数解的**必要**条件。\n\n为了证明充分性，假设 $d|c$。那么存在一个整数 $c'$ 使得 $c = dc'$。\n根据贝祖等式（最大公约数的一个基本性质），存在整数 $u$ 和 $v$ 使得 $au + bv = d$。\n将此等式两边乘以 $c'$ 得到 $(au + bv)c' = dc'$。\n这可以改写为 $a(uc') + b(vc') = dc'$。由于 $dc' = c$，我们有 $a(uc') + b(vc') = c$。\n于是我们可以确定一个特整数解 $(x_0, y_0)$ 为 $x_0 = uc'$ 和 $y_0 = vc'$。由于 $u, v, c'$ 是整数，所以 $x_0$ 和 $y_0$ 也是整数。至少存在一个整数解证明了条件 $d|c$ 是**充分**的。\n因此，方程 $ax+by=c$ 有整数解当且仅当 $\\gcd(a, b)$ 整除 $c$。\n\n现在，我们将此条件应用于给定的方程：$123x + 456y = 789$。\n此处，$a=123$，$b=456$。我们使用欧几里得算法计算 $d = \\gcd(123, 456)$：\n$$456 = 3 \\cdot 123 + 87$$\n$$123 = 1 \\cdot 87 + 36$$\n$$87 = 2 \\cdot 36 + 15$$\n$$36 = 2 \\cdot 15 + 6$$\n$$15 = 2 \\cdot 6 + 3$$\n$$6 = 2 \\cdot 3 + 0$$\n最后一个非零余数是 $3$，所以 $d = \\gcd(123, 456) = 3$。\n我们必须检查 $d$ 是否整除 $c=789$。我们计算除法：$789 \\div 3 = 263$。由于结果是整数，所以 $3$ 整除 $789$。可解性条件得到满足，整数解存在。\n\n为了求通解，我们首先将方程的所有项都除以 $d=3$ 来简化方程：\n$(123/3)x + (456/3)y = 789/3$，得到 $41x + 152y = 263$。\n令 $a' = 41$ 和 $b' = 152$。我们需要找到这个简化方程的一个特解 $(x_0, y_0)$。我们可以通过回溯求 GCD 的步骤来使用扩展欧几里得算法。直接对 $a'$ 和 $b'$ 应用该算法更为方便。\n$$152 = 3 \\cdot 41 + 29$$\n$$41 = 1 \\cdot 29 + 12$$\n$$29 = 2 \\cdot 12 + 5$$\n$$12 = 2 \\cdot 5 + 2$$\n$$5 = 2 \\cdot 2 + 1$$\n回溯将 $1 = \\gcd(41, 152)$ 表示为 $41$ 和 $152$ 的线性组合：\n$$1 = 5 - 2 \\cdot 2$$\n$$1 = 5 - 2 \\cdot (12 - 2 \\cdot 5) = 5 \\cdot 5 - 2 \\cdot 12$$\n$$1 = 5 \\cdot (29 - 2 \\cdot 12) - 2 \\cdot 12 = 5 \\cdot 29 - 12 \\cdot 12$$\n$$1 = 5 \\cdot 29 - 12 \\cdot (41 - 1 \\cdot 29) = 17 \\cdot 29 - 12 \\cdot 41$$\n$$1 = 17 \\cdot (152 - 3 \\cdot 41) - 12 \\cdot 41 = 17 \\cdot 152 - 51 \\cdot 41 - 12 \\cdot 41$$\n$$1 = (-63) \\cdot 41 + 17 \\cdot 152$$\n所以，对于方程 $41u + 152v = 1$，一个特解是 $(u, v) = (-63, 17)$。\n我们的目标方程是 $41x + 152y = 263$。我们将等式两边乘以 $263$：\n$$263 \\cdot ((-63) \\cdot 41 + 17 \\cdot 152) = 263 \\cdot 1$$\n$$41 \\cdot (-63 \\cdot 263) + 152 \\cdot (17 \\cdot 263) = 263$$\n因此，一个特解 $(x_0, y_0)$ 是：\n$x_0 = -63 \\cdot 263 = -16569$\n$y_0 = 17 \\cdot 263 = 4471$\n\n为了找到所有解的完整参数化表示，设 $(x, y)$ 为任意整数解。我们有：\n$41x + 152y = 263$\n$41x_0 + 152y_0 = 263$\n两方程相减得到 $41(x - x_0) + 152(y - y_0) = 0$，即 $41(x - x_0) = -152(y - y_0)$。\n由于 $\\gcd(41, 152) = 1$，根据欧几里得引理，$41$ 必须整除 $(y - y_0)$。所以，对于某个整数 $k$，$y - y_0 = 41k$。将其代回得到 $41(x - x_0) = -152(41k)$，简化为 $x - x_0 = -152k$。\n因此，通解为：\n$x(k) = x_0 - 152k = -16569 - 152k$\n$y(k) = y_0 + 41k = 4471 + 41k$\n其中 $k$ 为任意整数 $k \\in \\mathbb{Z}$。\n\n最后，我们需要找到具有最小欧几里得长度（范数）的解 $(x, y)$，其定义为 $L = \\sqrt{x^2 + y^2}$。最小化 $L$ 等价于最小化其平方 $L^2 = x^2 + y^2$。\n令 $f(k) = L^2 = (x(k))^2 + (y(k))^2 = (-16569 - 152k)^2 + (4471 + 41k)^2$。\n这是一个关于 $k$ 的二次函数，形式为 $f(k) = Ak^2 + Bk + C$，表示一个开口向上的抛物线。对于实数 $k$，其最小值出现在顶点处，$k_{vertex} = -B/(2A)$。对于整数 $k$，最小值将出现在与 $k_{vertex}$ 相邻的两个整数之一。\n为了找到顶点，我们可以对 $k$ 求导并令结果为零：\n$\\frac{df}{dk} = 2(-16569 - 152k)(-152) + 2(4471 + 41k)(41) = 0$\n$16569 \\cdot 152 + 152^2 k + 4471 \\cdot 41 + 41^2 k = 0$\n$k(152^2 + 41^2) = -(16569 \\cdot 152 + 4471 \\cdot 41)$\n$k(23104 + 1681) = -(2518488 + 183311)$\n$k(24785) = -2701799$\n$k_{vertex} = -\\frac{2701799}{24785} \\approx -109.0094$\n与 $k_{vertex}$ 最接近的整数 $k$ 值是 $k = -109$ 和 $k = -110$。对于整数 $k$ 的最小值必须在 $k = -109$ 时取得，因为它更接近顶点。\n我们来求 $k = -109$ 时的解：\n$x = -16569 - 152(-109) = -16569 + 16568 = -1$\n$y = 4471 + 41(-109) = 4471 - 4469 = 2$\n具有最小欧几里得长度的解是 $(-1, 2)$。验算确认它满足原方程：$123(-1) + 456(2) = -123 + 912 = 789$。\n为了完整起见，$k = -110$ 时的解是 $x = -16569 - 152(-110) = 151$ 和 $y = 4471 + 41(-110) = -39$。范数的平方分别为 $L^2_{k=-109} = (-1)^2 + 2^2 = 5$ 和 $L^2_{k=-110} = 151^2 + (-39)^2 = 22801 + 1521 = 24322$。最小值显然在 $k=-109$ 时取得。\n\n最小欧几里得范数是向量 $(-1, 2)$ 的长度：\n$L_{min} = \\sqrt{(-1)^2 + 2^2} = \\sqrt{1 + 4} = \\sqrt{5}$。", "answer": "$$\\boxed{\\sqrt{5}}$$", "id": "3009026"}]}