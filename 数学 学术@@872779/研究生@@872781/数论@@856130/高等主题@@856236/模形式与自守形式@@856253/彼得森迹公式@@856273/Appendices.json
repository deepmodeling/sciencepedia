{"hands_on_practices": [{"introduction": "彼得森迹公式的非对角项由克洛斯特曼和 (Kloosterman sums) 与贝塞尔函数 (Bessel functions) 的乘积之和构成。克洛斯特曼和是其核心的算术部分，其振荡与对消性质至关重要。通过直接计算一些小模数的克洛斯特曼和，我们可以直观地理解这些性质，为理解迹公式的整体结构打下坚实基础 [@problem_id:3028706]。", "problem": "设 $p$ 为素数，$\\alpha \\in \\mathbb{Z}_{\\geq 1}$。对于一个正整数 $c$，出现在 Petersson 迹公式 (PTF) 中的经典克洛斯特曼和 (Kloosterman sum) $S(m,n;c)$ 定义为\n$$\nS(m,n;c) \\;=\\; \\sum_{\\substack{x \\bmod c \\\\ (x,c)=1}} \\exp\\!\\left(2\\pi i \\,\\frac{m x + n \\overline{x}}{c}\\right),\n$$\n其中 $\\overline{x}$ 表示 $x$ 模 $c$ 的乘法逆元。和 $S(m,0;c)$ 与 $S(0,n;c)$ 可化为 Ramanujan 和，这反映了在简化剩余系上的算术相消。从该定义和关于指数和与模逆元的熟知事实出发，计算以下素数幂模和小参数下的具体克洛斯特曼和，以说明其相消现象：\n\n1. $S(1,1;9)$,\n2. $S(1,2;9)$,\n3. $S(3,0;9)$,\n4. $S(9,0;9)$,\n5. $S(1,1;8)$.\n\n请将最终结果表示为精确值，而非数值近似。按顺序将五个答案呈现在单一行向量\n$$\n\\big(S(1,1;9),\\; S(1,2;9),\\; S(3,0;9),\\; S(9,0;9),\\; S(1,1;8)\\big),\n$$\n中，作为最终答案。无需四舍五入，不涉及物理单位。", "solution": "我们从基本定义开始\n$$\nS(m,n;c) \\;=\\; \\sum_{\\substack{x \\bmod c \\\\ (x,c)=1}} \\exp\\!\\left(2\\pi i \\,\\frac{m x + n \\overline{x}}{c}\\right),\n$$\n其中 $\\overline{x}$ 是 $x$ 模 $c$ 的乘法逆元。模 $c$ 的单位群是一个有限阿贝尔群，且映射 $x \\mapsto \\overline{x}$ 是该集合的一个置换。因此，当 $m=0$ 或 $n=0$ 时，指数内的两项中有一项在此置换下是多余的，该和简化为一个 Ramanujan 和\n$$\nc_{c}(t) \\;=\\; \\sum_{\\substack{x \\bmod c \\\\ (x,c)=1}} \\exp\\!\\left(2\\pi i \\,\\frac{t x}{c}\\right).\n$$\n为计算素数幂下的 $c_{p^{\\alpha}}(t)$，我们从第一性原理推导其标准分段公式。写作\n$$\nc_{p^{\\alpha}}(t) \\;=\\; \\sum_{a=0}^{p^{\\alpha}-1} \\exp\\!\\left(2\\pi i \\,\\frac{a t}{p^{\\alpha}}\\right) \\;-\\; \\sum_{b=0}^{p^{\\alpha-1}-1} \\exp\\!\\left(2\\pi i \\,\\frac{p b \\, t}{p^{\\alpha}}\\right)\n\\;=\\; A_{\\alpha}(t) \\;-\\; A_{\\alpha-1}(t),\n$$\n其中\n$$\nA_{\\beta}(t) \\;=\\; \\sum_{u=0}^{p^{\\beta}-1} \\exp\\!\\left(2\\pi i \\,\\frac{u t}{p^{\\beta}}\\right).\n$$\n这是一个熟知的事实（源于初等几何级数），即若 $p^{\\beta} \\mid t$，$A_{\\beta}(t)$ 等于 $p^{\\beta}$，否则等于 $0$。因此，\n- 若 $p^{\\alpha} \\mid t$，则 $A_{\\alpha}(t)=p^{\\alpha}$ 且 $A_{\\alpha-1}(t)=p^{\\alpha-1}$，所以 $c_{p^{\\alpha}}(t)=p^{\\alpha}-p^{\\alpha-1}=\\varphi(p^{\\alpha})$。\n- 若 $p^{\\alpha-1} \\mid t$ 但 $p^{\\alpha} \\nmid t$，则 $A_{\\alpha}(t)=0$ 且 $A_{\\alpha-1}(t)=p^{\\alpha-1}$，所以 $c_{p^{\\alpha}}(t)=-p^{\\alpha-1}$。\n- 若 $p^{\\alpha-1} \\nmid t$，则 $A_{\\alpha}(t)=A_{\\alpha-1}(t)=0$，所以 $c_{p^{\\alpha}}(t)=0$。\n\n我们现在计算每个要求的和。\n\n对于 $c=9$，简化剩余系为 $\\{1,2,4,5,7,8\\}$，其模 9 的逆元为：\n$$\n\\overline{1}=1,\\quad \\overline{2}=5,\\quad \\overline{4}=7,\\quad \\overline{5}=2,\\quad \\overline{7}=4,\\quad \\overline{8}=8.\n$$\n1. 计算 $S(1,1;9)$:\n$$\nS(1,1;9)\n=\\sum_{x \\in \\{1,2,4,5,7,8\\}} \\exp\\!\\left(2\\pi i \\,\\frac{x+\\overline{x}}{9}\\right).\n$$\n我们列出 $x+\\overline{x}$ 模 9 的值：\n$$\n1+1=2,\\quad 2+5=7,\\quad 4+7=11\\equiv 2,\\quad 5+2=7,\\quad 7+4=11\\equiv 2,\\quad 8+8=16\\equiv 7.\n$$\n因此\n$$\nS(1,1;9) \\;=\\; 3\\,\\exp\\!\\left(2\\pi i \\,\\frac{2}{9}\\right) \\;+\\; 3\\,\\exp\\!\\left(2\\pi i \\,\\frac{7}{9}\\right).\n$$\n由于 $\\exp\\!\\left(2\\pi i \\,\\frac{7}{9}\\right)=\\overline{\\exp\\!\\left(2\\pi i \\,\\frac{2}{9}\\right)}$，此式为\n$$\nS(1,1;9) \\;=\\; 3\\left(z+\\overline{z}\\right) \\;=\\; 6\\,\\Re(z),\\quad z=\\exp\\!\\left(2\\pi i \\,\\frac{2}{9}\\right),\n$$\n所以\n$$\nS(1,1;9) \\;=\\; 6 \\cos\\!\\left(\\frac{4\\pi}{9}\\right).\n$$\n\n2. 计算 $S(1,2;9)$:\n$$\nS(1,2;9)\n=\\sum_{x \\in \\{1,2,4,5,7,8\\}} \\exp\\!\\left(2\\pi i \\,\\frac{x+2\\,\\overline{x}}{9}\\right).\n$$\n我们列出 $x+2\\,\\overline{x}$ 模 9 的值：\n$$\n1+2\\cdot 1=3,\\quad 2+2\\cdot 5=12\\equiv 3,\\quad 4+2\\cdot 7=18\\equiv 0,\\quad 5+2\\cdot 2=9\\equiv 0,\\quad 7+2\\cdot 4=15\\equiv 6,\\quad 8+2\\cdot 8=24\\equiv 6.\n$$\n因此\n$$\nS(1,2;9) \\;=\\; 2\\,\\exp\\!\\left(2\\pi i \\,\\frac{3}{9}\\right) \\;+\\; 2 \\cdot 1 \\;+\\; 2\\,\\exp\\!\\left(2\\pi i \\,\\frac{6}{9}\\right).\n$$\n注意到 $\\exp\\!\\left(2\\pi i \\,\\frac{3}{9}\\right)=\\exp\\!\\left(2\\pi i \\,\\frac{1}{3}\\right)$ 和 $\\exp\\!\\left(2\\pi i \\,\\frac{6}{9}\\right)=\\exp\\!\\left(2\\pi i \\,\\frac{2}{3}\\right)$。利用 $\\exp\\!\\left(2\\pi i /3\\right)=-\\frac{1}{2}+i\\frac{\\sqrt{3}}{2}$ 和 $\\exp\\!\\left(2\\pi i \\cdot 2/3\\right)=-\\frac{1}{2}-i\\frac{\\sqrt{3}}{2}$，我们得到\n$$\n2\\exp\\!\\left(\\frac{2\\pi i}{3}\\right) + 2\\exp\\!\\left(\\frac{4\\pi i}{3}\\right) \\;=\\; -2,\n$$\n所以再加上 $2$ 就得到 $0$。因此，\n$$\nS(1,2;9) \\;=\\; 0.\n$$\n\n3. 通过 Ramanujan 和 $c_{9}(3)$ 计算 $S(3,0;9)$。由于 $3$ 可被 $3^{\\alpha-1}=3$ 整除但不能被 $3^{\\alpha}=9$ 整除，分段公式给出：\n$$\nS(3,0;9) \\;=\\; c_{9}(3) \\;=\\; -3.\n$$\n\n4. 通过 $c_9(9)$ 计算 $S(9,0;9)$。由于 $9$ 可被 $9$ 整除，我们有：\n$$\nS(9,0;9) \\;=\\; c_{9}(9) \\;=\\; \\varphi(9) \\;=\\; 6.\n$$\n\n对于 $c=8$，简化剩余系是 $\\{1,3,5,7\\}$，并且每个奇数元素都是它自己模 8 的逆元，即对于 $x \\in \\{1,3,5,7\\}$ 有 $\\overline{x}=x$。\n\n5. 计算 $S(1,1;8)$:\n$$\nS(1,1;8) \\;=\\; \\sum_{x \\in \\{1,3,5,7\\}} \\exp\\!\\left(2\\pi i \\,\\frac{x+\\overline{x}}{8}\\right)\n\\;=\\; \\sum_{x \\in \\{1,3,5,7\\}} \\exp\\!\\left(2\\pi i \\,\\frac{2x}{8}\\right)\n\\;=\\; \\sum_{x \\in \\{1,3,5,7\\}} \\exp\\!\\left(2\\pi i \\,\\frac{x}{4}\\right).\n$$\n逐项求值，\n$$\n\\exp\\!\\left(2\\pi i \\,\\frac{1}{4}\\right)=i,\\quad \\exp\\!\\left(2\\pi i \\,\\frac{3}{4}\\right)=-i,\\quad\n\\exp\\!\\left(2\\pi i \\,\\frac{5}{4}\\right)=i,\\quad \\exp\\!\\left(2\\pi i \\,\\frac{7}{4}\\right)=-i,\n$$\n所以和为 $i+(-i)+i+(-i)=0$。因此，\n$$\nS(1,1;8) \\;=\\; 0.\n$$\n\n按要求的顺序收集这五个计算值，我们得到\n$$\n\\left(6 \\cos\\!\\left(\\frac{4\\pi}{9}\\right),\\; 0,\\; -3,\\; 6,\\; 0\\right).\n$$\n这些显式计算展示了模素数幂的克洛斯特曼和所特有的相消模式，阐释了构成 Petersson 迹公式 (PTF) 中振荡项基础的现象。", "answer": "$$\\boxed{\\begin{pmatrix}6 \\cos\\!\\left(\\frac{4\\pi}{9}\\right) & 0 & -3 & 6 & 0\\end{pmatrix}}$$", "id": "3028706"}, {"introduction": "彼得森迹公式的核心在于它建立了一条连接谱论（尖点形式傅里叶系数的平均值）与几何/算术（克鲁斯特曼和与贝塞尔函数的和）的桥梁。通过编程来数值计算迹公式的算术侧，并观察其如何逼近谱论侧的整数值，是理解这一深刻恒等式的有效方法。这个练习要求你实现一个截断的贝塞尔-克鲁斯特曼级数，从而将理论付诸实践 [@problem_id:3028732]。", "problem": "设 $\\Gamma = \\mathrm{SL}(2,\\mathbb{Z})$，并设 $k$ 为一个偶数，满足 $k \\geq 12$。对于正整数 $m$ 和 $n$，定义克鲁斯特曼和 (Kloosterman sum)\n$$\nS(m,n;c) = \\sum_{\\substack{d \\bmod c \\\\ \\gcd(d,c)=1}} \\exp\\!\\left(\\frac{2\\pi i}{c}\\left(m d + n d^{-1} \\bmod c\\right)\\right),\n$$\n其中 $c$ 是一个正整数，$d^{-1}$ 表示 $d$ 模 $c$ 的乘法逆元。设 $J_{\\nu}(x)$ 表示第一类 $\\nu$ 阶贝塞尔函数 (Bessel function)。考虑截断的贝塞尔-克鲁斯特曼级数 (truncated Bessel–Kloosterman series)\n$$\nT_k(m,n;C) = \\delta_{m,n} + 2\\pi \\sum_{c=1}^{C} \\frac{S(m,n;c)}{c} \\, J_{k-1}\\!\\left(\\frac{4\\pi \\sqrt{mn}}{c}\\right),\n$$\n其中 $\\delta_{m,n}$ 是克罗内克 δ (Kronecker delta)。你的任务是实现一个程序，该程序能够：\n- 对于给定的 $m$、$n$ 和 $c$，根据其定义精确计算 $S(m,n;c)$。\n- 对于指定的 $k$ 和 $c$，在参数 $x = \\frac{4\\pi \\sqrt{mn}}{c}$ 处计算 $J_{k-1}(x)$。\n- 汇总这些结果以计算指定截断参数 $C$ 的 $T_k(m,n;C)$。\n\n使用以下测试套件，其中指定了元组 $(k,m,n,C)$：\n- $(12,1,1,1)$,\n- $(12,1,1,50)$,\n- $(12,1,2,200)$,\n- $(16,1,1,200)$,\n- $(16,2,3,200)$,\n- $(24,1,1,200)$,\n- $(24,1,2,200)$,\n- $(12,3,2,200)$.\n\n对于每个测试用例，生成单个浮点值 $T_k(m,n;C)$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_8\\right]$）。所有计算都是纯数学的；不需要物理单位或角度单位转换。通过根据定义计算 $S(m,n;c)$ 并使用稳健的求值方法计算 $J_{k-1}(x)$ 来确保数值稳定性和正确性。", "solution": "该问题要求为给定的一组参数 $(k,m,n,C)$ 计算截断的贝塞尔-克鲁斯特曼级数，记为 $T_k(m,n;C)$。该级数的公式为\n$$\nT_k(m,n;C) = \\delta_{m,n} + 2\\pi \\sum_{c=1}^{C} \\frac{S(m,n;c)}{c} \\, J_{k-1}\\!\\left(\\frac{4\\pi \\sqrt{mn}}{c}\\right)\n$$\n其中 $k$ 是大于或等于 $12$ 的偶数，$m$ 和 $n$ 是正整数，$C$ 是定义级数截断点的正整数。该问题是适定的，并且在科学上植根于模形式理论，特别是关于彼得森迹公式 (Petersson trace formula)。一个有效的解决方案需要系统地计算该公式的每个组成部分。这个过程可以分解为三个主要步骤：计算克鲁斯特曼和 $S(m,n;c)$，计算贝塞尔函数 $J_{k-1}(x)$，以及在最终求和中汇总这些项。\n\n**步骤 1：计算克鲁斯特曼和 $S(m,n;c)$**\n\n克鲁斯特曼和定义为：\n$$\nS(m,n;c) = \\sum_{\\substack{d \\bmod c \\\\ \\gcd(d,c)=1}} \\exp\\!\\left(\\frac{2\\pi i}{c}\\left(m d + n d^{-1}\\right)\\right)\n$$\n这是一个在整数模 $c$ 环的乘法单位群上的有限和，记为 $(\\mathbb{Z}/c\\mathbb{Z})^\\times$。项 $d^{-1}$ 表示 $d$ 模 $c$ 的乘法逆元，由于求和仅限于与 $c$ 互质的整数 $d$（即 $\\gcd(d,c)=1$），因此其存在性得到保证。\n\n$S(m,n;c)$ 的计算算法如下：\n1.  对于给定的正整数 $c$，我们首先处理基本情况。当 $c=1$ 时，单位群是平凡的，在此背景下的惯例是，和由一个值为 $1$ 的单项组成。因此，$S(m,n;1) = 1$。\n2.  对于 $c > 1$，我们遍历从 $1$ 到 $c-1$ 的所有整数 $d$。\n3.  对于每个 $d$，我们计算它与 $c$ 的最大公约数 $\\gcd(d,c)$。如果 $\\gcd(d,c) \\neq 1$，则该项从和中排除。\n4.  如果 $\\gcd(d,c) = 1$，我们计算模 $c$ 的乘法逆元 $d^{-1} \\pmod c$。这可以使用扩展欧几里得算法高效计算，或者更方便地，使用 Python 中的内置函数，如 `pow(d, -1, c)`。\n5.  然后我们计算指数项的参数，$x_{d} = \\frac{2\\pi}{c}(md + nd^{-1})$。完整的项是 $\\exp(i x_{d})$。\n6.  在所有有效的 $d$ 上对这些复指数项求和，得到 $S(m,n;c)$ 的值。\n\n克鲁斯特曼和的一个关键性质是它总是一个实数。这可以通过证明 $S(m,n;c)$ 等于其复共轭 $\\overline{S(m,n;c)}$ 来证明。这可以通过将求和变量从 $d$ 更改为 $-d$ 来实现。因此，所有项的虚部（正弦）之和为零。我们可以利用这一性质进行更高效的计算，即只对实部 $\\cos(x_{d})$ 求和，从而完全避免复数运算。\n\n**步骤 2：计算贝塞尔函数 $J_{\\nu}(x)$**\n\n第二个组成部分是第一类贝塞尔函数 $J_{\\nu}(x)$，其阶数为 $\\nu = k-1$，参数为 $x = \\frac{4\\pi \\sqrt{mn}}{c}$。对于给定的测试用例，$k$ 是偶数（$12, 16, 24$），因此阶数 $\\nu$ 是奇数（$11, 15, 23$）。参数 $x$ 是一个正实数。\n像 $J_{\\nu}(x)$ 这样的特殊函数的求值是科学计算中的一项标准任务。我们不从头实现它，因为这是一个复杂的数值分析问题，而是依赖于标准科学库提供的高质量、稳健的实现。SciPy 库中的 `scipy.special` 模块为此提供了 `jv(\\nu, x)` 函数，它适用于此处所需的整数阶和实数参数。\n\n**步骤 3：汇总成级数 $T_k(m,n;C)$**\n\n在确定了计算 $S(m,n;c)$ 和 $J_{k-1}(x)$ 的方法后，我们就可以计算最终的级数 $T_k(m,n;C)$。其过程如下：\n1.  计算克罗内克 δ 项 $\\delta_{m,n}$。如果 $m=n$，则为 $1$，否则为 $0$。\n2.  初始化一个变量，例如 `series_sum`，为 $0.0$。\n3.  遍历从 $1$ 到指定截断上限 $C$ 的整数 $c$。\n4.  在循环的每次迭代中，使用前面步骤中描述的方法计算 $S(m,n;c)$ 和 $J_{k-1}\\!\\left(\\frac{4\\pi \\sqrt{mn}}{c}\\right)$。\n5.  计算当前 $c$ 的项，即 $\\frac{S(m,n;c)}{c} J_{k-1}\\!\\left(\\frac{4\\pi \\sqrt{mn}}{c}\\right)$，并将其加到 `series_sum` 中。\n6.  循环完成后，将累加的和乘以 $2\\pi$ 并加上克罗内克 δ 项，得到最终结果：$T_k(m,n;C) = \\delta_{m,n} + 2\\pi \\cdot \\text{series\\_sum}$。\n\n由于 $S(m,n;c)$ 是实数，且对于实数参数 $x$，$J_{k-1}(x)$ 也是实数，所以整个和是实值的。对所提供套件中的每个测试用例 $(k,m,n,C)$ 进行计算，将产生一个单一的浮点数。然后将这些结果收集并格式化为逗号分隔的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jv\nimport math\n\ndef kloosterman_sum(m: int, n: int, c: int) -> float:\n    \"\"\"\n    Computes the Kloosterman sum S(m,n;c).\n    S(m,n;c) = sum_{d mod c, gcd(d,c)=1} exp(2*pi*i/c * (m*d + n*d_inv)).\n    The sum is known to be a real number.\n    \"\"\"\n    if c == 1:\n        # By convention in the theory of modular forms, S(m,n;1) = 1.\n        # The sum is over the trivial group (Z/1Z)*.\n        return 1.0\n\n    total_sum = 0.0\n    for d in range(1, c):\n        if math.gcd(d, c) == 1:\n            # Modular inverse d_inv exists since gcd(d,c)=1.\n            # pow(d, -1, c) is available in Python 3.8+ and is efficient.\n            d_inv = pow(d, -1, c)\n            \n            # The argument of the complex exponential.\n            arg = (2.0 * np.pi / c) * (m * d + n * d_inv)\n            \n            # The Kloosterman sum is real. We can prove S(m,n;c) = conj(S(m,n;c))\n            # by a change of variables d -> -d. Thus, we only need to sum the\n            # cosine components, as the sine components will cancel out.\n            total_sum += np.cos(arg)\n            \n    return total_sum\n\ndef compute_Tk(k: int, m: int, n: int, C: int) -> float:\n    \"\"\"\n    Computes the truncated Bessel-Kloosterman series T_k(m,n;C).\n    T_k(m,n;C) = delta_{m,n} + 2*pi * sum_{c=1 to C} (S(m,n;c)/c) * J_{k-1}(4*pi*sqrt(m*n)/c).\n    \"\"\"\n    # Kronecker delta term\n    delta_mn = 1.0 if m == n else 0.0\n    \n    series_sum = 0.0\n    \n    # Sum over c from 1 to C\n    for c in range(1, C + 1):\n        # Compute the Kloosterman sum S(m,n;c)\n        s_val = kloosterman_sum(m, n, c)\n        \n        # Argument for the Bessel function\n        bessel_arg = (4.0 * np.pi * np.sqrt(m * n)) / c\n        \n        # Order of the Bessel function\n        bessel_order = k - 1\n        \n        # Evaluate the Bessel function of the first kind J_nu(x)\n        bessel_val = jv(bessel_order, bessel_arg)\n        \n        # Add the term to the series sum\n        series_sum += (s_val / c) * bessel_val\n        \n    result = delta_mn + 2.0 * np.pi * series_sum\n    return result\n\ndef solve():\n    \"\"\"\n    Runs the computation for the specified test suite and prints the results.\n    \"\"\"\n    # Test suite specified as tuples of (k, m, n, C)\n    test_cases = [\n        (12, 1, 1, 1),\n        (12, 1, 1, 50),\n        (12, 1, 2, 200),\n        (16, 1, 1, 200),\n        (16, 2, 3, 200),\n        (24, 1, 1, 200),\n        (24, 1, 2, 200),\n        (12, 3, 2, 200),\n    ]\n\n    results = []\n    for k, m, n, C in test_cases:\n        res = compute_Tk(k, m, n, C)\n        results.append(res)\n\n    # Format the output as a single-line, comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3028732"}, {"introduction": "标准的彼得森迹公式在某些特殊情况下需要修正，其中最经典的例子是权重 $k=2$ 的情形。这是因为存在非尖点的全纯艾森斯坦级数，它们的贡献必须从“朴素”的迹公式中减去。本练习通过一个尖点形式空间维数为零的具体例子，清晰地展示了修正项如何精确地抵消几何侧的非尖点部分，从而加深对迹公式精细结构的理解 [@problem_id:3028738]。", "problem": "令 $\\Gamma_{0}(2) \\subset \\mathrm{SL}_{2}(\\mathbb{Z})$ 为水平为 $2$ 的同余子群，并考虑 $\\Gamma_{0}(2)$ 上权为 $2$ 且具有平凡nebentypus的全纯模形式。用 $S_{2}(\\Gamma_{0}(2))$ 表示权为 $2$ 的全纯尖点形式空间，用 $\\langle \\cdot , \\cdot \\rangle$ 表示尖点形式上的Petersson内积，其定义为\n$$\n\\langle f,g \\rangle \\;=\\; \\int_{\\Gamma_{0}(2)\\backslash \\mathbb{H}} f(z)\\,\\overline{g(z)}\\,y^{2}\\,\\frac{dx\\,dy}{y^{2}}\n$$\n对任意 $z=x+iy \\in \\mathbb{H}$ 和 $f,g \\in S_{2}(\\Gamma_{0}(2))$。\n  \n对于整数 $m,n \\geq 1$，令 $\\{\\!f\\!\\}$ 表示 $S_{2}(\\Gamma_{0}(2))$ 的一个标准正交Hecke基（如果非空），并定义全纯Petersson迹和\n$$\nT_{2}^{(2)}(m,n) \\;:=\\; \\sum_{f} \\lambda_{f}(m)\\,\\overline{\\lambda_{f}(n)},\n$$\n其中 $\\lambda_{f}(\\cdot)$ 是 $f$ 的Hecke特征值，经过归一化使得在尖点 $\\infty$ 处的傅里叶展开为 $f(z) = \\sum_{r\\geq 1} a_{f}(r)\\,q^{r}$，且满足 $a_{f}(1)=1$ 和 $\\lambda_{f}(r)=a_{f}(r)$。\n  \n一个经过充分检验的事实是，在权为 $2$ 的情况下，必须修正朴素的Petersson迹公式，以消除来自全纯Eisenstein谱的非尖点贡献。$\\Gamma_{0}(2)$ 上的一个典范全纯权-$2$ Eisenstein级数是\n$$\nF_{2}(z) \\;=\\; E_{2}(z) \\,-\\, 2\\,E_{2}(2z),\n$$\n其中 $E_{2}(z) = 1 - 24\\sum_{r\\geq 1} \\sigma_{1}(r)\\,q^{r}$ 是 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 上的经典权-$2$ Eisenstein级数（它是一个拟模形式），而线性组合 $E_{2}(z)-2E_{2}(2z)$ 是 $\\Gamma_{0}(2)$ 上的一个权为 $2$ 的全纯模形式，在尖点 $\\infty$ 处有非零常数项。权为 $2$ 的修正Petersson迹减去了全纯Eisenstein谱的贡献，从而使得谱侧只剩下尖点数据。\n  \n计算 $\\Gamma_{0}(2)$ 的修正全纯Petersson迹 $T_{2}^{(2)}(1,1)$，并通过明确指出 $F_{2}(z)$ 及其常数项的作用，验证在此例中，权为 $2$ 的伪非尖点项相互抵消。请将最终答案以单个实数形式给出。无需四舍五入。", "solution": "问题要求计算同余子群 $\\Gamma_{0}(2)$ 的修正全纯Petersson迹 $T_{2}^{(2)}(1,1)$，并附带一个涉及非尖点贡献的验证。\n\n**第一部分：问题验证**\n\n首先，我将验证问题陈述。\n已知条件如下：\n- 群: $\\Gamma_{0}(2) = \\left\\{ \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} \\in \\mathrm{SL}_{2}(\\mathbb{Z}) : c \\equiv 0 \\pmod{2} \\right\\}$。\n- 尖点形式空间：$S_{2}(\\Gamma_{0}(2))$，权 $k=2$ 且具有平凡nebentypus。\n- $S_{2}(\\Gamma_{0}(2))$ 的标准正交Hecke基：$\\{f\\}$。\n- 全纯Petersson迹和：$T_{2}^{(2)}(m,n) := \\sum_{f} \\lambda_{f}(m)\\,\\overline{\\lambda_{f}(n)}$，其中 $\\lambda_f(n)$ 是Hecke特征值。\n- 归一化：特征值对应于Hecke归一化形式，其傅里叶展开为 $g(z) = \\sum_{r\\geq 1} a_{g}(r)\\,q^{r}$，其中 $a_{g}(1)=1$，且 $\\lambda_g(r)=a_g(r)$。对任意Hecke特征形式 $f$，其特征值 $\\lambda_f(1)$ 为 $1$。\n- $\\Gamma_0(2)$ 的Eisenstein级数：$F_{2}(z) = E_{2}(z) - 2\\,E_{2}(2z)$，这是一个 $\\Gamma_0(2)$ 上的权为 $2$ 的全纯模形式。\n\n该问题在模形式理论中有坚实的科学基础，且提法恰当。其中的定义是标准的，尽管迹和的记号需要仔细解释。所陈述的问题在形式上是可解的。\n\n**第二部分：$T_{2}^{(2)}(1,1)$ 的计算**\n\n待计算的量定义为 $T_{2}^{(2)}(m,n) := \\sum_{f} \\lambda_{f}(m)\\,\\overline{\\lambda_{f}(n)}$，其中 $\\{f\\}$ 是 $S_{2}(\\Gamma_{0}(2))$ 的一个标准正交Hecke基。我们被要求计算 $m=n=1$ 时的值。\n\n对任意Hecke特征形式 $f$，第一个Hecke算子 $T_1$ 的作用是乘以特征值 $\\lambda_f(1)$。由于对于水平 $N>1$，$T_1$ 是恒等算子，我们有 $\\lambda_f(1)=1$。\n因此，$T_{2}^{(2)}(1,1)$ 的表达式简化为：\n$$\nT_{2}^{(2)}(1,1) = \\sum_{f} \\lambda_{f}(1)\\,\\overline{\\lambda_{f}(1)} = \\sum_{f} |1|^{2} = \\sum_{f} 1\n$$\n这个和计算的是标准正交基 $\\{f\\}$ 中元素的数量，它等于空间 $S_{2}(\\Gamma_{0}(2))$ 的维数。\n我们必须计算这个维数。对于权 $k=2$，$\\Gamma_0(N)$ 的尖点形式空间的维数等于模曲线 $X_0(N)$ 的亏格，记作 $g_0(N)$。\n$X_0(N)$ 的亏格由以下公式给出：\n$$\ng_0(N) = 1 + \\frac{[\\mathrm{SL}_2(\\mathbb{Z}): \\Gamma_0(N)]}{12} - \\frac{\\nu_2}{4} - \\frac{\\nu_3}{3} - \\frac{\\nu_\\infty}{2}\n$$\n对于 $N=2$，我们有：\n- $\\Gamma_0(2)$ 在 $\\mathrm{SL}_2(\\mathbb{Z})$ 中的指数是 $[\\mathrm{SL}_2(\\mathbb{Z}): \\Gamma_0(2)] = N \\prod_{p|N}(1 + \\frac{1}{p}) = 2(1+\\frac{1}{2})=3$。\n- 尖点的数量是 $\\nu_\\infty = \\sum_{d|N} \\phi(\\gcd(d, N/d)) = \\phi(\\gcd(1,2)) + \\phi(\\gcd(2,1)) = \\phi(1)+\\phi(1)=1+1=2$。尖点由 $\\infty$ 和 $0$ 表示。\n- 阶为 $2$ 的椭圆点数量是 $\\nu_2 = \\prod_{p|N}(1 + (\\frac{-1}{p})) = 1+(\\frac{-1}{2}) = 1+0=1$，因为 $4 \\nmid 2$。\n- 阶为 $3$ 的椭圆点数量是 $\\nu_3 = \\prod_{p|N}(1 + (\\frac{-3}{p})) = 1+(\\frac{-3}{2}) = 1-1=0$，因为 $2 \\equiv 2 \\pmod 3$。\n\n将这些值代入亏格公式：\n$g_0(2) = 1 + \\frac{3}{12} - \\frac{1}{4} - \\frac{0}{3} - \\frac{2}{2} = 1 + \\frac{1}{4} - \\frac{1}{4} - 1 = 0$。\n因此，尖点形式空间的维数是 $\\dim S_{2}(\\Gamma_{0}(2)) = g_0(2) = 0$。\n空间 $S_{2}(\\Gamma_{0}(2))$ 是平凡向量空间 $\\{0\\}$。这个空间的基是空集。\n定义 $T_{2}^{(2)}(1,1)$ 的和是一个空和，其值为 $0$。\n$$\nT_{2}^{(2)}(1,1) = 0\n$$\n\n**第三部分：抵消的验证**\n\n问题要求验证“在此例中，权为 $2$ 的伪非尖点项相互抵消”。这指的是Petersson迹公式的结构。\n\nPetersson迹公式提供了一个谱侧（对尖点形式求和）和一个几何侧（对共轭类求和，涉及Kloosterman和与Bessel函数）之间的恒等式。对于权 $k>2$，该公式以其“朴素”形式成立。对于权 $k=2$，它必须被修正。\n\n令 $\\mathcal{C}(m,n)$ 为对尖点形式的标准谱和，$\\mathcal{G}_{\\text{naive}}(m,n)$ 为朴素几何侧，$\\mathcal{E}(m,n)$ 为来自全纯Eisenstein谱的贡献。权为 $2$ 的正确（或修正的）迹公式是：\n$\\mathcal{C}(m,n) = \\mathcal{G}_{\\text{naive}}(m,n) - \\mathcal{E}(m,n)$\n问题中定义的量 $T_{2}^{(2)}(m,n)$ 与 $\\mathcal{C}(m,n)$ 的标准归一化相关，但并不相同，后者通常包含逆Petersson范数 $\\|f\\|^{-2}$。然而，由于空间 $S_2(\\Gamma_0(2))$ 是平凡的，任何这样的和，包括问题中定义的和，都为零。所以，$\\mathcal{C}(1,1)=0$。\n\n我们的任务是验证修正公式的右侧也为零，即 $\\mathcal{G}_{\\text{naive}}(1,1) - \\mathcal{E}(1,1) = 0$。这意味着我们必须证明 $\\mathcal{G}_{\\text{naive}}(1,1) = \\mathcal{E}(1,1)$。\n\n1.  **朴素几何侧 $\\mathcal{G}_{\\text{naive}}(1,1)$**：对于一般的权 $k$，朴素几何侧由下式给出：\n    $$\n    \\mathcal{G}_{\\text{naive}, k}(m,n) = \\delta_{m,n} + 2\\pi i^{-k} \\sum_{c>0, c \\equiv 0 (N)} \\frac{S(m,n;c)}{c} J_{k-1}\\left(\\frac{4\\pi \\sqrt{mn}}{c}\\right)\n    $$\n    在我们的例子中，$k=2$，$N=2$，且 $m=n=1$，这变成：\n    $$\n    \\mathcal{G}_{\\text{naive}}(1,1) = \\delta_{1,1} + 2\\pi i^{-2} \\sum_{c>0, c \\equiv 0 (2)} \\frac{S(1,1;c)}{c} J_{1}\\left(\\frac{4\\pi}{c}\\right) = 1 - 2\\pi \\sum_{c=2,4,\\dots} \\frac{S(1,1;c)}{c} J_{1}\\left(\\frac{4\\pi}{c}\\right)\n    $$\n\n2.  **Eisenstein贡献 $\\mathcal{E}(1,1)$**：此项源于非尖点的全纯Eisenstein谱。对于 $\\Gamma_0(2)$ 和权 $2$，Eisenstein级数空间 $E_2(\\Gamma_0(2))$是一维的，由形式 $F_2(z) = E_2(z) - 2E_2(2z)$ 张成。$F_2(z)$ 的非零常数项为 $a_0 = 1-2 = -1$，这证实了它不是一个尖点形式，因此张成了Eisenstein空间。\n    对迹公式的贡献 $\\mathcal{E}(m,n)$ 可以被理解为在Eisenstein级数空间上应用一个假设的“迹公式”所产生的项。对于 $m=n=1$，这对应于该空间上与恒等算子相关的算子的迹。恒等算子的迹是空间的维数。\n    模形式总空间的维数是 $\\dim M_2(\\Gamma_0(2)) = g_0(2) + \\nu_\\infty - 1 = 0 + 2 - 1 = 1$。由于 $\\dim S_2(\\Gamma_0(2))=0$，我们有 $\\dim E_2(\\Gamma_0(2))=1$。\n    因此，$m=n=1$ 时的Eisenstein贡献恰好是这个维数：\n    $\\mathcal{E}(1,1) = \\dim E_2(\\Gamma_0(2)) = 1$\n    $F_2(z)$ 的作用是作为张成此一维空间的Hecke特征形式，它的存在使得修正项 $\\mathcal{E}(1,1)$ 成为必需。\n\n3.  **抵消**：将这些代入修正后的迹公式：\n    $$\n    \\mathcal{C}(1,1) = \\mathcal{G}_{\\text{naive}}(1,1) - \\mathcal{E}(1,1)\n    $$\n    $$\n    0 = \\left( 1 - 2\\pi \\sum_{c=2,4,\\dots} \\frac{S(1,1;c)}{c} J_{1}\\left(\\frac{4\\pi}{c}\\right) \\right) - 1\n    $$\n    $$\n    0 = - 2\\pi \\sum_{c=2,4,\\dots} \\frac{S(1,1;c)}{c} J_{1}\\left(\\frac{4\\pi}{c}\\right)\n    $$\n    这展示了抵消过程。来自朴素几何迹 $\\mathcal{G}_{\\text{naive}}(1,1)$ 的“伪”非尖点项是恒等分量 $\\delta_{1,1}=1$，它恰好被Eisenstein贡献 $\\mathcal{E}(1,1)=1$ 所抵消。因此，为了使恒等式成立，几何侧的剩余部分，即涉及Kloosterman和与Bessel函数的和，必须为零。验证至此完成。抵消发生在 $\\delta_{1,1}$ 项和Eisenstein贡献之间。\n\n所要求的值是修正迹本身，即对尖点谱的求和。如前所述，这个值是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3028738"}]}