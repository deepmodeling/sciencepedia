## 引言
[正则素数](@entry_id:196257)是数论，特别是代数数论领域中的一个核心概念，由19世纪数学家Ernst Kummer在其研究[费马大定理](@entry_id:204421)的宏伟工作中首次引入。它的重要性在于，它在纯粹的[代数结构](@entry_id:137052)（分圆域的理想类群）与具体的算术对象（[伯努利数](@entry_id:177442)）之间建立了一座意想不到的桥梁。这一发现不仅为解决一个世纪难题提供了强有力的工具，更揭示了数论世界中深刻的内在和谐。然而，理解这一联系的本质，即为何[伯努利数](@entry_id:177442)的[整除性](@entry_id:190902)能控制[理想类群](@entry_id:153974)的性质，是该理论的核心知识缺口，也是从初学者到研究者的必经之路。

本文旨在系统性地阐明[正则素数](@entry_id:196257)的理论框架与应用。我们将带领读者穿越其历史与现代的发展脉络，全面掌握这一关键概念。
- 在“原理与机制”一章中，我们将从基础的[伯努利数](@entry_id:177442)和分圆域类群结构讲起，最终聚焦于连接二者的核心——库默判则，并借助赫布兰-里贝定理和[岩泽理论](@entry_id:197056)等现代工具，揭示其背后的深层[代数结构](@entry_id:137052)。
- 随后，在“应用与跨学科联系”一章中，我们将探讨该理论的经典应用，即它在[费马大定理](@entry_id:204421)研究中的里程碑式贡献，并展示其如何演变为现代数论（如$p$-进[L-函数](@entry_id:193304)和[岩泽理论](@entry_id:197056)）的基石，连接起代数、分析与计算。
- 最后，在“动手实践”部分，我们将通过具体的计算问题，引导读者亲手应用库默判则，将抽象的理论转化为可操作的计算技能，从而加深理解。

通过这趟旅程，读者不仅将理解[正则素数](@entry_id:196257)的定义和判别方法，更能领会其在整个数论发展史中的枢纽地位。

## 原理与机制

在本章中，我们将深入探讨[正则素数](@entry_id:196257)理论的核心原理与机制。我们将从其算术基础——[伯努利数](@entry_id:177442)——开始，然后构建其所应用的[代数结构](@entry_id:137052)——[分圆域](@entry_id:153828)的[类群](@entry_id:182524)。最终，我们将阐明连接这两者的关键桥梁：库默判则及其现代理论诠释，包括赫布兰-里贝定理和[岩泽理论](@entry_id:197056)的视角。

### [伯努利数](@entry_id:177442)：算术之钥

研究[正则素数](@entry_id:196257)的起点是一种特殊的有理数序列，即**[伯努利数](@entry_id:177442) (Bernoulli numbers)**。这些数在数论的许多分支中都扮演着核心角色。我们采用指数[生成函数](@entry_id:146702)来定义[伯努利数](@entry_id:177442) $B_n$ [@problem_id:3022705]：
$$ \frac{t}{e^t - 1} = \sum_{n=0}^{\infty} B_n \frac{t^n}{n!} $$
为了从这个定义中提取出[伯努利数](@entry_id:177442)的具体值，我们可以将其改写为 $t = (e^t - 1) \left( \sum_{n=0}^{\infty} B_n \frac{t^n}{n!} \right)$。通过展开 $e^t - 1 = \sum_{j=1}^{\infty} \frac{t^j}{j!}$ 并比较两侧 $t^n$ 的系数，我们可以推导出一个递推关系。当 $n=1$ 时，系数比较得出 $B_0=1$。对于 $n > 1$， $t^n$ 的系数为零，这引出了以下重要的[递推公式](@entry_id:149465) [@problem_id:3022705]：
$$ \sum_{k=0}^{n-1} \binom{n}{k} B_k = 0 \quad (\text{对于 } n>1) $$
这个公式允许我们从 $B_0, \dots, B_{n-2}$ 计算出 $B_{n-1}$。利用此递推关系，我们可以计算出[伯努利数](@entry_id:177442)的初始几项。需要注意的是，关于 $B_1$ 的定义存在两种约定，一种是 $B_1 = 1/2$，另一种是 $B_1 = -1/2$。我们在此遵循后一种约定。计算出的值如下：
$B_0 = 1, B_1 = -\frac{1}{2}, B_2 = \frac{1}{6}, B_4 = -\frac{1}{30}, B_6 = \frac{1}{42}, B_8 = -\frac{1}{30}, B_{10} = \frac{5}{66}$。
一个重要的性质是，对于所有大于1的奇数 $k$，我们有 $B_k=0$。这是因为函数 $\frac{t}{e^t - 1} + \frac{t}{2}$ 是一个偶函数，其[幂级数展开](@entry_id:273325)中只含有 $t$ 的偶次幂。

[伯努利数](@entry_id:177442)是$p$-进整数，其分母的结构由**[冯·施陶特-克劳森定理](@entry_id:203994) (von Staudt–Clausen theorem)** 完美描述。该定理指出，对于任意偶数 $k \ge 2$，[伯努利数](@entry_id:177442) $B_k$ 的分母是所有满足 $(q-1) \mid k$ 的素数 $q$ 的乘积 [@problem_id:3022736]。这意味着对于库默判则中出现的[伯努利数](@entry_id:177442) $B_k$（其中 $2 \le k \le p-3$），其分母永远不会被 $p$ 整除，因为 $p-1$ 不可能整除 $k$。因此，所有关于 $p$ 的[整除性](@entry_id:190902)问题的关键信息都蕴含在 $B_k$ 的分子中。

### [分圆域](@entry_id:153828)[类群](@entry_id:182524)的结构

[伯努利数](@entry_id:177442)的算术性质之所以重要，是因为它们与**[分圆域](@entry_id:153828) (cyclotomic fields)** 的类群结构有着深刻的联系。令 $p$ 是一个奇素数，$\zeta_p$ 是一个本原 $p$ 次单位根。$p$ 次分圆域定义为 $K = \mathbb{Q}(\zeta_p)$。其[理想类群](@entry_id:153974) $\mathrm{Cl}(K)$ 的阶，即**[类数](@entry_id:156164) (class number)** $h(K)$，是衡量该域的算术性质偏离唯一[因子分解](@entry_id:150389)理想程度的指标。

$K$ 的伽罗瓦群 $\mathrm{Gal}(K/\mathbb{Q})$ 同构于 $(\mathbb{Z}/p\mathbb{Z})^\times$。这个群中有一个特殊的二阶自同构——复共轭 $\tau$，其作用是 $\tau(\zeta_p) = \overline{\zeta_p} = \zeta_p^{-1}$ [@problem_id:3022701]。在同构 $\mathrm{Gal}(K/\mathbb{Q}) \cong (\mathbb{Z}/p\mathbb{Z})^\times$ 下，$\tau$ 对应于 $-1$ [@problem_id:3022701]。

复[共轭作用](@entry_id:143328)下的[不动点](@entry_id:156394)[子域](@entry_id:155812)是 $K$ 的最大实子域 $K^+ = \mathbb{Q}(\zeta_p + \zeta_p^{-1})$ [@problem_id:3022701]。$K$ 是 $K^+$ 的二次扩张，即 $[K:K^+]=2$。这个结构上的分解也反映在[类数](@entry_id:156164)上。$K^+$ 的[类数](@entry_id:156164) $h^+$ 整除 $K$ 的类数 $h(K)$，我们可以定义**相对类数 (relative class number)** $h^- = h(K)/h^+$。因此，我们有类数的分解 $h(K) = h^+ h^-$ [@problem_id:3022701]。

这个分解在[类群](@entry_id:182524)的 $p$-Sylow [子群](@entry_id:146164)（即 $p$-部分）$A$ 上体现得更为清晰。$A$ 是一个有限阿贝尔 $p$-群，复共轭 $\tau$ 在其上诱导了一个对合。由于 $p$ 是奇素数，2 在 $A$ 上是可逆的，这使得 $A$ 可以典范地分解为 $\tau$ 的 $+1$ 和 $-1$ 特征空间（加法符号下）的直和 [@problem_id:3022727]：
$$ A \cong A^+ \oplus A^- $$
其中 $A^+ = \{a \in A \mid \tau(a) = a\}$ 是“加部分”，$A^- = \{a \in A \mid \tau(a) = -a\}$ 是“减部分”。在乘法符号下，减部分的条件写作 $\tau(a) = a^{-1}$ [@problem_id:3022727]。$A^+$ 同构于 $K^+$ 类群的 $p$-部分，而 $A^-$ 则与相对类数 $h^-$ 的 $p$-部分相对应。这个分解可以通过在[群环](@entry_id:146647) $\mathbb{Z}_p[\langle\tau\rangle]$ 中使用[幂等元](@entry_id:153117) $e^\pm = \frac{1}{2}(1 \pm \tau)$ 来形式化地定义，即 $A^\pm = e^\pm A$ [@problem_id:3022727]。

### 库默判则：连接算术与代数

Ernst Kummer 在研究费马大定理时引入了[正则素数](@entry_id:196257)的概念。一个奇素数 $p$ 被称为**[正则素数](@entry_id:196257) (regular prime)**，如果它不整除[分圆域](@entry_id:153828) $K=\mathbb{Q}(\zeta_p)$ 的[类数](@entry_id:156164) $h(K)$ [@problem_id:3022736]。如果 $p \mid h(K)$，则称 $p$ 为**非[正则素数](@entry_id:196257) (irregular prime)**。

Kummer 的惊人发现是，这个纯粹的代数条件可以完全通过[伯努利数](@entry_id:177442)的算术性质来检验。这就是**库默判则 (Kummer's criterion)**：

**定理 (Kummer, 1850):** 一个奇素数 $p$ 是正则的，当且仅当 $p$ 不整除任何[伯努利数](@entry_id:177442) $B_k$ 的分子，其中 $k$ 是满足 $2 \le k \le p-3$ 的偶数 [@problem_id:3022688, @problem_id:3022729]。

我们定义 $p$ 的**非正则指数 (index of irregularity)** $i(p)$ 为满足 $2 \le k \le p-3$ 且 $p$ 整除 $B_k$ 分子的偶数 $k$ 的个数 [@problem_id:3022705]。因此，一个素数 $p$ 是正则的当且仅当 $i(p)=0$ [@problem_id:3022736]。

例如，为了判断 $p=13$ 是否是正则的，我们需要检查[伯努利数](@entry_id:177442) $B_2, B_4, B_6, B_8, B_{10}$。我们已计算出 $B_2=\frac{1}{6}, B_4=-\frac{1}{30}, B_6=\frac{1}{42}, B_8=-\frac{1}{30}, B_{10}=\frac{5}{66}$。这些[伯努利数](@entry_id:177442)的分子分别是 $1, -1, 1, -1, 5$。素数 $13$ 均不整除它们中的任何一个。因此，$i(13)=0$，$13$ 是一个[正则素数](@entry_id:196257) [@problem_id:3022705]。第一个非[正则素数](@entry_id:196257)是 $37$，因为 $37$ 整除 $B_{32}$ 的分子。

Kummer 利用这个判则证明了，对于所有[正则素数](@entry_id:196257)指数 $p$，费马大定理成立。特别是，他证明了第一种情况（即 $p \nmid xyz$）对于所有[正则素数](@entry_id:196257)都成立 [@problem_id:3022736]。

### 赫布兰-里贝定理：现代诠释

为什么[伯努利数](@entry_id:177442)能够控制[类数](@entry_id:156164)？现代的答案由**赫布兰-里贝定理 (Herbrand–Ribet theorem)** 提供，它精确地阐明了库默判则背后的机制。该定理表明，[伯努利数](@entry_id:177442)控制的不是整个类数，而是其“减部分” $h^-$。一个关键的（但非平凡的）事实是 $p \mid h(K) \iff p \mid h^-$。因此，正则性完全由减部分决定。

为了更精确地陈述，我们需要引入[类群](@entry_id:182524)的特征空间分解。伽罗瓦群 $\Delta = \mathrm{Gal}(K/\mathbb{Q})$ 在 $A$ 上的作用，使得 $A$ 可以分解为对应于 $\Delta$ 的特征（在 $p$ 进意义下）的[子空间](@entry_id:150286)直和。这些特征由**泰希米勒特征 (Teichmüller character)** $\omega: \Delta \to \mathbb{Z}_p^\times$ 的幂 $\omega^j$ 给出。减部分 $A^-$ 是所有奇特征（即 $\omega^j(-1)=-1$，对应于奇数 $j$）的特征空间之和。

**定理 (Herbrand–Ribet):** 对于偶数 $k$ 且 $2 \le k \le p-3$，$p$ 整除[伯努利数](@entry_id:177442) $B_k$ 的分子，当且仅当类群的 $p$-部分 $A$ 中对应于特征 $\omega^{p-k}$ 的特征空间非平凡 [@problem_id:3022688, @problem_id:3022732]。

由于 $k$ 是偶数，$p-k$ 是奇数，所以特征 $\omega^{p-k}$ 是一个奇特征，其对应的[特征空间](@entry_id:638014)是 $A^-$ 的一部分。因此，[伯努利数](@entry_id:177442) $B_k$ 的 $p$-[整除性](@entry_id:190902)直接对应于 $A^-$ 的某个特定部分的非平凡性。非正则指数 $i(p)$ 精确地计算了 $A^-$ 中有多少个这样的非平凡[特征空间](@entry_id:638014) [@problem_id:3022729]。

### 高等视角与相关概念

#### 解析联系：[L-函数](@entry_id:193304)

[伯努利数](@entry_id:177442)与黎曼Zeta函数及更一般的[狄利克雷L函数](@entry_id:199760)的特殊值紧密相关。例如，对于整数 $k \ge 2$，我们有 $\zeta(1-k) = -B_k/k$ [@problem_id:3022736]。由于在相关范围内 $p \nmid k$ 且 $p$ 不整除 $B_k$ 的分母，库默判则中的条件 $p \mid \mathrm{num}(B_k)$ 等价于 $p$-进意义下的[同余](@entry_id:143700)式 $\zeta(1-k) \equiv 0 \pmod p$ [@problem_id:3022736]。

这一联系在 $p$-进世界中得到了深化。**久保田-利奥波德 $p$-进[L-函数](@entry_id:193304) (Kubota–Leopoldt $p$-adic L-function)** $L_p(s, \chi)$ 通过在一个 $p$-进圆盘上插值[狄利克雷L函数](@entry_id:199760)的特殊值来定义。对于我们关心的[伯努利数](@entry_id:177442)，其插值公式为 [@problem_id:3022696]：
$$ L_p(1-k, \omega^{1-k}) = \left(1 - \omega^{k-1}(p)p^{k-2}\right) \frac{B_k}{k} $$
对于偶数 $k$ 且 $2 \le k \le p-3$，公式中的欧拉因子 $(1 - \omega^{k-1}(p)p^{k-2})$ 是一个 $p$-进单位（即其 $p$-进范数为1）。因此，$B_k/k$ 的$p$-进可除性与 $L_p(1-k, \omega^{1-k})$ 的$p$-进可除性完全相同。这意味着库默判则可以被优雅地重述为 [@problem_id:3022696]：

**推论:** 一个素数 $p$ 是非正则的，当且仅当存在某个偶数 $k$ ($2 \le k \le p-3$)，使得$p$-进L-函数的特殊值 $L_p(1-k, \omega^{1-k})$ 能被 $p$ 整除。

此外，通过广义[伯努利数](@entry_id:177442) $B_{1,\chi}$，这个判则还可以用[岩泽理论](@entry_id:197056)的语言来表达。对于奇特征 $\chi = \omega^{1-k}$，库默[同余](@entry_id:143700)建立了 $B_{1,\chi}$ 和 $B_k/k$ 之间的 $p$-进联系，从而 $p$ 的正则性等价于 $B_{1,\omega^{1-k}} \not\equiv 0 \pmod p$ 对所有相关 $k$ 成立 [@problem_id:3022730, @problem_id:3022730]。

#### [范迪弗猜想](@entry_id:182245)与“加部分”

[伯努利数](@entry_id:177442)和赫布兰-里贝定理完美地描述了[类群](@entry_id:182524)的“减部分” $A^-$。那么“加部分” $A^+$ 呢？关于 $A^+$ 最著名的论断是**[范迪弗猜想](@entry_id:182245) (Vandiver's Conjecture)**：

**猜想 (Vandiver):** 对于所有素数 $p$，$p$ 均不整除最大实[子域](@entry_id:155812) $K^+$ 的类数 $h^+$ [@problem_id:3022722]。

这个猜想等价于对所有 $p$，$A^+$ 都是平凡群，即 $A^+=0$。尽管这个猜想至今未被证明，但它已被验证对所有小于 $163 \times 10^6$ 的素数成立。通过Sinnott的定理，[范迪弗猜想](@entry_id:182245)还等价于另一个代数陈述：对所有 $p$，$K^+$ 中[单位群](@entry_id:184012) $E^+$ 与其[子群](@entry_id:146164)——[分圆单位](@entry_id:184331)群 $C^+$ ——的[商群](@entry_id:145113) $E^+/C^+$ 的阶不被 $p$ 整除 [@problem_id:3022722]。

如果一个素数 $p$ 是正则的，那么 $p \nmid h(K) = h^+ h^-$，这自然意味着 $p \nmid h^+$。因此，**正则性蕴含着[范迪弗猜想](@entry_id:182245)对该素数成立** [@problem_id:3022722]。然而，反过来不成立。存在非[正则素数](@entry_id:196257)（即 $p \mid h^-$，所以 $A^- \neq 0$）但满足[范迪弗猜想](@entry_id:182245)（$p \nmid h^+$，所以 $A^+=0$）。第一个这样的例子就是 $p=37$ [@problem_id:3022722]。

最后，我们回到一个深刻的观察。库默判则本身，即 $p \nmid h(K) \iff$ ([伯努利数](@entry_id:177442)条件)，是一个无条件成立的定理。结合赫布兰-里贝定理（[伯努利数](@entry_id:177442)条件 $\iff A^-=0$），我们得到一个惊人的推论：$p \nmid h(K) \iff A^-=0$。由于 $p \nmid h(K)$ 等价于 $A=0$（即 $A^+=0$ 且 $A^-=0$），这意味着 $A=0 \iff A^-=0$。换言之，**“减部分”的平凡性蕴含了整个 $p$-[类群](@entry_id:182524)的平凡性** [@problem_id:3022732]。这揭示了 $A^+$ 和 $A^-$ 之间存在一种名为“反射”的深刻对偶关系。尽管[伯努利数](@entry_id:177442)表面上只与 $A^-$ 直接相关，但通过这种深层结构，它们实际上控制了整个[类群](@entry_id:182524)的 $p$-部分的正则性。