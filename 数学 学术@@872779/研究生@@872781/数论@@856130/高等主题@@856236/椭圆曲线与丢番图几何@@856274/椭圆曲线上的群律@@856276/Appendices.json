{"hands_on_practices": [{"introduction": "椭圆曲线上的群律源于一个优美的几何构造，即“弦切法”。这个入门练习将引导你完成一次具体计算，将一条特定椭圆曲线上的两个不同点相加。通过这个实践，你将能巩固对群律背后几何直觉的理解，并熟悉如何运用韦达定理（Viète's formulas）这一关键代数工具来确定交点坐标 [@problem_id:2167288]。", "problem": "对椭圆曲线的研究涉及一种迷人的点的加法几何构造。考虑由方程 $y^2 = x^3 + ax + b$ 定义的椭圆曲线。对于曲线上任意两个不同的点 $P=(x_P, y_P)$ 和 $Q=(x_Q, y_Q)$，其“和”运算（记作 $R = P+Q$）通过以下几何步骤定义：\n\n1.  画一条穿过点 $P$ 和 $Q$ 的直线。\n2.  这条直线将与曲线相交于第三个点，我们称之为 $S'=(x_{S'}, y_{S'})$。\n3.  代表和 $P+Q$ 的点 $R$ 是点 $S'$ 关于 x 轴的对称点。\n\n给定由方程 $y^2 = x^3 + 17$ 定义的椭圆曲线。曲线上的两个点是 $P = (-2, 3)$ 和 $Q = (2, 5)$。\n\n求点 $R = P+Q$ 的坐标。请将你的答案表示为一个有序有理数对 $(x_R, y_R)$。", "solution": "在椭圆曲线 $y^{2} = x^{3} + 17$ 上，两个不同点 $P = (x_{P}, y_{P})$ 和 $Q = (x_{Q}, y_{Q})$ 的和 $R = P + Q$ 的定义是：画一条穿过 $P$ 和 $Q$ 的直线，找到它与曲线的第三个交点 $S' = (x_{S'}, y_{S'})$，然后关于 $x$ 轴取对称点：$R = (x_{S'}, -y_{S'})$。\n\n首先，计算穿过点 $P = (-2, 3)$ 和 $Q = (2, 5)$ 的直线的斜率：\n$$\nm = \\frac{y_{Q} - y_{P}}{x_{Q} - x_{P}} = \\frac{5 - 3}{2 - (-2)} = \\frac{2}{4} = \\frac{1}{2}.\n$$\n该直线的方程为\n$$\ny - y_{P} = m(x - x_{P}) \\quad \\Rightarrow \\quad y = \\frac{1}{2}(x + 2) + 3 = \\frac{1}{2}x + 4.\n$$\n\n为了找到第三个交点 $S'$，将 $y = \\frac{1}{2}x + 4$ 代入曲线方程：\n$$\n\\left(\\frac{1}{2}x + 4\\right)^{2} = x^{3} + 17,\n$$\n$$\n\\frac{1}{4}x^{2} + 4x + 16 = x^{3} + 17,\n$$\n$$\n0 = x^{3} - \\frac{1}{4}x^{2} - 4x + 1.\n$$\n设三个交点的 $x$ 坐标为 $x = -2$，$x = 2$ 和 $x = x_{S'}$。这是一个首一三次方程，因此根据韦达定理，所有根的和等于 $x^{2}$ 项系数的相反数：\n$$\n(-2) + 2 + x_{S'} = \\frac{1}{4} \\quad \\Rightarrow \\quad x_{S'} = \\frac{1}{4}.\n$$\n然后\n$$\ny_{S'} = \\frac{1}{2}x_{S'} + 4 = \\frac{1}{2}\\cdot\\frac{1}{4} + 4 = \\frac{1}{8} + 4 = \\frac{33}{8}.\n$$\n关于 $x$ 轴取对称点得到\n$$\nR = (x_{S'}, -y_{S'}) = \\left(\\frac{1}{4}, -\\frac{33}{8}\\right).\n$$\n作为检验，代入曲线方程：\n$$\n\\left(-\\frac{33}{8}\\right)^{2} = \\frac{1089}{64}, \\quad \\left(\\frac{1}{4}\\right)^{3} + 17 = \\frac{1}{64} + 17 = \\frac{1089}{64},\n$$\n两者吻合，确认点 $R$ 在曲线上。因此，$R = P + Q$ 是有序对 $\\left(\\frac{1}{4}, -\\frac{33}{8}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{4} -\\frac{33}{8}\\end{pmatrix}}$$", "id": "2167288"}, {"introduction": "在掌握了两个不同点的加法后，我们自然会思考特殊情况：一个点如何与自身相加？这需要用到曲线在该点的切线。此练习 [@problem_id:2167303] 聚焦于一个更为特殊的情形——当切线为垂直线时。这些点被称为“二阶挠点”，在椭圆曲线的算术理论中至关重要，它们与群的单位元，即无穷远点 $\\mathcal{O}$，有着深刻的联系。", "problem": "椭圆曲线 $E$ 是平面上满足形如 $y^2 = x^3 + ax + b$ 方程的点 $(x,y)$ 的集合，外加一个称为无穷远点（记为 $\\mathcal{O}$）的特殊点。曲线上的所有点构成一个加法群，其加法运算是几何定义的。\n\n曲线上两个不同点 $P$ 和 $Q$ 的和定义如下：通过 $P$ 和 $Q$ 的直线与曲线相交于第三点 $R$。和 $P+Q$ 则是点 $R$ 关于 x 轴的反射点。为了计算一个点与自身的和 $P+P$（也写作 $2P$），我们使用曲线在点 $P$ 处的切线。该切线与曲线相交于第二点 $R'$。结果 $2P$ 是点 $R'$ 关于 x 轴的反射点。\n\n无穷远点 $\\mathcal{O}$ 是这个群的单位元，意味着对于任何点 $P$ 都有 $P + \\mathcal{O} = P$。从几何上看，任何垂直线都被认为通过无穷远点 $\\mathcal{O}$。\n\n考虑由方程 $$y^2 = x^3 - 4x$$ 定义的特定椭圆曲线 $E$。\n请找出该曲线上所有切线为垂直线的有限点 $P$（即非 $\\mathcal{O}$ 的点）的完整集合，并确定对任意这样的点，群运算 $P+P$ 的结果。\n\nA. 点的集合是 $\\{(0,0), (2,0), (-2,0)\\}$，且对于任意这样的点 $P$，$P+P = \\mathcal{O}$。\n\nB. 点的集合是 $\\{(0,0), (2,0), (-2,0)\\}$，且对于任意这样的点 $P$，$P+P = (0,0)$。\n\nC. 点的集合是 $\\{(2/\\sqrt{3}, 0), (-2/\\sqrt{3}, 0)\\}$，且对于任意这样的点 $P$，$P+P = \\mathcal{O}$。\n\nD. 唯一的这样的点是 $(0,0)$，且对于此点 $P$，$P+P = \\mathcal{O}$。\n\nE. 点的集合是 $\\{(0,0), (2,0), (-2,0)\\}$，但对于这些点，运算 $P+P$ 未定义。", "solution": "我们给定由 $y^{2} = x^{3} - 4x$ 定义的椭圆曲线 $E$。该曲线上一点 $P = (x,y)$ 处的切线是垂直的，当且仅当斜率 $\\frac{dy}{dx}$ 未定义（无穷大）时。对于一个由隐函数 $F(x,y) = 0$ 定义的曲线，其斜率满足\n$$\n\\frac{dy}{dx} = -\\frac{F_{x}}{F_{y}}.\n$$\n等价地，我们可以对 $y^{2} = x^{3} - 4x$ 进行隐式求导：\n$$\n2y\\,\\frac{dy}{dx} = 3x^{2} - 4,\n$$\n所以\n$$\n\\frac{dy}{dx} = \\frac{3x^{2} - 4}{2y}.\n$$\n当分母为零且分子不为零时，出现垂直切线，即\n$$\ny = 0 \\quad \\text{and} \\quad 3x^{2} - 4 \\neq 0.\n$$\n现在我们找出 $E$ 上所有 $y=0$ 的点。将 $y=0$ 代入曲线方程得到\n$$\n0 = x^{3} - 4x = x(x^{2} - 4) = x(x-2)(x+2),\n$$\n所以\n$$\nx \\in \\{0,\\,2,\\,-2\\}.\n$$\n我们验证在这些 $x$ 值下分子不为零：\n$$\n3x^{2} - 4 =\n\\begin{cases}\n-4  \\text{if } x=0,\\\\\n8  \\text{if } x=2,\\\\\n8  \\text{if } x=-2,\n\\end{cases}\n$$\n它们都不为零。因此，切线在以下点处是垂直的：\n$$\n(0,0),\\quad (2,0),\\quad (-2,0).\n$$\n\n接下来，我们确定这些点的 $P+P$。在短 Weierstraß 模型上，一个点 $(x,y)$ 的逆元是 $(x,-y)$。因此，若 $y=0$，则 $(x,0) = (x,-0)$ 等于其自身的逆元，所以 $P = -P$。因此，\n$$\nP + P = \\mathcal{O}.\n$$\n等价地，根据几何规则，在一个有垂直切线的点上，切线是垂直的，并被认为通过 $\\mathcal{O}$；因此与曲线的“第三个交点”是 $\\mathcal{O}$，将 $\\mathcal{O}$ 关于 x 轴反射仍然得到 $\\mathcal{O}$，因此 $2P = \\mathcal{O}$。\n\n因此，具有垂直切线的有限点的完整集合是 $\\{(0,0),(2,0),(-2,0)\\}$，并且对于任意这样的点 $P$，都有 $P+P = \\mathcal{O}$。这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2167303"}, {"introduction": "从具体计算到抽象理论是数学研究的必经之路。虽然短Weierstrass形式在计算上很方便，但真正的理解需要我们能够处理更具一般性的情形。这项高级练习 [@problem_id:3026549] 将指导你从第一性原理出发，为一般Weierstrass方程推导点加法的代数公式。这个过程将几何直观与严谨的代数推导联系起来，是研究生阶段研究必备的核心技能。", "problem": "设 $K$ 是一个域，$E/K$ 是一条由一般 Weierstrass 方程给出的非奇异椭圆曲线\n$$\ny^{2}+a_{1}xy+a_{3}y=x^{3}+a_{2}x^{2}+a_{4}x+a_{6},\n$$\n其系数 $a_{1},a_{2},a_{3},a_{4},a_{6}\\in K$。$E(K)$ 上的群法则是通过弦切构造定义的：对于点 $P,Q\\in E(K)$，经过 $P$ 和 $Q$ 的直线（当 $P=Q$ 时为 $E$ 在 $P$ 点的切线）与 $E$ 相交于第三点 $R$，并且 $P+Q$ 是 $R$ 在 $E$ 上的对合 $[-1]$ 下的像，该对合固定 $x$ 坐标并相对于群法则取反。\n\n从这些定义以及“首一多项式的所有根之和等于其二次项系数的相反数”这一基本代数事实（Viète 关系）出发，在 $K(x,y)$ 中进行以下推导：\n\n1. 证明对于固定的 $x\\in K$，$E$ 的方程是关于 $y$ 的二次方程，它有两个 $y$ 的解，其和为 $-(a_{1}x+a_{3})$，并由此推导出反射（群法则的求逆映射）为\n$$\n[-1](x,y)=(x,-y-a_{1}x-a_{3}).\n$$\n\n2. 对于 $x_{1}\\neq x_{2}$ 的不同点 $P=(x_{1},y_{1})$ 和 $Q=(x_{2},y_{2})$，设其割线方程为 $y=\\lambda x+\\nu$。用 $(x_{1},y_{1}),(x_{2},y_{2})$ 表示 $\\lambda$ 和 $\\nu$，并将 $y=\\lambda x+\\nu$ 代入 Weierstrass 方程，得到一个关于 $x$ 的三次方程，其三个根为 $x_{1},x_{2},x_{R}$，其中 $R$ 是第三个交点。使用 Viète 关系，用 $\\lambda,a_{1},a_{2},x_{1},x_{2}$ 表示 $x_{R}$，并因此确定 $P+Q$ 的 $x$ 坐标。\n\n3. 使用 Weierstrass 方程的隐式微分，确定在点 $P=(x_{1},y_{1})$ （其中 $2y_{1}+a_{1}x_{1}+a_{3}\\neq 0$）处的切线斜率，从而得到纯粹用 $x_{1},y_{1}$ 和系数 $a_{i}$ 表示的倍点斜率 $\\lambda_{\\mathrm{tan}}$。\n\n在您的推导中，您可以假设所有提到的分母在 $K$ 中都是非零的。作为您的最终答案，请提供一个关于 $P+Q$ 的 $x$ 坐标的单一闭式解析表达式，用 $x_{1},y_{1},x_{2},y_{2}$ 和系数 $a_{1},a_{2}$ 来表示，并适用于 $x_{1}\\neq x_{2}$ 的情况。不需要进行数值计算，也无需四舍五入。请将您的最终答案表示为由所指示的变量和参数组成的单个简化表达式。", "solution": "问题陈述已经过验证，被认为是数论和代数几何领域中一个提法恰当、有科学依据的问题。我们可以开始对所要求的量进行形式化推导。\n\n椭圆曲线 $E$ 由域 $K$ 上的一般 Weierstrass 方程给出：\n$$\ny^{2}+a_{1}xy+a_{3}y = x^{3}+a_{2}x^{2}+a_{4}x+a_{6}\n$$\n其中 $a_{1}, a_{2}, a_{3}, a_{4}, a_{6} \\in K$。\n\n**1. 求逆映射的推导**\n\n群法则的求逆映射，记为 $[-1]$，是将点 $R$ 映射到和 $P+Q$ 的反射。从几何上看，点 $P=(x,y)$ 的逆元，记为 $-P$，是曲线上具有相同 $x$ 坐标的第二个点，使得通过 $P$ 和 $-P$ 的直线是一条垂直线，它与曲线相交于无穷远点 $\\mathcal{O}$。和 $P+(-P)$ 则是 $\\mathcal{O}$ 的反射，即 $\\mathcal{O}$ 本身，也就是群的单位元。\n\n为了找到 $-P$ 的坐标，我们对固定的 $x$ 值重新排列 Weierstrass 方程，使其成为一个关于变量 $y$ 的二次方程：\n$$\ny^{2} + (a_{1}x+a_{3})y - (x^{3}+a_{2}x^{2}+a_{4}x+a_{6}) = 0.\n$$\n这是一个关于 $y$ 的首一二次方程，形式为 $y^2+By+C=0$，其中 $B = a_1x+a_3$。对于一个给定的 $x \\in K$（假定有解），存在两个 $y$ 的解，记为 $y_1$ 和 $y_2$，它们对应于曲线上具有该 $x$ 坐标的两个点的 $y$ 坐标。根据 Viète 公式，这个二次方程的根之和等于一次项系数的相反数。因此，$y$ 解的和为：\n$$\ny_{1} + y_{2} = -(a_{1}x+a_{3}).\n$$\n如果一个点是 $(x,y)$，它在曲线上的垂直伙伴是 $(x,y')$，其中 $y+y' = -(a_{1}x+a_{3})$。这得到 $y' = -y - a_{1}x - a_{3}$。求逆映射 $[-1]$ 正是这个映射。因此，对于点 $(x,y) \\in E(K)$，它在求逆映射下的像为：\n$$\n[-1](x,y) = (x, -y - a_{1}x - a_{3}).\n$$\n这完成了推导的第一部分。\n\n**2. 不同点加法公式的推导**\n\n设 $P=(x_{1}, y_{1})$ 和 $Q=(x_{2}, y_{2})$ 是曲线 $E(K)$ 上两个 $x_{1} \\neq x_{2}$ 的不同点。通过 $P$ 和 $Q$ 的直线，即割线，由方程 $y=\\lambda x+\\nu$ 给出。\n\n斜率 $\\lambda$ 由 $P$ 和 $Q$ 的坐标确定：\n$$\n\\lambda = \\frac{y_{2}-y_{1}}{x_{2}-x_{1}}.\n$$\n$y$ 轴截距 $\\nu$ 可以通过代入任一点的坐标（例如 $P$）来求得：\n$$\ny_{1} = \\lambda x_{1} + \\nu \\implies \\nu = y_{1} - \\lambda x_{1}.\n$$\n为了找到第三个交点 $R = (x_{R}, y_{R})$，我们将直线方程 $y=\\lambda x+\\nu$ 代入 Weierstrass 方程：\n$$\n(\\lambda x+\\nu)^{2} + a_{1}x(\\lambda x+\\nu) + a_{3}(\\lambda x+\\nu) = x^{3}+a_{2}x^{2}+a_{4}x+a_{6}.\n$$\n我们展开各项，并将方程重新整理成一个关于 $x$ 的三次多项式：\n$$\n\\lambda^{2}x^{2} + 2\\lambda\\nu x + \\nu^{2} + a_{1}\\lambda x^{2} + a_{1}\\nu x + a_{3}\\lambda x + a_{3}\\nu = x^{3}+a_{2}x^{2}+a_{4}x+a_{6}.\n$$\n将所有项移到一边，得到一个首一三次方程，其根是交点的 $x$ 坐标：\n$$\nx^{3} + (a_{2} - a_{1}\\lambda - \\lambda^{2})x^{2} + (a_{4} - a_{1}\\nu - a_{3}\\lambda - 2\\lambda\\nu)x + (a_{6} - \\nu^{2} - a_{3}\\nu) = 0.\n$$\n这个三次方程的三个根是 $x_{1}$、$x_{2}$ 和 $x_{R}$。应用关于根之和的 Viète 关系，我们发现：\n$$\nx_{1} + x_{2} + x_{R} = -(a_{2} - a_{1}\\lambda - \\lambda^{2}) = \\lambda^{2} + a_{1}\\lambda - a_{2}.\n$$\n由此，我们可以解出第三个交点的 $x$ 坐标 $x_{R}$：\n$$\nx_{R} = \\lambda^{2} + a_{1}\\lambda - a_{2} - x_{1} - x_{2}.\n$$\n根据群法则的定义，和 $P+Q$ 是 $R$ 在映射 $[-1]$ 下的反射。如第 1 部分所示，此映射固定 $x$ 坐标。设 $P+Q = (x_{P+Q}, y_{P+Q})$。那么，$x_{P+Q} = x_{R}$。因此，$P+Q$ 的 $x$ 坐标是：\n$$\nx_{P+Q} = \\lambda^{2} + a_{1}\\lambda - a_{2} - x_{1} - x_{2}.\n$$\n将用 $P$ 和 $Q$ 的坐标表示的 $\\lambda$ 的表达式代入，我们得到和的 $x$ 坐标的最终公式：\n$$\nx_{P+Q} = \\left(\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\right)^{2} + a_{1}\\left(\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\right) - a_{2} - x_{1} - x_{2}.\n$$\n这就是所要求的表达式，在 $x_1 \\neq x_2$ 时有效。\n\n**3. 倍点切线斜率的推导**\n\n为了求出曲线上一点 $P=(x_{1}, y_{1})$ 处的切线斜率，我们对 Weierstrass 方程关于 $x$ 进行隐式微分。设 $y' = \\frac{dy}{dx}$。方程为 $F(x,y) = y^{2}+a_{1}xy+a_{3}y - x^{3}-a_{2}x^{2}-a_{4}x-a_{6}=0$。微分得到：\n$$\n\\frac{dF}{dx} = \\frac{\\partial F}{\\partial x} + \\frac{\\partial F}{\\partial y}\\frac{dy}{dx} = 0.\n$$\n计算偏导数：\n$$\n\\frac{\\partial F}{\\partial x} = a_{1}y - 3x^{2} - 2a_{2}x - a_{4}\n$$\n$$\n\\frac{\\partial F}{\\partial y} = 2y + a_{1}x + a_{3}\n$$\n导数 $\\frac{dy}{dx}$ 于是为：\n$$\n\\frac{dy}{dx} = -\\frac{\\partial F/\\partial x}{\\partial F/\\partial y} = -\\frac{a_{1}y - 3x^{2} - 2a_{2}x - a_{4}}{2y + a_{1}x + a_{3}} = \\frac{3x^{2} + 2a_{2}x + a_{4} - a_{1}y}{2y + a_{1}x + a_{3}}.\n$$\n在点 $P=(x_{1}, y_{1})$ 处的切线斜率 $\\lambda_{\\mathrm{tan}}$ 是此导数在该点的值：\n$$\n\\lambda_{\\mathrm{tan}} = \\frac{3x_{1}^{2} + 2a_{2}x_{1} + a_{4} - a_{1}y_{1}}{2y_{1} + a_{1}x_{1} + a_{3}}.\n$$\n该表达式在分母非零，即 $2y_{1} + a_{1}x_{1} + a_{3} \\neq 0$ 的情况下有效。这个条件对应于 $P$ 点的切线不是垂直的。对于倍点运算 $2P = P+P$，这个斜率 $\\lambda_{\\mathrm{tan}}$ 将在加法公式中代替割线斜率 $\\lambda$ 使用。", "answer": "$$\n\\boxed{\\left(\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\right)^{2} + a_{1}\\left(\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\right) - a_{2} - x_{1} - x_{2}}\n$$", "id": "3026549"}]}