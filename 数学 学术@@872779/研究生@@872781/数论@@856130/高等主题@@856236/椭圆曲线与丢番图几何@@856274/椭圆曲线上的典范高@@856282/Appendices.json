{"hands_on_practices": [{"introduction": "要掌握典范高，第一步是学会计算其局部构件。这个练习将引导你处理最基本的情况：在良约化素数处的局部高。通过一个具体例子[@problem_id:3025332]，你将应用标准公式，将点的 $p$-进赋值直接与局部高联系起来，从而为更复杂的计算打下坚实基础。", "problem": "设 $p$ 为一个奇素数，并考虑 $p$-adic 数域 $\\mathbb{Q}_{p}$ 上的椭圆曲线 $E$，其由积分短 Weierstrass 方程给出：\n$$\ny^2 = x^3 - x.\n$$\n设 $v_{p}(\\,\\cdot\\,)$ 表示 $\\mathbb{Q}_{p}$ 上的 $p$-adic 赋值，其归一化使得 $v_{p}(p)=1$。设 $|\\,\\cdot\\,|_{p}$ 表示由 $|z|_{p} = p^{-v_{p}(z)}$ 定义的相关联的 $p$-adic 绝对值。$E$ 的判别式为 $\\Delta_{E}=64$，因此 $E$ 在每个奇素数 $p$ 处都有好约化。\n\n设 $P \\in E(\\mathbb{Q}_{p})$ 是一个点，其坐标满足 $v_{p}(x(P))=-2$ 和 $v_{p}(y(P))=-3$。（这些赋值与曲线方程是一致的，因为 $2v_p(y(P)) = v_p(y(P)^2) = v_p(x(P)^3 - x(P))$，且当 $v_{p}(x(P))  0$ 时，$v_p(x(P)^2-1) = 2v_p(x(P))$，因此 $2v_p(y(P)) = v_p(x(P)) + 2v_p(x(P)) = 3v_p(x(P))$。代入 $v_p(x(P))=-2$，我们得到 $2v_p(y(P)) = -6$，所以 $v_p(y(P))=-3$。）\n\n设 $\\lambda_{p}(P)$ 表示与 $E$ 上的典范高相关联的、$P$ 在 $p$ 处的局部 Néron 高，此处的归一化为标准归一化，即全局典范高分解为所有位上局部贡献之和，且非阿基米德贡献使用上述定义的绝对值 $|\\,\\cdot\\,|_{p}$。\n\n从好约化位上的局部 Néron 高的基本性质以及形式群参数在原点处的行为出发，计算 $\\lambda_{p}(P)$ 作为 $p$ 的函数的显式闭式表达式。\n\n你的最终答案必须是单个闭式符号表达式。请使用自然对数，不要进行舍入或近似计算。", "solution": "问题要求计算在 $\\mathbb{Q}_{p}$ 上由 $y^{2} = x^{3} - x$ 给出的椭圆曲线 $E$ 上的一个特定点 $P$ 的局部 Néron 高 $\\lambda_{p}(P)$。\n\n首先，我们验证曲线和点的性质。椭圆曲线为 $E: y^{2} = x^{3} - x$。其判别式为 $\\Delta = -16(4A^3+27B^2)$。对于 $A=-1$ 和 $B=0$，$\\Delta = -16(4(-1)^3) = 64$。由于 $p$ 是一个奇素数，$v_{p}(\\Delta) = v_{p}(64) = v_p(2^6) = 0$。这意味着给定的 Weierstrass 方程在 $p$ 处是极小的，并且 $E$ 在 $p$ 处有好约化。\n\n点 $P \\in E(\\mathbb{Q}_{p})$ 的坐标满足 $v_{p}(x(P)) = -2$ 和 $v_{p}(y(P)) = -3$。如果 $E$ 上的一个点 $(x,y)$ 的坐标不都是整的，那么它就位于模 $p$ 约化映射的核中，这由赋值决定。具体来说，如果 $v_p(x)  0$，则必然有 $v_p(y)  0$，并且该点约化为约化曲线 $\\tilde{E}(\\mathbb{F}_p)$ 上的单位元 $\\tilde{O}$。这样的点构成了子群 $E_1(\\mathbb{Q}_p)$。因此，条件 $v_p(x(P)) = -2  0$ 意味着 $P \\in E_1(\\mathbb{Q}_p)$。这也可以通过使用形式群参数 $z = -x/y$ 看出。对于点 $P$，其形式群参数的赋值为 $v_{p}(z(P)) = v_{p}(-x(P)/y(P)) = v_{p}(x(P)) - v_{p}(y(P)) = -2 - (-3) = 1$。由于 $v_p(z(P)) > 0$，$P$ 位于形式群中，这证实了 $P \\in E_1(\\mathbb{Q}_p)$。\n\n$E(\\mathbb{Q})$ 上的典范高 $\\hat{h}(P)$ 分解为 $\\mathbb{Q}$ 的所有位上局部高贡献之和：\n$$\n\\hat{h}(P) = \\lambda_{\\infty}(P) + \\sum_{q \\text{ prime}} \\lambda_{q}(P)\n$$\n我们需要计算分量 $\\lambda_{p}(P)$。对于一个好约化素数 $q$，其中 $E$ 由一个极小 Weierstrass 方程给出，局部 Néron 高由一个公认的公式给出（例如，参见 J.H. Silverman 的《The Arithmetic of Elliptic Curves》，第八章，定理 5.6）：\n$$\n\\lambda_{q}(P) = \\frac{1}{2} \\log \\max\\{1, |x(P)|_{q}\\}\n$$\n问题指明 $p$ 是一个奇素数，对于该素数，曲线有好约化且给定的方程是极小的。因此，此公式适用。\n\n我们已知 $v_{p}(x(P)) = -2$。$p$-adic 绝对值定义为 $|z|_{p} = p^{-v_{p}(z)}$。\n将其应用于 $x(P)$：\n$$\n|x(P)|_{p} = p^{-v_{p}(x(P))} = p^{-(-2)} = p^{2}\n$$\n由于 $p$ 是一个奇素数，所以 $p \\ge 3$，这意味着 $p^{2} \\ge 9 > 1$。\n因此，$\\max\\{1, |x(P)|_{p}\\} = |x(P)|_{p} = p^{2}$。\n\n将此代入局部高的公式中：\n$$\n\\lambda_{p}(P) = \\frac{1}{2} \\log(p^{2})\n$$\n使用对数性质 $\\log(a^{b}) = b \\log(a)$，我们得到：\n$$\n\\lambda_{p}(P) = \\frac{1}{2} (2 \\log p) = \\log p\n$$\n\n为了完全严谨并按要求从更基本的性质来证明这一点，我们可以使用典范高作为和的表达式。典范高 $\\hat{h}(P)$ 可以通过伸缩求和从 Weil 高 $h_x(P) = \\sum_v \\log\\max(1, |x(P)|_v)$ 构建：\n$$\n\\hat{h}(P) = \\frac{1}{2}h_x(P) - \\frac{1}{2}\\sum_{n=0}^{\\infty} \\frac{1}{4^{n+1}} \\left( h_x(2^{n+1}P) - 4h_x(2^n P) \\right)\n$$\n局部高 $\\lambda_p(P)$ 是这个表达式在位 $p$ 上的分量。需要仔细评估项 $h_x(2Q) - 4h_x(Q)$ 的局部贡献。设 $Q=(x,y)$ 且 $|x|_p > 1$。设 $x=X/Z$ 且 $|X|_p > |Z|_p$。我们可以归一化使得 $|Z|_p=1$，则 $|X|_p = |x|_p > 1$。对 $h_x(Q)$ 的局部贡献是 $\\log|X|_p = \\log|x|_p$。对 $4h_x(Q)$ 的局部贡献是 $4\\log|x|_p$。倍点公式给出 $x(2Q) = \\frac{(x^2+1)^2}{4x(x^2-1)}$。在齐次坐标中，这是 $x(2Q) = \\frac{(X^2+Z^2)^2}{4XZ(X^2-Z^2)}$。\n对 $h_x(2Q)$ 的局部贡献是 $\\log\\max(|(X^2+Z^2)^2|_p, |4XZ(X^2-Z^2)|_p)$。\n对于我们的点 $P$，设 $x=x(P)$，所以 $|x|_p = p^2$。我们有 $|x^2|_p = p^4$。\n因此 $|x^2+1|_p = \\max(|x^2|_p, 1) = p^4$，所以 $|(x^2+1)^2|_p = p^8$。\n且 $|4x(x^2-1)|_p = |4|_p|x|_p|x^2-1|_p = 1 \\cdot p^2 \\cdot p^4 = p^6$。\n对 $h_x(2P)$ 的局部贡献是 $\\log\\max(p^8, p^6) = \\log(p^8) = 8\\log p$。\n对 $4h_x(P)$ 的局部贡献是 $4\\log\\max(1, |x|_p) = 4\\log(p^2) = 8\\log p$。\n对 $h_x(2P)-4h_x(P)$ 的局部贡献是 $8\\log p - 8\\log p = 0$。\n类似的论证表明，由于 $v_p(x(2^n P)) = -2$，这对所有 $2^n P$ 都成立。因此，$\\lambda_p(P)$ 的整个求和项为零。\n这剩下 $\\lambda_p(P) = \\frac{1}{2}\\log\\max(1, |x(P)|_p)$，这是我们使用的第一个公式。该推导证实了它的适用性。\n\n最终值为 $\\lambda_{p}(P) = \\log p$。", "answer": "$$\n\\boxed{\\ln(p)}\n$$", "id": "3025332"}, {"introduction": "在掌握了良约化的情况后，我们来挑战一个更复杂的场景：在分裂乘法约化素数处的局部高。这种情况需要借助 Tate 的一致化理论，将局部高与泰特参数 $q$ 和点的参数 $u$ 的 $p$-进赋值联系起来。通过这个练习[@problem_id:3025324]，你将学会如何运用伯努利多项式 (Bernoulli polynomial) 来计算该局部贡献，从而深入理解典范高在不同约化类型下的行为。", "problem": "设 $E/\\mathbb{Q}$ 为一条椭圆曲线，在有理素数 $p=11$ 处具有可分裂乘性约化。假设在 $p$ 处的局部一致化由一个参数为 $q \\in \\mathbb{Q}_{11}$ 的 Tate 曲线给出，使得 $v_{11}(q)=7$，其中 $v_{11}$ 表示由 $v_{11}(11)=1$ 归一化的 $11$-adic 赋值。设点 $P \\in E(\\mathbb{Q})$ 在 Tate 一致化 $E_q(\\mathbb{Q}_{11}) \\cong \\mathbb{Q}_{11}^{\\times}/q^{\\mathbb{Z}}$ 下，对应于一个参数 $u(P) \\in \\mathbb{Q}_{11}^{\\times}$，其满足 $v_{11}(u(P))=-3$。\n\n使用 Néron–Tate 典范高 $\\hat{h}(P)$ 分解为局部高之和的方法，以及在可分裂乘性位上的 Tate 一致化，计算对 $\\hat{h}(P)$ 的 $11$-adic 局部贡献 $\\lambda_{11}(P)$，将其表示为第二 Bernoulli 多项式 $B_{2}(t)=t^{2}-t+\\frac{1}{6}$ 以及赋值数据 $v_{11}(q)$、$v_{11}(u(P))$ 的形式。你的最终答案必须是包含 $\\ln(11)$ 的单个闭式表达式，且不进行四舍五入。", "solution": "问题要求计算椭圆曲线 $E/\\mathbb{Q}$ 上有理点 $P$ 的 Néron–Tate 典范高 $\\hat{h}(P)$ 的 $11$-adic 局部贡献 $\\lambda_{11}(P)$。\n\n首先，我们回顾 Néron-Tate 典范高的基本结构。对于点 $P \\in E(\\mathbb{Q})$，其典范高 $\\hat{h}(P)$ 由在 $\\mathbb{Q}$ 的所有位 $v$ 上的局部贡献（局部高或 Néron 函数）$\\lambda_v(P)$ 之和给出：\n$$\n\\hat{h}(P) = \\sum_{v} \\lambda_v(P) = \\lambda_{\\infty}(P) + \\sum_{p \\text{ prime}} \\lambda_p(P)\n$$\n\n问题指明椭圆曲线 $E$ 在素数 $p=11$ 处具有可分裂乘性约化。在这样一个位上，曲线的 $\\mathbb{Q}_{11}$-点群同构于局部域 $\\mathbb{Q}_{11}$ 的乘法群与由 Tate 参数 $q$ 生成的循环子群的商群。这就是 Tate 一致化：\n$$\nE(\\mathbb{Q}_{11}) \\cong \\mathbb{Q}_{11}^{\\times} / q^{\\mathbb{Z}}\n$$\n这里，$q \\in \\mathbb{Q}_{11}$ 是一个 $11$-adic 赋值 $v_{11}(q) > 0$ 的元素。我们已知 $v_{11}(q)=7$。一个点 $P \\in E(\\mathbb{Q}) \\subset E(\\mathbb{Q}_{11})$ 对应于一个元素 $u(P) \\in \\mathbb{Q}_{11}^{\\times}$，该元素在相差 $q$ 的整数次幂的乘法下是唯一确定的。我们已知 $v_{11}(u(P)) = -3$。\n\n局部高 $\\lambda_{11}(P)$ 的计算依赖于从该一致化导出的一个显式公式。对于可分裂乘性约化的位 $v$（此处用素数 $p$ 表示），其局部高的一个标准公式通过第二 Bernoulli 多项式 $B_2(t) = t^2-t+\\frac{1}{6}$ 将 $\\lambda_p(P)$ 与 $q$ 和 $u(P)$ 的赋值联系起来。该公式在标准教材如 Hindry 和 Silverman 的《Diophantine Geometry》中给出，形式如下：\n$$\n\\lambda_p(P) = \\frac{1}{2} v_p(q) \\ln(p) \\cdot B_2\\left( \\left\\{ \\frac{v_p(u(P))}{v_p(q)} \\right\\} \\right)\n$$\n其中 $\\{x\\} = x - \\lfloor x \\rfloor$ 表示实数 $x$ 的小数部分。\n\n值得注意的是，全局高分解为局部分量的方式不是唯一的。文献中存在不同的局部高归一化方法。上述公式是一个常见的选择。然而，典范高 $\\hat{h}(P)$ 具有性质 $\\hat{h}(O)=0$，其中 $O$ 是曲线的单位元点。通常选择一个典范分解来尽可能地在局部层面上反映这一点，例如要求对所有有限素数 $p$ 都有 $\\lambda_p(O)=0$。\n\n我们使用给定的公式来计算单位元点 $O$ 的高。点 $O$ 对应于 $\\mathbb{Q}_{11}^{\\times}/q^{\\mathbb{Z}}$ 中的单位元，可以由 $u(O)=1$ 表示。因此，$v_{11}(u(O))=v_{11}(1)=0$。Bernoulli 多项式的自变量变为 $\\{\\frac{0}{7}\\} = 0$。\n$$\n\\lambda_{11}(O) = \\frac{1}{2} v_{11}(q) \\ln(11) \\cdot B_2(0)\n$$\n因为 $B_2(0) = 0^2-0+\\frac{1}{6} = \\frac{1}{6}$，我们得到\n$$\n\\lambda_{11}(O) = \\frac{1}{2} \\cdot 7 \\cdot \\ln(11) \\cdot \\frac{1}{6} = \\frac{7}{12}\\ln(11)\n$$\n这是非零的。“局部贡献”这个术语通常意味着一个唯一的、典范的选择。最自然的选择是在单位元处归一化为零。因此，我们将计算归一化的局部高 $\\lambda_{11}^{\\text{norm}}(P) = \\lambda_{11}(P) - \\lambda_{11}(O)$，并假设这就是问题所要求的量。\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{1}{2} v_{11}(q) \\ln(11) \\left( B_2\\left( \\left\\{ \\frac{v_{11}(u(P))}{v_{11}(q)} \\right\\} \\right) - B_2(0) \\right)\n$$\n现在我们应用问题中给出的数据：\n- $p=11$\n- $v_{11}(q) = 7$\n- $v_{11}(u(P)) = -3$\n\n首先，我们计算点 $P$ 对应的 Bernoulli 多项式的自变量：\n$$\n\\frac{v_{11}(u(P))}{v_{11}(q)} = \\frac{-3}{7}\n$$\n小数部分是：\n$$\n\\left\\{ \\frac{-3}{7} \\right\\} = \\frac{-3}{7} - \\left\\lfloor \\frac{-3}{7} \\right\\rfloor = \\frac{-3}{7} - (-1) = \\frac{4}{7}\n$$\n接下来，我们计算 $B_2$ 在此值处的取值：\n$$\nB_2\\left(\\frac{4}{7}\\right) = \\left(\\frac{4}{7}\\right)^2 - \\frac{4}{7} + \\frac{1}{6} = \\frac{16}{49} - \\frac{4}{7} + \\frac{1}{6}\n$$\n为了将这些分数相加，我们使用公分母 $49 \\times 6 = 294$：\n$$\nB_2\\left(\\frac{4}{7}\\right) = \\frac{16 \\cdot 6}{294} - \\frac{4 \\cdot 42}{294} + \\frac{49}{294} = \\frac{96 - 168 + 49}{294} = \\frac{-23}{294}\n$$\n现在我们可以计算归一化的局部高：\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{1}{2} \\cdot 7 \\cdot \\ln(11) \\left( -\\frac{23}{294} - \\frac{1}{6} \\right)\n$$\n我们将 $\\frac{1}{6}$ 转换为分母为 $294$ 的分数：$\\frac{1}{6} = \\frac{49}{294}$。\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{7}{2} \\ln(11) \\left( -\\frac{23}{294} - \\frac{49}{294} \\right) = \\frac{7}{2} \\ln(11) \\left( -\\frac{72}{294} \\right)\n$$\n我们化简这个表达式：\n$$\n\\lambda_{11}^{\\text{norm}}(P) = -\\frac{7 \\cdot 72}{2 \\cdot 294} \\ln(11)\n$$\n由于 $294 = 6 \\times 49 = 6 \\times 7^2$，我们可以化简：\n$$\n\\lambda_{11}^{\\text{norm}}(P) = -\\frac{7 \\cdot 72}{2 \\cdot 6 \\cdot 49} \\ln(11) = -\\frac{72}{2 \\cdot 6 \\cdot 7} \\ln(11) = -\\frac{72}{84} \\ln(11)\n$$\n最后，我们通过将分子和分母除以它们的最大公约数 $12$ 来约分分数 $\\frac{72}{84}$：\n$$\n\\frac{72}{84} = \\frac{6 \\times 12}{7 \\times 12} = \\frac{6}{7}\n$$\n因此，归一化的局部贡献是：\n$$\n\\lambda_{11}(P) = -\\frac{6}{7} \\ln(11)\n$$\n这就是我们的最终答案，一个符合要求的闭式表达式。", "answer": "$$\\boxed{-\\frac{6}{7}\\ln(11)}$$", "id": "3025324"}, {"introduction": "计算单个局部高是重要的第一步，但最终目标是计算全局典范高 $\\hat{h}(P)$。这个练习[@problem_id:3025329]将带你从局部转向全局，要求你设计一个计算全局高的完整算法策略。你需要考虑如何识别所有非零局部贡献的来源、如何处理不同约化类型（良、乘法、加法）的贡献，以及如何严格控制误差以达到预设的精度，这是一个综合性的问题，旨在检验你对典范高计算理论和实践的整体把握。", "problem": "设 $E/\\mathbb{Q}$ 是一个由全局最小Weierstrass方程给出的椭圆曲线，其判别式为 $\\Delta \\in \\mathbb{Z}$，并设 $P \\in E(\\mathbb{Q})$ 是一个非挠点。考虑 $E(\\mathbb{Q})$ 上的典范高函数，其特征是在模去挠子群的Mordell-Weil群上的一个正定二次型，并且与倍点映射相容。我们寻求通过汇总来自 $\\mathbb{Q}$ 的完备化的贡献来近似这个高，并在每个位处严格控制截断误差，以保证达到目标精度 $\\varepsilon > 0$。\n\n哪个选项给出了一个正确且完全严格的算法策略，包括截断参数的选择和有限位的选取，以在规定的误差容限 $\\varepsilon$ 内计算该高？假设在所有位上绝对值均采用标准归一化。\n\nA. 选择位的有限集 $S$ 为所有阿基米德位以及整除 $\\Delta$ 的素数。对于 $v \\notin S$，强制将局部贡献设为零，因为好约化保证了其值为零。对于 $v \\in S$，使用任意收敛的局部级数，并在一个共同的整数 $N$ 处截断每一个级数，$N$ 要足够大，以使在一个代表性位上的几何级数尾部界限在 $\\varepsilon$ 以内，然后对所有位重用此 $N$。对 $S$ 求和得到所需的近似值。\n\nB. 选择位的有限集 $S$，使其包含唯一的阿基米德位 $\\infty$ 以及所有满足以下任一条件的素数 $p$：$E$ 在 $p$ 处有坏约化（即 $p \\mid \\Delta$），或者 $P$ 的 $x$ 坐标不是 $p$-整的（即 $|x(P)|_p > 1$）。对于 $p \\in S$ 且具有好约化以及 $|x(P)|_p \\le 1$ 的情况，局部贡献恰好为零；对于 $p \\in S$ 且具有好约化以及 $|x(P)|_p > 1$ 的情况，从 $x(P)$ 分母的 $p$-进赋值精确计算局部贡献，因此不会产生截断误差。对于 $p \\in S$ 且具有乘性约化的情况，转到 Tate 一致化，其参数 $q_p$ 满足 $|q_p|_p  1$，将局部贡献表示为一个 $q_p$ 的幂级数，其系数由约化类型一致地界定，并选择一个截断指数 $N_p$，使得对于选定的局部预算 $\\varepsilon_p > 0$，几何级数尾部界限 $\\sum_{n > N_p} C_p \\, |q_p|_p^{\\,n} \\le \\varepsilon_p$ 成立。对于 $p \\in S$ 且具有加性约化的情况，在适当缩放到最小模型后，在 $\\mathbb{Z}_p$ 上的形式群中进行计算；使用局部参数的形式群幂级数将局部贡献表示为一个快速衰减的级数，其尾部由一个关于收敛半径的可计算函数界定，并选取 $N_p$ 使得尾部 $\\le \\varepsilon_p$。在 $\\infty$ 处，使用复一致化 $E(\\mathbb{C}) \\cong \\mathbb{C}/\\Lambda$；对于某个椭圆对数 $z \\in \\mathbb{C}$，写出 $x(P) = \\wp(z)$，通过一个在 $q = e^{2\\pi i \\tau}$（其中 $\\Im(\\tau) > 0$）中的收敛 $q$-级数来表示局部贡献，并选择一个截断指数 $N_\\infty$，使得尾部界限 $\\sum_{n > N_\\infty} C_\\infty |q|^{\\,n} \\le \\varepsilon_\\infty$ 成立。分配局部容限，使得 $\\sum_{v \\in S} \\varepsilon_v \\le \\varepsilon$，并且对于局部贡献被精确计算的有限好约化位，设置 $\\varepsilon_v = 0$。对 $S$ 的求和结果给出了一个总误差至多为 $\\varepsilon$ 的近似值。\n\nC. 仅使用复一致化计算阿基米德贡献，并忽略所有有限位，因为全局最小模型强制它们为零。使用一个仅由周期比的虚部 $\\Im(\\tau)$ 决定的单一截断指数 $N$，并断定近似误差小于 $\\varepsilon$，因为阿基米德尾部占主导地位。\n\nD. 使用通过倍点映射的极限特征，计算一个大整数 $N$ 的 $h([2^N]P)$，并返回 $4^{-N} h([2^N]P)$ 作为近似值。由于二次性，误差由 $4^{-N}$ 乘以朴素高界定，因此不需要进行局部分析或逐位的截断。选择 $N$ 使得 $4^{-N} h([2^N]P) \\le \\varepsilon$ 并停止。\n\n选择正确的选项。", "solution": "题目要求一个正确且完全严格的算法策略，用于将椭圆曲线上的有理点的典范高计算到指定的精度 $\\varepsilon > 0$。\n\n首先，需要对题目陈述进行验证。\n\n**步骤1：提取已知条件**\n- $E/\\mathbb{Q}$ 是由一个全局最小Weierstrass方程给出的椭圆曲线。\n- 判别式为 $\\Delta \\in \\mathbb{Z}$。\n- $P \\in E(\\mathbb{Q})$ 是一个非挠点。\n- 典范高函数（在此记为 $\\hat{h}$）定义在 $E(\\mathbb{Q})$ 上。\n- $\\hat{h}$ 的特征是在 $E(\\mathbb{Q})/\\text{torsion}$ 上的一个正定二次型，并满足 $\\hat{h}([2]P) = 4\\hat{h}(P)$。\n- 计算任务是近似 $\\hat{h}(P)$，误差小于给定的 $\\varepsilon > 0$。\n- 该方法涉及对来自 $\\mathbb{Q}$ 的完备化（局部高）的贡献求和。\n- 算法必须严格控制截断误差。\n- 假设在 $\\mathbb{Q}$ 的所有位 $v$ 上，绝对值 $| \\cdot |_v$ 均采用标准归一化。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地植根于椭圆曲线算术，这是数论中的一个主要课题。典范高（或Néron-Tate高）的概念、其分解为局部Néron高函数（$\\hat{\\lambda}_v$）之和，以及计算这些局部贡献的方法（用于$p$-进位的Tate算法，用于阿基米德位的复一致化）都是标准且成熟的数学结果。给定的条件与Néron、Tate和Silverman发展的理论是一致的。\n- **适定性：** 该问题要求从一个选项列表中识别出正确的算法。由于计算数论提供了此类算法，该问题是适定的。存在一个正确且严格的方法，因此可以确定一个解。\n- **客观性：** 该问题以精确、技术性的数学语言陈述，没有任何模糊性、主观性或非科学性主张。\n\n**步骤3：结论与行动**\n题目陈述是有效的。它描述了计算数论中一个标准但复杂的问题。我们可以继续进行求解。\n\n点 $P \\in E(\\mathbb{Q})$ 的典范高 $\\hat{h}(P)$ 由在 $\\mathbb{Q}$ 的所有位 $v$ 上的局部高贡献之和给出：\n$$ \\hat{h}(P) = \\sum_{v \\in M_{\\mathbb{Q}}} \\hat{\\lambda}_v(P) $$\n其中 $M_{\\mathbb{Q}} = \\{\\infty\\} \\cup \\{\\text{素数 } p\\}$，而 $\\hat{\\lambda}_v$ 是位 $v$ 上的Néron局部高函数。选择的归一化方式使得该和给出典范高。\n\n局部高的一个关键性质是，对于几乎所有的素数 $p$，$\\hat{\\lambda}_p(P) = 0$。因此，该和是有限的。$\\hat{\\lambda}_v(P)$ 可能非零的位集 $S$ 精确地是：\n1. 阿基米德位 $v = \\infty$。\n2. $E$ 有坏约化的有限位 $p$（即 $p \\mid \\Delta$）。\n3. $E$ 有好约化但点 $P$ 不是 $p$-整的有限位 $p$。对于一个在最小Weierstrass模型中的点 $P=(x,y)$，这意味着 $x$ 坐标的分母能被 $p$ 整除，或者等价地， $|x(P)|_p > 1$。\n\n因此，计算 $\\hat{h}(P)$ 的算法必须识别这个集合 $S$，并为 $v \\in S$ 计算或近似每个 $\\hat{\\lambda}_v(P)$。总误差必须通过在需要近似的位之间分配总误差预算 $\\varepsilon$ 来控制。\n\n现在我们评估每个选项。\n\n**A. 选择位的有限集 $S$ 为所有阿基米德位以及整除 $\\Delta$ 的素数。对于 $v \\notin S$ 强制将局部贡献设为零，因为好约化保证了其值为零。对于 $v \\in S$，使用任意收敛的局部级数，并在一个共同的整数 $N$ 处截断每一个级数，$N$ 要足够大，以使在一个代表性位上的几何级数尾部界限在 $\\varepsilon$ 以内，然后对所有位重用此 $N$。对 $S$ 求和得到所需的近似值。**\n\n这个选项包含几个错误。\n首先，集合 $S$ 定义不正确。它忽略了那些 $E$ 有好约化但 $P$ 不是 $p$-整的素数 $p$（即 $|x(P)|_p > 1$）。在这些素数处，局部高是非零的。对于一个好约化素数 $p$，公式为 $\\hat{\\lambda}_p(P) = \\frac{1}{2} \\max(0, -v_p(x(P))) \\log p = \\frac{1}{2} \\log |x(P)|_p$。如果 $|x(P)|_p > 1$，这个值非零。“好约化保证其值为零”的说法是错误的。\n其次，截断策略不严格。用于计算不同位（例如，阿基米德位，一个乘性约化的 $p$-进位，另一个加性约化的 $p'$-进位）上局部高的级数的收敛速度是完全不同的。它们依赖于局部参数，如无穷远处的 $q = e^{2\\pi i \\tau}$ 或乘性约化素数 $p$ 处的Tate参数 $q_p$。使用一个共同的截断指数 $N$ 是低效且不正确的。一个严格的方法需要基于局部误差预算 $\\varepsilon_v$ 为每个位 $v$ 计算一个特定的截断指数 $N_v$。\n\n结论：**不正确**。\n\n**B. 选择位的有限集 $S$，使其包含唯一的阿基米德位 $\\infty$ 以及所有满足以下任一条件的素数 $p$：$E$ 在 $p$ 处有坏约化（即 $p \\mid \\Delta$），或者 $P$ 的 $x$ 坐标不是 $p$-整的（即 $|x(P)|_p > 1$）。对于 $p \\in S$ 且具有好约化以及 $|x(P)|_p \\le 1$ 的情况，局部贡献恰好为零；对于 $p \\in S$ 且具有好约化以及 $|x(P)|_p > 1$ 的情况，从 $x(P)$ 分母的 $p$-进赋值精确计算局部贡献，因此不会产生截断误差。对于 $p \\in S$ 且具有乘性约化的情况，转到 Tate 一致化，其参数 $q_p$ 满足 $|q_p|_p  1$，将局部贡献表示为一个 $q_p$ 的幂级数，其系数由约化类型一致地界定，并选择一个截断指数 $N_p$，使得对于选定的局部预算 $\\varepsilon_p > 0$，几何级数尾部界限 $\\sum_{n > N_p} C_p \\, |q_p|_p^{\\,n} \\le \\varepsilon_p$ 成立。对于 $p \\in S$ 且具有加性约化的情况，在适当缩放到最小模型后，在 $\\mathbb{Z}_p$ 上的形式群中进行计算；使用局部参数的形式群幂级数将局部贡献表示为一个快速衰减的级数，其尾部由一个关于收敛半径的可计算函数界定，并选取 $N_p$ 使得尾部 $\\le \\varepsilon_p$。在 $\\infty$ 处，使用复一致化 $E(\\mathbb{C}) \\cong \\mathbb{C}/\\Lambda$；对于某个椭圆对数 $z \\in \\mathbb{C}$，写出 $x(P) = \\wp(z)$，通过一个在 $q = e^{2\\pi i \\tau}$（其中 $\\Im(\\tau) > 0$）中的收敛 $q$-级数来表示局部贡献，并选择一个截断指数 $N_\\infty$，使得尾部界限 $\\sum_{n > N_\\infty} C_\\infty |q|^{\\,n} \\le \\varepsilon_\\infty$ 成立。分配局部容限，使得 $\\sum_{v \\in S} \\varepsilon_v \\le \\varepsilon$，并且对于局部贡献被精确计算的有限好约化位，设置 $\\varepsilon_v = 0$。对 $S$ 的求和结果给出了一个总误差至多为 $\\varepsilon$ 的近似值。**\n\n这个选项提供了一个详细而准确的描述，阐述了计算典范高的标准、严格的算法。\n- 具有潜在非零贡献的位集 $S$ 被正确地识别出来。\n- 它正确地指出，对于一个好约化素数 $p$，局部高要么是 $0$（如果 $|x(P)|_p \\le 1$），要么由一个精确公式 $\\frac{1}{2}\\log|x(P)|_p$ 给出（如果 $|x(P)|_p > 1$），不需要近似。\n- 它正确地描述了需要级数近似的三种情况下的不同标准程序：乘性约化（通过Tate的$p$-进一致化）、加性约化（通过形式群）和阿基米德位（通过复一致化和$q$-级数）。\n- 关键是，它描述了正确的误差控制策略：将总误差预算 $\\varepsilon$ 分配到局部预算 $\\varepsilon_v$ 中，并选择特定于位的截断指数 $N_v$ 以满足这些局部预算。这确保了总误差被 $\\varepsilon$ 界定。\n\n结论：**正确**。\n\n**C. 仅使用复一致化计算阿基米德贡献，并忽略所有有限位，因为全局最小模型强制它们为零。使用一个仅由周期比的虚部 $\\Im(\\tau)$ 决定的单一截断指数 $N$，并断定近似误差小于 $\\varepsilon$，因为阿基米德尾部占主导地位。**\n\n这个选项有根本性缺陷。拥有一个全局最小Weierstrass方程并不能强制有限局部高贡献为零。如选项A的解释所述，在任何整除判别式 $\\Delta$ 或 $x(P)$ 分母的素数 $p$ 处，$\\hat{\\lambda}_p(P)$ 都可能非零。这些非阿基米德贡献是全局高 $\\hat{h}(P)$ 的重要组成部分，而不是误差项。声称它们可以被忽略或被阿基米德“尾部”所主导，是没有任何理论依据的。有限局部高之和的量级可以与阿基米德贡献相当，甚至更大。\n\n结论：**不正确**。\n\n**D. 使用通过倍点映射的极限特征，计算一个大整数 $N$ 的 $h([2^N]P)$，并返回 $4^{-N} h([2^N]P)$ 作为近似值。由于二次性，误差由 $4^{-N}$ 乘以朴素高界定，因此不需要进行局部分析或逐位的截断。选择 $N$ 使得 $4^{-N} h([2^N]P) \\le \\varepsilon$ 并停止。**\n\n这个选项指的是典范高的基本定义，即极限 $\\hat{h}(P) = \\lim_{N\\to\\infty} 4^{-N}h([2^N]P)$，其中 $h$ 是朴素对数高，$h(P) = \\log \\max(|a|,|b|)$ 对于 $x(P)=a/b$。虽然这个极限收敛，但该选项对误差控制的描述并不严格。\n近似的误差是 $E_N = |\\hat{h}(P) - 4^{-N}h([2^N]P)|$。虽然 $E_N = O(4^{-N})$ 是正确的，但一个严格的算法需要一个关于所隐含常数的可计算界。这个常数依赖于椭圆曲线 $E$ 的局部性质，特别是在坏约化位上的性质。确定这个常数需要进行该选项声称可以避免的那种局部分析。因此，“不需要进行局部分析...”的说法对于一个*严格的*实现是错误的。\n此外，提议的停止条件 $4^{-N} h([2^N]P) \\le \\varepsilon$ 是不正确的。这个条件界定了近似的*值*，而不是近似的*误差*。正确的目标是确保 $E_N \\le \\varepsilon$。一个具有非常小的高的点可能对于一个小的 $N$ 就满足了提议的条件，而此时误差 $E_N$ 仍然很大。\n\n结论：**不正确**。\n\n总之，只有选项B概述了一个完整且数学上合理的算法，用于将典范高严格计算到指定精度。", "answer": "$$\\boxed{B}$$", "id": "3025329"}]}