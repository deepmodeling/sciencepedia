{"hands_on_practices": [{"introduction": "希尔伯特类域理论的核心成果之一是伽罗瓦群 $\\mathrm{Gal}(H_K/K)$ 与理想类群 $\\mathrm{Cl}(K)$ 之间的典范同构。这意味着希尔伯特类域的扩张次数 $[H_K:K]$ 恰好等于类数 $h_K$。本练习将引导你完成计算虚二次域类数的标准流程：首先利用闵可夫斯基界（Minkowski's bound）确定理想类群生成元的范围，然后通过求解范数方程来判断关键的素理想是否为主理想，最终确定类数。", "problem": "设 $K = \\mathbb{Q}(\\sqrt{-15})$ 且令 $\\mathcal{O}_{K}$ 表示 $K$ 的整数环。$K$ 的希尔伯特类域 (HCF)，记作 $H_{K}$，是 $K$ 的最大无分歧阿贝尔扩张。请仅使用代数数论中的基本事实和定义，包括类群的定义、$\\mathrm{Gal}(H_{K}/K) \\cong \\mathrm{Cl}(K)$ 的同构关系、二次域的判别式和整数环的概念、二次域的闵可夫斯基界，以及有理素数在二次扩张中的基本分裂定律，来确定扩张次数 $[H_{K}:K]$。\n\n你的推理应包括：\n- 确定判别式 $D_{K}$ 和 $\\mathcal{O}_{K}$ 的一个方便的 $\\mathbb{Z}$-基。\n- 应用于虚二次域的闵可夫斯基界来限定表示理想类所需的范数。\n- 确定有理素数 $2$ 在 $K$ 中的分裂行为。\n- 在 $\\mathcal{O}_{K}$ 中进行范数计算，以判断范数为 $2$ 的理想是否可以是主理想。\n\n请将你的最终答案表示为单个整数。", "solution": "题目要求计算数域 $K = \\mathbb{Q}(\\sqrt{-15})$ 的希尔伯特类域扩张的次数 $[H_{K}:K]$。\n根据类域论的基本定理，希尔伯特类域扩张的伽罗瓦群与域 $K$ 的理想类群同构。题目中已给出此关系为 $\\mathrm{Gal}(H_{K}/K) \\cong \\mathrm{Cl}(K)$。\n因此，扩张的次数等于伽罗瓦群的阶，而伽罗瓦群的阶又等于类群的阶，即类数 $h_{K}$。\n$$[H_{K}:K] = |\\mathrm{Gal}(H_{K}/K)| = |\\mathrm{Cl}(K)| = h_{K}$$\n我们的任务是计算 $K = \\mathbb{Q}(\\sqrt{-15})$ 的类数 $h_{K}$。\n\n首先，我们确定二次域 $K = \\mathbb{Q}(\\sqrt{d})$（其中 $d = -15$）的判别式 $D_{K}$ 和整数环 $\\mathcal{O}_{K}$。由于 $d$ 是无平方因子数且 $d = -15 \\equiv 1 \\pmod 4$，判别式为 $D_{K} = d = -15$。整数环 $\\mathcal{O}_{K}$ 由 $\\mathcal{O}_{K} = \\mathbb{Z}[\\frac{1+\\sqrt{-15}}{2}]$ 给出，其一个 $\\mathbb{Z}$-基为 $\\{1, \\frac{1+\\sqrt{-15}}{2}\\}$。\n\n接下来，我们应用闵可夫斯基界来确定生成类群所需的素理想集合。对于虚二次域，闵可夫斯基界 $M_{K}$ 指出，$\\mathrm{Cl}(K)$ 中的每个理想类都包含一个整理想 $\\mathfrak{a}$，其范数 $N(\\mathfrak{a}) \\leq M_{K}$，其中\n$$M_{K} = \\frac{2}{\\pi}\\sqrt{|D_{K}|}$$\n代入判别式的值 $D_{K} = -15$：\n$$M_{K} = \\frac{2}{\\pi}\\sqrt{|-15|} = \\frac{2\\sqrt{15}}{\\pi}$$\n为了估计该值，我们使用近似值 $\\sqrt{15} \\approx 3.87$ 和 $\\pi \\approx 3.14$：\n$$M_{K} \\approx \\frac{2 \\times 3.87}{3.14} = \\frac{7.74}{3.14} \\approx 2.46$$\n由于 $M_{K}  3$，每个理想类都由一个范数为 $1$ 或 $2$ 的整理想表示。范数为 $1$ 的理想是平凡的（即环 $\\mathcal{O}_{K}$ 本身），代表单位类。因此，类群 $\\mathrm{Cl}(K)$ 由范数为 $2$ 的素理想的类生成。范数为 $2$ 的素理想必然位于有理素数 $p=2$ 之上。\n\n我们现在确定有理素数 $p=2$ 在 $\\mathcal{O}_{K}$ 中的分裂行为。对于不整除判别式的奇素数 $p$，其分裂行为由勒让德符号 $(\\frac{D_K}{p})$ 决定。对于 $p=2$，分裂行为取决于判别式模 $8$ 的值。由于 $D_K = -15 = 1 - 16 \\equiv 1 \\pmod 8$，素数 $(2)$ 在 $\\mathcal{O}_{K}$ 中分裂成两个不同的素理想。我们用 $\\mathfrak{p}_{2}$ 和 $\\mathfrak{p}_{2}'$ 表示这两个素理想。\n$$(2) = \\mathfrak{p}_{2} \\mathfrak{p}_{2}'$$\n这些理想的范数是 $N(\\mathfrak{p}_{2}) = N(\\mathfrak{p}_{2}') = 2$。\n由于 $(2)$ 是主理想，在类群中，我们有 $[\\mathfrak{p}_{2}][\\mathfrak{p}_{2}'] = [(2)] = [1]$，其中 $[1]$ 是单位类。这意味着 $[\\mathfrak{p}_{2}'] = [\\mathfrak{p}_{2}]^{-1}$。因此，类群 $\\mathrm{Cl}(K)$ 由单个素理想的类生成，例如 $[\\mathfrak{p}_{2}]$。\n\n为了找到类群的阶，我们必须找到元素 $[\\mathfrak{p}_{2}]$ 的阶。这首先需要确定 $\\mathfrak{p}_{2}$ 是否为主理想。一个理想是主理想，如果它由单个元素生成。如果对于某个 $\\alpha \\in \\mathcal{O}_{K}$ 有 $\\mathfrak{p}_{2} = (\\alpha)$，那么它的范数必须是 $N(\\mathfrak{p}_{2}) = |N_{K/\\mathbb{Q}}(\\alpha)| = 2$。\n$\\mathcal{O}_{K}$ 中的任意元素 $\\alpha$ 可以写成 $\\alpha = \\frac{x+y\\sqrt{-15}}{2}$ 的形式，其中 $x, y \\in \\mathbb{Z}$ 且 $x \\equiv y \\pmod 2$。该元素的范数为：\n$$N(\\alpha) = \\left(\\frac{x+y\\sqrt{-15}}{2}\\right)\\left(\\frac{x-y\\sqrt{-15}}{2}\\right) = \\frac{x^2 + 15y^2}{4}$$\n我们寻找方程 $N(\\alpha) = 2$ 的整数解 $(x, y)$：\n$$\\frac{x^2 + 15y^2}{4} = 2 \\implies x^2 + 15y^2 = 8$$\n我们检查 $y$ 可能的整数值：\n- 如果 $y = 0$，则 $x^2 = 8$，这对 $x$ 没有整数解。\n- 如果 $|y| = 1$，则 $x^2 + 15 = 8$，这意味着 $x^2 = -7$，这对 $x$ 没有实数解。\n- 如果 $|y| \\geq 2$，则 $15y^2 \\geq 15(4) = 60 > 8$，所以没有解。\n方程 $x^2 + 15y^2 = 8$ 没有整数解。因此，在 $\\mathcal{O}_{K}$ 中不存在范数为 $2$ 的元素 $\\alpha$。这意味着理想 $\\mathfrak{p}_{2}$ 不是主理想。\n因此，它的类 $[\\mathfrak{p}_{2}]$ 不是 $\\mathrm{Cl}(K)$ 中的单位元，这意味着 $h_{K} > 1$。\n\n元素 $[\\mathfrak{p}_{2}]$ 的阶是使 $\\mathfrak{p}_{2}^n$ 成为主理想的最小正整数 $n$。我们来检查 $n=2$ 的情况。我们需要确定 $\\mathfrak{p}_{2}^2$ 是否是主理想。如果是，比如 $\\mathfrak{p}_{2}^2 = (\\beta)$，那么我们必须有 $N((\\beta)) = N(\\mathfrak{p}_{2}^2) = (N(\\mathfrak{p}_{2}))^2 = 2^2 = 4$。所以我们在 $\\mathcal{O}_{K}$ 中寻找范数为 $4$ 的元素。\n这需要解丢番图方程：\n$$\\frac{x^2 + 15y^2}{4} = 4 \\implies x^2 + 15y^2 = 16$$\n其中 $x, y \\in \\mathbb{Z}$ 且 $x \\equiv y \\pmod 2$。\n- 如果 $y=0$，那么 $x^2=16 \\implies x=\\pm 4$。数对 $(4, 0)$ 满足 $4 \\equiv 0 \\pmod 2$。这对应于元素 $\\alpha = \\frac{4+0\\sqrt{-15}}{2} = 2$。主理想 $(2)$ 的范数为 $4$，但我们知道 $(2) = \\mathfrak{p}_2 \\mathfrak{p}_2'$，而由于 $\\mathfrak{p}_2 \\ne \\mathfrak{p}_2'$，这不等于 $\\mathfrak{p}_2^2$。\n- 如果 $|y|=1$，那么 $x^2+15 = 16 \\implies x^2=1 \\implies x=\\pm 1$。数对 $(1, 1)$, $(1, -1)$, $(-1, 1)$, $(-1, -1)$ 都满足同余式 $x \\equiv y \\pmod 2$。例如，$(x, y)=(1, 1)$ 给出元素 $\\beta = \\frac{1+\\sqrt{-15}}{2} \\in \\mathcal{O}_{K}$，其范数为 $4$。\n- 如果 $|y| \\ge 2$, $15y^2 \\ge 60 > 16$。\n\n我们找到了一个元素 $\\beta = \\frac{1+\\sqrt{-15}}{2}$，它生成一个范数为 $4$ 的主理想 $(\\beta)$。我们来确定这个理想的素理想分解。$2$ 之上的一个素理想是 $\\mathfrak{p}_{2} = (2, \\frac{1+\\sqrt{-15}}{2})$。由于 $\\beta = \\frac{1+\\sqrt{-15}}{2}$ 是 $\\mathfrak{p}_{2}$ 的一个生成元，主理想 $(\\beta)$ 包含于 $\\mathfrak{p}_{2}$ 中。这意味着 $\\mathfrak{p}_{2}$ 整除 $(\\beta)$。\n根据理想的唯一分解定理，$(\\beta) = \\mathfrak{p}_{2} \\mathfrak{q}$，其中 $\\mathfrak{q}$ 是某个理想。取范数，我们得到 $N((\\beta)) = N(\\mathfrak{p}_{2}) N(\\mathfrak{q})$，所以 $4 = 2 \\cdot N(\\mathfrak{q})$，这意味着 $N(\\mathfrak{q})=2$。范数为 $2$ 的理想只有 $\\mathfrak{p}_2$ 和 $\\mathfrak{p}_2'$。\n所以，我们有两种可能性：$(\\beta) = \\mathfrak{p}_{2}^2$ 或 $(\\beta) = \\mathfrak{p}_{2}\\mathfrak{p}_{2}' = (2)$。\n理想 $(\\beta) = (\\frac{1+\\sqrt{-15}}{2})$ 不可能等于理想 $(2)$，因为元素 $2$ 不能写成 $\\beta$ 与 $\\mathcal{O}_{K}$ 中某个元素的乘积。实际上，如果对于某个 $\\gamma \\in \\mathcal{O}_K$ 有 $2 = \\beta \\cdot \\gamma$，那么 $\\gamma = \\frac{2}{\\beta} = \\frac{2}{(1+\\sqrt{-15})/2} = \\frac{4}{1+\\sqrt{-15}} = \\frac{4(1-\\sqrt{-15})}{16} = \\frac{1-\\sqrt{-15}}{4}$。这个元素 $\\gamma$ 不在 $\\mathcal{O}_{K}$ 中，因为它的最小多项式是 $x^2 - \\frac{1}{2}x + 1 = 0$，其系数不是整数。\n因此，等式 $(\\beta) = (2)$ 是不成立的。\n\n唯一剩下的可能性是 $(\\beta) = \\mathfrak{p}_{2}^2$。这表明 $\\mathfrak{p}_{2}^2$ 是一个主理想。\n在类群 $\\mathrm{Cl}(K)$ 中，这意味着 $[\\mathfrak{p}_{2}]^2 = [1]$。由于我们已经确定 $[\\mathfrak{p}_{2}] \\neq [1]$，元素 $[\\mathfrak{p}_{2}]$ 的阶恰好是 $2$。\n因为类群 $\\mathrm{Cl}(K)$ 由 $[\\mathfrak{p}_{2}]$ 生成，所以它的阶是 $h_{K} = 2$。\n\n最后，希尔伯特类域扩张的次数为 $[H_{K}:K] = h_{K} = 2$。", "answer": "$$\\boxed{2}$$", "id": "3026825"}, {"introduction": "计算类数的方法并不仅限于二次域。本练习将探讨一个三次域的例子，以此展示闵可夫斯基界在更高次域中的应用。你将发现，对于这个特定的三次域 [@problem_id:3026794]，闵可夫斯基界异常强大，可以直接证明其类数为 $1$，而无需分析任何具体的理想。这个结果不仅展示了数之几何方法的优越性，也揭示了某些数域不存在任何非平凡的无分歧阿贝尔扩张的深刻事实。", "problem": "设 $K$ 是非二次数域 $K = \\mathbb{Q}(\\theta)$，其中 $\\theta$ 是不可约多项式 $f(x) = x^{3} - x - 1 \\in \\mathbb{Z}[x]$ 的一个根。请基于代数数论中的基本定义和公认事实进行求解，这些事实包括：整数环、判别式、嵌入与符号差、理想范数，以及针对理想类的 Minkowski 几何数论界。确定扩张次数 $[H_{K} : K]$ 的精确值，其中 $H_{K}$ 表示 $K$ 的希尔伯特类域（HCF），定义为 $K$ 的最大无分歧阿贝尔扩张。您的答案必须是单个整数。无需四舍五入。", "solution": "本题要求确定扩张次数 $[H_{K} : K]$，其中 $H_{K}$ 是数域 $K = \\mathbb{Q}(\\theta)$ 的希尔伯特类域，而 $\\theta$ 是多项式 $f(x) = x^{3} - x - 1$ 的一个根。\n\n根据类域论的一个基本结果，希尔伯特类域扩张的伽罗瓦群与基域的理想类群同构。具体来说，阿廷映射给出了一个同构 $\\mathrm{Gal}(H_{K}/K) \\cong \\mathrm{Cl}(K)$。因此，扩张次数等于伽罗瓦群的阶，而伽罗瓦群的阶又等于理想类群的阶，即类数 $h_{K}$。\n$$[H_{K} : K] = |\\mathrm{Gal}(H_{K}/K)| = |\\mathrm{Cl}(K)| = h_{K}$$\n因此，我们的任务简化为计算数域 $K = \\mathbb{Q}(\\theta)$ 的类数 $h_{K}$。\n\n首先，我们确定数域 $K$ 的基本性质。多项式为 $f(x) = x^{3} - x - 1$。这是一个整系数多项式，即 $f(x) \\in \\mathbb{Z}[x]$。为了检验其在 $\\mathbb{Q}$ 上的不可约性，我们使用有理根定理。任何有理根都必须是常数项 $-1$ 的整数因子，因此唯一可能的有理根是 $\\pm 1$。我们在这些点上计算多项式的值：\n$f(1) = 1^{3} - 1 - 1 = -1 \\neq 0$\n$f(-1) = (-1)^{3} - (-1) - 1 = -1 + 1 - 1 = -1 \\neq 0$\n由于没有有理根，这个三次多项式 $f(x)$ 在 $\\mathbb{Q}$ 上是不可约的。域扩张 $K/\\mathbb{Q}$ 的次数是最小多项式的次数，所以 $n = [K:\\mathbb{Q}] = 3$。\n\n接下来，我们确定数域 $K$ 的符号差，即序对 $(r_{1}, r_{2})$，其中 $r_{1}$ 是实嵌入的数目，$2r_{2}$ 是复嵌入的数目。实嵌入的数目等于最小多项式 $f(x)$ 的实根个数。我们可以用微积分来分析实根。$f(x)$ 的导数是 $f'(x) = 3x^{2} - 1$。临界点在 $f'(x) = 0$ 处，即 $x = \\pm \\frac{1}{\\sqrt{3}}$。我们计算 $f(x)$ 在这些临界点的值：\n$f\\left(\\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{\\sqrt{3}}\\right)^{3} - \\frac{1}{\\sqrt{3}} - 1 = \\frac{1}{3\\sqrt{3}} - \\frac{1}{\\sqrt{3}} - 1 = -\\frac{2}{3\\sqrt{3}} - 1  0$\n$f\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^{3} - \\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{\\sqrt{3}} - 1 = \\frac{2}{3\\sqrt{3}} - 1$。由于 $4  27$，我们有 $2  3\\sqrt{3}$，这意味着 $\\frac{2}{3\\sqrt{3}}  1$。因此，$f\\left(-\\frac{1}{\\sqrt{3}}\\right)$ 也为负。\n$f(x)$ 的极大值和极小值都为负。当 $x \\to \\infty$ 时，$f(x) \\to \\infty$；当 $x \\to -\\infty$ 时，$f(x) \\to -\\infty$。这个函数图像的形态意味着 $f(x)$ 的图像只与x轴相交一次。因此，$f(x)$ 有一个实根和一对共轭复根。这给出了 $r_{1} = 1$ 个实嵌入和 $2r_{2} = 2$ 个复嵌入，所以 $r_{2} = 1$。符号差为 $(1, 1)$，我们验证 $n = r_{1} + 2r_{2} = 1 + 2(1) = 3$。\n\n现在我们计算数域的判别式 $d_{K}$。形如 $x^{3} + px + q$ 的三次多项式的判别式由公式 $\\Delta = -4p^{3} - 27q^{2}$ 给出。对于 $f(x) = x^{3} - x - 1$，我们有 $p = -1$ 和 $q = -1$。多项式的判别式是：\n$\\Delta_{f} = -4(-1)^{3} - 27(-1)^{2} = -4(-1) - 27(1) = 4 - 27 = -23$。\n域判别式 $d_{K}$ 与多项式判别式通过公式 $\\Delta_{f} = [\\mathcal{O}_{K} : \\mathbb{Z}[\\theta]]^{2} d_{K}$ 相关联，其中 $\\mathcal{O}_{K}$ 是 $K$ 的整数环。因为 $-23$ 是一个素数，所以它是无平方因子的。这意味着指数 $[\\mathcal{O}_{K} : \\mathbb{Z}[\\theta]]^{2}$ 必须为 $1$，所以 $[\\mathcal{O}_{K} : \\mathbb{Z}[\\theta]] = 1$。这意味着 $\\mathcal{O}_{K} = \\mathbb{Z}[\\theta]$，且域的判别式等于多项式的判别式：$d_{K} = -23$。\n\n为了求类数 $h_{K}$，我们使用 Minkowski 界。$\\mathrm{Cl}(K)$ 中的每个理想类都包含一个整理想 $\\mathfrak{a}$，其范数 $N(\\mathfrak{a})$ 满足：\n$N(\\mathfrak{a}) \\leq M_{K} = \\left(\\frac{4}{\\pi}\\right)^{r_{2}} \\frac{n!}{n^{n}} |d_{K}|^{1/2}$。\n代入我们求得的值：$n=3$，$r_{2}=1$，以及 $d_{K}=-23$。\n$M_{K} = \\left(\\frac{4}{\\pi}\\right)^{1} \\frac{3!}{3^{3}} |-23|^{1/2} = \\frac{4}{\\pi} \\frac{6}{27} \\sqrt{23} = \\frac{4}{\\pi} \\frac{2}{9} \\sqrt{23} = \\frac{8\\sqrt{23}}{9\\pi}$。\n我们需要确定这个界是否小于 $2$。我们可以估算这个值：\n$\\sqrt{23} \\approx 4.796$ 且 $\\pi \\approx 3.1416$。\n$M_{K} \\approx \\frac{8 \\times 4.796}{9 \\times 3.1416} = \\frac{38.368}{28.2744} \\approx 1.357$。\n由于 $M_{K}  2$，这意味着每个理想类都必须包含一个范数 $N(\\mathfrak{a})  2$ 的整理想 $\\mathfrak{a}$。范数唯一可能的整数值是 $N(\\mathfrak{a}) = 1$。\n唯一范数为 $1$ 的整理想是整数环 $\\mathcal{O}_{K}$ 本身，也就是主理想 $(1)$。\n这意味着 $\\mathrm{Cl}(K)$ 中的每个理想类都是主理想类。因此，理想类群是平凡的，$\\mathrm{Cl}(K) = \\{[\\mathcal{O}_{K}]\\}$。类群的阶，即类数，为 $h_{K} = 1$。\n\n最后，我们可以确定希尔伯特类域扩张的次数：\n$[H_{K} : K] = h_{K} = 1$。\n这表明 $K$ 的希尔伯特类域就是 $K$ 本身，意味着 $K$ 不存在非平凡的无分歧阿贝尔扩张。", "answer": "$$\\boxed{1}$$", "id": "3026794"}, {"introduction": "在确定了希尔伯特类域的次数之后，一个自然的问题是：这个扩张中的算术结构是怎样的？根据阿廷互反律（Artin reciprocity），一个素数在希尔伯特类域中的分裂行为，取决于它在基域中生成的理想是否为主理想。本练习 [@problem_id:3026789] 要求你将这一深刻的理论论断转化为一个可执行的算法。通过编程实现主理想与二次型表示之间的联系，你将对类域论如何为经典数论问题提供具体答案获得更切实的理解。", "problem": "给定负基本判别式 $D$ 和有理素数 $p$。令 $K = \\mathbb{Q}(\\sqrt{D})$ 为一个判别式为 $D$ 的虚二次域，并令 $H_K$ 表示其希尔伯特类域。请仅使用以下基础事实和定义来设计您的算法。\n\n1. 希尔伯特类域的定义：$H_K$ 是 $K$ 的最大无分歧阿贝尔扩张。\n2. 针对希尔伯特类域的阿廷互反律：对于位于有理素数 $p \\nmid D$ 之上的 $\\mathcal{O}_K$ 的一个素理想 $\\mathfrak{p}$，$\\mathfrak{p}$ 在 $H_K$ 中完全分裂当且仅当 $\\mathfrak{p}$ 的理想类在类群 $\\mathrm{Cl}(\\mathcal{O}_K)$ 中是平凡的，即当且仅当 $\\mathfrak{p}$ 是主理想。\n3. 虚二次域中的二元二次型与主理想：对于判别式为 $D0$ 的虚二次域 $K$，其理想类对应于判别式为 $D$ 的正定本原二元二次型的等价类。主类对应于主型\n   - 如果 $D \\equiv 0 \\pmod{4}$：$f(x,y) = x^2 + \\left(-\\frac{D}{4}\\right) y^2$。\n   - 如果 $D \\equiv 1 \\pmod{4}$：$f(x,y) = x^2 + x y + \\left(\\frac{1-D}{4}\\right) y^2$。\n   一个有理素数 $p \\nmid D$ 在 $H_K$ 中完全分裂，当且仅当 $p$ 在 $K$ 中分裂，并且能被判别式为 $D$ 的主型表示，即存在整数 $x,y$ 使得 $f(x,y) = p$。\n4. 在 $K$ 中分裂：对于任意奇素数 $p \\nmid D$，$p$ 在 $K$ 中分裂当且仅当克罗内克符号 $\\left(\\frac{D}{p}\\right) = 1$。对于 $p=2$，应使用克罗内克符号 $\\left(\\frac{D}{2}\\right)$。\n\n任务。编写一个完整的、可运行的程序，对于每个给定的对 $(D,p)$，判断 $p$ 是否在 $H_K$ 中完全分裂。您的程序必须实现以下逻辑，且不得依赖预先计算的类群或表格：\n- 如果 $p \\mid D$，输出 $\\mathrm{False}$（因为 $p$ 在 $K$ 中分歧，因此不能在 $H_K$ 中完全分裂）。\n- 计算克罗内克符号 $\\left(\\frac{D}{p}\\right)$。如果结果不为 $1$，输出 $\\mathrm{False}$。\n- 根据上面提到的 $D \\bmod 4$ 构建主型 $f(x,y)$。判断是否存在整数 $x,y$ 使得 $f(x,y)=p$。您必须利用主型的正定性，实现一个有数学依据的有界搜索。具体来说，令 $f(x,y) = x^2 + b x y + c y^2$，其中 $b \\in \\{0,1\\}$ 且 $c \\in \\mathbb{Z}_{0}$。由于 $f$ 是正定的，对于任何解，都必须有 $c y^2 \\le p$，从而得到一个界 $|y| \\le \\left\\lfloor \\sqrt{\\frac{p}{c}} \\right\\rfloor$。对于每个这样的整数 $y$，通过解关于 $x$ 的二次方程并检查判别式和整数条件，来确定是否存在满足 $f(x,y)=p$ 的整数 $x$。\n\n测试套件。您的程序必须按此确切顺序计算以下输入对 $(D,p)$ 的结果：\n- $(-4,5)$\n- $(-4,3)$\n- $(-20,29)$\n- $(-20,3)$\n- $(-20,5)$\n- $(-15,19)$\n- $(-15,11)$\n\n答案规范和最终输出格式：\n- 对于每个测试用例，输出必须是布尔值 $\\mathrm{True}$ 或 $\\mathrm{False}$，指示 $p$ 是否在 $H_K$ 中完全分裂。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $\\mathtt{[True,False,True]}$。", "solution": "问题要求设计一个算法，用于判断给定的有理素数 $p$ 是否在虚二次域 $K = \\mathbb{Q}(\\sqrt{D})$ 的希尔伯特类域 $H_K$ 中完全分裂，其中 $D$ 是给定的负基本判别式。解决方案必须基于一组特定的、已给出的数论原理来构建。\n\n如问题陈述中所概述，其核心理论结果是针对希尔伯特类域的阿廷互反律的一个推论。该结果指出，一个不整除判别式 $D$（即 $p \\nmid D$）的有理素数 $p$ 在 $H_K$ 中完全分裂，当且仅当满足两个条件：\n1. 素数 $p$ 在基域 $K = \\mathbb{Q}(\\sqrt{D})$ 中分裂。\n2. 整数环 $\\mathcal{O}_K$ 中位于 $p$之上的素理想 $\\mathfrak{p}$ 是主理想。\n\n这两个条件可以转化为涉及二次型和克罗内克符号的可计算验证准则。该算法被设计为这些准则的直接实现。\n\n首先，我们考虑素数 $p$ 在 $K$ 中分歧的情况。这种情况发生当且仅当 $p$ 整除判别式 $D$。根据定义，无分歧扩张是指没有素数在其中发生分歧的扩张。由于 $H_K$ 是 $K$ 的最大*无分歧*阿贝尔扩张，任何在 $K$ 中分歧的素数都不可能在 $H_K$ 中完全分裂。因此，如果 $p \\mid D$，则不满足条件，算法返回 `False`。\n\n其次，对于一个不分歧的素数 $p$（$p \\nmid D$），我们测试它是否在 $K$ 中分裂。一个素数 $p$ 在二次域 $\\mathbb{Q}(\\sqrt{D})$ 中分裂，当且仅当克罗内克符号 $\\left(\\frac{D}{p}\\right) = 1$。如果 $\\left(\\frac{D}{p}\\right) = -1$，则 $p$ 在 $K$ 中是惰性的；如果 $\\left(\\frac{D}{p}\\right) = 0$，则 $p$ 分歧（这种情况已处理）。如果 $p$ 不在 $K$ 中分裂，它就不可能在 $K$ 的任何扩张（包括 $H_K$）中完全分裂。因此，如果 $\\left(\\frac{D}{p}\\right) \\neq 1$，算法返回 `False`。克罗内克符号的计算方式如下：\n- 如果 $p=2$，我们使用定义 $\\left(\\frac{D}{2}\\right) = 1$ 当 $D \\equiv 1 \\pmod{8}$ 时，以及 $\\left(\\frac{D}{2}\\right) = -1$ 当 $D \\equiv 5 \\pmod{8}$ 时。由于 $D$ 是一个基本判别式，如果它是奇数，则必须满足 $D \\equiv 1 \\pmod{4}$。因此，$D$ 模 $8$ 的余数是 $1$ 或 $5$。条件简化为：如果 $D \\equiv 1 \\pmod{8}$ 则返回 $1$，如果 $D \\equiv 5 \\pmod{8}$ 则返回 $-1$。\n- 如果 $p$ 是一个奇素数，克罗内克符号 $\\left(\\frac{D}{p}\\right)$ 就是勒让德符号，可以使用欧拉准则高效计算：$\\left(\\frac{D}{p}\\right) \\equiv D^{(p-1)/2} \\pmod{p}$。如果幂的结果模 $p$ 余 $1$，则结果为 $1$；如果余 $p-1$，则结果为 $-1$。\n\n第三，如果 $p$ 在 $K$ 中分裂，我们检查主理想条件。对于虚二次域，二元二次型理论提供了一个等价准则：$p$之上的素理想是主理想，当且仅当 $p$ 可以被判别式为 $D$ 的*主型*表示。主型 $f(x,y)$ 是一个由 $D \\pmod{4}$ 决定的特定正定二元二次型：\n- 如果 $D \\equiv 0 \\pmod{4}$，主型为 $f(x,y) = x^2 + \\left(-\\frac{D}{4}\\right)y^2$。\n- 如果 $D \\equiv 1 \\pmod{4}$，主型为 $f(x,y) = x^2 + xy + \\left(\\frac{1-D}{4}\\right)y^2$。\n\n将该型一般写作 $f(x,y) = ax^2 + bxy + cy^2$，其中 $a=1$。我们的任务简化为确定丢番图方程 $f(x,y) = p$ 是否有整数解 $x$ 和 $y$。由于 $D  0$，该型是正定的，意味着对于任何非零整数对 $(x,y)$ 都有 $f(x,y) > 0$。此性质允许我们进行有界搜索。要使方程 $x^2 + bxy + cy^2 = p$ 成立，必须有 $cy^2 \\le p$，这意味着 $|y| \\le \\sqrt{p/c}$。这为 $y$ 的大小提供了上界，所以我们只需要测试在 $0 \\le y \\le \\lfloor\\sqrt{p/c}\\rfloor$ 范围内的整数 $y$。\n\n对于每个这样的整数 $y$，我们将方程重排为关于 $x$ 的二次方程：\n$$x^2 + (by)x + (cy^2 - p) = 0$$\n要存在 $x$ 的整数解，此二次方程的判别式 $\\Delta_x$ 必须是一个非负完全平方数。判别式为：\n$$\\Delta_x = (by)^2 - 4(1)(cy^2 - p) = (b^2 - 4c)y^2 + 4p$$\n根据定义，项 $b^2 - 4c$ 是该二次型（因为 $a=1$）的判别式 $D$。因此：\n$$\\Delta_x = Dy^2 + 4p$$\n算法通过迭代 $y$ 的有效范围来继续。对于每个 $y$，它计算 $v = Dy^2 + 4p$。如果 $v$ 是一个非负完全平方数，比如说 $v = k^2$（对于某个整数 $k \\ge 0$），那么 $x$ 的潜在解由 $x = \\frac{-by \\pm k}{2}$ 给出。为了使 $x$ 为整数，分子 $(-by \\pm k)$ 必须是偶数。由于 $-by+k$ 和 $-by-k$ 的奇偶性相同，我们只需检查其中一个。如果在此搜索过程中的任何时刻找到一个整数解 $(x,y)$，$p$ 就被主型表示，算法返回 `True`。\n\n如果在对所有可能的 $y$ 值进行搜索后没有找到任何整数解 $(x,y)$，则意味着 $p$ 不能被主型表示。在这种情况下，$p$ 之上的素理想不是主理想，算法返回 `False`。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef kronecker_symbol(a, p):\n    \"\"\"\n    Computes the Kronecker symbol (a/p) where p is a prime.\n    \"\"\"\n    # The problem logic handles the p|D case separately, so we could assume a % p != 0.\n    # However, for robustness, we handle it.\n    if a % p == 0:\n        return 0\n\n    if p == 2:\n        # Since a % p != 0, a must be odd.\n        # D is a fundamental discriminant, so if odd, D must be 1 (mod 4).\n        # Therefore, D mod 8 is either 1 or 5.\n        a_mod_8 = a % 8\n        if a_mod_8 == 1 or a_mod_8 == 7:\n            return 1\n        # a_mod_8 == 3 or a_mod_8 == 5\n        return -1\n\n    # For an odd prime p, the Kronecker symbol is the Legendre symbol.\n    # We use Euler's criterion: a^((p-1)/2) mod p.\n    legendre = pow(a, (p - 1) // 2, p)\n    if legendre == p - 1:\n        return -1\n    else:\n        # Since a is not a multiple of p, the result must be 1.\n        return 1\n\ndef check_split_in_H_K(D, p):\n    \"\"\"\n    Determines if prime p splits completely in the Hilbert class field of Q(sqrt(D)).\n\n    Args:\n        D (int): A negative fundamental discriminant.\n        p (int): A rational prime.\n\n    Returns:\n        bool: True if p splits completely, False otherwise.\n    \"\"\"\n    # Step 1: Handle ramification. If p divides D, p ramifies in K.\n    # An unramified extension like H_K cannot have a prime split completely\n    # if it ramifies in the base field.\n    if D % p == 0:\n        return False\n\n    # Step 2: Check if p splits in K. This is true iff the Kronecker symbol (D/p) is 1.\n    if kronecker_symbol(D, p) != 1:\n        return False\n\n    # Step 3: If p splits in K, check if it's represented by the principal form.\n    # Construct the principal form f(x,y) = x^2 + bxy + cy^2.\n    if D % 4 == 0:\n        b = 0\n        c = -D // 4\n    elif D % 4 == 1:\n        b = 1\n        c = (1 - D) // 4\n    else:\n        # Fundamental discriminants are always 0 or 1 mod 4.\n        # This case should not be reached with valid inputs.\n        raise ValueError(\"Invalid discriminant D: must be 0 or 1 mod 4.\")\n\n    # Step 4: Perform a bounded search for integer solutions to f(x,y) = p.\n    # The form is positive definite, so cy^2 = p, which implies |y| = sqrt(p/c).\n    # We only need to search non-negative y.\n    y_max = int(np.sqrt(p / c))\n\n    for y in range(y_max + 1):\n        # We need to solve x^2 + (b*y)*x + (c*y^2 - p) = 0 for an integer x.\n        # The discriminant of this quadratic in x is Delta_x = D*y^2 + 4p.\n        delta_x = D * y**2 + 4 * p\n\n        if delta_x  0:\n            continue\n        \n        # For x to be an integer, Delta_x must be a perfect square.\n        sqrt_delta_x = int(np.sqrt(delta_x))\n        if sqrt_delta_x**2 != delta_x:\n            continue\n        \n        # If it's a perfect square (k^2), solutions for x are x = (-by +/- k) / 2.\n        # Check if x is an integer. This is true if (-b*y + k) is even.\n        numerator = -b * y + sqrt_delta_x\n        if numerator % 2 == 0:\n            # An integer solution for x exists. Thus, p is represented.\n            return True\n        \n        # The two potential solutions for x have the same parity check,\n        # so checking one numerator is sufficient.\n        \n    # If the loop finishes without finding a solution, p is not represented.\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (-4, 5),\n        (-4, 3),\n        (-20, 29),\n        (-20, 3),\n        (-20, 5),\n        (-15, 19),\n        (-15, 11),\n    ]\n\n    results = []\n    for D, p in test_cases:\n        result = check_split_in_H_K(D, p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str(True) -> 'True', str(False) -> 'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3026789"}]}