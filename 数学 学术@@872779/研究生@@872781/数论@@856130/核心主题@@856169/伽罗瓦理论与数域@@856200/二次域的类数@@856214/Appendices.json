{"hands_on_practices": [{"introduction": "在深入研究类数之前，我们必须首先掌握二次域的两个最基本的代数不变量：整数环 $\\mathcal{O}_K$ 和域判别式 $D_K$。整数环的结构取决于定义域的无平方因子整数 $d$ 模 $4$ 的余数，而判别式则是闵可夫斯基界和二次型理论等核心工具的关键输入。这项练习旨在通过从基本定义出发，构建积分基并计算判别式，来巩固对这些基础知识的理解，为后续更复杂的类数计算打下坚实的基础。[@problem_id:3010135]", "problem": "设 $K$ 是一个二次数域 $K=\\mathbb{Q}(\\sqrt{d})$，其中 $d \\in \\mathbb{Z}$ 是无平方因子整数且 $d \\neq 1$。整数环 $\\mathcal{O}_{K}$ 是 $\\mathbb{Z}$ 在 $K$ 中的整闭包，而整基是 $\\mathcal{O}_{K}$ 的一个 $\\mathbb{Z}$-基。域判别式 $D_{K}$ 定义为任意整基的判别式，通过迹双线性形式计算：对于 $\\mathcal{O}_{K}$ 在 $\\mathbb{Z}$ 上的一个基 $\\{\\beta_{1},\\beta_{2}\\}$，设\n$$\nD_{K} \\;=\\; \\det\\!\\big( \\operatorname{Tr}_{K/\\mathbb{Q}}(\\beta_{i}\\beta_{j}) \\big)_{1 \\leq i,j \\leq 2}.\n$$\n作为计算类数的前置步骤，请为以下数域构建显式整基，并使用上述定义计算它们的域判别式：\n- $K_{1}=\\mathbb{Q}(\\sqrt{5})$，\n- $K_{2}=\\mathbb{Q}(\\sqrt{13})$，\n- $K_{3}=\\mathbb{Q}(\\sqrt{-3})$，\n- $K_{4}=\\mathbb{Q}(\\sqrt{-7})$。\n\n您的推导必须从核心定义出发，明确证明您所选基元素的整性，并使用迹形式来计算判别式。请按顺序将最终答案以单个行矩阵 $\\big(D_{K_{1}} \\;\\; D_{K_{2}} \\;\\; D_{K_{3}} \\;\\; D_{K_{4}}\\big)$ 的形式给出。无需四舍五入。", "solution": "该问题要求确定四个特定二次数域的整基并计算其域判别式。验证过程确认该问题提法恰当，科学上合理，并包含所有必要信息。我们开始进行解答。\n\n设 $K = \\mathbb{Q}(\\sqrt{d})$ 是一个二次数域，其中 $d$ 是一个不等于 $1$ 的无平方因子整数。$K$ 中的一个元素 $\\alpha$ 是代数整数，如果其在 $\\mathbb{Q}$ 上的极小多项式具有整数系数。$K$ 中的任何元素 $\\alpha$ 都可以唯一地写成 $\\alpha = a + b\\sqrt{d}$ 的形式，其中 $a, b \\in \\mathbb{Q}$。$\\alpha$ 的极小多项式（如果 $b \\neq 0$）由下式给出\n$$ (x - \\alpha)(x - \\sigma(\\alpha)) = x^2 - (\\alpha + \\sigma(\\alpha))x + \\alpha\\sigma(\\alpha) = 0 $$\n其中 $\\sigma$ 是 $K$ 的非平凡自同构，它将 $\\sqrt{d}$ 映为 $-\\sqrt{d}$。这两个系数是 $\\alpha$ 的迹和范数：\n$$ \\operatorname{Tr}_{K/\\mathbb{Q}}(\\alpha) = \\alpha + \\sigma(\\alpha) = (a+b\\sqrt{d}) + (a-b\\sqrt{d}) = 2a $$\n$$ \\operatorname{N}_{K/\\mathbb{Q}}(\\alpha) = \\alpha \\sigma(\\alpha) = (a+b\\sqrt{d})(a-b\\sqrt{d}) = a^2 - db^2 $$\n要使 $\\alpha$ 成为代数整数，其迹和范数必须是整数。因此，我们要求：\n1. $2a \\in \\mathbb{Z}$\n2. $a^2 - db^2 \\in \\mathbb{Z}$\n\n令 $m = 2a$，则 $m \\in \\mathbb{Z}$ 且 $a = \\frac{m}{2}$。将此代入范数条件，得到：\n$$ \\left(\\frac{m}{2}\\right)^2 - db^2 = \\frac{m^2}{4} - db^2 \\in \\mathbb{Z} $$\n两边乘以 $4$ 得到 $m^2 - 4db^2 \\in 4\\mathbb{Z}$。设 $b = \\frac{n}{k}$，其中 $n,k \\in \\mathbb{Z}$，$k0$，且 $\\gcd(n,k)=1$。条件变为 $m^2 - 4d\\frac{n^2}{k^2} \\in 4\\mathbb{Z}$。这意味着 $k^2$ 必须整除 $4dn^2$。由于 $\\gcd(n,k)=1$，$k^2$ 必须整除 $4d$。因为 $d$ 是无平方因子的，所以 $k$ 的任何除 $2$ 以外的素因子在 $d$ 中最多出现一次，因此它不可能在 $k^2$ 中出现二次。这迫使 $k$ 只能是 $1$ 或 $2$。\n因此，$b$ 必须具有 $\\frac{j}{2}$ 的形式，其中 $j$ 是某个整数。我们把 $\\alpha$ 写成 $\\alpha = \\frac{m}{2} + \\frac{j}{2}\\sqrt{d} = \\frac{m+j\\sqrt{d}}{2}$。\n范数条件 $a^2-db^2 \\in \\mathbb{Z}$ 变为 $(\\frac{m}{2})^2 - d(\\frac{j}{2})^2 = \\frac{m^2-dj^2}{4} \\in \\mathbb{Z}$。\n这要求 $m^2 - dj^2 \\equiv 0 \\pmod{4}$，其中 $m,j \\in \\mathbb{Z}$。\n\n我们根据 $d$ 模 $4$ 的值来分析这个同余式：\n情况 I：$d \\equiv 2 \\pmod{4}$ 或 $d \\equiv 3 \\pmod{4}$。\n模 $4$ 的平方数为 $0^2 \\equiv 0$, $1^2 \\equiv 1$, $2^2 \\equiv 0$, $3^2 \\equiv 1$。\n如果 $d \\equiv 2 \\pmod{4}$，同余式为 $m^2 - 2j^2 \\equiv 0 \\pmod{4}$。如果 $j$ 是奇数 ($j^2 \\equiv 1$)，则 $m^2 \\equiv 2 \\pmod{4}$，这是不可能的。因此 $j$ 必须是偶数，记为 $j=2k$。那么 $m^2 - 2(4k^2) \\equiv m^2 \\equiv 0 \\pmod{4}$，这意味着 $m$ 也必须是偶数，记为 $m=2l$。所以，$\\alpha = \\frac{2l+2k\\sqrt{d}}{2} = l+k\\sqrt{d}$，其中 $l,k \\in \\mathbb{Z}$。整数环为 $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{d}]$，一个整基是 $\\{1, \\sqrt{d}\\}$。\n如果 $d \\equiv 3 \\pmod{4}$，同余式为 $m^2 - 3j^2 \\equiv m^2+j^2 \\equiv 0 \\pmod{4}$。如果 $j$ 是奇数 ($j^2 \\equiv 1$)，则 $m^2 \\equiv -1 \\equiv 3 \\pmod{4}$，这是不可能的。因此 $j$ 必须是偶数。如前所述，这也意味着 $m$ 也必须是偶数。整数环同样是 $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{d}]$，基为 $\\{1, \\sqrt{d}\\}$。\n\n情况 II：$d \\equiv 1 \\pmod{4}$。\n同余式为 $m^2 - j^2 \\equiv 0 \\pmod{4}$。这个条件成立当且仅当 $m$ 和 $j$ 的奇偶性相同 ($m \\equiv j \\pmod{2}$) 。\n如果 $m, j$ 都是偶数，即 $m=2l, j=2k$，则 $\\alpha = l+k\\sqrt{d}$，是 $\\mathbb{Z}[\\sqrt{d}]$ 中的一个元素。\n如果 $m, j$ 都是奇数，即 $m=2l+1, j=2k+1$，则 $\\alpha = \\frac{(2l+1)+(2k+1)\\sqrt{d}}{2} = l+k\\sqrt{d} + \\frac{1+\\sqrt{d}}{2}$。\n$K$ 中所有的代数整数都可以表示为 $1$ 和 $\\frac{1+\\sqrt{d}}{2}$ 的 $\\mathbb{Z}$-线性组合。\n元素 $\\omega = \\frac{1+\\sqrt{d}}{2}$ 本身就是一个整数，因为它的极小多项式是 $x^2 - x + \\frac{1-d}{4} = 0$，并且由于 $d \\equiv 1 \\pmod{4}$，$(1-d)/4$ 是一个整数。因此，整数环是 $\\mathcal{O}_K = \\mathbb{Z}[\\frac{1+\\sqrt{d}}{2}]$，一个整基是 $\\{1, \\frac{1+\\sqrt{d}}{2}\\}$。\n\n现在我们分析给定的四个数域：\n- 对于 $K_1 = \\mathbb{Q}(\\sqrt{5})$，我们有 $d=5$。由于 $5 \\equiv 1 \\pmod{4}$，这属于情况 II。一个整基是 $\\{1, \\frac{1+\\sqrt{5}}{2}\\}$。\n- 对于 $K_2 = \\mathbb{Q}(\\sqrt{13})$，我们有 $d=13$。由于 $13 \\equiv 1 \\pmod{4}$，这属于情况 II。一个整基是 $\\{1, \\frac{1+\\sqrt{13}}{2}\\}$。\n- 对于 $K_3 = \\mathbb{Q}(\\sqrt{-3})$，我们有 $d=-3$。由于 $-3 = 4(-1) + 1$，我们有 $-3 \\equiv 1 \\pmod{4}$。这属于情况 II。一个整基是 $\\{1, \\frac{1+\\sqrt{-3}}{2}\\}$。\n- 对于 $K_4 = \\mathbb{Q}(\\sqrt{-7})$，我们有 $d=-7$。由于 $-7 = 4(-2) + 1$，我们有 $-7 \\equiv 1 \\pmod{4}$。这属于情况 II。一个整基是 $\\{1, \\frac{1+\\sqrt{-7}}{2}\\}$。\n\n所有四个数域都属于情况 II。我们现在使用整基 $\\{\\beta_1, \\beta_2\\} = \\{1, \\frac{1+\\sqrt{d}}{2}\\}$ 来计算一般情况 $d \\equiv 1 \\pmod{4}$ 下的域判别式 $D_K$。判别式定义为 $D_{K} = \\det(\\operatorname{Tr}_{K/\\mathbb{Q}}(\\beta_{i}\\beta_{j}))$。我们计算矩阵的各项：\n- $\\beta_1^2 = 1^2 = 1$。 $\\operatorname{Tr}(\\beta_1^2) = \\operatorname{Tr}(1) = \\operatorname{Tr}(1+0\\sqrt{d}) = 2 \\cdot 1 = 2$。\n- $\\beta_1\\beta_2 = 1 \\cdot \\frac{1+\\sqrt{d}}{2} = \\frac{1+\\sqrt{d}}{2}$。 $\\operatorname{Tr}(\\beta_1\\beta_2) = \\operatorname{Tr}(\\frac{1}{2} + \\frac{1}{2}\\sqrt{d}) = 2 \\cdot \\frac{1}{2} = 1$。\n- $\\beta_2\\beta_1 = \\beta_1\\beta_2$，所以 $\\operatorname{Tr}(\\beta_2\\beta_1) = 1$。\n- $\\beta_2^2 = \\left(\\frac{1+\\sqrt{d}}{2}\\right)^2 = \\frac{1+2\\sqrt{d}+d}{4} = \\frac{1+d}{4} + \\frac{1}{2}\\sqrt{d}$。\n$\\operatorname{Tr}(\\beta_2^2) = \\operatorname{Tr}\\left(\\frac{1+d}{4} + \\frac{1}{2}\\sqrt{d}\\right) = 2 \\cdot \\frac{1+d}{4} = \\frac{1+d}{2}$。\n\n迹矩阵为：\n$$ \\begin{pmatrix} \\operatorname{Tr}(\\beta_1^2)  \\operatorname{Tr}(\\beta_1\\beta_2) \\\\ \\operatorname{Tr}(\\beta_2\\beta_1)  \\operatorname{Tr}(\\beta_2^2) \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  \\frac{1+d}{2} \\end{pmatrix} $$\n判别式是该矩阵的行列式：\n$$ D_K = \\det \\begin{pmatrix} 2  1 \\\\ 1  \\frac{1+d}{2} \\end{pmatrix} = (2)\\left(\\frac{1+d}{2}\\right) - (1)(1) = (1+d) - 1 = d. $$\n因此，对于任何二次数域 $\\mathbb{Q}(\\sqrt{d})$ 且 $d \\equiv 1 \\pmod{4}$，域判别式为 $D_K = d$。\n\n我们应用此结果来求每个特定域的判别式：\n- 对于 $K_1=\\mathbb{Q}(\\sqrt{5})$ 且 $d=5$：$D_{K_1}=5$。\n- 对于 $K_2=\\mathbb{Q}(\\sqrt{13})$ 且 $d=13$：$D_{K_2}=13$。\n- 对于 $K_3=\\mathbb{Q}(\\sqrt{-3})$ 且 $d=-3$：$D_{K_3}=-3$。\n- 对于 $K_4=\\mathbb{Q}(\\sqrt{-7})$ 且 $d=-7$：$D_{K_4}=-7$。\n\n最终答案是按指定顺序排列的这些判别式的行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 5  13  -3  -7 \\end{pmatrix}}\n$$", "id": "3010135"}, {"introduction": "计算类群的核心算法依赖于几何数论中的一个强大结果——闵可夫斯基界。该理论保证每个理想类中都存在一个范数有界的整理想，从而将一个无限的抽象群结构问题简化为有限的、具体的计算任务。这项练习将引导我们完整地走过这一计算流程：首先确定闵可夫斯基界，然后分析界下素数的分解情况，并通过考察这些素理想之间的关系来揭示类群的结构。这是一个计算非平凡类群的典范示例，掌握此方法是理解类数理论的中心环节。[@problem_id:3010119]", "problem": "设 $K=\\mathbb{Q}(\\sqrt{-23})$。从整数环、域范数、判别式以及数几何中的Minkowski界的定义出发，通过枚举必须有有界范数代表元的理想类，确定确切的类数 $h_{K}$。你的推导必须：\n\n- 确定整数环 $\\mathcal{O}_{K}$ 和判别式 $D_{K}$。\n- 给出一个具体的Minkowski界 $M$ 的合理依据，并解释为什么每个理想类都包含一个范数至多为 $M$ 的整理想。\n- 通过将整生成元的最小多项式对这些素数取模，枚举位于有理素数 $2$ 和 $3$ 之上的素理想（这些是范数至多为 $M$ 的唯一可能情况）。\n- 通过在 $\\mathcal{O}_{K}$ 中求解范数方程 $N_{K/\\mathbb{Q}}(\\alpha)=2$ 和 $N_{K/\\mathbb{Q}}(\\alpha)=3$ 来判断哪些素理想是主理想，并利用 $K$ 上的复共轭来关联相应的理想类。\n- 使用范数较小的显式主元来建立位于 $2$ 和 $3$ 之上的素理想类之间的关系，并推导出类群唯一生成元的精确阶。\n\n最后总结出 $h_{K}$ 的确切值。你的最终答案应表示为一个没有单位的整数。不需要四舍五入。", "solution": "问题是确定二次数域 $K=\\mathbb{Q}(\\sqrt{-23})$ 的类数 $h_K$。解题过程将系统地遵循所要求的步骤。\n\n所述问题在数学上是适定的，其科学基础是已建立的数论，并且是自洽的。这是研究二次域类群中的一个标准的可解问题。因此，该问题是有效的。\n\n**第1步：整数环与判别式**\n\n该域为 $K = \\mathbb{Q}(\\sqrt{d})$，其中 $d=-23$。由于 $d = -23 \\equiv 1 \\pmod{4}$， $K$ 的整数环由 $\\mathcal{O}_K = \\mathbb{Z}\\left[\\frac{1+\\sqrt{-23}}{2}\\right]$ 给出。令 $\\omega = \\frac{1+\\sqrt{-23}}{2}$。则 $\\mathcal{O}_K = \\mathbb{Z}[\\omega]$。$\\mathcal{O}_K$ 中的元素形式为 $a+b\\omega$，其中 $a, b \\in \\mathbb{Z}$。\n\n对于 $d \\equiv 1 \\pmod{4}$ 的情况，$K$ 的判别式为 $D_K = d$。因此，对于 $K=\\mathbb{Q}(\\sqrt{-23})$，判别式为 $D_K = -23$。\n\n**第2步：Minkowski界**\n\n对于一个次数为 $n$、有 $2s$ 个复嵌入的代数数域 $K$，其Minkowski界 $M_K$ 由公式 $M_K = \\frac{n!}{n^n} \\left(\\frac{4}{\\pi}\\right)^s \\sqrt{|D_K|}$ 给出。\n对于 $K=\\mathbb{Q}(\\sqrt{-23})$，我们有 $n=2$，并且由于 $D_K  0$，存在 $2s=2$ 个复嵌入（没有实嵌入），因此 $s=1$。\n该界为：\n$$M_K = \\frac{2!}{2^2} \\left(\\frac{4}{\\pi}\\right)^1 \\sqrt{|-23|} = \\frac{2}{4} \\cdot \\frac{4}{\\pi} \\sqrt{23} = \\frac{2\\sqrt{23}}{\\pi}$$\n为了得到一个具体的数值界，我们进行近似：$\\sqrt{23} \\approx 4.796$ 且 $\\pi \\approx 3.14159$。\n$$M_K \\approx \\frac{2 \\times 4.796}{3.14159} \\approx \\frac{9.592}{3.14159} \\approx 3.053$$\nMinkowski定理指出，类群 $Cl(K)$ 中的每个理想类都包含一个整理想 $\\mathfrak{a}$，其范数 $N(\\mathfrak{a}) \\le M_K$。由于 $N(\\mathfrak{a})$ 必须是整数，我们只需要考虑范数小于或等于 $\\lfloor M_K \\rfloor = 3$ 的整理想。因此，类群由范数为素数 $p \\le 3$（即 $p=2$ 和 $p=3$）的素理想的类生成。\n\n**第3步：素理想分解**\n\n为了分析有理素数 $p=2$ 和 $p=3$ 在 $\\mathcal{O}_K$ 中的分解，我们使用Dedekind判准以及生成元 $\\omega = \\frac{1+\\sqrt{-23}}{2}$ 的最小多项式。\n$\\omega$ 的迹是 $\\text{Tr}(\\omega) = \\omega + \\bar{\\omega} = \\frac{1+\\sqrt{-23}}{2} + \\frac{1-\\sqrt{-23}}{2} = 1$。\n$\\omega$ 的范数是 $N(\\omega) = \\omega\\bar{\\omega} = \\left(\\frac{1+\\sqrt{-23}}{2}\\right)\\left(\\frac{1-\\sqrt{-23}}{2}\\right) = \\frac{1-(-23)}{4} = \\frac{24}{4}=6$。\n$\\omega$ 在 $\\mathbb{Q}$ 上的最小多项式是 $f(x) = x^2 - \\text{Tr}(\\omega)x + N(\\omega) = x^2 - x + 6$。\n\n- **(2)的分解**：我们将 $f(x)$ 模 $2$ 约化：\n$$x^2 - x + 6 \\equiv x^2+x \\equiv x(x+1) \\pmod{2}$$\n该多项式在 $\\mathbb{F}_2$ 上分裂成两个不同的一次因子。因此，素数 $2$ 在 $\\mathcal{O}_K$ 中分裂成两个范数为 $2$ 的不同素理想的乘积。\n$$(2) = \\mathfrak{p}_2 \\mathfrak{p}_2'$$\n其中 $\\mathfrak{p}_2 = (2, \\omega)$ 且 $\\mathfrak{p}_2' = (2, \\omega-1)$。注意 $(2, \\omega-1)=(2,\\omega+1)$。我们有 $N(\\mathfrak{p}_2)=N(\\mathfrak{p}_2')=2$。\n\n- **(3)的分解**：我们将 $f(x)$ 模 $3$ 约化：\n$$x^2 - x + 6 \\equiv x^2-x \\equiv x(x-1) \\pmod{3}$$\n该多项式在 $\\mathbb{F}_3$ 上分裂成两个不同的一次因子。因此，素数 $3$ 在 $\\mathcal{O}_K$ 中分裂成两个范数为 $3$ 的不同素理想的乘积。\n$$(3) = \\mathfrak{p}_3 \\mathfrak{p}_3'$$\n其中 $\\mathfrak{p}_3 = (3, \\omega)$ 且 $\\mathfrak{p}_3' = (3, \\omega-1)$。我们有 $N(\\mathfrak{p}_3)=N(\\mathfrak{p}_3')=3$。\n\n**第4步：检验是否为主理想**\n\n一个理想 $\\mathfrak{a}$ 是主理想，如果对某个 $\\alpha \\in \\mathcal{O}_K$ 有 $\\mathfrak{a}=(\\alpha)$。若是如此，则 $N(\\mathfrak{a}) = |N_{K/\\mathbb{Q}}(\\alpha)|$。一个元素 $\\alpha=a+b\\omega \\in \\mathcal{O}_K$（其中 $a, b \\in \\mathbb{Z}$）的范数为：\n$$N(\\alpha) = N(a+b\\omega) = (a+b\\omega)(a+b\\bar{\\omega}) = a^2 + ab(\\omega+\\bar{\\omega}) + b^2\\omega\\bar{\\omega} = a^2+ab+6b^2$$\n这也可以写成 $N(\\alpha) = (a+\\frac{b}{2})^2 + \\frac{23}{4}b^2$。由于范数是平方和，它总是非负的。\n\n- **范数为2的素理想是主理想吗？**\n我们寻找 $\\alpha \\in \\mathcal{O}_K$ 使得 $N(\\alpha)=2$。这需要求解关于整数 $a, b$ 的方程 $a^2+ab+6b^2=2$。\n如果 $b=0$，则 $a^2=2$，这对 $a$ 没有整数解。\n如果 $b \\ne 0$，则 $|b| \\ge 1$。范数为 $N(\\alpha)=(a+\\frac{b}{2})^2+\\frac{23}{4}b^2 \\ge \\frac{23}{4}b^2 \\ge \\frac{23}{4} = 5.75$。\n由于 $5.752$，当 $b \\ne 0$ 时，对 $a, b$ 没有整数解。\n因此，在 $\\mathcal{O}_K$ 中没有范数为 $2$ 的元素。理想 $\\mathfrak{p}_2$ 和 $\\mathfrak{p}_2'$ 不是主理想。\n\n- **范数为3的素理想是主理想吗？**\n我们寻找 $\\alpha \\in \\mathcal{O}_K$ 使得 $N(\\alpha)=3$。这需要求解 $a^2+ab+6b^2=3$。\n使用与上面相同的论证，如果 $b \\ne 0$，则 $N(\\alpha) \\ge 5.75  3$。\n如果 $b=0$，则 $a^2=3$，这对 $a$ 没有整数解。\n因此，在 $\\mathcal{O}_K$ 中没有范数为 $3$ 的元素。理想 $\\mathfrak{p}_3$ 和 $\\mathfrak{p}_3'$ 不是主理想。\n\n**第5步：类群中的关系**\n\n类群 $Cl(K)$ 由类 $[\\mathfrak{p}_2]$ 和 $[\\mathfrak{p}_3]$ 生成。\n由 $(2) = \\mathfrak{p}_2 \\mathfrak{p}_2'$，我们得到 $[\\mathfrak{p}_2][\\mathfrak{p}_2'] = [ (2) ] = 1$，其中 $1$ 是单位类（主理想类）。因此 $[\\mathfrak{p}_2'] = [\\mathfrak{p}_2]^{-1}$。由于 $K$ 是一个虚二次域，共轭理想 $\\bar{\\mathfrak{a}}$ 的类是理想 $\\mathfrak{a}$ 的类的逆。确实，$\\mathfrak{p}_2' = (2, \\omega-1) = (2, \\bar{\\omega}) = \\bar{\\mathfrak{p}}_2$。\n\n我们必须确定生成元 $[\\mathfrak{p}_2]$ 的阶。\n- $[\\mathfrak{p}_2]^2 = 1$ 吗？这将意味着 $\\mathfrak{p}_2^2$ 是主理想。$N(\\mathfrak{p}_2^2)=N(\\mathfrak{p}_2)^2 = 2^2=4$。我们检查范数为 $4$ 的元素：$a^2+ab+6b^2=4$。同样，如果 $b \\ne 0$，则 $N(\\alpha) \\ge 5.75  4$。如果 $b=0$，则 $a^2=4 \\implies a=\\pm 2$。元素 $\\pm 2$ 生成理想 $(2)=\\mathfrak{p}_2\\mathfrak{p}_2'$。由于 $\\mathfrak{p}_2 \\ne \\mathfrak{p}_2'$，我们有 $\\mathfrak{p}_2^2 \\ne (2)$。因为没有其他范数为 $4$ 的主理想，$\\mathfrak{p}_2^2$ 不是主理想。所以，$[\\mathfrak{p}_2]^2 \\ne 1$。\n\n- $[\\mathfrak{p}_2]^3 = 1$ 吗？这将意味着 $\\mathfrak{p}_2^3$ 是主理想。我们寻找一个范数为 $N(\\mathfrak{p}_2^3)=8$ 的元素。我们求解 $a^2+ab+6b^2=8$。\n如果 $b=\\pm 1$，方程变为 $a^2 \\pm a + 6 = 8 \\implies a^2\\pm a - 2 = 0$。\n对于 $b=1$，$a^2+a-2=0 \\implies (a+2)(a-1)=0$，所以 $a=1$ 或 $a=-2$。\n这给出了两个范数为 $8$ 的元素：$\\alpha_1 = 1+\\omega$ 和 $\\alpha_2 = -2+\\omega$。\n我们来分析主理想 $(\\alpha_1)=(1+\\omega)$。$N(1+\\omega)=8=2^3$。所以 $(1+\\omega)$ 必定是位于 $2$ 之上的三个素理想的乘积。\n为了找到它的分解，我们检查 $1+\\omega$ 是否在 $\\mathfrak{p}_2$ 或 $\\mathfrak{p}_2'$ 中。\n在商环 $\\mathcal{O}_K/\\mathfrak{p}_2 \\cong \\mathbb{F}_2$ 中，$\\omega$ 映射到根 $0$。因此 $1+\\omega \\mapsto 1+0=1 \\not\\equiv 0$。所以 $1+\\omega \\notin \\mathfrak{p}_2$。\n在商环 $\\mathcal{O}_K/\\mathfrak{p}_2' \\cong \\mathbb{F}_2$ 中，$\\omega$ 映射到根 $1$。因此 $1+\\omega \\mapsto 1+1=2 \\equiv 0$。所以 $1+\\omega \\in \\mathfrak{p}_2'$。\n由于 $(1+\\omega)$ 可被 $\\mathfrak{p}_2'$ 整除但不能被 $\\mathfrak{p}_2$ 整除，其分解必定是 $(1+\\omega) = (\\mathfrak{p}_2')^3$。\n这意味着 $(\\mathfrak{p}_2')^3$ 是一个主理想，所以在类群中 $[\\mathfrak{p}_2']^3=1$。由于 $[\\mathfrak{p}_2']\\ne 1$，$[\\mathfrak{p}_2']$ 的阶恰好是 $3$。因为 $[\\mathfrak{p}_2'] = [\\mathfrak{p}_2]^{-1}$，所以 $[\\mathfrak{p}_2]$ 的阶也是 $3$。\n\n现在我们找出 $[\\mathfrak{p}_2]$ 和 $[\\mathfrak{p}_3]$ 之间的关系。考虑元素 $\\omega \\in \\mathcal{O}_K$，其范数为 $N(\\omega)=6$。主理想 $(\\omega)$ 的范数为 $6$，所以其素理想分解为 $(\\omega)=\\mathfrak{q}_2\\mathfrak{q}_3$，其中 $\\mathfrak{q}_2$ 是位于 $2$ 之上的一个素理想，$\\mathfrak{q}_3$ 是位于 $3$ 之上的一个素理想。\n- 被位于 $2$ 之上的素理想整除性：$\\mathfrak{p}_2=(2,\\omega)$。显然 $\\omega \\in \\mathfrak{p}_2$。所以 $\\mathfrak{q}_2 = \\mathfrak{p}_2$。\n- 被位于 $3$ 之上的素理想整除性：$\\mathfrak{p}_3=(3,\\omega)$。显然 $\\omega \\in \\mathfrak{p}_3$。所以 $\\mathfrak{q}_3 = \\mathfrak{p}_3$。\n因此，我们有理想等式 $(\\omega) = \\mathfrak{p}_2\\mathfrak{p}_3$。\n这在类群中给出了一个关系：\n$$[(\\omega)] = [\\mathfrak{p}_2\\mathfrak{p}_3] = [\\mathfrak{p}_2][\\mathfrak{p}_3] = 1$$\n这意味着 $[\\mathfrak{p}_3] = [\\mathfrak{p}_2]^{-1}$。利用 $[\\mathfrak{p}_2]$ 的阶为 $3$ 这一事实，我们可以将其写为 $[\\mathfrak{p}_3] = [\\mathfrak{p}_2]^2$。\n\n**结论：类数**\n\n类群 $Cl(K)$ 由类 $[\\mathfrak{p}_2]$ 和 $[\\mathfrak{p}_3]$ 生成。我们已经发现 $[\\mathfrak{p}_3]$ 是 $[\\mathfrak{p}_2]$ 的幂。因此，类群仅由 $[\\mathfrak{p}_2]$（或任何其他非平凡类）生成。它是一个循环群。\n我们已经确定生成元 $[\\mathfrak{p}_2]$ 的阶为 $3$。\n因此，类群为 $Cl(K) = \\{[\\mathcal{O}_K], [\\mathfrak{p}_2], [\\mathfrak{p}_2]^2\\}$，这是一个 $3$ 阶循环群。\n类数 $h_K$ 是类群的阶。\n$$h_K = |Cl(K)| = 3$$\n分析证实，类群是循环群，由一个阶为 $3$ 的元素生成。类数的精确值是 $3$。", "answer": "$$\\boxed{3}$$", "id": "3010119"}, {"introduction": "在戴德金引入理想语言之前，高斯已经在他关于二元二次型的研究中发展了类群的理论。这两种观点之间存在着深刻的同构关系：给定判别式的本原二次型类群与相应二次序的理想类群是同构的。这项练习提供了一种计算类群的替代方法，尤其对于虚二次域，该方法更为具体和直观。通过枚举既约型并利用其复合律来确定群结构，我们不仅能验证从理想论角度得到的结果，还能更深刻地体会到这一学科丰富的历史渊源和理论联系。[@problem_id:3010133]", "problem": "设 $K=\\mathbb{Q}(\\sqrt{-21})$ 是一个虚二次域，其整数环为 $\\mathcal{O}_{K}=\\mathbb{Z}[\\sqrt{-21}]$。其域判别式为 $D=-84$。从正定本原二元二次型和真等价的定义出发，并仅使用简化不等式，完成以下任务：\n\n- 通过求解满足条件 $a0$，$c0$，$|b|\\leq a\\leq c$，并且如果 $|b|=a$ 或 $a=c$，则 $b \\ge 0$ 的方程 $b^{2}-4ac=D$，枚举出所有判别式为 $D=-84$ 的正定本原二元二次型的简化类。这里，一个二次型 $[a,b,c]$ 是本原的，如果 $\\gcd(a,b,c)=1$，其中 $\\gcd$ 表示最大公约数（gcd）。\n- 使用二元二次型的复合律来确定判别式为 $D=-84$ 的型类群的群结构，并指出哪些简化类是2阶的。\n- 解释判别式为 $D$ 的本原二元二次型类与 $\\mathcal{O}_{K}$ 中判别式为 $D$ 的序的理想类之间的标准对应关系，并验证上面计算出的型类群与理想类群 $\\mathrm{Cl}(\\mathcal{O}_{K})$ 同构。\n\n作为你的最终答案，报告类数 $h_{K}=|\\mathrm{Cl}(\\mathcal{O}_{K})|$。无需四舍五入。", "solution": "问题要求通过分析相关的二元二次型来确定二次域 $K=\\mathbb{Q}(\\sqrt{-21})$ 的类数。该过程包括三个主要步骤：枚举简化型，确定型类群的结构，以及将其与该域整数环的理想类群联系起来。\n\n首先，我们验证所提供的信息。该域为 $K=\\mathbb{Q}(\\sqrt{-d})$，其中 $d=21$。由于 $-21 \\equiv 3 \\pmod{4}$，整数环确实是 $\\mathcal{O}_{K}=\\mathbb{Z}[\\sqrt{-21}]$。判别式为 $D = 4(-21) = -84$。问题陈述是适定的并且事实正确。\n\n**第1部分：枚举简化型**\n\n我们寻求找到所有满足判别式为 $D=-84$ 的正定本原简化二元二次型 $[a, b, c]$ 的以下条件的整数三元组 $(a, b, c)$：\n1.  判别式：$b^2 - 4ac = -84$。\n2.  正定性：$a > 0$ 且 $c > 0$。条件 $b^2 - 4ac = -84  0$ 和 $a>0$ 意味着 $c = \\frac{b^2+84}{4a} > 0$。\n3.  简化性：$|b| \\leq a \\leq c$，并且如果 $|b|=a$ 或 $a=c$，则 $b \\ge 0$。\n4.  本原性：$\\gcd(a, b, c) = 1$。\n5.  同余性：$b \\equiv D \\pmod{2} \\implies b \\equiv -84 \\pmod{2} \\implies b \\equiv 0 \\pmod{2}$。判别式方程 $b^2 = 4ac - 84 = 4(ac-21)$ 已经意味着 $b$ 必须是偶数。\n\n从简化条件 $|b| \\leq a$ 和 $a \\leq c$，我们得到 $a^2 \\leq ac$。代入 $ac = \\frac{b^2+84}{4}$：\n$$a^2 \\leq \\frac{b^2+84}{4} \\implies 4a^2 \\leq b^2+84$$\n使用 $|b| \\leq a$，我们有 $b^2 \\leq a^2$。因此：\n$$4a^2 \\leq a^2 + 84 \\implies 3a^2 \\leq 84 \\implies a^2 \\leq 28$$\n这给出了 $a$ 的一个上界：$a \\leq \\sqrt{28} \\approx 5.29$。因为 $a$ 必须是正整数，所以 $a \\in \\{1, 2, 3, 4, 5\\}$。我们现在系统地检查 $a$ 和 $b$ 的可能值。\n\n-   如果 $a=1$：条件 $|b| \\leq a$ 和 $b$ 为偶数意味着 $b=0$。\n    $0^2 - 4(1)c = -84 \\implies 4c = 84 \\implies c=21$。\n    二次型为 $[1, 0, 21]$。它满足所有简化条件（$|0|\\le 1\\le 21$）和本原性（$\\gcd(1,0,21)=1$）。\n\n-   如果 $a=2$：条件 $|b| \\leq a$ 和 $b$ 为偶数允许 $b \\in \\{0, \\pm 2\\}$。\n    如果 $b=0$：$8c=84$，没有整数解 $c$。\n    如果 $b=\\pm 2$：$4 - 8c = -84 \\implies 8c=88 \\implies c=11$。我们得到候选型 $[2, \\pm 2, 11]$。\n    对于 $[2, 2, 11]$，满足 $|2| \\le 2 \\le 11$。由于 $|b|=a$，我们检查 $b \\ge 0$，条件满足，因此它是简化的。\n    对于 $[2, -2, 11]$，由于 $|b|=a$ 但 $b  0$，它不满足简化条件中的附加条款。\n\n-   如果 $a=3$：条件 $|b| \\leq a$ 和 $b$ 为偶数允许 $b \\in \\{0, \\pm 2\\}$。\n    如果 $b=0$：$12c=84 \\implies c=7$。\n    二次型为 $[3, 0, 7]$。它满足简化条件（$|0|\\le 3\\le 7$）和本原性（$\\gcd(3,0,7)=1$）。\n    如果 $b=\\pm 2$：没有整数解 $c$。\n\n-   如果 $a=4$：没有整数解。\n\n-   如果 $a=5$：条件 $|b| \\leq a$ 和 $b$ 为偶数允许 $b \\in \\{0, \\pm 2, \\pm 4\\}$。\n    如果 $b=\\pm 4$：$16 - 20c = -84 \\implies 20c=100 \\implies c=5$。我们得到候选型 $[5, \\pm 4, 5]$。\n    对于 $[5, 4, 5]$，满足 $|4| \\le 5 \\le 5$。由于 $a=c$，我们检查 $b \\ge 0$，条件满足，因此它是简化的。\n    对于 $[5, -4, 5]$，由于 $a=c$ 但 $b  0$，它不满足简化条件中的附加条款。\n\n判别式为 $D=-84$ 的简化、正定、本原二元二次型的完整列表是：\n$[1, 0, 21]$, $[2, 2, 11]$, $[3, 0, 7]$, $[5, 4, 5]$。\n\n总共有 $4$ 个不同的简化二次型，因此有 $4$ 个不同的二次型类。类的数量就是类数，即 $h(-84)=4$。\n\n**第2部分：型类群的群结构**\n\n型类群 $G$ 的阶为 $4$。阶为 $4$ 的群要么是循环群（$\\mathbb{Z}/4\\mathbb{Z}$），要么是克莱因四元群（$\\mathbb{Z}/2\\mathbb{Z} \\times \\mathbb{Z}/2\\mathbb{Z}$）。我们可以通过检查元素的阶来确定其结构。一个类如果不是单位元且是自身的逆元，则其阶为 $2$。一个类的逆元是其代表元 $[a,b,c]$ 对应的 $[a,-b,c]$ 的类。如果一个简化型 $[a,b,c]$ 是含糊型（ambiguous form），即满足 $b=0$ 或 $a=b$ 或 $a=c$，那么它对应的类就是2阶的（或1阶，如果是单位元）。\n\n-   $[1, 0, 21]$：这是主类（单位元），其阶为 $1$。它是含糊型（$b=0$）。\n-   $[2, 2, 11]$：这是含糊型（$a=b$），所以这个类的阶为 $2$。\n-   $[3, 0, 7]$：这是含糊型（$b=0$），所以这个类的阶为 $2$。\n-   $[5, 4, 5]$：这是含糊型（$a=c$），所以这个类的阶为 $2$。\n\n由于所有三个非单位元都具有2阶，该群不可能是循环群。该群必须是克莱因四元群，$G \\cong \\mathbb{Z}/2\\mathbb{Z} \\times \\mathbb{Z}/2\\mathbb{Z}$。阶为2的简化类由 $[2, 2, 11]$, $[3, 0, 7]$ 和 $[5, 4, 5]$ 代表。\n\n**第3部分：与理想类群的对应关系**\n\n判别式为 $D$ 的型类群与判别式为 $D$ 的二次序 $\\mathcal{O}$ 的理想类群 $\\mathrm{Cl}(\\mathcal{O})$ 之间存在一个典范同构。在我们的例子中，$D=-84$ 是极大序 $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{-21}]$ 的判别式，所以我们有型类群与 $\\mathrm{Cl}(\\mathcal{O}_K)$ 之间的一个同构。\n\n从型类 $[[a,b,c]]$ 到理想类的映射由将二次型映至理想 $\\mathfrak{a} = \\left(a, \\frac{-b+\\sqrt{D}}{2}\\right)$ 给出。该理想的范数为 $N(\\mathfrak{a}) = a$。\n\n让我们为我们的代表元验证这一点：$D = -84$，$\\sqrt{D} = 2\\sqrt{-21}$。\n-   $[[1,0,21]] \\mapsto \\mathfrak{a}_1 = \\left(1, \\frac{0+2\\sqrt{-21}}{2}\\right) = (1, \\sqrt{-21})=\\mathcal{O}_K$。这是主理想，代表 $\\mathrm{Cl}(\\mathcal{O}_K)$ 中的单位元。\n\n-   $[[3,0,7]] \\mapsto \\mathfrak{a}_2 = \\left(3, \\frac{0+2\\sqrt{-21}}{2}\\right) = (3, \\sqrt{-21})$。其范数为 $N(\\mathfrak{a}_2)=3$。为检查其是否为主理想，我们看是否存在元素 $\\alpha = x+y\\sqrt{-21} \\in \\mathcal{O}_K$ 其范数为 $N(\\alpha) = x^2+21y^2=3$。该方程没有整数解 $x,y$。所以 $\\mathfrak{a}_2$ 不是主理想。它的平方是 $\\mathfrak{a}_2^2 = (9, 3\\sqrt{-21}, -21) = (3)$，这是主理想。因此，类 $[\\mathfrak{a}_2]$ 的阶为 $2$。\n\n-   $[[2,2,11]] \\mapsto \\mathfrak{a}_3 = \\left(2, \\frac{-2+2\\sqrt{-21}}{2}\\right) = (2, -1+\\sqrt{-21})$。其范数为 $N(\\mathfrak{a}_3)=2$。它不是主理想，因为 $x^2+21y^2=2$ 没有整数解。由于对应的型是2阶的，我们预期 $[\\mathfrak{a}_3]$ 的阶也为 $2$。实际上，$\\mathfrak{a}_3^2 = (4, 2(-1+\\sqrt{-21}), (-1+\\sqrt{-21})^2) = (4, -2+2\\sqrt{-21}, -20-2\\sqrt{-21}) = (2)$。理想 $(2)$ 是主理想，所以 $[\\mathfrak{a}_3]$ 的阶为 $2$。\n\n-   $[[5,4,5]] \\mapsto \\mathfrak{a}_4 = \\left(5, \\frac{-4+2\\sqrt{-21}}{2}\\right) = (5, -2+\\sqrt{-21})$。其范数为 $N(\\mathfrak{a}_4)=5$。它不是主理想，因为 $x^2+21y^2=5$ 没有整数解。由于对应的型是2阶的，我们预期 $[\\mathfrak{a}_4]$ 的阶也为 $2$。\n\n这四个型类对应于 $\\mathcal{O}_K$ 中的四个不同理想类。它们是 $[\\mathcal{O}_K]$，$[\\mathfrak{a}_2]$，$[\\mathfrak{a}_3]$ 和 $[\\mathfrak{a}_4]$。这些理想的范数分别为 $1, 3, 2, 5$，这确保了这些类是不同的。\n同构得到验证：型类群和理想类群的阶都是 $4$，并且都具有克莱因四元群的结构。\n类数是理想类群的阶，即 $h_K=|\\mathrm{Cl}(\\mathcal{O}_{K})|$。根据我们的计算，这个值是 $4$。\n\n最终答案：类数 $h_K = |\\mathrm{Cl}(\\mathcal{O}_K)|$ 是简化型类的数量，我们计算出其值为 $4$。", "answer": "$$\n\\boxed{4}\n$$", "id": "3010133"}]}