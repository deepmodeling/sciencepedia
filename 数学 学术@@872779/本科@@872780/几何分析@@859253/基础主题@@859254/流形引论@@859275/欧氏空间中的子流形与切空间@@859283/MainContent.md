## 引言
在我们生活的世界中，从星球的表面到复杂的机械零件，充满了各种光滑的曲线和[曲面](@entry_id:267450)。为了精确地描述和分析这些几何对象，数学家们发展了一套强大的语言——[微分几何](@entry_id:145818)。其核心概念便是嵌入在欧几里得空间中的“[子流形](@entry_id:159439)”以及在每一点上[对流](@entry_id:141806)形进行线性近似的“[切空间](@entry_id:199137)”。本文旨在系统性地介绍这些基本工具，解决从[平直空间](@entry_id:204618)到弯曲空间上进行微积分推广的根本问题。

通过本文的学习，读者将建立对[子流形理论](@entry_id:190701)的坚实理解。我们将分为三个部分展开：在 **“原理和机制”** 一章中，我们将深入探讨定义[子流形](@entry_id:159439)与[切空间](@entry_id:199137)的多种等价方式，从几何直观到[代数结构](@entry_id:137052)，并引入切丛的概念。接下来，在 **“应用与跨学科联系”** 一章，我们将展示这些理论如何应用于分析[流形](@entry_id:153038)的相交、[可定向性](@entry_id:149777)，并揭示其在物理学、[优化理论](@entry_id:144639)和[地图学](@entry_id:276171)等领域的深刻联系。最后，通过 **“动手实践”** 部分，读者将有机会通过解决具体问题来巩固所学知识，将理论转化为可操作的技能。

## 原理和机制

在本章中，我们将深入探讨[欧几里得空间](@entry_id:138052)中子流形的定义、它们的[切空间](@entry_id:199137)概念，以及这些对象之间的映射。我们将从定义[子流形](@entry_id:159439)的核心思想开始，逐步建立起切空间的几何与代数图像，最终将这些概念推广至更抽象的结构，如[切丛](@entry_id:161294)。

### 欧几里得空间中的[子流形](@entry_id:159439)

尽管一个光滑子流形在直观上是一个在[欧几里得空间](@entry_id:138052) $\mathbb{R}^n$ 中没有“尖角”或“自相交”的光滑几何对象，但我们需要一个精确的数学定义。存在几种等价的定义方式，每一种都从不同角度揭示了子流形的本质。

#### 通过局部拉直定义

最基本、最强大的定义方式是通过[局部坐标](@entry_id:181200)变换将[流形](@entry_id:153038)“拉直”成一个[线性子空间](@entry_id:151815)。这个定义体现了[流形](@entry_id:153038)的核心思想：局部上它看起来像欧几里得空间。

一个非空[子集](@entry_id:261956) $M \subset \mathbb{R}^n$ 被称为一个 **$k$ 维光滑[嵌入子流形](@entry_id:273162) (k-dimensional embedded smooth submanifold)**，如果对于 $M$ 中的每一个点 $p$，都存在一个包含 $p$ 的 $\mathbb{R}^n$ 中的开集 $U$ 和一个从 $U$ 到另一个 $\mathbb{R}^n$ 中开集 $V$ 的光滑[微分同胚](@entry_id:147249)（即一个具有光滑逆映射的光滑双射）$\Phi \colon U \to V$，使得 $\Phi$ 将 $M$ 在 $U$ 中的部分映射到 $\mathbb{R}^n$ 中一个标准的 $k$ 维[线性子空间](@entry_id:151815)上。具体而言，该条件可以写作：
$$
\Phi(M \cap U) = (\mathbb{R}^k \times \{0\}^{n-k}) \cap V
$$
这里的 $\mathbb{R}^k \times \{0\}^{n-k}$ 是 $\mathbb{R}^n$ 中前 $k$ 个坐标不为零，后 $n-k$ 个坐标为零的点的集合。这样的一个映射 $\Phi$ 被称为一个**图卡 (chart)**，它提供了一个局部的“平坦”[坐标系](@entry_id:156346) [@problem_id:3064064]。这个定义保证了 $M$ 本身可以通过限制这些图卡而获得一个光滑流形的结构，并且其包含映射 $i: M \hookrightarrow \mathbb{R}^n$ 是一个[光滑嵌入](@entry_id:637480)。

#### 通过[参数化](@entry_id:272587)定义：浸入与嵌入

另一种常见且在实践中非常有用的定义方式是通过参数化。一个 $k$ 维[子流形](@entry_id:159439)可以被局部地看作是一个从 $\mathbb{R}^k$ 的一个开集出发的[光滑映射](@entry_id:203730)的像。这就引出了**[浸入](@entry_id:161534) (immersion)** 和**嵌入 (embedding)** 的概念。

一个[光滑映射](@entry_id:203730) $f: M^k \to \mathbb{R}^n$（其中 $M^k$ 是一个 $k$ 维光滑流形）被称为一个**[浸入](@entry_id:161534)**，如果它在每一点 $p \in M$ 的[微分](@entry_id:158718) $df_p: T_pM \to \mathbb{R}^n$ 都是[单射](@entry_id:183792)的。这意味着在局部上，$f$ 保持了[切空间](@entry_id:199137)的所有信息，没有“折叠”或“压缩”任何方向。然而，一个[浸入](@entry_id:161534)在全局上可能是自相交的。

一个**嵌入**则是一个更强的概念：它是一个[单射](@entry_id:183792)的浸入，并且是其像上的一个[同胚](@entry_id:146933)。这意味着嵌入不仅在局部上保持了几何结构，而且全局上没有自相交，并且其像的拓扑结构（作为 $\mathbb{R}^n$ 的[子空间](@entry_id:150286)）与源[流形的拓扑](@entry_id:267834)结构完全一致。一个嵌入的像就是一个[嵌入子流形](@entry_id:273162)。

这两者之间的区别至关重要。考虑一个从圆周 $\mathbb{S}^1$ 到平面 $\mathbb{R}^2$ 的映射 $f(\theta) = (\sin \theta, \sin 2\theta)$。这个[映射的微分](@entry_id:269524)处处非零，因此它是一个[浸入](@entry_id:161534)。然而，由于 $f(0) = f(\pi) = (0,0)$，该映射不是单射的，它的像（一个“8”字形曲线）在原点处自相交。因此，这个映射不是一个嵌入 [@problem_id:3064097]。相反，[嵌入子流形](@entry_id:273162)绝不会自相交。

#### 通过正则水平集定义

定义[子流形](@entry_id:159439)的第三种有效方法是将其描述为一个或多个光滑函数的公共[零点集](@entry_id:150020)，即一个**水平集 (level set)**。然而，并非任意函数的[水平集](@entry_id:751248)都是[光滑流形](@entry_id:160799)。关键在于**[正则值](@entry_id:161151) (regular value)** 的概念。

对于一个[光滑映射](@entry_id:203730) $F: \mathbb{R}^n \to \mathbb{R}^m$，一个点 $a \in \mathbb{R}^m$ 被称为 $F$ 的一个**[正则值](@entry_id:161151)**，当且仅当对于其原像 $F^{-1}(a)$ 中的每一个点 $p$，导数映射 $DF(p): \mathbb{R}^n \to \mathbb{R}^m$ 都是满射的。这意味着 $DF(p)$ 的秩等于陪域的维数 $m$ [@problem_id:3064044]。如果原像 $F^{-1}(a)$ 是[空集](@entry_id:261946)，那么 $a$ 自动被视为一个[正则值](@entry_id:161151)。

**[正则值定理](@entry_id:158611) (Regular Value Theorem)** 是微分几何中的一个基石，它指出：如果 $a$ 是 $F$ 的一个[正则值](@entry_id:161151)，那么原像 $M = F^{-1}(a)$（如果非空）是 $\mathbb{R}^n$ 的一个光滑[子流形](@entry_id:159439)，其维数为 $k = n-m$。[子流形](@entry_id:159439)的维数等于背景空间的维数减去[约束方程](@entry_id:138140)的个数。这个差值 $m = n-k$ 也被称为子流形 $M$ 在 $\mathbb{R}^n$ 中的**[余维数](@entry_id:273141) (codimension)** [@problem_id:3064060]。例如，[单位球](@entry_id:142558)面 $S^2 \subset \mathbb{R}^3$ 可以被描述为函数 $F(x,y,z) = x^2+y^2+z^2-1$ 的水平集 $F^{-1}(0)$。对于任何在球面上的点 $p=(x,y,z)$，导数 $DF(p) = \begin{pmatrix} 2x & 2y & 2z \end{pmatrix}$ 只要 $p \neq (0,0,0)$ 就是一个秩为 1 的满射。因此，$0$ 是一个[正则值](@entry_id:161151)，这保证了 $S^2$ 是一个 $3-1=2$ 维的光滑子流形。

### [切空间](@entry_id:199137)

在定义了子流形之后，我们自然会问：如何在每一点上最好地“线性化”或“近似”这个[流形](@entry_id:153038)？答案就是**切空间 (tangent space)**。

#### 几何定义：速度向量的空间

对于一个点 $p \in M \subset \mathbb{R}^n$，我们可以考虑所有穿过该点的光滑曲线 $\gamma: (-\varepsilon, \varepsilon) \to M$，其中 $\gamma(0) = p$。这些曲线在 $t=0$ 处的速度向量 $\gamma'(0)$ 都位于背景空间 $\mathbb{R}^n$ 中。所有这些可能的速度向量的集合构成了点 $p$ 处的[切空间](@entry_id:199137)，记作 $T_pM$。
$$
T_pM := \{ \gamma'(0) \in \mathbb{R}^n \mid \gamma: (-\varepsilon, \varepsilon) \to M \text{ 是光滑曲线且 } \gamma(0)=p \}
$$
可以证明，这个集合 $T_pM$ 并不是 $\mathbb{R}^n$ 中的一个杂乱无章的[子集](@entry_id:261956)，而是一个维度为 $k$ 的[线性子空间](@entry_id:151815) [@problem_id:3064103]。这为我们提供了一个非常具体和几何化的[切空间](@entry_id:199137)图像：它是 $\mathbb{R}^n$ 的一个 $k$ 维平面，在点 $p$ 处与[流形](@entry_id:153038) $M$ “相切”。

#### 切空间作为一阶近似

切空间的几何意义在于，由它构成的[仿射空间](@entry_id:152906) $p + T_pM$ 是[对流](@entry_id:141806)形 $M$ 在点 $p$ 附近的**[最佳线性近似](@entry_id:164642)**。我们可以用**小o表示法 (little-o notation)** 来精确地量化这一点。

假设我们有一个局部参数化 $\varphi: \mathbb{R}^k \to M$ 且 $\varphi(0) = p$。根据[微分](@entry_id:158718)的定义，我们有：
$$
\varphi(h) - p - D\varphi(0)h = o(|h|) \quad \text{当 } h \to 0 \text{ 时}
$$
这里，$D\varphi(0)h$ 是一个位于[切空间](@entry_id:199137) $T_pM$ 中的向量。这个公式表明，当 $h$ 很小时，[流形](@entry_id:153038)上的点 $\varphi(h)$ 与其在仿射[切空间](@entry_id:199137) $p+T_pM$ 中的线性近似点 $p + D\varphi(0)h$ 之间的差值，其模长比 $|h|$ 更快地趋于零。

一个更几何的表述是：从[流形](@entry_id:153038)上的一个点 $q$ 到仿射[切空间](@entry_id:199137) $p+T_pM$ 的最短欧氏距离是 $o(|q-p|)$。这意味着当一个点 $q$ 沿着[流形](@entry_id:153038)趋近于 $p$ 时，它到[切空间](@entry_id:199137)的距离比它到 $p$ 的距离小一个[数量级](@entry_id:264888) [@problem_id:3064082]。这个性质可以用多种方式证明，无论是通过局部图（将[流形](@entry_id:153038)表示为函数图像）还是通过隐函数（将[流形](@entry_id:153038)表示为[水平集](@entry_id:751248)） [@problem_id:3064082]。需要注意的是，切空间提供的是**一阶**近似。误差通常是 $|q-p|^2$ 的量级，而不是 $o(|q-p|^2)$。

#### 代数定义：切向量作为导子

虽然几何定义非常直观，但切向量还有一个更抽象但功能更强大的代数定义。一个[切向量](@entry_id:265494)可以被看作是一个作用在[流形上的光滑函数](@entry_id:267853)并返回一个实数的**导子 (derivation)**。

令 $C^\infty(M)$ 为 $M$ 上所有光滑实值函数的集合。在点 $p \in M$ 的一个**[切向量](@entry_id:265494)**是一个 $\mathbb{R}$-[线性映射](@entry_id:185132) $D: C^\infty(M) \to \mathbb{R}$，它满足**Leibniz 法则 (Leibniz rule)**：
$$
D(fg) = D(f) \cdot g(p) + f(p) \cdot D(g)
$$
对于所有 $f, g \in C^\infty(M)$ [@problem_id:3064102]。所有在点 $p$ 的这种导子的集合构成了[切空间](@entry_id:199137) $T_pM$。

这个定义与几何定义是等价的。任何一个由曲线 $\gamma$ 定义的速度向量 $v=\gamma'(0)$ 都可以通过方向导数定义一个导子 $D_v$：
$$
D_v(f) = \frac{d}{dt}\bigg|_{t=0} f(\gamma(t))
$$
反之，任何一个导子都可以被证明对应于某个速度向量。因此，我们可以将[切向量](@entry_id:265494)看作是[等价类](@entry_id:156032)，其中两条曲线 $\gamma_1$ 和 $\gamma_2$ 等价，如果它们在 $p$ 点对所有[光滑函数](@entry_id:267124)产生相同的[方向导数](@entry_id:189133)。这又等价于说它们在背景空间中的速度向量 $\gamma_1'(0)$ 和 $\gamma_2'(0)$ 相等 [@problem_id:3064040]。

#### [切空间](@entry_id:199137)的典范性

对于嵌入在 $\mathbb{R}^n$ 中的[子流形](@entry_id:159439) $M$，它有一个自然的**包含映射 (inclusion map)** $\iota: M \hookrightarrow \mathbb{R}^n$。这个[映射的微分](@entry_id:269524) $d\iota_p: T_pM \to T_p\mathbb{R}^n \cong \mathbb{R}^n$ 是一个[单射](@entry_id:183792)。它的像恰好就是我们之前定义的由速度向量构成的几何[切空间](@entry_id:199137)。

这个由 $d\iota_p$ 建立的从抽象[切空间](@entry_id:199137)（无论是定义为导子还是曲线的等价类）到 $\mathbb{R}^n$ 中一个具体 $k$ 维[线性子空间](@entry_id:151815)的同构是**典范的 (canonical)**。这意味着它不依赖于任何任意的选择，如图卡或参数化。它仅仅依赖于 $M$ 是 $\mathbb{R}^n$ 的一个[子集](@entry_id:261956)这一事实 [@problem_id:3064103]。

这种典范的认同也与其他描述方式兼容。例如，如果 $M$ 由正则水平集 $F^{-1}(a)$ 给出，那么在点 $p \in M$ 的[切空间](@entry_id:199137) $T_pM$ 恰好是导数映射 $DF(p)$ 的核空间：
$$
T_pM = \ker(DF(p))
$$
这是一个 $k=n-m$ 维的[线性子空间](@entry_id:151815)，再次提供了一个不依赖于图卡选择的具体描述 [@problem_id:3064044] [@problem_id:3064103]。此外，这种几何结构与背景空间的操作具有良好的相容性。例如，如果 $A$ 是 $\mathbb{R}^n$ 的一个线性[等距变换](@entry_id:150881)（如旋转或反射），它会将子流形 $M$ 变换为 $AM$，同时也会将 $M$ 在点 $p$ 的[切空间](@entry_id:199137) $T_pM$ 相应地变换为 $AM$ 在点 $Ap$ 的[切空间](@entry_id:199137) $T_{Ap}(AM)$ [@problem_id:3064103]。

### [流形间的映射](@entry_id:158221)与[微分](@entry_id:158718)

一旦我们理解了[流形](@entry_id:153038)和它们的[切空间](@entry_id:199137)，下一步就是研究它们之间的[光滑映射](@entry_id:203730)。一个[光滑映射](@entry_id:203730) $f: M \to N$ 在每一点 $p \in M$ 都会诱导一个其切空间之间的[线性映射](@entry_id:185132)，称为**[微分](@entry_id:158718) (differential)** 或**[前推](@entry_id:158718) (pushforward)**，记作 $df_p: T_pM \to T_{f(p)}N$。

这个[微分](@entry_id:158718)的定义可以通过曲线非常直观地给出。给定一个[切向量](@entry_id:265494) $v \in T_pM$，我们可以找到一条代表它的曲线 $\gamma: (-\varepsilon, \varepsilon) \to M$，使得 $\gamma(0)=p$ 且 $\gamma'(0)=v$。然后，我们可以将映射 $f$ 应用于整条曲线，得到一条在 $N$ 中的新曲线 $f \circ \gamma$。这条新曲线在 $t=0$ 时通过点 $f(p)$。它在 $t=0$ 处的速度向量就是 $v$ 在 $f$ 作用下的像：
$$
df_p(v) = \frac{d}{dt}\bigg|_{t=0} (f \circ \gamma)(t)
$$
可以证明，这个定义不依赖于代表 $v$ 的具体曲线 $\gamma$ 的选择，并且 $df_p$ 是一个线性映射 [@problem_id:3064069]。[微分](@entry_id:158718) $df_p$ 捕捉了映射 $f$ 在点 $p$ 附近对[无穷小位移](@entry_id:202209)的[线性响应](@entry_id:146180)。

### [切丛](@entry_id:161294)

到目前为止，我们只考虑了在单个点上的[切空间](@entry_id:199137)。然而，将所有点上的所有[切空间](@entry_id:199137)集合在一起，可以形成一个更大的几何对象，称为**[切丛](@entry_id:161294) (tangent bundle)**。

[流形](@entry_id:153038) $M$ 的[切丛](@entry_id:161294) $TM$ 定义为所有切空间的无交并集：
$$
TM = \bigsqcup_{p \in M} T_pM
$$
一个切丛中的元素是一个偶对 $(p, v)$，其中 $p \in M$ 是基点，$v \in T_pM$ 是该点的一个切向量。存在一个自然的**[投影映射](@entry_id:153398) (projection map)** $\pi: TM \to M$，它将一个[切向量](@entry_id:265494)映射回其基点，即 $\pi(p,v) = p$。

更重要的是，$TM$ 本身不仅仅是一个集合，它具有一个典范的[光滑流形](@entry_id:160799)结构。如果 $M$ 是一个 $k$ 维[流形](@entry_id:153038)，那么 $TM$ 是一个 $2k$ 维[流形](@entry_id:153038)。这个结构是通过 $M$ 上的图卡来构建的。对于 $M$ 上的任意一个图卡 $\varphi: U \to \mathbb{R}^k$，我们可以构建一个 $TM$ 上的图卡 $\Psi: \pi^{-1}(U) \to \mathbb{R}^k \times \mathbb{R}^k$，定义为：
$$
\Psi(p, v) = (\varphi(p), d\varphi_p(v))
$$
这里，$\varphi(p)$ 是点 $p$ 在图卡中的坐标，而 $d\varphi_p(v)$ 是向量 $v$ 在由该图卡诱导的 $T_pM$ 基底下的坐标。可以证明，由这种方式构建的所有图卡构成了 $TM$ 的一个[光滑图册](@entry_id:264754)，其转移映射是光滑的。这些转移映射在纤维坐标上是线性的，这使得 $TM$ 成为了一个**向量丛 (vector bundle)** [@problem_id:3064068]。[切丛](@entry_id:161294)是[微分几何](@entry_id:145818)中一个极其重要的概念，是研究向量场、[微分形式](@entry_id:146747)和[流形](@entry_id:153038)上其他张量结构的基础。