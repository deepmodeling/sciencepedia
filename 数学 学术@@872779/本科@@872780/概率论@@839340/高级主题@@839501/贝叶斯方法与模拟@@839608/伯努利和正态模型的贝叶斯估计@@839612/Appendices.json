{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于根据新证据更新我们对未知参数的信念。这个练习将带你体验一个最基本也最常见的场景：估计一个未知的成功概率。通过一个生产半导体芯片的假设性例子 [@problem_id:1345485]，我们将从一个代表初始不确定性的均匀先验分布开始，并利用观测到的数据来更新我们对芯片合格率的估计。这个过程展示了共轭先验（特别是Beta-二项分布模型）在简化计算中的强大作用。", "problem": "一位质量控制工程师正在评估一种用于生产半导体芯片的新制造工艺。一个新制造的芯片功能正常的真实但未知的概率用 $p$ 表示。根据初始的理论模型，该工程师假设 $p$ 在区间 $[0, 1]$ 内的任何值都是等可能的。这种先验信念被正式地描述为一个参数为 $\\alpha=1$ 和 $\\beta=1$ 的贝塔分布，即 $p \\sim \\text{Beta}(1, 1)$。\n\n接着，该工程师测试了由这个新工艺生产的一小批5个芯片，并发现其中4个是功能正常的。\n\n使用这个新数据，计算概率 $p$ 的更新后的贝叶斯估计。具体来说，求 $p$ 的后验均值。请将您的答案表示为最简分数形式。", "solution": "设功能正常的芯片的概率为 $p$。先验分布为 $p \\sim \\text{Beta}(\\alpha, \\beta)$，其中 $\\alpha=1$ 且 $\\beta=1$。一个 Beta$(\\alpha,\\beta)$ 先验分布的密度在 $[0,1]$ 上正比于 $p^{\\alpha-1}(1-p)^{\\beta-1}$。\n\n从测试 $n=5$ 个芯片发现 $x=4$ 个功能正常，二项似然函数为\n$$\nL(p \\mid x) = \\binom{n}{x} p^{x} (1-p)^{n-x},\n$$\n作为 $p$ 的函数，它正比于 $p^{x}(1-p)^{n-x}$。\n\n根据贝叶斯法则和贝塔-二项共轭性，\n$$\nf(p \\mid x) \\propto L(p \\mid x)\\, f(p) \\propto p^{x+\\alpha-1}(1-p)^{n-x+\\beta-1},\n$$\n所以后验分布为\n$$\np \\mid x \\sim \\text{Beta}(\\alpha+x,\\ \\beta+n-x).\n$$\n代入 $\\alpha=1$, $\\beta=1$, $x=4$ 和 $n=5$ 得\n$$\np \\mid x \\sim \\text{Beta}(1+4,\\ 1+5-4) = \\text{Beta}(5, 2).\n$$\n一个 $\\text{Beta}(a,b)$ 分布的均值是 $\\frac{a}{a+b}$，因此\n$$\n\\mathbb{E}[p \\mid x] = \\frac{5}{5+2} = \\frac{5}{7}.\n$$\n因此，更新后的贝叶斯估计（后验均值）是 $\\frac{5}{7}$。", "answer": "$$\\boxed{\\frac{5}{7}}$$", "id": "1345485"}, {"introduction": "在科学和金融领域，我们常常需要估计一个连续的量，例如平均温度、资产回报率或测量值。这个问题 [@problem_id:1345529] 将我们的注意力从离散概率转移到正态分布数据的均值估计上。你将推导后验均值的通用表达式，这个过程会清晰地揭示后验均值是如何成为先验均值和数据均值的“精度加权平均”的，这是理解贝叶斯学习过程如何权衡先验知识和新证据的关键。", "problem": "一家金融科技公司的数据科学家正在评估一种新的自动化高频交易（HFT）算法。该算法的周回报率（以百分比表示）被建模为一个随机变量，该变量服从一个具有未知真实均值 $\\mu$ 和已知方差 $\\sigma^2$ 的正态分布。\n\n基于对类似策略的模拟和分析，该科学家关于平均回报率 $\\mu$ 的先验信念被量化为一个均值为 $\\mu_0$、方差为 $\\sigma_0^2$ 的正态分布。\n\n为了在真实市场中测试该算法，它被运行了 $n$ 周。在此测试期间观察到的平均周回报率为 $\\bar{x}$。你的任务是根据这些新数据，更新该科学家关于平均回报率 $\\mu$ 的信念。\n\n确定平均周回报率 $\\mu$ 的更新后期望值。将你的答案表示为一个符号表达式，用先验均值 $\\mu_0$、先验方差 $\\sigma_0^2$、周数 $n$、周回报率的已知方差 $\\sigma^2$ 以及观察到的平均周回报率 $\\bar{x}$ 来表示。", "solution": "我们将周回报率建模为独立观测值 $x_{1},\\dots,x_{n}$，其中 $x_{i}\\,|\\,\\mu \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。均值的先验分布为 $\\mu \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$。根据贝叶斯定理以及正态似然与正态先验的共轭性，$\\mu$ 的后验分布是正态分布。为了推导其均值，用充分统计量 $\\bar{x}$ 来表示似然函数：\n$$\np(x_{1:n}\\,|\\,\\mu)\\propto \\exp\\!\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}\\right)\n= \\exp\\!\\left(-\\frac{n}{2\\sigma^{2}}(\\bar{x}-\\mu)^{2}\\right)\\times C,\n$$\n其中 $C$ 不依赖于 $\\mu$。先验密度为\n$$\np(\\mu)\\propto \\exp\\!\\left(-\\frac{1}{2\\sigma_{0}^{2}}(\\mu-\\mu_{0})^{2}\\right).\n$$\n因此，关于 $\\mu$ 的未归一化后验核是\n$$\np(\\mu\\,|\\,x_{1:n}) \\propto \\exp\\!\\left[-\\frac{1}{2}\\left(\\frac{n}{\\sigma^{2}}(\\mu-\\bar{x})^{2}+\\frac{1}{\\sigma_{0}^{2}}(\\mu-\\mu_{0})^{2}\\right)\\right].\n$$\n展开并合并关于 $\\mu$ 的项，得到\n$$\n-\\frac{1}{2}\\left[\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\sigma_{0}^{2}}\\right)\\mu^{2}\n-2\\left(\\frac{n\\bar{x}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\sigma_{0}^{2}}\\right)\\mu + \\text{const}\\right].\n$$\n配方后，上式等于\n$$\n-\\frac{1}{2}\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\sigma_{0}^{2}}\\right)\\left(\\mu-\\frac{\\frac{n\\bar{x}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\sigma_{0}^{2}}}{\\frac{n}{\\sigma^{2}}+\\frac{1}{\\sigma_{0}^{2}}}\\right)^{2}+\\text{const},\n$$\n所以后验分布是正态分布，其均值为\n$$\n\\mathbb{E}[\\mu\\,|\\,x_{1:n}] \\;=\\; \\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\bar{x}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}}.\n$$\n这就是平均周回报率的更新后期望值。", "answer": "$$\\boxed{\\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\bar{x}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}}}$$", "id": "1345529"}, {"introduction": "贝叶斯方法不仅能帮助我们分析已有数据，还能指导我们如何规划未来的实验。在收集数据之前，我们如何确定需要多少样本才能达到理想的精度呢？这个问题 [@problem_id:1345481] 正是要解决这样一个实验设计问题。利用正态-正态模型，你将计算为了将我们对未知均值的不确定性（即后验方差）降低到特定水平所需的最少测量次数。", "problem": "一位材料科学家正在研究一种新开发合金的弹性。基于理论模型和以往对类似材料的经验，该科学家对平均杨氏模量 $\\mu$ 的先验信念被建模为一个正态分布，其均值为 $\\mu_0 = 150 \\text{ GPa}$，方差为 $\\sigma_0^2 = 0.8 \\text{ GPa}^2$。\n\n为改进此估计，该科学家进行了一系列拉伸试验。每次测量值 $X_i$ 均被假定服从一个正态分布，其均值为 $\\mu$，测量方差已知为 $\\sigma^2 = 12.0 \\text{ GPa}^2$，该方差考虑了仪器的精度和微小的环境波动。这些测量值是独立同分布的。\n\n该科学家旨在减小关于 $\\mu$ 的不确定性。为确保 $\\mu$ 的后验方差小于先验方差的四分之一，必须收集的最小整数测量次数 $n$ 是多少？", "solution": "设先验分布为 $\\mu \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$，数据模型为 $X_{i} \\mid \\mu \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，对于 $i=1,\\dots,n$ 独立同分布，且 $\\sigma^{2}$ 已知。在方差已知的正态-正态共轭模型中，经过 $n$ 次观测后 $\\mu$ 的后验方差为\n$$\n\\sigma_{n}^{2}=\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}.\n$$\n我们需要后验方差小于先验方差的四分之一：\n$$\n\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}  \\frac{1}{4}\\sigma_{0}^{2}.\n$$\n由于所有量均为正数，将两边取倒数可得\n$$\n\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\frac{4}{\\sigma_{0}^{2}}.\n$$\n整理以分离出 $n$：\n$$\n\\frac{n}{\\sigma^{2}}\\frac{4}{\\sigma_{0}^{2}}-\\frac{1}{\\sigma_{0}^{2}}=\\frac{3}{\\sigma_{0}^{2}}\n\\quad\\Longrightarrow\\quad\nn\\frac{3\\sigma^{2}}{\\sigma_{0}^{2}}.\n$$\n代入给定的方差 $\\sigma^{2}=12.0$ 和 $\\sigma_{0}^{2}=0.8$：\n$$\nn\\frac{3\\times 12.0}{0.8}=\\frac{36.0}{0.8}=45.\n$$\n因为不等式是严格的，满足该不等式的最小整数 $n$ 是 $46$。", "answer": "$$\\boxed{46}$$", "id": "1345481"}]}