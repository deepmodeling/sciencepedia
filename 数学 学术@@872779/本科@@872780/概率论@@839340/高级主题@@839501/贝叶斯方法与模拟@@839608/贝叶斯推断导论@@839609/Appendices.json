{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于利用新證據更新我们已有的信念。第一个练习将带领我们解决一个典型问题：如何评估一个未知比例或成功率。我们将以一位篮球运动员的罚球命中率为例 [@problem_id:1923983]。这个练习将演示如何将代表我们先验知识的Beta分布与新观察到的数据（具体来说，是负二项分布描述的实验结果）相结合。通过这个过程，我们将得出一个更新后的期望成功率，这是理解共轭先验如何简化贝叶斯计算的绝佳起点。", "problem": "一位体育分析师正在评估一名篮球运动员的罚球命中能力。分析师将该运动员每次投篮的内在成功概率（记为 $p$）建模为一个随机变量。分析师对 $p$ 的初始信念由一个参数为 $\\alpha_0 = 4$ 和 $\\beta_0 = 2$ 的贝塔分布表示。\n\n然后，分析师在一次训练中观察该运动员。运动员被要求持续投篮，直到成功命中 $r=5$ 次罚球为止。分析师记录下，该运动员为了完成这5次成功命中，总共投了 $n=8$ 次。\n\n根据这个新的实验数据，分析师更新了他们关于 $p$ 的模型。更新后的 $p$ 模型也将是一个贝塔分布。根据这个更新后的模型，计算 $p$ 的期望值。将你的答案表示为保留三位有效数字的小数。", "solution": "我们使用贝塔分布作为参数 $p$ 的先验分布，即 $p \\sim \\text{Beta}(\\alpha_0, \\beta_0)$，其中先验参数为 $\\alpha_0 = 4$ 和 $\\beta_0 = 2$。\n\n实验数据来自一个负二项分布过程：观察到 $r=5$ 次成功命中总共花费了 $n=8$ 次投篮。这意味着在实验中，有 $k=5$ 次成功和 $n-k = 8-5=3$ 次失败。\n\n二项分布的似然函数与 $p^k(1-p)^{n-k}$ 成正比。对于我们的数据，似然函数与 $p^5(1-p)^3$ 成正比。\n\n由于贝塔分布是二项似然的共轭先验，后验分布也将是一个贝塔分布，记为 $\\text{Beta}(\\alpha_n, \\beta_n)$。其参数更新规则如下：\n$$ \\alpha_n = \\alpha_0 + k = 4 + 5 = 9 $$\n$$ \\beta_n = \\beta_0 + (n-k) = 2 + 3 = 5 $$\n因此，后验分布为 $p | \\text{data} \\sim \\text{Beta}(9, 5)$。\n\n一个服从 $\\text{Beta}(\\alpha, \\beta)$ 分布的随机变量的期望值为 $\\frac{\\alpha}{\\alpha+\\beta}$。因此，$p$ 的后验期望值为：\n$$ E[p | \\text{data}] = \\frac{\\alpha_n}{\\alpha_n + \\beta_n} = \\frac{9}{9+5} = \\frac{9}{14} $$\n将该分式转换为小数，我们得到：\n$$ E[p | \\text{data}] \\approx 0.642857... $$\n四舍五入到三位有效数字，结果为 0.643。", "answer": "$$\\boxed{0.643}$$", "id": "1923983"}, {"introduction": "在很多现实情况中，我们可能没有任何关于未知参数的初始偏好。在这种情况下，我们可以使用“无信息先验”来表达这种不确定性。这个练习 [@problem_id:1923968] 探讨了一个引人入胜且极为实际的场景：当一项新的外科手术在多次试验中从未成功时，我们能对它的成功率做出什么样的推斷？我们将从一个均匀先验（即认为所有成功率的可能性都相等）开始，并在观察到零次成功后，计算后验分布的中位数。这不仅展示了如何处理极端数据，还介绍了后验中位数作为一种稳健的点估计方法。", "problem": "一种针对先前被认为无法治疗的病症的新型高风险外科手术正在研发中。该手术的真实成功概率（记为 $p$）是未知的。在进行任何临床试验之前，医学研究人员对这个概率没有任何先验偏见，因此认为区间 $[0, 1]$ 中 $p$ 的每一个可能值都是等可能的。\n\n然后，该手术在 $n$ 位不同的患者身上进行了尝试。在这 $n$ 次独立的试验中，每一次手术都未能取得成功的结果。\n\n基于这 $n$ 次试验中零次成功的观测数据，形成了关于成功概率 $p$ 的一个更新的信念。一位医学统计学家决定通过计算一个中心值 $p_{med}$ 来总结这个更新的信念。该值的定义是：在给定观测数据的情况下，真实成功率 $p$ 小于或等于 $p_{med}$ 的概率与 $p$ 大于 $p_{med}$ 的概率相等。\n\n请找出 $p_{med}$ 关于 $n$ 的闭式解析表达式。", "solution": "设 $p$ 表示成功概率。先验信念是在 $[0,1]$ 上的均匀分布，即 $\\operatorname{Beta}(1,1)$ 先验，其密度函数为 $\\pi(p)=1$，$p\\in[0,1]$。\n\n我们观测到 $n$ 次独立的伯努利试验，其中成功次数 $k=0$。似然函数为\n$$\nL(p\\mid \\text{data}) \\propto p^{k}(1-p)^{n-k}=(1-p)^{n}.\n$$\n根据贝叶斯定理，后验分布与先验分布乘以似然函数成正比：\n$$\n\\pi(p\\mid \\text{data}) \\propto \\pi(p)L(p\\mid \\text{data}) \\propto (1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n这是一个 $\\operatorname{Beta}(1,n+1)$ 分布。显式地进行归一化，\n$$\n\\int_{0}^{1} (1-p)^{n}\\,dp=\\frac{1}{n+1},\n$$\n因此后验密度函数为\n$$\nf(p\\mid \\text{data})=(n+1)(1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n后验累积分布函数为\n$$\nF(p)=\\int_{0}^{p} (n+1)(1-t)^{n}\\,dt.\n$$\n通过换元 $u=1-t$，$du=-dt$ 来计算该积分：\n$$\nF(p)=(n+1)\\int_{0}^{p} (1-t)^{n}\\,dt=(n+1)\\int_{1-p}^{1} u^{n}\\,du\n= (n+1)\\left[\\frac{u^{n+1}}{n+1}\\right]_{1-p}^{1}\n=1-(1-p)^{n+1}.\n$$\n后验中位数 $p_{med}$ 满足 $F(p_{med})=\\frac{1}{2}$，因此\n$$\n1-(1-p_{med})^{n+1}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n(1-p_{med})^{n+1}=\\frac{1}{2}.\n$$\n两边取 $(n+1)$ 次方根，得到\n$$\n1-p_{med}=2^{-\\frac{1}{n+1}},\n$$\n所以\n$$\np_{med}=1-2^{-\\frac{1}{n+1}}.\n$$\n该表达式对所有 $n\\geq 0$ 都有效，特别是对于问题背景中的 $n\\geq 1$。", "answer": "$$\\boxed{1-2^{-\\frac{1}{n+1}}}$$", "id": "1923968"}, {"introduction": "贝叶斯方法的应用远不止于估计成功概率。它同样是量化连续参数（如测量误差或物理常数）不确定性的强大工具。最后一个练习 [@problem_id:1924015] 将我们的视角从离散事件转移到连续测量上，具体来说是估计陀螺仪的随机漂移误差。本题将指导你为正态分布数据的方差选择一个合适的先验分布（逆伽马分布），并计算其后验分布。最终目标是构建一个95%的“可信区间”，这是贝叶斯统计中用以表达参数不确定性的标准方法，与传统统计学中的置信区间有着概念上的根本区别。", "problem": "一种新型微机电系统（MEMS）陀螺仪正在进行测试，用于卫星姿态控制。该陀螺仪的随机漂移误差被建模为一个正态分布的随机变量，其均值恰好为零，因为任何系统性偏差都已在校准过程中被移除。该误差的方差（记为 $\\sigma^2$）是未知的。\n\n基于传感器噪声源的物理原理，一位领域专家建议，对于方差 $\\sigma^2$ 的一个合理的先验信念可以用逆伽马分布来描述，其形状参数 $\\alpha_0 = 3$，尺度参数 $\\beta_0 = 0.02$。逆伽马分布 $\\text{Inv-Gamma}(\\alpha, \\beta)$ 的概率密度函数（PDF）为 $f(x | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{-\\alpha-1} \\exp(-\\frac{\\beta}{x})$，其中 $x > 0$。\n\n在测试过程中，记录了以下五个独立的漂移误差测量值（单位：度/小时）：\n$x_1 = -0.25$，$x_2 = 0.15$，$x_3 = 0.30$，$x_4 = -0.10$，$x_5 = 0.05$。\n\n你的任务是确定漂移误差标准差 $\\sigma$ 的一个95%等尾可信区间。\n\n为了计算，你可能需要卡方（$\\chi^2$）分布的以下分位数。对于一个自由度为11的 $\\chi^2$ 分布，其0.025分位数约为3.816，0.975分位数约为21.920。\n\n计算 $\\sigma$ 的可信区间的下界和上界。将你的两个界限的最终答案四舍五入到三位有效数字，并以度/小时为单位表示。", "solution": "设 $x_{1},\\dots,x_{n}$ 独立同分布于 $x_{i}\\mid\\sigma^{2}\\sim\\mathcal{N}(0,\\sigma^{2})$，先验为 $\\sigma^{2}\\sim\\text{Inv-Gamma}(\\alpha_{0},\\beta_{0})$，其密度函数为 $f(x\\mid\\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x^{-\\alpha-1}\\exp\\!\\left(-\\frac{\\beta}{x}\\right)$，其中 $x>0$。共轭性意味着后验分布为\n$$\n\\sigma^{2}\\mid x_{1:n}\\sim\\text{Inv-Gamma}\\!\\left(\\alpha_{n},\\beta_{n}\\right),\n$$\n其中\n$$\n\\alpha_{n}=\\alpha_{0}+\\frac{n}{2},\\qquad \\beta_{n}=\\beta_{0}+\\frac{1}{2}\\sum_{i=1}^{n}x_{i}^{2}.\n$$\n使用 $n=5$，$\\alpha_{0}=3$，$\\beta_{0}=0.02$ 以及数据 $x_{1}=-0.25$，$x_{2}=0.15$，$x_{3}=0.30$，$x_{4}=-0.10$，$x_{5}=0.05$，计算\n$$\n\\sum_{i=1}^{5}x_{i}^{2}=(-0.25)^{2}+(0.15)^{2}+(0.30)^{2}+(-0.10)^{2}+(0.05)^{2}=0.1875,\n$$\n因此\n$$\n\\alpha_{n}=3+\\frac{5}{2}=\\frac{11}{2},\\qquad \\beta_{n}=0.02+\\frac{1}{2}\\cdot 0.1875=0.11375.\n$$\n如果 $\\sigma^{2}\\sim\\text{Inv-Gamma}(\\alpha,\\beta)$，那么变换\n$$\nU=\\frac{2\\beta}{\\sigma^{2}}\n$$\n服从 $\\chi^{2}_{2\\alpha}$ 分布。因此，对于后验分布，\n$$\n\\frac{2\\beta_{n}}{\\sigma^{2}}\\sim\\chi^{2}_{2\\alpha_{n}}=\\chi^{2}_{11}.\n$$\n设 $q_{p}$ 表示 $\\chi^{2}_{11}$ 的 $p$-分位数。$\\sigma^{2}$ 的一个等尾95%可信区间可以通过反转尾部得到：\n$$\n\\left[\\frac{2\\beta_{n}}{q_{0.975}},\\,\\frac{2\\beta_{n}}{q_{0.025}}\\right].\n$$\n使用 $q_{0.025}\\approx 3.816$ 和 $q_{0.975}\\approx 21.920$ 以及 $2\\beta_{n}=0.2275$ 可得\n$$\n\\sigma^{2}\\text{ 的下界}=\\frac{0.2275}{21.920}\\approx 0.01037865,\\qquad\n\\sigma^{2}\\text{ 的上界}=\\frac{0.2275}{3.816}\\approx 0.05961740.\n$$\n由于 $\\sigma=\\sqrt{\\sigma^{2}}$ 是一个单调变换，$\\sigma$ 的等尾可信区间是上述界限的平方根：\n$$\n\\sigma\\text{ 的下界}=\\sqrt{0.01037865}\\approx 0.1019,\\qquad\n\\sigma\\text{ 的上界}=\\sqrt{0.05961740}\\approx 0.2442.\n$$\n将两者都四舍五入到三位有效数字，得到 $0.102$ 和 $0.244$，单位为度/小时。", "answer": "$$\\boxed{\\begin{pmatrix}0.102 & 0.244\\end{pmatrix}}$$", "id": "1924015"}]}