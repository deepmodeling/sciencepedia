{"hands_on_practices": [{"introduction": "掌握了N步转移矩阵的理论后，让我们从一个基础练习开始。这个练习将帮助我们理解计算短期未来状态概率的核心思想。要计算一个系统在两步之后从状态 $i$ 转移到状态 $j$ 的概率，我们需要考虑所有可能的第一步中间状态，并将所有对应路径的概率相加。通过这个图书馆书籍状态的例子[@problem_id:1377143]，我们将亲手实践这一基本原理。", "problem": "一所大学图书馆中某本特定书籍的状态可以建模为一个离散时间随机过程。这本书的状态在每天结束时被观察。这本书的可能状态有：“在架上”（S）、“已借出”（C）或“归架中”（R）。\n\n这些状态之间的转移遵循一组固定的概率：\n- 如果一本书在某一天处于“在架上”状态，那么它在第二天变为“已借出”状态的概率为 0.15。否则，它将保持“在架上”状态。\n- 如果一本书处于“已借出”状态，那么它在第二天被归还并进入“归架中”状态的概率为 0.25。否则，它将保持“已借出”状态。\n- 如果一本书处于“归架中”状态，那么它在第二天被放回“在架上”的概率为 0.90。否则，它将保持“归架中”状态。\n\n假设一本书不能在一天之内从“在架上”变为“归架中”，从“已借出”变为“在架上”，或从“归架中”变为“已借出”。\n\n假设某本特定的书目前处于“在架上”状态。那么，这本书在两天后恰好再次处于“在架上”状态的概率是多少？请将你的答案表示为保留三位有效数字的小数。", "solution": "设状态为 $S$（在架上）、$C$（已借出）和 $R$（归架中）。行/列顺序为 $(S,C,R)$ 的一步转移矩阵 $P$ 为\n$$\nP=\\begin{pmatrix}\n0.85 & 0.15 & 0 \\\\\n0 & 0.75 & 0.25 \\\\\n0.90 & 0 & 0.10\n\\end{pmatrix}.\n$$\n从状态 $S$ 开始的书，在两天后恰好处于状态 $S$ 的概率是两步转移概率 $(P^{2})_{SS}$，由下式给出\n$$\n(P^{2})_{SS}=\\sum_{x\\in\\{S,C,R\\}} P_{Sx}P_{xS}\n= P_{SS}P_{SS}+P_{SC}P_{CS}+P_{SR}P_{RS}.\n$$\n根据转移结构，我们有 $P_{SS}=0.85$，$P_{SC}=0.15$，$P_{CS}=0$，$P_{SR}=0$ 以及 $P_{RS}=0.90$。因此，\n$$\n(P^{2})_{SS}=0.85^{2}+0.15\\cdot 0+0\\cdot 0.90=0.7225.\n$$\n保留三位有效数字，得到 $0.723$。", "answer": "$$\\boxed{0.723}$$", "id": "1377143"}, {"introduction": "虽然逐一计算路径对于两步或三步的转移是可行的，但当步数 $n$ 增大时，这种方法会变得非常繁琐。下一个练习将向我们展示一种更强大、更高效的计算整个 $N$ 步转移矩阵 $P^n$ 的方法：矩阵对角化。这个方法巧妙地将概率论问题与线性代数的工具结合起来，是解决马尔可夫链长期行为的关键技术[@problem_id:1377157]。", "problem": "一个通勤者每天上班的交通方式选择是在开车（状态1）和乘坐火车（状态2）之间。任何一天的选择都受到前一天选择的影响。决定这个每日选择的概率如下：\n\n*   如果通勤者在第 $k$ 天开车，那么他们在第 $k+1$ 天也开车的概率是 $0.7$。\n*   如果通勤者在第 $k$ 天乘坐火车，那么他们在第 $k+1$ 天开车的概率是 $0.2$。\n\n假设在任何一天 $k$，通勤者必须开车或乘坐火车，并且这两个选项是互斥的。转移概率对所有天都保持不变。\n\n确定5步转移概率矩阵 $P^{(5)}$，其中矩阵的元素 $(i, j)$ 表示在某一天使用交通方式 $i$ 的通勤者将在五天后使用交通方式 $j$ 的概率。将你的最终答案表示为一个 $2 \\times 2$ 矩阵，并将每个元素四舍五入到四位有效数字。", "solution": "设状态1为“开车”，状态2为“乘坐火车”。我们已知在一天内从一个状态转移到另一个状态的概率。我们可以用这些概率来构建一步转移概率矩阵 $P$。该矩阵的元素 $P_{ij}$ 是在一天内从状态 $i$ 转移到状态 $j$ 的概率。\n\n根据问题描述：\n在第 $k$ 天开车的情况下，第 $k+1$ 天也开车的概率是 $P_{11} = 0.7$。\n由于只有两个状态，在第 $k$ 天开车的情况下，第 $k+1$ 天乘坐火车的概率必须是 $P_{12} = 1 - P_{11} = 1 - 0.7 = 0.3$。\n\n在第 $k$ 天乘坐火车的情况下，第 $k+1$ 天开车的概率是 $P_{21} = 0.2$。\n类似地，在第 $k$ 天乘坐火车的情况下，第 $k+1$ 天再次乘坐火车的概率是 $P_{22} = 1 - P_{21} = 1 - 0.2 = 0.8$。\n\n因此，一步转移矩阵 $P$ 是：\n$$\nP = \\begin{pmatrix} 0.7 & 0.3 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\n5步转移概率矩阵 $P^{(5)}$ 由一步转移矩阵的五次方给出，即 $P^{(5)} = P^5$。为了高效地计算这个矩阵，我们对矩阵 $P$ 进行对角化。矩阵 $P$ 的对角化由 $P = VDV^{-1}$ 给出，其中 $D$ 是特征值构成的对角矩阵， $V$ 是其列为相应特征向量的矩阵。\n\n首先，我们通过求解特征方程 $\\det(P - \\lambda I) = 0$ 来找到 $P$ 的特征值 ($\\lambda$)：\n$$\n\\det\\begin{pmatrix} 0.7-\\lambda & 0.3 \\\\ 0.2 & 0.8-\\lambda \\end{pmatrix} = (0.7-\\lambda)(0.8-\\lambda) - (0.3)(0.2) = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.56 - 0.06 = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.5 = 0\n$$\n这个二次方程可以因式分解为 $(\\lambda - 1)(\\lambda - 0.5) = 0$。\n特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = 0.5$。\n\n接下来，我们找到相应的特征向量。\n对于 $\\lambda_1 = 1$，我们求解 $(P - I)v_1 = 0$：\n$$\n\\begin{pmatrix} 0.7-1 & 0.3 \\\\ 0.2 & 0.8-1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} -0.3 & 0.3 \\\\ 0.2 & -0.2 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到方程 $-0.3x + 0.3y = 0$，简化为 $x=y$。一个简单的特征向量选择是 $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = 0.5$，我们求解 $(P - 0.5I)v_2 = 0$：\n$$\n\\begin{pmatrix} 0.7-0.5 & 0.3 \\\\ 0.2 & 0.8-0.5 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0.2 & 0.3 \\\\ 0.2 & 0.3 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到方程 $0.2x + 0.3y = 0$，简化为 $2x = -3y$。一个简单的特征向量选择是 $v_2 = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix}$。\n\n现在我们构建矩阵 $V$, $D$, 和 $V^{-1}$：\n$$\nV = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.5 \\end{pmatrix}\n$$\n$V$ 的逆矩阵是：\n$$\nV^{-1} = \\frac{1}{(1)(-2) - (3)(1)} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\frac{1}{-5} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2/5 & 3/5 \\\\ 1/5 & -1/5 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\n现在我们可以使用公式 $P^5 = VD^5V^{-1}$ 来计算 $P^5$。\n首先，我们求 $D^5$：\n$$\nD^5 = \\begin{pmatrix} 1^5 & 0 \\\\ 0 & (0.5)^5 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix}\n$$\n现在，我们执行矩阵乘法 $P^5 = V D^5 V^{-1}$：\n$$\nP^5 = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\n首先，计算 $V D^5$ 的乘积：\n$$\nV D^5 = \\begin{pmatrix} 1 \\cdot 1 & 3 \\cdot 0.03125 \\\\ 1 \\cdot 1 & -2 \\cdot 0.03125 \\end{pmatrix} = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix}\n$$\n然后，将结果乘以 $V^{-1}$：\n$$\nP^5 = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\n现在我们计算最终矩阵的元素：\n$$\nP^{(5)}_{11} = (1)(0.4) + (0.09375)(0.2) = 0.4 + 0.01875 = 0.41875\n$$\n$$\nP^{(5)}_{12} = (1)(0.6) + (0.09375)(-0.2) = 0.6 - 0.01875 = 0.58125\n$$\n$$\nP^{(5)}_{21} = (1)(0.4) + (-0.0625)(0.2) = 0.4 - 0.0125 = 0.3875\n$$\n$$\nP^{(5)}_{22} = (1)(0.6) + (-0.0625)(-0.2) = 0.6 + 0.0125 = 0.6125\n$$\n所以，5步转移矩阵是：\n$$\nP^{(5)} = \\begin{pmatrix} 0.41875 & 0.58125 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$\n最后，我们将每个元素四舍五入到四位有效数字：\n$P^{(5)}_{11} = 0.41875 \\approx 0.4188$\n$P^{(5)}_{12} = 0.58125 \\approx 0.5813$\n$P^{(5)}_{21} = 0.3875$ (已经是四位有效数字)\n$P^{(5)}_{22} = 0.6125$ (已经是四位有效数字)\n\n最终的矩阵是：\n$$\nP^{(5)} \\approx \\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}}\n$$", "id": "1377157"}, {"introduction": "除了预测系统在 $n$ 步后的状态分布，我们常常也关心事件发生的具体路径和时间，例如一个过程在何时首次到达某个特定状态。这个问题引入了“吸收状态”的概念——一旦进入就无法离开的状态。通过分析一个网络爬虫的模型[@problem_id:1377161]，我们将学习如何计算一个事件在“恰好第 $n$ 步”首次发生的概率，这需要我们仔细地追踪和筛选所有可能的路径。", "problem": "一个网站的简化模型由五个不同的网页组成，标记为页面1到页面5。一个网络爬虫根据一组概率规则浏览该网站。在每个离散的时间步（称为一次“点击”）中，爬虫从其当前页面移动到一个相邻页面。连接如下：\n- 从页面1，有指向页面2、页面3和页面4的链接。\n- 从页面2，有指向页面1和页面5的链接。\n- 从页面3，有指向页面1和页面4的链接。\n- 从页面4，有指向页面1和页面5的链接。\n- 页面5没有出站链接。\n\n当爬虫在某个页面上时，它会以相等的概率选择其任一出站链接移动到下一个页面。如果爬虫到达一个没有出站链接的页面（一个汇点），它将在所有后续步骤中停留在该页面。\n\n假设爬虫从页面1开始。爬虫在恰好三次点击后首次位于页面5的概率是多少？\n\n请以精确分数形式给出您的答案。", "solution": "令状态为 $\\{1,2,3,4,5\\}$，其转移概率由在出站链接中的等概率选择和在页面$5$的吸收确定。因此：\n$$\nP(1\\to 2)=P(1\\to 3)=P(1\\to 4)=\\frac{1}{3},\\quad\nP(2\\to 1)=P(2\\to 5)=\\frac{1}{2},\\quad\nP(3\\to 1)=P(3\\to 4)=\\frac{1}{2},\\quad\nP(4\\to 1)=P(4\\to 5)=\\frac{1}{2},\\quad\nP(5\\to 5)=1.\n$$\n我们要求的是从页面$1$开始，在恰好三次点击后首次访问页面$5$的概率。这是所有长度为$3$的路径 $1\\to a\\to b\\to 5$ 的概率，其中 $a\\neq 5$ 且 $b\\neq 5$，并且这些转移是图所允许的。\n\n为了在第三步到达$5$，第二步的状态必须是$2$或$4$，因为只有$2$和$4$链接到$5$。我们检查在不先访问$5$的情况下，从$1$出发在第二步可以到达哪些状态：\n- 在第二步到达$b=2$需要路径 $1\\to a\\to 2$。到$2$的唯一入站链接来自$1$，因此到$2$的第二步需要$a=1$，但没有自环$1\\to 1$。因此，在第二步到达$b=2$是不可能的。\n- 在第二步到达$b=4$需要路径 $1\\to a\\to 4$。到$4$的入站链接来自$1$和$3$。可能的路径是$1\\to 1\\to 4$（不可能），$1\\to 3\\to 4$（可能），和$1\\to 4\\to 4$（不可能）。因此，唯一有效的途径是$1\\to 3\\to 4$。\n\n因此，唯一在恰好第三步首次到达$5$的路径是$1\\to 3\\to 4\\to 5$。其概率是沿此路径的转移概率的乘积：\n$$\nP(1\\to 3\\to 4\\to 5)=P(1\\to 3)\\,P(3\\to 4)\\,P(4\\to 5)=\\frac{1}{3}\\cdot\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{12}.\n$$\n这条路径在第$1$步或第$2$步没有访问$5$，所以它确实代表了在第$3$步的首次访问。对所有可行的路径求和会得到相同的值，因为路径是唯一的。", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "1377161"}]}