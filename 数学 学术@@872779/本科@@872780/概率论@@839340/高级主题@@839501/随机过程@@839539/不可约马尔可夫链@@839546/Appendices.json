{"hands_on_practices": [{"introduction": "在分析马尔可夫链时，首要任务是理解其状态空间的结构。这涉及到识别哪些状态可以相互“通信”，从而将状态空间划分为不同的通信类。这个练习 [@problem_id:1312394] 提供了一个具体的软件流程模型，旨在帮助您掌握如何划分通信类并判断马尔可夫链是否不可约，这是理解其长期行为的基础。", "problem": "一个软件过程的简化模型将其行为描述为离散时间马尔可夫链中的状态序列。该过程的状态空间由集合 $\\{S_1, S_2, S_3, S_4\\}$ 给出。状态之间的转移遵循以下概率规则：\n\n- 从状态 $S_1$ 出发，系统以概率 $p_1$ 转移到状态 $S_2$，或以概率 $1 - p_1$ 停留在状态 $S_1$。\n- 从状态 $S_2$ 出发，系统总是转移到状态 $S_3$。\n- 从状态 $S_3$ 出发，系统以概率 $p_3$ 转移到状态 $S_4$，或以概率 $1 - p_3$ 转移回状态 $S_2$。\n- 从状态 $S_4$ 出发，系统总是转移回状态 $S_3$。\n\n对于概率为 $p_1 = 0.4$ 和 $p_3 = 0.7$ 的特定情况，以下哪个陈述正确描述了该马尔可夫链的性质？\n\nA. 该链是不可约的，因此只有一个互通类：$\\{S_1, S_2, S_3, S_4\\}$。\n\nB. 该链有两个互通类：$\\{S_1, S_2\\}$ 和 $\\{S_3, S_4\\}$。\n\nC. 该链有两个互通类：$\\{S_1\\}$ 和 $\\{S_2, S_3, S_4\\}$。状态 $S_1$ 是暂留的。\n\nD. 该链有两个互通类：$\\{S_1, S_2, S_3\\}$ 和 $\\{S_4\\}$。状态 $S_4$ 是吸收的。\n\nE. 该链有三个互通类：$\\{S_1\\}$、$\\{S_2, S_3\\}$ 和 $\\{S_4\\}$。", "solution": "为了确定对该马尔可夫链的正确描述，我们需要确定其互通类。如果状态 $j$ 可从状态 $i$ 到达，并且状态 $i$ 可从状态 $j$ 到达，则称状态 $i$ 和 $j$ 是互通的，记为 $i \\leftrightarrow j$。一个互通类是其中任意一对状态都互通的最大状态集。如果所有状态都属于同一个互通类，则马尔可夫链是不可约的。\n\n让我们使用给定的转移概率 $p_1 = 0.4$ 和 $p_3 = 0.7$ 来分析状态之间的可达性。如果转移概率 $P_{ij}$ 大于零，则从状态 $i$ 到状态 $j$ 的转移是可能的。\n\n转移概率为：\n- $P_{11} = 1 - p_1 = 0.6$\n- $P_{12} = p_1 = 0.4$\n- $P_{23} = 1$\n- $P_{32} = 1 - p_3 = 0.3$\n- $P_{34} = p_3 = 0.7$\n- $P_{43} = 1$\n所有其他转移概率均为零。\n\n让我们检查互通关系。\n\n1.  **从状态 $S_1$ 开始**：\n    - $S_1$ 能到达其他状态吗？能。由于 $P_{12} = 0.4 > 0$，存在路径 $S_1 \\to S_2$。从 $S_2$ 出发，系统必须转移到 $S_3$（$P_{23}=1$）。从 $S_3$ 出发，它可以到达 $S_4$（$P_{34}=0.7>0$）。因此，$S_1$ 可以到达 $S_2$、$S_3$ 和 $S_4$。\n    - 其他状态能到达 $S_1$ 吗？让我们检查所有进入 $S_1$ 的转移。唯一进入 $S_1$ 的转移是 $P_{11}, P_{21}, P_{31}, P_{41}$。我们有 $P_{11} > 0$，但 $P_{21}=0$、$P_{31}=0$ 和 $P_{41}=0$。这意味着一旦系统离开状态 $S_1$，就再也无法返回。\n    - 由于 $S_2$ 无法到达 $S_1$，所以 $S_1$ 和 $S_2$ 不互通 ($S_1 \\not\\leftrightarrow S_2$)。推而广之，$S_1$ 与 $S_3$ 或 $S_4$ 也不互通。\n    - 因此，$\\{S_1\\}$ 自身形成一个互通类。由于可以离开该状态（以概率 $p_1=0.4$）并且永不返回，状态 $S_1$ 是一个暂留状态。\n\n2.  **检查其余状态 $\\{S_2, S_3, S_4\\}$**：\n    - **$S_2$ 和 $S_3$ 之间的互通性**：\n        - $S_2$ 能到达 $S_3$ 吗？能，$P_{23} = 1 > 0$。\n        - $S_3$ 能到达 $S_2$ 吗？能，$P_{32} = 0.3 > 0$。\n        - 所以，$S_2$ 和 $S_3$ 互通：$S_2 \\leftrightarrow S_3$。\n    - **$S_3$ 和 $S_4$ 之间的互通性**：\n        - $S_3$ 能到达 $S_4$ 吗？能，$P_{34} = 0.7 > 0$。\n        - $S_4$ 能到达 $S_3$ 吗？能，$P_{43} = 1 > 0$。\n        - 所以，$S_3$ 和 $S_4$ 互通：$S_3 \\leftrightarrow S_4$。\n    - **$S_2$ 和 $S_4$ 之间的互通性**：\n        - 由于互通性是传递关系（$S_2 \\leftrightarrow S_3$ 且 $S_3 \\leftrightarrow S_4$），我们可以得出结论 $S_2 \\leftrightarrow S_4$。让我们验证一下：\n        - 从 $S_2$ 到 $S_4$ 的路径：$S_2 \\to S_3 \\to S_4$。此路径存在。\n        - 从 $S_4$ 到 $S_2$ 的路径：$S_4 \\to S_3 \\to S_2$。此路径存在。\n        - 所以，$S_2$ 和 $S_4$ 也互通。\n\n3.  **结论**：\n    - 状态 $\\{S_2, S_3, S_4\\}$ 形成一个单一的互通类，因为这个集合中的每个状态都与集合中的其他所有状态互通，并且该集合之外没有状态与它们互通。\n    - 这个类是闭合的，因为没有任何从 $\\{S_2, S_3, S_4\\}$ 中任一状态到状态 $S_1$ 的转移。一旦链进入这个类，就永远无法离开。这意味着 $\\{S_2, S_3, S_4\\}$ 是一个常返类。\n    - 该链不是不可约的，因为它有多个互通类。\n    - 互通类是 $\\{S_1\\}$ 和 $\\{S_2, S_3, S_4\\}$。\n    - 状态 $S_1$ 是暂留的，因为可以离开该状态且不可能返回。\n\n将我们的发现与给定的选项进行比较：\n- A 是不正确的，因为该链不是不可约的。\n- B 是不正确的，因为 $S_2$ 和 $S_3$ 在同一个类中。\n- C 是正确的。它正确地指出了两个互通类 $\\{S_1\\}$ 和 $\\{S_2, S_3, S_4\\}$，并正确地将 $S_1$ 识别为暂留状态。\n- D 是不正确的，因为它错误地识别了类。此外，$S_4$ 不是吸收状态，因为可以离开它（$P_{43}=1$）。一个吸收状态 $i$ 必须满足 $P_{ii}=1$。\n- E 是不正确的，因为只有两个互通类。", "answer": "$$\\boxed{C}$$", "id": "1312394"}, {"introduction": "不可约非周期马尔可夫链的一个强大特性是其长期行为是可预测的，它会收敛到一个唯一的平稳分布。这个分布描述了系统在很长一段时间后处于各个状态的概率。通过这个练习 [@problem_id:1312364]，您将为一个服务器系统建立转移矩阵，并求解平衡方程以计算其平稳分布，这是对从系统可靠性到金融建模等众多现实世界问题进行分析的一项核心技能。", "problem": "一个数据中心的专用服务器以离散时间模型运行，其状态在每小时结束时进行评估。该服务器可以处于三种状态之一：运行中（Operational，主动处理任务）、待机（Standby，空闲但准备好接收任务）或故障（Failed，已崩溃并等待修复）。\n\n根据大量的日志数据，已确定了以下的一小时转移概率：\n- 如果服务器处于运行中状态，它有0.2的概率转移到待机状态（任务完成），有0.1的概率转移到故障状态（硬件/软件错误）。\n- 如果服务器处于待机状态，它有0.6的概率变为运行中状态（分配了新任务），有0.1的概率转移到故障状态（例如，电源故障）。\n- 如果服务器处于故障状态，它有0.8的概率在一小时内被修复并返回到待机状态。故障的服务器修复后不能直接变为运行中状态；它必须首先经过待机状态。\n\n任何未指定的转移意味着服务器在该小时内保持其当前状态。假设服务器连续运行很长时间，其处于运行中状态的时间在长期来看占多大比例？请将您的答案表示为保留三位有效数字的小数。", "solution": "将服务器建模为一个离散时间、有限状态的马尔可夫链，其状态为运行中（$O$）、待机（$S$）和故障（$F$）。根据未指定的转移意味着保持当前状态的规则，一步转移概率为：\n- 从$O$：$P_{OO}=1-0.2-0.1=0.7$，$P_{OS}=0.2$，$P_{OF}=0.1$。\n- 从$S$：$P_{SO}=0.6$，$P_{SS}=1-0.6-0.1=0.3$，$P_{SF}=0.1$。\n- 从$F$：$P_{FS}=0.8$，$P_{FF}=1-0.8=0.2$，$P_{FO}=0$。\n\n以状态顺序 $(O,S,F)$，转移矩阵为\n$$\nP=\\begin{pmatrix}\n0.7  0.2  0.1\\\\\n0.6  0.3  0.1\\\\\n0  0.8  0.2\n\\end{pmatrix}.\n$$\n设平稳分布为 $\\pi=(\\pi_{O},\\pi_{S},\\pi_{F})$，满足 $\\pi=\\pi P$ 和 $\\pi_{O}+\\pi_{S}+\\pi_{F}=1$。平衡方程为\n$$\n\\pi_{O}=0.7\\pi_{O}+0.6\\pi_{S}+0\\cdot\\pi_{F},\\quad\n\\pi_{S}=0.2\\pi_{O}+0.3\\pi_{S}+0.8\\pi_{F},\\quad\n\\pi_{F}=0.1\\pi_{O}+0.1\\pi_{S}+0.2\\pi_{F}.\n$$\n由第一个方程可得，\n$$\n\\pi_{O}-0.7\\pi_{O}-0.6\\pi_{S}=0\\;\\Rightarrow\\;0.3\\pi_{O}=0.6\\pi_{S}\\;\\Rightarrow\\;\\pi_{O}=2\\pi_{S}.\n$$\n由第三个方程可得，\n$$\n\\pi_{F}-0.2\\pi_{F}=0.1\\pi_{O}+0.1\\pi_{S}\\;\\Rightarrow\\;0.8\\pi_{F}=0.1(\\pi_{O}+\\pi_{S})\\;\\Rightarrow\\;\\pi_{F}=\\frac{1}{8}(\\pi_{O}+\\pi_{S}).\n$$\n代入 $\\pi_{O}=2\\pi_{S}$ 可得\n$$\n\\pi_{F}=\\frac{1}{8}(2\\pi_{S}+\\pi_{S})=\\frac{3}{8}\\pi_{S}.\n$$\n使用归一化条件 $\\pi_{O}+\\pi_{S}+\\pi_{F}=1$：\n$$\n2\\pi_{S}+\\pi_{S}+\\frac{3}{8}\\pi_{S}=1\\;\\Rightarrow\\;3\\pi_{S}+\\frac{3}{8}\\pi_{S}=\\frac{27}{8}\\pi_{S}=1\\;\\Rightarrow\\;\\pi_{S}=\\frac{8}{27}.\n$$\n则\n$$\n\\pi_{O}=2\\pi_{S}=\\frac{16}{27},\\qquad \\pi_{F}=\\frac{3}{8}\\pi_{S}=\\frac{1}{9}.\n$$\n因此，长期来看处于运行中状态的时间比例为 $\\pi_{O}=\\frac{16}{27}\\approx 0.59259\\ldots$，保留三位有效数字为 $0.593$。", "answer": "$$\\boxed{0.593}$$", "id": "1312364"}, {"introduction": "并非所有不可约马尔可夫链都以相同的方式收敛。当一个系统表现出固有的循环行为时，我们称之为周期性马尔可夫链，其极限行为需要更细致的分析。这个练习 [@problem_id:1368007] 探讨了一个具有周期性为2的系统，通过分析其偶数时间步长的转移，您会发现即使整体极限不存在，子序列的极限依然存在且稳定，这揭示了周期性系统中可预测的循环模式。", "problem": "一个特殊的计算机存储单元被建模为一个离散时间马尔可夫链。在任何给定的时间步，该单元的状态由两个属性描述：一个“逻辑”状态（0 或 1）和一个“物理”状态（‘Active’或‘Passive’）。这构成一个四状态系统，其中 $X_t$ 表示在时间步 $t$ 时该单元的状态：\n- 状态 1：逻辑 0，活跃 ($0_A$)\n- 状态 2：逻辑 0，非活跃 ($0_P$)\n- 状态 3：逻辑 1，活跃 ($1_A$)\n- 状态 4：逻辑 1，非活跃 ($1_P$)\n\n该单元的状态转移由一个时钟控制。在每个时钟周期，逻辑状态保证会翻转。转移到后续物理状态的具体转移概率取决于当前状态，如下所示：\n- 从状态 $0_A$（状态 1）出发，单元以概率 $p$ 转移到状态 $1_A$（状态 3），以概率 $1-p$ 转移到状态 $1_P$（状态 4）。\n- 从状态 $0_P$（状态 2）出发，单元以概率 $q$ 转移到状态 $1_A$（状态 3），以概率 $1-q$ 转移到状态 $1_P$（状态 4）。\n- 从状态 $1_A$（状态 3）出发，单元以概率 $r$ 转移到状态 $0_A$（状态 1），以概率 $1-r$ 转移到状态 $0_P$（状态 2）。\n- 从状态 $1_P$（状态 4）出发，单元以概率 $s$ 转移到状态 $0_A$（状态 1），以概率 $1-s$ 转移到状态 $0_P$（状态 2）。\n\n所有参数 $p, q, r, s$ 均为区间 $(0, 1)$ 内的常数。\n\n假设该存储单元从‘逻辑 0，活跃’状态（状态 1）开始。确定经过大量*偶数*个时钟周期后，该单元处于同一状态的长期概率。具体来说，计算以下极限：\n$$ \\lim_{n \\to \\infty} P(X_{2n} = 1 | X_0 = 1) $$\n请用 $p, q, r,$ 和 $s$ 的闭式解析表达式给出答案。", "solution": "设状态顺序为 $(1,2,3,4)=(0_{A},0_{P},1_{A},1_{P})$。一步转移矩阵为\n$$\nP=\\begin{pmatrix}\n0  0  p  1-p\\\\\n0  0  q  1-q\\\\\nr  1-r  0  0\\\\\ns  1-s  0  0\n\\end{pmatrix}.\n$$\n由于逻辑位在每一步都会翻转，因此经过两步后，链会返回到逻辑 $0$ 的状态类 $\\{1,2\\}$。限制在 $\\{1,2\\}$ 上的两步转移矩阵是 $2\\times 2$ 矩阵 $M$，由下式给出\n$$\nM=P^{2}\\big|_{\\{1,2\\}}=\\begin{pmatrix}\nM_{11}  M_{12}\\\\\nM_{21}  M_{22}\n\\end{pmatrix},\n$$\n其元素通过经过状态 3 和 4 的两步路径计算得出：\n$$\nM_{11}=pr+(1-p)s,\\quad M_{12}=p(1-r)+(1-p)(1-s),\n$$\n$$\nM_{21}=qr+(1-q)s,\\quad M_{22}=q(1-r)+(1-q)(1-s).\n$$\n因为 $p,q,r,s\\in(0,1)$，所以 $M$ 的所有元素都在 $(0,1)$ 区间内，因此这个 2 状态链是不可约且非周期的。因此，对于 $\\{1,2\\}$ 中的任何初始状态，偶数时间的分布收敛到 $M$ 的唯一平稳分布 $\\pi$。记 $\\pi=(\\pi_{1},\\pi_{2})$，其中 $\\pi=\\pi M$ 且 $\\pi_{1}+\\pi_{2}=1$，根据标准的 2 状态平衡方程可得\n$$\n\\pi_{1}=\\frac{M_{21}}{M_{12}+M_{21}}.\n$$\n代入矩阵元素，\n$$\n\\pi_{1}=\\frac{qr+(1-q)s}{\\,p(1-r)+(1-p)(1-s)+qr+(1-q)s\\,}.\n$$\n分母可以化简为\n$$\np(1-r)+(1-p)(1-s)+qr+(1-q)s\n=1+(q-p)(r-s),\n$$\n所以\n$$\n\\lim_{n\\to\\infty}P(X_{2n}=1\\mid X_{0}=1)=\\frac{qr+(1-q)s}{1+(q-p)(r-s)}.\n$$", "answer": "$$\\boxed{\\frac{qr+(1-q)s}{1+(q-p)(r-s)}}$$", "id": "1368007"}]}