{"hands_on_practices": [{"introduction": "这个练习为平稳分布的概念提供了一个具体的应用场景。通过将自动吸尘器的运动建模为马尔可夫链，我们可以确定从长远来看它在每个房间花费的时间比例。这使我们能够计算平均的灰尘收集率，这是一个直接从抽象概率中得出的实用指标。[@problem_id:1370817]", "problem": "一个先进的自动吸尘器在一个三居室公寓里工作，公寓包括一个客厅（状态1）、一个卧室（状态2）和一个厨房（状态3）。在每分钟结束时，吸尘器决定是停留在当前房间还是移动到另一个房间。其运动被建模为一个离散时间马尔可夫链。转移概率由矩阵 $P$ 给出，其中 $P_{ij}$ 是在一分钟内从房间 $i$ 移动到房间 $j$ 的概率：\n$$\nP = \\begin{pmatrix} 0  1/2  1/2 \\\\ 1/4  1/2  1/4 \\\\ 1/2  1/3  1/6 \\end{pmatrix}\n$$\n吸尘器收集灰尘的速率取决于它所在的房间。收集速率如下：\n- 客厅（状态1）：$d_1 = 5.0$ 克/分钟。\n- 卧室（状态2）：$d_2 = 2.0$ 克/分钟。\n- 厨房（状态3）：$d_3 = 8.0$ 克/分钟。\n\n假设吸尘器运行很长时间，其长期的平均灰尘收集速率是多少？以克/分钟为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "我们使用马尔可夫链的平稳分布来建模长期平均收集速率。设 $\\pi = (\\pi_{1},\\pi_{2},\\pi_{3})$ 是平稳分布，满足 $\\pi P = \\pi$ 和 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$。从 $\\pi P = \\pi$ 写出分量方程：\n$$\n\\pi_{1} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3}, \\quad\n\\pi_{2} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{2}\\pi_{2} + \\tfrac{1}{3}\\pi_{3}, \\quad\n\\pi_{3} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{6}\\pi_{3}.\n$$\n从第二个方程，\n$$\n\\pi_{2} - \\tfrac{1}{2}\\pi_{2} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{3}\\pi_{3} \\;\\;\\Rightarrow\\;\\; \\tfrac{1}{2}\\pi_{2} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{3}\\pi_{3} \\;\\;\\Rightarrow\\;\\; \\pi_{2} = \\pi_{1} + \\tfrac{2}{3}\\pi_{3}.\n$$\n将第一个方程的 $\\pi_{1} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3}$ 代入此式：\n$$\n\\pi_{2} = \\left(\\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3}\\right) + \\tfrac{2}{3}\\pi_{3} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{7}{6}\\pi_{3}\n\\;\\;\\Rightarrow\\;\\; \\tfrac{3}{4}\\pi_{2} = \\tfrac{7}{6}\\pi_{3}\n\\;\\;\\Rightarrow\\;\\; \\pi_{2} = \\tfrac{14}{9}\\pi_{3}.\n$$\n然后\n$$\n\\pi_{1} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3} = \\tfrac{1}{4}\\cdot\\tfrac{14}{9}\\pi_{3} + \\tfrac{1}{2}\\pi_{3} = \\tfrac{7}{18}\\pi_{3} + \\tfrac{9}{18}\\pi_{3} = \\tfrac{8}{9}\\pi_{3}.\n$$\n施加条件 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$ 得到\n$$\n\\left(\\tfrac{8}{9} + \\tfrac{14}{9} + 1\\right)\\pi_{3} = \\tfrac{31}{9}\\pi_{3} = 1 \\;\\;\\Rightarrow\\;\\; \\pi_{3} = \\tfrac{9}{31}, \\;\\; \\pi_{1} = \\tfrac{8}{31}, \\;\\; \\pi_{2} = \\tfrac{14}{31}.\n$$\n长期平均灰尘收集速率等于每分钟速率 $d_{1}=5$, $d_{2}=2$, $d_{3}=8$ 的平稳期望：\n$$\n\\bar{d} = \\pi_{1}d_{1} + \\pi_{2}d_{2} + \\pi_{3}d_{3} = \\tfrac{8}{31}\\cdot 5 + \\tfrac{14}{31}\\cdot 2 + \\tfrac{9}{31}\\cdot 8 = \\tfrac{40+28+72}{31} = \\tfrac{140}{31}.\n$$\n因此 $\\bar{d} = \\tfrac{140}{31} \\approx 4.516129\\ldots$，四舍五入到三位有效数字为 $4.52$ 克/分钟。", "answer": "$$\\boxed{4.52}$$", "id": "1370817"}, {"introduction": "本题超越了具体的数值结果，挑战你根据一个可变参数 $p$ 来分析系统的长期行为。通过为一个在圆形棋盘上移动的棋子构建转移矩阵并求解平稳分布，你将推导出一个关于棋子处于特定状态的概率公式。这个练习加深了你对基本转移概率如何塑造系统最终平衡状态的理解。[@problem_id:1370822]", "problem": "一个棋子在一个有四个格子的圆形棋盘上移动，这些格子按顺序标记为 0、1、2 和 3。棋子的移动遵循一套概率性规则。在每一轮中，如果棋子位于格子 0、1 或 2，它会以概率 $p$ 向前移动一格，或以概率 $1-p$ 向前移动两格，其中 $0 < p < 1$。所有的移动都在圆形轨道上进行，这意味着从格子 3 移动到格子 0 算作向前移动一格。如果棋子位于格子 3，则在下一轮中它必定会移动到格子 0。\n\n在游戏运行很长时间后，棋子的位置可以用一个平稳概率分布来描述。求棋子位于格子 0 的平稳概率。请用 $p$ 的函数表示你的答案。", "solution": "这个系统可以被建模为状态空间 $S = \\{0, 1, 2, 3\\}$ 上的一个离散时间马尔可夫链。令 $\\pi = (\\pi_0, \\pi_1, \\pi_2, \\pi_3)$ 为平稳概率分布，其中 $\\pi_i$ 是棋子长期位于格子 $i$ 的概率。\n\n首先，我们确定转移概率矩阵 $P$，其中 $P_{ij}$ 是从状态 $i$ 移动到状态 $j$ 的概率。移动是在圆形轨道上进行的，所以它们是模 4 运算。\n\n从状态 0：\n- 以概率 $p$ 移动到 $(0+1)\\pmod{4} = 1$。\n- 以概率 $1-p$ 移动到 $(0+2)\\pmod{4} = 2$。\n所以，$P$ 的第一行是 $[0, p, 1-p, 0]$。\n\n从状态 1：\n- 以概率 $p$ 移动到 $(1+1)\\pmod{4} = 2$。\n- 以概率 $1-p$ 移动到 $(1+2)\\pmod{4} = 3$。\n所以，$P$ 的第二行是 $[0, 0, p, 1-p]$。\n\n从状态 2：\n- 以概率 $p$ 移动到 $(2+1)\\pmod{4} = 3$。\n- 以概率 $1-p$ 移动到 $(2+2)\\pmod{4} = 0$。\n所以，$P$ 的第三行是 $[1-p, 0, 0, p]$。\n\n从状态 3：\n- 以概率 1 移动到状态 0。\n所以，$P$ 的第四行是 $[1, 0, 0, 0]$。\n\n综合这些，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n0  p  1-p  0 \\\\\n0  0  p  1-p \\\\\n1-p  0  0  p \\\\\n1  0  0  0\n\\end{pmatrix}\n$$\n\n平稳分布 $\\pi$ 必须满足方程 $\\pi P = \\pi$，这可以转化为以下线性方程组：\n1.  $\\pi_0 = 0 \\cdot \\pi_0 + 0 \\cdot \\pi_1 + (1-p) \\cdot \\pi_2 + 1 \\cdot \\pi_3 \\implies \\pi_0 = (1-p)\\pi_2 + \\pi_3$\n2.  $\\pi_1 = p \\cdot \\pi_0 + 0 \\cdot \\pi_1 + 0 \\cdot \\pi_2 + 0 \\cdot \\pi_3 \\implies \\pi_1 = p\\pi_0$\n3.  $\\pi_2 = (1-p) \\cdot \\pi_0 + p \\cdot \\pi_1 + 0 \\cdot \\pi_2 + 0 \\cdot \\pi_3 \\implies \\pi_2 = (1-p)\\pi_0 + p\\pi_1$\n4.  $\\pi_3 = 0 \\cdot \\pi_0 + (1-p) \\cdot \\pi_1 + p \\cdot \\pi_2 + 0 \\cdot \\pi_3 \\implies \\pi_3 = (1-p)\\pi_1 + p\\pi_2$\n\n此外，所有概率之和必须为 1：\n5.  $\\pi_0 + \\pi_1 + \\pi_2 + \\pi_3 = 1$\n\n我们可以通过将 $\\pi_1$、$\\pi_2$ 和 $\\pi_3$ 用 $\\pi_0$ 表示来解这个方程组。\n从方程 (2)，我们有：\n$$ \\pi_1 = p\\pi_0 $$\n\n将此代入方程 (3)：\n$$ \\pi_2 = (1-p)\\pi_0 + p(p\\pi_0) = (1-p+p^2)\\pi_0 $$\n\n现在，将 $\\pi_1$ 和 $\\pi_2$ 的表达式代入方程 (4)：\n$$ \\pi_3 = (1-p)(p\\pi_0) + p((1-p+p^2)\\pi_0) $$\n$$ \\pi_3 = (p-p^2)\\pi_0 + (p-p^2+p^3)\\pi_0 = (2p-2p^2+p^3)\\pi_0 $$\n\n我们现在已经将所有其他概率用 $\\pi_0$ 表示。让我们使用归一化条件（方程 5）：\n$$ \\pi_0 + \\pi_1 + \\pi_2 + \\pi_3 = 1 $$\n$$ \\pi_0 + p\\pi_0 + (1-p+p^2)\\pi_0 + (2p-2p^2+p^3)\\pi_0 = 1 $$\n\n提出因子 $\\pi_0$：\n$$ \\pi_0 (1 + p + (1-p+p^2) + (2p-2p^2+p^3)) = 1 $$\n\n合并括号内的项：\n$$ \\pi_0 ( (1+1) + (p-p+2p) + (p^2-2p^2) + p^3 ) = 1 $$\n$$ \\pi_0 (2 + 2p - p^2 + p^3) = 1 $$\n\n最后，解出 $\\pi_0$：\n$$ \\pi_0 = \\frac{1}{p^3 - p^2 + 2p + 2} $$\n这个表达式给出了棋子位于格子 0 的平稳概率，作为 $p$ 的函数。", "answer": "$$\\boxed{\\frac{1}{p^{3} - p^{2} + 2p + 2}}$$", "id": "1370822"}, {"introduction": "这个问题探讨了在一个更复杂的网络结构上的随机游走，初看起来可能令人望而生畏。然而，它揭示了关于无向图上随机游走的一个强大而优雅的原理：处于某个顶点的平稳概率与其度数成正比。这个练习鼓励你去寻找马尔可夫链的潜在对称性和特殊性质，这些性质可以极大地简化分析过程。[@problem_id:1370816]", "problem": "考虑一个由8个相互连接的站点组成的系统，标记为 $V = \\{A_1, A_2, A_3, A_4, B_1, B_2, B_3, B_4\\}$。这些站点之间的连接形成一个具有以下结构的图：\n1.  站点集合 $\\{A_1, A_2, A_3, A_4\\}$ 构成一个完全图；也就是说，该集合中的每个站点都与该集合中的所有其他站点相连。\n2.  站点集合 $\\{B_1, B_2, B_3, B_4\\}$ 也构成一个完全图。\n3.  站点 $A_4$ 和站点 $B_1$ 之间存在一条连接，将两个完全图连接起来。\n没有其他连接。\n\n一个粒子在该站点网络上进行随机游走。在每个离散时间步，位于某个站点的粒子会移动到其直接连接（相邻）的站点之一。目标站点是从所有可用的相邻站点中均匀随机选择的。\n\n经过非常多的时间步后，系统趋于一个稳态，此时在任何给定站点找到粒子的概率变为常数。这被称为极限概率。\n\n求在站点 $A_2$ 找到粒子的极限概率。将您的答案表示为最简精确分数。", "solution": "将随机游走建模为无向连通图上的马尔可夫链。对于顶点集为 $V$、边集为 $E$ 的无向图上的简单随机游走，从顶点 $u$ 到相邻顶点 $v$ 的转移概率为\n$$\nP(u \\to v) = \\frac{1}{\\deg(u)} \\quad \\text{如果 } \\{u,v\\} \\in E,\n$$\n否则为零。使用细致平衡条件的一个标准结果表明，平稳分布 $\\pi$ 为\n$$\n\\pi(v) = \\frac{\\deg(v)}{2|E|} \\quad \\text{对所有 } v \\in V,\n$$\n因为对于相邻的 $u,v$，\n$$\n\\pi(u)P(u \\to v) = \\frac{\\deg(u)}{2|E|} \\cdot \\frac{1}{\\deg(u)} = \\frac{1}{2|E|} = \\frac{\\deg(v)}{2|E|} \\cdot \\frac{1}{\\deg(v)} = \\pi(v)P(v \\to u).\n$$\n给定的图是连通的，并且包含三角形（每个 $K_{4}$ 团），因此该链是不可约且非周期的，这意味着它会收敛到唯一的平稳分布。\n\n计算度数：\n- 在每个 $K_{4}$ 中，每个顶点在其团内的度数为 $3$。\n- 桥接在 $A_{4}$ 和 $B_{1}$ 之间增加了一条边，因此 $\\deg(A_{4}) = 4$ 且 $\\deg(B_{1}) = 4$。\n- 所有其他顶点的度数仍为 $3$。\n\n因此，\n$$\n\\deg(A_{1})=\\deg(A_{2})=\\deg(A_{3})=3,\\quad \\deg(A_{4})=4,\\quad \\deg(B_{1})=4,\\quad \\deg(B_{2})=\\deg(B_{3})=\\deg(B_{4})=3.\n$$\n计算边数：每个 $K_{4}$ 贡献 $\\binom{4}{2}=6$ 条边，桥接增加 $1$ 条边，所以\n$$\n|E| = 6 + 6 + 1 = 13, \\quad \\text{因此} \\quad 2|E| = 26.\n$$\n等价地，根据握手引理，$\\sum_{v \\in V} \\deg(v) = 3+3+3+4+4+3+3+3 = 26 = 2|E|$。\n\n因此，在 $A_{2}$ 处的极限概率为\n$$\n\\pi(A_{2}) = \\frac{\\deg(A_{2})}{2|E|} = \\frac{3}{26}.\n$$", "answer": "$$\\boxed{\\frac{3}{26}}$$", "id": "1370816"}]}