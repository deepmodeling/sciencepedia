{"hands_on_practices": [{"introduction": "布朗运动的一个核心特征是其独立增量，但这并不意味着过程本身在不同时刻的取值是相互独立的。恰恰相反，一个粒子的当前位置包含了其过去所有移动的累积效应。这个练习旨在量化这种时间上的关联性，通过计算布朗运动在两个不同时刻取值的相关系数，揭示其“记忆”的强度。[@problem_id:1309499]", "problem": "在金融数学中，股票对数价格随时间演变的一个简化模型是标准维纳过程，也称为标准布朗运动。设该过程表示为 $\\{W(t)\\}_{t \\ge 0}$。它具有以下性质：\n1.  $W(0) = 0$。\n2.  对于任意时间 $t > 0$，随机变量 $W(t)$ 服从均值为0、方差为 $t$ 的正态分布。\n3.  对于任意两个满足 $0 \\le s  t$ 的时间 $s$ 和 $t$，增量 $W(t) - W(s)$ 是一个随机变量，也服从均值为0、方差为 $t-s$ 的正态分布。\n4.  对于任意不重叠的时间区间序列，相应的增量是统计独立的。例如，对于 $0 \\le t_1  t_2 \\le t_3  t_4$，增量 $W(t_2) - W(t_1)$ 和 $W(t_4) - W(t_3)$ 是独立的。\n\n一位分析师正在研究股票在两个不同时间点的对数价格之间的关系。设 $t_1$ 和 $t_2$ 是两个固定的时间，满足 $0  t_1  t_2$。\n\n计算过程在时间 $t_1$ 和时间 $t_2$ 的值之间的相关系数 $\\rho(W(t_1), W(t_2))$。您的最终答案应为一个用 $t_1$ 和 $t_2$ 表示的符号表达式。", "solution": "我们使用中心化随机变量的相关系数的定义：\n$$\n\\rho\\!\\left(W(t_{1}),W(t_{2})\\right)=\\frac{\\operatorname{Cov}\\!\\left(W(t_{1}),W(t_{2})\\right)}{\\sqrt{\\operatorname{Var}\\!\\left(W(t_{1})\\right)\\operatorname{Var}\\!\\left(W(t_{2})\\right)}}.\n$$\n对于标准布朗运动，对所有 $t \\ge 0$，$W(t)$ 的均值为0，所以\n$$\n\\operatorname{Cov}\\!\\left(W(t_{1}),W(t_{2})\\right)=\\mathbb{E}\\!\\left[W(t_{1})W(t_{2})\\right].\n$$\n使用独立增量进行分解：\n$$\nW(t_{2})=W(t_{1})+\\bigl(W(t_{2})-W(t_{1})\\bigr).\n$$\n那么\n$$\n\\mathbb{E}\\!\\left[W(t_{1})W(t_{2})\\right]=\\mathbb{E}\\!\\left[W(t_{1})^{2}\\right]+\\mathbb{E}\\!\\left[W(t_{1})\\bigl(W(t_{2})-W(t_{1})\\bigr)\\right].\n$$\n根据增量的独立性，$W(t_{1})$ 与 $W(t_{2})-W(t_{1})$ 独立，并且 $\\mathbb{E}[W(t_{2})-W(t_{1})]=0$，因此\n$$\n\\mathbb{E}\\!\\left[W(t_{1})\\bigl(W(t_{2})-W(t_{1})\\bigr)\\right]=\\mathbb{E}[W(t_{1})]\\mathbb{E}[W(t_{2})-W(t_{1})]=0.\n$$\n因此，\n$$\n\\operatorname{Cov}\\!\\left(W(t_{1}),W(t_{2})\\right)=\\mathbb{E}\\!\\left[W(t_{1})^{2}\\right]=\\operatorname{Var}\\!\\left(W(t_{1})\\right)=t_{1}.\n$$\n使用 $\\operatorname{Var}(W(t_{1}))=t_{1}$ 和 $\\operatorname{Var}(W(t_{2}))=t_{2}$，相关系数为\n$$\n\\rho\\!\\left(W(t_{1}),W(t_{2})\\right)=\\frac{t_{1}}{\\sqrt{t_{1}t_{2}}}=\\sqrt{\\frac{t_{1}}{t_{2}}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{t_{1}}{t_{2}}}}$$", "id": "1309499"}, {"introduction": "理论概念如何转化为可计算的模型？这个练习将带你从理论走向实践，通过构建布朗运动的离散时间近似来模拟一个随机路径。你将学习到，一个复杂的随机轨迹可以由一系列独立的、服从正态分布的随机步长累加而成，这是连接布朗运动理论与金融、物理等领域中计算模拟的基本方法。[@problem_id:1309516]", "problem": "一位物理学家正在开发一个计算模型，用于描述悬浮在水中的花粉颗粒的一维运动，这是布朗运动的一个经典例子。粒子在时间 $t$ 的位置（记作 $X(t)$）由方程 $X(t) = \\sigma W(t)$ 建模，其中 $W(t)$ 是一个标准维纳过程（或标准布朗运动），而 $\\sigma$ 是扩散系数。粒子从原点开始运动，因此 $X(0) = 0$。\n\n为了模拟粒子的路径，时间区间 $[0, T]$ 被分成 $N$ 个大小为 $\\Delta t = T/N$ 的相等步长。每一步结束时的位置 $X(t_{k+1})$（其中 $t_k = k \\Delta t$）是根据上一步的位置 $X(t_k)$，使用以下离散更新法则近似计算的：\n$$X(t_{k+1}) = X(t_k) + \\sigma \\sqrt{\\Delta t} \\cdot Z_{k+1}$$\n这里，$\\{Z_1, Z_2, \\dots, Z_N\\}$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的一系列独立随机数。\n\n对于一次特定的模拟，参数设置如下：\n- 扩散系数, $\\sigma = 0.50 \\, \\mu\\text{m}/\\sqrt{\\text{s}}$\n- 总模拟时间, $T = 1.0 \\, \\text{s}$\n- 时间步数, $N = 4$\n\n在这次模拟运行中，从标准正态分布中抽取的四个随机数序列为：\n$Z_1 = 0.84$, $Z_2 = -1.28$, $Z_3 = 0.39$, $Z_4 = -0.52$。\n\n使用这些信息，计算粒子在时间 $T$ 的最终位置。结果以微米（$\\mu\\text{m}$）为单位表示，并保留三位有效数字。", "solution": "由维纳过程驱动的过程的离散时间欧拉-丸山更新法则为\n$$X(t_{k+1})=X(t_{k})+\\sigma \\sqrt{\\Delta t}\\,Z_{k+1},$$\n其中 $X(0)=0$ 且 $t_{k}=k\\Delta t$，$\\Delta t=\\frac{T}{N}$。\n\n将从 $k=0$ 到 $k=N-1$ 的增量求和，得到一个伸缩级数：\n$$X(t_{N})-X(t_{0})=\\sum_{k=0}^{N-1}\\left[X(t_{k+1})-X(t_{k})\\right]=\\sum_{k=0}^{N-1}\\sigma \\sqrt{\\Delta t}\\,Z_{k+1}.$$\n因为 $X(t_{0})=X(0)=0$ 且 $t_{N}=T$，我们有\n$$X(T)=\\sigma \\sqrt{\\Delta t}\\sum_{j=1}^{N}Z_{j}.$$\n\n对于给定的参数，$\\Delta t=\\frac{T}{N}=\\frac{1.0}{4}=0.25$，因此 $\\sqrt{\\Delta t}=\\sqrt{0.25}=\\frac{1}{2}$。所以，\n$$\\sigma \\sqrt{\\Delta t}=0.50\\times \\frac{1}{2}=0.25.$$\n所提供的标准正态变量之和为\n$$\\sum_{j=1}^{4}Z_{j}=0.84+(-1.28)+0.39+(-0.52)=(0.84-1.28)+(0.39-0.52)=-0.44-0.13=-0.57.$$\n因此，\n$$X(T)=0.25\\times(-0.57)=-0.1425.$$\n\n以微米表示并保留三位有效数字，结果为 $-0.143$。", "answer": "$$\\boxed{-0.143}$$", "id": "1309516"}, {"introduction": "如果我们只知道一个随机游走的终点，我们能推断它在过程中的“经历”吗？这个问题引导我们探索布朗运动路径更深层次的奇妙性质。本练习将介绍强大的“反射原理”，并用它来解决一个看似反直觉的问题：在已知粒子最终停在某个位置的条件下，计算其路径曾经达到过某个更高点的概率。[@problem_id:1366766]", "problem": "一个粒子沿直线的位置被建模为一个物理布朗运动过程 $X(t)$，起始于 $X(0)=0$。该过程由 $X(t) = \\sigma W(t)$ 描述，其中 $W(t)$ 是一个无量纲的标准布朗运动，$\\sigma$ 是扩散系数。标准布朗运动 $W(t)$ 是一个随机过程，它起始于 $W(0)=0$，且对于任意 $0 \\le s  t$，其增量 $W(t)-W(s)$ 服从均值为0、方差为 $t-s$ 的正态分布。\n\n该粒子在一种介质中被观测，其扩散系数为 $\\sigma = 1.0 \\, \\text{m} \\cdot \\text{s}^{-1/2}$。在 $10$ s 的时间后，测得粒子的位置为 $-5.0$ m。\n\n给定此最终位置，计算在该时间间隔内，粒子的最大位置曾经达到或超过 $3.0$ m 的概率。\n\n将你的最终答案四舍五入到四位有效数字。", "solution": "设物理布朗运动为 $X(t)$，其扩散系数为 $\\sigma$。设 $W(t) = X(t)/\\sigma$ 为相应的标准布朗运动。给定的参数如下：\n- 最终时间：$t_f = 10$ s\n- 扩散系数：$\\sigma = 1.0 \\, \\text{m} \\cdot \\text{s}^{-1/2}$\n- 最终位置：$X(t_f) = b = -5.0$ m\n- 阈值水平：$a = 3.0$ m\n\n我们要求解在最终位置为 $b$ 的条件下，粒子达到的最大位置至少为 $a$ 的概率。设 $M_t^X = \\max_{0 \\le s \\le t} X(s)$ 为该物理过程的游程最大值。我们希望计算 $P(M_{t_f}^X \\ge a | X(t_f) = b)$。\n\n我们可以用标准布朗运动 $W(t)$ 来重新表述这个问题。\n条件 $X(t_f) = b$ 等价于 $\\sigma W(t_f) = b$，即 $W(t_f) = b/\\sigma$。\n条件 $M_{t_f}^X \\ge a$ 等价于 $\\sigma \\max_{0 \\le s \\le t_f} W(s) \\ge a$，即 $M_{t_f}^W \\ge a/\\sigma$，其中 $M_t^W = \\max_{0 \\le s \\le t} W(s)$。\n\n因此，问题就变成了计算 $P(M_{t_f}^W \\ge a/\\sigma | W(t_f) = b/\\sigma)$。\n我们定义 $a' = a/\\sigma$ 和 $b' = b/\\sigma$。我们需要求解 $P(M_{t_f}^W \\ge a' | W(t_f) = b')$。\n\n这是一个经典结果，可以通过布朗运动的反射原理推导出来。反射原理表明，对于一个标准布朗运动 $W(t)$、一个水平 $L > 0$ 和一个时间 $t$，其最大值 $M_t^W$ 至少为 $L$ 且过程在 $y \\le L$ 处结束的概率，等于过程在 $2L-y$ 处结束的概率。\n$P(M_t^W \\ge L, W(t) = y) = P(W(t) = 2L-y)$ for $y \\le L$。\n就概率密度而言，如果 $g_t(y)$ 是 $W(t)$ 的概率密度函数（PDF），那么对于 $y \\le L$，$ (W(t), M_t^W)$ 的联合概率密度满足 $f_{W(t), M_t^W}(y, \\ge L) = g_t(2L-y)$。\n\n我们想要找到条件概率 $P(M_t^W \\ge a' | W(t) = b')$。\n根据条件概率密度的定义：\n$$ P(M_t^W \\ge a' | W(t) = b') = \\frac{P(M_t^W \\ge a', W(t) = b')}{P(W(t) = b')} $$\n分子表示过程的最大值至少为 $a'$ 且在 $b'$ 处结束的概率密度。由于 $b=-5.0$ m 且 $a=3.0$ m，我们有 $b'=-5.0$ 和 $a'=3.0$。因此 $b'  a'$，所以我们可以应用反射原理，其中 $L=a'$ 且 $y=b'$。\n分子的概率密度是 $g_{t_f}(2a' - b')$。\n分母的概率密度是 $g_{t_f}(b')$。\n所以，条件概率是这些密度的比值：\n$$ P(M_{t_f}^W \\ge a' | W(t_f) = b') = \\frac{g_{t_f}(2a' - b')}{g_{t_f}(b')} $$\n\n过程 $W(t)$ 是一个标准布朗运动，所以 $W(t) \\sim N(0, t)$，其PDF是：\n$$ g_t(y) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{y^2}{2t}\\right) $$\n将此代入我们的比值中：\n$$ \\frac{g_{t_f}(2a' - b')}{g_{t_f}(b')} = \\frac{\\frac{1}{\\sqrt{2\\pi t_f}} \\exp\\left(-\\frac{(2a' - b')^2}{2t_f}\\right)}{\\frac{1}{\\sqrt{2\\pi t_f}} \\exp\\left(-\\frac{(b')^2}{2t_f}\\right)} = \\exp\\left(-\\frac{(2a' - b')^2 - (b')^2}{2t_f}\\right) $$\n我们来简化指数部分：\n$$ (2a' - b')^2 - (b')^2 = (4(a')^2 - 4a'b' + (b')^2) - (b')^2 = 4(a')^2 - 4a'b' = 4a'(a' - b') $$\n所以概率是：\n$$ P(M_{t_f}^W \\ge a' | W(t_f) = b') = \\exp\\left(-\\frac{4a'(a' - b')}{2t_f}\\right) = \\exp\\left(-\\frac{2a'(a' - b')}{t_f}\\right) $$\n现在，我们代回 $a' = a/\\sigma$ 和 $b' = b/\\sigma$：\n$$ \\exp\\left(-\\frac{2(a/\\sigma)(a/\\sigma - b/\\sigma)}{t_f}\\right) = \\exp\\left(-\\frac{2a(a - b)}{\\sigma^2 t_f}\\right) $$\n这是我们得到的最终概率的符号表达式。\n\n现在我们代入给定的数值：\n$a = 3.0$ m\n$b = -5.0$ m\n$\\sigma = 1.0 \\, \\text{m} \\cdot \\text{s}^{-1/2}$\n$t_f = 10$ s\n\n概率 = $\\exp\\left(-\\frac{2 \\times 3.0 \\times (3.0 - (-5.0))}{(1.0)^2 \\times 10}\\right)$\n概率 = $\\exp\\left(-\\frac{2 \\times 3.0 \\times 8.0}{10}\\right)$\n概率 = $\\exp\\left(-\\frac{48.0}{10}\\right) = \\exp(-4.8)$\n\n现在我们计算数值并四舍五入到四位有效数字：\n$\\exp(-4.8) \\approx 0.008229746...$\n四舍五入到四位有效数字得到 $0.008230$。", "answer": "$$\\boxed{0.008230}$$", "id": "1366766"}]}