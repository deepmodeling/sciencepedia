{"hands_on_practices": [{"introduction": "柯尔莫哥洛夫方程最基础的应用之一是为只有两个状态的系统建模。这类系统虽然简单，却是理解概率如何随时间演化的理想起点。这个关于随机交通信号灯的练习 [@problem_id:1399783] 提供了一个直观的场景，帮助你掌握如何构建和求解柯尔莫哥洛夫向前方程，从而精确描述系统在任意时刻处于特定状态的概率。", "problem": "考虑一个由随机信号控制的单一交通路口的简化模型。交通信号灯可以处于两种状态之一：状态 0，南北方向为绿灯；或状态 1，东西方向为绿灯。该系统表现为一个连续时间马尔可夫过程。\n\n信号灯并非按固定计时器运行。相反，如果信号灯处于状态 0（“南北绿灯”），它会以一个恒定的速率 $\\lambda_1$ 转换到状态 1（“东西绿灯”）。反之，如果信号灯处于状态 1，它会以一个恒定的速率 $\\lambda_2$ 转换回状态 0。速率 $\\lambda_1$ 和 $\\lambda_2$ 的单位是时间的倒数。\n\n假设在时间 $t=0$ 时，系统确定处于状态 0（“南北绿灯”）。\n\n确定在稍后的时间 $t  0$ 时，信号灯处于状态 0 的概率。您的答案应为一个关于 $\\lambda_1$、$\\lambda_2$ 和 $t$ 的解析表达式。", "solution": "令 $X(t) \\in \\{0,1\\}$ 表示时间 $t$ 时的交通信号灯状态，从 $0 \\to 1$ 的转移速率为 $\\lambda_{1}$，从 $1 \\to 0$ 的转移速率为 $\\lambda_{2}$。这是一个双态连续时间马尔可夫链，其生成元为\n$$\nQ=\\begin{pmatrix}\n-\\lambda_{1}  \\lambda_{1} \\\\\n\\lambda_{2}  -\\lambda_{2}\n\\end{pmatrix}.\n$$\n令 $p_{0}(t)=\\mathbb{P}(X(t)=0)$ 且 $p_{1}(t)=\\mathbb{P}(X(t)=1)=1-p_{0}(t)$。柯尔莫哥洛夫前向方程给出\n$$\n\\frac{d}{dt}p_{0}(t)=-\\lambda_{1}p_{0}(t)+\\lambda_{2}p_{1}(t)=-\\left(\\lambda_{1}+\\lambda_{2}\\right)p_{0}(t)+\\lambda_{2},\n$$\n初始条件为 $p_{0}(0)=1$。\n\n这是一个一阶线性常微分方程。使用积分因子 $\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)$，我们得到\n$$\n\\frac{d}{dt}\\Big(p_{0}(t)\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)\\Big)=\\lambda_{2}\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right).\n$$\n从 $0$到 $t$ 积分：\n$$\np_{0}(t)\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)-p_{0}(0)=\\lambda_{2}\\int_{0}^{t}\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})s\\right)\\,ds\n=\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}\\left(\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)-1\\right).\n$$\n求解 $p_{0}(t)$ 并使用 $p_{0}(0)=1$：\n$$\np_{0}(t)=\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right)+\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}\\left(1-\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right)\\right)\n=\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}+\\frac{\\lambda_{1}}{\\lambda_{1}+\\lambda_{2}}\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right).\n$$\n这就是在时间 $t0$ 时信号灯处于状态 0 的所求概率。", "answer": "$$\\boxed{\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}+\\frac{\\lambda_{1}}{\\lambda_{1}+\\lambda_{2}}\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right)}$$", "id": "1399783"}, {"introduction": "许多现实世界中的系统都包含不可逆转的“终结”状态，例如设备故障或化学反应完成。这个关于元件损耗的练习 [@problem_id:1399745] 将我们从计算基本概率推进到分析更具实际意义的系统可靠性问题。通过求解，你将学会如何利用状态概率来确定系统处于中间“磨损”状态风险最大的时刻，这在工程和可靠性理论中是一个非常典型且重要的问题。", "problem": "一个新制造的电子元件会经历磨损并最终失效。其状态可被建模为一个具有三个状态的连续时间随机过程：状态1（‘新’）、状态2（‘磨损’）和状态3（‘失效’）。元件的寿命总是从状态1开始。\n\n从‘新’状态到‘磨损’状态的转移是一个速率恒为 $\\lambda_1$ 的泊松过程。类似地，从‘磨损’状态到‘失效’状态的转移是一个速率恒为 $\\lambda_2$ 的泊松过程。‘失效’状态是一个吸收态，意味着一旦元件失效，就不会再发生进一步的转移。该模型反映了加速退化，故给定条件为 $0  \\lambda_1  \\lambda_2$。\n\n确定该元件处于‘磨损’状态的概率最大时的时间 $t$。用包含 $\\lambda_1$ 和 $\\lambda_2$ 的符号表达式来表示你的答案。", "solution": "令 $T_{1}$ 表示从状态1转移到状态2的随机时间。由于此转移是速率恒为 $\\lambda_{1}$ 的泊松过程，我们有 $T_{1} \\sim \\text{Exp}(\\lambda_{1})$，其概率密度函数为 $f_{T_{1}}(s) = \\lambda_{1} \\exp(-\\lambda_{1} s)$（对于 $s \\geq 0$）。令 $T_{2}$ 表示进入状态2后从状态2转移到状态3的随机时间；由于此转移速率恒为 $\\lambda_{2}$，且根据无记忆性，$T_{2} \\sim \\text{Exp}(\\lambda_{2})$ 并与 $T_{1}$ 独立。\n\n元件在时间 $t$ 处于‘磨损’状态，当且仅当到时间 $t$ 为止，向状态2的转移已经发生，而后续向状态3的转移尚未发生。这个事件是 $\\{T_{1} \\leq t,\\ T_{1} + T_{2}  t\\}$。利用独立性，并以 $T_{1} = s$ 为条件，我们得到\n$$\nP_{2}(t) = \\int_{0}^{t} f_{T_{1}}(s) \\, \\mathbb{P}(T_{2}  t - s) \\, ds \n= \\int_{0}^{t} \\lambda_{1} \\exp(-\\lambda_{1} s) \\exp(-\\lambda_{2} (t - s)) \\, ds.\n$$\n提出因子 $\\exp(-\\lambda_{2} t)$ 并积分：\n$$\nP_{2}(t) = \\lambda_{1} \\exp(-\\lambda_{2} t) \\int_{0}^{t} \\exp\\big((\\lambda_{2} - \\lambda_{1}) s\\big) \\, ds \n= \\lambda_{1} \\exp(-\\lambda_{2} t) \\cdot \\frac{\\exp\\big((\\lambda_{2} - \\lambda_{1}) t\\big) - 1}{\\lambda_{2} - \\lambda_{1}}.\n$$\n这可简化为以下已知形式\n$$\nP_{2}(t) = \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\left( \\exp(-\\lambda_{1} t) - \\exp(-\\lambda_{2} t) \\right).\n$$\n\n为求得使 $P_{2}(t)$ 最大化的时间 $t$，我们对 $t$ 求导，并令其导数为零：\n$$\nP_{2}'(t) = \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\left( -\\lambda_{1} \\exp(-\\lambda_{1} t) + \\lambda_{2} \\exp(-\\lambda_{2} t) \\right) = 0.\n$$\n于是\n$$\n-\\lambda_{1} \\exp(-\\lambda_{1} t) + \\lambda_{2} \\exp(-\\lambda_{2} t) = 0\n\\quad \\Longleftrightarrow \\quad\n\\lambda_{2} \\exp(-\\lambda_{2} t) = \\lambda_{1} \\exp(-\\lambda_{1} t).\n$$\n整理可得\n$$\n\\exp\\big( -(\\lambda_{2} - \\lambda_{1}) t \\big) = \\frac{\\lambda_{1}}{\\lambda_{2}}\n\\quad \\Longrightarrow \\quad\nt^{\\ast} = \\frac{1}{\\lambda_{2} - \\lambda_{1}} \\ln\\!\\left( \\frac{\\lambda_{2}}{\\lambda_{1}} \\right).\n$$\n由于 $0  \\lambda_{1}  \\lambda_{2}$，我们有 $\\ln(\\lambda_{2}/\\lambda_{1})  0$，故 $t^{\\ast} \\geq 0$。此外，$P_{2}(0) = 0$ 且 $\\lim_{t \\to \\infty} P_{2}(t) = 0$，在 $t^{\\ast}$ 处计算二阶导数可得\n$$\nP_{2}''(t^{\\ast}) = \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\left( \\lambda_{1}^{2} \\exp(-\\lambda_{1} t^{\\ast}) - \\lambda_{2}^{2} \\exp(-\\lambda_{2} t^{\\ast}) \\right) \n= \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\lambda_{2} (\\lambda_{1} - \\lambda_{2}) \\exp(-\\lambda_{2} t^{\\ast})  0,\n$$\n这证实了 $t^{\\ast}$ 是使 $P_{2}(t)$ 最大化的唯一时间点。\n\n因此，处于‘磨损’状态的概率在以下时间点达到最大值：\n$$\nt^{\\ast} = \\frac{1}{\\lambda_{2} - \\lambda_{1}} \\ln\\!\\left( \\frac{\\lambda_{2}}{\\lambda_{1}} \\right).\n$$", "answer": "$$\\boxed{\\frac{1}{\\lambda_{2}-\\lambda_{1}} \\ln\\!\\left(\\frac{\\lambda_{2}}{\\lambda_{1}}\\right)}$$", "id": "1399745"}, {"introduction": "除了关心“在时刻 $t$ 系统处于什么状态？”，另一个核心问题是“系统需要多长时间才能首次到达某个特定状态？”。这个问题引出了“首达时间”的概念，它对于理解事件发生的时机和系统失效至关重要。这个关于量子点存储单元的练习 [@problem_id:1399808] 引入了一种强大的分析工具——拉普拉斯变换，它能将与首达时间相关的柯尔莫哥洛夫向后方程（微分方程）转化为更易于处理的代数方程组。", "problem": "一个描述单个量子点存储单元状态的简化模型包含一个状态空间为 $S = \\{0, 1, 2\\}$ 的连续时间马尔可夫链。状态 0 表示所期望的“数据写入”基态。状态 1 是一个不稳定的激发态。状态 2 是一个永久性的、不可恢复的“损坏”错误状态，它是一个吸收态。\n\n从基态（状态 0）开始，热能可以导致系统以速率 $\\alpha  0$ 跃迁到激发态（状态 1）。从激发态（状态 1）开始，存储单元既可以以速率 $\\beta  0$ 弛豫回基态，也可以以速率 $\\gamma  0$ 隧穿到损坏态（状态 2）。不存在其他可能的跃迁。\n\n存储单元在时间 $t=0$ 时被初始化于基态（状态 0）。该单元的可靠性与其在失效前保持功能的时间长度有关。设 $T$ 是从初始基态到达损坏态的首达时间的随机变量。\n\n推导该首达时间 $T$ 的概率密度函数的拉普拉斯变换表达式。请用变量 $s$ 和正常数速率 $\\alpha$、$\\beta$ 和 $\\gamma$ 来表示你的答案。", "solution": "设 $X(t)$ 为系统在时间 $t$ 的状态。该系统是一个状态空间为 $S = \\{0, 1, 2\\}$ 的连续时间马尔可夫链。问题要求计算系统从状态 0 开始，到达状态 2 的首达时间的概率密度函数的拉普拉斯变换。设 $T_{iJ}$ 为从状态 $i$ 到目标状态集 $J$ 的首达时间。我们关心的是 $T_{02}$，因此起始状态是 $i=0$，目标状态集是 $J=\\{2\\}$。\n\n设 $\\phi_i(s) = E[\\exp(-s T_{iJ}) | X(0)=i]$ 为从状态 $i$ 到状态集 $J$ 的首达时间的概率密度函数的拉普拉斯变换。我们的目标是针对目标集 $J=\\{2\\}$ 求出 $\\phi_0(s)$。\n\n我们可以通过考虑过程在无穷小时间间隔 $\\delta t$ 内的行为来推导关于 $\\phi_i(s)$ 的方程组。对于任何不属于 $J$ 的状态 $i$，我们以过程的第一步为条件。\n在一个微小的时间间隔 $\\delta t$ 内，从状态 $i$ 开始的系统，要么以概率 $q_{ij}\\delta t + o(\\delta t)$ 跃迁到另一状态 $j \\neq i$，要么以概率 $1 - q_i \\delta t + o(\\delta t)$ 停留在状态 $i$，其中 $q_{ij}$ 是从 $i$ 到 $j$ 的转移速率，而 $q_i = \\sum_{j \\neq i} q_{ij}$ 是离开状态 $i$ 的总速率。\n\n根据全期望定律和马尔可夫链的无记忆性：\n$$ \\phi_i(s) = E[\\exp(-s T_{iJ})] = (1 - q_i \\delta t) E[\\exp(-s(\\delta t + T_{iJ}))] + \\sum_{j \\neq i} (q_{ij}\\delta t) E[\\exp(-s(\\delta t + T_{jJ}))] + o(\\delta t) $$\n使用近似 $\\exp(-s\\delta t) \\approx 1-s\\delta t$ 以及增量与未来演化过程的独立性，上式变为：\n$$ \\phi_i(s) \\approx (1 - q_i \\delta t)(1 - s \\delta t) \\phi_i(s) + \\sum_{j \\neq i} (q_{ij}\\delta t)(1 - s \\delta t) \\phi_j(s) $$\n将此式展开，并只保留 $\\delta t$ 的一阶项：\n$$ \\phi_i(s) \\approx (1 - (q_i+s)\\delta t) \\phi_i(s) + \\sum_{j \\neq i} (q_{ij}\\delta t) \\phi_j(s) $$\n整理各项可得：\n$$ (q_i+s)\\delta t \\phi_i(s) \\approx \\sum_{j \\neq i} (q_{ij}\\delta t) \\phi_j(s) $$\n两边同除以 $\\delta t$ 并令 $\\delta t \\to 0$ 取极限，我们得到对于 $i \\notin J$ 的方程组：\n$$ (s + q_i) \\phi_i(s) = \\sum_{j \\neq i} q_{ij} \\phi_j(s) $$\n对于任何状态 $k \\in J$，根据定义，其首达时间 $T_{kJ}$ 为零。因此，我们有边界条件：\n$$ \\phi_k(s) = E[\\exp(-s \\cdot 0)] = 1 \\quad \\text{for } k \\in J $$\n现在，我们将这个框架应用于我们的具体问题。\n状态为 $\\{0, 1, 2\\}$。起始状态是 $i=0$，目标集是 $J=\\{2\\}$。\n非零的转移速率为 $q_{01} = \\alpha$，$q_{10} = \\beta$ 和 $q_{12} = \\gamma$。\n对于非目标状态，其总离开速率为 $q_0 = q_{01} = \\alpha$ 和 $q_1 = q_{10} + q_{12} = \\beta + \\gamma$。\n\n我们需要求解 $\\phi_0(s)$ 和 $\\phi_1(s)$。边界条件是 $\\phi_2(s) = 1$。\n\n对于状态 $i=0$（不在 $J$ 中）：\n$$ (s + q_0)\\phi_0(s) = q_{01}\\phi_1(s) + q_{02}\\phi_2(s) $$\n由于 $q_{02}=0$，上式简化为：\n$$ (s + \\alpha)\\phi_0(s) = \\alpha\\phi_1(s) \\quad (1) $$\n\n对于状态 $i=1$（不在 $J$ 中）：\n$$ (s + q_1)\\phi_1(s) = q_{10}\\phi_0(s) + q_{12}\\phi_2(s) $$\n代入各速率值和边界条件 $\\phi_2(s)=1$：\n$$ (s + \\beta + \\gamma)\\phi_1(s) = \\beta\\phi_0(s) + \\gamma \\cdot 1 \\quad (2) $$\n我们得到了一个关于 $\\phi_0(s)$ 和 $\\phi_1(s)$ 的二元线性方程组。我们想要求解 $\\phi_0(s)$。\n从方程 (1) 中，我们将 $\\phi_1(s)$ 用 $\\phi_0(s)$ 表示：\n$$ \\phi_1(s) = \\frac{s+\\alpha}{\\alpha}\\phi_0(s) $$\n现在，将此表达式代入方程 (2)：\n$$ (s + \\beta + \\gamma)\\left(\\frac{s+\\alpha}{\\alpha}\\phi_0(s)\\right) = \\beta\\phi_0(s) + \\gamma $$\n我们来求解 $\\phi_0(s)$。首先，将含有 $\\phi_0(s)$ 的项组合在一起：\n$$ \\left[ \\frac{(s + \\beta + \\gamma)(s+\\alpha)}{\\alpha} - \\beta \\right] \\phi_0(s) = \\gamma $$\n为括号内的项通分：\n$$ \\left[ \\frac{s^2 + \\alpha s + (\\beta+\\gamma)s + \\alpha(\\beta+\\gamma) - \\alpha\\beta}{\\alpha} \\right] \\phi_0(s) = \\gamma $$\n$$ \\left[ \\frac{s^2 + s(\\alpha+\\beta+\\gamma) + \\alpha\\beta + \\alpha\\gamma - \\alpha\\beta}{\\alpha} \\right] \\phi_0(s) = \\gamma $$\n$$ \\left[ \\frac{s^2 + s(\\alpha+\\beta+\\gamma) + \\alpha\\gamma}{\\alpha} \\right] \\phi_0(s) = \\gamma $$\n最后，分离出 $\\phi_0(s)$：\n$$ \\phi_0(s) = \\frac{\\alpha\\gamma}{s^2 + s(\\alpha+\\beta+\\gamma) + \\alpha\\gamma} $$\n这就是所求的首达时间概率密度函数的拉普拉斯变换。", "answer": "$$\\boxed{\\frac{\\alpha \\gamma}{s^{2} + s(\\alpha + \\beta + \\gamma) + \\alpha \\gamma}}$$", "id": "1399808"}]}