{"hands_on_practices": [{"introduction": "泊松过程稀疏化最关键的特性之一是，它会将一个事件流分解为多个*独立*的泊松过程。这个练习通过一个直观的足球比赛场景，让我们亲手验证这一核心概念。我们将看到，即使我们知道主队进了多少球，这对于我们推断客队进了多少球也毫无帮助，这直接证明了稀疏化后各个子过程的独立性。[@problem_id:1407548]", "problem": "在一个主要的足球联赛中，分析表明进球遵循泊松过程，平均速率为每分钟 $\\lambda$ 个进球。对于任何一个进球，其由指定主队射入的概率为 $p$，且与其他所有进球独立。考虑一场标准时长的比赛，时间为 $T$ 分钟。在一场特定的比赛中，观察到主队正好射入了 $k$ 个球。在同一场比赛中，客队正好射入 $j$ 个球的概率是多少？\n\n请针对 $\\lambda = 0.025$ 个进球/分钟，$p = 0.6$，$T = 90$ 分钟，$k=2$ 和 $j=2$ 的具体情况提供答案。将最终答案四舍五入到四位有效数字。", "solution": "设 $N$ 为时间 $T$ 内的总进球数。由于进球遵循速率为 $\\lambda$ 的泊松过程，我们有 $N \\sim \\text{Poisson}(\\lambda T)$。每个进球被标记为主队进球的概率为 $p$，被标记为客队进球的概率为 $1-p$，且与其他所有进球相互独立。\n\n根据泊松过程的稀疏化性质，主队进球数 $N_{H}$ 和客队进球数 $N_{A}$ 是独立的泊松随机变量，其参数分别为\n$$\nN_{H} \\sim \\text{Poisson}(\\lambda p T), \\quad N_{A} \\sim \\text{Poisson}(\\lambda (1-p) T).\n$$\n因此，$N_{A}$ 与 $N_{H}$ 独立，所以\n$$\n\\mathbb{P}(N_{A}=j \\mid N_{H}=k) = \\mathbb{P}(N_{A}=j) = \\exp\\!\\big(-\\lambda(1-p)T\\big)\\,\\frac{\\big(\\lambda(1-p)T\\big)^{j}}{j!}.\n$$\n\n对于给定的值 $\\lambda=0.025$，$p=0.6$，$T=90$，$j=2$，$k=2$，计算客队进球的平均值\n$$\n\\mu_{A}=\\lambda(1-p)T=0.025 \\times 0.4 \\times 90=0.9.\n$$\n因此\n$$\n\\mathbb{P}(N_{A}=2 \\mid N_{H}=2)=\\exp(-0.9)\\,\\frac{0.9^{2}}{2!}.\n$$\n进行数值计算：\n$$\n0.9^{2}=0.81,\\quad \\frac{0.81}{2}=0.405,\\quad \\exp(-0.9)\\cdot 0.405 \\approx 0.164660712\\ldots\n$$\n四舍五入到四位有效数字得到 $0.1647$。", "answer": "$$\\boxed{0.1647}$$", "id": "1407548"}, {"introduction": "除了对事件进行计数，理解事件发生的*时间*间隔也同样重要。这个练习将我们的关注点从“多少个”转移到“多久”，探索稀疏化后泊松过程中事件的等待时间。我们将发现，稀疏化过程完美地继承了原始过程的指数分布特性，并进一步推导出多个事件之间等待时间的分布——爱尔朗分布。[@problem_id:1407550]", "problem": "在一个大规模的数据中心，错误消息由一个服务器集群生成。这些消息根据一个泊松过程到达一个中央日志系统，其平均速率为每小时 $\\lambda$ 条消息。每条错误消息被独立地分类为“关键”的概率为 $p$，或“非关键”的概率为 $1-p$。关键消息的到达会触发自动警报。设 $T_1$ 是第一条关键消息的到达时间，$T_3$ 是第三条关键消息的到达时间，时间以小时为单位，从初始观测点 $t=0$ 开始计算。求第一条和第三条关键消息之间的时间间隔大于指定时长 $\\tau$ 的概率的闭式解析表达式。", "solution": "根据泊松过程的稀疏化性质，将每条消息以概率 $p$ 独立地分类为关键消息，得出关键消息形成一个速率为 $\\mu=\\lambda p$ 的泊松过程。设这个关键过程的到达间隔时间为 $\\{S_{i}\\}_{i\\geq 1}$，其中每个 $S_{i}$ 都是独立同分布的，服从 $S_{i}\\sim \\text{Exp}(\\mu)$。到达时间满足 $T_{1}=S_{1}$，$T_{2}=S_{1}+S_{2}$ 和 $T_{3}=S_{1}+S_{2}+S_{3}$。因此，第一条和第三条关键消息之间的时间间隔是\n$$\nT_{3}-T_{1}=S_{2}+S_{3}.\n$$\n由于 $S_{2}$ 和 $S_{3}$ 是独立的 $\\text{Exp}(\\mu)$ 随机变量，$S:=S_{2}+S_{3}$ 服从形状参数为 $2$、速率为 $\\mu$ 的爱尔朗（伽马）分布。其概率密度函数为\n$$\nf_{S}(s)=\\mu^{2}s\\,\\exp(-\\mu s), \\quad s\\geq 0.\n$$\n我们需要计算 $P(T_{3}-T_{1}\\tau)=P(S\\tau)$，其中 $\\tau\\geq 0$。计算生存函数：\n$$\nP(S\\tau)=\\int_{\\tau}^{\\infty}\\mu^{2}s\\,\\exp(-\\mu s)\\,ds.\n$$\n使用分部积分法计算该积分。设 $I=\\int_{\\tau}^{\\infty}s\\,\\exp(-\\mu s)\\,ds$。取 $u=s$ 和 $dv=\\exp(-\\mu s)\\,ds$，则 $du=ds$ 且 $v=-(1/\\mu)\\exp(-\\mu s)$。那么\n$$\nI=\\left[-\\frac{s}{\\mu}\\exp(-\\mu s)\\right]_{\\tau}^{\\infty}+\\int_{\\tau}^{\\infty}\\frac{1}{\\mu}\\exp(-\\mu s)\\,ds\n=\\frac{\\tau}{\\mu}\\exp(-\\mu \\tau)+\\frac{1}{\\mu^{2}}\\exp(-\\mu \\tau).\n$$\n因此，\n$$\nP(S\\tau)=\\mu^{2}I=\\exp(-\\mu \\tau)\\left(1+\\mu \\tau\\right).\n$$\n代入 $\\mu=\\lambda p$ 得到所需的概率：\n$$\nP(T_{3}-T_{1}\\tau)=\\exp(-\\lambda p\\,\\tau)\\left(1+\\lambda p\\,\\tau\\right).\n$$\n对于 $\\tau  0$，概率为 $1$，但上述表达式适用于 $\\tau\\geq 0$ (这是我们关心的关于时间间隔的情况)。", "answer": "$$\\boxed{\\exp\\!\\left(-\\lambda p\\,\\tau\\right)\\left(1+\\lambda p\\,\\tau\\right)}$$", "id": "1407550"}, {"introduction": "这个练习为我们架起了一座从理论通往实践的桥梁。在许多科学实验中，我们能观测到的往往只是真实过程经过“稀疏化”之后的结果，例如并非每个粒子都能被探测器捕捉到。这个问题展示了稀疏化模型如何成为一个强大的统计推断工具，让我们能够根据不完整的观测数据，来估计背后那个无法直接观测的原始过程的真实速率。[@problem_id:1407560]", "problem": "一组天体物理学家正在一个深地实验室进行一项实验，以探测被称为弱相互作用大质量粒子（WIMP）的假想粒子，WIMP是宇宙暗物质的候选者。理论模型预测，WIMP以一个恒定但未知的平均速率 $\\lambda$（单位时间内粒子数）通过探测器位置，其过程服从泊松过程。\n\n探测器本身并非完全有效。一个穿过探测器的WIMP会发生相互作用并产生可探测信号的概率是一个已知常数 $p$。每个WIMP的探测都是一个独立事件。如果一个WIMP没有发生相互作用，它将未经探测地穿过。\n\n在持续时间为 $T$ 的连续观测期内，实验共记录到 $n$ 次相互作用事件。基于这一单一实验结果，确定真实WIMP到达速率 $\\lambda$ 的最可能值。请将答案表示为一个关于观测计数 $n$、观测时间 $T$ 和探测概率 $p$ 的公式。", "solution": "WIMP的到达过程被建模为速率为 $\\lambda$ 的泊松过程。每个到达的WIMP被探测到的概率为 $p$，且探测事件相互独立。根据泊松过程的稀疏化性质，被探测到的事件构成一个速率为 $p \\lambda$ 的泊松过程。因此，在观测时间 $T$ 内，总探测计数 $N$ 服从均值为 $p \\lambda T$ 的泊松分布：\n$$\nN \\sim \\text{Poisson}(p \\lambda T).\n$$\n给定观测计数为 $n$，$\\lambda$ 的似然函数为\n$$\nL(\\lambda \\mid n) = \\mathbb{P}(N=n \\mid \\lambda) = \\frac{\\exp(-p \\lambda T)\\,(p \\lambda T)^{n}}{n!}.\n$$\n对数似然函数为\n$$\n\\ell(\\lambda) = \\ln L(\\lambda \\mid n) = -p \\lambda T + n \\ln(p \\lambda T) - \\ln(n!) = -p \\lambda T + n \\ln \\lambda + n \\ln p + n \\ln T - \\ln(n!).\n$$\n对 $\\lambda$ 求导并令其为零，得到得分方程\n$$\n\\frac{d\\ell}{d\\lambda} = -p T + \\frac{n}{\\lambda} = 0 \\quad \\Longrightarrow \\quad \\hat{\\lambda} = \\frac{n}{p T}.\n$$\n为验证这是一个最大值，计算二阶导数：\n$$\n\\frac{d^{2}\\ell}{d\\lambda^{2}} = -\\frac{n}{\\lambda^{2}} \\le 0 \\quad \\text{for } \\lambda  0,\n$$\n因此该解确实是最大值点。当 $n=0$ 时，对数似然函数关于 $\\lambda$ 严格递减，在 $\\lambda \\ge 0$ 上的最大值出现在 $\\lambda=0$ 处，这与 $\\hat{\\lambda} = \\frac{n}{p T}$ 的结果一致。\n\n因此，真实WIMP到达速率的最大似然估计量为 $\\hat{\\lambda} = \\frac{n}{p T}$。", "answer": "$$\\boxed{\\frac{n}{p T}}$$", "id": "1407560"}]}