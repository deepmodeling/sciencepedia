{"hands_on_practices": [{"introduction": "让我们从一个土地测量的具体例子开始。这个问题 [@problem_id:1403192] 展示了如何使用多元 Delta 方法来估计一个非直接测量量——直角地块斜边长度——的估计量的方差。通过这个练习，你将学会如何将核心公式应用于两个相关随机变量的非线性函数。", "problem": "一家土地测量公司正在分析一大批矩形地块。对于每块地，都测量其两条垂直边 $X$ 和 $Y$ 的长度。这些测量值可以被视为具有以下总体参数的随机变量的结果：\n- 边 $X$ 的平均长度：$\\mu_X = 120$ 米\n- 边 $Y$ 的平均长度：$\\mu_Y = 50$ 米\n- $X$ 的方差：$\\sigma_X^2 = 25 \\text{ m}^2$\n- $Y$ 的方差：$\\sigma_Y^2 = 16 \\text{ m}^2$\n- $X$ 和 $Y$ 之间的协方差：$\\sigma_{XY} = 10 \\text{ m}^2$\n\n对于一个包含 $n$ 个地块的大随机样本，该公司使用样本均值 $\\bar{X}_n$ 和 $\\bar{Y}_n$ 代入公式 $H_n = \\sqrt{\\bar{X}_n^2 + \\bar{Y}_n^2}$ 来估计斜边的平均长度。对于足够大的样本量 $n$，该估计量 $H_n$ 的抽样分布可以由一个正态分布近似，其方差形式为 $V/n$。\n\n计算 $V$ 的值。答案以平方米（$\\text{m}^2$）为单位，并四舍五入到三位有效数字。", "solution": "设 $(\\bar{X}_{n},\\bar{Y}_{n})$ 是来自 $(X,Y)$ 的 $n$ 个独立同分布 (i.i.d.) 观测值的样本均值，其均值为 $\\mu_{X},\\mu_{Y}$，方差为 $\\sigma_{X}^{2},\\sigma_{Y}^{2}$，协方差为 $\\sigma_{XY}$。根据多元中心极限定理，\n$$(\\bar{X}_{n},\\bar{Y}_{n}) \\overset{\\text{approx}}{\\sim} \\mathcal{N}\\!\\left(\\begin{pmatrix}\\mu_{X} \\\\ \\mu_{Y}\\end{pmatrix}, \\frac{1}{n}\\,\\Sigma\\right), \\quad \\Sigma=\\begin{pmatrix}\\sigma_{X}^{2}  \\sigma_{XY} \\\\ \\sigma_{XY}  \\sigma_{Y}^{2}\\end{pmatrix}.$$\n定义 $g(x,y)=\\sqrt{x^{2}+y^{2}}$。则 $H_{n}=g(\\bar{X}_{n},\\bar{Y}_{n})$。对于大的 $n$，根据德尔塔方法 (delta method)，$H_{n}$ 的渐近方差为\n$$\\operatorname{Var}(H_{n}) \\approx \\frac{1}{n}\\,\\nabla g(\\mu)^{\\top}\\Sigma\\,\\nabla g(\\mu), \\quad \\mu=\\begin{pmatrix}\\mu_{X}\\\\ \\mu_{Y}\\end{pmatrix}.$$\n计算梯度：\n$$\\nabla g(x,y)=\\begin{pmatrix}\\frac{\\partial g}{\\partial x}\\\\ \\frac{\\partial g}{\\partial y}\\end{pmatrix}=\\begin{pmatrix}\\frac{x}{\\sqrt{x^{2}+y^{2}}}\\\\ \\frac{y}{\\sqrt{x^{2}+y^{2}}}\\end{pmatrix}, \\quad \\Rightarrow \\quad \\nabla g(\\mu)=\\frac{1}{\\sqrt{\\mu_{X}^{2}+\\mu_{Y}^{2}}}\\begin{pmatrix}\\mu_{X}\\\\ \\mu_{Y}\\end{pmatrix}.$$\n因此，\n$$V=\\nabla g(\\mu)^{\\top}\\Sigma\\,\\nabla g(\\mu)=\\frac{1}{\\mu_{X}^{2}+\\mu_{Y}^{2}}\\left(\\mu_{X}^{2}\\sigma_{X}^{2}+2\\mu_{X}\\mu_{Y}\\sigma_{XY}+\\mu_{Y}^{2}\\sigma_{Y}^{2}\\right).$$\n代入给定值 $\\mu_{X}=120$, $\\mu_{Y}=50$, $\\sigma_{X}^{2}=25$, $\\sigma_{Y}^{2}=16$, $\\sigma_{XY}=10$：\n$$\\mu_{X}^{2}+\\mu_{Y}^{2}=120^{2}+50^{2}=14400+2500=16900,$$\n$$\\mu_{X}^{2}\\sigma_{X}^{2}=120^{2}\\cdot 25=360000,\\quad 2\\mu_{X}\\mu_{Y}\\sigma_{XY}=2\\cdot 120\\cdot 50\\cdot 10=120000,\\quad \\mu_{Y}^{2}\\sigma_{Y}^{2}=50^{2}\\cdot 16=40000,$$\n$$\\Rightarrow \\quad \\mu_{X}^{2}\\sigma_{X}^{2}+2\\mu_{X}\\mu_{Y}\\sigma_{XY}+\\mu_{Y}^{2}\\sigma_{Y}^{2}=360000+120000+40000=520000.$$\n因此，\n$$V=\\frac{520000}{16900}=\\frac{5200}{169}=\\frac{400}{13}\\approx 30.7692308.$$\n四舍五入到三位有效数字，得到 $V=30.8$。", "answer": "$$\\boxed{30.8}$$", "id": "1403192"}, {"introduction": "在上一个例子的基础上，这个练习 [@problem_id:1403188] 将复杂性提升到三个变量。你将推导一个梯形面积估计量的渐近方差的通用符号公式。这个实践将加深你对 Delta 方法结构的理解，以及它在处理多个样本均值的函数形式的估计量时的应用。", "problem": "一家大地测量公司正在评估一大片被划分为许多梯形地块的土地。对每个地块，都进行三项测量：两条平行边的长度 $a$ 和 $b$，以及高 $h$。随机抽取一个包含 $n$ 个地块的样本，得到观测值 $(a_i, b_i, h_i)$，其中 $i=1, \\dots, n$。假设这些观测值是从一个总体中抽取的独立同分布样本，该总体的均值向量为\n$$\n\\mu = \\begin{pmatrix} \\mu_a \\\\ \\mu_b \\\\ \\mu_h \\end{pmatrix}\n$$\n以及协方差矩阵为\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_a^2  \\sigma_{ab}  \\sigma_{ah} \\\\\n\\sigma_{ab}  \\sigma_b^2  \\sigma_{bh} \\\\\n\\sigma_{ah}  \\sigma_{bh}  \\sigma_h^2\n\\end{pmatrix}\n$$\n总体中地块的平均面积为 $A = \\frac{1}{2}(\\mu_a + \\mu_b)\\mu_h$。使用样本均值 $\\bar{a}_n = \\frac{1}{n}\\sum a_i$、$\\bar{b}_n = \\frac{1}{n}\\sum b_i$ 和 $\\bar{h}_n = \\frac{1}{n}\\sum h_i$ 构建该平均面积的一个估计量，如下所示：\n$$\n\\hat{A}_n = \\frac{1}{2}(\\bar{a}_n + \\bar{b}_n)\\bar{h}_n\n$$\n根据统计理论，已知该估计量的分布是渐近正态的。具体来说，$\\sqrt{n}(\\hat{A}_n - A)$ 依分布收敛于一个均值为 0、渐近方差为 $V$ 的正态分布。\n\n请用参数 $\\mu_a, \\mu_b, \\mu_h, \\sigma_a^2, \\sigma_b^2, \\sigma_h^2, \\sigma_{ab}, \\sigma_{ah}$ 和 $\\sigma_{bh}$ 来表示渐近方差 $V$ 的表达式。", "solution": "令 $X_{i} = \\begin{pmatrix} a_{i} \\\\ b_{i} \\\\ h_{i} \\end{pmatrix}$，其均值为 $\\mu = \\begin{pmatrix} \\mu_{a} \\\\ \\mu_{b} \\\\ \\mu_{h} \\end{pmatrix}$，协方差为 $\\Sigma$。样本均值为 $\\bar{X}_{n} = \\begin{pmatrix} \\bar{a}_{n} \\\\ \\bar{b}_{n} \\\\ \\bar{h}_{n} \\end{pmatrix}$。根据多元中心极限定理，\n$$\n\\sqrt{n}\\left(\\bar{X}_{n} - \\mu\\right) \\xrightarrow{d} \\mathcal{N}(0,\\Sigma).\n$$\n定义光滑函数 $g:\\mathbb{R}^{3}\\to\\mathbb{R}$ 为 $g(a,b,h) = \\frac{1}{2}(a+b)h$。估计量为 $\\hat{A}_{n} = g(\\bar{X}_{n})$，目标值为 $A = g(\\mu)$。根据Delta方法，\n$$\n\\sqrt{n}\\left(g(\\bar{X}_{n}) - g(\\mu)\\right) \\xrightarrow{d} \\mathcal{N}\\left(0,\\, \\nabla g(\\mu)^{\\top}\\Sigma\\,\\nabla g(\\mu)\\right).\n$$\n计算 $g$ 的梯度：\n$$\n\\frac{\\partial g}{\\partial a} = \\frac{1}{2}h,\\quad \\frac{\\partial g}{\\partial b} = \\frac{1}{2}h,\\quad \\frac{\\partial g}{\\partial h} = \\frac{1}{2}(a+b).\n$$\n在 $\\mu$ 处求值，可得\n$$\n\\nabla g(\\mu) = \\begin{pmatrix} \\frac{1}{2}\\mu_{h} \\\\ \\frac{1}{2}\\mu_{h} \\\\ \\frac{1}{2}(\\mu_{a}+\\mu_{b}) \\end{pmatrix}.\n$$\n令 $v_{a} = \\frac{1}{2}\\mu_{h}$，$v_{b} = \\frac{1}{2}\\mu_{h}$，以及 $v_{h} = \\frac{1}{2}(\\mu_{a}+\\mu_{b})$。当 $\\Sigma$ 的对角线元素为 $\\sigma_{a}^{2}, \\sigma_{b}^{2}, \\sigma_{h}^{2}$，非对角线元素为 $\\sigma_{ab}, \\sigma_{ah}, \\sigma_{bh}$ 时，渐近方差为\n$$\nV = \\nabla g(\\mu)^{\\top}\\Sigma\\,\\nabla g(\\mu) = v_{a}^{2}\\sigma_{a}^{2} + v_{b}^{2}\\sigma_{b}^{2} + v_{h}^{2}\\sigma_{h}^{2} + 2v_{a}v_{b}\\sigma_{ab} + 2v_{a}v_{h}\\sigma_{ah} + 2v_{b}v_{h}\\sigma_{bh}.\n$$\n代入 $v_{a}, v_{b}, v_{h}$ 可得\n$$\nV = \\frac{1}{4}\\mu_{h}^{2}(\\sigma_{a}^{2} + \\sigma_{b}^{2}) + \\frac{1}{4}(\\mu_{a}+\\mu_{b})^{2}\\sigma_{h}^{2} + \\frac{1}{2}\\mu_{h}^{2}\\sigma_{ab} + \\frac{1}{2}\\mu_{h}(\\mu_{a}+\\mu_{b})\\sigma_{ah} + \\frac{1}{2}\\mu_{h}(\\mu_{a}+\\mu_{b})\\sigma_{bh}.\n$$\n等价地，将各项分组，\n$$\nV = \\frac{1}{4}\\left[\\mu_{h}^{2}(\\sigma_{a}^{2} + 2\\sigma_{ab} + \\sigma_{b}^{2}) + (\\mu_{a}+\\mu_{b})^{2}\\sigma_{h}^{2} + 2\\mu_{h}(\\mu_{a}+\\mu_{b})(\\sigma_{ah} + \\sigma_{bh})\\right].\n$$\n这就是所求的渐近方差。", "answer": "$$\\boxed{\\frac{1}{4}\\left[\\mu_{h}^{2}\\left(\\sigma_{a}^{2}+2\\sigma_{ab}+\\sigma_{b}^{2}\\right)+(\\mu_{a}+\\mu_{b})^{2}\\sigma_{h}^{2}+2\\mu_{h}(\\mu_{a}+\\mu_{b})(\\sigma_{ah}+\\sigma_{bh})\\right]}$$", "id": "1403188"}, {"introduction": "Delta 方法的应用不局限于物理测量，它在社会科学中也是一个强大的工具。这个具有挑战性的问题 [@problem_id:1403193] 将我们带入博弈论的领域，在这里我们将估计纳什均衡中的一个关键参数。这个练习展示了该方法的多功能性，要求你将博弈论的概念与统计近似方法相结合，以分析策略模型结果的不确定性。", "problem": "考虑一个双人策略博弈。玩家1（行玩家）在两种行动——顶（T）和底（B）之间进行选择，而玩家2（列玩家）在两种行动——左（L）和右（R）之间进行选择。该博弈由两个支付矩阵定义。玩家1的支付由矩阵 $U$ 给出，玩家2的支付由矩阵 $V$ 给出：\n$$\nU = \\begin{pmatrix} u_{TL}  u_{TR} \\\\ u_{BL}  u_{BR} \\end{pmatrix}, \\quad V = \\begin{pmatrix} v_{TL}  v_{TR} \\\\ v_{BL}  v_{BR} \\end{pmatrix}\n$$\n这些矩阵中的元素，如 $u_{TL}$，表示当选择特定的行动组合（顶，左）时，相应玩家的效用（支付）。\n\n八个真实的支付值 $\\{u_{ij}\\}$ 和 $\\{v_{ij}\\}$ 是未知的常数。为了了解这些值，一位分析师进行了一项实验。对于四种结果 $(T, L), (T, R), (B, L), (B, R)$ 中的每一种，分析师收集了 $n$ 个关于玩家2支付的独立测量值。我们将支付 $v_{ij}$ 的单个测量值的方差记为 $\\sigma^2_{v,ij}$，其中 $i \\in \\{T, B\\}$ 且 $j \\in \\{L, R\\}$。这 $n$ 个测量值的样本均值被用作真实支付的估计量，记为 $\\hat{v}_{ij}$。这四组样本（每组对应玩家2的一个支付）相互独立。对玩家1的支付也遵循类似的过程，但这与本问题没有直接关系。\n\n假设支付的真实值使得该博弈存在一个唯一的纳什均衡，在该均衡中，双方玩家都使用混合策略。设 $p$ 为玩家1选择行动T的均衡概率，$q$ 为玩家2选择行动L的均衡概率。玩家1均衡概率的估计量，记为 $\\hat{p}$，是通过将估计的支付 $\\hat{v}_{ij}$ 代入 $p$ 的理论公式来计算的。\n\n你的任务是确定该估计量的缩放渐近方差。求极限 $A = \\lim_{n\\to\\infty} n \\cdot \\text{Var}(\\hat{p})$ 的值。你的最终答案应该是一个用真实支付 $v_{ij}$ 和基础测量方差 $\\sigma^2_{v,ij}$ 表示的符号表达式。", "solution": "在一个唯一的内部混合纳什均衡中，当玩家1以概率 $p$ 选择行动T时，玩家2对行动L和R无差异。无差异条件要求\n$$\np v_{TL} + (1-p) v_{BL} = p v_{TR} + (1-p) v_{BR}.\n$$\n整理得，\n$$\np\\left(v_{TL}-v_{TR}-v_{BL}+v_{BR}\\right) + \\left(v_{BL}-v_{BR}\\right) = 0,\n$$\n因此，当 $D \\equiv v_{TL}-v_{TR}-v_{BL}+v_{BR} \\neq 0$ 且 $N \\equiv v_{BR}-v_{BL}$ 时，\n$$\np = \\frac{v_{BR}-v_{BL}}{v_{TL}-v_{TR}-v_{BL}+v_{BR}} = \\frac{N}{D}.\n$$\n\n估计量 $\\hat{p}$ 是通过将样本均值 $\\hat{v}_{ij}$ 代入 $g(v) \\equiv N/D$ 得到的。对于每个结果 $(i,j)$，$\\hat{v}_{ij}$ 是 $n$ 个独立同分布观测值的均值，其方差为 $\\sigma^{2}_{v,ij}$，因此\n$$\n\\operatorname{Var}(\\hat{v}_{ij}) = \\frac{\\sigma^{2}_{v,ij}}{n},\n$$\n并且这四个 $\\hat{v}_{ij}$ 是相互独立的。根据多元中心极限定理，$\\sqrt{n}\\left(\\hat{\\mathbf{v}}-\\mathbf{v}\\right) \\xrightarrow{d} \\mathcal{N}\\left(0,\\Sigma\\right)$，其中 $\\Sigma=\\operatorname{diag}\\left(\\sigma^{2}_{v,TL},\\sigma^{2}_{v,TR},\\sigma^{2}_{v,BL},\\sigma^{2}_{v,BR}\\right)$。根据德尔塔方法，\n$$\nA \\equiv \\lim_{n\\to\\infty} n \\cdot \\operatorname{Var}(\\hat{p}) = \\nabla g(\\mathbf{v})^{\\top}\\,\\Sigma\\,\\nabla g(\\mathbf{v}).\n$$\n\n计算 $g=N/D$ 关于 $(v_{TL},v_{TR},v_{BL},v_{BR})$ 的梯度。使用商法则以及偏导数 $N_{TL}=0$, $N_{TR}=0$, $N_{BL}=-1$, $N_{BR}=1$ 和 $D_{TL}=1$, $D_{TR}=-1$, $D_{BL}=-1$, $D_{BR}=1$，我们得到\n$$\n\\frac{\\partial g}{\\partial v_{TL}} = -\\frac{N}{D^{2}} = \\frac{v_{BL}-v_{BR}}{D^{2}},\\quad\n\\frac{\\partial g}{\\partial v_{TR}} = \\frac{N}{D^{2}} = \\frac{v_{BR}-v_{BL}}{D^{2}},\n$$\n$$\n\\frac{\\partial g}{\\partial v_{BL}} = \\frac{-D+N}{D^{2}} = -\\frac{v_{TL}-v_{TR}}{D^{2}},\\quad\n\\frac{\\partial g}{\\partial v_{BR}} = \\frac{D-N}{D^{2}} = \\frac{v_{TL}-v_{TR}}{D^{2}}.\n$$\n因此，\n$$\nA = \\left(\\frac{v_{BL}-v_{BR}}{D^{2}}\\right)^{2}\\sigma^{2}_{v,TL} + \\left(\\frac{v_{BR}-v_{BL}}{D^{2}}\\right)^{2}\\sigma^{2}_{v,TR} + \\left(\\frac{v_{TL}-v_{TR}}{D^{2}}\\right)^{2}\\sigma^{2}_{v,BL} + \\left(\\frac{v_{TL}-v_{TR}}{D^{2}}\\right)^{2}\\sigma^{2}_{v,BR}.\n$$\n由于 $(v_{BL}-v_{BR})^{2}=(v_{BR}-v_{BL})^{2}$，上式可简化为\n$$\nA = \\frac{(v_{BR}-v_{BL})^{2}\\left(\\sigma^{2}_{v,TL}+\\sigma^{2}_{v,TR}\\right) + (v_{TL}-v_{TR})^{2}\\left(\\sigma^{2}_{v,BL}+\\sigma^{2}_{v,BR}\\right)}{\\left(v_{TL}-v_{TR}-v_{BL}+v_{BR}\\right)^{4}}.\n$$\n这就是所求的缩放渐近方差，用真实支付 $v_{ij}$ 和测量方差 $\\sigma^{2}_{v,ij}$ 表示。", "answer": "$$\\boxed{\\frac{(v_{BR}-v_{BL})^{2}\\left(\\sigma^{2}_{v,TL}+\\sigma^{2}_{v,TR}\\right) + (v_{TL}-v_{TR})^{2}\\left(\\sigma^{2}_{v,BL}+\\sigma^{2}_{v,BR}\\right)}{\\left(v_{TL}-v_{TR}-v_{BL}+v_{BR}\\right)^{4}}}$$", "id": "1403193"}]}