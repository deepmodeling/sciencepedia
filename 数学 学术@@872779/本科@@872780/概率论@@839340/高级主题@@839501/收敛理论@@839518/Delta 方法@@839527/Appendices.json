{"hands_on_practices": [{"introduction": "德尔塔方法是推断估计量函数近似分布的强大工具。第一个练习提供了一个具体的起点，它处理了如何从泊松分布数据中估计“零事件”概率的问题，这在物理学或生物学等领域很常见。我们的目标是应用标准（一阶）德尔塔方法来找出这个估计的不确定性（即渐近方差），从而为理解该方法的核心机制打下坚实的基础。[@problem_id:1959816]", "problem": "在一个粒子物理实验中，一个探测器对一分钟间隔内发生的罕见宇宙射线事件进行计数。在任何给定的一分钟内探测到的事件数 $X$ 假定服从一个未知均值为 $\\lambda$ 的泊松分布。为了估计在一分钟间隔内观测到零个事件的概率（理论上为 $p_0 = P(X=0) = \\exp(-\\lambda)$），一组物理学家从 $n$ 个独立的一分钟间隔中收集数据。设 $X_1, X_2, \\dots, X_n$ 为记录的计数值。\n\n物理学家们使用估计量 $\\hat{p}_0 = \\exp(-\\bar{X})$，其中 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 是观测计数值的样本均值。对于大量的观测间隔 $n$，该估计量的分布可以由正态分布近似。\n\n确定估计量 $\\hat{p}_0$ 的渐近方差。将你的答案表示为以真实均值 $\\lambda$ 和样本量 $n$ 表示的闭式解析表达式。", "solution": "问题要求解参数 $p_0 = \\exp(-\\lambda)$ 的估计量 $\\hat{p}_0 = \\exp(-\\bar{X})$ 的渐近方差。我们可以使用Delta方法来求解。\n\n首先，我们确定来自泊松($\\lambda$)分布的样本的样本均值 $\\bar{X}$ 的性质。泊松分布的均值为 $E[X_i] = \\lambda$，其方差为 $\\text{Var}(X_i) = \\lambda$。\n\n根据中心极限定理（CLT），对于大样本量 $n$，样本均值 $\\bar{X}$ 的分布近似为正态分布。更正式地说，中心极限定理指出：\n$$\n\\sqrt{n}(\\bar{X} - \\lambda) \\xrightarrow{d} N(0, \\lambda)\n$$\n其中 $\\xrightarrow{d}$ 表示依分布收敛，而 $N(0, \\lambda)$ 是一个均值为0、方差为 $\\lambda$ 的正态分布。这意味着对于大的 $n$，$\\bar{X}$ 近似服从 $N(\\lambda, \\frac{\\lambda}{n})$ 分布。\n\n估计量 $\\hat{p}_0$ 是样本均值 $\\bar{X}$ 的函数。我们可以将其写为 $\\hat{p}_0 = g(\\bar{X})$，其中函数为 $g(x) = \\exp(-x)$。被估计的参数是 $p_0 = \\exp(-\\lambda) = g(\\lambda)$。\n\nDelta方法为一个具有渐近正态分布的统计量的函数提供了其渐近分布。Delta方法的一般形式指出，如果 $\\sqrt{n}(Y_n - \\mu) \\xrightarrow{d} N(0, \\sigma^2)$，那么对于一个在 $g'(\\mu) \\neq 0$ 的可微函数 $g$，我们有：\n$$\n\\sqrt{n}(g(Y_n) - g(\\mu)) \\xrightarrow{d} N(0, [g'(\\mu)]^2 \\sigma^2)\n$$\n在我们的例子中，$Y_n = \\bar{X}$，总体均值为 $\\mu = \\lambda$，总体方差为 $\\sigma^2 = \\lambda$。\n\n我们需要求函数 $g(x) = \\exp(-x)$ 的导数。其导数为：\n$$\ng'(x) = \\frac{d}{dx}\\exp(-x) = -\\exp(-x)\n$$\n接下来，我们在均值 $\\mu = \\lambda$ 处计算该导数的值：\n$$\ng'(\\lambda) = -\\exp(-\\lambda)\n$$\n现在我们可以使用Delta方法的公式来计算 $\\sqrt{n}(g(\\bar{X}) - g(\\lambda))$ 的渐近方差：\n$$\n\\text{Asymptotic Variance}[\\sqrt{n}(\\hat{p}_0 - p_0)] = [g'(\\lambda)]^2 \\text{Var}(X_i) = [-\\exp(-\\lambda)]^2 \\lambda\n$$\n化简此表达式，我们得到：\n$$\n[g'(\\lambda)]^2 \\sigma^2 = (\\exp(-2\\lambda)) \\lambda = \\lambda \\exp(-2\\lambda)\n$$\n这是项 $\\sqrt{n}(\\hat{p}_0 - p_0)$ 的方差。问题要求的是估计量 $\\hat{p}_0$ 本身的渐近方差。如果 $\\sqrt{n}(\\hat{p}_0 - p_0)$ 的方差是 $\\lambda \\exp(-2\\lambda)$，那么对于大的 $n$ 我们可以写出：\n$$\n\\text{Var}(\\hat{p}_0) = \\text{Var}\\left( \\frac{\\sqrt{n}(\\hat{p}_0 - p_0)}{\\sqrt{n}} \\right) = \\frac{1}{n} \\text{Var}(\\sqrt{n}(\\hat{p}_0 - p_0))\n$$\n因此，$\\hat{p}_0$ 的渐近方差为：\n$$\n\\text{Asymptotic Var}(\\hat{p}_0) = \\frac{\\lambda \\exp(-2\\lambda)}{n}\n$$", "answer": "$$\\boxed{\\frac{\\lambda \\exp(-2\\lambda)}{n}}$$", "id": "1959816"}, {"introduction": "当标准的一阶德尔塔方法预测方差为零时，我们该怎么办？这个练习恰好探讨了这种情况。通过研究伯努利试验中真实成功概率为 $1/2$ 时的样本方差，我们发现转换函数的一阶导数恰好为零，这使得一阶德尔塔方法失效。这个实践将引导你使用二阶德尔塔方法，并揭示极限分布并非正态分布，而是与卡方分布相关。这是理解德尔塔方法局限性及其扩展的关键一课。[@problem_id:1959855]", "problem": "在一项关于随机二元过程的研究中，进行了一系列共 $n$ 次的独立试验。每次试验的结果为“成功”（记为 1）或“失败”（记为 0）。已知在任何一次给定的试验中，成功的真实概率恰好为 $p = 1/2$。令 $\\hat{p}_n$ 为在 $n$ 次试验中观测到的成功样本比例。\n\n我们感兴趣的一个统计量是此伯努利过程的样本方差，其表达式为 $\\hat{S}_n^2 = \\hat{p}_n(1-\\hat{p}_n)$。相应的真实方差为 $\\sigma^2 = p(1-p) = 1/4$。我们希望了解这个样本方差估计量的渐近行为。\n\n考虑中心化和尺度变换后的统计量 $T_n = n(\\hat{S}_n^2 - 1/4)$。当 $n \\to \\infty$ 时，下列哪个选项正确描述了 $T_n$ 的极限分布？\n令 $Z$ 表示一个标准正态随机变量，$\\chi^2_1$ 表示一个自由度为 1 的卡方随机变量。\n\nA. 均值为 0、方差为 $1/16$ 的正态分布。\n\nB. 随机变量 $-\\frac{1}{2}\\chi^2_1$ 的分布。\n\nC. 随机变量 $\\frac{1}{4}\\chi^2_1$ 的分布。\n\nD. 随机变量 $-\\frac{1}{4}\\chi^2_1$ 的分布。\n\nE. 随机变量 $-\\chi^2_1$ 的分布。", "solution": "令 $X_{1},\\dots,X_{n}$ 为独立同分布的伯努利随机变量，其参数 $p=\\frac{1}{2}$，并令 $\\hat{p}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。样本方差估计量为 $\\hat{S}_{n}^{2}=\\hat{p}_{n}(1-\\hat{p}_{n})$。真实方差为 $\\sigma^{2}=p(1-p)=\\frac{1}{4}$。\n\n代数上，\n$$\n\\hat{S}_{n}^{2}-\\frac{1}{4}\n=\\hat{p}_{n}(1-\\hat{p}_{n})-\\frac{1}{4}\n=\\hat{p}_{n}-\\hat{p}_{n}^{2}-\\frac{1}{4}\n=-(\\hat{p}_{n}-\\tfrac{1}{2})^{2},\n$$\n因为 $(\\hat{p}_{n}-\\tfrac{1}{2})^{2}=\\hat{p}_{n}^{2}-\\hat{p}_{n}+\\tfrac{1}{4}$。因此，\n$$\nT_{n}=n\\bigl(\\hat{S}_{n}^{2}-\\tfrac{1}{4}\\bigr)\n=-\\,n\\bigl(\\hat{p}_{n}-\\tfrac{1}{2}\\bigr)^{2}\n=-\\bigl(\\sqrt{n}(\\hat{p}_{n}-\\tfrac{1}{2})\\bigr)^{2}.\n$$\n\n根据中心极限定理，\n$$\n\\sqrt{n}\\,(\\hat{p}_{n}-\\tfrac{1}{2})\\;\\xrightarrow{d}\\;Y,\\quad Y\\sim N\\bigl(0,\\tfrac{1}{4}\\bigr).\n$$\n根据连续映射定理，对于连续函数 $g(y)=y^{2}$，我们有\n$$\n\\bigl(\\sqrt{n}(\\hat{p}_{n}-\\tfrac{1}{2})\\bigr)^{2}\\;\\xrightarrow{d}\\;Y^{2}.\n$$\n如果 $Z\\sim N(0,1)$，那么 $Y\\stackrel{d}{=}\\tfrac{1}{2}Z$，因此 $Y^{2}\\stackrel{d}{=}\\tfrac{1}{4}Z^{2}=\\tfrac{1}{4}\\chi^{2}_{1}$。于是，\n$$\nT_{n}\\;\\xrightarrow{d}\\;-\\,Y^{2}\\;\\stackrel{d}{=}\\;-\\frac{1}{4}\\chi^{2}_{1}.\n$$\n与选项比较，此为选项 D。", "answer": "$$\\boxed{D}$$", "id": "1959855"}, {"introduction": "现在，我们将视野从单个估计量扩展到多个估计量的函数。许多重要的统计量，如变异系数，都依赖于不止一个样本矩（例如，同时依赖于样本均值和样本方差）。这个问题演示了如何使用多维德尔塔方法来处理这种情况。通过运用向量和矩阵微积分（梯度和协方差矩阵）来推导渐近方差，这个练习为我们提供了单维方法的强大推广，使我们能解决在真实世界统计分析中更复杂的现实问题。[@problem_id:1396699]", "problem": "设 $X_1, X_2, \\dots, X_n$ 是来自一个指数分布的独立同分布随机变量序列，其未知率参数为 $\\lambda  0$。其概率密度函数为 $f(x) = \\lambda \\exp(-\\lambda x)$（当 $x \\ge 0$ 时）。\n\n设 $\\bar{X}_n = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 为样本均值， $S_n^2 = \\frac{1}{n-1}\\sum_{i=1}^{n} (X_i - \\bar{X}_n)^2$ 为样本方差。样本变异系数定义为比值 $C_n = S_n / \\bar{X}_n$。\n\n根据中心极限定理和Delta方法，可以证明对于某个常数 $c$，$\\sqrt{n}(C_n - c)$ 的分布收敛到一个均值为0、方差为某个值 $V$ 的正态分布。\n\n你的任务是确定这个渐近方差 $V$。为此，首先将样本变异系数表示为前两个样本原点矩 $\\bar{X}_n$ 和 $\\overline{X^2}_n = \\frac{1}{n}\\sum_{i=1}^{n} X_i^2$ 的函数。然后，应用多元Delta方法来求渐近方差。\n\n请以精确数值形式给出最终答案。", "solution": "设 $m_{1}=\\bar{X}_{n}$ 和 $m_{2}=\\overline{X^{2}}_{n}$。无偏样本方差可以写成\n$$\nS_{n}^{2}=\\frac{n}{n-1}\\left(m_{2}-m_{1}^{2}\\right),\n$$\n所以样本变异系数为\n$$\nC_{n}=\\frac{S_{n}}{m_{1}}=\\sqrt{\\frac{n}{n-1}}\\;\\sqrt{\\frac{m_{2}-m_{1}^{2}}{m_{1}^{2}}}=\\sqrt{\\frac{n}{n-1}}\\;h(m_{1},m_{2}),\n$$\n其中\n$$\nh(m_{1},m_{2})=\\sqrt{\\frac{m_{2}}{m_{1}^{2}}-1}.\n$$\n因为 $\\sqrt{n/(n-1)}\\to 1$，这个前置因子不影响渐近方差。因此，我们将多元Delta方法应用于 $h(m_{1},m_{2})$。\n\n对于 $X\\sim \\text{Exp}(\\lambda)$，其原点矩为 $E[X]=\\mu_{1}=1/\\lambda$，$E[X^{2}]=\\mu_{2}=2/\\lambda^{2}$，$E[X^{3}]=6/\\lambda^{3}$，以及 $E[X^{4}]=24/\\lambda^{4}$。因此，对于向量 $(m_{1},m_{2})$，\n$$\n\\sqrt{n}\\Big((m_{1},m_{2})-(\\mu_{1},\\mu_{2})\\Big)\\;\\xrightarrow{d}\\;\\mathcal{N}\\big(0,\\Sigma\\big),\n$$\n其中\n$$\n\\Sigma=\\begin{pmatrix}\n\\operatorname{Var}(X)  \\operatorname{Cov}(X,X^{2})\\\\\n\\operatorname{Cov}(X,X^{2})  \\operatorname{Var}(X^{2})\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{1}{\\lambda^{2}}  \\frac{4}{\\lambda^{3}} \\\\\n\\frac{4}{\\lambda^{3}}  \\frac{20}{\\lambda^{4}}\n\\end{pmatrix}.\n$$\n\n计算 $h$ 的梯度：\n设 $u=m_{2}m_{1}^{-2}-1$，则 $h=u^{1/2}$。那么\n$$\n\\frac{\\partial h}{\\partial m_{1}}=\\frac{1}{2}u^{-1/2}\\left(-\\frac{2m_{2}}{m_{1}^{3}}\\right)=-\\frac{m_{2}}{m_{1}^{3}\\sqrt{u}},\\qquad\n\\frac{\\partial h}{\\partial m_{2}}=\\frac{1}{2}u^{-1/2}\\left(\\frac{1}{m_{1}^{2}}\\right)=\\frac{1}{2m_{1}^{2}\\sqrt{u}}.\n$$\n在 $(\\mu_{1},\\mu_{2})=(\\frac{1}{\\lambda},\\frac{2}{\\lambda^{2}})$ 处，我们有\n$$\nu=\\frac{\\mu_{2}}{\\mu_{1}^{2}}-1=\\frac{2/\\lambda^{2}}{(1/\\lambda)^{2}}-1=2-1=1,\n$$\n所以\n$$\n\\nabla h(\\mu_{1},\\mu_{2})=\\begin{pmatrix}-\\frac{\\mu_{2}}{\\mu_{1}^{3}} \\\\ \\frac{1}{2\\mu_{1}^{2}}\\end{pmatrix}\n=\\begin{pmatrix}-2\\lambda \\\\ \\frac{\\lambda^{2}}{2}\\end{pmatrix}.\n$$\n根据多元Delta方法，\n$$\n\\sqrt{n}\\big(h(m_{1},m_{2})-h(\\mu_{1},\\mu_{2})\\big)\\;\\xrightarrow{d}\\;\\mathcal{N}\\big(0,V\\big),\\quad\nV=\\nabla h(\\mu)^{\\top}\\Sigma\\,\\nabla h(\\mu).\n$$\n计算 $V$：\n$$\nV=\\begin{pmatrix}-2\\lambda  \\frac{\\lambda^{2}}{2}\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{\\lambda^{2}}  \\frac{4}{\\lambda^{3}} \\\\\n\\frac{4}{\\lambda^{3}}  \\frac{20}{\\lambda^{4}}\n\\end{pmatrix}\n\\begin{pmatrix}-2\\lambda \\\\ \\frac{\\lambda^{2}}{2}\\end{pmatrix}.\n$$\n展开得，\n$$\nV=(4\\lambda^{2})\\frac{1}{\\lambda^{2}}+2(-2\\lambda)\\left(\\frac{\\lambda^{2}}{2}\\right)\\frac{4}{\\lambda^{3}}+\\left(\\frac{\\lambda^{2}}{2}\\right)^{2}\\frac{20}{\\lambda^{4}}\n=4-8+5=1.\n$$\n此外，$h(\\mu_{1},\\mu_{2})=\\sqrt{\\frac{2/\\lambda^{2}}{(1/\\lambda)^{2}}-1}=1$，所以 $c=1$。前置因子 $\\sqrt{n/(n-1)}\\to 1$ 不改变渐近方差。因此，渐近方差为\n$$\nV=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1396699"}]}