{"hands_on_practices": [{"introduction": "与任何多元分布函数一样，copula 也有一个相应的密度函数，它描述了变量在单位超立方体中联合出现的相对可能性。从 copula 累积分布函数（CDF）推导出其密度函数（PDF）是一项基本技能，对于理解和应用基于似然的统计方法至关重要。这个练习 [@problem_id:1353902] 将带你完成 Farlie-Gumbel-Morgenstern (FGM) copula 的密度推导，这是一个直接应用多元微积分的经典例子。", "problem": "在统计建模中，copula 是一种多元累积分布函数，其每个变量的边缘概率分布在区间 $[0, 1]$ 上是均匀的。用于建模两个随机变量之间相关性的最简单的 copula 族之一是 Farlie-Gumbel-Morgenstern (FGM) 族。\n\n二元 FGM copula 的累积分布函数由下式给出：\n$$C(u,v) = uv[1+\\alpha(1-u)(1-v)]$$\n其中 $u, v \\in [0, 1]$ 且相关性参数 $\\alpha$ 是一个满足 $|\\alpha| \\le 1$ 的实常数。\n\ncopula 密度函数，记为 $c(u,v)$，描述了特定值对 $(u,v)$ 的相对可能性。求出与 FGM copula 对应的 copula 密度函数 $c(u,v)$ 的解析表达式。", "solution": "copula 密度函数是 copula 分布函数的二阶混合偏导数：\n$$c(u,v)=\\frac{\\partial^{2}}{\\partial u \\partial v}C(u,v).$$\n给定 $C(u,v)=uv\\left[1+\\alpha(1-u)(1-v)\\right]$，首先使用乘法法则计算关于 $u$ 的偏导数：\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]+uv\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right].$$\n内部的导数是\n$$\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right]=\\alpha\\frac{\\partial}{\\partial u}\\left[(1-u)(1-v)\\right]=-\\alpha(1-v).$$\n因此，\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]-\\alpha uv(1-v).$$\n因式分解并化简：\n$$\\frac{\\partial C}{\\partial u}=v+\\alpha v(1-v)(1-2u).$$\n现在对 $v$ 求导：\n$$c(u,v)=\\frac{\\partial}{\\partial v}\\left[v+\\alpha v(1-v)(1-2u)\\right]=1+\\alpha(1-2u)\\frac{\\partial}{\\partial v}\\left[v-v^{2}\\right].$$\n由于 $\\frac{\\partial}{\\partial v}(v-v^{2})=1-2v$，我们得到\n$$c(u,v)=1+\\alpha(1-2u)(1-2v).$$", "answer": "$$\\boxed{1+\\alpha(1-2u)(1-2v)}$$", "id": "1353902"}, {"introduction": "经典的 Pearson 相关系数是衡量两个变量之间线性关系的有力工具，但当依赖关系变得复杂时，它可能会完全失效。本练习通过一个引人深思的例子，展示了两个变量可以完全函数依赖，但其 Pearson 相关系数却为零。通过这个练习 [@problem_id:1353856]，你将直观地理解为什么需要像 copula 这样更通用的工具来描述和量化超越线性的复杂依赖结构。", "problem": "一个随机变量 $X$ 服从区间$[-1, 1]$上的连续均匀分布。第二个随机变量 $Y$ 由关系式 $Y = X^2$ 定义。您的任务是分析 $X$ 和 $Y$ 之间的相依性。\n\n1. 计算皮尔逊相关系数 $\\rho(X, Y)$。\n2. 变量 $X$ 和 $Y$ 是完全相依的，但它们的皮尔逊相关系数可能无法完全捕捉这种关系。完整的相依结构由它们的 copula 描述。请确定以下哪个描述最能刻画连接 $X$ 和 $Y$ 的 copula。\n\nA. 该 copula 代表完全正单调相依，其支撑集位于单位正方形的主对角线上。\nB. 该 copula 代表完全负单调相依，其支撑集位于单位正方形的反斜对角线上。\nC. 该 copula 是独立 copula，其概率质量均匀分布在整个单位正方形上。\nD. 该 copula 代表非单调相依，其支撑集集中在单位正方形内的一条 V 形曲线上。\n\n请以数对的形式提供您的答案，该数对由相关系数的数值和正确选项对应的字母组成。", "solution": "设 $X$ 在$[-1,1]$上均匀分布，因此其密度函数为 $f_{X}(x)=\\frac{1}{2}$，$x\\in[-1,1]$。定义 $Y=X^{2}$。皮尔逊相关系数为 $\\rho(X,Y)=\\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Y)}}$。\n\n首先计算必要的矩。由于 $X$ 关于 $0$ 对称，\n$$\n\\mathbb{E}[X]=\\int_{-1}^{1}x\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{2}}{2}\\right]_{-1}^{1}=0.\n$$\n另外，\n$$\n\\mathbb{E}[X^{2}]=\\int_{-1}^{1}x^{2}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{3}-\\left(-\\frac{1}{3}\\right)\\right)=\\frac{1}{3},\n$$\n所以 $\\mathbb{E}[Y]=\\mathbb{E}[X^{2}]=\\frac{1}{3}$。接着，\n$$\n\\mathbb{E}[X^{3}]=\\int_{-1}^{1}x^{3}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{4}}{4}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{4}-\\frac{1}{4}\\right)=0,\n$$\n因此 $\\mathbb{E}[XY]=\\mathbb{E}[X^{3}]=0$。所以，\n$$\n\\operatorname{Cov}(X,Y)=\\mathbb{E}[XY]-\\mathbb{E}[X]\\mathbb{E}[Y]=0-0\\cdot\\frac{1}{3}=0.\n$$\n为求完整，计算方差以确认分母为正。我们有\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{1}{3},\n$$\n以及\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[X^{4}]=\\int_{-1}^{1}x^{4}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{5}}{5}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{5}-\\left(-\\frac{1}{5}\\right)\\right)=\\frac{1}{5},\n$$\n所以\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{1}{5}-\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{5}-\\frac{1}{9}=\\frac{4}{45}>0.\n$$\n因此，\n$$\n\\rho(X,Y)=\\frac{0}{\\sqrt{\\frac{1}{3}\\cdot\\frac{4}{45}}}=0.\n$$\n\n尽管 $Y$ 是 $X$ 的一个确定性函数，并且它们是完全相依的，但这种相依性在$[-1,1]$上是非单调的，所以皮尔逊相关系数为零。为了确定 copula，考虑概率积分变换 $U=F_{X}(X)$ 和 $V=F_{Y}(Y)$。对于 $x\\in[-1,1]$，\n$F_{X}(x)=\\frac{x+1}{2}$，所以 $U=\\frac{X+1}{2}$。\n对于 $y\\in[0,1]$，\n$F_{Y}(y)=\\mathbb{P}(X^{2}\\le y)=\\mathbb{P}(-\\sqrt{y}\\le X\\le \\sqrt{y})=\\int_{-\\sqrt{y}}^{\\sqrt{y}}\\frac{1}{2}\\,dx=\\sqrt{y}$，\n因此\n$V=F_{Y}(Y)=\\sqrt{Y}=\\sqrt{X^{2}}=|X|$。\n通过 $U$ 表达 $X$ 得到 $X=2U-1$，所以这两个均匀分布变量之间的关系是\n$V=|X|=|2U-1|$。\n因此，该 copula 是奇异的，其支撑集集中在单位正方形内的 V 形曲线 $v=|2u-1|$ 上。这是一种非单调相依，对应于选项 D。", "answer": "$$\\boxed{(0, \\text{D})}$$", "id": "1353856"}, {"introduction": "Copula 理论的优雅之处在于它能将抽象的依赖结构与具体的、可解释的统计量联系起来。特别是对于阿基米德 copula 族，我们可以通过其“生成元”函数直接推导出非参数相关性度量，如 Kendall's tau ($\\tau$)。这个练习 [@problem_id:1927387] 将指导你为 Clayton copula 推导 Kendall's tau 与其依赖参数 ($\\theta$) 之间的精确关系，展示了 copula 框架在连接理论模型和实际数据分析中的强大能力。", "problem": "在金融建模和风险管理领域，copula函数用于描述随机变量之间的相关性。Archimedean copula族是一类重要的copula函数，它由一个称为生成元的函数构造而成。\n\n对于一个相关性结构由生成元为$\\phi(t)$的Archimedean copula描述的连续二元分布，其总体版本的Kendall秩相关系数（记为$\\tau$）可以直接通过生成元使用以下公式计算：\n$$\n\\tau = 1 + 4 \\int_{0}^{1} \\frac{\\phi(t)}{\\phi'(t)} dt\n$$\n其中 $\\phi'(t)$ 是 $\\phi(t)$ 关于 $t$ 的一阶导数。\n\n考虑Clayton copula族，它是一种特定类型的Archimedean copula。Clayton族的生成元由下式给出：\n$$\n\\phi(t) = \\frac{1}{\\theta} (t^{-\\theta} - 1)\n$$\n其中 $\\theta > 0$ 是一个控制相关性强度的参数。$\\theta$ 的值越大，意味着正相关性越强。\n\n你的任务是为Clayton copula族推导Kendall's tau ($\\tau$) 作为参数 $\\theta$ 的函数的闭式解析表达式。", "solution": "我们使用用于计算Kendall's tau的Archimedean copula公式：\n$$\n\\tau=1+4\\int_{0}^{1}\\frac{\\phi(t)}{\\phi'(t)}\\,dt,\n$$\n其中Clayton生成元为 $\\phi(t)=\\frac{1}{\\theta}\\big(t^{-\\theta}-1\\big)$（$\\theta>0$）。\n\n首先计算导数：\n$$\n\\phi'(t)=\\frac{1}{\\theta}\\big(-\\theta\\big)t^{-\\theta-1}=-t^{-(\\theta+1)}.\n$$\n那么，比值简化为\n$$\n\\frac{\\phi(t)}{\\phi'(t)}=\\frac{\\frac{1}{\\theta}\\big(t^{-\\theta}-1\\big)}{-t^{-(\\theta+1)}}=\\frac{1}{\\theta}\\big(t^{\\theta+1}-t\\big).\n$$\n因此，\n$$\n\\int_{0}^{1}\\frac{\\phi(t)}{\\phi'(t)}\\,dt=\\frac{1}{\\theta}\\left(\\int_{0}^{1}t^{\\theta+1}\\,dt-\\int_{0}^{1}t\\,dt\\right)=\\frac{1}{\\theta}\\left(\\frac{1}{\\theta+2}-\\frac{1}{2}\\right).\n$$\n将其代回 $\\tau$ 的表达式中，\n$$\n\\tau=1+\\frac{4}{\\theta}\\left(\\frac{1}{\\theta+2}-\\frac{1}{2}\\right)=1+\\frac{4}{\\theta}\\cdot\\frac{-\\theta}{2(\\theta+2)}=1-\\frac{2}{\\theta+2}=\\frac{\\theta}{\\theta+2}.\n$$\n该式对于 $\\theta>0$ 成立，这确保了在 $t=0$ 处的可积性。", "answer": "$$\\boxed{\\frac{\\theta}{\\theta+2}}$$", "id": "1927387"}]}