{"hands_on_practices": [{"introduction": "条件期望作为 $L^2$ 空间中的正交投影，其行为与我们熟悉的欧几里得空间中的几何投影有许多相似之处。此练习旨在验证投影算子的一个最基本性质：线性性。通过证明条件期望算子满足线性组合的分配律，我们能更深刻地理解为何它能被视为一个线性变换，为后续更复杂的应用奠定基础。[@problem_id:1350188]", "problem": "设 $(\\Omega, \\mathcal{F}, P)$ 为一个概率空间，并设 $L^2(\\Omega, \\mathcal{F}, P)$ 为该空间上由平方可积随机变量构成的希尔伯特空间，其内积定义为 $\\langle X, Y \\rangle = E[XY]$。设 $\\mathcal{G}$ 是 $\\mathcal{F}$ 的一个子 $\\sigma$-代数。这是一个已知的结果：条件期望算子 $E[\\cdot | \\mathcal{G}]$ 是从 $L^2(\\Omega, \\mathcal{F}, P)$ 到其闭子空间 $L^2(\\Omega, \\mathcal{G}, P)$ 的一个正交投影。\n\n我们用 $P_{\\mathcal{G}}(Z)$ 表示随机变量 $Z \\in L^2(\\Omega, \\mathcal{F}, P)$ 到子空间 $L^2(\\Omega, \\mathcal{G}, P)$ 上的正交投影。根据上述内容，我们有恒等式 $P_{\\mathcal{G}}(Z) = E[Z | \\mathcal{G}]$。\n\n考虑两个任意的随机变量 $X, Y \\in L^2(\\Omega, \\mathcal{F}, P)$ 以及一个任意的非零实常数 $c$。下列哪个表达式正确地表示了线性组合 $X + cY$ 到子空间 $L^2(\\Omega, \\mathcal{G}, P)$ 上的投影？\n\nA. $P_{\\mathcal{G}}(X) + P_{\\mathcal{G}}(Y)$\n\nB. $P_{\\mathcal{G}}(X) + c P_{\\mathcal{G}}(Y)$\n\nC. $P_{\\mathcal{G}}(X) + c^2 P_{\\mathcal{G}}(Y)$\n\nD. $|c| P_{\\mathcal{G}}(X) + \\sqrt{1-c^2} P_{\\mathcal{G}}(Y)$\n\nE. $c P_{\\mathcal{G}}(X) + P_{\\mathcal{G}}(Y)$\n\nF. 该表达式依赖于 $X$ 和 $Y$ 之间的相关性，通常情况下无法确定。", "solution": "我们使用到闭子空间 $L^{2}(\\Omega, \\mathcal{G}, P)$ 上正交投影的刻画：对于任意 $Z \\in L^{2}(\\Omega, \\mathcal{F}, P)$，其投影 $U = P_{\\mathcal{G}}(Z) \\in L^{2}(\\Omega, \\mathcal{G}, P)$ 是满足以下条件的唯一元素：\n$$\nE\\big[(Z - U)H\\big] = 0 \\quad \\text{对于所有 } H \\in L^{2}(\\Omega, \\mathcal{G}, P).\n$$\n等价地，由于 $P_{\\mathcal{G}}(Z) = E[Z \\mid \\mathcal{G}]$，当 $U = E[Z \\mid \\mathcal{G}]$ 时，同样的正交性成立。\n\n设 $U_{X} = P_{\\mathcal{G}}(X) = E[X \\mid \\mathcal{G}]$ 以及 $U_{Y} = P_{\\mathcal{G}}(Y) = E[Y \\mid \\mathcal{G}]$。对于任意 $H \\in L^{2}(\\Omega, \\mathcal{G}, P)$，根据正交性的定义我们有\n$$\nE\\big[(X - U_{X})H\\big] = 0, \\qquad E\\big[(Y - U_{Y})H\\big] = 0.\n$$\n固定一个任意的实常数 $c \\neq 0$（该论证对 $c = 0$ 也成立）。考虑 $Z = X + cY$ 以及候选投影\n$$\nU := U_{X} + c\\,U_{Y} \\in L^{2}(\\Omega, \\mathcal{G}, P).\n$$\n那么，对于任意 $H \\in L^{2}(\\Omega, \\mathcal{G}, P)$，\n$$\nE\\big[(Z - U)H\\big] = E\\big[(X + cY - U_{X} - cU_{Y})H\\big]\n= E\\big[(X - U_{X})H\\big] + c\\,E\\big[(Y - U_{Y})H\\big] = 0 + c \\cdot 0 = 0.\n$$\n根据正交投影的唯一性，这意味着 $U = P_{\\mathcal{G}}(Z)$，因此\n$$\nP_{\\mathcal{G}}(X + cY) = P_{\\mathcal{G}}(X) + c\\,P_{\\mathcal{G}}(Y).\n$$\n等价地，根据条件期望的线性性质，\n$$\nE[X + cY \\mid \\mathcal{G}] = E[X \\mid \\mathcal{G}] + c\\,E[Y \\mid \\mathcal{G}],\n$$\n这与选项 B 相匹配。", "answer": "$$\\boxed{B}$$", "id": "1350188"}, {"introduction": "掌握了投影的基本性质后，我们可以将其应用于解决实际问题。在信号处理和统计学中，一个核心任务是从可观测的信号中估计出我们感兴趣的目标信号，而“最佳线性估计”问题正是这一任务的数学模型。这个练习将向您展示，寻找最佳线性估计的过程在几何上等价于将目标信号向量投影到由参考信号张成的子空间上，让您亲身体会如何运用正交性原理来求解这个优化问题。[@problem_id:1350189]", "problem": "在信号处理中，一个常见的任务是根据其他可获取的测量值来估计感兴趣的信号 $S$。我们可以将信号 $S$ 和两个参考信号 $R_1$ 和 $R_2$ 建模为随机变量。对于本问题，假设所有信号都经过处理，其均值为零。这些随机变量是平方可积随机变量空间 $L^2$ 中的元素，其内积由 $\\langle A, B \\rangle = E[AB]$ 给出。\n\n目标是利用 $R_1$ 和 $R_2$ 找到 $S$ 的最佳线性估计。最佳线性估计是一个形式为 $\\hat{S} = a_1 R_1 + a_2 R_2$ 的随机变量，其中实系数 $a_1$ 和 $a_2$ 的选择旨在最小化均方误差 $E[(S - \\hat{S})^2]$。这个最优估计 $\\hat{S}$ 对应于 $S$ 在由 $\\{R_1, R_2\\}$ 张成的线性子空间上的正交投影。\n\n假设已知信号的以下统计特性：\n- $E[S^2] = 16$\n- $E[R_1^2] = 4$\n- $E[R_2^2] = 9$\n- $E[SR_1] = 3$\n- $E[SR_2] = -1$\n- $E[R_1 R_2] = 2$\n\n计算均方误差 $E[(S - \\hat{S})^2]$ 的最小可能值。", "solution": "我们在希尔伯特空间 $L^{2}$ 中进行计算，其内积为 $\\langle A,B\\rangle=E[AB]$。最佳线性估计 $\\hat{S}=a_{1}R_{1}+a_{2}R_{2}$ 是 $S$ 在 $\\operatorname{span}\\{R_{1},R_{2}\\}$ 上的正交投影，其特征是正交性条件 $E[(S-\\hat{S})R_{i}]=0$（对于 $i=1,2$）。\n\n定义系数向量 $a=\\begin{pmatrix}a_{1}\\\\ a_{2}\\end{pmatrix}$，协方差矩阵\n$$\nR=\\begin{pmatrix}\nE[R_{1}^{2}]  E[R_{1}R_{2}]\\\\\nE[R_{1}R_{2}]  E[R_{2}^{2}]\n\\end{pmatrix}\n=\\begin{pmatrix}\n4  2\\\\\n2  9\n\\end{pmatrix},\n$$\n以及互协方差向量\n$$\nc=\\begin{pmatrix}\nE[SR_{1}]\\\\\nE[SR_{2}]\n\\end{pmatrix}\n=\\begin{pmatrix}\n3\\\\\n-1\n\\end{pmatrix}.\n$$\n作为 $a$ 的函数的均方误差为\n$$\nE[(S-\\hat{S})^{2}]=E[S^{2}]-2a^{T}c+a^{T}Ra.\n$$\n对 $a$ 进行最小化可得到正规方程组 $Ra=c$。由于 $\\det(R)=4\\cdot 9-2^{2}=320$，因此 $R$ 是可逆的，唯一的最小化子是 $a=R^{-1}c$。将其代回误差表达式，得到最小均方误差\n$$\nE[(S-\\hat{S})^{2}]_{\\min}=E[S^{2}]-c^{T}R^{-1}c.\n$$\n\n计算 $R^{-1}$。对于 $R=\\begin{pmatrix}4  2\\\\2  9\\end{pmatrix}$，\n$$\nR^{-1}=\\frac{1}{32}\\begin{pmatrix}9  -2\\\\ -2  4\\end{pmatrix}.\n$$\n则\n$$\nR^{-1}c=\\frac{1}{32}\\begin{pmatrix}9  -2\\\\ -2  4\\end{pmatrix}\\begin{pmatrix}3\\\\ -1\\end{pmatrix}\n=\\frac{1}{32}\\begin{pmatrix}27+2\\\\ -6-4\\end{pmatrix}\n=\\begin{pmatrix}\\frac{29}{32}\\\\ -\\frac{5}{16}\\end{pmatrix},\n$$\n以及\n$$\nc^{T}R^{-1}c=\\begin{pmatrix}3  -1\\end{pmatrix}\\begin{pmatrix}\\frac{29}{32}\\\\ -\\frac{5}{16}\\end{pmatrix}\n=\\frac{87}{32}+\\frac{5}{16}\n=\\frac{97}{32}.\n$$\n已知 $E[S^{2}]=16$，最小均方误差为\n$$\nE[(S-\\hat{S})^{2}]_{\\min}=16-\\frac{97}{32}\n=\\frac{512}{32}-\\frac{97}{32}\n=\\frac{415}{32}.\n$$", "answer": "$$\\boxed{\\frac{415}{32}}$$", "id": "1350189"}, {"introduction": "在真实世界的应用中，我们的优化目标常常需要满足额外的限制条件。这个进阶练习在前一个问题的基础上增加了一个新的挑战：在寻找最佳逼近时，我们不仅要求解是某个子空间（$\\mathcal{G}$-可测）的元素，还必须满足一个关于其期望值的特定约束。这个问题模拟了许多实际场景，例如在满足能量或资源预算的前提下进行信号估计，它将引导您学习如何将这类约束整合到正交投影的框架中，找到带约束条件下的最优解。[@problem_id:1350191]", "problem": "考虑一个概率空间 $(\\Omega, \\mathcal{F}, P)$，其中 $\\Omega = [0,1] \\times [0,1]$ 是平面上的单位正方形，$\\mathcal{F}$ 是 $\\Omega$ 上的 Borel $\\sigma$-代数，而 $P$ 是均匀概率测度（即正方形上的勒贝格测度）。$\\Omega$ 中的一个点记为 $(\\omega_1, \\omega_2)$。\n\n在此空间上定义一个随机变量 $X$，其函数为 $X(\\omega_1, \\omega_2) = 6\\omega_1^2 + 12\\omega_2$。\n\n我们寻求一个随机变量 $Y$，它在一组约束条件下作为 $X$ 的“最佳近似”。近似的质量由均方误差 $E[(X-Y)^2]$ 来衡量。找出最小化该量且同时满足以下两个条件的随机变量 $Y$：\n\n1.  $Y$ 在任意点 $(\\omega_1, \\omega_2)$ 的值必须仅取决于第一个坐标 $\\omega_1$ 的值。也就是说，$Y$ 必须具有 $Y(\\omega_1, \\omega_2) = g(\\omega_1)$ 的形式，其中 $g$ 是某个函数。\n2.  $Y$ 的期望值必须恰好为 5，即 $E[Y] = 5$。\n\n确定这个最优随机变量 $Y$ 作为 $\\omega_1$ 和 $\\omega_2$ 的函数的表达式。", "solution": "我们通过在希尔伯特空间 $L^{2}(\\Omega,\\mathcal{F},P)$ 中进行投影，在约束条件下最小化均方误差。容许的随机变量类别是 $\\{Y:Y(\\omega_{1},\\omega_{2})=g(\\omega_{1}),\\ \\mathbb{E}[Y]=5\\}$。\n\n建立关于 $g$ 和乘子 $\\lambda$ 的拉格朗日泛函：\n$$\n\\mathcal{L}(g,\\lambda)=\\mathbb{E}\\big[(X-g(\\omega_{1}))^{2}\\big]+2\\lambda\\big(\\mathbb{E}[g(\\omega_{1})]-5\\big).\n$$\n对于任意容许的扰动 $h(\\omega_{1})$，一阶最优性条件是\n$$\n\\frac{d}{d\\epsilon}\\Big|_{\\epsilon=0}\\mathcal{L}(g+\\epsilon h,\\lambda)\n=-2\\mathbb{E}\\big[(X-g(\\omega_{1}))h(\\omega_{1})\\big]+2\\lambda\\,\\mathbb{E}[h(\\omega_{1})]=0,\n$$\n这等价于\n$$\n\\mathbb{E}\\big[(g(\\omega_{1})-X+\\lambda)h(\\omega_{1})\\big]=0\\quad\\text{for all }h(\\omega_{1}).\n$$\n由于这对每一个关于 $\\omega_{1}$ 可测的 $h$ 都成立，它意味着\n$$\n\\mathbb{E}\\big[g(\\omega_{1})-X+\\lambda\\mid \\omega_{1}\\big]=0\n\\quad\\Longrightarrow\\quad\ng(\\omega_{1})=\\mathbb{E}[X\\mid \\omega_{1}]-\\lambda.\n$$\n利用 $\\omega_{1},\\omega_{2}$ 的独立性和均匀性计算条件期望：\n$$\n\\mathbb{E}[X\\mid \\omega_{1}]\n=\\mathbb{E}[6\\omega_{1}^{2}+12\\omega_{2}\\mid \\omega_{1}]\n=6\\omega_{1}^{2}+12\\,\\mathbb{E}[\\omega_{2}]\n=6\\omega_{1}^{2}+6,\n$$\n因为 $\\mathbb{E}[\\omega_{2}]=\\frac{1}{2}$。因此\n$$\ng(\\omega_{1})=6\\omega_{1}^{2}+6-\\lambda.\n$$\n施加期望约束 $\\mathbb{E}[g(\\omega_{1})]=5$：\n$$\n5=\\mathbb{E}[g(\\omega_{1})]=\\mathbb{E}[6\\omega_{1}^{2}+6]-\\lambda\n=6\\,\\mathbb{E}[\\omega_{1}^{2}]+6-\\lambda.\n$$\n由于 $\\mathbb{E}[\\omega_{1}^{2}]=\\int_{0}^{1}x^{2}\\,dx=\\frac{1}{3}$，我们得到\n$$\n5=6\\cdot\\frac{1}{3}+6-\\lambda=2+6-\\lambda=8-\\lambda\\quad\\Longrightarrow\\quad \\lambda=3.\n$$\n因此，最优的随机变量是\n$$\nY(\\omega_{1},\\omega_{2})=g(\\omega_{1})=6\\omega_{1}^{2}+6-3=6\\omega_{1}^{2}+3,\n$$\n它只依赖于 $\\omega_{1}$ 并且满足 $\\mathbb{E}[Y]=6\\,\\mathbb{E}[\\omega_{1}^{2}]+3=2+3=5$。由于目标函数是严格凸的，且可行集是凸的，所以该解是唯一的极小化子。", "answer": "$$\\boxed{6\\omega_{1}^{2}+3}$$", "id": "1350191"}]}