{"hands_on_practices": [{"introduction": "本节将通过一系列动手实践，帮助你巩固对克拉默定理和大偏差理论的理解。这些练习的核心在于将理论应用于具体场景，学习如何计算罕见事件的发生概率及其指数衰减率。第一个练习是一个经典应用，我们将探讨一个泊松分布的样本均值发生大偏差的概率 [@problem_id:1370564]。泊松分布常用于为计数数据建模，例如一个产品上的瑕疵数量，通过这个练习，你将掌握计算速率函数的基本步骤，并理解为何样本均值远超期望值的概率会随着样本量的增加而呈指数级下降。", "problem": "在一家半导体制造厂中，单个高性能处理器芯片上的微观缺陷数量是一个随机变量，服从泊松分布，其期望值为每芯片 $\\lambda$ 个缺陷。为了进行质量保证，会抽取一大批 $n$ 个芯片进行检查。设 $X_i$ 是第 $i$ 个芯片上的缺陷数量，并设 $\\bar{X}_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 是该批次中每个芯片的平均缺陷数。\n\n如果观测到的平均缺陷数异常高，该批次将被标记以进行复审。我们感兴趣的是一个稀有事件的概率，即平均缺陷数至少是单个芯片期望值的两倍，即 $P(\\bar{X}_n \\ge 2\\lambda)$。\n\n根据大偏差理论，当 $n$ 很大时，这个概率的表现为 $P(\\bar{X}_n \\ge 2\\lambda) \\approx \\exp(-nC)$，其中 $C$ 是一个依赖于 $\\lambda$ 的正常数。确定极限衰减率的值，其形式上定义为以下极限：\n$$ \\lim_{n \\to \\infty} \\frac{1}{n} \\ln P(\\bar{X}_n \\ge 2\\lambda) $$\n将您的答案表示为关于 $\\lambda$ 的闭式解析表达式。", "solution": "我们考虑独立同分布的 $X_{i} \\sim \\mathrm{Poisson}(\\lambda)$，其均值为 $\\lambda$，以及样本均值 $\\bar{X}_{n} = \\frac{1}{n} \\sum_{i=1}^{n} X_{i}$。根据 Cramér 定理，由于矩生成函数在 $0$ 的一个邻域内存在，对于闭集 $[2\\lambda, \\infty)$ 我们有\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\ln P\\!\\left(\\bar{X}_{n} \\ge 2\\lambda\\right) = - \\inf_{x \\ge 2\\lambda} I(x),\n$$\n其中 $I$ 是由累积量生成函数的 Legendre-Fenchel 变换给出的优良率函数。\n\n对于一个 $\\mathrm{Poisson}(\\lambda)$ 随机变量，其矩生成函数为\n$$\nM_{X}(t) = \\mathbb{E}\\!\\left[\\exp(t X)\\right] = \\sum_{k=0}^{\\infty} \\exp(tk) \\cdot \\exp(-\\lambda) \\frac{\\lambda^{k}}{k!} = \\exp\\!\\left(\\lambda(\\exp(t) - 1)\\right),\n$$\n因此累积量生成函数为\n$$\n\\psi(t) = \\ln M_{X}(t) = \\lambda\\left(\\exp(t) - 1\\right).\n$$\n样本均值的率函数是 Legendre-Fenchel 变换\n$$\nI(x) = \\sup_{t \\in \\mathbb{R}} \\left\\{ t x - \\psi(t) \\right\\} = \\sup_{t \\in \\mathbb{R}} \\left\\{ t x - \\lambda\\left(\\exp(t) - 1\\right) \\right\\}.\n$$\n为求上确界，我们对 $t$ 求导并令其为零：\n$$\n\\frac{d}{dt}\\left(t x - \\lambda \\exp(t) + \\lambda\\right) = x - \\lambda \\exp(t) = 0 \\quad \\Longrightarrow \\quad \\exp(t^{\\ast}) = \\frac{x}{\\lambda},\n$$\n这（对于 $x \\ge 0$）给出 $t^{\\ast} = \\ln\\!\\left(\\frac{x}{\\lambda}\\right)$。代回可得\n$$\nI(x) = x \\ln\\!\\left(\\frac{x}{\\lambda}\\right) - \\lambda\\left(\\frac{x}{\\lambda} - 1\\right) = x \\ln\\!\\left(\\frac{x}{\\lambda}\\right) - x + \\lambda, \\quad x \\ge 0.\n$$\n此外，$I$ 是凸函数，其导数为\n$$\n\\frac{d}{dx} I(x) = \\ln\\!\\left(\\frac{x}{\\lambda}\\right),\n$$\n所以当 $x \\ge \\lambda$ 时，$I$ 是递增的。因此，\n$$\n\\inf_{x \\ge 2\\lambda} I(x) = I(2\\lambda) = 2\\lambda \\ln 2 - 2\\lambda + \\lambda = 2\\lambda \\ln 2 - \\lambda.\n$$\n根据 Cramér 定理，\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\ln P\\!\\left(\\bar{X}_{n} \\ge 2\\lambda\\right) = - I(2\\lambda) = -\\left(2\\lambda \\ln 2 - \\lambda\\right) = \\lambda - 2\\lambda \\ln 2.\n$$\n由于 $2 \\ln 2 > 1$，衰减率 $I(2\\lambda)$ 是正的，这符合大偏差衰减常数的要求。", "answer": "$$\\boxed{\\lambda - 2\\lambda \\ln 2}$$", "id": "1370564"}, {"introduction": "大偏差理论的应用远不止于样本均值。在第二个练习中，我们将探讨样本方差出现罕见波动的概率 [@problem_id:1370511]。这个问题展示了一个关键的解题技巧：通过定义一组新的随机变量（此处为原始变量与均值之差的平方），将关于样本方差的问题转化为一个关于新变量样本均值的问题。这种转化思想是解决更复杂大偏差问题的有力工具。", "problem": "考虑一个实验测量序列 $X_1, X_2, \\ldots, X_n$，它被建模为一组独立同分布 (i.i.d.) 的随机变量。每次测量都服从正态分布 $N(\\mu, \\sigma^2)$，其中真实均值 $\\mu$ 和真实方差 $\\sigma^2 > 0$ 已知。\n\n评估数据离散程度的一个关键量是以真实均值为中心的二阶矩，定义为：\n$$V_n = \\frac{1}{n} \\sum_{i=1}^n (X_i - \\mu)^2$$\n请注意，这个方差估计量使用了已知的真实均值 $\\mu$，而不是样本均值 $\\bar{X}_n$。\n\n根据大数定律，当 $n$ 变得非常大时，$V_n$ 收敛于 $\\sigma^2$。然而，对于任何有限的 $n$，观测到 $V_n$ 的值显著偏离 $\\sigma^2$ 的概率不为零。大偏差理论提供了一种量化这种稀有事件发生率的方法。具体来说，对于 $a > \\sigma^2$，这种大偏差的概率近似为：\n$$P(V_n \\ge a) \\approx \\exp(-n I(a))$$\n对于大的 $n$。函数 $I(a)$ 被称为速率函数，它量化了该概率的指数衰减速率。\n\n计算当以真实均值为中心的二阶矩 $V_n$ 至少是真实方差 $\\sigma^2$ 两倍时，速率函数 $I(a)$ 的值。换句话说，确定 $I(2\\sigma^2)$ 的数值。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $X_{i} \\sim N(\\mu,\\sigma^{2})$ 独立同分布，并定义 $Y_{i}=(X_{i}-\\mu)^{2}$。那么 $V_{n}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$。由于 $(X_{i}-\\mu)/\\sigma \\sim N(0,1)$，我们可以将 $Y_{i}$ 写为 $Y_{i}=\\sigma^{2}Z_{i}^{2}$，其中 $Z_{i}\\sim N(0,1)$。$Z^{2}$ 的矩生成函数是 $M_{Z^{2}}(t)=(1-2t)^{-1/2}$ (对于 $t  \\frac{1}{2}$)，因此 $Y$ 的矩生成函数是\n$$\nM_{Y}(t)=\\mathbb{E}[\\exp(tY)]=\\left(1-2\\sigma^{2}t\\right)^{-1/2}, \\quad t  \\frac{1}{2\\sigma^{2}}.\n$$\n累积量生成函数是\n$$\n\\Lambda(t)=\\ln M_{Y}(t)=-\\frac{1}{2}\\ln\\left(1-2\\sigma^{2}t\\right).\n$$\n根据 Cramér 定理，样本均值 $V_{n}$ 的速率函数是 Legendre-Fenchel 变换\n$$\nI(a)=\\sup_{t  \\frac{1}{2\\sigma^{2}}}\\left\\{ta-\\Lambda(t)\\right\\}=\\sup_{t  \\frac{1}{2\\sigma^{2}}}\\left\\{ta+\\frac{1}{2}\\ln\\left(1-2\\sigma^{2}t\\right)\\right\\}.\n$$\n为了找到最大值点，求导并令其为零：\n$$\n\\frac{d}{dt}\\left(ta+\\frac{1}{2}\\ln(1-2\\sigma^{2}t)\\right)=a-\\frac{\\sigma^{2}}{1-2\\sigma^{2}t}=0,\n$$\n解得\n$$\n1-2\\sigma^{2}t^{*}=\\frac{\\sigma^{2}}{a}, \\quad t^{*}=\\frac{1}{2\\sigma^{2}}\\left(1-\\frac{\\sigma^{2}}{a}\\right).\n$$\n将 $t^{*}$ 代回可得\n$$\nI(a)=a t^{*}+\\frac{1}{2}\\ln\\left(1-2\\sigma^{2}t^{*}\\right)=\\frac{a-\\sigma^{2}}{2\\sigma^{2}}+\\frac{1}{2}\\ln\\left(\\frac{\\sigma^{2}}{a}\\right).\n$$\n对于 $a=2\\sigma^{2}$，\n$$\nI(2\\sigma^{2})=\\frac{2\\sigma^{2}-\\sigma^{2}}{2\\sigma^{2}}+\\frac{1}{2}\\ln\\left(\\frac{\\sigma^{2}}{2\\sigma^{2}}\\right)=\\frac{1}{2}+\\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right)=\\frac{1-\\ln 2}{2}.\n$$\n数值上，$\\frac{1-\\ln 2}{2}\\approx 0.1534$ (四舍五入到四位有效数字)。", "answer": "$$\\boxed{0.1534}$$", "id": "1370511"}, {"introduction": "最后一个练习旨在展示大偏差原理的广泛适用性和灵活性。我们将不再关注样本均值或方差，而是转而分析样本中位数发生偏差的概率 [@problem_id:1370526]。解决这个问题的精妙之处在于，需要将关于样本中位数的事件重新表述为关于一个经验比例的事件，而这个经验比例本身又可以看作是一系列伯努利随机变量的均值。这个练习突显了如何将看似不同的问题化归到克拉默定理的核心框架下，从而加深对理论本质的理解。", "problem": "在一次高能实验中，产生了一种不稳定的亚原子粒子。任何给定粒子的寿命是一个随机变量。这些寿命被建模为独立同分布（i.i.d.）的随机变量，每个都服从速率参数为 $\\lambda  0$ 的指数分布。其概率密度函数为 $f(x) = \\lambda \\exp(-\\lambda x)$，其中 $x \\ge 0$。\n\n一个实验测量了大量（$n$ 个）此类粒子的寿命，得到一个样本 $X_1, X_2, \\dots, X_n$。根据这些数据计算出样本中位数 $\\hat{m}_n$。寿命分布的真实中位数记为 $m$。\n\n对于一个小的正常数 $\\epsilon$，我们关心观测到的样本中位数显著大于真实中位数的稀有事件的概率。对于大的 $n$，这个概率可以通过渐近形式 $P(\\hat{m}_n  m + \\epsilon) \\approx \\exp(-nK)$ 来近似，其中 $K$ 是一个正常数，称为在相应点上评估的速率函数。\n\n请确定常数 $K$ 关于 $\\lambda$ 和 $\\epsilon$ 的闭式表达式。", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的，服从指数分布，其累积分布函数为 $F(x)=1-\\exp(-\\lambda x)$，其中 $x\\geq 0$。真实中位数 $m$ 满足 $F(m)=\\frac{1}{2}$，因此\n$$\n\\exp(-\\lambda m)=\\frac{1}{2}\\quad\\Rightarrow\\quad m=\\frac{1}{\\lambda}\\ln 2.\n$$\n固定 $t=m+\\epsilon$，其中 $\\epsilon0$。将 $t$ 以下的经验比例定义为 $S_{n}(t)=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{1}\\{X_{i}\\leq t\\}$。对于连续分布，样本中位数超过 $t$ 的事件等价于至多有一半的样本小于或等于 $t$，即 $\\hat{m}_{n}t$ 当且仅当 $S_{n}(t)\\leq\\frac{1}{2}$（严格不等式和非严格不等式之间的区别不影响大偏差指数）。\n\n每个指示函数 $\\mathbf{1}\\{X_{i}\\leq t\\}$ 是一个成功概率为 $p=F(t)$ 的伯努利随机变量。因此 $S_{n}(t)$ 是独立同分布的伯努利$(p)$随机变量的平均值。根据关于伯努利变量样本均值的 Cramér 定理（或 Chernoff 界），对于 $q  p$，\n$$\n\\Pr\\big(S_{n}(t)\\leq q\\big)\\approx \\exp\\big(-n\\,I(q\\|p)\\big),\n$$\n其中速率函数是二元相对熵\n$$\nI(q\\|p)=q\\ln\\!\\left(\\frac{q}{p}\\right)+(1-q)\\ln\\!\\left(\\frac{1-q}{1-p}\\right).\n$$\n这里 $q=\\frac{1}{2}$ 且 $p=F(m+\\epsilon)$，所以\n$$\nK=I\\!\\left(\\frac{1}{2}\\,\\bigg\\|\\,p\\right)=\\frac{1}{2}\\ln\\!\\left(\\frac{1/2}{p}\\right)+\\frac{1}{2}\\ln\\!\\left(\\frac{1/2}{1-p}\\right)=-\\frac{1}{2}\\ln\\!\\big(4p(1-p)\\big).\n$$\n计算在 $t=m+\\epsilon$ 处的 $p$：\n$$\np=F(m+\\epsilon)=1-\\exp\\big(-\\lambda(m+\\epsilon)\\big)=1-\\exp(-\\lambda m)\\exp(-\\lambda\\epsilon)=1-\\frac{1}{2}\\exp(-\\lambda\\epsilon).\n$$\n则\n$$\n1-p=\\frac{1}{2}\\exp(-\\lambda\\epsilon),\\qquad p(1-p)=\\left(1-\\frac{1}{2}\\exp(-\\lambda\\epsilon)\\right)\\left(\\frac{1}{2}\\exp(-\\lambda\\epsilon)\\right)=\\frac{1}{4}\\exp(-\\lambda\\epsilon)\\left(2-\\exp(-\\lambda\\epsilon)\\right).\n$$\n因此\n$$\n4p(1-p)=\\exp(-\\lambda\\epsilon)\\left(2-\\exp(-\\lambda\\epsilon)\\right),\n$$\n所以\n$$\nK=-\\frac{1}{2}\\ln\\!\\left(\\exp(-\\lambda\\epsilon)\\left(2-\\exp(-\\lambda\\epsilon)\\right)\\right)=\\frac{\\lambda\\epsilon}{2}-\\frac{1}{2}\\ln\\!\\left(2-\\exp(-\\lambda\\epsilon)\\right).\n$$\n对于每个 $\\epsilon0$，此 $K$ 均为正，符合要求。", "answer": "$$\\boxed{\\frac{\\lambda\\epsilon}{2}-\\frac{1}{2}\\ln\\!\\left(2-\\exp(-\\lambda\\epsilon)\\right)}$$", "id": "1370526"}]}