{"hands_on_practices": [{"introduction": "掌握蒙提霍尔问题的关键在于理解其核心逻辑，而不仅仅是记住三门问题的答案。这个练习将经典的场景扩展到四扇门，并对“换门”策略稍作修改。你需要仔细运用全概率公式来计算在这种新规则下获胜的概率，这将考验你是否真正理解了问题背后的概率原理 [@problem_id:1402127]。", "problem": "在一个名为“四门难题”的游戏节目中，一位参赛者面对四扇相同的紧闭的门。其中一扇门后面是一辆全新的汽车，另外三扇门后面是山羊。汽车的放置是随机的，因此它等可能地在任何一扇门后面。\n\n游戏的顺序如下：\n1. 参赛者首先做出初始选择，挑选四扇门中的一扇。\n2. 主持人知道汽车的位置，然后会打开另外三扇门中的一扇，并且总是打开一扇藏有山羊的门。\n3. 参赛者现在面对三扇紧闭的门：他们最初的选择和另外两扇未打开的门。\n4. 参赛者决定采用一种特定的“随机更换”策略：他们放弃最初的选择，然后从另外两扇剩下的紧闭的门中随机选择一扇。在这两扇门之间的选择是以相等的概率（每扇门1/2）进行的。\n\n计算参赛者使用这种策略赢得汽车的总概率。将你的答案表示为最简精确分数。", "solution": "设 $A$ 为参赛者最初选择的门后是汽车的事件， $B$ 为最初选择的门后是山羊的事件。由于汽车等可能地在任何一扇门后面，\n$$\nP(A)=\\frac{1}{4}, \\quad P(B)=\\frac{3}{4}.\n$$\n给定 $A$，另外三扇门后面都是山羊。主持人打开一扇有山羊的门，剩下两扇未打开的门后面也都是山羊。参赛者放弃最初的有汽车的门，并从这两扇有山羊的门中随机选择一扇，所以\n$$\nP(\\text{win} \\mid A)=0.\n$$\n给定 $B$，在另外三扇门中，恰好有一扇门后是汽车，两扇门后是山羊。主持人打开一扇有山羊的门，在除了最初选择之外的两扇未打开的门中，恰好剩下一扇门后是汽车，一扇门后是山羊。参赛者从这两扇门中随机选择一扇，所以\n$$\nP(\\text{win} \\mid B)=\\frac{1}{2}.\n$$\n根据全概率公式，\n$$\nP(\\text{win})=P(\\text{win} \\mid A)P(A)+P(\\text{win} \\mid B)P(B)=0 \\cdot \\frac{1}{4}+\\frac{1}{2} \\cdot \\frac{3}{4}=\\frac{3}{8}.\n$$", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "1402127"}, {"introduction": "在解决了具体门数的变体之后，下一步是进行抽象和泛化。这个练习要求你推导一个适用于任意 $N$ 扇门的通用获胜概率公式 [@problem_id:1402141]。完成这项挑战意味着你将从解决一个谜题，跃升到理解一个普适的数学结构，这是培养科学思维的重要一步。", "problem": "一个名为“Galaxy of Gates”的未来主义游戏节目，已成为已知宇宙中最受欢迎的广播。其规则是一个经典概率谜题的宇宙尺度版本。有 $N$ 个完全相同的不透明传送门围成一圈，其中 $N$ 是一个整数且 $N \\ge 3$。其中一扇传送门后面藏着大奖：一艘具备超空间能力的星舰。另外 $N-1$ 扇传送门后面是毫无价值的彗星。\n\n你，作为参赛者，选择一扇传送门。在你做出选择后，节目的主持人，一个名为“The Arbiter”的近乎全知的存在，他知道星舰在哪里，会打开*另外一扇*传送门。The Arbiter 总会打开一扇后面是彗星的传送门。在这次揭示之后，除了你最初的选择外，还剩下 $N-2$ 扇未打开的传送门。\n\n现在，你可以选择是否更换你的选择。你决定总是采用“更换”策略：你将放弃你最初选择的传送门，并从其他 $N-2$ 扇未打开的传送门中随机均匀地选择一扇。\n\n请导出一个关于 $N$ 的函数，表示你赢得星舰的概率。", "solution": "设有 $N$ 扇传送门，其中只有一扇后面有奖品。你最初选择一扇传送门。The Arbiter 打开另外一扇传送门，展示一颗彗星，除了你最初的选择外，还剩下 $N-2$ 扇未打开的传送门。然后你通过在剩下的 $N-2$ 扇传送门中随机均匀地选择一扇来进行更换。\n\n通过以你最初的选择是否正确为条件，来计算获胜的概率。\n\n如果最初的选择就是奖品（概率为 $\\frac{1}{N}$），那么在 The Arbiter 打开一扇有彗星的门后，所有其他 $N-2$ 扇未打开的门后面都是彗星。更换选择会从这 $N-2$ 扇有彗星的门中选择，因此在这种情况下获胜的条件概率为 $0$。\n\n如果最初的选择是彗星（概率为 $\\frac{N-1}{N}$），那么在剩下的 $N-2$ 扇未打开的传送门中（不包括你最初选择的和 The Arbiter 打开的），正好有一扇后面藏着奖品。由于你从这 $N-2$ 扇门中随机均匀地选择，获胜的条件概率是 $\\frac{1}{N-2}$。\n\n根据全概率公式，更换选择的总获胜概率为\n$$\n\\frac{1}{N}\\cdot 0+\\frac{N-1}{N}\\cdot\\frac{1}{N-2}=\\frac{N-1}{N(N-2)}.\n$$", "answer": "$$\\boxed{\\frac{N-1}{N\\left(N-2\\right)}}$$", "id": "1402141"}, {"introduction": "理论计算出的概率有时会与我们的直觉相悖，这时计算模拟就成了一种强大的验证工具。这项练习旨在让你设计一个蒙特卡洛模拟算法，用以经验性地验证前面问题中的理论结果 [@problem_id:1402172]。这不仅能加深你对概率概念的直观理解，还能让你体会到计算科学在解决复杂问题中的应用。", "problem": "一个著名的游戏节目被推广到包含 $N$ 扇相同的门。一扇门后是贵重的奖品，另外 $N-1$ 扇门后是山羊。参赛者不知道奖品在哪里。游戏按以下方式进行：\n1.  参赛者做出初始选择，挑选 $N$ 扇门中的一扇。\n2.  知道奖品位置的主持人，接着打开另外 $k$ 扇门，其中 $1 \\le k \\le N-2$。主持人打开的门保证后面是山羊。\n3.  然后给参赛者一个选择：要么坚持他们最初的选择，要么换到另一扇仍然关闭的门。\n\n我们感兴趣的是“更换策略”，即参赛者总是放弃他们最初的选择，并从其余仍然关闭的门中随机挑选一扇。你的任务是找出一个正确的蒙特卡洛模拟算法，该算法用于估计当参赛者采用这种更换策略时获胜的概率。\n\n设 `num_trials` 为模拟运行的总次数。以下哪个算法能正确估计获胜概率？\n\nA. 初始化 `wins = 0`。对于 `i` 从 1 到 `num_trials`：\n   1. 从 1 到 $N$ 随机为一扇门分配奖品。\n   2. 随机选择参赛者的初始门。\n   3. 确定不是参赛者选择的 $N-1$ 扇门的集合。主持人从此集合中随机打开 $k$ 扇门。\n   4. 确定剩余关闭的门的集合。参赛者从此集合中随机选择一扇新门。\n   5. 如果参赛者的新门有奖品，则将 `wins` 加一。\n   估计的概率是 `wins / num_trials`。\n\nB. 初始化 `wins = 0`。对于 `i` 从 1 到 `num_trials`：\n   1. 从 1 到 $N$ 随机为一扇门分配奖品。\n   2. 随机选择参赛者的初始门。\n   3. 确定不包含奖品且不是参赛者选择的门的集合。主持人从此集合中随机打开 $k$ 扇门。\n   4. 确定所有未被主持人打开的门的集合。参赛者从此集合中随机选择一扇新门。\n   5. 如果参赛者的新门有奖品，则将 `wins` 加一。\n   估计的概率是 `wins / num_trials`。\n\nC. 初始化 `wins = 0`。初始化 `valid_trials = 0`。当 `valid_trials  num_trials` 时：\n   1. 从 1 到 $N$ 随机为一扇门分配奖品。\n   2. 随机选择参赛者的初始门。\n   3. 如果参赛者的初始选择是奖品门，则丢弃此次试验并继续下一次迭代。\n   4. 确定不包含奖品且不是参赛者选择的门的集合。主持人从此集合中随机打开 $k$ 扇门。\n   5. 确定未被主持人打开且不是参赛者初始选择的门的集合。参赛者从此集合中随机选择一扇门。\n   6. 如果参赛者的新门有奖品，则将 `wins` 加一。\n   7. 将 `valid_trials` 加一。\n   估计的概率是 `wins / valid_trials`。\n\nD. 初始化 `wins = 0`。对于 `i` 从 1 到 `num_trials`：\n   1. 从 1 到 $N$ 随机为一扇门分配奖品。\n   2. 随机选择参赛者的初始门。\n   3. 确定不包含奖品且不是参赛者选择的门的集合。主持人从此集合中随机打开 $k$ 扇门。\n   4. 确定未被主持人打开且不是参赛者初始选择的门的集合。参赛者从此集合中随机选择一扇门。\n   5. 如果参赛者的新门有奖品，则将 `wins` 加一。\n   估计的概率是 `wins / num_trials`。", "solution": "设门由集合 $D=\\{1,2,\\dots,N\\}$ 标记。奖品位置 $P$ 在 $D$ 上均匀选择，参赛者的初始选择 $C$ 也在 $D$ 上均匀选择，且与 $P$ 无关。主持人知道 $P$ 并打开 $k$ 扇门，每扇门都保证后面是山羊；因此，每扇被打开的门都必须位于 $D\\setminus\\{C,P\\}$ 中。在主持人打开这 $k$ 扇门之后，仍然关闭的门的集合是 $D$ 减去那 $k$ 扇被打开的门。更换策略要求参赛者放弃 $C$，并从除 $C$ 之外的其余关闭的门中随机均匀地选择一扇。\n\n在更换策略下的获胜概率推导如下。如果 $C=P$，那么除了 $C$ 之外没有门有奖品，所以更换策略的失败概率为 $1$。如果 $C\\neq P$，那么在保持关闭且不是 $C$ 的门中，恰好有一扇门有奖品。这样的门有 $N-k-1$ 扇，所以在 $C\\neq P$ 的条件下，条件获胜概率是 $1/(N-k-1)$。使用全概率公式，其中 $\\Pr(C\\neq P)=(N-1)/N$，无条件获胜概率为\n$$\n\\Pr(\\text{win by switching})=\\frac{N-1}{N}\\cdot\\frac{1}{N-k-1}.\n$$\n一个正确的蒙特卡洛算法必须复现主持人的限制和更换规则来估计这个概率。\n\n算法 A 是不正确的，因为步骤 3 允许主持人从 $D\\setminus\\{C\\}$ 中选择 $k$ 扇门打开，而没有排除 $P$。这使得当 $C\\neq P$ 时，主持人打开奖品门的概率为正，这违反了主持人打开的门保证是山羊的规则，因此会使模拟产生偏差。\n\n算法 B 在步骤 3 中正确地将主持人打开的门限制在 $D\\setminus\\{C,P\\}$，但是步骤 4 让参赛者从所有未被主持人打开的门中均匀选择，即从 $D$ 减去 $k$ 扇已打开的门。这个集合的大小为 $N-k$，并且包含了最初的选择 $C$。因此，参赛者将以 $1/(N-k)$ 的概率无意中“坚持”选择 $C$，这造成了坚持和更换行为的混合，而不是纯粹的更换策略。因此，它不能估计所求的概率。\n\n算法 C 通过丢弃 $C=P$ 的试验，使模拟以 $C\\neq P$ 为条件。在这种情况下，测得的成功率收敛于条件概率 $1/(N-k-1)$，而不是无条件获胜概率 $\\frac{N-1}{N}\\cdot\\frac{1}{N-k-1}$。由于要求的是无条件估计，因此该算法如所述是不正确的。\n\n算法 D 强制执行了两个必要条件：主持人从 $D\\setminus\\{C,P\\}$（保证是山羊）中打开 $k$ 扇门，然后参赛者从排除主持人打开的门和初始选择 $C$ 的关闭门中均匀选择，即从一个大小为 $N-k-1$ 的集合中选择。这实现了纯粹的更换策略，并对正确的获胜概率 $\\frac{N-1}{N}\\cdot\\frac{1}{N-k-1}$ 产生了一致的蒙特卡洛估计。\n\n因此，正确的算法是 D。", "answer": "$$\\boxed{D}$$", "id": "1402172"}]}