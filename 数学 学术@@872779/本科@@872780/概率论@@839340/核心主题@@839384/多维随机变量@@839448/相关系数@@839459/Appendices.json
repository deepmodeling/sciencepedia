{"hands_on_practices": [{"introduction": "我们从基本原理出发，开始我们的动手实践，计算相关系数。这个练习使用了一个简单直观的掷骰子场景来定义两个离散随机变量，让你能够专注于协方差和方差的核心定义，而无需处理连续分布的复杂性。[@problem_id:3537]", "problem": "考虑一个随机实验，该实验包括掷一个均匀的、六个面的骰子一次。令掷骰子的结果为随机变量 $S$，它可以等概率地取 $1$到$6$的整数值。\n\n基于结果 $S$ 定义了两个新的随机变量 $X$ 和 $Y$：\n-   随机变量 $X$ 是一个指示变量，定义如下：\n    $$\n    X = \\begin{cases} 1  \\text{若 } S \\le 3 \\\\ 0  \\text{若 } S > 3 \\end{cases}\n    $$\n-   随机变量 $Y$ 也是一个指示变量，定义如下：\n    $$\n    Y = \\begin{cases} 1  \\text{若 } S \\text{ 为偶数} \\\\ 0  \\text{若 } S \\text{ 为奇数} \\end{cases}\n    $$\n\n你的任务是推导随机变量 $X$ 和 $Y$ 之间的皮尔逊相关系数 $\\rho(X, Y)$。", "solution": "我们有 $S \\sim \\operatorname{Unif}\\{1,2,3,4,5,6\\}$，因此对于 $i=1,\\dots,6$，有 $P(S=i)=\\frac{1}{6}$。 定义\n$$X=\\mathbf{1}_{\\{S\\le3\\}},\\qquad Y=\\mathbf{1}_{\\{\\text{$S$ 为偶数}\\}}.$$\n\n1. 计算 $\\mathbb{E}[X]$ 和 $\\operatorname{Var}(X)$。  \n   因为当 $S\\in\\{1,2,3\\}$ 时，$X=1$，\n   $$P(X=1)=\\frac{3}{6}=\\frac{1}{2},\\quad P(X=0)=\\frac{1}{2},$$\n   所以\n   $$\\mathbb{E}[X]=1\\cdot\\frac{1}{2}+0\\cdot\\frac{1}{2}=\\frac{1}{2},$$\n   $$\n   \\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\mathbb{E}[X] - (\\mathbb{E}[X])^2 = \\frac{1}{2} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{2} - \\frac{1}{4} = \\frac{1}{4}.\n   $$\n\n2. 计算 $\\mathbb{E}[Y]$ 和 $\\operatorname{Var}(Y)$。  \n   因为当 $S\\in\\{2,4,6\\}$ 时，$Y=1$，\n   $$P(Y=1)=\\frac{3}{6}=\\frac{1}{2},\\quad P(Y=0)=\\frac{1}{2},$$\n   所以\n   $$\\mathbb{E}[Y]=\\frac{1}{2},$$\n   $$\n   \\operatorname{Var}(Y) = \\frac{1}{2} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}.\n   $$\n\n3. 计算 $\\mathbb{E}[XY]$。  \n   当且仅当 $S\\le3$ 且 $S$ 为偶数时，即 $S=2$ 时，我们有 $XY=1$。 因此\n   $$P(XY=1)=P(S=2)=\\frac{1}{6},\\quad P(XY=0)=\\frac{5}{6},$$\n   $$\\mathbb{E}[XY]=1\\cdot\\frac{1}{6}+0\\cdot\\frac{5}{6}=\\frac{1}{6}.$$\n\n4. 计算协方差：\n   $$\n   \\operatorname{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y] = \\frac{1}{6} - \\frac{1}{2}\\cdot\\frac{1}{2} = \\frac{1}{6} - \\frac{1}{4} = -\\frac{1}{12}.\n   $$\n\n5. 最后，皮尔逊相关系数为\n   $$\n   \\rho(X,Y) = \\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\,\\operatorname{Var}(Y)}} = \\frac{-\\frac{1}{12}}{\\sqrt{\\frac{1}{4}\\cdot\\frac{1}{4}}} = \\frac{-\\frac{1}{12}}{\\frac{1}{4}} = -\\frac{1}{3}.\n   $$", "answer": "$$ \\boxed{-\\frac{1}{3}} $$", "id": "3537"}, {"introduction": "在掌握了离散情况后，我们现在将技能扩展到连续随机变量。这个问题要求你根据给定的联合概率密度函数（PDF）计算相关系数，为使用二重积分求边缘分布、期望以及最终的相关性提供了必要的练习。[@problem_id:1911199]", "problem": "设 $X$ 和 $Y$ 是两个连续随机变量。它们的联合概率密度函数 (PDF) 由下式给出：\n$$\nf(x,y) =\n\\begin{cases}\nx+y  \\text{当 } 0 \\le x \\le 1 \\text{ 且 } 0 \\le y \\le 1 \\\\\n0  \\text{其它情况}\n\\end{cases}\n$$\n计算随机变量 $X$ 和 $Y$ 之间的皮尔逊相关系数 $\\rho(X,Y)$。将您的答案表示为单一的闭式解析表达式。", "solution": "首先，验证 $f(x,y)$ 是 $[0,1]^{2}$ 上的有效概率密度：\n$$\n\\int_{0}^{1}\\int_{0}^{1}(x+y)\\,dx\\,dy=\\int_{0}^{1}\\left(\\int_{0}^{1}x\\,dx+\\int_{0}^{1}y\\,dx\\right)dy=\\int_{0}^{1}\\left(\\frac{1}{2}+y\\right)dy=\\frac{1}{2}+\\frac{1}{2}=1.\n$$\n因此，$f$ 是一个有效的联合概率密度函数。\n\n计算边缘概率密度：\n$$\nf_{X}(x)=\\int_{0}^{1}(x+y)\\,dy=x+\\int_{0}^{1}y\\,dy=x+\\frac{1}{2},\\quad 0\\leq x\\leq 1,\n$$\n$$\nf_{Y}(y)=\\int_{0}^{1}(x+y)\\,dx=\\frac{1}{2}+y,\\quad 0\\leq y\\leq 1.\n$$\n\n计算期望值：\n$$\n\\mathbb{E}[X]=\\int_{0}^{1}x f_{X}(x)\\,dx=\\int_{0}^{1}x\\left(x+\\frac{1}{2}\\right)dx=\\int_{0}^{1}\\left(x^{2}+\\frac{1}{2}x\\right)dx=\\frac{1}{3}+\\frac{1}{4}=\\frac{7}{12},\n$$\n且根据对称性，$\\mathbb{E}[Y]=\\frac{7}{12}$。\n\n计算二阶矩和方差：\n$$\n\\mathbb{E}[X^{2}]=\\int_{0}^{1}x^{2} f_{X}(x)\\,dx=\\int_{0}^{1}x^{2}\\left(x+\\frac{1}{2}\\right)dx=\\int_{0}^{1}\\left(x^{3}+\\frac{1}{2}x^{2}\\right)dx=\\frac{1}{4}+\\frac{1}{6}=\\frac{5}{12},\n$$\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{5}{12}-\\left(\\frac{7}{12}\\right)^{2}=\\frac{60}{144}-\\frac{49}{144}=\\frac{11}{144}.\n$$\n根据对称性，$\\operatorname{Var}(Y)=\\frac{11}{144}$。\n\n计算交叉矩：\n$$\n\\mathbb{E}[XY]=\\int_{0}^{1}\\int_{0}^{1}xy(x+y)\\,dx\\,dy=\\int_{0}^{1}\\int_{0}^{1}\\left(x^{2}y+xy^{2}\\right)dx\\,dy.\n$$\n计算每一项：\n$$\n\\int_{0}^{1}\\int_{0}^{1}x^{2}y\\,dx\\,dy=\\int_{0}^{1}y\\left(\\int_{0}^{1}x^{2}\\,dx\\right)dy=\\int_{0}^{1}y\\cdot\\frac{1}{3}\\,dy=\\frac{1}{6},\n$$\n$$\n\\int_{0}^{1}\\int_{0}^{1}xy^{2}\\,dx\\,dy=\\int_{0}^{1}x\\left(\\int_{0}^{1}y^{2}\\,dy\\right)dx=\\int_{0}^{1}x\\cdot\\frac{1}{3}\\,dx=\\frac{1}{6}.\n$$\n因此，\n$$\n\\mathbb{E}[XY]=\\frac{1}{6}+\\frac{1}{6}=\\frac{1}{3}.\n$$\n\n计算协方差和皮尔逊相关系数：\n$$\n\\operatorname{Cov}(X,Y)=\\mathbb{E}[XY]-\\mathbb{E}[X]\\mathbb{E}[Y]=\\frac{1}{3}-\\left(\\frac{7}{12}\\right)^{2}=\\frac{48}{144}-\\frac{49}{144}=-\\frac{1}{144},\n$$\n$$\n\\rho(X,Y)=\\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)}\\sqrt{\\operatorname{Var}(Y)}}=\\frac{-\\frac{1}{144}}{\\sqrt{\\frac{11}{144}}\\sqrt{\\frac{11}{144}}}=\\frac{-\\frac{1}{144}}{\\frac{11}{144}}=-\\frac{1}{11}.\n$$", "answer": "$$ \\boxed{-\\frac{1}{11}} $$", "id": "1911199"}, {"introduction": "计算只是成功的一半，另一半在于解读。最后一个练习的灵感来自著名的安斯库姆四重奏（Anscombe's quartet），它是一个至关重要的警示，提醒我们注意汇总统计数据的局限性。它挑战你超越相关系数的数值本身，去理解为什么可视化分析对于任何数据科学家来说都是一个不可或缺的工具。[@problem_id:1911206]", "problem": "一位数据科学家负责分析四个不同的双变量数据集，分别标记为 I、II、III 和 IV。每个数据集都包含 11 个 $(x, y)$ 值的有序对。在进行初步统计分析后，她发现了一个显著的巧合：所有四个数据集产生了几乎完全相同的汇总统计量。具体来说，对于这四个数据集中的每一个：\n\n- $x$ 值的样本均值约为 9.0。\n- $x$ 值的样本方差约为 11.0。\n- $y$ 值的样本均值约为 7.5。\n- $x$ 和 $y$ 之间的皮尔逊相关系数约为 $r=0.82$。\n- 最小二乘线性回归线的方程约为 $y = 0.5x + 3.0$。\n\n尽管存在这些统计上的相似性，但对每个数据集的散点图进行目视检查后，揭示了四种截然不同的潜在模式：\n\n- **数据集 I：** 数据点分散的方式表明存在中等强度的正线性关系，各点聚集在回归线周围。\n- **数据集 II：** 数据点完全不遵循线性趋势。相反，它们形成了一条完美的、平滑的非线性曲线，类似于倒'U'形（一个开口向下的抛物线）。\n- **数据集 III：** 十一个数据点中有十个完全位于一条斜率不为 0.5 的直线上。第十一个点是一个显著的离群值，远离这条直线。\n- **数据集 IV：** 十一个数据点中有十个具有完全相同的 $x$ 值但 $y$ 值不同，形成一条垂直线。第十一个点具有大得多的 $x$ 值和相应的 $y$ 值，使其成为一个高影响点。\n\n基于这种情况，以下哪个陈述代表了统计学学生应该学到的最关键和最基本的教训？\n\nA. 大小接近 1 的皮尔逊相关系数（如 $r=0.82$）是两个变量之间存在强线性关系的可靠且充分的指标。\n\nB. 相同的汇总统计量必定是计算错误的结果，因为如此不同的图形模式不可能产生相同的统计输出。\n\nC. 汇总统计量，包括相关系数和回归线参数，可能具有高度误导性，应始终通过对数据的图形分析进行补充。\n\nD. 两个变量之间的非线性关系，如数据集 II 所示，将总是导致皮尔逊相关系数为零。\n\nE. 线性回归模型 $y = 0.5x + 3.0$ 仅对数据集 I 是一个合适且有意义的模型。", "solution": "我们形式化相关的汇总统计量，以阐明哪些是被确定的，哪些不是。设样本均值为 $\\bar{x}$ 和 $\\bar{y}$，样本方差为 $s_{x}^{2}$ 和 $s_{y}^{2}$，样本协方差为 $s_{xy}$。皮尔逊相关系数定义为\n$$\nr=\\frac{s_{xy}}{s_{x}s_{y}}.\n$$\n在 $y$ 对 $x$ 的简单线性回归中，最小二乘斜率和截距为\n$$\n\\hat{\\beta}_{1}=r\\frac{s_{y}}{s_{x}},\\qquad \\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x},\n$$\n所以拟合线为 $\\hat{y}=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x$。因此，元组 $(\\bar{x},s_{x}^{2},\\bar{y},r)$ 决定了 $(\\hat{\\beta}_{0},\\hat{\\beta}_{1})$。然而，这些汇总统计量仅依赖于一阶和二阶样本矩以及协方差，而不依赖于数据点的完整联合分布。\n\n因此，许多不同的数据集可以共享相同的 $\\bar{x}$、$s_{x}^{2}$、$\\bar{y}$ 和 $r$，从而共享相同的回归线，同时在其散点图中表现出非常不同的形状或结构。这是因为：\n- 系数 $r$ 仅通过协方差量化线性关联，并且可能由特定的数据点配置或少数高影响点驱动。\n- 最小二乘法中的回归线是通过最小化 $\\sum_{i=1}^{n}(y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1}x_{i})^{2}$ 来选择的，并且会受到杠杆点和离群值的严重影响，而不仅仅是受整体模式的影响。\n\n我们通过这些原则来解释所描述的四个数据集：\n- 数据集 I 呈现出一个大致线性的点云，因此一个正的 $r$ 和一条 $\\hat{\\beta}_{1}0$ 的直线 $\\hat{y}=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x$ 是对潜在模式有意义的总结。\n- 数据集 II 遵循一条没有线性趋势的平滑非线性曲线；然而，相同的 $(\\bar{x},s_{x}^{2},\\bar{y},r)$ 可能会出现，因为对于一般的非线性模式，协方差不一定为零，并且可以为正。因此，即使关系是非线性的，$r$ 也可能很大，这表明 $r$ 只衡量线性依赖关系。\n- 数据集 III 有十个点在一条斜率不同于报告的 $\\hat{\\beta}_{1}$ 的直线上，外加一个离群值。单个极端观测值可以改变 $s_{xy}$ 和 $s_{x}^{2}$，足以产生与其他数据集相同的 $r$ 和回归线，这表明最小二乘法和 $r$ 对离群值不具有稳健性。\n- 数据集 IV 有十个点共享相同的 $x$ 值，一个点具有很大的 $x$ 值。在简单回归中，观测值 $i$ 的杠杆值为 $h_{ii}=1/n+\\frac{(x_{i}-\\bar{x})^{2}}{\\sum_{j=1}^{n}(x_{j}-\\bar{x})^{2}}$，因此当大多数 $x_{j}$ 相等时，$\\sum_{j}(x_{j}-\\bar{x})^{2}$ 很小，而单个遥远的 $x_{i}$ 的 $h_{ii}$ 接近 1，从而主导了拟合和最终的 $r$。这表明高杠杆点可以迫使回归线和相关系数产生误导。\n\n我们现在评估这些选项：\n- 选项 A 是错误的。一个大的 $|r|$ 仅在线性关系未被离群值或杠杆点扭曲时才表示强线性关联；数据集 II、III 和 IV 反驳了仅凭 $r$ 就足够的观点。\n- 选项 B 是错误的。众所周知（例如，Anscombe’s quartet），不同的数据集可以共享相同的汇总统计量；这并非必然是计算错误。\n- 选项 C 是正确的。这些例子表明，汇总统计量，包括 $r$ 和回归线，可以掩盖非线性、离群值和杠杆效应；图表对于揭示潜在结构至关重要。\n- 选项 D 是错误的。非线性关系不一定会产生 $r=0$；$r=0$ 意味着没有线性相关，而不是没有关系。数据集 II 展示了一个具有显著正值 $r$ 的非线性关系。\n- 选项 E 不是最基本的教训。虽然所述的直线可能主要对数据集 I 有意义，但关键的启示更广泛：没有图形分析的数值摘要可能会产生误导。因此，C 是最关键和最基本的教训。\n\n因此，正确的选项是 C。", "answer": "$$ \\boxed{C} $$", "id": "1911206"}]}