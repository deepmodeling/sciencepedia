{"hands_on_practices": [{"introduction": "在许多现实世界的情境中，一个结果的总体不确定性源于多个层次的随机性。这个练习 [@problem_id:1401027] 模拟了一个经典的两阶段随机过程，帮助我们理解如何分解方差。通过计算一个依赖于初始随机选择的仿真任务的总方差，您将掌握在条件变量为离散时，如何运用全方差公式进行计算，并直观地理解方差的两个来源：内部方差的均值和条件均值的方差。", "problem": "一位数据科学家的计算机在运行一个复杂的模拟时有两种模式：一种是使用云资源的“快速”模式，另一种是仅使用机器自身处理器的“本地”模式。模式的选择是概率性的。设选择“快速”模式的概率为 $p$，其中 $0 < p < 1$。\n\n完成模拟所需的时间（以分钟为单位）是一个取决于模式的随机变量。\n- 如果选择“快速”模式，完成时间在区间 $[15, 20]$ 分钟上均匀分布。\n- 如果选择“本地”模式，完成时间在区间 $[20, 30]$ 分钟上均匀分布。\n\n设 $T$ 是表示完成模拟总时间的随机变量。请确定完成时间的总方差 $\\mathrm{Var}(T)$，并将其表示为关于概率 $p$ 的解析表达式。", "solution": "设 $R$ 为表示所选模式的随机变量。设 $R=F$ 代表“快速”模式，$R=L$ 代表“本地”模式。我们已知概率 $P(R=F) = p$ 和 $P(R=L) = 1-p$。\n\n题目要求模拟时间 $T$ 的总方差，这可以使用全方差公式（也称为 Eve 定律）来计算：\n$$ \\mathrm{Var}(T) = E[\\mathrm{Var}(T|R)] + \\mathrm{Var}(E[T|R]) $$\n\n我们将分别计算右侧的两项。\n\n首先，我们需要连续均匀分布 $U(a, b)$ 的均值和方差：\n均值：$E[U(a,b)] = \\frac{a+b}{2}$\n方差：$\\mathrm{Var}(U(a,b)) = \\frac{(b-a)^2}{12}$\n\n对于“快速”模式，时间 $T_F$ 服从 $U(15, 20)$ 分布。\n条件均值为 $E[T|R=F] = \\frac{15+20}{2} = \\frac{35}{2}$。\n条件方差为 $\\mathrm{Var}(T|R=F) = \\frac{(20-15)^2}{12} = \\frac{5^2}{12} = \\frac{25}{12}$。\n\n对于“本地”模式，时间 $T_L$ 服从 $U(20, 30)$ 分布。\n条件均值为 $E[T|R=L] = \\frac{20+30}{2} = \\frac{50}{2} = 25$。\n条件方差为 $\\mathrm{Var}(T|R=L) = \\frac{(30-20)^2}{12} = \\frac{10^2}{12} = \\frac{100}{12}$。\n\n**步骤 1：计算 $E[\\mathrm{Var}(T|R)]$ (条件方差的均值)**\n\n随机变量 $\\mathrm{Var}(T|R)$ 以概率 $p$ 取值 $\\frac{25}{12}$，以概率 $1-p$ 取值 $\\frac{100}{12}$。其期望值为：\n$$ E[\\mathrm{Var}(T|R)] = \\mathrm{Var}(T|R=F)P(R=F) + \\mathrm{Var}(T|R=L)P(R=L) $$\n$$ E[\\mathrm{Var}(T|R)] = \\left(\\frac{25}{12}\\right)p + \\left(\\frac{100}{12}\\right)(1-p) $$\n$$ E[\\mathrm{Var}(T|R)] = \\frac{25p + 100 - 100p}{12} = \\frac{100 - 75p}{12} $$\n\n**步骤 2：计算 $\\mathrm{Var}(E[T|R])$ (条件均值的方差)**\n\n随机变量 $E[T|R]$ 以概率 $p$ 取值 $\\frac{35}{2}$，以概率 $1-p$ 取值 $25$。\n为了求其方差，我们首先求其期望和其平方的期望。\n\n$E[T|R]$ 的期望即为总期望 $E[T]$：\n$$ E[E[T|R]] = E[T|R=F]P(R=F) + E[T|R=L]P(R=L) $$\n$$ E[E[T|R]] = \\left(\\frac{35}{2}\\right)p + (25)(1-p) = \\frac{35}{2}p + 25 - 25p = 25 - \\frac{15}{2}p $$\n\n$(E[T|R])^2$ 的期望为：\n$$ E[(E[T|R])^2] = (E[T|R=F])^2 P(R=F) + (E[T|R=L])^2 P(R=L) $$\n$$ E[(E[T|R])^2] = \\left(\\frac{35}{2}\\right)^2 p + (25)^2 (1-p) $$\n$$ E[(E[T|R])^2] = \\frac{1225}{4}p + 625(1-p) = \\frac{1225p + 2500 - 2500p}{4} = \\frac{2500 - 1275p}{4} $$\n\n现在，使用方差公式 $\\mathrm{Var}(X) = E[X^2] - (E[X])^2$：\n$$ \\mathrm{Var}(E[T|R]) = E[(E[T|R])^2] - (E[E[T|R]])^2 $$\n$$ \\mathrm{Var}(E[T|R]) = \\left(\\frac{2500 - 1275p}{4}\\right) - \\left(25 - \\frac{15}{2}p\\right)^2 $$\n$$ \\mathrm{Var}(E[T|R]) = \\frac{2500 - 1275p}{4} - \\left(625 - 2 \\cdot 25 \\cdot \\frac{15}{2}p + \\left(\\frac{15}{2}p\\right)^2\\right) $$\n$$ \\mathrm{Var}(E[T|R]) = \\frac{2500 - 1275p}{4} - \\left(625 - 375p + \\frac{225}{4}p^2\\right) $$\n为了进行减法，我们将所有项通分，分母为 4：\n$$ \\mathrm{Var}(E[T|R]) = \\frac{2500 - 1275p}{4} - \\frac{2500 - 1500p + 225p^2}{4} $$\n$$ \\mathrm{Var}(E[T|R]) = \\frac{(2500 - 1275p) - (2500 - 1500p + 225p^2)}{4} $$\n$$ \\mathrm{Var}(E[T|R]) = \\frac{2500 - 1275p - 2500 + 1500p - 225p^2}{4} = \\frac{225p - 225p^2}{4} $$\n\n**步骤 3：合并两项**\n\n现在我们将步骤 1 和步骤 2 的结果相加，以求得总方差 $\\mathrm{Var}(T)$。\n$$ \\mathrm{Var}(T) = E[\\mathrm{Var}(T|R)] + \\mathrm{Var}(E[T|R]) $$\n$$ \\mathrm{Var}(T) = \\frac{100 - 75p}{12} + \\frac{225p - 225p^2}{4} $$\n为了将这些分数相加，我们找到一个公分母，即 12。\n$$ \\mathrm{Var}(T) = \\frac{100 - 75p}{12} + \\frac{3(225p - 225p^2)}{12} $$\n$$ \\mathrm{Var}(T) = \\frac{100 - 75p + 675p - 675p^2}{12} $$\n$$ \\mathrm{Var}(T) = \\frac{-675p^2 + 600p + 100}{12} $$\n我们可以从分子中提取公因数 25：\n$$ \\mathrm{Var}(T) = \\frac{25(-27p^2 + 24p + 4)}{12} $$\n最后两个表达式都是有效的最终形式。我们将使用展开的多项式形式。", "answer": "$$\\boxed{\\frac{-675p^2 + 600p + 100}{12}}$$", "id": "1401027"}, {"introduction": "在许多模型中，我们通常假设的某些参数（如成功率或缺陷率）并非固定不变，其本身就存在不确定性。本题 [@problem_id:1929483] 探讨的正是这种情况，它将一个生产过程中的缺陷概率视为一个连续随机变量。这个练习将引导您掌握当条件变量是连续时如何应用全方差公式，这是从离散概率过渡到更高级的、基于微积分的统计模型的关键一步。", "problem": "在一家半导体制造厂，一种新的制造工艺正在进行测试。由于环境条件（如温度和湿度）的不可预测的日常变化，任何给定微芯片有缺陷的概率 $\\Theta$ 不是一个固定的常数。相反，它被认为是一个随机变量。根据类似工艺的历史数据，工程师们将 $\\Theta$ 建模为在区间 $[0, 1]$ 上均匀分布。\n\n一位质量控制工程师从一天的生产批次中抽取了 $n$ 个芯片。令 $X$ 为表示在该批次中发现的有缺陷芯片总数的随机变量。假设每个芯片的缺陷状态相互独立，并在给定当天 $\\Theta$ 值的情况下，确定 $X$ 的方差。\n\n请用 $n$ 来表示你的答案。", "solution": "设 $X$ 为一批大小为 $n$ 的芯片中有缺陷芯片数量的随机变量，设 $\\Theta$ 为单个芯片有缺陷的概率的随机变量。\n\n问题陈述 $\\Theta$ 的分布是在区间 $[0, 1]$ 上的连续均匀分布。我们记作 $\\Theta \\sim \\mathrm{Uniform}(0, 1)$。$\\Theta$ 的概率密度函数 (PDF) 为 $f(\\theta) = 1$ (对于 $0 \\le \\theta \\le 1$)，其他情况下 $f(\\theta) = 0$。\n\n在缺陷概率为特定值 $\\Theta = \\theta$ 的条件下，一批 $n$ 次独立试验中有缺陷的芯片数量 $X$ 服从二项分布。我们记作 $X | (\\Theta = \\theta) \\sim \\mathrm{Binomial}(n, \\theta)$。\n\n为了求 $X$ 的无条件方差，记作 $\\mathrm{Var}(X)$，我们使用全方差公式（也称为 Eve 定律）：\n$$\n\\mathrm{Var}(X) = E[\\mathrm{Var}(X|\\Theta)] + \\mathrm{Var}(E[X|\\Theta])\n$$\n我们需要分别计算右侧的两项。\n\n首先，我们求给定 $\\Theta$ 时 $X$ 的条件期望和条件方差。对于一个随机变量 $Y \\sim \\mathrm{Binomial}(n, p)$，我们知道 $E[Y] = np$ 和 $\\mathrm{Var}(Y) = np(1-p)$。将此应用于我们的条件分布：\n1.  给定 $\\Theta$ 时 $X$ 的条件期望是 $E[X|\\Theta] = n\\Theta$。\n2.  给定 $\\Theta$ 时 $X$ 的条件方差是 $\\mathrm{Var}(X|\\Theta) = n\\Theta(1-\\Theta) = n\\Theta - n\\Theta^2$。\n\n现在，我们来计算全方差公式的两项。\n\n第一项是 $E[\\mathrm{Var}(X|\\Theta)]$。这是条件方差的期望，是关于 $\\Theta$ 的分布求得的。\n$$\nE[\\mathrm{Var}(X|\\Theta)] = E[n\\Theta - n\\Theta^2] = nE[\\Theta] - nE[\\Theta^2]\n$$\n我们需要求出 $\\mathrm{Uniform}(0, 1)$ 分布的前两阶矩。\n$\\Theta$ 的期望值为：\n$$\nE[\\Theta] = \\int_0^1 \\theta f(\\theta) \\,d\\theta = \\int_0^1 \\theta \\cdot 1 \\,d\\theta = \\left[\\frac{\\theta^2}{2}\\right]_0^1 = \\frac{1}{2}\n$$\n$\\Theta^2$ 的期望值为：\n$$\nE[\\Theta^2] = \\int_0^1 \\theta^2 f(\\theta) \\,d\\theta = \\int_0^1 \\theta^2 \\cdot 1 \\,d\\theta = \\left[\\frac{\\theta^3}{3}\\right]_0^1 = \\frac{1}{3}\n$$\n将这些值代回 $E[\\mathrm{Var}(X|\\Theta)]$ 的表达式中：\n$$\nE[\\mathrm{Var}(X|\\Theta)] = n\\left(\\frac{1}{2}\\right) - n\\left(\\frac{1}{3}\\right) = n\\left(\\frac{3-2}{6}\\right) = \\frac{n}{6}\n$$\n\n第二项是 $\\mathrm{Var}(E[X|\\Theta])$。这是条件期望的方差。\n$$\n\\mathrm{Var}(E[X|\\Theta]) = \\mathrm{Var}(n\\Theta)\n$$\n使用性质 $\\mathrm{Var}(aY) = a^2\\mathrm{Var}(Y)$，我们有：\n$$\n\\mathrm{Var}(n\\Theta) = n^2\\mathrm{Var}(\\Theta)\n$$\n$\\Theta$ 的方差由 $\\mathrm{Var}(\\Theta) = E[\\Theta^2] - (E[\\Theta])^2$ 给出。使用我们已经计算出的矩：\n$$\n\\mathrm{Var}(\\Theta) = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12}\n$$\n现在，将此代入 $\\mathrm{Var}(E[X|\\Theta])$ 的表达式中：\n$$\n\\mathrm{Var}(E[X|\\Theta]) = n^2 \\left(\\frac{1}{12}\\right) = \\frac{n^2}{12}\n$$\n\n最后，我们将这两项相加，求出 $X$ 的总方差：\n$$\n\\mathrm{Var}(X) = E[\\mathrm{Var}(X|\\Theta)] + \\mathrm{Var}(E[X|\\Theta]) = \\frac{n}{6} + \\frac{n^2}{12}\n$$\n为了简化，我们找到一个公分母：\n$$\n\\mathrm{Var}(X) = \\frac{2n}{12} + \\frac{n^2}{12} = \\frac{n^2 + 2n}{12}\n$$\n对分子进行因式分解，得到最终表达式：\n$$\n\\mathrm{Var}(X) = \\frac{n(n+2)}{12}\n$$", "answer": "$$\\boxed{\\frac{n(n+2)}{12}}$$", "id": "1929483"}, {"introduction": "全方差公式的威力在于它能够处理层层嵌套的复杂随机系统。这个挑战性的练习 [@problem_id:1929500] 将几何问题与分层概率模型相结合，淋漓尽致地展现了这一点。您将计算一个圆中随机弦长的方差，而这个圆的半径本身也是一个随机变量。通过解决这个问题，您将学会如何系统地分解和分析包含几何随机性在内的多源不确定性。", "problem": "在一个宇宙弦圈的统计模型中，这些圈被理想化为圆形。给定一个圈的半径，记为 $R$，它不是一个固定的常数，而其本身是一个随机变量。支配圈形成的随机过程使得半径的平方 $R^2$ 服从一个指数分布，其速率参数为已知的 $\\lambda > 0$。\n\n对于任意一个这样的圆形圈，沿其周长独立且均匀随机地选择两个点。令 $L$ 为表示连接这两点的直线弦长的随机变量。\n\n您的任务是确定弦长 $L$ 的理论方差 $\\mathrm{Var}(L)$。请用参数 $\\lambda$ 和常数 $\\pi$ 将您的最终答案表示为单个闭式解析表达式。", "solution": "令 $R$ 为随机半径，令 $X=R^{2}$。根据假设，$X\\sim \\mathrm{Exp}(\\lambda)$，速率为 $\\lambda>0$，因此其密度函数为 $f_{X}(x)=\\lambda \\exp(-\\lambda x)$，其中 $x\\geq 0$。\n\n给定一个固定半径 $R=r$，在圆周上选取两个独立的均匀随机点。令 $\\Theta$ 为它们之间的较小圆心角。因为如果 $U,V$ 是 $[0,2\\pi)$ 上的独立均匀随机变量，那么 $W=U-V$ 模 $2\\pi$ 是 $[0,2\\pi)$ 上的均匀随机变量，且 $\\Theta=\\min\\{W,2\\pi-W\\}$，由此可知 $\\Theta$ 在 $[0,\\pi]$ 上服从均匀分布，其密度为 $1/\\pi$。弦长为\n$$\nL=2r\\sin\\!\\left(\\frac{\\Theta}{2}\\right).\n$$\n因此，\n$$\n\\mathbb{E}[L\\mid R=r]=2r\\,\\mathbb{E}\\!\\left[\\sin\\!\\left(\\frac{\\Theta}{2}\\right)\\right],\\quad \\mathbb{E}[L^{2}\\mid R=r]=4r^{2}\\,\\mathbb{E}\\!\\left[\\sin^{2}\\!\\left(\\frac{\\Theta}{2}\\right)\\right].\n$$\n当 $\\Theta\\sim \\mathrm{Unif}(0,\\pi)$ 时，计算\n$$\n\\mathbb{E}\\!\\left[\\sin\\!\\left(\\frac{\\Theta}{2}\\right)\\right]=\\frac{1}{\\pi}\\int_{0}^{\\pi}\\sin\\!\\left(\\frac{\\theta}{2}\\right)\\,d\\theta=\\frac{2}{\\pi},\n$$\n和\n$$\n\\mathbb{E}\\!\\left[\\sin^{2}\\!\\left(\\frac{\\Theta}{2}\\right)\\right]=\\frac{1}{\\pi}\\int_{0}^{\\pi}\\frac{1-\\cos\\theta}{2}\\,d\\theta=\\frac{1}{2}.\n$$\n因此，\n$$\n\\mathbb{E}[L\\mid R=r]=\\frac{4r}{\\pi},\\qquad \\mathbb{E}[L^{2}\\mid R=r]=2r^{2}.\n$$\n\n根据全期望定律，\n$$\n\\mathbb{E}[L]=\\mathbb{E}\\big[\\mathbb{E}[L\\mid R]\\big]=\\frac{4}{\\pi}\\,\\mathbb{E}[R],\\qquad \\mathbb{E}[L^{2}]=\\mathbb{E}\\big[\\mathbb{E}[L^{2}\\mid R]\\big]=2\\,\\mathbb{E}[R^{2}].\n$$\n由于 $X=R^{2}\\sim \\mathrm{Exp}(\\lambda)$，其分数矩对于 $\\alpha>-1$ 满足，\n$$\n\\mathbb{E}[X^{\\alpha}]=\\int_{0}^{\\infty}x^{\\alpha}\\lambda \\exp(-\\lambda x)\\,dx=\\lambda^{-\\alpha}\\Gamma(\\alpha+1).\n$$\n取 $\\alpha=\\frac{1}{2}$，得到\n$$\n\\mathbb{E}[R]=\\mathbb{E}[X^{1/2}]=\\lambda^{-1/2}\\Gamma\\!\\left(\\frac{3}{2}\\right)=\\lambda^{-1/2}\\frac{\\sqrt{\\pi}}{2},\n$$\n取 $\\alpha=1$ 时，\n$$\n\\mathbb{E}[R^{2}]=\\mathbb{E}[X]=\\frac{1}{\\lambda}.\n$$\n因此，\n$$\n\\mathbb{E}[L]=\\frac{4}{\\pi}\\cdot \\frac{\\sqrt{\\pi}}{2}\\lambda^{-1/2}=\\frac{2}{\\sqrt{\\pi}}\\lambda^{-1/2},\\qquad \\mathbb{E}[L^{2}]=\\frac{2}{\\lambda}.\n$$\n方差为\n$$\n\\mathrm{Var}(L)=\\mathbb{E}[L^{2}]-(\\mathbb{E}[L])^{2}=\\frac{2}{\\lambda}-\\left(\\frac{2}{\\sqrt{\\pi}}\\lambda^{-1/2}\\right)^{2}=\\frac{2}{\\lambda}-\\frac{4}{\\pi\\lambda}=\\frac{2}{\\lambda}\\left(1-\\frac{2}{\\pi}\\right).\n$$\n这是一个用 $\\lambda$ 和 $\\pi$ 表示的闭式表达式。", "answer": "$$\\boxed{\\frac{2}{\\lambda}\\left(1-\\frac{2}{\\pi}\\right)}$$", "id": "1929500"}]}