{"hands_on_practices": [{"introduction": "掌握了理论基础后，让我们通过一个基础练习来巩固雅可比变换法。这个练习 [@problem_id:1408113] 将探讨一个涉及独立随机变量的简单一对一变换。它不仅清晰地展示了雅可比行列式方法的核心步骤，还揭示了柯西分布一个有趣的特性：其在倒数变换下的不变性。", "problem": "在信号处理的某一特定分支中，信号有时会通过遵循柯西分布的随机变量来建模。考虑两个独立信号，其随机振幅 $X$ 和 $Y$ 均服从标准柯西分布。标准柯西随机变量 $Z$ 的概率密度函数 (PDF) 由下式给出\n$$f_Z(z) = \\frac{1}{\\pi(1+z^2)}, \\quad \\text{for } -\\infty < z < \\infty$$\n通过取原始信号振幅的倒数生成一组新的变量 $U$ 和 $V$，使得 $U = 1/X$ 和 $V = 1/Y$。求变换后变量 $U$ 和 $V$ 的联合概率密度函数 $f_{U,V}(u,v)$。", "solution": "我们按照雅可比方法的步骤进行求解。\n\n**步骤1：确定联合概率密度函数和变换**\n由于 $X$ 和 $Y$ 是独立的标准柯西随机变量，它们的联合概率密度函数 (PDF) 是各自 PDF 的乘积：\n$$\nf_{X,Y}(x,y) = f_X(x) f_Y(y) = \\frac{1}{\\pi(1+x^2)} \\cdot \\frac{1}{\\pi(1+y^2)} = \\frac{1}{\\pi^2(1+x^2)(1+y^2)}\n$$\n其支撑域为 $x \\in (-\\infty, \\infty)$ 和 $y \\in (-\\infty, \\infty)$。\n变换为 $U = 1/X$ 和 $V = 1/Y$。\n\n**步骤2：求解反向变换**\n从变换方程中，我们可以直接得到反向变换：\n$$\nx = \\frac{1}{u}\n$$\n$$\ny = \\frac{1}{v}\n$$\n\n**步骤3：计算雅可比行列式**\n我们计算反向变换的雅可比行列式 $J$：\n$$\nJ = \\det\\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix} = \\det\\begin{pmatrix} -1/u^2 & 0 \\\\ 0 & -1/v^2 \\end{pmatrix} = \\left(-\\frac{1}{u^2}\\right) \\left(-\\frac{1}{v^2}\\right) = \\frac{1}{u^2 v^2}\n$$\n雅可比行列式的绝对值为 $|J| = \\frac{1}{u^2 v^2}$。\n\n**步骤4：应用变量变换公式**\n新的联合 PDF $f_{U,V}(u,v)$ 由以下公式给出：\n$$\nf_{U,V}(u,v) = f_{X,Y}(x(u,v), y(u,v)) |J| = f_{X,Y}\\left(\\frac{1}{u}, \\frac{1}{v}\\right) \\frac{1}{u^2 v^2}\n$$\n将反向变换代入 $f_{X,Y}(x,y)$：\n$$\nf_{U,V}(u,v) = \\frac{1}{\\pi^2(1+(1/u)^2)(1+(1/v)^2)} \\cdot \\frac{1}{u^2 v^2}\n$$\n现在我们简化表达式：\n$$\nf_{U,V}(u,v) = \\frac{1}{\\pi^2\\left(\\frac{u^2+1}{u^2}\\right)\\left(\\frac{v^2+1}{v^2}\\right)} \\cdot \\frac{1}{u^2 v^2} = \\frac{u^2 v^2}{\\pi^2(u^2+1)(v^2+1)} \\cdot \\frac{1}{u^2 v^2} = \\frac{1}{\\pi^2(1+u^2)(1+v^2)}\n$$\n由于 $x,y$ 的范围是 $(-\\infty, \\infty)$，新变量 $u,v$ 的范围也是 $(-\\infty, \\infty)$（不包括技术上的点0）。因此，新的联合概率密度函数为：\n$$\nf_{U,V}(u,v) = \\frac{1}{\\pi^2(1+u^2)(1+v^2)}, \\quad \\text{for } -\\infty < u < \\infty, -\\infty < v < \\infty\n$$\n这表明 $U$ 和 $V$ 也是独立的标准柯西随机变量。", "answer": "$$\\boxed{\\frac{1}{\\pi^{2}\\left(1+u^{2}\\right)\\left(1+v^{2}\\right)}}$$", "id": "1408113"}, {"introduction": "在掌握了一对一变换之后，我们来处理一个更复杂但常见的情形：“多对一”变换。在这个问题中 [@problem_id:1408158]，新坐标系中的一个点对应于原始坐标系中的多个点。这个练习将教你如何通过对所有原像 (pre-images) 的贡献求和来正确地计算联合概率密度函数。", "problem": "设 $X$ 和 $Y$ 是独立的随机变量，均服从标准正态分布。我们通过以下变换定义两个新的随机变量 $U$ 和 $V$：\n$$U = X^2$$\n$$V = X+Y$$\n求联合概率密度函数（PDF）$f_{U,V}(u,v)$，其定义域为 $u > 0$ 且 $v$ 为任意实数。", "solution": "设 $X$ 和 $Y$ 是独立的标准正态随机变量，其联合概率密度函数为：\n$$\nf_{X,Y}(x,y)=\\frac{1}{2\\pi}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2}\\right)\n$$\n变换为 $u=x^2$ 和 $v=x+y$。这是一个多对一变换。对于任意给定的 $(u,v)$ 且 $u > 0$，我们可以求解 $(x,y)$。\n从 $u=x^2$ 可得 $x = \\pm\\sqrt{u}$。这导致了两个原像（或两个分支）：\n1.  $x_1 = \\sqrt{u}$, $y_1 = v - x_1 = v - \\sqrt{u}$\n2.  $x_2 = -\\sqrt{u}$, $y_2 = v - x_2 = v + \\sqrt{u}$\n\n我们需要为每个分支计算雅可比行列式，然后将贡献相加。公式为 $f_{U,V}(u,v) = \\sum_{i=1,2} f_{X,Y}(x_i(u,v), y_i(u,v)) |J_i|$，其中 $J_i$ 是第 $i$ 个反向变换的雅可比行列式。\n\n**分支 1： $x = \\sqrt{u}$, $y = v - \\sqrt{u}$**\n反向变换的雅可比行列式 $J_1$ 为：\n$$\nJ_1 = \\det\\begin{pmatrix} \\frac{\\partial x_1}{\\partial u} & \\frac{\\partial x_1}{\\partial v} \\\\ \\frac{\\partial y_1}{\\partial u} & \\frac{\\partial y_1}{\\partial v} \\end{pmatrix} = \\det\\begin{pmatrix} \\frac{1}{2\\sqrt{u}} & 0 \\\\ -\\frac{1}{2\\sqrt{u}} & 1 \\end{pmatrix} = \\frac{1}{2\\sqrt{u}}\n$$\n$|J_1| = \\frac{1}{2\\sqrt{u}}$。\n\n**分支 2： $x = -\\sqrt{u}$, $y = v + \\sqrt{u}$**\n反向变换的雅可比行列式 $J_2$ 为：\n$$\nJ_2 = \\det\\begin{pmatrix} \\frac{\\partial x_2}{\\partial u} & \\frac{\\partial x_2}{\\partial v} \\\\ \\frac{\\partial y_2}{\\partial u} & \\frac{\\partial y_2}{\\partial v} \\end{pmatrix} = \\det\\begin{pmatrix} -\\frac{1}{2\\sqrt{u}} & 0 \\\\ \\frac{1}{2\\sqrt{u}} & 1 \\end{pmatrix} = -\\frac{1}{2\\sqrt{u}}\n$$\n$|J_2| = \\frac{1}{2\\sqrt{u}}$。\n\n现在，我们计算两个分支对 $f_{U,V}(u,v)$ 的贡献：\n对于分支 1，指数项 $x_1^2+y_1^2$ 为：\n$x_1^2+y_1^2 = (\\sqrt{u})^2 + (v-\\sqrt{u})^2 = u + v^2 - 2v\\sqrt{u} + u = 2u + v^2 - 2v\\sqrt{u}$。\n贡献为：$f_{X,Y}(x_1, y_1)|J_1| = \\frac{1}{2\\pi} \\exp\\left(-\\frac{2u + v^2 - 2v\\sqrt{u}}{2}\\right) \\frac{1}{2\\sqrt{u}}$。\n\n对于分支 2，指数项 $x_2^2+y_2^2$ 为：\n$x_2^2+y_2^2 = (-\\sqrt{u})^2 + (v+\\sqrt{u})^2 = u + v^2 + 2v\\sqrt{u} + u = 2u + v^2 + 2v\\sqrt{u}$。\n贡献为：$f_{X,Y}(x_2, y_2)|J_2| = \\frac{1}{2\\pi} \\exp\\left(-\\frac{2u + v^2 + 2v\\sqrt{u}}{2}\\right) \\frac{1}{2\\sqrt{u}}$。\n\n将两个贡献相加：\n$$\nf_{U,V}(u,v) = \\frac{1}{4\\pi\\sqrt{u}} \\left[ \\exp\\left(-u - \\frac{v^2}{2} + v\\sqrt{u}\\right) + \\exp\\left(-u - \\frac{v^2}{2} - v\\sqrt{u}\\right) \\right]\n$$\n$$\nf_{U,V}(u,v) = \\frac{1}{4\\pi\\sqrt{u}} \\exp\\left(-u - \\frac{v^2}{2}\\right) \\left[ e^{v\\sqrt{u}} + e^{-v\\sqrt{u}} \\right]\n$$\n使用双曲余弦函数的定义 $\\cosh(z) = \\frac{e^z + e^{-z}}{2}$，我们得到：\n$$\nf_{U,V}(u,v) = \\frac{1}{4\\pi\\sqrt{u}} \\exp\\left(-u - \\frac{v^2}{2}\\right) \\left[ 2\\cosh(v\\sqrt{u}) \\right]\n$$\n$$\nf_{U,V}(u,v) = \\frac{1}{2\\pi\\sqrt{u}} \\exp\\left(-u - \\frac{v^2}{2}\\right) \\cosh(v\\sqrt{u})\n$$\n该公式在支撑域 $u>0, v \\in \\mathbb{R}$ 上有效。对于 $u \\le 0$，$f_{U,V}(u,v)=0$。", "answer": "$$\\boxed{\\frac{1}{2\\pi\\sqrt{u}}\\,\\exp\\!\\left(-u-\\frac{v^{2}}{2}\\right)\\,\\cosh\\!\\left(v\\sqrt{u}\\right)\\text{，对于 }u>0,\\ v\\in\\mathbb{R}}$$", "id": "1408158"}, {"introduction": "最后，我们来看一个综合性更强的问题，它更贴近真实世界中变量并非总是独立或简单定义的情形。这个练习 [@problem_id:1408142] 将条件分布的概念与坐标系变换相结合。你需要先构建联合分布，然后再进行变换，这将考验你对整个流程的深入理解。", "problem": "设 $X$ 和 $Y$ 为两个连续随机变量。变量 $X$ 在区间 $[0, \\pi]$ 上服从均匀分布。在给定 $X=x$ 的条件下，$Y$ 的条件分布是速率参数为 $\\lambda(x) = \\sin(x)$ 的指数分布。\n\n两个新的随机变量 $U$ 和 $V$ 通过以下变换定义：\n$$U = Y \\sin(X)$$\n$$V = Y \\cos(X)$$\n\n求随机变量 $U$ 和 $V$ 的联合概率密度函数 (PDF)，记为 $f_{U,V}(u,v)$。你的最终答案应该是函数 $f_{U,V}(u,v)$ 在其支撑域上的一个单一闭式解析表达式。", "solution": "求解过程首先确定 $X$ 和 $Y$ 的联合概率密度函数 (PDF)，然后使用雅可比方法应用变量变换公式。\n\n**步骤1：求 X 和 Y 的联合概率密度函数**\n\n$X$ 在 $[0, \\pi]$ 上服从均匀分布，其概率密度函数为：\n$$f_X(x) = \\begin{cases} \\frac{1}{\\pi} & \\text{if } 0 \\le x \\le \\pi \\\\ 0 & \\text{otherwise} \\end{cases}$$\n\n给定 $X=x$ 时，$Y$ 的条件概率密度函数是速率为 $\\lambda(x) = \\sin(x)$ 的指数分布。速率参数必须为正，因此我们考虑 $x \\in (0, \\pi)$。$X$ 取值为 $0$ 或 $\\pi$ 的概率为零，所以这个限制不影响计算。对于 $x \\in (0, \\pi)$，条件概率密度函数为：\n$$f_{Y|X}(y|x) = \\sin(x) \\exp(-y \\sin(x)), \\quad \\text{for } y > 0$$\n\n联合概率密度函数 $f_{X,Y}(x,y)$ 是 $X$ 的边缘概率密度函数与给定 $X$ 时 $Y$ 的条件概率密度函数的乘积：\n$$f_{X,Y}(x,y) = f_{Y|X}(y|x) f_X(x)$$\n$$f_{X,Y}(x,y) = \\frac{\\sin(x)}{\\pi} \\exp(-y \\sin(x))$$\n该联合概率密度函数的支撑域是区域 $S_{X,Y} = \\{ (x,y) \\in \\mathbb{R}^2 \\mid 0 < x < \\pi, y > 0 \\}$。\n\n**步骤2：定义逆变换**\n\n从 $(X,Y)$ 到 $(U,V)$ 的变换由以下公式给出：\n$U = Y \\sin(X)$\n$V = Y \\cos(X)$\n\n我们需要找到逆变换，即用 $U$ 和 $V$ 表示 $X$ 和 $Y$。\n首先，我们来求 $Y$。将两个方程平方并相加，我们得到：\n$$U^2 + V^2 = (Y \\sin(X))^2 + (Y \\cos(X))^2 = Y^2 (\\sin^2(X) + \\cos^2(X)) = Y^2$$\n因为 $Y > 0$，我们可以写出：\n$$Y = \\sqrt{U^2 + V^2}$$\n\n接下来，我们求 $X$。我们有 $\\cos(X) = \\frac{V}{Y} = \\frac{V}{\\sqrt{U^2 + V^2}}$。由于 $X \\in (0, \\pi)$，反余弦函数将唯一确定 $X$。\n$$X = \\arccos\\left(\\frac{V}{\\sqrt{U^2 + V^2}}\\right)$$\n\n因此，逆变换 $h(u,v) = (x,y)$ 为：\n$x = h_1(u,v) = \\arccos\\left(\\frac{v}{\\sqrt{u^2 + v^2}}\\right)$\n$y = h_2(u,v) = \\sqrt{u^2 + v^2}$\n\n**步骤3：确定 (U,V) 的支撑域**\n\n$(X,Y)$ 的支撑域是 $0 < X < \\pi$ 和 $Y > 0$。\n从 $U = Y \\sin(X)$：因为对于 $X \\in (0, \\pi)$，有 $Y > 0$ 和 $\\sin(X) > 0$，所以我们必须有 $U > 0$。\n从 $V = Y \\cos(X)$：因为 $Y > 0$，$V$ 的符号由 $\\cos(X)$ 决定。当 $X$ 从 $0$ 变化到 $\\pi$ 时，$\\cos(X)$ 从 $1$ 变化到 $-1$。因此，$V$ 可以取任何实数值。\n$(U,V)$ 的支撑域是右半平面：$S_{U,V} = \\{ (u,v) \\in \\mathbb{R}^2 \\mid u > 0 \\}$。\n\n**步骤4：计算逆变换的雅可比行列式**\n\n雅可比行列式 $J$ 由 $J = \\det\\left(\\frac{\\partial(x,y)}{\\partial(u,v)}\\right) = \\det \\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix}$ 给出。\n\n首先，我们求 $y = \\sqrt{u^2 + v^2}$ 的偏导数：\n$\\frac{\\partial y}{\\partial u} = \\frac{u}{\\sqrt{u^2 + v^2}}$\n$\\frac{\\partial y}{\\partial v} = \\frac{v}{\\sqrt{u^2 + v^2}}$\n\n接下来，我们求 $x = \\arccos\\left(\\frac{v}{\\sqrt{u^2 + v^2}}\\right)$ 的偏导数。令 $z = \\frac{v}{\\sqrt{u^2+v^2}}$。\n使用链式法则和 $\\frac{d}{dz}(\\arccos(z)) = \\frac{-1}{\\sqrt{1-z^2}}$:\n$\\frac{\\partial x}{\\partial u} = \\frac{-1}{\\sqrt{1-z^2}} \\frac{\\partial z}{\\partial u}$\n$1 - z^2 = 1 - \\frac{v^2}{u^2+v^2} = \\frac{u^2}{u^2+v^2}$。由于 $u>0$，$\\sqrt{1-z^2} = \\frac{u}{\\sqrt{u^2+v^2}}$。\n$\\frac{\\partial z}{\\partial u} = v \\frac{\\partial}{\\partial u}(u^2+v^2)^{-1/2} = v \\left(-\\frac{1}{2}(u^2+v^2)^{-3/2}(2u)\\right) = \\frac{-uv}{(u^2+v^2)^{3/2}}$。\n$\\frac{\\partial x}{\\partial u} = -\\frac{\\sqrt{u^2+v^2}}{u} \\left(\\frac{-uv}{(u^2+v^2)^{3/2}}\\right) = \\frac{v}{u^2+v^2}$。\n\n$\\frac{\\partial x}{\\partial v} = \\frac{-1}{\\sqrt{1-z^2}} \\frac{\\partial z}{\\partial v} = -\\frac{\\sqrt{u^2+v^2}}{u} \\frac{\\partial z}{\\partial v}$\n$\\frac{\\partial z}{\\partial v} = \\frac{1 \\cdot \\sqrt{u^2+v^2} - v \\cdot \\frac{v}{\\sqrt{u^2+v^2}}}{u^2+v^2} = \\frac{\\frac{u^2+v^2-v^2}{\\sqrt{u^2+v^2}}}{u^2+v^2} = \\frac{u^2}{(u^2+v^2)^{3/2}}$。\n$\\frac{\\partial x}{\\partial v} = -\\frac{\\sqrt{u^2+v^2}}{u} \\left(\\frac{u^2}{(u^2+v^2)^{3/2}}\\right) = \\frac{-u}{u^2+v^2}$。\n\n现在，我们计算行列式：\n$$J = \\det \\begin{pmatrix} \\frac{v}{u^2+v^2} & \\frac{-u}{u^2+v^2} \\\\ \\frac{u}{\\sqrt{u^2+v^2}} & \\frac{v}{\\sqrt{u^2+v^2}} \\end{pmatrix} = \\left(\\frac{v}{u^2+v^2}\\right)\\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right) - \\left(\\frac{-u}{u^2+v^2}\\right)\\left(\\frac{u}{\\sqrt{u^2+v^2}}\\right)$$\n$$J = \\frac{v^2}{(u^2+v^2)^{3/2}} + \\frac{u^2}{(u^2+v^2)^{3/2}} = \\frac{u^2+v^2}{(u^2+v^2)^{3/2}} = \\frac{1}{\\sqrt{u^2+v^2}}$$\n雅可比行列式的绝对值为 $|J| = \\frac{1}{\\sqrt{u^2+v^2}}$，因为该表达式总是正的。\n\n**步骤5：应用变量变换公式**\n\n$U$ 和 $V$ 的联合概率密度函数由以下公式给出：\n$$f_{U,V}(u,v) = f_{X,Y}(h_1(u,v), h_2(u,v)) |J|$$\n$$f_{U,V}(u,v) = f_{X,Y}\\left(\\arccos\\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right), \\sqrt{u^2+v^2}\\right) \\cdot \\frac{1}{\\sqrt{u^2+v^2}}$$\n我们需要将逆变换代入 $f_{X,Y}(x,y) = \\frac{\\sin(x)}{\\pi} \\exp(-y \\sin(x))$ 进行计算。\n项 $\\sin(x)$ 变为：\n$$\\sin(x) = \\sin\\left(\\arccos\\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right)\\right) = \\sqrt{1 - \\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right)^2} = \\sqrt{\\frac{u^2+v^2-v^2}{u^2+v^2}} = \\frac{|u|}{\\sqrt{u^2+v^2}}$$\n因为我们在区域 $u>0$ 中，这可以简化为 $\\sin(x) = \\frac{u}{\\sqrt{u^2+v^2}}$。\n指数中的项是 $y \\sin(x)$。代入变换的定义，这恰好就是 $u$：\n$$y \\sin(x) = \\left(\\sqrt{u^2+v^2}\\right) \\left(\\frac{u}{\\sqrt{u^2+v^2}}\\right) = u$$\n现在我们组合出最终的概率密度函数：\n$$f_{U,V}(u,v) = \\left[ \\frac{1}{\\pi} \\left( \\frac{u}{\\sqrt{u^2+v^2}} \\right) \\exp(-u) \\right] \\cdot \\left( \\frac{1}{\\sqrt{u^2+v^2}} \\right)$$\n$$f_{U,V}(u,v) = \\frac{u}{\\pi (u^2+v^2)} \\exp(-u)$$\n此表达式在支撑域 $u>0$ 和 $v \\in \\mathbb{R}$ 上有效。在其他区域，$f_{U,V}(u,v)=0$。\n\n**步骤6：最终答案**\n\n$U$ 和 $V$ 的联合概率密度函数由上面推导的表达式给出。", "answer": "$$\\boxed{\\frac{u}{\\pi (u^2 + v^2)} \\exp(-u)}$$", "id": "1408142"}]}