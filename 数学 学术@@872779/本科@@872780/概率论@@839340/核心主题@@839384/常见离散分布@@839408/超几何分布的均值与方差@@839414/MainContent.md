## 引言
在概率论的研究中，理解一个[随机变量的期望](@entry_id:262086)和[方差](@entry_id:200758)是掌握其行为特征的关键。对于描述不重置抽样的[超几何分布](@entry_id:193745)而言，这两个统计量不仅揭示了抽样结果的中心趋势和波动范围，更是连接理论与现实应用的桥梁。许多学习者在掌握了[超几何分布](@entry_id:193745)的基本概率公式后，往往面临一个知识缺口：如何精确地量化在有限总体中抽样时，样本构成的预期值和其不确定性？

本文旨在系统性地解决这一问题。我们将深入探讨[超几何分布](@entry_id:193745)的均值和[方差](@entry_id:200758)，从数学原理到实际应用，为您构建一个完整的知识体系。在“原理与机制”一章中，我们将从第一性原理出发，借助[指示随机变量](@entry_id:260717)这一强大工具，严谨地推导出均值和[方差](@entry_id:200758)的公式，并解读其背后深刻的统计学意义。随后，在“应用与跨学科联系”一章中，我们将展示这些理论如何在质量控制、遗传学、生态种群估计乃至[金融风险](@entry_id:138097)分析等多元领域中发挥作用。最后，通过“动手实践”部分，您将有机会运用所学知识解决具体问题，从而巩固和深化您的理解。

## 原理与机制

本章在前一章介绍[超几何分布](@entry_id:193745)基本概念的基础上，深入探讨其核心的统计特性：期望（均值）和[方差](@entry_id:200758)。理解这两个量不仅对于计算至关重要，更能为我们揭示从有限总体中进行不重置抽样的内在随机性规律。我们将从第一性原理出发，系统地推导这些公式，并通过一系列精心设计的例子，展示这些原理在质量控制、遗传学和实验设计等领域的实际应用。

### [超几何分布](@entry_id:193745)的期望

在任何概率实验中，[期望值](@entry_id:153208)代表了[随机变量](@entry_id:195330)取值的“长期平均”或“中心趋势”。对于[超几何分布](@entry_id:193745)，其[期望值](@entry_id:153208)有一个非常直观的解释。想象一个场景：一个装有 $N$ 个产品的箱子中，有 $K$ 个是次品。如果我们随机抽取一个样品，那么这个样品是次品的概率显然是 $\frac{K}{N}$。如果我们抽取一个包含 $n$ 个样品的样本，我们直觉上会预期样本中次品的数量大约是 $n$ 乘以这个概率。这个直觉是完全正确的。

为了严格地证明这一点，我们引入一种强大而优雅的工具——**[指示随机变量](@entry_id:260717) (indicator random variables)**。假设一个总体大小为 $N$，其中有 $K$ 个“成功”项。我们从中不重置地抽取一个大小为 $n$ 的样本。令[随机变量](@entry_id:195330) $X$ 表示样本中“成功”项的数量。$X$ 服从[超几何分布](@entry_id:193745)，记为 $X \sim \mathrm{Hypergeometric}(N, K, n)$。

我们可以将总的成功次数 $X$ 分解为一系列单次抽样的结果之和。为第 $i$ 次抽样（$i=1, 2, \dots, n$）定义一个[指示变量](@entry_id:266428) $I_i$：
$$
I_i = \begin{cases} 1  \text{如果第 } i \text{ 次抽到的是成功项} \\ 0  \text{如果第 } i \text{ 次抽到的是失败项} \end{cases}
$$
那么，样本中总的成功次数就是这些[指示变量](@entry_id:266428)的和：
$$
X = \sum_{i=1}^{n} I_i
$$

根据**[期望的线性](@entry_id:273513)性质 (linearity of expectation)**，总和的期望等于期望的总和，无论这些变量是否独立：
$$
\mathbb{E}[X] = \mathbb{E}\left[\sum_{i=1}^{n} I_i\right] = \sum_{i=1}^{n} \mathbb{E}[I_i]
$$

对于任何[指示变量](@entry_id:266428)，其[期望值](@entry_id:153208)等于它取值为 1 的概率。因此，我们需要计算 $\mathbb{E}[I_i] = \mathbb{P}(I_i = 1)$。由于抽样是随机的（即所有抽样序列等可能），第 $i$ 次抽到成功项的概率与第一次抽到成功项的概率是相同的。这可以通过对称性论证：在查看任何一次抽样的结果之前，总体中的任何一个元素都有相同的机会出现在抽样的第 $i$ 个位置。因此，对于任意 $i$，第 $i$ 次抽到的项是成功项的概率等于总体中成功项的比例。
$$
\mathbb{E}[I_i] = \mathbb{P}(I_i = 1) = \frac{K}{N}
$$

将这个结果代入期望的和式中，我们得到：
$$
\mathbb{E}[X] = \sum_{i=1}^{n} \frac{K}{N} = n \frac{K}{N}
$$

这就是[超几何分布](@entry_id:193745)的期望公式。它精确地量化了我们的直觉。

**示例：** 假设一批 50 个特种晶体管中包含 7 个次品。质检员随机不重置地抽取 10 个进行测试。样本中次品数量的[期望值](@entry_id:153208)是多少？[@problem_id:1373487]
这里，总体大小 $N=50$，成功项（次品）数量 $K=7$，样本大小 $n=10$。根据公式，[期望值](@entry_id:153208) $X$ 为：
$$
\mathbb{E}[X] = 10 \cdot \frac{7}{50} = \frac{70}{50} = 1.4
$$
这意味着，如果多次重复这个抽样过程，平均每次会在样本中发现 1.4 个次品。

### [超几何分布](@entry_id:193745)的[方差](@entry_id:200758)

[方差](@entry_id:200758)衡量的是[随机变量](@entry_id:195330)取值围绕其[期望值](@entry_id:153208)的离散程度。对于[超几何分布](@entry_id:193745)，[方差](@entry_id:200758)的计算比期望要复杂，因为它涉及到各次抽样之间的相互依赖性。在不重置抽样中，前一次的抽样结果会改变后续抽样的概率，导致各次抽样结果（即[指示变量](@entry_id:266428) $I_i$）不再是相互独立的。

为了推导[方差](@entry_id:200758)，我们再次使用[指示变量](@entry_id:266428) $X = \sum_{i=1}^n I_i$。一个[随机变量](@entry_id:195330)和的[方差](@entry_id:200758)公式为：
$$
\mathrm{Var}(X) = \mathrm{Var}\left(\sum_{i=1}^{n} I_i\right) = \sum_{i=1}^{n} \mathrm{Var}(I_i) + \sum_{i \neq j} \mathrm{Cov}(I_i, I_j)
$$
这个公式由两部分组成：所有单个[指示变量](@entry_id:266428)的[方差](@entry_id:200758)之和，以及所有不同[指示变量](@entry_id:266428)对之间的协[方差](@entry_id:200758)之和。

首先，计算单个[指示变量](@entry_id:266428) $I_i$ 的[方差](@entry_id:200758)。令 $p = \frac{K}{N}$。由于 $I_i$ 是一个伯努利[随机变量](@entry_id:195330)，其[方差](@entry_id:200758)为：
$$
\mathrm{Var}(I_i) = p(1-p) = \frac{K}{N}\left(1 - \frac{K}{N}\right)
$$

接下来，也是最关键的一步，是计算任意两个不同抽样 $i$ 和 $j$（其中 $i \neq j$）之间的**协[方差](@entry_id:200758) (covariance)** $\mathrm{Cov}(I_i, I_j)$。[@problem_id:1373495] 协[方差](@entry_id:200758)的定义是 $\mathrm{Cov}(I_i, I_j) = \mathbb{E}[I_i I_j] - \mathbb{E}[I_i]\mathbb{E}[I_j]$。
我们需要计算 $\mathbb{E}[I_i I_j]$，它等于 $\mathbb{P}(I_i=1 \text{ and } I_j=1)$。这个[联合概率](@entry_id:266356)可以通过[条件概率](@entry_id:151013)计算：
$$
\mathbb{P}(I_i=1, I_j=1) = \mathbb{P}(I_i=1) \cdot \mathbb{P}(I_j=1 | I_i=1)
$$
我们已经知道 $\mathbb{P}(I_i=1) = \frac{K}{N}$。给定第 $i$ 次抽到了一个成功项，总体中就只剩下 $N-1$ 个项，其中有 $K-1$ 个成功项。因此，在第 $j$ 次抽样中抽到成功项的概率变为 $\frac{K-1}{N-1}$。所以：
$$
\mathbb{E}[I_i I_j] = \frac{K}{N} \cdot \frac{K-1}{N-1}
$$
现在可以计算协[方差](@entry_id:200758)：
$$
\mathrm{Cov}(I_i, I_j) = \frac{K(K-1)}{N(N-1)} - \left(\frac{K}{N}\right)^2 = \frac{K}{N} \left( \frac{K-1}{N-1} - \frac{K}{N} \right) = \frac{K}{N} \left( \frac{N(K-1) - K(N-1)}{N(N-1)} \right)
$$
简化分子，得到 $NK - N - NK + K = K - N$。所以，
$$
\mathrm{Cov}(I_i, I_j) = \frac{K(K-N)}{N^2(N-1)} = -\frac{K(N-K)}{N^2(N-1)} = -\frac{p(1-p)}{N-1}
$$
这个负的协[方差](@entry_id:200758)有明确的直观意义：在一次抽样中抽到一个成功项，会使得下一次抽到成功项的概率降低。这种负相关性是“不重置”这一动作的直接后果。

现在，我们将这些部分组合起来。[方差](@entry_id:200758)公式中有 $n$ 个 $\mathrm{Var}(I_i)$ 项和 $n(n-1)$ 个 $\mathrm{Cov}(I_i, I_j)$ 项（因为有 $\binom{n}{2}$ 个无序对，而 $\mathrm{Cov}(I_i, I_j) = \mathrm{Cov}(I_j, I_i)$）。
$$
\mathrm{Var}(X) = n \cdot \mathrm{Var}(I_i) + n(n-1) \cdot \mathrm{Cov}(I_i, I_j)
$$
$$
\mathrm{Var}(X) = n p(1-p) + n(n-1) \left( -\frac{p(1-p)}{N-1} \right) = n p(1-p) \left( 1 - \frac{n-1}{N-1} \right)
$$
简化括号中的项：
$$
1 - \frac{n-1}{N-1} = \frac{(N-1) - (n-1)}{N-1} = \frac{N-n}{N-1}
$$
最终我们得到了[超几何分布](@entry_id:193745)的[方差](@entry_id:200758)公式：
$$
\mathrm{Var}(X) = n \frac{K}{N} \left(1 - \frac{K}{N}\right) \frac{N-n}{N-1}
$$

**示例：** 一个生物技术实验室收到一批 100 瓶组织样本，已知其中 30 瓶带有一个特定的遗传标记。一名技术员随机不重置地选取 12 个样本进行分析。样本中带有[遗传标记](@entry_id:202466)的样本数量 $X$ 的[方差](@entry_id:200758)是多少？[@problem_id:1373498]
这里，$N=100$, $K=30$, $n=12$。成功概率 $p = K/N = 0.3$。
$$
\mathrm{Var}(X) = 12 \cdot (0.3) \cdot (1 - 0.3) \cdot \frac{100 - 12}{100 - 1} = 12 \cdot 0.3 \cdot 0.7 \cdot \frac{88}{99}
$$
$$
\mathrm{Var}(X) = 2.52 \cdot \frac{8}{9} = 2.24
$$
在实际应用中，我们常常关心[标准差](@entry_id:153618) $\sigma_X = \sqrt{\mathrm{Var}(X)}$，因为它与原始数据具有相同的单位。例如，在一个包含 80 台发动机且有 7 台次品的批次中，随机抽取 10 台，我们可以计算出次品数的[方差](@entry_id:200758)，然后取其平方根得到[标准差](@entry_id:153618) [@problem_id:1373489]。

### 解读与应用

#### 有限总体修正因子

仔细观察[超几何分布](@entry_id:193745)的[方差](@entry_id:200758)公式，并将其与二项分布的[方差](@entry_id:200758) $\mathrm{Var}_{binom}(X) = np(1-p)$ 进行比较，后者描述的是**有重置**抽样的情景。
$$
\mathrm{Var}_{hyper}(X) = \mathrm{Var}_{binom}(X) \cdot \left(\frac{N-n}{N-1}\right)
$$
这个额外的乘数 $\frac{N-n}{N-1}$ 被称为**有限总体修正因子 (Finite Population Correction, FPC)**。

这个因子揭示了[超几何分布](@entry_id:193745)与二项分布之间的关键关系。[@problem_id:1373490]
1.  **[方差缩减](@entry_id:145496)：** 只要样本量 $n>1$，FPC 的值就严格小于 1。这意味着不重置抽样的[方差](@entry_id:200758)总是小于同[样条](@entry_id:143749)件下的有重置抽样（二项分布）的[方差](@entry_id:200758)。这与我们的直觉相符：每次抽样都从总体中移除了一个元素，减少了总体的不确定性，从而使得样本构成的波动性（[方差](@entry_id:200758)）降低。
2.  **极限行为：** 当总体大小 $N$ 相对于样本大小 $n$ 变得非常大时（$N \to \infty$），FPC 趋近于 1。在这种情况下，[超几何分布](@entry_id:193745)的行为越来越接近二项分布。这就是为什么在民意调查等应用中，如果总体非常大（例如一个国家的人口），即使抽样是无重置的，我们通常也可以安全地使用[二项分布](@entry_id:141181)作为近似模型。
3.  **FPC 的影响程度：** FPC 的大小直接反映了有限总[体效应](@entry_id:261475)的强度。例如，当样本量 $n = \frac{N+1}{2}$ 时，FPC 等于 $\frac{1}{2}$，这意味着超几何[方差](@entry_id:200758)恰好是二项近似[方差](@entry_id:200758)的一半 [@problem_id:1373490]。这说明当样本量占到总体的一半左右时，不重置抽样带来的[方差缩减](@entry_id:145496)效应非常显著。

#### [方差](@entry_id:200758)最大化

在实验设计中，有时我们希望最大化某个统计量的[方差](@entry_id:200758)以增强检验的功效。对于[超几何分布](@entry_id:193745)，在给定的 $N$ 和 $K$ 下，样本量 $n$ 如何影响[方差](@entry_id:200758) $\mathrm{Var}(X)$ 呢？[@problem_id:1373512]
回顾[方差](@entry_id:200758)公式：
$$
\mathrm{Var}(X) = \left( \frac{K(N-K)}{N(N-1)} \right) \cdot n(N-n)
$$
由于 $p=K/N$ 是常数，$\mathrm{Var}(X)$ 可写为:
$$
\mathrm{Var}(X) = \frac{p(1-p)}{N-1} n(N-n)
$$
括号内的部分是一个不依赖于 $n$ 的正常数 $C$。因此，最大化 $\mathrm{Var}(X)$ 等价于最大化函数 $g(n) = n(N-n) = Nn - n^2$。这是一个开口向下的二次函数，其顶点在 $n = \frac{N}{2}$ 处取得。因此，当样本量等于总体大小的一半时，样本中成功次数的[方差](@entry_id:200758)达到最大。
这个结果的直观解释是，当抽取一半总体时，我们对未被抽样的另一半的信息最不确定，这种不确定性反映在样本构成的最大变异性上。

#### [线性变换](@entry_id:149133)的[方差](@entry_id:200758)

[超几何分布](@entry_id:193745)的性质也可以用于分析其线性变换。在一个[群体遗传学](@entry_id:146344)研究中，假设总体 $N$ 人中有 $K$ 个某种性状的携带者，其余为非携带者。在一个大小为 $n$ 的样本中，我们可能对携带者数量 $X_C$ 和非携带者数量 $X_{NC}$ 之间的差异 $D = X_C - X_{NC}$ 感兴趣。[@problem_id:1373499]
由于 $X_C + X_{NC} = n$，我们可以将 $X_{NC}$ 表示为 $n - X_C$。因此，
$$
D = X_C - (n - X_C) = 2X_C - n
$$
这里 $X_C$ 服从 $\mathrm{Hypergeometric}(N, K, n)$ [分布](@entry_id:182848)。利用[方差](@entry_id:200758)的基本性质 $\mathrm{Var}(aX+b) = a^2\mathrm{Var}(X)$，我们立刻得到：
$$
\mathrm{Var}(D) = \mathrm{Var}(2X_C - n) = 2^2 \mathrm{Var}(X_C) = 4 \mathrm{Var}(X_C)
$$
只需计算出 $X_C$ 的标准超几何[方差](@entry_id:200758)，再乘以 4，就能得到这个差异量的[方差](@entry_id:200758)。

### 进阶主题与扩展

#### 多元[超几何分布](@entry_id:193745)

现实世界中的[分类问题](@entry_id:637153)往往不止两个类别（成功/失败）。例如，一个DNA样本池可能包含来自 $m$ 个不同物种的片段。**多元[超几何分布](@entry_id:193745)**正是对这种情况的推广。

假设总体大小为 $N$，被划分为 $m$ 个类别，每个类别的数量分别为 $N_1, N_2, \dots, N_m$，且 $\sum_{k=1}^m N_k = N$。从中不重置地抽取一个大小为 $n$ 的样本。令 $X_k$ 为样本中来自类别 $k$ 的项目数量。向量 $(X_1, \dots, X_m)$ 就服从多元[超几何分布](@entry_id:193745)。

对于任意类别 $i$ 和 $j$ ($i \neq j$)，我们可以计算它们数量之间的协[方差](@entry_id:200758)。类似于双变量情况的推导，可以得到：
$$
\mathrm{Cov}(X_i, X_j) = -n \frac{N_i}{N} \frac{N_j}{N} \frac{N-n}{N-1}
$$
协[方差](@entry_id:200758)同样是负的，这反映了不同类别之间的竞争关系：在一个固定大小的样本中，多抽到一个类别的项，必然意味着其他类别的项会相应减少。

这个结果在分析复杂系统的信号时非常有用。例如，如果一个分析信号 $S$ 是各类别数量的加权和 $S = \sum_{k=1}^m w_k X_k$，其[方差](@entry_id:200758)可以通过协[方差](@entry_id:200758)的线性性质计算 [@problem_id:1373496]：
$$
\mathrm{Var}(S) = \sum_{k=1}^{m} w_k^2 \mathrm{Var}(X_k) + \sum_{i \neq j} w_i w_j \mathrm{Cov}(X_i, X_j)
$$
代入各自的[方差](@entry_id:200758)和协[方差](@entry_id:200758)公式并化简，可以得到一个关于 $N, n, N_k, w_k$ 的封闭表达式。

#### 序贯抽样中的对称性

考虑一个两阶段的抽样过程：先从总体中抽取 $n_1$ 个样本，然后再从余下的总体中抽取 $n_2$ 个样本。一个深刻的问题是：第二批样本中成功项数量 $X_2$ 的（无条件）[方差](@entry_id:200758)是多少？[@problem_id:1373526]

人们可能会直觉地认为这会比单次抽样复杂得多，因为第二阶段的抽样是在一个被第一阶段改变了的总体上进行的。然而，一个被称为**可交换性 (exchangeability)** 的基本原则表明，简单[随机抽样](@entry_id:175193)中的抽样顺序无关紧要。

通过使用**[全方差公式](@entry_id:177482) (Law of Total Variance)**，即 $\mathrm{Var}(X_2) = \mathbb{E}[\mathrm{Var}(X_2|X_1)] + \mathrm{Var}(\mathbb{E}[X_2|X_1])$，我们可以严格证明一个出人意料的简洁结果：
$$
\mathrm{Var}(X_2) = n_2 \frac{K}{N} \left(1 - \frac{K}{N}\right) \frac{N-n_2}{N-1}
$$
这个结果表明，第二个样本中成功数的无[条件方差](@entry_id:183803)，与直接从原始总体中抽取一个大小为 $n_2$ 的样本的[方差](@entry_id:200758)完全相同。第一阶段的抽样活动，在不考虑其具体结果时，并不会改变我们对第二阶段样本统计特性的预期。这一结论深刻地揭示了随机抽样过程中的内在对称性，是概率论中一个优美而重要的原理。