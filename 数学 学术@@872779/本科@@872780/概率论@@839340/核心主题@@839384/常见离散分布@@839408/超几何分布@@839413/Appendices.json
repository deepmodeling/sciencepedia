{"hands_on_practices": [{"introduction": "要掌握任何一个概率分布，第一步都是理解其本源。本练习将引导你从第一性原理出发，使用组合学方法推导超几何分布的概率质量函数（PMF）。这是理解所有“无放回抽样”场景的基石，它不仅是一个公式，更是对“等可能结果”基本概率思想的直接应用。[@problem_id:8681]", "problem": "一个罐子中装有 $N$ 个物体组成的有限总体。这些物体有两种不同的类型：A型和B型。其中有 $K$ 个A型物体，因此有 $N-K$ 个B型物体。从罐子中*不放回地*抽取 $n$ 个物体的样本。\n\n推导所选物体中恰好有 $k$ 个为A型的概率 $P(X=k)$ 的通用表达式。您可以假设每种类型所要求的物体数量不超过可用数量（即 $k \\le K$ 且 $n-k \\le N-K$）。", "solution": "我们从装有 $N$ 个物体的罐子中不放回地抽取 $n$ 个物体。所有 $\\binom{N}{n}$ 个大小为 $n$ 的等可能子集构成了样本空间。\n\n从 $N$ 个物体中选择 $n$ 个物体的总方法数：\n$$\n|\\Omega| = \\binom{N}{n}.\n$$\n\n为了恰好有 $k$ 个A型物体，我们必须从 $K$ 个A型物体中选择 $k$ 个，并从 $N-K$ 个B型物体中选择 $n-k$ 个。有利结果的数量为\n$$\n|\\{X=k\\}| = \\binom{K}{k}\\binom{N-K}{n-k}.\n$$\n\n根据古典概率的定义，\n$$\nP(X=k) = \\frac{|\\{X=k\\}|}{|\\Omega|} = \\frac{\\binom{K}{k}\\binom{N-K}{n-k}}{\\binom{N}{n}}.\n$$", "answer": "$$\\boxed{\\frac{\\binom{K}{k}\\binom{N-K}{n-k}}{\\binom{N}{n}}}$$", "id": "8681"}, {"introduction": "在了解如何计算特定结果的概率之后，下一步是理解分布的“平均”表现。本练习将聚焦于计算超几何随机变量的期望值（均值），并介绍一种非常强大的技巧——指示变量法。通过这个方法，我们不仅能简化计算过程，还能比直接使用概率质量函数获得更深刻的洞察。[@problem_id:1373487]", "problem": "一批50个特殊晶体管中有7个是次品。一名质检员从这批晶体管中随机无放回地抽取10个进行检测。计算所选样本中次品晶体管的期望数量。答案以分数或小数表示。", "solution": "设总体大小为 $N=50$，次品晶体管的数量为 $K=7$，样本大小为 $n=10$。令 $X$ 表示样本中次品晶体管的数量。\n\n此抽样过程为不放回抽样。为 $i=1,2,\\dots,n$ 定义指示变量 $I_{i}$，如果第 $i$ 次抽出的晶体管是次品，则 $I_{i}=1$，否则 $I_{i}=0$。那么\n$$\nX=\\sum_{i=1}^{n} I_{i}.\n$$\n根据期望的线性性，\n$$\n\\mathbb{E}[X]=\\sum_{i=1}^{n} \\mathbb{E}[I_{i}].\n$$\n对于每个 $i$，根据不放回抽样的对称性，第 $i$ 次抽到次品的边际概率等于总体中次品的比例：\n$$\n\\mathbb{E}[I_{i}] = \\mathbb{P}(\\text{第$i$个是次品}) = \\frac{K}{N}.\n$$\n因此，\n$$\n\\mathbb{E}[X] = \\sum_{i=1}^{n} \\frac{K}{N} = n \\cdot \\frac{K}{N}.\n$$\n将 $n=10$，$K=7$ 和 $N=50$ 代入，可得\n$$\n\\mathbb{E}[X] = 10 \\cdot \\frac{7}{50} = \\frac{70}{50} = \\frac{7}{5}.\n$$\n这等价于 $1.4$。", "answer": "$$\\boxed{\\frac{7}{5}}$$", "id": "1373487"}, {"introduction": "现在，让我们进入一个更复杂也更贴近现实的应用场景，它涉及到条件概率。本练习探讨当我们在多个样本中获得部分信息时，该如何更新我们的认知。这个问题将引出一个出人意料且非常优雅的结论，该结论是费雪精确检验等统计方法的核心，充分展示了条件概率的非直观力量。[@problem_id:1399270]", "problem": "在为深空探测器制造一批高灵敏度电子元件的质量控制过程中，生产了一大批共 $N$ 个元件。工程师们不知道的是，这批元件中总共有 $K$ 个是次品。\n\n在最终组装之前，进行了两次独立的、不重叠的质量控制测试。第一次测试从这批元件中随机抽取 $n_1$ 个元件，不放回。第二次独立的测试接着从同一批原始元件中随机抽取 $n_2$ 个不同的元件，同样不放回，并确保两次抽样是互不相交的。\n\n两次测试完成后，一份报告指出，在两个样本中总共发现了恰好 $k$ 个次品。根据这些信息，确定第一次测试恰好发现了 $x_1$ 个次品的概率。\n\n请用 $N, K, n_1, n_2, k$ 和 $x_1$ 给出一个封闭形式的解析表达式作为答案。你可以假设所有变量都代表非负整数，并且抽样在物理上是可能的（例如，$x_1 \\le k$, $x_1 \\le n_1$, $k-x_1 \\le n_2$, $n_1+n_2 \\le N$ 以及 $k \\le K$）。", "solution": "设 $X_1$ 和 $X_2$ 分别表示在第一次和第二次测试中发现的次品数量。我们被要求计算条件概率\n$$\n\\Pr\\!\\left(X_1=x_1\\,\\middle|\\,X_1+X_2=k\\right)=\\frac{\\Pr\\!\\left(X_1=x_1,\\,X_2=k-x_1\\right)}{\\Pr\\!\\left(X_1+X_2=k\\right)}.\n$$\n\n首先通过不放回的序贯抽样计算分子中的联合概率。第一次抽样得到\n$$\n\\Pr\\!\\left(X_1=x_1\\right)=\\frac{\\binom{K}{x_1}\\binom{N-K}{n_1-x_1}}{\\binom{N}{n_1}}.\n$$\n在 $X_1=x_1$ 的条件下，剩余的批次中有 $N-n_1$ 个元件，其中有 $K-x_1$ 个次品和 $N-K-(n_1-x_1)$ 个非次品，所以\n$$\n\\Pr\\!\\left(X_2=k-x_1\\,\\middle|\\,X_1=x_1\\right)=\\frac{\\binom{K-x_1}{k-x_1}\\binom{N-K-(n_1-x_1)}{n_2-(k-x_1)}}{\\binom{N-n_1}{n_2}}.\n$$\n因此\n$$\n\\Pr\\!\\left(X_1=x_1,\\,X_2=k-x_1\\right)=\\frac{\\binom{K}{x_1}\\binom{K-x_1}{k-x_1}\\binom{N-K}{n_1-x_1}\\binom{N-K-(n_1-x_1)}{n_2-(k-x_1)}}{\\binom{N}{n_1}\\binom{N-n_1}{n_2}}.\n$$\n\n使用组合恒等式\n$$\n\\binom{a}{b}\\binom{a-b}{c}=\\binom{a}{b+c}\\binom{b+c}{b},\\qquad \\binom{N}{n_1}\\binom{N-n_1}{n_2}=\\binom{N}{n_1+n_2}\\binom{n_1+n_2}{n_1},\n$$\n将联合概率表达式简化为\n$$\n\\Pr\\!\\left(X_1=x_1,\\,X_2=k-x_1\\right)=\\frac{\\binom{K}{k}\\binom{k}{x_1}\\binom{N-K}{n_1+n_2-k}\\binom{n_1+n_2-k}{n_1-x_1}}{\\binom{N}{n_1+n_2}\\binom{n_1+n_2}{n_1}}.\n$$\n\n接下来计算分母，即合并的 $n_1+n_2$ 次抽样中恰好包含 $k$ 个次品的概率：\n$$\n\\Pr\\!\\left(X_1+X_2=k\\right)=\\frac{\\binom{K}{k}\\binom{N-K}{n_1+n_2-k}}{\\binom{N}{n_1+n_2}}.\n$$\n\n两者相除得到\n$$\n\\Pr\\!\\left(X_1=x_1\\,\\middle|\\,X_1+X_2=k\\right)=\\frac{\\binom{k}{x_1}\\binom{n_1+n_2-k}{n_1-x_1}}{\\binom{n_1+n_2}{n_1}}.\n$$\n等价地，这可以写成将 $k$ 个次品超几何地分配到两个区块中的形式：\n$$\n\\Pr\\!\\left(X_1=x_1\\,\\middle|\\,X_1+X_2=k\\right)=\\frac{\\binom{n_1}{x_1}\\binom{n_2}{k-x_1}}{\\binom{n_1+n_2}{k}},\n$$\n此式对于满足 $0\\le x_1\\le \\min\\{n_1,k\\}$ 和 $0\\le k-x_1\\le n_2$ 的可行 $x_1$ 成立，否则为零。注意，最终的表达式与 $N$ 和 $K$ 无关，因为我们以合并样本中总共有 $k$ 个次品为条件。", "answer": "$$\\boxed{\\frac{\\binom{n_{1}}{x_{1}}\\binom{n_{2}}{k-x_{1}}}{\\binom{n_{1}+n_{2}}{k}}}$$", "id": "1399270"}]}