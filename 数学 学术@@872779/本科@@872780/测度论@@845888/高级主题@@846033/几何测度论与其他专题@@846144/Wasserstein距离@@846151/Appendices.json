{"hands_on_practices": [{"introduction": "在实数轴 $\\mathbb{R}$ 上，计算 1-Wasserstein 距离最直接的方法之一是利用累积分布函数 (CDF)。这个距离等于两个概率分布的 CDF 之间的面积。这项练习 [@problem_id:1465007] 为你提供了应用该方法的基础实践，你需要为给定的离散测度构建其阶梯状的 CDF，然后计算它们之间的面积，从而巩固对该核心公式的理解。", "problem": "在最优输运领域，1-Wasserstein距离用于衡量将一个概率分布转换为另一个概率分布的“成本”。对于实线 $\\mathbb{R}$ 上的两个概率测度 $\\mu$ 和 $\\nu$，这个距离（记为 $W_1(\\mu, \\nu)$）可以使用它们各自的累积分布函数（CDF）来计算。一个测度 $\\sigma$ 的CDF，记为 $F_\\sigma(t)$，定义为区间 $(-\\infty, t]$ 上的总测度，即 $F_\\sigma(t) = \\sigma((-\\infty, t])$。1-Wasserstein距离由它们CDF之间的总面积给出：\n\n$$W_1(\\mu, \\nu) = \\int_{-\\infty}^{\\infty} |F_\\mu(t) - F_\\nu(t)| \\, dt$$\n\n狄拉克δ测度 $\\delta_a$ 表示一个概率分布，其中全部概率质量集中在单一点 $a$ 上。\n\n考虑定义在实线上的两个离散概率测度 $\\mu$ 和 $\\nu$ 如下：\n- 测度 $\\mu$ 由 $\\mu = \\frac{1}{3}\\delta_{-2} + \\frac{2}{3}\\delta_{1}$ 给出。这意味着 $\\mu$ 在点 $x=-2$ 处放置了 $1/3$ 的概率质量，在点 $x=1$ 处放置了 $2/3$ 的概率质量。\n- 测度 $\\nu$ 由 $\\nu = \\frac{1}{2}\\delta_{0} + \\frac{1}{2}\\delta_{3}$ 给出。这意味着 $\\nu$ 在点 $x=0$ 处放置了 $1/2$ 的概率质量，在点 $x=3$ 处放置了 $1/2$ 的概率质量。\n\n计算这两个测度之间的1-Wasserstein距离 $W_1(\\mu, \\nu)$。请用最简精确分数表示你的答案。", "solution": "我们在实线上使用1-Wasserstein距离公式：\n$$\nW_{1}(\\mu,\\nu)=\\int_{-\\infty}^{\\infty}\\left|F_{\\mu}(t)-F_{\\nu}(t)\\right|\\,dt.\n$$\n对于给定的离散测度，它们的CDF是阶梯函数。由 $\\mu=\\frac{1}{3}\\delta_{-2}+\\frac{2}{3}\\delta_{1}$，我们得到\n$$\nF_{\\mu}(t)=\\begin{cases}\n0,  t-2,\\\\\n\\frac{1}{3},  -2\\le t1,\\\\\n1,  t\\ge 1.\n\\end{cases}\n$$\n由 $\\nu=\\frac{1}{2}\\delta_{0}+\\frac{1}{2}\\delta_{3}$，我们得到\n$$\nF_{\\nu}(t)=\\begin{cases}\n0,  t0,\\\\\n\\frac{1}{2},  0\\le t3,\\\\\n1,  t\\ge 3.\n\\end{cases}\n$$\nCDF发生变化的唯一点是 $-2,0,1,3$。在这些点之间的每个区间上，$|F_{\\mu}-F_{\\nu}|$ 是常数，所以积分是这些区间的（区间长度）×（绝对差）的总和。\n\n- 对于 $(-\\infty,-2)$：$F_{\\mu}=0$, $F_{\\nu}=0$，所以贡献为 $0$。\n- 对于 $[-2,0)$：$F_{\\mu}=\\frac{1}{3}$, $F_{\\nu}=0$，所以贡献为 $(0-(-2))\\cdot\\left|\\frac{1}{3}-0\\right|=2\\cdot\\frac{1}{3}=\\frac{2}{3}$。\n- 对于 $[0,1)$：$F_{\\mu}=\\frac{1}{3}$, $F_{\\nu}=\\frac{1}{2}$，所以贡献为 $(1-0)\\cdot\\left|\\frac{1}{3}-\\frac{1}{2}\\right|=1\\cdot\\frac{1}{6}=\\frac{1}{6}$。\n- 对于 $[1,3)$：$F_{\\mu}=1$, $F_{\\nu}=\\frac{1}{2}$，所以贡献为 $(3-1)\\cdot\\left|1-\\frac{1}{2}\\right|=2\\cdot\\frac{1}{2}=1$。\n- 对于 $[3,\\infty)$：$F_{\\mu}=1$, $F_{\\nu}=1$，所以贡献为 $0$。\n\n将这些贡献相加得到\n$$\nW_{1}(\\mu,\\nu)=\\frac{2}{3}+\\frac{1}{6}+1=\\frac{11}{6}.\n$$", "answer": "$$\\boxed{\\frac{11}{6}}$$", "id": "1465007"}, {"introduction": "Wasserstein 距离不仅仅是一个数值，它代表了一个最优输运方案的最小“成本”。这个方案精确地描述了如何将质量从一个分布移动到另一个分布以实现这一最低成本。这项练习 [@problem_id:1465059] 将超越简单的距离计算，要求你找到其背后的最优输运方案本身。通过将其构建为一个简单的物流问题，你将对最优输运的 Kantorovich 提法以及其中涉及的优化过程获得具体而直观的理解。", "problem": "考虑一个简单的资源分配物流问题。一家公司有两个供应站，位于一条笔直高速公路上的 $x_1=0$ 和 $x_2=2$ 位置。每个供应站恰好存有总可用资源的一半。这些资源需要被运送到位于同一高速公路上的 $y_1=1$ 和 $y_2=3$ 位置的两个配送中心。每个配送中心恰好需要总资源的一半。\n\n这种分配可以用测度论中一个叫做最优传输的概念来建模。初始资源分布由一个概率测度 $\\mu = \\frac{1}{2}\\delta_0 + \\frac{1}{2}\\delta_2$ 表示，其中 $\\delta_x$ 是狄拉克δ测度，表示在位置 $x$ 处的一个点质量。配送中心的目标分布由测度 $\\nu = \\frac{1}{2}\\delta_1 + \\frac{1}{2}\\delta_3$ 给出。\n\n一个“传输方案”指定了从每个供应站到每个配送中心要运输多少资源。对于这个离散情况，一个传输方案 $\\gamma$ 可以用一个 $2 \\times 2$ 矩阵 $\\Gamma = (\\gamma_{ij})$ 来表示，其中 $\\gamma_{ij}$ 是从供应站 $i$（位于位置 $x_i$）运输到配送中心 $j$（位于位置 $y_j$）的总资源的分数。一个有效的方案必须满足供需约束：从每个供应站运出的总资源和每个配送中心接收的总资源必须与给定的分布相匹配。\n\n从位置 $x$ 运输一单位资源到位置 $y$ 的成本与运输距离成正比，因此我们可以将成本定义为 $c(x,y) = |x-y|$。给定方案的总运输成本是所有单独运输成本的总和，按每条路径上运输的资源分数进行加权。最优传输的目标是找到使这个总成本最小化的方案。\n\n你的任务是确定此场景下的最优传输方案。找到使总运输成本最小化的矩阵 $\\Gamma_{opt} = \\begin{pmatrix} \\gamma_{11}  \\gamma_{12} \\\\ \\gamma_{21}  \\gamma_{22} \\end{pmatrix}$。元素 $\\gamma_{11}$ 表示从供应站 $x_1=0$ 运输到配送中心 $y_1=1$ 的资源分数，$\\gamma_{12}$ 表示从 $x_1=0$ 到 $y_2=3$，$\\gamma_{21}$ 从 $x_2=2$ 到 $y_1=1$，以及 $\\gamma_{22}$ 从 $x_2=2$ 到 $y_2=3$。", "solution": "问题要求找到最优传输方案 $\\gamma$，用矩阵 $\\Gamma = (\\gamma_{ij})$ 表示，该方案能将质量从分布 $\\mu = \\frac{1}{2}\\delta_0 + \\frac{1}{2}\\delta_2$ 移动到分布 $\\nu = \\frac{1}{2}\\delta_1 + \\frac{1}{2}\\delta_3$ 的成本最小化。\n\n首先，让我们确定传输矩阵 $\\Gamma$ 中元素 $\\gamma_{ij}$ 的约束条件。矩阵的索引方式为：$i=1$ 对应源点 $x_1=0$，$i=2$ 对应源点 $x_2=2$，$j=1$ 对应目标点 $y_1=1$，$j=2$ 对应目标点 $y_2=3$。\n\n边际约束要求每行的总和等于相应源点的质量，每列的总和等于相应目标点的质量。\n\n行和（供应约束）：\n1.  离开 $x_1=0$ 的总质量必须是 $\\mu(\\{0\\}) = 1/2$。所以，$\\gamma_{11} + \\gamma_{12} = \\frac{1}{2}$。\n2.  离开 $x_2=2$ 的总质量必须是 $\\mu(\\{2\\}) = 1/2$。所以，$\\gamma_{21} + \\gamma_{22} = \\frac{1}{2}$。\n\n列和（需求约束）：\n1.  到达 $y_1=1$ 的总质量必须是 $\\nu(\\{1\\}) = 1/2$。所以，$\\gamma_{11} + \\gamma_{21} = \\frac{1}{2}$。\n2.  到达 $y_2=3$ 的总质量必须是 $\\nu(\\{3\\}) = 1/2$。所以，$\\gamma_{12} + \\gamma_{22} = \\frac{1}{2}$。\n\n此外，移动的质量不能为负，所以对于所有的 $i,j \\in \\{1, 2\\}$，都有 $\\gamma_{ij} \\ge 0$。\n\n接下来，我们定义需要最小化的总成本函数。从源点 $x_i$ 移动单位质量到目标点 $y_j$ 的成本是 $c_{ij} = |x_i - y_j|$。让我们计算成本矩阵 $C = (c_{ij})$：\n$c_{11} = |x_1 - y_1| = |0 - 1| = 1$\n$c_{12} = |x_1 - y_2| = |0 - 3| = 3$\n$c_{21} = |x_2 - y_1| = |2 - 1| = 1$\n$c_{22} = |x_2 - y_2| = |2 - 3| = 1$\n\n所以成本矩阵是 $C = \\begin{pmatrix} 1  3 \\\\ 1  1 \\end{pmatrix}$。\n\n我们想要最小化的总运输成本，由成本和相应质量分数的乘积之和给出：\n$$ \\mathcal{C}(\\Gamma) = \\sum_{i=1}^{2}\\sum_{j=1}^{2} c_{ij} \\gamma_{ij} = 1\\gamma_{11} + 3\\gamma_{12} + 1\\gamma_{21} + 1\\gamma_{22} $$\n\n现在我们来解决这个带约束的最小化问题。关于 $\\gamma_{ij}$ 的四个线性约束不是独立的。让我们用一个变量来表示所有变量，比如 $\\gamma_{11}$。令 $\\gamma_{11} = t$。\n根据第一个行和约束：$\\gamma_{12} = \\frac{1}{2} - \\gamma_{11} = \\frac{1}{2} - t$。\n根据第一个列和约束：$\\gamma_{21} = \\frac{1}{2} - \\gamma_{11} = \\frac{1}{2} - t$。\n根据第二个行和约束：$\\gamma_{22} = \\frac{1}{2} - \\gamma_{21} = \\frac{1}{2} - \\left(\\frac{1}{2} - t\\right) = t$。\n我们可以检验这也满足第二个列和约束：$\\gamma_{12} + \\gamma_{22} = (\\frac{1}{2} - t) + t = \\frac{1}{2}$。\n\n所以，任何有效的传输方案都可以写成单个参数 $t$ 的函数：\n$$ \\Gamma(t) = \\begin{pmatrix} t  \\frac{1}{2} - t \\\\ \\frac{1}{2} - t  t \\end{pmatrix} $$\n非负性约束 $\\gamma_{ij} \\ge 0$ 意味着 $t \\ge 0$ 且 $\\frac{1}{2} - t \\ge 0$，即 $t \\le \\frac{1}{2}$。因此，$t$ 的有效范围是 $0 \\le t \\le \\frac{1}{2}$。\n\n现在，我们将总成本 $\\mathcal{C}$ 表示为 $t$ 的函数：\n$$ \\mathcal{C}(t) = 1(t) + 3\\left(\\frac{1}{2} - t\\right) + 1\\left(\\frac{1}{2} - t\\right) + 1(t) $$\n$$ \\mathcal{C}(t) = t + \\frac{3}{2} - 3t + \\frac{1}{2} - t + t $$\n$$ \\mathcal{C}(t) = \\left(\\frac{3}{2} + \\frac{1}{2}\\right) + (1 - 3 - 1 + 1)t $$\n$$ \\mathcal{C}(t) = 2 - 2t $$\n\n为了在区间 $t \\in [0, \\frac{1}{2}]$ 上最小化 $\\mathcal{C}(t) = 2 - 2t$，我们需要使 $-2t$ 这一项尽可能小。这意味着我们应该选择 $t$ 的最大可能值。在其定义域内，$t$ 的最大值是 $t = \\frac{1}{2}$。\n\n将 $t = \\frac{1}{2}$ 代入我们的参数化矩阵 $\\Gamma(t)$，我们得到最优传输方案：\n$\\gamma_{11} = t = \\frac{1}{2}$\n$\\gamma_{12} = \\frac{1}{2} - t = \\frac{1}{2} - \\frac{1}{2} = 0$\n$\\gamma_{21} = \\frac{1}{2} - t = \\frac{1}{2} - \\frac{1}{2} = 0$\n$\\gamma_{22} = t = \\frac{1}{2}$\n\n因此，最优传输矩阵是：\n$$ \\Gamma_{opt} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} $$\n这个方案对应于将所有来自供应站 $x_1=0$ 的资源移动到配送中心 $y_1=1$，并将所有来自供应站 $x_2=2$ 的资源移动到配送中心 $y_2=3$。这是 Monge 解，它避免了更昂贵的“交叉”运输（例如，从 $x_1=0$ 到 $y_2=3$）。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}}$$", "id": "1465059"}, {"introduction": "1-Wasserstein 距离是一个更广泛的 $p$-Wasserstein 距离族（$W_p$）中的一员，其中输运成本由 $|x-y|^p$ 来衡量。参数 $p$ 的选择改变了该距离对远距离移动的惩罚方式。这项练习 [@problem_id:1464995] 允许你在一个简化的场景下，通过计算和比较 $W_1$ 与 $W_2$ 来探索这一推广。你将亲眼看到改变指数 $p$ 如何影响最终的距离度量，从而洞察 $W_p$ 距离空间的丰富结构。", "problem": "在最优输运的研究中，Wasserstein 距离提供了一种衡量两个概率分布之间“距离”的方法。对于实轴 $\\mathbb{R}$ 上的两个概率测度 $\\mu$ 和 $\\nu$，当 $p \\ge 1$ 时，$p$-Wasserstein 距离定义为：\n$$ W_p(\\mu, \\nu) = \\left( \\inf_{\\pi \\in \\Pi(\\mu, \\nu)} \\int_{\\mathbb{R} \\times \\mathbb{R}} |x-y|^p \\, d\\pi(x,y) \\right)^{1/p} $$\n其中 $\\Pi(\\mu, \\nu)$ 是 $\\mathbb{R} \\times \\mathbb{R}$ 上所有联合概率测度（或“输运方案”）的集合，其第一个边缘测度是 $\\mu$，第二个边缘测度是 $\\nu$。\n\n一个 Dirac delta 测度，记作 $\\delta_c$，表示所有质量都集中在单一点 $c$ 上的概率分布。\n\n考虑一个特殊情况，其中一个测度是 Dirac delta 测度 $\\mu = \\delta_{x_0}$，另一个是离散测度 $\\nu = \\sum_{j=1}^{k} n_j \\delta_{y_j}$，且 $\\sum n_j = 1$。在这种情况下，由于最优输运方案是唯一的，计算过程大大简化。$p$-Wasserstein 距离由以下公式给出：\n$$ W_p(\\delta_{x_0}, \\nu)^p = \\sum_{j=1}^{k} n_j |x_0 - y_j|^p $$\n\n现在，考虑实轴上的两个特定概率测度：\n1.  $\\mu = \\delta_0$，一个在原点的 Dirac 测度。\n2.  $\\nu = \\frac{1}{4}\\delta_{-a} + \\frac{3}{4}\\delta_{a/3}$，其中 $a$ 是一个正实数常数。\n\n计算比值 $\\frac{W_2(\\mu, \\nu)}{W_1(\\mu, \\nu)}$ 的精确值。将你的答案表示为一个可能包含数值分数和平方根的符号表达式。", "solution": "我们使用给定的针对 Dirac 源的简化公式：对于 $\\mu=\\delta_{x_{0}}$ 和 $\\nu=\\sum_{j} n_{j}\\delta_{y_{j}}$，\n$$\nW_{p}(\\delta_{x_{0}},\\nu)^{p}=\\sum_{j} n_{j}\\,|x_{0}-y_{j}|^{p}.\n$$\n这里 $x_{0}=0$ 且 $\\nu=\\frac{1}{4}\\delta_{-a}+\\frac{3}{4}\\delta_{a/3}$，其中 $a0$，所以 $|y_{1}|=a$ 且 $|y_{2}|=\\frac{a}{3}$。\n\n首先计算 $W_{1}$：\n$$\nW_{1}(\\delta_{0},\\nu)=\\frac{1}{4}\\,|-a|+\\frac{3}{4}\\,\\left|\\frac{a}{3}\\right|=\\frac{1}{4}\\,a+\\frac{3}{4}\\cdot\\frac{a}{3}=\\frac{a}{4}+\\frac{a}{4}=\\frac{a}{2}.\n$$\n\n接下来计算 $W_{2}$：\n$$\nW_{2}(\\delta_{0},\\nu)^{2}=\\frac{1}{4}\\,a^{2}+\\frac{3}{4}\\left(\\frac{a}{3}\\right)^{2}=\\frac{a^{2}}{4}+\\frac{3}{4}\\cdot\\frac{a^{2}}{9}=\\frac{a^{2}}{4}+\\frac{a^{2}}{12}=\\frac{a^{2}}{3},\n$$\n因此，由于 $a0$，\n$$\nW_{2}(\\delta_{0},\\nu)=\\sqrt{\\frac{a^{2}}{3}}=\\frac{a}{\\sqrt{3}}.\n$$\n\n因此，所求的比值为\n$$\n\\frac{W_{2}(\\mu,\\nu)}{W_{1}(\\mu,\\nu)}=\\frac{\\frac{a}{\\sqrt{3}}}{\\frac{a}{2}}=\\frac{a}{\\sqrt{3}}\\cdot\\frac{2}{a}=\\frac{2}{\\sqrt{3}}.\n$$", "answer": "$$\\boxed{\\frac{2}{\\sqrt{3}}}$$", "id": "1464995"}]}