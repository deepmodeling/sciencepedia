{"hands_on_practices": [{"introduction": "第一个实践问题为理解条件期望的塔性质提供了一个直接而直观的切入点。我们将看到，全期望定律 $E[E[X|\\mathcal{G}]] = E[X]$ 如何允许我们通过先对部分信息求平均来计算总期望。这个练习 [@problem_id:1461118] 巩固了“对均值求均值得到原始均值”这一基本思想。", "problem": "某个制造过程生产一种部件，其质量特性 $U$ 是一个在区间 $[0, 1]$ 上均匀分布的随机变量。初步的质量控制检查将部件分到两个箱子中。A箱用于存放 $U \\in [0, 1/2)$ 的部件，B箱用于存放 $U \\in [1/2, 1]$ 的部件。\n\n一位工程师对质量特性的平方 $X = U^2$ 的期望值感兴趣。工程师唯一可用的信息是部件属于哪个箱子。该信息由 $\\sigma$-代数 $\\mathcal{G} = \\{\\emptyset, [0, 1/2), [1/2, 1], [0, 1]\\}$ 表示，它是由样本空间 $\\Omega = [0, 1]$ 划分为两个箱子而生成的。\n\n工程师定义了一个新的随机变量 $Y$，作为在质量检查信息给定的情况下 $X$ 的条件期望，即 $Y = E[X | \\mathcal{G}]$。\n\n计算这个新随机变量的期望值 $E[Y]$。", "solution": "设 $U$ 在 $[0,1]$ 上均匀分布，因此其密度函数为 $f_{U}(u)=1$ (当 $u \\in [0,1]$ 时)，否则为 $0$。定义 $X=U^{2}$，并设 $\\mathcal{G}$ 是由划分 $[0,1/2)$ 和 $[1/2,1]$ 生成的 $\\sigma$-代数。我们感兴趣的随机变量是 $Y=E[X \\mid \\mathcal{G}]$。\n\n根据全期望定律（塔性质的一个特例），对于任何可积随机变量 $X$ 和子-$\\sigma$-代数 $\\mathcal{G}$，\n$$\nE[E[X \\mid \\mathcal{G}]] = E[X].\n$$\n将此应用于 $X=U^{2}$，我们得到\n$$\nE[Y]=E[E[U^{2} \\mid \\mathcal{G}]]=E[U^{2}].\n$$\n\n我们直接根据具有密度函数 $f_{U}$ 的连续随机变量的期望定义来计算 $E[U^{2}]$：\n$$\nE[U^{2}]=\\int_{0}^{1} u^{2} f_{U}(u)\\,du=\\int_{0}^{1} u^{2}\\,du=\\left.\\frac{u^{3}}{3}\\right|_{0}^{1}=\\frac{1}{3}.\n$$\n\n为完整起见，可以通过在每个箱子上显式计算 $Y$ 来验证这一点。在 $A=[0,1/2)$ 上，\n$$\nE[U^{2} \\mid A]=\\frac{1}{P(A)}\\int_{0}^{1/2} u^{2}\\,du=2 \\int_{0}^{1/2} u^{2}\\,du=2 \\cdot \\frac{1}{24}=\\frac{1}{12}.\n$$\n在 $B=[1/2,1]$ 上，\n$$\nE[U^{2} \\mid B]=\\frac{1}{P(B)}\\int_{1/2}^{1} u^{2}\\,du=2 \\int_{1/2}^{1} u^{2}\\,du=2 \\cdot \\frac{7}{24}=\\frac{7}{12}.\n$$\n因此，$Y$ 在 $A$ 上为 $\\frac{1}{12}$，在 $B$ 上为 $\\frac{7}{12}$。利用 $P(A)=P(B)=\\frac{1}{2}$，\n$$\nE[Y]=\\frac{1}{2}\\cdot \\frac{1}{12}+\\frac{1}{2}\\cdot \\frac{7}{12}=\\frac{1}{3},\n$$\n这与使用塔性质得到的结果相符。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1461118"}, {"introduction": "在简单的示例之后，这个问题展示了塔性质在计算机科学领域的实际应用中的威力。通过将塔性质表述为全期望定律，我们可以分析分阶段进行的随机算法的效率。这个练习 [@problem_id:1461125] 通过对第一步中枢轴的随机选择进行条件化，来计算快速排序算法中所需的期望比较次数。", "problem": "考虑一个包含三个不同数字的集合。我们希望使用随机快速排序算法对这些数字进行排序。该算法的步骤如下：\n1.  从当前待排序的数字列表中，均匀随机地选择一个数作为主元。\n2.  将主元与列表中的所有其他数字进行比较，将它们划分为两个子列表：小于主元的和大于主元的。\n3.  然后将该算法递归地应用于任何非空子列表。当一个列表包含一个或零个元素时，递归终止，因为这样的列表已经排序。\n\n令 $C$ 为对最初的三个数字列表完全排序所执行的成对比较的总次数。计算 $C$ 的期望值。\n\n请用最简分数形式表示您的答案。", "solution": "将这三个不同的数字按升序标记为 $x_1  x_2  x_3$。令 $C$ 为比较的总次数。我们根据第一次选择的主元（Pivot）的情况来应用全期望定律。主元从这三个数中均匀随机选择。\n\n有以下两种情况：\n1.  **选择中间的数 $x_2$ 作为主元**：这种情况发生的概率是 $\\frac{1}{3}$。$x_2$ 会与 $x_1$ 和 $x_3$ 进行比较，共计 2 次比较。比较后，列表被划分为两个子列表 $\\{x_1\\}$ 和 $\\{x_3\\}$。这两个子列表都只含一个元素，已经有序，无需进一步比较。因此，在这种情况下，总比较次数为 2。\n2.  **选择最小的数 $x_1$ 或最大的数 $x_3$ 作为主元**：这种情况发生的概率是 $\\frac{2}{3}$。主元会与另外两个数进行比较，共计 2 次比较。比较后，列表被划分为一个空列表和一个包含两个元素的子列表（例如，若主元是 $x_1$，则子列表为 $\\{x_2, x_3\\}$）。对这个包含两个元素的子列表进行排序，还需要 1 次比较。因此，在这种情况下，总比较次数为 $2 + 1 = 3$。\n\n根据全期望定律，总的期望比较次数为：\n$$\nE[C] = (\\text{情况1下的比较次数}) \\times P(\\text{情况1}) + (\\text{情况2下的比较次数}) \\times P(\\text{情况2})\n$$\n$$\nE[C] = 2 \\cdot \\frac{1}{3} + 3 \\cdot \\frac{2}{3} = \\frac{2}{3} + \\frac{6}{3} = \\frac{8}{3}\n$$\n因此，期望的比较次数是 $\\frac{8}{3}$。", "answer": "$$\\boxed{\\frac{8}{3}}$$", "id": "1461125"}, {"introduction": "最后一个练习利用著名的蒙提霍尔问题来揭示塔性质的形式结构和其优美之处。我们将通过在一系列嵌套的 $\\sigma$-代数上系统地应用迭代期望，来解构这个经典的悖论，这些 $\\sigma$-代数代表了游戏中的信息流。这个练习 [@problem_id:1461166] 展示了严谨的、逐步的条件化过程如何能够导出一个清晰明确的解决方案，将一个直观的谜题转变为一个形式化的证明。", "problem": "考虑一个游戏节目，我们将在一个概率空间 $(\\Omega, \\mathcal{F}, P)$ 上对其进行建模。在这个游戏中，有三扇相同的门，分别标记为 1、2 和 3。一扇门后是一辆汽车，另外两扇门后是山羊。汽车的位置是随机的。一位参赛者参与以下过程：\n\n1.  汽车的位置由一个随机变量 $C$ 决定，它在集合 $\\{1, 2, 3\\}$ 上服从均匀分布。\n2.  参赛者做出门的初始选择。这个选择由一个随机变量 $P_0$ 表示，它也在 $\\{1, 2, 3\\}$ 上服从均匀分布，并且与 $C$ 独立。\n3.  主持人知道汽车的位置 ($C$) 和参赛者的选择 ($P_0$)，他会打开另外一扇门，露出一只山羊。主持人打开的门是一个随机变量 $H$。主持人的选择遵循以下规则：\n    - 主持人永远不会打开参赛者选择的门 ($H \\neq P_0$)，也永远不会打开有汽车的门 ($H \\neq C$)。\n    - 如果参赛者的初始选择 $P_0$ 是有汽车的门 ($C=P_0$)，主持人将从两扇有山羊的门中随机选择一扇打开，每扇门被选中的概率为 $1/2$。\n    - 如果参赛者的初始选择不是有汽车的门 ($C \\neq P_0$)，主持人只有一扇门可以打开（即不是 $P_0$ 也不是 $C$ 的那扇门），并且他以概率 1 打开这扇门。\n4.  然后，参赛者可以选择换到剩下那扇未打开的门。令 $S$ 表示参赛者决定换门时会选择的门。$S$ 是集合 $\\{1, 2, 3\\} \\setminus \\{P_0, H\\}$ 中的唯一一扇门。\n\n令 $X = \\mathbf{1}_{\\{C=S\\}}$ 为参赛者通过换门赢得汽车这一事件的指示随机变量。你的任务是计算通过换门获胜的概率，该概率由期望 $E[X]$ 给出。\n\n为此，你必须明确使用条件期望的塔性质。定义 $\\mathcal{F}$ 的两个子-$\\sigma$-代数：$\\mathcal{G}_1 = \\sigma(C)$（汽车位置的信息）和 $\\mathcal{G}_2 = \\sigma(C, P_0)$（汽车位置和参赛者初始选择的信息）。\n\n通过遵循以下强制步骤计算 $E[X]$：\na) 首先，计算条件期望 $Y = E[X|\\mathcal{G}_2]$。你的结果应该是一个关于随机变量 $C$ 和 $P_0$ 的表达式。\nb) 其次，使用你对 $Y$ 的结果来计算 $Z = E[Y|\\mathcal{G}_1]$。\nc) 最后，计算 $E[Z]$ 以求得 $E[X]$ 的值。\n\n将你的最终答案表示为最简分数。", "solution": "令 $X=\\mathbf{1}_{\\{C=S\\}}$。我们将通过塔性质以及 $\\mathcal{G}_{1}=\\sigma(C)$ 和 $\\mathcal{G}_{2}=\\sigma(C,P_{0})$ 来计算 $E[X]$。\n\n首先，计算 $Y=E[X\\mid\\mathcal{G}_{2}] = E[\\mathbf{1}_{\\{C=S\\}}\\mid C,P_{0}]$。在给定 $(C,P_{0})$ 的条件下，唯一剩下的随机性是主持人的选择 $H$，它遵循所述规则。如果 $C=P_{0}$，那么主持人会从两扇有山羊的门中均匀选择一扇，而换门后的门 $S$ 是另一扇有山羊的门，因此 $S\\neq C$，从而 $X=0$ 几乎必然成立。如果 $C\\neq P_{0}$，那么主持人确定性地打开唯一的山羊门 $H\\notin\\{C,P_{0}\\}$，剩下的未开的门是 $S=C$，所以 $X=1$ 几乎必然成立。因此，\n$$\nY=E[X\\mid C,P_{0}]\n=\\begin{cases}\n0,  C=P_{0}\\\\\n1,  C\\neq P_{0}\n\\end{cases}\n=\\mathbf{1}_{\\{C\\neq P_{0}\\}}.\n$$\n\n其次，计算 $Z=E[Y\\mid\\mathcal{G}_{1}]=E[\\mathbf{1}_{\\{C\\neq P_{0}\\}}\\mid C]$。利用 $P_{0}$ 和 $C$ 的独立性以及 $P_{0}$ 在 $\\{1,2,3\\}$ 上的均匀性，我们有\n$$\nZ=E[\\mathbf{1}_{\\{C\\neq P_{0}\\}}\\mid C]\n=1-P(P_{0}=C\\mid C)\n=1-P(P_{0}=C)\n=1-\\frac{1}{3}\n=\\frac{2}{3}.\n$$\n\n最后，根据塔性质，\n$$\nE[X]=E[E(X\\mid\\mathcal{G}_{2})]=E[E(Y\\mid\\mathcal{G}_{1})]=E[Z]=\\frac{2}{3}.\n$$\n因此，通过换门获胜的概率是 $\\frac{2}{3}$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1461166"}]}