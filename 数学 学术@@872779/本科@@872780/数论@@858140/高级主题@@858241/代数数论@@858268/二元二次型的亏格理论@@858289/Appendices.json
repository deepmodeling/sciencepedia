{"hands_on_practices": [{"introduction": "对于给定的判别式，研究二次型的第一步是确定存在多少种不同“类型”的二次型。这个练习 [@problem_id:3085608] 将引导你完成一个基本过程：通过寻找唯一的简约形式，枚举出判别式为 $D=-20$ 的所有等价类。这不仅能确定类数，也让你初步了解如何运用亏格理论来组织和验证这些等价类。", "problem": "设 $f(x,y)=ax^{2}+bxy+cy^{2}$ 是一个判别式为 $D=b^{2}-4ac  0$ 的本原正定二元二次型。如果两个这样的二次型可以通过整数上的特殊线性群 (SL$_{2}(\\mathbb{Z})$) 中行列式为 $1$ 的矩阵作用相互转换，则称它们是真等价的。一个二次型是既约的，如果它满足 $|b|\\leq a\\leq c$，并且在 $|b|=a$ 或 $a=c$ 的情况下，有 $b\\geq 0$。\n\n从这些定义出发，并仅使用二元二次型的既约理论和属理论的基础知识，对判别式 $D=-20$ 执行以下操作：\n\n1. 枚举出所有判别式为 $D=-20$ 的既约本原正定二次型。\n2. 通过借助基于属的类分类以及既约型的基本性质，证明每个既约型代表一个不同的真等价类，并且对于此判别式不存在其他真等价类。\n3. 推导出类数 $h(D)$。\n\n请给出等于 $h(-20)$ 的单个整数作为你的最终答案。", "solution": "该问题要求分析判别式为 $D=-20$ 的本原正定二元二次型。这需要枚举出既约型，证明它们代表了所有不同的真等价类，并最终确定类数 $h(-20)$。\n\n一个本原正定二元二次型是形如 $f(x,y) = ax^2 + bxy + cy^2$ 的表达式，其中 $a, b, c$ 是整数，$\\gcd(a, b, c) = 1$，$a  0$，且判别式 $D = b^2 - 4ac  0$。对于本问题，给定 $D = -20$。\n\n一个二次型被称为既约的，如果其系数满足不等式 $|b| \\leq a \\leq c$，并附加条件：若 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。二元二次型理论中的一个基本结果是，每个本原正定二次型的真等价类都恰好包含一个既约型。因此，类数 $h(D)$ 等于此类既约型的数量。\n\n**1. 枚举既约型**\n\n我们寻求方程 $b^2 - 4ac = -20$ 的满足既约条件的整数解 $(a, b, c)$。\n判别式方程可以重写为 $4ac = b^2 + 20$。由于对于 $D0$ 的正定二次型有 $a0$ 和 $c0$，我们必须有 $b^2+20  0$，这总是成立的。\n根据既约条件 $a \\leq c$，我们有 $4a^2 \\leq 4ac$。代入判别式方程得到 $4a^2 \\leq b^2 + 20$。\n另一个既约条件是 $|b| \\leq a$，这意味着 $b^2 \\leq a^2$。\n结合这些不等式，我们得到 $4a^2 \\leq a^2 + 20$，化简为 $3a^2 \\leq 20$，即 $a^2 \\leq \\frac{20}{3} \\approx 6.667$。\n由于 $a$ 必须是正整数，所以 $a$ 的可能值为 $a=1$ 和 $a=2$。\n\n此外，方程 $b^2 - 4ac = -20$ 意味着 $b^2 = 4ac - 20 = 4(ac-5)$。这表明 $b^2$ 必须是 $4$ 的倍数，因此 $b$ 必须是偶数。\n\n我们现在进行分情况讨论。\n\n情况 1：$a=1$。\n条件 $|b| \\leq a$ 变为 $|b| \\leq 1$。由于 $b$ 必须是偶数，唯一的可能性是 $b=0$。\n将 $a=1$ 和 $b=0$ 代入判别式方程：\n$0^2 - 4(1)c = -20 \\implies -4c = -20 \\implies c=5$。\n我们得到二次型 $(a,b,c) = (1,0,5)$。我们来检查既约条件：\n$|b| \\leq a \\implies |0| \\leq 1$，成立。\n$a \\leq c \\implies 1 \\leq 5$，成立。\n对于 $|b|=a$ 或 $a=c$ 的特殊条件不适用。因此，该二次型是既约的。\n该二次型为 $f_1(x,y) = x^2 + 5y^2$。由于 $\\gcd(1,0,5)=1$，它是本原的。\n\n情况 2：$a=2$。\n条件 $|b| \\leq a$ 变为 $|b| \\leq 2$。由于 $b$ 必须是偶数， $b$ 的可能值为 $b=0$、$b=2$ 和 $b=-2$。\n\n子情况 2a：$b=0$。\n$0^2 - 4(2)c = -20 \\implies -8c = -20 \\implies c = \\frac{20}{8} = \\frac{5}{2}$。这不是一个整数，因此在这种子情况下不存在二次型。\n\n子情况 2b：$b=2$。\n$2^2 - 4(2)c = -20 \\implies 4 - 8c = -20 \\implies 8c = 24 \\implies c=3$。\n我们得到二次型 $(a,b,c) = (2,2,3)$。我们来检查既约条件：\n$|b| \\leq a \\implies |2| \\leq 2$，成立。\n$a \\leq c \\implies 2 \\leq 3$，成立。\n我们有等式 $|b|=a$。特殊条件要求 $b \\geq 0$。由于 $b=2$，此条件满足。因此，该二次型是既约的。\n该二次型为 $f_2(x,y) = 2x^2 + 2xy + 3y^2$。由于 $\\gcd(2,2,3)=1$，它是本原的。\n\n子情况 2c：$b=-2$。\n$(-2)^2 - 4(2)c = -20 \\implies 4 - 8c = -20 \\implies 8c=24 \\implies c=3$。\n我们得到二次型 $(a,b,c) = (2,-2,3)$。我们来检查既约条件：\n$|b| \\leq a \\implies |-2| \\leq 2$，成立。\n$a \\leq c \\implies 2 \\leq 3$，成立。\n我们有等式 $|b|=a$。特殊条件要求 $b \\geq 0$。由于 $b=-2$，此条件不满足。因此，该二次型不是既约的。（事实上，它在变换 $(x,y) \\mapsto (x+y, y)$ 下与二次型 $(2,2,3)$ 真等价。）\n\n我们的穷举搜索恰好找到了两个判别式为 $D=-20$ 的既约本原正定二次型：\n1. $f_1(x,y) = x^2 + 5y^2$\n2. $f_2(x,y) = 2x^2 + 2xy + 3y^2$\n\n**2. 通过属理论进行证明**\n\n二次型的既约理论断言，真等价类集合与既约型集合之间存在一一对应关系。由于我们恰好找到了两个不同的既约型，因此对于判别式 $D=-20$，恰好有两个真等价类。\n\n为了用属理论来证实这一结果，我们首先确定 $D=-20$ 的属的数量。一个判别式 $D$ 是基本的，如果它不能写成 $D'k^2$ 的形式，其中 $D'$ 是另一个判别式， $k1$ 是整数。等价地，对于 $D0$，$D$ 是基本的，如果 $D \\equiv 1 \\pmod 4$ 且无平方因子，或者 $D=4m$ 且 $m \\equiv 2,3 \\pmod 4$ 且 $m$ 无平方因子。这里，$D=-20 = 4(-5)$。由于 $m=-5$ 无平方因子且 $-5 \\equiv 3 \\pmod 4$，所以 $D=-20$ 是一个基本判别式。\n\n对于一个基本判别式 $D$，属的数量 $g(D)$ 由 $g(D) = 2^{k-1}$ 给出，其中 $k$ 是 $D$ 的不同素因子的数量。$D=-20 = -1 \\cdot 2^2 \\cdot 5$ 的素因子是 $2$ 和 $5$。因此，$k=2$。\n属的数量为 $g(-20) = 2^{2-1} = 2$。\n\n所有类 $C(D)$ 的集合被划分为 $g(D)$ 个属，每个属包含相同数量的类，即 $|C(D)|/g(D) = h(D)/g(D)$。\n在我们的例子中，有两个属。这意味着类数 $h(-20)$ 必须是 $2$ 的倍数。\n\n属由一组特征来区分。对于 $D=-20$，特征由 $D$ 的素因子决定。我们有一个奇素因子 $p=5$，它给出了特征 $\\chi_5(n) = (\\frac{n}{5})$，其中 $(\\frac{\\cdot}{\\cdot})$ 是勒让德符号。由于 $D/4 = -5 \\equiv 3 \\pmod 4$，还有一个附加特征 $\\chi_{-4}(m) = (-1)^{(m-1)/2}$，其中 $m$ 是由二次型表示的一个整数。对于任何与 $2D$ 互素且可由给定属中任何二次型表示的整数 $m$，这些特征的值是恒定的。\n\n我们来计算我们找到的两个既约型的特征值：\n\n对于 $f_1(x,y) = x^2 + 5y^2$：该二次型表示 $1$（通过令 $x=1, y=0$）。我们有 $\\gcd(1, 2D) = \\gcd(1, -40) = 1$。特征值为：\n$\\chi_5(1) = (\\frac{1}{5}) = 1$。\n$\\chi_{-4}(1) = (-1)^{(1-1)/2} = (-1)^0 = 1$。\n$f_1$ 所在属的特征串是 $(1,1)$。这是主属，它总是包含主型（类群的单位元）。\n\n对于 $f_2(x,y) = 2x^2 + 2xy + 3y^2$：该二次型表示 $c=3$（通过令 $x=0, y=1$）。我们有 $\\gcd(3, 2D) = \\gcd(3, -40)=1$。特征值为：\n$\\chi_5(3) = (\\frac{3}{5}) = -1$。\n$\\chi_{-4}(3) = (-1)^{(3-1)/2} = (-1)^1 = -1$。\n$f_2$ 所在属的特征串是 $(-1,-1)$。\n\n由于二次型 $f_1$ 和 $f_2$ 有不同的特征串，它们属于不同的属。我们找到了两个二次型，而恰好有两个属。这意味着每个二次型代表一个位于不同属中的类。因为我们对既约型的枚举只得到了这两个，所以可以推断每个属恰好包含一个类。\n\n这证实了不存在其他真等价类。存在两个既约型，分布在两个已存在的属中，每个属一个，这为 $D=-20$ 的类提供了完整的分类。\n\n**3. 类数 $h(-20)$**\n\n类数 $h(D)$ 是判别式为 $D$ 的本原正定二次型的真等价类的数量。根据既约型的枚举，这个数量是 $2$。\n$h(-20) = (\\text{既约型的数量}) = 2$。\n属理论的分析证实了这一点：存在两个属，我们在每个属中找到了一个类，总共是两个类。因此，$h(-20)=2$。", "answer": "$$\\boxed{2}$$", "id": "3085608"}, {"introduction": "等价类集合不仅仅是一个列表，它构成了一个有限阿贝尔群。这个练习 [@problem_id:3085598] 提供了一个动手实践的机会，让你通过高斯复合计算一个类的平方，从而直观地理解其群结构。完成这个计算将揭示群运算与亏格结构之间的深刻联系，即任何类的平方都落在主亏格中。", "problem": "设 $f(x,y) = a x^{2} + b x y + c y^{2}$ 是一个判别式为 $D = b^{2} - 4 a c$ 的原始正定二元二次型。考虑具体形式 $f(x,y) = 2 x^{2} + 2 x y + 3 y^{2}$ 以及它在判别式为 $D$ 的原始正定二元二次型类群中的类 $[f]$。使用高斯类复合，通过将 $f$ 与自身复合来计算其平方 $[f]^{2}$，然后将所得的二次型约化为判别式为 $D$ 的一个约化代表元 $(A,B,C)$。接下来，使用二元二次型的属论，判断 $[f]^{2}$ 是否与判别式为 $D$ 的主型 $p(x,y) = x^{2} + 5 y^{2}$ 属于同一个属，并通过一个隶属指示符 $\\gamma$ 来表示你的判断，其中如果 $[f]^{2}$ 与主型属于同一个属，则 $\\gamma = 1$，否则 $\\gamma = 0$。将你的最终答案以行矩阵 $\\begin{pmatrix} A  B  C  \\gamma \\end{pmatrix}$ 的形式报告。无需四舍五入。", "solution": "用户提供的问题陈述已经过验证，是合理的。它在科学上基于二元二次型理论，问题定义明确、客观，并包含一个完整且一致的设定。\n\n该问题要求进行几项与二元二次型 $f(x,y) = 2 x^{2} + 2 x y + 3 y^{2}$ 相关的计算。\n\n首先，我们确定二次型 $f$ 的系数和判别式。系数为 $(a, b, c) = (2, 2, 3)$。由于 $\\gcd(2, 2, 3) = 1$，该二次型是原始的。判别式为 $D = b^{2} - 4 a c = 2^{2} - 4(2)(3) = 4 - 24 = -20$。因为 $a=20$ 且 $D=-20  0$，该二次型是正定的。\n\n问题还指明了判别式为 $D$ 的主型为 $p(x,y) = x^{2} + 5 y^{2}$。其系数为 $(1, 0, 5)$。它的判别式是 $0^{2} - 4(1)(5) = -20$，与 $D$ 一致。二次型 $(1,0,5)$ 是判别式 $D=-20$ 的约化主型。\n\n第一步是计算 $f$ 的类的平方，记为 $[f]^{2}$，通过将 $f$ 与自身复合得到。我们对判别式为 $D=-20$ 的二次型使用高斯复合。设 $f$ 的类由二次型 $(a_1, b_1, c_1) = (2, 2, 3)$ 代表。要将其与自身复合，我们需要将其与同一个类中的一个二次型 $(a_2, b_2, c_2)$ 进行复合。\n\n当 $\\gcd(a_1, a_2) = 1$ 时，标准的复合算法会得到简化。由于我们将 $(2, 2, 3)$ 与自身复合，有 $a_1=a_2=2$，且 $\\gcd(2,2)=2 \\neq 1$。我们必须先找到一个与 $(2, 2, 3)$ 真等价的二次型 $(a', b', c')$，使得 $\\gcd(2, a') = 1$。\n如果对于互质整数 $x_0, y_0$ 有 $N = ax_0^2+bx_0y_0+cy_0^2$，则称二次型 $ax^2+bxy+cy^2$ 真表示整数 $N$。在这种情况下，存在一个等价的二次型，其首项系数为 $N$。我们选择 $x_0=1, y_0=1$。那么 $f(1,1) = 2(1)^2 + 2(1)(1) + 3(1)^2 = 7$。由于 $\\gcd(1,1)=1$，存在一个首项系数为 7 的等价二次型。由于 $\\gcd(2,7)=1$，这个二次型就足够了。\n我们通过一个行列式为 $ps-qr=1$ 的变换矩阵 $\\begin{pmatrix} p  r \\\\ q  s \\end{pmatrix}$ 来找到这个二次型。我们可以取 $(p,q)=(1,1)$。为了使 $ps-qr=1$，我们需要 $s-r=1$。一个简单的选择是 $r=0, s=1$。变量的变换方式是 $x' \\to px+ry, y' \\to qx+sy$。我们使用 $(p,q)=(1,1)$ 和 $(r,s)=(0,1)$。新的系数 $(a',b',c')$ 是：\n$a' = a p^2 + b pq + c q^2 = 2(1)^2 + 2(1)(1) + 3(1)^2 = 7$。\n$b' = 2apr + b(ps+qr) + 2cqs = 2(2)(1)(0) + 2(1 \\cdot 1 + 1 \\cdot 0) + 2(3)(1)(1) = 0 + 2 + 6 = 8$。\n$c' = a r^2 + b rs + c s^2 = 2(0)^2 + 2(0)(1) + 3(1)^2 = 3$。\n等价的二次型是 $f'(x,y) = 7x^2+8xy+3y^2$。其判别式为 $8^2-4(7)(3) = 64-84=-20$。\n现在我们复合 $(a_1, b_1, c_1) = (2, 2, 3)$ 和 $(a_2, b_2, c_2) = (7, 8, 3)$。复合后的二次型是 $(A,B,C)$。\n$A = a_1 a_2 = 2 \\cdot 7 = 14$。\n$B$ 是同余方程组 $B \\equiv b_1 \\pmod{2a_1}$ 和 $B \\equiv b_2 \\pmod{2a_2}$ 在模 $2A = 28$ 意义下的唯一解。\n$B \\equiv 2 \\pmod{4}$\n$B \\equiv 8 \\pmod{14}$\n从第一个同余式，对于某个整数 $k$，有 $B = 4k+2$。代入第二个同余式：$4k+2 \\equiv 8 \\pmod{14}$，化简为 $4k \\equiv 6 \\pmod{14}$。此同余式有解，因为 $\\gcd(4,14)=2$ 整除 $6$。将同余式（包括模）两边同除以 $2$，得到 $2k \\equiv 3 \\pmod 7$。两边乘以 $4$（$2$ 在模 $7$ 意义下的逆元），得到 $8k \\equiv 12 \\pmod 7$，所以 $k \\equiv 5 \\pmod 7$。\n取 $k=5$，我们得到 $B = 4(5)+2=22$。\n$C$ 通过公式 $C = \\frac{B^2 - D}{4A} = \\frac{22^2 - (-20)}{4(14)} = \\frac{484+20}{56} = \\frac{504}{56} = 9$ 求得。\n复合得到的二次型为 $(14, 22, 9)$。\n\n第二步是找到与 $(14, 22, 9)$ 等价的唯一约化二次型。一个正定二次型 $(a,b,c)$ 是约化的，如果满足 $|b| \\le a \\le c$，并且在 $|b|=a$ 或 $a=c$ 的情况下，有 $b \\geq 0$。\n我们的二次型 $(14, 22, 9)$ 不是约化的，因为 $|b|  a$ 且 $ac$。\n首先，应用一个变换来约化 $b$。我们应用 $(x,y) \\to (x-ky, y)$ 将 $b$ 变为 $b-2ak$。取 $k=1$，$b$ 变为 $22 - 2(14)(1) = -6$。条件 $|-6| \\le 14$ 得到满足。新的二次型是 $(a, b-2ak, ak^2-bk+c) = (14, -6, 14(1)^2 - 22(1) + 9) = (14, -6, 1)$。\n现在的二次型是 $(14, -6, 1)$。它不是约化的，因为 $ac$。我们应用变换 $(x,y) \\to (-y,x)$，它将 $(a,b,c)$ 映射到 $(c,-b,a)$。新的二次型是 $(1, 6, 14)$。\n这个二次型也不是约化的，因为 $|b|  a$ ($61$)。我们再次应用变换来约化 $b$。我们将 $b$ 变为 $b-2ak$。取 $k=3$，$b$ 变为 $6-2(1)(3)=0$。条件 $|0| \\le 1$ 得到满足。新的二次型是 $(a, b-2ak, ak^2-bk+c) = (1, 0, 1(3)^2-6(3)+14) = (1, 0, 9-18+14) = (1, 0, 5)$。\n该二次型为 $(1,0,5)$。我们检查它是否是约化的：$a=1, b=0, c=5$。我们有 $|0| \\le 1 \\le 5$，成立。因此，这是约化二次型。\n所以，与 $[f]^2$ 对应的约化二次型是 $(A,B,C) = (1,0,5)$。\n\n第三步是确定 $[f]^2$ 是否与主型 $p(x,y)=x^2+5y^2$ 属于同一个属。\n约化后的二次型 $(1,0,5)$ 正是主型 $p(x,y)$。根据定义，任何二次型都与其自身属于同一个属。因此，$[f]^2$ 与主型属于同一个属。\n根据主亏格定理，任何二次型类的平方都属于主亏格。由于主型 $(1,0,5)$ 的类是类群的单位元，它定义了主亏格。我们的计算结果 $[f]^2 = [(1,0,5)]$ 证实了这个一般性定理。\n因此，隶属指示符 $\\gamma=1$。\n\n最后，我们将结果以行矩阵 $\\begin{pmatrix} A  B  C  \\gamma \\end{pmatrix}$ 的形式报告。\n$A=1, B=0, C=5, \\gamma=1$。\n最终答案是 $\\begin{pmatrix} 1  0  5  1 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  0  5  1 \\end{pmatrix}}\n$$", "id": "3085598"}, {"introduction": "亏格理论最辉煌的成就之一，是它能够回答哪些数可以被二次型表示的问题。这个练习 [@problem_id:3085618] 展示了这一应用，要求你将判别式为 $D=-15$ 的所有类划分到不同的亏格，并确定支配每个亏格表示哪些素数的具体同余条件。这将在抽象的代数结构与具体的数论结论之间架起一座桥梁。", "problem": "设 $D=-15$ 是一个负基本判别式。考虑判别式为 $b^{2}-4ac=D$ 的本原正定二元二次型 $f(x,y)=ax^{2}+bxy+cy^{2}$，这些二次型在特殊线性群 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 的作用下取至真等价。一个亏格被定义为判别式为 $D$ 的类群中平方元的一个陪集。\n\n任务：\n- 确定判别式为 $D$ 的所有本原正定二次型的简化类，并找出主类。\n- 从第一性原理出发，使用亏格理论确定判别式为 $D$ 的亏格数量，并将每个类分配到其对应的亏格。\n- 对于奇素数 $p$ 且 $p \\nmid 15$，确定由每个亏格表示的素数所满足的模 $15$ 的同余条件，这些条件由相关二次特征的值导出。\n- 明确列出每个亏格所能表示的小于等于 $100$ 且 $p \\nmid 15$ 的奇素数集合。\n\n最后，设 $S$ 表示所有由主亏格表示的小于等于 $100$ 且 $p \\nmid 15$ 的奇素数之和。计算 $S$。请提供确切的整数值（无需四舍五入）。", "solution": "该问题陈述经评估有效。这是一个在数论（特别是二元二次型的亏格理论）的既定数学框架内提出来的、适定的、有科学依据且自洽的问题。所有给定条件都是一致的，任务定义清晰，可以导出一个唯一且可验证的解。\n\n设判别式为 $D = -15$。这是一个负基本判别式，因为 $-15 \\equiv 1 \\pmod{4}$ 且它是无平方因子数。我们考虑判别式为 $b^{2}-4ac=D$ 的本原正定二元二次型 $f(x,y)=ax^{2}+bxy+cy^{2}$。\n\n**第一部分：简化类的确定**\n\n一个本原正定二次型 $(a,b,c)$ 是简化的，如果其系数满足条件 $|b| \\leq a \\leq c$，并且如果 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。\n判别式为 $b^{2}-4ac = -15$，这意味着 $4ac = b^{2}+15$。\n由于二次型是正定的，所以 $a  0$ 且 $c  0$。条件 $|b| \\leq a \\leq c$ 意味着 $b^{2} \\leq a^{2}$ 且 $a \\leq c$，因此 $a^{2} \\leq ac$。\n代入判别式方程：$4a^{2} \\leq 4ac = b^{2}+15$。\n由于 $b^{2} \\leq a^{2}$，我们有 $4b^{2} \\leq 4a^{2} \\leq b^{2}+15$，这意味着 $3b^{2} \\leq 15$，即 $b^{2} \\leq 5$。\n判别式 $D=-15$ 是奇数，所以 $b$ 必须是奇数。因此，$b$ 可能的整数值为 $b \\in \\{-1, 1\\}$。\n简化条件要求当 $|b|=a$ 或 $a=c$ 时 $b \\geq 0$。我们可以分析 $b \\geq 0$ 的情况，然后确认它们生成了所有简化型。让我们从 $b=1$ 开始。\n\n情况 $b=1$：\n$4ac = 1^{2}+15 = 16$，所以 $ac=4$。\n简化条件 $|b| \\leq a \\leq c$ 变为 $1 \\leq a \\leq c$。\n满足 $ac=4$ 和 $1 \\leq a \\leq c$ 的整数对 $(a,c)$ 是 $(1,4)$ 和 $(2,2)$。\n\n1.  对于 $(a,c)=(1,4)$，我们得到二次型 $f_1(x,y)=x^{2}+xy+4y^{2}$。\n    我们检查它是否是简化的：$a=1, b=1, c=4$。我们有 $|1| \\leq 1 \\leq 4$，成立。\n    并且，我们有 $|b|=a$。条件要求 $b \\geq 0$，由于 $b=1$ 这是成立的。\n    该二次型是本原的，因为 $\\gcd(1,1,4)=1$。\n    这是一个简化型。由于 $a=1$，这是主型，其类是类群中的单位元。\n\n2.  对于 $(a,c)=(2,2)$，我们得到二次型 $f_2(x,y)=2x^{2}+xy+2y^{2}$。\n    我们检查它是否是简化的：$a=2, b=1, c=2$。我们有 $|1| \\leq 2 \\leq 2$，成立。\n    并且，我们有 $a=c$。条件要求 $b \\geq 0$，由于 $b=1$ 这是成立的。\n    该二次型是本原的，因为 $\\gcd(2,1,2)=1$。\n    这也是一个简化型。\n\n如果我们考虑 $b=-1$，我们会得到像 $x^{2}-xy+4y^{2}$ 和 $2x^{2}-xy+2y^{2}$ 这样的二次型。它们不是简化的，因为它们违反了条件中 $b \\geq 0$ 的部分（因为第一个型满足 $|b|=a$，第二个型满足 $a=c$）。它们分别与 $f_1$ 和 $f_2$ 真等价。例如，$2x^2-xy+2y^2$ 通过变换 $(x,y) \\mapsto (x, -y)$ 复合 $(x,y) \\mapsto (-y,x)$，即 $(x,y) \\to (y,x)$，与 $2x^2+xy+2y^2$ 等价，但这不在 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 中。正确的变换是 $(x,y) \\mapsto (x+y,-y)$ 后接 $(x,y) \\mapsto (-y,x)$。我们使用标准的简化算法。对于 $(2,-1,2)$，$b0$ 且 $a=c$，因此它不是简化的。它等价于 $(2,1,2)$。\n\n对于 $D=-15$，存在两个本原正定二次型的简化类。类数为 $h(-15)=2$。类群同构于 $\\mathbb{Z}/2\\mathbb{Z}$。\n主类是 $f_1(x,y)=x^{2}+xy+4y^{2}$ 的类。\n\n**第二部分：亏格理论与类的分配**\n\n对于一个基本判别式 $D$，亏格的数量为 $2^{r-1}$，其中 $r$ 是 $D$ 的不同素因子的数量。这里 $D=-15 = -3 \\cdot 5$。不同的素因子是 $3$ 和 $5$。所以 $r=2$。亏格的数量是 $2^{2-1}=2$。\n\n亏格由二次特征的值来区分。对于一个由二次型 $f$ 表示的奇素数 $p \\nmid D$，判别式 $D=-15$ 的亏格特征是 $\\chi_3(f) = (\\frac{p}{3})$ 和 $\\chi_5(f) = (\\frac{p}{5})$。对于任何给定的亏格，特征值的乘积必须为 $1$。因此，可能的特征值对 $(\\epsilon_3, \\epsilon_5)$ 是 $(1,1)$ 和 $(-1,-1)$。\n\n-   **亏格 1 (主亏格)**：其特征为 $(\\chi_3, \\chi_5) = (1,1)$。\n    主型 $f_1 = x^{2}+xy+4y^{2}$ 属于主亏格。\n    我们来验证这一点。如果一个素数 $p$ 被 $f_1$ 表示，则 $p=x^{2}+xy+4y^{2}$。\n    模 $3$：$p \\equiv x^{2}+xy+y^{2} \\equiv (x-y)^{2} \\pmod{3}$。由于 $p \\nmid 3$，我们有 $p \\equiv 1 \\pmod{3}$，所以 $(\\frac{p}{3})=1$。\n    模 $5$：$4p=4x^{2}+4xy+16y^{2}=(2x+y)^{2}+15y^{2} \\equiv (2x+y)^{2} \\pmod{5}$。由于 $p \\nmid 5$，我们有 $4p$ 是模 $5$ 的二次剩余。因为 $(\\frac{4}{5})=1$，这意味着 $(\\frac{p}{5})=1$。\n    所以任何由 $f_1$ 表示的素数都有特征 $(1,1)$。$f_1$ 的类在主亏格中。\n\n-   **亏格 2**：其特征为 $(\\chi_3, \\chi_5) = (-1,-1)$。\n    另一个由 $f_2 = 2x^{2}+xy+2y^{2}$ 代表的类，必须属于另一个亏格。\n    我们可以通过找到一个由 $f_2$ 表示的素数来验证这一点。对于 $(x,y)=(3,-1)$，$f_2(3,-1)=2(9)+(-3)+2(1)=17$。\n    特征为 $\\chi_3(f_2) = (\\frac{17}{3}) = (\\frac{2}{3})=-1$ 和 $\\chi_5(f_2) = (\\frac{17}{5}) = (\\frac{2}{5})=-1$。\n    这证实了 $f_2$ 的类属于特征为 $(-1,-1)$ 的亏格。\n\n**第三部分：素数表示的同余条件**\n\n一个奇素数 $p$ 且 $p \\nmid 15$ 能被判别式为 $D=-15$ 的二次型表示，当且仅当 $(\\frac{D}{p})=(\\frac{-15}{p})=1$。\n使用二次互反律：$(\\frac{-15}{p}) = (\\frac{-1}{p})(\\frac{3}{p})(\\frac{5}{p}) = (-1)^{\\frac{p-1}{2}} \\cdot (\\frac{p}{3})(-1)^{\\frac{p-1}{2}} \\cdot (\\frac{p}{5}) = (\\frac{p}{3})(\\frac{p}{5})$。\n所以 $p$ 能被表示，当且仅当 $(\\frac{p}{3})$ 和 $(\\frac{p}{5})$ 同为 $1$ 或同为 $-1$。这两种情况对应于两个亏格。\n\n-   **主亏格 ($f_1$)**：表示满足 $(\\frac{p}{3})=1$ 和 $(\\frac{p}{5})=1$ 的素数 $p$。\n    - $(\\frac{p}{3})=1 \\implies p \\equiv 1 \\pmod{3}$。\n    - $(\\frac{p}{5})=1 \\implies p \\equiv 1 \\text{ 或 } 4 \\pmod{5}$。\n    根据中国剩余定理：\n    $p \\equiv 1 \\pmod{3}$ 且 $p \\equiv 1 \\pmod{5} \\implies p \\equiv 1 \\pmod{15}$。\n    $p \\equiv 1 \\pmod{3}$ 且 $p \\equiv 4 \\pmod{5} \\implies p \\equiv 4 \\pmod{15}$。\n    同余条件：$p \\equiv 1, 4 \\pmod{15}$。\n\n-   **第二亏格 ($f_2$)**：表示满足 $(\\frac{p}{3})=-1$ 和 $(\\frac{p}{5})=-1$ 的素数 $p$。\n    - $(\\frac{p}{3})=-1 \\implies p \\equiv 2 \\pmod{3}$。\n    - $(\\frac{p}{5})=-1 \\implies p \\equiv 2 \\text{ 或 } 3 \\pmod{5}$。\n    根据中国剩余定理：\n    $p \\equiv 2 \\pmod{3}$ 且 $p \\equiv 2 \\pmod{5} \\implies p \\equiv 2 \\pmod{15}$。\n    $p \\equiv 2 \\pmod{3}$ 且 $p \\equiv 3 \\pmod{5} \\implies p \\equiv 8 \\pmod{15}$。\n    同余条件：$p \\equiv 2, 8 \\pmod{15}$。\n\n**第四部分：由各亏格表示的素数列表**\n\n我们列出小于等于 $100$ 且 $p \\nmid 15$（即 $p \\notin \\{2,3,5\\}$）的奇素数，并对其进行分类。\n\n-   **由主亏格表示 ($p \\equiv 1, 4 \\pmod{15}$)**：\n    - $p \\equiv 1 \\pmod{15}$：$31, 61$。\n    - $p \\equiv 4 \\pmod{15}$：$19, 79$。\n    素数集合为 $\\{19, 31, 61, 79\\}$。\n\n-   **由第二亏格表示 ($p \\equiv 2, 8 \\pmod{15}$)**：\n    - $p \\equiv 2 \\pmod{15}$：$17, 47$。\n    - $p \\equiv 8 \\pmod{15}$：$23, 53, 83$。\n    素数集合为 $\\{17, 23, 47, 53, 83\\}$。\n\n满足 $(\\frac{-15}{p})=-1$ 的素数不能被该判别式的任何二次型表示。这些是列表中的其余素数，例如 $7, 11, 13, \\dots, 97$。例如，对于 $p=7$，$(\\frac{7}{3})=1$ 且 $(\\frac{7}{5})=-1$，所以 $(\\frac{-15}{7})=-1$。\n\n**第五部分：S 的计算**\n\n数量 $S$ 是所有由主亏格表示的、小于等于 $100$ 且 $p \\nmid 15$ 的奇素数之和。使用第四部分中的列表：\n$S = 19 + 31 + 61 + 79$\n$S = 50 + 140$\n$S = 190$\n确切的整数值为 $190$。", "answer": "$$\\boxed{190}$$", "id": "3085618"}]}