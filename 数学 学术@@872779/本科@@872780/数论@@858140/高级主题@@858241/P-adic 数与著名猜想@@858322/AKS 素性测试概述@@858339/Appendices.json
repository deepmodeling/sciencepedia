{"hands_on_practices": [{"introduction": "AKS素性检验以一个简单而高效的筛选步骤开始：检查给定的数是否是完美幂。这一初始步骤可以迅速识别出一大类合数，而无需动用算法中更复杂的部分。本练习 [@problem_id:3087905] 将引导您对一个小的整数进行检验，展示了如何通过将数表示为 $n=b^a$ 的形式来立即证明其为合数。", "problem": "在 Agrawal–Kayal–Saxena (AKS) 素性检验中，初始步骤是检查一个给定的整数 $n \\geq 2$ 是否是完美幂，即是否存在整数 $a \\geq 2$ 和 $b \\geq 2$ 使得 $n = b^{a}$。仅从核心定义和初等数论中经过充分检验的事实出发，通过显式地找出满足 $216 = b^{a}$ 的整数 $b$ 和 $a$（如果存在），来判断 $n = 216$ 是否是完美幂。然后，使用素性和合性的定义，解释为什么 AKS 素性检验会在此步骤正确终止并判定 $n$ 是合数。将你的最终答案以行矩阵的形式写成有序对 $(b,a)$。使用精确整数，无需四舍五入。", "solution": "问题要求我们判断整数 $n = 216$ 是否是完美幂，并解释这对 Agrawal–Kayal–Saxena (AKS) 素性检验的影响。\n\n首先，我们验证问题陈述。\n**步骤 1：提取已知信息**\n- 待检验的整数是 $n = 216$。\n- 条件 $n \\geq 2$ 得到满足。\n- 背景是 AKS 素性检验的初始步骤。\n- 如果存在整数 $a \\geq 2$ 和 $b \\geq 2$ 使得 $n = b^{a}$，则数 $n$ 是一个完美幂。\n- 任务是为 $n=216$ 找到这样的整数 $b$ 和 $a$（如果存在的话）。\n- 任务要求解释为什么 AKS 检验会在此步骤正确地得出 $n$ 是合数的结论。\n- 最终答案是以行矩阵形式表示的有序对 $(b,a)$。\n\n**步骤 2：使用提取的已知信息进行验证**\n- 该问题在科学上基于初等数论和算法分析。完美幂、素性和合性的概念是基本且明确定义的。\n- 该问题是适定的。它要求检查特定整数 $n=216$ 的一个特定属性。无论肯定还是否定，解都保证存在且结论唯一。\n- 该问题是客观的，并使用了精确的数学语言。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行解答。\n\n任务的核心是判断 $n = 216$ 是否能表示为 $n = b^{a}$ 的形式，其中整数 $b \\geq 2$ 且 $a \\geq 2$。这等价于找到一个整数 $a \\geq 2$，使得 $b = \\sqrt[a]{n} = \\sqrt[a]{216}$ 是一个大于或等于 $2$ 的整数。\n\n为了找到这样的指数 $a$，我们可以为搜索范围设定一个上界。因为 $b$ 必须至少为 $2$，我们有不等式：\n$$n = b^{a} \\geq 2^{a}$$\n代入 $n = 216$：\n$$216 \\geq 2^{a}$$\n为了找到 $a$ 可能的最大整数值，我们可以对两边取以 $2$ 为底的对数：\n$$a \\leq \\log_{2}(216)$$\n我们知道 $2$ 的幂：$2^{7} = 128$ 和 $2^{8} = 256$。因为 $128  216  256$，所以 $7  \\log_{2}(216)  8$。因此，任何整数指数 $a$ 都必须满足 $a \\leq 7$。由于我们要求 $a \\geq 2$，我们需要测试的 $a$ 的可能整数值为 $2, 3, 4, 5, 6, 7$。\n\n我们现在系统地测试这些 $a$ 的值：\n- 当 $a=2$ 时：我们检查 $b = \\sqrt{216}$ 是否为整数。我们知道 $14^{2} = 196$ 且 $15^{2} = 225$。因为 $196  216  225$，所以 $\\sqrt{216}$ 不是整数。\n- 当 $a=3$ 时：我们检查 $b = \\sqrt[3]{216}$ 是否为整数。我们可以测试一些小的整数：$5^{3} = 125$ 和 $6^{3} = 6 \\times 6 \\times 6 = 36 \\times 6 = 216$。我们发现当 $a=3$ 时，$b=6$。\n\n因为我们已经找到了整数对 $(b,a) = (6,3)$，其中 $b=6 \\geq 2$ 且 $a=3 \\geq 2$，我们成功地证明了 $n = 216$ 是一个完美幂，因为 $216 = 6^{3}$。我们可以在这里停止搜索，因为问题只要求我们找到这样一对整数即可。\n\n接下来，我们必须解释为什么 AKS 素性检验会在此阶段正确终止，并将 $n$ 分类为合数。\n\n根据定义，如果一个数 $n > 1$ 不是素数，那么它就是合数。一个数是素数，如果它的正因数只有 $1$ 和它本身。因此，如果存在一个 $n$ 的因数 $d$ 满足 $1  d  n$，则 $n$ 是合数。\n\nAKS 算法的第一步是检查输入数 $n$ 是否为完美幂。如果 $n = b^{a}$ 对于整数 $b \\geq 2$ 和 $a \\geq 2$ 成立，那么 $b$ 是 $n$ 的一个因数。我们必须验证 $b$ 是一个非平凡因数。\n1. 因为 $b \\geq 2$，我们有 $b > 1$。\n2. 因为 $a \\geq 2$ 且 $b \\geq 2$，我们有 $b^{a} > b^{1}$，这意味着 $n > b$。\n\n综合这两点，我们得到 $1  b  n$。这表明 $b$ 是 $n$ 的一个既不是 $1$ 也不是 $n$ 的因数。在我们的具体例子中，$n = 216$ 且 $b = 6$。因数是 $6$，它满足 $1  6  216$。这个非平凡因数 $6$ 的存在证明了 $216$ 是一个合数。\n\n因此，一旦发现 $n=216$ 是一个完美幂 ($6^3$)，AKS 算法会立即正确终止，并得出 $216$ 是合数的结论，而无需进入该检验中计算更为密集的步骤。\n\n找到的明确整数是 $b=6$ 和 $a=3$。问题要求以行矩阵的形式给出有序对 $(b,a)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6  3\n\\end{pmatrix}\n}\n$$", "id": "3087905"}, {"introduction": "AKS检验的核心在于一个对于素数成立的特殊多项式同余关系。本练习 [@problem_id:3087840] 邀请您为一个小的素数 $n=7$ 验证这个核心恒等式。通过完成这个计算，您将亲身体验素数模下的二项式系数性质以及多项式环中的算术，这些都是该测试得以运作的基础机制。", "problem": "在 Agrawal–Kayal–Saxena (AKS) 素性检验中，一个关于多项式环对一个整数取模的关键同余式为一个给定的整数是素数提供了凭证。特化到素数情况可确保同余式自然成立。令 $n=7$，$r=5$，且 $a=2$。在商环 $\\mathbb{Z}_{7}[x]/(x^{5}-1)$ 中进行运算，该环是系数在 $\\mathbb{Z}_{7}$ 中，并对由 $x^{5}-1$ 生成的理想取模的多项式环。仅从二项式定理、二项式系数对素数取模的基本整除性质以及商环中同余的定义出发，计算 $(x+2)^{7}$ 的剩余类的次数小于 $5$ 的唯一代表。将你的最终答案表示为关于 $x$ 的单个多项式表达式（无需四舍五入，也无单位）。", "solution": "该问题是有效的，因为它在科学上基于数论和抽象代数，问题提出得很好，有唯一且有意义的解，并且陈述客观。所有必要的信息都已提供，且约束条件是一致的。\n\n目标是计算 $(x+2)^{7}$ 在商环 $\\mathbb{Z}_{7}[x]/\\langle x^{5}-1 \\rangle$ 中次数小于 $5$ 的剩余类的唯一代表。整数 $n=7$ 是素数，这是一个关键的观察。计算过程主要分两个阶段：首先，我们在环 $\\mathbb{Z}_{7}[x]$ 中计算多项式表达式，这涉及到将系数对 $7$ 取模；其次，我们将得到的多项式对由 $x^{5}-1$ 生成的理想取模。\n\n首先，我们考虑 $(x+2)^{7}$ 在整系数多项式环上的展开。根据二项式定理，我们有：\n$$ (x+2)^{7} = \\sum_{k=0}^{7} \\binom{7}{k} x^{k} 2^{7-k} $$\n展开这个和式得到：\n$$ (x+2)^{7} = \\binom{7}{0}2^{7} + \\binom{7}{1}2^{6}x + \\binom{7}{2}2^{5}x^{2} + \\binom{7}{3}2^{4}x^{3} + \\binom{7}{4}2^{3}x^{4} + \\binom{7}{5}2^{2}x^{5} + \\binom{7}{6}2^{1}x^{6} + \\binom{7}{7}x^{7} $$\n\n现在，我们必须在域 $\\mathbb{Z}_{7}$ 中找到系数。这需要计算二项式系数 $\\binom{7}{k}$ 对 $7$ 取模。问题指引我们使用二项式系数对素数取模的基本整除性质。对于一个素数 $p$，二项式系数 $\\binom{p}{k}$ 对于所有满足 $1 \\le k \\le p-1$ 的整数 $k$ 都能被 $p$ 整除。这可以从定义 $\\binom{p}{k} = \\frac{p!}{k!(p-k)!}$ 看出。对于 $1 \\le k \\le p-1$，分子包含素因子 $p$，而分母不包含，因为其所有因子都是严格小于 $p$ 的整数。因此，分子中的素因子 $p$ 不会被消去。\n\n因为 $n=7$ 是一个素数，我们有对于 $k \\in \\{1, 2, 3, 4, 5, 6\\}$，$\\binom{7}{k} \\equiv 0 \\pmod{7}$。在 $\\mathbb{Z}_{7}$ 中唯一非零的系数是当 $k=0$ 和 $k=7$ 时：\n$$ \\binom{7}{0} = 1 \\equiv 1 \\pmod{7} $$\n$$ \\binom{7}{7} = 1 \\equiv 1 \\pmod{7} $$\n\n将此性质应用于 $(x+2)^{7}$ 的展开式，当系数对 $7$ 取模时，所有中间项都消失了。\n$$ (x+2)^{7} \\equiv \\binom{7}{0}2^{7} x^{0} + \\binom{7}{7}2^{0} x^{7} \\pmod{7} $$\n$$ (x+2)^{7} \\equiv 1 \\cdot 2^{7} \\cdot 1 + 1 \\cdot 1 \\cdot x^{7} \\pmod{7} $$\n$$ (x+2)^{7} \\equiv x^{7} + 2^{7} \\pmod{7} $$\n这个在特征为 $p$ 的环中的恒等式 $(u+v)^{p} \\equiv u^{p} + v^{p}$ 通常被称为“新手之梦”。\n\n接下来，我们必须计算 $2^{7}$ 对 $7$ 取模。根据费马小定理，对于一个素数 $p$ 和任意整数 $a$，我们有 $a^{p} \\equiv a \\pmod{p}$。对于 $a=2$ 和 $p=7$，这给出：\n$$ 2^{7} \\equiv 2 \\pmod{7} $$\n或者，可以直接计算：$2^{1}=2$，$2^{2}=4$，$2^{3}=8 \\equiv 1 \\pmod{7}$。那么 $2^{7} = 2^{3 \\cdot 2 + 1} = (2^{3})^{2} \\cdot 2^{1} \\equiv (1)^{2} \\cdot 2 \\equiv 2 \\pmod{7}$。\n\n将此结果代回我们的多项式同余式，我们发现在环 $\\mathbb{Z}_{7}[x]$ 中：\n$$ (x+2)^{7} \\equiv x^{7} + 2 \\pmod{7} $$\n\n计算的第二阶段是在商环 $\\mathbb{Z}_{7}[x]/\\langle x^{5}-1 \\rangle$ 中化简多项式 $x^{7} + 2$。在这个环中，任何多项式都等价于其除以 $x^{5}-1$ 后的余数。这由同余关系 $x^{5}-1 \\equiv 0$ 定义，或者更方便地写作 $x^{5} \\equiv 1$。\n\n我们需要求 $x^{7}+2$ 除以 $x^{5}-1$ 的余数。我们可以使用多项式长除法，或者更简单地，使用同余的代换性质。我们可以将 $x^{7}$ 分解为：\n$$ x^{7} = x^{5} \\cdot x^{2} $$\n使用关系式 $x^{5} \\equiv 1 \\pmod{x^{5}-1}$，我们将其代入 $x^{7}$ 的表达式中：\n$$ x^{7} \\equiv 1 \\cdot x^{2} \\equiv x^{2} \\pmod{x^{5}-1} $$\n因此，对于整个多项式：\n$$ x^{7} + 2 \\equiv x^{2} + 2 \\pmod{x^{5}-1} $$\n得到的多项式是 $x^{2} + 2$。该多项式的次数为 $2$，小于 $r=5$。因此，$x^{2}+2$ 是 $(x+2)^{7}$ 在指定的商环中次数小于 $5$ 的剩余类的唯一代表。该多项式的系数 $1$ 和 $2$ 是 $\\mathbb{Z}_{7}$ 中的元素。\n这个结果与 AKS 素性检验的核心定理一致。对于一个素数 $n$，有 $(x+a)^n \\equiv x^n + a \\pmod{n, x^r - 1}$。这里，$n=7$，$a=2$，$r=5$。我们已经计算出 $(x+2)^7 \\equiv x^2+2 \\pmod{7, x^5-1}$。并且我们可以计算出 $x^7+2 \\equiv x^2+2 \\pmod{7, x^5-1}$。因此该同余式成立。", "answer": "$$\n\\boxed{x^{2} + 2}\n$$", "id": "3087840"}, {"introduction": "为了真正理解为何AKS同余关系能作为一种有效的素性检验，观察它在合数上如何失效是至关重要的。本练习 [@problem_id:3087888] 通过检验合数 $n=9$ 时的同余关系，为前一个练习提供了关键的对比。计算出的非零结果将精确地揭示，在合数模下二项式系数性质的失效，是如何成为其合数身份的证明。", "problem": "考虑 Agrawal–Kayal–Saxena (AKS) 素性测试条件：对于一个素数 $n$ 和一个适当选择的整数 $r$，多项式同余式 $(x+a)^{n} \\equiv x^{n} + a$ 在商环 $R = (\\mathbb{Z}/n\\mathbb{Z})[x]/(x^{r} - 1)$ 中对一定范围内的整数 $a$ 成立。请从以下基本依据出发：用于展开 $(x+a)^{n}$ 的二项式定理，$\\mathbb{Z}/n\\mathbb{Z}$ 中模算术的定义，以及商环 $(\\mathbb{Z}/n\\mathbb{Z})[x]/(x^{r} - 1)$ 的结构（其中 $x^{r} \\equiv 1$）。\n\n提供一个具体的、小的合数例子来说明 AKS 同余式在何种情况下会不成立。具体来说，在环 $R = (\\mathbb{Z}/9\\mathbb{Z})[x]/(x^{5} - 1)$ 中进行运算。使用二项式定理以及模 $9$ 和模 $x^{5} - 1$ 的约化方法，计算约化后的差异多项式\n$$D(x) = (x+1)^{9} - (x^{9} + 1)$$\n该多项式是 $R$ 中的一个元素，其表示形式为次数严格小于 $5$ 且系数在 $\\{0,1,2,3,4,5,6,7,8\\}$ 中的多项式。\n\n将你的最终答案表示为 $R$ 中的单个简化多项式 $D(x)$。", "solution": "本题旨在为一个合数提供一个具体的例子，说明 Agrawal–Kayal–Saxena (AKS) 素性测试条件为何会失效。我们被要求在特定环 $R = (\\mathbb{Z}/9\\mathbb{Z})[x]/(x^{5} - 1)$ 中计算差异多项式 $D(x) = (x+1)^{9} - (x^{9} + 1)$。这需要在多项式算术中，将系数对 9 取模，并将多项式对 $x^{5} - 1$ 取模。\n\n计算过程分为三个主要步骤：\n1. 在环 $R$ 中计算多项式 $(x+1)^{9}$。\n2. 在环 $R$ 中计算多项式 $x^{9} + 1$。\n3. 计算这两个结果的差 $D(x)$。\n\n步骤 1：在 $R$ 中计算 $(x+1)^{9}$。\n首先，我们使用二项式定理展开 $(x+1)^{9}$：\n$$ (x+1)^{9} = \\sum_{k=0}^{9} \\binom{9}{k} x^{k} $$\n我们需要计算二项式系数 $\\binom{9}{k}$ 模 9 的值。我们先计算这些整数系数，然后求它们模 9 的余数。\n$\\binom{9}{0} = 1 \\equiv 1 \\pmod{9}$\n$\\binom{9}{1} = 9 \\equiv 0 \\pmod{9}$\n$\\binom{9}{2} = \\frac{9 \\cdot 8}{2} = 36 \\equiv 0 \\pmod{9}$\n$\\binom{9}{3} = \\frac{9 \\cdot 8 \\cdot 7}{3 \\cdot 2 \\cdot 1} = 84 = 9 \\cdot 9 + 3 \\equiv 3 \\pmod{9}$\n$\\binom{9}{4} = \\frac{9 \\cdot 8 \\cdot 7 \\cdot 6}{4 \\cdot 3 \\cdot 2 \\cdot 1} = 126 = 14 \\cdot 9 \\equiv 0 \\pmod{9}$\n\n根据二项式系数的对称性 $\\binom{n}{k} = \\binom{n}{n-k}$，我们有：\n$\\binom{9}{5} = \\binom{9}{4} \\equiv 0 \\pmod{9}$\n$\\binom{9}{6} = \\binom{9}{3} \\equiv 3 \\pmod{9}$\n$\\binom{9}{7} = \\binom{9}{2} \\equiv 0 \\pmod{9}$\n$\\binom{9}{8} = \\binom{9}{1} \\equiv 0 \\pmod{9}$\n$\\binom{9}{9} = \\binom{9}{0} = 1 \\equiv 1 \\pmod{9}$\n\n将这些系数代回展开式，我们得到在 $(\\mathbb{Z}/9\\mathbb{Z})[x]$ 中的多项式：\n$$ (x+1)^{9} \\equiv 1 \\cdot x^{0} + 0 \\cdot x^{1} + 0 \\cdot x^{2} + 3 \\cdot x^{3} + 0 \\cdot x^{4} + 0 \\cdot x^{5} + 3 \\cdot x^{6} + 0 \\cdot x^{7} + 0 \\cdot x^{8} + 1 \\cdot x^{9} \\pmod{9} $$\n$$ (x+1)^{9} \\equiv 1 + 3x^{3} + 3x^{6} + x^{9} \\pmod{9} $$\n另一种更代数的方法可以证实这一点。在 $\\mathbb{Z}/9\\mathbb{Z}$ 中，我们有 $(a+3b)^{3} = a^{3} + 3a^{2}(3b) + 3a(3b)^{2} + (3b)^{3} = a^{3} + 9a^{2}b + 27ab^{2} + 27b^{3} \\equiv a^{3} \\pmod{9}$。令 $a=x^{3}+1$ 且 $b=x^{2}+x$。那么 $(x+1)^{3} = x^{3}+3x^{2}+3x+1 = a+3b$。因此，$(x+1)^{9} = ((x+1)^{3})^{3} = (a+3b)^{3} \\equiv a^3 = (x^3+1)^3 = x^9+3x^6+3x^3+1 \\pmod{9}$。\n\n现在，我们必须将此多项式对 $x^{5} - 1$ 进行约化。商环 $R$ 的定义关系是 $x^{5} - 1 \\equiv 0$，这意味着 $x^{5} \\equiv 1$。我们用这个关系来约化所有大于或等于 5 的 $x$ 的幂次：\n$$ x^{6} = x^{5} \\cdot x \\equiv 1 \\cdot x = x \\pmod{x^{5}-1} $$\n$$ x^{9} = x^{5} \\cdot x^{4} \\equiv 1 \\cdot x^{4} = x^{4} \\pmod{x^{5}-1} $$\n将这些约化后的幂代入我们关于 $(x+1)^{9}$ 的表达式中：\n$$ (x+1)^{9} \\equiv 1 + 3x^{3} + 3(x) + (x^{4}) \\pmod{9, x^{5}-1} $$\n按次数重新排列各项，我们得到 $(x+1)^{9}$ 在 $R$ 中的表示：\n$$ (x+1)^{9} \\equiv x^{4} + 3x^{3} + 3x + 1 $$\n\n步骤 2：在 $R$ 中计算 $x^{9} + 1$。\n我们需要在同一个环 $R$ 中约化多项式 $x^{9} + 1$。其系数是整数，因此它们直接在 $\\mathbb{Z}/9\\mathbb{Z}$ 中解释。$x$ 的幂的约化与之前相同：\n$$ x^{9} \\equiv x^{4} \\pmod{x^{5}-1} $$\n因此，在环 $R$ 中，我们有：\n$$ x^{9} + 1 \\equiv x^{4} + 1 $$\n\n步骤 3：计算差异多项式 $D(x)$。\n我们现在计算步骤 1 和步骤 2 结果的差。所有运算都在 $R$ 中进行。\n$$ D(x) = (x+1)^{9} - (x^{9} + 1) $$\n$$ D(x) \\equiv (x^{4} + 3x^{3} + 3x + 1) - (x^{4} + 1) $$\n$$ D(x) \\equiv x^{4} + 3x^{3} + 3x + 1 - x^{4} - 1 $$\n合并同类项：\n$$ D(x) \\equiv (x^{4} - x^{4}) + 3x^{3} + 3x + (1 - 1) $$\n$$ D(x) \\equiv 3x^{3} + 3x $$\n所得多项式为 $3x^{3} + 3x$。其系数 3 和 3 都在集合 $\\{0, 1, ..., 8\\}$ 中，并且其次数 3 严格小于 5。这就是差异多项式的最终约化形式。\n\n$D(x) \\neq 0$ 这一事实表明 AKS 同余式 $(x+1)^{9} \\equiv x^{9} + 1$ 在环 $R$ 中不成立。这个非零结果可作为整数 $n=9$ 为合数的证明。", "answer": "$$ \\boxed{3x^{3} + 3x} $$", "id": "3087888"}]}