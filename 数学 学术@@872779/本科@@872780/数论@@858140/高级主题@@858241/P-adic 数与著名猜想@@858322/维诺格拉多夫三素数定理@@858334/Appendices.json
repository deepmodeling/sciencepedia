{"hands_on_practices": [{"introduction": "维诺格拉多夫三素数定理的结论中，主项包含一个称为“奇异级数”的算术因子 $\\mathfrak{S}(N)$。这个因子捕捉了问题在“局部”（即模素数幂）的可解性。本练习通过直接计算最小奇素数 $p=3$ 时的局部因子，揭示了这一抽象概念的本质，你将从中理解 $N$ 的算术性质（例如，它是否能被3整除）如何影响解的数量。[@problem_id:3093870]", "problem": "在证明维诺格拉多夫三素数定理的Hardy–Littlewood圆法中，将奇整数 $N$ 表示为三个素数之和的表示数的主项带有一个称为奇异级数 $\\mathfrak{S}(N) = \\prod_{p} \\sigma_{p}(N)$ 的乘性算术权重。每个局部因子 $\\sigma_{p}(N)$ 是一个归一化的 $p$-进密度，它反映了线性方程 $x + y + z \\equiv N$ 在模 $p$ 的幂下的同余阻碍。要从第一性原理自然地看出 $\\sigma_{p}(N)$ 对 $N \\bmod p$ 的依赖关系，一种方法是对于一个固定的素数 $p$，计算 $x + y + z \\equiv N \\pmod p$ 且 $x,y,z \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的解的个数，并将此计数与均匀基线进行比较，在均匀基线中，该同余式在 $(p-1)^3$ 个单位三元组中有望以 $1/p$ 的概率成立。仅使用模 $p$ 的加性特征的正交性，即对于 $a \\not\\equiv 0 \\pmod p$ 有 $\\sum_{t=0}^{p-1} e(2\\pi i a t/p) = 0$，以及定义 $S(a) = \\sum_{x \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} e(2\\pi i a x/p)$，推导当 $p=3$ 时归一化局部密度对 $N \\bmod p$ 的依赖关系。然后，从下面的陈述中选择一个正确的，说明小素数 $p=3$ 如何通过 $\\sigma_{3}(N)$ 产生 $\\mathfrak{S}(N)$ 对 $N \\bmod 3$ 的轻度依赖性。\n\nA. 对于 $p=3$，归一化局部因子等于 $\\sigma_{3}(N) = \\dfrac{3}{4}$ 如果 $3 \\mid N$，且 $\\sigma_{3}(N) = \\dfrac{9}{8}$ 如果 $3 \\nmid N$。\n\nB. 对于 $p=3$，奇异级数不依赖于 $N \\bmod 3$，即对所有 $N$，$\\sigma_{3}(N) = 1$。\n\nC. 对于 $p=3$，归一化局部因子等于 $\\sigma_{3}(N) = \\dfrac{9}{8}$ 如果 $3 \\mid N$，且 $\\sigma_{3}(N) = \\dfrac{3}{4}$ 如果 $3 \\nmid N$。\n\nD. 对于 $p=3$，存在一个同余阻碍：$\\sigma_{3}(N) = 0$ 如果 $3 \\mid N$，且 $\\sigma_{3}(N) = 2$ 如果 $3 \\nmid N$。", "solution": "问题陈述是解析数论中的一个有效练习。它要求推导维诺格拉多夫三素数定理的奇异级数中，针对 $p=3$ 的特定情况下的局部因子 $\\sigma_p(N)$。该问题具有科学依据，提法明确，并使用精确、客观的语言。所有必要的信息和方法都已提供。\n\n任务是根据同余式 $x+y+z \\equiv N \\pmod 3$（其中 $x,y,z$ 限制在单位群 $(\\mathbb{Z}/3\\mathbb{Z})^{\\times}$ 中）的解的数量来计算归一化局部密度 $\\sigma_3(N)$。设 $p$ 是一个素数。我们首先推导对任意素数 $p$ 的通用公式，然后将其特化到 $p=3$。\n\n设 $R_p(N)$ 为 $x+y+z \\equiv N \\pmod p$ 且 $x, y, z \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的解的数量。我们使用 $\\mathbb{Z}/p\\mathbb{Z}$ 的加性特征的正交性。标准恒等式为，如果 $k \\equiv 0 \\pmod p$，则 $\\sum_{a=0}^{p-1} e(ka/p) = p$，否则为 $0$，其中我们使用标准记号 $e(u) = e^{2\\pi i u}$。这可以写成条件 $x+y+z-N \\equiv 0 \\pmod p$ 的指示函数：\n$$ \\frac{1}{p} \\sum_{a=0}^{p-1} e\\left(\\frac{a(x+y+z-N)}{p}\\right) = \\begin{cases} 1  \\text{如果 } x+y+z \\equiv N \\pmod p \\\\ 0  \\text{否则} \\end{cases} $$\n对所有可能的 $x,y,z \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 求和：\n$$ R_p(N) = \\sum_{x,y,z \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\frac{1}{p} \\sum_{a=0}^{p-1} e\\left(\\frac{a(x+y+z-N)}{p}\\right) $$\n通过交换求和顺序：\n$$ R_p(N) = \\frac{1}{p} \\sum_{a=0}^{p-1} e\\left(\\frac{-aN}{p}\\right) \\left( \\sum_{x \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} e\\left(\\frac{ax}{p}\\right) \\right) \\left( \\sum_{y \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} e\\left(\\frac{ay}{p}\\right) \\right) \\left( \\sum_{z \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} e\\left(\\frac{az}{p}\\right) \\right) $$\n设 $S(a) = \\sum_{x \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} e(ax/p)$。表达式变为：\n$$ R_p(N) = \\frac{1}{p} \\sum_{a=0}^{p-1} S(a)^3 e\\left(\\frac{-aN}{p}\\right) $$\n我们计算和 $S(a)$。\n如果 $a \\equiv 0 \\pmod p$，那么 $e(0 \\cdot x/p) = e(0) = 1$。求和是对 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的所有 $p-1$ 个元素进行的。\n$$ S(0) = \\sum_{x \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} 1 = p-1 $$\n如果 $a \\not\\equiv 0 \\pmod p$，我们利用对 $\\mathbb{Z}/p\\mathbb{Z}$ 所有元素的求和为零这一事实：\n$$ \\sum_{x=0}^{p-1} e\\left(\\frac{ax}{p}\\right) = 0 $$\n这个和可以分为 $x=0$ 的项和对非零元素的求和：\n$$ e\\left(\\frac{a \\cdot 0}{p}\\right) + \\sum_{x \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} e\\left(\\frac{ax}{p}\\right) = 1 + S(a) = 0 $$\n因此，对于 $a \\not\\equiv 0 \\pmod p$：\n$$ S(a) = -1 $$\n现在我们将这些 $S(a)$ 的值代入 $R_p(N)$ 的公式中：\n$$ R_p(N) = \\frac{1}{p} \\left( S(0)^3 e(0) + \\sum_{a=1}^{p-1} S(a)^3 e\\left(\\frac{-aN}{p}\\right) \\right) $$\n$$ R_p(N) = \\frac{1}{p} \\left( (p-1)^3 + (-1)^3 \\sum_{a=1}^{p-1} e\\left(\\frac{-aN}{p}\\right) \\right) $$\n$$ R_p(N) = \\frac{1}{p} \\left( (p-1)^3 - \\sum_{a=1}^{p-1} e\\left(\\frac{-aN}{p}\\right) \\right) $$\n和 $\\sum_{a=1}^{p-1} e(-aN/p)$ 的值取决于 $N$ 是否为 $p$ 的倍数。\n情况1：$p \\mid N$。\n那么对所有 $a$，$ -aN/p$ 都是整数，所以 $e(-aN/p) = e(0) = 1$。\n$$ \\sum_{a=1}^{p-1} e\\left(\\frac{-aN}{p}\\right) = \\sum_{a=1}^{p-1} 1 = p-1 $$\n所以，对于 $p \\mid N$，\n$$ R_p(N) = \\frac{1}{p}((p-1)^3 - (p-1)) = \\frac{p-1}{p}((p-1)^2-1) = \\frac{p-1}{p}(p^2-2p) = (p-1)(p-2) $$\n情况2：$p \\nmid N$。\n这个和是 $\\sum_{a=1}^{p-1} e(-aN/p) = -1$，因为 $\\sum_{a=0}^{p-1} e(-aN/p)=0$。\n所以，对于 $p \\nmid N$，\n$$ R_p(N) = \\frac{1}{p}((p-1)^3 - (-1)) = \\frac{(p-1)^3+1}{p} $$\n问题将归一化局部密度 $\\sigma_p(N)$ 定义为实际计数 $R_p(N)$ 与均匀基线计数 $(p-1)^3/p$ 的比值。\n$$ \\sigma_p(N) = \\frac{R_p(N)}{(p-1)^3/p} = \\frac{p R_p(N)}{(p-1)^3} $$\n我们将此归一化应用于我们的两种情况。\n情况1：$p \\mid N$。\n$$ \\sigma_p(N) = \\frac{p \\cdot (p-1)(p-2)}{(p-1)^3} = \\frac{p(p-2)}{(p-1)^2} $$\n情况2：$p \\nmid N$。\n$$ \\sigma_p(N) = \\frac{p \\cdot \\frac{(p-1)^3+1}{p}}{(p-1)^3} = \\frac{(p-1)^3+1}{(p-1)^3} = 1 + \\frac{1}{(p-1)^3} $$\n现在我们特化到素数 $p=3$。\n情况1：$3 \\mid N$。\n$$ \\sigma_3(N) = \\frac{3(3-2)}{(3-1)^2} = \\frac{3 \\cdot 1}{2^2} = \\frac{3}{4} $$\n情况2：$3 \\nmid N$。\n$$ \\sigma_3(N) = 1 + \\frac{1}{(3-1)^3} = 1 + \\frac{1}{2^3} = 1 + \\frac{1}{8} = \\frac{9}{8} $$\n我们的推导表明，当 $3 \\mid N$ 时，归一化局部密度 $\\sigma_3(N)$ 是一个因子 $\\frac{3}{4}$，当 $3 \\nmid N$ 时，是一个因子 $\\frac{9}{8}$。这证明了如问题所述的对 $N \\pmod 3$ 的“轻度依赖性”。\n\n我们现在评估给定的选项。\n\nA. 对于 $p=3$，归一化局部因子等于 $\\sigma_{3}(N) = \\dfrac{3}{4}$ 如果 $3 \\mid N$，且 $\\sigma_{3}(N) = \\dfrac{9}{8}$ 如果 $3 \\nmid N$。\n这个陈述与我们推导的结果完全匹配。\n结论：**正确**。\n\nB. 对于 $p=3$，奇异级数不依赖于 $N \\bmod 3$，即对所有 $N$，$\\sigma_{3}(N) = 1$。\n这是错误的。我们的计算表明 $\\sigma_3(N)$ 有两个不同的值，$\\frac{3}{4}$ 和 $\\frac{9}{8}$，取决于 $N$ 是否能被 $3$ 整除。两个值都不是 $1$。\n结论：**错误**。\n\nC. 对于 $p=3$，归一化局部因子等于 $\\sigma_{3}(N) = \\dfrac{9}{8}$ 如果 $3 \\mid N$，且 $\\sigma_{3}(N) = \\dfrac{3}{4}$ 如果 $3 \\nmid N$。\n这个陈述颠倒了两个值的条件。我们发现当 $3 \\mid N$ 时 $\\sigma_3(N) = \\frac{3}{4}$，当 $3 \\nmid N$ 时 $\\sigma_3(N) = \\frac{9}{8}$。\n结论：**错误**。\n\nD. 对于 $p=3$，存在一个同余阻碍：$\\sigma_{3}(N) = 0$ 如果 $3 \\mid N$，且 $\\sigma_{3}(N) = 2$ 如果 $3 \\nmid N$。\n这是错误的。同余阻碍意味着 $\\sigma_3(N) = 0$，即 $R_3(N)=0$。我们对 $3 \\mid N$ 的计算得出 $R_3(N) = (3-1)(3-2) = 2 \\neq 0$，因此没有阻碍。值 $\\sigma_3(N)=0$ 和 $\\sigma_3(N)=2$ 都是不正确的。\n结论：**错误**。\n\n只有选项A与我们的严格推导一致。", "answer": "$$\\boxed{A}$$", "id": "3093870"}, {"introduction": "在探究了主导项中的算术因子之后，我们转向其解析部分，即奇异积分 $J_N$。该积分给出了在假设素数均匀分布时问题解数量的期望量级。本练习将指导你完成一个基本但至关重要的计算，通过分析指数和的连续近似，揭示了为何解的数量级是 $N^2$。[@problem_id:3093923]", "problem": "设 $e(x) = \\exp(2\\pi i x)$。在将Hardy–Littlewood圆法应用于维诺格拉多夫三素数定理时，我们会研究指数和 $V_{N}(\\beta)$，将其作为区间 $[1,N]$ 指示函数的傅里叶变换的近似，并研究一个相应的奇异积分，该积分捕捉了表示数的主项。考虑以下对象：\n- 离散指数和 $V_{N}(\\beta) = \\sum_{n=1}^{N} e(\\beta n)$。\n- 其连续近似 $W_{N}(\\beta) = \\int_{0}^{N} e(\\beta x)\\,dx$。\n- 在标度 $N$ 下的奇异积分，定义为\n$$\nJ_{N}^{\\mathrm{cont}} := \\int_{-\\infty}^{\\infty} \\left( \\int_{0}^{N} e(\\beta x)\\,dx \\right)^{3} e(-\\beta N)\\,d\\beta.\n$$\n\n任务：\n1. 计算 $V_{N}(\\beta)$ 和 $W_{N}(\\beta)$ 的闭式表达式。\n2. 使用缩放将 $J_{N}^{\\mathrm{cont}}$ 表示为 $J_{N}^{\\mathrm{cont}} = N^{2} J$ 的形式，其中 $J$ 是一个只涉及区间 $[0,1]$ 的无标度积分。\n3. 通过将 $J$ 解释为 $[0,1]$ 指示函数的三重卷积的傅里叶逆变换，并通过初等求和或稳相启发法显式计算所得的几何量，来精确计算 $J$ 的值。\n\n请给出 $J$ 的精确值作为最终答案。无需四舍五入。", "solution": "该问题陈述经核实具有科学依据、问题明确且客观。这是解析数论中的一个标准练习，具体涉及Hardy-Littlewood圆法的应用。所有定义均为标准定义，任务在数学上是合理的且可解。我们开始进行解答。\n\n该问题要求计算在研究维诺格拉多夫三素数定理中出现的指数和与积分。\n\n任务1：计算 $V_{N}(\\beta)$ 和 $W_{N}(\\beta)$ 的闭式表达式。\n\n离散指数和 $V_{N}(\\beta)$ 由下式给出\n$$\nV_{N}(\\beta) = \\sum_{n=1}^{N} e(\\beta n) = \\sum_{n=1}^{N} (\\exp(2\\pi i \\beta))^{n}\n$$\n这是一个等比级数，其首项为 $a = e(\\beta)$，公比为 $r = e(\\beta)$。\n\n情况1：$\\beta$ 是整数。\n如果 $\\beta \\in \\mathbb{Z}$，则 $e(\\beta) = \\exp(2\\pi i \\beta) = 1$。该和变为\n$$\nV_{N}(\\beta) = \\sum_{n=1}^{N} 1 = N\n$$\n\n情况2：$\\beta$ 不是整数。\n如果 $\\beta \\notin \\mathbb{Z}$，则 $e(\\beta) \\neq 1$。等比级数的和由下式给出\n$$\nV_{N}(\\beta) = a \\frac{1-r^{N}}{1-r} = e(\\beta) \\frac{1-e(\\beta N)}{1-e(\\beta)}\n$$\n为了得到一个更标准的形式，我们可以对该表达式进行处理：\n$$\nV_{N}(\\beta) = e(\\beta) \\frac{e(\\beta N/2)(e(-\\beta N/2) - e(\\beta N/2))}{e(\\beta/2)(e(-\\beta/2) - e(\\beta/2))} = e\\left(\\beta + \\frac{\\beta N}{2} - \\frac{\\beta}{2}\\right) \\frac{-2i \\sin(\\pi \\beta N)}{-2i \\sin(\\pi \\beta)}\n$$\n$$\nV_{N}(\\beta) = e\\left(\\frac{\\beta(N+1)}{2}\\right) \\frac{\\sin(\\pi \\beta N)}{\\sin(\\pi \\beta)}\n$$\n\n连续近似 $W_{N}(\\beta)$ 是积分\n$$\nW_{N}(\\beta) = \\int_{0}^{N} e(\\beta x)\\,dx = \\int_{0}^{N} \\exp(2\\pi i \\beta x)\\,dx\n$$\n\n情况1：$\\beta = 0$。\n该积分为\n$$\nW_{N}(0) = \\int_{0}^{N} 1 \\,dx = N\n$$\n\n情况2：$\\beta \\neq 0$。\n该积分为\n$$\nW_{N}(\\beta) = \\left[ \\frac{\\exp(2\\pi i \\beta x)}{2\\pi i \\beta} \\right]_{0}^{N} = \\frac{\\exp(2\\pi i \\beta N) - 1}{2\\pi i \\beta} = \\frac{e(\\beta N) - 1}{2\\pi i \\beta}\n$$\n这可以重写为：\n$$\nW_{N}(\\beta) = \\frac{e(\\beta N/2)(e(\\beta N/2) - e(-\\beta N/2))}{2\\pi i \\beta} = e(\\beta N/2) \\frac{2i \\sin(\\pi \\beta N)}{2\\pi i \\beta} = e(\\beta N/2) \\frac{\\sin(\\pi \\beta N)}{\\pi \\beta}\n$$\n注意，当 $\\beta \\to 0$ 时，我们有 $\\sin(\\pi \\beta N) \\approx \\pi \\beta N$ 和 $e(\\beta N/2) \\to 1$，所以 $W_{N}(\\beta) \\to 1 \\cdot \\frac{\\pi \\beta N}{\\pi \\beta} = N$，这与 $\\beta = 0$ 时的结果一致。\n\n任务2：将 $J_{N}^{\\mathrm{cont}}$ 表示为 $N^{2} J$ 的形式。\n\n奇异积分定义为\n$$\nJ_{N}^{\\mathrm{cont}} = \\int_{-\\infty}^{\\infty} W_{N}(\\beta)^{3} e(-\\beta N)\\,d\\beta\n$$\n首先，我们分析 $W_N(\\beta)$ 如何随 $N$ 缩放。在 $W_{N}(\\beta)$ 的积分中，令 $x = Ny$。则 $dx = N\\,dy$，$y$ 的积分限变为 0 到 1。\n$$\nW_{N}(\\beta) = \\int_{0}^{1} e(\\beta Ny) (N\\,dy) = N \\int_{0}^{1} e((\\beta N)y)\\,dy = N W_{1}(\\beta N)\n$$\n现在，将此代入 $J_{N}^{\\mathrm{cont}}$ 的表达式中：\n$$\nJ_{N}^{\\mathrm{cont}} = \\int_{-\\infty}^{\\infty} (N W_{1}(\\beta N))^{3} e(-\\beta N)\\,d\\beta = N^{3} \\int_{-\\infty}^{\\infty} W_{1}(\\beta N)^{3} e(-\\beta N)\\,d\\beta\n$$\n在外层积分中，我们进行变量替换。令 $u = \\beta N$，则 $\\beta = u/N$ 且 $d\\beta = du/N$。\n$$\nJ_{N}^{\\mathrm{cont}} = N^{3} \\int_{-\\infty}^{\\infty} W_{1}(u)^{3} e(-u) \\left(\\frac{du}{N}\\right) = N^{2} \\int_{-\\infty}^{\\infty} W_{1}(u)^{3} e(-u)\\,du\n$$\n这就是 $J_{N}^{\\mathrm{cont}} = N^{2} J$ 的形式，其中无标度积分 $J$ 是\n$$\nJ = \\int_{-\\infty}^{\\infty} W_{1}(u)^{3} e(-u)\\,du\n$$\n其中 $W_{1}(u) = \\int_{0}^{1} e(uy)\\,dy$。\n\n任务3：精确计算 $J$。\n\n问题建议将 $J$ 解释为三重卷积的傅里叶逆变换。我们定义函数 $f(x)$ 的傅里叶变换为 $\\hat{f}(\\xi) = \\int_{-\\infty}^{\\infty} f(x) e(-\\xi x)\\,dx$。傅里叶逆变换为 $f(x) = \\int_{-\\infty}^{\\infty} \\hat{f}(\\xi) e(\\xi x)\\,d\\xi$。\n\n令 $g(x) = \\mathbb{1}_{[0,1]}(x)$ 为区间 $[0,1]$ 的指示函数。其傅里叶变换为\n$$\n\\hat{g}(\\xi) = \\int_{-\\infty}^{\\infty} \\mathbb{1}_{[0,1]}(x) e(-\\xi x)\\,dx = \\int_{0}^{1} e(-\\xi x)\\,dx\n$$\n我们注意到 $W_{1}(u) = \\int_{0}^{1} e(uy)\\,dy = \\hat{g}(-u)$。\n\n将此代入 $J$ 的表达式中：\n$$\nJ = \\int_{-\\infty}^{\\infty} (\\hat{g}(-u))^{3} e(-u)\\,du\n$$\n我们进行变量替换 $\\xi = -u$，则 $d\\xi = -du$。\n$$\nJ = \\int_{\\infty}^{-\\infty} (\\hat{g}(\\xi))^{3} e(\\xi) (-d\\xi) = \\int_{-\\infty}^{\\infty} (\\hat{g}(\\xi))^{3} e(\\xi \\cdot 1)\\,d\\xi\n$$\n这是函数 $(\\hat{g}(\\xi))^{3}$ 在点 $x=1$ 处的傅里叶逆变换。\n\n根据卷积定理，傅里叶变换的乘积对应于卷积的傅里叶变换：$\\mathcal{F}\\{f_1 * f_2\\} = \\hat{f_1}\\hat{f_2}$。因此，$\\mathcal{F}\\{(g*g*g)\\} = (\\hat{g})^3$。\n因此，$J$ 是 $g$ 与自身的三重卷积在 $x=1$ 处的值。\n$$\nJ = (g*g*g)(1)\n$$\n我们来计算卷积。首先是 $g*g$：\n$$\n(g*g)(x) = \\int_{-\\infty}^{\\infty} g(y) g(x-y)\\,dy = \\int_{0}^{1} \\mathbb{1}_{[0,1]}(x-y)\\,dy\n$$\n条件 $0 \\le x-y \\le 1$ 等价于 $x-1 \\le y \\le x$。积分区间是 $y \\in [0,1]$。所以我们在交集 $[0,1] \\cap [x-1, x]$ 上积分。$(g*g)(x)$ 的支撑集是 $[0,2]$。\n对于 $x \\in [0,1]$，交集是 $[0,x]$，所以 $(g*g)(x) = \\int_{0}^{x} 1\\,dy = x$。\n对于 $x \\in [1,2]$，交集是 $[x-1,1]$，所以 $(g*g)(x) = \\int_{x-1}^{1} 1\\,dy = 1-(x-1) = 2-x$。\n所以，$(g*g)(x)$ 是一个三角形函数：\n$$\n(g*g)(x) = \\begin{cases} x  \\text{若 } 0 \\le x \\le 1 \\\\ 2-x  \\text{若 } 1  x \\le 2 \\\\ 0  \\text{其它} \\end{cases}\n$$\n现在我们计算在 $x=1$ 处的第三次卷积：\n$$\n(g*g*g)(1) = ((g*g)*g)(1) = \\int_{-\\infty}^{\\infty} (g*g)(y) g(1-y)\\,dy\n$$\n由于 $g(1-y) = \\mathbb{1}_{[0,1]}(1-y) = \\mathbb{1}_{[0,1]}(y)$，该积分变为：\n$$\nJ = \\int_{0}^{1} (g*g)(y) \\cdot 1 \\,dy\n$$\n在区间 $y \\in [0,1]$ 上，函数 $(g*g)(y)$ 等于 $y$。\n$$\nJ = \\int_{0}^{1} y\\,dy = \\left[ \\frac{y^{2}}{2} \\right]_{0}^{1} = \\frac{1^{2}}{2} - \\frac{0^{2}}{2} = \\frac{1}{2}\n$$\n另外，可以认识到 $J = \\iiint_{[0,1]^3} \\delta(x_1+x_2+x_3-1) dx_1 dx_2 dx_3$，这是单位立方体内曲面 $x_1+x_2+x_3=1$ 的面积。这个曲面是一个以 $(1,0,0)$、$(0,1,0)$ 和 $(0,0,1)$ 为顶点的等边三角形。其边长为 $\\sqrt{2}$，面积为 $\\frac{\\sqrt{3}}{4}(\\sqrt{2})^2 = \\frac{\\sqrt{3}}{2}$。利用狄拉克δ函数的性质，这个面积必须除以 $|\\nabla(x_1+x_2+x_3-1)| = \\sqrt{1^2+1^2+1^2} = \\sqrt{3}$。结果是 $J = \\frac{\\sqrt{3}/2}{\\sqrt{3}} = \\frac{1}{2}$，这证实了之前的计算。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3093923"}, {"introduction": "在分别从理论上理解了奇异级数和奇异积分之后，最后的练习将使 $\\mathfrak{S}(N)$ 的概念变得具体可感。通过编写程序来计算 $\\mathfrak{S}(N)$ 欧拉乘积的截断近似，你将能从数值上观察到这个关键因子如何依赖于 $N$ 的小素因子。这项练习将理论与计算实践相结合，这是现代数论研究中的一项核心技能。[@problem_id:3093911]", "problem": "设 $N$ 是一个奇整数。在用于维诺格拉多夫三素数定理的 Hardy–Littlewood 圆法中，奇异级数 $\\mathfrak{S}(N)$ 是一个由局部密度产生的乘性算术因子，并且可以表示为关于素数的欧拉乘积。为了计算目的，一种符合上下文的近似 $\\mathfrak{S}(N)$ 的方法是，在每个奇素数处只保留第一阶素数幂的贡献，而忽略更高阶的素数幂。使用 Ramanujan 和 $c_q(a)$，其对于正整数 $q$ 和整数 $a$ 定义为 $c_q(a) = \\sum_{\\substack{r \\bmod q \\\\ (r,q)=1}} e^{2\\pi i a r / q}$，在奇素数 $p$ 处的一阶局部贡献由 $c_p(N)$ 捕捉，它满足：如果 $p \\nmid N$，则 $c_p(N) = -1$；如果 $p \\mid N$，则 $c_p(N) = p-1$。对于奇素数 $p$，这产生了截断的局部因子\n$$\nL_p(N) = 1 + \\frac{c_p(N)}{(p-1)^3} =\n\\begin{cases}\n1 - \\dfrac{1}{(p-1)^3},  \\text{若 } p \\nmid N, \\\\\n1 + \\dfrac{1}{(p-1)^2},  \\text{若 } p \\mid N,\n\\end{cases}\n$$\n对于奇数 $N$，我们将 $p=2$ 处的因子设为 $1$（反映了在三元问题中模 $2$ 没有障碍）。定义截至截断值 $X$ 的截断乘积为\n$$\n\\mathfrak{S}_X(N) = \\prod_{\\substack{3 \\le p \\le X \\\\ p \\text{ 为素数}}} L_p(N).\n$$\n我们将使用一个尾部估计来处理因忽略素数 $p  X$ 而产生的截断误差。由于对于所有奇素数 $p$，都有 $\\left|L_p(N) - 1\\right| \\le \\dfrac{1}{(p-1)^2}$，因此可以用关于平方倒数的收敛级数来界定乘性尾部误差。一个简单且通用的界（与 $N$ 无关）是\n$$\nE_X(N) \\le \\sum_{\\substack{p  X \\\\ p \\text{ 为素数}}} \\frac{1}{(p-1)^2} \\le \\sum_{n  X} \\frac{1}{n^2} \\le \\frac{1}{X},\n$$\n这可以通过将关于素数的和与关于所有整数的和进行比较以及使用积分判别法得到。\n\n任务：编写一个完整的、可运行的程序，对于每个给定的奇整数 $N$ 和截断值 $X = 50$，计算 $\\mathfrak{S}_{50}(N)$ 并输出数对 $\\left[\\mathfrak{S}_{50}(N), E_{50}(N)\\right]$，其中 $E_{50}(N)$ 是表示为浮点数的界 $1/50$。你必须实现：\n- 生成所有满足 $3 \\le p \\le 50$ 的素数 $p$。\n- 使用上述的分类讨论计算 $L_p(N)$。\n- 计算关于这些素数的乘积 $\\mathfrak{S}_{50}(N)$。\n- 报告通用误差界 $E_{50}(N) = 1/50$。\n\n你的程序应该评估以下奇数输入 $N$ 的测试套件：\n- $N = 53$，\n- $N = 105$，\n- $N = 15015$，\n- $N = 10403$。\n\n对于每个 $N$，以浮点数形式生成列表 $\\left[\\mathfrak{S}_{50}(N), E_{50}(N)\\right]$。你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件一致，其中每个元素本身是一个双元素列表，例如：\n$$\n\\left[ [\\mathfrak{S}_{50}(53), E_{50}(53)], [\\mathfrak{S}_{50}(105), E_{50}(105)], [\\mathfrak{S}_{50}(15015), E_{50}(15015)], [\\mathfrak{S}_{50}(10403), E_{50}(10403)] \\right].\n$$", "solution": "所述问题具有科学依据，内容自洽，且提法明确。它提出了一个基于解析数论中标准但专业概念的计算任务——具体来说，是在维诺格拉多夫三素数定理背景下对奇异级数的近似。所有术语、参数和过程都得到了明确无误的定义，从而可以得到唯一且可验证的解。因此，我认为该问题是有效的，并将着手解决它。\n\n任务是为一个给定的奇整数 $N$ 和一个截断值 $X$ 计算奇异级数的截断近似，记为 $\\mathfrak{S}_X(N)$。问题指定了截断值为 $X=50$。截断乘积定义为：\n$$\n\\mathfrak{S}_X(N) = \\prod_{\\substack{3 \\le p \\le X \\\\ p \\text{ 为素数}}} L_p(N)\n$$\n这里，$L_p(N)$ 是在奇素数 $p$ 处的局部因子，它取决于 $p$ 是否整除 $N$。其定义如下：\n$$\nL_p(N) =\n\\begin{cases}\n1 - \\dfrac{1}{(p-1)^3},  \\text{若 } p \\nmid N \\\\\n1 + \\dfrac{1}{(p-1)^2},  \\text{若 } p \\mid N\n\\end{cases}\n$$\n问题还要求报告此截断的通用误差界，给定为 $E_X(N) \\le 1/X$。对于指定的截断值 $X=50$，该界为一个常数值 $E_{50}(N) = 1/50 = 0.02$。\n\n为每个给定的测试值 $N$ 解决此问题的计算过程如下：\n\n1.  **确定相关素数**：第一步是确定要进行乘积运算的素数 $p$ 的集合。根据 $\\mathfrak{S}_{50}(N)$ 的定义，这些是满足 $3 \\le p \\le 50$ 的素数。标准的素数筛或预先计算的列表可以提供这些素数。此范围内的素数是：$3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47$。\n\n2.  **遍历测试用例**：问题为 $N$ 提供了一组四个奇整数：$53$、$105$、$15015$ 和 $10403$。必须对这些值中的每一个执行计算。\n\n3.  **计算乘积 $\\mathfrak{S}_{50}(N)$**：对于每个 $N$ 值，我们将通过将累加器初始化为 $1.0$，并对步骤1中确定的每个素数 $p$ 迭代地乘以局部因子 $L_p(N)$ 来计算 $\\mathfrak{S}_{50}(N)$。\n\n4.  **应用局部因子逻辑**：在乘积计算的每次迭代中（对于每个素数 $p$），执行可除性测试 $N \\pmod p = 0$。\n    - 如果余数为 $0$，则表示 $p$ 是 $N$ 的一个素因子。相应的局部因子是 $L_p(N) = 1 + \\frac{1}{(p-1)^2}$。\n    - 如果余数非零，则 $p$ 不整除 $N$，局部因子是 $L_p(N) = 1 - \\frac{1}{(p-1)^3}$。\n    这个乘法过程根据 $N$ 小于或等于 $50$ 的素因子正确地构造了 $\\mathfrak{S}_{50}(N)$ 的值。\n\n5.  **组合最终输出**：对于每个 $N$，结果是由计算出的 $\\mathfrak{S}_{50}(N)$ 的浮点值和常数误差界 $E_{50}(N) = 0.02$ 组成的数对。这些数对被收集并按照问题陈述中指定的格式格式化为单行的列表之列表。\n\n这个系统化的过程确保了对所提供数学形式体系的正确和可验证的实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the truncated singular series S_50(N) and its error bound E_50(N)\n    for a given list of odd integers N.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [53, 105, 15015, 10403]\n    \n    # Define the cutoff X and the corresponding error bound.\n    X = 50\n    error_bound = 1.0 / X\n\n    # Generate primes p such that 3 = p = 50.\n    # For a fixed small cutoff, a hardcoded list is efficient and error-free.\n    primes_up_to_50 = [3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]\n\n    results = []\n    \n    # Iterate through each test case N.\n    for N in test_cases:\n        # Initialize the product for the singular series approximation.\n        s_product = 1.0\n\n        # Iterate through the relevant primes to compute the product of local factors.\n        for p in primes_up_to_50:\n            # Check if the prime p divides N.\n            if N % p == 0:\n                # Case: p | N\n                # L_p(N) = 1 + 1 / (p-1)^2\n                local_factor = 1.0 + 1.0 / ((p - 1)**2)\n            else:\n                # Case: p does not divide N\n                # L_p(N) = 1 - 1 / (p-1)^3\n                local_factor = 1.0 - 1.0 / ((p - 1)**3)\n            \n            # Multiply the running product by the local factor.\n            s_product *= local_factor\n        \n        # Store the pair [S_50(N), E_50(N)] for the current N.\n        results.append([s_product, error_bound])\n\n    # Format the final output string as a list of lists.\n    # e.g., \"[[val1, err1],[val2, err2]]\"\n    formatted_pairs = []\n    for s_val, e_val in results:\n        formatted_pairs.append(f\"[{s_val},{e_val}]\")\n    \n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n\n```", "id": "3093911"}]}