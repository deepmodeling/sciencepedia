{"hands_on_practices": [{"introduction": "本节的第一个练习将介绍该领域最基本的技术：交换求和顺序。我们将此技术应用于除数和函数 $\\sigma(n)$，来观察一个算术函数的看似不规则的行为在平均意义上如何被平滑，并揭示其和函数的一个简单的二次增长模式。这个练习将为我们估算其他算术函数的平均阶奠定基础。[@problem_id:3081698]", "problem": "设 $x \\geq 1$ 是一个实数参数，$\\sigma(n)$ 表示整数 $n$ 的所有正因数之和。考虑求和函数 $S(x)$，其定义为 $S(x) = \\sum_{n \\leq x} \\sigma(n)$。从 $\\sigma(n)$ 的定义和标准的计数原理出发，通过将该和式转化为一个适当的双重求和，并使用经过充分检验的简单整数有限和的估计，来推导当 $x \\to \\infty$ 时 $S(x)$ 的主阶渐近式。你的推导应从第一性原理（例如 $\\sigma(n)$ 的定义和基本的求和事实）开始，并可以引用已知的收敛级数的公认常数和极限。请以一个单一的封闭形式表达式给出 $x$ 的二次主项，该主项在 $x$ 很大时近似于 $S(x)$。此外，简要解释为什么主项是二次的，以及它的常数系数在 $\\sigma(n)$ 的平均阶方面意味着什么。无需四舍五入；请精确报告主项。", "solution": "问题是要求和函数 $S(x) = \\sum_{n \\leq x} \\sigma(n)$ 在 $x$ 很大时的首项渐近行为，其中 $\\sigma(n)$ 是整数 $n$ 的正因数之和。\n\n我们从 $S(x)$ 的定义开始：\n$$S(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sigma(n)$$\n根据定义，$\\sigma(n) = \\sum_{d|n} d$，其中求和遍历 $n$ 的所有正因数 $d$。将此代入 $S(x)$ 的表达式中得到：\n$$S(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} d$$\n这是一个关于整数对 $(n, d)$ 的双重求和，其中 $d$ 整除 $n$ 且 $n \\leq x$。我们可以改变求和的顺序。条件 $d | n$ 意味着对于某个正整数 $k$，有 $n = kd$。条件 $n \\leq x$ 变为 $kd \\leq x$。因此，我们是对所有满足 $kd \\leq x$ 的正整数对 $(k, d)$ 求和项 $d$。\n$$S(x) = \\sum_{k \\geq 1, d \\geq 1, kd \\leq x} d$$\n我们可以通过先对 $k$ 进行迭代，然后对 $d$ 进行迭代来计算这个和。对于一个固定的 $k$， $d$ 的可能取值是 $1, 2, \\ldots, \\lfloor x/k \\rfloor$。$k$ 的范围是从 $1$ 到 $\\lfloor x \\rfloor$。\n$$S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\sum_{d=1}^{\\lfloor x/k \\rfloor} d$$\n内层求和是一个简单的等差数列：\n$$\\sum_{d=1}^{\\lfloor x/k \\rfloor} d = \\frac{\\lfloor x/k \\rfloor (\\lfloor x/k \\rfloor + 1)}{2}$$\n将此代回 $S(x)$ 的表达式中：\n$$S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{\\lfloor x/k \\rfloor (\\lfloor x/k \\rfloor + 1)}{2}$$\n为了找到 $x$ 很大时的首项行为，我们使用底函数的近似。对于任何实数 $y \\geq 1$，我们有 $\\lfloor y \\rfloor = y - \\{y\\}$，其中 $0 \\leq \\{y\\}  1$ 是 $y$ 的小数部分。因此，我们可以写成 $\\lfloor y \\rfloor = y + O(1)$。\n将此应用于 $\\lfloor x/k \\rfloor$：\n$$\\lfloor x/k \\rfloor = \\frac{x}{k} + O(1)$$\n$S(x)$ 的和式中的项变为：\n$$\\frac{1}{2}\\left(\\left(\\frac{x}{k} + O(1)\\right)\\left(\\frac{x}{k} + O(1) + 1\\right)\\right) = \\frac{1}{2}\\left(\\left(\\frac{x}{k}\\right)^2 + O\\left(\\frac{x}{k}\\right)\\right) = \\frac{x^2}{2k^2} + O\\left(\\frac{x}{k}\\right)$$\n现在，我们对 $k$ 求和这个表达式：\n$$S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\left(\\frac{x^2}{2k^2} + O\\left(\\frac{x}{k}\\right)\\right)$$\n我们可以将其分成两部分：\n$$S(x) = \\frac{x^2}{2} \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k^2} + \\sum_{k=1}^{\\lfloor x \\rfloor} O\\left(\\frac{x}{k}\\right)$$\n我们来分析第一项，它将提供主项。该和是级数 $\\sum_{k=1}^{\\infty} \\frac{1}{k^2}$ 的部分和。这个级数收敛于在 2 处求值的 Riemann zeta 函数，即 $\\zeta(2) = \\frac{\\pi^2}{6}$。我们可以将部分和写为：\n$$\\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k^2} = \\sum_{k=1}^{\\infty} \\frac{1}{k^2} - \\sum_{k=\\lfloor x \\rfloor + 1}^{\\infty} \\frac{1}{k^2} = \\zeta(2) - R(x)$$\n余项 $R(x)$ 可以用积分来界定：\n$$R(x) = \\sum_{k=\\lfloor x \\rfloor + 1}^{\\infty} \\frac{1}{k^2} \\le \\int_{\\lfloor x \\rfloor}^{\\infty} \\frac{1}{t^2} dt = \\left[-\\frac{1}{t}\\right]_{\\lfloor x \\rfloor}^{\\infty} = \\frac{1}{\\lfloor x \\rfloor} = O\\left(\\frac{1}{x}\\right)$$\n所以，$S(x)$ 的第一部分是：\n$$\\frac{x^2}{2} \\left(\\zeta(2) + O\\left(\\frac{1}{x}\\right)\\right) = \\frac{\\zeta(2)x^2}{2} + O(x) = \\frac{\\pi^2 x^2}{12} + O(x)$$\n接下来，我们分析我们近似所产生的误差项：\n$$E(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} O\\left(\\frac{x}{k}\\right) = O\\left(x \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}\\right)$$\n这个和是调和级数，其渐近行为是众所周知的：\n$$\\sum_{k=1}^{N} \\frac{1}{k} = \\ln(N) + \\gamma + O\\left(\\frac{1}{N}\\right) = O(\\ln N)$$\n其中 $\\gamma$ 是 Euler-Mascheroni 常数。当 $N = \\lfloor x \\rfloor$ 时，我们有 $\\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} = O(\\ln x)$。\n因此，误差项为：\n$$E(x) = O(x \\ln x)$$\n结合主项和误差项，我们得到 $S(x)$ 的渐近公式：\n$$S(x) = \\frac{\\pi^2 x^2}{12} + O(x \\ln x)$$\n首项是当 $x \\to \\infty$ 时增长最快的一项。由于 $x^2$ 比 $x \\ln x$ 增长得快，所以主项是 $\\frac{\\pi^2 x^2}{12}$。\n\n解释：\n\n1.  为什么主项是二次的？\n    求和函数 $S(x) = \\sum_{n \\leq x} \\sigma(n)$ 是一个累加和。这种和的行为很大程度上由其项的平均大小决定。我们的结果意味着对于 $n \\in [1, x]$，$\\sigma(n)$ 的平均值是 $\\frac{S(x)}{x} \\approx \\frac{\\pi^2 x}{12}$。这意味着 $\\sigma(n)$ 的平均值随 $n$ 近似线性增长。对一个线性增长的函数进行求和（或离散积分），会得到一个二次增长的函数，类似于 $\\int_{0}^{x} ct \\,dt = \\frac{c}{2}x^2$。更正式地说，$\\sigma(n)$ 的平均阶是 $\\frac{\\pi^2}{6}n$，因为 $\\sum_{n \\leq x} \\sigma(n) \\sim \\frac{\\pi^2 x^2}{12}$ 且 $\\sum_{n \\leq x} \\frac{\\pi^2}{6}n = \\frac{\\pi^2}{6} \\frac{\\lfloor x \\rfloor(\\lfloor x \\rfloor+1)}{2} \\sim \\frac{\\pi^2}{12}x^2$。\n\n2.  常数系数 $\\frac{\\pi^2}{12}$ 意味着什么？\n    系数 $\\frac{\\pi^2}{12}$ 精确地是 $\\frac{\\zeta(2)}{2}$。这个常数源于推导过程中的两个因素。因子 $\\frac{1}{2}$ 来自于对线性函数的求和，如上所述（例如，前 $M$ 个整数的和的公式为 $\\frac{M(M+1)}{2} \\approx \\frac{M^2}{2}$）。因子 $\\zeta(2) = \\frac{\\pi^2}{6}$ 源于对平方倒数的求和，即 $\\sum_{k=1}^{\\infty} \\frac{1}{k^2}$。这个和的出现是因为因数的分布方式。比率 $\\frac{\\sigma(n)}{n}$ 在大范围整数上的平均值趋近于 $\\zeta(2)$。也就是说，$\\lim_{x\\to\\infty} \\frac{1}{x} \\sum_{n \\leq x} \\frac{\\sigma(n)}{n} = \\zeta(2) = \\frac{\\pi^2}{6}$。我们对 $S(x)$ 的结果与 $\\sigma(n)$ 在平均意义上表现得像 $\\frac{\\pi^2}{6}n$ 的启发式思想是一致的。将这个平均行为求和至 $x$ 会得到 $\\sum_{n \\leq x} \\frac{\\pi^2}{6}n \\approx \\frac{\\pi^2}{6} \\frac{x^2}{2} = \\frac{\\pi^2}{12}x^2$。因此，该系数既包含了因数函数的算术性质（通过 $\\zeta(2)$），也包含了求和/积分的基本结果。\n\n$S(x)$ 的二次主项因此是 $\\frac{\\pi^2}{12}x^2$。", "answer": "$$\\boxed{\\frac{\\pi^2}{12}x^2}$$", "id": "3081698"}, {"introduction": "在重新解释求和思想的基础上，我们现在来处理经典的除数函数 $\\tau(n)$。本练习引入了强大的狄利克雷双曲线法，这是一种计算格点的几何方法，可以提供更精确的渐近公式。掌握这种方法是理解解析数论中更高级问题的关键一步。[@problem_id:3081675]", "problem": "设 $\\tau(n)$ 表示 $n$ 的正因数个数，对于实数 $t \\geq 1$，设 $H_{t} := \\sum_{n \\leq t} \\frac{1}{n}$ 表示广义调和和。考虑对于实数 $x \\geq 1$ 的求和函数 $S(x) := \\sum_{n \\leq x} \\tau(n)$。从 $\\tau(n)$ 的基本定义和将 $S(x)$ 解释为满足 $d m \\leq x$ 的整数对 $(d,m)$ 数量的双重计数观点出发，推导出一个用底函数之和表示 $S(x)$ 的精确恒等式。然后，通过在 $n = \\lfloor \\sqrt{x} \\rfloor$ 处对称地分割所得的和式，使用 $x H_{\\lfloor \\sqrt{x} \\rfloor}$ 来近似主项，并仅使用初等界来控制余项。假设已知的渐近展开式 $H_{t} = \\ln(t) + \\gamma + O\\!\\left(\\frac{1}{t}\\right)$，其中 $\\gamma$ 是欧拉-马斯刻若尼常数。证明存在一个常数 $C$，使得\n$$\nS(x) = x \\ln(x) + C x + o(x),\n$$\n并确定 $C$ 的闭式表达式。你的最终答案必须是一个单一的解析表达式。不需要四舍五入。", "solution": "问题要求推导除数函数的求和函数 $S(x) = \\sum_{n \\leq x} \\tau(n)$ 的渐近公式，并确定该公式中的一个特定常数。推导过程必须遵循一条预定的路径，包括双重计数论证、对称分割求和以及渐近分析。\n\n首先，我们建立 $S(x)$ 的一个精确恒等式。除数函数 $\\tau(n)$ 定义为整数 $n$ 的正因数个数，可写作 $\\tau(n) = \\sum_{d|n, d0} 1$。将此定义代入 $S(x)$ 的表达式中，得到：\n$$\nS(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\tau(n) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} 1\n$$\n我们可以交换求和顺序。该和是关于满足 $d$ 整除 $n$ 且 $n \\leq x$ 的正整数对 $(n, d)$。这等价于对满足 $n = dm$ 且 $dm \\leq x$ 的正整数对 $(d,m)$ 求和。因此，$S(x)$ 是第一象限中满足 $dm \\leq x$ 的整格点 $(d, m)$ 的数量。\n$$\nS(x) = \\sum_{d \\geq 1, m \\geq 1, dm \\leq x} 1\n$$\n为了将其表示为底函数之和，我们可以先对 $d$ 求和。对于一个固定的正整数 $d$，$m$ 的条件是 $m \\leq \\frac{x}{d}$。由于 $m$ 必须是整数，我们有 $1 \\leq m \\leq \\lfloor \\frac{x}{d} \\rfloor$。$d$ 的最大可能值为 $\\lfloor x \\rfloor$，因为当 $d  x$ 时，$\\lfloor \\frac{x}{d} \\rfloor = 0$。因此，我们得到精确恒等式：\n$$\nS(x) = \\sum_{d=1}^{\\lfloor x \\rfloor} \\sum_{m=1}^{\\lfloor x/d \\rfloor} 1 = \\sum_{d=1}^{\\lfloor x \\rfloor} \\lfloor \\frac{x}{d} \\rfloor\n$$\n接下来，我们应用一种称为狄利克雷双曲线法（Dirichlet hyperbola method）的技术，这对应于“对称分割”的指令。求和区域 $dm \\leq x$（其中 $d,m \\geq 1$）关于直线 $d=m$ 对称。这条直线与边界曲线 $dm=x$ 相交于点 $(\\sqrt{x}, \\sqrt{x})$。令 $N = \\lfloor \\sqrt{x} \\rfloor$。我们计算两个重叠矩形区域中的点数，然后减去它们交集中的点数。\n第一个区域由 $1 \\leq d \\leq N$ 定义。该区域中的点数为 $\\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor$。\n第二个区域由 $1 \\leq m \\leq N$ 定义。点数为 $\\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor$。\n这两个区域的交集是由 $1 \\leq d \\leq N$ 和 $1 \\leq m \\leq N$ 定义的正方形。这个正方形中的点数为 $N \\times N = N^2$。\n根据容斥原理（Principle of Inclusion-Exclusion），总点数为：\n$$\nS(x) = \\left( \\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor \\right) + \\left( \\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor \\right) - N^2 = 2 \\sum_{n=1}^{N} \\lfloor \\frac{x}{n} \\rfloor - N^2\n$$\n其中我们使用 $n$ 作为哑求和指标。\n\n现在我们进行渐近分析。我们将底函数分解为 $\\lfloor z \\rfloor = z - \\{z\\}$，其中 $\\{z\\}$ 是 $z$ 的小数部分，满足 $0 \\leq \\{z\\}  1$。\n$$\nS(x) = 2 \\sum_{n=1}^{N} \\left(\\frac{x}{n} - \\left\\{\\frac{x}{n}\\right\\}\\right) - N^2 = 2x \\sum_{n=1}^{N} \\frac{1}{n} - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\n第一项涉及广义调和和 $H_N = \\sum_{n=1}^{N} \\frac{1}{n}$。因此，表达式变为：\n$$\nS(x) = 2x H_N - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\n让我们分析每一项的大小。\n余项和是有界的：$0 \\leq \\sum_{n=1}^{N} \\{\\frac{x}{n}\\}  \\sum_{n=1}^{N} 1 = N$。因此，$2 \\sum_{n=1}^{N} \\{\\frac{x}{n}\\} = O(N) = O(\\sqrt{x})$。\n对于项 $N^2$，我们有 $N = \\lfloor\\sqrt{x}\\rfloor = \\sqrt{x} - \\{\\sqrt{x}\\}$。\n$$\nN^2 = (\\sqrt{x} - \\{\\sqrt{x}\\})^2 = x - 2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2\n$$\n由于 $0 \\leq \\{\\sqrt{x}\\}  1$，项 $-2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2$ 是 $O(\\sqrt{x})$。因此，我们可以写成 $N^2 = x - O(\\sqrt{x})$，或者等价地 $-N^2 = -x + O(\\sqrt{x})$。\n将这些估计代回 $S(x)$ 的表达式中：\n$$\nS(x) = 2x H_N - O(\\sqrt{x}) - (x - O(\\sqrt{x})) = 2x H_N - x + O(\\sqrt{x})\n$$\n问题给出了调和和的渐近展开式：$H_t = \\ln(t) + \\gamma + O(\\frac{1}{t})$，其中 $\\gamma$ 是欧拉-马斯刻若尼常数。我们将其应用于 $t = N = \\lfloor\\sqrt{x}\\rfloor$。\n$$\nH_N = \\ln(N) + \\gamma + O(\\frac{1}{N})\n$$\n我们需要将 $\\ln(N)$ 与 $\\ln(x)$ 联系起来。\n$$\n\\ln(N) = \\ln(\\lfloor\\sqrt{x}\\rfloor) = \\ln(\\sqrt{x} - \\{\\sqrt{x}\\}) = \\ln\\left(\\sqrt{x}\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\\right)\n$$\n$$\n\\ln(N) = \\ln(\\sqrt{x}) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln(x) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\n$$\n使用对于小的 $u$ 的泰勒展开式 $\\ln(1-u) = -u - \\frac{u^2}{2} - \\dots$。这里 $u = \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}} = O(\\frac{1}{\\sqrt{x}})$。\n$$\n\\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\n所以，$\\ln(N) = \\frac{1}{2}\\ln(x) + O(\\frac{1}{\\sqrt{x}})$。由于 $1/N = O(1/\\sqrt{x})$，$H_N$ 的近似式变为：\n$$\nH_N = \\left(\\frac{1}{2}\\ln(x) + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln(x) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\n最后，我们将其代入 $S(x)$ 的表达式中：\n$$\nS(x) = 2x \\left(\\frac{1}{2}\\ln(x) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) - x + O(\\sqrt{x})\n$$\n$$\nS(x) = x\\ln(x) + 2\\gamma x + 2x \\cdot O\\left(\\frac{1}{\\sqrt{x}}\\right) - x + O(\\sqrt{x})\n$$\n项 $2x \\cdot O(\\frac{1}{\\sqrt{x}})$ 是 $O(\\sqrt{x})$。合并所有误差项，得到：\n$$\nS(x) = x\\ln(x) + (2\\gamma - 1)x + O(\\sqrt{x})\n$$\n题目要求证明 $S(x) = x \\ln(x) + C x + o(x)$。一个 $O(\\sqrt{x})$ 的误差项是一个函数 $f(x)$，对于足够大的 $x$，存在一个常数 $M$ 使得 $|f(x)| \\leq M\\sqrt{x}$。由于 $\\lim_{x\\to\\infty} \\frac{\\sqrt{x}}{x} = \\lim_{x\\to\\infty} \\frac{1}{\\sqrt{x}} = 0$，任何 $O(\\sqrt{x})$ 的函数也都是 $o(x)$。\n因此，我们推导出的渐近公式具有所要求的形式：\n$$\nS(x) = x \\ln(x) + (2\\gamma - 1) x + o(x)\n$$\n通过将其与 $S(x) = x \\ln(x) + C x + o(x)$ 进行比较，我们确定常数 $C$。\n$$\nC = 2\\gamma - 1\n$$\n这就是常数 $C$ 的闭式表达式。", "answer": "$$\n\\boxed{2\\gamma - 1}\n$$", "id": "3081675"}, {"introduction": "在之前的练习中，我们为什么要在 $\\sqrt{x}$ 处分割求和？最后一个练习将从应用一种方法转向分析它。通过引入一个通用的分割参数 $y$，我们可以将误差项视为一个需要最小化的函数，从而揭示标准选择 $\\sqrt{x}$ 背后深刻的数学原理，并加深我们对误差分析的理解。[@problem_id:3081705]", "problem": "设 $x \\geq 1$ 是一个实参数，并设 $\\tau(n)$ 表示整数 $n$ 的正因子数量。考虑因子求和函数 $D(x) = \\sum_{n \\leq x} \\tau(n)$，并将其解释为满足 $ab \\leq x$ 的正整数对 $(a,b)$ 的数量。固定一个分割参数 $y$，满足 $1 \\leq y \\leq \\sqrt{x}$，并将整数对 $(a,b)$ 的计数分解为 $a \\leq y$ 的部分和 $b \\leq y$ 的部分，同时仔细考虑重叠部分。\n\n从 $\\tau(n)$ 的基本定义和 $D(x)$ 作为双曲线 $ab \\leq x$ 下方格点计数的解释出发，推导一个 $D(x)$ 的分解，该分解分离出由在 $y$ 处的分割所产生的边界矩形的贡献。然后，仅使用初等分析中经过充分验证的事实来近似所得的和，特别是调和数满足 $H_{y} = \\sum_{n=1}^{\\lfloor y \\rfloor} \\frac{1}{n} = \\ln y + \\gamma + O\\!\\left(\\frac{1}{y}\\right)$，其中 $\\gamma$ 是 Euler–Mascheroni 常数。由此，得到 $D(x)$ 的一个显式主项以及一个用 $x$ 和 $y$ 表示的显式误差界。\n\n最后，将总误差作为 $y$ 的函数，在范围 $1 \\leq y \\leq \\sqrt{x}$ 上进行最小化，并以 $x$ 的闭式表达式报告 $y$ 的最优选择。不需要四舍五入，并且您必须将最终答案表示为单个解析表达式。", "solution": "该问题要求使用 Dirichlet 双曲线法，并采用一个通用的分割参数 $y$，来分析因子求和函数 $D(x) = \\sum_{n \\leq x} \\tau(n)$。我们已知 $1 \\leq y \\leq \\sqrt{x}$。\n\n第一步是建立 $D(x)$ 的分解。函数 $D(x)$ 计算满足其乘积 $ab \\leq x$ 的正整数对 $(a,b)$ 的数量。我们被引导根据 $a \\leq y$ 或 $b \\leq y$ 来分割这个计数。\n\n设 $S = \\{(a,b) \\in \\mathbb{Z}^+ \\times \\mathbb{Z}^+ : ab \\leq x\\}$。那么 $D(x) = |S|$。\n我们根据条件 $a \\leq y$ 和 $b \\leq y$ 将集合 $S$ 分割成四个不相交的子集：\n1.  $S_{1} = \\{(a,b) \\in S : a \\leq y \\text{ 且 } b \\leq y\\}$\n2.  $S_{2} = \\{(a,b) \\in S : a \\leq y \\text{ 且 } b  y\\}$\n3.  $S_{3} = \\{(a,b) \\in S : a  y \\text{ 且 } b \\leq y\\}$\n4.  $S_{4} = \\{(a,b) \\in S : a  y \\text{ 且 } b  y\\}$\n\n总计数是这四个集合大小之和：$D(x) = |S_{1}|+|S_{2}|+|S_{3}|+|S_{4}|$。令 $Y = \\lfloor y \\rfloor$。\n\n1.  对于 $S_{1}$：条件是 $1 \\leq a \\leq Y$ 和 $1 \\leq b \\leq Y$。因为 $y \\leq \\sqrt{x}$，所以有 $y^2 \\leq x$。因此，对于此集合中的任何一对 $(a,b)$，都有 $ab \\leq Y^2 \\leq y^2 \\leq x$，所以条件 $ab \\leq x$ 自动满足。此类整数对的数量为 $|S_{1}| = \\lfloor y \\rfloor \\cdot \\lfloor y \\rfloor = \\lfloor y \\rfloor^2$。\n\n2.  对于 $S_{2}$：条件是 $1 \\leq a \\leq Y$ 和 $b  Y$（即 $b \\geq Y+1$），且 $ab \\leq x$。我们通过对 $a$ 求和来计数：\n    $|S_{2}| = \\sum_{a=1}^{\\lfloor y \\rfloor} \\left( \\sum_{b=1}^{\\lfloor x/a \\rfloor} 1 - \\sum_{b=1}^{\\lfloor y \\rfloor} 1 \\right) = \\sum_{a=1}^{\\lfloor y \\rfloor} (\\lfloor\\frac{x}{a}\\rfloor - \\lfloor y \\rfloor)$。\n\n3.  对于 $S_{3}$：这个集合通过交换 $a$ 和 $b$ 与 $S_2$ 对称。因此， $|S_{3}| = |S_{2}| = \\sum_{b=1}^{\\lfloor y \\rfloor} (\\lfloor\\frac{x}{b}\\rfloor - \\lfloor y \\rfloor)$。\n\n4.  对于 $S_{4}$：这个集合代表剩余的点。我们用 $R(x,y) = |S_4|$ 表示其大小。这些是“远离”坐标轴的点。\n\n合并这些计数，我们得到：\n$D(x) = \\lfloor y \\rfloor^2 + \\sum_{a=1}^{\\lfloor y \\rfloor} (\\lfloor\\frac{x}{a}\\rfloor - \\lfloor y \\rfloor) + \\sum_{b=1}^{\\lfloor y \\rfloor} (\\lfloor\\frac{x}{b}\\rfloor - \\lfloor y \\rfloor) + R(x,y)$\n$D(x) = \\lfloor y \\rfloor^2 + 2\\sum_{a=1}^{\\lfloor y \\rfloor} \\lfloor\\frac{x}{a}\\rfloor - 2\\sum_{a=1}^{\\lfloor y \\rfloor} \\lfloor y \\rfloor + R(x,y)$\n$D(x) = \\lfloor y \\rfloor^2 + 2\\sum_{a=1}^{\\lfloor y \\rfloor} \\lfloor\\frac{x}{a}\\rfloor - 2\\lfloor y \\rfloor^2 + R(x,y)$\n$D(x) = 2\\sum_{a=1}^{\\lfloor y \\rfloor} \\lfloor\\frac{x}{a}\\rfloor - \\lfloor y \\rfloor^2 + R(x,y)$。\n\n这个恒等式是精确的。它将 $D(x)$ 分解为一个易于分析的部分（求和项与平方项）和一个余项 $R(x,y)$。项 $2\\sum \\lfloor x/a \\rfloor - \\lfloor y \\rfloor^2$ 计入了 $a \\le y$ 或 $b \\le y$ 的点，并减去了重叠部分 $\\lfloor y \\rfloor^2$。\n\n接下来，我们近似这些项以找到主项和误差界。令 $Y = \\lfloor y \\rfloor$。\n我们使用近似 $\\lfloor z \\rfloor = z - \\{z\\} = z + O(1)$，其中 $\\{z\\}$ 是 $z$ 的小数部分。\n和式近似为：\n$$ \\sum_{a=1}^{Y} \\left\\lfloor\\frac{x}{a}\\right\\rfloor = \\sum_{a=1}^{Y} \\left(\\frac{x}{a} - \\left\\{\\frac{x}{a}\\right\\}\\right) = x \\sum_{a=1}^{Y} \\frac{1}{a} - \\sum_{a=1}^{Y} \\left\\{\\frac{x}{a}\\right\\} $$\n第一项是 $x H_Y$，其中 $H_Y$ 是第 $Y$ 个调和数。第二项是 $Y$ 个介于 $0$ 和 $1$ 之间的数字之和，因此其大小以 $Y$ 为界。因此，$\\sum_{a=1}^{Y} \\left\\{\\frac{x}{a}\\right\\} = O(Y) = O(y)$。\n使用给定的调和数近似，$H_Y = \\ln(Y) + \\gamma + O(1/Y)$。\n由于 $Y = y - \\{y\\} = y+O(1)$，我们有 $\\ln(Y) = \\ln(y+O(1)) = \\ln(y(1+O(1/y))) = \\ln y + O(1/y)$。\n因此，$H_Y = \\ln y + \\gamma + O(1/y)$。\n将此代入和的近似式中：\n$$ \\sum_{a=1}^{Y} \\left\\lfloor\\frac{x}{a}\\right\\rfloor = x(\\ln y + \\gamma + O(1/y)) + O(y) = x \\ln y + \\gamma x + O(x/y) + O(y) $$\n现在，我们将其用于 $D(x)$ 的分解中：\n$2\\sum_{a=1}^{Y} \\lfloor\\frac{x}{a}\\rfloor - Y^2 = 2(x \\ln y + \\gamma x + O(x/y) + O(y)) - (y+O(1))^2$\n$ = 2x \\ln y + 2\\gamma x - y^2 + O(x/y) + O(y)$。\n\n余项 $R(x,y)$ 计算由 $a  y, b  y, ab \\leq x$ 定义的区域内的整数点。这样一个“行为良好”的区域中的点数可以用其面积来近似，误差与其周长成正比。\n面积由积分给出：\n$$ A_R = \\int_y^{x/y} \\left(\\frac{x}{u}-y\\right) du = \\left[x \\ln u - yu\\right]_y^{x/y} = (x\\ln(x/y) - y(x/y)) - (x\\ln y - y^2) $$\n$$ A_R = x\\ln x - x\\ln y - x - x\\ln y + y^2 = x\\ln x - 2x\\ln y - x + y^2 $$\n该区域的周长由两条长度为 $(x/y - y)$ 的线段和一段双曲线弧组成。总长度主要由线段决定，因此周长为 $P = O(x/y)$。用面积近似点数的误差为 $O(P) = O(x/y)$。\n所以，$R(x,y) = x\\ln x - 2x\\ln y - x + y^2 + O(x/y)$。\n\n现在我们组合所有部分来近似 $D(x)$：\n$D(x) = \\left(2x \\ln y + 2\\gamma x - y^2 + O(x/y) + O(y)\\right) + \\left(x\\ln x - 2x\\ln y - x + y^2 + O(x/y)\\right)$\n主表达式中涉及 $y$ 的项相互抵消：\n$D(x) = (2x \\ln y - 2x \\ln y) + (2\\gamma x - x) + (-y^2 + y^2) + x \\ln x + (\\text{误差项})$。\n$D(x) = x \\ln x + (2\\gamma - 1)x + O(y) + O(x/y)$。\n\n$D(x)$ 的主项是 $x \\ln x + (2\\gamma - 1)x$，这是一个众所周知的结果。该方法产生的误差项是 $E(x,y) = O(y) + O(x/y)$。这意味着存在常数 $C_1, C_2  0$，使得绝对误差的界为 $C_1 y + C_2 x/y$。\n\n最后，我们必须在范围 $1 \\leq y \\leq \\sqrt{x}$ 内找到参数 $y$ 的最优选择，以最小化此误差界。我们需要最小化函数 $f(y) = C_1 y + C_2 x/y$。\n为了找到最小值，我们对 $y$ 求导并令其为零：\n$f'(y) = C_1 - C_2 \\frac{x}{y^2} = 0$。\n这得出 $y^2 = \\frac{C_2}{C_1}x$，所以最优的 $y$ 是 $y^* = \\sqrt{\\frac{C_2}{C_1}} \\sqrt{x}$。\n二阶导数 $f''(y) = 2C_2 x/y^3$ 在 $y0$ 时为正，确认这是一个最小值。\n\n问题没有提供足够的信息来确定常数 $C_1$ 和 $C_2$。然而，该方法的原理是选择 $y$ 来平衡两个主要的误差来源，它们的量级分别为 $y$ 和 $x/y$。平衡它们意味着将它们设置为相同的数量级：$y \\approx x/y$，这意味着 $y^2 \\approx x$，所以 $y \\approx \\sqrt{x}$。这对应于常数 $C_1$ 和 $C_2$ 具有相同量级的情况，使得比率 $\\sqrt{C_2/C_1}$ 是一个接近 $1$ 的常数。在没有更多信息的情况下，最能代表这种平衡的选择是 $y = \\sqrt{x}$。这个选择位于指定区间 $[1, \\sqrt{x}]$ 的边界上。任何 $y \\propto \\sqrt{x}$ 的选择都会产生 $O(\\sqrt{x})$ 的误差。在区间 $[1, \\sqrt{x}]$ 上最小化 $f(y)$，如果无约束最小值 $y^*$ 满足 $y^* \\ge \\sqrt{x}$ (即 $C_2/C_1 \\ge 1$)，则最小值在 $y=\\sqrt{x}$ 处取得；如果 $y^*  \\sqrt{x}$，则最小值在 $y^*$ 处取得。假设在该算法的最有效版本中，误差贡献大致相等，这导致设定 $y=\\sqrt{x}$。\n\n因此，最小化一般误差界的最优 $y$ 选择是 $y=\\sqrt{x}$。", "answer": "$$\n\\boxed{\\sqrt{x}}\n$$", "id": "3081705"}]}