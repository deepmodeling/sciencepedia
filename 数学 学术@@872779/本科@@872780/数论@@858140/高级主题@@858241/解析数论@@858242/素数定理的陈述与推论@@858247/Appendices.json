{"hands_on_practices": [{"introduction": "素数定理最直接的应用之一是估算大区间内素数的数量。这个练习将指导你使用基本的渐近关系 $\\pi(x) \\sim x/\\ln x$ 来推导区间 $(x, 2x]$ 中素数的数量级 [@problem_id:3092828]。这项基本技能不仅强化了对渐近分析的理解，也从一个侧面印证了对于足够大的 $x$，该区间内总是存在素数。", "problem": "设 $\\pi(x)$ 表示素数计数函数，即小于或等于 $x$ 的素数的个数。仅使用素数定理 (PNT) 的陈述，即当 $x\\to\\infty$ 时 $\\pi(x)\\sim x/\\ln x$，推导区间 $(x,2x]$ 中素数个数的渐近估计。从基本恒等式 $\\pi(2x)-\\pi(x)$ 开始，并通过仔细比较由 PNT 产生的各项，证明该计数渐近于一个包含自然对数的关于 $x$ 的单一闭合形式表达式。你的最终答案必须是一个不含不等式的关于 $x$ 的单一解析表达式。", "solution": "该问题要求对区间 $(x, 2x]$ 中的素数个数进行渐近估计。这些素数的个数恰好由素数计数函数值的差给出，即 $\\pi(2x) - \\pi(x)$。我们被要求使用素数定理 (PNT) 来推导这个估计。\n\nPNT 的陈述为当 $x \\to \\infty$ 时 $\\pi(x) \\sim \\frac{x}{\\ln x}$。根据定义，如果两个函数 $f(x)$ 和 $g(x)$ 的比值的极限为 $1$，则它们是渐近的，记为 $f(x) \\sim g(x)$：\n$$ \\lim_{x\\to\\infty} \\frac{f(x)}{g(x)} = 1 $$\n\n我们寻求一个简单的函数 $g(x)$，使得 $\\pi(2x) - \\pi(x) \\sim g(x)$。一个自然的候选函数 $g(x)$ 是 $\\pi(2x)$ 和 $\\pi(x)$ 的渐近近似值的差。然而，必须谨慎，因为 $f_1(x) \\sim g_1(x)$ 和 $f_2(x) \\sim g_2(x)$ 通常并不意味着 $f_1(x) - f_2(x) \\sim g_1(x) - g_2(x)$，特别是当 $g_1(x)$ 和 $g_2(x)$ 的值非常接近时。\n\n一个严格的方法是直接分析 $\\pi(2x) - \\pi(x)$ 与一个候选函数的比值的极限。让我们以函数 $\\frac{x}{\\ln x}$ 作为渐近估计进行检验。我们必须验证以下极限是否成立：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = 1 $$\n\n利用极限的性质，我们可以将比值的极限表示为两个极限的差，前提是每个极限都存在且为有限值：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\left( \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} - \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) = \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} \\right) - \\left( \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) $$\n\n我们来分别计算每个极限。\n\n对于第二项，根据 PNT 的定义，我们有：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} = 1 $$\n\n对于第一项，我们可以通过乘以并除以 $\\pi(2x)$ 的渐近形式 $\\frac{2x}{\\ln(2x)}$ 来重写表达式，这是由 PNT 应用于参数 $2x$ 得到的：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\left( \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} \\cdot \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} \\right) $$\n使用极限的乘法法则，我们可以将其分为两个极限：\n$$ \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} \\right) \\cdot \\left( \\lim_{x\\to\\infty} \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} \\right) $$\n根据应用于参数 $2x$ 的 PNT，这两个极限中的第一个等于 $1$：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} = 1 $$\n第二个极限需要代数变换：\n$$ \\lim_{x\\to\\infty} \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\frac{2x}{\\ln(2x)} \\cdot \\frac{\\ln x}{x} = \\lim_{x\\to\\infty} \\frac{2\\ln x}{\\ln(2x)} $$\n利用对数性质 $\\ln(2x) = \\ln 2 + \\ln x$，我们得到：\n$$ \\lim_{x\\to\\infty} \\frac{2\\ln x}{\\ln 2 + \\ln x} $$\n为了计算这个极限，我们将分子和分母同时除以 $\\ln x$：\n$$ \\lim_{x\\to\\infty} \\frac{2}{\\frac{\\ln 2}{\\ln x} + 1} $$\n当 $x \\to \\infty$ 时，$\\ln x \\to \\infty$，所以 $\\frac{\\ln 2}{\\ln x} \\to 0$。因此，极限为：\n$$ \\frac{2}{0 + 1} = 2 $$\n结合原始差分中第一项的结果：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} = 1 \\cdot 2 = 2 $$\n\n现在我们可以将这两个极限的值代回到差分极限的表达式中：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} \\right) - \\left( \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) = 2 - 1 = 1 $$\n由于 $\\pi(2x) - \\pi(x)$ 与 $\\frac{x}{\\ln x}$ 的比值的极限为 $1$，我们严格地证明了：\n$$ \\pi(2x) - \\pi(x) \\sim \\frac{x}{\\ln x} $$\n\n因此，区间 $(x, 2x]$ 中素数个数的渐近估计是 $\\frac{x}{\\ln x}$。这是一个符合要求的，包含自然对数的关于 $x$ 的单一闭合形式表达式。", "answer": "$$\\boxed{\\frac{x}{\\ln(x)}}$$", "id": "3092828"}, {"introduction": "素数定理有多种等价的表述形式，理解它们之间的联系至关重要。本练习将引导你探索素数计数函数 $\\pi(x)$ 与通过 von Mangoldt 函数 $\\Lambda(n)$ 定义的 Chebyshev 函数 $\\psi(x)$ 之间的深刻联系 [@problem_id:3092826]。通过证明 $\\Lambda(n)$ 的算术平均值趋近于 1，你将对素数幂的“概率性”分布获得更深层次的认识。", "problem": "令 $\\Lambda(n)$ 表示 von Mangoldt 函数，其定义为：如果 $n=p^{k}$（其中 $p$ 为某个素数，$k \\geq 1$ 为整数），则 $\\Lambda(n)=\\ln(p)$；否则 $\\Lambda(n)=0$。定义 Chebyshev 函数 $\\psi(x)$ 为 $\\psi(x)=\\sum_{n \\leq x} \\Lambda(n)$。假设素数定理 (PNT) 的 Chebyshev 形式成立，即当 $x \\to \\infty$ 时，$\\psi(x) \\sim x$，其中 $f(x) \\sim g(x)$ 表示 $\\lim_{x \\to \\infty} \\frac{f(x)}{g(x)}=1$。考虑算术平均值\n$$\nA(x)=\\frac{1}{x} \\sum_{n \\leq x} \\Lambda(n).\n$$\n仅使用给定的定义和渐近假设 $\\psi(x) \\sim x$，确定极限\n$$\nL=\\lim_{x \\to \\infty} A(x).\n$$\n的精确值。你的最终答案必须是一个实数。不需要进行四舍五入。", "solution": "问题要求极限 $L = \\lim_{x \\to \\infty} A(x)$ 的精确值，其中 $A(x)$ 定义为 von Mangoldt 函数 $\\Lambda(n)$ 的算术平均值。\n\n首先，我们写下题目陈述中提供的定义。\nvon Mangoldt 函数 $\\Lambda(n)$ 定义为：\n$$\n\\Lambda(n) =\n\\begin{cases}\n\\ln(p)  \\text{如果 } n = p^k \\text{，其中 } p \\text{ 是某个素数且 } k \\geq 1 \\text{ 是整数} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n\n算术平均值 $A(x)$ 由下式给出：\n$$\nA(x) = \\frac{1}{x} \\sum_{n \\leq x} \\Lambda(n)\n$$\n\n第二 Chebyshev 函数 $\\psi(x)$ 定义为 $\\Lambda(n)$ 的求和函数：\n$$\n\\psi(x) = \\sum_{n \\leq x} \\Lambda(n)\n$$\n\n我们的目标是计算 $L = \\lim_{x \\to \\infty} A(x)$。我们首先将 $A(x)$ 用 $\\psi(x)$ 表示。通过将 $\\psi(x)$ 的定义代入 $A(x)$ 的表达式中，我们直接得到：\n$$\nA(x) = \\frac{\\psi(x)}{x}\n$$\n\n问题现在简化为求当 $x$ 趋于无穷大时这个比值的极限：\n$$\nL = \\lim_{x \\to \\infty} A(x) = \\lim_{x \\to \\infty} \\frac{\\psi(x)}{x}\n$$\n\n题目明确提供了计算此极限所需的关键信息：我们需要假设素数定理 (PNT) 的 Chebyshev 形式成立。这被表述为当 $x \\to \\infty$ 时的渐近等价关系 $\\psi(x) \\sim x$。\n\n题目中定义了记号 $f(x) \\sim g(x)$ 的含义是两个函数之比的极限为 $1$：\n$$\n\\lim_{x \\to \\infty} \\frac{f(x)}{g(x)} = 1\n$$\n\n将此定义应用于给定的假设 $\\psi(x) \\sim x$，我们有：\n$$\n\\lim_{x \\to \\infty} \\frac{\\psi(x)}{x} = 1\n$$\n\n这正是我们为计算 $L$ 所需的极限。因此，我们可以得出结论，极限值为 $1$。\n$$\nL = 1\n$$\n这个结论是按照规定，仅使用题目中提供的定义和 $\\psi(x) \\sim x$ 形式的 PNT 的明确假设得出的。该问题本质上是要求在所定义的算术平均值 $A(x)$ 的背景下，对表述 $\\psi(x) \\sim x$ 进行解释。", "answer": "$$\n\\boxed{1}\n$$", "id": "3092826"}, {"introduction": "虽然 $x/\\ln x$ 是一个很好的初步近似，但对数积分函数 $\\mathrm{Li}(x)$ 提供了远为精确的估计。这个问题将挑战你使用 $\\mathrm{Li}(x)$ 的积分形式，为“短”区间 $(x, ax]$ 内的素数数量推导出一个更精确的两项渐近公式 [@problem_id:3092817]。这个过程将展示在数论研究中，使用更精细的分析工具所带来的强大威力。", "problem": "设 $\\pi(x)$ 表示素数计数函数，对数积分 $\\mathrm{Li}(x)$ 定义为 $\\mathrm{Li}(x) = \\int_{2}^{x} \\frac{dt}{\\ln t}$。假设素数定理 (PNT) 成立，即当 $x \\to \\infty$ 时，$\\pi(x) \\sim \\mathrm{Li}(x)$。考虑一个固定常数 $a \\in (1, \\infty)$ 和短区间 $(x, ax]$，其中 $a = \\frac{11}{10}$。仅使用 $\\pi(x) \\sim \\mathrm{Li}(x)$ 和 $\\mathrm{Li}(y) = \\int_{2}^{y} \\frac{dt}{\\ln t}$ 这两个基本事实，从第一性原理推导当 $x \\to \\infty$ 时，区间 $(x, ax]$ 内素数数量关于 $(\\ln x)^{-1}$ 幂次的两项渐近展开式。具体来说：\n\n- 证明其首项渐近于 $\\frac{(a-1)x}{\\ln x}$，并将其特化为 $a=\\frac{11}{10}$ 以得到 $\\frac{1}{10}\\frac{x}{\\ln x}$。\n- 通过系统地展开 $\\mathrm{Li}(ax) - \\mathrm{Li}(x)$ 的积分表示，并保留到 $(\\ln x)^{-2}$ 阶的项，来估计下一阶项。\n\n你的最终答案必须是 $\\pi\\!\\left(\\frac{11}{10}x\\right) - \\pi(x)$ 的两项渐近近似的单个闭式解析表达式，用 $x$、$\\ln x$ 和 $\\ln\\!\\left(\\frac{11}{10}\\right)$ 表示，不进行四舍五入，也不使用大O符号。不包含任何单位。", "solution": "### 渐近展开的推导\n\n区间 $(x, ax]$ 内的素数数量由差值 $\\pi(ax) - \\pi(x)$ 给出。素数定理 (PNT) 表述为当 $y \\to \\infty$ 时 $\\pi(y) \\sim \\mathrm{Li}(y)$，这意味着对于大的 $x$，这个短区间内的素数数量可以很好地用对数积分的差来近似：\n$$\n\\pi(ax) - \\pi(x) \\sim \\mathrm{Li}(ax) - \\mathrm{Li}(x)\n$$\n使用对数积分的定义 $\\mathrm{Li}(y) = \\int_{2}^{y} \\frac{dt}{\\ln t}$，我们可以将这个差写成一个单一的积分：\n$$\n\\mathrm{Li}(ax) - \\mathrm{Li}(x) = \\int_{2}^{ax} \\frac{dt}{\\ln t} - \\int_{2}^{x} \\frac{dt}{\\ln t} = \\int_{x}^{ax} \\frac{dt}{\\ln t}\n$$\n为了找到当 $x \\to \\infty$ 时该积分的渐近展开式，我们进行换元 $t = xu$。这意味着 $dt = x \\, du$。积分上下限从 $t=x$ 变为 $u=1$，从 $t=ax$ 变为 $u=a$。积分变为：\n$$\n\\int_{x}^{ax} \\frac{dt}{\\ln t} = \\int_{1}^{a} \\frac{x \\, du}{\\ln(xu)} = x \\int_{1}^{a} \\frac{du}{\\ln x + \\ln u}\n$$\n对于大的 $x$，我们可以从分母中提出因子 $\\ln x$：\n$$\nx \\int_{1}^{a} \\frac{du}{\\ln x \\left(1 + \\frac{\\ln u}{\\ln x}\\right)} = \\frac{x}{\\ln x} \\int_{1}^{a} \\frac{1}{1 + \\frac{\\ln u}{\\ln x}} \\, du\n$$\n常数 $a$ 是固定的，所以对于任意 $u \\in [1, a]$，当 $x \\to \\infty$ 时，项 $\\frac{\\ln u}{\\ln x}$ 趋近于 0。这使得我们可以使用 $\\frac{1}{1+z}$ 的几何级数展开，其中 $z = \\frac{\\ln u}{\\ln x}$：\n$$\n\\frac{1}{1+z} = 1 - z + z^2 - z^3 + \\dots\n$$\n我们需要一个两项展开式，所以我们保留到 $z$ 阶的项：\n$$\n\\frac{1}{1 + \\frac{\\ln u}{\\ln x}} = 1 - \\frac{\\ln u}{\\ln x} + O\\left(\\left(\\frac{\\ln u}{\\ln x}\\right)^2\\right)\n$$\n将此展开式代回积分中：\n$$\n\\frac{x}{\\ln x} \\int_{1}^{a} \\left(1 - \\frac{\\ln u}{\\ln x} + \\dots \\right) du = \\frac{x}{\\ln x} \\left( \\int_{1}^{a} du - \\frac{1}{\\ln x} \\int_{1}^{a} \\ln u \\, du + \\dots \\right)\n$$\n我们现在计算这两个关于 $u$ 的积分：\n第一个积分很简单：\n$$\n\\int_{1}^{a} 1 \\, du = [u]_{1}^{a} = a - 1\n$$\n第二个积分使用分部积分法计算，$\\int \\ln u \\, du = u \\ln u - u$：\n$$\n\\int_{1}^{a} \\ln u \\, du = [u \\ln u - u]_{1}^{a} = (a \\ln a - a) - (1 \\ln 1 - 1) = a \\ln a - a + 1\n$$\n将这些结果代回展开式中，我们得到：\n$$\n\\mathrm{Li}(ax) - \\mathrm{Li}(x) \\approx \\frac{x}{\\ln x} \\left( (a - 1) - \\frac{1}{\\ln x} (a \\ln a - a + 1) \\right)\n$$\n分配各项，得到所需的两项渐近展开式：\n$$\n\\mathrm{Li}(ax) - \\mathrm{Li}(x) \\approx \\frac{(a-1)x}{\\ln x} - \\frac{(a \\ln a - a + 1)x}{(\\ln x)^2} = \\frac{(a-1)x}{\\ln x} + \\frac{(a - 1 - a \\ln a)x}{(\\ln x)^2}\n$$\n\n### 首项和次阶项的证明\n\n问题的第一个部分要求证明首项。从推导出的展开式可知，首项为：\n$$\n\\pi(ax) - \\pi(x) \\sim \\frac{(a-1)x}{\\ln x}\n$$\n对于 $a = \\frac{11}{10}$ 的特定情况，我们有 $a-1 = \\frac{11}{10} - 1 = \\frac{1}{10}$。首项变为：\n$$\n\\frac{\\left(\\frac{1}{10}\\right)x}{\\ln x} = \\frac{x}{10 \\ln x}\n$$\n这证实了问题陈述的第一部分。\n\n问题的第二部分要求下一阶项。$\\pi(ax) - \\pi(x)$ 的完整两项展开式由下式给出：\n$$\n\\pi(ax) - \\pi(x) \\approx \\frac{(a-1)x}{\\ln x} + \\frac{(a - 1 - a \\ln a)x}{(\\ln x)^2}\n$$\n我们将此表达式特化为 $a = \\frac{11}{10}$：\n第一项的系数是 $a-1 = \\frac{1}{10}$。\n第二项分子的系数是 $a - 1 - a \\ln a = \\frac{1}{10} - \\frac{11}{10} \\ln\\left(\\frac{11}{10}\\right)$。\n\n综合这些，区间 $\\left(x, \\frac{11}{10}x\\right]$ 内素数数量的两项渐近近似为：\n$$\n\\pi\\left(\\frac{11}{10}x\\right) - \\pi(x) \\approx \\frac{\\frac{1}{10}x}{\\ln x} + \\frac{\\left(\\frac{1}{10} - \\frac{11}{10} \\ln\\left(\\frac{11}{10}\\right)\\right)x}{(\\ln x)^2}\n$$\n这个表达式可以写成更合并的形式：\n$$\n\\frac{x}{10 \\ln x} + \\frac{x\\left(1 - 11 \\ln\\left(\\frac{11}{10}\\right)\\right)}{10 (\\ln x)^2}\n$$\n这就是最终所需的闭式解析表达式，用 $x$、$\\ln x$ 和 $\\ln\\left(\\frac{11}{10}\\right)$ 表示，且不含大O符号。", "answer": "$$\n\\boxed{\\frac{x}{10 \\ln x} + \\frac{x\\left(1 - 11 \\ln\\left(\\frac{11}{10}\\right)\\right)}{10 (\\ln x)^2}}\n$$", "id": "3092817"}]}