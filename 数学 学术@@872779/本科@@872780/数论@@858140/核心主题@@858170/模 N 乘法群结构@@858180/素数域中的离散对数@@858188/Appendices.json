{"hands_on_practices": [{"introduction": "理论是抽象的，但通过亲手计算，我们可以最直观地理解离散对数的本质。这个练习将带你回到离散对数最基本的定义，在一个小的素数域中，通过“暴力”枚举的方式为群中的每一个元素计算其离散对数。通过构建一个完整的对数表，你将不仅能掌握离散对数和生成元的概念，还能深刻体会循环群的结构性之美。[@problem_id:3084393]", "problem": "设素数 $p=17$，考虑非零剩余类模 $p$ 的乘法群 $\\mathbb{F}_{p}^{\\times}$。根据 Lagrange 定理，该群的阶为 $p-1=16$。令 $g=3\\in\\mathbb{F}_{p}^{\\times}$。对于元素 $y\\in\\langle g\\rangle$，其关于基 $g$ 的离散对数定义为满足 $g^{k}\\equiv y\\pmod{p}$ 的任意整数 $k$。通常取值范围在 $\\{0,1,\\dots,\\operatorname{ord}(g)-1\\}$ 内的代表元，其中 $\\operatorname{ord}(g)$ 表示 $g$ 在 $\\mathbb{F}_{p}^{\\times}$ 中的阶。请按以下步骤进行，从基本事实出发：$\\mathbb{F}_{p}^{\\times}$ 是一个阶为 $p-1$ 的循环群，且对于任意 $a\\in\\mathbb{F}_{p}^{\\times}$，都有 $a^{p-1}\\equiv 1\\pmod{p}$。\n\n1) 仅使用上述事实和必要的 $g$ 的幂模 $p$ 的直接计算，确定 $g$ 在 $\\mathbb{F}_{p}^{\\times}$ 中的阶 $\\operatorname{ord}(g)$。\n\n2) 计算当 $k=0,1,\\dots,\\operatorname{ord}(g)-1$ 时剩余 $g^{k}\\bmod p$ 的完整列表，然后通过反转此列表来确定每个 $y\\in\\langle g\\rangle$ 的 $\\log_{g}(y)$。\n\n3) 仅使用阶的群论定义，证明如果 $g^{a}\\equiv g^{b}\\pmod{p}$，则 $\\operatorname{ord}(g)$ 整除 $a-b$，从而证明离散对数在模 $\\operatorname{ord}(g)$ 意义下是唯一的。\n\n完成这些步骤后，报告 $\\log_{3}(7)$ 的值，该值应为范围 $\\{0,1,\\dots,\\operatorname{ord}(g)-1\\}$ 内的一个整数。无需四舍五入。", "solution": "该问题陈述清晰，科学上合理，并包含了得出唯一解所需的所有信息。所涉及的概念是群论和数论的基础。我们按照要求分三部分进行解答。\n\n问题设置在整数模 $p=17$ 的乘法群中，记为 $\\mathbb{F}_{17}^{\\times}$。这是一个阶为 $p-1 = 17-1 = 16$ 的循环群。离散对数的基给定为 $g=3$。\n\n**1) 确定 $g=3$ 在 $\\mathbb{F}_{17}^{\\times}$ 中的阶**\n\n在有限群 $G$ 中，一个元素 $g$ 的阶，记作 $\\operatorname{ord}(g)$，是使 $g^k$ 等于单位元的最小正整数 $k$。在 $\\mathbb{F}_{p}^{\\times}$ 中，单位元是 $1$。根据 Lagrange 定理，任何元素的阶必须整除群的阶。$\\mathbb{F}_{17}^{\\times}$ 的阶是 $16$。因此，$\\operatorname{ord}(3)$ 必须是 $16$ 的因子。$16$ 的因子有 $1, 2, 4, 8, 16$。我们按升序测试 $g=3$ 的这些次幂模 $p=17$ 的值。\n\n$3^1 \\equiv 3 \\pmod{17}$\n$3^2 \\equiv 9 \\pmod{17}$\n$3^4 \\equiv (3^2)^2 \\equiv 9^2 = 81 \\equiv 81 - 4 \\cdot 17 = 81 - 68 \\equiv 13 \\pmod{17}$\n$3^8 \\equiv (3^4)^2 \\equiv 13^2 = 169 \\equiv 169 - 9 \\cdot 17 = 169 - 153 \\equiv 16 \\pmod{17}$。或者，$169 = 10 \\cdot 17 - 1 \\equiv -1 \\pmod{17}$。\n由于 $3^8 \\not\\equiv 1 \\pmod{17}$，所以阶不可能是 $1, 2, 4,$ 或 $8$。下一个因子是 $16$。我们来检验一下：\n$3^{16} \\equiv (3^8)^2 \\equiv 16^2 \\equiv (-1)^2 \\equiv 1 \\pmod{17}$。\n\n这证实了使 $3^k \\equiv 1 \\pmod{17}$ 成立的最小正整数 $k$ 是 $k=16$。因此，$g=3$ 的阶是 $16$。\n$\\operatorname{ord}(3) = 16$。\n由于 $g=3$ 的阶等于群 $\\mathbb{F}_{17}^{\\times}$ 的阶，所以 $g=3$ 是这个群的一个生成元（或原根）。由 $g$ 生成的子群 $\\langle g \\rangle$ 就是整个群 $\\mathbb{F}_{17}^{\\times}$。\n\n**2) 计算剩余和离散对数**\n\n我们计算当 $k=0, 1, \\dots, 15$ 时 $g^k \\pmod{p}$ 的值。\n$3^0 \\equiv 1 \\pmod{17}$\n$3^1 \\equiv 3 \\pmod{17}$\n$3^2 \\equiv 9 \\pmod{17}$\n$3^3 \\equiv 9 \\cdot 3 = 27 \\equiv 10 \\pmod{17}$\n$3^4 \\equiv 10 \\cdot 3 = 30 \\equiv 13 \\pmod{17}$\n$3^5 \\equiv 13 \\cdot 3 = 39 \\equiv 5 \\pmod{17}$\n$3^6 \\equiv 5 \\cdot 3 = 15 \\pmod{17}$\n$3^7 \\equiv 15 \\cdot 3 = 45 \\equiv 11 \\pmod{17}$\n$3^8 \\equiv 11 \\cdot 3 = 33 \\equiv 16 \\pmod{17}$\n$3^9 \\equiv 16 \\cdot 3 = 48 \\equiv 14 \\pmod{17}$\n$3^{10} \\equiv 14 \\cdot 3 = 42 \\equiv 8 \\pmod{17}$\n$3^{11} \\equiv 8 \\cdot 3 = 24 \\equiv 7 \\pmod{17}$\n$3^{12} \\equiv 7 \\cdot 3 = 21 \\equiv 4 \\pmod{17}$\n$3^{13} \\equiv 4 \\cdot 3 = 12 \\pmod{17}$\n$3^{14} \\equiv 12 \\cdot 3 = 36 \\equiv 2 \\pmod{17}$\n$3^{15} \\equiv 2 \\cdot 3 = 6 \\pmod{17}$\n\n通过反转这张表，我们得到每个元素 $y \\in \\mathbb{F}_{17}^{\\times}$ 的离散对数 $\\log_3(y)$：\n$\\log_3(1) = 0$\n$\\log_3(2) = 14$\n$\\log_3(3) = 1$\n$\\log_3(4) = 12$\n$\\log_3(5) = 5$\n$\\log_3(6) = 15$\n$\\log_3(7) = 11$\n$\\log_3(8) = 10$\n$\\log_3(9) = 2$\n$\\log_3(10) = 3$\n$\\log_3(11) = 7$\n$\\log_3(12) = 13$\n$\\log_3(13) = 4$\n$\\log_3(14) = 9$\n$\\log_3(15) = 6$\n$\\log_3(16) = 8$\n\n问题要求 $\\log_3(7)$ 的值。根据我们的直接计算，我们看到 $3^{11} \\equiv 7 \\pmod{17}$。因此，$\\log_3(7) = 11$。这个值在要求的范围 $\\{0, 1, \\dots, 15\\}$ 内。\n\n**3) 证明离散对数在模 $\\operatorname{ord}(g)$ 意义下的唯一性**\n\n我们的任务是证明如果 $g^a \\equiv g^b \\pmod{p}$，那么 $\\operatorname{ord}(g)$ 整除 $a-b$。\n\n令 $k = \\operatorname{ord}(g)$。根据定义，$k$ 是使 $g^k \\equiv 1 \\pmod{p}$ 成立的最小正整数。\n假设 $g^a \\equiv g^b \\pmod{p}$。不失一般性，设 $a \\ge b$。\n由于 $g \\in \\mathbb{F}_{p}^{\\times}$，所以 $g$ 的任意次幂在群中都有乘法逆元。我们可以在同余式两边同乘以 $(g^b)^{-1}$，即 $g^{-b}$。\n$$g^a \\cdot g^{-b} \\equiv g^b \\cdot g^{-b} \\pmod{p}$$\n$$g^{a-b} \\equiv g^{0} \\pmod{p}$$\n$$g^{a-b} \\equiv 1 \\pmod{p}$$\n令 $m = a-b$。我们有 $g^m \\equiv 1 \\pmod{p}$。根据带余除法，我们可以将 $m$ 写成关于 $k$ 的形式 $m = qk + r$，其中 $q$ 是一个整数，$r$ 是余数，满足 $0 \\le r  k$。\n将此 $m$ 的表达式代入同余式中：\n$$g^{qk+r} \\equiv 1 \\pmod{p}$$\n$$(g^k)^q \\cdot g^r \\equiv 1 \\pmod{p}$$\n根据阶 $k$ 的定义，我们有 $g^k \\equiv 1 \\pmod{p}$。代入得：\n$$(1)^q \\cdot g^r \\equiv 1 \\pmod{p}$$\n$$g^r \\equiv 1 \\pmod{p}$$\n我们现在有 $g^r \\equiv 1 \\pmod{p}$，其中 $0 \\le r  k$。然而，$k=\\operatorname{ord}(g)$ 被定义为使 $g$ 的幂同余于 $1$ 的*最小正*整数。要使 $g^r \\equiv 1 \\pmod{p}$ 不与 $k$ 的最小性相矛盾，唯一的方法是 $r$ 不是一个正整数，即 $r=0$。\n因此，余数 $r$ 必须为 $0$。\n这意味着 $m = qk$，也就是说 $k$ 整除 $m$。\n代回 $k=\\operatorname{ord}(g)$ 和 $m=a-b$，我们证明了 $\\operatorname{ord}(g)$ 整除 $a-b$。证明完毕。\n\n这个结果证实了离散对数在模 $\\operatorname{ord}(g)$ 意义下是良定义的。如果 $k_1$ 和 $k_2$ 是两个整数，使得 $g^{k_1} \\equiv y \\pmod{p}$ 且 $g^{k_2} \\equiv y \\pmod{p}$，那么 $g^{k_1} \\equiv g^{k_2} \\pmod{p}$。根据我们的证明，$\\operatorname{ord}(g)$ 必须整除 $k_1 - k_2$，这意味着 $k_1 \\equiv k_2 \\pmod{\\operatorname{ord}(g)}$。因此，在集合 $\\{0, 1, \\dots, \\operatorname{ord}(g)-1\\}$ 中，离散对数存在唯一解。\n\n基于这些步骤，$\\mathbb{F}_{17}^{\\times}$ 中 $\\log_{3}(7)$ 的值为 $11$。", "answer": "$$\n\\boxed{11}\n$$", "id": "3084393"}, {"introduction": "当群的阶数变大时，逐一计算所有元素的“暴力”方法便不再可行。我们需要更巧妙的算法，而“小步大步法”（Baby-Step Giant-Step, BSGS）就是其中一个典型的例子。该算法利用时空权衡的思想，将搜索范围从 $O(n)$ 显著降低到 $O(\\sqrt{n})$，极大地提高了计算效率。通过这个练习，你将亲手实现BSGS算法的核心步骤，体验如何通过巧妙地重构问题来攻克计算上的挑战。[@problem_id:3084394]", "problem": "设 $p$ 是一个素数，考虑模 $p$ 的非零余数的乘法群，记作 $\\mathbb{F}_{p}^{\\times}$。根据费马小定理，$\\mathbb{F}_{p}^{\\times}$ 的阶是 $p-1$。给定一个生成元 $g \\in \\mathbb{F}_{p}^{\\times}$ 和一个元素 $y \\in \\mathbb{F}_{p}^{\\times}$，离散对数问题要求解出 $x \\in \\{0,1,\\dots,p-2\\}$ 使得 $g^{x} \\equiv y \\pmod{p}$，我们记作 $x = \\log_{g}(y) \\bmod (p-1)$。在此框架下，具体在素数域 $\\mathbb{F}_{p}$ 中，当 $p=101$, $g=2$, $y=37$ 时，通过完整详细地执行 Baby-Step Giant-Step (BSGS) 方法，包括构造小步（baby steps）和巨步（giant steps）以及识别碰撞，计算 $x = \\log_{2}(37) \\bmod 100$。报告满足 $0 \\leq x \\leq 99$ 的单个整数 $x$。", "solution": "问题是在有限域 $\\mathbb{F}_{101}$ 中计算离散对数 $x = \\log_{2}(37)$。这相当于找到一个在范围 $0 \\le x \\le 99$ 内的整数 $x$，满足同余式 $2^x \\equiv 37 \\pmod{101}$。我们被要求使用 Baby-Step Giant-Step (BSGS) 算法。\n\n这个群是模 $101$ 的非零余数乘法群，记作 $\\mathbb{F}_{101}^{\\times}$。该群的阶为 $n = p-1 = 101-1 = 100$。给定的生成元是 $g=2$，目标元素是 $y=37$。\n\nBSGS 算法基于将未知指数 $x$ 重写为一种新形式。令 $m = \\lceil \\sqrt{n} \\rceil = \\lceil \\sqrt{100} \\rceil = 10$。我们可以将范围 $0 \\le x  n$ 内的任何 $x$ 表示为 $x = im+j$，其中 $i$ 和 $j$ 是满足 $0 \\le i  m$ 和 $0 \\le j  m$ 的整数。\n\n将此代入原始同余式得到：\n$$g^{im+j} \\equiv y \\pmod{p}$$\n这可以被重新整理以找到一个“碰撞”：\n$$g^j \\equiv y \\cdot g^{-im} \\pmod{p}$$\n$$g^j \\equiv y \\cdot (g^{-m})^i \\pmod{p}$$\n\n该算法分两个主要阶段进行：\n\n**1. 小步 (Baby Steps)**\n我们计算碰撞方程的左侧 $g^j \\pmod{p}$，其中 $j$ 的所有可能取值为 $j \\in \\{0, 1, \\dots, m-1\\}$。我们将这些值及其对应的指数存储在一个查找表中。这里，$g=2$, $p=101$, $m=10$，所以我们计算 $j=0, 1, \\dots, 9$ 时的 $2^j \\pmod{101}$。\n\n小步计算如下：\n- $j=0$: $2^0 \\equiv 1 \\pmod{101}$\n- $j=1$: $2^1 \\equiv 2 \\pmod{101}$\n- $j=2$: $2^2 \\equiv 4 \\pmod{101}$\n- $j=3$: $2^3 \\equiv 8 \\pmod{101}$\n- $j=4$: $2^4 \\equiv 16 \\pmod{101}$\n- $j=5$: $2^5 \\equiv 32 \\pmod{101}$\n- $j=6$: $2^6 \\equiv 64 \\pmod{101}$\n- $j=7$: $2^7 = 128 \\equiv 27 \\pmod{101}$\n- $j=8$: $2^8 = 2 \\cdot 27 \\equiv 54 \\pmod{101}$\n- $j=9$: $2^9 = 2 \\cdot 54 = 108 \\equiv 7 \\pmod{101}$\n\n查找表（将值映射到指数 $j$）是：\n$\\{ (1, 0), (2, 1), (4, 2), (8, 3), (16, 4), (32, 5), (64, 6), (27, 7), (54, 8), (7, 9) \\}$。\n\n**2. 巨步 (Giant Steps)**\n我们从 $i=0$ 开始，为递增的 $i$ 值计算碰撞方程的右侧 $y \\cdot (g^{-m})^i \\pmod{p}$。对于每个结果，我们检查它是否存在于我们的小步表中。\n\n首先，我们需要计算“巨步”因子 $c = g^{-m} \\pmod{p}$。\n$g^m = 2^{10} \\pmod{101}$。\n$2^7 \\equiv 27 \\pmod{101}$，所以 $2^{10} = 2^7 \\cdot 2^3 \\equiv 27 \\cdot 8 = 216 \\equiv 2 \\cdot 101 + 14 \\equiv 14 \\pmod{101}$。\n所以，我们需要求 $c = 14^{-1} \\pmod{101}$。我们使用扩展欧几里得算法：\n$101 = 7 \\cdot 14 + 3$\n$14 = 4 \\cdot 3 + 2$\n$3 = 1 \\cdot 2 + 1$\n向后回代：\n$1 = 3 - 1 \\cdot 2$\n$1 = 3 - 1 \\cdot (14 - 4 \\cdot 3) = 5 \\cdot 3 - 1 \\cdot 14$\n$1 = 5 \\cdot (101 - 7 \\cdot 14) - 1 \\cdot 14 = 5 \\cdot 101 - 35 \\cdot 14 - 1 \\cdot 14 = 5 \\cdot 101 - 36 \\cdot 14$\n从 $5 \\cdot 101 - 36 \\cdot 14 = 1$ 可知，$-36 \\cdot 14 \\equiv 1 \\pmod{101}$。\n因为 $-36 \\equiv -36+101 = 65 \\pmod{101}$，我们得到 $c = 14^{-1} \\equiv 65 \\pmod{101}$。\n\n现在我们对 $i \\in \\{0, 1, \\dots, 9\\}$ 进行迭代，计算 $Z_i = y \\cdot c^i \\pmod{p}$ 并检查匹配。这里 $y=37$。\n- $i=0$: $Z_0 = 37 \\cdot 65^0 \\equiv 37 \\pmod{101}$。值 $37$ 不在小步表中。\n- $i=1$: $Z_1 = 37 \\cdot 65^1 = 2405 = 23 \\cdot 101 + 82 \\equiv 82 \\pmod{101}$。值 $82$ 不在小步表中。\n- $i=2$: $Z_2 = 82 \\cdot 65 = 5330 = 52 \\cdot 101 + 78 \\equiv 78 \\pmod{101}$。值 $78$ 不在小步表中。\n- $i=3$: $Z_3 = 78 \\cdot 65 = 5070 = 50 \\cdot 101 + 20 \\equiv 20 \\pmod{101}$。值 $20$ 不在小步表中。\n- $i=4$: $Z_4 = 20 \\cdot 65 = 1300 = 12 \\cdot 101 + 88 \\equiv 88 \\pmod{101}$。值 $88$ 不在小步表中。\n- $i=5$: $Z_5 = 88 \\cdot 65 = 5720 = 56 \\cdot 101 + 64 \\equiv 64 \\pmod{101}$。值 $64$ 在小步表中找到。\n\n**3. 碰撞与求解**\n在 $i=5$ 时发生碰撞。值为 $64$。从我们的小步表中，值 $64$ 对应的指数是 $j=6$。\n因此，我们找到了当 $i=5$ 和 $j=6$ 时满足 $g^j \\equiv y \\cdot (g^{-m})^i \\pmod{p}$。\n\n$x$ 的解由 $x = im + j$ 给出。\n$x = 5 \\cdot 10 + 6 = 56$。\n\n为了验证，我们检查 $2^{56} \\equiv 37 \\pmod{101}$ 是否成立。\n我们可以计算 $2^{56} = 2^{50} \\cdot 2^6$。\n我们已经知道 $2^{10} \\equiv 14 \\pmod{101}$。\n$2^{50} = (2^{10})^5 \\equiv 14^5 \\pmod{101}$。\n$14^2 = 196 \\equiv 95 \\equiv -6 \\pmod{101}$。\n$14^4 \\equiv (-6)^2 = 36 \\pmod{101}$。\n$14^5 = 14^4 \\cdot 14 \\equiv 36 \\cdot 14 = 504 = 4 \\cdot 101 + 100 \\equiv 100 \\equiv -1 \\pmod{101}$。\n所以，$2^{50} \\equiv -1 \\pmod{101}$。\n那么，$2^{56} = 2^{50} \\cdot 2^6 \\equiv (-1) \\cdot 64 = -64 \\equiv 37 \\pmod{101}$。\n计算正确。离散对数是 $56$。", "answer": "$$\\boxed{56}$$", "id": "3084394"}, {"introduction": "除了BSGS算法，我们还能利用群阶的数论特性来设计更高效的算法吗？Pohlig-Hellman算法给出了肯定的答案。这个强大的算法将一个大的离散对数问题，分解为在阶为群阶素因子幂的子群中的若干个小问题，最后通过中国剩余定理将结果合并，从而“分而治之”。这个练习将引导你应用Pohlig-Hellman算法的核心思想，解决一个离散对数难题，并在此过程中感受群论与数论在解决实际计算问题时是如何深度融合的。[@problem_id:3084501]", "problem": "令 $p=59$，考虑模 $p$ 的非零剩余类的乘法群，记为 $\\mathbb{F}_{p}^{\\times}$。仅使用 $\\mathbb{F}_{p}^{\\times}$ 中乘法阶的核心定义以及对于任意 $a \\in \\mathbb{F}_{p}^{\\times}$ 都有 $a^{p-1} \\equiv 1 \\pmod{p}$ 这一事实，首先确定 $g=2$ 模 $59$ 的乘法阶。然后，利用你找到的阶和素数阶循环群的基本性质，确定满足 $2^{x} \\equiv 37 \\pmod{59}$ 的最小非负整数 $x$，或者证明这样的 $x$ 不存在。将你的最终答案表示为单个最小非负整数 $x$；无需四舍五入。", "solution": "首先验证问题以确保其是适定的、有科学依据且自洽的。\n\n**1. 提取已知条件：**\n- 素数模为 $p=59$。\n- 所考虑的群是模 $59$ 的非零剩余类的乘法群，记为 $\\mathbb{F}_{59}^{\\times}$。\n- 一个已知的性质是，对于任意 $a \\in \\mathbb{F}_{59}^{\\times}$，有 $a^{p-1} \\equiv 1 \\pmod{p}$，即 $a^{58} \\equiv 1 \\pmod{59}$。\n- 离散对数的底是 $g=2$。\n- 目标值是 $37$。\n- 任务是找到满足同余式 $2^{x} \\equiv 37 \\pmod{59}$ 的最小非负整数 $x$。\n\n**2. 验证：**\n这个问题是数论中一个标准的离散对数问题。由于 $59$ 是一个素数，域 $\\mathbb{F}_{59}$ 是良定义的。群 $\\mathbb{F}_{59}^{\\times}$ 是一个阶为 $p-1=58$ 的循环群。所有概念，如乘法阶和模算术，都是抽象代数和数论的基础。该问题在数学上是合理的、客观的，并包含寻找唯一解所需的所有信息。因此，该问题被认为是有效的。\n\n**3. 解题过程：**\n这个问题包括两部分：首先，确定 $g=2$ 模 $59$ 的乘法阶；其次，利用这个阶来解决离散对数问题 $2^{x} \\equiv 37 \\pmod{59}$。\n\n**第一部分：确定 $2$ 模 $59$ 的阶**\n在有限群中，一个元素 $a$ 的阶是使 $a^k$ 等于单位元的最小正整数 $k$。在群 $\\mathbb{F}_{59}^{\\times}$ 中，单位元是 $1$。该群的阶是 $|\\mathbb{F}_{59}^{\\times}| = p-1 = 59-1 = 58$。\n根据拉格朗日定理（或题目给出的事实，即费马小定理），群中任何元素的阶都必须整除群的阶。因此，$2$ 的阶必须是 $58$ 的一个因子。$58$ 的素数分解是 $2 \\times 29$。$58$ 的正因子是 $1$、$2$、$29$ 和 $58$。我们按从小到大的顺序测试这些因子。\n\n- 对于 $k=1$：$2^1 = 2 \\not\\equiv 1 \\pmod{59}$。\n- 对于 $k=2$：$2^2 = 4 \\not\\equiv 1 \\pmod{59}$。\n- 对于 $k=29$：我们必须计算 $2^{29} \\pmod{59}$。我们可以使用二进制幂（重复平方）法。指数为 $29 = 16+8+4+1$。\n$2^1 \\equiv 2 \\pmod{59}$\n$2^2 \\equiv 4 \\pmod{59}$\n$2^4 \\equiv 16 \\pmod{59}$\n$2^8 \\equiv 16^2 = 256 \\equiv 4 \\times 59 + 20 \\equiv 20 \\pmod{59}$\n$2^{16} \\equiv 20^2 = 400 \\equiv 6 \\times 59 + 46 \\equiv 46 \\equiv -13 \\pmod{59}$\n现在，我们计算 $2^{29} = 2^{16} \\times 2^8 \\times 2^4 \\times 2^1$。\n$2^{29} \\equiv 46 \\times 20 \\times 16 \\times 2 \\pmod{59}$\n$46 \\times 20 = 920 \\equiv 15 \\times 59 + 35 \\equiv 35 \\pmod{59}$\n$35 \\times 16 = 560 \\equiv 9 \\times 59 + 29 \\equiv 29 \\pmod{59}$\n$29 \\times 2 = 58 \\equiv -1 \\pmod{59}$\n所以，$2^{29} \\equiv -1 \\pmod{59}$。因为这不等于 $1$，所以阶不是 $29$。\n\n由于阶不是 $1$、$2$ 或 $29$，唯一剩下的可能性是 $58$。\n作为检验，如果 $2^{29} \\equiv -1 \\pmod{59}$，那么 $(2^{29})^2 = 2^{58} \\equiv (-1)^2 = 1 \\pmod{59}$，这与费马小定理一致。\n$2$ 模 $59$ 的乘法阶是 $58$。这意味着 $2$ 是群 $\\mathbb{F}_{59}^{\\times}$ 的一个生成元（或原根）。\n\n**第二部分：解决离散对数问题**\n我们需要找到满足 $2^x \\equiv 37 \\pmod{59}$ 的最小非负整数 $x$。由于 $2$ 是 $\\mathbb{F}_{59}^{\\times}$ 的一个生成元，它能生成该群的所有元素，包括 $37$。因此，保证存在一个解 $x$。解在模群的阶 $58$ 的意义下是唯一的。\n\n问题建议使用阶和素数阶循环群的性质。我们群的阶 $58$ 不是素数，但其素因子是 $2$ 和 $29$。这提示我们可以使用 Pohlig-Hellman 算法，该算法将离散对数问题分解为素数阶子群中的更小问题。我们需要确定 $x$ 模 $2$ 和 $x$ 模 $29$ 的值。\n\n**求 $x \\pmod 2$：**\n我们将同余式 $2^x \\equiv 37 \\pmod{59}$ 两边都取 $\\frac{p-1}{2} = \\frac{58}{2} = 29$ 次幂。\n$$(2^x)^{29} \\equiv 37^{29} \\pmod{59}$$\n$$(2^{29})^x \\equiv 37^{29} \\pmod{59}$$\n从第一部分我们知道 $2^{29} \\equiv -1 \\pmod{59}$。所以，左边变为 $(-1)^x$。\n右边，$37^{29} \\pmod{59}$，由勒让德符号 $\\left(\\frac{37}{59}\\right)$ 决定，因为对于一个素数 $p$，有 $a^{(p-1)/2} \\equiv \\left(\\frac{a}{p}\\right) \\pmod p$。\n使用二次互反律：\n$$\\left(\\frac{37}{59}\\right) = \\left(\\frac{59}{37}\\right) (-1)^{\\frac{37-1}{2} \\frac{59-1}{2}} = \\left(\\frac{59}{37}\\right) (-1)^{18 \\cdot 29} = \\left(\\frac{59}{37}\\right)$$\n因为 $59 \\equiv 22 \\pmod{37}$，我们有 $\\left(\\frac{59}{37}\\right) = \\left(\\frac{22}{37}\\right) = \\left(\\frac{2}{37}\\right)\\left(\\frac{11}{37}\\right)$。\n对于 $\\left(\\frac{2}{37}\\right)$，因为 $37 \\equiv 5 \\pmod 8$，其值为 $-1$。\n对于 $\\left(\\frac{11}{37}\\right)$，再次使用互反律： $\\left(\\frac{11}{37}\\right) = \\left(\\frac{37}{11}\\right)(-1)^{\\frac{11-1}{2}\\frac{37-1}{2}} = \\left(\\frac{4}{11}\\right) = \\left(\\frac{2^2}{11}\\right) = 1$。\n因此，$\\left(\\frac{37}{59}\\right) = (-1)(1) = -1$。\n所以，$37^{29} \\equiv -1 \\pmod{59}$。\n我们的同余式变为 $(-1)^x \\equiv -1 \\pmod{59}$，这意味着 $x$ 必须是一个奇数。\n因此，$x \\equiv 1 \\pmod 2$。\n\n**求 $x \\pmod{29}$：**\n我们将 $2^x \\equiv 37 \\pmod{59}$ 两边都取 $\\frac{p-1}{29} = \\frac{58}{29} = 2$ 次幂。\n$$(2^x)^2 \\equiv 37^2 \\pmod{59}$$\n$$(2^2)^x \\equiv 37^2 \\pmod{59}$$\n令 $g' = 2^2 = 4$。$g'$ 的阶是 $\\frac{58}{\\text{gcd}(2, 58)} = \\frac{58}{2} = 29$。\n令 $h' = 37^2 \\pmod{59}$。$37^2 = 1369$。$1369 = 23 \\times 59 + 12$。所以 $h' \\equiv 12 \\pmod{59}$。\n我们现在求解 $(g')^x \\equiv h' \\pmod{59}$，即 $4^x \\equiv 12 \\pmod{59}$。\n这个同余式确定了 $x$ 模 $g'$ 的阶 $29$ 的值。令 $y = x \\pmod{29}$。我们需要找到 $y \\in \\{0, 1, \\dots, 28\\}$ 使得 $4^y \\equiv 12 \\pmod{59}$。\n我们可以计算 $4$ 模 $59$ 的幂：\n$4^1 \\equiv 4$\n$4^2 \\equiv 16$\n$4^3 \\equiv 64 \\equiv 5$\n...\n继续搜索会得到结果。例如：\n$4^3 \\equiv 5$\n$4^6 \\equiv 5^2 = 25$\n$4^{12} \\equiv 25^2 = 625 = 10 \\times 59 + 35 \\equiv 35$\n$4^{24} \\equiv 35^2 = 1225 = 20 \\times 59 + 45 \\equiv 45$\n$4^{25} = 4^{24} \\times 4^1 \\equiv 45 \\times 4 = 180 = 3 \\times 59 + 3 \\equiv 3$\n$4^{26} = 4^{25} \\times 4^1 \\equiv 3 \\times 4 = 12$。\n所以，我们发现 $y=26$。\n因此，$x \\equiv 26 \\pmod{29}$。\n\n**结合中国剩余定理 (CRT)：**\n我们得到关于 $x$ 的一个同余方程组：\n$$x \\equiv 1 \\pmod 2$$\n$$x \\equiv 26 \\pmod{29}$$\n从第一个同余式，有 $x = 2k+1$，其中 $k$ 是某个整数。将此代入第二个同余式：\n$$2k+1 \\equiv 26 \\pmod{29}$$\n$$2k \\equiv 25 \\pmod{29}$$\n为了解出 $k$，我们乘以 $2$ 模 $29$ 的乘法逆元。\n因为 $2 \\times 15 = 30 \\equiv 1 \\pmod{29}$，所以逆元是 $15$。\n$$15 \\times (2k) \\equiv 15 \\times 25 \\pmod{29}$$\n$$k \\equiv 375 \\pmod{29}$$\n$375 = 12 \\times 29 + 27$，所以 $k \\equiv 27 \\pmod{29}$。\n这意味着 $k$ 可以写成 $k = 29j + 27$ 的形式，其中 $j$ 是某个整数。\n将此代回 $x$ 的表达式中：\n$$x = 2(29j + 27) + 1 = 58j + 54 + 1 = 58j + 55$$\n所以，$x \\equiv 55 \\pmod{58}$。最小的非负整数解是 $x=55$。\n\n**验证：**\n我们检验 $2^{55} \\equiv 37 \\pmod{59}$ 是否成立。\n$2^{55} \\equiv 2^{58-3} \\equiv 2^{58} \\cdot 2^{-3} \\pmod{59}$。根据费马小定理，$2^{58} \\equiv 1$。\n我们需要找到 $2^{-1} \\pmod{59}$。$2z \\equiv 1 \\pmod{59} \\implies 2z \\equiv 60 \\pmod{59} \\implies z=30$。所以 $2^{-1} \\equiv 30 \\pmod{59}$。\n那么 $2^{-3} \\equiv (2^{-1})^3 \\equiv 30^3 \\pmod{59}$。\n$30^2 = 900 = 15 \\times 59 + 15 \\equiv 15 \\pmod{59}$。\n$30^3 \\equiv 30^2 \\times 30 \\equiv 15 \\times 30 = 450 = 7 \\times 59 + 37 \\equiv 37 \\pmod{59}$。\n验证成功。最小的非负整数 $x$ 是 $55$。", "answer": "$$\n\\boxed{55}\n$$", "id": "3084501"}]}