{"hands_on_practices": [{"introduction": "要掌握离散对数的概念，最直接的方法莫过于亲手计算。这个练习将通过逐一计算幂来巩固离散对数的定义，并让你验证一个元素是否为原根，从而理解解的唯一性。这是在学习更高效的算法之前，建立扎实直觉和理解的必经之路。[@problem_id:3089871]", "problem": "设 $p=43$ 是一个素数，并考虑模 $p$ 的单位乘法群 $\\mathbb{Z}_{p}^{\\times}$。设 $g=3$。模 $p$ 的离散对数 $\\log_{g}(a)$ 定义为一个整数 $x$，使得 $g^{x}\\equiv a \\pmod{p}$，并被解释为模 $g$ 在 $\\mathbb{Z}_{p}^{\\times}$ 中的阶的一个剩余类。仅使用 $\\mathbb{Z}_{p}^{\\times}$ 的定义和费马小定理（该定理指出，对于任何不能被 $p$ 整除的 $a$，有 $a^{p-1}\\equiv 1 \\pmod{p}$），通过显式地枚举 $g$ 模 $p$ 的幂，来确定满足 $0 \\le x  42$ 和 $g^{x}\\equiv 5 \\pmod{43}$ 的整数 $x$。然后，通过分析 $g$ 在 $\\mathbb{Z}_{43}^{\\times}$ 中的阶，从第一性原理出发，证明为何该解在模 $42$ 的意义下是唯一的。你的最终答案必须是 $x$ 的单个整数值。", "solution": "该问题是有效的。这是一个初等数论中的适定问题，它基于既定的数学原理和定义，并提供了所有必要的数据。\n\n问题要求找到一个在范围 $0 \\le x  42$ 内的整数 $x$，满足同余式 $g^x \\equiv 5 \\pmod{p}$，其中 $p=43$ 且 $g=3$。问题指明需要通过显式地枚举 $g$ 模 $p$ 的幂来完成。\n\n需要求解的同余式是：\n$$3^x \\equiv 5 \\pmod{43}$$\n\n我们系统地计算 $3$ 模 $43$ 的幂。\n$3^1 \\equiv 3 \\pmod{43}$\n$3^2 \\equiv 9 \\pmod{43}$\n$3^3 \\equiv 27 \\pmod{43}$\n$3^4 \\equiv 3^3 \\cdot 3 \\equiv 27 \\cdot 3 = 81 \\equiv 38 \\pmod{43}$\n$3^5 \\equiv 3^4 \\cdot 3 \\equiv 38 \\cdot 3 = 114 \\equiv 2 \\cdot 43 + 28 \\equiv 28 \\pmod{43}$\n$3^6 \\equiv 3^5 \\cdot 3 \\equiv 28 \\cdot 3 = 84 \\equiv 1 \\cdot 43 + 41 \\equiv 41 \\pmod{43}$\n$3^7 \\equiv 3^6 \\cdot 3 \\equiv 41 \\cdot 3 = 123 \\equiv 2 \\cdot 43 + 37 \\equiv 37 \\pmod{43}$\n$3^8 \\equiv 3^7 \\cdot 3 \\equiv 37 \\cdot 3 = 111 \\equiv 2 \\cdot 43 + 25 \\equiv 25 \\pmod{43}$\n$3^9 \\equiv 3^8 \\cdot 3 \\equiv 25 \\cdot 3 = 75 \\equiv 1 \\cdot 43 + 32 \\equiv 32 \\pmod{43}$\n$3^{10} \\equiv 3^9 \\cdot 3 \\equiv 32 \\cdot 3 = 96 \\equiv 2 \\cdot 43 + 10 \\equiv 10 \\pmod{43}$\n$3^{11} \\equiv 3^{10} \\cdot 3 \\equiv 10 \\cdot 3 = 30 \\pmod{43}$\n$3^{12} \\equiv 3^{11} \\cdot 3 \\equiv 30 \\cdot 3 = 90 \\equiv 2 \\cdot 43 + 4 \\equiv 4 \\pmod{43}$\n$3^{13} \\equiv 3^{12} \\cdot 3 \\equiv 4 \\cdot 3 = 12 \\pmod{43}$\n$3^{14} \\equiv 3^{13} \\cdot 3 \\equiv 12 \\cdot 3 = 36 \\pmod{43}$\n$3^{15} \\equiv 3^{14} \\cdot 3 \\equiv 36 \\cdot 3 = 108 \\equiv 2 \\cdot 43 + 22 \\equiv 22 \\pmod{43}$\n$3^{16} \\equiv 3^{15} \\cdot 3 \\equiv 22 \\cdot 3 = 66 \\equiv 1 \\cdot 43 + 23 \\equiv 23 \\pmod{43}$\n$3^{17} \\equiv 3^{16} \\cdot 3 \\equiv 23 \\cdot 3 = 69 \\equiv 1 \\cdot 43 + 26 \\equiv 26 \\pmod{43}$\n$3^{18} \\equiv 3^{17} \\cdot 3 \\equiv 26 \\cdot 3 = 78 \\equiv 1 \\cdot 43 + 35 \\equiv 35 \\pmod{43}$\n$3^{19} \\equiv 3^{18} \\cdot 3 \\equiv 35 \\cdot 3 = 105 \\equiv 2 \\cdot 43 + 19 \\equiv 19 \\pmod{43}$\n$3^{20} \\equiv 3^{19} \\cdot 3 \\equiv 19 \\cdot 3 = 57 \\equiv 1 \\cdot 43 + 14 \\equiv 14 \\pmod{43}$\n$3^{21} \\equiv 3^{20} \\cdot 3 \\equiv 14 \\cdot 3 = 42 \\equiv -1 \\pmod{43}$\n$3^{22} \\equiv 3^{21} \\cdot 3 \\equiv 42 \\cdot 3 = 126 \\equiv 2 \\cdot 43 + 40 \\equiv 40 \\pmod{43}$\n$3^{23} \\equiv 3^{22} \\cdot 3 \\equiv 40 \\cdot 3 = 120 \\equiv 2 \\cdot 43 + 34 \\equiv 34 \\pmod{43}$\n$3^{24} \\equiv 3^{23} \\cdot 3 \\equiv 34 \\cdot 3 = 102 \\equiv 2 \\cdot 43 + 16 \\equiv 16 \\pmod{43}$\n$3^{25} \\equiv 3^{24} \\cdot 3 \\equiv 16 \\cdot 3 = 48 \\equiv 1 \\cdot 43 + 5 \\equiv 5 \\pmod{43}$\n\n枚举结果表明，当 $x=25$ 时，我们有 $3^{25} \\equiv 5 \\pmod{43}$。由于 $0 \\le 25  42$，这是所求的整数解。\n\n接下来，我们必须从第一性原理出发，通过分析 $g=3$ 在乘法群 $\\mathbb{Z}_{43}^{\\times}$ 中的阶，来证明为何该解在模 $42$ 的意义下是唯一的。\n群 $\\mathbb{Z}_{p}^{\\times}$ 的阶由欧拉总计函数给出，即 $|\\mathbb{Z}_{p}^{\\times}| = \\phi(p)$。因为 $p=43$ 是一个素数，所以 $\\phi(43) = 43 - 1 = 42$。\n根据拉格朗日定理，有限群中任何元素的阶必须整除群的阶。因此，$g=3$ 在 $\\mathbb{Z}_{43}^{\\times}$ 中的阶，记为 $\\text{ord}_{43}(3)$，必须是 $42$ 的一个因子。$42$ 的因子是 $1, 2, 3, 6, 7, 14, 21, 42$。\n为了证明 $\\text{ord}_{43}(3) = 42$，我们必须证明对于 $42$ 的任何真因子 $k$，都有 $3^k \\not\\equiv 1 \\pmod{43}$。只需对最大真因子进行检查即可，这些因子可以通过将 $42$ 除以其素因子（$2, 3, 7$）得到。\n我们检查：\n1. $k = 42/2 = 21$：根据我们之前的计算，$3^{21} \\equiv 42 \\equiv -1 \\pmod{43}$。这不同余于 $1$。\n2. $k = 42/3 = 14$：根据我们之前的计算，$3^{14} \\equiv 36 \\pmod{43}$。这不同余于 $1$。\n3. $k = 42/7 = 6$：根据我们之前的计算，$3^{6} \\equiv 41 \\pmod{43}$。这不同余于 $1$。\n由于 $3$ 的阶不是 $42$ 的任何真因子，那么必然有 $\\text{ord}_{43}(3) = 42$。阶等于群的阶的元素称为原根。因此，$g=3$ 是模 $43$ 的一个原根。\n\n现在我们证明解 $x$ 在模 $42$ 意义下的唯一性。假设存在两个整数 $x_1$ 和 $x_2$ 都满足该同余式。\n$$g^{x_1} \\equiv 5 \\pmod{p} \\quad \\text{和} \\quad g^{x_2} \\equiv 5 \\pmod{p}$$\n这意味着 $g^{x_1} \\equiv g^{x_2} \\pmod{p}$。\n由于 $g \\in \\mathbb{Z}_{p}^{\\times}$，其逆元 $g^{-1}$ 存在。我们可以用 $(g^{x_2})^{-1} = g^{-x_2}$ 乘以同余式两边：\n$$g^{x_1} \\cdot g^{-x_2} \\equiv g^{x_2} \\cdot g^{-x_2} \\pmod{p}$$\n$$g^{x_1 - x_2} \\equiv g^0 \\equiv 1 \\pmod{p}$$\n根据元素阶的定义，如果 $g^k \\equiv 1 \\pmod{p}$，那么 $g$ 的阶必须整除 $k$。在我们的例子中，这意味着 $\\text{ord}_p(g)$ 必须整除 $x_1 - x_2$。\n我们已经确定 $\\text{ord}_{43}(3) = 42$。因此，$42$ 必须整除 $x_1 - x_2$。\n这正是模 $42$ 同余的定义：\n$$x_1 \\equiv x_2 \\pmod{42}$$\n这表明 $3^x \\equiv 5 \\pmod{43}$ 的任何解在模 $42$ 意义下是唯一的。问题要求解在特定区间 $0 \\le x  42$ 内。由于从 $0$ 到 $41$ 的整数构成一个模 $42$ 的完全剩余系，在这个区间内只能有一个解。我们计算出的值 $x=25$ 就是那个唯一的解。", "answer": "$$\n\\boxed{25}\n$$", "id": "3089871"}, {"introduction": "对于较大的素数模$p$，暴力搜索很快变得不切实际。大步小步（Baby-Step Giant-Step, BSGS）算法是一种经典的“中间相遇”时空权衡策略，它能显著提高计算效率。该练习将引导你应用BSGS算法，通过将搜索空间分解为一系列“小步”和“大步”，从而比简单枚举快得多地找到解。[@problem_id:3089883]", "problem": "设素数 $p=59$，$g=2$ 是模 $p$ 的一个原根。考虑在乘法群 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 中的离散对数问题：求最小的非负整数 $x \\in \\{0,1,\\dots,p-2\\}$，使得 $g^{x} \\equiv 13 \\pmod{p}$。使用大步小步法 (BSGS) 确定 $x$，然后通过直接同余计算（利用素数模幂的性质）来验证你的结果。以 $0 \\le x \\le p-2$ 范围内的单个整数形式报告你的最终答案。", "solution": "用户要求我解决离散对数问题 $2^x \\equiv 13 \\pmod{59}$。\n\n### 步骤 1：问题验证\n\n首先，我将验证所提供的问题陈述。\n\n**1.1. 提取的已知条件：**\n- 素数模数：$p=59$。\n- 基（原根）：$g=2$。\n- 目标值：$h=13$。\n- 同余式：$g^x \\equiv h \\pmod{p}$，即 $2^x \\equiv 13 \\pmod{59}$。\n- 群：模59的整数乘法群，记作 $\\left(\\mathbb{Z}/59\\mathbb{Z}\\right)^{\\times}$。该群的阶为 $n = p-1 = 59-1 = 58$。\n- 解的范围：求最小的非负整数 $x \\in \\{0, 1, \\dots, 57\\}$。\n- 指定方法：大步小步法 (BSGS) 算法。\n- 验证：需要通过直接计算来验证结果。\n\n**1.2. 根据标准进行验证：**\n- **科学依据：** 该问题是计算数论中的一个标准练习。所有概念都有明确的定义。模数 $p=59$ 是一个素数。基 $g=2$ 被声称为一个原根。为了验证这一点，我们检查 2 模 59 的阶是否为 $\\phi(59)=58$。58 的素因子是 2 和 29。我们必须检查 $2^{58/2} \\not\\equiv 1 \\pmod{59}$ 和 $2^{58/29} \\not\\equiv 1 \\pmod{59}$。\n  - $2^{58/2} = 2^{29} \\pmod{59}$。我们计算这个值：$2^6 = 64 \\equiv 5 \\pmod{59}$，所以 $2^{12} \\equiv 25 \\pmod{59}$，且 $2^{24} \\equiv 25^2 = 625 \\equiv 35 \\pmod{59}$。那么 $2^{29} = 2^{24} \\cdot 2^5 \\equiv 35 \\cdot 32 = 1120 \\equiv 58 \\equiv -1 \\pmod{59}$。因为 $2^{29} \\not\\equiv 1 \\pmod{59}$，此条件成立。\n  - $2^{58/29} = 2^2 = 4 \\not\\equiv 1 \\pmod{59}$。此条件也成立。\n  由于 2 的阶不能整除 58 的任何最大真因子，所以 2 的阶是 58。因此，$g=2$ 确实是模 59 的一个原根。\n- **适定性：** 由于 $g=2$ 是一个原根，所以在区间 $[0, p-2]$ 内存在唯一的解 $x$。BSGS 算法是一种确定性方法，保证能找到这个解。\n- **客观性：** 问题以精确的数学语言陈述，没有任何主观性。\n\n该问题是有效的，因为它是科学合理的、适定的、客观的和完整的。\n\n### 步骤 2：使用大步小步法 (BSGS) 算法求解\n\n目标是找到 $x$ 使得 $g^x \\equiv h \\pmod p$。BSGS 算法的步骤如下。\n首先，我们选择一个整数 $m = \\lceil \\sqrt{n} \\rceil$，其中 $n = p-1$ 是群的阶。\n这里，$n=58$，所以 $m = \\lceil \\sqrt{58} \\rceil = 8$。\n\n我们将 $x$ 表示为 $x = im + j$ 的形式，其中 $i$ 和 $j$ 是整数。对于这个问题，我们取 $0 \\le i, j  m$。\n同余式 $g^x \\equiv h \\pmod{p}$ 变为 $g^{im+j} \\equiv h \\pmod{p}$。\n这可以重新排列以找到一个“碰撞”：\n$g^j \\equiv h \\cdot (g^m)^{-i} \\pmod{p}$，或者等价地 $g^j \\equiv h \\cdot (g^{-m})^i \\pmod{p}$。\n\n该算法有两个主要阶段：\n1.  **小步 (Baby Steps)：** 计算 $j=0, 1, \\dots, m-1$ 时的 $g^j \\pmod{p}$，并将数对 $(j, g^j \\pmod p)$ 存储在一个查找表（例如，一个以值为键、指数为值的哈希表）中。\n2.  **大步 (Giant Steps)：** 计算 $i=0, 1, \\dots, m-1$ 时的 $h \\cdot (g^{-m})^i \\pmod{p}$。对于每个结果，检查它是否存在于小步表中作为键。如果找到匹配，我们就找到了我们的 $i$ 和 $j$。\n\n让我们执行这些步骤。\n\n**2.1. 大步的预计算**\n首先，我们需要计算 $g^{-m} \\pmod{p}$，即 $(2^8)^{-1} \\pmod{59}$。\n$2^1 = 2$\n$2^2 = 4$\n$2^3 = 8$\n$2^4 = 16$\n$2^5 = 32$\n$2^6 = 64 \\equiv 5 \\pmod{59}$\n$2^7 \\equiv 2 \\cdot 5 = 10 \\pmod{59}$\n$g^m = 2^8 \\equiv 2 \\cdot 10 = 20 \\pmod{59}$。\n\n现在我们求 20 模 59 的乘法逆元。我们使用扩展欧几里得算法。\n$59 = 2 \\cdot 20 + 19$\n$20 = 1 \\cdot 19 + 1$\n反向推导：\n$1 = 20 - 1 \\cdot 19$\n$1 = 20 - 1 \\cdot (59 - 2 \\cdot 20) = 20 - 59 + 2 \\cdot 20 = 3 \\cdot 20 - 1 \\cdot 59$\n所以，$3 \\cdot 20 \\equiv 1 \\pmod{59}$。20 的逆元是 3。\n因此，$g^{-m} \\equiv (2^8)^{-1} \\equiv 20^{-1} \\equiv 3 \\pmod{59}$。令 $c = g^{-m} \\equiv 3 \\pmod{59}$。\n\n**2.2. 小步**\n我们计算 $j \\in \\{0, 1, \\dots, 7\\}$ 时的 $g^j = 2^j \\pmod{59}$ 并存储它们。\n$j=0: 2^0 \\equiv 1 \\pmod{59}$\n$j=1: 2^1 \\equiv 2 \\pmod{59}$\n$j=2: 2^2 \\equiv 4 \\pmod{59}$\n$j=3: 2^3 \\equiv 8 \\pmod{59}$\n$j=4: 2^4 \\equiv 16 \\pmod{59}$\n$j=5: 2^5 \\equiv 32 \\pmod{59}$\n$j=6: 2^6 \\equiv 64 \\equiv 5 \\pmod{59}$\n$j=7: 2^7 \\equiv 10 \\pmod{59}$\n\n我们创建一个将值映射到指数 $j$ 的查找表：\n$T = \\{ (1 \\to 0), (2 \\to 1), (4 \\to 2), (8 \\to 3), (16 \\to 4), (32 \\to 5), (5 \\to 6), (10 \\to 7) \\}$。\n\n**2.3. 大步**\n我们计算 $i \\in \\{0, 1, \\dots, 7\\}$ 时的 $y_i = h \\cdot c^i \\pmod{59}$，并在 $T$ 中检查匹配。这里 $h=13$ 且 $c=3$。\n$i=0: y_0 = 13 \\cdot 3^0 \\equiv 13 \\pmod{59}$。$13$ 是否在 $T$ 的值中？否。\n$i=1: y_1 = 13 \\cdot 3^1 \\equiv 39 \\pmod{59}$。$39$ 是否在 $T$ 中？否。\n$i=2: y_2 = 13 \\cdot 3^2 = 13 \\cdot 9 = 117 \\equiv 58 \\pmod{59}$。$58$ 是否在 $T$ 中？否。\n$i=3: y_3 = 58 \\cdot 3 \\equiv (-1) \\cdot 3 = -3 \\equiv 56 \\pmod{59}$。$56$ 是否在 $T$ 中？否。\n$i=4: y_4 = 56 \\cdot 3 = 168 = 2 \\cdot 59 + 50 \\equiv 50 \\pmod{59}$。$50$ 是否在 $T$ 中？否。\n$i=5: y_5 = 50 \\cdot 3 = 150 = 2 \\cdot 59 + 32 \\equiv 32 \\pmod{59}$。$32$ 是否在 $T$ 中？是。\n\n**2.4. 碰撞与求解**\n在 $i=5$ 时发生碰撞。值为 $32$。从小步表 $T$ 中，值 $32$ 对应的指数是 $j=5$。\n因此，我们找到了匹配 $i=5$ 和 $j=5$。\n$x$ 的解由 $x = im + j$ 给出。\n$x = 5 \\cdot 8 + 5 = 40 + 5 = 45$。\n使得 $2^x \\equiv 13 \\pmod{59}$ 的最小非负整数 $x$ 是 $45$。\n\n### 步骤 3：验证\n\n我们必须通过直接计算 $2^{45} \\pmod{59}$ 来验证此结果。我们可以使用重复平方（二进制幂）的方法。45 的二进制表示是 $32+8+4+1$。\n$2^{45} = 2^{32} \\cdot 2^8 \\cdot 2^4 \\cdot 2^1$。\n- $2^1 \\equiv 2 \\pmod{59}$\n- $2^2 \\equiv 4 \\pmod{59}$\n- $2^4 \\equiv 16 \\pmod{59}$\n- $2^8 \\equiv (2^4)^2 \\equiv 16^2 = 256$。$256 = 4 \\cdot 59 + 20 \\implies 2^8 \\equiv 20 \\pmod{59}$。\n- $2^{16} \\equiv (2^8)^2 \\equiv 20^2 = 400$。$400 = 6 \\cdot 59 + 46 \\implies 2^{16} \\equiv 46 \\pmod{59}$。\n- $2^{32} \\equiv (2^{16})^2 \\equiv 46^2 = 2116$。$2116 = 35 \\cdot 59 + 51 \\implies 2^{32} \\equiv 51 \\pmod{59}$。\n\n现在，我们组合这些项：\n$2^{45} \\equiv 2^{32} \\cdot 2^8 \\cdot 2^4 \\cdot 2^1 \\pmod{59}$\n$2^{45} \\equiv 51 \\cdot 20 \\cdot 16 \\cdot 2 \\pmod{59}$\n$51 \\cdot 20 = 1020$。$1020 = 17 \\cdot 59 + 17 \\implies 51 \\cdot 20 \\equiv 17 \\pmod{59}$。\n$17 \\cdot 16 = 272$。$272 = 4 \\cdot 59 + 36 \\implies 17 \\cdot 16 \\equiv 36 \\pmod{59}$。\n$36 \\cdot 2 = 72 \\equiv 13 \\pmod{59}$。\n\n最终结果是 $2^{45} \\equiv 13 \\pmod{59}$，这证实了我们的解 $x=45$ 是正确的。它位于要求的范围 $0 \\le 45 \\le 57$ 内。", "answer": "$$\\boxed{45}$$", "id": "3089883"}, {"introduction": "某些算法能够利用群阶的数学结构来获得更高的效率，Pohlig-Hellman算法便是典型。当群的阶$p-1$可以分解为小的素因子时，该算法尤为强大。这个练习将展示如何将一个大的离散对数问题分解为几个更小、更易于管理的问题，然后使用中国剩余定理（Chinese Remainder Theorem）重新组合出最终答案，这体现了一种强大的“分而治之”思想。[@problem_id:3089854]", "problem": "设素数 $p=191$，考虑乘法群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$，这是一个阶为 $p-1$ 的循环群。令 $m=p-1=190$，其素数分解为 $190=2\\cdot 5\\cdot 19$。取底数 $g=21\\in(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$ 和目标 $h=83\\in(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$。使用 Pohlig–Hellman 算法来确定离散对数 $x\\in\\{0,1,\\dots,m-1\\}$，使得 $g^{x}\\equiv h\\pmod{p}$。在您的计算中，通过在相应的素数阶子群中求解，推导出 $x\\bmod 2$、$x\\bmod 5$ 和 $x\\bmod 19$，然后通过中国剩余定理 (CRT; Chinese Remainder Theorem) 恢复 $x\\bmod 190$。通过展示必要的幂运算和同余检验，明确验证每个分量解。最后，给出满足 $21^{x}\\equiv 83\\pmod{191}$ 且在范围 $\\{0,1,\\dots,189\\}$ 内的唯一整数 $x$。无需四舍五入；报告精确的整数值。", "solution": "用户希望我解决一个离散对数问题。\n\n### 步骤 1：提取已知条件\n- 设 $p=191$ 为一个素数。\n- 群为 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times} = (\\mathbb{Z}/191\\mathbb{Z})^{\\times}$。\n- 群的阶为 $m = p-1 = 190$。\n- 阶的素数分解为 $m = 190 = 2 \\cdot 5 \\cdot 19$。\n- 底数为 $g=21 \\in (\\mathbb{Z}/191\\mathbb{Z})^{\\times}$。\n- 目标为 $h=83 \\in (\\mathbb{Z}/191\\mathbb{Z})^{\\times}$。\n- 我们需要寻找离散对数 $x \\in \\{0, 1, \\dots, m-1\\}$，使得 $g^{x} \\equiv h \\pmod{p}$。\n- 指定的方法是 Pohlig-Hellman 算法。\n- 我们必须推导出 $x \\pmod 2$、$x \\pmod 5$ 和 $x \\pmod {19}$。\n- 我们必须使用中国剩余定理 (CRT) 恢复 $x \\pmod {190}$。\n- 我们必须明确验证每个分量解。\n- 最终答案是范围 $\\{0, 1, \\dots, 189\\}$ 内的整数 $x$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实的可靠性**：该问题设置在模算术和群论的背景下，具体涉及有限域中的离散对数。$p=191$ 是一个素数。乘法群 $(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$ 的阶确实是 $p-1=190$。素数分解 $190 = 2 \\cdot 5 \\cdot 19$ 是正确的。所有概念都是数论中的标准概念。\n2.  **适定性**：该问题要求在指定范围内找到一个唯一的整数 $x$。离散对数 $x$ 的存在性和唯一性取决于底数 $g=21$ 是否是群 $(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$ 的一个生成元。为了验证 $g=21$ 是一个生成元，我们必须对 $m=190$ 的每个素数因子 $q$ 检查 $g^{m/q} \\not\\equiv 1 \\pmod p$。素数因子是 $2$、$5$ 和 $19$。\n    - 对于 $q=2$：$g^{190/2} = 21^{95} \\pmod{191}$。勒让德符号是 $\\left(\\frac{21}{191}\\right) = \\left(\\frac{3}{191}\\right)\\left(\\frac{7}{191}\\right)$。根据二次互反律，$\\left(\\frac{3}{191}\\right) = \\left(\\frac{191}{3}\\right)(-1)^{\\frac{3-1}{2}\\frac{191-1}{2}} = \\left(\\frac{2}{3}\\right)(-1)^{95} = (-1)(-1)=1$。并且 $\\left(\\frac{7}{191}\\right) = \\left(\\frac{191}{7}\\right)(-1)^{\\frac{7-1}{2}\\frac{191-1}{2}} = \\left(\\frac{2}{7}\\right)(-1)^{285} = (1)(-1)=-1$。因此，$\\left(\\frac{21}{191}\\right) = (1)(-1)=-1$。这意味着 $21^{95} \\equiv -1 \\pmod{191}$，不等于 $1$。\n    - 对于 $q=5$：$g^{190/5} = 21^{38} \\pmod{191}$。详细计算表明 $21^{38} \\equiv 184 \\pmod{191}$，不等于 $1$。\n    - 对于 $q=19$：$g^{190/19} = 21^{10} \\pmod{191}$。详细计算表明 $21^{10} \\equiv 30 \\pmod{191}$，不等于 $1$。\n    由于这些幂次都不与 $1$ 同余，所以 $g=21$ 是 $(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$ 的一个生成元。因此，在范围 $\\{0, \\dots, 189\\}$ 内存在一个唯一的解 $x$。问题是适定的。\n3.  **客观性**：该问题用精确的数学语言陈述，没有歧义或主观内容。\n\n所有其他验证标准均已满足。问题是完整的、一致的，并且在数学上是合理的。\n\n### 步骤 3：结论与行动\n问题是有效的。我将继续进行求解。\n\n我们要求解 $21^x \\equiv 83 \\pmod{191}$。该群的阶为 $m=190=2\\cdot 5 \\cdot 19$。我们使用 Pohlig-Hellman 算法来找出 $x$ 模这些素数因子的值。\n\n**1. 确定 $x \\pmod 2$**\n\n设 $x = 2k_1 + x_1$，其中 $x_1 \\in \\{0, 1\\}$。我们处理方程 $g^x \\equiv h \\pmod p$。将两边都取 $m/2 = 190/2 = 95$ 次幂：\n$$ (g^x)^{95} \\equiv h^{95} \\pmod{191} $$\n左边变为：\n$$ (g^{2k_1 + x_1})^{95} = g^{190k_1} g^{95x_1} = (g^{190})^{k_1} g^{95x_1} \\equiv 1^{k_1} g^{95x_1} \\equiv (g^{95})^{x_1} \\pmod{191} $$\n所以我们需要解 $(g^{95})^{x_1} \\equiv h^{95} \\pmod{191}$。\n\n首先，我们计算必要的幂：\n- $\\gamma_1 = g^{95} = 21^{95} \\pmod{191}$。在验证过程中已经确定，$21$ 是模 $191$ 的二次非剩余，所以 $21^{(191-1)/2} = 21^{95} \\equiv -1 \\equiv 190 \\pmod{191}$。\n- $\\eta_1 = h^{95} = 83^{95} \\pmod{191}$。勒让德符号是 $\\left(\\frac{83}{191}\\right) = \\left(\\frac{191}{83}\\right)(-1)^{\\frac{83-1}{2}\\frac{191-1}{2}} = \\left(\\frac{25}{83}\\right)(-1)^{41 \\cdot 95} = (\\left(\\frac{5}{83}\\right))^2 (-1) = 1 \\cdot (-1) = -1$。所以，$83^{95} \\equiv -1 \\equiv 190 \\pmod{191}$。\n\n现在我们求解 $x_1$：\n$$ (\\gamma_1)^{x_1} \\equiv \\eta_1 \\pmod{191} $$\n$$ (-1)^{x_1} \\equiv -1 \\pmod{191} $$\n这意味着 $x_1 = 1$。因此，$x \\equiv 1 \\pmod 2$。\n\n验证：我们检查 $(\\gamma_1)^{x_1} \\equiv \\eta_1 \\pmod{191}$。对于 $x_1=1$，我们有 $(-1)^1 \\equiv -1$，这是正确的，因为 $\\eta_1 \\equiv -1$。\n\n**2. 确定 $x \\pmod 5$**\n\n设 $x = 5k_2 + x_2$，其中 $x_2 \\in \\{0, 1, 2, 3, 4\\}$。将 $g^x \\equiv h \\pmod p$ 的两边都取 $m/5 = 190/5 = 38$ 次幂：\n$$ (g^{38})^{x_2} \\equiv h^{38} \\pmod{191} $$\n- $\\gamma_2 = g^{38} = 21^{38} \\pmod{191}$。\n$21^2 \\equiv 59$, $21^4 \\equiv 43$, $21^8 \\equiv 130$, $21^{16} \\equiv 92$, $21^{32} \\equiv 60$。\n$21^{38} = 21^{32} \\cdot 21^4 \\cdot 21^2 \\equiv 60 \\cdot 43 \\cdot 59 = 2580 \\cdot 59 \\equiv 97 \\cdot 59 = 5723 \\equiv 184 \\pmod{191}$。\n- $\\eta_2 = h^{38} = 83^{38} \\pmod{191}$。\n$83^2 \\equiv 13$, $83^4 \\equiv 169$, $83^8 \\equiv 102$, $83^{16} \\equiv 90$, $83^{32} \\equiv 78$。\n$83^{38} = 83^{32} \\cdot 83^4 \\cdot 83^2 \\equiv 78 \\cdot 169 \\cdot 13 = 13182 \\cdot 13 \\equiv 3 \\cdot 13 = 39 \\pmod{191}$。\n\n现在我们求解 $184^{x_2} \\equiv 39 \\pmod{191}$ 中的 $x_2$。由于 $184 \\equiv -7 \\pmod{191}$：\n- $184^0 \\equiv 1$\n- $184^1 \\equiv 184$\n- $184^2 \\equiv (-7)^2 = 49$\n- $184^3 \\equiv 49 \\cdot 184 = 49 \\cdot (-7) = -343 = -2 \\cdot 191 + 39 \\equiv 39 \\pmod{191}$\n我们得到 $x_2 = 3$。因此，$x \\equiv 3 \\pmod 5$。\n\n验证：我们检查 $(\\gamma_2)^{x_2} \\equiv \\eta_2 \\pmod{191}$。对于 $x_2=3$，我们计算出 $184^3 \\equiv 39$，这是正确的，因为 $\\eta_2 = 39$。\n\n**3. 确定 $x \\pmod{19}$**\n\n设 $x = 19k_3 + x_3$，其中 $x_3 \\in \\{0, \\dots, 18\\}$。将 $g^x \\equiv h \\pmod p$ 的两边都取 $m/19 = 190/19 = 10$ 次幂：\n$$ (g^{10})^{x_3} \\equiv h^{10} \\pmod{191} $$\n- $\\gamma_3 = g^{10} = 21^{10} \\pmod{191}$。\n$21^{10} = 21^8 \\cdot 21^2 \\equiv 130 \\cdot 59 = 7670 = 40 \\cdot 191 + 30 \\equiv 30 \\pmod{191}$。\n- $\\eta_3 = h^{10} = 83^{10} \\pmod{191}$。\n$83^{10} = 83^8 \\cdot 83^2 \\equiv 102 \\cdot 13 = 1326 = 6 \\cdot 191 + 180 \\equiv 180 \\pmod{191}$。\n\n现在我们通过试错法求解 $30^{x_3} \\equiv 180 \\pmod{191}$ 中的 $x_3$，因为阶为 $19$：\n- $30^1 \\equiv 30$\n- $30^2 \\equiv 900 \\equiv 136$\n- $30^3 \\equiv 136 \\cdot 30 = 4080 \\equiv 69$\n- $30^4 \\equiv 69 \\cdot 30 = 2070 \\equiv 160$\n- $30^5 \\equiv 160 \\cdot 30 = 4800 \\equiv 25$\n- $30^6 \\equiv 25 \\cdot 30 = 750 \\equiv 177$\n- $30^7 \\equiv 177 \\cdot 30 = 5310 \\equiv 153$\n- $30^8 \\equiv 153 \\cdot 30 = 4590 \\equiv 6$\n- $30^9 \\equiv 6 \\cdot 30 = 180 \\pmod{191}$\n我们得到 $x_3 = 9$。因此，$x \\equiv 9 \\pmod{19}$。\n\n验证：我们检查 $(\\gamma_3)^{x_3} \\equiv \\eta_3 \\pmod{191}$。对于 $x_3=9$，我们计算出 $30^9 \\equiv 180$，这是正确的，因为 $\\eta_3 = 180$。\n\n**4. 使用中国剩余定理恢复 $x$**\n\n我们有以下同余方程组：\n$$ x \\equiv 1 \\pmod 2 $$\n$$ x \\equiv 3 \\pmod 5 $$\n$$ x \\equiv 9 \\pmod{19} $$\n\n从第一个同余式可知，$x = 2k+1$，其中 $k$ 为某个整数。\n将此代入第二个同余式：\n$$ 2k+1 \\equiv 3 \\pmod 5 $$\n$$ 2k \\equiv 2 \\pmod 5 $$\n乘以 $3$，即 $2$ 模 $5$ 的逆元：\n$$ k \\equiv 2 \\cdot 3 \\equiv 6 \\equiv 1 \\pmod 5 $$\n所以 $k = 5j+1$，其中 $j$ 为某个整数。我们将其代回 $x$ 的表达式中：\n$$ x = 2(5j+1) + 1 = 10j + 3 $$\n这意味着 $x \\equiv 3 \\pmod {10}$。\n\n现在我们使用第三个同余式：\n$$ 10j+3 \\equiv 9 \\pmod{19} $$\n$$ 10j \\equiv 6 \\pmod{19} $$\n乘以 $2$，即 $10$ 模 $19$ 的逆元（因为 $10 \\cdot 2 = 20 \\equiv 1 \\pmod{19}$）：\n$$ j \\equiv 6 \\cdot 2 \\equiv 12 \\pmod{19} $$\n所以 $j = 19l + 12$，其中 $l$ 为某个整数。我们将其代回 $x$ 的表达式中：\n$$ x = 10(19l+12) + 3 = 190l + 120 + 3 = 190l + 123 $$\n因此，$x \\equiv 123 \\pmod{190}$。\n\n在范围 $\\{0, 1, \\dots, 189\\}$ 内的唯一解是 $x=123$。\n\n最后的检验确认 $21^{123} \\equiv 83 \\pmod{191}$。", "answer": "$$\\boxed{123}$$", "id": "3089854"}]}