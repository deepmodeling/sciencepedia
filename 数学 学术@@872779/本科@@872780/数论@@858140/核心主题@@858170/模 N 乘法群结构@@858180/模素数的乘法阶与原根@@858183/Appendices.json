{"hands_on_practices": [{"introduction": "要掌握原根的概念，首先需要具备一项基本技能：计算一个元素模素数的乘法阶。这个练习 [@problem_id:3087619] 将引导你完成这一基本计算，它是后续识别原根并加以应用的基础。我们将利用 $p-1$ 的素数分解来系统地检验可能的阶，这是一种高效且至关重要的方法。", "problem": "设 $p$ 为一个素数，且 $a$ 为一个整数，满足 $\\gcd(a,p)=1$，其中 $\\gcd$ 表示最大公约数 (GCD)。$a$ 模 $p$ 的乘法阶，记作 $\\operatorname{ord}_{p}(a)$，定义为满足 $a^{k} \\equiv 1 \\pmod{p}$ 的最小正整数 $k$。根据费马小定理和有限群的拉格朗日定理，有 $a^{p-1} \\equiv 1 \\pmod{p}$ 且 $\\operatorname{ord}_{p}(a)$ 整除 $p-1$。\n\n对于 $p=97$ 和 $a=5$，使用素数分解 $96=2^{5} \\cdot 3$ 来确定 $\\operatorname{ord}_{97}(5)$，方法是测试候选指数 $96$ 是否可以被其素因子约减。请明确计算必要的模 $97$ 的中间余数，以证明每一步整除性尝试的合理性，并以单个整数形式给出 $\\operatorname{ord}_{97}(5)$ 的最终值。无需四舍五入。", "solution": "该问题要求确定整数 $a=5$ 模素数 $p=97$ 的乘法阶。乘法阶记作 $\\operatorname{ord}_{p}(a)$，是满足 $a^k \\equiv 1 \\pmod{p}$ 的最小正整数 $k$。\n\n该问题的提法明确，并且有坚实的数论科学基础。给定值为 $p=97$（一个素数）和 $a=5$。条件 $\\gcd(a, p) = \\gcd(5, 97) = 1$ 得到满足。题目要求我们使用 $p-1$ 的素数分解。\n\n首先，我们建立框架。我们在整数模 $97$ 的乘法群中进行运算，该群记作 $(\\mathbb{Z}/97\\mathbb{Z})^\\times$。该群的阶为 $\\phi(97) = 97-1 = 96$。根据拉格朗日定理，该群中任何元素的阶都必须整除该群的阶。因此，$\\operatorname{ord}_{97}(5)$ 必须是 $96$ 的一个因子。\n\n$96$ 的素数分解已给出，为 $96 = 2^5 \\cdot 3$。$96$ 的因子形如 $2^i \\cdot 3^j$，其中 $0 \\leq i \\leq 5$ 且 $j \\in \\{0, 1\\}$。\n\n为了找到确切的阶，我们遵循题目所建议的标准流程。对于 $n=p-1$ 的每个不同素因子 $q$，我们计算 $a^{n/q} \\pmod{p}$。如果对于某个素因子 $q$，有 $a^{n/q} \\not\\equiv 1 \\pmod{p}$，那么整除 $n$ 的 $q$ 的最高次幂也必须整除 $a$ 的阶。\n\n令 $n = 96$。$n$ 的素因子是 $q_1=2$ 和 $q_2=3$。我们必须测试指数 $n/2 = 48$ 和 $n/3 = 32$。\n\n1.  **测试素因子 $q_2=3$**：我们计算 $5^{96/3} \\pmod{97}$，即 $5^{32} \\pmod{97}$。我们使用重复平方（二进制幂）的方法来高效地进行此计算。\n    \\begin{itemize}\n        \\item $5^1 \\equiv 5 \\pmod{97}$\n        \\item $5^2 \\equiv 25 \\pmod{97}$\n        \\item $5^4 \\equiv 25^2 = 625$。因为 $625 = 6 \\cdot 97 + 43$，所以我们有 $5^4 \\equiv 43 \\pmod{97}$。\n        \\item $5^8 \\equiv 43^2 = 1849$。因为 $1849 = 19 \\cdot 97 + 6$，所以我们有 $5^8 \\equiv 6 \\pmod{97}$。\n        \\item $5^{16} \\equiv 6^2 = 36 \\pmod{97}$。\n        \\item $5^{32} \\equiv 36^2 = 1296$。因为 $1296 = 13 \\cdot 97 + 35$，所以我们有 $5^{32} \\equiv 35 \\pmod{97}$。\n    \\end{itemize}\n    因为 $5^{32} \\equiv 35 \\not\\equiv 1 \\pmod{97}$，所以 $5$ 的阶不整除 $32$。设 $k = \\operatorname{ord}_{97}(5)$。由于 $k$ 必须整除 $96 = 3 \\cdot 32$ 但不整除 $32$，所以 $k$ 必须包含素因子 $3$。因此，$3 | \\operatorname{ord}_{97}(5)$。\n\n2.  **测试素因子 $q_1=2$**：我们计算 $5^{96/2} \\pmod{97}$，即 $5^{48} \\pmod{97}$。我们可以使用上一步的结果。\n    $$5^{48} = 5^{32+16} = 5^{32} \\cdot 5^{16} \\pmod{97}$$\n    代入我们计算出的值：\n    $$5^{48} \\equiv 35 \\cdot 36 \\pmod{97}$$\n    乘积为 $35 \\cdot 36 = 1260$。为了求模 $97$ 的余数，我们将 $1260$ 除以 $97$：\n    $$1260 = 13 \\cdot 97 - 1$$\n    因此，$1260 \\equiv -1 \\equiv 96 \\pmod{97}$。\n    所以，$5^{48} \\equiv 96 \\pmod{97}$。\n\n    因为 $5^{48} \\not\\equiv 1 \\pmod{97}$，所以 $5$ 的阶不整除 $48$。$96$ 的素数分解是 $2^5 \\cdot 3$，$48$ 的素数分解是 $2^4 \\cdot 3$。由于 $\\operatorname{ord}_{97}(5)$ 整除 $96$ 但不整除 $48$，所以整除该阶的 $2$ 的最高次幂必须是 $2^5$。因此，$2^5 | \\operatorname{ord}_{97}(5)$，即 $32 | \\operatorname{ord}_{97}(5)$。\n\n3.  **结论**：我们已经为 $\\operatorname{ord}_{97}(5)$ 推导出了两个条件：\n    \\begin{itemize}\n        \\item $3 | \\operatorname{ord}_{97}(5)$\n        \\item $32 | \\operatorname{ord}_{97}(5)$\n    \\end{itemize}\n    由于 $3$ 和 $32$ 是互素的（$\\gcd(3, 32)=1$），它们的乘积也必须整除该阶。\n    $$\\operatorname{lcm}(3, 32) = 3 \\cdot 32 = 96$$\n    所以，$96 | \\operatorname{ord}_{97}(5)$。\n\n    此外，我们从拉格朗日定理知道，$\\operatorname{ord}_{97}(5)$ 必须整除群的阶，即 $96$。\n    $$ \\operatorname{ord}_{97}(5) | 96 $$\n\n    唯一同时满足 $96 | k$ 和 $k | 96$ 的正整数 $k$ 是 $k=96$。\n    因此，$5$ 模 $97$ 的乘法阶是 $96$。这意味着 $5$ 是模 $97$ 的一个原根。", "answer": "$$\\boxed{96}$$", "id": "3087619"}, {"introduction": "在学会计算单个元素的阶之后，我们可以将视野拓宽到整个乘法群的结构。这个练习 [@problem_id:3087629] 将探讨在 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 群中，所有可能的元素阶构成了怎样的集合，并计算出每个阶对应的元素数量。通过这个过程，你将能深刻理解这些群优美的循环结构，并体会到欧拉函数 $\\phi(d)$ 在其中的关键作用。", "problem": "设 $p$ 为一个奇素数，并考虑模 $p$ 的乘法单位群，记作 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$。元素 $a \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的乘法阶是满足 $a^{k} \\equiv 1 \\pmod{p}$ 的最小正整数 $k$。一个阶为 $p-1$ 的元素称为模 $p$ 的原根。\n\n仅使用乘法阶和子群结构的基本定义，以及关于 $p$ 为素数时 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 结构的标准事实，对于 $p=29$，确定在 $(\\mathbb{Z}/29\\mathbb{Z})^{\\times}$ 中实现的所有元素阶的完整集合，并对每个这样的阶 $d$，求出恰好具有该阶的元素数量。\n\n请将您的最终答案以行矩阵的形式给出，按 $d \\in \\{1,2,4,7,14,28\\}$ 的递增顺序，列出在 $(\\mathbb{Z}/29\\mathbb{Z})^{\\times}$ 中阶为 $d$ 的元素数量。无需四舍五入。", "solution": "这个问题提法得当且科学上合理。这是一个关于素数模整数乘法群结构的初等数论标准练习题。\n\n问题要求群 $(\\mathbb{Z}/29\\mathbb{Z})^{\\times}$ 中所有元素阶的完整集合，以及每个阶对应的元素数量。\n\n首先，令 $p = 29$。所讨论的群是 $(\\mathbb{Z}/29\\mathbb{Z})^{\\times}$，它由从 $1$ 到 $28$ 的整数在模 $29$ 乘法下构成。该群的阶为 $|(\\mathbb{Z}/29\\mathbb{Z})^{\\times}| = p-1 = 29-1 = 28$。\n\n数论中的一个基本定理指出，对于任何素数 $p$，模 $p$ 的整数乘法群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 是一个循环群。因此，$(\\mathbb{Z}/29\\mathbb{Z})^{\\times}$ 是一个28阶的循环群。\n\n根据拉格朗日定理 (Lagrange's theorem)，有限群中任何元素的阶必须整除该群的阶。因此，$(\\mathbb{Z}/29\\mathbb{Z})^{\\times}$ 中元素的可能阶必须是 $28$ 的因数。通过考虑 $28$ 的素因数分解 $28 = 2^2 \\times 7^1$，可以找到其正因数。这些因数是 $1$、$2$、$4$、$7$、$14$ 和 $28$。这证实了问题中给出的阶集合 $\\{1, 2, 4, 7, 14, 28\\}$ 是所有可能元素阶的完整集合。\n\n对于一个 $n$ 阶有限循环群，一个标准结论是，对于 $n$ 的每个正因数 $d$，恰好为 $d$ 阶的元素数量由欧拉函数 $\\phi(d)$ 给出。欧拉函数 $\\phi(d)$ 计算的是小于等于给定整数 $d$ 且与 $d$ 互素的正整数的个数。\n\n我们现在必须为 $28$ 的每个因数 $d$ 计算 $\\phi(d)$。欧拉函数的相关性质如下：\n1. $\\phi(1) = 1$。\n2. 如果 $q$ 是一个素数，则 $\\phi(q) = q-1$。\n3. 如果 $q$ 是一个素数，则对于 $k \\ge 1$，有 $\\phi(q^k) = q^k - q^{k-1}$。\n4. 如果 $m$ 和 $n$ 互素，则 $\\phi(mn) = \\phi(m)\\phi(n)$。\n\n我们将这些性质应用于每个因数 $d$：\n\n对于 $d=1$：\n阶为 $1$ 的元素数量是 $\\phi(1) = 1$。这对应于单位元 $1$，因为 $1^1 \\equiv 1 \\pmod{29}$。\n\n对于 $d=2$：\n阶为 $2$ 的元素数量是 $\\phi(2) = 2-1 = 1$。\n\n对于 $d=4$：\n阶为 $4$ 的元素数量是 $\\phi(4) = \\phi(2^2) = 2^2 - 2^{2-1} = 4 - 2 = 2$。\n\n对于 $d=7$：\n阶为 $7$ 的元素数量是 $\\phi(7) = 7-1 = 6$。\n\n对于 $d=14$：\n因为 $14 = 2 \\times 7$ 且 $\\gcd(2, 7) = 1$，我们有 $\\phi(14) = \\phi(2)\\phi(7) = (2-1)(7-1) = 1 \\times 6 = 6$。\n\n对于 $d=28$：\n因为 $28 = 4 \\times 7$ 且 $\\gcd(4, 7) = 1$，我们有 $\\phi(28) = \\phi(4)\\phi(7) = 2 \\times 6 = 12$。阶为 $28$ 的元素是模 $29$ 的原根。\n\n作为检验，所有可能阶的元素数量之和必须等于群中元素的总数：\n$$ \\sum_{d|28} \\phi(d) = \\phi(1) + \\phi(2) + \\phi(4) + \\phi(7) + \\phi(14) + \\phi(28) $$\n$$ = 1 + 1 + 2 + 6 + 6 + 12 = 28 $$\n这个和等于群的阶 $|(\\mathbb{Z}/29\\mathbb{Z})^{\\times}| = 28$，这证实了我们计算的正确性。\n\n对于每个阶 $d \\in \\{1, 2, 4, 7, 14, 28\\}$，元素的数量分别为 $1$、$1$、$2$、$6$、$6$ 和 $12$。问题要求将这些值排列成一个行矩阵。", "answer": "$$ \\boxed{\\begin{pmatrix} 1  1  2  6  6  12 \\end{pmatrix}} $$", "id": "3087629"}, {"introduction": "现在，我们将应用关于原根的知识来解决具体而复杂的同余方程。这个问题 [@problem_id:3087625] 完美展示了原根和离散对数的威力，它能将一个形如 $x^k \\equiv a \\pmod{p}$ 的高次同余方程，转化为一个关于指数的线性同余方程。这项将非线性问题线性化的技术，不仅是解决数论难题的有力工具，也是现代密码学等应用领域的理论基石之一。", "problem": "设素数 $p=47$，$g$ 为模 $p$ 的一个原根。乘法群 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 的阶为 $p-1$，且是循环群，因此每个非零的模 $p$ 余数都可以唯一地写成 $g$ 的幂。利用以 $g$ 为底的离散对数，求满足 $x^{9} \\equiv 17 \\pmod{p}$ 的模 $p$ 最小正余数 $x$。你的解法必须从乘法阶和原根的核心定义出发，证明将原同余方程简化为指数上的线性同余方程是合理的，然后明确计算离散对数和必要的模逆元以求得 $x$。将最终答案表示为模 $47$ 的最小正余数。无需四舍五入。", "solution": "本题要求解满足同余式 $x^{9} \\equiv 17 \\pmod{p}$ 的最小正余数 $x$，其中 $p=47$。此问题根植于有限循环群和离散对数理论。该问题陈述本身逻辑自洽、提法得当，在数论中具有坚实的科学基础，因此是有效的。\n\n模素数 $p$ 的整数乘法群，记为 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$，由模 $p$ 乘法下的余数类 $\\{1, 2, \\dots, p-1\\}$ 构成。该群是循环群，其阶为 $\\phi(p) = p-1$。对于给定的素数 $p=47$，群 $(\\mathbb{Z}/47\\mathbb{Z})^{\\times}$ 的阶为 $47-1=46$。\n\n因为该群是循环群，所以存在一个生成元，称为原根，记为 $g$。$(\\mathbb{Z}/47\\mathbb{Z})^{\\times}$ 中的每个元素 $a$ 都可以唯一地表示为 $g$ 的幂，使得 $a \\equiv g^k \\pmod{47}$，其中整数 $k$ 的范围为 $0 \\le k  46$。该整数 $k$ 称为 $a$ 以 $g$ 为底的离散对数或指标，记为 $k = \\text{ind}_g(a)$。\n\n我们要求解 $x^9 \\equiv 17 \\pmod{47}$。设 $x \\equiv g^k \\pmod{47}$ 且 $17 \\equiv g^m \\pmod{47}$，其中 $k=\\text{ind}_g(x)$ 且 $m=\\text{ind}_g(17)$。将这些代入同余式中得到：\n$$ (g^k)^9 \\equiv g^m \\pmod{47} $$\n$$ g^{9k} \\equiv g^m \\pmod{47} $$\n因为 $g$ 是一个原根，它的阶是 $p-1=46$。因此，上述同余式等价于一个模 $46$ 的指数线性同余方程：\n$$ 9k \\equiv m \\pmod{46} $$\n为了解出 $x$，我们必须首先找到一个模 $47$ 的原根 $g$，然后找到指标 $m = \\text{ind}_g(17)$，解出 $k$，最后计算 $x \\equiv g^k \\pmod{47}$。$x$ 的解的个数由 $\\gcd(9, p-1) = \\gcd(9, 46)$ 给出。因为 $9=3^2$ 且 $46=2 \\cdot 23$，所以 $\\gcd(9, 46)=1$。这保证了 $x$ 在模 $47$ 下有唯一解。\n\n首先，我们找一个模 $47$ 的原根。一个整数 $g$ 是模 $47$ 的原根，如果它的阶是 $\\phi(47)=46$。这要求 $g^{46} \\equiv 1 \\pmod{47}$ 并且对于 $46$ 的所有不同素因子 $q$，都有 $g^{46/q} \\not\\equiv 1 \\pmod{47}$。$46$ 的素因子是 $2$ 和 $23$。因此，我们需要找到一个 $g$，使得 $g^{2} \\not\\equiv 1 \\pmod{47}$ 且 $g^{23} \\not\\equiv 1 \\pmod{47}$。\n我们来测试 $g=5$：\n$$ 5^2 = 25 \\not\\equiv 1 \\pmod{47} $$\n现在我们计算 $5^{23} \\pmod{47}$：\n$$ 5^2 \\equiv 25 \\pmod{47} $$\n$$ 5^4 \\equiv 25^2 = 625 = 13 \\cdot 47 + 14 \\equiv 14 \\pmod{47} $$\n$$ 5^8 \\equiv 14^2 = 196 = 4 \\cdot 47 + 8 \\equiv 8 \\pmod{47} $$\n$$ 5^{16} \\equiv 8^2 = 64 \\equiv 17 \\pmod{47} $$\n那么，$5^{23} = 5^{16} \\cdot 5^4 \\cdot 5^2 \\cdot 5^1$。\n$$ 5^{23} \\equiv 17 \\cdot 14 \\cdot 25 \\cdot 5 \\pmod{47} $$\n$$ 17 \\cdot 14 = 238 = 5 \\cdot 47 + 3 \\equiv 3 \\pmod{47} $$\n$$ 3 \\cdot 25 = 75 = 1 \\cdot 47 + 28 \\equiv 28 \\pmod{47} $$\n$$ 28 \\cdot 5 = 140 = 2 \\cdot 47 + 46 \\equiv 46 \\equiv -1 \\pmod{47} $$\n因为 $5^{23} \\equiv -1 \\not\\equiv 1 \\pmod{47}$ 且 $5^2 \\not\\equiv 1 \\pmod{47}$，所以 $g=5$ 是模 $47$ 的一个原根。\n\n接下来，我们计算 $m = \\text{ind}_5(17)$。根据我们之前的计算，我们发现：\n$$ 5^{16} \\equiv 17 \\pmod{47} $$\n因此，$m = \\text{ind}_5(17) = 16$。\n\n现在我们解线性同余方程 $9k \\equiv m \\pmod{46}$：\n$$ 9k \\equiv 16 \\pmod{46} $$\n为了解出 $k$，我们必须求出 $9$ 模 $46$ 的乘法逆元。我们使用扩展欧几里得算法：\n$$ 46 = 5 \\cdot 9 + 1 $$\n重新整理该方程得到 $1 = 46 - 5 \\cdot 9$。将此式模 $46$，我们得到：\n$$ 1 \\equiv -5 \\cdot 9 \\pmod{46} $$\n所以，$9$ 的逆元是 $-5$，即 $-5 \\equiv 41 \\pmod{46}$。\n将关于 $k$ 的同余方程两边乘以 $41$：\n$$ k \\equiv 16 \\cdot 41 \\pmod{46} $$\n$$ k \\equiv 656 \\pmod{46} $$\n将 $656$ 化简模 $46$：\n$$ 656 = 14 \\cdot 46 + 12 $$\n$$ 656 = 644 + 12 $$\n所以，$k \\equiv 12 \\pmod{46}$。\n\n最后，我们使用 $k=\\text{ind}_5(x)=12$ 来计算 $x$。这意味着 $x \\equiv 5^{12} \\pmod{47}$。\n$$ x \\equiv 5^{12} = 5^{8+4} = 5^8 \\cdot 5^4 \\pmod{47} $$\n使用我们之前计算的 $5$ 的幂：\n$$ 5^4 \\equiv 14 \\pmod{47} $$\n$$ 5^8 \\equiv 8 \\pmod{47} $$\n代入这些值：\n$$ x \\equiv 8 \\cdot 14 \\pmod{47} $$\n$$ x \\equiv 112 \\pmod{47} $$\n将 $112$ 化简模 $47$：\n$$ 112 = 2 \\cdot 47 + 18 $$\n$$ 112 = 94 + 18 $$\n因此，$x \\equiv 18 \\pmod{47}$。\n\n满足该同余方程的最小正余数 $x$ 是 $18$。", "answer": "$$\\boxed{18}$$", "id": "3087625"}]}