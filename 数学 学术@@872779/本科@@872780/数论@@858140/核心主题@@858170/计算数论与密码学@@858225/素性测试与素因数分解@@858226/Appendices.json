{"hands_on_practices": [{"introduction": "为了真正领会现代素性测试的高效，我们首先需要理解其对立面——质因数分解的难度。本练习将带领我们实践最基础的分解算法：试除法。尽管它原理简单，但其计算量会随着数字的增大而急剧增加。通过证明并应用 $\\sqrt{n}$ 这个界限，我们将亲身体会到因数分解所涉及的计算工作量。[@problem_id:3088395]", "problem": "设 $n \\in \\mathbb{Z}_{\\geq 2}$。仅使用可除性和合数的基本定义，首先证明以下论断：如果 $n$ 是合数，则存在一个整数因数 $d$ 满足 $2 \\leq d \\leq \\sqrt{n}$ 且 $d \\mid n$。然后，设计并执行一个计算，利用此界限通过试除法来因数分解特定整数 $n = 246246$。你的过程应按递增顺序测试连续的潜在素因数，并可在找到因数时将上界更新为当前余因子的平方根。将 $246246$ 的最终素因数分解表示为按非递减顺序排列的素数的单一乘积。提供精确表达式，无需四舍五入。", "solution": "这个问题包括两部分。第一部分是关于合数因数的一个证明，第二部分是应用这个结果来因数分解一个特定的整数。我将按顺序处理每个部分。\n\n第一部分：因数界限性质的证明\n\n我们的任务是证明以下论断：如果一个整数 $n \\in \\mathbb{Z}_{\\geq 2}$ 是合数，那么存在一个 $n$ 的整数因数 $d$，使得 $2 \\leq d \\leq \\sqrt{n}$。\n\n设 $n$ 为一个合数，且 $n \\geq 2$。根据合数的定义，存在整数 $a$ 和 $b$ 使得 $n = a \\cdot b$，并满足约束条件 $1  a  n$ 和 $1  b  n$。\n\n由于 $n = a \\cdot b$，不可能同时有 $a  \\sqrt{n}$ 和 $b  \\sqrt{n}$。为了证明这一点，我们假设这两个不等式同时成立以引出矛盾。如果 $a  \\sqrt{n}$ 且 $b  \\sqrt{n}$，那么它们的乘积将满足不等式：\n$$a \\cdot b  \\sqrt{n} \\cdot \\sqrt{n}$$\n$$a \\cdot b  n$$\n这与我们的出发点 $n = a \\cdot b$ 相矛盾。因此，关于 $a  \\sqrt{n}$ 和 $b  \\sqrt{n}$ 两者同时成立的假设必定是错误的。\n\n这意味着因数 $a$ 或 $b$ 中至少有一个必须小于或等于 $\\sqrt{n}$。不失一般性，我们假设 $a \\leq b$。于是我们有：\n$$a^2 \\leq a \\cdot b = n$$\n对两边取平方根，我们得到：\n$$a \\leq \\sqrt{n}$$\n根据合数的定义，我们有条件 $1  a$。因为 $a$ 是一个整数，这等价于 $a \\geq 2$。\n\n通过选择 $d = a$，我们找到了一个满足条件 $2 \\leq d \\leq \\sqrt{n}$ 的 $n$ 的整数因数。证明到此结束。值得注意的是，此证明保证了在此范围内存在任意一个因数，而不一定是素数。然而，最小的这样的因数 $d$ 必须是素数。这是因为如果 $d$ 是合数，它将有一个因数 $d'$ 使得 $1  d'  d$，而 $d'$ 也将整除 $n$，这与 $d$ 的最小性相矛盾。这个推论是试除法算法的基础。\n\n第二部分：$n = 246246$ 的因数分解\n\n现在我们将应用上面证明的原理来找出 $n = 246246$ 的素因数分解。其过程是从 $2$ 开始，用连续的素数测试可除性，直到被分解数的平方根。当找到一个因数时，我们将其除掉，得到一个更小的余因子，然后我们将搜索的上界更新为这个新余因子的平方根。\n\n步骤 1：初始分解\n要分解的数是 $n_0 = 246246$。这个数是偶数，所以它可以被第一个素数 $p_1 = 2$ 整除。\n$$246246 = 2 \\times 123123$$\n我们剩下要分解的余因子是 $n_1 = 123123$。\n\n步骤 2：分解第一个余因子 $n_1 = 123123$\n我们搜索素因数的上界是 $\\sqrt{123123} \\approx 350.89$。我们测试接下来的素数。\n下一个素数是 $p=3$。$n_1$ 的各位数字之和是 $1+2+3+1+2+3 = 12$，可以被 $3$ 整除。因此，$n_1$ 可以被 $3$ 整除。\n$$123123 = 3 \\times 41041$$\n到目前为止的分解是 $246246 = 2 \\times 3 \\times 41041$。新的待分解余因子是 $n_2 = 41041$。\n\n步骤 3：分解第二个余因子 $n_2 = 41041$\n新的上界是 $\\sqrt{41041} \\approx 202.58$。我们从上一个成功的因数 $3$ 开始继续测试素数。$n_2$ 的各位数字之和是 $4+1+0+4+1 = 10$，不能被 $3$ 整除。这个数不以 $0$ 或 $5$ 结尾，所以不能被 $5$ 整除。我们测试下一个素数 $p=7$。\n$$41041 \\div 7 = 5863$$\n除法是整除的。所以，$p_3=7$ 是一个因数。\n现在的分解是 $246246 = 2 \\times 3 \\times 7 \\times 5863$。新的余因子是 $n_3 = 5863$。\n\n步骤 4：分解第三个余因子 $n_3 = 5863$\n新的上界是 $\\sqrt{5863} \\approx 76.57$。我们从 $7$ 开始继续测试素数。\n$5863 \\div 7$ 有余数，所以 $7$ 不是重复因数。我们测试下一个素数 $p=11$。交错数字和是 $3 - 6 + 8 - 5 = 0$。因为这个和是 $0$，所以该数可以被 $11$ 整除。\n$$5863 \\div 11 = 533$$\n所以，$p_4=11$ 是一个因数。\n现在的分解是 $246246 = 2 \\times 3 \\times 7 \\times 11 \\times 533$。新的余因子是 $n_4 = 533$。\n\n步骤 5：分解第四个余因子 $n_4 = 533$\n新的上界是 $\\sqrt{533} \\approx 23.09$。我们从 $11$ 开始测试素数。\n$533$ 不能被 $11$ 整除 (交错和 $3-3+5=5$)。我们测试下一个素数 $p=13$。\n$$533 \\div 13 = 41$$\n除法是整除的。所以，$p_5=13$ 是一个因数。\n现在的分解是 $246246 = 2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41$。新的余因子是 $n_5 = 41$。\n\n步骤 6：分解最后一个余因子 $n_5 = 41$\n新的上界是 $\\sqrt{41} \\approx 6.4$。小于此界限的素数是 $2$、$3$ 和 $5$。\n$41$ 不能被 $2$ 整除 (它是奇数)。\n$41$ 不能被 $3$ 整除 (各位数字之和为 $5$)。\n$41$ 不能被 $5$ 整除。\n因为 $41$ 没有小于或等于其平方根的素因数，所以它必定是一个素数。因此，$p_6 = 41$ 是最后一个素因数。\n\n将所有找到的素因数按非递减顺序组合，我们得到 $246246$ 的完整素因数分解。\n$246246 = 2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41$。\n快速验证：$2 \\times 3 \\times 7 = 42$。并且，$11 \\times 13 = 143$。以及 $7 \\times 11 \\times 13 = 1001$。所以，$2 \\times 3 \\times (7 \\times 11 \\times 13) \\times 41 = 6 \\times 1001 \\times 41 = 6006 \\times 41 = 246246$。结果是正确的。\n\n以非递减顺序排列的素数的单一乘积形式呈现的最终素因数分解是 $2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41$。", "answer": "$$\\boxed{2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41}$$", "id": "3088395"}, {"introduction": "从“困难”的因数分解问题转向“简单”的素性测试问题，我们来了解 Miller-Rabin 测试。这是一种强大的概率性方法，它克服了费马测试等更简单测试的弱点。本练习将分步引导我们完成整个算法流程，展示它如何巧妙地利用模算术的性质来揭示合数的“马脚”。[@problem_id:3088381]", "problem": "考虑奇合数 $n=341$ 和底数 $a=2$。米勒-拉宾强伪素数测试的步骤是：将 $n-1$ 写成 $2^{r}d$ 的形式（其中 $d$ 为奇数），计算模幂 $x_{0}\\equiv a^{d} \\pmod{n}$，然后构成平方链 $x_{j+1}\\equiv x_{j}^{2}\\pmod{n}$，其中 $j=0,1,\\dots,r-1$。在此框架下，当某个 $j\\geq 1$ 使得 $x_{j}\\equiv 1 \\pmod{n}$ 而 $x_{j-1}\\not\\equiv \\pm 1 \\pmod{n}$ 时，就出现了见证其合数性质的一步，这揭示了模 $n$ 下 $1$ 的一个非平凡平方根。使用模算术、幂运算和 $n-1$ 分解的定义，对给定的 $n$ 和 $a$ 执行一次完整的米勒-拉宾迭代：确定 $r$ 和 $d$，计算 $x_0$ 以及后续直到 $j=r$ 的 $x_j$ 值，找出最早见证其合数性质的步骤，然后利用最大公约数 (GCD) 从该步骤中提取 $n$ 的一个非平凡因子。\n\n将与第一个见证步骤相关的 $\\gcd\\!\\big(x_{j-1}-1,n\\big)$ 的精确整数值作为你的最终答案。不要四舍五入；请以精确整数形式表示你的答案。", "solution": "问题陈述是米勒-拉宾素性检验的一个有效应用，该检验是数论中一个明确定义的算法。所有必要的数据（$n=341$，$a=2$）和定义均已提供，问题是自洽、客观且科学上合理的。我们可以开始解题。\n\n目标是对整数 $n=341$ 和底数 $a=2$ 执行一次米勒-拉宾测试迭代，找出证明其合数性质的步骤，并利用该信息找到一个非平凡因子。\n\n首先，我们必须将 $n-1$ 分解为 $2^r d$ 的形式，其中 $d$ 是一个奇数。\n给定 $n=341$，我们有 $n-1 = 340$。\n我们从 $340$ 中分解出 $2$ 的幂次：\n$$340 = 10 \\times 34 = (2 \\times 5) \\times (2 \\times 17) = 4 \\times 85 = 2^2 \\times 85$$\n在这里，$d=85$ 是奇数。因此，我们确定 $r=2$ 和 $d=85$。\n\n米勒-拉宾测试序列由 $x_0 \\equiv a^d \\pmod{n}$ 和 $x_{j+1} \\equiv x_j^2 \\pmod{n}$ 定义，其中 $j=0, 1, \\dots, r-1$。\n\n我们首先计算 $x_0$：\n$$x_0 \\equiv a^d \\pmod{n} \\equiv 2^{85} \\pmod{341}$$\n为了高效地计算这个模幂，我们使用二进制幂（也称为快速幂或重复平方法）。指数 $d=85$ 的二进制表示是 $1010101_2$，对应于 $2$ 的幂次之和：$85 = 64 + 16 + 4 + 1$。\n我们计算 $2$ 的各次幂模 $341$ 的值：\n\\begin{align*} 2^1 \\equiv 2 \\pmod{341} \\\\ 2^2 \\equiv 4 \\pmod{341} \\\\ 2^4 \\equiv 4^2 \\equiv 16 \\pmod{341} \\\\ 2^8 \\equiv 16^2 \\equiv 256 \\pmod{341} \\\\ 2^{16} \\equiv 256^2 = 65536 \\pmod{341} \\end{align*}\n为了简化 $65536$，我们将其除以 $341$：$65536 = 192 \\times 341 + 4$。所以，$2^{16} \\equiv 4 \\pmod{341}$。\n\\begin{align*} 2^{32} \\equiv 4^2 \\equiv 16 \\pmod{341} \\\\ 2^{64} \\equiv 16^2 \\equiv 256 \\pmod{341} \\end{align*}\n现在，我们结合这些结果来计算 $2^{85}$：\n$$2^{85} = 2^{64} \\cdot 2^{16} \\cdot 2^4 \\cdot 2^1$$\n$$x_0 \\equiv 2^{85} \\equiv 256 \\cdot 4 \\cdot 16 \\cdot 2 \\pmod{341}$$\n我们一步一步地计算这个乘积：\n$$256 \\cdot 4 = 1024$$\n将 $1024$ 除以 $341$ 得到 $1024 = 3 \\times 341 + 1$，所以 $1024 \\equiv 1 \\pmod{341}$。\n将此结果代回到 $x_0$ 的表达式中：\n$$x_0 \\equiv (1) \\cdot 16 \\cdot 2 \\equiv 32 \\pmod{341}$$\n所以，$x_0 = 32$。\n\n测试首先检查是否 $x_0 \\equiv \\pm 1 \\pmod{n}$。因为 $32 \\not\\equiv 1 \\pmod{341}$ 且 $32 \\not\\equiv -1 \\pmod{341}$（因为 $-1 \\equiv 340 \\pmod{341}$），所以测试进入下一步。\n\n接下来，我们计算序列 $x_j$，其中 $j=1, \\dots, r-1$。由于 $r=2$，我们只需要计算 $x_1$。\n$$x_1 \\equiv x_0^2 \\pmod{n} \\equiv 32^2 \\pmod{341}$$\n$$x_1 \\equiv 1024 \\pmod{341}$$\n如前所述，$1024 = 3 \\times 341 + 1$。因此：\n$$x_1 \\equiv 1 \\pmod{341}$$\n测试发现，当 $j=1$ 时，我们有 $x_1 \\equiv 1 \\pmod{341}$。见证其合数性质的条件已满足，因为 $x_1 \\equiv 1 \\pmod{n}$，而序列中的前一项 $x_{1-1}=x_0=32$ 不全等于 $\\pm 1 \\pmod{n}$。这是第一个证明 $n$ 是合数的步骤。\n\n存在这样的 $x_0$ 意味着它是模 $n$ 下 $1$ 的一个非平凡平方根。也就是说，$x_0^2 \\equiv 1 \\pmod{n}$ 但 $x_0 \\not\\equiv \\pm 1 \\pmod{n}$。这可以改写为 $x_0^2 - 1 \\equiv 0 \\pmod{n}$，或者 $(x_0 - 1)(x_0 + 1) \\equiv 0 \\pmod{n}$。\n这意味着 $n$ 整除乘积 $(x_0 - 1)(x_0 + 1)$。由于 $n$ 不整除 $x_0-1$（因为 $x_0 \\not\\equiv 1 \\pmod n$），并且 $n$ 不整除 $x_0+1$（因为 $x_0 \\not\\equiv -1 \\pmod n$），所以 $n$ 必须与 $(x_0 - 1)$ 和 $(x_0 + 1)$ 各自都共享一个非平凡因子。\n\n问题要求使用最大公约数 (GCD) 从见证步骤中提取一个非平凡因子。具体来说，我们必须计算 $\\gcd(x_{j-1}-1, n)$，其中 $j=1$ 是第一个见证步骤。\n这需要计算 $\\gcd(x_0 - 1, n)$。\n代入我们找到的值：\n$$\\gcd(32 - 1, 341) = \\gcd(31, 341)$$\n要计算这个 GCD，我们可以使用欧几里得算法。由于 $31$ 是一个素数，我们可以简单地检验 $31$ 是否是 $341$ 的因子。\n$$341 \\div 31 = 11$$\n除法是整除的。因此，$31$ 是 $341$ 的一个因子，最大公约数是 $31$。\n$$\\gcd(31, 341) = 31$$\n这就是从米勒-拉宾测试中提取出的 $n=341$ 的非平凡因子。", "answer": "$$\\boxed{31}$$", "id": "3088381"}, {"introduction": "最后，我们探讨一种截然不同且更为形式化的素性证明方法。普拉特证书（Pratt certificate）引入了计算复杂性理论中的一个概念：一个简洁且易于验证的证明。本练习将通过为一个特定素数构建并验证一个证书，来揭开这一概念的神秘面纱，从而阐明寻找因数与仅仅证明其不存在之间的深刻区别。[@problem_id:3088386]", "problem": "考虑这样一个任务：使用一个简洁的证书来证明一个给定的整数 $n$ 是素数，该证书的验证时间是关于 $\\log n$ 的多项式时间。一种经典方法是 Pratt 证书：对于一个声称的素数 $p$，提供 $p-1$ 的完全素因数分解，并且对于由此产生的因数树中的每个节点 $n$，提供一个底数 $a_{n}$，满足 $1  a_n  n$，并且 $a_n^{n-1} \\equiv 1 \\pmod n$，同时对于 $n-1$ 的每一个素因数 $q_i$，都有 $a_n^{(n-1)/q_i} \\not\\equiv 1 \\pmod n$。\n\n对于 $p=97$ 及其证书（其中 $a_{97}=5$，$a_3=2$），根据 Pratt 证书的定义，解释为什么这些数据能够证明 $97$ 是素数，并计算在完整验证过程中所有检查的模同余式中的指数之和 $S$。将 $S$ 的精确整数值作为你的最终答案。", "solution": "该问题要求解释用于素性判定的 Pratt 证书，为整数 $p=97$ 进行具体的构建和验证，并计算与验证指数相关的总和 $S$。\n\n首先，我们讨论 Pratt 证书的理论基础。目标是证明一个数 $p$ 是素数。证明的核心依赖于在模 $p$ 的整数乘法群（记为 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$）中找到一个阶为 $p-1$ 的元素。这个群的阶由欧拉$\\phi$函数 $\\phi(p)$ 给出。根据定义，$p$ 是素数当且仅当 $\\phi(p) = p-1$。该证书提供了证明 $\\phi(p) = p-1$ 所需的信息。对于一个准素数 $p$，证书提供一个见证整数 $a_p$（满足 $1  a_p  p$），以及 $p-1$ 的完全素因数分解，假设为 $p-1 = q_1^{k_1} q_2^{k_2} \\cdots q_m^{k_m}$。对于每个素因数 $q_i$，其素性的递归证书也是整个证书的一部分。见证整数 $a_p$ 必须满足两个条件：\n1. $a_p^{p-1} \\equiv 1 \\pmod{p}$\n2. 对于所有 $i \\in \\{1, 2, \\dots, m\\}$，有 $a_p^{(p-1)/q_i} \\not\\equiv 1 \\pmod{p}$\n\n要理解为什么这些条件能证明素性，设 $k$ 为 $a_p$ 在群 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 中的阶。第一个条件 $a_p^{p-1} \\equiv 1 \\pmod{p}$，根据阶的定义，意味着 $k$ 必须整除 $p-1$。假设，为了引出矛盾，$k$ 是 $p-1$ 的一个真因子，即 $k  p-1$。如果 $k$ 是一个真因子，那么整数 $(p-1)/k$ 大于 $1$，并且必然有至少一个素因数，设为 $q_j$。这意味着 $q_j$ 整除 $(p-1)/k$，这可以写成 $k$ 整除 $(p-1)/q_j$。如果 $k$ 整除 $(p-1)/q_j$，那么存在一个整数 $c$ 使得 $(p-1)/q_j = kc$。这意味着 $a_p^{(p-1)/q_j} = a_p^{kc} = (a_p^k)^c \\equiv 1^c \\equiv 1 \\pmod{p}$。然而，这个结果与证书的第二个条件直接矛盾。因此，我们最初的假设——即 $k$ 是 $p-1$ 的一个真因子——必定是错误的。剩下的唯一可能性是 $a_p$ 的阶恰好为 $k = p-1$。\n\n根据有限群论中的拉格朗日定理，有限群中任何元素的阶都必须整除该群的阶。在我们的例子中，元素 $a_p$ 的阶是 $p-1$，它必须整除群 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 的阶，即 $\\phi(p)$。因此，我们有 $(p-1) | \\phi(p)$。对于任何整数 $p  1$，已知 $\\phi(p) \\leq p-1$。在这个约束下，$(p-1)$ 整除 $\\phi(p)$ 的唯一方式是这两个值相等：$\\phi(p) = p-1$。这个等式成立当且仅当 $p$ 是一个素数。这个逻辑递归地应用于 $p-1$ 的素因数 $q_i$，一直到基本情况，即素数 $2$。\n\n此证书的验证在输入大小（即 $p$ 的比特数，为 $O(\\log p)$）的多项式时间内是可行的。证书由一棵素数树组成。这棵树的深度至多为 $O(\\log p)$，因为 $n-1$ 的任何素因数 $q$ 都小于 $n$，通常 $q \\le (n-1)/2$。树中节点的总数也是有界的，通常为 $O(\\log p)$。对于树中的每个非叶节点 $n$，验证者必须执行几项检查：\n1. 确认 $n-1$ 等于其声称的素因数的乘积。这涉及少量的乘法运算。\n2. 验证 $1 + \\omega(n-1)$ 个同余式，其中 $\\omega(n-1)$ 是 $n-1$ 的不同素因数的数量。每个同余式都是形如 $a^b \\pmod n$ 的模幂运算。使用二进制幂（重复平方）法，这可以在 $O(\\log b)$ 次大小为 $O(\\log n)$ 的数的乘法运算中计算出来。因此，单次模幂运算可以在关于 $\\log n$ 的多项式时间内完成，例如 $O((\\log n)^3)$。\n由于节点数和每个节点的检查次数都很少（关于 $\\log p$ 的多项式），并且每次检查都花费多项式时间，因此总验证时间是关于 $\\log p$ 的多项式时间。\n\n现在，我们对 $p=97$ 执行此方案。\n1. 我们构建证书树。根节点是 $p=97$。我们必须分解 $p-1 = 96$。其素因数分解为 $96 = 2^5 \\times 3^1$。不同的素因数是 $2$ 和 $3$。素数 $2$ 是一个叶节点（基本情况）。素数 $3$ 是一个非叶节点，其本身也需要证明。为了证明 $3$，我们分解 $3-1 = 2$。唯一的素因数是 $2$，是一个叶节点。因此，证书树由节点 $97$、$3$ 和 $2$ 组成。\n\n2. 我们展示并验证底数。\n对于节点 $n=97$，我们被给予底数 $a_{97}=5$。$97-1=96$ 的素因数是 $q_1=2$ 和 $q_2=3$。我们必须验证：\n- $a_{97}^{96} \\equiv 1 \\pmod{97}$：使用费马小定理，验证者可以明确检查：$5^{96} \\equiv 1 \\pmod{97}$。我们计算中间幂次：$5^2=25$, $5^4 \\equiv 43$, $5^8 \\equiv 6$, $5^{16} \\equiv 36$, $5^{32} \\equiv 35$, $5^{64} \\equiv 35^2 = 1225 \\equiv 1225 - 12 \\times 97 = 1225 - 1164 = 61 \\pmod{97}$。然后 $5^{96} = 5^{64} \\times 5^{32} \\equiv 61 \\times 35 = 2135 \\equiv 2135 - 22 \\times 97 = 2135 - 2134 = 1 \\pmod{97}$。该条件成立。\n- $a_{97}^{(97-1)/2} = 5^{48} \\not\\equiv 1 \\pmod{97}$：$5^{48} = 5^{32} \\times 5^{16} \\equiv 35 \\times 36 = 1260 \\equiv 1260 - 12 \\times 97 = 1260 - 1164 = 96 \\equiv -1 \\pmod{97}$。由于 $96 \\not\\equiv 1 \\pmod{97}$，该条件成立。\n- $a_{97}^{(97-1)/3} = 5^{32} \\not\\equiv 1 \\pmod{97}$：如上计算，$5^{32} \\equiv 35 \\pmod{97}$。由于 $35 \\not\\equiv 1 \\pmod{97}$，该条件成立。\n\n对于节点 $n=3$，我们被给予底数 $a_3=2$。$3-1=2$ 的素因数是 $q_1=2$。我们必须验证：\n- $a_3^{3-1} = 2^2 \\equiv 1 \\pmod 3$：$2^2=4 \\equiv 1 \\pmod 3$。此条件成立。\n- $a_3^{(3-1)/2} = 2^1 \\not\\equiv 1 \\pmod 3$：$2^1=2 \\not\\equiv 1 \\pmod 3$。此条件成立。\n\n3. 这些已验证数据的存在证明了 $97$ 是素数。对 $a_{97}=5$ 的检查确定了其模 $97$ 的阶恰好是 $96$。根据拉格朗日定理，这意味着 $\\phi(97)$ 是 $96$ 的倍数。由于 $\\phi(97) \\le 97-1=96$，因此必然有 $\\phi(97)=96$，这证明了 $97$ 是素数。这一推理是以 $96$ 的因数（即 $2$ 和 $3$）的素性为条件的。$2$ 的素性是不证自明的，而 $3$ 的素性则通过对节点 $n=3$ 的成功验证得到证明。对 $97$ 的验证过程不需要分解任何数；$96$ 的分解是作为证书的一部分提供的。这表明素性测试属于复杂性类 NP（非确定性多项式时间），因为一个“是”的答案（“97是素数”）可以在给定一个合适的证书（即猜测）的情况下，在多项式时间内得到验证。\n\n最后，我们计算所有模同余检查中出现的指数之和 $S$。\n对于节点 $n=97$，指数来自检查 $5^{96} \\equiv 1 \\pmod{97}$、$5^{48} \\not\\equiv 1 \\pmod{97}$ 和 $5^{32} \\not\\equiv 1 \\pmod{97}$。这些指数是 $96$、$48$ 和 $32$。\n对于节点 $n=3$，指数来自检查 $2^2 \\equiv 1 \\pmod 3$ 和 $2^1 \\not\\equiv 1 \\pmod 3$。这些指数是 $2$ 和 $1$。\n总和 $S$ 是所有这些指数的和：\n$$S = 96 + 48 + 32 + 2 + 1$$\n$$S = 176 + 3$$\n$$S = 179$$\n$S$ 的精确值是 $179$。", "answer": "$$\\boxed{179}$$", "id": "3088386"}]}