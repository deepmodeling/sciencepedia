{"hands_on_practices": [{"introduction": "本次练习旨在将 Diffie-Hellman 密钥交换的抽象理论与具体计算相结合，从而巩固您对该协议的理解。您将首先从代数上证明协议的参与双方如何能够独立计算出完全相同的共享密钥，然后通过一个具体的数值示例进行验证，亲手体验其核心机制的对称性与巧妙之处。[@problem_id:3086462]", "problem": "考虑一个素数 $p$ 的整数模 $p$ 乘法群 $G = (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$，其群运算为模 $p$ 乘法。您可以使用的基本事实是：对于素数 $p$，$G$ 是一个阶为 $p-1$ 的有限群；对于 $g \\in G$ 和 $n \\in \\mathbb{N}$，幂运算 $g^{n}$ 定义为重复应用群运算；模 $p$ 约简与乘法兼容。双方运行迪菲-赫尔曼密钥交换 (DHKE)，选择一个公开已知的基数 $g \\in G$ 以及私有指数 $a$ 和 $b$。他们公布 $A \\equiv g^{a} \\ (\\mathrm{mod}\\ p)$ 和 $B \\equiv g^{b} \\ (\\mathrm{mod}\\ p)$，然后各自使用对方的公开值和自己的私有指数计算共享密钥。\n\n仅使用群公理、群中幂运算的定义以及模算术的标准性质，首先证明为什么双方在从 $A$、$B$、$a$ 和 $b$ 计算其共享密钥时会得到 $G$ 中的同一个元素。然后，对于具体参数 $p=23$，$g=5$，$a=6$ 和 $b=15$，明确计算出 $A$ 和 $B$。最后，从每一方计算共享密钥并验证两个计算结果一致，将公共值以 $1$ 到 $p-1$ 范围内的单个整数形式给出。无需四舍五入。", "solution": "该问题陈述是有效的。这是一个初等数论和密码学中的良定问题，它植根于既定的数学原理，并包含了获得唯一解所需的所有必要信息。\n\n该问题要求分为两部分：首先，从理论上证明为什么迪菲-赫尔曼密钥交换协议会产生一个公共共享密钥；其次，通过具体计算来为一组给定的参数演示这一点。\n\n**第一部分：共享密钥的证明**\n\n设双方为参与方1和参与方2。他们在模素数 $p$ 的整数乘法群（表示为 $G = (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$）内进行操作。群运算是模 $p$ 乘法。选择一个公共基元素 $g \\in G$。参与方1选择一个私有整数指数 $a$，参与方2选择一个私有整数指数 $b$。\n\n参与方1计算其公开值 $A$ 如下：\n$$A \\equiv g^a \\pmod{p}$$\n\n参与方2计算其公开值 $B$ 如下：\n$$B \\equiv g^b \\pmod{p}$$\n\n他们交换这些公开值。然后，参与方1通过将接收到的公开值 $B$ 提升至其自己的私有指数 $a$ 次幂来计算共享密钥 $S_1$：\n$$S_1 \\equiv B^a \\pmod{p}$$\n代入 $B$ 的定义，我们得到：\n$$S_1 \\equiv (g^b)^a \\pmod{p}$$\n\n参与方2通过将接收到的公开值 $A$ 提升至其自己的私有指数 $b$ 次幂来计算共享密钥 $S_2$：\n$$S_2 \\equiv A^b \\pmod{p}$$\n代入 $A$ 的定义，我们得到：\n$$S_2 \\equiv (g^a)^b \\pmod{p}$$\n\n为证明 $S_1$ 和 $S_2$ 相同，我们必须证明 $(g^b)^a \\equiv (g^a)^b \\pmod{p}$。这依赖于任何群中幂运算的一个基本性质。设 $x$ 是群的一个元素，且 $m, n \\in \\mathbb{N}$。表达式 $x^m$ 定义为对 $x$ 重复应用群运算 $m$ 次。\n那么，$(x^m)^n$ 是元素 $x^m$ 对自身进行 $n$ 次运算：\n$$(x^m)^n = \\underbrace{(x^m) \\cdot (x^m) \\cdots (x^m)}_{n \\text{ 次}}$$\n展开每个 $x^m$：\n$$(x^m)^n = \\underbrace{(\\underbrace{x \\cdot x \\cdots x}_{m \\text{ 次}}) \\cdot (\\underbrace{x \\cdot x \\cdots x}_{m \\text{ 次}}) \\cdots (\\underbrace{x \\cdot x \\cdots x}_{m \\text{ 次}})}_{n \\text{ 个块}}$$\n因为群运算满足结合律（群公理之一），我们可以移除对块进行分组的括号。$x$ 对自身进行运算的总次数是 $m$ 和 $n$ 的乘积，即 $m \\times n$。\n因此，$(x^m)^n = x^{mn}$。\n\n将此性质应用于我们对 $S_1$ 和 $S_2$ 的表达式：\n对于 $S_1$：\n$$S_1 \\equiv (g^b)^a \\equiv g^{ba} \\pmod{p}$$\n对于 $S_2$：\n$$S_2 \\equiv (g^a)^b \\equiv g^{ab} \\pmod{p}$$\n\n由于整数乘法是可交换的，我们有 $a \\times b = b \\times a$，即 $ab = ba$。因此，指数相等，这意味着得到的群元素也相等：\n$$g^{ab} = g^{ba}$$\n由此直接得出：\n$$S_1 \\equiv g^{ba} \\equiv g^{ab} \\equiv S_2 \\pmod{p}$$\n双方通过执行各自的计算，得到了群 $G$ 中的同一个元素。这个公共元素就是他们的共享密钥。该方法的安全性依赖于在给定公开值 $g$、$p$ 和 $A=g^a \\pmod{p}$ 的情况下，确定私有指数 $a$ 的计算困难性（这就是离散对数问题）。\n\n**第二部分：具体计算**\n\n给定的参数是 $p=23$，$g=5$，$a=6$ 和 $b=15$。所有计算都在模23下进行。\n\n首先，我们计算公开值 $A$ 和 $B$。\n\n计算 $A$：\n$$A \\equiv g^a \\pmod{p} \\equiv 5^6 \\pmod{23}$$\n我们可以通过逐次平方或直接求值来计算：\n$5^1 \\equiv 5 \\pmod{23}$\n$5^2 = 25 \\equiv 2 \\pmod{23}$\n$5^3 \\equiv 5^2 \\cdot 5 \\equiv 2 \\cdot 5 = 10 \\pmod{23}$\n$5^6 = (5^3)^2 \\equiv 10^2 = 100 \\pmod{23}$\n为将 $100$ 模 $23$ 约简，我们发现 $100 = 4 \\times 23 + 8$。\n因此，$A \\equiv 8 \\pmod{23}$。参与方1的公开值是 $A=8$。\n\n计算 $B$：\n$$B \\equiv g^b \\pmod{p} \\equiv 5^{15} \\pmod{23}$$\n为提高效率，我们使用平方求幂法。指数是 $15$，其二进制表示为 $1111_2$，所以 $15 = 8 + 4 + 2 + 1$。\n$5^1 \\equiv 5 \\pmod{23}$\n$5^2 \\equiv (5^1)^2 \\equiv 5^2 = 25 \\equiv 2 \\pmod{23}$\n$5^4 \\equiv (5^2)^2 \\equiv 2^2 = 4 \\pmod{23}$\n$5^8 \\equiv (5^4)^2 \\equiv 4^2 = 16 \\pmod{23}$\n现在，我们将这些组合起来求 $5^{15}$：\n$B \\equiv 5^{15} = 5^{8+4+2+1} = 5^8 \\cdot 5^4 \\cdot 5^2 \\cdot 5^1 \\pmod{23}$\n$B \\equiv 16 \\cdot 4 \\cdot 2 \\cdot 5 \\pmod{23}$\n$16 \\cdot 4 = 64 \\equiv 2 \\times 23 + 18 \\equiv 18 \\pmod{23}$\n所以，$B \\equiv 18 \\cdot 2 \\cdot 5 \\pmod{23}$\n$18 \\cdot 2 = 36 \\equiv 1 \\times 23 + 13 \\equiv 13 \\pmod{23}$\n所以，$B \\equiv 13 \\cdot 5 \\pmod{23}$\n$13 \\cdot 5 = 65 \\equiv 2 \\times 23 + 19 \\equiv 19 \\pmod{23}$\n参与方2的公开值是 $B=19$。\n\n最后，我们从每一方的角度计算共享密钥，并验证它们是相等的。\n\n参与方1计算共享密钥 $S_1$：\n$$S_1 \\equiv B^a \\pmod{p} \\equiv 19^6 \\pmod{23}$$\n我们可以使用 $19 \\equiv -4 \\pmod{23}$ 这一事实：\n$S_1 \\equiv (-4)^6 = 4^6 \\pmod{23}$\n我们已经计算过 $4$ 的幂来求 $5^8$：\n$4^1 \\equiv 4 \\pmod{23}$\n$4^2 \\equiv 16 \\pmod{23}$\n$4^3 \\equiv 4^2 \\cdot 4 \\equiv 16 \\cdot 4 = 64 \\equiv 18 \\pmod{23}$\n$S_1 \\equiv 4^6 = (4^3)^2 \\equiv 18^2 \\pmod{23}$\n$18^2 = 324$。将 $324$ 模 $23$ 约简：$324 = 14 \\times 23 + 2$。\n$S_1 \\equiv 2 \\pmod{23}$。\n\n参与方2计算共享密钥 $S_2$：\n$$S_2 \\equiv A^b \\pmod{p} \\equiv 8^{15} \\pmod{23}$$\n同样，我们对指数 $15 = 8 + 4 + 2 + 1$ 使用平方求幂法。\n$8^1 \\equiv 8 \\pmod{23}$\n$8^2 = 64 \\equiv 18 \\pmod{23}$\n$8^4 \\equiv (8^2)^2 \\equiv 18^2 \\equiv 2 \\pmod{23}$ (来自 $S_1$ 的计算)\n$8^8 \\equiv (8^4)^2 \\equiv 2^2 = 4 \\pmod{23}$\n现在，我们将这些组合起来求 $8^{15}$：\n$S_2 \\equiv 8^{15} = 8^{8+4+2+1} = 8^8 \\cdot 8^4 \\cdot 8^2 \\cdot 8^1 \\pmod{23}$\n$S_2 \\equiv 4 \\cdot 2 \\cdot 18 \\cdot 8 \\pmod{23}$\n$4 \\cdot 2 = 8$\n$S_2 \\equiv 8 \\cdot 18 \\cdot 8 \\pmod{23}$\n$8 \\cdot 18 = 144 \\equiv 6 \\times 23 + 6 \\equiv 6 \\pmod{23}$\n$S_2 \\equiv 6 \\cdot 8 \\pmod{23}$\n$6 \\cdot 8 = 48 \\equiv 2 \\times 23 + 2 \\equiv 2 \\pmod{23}$。\n\n计算证实了双方得到了相同的共享密钥：$S_1 = 2$ 且 $S_2 = 2$。这个公共值是在所要求的 $1$ 到 $22$ 范围内的整数。\n共享密钥是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3086462"}, {"introduction": "Diffie-Hellman 协议的安全性并非绝对，而是依赖于离散对数问题 (DLP) 的计算难度。本次实践将让您扮演一名窃听者的角色，体验破解密钥交换的过程。通过在参数较小的情况下求解离散对数以获取私钥，您将深刻理解为何选择足够大的参数对于保障通信安全至关重要。[@problem_id:1363090]", "problem": "Alice 和 Bob 正在使用 Diffie-Hellman 密钥交换协议建立一个安全通信信道。他们公开约定使用素数模数 $p = 53$ 和生成元 $g = 5$。\n\nAlice 选择一个秘密私有整数 $a$，并计算她的公钥为 $A = g^a \\pmod p$。Bob 选择他的秘密私有整数 $b$，并计算他的公钥为 $B = g^b \\pmod p$。他们通过一个不安全的信道交换他们的公钥。\n\n一个窃听者截获了他们的通信，并得知他们各自的公钥是 $A = 14$ 和 $B = 41$。窃听者的目标是确定共享密钥 $S$，该密钥由 Alice 计算为 $S = B^a \\pmod p$，由 Bob 计算为 $S = A^b \\pmod p$。\n\n假设你是窃听者，请计算共享密钥 $S$ 的值。", "solution": "我们在模素数 $p=53$ 的乘法群中进行计算，其生成元为 $g=5$。根据 Diffie-Hellman 协议，公钥为 $A \\equiv g^{a} \\pmod{p}$ 和 $B \\equiv g^{b} \\pmod{p}$，共享密钥为\n$$\nS \\equiv B^{a} \\equiv A^{b} \\equiv g^{ab} \\pmod{p}.\n$$\n由于 $p$ 是素数且 $g$ 是生成元，该群的阶为 $p-1=52$，因此对于任意整数 $k$，\n$$\ng^{k} \\equiv g^{k \\bmod 52} \\pmod{53}.\n$$\n\n首先，我们通过大步小步算法恢复 $a$，使得 $5^{a} \\equiv 14 \\pmod{53}$，其中 $m=\\lceil\\sqrt{52}\\rceil=8$。\n\n小步计算 $5^{j} \\pmod{53}$，其中 $j=0,\\dots,7$：\n$$\n5^{0}\\equiv 1,\\quad 5^{1}\\equiv 5,\\quad 5^{2}\\equiv 25,\\quad 5^{3}\\equiv 19,\\quad 5^{4}\\equiv 42,\\quad 5^{5}\\equiv 51,\\quad 5^{6}\\equiv 43,\\quad 5^{7}\\equiv 3 \\pmod{53}.\n$$\n计算 $c \\equiv 5^{-m} \\pmod{53}$。首先通过连续乘法得到 $5^{8}\\equiv 15 \\pmod{53}$：\n$$\n5^{1}\\equiv 5,\\;5^{2}\\equiv 25,\\;5^{3}\\equiv 19,\\;5^{4}\\equiv 42,\\;5^{5}\\equiv 51,\\;5^{6}\\equiv 43,\\;5^{7}\\equiv 3,\\;5^{8}\\equiv 15 \\pmod{53}.\n$$\n使用扩展欧几里得算法求 $15^{-1} \\pmod{53}$：\n$$\n53=3\\cdot 15+8,\\quad 15=1\\cdot 8+7,\\quad 8=1\\cdot 7+1,\n$$\n所以\n$$\n1=8-1\\cdot 7=8-(15-1\\cdot 8)=2\\cdot 8-15=2\\cdot(53-3\\cdot 15)-15=2\\cdot 53-7\\cdot 15,\n$$\n因此 $15^{-1}\\equiv -7 \\equiv 46 \\pmod{53}$。所以 $c \\equiv 5^{-8}\\equiv 46 \\pmod{53}$。\n\n计算 $14\\cdot c^{i} \\pmod{53}$，其中 $i=0,\\dots,7$：\n$$\n\\begin{aligned}\ni=0:\\;14,\\\\\ni=1:\\;14\\cdot 46\\equiv 8,\\\\\ni=2:\\;8\\cdot 46\\equiv 50,\\\\\ni=3:\\;50\\cdot 46\\equiv 21,\\\\\ni=4:\\;21\\cdot 46\\equiv 12,\\\\\ni=5:\\;12\\cdot 46\\equiv 22,\\\\\ni=6:\\;22\\cdot 46\\equiv 5,\\\\\ni=7:\\;5\\cdot 46\\equiv 18 \\pmod{53}.\n\\end{aligned}\n$$\n与小步结果匹配：在 $i=6$ 时，我们有 $14\\cdot c^{6}\\equiv 5\\equiv 5^{1}$。因此\n$$\n14 \\equiv 5^{1+8\\cdot 6} \\equiv 5^{49} \\pmod{53},\n$$\n所以 $a \\equiv 49 \\pmod{52}$。\n\n类似地，我们恢复 $b$ 使得 $5^{b} \\equiv 41 \\pmod{53}$，使用相同的 $m=8$ 和 $c=46$。\n\n计算 $41\\cdot c^{i} \\pmod{53}$，其中 $i=0,\\dots,7$：\n$$\n\\begin{aligned}\ni=0:\\;41,\\\\\ni=1:\\;41\\cdot 46\\equiv 31,\\\\\ni=2:\\;31\\cdot 46\\equiv 48,\\\\\ni=3:\\;48\\cdot 46\\equiv 35,\\\\\ni=4:\\;35\\cdot 46\\equiv 20,\\\\\ni=5:\\;20\\cdot 46\\equiv 19,\\\\\ni=6:\\;19\\cdot 46\\equiv 26,\\\\\ni=7:\\;26\\cdot 46\\equiv 30 \\pmod{53}.\n\\end{aligned}\n$$\n与小步结果匹配：在 $i=5$ 时，我们有 $41\\cdot c^{5}\\equiv 19\\equiv 5^{3}$。因此\n$$\n41 \\equiv 5^{3+8\\cdot 5} \\equiv 5^{43} \\pmod{53},\n$$\n所以 $b \\equiv 43 \\pmod{52}$。\n\n使用 $S \\equiv g^{ab} \\pmod{53}$ 计算共享密钥，并将指数模 52 进行简化：\n$$\nab \\equiv 49\\cdot 43 \\equiv (-3)\\cdot(-9) \\equiv 27 \\pmod{52},\n$$\n因此\n$$\nS \\equiv 5^{27} \\pmod{53}.\n$$\n为了计算 $5^{27} \\pmod{53}$，从前面的幂次计算中观察到\n$$\n5^{9}\\equiv 22,\\quad 5^{10}\\equiv 4,\\quad 5^{11}\\equiv 20,\\quad 5^{12}\\equiv 47,\\quad 5^{13}\\equiv 23 \\pmod{53},\n$$\n所以\n$$\n5^{26}\\equiv (5^{13})^{2}\\equiv 23^{2}=529\\equiv 52\\equiv -1 \\pmod{53},\n$$\n因此\n$$\n5^{27}\\equiv 5^{26}\\cdot 5 \\equiv (-1)\\cdot 5 \\equiv -5 \\equiv 48 \\pmod{53}.\n$$\n因此共享密钥为 $S \\equiv 48 \\pmod{53}$。", "answer": "$$\\boxed{48}$$", "id": "1363090"}, {"introduction": "在密码学中，参数的选择是安全性的关键。本练习将揭示一个重要的安全漏洞：当 Diffie-Hellman 协议中的素数模数 $p$ 被不恰当地选择，使得 $p-1$ 的因子非常“平滑”（即仅由小的素数构成）时，系统将变得异常脆弱。通过利用这一特性，您将学会如何应用 Pohlig-Hellman 算法高效地解决离散对数问题，从而直观地认识到参数选择在密码系统设计中的决定性作用。[@problem_id:1349539]", "problem": "两位密码学实习生，Alice和Bob，正在负责审计一个遗留的安全通信系统。该系统使用Diffie-Hellman（DH）密钥交换协议在不安全的信道上建立共享密钥。\n\nDH协议的工作原理如下：\n1. Alice和Bob公开约定一个大素数模数$p$和一个模$p$的整数乘法群的生成元$g$。\n2. Alice选择一个秘密整数$a$，计算她的公钥$A = g^a \\pmod{p}$，并将$A$发送给Bob。\n3. Bob选择一个秘密整数$b$，计算他的公钥$B = g^b \\pmod{p}$，并将$B$发送给Alice。\n4. Alice计算共享密钥为$K = B^a \\pmod{p}$。\n5. Bob计算共享密钥为$K = A^b \\pmod{p}$。\n\n一个窃听者Eve可以截获公开值$p$，$g$，$A$和$B$，但无法获取秘密整数$a$或$b$。DH的安全性依赖于从$g$和$A$计算$a$的困难性（即离散对数问题）。\n\n实习生们发现，这个遗留系统配置的素数$p$满足$p-1$是2的幂。众所周知，这种选择会使系统在密码学上变得脆弱。Eve从Alice的一次会话中截获了以下公开信息：\n- 素数模数: $p = 257$\n- 生成元: $g = 3$\n- Alice的公钥: $A = 201$\n\n为了向他们的主管展示选择这个$p$值的脆弱性，你需要扮演Eve的角色，找出Alice的秘密整数密钥$a$。求出$a$的整数值，已知 $1 \\le a  p-1$。", "solution": "我们要解决离散对数问题 $3^{a} \\equiv 201 \\pmod{257}$，其中 $1 \\leq a  256$，并利用 $p-1=256=2^{8}$ 是2的幂这一特性。在阶为 $2^8$ 的模 $p$ 循环乘法群中，Pohlig–Hellman算法针对2的幂次情况的简化方法，允许我们逐位恢复$a$的比特。\n\n令$N=256=2^{8}$，并定义$g_{0}=g^{N/2}=g^{128}$。由于$g$是一个原根，根据欧拉准则有$g^{(p-1)/2} \\equiv -1 \\pmod{p}$，因此\n$$\ng_{0} \\equiv 3^{128} \\equiv -1 \\equiv 256 \\pmod{257}.\n$$\n将$a$写成$a=\\sum_{j=0}^{7} a_{j} 2^{j}$的形式，其中$a_{j} \\in \\{0,1\\}$。设$h_{0}=A=201$。对于$j=0,1,\\dots,7$，我们计算\n$$\nt_{j} \\equiv h_{j}^{N/2^{j+1}} \\pmod{257},\n$$\n并使用$t_{j} \\in \\{1, g_{0}\\}$来解码$a_{j}$：$t_{j} \\equiv 1$ 得到 $a_{j}=0$，而 $t_{j} \\equiv g_{0}$ 得到 $a_{j}=1$。确定$a_{j}$后，更新\n$$\nh_{j+1} \\equiv h_{j} \\cdot g^{-a_{j} 2^{j}} \\pmod{257}.\n$$\n我们具体进行计算。\n\n步骤 $j=0$:\n计算 $t_{0} \\equiv h_{0}^{128} \\pmod{257}$。通过重复平方：\n$$\n201^{2} \\equiv 52,\\quad 201^{4} \\equiv 134,\\quad 201^{8} \\equiv 223,\\quad 201^{16} \\equiv 128,\n$$\n$$\n201^{32} \\equiv 193,\\quad 201^{64} \\equiv 241,\\quad 201^{128} \\equiv 241^{2} \\equiv 256 \\pmod{257}.\n$$\n因此 $t_{0} \\equiv 256 \\equiv g_{0}$，所以 $a_{0}=1$。更新 $h_{1} \\equiv 201 \\cdot 3^{-1} \\pmod{257}$。由于 $3^{-1} \\equiv 86 \\pmod{257}$，我们得到 $h_{1} \\equiv 201 \\cdot 86 \\equiv 67 \\pmod{257}$。\n\n步骤 $j=1$:\n计算 $t_{1} \\equiv h_{1}^{64} \\pmod{257}$。通过平方：\n$$\n67^{2} \\equiv 120,\\quad 67^{4} \\equiv 8,\\quad 67^{8} \\equiv 64,\\quad 67^{16} \\equiv 241,\n$$\n$$\n67^{32} \\equiv 256,\\quad 67^{64} \\equiv 1 \\pmod{257}.\n$$\n所以 $t_{1} \\equiv 1$，因此 $a_{1}=0$，且 $h_{2} \\equiv h_{1} \\equiv 67$。\n\n步骤 $j=2$:\n计算 $t_{2} \\equiv h_{2}^{32} \\equiv 67^{32} \\equiv 256 \\pmod{257}$，所以 $a_{2}=1$。更新 $h_{3} \\equiv 67 \\cdot 3^{-4} \\pmod{257}$。由于 $3^{4}=81$ 且 $81^{-1} \\equiv 165 \\pmod{257}$，我们有 $3^{-4} \\equiv 165$，因此 $h_{3} \\equiv 67 \\cdot 165 \\equiv 4 \\pmod{257}$。\n\n步骤 $j=3$:\n计算 $t_{3} \\equiv h_{3}^{16} \\equiv 4^{16} \\equiv 1 \\pmod{257}$ (因为 $4^{4} \\equiv 256$ 且 $4^{8} \\equiv 1$)，因此 $a_{3}=0$，且 $h_{4} \\equiv 4$。\n\n步骤 $j=4$:\n计算 $t_{4} \\equiv h_{4}^{8} \\equiv 4^{8} \\equiv 1 \\pmod{257}$，所以 $a_{4}=0$，且 $h_{5} \\equiv 4$。\n\n步骤 $j=5$:\n计算 $t_{5} \\equiv h_{5}^{4} \\equiv 4^{4} \\equiv 256 \\pmod{257}$，所以 $a_{5}=1$。更新 $h_{6} \\equiv 4 \\cdot 3^{-32} \\pmod{257}$。通过平方计算 $3^{32}$：\n$$\n3^{2} \\equiv 9,\\quad 3^{4} \\equiv 81,\\quad 3^{8} \\equiv 136,\\quad 3^{16} \\equiv 249,\\quad 3^{32} \\equiv 64 \\pmod{257}.\n$$\n因此 $3^{-32} \\equiv 64^{-1} \\equiv 253 \\pmod{257}$ (因为 $64 \\cdot 253 \\equiv 1$)，得到 $h_{6} \\equiv 4 \\cdot 253 \\equiv 241 \\pmod{257}$。\n\n步骤 $j=6$:\n计算 $t_{6} \\equiv h_{6}^{2} \\equiv 241^{2} \\equiv 256 \\pmod{257}$，所以 $a_{6}=1$。更新 $h_{7} \\equiv 241 \\cdot 3^{-64} \\pmod{257}$。使用 $3^{64} \\equiv (3^{32})^{2} \\equiv 64^{2} \\equiv 241 \\pmod{257}$，其逆元为 $241^{-1} \\equiv 16 \\pmod{257}$ (因为 $241 \\equiv -16$ 且 $16 \\cdot (-16) \\equiv -256 \\equiv 1$)，所以 $h_{7} \\equiv 241 \\cdot 16 \\equiv 1 \\pmod{257}$。\n\n步骤 $j=7$:\n计算 $t_{7} \\equiv h_{7}^{1} \\equiv 1 \\pmod{257}$，因此 $a_{7}=0$。\n\n收集所有比特位，我们得到\n$$\n(a_{7}a_{6}\\dots a_{1}a_{0})=(01100101) \\text{ （从 } j=7 \\text{ 读到 } j=0）,\n$$\n等价地\n$$\na=a_{0}+2 a_{1}+4 a_{2}+8 a_{3}+16 a_{4}+32 a_{5}+64 a_{6}+128 a_{7}=1+0+4+0+0+32+64+0=101.\n$$\n验证：\n$$\n3^{101} \\equiv 3^{64} \\cdot 3^{32} \\cdot 3^{4} \\cdot 3 \\equiv 241 \\cdot 64 \\cdot 81 \\cdot 3 \\equiv 4 \\cdot 81 \\cdot 3 \\equiv 67 \\cdot 3 \\equiv 201 \\pmod{257},\n$$\n与要求相符。因此Alice的秘密指数是 $a=101$。", "answer": "$$\\boxed{101}$$", "id": "1349539"}]}