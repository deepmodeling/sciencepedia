{"hands_on_practices": [{"introduction": "椭圆曲线密码学的力量源于其点构成的“群”结构。本练习将引导你完成该群的基本运算：点加法。你不仅将应用公式，还将从几何的“弦切法”规则中推导出它，从而巩固你对这些公式背后原理的理解。我们还将通过计算验证交换律（$P+Q = Q+P$），这是椭圆曲线密码学中使用的阿贝尔群的一个关键性质。[@problem_id:3084652]", "problem": "设 $E$ 是定义在有限域 $\\mathbb{F}_{97}$ 上的椭圆曲线，其方程为 $y^{2}=x^{3}+2x+3$。椭圆曲线密码学 (ECC) 使用了这类曲线上所有点在模一个素数下构成的阿贝尔群。仅从有限域上椭圆曲线的基本定义以及用于定义群律的弦切线法则出发，完成以下任务：\n\n1. 验证 $E$ 在 $\\mathbb{F}_{97}$ 上是非奇异的。\n2. 验证点 $P=(3,6)$ 和 $Q=(80,10)$ 位于 $E\\left(\\mathbb{F}_{97}\\right)$ 上。\n3. 使用弦切线法则和有限域上的基本代数，推导两个不同点 $P=(x_{P},y_{P})$ 和 $Q=(x_{Q},y_{Q})$（其中 $x_{P}\\neq x_{Q}$）的仿射加法法则，将和 $R=P+Q$ 表示为 $R=(x_{R},y_{R})$，并用 $x_{P}$、$y_{P}$、$x_{Q}$ 和 $y_{Q}$ 的形式表达。\n4. 应用你推导出的公式计算 $E\\left(\\mathbb{F}_{97}\\right)$ 中的 $P+Q$ 和 $Q+P$，并用此计算验证这对点的加法满足交换律。\n\n将最终答案表示为给出 $P+Q$ 坐标的有序对 $(x,y)$，其中两个坐标都对 97 取模。无需四舍五入。", "solution": "这个问题定义明确，需要使用有限域上椭圆曲线的基本原理进行逐步分析。我将按顺序处理所需的四个部分来给出解答。\n\n椭圆曲线由方程 $E: y^{2} = x^{3} + Ax + B$ 给出，其中在有限域 $\\mathbb{F}_{97}$ 上，$A=2$ 且 $B=3$。\n\n1.  非奇异性验证。\n    由 Weierstraß 方程 $y^{2} = x^{3} + Ax + B$ 定义的椭圆曲线是非奇异的，当且仅当其判别式 $\\Delta = -16(4A^{3} + 27B^{2})$ 在定义域中不为零。我们计算该值模 97 的结果。\n    系数为 $A=2$ 和 $B=3$。\n    $$ \\Delta = -16(4(2)^{3} + 27(3)^{2}) $$\n    所有计算都在 $\\mathbb{F}_{97}$ 中进行。\n    $$ \\Delta \\equiv -16(4 \\cdot 8 + 27 \\cdot 9) \\pmod{97} $$\n    $$ \\Delta \\equiv -16(32 + 243) \\pmod{97} $$\n    我们首先将括号内的项对 97 取模。\n    $243 = 2 \\times 97 + 49$，所以 $243 \\equiv 49 \\pmod{97}$。\n    $$ \\Delta \\equiv -16(32 + 49) \\pmod{97} $$\n    $$ \\Delta \\equiv -16(81) \\pmod{97} $$\n    我们注意到 $-16 \\equiv 81 \\pmod{97}$。\n    $$ \\Delta \\equiv 81 \\cdot 81 = 81^{2} \\pmod{97} $$\n    $$ 81^{2} = 6561 $$\n    为了将 $6561$ 对 97 取模，我们进行除法运算：$6561 = 67 \\times 97 + 62$。\n    因此，$\\Delta \\equiv 62 \\pmod{97}$。\n    因为在 $\\mathbb{F}_{97}$ 中 $\\Delta = 62 \\neq 0$，所以椭圆曲线 $E$ 是非奇异的。\n\n2.  验证点是否在曲线上。\n    我们必须验证点 $P=(3,6)$ 和 $Q=(80,10)$ 在 $\\mathbb{F}_{97}$ 中满足曲线方程 $y^{2} = x^{3} + 2x + 3$。\n    \n    对于点 $P=(3,6)$：\n    方程左边 (LHS) 是 $y^{2} = 6^{2} = 36$。\n    方程右边 (RHS) 是 $x^{3} + 2x + 3 = 3^{3} + 2(3) + 3 = 27 + 6 + 3 = 36$。\n    因为 LHS = RHS，所以点 $P=(3,6)$ 位于 $E(\\mathbb{F}_{97})$ 上。\n    \n    对于点 $Q=(80,10)$：\n    LHS 是 $y^{2} = 10^{2} = 100 \\equiv 3 \\pmod{97}$。\n    RHS 是 $x^{3} + 2x + 3 = 80^{3} + 2(80) + 3$。我们在模 97 下进行计算。\n    因为 $80 \\equiv -17 \\pmod{97}$，我们有：\n    $80^{3} + 2(80) + 3 \\equiv (-17)^{3} + 2(-17) + 3 \\pmod{97}$。\n    $(-17)^{2} = 289$。由于 $289 = 2 \\times 97 + 95$，我们有 $(-17)^{2} \\equiv 95 \\equiv -2 \\pmod{97}$。\n    $(-17)^{3} = (-17)^{2} \\cdot (-17) \\equiv (-2) \\cdot (-17) = 34 \\pmod{97}$。\n    将此结果代回 RHS 表达式中：\n    RHS $\\equiv 34 + 2(-17) + 3 = 34 - 34 + 3 = 3 \\pmod{97}$。\n    因为 LHS $\\equiv 3$ 且 RHS $\\equiv 3$，所以点 $Q=(80,10)$ 也位于 $E(\\mathbb{F}_{97})$ 上。\n\n3.  仿射加法法则的推导。\n    椭圆曲线上的群律由弦切线法则定义。为了求出两个不同点 $P=(x_P, y_P)$ 和 $Q=(x_Q, y_Q)$（其中 $x_P \\neq x_Q$）的和 $R = P+Q$，我们首先画一条通过 $P$ 和 $Q$ 的直线。这条直线将与曲线相交于第三个点，我们记为 $R' = (x_{R'}, y_{R'})$。和 $R$ 定义为 $R'$ 关于 x 轴的对称点。群的单位元是无穷远点 $\\mathcal{O}$，一个点 $(x,y)$ 的逆元是 $(x,-y)$。\n\n    通过 $P$ 和 $Q$ 的直线方程为 $y = \\lambda x + \\nu$。其斜率 $\\lambda$ 为：\n    $$ \\lambda = \\frac{y_Q - y_P}{x_Q - x_P} $$\n    为了找到交点，我们将直线方程代入曲线方程 $y^{2} = x^{3} + Ax + B$：\n    $$ (\\lambda x + \\nu)^{2} = x^{3} + Ax + B $$\n    $$ \\lambda^{2}x^{2} + 2\\lambda\\nu x + \\nu^{2} = x^{3} + Ax + B $$\n    重新整理得到一个关于 $x$ 的三次多项式：\n    $$ x^{3} - \\lambda^{2}x^{2} + (A - 2\\lambda\\nu)x + (B - \\nu^{2}) = 0 $$\n    该多项式的根是三个交点的 x 坐标。我们已知其中两个根是 $x_P$ 和 $x_Q$。设第三个根为 $x_{R'}$。根据韦达定理，所有根的和等于 $x^{2}$ 项系数的相反数：\n    $$ x_P + x_Q + x_{R'} = \\lambda^{2} $$\n    解出 $x_{R'}$：\n    $$ x_{R'} = \\lambda^{2} - x_P - x_Q $$\n    和 $R=P+Q$ 记为 $(x_R, y_R)$。它是 $R'$ 的对称点，所以 $x_R = x_{R'}$。\n    $$ x_R = \\lambda^{2} - x_P - x_Q $$\n    y 坐标 $y_{R'}$ 在直线上，所以 $y_{R'} = \\lambda x_{R'} + \\nu$。直线方程可以写成 $y - y_P = \\lambda(x - x_P)$，所以 $y_{R'} = \\lambda(x_{R'} - x_P) + y_P$。\n    和的 y 坐标 $y_R$ 是 $y_{R'}$ 的相反数：\n    $$ y_R = -y_{R'} = -(\\lambda(x_R - x_P) + y_P) = \\lambda(x_P - x_R) - y_P $$\n    因此，对于 $R=(x_R, y_R) = P+Q$ 的仿射加法公式为：\n    $$ \\lambda = \\frac{y_Q - y_P}{x_Q - x_P} $$\n    $$ x_R = \\lambda^{2} - x_P - x_Q $$\n    $$ y_R = \\lambda(x_P - x_R) - y_P $$\n\n4.  计算 $P+Q$ 和 $Q+P$。\n    我们在 $\\mathbb{F}_{97}$ 中使用推导出的公式，其中 $P=(3,6)$ 且 $Q=(80,10)$。\n    \n    计算 $P+Q$：\n    首先，我们计算斜率 $\\lambda$：\n    $$ \\lambda = \\frac{y_Q - y_P}{x_Q - x_P} = \\frac{10 - 6}{80 - 3} = \\frac{4}{77} \\pmod{97} $$\n    为了计算这个值，我们需要 77 模 97 的乘法逆元。使用扩展欧几里得算法：\n    $97 = 1 \\cdot 77 + 20$\n    $77 = 3 \\cdot 20 + 17$\n    $20 = 1 \\cdot 17 + 3$\n    $17 = 5 \\cdot 3 + 2$\n    $3 = 1 \\cdot 2 + 1$\n    向后回代：\n    $1 = 3 - 2 = 3 - (17 - 5 \\cdot 3) = 6 \\cdot 3 - 17$\n    $1 = 6(20 - 17) - 17 = 6 \\cdot 20 - 7 \\cdot 17$\n    $1 = 6 \\cdot 20 - 7(77 - 3 \\cdot 20) = 27 \\cdot 20 - 7 \\cdot 77$\n    $1 = 27(97 - 77) - 7 \\cdot 77 = 27 \\cdot 97 - 27 \\cdot 77 - 7 \\cdot 77 = 27 \\cdot 97 - 34 \\cdot 77$\n    所以，$-34 \\cdot 77 \\equiv 1 \\pmod{97}$。因为 $-34 \\equiv 63 \\pmod{97}$，我们得到 $77^{-1} \\equiv 63 \\pmod{97}$。\n    现在，$\\lambda = 4 \\cdot 63 = 252$。\n    $252 = 2 \\times 97 + 58$，所以 $\\lambda \\equiv 58 \\pmod{97}$。\n    \n    接下来，我们计算 $x_R$：\n    $$ x_R = \\lambda^{2} - x_P - x_Q = 58^{2} - 3 - 80 \\pmod{97} $$\n    $58^{2} = 3364$。我们将其对 97 取模：$3364 = 34 \\times 97 + 66$。\n    所以 $58^{2} \\equiv 66 \\pmod{97}$。\n    $$ x_R = 66 - 3 - 80 = 63 - 80 = -17 \\equiv 80 \\pmod{97} $$\n    \n    最后，我们计算 $y_R$：\n    $$ y_R = \\lambda(x_P - x_R) - y_P = 58(3 - 80) - 6 \\pmod{97} $$\n    $$ y_R = 58(-77) - 6 \\pmod{97} $$\n    因为 $-77 \\equiv 20 \\pmod{97}$：\n    $$ y_R = 58 \\cdot 20 - 6 = 1160 - 6 = 1154 \\pmod{97} $$\n    为了将 1154 对 97 取模：$1154 = 11 \\times 97 + 87$。\n    所以，$y_R \\equiv 87 \\pmod{97}$。\n    和为 $P+Q = (80, 87)$。\n    \n    计算 $Q+P$：\n    现在的斜率 $\\lambda'$ 是 $\\frac{y_P - y_Q}{x_P - x_Q} = \\frac{6-10}{3-80} = \\frac{-4}{-77} = \\frac{4}{77}$，这与 $\\lambda$ 相同。所以 $\\lambda' = 58$。\n    x 坐标 $x_{R'} = (\\lambda')^{2} - x_Q - x_P = 58^{2} - 80 - 3$，这与 $x_R$ 相同，所以 $x_{R'} = 80$。\n    y 坐标 $y_{R'}$ 是以 $Q$ 为基点计算的：\n    $$ y_{R'} = \\lambda'(x_Q - x_{R'}) - y_Q = 58(80 - 80) - 10 \\pmod{97} $$\n    $$ y_{R'} = 58(0) - 10 = -10 \\equiv 87 \\pmod{97} $$\n    和为 $Q+P = (80, 87)$。\n    \n    计算结果表明 $P+Q = (80, 87)$ 且 $Q+P = (80, 87)$。这明确验证了对于这对点，加法运算是可交换的，正如阿贝尔群的性质所预期的那样。最终答案是这个和的坐标。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 80  87 \\end{pmatrix}\n}\n$$", "id": "3084652"}, {"introduction": "标量乘法（$kP$）是椭圆曲线密码学的核心单向函数。它本质上是点的重复相加（$P + P + \\dots + P$），但可以通过高效的“倍加算法”来计算。本练习将给你一个具体的任务：计算 $4P$。这将要求你同时使用点倍加和点加法公式，展示它们如何协同工作以执行这一关键的密码学操作。[@problem_id:1366844]", "problem": "在椭圆曲线密码学中，公钥是通过对给定椭圆曲线上的一个基点 $P$ 进行标量乘法来生成的。这个运算表示为 $kP$，它涉及将点 $P$ 与自身相加 $k-1$ 次，其中 $k$ 是一个整数私钥。椭圆曲线上点的加法遵循特定的代数规则。\n\n考虑一个定义在有限域 $\\mathbb{F}_p$ 上的椭圆曲线，其方程为 $y^2 \\equiv x^3 + ax + b \\pmod{p}$，其中 $p$ 是一个素数。\n\n将两个不同的点 $P=(x_1, y_1)$ 和 $Q=(x_2, y_2)$ 相加得到 $R=P+Q=(x_3, y_3)$ 的规则是：\n$$ \\lambda = (y_2 - y_1)(x_2-x_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - x_1 - x_2 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\n这里，$(x_2-x_1)^{-1}$ 表示 $(x_2-x_1)$ 模 $p$ 的模乘法逆元。\n\n将点 $P=(x_1, y_1)$ 倍乘得到 $R=2P=(x_3, y_3)$ 的规则是：\n$$ \\lambda = (3x_1^2 + a)(2y_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - 2x_1 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\n这里，$(2y_1)^{-1}$ 表示 $(2y_1)$ 模 $p$ 的模乘法逆元。\n\n给定椭圆曲线 $y^2 \\equiv x^3 + x + 1 \\pmod{5}$ 以及该曲线上的一个基点 $P = (0, 1)$。用户选择私钥 $k=4$。\n\n计算结果点 $Q = 4P$ 的坐标。将你的答案表示为一个行矩阵 $\\begin{pmatrix} x  y \\end{pmatrix}$，其中 $x$ 和 $y$ 是结果点的坐标，其值在集合 $\\{0, 1, 2, 3, 4\\}$ 中。", "solution": "我们在有限域 $\\mathbb{F}_{5}$ 上，在曲线 $y^{2} \\equiv x^{3} + x + 1 \\pmod{5}$ 上进行计算，其中 $a=1$。基点是 $P=(0,1)$，我们要求解 $Q=4P$。\n\n首先，验证点 $P$ 在曲线上：\n$$\ny^{2} \\equiv 1^{2} \\equiv 1,\\quad x^{3}+x+1 \\equiv 0^{3}+0+1 \\equiv 1 \\pmod{5}.\n$$\n因此 $P$ 在曲线上。\n\n使用倍乘法则计算 $2P$，其中 $x_{1}=0$，$y_{1}=1$：\n$$\n\\lambda = (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (0+1)\\cdot(2)^{-1} \\equiv 1\\cdot 3 \\equiv 3 \\pmod{5},\n$$\n因为 $2^{-1} \\equiv 3 \\pmod{5}$。\n然后\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 0 \\equiv 9 \\equiv 4 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 3(0-4) - 1 \\equiv 3(-4) - 1 \\equiv -12 - 1 = -13 \\equiv 2 \\pmod{5}.\n$$\n因此 $2P=(4,2)$。\n\n使用加法法则计算 $3P = 2P + P$，其中 $(x_{1},y_{1})=(4,2)$ 和 $(x_{2},y_{2})=(0,1)$：\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-2)(0-4)^{-1} \\equiv (-1)(-4)^{-1} \\equiv 4\\cdot 1 \\equiv 4 \\pmod{5},\n$$\n因为 $-1 \\equiv 4$ 且 $-4 \\equiv 1$，所以 $(0-4)^{-1} \\equiv 1^{-1} \\equiv 1$。然后\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 4^{2} - 4 - 0 \\equiv 16 - 4 \\equiv 12 \\equiv 2 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 4(4-2) - 2 \\equiv 4\\cdot 2 - 2 \\equiv 8 - 2 \\equiv 6 \\equiv 1 \\pmod{5}.\n$$\n因此 $3P=(2,1)$。\n\n计算 $4P = 3P + P$，其中 $(x_{1},y_{1})=(2,1)$ 和 $(x_{2},y_{2})=(0,1)$：\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-1)(0-2)^{-1} \\equiv 0\\cdot(-2)^{-1} \\equiv 0 \\pmod{5},\n$$\n因为 $(0-2) \\equiv -2 \\equiv 3$ 且 $3^{-1} \\equiv 2$，但是 $0\\cdot 2 \\equiv 0$。然后\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 0 - 2 - 0 \\equiv -2 \\equiv 3 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 0\\cdot(2-3) - 1 \\equiv -1 \\equiv 4 \\pmod{5}.\n$$\n因此 $4P=(3,4)$。\n\n作为检验，点 $(3,4)$ 满足模 $5$ 的曲线方程：\n$$\ny^{2} \\equiv 4^{2} \\equiv 16 \\equiv 1,\\quad x^{3}+x+1 \\equiv 27+3+1 \\equiv 31 \\equiv 1 \\pmod{5}.\n$$\n因此结果是正确的。", "answer": "$$\\boxed{\\begin{pmatrix} 3  4 \\end{pmatrix}}$$", "id": "1366844"}, {"introduction": "现在，让我们看看这些数学工具如何被用来完成一项非凡的任务：在不安全的信道上创建共享密钥。本练习模拟了爱丽丝（Alice）和鲍勃（Bob）之间一次完整的椭圆曲线迪菲-赫尔曼（ECDH）密钥交换过程。你将扮演双方的角色，通过私钥计算公钥（标量乘法），然后推导出相同的共享密钥点，亲眼见证公钥密码学的“魔力”。[@problem_id:3084656]", "problem": "考虑定义在有限域 $\\mathbb{F}_{17}$ 上的椭圆曲线\n$$E: y^2 \\equiv x^3 + 2x + 2 \\pmod{17}.$$\n点 $G=(5,1)$ 位于 $E$ 上，由 $G$ 生成的循环子群 $\\langle G \\rangle$ 的阶为素数 $n=19$。双方（Alice 和 Bob）在子群 $\\langle G \\rangle$ 中执行椭圆曲线 Diffie–Hellman (ECDH) 密钥交换。\n\nAlice 选择私有标量 $a=3$ 并公布 $A=[a]G$。Bob 选择私有标量 $b=10$ 并公布 $B=[b]G$。然后他们使用 $E(\\mathbb{F}_{17})$ 上的弦切群律计算共享密钥 $S_A=[a]B$ 和 $S_B=[b]A$。所有域运算都在模 $17$ 下进行。\n\n从有限域上椭圆曲线群的定义和显式的弦切加法法则（其中斜率 $m$ 由\n$$m \\equiv \\begin{cases}\n\\frac{y_2 - y_1}{x_2 - x_1} \\pmod{17},  \\text{对于 } P=(x_1,y_1)\\neq \\pm Q=(x_2,y_2),\\\\\n\\frac{3x_1^2 + a}{2y_1} \\pmod{17},  \\text{对于 } P=Q, \n\\end{cases}$$\n给出，以及公式\n$$x_3 \\equiv m^2 - x_1 - x_2 \\pmod{17}, \\qquad y_3 \\equiv m(x_1 - x_3) - y_1 \\pmod{17},$$\n和通常的无穷远点作为单位元）出发，执行完整的 ECDH 交换：计算 $A=[a]G$，$B=[b]G$，然后计算 $S_A=[a]B$ 和 $S_B=[b]A$，并验证 $S_A=S_B$。\n\n报告共享密钥点 $S$ 的 $x$ 坐标 $x_S$，其值为 $\\mathbb{F}_{17}$ 中的一个精确整数。无需四舍五入，最终答案必须是一个数字。", "solution": "该问题已经过验证，被确定为有限域上椭圆曲线密码学中一个定义良好且自洽的问题。关于点倍积公式中参数 `$a$` 的符号歧义已通过上下文解决；它指的是曲线方程中 $x$ 项的系数，即 $2$，而不是 Alice 的私钥 $3$。\n\n问题是执行一次椭圆曲线 Diffie-Hellman (ECDH) 密钥交换。参数如下：\n有限域为 $\\mathbb{F}_{17}$。\n椭圆曲线为 $E: y^2 \\equiv x^3 + 2x + 2 \\pmod{17}$。因此，点倍积公式的系数为 $a_{curve}=2$。\n生成元点为 $G=(5,1)$。\nAlice 的私钥为 $a=3$。\nBob 的私钥为 $b=10$。\n\n所有算术运算都在模 $17$ 下进行。在 $\\mathbb{F}_{17}$ 中，数 $z$ 的乘法逆元表示为 $z^{-1}$。\n\n**1. 计算 Alice 的公钥 $A=[a]G=[3]G$**\n\n首先，我们通过点倍积计算 $[2]G = G+G$。\n设 $G=(x_1, y_1) = (5, 1)$。倍积的斜率 $m$ 由 $m \\equiv \\frac{3x_1^2 + a_{curve}}{2y_1} \\pmod{17}$ 给出。\n$$m \\equiv \\frac{3(5^2) + 2}{2(1)} = \\frac{3(25)+2}{2} = \\frac{75+2}{2} = \\frac{77}{2} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$77 \\equiv 9$ 且 $2^{-1} \\equiv 9$（因为 $2 \\times 9 = 18 \\equiv 1$）。\n$$m \\equiv 9 \\times 9 = 81 \\equiv 13 \\pmod{17}$$\n$[2]G=(x_2, y_2)$ 的坐标为：\n$$x_2 \\equiv m^2 - x_1 - x_1 = 13^2 - 5 - 5 = 169 - 10 = 159 \\equiv 6 \\pmod{17}$$\n$$y_2 \\equiv m(x_1 - x_2) - y_1 = 13(5 - 6) - 1 = 13(-1) - 1 = -13 - 1 = -14 \\equiv 3 \\pmod{17}$$\n所以，$[2]G = (6, 3)$。\n\n接下来，我们通过点加法计算 $A = [3]G = [2]G + G$。\n设 $P=(x_P, y_P)=[2]G=(6,3)$ 和 $Q=(x_Q, y_Q)=G=(5,1)$。斜率为 $m \\equiv \\frac{y_Q - y_P}{x_Q - x_P} \\pmod{17}$。\n$$m \\equiv \\frac{1 - 3}{5 - 6} = \\frac{-2}{-1} = 2 \\pmod{17}$$\n$A=(x_A, y_A)$ 的坐标为：\n$$x_A \\equiv m^2 - x_P - x_Q = 2^2 - 6 - 5 = 4 - 11 = -7 \\equiv 10 \\pmod{17}$$\n$$y_A \\equiv m(x_P - x_A) - y_P = 2(6 - 10) - 3 = 2(-4) - 3 = -8 - 3 = -11 \\equiv 6 \\pmod{17}$$\nAlice 的公钥为 $A = (10, 6)$。\n\n**2. 计算 Bob 的公钥 $B=[b]G=[10]G$**\n\n我们使用倍加算法。因为 $10 = 8+2$，我们计算 $B = [8]G + [2]G$。我们已有 $[2]G=(6,3)$。\n首先，我们通过对 $[2]G = (6,3)$ 进行倍积来计算 $[4]G = [2]([2]G)$。\n$$m \\equiv \\frac{3(6^2)+2}{2(3)} = \\frac{3(36)+2}{6} = \\frac{108+2}{6} = \\frac{110}{6} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$110 \\equiv 8$ 且 $6^{-1} \\equiv 3$。\n$$m \\equiv 8 \\times 3 = 24 \\equiv 7 \\pmod{17}$$\n$$x_4 \\equiv 7^2 - 6 - 6 = 49 - 12 = 37 \\equiv 3 \\pmod{17}$$\n$$y_4 \\equiv 7(6 - 3) - 3 = 7(3) - 3 = 21 - 3 = 18 \\equiv 1 \\pmod{17}$$\n所以，$[4]G = (3, 1)$。\n\n接下来，我们通过对 $[4]G=(3,1)$ 进行倍积来计算 $[8]G = [2]([4]G)$。\n$$m \\equiv \\frac{3(3^2)+2}{2(1)} = \\frac{27+2}{2} = \\frac{29}{2} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$29 \\equiv 12$ 且 $2^{-1} \\equiv 9$。\n$$m \\equiv 12 \\times 9 = 108 \\equiv 6 \\pmod{17}$$\n$$x_8 \\equiv 6^2 - 3 - 3 = 36 - 6 = 30 \\equiv 13 \\pmod{17}$$\n$$y_8 \\equiv 6(3 - 13) - 1 = 6(-10) - 1 = -60 - 1 = -61 \\equiv 7 \\pmod{17}$$\n所以，$[8]G = (13, 7)$。\n\n最后，我们计算 $B = [10]G = [8]G + [2]G$。设 $P=(13,7)$ 和 $Q=(6,3)$。\n$$m \\equiv \\frac{3-7}{6-13} = \\frac{-4}{-7} = \\frac{4}{7} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$7^{-1} \\equiv 5$。\n$$m \\equiv 4 \\times 5 = 20 \\equiv 3 \\pmod{17}$$\n$B=(x_B, y_B)$ 的坐标为：\n$$x_B \\equiv 3^2 - 13 - 6 = 9 - 19 = -10 \\equiv 7 \\pmod{17}$$\n$$y_B \\equiv 3(13 - 7) - 7 = 3(6) - 7 = 18 - 7 = 11 \\pmod{17}$$\nBob 的公钥为 $B = (7, 11)$。\n\n**3. 计算共享密钥 $S_A = [a]B = [3]B$**\n\nAlice 计算共享密钥 $S_A = [3]B = [2]B + B$。设 $B=(7,11)$。\n首先，我们将 $B$ 倍积得到 $[2]B$。\n$$m \\equiv \\frac{3(7^2)+2}{2(11)} = \\frac{3(49)+2}{22} = \\frac{147+2}{22} = \\frac{149}{22} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$149 \\equiv 13$ 且 $22 \\equiv 5$。我们有 $5^{-1} \\equiv 7$。\n$$m \\equiv 13 \\times 7 = 91 \\equiv 6 \\pmod{17}$$\n$$x_{2B} \\equiv 6^2 - 7 - 7 = 36 - 14 = 22 \\equiv 5 \\pmod{17}$$\n$$y_{2B} \\equiv 6(7 - 5) - 11 = 6(2) - 11 = 12 - 11 = 1 \\pmod{17}$$\n所以，$[2]B = (5, 1)$，即生成元 $G$。\n\n现在 Alice 计算 $S_A = [2]B + B = G+B$。设 $P=G=(5,1)$ 和 $Q=B=(7,11)$。\n$$m \\equiv \\frac{11-1}{7-5} = \\frac{10}{2} = 5 \\pmod{17}$$\n共享密钥 $S_A = (x_S, y_S)$ 的坐标为：\n$$x_S \\equiv 5^2 - 5 - 7 = 25 - 12 = 13 \\pmod{17}$$\n$$y_S \\equiv 5(5 - 13) - 1 = 5(-8) - 1 = -40 - 1 = -41 \\equiv 10 \\pmod{17}$$\nAlice 计算出的共享密钥是 $S_A = (13, 10)$。\n\n**4. 计算并验证共享密钥 $S_B = [b]A = [10]A$**\n\nBob 计算共享密钥 $S_B = [10]A = [8]A + [2]A$。我们有 $A=(10,6)$。\n我们首先计算 $[2]A$、$[4]A$ 和 $[8]A$。\n$[2]A$: 对 $A=(10,6)$ 进行倍积。\n$$m \\equiv \\frac{3(10^2)+2}{2(6)} = \\frac{302}{12} \\pmod{17}$$\n$302 \\equiv 13$ 且 $12^{-1} \\equiv 10$。所以 $m \\equiv 13 \\times 10 = 130 \\equiv 11$。\n$x_{2A} \\equiv 11^2 - 10 - 10 = 121 - 20 = 101 \\equiv 16$。\n$y_{2A} \\equiv 11(10-16)-6 = -66-6 = -72 \\equiv 13$。所以 $[2]A=(16,13)$。\n\n$[4]A$: 对 $[2]A=(16,13)$ 进行倍积。\n$$m \\equiv \\frac{3(16^2)+2}{2(13)} = \\frac{3(256)+2}{26} \\equiv \\frac{3(1)+2}{9} = \\frac{5}{9} \\pmod{17}$$\n$9^{-1} \\equiv 2$。所以 $m \\equiv 5 \\times 2 = 10$。\n$x_{4A} \\equiv 10^2 - 16 - 16 = 100 - 32 = 68 \\equiv 0$。\n$y_{4A} \\equiv 10(16-0)-13 = 160-13 = 147 \\equiv 11$。所以 $[4]A=(0,11)$。\n\n$[8]A$: 对 $[4]A=(0,11)$ 进行倍积。\n$$m \\equiv \\frac{3(0^2)+2}{2(11)} = \\frac{2}{22} \\equiv \\frac{2}{5} \\pmod{17}$$\n$5^{-1} \\equiv 7$。所以 $m \\equiv 2 \\times 7 = 14$。\n$x_{8A} \\equiv 14^2 - 0 - 0 = 196 \\equiv 9$。\n$y_{8A} \\equiv 14(0-9)-11 = -126-11 = -137 \\equiv 16$。所以 $[8]A=(9,16)$。\n\n最后，Bob 计算 $S_B = [8]A + [2]A$。设 $P=[8]A=(9,16)$ 和 $Q=[2]A=(16,13)$。\n$$m \\equiv \\frac{13-16}{16-9} = \\frac{-3}{7} = \\frac{14}{7} = 2 \\pmod{17}$$\n$S_B=(x'_S, y'_S)$ 的坐标为：\n$$x'_S \\equiv 2^2 - 9 - 16 = 4 - 25 = -21 \\equiv 13 \\pmod{17}$$\n$$y'_S \\equiv 2(9 - 13) - 16 = 2(-4) - 16 = -8 - 16 = -24 \\equiv 10 \\pmod{17}$$\nBob 计算出的共享密钥是 $S_B = (13, 10)$。\n\n我们验证 $S_A = (13, 10) = S_B$，因此 ECDH 交换成功。共享密钥点是 $S = (13, 10)$。问题要求 $x$ 坐标 $x_S$。\n\n$x_S = 13$。", "answer": "$$\n\\boxed{13}\n$$", "id": "3084656"}]}