{"hands_on_practices": [{"introduction": "卡迈克尔数的存在本身就引人入胜，但我们如何找到它们呢？这个练习将指导你从头开始，利用科塞尔特判别法不仅作为验证工具，更作为一种构建工具。通过推导卡迈克尔数必须具备的结构属性，你将进行一次系统的搜索，最终找到最小的卡迈克尔数——$561$。这个过程完美地结合了理论推导和解决问题的实践。[@problem_id:3082961]", "problem": "设 $n$ 是一个合数，它是一个卡迈克尔数 (Carmichael number)，意即对于每个与 $n$ 互质的整数 $a$（即 $\\gcd(a,n)=1$），都有 $a^{n-1} \\equiv 1 \\pmod{n}$。根据已知（Korselt 准则），一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因子数，并且对于每个整除 $n$ 的素数 $p$，都有 $p-1 \\mid n-1$。从这些基本定义和事实出发，确定最小的卡迈克尔数。你的推理过程必须：\n\n- 根据给定的定义和 Korselt 准则，建立卡迈克尔数的结构性约束（包括奇偶性和素因子数量）。\n- 将问题具体化到 $n=3qr$ 的情况，其中 $3  q  r$ 且 $q$ 和 $r$ 都是素数，通过系统性搜索找到最小的此类数。", "solution": "问题要求通过先建立结构性质，然后进行系统性搜索，最后验证结果的方式，找到最小的卡迈克尔数。\n\n卡迈克尔数 $n$ 是一个合数，满足对于所有与 $n$ 互质的整数 $a$（即 $\\gcd(a,n)=1$），都有 $a^{n-1} \\equiv 1 \\pmod{n}$。Korselt 准则指出，一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因子数，且对于 $n$ 的每个素因子 $p$，都有 $p-1$ 整除 $n-1$。\n\n**第一步：卡迈克尔数的结构性约束**\n\n设 $n$ 是一个卡迈克尔数。根据 Korselt 准则，$n$ 必须是无平方因子数，意即 $n$ 是一系列不同素数的乘积，例如 $n = p_1 p_2 \\cdots p_k$。因为 $n$ 是合数，它必须有至少两个不同的素因子，因此 $k \\ge 2$。\n\n1.  **$n$ 的奇偶性**：我们将证明 $n$ 必须是奇数。为引出矛盾，我们假设 $n$ 是偶数。由于 $n$ 是无平方因子数，它的一个素因子必须是 $2$。设 $p_1=2$。那么 $n = 2 \\cdot p_2 \\cdots p_k$，其中 $p_2, \\dots, p_k$ 是不同的奇素数。由于 $n$ 是偶数，$n-1$ 是奇数。\n    Korselt 准则要求对于 $n$ 的任意素因子 $p_i$，$p_i-1$ 必须整除 $n-1$。让我们考虑一个奇素因子 $p_i$（其中 $i \\ge 2$）。对于这样一个素数，$p_i-1$ 是一个偶数。然而，一个偶数（$p_i-1$）不能整除一个奇数（$n-1$）。这是一个矛盾。因此，最初的假设（$n$ 是偶数）必定是错误的。所有的卡迈克尔数都必须是奇数。\n\n2.  **素因子的数量**：我们将证明 $n$ 必须有至少三个素因子。我们已经知道 $n$ 必须是奇合数，所以 $k \\ge 2$。让我们假设 $n$ 恰好有两个素因子，即 $n=pq$，其中 $p$ 和 $q$ 是不同的奇素数且 $p  q$。\n    根据 Korselt 准则，我们必须有 $p-1 \\mid pq-1$ 和 $q-1 \\mid pq-1$。\n    考虑第一个条件：$p-1 \\mid pq-1$。我们可以写成 $pq-1 = p(q-1) + p-1 = (p-1)q + q-1$。因此，$p-1$ 必须整除 $q-1$。\n    考虑第二个条件：$q-1 \\mid pq-1$。我们可以写成 $pq-1 = q(p-1) + q-1$。因此，$q-1$ 必须整除 $p-1$。\n    由于 $p-1$ 和 $q-1$ 都是正整数，如果它们互相整除，那么它们必须相等。$p-1 = q-1 \\implies p=q$。但这与 $p,q$ 是不同的素数相矛盾。因此，一个由两个不同素数相乘得到的数不可能是卡迈克尔数。\n    结论是 $k$ 必须大于等于 $3$。\n\n因此，任何卡迈克尔数都必须是奇数，并且至少有三个不同的素因子。\n\n**第二步：系统性搜索**\n\n我们现在寻找最小的卡迈克尔数。它必须是奇数，并且至少有三个素因子。为了让 $n$ 尽可能小，我们应该使用最小的奇素数作为因子。最小的三个奇素数是 $3, 5, 7$。\n\n**情况 1：$n=3 \\cdot 5 \\cdot 7 = 105$**\n这是一个合数，无平方因子。我们检查 Korselt 准则。$n-1 = 104$。\n素因子是 $3, 5, 7$。\n- 对于 $p=3$，$p-1=2$。$2 \\mid 104$ (成立)。\n- 对于 $p=5$，$p-1=4$。$4 \\mid 104$ (成立)。\n- 对于 $p=7$，$p-1=6$。$6 \\nmid 104$ (不成立，因为 $104 = 6 \\times 17 + 2$)。\n因此，$105$ 不是卡迈克尔数。\n\n**情况 2：$n=3 \\cdot 5 \\cdot 11 = 165$**\n$n-1=164$。\n- $p-1=2 \\mid 164$ (成立)。\n- $p-1=4 \\mid 164$ (成立)。\n- $p-1=10 \\nmid 164$ (不成立)。\n因此，$165$ 不是卡迈克尔数。\n\n**情况 3：$n=3 \\cdot 5 \\cdot 13 = 195$**\n$n-1=194$。\n- $p-1=2 \\mid 194$ (成立)。\n- $p-1=4 \\nmid 194$ (不成立)。\n因此，$195$ 不是卡迈克尔数。\n\n**情况 4：$n=3 \\cdot 7 \\cdot 11 = 231$**\n$n-1=230$。\n- $p-1=6 \\nmid 230$ (不成立)。\n因此，$231$ 不是卡迈克尔数。\n\n**情况 5：$n = 3qr$ 的一般情况**\n我们固定最小的素因子为 $3$。设 $n=3qr$，其中 $3  q  r$ 是素数。\nKorselt 准则要求：\n- $p-1=2 \\mid 3qr-1$ (总是成立，因为 $3qr$ 是奇数)\n- $q-1 \\mid 3qr-1$。由于 $3qr-1 = 3(q-1)r + 3r-1$，这等价于 $q-1 \\mid 3r-1$。\n- $r-1 \\mid 3qr-1$。由于 $3qr-1 = 3q(r-1) + 3q-1$，这等价于 $r-1 \\mid 3q-1$。\n\n我们从最小的可能值 $q=5$ 开始。此时 $3  5  r$。\n条件变为 $4 \\mid 3r-1$ 和 $r-1 \\mid 3(5)-1=14$。\n$3r \\equiv 1 \\pmod 4 \\implies -r \\equiv 1 \\pmod 4 \\implies r \\equiv 3 \\pmod 4$。\n$r-1$ 的可能值是 $1, 2, 7, 14$，所以 $r$ 的可能值是 $2, 3, 8, 15$。$r$ 必须是大于 $q=5$ 的素数。这些值中没有一个是满足条件的。\n\n下一个可能的 $q$ 是 $q=7$。此时 $3  7  r$。\n条件 $q-1 \\mid 3r-1$ 变为 $6 \\mid 3r-1$。这是不可能的，因为 $3r-1$ 永远不能被 $3$ 整除。\n\n下一个可能的 $q$ 是 $q=11$。此时 $3  11  r$。\n条件变为 $10 \\mid 3r-1$ 和 $r-1 \\mid 3(11)-1=32$。\n- 从 $10 \\mid 3r-1$ 可知，$3r-1$ 的个位数是 $0$，所以 $3r$ 的个位数必须是 $1$。这意味着 $r$ 的个位数必须是 $7$（因为 $3 \\times 7 = 21$）。所以 $r$ 可能是 $17, 37, 47, ...$\n- 从 $r-1 \\mid 32$ 可知，$r-1$ 是 $32$ 的因子，即 $1, 2, 4, 8, 16, 32$。所以 $r$ 可能是 $2, 3, 5, 9, 17, 33$。\n我们寻找同时满足这两个条件且 $r>11$ 的素数 $r$。\n$r=17$ 满足第一个条件 ($17$ 以 $7$ 结尾) 和第二个条件 ($17-1=16$ 是 $32$ 的因子)。\n所以 $n = 3 \\cdot 11 \\cdot 17 = 561$ 是一个候选者。\n\n**第三步：验证**\n我们检查 $n=561$ 是否是卡迈克尔数。\n$n=561 = 3 \\cdot 11 \\cdot 17$ 是一个无平方因子的合数。\n$n-1=560$。\n- 对于 $p=3$，$p-1=2$，并且 $2 \\mid 560$。\n- 对于 $p=11$，$p-1=10$，并且 $10 \\mid 560$。\n- 对于 $p=17$，$p-1=16$，并且 $16 \\mid 560$。\n所有条件均满足。因此，$561$ 是一个卡迈克尔数。\n由于我们是通过系统性地检查最小的素数组合来构建它的，所以 $561$ 是最小的卡迈克尔数。", "answer": "$$\\boxed{561}$$", "id": "3082961"}, {"introduction": "卡迈克尔数有时被称为“通用伪素数”，但这“通用”一词究竟意味着什么？这个练习通过分析数字 $341$ 来揭示其深刻含义，它是一个对于基数 $2$ 的费马伪素数，但并非一个卡迈克尔数。通过应用科塞尔特判别法，你将亲手验证这一区别，从而深刻理解伪素数和卡迈克尔数之间的关键差异。[@problem_id:3082957]", "problem": "设 $n=341$。回顾以下标准定义。如果一个合数 $n$ 满足 $a^{n-1} \\equiv 1 \\pmod{n}$，则称 $n$ 为以 $a$ 为底的费马伪素数。卡迈克尔数是一个合数 $n$，对于所有与 $n$ 互素的整数 $a$（即 $\\gcd(a,n)=1$），都满足 $a^{n-1} \\equiv 1 \\pmod{n}$。Korselt判别法指出，一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因数的，并且对于每个整除 $n$ 的素数 $p$，都有 $p-1 \\mid n-1$。\n\n从这些定义出发，证明 $n=341$ 是一个以 $2$ 为底的费马伪素数但不是一个卡迈克尔数，然后确定满足 $a^{340} \\equiv 1 \\pmod{341}$ 的模 $341$ 的剩余类 $a$ 的确切数量 $N$。\n\n请将您的最终答案表示为精确整数 $N$。", "solution": "本题要求我们分析数字 $n=341$ 关于费马伪素数和卡迈克尔数的性质，然后计算一个特定同余式的解的数量。我们将系统地解决问题的每个部分。\n\n首先，我们证明 $n=341$ 是一个以 $2$ 为底的费马伪素数。\n一个数 $n$ 被称为以 $a$ 为底的费马伪素数，如果它是一个合数并且满足 $a^{n-1} \\equiv 1 \\pmod{n}$。\n给定 $n=341$。我们找到它的素因数分解：$341 = 11 \\times 31$。因为 $11$ 和 $31$ 都是素数，所以 $n=341$ 是一个合数。\n接下来，我们必须验证同余式 $2^{341-1} \\equiv 1 \\pmod{341}$，即 $2^{340} \\equiv 1 \\pmod{341}$。我们可以通过检查模素因数 $11$ 和 $31$ 的同余情况，并使用中国剩余定理。\n1. 模 $11$：根据费马小定理，因为 $11$ 是素数且 $\\gcd(2, 11) = 1$，我们有 $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$。指数为 $340 = 10 \\times 34$。因此，\n$$2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$$\n2. 模 $31$：我们可以计算 $2$ 的幂模 $31$ 的值。我们注意到 $2^5 = 32 \\equiv 1 \\pmod{31}$。指数为 $340 = 5 \\times 68$。因此，\n$$2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$$\n由于 $2^{340} \\equiv 1 \\pmod{11}$ 和 $2^{340} \\equiv 1 \\pmod{31}$，并且已知 $\\gcd(11, 31) = 1$，根据中国剩余定理，可得 $2^{340} \\equiv 1 \\pmod{11 \\times 31}$，即 $2^{340} \\equiv 1 \\pmod{341}$。\n因为 $341$ 是合数且满足 $2^{340} \\equiv 1 \\pmod{341}$，所以它是一个以 $2$ 为底的费马伪素数。\n\n其次，我们证明 $n=341$ 不是一个卡迈克尔数。\n我们使用题目中给出的Korselt判别法：一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因数的，并且对于每个整除 $n$ 的素数 $p$，$p-1$ 整除 $n-1$。\n我们来检查 $n=341$ 是否满足这些条件：\n1. $n=341$ 是合数，这一点我们已经证明。\n2. $n=341=11 \\times 31$ 是无平方因数的，因为它的素因子的指数都是 $1$。\n3. 对于 $n$ 的每个素因数 $p$，我们必须检查是否有 $p-1 \\mid n-1$。这里 $n-1 = 340$。\n   - 对于素因数 $p=11$，我们检查 $p-1=10$ 是否整除 $n-1=340$。确实，$340 = 10 \\times 34$，所以 $10 \\mid 340$。此条件成立。\n   - 对于素因数 $p=31$，我们检查 $p-1=30$ 是否整除 $n-1=340$。我们有 $340 = 11 \\times 30 + 10$。由于余数非零，$30 \\nmid 340$。\n由于条件 $p-1 \\mid n-1$ 对于素因数 $p=31$ 不成立，根据Korselt判别法，$n=341$ 不是一个卡迈克尔数。\n\n第三，我们确定满足 $a^{340} \\equiv 1 \\pmod{341}$ 的模 $341$ 的剩余类 $a$ 的数量 $N$。\n这等价于求多项式同余式 $x^{340} - 1 \\equiv 0 \\pmod{341}$ 的解的数量。\n使用中国剩余定理，我们可以将其分解为一个同余方程组：\n$$a^{340} \\equiv 1 \\pmod{11}$$\n$$a^{340} \\equiv 1 \\pmod{31}$$\n我们分别求出每个同余式的解的数量。\n1. 对于 $a^{340} \\equiv 1 \\pmod{11}$：\n   解不能是 $a \\equiv 0 \\pmod{11}$，因为 $0^{340} \\equiv 0 \\not\\equiv 1 \\pmod{11}$。所以，任何解都必须是模11整数乘法群 $(\\mathbb{Z}/11\\mathbb{Z})^\\times$ 中的元素，该群的阶为 $\\varphi(11) = 10$。\n   根据费马小定理，对于任何满足 $\\gcd(a,11)=1$ 的 $a$，我们有 $a^{10} \\equiv 1 \\pmod{11}$。\n   因为 $340 = 10 \\times 34$，我们有 $a^{340} = (a^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$。\n   这意味着该同余式对 $(\\mathbb{Z}/11\\mathbb{Z})^\\times$ 中的所有元素都成立。这些元素的数量是 $\\varphi(11) = 10$。因此，模 $11$ 有 $10$ 个解。\n\n2. 对于 $a^{340} \\equiv 1 \\pmod{31}$：\n   同样，$a \\equiv 0 \\pmod{31}$ 不是一个解。我们在群 $(\\mathbb{Z}/31\\mathbb{Z})^\\times$ 中寻找解，这是一个阶为 $\\varphi(31) = 30$ 的循环群。\n   在 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 中，同余式 $x^k \\equiv 1 \\pmod{p}$ 的解的数量由 $\\gcd(k, p-1)$ 给出。\n   在我们的例子中，$k=340$ 且 $p=31$，所以 $p-1=30$。解的数量是 $\\gcd(340, 30)$。\n   我们计算最大公约数：\n   $340 = 34 \\times 10 = 2 \\times 17 \\times 2 \\times 5 = 2^2 \\times 5 \\times 17$\n   $30 = 3 \\times 10 = 2 \\times 3 \\times 5$\n   $\\gcd(340, 30) = 2^1 \\times 5^1 = 10$。\n   因此，$a^{340} \\equiv 1 \\pmod{31}$ 有 $10$ 个解。\n\n根据中国剩余定理，对于每一对解 $(r_{11}, r_{31})$，其中 $r_{11}$ 是一个模 $11$ 的解，$r_{31}$ 是一个模 $31$ 的解，都存在一个唯一的模 $341$ 的解 $a$。总解数 $N$ 是每个模的解数的乘积。\n$N = (\\text{模 } 11 \\text{ 的解数}) \\times (\\text{模 } 31 \\text{ 的解数}) = 10 \\times 10 = 100$。\n因此，恰好有 $100$ 个模 $341$ 的剩余类 $a$ 满足 $a^{340} \\equiv 1 \\pmod{341}$。", "answer": "$$\\boxed{100}$$", "id": "3082957"}, {"introduction": "在理解了卡迈克尔数的基本性质和构造方法之后，是时候在一个更复杂的例子上检验你的技能了。这个练习提供了一个较大的合数 $n=41041$，并要求你使用科塞尔特判别法来确定它是否为卡迈克尔数。这是一个直接应用核心定理的绝佳机会，旨在巩固你的计算技巧和对判别法 $p-1 \\mid n-1$ 每个步骤的理解。[@problem_id:3082962]", "problem": "令 $n=41041=7\\cdot 11\\cdot 13\\cdot 41$。卡迈克尔数是一个合数、无平方因子整数 $n$，它满足对于每个满足 $\\gcd(a,n)=1$ 的整数 $a$，都有 $a^{n-1}\\equiv 1 \\pmod n$ 成立，这使得 $n$ 成为一个通用费马伪素数。利用这样一个性质：$n$ 是卡迈克尔数当且仅当 $n$ 是无平方因子的，并且对于每个整除 $n$ 的素数 $p$，都有 $p-1 \\mid n-1$。请按以下步骤操作：\n\n- 计算集合 $\\{p-1: p\\mid n\\}$ 及其最小公倍数 $L=\\operatorname{lcm}\\{p-1: p\\mid n\\}$。\n- 验证对于每个整除 $n$ 的素数 $p$，$p-1 \\mid n-1$ 是否成立，并判断 $n$ 是否为卡迈克尔数。\n- 报告 $L$ 的精确值（不进行四舍五入）作为最终答案。", "solution": "本题要求使用科塞尔特准则验证 $n=41041$ 是否为卡迈克尔数，并计算一个特定的最小公倍数 $L$。\n\n首先，我们整理已知信息。整数为 $n=41041$。其素因数分解已给出：$n = 7 \\cdot 11 \\cdot 13 \\cdot 41$。因此，$n$ 的素因数是 $p_1=7$，$p_2=11$，$p_3=13$ 和 $p_4=41$。\n\n科塞尔特准则指出，一个合数 $n$ 是卡迈克尔数，当且仅当满足以下两个条件：\n1. $n$ 是无平方因子的。\n2. 对于 $n$ 的每个素因数 $p$，整除关系 $p-1 \\mid n-1$ 均成立。\n\n我们来验证 $n=41041$ 是否满足这些条件。\n\n第一个条件：$n$ 是无平方因子的吗？\n$n$ 的素因数分解为 $7^1 \\cdot 11^1 \\cdot 13^1 \\cdot 41^1$。由于所有素因数的指数均为1，没有重复的素因数。因此，$n$ 是无平方因子的。此条件满足。此外，$n$ 显然是合数，因为它是四个不同素数的乘积。\n\n第二个条件：对于 $n$ 的所有素因数 $p$，$p-1 \\mid n-1$ 是否都成立？\n为了验证这一点，我们首先按要求计算集合 $\\{p-1 : p \\mid n\\}$。\n对于 $p_1=7$，我们有 $p_1-1 = 7-1 = 6$。\n对于 $p_2=11$，我们有 $p_2-1 = 11-1 = 10$。\n对于 $p_3=13$，我们有 $p_3-1 = 13-1 = 12$。\n对于 $p_4=41$，我们有 $p_4-1 = 41-1 = 40$。\n该集合为 $\\{6, 10, 12, 40\\}$。\n\n接下来，我们计算这个集合的最小公倍数，记为 $L$。\n$L = \\operatorname{lcm}(6, 10, 12, 40)$。\n为求最小公倍数，我们确定集合中每个数的素因数分解：\n$6 = 2 \\cdot 3 = 2^1 \\cdot 3^1$\n$10 = 2 \\cdot 5 = 2^1 \\cdot 5^1$\n$12 = 4 \\cdot 3 = 2^2 \\cdot 3^1$\n$40 = 8 \\cdot 5 = 2^3 \\cdot 5^1$\n最小公倍数是通过取这些分解中出现的每个素因数的最高次幂来求得的。这些素因数是 $2$、$3$ 和 $5$。\n$2$ 的最高次幂是 $2^3$。\n$3$ 的最高次幂是 $3^1$。\n$5$ 的最高次幂是 $5^1$。\n因此，$L = 2^3 \\cdot 3^1 \\cdot 5^1 = 8 \\cdot 3 \\cdot 5 = 120$。\n\n现在我们必须验证对于每个 $p \\in \\{7, 11, 13, 41\\}$，$p-1 \\mid n-1$ 是否成立。一个更有效的方法是利用最小公倍数的性质。如果 $L = \\operatorname{lcm}(p_1-1, p_2-1, \\dots, p_k-1)$，那么对于所有 $i$ 都有 $p_i-1 \\mid n-1$ 的条件等价于单一条件 $L \\mid n-1$。\n\n我们需要计算 $n-1$：\n$n-1 = 41041 - 1 = 41040$。\n\n然后我们检查 $L \\mid n-1$ 是否成立，即检查 $120 \\mid 41040$ 是否成立。我们进行除法运算：\n$$ \\frac{41040}{120} = \\frac{4104}{12} $$\n我们可以简化除法：\n$$ \\frac{4104}{12} = \\frac{3600 + 480 + 24}{12} = \\frac{3600}{12} + \\frac{480}{12} + \\frac{24}{12} = 300 + 40 + 2 = 342 $$\n由于除法的结果是一个整数 $342$，所以整除条件 $120 \\mid 41040$ 成立。这意味着对于 $n$ 的所有素因数 $p$，$p-1 \\mid n-1$ 都成立。\n\n结论：\n由于 $n=41041$ 是一个合数、无平方因子整数，并且对于每个整除 $n$ 的素数 $p$，我们已经验证了 $p-1 \\mid n-1$，因此科塞尔特准则的两个条件都满足。所以，$n=41041$ 是一个卡迈克尔数。\n\n题目要求报告 $L$ 的值。根据计算，$L = 120$。", "answer": "$$\\boxed{120}$$", "id": "3082962"}]}