{"hands_on_practices": [{"introduction": "现在我们来亲手验证第一个也是最著名的卡迈克尔数——$561$。这个练习将引导你使用数论中的基本工具，如中国剩余定理和费马小定理，从根本上证明$561$确实是一个卡迈克尔数。通过这个过程，你将深刻理解为何这类数被称为“绝对伪素数”，因为对于所有与它互质的底数，它们都能通过费马素性检验，完美地“伪装”成素数。", "problem": "设 $n = 561$。对于模 $n$ 的一个底数 $a$，如果 $n$ 是合数，$\\gcd(a,n) = 1$ 且 $a^{n-1} \\equiv 1 \\pmod{n}$，则称 $a$ 是 $n$ 的费马素性检验的一个费马骗子。一个合数 $n$ 被称为卡迈克尔数（也称为绝对费马伪素数），如果对于每个满足 $\\gcd(a,n) = 1$ 的模 $n$ 剩余类 $a$，$a$ 都是 $n$ 的一个费马骗子。请仅使用初等数论的基本事实——即费马小定理、欧拉定理和中国剩余定理 (CRT)——通过对其素因子取模来证明 $561$ 是一个卡迈克尔数。然后，计算在 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$（模 $561$ 的单位群）中，是 $561$ 的费马骗子的剩余类所占的比例。请將最终答案表示为一个实数，无需四舍五入。", "solution": "本题要求两个结果。首先，证明整数 $n = 561$ 是一个卡迈克尔数。其次，计算在模 $561$ 的单位群（记作 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$）中，是 $n=561$ 的费马骗子的剩余类所占的比例。\n\n根据定义，一个合数 $n$ 是卡迈克尔数，如果对于任意满足 $\\gcd(a, n) = 1$ 的整数 $a$，同余式 $a^{n-1} \\equiv 1 \\pmod{n}$ 均成立。满足这些条件（$n$ 是合数，$\\gcd(a,n)=1$，以及 $a^{n-1} \\equiv 1 \\pmod{n}$）的元素 $a$ 被称为费马骗子。\n\n首先，我们证明 $561$ 是一个卡迈克尔数。\n为此，我们必须验证两个条件：\n1.  $n=561$ 是一个合数。\n2.  对于所有满足 $\\gcd(a, 561) = 1$ 的整数 $a$，同余式 $a^{561-1} \\equiv 1 \\pmod{561}$ 成立。\n\n对于第一个条件，我们求 $561$ 的素因子分解。数字 $561$ 的各位数字之和为 $5+6+1=12$，能被 $3$ 整除，所以 $561$ 能被 $3$ 整除。我们有 $561 = 3 \\times 187$。为了分解 $187$，我们可以测试较小的素数。它不能被 $2, 3, 5, 7$ 整除。下一个素数是 $11$，我们发现 $187 = 11 \\times 17$。因此，$n$ 的素因子分解为 $n = 561 = 3 \\times 11 \\times 17$。由于 $561$ 是多个素数的乘积，所以它是一个合数。\n\n对于第二个条件，我们需要证明对于任意满足 $\\gcd(a, 561) = 1$ 的整数 $a$，有 $a^{560} \\equiv 1 \\pmod{561}$。条件 $\\gcd(a, 561) = 1$ 等价于 $a$ 不是 $3$、$11$ 或 $17$ 的倍数。也就是说，$\\gcd(a, 3) = 1$，$\\gcd(a, 11) = 1$ 且 $\\gcd(a, 17) = 1$。\n\n我们可以使用中国剩余定理 (CRT)。同余式 $a^{560} \\equiv 1 \\pmod{561}$ 等价于以下同余方程组：\n$$\n\\begin{cases}\na^{560} \\equiv 1 \\pmod{3} \\\\\na^{560} \\equiv 1 \\pmod{11} \\\\\na^{560} \\equiv 1 \\pmod{17}\n\\end{cases}\n$$\n我们使用费马小定理 (FLT) 分别分析每个同余式。费马小定理指出，如果 $p$ 是一个素数，那么对于任何不能被 $p$ 整除的整数 $a$，我们有 $a^{p-1} \\equiv 1 \\pmod{p}$。\n\n1.  模 $3$：由于 $\\gcd(a, 3) = 1$，根据费马小定理，$a^{3-1} \\equiv a^2 \\equiv 1 \\pmod{3}$。我们目标同余式中的指数是 $560$。我们可以用 $2$ 来表示 $560$：$560 = 2 \\times 280$。因此，\n    $$a^{560} = (a^2)^{280} \\equiv 1^{280} \\equiv 1 \\pmod{3}$$\n    此同余式对任意不能被 $3$ 整除的 $a$ 都成立。\n\n2.  模 $11$：由于 $\\gcd(a, 11) = 1$，根据费马小定理，$a^{11-1} \\equiv a^{10} \\equiv 1 \\pmod{11}$。指数是 $560$。我们可以用 $10$ 来表示 $560$：$560 = 10 \\times 56$。因此，\n    $$a^{560} = (a^{10})^{56} \\equiv 1^{56} \\equiv 1 \\pmod{11}$$\n    此同余式对任意不能被 $11$ 整除的 $a$ 都成立。\n\n3.  模 $17$：由于 $\\gcd(a, 17) = 1$，根据费马小定理，$a^{17-1} \\equiv a^{16} \\equiv 1 \\pmod{17}$。指数是 $560$。我们可以用 $16$ 来表示 $560$：$560 = 16 \\times 35$。因此，\n    $$a^{560} = (a^{16})^{35} \\equiv 1^{35} \\equiv 1 \\pmod{17}$$\n    此同余式对任意不能被 $17$ 整除的 $a$ 都成立。\n\n我们已经证明，对于任意满足 $\\gcd(a, 561) = 1$ 的整数 $a$，同余式 $a^{560} \\equiv 1$ 对模 $3$、$11$ 和 $17$ 都成立。由于 $3$、$11$ 和 $17$ 两两互素，根据中国剩余定理，我们可以得出结论，该同余式对它们的乘积也成立。\n$$a^{560} \\equiv 1 \\pmod{3 \\times 11 \\times 17}$$\n$$a^{560} \\equiv 1 \\pmod{561}$$\n由于 $561$ 是合数，且对于所有与 $561$ 互质的整数 $a$，都有 $a^{561-1} \\equiv 1 \\pmod{561}$，因此我们证明了 $561$ 是一个卡迈克尔数。\n\n接下来，我们计算在 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 中是 $561$ 的费马骗子的剩余类所占的比例。\n单位群 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 是所有满足 $\\gcd(a, 561) = 1$ 的模 $561$ 剩余类 $a$ 的集合。\n题目将 $n=561$ 的费马骗子定义为满足 $\\gcd(a, 561) = 1$ 且 $a^{561-1} \\equiv 1 \\pmod{561}$ 的底数 $a$。\n设 $S = \\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 是与 $561$ 互质的剩余类的集合。\n设 $L$ 是 $561$ 的费馬骗子的集合。根据定义，$L$ 的成员必须与 $561$ 互质，所以 $L$ 是 $S$ 中表示的剩余类的一个子集。\n\n在我们分析的第一部分，我们证明了对于每个满足 $\\gcd(a, 561) = 1$ 的整数 $a$，同余式 $a^{560} \\equiv 1 \\pmod{561}$ 成立。这意味着集合 $S$ 中的每个元素都满足成为费马骗子的条件。\n因此，费马骗子集合 $L$ 与单位群集合 $S$ 是相同的。\n$$L = S$$\n题目要求的是 $S$ 中是费馬骗子的剩余类所占的比例。这个比例由费马骗子的数量与单位总数的比值给出：\n$$\\text{比例} = \\frac{|L|}{|S|}$$\n由于 $L=S$，这个比例是：\n$$\\frac{|S|}{|S|} = 1$$\n在 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 中，是 $561$ 的费马骗子的剩余类所占的比例是 $1$。这是 $561$ 是一个卡迈克尔数的直接推论。\n\n最终答案需要表示为一个实数。这个数是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3082789"}, {"introduction": "虽然从第一性原理出发的证明很有启发性，但在实践中我们通常使用一个更直接的工具：科塞尔特准则 (Korselt's criterion)。这个练习将让你应用这个强大的准则来检验一个更大的数——$8911$ [@problem_id:3082779]。通过系统地核对该准则的两个条件（无平方因子和整除性），你将能够高效地判定它是否为卡迈克尔数，从而熟练掌握标准的判定流程。", "problem": "一个正整数 $n$ 如果是合数，并且满足一组与其各素因数相关的整除条件，则被称为卡迈克尔数（Carmichael number，也称为绝对伪素数）。考虑 $n=8911$，其给定的因数分解为 $8911=7\\cdot 19\\cdot 67$。无需重述题目陈述中的任何判别定理，请使用卡迈克尔数的适当充要条件来判断 $n$ 是否为卡迈克尔数。\n\n定义指示函数 $C(n)$ 如下：如果 $n$ 是卡迈克尔数，则 $C(n)=1$；否则 $C(n)=0$。计算 $C(8911)$。最终答案只需提供 $C(8911)$ 的值。无需四舍五入，也无需单位。", "solution": "题目要求我们判断整数 $n=8911$ 是否为卡迈克尔数，并基于此判断计算指示函数 $C(8911)$ 的值。题目给出了 $n$ 的素因数分解为 $8911 = 7 \\cdot 19 \\cdot 67$。\n\n一个合数 $n$ 是卡迈克尔数，当且仅当它满足 Korselt's criterion。该判别法陈述了两个条件：\n1. 数 $n$ 必须是无平方因数的，即它不能被任何素数的平方整除。\n2. 对于 $n$ 的每一个素因数 $p$，必须满足整除关系 $(p-1) | (n-1)$。\n\n我们将对 $n=8911$ 系统地验证这些条件。\n\n首先，我们确定 $n$ 是一个合数。给定的因数分解 $n = 7 \\cdot 19 \\cdot 67$ 表明 $n$ 是三个不同素数的乘积。由于它有不止一个素因数，所以 $n$ 是合数。\n\n接下来，我们验证 Korselt's criterion 的第一个条件：$n$ 必须是无平方因数的。\n$n$ 的素因数分解是 $7^1 \\cdot 19^1 \\cdot 67^1$。每个素因数的指数都是 $1$。因此，$n$ 不能被任何素数的平方整除。这意味着 $n=8911$ 是无平方因数的，满足第一个条件。\n\n现在，我们验证 Korselt's criterion 的第二个条件。我们必须对 $n=8911$ 的每个素因数 $p$ 检查是否满足 $(p-1) | (n-1)$。\n$n-1$ 的值是 $8911 - 1 = 8910$。\n$n$ 的素因数是 $p_1 = 7$，$p_2 = 19$ 和 $p_3 = 67$。\n\n对于素因数 $p_1 = 7$：\n我们必须检查 $(p_1 - 1) | (n-1)$，即 $6 | 8910$ 是否成立。\n一个数能被 $6$ 整除，如果它既能被 $2$ 整除，也能被 $3$ 整除。\n数 $8910$ 是偶数，所以能被 $2$ 整除。\n$8910$ 的各位数字之和是 $8+9+1+0 = 18$。因为 $18$ 能被 $3$ 整除，所以数 $8910$ 能被 $3$ 整除。\n因为 $8910$ 既能被 $2$ 整除也能被 $3$ 整除，所以它能被 $6$ 整除。计算证实了这一点：$8910 \\div 6 = 1485$。\n因此，该条件对 $p_1 = 7$ 成立。\n\n对于素因数 $p_2 = 19$：\n我们必须检查 $(p_2 - 1) | (n-1)$，即 $18 | 8910$ 是否成立。\n一个数能被 $18$ 整除，如果它既能被 $2$ 整除，也能被 $9$ 整除。\n我们已经知道 $8910$ 能被 $2$ 整除。\n$8910$ 的各位数字之和是 $18$。因为 $18$ 能被 $9$ 整除，所以数 $8910$ 能被 $9$ 整除。\n因为 $8910$ 既能被 $2$ 整除也能被 $9$ 整除，所以它能被 $18$ 整除。计算证实了这一点：$8910 \\div 18 = 495$。\n因此，该条件对 $p_2 = 19$ 成立。\n\n对于素因数 $p_3 = 67$：\n我们必须检查 $(p_3 - 1) | (n-1)$，即 $66 | 8910$ 是否成立。\n一个数能被 $66$ 整除，如果它既能被 $6$ 整除，也能被 $11$ 整除，因为 $\\text{gcd}(6, 11)=1$。\n我们已经证明了 $8910$ 能被 $6$ 整除。\n为了检查能否被 $11$ 整除，我们计算 $8910$ 的各位数字的交错和：$0 - 1 + 9 - 8 = 0$。由于结果是 $0$，而 $0$ 能被 $11$ 整除，所以数 $8910$ 能被 $11$ 整除。\n因为 $8910$ 既能被 $6$ 整除也能被 $11$ 整除，所以它能被 $66$ 整除。计算证实了这一点：$8910 \\div 66 = 135$。\n因此，该条件对 $p_3 = 67$ 成立。\n\n由于 $n=8911$ 是一个合数、无平方因数的数，并且对于其所有素因数 $p$，条件 $(p-1) | (n-1)$ 都满足，我们得出结论，$n=8911$ 是一个卡迈克尔数。\n\n题目将指示函数 $C(n)$ 定义为：如果 $n$ 是卡迈克尔数，则 $C(n)=1$；否则 $C(n)=0$。由于我们已经证明了 $8911$ 是一个卡迈克尔数，指示函数的值为 $C(8911)=1$。", "answer": "$$\\boxed{1}$$", "id": "3082779"}, {"introduction": "卡迈克尔数虽然能骗过基础的费马素性检验，但它们并非无懈可击。本练习旨在揭示更强大的现代素性检验方法，如强可能素数测试（米勒-拉宾测试的基础），如何“识破”这些伪素数。你将再次以$561$为例 [@problem_id:3082805]，找出一个能证明其为合数的“证据”（witness），从而理解为何现代密码学和计算数论依赖于这些更可靠的算法。", "problem": "设 $n=561$。回顾以下标准概念。\n- 一个合数 $n$ 被称为卡迈克尔数 (Carmichael number)，如果对于任意与 $n$ 互质的整数 $a$（即 $\\gcd(a,n)=1$），都有 $a^{n-1}\\equiv 1 \\pmod{n}$。\n- 对于一个奇数 $n>1$，将其写作 $n-1=2^{s}d$，其中 $d$ 是奇数。对于一个与 $n$ 互质的整数 $a$（即 $\\gcd(a,n)=1$），如果 $a^{d}\\equiv 1 \\pmod{n}$ 或者存在一个整数 $r$ 满足 $0\\le r  s$ 使得 $a^{2^r d} \\equiv -1 \\pmod{n}$，则称 $n$ 是以 $a$ 为底的**强可能素数**。如果 $n$ 未通过此测试，则称 $a$ 是其合数性的一个**证据**（witness）。\n请找出最小的整数证据 $a$（在 $2 \\le a \\le 100$ 范围内且与 $561$ 互质），它能证明 $n=561$ 是合数。另外，请验证你找到的 $a$ 确实满足费马同余式 $a^{560} \\equiv 1 \\pmod{561}$。", "solution": "问题要求找到在 $2 \\le a \\le 100$ 范围内且满足 $\\gcd(a, 561)=1$ 的最小整数底数 $a$，使得 $n=561$ 未通过强可能素数测试。\n\n首先，我们分析给定的数 $n=561$，并确定强可能素数测试的参数。$n$ 的素因数分解是 $561 = 3 \\times 11 \\times 17$。这证实了 $n$ 是一个合数。\n\n该测试要求将 $n-1$ 写成 $2^s d$ 的形式，其中 $d$ 是一个奇数。\n我们有 $n-1 = 561-1 = 560$。\n将 $560$ 分解为 $2$ 的幂和一个奇数部分，我们得到 $560 = 16 \\times 35 = 2^4 \\times 35$。\n因此，我们有 $s=4$ 和 $d=35$。\n\n根据所给定义，$n$ 是以 $a$ 为底的强可能素数，如果满足以下任一条件：\n1. $a^d \\equiv 1 \\pmod{n}$\n2. 存在一个整数 $r$ 满足 $0 \\le r  s$ 使得 $a^{2^r d} \\equiv -1 \\pmod{n}$。\n\n在我们的具体情况下，$n=561$，$d=35$，$s=4$，数 $561$ 是以 $a$ 为底的强可能素数，如果 $a^{35} \\equiv 1 \\pmod{561}$ 或者对于某个 $r \\in \\{0, 1, 2, 3\\}$ 有 $a^{35 \\cdot 2^r} \\equiv -1 \\pmod{561}$。\n\n我们正在寻找最小的整数 $a \\ge 2$，使得 $n=561$ *未通过* 此测试。未通过测试意味着*同时*满足以下两个条件：\n1. $a^{35} \\not\\equiv 1 \\pmod{561}$\n2. 对于所有 $r \\in \\{0, 1, 2, 3\\}$，都有 $a^{35 \\cdot 2^r} \\not\\equiv -1 \\pmod{561}$。\n\n我们必须从 $a=2$ 开始，在指定范围内搜索最小的整数 $a$。\n\n让我们测试 $a=2$。首先，我们检查先决条件 $\\gcd(a, n)=1$。\n由于 $561$ 是奇数，$\\gcd(2, 561) = \\gcd(2, 3 \\times 11 \\times 17) = 1$。因此，$a=2$ 是一个有效的测试底数。\n\n现在，我们对 $n=561$ 和底数 $a=2$ 执行强可能素数测试。我们需要计算序列 $2^{35}$、$2^{70}$、$2^{140}$ 和 $2^{280}$ 模 $561$ 的值。我们将使用中国剩余定理 (CRT) 进行这些计算，分别在模素因数 $3$、$11$ 和 $17$ 下进行。\n\n计算 $2^{35} \\pmod{561}$：\n设 $x \\equiv 2^{35} \\pmod{561}$。这等价于以下同余方程组：\n- $x \\equiv 2^{35} \\pmod{3}$。因为 $2 \\equiv -1 \\pmod{3}$，所以我们有 $2^{35} \\equiv (-1)^{35} \\equiv -1 \\equiv 2 \\pmod{3}$。\n- $x \\equiv 2^{35} \\pmod{11}$。根据费马小定理 (Fermat's Little Theorem)，$2^{10} \\equiv 1 \\pmod{11}$。所以，$2^{35} = (2^{10})^3 \\cdot 2^5 \\equiv 1^3 \\cdot 32 \\equiv 32 \\equiv 10 \\pmod{11}$。\n- $x \\equiv 2^{35} \\pmod{17}$。根据费马小定理 (Fermat's Little Theorem)，$2^{16} \\equiv 1 \\pmod{17}$。所以，$2^{35} = (2^{16})^2 \\cdot 2^3 \\equiv 1^2 \\cdot 8 \\equiv 8 \\pmod{17}$。\n\n我们需要解这个方程组：\n$x \\equiv 2 \\pmod{3}$\n$x \\equiv 10 \\pmod{11}$\n$x \\equiv 8 \\pmod{17}$\n\n由 $x \\equiv 10 \\pmod{11}$，我们可以写出 $x = 11k + 10$，其中 $k$ 是某个整数。\n将此代入第一个同余式：$11k + 10 \\equiv 2 \\pmod{3} \\implies 2k + 1 \\equiv 2 \\pmod{3} \\implies 2k \\equiv 1 \\pmod{3}$。两边乘以 $2$，得到 $4k \\equiv 2 \\pmod{3} \\implies k \\equiv 2 \\pmod{3}$。所以，$k = 3j+2$，其中 $j$ 是某个整数。\n代回：$x = 11(3j+2) + 10 = 33j + 22 + 10 = 33j + 32$。\n现在，使用第三个同余式：$33j + 32 \\equiv 8 \\pmod{17} \\implies -j - 2 \\equiv 8 \\pmod{17} \\implies -j \\equiv 10 \\pmod{17} \\implies j \\equiv -10 \\equiv 7 \\pmod{17}$。所以，$j = 17m+7$，其中 $m$ 是某个整数。\n最后，$x = 33(17m+7) + 32 = 561m + 231 + 32 = 561m + 263$。\n因此，$2^{35} \\equiv 263 \\pmod{561}$。\n\n现在我们检查 $a=2$ 未通过测试的条件：\n1. $a^d \\equiv 1 \\pmod n$ 是否成立？我们有 $2^{35} \\equiv 263 \\pmod{561}$。这不等于 $1$。所以未通过测试的第一个条件满足。\n2. 现在我们检查当 $r \\in \\{0, 1, 2, 3\\}$ 时序列 $a^{d \\cdot 2^r} \\pmod n$ 的值。\n- 当 $r=0$ 时：$2^{35} \\equiv 263 \\pmod{561}$。这不等于 $-1 \\pmod{561}$（因为 $-1 \\equiv 560$）。\n- 当 $r=1$ 时：$2^{70} = (2^{35})^2 \\equiv 263^2 = 69169 \\pmod{561}$。$69169 = 123 \\times 561 + 166$。所以，$2^{70} \\equiv 166 \\pmod{561}$。这不等于 $-1 \\pmod{561}$。\n- 当 $r=2$ 时：$2^{140} = (2^{70})^2 \\equiv 166^2 = 27556 \\pmod{561}$。$27556 = 49 \\times 561 + 67$。所以，$2^{140} \\equiv 67 \\pmod{561}$。这不等于 $-1 \\pmod{561}$。\n- 当 $r=3$ 时：$2^{280} = (2^{140})^2 \\equiv 67^2 = 4489 \\pmod{561}$。$4489 = 8 \\times 561 + 1$。所以，$2^{280} \\equiv 1 \\pmod{561}$。这不等于 $-1 \\pmod{561}$。\n\n序列 $\\{a^d, a^{2d}, a^{4d}, a^{8d}\\}$ 模 $561$ 的值为 $\\{263, 166, 67, 1\\}$。\n这些值中没有一个与 $-1 \\pmod{561}$ 同余，并且第一项 $a^d$ 不与 $1 \\pmod{561}$ 同余。因此，$n=561$ 未通过以底数 $a=2$ 的强可能素数测试。\n\n因为我们在寻找最小的满足条件的整数 $a \\ge 2$，并且我们发现 $a=2$ 符合标准，所以答案是 $2$。\n\n最后，我们执行问题所要求的额外验证：对于我们选择的底数 $a=2$，我们必须验证 $a^{560} \\equiv 1 \\pmod{561}$。\n我们有 $a^{n-1} = 2^{560}$。指数是 $560 = 2 \\times 280$。使用我们之前的计算：\n$2^{560} = (2^{280})^2 \\equiv 1^2 \\equiv 1 \\pmod{561}$。\n验证成立。这个结果是预料之中的，因为 $n=561$ 是一个卡迈克尔数。根据定义，对于任何与 $n$ 互质的整数 $a$（即 $\\gcd(a, n)=1$），同余式 $a^{n-1} \\equiv 1 \\pmod{n}$ 都成立。这个问题表明，虽然 $n=561$ 通过了以 $2$ 为底的费马测试 (Fermat's test)，但它未通过更强的米勒-拉宾测试 (Miller-Rabin test)，该测试正确地揭示了它的合数性质。\n\n使 $n=561$ 未通过强可能素数测试的最小整数底数 $a$ 是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3082805"}]}