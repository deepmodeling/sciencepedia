{"hands_on_practices": [{"introduction": "费马素性检验是基于费马小定理的一种高效的素数判定方法。然而，有些合数能够“伪装”成素数通过检验，我们称之为“费马伪素数”。本练习将引导你通过计算，验证最小的以 2 为底的伪素数 $n=341$，从而揭示费马检验的一个基本局限性 [@problem_id:3091005]。", "problem": "设 $n=341$ 且 $a=2$。从费马素性检验和底为$a$的费马伪素数的定义出发，并仅使用费马小定理和中国剩余定理等基础性结果，计算 $2^{340}$ 模 $341$ 的余数 $r$。根据此计算，推断 $341$ 是否满足底为 $2$ 的费马素性条件。在您的推理中，明确证明您使用的每一个同余式，并确保您的论证在各素数幂模下是一致的。您也可以基于第一性原理，通过比较 $2^{(n-1)/2} \\bmod n$ 与雅可比符号 $\\left(\\frac{2}{n}\\right)$，来评论 Solovay–Strassen 素性检验会如何处理数对 $(a,n)$，但您最终报告的答案必须是单个数值余数 $r$。无需四舍五入。", "solution": "问题的核心是计算 $a^{n-1}$ 模 $n$ 的余数 $r$，其中 $n=341$ 且 $a=2$。这个计算是费马素性检验的核心。\n\n费马素性检验基于费马小定理 (FLT)，该定理指出，如果 $p$ 是一个素数，那么对于任何不能被 $p$ 整除的整数 $a$，同余式 $a^{p-1} \\equiv 1 \\pmod{p}$ 成立。该检验检查给定的整数 $n$ 是否在特定基 $a$ 下表现得像一个素数。具体来说，如果一个整数 $n  1$ 对于某个与 $n$ 互素的整数 $a$ (即 $\\gcd(a, n) = 1$) 满足 $a^{n-1} \\equiv 1 \\pmod{n}$，我们就说 $n$ 通过了以 $a$ 为底的费马素性检验。如果 $n$ 是合数但满足这个条件，它就被称为以 $a$ 为底的费马伪素数。\n\n我们需要计算 $r \\equiv 2^{340} \\pmod{341}$。直接计算将非常繁琐。问题指定使用基础性结果，即费马小定理和中国剩余定理 (CRT)。这提示我们应该首先找到模数 $n=341$ 的素因数分解。\n\n经过检验，我们发现 $341$ 可以被 $11$ 整除：$341 = 11 \\times 31$。$11$ 和 $31$ 都是素数。这个因式分解使我们能够分别分析模 $11$ 和模 $31$ 的同余式，然后使用中国剩余定理 (CRT) 合并结果。\n\n首先，我们计算 $2^{340} \\pmod{11}$。\n因为 $11$ 是一个素数且不能整除 $2$，我们可以应用费马小定理：\n$$2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$$\n我们原始表达式中的指数是 $340$。我们可以用 $10$ 来表示 $340$：$340 = 10 \\times 34$。\n利用这一点，我们可以计算同余式：\n$$2^{340} = 2^{10 \\times 34} = (2^{10})^{34} \\pmod{11}$$\n代入费马小定理的结果：\n$$(2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$$\n因此，我们得到了第一个同余式：$2^{340} \\equiv 1 \\pmod{11}$。\n\n其次，我们计算 $2^{340} \\pmod{31}$。\n因为 $31$ 是一个素数且不能整除 $2$，我们可以再次应用费马小定理：\n$$2^{31-1} \\equiv 2^{30} \\equiv 1 \\pmod{31}$$\n指数是 $340$。我们用 $30$ 来表示 $340$：$340 = 30 \\times 11 + 10$。\n利用这一点，我们计算同余式：\n$$2^{340} = 2^{30 \\times 11 + 10} = (2^{30})^{11} \\cdot 2^{10} \\pmod{31}$$\n代入费马小定理的结果：\n$$(2^{30})^{11} \\cdot 2^{10} \\equiv 1^{11} \\cdot 2^{10} \\equiv 2^{10} \\pmod{31}$$\n我们现在必须计算 $2^{10} \\pmod{31}$。一个更简单的方法是注意到 $2^5 = 32 \\equiv 1 \\pmod{31}$。这是因为 $2$ 是 $31$ 的原根当且仅当它的阶是 $\\phi(31)=30$，但在这里它的阶是 $5$。\n利用这个事实：\n$$2^{10} = (2^5)^2 \\equiv 1^2 \\equiv 1 \\pmod{31}$$\n因此，我们得到了第二个同余式：$2^{340} \\equiv 1 \\pmod{31}$。\n\n现在，我们必须找到一个整数 $r$，$0 \\le r  341$，它同时满足以下同余方程组：\n\\begin{align*} r  \\equiv 1 \\pmod{11} \\\\ r  \\equiv 1 \\pmod{31} \\end{align*}\n中国剩余定理保证在模 $11 \\times 31 = 341$ 下存在唯一解，因为 $\\gcd(11, 31) = 1$。在这个特殊情况下，通过观察可以立即得到解。数字 $r=1$ 显然满足两个同余式。\n形式上，第一个同余式意味着 $r-1$ 是 $11$ 的倍数，第二个同余式意味着 $r-1$ 是 $31$ 的倍数。由于 $11$ 和 $31$ 互素，$r-1$ 必须是它们的乘积 $341$ 的倍数。\n所以，$r-1 = k \\cdot 341$ 对于某个整数 $k$ 成立。这等价于 $r \\equiv 1 \\pmod{341}$。\n因此，余数是 $r=1$。\n\n根据此计算，我们得出结论 $2^{340} \\equiv 1 \\pmod{341}$。由于 $n=341$ 是合数 ($341 = 11 \\times 31$)，尽管它不是素数，但它满足了以 $2$ 为底的费马素性条件 $2^{n-1} \\equiv 1 \\pmod n$。因此，它被归类为以 $2$ 为底的费马伪素数。事实上，$341$ 是最小的此类数。\n\n关于所要求的评论，索洛维-施特拉森素性检验通过检查是否满足 $a^{(n-1)/2} \\equiv \\left(\\frac{a}{n}\\right) \\pmod{n}$ 来改进费马检验，其中 $\\left(\\frac{a}{n}\\right)$ 是雅可比符号。在我们的例子中，$a=2$ 且 $n=341$。\n我们首先计算 $2^{(n-1)/2} \\pmod n = 2^{(341-1)/2} \\pmod{341} = 2^{170} \\pmod{341}$。\n使用相同的中国剩余定理方法：\n模 $11$：$170 = 10 \\times 17$，所以 $2^{170} = (2^{10})^{17} \\equiv 1^{17} \\equiv 1 \\pmod{11}$。\n模 $31$：$170 = 5 \\times 34$，并且因为 $2^5 \\equiv 1 \\pmod{31}$，我们有 $2^{170} = (2^5)^{34} \\equiv 1^{34} \\equiv 1 \\pmod{31}$。\n根据中国剩余定理，由于 $2^{170}$ 模 $11$ 和模 $31$ 都同余于 $1$，我们有 $2^{170} \\equiv 1 \\pmod{341}$。\n\n接下来，我们计算雅可比符号 $\\left(\\frac{2}{341}\\right)$。分子为 $2$ 的雅可比符号的法则是 $\\left(\\frac{2}{n}\\right) = (-1)^{(n^2-1)/8}$。一个更简单的表述是，如果 $n \\equiv 1, 7 \\pmod{8}$，则 $\\left(\\frac{2}{n}\\right) = 1$；如果 $n \\equiv 3, 5 \\pmod{8}$，则 $\\left(\\frac{2}{n}\\right) = -1$。\n我们计算 $341$ 模 $8$：$341 = 8 \\times 42 + 5$，所以 $341 \\equiv 5 \\pmod{8}$。\n因此，$\\left(\\frac{2}{341}\\right) = -1$。\n\n索洛维-施特拉森素性检验的条件是 $2^{170} \\equiv \\left(\\frac{2}{341}\\right) \\pmod{341}$，即 $1 \\equiv -1 \\pmod{341}$。这是错误的，因为 $1 - (-1) = 2$，而 $341$ 不能整除 $2$。由于该条件不成立，索洛维-施特拉森检验正确地将 $341$ 识别为合数。\n\n然而，问题只要求计算 $2^{340}$ 模 $341$ 的数值余数 $r$。根据主要计算，该值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3091005"}, {"introduction": "在伪素数概念的基础上，本练习将介绍一类更具挑战性的合数——卡迈克尔数（Carmichael numbers）。这些数对于所有与它们互素的底数都能通过费马检验，使得简单的费马检验变得不可靠。通过研究最小的卡迈克尔数 $n=561$，你将理解为何必须发展更强大的素性检验方法 [@problem_id:3091021]。", "problem": "设 $n=561$ 且 $a=2$。请仅使用基础数论原理——例如费马小定理、欧拉函数 $\\varphi(\\cdot)$ 和中国剩余定理 (CRT)——来确定唯一的余数 $r$（满足 $0 \\leq r  n$），使得 $2^{560} \\equiv r \\pmod{561}$。请从第一性原理出发，论证你的步骤，包括验证 $a$ 与 $n$ 互质，以及在使用中国剩余定理时所涉及的模数是两两互质的。然后，根据你计算出的余数，判断 $561$ 是否通过了以 $2$ 为底的费马素性检验。将余数 $r$ 作为你的最终答案。无需四舍五入，也不涉及单位。", "solution": "目标是确定在 $0 \\leq r  561$ 范围内的唯一余数 $r$，使其满足同余式 $2^{560} \\equiv r \\pmod{561}$。然后，我们将利用此结果来判断整数 $n=561$ 是否能通过以 $a=2$ 为底的费马素性检验。\n\n首先，我们分析模数 $n=561$。如果一个数的各位数字之和能被 $3$ 整除，那么这个数就能被 $3$ 整除。对于 $561$，其各位数字之和为 $5+6+1=12$，可以被 $3$ 整除。因此，$561 = 3 \\times 187$。为了分解 $187$，我们尝试用小的素数去除。它不能被 $2$、$3$ 或 $5$ 整除。对于 $7$，$187 = 7 \\times 26 + 5$。对于 $11$，我们发现 $187 = 11 \\times 17$。$3$、$11$ 和 $17$ 都是素数。因此，模数 $n$ 的素因数分解为 $n = 561 = 3 \\times 11 \\times 17$。\n\n由于 $n=561$ 是一个合数，我们不能直接对模 $561$ 应用费马小定理。因此，我们使用中国剩余定理 (CRT)。CRT 允许我们将一个关于合数模的同余问题分解为其素因数模的联立同余方程组来求解。要应用 CRT，方程组的模必须两两互质。在我们的例子中，模是素因数 $3$、$11$ 和 $17$。作为不同的素数，它们确实两两互质：$\\gcd(3, 11)=1$，$\\gcd(3, 17)=1$，以及 $\\gcd(11, 17)=1$。因此，使用 CRT 是合理的。\n\n我们需要求解一个变量，称之为 $x$，使得 $x \\equiv 2^{560} \\pmod{561}$。这等价于求解以下同余方程组：\n$$\n\\begin{cases}\nx \\equiv 2^{560} \\pmod{3} \\\\\nx \\equiv 2^{560} \\pmod{11} \\\\\nx \\equiv 2^{560} \\pmod{17}\n\\end{cases}\n$$\n\n对于每个同余式，我们将使用费马小定理 (FLT)。该定理指出，如果 $p$ 是一个素数，那么对于任何不能被 $p$ 整除的整数 $a$，我们有 $a^{p-1} \\equiv 1 \\pmod{p}$。该定理是欧拉函数定理在素数模下的直接推论，因为 $\\varphi(p)=p-1$。\n\n我们来解第一个同余式：$x \\equiv 2^{560} \\pmod{3}$。\n模是素数 $p_1=3$。底是 $a=2$。由于 $p_1$ 不能整除 $a$，即 $\\gcd(2, 3) = 1$，因此可以应用 FLT。我们有 $2^{3-1} \\equiv 2^2 \\equiv 4 \\equiv 1 \\pmod{3}$。\n为了简化指数 $560$，我们用 $p_1-1=2$ 去除它。我们发现 $560 = 2 \\times 280$。\n因此，$2^{560} \\equiv (2^2)^{280} \\equiv 1^{280} \\equiv 1 \\pmod{3}$。\n所以，第一个同余式是 $x \\equiv 1 \\pmod{3}$。\n\n接着，我们解第二个同余式：$x \\equiv 2^{560} \\pmod{11}$。\n模是素数 $p_2=11$。底是 $a=2$。由于 $\\gcd(2, 11) = 1$，可以应用 FLT。我们有 $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$。\n我们用 $p_2-1=10$ 去除指数 $560$ 来简化它。我们看到 $560 = 10 \\times 56$。\n因此，$2^{560} \\equiv (2^{10})^{56} \\equiv 1^{56} \\equiv 1 \\pmod{11}$。\n所以，第二个同余式是 $x \\equiv 1 \\pmod{11}$。\n\n最后，我们解第三个同余式：$x \\equiv 2^{560} \\pmod{17}$。\n模是素数 $p_3=17$。底是 $a=2$。由于 $\\gcd(2, 17) = 1$，可以应用 FLT。我们有 $2^{17-1} \\equiv 2^{16} \\equiv 1 \\pmod{17}$。\n我们用 $p_3-1=16$ 去除指数 $560$ 来简化它。我们发现 $560 = 16 \\times 35$。\n因此，$2^{560} \\equiv (2^{16})^{35} \\equiv 1^{35} \\equiv 1 \\pmod{17}$。\n所以，第三个同余式是 $x \\equiv 1 \\pmod{17}$。\n\n我们现在得到了简化的同余方程组：\n$$\n\\begin{cases}\nx \\equiv 1 \\pmod{3} \\\\\nx \\equiv 1 \\pmod{11} \\\\\nx \\equiv 1 \\pmod{17}\n\\end{cases}\n$$\n从这个方程组可以明显看出，$x=1$ 是一个解。根据中国剩余定理，对于模 $3 \\times 11 \\times 17 = 561$，存在唯一的解 $x$。由于 $x=1$ 是一个有效的解，它必定是 $0 \\leq x  561$ 范围内的唯一解。因此，$x \\equiv 1 \\pmod{561}$。\n\n因此，我们所求的余数 $r$ 是 $r=1$。所以，$2^{560} \\equiv 1 \\pmod{561}$。\n\n现在我们来解决问题的第二部分。对于一个整数 $n$ 和一个底数 $a$ 的费马素性检验，是检查在 $\\gcd(a, n)=1$ 的前提下，同余式 $a^{n-1} \\equiv 1 \\pmod{n}$ 是否成立。\n对于 $n=561$ 和 $a=2$，我们必须检查 $2^{561-1} \\equiv 1 \\pmod{561}$ 是否成立。这正是同余式 $2^{560} \\equiv 1 \\pmod{561}$。\n条件 $\\gcd(a, n) = \\gcd(2, 561)$ 是满足的，因为 $561$ 的素因数是 $3$、$11$ 和 $17$，其中没有一个是 $2$。\n我们的计算已经表明 $2^{560} \\equiv 1 \\pmod{561}$。\n由于该同余式成立，我们得出结论：合数 $n=561$ 通过了以 $2$ 为底的费马素性检验。这样的合数被称为以 $2$ 为底的费马伪素数。\n\n问题要求余数 $r$。我们的结果是 $r=1$。", "answer": "$$\\boxed{1}$$", "id": "3091021"}, {"introduction": "索洛维-施特拉森检验通过引入雅可比符号，在欧拉准则的基础上增加了一个更严格的条件，从而改进了费马检验。本练习将重新审视之前通过了费马检验的数 $n=341$。通过计算并比较 $a^{\\frac{n-1}{2}} \\pmod n$ 与雅可比符号 $\\left(\\frac{a}{n}\\right)$ 的值，你将亲眼见证这个增强的检验方法如何成功地识别出费马伪素数的合数本质 [@problem_id:3090968]。", "problem": "设 $n=341$ 且 $a=2$。从勒让德符号 $\\left(\\frac{a}{p}\\right)$、雅可比符号 $\\left(\\frac{a}{n}\\right)$、针对素数的欧拉准则以及索洛维-施特拉森素性检验的结构出发，计算 $a^{\\frac{n-1}{2}} \\bmod n$ 和 $\\left(\\frac{a}{n}\\right)$，并判断根据以 $a$ 为底的索洛维-施特拉森素性检验，$n$ 是否会被分类为可能素数。根据需要，仅使用模算术、二次剩余和中国剩余定理（CRT）等公认的性质；除这些基础知识外，不要假定任何特定于检验的快捷方法。\n\n明确要求：\n- 计算 $2^{170} \\bmod 341$。\n- 计算雅可比符号 $\\left(\\frac{2}{341}\\right)$。\n- 根据索洛维-施特拉森素性检验的定义准则，判断 $341$ 是否通过以 $2$ 为底的检验。\n\n将你的最终答案表示为单行矩阵 $\\begin{pmatrix} x  y  S \\end{pmatrix}$，其中 $x=2^{170} \\bmod 341$，$y=\\left(\\frac{2}{341}\\right)$，如果 $341$ 通过以 $2$ 为底的索洛维-施特拉森检验，则 $S$ 等于 $1$，否则等于 $0$。无需四舍五入。", "solution": "该问题要求我们对整数 $n=341$ 和底 $a=2$ 执行索洛维-施特拉森素性检验的步骤。该检验基于欧拉准则，对于素数 $p$，欧拉准则指出 $a^{\\frac{p-1}{2}} \\equiv \\left(\\frac{a}{p}\\right) \\pmod{p}$。索洛维-施特拉森素性检验检查此同余式对于给定的整数 $n$ 和底 $a$ 是否成立，即 $a^{\\frac{n-1}{2}} \\equiv \\left(\\frac{a}{n}\\right) \\pmod{n}$ 是否成立，其中 $\\left(\\frac{a}{n}\\right)$ 是雅可比符号。我们被要求分别计算此同余式的两边，然后做出判断。\n\n三个具体任务是：\n1. 计算 $x = 2^{170} \\bmod 341$，其中指数为 $\\frac{n-1}{2} = \\frac{341-1}{2} = 170$。\n2. 计算雅可比符号 $y = \\left(\\frac{2}{341}\\right)$。\n3. 确定 $S$，如果 $341$ 通过检验（即 $x \\equiv y \\pmod{341}$），则 $S=1$，否则 $S=0$。\n\n首先，我们求出模数 $n=341$ 的素因数分解。我们可以测试小的素因数。$341$ 不能被 $2$、$3$ 或 $5$ 整除。对于 $7$，$341 = 48 \\times 7 + 5$。对于 $11$，$341 = 11 \\times 31$。因为 $11$ 和 $31$ 都是素数，所以分解式为 $n = 11 \\times 31$。\n\n**第1部分：计算 $x = 2^{170} \\bmod 341$**\n\n为了计算 $2^{170} \\bmod 341$，我们可以使用中国剩余定理（CRT）。我们将分别计算模 $11$ 和模 $31$ 的值。\n\n模 $11$：\n根据费马小定理（FLT），因为 $11$ 是一个素数且 $11$ 不整除 $2$，我们有 $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$。\n我们可以用 $10$ 来表示指数 $170$：$170 = 17 \\times 10$。\n因此，$2^{170} = 2^{17 \\times 10} = (2^{10})^{17}$。\n对此取模 $11$，我们得到：\n$2^{170} \\equiv (1)^{17} \\equiv 1 \\pmod{11}$。\n\n模 $31$：\n同样，根据费马小定理，因为 $31$ 是一个素数且 $31$ 不整除 $2$，我们有 $2^{31-1} \\equiv 2^{30} \\equiv 1 \\pmod{31}$。\n我们也可以用一个更小的 $2$ 的幂来计算。我们注意到 $2^5 = 32 \\equiv 1 \\pmod{31}$。\n指数是 $170$。我们可以用 $5$ 来表示 $170$：$170 = 5 \\times 34$。\n所以，$2^{170} = (2^5)^{34}$。\n对此取模 $31$：\n$2^{170} \\equiv (1)^{34} \\equiv 1 \\pmod{31}$。\n\n使用中国剩余定理合并结果：\n我们有关于 $x = 2^{170}$ 的以下同余方程组：\n$$x \\equiv 1 \\pmod{11}$$\n$$x \\equiv 1 \\pmod{31}$$\n由于 $x$ 除以 $11$ 和 $31$ 的余数都是 $1$，且 $\\gcd(11, 31)=1$，因此 $x$ 除以它们的乘积 $11 \\times 31 = 341$ 的余数必须是 $1$。\n因此，$x \\equiv 1 \\pmod{341}$。\n$2^{170} \\bmod 341$ 的值是 $1$。所以，$x = 1$。\n\n**第2部分：计算雅可比符号 $y = \\left(\\frac{2}{341}\\right)$**\n\n对于合数的奇整数 $n = p_1^{k_1} p_2^{k_2} \\cdots p_m^{k_m}$，雅可比符号 $\\left(\\frac{a}{n}\\right)$ 定义为勒让德符号的乘积：\n$$\\left(\\frac{a}{n}\\right) = \\left(\\frac{a}{p_1}\\right)^{k_1} \\left(\\frac{a}{p_2}\\right)^{k_2} \\cdots \\left(\\frac{a}{p_m}\\right)^{k_m}$$\n对于 $n=341 = 11 \\times 31$，雅可比符号是：\n$$\\left(\\frac{2}{341}\\right) = \\left(\\frac{2}{11}\\right) \\left(\\frac{2}{31}\\right)$$\n我们使用二次互反律的第二补充定律，该定律指出对于任何奇素数 $p$，勒让德符号 $\\left(\\frac{2}{p}\\right)$ 由下式给出：\n$$\\left(\\frac{2}{p}\\right) = (-1)^{\\frac{p^2-1}{8}}$$\n这意味着如果 $p \\equiv 1$ 或 $7 \\pmod{8}$，则 $\\left(\\frac{2}{p}\\right) = 1$；如果 $p \\equiv 3$ 或 $5 \\pmod{8}$，则 $\\left(\\frac{2}{p}\\right) = -1$。\n\n对于 $p=11$：\n$11 \\pmod{8} = 3$。\n因此，$\\left(\\frac{2}{11}\\right) = -1$。\n\n对于 $p=31$：\n$31 = 3 \\times 8 + 7$，所以 $31 \\pmod{8} = 7$。\n因此，$\\left(\\frac{2}{31}\\right) = 1$。\n\n现在，我们将这些值相乘以求得雅可比符号：\n$$y = \\left(\\frac{2}{341}\\right) = \\left(\\frac{2}{11}\\right) \\left(\\frac{2}{31}\\right) = (-1) \\times (1) = -1$$\n所以，$y = -1$。\n\n**第3部分：基于索洛维-施特拉森素性检验的判定**\n\n索洛维-施特拉森素性检验检查以下同余式是否成立：\n$$a^{\\frac{n-1}{2}} \\equiv \\left(\\frac{a}{n}\\right) \\pmod{n}$$\n对于 $n=341$ 和 $a=2$，我们必须检查 $2^{170} \\equiv \\left(\\frac{2}{341}\\right) \\pmod{341}$ 是否成立。\n根据我们之前的计算，我们有：\n- 左边是 $2^{170} \\bmod 341 = 1$。\n- 右边是 $\\left(\\frac{2}{341}\\right) = -1$。\n\n因此，需要检查的同余式是：\n$$1 \\equiv -1 \\pmod{341}$$\n这等价于 $2 \\equiv 0 \\pmod{341}$，这意味着 $341$ 必须整除 $2$。这是错误的。\n由于 $1 \\not\\equiv -1 \\pmod{341}$，该同余式不成立。\n因此，数 $n=341$ 未能通过以 $a=2$ 为底的索洛维-施特拉森检验，并被此检验判定为合数。$S$ 的值为 $0$。\n\n总结一下，我们得到：\n- $x = 2^{170} \\bmod 341 = 1$。\n- $y = \\left(\\frac{2}{341}\\right) = -1$。\n- $S = 0$，因为 $1 \\not\\equiv -1 \\pmod{341}$。\n\n最终答案应表示为单行矩阵 $\\begin{pmatrix} x  y  S \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 1  -1  0 \\end{pmatrix}}$$", "id": "3090968"}]}