{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲自动手实践。第一个练习将带你从零开始，手动构建斯特恩-布罗科特树的最初几层。通过计算中间分数并将其插入序列，你将直观地感受到树的生长过程，并验证相邻分数对所满足的一个优美的不变性——行列式条件 $ad - bc = 1$。这个练习是理解该树所有后续性质的基石。[@problem_id:3093491]", "problem": "考虑由最简有理数构成的斯特恩-布罗科特树。从按降序排列的哨兵分数 $\\frac{1}{0}$ 和 $\\frac{0}{1}$ 开始，定义两个分数 $\\frac{a}{b}$ 和 $\\frac{c}{d}$ 的中间分数为 $\\frac{a+c}{b+d}$。在斯特恩-布罗科特构造中，每一后继层都是通过在前一层中每对相邻的分数 $\\frac{a}{b}$ 和 $\\frac{c}{d}$ 之间插入唯一的中间分数 $\\frac{a+c}{b+d}$ 来获得的，并保持序列的降序排列。\n\n对于本问题，定义第0层为由两个哨兵分数组成的行 $\\left(\\frac{1}{0}, \\frac{0}{1}\\right)$。对于每个整数 $n \\geq 1$，通过在第 $n-1$ 层的每对相邻分数之间插入中间分数来定义第 $n$ 层，得到的行仍然按降序排列。\n\n任务：\n- 按降序明确地构造斯特恩-布罗科特树的第0、1、2、3和4层。\n- 仅使用中间分数的定义和整数算术的基本性质，验证对于在任何这些构造的层中出现的每一对满足 $\\frac{a}{b} > \\frac{c}{d}$ 的相邻分数 $\\left(\\frac{a}{b}, \\frac{c}{d}\\right)$，行列式条件 $ad - bc = 1$ 都成立。\n- 设 $S$ 为对第4层中所有相邻对的量 $ad - bc$ 的总和。计算 $S$。\n\n请用一个精确数表示你的最终答案。无需四舍五入。", "solution": "该问题要求我们构造斯特恩-布罗科特树的初始几层，验证其相邻分数的一个基本性质，并基于此性质计算一个总和。我们将依次解决每个任务。\n\n斯特恩-布罗科特树的构造始于哨兵分数 $\\frac{1}{0}$ 和 $\\frac{0}{1}$。第 $n$ 层是通过在第 $n-1$ 层的每对相邻分数 $\\frac{a}{b}$ 和 $\\frac{c}{d}$ 之间插入中间分数 $\\frac{a+c}{b+d}$ 生成的。\n\n**任务1：构造第0层到第4层**\n\n第0层是给定的初始哨兵对。\n第0层：$\\left( \\frac{1}{0}, \\frac{0}{1} \\right)$\n\n第1层是通过插入第0层中那对分数的中间分数形成的。$\\left(\\frac{1}{0}, \\frac{0}{1}\\right)$ 的中间分数是 $\\frac{1+0}{0+1} = \\frac{1}{1}$。\n第1层：$\\left( \\frac{1}{0}, \\frac{1}{1}, \\frac{0}{1} \\right)$\n\n第2层是通过在第1层的相邻对之间插入中间分数形成的。\n这些对是 $\\left(\\frac{1}{0}, \\frac{1}{1}\\right)$ 和 $\\left(\\frac{1}{1}, \\frac{0}{1}\\right)$。\n$\\left(\\frac{1}{0}, \\frac{1}{1}\\right)$ 的中间分数是 $\\frac{1+1}{0+1} = \\frac{2}{1}$。\n$\\left(\\frac{1}{1}, \\frac{0}{1}\\right)$ 的中间分数是 $\\frac{1+0}{1+1} = \\frac{1}{2}$。\n按顺序插入这些分数得到：\n第2层：$\\left( \\frac{1}{0}, \\frac{2}{1}, \\frac{1}{1}, \\frac{1}{2}, \\frac{0}{1} \\right)$\n\n第3层由第2层的相邻对形成。\n各对分数及其中间分数是：\n$\\left(\\frac{1}{0}, \\frac{2}{1}\\right) \\to \\frac{1+2}{0+1} = \\frac{3}{1}$\n$\\left(\\frac{2}{1}, \\frac{1}{1}\\right) \\to \\frac{2+1}{1+1} = \\frac{3}{2}$\n$\\left(\\frac{1}{1}, \\frac{1}{2}\\right) \\to \\frac{1+1}{1+2} = \\frac{2}{3}$\n$\\left(\\frac{1}{2}, \\frac{0}{1}\\right) \\to \\frac{1+0}{2+1} = \\frac{1}{3}$\n第3层：$\\left( \\frac{1}{0}, \\frac{3}{1}, \\frac{2}{1}, \\frac{3}{2}, \\frac{1}{1}, \\frac{2}{3}, \\frac{1}{2}, \\frac{1}{3}, \\frac{0}{1} \\right)$\n\n第4层由第3层的相邻对形成。\n各对分数及其中间分数是：\n$\\left(\\frac{1}{0}, \\frac{3}{1}\\right) \\to \\frac{4}{1}$, $\\left(\\frac{3}{1}, \\frac{2}{1}\\right) \\to \\frac{5}{2}$, $\\left(\\frac{2}{1}, \\frac{3}{2}\\right) \\to \\frac{5}{3}$, $\\left(\\frac{3}{2}, \\frac{1}{1}\\right) \\to \\frac{4}{3}$\n$\\left(\\frac{1}{1}, \\frac{2}{3}\\right) \\to \\frac{3}{4}$, $\\left(\\frac{2}{3}, \\frac{1}{2}\\right) \\to \\frac{3}{5}$, $\\left(\\frac{1}{2}, \\frac{1}{3}\\right) \\to \\frac{2}{5}$, $\\left(\\frac{1}{3}, \\frac{0}{1}\\right) \\to \\frac{1}{4}$\n第4层：$\\left( \\frac{1}{0}, \\frac{4}{1}, \\frac{3}{1}, \\frac{5}{2}, \\frac{2}{1}, \\frac{5}{3}, \\frac{3}{2}, \\frac{4}{3}, \\frac{1}{1}, \\frac{3}{4}, \\frac{2}{3}, \\frac{3}{5}, \\frac{1}{2}, \\frac{2}{5}, \\frac{1}{3}, \\frac{1}{4}, \\frac{0}{1} \\right)$\n\n**任务2：验证行列式条件**\n\n我们必须验证，在任何已构造的层中，对于任何满足 $\\frac{a}{b} > \\frac{c}{d}$ 的相邻分数对 $\\left(\\frac{a}{b}, \\frac{c}{d}\\right)$，条件 $ad - bc = 1$ 都成立。我们将通过对层数 $n$ 进行数学归纳来证明这个性质对所有层都成立。\n\n设 $P(n)$ 为命题：对于第 $n$ 层中的任何相邻对 $\\left(\\frac{a}{b}, \\frac{c}{d}\\right)$，有 $ad - bc = 1$。\n\n归纳基础：$n=0$。\n第0层包含唯一的相邻对 $\\left(\\frac{1}{0}, \\frac{0}{1}\\right)$。这里，$a=1, b=0, c=0, d=1$。\n行列式为 $ad - bc = (1)(1) - (0)(0) = 1$。\n因此，$P(0)$ 为真。\n\n归纳步骤：假设对于某个整数 $k \\geq 0$，$P(k)$ 为真。这意味着对于第 $k$ 层中的任何相邻对 $\\left(\\frac{a}{b}, \\frac{c}{d}\\right)$，我们有 $ad - bc = 1$。\n现在我们必须证明 $P(k+1)$ 为真。\n第 $k+1$ 层是由第 $k$ 层构造的。第 $k+1$ 层中的任何相邻对要么是 $\\left(\\frac{a}{b}, \\frac{a+c}{b+d}\\right)$ 形式，要么是 $\\left(\\frac{a+c}{b+d}, \\frac{c}{d}\\right)$ 形式，其中 $\\left(\\frac{a}{b}, \\frac{c}{d}\\right)$ 是第 $k$ 层中的一个相邻对，而 $\\frac{a+c}{b+d}$ 是它们的中间分数。\n\n情况1：考虑分数对 $\\left(\\frac{a}{b}, \\frac{a+c}{b+d}\\right)$。新的分数为 $\\frac{a'}{b'} = \\frac{a}{b}$ 和 $\\frac{c'}{d'} = \\frac{a+c}{b+d}$。\n行列式为 $a'd' - b'c' = a(b+d) - b(a+c) = ab + ad - ab - bc = ad - bc$。\n根据归纳假设，$ad - bc = 1$。所以，$a'd' - b'c' = 1$。\n\n情况2：考虑分数对 $\\left(\\frac{a+c}{b+d}, \\frac{c}{d}\\right)$。新的分数为 $\\frac{a''}{b''} = \\frac{a+c}{b+d}$ 和 $\\frac{c''}{d''} = \\frac{c}{d}$。\n行列式为 $a''d'' - b''c'' = (a+c)d - (b+d)c = ad + cd - bc - dc = ad - bc$。\n根据归纳假设，$ad - bc = 1$。所以，$a''d'' - b''c'' = 1$。\n\n在这两种情况下，第 $k+1$ 层中形成的任何新的相邻对都满足行列式条件。由于这对第 $k$ 层中的任何一对都成立，因此它对第 $k+1$ 层中的所有新对都成立。\n因此，根据数学归纳法原理，对于斯特恩-布罗科特树构造的所有层 $n \\geq 0$ 中的所有相邻对，性质 $ad - bc = 1$ 都为真。这严格验证了对于明确构造的第0、1、2、3和4层，该条件成立。\n\n**任务3：计算总和 $S$**\n\n量 $S$ 定义为对第4层中所有相邻对的 $ad - bc$ 求和。\n首先，让我们确定第4层中相邻对的数量。\n设 $T_n$ 为第 $n$ 层中分数的数量。\n$T_0 = 2$。\n$T_1 = 3$。\n$T_2 = 5$。\n$T_3 = 9$。\n$T_4 = 17$。\n第 $n$ 层中分数的数量是 $T_n = 2^n + 1$。\n第 $n$ 层中相邻对的数量是 $T_n - 1$。\n对于第4层，相邻对的数量是 $T_4 - 1 = (2^4 + 1) - 1 = 16$。\n\n从任务2中，我们已经证明对于任何层中的每一对相邻分数 $\\left(\\frac{a}{b}, \\frac{c}{d}\\right)$，量 $ad - bc$ 等于1。这对第4层中的所有16个相邻对都成立。\n\n总和 $S$ 是对第4层中所有相邻对的这些量求和。\n$$S = \\sum_{\\text{第4层中的相邻对}} (ad - bc)$$\n由于有16个这样的对，并且每对的项的值都是1，所以总和是：\n$$S = \\underbrace{1 + 1 + \\dots + 1}_{16 \\text{ 个}}$$\n$$S = 16 \\times 1 = 16$$\n总和 $S$ 是16。", "answer": "$$\\boxed{16}$$", "id": "3093491"}, {"introduction": "在熟悉了树的基本构造后，我们将引入一种更强大、更抽象的工具来探索它。这个练习将引导你为在树中的“左行”($L$) 和“右行”($R$) 寻找一个矩阵表示。你会发现，这些简单的导航步骤可以被优雅地编码为 $2 \\times 2$ 矩阵的乘法，这为在树中定位任意有理数提供了一条高效的代数路径。[@problem_id:3093485]", "problem": "考虑斯特恩-布罗科特树，它是通过从法里邻项的有序对 $0/1$ 和 $1/0$ 开始，迭代地插入中间分数而构造的。对于任何法里邻项的有序对 $a/b$ 和 $c/d$（使得 $ad-bc=1$），中间分数定义为 $(a+c)/(b+d)$。字母表 $\\{L,R\\}$ 中的一个有限词编码了相对于当前中间分数的一系列向左或向右的决策：字母 $L$ 表示用当前中间分数替换右邻项，字母 $R$ 表示用当前中间分数替换左邻项。一个词所代表的分数是在处理完所有字母后得到的最终中间分数，从初始邻项 $0/1$ 和 $1/0$ 开始。\n\n从中间分数的基本定义和法里邻项的不变量 $ad-bc=1$ 出发，完成以下任务：\n\n1. 推导一个 $2\\times 2$ 矩阵公式，用于在一步左移 $L$ 和一步右移 $R$ 下更新有序邻项对。将当前邻项 $a/b$ 和 $c/d$ 表示为矩阵 $\\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix}$ 的列，并将 $L$ 和 $R$ 的更新表示为右乘具有整数元素且行列式为 $1$ 的固定 $2\\times 2$ 矩阵。\n\n2. 使用你推导出的矩阵和初始邻项矩阵 $\\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$，计算由词 $LRRLLR$ 所代表的分数。\n\n3. 从初始邻项 $0/1$ 和 $1/0$ 开始，通过执行由相同词所指示的直接中间分数迭代来验证你的结果。\n\n将你的最终答案以单个最简分数 $p/q$ 的形式给出。不需要四舍五入，也不涉及单位。", "solution": "该问题要求推导斯特恩-布罗科特树构造步骤的矩阵表示，使用该形式计算一个特定分数，并通过直接迭代进行验证。\n\n首先，我将验证问题陈述。\n问题定义了斯特恩-布罗科特树的构造过程，从邻项对 $0/1$ 和 $1/0$ 开始。它将一对 $a/b$ 和 $c/d$ 的中间分数定义为 $(a+c)/(b+d)$。它定义了左移（$L$）和右移（$R$）的更新规则。任务是将这些更新形式化为矩阵运算，将其应用于给定的词，并验证结果。这些定义和运算在数学上是明确定义的，并且是数论和有理数枚举研究中的标准内容。问题陈述对于法莱邻项 $a/b$ 和 $c/d$ 有 $ad-bc=1$。然而，对于初始对 $(a/b, c/d) = (0/1, 1/0)$，我们有 $a=0, b=1, c=1, d=0$，这给出 $ad-bc = 0 \\cdot 0 - 1 \\cdot 1 = -1$。这是问题陈述的定义与其初始条件之间的一个小不一致。然而，所描述的过程是自洽的。在给定的 $L$ 和 $R$ 操作下，$ad-bc=-1$ 这个性质是不变的。这个小错误不会使问题无效，因为计算过程是明确的。该问题具有科学依据，提法恰当，且客观。因此，它被认为是有效的。\n\n第1部分：矩阵公式的推导。\n\n设当前有序邻项对为 $a/b$ 和 $c/d$。我们将这对表示为 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix}$ 的列。中间分数是 $m = \\frac{a+c}{b+d}$。\n\n一步左移，记为 $L$，用中间分数 $m$ 替换右邻项 $c/d$。新的邻项对是 $(a/b, (a+c)/(b+d))$。相应的矩阵 $M'$ 为：\n$$ M' = \\begin{pmatrix} a  a+c \\\\ b  b+d \\end{pmatrix} $$\n我们寻找一个矩阵 $U_L$ 使得 $M' = M U_L$。\n$$ \\begin{pmatrix} a  a+c \\\\ b  b+d \\end{pmatrix} = \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix} U_L $$\n通过观察， $M'$ 的第一列是 $M$ 的第一列， $M'$ 的第二列是 $M$ 的第一列和第二列之和。这个变换可以通过将 $M$ 右乘矩阵 $U_L = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$ 来实现。\n$$ \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} a \\cdot 1 + c \\cdot 0  a \\cdot 1 + c \\cdot 1 \\\\ b \\cdot 1 + d \\cdot 0  b \\cdot 1 + d \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} a  a+c \\\\ b  b+d \\end{pmatrix} = M' $$\n$U_L$ 的行列式是 $1 \\cdot 1 - 1 \\cdot 0 = 1$。\n\n一步右移，记为 $R$，用中间分数 $m$ 替换左邻项 $a/b$。新的邻项对是 $((a+c)/(b+d), c/d)$。相应的矩阵 $M''$ 为：\n$$ M'' = \\begin{pmatrix} a+c  c \\\\ b+d  d \\end{pmatrix} $$\n我们寻找一个矩阵 $U_R$ 使得 $M'' = M U_R$。\n$$ \\begin{pmatrix} a+c  c \\\\ b+d  d \\end{pmatrix} = \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix} U_R $$\n这里，$M''$ 的第一列是 $M$ 的各列之和，而 $M''$ 的第二列是 $M$ 的第二列。这可以通过将 $M$ 右乘 $U_R = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}$ 来实现。\n$$ \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} a \\cdot 1 + c \\cdot 1  a \\cdot 0 + c \\cdot 1 \\\\ b \\cdot 1 + d \\cdot 1  b \\cdot 0 + d \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} a+c  c \\\\ b+d  d \\end{pmatrix} = M'' $$\n$U_R$ 的行列式是 $1 \\cdot 1 - 0 \\cdot 1 = 1$。\n因此，左移和右移的矩阵分别是 $U_L = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$ 和 $U_R = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}$。\n\n第2部分：计算词 $LRRLLR$ 对应的分数。\n\n初始邻项对是 $(0/1, 1/0)$，由矩阵 $M_0 = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$ 表示。\n词 $LRRLLR$ 对应于矩阵乘法序列 $U_L, U_R, U_R, U_L, U_L, U_R$。最终的邻项矩阵 $M_f$ 由 $M_f = M_0 P$ 给出，其中 $P$ 是更新矩阵的乘积：\n$$ P = U_L U_R U_R U_L U_L U_R $$\n我们来计算 $P$：\n$ U_L U_R = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  1 \\end{pmatrix} $\n$ (U_L U_R) U_R = \\begin{pmatrix} 2  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 3  1 \\\\ 2  1 \\end{pmatrix} $\n$ (U_L U_R U_R) U_L = \\begin{pmatrix} 3  1 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3  4 \\\\ 2  3 \\end{pmatrix} $\n$ (U_L U_R^2 U_L) U_L = \\begin{pmatrix} 3  4 \\\\ 2  3 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3  7 \\\\ 2  5 \\end{pmatrix} $\n$ P = (U_L U_R^2 U_L^2) U_R = \\begin{pmatrix} 3  7 \\\\ 2  5 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 10  7 \\\\ 7  5 \\end{pmatrix} $\n现在，我们求最终的邻项矩阵 $M_f$：\n$$ M_f = M_0 P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 10  7 \\\\ 7  5 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 10  7 \\end{pmatrix} $$\n$M_f$ 的列代表最终的邻项对，即 $7/10$ 和 $5/7$。\n该词所代表的分数是这对最终邻项的中间分数。设最终邻项对为 $(a_f/b_f, c_f/d_f)$。该分数为 $\\frac{a_f+c_f}{b_f+d_f}$。\n该分数的向量 $\\begin{pmatrix} p \\\\ q \\end{pmatrix}$ 可以通过计算 $M_f \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 得到。\n$$ \\begin{pmatrix} p \\\\ q \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 10  7 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 7+5 \\\\ 10+7 \\end{pmatrix} = \\begin{pmatrix} 12 \\\\ 17 \\end{pmatrix} $$\n分数是 $12/17$。\n\n第3部分：通过直接中间分数迭代进行验证。\n\n我们从邻项 $(a/b, c/d) = (0/1, 1/0)$ 开始。我们处理词 $LRRLLR$。\n\n1.  步骤 $L$：当前中间分数是 $m_1 = \\frac{0+1}{1+0} = 1/1$。新的邻项是 $(0/1, 1/1)$。\n2.  步骤 $R$：当前中间分数是 $m_2 = \\frac{0+1}{1+1} = 1/2$。新的邻项是 $(1/2, 1/1)$。\n3.  步骤 $R$：当前中间分数是 $m_3 = \\frac{1+1}{2+1} = 2/3$。新的邻项是 $(2/3, 1/1)$。\n4.  步骤 $L$：当前中间分数是 $m_4 = \\frac{2+1}{3+1} = 3/4$。新的邻项是 $(2/3, 3/4)$。\n5.  步骤 $L$：当前中间分数是 $m_5 = \\frac{2+3}{3+4} = 5/7$。新的邻项是 $(2/3, 5/7)$。\n6.  步骤 $R$：当前中间分数是 $m_6 = \\frac{2+5}{3+7} = 7/10$。新的邻项是 $(7/10, 5/7)$。\n\n处理完词 $LRRLLR$ 中的所有字母后，最终的邻项对是 $(7/10, 5/7)$。这与第2部分计算出的矩阵 $M_f$ 的列相匹配。\n问题将词所代表的分数定义为“在处理完所有字母后得到的最终中间分数”。这意味着我们必须计算在所有六个步骤之后得到的最终邻项对的中间分数。\n最终中间分数 = $\\frac{7+5}{10+7} = \\frac{12}{17}$。\n这证实了通过矩阵方法得到的结果。分数 $12/17$ 是最简形式，因为 $17$ 是一个质数，而 $12$ 不是 $17$ 的倍数。", "answer": "$$\\boxed{\\frac{12}{17}}$$", "id": "3093485"}, {"introduction": "本章的最后一个练习将揭示一个深刻而出人意料的联系，它连接了两个看似无关的概念：在斯特恩-布罗科特树中通往一个有理数的路径，以及对该分数分子分母执行欧几里得算法的步骤。通过证明这一对应关系，你将体会到数论中基本思想之间内在的和谐与统一，并从一个全新的视角理解有理数的结构。[@problem_id:3093500]", "problem": "设 $p/q$ 是一个最简正有理数。Stern–Brocot 树是从两个哨兵分数 $0/1$ 和 $1/0$ 开始，通过在相邻的一对分数 $a/b$ 和 $c/d$（其中 $ad-bc=1$）之间反复插入它们的中介分数 $(a+c)/(b+d)$ 而构建的。对于任何目标分数 $p/q$，标准的 Stern–Brocot 搜索从初始边界对 $0/1$ 和 $1/0$ 开始，根据 $p/q$ 是小于还是大于当前的中介分数，向左（记作 $L$）或向右（记作 $R$）移动，直到中介分数等于 $p/q$。这定义了 $p/q$ 的唯一 $L/R$ 路径。\n\n考虑对数对 $(p,q)$ 应用基于减法的欧几里得算法：当 $p \\neq q$ 时，若 $pq$，则将 $(p,q)$ 替换为 $(p-q,q)$ 并记录符号 $R$；若 $qp$，则将 $(p,q)$ 替换为 $(p,q-p)$ 并记录符号 $L$。当 $(p,q)=(1,1)$ 时停止。\n\n任务：\n1. 从基本定义（即 Stern–Brocot 树的中介分数定义和基于减法的欧几里得算法）出发，证明所记录的 $L/R$ 符号的拼接序列，恰好是从 $0/1,1/0$ 到 $p/q$ 的唯一 Stern–Brocot 路径。\n2. 将此应用于 $p/q=36/25$：对 $(36,25)$ 运行基于减法的欧几里得算法，得出 $L/R$ 路径，然后构造一个二进制整数 $N$。$N$ 的二进制表示是这样得到的：首先写一个前导 $1$，然后按路径顺序，遇到 $L$ 写 $0$，遇到 $R$ 写 $1$。计算 $N$ 的十进制整数值。\n\n请给出最终答案，即精确整数 $N$（无需四舍五入）。", "solution": "我们从核心定义开始。Stern–Brocot 树是通过重复插入中介分数生成的。如果 $a/b$ 和 $c/d$ 是按递增顺序排列的相邻分数（即 $bc-ad=1$），那么它们的中介分数是 $(a+c)/(b+d)$，并且它严格位于 $a/b$ 和 $c/d$ 之间。对目标分数 $p/q$ 的 Stern–Brocot 搜索从边界邻居 $0/1$ 和 $1/0$ 开始，并迭代地将 $p/q$ 与当前邻居的中介分数进行比较。如果 $p/q$ 小于中介分数，我们向左移动（$L$），用中介分数替换右邻居；如果 $p/q$ 大于中介分数，我们向右移动（$R$），用中介分数替换左邻居。这个过程会在有限步内终止于 $p/q$，因为 $p/q$ 有一个有限的简单连分数展开。\n\n我们现在来证明，对 $(p,q)$ 应用基于减法的欧几里得算法所记录的 $L/R$ 符号与 Stern–Brocot 搜索路径一致。\n该证明可以通过递归和坐标变换来建立。\n1.  **基本情况**：对于分数 $1/1$，基于减法的欧几里得算法在 $(1,1)$ 处立即停止，生成空路径。Stern-Brocot 搜索从 $(0/1, 1/0)$ 开始，其中介分数为 $1/1$，立即找到目标，也生成空路径。\n2.  **递归步骤**：\n    *   **情况 1：$p/q > 1$**\n        *   **SB 搜索**：由于 $p/q > 1/1$（初始中介数），第一步是向右移动（$R$）。搜索现在在区间 $(1/1, 1/0)$ 中继续。通过坐标变换 $f(x) = 1/(x-1)$，可以将区间 $(1, \\infty)$ 映射回 $(0, \\infty)$。对 $p/q$ 的进一步搜索等价于对 $1/((p/q)-1) = q/(p-q)$ 进行新的搜索。\n        *   **欧几里得算法**：由于 $p>q$，第一步是从 $(p,q)$ 变为 $(p-q, q)$，并记录一个 $R$。算法的其余部分应用于 $(p-q, q)$。\n        *   **比较**：SB 搜索的路径是 $R$ 加上对 $q/(p-q)$ 的路径。欧几里得算法的路径是 $R$ 加上对 $(p-q, q)$ 的路径。由于 $q$ 和 $p-q$ 分别对应新分数的分子和分母，这两个递归是等价的。\n    *   **情况 2：$p/q  1$**\n        *   **SB 搜索**：由于 $p/q  1/1$，第一步是向左移动（$L$）。搜索现在在区间 $(0/1, 1/1)$ 中继续。通过坐标变换 $g(x) = x/(1-x)$，可以将区间 $(0, 1)$ 映射回 $(0, \\infty)$。对 $p/q$ 的进一步搜索等价于对 $(p/q)/(1-p/q) = p/(q-p)$ 进行新的搜索。\n        *   **欧几里得算法**：由于 $q>p$，第一步是从 $(p,q)$ 变为 $(p, q-p)$，并记录一个 $L$。算法的其余部分应用于 $(p, q-p)$。\n        *   **比较**：SB 搜索的路径是 $L$ 加上对 $p/(q-p)$ 的路径。欧几里得算法的路径是 $L$ 加上对 $(p, q-p)$ 的路径。这两个递归同样是等价的。\n\n通过数学归纳法，我们可以得出结论，对于任何最简正有理数 $p/q$，两个过程生成的 $L/R$ 序列是相同的。\n\n现在，我们将此算法应用于 $p/q = 36/25$。\n这是一个 $p>q$ 的情况。\n1.  $(36, 25) \\to p>q \\implies (36-25, 25) = (11, 25)$，记录 $R$。\n2.  $(11, 25) \\to q>p \\implies (11, 25-11) = (11, 14)$，记录 $L$。\n3.  $(11, 14) \\to q>p \\implies (11, 14-11) = (11, 3)$，记录 $L$。\n4.  $(11, 3) \\to p>q \\implies (11-3, 3) = (8, 3)$，记录 $R$。\n5.  $(8, 3) \\to p>q \\implies (8-3, 3) = (5, 3)$，记录 $R$。\n6.  $(5, 3) \\to p>q \\implies (5-3, 3) = (2, 3)$，记录 $R$。\n7.  $(2, 3) \\to q>p \\implies (2, 3-2) = (2, 1)$，记录 $L$。\n8.  $(2, 1) \\to p>q \\implies (2-1, 1) = (1, 1)$，记录 $R$。\n算法在 $(1,1)$ 处停止。\n\n拼接记录的符号，我们得到路径：$RLLRRRLR$。\n\n接下来，我们构造二进制整数 $N$。我们以 $1$ 开头，然后对于路径中的每个 $L$ 附加一个 $0$，对于每个 $R$ 附加一个 $1$。\n路径：$R \\ L \\ L \\ R \\ R \\ R \\ L \\ R$\n二进制位：$1 \\ 0 \\ 0 \\ 1 \\ 1 \\ 1 \\ 0 \\ 1$\n所以，$N$ 的二进制表示是 $110011101_2$。\n\n最后，我们将这个二进制数转换为十进制：\n$N = 1 \\cdot 2^8 + 1 \\cdot 2^7 + 0 \\cdot 2^6 + 0 \\cdot 2^5 + 1 \\cdot 2^4 + 1 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1 \\cdot 2^0$\n$N = 256 + 128 + 0 + 0 + 16 + 8 + 4 + 0 + 1$\n$N = 384 + 28 + 1 = 413$\n\n所以，十进制整数 $N$ 的值是 413。", "answer": "$$\\boxed{413}$$", "id": "3093500"}]}