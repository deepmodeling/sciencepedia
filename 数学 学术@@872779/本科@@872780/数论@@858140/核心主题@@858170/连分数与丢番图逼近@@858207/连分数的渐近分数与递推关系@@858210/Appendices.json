{"hands_on_practices": [{"introduction": "连分数收敛项的分子($p_n$)和分母($q_n$)的递推关系是连分数理论的计算引擎。第一个练习将引导你从第一性原理出发，推导这些基本公式。通过将其应用于一个具体的例子[@problem_id:3088734]，你将亲手实践这一算法，并验证一个支撑收敛项许多深层性质的基本恒等式，从而熟练掌握其核心机制。", "problem": "令 $[a_0; a_1, a_2, \\dots, a_n]$ 表示一个具有整数部分商的简单连分数，并令其第 $n$ 个渐近分数为 $\\frac{p_n}{q_n}$，此为最简分数且 $q_n  0$。从简单连分数的定义以及渐近分数作为在深度 $n$ 处的截断的定义出发，从第一性原理推导控制连续渐近分数分子 $p_n$ 和分母 $q_n$ 的递推关系。然后将您的推导应用于特定的简单连分数 $[1; 2, 2, 2, 2]$，计算当 $n = 0, 1, 2, 3, 4$ 时的 $p_n$ 和 $q_n$。在每一步 $n \\geq 1$，计算量 $p_n q_{n-1} - p_{n-1} q_n$ 并验证其绝对值为1且符号随 $n$ 交替变化。最后，将第四个渐近分数 $\\frac{p_4}{q_4}$ 的精确值以最简分数形式表示为您的最终答案。不要四舍五入；以一个分子和分母均为整数的最简分数形式报告您的最终答案。", "solution": "该问题要求推导简单连分数渐近分数的分子和分母的递推关系，将这些关系应用于一个具体例子，验证一个基本恒等式，并求出第四个渐近分数的最终值。\n\n首先，我们从第一性原理推导递推关系。\n设一个简单连分数表示为 $[a_0; a_1, a_2, \\dots]$，其中 $a_0$ 是一个整数，对于 $i \\ge 1$，$a_i$ 是正整数。第 $n$ 个渐近分数，记为 $\\frac{p_n}{q_n}$，是有限连分数 $[a_0; a_1, \\dots, a_n]$ 的值。\n\n让我们直接从定义计算前几个渐近分数，以观察一个模式。\n对于 $n=0$：$\\frac{p_0}{q_0} = [a_0] = a_0 = \\frac{a_0}{1}$。我们取 $p_0 = a_0$ 和 $q_0 = 1$。\n对于 $n=1$：$\\frac{p_1}{q_1} = [a_0; a_1] = a_0 + \\frac{1}{a_1} = \\frac{a_0 a_1 + 1}{a_1}$。我们取 $p_1 = a_0 a_1 + 1$ 和 $q_1 = a_1$。\n对于 $n=2$：$\\frac{p_2}{q_2} = [a_0; a_1, a_2] = a_0 + \\frac{1}{a_1 + \\frac{1}{a_2}} = a_0 + \\frac{a_2}{a_1 a_2 + 1} = \\frac{a_0(a_1 a_2 + 1) + a_2}{a_1 a_2 + 1}$。\n我们可以用之前的值来重写分子和分母：\n$p_2 = a_0 a_1 a_2 + a_0 + a_2 = a_2(a_0 a_1 + 1) + a_0 = a_2 p_1 + p_0$。\n$q_2 = a_1 a_2 + 1 = a_2(a_1) + 1 = a_2 q_1 + q_0$。\n\n这表明递推关系为 $p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$，适用于 $n \\ge 2$。为了初始化这些关系，我们为 $n=-1$ 和 $n=-2$ 定义辅助值。一个能使该关系对 $n=0$ 和 $n=1$ 也成立的标准选择是：\n$p_{-2} = 0, q_{-2} = 1$\n$p_{-1} = 1, q_{-1} = 0$\n\n让我们验证这个选择：\n对于 $n=0$：$p_0 = a_0 p_{-1} + p_{-2} = a_0(1) + 0 = a_0$。$q_0 = a_0 q_{-1} + q_{-2} = a_0(0) + 1 = 1$。这是正确的。\n对于 $n=1$：$p_1 = a_1 p_0 + p_{-1} = a_1 a_0 + 1$。$q_1 = a_1 q_0 + q_{-1} = a_1(1) + 0 = a_1$。这也是正确的。\n\n为了从第一性原理为所有 $n \\geq 0$ 建立递推关系，我们可以使用归纳法。我们已经证明了该关系对 $n=0, 1, 2$ 成立。假设它们对所有直到 $n-1$ 的整数都成立。$\\frac{p_{n-1}}{q_{n-1}}$ 的表达式是一个关于 $a_0, \\dots, a_{n-1}$ 的函数。具体来说，$\\frac{p_{n-1}}{q_{n-1}} = \\frac{a_{n-1} p_{n-2} + p_{n-3}}{a_{n-1} q_{n-2} + q_{n-3}}$。\n要得到 $\\frac{p_n}{q_n}$，我们需将最后一个部分商 $a_{n-1}$ 替换为 $a_{n-1} + \\frac{1}{a_n}$：\n$$ \\frac{p_n}{q_n} = \\frac{(a_{n-1} + \\frac{1}{a_n}) p_{n-2} + p_{n-3}}{(a_{n-1} + \\frac{1}{a_n}) q_{n-2} + q_{n-3}} = \\frac{a_n(a_{n-1} p_{n-2} + p_{n-3}) + p_{n-2}}{a_n(a_{n-1} q_{n-2} + q_{n-3}) + q_{n-2}} $$\n根据归纳假设，$p_{n-1} = a_{n-1} p_{n-2} + p_{n-3}$ 且 $q_{n-1} = a_{n-1} q_{n-2} + q_{n-3}$。将这些代入表达式中得到：\n$$ \\frac{p_n}{q_n} = \\frac{a_n p_{n-1} + p_{n-2}}{a_n q_{n-1} + q_{n-2}} $$\n这证实了如果我们定义 $p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$，比值 $\\frac{p_n}{q_n}$ 确实是第 $n$ 个渐近分数。推导到此结束。\n\n接下来，我们计算量 $p_n q_{n-1} - p_{n-1} q_n$。使用递推关系：\n$$ p_n q_{n-1} - p_{n-1} q_n = (a_n p_{n-1} + p_{n-2}) q_{n-1} - p_{n-1} (a_n q_{n-1} + q_{n-2}) $$\n$$ = a_n p_{n-1} q_{n-1} + p_{n-2} q_{n-1} - a_n p_{n-1} q_{n-1} - p_{n-1} q_{n-2} $$\n$$ = p_{n-2} q_{n-1} - p_{n-1} q_{n-2} = -(p_{n-1} q_{n-2} - p_{n-2} q_{n-1}) $$\n这表明该量在每一步都交替变号。为了求其值，我们计算 $n=1$ 时的基本情况：\n$p_1 q_0 - p_0 q_1 = (a_0 a_1 + 1)(1) - (a_0)(a_1) = 1$。\n因此，对于 $n=1$，值为 $1$。对于 $n=2$，值为 $-1$。对于 $n=3$，值为 $1$，以此类推。一般公式为 $p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1}$，适用于 $n \\ge 1$。这证实了该量的绝对值为1且符号交替变化。\n\n现在，我们将这些结果应用于简单连分数 $[1; 2, 2, 2, 2]$。\n部分商为 $a_0 = 1$, $a_1 = 2$, $a_2 = 2$, $a_3 = 2$, $a_4 = 2$。\n我们使用初始值 $p_{-1} = 1$ 和 $q_{-1} = 0$。\n\n对于 $n=0$：\n$p_0 = a_0 = 1$\n$q_0 = 1$\n渐近分数：$\\frac{p_0}{q_0} = \\frac{1}{1}$。\n\n对于 $n=1$：\n$p_1 = a_1 p_0 + p_{-1} = 2(1) + 1 = 3$\n$q_1 = a_1 q_0 + q_{-1} = 2(1) + 0 = 2$\n渐近分数：$\\frac{p_1}{q_1} = \\frac{3}{2}$。\n验证：$p_1 q_0 - p_0 q_1 = (3)(1) - (1)(2) = 1 = (-1)^{1-1}$。这是正确的。\n\n对于 $n=2$：\n$p_2 = a_2 p_1 + p_0 = 2(3) + 1 = 7$\n$q_2 = a_2 q_1 + q_0 = 2(2) + 1 = 5$\n渐近分数：$\\frac{p_2}{q_2} = \\frac{7}{5}$。\n验证：$p_2 q_1 - p_1 q_2 = (7)(2) - (3)(5) = 14 - 15 = -1 = (-1)^{2-1}$。这是正确的。\n\n对于 $n=3$：\n$p_3 = a_3 p_2 + p_1 = 2(7) + 3 = 17$\n$q_3 = a_3 q_2 + q_1 = 2(5) + 2 = 12$\n渐近分数：$\\frac{p_3}{q_3} = \\frac{17}{12}$。\n验证：$p_3 q_2 - p_2 q_3 = (17)(5) - (7)(12) = 85 - 84 = 1 = (-1)^{3-1}$。这是正确的。\n\n对于 $n=4$：\n$p_4 = a_4 p_3 + p_2 = 2(17) + 7 = 34 + 7 = 41$\n$q_4 = a_4 q_3 + q_2 = 2(12) + 5 = 24 + 5 = 29$\n渐近分数：$\\frac{p_4}{q_4} = \\frac{41}{29}$。\n验证：$p_4 q_3 - p_3 q_4 = (41)(12) - (17)(29) = 492 - 493 = -1 = (-1)^{4-1}$。这是正确的。\n\n计算和验证已完成。第四个渐近分数为 $\\frac{p_4}{q_4} = \\frac{41}{29}$。恒等式 $p_4 q_3 - p_3 q_4 = -1$ 意味着 $12 p_4 - 17 q_4 = -1$。根据与贝祖恒等式相关的最大公约数的性质，这个线性组合等于 $-1$ 保证了 $\\text{gcd}(p_4, q_4) = 1$。因此，分数 $\\frac{41}{29}$ 是最简分数。\n\n最终答案是第四个渐近分数的精确值。", "answer": "$$\n\\boxed{\\frac{41}{29}}\n$$", "id": "3088734"}, {"introduction": "掌握了基本的递推关系后，我们现在可以在一个更高级的场景中探索它们的力量：无理数的逼近。这个练习[@problem_id:3020976]将聚焦于二次无理数$\\sqrt{7}$的连分数展开，这是一个经典且重要的例子。你不仅需要计算其收敛项，还将推导并验证其精确的误差界，从而对为何收敛项是“最佳”有理逼近有一个切实的感受。", "problem": "设 $x=\\sqrt{7}$。一个简单连分数是形如 $[a_{0};a_{1},a_{2},\\dots]$ 的表达式，其中 $a_{0}\\in\\mathbb{Z}$ 且当 $k\\geq 1$ 时 $a_{k}\\in\\mathbb{N}$。其第$n$个收敛子是通过在$a_n$后截斷并求值得到的有理数。从这些定义出发（不借助任何预先给出的收敛子递推关系），完成以下任务：\n\n1. 通过对二次无理数应用标准提取程序，确定$x$的最终周期连分数展开式。然后显式计算前六个部分商 $a_{0},a_{1},\\dots,a_{5}$ 以及对应的收敛子 $p_{n}/q_{n}$（对于 $n=0,1,2,3,4,5$）。\n2. 仅使用 $p_{n}/q_{n}$ 是截断 $[a_{0};a_{1},\\dots,a_{n}]$ 这一定义性质，从第一性原理推导恒等式 $p_{n}q_{n-1}-p_{n-1}q_{n}=(-1)^{n-1}$，并用你计算出的数据对 $n=1,2,3,4,5$ 进行数值验证。\n3. 设 $x_{n+1}=[a_{n+1};a_{n+2},\\dots]$ 表示 $a_{n}$ 之后的尾部。从表达 $x$ 与截断 $p_{n}/q_{n}$ 及尾部 $x_{n+1}$ 之间关系的代数关系式出发，推导双边界\n   $$\\frac{1}{(a_{n+1}+2)q_{n}^{2}}\\left|x-\\frac{p_{n}}{q_{n}}\\right|\\frac{1}{a_{n+1}q_{n}^{2}}.$$\n   对你的六个收敛子，数值验证这些不等式。对于所有数值验证，计算至少六位有效数字的小数近似值。\n4. 最后，计算第六个收敛子的缩放误差的精确值：\n   $$E:=q_{5}^{2}\\left|\\,x-\\frac{p_{5}}{q_{5}}\\,\\right|,$$\n   并将其以最简根式形式表示为单个封闭形式表达式。\n\n你最终报告的答案必须是你为 $E$ 获得的单个精确表达式（无小数近似值，无单位）。", "solution": "这个问题定义明確，其基础是数论中关于连分数的原理。我们将给出一个完整的解答。\n\n第一个任务是确定 $x=\\sqrt{7}$ 的连分数展开式，并计算前六个部分商和收敛子。我们使用标准算法：设 $x_0 = x$，对于 $n \\ge 0$，定义 $a_n = \\lfloor x_n \\rfloor$ 和 $x_{n+1} = \\frac{1}{x_n - a_n}$。\n\n对于 $x = \\sqrt{7}$：\n-   $x_0 = \\sqrt{7}$。因为 $2^2=4$ 且 $3^2=9$，我们有 $2  \\sqrt{7}  3$，所以 $a_0 = \\lfloor \\sqrt{7} \\rfloor = 2$。\n-   $x_1 = \\frac{1}{x_0 - a_0} = \\frac{1}{\\sqrt{7}-2} = \\frac{\\sqrt{7}+2}{7-4} = \\frac{\\sqrt{7}+2}{3}$。因为 $4  \\sqrt{7}+2  5$，我们有 $\\frac{4}{3}  x_1  \\frac{5}{3}$，所以 $a_1 = \\lfloor x_1 \\rfloor = 1$。\n-   $x_2 = \\frac{1}{x_1 - a_1} = \\frac{1}{\\frac{\\sqrt{7}+2}{3}-1} = \\frac{3}{\\sqrt{7}-1} = \\frac{3(\\sqrt{7}+1)}{7-1} = \\frac{\\sqrt{7}+1}{2}$。因为 $3  \\sqrt{7}+1  4$，我们有 $\\frac{3}{2}  x_2  2$，所以 $a_2 = \\lfloor x_2 \\rfloor = 1$。\n-   $x_3 = \\frac{1}{x_2 - a_2} = \\frac{1}{\\frac{\\sqrt{7}+1}{2}-1} = \\frac{2}{\\sqrt{7}-1} = \\frac{2(\\sqrt{7}+1)}{7-1} = \\frac{\\sqrt{7}+1}{3}$。因为 $3  \\sqrt{7}+1  4$，我们有 $1  x_3  \\frac{4}{3}$，所以 $a_3 = \\lfloor x_3 \\rfloor = 1$。\n-   $x_4 = \\frac{1}{x_3 - a_3} = \\frac{1}{\\frac{\\sqrt{7}+1}{3}-1} = \\frac{3}{\\sqrt{7}-2} = \\frac{3(\\sqrt{7}+2)}{7-4} = \\sqrt{7}+2$。所以 $a_4 = \\lfloor \\sqrt{7}+2 \\rfloor = 2+2=4$。\n-   $x_5 = \\frac{1}{x_4 - a_4} = \\frac{1}{(\\sqrt{7}+2)-4} = \\frac{1}{\\sqrt{7}-2} = x_1$。\n因为 $x_5 = x_1$，部分商序列从$a_1$开始是周期的。$\\sqrt{7}$ 的连分数展开式为 $[2;\\overline{1,1,1,4}]$。\n\n前六个部分商是 $a_0=2$, $a_1=1$, $a_2=1$, $a_3=1$, $a_4=4$, $a_5=1$。\n对应的收敛子 $p_n/q_n = [a_0; a_1, \\dots, a_n]$ 计算如下：\n-   $n=0$: $\\frac{p_0}{q_0} = [2] = \\frac{2}{1}$。\n-   $n=1$: $\\frac{p_1}{q_1} = [2;1] = 2+\\frac{1}{1} = \\frac{3}{1}$。\n-   $n=2$: $\\frac{p_2}{q_2} = [2;1,1] = 2+\\frac{1}{1+\\frac{1}{1}} = 2+\\frac{1}{2} = \\frac{5}{2}$。\n-   $n=3$: $\\frac{p_3}{q_3} = [2;1,1,1] = 2+\\frac{1}{1+\\frac{1}{1+\\frac{1}{1}}} = 2+\\frac{1}{1+\\frac{1}{2}} = 2+\\frac{2}{3} = \\frac{8}{3}$。\n-   $n=4$: $\\frac{p_4}{q_4} = [2;1,1,1,4] = 2+\\frac{1}{[1;1,1,4]} = 2+\\frac{1}{[1;1,5/4]} = 2+\\frac{1}{[1;9/5]} = 2+\\frac{9}{14} = \\frac{37}{14}$。\n-   $n=5$: $\\frac{p_5}{q_5} = [2;1,1,1,4,1] = 2+\\frac{1}{[1;1,1,4,1]} = 2+\\frac{1}{[1;1,1,5]} = 2+\\frac{1}{[1;1,6/5]} = 2+\\frac{1}{[1;11/6]} = 2+\\frac{11}{17} = \\frac{45}{17}$。\n\n部分商和收敛子的总结：\n$a_0=2, p_0=2, q_0=1$\n$a_1=1, p_1=3, q_1=1$\n$a_2=1, p_2=5, q_2=2$\n$a_3=1, p_3=8, q_3=3$\n$a_4=4, p_4=37, q_4=14$\n$a_5=1, p_5=45, q_5=17$\n\n对于第二个任务，我们必须推导恒等式 $p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1}$。这可以通过将连分数结构看作线性分式变换的复合，从第一性原理来完成。$[x_0; x_1, \\dots, x_n]$ 的值可以通过相继应用变换 $z \\mapsto x_0 + 1/z$ 得到。这对应于矩阵乘法。我们定义矩阵 $M_k = \\begin{pmatrix} a_k  1 \\\\ 1  0 \\end{pmatrix}$。收敛子由递推关系 $p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$ 给出，初始条件为 $p_{-1}=1, q_{-1}=0, p_{-2}=0, q_{-2}=1$。这些关系可以写成矩阵形式：\n$$ \\begin{pmatrix} p_n  p_{n-1} \\\\ q_n  q_{n-1} \\end{pmatrix} = \\begin{pmatrix} p_{n-1}  p_{n-2} \\\\ q_{n-1}  q_{n-2} \\end{pmatrix} \\begin{pmatrix} a_n  1 \\\\ 1  0 \\end{pmatrix} $$\n通过归纳法，从 $\\begin{pmatrix} p_{-1}  p_{-2} \\\\ q_{-1}  q_{-2} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$ 开始，我们有：\n$$ \\begin{pmatrix} p_n  p_{n-1} \\\\ q_n  q_{n-1} \\end{pmatrix} = \\begin{pmatrix} a_0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} a_1  1 \\\\ 1  0 \\end{pmatrix} \\cdots \\begin{pmatrix} a_n  1 \\\\ 1  0 \\end{pmatrix} $$\n对两边取行列式，我们得到 $p_n q_{n-1} - p_{n-1} q_n$。矩阵乘积的行列式是它们行列式的乘积。每个矩阵 $\\begin{pmatrix} a_k  1 \\\\ 1  0 \\end{pmatrix}$ 的行列式是 $a_k(0) - 1(1) = -1$。由于乘积中有 $n+1$ 个这样的矩阵（对于 $k=0, 1, \\dots, n$），总行列式为 $(-1)^{n+1}$。\n因此，$p_n q_{n-1} - p_{n-1} q_n = (-1)^{n+1}$。由于 $(-1)^{n+1} = (-1)^{n-1}(-1)^2 = (-1)^{n-1}$，我们推导出了所需的恒等式：\n$$ p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1} $$\n对 $n=1, \\dots, 5$ 进行数值验证：\n-   $n=1$: $p_1q_0-p_0q_1 = (3)(1)-(2)(1)=1$。公式：$(-1)^{1-1}=1$。已验证。\n-   $n=2$: $p_2q_1-p_1q_2 = (5)(1)-(3)(2)=-1$。公式：$(-1)^{2-1}=-1$。已验证。\n-   $n=3$: $p_3q_2-p_2q_3 = (8)(2)-(5)(3)=1$。公式：$(-1)^{3-1}=1$。已验证。\n-   $n=4$: $p_4q_3-p_3q_4 = (37)(3)-(8)(14)=111-112=-1$。公式：$(-1)^{4-1}=-1$。已验证。\n-   $n=5$: $p_5q_4-p_4q_5 = (45)(14)-(37)(17)=630-629=1$。公式：$(-1)^{5-1}=1$。已验证。\n\n对于第三个任务，我们推导双边误差界。我们从代数关系 $x = [a_0; a_1, \\dots, a_n, x_{n+1}]$ 出发，根据与上述相同的逻辑，可以表示为：\n$$ x = \\frac{x_{n+1}p_n + p_{n-1}}{x_{n+1}q_n + q_{n-1}} $$\n那么误差为：\n$$ x - \\frac{p_n}{q_n} = \\frac{x_{n+1}p_n + p_{n-1}}{x_{n+1}q_n + q_{n-1}} - \\frac{p_n}{q_n} = \\frac{p_{n-1}q_n - p_n q_{n-1}}{q_n(x_{n+1}q_n + q_{n-1})} = \\frac{-(-1)^{n-1}}{q_n(x_{n+1}q_n + q_{n-1})} = \\frac{(-1)^n}{q_n(x_{n+1}q_n + q_{n-1})} $$\n取绝对值，我们得到：\n$$ \\left|x - \\frac{p_n}{q_n}\\right| = \\frac{1}{q_n(x_{n+1}q_n + q_{n-1})} = \\frac{1}{q_n^2(x_{n+1} + q_{n-1}/q_n)} $$\n我们有 $x_{n+1} = [a_{n+1}; a_{n+2}, \\dots] = a_{n+1} + 1/x_{n+2}$。因为 $x$ 是无理数，所以对所有 $n$，$x_{n+1}$ 也是无理数。因此 $a_{n+1}  x_{n+1}$。并且，$x_{n+2}  1$，所以 $0  1/x_{n+2}  1$，这意味着 $a_{n+1}  x_{n+1}  a_{n+1}+1$。\n对于误差的上限：分母 $q_n^2(x_{n+1} + q_{n-1}/q_n)  q_n^2(a_{n+1} + 0) = a_{n+1}q_n^2$，因为 $q_{n-1}/q_n \\ge 0$。这给出了 $\\left|x - \\frac{p_n}{q_n}\\right|  \\frac{1}{a_{n+1}q_n^2}$。\n对于误差的下限：分母 $q_n^2(x_{n+1} + q_{n-1}/q_n)  q_n^2((a_{n+1}+1) + q_{n-1}/q_n)$。分母序列 $q_n$ 对 $n \\ge 1$ 是严格递增的，所以对 $n \\ge 2$ 有 $q_{n-1}/q_n  1$。对 $n=1$，$q_0/q_1 = 1/a_1 \\le 1$。对 $n=0$，$q_{-1}/q_0 = 0 \\le 1$。所以我们总是有 $q_{n-1}/q_n \\le 1$。因此分母小于 $q_n^2((a_{n+1}+1)+1) = (a_{n+1}+2)q_n^2$。这得出 $\\left|x - \\frac{p_n}{q_n}\\right|  \\frac{1}{(a_{n+1}+2)q_n^2}$。\n结合这些，得到所需的不等式： $\\frac{1}{(a_{n+1}+2)q_{n}^{2}}  \\left|x-\\frac{p_{n}}{q_{n}}\\right|  \\frac{1}{a_{n+1}q_{n}^{2}}$。\n\n对 $n=0, \\dots, 5$ 进行数值验证，使用 $\\sqrt{7} \\approx 2.645751$：\n-   $n=0$: $a_1=1, q_0=1$。下界: $\\frac{1}{(1+2)1^2} = \\frac{1}{3} \\approx 0.333333$。误差: $|\\sqrt{7}-2| \\approx 0.645751$。上界: $\\frac{1}{1 \\cdot 1^2}=1$。不等式: $0.333333  0.645751  1.0$。已验证。\n-   $n=1$: $a_2=1, q_1=1$。下界: $\\frac{1}{(1+2)1^2} = \\frac{1}{3} \\approx 0.333333$。误差: $|\\sqrt{7}-3| \\approx 0.354249$。上界: $\\frac{1}{1 \\cdot 1^2}=1$。不等式: $0.333333  0.354249  1.0$。已验证。\n-   $n=2$: $a_3=1, q_2=2$。下界: $\\frac{1}{(1+2)2^2} = \\frac{1}{12} \\approx 0.083333$。误差: $|\\sqrt{7}-5/2| \\approx 0.145751$。上界: $\\frac{1}{1 \\cdot 2^2}=\\frac{1}{4}=0.25$。不等式: $0.083333  0.145751  0.25$。已验证。\n-   $n=3$: $a_4=4, q_3=3$。下界: $\\frac{1}{(4+2)3^2} = \\frac{1}{54} \\approx 0.018519$。误差: $|\\sqrt{7}-8/3| \\approx 0.020915$。上界: $\\frac{1}{4 \\cdot 3^2}=\\frac{1}{36} \\approx 0.027778$。不等式: $0.018519  0.020915  0.027778$。已验证。\n-   $n=4$: $a_5=1, q_4=14$。下界: $\\frac{1}{(1+2)14^2} = \\frac{1}{588} \\approx 0.001701$。误差: $|\\sqrt{7}-37/14| \\approx 0.002894$。上界: $\\frac{1}{1 \\cdot 14^2}=\\frac{1}{196} \\approx 0.005102$。不等式: $0.001701  0.002894  0.005102$。已验证。\n-   $n=5$: $a_6=a_2=1, q_5=17$。下界: $\\frac{1}{(1+2)17^2} = \\frac{1}{867} \\approx 0.001153$。误差: $|\\sqrt{7}-45/17| \\approx 0.001308$。上界: $\\frac{1}{1 \\cdot 17^2}=\\frac{1}{289} \\approx 0.003460$。不等式: $0.001153  0.001308  0.003460$。已验证。\n\n对于最后一个任务，我们计算 $E = q_{5}^{2}\\left|\\,x-\\frac{p_{5}}{q_{5}}\\,\\right|$ 的精确值。\n使用上面为 $n=5$ 推导出的精确误差公式：\n$$ E = q_5^2 \\left|x - \\frac{p_5}{q_5}\\right| = q_5^2 \\cdot \\frac{1}{q_5(x_6 q_5 + q_4)} = \\frac{q_5}{x_6 q_5 + q_4} $$\n根据我们最初的计算，我们有 $q_4=14$, $q_5=17$, 以及 $x_6=x_2=\\frac{\\sqrt{7}+1}{2}$。\n代入这些值：\n$$ E = \\frac{17}{\\left(\\frac{\\sqrt{7}+1}{2}\\right)(17) + 14} = \\frac{17}{\\frac{17\\sqrt{7}+17}{2} + \\frac{28}{2}} = \\frac{17 \\cdot 2}{17\\sqrt{7}+17+28} = \\frac{34}{45+17\\sqrt{7}} $$\n为使分母有理化，我们乘以共轭式：\n$$ E = \\frac{34(45-17\\sqrt{7})}{(45+17\\sqrt{7})(45-17\\sqrt{7})} = \\frac{34(45-17\\sqrt{7})}{45^2 - (17\\sqrt{7})^2} $$\n分母是 $45^2 - 17^2 \\cdot 7 = 2025 - 289 \\cdot 7 = 2025 - 2023 = 2$。\n所以，\n$$ E = \\frac{34(45-17\\sqrt{7})}{2} = 17(45-17\\sqrt{7}) = 17 \\cdot 45 - 17 \\cdot 17\\sqrt{7} = 765 - 289\\sqrt{7} $$\n这就是最简根式形式的缩放误差的精确值。\n或者，我们直接计算 $E = q_5 |x q_5 - p_5| = 17|17\\sqrt{7} - 45|$。因为 $45/17 \\approx 2.64705$ 且 $\\sqrt{7} \\approx 2.64575$，我们有 $45 > 17\\sqrt{7}$，所以绝对值内的表达式是负的。\n$E = 17(45 - 17\\sqrt{7}) = 765 - 289\\sqrt{7}$。", "answer": "$$\n\\boxed{765 - 289\\sqrt{7}}\n$$", "id": "3020976"}, {"introduction": "像Lagrange定理这样的理论结果告诉我们，连分数的收敛项提供了最佳有理逼近。但在实践中，我们如何亲眼证实这一点呢？最后的练习[@problem_id:3083983]将采用一种计算的视角，要求你通过暴力搜索来寻找$\\sqrt{3}$的最佳逼近，并将你的发现与连分数理论的预测进行比较。这个计算实验不仅是对理论的有力验证，也揭示了收敛项与Dirichlet和Hurwitz等里程碑式定理之间的深刻联系。", "problem": "设 $\\alpha=\\sqrt{3}$ 是一个无理实数。对于整数 $p$ 和 $q\\ge 1$，定义绝对线性形式误差 $\\lvert q\\alpha - p\\rvert$ 和有理逼近误差 $\\lvert \\alpha - \\frac{p}{q}\\rvert$。本问题的基础包含数论中以下广为接受的事实和定义：\n- 最近整数性质：对于固定的 $q$，使 $\\lvert q\\alpha - p\\rvert$ 最小化的整数 $p$ 是最接近 $q\\alpha$ 的整数。\n- 连分数与渐近分数：实数 $\\alpha$ 的简单连分数展开决定了一个由递推关系给出的渐近分数序列 $\\frac{p_n}{q_n}$，这些渐近分数在精确意义上提供了最佳有理逼近。\n- Dirichlet 逼近定理：对于任意实数 $\\alpha$ 和任意整数 $N\\ge 1$，存在整数 $p$ 和 $q$（其中 $1\\le q\\le N$），使得 $\\lvert q\\alpha - p\\rvert  \\frac{1}{N}$；此外，存在无穷多个分数 $\\frac{p}{q}$，使得 $\\lvert \\alpha - \\frac{p}{q}\\rvert  \\frac{1}{q^2}$。\n- Hurwitz 定理：对于任意无理数 $\\alpha$，存在无穷多个有理数 $\\frac{p}{q}$，使得 $\\lvert \\alpha - \\frac{p}{q}\\rvert  \\frac{1}{\\sqrt{5}\\,q^2}$。常数 $\\frac{1}{\\sqrt{5}}$ 是最佳可能值。\n\n您的任务是实现一个完整的程序，该程序：\n1. 对于每个给定的界限 $N$，搜索所有满足 $1\\le q\\le N$ 的分母 $q$，并为每个 $q$ 选择使 $\\lvert q\\alpha - p\\rvert$ 最小化的整数 $p$。在所有这些满足 $1\\le q\\le N$ 的数对 $\\left(p,q\\right)$ 中，找出使 $\\lvert q\\alpha - p\\rvert$ 最小化的数对 $\\left(p^\\ast,q^\\ast\\right)$，并记录最小值 $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert$。\n2. 计算 $\\alpha$ 的简单连分数展开，生成所有满足 $q_n\\le N$ 的渐近分数 $\\frac{p_n}{q_n}$。确定通过暴力搜索找到的最佳数对 $\\left(p^\\ast,q^\\ast\\right)$ 是否等于这些渐近分数中的一个。同时验证最佳渐近分数（即在所有满足 $q_n\\le N$ 的 $\\frac{p_n}{q_n}$ 中使 $\\lvert q_n\\alpha - p_n\\rvert$ 最小化的那个）与暴力搜索得到的最佳结果是否匹配。\n3. 通过检查 $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert  \\frac{1}{N}$ 是否成立来验证 Dirichlet 界。\n4. 通过检查 $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast}\\right\\rvert  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2}$ 是否成立来验证最佳数对 $\\left(p^\\ast,q^\\ast\\right)$ 的 Hurwitz 界。\n\n仅使用纯数学量；不涉及物理单位。如果出现任何角度，均假定为无量纲。程序必须对固定的 $\\alpha=\\sqrt{3}$ 计算上述内容。\n\n测试套件：\n- 案例 A：$N=1$（边界小值）\n- 案例 B：$N=10^2$\n- 案例 C：$N=10^3$\n- 案例 D：$N=10^5$（计算量大）\n\n对于每个测试案例，程序必须输出一个形式为 $[q^\\ast, p^\\ast, \\text{min\\_abs}, \\text{is\\_convergent}, \\text{dirichlet\\_ok}, \\text{hurwitz\\_ok}]$ 的列表，其中：\n- $q^\\ast$ 和 $p^\\ast$是整数，\n- $\\text{min\\_abs}$ 是一个浮点数，表示 $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert$，\n- $\\text{is\\_convergent}$ 是一个布尔值，指示 $\\left(p^\\ast,q^\\ast\\right)$ 是否为 $\\alpha$ 的连分数渐近分数，\n- $\\text{dirichlet\\_ok}$ 是一个布尔值，指示 $\\text{min\\_abs}  \\frac{1}{N}$ 是否成立，\n- $\\text{hurwitz\\_ok}$ 是一个布尔值，指示 $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast}\\right\\rvert  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2}$ 是否成立。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试案例的结果，格式为由逗号分隔并包含在方括号中的列表，每个测试案例的结果本身也是上述格式的列表。例如：$[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，且不要求额外的空格。", "solution": "该问题要求对无理数 $\\alpha = \\sqrt{3}$ 进行丢番图逼近的计算分析。对于给定的分母 $q$ 的上限 $N$，我们需要完成几个任务：通过暴力搜索找到最佳有理逼近，将此结果与连分数理论进行比较，并验证逼近理论中的两个基本定理，即 Dirichlet 定理和 Hurwitz 定理。\n\n解决方案的实现方式是，通过一系列计算和验证步骤，对每个由界限 $N$ 表征的测试案例进行分析。我们使用高精度浮点运算来处理无理数 $\\alpha$。对于给定界限 $N$ 的单个测试案例，总体流程如下。\n\n**步骤 1：暴力最小化线性形式误差**\n\n第一个任务是找到满足 $1 \\le q^\\ast \\le N$ 的整数对 $(p^\\ast, q^\\ast)$，该整数对使绝对线性形式误差 $\\lvert q\\alpha - p\\rvert$ 最小。对于任意给定的整数分母 $q \\ge 1$，使该误差最小化的整数 $p$ 是最接近 $q\\alpha$ 的整数。这被称为 $q\\alpha$ 的最近整数，可计算为 $p = \\text{round}(q\\alpha)$。\n\n我们遍历从 $1$ 到 $N$ 的所有可能的分母 $q$。对于每个 $q$，我们确定最优的 $p$ 并计算相应的误差 $\\epsilon_q = \\lvert q\\alpha - \\text{round}(q\\alpha)\\rvert$。我们记录迄今为止发现的最小误差 $\\epsilon_{min}$ 以及产生该误差的数对 $(p^\\ast, q^\\ast)$。\n\n$$ \\epsilon_{min} = \\min_{1 \\le q \\le N} \\min_{p \\in \\mathbb{Z}} \\lvert q\\alpha - p \\rvert = \\min_{1 \\le q \\le N} \\lvert q\\alpha - \\text{round}(q\\alpha) \\rvert $$\n\n记录最终的 $p^\\ast$、$q^\\ast$ 和 $\\epsilon_{min}$ (在输出中表示为 `min_abs`)。\n\n**步骤 2：与连分数渐近分数进行验证**\n\n连分数理论为寻找数的最佳有理逼近提供了一种强大的方法。一个关键结果，即 Lagrange 逼近定理，指出“第二类最佳逼近”（即对于所有 $1 \\le q'  q$，都有 $\\lvert q\\alpha - p \\rvert  \\lvert q'\\alpha - p' \\rvert$ 成立的分数 $p/q$）的集合恰好是 $\\alpha$ 的主渐近分数的集合。因此，在步骤 1 中找到的、代表在 $1 \\le q \\le N$ 范围内的全局最小值的数对 $(p^\\ast, q^\\ast)$ 必须是这些渐近分数之一。\n\n为了验证这一点，我们首先生成 $\\alpha = \\sqrt{3}$ 的渐近分数序列 $\\frac{p_n}{q_n}$。$\\sqrt{3}$ 的简单连分数展开是周期的：$\\sqrt{3} = [1; \\overline{1, 2}]$。系数为 $a_0 = 1$，对于 $n \\ge 1$，$a_n=1$ 如果 $n$ 是奇数，而 $a_n=2$ 如果 $n$ 是偶数。渐近分数 $p_n/q_n$ 使用标准递推关系生成：\n$$ p_n = a_n p_{n-1} + p_{n-2} $$\n$$ q_n = a_n q_{n-1} + q_{n-2} $$\n初始条件为 $p_{-1}=1, q_{-1}=0$ 和 $p_0=a_0=1, q_0=1$。\n\n我们生成所有满足 $q_n \\le N$ 的渐近分数 $(p_n, q_n)$ 并将它们存储起来。然后我们检查步骤 1 中得到的数对 $(p^\\ast, q^\\ast)$ 是否存在于这个渐近分数集合中。这个验证产生布尔值 `is_convergent`，根据理论，它必须为真。\n\n**步骤 3：验证 Dirichlet 逼近定理**\n\nDirichlet 丢番图逼近定理指出，对于任意实数 $\\alpha$ 和任意整数 $N \\ge 1$，存在整数 $p$ 和 $q$（其中 $1 \\le q \\le N$），使得 $\\lvert q\\alpha - p \\rvert  \\frac{1}{N}$。\n\n在步骤 1 中找到的值 $\\epsilon_{min} = \\lvert q^\\ast\\alpha - p^\\ast \\rvert$ 是在 $1 \\le q \\le N$ 范围内任何 $q$ 可能的最小误差。由于 Dirichlet 定理保证至少存在一对 $(p,q)$ 满足该不等式，因此所有这些数对的最小误差也必须满足它。因此，我们验证条件：\n$$ \\epsilon_{min}  \\frac{1}{N} $$\n此检查产生布尔值 `dirichlet_ok`，对于所有 $N \\ge 1$，该值预期为真。\n\n**步骤 4：验证 Hurwitz 定理界**\n\nHurwitz 定理指出，对于任意无理数 $\\alpha$，存在无穷多个有理数 $\\frac{p}{q}$，使得有理逼近误差满足：\n$$ \\left\\lvert \\alpha - \\frac{p}{q} \\right\\rvert  \\frac{1}{\\sqrt{5}\\,q^2} $$\n该定理保证了存在无穷多个这样的逼近，但不保证每个最佳逼近（或每个渐近分数）都满足这一特定界限。对于在步骤 1 中找到的最佳逼近对 $(p^\\ast, q^\\ast)$，我们明确检查此不等式是否成立。\n\n该数对的有理逼近误差为 $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast} \\right\\rvert = \\frac{\\lvert q^\\ast\\alpha - p^\\ast \\rvert}{q^\\ast} = \\frac{\\epsilon_{min}}{q^\\ast}$。因此，验证是：\n$$ \\frac{\\epsilon_{min}}{q^\\ast}  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2} $$\n这将产生布尔值 `hurwitz_ok`。与之前的检查不同，这个结果不保证对每个 $N$ 都为真。\n\n完整的程序为测试套件中的每个 $N$ 值实现这四个步骤，并按规定格式化结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for the specified test cases and print the results.\n    \"\"\"\n\n    def get_cf_coeff_sqrt3(n):\n        \"\"\"\n        Returns the n-th coefficient (a_n) of the simple continued fraction of sqrt(3),\n        which is [1; 1, 2, 1, 2, ...].\n        \"\"\"\n        if n == 0:\n            return 1\n        return 1 if n % 2 != 0 else 2\n\n    def get_convergents_up_to_n(N_max):\n        \"\"\"\n        Generates convergents p_n/q_n for sqrt(3) until q_n > N_max.\n        Returns a set of (p, q) tuples for efficient lookup.\n        \"\"\"\n        convergents = set()\n        n = 0\n        p_prev, q_prev = 1, 0\n        a_n = get_cf_coeff_sqrt3(n)\n        p_curr, q_curr = a_n, 1\n        \n        while q_curr = N_max:\n            convergents.add((p_curr, q_curr))\n            \n            n += 1\n            a_n = get_cf_coeff_sqrt3(n)\n            \n            p_next = a_n * p_curr + p_prev\n            q_next = a_n * q_curr + q_prev\n            \n            p_prev, q_prev = p_curr, q_curr\n            p_curr, q_curr = p_next, q_next\n            \n        return convergents\n\n    def analyze_approximation(N):\n        \"\"\"\n        Performs the full Diophantine approximation analysis for a given denominator bound N.\n        \n        Returns:\n            A list containing [q*, p*, min_abs, is_convergent, dirichlet_ok, hurwitz_ok].\n        \"\"\"\n        alpha = np.sqrt(3)\n\n        # Task 1: Brute-force search for the best rational approximation.\n        min_abs_linear_error = np.inf\n        p_star, q_star = -1, -1\n\n        for q in range(1, N + 1):\n            p = int(round(q * alpha))\n            current_error = abs(q * alpha - p)\n\n            if current_error  min_abs_linear_error:\n                min_abs_linear_error = current_error\n                p_star = p\n                q_star = q\n\n        # Task 2: Compare with continued fraction convergents.\n        convergents = get_convergents_up_to_n(N)\n        is_convergent = (p_star, q_star) in convergents\n\n        # Task 3: Verify Dirichlet's approximation theorem bound.\n        dirichlet_bound = 1.0 / N\n        dirichlet_ok = min_abs_linear_error  dirichlet_bound\n\n        # Task 4: Verify Hurwitz's theorem bound for the best pair (p*, q*).\n        rational_approx_error = min_abs_linear_error / q_star\n        hurwitz_bound = 1.0 / (np.sqrt(5) * q_star**2)\n        hurwitz_ok = rational_approx_error  hurwitz_bound\n\n        return [q_star, p_star, min_abs_linear_error, is_convergent, dirichlet_ok, hurwitz_ok]\n\n    # Define the test cases from the problem statement.\n    test_cases = [1, 10**2, 10**3, 10**5]\n\n    results = []\n    for N_val in test_cases:\n        results.append(analyze_approximation(N_val))\n\n    # Format the results into the required single-line string.\n    def format_result(res):\n        q, p, err, is_c, is_d, is_h = res\n        return f\"[{q},{p},{err},{str(is_c).lower()},{str(is_d).lower()},{str(is_h).lower()}]\"\n\n    final_output_str = f\"[{','.join([format_result(r) for r in results])}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str.replace(\" \", \"\"))\n\nsolve()\n```", "id": "3083983"}]}