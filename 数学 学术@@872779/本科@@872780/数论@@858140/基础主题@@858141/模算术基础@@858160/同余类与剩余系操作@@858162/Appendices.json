{"hands_on_practices": [{"introduction": "一个模 $n$ 的完全剩余系并不仅仅是我们所熟悉的集合 $\\{0, 1, \\dots, n-1\\}$；许多其他的整数集合也能起到相同的作用。这个练习将引导你探索一个简单的仿射变换如何将标准剩余系重排为一个新的、有效的完全剩余系 [@problem_id:3083570]。通过证明该变换的有效性，你将深入理解定义这些基本代数结构的本质条件。", "problem": "设 $n$ 是一个正整数，并回顾两个整数 $x$ 和 $y$ 模 $n$ 同余的定义，当且仅当 $n$ 整除 $x-y$，记作 $x \\equiv y \\pmod{n}$。一个集合 $R \\subset \\mathbb{Z}$ 是模 $n$ 的完全剩余系，当且仅当每个整数都与 $R$ 中唯一的一个元素模 $n$ 同余。考虑模 $n=26$ 以及由 $T(x)=ax+b$ 定义的仿射映射 $T:\\mathbb{Z} \\to \\mathbb{Z}$，其中参数为 $a=7$ 和 $b=10$。\n\n仅使用上述定义和同余的基本性质，完成以下任务：\n\n- 首先，通过将 $T$ 应用于标准完全剩余系 $\\{0,1,2,\\dots,25\\}$，然后将每个像化简为其模 $26$ 的最小非负余数，来构造一个非标准的模 $26$ 完全剩余系。证明所得到的集合确实是模 $26$ 的完全剩余系。\n\n- 其次，计算你所构造的集合中所有元素之和模 $26$ 的最小非负余数。将你的最终答案表示为 $\\{0,1,2,\\dots,25\\}$ 中的一个整数。\n\n无需进行数值四舍五入，也不涉及单位。最终答案必须是单个整数。", "solution": "该问题要求一个关于模 $26$ 剩余系的两部分解答。首先，我们必须使用给定的仿射变换构造一个完全剩余系，并证明其有效性。其次，我们必须计算这个新系统中元素的总和，并求其模 $26$ 的余数。\n\n设模为 $n=26$。模 $26$ 的标准完全剩余系 (CRS) 是集合 $S = \\{0, 1, 2, \\dots, 25\\}$。仿射映射由 $T: \\mathbb{Z} \\to \\mathbb{Z}$ 给出，定义为 $T(x) = ax+b$，参数为 $a=7$ 和 $b=10$。因此，该变换为 $T(x) = 7x+10$。\n\n第1部分：完全剩余系的构造与证明\n\n我们的任务是构造一个新集合，我们称之为 $R'$，方法是将映射 $T$ 应用于 $S$ 中的每个元素，然后取其模 $26$ 的最小非负余数。$R'$ 的元素是满足以下条件的整数 $y$：对于每个 $x \\in S$，有 $y \\equiv T(x) \\pmod{26}$ 且 $0 \\le y \\le 25$。形式上，$R' = \\{ (7x+10) \\pmod{26} \\mid x \\in S \\}$。\n\n为了证明 $R'$ 是一个模 $26$ 的完全剩余系，我们必须证明它包含恰好 $26$ 个模 $26$ 互不同余的整数。由于 $R'$ 是由 $S$ 的 $26$ 个元素构造而来的，它最多有 $26$ 个元素。我们必须证明它恰好有 $26$ 个不同的元素。为此，我们证明映射 $T$ 是模 $26$ 剩余类集合上的一个排列。\n\n考虑集合 $S$ 中的两个元素 $x_1, x_2$。假设它们在 $T$ 下的像模 $26$ 同余：\n$$T(x_1) \\equiv T(x_2) \\pmod{26}$$\n代入 $T(x)$ 的定义：\n$$7x_1 + 10 \\equiv 7x_2 + 10 \\pmod{26}$$\n从同余式两边减去 $10$，我们得到：\n$$7x_1 \\equiv 7x_2 \\pmod{26}$$\n这是一个线性同余方程。这类同余方程的一个关键性质是，如果一个因子与模数互质，那么它可以被消去。让我们计算系数 $a=7$ 和模数 $n=26$ 的最大公约数：\n$$\\gcd(7, 26)$$\n$7$ 的素数分解就是 $7$。$26$ 的素数分解是 $2 \\times 13$。由于没有共同的素数因子，最大公约数是 $1$。\n$$\\gcd(7, 26) = 1$$\n因为 $7$ 和 $26$ 互质，所以 $7$ 存在模 $26$ 的乘法逆元。我们将其称为 $7^{-1}$。我们可以用这个逆元乘以同余式 $7x_1 \\equiv 7x_2 \\pmod{26}$ 的两边：\n$$7^{-1} \\cdot 7x_1 \\equiv 7^{-1} \\cdot 7x_2 \\pmod{26}$$\n$$1 \\cdot x_1 \\equiv 1 \\cdot x_2 \\pmod{26}$$\n$$x_1 \\equiv x_2 \\pmod{26}$$\n由于 $x_1$ 和 $x_2$ 是从集合 $S = \\{0, 1, 2, \\dots, 25\\}$ 中选取的，它们都是最小非负余数。如果它们模 $26$ 同余，那么它们必须相等：$x_1 = x_2$。\n\n这表明如果 $x_1 \\neq x_2$，那么 $T(x_1) \\not\\equiv T(x_2) \\pmod{26}$。因此，映射 $T$ 在模 $26$ 剩余类集合上是单射。从一个有限集到其自身的单射也是满射，因此是双射。这意味着将 $T$ 应用于 $S$ 的 $26$ 个不同元素，会生成一个包含 $26$ 个模 $26$ 不同余数的集合。当这些余数被化简为其最小非负值时，得到的集合 $R'$ 必定是原始余数集合 $\\{0, 1, 2, \\dots, 25\\}$ 的一个排列。\n因此，作为一个集合，$R'$ 与 $S$ 是相同的：\n$$R' = \\{0, 1, 2, \\dots, 25\\}$$\n所以，集合 $R'$ 是一个模 $26$ 的完全剩余系。\n\n第2部分：所构造集合的元素之和\n\n问题的第二部分是计算集合 $R'$ 中所有元素之和模 $26$ 的最小非负余数。设这个和为 $\\Sigma$。\n因为我们已经确定 $R' = \\{0, 1, 2, \\dots, 25\\}$，所以其元素之和为：\n$$\\Sigma = \\sum_{k=0}^{25} k$$\n这是一个等差级数的和。前 $m$ 个非负整数的和由公式 $\\frac{m(m+1)}{2}$ 给出。在我们的例子中，$m=25$：\n$$\\Sigma = \\frac{25(25+1)}{2} = \\frac{25 \\times 26}{2} = 25 \\times 13$$\n和为 $\\Sigma = 325$。\n\n我们需要求 $\\Sigma$ 模 $26$ 的最小非负余数。这等价于计算 $325 \\pmod{26}$。\n我们可以进行除法运算：$325 = 12 \\times 26 + 13$。余数是 $13$。\n所以，$325 \\equiv 13 \\pmod{26}$。\n\n或者，我们可以直接从表达式 $\\Sigma = 25 \\times 13$ 计算模 $26$ 的和：\n$$\\Sigma \\pmod{26} \\equiv (25 \\times 13) \\pmod{26}$$\n我们注意到 $25 \\equiv -1 \\pmod{26}$。将此代入同余式：\n$$25 \\times 13 \\equiv (-1) \\times 13 \\pmod{26}$$\n$$25 \\times 13 \\equiv -13 \\pmod{26}$$\n为了将其表示为最小非负余数，我们加上模数 $26$：\n$$-13 \\pmod{26} \\equiv -13+26 \\pmod{26} \\equiv 13 \\pmod{26}$$\n两种方法得到相同的结果。该和的最小非负余数是 $13$。", "answer": "$$ \\boxed{13} $$", "id": "3083570"}, {"introduction": "与包含所有可能余数的完全剩余系不同，简化剩余系只包含那些可逆的元素，它们在乘法下构成一个群。本练习要求你从第一性原理出发，为素数幂模 $p^k$ 构建这样一个系统 [@problem_id:3083588]。你将亲自筛选出不符合条件的元素，并由此推导出著名的欧拉函数 $\\phi(p^k)$ 在此特殊情况下的表达式，从而将抽象的定义与具体的计数过程联系起来。", "problem": "设 $p$ 为一个素数， $k$ 为一个正整数。仅使用模 $n$ 同余、最大公约数 (GCD) 和模 $n$ 可逆性的核心定义，通过从 $\\{1,2,\\dots,p^{k}-1\\}$ 中指定一组整数代表，来显式地构造一个模 $p^{k}$ 的既约剩余系，要求这些代表模 $p^{k}$ 两两不同余且均与 $p^{k}$ 互素。然后，通过一个基于这些定义的第一性原理计数论证（并且不使用任何关于可逆类数量的既有公式），确定你构造的既约剩余系的基数，并将其表示为关于 $p$ 和 $k$ 的封闭形式表达式。你的最终答案应该是基数表达式；不要在最终答案框中提供任何中间计数或推导过程。", "solution": "所述问题是有效的。这是一个初等数论中定义明确的问题，基于已建立的数学原理，并且没有歧义或矛盾。我们将进行完整的解答。\n\n该问题要求完成两个主要任务：首先，使用集合 $\\{1, 2, \\dots, p^k-1\\}$ 中的代表元素，显式地构造一个模 $p^k$ 的既约剩余系；其次，通过一个第一性原理的计数论证来确定该系的基数。设 $p$ 为素数， $k$ 为正整数。\n\n模整数 $n$ 的一个既约剩余系是一个整数集合 $\\{r_1, r_2, \\ldots, r_m\\}$，满足以下条件：\n$1$. 对于每个 $i \\in \\{1, 2, \\ldots, m\\}$，整数 $r_i$ 与 $n$ 互素，根据定义，这意味着 $\\gcd(r_i, n) = 1$。\n$2$. 对于任意两个不同的下标 $i, j \\in \\{1, 2, \\ldots, m\\}$，这些整数模 $n$ 不同余；即 $r_i \\not\\equiv r_j \\pmod{n}$。\n$3$. 该集合是完备的：任何满足 $\\gcd(a, n) = 1$ 的整数 $a$ 都必须与集合中恰好一个元素 $r_i$ 同余。\n该系的基数是整数 $m$，也就是模 $n$ 的可逆同余类的数量。\n\n首先，我们来解决该系的构造问题。问题要求从集合 $S = \\{1, 2, \\ldots, p^k - 1\\}$ 中选取代表元。$S$ 的元素是不同的整数，对于 $S$ 中任意两个不同的元素 $a, b$，它们的差 $a-b$ 满足 $0  |a-b|  p^k$。这意味着 $p^k$ 不能整除 $a-b$，所以 $a \\not\\equiv b \\pmod{p^k}$。因此，对于 $S$ 的任何子集，既约剩余系的第二个条件都会自动满足。\n\n为了满足第一个条件，我们必须只从 $S$ 中选择那些满足 $\\gcd(a, p^k) = 1$ 的元素 $a$。整数 $p^k$ 只有一个素因子，即 $p$。根据最大公约数的定义和算术基本定理，一个整数 $a$ 与 $p^k$ 有大于1的公约数，当且仅当 $a$ 与 $p^k$ 有共同的素因子。这意味着 $\\gcd(a, p^k) > 1$ 当且仅当 $p$ 是 $a$ 的一个因子，即 $p \\mid a$。因此，一个整数与 $p^k$ 互素的条件是 $\\gcd(a, p^k) = 1$ 当且仅当 $p \\nmid a$。\n\n因此，我们可以显式地构造所需的既约剩余系，我们将其记为 $\\mathcal{R}$，方法是取集合 $S$ 中所有不能被 $p$ 整除的元素。\n$$ \\mathcal{R} = \\{a \\in \\{1, 2, \\ldots, p^k - 1\\} \\mid p \\nmid a \\} $$\n这个集合满足模 $p^k$ 的既约剩余系的所有条件。\n\n接下来，我们使用第一性原理的计数论证来确定 $\\mathcal{R}$ 的基数，即 $|\\mathcal{R}|$。我们将使用补集计数原理。更直接的方法是计算*不*在 $\\mathcal{R}$ 中的整数数量，然后从总数中减去这个数量。\n\n让我们考虑直到并包括 $p^k$ 的完整正整数代表集，即集合 $C = \\{1, 2, \\ldots, p^k\\}$。这个集合的基数是 $|C| = p^k$。$C$ 中与 $p^k$ 不互素的整数是那些满足 $\\gcd(a, p^k) > 1$ 的 $a$。如前所述，这等价于条件 $p \\mid a$。\n\n我们必须计算集合 $C$ 中 $p$ 的倍数的数量。这些倍数的形式为 $m \\cdot p$，其中 $m$ 是一个正整数。我们需要找到所有满足 $1 \\le m \\cdot p \\le p^k$ 的 $m$。将这个不等式两边除以 $p$（这是一个大于或等于2的正整数），我们得到 $\\frac{1}{p} \\le m \\le p^{k-1}$。因为 $m$ 必须是整数，所以 $m$ 的范围是 $1 \\le m \\le p^{k-1}$。因此，$m$ 的可能取值为 $1, 2, \\ldots, p^{k-1}$。这样的值的数量恰好是 $p^{k-1}$。\n\n所以，在集合 $C = \\{1, 2, \\ldots, p^k\\}$ 中有 $p^{k-1}$ 个与 $p^k$ 不互素的整数。$C$ 中与 $p^k$ *互素*的整数数量是 $C$ 中元素的总数减去与 $p^k$ 不互素的元素数量：\n$$ \\text{$C$ 中互素整数的数量} = |C| - p^{k-1} = p^k - p^{k-1} $$\n我们感兴趣的集合是 $\\mathcal{R}$，它的元素来自 $S = \\{1, 2, \\ldots, p^k - 1\\}$。基础集合 $S$ 和 $C$ 之间唯一的区别是单个整数 $p^k$。为了确认我们对 $\\mathcal{R}$ 的计数是正确的，我们必须检查元素 $p^k$ 是否与 $p^k$ 互素。\n我们计算 $\\gcd(p^k, p^k)$。任何正整数与自身的最大公约数是该整数本身，所以 $\\gcd(p^k, p^k) = p^k$。因为 $p$ 是素数 ($p \\ge 2$) 且 $k$ 是正整数 ($k \\ge 1$)，我们有 $p^k \\ge 2$。因此，$\\gcd(p^k, p^k) > 1$。\n这表明 $p^k$ 与自身不互素，因此不是我们所计数的整数集合的成员。在 $C$ 中与 $p^k$ 互素的整数集合与在 $S$ 中与 $p^k$ 互素的整数集合是相同的。\n因此，所构造的既约剩余系 $\\mathcal{R}$ 的基数是：\n$$ |\\mathcal{R}| = p^k - p^{k-1} $$\n这个表达式完全是根据要求，从GCD和整除性的定义以及直接的计数论证推导出来的。", "answer": "$$\\boxed{p^k - p^{k-1}}$$", "id": "3083588"}, {"introduction": "乘法逆元的存在是简化剩余系群结构的基石。这个练习将巩固你对这一核心概念的理解，它不仅要求你证明在模 $p^k$ 下逆元的存在性和唯一性，还需要你动手计算一个具体的大数的逆元 [@problem_id:3083597]。掌握扩展欧几里得算法不仅为你提供了一个解决同余方程的强大工具，更是通往密码学等应用领域的关键一步。", "problem": "设 $p$ 是一个素数， $k \\geq 1$ 是一个整数。考虑一个整数 $a$ 满足 $p \\nmid a$。利用模 $n$ 同余的定义（即，$x \\equiv y \\pmod{n}$ 当且仅当 $n \\mid (x-y)$）、$\\gcd(a,n) = 1$ 意味着存在整数 $x$ 和 $y$ 使得 $ax + ny = 1$（裴蜀恒等式）这一事实，以及整除性和最大公约数的基本性质，完成以下任务：\n\n1. 从第一性原理出发，证明如果 $p \\nmid a$，则 $a$ 存在唯一的模 $p^{k}$ 的乘法逆元；也就是说，存在唯一的模 $p^{k}$ 的剩余类 $[x]$ 使得 $ax \\equiv 1 \\pmod{p^{k}}$。\n\n2. 使用亨泽尔式迭代（将模 $7$ 的逆元迭代提升至模 $7^{5}$）或扩展欧几里得算法（EEA; Extended Euclidean Algorithm），计算 $a = 12345$ 模 $p^{k} = 7^{5}$ 的逆元，并以 $\\{0,1,2,\\dots,7^{5}-1\\}$ 中最小非负剩余的形式明确给出。你的最终答案必须是指定范围内的单个整数代表。无需四舍五入。", "solution": "该问题包含两部分。第一部分是证明模素数幂的乘法逆元的存在性和唯一性。第二部分是对此类逆元的具体计算。\n\n### 第1部分：存在性与唯一性的证明\n\n题目要求我们证明，如果 $p$ 是一个素数，$k \\geq 1$ 是一个整数，且 $a$ 是一个满足 $p \\nmid a$ 的整数，那么存在唯一的模 $p^k$ 的剩余类 $[x]$ 使得 $ax \\equiv 1 \\pmod{p^k}$。\n\n**乘法逆元的存在性**\n\n证明依赖于给定条件 $p \\nmid a$ 和裴蜀恒等式。\n设 $n = p^k$。整数 $a$ 存在模 $n$ 的乘法逆元的条件是 $\\gcd(a, n) = 1$。\n$n=p^k$ 的素因数分解只包含素数 $p$。\n条件 $p \\nmid a$ 意味着 $p$ 不是 $a$ 的素因数。\n由于 $a$ 和 $p^k$ 没有共同的素因数，它们的最大公约数必定为 $1$。因此，$\\gcd(a, p^k) = 1$。\n\n如问题所述，我们可以使用裴蜀恒等式。该恒等式断言，如果 $\\gcd(a, p^k) = 1$，则存在整数 $x$ 和 $y$ 使得：\n$$ax + p^k y = 1$$\n我们可以利用模 $p^k$ 同余的定义来分析此方程。该方程可以重写为：\n$$ax - 1 = (-y)p^k$$\n这表明 $p^k$ 整除 $ax - 1$，因为 $-y$ 是一个整数。根据同余的定义（$u \\equiv v \\pmod{n}$ 当且仅当 $n \\mid (u-v)$），我们有：\n$$ax \\equiv 1 \\pmod{p^k}$$\n这证明了存在一个整数 $x$ 作为 $a$ 模 $p^k$ 的乘法逆元。因此，剩余类 $[x]$ 是剩余类 $[a]$ 模 $p^k$ 的乘法逆元。\n\n**乘法逆元的唯一性**\n\n为证明唯一性，我们假设存在两个整数 $x_1$ 和 $x_2$，它们都是 $a$ 模 $p^k$ 的乘法逆元。我们必须证明它们属于同一个剩余类，即 $x_1 \\equiv x_2 \\pmod{p^k}$。\n\n根据我们的假设，我们有两个同余式：\n$$ax_1 \\equiv 1 \\pmod{p^k}$$\n$$ax_2 \\equiv 1 \\pmod{p^k}$$\n从第一个同余式 $ax_1 \\equiv 1 \\pmod{p^k}$ 开始，两边同乘以 $x_2$：\n$$x_2(ax_1) \\equiv x_2(1) \\pmod{p^k}$$\n利用整数乘法的结合律和交换律，我们得到：\n$$(x_2a)x_1 \\equiv x_2 \\pmod{p^k}$$\n$$(ax_2)x_1 \\equiv x_2 \\pmod{p^k}$$\n根据我们的第二个初始假设，我们知道 $ax_2 \\equiv 1 \\pmod{p^k}$。将此代入同余式的左边，得到：\n$$(1)x_1 \\equiv x_2 \\pmod{p^k}$$\n$$x_1 \\equiv x_2 \\pmod{p^k}$$\n这表明，任何两个作为 $a$ 的乘法逆元的整数都必须模 $p^k$ 同余。因此，它们属于同一个剩余类，乘法逆元所在的剩余类是唯一的。\n\n### 第2部分：逆元的计算\n\n题目要求我们计算 $a=12345$ 模 $p^k = 7^5 = 16807$ 的逆元。首先，我们验证条件 $p \\nmid a$，即 $7 \\nmid 12345$。\n将 $12345$ 除以 $7$ 得到 $12345 = 7 \\times 1763 + 4$。由于余数不为零，所以 $7$ 不能整除 $12345$。条件满足，因此存在唯一的逆元。\n\n我们将使用扩展欧几里得算法（EEA）来找到整数 $x$ 和 $y$ 使得 $12345x + 16807y = \\gcd(12345, 16807)$。由于我们已经确定 gcd 为 $1$，我们要求解的是：\n$$12345x + 16807y = 1$$\n找到的整数 $x$ 将是 $12345$ 模 $16807$ 的乘法逆元。\n\n扩展欧几里得算法的过程是，首先运行欧几里得算法求出 $16807$ 和 $12345$ 的 gcd，同时记录下将每个余数表示为原始两数线性组合的系数。\n\n设 $r_0 = 16807$ 和 $r_1 = 12345$。\n欧几里得算法的步骤如下：\n$$ \\begin{align*} 16807 = 1 \\cdot 12345 + 4462 \\\\ 12345 = 2 \\cdot 4462 + 3421 \\\\ 4462 = 1 \\cdot 3421 + 1041 \\\\ 3421 = 3 \\cdot 1041 + 298 \\\\ 1041 = 3 \\cdot 298 + 147 \\\\ 298 = 2 \\cdot 147 + 4 \\\\ 147 = 36 \\cdot 4 + 3 \\\\ 4 = 1 \\cdot 3 + 1 \\\\ 3 = 3 \\cdot 1 + 0 \\end{align*} $$\n最后一个非零余数是 $1$，因此 $\\gcd(12345, 16807) = 1$，与预期相符。\n\n通过系统地向后回代（或使用扩展欧几里得算法的表格形式），我们为每个余数找到了一个线性组合。最后一步将 $1$ 表示为 $12345$ 和 $16807$ 的组合。执行完整的扩展欧几里得算法计算得出恒等式：\n$$ (12345)(4230) + (16807)(-3107) = 1 $$\n将此方程模 $16807$：\n$$ (12345)(4230) + (16807)(-3107) \\equiv 1 \\pmod{16807} $$\n由于 $16807 \\cdot (-3107)$ 是 $16807$ 的倍数，它模 $16807$ 同余于 $0$。方程简化为：\n$$ (12345)(4230) \\equiv 1 \\pmod{16807} $$\n这表明 $x=4230$ 是 $12345$ 模 $16807$ 的乘法逆元。\n问题要求答案是集合 $\\{0, 1, 2, \\dots, 7^5-1\\}$（即 $\\{0, 1, 2, \\dots, 16806\\}$）中的最小非负剩余。\n由于 $0 \\leq 4230 \\leq 16806$，我们的结果 $4230$ 就是所求的代表元。", "answer": "$$\\boxed{4230}$$", "id": "3083597"}]}