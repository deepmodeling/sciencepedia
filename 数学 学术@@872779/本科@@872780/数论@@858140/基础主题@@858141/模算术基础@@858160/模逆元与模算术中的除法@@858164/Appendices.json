{"hands_on_practices": [{"introduction": "在模算术的世界里，并非所有“除法”运算都是可行的，这与我们熟悉的实数算术不同。一个数是否存在模乘法逆元是一项特殊的性质。本练习将引导你探索决定逆元是否存在的根本条件，并将其与最大公约数（GCD）紧密联系起来。通过这个实践，你将学会如何判断一个数在特定模下是否“可逆”[@problem_id:3087471]。", "problem": "设 $n=77$ 且 $a=35$。仅使用模逆元的定义和用于计算最大公约数 (gcd) 的欧几里得算法，判断 $a$ 是否存在模 $n$ 的模逆元。你的推理应从“如果 $ab \\equiv 1 \\pmod{n}$，则整数 $b$ 是 $a$ 模 $n$ 的模逆元”这一定义出发，并通过欧几里得算法明确计算最大公约数 $\\gcd(a,n)$，然后根据同余式 $ab \\equiv 1 \\pmod{n}$ 来解释结果。如果逆元存在，请通过显式构造给出一个；如果逆元不存在，请解释为何同余式 $35x \\equiv 1 \\pmod{77}$ 无解。\n\n请将你的最终答案表示为 $\\gcd(35,77)$ 的单个值。", "solution": "本题要求我们根据模逆元的定义和欧几里得算法，判断整数 $a=35$ 是否存在模 $n=77$ 的模逆元。\n\n根据题目的定义，如果同余式 $ab \\equiv 1 \\pmod{n}$ 成立，则整数 $b$ 是 $a$ 模 $n$ 的模逆元。对于给定的值 $a=35$ 和 $n=77$，我们寻找一个整数 $b$ 使得：\n$$35b \\equiv 1 \\pmod{77}$$\n同余的定义指出，$x \\equiv y \\pmod{m}$ 当且仅当 $m$ 整除 $(x-y)$。将此定义应用于我们的同余式，我们正在寻找一个整数 $b$，使得 $77$ 整除 $(35b - 1)$。这等价于存在一个整数 $k$ 使得：\n$$35b - 1 = 77k$$\n整理这个方程，我们得到一个关于变量 $b$ 和 $k$ 的线性丢番图方程：\n$$35b - 77k = 1$$\n数论中的一个基本结果，即裴蜀恒等式 (Bézout's identity)，指出形式为 $ax + ny = c$ 的线性丢番图方程有整数解 $(x, y)$ 当且仅当最大公约数 $\\gcd(a, n)$ 整除 $c$。在我们的例子中，$a=35$，$n=77$ (或 $-77$，这不影响 gcd)，并且 $c=1$。因此，存在整数解 $b$ 当且仅当 $\\gcd(35, 77)$ 整除 $1$。\n\n为了确定 $\\gcd(35, 77)$，我们按要求应用欧几里得算法。\n该算法过程如下：\n1.  用 $35$ 除 $77$：\n    $$77 = 2 \\cdot 35 + 7$$\n    余数是 $7$。\n2.  用前一个余数 $7$ 除前一个除数 $35$：\n    $$35 = 5 \\cdot 7 + 0$$\n    余数是 $0$。\n\n欧几里得算法中的最后一个非零余数就是最大公约数。在这种情况下，最后一个非零余数是 $7$。因此，\n$$\\gcd(35, 77) = 7$$\n现在我们检查这个值是否能整除 $1$。由于 $7$ 不能整除 $1$，丢番图方程 $35b - 77k = 1$ 没有整数解 $b$ 和 $k$。\n\n为了更直接地看到这一点，我们假设解 $b$ 存在。那么 $35b - 77k = 1$。方程的左边可以被因式分解：\n$$35b - 77k = 7 \\cdot (5b) - 7 \\cdot (11k) = 7(5b - 11k)$$\n为了使方程成立，我们必须有：\n$$7(5b - 11k) = 1$$\n因为 $b$ 和 $k$ 是整数，所以项 $(5b - 11k)$也必须是整数。这个方程意味着 $1$ 是 $7$ 的倍数，这是一个矛盾。因此，不存在这样的整数 $b$ 和 $k$。\n\n方程 $35b - 77k = 1$ 没有整数解 $b$ 意味着不存在满足同余式 $35b \\equiv 1 \\pmod{77}$ 的整数 $b$。因此，$a=35$ 不存在模 $n=77$ 的模逆元。\n\n题目要求的最终答案是 $\\gcd(35, 77)$ 的单个值，我们已计算出其为 $7$。", "answer": "$$\\boxed{7}$$", "id": "3087471"}, {"introduction": "在确定了逆元存在的条件之后，下一步自然就是如何找到它。本练习将向你介绍扩展欧几里得算法，这是一个强大且具有构造性的工具。它不仅能通过计算最大公约数来验证两个数是否互质，还能同时明确地计算出所需的逆元[@problem_id:3087443]。掌握此算法是计算数论的基石。", "problem": "设 $n$ 是一个大于 1 的整数，我们考虑在模 $n$ 的整数环中的算术运算。对于一个整数 $a$，其模 $n$ 的乘法逆元是一个整数 $x$，使得 $ax \\equiv 1 \\pmod{n}$。根据裴蜀恒等式存在整数解的结论，这样的逆元存在的充要条件是 $\\gcd(a,n) = 1$。仅使用这些基本事实和扩展欧几里得算法 (EEA)，计算一个满足 $37x \\equiv 1 \\pmod{101}$ 的明确整数 $x$，然后通过直接将乘积模 101 进行约简，来验证你计算出的 $x$ 是否正确。将 $x$ 表示为模 101 的最小正剩余。最终答案必须是单个整数。", "solution": "一个整数 $a$ 模 $n$ 的乘法逆元存在的充要条件是 $a$ 和 $n$ 的最大公约数（记为 $\\gcd(a, n)$）为 1。在本例中，$a=37$，$n=101$。由于 101 是一个质数，且 37 不是 101 的倍数（因为 $1  37  101$），因此 $\\gcd(37, 101) = 1$。因此，37 模 101 的乘法逆元存在且唯一。\n\n我们的任务是找到一个整数 $x$，使得：\n$$37x \\equiv 1 \\pmod{101}$$\n该同余式等价于存在一个整数 $k$ 使得 $37x - 1 = 101k$。重新整理这个方程，我们得到一个裴蜀恒等式形式的线性丢番图方程：\n$$37x - 101k = 1$$\n我们可以使用扩展欧几里得算法 (EEA) 来求解整数 $x$ 和 $k$。我们将方程记为 $37x + 101y = 1$，其中 $y = -k$。对数对 $(101, 37)$ 应用 EEA。\n\n首先，我们执行欧几里得算法的除法序列：\n\\begin{align*} 101 = 2 \\cdot 37 + 27 \\\\ 37 = 1 \\cdot 27 + 10 \\\\ 27 = 2 \\cdot 10 + 7 \\\\ 10 = 1 \\cdot 7 + 3 \\\\ 7 = 2 \\cdot 3 + 1 \\\\ 3 = 3 \\cdot 1 + 0 \\end{align*}\n最后一个非零余数是 1，这证实了 $\\gcd(101, 37)=1$。\n\n接下来，我们从这些方程反向回代，将最大公约数 1 表示为 101 和 37 的线性组合。\n从倒数第二个方程开始，我们有：\n$$1 = 7 - 2 \\cdot 3$$\n现在，我们用前一个方程中余数 3 的表达式 ($3 = 10 - 1 \\cdot 7$) 进行代换：\n$$1 = 7 - 2 \\cdot (10 - 1 \\cdot 7) = 7 - 2 \\cdot 10 + 2 \\cdot 7 = 3 \\cdot 7 - 2 \\cdot 10$$\n接下来，代换余数 7 的表达式 ($7 = 27 - 2 \\cdot 10$)：\n$$1 = 3 \\cdot (27 - 2 \\cdot 10) - 2 \\cdot 10 = 3 \\cdot 27 - 6 \\cdot 10 - 2 \\cdot 10 = 3 \\cdot 27 - 8 \\cdot 10$$\n接下来，代换余数 10 的表达式 ($10 = 37 - 1 \\cdot 27$)：\n$$1 = 3 \\cdot 27 - 8 \\cdot (37 - 1 \\cdot 27) = 3 \\cdot 27 - 8 \\cdot 37 + 8 \\cdot 27 = 11 \\cdot 27 - 8 \\cdot 37$$\n最后，代换余数 27 的表达式 ($27 = 101 - 2 \\cdot 37$)：\n$$1 = 11 \\cdot (101 - 2 \\cdot 37) - 8 \\cdot 37 = 11 \\cdot 101 - 22 \\cdot 37 - 8 \\cdot 37$$\n合并含有 37 的项，我们得到：\n$$1 = 11 \\cdot 101 - 30 \\cdot 37$$\n这可以写成：\n$$(-30) \\cdot 37 + (11) \\cdot 101 = 1$$\n这个方程的形式为 $ax + ny = \\gcd(a,n)$，其中 $a=37$，$n=101$，$x=-30$，$y=11$。将此方程模 101，得到：\n$$(-30) \\cdot 37 + (11) \\cdot 101 \\equiv 1 \\pmod{101}$$\n因为 $(11) \\cdot 101$ 是 101 的倍数，所以它模 101 的余数为 0。\n$$(-30) \\cdot 37 + 0 \\equiv 1 \\pmod{101}$$\n$$(-30) \\cdot 37 \\equiv 1 \\pmod{101}$$\n这表明 $x = -30$ 是 37 模 101 的一个有效乘法逆元。题目要求 $x$ 的最小正剩余。为了找到它，我们将模数 101 加到 -30 上：\n$$x \\equiv -30 \\pmod{101} \\implies x \\equiv -30 + 101 \\pmod{101} \\implies x \\equiv 71 \\pmod{101}$$\n$x$ 的最小正整数值是 71。\n\n最后，我们必须通过直接将乘积 $37x$ 模 101 约简来验证此结果。我们计算乘积 $37 \\cdot 71$：\n$$37 \\cdot 71 = 2627$$\n为了求出 2627 除以 101 的余数，我们进行除法运算：\n$$2627 = 101 \\cdot q + r, \\quad \\text{其中 } 0 \\le r  101$$\n我们可以计算商 $q$：$q = \\lfloor \\frac{2627}{101} \\rfloor = \\lfloor 26.009... \\rfloor = 26$。\n现在，我们求余数 $r$：\n$$2627 = 101 \\cdot 26 + r$$\n$$2627 = 2626 + r$$\n$$r = 1$$\n因此，$2627 \\equiv 1 \\pmod{101}$，这意味着 $37 \\cdot 71 \\equiv 1 \\pmod{101}$。计算出的值 $x=71$ 是正确的。", "answer": "$$\\boxed{71}$$", "id": "3087443"}, {"introduction": "掌握了求模逆元的方法后，我们现在可以解决更广泛的“除法”问题：求解形如 $ax \\equiv b \\pmod n$ 的线性同余方程。本练习将综合运用你所学的知识，展示一个存在多个解的案例。它将让你深刻理解最大公约数不仅决定了方程的可解性，还揭示了整个解集的结构[@problem_id:3087491]。", "problem": "设 $a=18$，$b=30$ 且 $n=42$。回顾定义：对于整数 $x,y,n$ 且 $n \\neq 0$，同余式 $x \\equiv y \\pmod{n}$ 表示 $n$ 整除 $x-y$。仅使用此定义和整除性的性质（包括用于求最大公约数（GCD）的欧几里得算法和贝祖恒等式），完成以下任务：\n- 确定 $d=\\gcd(a,n)$。\n- 从第一性原理出发，分析线性同余方程 $18x \\equiv 30 \\pmod{42}$ 以判断解是否存在。如果存在解，导出所有整数解的完整描述，并确定它们所代表的模 $42$ 的不同剩余类。\n将您的最终答案表示为给出 $d$ 和 $x$ 的解集的单个封闭形式解析表达式。无需四舍五入。", "solution": "问题要求我们分析线性同余方程 $18x \\equiv 30 \\pmod{42}$。给定 $a=18$，$b=30$ 和 $n=42$。分析将从第一性原理出发，利用同余的定义、整除性的性质、欧几里得算法和贝祖恒等式进行。\n\n首先，我们确定 $d = \\gcd(a, n) = \\gcd(18, 42)$。我们应用欧几里得算法：\n$$42 = 2 \\cdot 18 + 6$$\n$$18 = 3 \\cdot 6 + 0$$\n最后一个非零余数是最大公约数。因此，我们有 $d = \\gcd(18, 42) = 6$。\n\n接下来，我们分析同余方程 $18x \\equiv 30 \\pmod{42}$ 解的存在性。根据同余的定义，该陈述等价于断言 $n$ 整除 $(ax-b)$，在本例中即 $42$ 整除 $(18x - 30)$。这意味着存在一个整数，我们称之为 $k$，使得：\n$$18x - 30 = 42k$$\n整理该方程得到一个关于变量 $x$ 和 $k$ 的线性丢番图方程：\n$$18x - 42k = 30$$\n数论中的一个基本结果指出，形式为 $Ax + By = C$ 的线性丢番图方程有整数解 $(x, y)$ 的充要条件是 $\\gcd(A, B)$ 整除 $C$。在我们的问题中，$A=18$，$B=-42$，$C=30$。最大公约数是 $\\gcd(18, -42) = \\gcd(18, 42) = 6$。解存在的条件是 $6$ 必须整除 $30$。由于 $30 = 5 \\cdot 6$，此条件得到满足，我们得出结论，该同余方程有解。\n\n为了找到解，我们处理等价的丢番图方程。我们可以将整个方程除以 $d=6$：\n$$\\frac{18}{6}x - \\frac{42}{6}k = \\frac{30}{6}$$\n$$3x - 7k = 5$$\n这个简化后的方程等价于同余式 $3x \\equiv 5 \\pmod{7}$。为了解出 $x$，我们必须找到 $3$ 模 $7$ 的乘法逆元。我们可以使用扩展欧几里得算法，它是求最大公约数过程的延伸。从步骤 $7 = 2 \\cdot 3 + 1$ 中，我们可以将最大公约数 $1$ 表示为 $7$ 和 $3$ 的线性组合：\n$$1 = 7 - 2 \\cdot 3$$\n考虑此方程模 $7$，我们有 $1 \\equiv -2 \\cdot 3 \\pmod{7}$。由于 $-2 \\equiv 5 \\pmod{7}$，这变为 $1 \\equiv 5 \\cdot 3 \\pmod{7}$。因此，$3$ 模 $7$ 的乘法逆元是 $5$。\n\n现在，我们将同余式 $3x \\equiv 5 \\pmod{7}$ 的两边都乘以逆元 $5$：\n$$5 \\cdot (3x) \\equiv 5 \\cdot 5 \\pmod{7}$$\n$$(5 \\cdot 3) x \\equiv 25 \\pmod{7}$$\n$$1 \\cdot x \\equiv 4 \\pmod{7}$$\n最后一步是因为 $25 = 3 \\cdot 7 + 4$。因此，$x$ 的解是所有与 $4$ 模 $7$ 同余的整数。\n\n这组完整的整数解可以用参数形式表示。一个整数 $x$ 满足 $x \\equiv 4 \\pmod{7}$ 当且仅当它可以写成：\n$$x = 4 + 7m$$\n对于某个整数 $m \\in \\mathbb{Z}$。因此，所有解的集合是等差数列 $\\{ \\dots, -10, -3, 4, 11, 18, \\dots \\}$，其形式上表示为集合 $4 + 7\\mathbb{Z}$。\n\n问题还要求找出模 $42$ 的不同剩余类。这些可以通过取 $m$ 从 $0$ 到 $d-1 = 5$ 的值来找到：\n对于 $m=0$，$x = 4$。\n对于 $m=1$，$x = 11$。\n对于 $m=2$，$x = 18$。\n对于 $m=3$，$x = 25$。\n对于 $m=4$，$x = 32$。\n对于 $m=5$，$x = 39$。\n对于 $m=6$，$x = 4 + 7(6) = 46 \\equiv 4 \\pmod{42}$，所以解开始重复。模 $42$ 有 $d=6$ 个不同的解。表达式 $x = 4+7m$（其中 $m \\in \\mathbb{Z}$）是所有整数解的完整描述，这些解归结为模 $42$ 的这 $6$ 个不同类别。\n\n总而言之，$d=\\gcd(18, 42)=6$，且 $x$ 的所有整数解的集合由 $\\{x \\in \\mathbb{Z} \\mid x \\equiv 4 \\pmod{7}\\}$ 给出。", "answer": "$$\\boxed{\\pmatrix{6  4+7\\mathbb{Z}}}$$", "id": "3087491"}]}