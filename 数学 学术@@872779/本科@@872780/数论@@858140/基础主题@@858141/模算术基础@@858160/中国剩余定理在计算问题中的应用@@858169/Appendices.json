{"hands_on_practices": [{"introduction": "在我们运用中国剩余定理（CRT）的全部威力来解决复杂的计算问题之前，必须先掌握其基础的构造性算法。本练习将引导您从基本原理出发，构建一个“重构蓝图”，为理解如何从一组余数系统地组合出唯一解提供坚实的基础。通过完成此练习，您将对该定理的构造性证明有一个具体的理解[@problem_id:3081036]。", "problem": "在一个分布式存储环境中，一个未知的非负整数 $x$ 通过存储其模 $3$、$5$ 和 $7$ 的余数来进行冗余编码。你的任务是基于基本原理设计一个可复用的数值重构蓝图，然后将其应用于一个具体实例。\n\n仅从以下基本事实出发：\n- 如果整数 $m_1,\\dots,m_k$ 两两互质，那么对于任意余数 $r_1,\\dots,r_k$，同余方程组 $x\\equiv r_i \\pmod{m_i}$ 存在模 $M=m_1\\cdots m_k$ 的唯一解（中国剩余定理 (CRT)）。\n- 贝祖等式 (Bézout’s identity)：对于互质整数 $a$ 和 $b$，存在整数 $u$ 和 $v$ 使得 $au+bv=1$。\n\n完成以下任务：\n1) 构造在范围 $\\{0,1,\\dots,104\\}$ 内的明确整数 $b_3,b_5,b_7$，使得 $b_3\\equiv 1 \\pmod{3}$ 且 $b_3\\equiv 0 \\pmod{5}$ 且 $b_3\\equiv 0 \\pmod{7}$；$b_5\\equiv 0 \\pmod{3}$ 且 $b_5\\equiv 1 \\pmod{5}$ 且 $b_5\\equiv 0 \\pmod{7}$；$b_7\\equiv 0 \\pmod{3}$ 且 $b_7\\equiv 0 \\pmod{5}$ 且 $b_7\\equiv 1 \\pmod{7}$。这些整数构成了一个可复用的数值重构蓝图，即一旦确定，它们就可以与任意余数组 $(r_3,r_5,r_7)$ 线性组合，从而得到模 $105$ 的唯一解。\n2) 使用你的蓝图，重构满足 $x\\equiv 2 \\pmod{3}$，$x\\equiv 4 \\pmod{5}$ 和 $x\\equiv 3 \\pmod{7}$ 的唯一解 $x\\in[0,105)$。\n3) 根据基本事实，论证为何你重构的 $x$ 在区间 $[0,105)$ 内是唯一的。\n\n只报告 $x$ 的值作为你的最终数值答案。无需四舍五入。", "solution": "该问题要求使用中国剩余定理 (CRT) 的原理求解一个线性同余方程组。模数为 $m_1 = 3$，$m_2 = 5$ 和 $m_3 = 7$。它们是两两互质的整数。模数之积为 $M = m_1 m_2 m_3 = 3 \\times 5 \\times 7 = 105$。解法按规定分三个阶段进行。\n\n**1) 构造数值重构蓝图**\n\n中国剩余定理构造性证明的核心是找到一组整数 $b_3, b_5, b_7$，其中每个 $b_i$ 模 $m_i$ 同余于 $1$，且对于 $j \\neq i$，模 $m_j$ 同余于 $0$。\n\n- **计算 $b_3$**：\n我们要求 $b_3 \\equiv 1 \\pmod{3}$，$b_3 \\equiv 0 \\pmod{5}$ 以及 $b_3 \\equiv 0 \\pmod{7}$。后两个同余式意味着 $b_3$ 必须是 $5 \\times 7 = 35$ 的倍数，因为 $5$ 和 $7$ 互质。我们可以将 $b_3$ 写成 $b_3 = 35k$ 的形式，其中 $k$ 是某个整数。将此代入第一个同余式得到：\n$$35k \\equiv 1 \\pmod{3}$$\n由于 $35 = 11 \\times 3 + 2$，我们有 $35 \\equiv 2 \\pmod{3}$。该同余式化简为：\n$$2k \\equiv 1 \\pmod{3}$$\n为求解 $k$，我们需求解 $2$ 模 $3$ 的乘法逆元。对于互质整数 $2$ 和 $3$，贝祖等式 (Bézout's identity) 保证了逆元的存在。通过观察，我们看到 $2 \\times 2 = 4 \\equiv 1 \\pmod{3}$，所以 $2$ 模 $3$ 的逆元是 $2$。将同余式两边乘以 $2$：\n$$2(2k) \\equiv 2(1) \\pmod{3} \\implies 4k \\equiv 2 \\pmod{3} \\implies k \\equiv 2 \\pmod{3}$$\n我们选择最小的非负整数 $k$，即 $k=2$。由此得到 $b_3 = 35 \\times 2 = 70$。该值在要求的范围 $\\{0, 1, \\dots, 104\\}$ 内。\n\n- **计算 $b_5$**：\n我们要求 $b_5 \\equiv 0 \\pmod{3}$，$b_5 \\equiv 1 \\pmod{5}$ 以及 $b_5 \\equiv 0 \\pmod{7}$。这意味着 $b_5$ 必须是 $3 \\times 7 = 21$ 的倍数。所以，$b_5 = 21k$。代入第二个同余式：\n$$21k \\equiv 1 \\pmod{5}$$\n由于 $21 = 4 \\times 5 + 1$，我们有 $21 \\equiv 1 \\pmod{5}$。该同余式变为：\n$$k \\equiv 1 \\pmod{5}$$\n选择 $k=1$，我们得到 $b_5 = 21 \\times 1 = 21$。该值在要求的范围内。\n\n- **计算 $b_7$**：\n我们要求 $b_7 \\equiv 0 \\pmod{3}$，$b_7 \\equiv 0 \\pmod{5}$ 以及 $b_7 \\equiv 1 \\pmod{7}$。这意味着 $b_7$ 必须是 $3 \\times 5 = 15$ 的倍数。所以，$b_7 = 15k$。代入第三个同余式：\n$$15k \\equiv 1 \\pmod{7}$$\n由于 $15 = 2 \\times 7 + 1$，我们有 $15 \\equiv 1 \\pmod{7}$。该同余式变为：\n$$k \\equiv 1 \\pmod{7}$$\n选择 $k=1$，我们得到 $b_7 = 15 \\times 1 = 15$。该值在要求的范围内。\n\n得到的数值重构蓝图由整数 $b_3 = 70$，$b_5 = 21$ 和 $b_7 = 15$ 组成。\n\n**2) 重构 $x$**\n\n我们需要求解满足以下同余方程组的唯一整数 $x \\in [0, 105)$：\n$$x \\equiv 2 \\pmod{3}$$\n$$x \\equiv 4 \\pmod{5}$$\n$$x \\equiv 3 \\pmod{7}$$\n解 $x$ 可以通过蓝图整数 $b_i$ 与相应余数 $r_i$ 加权线性组合来构造：\n$$x = r_3 b_3 + r_5 b_5 + r_7 b_7$$\n任何这样的 $x$ 都满足同余方程组。例如，对于模 $3$，$x \\equiv r_3(1) + r_5(0) + r_7(0) \\equiv r_3 \\pmod{3}$。同样的逻辑也适用于模 $5$ 和 $7$。\n代入给定的余数 $r_3 = 2$，$r_5 = 4$，$r_7 = 3$ 和计算出的 $b_i$ 值：\n$$x' = (2)(70) + (4)(21) + (3)(15) = 140 + 84 + 45 = 269$$\n为了找到区间 $[0, 105)$ 内的唯一解，我们将结果对 $105$ 取模：\n$$x \\equiv 269 \\pmod{105}$$\n由于 $269 = 2 \\times 105 + 59$，余数是 $59$。\n因此，唯一解是 $x = 59$。\n\n**3) 唯一性论证**\n\n区间 $[0, M)$ 内解的唯一性是中国剩余定理的基石。这可以从基本事实中得到论证。\n假设在区间 $[0, 105)$ 内存在两个不同的解 $x_1$ 和 $x_2$。两个解都必须满足给定的同余方程：\n$$x_1 \\equiv r_i \\pmod{m_i} \\quad \\text{and} \\quad x_2 \\equiv r_i \\pmod{m_i} \\quad \\text{for } i \\in \\{1,2,3\\}$$\n将 $x_1$ 的同余方程减去 $x_2$ 的同余方程，我们得到：\n$$x_1 - x_2 \\equiv 0 \\pmod{3}$$\n$$x_1 - x_2 \\equiv 0 \\pmod{5}$$\n$$x_1 - x_2 \\equiv 0 \\pmod{7}$$\n这些同余式意味着差值 $x_1 - x_2$ 是 $3$、$5$ 和 $7$ 的倍数。由于 $3$、$5$ 和 $7$ 两两互质，它们的最小公倍数就是它们的乘积 $M=105$。因此，$x_1 - x_2$ 必须是 $105$ 的倍数。我们可以将其写为：\n$$x_1 - x_2 \\equiv 0 \\pmod{105}$$\n由于 $x_1$ 和 $x_2$ 都在区间 $[0, 105)$ 内，它们满足 $0 \\le x_1  105$ 和 $0 \\le x_2  105$。因此它们的差必须在范围 $-105  x_1 - x_2  105$ 内。在此范围内唯一是 $105$ 的倍数的整数是 $0$。\n因此，$x_1 - x_2 = 0$，这意味着 $x_1 = x_2$。\n这与 $x_1$ 和 $x_2$ 是不同解的假设相矛盾。因此，区间 $[0, 105)$ 内的解必须是唯一的。", "answer": "$$\\boxed{59}$$", "id": "3081036"}, {"introduction": "中国剩余定理是将复杂问题分解为更小、更易于管理的部分的强大工具。本练习展示了它在计算数论中的一个经典应用：求解模合数的二次同余方程。您将学习如何将求解 $x^2 \\equiv a \\pmod{n}$ 的问题简化为求解模其素因数的更简单的同余方程，然后利用CRT将这些结果巧妙地组合成所有可能的解[@problem_id:3081017]。", "problem": "设 $p$ 和 $q$ 为不同的奇素数，令 $n=pq$，并设 $a$ 为一个整数，它是模 $p$ 和模 $q$ 的二次剩余。仅从模 $m$ 同余的定义、环 $\\mathbb{Z}/m\\mathbb{Z}$ 中单位元的基本性质、Fermat's little theorem、Euler's criterion 以及中国剩余定理（CRT）的陈述出发，推导一个计算过程，该过程通过组合 $a$ 模 $p$ 和模 $q$ 的平方根，然后通过CRT将它们提升到模 $n$，来构造 $x^{2}\\equiv a \\pmod{n}$ 的所有解。将你的推导应用于具体实例 $p=11$，$q=19$，$n=209$ 和 $a=5$。计算满足 $x^{2}\\equiv 5 \\pmod{209}$ 的四个剩余类 $x\\in\\{0,1,\\dots,n-1\\}$ 的完整集合，并按升序报告它们。\n\n使用 $\\mathrm{pmatrix}$ 环境将你的最终答案表示为一个单行矩阵，其中的元素按升序排列。无需进行四舍五入。", "solution": "问题要求一个计算过程，以找到同余方程 $x^{2}\\equiv a \\pmod{n}$ 的所有解，其中 $n=pq$，$p$ 和 $q$ 为不同的奇素数，且 $a$ 是一个整数，它是模 $p$ 和模 $q$ 的二次剩余。然后将此过程应用于一个具体实例。\n\n**1. 一般过程的推导**\n\n设给定的同余式为 $x^{2}\\equiv a \\pmod{n}$。由于 $n=pq$ 且 $p, q$ 是不同的素数，它们是互素的。根据同余的定义，$n | (x^{2} - a)$，这意味着 $p | (x^{2} - a)$ 且 $q | (x^{2} - a)$。这等价于以下同余方程组：\n$$\n\\begin{cases}\nx^{2} \\equiv a \\pmod{p} \\\\\nx^{2} \\equiv a \\pmod{q}\n\\end{cases}\n$$\n问题陈述 $a$ 是模 $p$ 和模 $q$ 的二次剩余。由于 $p$ 和 $q$ 是奇素数，且 $a$ 是二次剩余，Legendre symbols $(\\frac{a}{p})$ 和 $(\\frac{a}{q})$ 必须都等于 $1$。这意味着 $a \\not\\equiv 0 \\pmod{p}$ 且 $a \\not\\equiv 0 \\pmod{q}$。因此，这些二次同余式中的每一个都恰好有两个不同的解。\n\n设 $y^{2} \\equiv a \\pmod{p}$ 的解为 $y \\equiv \\pm s_p \\pmod{p}$。\n设 $z^{2} \\equiv a \\pmod{q}$ 的解为 $z \\equiv \\pm s_q \\pmod{q}$。\n\n寻找满足 $x^2 \\equiv a \\pmod{n}$ 的 $x$ 的问题，现在归结为寻找同时满足以下四种可能的一次同余方程组之一的 $x$：\n$$\n\\text{系统 1: } \\begin{cases} x \\equiv s_p \\pmod{p} \\\\ x \\equiv s_q \\pmod{q} \\end{cases}\n\\quad\n\\text{系统 2: } \\begin{cases} x \\equiv s_p \\pmod{p} \\\\ x \\equiv -s_q \\pmod{q} \\end{cases}\n$$\n$$\n\\text{系统 3: } \\begin{cases} x \\equiv -s_p \\pmod{p} \\\\ x \\equiv s_q \\pmod{q} \\end{cases}\n\\quad\n\\text{系统 4: } \\begin{cases} x \\equiv -s_p \\pmod{p} \\\\ x \\equiv -s_q \\pmod{q} \\end{cases}\n$$\n中国剩余定理（CRT）保证对于这些方程组中的每一个，都存在一个模 $n=pq$ 的唯一解 $x$。\n\n为了构造这些解，我们首先找到满足 Bézout's identity: $up + vq = 1$ 的整数 $u$ 和 $v$。这可以使用 Extended Euclidean Algorithm 来完成。从这个等式中，我们得到 $vq \\equiv 1 \\pmod{p}$ 和 $up \\equiv 1 \\pmod{q}$。\n\n对于一个形如 $x \\equiv c_1 \\pmod{p}$ 和 $x \\equiv c_2 \\pmod{q}$ 的一般方程组，解由以下公式给出：\n$$\nx \\equiv c_1(vq) + c_2(up) \\pmod{pq}\n$$\n我们验证这个构造：\n模 $p$：$x \\equiv c_1(vq) + c_2(up) \\equiv c_1(1) + c_2(0) \\equiv c_1 \\pmod{p}$。\n模 $q$：$x \\equiv c_1(vq) + c_2(up) \\equiv c_1(0) + c_2(1) \\equiv c_2 \\pmod{q}$。\n\n将此构造应用于这四个方程组，可以得到 $x^2 \\equiv a \\pmod{n}$ 的四个不同解。\n\n**2. 应用于具体实例**\n\n给定 $p=11$，$q=19$，$n=pq=209$，以及 $a=5$。我们必须找到所有满足 $x^{2} \\equiv 5 \\pmod{209}$ 的 $x \\in \\{0, 1, \\dots, 208\\}$。\n\n**步骤 2a：求解模 $p=11$ 的根。**\n我们需要解 $x^2 \\equiv 5 \\pmod{11}$。对于素数 $p=11 \\equiv 3 \\pmod 4$，二次剩余 $a$ 的平方根由 $\\pm a^{(p+1)/4} \\pmod{p}$ 给出。\n指数为 $(11+1)/4 = 3$。\n所以，根为 $\\pm 5^3 \\pmod{11}$。\n$5^2 = 25 \\equiv 3 \\pmod{11}$。\n$5^3 = 5 \\cdot 5^2 \\equiv 5 \\cdot 3 = 15 \\equiv 4 \\pmod{11}$。\n因此，$s_p = 4$。两个解是 $x \\equiv 4 \\pmod{11}$ 和 $x \\equiv -4 \\equiv 7 \\pmod{11}$。\n\n**步骤 2b：求解模 $q=19$ 的根。**\n我们需要解 $x^2 \\equiv 5 \\pmod{19}$。\n对于素数 $q=19 \\equiv 3 \\pmod 4$，指数为 $(19+1)/4 = 5$。\n所以，根为 $\\pm 5^5 \\pmod{19}$。\n$5^2 = 25 \\equiv 6 \\pmod{19}$。\n$5^4 \\equiv 6^2 = 36 \\equiv 17 \\equiv -2 \\pmod{19}$。\n$5^5 = 5 \\cdot 5^4 \\equiv 5 \\cdot (-2) = -10 \\equiv 9 \\pmod{19}$。\n因此，$s_q = 9$。两个解是 $x \\equiv 9 \\pmod{19}$ 和 $x \\equiv -9 \\equiv 10 \\pmod{19}$。\n\n**步骤 2c：为 CRT 寻找系数。**\n我们必须找到整数 $u, v$ 使得 $11u + 19v = 1$。使用 Extended Euclidean Algorithm：\n$19 = 1 \\cdot 11 + 8$\n$11 = 1 \\cdot 8 + 3$\n$8 = 2 \\cdot 3 + 2$\n$3 = 1 \\cdot 2 + 1$\n逆向回代：\n$1 = 3 - 1 \\cdot 2 = 3 - (8 - 2 \\cdot 3) = 3 \\cdot 3 - 8$\n$1 = 3(11 - 8) - 8 = 3 \\cdot 11 - 4 \\cdot 8$\n$1 = 3 \\cdot 11 - 4(19 - 1 \\cdot 11) = 3 \\cdot 11 - 4 \\cdot 19 + 4 \\cdot 11 = 7 \\cdot 11 - 4 \\cdot 19$。\n所以我们得到 $u=7$ 和 $v=-4$。\nCRT 提升项是 $up = 7 \\cdot 11 = 77$ 和 $vq = -4 \\cdot 19 = -76$。\n\n**步骤 2d：构造模 $209$ 的四个解。**\n通解形式为 $x \\equiv c_1(-76) + c_2(77) \\pmod{209}$，其中 $c_1$ 是模 $11$ 的一个根，$c_2$ 是模 $19$ 的一个根。\n\n系统 1: $c_1=4, c_2=9$。\n$x_1 \\equiv 4(-76) + 9(77) = -304 + 693 = 389 \\equiv 180 \\pmod{209}$。\n\n系统 2: $c_1=4, c_2=10$。\n$x_2 \\equiv 4(-76) + 10(77) = -304 + 770 = 466 \\equiv 48 \\pmod{209}$。\n\n系统 3: $c_1=7, c_2=9$。\n$x_3 \\equiv 7(-76) + 9(77) = -532 + 693 = 161 \\pmod{209}$。\n注意 $x_3 \\equiv -x_2 \\pmod{209}$。\n\n系统 4: $c_1=7, c_2=10$。\n$x_4 \\equiv 7(-76) + 10(77) = -532 + 770 = 238 \\equiv 29 \\pmod{209}$。\n注意 $x_4 \\equiv -x_1 \\pmod{209}$。\n\n集合 $\\{0, 1, \\dots, 208\\}$ 中 $x$ 的四个解是 $29$，$48$，$161$ 和 $180$。\n我们验证一个解：$29^2 = 841 = 4 \\cdot 209 + 5$，所以 $29^2 \\equiv 5 \\pmod{209}$。因为其他解是 $\\pm 29 \\pmod{209}$ 和 $\\pm 48 \\pmod{209}$，它们的平方也将同余于 $5 \\pmod{209}$。\n\n将解按升序排列，我们得到 $29, 48, 161, 180$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 29  48  161  180 \\end{pmatrix}}\n$$", "id": "3081017"}, {"introduction": "除了理论应用，中国剩余定理还为构建容错系统等工程挑战提供了优雅的解决方案。本问题探讨了冗余余数系统的概念，即利用额外信息来检测和纠正存储数据中的错误。通过这个场景的演练，您将了解如何利用CRT的数学特性来确保计算系统中的数据完整性[@problem_id:3081040]。", "problem": "整数 $x$ 使用一个冗余剩余数系统进行编码，其模两两互质，分别为 $m_1=7$, $m_2=9$, $m_3=10$, $m_4=29$ 和 $m_5=31$。主系统的动态范围是 $M=m_1 m_2 m_3=630$。两个冗余模满足 $m_4 m_5=899M$。观测到的剩余向量为\n$$\n(r_1,r_2,r_3,r_4,r_5)=(1,2,1,15,18),\n$$\n其中 $r_1$、$r_2$、$r_3$ 中恰好有一个是错误的，而 $r_4$ 和 $r_5$ 是可靠的。仅使用中国剩余定理 (CRT) 的推论，执行一次冗余一致性检查，并证明对错误剩余的检测和纠正是合理的。确定恢复出的整数 $x$ (在 $0 \\leq x  M$ 范围内)。将最终答案表示为一个精确整数（无舍入）。", "solution": "该问题要求使用冗余剩余数系统来检测和纠正错误。核心思想是利用可靠的冗余信息重构原始数，然后用它来识别和修正主系统中的错误。\n\n**1. 原理**\n\n我们知道原始整数 $x$ 在动态范围 $0 \\le x  M$ 内，其中 $M=m_1 m_2 m_3 = 7 \\cdot 9 \\cdot 10 = 630$。我们还有两个冗余模 $m_4=29$ 和 $m_5=31$，其对应的余数 $r_4=15$ 和 $r_5=18$ 是可靠的。冗余系统的动态范围是 $M_{redundant} = m_4 m_5 = 29 \\cdot 31 = 899$。由于 $M_{redundant} > M$，根据中国剩余定理，在 $[0, M_{redundant})$ 范围内存在一个唯一的整数与余数对 $(r_4, r_5)$ 对应。因为我们知道 $x$ 必然小于 $M=630$，所以这个唯一确定的整数就是 $x$。\n\n**2. 使用冗余余数重构 $x$**\n\n我们的任务是求解同余方程组：\n$$\n\\begin{cases}\nx \\equiv 15 \\pmod{29} \\\\\nx \\equiv 18 \\pmod{31}\n\\end{cases}\n$$\n从第一个同余式，我们知道 $x$ 可以写成 $x = 15 + 29k$ 的形式，其中 $k$ 是某个整数。将这个表达式代入第二个同余式：\n$$15 + 29k \\equiv 18 \\pmod{31}$$\n$$29k \\equiv 3 \\pmod{31}$$\n由于 $29 \\equiv -2 \\pmod{31}$，方程变为：\n$$-2k \\equiv 3 \\pmod{31}$$\n我们需要求解 $-2$ 模 $31$ 的乘法逆元。我们可以通过扩展欧几里得算法求解，或者观察到 $15 \\cdot (-2) = -30 \\equiv 1 \\pmod{31}$。因此，$-2$ 的逆元是 $15$。\n将方程两边乘以 $15$：\n$$k \\equiv 3 \\cdot 15 \\pmod{31}$$\n$$k \\equiv 45 \\pmod{31}$$\n$$k \\equiv 14 \\pmod{31}$$\n我们可以取 $k=14$。将它代回 $x$ 的表达式：\n$$x = 15 + 29 \\times 14 = 15 + 406 = 421$$\n由于 $0 \\le 421  630$，这个值在主系统的动态范围内，所以恢复出的整数是 $x=421$。\n\n**3. 错误检测与纠正**\n\n现在我们验证主系统中的哪个余数是错误的。观测到的余数是 $(r_1, r_2, r_3) = (1, 2, 1)$。我们计算 $x=421$ 的正确余数：\n- 模 $m_1=7$：$421 = 60 \\times 7 + 1 \\implies 421 \\equiv 1 \\pmod 7$。这与观测到的 $r_1=1$ 相符。\n- 模 $m_2=9$：$421$ 的各位数字之和为 $4+2+1=7$，所以 $421 \\equiv 7 \\pmod 9$。这与观测到的 $r_2=2$ **不符**。\n- 模 $m_3=10$：$421 \\equiv 1 \\pmod{10}$。这与观测到的 $r_3=1$ 相符。\n\n因此，错误的余数是 $r_2$。我们的分析证明，仅使用可靠的冗余余数，我们就可以唯一地恢复原始整数 $x$，并识别出主系统中的错误。恢复出的整数是 $421$。", "answer": "$$\\boxed{421}$$", "id": "3081040"}]}