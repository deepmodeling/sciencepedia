{"hands_on_practices": [{"introduction": "扩展欧几里得算法是求解形如 $ax+by=\\gcd(a,b)$ 的线性丢番图方程的基石。虽然这样的方程有无限多组整数解，但在实际应用中，我们常常需要找到一个“最优”或“最小”的解。这个练习 [@problem_id:3086858] 不仅能让你熟练运用该算法，还能让你深入理解通解的结构，并学会如何从中筛选出符合特定要求的唯一解。", "problem": "设 $a$ 和 $b$ 是互质的正整数。如果一对整数 $(x,y)$ 满足 $a x + b y = 1$，则称其为 $(a,b)$ 的一个裴蜀对。在所有这样的整数对中，选取唯一的对 $(x^{\\ast},y^{\\ast})$，使得 $|x|$ 最小，如果存在多个使 $|x|$ 最小的对，则选择其中 $|y|$ 较小的那一个。请确定当 $a = 98765$ 和 $b = 43211$ 时的这个数对，并将你的答案以单行矩阵 $\\begin{pmatrix} x^{\\ast}  y^{\\ast} \\end{pmatrix}$ 的形式报告。最终答案必须是精确值（不得四舍五入）。", "solution": "该问题要求找到线性丢番图方程 $ax + by = 1$ 的一个特定整数解 $(x^{\\ast}, y^{\\ast})$，其中 $a = 98765$ 且 $b = 43211$。已知整数 $a$ 和 $b$ 互质，这是 $ax+by=1$ 存在整数解的必要条件，由裴蜀定理保证。特定解 $(x^{\\ast}, y^{\\ast})$ 的定义是使 $|x|$ 最小的解，若存在多个使 $|x|$ 达到最小值的解对，则根据附加规则选择其中 $|y|$ 较小的那个。\n\n首先，我们使用扩展欧几里得算法来验证 $\\gcd(a, b) = \\gcd(98765, 43211) = 1$ 并找到一个特解 $(x_0, y_0)$。我们记 $r_0 = a$ 和 $r_1 = b$。\n\n除法序列如下：\n$r_0 = 2 r_1 + 12343 \\implies 98765 = 2 \\cdot 43211 + 12343$\n$r_1 = 3 r_2 + 6182 \\implies 43211 = 3 \\cdot 12343 + 6182$\n$r_2 = 1 r_3 + 6161 \\implies 12343 = 1 \\cdot 6182 + 6161$\n$r_3 = 1 r_4 + 21 \\implies 6182 = 1 \\cdot 6161 + 21$\n$r_4 = 293 r_5 + 8 \\implies 6161 = 293 \\cdot 21 + 8$\n$r_5 = 2 r_6 + 5 \\implies 21 = 2 \\cdot 8 + 5$\n$r_6 = 1 r_7 + 3 \\implies 8 = 1 \\cdot 5 + 3$\n$r_7 = 1 r_8 + 2 \\implies 5 = 1 \\cdot 3 + 2$\n$r_8 = 1 r_9 + 1 \\implies 3 = 1 \\cdot 2 + 1$\n最后一个非零余数是 $1$，所以 $\\gcd(98765, 43211) = 1$，证实它们互质。\n\n为了找到一个特解，我们将最后的余数 $1$ 表示为 $a$ 和 $b$ 的线性组合。这可以通过扩展欧几里得算法系统地完成。\n\n设 $r_i = s_i a + t_i b$。\n当 $i=0$ 时：$r_0 = a = 1 \\cdot a + 0 \\cdot b \\implies s_0 = 1, t_0 = 0$。\n当 $i=1$ 时：$r_1 = b = 0 \\cdot a + 1 \\cdot b \\implies s_1 = 0, t_1 = 1$。\n递推关系为 $(s_{i+1}, t_{i+1}) = (s_{i-1} - q_i s_i, t_{i-1} - q_i t_i)$，其中 $r_{i-1} = q_i r_i + r_{i+1}$。\n商分别为 $q_1=2, q_2=3, q_3=1, q_4=1, q_5=293, q_6=2, q_7=1, q_8=1, q_9=1$。\n$s_2 = s_0 - q_1 s_1 = 1-2(0) = 1$, $t_2 = t_0 - q_1 t_1 = 0-2(1)=-2$。\n$s_3 = s_1 - q_2 s_2 = 0-3(1) = -3$, $t_3 = t_1 - q_2 t_2 = 1-3(-2)=7$。\n$s_4 = s_2 - q_3 s_3 = 1-1(-3) = 4$, $t_4 = t_2 - q_3 t_3 = -2-1(7)=-9$。\n$s_5 = s_3 - q_4 s_4 = -3-1(4) = -7$, $t_5 = t_3 - q_4 t_4 = 7-1(-9)=16$。\n$s_6 = s_4 - q_5 s_5 = 4-293(-7) = 2055$, $t_6 = t_4 - q_5 t_5 = -9-293(16)=-4697$。\n$s_7 = s_5 - q_6 s_6 = -7-2(2055) = -4117$, $t_7 = t_5 - q_6 t_6 = 16-2(-4697)=9410$。\n$s_8 = s_6 - q_7 s_7 = 2055-1(-4117) = 6172$, $t_8 = t_6 - q_7 t_7 = -4697-1(9410)=-14107$。\n$s_9 = s_7 - q_8 s_8 = -4117-1(6172) = -10289$, $t_9 = t_7 - q_8 t_8 = 9410-1(-14107)=23517$。\n$s_{10} = s_8 - q_9 s_9 = 6172-1(-10289) = 16461$, $t_{10} = t_8 - q_9 t_9 = -14107-1(23517)=-37624$。\n这给出了 $1 = s_{10} a + t_{10} b$ 的系数。\n因此，一个特解是 $(x_0, y_0) = (16461, -37624)$。\n我们可以验证：$98765 \\cdot 16461 + 43211 \\cdot (-37624) = 1625805365 - 1625805364 = 1$。该解是正确的。\n\n$ax + by = 1$ 的通解由下式给出\n$x = x_0 + k \\cdot b = 16461 + k \\cdot 43211$\n$y = y_0 - k \\cdot a = -37624 - k \\cdot 98765$\n其中 $k$ 是任意整数。\n\n我们必须找到一个整数 $k$ 使得 $|x| = |16461 + 43211k|$ 最小。这等价于找到 $b=43211$ 的一个倍数，使其最接近 $-x_0=-16461$。设 $f(k) = 16461 + 43211k$。我们想找到使 $|f(k)|$ 最小的 $k$。\n我们在寻找满足 $43211k \\approx -16461$ 的 $k$，所以 $k \\approx -16461/43211 \\approx -0.38$。\n最接近 $-0.38$ 的整数是 $k=0$ 和 $k=-1$。\n当 $k=0$ 时：$x=16461 + 0 \\cdot 43211 = 16461$。此时 $|x|=16461$。\n当 $k=-1$ 时：$x=16461 - 1 \\cdot 43211 = -26750$。此时 $|x|=26750$。\n比较绝对值，最小值是 $16461$，在 $k=0$ 时取到。\n\n$x$ 的解集是同余类 $x \\equiv 16461 \\pmod{43211}$。我们寻求这个同余类中绝对值最小的代表元。设 $r = 16461$。候选值是 $r$ 和 $r-b = 16461-43211 = -26750$。它们的绝对值分别为 $|r|=16461$ 和 $|r-b|=26750$。只有当 $|r| = |r-b|$ 时，才会出现最小绝对值相同的情况，这意味着 $r = b/2$。这仅当 $b$ 是偶数时才可能发生。由于 $b = 43211$ 是奇数，所以不可能出现相同的情况。因此，使 $|x|$ 最小的 $x$ 值是唯一的。\n因为 $16461  26750$，所以使 $|x|$ 最小的唯一解 $x^{\\ast}$ 是 $x^{\\ast}=16461$。\n\n这对应于选择 $k=0$。对应的 $y$ 值为：\n$y^{\\ast} = -37624 - 0 \\cdot 98765 = -37624$。\n因此，满足给定条件的唯一数对 $(x^{\\ast}, y^{\\ast})$ 是 $(16461, -37624)$。关于 $|y|$ 的平局决胜规则没有用上。\n\n最终答案以行矩阵的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n16461  -37624\n\\end{pmatrix}\n}\n$$", "id": "3086858"}, {"introduction": "在我们掌握了如何为线性组合寻找整数解之后，一个自然而然的问题是：我们是否能仅通过“增加”操作来构成任意一个目标数值？这个练习 [@problemgetId:1381559] 探讨了非负系数线性组合的表达能力边界。它通过一个生动的场景引入了经典的“佛罗贝尼乌斯硬币问题”，揭示了在这种限制下，可表示数与不可表示数之间的有趣分界线。", "problem": "一个材料科学实验室正在通过将 A 型和 B 型两种原子沉积到衬底上，来开发一种新型合金。该过程由一台可以执行两种基本操作的机器控制：\n\n1.  沉积一个由 5 个 A 型原子组成的原子簇。此操作需要固定的时间。\n2.  沉积一个由 7 个 B 型原子组成的原子簇。此操作也需要固定的时间。\n\n机器也可以反向运行这些操作，移除相应数量的原子。一个“程序”包括将 A 型操作运行 $x$ 次，将 B 型操作运行 $y$ 次。整数 $x$ 和 $y$ 可以是正数（沉积）、负数（移除）或零。一个程序 $(x, y)$ 添加到衬底上的原子净数量由 $N = 5x + 7y$ 给出。\n\n如果一个程序可以使用某个整数对 $(x, y)$ 来达到目标原子净数量 $N$，则该程序被视为“有效”。如果一个程序是有效的，并且其 $x$ 和 $y$ 值均为非负整数（即 $x \\ge 0$ 且 $y \\ge 0$），则该程序被视为“仅沉积”程序。\n\n研究团队有兴趣探索他们沉积过程的极限。他们想要找到一个可以通过“有效”程序达到，但无法通过任何“仅沉积”程序达到的最大可能原子净数量 $N_{max}$。\n\n确定 $N_{max}$ 的值。请以整数形式给出答案。", "solution": "设 $x$ 为 A 型操作的执行次数，$y$ 为 B 型操作的执行次数。添加的原子净数量由以下线性方程给出：\n$$N = 5x + 7y$$\n\n问题要求找出满足以下两个条件的最大整数 $N_{max}$：\n1.  方程 $N_{max} = 5x + 7y$ 存在整数解 $(x, y)$。\n2.  方程 $N_{max} = 5x + 7y$ 不存在非负整数解，即不存在整数对 $(x, y)$ 使得 $x \\ge 0$ 且 $y \\ge 0$。\n\n我们来分析第一个条件。一个形如 $ax + by = c$ 的线性丢番图方程有整数解 $(x, y)$ 的充要条件是 $a$ 和 $b$ 的最大公约数（记为 $\\gcd(a, b)$）能整除 $c$。\n在本问题中，$a=5$ 且 $b=7$。最大公约数是 $\\gcd(5, 7)$。由于 5 和 7 是不同的质数，它们互质，所以 $\\gcd(5, 7) = 1$。\n对于任意整数值 $N$，$\\gcd(5, 7)$ 必须整除 $N$ 的条件变为 $1 | N$。这对所有整数 $N$ 都成立。因此，对于任何整数目标 $N$，都存在一个“有效”的程序。\n\n由于第一个条件总是满足，问题简化为寻找使得方程 $5x + 7y = N$ 没有非负整数解（$x \\ge 0, y \\ge 0$）的最大整数 $N$。\n\n这是一个数论中的经典问题，与弗罗贝尼乌斯币问题（或称币问题、麦乐鸡问题）相关。对于两个互质的正整数 $a$ 和 $b$，不能表示为 $a$ 和 $b$ 的非负整数线性组合（即形如 $ax + by$，$x \\ge 0, y \\ge 0$）的最大整数被称为弗罗贝尼乌斯数，记为 $g(a, b)$。\n\n两个整数的弗罗贝尼乌斯数由以下公式给出：\n$$g(a, b) = ab - a - b$$\n\n在我们的问题中，$a=5$ 且 $b=7$。我们可以应用此公式来找到 $N_{max}$ 的值。\n$$N_{max} = g(5, 7) = (5)(7) - 5 - 7$$\n$$N_{max} = 35 - 12$$\n$$N_{max} = 23$$\n\n因此，23 是可以用整数 $x, y$ 通过 $5x + 7y$ 构成，但不能用非负整数 $x, y$ 构成的最大整数。任何大于 23 的整数都可以表示为 $5x + 7y$ 的形式，其中 $x, y \\ge 0$。\n\n为了验证，我们来检验 $N=23$ 的情况：\n$5x+7y = 23$。\n如果 $y=0$，$5x=23$（$x$ 没有整数解）。\n如果 $y=1$，$5x=16$（$x$ 没有整数解）。\n如果 $y=2$，$5x=9$（$x$ 没有整数解）。\n如果 $y=3$，$5x=2$（$x$ 没有整数解）。\n如果 $y \\ge 4$，$7y \\ge 28$，这将要求 $5x$ 为负数，因此 $x  0$。\n因此，对于 $N=23$ 不存在非负整数解。\n然而，整数解确实存在。对于 $5x+7y=1$，通过观察可得一个解为 $5(3)+7(-2)=1$。将此等式两边乘以 23，我们得到 $5(3 \\cdot 23) + 7(-2 \\cdot 23) = 23$，即 $5(69) + 7(-46) = 23$。因此，一个整数解 $(x, y) = (69, -46)$ 确实存在，这证实了它是一个“有效”的程序。\n\n现在，我们来检验大于 23 的 $N=24$ 的情况。\n$5x+7y = 24$。\n如果 $y=2$，$5x = 24 - 14 = 10$，得到 $x=2$。\n所以，$(x, y) = (2, 2)$ 是 $N=24$ 的一个非负整数解。理论表明，每个大于 23 的整数 $N$ 都至少有一个这样的非负解。\n\n存在有效程序但不存在仅沉积程序的最大整数 $N$ 确实是 5 和 7 的弗罗贝尼乌斯数，即 23。", "answer": "$$\\boxed{23}$$", "id": "1381559"}, {"introduction": "贝祖等式的威力远不止证明解的存在性，它更是一个强大的构造工具。本练习 [@problem_id:3086861] 将展示如何利用贝祖等式巧妙地构造出同余方程组的解。通过这个过程，你将学会如何将满足多个独立条件的解“拼接”在一起，这正是中国剩余定理背后的核心思想。", "problem": "设 $15$ 和 $28$ 是两个互质的整数，即 $\\gcd(15,28)=1$。仅使用最大公约数的定义和 Bézout 恒等式（该恒等式指出，对于整数 $a$ 和 $b$，存在整数 $u$ 和 $v$ 使得 $au + bv = \\gcd(a,b)$），确定在范围 $0 \\leq x  420$ 内的唯一整数 $x$，使其同时满足同余方程组 $x \\equiv 2 \\pmod{15}$ 和 $x \\equiv 3 \\pmod{28}$。你的方法必须明确计算出 $15$ 和 $28$ 的适当的 Bézout 系数，并用它们将 $x$ 构造为一个线性组合。然后，验证你的 $x$ 值是模 $15$ 和 $28$ 的最小公倍数（LCM）$420$ 的唯一解。将 $x$ 的最终值以单个整数形式给出；无需四舍五入。", "solution": "问题要求我们找到一个在范围 $0 \\leq x  420$ 内的唯一整数 $x$，它同时满足以下同余方程组：\n$$x \\equiv 2 \\pmod{15}$$\n$$x \\equiv 3 \\pmod{28}$$\n问题说明整数 $15$ 和 $28$ 是互质的，即 $\\gcd(15, 28) = 1$。根据中国剩余定理，因为模数互质，所以在模它们的乘积（即 $\\text{lcm}(15, 28) = 15 \\times 28 = 420$）下存在唯一的解 $x$。\n\n指定的方法是使用 Bézout 恒等式，该恒等式指出，对于任意两个整数 $a$ 和 $b$，存在整数 $u$ 和 $v$ 使得 $au + bv = \\gcd(a, b)$。在我们的问题中，$a=15$，$b=28$，该恒等式为 $15u + 28v = 1$。我们可以通过应用扩展欧几里得算法来确定整数 $u$ 和 $v$（称为 Bézout 系数）。\n\n首先，我们应用欧几里得算法求 $28$ 和 $15$ 的最大公约数：\n$$28 = 1 \\cdot 15 + 13$$\n$$15 = 1 \\cdot 13 + 2$$\n$$13 = 6 \\cdot 2 + 1$$\n最后一个非零余数是 $1$，这证实了 $\\gcd(28, 15) = 1$。\n\n接下来，我们通过这些步骤反向推导，将 $1$ 表示为 $28$ 和 $15$ 的线性组合：\n从第三个方程中，我们分离出余数 $1$：\n$$1 = 13 - 6 \\cdot 2$$\n我们将第二个方程中余数 $2$ 的表达式代入：\n$$1 = 13 - 6 \\cdot (15 - 1 \\cdot 13)$$\n化简该表达式得到：\n$$1 = 13 - 6 \\cdot 15 + 6 \\cdot 13 = 7 \\cdot 13 - 6 \\cdot 15$$\n最后，我们将第一个方程中余数 $13$ 的表达式代入：\n$$1 = 7 \\cdot (28 - 1 \\cdot 15) - 6 \\cdot 15$$\n化简该表达式得到所需的线性组合：\n$$1 = 7 \\cdot 28 - 7 \\cdot 15 - 6 \\cdot 15$$\n$$1 = (7) \\cdot 28 + (-13) \\cdot 15$$\n这就是 $15$ 和 $28$ 的 Bézout 恒等式，其系数为 $u = -13$ 和 $v = 7$。\n\n现在我们可以构造同余方程组的一个解 $x$。对于方程组 $x \\equiv a_1 \\pmod{n_1}$ 和 $x \\equiv a_2 \\pmod{n_2}$，其中 $n_1u + n_2v = 1$，一个特解 $x_0$ 由线性组合 $x_0 = a_1 n_2 v + a_2 n_1 u$ 给出。\n在我们的问题中，有 $n_1 = 15$，$a_1 = 2$，$n_2 = 28$，$a_2 = 3$，$u = -13$ 和 $v = 7$。\n我们来分析这个构造的组成部分。项 $n_2 v = 28 \\cdot 7 = 196$ 满足同余式：\n$$196 \\equiv 0 \\pmod{28}$$\n$$196 = 13 \\cdot 15 + 1 \\implies 196 \\equiv 1 \\pmod{15}$$\n项 $n_1 u = 15 \\cdot (-13) = -195$ 满足同余式：\n$$-195 \\equiv 0 \\pmod{15}$$\n$$-195 = -7 \\cdot 28 + 1 \\implies -195 \\equiv 1 \\pmod{28}$$\n使用这些部分，我们构造解 $x_0$：\n$$x_0 = a_1 \\cdot (n_2v) + a_2 \\cdot (n_1u)$$\n$$x_0 = 2 \\cdot (196) + 3 \\cdot (-195)$$\n$$x_0 = 392 - 585$$\n$$x_0 = -193$$\n这个值 $x_0$ 是方程组的一个特解。我们可以验证这一点：\n$$-193 = -13 \\cdot 15 + 2 \\implies -193 \\equiv 2 \\pmod{15}$$\n$$-193 = -7 \\cdot 28 + 3 \\implies -193 \\equiv 3 \\pmod{28}$$\n同余方程得到满足。所有解的集合由 $x \\equiv x_0 \\pmod{n_1 n_2}$ 给出，即 $x \\equiv -193 \\pmod{420}$。\n\n我们寻求在范围 $0 \\leq x  420$ 内的唯一解。为了找到这个解，我们将模数 $420$ 加到我们的特解 $x_0$ 上：\n$$x = -193 + 420 = 227$$\n这个值 $x = 227$ 位于要求的范围 $0 \\leq 227  420$ 内。\n\n最后，我们按要求讨论解的唯一性。如果 $x$ 和 $x'$ 是方程组的两个解，那么：\n$$x \\equiv 2 \\pmod{15} \\quad \\text{和} \\quad x' \\equiv 2 \\pmod{15} \\implies x - x' \\equiv 0 \\pmod{15}$$\n$$x \\equiv 3 \\pmod{28} \\quad \\text{和} \\quad x' \\equiv 3 \\pmod{28} \\implies x - x' \\equiv 0 \\pmod{28}$$\n因此，差值 $x - x'$ 同时是 $15$ 和 $28$ 的倍数。由于 $\\gcd(15, 28) = 1$，它们的最小公倍数 $\\text{lcm}(15, 28) = 420$ 也必须整除 $x - x'$。因此，$x \\equiv x' \\pmod{420}$。这证实了任意两个解都必须模 $420$ 同余。因此，在区间 $[0, 419]$ 中只有一个解。我们计算出的值 $x=227$ 就是这个唯一的解。", "answer": "$$\\boxed{227}$$", "id": "3086861"}]}