## 引言
黎曼-斯蒂尔切斯积分的分部积分法是实变分析中的一个基石性工具，它不仅极大地简化了积分计算，还深刻揭示了分析学中连续与离散概念的内在联系。面对形式多样的黎曼-斯蒂尔切斯积分，尤其是那些涉及不连续或[非光滑函数](@entry_id:175189)的积分，我们常常需要一个系统性的方法来转化和求解它们。分部积分法正是解决这一挑战的关键。

本文将系统地引导你掌握这一强大工具。在“原则与机理”一章中，我们将从基本公式出发，探索其几何意义、计算技巧，并介绍处理共同不连续点的广义形式。接着，在“应用与交叉学科联系”一章，你将看到该公式如何在物理学、概率论、泛函分析等多个领域中发挥关键作用。最后，通过“动手实践”部分，你将有机会运用所学知识解决具体问题，巩固理解。

让我们从分部积分法最核心的原则与机理开始，逐步揭开它的面纱。

## 原则与机理

在本章中，我们将深入探讨黎曼-斯蒂尔切斯（Riemann-Stieltjes）积分的一个核心工具：[分部积分公式](@entry_id:145262)。这个公式不仅是计算许多黎曼-斯蒂尔切斯积分的关键，而且深刻地揭示了积分理论中被积函数与积分函数之间的对称关系。我们将从其基本形式出发，通过几何直观、计算应用和对[不连续函数](@entry_id:143848)的处理，逐步揭示其内在机理，并最终介绍其在更广泛条件下的推广形式。

### 基本[分部积分公式](@entry_id:145262)

黎曼-斯蒂尔切斯积分的[分部积分公式](@entry_id:145262)，本质上是微积分中[乘积法则](@entry_id:158393)求导公式 $d(fg) = f dg + g df$ 的积分形式。其标准形式如下：

**定理（分部积分）**：假设在区间 $[a, b]$ 上，函数 $f$ 是连续的，而函数 $\alpha$ 是[有界变差](@entry_id:139291)的。那么 $\int_a^b f d\alpha$ 存在的充要条件是 $\int_a^b \alpha df$ 存在。当它们存在时，下式成立：
$$
\int_{a}^{b} f(x) \,d\alpha(x) + \int_{a}^{b} \alpha(x) \,df(x) = f(b)\alpha(b) - f(a)\alpha(a)
$$
这个定理的条件具有一定的对称性：如果 $f$ 是[有界变差函数](@entry_id:198128)而 $\alpha$ 是[连续函数](@entry_id:137361)，结论同样成立。关键在于，在任何一个点上，两个函数中至少有一个是连续的，以避免共同不连续点带来的复杂性，我们将在后续章节探讨这一点。

这个公式的结构清晰地表明，计算 $\int f d\alpha$ 的问题可以转化为计算 $\int \alpha df$ 的问题，反之亦然。它们通过两函数在端点值的乘积联系在一起。

我们可以通过一个具体的例子来验证这个恒等式的优美与准确。考虑在区间 $[0, 1]$ 上，函数 $f(t) = t^2$ 和 $\alpha(t) = \exp(t)$。两者都是连续可微的，因此都满足[分部积分公式](@entry_id:145262)的条件。公式预测两个积分之和应为：
$$
\int_0^1 f(t) d\alpha(t) + \int_0^1 \alpha(t) df(t) = f(1)\alpha(1) - f(0)\alpha(0)
$$
计算右侧的端点值：$f(1) = 1^2 = 1$，$\alpha(1) = \exp(1)$，$f(0) = 0^2 = 0$，$\alpha(0) = \exp(0) = 1$。
因此，我们得到 $f(1)\alpha(1) - f(0)\alpha(0) = 1 \cdot \exp(1) - 0 \cdot 1 = \exp(1)$。这意味着，无需分别计算这两个看似复杂的黎曼-斯蒂尔切斯积分，我们就能直接通过它们在端点的值确定其和。

同样，对于 $f(x)=x$ 和 $\alpha(x)=\sin(x)$ 在 $[0, \pi/2]$ 上的情形，[分部积分公式](@entry_id:145262)直接给出：
$$
\int_{0}^{\pi/2} x \,d(\sin x) + \int_{0}^{\pi/2} \sin(x) \,d(x) = f(\pi/2)\alpha(\pi/2) - f(0)\alpha(0) = \frac{\pi}{2}\sin(\frac{\pi}{2}) - 0 \cdot \sin(0) = \frac{\pi}{2}
$$
这再次展示了公式的直接性和计算威力 [@problem_id:1304753]。

### 几何解释

[分部积分公式](@entry_id:145262)有一个深刻而直观的几何解释。我们可以将函数对 $(f, \alpha)$ 视为在 $xy$ 平面（这里我们用 $(\alpha, f)$ 平面）上定义了一条[参数曲线](@entry_id:634039) $C$，其[参数方程](@entry_id:172360)为 $(x, y) = (\alpha(t), f(t))$，其中 $t$ 从 $a$ 变化到 $b$。

在这种视角下，黎曼-斯蒂尔切斯积分 $\int_a^b f(t) \,d\alpha(t)$ 可以被理解为[参数曲线](@entry_id:634039) $C$ 下方、$\alpha$-轴之上，以及两条[垂直线](@entry_id:174147) $\alpha = \alpha(a)$ 和 $\alpha = \alpha(b)$ 之间区域的“[有向面积](@entry_id:169588)”。这类似于普通[黎曼积分](@entry_id:142508) $\int y \,dx$ 的概念。

相应地，积分 $\int_a^b \alpha(t) \,df(t)$ 则代表了曲线 $C$ 左侧、 $f$-轴右侧，以及两条水平线 $f = f(a)$ 和 $f = f(b)$ 之间区域的“[有向面积](@entry_id:169588)”。这可以看作是“以 $y$ 为[自变量](@entry_id:267118)”的积分 $\int x \,dy$。

现在，让我们考虑一个由点 $(\alpha(a), f(a))$ 和 $(\alpha(b), f(b))$ 构成的矩形。假设 $f$ 和 $\alpha$ 都是单调递增的，那么这个矩形的总面积是 $f(b)\alpha(b) - f(a)\alpha(a)$（如果我们以 $(\alpha(a), f(a))$ 作为参考原点）。这两个黎曼-斯蒂尔切斯积分所代表的面积，恰好是对这个大矩形的一种分割。它们的和，即 $\int f d\alpha + \int \alpha df$，就等于这个矩形的总面积。[分部积分公式](@entry_id:145262)正是这一几何事实的精确代数表述 [@problem_id:1304739]。这个几何图像为我们提供了一个理解该公式为什么成立的强大直观模型。

### 应用与计算技巧

[分部积分公式](@entry_id:145262)最重要的价值在于它是一种强大的计算工具，能够将一种[形式的积分](@entry_id:158607)转化为另一种可能更容易处理的形式。

#### [积分变换](@entry_id:186209)

一个常见的应用场景是将黎曼-斯蒂尔切斯积分转化为我们更为熟悉的[黎曼积分](@entry_id:142508)。如果积分函数 $\alpha(x)$ 是连续可微的（即属于 $C^1$ 类），那么其[微分](@entry_id:158718) $d\alpha(x)$ 可以写作 $\alpha'(x)dx$。此时，[分部积分公式](@entry_id:145262)可以写作：
$$
\int_{a}^{b} f(x) \alpha'(x) \,dx + \int_{a}^{b} \alpha(x) \,df(x) = f(b)\alpha(b) - f(a)\alpha(a)
$$
这意味着，如果我们想计算 $\int \alpha df$，但 $df$ 的形式很复杂，我们可以转而计算一个标准的[黎曼积分](@entry_id:142508) $\int f \alpha' dx$。

例如，考虑计算积分 $I = \int_0^{\pi} x \, d(\cos x)$ [@problem_id:1304746]。这里 $f(x) = x$，$ \alpha(x) = \cos(x)$。直接计算可能不直观，但我们可以应用[分部积分公式](@entry_id:145262)：
$$
I = \int_0^{\pi} x \, d(\cos x) = [x \cos(x)]_0^{\pi} - \int_0^{\pi} \cos(x) \, dx
$$
右边的积分是一个标准的黎曼积分，易于计算：
$$
[x \cos(x)]_0^{\pi} = \pi \cos(\pi) - 0 \cdot \cos(0) = -\pi
$$
$$
\int_0^{\pi} \cos(x) \, dx = [\sin(x)]_0^{\pi} = \sin(\pi) - \sin(0) = 0
$$
因此，原积分为 $I = -\pi - 0 = -\pi$。通过分部积分，我们将一个抽象的斯蒂尔切斯积分问题成功转化为了一个具体的微积分计算问题。

反之，该公式也可以用来表达一个[黎曼积分](@entry_id:142508)。例如，对于一个满足 $f(a)=0$ 的 $C^1$ 函数 $f(x)$，我们可以通过[分部积分](@entry_id:136350)表达 $\int_a^b f(x)dx$。令 $g(x)=x$，则 $dg(x)=dx$。应用公式于 $f$ 和 $g$：
$$
\int_a^b f(x)dx + \int_a^b x df(x) = f(b)b - f(a)a
$$
利用 $f(a)=0$ 的条件，我们得到：
$$
\int_a^b f(x)dx = b f(b) - \int_a^b x df(x)
$$
这为我们提供了一个看待标准积分的新视角，并突显了[黎曼积分](@entry_id:142508)与黎曼-斯蒂尔切斯积分之间的深刻联系 [@problem_id:1304706]。

#### 一个基本恒等式

[分部积分公式](@entry_id:145262)的一个特别优雅的应用是计算函数关于其自身的积分 $\int_a^b f(x) \, df(x)$，其中 $f$ 是 $C^1$ 函数 [@problem_id:1304740]。应用[分部积分公式](@entry_id:145262)，令 $\alpha = f$：
$$
\int_a^b f(x) \, df(x) + \int_a^b f(x) \, df(x) = f(b)f(b) - f(a)f(a)
$$
$$
2 \int_a^b f(x) \, df(x) = f(b)^2 - f(a)^2
$$
于是我们得到一个简洁而重要的结果：
$$
\int_a^b f(x) \, df(x) = \frac{1}{2} \left( f(b)^2 - f(a)^2 \right)
$$
这个结果与微积分中的换元法是一致的。由于 $f$ 是 $C^1$ 函数，$df(x) = f'(x)dx$，积分可以写成 $\int_a^b f(x)f'(x)dx$。通过换元 $u=f(x)$，我们得到 $\int_{f(a)}^{f(b)} u du = \frac{1}{2}[u^2]_{f(a)}^{f(b)}$，这与我们的结果完全吻合。

### 处理[不连续性](@entry_id:144108)

黎曼-斯蒂尔切斯积分真正的威力在于它能够优雅地处理不连续的积分函数 $\alpha(x)$。[分部积分公式](@entry_id:145262)在这种情况下同样适用，并成为连接离散和连续数学的桥梁。

考虑最简单的[不连续函数](@entry_id:143848)——[阶梯函数](@entry_id:159192)。假设 $\alpha(x)$ 在区间 $(a,b)$ 内仅在点 $c$ 处有一个大小为 $k$ 的跳跃，即 $\alpha(x)$ 在 $x \lt c$ 时为一个常数，在 $x \ge c$ 时为另一个常数，两者相差 $k$。对于一个在 $c$ 点连续的函数 $f(x)$，黎曼-斯蒂尔切斯积分的值会精确地捕捉到这个跳跃：
$$
\int_a^b f(x) \, d\alpha(x) = k \cdot f(c)
$$
这个积分实际上只关心在不连续点 $c$ 处 $f$ 的值 [@problem_id:1304745]。

我们可以将这个想法推广到一个由多个点质量组成的物理系统。假设在 $[a,b]$ 上有 $N$ 个质量为 $m_i$ 的质点位于 $x_i$ 处。累积[质量函数](@entry_id:158970) $\alpha(x) = \sum_{i=1}^{N} m_i H(x - x_i)$（其中 $H$ 是赫维赛德阶梯函数）就是一个在每个 $x_i$ 点跳跃 $m_i$ 的阶梯函数。对于一个连续可微的函数 $f(x)$，积分 $\int_a^b f(x)d\alpha(x)$ 就等于所有[质点](@entry_id:186768)处的“势能”总和：
$$
\int_a^b f(x)d\alpha(x) = \sum_{i=1}^N m_i f(x_i)
$$
现在，应用[分部积分公式](@entry_id:145262)，我们可以将这个离散求和问题转化为一个连续积分问题 [@problem_id:1304704]：
$$
\int_a^b f(x)d\alpha(x) = f(b)\alpha(b) - f(a)\alpha(a) - \int_a^b \alpha(x)df(x)
$$
由于 $f$ 是 $C^1$ 函数， $df(x)=f'(x)dx$，我们得到：
$$
\sum_{i=1}^N m_i f(x_i) = f(b)\alpha(b) - f(a)\alpha(a) - \int_a^b \alpha(x)f'(x)dx
$$
这个等式神奇地将一个离散的求和（左边）与一个[光滑函数](@entry_id:267124)的积分（右边）联系了起来，展示了[分部积分公式](@entry_id:145262)作为分析工具的深刻力量。

### 局限性与推广

尽管功能强大，但我们之前叙述的标准[分部积分公式](@entry_id:145262)有其[适用范围](@entry_id:636189)。当其核心条件被破坏时，公式可能失效。这促使我们需要一个更具普适性的推广形式。

#### 共同不连续点的挑战

标准公式的一个关键要求是，在区间内的任何一点，被积函数 $f$ 和积分函数 $\alpha$ 至少有一个是连续的。如果它们在同一点 $c$ 处同时不连续，情况就会变得复杂。

一个典型的例子是当 $f(x)$ 和 $\alpha(x)$ 都是赫维赛德阶梯函数 $H(x)$，在区间 $[-1, 1]$ 上积分。这两个函数都在 $x=0$ 处有跳跃。在这种情况下，黎曼-斯蒂尔切斯积分 $\int_{-1}^1 H(x)dH(x)$ 的值本身就可能没有唯一定义，它依赖于在包含 $0$ 的分割区间内如何选取样本点。例如，如果我们规定总是在子区间的左端点取值（所谓的“左-斯蒂尔切斯积分”），计算会得到 $\int_{-1}^1 H(x)dH(x) = 0$。然而，[分部积分公式](@entry_id:145262)的右侧会给出 $[H(x)^2]_{-1}^1 - \int_{-1}^1 H(x)dH(x) = (1^2 - 0^2) - 0 = 1$。显然，$0 \neq 1$，公式失效了 [@problem_id:1304750]。这个反例清楚地表明，处理共同不连续点需要一个更为精细的工具。

#### 广义[分部积分公式](@entry_id:145262)

为了处理 $f$ 和 $\alpha$ 都是[有界变差函数](@entry_id:198128)（因此可能含有共同不连续点）的一般情况，我们需要一个推广的[分部积分公式](@entry_id:145262)。一个常用的形式如下：
$$
f(b)\alpha(b) - f(a)\alpha(a) = \int_a^b f(x-) \,d\alpha(x) + \int_a^b \alpha(x) \,df(x-)
$$
这里，$g(x-)$ 表示函数 $g$在点 $x$ 的[左极限](@entry_id:139055)，即 $g(x-) = \lim_{t \to x^-} g(t)$。另一个更对称的形式明确地分离出跳跃部分：
$$
f(b)\alpha(b) - f(a)\alpha(a) = \int_a^b f(x-) \,d\alpha(x) + \int_a^b \alpha(x-) \,df(x) + \sum_{a \lt x \leq b} \Delta f(x) \Delta \alpha(x)
$$
其中 $\Delta g(x) = g(x) - g(x-)$ 是函数 $g$ 在点 $x$ 的跳跃大小，求和项遍历了区间 $(a, b]$ 中所有 $f$ 和 $\alpha$ 的不连续点。这个求和项正是为了修正共同跳跃所带来的差异。

让我们用 $f(x) = \alpha(x) = \lfloor x \rfloor$（向下[取整函数](@entry_id:265373)）在区间 $[0, n]$（其中 $n$ 是正整数）上来验证这个广义公式的正确性 [@problem_id:1304729]。
左边是 $f(n)\alpha(n) - f(0)\alpha(0) = n \cdot n - 0 \cdot 0 = n^2$。
右边的三项需要分别计算：
1.  积分 $\int_0^n f(x-) d\alpha(x)$：积分函数 $\alpha(x)=\lfloor x \rfloor$ 只在整数点 $k=1,2,\dots,n$ 处有大小为 1 的跳跃。被积函数 $f(x-)=\lfloor x- \rfloor$ 在这些点的值是 $k-1$。因此，积分为 $\sum_{k=1}^n f(k-)\Delta \alpha(k) = \sum_{k=1}^n (k-1) \cdot 1 = \frac{(n-1)n}{2}$。
2.  积分 $\int_0^n \alpha(x-) df(x)$：由于 $f=\alpha$，这一项与上一项完全相同，其值也是 $\frac{(n-1)n}{2}$。
3.  跳跃求和项 $\sum_{0 \lt x \leq n} \Delta f(x) \Delta \alpha(x)$：函数 $\lfloor x \rfloor$ 的跳跃发生在整数点 $k=1,2,\dots,n$，每次跳跃大小 $\Delta f(k) = \Delta \alpha(k) = 1$。所以求和为 $\sum_{k=1}^n 1 \cdot 1 = n$。

将右边的三项相加：$\frac{(n-1)n}{2} + \frac{(n-1)n}{2} + n = (n-1)n + n = n^2$。
左右两边相等，均为 $n^2$。广义公式完美地处理了这对在所有整数点上都有共同不连续的函数。

#### 超越[有界变差](@entry_id:139291)：一个展望

分析的探索并未止步于[有界变差函数](@entry_id:198128)。存在一些连续但非[有界变差](@entry_id:139291)的函数，例如在 $[0,1]$ 上的函数 $\alpha(x) = x \sin(1/x)$（在 $x=0$ 处定义为 $0$）。这个函数在原点附近无限[振荡](@entry_id:267781)，导致其总变差发散。然而，即使在这种情况下，我们仍然可以为诸如 $\int_0^1 \alpha(x) d\alpha(x)$ 之类的积分赋予意义，这需要借助 $p$-变差（$p$-variation）和[杨氏积分](@entry_id:187483)（Young's integral）等更高等的理论。令人惊奇的是，在这些推广的框架下，某种形式的[分部积分公式](@entry_id:145262)依然成立 [@problem_id:1304736]。例如，对于上述 $\alpha(x)$，可以证明 $\int_0^1 \alpha d\alpha = \frac{1}{2}(\alpha(1)^2 - \alpha(0)^2) = \frac{1}{2}\sin^2(1)$。这些内容超出了本章的范围，但它们指明了通往[随机分析](@entry_id:188809)等更高级数学领域的道路，也再次印证了[分部积分](@entry_id:136350)作为一个基本原理所具有的深远意义和普适性。