## 引言
在[抽象代数](@entry_id:145216)的学习中，多项式的根是探索[域扩张](@entry_id:153187)结构的核心。一个基础但至关重要的问题是：一个多项式的所有根是否都是不同的？这个被称为**[可分性](@entry_id:143854) (separability)** 的性质，是构建伽罗瓦理论的基石。然而，在不知道根的具体形式，甚至不知道它们存在于哪个扩张域的情况下，我们如何判断一个多项式是否可分？这个知识上的挑战引出了一种巧妙而强大的解决方案：利用一个源于微积分但可在纯代数框架下定义的工具——**[形式导数](@entry_id:150637)**。

本文将全面探讨[可分性的导数判据](@entry_id:150301)。读者将通过三个章节的学习，系统地掌握这一核心概念。
- 在“**原理与机制**”一章中，我们将定义[形式导数](@entry_id:150637)，揭示它与[多项式重根](@entry_id:155765)的深刻联系，并建立起可分性的核心判据。我们将特别关注[域的特征](@entry_id:154386)如何影响这一判据的运作。
- 接着，在“**应用与交叉学科联系**”一章中，我们将展示该判据如何[超越理论](@entry_id:203777)，在数论、线性代数和[代数几何](@entry_id:156300)等具体问题中发挥作用，成为连接不同数学分支的桥梁。
- 最后，通过“**动手实践**”部分，你将有机会通过解决具体问题，将理论知识转化为实际的计算和分析能力。

通过本文的引导，你将不仅理解一个判据，更会体会到[抽象代数](@entry_id:145216)工具在解决具体问题和统一数学思想方面的优雅与力量。

## 原理与机制

本章我们将深入探讨一个核心概念：**[可分性](@entry_id:143854) (separability)**。一个[多项式的根](@entry_id:154615)是否各不相同，是其[代数结构](@entry_id:137052)的一个至关重要的性质，对伽罗瓦理论的构建有着深远的影响。令人惊讶的是，我们可以借助一个看似来自微积分的工具——**[形式导数](@entry_id:150637) (formal derivative)**——来精确地判断多项式的[可分性](@entry_id:143854)。本章将系统阐述这一判据的原理、机制及其在不同特征的域上的微妙表现。

### 多项式的[形式导数](@entry_id:150637)与[重根](@entry_id:151486)

我们首先需要将微积分中的导数概念进行纯代数推广。对于任意域 $K$ 上的多项式环 $K[x]$，我们可以定义一个映射 $D: K[x] \to K[x]$，它不依赖于任何极限或分析的概念。

**定义 ([形式导数](@entry_id:150637))**：令 $f(x) = \sum_{i=0}^n a_i x^i$ 为 $K[x]$ 中的一个多项式。其**[形式导数](@entry_id:150637)** $f'(x)$ 或 $Df(x)$ 定义为：
$$
f'(x) = \sum_{i=1}^n i a_i x^{i-1}
$$
这里，系数 $i a_i$ 指的是将环的乘法单位元 $1_K$ 与自身相加 $i$ 次，再与系数 $a_i$ 相乘。这个定义完全是代数的，适用于任何域 $K$。[形式导数](@entry_id:150637)继承了我们熟悉的求和法则和乘积法则：$(f+g)' = f' + g'$ 和 $(fg)' = f'g + fg'$。

[形式导数](@entry_id:150637)最直接的应用是检测根的**[重数](@entry_id:136466) (multiplicity)**。一个元素 $\alpha$ 是多项式 $f(x)$ 的根，意味着 $(x-\alpha)$ 是 $f(x)$ 的一个因子。如果 $(x-\alpha)^m$ (其中 $m > 1$) 能整除 $f(x)$，而 $(x-\alpha)^{m+1}$ 不能，我们就说 $\alpha$ 是 $f(x)$ 的一个 $m$ **重根 (root of multiplicity m)**。

导数与[重根](@entry_id:151486)之间的基本联系如下：

**定理**：设 $f(x) \in K[x]$，$\alpha$ 是 $f(x)$ 在某个扩张域中的一个根。则 $\alpha$ 是 $f(x)$ 的重根（即[重数](@entry_id:136466) $m > 1$）当且仅当 $f'(\alpha) = 0$。

**证明思路**：如果 $\alpha$ 的[重数](@entry_id:136466) $m \ge 2$，我们可以写出 $f(x) = (x-\alpha)^m g(x)$，其中 $g(\alpha) \neq 0$。使用乘积法则求导，得到 $f'(x) = m(x-\alpha)^{m-1}g(x) + (x-\alpha)^m g'(x)$。由于 $m-1 \ge 1$，显然 $f'(\alpha) = 0$。反之，如果 $\alpha$ 是单根，则 $f(x) = (x-\alpha)g(x)$ 且 $g(\alpha) \neq 0$。求导得到 $f'(x) = g(x) + (x-\alpha)g'(x)$，代入 $\alpha$ 得 $f'(\alpha) = g(\alpha) \neq 0$。

这个思想可以进一步推广。一个根 $\alpha$ 的重数大于等于 $k+1$，当且仅当它是 $f(x), f'(x), \dots, f^{(k)}(x)$ 的公共根。考虑一个具体情景：假设 $\alpha$ 是 $f(x)$, $f'(x)$ 和[二阶导数](@entry_id:144508) $f''(x)$ 的公共根。这直观上暗示了 $\alpha$ 至少是一个三重根。让我们来严格检验这一点 [@problem_id:1828777]。

设 $\alpha$ 的重数为 $m$。我们已知 $f(\alpha)=f'(\alpha)=0$ 蕴含 $m \ge 2$。对 $f'(x)=(x-\alpha)^{m-1}\big(mg(x)+(x-\alpha)g'(x)\big)$ 再次求导，我们得到：
$$
f''(x) = (m-1)(x-\alpha)^{m-2}\big(mg(x)+(x-\alpha)g'(x)\big) + (x-\alpha)^{m-1}(\dots)
$$
在 $x=\alpha$ 处求值，得到：
$$
f''(\alpha) = (m-1)(x-\alpha)^{m-2}\big(mg(x)\big) \Big|_{x=\alpha}
$$
如果 $f''(\alpha)=0$，则需要上式为零。
- 如果域 $K$ 的特征为 0，或者特征 $p$ 不整除 $m$ 和 $m-1$，那么为了使 $f''(\alpha)$ 为零，必须有 $m-2 \ge 1$，即 $m \ge 3$。这在特征 0 或特征 $p > 2$ 的情况下是成立的（因为 $m \ge 2$）。
- 然而，如果特征为 2，情况就有所不同。例如，令 $f(x) = (x-\alpha)^2$。在特征 2 的域中，$f'(x) = 2(x-\alpha) = 0$，$f''(x)=0$。因此 $\alpha$ 是 $f, f', f''$ 的公共根，但其[重数](@entry_id:136466) $m=2$。

这个例子 [@problem_id:1828777] 精确地揭示了[域的特征](@entry_id:154386)在研究重根问题中的关键作用。

### [可分性的导数判据](@entry_id:150301)

现在我们可以精确定义[可分性](@entry_id:143854)，并建立它的主要判据。

**定义 ([可分多项式](@entry_id:149432))**：$K[x]$ 中的一个非常数多项式 $f(x)$ 被称为**可分的 (separable)**，如果它在自己的[分裂域](@entry_id:151552)中没有重根。对于一个不[可约多项式](@entry_id:148759)，这等价于它有 $\deg(f)$ 个不同的根。如果一个多项式不可分，它就被称为**不可分的 (inseparable)**。

结合前一节的知识，一个多项式有[重根](@entry_id:151486)等价于它和它的导数有公共根。这引出了可分性的核心判据：

**定理 (导数判据)**：一个非常数多项式 $f(x) \in K[x]$ 是可分的，当且仅当它与它的导数 $f'(x)$ [互素](@entry_id:143119)，即 $\gcd(f(x), f'(x)) = 1$（在 $K[x]$ 中，等价于最大公因式为常数）。

这个判据的威力在于它将一个关于根（存在于某个未知的扩张域中）的问题，转化为了一个在原始多项式环 $K[x]$ 内部通过[欧几里得算法](@entry_id:138330)即可完成的计算。

让我们通过一个例子来理解这个判据如何处理[可约多项式](@entry_id:148759) [@problem_id:1828782]。假设在一个特征不为 2 的域 $K$ 中，我们构造了一个多项式 $f(x) = g(x)^2 h(x)$，其中 $g(x)$ 和 $h(x)$ 是互素的非平凡[可分多项式](@entry_id:149432)。由于 $g(x)$ 这个因子以平方的形式出现，我们直观地预感 $f(x)$ 会有重根，因此是不可分的。运用导数判据：
$$
f'(x) = (g(x)^2)' h(x) + g(x)^2 h'(x) = 2g(x)g'(x)h(x) + g(x)^2 h'(x)
$$
$$
f'(x) = g(x) \big( 2g'(x)h(x) + g(x)h'(x) \big)
$$
显然，$g(x)$ 是 $f(x)$ 和 $f'(x)$ 的一个公因子。因此，$\gcd(f, f')$ 至少是 $g(x)$。通过进一步论证可以证明（利用 $g, h$ 的互素性和[可分性](@entry_id:143854)），它们的最大公因式恰好就是 $g(x)$。由于 $g(x)$ 不是常数，$\gcd(f, f') \neq 1$，故 $f(x)$ 是不可分的。这个例子完美地展示了多项式中的重因子如何通过导数判据被检测出来。

现在考虑一个不[可约多项式](@entry_id:148759) [@problem_id:1812948]。令 $K = \mathbb{F}_3(t)$ 为特征 3 的有理函数域。考察多项式 $p(x) = x^2 - t \in K[x]$。它在 $K$ 中是否可分？我们计算其导数：
$$
p'(x) = 2x
$$
在 $K = \mathbb{F}_3(t)$ 中，$2 \neq 0$ 是一个单位。因此，$\gcd(x^2-t, 2x) = \gcd(x^2-t, x)$。任何公因子都必须整除 $x$ 和 $x^2-t$。如果一个根 $\alpha$ 满足 $\alpha=0$ 且 $\alpha^2-t=0$，那就意味着 $t=0$。然而 $t$ 是 $K$ 中的一个未定元，不是零元素。所以 $x$ 和 $x^2-t$ 没有公共根，它们是互素的。$\gcd(p(x), p'(x))=1$，因此 $p(x)$ 是可分的。

### 不[可分性](@entry_id:143854)与特征 p

从以上讨论可以看出，一个不[可约多项式](@entry_id:148759) $f(x)$ 若是不可分的，则 $\gcd(f, f') \neq 1$。由于 $f(x)$ 不可约，它的因式只有常数和它自身的伴随元。所以，这必然意味着 $f(x)$ 能整除 $f'(x)$。但 $\deg(f') < \deg(f)$（只要 $f$ 不是常数），一个高次多项式如何能整除一个低次多项式呢？唯一的可能性是 $f'(x)$ 是零多项式。

$f'(x) = \sum i a_i x^{i-1} = 0$ 意味着什么？
- 在**特征为 0** 的域中（如 $\mathbb{Q}, \mathbb{R}, \mathbb{C}$），只要 $f(x)$ 不是常数，就至少有一个系数 $a_i \neq 0$ 且 $i \ge 1$。因为 $i \neq 0$，所以 $i a_i \neq 0$。因此 $f'(x)$ 绝不为零。
- 在**特征为 $p > 0$** 的域中，$i a_i = 0$ 可能因为 $i$ 是 $p$ 的倍数而成立。因此，$f'(x)=0$ 当且仅当所有非零系数 $a_i$ 所对应的指数 $i$ 都是 $p$ 的倍数。

这就引出了一个惊人的结论：
**定理**：在特征 0 的域中，任何不[可约多项式](@entry_id:148759)都是可分的。不可约的[不可分多项式](@entry_id:150131)只可能存在于特征 $p>0$ 的域中。

一个在特征 $p$ [域上的多项式](@entry_id:150086) $f(x)$ 满足 $f'(x)=0$，当且仅当它可以被写成一个关于 $x^p$ 的多项式。也就是说，存在另一个多项式 $g(y) \in K[y]$，使得 $f(x) = g(x^p)$。

这个结构是不可分性的核心。我们可以从任何多项式（无论是否可分）出发，构造一个[不可分多项式](@entry_id:150131)。例如，给定特征 $p$ 域上的任意非常数多项式 $f(x)$，构造 $g(x) = f(x^p)$ [@problem_id:1812896]。根据链式法则，$g'(x) = f'(x^p) \cdot (x^p)' = f'(x^p) \cdot (p x^{p-1}) = 0$。由于 $g(x)$ 非常数且其导数为零，$\gcd(g, g') = g \neq 1$，故 $g(x)$ 必然是不可分的。例如，在 $\mathbb{F}_p(t)$ 中，多项式 $f(x) = x^{2p} - t x^p$ [@problem_id:1820580] 就是 $g(y) = y^2 - ty$ 在 $y=x^p$ 时的形式，它的导数在特征 $p$ 下显然为零。

### 不可约[不可分多项式](@entry_id:150131)与[完美域](@entry_id:152655)

我们已经知道，一个不可约的[不可分多项式](@entry_id:150131) $f(x)$ 必须具有 $f(x) = g(x^p)$ 的形式。但这还不够，因为 $f(x)$ 本身必须是不可约的。这是否总是可能？

答案取决于域 $K$ 的一个深刻属性。假设域 $K$ 满足一个特殊条件：其上的 **Frobenius 自同态** $\phi: K \to K, a \mapsto a^p$ 是满射。这意味着 $K$ 中的每个元素都是某个另一元素的 $p$ 次幂。这样的域被称为**[完美域](@entry_id:152655) (perfect field)**。

如果 $K$ 是一个[完美域](@entry_id:152655)，考虑多项式 $f(x) = g(x^p) = \sum b_j (x^p)^j$。由于 $\phi$ 是满射，对每个系数 $b_j$，都存在一个 $c_j \in K$ 使得 $c_j^p = b_j$。于是：
$$
f(x) = \sum c_j^p (x^j)^p = \left( \sum c_j x^j \right)^p
$$
这表明 $f(x)$ 是另一个多项式的 $p$ 次幂，因此它显然是**可约的**！

我们得到了一个极为重要的结论：
**定理**：在[完美域](@entry_id:152655)上，任何不[可约多项式](@entry_id:148759)都是可分的。

所有特征为 0 的域都是[完美域](@entry_id:152655)。所有[有限域](@entry_id:142106)也都是[完美域](@entry_id:152655)（因为 Frobenius 自同态在有限域上是单射，从而也是满射）。这就解释了为什么在这些常见的域中我们从未遇到过不可约的[不可分多项式](@entry_id:150131)。

那么，哪里可以找到不可约的[不可分多项式](@entry_id:150131)呢？我们必须在**不[完美域](@entry_id:152655) (imperfect field)** 中寻找，即 Frobenius 映射不是满射的域。最典型的例子就是有理函数域 $K = \mathbb{F}_p(t)$。在这个域中，元素 $t$ 就不是任何元素的 $p$ 次幂。

利用这一点，我们可以构造出最经典的不可约[不可分多项式](@entry_id:150131)：$f(x) = x^p - t \in \mathbb{F}_p(t)[x]$。
- 它的导数 $f'(x) = px^{p-1} = 0$，所以如果它不可约，则必定不可分。
- 它的不可约性可以通过 Eisenstein 判据（视其为 $(\mathbb{F}_p[t])[x]$ 中的多项式，素元为 $t$）来证明。

因此，$x^p - t$ 是一个不可约且不可分的多项式。一个更复杂的例子是 $f(x) = x^{10} + t x^5 + t$ 在 $K = \mathbb{F}_5(t)$ 上 [@problem_id:1817584]。它的导数在特征 5 下为零，并且可以证明它是不可约的，从而提供了另一个不可约[不可分多项式](@entry_id:150131)的实例。

事实上，一个域的完美性与[可分性](@entry_id:143854)之间的联系是等价的 [@problem_id:1828780]。对于一个特征为 $p$ 的域 $K$，以下论述等价：
1. $K$ 是一个[完美域](@entry_id:152655)（即每个不[可约多项式](@entry_id:148759)都可分）。
2. Frobenius 映射 $a \mapsto a^p$ 是满射。
3. 对任意 $a \in K$，多项式 $x^p - a$ 在 $K[x]$ 中都是可约的。

### 不可分度

当一个不[可约多项式](@entry_id:148759) $f(x)$ 是不可分的，我们知道它可以写成 $f(x) = g(x^p)$。现在问题来了：多项式 $g(y)$ 的性质是什么？可以证明，$g(y)$ 本身也必须是 $K[y]$ 中的不[可约多项式](@entry_id:148759)。

那么，$g(y)$ 是否可分呢？不一定。如果 $g(y)$ 仍然是不可分的，那么它又可以被写成 $g(y) = h(y^p)$ 的形式，这意味着 $f(x) = h((x^p)^p) = h(x^{p^2})$。这个“剥离” $p$ 次幂的过程可以持续下去，直到我们得到一个可分的多项式为止 [@problem_id:1828769]。

任何一个不[可约多项式](@entry_id:148759) $f(x)$ 都可以唯一地写成 $f(x) = f_{sep}(x^{p^e})$ 的形式，其中 $e \ge 0$ 是一个整数，而 $f_{sep}(y)$ 是一个不可约的[可分多项式](@entry_id:149432)。
- **可分度 (separable degree)**：$\deg_{sep}(f) = \deg(f_{sep})$。
- **不可分度 (inseparable degree)**：$\deg_{insep}(f) = p^e$。
- 总次数满足关系：$\deg(f) = \deg_{sep}(f) \cdot \deg_{insep}(f)$。

$e$ 的值，即不可分度的指数，刻画了 $f(x)$ “不可分的程度”。如果 $e=0$，则 $f(x)$ 本身就是可分的。

如何确定这个指数 $e$ 呢？我们只需反复检查。给定 $f(x)$，若 $f'(x)=0$，则 $f(x)=g_1(x^p)$。再检查 $g_1'(y)$，若 $g_1'(y)=0$，则 $g_1(y)=g_2(y^p)$，即 $f(x)=g_2(x^{p^2})$。我们继续这个过程，直到找到一个 $g_e(z)$ 使得 $g_e'(z) \neq 0$。此时的 $e$ 就是我们寻找的指数。

例如，考虑一个高级问题 [@problem_id:1828775]：设 $F = \mathbb{F}_5(t)$，$K=F(\alpha)$，其中 $\alpha$ 是 $y^5 - y - t$ 的根。在 $K[x]$ 中考察不[可约多项式](@entry_id:148759) $f(x) = x^{25} - t x^5 - \alpha$。它的不可分度是多少？
1. 计算导数：$f'(x) = 25x^{24} - 5tx^4 = 0$ 在特征 5 的域 $K$ 中。所以 $f(x)$ 是不可分的。
2. 将 $f(x)$ 写成关于 $x^5$ 的多项式：$f(x) = (x^5)^5 - t(x^5) - \alpha$。令 $H(z) = z^5 - tz - \alpha \in K[z]$，则 $f(x) = H(x^5)$。
3. 检查 $H(z)$ 的可分性：$H'(z) = 5z^4 - t = -t$。由于 $t \in F$ 是非零元素，所以 $H'(z) \neq 0$。这意味着 $H(z)$ 是可分的。
4. 我们成功地将 $f(x)$ 写成了 $H(x^{5^1})$ 的形式，其中 $H$ 是可分的。因此，指数 $e=1$，不可分度为 $p^e = 5^1 = 5$。

### 一个更深层的视角：可分性与[张量积](@entry_id:140694)

[可分性](@entry_id:143854)的概念远比导数判据所揭示的更加深刻，它触及了[域扩张](@entry_id:153187)的内在结构。一个更抽象但更强大的方法是通过[张量积](@entry_id:140694)来刻画[可分性](@entry_id:143854)。这里我们只做简要介绍。

一个[有限扩张](@entry_id:152412) $L/K$ 是[可分扩张](@entry_id:150569)，当且仅当对于 $K$ 的任何域扩张 $F$，代数 $L \otimes_K F$ 是一个**既约代数 (reduced algebra)**，即它没有非零的**[幂零元](@entry_id:152299) (nilpotent elements)**（一个元素 $\eta$ 是幂零的，如果存在正整数 $k$ 使得 $\eta^k=0$）。

当扩张不可分时，这种良好的结构就被破坏了。考虑我们之前遇到的典型[不可分扩张](@entry_id:151004)的例子 [@problem_id:1828764]。令 $K = \mathbb{F}_p(t)$，并考虑由[不可分多项式](@entry_id:150131) $f(x) = x^p - t$ 生成的扩张 $L = K[x]/(f(x))$。令 $\alpha$ 为 $x$ 在 $L$ 中的像，则 $\alpha^p = t$。

现在我们构造张量积代数 $A = L \otimes_K L$。这是一个在 $K$ 上的代数。考虑其中的元素 $\eta = \alpha \otimes 1 - 1 \otimes \alpha$。让我们计算它的 $p$ 次幂：
$$
\eta^p = (\alpha \otimes 1 - 1 \otimes \alpha)^p
$$
由于我们在特征 $p$ 的代数中运算，[二项式展开](@entry_id:269603)有 $(a-b)^p = a^p - b^p$：
$$
\eta^p = (\alpha \otimes 1)^p - (1 \otimes \alpha)^p = (\alpha^p \otimes 1) - (1 \otimes \alpha^p)
$$
因为 $\alpha^p = t$ 且 $t \in K$，我们可以把 $t$ 从张量的一边“移动”到另一边：
$$
\eta^p = (t \otimes 1) - (1 \otimes t) = (1 \cdot t \otimes 1) - (1 \otimes t) = (1 \otimes t) - (1 \otimes t) = 0
$$
通过更细致的分析可以证明 $\eta$ 本身不是零。因此，我们在代数 $A = L \otimes_K L$ 中找到了一个非零的[幂零元](@entry_id:152299)。这个[幂零元](@entry_id:152299)的存在，正是 $L/K$ 扩张不可分性的一个深层代数体现。它揭示了当基础多项式具有[重根](@entry_id:151486)时，域的结构会变得如何“病态”。这一视角在现代[代数几何](@entry_id:156300)和[交换代数](@entry_id:149047)中扮演着基础性的角色。