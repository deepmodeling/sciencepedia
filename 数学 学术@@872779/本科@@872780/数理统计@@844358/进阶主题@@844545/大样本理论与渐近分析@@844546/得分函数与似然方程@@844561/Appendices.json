{"hands_on_practices": [{"introduction": "理论学习的最佳补充是实践。本节将从一个基础但至关重要的问题开始，该问题涉及估计正态分布的方差。这个练习将引导你完成寻找最大似然估计（MLE）的核心步骤：构建对数似然函数，求导得到得分函数，并将其设为零求解参数。通过这个具体例子 [@problem_id:1953749]，你将掌握将理论应用于数据分析的基本技能。", "problem": "一家高精度科学仪器的制造商正在对一种新的电压源进行特性分析。该设备被设计用于输出一个恒定的、已知的电压 $\\mu$。然而，由于其电子元件中固有的热噪声，对输出电压的重复测量会表现出随机波动。这些波动被建模为一个来自正态分布的随机样本，包含 $n$ 个独立观测值 $X_1, X_2, \\ldots, X_n$。该正态分布的均值为已知的 $\\mu$，方差为未知的 $\\sigma^2 > 0$。方差 $\\sigma^2$ 是一个关键参数，用于量化该电压源的稳定性和质量。\n\n你的任务是确定方差 $\\sigma^2$ 的最大似然估计量 (MLE)。请将该估计量表示为一个包含样本观测值 $X_i$（其中 $i=1, \\ldots, n$）、样本大小 $n$ 以及已知均值 $\\mu$ 的表达式。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是独立的，且 $X_{i} \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，其中 $\\mu$ 已知，$\\sigma^{2}0$ 未知。$X_{i}$ 的概率密度函数为\n$$\nf(x_{i}\\mid \\mu,\\sigma^{2})=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\\exp\\!\\left(-\\frac{(x_{i}-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n根据独立性，似然函数为\n$$\nL(\\sigma^{2})=\\prod_{i=1}^{n}f(x_{i}\\mid \\mu,\\sigma^{2})=(2\\pi\\sigma^{2})^{-n/2}\\exp\\!\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}\\right).\n$$\n对数似然函数为\n$$\n\\ell(\\sigma^{2})=\\ln L(\\sigma^{2})=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\sigma^{2})-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}.\n$$\n令 $v=\\sigma^{2}$。则\n$$\n\\ell(v)=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln v-\\frac{1}{2v}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}.\n$$\n对 $v$ 求导，并令其等于零：\n$$\n\\frac{\\partial \\ell}{\\partial v}=-\\frac{n}{2}\\frac{1}{v}+\\frac{1}{2}\\frac{\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}}{v^{2}}=0.\n$$\n两边乘以 $2v^{2}$ 可得\n$$\n-nv+\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}=0 \\quad \\Longrightarrow \\quad \\hat{v}=\\frac{1}{n}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}.\n$$\n二阶导数为\n$$\n\\frac{\\partial^{2}\\ell}{\\partial v^{2}}=\\frac{n}{2}\\frac{1}{v^{2}}-\\frac{\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}}{v^{3}},\n$$\n将 $\\hat{v}$ 代入，当 $\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}0$ 时，其值为 $-\\frac{n^{3}}{2}\\Big/\\left(\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}\\right)^{2}  0$，这确认了这是一个极大值。因此，$\\sigma^{2}$ 的最大似然估计量 (MLE) 为\n$$\n\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\mu)^{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{n}\\sum_{i=1}^{n}\\left(X_{i}-\\mu\\right)^{2}}$$", "id": "1953749"}, {"introduction": "现实世界中的统计模型常常涉及多个未知参数。这个练习将我们的技能从单参数情况扩展到更复杂的多参数场景。我们将为伽马分布（Gamma distribution）的两个参数（形状参数 $\\alpha$ 和速率参数 $\\beta$）建立似然方程组。这个问题 [@problem_id:1953820] 突出了当模型变得更复杂时，我们需要将得分函数推广为得分向量，并求解一个方程组，这对于理解现代统计推断至关重要。", "problem": "在一个地下中微子观测站中，研究人员正在对连续的高能中微子探测事件之间的等待时间进行建模。一位物理学家提出，这些等待时间 $X_1, X_2, \\ldots, X_n$ 可以描述为一个来自伽马分布的独立同分布随机样本，其形状参数 $\\alpha  0$ 和速率参数 $\\beta  0$ 未知。\n\n伽马分布随机变量 $X$ 的概率密度函数（PDF）由下式给出：\n$$f(x; \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x) \\quad \\text{for } x  0$$\n其中 $\\Gamma(\\alpha)$ 是伽马函数。\n\n为了找到参数矢量 $(\\alpha, \\beta)$ 的最大似然估计（MLEs），必须首先通过对数似然函数对每个参数求偏导数并将其设为零来导出似然方程。这将得到一个包含两个方程的方程组。\n\n令 $\\psi(\\alpha) = \\frac{d}{d\\alpha} \\ln \\Gamma(\\alpha)$ 表示双伽马函数（digamma function）。给定随机样本 $x_1, x_2, \\ldots, x_n$，下列哪个方程组代表了用于估计 $\\alpha$ 和 $\\beta$ 的正确似然方程？\n\nA.\n$\\begin{cases}\nn \\ln(\\beta) - n \\psi(\\alpha) + \\sum_{i=1}^{n} \\ln(x_i) = 0 \\\\\n\\frac{n\\alpha}{\\beta} - \\sum_{i=1}^{n} x_i = 0\n\\end{cases}$\n\nB.\n$\\begin{cases}\nn \\ln(\\beta) - n \\psi(\\alpha) + \\sum_{i=1}^{n} \\ln(x_i) = 0 \\\\\n\\frac{n\\alpha}{\\beta} + \\sum_{i=1}^{n} x_i = 0\n\\end{cases}$\n\nC.\n$\\begin{cases}\nn \\ln(\\beta) + \\sum_{i=1}^{n} \\ln(x_i) = 0 \\\\\n\\frac{n\\alpha}{\\beta} - \\sum_{i=1}^{n} x_i = 0\n\\end{cases}$\n\nD.\n$\\begin{cases}\nn \\ln(\\beta) - \\sum_{i=1}^{n} \\ln(x_i) = 0 \\\\\nn \\alpha \\beta - \\psi(\\alpha) - \\sum_{i=1}^{n} x_i = 0\n\\end{cases}$", "solution": "对于一个来自 $\\operatorname{Gamma}(\\alpha,\\beta)$ 分布的独立同分布样本 $x_{1},\\ldots,x_{n}$，其概率密度函数为 $f(x;\\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x^{\\alpha-1}\\exp(-\\beta x)$（当 $x0$ 时），其似然函数为\n$$\nL(\\alpha,\\beta)=\\prod_{i=1}^{n}\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x_{i}^{\\alpha-1}\\exp(-\\beta x_{i})\n=\\left(\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\right)^{n}\\left(\\prod_{i=1}^{n}x_{i}^{\\alpha-1}\\right)\\exp\\!\\left(-\\beta\\sum_{i=1}^{n}x_{i}\\right).\n$$\n对数似然函数为\n$$\n\\ell(\\alpha,\\beta)=\\ln L(\\alpha,\\beta)\n=n\\alpha\\ln(\\beta)-n\\ln\\Gamma(\\alpha)+(\\alpha-1)\\sum_{i=1}^{n}\\ln(x_{i})-\\beta\\sum_{i=1}^{n}x_{i}.\n$$\n对 $\\alpha$ 求导。使用 $\\psi(\\alpha)=\\frac{d}{d\\alpha}\\ln\\Gamma(\\alpha)$，\n$$\n\\frac{\\partial \\ell}{\\partial \\alpha}=n\\ln(\\beta)-n\\psi(\\alpha)+\\sum_{i=1}^{n}\\ln(x_{i}).\n$$\n令其为零可得\n$$\nn\\ln(\\beta)-n\\psi(\\alpha)+\\sum_{i=1}^{n}\\ln(x_{i})=0.\n$$\n对 $\\beta$ 求导：\n$$\n\\frac{\\partial \\ell}{\\partial \\beta}=\\frac{n\\alpha}{\\beta}-\\sum_{i=1}^{n}x_{i}.\n$$\n令其为零可得\n$$\n\\frac{n\\alpha}{\\beta}-\\sum_{i=1}^{n}x_{i}=0.\n$$\n该方程组与选项A相匹配。", "answer": "$$\\boxed{A}$$", "id": "1953820"}, {"introduction": "一个优秀的统计学家的标志是能够批判性地思考模型的假设。当我们的模型假设不正确时会发生什么？这个更深入的练习 [@problem_id:1953768] 探讨了模型设定错误的情形。通过求解错误模型的期望得分函数（期望是在真实数据生成过程下计算的），我们可以找到不正确模型最终会收敛到的参数值，即“伪真值”。这个练习揭示了得分函数框架的强大之处，即它不仅能用于参数估计，还能用于分析模型在假设被违背时的行为。", "problem": "一位研究人员正在对计数数据进行建模，该数据表示在指定时间间隔内某一罕见事件发生的次数。事件发生次数 $X$ 的真实潜在数据生成过程是均值为 $\\lambda_0$ 的泊松分布。该过程的概率质量函数 (PMF) 由下式给出：\n$$P(X=k) = \\frac{\\exp(-\\lambda_0) \\lambda_0^k}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots$$\n\n然而，研究人员错误地假设数据服从几何分布，该分布用于建模在一系列伯努利试验中首次成功之前失败的次数。这个假设的几何模型的概率质量函数为：\n$$P(X=k; p) = p(1-p)^k \\quad \\text{for } k = 0, 1, 2, \\dots$$\n其中 $p$ 是成功的概率。\n\n在统计理论中，当模型设定错误时，最大似然估计量收敛到的参数值通常被称为“伪真值”。这个值可以通过求解期望得分函数为零的方程来找到。得分函数是对数似然函数关于参数的导数。关键在于，期望必须是关于*真实*数据生成分布来计算的。\n\n你的任务是找到这个 $p$ 的伪真值。确定 $p$ 的值，该值应为以 $\\lambda_0$ 表示的解析表达式，使得几何模型的得分函数的期望值为零，其中期望是在真实泊松($\\lambda_0$)分布下计算的。", "solution": "假设的几何模型对于单个观测值 $x$ 的对数似然函数由下式给出\n$$\\ell(p;x)=\\ln p + x \\ln(1-p).$$\n得分函数是关于 $p$ 的导数：\n$$s(p;x)=\\frac{\\partial \\ell}{\\partial p}=\\frac{1}{p} + x \\cdot \\frac{\\partial}{\\partial p}\\ln(1-p)=\\frac{1}{p} - \\frac{x}{1-p}.$$\n在模型设定错误的情况下，伪真参数 $p^{\\ast}$ 满足在真实分布下期望得分为零的方程：\n$$\\mathbb{E}_{\\text{Poisson}(\\lambda_{0})}\\left[s(p;X)\\right]=0.$$\n使用得分函数的表达式和期望的线性性质，\n$$\\mathbb{E}\\left[\\frac{1}{p} - \\frac{X}{1-p}\\right]=\\frac{1}{p} - \\frac{\\mathbb{E}[X]}{1-p}=\\frac{1}{p} - \\frac{\\lambda_{0}}{1-p}=0,$$\n因为对于 $X \\sim \\text{Poisson}(\\lambda_{0})$，我们有 $\\mathbb{E}[X]=\\lambda_{0}$。求解 $p$，\n$$\\frac{1}{p}=\\frac{\\lambda_{0}}{1-p} \\;\\;\\Longrightarrow\\;\\; 1-p=\\lambda_{0}p \\;\\;\\Longrightarrow\\;\\; 1=p(1+\\lambda_{0}) \\;\\;\\Longrightarrow\\;\\; p=\\frac{1}{1+\\lambda_{0}}.$$\n对于所有 $\\lambda_{0}0$，该值都位于 $(0,1)$ 区间内，因此它是一个有效的概率，并且是唯一解。", "answer": "$$\\boxed{\\frac{1}{1+\\lambda_{0}}}$$", "id": "1953768"}]}