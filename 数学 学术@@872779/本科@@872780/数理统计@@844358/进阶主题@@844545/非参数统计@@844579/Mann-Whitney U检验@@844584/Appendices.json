{"hands_on_practices": [{"introduction": "要掌握曼-惠特尼U检验，最直观的方法是从其基本定义入手。这个练习将引导你通过直接计数法来计算U统计量，即逐一比较两组数据，看一组中的观测值大于另一组的次数。通过这种方法，你可以建立一个坚实的概念基础，理解U统计量究竟衡量了什么——它量化了两组数据分布的分离程度。[@problem_id:1962435]", "problem": "一个材料科学研究小组正在测试两种新的可生物降解聚合物配方，分别命名为配方A和配方B，以评估它们在环境应力下的性能。为此，他们在一段加速老化期后，测量了每种配方中若干样本的极限拉伸强度。这些测量结果以兆帕（MPa）为单位，并为每种配方进行了记录。\n\n配方A的测量数据集为 $S_A = \\{15, 25, 30\\}$。\n配方B的测量数据集为 $S_B = \\{12, 22, 28, 40\\}$。\n\n为了进行初步比较，研究人员决定计算一个非参数统计量，我们称之为 $U_A$。该统计量定义为可以形成的测量对 $(a, b)$ 的总数，其中 $a$ 是来自集合 $S_A$ 的一个值，$b$ 是来自集合 $S_B$ 的一个值，且配方A的值小于配方B的值（即 $a  b$）。\n\n计算统计量 $U_A$ 的值。", "solution": "我们已知 $S_{A}=\\{15,25,30\\}$ 和 $S_{B}=\\{12,22,28,40\\}$。根据定义，统计量 $U_{A}$ 计算的是满足 $a  b$ （其中 $a \\in S_A, b \\in S_B$）的配对总数。我们逐一计数：\n*   对于 $a=15$，在 $S_B$ 中有3个值比它大（$22, 28, 40$）。\n*   对于 $a=25$，在 $S_B$ 中有2个值比它大（$28, 40$）。\n*   对于 $a=30$，在 $S_B$ 中有1个值比它大（$40$）。\n因此，$U_A$ 的总数是 $3 + 2 + 1 = 6$。", "answer": "$$\\boxed{6}$$", "id": "1962435"}, {"introduction": "虽然直接计数法很直观，但当样本量增大时，它就变得非常繁琐。这个练习将向你介绍一种更实用且等价的计算方法——秩和法（rank-sum method）。通过将所有数据混合排序并计算其中一个样本的秩和，我们可以用一个简单的公式快速得到U统计量。此外，这个练习还涉及了处理数据中常见“结”（ties）的情况，这是应用统计检验时必须掌握的关键技能。[@problem_id:1962467]", "problem": "一位农业科学家正在研究两种不同的生物肥料“Zymox”和“GroFast”对一种特定品种豆类植物生长的效果。实验随机选取了两组幼苗。一组8株植物用Zymox处理，另一组7株植物用GroFast处理。两组所有其他生长条件，如光照、水分和土壤，均保持一致。经过六周的生长期后，科学家测量了每株植物的最终高度。\n\nZymox处理组植物记录的高度（单位：厘米）如下：\n$H_Z = \\{25.1, 28.5, 23.9, 30.2, 29.8, 33.1, 26.5, 30.2\\}$\n\nGroFast处理组植物记录的高度（单位：厘米）如下：\n$H_G = \\{31.5, 34.0, 27.6, 35.8, 29.1, 32.4, 33.5\\}$\n\n为了评估两种肥料产生的植物高度分布是否存在显著差异，采用了一种非参数统计检验。请计算这两个样本的曼-惠特尼U检验统计量的值。", "solution": "我们将Zymox组记为样本1，其样本量为$n_{Z}=8$；将GroFast组记为样本2，其样本量为$n_{G}=7$。合并样本量为$N=n_{Z}+n_{G}=15$。\n\n曼-惠特尼检验步骤：\n1) 合并所有观测值并将其从小到大排序，若有相同的值（结），则取其平均秩次。\n2) 计算其中一组（比如Zymox组）的秩和：$R_{Z}$。\n3) 使用曼-惠特尼公式：\n$$\nU_{Z}=R_{Z}-\\frac{n_{Z}(n_{Z}+1)}{2}, \\quad U_{G}=R_{G}-\\frac{n_{G}(n_{G}+1)}{2}, \\quad U_{Z}+U_{G}=n_{Z}n_{G}\n$$\n\n将所有15个高度值升序排列，唯一的结出现在Zymox组的两个值$30.2$上，它们的平均秩次为$8.5$。Zymox组的观测值得到的秩次为\n$$\n1, 2, 3, 5, 7, 8.5, 8.5, 12\n$$\n因此，Zymox组的秩和为\n$$\nR_{Z}=1+2+3+5+7+8.5+8.5+12=47\n$$\n因此，\n$$\nU_{Z}=R_{Z}-\\frac{n_{Z}(n_{Z}+1)}{2}=47-\\frac{8\\cdot 9}{2}=47-36=11\n$$\n根据互补关系，\n$$\nU_{G}=n_{Z}n_{G}-U_{Z}=8\\cdot 7-11=56-11=45\n$$\n曼-惠特尼U检验统计量通常取$U_{Z}$和$U_{G}$中的较小者，即$11$。", "answer": "$$\\boxed{11}$$", "id": "1962467"}, {"introduction": "理解一个统计工具的真正价值，不仅在于知道如何使用它，更在于知道何时使用它。这个练习是一个批判性思维的挑战，它将曼-惠特尼U检验与传统的t检验进行了直接对比。通过分析一个包含异常值（outlier）的数据集，你将亲眼见证U检验对异常值的稳健性（robustness），并理解为什么在数据不满足正态分布等参数假设时，像U检验这样的非参数方法是更可靠的选择。[@problem_id:1962463]", "problem": "一位材料科学家正在研究一种新的实验性合金，合金A，其设计目的是提高相对于标准配方合金B的断裂韧性。为进行比较，该科学家测量了每种合金五个样本的断裂韧性。结果以兆帕乘以米的平方根（MPa$\\sqrt{\\text{m}}$）为单位，记录如下。\n\n-   **合金A（实验性）：** {10.5, 9.5, 11.0, 0.5, 10.0}\n-   **合金B（标准）：** {12.0, 13.5, 11.5, 13.0, 12.5}\n\n该科学家希望检验一个零假设，即两种合金的断裂韧性分布的中心趋势（位置）没有差异，其备择假设为双尾的，即存在差异。这将使用两种不同的统计检验方法在显著性水平 $\\alpha = 0.05$ 下进行。\n\n为解答本题，假设以下临界值：\n1.  对于具有适当自由度的双尾学生t检验（Student's t-test），其临界值为2.306。如果计算出的t统计量的绝对值大于此临界值，则拒绝零假设。\n2.  对于样本量 $n_1=5$ 和 $n_2=5$ 的双尾曼-惠特尼U检验（Mann-Whitney U test），其临界值为2。如果计算出的U统计量小于或等于此临界值，则拒绝零假设。\n\n以下哪个陈述正确描述了从双样本t检验和曼-惠特尼U检验中得出的结论？\n\nA. 两种检验都拒绝零假设。\n\nB. 两种检验都未能拒绝零假设。\n\nC. t检验拒绝零假设，但曼-惠特尼U检验没有。\n\nD. 曼-惠特尼U检验拒绝零假设，但t检验没有。", "solution": "我们将合金A的样本量记为 $n_{1}=5$，合金B的样本量记为 $n_{2}=5$。我们使用双样本学生t检验（合并方差）和曼-惠特尼U检验来检验 $H_{0}$：位置无差异，其备择假设为双边假设，显著性水平均为 $\\alpha=0.05$。\n\n对于t检验，我们首先计算样本均值和方差。对于合金A，观测值为 $\\{10.5,9.5,11.0,0.5,10.0\\}$。均值为\n$$\n\\bar{x}_{A}=\\frac{10.5+9.5+11.0+0.5+10.0}{5}=\\frac{41.5}{5}=8.3.\n$$\n离差平方和为\n$$\n\\sum_{i=1}^{5}(x_{Ai}-\\bar{x}_{A})^{2}=(2.2)^{2}+(1.2)^{2}+(2.7)^{2}+(-7.8)^{2}+(1.7)^{2}=77.3,\n$$\n所以样本方差为\n$$\ns_{A}^{2}=\\frac{77.3}{n_{1}-1}=\\frac{77.3}{4}=19.325.\n$$\n对于合金B，观测值为 $\\{12.0,13.5,11.5,13.0,12.5\\}$。均值为\n$$\n\\bar{x}_{B}=\\frac{12.0+13.5+11.5+13.0+12.5}{5}=\\frac{62.5}{5}=12.5.\n$$\n离差平方和为\n$$\n(-0.5)^{2}+(1.0)^{2}+(-1.0)^{2}+(0.5)^{2}+0^{2}=2.5,\n$$\n所以样本方差为\n$$\ns_{B}^{2}=\\frac{2.5}{n_{2}-1}=\\frac{2.5}{4}=0.625.\n$$\n在等方差t检验下，合并方差及其平方根为\n$$\ns_{p}^{2}=\\frac{(n_{1}-1)s_{A}^{2}+(n_{2}-1)s_{B}^{2}}{n_{1}+n_{2}-2}=\\frac{4\\cdot 19.325+4\\cdot 0.625}{8}=\\frac{79.8}{8}=9.975,\\quad s_{p}=\\sqrt{9.975}.\n$$\n检验统计量为\n$$\nt=\\frac{\\bar{x}_{A}-\\bar{x}_{B}}{s_{p}\\sqrt{\\frac{1}{n_{1}}+\\frac{1}{n_{2}}}}=\\frac{8.3-12.5}{\\sqrt{9.975}\\,\\sqrt{\\frac{1}{5}+\\frac{1}{5}}}=\\frac{-4.2}{\\sqrt{9.975}\\,\\sqrt{0.4}}=\\frac{-4.2}{\\sqrt{3.99}}.\n$$\n自由度为 $n_{1}+n_{2}-2=8$，给定临界值为 $2.306$，我们将 $|t|=\\frac{4.2}{\\sqrt{3.99}}\\approx 2.10$ 与 $2.306$ 进行比较。由于 $|t|2.306$，t检验未能拒绝 $H_{0}$。\n\n对于曼-惠特尼U检验，我们将合并后的样本从最小到最大进行排序。带有组别标签的有序值为：$0.5$ (A), $9.5$ (A), $10.0$ (A), $10.5$ (A), $11.0$ (A), $11.5$ (B), $12.0$ (B), $12.5$ (B), $13.0$ (B), $13.5$ (B)。合金A的秩为 $1,2,3,4,5$，因此合金A的秩和为\n$$\nR_{A}=1+2+3+4+5=15.\n$$\n合金A的曼-惠特尼统计量为\n$$\nU_{A}=R_{A}-\\frac{n_{1}(n_{1}+1)}{2}=15-\\frac{5\\cdot 6}{2}=15-15=0.\n$$\n类似地，$U_{B}=n_{1}n_{2}-U_{A}=25-0=25$，检验统计量为 $U=\\min\\{U_{A},U_{B}\\}=0$。对于 $n_{1}=n_{2}=5$，给定的双尾临界值为 $2$，如果 $U\\leq 2$，我们拒绝 $H_{0}$。由于 $U=0\\leq 2$，曼-惠特尼U检验拒绝 $H_{0}$。\n\n因此，曼-惠特尼U检验拒绝了零假设，而t检验没有。正确选项是D。", "answer": "$$\\boxed{D}$$", "id": "1962463"}]}