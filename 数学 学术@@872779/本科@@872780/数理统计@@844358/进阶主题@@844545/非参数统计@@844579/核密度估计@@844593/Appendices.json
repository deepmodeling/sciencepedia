{"hands_on_practices": [{"introduction": "要真正理解核密度估计（KDE），最好的方法就是从头开始进行一次计算。本练习将指导您完成这一基本过程。通过为一个给定的数据集和一个特定点手动计算核密度估计值，您将深入了解KDE公式中每个组成部分——数据点、核函数和带宽——如何协同工作，共同构建出平滑的密度曲线。这个练习 [@problem_id:1927623] 选用高斯核，这是实践中最常用的一种核函数，能帮助您建立坚实的计算基础。", "problem": "在统计分析中，核密度估计是一种用于估计随机变量概率密度函数的非参数方法。对于一组给定的数据点 $D = \\{x_1, x_2, \\ldots, x_n\\}$，其在点 $x$ 处的核密度估计由以下公式定义：\n$$\n\\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - x_i}{h}\\right)\n$$\n其中 $n$ 是数据点的数量，$h  0$ 是一个称为带宽的平滑参数，$K(u)$ 是一个积分为1的非负函数，称为核函数。\n\n考虑一个包含三个实验测量值的小数据集：$D = \\{-2, 0, 3\\}$。我们希望估计在点 $x=1$ 处的潜在概率密度。对于此估计，我们将使用标准正态核，其概率密度函数由 $K(u) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}u^2\\right)$ 给出。带宽选择为 $h=2$。\n\n计算在 $x=1$ 处的核密度估计值 $\\hat{f}_h(x)$。请用单个闭式解析表达式给出你的答案。", "solution": "我们使用核密度估计器\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-x_{i}}{h}\\right),\n$$\n其中 $n=3$，$h=2$，$x=1$，数据为 $D=\\{-2,0,3\\}$，且标准正态核为 $K(u)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{1}{2}u^{2}\\right)$。\n因此，\n$$\n\\hat{f}_{2}(1)=\\frac{1}{3\\cdot 2}\\sum_{x_{i}\\in D}\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{1}{2}\\left(\\frac{1-x_{i}}{2}\\right)^{2}\\right)\n=\\frac{1}{6\\sqrt{2\\pi}}\\sum_{x_{i}\\in D}\\exp\\!\\left(-\\frac{1}{2}\\left(\\frac{1-x_{i}}{2}\\right)^{2}\\right).\n$$\n计算参数：\n$$\n\\frac{1-(-2)}{2}=\\frac{3}{2},\\quad \\frac{1-0}{2}=\\frac{1}{2},\\quad \\frac{1-3}{2}=-1.\n$$\n因此，\n$$\n\\hat{f}_{2}(1)=\\frac{1}{6\\sqrt{2\\pi}}\\left[\\exp\\!\\left(-\\frac{1}{2}\\cdot\\left(\\frac{3}{2}\\right)^{2}\\right)+\\exp\\!\\left(-\\frac{1}{2}\\cdot\\left(\\frac{1}{2}\\right)^{2}\\right)+\\exp\\!\\left(-\\frac{1}{2}\\cdot 1^{2}\\right)\\right]\n=\\frac{1}{6\\sqrt{2\\pi}}\\left(\\exp\\!\\left(-\\frac{9}{8}\\right)+\\exp\\!\\left(-\\frac{1}{8}\\right)+\\exp\\!\\left(-\\frac{1}{2}\\right)\\right).\n$$\n这就得到了所需的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{6\\sqrt{2\\pi}}\\left(\\exp\\!\\left(-\\frac{9}{8}\\right)+\\exp\\!\\left(-\\frac{1}{8}\\right)+\\exp\\!\\left(-\\frac{1}{2}\\right)\\right)}$$", "id": "1927623"}, {"introduction": "在掌握了KDE的基本计算之后，探索其理论性质至关重要。本练习探讨了当整个数据集发生平移时，KDE会如何变化。通过分析这种变换的影响，您将理解KDE估计器的一个核心特性：它对数据的位置具有“等变性”。这一性质 [@problem_id:1927606] 意味着，数据的整体形状和分布特征（由KDE捕捉）并不会因为简单的平移而改变，这对于数据预处理（如中心化）和结果解释具有重要的实践意义。", "problem": "一位统计学家正在分析一个由 $n$ 个观测值 $\\{X_1, X_2, \\ldots, X_n\\}$ 组成的数据集。为了估计数据采样所来自的潜在概率密度函数，他们计算了核密度估计 (Kernel Density Estimate, KDE)。KDE 记为 $\\hat{f}_h(x)$，使用核函数 $K(u)$ 和带宽参数 $h  0$ 进行计算。KDE 的公式如下：\n$$\n\\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - X_i}{h}\\right)\n$$\n随后，为了重新校准，该统计学家决定对数据应用一个线性变换。一个新的数据集 $\\{Y_1, Y_2, \\ldots, Y_n\\}$ 被创建，其中每个新数据点都是原始数据点的平移版本，由关系式 $Y_i = X_i + c$ 定义，其中 $c$ 为某个非零常数。\n\n然后，使用完全相同的核函数 $K(u)$ 和带宽 $h$ 为这个变换后的数据集计算一个新的 KDE，记为 $\\hat{g}_h(x)$。\n\n以下哪个选项正确描述了新估计 $\\hat{g}_h(x)$ 与原始估计 $\\hat{f}_h(x)$ 之间的关系？\n\nA. $\\hat{g}_h(x) = \\hat{f}_h(x) + \\frac{c}{nh}$\n\nB. $\\hat{g}_h(x) = \\hat{f}_h(x+c)$\n\nC. $\\hat{g}_h(x) = \\hat{f}_h(x)$\n\nD. $\\hat{g}_h(x) = \\hat{f}_h(x-c)$\n\nE. $\\hat{g}_h(x) = \\hat{f}_h(x) + c$", "solution": "根据定义，基于 $\\{X_{i}\\}_{i=1}^{n}$、使用核函数 $K$ 和带宽 $h0$ 的 KDE 为\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-X_{i}}{h}\\right).\n$$\n对于变换后的数据 $Y_{i}=X_{i}+c$，其 KDE（使用相同的 $K$ 和 $h$）为\n$$\n\\hat{g}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-Y_{i}}{h}\\right).\n$$\n代入 $Y_{i}=X_{i}+c$ 可得\n$$\n\\hat{g}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-(X_{i}+c)}{h}\\right)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{(x-c)-X_{i}}{h}\\right).\n$$\n根据 $\\hat{f}_{h}$ 的定义，等式右边等于 $\\hat{f}_{h}(x-c)$，因为\n$$\n\\hat{f}_{h}(x-c)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{(x-c)-X_{i}}{h}\\right).\n$$\n因此，\n$$\n\\hat{g}_{h}(x)=\\hat{f}_{h}(x-c),\n$$\n这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1927606"}, {"introduction": "在核密度估计中，选择合适的带宽 $h$ 是最关键也最具挑战性的一步，因为它直接控制着模型的平滑程度和对数据的拟合效果。一个过小或过大的带宽都可能导致对真实数据分布的严重误判。本练习 [@problem_id:1927653] 引入了一种强大且客观的带宽选择技术：留一法交叉验证（Leave-One-Out Cross-Validation, LOOCV）。通过为一个具体的数据集计算LOOCV得分函数，您将体验到如何从数据本身出发，以一种有原则的方式来寻找最优带宽，从而将KDE从一门艺术转变为一门科学。", "problem": "一位数据科学家正在对一台新校准仪器的一小组归一化误差测量值进行初步分析。数据集为 $X = \\{x_1, x_2, x_3\\} = \\{-1, 0, 1\\}$。为了对这些误差的概率分布进行建模，该科学家采用核密度估计（Kernel Density Estimation, KDE），这是一种用于估计随机变量概率密度函数的非参数方法。\n\nKDE 定义如下：\n$$ \\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x-x_i}{h}\\right) $$\n其中 $n$ 是数据点的数量，$h$ 是一个称为带宽的平滑参数，$K(u)$ 是核函数。本次分析使用标准高斯核：$K(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right)$。\n\n为了评估特定带宽的适用性，该科学家计算了留一法交叉验证（Leave-One-Out Cross-Validation, LOOCV）分数，这是一个旨在估计KDE误差的目标函数。该函数记为 $J(h)$，定义如下：\n$$ J(h) = \\int_{-\\infty}^{\\infty} \\left(\\hat{f}_h(x)\\right)^2 dx - \\frac{2}{n} \\sum_{i=1}^{n} \\hat{f}_{h, -i}(x_i) $$\n此处，$\\hat{f}_{h, -i}(x_i)$ 是在数据点 $x_i$ 处的“留一法”密度估计，它是通过使用除 $x_i$ 自身以外的所有数据点构建KDE来计算的：\n$$ \\hat{f}_{h, -i}(x_i) = \\frac{1}{(n-1)h} \\sum_{j \\neq i} K\\left(\\frac{x_i - x_j}{h}\\right) $$\n你可以不加证明地使用以下标准高斯核的卷积恒等式：\n$$ \\int_{-\\infty}^{\\infty} K\\left(\\frac{x-a}{h}\\right) K\\left(\\frac{x-b}{h}\\right) dx = \\frac{h}{\\sqrt{4\\pi}}\\exp\\left(-\\frac{(a-b)^2}{4h^2}\\right) $$\n对于给定的数据集 $X=\\{-1, 0, 1\\}$，使用带宽 $h=1$，计算 LOOCV 分数 $J(h)$ 的精确值。将你的答案表示为包含 $\\pi$、$e$ 和数值常数的单个符号表达式。", "solution": "我们有 $n=3$，$h=1$，$X=\\{-1,0,1\\}$，以及 $K(u)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{u^{2}}{2}\\right)$。KDE 为 $\\hat{f}_{1}(x)=\\frac{1}{3}\\sum_{i=1}^{3}K(x-x_{i})$。\n\n首先，计算积分平方密度：\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx\n=\\frac{1}{9}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\int_{-\\infty}^{\\infty}K(x-x_{i})K(x-x_{j})\\,dx.\n$$\n使用所提供的高斯卷积恒等式，其中 $h=1$，$a=x_{i}$，$b=x_{j}$，\n$$\n\\int_{-\\infty}^{\\infty}K(x-x_{i})K(x-x_{j})\\,dx=\\frac{1}{\\sqrt{4\\pi}}\\exp\\left(-\\frac{(x_{i}-x_{j})^{2}}{4}\\right).\n$$\n因此，\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx\n=\\frac{1}{9\\sqrt{4\\pi}}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\exp\\left(-\\frac{(x_{i}-x_{j})^{2}}{4}\\right).\n$$\n对于 $X=\\{-1,0,1\\}$，成对的差的平方为 $0$（对角线上出现三次），$1$（相邻元素之间有四个有序的非对角线对），以及 $4$（$-1$ 和 $1$ 之间有两个有序的非对角线对）。因此，\n$$\n\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\exp\\left(-\\frac{(x_{i}-x_{j})^{2}}{4}\\right)\n=3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp\\left(-1\\right).\n$$\n于是，\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx\n=\\frac{1}{9\\sqrt{4\\pi}}\\left(3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp(-1)\\right).\n$$\n\n接下来，计算留一法项。对于 $h=1$，\n$$\n\\hat{f}_{1,-i}(x_{i})=\\frac{1}{2}\\sum_{j\\neq i}K(x_{i}-x_{j}).\n$$\n对每个 $x_{i}$ 进行评估：\n- 对于 $x_{1}=-1$：与其它点的差为 $-1$ 和 $-2$，所以\n$$\n\\hat{f}_{1,-1}(-1)=\\frac{1}{2}\\left(\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right)+\\frac{1}{\\sqrt{2\\pi}}\\exp(-2)\\right)=\\frac{1}{2\\sqrt{2\\pi}}\\left(\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n- 对于 $x_{2}=0$：差为 $1$ 和 $-1$，所以\n$$\n\\hat{f}_{1,-2}(0)=\\frac{1}{2}\\left(\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right)+\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right)\\right)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right).\n$$\n- 对于 $x_{3}=1$：差为 $2$ 和 $1$，所以\n$$\n\\hat{f}_{1,-3}(1)=\\frac{1}{2\\sqrt{2\\pi}}\\left(\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n求和，\n$$\n\\sum_{i=1}^{3}\\hat{f}_{1,-i}(x_{i})=\\frac{1}{\\sqrt{2\\pi}}\\left(2\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n\n因此，LOOCV 分数为\n$$\nJ(1)=\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx-\\frac{2}{3}\\sum_{i=1}^{3}\\hat{f}_{1,-i}(x_{i}),\n$$\n可得\n$$\nJ(1)=\\frac{1}{9\\sqrt{4\\pi}}\\left(3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp(-1)\\right)-\\frac{2}{3\\sqrt{2\\pi}}\\left(2\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n这就是用 $\\pi$、$\\exp(\\cdot)$ 和数值常数表示的精确符号表达式。", "answer": "$$\\boxed{\\frac{1}{9\\sqrt{4\\pi}}\\left(3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp(-1)\\right)-\\frac{2}{3\\sqrt{2\\pi}}\\left(2\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right)}$$", "id": "1927653"}]}