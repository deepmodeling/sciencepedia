{"hands_on_practices": [{"introduction": "直方图是最直观、最基础的非参数密度估计方法之一。然而，它的形态对参数选择异常敏感，这个练习将揭示一个看似微不足道的选择——“箱子”的起点——如何显著改变我们对数据分布的看法。通过这个实践，你将亲身体会到直方图估计器的一个关键局限性，从而理解为何需要更稳健的估计方法 [@problem_id:1939942]。", "problem": "一位统计学家正在研究直方图作为一种非参数密度估计器的敏感性。在点 $x$ 处的直方图密度估计值，记为 $\\hat{f}(x)$，由以下公式给出：\n$$\n\\hat{f}(x) = \\frac{k}{nh}\n$$\n其中 $n$ 是数据点的总数，$h$ 是组距，$k$ 是落入包含点 $x$ 的特定组中的数据点数量。\n\n这些组由一个起始点 $t_0$ 和一个宽度 $h$ 定义。所有组的集合由形如 $[t_0 + j \\cdot h, t_0 + (j+1) \\cdot h)$ 的区间给出，其中 $j$ 为所有整数。\n\n考虑以下包含 $n=5$ 个观测值的数据集：\n$$\nD = \\{0.8, 0.9, 1.2, 1.5, 2.6\\}\n$$\n该统计学家决定使用固定的组距 $h=1.0$。然而，他们通过选择两个不同的起始点来考虑两种不同的分组方案。\n\n- **方案 A：** 组的起始点为 $t_{0,A} = 0.0$。\n- **方案 B：** 组的起始点为 $t_{0,B} = 0.5$。\n\n设 $\\hat{f}_A(x)$ 是使用方案 A 计算的密度估计值，$\\hat{f}_B(x)$ 是使用方案 B 计算的密度估计值。\n\n计算在点 $x = 1.1$ 处两个密度估计值之间的绝对差。即，求 $|\\hat{f}_A(1.1) - \\hat{f}_B(1.1)|$ 的值。\n\n请用小数表示你的答案。", "solution": "在点 $x$ 处的直方图密度估计值定义为 $\\hat{f}(x) = \\frac{k}{n h}$，其中 $k$ 是包含 $x$ 的组中的数据点计数，$n$ 是样本大小，$h$ 是组距。在这里，$n=5$ 且 $h=1.0$，组的形式为 $[t_{0}+j h, t_{0}+(j+1) h)$。\n\n对于方案 A，其起始点 $t_{0,A}=0.0$，各组为 $[0,1)$、$[1,2)$、$[2,3)$ 等。点 $x=1.1$ 位于组 $[1,2)$ 中。在 $[1,2)$ 中的数据点是 $1.2$ 和 $1.5$，所以 $k_{A}=2$。因此，\n$$\n\\hat{f}_{A}(1.1) = \\frac{k_{A}}{n h} = \\frac{2}{5 \\cdot 1} = 0.4.\n$$\n\n对于方案 B，其起始点 $t_{0,B}=0.5$，各组为 $[0.5,1.5)$、$[1.5,2.5)$、$[2.5,3.5)$ 等。点 $x=1.1$ 位于组 $[0.5,1.5)$ 中。在 $[0.5,1.5)$ 中的数据点是 $0.8$、$0.9$ 和 $1.2$，而 $1.5$ 被排除在外，因为该区间是右开的。因此 $k_{B}=3$。因此，\n$$\n\\hat{f}_{B}(1.1) = \\frac{k_{B}}{n h} = \\frac{3}{5 \\cdot 1} = 0.6.\n$$\n\n所求的绝对差为\n$$\n|\\hat{f}_{A}(1.1) - \\hat{f}_{B}(1.1)| = |0.4 - 0.6| = 0.2.\n$$", "answer": "$$\\boxed{0.2}$$", "id": "1939942"}, {"introduction": "为了克服直方图的缺点，核密度估计（KDE）提供了一种更平滑、更连续的替代方案。KDE 的核心是核函数 $K(u)$，它本身必须是一个有效的概率密度函数，以确保最终的估计结果也是一个合法的概率密度。这个练习将指导你通过求解归一化常数，来验证一个常用的核函数（双权核）是否满足其积分必须为 1 的数学条件 [@problem_id:1939931]。", "problem": "在核密度估计的统计方法中，核函数 $K(u)$ 用于对数据点进行加权和平滑。为使其在数学上有效，任何此类核函数本身都必须是一个概率密度函数。考虑以下函数，称为双权（或四次）核函数，它因其平滑性而经常被使用：\n$$\nK(u) = \\begin{cases} c(1 - u^2)^2  & \\text{for } |u| \\le 1 \\\\ 0  & \\text{otherwise} \\end{cases}\n$$\n其中 $c$ 是一个正常数。确定使 $K(u)$ 成为有效核函数的 $c$ 的精确数值。", "solution": "要成为实数线上的有效概率密度函数，核函数必须满足非负性和积分为1的条件。给定的 $K(u)$ 是非负的，因为对于所有 $u$，都有 $(1-u^{2})^{2} \\ge 0$，并且在 $|u| \\le 1$ 之外其值为零。因此，归一化条件决定了 $c$ 的值：\n$$\n\\int_{-\\infty}^{\\infty} K(u)\\,du \\;=\\; \\int_{-1}^{1} c\\left(1 - u^{2}\\right)^{2}\\,du \\;=\\; 1.\n$$\n展开平方并逐项积分：\n$$\n\\int_{-1}^{1} c\\left(1 - 2u^{2} + u^{4}\\right)\\,du\n\\;=\\;\nc\\left(\\int_{-1}^{1} 1\\,du - 2\\int_{-1}^{1} u^{2}\\,du + \\int_{-1}^{1} u^{4}\\,du\\right).\n$$\n使用对称性和标准积分，\n$$\n\\int_{-1}^{1} 1\\,du = 2,\\quad \\int_{-1}^{1} u^{2}\\,du = \\frac{2}{3},\\quad \\int_{-1}^{1} u^{4}\\,du = \\frac{2}{5}.\n$$\n因此，\n$$\n\\int_{-1}^{1} c\\left(1 - u^{2}\\right)^{2}\\,du\n=\nc\\left(2 - 2\\cdot\\frac{2}{3} + \\frac{2}{5}\\right)\n=\nc\\left(2 - \\frac{4}{3} + \\frac{2}{5}\\right)\n=\nc\\left(\\frac{30}{15} - \\frac{20}{15} + \\frac{6}{15}\\right)\n=\nc\\cdot\\frac{16}{15}.\n$$\n令其等于 $1$ 可得\n$$\nc\\cdot\\frac{16}{15} = 1 \\quad\\Rightarrow\\quad c = \\frac{15}{16}.\n$$\n因此，$c = \\frac{15}{16}$ 确保 $K(u)$ 的积分为 $1$，使其成为一个有效的核函数。", "answer": "$$\\boxed{\\frac{15}{16}}$$", "id": "1939931"}, {"introduction": "在理解了核函数的性质之后，我们就可以将其应用于实际数据了。这个练习将带你一步步完成一个完整的核密度估计计算，让你了解每个数据点是如何通过核函数加权，共同构建出在特定点的密度估计值的。通过这个具体的计算，你将对 KDE 的工作原理以及带宽 $h$ 如何影响平滑程度有更深入的理解 [@problem_id:1939894]。", "problem": "一个材料科学实验室正在测试一种新型聚合物电池。他们进行了五次试验，测量在恒定负载下电池完全放电所需的时间。记录的放电时间（单位：小时）为：$\\{2.1, 2.5, 3.0, 3.8, 4.2\\}$。\n\n为了分析这个小样本，一位统计学家决定使用核密度估计（Kernel Density Estimator, KDE）来估计放电时间的基础概率密度函数。KDE 由以下公式给出：\n$$ \\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - x_i}{h}\\right) $$\n其中 $n$ 是数据点的数量，$\\{x_1, \\dots, x_n\\}$ 是观测数据集，$h$ 是一个称为带宽的参数，$K(u)$ 是核函数。\n\n在本分析中，选用了三角形核函数，其定义为：\n$$ K(u) = \\begin{cases} 1 - |u|  & \\text{if } |u| \\le 1 \\\\ 0  & \\text{if } |u| > 1 \\end{cases} $$\n使用带宽 $h = 1.0$ 小时，计算在点 $x = 2.8$ 小时处估计的概率密度 $\\hat{f}_h(x)$ 的数值。将最终答案四舍五入到三位有效数字。", "solution": "我们已知核密度估计器\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-x_{i}}{h}\\right),\n$$\n使用三角形核函数\n$$\nK(u)=\\begin{cases}\n1-|u|  & \\text{if } |u|\\leq 1\\\\\n0  & \\text{if } |u|>1\n\\end{cases}\n$$\n对于数据 $\\{x_{i}\\}=\\{2.1,2.5,3.0,3.8,4.2\\}$，带宽 $h=1.0$，以及评估点 $x=2.8$。这里 $n=5$。\n\n由于 $h=1$，我们有 $u_{i}=(x-x_{i})/h=x-x_{i}$。计算每个分量的贡献：\n- 对于 $x_{1}=2.1$：$u_{1}=2.8-2.1=0.7$，所以 $|u_{1}|\\leq 1$ 且 $K(u_{1})=1-|0.7|=0.3$。\n- 对于 $x_{2}=2.5$：$u_{2}=2.8-2.5=0.3$，所以 $|u_{2}|\\leq 1$ 且 $K(u_{2})=1-|0.3|=0.7$。\n- 对于 $x_{3}=3.0$：$u_{3}=2.8-3.0=-0.2$，所以 $|u_{3}|\\leq 1$ 且 $K(u_{3})=1-|{-0.2}|=0.8$。\n- 对于 $x_{4}=3.8$：$u_{4}=2.8-3.8=-1.0$，所以 $|u_{4}|=1$ 且 $K(u_{4})=1-1=0$。\n- 对于 $x_{5}=4.2$：$u_{5}=2.8-4.2=-1.4$，所以 $|u_{5}|>1$ 且 $K(u_{5})=0$。\n\n因此\n$$\n\\sum_{i=1}^{5}K\\!\\left(\\frac{2.8-x_{i}}{1}\\right)=0.3+0.7+0.8+0+0=1.8.\n$$\n所以，\n$$\n\\hat{f}_{1}(2.8)=\\frac{1}{5\\cdot 1}\\times 1.8=0.36.\n$$\n四舍五入到三位有效数字，得到 $0.360$。", "answer": "$$\\boxed{0.360}$$", "id": "1939894"}]}