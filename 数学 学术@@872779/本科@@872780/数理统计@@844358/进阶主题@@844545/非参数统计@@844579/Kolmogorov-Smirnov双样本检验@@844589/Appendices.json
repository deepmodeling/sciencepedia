{"hands_on_practices": [{"introduction": "柯尔莫哥洛夫-斯米尔诺夫（KS）双样本检验的核心是计算检验统计量 $D_{n,m}$。该统计量量化了两个经验分布函数（EDF）之间的最大垂直距离。本练习 [@problem_id:1928076] 提供了一个具体的场景——顾客等待时间——来引导你逐步完成构建经验分布函数并找出它们之间最大差异的完整过程。掌握这一计算是应用 KS 检验的第一步。", "problem": "一位咖啡店经理正在分析两种不同点餐系统的顾客等待时间。系统A是传统的柜台服务，系统B是新型的自助服务机。为了比较等待时间的分布，该经理收集了两个独立的等待时间小随机样本，单位为分钟。\n\n来自系统A的样本，有 $n=4$ 名顾客，为：$S_A = \\{3.5, 5.1, 2.8, 4.3\\}$。\n来自系统B的样本，有 $m=5$ 名顾客，为：$S_B = \\{4.8, 3.9, 5.5, 6.0, 4.1\\}$。\n\n经理决定使用双样本柯尔莫哥洛夫-斯米尔诺夫（KS）检验来评估这两个样本是否来自相同的基础分布。检验统计量，记为 $D_{n,m}$，定义为两个样本的经验分布函数（EDF）之间的最大绝对差。\n\n对于一个大小为 $k$ 的样本 $X = \\{x_1, \\dots, x_k\\}$，其经验分布函数由 $F_k(t) = \\frac{1}{k} \\times (\\text{样本 } X \\text{ 中小于或等于 } t \\text{ 的观测值数量})$ 给出。\nKS统计量则为 $D_{n,m} = \\sup_{t} |F_n(t) - G_m(t)|$，其中 $F_n(t)$ 是样本 $S_A$ 的经验分布函数，$G_m(t)$ 是样本 $S_B$ 的经验分布函数。\n\n计算给定数据的KS检验统计量 $D_{4,5}$ 的值。将您的答案表示为最简精确分数形式。", "solution": "我们有两个独立的样本，$S_{A}$ 的大小为 $n=4$，$S_{B}$ 的大小为 $m=5$。经验分布函数（EDF）定义为\n$$\nF_{n}(t)=\\frac{1}{n}\\times\\left(\\text{样本 }S_{A}\\text{ 中满足 }x\\leq t\\text{ 的观测值数量}\\right),\\quad\nG_{m}(t)=\\frac{1}{m}\\times\\left(\\text{样本 }S_{B}\\text{ 中满足 }y\\leq t\\text{ 的观测值数量}\\right).\n$$\n双样本柯尔莫哥洛夫-斯米尔诺夫统计量是\n$$\nD_{n,m}=\\sup_{t}\\left|F_{n}(t)-G_{m}(t)\\right|.\n$$\n由于经验分布函数是在样本点处发生跳跃的右连续阶梯函数，其上确界（supremum）出现在合并样本值集合中的点 $t$ 处（或等价地，在这些跳跃点之前的区间上）。因此，我们只需在排序后的合并样本值处，以及如果需要的话，在这些点之前的位置，计算 $\\left|F_{n}(t)-G_{m}(t)\\right|$ 的值。\n\n对样本进行排序：\n- $S_{A}=\\{2.8,\\,3.5,\\,4.3,\\,5.1\\}$，\n- $S_{B}=\\{3.9,\\,4.1,\\,4.8,\\,5.5,\\,6.0\\}$。\n合并后的排序唯一值为\n$$\nt\\in\\{2.8,\\,3.5,\\,3.9,\\,4.1,\\,4.3,\\,4.8,\\,5.1,\\,5.5,\\,6.0\\}。\n$$\n\n在每个 $t$ 值处计算 $F_{4}(t)$ 和 $G_{5}(t)$ 以及它们的绝对差：\n- 当 $t=2.8$ 时：$F_{4}(2.8)=\\frac{1}{4}$，$G_{5}(2.8)=0$，差值 $=\\frac{1}{4}$。\n- 当 $t=3.5$ 时：$F_{4}(3.5)=\\frac{2}{4}=\\frac{1}{2}$，$G_{5}(3.5)=0$，差值 $=\\frac{1}{2}$。\n- 当 $t=3.9$ 时：$F_{4}(3.9)=\\frac{1}{2}$，$G_{5}(3.9)=\\frac{1}{5}$，差值 $=\\left|\\frac{1}{2}-\\frac{1}{5}\\right|=\\frac{3}{10}$。\n- 当 $t=4.1$ 时：$F_{4}(4.1)=\\frac{1}{2}$，$G_{5}(4.1)=\\frac{2}{5}$，差值 $=\\left|\\frac{1}{2}-\\frac{2}{5}\\right|=\\frac{1}{10}$。\n- 当 $t=4.3$ 时：$F_{4}(4.3)=\\frac{3}{4}$，$G_{5}(4.3)=\\frac{2}{5}$，差值 $=\\left|\\frac{3}{4}-\\frac{2}{5}\\right|=\\frac{7}{20}$。\n- 当 $t=4.8$ 时：$F_{4}(4.8)=\\frac{3}{4}$，$G_{5}(4.8)=\\frac{3}{5}$，差值 $=\\left|\\frac{3}{4}-\\frac{3}{5}\\right|=\\frac{3}{20}$。\n- 当 $t=5.1$ 时：$F_{4}(5.1)=1$，$G_{5}(5.1)=\\frac{3}{5}$，差值 $=\\left|1-\\frac{3}{5}\\right|=\\frac{2}{5}$。\n- 当 $t=5.5$ 时：$F_{4}(5.5)=1$，$G_{5}(5.5)=\\frac{4}{5}$，差值 $=\\left|1-\\frac{4}{5}\\right|=\\frac{1}{5}$。\n- 当 $t=6.0$ 时：$F_{4}(6.0)=1$，$G_{5}(6.0)=1$，差值 $=0$。\n\n为了确保找到所有 $t$ 上的上确界，还要注意在每次跳跃之前的值，即这些右连续阶梯函数的左极限。这样的最大值出现在 $t=3.9$ 之前的区间上，此时 $F_{4}=\\frac{1}{2}$ 且 $G_{5}=0$，差值为 $\\frac{1}{2}$，这与在 $t=3.5$ 处找到的最大值相符。\n\n因此，柯尔莫哥洛夫-斯米尔诺夫统计量为\n$$\nD_{4,5}=\\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1928076"}, {"introduction": "学会了如何计算 KS 统计量之后，理解其数值的含义至关重要。本练习 [@problem_id:1928083] 探讨了一种特殊但极具启发性的情况：如果 KS 统计量恰好为零，这意味着什么？通过思考这个情景，你将加深对检验统计量与样本数据内在结构之间关系的理解。", "problem": "在非参数统计领域，双样本柯尔莫哥洛夫-斯米尔诺夫 (K-S) 检验用于确定两个独立样本是否来自同一个潜在分布。该检验基于 K-S 统计量 $D_{n,m}$，其定义为两个样本的经验累积分布函数 (ECDF) 之间的最大绝对差。\n\n设样本 $X = \\{x_1, x_2, \\dots, x_n\\}$ 有 $n$ 个观测值，样本 $Y = \\{y_1, y_2, \\dots, y_m\\}$ 有 $m$ 个观测值。它们各自的 ECDF 记为 $F_n(t)$ 和 $G_m(t)$。K-S 统计量由下式给出：\n$$D_{n,m} = \\sup_{t} |F_n(t) - G_m(t)|$$\n其中 $\\sup_t$ 是对所有可能的 $t$ 值取的上确界。\n\n假设在收集了两个样本后，一位统计学家计算出 K-S 统计量的值恰好为零，即 $D_{n,m} = 0$。关于样本 $X$ 和 $Y$ 之间的关系，可以得出以下哪个最具体且数学上必然的结论？\n\nA. 两个样本必须完全相同，即它们是相同的多重集。\n\nB. 两个样本必须具有相同的均值和相同的中位数。\n\nC. 两个样本必须来自同一个潜在的连续概率分布。\n\nD. 两个样本中唯一值的集合相同，并且每个唯一值的比例（相对频率）在两个样本中也相同。\n\nE. 两个样本的大小必须相等（即 $n=m$）。", "solution": "根据定义，样本 $X=\\{x_{1},\\dots,x_{n}\\}$ 和 $Y=\\{y_{1},\\dots,y_{m}\\}$ 的经验累积分布函数 (ECDF) 是\n$$\nF_{n}(t)=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{1}\\{x_{i}\\le t\\},\\qquad\nG_{m}(t)=\\frac{1}{m}\\sum_{j=1}^{m}\\mathbf{1}\\{y_{j}\\le t\\}.\n$$\n双样本 Kolmogorov-Smirnov 统计量是\n$$\nD_{n,m}=\\sup_{t}|F_{n}(t)-G_{m}(t)|.\n$$\n如果 $D_{n,m}=0$，那么 $\\sup_{t}|F_{n}(t)-G_{m}(t)|=0$。因为对于所有的 $t$，都有 $|F_{n}(t)-G_{m}(t)|\\ge 0$，所以上确界为零意味着对每个 $t$ 都有 $|F_{n}(t)-G_{m}(t)|=0$，因此\n$$\nF_{n}(t)=G_{m}(t)\\quad\\text{对所有 }t\\in\\mathbb{R}.\n$$\n\nECDF 是一个右连续阶梯函数，在观测到的样本值处有跳跃。设 $S$ 表示任一样本中出现过的值 $v$ 的集合。对于任何 $v\\in S$，用 $k_{X}(v)$ 表示 $v$ 在 $X$ 中出现的次数，用 $k_{Y}(v)$ 表示 $v$ 在 $Y$ 中出现的次数。$F_{n}$ 在 $v$ 处的跳跃大小为\n$$\n\\Delta F_{n}(v)=\\lim_{t\\downarrow v}F_{n}(t)-\\lim_{t\\uparrow v}F_{n}(t)=\\frac{k_{X}(v)}{n},\n$$\n类似地，$G_{m}$ 在 $v$ 处的跳跃为 $\\Delta G_{m}(v)=\\frac{k_{Y}(v)}{m}$。函数的相等性 $F_{n}\\equiv G_{m}$ 意味着：\n- 它们在完全相同的位置有跳跃（否则这两个函数会在某个点的邻域内有所不同），因此 $X$ 中存在的唯一值集合与 $Y$ 中的相同；\n- 每个这样位置的跳跃大小必须相等，因此对于每个 $v$，\n$$\n\\frac{k_{X}(v)}{n}=\\frac{k_{Y}(v)}{m}.\n$$\n等价地，每个唯一值 $v$ 的相对频率在两个样本中是相同的。这恰恰说明了经验测度是一致的：\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}\\delta_{x_{i}}=\\frac{1}{m}\\sum_{j=1}^{m}\\delta_{y_{j}}.\n$$\n\n我们现在来评估各个选项：\n\n- A 不是必需的：ECDF 的相等性要求相对频率相等，而不是原始计数相等。例如，对于某个 $v$，可以有 $k_{X}(v)=1$ 和 $k_{Y}(v)=2$，只要满足 $\\frac{1}{n}=\\frac{2}{m}$；因此，多重集不必相同。\n- B 是正确的，但不是最具体的：相等的 ECDF 意味着相等的经验均值和中位数，但这比确定整个经验分布要弱。\n- C 不是必需的：$D_{n,m}=0$ 仅断言样本中实现的经验分布相等，而不是说潜在的生成分布相同，更不意味着它们是连续的。\n- D 完全符合上面推导出的充要条件：唯一值的集合及其相对频率一致。\n- E 不是必需的：如前所述，可能存在 $n\\ne m$ 的情况，同时对所有 $v$ 都有 $\\frac{k_{X}(v)}{n}=\\frac{k_{Y}(v)}{m}$ 成立。\n\n因此，最具体且数学上必然的结论是 D。", "answer": "$$\\boxed{D}$$", "id": "1928083"}, {"introduction": "每一种统计检验都有其理论边界。本练习 [@problem_id:1928079] 挑战你思考柯尔莫哥洛夫-斯米尔诺夫统计量的理论极限。通过确定其可能的最大值，你将洞悉该检验能检测到的、对应于两个样本完全分离的最极端差异情况。", "problem": "在统计分析中，双样本柯尔莫哥洛夫-斯米尔诺夫 (K-S) 检验是一种非参数检验，用于确定两个独立样本是否来自同一个潜在的连续分布。该检验量化了两个样本的经验分布函数之间的距离。\n\n对于一个包含 $k$ 个观测值 $\\{z_1, z_2, \\dots, z_k\\}$ 的样本，其经验分布函数 (EDF) 定义为 $E_k(x) = \\frac{1}{k} \\sum_{i=1}^{k} I(z_i \\le x)$，其中 $I(\\cdot)$ 是指示函数，当其参数为真时取值为 1，否则为 0。\n\n让我们考虑两个独立样本：样本 $X$ 包含 $n$ 个观测值 $\\{X_1, X_2, \\dots, X_n\\}$，样本 $Y$ 包含 $m$ 个观测值 $\\{Y_1, Y_2, \\dots, Y_m\\}$。设它们各自的经验分布函数为 $F_n(x)$ 和 $G_m(x)$。我们定义一个归一化的 K-S 统计量 $S_{n,m}$ 如下：\n$$S_{n,m} = \\sqrt{\\frac{nm}{n+m}} \\sup_{x} |F_n(x) - G_m(x)|$$\n\n给定固定的正整数样本量 $n$ 和 $m$，对于所有可能的样本对 $X$ 和 $Y$，统计量 $S_{n,m}$ 可能达到的最大值是多少？请用一个关于 $n$ 和 $m$ 的闭式解析表达式来表示你的答案。", "solution": "我们寻求统计量\n$$\nS_{n,m}=\\sqrt{\\frac{nm}{n+m}}\\sup_{x}\\left|F_{n}(x)-G_{m}(x)\\right|\n$$\n在所有固定大小为 $n$ 和 $m$ 的可能样本上的最大可能值。定义\n$$\nD_{n,m}\\equiv \\sup_{x}\\left|F_{n}(x)-G_{m}(x)\\right|.\n$$\n根据经验分布函数的定义，对于每一个 $x$，\n$$\n0\\leq F_{n}(x)\\leq 1,\\quad 0\\leq G_{m}(x)\\leq 1,\n$$\n因此\n$$\n\\left|F_{n}(x)-G_{m}(x)\\right|\\leq 1\\quad\\text{对于所有 }x,\n$$\n这意味着\n$$\nD_{n,m}\\leq 1.\n$$\n为了证明这个上界是可以达到的，我们可以构造完全分离的样本。例如，取所有 $i\\in\\{1,\\dots,n\\}$ 的 $X_{i}=0$ 和所有 $j\\in\\{1,\\dots,m\\}$ 的 $Y_{j}=1$。那么对于任何满足 $0 \\leq x  1$ 的 $x$，\n$$\nF_{n}(x)=\\frac{1}{n}\\sum_{i=1}^{n}I(0\\leq x)=1,\\qquad G_{m}(x)=\\frac{1}{m}\\sum_{j=1}^{m}I(1\\leq x)=0,\n$$\n因此 $\\left|F_{n}(x)-G_{m}(x)\\right|=1$，从而 $D_{n,m}=1$。因此，对于所有样本对，$D_{n,m}$ 的最大可能值为 $1$。\n\n将此结果代入 $S_{n,m}$ 的定义，得到 $S_{n,m}$ 的最大值为\n$$\n\\sqrt{\\frac{nm}{n+m}}\\cdot 1=\\sqrt{\\frac{nm}{n+m}}.\n$$\n这是一个关于 $n$ 和 $m$ 的闭式表达式。", "answer": "$$\\boxed{\\sqrt{\\frac{nm}{n+m}}}$$", "id": "1928079"}]}