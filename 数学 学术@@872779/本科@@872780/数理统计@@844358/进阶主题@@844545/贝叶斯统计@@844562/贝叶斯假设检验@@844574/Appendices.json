{"hands_on_practices": [{"introduction": "贝叶斯假设检验的第一步通常是量化数据提供的证据。贝叶斯因子是实现这一目标的主要工具，它直接比较了数据在两个竞争假设下的似然度。这个练习 ([@problem_id:1899175]) 提供了一个为两个简单假设计算贝叶斯因子的直接实践，为你解决更复杂的问题打下坚实的基础。", "problem": "在统计调查领域，一位研究人员正在研究一种新制造的电子开关的可靠性。该开关被设计为在第一次尝试时就激活，但制造上的不一致可能导致失败。开关首次激活所需的尝试次数 $X$ 被假定服从几何分布。几何分布的概率质量函数由 $P(X=k | p) = (1-p)^{k-1}p$ 给出，其中 $k \\in \\{1, 2, 3, \\dots\\}$ 是首次成功时的试验次数，$p$ 是任何单次试验中成功的概率。\n\n关于开关的质量，有两个相互竞争的假设：\n- 零假设 ($H_0$)：开关质量高，成功概率为 $p = 1/2$。\n- 备择假设 ($H_1$)：开关为标准质量，成功概率为 $p = 1/4$。\n\n从生产线上选取一个开关进行测试。观察到它在第4次尝试时首次激活。\n\n根据这一观察结果，计算支持零假设 ($H_0$) 相对于备择假设 ($H_1$) 的贝叶斯因子 $K$。请将您的答案表示为一个完全简化的分数。", "solution": "我们想要求基于观测数据 $X=4$ 时，支持 $H_{0}$ 相对于 $H_{1}$ 的贝叶斯因子。对于简单假设，贝叶斯因子定义为似然比：\n$$\nK=\\frac{P(X=4\\mid H_{0})}{P(X=4\\mid H_{1})}.\n$$\n在参数为 $p$ 的几何分布下，概率质量函数为\n$$\nP(X=k\\mid p)=(1-p)^{k-1}p,\\quad k\\in\\{1,2,3,\\dots\\}.\n$$\n对于 $H_{0}$，我们有 $p=\\frac{1}{2}$。代入 $k=4$ 可得\n$$\nP(X=4\\mid H_{0})=(1-\\tfrac{1}{2})^{3}\\cdot\\tfrac{1}{2}=\\left(\\tfrac{1}{2}\\right)^{3}\\cdot\\tfrac{1}{2}=\\left(\\tfrac{1}{2}\\right)^{4}=\\frac{1}{16}.\n$$\n对于 $H_{1}$，我们有 $p=\\frac{1}{4}$。代入 $k=4$ 可得\n$$\nP(X=4\\mid H_{1})=(1-\\tfrac{1}{4})^{3}\\cdot\\tfrac{1}{4}=\\left(\\tfrac{3}{4}\\right)^{3}\\cdot\\tfrac{1}{4}=\\frac{27}{64}\\cdot\\frac{1}{4}=\\frac{27}{256}.\n$$\n因此，贝叶斯因子是\n$$\nK=\\frac{\\frac{1}{16}}{\\frac{27}{256}}=\\frac{1}{16}\\cdot\\frac{256}{27}=\\frac{16}{27}.\n$$\n这已经是最简形式。", "answer": "$$\\boxed{\\frac{16}{27}}$$", "id": "1899175"}, {"introduction": "在理解了贝叶斯因子的基本计算之后，一个自然的问题是：什么样的观测数据不会偏向任何一个假设？这个练习 ([@problem_id:1899165]) 探讨了这样一个“无差别点”，在该点上贝叶斯因子恰好为1。理解这个平衡点可以让你更深刻地体会数据如何将证据支持从一个假设转向另一个。", "problem": "一位统计学家正在分析一个测量过程，并对某个物理参数 $\\theta$ 有两种相互竞争的理论。这些理论被表述为两个简单假设：\n- 原假设，$H_0: \\theta = 1$。\n- 备择假设，$H_1: \\theta = 2$。\n\n为了在这两个假设之间做出选择，进行了一次测量，得到观测值 $x$。根据测量设备的性质，已知观测值 $x$ 服从均值为 $\\theta$、方差为 $\\sigma^2 = 1$ 的正态分布。也就是说，在参数为 $\\theta$ 的条件下，观测到值 $x$ 的概率密度函数为：\n$$p(x|\\theta) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\theta)^2}{2}\\right)$$\n\n在贝叶斯假设检验中，来自数据的证据由贝叶斯因子 $B_{10}$ 来量化，它是数据在备择假设下的似然与数据在原假设下的似然之比：\n$$B_{10} = \\frac{p(x|H_1)}{p(x|H_0)}$$\n\n贝叶斯因子 $B_{10} = 1$ 表示观测数据没有提供偏好任何一个假设的证据。\n\n求观测值 $x$ 的精确数值，使得贝叶斯因子恰好为1，从而为 $H_0$ 和 $H_1$ 提供相等的支持。", "solution": "对于方差 $\\sigma^{2}=1$ 的正态模型，我们有两个简单假设：\n$H_{0}: \\theta=1$ 和 $H_{1}: \\theta=2$，其密度函数为\n$$\np(x \\mid \\theta)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-\\theta)^{2}}{2}\\right).\n$$\n支持 $H_{1}$ 而非 $H_{0}$ 的贝叶斯因子是\n$$\nB_{10}=\\frac{p(x \\mid H_{1})}{p(x \\mid H_{0})}\n=\\frac{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-2)^{2}}{2}\\right)}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-1)^{2}}{2}\\right)}\n=\\exp\\left(-\\frac{(x-2)^{2}-(x-1)^{2}}{2}\\right).\n$$\n为了获得相等的支持，设 $B_{10}=1$。取自然对数可得\n$$\n\\ln B_{10}=0 \\quad \\Longrightarrow \\quad -\\frac{(x-2)^{2}-(x-1)^{2}}{2}=0,\n$$\n因此\n$$\n(x-2)^{2}-(x-1)^{2}=0.\n$$\n展开两个平方项：\n$$\n(x-2)^{2}=x^{2}-4x+4, \\qquad (x-1)^{2}=x^{2}-2x+1.\n$$\n相减：\n$$\n(x^{2}-4x+4)-(x^{2}-2x+1)=-2x+3=0.\n$$\n求解 $x$：\n$$\n-2x+3=0 \\quad \\Longrightarrow \\quad x=\\frac{3}{2}.\n$$\n因此，$x=\\frac{3}{2}$ 会得到恰好为 $1$ 的贝叶斯因子，从而为 $H_{0}$ 和 $H_{1}$ 提供相等的支持。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1899165"}, {"introduction": "虽然贝叶斯因子衡量的是来自数据的证据，但贝叶斯推断的最终目的是更新我们的信念。最后一个练习 ([@problem_id:1899154]) 将我们从简单假设带到复合假设，并演示了完整的贝叶斯工作流程。我们将从一个先验信念开始，用数据对其进行更新以获得后验分布，然后利用这个后验分布来计算一个假设为真的概率。", "problem": "一家名为 InnovateSoft 的软件公司为其推荐引擎开发了一种新算法。该公司希望确定新算法是否有所改进，他们将改进定义为超过半数的用户偏爱该算法。令 $p$ 代表偏爱新算法的用户的真实比例。\n\n在进行用户研究之前，工程团队对 $p$ 的先验信念是弥散的，他们使用区间 $[0, 1]$ 上的均匀分布来对此建模。请注意，均匀(0,1)分布是贝塔分布的一个特例，具体来说是贝塔(1, 1)分布。\n\n然后，InnovateSoft 对 10 名用户的随机样本进行了一项测试。在该测试中，10 名用户中有 4 名表示偏爱新算法。\n\n根据这些测试结果，计算支持新算法被超过半数用户偏爱（$H_1: p > 0.5$）的假设相对于不支持（$H_0: p \\leq 0.5$）的后验优势比。将您的答案表示为最简分数形式。", "solution": "令 $p$ 为偏爱新算法的用户的真实比例。数据为 $n=10$ 个用户中有 $x=4$ 个偏爱，先验为 $p \\sim \\mathrm{Beta}(1,1)$（在 $[0,1]$ 上均匀分布）。根据贝塔-二项共轭性，后验分布为\n$$\np \\mid x \\sim \\mathrm{Beta}(\\alpha^{\\prime},\\beta^{\\prime}), \\quad \\alpha^{\\prime}=1+x=5,\\ \\beta^{\\prime}=1+(n-x)=7,\n$$\n因此 $p \\mid x \\sim \\mathrm{Beta}(5,7)$。\n\n我们需要计算支持 $H_{1}: p>0.5$ 相对于 $H_{0}: p \\leq 0.5$ 的后验优势比，即\n$$\n\\frac{\\Pr(p>0.5 \\mid x)}{\\Pr(p \\leq 0.5 \\mid x)}.\n$$\n当 $p \\mid x \\sim \\mathrm{Beta}(5,7)$ 时，后验概率为\n$$\n\\Pr(p \\leq 0.5 \\mid x)=I_{1/2}(5,7),\n$$\n即正则化不完全贝塔函数。对于正整数 $a,b$，\n$$\nI_{1/2}(a,b)=\\frac{1}{2^{a+b-1}} \\sum_{k=a}^{a+b-1} \\binom{a+b-1}{k}.\n$$\n因此，当 $a=5$，$b=7$，$a+b-1=11$ 时，\n$$\n\\Pr(p \\leq 0.5 \\mid x)=\\frac{1}{2^{11}} \\sum_{k=5}^{11} \\binom{11}{k},\n$$\n因此\n$$\n\\Pr(p>0.5 \\mid x)=1-\\Pr(p \\leq 0.5 \\mid x)=\\frac{1}{2^{11}} \\sum_{k=0}^{4} \\binom{11}{k}.\n$$\n计算部分和：\n$$\n\\sum_{k=0}^{4} \\binom{11}{k}=\\binom{11}{0}+\\binom{11}{1}+\\binom{11}{2}+\\binom{11}{3}+\\binom{11}{4}=1+11+55+165+330=562,\n$$\n且 $2^{11}=2048$。因此，\n$$\n\\Pr(p>0.5 \\mid x)=\\frac{562}{2048}=\\frac{281}{1024}, \\quad \\Pr(p \\leq 0.5 \\mid x)=1-\\frac{281}{1024}=\\frac{743}{1024}.\n$$\n后验优势比为\n$$\n\\frac{\\Pr(p>0.5 \\mid x)}{\\Pr(p \\leq 0.5 \\mid x)}=\\frac{281/1024}{743/1024}=\\frac{281}{743}.\n$$\n这已经是最简形式。", "answer": "$$\\boxed{\\frac{281}{743}}$$", "id": "1899154"}]}