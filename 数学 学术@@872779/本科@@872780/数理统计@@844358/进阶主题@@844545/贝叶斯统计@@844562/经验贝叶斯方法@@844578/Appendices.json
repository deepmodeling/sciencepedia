{"hands_on_practices": [{"introduction": "经验贝叶斯方法的核心在于“借力”于数据来估计先验分布。本练习将通过一个经典的指数-伽玛共轭模型，引导你从第一性原理出发，推导边缘矩并使用矩估计法来估计先验参数。通过这个练习 [@problem_id:1915124]，你将掌握如何从观测数据（如产品寿命）中为潜在的变化率（如不同批次的故障率）估计一个合适的先验分布。", "problem": "一位材料科学家正在研究一种新开发的高强度发光二极管（LED）的可靠性。这些LED是在不同的生产批次中制造的。该科学家将来自给定批次 $i$ 的一个LED的寿命 $T$（单位为千小时）建模为一个随机变量，该变量服从速率参数为 $\\lambda_i$ 的指数分布。寿命 $T$ 的概率密度函数（PDF）由 $f(t|\\lambda_i) = \\lambda_i \\exp(-\\lambda_i t)$ 给出，其中 $t  0$。\n\n由于制造过程中的微小差异，速率参数 $\\lambda_i$ 本身被认为是一个随批次而变化的随机变量。这种可变性通过假设 $\\lambda_i$ 是从一个形状参数为 $\\alpha  0$、速率参数为 $\\beta  0$ 的伽马分布中抽取的来建模。$\\lambda_i$ 的概率密度函数由 $g(\\lambda|\\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda)$ 给出，其中 $\\lambda  0$，$ \\Gamma(\\cdot)$ 是伽马函数。\n\n这位科学家从四个不同的生产批次中各测试一个LED，并记录了它们的寿命。观测到的寿命（单位为千小时）为：\n$$ \\{20.0, 80.0, 200.0, 700.0\\} $$\n使用矩估计法对寿命的边缘分布进行分析，确定伽马分布的参数 $\\alpha$ 和 $\\beta$ 的估计值。请按顺序给出 $\\alpha$ 的估计值和 $\\beta$ 的估计值。将您的最终数值答案四舍五入到四位有效数字。", "solution": "该问题要求我们根据来自指数似然函数的数据，找到伽马先验分布参数 $\\alpha$ 和 $\\beta$ 的矩估计值。这是一个常见的经验贝叶斯设置。该模型规定如下：\n1.  似然函数：$T_i | \\lambda_i \\sim \\text{Exponential}(\\lambda_i)$\n2.  先验分布：$\\lambda_i \\sim \\text{Gamma}(\\alpha, \\beta)$\n\n矩估计法涉及将 $T_i$ 的边缘分布的理论矩与根据数据计算出的样本矩相等。我们需要求出前两个理论矩，$E[T_i]$ 和 $E[T_i^2]$。\n\n首先，我们求一阶矩 $E[T_i]$。我们使用全期望定律：$E[T_i] = E[E[T_i | \\lambda_i]]$。\n对于速率为 $\\lambda_i$ 的指数分布，其期望为 $E[T_i | \\lambda_i] = \\frac{1}{\\lambda_i}$。\n因此，我们需要计算 $E[T_i] = E\\left[\\frac{1}{\\lambda_i}\\right]$，其中外层期望是关于 $\\lambda_i$ 的分布（即 $\\text{Gamma}(\\alpha, \\beta)$）求的。\n$$ E[\\lambda_i^{-1}] = \\int_0^\\infty \\lambda^{-1} g(\\lambda|\\alpha, \\beta) d\\lambda = \\int_0^\\infty \\lambda^{-1} \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) d\\lambda $$\n$$ E[\\lambda_i^{-1}] = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\int_0^\\infty \\lambda^{\\alpha-2} \\exp(-\\beta \\lambda) d\\lambda $$\n该积分是一个形状参数为 $\\alpha-1$、速率参数为 $\\beta$ 的伽马分布的核。这个积分的值是 $\\frac{\\Gamma(\\alpha-1)}{\\beta^{\\alpha-1}}$。这要求 $\\alpha-1  0$，即 $\\alpha  1$。\n$$ E[\\lambda_i^{-1}] = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\frac{\\Gamma(\\alpha-1)}{\\beta^{\\alpha-1}} = \\frac{\\beta}{\\Gamma(\\alpha)/\\Gamma(\\alpha-1)} $$\n利用性质 $\\Gamma(z) = (z-1)\\Gamma(z-1)$，我们有 $\\Gamma(\\alpha) = (\\alpha-1)\\Gamma(\\alpha-1)$。\n$$ E[T_i] = E[\\lambda_i^{-1}] = \\frac{\\beta}{\\alpha-1} $$\n\n接下来，我们求二阶矩 $E[T_i^2]$。我们再次使用全期望定律：$E[T_i^2] = E[E[T_i^2 | \\lambda_i]]$。\n对于指数分布，其二阶矩为 $E[T_i^2 | \\lambda_i] = \\frac{2}{\\lambda_i^2}$。\n因此，我们需要计算 $E[T_i^2] = E\\left[\\frac{2}{\\lambda_i^2}\\right] = 2 E[\\lambda_i^{-2}]$。\n$$ E[\\lambda_i^{-2}] = \\int_0^\\infty \\lambda^{-2} \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) d\\lambda = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\int_0^\\infty \\lambda^{\\alpha-3} \\exp(-\\beta \\lambda) d\\lambda $$\n该积分是一个形状参数为 $\\alpha-2$、速率参数为 $\\beta$ 的伽马分布的核。其值为 $\\frac{\\Gamma(\\alpha-2)}{\\beta^{\\alpha-2}}$，这要求 $\\alpha-2  0$，即 $\\alpha  2$。\n$$ E[\\lambda_i^{-2}] = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\frac{\\Gamma(\\alpha-2)}{\\beta^{\\alpha-2}} = \\frac{\\beta^2}{\\Gamma(\\alpha)/\\Gamma(\\alpha-2)} $$\n利用性质 $\\Gamma(\\alpha) = (\\alpha-1)(\\alpha-2)\\Gamma(\\alpha-2)$。\n$$ E[\\lambda_i^{-2}] = \\frac{\\beta^2}{(\\alpha-1)(\\alpha-2)} $$\n因此，$T_i$ 的二阶矩为：\n$$ E[T_i^2] = 2 E[\\lambda_i^{-2}] = \\frac{2\\beta^2}{(\\alpha-1)(\\alpha-2)} $$\n\n现在，我们根据数据 $\\{20.0, 80.0, 200.0, 700.0\\}$ 计算样本矩。令 $n=4$。\n一阶样本矩（样本均值）是：\n$$ \\bar{t} = \\frac{1}{n} \\sum_{i=1}^n t_i = \\frac{20.0 + 80.0 + 200.0 + 700.0}{4} = \\frac{1000.0}{4} = 250.0 $$\n二阶样本矩是：\n$$ m_2 = \\frac{1}{n} \\sum_{i=1}^n t_i^2 = \\frac{20.0^2 + 80.0^2 + 200.0^2 + 700.0^2}{4} $$\n$$ m_2 = \\frac{400 + 6400 + 40000 + 490000}{4} = \\frac{536800}{4} = 134200 $$\n\n我们将理论矩与样本矩相等，得到一个关于估计值 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 的方程组：\n1.  $\\bar{t} = \\frac{\\hat{\\beta}}{\\hat{\\alpha}-1} \\implies 250.0 = \\frac{\\hat{\\beta}}{\\hat{\\alpha}-1}$\n2.  $m_2 = \\frac{2\\hat{\\beta}^2}{(\\hat{\\alpha}-1)(\\hat{\\alpha}-2)} \\implies 134200 = \\frac{2\\hat{\\beta}^2}{(\\hat{\\alpha}-1)(\\hat{\\alpha}-2)}$\n\n从方程（1）中，我们求解 $\\hat{\\beta}$：\n$\\hat{\\beta} = 250.0(\\hat{\\alpha}-1)$。\n\n将 $\\hat{\\beta}$ 的这个表达式代入方程（2）：\n$$ 134200 = \\frac{2 [250.0(\\hat{\\alpha}-1)]^2}{(\\hat{\\alpha}-1)(\\hat{\\alpha}-2)} = \\frac{2 (250.0^2) (\\hat{\\alpha}-1)^2}{(\\hat{\\alpha}-1)(\\hat{\\alpha}-2)} $$\n$$ 134200 = \\frac{2 (62500) (\\hat{\\alpha}-1)}{\\hat{\\alpha}-2} = \\frac{125000 (\\hat{\\alpha}-1)}{\\hat{\\alpha}-2} $$\n现在，我们求解 $\\hat{\\alpha}$：\n$$ 134200 (\\hat{\\alpha}-2) = 125000 (\\hat{\\alpha}-1) $$\n$$ 134200\\hat{\\alpha} - 268400 = 125000\\hat{\\alpha} - 125000 $$\n$$ (134200 - 125000)\\hat{\\alpha} = 268400 - 125000 $$\n$$ 9200\\hat{\\alpha} = 143400 $$\n$$ \\hat{\\alpha} = \\frac{143400}{9200} = 15.5869565... $$\n四舍五入到四位有效数字，$\\hat{\\alpha} = 15.59$。\n\n现在我们使用表达式 $\\hat{\\beta} = 250.0(\\hat{\\alpha}-1)$ 来求 $\\hat{\\beta}$：\n$$ \\hat{\\beta} = 250.0 (15.5869565... - 1) = 250.0 (14.5869565...) = 3646.73913... $$\n四舍五入到四位有效数字，$\\hat{\\beta} = 3647$。\n\n估计值为 $\\hat{\\alpha} = 15.59$ 和 $\\hat{\\beta} = 3647$。", "answer": "$$\\boxed{\\begin{pmatrix} 15.59  3647 \\end{pmatrix}}$$", "id": "1915124"}, {"introduction": "在许多领域，我们关心的是比例或成功率，例如广告点击率或临床试验的成功率。Beta-二项模型是处理这类数据的标准工具。这个练习 [@problem_id:1915175] 让你将矩估计法应用于一个新场景，通过分析来自不同组的样本比例，来估计描述这些比例变化的Beta先验分布的参数。", "problem": "一家数字营销公司正在分析一则新广告在几个不同都市区的表现。在 $k$ 个地区中的每一个，该广告都被展示给 $n$ 名随机选择的个人。设 $x_i$ 为在第 $i$ 个地区点击该广告的人数。\n\n该公司使用贝塔-二项分布模型对此情况进行建模。对于每个地区 $i$，点击次数 $X_i$ 被假设服从二项分布，$X_i \\sim \\text{Bin}(n, p_i)$，其中 $p_i$ 是该地区真实的点击率。点击率 $p_i$ 本身被假设抽取自一个共同的贝塔分布，$p_i \\sim \\text{Beta}(\\alpha, \\beta)$，该分布描述了广告效果在不同地区间的差异。\n\n该公司希望使用矩估计法来估计贝塔先验分布的参数 $\\alpha$ 和 $\\beta$。这包括首先根据观测数据估计先验分布的均值 $\\mu_p$ 和方差 $\\sigma_p^2$。一个标准流程将贝塔先验的矩与观测比例 $\\hat{p}_i = x_i/n$ 的样本统计量联系起来。设 $\\bar{p}$ 为样本比例的均值， $s_p^2$ 为其无偏样本方差。先验均值和方差的矩估计量为：\n$$ \\hat{\\mu}_p = \\bar{p} $$\n$$ \\hat{\\sigma}_p^2 = \\frac{n}{n-1}\\left( s_p^2 - \\frac{\\bar{p}(1-\\bar{p})}{n} \\right) $$\n一旦计算出 $\\hat{\\mu}_p$ 和 $\\hat{\\sigma}_p^2$，就可以通过求解以下矩方程来找到贝塔分布的参数：\n$$ \\hat{\\mu}_p = \\frac{\\hat{\\alpha}}{\\hat{\\alpha}+\\hat{\\beta}} \\quad \\text{和} \\quad \\hat{\\sigma}_p^2 = \\frac{\\hat{\\mu}_p(1-\\hat{\\mu}_p)}{\\hat{\\alpha}+\\hat{\\beta}+1} $$\n\n假设实验在 $k=4$ 个地区进行，每个地区有 $n=50$ 次广告展示。观测到的点击次数为：\n$$ x_1 = 5, \\quad x_2 = 10, \\quad x_3 = 15, \\quad x_4 = 20 $$\n\n计算矩估计量 $(\\hat{\\alpha}, \\hat{\\beta})$。将您的最终答案表示为一对最简分数。", "solution": "目标是求出贝塔先验分布参数 $\\alpha$ 和 $\\beta$ 的矩估计量。该过程包括三个主要步骤：\n1.  从数据中计算描述性统计量。\n2.  使用这些统计量来估计先验分布的均值 $\\mu_p$ 和方差 $\\sigma_p^2$。\n3.  使用矩方程求解贝塔分布的参数 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$。\n\n**步骤 1：计算样本统计量**\n\n观测到的点击次数为 $x_1 = 5, x_2 = 10, x_3 = 15, x_4 = 20$。每个地区的试验次数为 $n=50$。\n首先，我们为 $k=4$ 个地区中的每一个计算样本比例 $\\hat{p}_i = x_i/n$：\n$$ \\hat{p}_1 = \\frac{5}{50} = 0.1 $$\n$$ \\hat{p}_2 = \\frac{10}{50} = 0.2 $$\n$$ \\hat{p}_3 = \\frac{15}{50} = 0.3 $$\n$$ \\hat{p}_4 = \\frac{20}{50} = 0.4 $$\n\n接下来，我们计算这些样本比例的均值 $\\bar{p}$：\n$$ \\bar{p} = \\frac{1}{k} \\sum_{i=1}^{k} \\hat{p}_i = \\frac{0.1 + 0.2 + 0.3 + 0.4}{4} = \\frac{1.0}{4} = 0.25 $$\n\n然后，我们计算这些比例的无偏样本方差 $s_p^2$：\n$$ s_p^2 = \\frac{1}{k-1} \\sum_{i=1}^{k} (\\hat{p}_i - \\bar{p})^2 $$\n$$ s_p^2 = \\frac{1}{3} \\left( (0.1 - 0.25)^2 + (0.2 - 0.25)^2 + (0.3 - 0.25)^2 + (0.4 - 0.25)^2 \\right) $$\n$$ s_p^2 = \\frac{1}{3} \\left( (-0.15)^2 + (-0.05)^2 + (0.05)^2 + (0.15)^2 \\right) $$\n$$ s_p^2 = \\frac{1}{3} \\left( 0.0225 + 0.0025 + 0.0025 + 0.0225 \\right) $$\n$$ s_p^2 = \\frac{1}{3} (0.05) = \\frac{0.05}{3} = \\frac{1}{20 \\times 3} = \\frac{1}{60} $$\n\n**步骤 2：估计先验分布的矩**\n\n使用题目描述中提供的公式，我们估计贝塔先验的均值 $\\mu_p$ 和方差 $\\sigma_p^2$。\n均值的估计量就是样本比例的均值：\n$$ \\hat{\\mu}_p = \\bar{p} = 0.25 = \\frac{1}{4} $$\n\n方差的估计量为：\n$$ \\hat{\\sigma}_p^2 = \\frac{n}{n-1}\\left( s_p^2 - \\frac{\\bar{p}(1-\\bar{p})}{n} \\right) $$\n我们代入已有的值：$n=50$，$\\bar{p}=0.25$，以及 $s_p^2 = 1/60$。\n$$ \\hat{\\sigma}_p^2 = \\frac{50}{50-1}\\left( \\frac{1}{60} - \\frac{0.25 \\times (1-0.25)}{50} \\right) $$\n$$ \\hat{\\sigma}_p^2 = \\frac{50}{49}\\left( \\frac{1}{60} - \\frac{0.25 \\times 0.75}{50} \\right) = \\frac{50}{49}\\left( \\frac{1}{60} - \\frac{0.1875}{50} \\right) $$\n为了使用分数进行计算：$0.1875 = \\frac{3}{16}$。\n$$ \\hat{\\sigma}_p^2 = \\frac{50}{49}\\left( \\frac{1}{60} - \\frac{3/16}{50} \\right) = \\frac{50}{49}\\left( \\frac{1}{60} - \\frac{3}{800} \\right) $$\n找到括号中各项的通分母，即 2400。\n$$ \\hat{\\sigma}_p^2 = \\frac{50}{49}\\left( \\frac{40}{2400} - \\frac{9}{2400} \\right) = \\frac{50}{49}\\left( \\frac{31}{2400} \\right) $$\n$$ \\hat{\\sigma}_p^2 = \\frac{1}{49}\\left( \\frac{31}{48} \\right) = \\frac{31}{2352} $$\n\n**步骤 3：求解贝塔参数 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$**\n\n现在我们使用贝塔分布的矩方程以及我们的估计量 $\\hat{\\mu}_p$ 和 $\\hat{\\sigma}_p^2$。\n$$ \\hat{\\mu}_p = \\frac{\\hat{\\alpha}}{\\hat{\\alpha}+\\hat{\\beta}} \\quad \\text{和} \\quad \\hat{\\sigma}_p^2 = \\frac{\\hat{\\mu}_p(1-\\hat{\\mu}_p)}{\\hat{\\alpha}+\\hat{\\beta}+1} $$\n从第二个方程中，我们可以解出和 $\\hat{\\alpha}+\\hat{\\beta}$：\n$$ \\hat{\\alpha}+\\hat{\\beta}+1 = \\frac{\\hat{\\mu}_p(1-\\hat{\\mu}_p)}{\\hat{\\sigma}_p^2} $$\n$$ \\hat{\\alpha}+\\hat{\\beta} = \\frac{\\hat{\\mu}_p(1-\\hat{\\mu}_p)}{\\hat{\\sigma}_p^2} - 1 $$\n我们来计算 $\\hat{\\mu}_p(1-\\hat{\\mu}_p)$：\n$$ \\hat{\\mu}_p(1-\\hat{\\mu}_p) = \\frac{1}{4} \\left(1-\\frac{1}{4}\\right) = \\frac{1}{4} \\times \\frac{3}{4} = \\frac{3}{16} $$\n现在将此值和 $\\hat{\\sigma}_p^2 = \\frac{31}{2352}$ 代入求和的方程中：\n$$ \\hat{\\alpha}+\\hat{\\beta} = \\frac{3/16}{31/2352} - 1 = \\frac{3}{16} \\times \\frac{2352}{31} - 1 $$\n我们简化分数：$2352 \\div 16 = 147$。\n$$ \\hat{\\alpha}+\\hat{\\beta} = \\frac{3 \\times 147}{31} - 1 = \\frac{441}{31} - \\frac{31}{31} = \\frac{410}{31} $$\n现在我们使用第一个矩方程来分别求出 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$。设 $S = \\hat{\\alpha}+\\hat{\\beta} = \\frac{410}{31}$。\n$$ \\hat{\\alpha} = S \\times \\hat{\\mu}_p = \\frac{410}{31} \\times \\frac{1}{4} = \\frac{205}{62} $$\n$$ \\hat{\\beta} = S \\times (1-\\hat{\\mu}_p) = \\frac{410}{31} \\times \\frac{3}{4} = \\frac{205 \\times 3}{31 \\times 2} = \\frac{615}{62} $$\n估计值为 $(\\hat{\\alpha}, \\hat{\\beta}) = \\left(\\frac{205}{62}, \\frac{615}{62}\\right)$。这些是最简分数形式。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{205}{62}  \\frac{615}{62} \\end{pmatrix}}$$", "id": "1915175"}, {"introduction": "矩估计法虽然直观且强大，但在实际应用中可能会遇到意想不到的挑战，例如估算出负的方差。本练习 [@problem_id:1915166] 探讨了在应用广泛的正态-正态模型时可能出现的这一关键问题。通过解决这个问题，你将学会如何正确解释并处理这种在理论上不可能的估计值，这对于严谨地应用经验贝叶斯方法至关重要。", "problem": "一个教育研究团队正在评估一种新的教学方法在 $J=4$ 个不同学区的效果。对于每个学区 $j$，他们都获得了一个学生平均分数提高值的估计值，记为 $Y_j$。已知该估计值具有特定的抽样方差 $\\sigma_j^2$，其大小取决于该学区研究中的学生数量。研究人员采用经验贝叶斯方法，使用正态-正态层级模型对分数提高值进行建模。\n\n模型规定如下：\n1.  每个学区观测到的提高值 $Y_j$ 是该学区真实但未知的效度 $\\theta_j$ 的一个估计。抽样分布为 $Y_j | \\theta_j \\sim N(\\theta_j, \\sigma_j^2)$。\n2.  不同学区的真实效度水平 $\\theta_j$ 被假定是从一个共同的总体分布中抽取的，该分布由一个正态先验建模：$\\theta_j \\sim N(\\mu, \\tau^2)$。这里，$\\mu$ 代表该方法的总体平均效度，而 $\\tau^2$ 代表学区之间效度的真实方差。\n\n收集的数据如下：\n-   观测到的分数提高值：$Y = \\{8.00, 9.00, 11.00, 12.00\\}$\n-   已知抽样方差：$\\sigma^2 = \\{5.00, 6.00, 7.00, 8.00\\}$\n\n一位分析师的任务是使用矩估计法对观测数据 $\\{Y_j\\}$ 进行分析，以估计学区际方差超参数 $\\tau^2$。根据这个估计的结果，必须对该模型得出一个结论。\n\n选择一个选项，该选项正确陈述了 $\\tau^2$ 的初始矩估计法估计值（四舍五入到三位有效数字），并描述了在经验贝叶斯框架下通常的解释或后续程序步骤。\n\nA. 估计值为 $\\hat{\\tau}^2 = -3.17$。该估计值被截断为 0，从而得出结论：没有证据表明效度在学区之间存在真实的变异。\n\nB. 估计值为 $\\hat{\\tau}^2 = 3.33$。这表明真实的学区际方差为正，但小于平均抽样不确定性。\n\nC. 估计值为 $\\hat{\\tau}^2 = -3.17$。负的方差估计使正态先验假设无效，若不选择不同的先验分布，分析无法继续。\n\nD. 估计值为 $\\hat{\\tau}^2 = 6.50$。这表明学区际方差等于平均抽样方差，意味着高度的不确定性。\n\nE. 估计值为 $\\hat{\\tau}^2 = 0$。得到这个值是因为观测值的样本方差小于平均抽样方差，使得矩估计法不适用。", "solution": "我们从已知抽样方差的层级正态模型开始。对于每个学区 $j$，抽样模型是 $Y_{j} \\mid \\theta_{j} \\sim N(\\theta_{j}, \\sigma_{j}^{2})$，先验分布是 $\\theta_{j} \\sim N(\\mu, \\tau^{2})$。根据全方差定律，\n$$\n\\operatorname{Var}(Y_{j}) \\;=\\; \\operatorname{E}\\!\\left[\\operatorname{Var}(Y_{j}\\mid \\theta_{j})\\right] \\;+\\; \\operatorname{Var}\\!\\left(\\operatorname{E}[Y_{j}\\mid \\theta_{j}]\\right) \\;=\\; \\sigma_{j}^{2} \\;+\\; \\tau^{2}.\n$$\n因为不同学区的 $\\sigma_{j}^{2}$ 不同，矩估计法将 $\\{Y_{j}\\}$ 的经验方差与模型方差的平均值相等同：\n$$\n\\frac{1}{J}\\sum_{j=1}^{J}\\operatorname{Var}(Y_{j}) \\;=\\; \\tau^{2} \\;+\\; \\frac{1}{J}\\sum_{j=1}^{J}\\sigma_{j}^{2}.\n$$\n使用观测值的样本方差作为左侧的矩估计量，矩估计法的估计量为\n$$\n\\hat{\\tau}^{2} \\;=\\; s_{Y}^{2} \\;-\\; \\bar{\\sigma^{2}},\n$$\n其中\n$$\n\\bar{\\sigma^{2}} \\;=\\; \\frac{1}{J}\\sum_{j=1}^{J}\\sigma_{j}^{2}, \\qquad s_{Y}^{2} \\;=\\; \\frac{1}{J-1}\\sum_{j=1}^{J}\\left(Y_{j}-\\bar{Y}\\right)^{2}, \\qquad \\bar{Y} \\;=\\; \\frac{1}{J}\\sum_{j=1}^{J}Y_{j}.\n$$\n根据数据 $Y=\\{8.00,9.00,11.00,12.00\\}$ 和 $J=4$ 计算 $\\bar{Y}$ 和 $s_{Y}^{2}$。首先，\n$$\n\\bar{Y} \\;=\\; \\frac{8+9+11+12}{4} \\;=\\; 10.\n$$\n那么偏差为 $-2,-1,1,2$，偏差的平方和为 $10$，所以\n$$\ns_{Y}^{2} \\;=\\; \\frac{10}{4-1} \\;=\\; \\frac{10}{3}.\n$$\n平均抽样方差为\n$$\n\\bar{\\sigma^{2}} \\;=\\; \\frac{5+6+7+8}{4} \\;=\\; \\frac{26}{4} \\;=\\; \\frac{13}{2}.\n$$\n因此，\n$$\n\\hat{\\tau}^{2} \\;=\\; \\frac{10}{3} \\;-\\; \\frac{13}{2} \\;=\\; \\frac{20-39}{6} \\;=\\; -\\frac{19}{6} \\;\\approx\\; -3.17,\n$$\n四舍五入到三位有效数字。在经验贝叶斯实践中，方差分量被限制为非负，因此负的矩估计值被截断为 $0$。标准的解释是，没有证据表明除了抽样误差之外，学区之间还存在真实的异质性，因此接下来的分析使用 $\\hat{\\tau}^{2}=0$。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1915166"}]}