{"hands_on_practices": [{"introduction": "本练习为贝叶斯更新提供了一个基础实践。我们将通过一个涉及正态数据模型和正态先验的经典场景来计算后验均值，这个练习将展示单个数据点如何改变我们对参数的信念 [@problem_id:1945460]。", "problem": "一位质量控制工程师正在分析一批新电子元件的电阻。这批元件中单个元件的电阻服从正态分布 $N(\\mu, \\sigma^2)$，其电阻均值 $\\mu$ 未知，但方差已知为 $\\sigma^2 = 9 \\, \\Omega^2$。该工程师对平均电阻 $\\mu$ 的先验信念是，它服从一个以目标设计值为中心的正态分布。具体来说，$\\mu$ 的先验分布为 $N(\\mu_0, \\tau^2)$，其均值为 $\\mu_0 = 0 \\, \\Omega$，方差为 $\\tau^2 = 1 \\, \\Omega^2$。\n\n工程师从这批元件中随机抽取一个，并测量其电阻为 $x = 5 \\, \\Omega$。\n\n根据这个单一观测值，计算 $\\mu$ 的后验均值。请用精确分数表示您的答案。", "solution": "我们将观测值建模为 $x \\mid \\mu \\sim N(\\mu, \\sigma^{2})$，其中方差 $\\sigma^{2}$ 已知，先验分布为 $\\mu \\sim N(\\mu_{0}, \\tau^{2})$。正态-正态共轭更新给出的后验分布为 $\\mu \\mid x \\sim N(\\mu_{n}, \\tau_{n}^{2})$，其中\n$$\n\\tau_{n}^{2}=\\left(\\frac{1}{\\tau^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}, \\quad \\mu_{n}=\\tau_{n}^{2}\\left(\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{n \\bar{x}}{\\sigma^{2}}\\right).\n$$\n对于单个观测值，有 $n=1$ 且 $\\bar{x}=x$，因此\n$$\n\\mu_{n}=\\frac{\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{x}{\\sigma^{2}}}{\\frac{1}{\\tau^{2}}+\\frac{1}{\\sigma^{2}}}.\n$$\n代入 $\\mu_{0}=0$，$\\tau^{2}=1$，$\\sigma^{2}=9$ 和 $x=5$，我们得到\n$$\n\\mu_{n}=\\frac{0+\\frac{5}{9}}{1+\\frac{1}{9}}=\\frac{\\frac{5}{9}}{\\frac{10}{9}}=\\frac{5}{10}=\\frac{1}{2}.\n$$\n因此，后验均值为 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1945460"}, {"introduction": "超越标准的共轭模型，本问题挑战你寻找参数最可能的值，即后验众数。你将处理一个非标准的先验分布，这需要应用微积分来直接最大化后验密度函数 [@problem_id:1945427]。", "problem": "一个工程团队正在测试一种新型固态晶体管，用于卫星通信系统。晶体管的可靠性，定义为其在特定压力测试下正常工作的概率 $p$，是未知的。根据理论模型和类似材料的性能，该团队对 $p$ 的先验信念由区间 $[0, 1]$ 上的一个三角概率密度函数描述：\n$$ \\pi(p) = 2p, \\quad \\text{for } 0 \\le p \\le 1 $$\n这个先验分布反映了他们认为可靠性越高，其概率也越大的信念。\n\n为了更新他们的信念，该团队进行了一项实验，包括对三个相同的晶体管进行三次独立的压力测试。实验结果是两个晶体管正常工作，一个发生故障。\n\n假设测试结果是独立的伯努利试验，计算可靠性概率 $p$ 的后验众数。后验众数是使后验概率密度函数最大化的参数值。", "solution": "该问题要求我们找到概率 $p$ 的后验众数。在贝叶斯统计中，后验分布是通过贝叶斯定理将先验分布与似然函数相结合得到的。后验分布正比于似然函数与先验分布的乘积：\n$$ \\pi(p | \\text{data}) \\propto L(\\text{data} | p) \\times \\pi(p) $$\n后验众数是使该后验概率密度函数最大化的 $p$ 值。\n\n首先，我们确定先验分布。问题陈述了 $p$ 的先验概率密度函数 (PDF) 为：\n$$ \\pi(p) = 2p, \\quad \\text{for } p \\in [0, 1] $$\n\n接下来，我们确定似然函数。数据包含三次独立试验的结果：两次成功（正常工作）和一次失败。这是一个 $n=3$ 次试验和 $k=2$ 次成功的二项实验。二项结果的似然函数由下式给出：\n$$ L(k, n | p) = \\binom{n}{k} p^{k} (1-p)^{n-k} $$\n代入我们的数据，$n=3$ 和 $k=2$，我们得到：\n$$ L(\\text{data} | p) = \\binom{3}{2} p^{2} (1-p)^{3-2} = 3p^{2}(1-p) $$\n\n现在，我们可以通过将似然函数和先验分布相乘来找到后验分布。我们只需要后验分布中依赖于 $p$ 的部分，因为任何常数因子都不会影响众数的位置。这部分通常被称为后验分布的核。\n$$ \\pi(p | \\text{data}) \\propto L(\\text{data} | p) \\times \\pi(p) $$\n$$ \\pi(p | \\text{data}) \\propto \\left( 3p^{2}(1-p) \\right) \\times (2p) $$\n$$ \\pi(p | \\text{data}) \\propto 6p^{3}(1-p) $$\n为了找到众数，我们需要找到在区间 $[0, 1]$ 内使函数 $f(p) = p^{3}(1-p)$ 最大化的 $p$ 值。我们可以忽略常数因子 6。让我们展开这个函数：\n$$ f(p) = p^3 - p^4 $$\n为了找到最大值，我们对 $f(p)$ 关于 $p$ 求导，并令其为零。\n$$ f'(p) = \\frac{d}{dp}(p^3 - p^4) = 3p^2 - 4p^3 $$\n将导数设为零以找到临界点：\n$$ 3p^2 - 4p^3 = 0 $$\n$$ p^2(3 - 4p) = 0 $$\n这个方程在区间 $[0, 1]$ 内有两个解：$p=0$ 和 $3 - 4p = 0$，后者给出 $p = \\frac{3}{4}$。\n\n为了确定这些临界点中哪一个对应于最大值，我们可以使用二阶导数检验。$f(p)$ 的二阶导数是：\n$$ f''(p) = \\frac{d}{dp}(3p^2 - 4p^3) = 6p - 12p^2 $$\n现在我们在临界点处计算二阶导数的值：\n在 $p=0$ 处：\n$$ f''(0) = 6(0) - 12(0)^2 = 0 $$\n对于 $p=0$，二阶导数检验是不确定的。然而，通过检查一阶导数 $f'(p) = p^2(3-4p)$，我们看到对于一个小的正值 $p$（例如，$p=0.1$），$f'(p)$ 是正的。这意味着函数从 $p=0$ 开始是增加的，所以 $p=0$ 必须是一个局部最小值，对应于零的后验概率。\n\n在 $p = \\frac{3}{4}$ 处：\n$$ f''\\left(\\frac{3}{4}\\right) = 6\\left(\\frac{3}{4}\\right) - 12\\left(\\frac{3}{4}\\right)^2 = \\frac{18}{4} - 12\\left(\\frac{9}{16}\\right) = \\frac{9}{2} - \\frac{27}{4} = \\frac{18}{4} - \\frac{27}{4} = -\\frac{9}{4} $$\n因为 $f''(\\frac{3}{4})  0$，函数 $f(p)$ 在 $p = \\frac{3}{4}$ 处有一个局部最大值。由于这是区间 $(0, 1)$ 内唯一的局部最大值，因此它也是 $p$ 定义域内的全局最大值。\n\n因此，可靠性概率 $p$ 的后验众数是 $\\frac{3}{4}$。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "1945427"}, {"introduction": "最后一个练习从计算转向解释。通过分析一个 Beta-二项分布模型的场景，你将探索新的证据不仅如何更新我们的估计，还如何改变后验分布的形状，从而影响其均值和中位数之间的关系 [@problem_id:1945414]。", "problem": "一位工程师正在评估一种新型半导体开关的可靠性。设 $p$ 为随机抽取一个开关时，该开关有缺陷的未知概率。根据制造模拟和类似组件的过往经验，该工程师对 $p$ 的先验信念由一个参数为 $\\alpha_0 = 4$ 和 $\\beta_0 = 4$ 的贝塔分布（Beta distribution）建模。\n\n为了更新这一信念，该工程师进行了一次小规模测试。随机抽取并测试了一个开关，发现它是有缺陷的。\n\n令 $\\mu_{prior}$ 表示先验分布的均值，$\\mu_{post}$ 表示 $p$ 的后验分布的均值，而 $m_{post}$ 表示 $p$ 的后验分布的中位数。下列哪个选项正确描述了这三个量之间的关系？\n\nA. $\\mu_{prior}  \\mu_{post}  m_{post}$\nB. $\\mu_{post}  m_{post}  \\mu_{prior}$\nC. $m_{post}  \\mu_{post}  \\mu_{prior}$\nD. $\\mu_{prior}  m_{post}  \\mu_{post}$\nE. $\\mu_{prior} = \\mu_{post} = m_{post}$", "solution": "我们用贝塔先验 $\\operatorname{Beta}(\\alpha_{0},\\beta_{0})$ 来为未知的缺陷概率 $p$ 建模，其中 $\\alpha_{0}=4$ 且 $\\beta_{0}=4$。先验均值为\n$$\n\\mu_{prior}=\\frac{\\alpha_{0}}{\\alpha_{0}+\\beta_{0}}=\\frac{4}{4+4}=\\frac{1}{2}.\n$$\n\n观测到一次伯努利试验（Bernoulli trial）的结果为“有缺陷”，即 $n=1$ 且 $x=1$。对于贝塔-二项分布（Beta-Binomial）模型，后验分布为\n$$\np \\mid \\text{data} \\sim \\operatorname{Beta}(\\alpha_{0}+x,\\ \\beta_{0}+n-x)=\\operatorname{Beta}(5,4).\n$$\n后验均值为\n$$\n\\mu_{post}=\\frac{\\alpha_{0}+x}{\\alpha_{0}+\\beta_{0}+n}=\\frac{5}{9}.\n$$\n比较先验均值和后验均值，\n$$\n\\mu_{post}-\\mu_{prior}=\\frac{5}{9}-\\frac{1}{2}=\\frac{10-9}{18}=\\frac{1}{18}>0,\n$$\n因此 $\\mu_{post}>\\mu_{prior}$。\n\n为了比较后验均值和中位数，注意到对于 $a,b>1$ 的 $\\operatorname{Beta}(a,b)$ 分布，该分布是单峰的，其众数为\n$$\n\\text{mode}=\\frac{a-1}{a+b-2}.\n$$\n对于 $a=5, b=4$，众数为\n$$\n\\text{mode}=\\frac{5-1}{5+4-2}=\\frac{4}{7}.\n$$\n比较众数和均值：\n$$\n\\frac{4}{7}-\\frac{5}{9}=\\frac{36-35}{63}=\\frac{1}{63}>0,\n$$\n因此众数大于均值。$\\operatorname{Beta}(a,b)$ 分布的偏度为\n$$\n\\gamma_{1}=\\frac{2(b-a)\\sqrt{a+b+1}}{(a+b+2)\\sqrt{ab}},\n$$\n其符号与 $b-a$ 的符号相同。这里 $b-a=4-5=-10$，所以偏度为负，分布是左偏的。对于左偏的单峰分布，通常有 均值  中位数  众数 的关系。因此，$\\mu_{post}  m_{post}$。结合我们已经得出的 $\\mu_{post} > \\mu_{prior}$，最终的关系是 $\\mu_{prior}  \\mu_{post}  m_{post}$。", "answer": "$$\\boxed{A}$$", "id": "1945414"}]}