{"hands_on_practices": [{"introduction": "本练习将引导你完成一个典型的贝叶斯区间估计问题。我们将为一个未知概率（在本例中是考试的单次通过率 $p$）构建一个可信区间。这个问题是练习贝叶斯推断核心流程的绝佳机会：结合代表新证据的似然函数和代表先验知识的先验分布，推导出后验分布，并最终从后验分布中提取一个区间来量化我们对参数的不确定性。通过这个练习[@problem_id:1899372]，你将看到共轭先验（如此处的Beta分布与几何分布/二项分布）如何简化计算，并获得对贝叶斯方法实际应用的直观理解。", "problem": "一项研究旨在评估一项专业认证考试的难度。考生首次通过考试所需的尝试次数 $K$ 服从几何分布模型。单个考生尝试 $k$ 次的概率质量函数为 $P(K=k|p) = (1-p)^{k-1}p$，其中 $p$ 是每次尝试通过的未知概率。\n\n在该研究中，收集了来自 $n=10$ 名独立考生的数据。所有10名考生为各自首次通过考试的总尝试次数为25。设此总次数为 $S = \\sum_{i=1}^{10} k_i = 25$。\n\n为了对参数 $p$ 进行贝叶斯分析，我们假设一个无信息先验分布，具体为区间 $[0,1]$ 上的均匀分布。\n\n您的任务是确定成功概率 $p$ 的95%等尾可信区间。报告此区间的下界和上界。将您的下界和上界答案四舍五入至四位有效数字。\n\n为帮助您进行最终计算，我们提供了具有整数参数 $\\alpha'$ 和 $\\beta'$ 的贝塔分布的几个分位数。分位数表示为 $Q(\\text{概率}; \\alpha', \\beta')$，其中 $Q(\\gamma; \\alpha', \\beta')$ 是满足累积概率 $P(\\text{Beta}(\\alpha', \\beta') \\le x) = \\gamma$ 的值 $x$。您必须首先通过推导确定后验分布的正确参数，然后使用下面列表中的相应值。\n\n*   $Q(0.025; 10, 15) = 0.2223$, $Q(0.975; 10, 15) = 0.5976$\n*   $Q(0.025; 10, 16) = 0.2144$, $Q(0.975; 10, 16) = 0.5760$\n*   $Q(0.025; 11, 15) = 0.2568$, $Q(0.975; 11, 15) = 0.6136$\n*   $Q(0.025; 11, 16) = 0.2486$, $Q(0.975; 11, 16) = 0.5745$", "solution": "我们将每个考生的尝试次数 $K_{i}$ 建模为参数为 $p$ 且支撑集为 $\\{1,2,\\ldots\\}$ 的几何分布，因此单个观测的似然函数为\n$$\nP(K_{i}=k_{i}\\mid p)=(1-p)^{k_{i}-1}p.\n$$\n对于具有观测值 $k_{1},\\ldots,k_{n}$ 的 $n$ 名独立考生，联合似然函数为\n$$\nL(p\\mid k_{1},\\ldots,k_{n})=\\prod_{i=1}^{n}(1-p)^{k_{i}-1}p\n=p^{n}(1-p)^{\\sum_{i=1}^{n}(k_{i}-1)}\n=p^{n}(1-p)^{S-n},\n$$\n其中 $S=\\sum_{i=1}^{n}k_{i}$ 是总尝试次数。\n\n给定 $[0,1]$ 上的均匀先验，即 $\\mathrm{Beta}(1,1)$，后验分布正比于\n$$\np^{n}(1-p)^{S-n}\\cdot p^{1-1}(1-p)^{1-1}=p^{n}(1-p)^{S-n}.\n$$\n识别出贝塔核，后验分布为\n$$\np\\mid \\text{data}\\sim \\mathrm{Beta}(n+1,\\,S-n+1).\n$$\n当 $n=10$ 且 $S=25$ 时，这给出\n$$\np\\mid \\text{data}\\sim \\mathrm{Beta}(11,16).\n$$\n一个 $0.95$ 的等尾可信区间由 $\\mathrm{Beta}(11,16)$ 的 $0.025$ 和 $0.975$ 分位数给出。根据提供的表格，\n$$\nQ(0.025;11,16)=0.2486,\\qquad Q(0.975;11,16)=0.5745.\n$$\n四舍五入到四位有效数字后得到相同的值。因此，$p$ 的 $0.95$ 等尾可信区间为 $\\left[0.2486,\\,0.5745\\right]$。", "answer": "$$\\boxed{\\begin{pmatrix}0.2486  0.5745\\end{pmatrix}}$$", "id": "1899372"}, {"introduction": "与处理连续参数（如概率 $p$）不同，当我们的目标参数是离散的时，比如一个骰子可能存在的面数 $N$，我们的推断方法也需要相应调整。此时，我们不再构建“可信区间”，而是构建一个“可信集”，即一个包含参数最可能取值的集合。这个练习[@problem_id:1899362]将向你展示如何为参数空间中的每一个可能值计算其后验概率，然后依据这些概率大小来构建一个具有特定置信水平的最小可信集。这清晰地揭示了贝叶斯定理在离散参数问题中的应用逻辑。", "problem": "一位桌游爱好者获得了一批定制的骰子。已知其中一个骰子的面数$N$来自集合$\\mathcal{S} = \\{4, 6, 8, 10, 12, 20\\}$。骰子的各个面标有从$1$到$N$的整数。由于缺乏关于该骰子来源的任何具体信息，这位爱好者假设$N$在集合$\\mathcal{S}$上服从一个离散均匀先验分布。\n\n为了探究$N$的值，该骰子被投掷了$k=5$次，并记录了结果。在这五次投掷中观察到的最大值为$M=8$。\n\n基于这一观察结果，请确定$N$的最小可能值集合，该集合的总后验概率至少为0.90。从以下选项中选择你的答案。\n\nA. $\\{8\\}$\n\nB. $\\{8, 10\\}$\n\nC. $\\{8, 10, 12\\}$\n\nD. $\\{10, 12, 20\\}$\n\nE. $\\{4, 6, 8, 10, 12, 20\\}$", "solution": "题目要求解骰子未知面数$N$的最小90%可信集。\n\n**1. 定义贝叶斯模型的组成部分：**\n\n*   **参数空间：** 面数$N$的可能值由集合$\\mathcal{S} = \\{4, 6, 8, 10, 12, 20\\}$给出。\n*   **先验分布：** 先验信念是$\\mathcal{S}$中的每个$N$值都是等可能的。由于有6个可能的值，每个值的先验概率为：\n    $$P(N=n) = \\pi(n) = \\frac{1}{6} \\quad \\text{for } n \\in \\mathcal{S}$$\n*   **数据：** 实验包含$k=5$次投掷，观察到的数据是最大投掷结果为$M=8$。\n*   **似然函数：** 似然$L(n | M=8)$是在给定参数特定值($N=n$)的情况下，观察到数据($M=8$)的概率。设$X_1, \\dots, X_5$为5次投掷的结果。每次投掷是独立的，并在$\\{1, \\dots, n\\}$上服从均匀分布。\n    单次投掷$X_i$的结果小于或等于$m$的概率是$P(X_i \\leq m | N=n) = m/n$。\n    5次投掷的最大值小于或等于$m$的概率，是所有5次投掷结果都小于或等于$m$的概率：\n    $$P(M \\leq m | N=n) = P(X_1 \\leq m, \\dots, X_5 \\leq m | N=n) = \\prod_{i=1}^{5} P(X_i \\leq m | N=n) = \\left(\\frac{m}{n}\\right)^5$$\n    最大投掷结果恰好为$m$的概率由下式给出：\n    $$P(M=m | N=n) = P(M \\leq m | N=n) - P(M \\leq m-1 | N=n)$$\n    代入$m=8$和$k=5$，我们的似然函数是：\n    $$L(n | M=8) = P(M=8 | N=n) = \\left(\\frac{8}{n}\\right)^5 - \\left(\\frac{7}{n}\\right)^5 = \\frac{8^5 - 7^5}{n^5}$$\n    这个似然仅在$n \\geq 8$时有定义。如果$n  8$，不可能掷出8，因此似然为0。\n\n**2. 计算后验分布：**\n\n根据贝叶斯定理，后验概率$P(N=n | M=8)$与似然和先验的乘积成正比：\n$$P(N=n | M=8) \\propto P(M=8 | N=n) \\times P(N=n)$$\n由于对于所有$n \\in \\mathcal{S}$，先验$P(N=n) = 1/6$是常数，因此后验直接与似然成正比：\n$$P(N=n | M=8) \\propto L(n | M=8)$$\n\n我们为$N$的每个可能值计算似然：\n\n*   对于$N=4$和$N=6$：不可能观察到最大值为8，所以$L(4 | M=8) = 0$且$L(6 | M=8) = 0$。这些值的后验概率也为0。\n*   对于$N \\in \\{8, 10, 12, 20\\}$，似然不为零。我们计算项$8^5 - 7^5 = 32768 - 16807 = 15961$。\n    似然值与$1/n^5$成正比：\n    *   $L(8 | M=8) = \\frac{15961}{8^5} = \\frac{15961}{32768} \\approx 0.48709$\n    *   $L(10 | M=8) = \\frac{15961}{10^5} = \\frac{15961}{100000} = 0.15961$\n    *   $L(12 | M=8) = \\frac{15961}{12^5} = \\frac{15961}{248832} \\approx 0.06414$\n    *   $L(20 | M=8) = \\frac{15961}{20^5} = \\frac{15961}{3200000} \\approx 0.00499$\n\n**3. 归一化后验分布：**\n\n为了找到实际的后验概率，我们必须进行归一化，使它们总和为1。设$K$为未归一化的后验值（与似然成比例）的总和。\n$$K = L(8) + L(10) + L(12) + L(20) \\approx 0.48709 + 0.15961 + 0.06414 + 0.00499 \\approx 0.71583$$\n现在我们计算归一化后的后验概率：\n*   $P(N=8 | M=8) = \\frac{L(8)}{K} \\approx \\frac{0.48709}{0.71583} \\approx 0.6804$\n*   $P(N=10 | M=8) = \\frac{L(10)}{K} \\approx \\frac{0.15961}{0.71583} \\approx 0.2230$\n*   $P(N=12 | M=8) = \\frac{L(12)}{K} \\approx \\frac{0.06414}{0.71583} \\approx 0.0896$\n*   $P(N=20 | M=8) = \\frac{L(20)}{K} \\approx \\frac{0.00499}{0.71583} \\approx 0.0070$\n\n这些概率的总和约为$0.6804 + 0.2230 + 0.0896 + 0.0070 = 1.0000$。\n\n**4. 构建可信集：**\n\n为了找到最小的90%可信集，我们将$N$的值按其后验概率（从高到低）排序，然后将它们逐个添加到我们的集合中，直到累积概率至少达到0.90。\n\n后验概率的顺序是：$P(N=8) > P(N=10) > P(N=12) > P(N=20)$。\n\n1.  从概率最高的值开始：集合为$\\{8\\}$。累积概率约为$0.6804$。这小于0.90。\n2.  添加下一个概率最高的值：集合现在为$\\{8, 10\\}$。累积概率约为$0.6804 + 0.2230 = 0.9034$。\n\n由于$0.9034 \\geq 0.90$，集合$\\{8, 10\\}$是一个90%可信集。因为我们是按照后验概率降序添加值的，所以这是最小的此类集合。任何其他包含两个值的集合的总概率都会更低。例如，集合$\\{8, 12\\}$的概率为$0.6804 + 0.0896 = 0.7700$。因此，$N$的最小90%可信集是$\\{8, 10\\}$。这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1899362"}, {"introduction": "在许多现代统计应用中，后验分布的形式可能非常复杂，难以进行解析求解。在这种情况下，基于模拟的方法，如马尔可夫链蒙特卡洛（MCMC），成为了标准工具。这个练习[@problem_id:1899401]模拟了这种常见情况，为你提供了一组从后验分布中抽取的样本。你的任务是利用这些样本来估计一个派生量——变异系数 $CV = \\sigma/\\mu$ 的可信区间。这个过程突显了模拟方法的巨大优势：一旦我们获得了模型参数的后验样本，就可以通过对样本进行简单变换，轻松得到任何关于这些参数的函数的后验信息。", "problem": "一位教育心理学家正在研究一项新认知评估测试的分数。这些分数被建模为服从正态分布 $N(\\mu, \\sigma^2)$，其中平均分数 $\\mu$ 和标准差 $\\sigma$ 都是未知的。在从一组参与者那里收集数据后，进行了一项贝叶斯分析来推断这些参数的值。该分析从 $(\\mu, \\sigma)$ 的联合后验分布中生成了一组模拟抽样。\n\n下表列出了来自该后验分布的20个代表性抽样。\n\n| 抽样 ($i$) | 均值 ($\\mu_i$) | 标准差 ($\\sigma_i$) |\n|:----------:|:--------------:|:----------------------:|\n|      1     |     104.5      |          17.1          |\n|      2     |     106.2      |          19.3          |\n|      3     |     103.1      |          15.8          |\n|      4     |     105.0      |          18.0          |\n|      5     |     107.8      |          20.2          |\n|      6     |     102.3      |          15.1          |\n|      7     |     108.4      |          21.5          |\n|      8     |     105.5      |          18.4          |\n|      9     |     104.1      |          16.9          |\n|     10     |     106.8      |          19.9          |\n|     11     |     109.2      |          22.1          |\n|     12     |     101.9      |          14.5          |\n|     13     |     107.3      |          20.6          |\n|     14     |     103.7      |          16.2          |\n|     15     |     105.9      |          18.8          |\n|     16     |     106.5      |          19.5          |\n|     17     |     102.8      |          15.5          |\n|     18     |     108.9      |          21.8          |\n|     19     |     104.8      |          17.5          |\n|     20     |     105.3      |          18.2          |\n\n该心理学家对变异系数感兴趣，其定义为 $CV = \\sigma/\\mu$，用作衡量分数相对变异性的指标。基于所提供的后验抽样，计算变异系数的90%等尾可信区间。将区间的下界和上界以数对形式呈现，并将您的最终答案四舍五入到三位有效数字。", "solution": "目标是利用所提供的从 $(\\mu, \\sigma)$ 的联合后验分布中抽取的20个样本，来计算变异系数 $CV = \\sigma/\\mu$ 的90%等尾可信区间。\n\n从后验模拟中获得参数函数的可信区间的基本原理是，将该函数应用于参数的每一次模拟抽样。这会生成一个来自函数本身后验分布的样本。然后，这个新样本的分位数可用于构建可信区间。\n\n第1步：计算20次抽样中每一次的变异系数。\n对于每次抽样 $i$，我们计算 $CV_i = \\sigma_i / \\mu_i$。\n\n1.  $CV_1 = 17.1 / 104.5 = 0.163636...$\n2.  $CV_2 = 19.3 / 106.2 = 0.181733...$\n3.  $CV_3 = 15.8 / 103.1 = 0.153249...$\n4.  $CV_4 = 18.0 / 105.0 = 0.171429...$\n5.  $CV_5 = 20.2 / 107.8 = 0.187384...$\n6.  $CV_6 = 15.1 / 102.3 = 0.147605...$\n7.  $CV_7 = 21.5 / 108.4 = 0.198340...$\n8.  $CV_8 = 18.4 / 105.5 = 0.174408...$\n9.  $CV_9 = 16.9 / 104.1 = 0.162344...$\n10. $CV_{10} = 19.9 / 106.8 = 0.186330...$\n11. $CV_{11} = 22.1 / 109.2 = 0.202381...$\n12. $CV_{12} = 14.5 / 101.9 = 0.142296...$\n13. $CV_{13} = 20.6 / 107.3 = 0.191985...$\n14. $CV_{14} = 16.2 / 103.7 = 0.156220...$\n15. $CV_{15} = 18.8 / 105.9 = 0.177526...$\n16. $CV_{16} = 19.5 / 106.5 = 0.183099...$\n17. $CV_{17} = 15.5 / 102.8 = 0.150778...$\n18. $CV_{18} = 21.8 / 108.9 = 0.200184...$\n19. $CV_{19} = 17.5 / 104.8 = 0.166985...$\n20. $CV_{20} = 18.2 / 105.3 = 0.172839...$\n\n第2步：将计算出的 $CV$ 值按升序排序。\n排序后的 $CV$ 值列表，记为 $CV_{(i)}$，如下所示：\n$CV_{(1)} = 0.142296...$\n$CV_{(2)} = 0.147605...$\n$CV_{(3)} = 0.150778...$\n$CV_{(4)} = 0.153249...$\n$CV_{(5)} = 0.156220...$\n$CV_{(6)} = 0.162344...$\n$CV_{(7)} = 0.163636...$\n$CV_{(8)} = 0.166985...$\n$CV_{(9)} = 0.171429...$\n$CV_{(10)} = 0.172839...$\n$CV_{(11)} = 0.174408...$\n$CV_{(12)} = 0.177526...$\n$CV_{(13)} = 0.181733...$\n$CV_{(14)} = 0.183099...$\n$CV_{(15)} = 0.186330...$\n$CV_{(16)} = 0.187384...$\n$CV_{(17)} = 0.191985...$\n$CV_{(18)} = 0.198340...$\n$CV_{(19)} = 0.200184...$\n$CV_{(20)} = 0.202381...$\n\n第3步：确定90%可信区间的下界和上界。\n一个90%等尾可信区间意味着我们想要找到包含后验概率质量中间90%的范围。这会在每个尾部留下5%的概率（因为 $(1 - 0.90) / 2 = 0.05$）。\n\n对于 $N=20$ 个样本，我们需要找出在排序列表的两端各需要排除多少个样本。\n每个尾部需要排除的样本数量 = $N \\times 0.05 = 20 \\times 0.05 = 1$。\n\n因此，我们从排序后的列表中排除一个最小值和一个最大值。那么，可信区间就由排序列表中的第2个值和第19个值界定。\n\n下界 = $CV_{(2)} = 0.147605...$\n上界 = $CV_{(19)} = 0.200184...$\n\n第4步：将结果四舍五入到三位有效数字。\n下界 $\\approx 0.148$\n上界 $\\approx 0.200$\n\n变异系数的90%等尾可信区间大约是 $(0.148, 0.200)$。题目要求将下界和上界以数对形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.148  0.200 \\end{pmatrix}}$$", "id": "1899401"}]}