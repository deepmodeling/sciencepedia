{"hands_on_practices": [{"introduction": "在我们计算具体的最高后验密度区间（HPDI）之前，首先必须理解其严格的数学定义。HPDI 不仅仅是任何一个包含特定概率的区间，而是其中最短的那一个。这个“最短”的特性对于单峰后验分布来说，意味着一个关键条件：区间端点处的后验概率密度必须相等。这个练习将帮助你巩固 HPDI 的核心理论，确保你理解在一般情况下定义 HPDI 的两个基本数学条件。[@problem_id:1921049]", "problem": "进行了一项贝叶斯统计分析，以估计一个未知的总体比例，该比例由参数 $p$ 表示，其中 $0  p  1$。在收集和分析数据后，得到的 $p$ 的后验分布被确定为参数 $\\alpha=3$ 和 $\\beta=9$ 的Beta分布。\n\n回顾一下，对于一个服从形状参数为 $\\alpha$ 和 $\\beta$ 的Beta分布（记作 $\\text{Beta}(\\alpha, \\beta)$）的参数 $p$，其概率密度函数 (PDF) 由以下公式给出：\n$$f(p | \\alpha, \\beta) = \\frac{p^{\\alpha-1}(1-p)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n对于 $0  p  1$。这里，$B(\\alpha, \\beta)$ 是Beta函数，它作为一个归一化常数。\n\n我们想要找到参数 $p$ 的95%最高后验密度区间 (HPDI)。一个95%的HPDI被定义为区间 $[L, U]$，该区间包含95%的后验概率质量，并且具有可能的最短长度。对于给定的这种单峰后验分布，这意味着下界 $L$ 和上界 $U$ 处的后验密度之间存在一种特定的关系。\n\n下列哪对方程组正确且完整地定义了后验分布 $\\text{Beta}(3, 9)$ 的95% HPDI的端点 $L$ 和 $U$？\n\nA. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ 且 $U - L = 0.95$\n\nB. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ 且 $L^2 (1-L)^8 = U^2 (1-U)^8$\n\nC. $\\int_0^L \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$ 且 $\\int_U^1 \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$\n\nD. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ 且 $L = 0.025$\n\nE. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ 且 $L=U$", "solution": "一个参数 $p$ 的 $100(1-\\alpha)\\%$ 最高后验密度区间 (HPDI) 是一个区间 $[L, U]$，它需要满足两个核心条件：\n1.  该区间包含的后验概率为 $1-\\alpha$：$\\int_L^U f(p|\\text{data}) \\, dp = 1-\\alpha$。\n2.  对于区间内的任意点 $p_{in}$ 和区间外的任意点 $p_{out}$，都有 $f(p_{in}|\\text{data}) \\ge f(p_{out}|\\text{data})$。对于连续且单峰的后验分布，这第二个条件等价于区间端点处的后验密度值相等：$f(L|\\text{data}) = f(U|\\text{data})$。\n\n在本题中，后验分布为 $\\text{Beta}(3,9)$，其概率密度函数 (PDF) 为 $f(p) = \\frac{p^2(1-p)^8}{B(3,9)}$。这是一个单峰分布。我们需要一个 95% 的 HPDI。\n\n将上述两个条件应用于本题：\n1.  概率条件：$\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$。\n2.  端点密度相等条件：$\\frac{L^2(1-L)^8}{B(3,9)} = \\frac{U^2(1-U)^8}{B(3,9)}$。这个等式可以简化为 $L^2(1-L)^8 = U^2(1-U)^8$。\n\n将这两个方程组合起来，我们得到的方程组与选项 B 完全匹配。\n\n- 选项 A 错误，因为它将区间长度与概率混淆了。\n- 选项 C 定义的是等尾区间 (ETI)，它要求两边尾部的概率相等，而不是端点密度相等。\n- 选项 D 和 E 提出了不正确的约束条件。", "answer": "$$\\boxed{B}$$", "id": "1921049"}, {"introduction": "理解了 HPDI 的定义之后，让我们将其应用于一个经典的统计问题。在本练习中，我们将处理一个正态分布模型，其后验分布也是正态的。由于正态分布是单峰且对称的，其 HPDI 与更易于计算的等尾可信区间是相同的。这个问题将引导你完成一个完整的贝叶斯分析流程——从设定先验和似然，到计算后验参数，最终得出 HPDI——让你在一个标准的工程应用场景中看到理论概念如何落地。[@problem_id:1921068]", "problem": "一个制造商生产高精度电阻器。已知这些元件的电阻呈正态分布，其均值为 $\\mu$，标准差为 $\\sigma = 10.0$ 欧姆，该标准差值是根据大量历史数据确定的。在测试新一批产品之前，一位工程师对平均电阻 $\\mu$ 的先验信念被建模为一个正态分布，其均值为 $\\mu_0 = 1000.0$ 欧姆，标准差为 $\\tau = 4.0$ 欧姆。\n\n从新批次中随机抽取 $n=25$ 个电阻器样本，测得其平均电阻为 $\\bar{x} = 998.5$ 欧姆。\n\n根据这个样本和工程师的先验信念，确定该批次真实平均电阻 $\\mu$（单位：欧姆）的 99% 最高密度区间。请给出该区间的下界和上界，并将最终答案四舍五入至四位有效数字。", "solution": "抽样模型的标准差 $\\sigma$ 已知，因此样本均值 $\\bar{X}$ 满足 $\\bar{X}\\mid\\mu\\sim\\mathcal{N}\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right)$。先验分布为 $\\mu\\sim\\mathcal{N}(\\mu_{0},\\tau^{2})$。根据正态-正态共轭性，后验分布为 $\\mu\\mid\\bar{x}\\sim\\mathcal{N}(m_{n},v_{n})$，其中\n$$\nv_{n}=\\left(\\frac{1}{\\tau^{2}}+\\frac{1}{\\sigma^{2}/n}\\right)^{-1},\\qquad\nm_{n}=v_{n}\\left(\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{\\bar{x}}{\\sigma^{2}/n}\\right).\n$$\n代入 $\\sigma=10.0$，$n=25$，$\\mu_{0}=1000.0$，$\\tau=4.0$ 和 $\\bar{x}=998.5$，我们得到 $\\sigma^{2}/n=\\frac{100}{25}=4$，因此\n$$\nv_{n}=\\left(\\frac{1}{16}+\\frac{1}{4}\\right)^{-1}=\\left(\\frac{1}{16}+\\frac{4}{16}\\right)^{-1}=\\left(\\frac{5}{16}\\right)^{-1}=\\frac{16}{5}=3.2,\\qquad \\sqrt{v_{n}}=\\frac{4}{\\sqrt{5}}.\n$$\n对于均值，\n$$\nm_{n}=v_{n}\\left(\\frac{1000.0}{16}+\\frac{998.5}{4}\\right)=\\frac{16}{5}\\left(62.5+249.625\\right)=\\frac{16}{5}\\cdot 312.125=\\frac{4994}{5}=998.8.\n$$\n由于后验分布是正态且对称的，99% 最高密度区间等于中心 99% 可信区间，\n$$\n\\left[m_{n}-z_{0.995}\\sqrt{v_{n}},\\;m_{n}+z_{0.995}\\sqrt{v_{n}}\\right],\n$$\n其中 $z_{0.995}$ 是标准正态分布的 $0.995$ 分位数。使用 $z_{0.995}\\approx 2.575829$，半宽度为\n$$\nz_{0.995}\\sqrt{v_{n}}\\approx 2.575829\\cdot\\frac{4}{\\sqrt{5}}\\approx 4.60778354.\n$$\n因此，99% 最高密度区间的界限为\n$$\n998.8-4.60778354\\approx 994.19221646,\\qquad 998.8+4.60778354\\approx 1003.40778354.\n$$\n将每个界限四舍五入到四位有效数字，得到 $994.2$ 和 $1003$。", "answer": "$$\\boxed{\\begin{pmatrix} 994.2  1003 \\end{pmatrix}}$$", "id": "1921068"}, {"introduction": "在许多现实世界的研究中，后验分布的形式非常复杂，无法进行解析计算。因此，我们通常使用马尔可夫链蒙特卡洛（MCMC）等计算方法从后验分布中生成大量样本。那么，我们如何从这一系列样本点中找到 HPDI 呢？这个练习将向你介绍从后验样本中估计 HPDI 的标准经验算法。掌握这项技术对于任何现代贝叶斯统计的实践者都至关重要，因为它连接了 HPDI 的理论定义与在复杂模型中的实际计算。[@problem_id:1921054]", "problem": "一位研究人员正在使用贝叶斯推断来研究参数 $\\theta$，该参数代表一种新学习算法的平均有效性。在运行马尔可夫链蒙特卡洛（MCMC）模拟后，她获得了从 $\\theta$ 的后验分布中抽取的大量样本 $\\{\\theta_1, \\theta_2, \\dots, \\theta_N\\}$。在她的分析中，她需要计算 95% 的最高后验密度区间（HPDI）。HPDI 被定义为包含 95% 后验概率质量的最短可能区间。\n\n给定她拥有的 $N$ 个后验样本集，以下哪种算法能正确估计 95% 的 HPDI？\n\nA.\n1. 将样本按升序排序，得到 $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$。\n2. 令 $k = \\lceil 0.95 \\times N \\rceil$。\n3. 考虑所有形式为 $[\\theta_{(i)}, \\theta_{(i+k-1)}]$ 的区间，其中 $i=1, \\dots, N-k+1$。\n4. 选择宽度 $\\theta_{(i+k-1)} - \\theta_{(i)}$ 最小的区间。\n\nB.\n1. 将样本按升序排序，得到 $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$。\n2. 计算下界索引 $l = \\lfloor 0.025 \\times N \\rfloor$ 和上界索引 $u = \\lceil 0.975 \\times N \\rceil$。\n3. 区间由 $[\\theta_{(l)}, \\theta_{(u)}]$ 给出。\n\nC.\n1. 计算样本均值 $\\bar{\\theta} = \\frac{1}{N} \\sum_{i=1}^N \\theta_i$ 和样本标准差 $s = \\sqrt{\\frac{1}{N-1} \\sum_{i=1}^N (\\theta_i - \\bar{\\theta})^2}$。\n2. 区间由 $[\\bar{\\theta} - 1.96 s, \\bar{\\theta} + 1.96 s]$ 给出。\n\nD.\n1. 对样本进行排序并找到中位数，$\\theta_{\\text{median}} = \\theta_{(\\lceil N/2 \\rceil)}$。\n2. 找到最小的值 $w$，使得区间 $[\\theta_{\\text{median}} - w, \\theta_{\\text{median}} + w]$ 恰好包含 95% 的样本。\n\nE.\n1. 估计样本的众数（出现频率最高的值），$\\theta_{\\text{mode}}$。\n2. 找到最小的值 $w$，使得区间 $[\\theta_{\\text{mode}} - w, \\theta_{\\text{mode}} + w]$ 恰好包含 95% 的样本。", "solution": "我们得到从 $\\theta$ 的后验分布中抽取的后验样本 $\\{\\theta_{1},\\dots,\\theta_{N}\\}$。根据定义，0.95 最高后验密度区间（HPDI）是包含 0.95 后验概率质量的最小宽度区间。对于一个连续的单峰后验密度 $p(\\theta\\mid\\text{data})$，HPDI 可以被描述为\n$$\nI^{\\ast}=\\arg\\min_{I:\\ \\int_{I} p(\\theta\\mid\\text{data})\\,d\\theta=0.95}\\ \\text{length}(I),\n$$\n并且 HPDI 由所有密度超过某个阈值的点组成，该阈值的选择使得其内部的质量等于 0.95。对于后验样本，我们通过找到包含 0.95 比例样本的最短区间来近似这个值。\n\n要从样本中实现这一点，请按以下步骤操作。\n\n1. 对样本进行排序以获得顺序统计量 $\\{\\theta_{(1)},\\dots,\\theta_{(N)}\\}$。\n\n2. 令 $k=\\lceil 0.95 N\\rceil$。任何包含至少 0.95 后验质量的区间，在样本的经验分布下，都应包含至少 $k$ 个样本。在所有这些经验区间中，最短的候选区间恰好是那些其端点是跨越恰好 $k$ 个样本的相邻顺序统计量，即形式为 $[\\theta_{(i)},\\theta_{(i+k-1)}]$ 的区间，其中 $i=1,\\dots,N-k+1$。\n\n3. 对每个 $i$，计算宽度\n$$\nw_{i}=\\theta_{(i+k-1)}-\\theta_{(i)}.\n$$\n选择具有最小 $w_{i}$ 的区间。这个区间是包含至少 0.95 样本的经验最短区间，是 0.95 HPDI 的标准基于样本的估计量。\n\n这个过程正是算法 A。\n\n现在我们来验证为什么其他选项通常不会产生 HPDI。\n\n- 选项 B 使用 0.025 和 0.975 处的经验分位数构造等尾区间。这会产生一个中心或等尾可信区间，但当后验分布不对称或多峰时，不能保证它是覆盖 0.95 概率的最短区间。因此，它通常不是 HPDI。\n\n- 选项 C 使用 $\\bar{\\theta}\\pm 1.96\\,s$，它假设近似正态性，并构造一个以均值为中心的对称区间。这是一个正态近似可信区间，通常不是 HPDI，特别是对于非正态或偏态的后验分布。\n\n- 选项 D 将区间中心定于中位数并强制对称。HPDI 不必是对称的，也不必以中位数为中心；强制对称可能会产生比必要更宽的区间，因此这不是通用的 HPDI。\n\n- 选项 E 将区间中心定于众数并强制对称。虽然对于单峰后验分布，HPDI 通常包含众数，但除非后验分布本身是对称的，否则它不一定是对称的。强制对称同样会使区间的宽度次优，因此这不是通用的 HPDI。\n\n因此，通常只有算法 A 能从后验样本中正确估计 0.95 HPDI。", "answer": "$$\\boxed{A}$$", "id": "1921054"}]}