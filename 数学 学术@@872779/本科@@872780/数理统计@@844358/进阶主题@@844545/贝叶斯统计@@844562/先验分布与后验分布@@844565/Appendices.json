{"hands_on_practices": [{"introduction": "在贝叶斯推断中，共轭先验是一个核心概念，它极大地简化了后验分布的计算。本练习将通过经典的 Beta-二项模型，带你实践贝叶斯更新的基本流程。我们将从一个无信息先验（均匀分布）开始，探索需要多少连续的成功观测数据，才能让我们的后验信念达到一个特定的可信度水平 [@problem_id:1946628]。", "problem": "一家材料科学公司开发了一种全新的实验性光纤制造工艺。关键的质量指标是制造出的光纤中满足严格信号传输标准的比例 $p$。由于该工艺是全新的，工程团队对其有效性没有任何先验知识。他们决定使用区间 $[0, 1]$ 上的连续均匀分布来为其对 $p$ 的初始信念建模，这等同于参数为 $\\alpha=1$ 和 $\\beta=1$ 的贝塔分布。\n\n为了更新他们的信念，他们测试了一系列新制造的光纤。他们发现，所测试的前 $n$ 根光纤全部满足传输标准。为了使比例 $p$ 的后验均值超过 $0.98$，需要的最少连续成功测试次数的整数值 $n$ 是多少？", "solution": "成功比例的先验分布为 $p \\sim \\mathrm{Beta}(\\alpha,\\beta)$，其中 $\\alpha=1$ 且 $\\beta=1$。在贝塔-二项共轭模型下，观测到 $S$ 次成功和 $F$ 次失败后，后验分布为 $\\mathrm{Beta}(\\alpha+S,\\beta+F)$。在此问题中，前 $n$ 次测试均为成功，因此 $S=n$ 且 $F=0$，得到后验分布\n$$\np \\mid \\text{data} \\sim \\mathrm{Beta}(1+n,1).\n$$\n一个 $\\mathrm{Beta}(a,b)$ 分布的均值为 $\\frac{a}{a+b}$，因此后验均值为\n$$\n\\mathbb{E}[p \\mid \\text{data}] = \\frac{n+1}{n+2}.\n$$\n我们需要求得最小的整数 $n$，使得\n$$\n\\frac{n+1}{n+2} > 0.98.\n$$\n由于对于所有整数 $n \\geq 0$，都有 $n+2>0$，我们可以将不等式两边同时乘以 $n+2$ 而不改变不等号的方向：\n$$\nn+1 > 0.98(n+2).\n$$\n展开并整理，\n$$\nn+1 > 0.98n + 1.96 \\quad \\Rightarrow \\quad n - 0.98n > 1.96 - 1 \\quad \\Rightarrow \\quad 0.02\\,n > 0.96.\n$$\n两边同时除以 $0.02$（正数），得到\n$$\nn > 48.\n$$\n因此，满足此严格不等式的最小整数 $n$ 是 $n=49$。注意，当 $n=48$ 时，均值为 $\\frac{49}{50}=0.98$，并未超过 $0.98$，这证实了需要 $n=49$。", "answer": "$$\\boxed{49}$$", "id": "1946628"}, {"introduction": "掌握了比例参数的推断后，我们转向另一个常见场景：对速率或寿命参数的估计。本练习介绍指数分布似然和 Gamma 先验这对共轭分布 [@problem_id:1946583]。你将运用贝叶斯定理，结合先验知识与单次观测数据，推导出后验分布并计算其众数，即最大后验估计 (MAP)，从而更新对设备失效率的认识。", "problem": "一个工程团队正在测试一种新型实验性发光二极管 (LED) 的寿命。单个 LED 的寿命 $X$（以千小时为单位）由一个指数分布建模，其未知速率参数为 $\\lambda > 0$。在给定参数 $\\lambda$ 的条件下，寿命 $X$ 的概率密度函数 (PDF) 为：\n$$f(x|\\lambda) = \\lambda \\exp(-\\lambda x) \\quad \\text{for } x \\ge 0$$\n根据以往类似技术的经验，该团队对速率参数 $\\lambda$ 的先验信念由一个伽马分布描述，其形状参数为 $\\alpha = 2$，速率参数为 $\\beta = 3$。这个先验分布的概率密度函数与以下表达式成正比：\n$$p(\\lambda) \\propto \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\quad \\text{for } \\lambda > 0$$\n选取一个LED进行测试，观测到其寿命为 $x = 5$ 千小时。确定在给定此观测值的情况下 $\\lambda$ 的后验分布的众数。请用精确值表示你的答案。", "solution": "问题要求解参数 $\\lambda$ 的后验分布的众数。我们可以使用连续参数的贝叶斯定理来找到后验分布。该定理指出，后验概率密度与似然函数和先验概率密度的乘积成正比。\n\n后验概率密度函数由下式给出：\n$$p(\\lambda | x) \\propto f(x | \\lambda) p(\\lambda)$$\n\n我们已知似然函数，即对于单个观测值 $x=5$ 的指数分布的概率密度函数：\n$$f(x=5 | \\lambda) = \\lambda \\exp(-5\\lambda)$$\n\n我们还已知 $\\lambda$ 的先验分布是一个伽马分布，其形状参数为 $\\alpha=2$，速率参数为 $\\beta=3$。先验概率密度函数与以下表达式成正比：\n$$p(\\lambda) \\propto \\lambda^{\\alpha-1} \\exp(-\\beta\\lambda) = \\lambda^{2-1} \\exp(-3\\lambda) = \\lambda^{1} \\exp(-3\\lambda)$$\n\n现在，我们将似然函数与先验分布相乘以找到未归一化的后验分布：\n$$p(\\lambda | x=5) \\propto \\left( \\lambda \\exp(-5\\lambda) \\right) \\cdot \\left( \\lambda^{1} \\exp(-3\\lambda) \\right)$$\n合并含 $\\lambda$ 的项：\n$$p(\\lambda | x=5) \\propto \\lambda^{1+1} \\exp(-5\\lambda - 3\\lambda)$$\n$$p(\\lambda | x=5) \\propto \\lambda^{2} \\exp(-8\\lambda)$$\n\n这个表达式是一个伽马分布的核。一个形状参数为 $\\alpha_{\\text{post}}$、速率参数为 $\\beta_{\\text{post}}$ 的伽马分布，其概率密度函数与 $\\lambda^{\\alpha_{\\text{post}}-1} \\exp(-\\beta_{\\text{post}}\\lambda)$ 成正比。通过将此形式与我们的结果进行比较，我们可以确定后验分布的参数：\n$$\\alpha_{\\text{post}} - 1 = 2 \\implies \\alpha_{\\text{post}} = 3$$\n$$\\beta_{\\text{post}} = 8$$\n所以，$\\lambda$ 的后验分布是一个伽马分布，即 $\\lambda | (x=5) \\sim \\text{Gamma}(3, 8)$。\n\n分布的众数是使其概率密度函数达到最大值的那个值。为了找到后验分布的众数，我们需要找到使 $p(\\lambda|x=5)$ 最大化的 $\\lambda$ 值。通常最大化概率密度函数的自然对数会更容易。令 $L(\\lambda) = \\ln(p(\\lambda|x=5))$。\n$$L(\\lambda) = \\ln(C \\lambda^{2} \\exp(-8\\lambda)) = \\ln(C) + 2\\ln(\\lambda) - 8\\lambda$$\n其中 $C$ 是归一化常数。\n\n为了找到最大值，我们将 $L(\\lambda)$ 对 $\\lambda$ 求导，并将其设为零：\n$$\\frac{d L(\\lambda)}{d \\lambda} = \\frac{2}{\\lambda} - 8$$\n将导数设为零以找到临界点：\n$$\\frac{2}{\\lambda} - 8 = 0 \\implies \\frac{2}{\\lambda} = 8 \\implies \\lambda = \\frac{2}{8} = \\frac{1}{4}$$\n\n为了确认这个临界点是一个最大值点，我们可以检查二阶导数：\n$$\\frac{d^2 L(\\lambda)}{d \\lambda^2} = -\\frac{2}{\\lambda^2}$$\n由于 $\\lambda$ 必须为正，二阶导数恒为负。这证实了 $\\lambda = 1/4$ 是一个局部最大值点。由于这是定义域 $\\lambda > 0$ 内唯一的临界点，因此它就是全局最大值点，也就是后验分布的众数。\n\n另外，对于 $\\alpha > 1$ 的情况，Gamma($\\alpha, \\beta$) 分布的众数由公式 $\\frac{\\alpha-1}{\\beta}$ 给出。我们的后验分布是 Gamma(3, 8)。因为 $\\alpha_{\\text{post}} = 3 > 1$，我们可以使用这个公式：\n$$\\text{Mode} = \\frac{\\alpha_{\\text{post}} - 1}{\\beta_{\\text{post}}} = \\frac{3-1}{8} = \\frac{2}{8} = \\frac{1}{4}$$\n两种方法得出了相同的结果。$\\lambda$ 的后验分布的众数是 $1/4$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1946583"}, {"introduction": "贝叶斯分析的威力在于其灵活性，但这也带来了选择先验的责任。不同的先验代表了不同的初始假设，并可能影响最终的推断结果。这个练习将让你直接比较两种不同先验（一个是标准指数先验，另一个是常用的无信息不当先验）对泊松分布率参数推断的影响 [@problem_id:1946616]。通过计算并比较两种模型下的后验众数，你将深刻理解先验选择在实践中的重要性。", "problem": "一位数字营销分析师正在对每小时点击特定广告链接的用户数量进行建模。点击次数 $X$ 被假定服从一个平均率为未知值 $\\lambda$ 的泊松分布。为了估计这个率，分析师在 $n$ 个独立同分布（i.i.d.）的一小时区间内收集数据，记录了点击次数 $x_1, x_2, \\dots, x_n$。\n\n提出了两种不同的贝叶斯模型来推断 $\\lambda$ 的值。每个模型中对 $\\lambda$ 的估计值取为后验分布的众数，也称为最大后验（MAP）估计。\n\n- **模型 A** 对率使用标准的指数先验分布：$p_A(\\lambda) = \\exp(-\\lambda)$，对于 $\\lambda > 0$。令其后验众数记为 $\\hat{\\lambda}_A$。\n- **模型 B** 使用一个常见的无信息不当先验，即泊松率的 Jeffreys 先验：$p_B(\\lambda) \\propto \\frac{1}{\\sqrt{\\lambda}}$，对于 $\\lambda > 0$。令其后验众数记为 $\\hat{\\lambda}_B$。\n\n你的任务是计算这两个估计量之间的差值，$\\hat{\\lambda}_A - \\hat{\\lambda}_B$。用区间数 $n$ 和样本均值 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$ 的解析表达式来表示你的答案。", "solution": "设 $X_{1},\\dots,X_{n}$ 在给定 $\\lambda$ 的条件下独立同分布，且 $X_{i}\\mid\\lambda\\sim\\text{Poisson}(\\lambda)$。记 $S=\\sum_{i=1}^{n}x_{i}=n\\bar{x}$。似然函数为\n$$\nL(\\lambda\\mid x_{1:n})=\\prod_{i=1}^{n}\\frac{\\exp(-\\lambda)\\lambda^{x_{i}}}{x_{i}!}\\propto \\exp(-n\\lambda)\\lambda^{S}.\n$$\n其对数，在相差一个加性常数的情况下，为\n$$\n\\ell(\\lambda)=-n\\lambda+S\\ln\\lambda.\n$$\n\n模型 A 使用 $p_{A}(\\lambda)=\\exp(-\\lambda)$，对于 $\\lambda>0$。后验分布（在相差一个乘性常数的情况下）为\n$$\np(\\lambda\\mid x_{1:n},A)\\propto \\exp(-n\\lambda)\\lambda^{S}\\cdot \\exp(-\\lambda)=\\exp(-(n+1)\\lambda)\\lambda^{S},\n$$\n其对数后验为\n$$\n\\ell_{A}(\\lambda)=-(n+1)\\lambda+S\\ln\\lambda.\n$$\n求导并设为零：\n$$\n\\frac{d\\ell_{A}}{d\\lambda}=-(n+1)+\\frac{S}{\\lambda}=0\\quad\\Longrightarrow\\quad \\hat{\\lambda}_{A}=\\frac{S}{n+1}.\n$$\n对于 $S>0$，二阶导数 $-\\frac{S}{\\lambda^{2}} < 0$ 确认了在内部存在一个众数；对于 $S=0$，众数位于边界 $\\lambda=0$。\n\n模型 B 使用 $p_{B}(\\lambda)\\propto \\lambda^{-1/2}$，对于 $\\lambda>0$。后验分布（在相差一个乘性常数的情况下）为\n$$\np(\\lambda\\mid x_{1:n},B)\\propto \\exp(-n\\lambda)\\lambda^{S}\\cdot \\lambda^{-1/2}=\\exp(-n\\lambda)\\lambda^{S-\\frac{1}{2}},\n$$\n其对数后验为\n$$\n\\ell_{B}(\\lambda)=-n\\lambda+\\left(S-\\frac{1}{2}\\right)\\ln\\lambda.\n$$\n求导并设为零：\n$$\n\\frac{d\\ell_{B}}{d\\lambda}=-n+\\frac{S-\\frac{1}{2}}{\\lambda}=0\\quad\\Longrightarrow\\quad \\hat{\\lambda}_{B}=\\frac{S-\\frac{1}{2}}{n}.\n$$\n对于 $S\\geq 1$，这是一个内部众数；对于 $S=0$，众数位于边界 $\\lambda=0$。\n\n对于 $S\\geq 1$（即至少观察到一次点击的典型情况），差值为\n$$\n\\hat{\\lambda}_{A}-\\hat{\\lambda}_{B}=\\frac{S}{n+1}-\\frac{S-\\frac{1}{2}}{n}.\n$$\n代入 $S=n\\bar{x}$ 并化简：\n$$\n\\hat{\\lambda}_{A}-\\hat{\\lambda}_{B}=\\frac{n\\bar{x}}{n+1}-\\left(\\bar{x}-\\frac{1}{2n}\\right)\n=-\\frac{\\bar{x}}{n+1}+\\frac{1}{2n}.\n$$\n因此，用 $n$ 和 $\\bar{x}$ 表示，\n$$\n\\hat{\\lambda}_{A}-\\hat{\\lambda}_{B}=\\frac{1}{2n}-\\frac{\\bar{x}}{n+1}.\n$$\n（如果 $S=0$，两个众数都在 $0$ 处，差值为 $0$；上述表达式在 $S\\geq 1$ 时适用。）", "answer": "$$\\boxed{\\frac{1}{2n}-\\frac{\\bar{x}}{n+1}}$$", "id": "1946616"}]}