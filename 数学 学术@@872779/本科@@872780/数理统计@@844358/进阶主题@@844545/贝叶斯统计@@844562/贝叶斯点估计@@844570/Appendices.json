{"hands_on_practices": [{"introduction": "贝叶斯估计的核心思想是将先验信念与观测数据相结合。本练习旨在揭示，特别是在数据稀少时，不同的初始假设（即先验分布）会如何导致不同的结论。通过对比“无信息”先验与“怀疑性”先验，我们将亲身体验先验信念对最终估计产生的显著影响 ([@problem_id:1899686])。", "problem": "一个材料科学实验室正在为一项高频应用开发一种新型半导体。一个关键的制造步骤有一定的成功概率 $p$。由于资源限制，只能进行一次生产该半导体的尝试。这次尝试成功了。\n\n两名统计学家，一位乐观主义者和一位怀疑论者，受命根据这一次成功的观测结果来估计 $p$。他们都同意将这次尝试的结果建模为伯努利试验，并使用贝叶斯框架。他们的分歧在于对成功概率 $p$ 的先验信念。\n\n乐观主义者对实验室的综合能力有信心，他为 $p$ 假设了一个“无信息”先验，这是一个参数为 $\\alpha_O = 1$ 和 $\\beta_O = 1$ 的贝塔分布。这个先验表示对 $p$ 在0和1之间的所有可能值持有均匀的信念。\n\n怀疑论者意识到开发新材料时常见的高失败率，他为 $p$ 假设了一个“怀疑”先验，这是一个参数为 $\\alpha_S = 1$ 和 $\\beta_S = 5$ 的贝塔分布。这个先验表达了一种信念，即 $p$ 的值较小的可能性更大。\n\n在观察到单次成功试验后，两位统计学家都更新了他们的信念，并计算了他们各自对成功概率 $p$ 的后验期望值。怀疑论者的后验期望值与乐观主义者的后验期望值之间的绝对差是多少？请将你的答案表示为最简精确分数。", "solution": "将结果 $X$ 建模为成功概率为 $p$ 的伯努利试验。对于贝塔先验 $\\operatorname{Beta}(\\alpha,\\beta)$，在观察到 $s$ 次成功和 $f$ 次失败后，根据共轭性，后验分布为 $\\operatorname{Beta}(\\alpha+s,\\beta+f)$。$\\operatorname{Beta}(a,b)$ 分布的后验期望值为 $a/(a+b)$。\n\n进行了一次尝试且成功，所以 $s=1$ 且 $f=0$。\n\n对于乐观主义者：先验为 $\\operatorname{Beta}(\\alpha_{O},\\beta_{O})$，其中 $\\alpha_{O}=1$, $\\beta_{O}=1$。后验分布为\n$$\n\\operatorname{Beta}(\\alpha_{O}+s,\\beta_{O}+f)=\\operatorname{Beta}(2,1),\n$$\n所以后验期望值为\n$$\n\\mathbb{E}_{O}[p]=\\frac{2}{2+1}=\\frac{2}{3}.\n$$\n\n对于怀疑论者：先验为 $\\operatorname{Beta}(\\alpha_{S},\\beta_{S})$，其中 $\\alpha_{S}=1$, $\\beta_{S}=5$。后验分布为\n$$\n\\operatorname{Beta}(\\alpha_{S}+s,\\beta_{S}+f)=\\operatorname{Beta}(2,5),\n$$\n所以后验期望值为\n$$\n\\mathbb{E}_{S}[p]=\\frac{2}{2+5}=\\frac{2}{7}.\n$$\n\n怀疑论者和乐观主义者的后验期望值之间的绝对差为\n$$\n\\left|\\mathbb{E}_{S}[p]-\\mathbb{E}_{O}[p]\\right|=\\left|\\frac{2}{7}-\\frac{2}{3}\\right|=\\left|\\frac{6-14}{21}\\right|=\\frac{8}{21}.\n$$", "answer": "$$\\boxed{\\frac{8}{21}}$$", "id": "1899686"}, {"introduction": "统计建模的一个关键目标不仅是估计未知参数，更是对未来事件做出预测。本练习将演示如何利用参数的后验分布来计算未来实验的期望结果 ([@problem_id:1899633])。这构成了从更新信念到做出实际预测之间的桥梁，是贝叶斯方法强大实用性的体现。", "problem": "一家材料科学公司正在开发一种新型光伏电池。目前的生产工艺不稳定，每块生产出的电池满足高效标准的概率 $p$ 是一个未知但恒定的值。工程团队在没有任何初步数据的情况下，假设 $p$ 在0和1之间的任何值都是等可能的。\n\n在一次试生产中，制造了一批共 $n$ 块电池，经过测试，发现其中有 $k$ 块满足高效标准。该公司现在计划开始进行更大规模的生产，制造 $m$ 块新电池。\n\n使用贝叶斯方法，在这批新的 $m$ 块电池中，高效电池的期望数量是多少？请用 $n$、$k$ 和 $m$ 推导出该数量的符号表达式。", "solution": "设 $p$ 为生产的电池满足高效标准的未知概率。问题陈述，关于 $p$ 的先验信念是它在0和1之间取任何值的可能性是均等的。这对应于区间 $[0, 1]$ 上的均匀先验分布。该先验分布的概率密度函数（PDF）为：\n$$ \\pi(p) = 1, \\quad \\text{for } 0 \\le p \\le 1 $$\n这是贝塔分布的一个特例，具体来说是 $\\text{Beta}(\\alpha=1, \\beta=1)$。\n\n在试生产中，生产了 $n$ 块电池，这可以被建模为 $n$ 次独立的伯努利试验。设 $X$ 为观测到的高效电池数量的随机变量。观测结果为 $X=k$。在给定概率 $p$ 的情况下，在 $n$ 次试验中观测到 $k$ 次成功的概率服从二项分布。似然函数为：\n$$ L(p|X=k) = P(X=k|p) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n\n为了在观测到数据后更新我们对 $p$ 的信念，我们使用贝叶斯定理来找到 $p$ 的后验分布。后验概率密度函数 $\\pi(p|X=k)$ 正比于先验和似然的乘积：\n$$ \\pi(p|X=k) \\propto L(p|X=k) \\cdot \\pi(p) $$\n$$ \\pi(p|X=k) \\propto \\left( \\binom{n}{k} p^k (1-p)^{n-k} \\right) \\cdot 1 $$\n由于 $\\binom{n}{k}$ 是一个关于 $p$ 的常数，我们可以写成：\n$$ \\pi(p|X=k) \\propto p^k (1-p)^{n-k} $$\n这个表达式是贝塔分布的核。一个通用的贝塔分布 $\\text{Beta}(\\alpha, \\beta)$ 的概率密度函数正比于 $p^{\\alpha-1}(1-p)^{\\beta-1}$。通过比较指数，我们可以确定我们的后验分布的参数：\n$$ \\alpha - 1 = k \\implies \\alpha = k+1 $$\n$$ \\beta - 1 = n-k \\implies \\beta = n-k+1 $$\n因此，在给定数据 $X=k$ 的条件下，$p$ 的后验分布是参数为 $\\alpha=k+1$ 和 $\\beta=n-k+1$ 的贝塔分布：\n$$ p | (X=k) \\sim \\text{Beta}(k+1, n-k+1) $$\n\n问题要求在未来一批 $m$ 次试验中高效电池的期望数量。设 $Y$ 为这 $m$ 次未来试验中成功次数的随机变量。给定 $p$ 的值，$Y$ 服从二项分布，$Y|p \\sim \\text{Binomial}(m, p)$。给定 $p$ 时，$Y$ 的期望是 $E[Y|p] = mp$。\n\n我们需要找到 $Y$ 的贝叶斯预测期望，即 $Y$ 的期望在 $p$ 的后验分布下的平均值。这被记为 $E[Y|X=k]$。我们使用全期望定律：\n$$ E[Y|X=k] = E_{p|k}[E[Y|p]] $$\n其中外层期望是关于 $p$ 的后验分布计算的。\n代入 $E[Y|p] = mp$，我们得到：\n$$ E[Y|X=k] = E_{p|k}[mp] = m \\cdot E_{p|k}[p] $$\n项 $E_{p|k}[p]$ 是 $p$ 的后验分布的均值。一个 $\\text{Beta}(\\alpha, \\beta)$ 分布的均值由公式 $\\frac{\\alpha}{\\alpha+\\beta}$ 给出。\n对于我们的后验分布 $\\text{Beta}(k+1, n-k+1)$，其均值为：\n$$ E_{p|k}[p] = \\frac{k+1}{(k+1) + (n-k+1)} = \\frac{k+1}{n+2} $$\n这是对概率 $p$ 的更新估计。\n\n最后，在接下来的 $m$ 次试验中，成功次数的期望值为：\n$$ E[Y|X=k] = m \\cdot \\frac{k+1}{n+2} $$\n该表达式代表了在平方误差损失函数下，高效电池数量的贝叶斯估计。", "answer": "$$\\boxed{m \\frac{k+1}{n+2}}$$", "id": "1899633"}, {"introduction": "科学知识的建立很少依赖于单次实验，它会随着新证据的出现而不断演进。本练习将阐释贝叶斯推断的一个强大特性：序贯更新（sequential updating），即一次分析得出的后验分布可以作为下一次分析的先验分布。你将练习如何整合新的实验数据，以持续优化对参数的估计 ([@problem_id:1899661])。", "problem": "一家软件公司正在测试一个新的用户界面功能。成功与此功能互动的用户比例是一个未知参数 $p$。一位数据科学家使用贝叶斯方法来模拟 $p$ 的不确定性。\n\n最初，经过一项初步研究，数据科学家对 $p$ 的信念由一个贝塔后验分布描述，其参数为 $\\alpha_1 = 29$ 和 $\\beta_1 = 121$。\n\n为了收集更多证据，该公司进行了第二次独立的实验，将该功能展示给一个由 $n_2 = 500$ 名新用户组成的群体。在这个第二组中，观察到有 $k_2 = 110$ 名用户成功与该功能互动。\n\n假设第二次实验中成功互动的次数服从二项分布，计算在结合了第二次实验的结果后，$p$ 的更新后验均值。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $p$ 表示成功概率。初步研究后的初始信念被建模为一个贝塔分布，其参数为 $\\alpha_{1}=29$ 和 $\\beta_{1}=121$。第二次实验在 $n_{2}=500$ 次试验中产生了 $k_{2}=110$ 次成功，建模为 $k_{2} \\sim \\mathrm{Binomial}(n_{2},p)$。\n\n根据贝塔-二项共轭性，用二项数据 $(n_{2},k_{2})$ 更新一个 $\\mathrm{Beta}(\\alpha_{1},\\beta_{1})$ 先验分布会得到一个后验分布 $\\mathrm{Beta}(\\alpha',\\beta')$，其参数为\n$$\n\\alpha'=\\alpha_{1}+k_{2}, \\quad \\beta'=\\beta_{1}+n_{2}-k_{2}.\n$$\n代入给定值，\n$$\n\\alpha'=29+110=139, \\quad \\beta'=121+(500-110)=121+390=511.\n$$\n在 $\\mathrm{Beta}(\\alpha',\\beta')$ 分布下，$p$ 的后验均值为\n$$\n\\mathbb{E}[p \\mid \\text{data}]=\\frac{\\alpha'}{\\alpha'+\\beta'}=\\frac{139}{139+511}=\\frac{139}{650}.\n$$\n保留四位有效数字的小数近似值为\n$$\n\\frac{139}{650}=0.213846\\ldots \\approx 0.2138.\n$$", "answer": "$$\\boxed{0.2138}$$", "id": "1899661"}]}