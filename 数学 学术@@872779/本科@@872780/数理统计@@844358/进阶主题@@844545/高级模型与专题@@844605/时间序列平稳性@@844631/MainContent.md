## 引言
在探索依时间顺序收集的数据时，[时间序列分析](@entry_id:178930)提供了一套强大的工具。然而，要释放这些工具的全部潜力，一个基本前提常常必须满足，那就是**[平稳性](@entry_id:143776)**。现实世界中的大多数时间序列数据，从经济指标到自然现象，都充满了趋势、季节性或变化的波动，这些非平稳特征使得直接建模变得困难重重，并可能导致错误的推断。本文旨在解决这一核心问题，为读者系统地构建关于时间序列[平稳性](@entry_id:143776)的完整知识体系。

本文将引导您穿越理论的深处和应用的广度。在“原理与机制”一章中，我们将精确定义什么是[弱平稳性](@entry_id:171204)，并探讨其数学属性。接着，在“应用与跨学科联系”一章中，我们将学习如何通过差分、[对数变换](@entry_id:267035)等实用技术将[非平稳数据](@entry_id:261489)“驯服”为平稳数据，并了解[平稳性](@entry_id:143776)是如何成为ARIMA、VAR等重要模型的基石。最后，“动手实践”部分将提供具体练习，以巩固您对这些核心概念的理解。通过本次学习，您将掌握识别、处理和利用平稳性来构建可靠时间序列模型的关键技能。

## 原理与机制

在[时间序列分析](@entry_id:178930)中，一个核心的假设是**平稳性 (stationarity)**。[平稳性](@entry_id:143776)极大地简化了[随机过程](@entry_id:159502)的统计特性，使其不随时间的推移而改变。这种稳定性是构建可靠模型和进行有效预测的基石。本章将深入探讨平稳性的核心概念，特别是**[弱平稳性](@entry_id:171204) (weak stationarity)** 的定义、其背后的数学原理，以及它与更强的**[严平稳性](@entry_id:260987) (strict stationarity)** 之间的区别。

### [弱平稳性](@entry_id:171204)的定义

一个时间序列过程 $\{X_t\}$ 被称为**弱平稳**（或协[方差](@entry_id:200758)平稳），如果它对所有整数时间点 $t$ 和时间差 $h$ 满足以下三个条件。这三个条件构成了[弱平稳性](@entry_id:171204)的三大支柱：不变的均值、有限且不变的[方差](@entry_id:200758)，以及仅依赖于时间差的[自协方差](@entry_id:270483)。

#### 不变的均值

第一个条件要求过程的[期望值](@entry_id:153208)是一个与时间无关的常数。

$$
E[X_t] = \mu
$$

其中 $\mu$ 是一个有限常数。这意味着无论我们在时间轴的哪个位置观察序列，其长期平均水平都是相同的。

最简单的例子是一个确定性的常数过程。假设一个过程对所有时间 $t$ 都取同一个值 $Z_t = \alpha$，其中 $\alpha$ 是一个实数常数。它的[期望值](@entry_id:153208)显然是 $E[Z_t] = \alpha$，这是一个与时间 $t$ 无关的常数。因此，它满足均值平稳的条件 [@problem_id:1964403]。

相反，许多现实世界中的序列包含某种形式的**趋势 (trend)**，这会破坏均值平稳性。考虑一个由[平稳过程](@entry_id:196130) $\{X_t\}$ 和一个确定性线性趋势 $Y_t = a + bt$（其中 $b \neq 0$）相加构成的过程 $Z_t = X_t + Y_t$。由于期望算子的线性性，新过程的[期望值](@entry_id:153208)为：

$$
E[Z_t] = E[X_t + Y_t] = E[X_t] + E[Y_t] = \mu_X + (a + bt)
$$

由于 $b \neq 0$，[期望值](@entry_id:153208) $E[Z_t]$ 明确地依赖于时间 $t$，因此该过程不是均值平稳的，从而也不是弱平稳的 [@problem_id:1964380]。这种含有确定性趋势的[非平稳性](@entry_id:180513)是[时间序列分析](@entry_id:178930)中常见的一类问题。

#### 有限且不变的[方差](@entry_id:200758)

第二个条件要求过程的[方差](@entry_id:200758)是一个与时间无关的有限正常数。

$$
\text{Var}(X_t) = E[(X_t - \mu)^2] = \sigma^2  \infty
$$

这个条件保证了序列在任何时间点的波动程度都是稳定且有界的。

一个满足此条件的典型例子是**[白噪声](@entry_id:145248) (white noise)** 过程。白噪声是一系列[独立同分布](@entry_id:169067) (i.i.d.) 的[随机变量](@entry_id:195330)，其均值为零，[方差](@entry_id:200758)为常数。例如，一个由独立的[伯努利分布](@entry_id:266933)[随机变量](@entry_id:195330)组成的序列 $\{X_t\}$，其中 $X_t$ 以概率 $p$ 取值为 1，以 $1-p$ 的概率取值为 0。该过程的均值为 $E[X_t] = p$，[方差](@entry_id:200758)为 $\text{Var}(X_t) = p(1-p)$。因为 $p$ 是常数，所以均值和[方差](@entry_id:200758)都不随时间 $t$ 变化，满足了[平稳性](@entry_id:143776)的前两个条件 [@problem_id:1964378]。

然而，许多重要的时间序列模型会违反[方差](@entry_id:200758)平稳性。一个典型的例子是**[随机游走](@entry_id:142620) (random walk)**。一个从零开始的标准[随机游走](@entry_id:142620)可以表示为 $S_t = \sum_{i=1}^t \epsilon_i$，其中 $\{\epsilon_i\}$ 是一个均值为零、[方差](@entry_id:200758)为 $\sigma_\epsilon^2$ 的白噪声序列。由于各项独立，其[方差](@entry_id:200758)为：

$$
\text{Var}(S_t) = \text{Var}\left(\sum_{i=1}^t \epsilon_i\right) = \sum_{i=1}^t \text{Var}(\epsilon_i) = t\sigma_\epsilon^2
$$

显然，[随机游走](@entry_id:142620)的[方差](@entry_id:200758)随时间 $t$ 线性增长，因此它不是一个[平稳过程](@entry_id:196130) [@problem_id:1964414]。类似地，在[一阶自回归模型](@entry_id:265801) (AR(1)) $X_t = \phi X_{t-1} + \epsilon_t$ 中，如果参数 $|\phi| \ge 1$，过程的[方差](@entry_id:200758)也会随时间发散，从而导致[非平稳性](@entry_id:180513) [@problem_id:1964421]。

除了[方差](@entry_id:200758)随时间变化外，[弱平稳性](@entry_id:171204)还要求[方差](@entry_id:200758)必须是**有限的**。这一点至关重要。考虑一个由[独立同分布](@entry_id:169067)的[随机变量](@entry_id:195330)构成的过程 $X_t = \mu + \epsilon_t$，其中扰动项 $\epsilon_t$ 服从自由度为 $\nu=2$ 的学生t分布。该[分布](@entry_id:182848)的均值为零，因此过程的均值 $E[X_t] = \mu$ 是一个常数。然而，学生t分布的[方差](@entry_id:200758)仅在自由度 $\nu > 2$ 时才存在。当 $\nu=2$ 时，其[方差](@entry_id:200758)是无穷大的。因此，尽管该过程的底层驱动是[独立同分布](@entry_id:169067)的，但由于其[方差](@entry_id:200758)不是有限值，它不满足弱平稳的定义 [@problem_id:1964402]。

#### 仅依赖于时间差的[自协方差](@entry_id:270483)

第三个也是最具特征性的条件，是关于过程内部的依赖结构。它要求任意两个时间点 $t$ 和 $s$ 上的[随机变量](@entry_id:195330)之间的协[方差](@entry_id:200758)，仅仅依赖于它们之间的时间距离（或**滞后 (lag)**） $h = |t-s|$，而与它们在时间轴上的具体位置无关。

$$
\text{Cov}(X_t, X_{t+h}) = \gamma(h)
$$

这里的 $\gamma(h)$ 被称为**[自协方差函数](@entry_id:262114) (autocovariance function, ACVF)**。当 $h=0$ 时，$\gamma(0) = \text{Cov}(X_t, X_t) = \text{Var}(X_t) = \sigma^2$。

对于任何[白噪声过程](@entry_id:146877)，由于其独立性，任何不同时间点上的变量都是不相关的。因此，对于 $h \neq 0$，$\gamma(h) = \text{Cov}(X_t, X_{t+h}) = 0$。这个[自协方差函数](@entry_id:262114) $\gamma(h)$ 显然只依赖于 $h$（在 $h=0$ 时为 $\sigma^2$，否则为0），因此[白噪声过程](@entry_id:146877)满足第三个条件 [@problem_id:1964378]。

一个违反此条件的经典例子是这样一个过程，其均值为零，但[自协方差函数](@entry_id:262114)为 $\gamma(t, s) = \min(t, s)$。首先，该过程的[方差](@entry_id:200758)为 $\text{Var}(X_t) = \gamma(t, t) = \min(t, t) = t$，这已经违反了[方差](@entry_id:200758)恒定的条件。此外，我们来考察其协[方差](@entry_id:200758)结构。对于一个固定的滞后 $h > 0$，[自协方差](@entry_id:270483)为：

$$
\text{Cov}(X_t, X_{t+h}) = \min(t, t+h) = t
$$

这个结果依赖于具体的时间点 $t$，而不仅仅是滞后 $h$。例如，滞后为2的协[方差](@entry_id:200758)在时间点 $t=1$ 和 $t=3$ 之间是 $\text{Cov}(X_1, X_3) = \min(1, 3) = 1$，而在时间点 $t=2$ 和 $t=4$ 之间则是 $\text{Cov}(X_2, X_4) = \min(2, 4) = 2$。尽管滞后相同，协[方差](@entry_id:200758)却不同，这明确违反了[弱平稳性](@entry_id:171204)的第三个条件 [@problem_id:1964406]。

### [自协方差](@entry_id:270483)与[自相关函数](@entry_id:138327)的性质

[弱平稳性](@entry_id:171204)的定义对[自协方差函数](@entry_id:262114) $\gamma(h)$ 和归一化后的**自相关函数 (autocorrelation function, ACF)** $\rho(h) = \frac{\gamma(h)}{\gamma(0)}$ 的数学形式施加了严格的约束。任何一个有效的[自协方差](@entry_id:270483)或[自相关函数](@entry_id:138327)都必须满足以下性质。

#### 偶函数性质

根据协[方差](@entry_id:200758)的定义，我们有 $\gamma(h) = \text{Cov}(X_t, X_{t-h})$。由于协[方差](@entry_id:200758)是对称的，$\text{Cov}(X_t, X_{t-h}) = \text{Cov}(X_{t-h}, X_t)$。对于一个[平稳过程](@entry_id:196130)，我们可以将时间轴平移 $h$ 个单位，得到 $\text{Cov}(X_t, X_{t+h})$，这根据定义等于 $\gamma(-h)$。因此，我们必须有：

$$
\gamma(h) = \gamma(-h)
$$

这意味着[自协方差函数](@entry_id:262114)和自相关函数都必须是关于 $h=0$ 对称的**偶函数**。这个性质可以作为检验一个函数是否可能为ACVF的快速判据。例如，函数 $\gamma(h) = 5\exp(-h)$ 和 $\gamma(h) = 10\cos(h) - 5\sin(h)$ 都不是偶函数，因此它们不可能是任何弱[平稳过程](@entry_id:196130)的[自协方差函数](@entry_id:262114) [@problem_id:1964361]。

#### 有界性

根据柯西-施瓦茨不等式，我们知道 $| \text{Cov}(U, V) | \le \sqrt{\text{Var}(U)\text{Var}(V)}$。将其应用于时间序列 $X_t$ 和 $X_{t-h}$，我们得到：

$$
|\gamma(h)| = |\text{Cov}(X_t, X_{t-h})| \le \sqrt{\text{Var}(X_t)\text{Var}(X_{t-h})}
$$

由于过程是弱平稳的，$\text{Var}(X_t) = \text{Var}(X_{t-h}) = \gamma(0)$。因此，不等式简化为：

$$
|\gamma(h)| \le \gamma(0)
$$

将上式两边同时除以 $\gamma(0)$（假设 $\gamma(0) > 0$，即过程不是确定性常数），我们得到自相关函数的一个著名性质：

$$
|\rho(h)| \le 1
$$

这意味着自相关函数的值必须在 $[-1, 1]$ 区间内。任何违反这个界的函数都不可能是有效的ACF。例如，函数 $\rho(h) = 1 - 0.2h^2$ 在 $|h|$ 较大时会小于 -1 [@problem_id:1964420]，而函数 $\gamma(h) = 5 + 2h^2$ 在 $h \neq 0$ 时会大于其在 $h=0$ 处的值 $\gamma(0)=5$ [@problem_id:1964361]。这些都不能作为[平稳过程](@entry_id:196130)的[自协方差](@entry_id:270483)或[自相关函数](@entry_id:138327)。

#### 正半定性

除了上述两个相对直观的性质外，一个更深刻和根本的性质是**正半定性 (positive semi-definiteness)**。该性质要求对于任意一组时间点 $\{t_1, \dots, t_n\}$ 和任意一组实数 $\{a_1, \dots, a_n\}$，由它们线性组合成的[随机变量的方差](@entry_id:266284)必须是非负的：

$$
\text{Var}\left(\sum_{i=1}^n a_i X_{t_i}\right) = \sum_{i=1}^n \sum_{j=1}^n a_i a_j \text{Cov}(X_{t_i}, X_{t_j}) = \sum_{i=1}^n \sum_{j=1}^n a_i a_j \gamma(t_i - t_j) \ge 0
$$

这表明由[自协方差函数](@entry_id:262114)构成的任何协方差矩阵都必须是正半定的。这是检验一个函数是否为有效ACVF的最终标准。例如，函数 $\gamma(h) = \frac{10}{1+h^2}$ 满足[偶函数](@entry_id:163605)和有界性，通过更深入的分析（如验证其谱密度非负，这超出了本章的范围），可以证明它也满足正半定性，因此它是一个有效的[自协方差函数](@entry_id:262114) [@problem_id:1964361]。类似地，形如 $\rho(h) = (0.7)^{|h|}$ 的函数是著名的一阶自回归 AR(1) 模型的ACF，它也满足所有这些条件 [@problem_id:1964420]。

### 严平稳与弱平稳

到目前为止，我们讨论的都是[弱平稳性](@entry_id:171204)。然而，还存在一个更强的平稳性定义，称为**[严平稳性](@entry_id:260987)**。

一个过程 $\{X_t\}$ 被称为严平稳，如果对于任意一组时间点 $(t_1, \dots, t_k)$ 和任意时间平移 $h$，其[联合概率分布](@entry_id:171550)保持不变。即：

$$
F_{X_{t_1}, \dots, X_{t_k}}(x_1, \dots, x_k) = F_{X_{t_1+h}, \dots, X_{t_k+h}}(x_1, \dots, x_k)
$$

这意味着整个过程的随机结构在时间上是完全不变的，不仅仅是均值和[方差](@entry_id:200758)这类低阶矩。

严平稳是一个非常强的条件。如果一个过程是严平稳的，并且其二阶矩（[方差](@entry_id:200758)）存在且有限，那么它必然是弱平稳的。然而，反过来不一定成立——一个过程可以是弱平稳的，但不是严平稳的。

为了说明这一点，我们可以构建一个特殊的例子 [@problem_id:1964385]。考虑一个由[独立同分布](@entry_id:169067)的标准正态[随机变量](@entry_id:195330) $\{\epsilon_t \sim N(0,1)\}$ 生成的过程 $\{X_t\}$，定义如下：
- 如果时间 $t$ 是偶数，$X_t = \epsilon_t$
- 如果时间 $t$ 是奇数，$X_t = \frac{1}{\sqrt{2}}(\epsilon_{t-1}^2 - 1)$

让我们来检验这个过程的平稳性。
1.  **均值**: 当 $t$ 为偶数时，$E[X_t] = E[\epsilon_t] = 0$。当 $t$ 为奇数时，$E[X_t] = \frac{1}{\sqrt{2}}(E[\epsilon_{t-1}^2] - 1) = \frac{1}{\sqrt{2}}(1 - 1) = 0$。因此，均值恒为0。
2.  **[方差](@entry_id:200758)**: 当 $t$ 为偶数时，$\text{Var}(X_t) = \text{Var}(\epsilon_t) = 1$。当 $t$ 为奇数时，$\text{Var}(X_t) = \frac{1}{2}\text{Var}(\epsilon_{t-1}^2) = \frac{1}{2}(E[\epsilon_{t-1}^4] - (E[\epsilon_{t-1}^2])^2) = \frac{1}{2}(3 - 1^2) = 1$。因此，[方差](@entry_id:200758)恒为1。
3.  **[自协方差](@entry_id:270483)**: 可以证明，对于所有 $h \neq 0$，$\text{Cov}(X_t, X_{t+h}) = 0$。因此，[自协方差函数](@entry_id:262114)为 $\gamma(h) = 1$ (若 $h=0$) 或 $0$ (若 $h \neq 0$)，它仅依赖于 $h$。

由于所有三个条件都满足，该过程是**弱平稳的**。

然而，这个过程**不是严平稳的**。因为当 $t$ 为偶数时，$X_t$ 服从标准正态分布 $N(0,1)$。而当 $t$ 为奇数时，$X_t$ 是一个经过平移和缩放的卡方分布变量，其[分布](@entry_id:182848)形态与正态分布完全不同（例如，它的取值范围是 $[-\frac{1}{\sqrt{2}}, \infty)$）。由于单变量的边缘[分布](@entry_id:182848)随时间变化（取决于 $t$ 的奇偶性），该过程的联合分布不可能是时不变的。因此，它不是严平稳的。这个例子清晰地揭示了弱平稳和严平稳之间的差异。

### 平稳性的意义

理解[平稳性](@entry_id:143776)是[时间序列分析](@entry_id:178930)的起点。它的重要性体现在多个方面：
- **模型简化**：[平稳性假设](@entry_id:272270)允许我们用一组固定的参数来描述一个无限长的[随机过程](@entry_id:159502)的动态特性，例如在 ARMA 模型中。
- **统计推断**：如果一个过程是平稳的，我们可以从序列的一个片段中学习其统计特性（如均值、[方差](@entry_id:200758)、自相关结构），并假设这些特性在整个序列中（包括未来）都成立。这是进行预测的基础。
- **[数据转换](@entry_id:170268)的指引**：对于非[平稳序列](@entry_id:144560)，我们的首要任务通常是将其转换为[平稳序列](@entry_id:144560)。例如，对含有确定性趋势的序列进行“去趋势”操作 [@problem_id:1964380]，或对[随机游走](@entry_id:142620)这类含有随机趋势的序列进行“差分”操作 [@problem_id:1964414]，都是为了获得一个平稳的序列，以便后续建模。

总之，平稳性是解锁[时间序列数据](@entry_id:262935)中蕴含的丰富信息的关键。掌握其原理与机制，是深入学习更高级时间序列模型的必经之路。