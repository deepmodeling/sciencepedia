{"hands_on_practices": [{"introduction": "虽然样本均值是衡量数据中心趋势的常用指标，但它极易受到异常值的影响。为了克服这一缺陷，我们可以采用Hodges-Lehmann估计量作为一种稳健的替代方案。该估计量基于所有成对观测值平均数的中位数，这种独特的构造使其能够有效抵抗极端值的干扰。通过完成这个练习 [@problem_id:1952389]，您将亲手计算该估计量，从而直观地理解其稳健性的来源。", "problem": "在稳健统计学中，估计量的设计旨在抵抗离群值或对模型假设的微小偏离不敏感。虽然样本均值是估计分布位置的常用估计量，但它对极值高度敏感。样本中位数是一个更稳健的替代方法。Hodges-Lehmann 估计量提供了另一种衡量中心趋势的稳健方法。\n\n对于一个包含 $n$ 个观测值 $\\{x_1, x_2, \\dots, x_n\\}$ 的数据集，位置的 Hodges-Lehmann 估计量被定义为所有成对平均数集合的中位数，这些平均数也被称为 Walsh 平均数。对于所有满足 $1 \\le i \\le j \\le n$ 的索引对 $(i, j)$，这些平均数按 $\\frac{x_i + x_j}{2}$ 计算。\n\n考虑以下观测值数据集：\n$$ S = \\{2, 3, 5, 10, 15\\} $$\n计算该数据集的 Hodges-Lehmann 估计量的值。", "solution": "Hodges-Lehmann 估计量是所有 Walsh 平均数 $w_{ij}=\\frac{x_{i}+x_{j}}{2}$（其中 $1 \\leq i \\leq j \\leq n$）的中位数。对于 $S=\\{2,3,5,10,15\\}$，其中 $n=5$，共有 $\\frac{n(n+1)}{2}=\\frac{5 \\cdot 6}{2}=15$ 个 Walsh 平均数。\n\n计算所有的 Walsh 平均数：\n$$\n\\begin{aligned}\n\\frac{2+2}{2}=2, \\frac{2+3}{2}=\\frac{5}{2}, \\frac{2+5}{2}=\\frac{7}{2}, \\frac{2+10}{2}=6, \\frac{2+15}{2}=\\frac{17}{2},\\\\\n\\frac{3+3}{2}=3, \\frac{3+5}{2}=4, \\frac{3+10}{2}=\\frac{13}{2}, \\frac{3+15}{2}=9,\\\\\n\\frac{5+5}{2}=5, \\frac{5+10}{2}=\\frac{15}{2}, \\frac{5+15}{2}=10,\\\\\n\\frac{10+10}{2}=10, \\frac{10+15}{2}=\\frac{25}{2},\\\\\n\\frac{15+15}{2}=15.\n\\end{aligned}\n$$\n将它们按非递减顺序排序：\n$$\n2,\\ \\frac{5}{2},\\ 3,\\ \\frac{7}{2},\\ 4,\\ 5,\\ 6,\\ \\frac{13}{2},\\ \\frac{15}{2},\\ \\frac{17}{2},\\ 9,\\ 10,\\ 10,\\ \\frac{25}{2},\\ 15.\n$$\n对于这 $15$ 个值，中位数是第 $\\frac{15+1}{2}=8$ 项，即 $\\frac{13}{2}$。因此，Hodges-Lehmann 估计量是 $\\frac{13}{2}$。", "answer": "$$\\boxed{\\frac{13}{2}}$$", "id": "1952389"}, {"introduction": "除了中心趋势，衡量数据的离散程度也同样重要。然而，与样本均值类似，样本标准差也对异常值高度敏感。本练习将向您介绍中位数绝对偏差（Median Absolute Deviation, MAD），它是一种经典的稳健离散度度量。您将通过计算并比较不同数据集的标准差与MAD [@problem_id:1952404]，学习一种量化和诊断异常值影响的实用方法。", "problem": "在稳健统计学中，人们经常将样本标准差与对异常值不那么敏感的其他统计离散度量进行比较。中位数绝对偏差（MAD）就是这样一种稳健的度量。对于一个数据集 $\\{x_1, x_2, \\dots, x_n\\}$，其样本标准差由 $s = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n}(x_i - \\bar{x})^2}$ 给出，其中 $\\bar{x}$ 是样本均值。MAD 定义为数据与数据中位数之差的绝对值的中位数：$\\text{MAD} = \\text{median}(|x_i - M|)$，其中 $M = \\text{median}(\\{x_1, x_2, \\dots, x_n\\})$。\n\n如果一个数据集的样本标准差远大于其 MAD，则认为该数据集存在显著的异常值问题。考虑以下数据集，每个数据集包含五个数据点：\nA. $\\{10, 11, 12, 13, 100\\}$\nB. $\\{10, 11, 12, 13, 14\\}$\nC. $\\{-50, 0, 1, 2, 50\\}$\nD. $\\{1, 3, 5, 7, 9\\}$\n\n这些数据集中，哪些满足样本标准差大于中位数绝对偏差十倍的条件（即 $s  10 \\times \\text{MAD}$）？选择所有适用的选项。如果找到多个这样的数据集，请按字母顺序连接相应的字母作为答案（例如，BD）。", "solution": "我们必须对每个数据集检验是否满足 $s  10 \\times \\text{MAD}$。由于 $s \\geq 0$ 且 $\\text{MAD} \\geq 0$，这等价于检验 $s^{2}  100 \\times \\text{MAD}^{2}$。对于一个包含 $n=5$ 个数据点的数据集 $\\{x_{1},\\dots,x_{n}\\}$，其样本方差为\n$$\ns^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2},\\quad \\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i},\n$$\n且 $\\text{MAD}=\\text{median}(|x_{i}-M|)$，其中 $M=\\text{median}(\\{x_{i}\\})$。\n\n数据集 A: $\\{10,11,12,13,100\\}$。计算 $\\bar{x}=\\frac{10+11+12+13+100}{5}=\\frac{146}{5}$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=\\frac{156770}{25}\\quad\\Rightarrow\\quad s^{2}=\\frac{1}{4}\\cdot\\frac{156770}{25}=\\frac{15677}{10}.\n$$\n中位数为 $M=12$，因此绝对偏差为 $\\{2,1,0,1,88\\}$，其中位数为 $1$，故 $\\text{MAD}=1$。检验：\n$$\ns^{2}=\\frac{15677}{10} > 100 \\cdot \\text{MAD}^{2} = 100 \\cdot 1^2 = 100 \\quad\\Rightarrow\\quad s > 10 \\cdot \\text{MAD}.\n$$\n因此 A 满足条件。\n\n数据集 B: $\\{10,11,12,13,14\\}$。计算 $\\bar{x}=12$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=10\\quad\\Rightarrow\\quad s^{2}=\\frac{10}{4}=\\frac{5}{2}.\n$$\n中位数 $M=12$，绝对偏差为 $\\{2,1,0,1,2\\}$，其中位数为 $1$，所以 $\\text{MAD}=1$。检验：\n$$\ns^{2}=\\frac{5}{2}  100 \\cdot \\text{MAD}^{2} = 100 \\cdot 1^2 = 100,\n$$\n所以 B 不满足条件。\n\n数据集 C: $\\{-50,0,1,2,50\\}$。计算 $\\bar{x}=\\frac{-50+0+1+2+50}{5}=\\frac{3}{5}$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=\\frac{125080}{25}\\quad\\Rightarrow\\quad s^{2}=\\frac{1}{4}\\cdot\\frac{125080}{25}=\\frac{6254}{5}.\n$$\n中位数 $M=1$，绝对偏差为 $\\{51,1,0,1,49\\}$，其中位数为 $1$，所以 $\\text{MAD}=1$。检验：\n$$\ns^{2}=\\frac{6254}{5} > 100 \\cdot \\text{MAD}^{2} = 100 \\cdot 1^2 = 100,\n$$\n所以 C 满足条件。\n\n数据集 D: $\\{1,3,5,7,9\\}$。计算 $\\bar{x}=5$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=40\\quad\\Rightarrow\\quad s^{2}=\\frac{40}{4}=10.\n$$\n中位数 $M=5$，绝对偏差为 $\\{4,2,0,2,4\\}$，其中位数为 $2$，所以 $\\text{MAD}=2$。检验：\n$$\ns^{2}=10  100 \\cdot \\text{MAD}^{2} = 100 \\cdot 2^{2}=400,\n$$\n所以 D 不满足条件。\n\n因此，满足 $s10\\times \\text{MAD}$ 的数据集是 A 和 C。", "answer": "$$\\boxed{AC}$$", "id": "1952404"}, {"introduction": "在掌握了特定的稳健估计量后，我们可以探索一类更通用、更强大的方法：M-估计。M-估计量通过一个影响函数 $\\psi$ 来限制异常值的影响，将最大似然估计的思想推广到了稳健统计的场景中。这个练习 [@problem_id:1952425] 将指导您使用著名的Huber $\\psi$ 函数求解一个M-估计量，这能帮助您理解如何在保证对“常规”数据估计效率的同时，实现对异常值的稳健性。", "problem": "在稳健统计学中，M-估计量是一大类对异常值具有稳健性的估计量。对于一个数据集 $\\{x_1, x_2, \\ldots, x_n\\}$，其位置M-估计量（记作 $\\hat{\\theta}$）定义为以下方程的解：\n$$\n\\sum_{i=1}^{n} \\psi\\left(\\frac{x_i - \\theta}{S}\\right) = 0\n$$\n其中 $S$ 是一个稳健的尺度估计量，而 $\\psi$ 是一个选定的影响函数。\n\n考虑Huber的 $\\psi$-函数，对于给定的调节常数 $k  0$，其定义如下：\n$$\n\\psi_k(u) = \\begin{cases}\n-k  \\text{if } u  -k \\\\\nu  \\text{if } |u| \\leq k \\\\\nk  \\text{if } u  k\n\\end{cases}\n$$\n该函数通过将大的残差“修剪”在 $\\pm k$ 处，来限制它们的影响。\n\n一位工程师正在分析一组关于某个组件长度的五次独立测量。获得的测量值为：\n$$\n\\{2.1, 2.5, 2.3, 2.6, 4.5\\}\n$$\n为了获得一个对单个大值不至于过分敏感的位置估计，该工程师决定使用M-估计量。在计算中，将使用固定的尺度估计量 $S=1$ 和调节常数 $k=1.5$。\n\n计算该数据集的位置M-估计值 $\\hat{\\theta}$。你的答案应四舍五入到三位有效数字。", "solution": "我们寻求求解M-估计方程的 $\\hat{\\theta}$：\n$$\n\\sum_{i=1}^{5} \\psi_{k}\\!\\left(\\frac{x_{i}-\\theta}{S}\\right)=0,\n$$\n其中 $S=1$，$k=1.5$，且 $x=\\{2.1,2.5,2.3,2.6,4.5\\}$。当 $S=1$ 时，方程变为：\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=0,\n$$\n其中Huber函数为，当 $|u|\\leq k$ 时 $\\psi_{k}(u)=u$，当 $|u|k$ 时 $\\psi_{k}(u)=\\pm k$，符号与 $u$ 相同。\n\n对于每个 $x_i$，当 $|x_i - \\theta| \\leq 1.5$ 时，该项是线性的（即未被修剪），这等价于 $\\theta \\in [x_i - 1.5, \\, x_i + 1.5]$。这些区间是：\n- $x_{1}=2.1$: $\\theta\\in[0.6,\\,3.6]$\n- $x_{2}=2.5$: $\\theta\\in[1.0,\\,4.0]$\n- $x_{3}=2.3$: $\\theta\\in[0.8,\\,3.8]$\n- $x_{4}=2.6$: $\\theta\\in[1.1,\\,4.1]$\n- $x_{5}=4.5$: $\\theta\\in[3.0,\\,6.0]$\n\n考虑 $\\theta\\in[1.1,3.0)$ 的情况，此时前四项是线性的，而第五项由于 $4.5-\\theta1.5$ 被修剪为 $+1.5$。那么：\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=\\sum_{i=1}^{4} (x_{i}-\\theta) + 1.5.\n$$\n使用 $\\sum_{i=1}^{4} x_{i}=2.1+2.5+2.3+2.6=9.5$，我们得到：\n$$\n9.5 - 4\\theta + 1.5 = 0 \\;\\;\\Longrightarrow\\;\\; 11 - 4\\theta = 0 \\;\\;\\Longrightarrow\\;\\; \\hat{\\theta}=\\frac{11}{4}=2.75.\n$$\n在 $\\hat{\\theta}=2.75$ 处检查区域的一致性：\n- 对于 $x_{1},x_{2},x_{3},x_{4}$，有 $|x_{i}-\\hat{\\theta}|\\in\\{0.65,0.25,0.45,0.15\\}\\leq 1.5$，因此将它们作为线性项处理是正确的。\n- 对于 $x_{5}$，有 $|4.5-2.75|=1.751.5$，因此将其修剪为 $+1.5$ 是正确的。\n\n因此，该解在此区域内是有效且唯一的。四舍五入到三位有效数字得到 $2.75$。", "answer": "$$\\boxed{2.75}$$", "id": "1952425"}]}