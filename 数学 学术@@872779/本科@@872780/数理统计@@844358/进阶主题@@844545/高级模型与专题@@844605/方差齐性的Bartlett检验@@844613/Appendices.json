{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是亲手实践。第一个练习 ([@problem_id:1898016]) 将引导你完整地走一遍巴特利特检验的全过程，从原始的汇总统计数据出发，一步步计算检验统计量，并最终做出统计决策。通过这个例子，你将深入理解公式中每个部分的含义，特别是样本量在检验中的加权作用。", "problem": "一位农业科学家正在研究三种新肥料处理下作物产量的稳定性。为此，她收集了每种处理下几个地块的产量数据（单位：公斤/公顷）。目标是确定这三种处理的产量变异性是否相同。\n\n实验的汇总统计数据如下：\n-   **处理 1：** 样本量 $n_1 = 11$ 个地块，样本方差 $S_1^2 = 15.0\\ (\\text{kg/hectare})^2$。\n-   **处理 2：** 样本量 $n_2 = 101$ 个地块，样本方差 $S_2^2 = 25.0\\ (\\text{kg/hectare})^2$。\n-   **处理 3：** 样本量 $n_3 = 11$ 个地块，样本方差 $S_3^2 = 40.0\\ (\\text{kg/hectare})^2$。\n\n该科学家决定使用Bartlett's 方差齐性检验。检验统计量 $T$ 的计算公式如下：\n$$T = \\frac{(N-k) \\ln(S_p^2) - \\sum_{i=1}^{k} (n_i-1) \\ln(S_i^2)}{1 + \\frac{1}{3(k-1)} \\left( \\sum_{i=1}^{k} \\frac{1}{n_i-1} - \\frac{1}{N-k} \\right)}$$\n其中$k$是组数，$n_i$是第$i$组的样本量，$N = \\sum n_i$，$S_i^2$是第$i$组的样本方差，$S_p^2 = \\frac{1}{N-k}\\sum_{i=1}^{k}(n_i-1)S_i^2$是合并方差。在方差相等的原假设下，$T$服从自由度为$k-1$的卡方分布。\n\n在$\\alpha = 0.05$的显著性水平下进行Bartlett's检验。在此显著性水平下，相关卡方分布的临界值为5.991。根据您的计算，选择正确陈述检验统计量$T$的近似值和检验结论的选项。\n\nA. 检验统计量约等于$T \\approx 2.31$，我们未能拒绝原假设。没有充分的证据得出方差不相等的结论。\nB. 检验统计量约等于$T \\approx 2.31$，我们拒绝原假设。有充分的证据得出方差不相等的结论。\nC. 检验统计量约等于$T \\approx 7.54$，我们拒绝原假设。有充分的证据得出方差不相等的结论。\nD. 检验统计量约等于$T \\approx 7.54$，我们未能拒绝原假设。没有充分的证据得出方差不相等的结论。\nE. 检验无法进行，因为Bartlett's检验要求所有组的样本量相等。", "solution": "我们使用Bartlett's检验来检验$k=3$个组的方差齐性。给定$n_{1}=11$，$S_{1}^{2}=15.0$，$n_{2}=101$，$S_{2}^{2}=25.0$，$n_{3}=11$，$S_{3}^{2}=40.0$，首先计算总样本量与合并方差。总样本量为$N=\\sum_{i=1}^{3} n_{i}=11+101+11=123$，所以$N-k=123-3=120$。合并方差为\n$$\nS_{p}^{2}=\\frac{1}{N-k}\\sum_{i=1}^{3}(n_{i}-1)S_{i}^{2}\n=\\frac{1}{120}\\left(10\\cdot 15.0+100\\cdot 25.0+10\\cdot 40.0\\right)\n=\\frac{3050}{120}=\\frac{305}{12}\\approx 25.4166667.\n$$\nBartlett检验统计量为\n$$\nT=\\frac{(N-k)\\ln(S_{p}^{2})-\\sum_{i=1}^{3}(n_{i}-1)\\ln(S_{i}^{2})}{1+\\frac{1}{3(k-1)}\\left(\\sum_{i=1}^{3}\\frac{1}{n_{i}-1}-\\frac{1}{N-k}\\right)}.\n$$\n计算分子：\n$$\n(N-k)\\ln(S_{p}^{2})=120\\ln\\!\\left(\\frac{305}{12}\\right)\\approx 120\\cdot 3.235405126=388.248615,\n$$\n$$\n\\sum_{i=1}^{3}(n_{i}-1)\\ln(S_{i}^{2})=10\\ln(15.0)+100\\ln(25.0)+10\\ln(40.0)\n$$\n其中\n$$\n\\ln(15.0)\\approx 2.708050200,\\quad \\ln(25.0)\\approx 3.218875824,\\quad \\ln(40.0)\\approx 3.688879454,\n$$\n所以\n$$\n\\sum_{i=1}^{3}(n_{i}-1)\\ln(S_{i}^{2})\\approx 10\\cdot 2.708050200+100\\cdot 3.218875824+10\\cdot 3.688879454=385.856879.\n$$\n因此分子是\n$$\n388.248615-385.856879=2.391736.\n$$\n计算分母中的修正项：\n$$\n\\sum_{i=1}^{3}\\frac{1}{n_{i}-1}=\\frac{1}{10}+\\frac{1}{100}+\\frac{1}{10}=0.21,\\quad \\frac{1}{N-k}=\\frac{1}{120}\\approx 0.008333333,\n$$\n$$\n1+\\frac{1}{3(k-1)}\\left(\\sum_{i=1}^{3}\\frac{1}{n_{i}-1}-\\frac{1}{N-k}\\right)=1+\\frac{1}{3\\cdot 2}\\left(0.21-0.008333333\\right)=1+ \\frac{1}{6}\\cdot 0.201666667\\approx 1.033611。\n$$\n因此，\n$$\nT\\approx \\frac{2.391736}{1.033611}\\approx 2.314.\n$$\n在方差相等的原假设下，将$T$与自由度为$k-1=2$的卡方分布进行比较。在显著性水平$\\alpha=0.05$下，临界值为$5.991$。由于 $T\\approx 2.31  5.991$，我们未能拒绝原假设。没有充分的证据得出方差不相等的结论。Bartlett's检验不要求样本量相等，因此在这里适用。\n\n与$T\\approx 2.31$和未能拒绝原假设相匹配的选项是A。", "answer": "$$\\boxed{A}$$", "id": "1898016"}, {"introduction": "在实际数据分析中，我们常常从统计软件直接获得 $p$ 值。第二个练习 ([@problem_id:1898021]) 将挑战你逆向思考：已知一个确切的 $p$ 值，反推出巴特利特检验统计量的值。这个过程不仅能加深你对卡方分布、自由度以及 $p$ 值定义之间联系的理解，也让你能更批判性地解读和验证软件的输出结果。", "problem": "一位数据科学家正在分析来自四个不同处理组的实验结果，以评估各组内测量值的方差是否相等。该科学家决定使用巴特利特检验（Bartlett's test）来检验方差齐性。四个组中，每组都包含恰好16个独立观测值。对样本数据进行计算后，检验得出的p值恰好为0.01。根据这些信息，确定所计算出的巴特利特检验统计量的数值。\n\n请将您的最终答案四舍五入到四位有效数字。", "solution": "令$k$表示组数，$n_{i}$表示第$i$组的样本量。对于巴特利特检验，在方差相等的原假设和正态性假设下，巴特利特检验统计量$B$近似服从自由度为$k-1$的卡方分布：\n$$\nB \\sim \\chi^{2}_{k-1}.\n$$\n这里，$k=4$，所以自由度为\n$$\nk-1=3.\n$$\n报告的p值是该卡方分布的上尾概率：\n$$\np=\\Pr\\!\\left(\\chi^{2}_{3} \\geq B\\right).\n$$\n已知$p=0.01$，我们通过求卡方累积分布函数的逆函数来解出$B$：\n$$\n\\Pr\\!\\left(\\chi^{2}_{3} \\leq B\\right)=1-p=0.99 \\quad \\Rightarrow \\quad B=F^{-1}_{\\chi^{2}_{3}}(0.99).\n$$\n从自由度为$3$的卡方分布的$0.99$分位数可知，\n$$\nB=F^{-1}_{\\chi^{2}_{3}}(0.99)\\approx 11.344866\\ldots\n$$\n四舍五入到四位有效数字，得到$11.34$。", "answer": "$$\\boxed{11.34}$$", "id": "1898021"}, {"introduction": "任何统计检验都建立在特定的假设之上，巴特利特检验也不例外，它对数据的正态性有要求。最后一个练习 ([@problem_id:1898014]) 将带你探索当这个核心假设被违背时会发生什么。通过分析当数据服从均匀分布而非正态分布时检验统计量的行为，你将接触到统计检验稳健性的重要概念，并理解为什么在使用任何统计工具前，检查其适用条件是至关重要的。", "problem": "一位工程师的任务是确保由$k=4$条不同生产线生产的组件长度的一致性。对于每条生产线 $i$，都会收集大量的组件样本，并测量其长度。该工程师计划检验一个原假设，即所有四条生产线的组件长度的方差均相等，即 $H_0: \\sigma_1^2 = \\sigma_2^2 = \\sigma_3^2 = \\sigma_4^2$。\n\n工程师采用了Bartlett检验，这是用于此目的的标准方法，但它假设来自每条生产线的数据都服从正态分布。Bartlett检验统计量（我们称之为 $M^2$）的构造方式使得在原假设和正态性假设下，它近似服从自由度为 $k-1$ 的卡方随机变量分布。\n\n经过进一步调查，确定每条生产线的组件长度并不服从正态分布。相反，它们近似服从连续均匀分布 $U(\\mu - w, \\mu + w)$，其中 $\\mu$ 是组件的平均长度，而 $w$ 是一个定义容差范围的正常数。尽管分布非正态，但各生产线间方差相等的原假设被认为是成立的。\n\n对于来自非正态分布的大样本，在原假设下，Bartlett统计量的渐近分布会有所修正。可以证明，该统计量的期望值近似为 $E[M^2] \\approx (k-1) \\left(1 + \\frac{\\gamma_2}{2}\\right)$，其中 $\\gamma_2$ 是基础总体分布的超额峰度。这意味着统计量 $M^2$ 渐近服从 $C \\cdot \\chi^2_{k-1}$ 分布，其中缩放因子为 $C = 1 + \\frac{\\gamma_2}{2}$。这个因子 $C$ 量化了由于非正态性，检验统计量的分布偏离预期卡方分布的程度，而这反过来又会影响检验的真实I类错误率。\n\n您的任务是计算指定均匀分布下这个缩放因子 $C$ 的值。", "solution": "我们已知，对于来自非正态分布的大样本，在方差相等的原假设下，Bartlett统计量满足以下渐近关系\n$$\nE[M^{2}] \\approx (k-1)\\left(1 + \\frac{\\gamma_{2}}{2}\\right),\n$$\n这意味着该统计量渐近服从如下分布\n$$\nM^{2} \\overset{d}{\\approx} C \\cdot \\chi^{2}_{k-1}, \\quad \\text{其中} \\quad C = 1 + \\frac{\\gamma_{2}}{2},\n$$\n其中 $\\gamma_{2}$ 是总体分布的超额峰度。\n\n对于连续均匀分布 $U(\\mu - w, \\mu + w)$，我们使用中心矩来计算 $\\gamma_{2}$。设 $X \\sim U(\\mu - w, \\mu + w)$。根据对称性，将 $X$ 在 $\\mu$ 处中心化，并考虑 $Y = X - \\mu \\sim U(-w, w)$。那么：\n- 方差为\n$$\n\\operatorname{Var}(Y) = \\frac{w^{2}}{3}.\n$$\n- 四阶中心矩为\n$$\nE[Y^{4}] = \\frac{w^{4}}{5}.\n$$\n因此，峰度为\n$$\n\\beta_{2} = \\frac{E[Y^{4}]}{(\\operatorname{Var}(Y))^{2}} = \\frac{\\frac{w^{4}}{5}}{\\left(\\frac{w^{2}}{3}\\right)^{2}} = \\frac{\\frac{w^{4}}{5}}{\\frac{w^{4}}{9}} = \\frac{9}{5}.\n$$\n那么超额峰度为\n$$\n\\gamma_{2} = \\beta_{2} - 3 = \\frac{9}{5} - 3 = -\\frac{6}{5}.\n$$\n代入 $C$ 的表达式，得到\n$$\nC = 1 + \\frac{\\gamma_{2}}{2} = 1 + \\frac{-\\frac{6}{5}}{2} = 1 - \\frac{3}{5} = \\frac{2}{5}.\n$$\n该值与 $\\mu$ 和 $w$ 无关，正如对于诸如超额峰度之类的标准化形状参数所预期的那样，因此适用于任何所述形式的均匀分布。", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "1898014"}]}