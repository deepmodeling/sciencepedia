{"hands_on_practices": [{"introduction": "我们从一个基础场景开始：估计伯努利试验中的成功概率。这个练习 [@problem_id:1952134] 将指导你如何计算一个特定加权估计量在平方误差损失下的风险函数。通过这个计算，你将巩固风险作为期望损失的核心定义，并熟练运用期望和方差的性质来解决问题。", "problem": "考虑两个随机变量 $X_1$ 和 $X_2$，它们根据一个带有未知参数 $p$ 的伯努利分布独立同分布 (i.i.d.)，其中 $p \\in (0, 1)$。其概率质量函数为 $P(X=k) = p^k(1-p)^{1-k}$，对于 $k \\in \\{0, 1\\}$。\n\n一位分析师基于这两个观测值，提出了参数 $p$ 的一个估计量 $\\hat{p}$，定义如下：\n$$\n\\hat{p} = \\frac{X_1 + 2X_2}{3}\n$$\n该估计量的质量将使用平方误差损失函数进行评估，该函数定义为 $L(p, \\hat{p}) = (p - \\hat{p})^2$。\n\n您的任务是计算此估计量的风险函数 $R(p, \\hat{p})$。风险函数定义为损失函数的期望值。请将您的答案表示为参数 $p$ 的函数。", "solution": "我们需要计算在平方误差损失下的风险：\n$$\nR(p,\\hat{p})=\\mathbb{E}\\big[(\\hat{p}-p)^{2}\\big].\n$$\n对于平方误差，风险等于均方误差：\n$$\nR(p,\\hat{p})=\\operatorname{Var}(\\hat{p})+\\big(\\mathbb{E}[\\hat{p}]-p\\big)^{2}.\n$$\n给定 $\\hat{p}=(X_{1}+2X_{2})/3$，其中 $X_{1}$ 和 $X_{2}$ 独立同分布于 $\\operatorname{Bernoulli}(p)$，我们使用 $\\mathbb{E}[X_{i}]=p$ 和 $\\operatorname{Var}(X_{i})=p(1-p)$（对于 $i\\in\\{1,2\\}$），并且独立性意味着 $\\operatorname{Cov}(X_{1},X_{2})=0$。\n\n首先计算期望：\n$$\n\\mathbb{E}[\\hat{p}]=\\mathbb{E}\\left[\\frac{X_{1}+2X_{2}}{3}\\right]=\\frac{\\mathbb{E}[X_{1}]+2\\mathbb{E}[X_{2}]}{3}=\\frac{p+2p}{3}=p,\n$$\n所以偏差为零：\n$$\n\\big(\\mathbb{E}[\\hat{p}]-p\\big)^{2}=0.\n$$\n\n接下来计算方差：\n$$\n\\operatorname{Var}(\\hat{p})=\\operatorname{Var}\\left(\\frac{X_{1}+2X_{2}}{3}\\right)=\\frac{1}{9}\\operatorname{Var}(X_{1}+2X_{2}).\n$$\n使用 $\\operatorname{Var}(X_{1}+2X_{2})=\\operatorname{Var}(X_{1})+4\\operatorname{Var}(X_{2})+4\\operatorname{Cov}(X_{1},X_{2})$ 且 $\\operatorname{Cov}(X_{1},X_{2})=0$，\n$$\n\\operatorname{Var}(X_{1}+2X_{2})=\\operatorname{Var}(X_{1})+4\\operatorname{Var}(X_{2})=p(1-p)+4p(1-p)=5p(1-p).\n$$\n因此，\n$$\n\\operatorname{Var}(\\hat{p})=\\frac{1}{9}\\cdot 5p(1-p)=\\frac{5}{9}p(1-p).\n$$\n\n结合这些结果，\n$$\nR(p,\\hat{p})=\\operatorname{Var}(\\hat{p})+\\big(\\mathbb{E}[\\hat{p}]-p\\big)^{2}=\\frac{5}{9}p(1-p).\n$$", "answer": "$$\\boxed{\\frac{5}{9}p(1-p)}$$", "id": "1952134"}, {"introduction": "一个常见的误解是无偏估计量总是更优的。这个练习 [@problem_id:1952180] 将挑战这一观念，它通过比较标准的样本均值和一个简单的、有偏的常数估计量。通过确定有偏估计量在何种条件下风险更低，我们将对统计推断中核心的“偏差-方差权衡”有更深刻的理解。", "problem": "一位数据科学家负责估计一个物理常数 $\\mu$。已知该常数的测量值服从均值为 $\\mu$、已知方差为 1 的正态分布。进行了一项新实验，产生了一个包含 $n$ 个测量值的随机样本，记为 $\\mathbf{X} = (X_1, X_2, \\ldots, X_n)$。\n\n该数据科学家考虑了两种不同的 $\\mu$ 估计量：\n1. 样本均值估计量，$\\delta_{\\text{mean}}(\\mathbf{X}) = \\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n2. 常数估计量，$\\delta_{\\text{const}}(\\mathbf{X}) = c$，其中 $c$ 是基于理论预测预先确定的常数值。\n\n估计量 $\\delta$ 的性能通过其在平方误差损失下的风险函数进行评估，定义为 $R(\\mu, \\delta) = E[(\\delta(\\mathbf{X}) - \\mu)^2]$，其中期望是针对样本 $\\mathbf{X}$ 的分布计算的。\n\n确定真实参数 $\\mu$ 的取值范围（用 $c$ 和 $n$ 表示），使得常数估计量 $\\delta_{\\text{const}}$ 的风险严格小于样本均值估计量 $\\delta_{\\text{mean}}$ 的风险。最终答案应为一个行矩阵，包含两个元素：$\\mu$ 的开区间的下界和上界，按此顺序排列。", "solution": "设 $X_{1},\\ldots,X_{n}$ 相互独立，且 $X_{i} \\sim \\mathcal{N}(\\mu,1)$。在平方误差损失下的风险为 $R(\\mu,\\delta)=\\mathbb{E}\\big[(\\delta(\\mathbf{X})-\\mu)^{2}\\big]$。对于任何估计量，偏差-方差分解给出\n$$\nR(\\mu,\\delta)=\\operatorname{Var}(\\delta(\\mathbf{X}))+\\big(\\mathbb{E}[\\delta(\\mathbf{X})]-\\mu\\big)^{2}.\n$$\n\n对于样本均值 $\\delta_{\\text{mean}}(\\mathbf{X})=\\bar{X}$，我们有 $\\bar{X} \\sim \\mathcal{N}\\!\\left(\\mu,\\frac{1}{n}\\right)$，所以\n$$\n\\mathbb{E}[\\bar{X}]=\\mu,\\qquad \\operatorname{Var}(\\bar{X})=\\frac{1}{n}.\n$$\n因此\n$$\nR(\\mu,\\delta_{\\text{mean}})=\\operatorname{Var}(\\bar{X})+\\big(\\mathbb{E}[\\bar{X}]-\\mu\\big)^{2}=\\frac{1}{n}+0=\\frac{1}{n}.\n$$\n\n对于常数估计量 $\\delta_{\\text{const}}(\\mathbf{X})=c$，我们有 $\\operatorname{Var}(c)=0$ 且 $\\mathbb{E}[c]=c$，所以\n$$\nR(\\mu,\\delta_{\\text{const}})=0+(c-\\mu)^{2}=(c-\\mu)^{2}.\n$$\n\n当满足以下条件时，常数估计量的风险严格小于样本均值估计量：\n$$\n(c-\\mu)^{2}  \\frac{1}{n}.\n$$\n两边取平方根，得到\n$$\n|c-\\mu|  \\frac{1}{\\sqrt{n}},\n$$\n这等价于\n$$\nc - \\frac{1}{\\sqrt{n}}  \\mu  c + \\frac{1}{\\sqrt{n}}\n$$", "answer": "$$\\boxed{\\begin{pmatrix} c-\\frac{1}{\\sqrt{n}}  c+\\frac{1}{\\sqrt{n}} \\end{pmatrix}}$$", "id": "1952180"}, {"introduction": "现实世界中的决策往往涉及在多个目标之间取得平衡。这个练习 [@problem_id:1952186] 超越了简单的平方误差损失，引入了一个更真实的场景，其损失函数同时包含了估计误差和数据收集成本。这个问题展示了风险函数的强大适应性，揭示了它如何被用来指导在序列抽样等复杂应用中的决策。", "problem": "在纳米材料的质量控制领域，一家公司生产量子点。在此过程中，每个量子点独立地为功能性（一次“成功”），其概率为一个未知常数 $p$，或为有缺陷的（一次“失败”）。为估计该过程的效率，实施了一种序贯检验方案：逐个测试量子点，直到鉴定出预定数量 $r$ 个功能性量子点为止。在此过程中测试的量子点总数用随机变量 $N$ 表示。根据概率论的一个已知结果，$N$ 服从负二项分布。在 $N$ 是第 $r$ 次成功的试验次数这种特定参数化下，其期望为 $E[N] = r/p$，方差为 $\\text{Var}(N) = r(1-p)/p^2$。\n\n公司感兴趣的参数是找到单个功能性量子点所需的期望测试次数，定义为 $\\theta = 1/p$。为此参数提出了一个自然估计量：$\\hat{\\theta} = N/r$。\n\n公司的决策由一个权衡估计精度与测试成本的损失函数引导。当真实参数为 $\\theta$ 时，使用估计量 $\\hat{\\theta}$ 所产生的损失由估计误差的平方与与总测试次数成正比的成本之和给出：\n$$L(\\theta, \\hat{\\theta}) = (\\hat{\\theta} - \\theta)^2 + cN$$\n其中 $c$ 是一个正常数，代表每次测试的成本。\n\n你的任务是推导在该损失函数下使用估计量 $\\hat{\\theta}$ 的统计风险。风险 $R(p)$ 定义为损失函数的期望，$R(p) = E[L(\\theta, \\hat{\\theta})]$。请将你的最终答案表示为真实成功概率 $p$、所需成功次数 $r$ 和成本系数 $c$ 的函数。", "solution": "给定 $N \\sim \\text{NegBin}(r,p)$ 为获得第 $r$ 次成功时的试验次数，其期望为 $E[N] = \\frac{r}{p}$，方差为 $\\text{Var}(N) = \\frac{r(1-p)}{p^{2}}$。目标参数为 $\\theta = \\frac{1}{p}$，估计量为 $\\hat{\\theta} = \\frac{N}{r}$。损失为\n$$\nL(\\theta,\\hat{\\theta}) = \\left(\\frac{N}{r} - \\frac{1}{p}\\right)^{2} + cN.\n$$\n作为 $p$ 的函数的风险是\n$$\nR(p) = E\\!\\left[\\left(\\frac{N}{r} - \\frac{1}{p}\\right)^{2}\\right] + c\\,E[N].\n$$\n使用恒等式 $E[(X-a)^{2}] = \\text{Var}(X) + (E[X]-a)^{2}$，并令 $X = \\frac{N}{r}$ 和 $a = \\frac{1}{p}$，我们得到\n$$\nE\\!\\left[\\left(\\frac{N}{r} - \\frac{1}{p}\\right)^{2}\\right] = \\text{Var}\\!\\left(\\frac{N}{r}\\right) + \\left(E\\!\\left[\\frac{N}{r}\\right] - \\frac{1}{p}\\right)^{2}.\n$$\n计算期望和方差项：\n$$\nE\\!\\left[\\frac{N}{r}\\right] = \\frac{1}{r}E[N] = \\frac{1}{r}\\cdot \\frac{r}{p} = \\frac{1}{p},\n$$\n因此该估计量是无偏的，偏差平方项为零。另外，\n$$\n\\text{Var}\\!\\left(\\frac{N}{r}\\right) = \\frac{1}{r^{2}}\\text{Var}(N) = \\frac{1}{r^{2}}\\cdot \\frac{r(1-p)}{p^{2}} = \\frac{1-p}{r p^{2}}.\n$$\n因此，\n$$\nR(p) = \\frac{1-p}{r p^{2}} + c\\,E[N] = \\frac{1-p}{r p^{2}} + c\\,\\frac{r}{p}.\n$$\n这就将风险表示为了 $p$、$r$ 和 $c$ 的函数。", "answer": "$$\\boxed{\\frac{1-p}{r p^{2}}+\\frac{c r}{p}}$$", "id": "1952186"}]}