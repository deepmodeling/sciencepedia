{"hands_on_practices": [{"introduction": "掌握任何统计检验的第一步都是理解其核心计算。本练习将指导你通过一个具体案例，手动完成对数秩检验的每一步计算[@problem_id:1962148]。通过亲手计算每个事件时间点的观测值、期望值和方差，你将能透彻理解对数秩统计量背后的逻辑。", "problem": "一家环境科学公司正在测试一种旨在加速特定类型塑料生物降解的新型添加剂。将十个含有该添加剂的塑料样本（处理组）和十个不含该添加剂的样本（对照组）放置在受控的堆肥环境中。记录每个样本完全降解所需的时间（以周为单位）。该研究计划进行25周，任何在研究结束时仍未完全降解的样本都被视为“删失”(censored)。\n\n记录的降解时间（以周为单位）如下：\n*   **处理组：** 8, 11, 15, 15, 20, 22, 25+, 25+, 25+, 25+\n*   **对照组：** 12, 17, 19, 21, 24, 25+, 25+, 25+, 25+, 25+\n\n在此，时间后面的 `+` 表示该样本在25周的研究结束时仍未降解，该观测值为删失数据。\n\n你的任务是执行对数秩检验(log-rank test)的关键计算，以比较这两组。具体来说，你需要计算检验统计量 $X^2$，其定义为 $X^2 = \\frac{(\\sum_{i=1}^{k} (O_i - E_i))^2}{\\sum_{i=1}^{k} V_i}$，其中求和是针对所有不同的事件时间。对于每个不同的事件时间 $t_i$，$O_i$ 是处理组中观测到的事件数，$E_i$ 是处理组中预期的事件数，$V_i$ 是差值 $O_i - E_i$ 的方差。\n\n计算对数秩统计量 $X^2$ 的值。将你的最终答案四舍五入到四位有效数字。", "solution": "我们使用对数秩检验来比较处理组（第1组）与对照组（第2组）。在每个不同的事件时间 $t_{i}$，设 $n_{1i}$ 和 $n_{2i}$ 分别为第1组和第2组在 $t_{i}$ 之前处于风险中的数量，且 $n_{i}=n_{1i}+n_{2i}$。设 $d_{1i}$ 和 $d_{2i}$ 分别为在 $t_{i}$ 时第1组和第2组中发生的事件数，且 $d_{i}=d_{1i}+d_{2i}$。对数秩的贡献计算如下\n$$\nE_{i}=d_{i}\\frac{n_{1i}}{n_{i}},\\qquad \nV_{i}=d_{i}\\frac{n_{1i}}{n_{i}}\\left(1-\\frac{n_{1i}}{n_{i}}\\right)\\frac{n_{i}-d_{i}}{n_{i}-1},\n$$\n检验统计量为\n$$\nX^{2}=\\frac{\\left(\\sum_{i}(O_{i}-E_{i})\\right)^{2}}{\\sum_{i}V_{i}},\n$$\n其中 $O_{i}=d_{1i}$。在同一时间发生的结事件使用如上所示的相同的 $E_{i}$ 和 $V_{i}$，其中 $d_i > 1$。\n\n不同的事件时间（周）是 $8,11,12,15,17,19,20,21,22,24$。在第25周之前没有删失数据，因此风险集仅因先前的事件而减少。观测到的事件计数为：处理组事件发生在 $8,11,15,15,20,22$；对照组事件发生在 $12,17,19,21,24$。\n\n按时间步进，给出 $(n_{1i},n_{2i};d_{1i},d_{2i})$，然后计算 $O_{i}-E_{i}$ 和 $V_{i}$。\n\n1) $t=8$：$(10,10;1,0)$ 所以 $n=20, d=1$。\n$$\nE_{8}=1\\cdot\\frac{10}{20}=\\frac{1}{2},\\quad O_{8}-E_{8}=1-\\frac{1}{2}=\\frac{1}{2},\\quad\nV_{8}=1\\cdot\\frac{10}{20}\\left(1-\\frac{10}{20}\\right)\\frac{19}{19}=\\frac{1}{4}.\n$$\n\n2) $t=11$：$(9,10;1,0)$ 所以 $n=19, d=1$。\n$$\nE_{11}=\\frac{9}{19},\\quad O_{11}-E_{11}=1-\\frac{9}{19}=\\frac{10}{19},\\quad\nV_{11}=\\frac{9}{19}\\cdot\\frac{10}{19}\\cdot\\frac{18}{18}=\\frac{90}{361}.\n$$\n\n3) $t=12$：$(8,10;0,1)$ 所以 $n=18, d=1$。\n$$\nE_{12}=\\frac{8}{18}=\\frac{4}{9},\\quad O_{12}-E_{12}=0-\\frac{4}{9}=-\\frac{4}{9},\\quad\nV_{12}=\\frac{4}{9}\\cdot\\frac{5}{9}\\cdot\\frac{17}{17}=\\frac{20}{81}.\n$$\n\n4) $t=15$：$(8,9;2,0)$ 所以 $n=17, d=2$ （处理组中有两个结事件）。\n$$\nE_{15}=2\\cdot\\frac{8}{17}=\\frac{16}{17},\\quad O_{15}-E_{15}=2-\\frac{16}{17}=\\frac{18}{17},\n$$\n$$\nV_{15}=2\\cdot\\frac{8}{17}\\left(1-\\frac{8}{17}\\right)\\frac{17-2}{17-1}\n=2\\cdot\\frac{8}{17}\\cdot\\frac{9}{17}\\cdot\\frac{15}{16}\n=\\frac{135}{289}.\n$$\n\n5) $t=17$：$(6,9;0,1)$ 所以 $n=15, d=1$。\n$$\nE_{17}=\\frac{6}{15}=\\frac{2}{5},\\quad O_{17}-E_{17}=0-\\frac{2}{5}=-\\frac{2}{5},\\quad\nV_{17}=\\frac{2}{5}\\cdot\\frac{3}{5}\\cdot\\frac{14}{14}=\\frac{6}{25}.\n$$\n\n6) $t=19$：$(6,8;0,1)$ 所以 $n=14, d=1$。\n$$\nE_{19}=\\frac{6}{14}=\\frac{3}{7},\\quad O_{19}-E_{19}=0-\\frac{3}{7}=-\\frac{3}{7},\\quad\nV_{19}=\\frac{3}{7}\\cdot\\frac{4}{7}\\cdot\\frac{13}{13}=\\frac{12}{49}.\n$$\n\n7) $t=20$：$(6,7;1,0)$ 所以 $n=13, d=1$。\n$$\nE_{20}=\\frac{6}{13},\\quad O_{20}-E_{20}=1-\\frac{6}{13}=\\frac{7}{13},\\quad\nV_{20}=\\frac{6}{13}\\cdot\\frac{7}{13}\\cdot\\frac{12}{12}=\\frac{42}{169}.\n$$\n\n8) $t=21$：$(5,7;0,1)$ 所以 $n=12, d=1$。\n$$\nE_{21}=\\frac{5}{12},\\quad O_{21}-E_{21}=0-\\frac{5}{12}=-\\frac{5}{12},\\quad\nV_{21}=\\frac{5}{12}\\cdot\\frac{7}{12}\\cdot\\frac{11}{11}=\\frac{35}{144}.\n$$\n\n9) $t=22$：$(5,6;1,0)$ 所以 $n=11, d=1$。\n$$\nE_{22}=\\frac{5}{11},\\quad O_{22}-E_{22}=1-\\frac{5}{11}=\\frac{6}{11},\\quad\nV_{22}=\\frac{5}{11}\\cdot\\frac{6}{11}\\cdot\\frac{10}{10}=\\frac{30}{121}.\n$$\n\n10) $t=24$：$(4,6;0,1)$ 所以 $n=10, d=1$。\n$$\nE_{24}=\\frac{4}{10}=\\frac{2}{5},\\quad O_{24}-E_{24}=0-\\frac{2}{5}=-\\frac{2}{5},\\quad\nV_{24}=\\frac{2}{5}\\cdot\\frac{3}{5}\\cdot\\frac{9}{9}=\\frac{6}{25}.\n$$\n\n对差值和方差求和：\n$$\n\\sum_{i}(O_{i}-E_{i})=\\frac{1}{2}+\\frac{10}{19}-\\frac{4}{9}+\\frac{18}{17}-\\frac{2}{5}-\\frac{3}{7}+\\frac{7}{13}-\\frac{5}{12}+\\frac{6}{11}-\\frac{2}{5}\\approx 1.079372861,\n$$\n$$\n\\sum_{i}V_{i}=\\frac{1}{4}+\\frac{90}{361}+\\frac{20}{81}+\\frac{135}{289}+\\frac{6}{25}+\\frac{12}{49}+\\frac{42}{169}+\\frac{35}{144}+\\frac{30}{121}+\\frac{6}{25}\\approx 2.677757196.\n$$\n\n因此，\n$$\nX^{2}=\\frac{\\left(1.079372861\\right)^{2}}{2.677757196}\\approx 0.4350827.\n$$\n四舍五入到四位有效数字，得到 $X^{2}\\approx 0.4351$。", "answer": "$$\\boxed{0.4351}$$", "id": "1962148"}, {"introduction": "对数秩检验的关键优势在于其处理删失数据的能力。但如果我们忽略这些数据，会发生什么？本练习通过一个思想实验，让你对比标准的对数秩检验与一种仅分析未删失数据的“简化版”Wilcoxon秩和检验的结果[@problem_id:1962146]。这个对比将清晰地揭示不当处理删失数据所导致的潜在偏误，从而突显生存分析方法的必要性。", "problem": "在一项临床试验中，一种新的治疗药物（A组）与一种标准疗法（B组）进行比较，以评估其对患者生存时间的影响。共招募了16名患者，并随机分配到两个组中的一个，每组8名患者。主要终点是直到特定事件发生的时间（以月为单位）。一些患者失访或在观察期结束时未发生事件；这些被记录为删失观察值。\n\n两组的观察时间如下，其中`+`符号表示删失观察值：\n- **A组（新药）：** 21, 26, 31, 35+, 35+, 35+, 35+, 35+\n- **B组（标准疗法）：** 5, 10, 15, 18, 22, 27, 32, 38\n\n一位数据分析师提出了两种不同的方法来检验两组生存分布没有差异的原假设。\n1. 对数秩检验（log-rank test），这是分析此类带删失的时间-事件数据的标准方法。\n2. 一个“朴素的”Wilcoxon秩和检验（也称为Mann-Whitney U检验），*仅*应用于经历了事件的患者子集（即非删失观察值）。\n\n您的任务是计算每种方法的检验统计量。设 $Z$ 为对数秩检验的检验统计量，计算公式为 $Z = (\\sum(O_A - E_A)) / \\sqrt{\\sum V}$，其中 $O_A$ 是A组的观察事件数，$E_A$ 是预期事件数，$V$ 是方差。设 $U$ 为Wilcoxon秩和检验的检验统计量，定义为为每个组计算的两个可能的 $U$ 统计量中的最小值。\n\n计算 $(Z, U)$ 对的值。对于最终答案，$Z$ 的值应四舍五入到三位有效数字，$U$ 的值为精确整数。", "solution": "该问题要求根据提供的两组（A组和B组）的生存数据，计算两个统计检验值。\n\n**第1部分：朴素的Wilcoxon秩和检验（Mann-Whitney U检验）**\n\n此检验仅对发生事件的受试者进行。我们首先提取每组的事件时间。\n- A组事件时间：{21, 26, 31}。发生事件的受试者样本量为 $n_A = 3$。\n- B组事件时间：{5, 10, 15, 18, 22, 27, 32, 38}。发生事件的受试者样本量为 $n_B = 8$。\n\n接下来，我们将所有事件时间合并并从小到大排序。在这个朴素分析中，观察总数为 $N = n_A + n_B = 3 + 8 = 11$。\n\n| 时间 | 组 | 秩 |\n|------|-------|------|\n| 5    | B     | 1    |\n| 10   | B     | 2    |\n| 15   | B     | 3    |\n| 18   | B     | 4    |\n| 21   | A     | 5    |\n| 22   | B     | 6    |\n| 26   | A     | 7    |\n| 27   | B     | 8    |\n| 31   | A     | 9    |\n| 32   | B     | 10   |\n| 38   | B     | 11   |\n\n现在，我们计算每组的秩和。\n- A组的秩和 ($R_A$)：$5 + 7 + 9 = 21$。\n- B组的秩和 ($R_B$)：$1 + 2 + 3 + 4 + 6 + 8 + 10 + 11 = 45$。\n作为检验，总秩和应为 $\\frac{N(N+1)}{2} = \\frac{11(12)}{2} = 66$。而实际上，$R_A + R_B = 21 + 45 = 66$。\n\n每组的Mann-Whitney U统计量计算如下：\n$U_A = R_A - \\frac{n_A(n_A+1)}{2} = 21 - \\frac{3(3+1)}{2} = 21 - 6 = 15$。\n$U_B = R_B - \\frac{n_B(n_B+1)}{2} = 45 - \\frac{8(8+1)}{2} = 45 - 36 = 9$。\n作为检验，$U_A + U_B = 15 + 9 = 24$，这应该等于 $n_A n_B = 3 \\times 8 = 24$。计算是正确的。\n\n检验统计量 $U$ 是 $U_A$ 和 $U_B$ 中的最小值。\n$U = \\min(15, 9) = 9$。\n\n**第2部分：对数秩检验**\n\n此检验使用所有数据（包括删失观察值）来比较生存分布。原假设是两组的生存函数相同。我们在每个不同的事件时间点计算观察事件数（$O_{Aj}$）、预期事件数（$E_{Aj}$）和方差（$V_j$）。\n\n数据如下：\n- A组：{21, 26, 31, 35+, 35+, 35+, 35+, 35+} ($N_A=8$)\n- B组：{5, 10, 15, 18, 22, 27, 32, 38} ($N_B=8$)\n不同的事件时间点为：5, 10, 15, 18, 21, 22, 26, 27, 31, 32, 38。\n\n我们构建一个表格来记录在每个事件时间点 $t_j$ 的计算。\n- $n_{Aj}$：在 $t_j$ 之前A组的风险集人数。\n- $n_{Bj}$：在 $t_j$ 之前B组的风险集人数。\n- $N_j = n_{Aj} + n_{Bj}$：总风险集人数。\n- $d_j$：在 $t_j$ 时的总事件数。对于此数据集，所有事件时间点的 $d_j=1$。\n- $d_{Aj}$：在 $t_j$ 时A组的事件数。\n- $O_{Aj} = d_{Aj}$：A组的观察事件数。\n- $E_{Aj} = d_j \\frac{n_{Aj}}{N_j}$：在 $H_0$ 下A组的预期事件数。\n- $V_j = \\frac{n_{Aj} n_{Bj} d_j (N_j - d_j)}{N_j^2 (N_j-1)}$：在 $H_0$ 下 $O_{Aj}$ 的方差。\n\n| $t_j$ | $n_{Aj}$ | $n_{Bj}$ | $N_j$ | $d_j$ | $d_{Aj}$ | $O_{Aj}-E_{Aj}$ | $V_j$ |\n|-------|----------|----------|-------|-------|----------|-----------------------|-----------------------|\n| 5     | 8        | 8        | 16    | 1     | 0        | $0 - 8/16 = -0.5000$  | $\\frac{8 \\cdot 8 \\cdot 1 \\cdot 15}{16^2 \\cdot 15} = 0.2500$ |\n| 10    | 8        | 7        | 15    | 1     | 0        | $0 - 8/15 \\approx -0.5333$ | $\\frac{8 \\cdot 7 \\cdot 1 \\cdot 14}{15^2 \\cdot 14} \\approx 0.2489$ |\n| 15    | 8        | 6        | 14    | 1     | 0        | $0 - 8/14 \\approx -0.5714$ | $\\frac{8 \\cdot 6 \\cdot 1 \\cdot 13}{14^2 \\cdot 13} \\approx 0.2449$ |\n| 18    | 8        | 5        | 13    | 1     | 0        | $0 - 8/13 \\approx -0.6154$ | $\\frac{8 \\cdot 5 \\cdot 1 \\cdot 12}{13^2 \\cdot 12} \\approx 0.2367$ |\n| 21    | 8        | 4        | 12    | 1     | 1        | $1 - 8/12 \\approx 0.3333$  | $\\frac{8 \\cdot 4 \\cdot 1 \\cdot 11}{12^2 \\cdot 11} \\approx 0.2222$ |\n| 22    | 7        | 4        | 11    | 1     | 0        | $0 - 7/11 \\approx -0.6364$ | $\\frac{7 \\cdot 4 \\cdot 1 \\cdot 10}{11^2 \\cdot 10} \\approx 0.2314$ |\n| 26    | 7        | 3        | 10    | 1     | 1        | $1 - 7/10 = 0.3000$   | $\\frac{7 \\cdot 3 \\cdot 1 \\cdot 9}{10^2 \\cdot 9} = 0.2100$ |\n| 27    | 6        | 3        | 9     | 1     | 0        | $0 - 6/9 \\approx -0.6667$ | $\\frac{6 \\cdot 3 \\cdot 1 \\cdot 8}{9^2 \\cdot 8} \\approx 0.2222$ |\n| 31    | 6        | 2        | 8     | 1     | 1        | $1 - 6/8 = 0.2500$    | $\\frac{6 \\cdot 2 \\cdot 1 \\cdot 7}{8^2 \\cdot 7} = 0.1875$ |\n| 32    | 5        | 2        | 7     | 1     | 0        | $0 - 5/7 \\approx -0.7143$ | $\\frac{5 \\cdot 2 \\cdot 1 \\cdot 6}{7^2 \\cdot 6} \\approx 0.2041$ |\n| 38    | 0        | 1        | 1     | 1     | 0        | $0 - 0/1 = 0$         | $0$ (由于 $N_j-1=0$) |\n注意：在 $t=35$ 时，A组的5名受试者被删失，因此对于 $t=38$ 时的事件，$n_{Aj}=0$。\n\n现在我们对 $O_{Aj}-E_{Aj}$ 和 $V_j$ 两列求和。\n$\\sum(O_{Aj}-E_{Aj}) \\approx -0.5000 - 0.5333 - 0.5714 - 0.6154 + 0.3333 - 0.6364 + 0.3000 - 0.6667 + 0.2500 - 0.7143 + 0 = -3.3542$\n\n$\\sum V_j \\approx 0.2500 + 0.2489 + 0.2449 + 0.2367 + 0.2222 + 0.2314 + 0.2100 + 0.2222 + 0.1875 + 0.2041 + 0 = 2.2579$\n\n对数秩检验统计量 $Z$ 为：\n$Z = \\frac{\\sum(O_{Aj}-E_{Aj})}{\\sqrt{\\sum V_j}} = \\frac{-3.3542}{\\sqrt{2.2579}} \\approx \\frac{-3.3542}{1.50263} \\approx -2.2322$\n\n四舍五入到三位有效数字，$Z = -2.23$。\n\n数值对 $(Z, U)$ 是 $(-2.23, 9)$。", "answer": "$$\\boxed{\\begin{pmatrix} -2.23  9 \\end{pmatrix}}$$", "id": "1962146"}, {"introduction": "对数秩检验的p值通常通过卡方分布进行近似计算，但这依赖于大样本假设。当样本量很小时，我们如何进行精确推断？本练习将带你深入了解对数秩检验的非参数本质，通过构建一个精确的置换分布来计算p值[@problem_id:1962134]。这种方法摆脱了对渐近理论的依赖，让你领会统计推断的基本原理。", "problem": "在一项小型临床试验中，正在将一种新疗法（A组）与对照组（B组）进行比较。该研究共招募了六名受试者，其中三名被随机分配到A组，三名被分配到B组。该研究对受试者进行长期跟踪，记录发生特定不良事件的时间，或者如果他们在没有发生事件的情况下退出研究（删失），则记录他们最后一次随访的时间。\n\n所有六名受试者的综合数据如下，其中时间以月为单位，状态为“事件”或“删失”：\n- 受试者1：(3, 事件)\n- 受试者2：(5, 事件)\n- 受试者3：(6, 删失)\n- 受试者4：(8, 事件)\n- 受试者5：(10, 删失)\n- 受试者6：(12, 事件)\n\n观察到的受试者分组情况如下：\n- A组（治疗组）：结果为 (5, 事件)、(6, 删失) 和 (12, 事件) 的受试者。\n- B组（对照组）：结果为 (3, 事件)、(8, 事件) 和 (10, 删失) 的受试者。\n\n为了检验两组之间事件时间分布没有差异的原假设，您将进行精确对数秩检验。这涉及到为每一种可能的受试者分组计算对数秩统计量的分子 $U = \\sum_{j} (O_j - E_j)$。\n\n通过构建统计量 $U$ 的精确置换分布，计算观测数据的双边p值。将您的最终答案四舍五入到四位有效数字。", "solution": "我们将六名受试者按时间排序：$t_{1}=3$ (事件)，$t_{2}=5$ (事件)，$t_{3}=6$ (删失)，$t_{4}=8$ (事件)，$t_{5}=10$ (删失)，$t_{6}=12$ (事件)。在每个事件时间 $j$，对数秩分子的值为 $O_{j}-E_{j}$，其中 $O_{j}$ 是A组的事件数，$E_{j}=d_{j}\\,n_{Aj}/n_{j}$。这里，$d_{j}$ 是在时间 $j$ 发生的事件数，$n_{j}$ 是在时间 $j$ 之前处于风险中的总人数，$n_{Aj}$ 是在时间 $j$ 之前A组处于风险中的人数。在时间 $t_{1},t_{2},t_{4},t_{6}$ 有 $d_{j}=1$；在 $t_{3},t_{5}$ 的删失数据贡献为零。\n\n设 $a_{i}\\in\\{0,1\\}$ 表示受试者 $i$ 是否在A组，且 $\\sum_{i=1}^{6}a_{i}=3$。那么：\n- 在 $t_{1}=3$ 时：$n_{1}=6$，$n_{A1}=3$，$E_{1}=1\\cdot(3/6)=\\frac{1}{2}$，$O_{1}=a_{1}$，所以贡献为 $a_{1}-\\frac{1}{2}$。\n- 在 $t_{2}=5$ 时：$n_{2}=5$，$n_{A2}=3-a_{1}$，$E_{2}=\\frac{3-a_{1}}{5}$，$O_{2}=a_{2}$，所以贡献为 $a_{2}-\\frac{3-a_{1}}{5}$。\n- 在 $t_{3}=6$ 时 (删失)：无贡献。\n- 在 $t_{4}=8$ 时：$n_{3}=3$，$n_{A3}=3-a_{1}-a_{2}-a_{3}$，$E_{3}=\\frac{3-a_{1}-a_{2}-a_{3}}{3}$，$O_{3}=a_{4}$，所以贡献为 $a_{4}-\\frac{3-a_{1}-a_{2}-a_{3}}{3}$。\n- 在 $t_{5}=10$ 时 (删失)：无贡献。\n- 在 $t_{6}=12$ 时：$n_{4}=1$，$E_{4}=a_{6}$，$O_{4}=a_{6}$，所以贡献为 $0$。\n\n因此，\n$$\nU=(a_{1}-\\tfrac{1}{2})+\\Bigl(a_{2}-\\tfrac{3-a_{1}}{5}\\Bigr)+\\Bigl(a_{4}-\\tfrac{3-a_{1}-a_{2}-a_{3}}{3}\\Bigr),\n$$\n化简为\n$$\nU=\\tfrac{23}{15}a_{1}+\\tfrac{4}{3}a_{2}+\\tfrac{1}{3}a_{3}+a_{4}-\\tfrac{21}{10}.\n$$\n\n观察到的分配是A组：(5, 事件)、(6, 删失) 和 (12, 事件)，即 $(a_{1},a_{2},a_{3},a_{4},a_{5},a_{6})=(0,1,1,0,0,1)$。因此\n$$\nU_{\\text{obs}}=\\tfrac{4}{3}\\cdot 1+\\tfrac{1}{3}\\cdot 1-\\tfrac{21}{10}=\\tfrac{5}{3}-\\tfrac{21}{10}=-\\tfrac{13}{30}.\n$$\n\n为了构建精确置换分布，我们枚举所有 $\\binom{6}{3}=20$ 种分配。因为 $U$ 只依赖于 $(a_{1},a_{2},a_{3},a_{4})$ 且 $\\sum_{i=1}^{6}a_{i}=3$，所以前四项中A组的受试者数量 $k$ 的可能取值为 $k\\in\\{1,2,3\\}$。对于每个满足 $1\\leq |S|\\leq 3$ 的子集 $S\\subset\\{1,2,3,4\\}$，$U(S)=\\sum_{i\\in S}w_{i}-c$，其中权重为 $w_{1}=\\tfrac{23}{15}$，$w_{2}=\\tfrac{4}{3}$，$w_{3}=\\tfrac{1}{3}$，$w_{4}=1$，常数 $c=\\tfrac{21}{10}$。在所有20种分配中，这些值（及其重数）是：\n- 当 $|S|=1$ 时：$-\\tfrac{17}{30}$, $-\\tfrac{23}{30}$, $-\\tfrac{53}{30}$, $-\\tfrac{33}{30}$ (每个计数值为 $1$)。\n- 当 $|S|=2$ 时：$\\tfrac{23}{30}$, $-\\tfrac{7}{30}$, $\\tfrac{13}{30}$, $-\\tfrac{13}{30}$, $\\tfrac{7}{30}$, $-\\tfrac{23}{30}$ (每个计数值为 $2$)。\n- 当 $|S|=3$ 时：$\\tfrac{33}{30}$, $\\tfrac{53}{30}$, $\\tfrac{23}{30}$, $\\tfrac{17}{30}$ (每个计数值为 $1$)。\n\n汇总后，$U$ 的完整多重集及其计数值为：$\\tfrac{53}{30}(1)$, $\\tfrac{33}{30}(1)$, $\\tfrac{23}{30}(3)$, $\\tfrac{17}{30}(1)$, $\\tfrac{13}{30}(2)$, $\\tfrac{7}{30}(2)$, $-\\tfrac{7}{30}(2)$, $-\\tfrac{13}{30}(2)$, $-\\tfrac{17}{30}(1)$, $-\\tfrac{23}{30}(3)$, $-\\tfrac{33}{30}(1)$, $-\\tfrac{53}{30}(1)$。\n\n由于 $|U_{\\text{obs}}|=\\tfrac{13}{30}$，双边p值是满足 $|U|\\geq \\tfrac{13}{30}$ 的比例。满足 $|U|  \\tfrac{13}{30}$ 的值只有 $\\pm\\tfrac{7}{30}$（总计数值为 $4$）。因此p值为\n$$\np=\\frac{20-4}{20}=\\frac{16}{20}=0.8.\n$$\n\n四舍五入到四位有效数字，p值为 $0.8000$。", "answer": "$$\\boxed{0.8000}$$", "id": "1962134"}]}