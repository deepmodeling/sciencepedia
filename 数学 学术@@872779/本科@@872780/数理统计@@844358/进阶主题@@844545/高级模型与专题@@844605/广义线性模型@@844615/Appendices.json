{"hands_on_practices": [{"introduction": "理解如何构建对数似然函数是掌握广义线性模型的第一步，因为它是参数估计的基础。这个练习 [@problem_id:1919840] 将引导你为一个二项回归模型推导该函数，这是分析比例数据的常见情景。通过这个过程，你将具体理解概率分布、连接函数以及我们旨在估计的参数之间的联系。", "problem": "在广义线性模型 (GLM) 的背景下，考虑一个用于分析计数数据的二项回归模型。对于每个观测单元 $i$，我们在已知的总试验次数 $n_i$ 中观测到“成功”的次数为 $y_i$。该模型假设随机变量 $Y_i$ 服从二项分布，$Y_i \\sim \\text{Binomial}(n_i, p_i)$，其中 $p_i$ 是单元 $i$ 中单次试验的成功概率。\n\n该模型通过一个 logit 链接函数将成功概率 $p_i$ 与一组解释变量（协变量）$\\mathbf{x}_i$ 联系起来。具体来说，该关系由下式给出：\n$$ \\text{logit}(p_i) = \\ln\\left(\\frac{p_i}{1-p_i}\\right) = \\eta_i $$\n其中 $\\eta_i = \\mathbf{x}_i^T \\boldsymbol{\\beta}$ 是线性预测子，$\\boldsymbol{\\beta}$ 是回归系数的向量。\n\n你的任务是推导来自单元 $i$ 的单个观测值 $y_i$ 的对数似然函数。将你的最终答案（记为 $\\ell(\\boldsymbol{\\beta}; y_i)$）用观测到的计数 $y_i$、总试验次数 $n_i$ 和线性预测子 $\\eta_i$ 来表示。", "solution": "对于单个观测值 $y_i$ 且 $Y_i \\sim \\text{Binomial}(n_i, p_i)$，其概率质量函数为\n$$\n\\Pr(Y_i = y_i) = \\binom{n_i}{y_i} p_i^{y_i} (1 - p_i)^{n_i - y_i}.\n$$\n该观测值的对数似然为\n$$\n\\ell(\\boldsymbol{\\beta}; y_i) = \\ln \\binom{n_i}{y_i} + y_i \\ln p_i + (n_i - y_i)\\ln(1 - p_i).\n$$\n使用 logit 链接，$\\eta_i = \\ln\\!\\left(\\frac{p_i}{1 - p_i}\\right)$，因此逆链接函数给出\n$$\np_i = \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}, \\qquad 1 - p_i = \\frac{1}{1 + \\exp(\\eta_i)}.\n$$\n因此，\n$$\n\\ln p_i = \\eta_i - \\ln\\!\\left(1 + \\exp(\\eta_i)\\right), \\qquad \\ln(1 - p_i) = -\\ln\\!\\left(1 + \\exp(\\eta_i)\\right).\n$$\n代入对数似然函数中，\n$$\n\\ell(\\boldsymbol{\\beta}; y_i) = \\ln \\binom{n_i}{y_i} + y_i\\left[\\eta_i - \\ln\\!\\left(1 + \\exp(\\eta_i)\\right)\\right] + (n_i - y_i)\\left[-\\ln\\!\\left(1 + \\exp(\\eta_i)\\right)\\right].\n$$\n合并同类项，\n$$\n\\ell(\\boldsymbol{\\beta}; y_i) = \\ln \\binom{n_i}{y_i} + y_i \\eta_i - n_i \\ln\\!\\left(1 + \\exp(\\eta_i)\\right).\n$$\n这就是用 $y_i$、$n_i$ 和 $\\eta_i$ 表示的所求对数似然函数。", "answer": "$$\\boxed{\\ln\\binom{n_i}{y_i} + y_i \\eta_i - n_i \\ln\\!\\left(1 + \\exp(\\eta_i)\\right)}$$", "id": "1919840"}, {"introduction": "模型拟合后，一项关键任务是评估其充分性。对于像泊松回归这样的计数数据模型，一个核心假设是均值等于方差，但这在实践中常常被违反——这种现象称为过度离散。这个实践问题 [@problem_id:1919857] 提供了一种通过计算离散参数来诊断过度离散的动手方法，这是任何应用统计学家的必备技能。", "problem": "一位生物统计学家正在分析一个患者队列在一年期间内观察到的未愈合溃疡数量的数据。由于数据是计数类型，因此采用泊松回归模型（一种广义线性模型，GLM）来理解溃疡计数与几个患者特异性协变量之间的关系。\n\n该研究共包括 $n = 120$ 名患者。拟合后的模型包含一个截距项以及 $k=7$ 个不同的预测变量。运行回归分析后，统计软件报告的残差离差为 $208.5$。\n\n在标准泊松模型中，响应变量的方差被假定为其均值。当观测到的方差大于均值时，就会出现过度离散。检查过度离散的一个简单方法是计算离散参数 $\\phi$ 的估计值。在一个没有过度离散的理想泊松模型中，此参数等于1。使用所提供的信息，计算该模型的估计离散参数 $\\hat{\\phi}$。将结果以数值形式报告，并四舍五入到三位有效数字。", "solution": "在泊松广义线性模型(GLM)中，根据等离散假设，残差离差 $D$ 近似服从卡方分布($\\chi^{2}$ 分布)，其残差自由度为 $\\text{df} = n - p$，其中 $p$ 是估计参数的数量（包括截距）。在评估过度离散时，离散参数的一个估计量是\n$$\n\\hat{\\phi} = \\frac{D}{\\text{df}} = \\frac{D}{n - p}.\n$$\n在本例中，$n = 120$，模型有一个截距项和 $k = 7$ 个预测变量，因此\n$$\np = 1 + k = 1 + 7 = 8, \\quad \\text{df} = n - p = 120 - 8 = 112.\n$$\n已知残差离差 $D = 208.5$，我们计算\n$$\n\\hat{\\phi} = \\frac{208.5}{112} = 1.861607142857\\ldots\n$$\n四舍五入到三位有效数字，结果是\n$$\n\\hat{\\phi} \\approx 1.86.\n$$", "answer": "$$\\boxed{1.86}$$", "id": "1919857"}, {"introduction": "图形诊断是发现数值摘要可能忽略的细微问题的不可或缺的工具。一个精心构建的残差图可以揭示模型的核心假设是否得到满足。在这个问题中 [@problem_id:1919838]，你将学习如何解读残差中的一个特定的系统性模式，并将这一视觉线索与模型线性预测部分的根本性错误设定联系起来。", "problem": "一位生态学家正在研究决定一种稀有高山花卉 *Florus calculus* 在一个山脉中存在与否的因素。对于一组 $n$ 个随机选择的一平方米样方，她记录了该花卉是存在 ($y_i=1$) 还是不存在 ($y_i=0$)，并测量了土壤酸度，以其pH值 ($x_i$) 来量化。\n\n她假设花卉存在的概率 $\\mu_i = P(y_i=1)$ 与土壤pH值有关。为了对此进行建模，她拟合了一个广义线性模型 (GLM)，假设响应变量 $y_i$ 服从伯努利分布。她的模型的系统性成分在预测变量中是线性的，并且她使用了标准的logit链接函数。因此，拟合的模型为：\n$$\n\\ln\\left(\\frac{\\mu_i}{1-\\mu_i}\\right) = \\beta_0 + \\beta_1 x_i\n$$\n在拟合模型并获得参数估计值后，她绘制了一张偏差残差与相应拟合线性预测变量 $\\hat{\\eta}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_i$ 的诊断图。她观察到该图中有一个清晰且对称的U形模式，其中对于非常低和非常高的 $\\hat{\\eta}_i$ 值，残差主要为正，而对于中间的 $\\hat{\\eta}_i$ 值，残差主要为负。\n\n基于这一特定的诊断发现，她的初始模型中最可能的误设是以下哪一项？\n\nA. 响应的方差大于伯努利模型所假设的方差（过度离散）。\n\nB. 观测值 $y_i$ 之间的独立性假设被违反。\n\nC. 线性预测变量与土壤pH值之间的真实关系是非线性的，通过包含一个二次项可以更好地捕捉。\n\nD. logit链接函数不合适，应使用不同的链接函数，如probit或互补log-log。\n\nE. 数据集包含一个或多个强影响离群观测值，这些值正在扭曲结果。", "solution": "广义线性模型假设 $y_i \\sim \\text{Bernoulli}(\\mu_i)$，使用logit链接和线性预测变量\n$$\n\\eta_i=\\ln\\left(\\frac{\\mu_i}{1-\\mu_i}\\right)=\\beta_0+\\beta_1 x_i.\n$$\n拟合模型产生偏差残差 $r_i$ 对 $\\hat{\\eta}_i=\\hat{\\beta}_0+\\hat{\\beta}_1 x_i$ 的图。对于一个正确设定的GLM（正确的链接函数和正确的线性预测变量形式），残差不应显示出对 $\\hat{\\eta}_i$ 的系统性依赖；它们应大约以零为中心，并且作为 $\\hat{\\eta}_i$ 的函数具有大致恒定的离散程度。\n\n对于伯努利响应，观测 $i$ 的偏差残差为\n$$\nr_i=\\operatorname{sign}(y_i-\\hat{\\mu}_i)\\sqrt{2\\left[y_i\\ln\\left(\\frac{y_i}{\\hat{\\mu}_i}\\right)+(1-y_i)\\ln\\left(\\frac{1-y_i}{1-\\hat{\\mu}_i}\\right)\\right]},\n$$\n其中 $\\hat{\\mu}_i=\\exp(\\hat{\\eta}_i)\\big/\\left(1+\\exp(\\hat{\\eta}_i)\\right)$，并使用约定 $0\\ln(0/\\cdot)=0$。\n\n观察到的诊断模式是一个对称的U形：对于非常低和非常高的 $\\hat{\\eta}_i$，残差主要为正，而对于中间的 $\\hat{\\eta}_i$，残差主要为负。这表明残差对 $\\hat{\\eta}_i$ 存在一种关于某个中心对称的系统性依赖，这是系统性成分中缺少偶数阶项（最简单的是二次项）的特征。具体来说，如果在链接尺度上的真实关系是\n$$\n\\eta_i^{\\ast}=\\beta_0^{\\ast}+\\beta_1^{\\ast}x_i+\\beta_2^{\\ast}x_i^{2},\n$$\n且 $\\beta_2^{\\ast}>0$（凸曲率），那么一个误设的线性模型 $\\eta_i=\\beta_0+\\beta_1 x_i$ 将倾向于在 $x_i$ 的极端值（因此也是 $\\hat{\\eta}_i$ 的极端值）处欠拟合，而在中心附近过拟合。在极端值处的欠拟合导致当真实 $\\mu_i$ 更接近 $0$ 或 $1$ 时，$\\hat{\\mu}_i$ 过分接近 $1/2$，这在低和高 $\\hat{\\eta}_i$ 处都会产生主要为正的偏差残差。在中间的过拟合则在那里产生主要为负的残差。最终的残差对 $\\hat{\\eta}_i$ 的图显示了所描述的对称U形。\n\n现在考虑并排除其他选项：\n- 过度离散 (A) 会夸大残差的方差，但不会引起对 $\\hat{\\eta}_i$ 的系统性、对称的U形依赖；如果均值结构是正确的，给定 $\\hat{\\eta}_i$ 的平均残差仍将近似为零。\n- 观测值之间的依赖性 (B) 可以在残差中产生聚类或游程，但通常不会产生作为拟合线性预测变量函数的对称U形模式。\n- 不合适的链接函数 (D) 通常会产生残差对预测变量或拟合值的系统性、通常是单调或S形的模式，而不是以预测变量域为中心的对称U形。此外，logit与probit或互补log-log链接函数的差异很少能产生这里看到的特定对称U形。\n- 影响性离群值 (E) 表现为孤立的大幅值残差，而不是在 $\\hat{\\eta}_i$ 的整个范围内呈现平滑、对称的U形模式。\n\n因此，由残差对 $\\hat{\\eta}_i$ 的对称U形模式所指示的最可能的误设是，$x_i$ 在链接尺度上存在非线性效应，而这种效应通过在线性预测变量中包含一个二次项可以更好地被捕捉。\n\n因此，正确选项是C。", "answer": "$$\\boxed{C}$$", "id": "1919838"}]}