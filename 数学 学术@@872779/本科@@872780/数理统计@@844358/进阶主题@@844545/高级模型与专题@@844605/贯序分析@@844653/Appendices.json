{"hands_on_practices": [{"introduction": "第一个练习将带你进入序贯概率比检验（SPRT）的核心决策过程。通过一个检验随机数生成器的假设场景，你将学习如何根据观测数据计算似然比，并利用 Wald 的决策边界来决定是接受原假设、拒绝原假设，还是继续收集数据。这个练习旨在巩固应用SPRT的基本步骤([@problem_id:1954198])。", "problem": "一位软件工程师正在开发一种新的伪随机数生成器（PRNG），该生成器设计用于输出0到9的单个数字。为了验证其均匀性，设立了一项初步的质量保证测试。该测试专注于一个特定的数字“7”，怀疑该数字存在一个错误，导致其在均匀分布下出现的频率高于预期。\n\n采用序贯概率比检验（SPRT）来在这两个假设之间做出决策：\n- 零假设 $H_0$：该PRNG是均匀的，生成“7”的概率为 $p_0 = 0.1$。\n- 备择假设 $H_1$：该错误存在，生成“7”的概率提高到 $p_1 = 0.2$。\n\n该检验的设计第一类错误概率（当 $H_0$ 为真时拒绝 $H_0$）为 $\\alpha = 0.05$，第二类错误概率（当 $H_1$ 为真时未能拒绝 $H_0$）为 $\\beta = 0.10$。\n\n在运行PRNG生成40个数字后，数字“7”出现了7次。根据这一观察，SPRT在此阶段的结论是什么？\n\nA. 接受零假设 $H_0$。\n\nB. 拒绝零假设 $H_0$。\n\nC. 继续抽样。\n\nD. 两种假设的可能性相等。\n\nE. 检验参数在此场景下无效。", "solution": "我们将每次输出建模为一个伯努利试验 $X_{i}$，它指示数字是否为7（$X_{i}=1$）或不是7（$X_{i}=0$），其成功概率为 $p$。我们使用序贯概率比检验（SPRT）来检验假设 $H_{0}: p=p_{0}=0.1$ 与 $H_{1}: p=p_{1}=0.2$。\n\n对于包含 $x$ 次成功的 $n$ 次观测，在概率 $p$ 下的似然函数（忽略结果的顺序）为 $L(p)\\propto p^{x}(1-p)^{n-x}$。似然比为\n$$\n\\Lambda_{n}=\\frac{L(p_{1})}{L(p_{0})}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{x}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{n-x}.\n$$\nSPRT 使用如下阈值\n$$\nA=\\frac{1-\\beta}{\\alpha},\\qquad B=\\frac{\\beta}{1-\\alpha},\n$$\n其决策规则为：若 $\\Lambda_{n}\\geq A$，则拒绝 $H_{0}$；若 $\\Lambda_{n}\\leq B$，则接受 $H_{0}$；否则，继续抽样。\n\n本题中，$\\alpha=0.05$，$\\beta=0.10$，$p_{0}=0.1$，$p_{1}=0.2$，$n=40$，且 $x=7$。因此\n$$\nA=\\frac{1-0.10}{0.05}=18,\\qquad B=\\frac{0.10}{1-0.05}=\\frac{2}{19}.\n$$\n计算似然比：\n$$\n\\Lambda_{40}=\\left(\\frac{0.2}{0.1}\\right)^{7}\\left(\\frac{1-0.2}{1-0.1}\\right)^{33}=2^{7}\\left(\\frac{8}{9}\\right)^{33}.\n$$\n等价地，取对数形式，\n$$\n\\ln \\Lambda_{40}=7\\ln 2+33\\ln\\!\\left(\\frac{8}{9}\\right)=7\\ln 2+33\\left(3\\ln 2-2\\ln 3\\right)=106\\ln 2-66\\ln 3.\n$$\n数值上，\n$$\n\\ln \\Lambda_{40}\\approx 0.965190,\\quad \\text{so}\\quad \\Lambda_{40}\\approx \\exp(0.965190)\\approx 2.625.\n$$\n与阈值进行比较：$B=\\frac{2}{19}\\approx 0.105263$ 且 $A=18$。由于 $B  \\Lambda_{40}  A$（即 $0.105263  2.625  18$），证据尚不充分，我们必须继续抽样。", "answer": "$$\\boxed{C}$$", "id": "1954198"}, {"introduction": "了解了如何使用SPRT做出决策后，一个关键的实际问题是：我们平均需要多少样本？本练习聚焦于SPRT的效率，要求你计算其关键性能指标——平均样本数（ASN）。通过运用 Wald 的近似公式，你将学会量化在特定真实情况下，序贯检验所需的预期样本量([@problem_id:1954190])。", "problem": "一家半导体制造商正在评估一种旨在降低微芯片次品率的新制造工艺。旧工艺的历史次品率为 $p_0 = 0.10$。如果新工艺能达到 $p_1 = 0.05$ 的次品率，则认为它是一项显著的改进。\n\n为了在原假设 $H_0: p = p_0$ 和备择假设 $H_1: p = p_1$ 之间做出决策，质量控制团队采用了序贯概率比检验 (SPRT)。该检验的设计第一类错误概率为 $\\alpha = 0.05$（错误地得出新工艺是改进的结论），第二类错误概率为 $\\beta = 0.10$（在改进确实发生时错误地未能检测到）。\n\n每个微芯片的测试都是一个独立的伯努利试验，其中“1”表示次品芯片，“0”表示功能正常的芯片。假设新工艺的真实次品率实际上仍为 $p_0 = 0.10$，计算近似的平均样本数 (ASN)，即为得出结论需要测试的微芯片的期望数量。\n\n将你的最终答案四舍五入到三位有效数字。", "solution": "我们使用 SPRT 检验 $H_{0}: p=p_{0}$ 与 $H_{1}: p=p_{1}$。对于独立的伯努利($p$)观测值 $X_{i}\\in\\{0,1\\}$，单次观测的对数似然比增量为\n$$\nY=\\ln\\Lambda_{1}=X\\ln\\!\\left(\\frac{p_{1}}{p_{0}}\\right)+(1-X)\\ln\\!\\left(\\frac{1-p_{1}}{1-p_{0}}\\right).\n$$\n在 $H_{0}$ 下，其期望值为\n$$\n\\mu_{0}=E_{0}[Y]=p_{0}\\ln\\!\\left(\\frac{p_{1}}{p_{0}}\\right)+(1-p_{0})\\ln\\!\\left(\\frac{1-p_{1}}{1-p_{0}}\\right).\n$$\n当第一类和第二类错误分别为 $\\alpha$ 和 $\\beta$ 时，SPRT 的似然比边界为 $A=\\frac{1-\\beta}{\\alpha}$ 和 $B=\\frac{\\beta}{1-\\alpha}$，因此 $a=\\ln A$ 和 $b=\\ln B$。Wald 对 $H_{0}$ 下平均样本数的近似值为\n$$\nE_{0}[N]\\approx \\frac{(1-\\alpha)\\,b+\\alpha\\,a}{\\mu_{0}}.\n$$\n代入 $p_{0}=0.10$，$p_{1}=0.05$，$\\alpha=0.05$，$\\beta=0.10$。计算\n$$\na=\\ln\\!\\left(\\frac{1-\\beta}{\\alpha}\\right)=\\ln(18),\\quad b=\\ln\\!\\left(\\frac{\\beta}{1-\\alpha}\\right)=\\ln\\!\\left(\\frac{0.10}{0.95}\\right),\n$$\n$$\n\\mu_{0}=0.10\\ln\\!\\left(\\frac{0.05}{0.10}\\right)+0.90\\ln\\!\\left(\\frac{0.95}{0.90}\\right)=0.10\\ln\\!\\left(\\frac{1}{2}\\right)+0.90\\ln\\!\\left(\\frac{19}{18}\\right).\n$$\n数值计算如下：\n$$\na=\\ln(18)\\approx 2.890371758,\\quad b=\\ln\\!\\left(\\frac{0.10}{0.95}\\right)\\approx -2.251291799,\n$$\n$$\n\\mu_{0}\\approx 0.10(-0.693147181)+0.90(0.054067221)\\approx -0.020654219.\n$$\n因此，\n$$\nE_{0}[N]\\approx \\frac{0.95\\cdot(-2.251291799)+0.05\\cdot 2.890371758}{-0.020654219}\\approx \\frac{-1.994208621}{-0.020654219}\\approx 96.552,\n$$\n四舍五入到三位有效数字为 96.6。", "answer": "$$\\boxed{96.6}$$", "id": "1954190"}, {"introduction": "序贯分析不仅限于假设检验，在估计问题中也同样强大。本练习将介绍 Stein 的两阶段抽样程序，这是一种在总体方差未知时，构造具有预设宽度置信区间的巧妙方法——这是固定样本量方法无法保证的。通过这个练习，你将看到序贯思想如何被用于确保统计估计的精度([@problem_id:1954192])。", "problem": "一个材料工程团队正在为航空航天应用开发一种新型轻质复合材料。认证的一个关键参数是材料的极限抗压强度。根据以往对类似材料的经验，该团队将任何给定样本 $X_i$ 的抗压强度建模为一个服从正态分布 $N(\\mu, \\sigma^2)$ 的随机变量，其中平均强度 $\\mu$ 和方差 $\\sigma^2$ 均为未知。\n\n该团队的目标是通过构建一个预先指定的固定宽度的置信区间来估计平均抗压强度 $\\mu$。具体来说，他们要求 $\\mu$ 的 95% 置信区间的总宽度不超过 $2d = 10$ MPa。由于总体方差 $\\sigma^2$ 未知，固定样本量的实验无法保证这一精度。\n\n为了解决这个问题，该团队采用了 Stein 的两阶段抽样程序：\n1.  生产并测试一个包含 $n_0 = 20$ 个样本的引导批次，以获得方差的初始估计值 $S_{20}^2$。\n2.  使用此引导方差估计值来确定达到所需置信区间宽度所需的总样本数 $N$。\n3.  如果 $N  n_0$，则额外测试 $N - n_0$ 个样本。\n4.  使用所有 $N$ 个样本计算 $\\mu$ 的最终置信区间。\n\n确定总样本量 $N$ 的规则基于引导研究的结果。已知在 95% 置信水平下，自由度为 19 的 t 分布的临界值为 $t_{19, 0.025} = 2.093$。\n\n计算此程序所需的大约期望总样本量 $E[N]$。在本次计算中，假设材料抗压强度的真实（但工程师未知）标准差为 $\\sigma = 25$ MPa。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们建立模型 $X_{i} \\sim N(\\mu,\\sigma^{2})$，其中 $\\mu$ 和 $\\sigma^{2}$ 均未知。对于基于 $N$ 个观测值的 $\\mu$ 的双侧置信区间，其半宽度为\n$$\nh_{N} \\equiv t_{N-1,\\,1-\\alpha/2}\\,\\frac{S_{N}}{\\sqrt{N}},\n$$\n且要求的总宽度约束 $2h_{N} \\leq 2d$ 等价于 $h_{N} \\leq d$。在 Stein 的两阶段抽样程序中，当引导样本量为 $n_{0}$ 时，一个常见的规则将总样本量设定为\n$$\nN \\;=\\; \\max\\!\\left\\{\\,n_{0},\\; \\left\\lceil \\frac{t_{n_{0}-1,\\,1-\\alpha/2}^{2}\\,S_{n_{0}}^{2}}{d^{2}} \\right\\rceil \\right\\},\n$$\n因此，引导估计值 $S_{n_{0}}^{2}$ 和 $t_{n_{0}-1,\\,1-\\alpha/2}$ 决定了 $N$。这里 $n_{0}=20$，$\\alpha=0.05$，并且给定 $t_{19,\\,0.025}=2.093$。目标半宽度为 $d=\\frac{10}{2}=5$ MPa。\n\n为了计算近似的期望总样本量 $E[N]$，我们利用在真实标准差 $\\sigma$ 下，引导方差满足\n$$\n\\frac{(n_{0}-1)S_{n_{0}}^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n_{0}-1} \\quad \\Rightarrow \\quad E[S_{n_{0}}^{2}] = \\sigma^{2}.\n$$\n通过用其均值 $\\sigma^{2}$ 替换 $S_{n_{0}}^{2}$ 并忽略期望值的向上取整函数，我们近似得到期望值为\n$$\nE[N] \\approx \\max\\!\\left\\{\\,n_{0},\\; \\frac{t_{n_{0}-1,\\,1-\\alpha/2}^{2}\\,\\sigma^{2}}{d^{2}} \\right\\}.\n$$\n当 $\\sigma=25$ MPa, $n_{0}=20$, $d=5$ MPa, 且 $t_{19,\\,0.025}=2.093$ 时，\n$$\n\\frac{t_{19,\\,0.025}^{2}\\,\\sigma^{2}}{d^{2}}\n= \\frac{(2.093)^{2}\\,(25)^{2}}{(5)^{2}}\n= (2.093)^{2}\\times \\frac{625}{25}\n= (2.093)^{2}\\times 25.\n$$\n计算平方：\n$$\n(2.093)^{2} = 4.380649,\n$$\n因此\n$$\n(2.093)^{2}\\times 25 = 4.380649 \\times 25 = 109.516225.\n$$\n由于 $109.516225  n_{0}=20$，最大值由该值取得，因此\n$$\nE[N] \\approx 109.516225.\n$$\n四舍五入到四位有效数字得到 $109.5$。", "answer": "$$\\boxed{109.5}$$", "id": "1954192"}]}