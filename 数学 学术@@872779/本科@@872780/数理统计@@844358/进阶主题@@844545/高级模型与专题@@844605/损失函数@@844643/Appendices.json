{"hands_on_practices": [{"introduction": "在统计学中，我们如何为一组数据找到最具代表性的中心点？平方误差损失是一种常见选择，但它对异常值非常敏感。本练习将介绍一种更稳健的替代方案——绝对误差损失（L1损失），它通过最小化数据点与估计值之间绝对差值的总和来寻找最优估计。通过这个练习，你将发现这种损失函数与数据集的中位数之间存在着深刻的联系。[@problem_id:1931715]", "problem": "在统计估计领域，一个常见的任务是为一组测量值确定一个单一的代表值。这个值的选择通常取决于一个“损失函数”，该函数量化了估计值不准确所带来的惩罚。\n\n一位工程师正在校准一个新型接近传感器。对于一个放置在固定的未知距离处的目标，该传感器报告了三个测量值：$x_1 = 1$、$x_2 = 5$ 和 $x_3 = 9$，单位均为毫米 (mm)。工程师决定找到一个单一的常数估计值 $\\hat{\\theta}$，以最佳地代表真实距离。“最佳”的标准是该估计值必须最小化绝对误差之和。这个损失函数 $L(\\hat{\\theta})$ 定义为估计值 $\\hat{\\theta}$ 与每个单独测量值 $x_i$ 之间的绝对差之和。\n\n确定使该损失函数最小化的估计值 $\\hat{\\theta}$ 的精确值。以毫米为单位，给出您的数值答案。", "solution": "我们需要最小化与一个常数估计值之间的绝对偏差之和。将估计值 $\\hat{\\theta}$ 的损失函数定义为\n$$\nL(\\hat{\\theta})=\\sum_{i=1}^{3}|\\hat{\\theta}-x_{i}|=|\\hat{\\theta}-1|+|\\hat{\\theta}-5|+|\\hat{\\theta}-9|.\n$$\n估计理论中的一个标准结论是，数据的任意中位数都能最小化绝对偏差之和。为了直接验证这一点，我们将测量值排序为 $1, 5, 9$，并考虑在点 $\\hat{\\theta}\\in\\{1,5,9\\}$ 之外，$L$ 关于 $\\hat{\\theta}$ 的导数。使用 $\\frac{d}{d\\hat{\\theta}}|\\hat{\\theta}-a|=\\operatorname{sgn}(\\hat{\\theta}-a)$（当 $\\hat{\\theta}\\neq a$ 时），我们得到：\n- 对于 $\\hat{\\theta}\\in(-\\infty,1)$：$\\operatorname{sgn}(\\hat{\\theta}-1)=-1$，$\\operatorname{sgn}(\\hat{\\theta}-5)=-1$，$\\operatorname{sgn}(\\hat{\\theta}-9)=-1$，因此 $L'(\\hat{\\theta})=-3$。\n- 对于 $\\hat{\\theta}\\in(1,5)$：符号分别为 $+1, -1, -1$，因此 $L'(\\hat{\\theta})=-1$。\n- 对于 $\\hat{\\theta}\\in(5,9)$：符号分别为 $+1, +1, -1$，因此 $L'(\\hat{\\theta})=+1$。\n- 对于 $\\hat{\\theta}\\in(9,\\infty)$：符号分别为 $+1, +1, +1$，因此 $L'(\\hat{\\theta})=+3$。\n\n因此，对于 $\\hat{\\theta}  5$，有 $L'(\\hat{\\theta})  0$；对于 $\\hat{\\theta} > 5$，有 $L'(\\hat{\\theta}) > 0$。在 $\\hat{\\theta}=5$ 处，左导数为 $-1$，右导数为 $+1$，因此其次微分包含 $0$，证实了在 $\\hat{\\theta}=5$ 处存在一个最小值点。因此，损失在数据的中位数处最小化，即 $5$。\n\n为了完整起见，在候选点处求值得到 $L(5)=|5-1|+|5-5|+|5-9|=4+0+4=8$，该值小于在 $\\hat{\\theta}=1$ 或 $\\hat{\\theta}=9$ 处的值（两者均为 $12$），这与最小性一致。\n\n因此，最小化绝对误差之和的估计值是 $\\hat{\\theta}=5$ 毫米。", "answer": "$$\\boxed{5}$$", "id": "1931715"}, {"introduction": "与关注平均误差不同，有时我们更关心如何控制最坏情况下的误差。本练习探讨了“极小化极大损失”（minimax loss）或 L-无穷损失，其目标是最小化估计值与数据集中任何一点之间的最大绝对误差。这种方法在需要保证性能下限的风险规避场景中尤其有用，例如工程设计或金融风控。[@problem_id:1931753]", "problem": "在统计建模中，损失函数量化了与不正确预测相关的“成本”。一位数据科学家的任务是为一个给定的测量数据集选择一个单一的代表性常数，记为 $\\hat{\\theta}$。目标是选择 $\\hat{\\theta}$ 以最小化一个称为极小化极大损失（minimax loss）或最大绝对误差的特定误差准则。\n\n对于一个观测数据集 $Y = \\{y_1, y_2, \\dots, y_n\\}$，该损失函数 $L(\\hat{\\theta})$ 被定义为任何观测值 $y_i$ 与常数估计值 $\\hat{\\theta}$ 之间的最大绝对差：\n$$L(\\hat{\\theta}) = \\max_{i} |y_i - \\hat{\\theta}|$$\n考虑以下测量数据集：$Y = \\{1.0, 8.0, 2.0\\}$。\n\n确定能使该数据集的损失函数 $L(\\hat{\\theta})$ 最小化的 $\\hat{\\theta}$ 的精确数值。", "solution": "我们需要对于 $Y=\\{1.0,8.0,2.0\\}$ 最小化 $L(\\hat{\\theta})=\\max_{i}|y_{i}-\\hat{\\theta}|$。令 $a=\\min Y=1.0$ 且 $b=\\max Y=8.0$。对于任意实数 $t$，定义 $d_{1}=|t-a|$ 和 $d_{2}=|t-b|$。根据三角不等式，\n$$\nd_{1}+d_{2}\\geq|b-a|=b-a,\n$$\n所以\n$$\n\\max(d_{1},d_{2})\\geq\\frac{d_{1}+d_{2}}{2}\\geq\\frac{b-a}{2}.\n$$\n等号成立当且仅当 $d_{1}=d_{2}=\\frac{b-a}{2}$，这在 $t=\\frac{a+b}{2}$ 时发生。因此，函数 $t\\mapsto\\max(|t-a|,|t-b|)$ 在 $t=\\frac{a+b}{2}$ 处取得最小值，最小值为 $\\frac{b-a}{2}$。\n\n由于每个 $y_{i}$ 都在 $[a,b]$ 区间内，对于中点 $m=\\frac{a+b}{2}$，我们有对所有的 $i$ 都有 $|m-y_{i}|\\leq\\max(|m-a|,|m-b|)=\\frac{b-a}{2}$。因此，总损失 $L(\\hat{\\theta})=\\max_{i}|y_{i}-\\hat{\\theta}|$ 在 $\\hat{\\theta}=m$ 处最小化。\n\n代入 $a=1.0$ 和 $b=8.0$ 得到\n$$\n\\hat{\\theta}=\\frac{a+b}{2}=\\frac{1.0+8.0}{2}=4.5.\n$$", "answer": "$$\\boxed{4.5}$$", "id": "1931753"}, {"introduction": "平方误差损失因其良好的数学性质而被广泛使用，但如果我们想对较大的误差施加更严厉的惩罚呢？本练习介绍了一种四次损失函数 $(y_i - \\theta)^4$，它是平方误差思想的延伸，极大地放大了远离中心点的误差所带来的损失。通过解决这个问题，你将练习使用微积分来最小化一个更复杂的损失函数，并观察它如何影响最终的估计值。[@problem_id:1931740]", "problem": "在统计决策理论中，损失函数的选择对于评估估计量的质量至关重要。虽然平方误差损失很常用，但根据应用场景的不同，其他函数可能更合适。\n\n一位分析师正在开发一个简单模型，以便为一小组数据点 $\\{y_1, y_2, y_3\\} = \\{1, 5, 9\\}$ 提供一个单一的代表性数值。为了对偏离估计值的较大偏差施以重罚，该分析师选择使用“四次损失”函数。对于单个数据点 $y_i$ 和一个常数估计值 $\\theta$，损失定义为 $L(y_i, \\theta) = (y_i - \\theta)^4$。\n\n整个数据集的总损失是各个损失之和：$S(\\theta) = \\sum_{i=1}^{3} L(y_i, \\theta)$。你的任务是确定使该总损失最小化的最优常数估计值，记为 $\\hat{\\theta}$。\n\n求 $\\hat{\\theta}$ 的数值。", "solution": "我们最小化总四次损失\n$$\nS(\\theta)=\\sum_{i=1}^{3}(y_{i}-\\theta)^{4}=(1-\\theta)^{4}+(5-\\theta)^{4}+(9-\\theta)^{4}.\n$$\n对 $\\theta$ 求导，使用公式 $\\frac{d}{d\\theta}(\\theta - a)^{4}=4(\\theta-a)^{3}$：\n$$\nS'(\\theta)=4\\sum_{i=1}^{3}(\\theta-y_{i})^{3}=4\\left[(\\theta-1)^{3}+(\\theta-5)^{3}+(\\theta-9)^{3}\\right].\n$$\n令导数为零以求临界点：\n$$\n(\\theta-1)^{3}+(\\theta-5)^{3}+(\\theta-9)^{3}=0.\n$$\n令 $t=\\theta$ 并展开每个立方项：\n$$\n(t-1)^{3}=t^{3}-3t^{2}+3t-1,\\quad (t-5)^{3}=t^{3}-15t^{2}+75t-125,\\quad (t-9)^{3}=t^{3}-27t^{2}+243t-729.\n$$\n求和得到\n$$\n3t^{3}-45t^{2}+321t-855=0,\n$$\n化简（两边同除以 $3$）得\n$$\nt^{3}-15t^{2}+107t-285=0.\n$$\n我们检验 $t=5$：\n$$\n5^{3}-15\\cdot 5^{2}+107\\cdot 5-285=125-375+535-285=0,\n$$\n所以 $(t-5)$ 是一个因式。进行因式分解：\n$$\nt^{3}-15t^{2}+107t-285=(t-5)(t^{2}-10t+57).\n$$\n二次因式的判别式为 $(-10)^{2}-4\\cdot 1\\cdot 57=100-228=-128$，因此唯一的实临界点是 $t=5$。\n\n为了验证这是一个（全局）最小值，计算二阶导数：\n$$\nS''(\\theta)=12\\sum_{i=1}^{3}(\\theta-y_{i})^{2}.\n$$\n因为 $(\\theta-y_{i})^{2}\\geq 0$，且对于互不相同的 $y_{i}$，它们不可能同时为零，所以对所有 $\\theta$ 都有 $S''(\\theta)>0$。因此 $S$ 是严格凸函数，任何临界点都是唯一的全局最小值点。所以，\n$$\n\\hat{\\theta}=5.\n$$", "answer": "$$\\boxed{5}$$", "id": "1931740"}]}