{"hands_on_practices": [{"introduction": "本练习旨在奠定基础，探索我们的先验信念如何影响估计的风险。我们将使用性质优良的正态-正态模型，来观察贝叶斯风险（即我们最佳估计的期望误差）如何随着我们对参数初始确定性的减弱而变化。通过考察先验变得完全无信息的情况，我们可以深入理解由数据本身所施加的估计基本限度。[@problem_id:1898419]", "problem": "考虑一个统计估计问题，我们希望估计一个未知参数 $\\mu$。我们关于 $\\mu$ 的先验信念由一个均值为 0、方差为 $\\tau^2$ 的正态分布建模，其中 $\\tau^2  0$。我们将其记为 $\\mu \\sim N(0, \\tau^2)$。然后我们观测一个数据点 $X$，它来自一个以 $\\mu$ 的真实值为均值、方差为 1 的正态分布，记为 $X | \\mu \\sim N(\\mu, 1)$。\n\n估计量（记为 $\\hat{\\mu}(X)$）的质量由平方误差损失函数 $L(\\mu, \\hat{\\mu}) = (\\mu - \\hat{\\mu})^2$ 来衡量。贝叶斯风险（我们将其记为 $r(\\tau^2)$）定义为最小可能期望损失，其中期望是针对 $\\mu$ 和 $X$ 的联合分布计算的。\n\n确定当先验方差趋于无穷大时贝叶斯风险的极限值。即，计算 $\\lim_{\\tau^2 \\to \\infty} r(\\tau^2)$ 的值。请以单个数值的形式提供最终答案。", "solution": "我们给定一个正态-正态模型，其先验为 $\\mu \\sim N(0,\\tau^{2})$，似然为 $X \\mid \\mu \\sim N(\\mu,1)$。在平方误差损失 $L(\\mu,\\hat{\\mu})=(\\mu-\\hat{\\mu})^{2}$ 下，贝叶斯估计量是后验均值：\n$$\n\\hat{\\mu}(X)=\\mathbb{E}[\\mu \\mid X].\n$$\n根据共轭性，后验分布是正态分布，其精度等于先验精度与似然精度之和。因此\n$$\n\\operatorname{Var}(\\mu \\mid X)=\\left(\\frac{1}{\\tau^{2}}+1\\right)^{-1}=\\frac{\\tau^{2}}{1+\\tau^{2}},\n$$\n且\n$$\n\\mathbb{E}[\\mu \\mid X]=\\operatorname{Var}(\\mu \\mid X)\\left(\\frac{0}{\\tau^{2}}+X\\right)=\\frac{\\tau^{2}}{1+\\tau^{2}}\\,X.\n$$\n贝叶斯风险是所有估计量中的最小期望损失，对于平方误差损失和贝叶斯法则，它等于期望后验方差：\n$$\nr(\\tau^{2})=\\mathbb{E}\\big[(\\mu-\\hat{\\mu}(X))^{2}\\big]=\\mathbb{E}\\big[\\operatorname{Var}(\\mu \\mid X)\\big]=\\frac{\\tau^{2}}{1+\\tau^{2}},\n$$\n这里的期望是平凡的，因为 $\\operatorname{Var}(\\mu \\mid X)$ 不依赖于 $X$。\n\n因此，当 $\\tau^{2}\\to\\infty$ 时，贝叶斯风险的极限为\n$$\n\\lim_{\\tau^{2}\\to\\infty} r(\\tau^{2})=\\lim_{\\tau^{2}\\to\\infty} \\frac{\\tau^{2}}{1+\\tau^{2}}=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1898419"}, {"introduction": "在许多实际应用中，我们关心的不是模型参数本身，而是参数的某个函数，例如可靠性或失效率。本练习将我们对贝叶斯风险的理解扩展到这一常见情景。我们将使用一个泊松过程模型，来估计观测到零事件的概率，即 $g(\\lambda) = \\exp(-\\lambda)$，并计算其相关的贝叶斯风险，从而展示如何在贝叶斯框架内处理更复杂的估计目标。[@problem_id:1898443]", "problem": "考虑一个系统，在固定时间间隔内观测到的事件数 $X$ 服从泊松分布，其率参数 $\\lambda  0$ 未知。其概率质量函数为 $f(x|\\lambda) = \\frac{\\lambda^x e^{-\\lambda}}{x!}$，其中 $x = 0, 1, 2, \\dots$。\n\n我们对参数 $\\lambda$ 的先验信念由伽马分布描述，$\\lambda \\sim \\text{Gamma}(\\alpha, \\beta)$，其概率密度函数为 $\\pi(\\lambda) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} e^{-\\beta\\lambda}$，其中 $\\lambda  0$，且 $\\alpha  0$ 和 $\\beta  0$ 是已知的超参数。\n\n我们感兴趣的是估计在未来一个区间内观测到零个事件的概率，这是率参数的函数，即 $g(\\lambda) = e^{-\\lambda}$。估计量 $\\hat{g}$ 的优劣由平方误差损失函数 $L(g(\\lambda), \\hat{g}) = (g(\\lambda) - \\hat{g})^2$ 来衡量。\n\n您的任务是确定用于估计 $g(\\lambda)$ 的贝叶斯风险。贝叶斯风险是通过使用 $g(\\lambda)$ 的贝叶斯估计量所能达到的最小平均损失。\n\n请用先验参数 $\\alpha$ 和 $\\beta$ 将您的最终答案表示为一个封闭形式的解析表达式。", "solution": "我们有一个单一观测值 $X$，其分布为 $X \\mid \\lambda \\sim \\text{Poisson}(\\lambda)$，先验分布为 $\\lambda \\sim \\text{Gamma}(\\alpha,\\beta)$，其密度函数为 $\\pi(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha - 1} \\exp(-\\beta \\lambda)$，其中 $\\lambda  0$。目标泛函是 $g(\\lambda) = \\exp(-\\lambda)$，损失函数是平方误差，因此贝叶斯估计量是 $g(\\lambda)$ 的后验均值：\n$$\n\\hat{g}_{B}(X) = \\mathbb{E}\\!\\left[\\exp(-\\lambda)\\mid X\\right].\n$$\n根据共轭性，后验分布为\n$$\n\\lambda \\mid X \\sim \\text{Gamma}(\\alpha + X, \\beta + 1),\n$$\n因为似然函数贡献了因子 $\\lambda^{X} \\exp(-\\lambda)$，而先验分布贡献了因子 $\\lambda^{\\alpha - 1} \\exp(-\\beta \\lambda)$。\n\n对于 $Y \\sim \\text{Gamma}(s,r)$（形状参数为 $s$，率参数为 $r$），其拉普拉斯变换为\n$$\n\\mathbb{E}\\!\\left[\\exp(-t Y)\\right] = \\left(\\frac{r}{r + t}\\right)^{s}.\n$$\n应用此公式，令 $s = \\alpha + X$，$r = \\beta + 1$，$t = 1$，我们得到\n$$\n\\hat{g}_{B}(X) = \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{\\alpha + X}.\n$$\n\n在平方误差损失下，贝叶斯估计量的贝叶斯风险是\n$$\nR_{B} = \\mathbb{E}\\!\\left[(g(\\lambda) - \\hat{g}_{B}(X))^{2}\\right] = \\mathbb{E}\\!\\left[g(\\lambda)^{2}\\right] - \\mathbb{E}\\!\\left[\\hat{g}_{B}(X)^{2}\\right],\n$$\n其中期望是关于由先验和似然函数导出的联合分布计算的。\n\n首先，计算 $g(\\lambda)$ 的先验二阶矩：\n$$\n\\mathbb{E}\\!\\left[g(\\lambda)^{2}\\right] = \\mathbb{E}\\!\\left[\\exp(-2\\lambda)\\right] = \\left(\\frac{\\beta}{\\beta + 2}\\right)^{\\alpha},\n$$\n使用 $\\lambda \\sim \\text{Gamma}(\\alpha,\\beta)$ 的拉普拉斯变换，并令 $t=2$。\n\n接下来，计算 $\\mathbb{E}\\!\\left[\\hat{g}_{B}(X)^{2}\\right]$。我们有\n$$\n\\hat{g}_{B}(X)^{2} = \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2(\\alpha + X)} = \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2\\alpha} \\left(\\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2}\\right)^{X}.\n$$\n$X$ 的先验预测（边际）分布是负二项分布，其参数为 $\\alpha$ 和 $p = \\frac{\\beta}{\\beta + 1}$：\n$$\n\\mathbb{P}(X = x) = \\frac{\\Gamma(\\alpha + x)}{\\Gamma(\\alpha)\\,x!} \\left(\\frac{\\beta}{\\beta + 1}\\right)^{\\alpha} \\left(\\frac{1}{\\beta + 1}\\right)^{x}, \\quad x = 0,1,2,\\dots\n$$\n$X$ 的概率生成函数是\n$$\nG(t) = \\mathbb{E}\\!\\left[t^{X}\\right] = \\left(\\frac{\\beta}{\\beta + 1 - t}\\right)^{\\alpha}.\n$$\n令 $q = \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2}$。那么\n$$\n\\mathbb{E}\\!\\left[\\hat{g}_{B}(X)^{2}\\right] = \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2\\alpha} \\mathbb{E}\\!\\left[q^{X}\\right] = \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2\\alpha} \\left(\\frac{\\beta}{\\beta + 1 - q}\\right)^{\\alpha}.\n$$\n简化包含 $q$ 的因子。计算\n$$\n\\beta + 1 - q = \\beta + 1 - \\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2} = \\frac{(\\beta + 1)(\\beta^{2} + 3\\beta + 3)}{(\\beta + 2)^{2}},\n$$\n因此\n$$\n\\frac{\\beta}{\\beta + 1 - q} = \\frac{\\beta (\\beta + 2)^{2}}{(\\beta + 1)(\\beta^{2} + 3\\beta + 3)}.\n$$\n所以，\n$$\n\\mathbb{E}\\!\\left[\\hat{g}_{B}(X)^{2}\\right] = \\left[\\left(\\frac{\\beta + 1}{\\beta + 2}\\right)^{2} \\cdot \\frac{\\beta (\\beta + 2)^{2}}{(\\beta + 1)(\\beta^{2} + 3\\beta + 3)}\\right]^{\\alpha} = \\left(\\frac{\\beta(\\beta + 1)}{\\beta^{2} + 3\\beta + 3}\\right)^{\\alpha}.\n$$\n\n将这些结果放在一起，得到贝叶斯风险\n$$\nR_{B} = \\left(\\frac{\\beta}{\\beta + 2}\\right)^{\\alpha} - \\left(\\frac{\\beta(\\beta + 1)}{\\beta^{2} + 3\\beta + 3}\\right)^{\\alpha}.\n$$\n这是一个关于 $\\alpha$ 和 $\\beta$ 的封闭形式解析表达式。", "answer": "$$\\boxed{\\left(\\frac{\\beta}{\\beta+2}\\right)^{\\alpha}-\\left(\\frac{\\beta(\\beta+1)}{\\beta^{2}+3\\beta+3}\\right)^{\\alpha}}$$", "id": "1898443"}, {"introduction": "最优的统计程序通常是在理想化条件下推导出来的，但现实世界的系统常常对我们的决策施加约束。本实践问题深入探讨了这种现实情况，它比较了理想贝叶斯估计器与一个被限制在离散数值集合内的估计器的性能。通过计算因这一约束导致的贝叶斯风险的增加量，我们可以量化“妥协的成本”，并更好地理解决策理论中最优性的价值。[@problem_id:1898413]", "problem": "一位工程师正在测试一个生产特定类型半导体的制造过程。每个半导体的质量可以建模为一次独立的伯努利试验，其中半导体为无缺陷的概率为 $p$。工程师对 $p$ 值的先验信念由参数为 $\\alpha=1$ 和 $\\beta=1$ 的贝塔分布建模，即 $p \\sim \\text{Beta}(1, 1)$。为了更新这一信念，工程师测试了一批 $n=4$ 个半导体，并观察到无缺陷产品的总数 $S$。\n\n工程师基于观测数据 $S$，考虑了两种不同的关于参数 $p$ 的决策规则（估计量）。估计量 $\\delta$ 的性能通过平方误差损失函数 $L(p, \\delta) = (p - \\delta)^2$ 来评估。\n\n第一个估计量 $\\delta_B$ 是该模型的标准贝叶斯估计量，它最小化后验期望损失。\n\n第二个估计量 $\\delta_C$ 是一个受约束的估计量。由于系统限制，该估计量必须从离散集合 $D = \\{0, 0.25, 0.5, 0.75, 1\\}$ 中选择其对 $p$ 的估计值。对于给定的成功次数 $S=k$，规则 $\\delta_C$ 从集合 $D$ 中选择使后验期望平方误差损失最小化的值。\n\n任何估计量 $\\delta$ 的总体性能由其贝叶斯风险 $r(\\delta)$ 来衡量，贝叶斯风险是损失函数在 $p$ 的先验分布和数据 $S$ 的抽样分布上的期望值。\n\n计算这两个估计量的贝叶斯风险之差，$r(\\delta_C) - r(\\delta_B)$。请用最简精确分数表示你的答案。", "solution": "设 $p \\sim \\text{Beta}(\\alpha,\\beta)$，其中 $\\alpha=\\beta=1$，且 $S \\mid p \\sim \\text{Binomial}(n,p)$，其中 $n=4$。在平方误差损失下，贝叶斯估计量是后验均值。给定 $S=k$，后验分布为 $\\text{Beta}(\\alpha+k,\\beta+n-k)=\\text{Beta}(k+1,5-k)$，所以贝叶斯估计量是\n$$\n\\delta_{B}(k)=\\mathbb{E}[p \\mid S=k]=\\frac{k+\\alpha}{\\alpha+\\beta+n}=\\frac{k+1}{6}.\n$$\n记 $\\mu_{k}=\\delta_{B}(k)=\\frac{k+1}{6}$。\n\n对于任何估计量 $\\delta(S)$，后验期望平方损失可分解为\n$$\n\\mathbb{E}\\big[(p-\\delta(S))^{2}\\mid S\\big]=\\operatorname{Var}(p\\mid S)+\\big(\\mathbb{E}[p\\mid S]-\\delta(S)\\big)^{2}\n=\\operatorname{Var}(p\\mid S)+\\big(\\mu_{S}-\\delta(S)\\big)^{2}.\n$$\n因此，\n$$\nr(\\delta_{C})-r(\\delta_{B})=\\mathbb{E}\\big[(\\mu_{S}-\\delta_{C}(S))^{2}\\big],\n$$\n其中期望是关于 $S$ 的先验预测分布计算的。\n\n受约束的估计量 $\\delta_{C}(k)$ 必须在 $D=\\{0,\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{3}{4},1\\}$ 中，并且要最小化后验期望损失，根据上面的二次型，这等价于从 $D$ 中选择最接近 $\\mu_{k}$ 的元素。计算 $k=0,1,2,3,4$ 时的 $\\mu_{k}$：\n$$\n\\mu_{0}=\\frac{1}{6},\\quad \\mu_{1}=\\frac{1}{3},\\quad \\mu_{2}=\\frac{1}{2},\\quad \\mu_{3}=\\frac{2}{3},\\quad \\mu_{4}=\\frac{5}{6}.\n$$\n$D$ 中最接近的元素是\n$$\n\\delta_{C}(0)=\\frac{1}{4},\\quad \\delta_{C}(1)=\\frac{1}{4},\\quad \\delta_{C}(2)=\\frac{1}{2},\\quad \\delta_{C}(3)=\\frac{3}{4},\\quad \\delta_{C}(4)=\\frac{3}{4}.\n$$\n因此平方偏差为\n$$\n(\\mu_{0}-\\delta_{C}(0))^{2}=\\left(\\frac{1}{6}-\\frac{1}{4}\\right)^{2}=\\frac{1}{144},\\quad\n(\\mu_{1}-\\delta_{C}(1))^{2}=\\left(\\frac{1}{3}-\\frac{1}{4}\\right)^{2}=\\frac{1}{144},\n$$\n$$\n(\\mu_{2}-\\delta_{C}(2))^{2}=0,\\quad\n(\\mu_{3}-\\delta_{C}(3))^{2}=\\left(\\frac{2}{3}-\\frac{3}{4}\\right)^{2}=\\frac{1}{144},\\quad\n(\\mu_{4}-\\delta_{C}(4))^{2}=\\left(\\frac{5}{6}-\\frac{3}{4}\\right)^{2}=\\frac{1}{144}.\n$$\n\n在 $\\text{Beta}(1,1)$ 先验下，$S$ 的先验预测分布是\n$$\n\\mathbb{P}(S=k)=\\int_{0}^{1}\\binom{4}{k}p^{k}(1-p)^{4-k}\\,dp=\\binom{4}{k}B(k+1,5-k)=\\frac{1}{5},\n$$\n对于 $k=0,1,2,3,4$，因为 $B(k+1,5-k)=\\frac{k!(4-k)!}{5!}$ 并且 $\\binom{4}{k}\\frac{k!(4-k)!}{5!}=\\frac{1}{5}$。\n\n因此，\n$$\nr(\\delta_{C})-r(\\delta_{B})=\\sum_{k=0}^{4}\\mathbb{P}(S=k)\\,(\\mu_{k}-\\delta_{C}(k))^{2}\n=\\frac{1}{5}\\left(\\frac{1}{144}+\\frac{1}{144}+0+\\frac{1}{144}+\\frac{1}{144}\\right)\n=\\frac{4}{5}\\cdot\\frac{1}{144}\n=\\frac{1}{180}.\n$$", "answer": "$$\\boxed{\\frac{1}{180}}$$", "id": "1898413"}]}