{"hands_on_practices": [{"introduction": "在因子实验设计的分析中，第一步是量化每个因素的独立影响（主效应）以及它们共同作用时的协同或拮抗效应（交互效应）。这个练习 [@problem_id:1932232] 提供了一个经典的 $2^2$ 因子设计场景，要求你根据实验数据计算这些基本效应值。掌握这种计算是理解更复杂实验设计和解释其结果的基础。", "problem": "一位计算机科学专业的学生正在研究排序算法在不同编程语言中的性能。设计了一个 $2^2$ 因子实验，以模拟两个因子对排序一个包含一百万个随机生成整数的数组所需的执行时间的影响。\n\n这两个因子是：\n1.  **编程语言 (L)**：Python 编码为水平 -1，C++ 编码为水平 +1。\n2.  **排序算法 (A)**：Quicksort 编码为水平 -1，Mergesort 编码为水平 +1。\n\n响应变量是平均执行时间，单位为毫秒 (ms)。在四种实验条件下，记录了以下平均执行时间：\n\n*   Python (L=-1) 和 Quicksort (A=-1)：1852 ms\n*   Python (L=-1) 和 Mergesort (A=+1)：2258 ms\n*   C++ (L=+1) 和 Quicksort (A=-1)：81.3 ms\n*   C++ (L=+1) 和 Mergesort (A=+1)：124.5 ms\n\n在两水平因子设计的标准框架内，计算编程语言的主效应、排序算法的主效应以及两因子交互效应。请将你的答案以行矩阵的形式呈现，其中包含按以下顺序排列的三个值：[L 的主效应, A 的主效应, L-A 交互效应]。所有效应值均以毫秒表示，并四舍五入至三位有效数字。", "solution": "令 $y_{LA}$ 表示在水平 $L \\in \\{-1,+1\\}$ 和 $A \\in \\{-1,+1\\}$ 下的平均执行时间，给定数据如下：\n$$\ny_{-1,-1}=1852,\\quad y_{-1,+1}=2258,\\quad y_{+1,-1}=81.3,\\quad y_{+1,+1}=124.5.\n$$\n在一个编码水平为 $\\{-1,+1\\}$ 的两水平因子实验中，一个因子的主效应是在高水平下的平均响应与在低水平下的平均响应之差。两因子交互效应是其对比除以 $2$ 的结果，即因子符号与响应乘积的平均值。\n\n$L$ 的主效应：\n$$\nE_{L}=\\frac{y_{+1,-1}+y_{+1,+1}}{2}-\\frac{y_{-1,-1}+y_{-1,+1}}{2}\n=\\frac{81.3+124.5}{2}-\\frac{1852+2258}{2}\n=102.9-2055=-1952.1.\n$$\n\n$A$ 的主效应：\n$$\nE_{A}=\\frac{y_{-1,+1}+y_{+1,+1}}{2}-\\frac{y_{-1,-1}+y_{+1,-1}}{2}\n=\\frac{2258+124.5}{2}-\\frac{1852+81.3}{2}\n=1191.25-966.65=224.6.\n$$\n\n交互效应 $L\\!A$ (使用标准的交互作用对比除以 $2$)：\n$$\nE_{LA}=\\frac{y_{+1,+1}-y_{+1,-1}-y_{-1,+1}+y_{-1,-1}}{2}\n=\\frac{124.5-81.3-2258+1852}{2}\n=\\frac{-362.8}{2}=-181.4.\n$$\n\n将每个结果四舍五入到三位有效数字，得到：\n$$\nE_{L}\\approx -1.95\\times 10^{3},\\quad E_{A}\\approx 2.25\\times 10^{2},\\quad E_{LA}\\approx -1.81\\times 10^{2}.\n$$\n所有数值的单位都是毫秒。", "answer": "$$\\boxed{\\begin{pmatrix}-1.95 \\times 10^{3}  2.25 \\times 10^{2}  -1.81 \\times 10^{2}\\end{pmatrix}}$$", "id": "1932232"}, {"introduction": "计算出效应值后，下一个关键步骤是正确地解释它们。这个练习 [@problem_id:1932262] 提出了一个极具启发性的思想实验：当两个因素的主效应都不显著，而它们的交互效应却非常显著时，我们应该如何解读结果？这种情况，特别是交叉交互 (crossover interaction)，挑战了我们对“效应”的直观理解，并强调了在存在交互作用时，孤立地解释主效应是多么危险。", "problem": "一个农业研究团队正在进行一项旨在提高鸡生长速率的研究。他们设计了一个2x2析因实验，以研究两个因素的影响：饲料类型（因素A）和饲养环境（因素B）。因素A的水平是“标准饲料”和“新型补充剂”。因素B的水平是“标准鸡舍”和“丰富环境”。\n\n在四种条件下，用大量的鸡进行实验后，团队计算了每组的平均生长速率（单位：克/天）。结果如下：\n\n- 在标准鸡舍中使用标准饲料的鸡：20.0 克/天\n- 在丰富环境中使用标准饲料的鸡：30.0 克/天\n- 在标准鸡舍中使用新型补充剂的鸡：30.0 克/天\n- 在丰富环境中使用新型补充剂的鸡：20.0 克/天\n\n对数据进行了双因素方差分析（ANOVA）。分析显示，饲料类型的主效应和饲养环境的主效应的p值都很大，因此得出结论，这些效应在统计上不显著。然而，饲料类型和饲养环境之间的交互效应的p值非常小，表明存在高度显著的交互作用。\n\n根据这项统计分析和所提供的平均生长速率，以下哪个陈述对研究结果提供了最准确和最完整的解释？\n\nA. 新型补充剂和丰富环境是无效的，因为它们的主效应不显著。因此，改变标准做法没有好处。\n\nB. 新型饲料补充剂始终优于标准饲料。其主效应不显著可能是由于随机实验误差造成的。\n\nC. 丰富饲养环境始终优于标准鸡舍。其主效应不显著可能是由于随机实验误差造成的。\n\nD. 新型饲料补充剂的有效性取决于饲养环境。在不考虑另一个因素的情况下，不可能对一个因素提出普适性建议。\n\nE. 该实验存在缺陷，因为在逻辑上不可能在主效应不显著的同时存在高度显著的交互效应。", "solution": "设 $A$ 表示饲料类型，其水平为 $i \\in \\{1,2\\}$，其中 $i=1$ 是标准饲料，$i=2$ 是新型补充剂；设 $B$ 表示饲养环境，其水平为 $j \\in \\{1,2\\}$，其中 $j=1$ 是标准鸡舍，$j=2$ 是丰富环境。在单元格样本量相等的双因素方差分析中，标准效应模型为\n$$\nY_{ijk}=\\mu+\\alpha_{i}+\\beta_{j}+(\\alpha\\beta)_{ij}+\\varepsilon_{ijk},\n$$\n约束条件为 $\\sum_{i}\\alpha_{i}=0$，$\\sum_{j}\\beta_{j}=0$，以及 $\\sum_{i}(\\alpha\\beta)_{ij}=\\sum_{j}(\\alpha\\beta)_{ij}=0$。相应的单元格均值满足\n$$\n\\mu_{ij}=\\mu+\\alpha_{i}+\\beta_{j}+(\\alpha\\beta)_{ij}.\n$$\n\n观察到的单元格均值（平均生长速率）为\n$$\n\\hat{\\mu}_{11}=20.0,\\quad \\hat{\\mu}_{12}=30.0,\\quad \\hat{\\mu}_{21}=30.0,\\quad \\hat{\\mu}_{22}=20.0.\n$$\n\n主效应通过边际均值来定义。对于因素 $A$，边际均值为\n$$\n\\hat{\\mu}_{1\\cdot}=\\frac{\\hat{\\mu}_{11}+\\hat{\\mu}_{12}}{2}=\\frac{20.0+30.0}{2}=25.0,\\qquad\n\\hat{\\mu}_{2\\cdot}=\\frac{\\hat{\\mu}_{21}+\\hat{\\mu}_{22}}{2}=\\frac{30.0+20.0}{2}=25.0,\n$$\n因此，估计的 $A$ 的主效应为\n$$\n\\hat{\\mu}_{2\\cdot}-\\hat{\\mu}_{1\\cdot}=25.0-25.0=0.0,\n$$\n这与饲料类型的主效应不显著的结论一致。\n\n对于因素 $B$，边际均值为\n$$\n\\hat{\\mu}_{\\cdot 1}=\\frac{\\hat{\\mu}_{11}+\\hat{\\mu}_{21}}{2}=\\frac{20.0+30.0}{2}=25.0,\\qquad\n\\hat{\\mu}_{\\cdot 2}=\\frac{\\hat{\\mu}_{12}+\\hat{\\mu}_{22}}{2}=\\frac{30.0+20.0}{2}=25.0,\n$$\n因此，估计的 $B$ 的主效应为\n$$\n\\hat{\\mu}_{\\cdot 2}-\\hat{\\mu}_{\\cdot 1}=25.0-25.0=0.0,\n$$\n这与饲养环境的主效应不显著的结论一致。\n\n交互效应可以表示为双重差分对比。一个常见的交互对比是\n$$\n\\left(\\hat{\\mu}_{11}-\\hat{\\mu}_{12}\\right)-\\left(\\hat{\\mu}_{21}-\\hat{\\mu}_{22}\\right)\n=\\left(20.0-30.0\\right)-\\left(30.0-20.0\\right)=-10.0-10.0=-20.0,\n$$\n这个值远不为零，表明存在强烈的交叉交互作用。等价地，在 $B=1$ 时饲料类型的简单效应是\n$$\n\\hat{\\mu}_{21}-\\hat{\\mu}_{11}=30.0-20.0=10.0 \\quad \\text{(New Supplement better in Standard Coop)},\n$$\n而在 $B=2$ 时饲料类型的简单效应是\n$$\n\\hat{\\mu}_{22}-\\hat{\\mu}_{12}=20.0-30.0=-10.0 \\quad \\text{(New Supplement worse in Enriched Environment)}.\n$$\n在 $B$ 的不同水平上，简单效应的反转是相异性（交叉）交互作用的标志。在这种情况下，观察到不显著的主效应和高度显著的交互作用是完全可能的，甚至是典型的，因为在计算边际均值进行平均时，调节变量一个水平上的正向简单效应与另一个水平上的负向简单效应相互抵消了。\n\n因此：\n- 选项A是错误的，因为它宣布两种干预措施都无效，忽略了显著的交互作用以及已证明的依赖于情境的益处和害处。\n- 选项B是错误的，因为新型补充剂并非始终更优；其效果取决于饲养环境，并且在 $B$ 的不同水平上效应方向相反。\n- 选项C因类似原因也是错误的；丰富环境并非始终更优。\n- 选项D是正确的：新型补充剂的有效性取决于饲养环境，因此在不考虑另一个因素的情况下，不能对一个因素提出普适性建议。\n- 选项E是错误的，因为主效应不显著而交互作用显著在逻辑上和统计上都是可能的，尤其是在交叉模式中。\n\n因此，最准确和完整的解释是，饲料的效果取决于饲养环境，推荐建议必须以另一个因素的水平为条件。", "answer": "$$\\boxed{D}$$", "id": "1932262"}, {"introduction": "当我们处理定量因子（如温度或浓度）时，分析可以超越简单地判断交互效应是否存在。我们可以进一步探究交互作用的具体形式。这个高级练习 [@problem_id:1932244] 介绍了如何使用正交多项式对比 (orthogonal polynomial contrasts) 将交互作用的平方和 ($SS_{AB}$) 分解为具有特定解释的单自由度分量。通过计算线性（温度）与二次（葡萄糖）交互作用的平方和 ($SS_{A_L B_Q}$)，你将学会如何从统计上描述一个因素的线性变化如何影响响应变量对另一个因素的曲率，从而对系统行为获得更深刻的洞察。", "problem": "一位生物过程工程师正在研究一种基因改造酵母菌株生产治疗性蛋白质的过程。据推测，该蛋白质的产量取决于发酵温度（因子A）和初始葡萄糖浓度（因子B）。为了分析这种关系，进行了一项完整的 $3 \\times 3$ 因子实验。因子A设置了三个等间距水平（25°C, 30°C, 35°C），因子B也设置了三个等间距水平（20 g/L, 40 g/L, 60 g/L）。九个处理组合中的每一个都重复了 $n=4$ 次。\n\n记录了每个单元中四次重复的蛋白质总产量（单位为毫克），记为 $Y_{ij.}$，其中 $i$ 是温度的索引，$j$ 是葡萄糖水平的索引。在第一个温度水平（25°C）下，对应三个葡萄糖水平（20, 40, 和 60 g/L）的总产量分别为102、110和120。在第二个温度水平（30°C）下，相应的总产量为145、150和148。在第三个温度水平（35°C）下，总产量为130、125和115。\n\n分析的一个关键部分是将交互作用平方和（$SS_{AB}$）分解为正交的单自由度分量，以理解交互作用的性质。您的任务是计算线性（温度）与二次（葡萄糖）交互作用分量的平方和，记为 $SS_{A_L B_Q}$。该分量量化了产量的二次趋势如何随葡萄糖浓度的变化而随温度呈线性变化。\n\n计算 $SS_{A_L B_Q}$ 的值。将您的最终答案四舍五入到四位有效数字。", "solution": "因为两个因子都有三个等间距水平且重复次数相等，我们使用正交多项式对比：对于温度（因子A）的线性趋势，在三个水平上使用系数 $c_{A} = (-1, 0, 1)$；对于葡萄糖（因子B）的二次趋势，在三个水平上使用系数 $d_{B} = (1, -2, 1)$。在等权重下，这些系数是正交的并且是中心化的（总和为零）。\n\n设 $Y_{ij.}$ 表示单元 $(i,j)$ 中 $n$ 次重复的总和，其中 $n=4$。对于由乘积系数 $c_{i}d_{j}$ 定义的单自由度交互作用分量，基于单元总和的平方和为\n$$\nSS_{A_{L}B_{Q}} = \\frac{\\left( \\sum_{i=1}^{3}\\sum_{j=1}^{3} c_{i} d_{j} Y_{ij.} \\right)^{2}}{n \\left( \\sum_{i=1}^{3} c_{i}^{2} \\right)\\left( \\sum_{j=1}^{3} d_{j}^{2} \\right)}.\n$$\n\n使用给定的总和计算分子对比 $C = \\sum_{i,j} c_{i} d_{j} Y_{ij.}$：\n- 系数：$c_{1}=-1$, $c_{2}=0$, $c_{3}=1$；$d_{1}=1$, $d_{2}=-2$, $d_{3}=1$。\n- 只有 $i=1$ 和 $i=3$ 有贡献（因为 $c_{2}=0$）。等价地，\n$$\nC = \\sum_{j=1}^{3} d_{j}\\big(Y_{3j.} - Y_{1j.}\\big).\n$$\n使用 $Y_{1j.}=(102,110,120)$ 和 $Y_{3j.}=(130,125,115)$：\n$$\nY_{3j.}-Y_{1j.} = (28, 15, -5).\n$$\n因此\n$$\nC = 1\\cdot 28 + (-2)\\cdot 15 + 1\\cdot(-5) = 28 - 30 - 5 = -7.\n$$\n\n计算分母因子：\n$$\n\\sum_{i=1}^{3} c_{i}^{2} = (-1)^{2} + 0^{2} + 1^{2} = 2,\\quad \\sum_{j=1}^{3} d_{j}^{2} = 1^{2} + (-2)^{2} + 1^{2} = 6,\\quad n=4.\n$$\n\n因此，\n$$\nSS_{A_{L}B_{Q}} = \\frac{(-7)^{2}}{4 \\cdot 2 \\cdot 6} = \\frac{49}{48}.\n$$\n作为小数并四舍五入到四位有效数字，\n$$\nSS_{A_{L}B_{Q}} \\approx 1.021.\n$$", "answer": "$$\\boxed{1.021}$$", "id": "1932244"}]}