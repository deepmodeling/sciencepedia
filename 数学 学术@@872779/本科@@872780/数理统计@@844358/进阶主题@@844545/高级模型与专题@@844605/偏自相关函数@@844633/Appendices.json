{"hands_on_practices": [{"introduction": "为了有效使用偏自相关函数 (PACF)，我们首先必须理解它是如何从我们更熟悉的自相关函数 (ACF) 推导出来的。本练习将使用杜宾-莱文森递推公式 (Durbin-Levinson recursion) 进行一次直接的动手计算。通过完成这个基础的转换，您将对这两个基本时间序列工具之间的数学联系有一个具体的认识。[@problem_id:1943287]", "problem": "在分析平稳时间序列时，自相关函数 (ACF) 和偏自相关函数 (PACF) 是识别数据潜在结构的基本工具。对于一个给定的平稳过程，令 $\\rho(k)$ 表示滞后 $k$ 阶的理论 ACF，它衡量相隔 $k$ 个时间步长的观测值之间的相关性。令 $\\phi_{kk}$ 表示滞后 $k$ 阶的理论 PACF，它衡量在剔除了中间观测值的线性影响后，相隔 $k$ 个时间步长的观测值之间的相关性。\n\n假设一个平稳时间序列的理论 ACF 值为 $\\rho(1) = 0.8$ 和 $\\rho(2) = 0.5$。计算其滞后 2 阶的理论 PACF 值，记为 $\\phi_{22}$。将最终答案四舍五入到四位有效数字。", "solution": "我们使用关联理论 ACF $\\rho(k)$ 和 PACF $\\phi_{kk}$ 的 Durbin–Levinson 递推公式。对于 $k=1$，有 $\\phi_{11}=\\rho(1)$。\n对于 $k=2$，公式为：\n$$\n\\phi_{22}=\\frac{\\rho(2)-\\rho(1)^{2}}{1-\\rho(1)^{2}}.\n$$\n根据给定的值 $\\rho(1)=0.8$ 和 $\\rho(2)=0.5$，\n$$\n\\phi_{22}=\\frac{0.5-0.8^{2}}{1-0.8^{2}}=\\frac{0.5-0.64}{1-0.64}=\\frac{-0.14}{0.36}=-\\frac{7}{18}\\approx -0.388888\\ldots\n$$\n四舍五入到四位有效数字得到 $-0.3889$。", "answer": "$$\\boxed{-0.3889}$$", "id": "1943287"}, {"introduction": "PACF 最强大的应用之一是识别自回归 (AR) 过程的阶数。本实践问题揭示了 PACF 对于 AR 模型的一个标志性特征：在某个滞后阶数后会呈现出急剧的“截尾”。理解这一特性对于 Box-Jenkins 方法论中的模型选择阶段至关重要。[@problem_id:1943263]", "problem": "考虑一个平稳的二阶自回归（AR）模型，记为 AR(2)，它由以下针对时间序列 $\\{X_t\\}$ 的方程定义：\n$$X_t = 0.5 X_{t-1} - 0.3 X_{t-2} + \\epsilon_t$$\n其中，$\\{\\epsilon_t\\}$ 是一个白噪声过程，意味着其元素是独立同分布的随机变量，均值为零，方差为常数 $\\sigma^2_\\epsilon$。\n\n确定此过程在滞后 2 阶的理论偏自相关函数（PACF）的精确值。滞后 $k$ 阶的 PACF通常用 $\\phi_{kk}$ 表示。你需要求出 $\\phi_{22}$ 的值。", "solution": "我们将给定的过程重写为标准的 AR(2) 形式：\n$$\nX_{t}=\\phi_{1}X_{t-1}+\\phi_{2}X_{t-2}+\\epsilon_{t},\n$$\n其中 $\\phi_{1}=0.5$ 且 $\\phi_{2}=-0.3$，$\\{\\epsilon_{t}\\}$ 是方差为 $\\sigma_{\\epsilon}^{2}$ 的白噪声。\n\n滞后 2 阶的理论偏自相关 $\\phi_{22}$，定义为基于 $X_{t-1}$ 和 $X_{t-2}$ 对 $X_{t}$ 进行最佳线性预测时，$X_{t-2}$ 的系数。也就是说，$\\phi_{22}$ 等于线性投影中的值 $\\beta_{2}$：\n$$\nX_{t}=\\beta_{1}X_{t-1}+\\beta_{2}X_{t-2}+u_{t},\n$$\n该线性投影使得 $E[u_{t}^{2}]$ 最小化。此投影的正规方程为：\n$$\nE\\big[X_{t-1}(X_{t}-\\beta_{1}X_{t-1}-\\beta_{2}X_{t-2})\\big]=0,\\quad E\\big[X_{t-2}(X_{t}-\\beta_{1}X_{t-1}-\\beta_{2}X_{t-2})\\big]=0,\n$$\n记 $\\gamma(h)=\\operatorname{Cov}(X_{t},X_{t-h})$，方程变为：\n$$\n\\gamma(1)=\\beta_{1}\\gamma(0)+\\beta_{2}\\gamma(1),\\qquad \\gamma(2)=\\beta_{1}\\gamma(1)+\\beta_{2}\\gamma(0).\n$$\n写成矩阵形式为：\n$$\n\\begin{pmatrix}\n\\gamma(0)  \\gamma(1)\\\\\n\\gamma(1)  \\gamma(0)\n\\end{pmatrix}\n\\begin{pmatrix}\n\\beta_{1}\\\\\n\\beta_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\gamma(1)\\\\\n\\gamma(2)\n\\end{pmatrix}.\n$$\n\n对于 AR(2) 模型，当 $h=1,2$ 时，Yule–Walker 方程为：\n$$\n\\gamma(1)=\\phi_{1}\\gamma(0)+\\phi_{2}\\gamma(1),\\qquad \\gamma(2)=\\phi_{1}\\gamma(1)+\\phi_{2}\\gamma(0).\n$$\n这些方程与将 $(\\beta_{1},\\beta_{2})$ 替换为 $(\\phi_{1},\\phi_{2})$ 后的正规方程完全相同。在平稳性条件下，自协方差矩阵是正定的，因此是可逆的，所以正规方程的解是唯一的。因此，\n$$\n\\beta_{1}=\\phi_{1},\\qquad \\beta_{2}=\\phi_{2}.\n$$\n根据滞后 2 阶 PACF 的定义，$\\phi_{22}=\\beta_{2}=\\phi_{2}$。代入给定的系数可得：\n$$\n\\phi_{22}=-0.3.\n$$", "answer": "$$\\boxed{-0.3}$$", "id": "1943263"}, {"introduction": "与自回归模型相反，移动平均 (MA) 模型在其 PACF 中表现出不同的特征。本练习将展示 MA(1) 过程的 PACF 的行为方式，它呈现出衰减模式而不是急剧的截尾。通过将此结果与 AR 过程的行为进行比较，您将巩固使用 PACF 区分这两种基本模型类型的能力。[@problem_id:1943283]", "problem": "在一次质量控制分析中，某制造产品的每日重量与目标重量的偏差被建模为一个平稳时间序列 $\\{X_t\\}$。一位分析师提出，该序列可以用一阶移动平均模型，即 MA(1) 模型来描述：\n$$ X_t = \\epsilon_t + \\theta \\epsilon_{t-1} $$\n其中 $\\{\\epsilon_t\\}$ 是一个白噪声过程（一个均值为零、方差为常数 $\\sigma^2_\\epsilon$ 的不相关随机变量序列），$\\theta$ 是模型参数，且 $|\\theta| < 1$。\n\n自相关函数 (ACF) $\\rho(k)$ 和偏自相关函数 (PACF) $\\phi_{kk}$ 是识别和验证时间序列模型的关键工具。对于所提出的 MA(1) 过程，已知其在滞后 $k=1$ 时的自相关函数为 $\\rho(1) = \\frac{\\theta}{1+\\theta^2}$，并且在所有后续滞后阶的自相关函数均为零，即对于所有整数 $k \\ge 2$，有 $\\rho(k)=0$。\n\n基于这些信息，确定该 MA(1) 过程在滞后 2 阶的偏自相关函数（记为 $\\phi_{22}$）的理论值。请用参数 $\\theta$ 的单个符号表达式来表示你的答案。", "solution": "对于一个自相关函数为 $\\rho(k)$ 的平稳过程，其偏自相关系数 $\\{\\phi_{kk}\\}$ 可以通过 Durbin–Levinson 递归得到。具体来说，\n$$\n\\phi_{11}=\\rho(1), \\quad \\text{且对于 } k\\ge 2,\\quad \\phi_{kk}=\\frac{\\rho(k)-\\sum_{j=1}^{k-1}\\phi_{k-1,j}\\,\\rho(k-j)}{1-\\sum_{j=1}^{k-1}\\phi_{k-1,j}\\,\\rho(j)}.\n$$\n对于给定的 MA(1) 模型，$\\rho(1)=\\frac{\\theta}{1+\\theta^{2}}$ 且对于所有整数 $k\\ge 2$，有 $\\rho(k)=0$。将递归应用于 $k=2$ 的情况，我们使用 $\\phi_{11}=\\rho(1)$ 并得到\n$$\n\\phi_{22}=\\frac{\\rho(2)-\\rho(1)^{2}}{1-\\rho(1)^{2}}=\\frac{0-\\rho(1)^{2}}{1-\\rho(1)^{2}}=-\\frac{\\rho(1)^{2}}{1-\\rho(1)^{2}}.\n$$\n代入 $\\rho(1)=\\frac{\\theta}{1+\\theta^{2}}$ 可得\n$$\n\\rho(1)^{2}=\\frac{\\theta^{2}}{(1+\\theta^{2})^{2}}, \\quad 1-\\rho(1)^{2}=\\frac{(1+\\theta^{2})^{2}-\\theta^{2}}{(1+\\theta^{2})^{2}}=\\frac{1+\\theta^{2}+\\theta^{4}}{(1+\\theta^{2})^{2}}.\n$$\n因此，\n$$\n\\phi_{22}=-\\frac{\\dfrac{\\theta^{2}}{(1+\\theta^{2})^{2}}}{\\dfrac{1+\\theta^{2}+\\theta^{4}}{(1+\\theta^{2})^{2}}}=-\\frac{\\theta^{2}}{1+\\theta^{2}+\\theta^{4}}.\n$$", "answer": "$$\\boxed{-\\frac{\\theta^{2}}{1+\\theta^{2}+\\theta^{4}}}$$", "id": "1943283"}]}