{"hands_on_practices": [{"introduction": "单向方差分析（ANOVA）的核心在于比较不同组别之间的变异与各组内部的变异。本练习将指导你完成F检验的关键计算步骤：从已知的组间平方和（SSB）与组内平方和（SSW）出发，推导出最终的F统计量。这个过程是理解F统计量如何量化组间差异相对于组内随机性的基础。[@problem_id:1960654]", "problem": "一个农业研究所正在进行一项研究，以比较四种新开发的有机肥料配方对某种作物产量的影响。实验共有20块相同的地块可供使用。这些地块被随机分成四组，每组5块地块分别施用四种不同肥料配方中的一种。在生长季结束时，测量每个地块的作物产量。\n\n对收集的数据进行统计分析后，得到以下信息：\n- 四个不同肥料组之间的作物产量变异，即组间平方和，为85.5。\n- 每个肥料组内部的作物产量随机变异，即组内平方和，为131.2。\n\n为了确定四组肥料的平均作物产量是否存在统计学上的显著差异，需要计算F统计量，这是方差分析(ANOVA)的一部分。根据所提供的数据计算此F统计量的值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们有一个方差分析，包含四个组和总共 $N=20$ 个观测值，所以组数是 $k=4$。给定的组间平方和为 $\\text{SSB}=85.5$，组内平方和为 $\\text{SSW}=131.2$。\n\n单因素方差分析中的F统计量定义为\n$$\nF=\\frac{\\text{MSB}}{\\text{MSW}},\n$$\n其中组间均方为\n$$\n\\text{MSB}=\\frac{\\text{SSB}}{df_{\\text{between}}}=\\frac{\\text{SSB}}{k-1},\n$$\n组内均方为\n$$\n\\text{MSW}=\\frac{\\text{SSW}}{df_{\\text{within}}}=\\frac{\\text{SSW}}{N-k}.\n$$\n\n计算自由度：\n$$\ndf_{\\text{between}}=k-1=4-1=3, \\quad df_{\\text{within}}=N-k=20-4=16.\n$$\n\n计算均方：\n$$\n\\text{MSB}=\\frac{85.5}{3}=28.5, \\quad \\text{MSW}=\\frac{131.2}{16}=8.2.\n$$\n\n因此，F统计量为\n$$\nF=\\frac{28.5}{8.2}=\\frac{285}{82}\\approx 3.475609756\\ldots\n$$\n四舍五入到三位有效数字，\n$$\nF\\approx 3.48.\n$$", "answer": "$$\\boxed{3.48}$$", "id": "1960654"}, {"introduction": "理论的深刻理解往往源于对极端情况的思考。本练习提出了一个富有启发性的思想实验：当所有处理组的样本均值恰好完全相等时，F统计量的值会是多少？通过分析这个特殊情况，你将直观地理解为何组间均方（MSB）是衡量组间差异的指标，并领会F检验的基本逻辑。[@problem_id:1960676]", "problem": "一个生物统计学家团队正在进行一项研究，以比较 $k$ 种旨在降低收缩压的新药物配方的功效。该研究涉及 $N$ 名受试者，他们被随机分配到 $k$ 个治疗组中的一个。设 $n_i$ 为第 $i$ 组的受试者人数，其中 $i=1, \\dots, k$。该研究的设计使得 $k \\ge 2$ 且每个组至少有两名受试者，即对所有 $i$ 都有 $n_i \\ge 2$。\n\n治疗期结束后，对每位受试者的收缩压降低值进行了测量。设 $y_{ij}$ 为第 $i$ 组中第 $j$ 名受试者的测量值。第 $i$ 组血压降低值的样本均值用 $\\bar{y}_{i.}$ 表示。\n\n在分析初步结果时，该团队观察到一个奇特的结果：所有 $k$ 个组的样本均值降低值完全相同。也就是说，$\\bar{y}_{1.} = \\bar{y}_{2.} = \\dots = \\bar{y}_{k.}$。然而，至少有一个组内的测量值不完全相同，这意味着整个数据集中存在一些非零的样本方差。\n\n该团队决定继续进行单因素方差分析（ANOVA），以正式检验组均值之间是否存在差异。基于所有样本均值都相同的观察结果，他们将计算出的F统计量的数值是多少？", "solution": "在一个有 $k$ 个组且总样本量为 $N=\\sum_{i=1}^{k} n_{i}$ 的单因素方差分析中，定义组均值 $\\bar{y}_{i.}=\\frac{1}{n_{i}}\\sum_{j=1}^{n_{i}} y_{ij}$ 和总均值\n$$\n\\bar{y}_{..}=\\frac{1}{N}\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}} y_{ij}=\\frac{1}{N}\\sum_{i=1}^{k} n_{i}\\bar{y}_{i.}.\n$$\n组间平方和为\n$$\nSS_{\\text{B}}=\\sum_{i=1}^{k} n_{i}\\bigl(\\bar{y}_{i.}-\\bar{y}_{..}\\bigr)^{2}.\n$$\n根据所有样本均值都相同的观察结果，即 $\\bar{y}_{1.}=\\cdots=\\bar{y}_{k.}$，可得出对于每个 $i$ 都有 $\\bar{y}_{i.}=\\bar{y}_{..}$，因此\n$$\nSS_{\\text{B}}=\\sum_{i=1}^{k} n_{i}\\cdot 0^{2}=0.\n$$\n组内平方和为\n$$\nSS_{\\text{W}}=\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}}\\bigl(y_{ij}-\\bar{y}_{i.}\\bigr)^{2}.\n$$\n因为至少有一个组的测量值不完全相同，所以这个和中至少有一项是正的，且所有项都是非负的，因此 $SS_{\\text{W}}>0$。\n\n均方为\n$$\nMS_{\\text{B}}=\\frac{SS_{\\text{B}}}{k-1}, \\qquad MS_{\\text{W}}=\\frac{SS_{\\text{W}}}{N-k}.\n$$\n因为 $k\\ge 2$，所以分母 $k-1>0$，因此 $MS_{\\text{B}}=0$。另外，由于每个 $n_{i}\\ge 2$ 且 $k\\ge 2$，我们有 $N\\ge 2k$，因此 $N-k\\ge k\\ge 2$，所以 $MS_{\\text{W}}$ 的分母是正的，并且由于 $SS_{\\text{W}}>0$，可得出 $MS_{\\text{W}}>0$。\n\nANOVA F-统计量为\n$$\nF=\\frac{MS_{\\text{B}}}{MS_{\\text{W}}}=\\frac{0}{MS_{\\text{W}}}=0.\n$$\n因此，计算出的F-统计量为零。", "answer": "$$\\boxed{0}$$", "id": "1960676"}, {"introduction": "在进行实验之前，评估该实验能够检测出预期效应的概率是至关重要的，这个概率被称为统计功效。本练习将引导你超越简单的假设检验，进入实验设计的核心领域。你将学习如何计算F检验在特定备择假设下的功效，这需要运用非中心F分布的概念，是评估和优化研究方案的关键一步。[@problem_id:1960646]", "problem": "一家生物技术研究公司正在评估四种新的营养配方（$F_1, F_2, F_3, F_4$），用于培养一种特定的微藻菌株。主要关注的指标是藻类的比生长速率。根据大量先前的研究，已知任何给定配方的生长速率都服从正态分布，并且所有配方共享一个共同的总体方差 $\\sigma^2 = 0.0144$。\n\n该公司计划进行一项均衡设计的实验，对 $k=4$ 种配方中的每一种使用 $n=8$ 个独立的培养样本。将进行一次统计检验，以比较四种配方的平均生长速率。原假设，即所有四个平均生长速率都相等（$H_0: \\mu_1 = \\mu_2 = \\mu_3 = \\mu_4$），将与至少有一个平均值不同的备择假设进行检验。该检验将在 $\\alpha = 0.05$ 的显著性水平下进行。检验统计量是组间均方与组内均方之比。\n\n研究人员希望评估他们实验设计的灵敏度。他们特别感兴趣的是其检测一个具有实际重要性的特定场景的能力，在该场景中，真实的平均生长速率为 $\\mu_1 = 0.70$，$\\mu_2 = 0.75$，$\\mu_3 = 0.80$，和 $\\mu_4 = 0.75$。\n\n计算在该特定备择场景下，实验将正确拒绝原假设的概率。\n\n为了进行计算，您被给予以下信息：\n- 在 $\\alpha=0.05$ 显著性水平下，检验的临界值为 $F_c = 2.947$。\n- 令 $X$ 为一个服从非中心F分布的随机变量，其自由度为 $\\nu_1, \\nu_2$，非中心参数为 $\\lambda$。其累积分布函数记为 $F_{\\nu_1, \\nu_2, \\lambda}(x)$。对于与此问题相关的特定参数，已知 $F_{\\nu_1, \\nu_2, \\lambda}(F_c) = 0.1983$。\n\n将您的答案四舍五入到四位有效数字。", "solution": "该问题要求计算单因素方差分析（ANOVA）F检验的功效（power）。功效是在特定备择假设 $H_1$ 为真时，正确拒绝原假设 $H_0$ 的概率。\n\n首先，我们确定实验设计的参数。我们有 $k=4$ 个组（配方），每组有 $n=8$ 个观测值。总观测数为 $N = kn = 4 \\times 8 = 32$。共同的总体方差为 $\\sigma^2 = 0.0144$。显著性水平为 $\\alpha = 0.05$。\n\n单因素方差分析的检验统计量是 $F = \\frac{MSB}{MSW}$，其中 $MSB$ 是组间均方（Mean Square Between groups），$MSW$ 是组内均方（Mean Square Within groups）。在原假设 $H_0: \\mu_1 = \\mu_2 = \\mu_3 = \\mu_4$ 下，F统计量服从中心F分布，其自由度为 $\\nu_1 = k-1 = 4-1 = 3$ 和 $\\nu_2 = N-k = 32-4 = 28$。如果观测到的F统计量超过临界值 $F_c = 2.947$，则拒绝 $H_0$。\n\n在给定的特定备择假设下，即真实均值为 $\\mu_1 = 0.70, \\mu_2 = 0.75, \\mu_3 = 0.80, \\mu_4 = 0.75$，F统计量服从非中心F分布，其自由度为 $\\nu_1=3, \\nu_2=28$，并带有一个非中心参数 $\\lambda$。\n\n非中心参数的计算公式为：\n$$\n\\lambda = \\frac{n}{\\sigma^2} \\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2\n$$\n其中 $\\bar{\\mu}$ 是特定备择假设下总体均值的总平均值。\n\n我们首先计算 $\\bar{\\mu}$：\n$$\n\\bar{\\mu} = \\frac{1}{k} \\sum_{i=1}^{k} \\mu_i = \\frac{0.70 + 0.75 + 0.80 + 0.75}{4} = \\frac{3.00}{4} = 0.75\n$$\n\n接下来，我们计算各组均值与总平均值之间的离差平方和：\n$$\n\\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2 = (0.70 - 0.75)^2 + (0.75 - 0.75)^2 + (0.80 - 0.75)^2 + (0.75 - 0.75)^2\n$$\n$$\n\\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2 = (-0.05)^2 + (0)^2 + (0.05)^2 + (0)^2 = 0.0025 + 0 + 0.0025 + 0 = 0.0050\n$$\n\n现在我们可以计算非中心参数 $\\lambda$：\n$$\n\\lambda = \\frac{n}{\\sigma^2} \\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2 = \\frac{8}{0.0144} \\times 0.0050\n$$\n$$\n\\lambda = \\frac{0.04}{0.0144} = \\frac{400}{144} = \\frac{100}{36} = \\frac{25}{9}\n$$\n所以，$\\lambda \\approx 2.777...$。\n\n检验的功效是在该备择假设为真时拒绝 $H_0$ 的概率。这意味着要找到观测到的F统计量（服从非中心F分布 $F'$）大于临界值 $F_c$ 的概率。\n$$\n\\text{Power} = P(F' > F_c | H_1 \\text{ is true})\n$$\n该非中心F分布的参数为 $\\nu_1=3, \\nu_2=28$ 和 $\\lambda = 25/9$。\n\n功效可以使用非中心F分布的累积分布函数（CDF）$F_{\\nu_1, \\nu_2, \\lambda}(x)$ 来计算：\n$$\n\\text{Power} = 1 - P(F' \\le F_c) = 1 - F_{\\nu_1, \\nu_2, \\lambda}(F_c)\n$$\n题目提供了在临界值处、相关参数下的累积分布函数值：$F_{\\nu_1, \\nu_2, \\lambda}(F_c) = 0.1983$。“相关参数”确实是我们计算出的那些（$\\nu_1=3, \\nu_2=28, \\lambda=25/9$）。\n\n因此，功效为：\n$$\n\\text{Power} = 1 - 0.1983 = 0.8017\n$$\n问题要求的是实验正确拒绝原假设的概率，这正是检验的功效。结果已经是四位有效数字。", "answer": "$$\\boxed{0.8017}$$", "id": "1960646"}]}