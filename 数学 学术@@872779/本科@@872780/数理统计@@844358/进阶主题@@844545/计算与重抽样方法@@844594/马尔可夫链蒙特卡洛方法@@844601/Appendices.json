{"hands_on_practices": [{"introduction": "Metropolis-Hastings 算法的核心在于其接受-拒绝机制，它确保了马尔可夫链能够收敛到目标分布。这个机制由一个接受概率 $ \\alpha $ 控制，该概率决定了是否接受一个从当前状态到提议状态的转移。通过这个具体的计算练习 [@problem_id:1371728]，你将亲手计算这一核心概率，从而加深对算法工作原理的理解。", "problem": "一位数据科学家正在实现一个马尔可夫链蒙特卡洛（MCMC）模拟，以从参数 $x$ 的后验概率分布中抽取样本。目标分布 $\\pi(x)$ 与参数负绝对值的指数成正比，即 $\\pi(x) \\propto \\exp(-|x|)$。\n\n该科学家使用 Metropolis 算法，并采用一个对称提议分布 $q(x'|x)$，其中给定当前状态 $x$ 提议新状态 $x'$ 的概率等于给定 $x'$ 提议 $x$ 的概率（即 $q(x'|x) = q(x|x')$）。\n\n假设在模拟的某一步中，链的当前状态为 $x = 1.5$。算法接着提议移动到一个新的候选状态 $x' = 2.0$。\n\n计算这一特定移动的接受概率。您的答案应该是一个无量纲的实数。将您的最终答案四舍五入到四位有效数字。", "solution": "对于一个从 $x$ 到 $x'$ 的移动，当使用对称提议分布 $q(x'|x)=q(x|x')$ 时，Metropolis 接受概率为\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\frac{\\pi(x')q(x|x')}{\\pi(x)q(x'|x)}\\right)=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x)}\\right).\n$$\n给定目标分布 $\\pi(x)\\propto \\exp(-|x|)$，该比率可简化为\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\frac{\\exp(-|x'|)}{\\exp(-|x|)}=\\exp\\!\\left(-\\left(|x'|-|x|\\right)\\right).\n$$\n当 $x=1.5$ 且 $x'=2.0$ 时，我们有 $|x|=1.5$ 和 $|x'|=2.0$，所以\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\exp\\!\\left(-\\left(2.0-1.5\\right)\\right)=\\exp(-0.5).\n$$\n因此，\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\exp(-0.5)\\right)=\\exp(-0.5).\n$$\n数值上，$\\exp(-0.5)\\approx 0.6065$（四舍五入到四位有效数字）。", "answer": "$$\\boxed{0.6065}$$", "id": "1371728"}, {"introduction": "在实践中，MCMC 算法的效率至关重要，而这通常取决于算法参数的精心调优。对于随机游走 Metropolis 算法而言，提议分布的宽度（或步长）是一个关键的调节参数。这个练习 [@problem_id:1932810] 旨在引导你思考提议步长对算法性能的影响，让你深入理解在高接受率和快速探索状态空间之间的权衡，这是优化 MCMC 模拟效率的一项基本技能。", "problem": "一位分析师正在使用马尔可夫链蒙特卡罗（MCMC）方法，特别是随机游走 Metropolis 算法，从定义在实数线上的一个连续、单峰的目标概率密度函数 $\\pi(x)$ 中生成样本。该算法按以下方式进行：给定链的当前状态为 $x^{(t)}$，从一个对称的提议分布 $q(x'|x^{(t)})$ 中提议一个新的候选状态 $x'$。在这个具体的实现中，提议是通过添加一个随机扰动来生成的：$x' = x^{(t)} + \\epsilon$，其中 $\\epsilon$ 从均值为 0、标准差为 $\\sigma$ 的正态分布中抽取，即 $\\epsilon \\sim N(0, \\sigma^2)$。提议的状态 $x'$ 以概率 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$ 被接受为下一个状态 $x^{(t+1)} = x'$。如果提议被拒绝，链将保持在当前状态，即 $x^{(t+1)} = x^{(t)}$。\n\n分析师正在试验提议分布标准差的两种不同设置：\n1.  一个非常窄的提议分布，其中 $\\sigma = \\sigma_{small}$ 是一个非常小的正数。\n2.  一个非常宽的提议分布，其中 $\\sigma = \\sigma_{large}$ 是一个非常大的正数。\n\n假设链已在一个具有不可忽略概率的区域（例如，在 $\\pi(x)$ 的峰值附近）被初始化。以下哪个陈述最准确地描述了 MCMC 链在这两种情况下的预期行为？\n\nA. 窄提议 ($\\sigma_{small}$) 会导致低接受率和缓慢的探索。宽提议 ($\\sigma_{large}$) 会导致高接受率和快速的探索。\n\nB. 两种提议宽度都会导致相似的接受率，但使用宽提议 ($\\sigma_{large}$) 的链会比使用窄提议 ($\\sigma_{small}$) 的链更快地探索状态空间。\n\nC. 窄提议 ($\\sigma_{small}$) 会导致非常高的接受率，但链会非常缓慢地探索状态空间。宽提议 ($\\sigma_{large}$) 会导致非常低的接受率，导致链在多次迭代中停留在同一状态。\n\nD. 窄提议 ($\\sigma_{small}$) 会导致高接受率和快速的探索。宽提议 ($\\sigma_{large}$) 会导致低接受率和缓慢的探索。\n\nE. 提议分布的宽度对算法性能的影响可以忽略不计；接受率和探索速度主要由目标分布 $\\pi(x)$ 的属性决定。", "solution": "问题要求我们分析随机游走 Metropolis 算法的行为，重点关注提议分布 $N(0, \\sigma^2)$ 的宽度（标准差 $\\sigma$）如何影响链的接受率及其探索目标分布 $\\pi(x)$ 状态空间的能力。\n\n从 $x^{(t)}$ 到 $x'$ 的提议移动的接受概率由 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$ 给出。让我们分别分析这两种情况。\n\n**情况1：窄提议分布 ($\\sigma = \\sigma_{small}$)**\n\n当标准差 $\\sigma_{small}$ 非常小时，从 $N(0, \\sigma_{small}^2)$ 中抽取的随机扰动 $\\epsilon$ 的量级也会非常小。这意味着提议的状态 $x' = x^{(t)} + \\epsilon$ 将非常接近当前状态 $x^{(t)}$。\n\n由于目标分布 $\\pi(x)$ 是连续的，如果 $x'$ 非常接近 $x^{(t)}$，那么这两点的概率密度值 $\\pi(x')$ 和 $\\pi(x^{(t)})$ 将会非常相似。\n因此，比率 $\\frac{\\pi(x')}{\\pi(x^{(t)})}$ 将非常接近 1。\n\n接受概率为 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$。由于该比率接近 1，接受概率 $\\alpha$ 将会非常高（接近 1）。这意味着几乎每一个提议的移动都将被接受。\n\n然而，由于每次接受的移动都只是离前一个位置迈出了一小步，链在状态空间中的移动非常缓慢。这是一种探索目标分布 $\\pi(x)$ 全范围（尤其是尾部）的低效方式。链表现出高度的自相关性，意味着连续的样本高度相关，需要非常大量的迭代才能获得一组具有代表性的独立样本。这构成了非常缓慢的探索。\n\n**情况2：宽提议分布 ($\\sigma = \\sigma_{large}$)**\n\n当标准差 $\\sigma_{large}$ 非常大时，随机扰动 $\\epsilon$ 的量级通常会很大。这意味着提议的状态 $x' = x^{(t)} + \\epsilon$ 很可能离当前状态 $x^{(t)}$ 非常远。\n\n我们已知目标分布 $\\pi(x)$ 是单峰的，且链从一个高概率区域（峰值附近）开始。当链处于这样一个区域时，$\\pi(x^{(t)})$ 相对较大。从 $x^{(t)}$ 进行一个大的跳跃很可能落入分布尾部的遥远区域，那里的概率密度极低。因此，$\\pi(x') \\ll \\pi(x^{(t)})$ 的可能性非常高。\n\n在这种情况下，比率 $\\frac{\\pi(x')}{\\pi(x^{(t)})}$ 将非常接近 0。\n\n接受概率为 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$。由于该比率非常小，接受概率 $\\alpha$ 也将非常小。这意味着绝大多数提议的移动都将被拒绝。\n\n当一个提议被拒绝时，链不会移动：$x^{(t+1)} = x^{(t)}$。因此，对于一个宽的提议分布，链将在许多连续的迭代中停留在同一状态，等待一个罕见的、恰好落入另一个高概率区域的提议。这也是一种非常低效的状态空间探索方式。\n\n**结论与选项评估：**\n\n-   窄提议导致**高接受率**但**探索缓慢**。\n-   宽提议导致**低接受率**和**探索缓慢**（因为链会卡住）。\n\n让我们基于此分析评估给定的选项：\n\n-   **A：** 错误。它声称宽提议导致高接受率。\n-   **B：** 错误。它声称两者的接受率相似。\n-   **C：** 这个陈述正确地捕捉了两种行为。窄提议导致高接受率但探索缓慢。宽提议导致非常低的接受率，使链卡住。这是最准确的描述。\n-   **D：** 错误。它声称窄提议导致快速探索。\n-   **E：** 错误。提议分布的宽度是一个关键的调整参数，它深刻地影响算法的性能。\n\n因此，最准确的陈述是C。", "answer": "$$\\boxed{C}$$", "id": "1932810"}, {"introduction": "当直接从复杂的多维联合分布中采样很困难时，吉布斯采样提供了一种强大的替代方案。该方法通过迭代地从每个变量的全条件分布中进行抽样来逼近目标分布。构建吉布斯采样器的关键预备步骤是正确推导这些全条件分布。这个练习 [@problem_id:1932854] 将让你实践这一核心技能，为你将来在多维统计模型中应用吉布斯采样打下坚实的基础。", "problem": "吉布斯采样（Gibbs sampler）是一种马尔可夫链蒙特卡洛（MCMC）算法，用于生成一系列观测值来近似目标多元概率分布，当直接采样困难时尤其有用。实现吉布斯采样的一个关键步骤是推导模型中每个变量的全条件分布。\n\n考虑一个二元随机向量 $(X, Y)$，其联合概率密度函数（PDF）$p(x, y)$ 在 $xy$-平面上的一个三角形区域 $\\mathcal{R}$ 上是均匀分布的。区域 $\\mathcal{R}$ 由不等式 $x>0$，$y>0$ 和 $x+y  1$ 定义。因此，联合概率密度函数为：\n$$\np(x, y) =\n\\begin{cases}\n2  \\text{if } (x,y) \\in \\mathcal{R} \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n为了构建此分布的吉布斯采样器，我们需要全条件分布 $p(x|y)$ 和 $p(y|x)$。\n\n以下哪个选项正确地指出了这两个条件分布？请注意，$\\text{Uniform}(a,b)$ 表示在区间 $(a,b)$ 上的均匀分布。\n\nA：对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, 1-y)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, 1-x)$ 分布。\n\nB：对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, 1)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, 1)$ 分布。\n\nC：对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, y)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, x)$ 分布。\n\nD：条件分布不是均匀分布。\n\nE：对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(y, 1)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(x, 1)$ 分布。", "solution": "要推导全条件分布，我们需要使用条件概率的定义 $p(x|y) = p(x,y) / p(y)$。首先，我们求 $Y$ 的边缘分布 $p(y)$。联合分布 $p(x,y)$ 在由 $x>0, y>0, x+y1$ 定义的三角形区域 $\\mathcal{R}$ 上为常数2。对于一个固定的 $y \\in (0,1)$，为了使 $(x,y)$ 落在 $\\mathcal{R}$ 内，$x$ 必须满足 $0  x  1-y$。因此，$Y$ 的边缘概率密度函数为：\n$$p(y) = \\int_0^{1-y} p(x,y) dx = \\int_0^{1-y} 2 \\,dx = 2(1-y)$$\n现在我们可以计算 $X$ 的条件分布：\n$$p(x|y) = \\frac{p(x,y)}{p(y)} = \\frac{2}{2(1-y)} = \\frac{1}{1-y}, \\quad \\text{对于 } 0  x  1-y$$\n这是一个在区间 $(0, 1-y)$ 上的均匀分布。\n通过对称性，我们可以推断出 $Y$ 关于 $X$ 的条件分布。对于一个固定的 $x \\in (0,1)$，$y$ 必须满足 $0  y  1-x$。$X$ 的边缘概率密度函数为：\n$$p(x) = \\int_0^{1-x} 2 \\,dy = 2(1-x)$$\n因此，$Y$ 的条件分布为：\n$$p(y|x) = \\frac{p(x,y)}{p(x)} = \\frac{2}{2(1-x)} = \\frac{1}{1-x}, \\quad \\text{对于 } 0  y  1-x$$\n这是一个在区间 $(0, 1-x)$ 上的均匀分布。因此，选项A是正确的。", "answer": "$$\\boxed{A}$$", "id": "1932854"}]}