{"hands_on_practices": [{"introduction": "理解吉布斯采样器工作原理的最佳方法是亲手执行一次。这个练习将引导你完成一个完整的吉布斯采样迭代，将抽象的理论转化为具体的计算步骤。通过使用逆变换采样法从给定的条件分布中抽取样本，你将揭开吉布斯采样算法的神秘面纱，并掌握其核心操作机制。[@problem_id:1920320]", "problem": "考虑一个二维随机向量 $(X, Y)$，其联合概率分布由以下完全条件分布定义：\n- 给定 $Y=y$ 时 $X$ 的条件分布是速率参数为 $y$ 的指数分布。其概率密度函数为 $p(x|y) = y \\exp(-yx)$，其中 $x > 0$。\n- 给定 $X=x$ 时 $Y$ 的条件分布是均值参数为 $x$ 的泊松分布。其概率质量函数为 $p(y=k|x) = \\frac{x^k \\exp(-x)}{k!}$，其中 $k \\in \\{0, 1, 2, \\dots\\}$。\n\n您的任务是执行一次吉布斯采样器的完整迭代。从初始状态 $(x^{(0)}, y^{(0)}) = (2, 3)$ 开始，您将生成一个新状态 $(x^{(1)}, y^{(1)})$。迭代过程如下：首先，从分布 $p(x|y^{(0)})$ 中为 $x^{(1)}$ 抽取一个样本；然后，使用这个新值 $x^{(1)}$，从分布 $p(y|x^{(1)})$ 中为 $y^{(1)}$ 抽取一个样本。\n\n为了生成所需的随机变量，您必须使用逆变换采样法。请使用以下从均匀分布 Uniform(0,1) 中抽取的随机数：\n- 生成 $x^{(1)}$ 时，使用均匀随机数 $u_x = 0.600$。\n- 生成 $y^{(1)}$ 时，使用均匀随机数 $u_y = 0.750$。\n\n新状态 $(x^{(1)}, y^{(1)})$ 的数值是多少？$x^{(1)}$ 的值必须四舍五入到四位有效数字。", "solution": "我们使用逆变换采样法执行一次吉布斯更新。\n\n1) 从 $p(x \\mid y^{(0)}=3)$ 中采样 $x^{(1)}$。\n对于速率为 $y$ 的指数分布，其条件累积分布函数 (CDF) 为\n$$\nF(x \\mid y)=1-\\exp(-yx), \\quad x>0.\n$$\n逆变换采样法使用 $u_{x}=F(x \\mid y)$，因此\n$$\nx^{(1)}=F^{-1}(u_{x})=-\\frac{1}{y^{(0)}}\\ln\\!\\bigl(1-u_{x}\\bigr).\n$$\n当 $y^{(0)}=3$ 且 $u_{x}=0.600$ 时，\n$$\nx^{(1)}=-\\frac{1}{3}\\ln(1-0.600)=-\\frac{1}{3}\\ln(0.4)=\\frac{1}{3}\\ln(2.5)\\approx 0.3054302439.\n$$\n四舍五入到四位有效数字：$x^{(1)}=0.3054$。\n\n2) 使用 $u_{y}=0.750$ 从 $p(y \\mid x^{(1)})$ 中采样 $y^{(1)}$。\n对于均值为 $x$ 的泊松分布，其概率质量函数 (pmf) 为\n$$\np(y=k \\mid x)=\\frac{x^{k}\\exp(-x)}{k!}, \\quad k\\in\\{0,1,2,\\dots\\}.\n$$\n对于离散分布，逆变换采样法选择满足 $F(k \\mid x)=\\sum_{j=0}^{k}p(j \\mid x)\\ge u_{y}$ 的最小 $k$。\n\n当 $x=x^{(1)}=\\frac{1}{3}\\ln(2.5)$ 时，计算\n$$\np(0 \\mid x)=\\exp(-x)=\\exp\\!\\Bigl(-\\tfrac{1}{3}\\ln(2.5)\\Bigr)=2.5^{-1/3}\\approx 0.7368.\n$$\n由于 $p(0 \\mid x) \\approx 0.7368  0.750$，继续计算 $k=1$ 的情况：\n$$\np(1 \\mid x)=x\\exp(-x)=x\\,2.5^{-1/3}\\approx 0.30543\\times 0.7368\\approx 0.2250.\n$$\n那么\n$$\nF(1 \\mid x)=p(0 \\mid x)+p(1 \\mid x)\\approx 0.7368+0.2250=0.96180.750,\n$$\n因此，满足 $F(k \\mid x)\\ge 0.750$ 的最小 $k$ 是 $k=1$。所以 $y^{(1)}=1$。\n\n因此，新状态为 $(x^{(1)},y^{(1)})=(0.3054,1)$，其中 $x^{(1)}$ 已四舍五入到四位有效数字。", "answer": "$$\\boxed{\\begin{pmatrix}0.3054  1\\end{pmatrix}}$$", "id": "1920320"}, {"introduction": "在掌握了吉布斯采样的基本机理之后，理解采样器的效率为何会变化至关重要。这个练习通过一个思想实验，探讨了目标分布的结构（特别是变量间的相关性）如何显著影响采样器的性能。通过对比低相关性和高相关性两种情况，你将对MCMC方法中常见的挑战——高自相关和慢混合——建立起直观的认识。[@problem_id:1363771]", "problem": "一位统计学家正在使用吉布斯采样器（一种马尔可夫链蒙特卡洛（MCMC）算法）从一个二元概率分布中抽取样本。对于一个二元分布 $p(x, y)$，其一般流程如下：\n1.  从一个任意的起始点 $(x_0, y_0)$ 开始。\n2.  对于每次迭代 $t=1, 2, \\dots, N$：\n    a. 从全条件分布 $p(x | y = y_{t-1})$ 中采样一个新值 $x_t$。\n    b. 从全条件分布 $p(y | x = x_t)$ 中采样一个新值 $y_t$。\n得到的点序列 $\\{(x_t, y_t)\\}_{t=1}^N$ 形成一个马尔可夫链，其平稳分布是目标分布 $p(x, y)$。\n\n该统计学家对两个特定的目标分布感兴趣，它们都是均值为 $\\mu_X = \\mu_Y = 0$、标准差为 $\\sigma_X = \\sigma_Y = 1$ 的二元正态分布。这两个分布仅在相关系数 $\\rho$ 上有所不同。\n-   **分布 A**：一个相关系数为 $\\rho_A = 0.1$ 的二元正态分布。\n-   **分布 B**：一个相关系数为 $\\rho_B = 0.98$ 的二元正态分布。\n\n该统计学家对每个分布运行吉布斯采样器，并生成两个长的样本点序列。当在 $xy$ 平面上绘制这些序列的路径时，观察到两种截然不同的定性行为，描述如下。\n\n-   **路径描述 1**：点序列在整个样本空间中自由移动。从一个点 $(x_{t-1}, y_{t-1})$ 到下一个点 $(x_t, y_t)$ 的转换可以产生较大的位移，路径迅速覆盖了分布概率质量的主要、近乎圆形的区域。\n-   **路径描述 2**：点序列表现出高度自相关、增量式的移动。路径的特点是一系列小的、与坐标轴对齐的步进，形成一个独特的阶梯状轨迹，缓慢地穿过分布概率质量的狭窄椭圆区域。\n\n以下哪个陈述正确地将分布与观察到的采样器路径描述相匹配？\n\nA. 分布 A 对应路径 2，分布 B 对应路径 1。\n\nB. 两种分布都会生成类似于路径 1 的路径。\n\nC. 分布 A 对应路径 1，分布 B 对应路径 2。\n\nD. 两种分布都会生成类似于路径 2 的路径。\n\nE. 路径特征与相关性无关，仅取决于所使用的随机种子。", "solution": "这个问题的核心是理解二元正态分布的相关系数 $\\rho$ 如何影响吉布斯采样器的行为。关键在于用于采样的条件分布的性质。\n\n对于一个均值为 $(\\mu_X, \\mu_Y)$、标准差为 $(\\sigma_X, \\sigma_Y)$、相关系数为 $\\rho$ 的一般二元正态分布 $(X, Y)$，其全条件分布也是正态分布：\n1.  在给定 $Y=y$ 的条件下，$X$ 的分布为 $X | (Y=y) \\sim \\mathcal{N}\\left(\\mu_X + \\rho\\frac{\\sigma_X}{\\sigma_Y}(y - \\mu_Y), \\sigma_X^2(1-\\rho^2)\\right)$。\n2.  在给定 $X=x$ 的条件下，$Y$ 的分布为 $Y | (X=x) \\sim \\mathcal{N}\\left(\\mu_Y + \\rho\\frac{\\sigma_Y}{\\sigma_X}(x - \\mu_X), \\sigma_Y^2(1-\\rho^2)\\right)$。\n\n在我们特定的问题中，参数被简化为：$\\mu_X = \\mu_Y = 0$ 且 $\\sigma_X = \\sigma_Y = 1$。将这些值代入通用公式，我们得到这个特定情况下的条件分布：\n1.  $X | (Y=y) \\sim \\mathcal{N}(\\rho y, 1-\\rho^2)$\n2.  $Y | (X=x) \\sim \\mathcal{N}(\\rho x, 1-\\rho^2)$\n\n在第 $t$ 步，吉布斯采样器从 $p(x | y_{t-1})$ 中采样 $x_t$，然后从 $p(y | x_t)$ 中采样 $y_t$。让我们针对给定的两个分布分析这个过程。\n\n**情况 1：分布 A，相关系数 $\\rho_A = 0.1$ (低相关性)**\n\n对于这个分布，条件分布为：\n-   $X | (Y=y) \\sim \\mathcal{N}(0.1y, 1 - 0.1^2) = \\mathcal{N}(0.1y, 0.99)$。\n-   $Y | (X=x) \\sim \\mathcal{N}(0.1x, 1 - 0.1^2) = \\mathcal{N}(0.1x, 0.99)$。\n\n$x_t$ 的条件分布的均值为 $0.1 y_{t-1}$，对于 $y_{t-1}$ 的典型值来说，这个均值非常接近于零（因为边际方差为 1）。这个条件分布的方差为 $0.99$，这个值很大，接近于边际方差 1。这意味着新值 $x_t$ 是从一个很宽的分布中抽取的，并且仅弱依赖于前一个值 $y_{t-1}$。当从 $p(y|x_t)$ 中采样 $y_t$ 时，也适用类似的逻辑。由于步长是从宽分布中抽取的，并且几乎与前一个状态无关，因此采样器可以进行大的跳跃并有效地探索状态空间。这种行为与**路径描述 1**相匹配。\n\n**情况 2：分布 B，相关系数 $\\rho_B = 0.98$ (高相关性)**\n\n对于这个分布，条件分布为：\n-   $X | (Y=y) \\sim \\mathcal{N}(0.98y, 1 - 0.98^2) = \\mathcal{N}(0.98y, 0.0396)$。\n-   $Y | (X=x) \\sim \\mathcal{N}(0.98x, 1 - 0.98^2) = \\mathcal{N}(0.98x, 0.0396)$。\n\n在这里，情况截然不同。$x_t$ 的条件分布的均值为 $0.98y_{t-1}$。方差为 $0.0396$，这是一个非常小的值。这意味着新值 $x_t$ 将从一个非常窄的分布中抽取，该分布的中心非常接近 $y_{t-1}$ 的值。也就是说，$x_t \\approx 0.98 y_{t-1}$。\n随后，在采样 $y_t$ 时，我们从一个以 $0.98x_t$ 为中心的窄分布中抽取。所以，$y_t \\approx 0.98 x_t$。\n将这些结合起来，我们看到 $y_t \\approx 0.98 (0.98 y_{t-1}) \\approx 0.96 y_{t-1}$。这表明链中连续的值是高度相关的，并且变化非常缓慢。采样器被迫采取非常小的步长。由于每次更新一个变量（首先平行于 x 轴移动，然后平行于 y 轴移动），这个过程在沿着分布的狭窄高概率区域（对于高正相关，该区域位于直线 $y=x$ 附近）缓慢移动时，会产生一个“阶梯状”或“之字形”的模式。这种行为与**路径描述 2**相匹配。\n\n**结论**\n\n-   分布 A（低相关性）导致高效的探索，步长大且相关性较低，与路径 1 相匹配。\n-   分布 B（高相关性）导致缓慢的探索，步长小、高度相关且与坐标轴对齐，与路径 2 相匹配。\n\n因此，正确的匹配是分布 A 对应路径 1，分布 B 对应路径 2。这对应于选项 C。根据此分析，选项 A、B、D 和 E 是不正确的。", "answer": "$$\\boxed{C}$$", "id": "1363771"}, {"introduction": "对采样器性能的直观判断固然有益，但严谨的分析离不开定量的评估。本练习将介绍Gelman-Rubin诊断法，这是检验MCMC收敛性的基石。通过根据给定的链统计数据推导潜在尺度缩减因子 $\\hat{R}$，你将亲身体验我们如何通过比较链内方差和链间方差来诊断收敛性，从而将抽象的收敛性概念付诸实践。[@problem_id:764139]", "problem": "在贝叶斯统计中，马尔可夫链蒙特卡洛（MCMC）方法，例如吉布斯采样，是近似复杂后验分布的基础。应用MCMC的一个关键方面是评估采样器是否收敛到其目标平稳分布。Gelman-Rubin诊断为此提供了一种形式化方法，它通过计算潜在尺度缩减因子 $\\hat{R}$ 来实现。该因子比较了多个并行MCMC链的链内方差与它们之间的链间方差。$\\hat{R}$ 值接近1表明链已收敛。\n\n对于一个感兴趣的标量参数 $\\psi$，假设我们运行 $m$ 条并行的MCMC链，每条链的长度为 $n$（在初始老化期之后）。令 $\\bar{\\psi}_{i}$ 和 $s_i^2$ 分别为第 $i$ 条链的样本均值和方差，其中 $i=1, \\dots, m$。Gelman-Rubin诊断的关键量如下：\n\n1.  平均链内方差 $W$：\n    $$W = \\frac{1}{m} \\sum_{i=1}^{m} s_i^2$$\n2.  链间方差 $B$：\n    $$B = \\frac{n}{m-1} \\sum_{i=1}^{m} (\\bar{\\psi}_{i} - \\bar{\\psi}_{..})^2$$\n    其中 $\\bar{\\psi}_{..} = \\frac{1}{m} \\sum_{i=1}^{m} \\bar{\\psi}_{i}$ 是所有链中所有样本的总均值。\n3.  $\\psi$ 的边际后验方差的估计值 $\\hat{V}$：\n    $$\\hat{V} = \\frac{n-1}{n}W + \\frac{1}{n}B$$\n4.  潜在尺度缩减因子 $\\hat{R}$：\n    $$\\hat{R} = \\sqrt{\\frac{\\hat{V}}{W}}$$\n\n考虑一个场景，其中运行两条并行的吉布斯采样链（$m=2$），每条链运行 $N$ 次迭代，以估计一个标量参数。运行结束后，两条链的汇总统计量参数化如下：\n-   样本均值为 $\\bar{\\psi}_{1} = \\mu - \\delta$ 和 $\\bar{\\psi}_{2} = \\mu + \\delta$。\n-   样本方差为 $s_1^2 = \\sigma^2(1 - \\epsilon)$ 和 $s_2^2 = \\sigma^2(1 + \\epsilon)$。\n\n参数 $N, \\mu, \\delta, \\sigma^2, \\epsilon$ 是实常数，其中 $N1$ 是一个整数，$\\sigma^2  0$，$\\delta \\ge 0$ 且 $|\\epsilon|  1$。\n\n推导潜在尺度缩减因子 $\\hat{R}$ 关于 $N$、$\\delta$ 和 $\\sigma^2$ 的简化表达式。", "solution": "1. 链内方差：\n$$W = \\frac{1}{2}\\bigl(s_1^2 + s_2^2\\bigr)\n= \\frac{1}{2}\\bigl(\\sigma^2(1-\\epsilon)+\\sigma^2(1+\\epsilon)\\bigr)\n= \\sigma^2.$$\n\n2. 总均值：\n$$\\bar\\psi_{..} = \\frac{1}{2}\\bigl((\\mu-\\delta)+(\\mu+\\delta)\\bigr)=\\mu.$$\n\n3. 链间方差（$m-1=1$, $n=N$）：\n$$B = \\frac{N}{1}\\Bigl[(\\bar\\psi_1-\\bar\\psi_{..})^2+(\\bar\\psi_2-\\bar\\psi_{..})^2\\Bigr]\n= N\\bigl[(-\\delta)^2+(\\delta)^2\\bigr]\n= 2N\\delta^2.$$\n\n4. 边际后验方差估计：\n$$\\hat V = \\frac{N-1}{N}W + \\frac{1}{N}B\n= \\frac{N-1}{N}\\sigma^2 + \\frac{1}{N}(2N\\delta^2)\n= \\frac{N-1}{N}\\sigma^2 + 2\\delta^2.$$\n\n5. 潜在尺度缩减因子：\n$$\\hat R = \\sqrt{\\frac{\\hat V}{W}}\n= \\sqrt{\\frac{\\tfrac{N-1}{N}\\sigma^2 + 2\\delta^2}{\\sigma^2}}\n= \\sqrt{\\frac{N-1}{N} + \\frac{2\\delta^2}{\\sigma^2}}.$$", "answer": "$$\\boxed{\\sqrt{\\frac{N-1}{N} + \\frac{2\\delta^2}{\\sigma^2}}}$$", "id": "764139"}]}