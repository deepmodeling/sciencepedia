{"hands_on_practices": [{"introduction": "掌握变量变换技术的第一步是处理最基本的情形：对单个随机变量进行单调函数变换。这个练习将引导你完成这一基本操作，通过为一个已知分布的随机变量（卡方分布）应用一个简单的函数（平方根）来推导新的概率密度函数（PDF）。这个过程不仅能巩固变量变换方法的核心步骤，还能揭示统计学中两个重要分布（卡方分布和半正态分布）之间的深刻联系 [@problem_id:1956488]。", "problem": "设 $X$ 是一个服从自由度为1的卡方分布的随机变量，记为 $X \\sim \\chi^2(1)$。自由度为 $k$ 的卡方分布的概率密度函数 (PDF) 的一般形式由下式给出：\n$$f_X(x; k) = \\frac{1}{2^{k/2} \\Gamma\\left(\\frac{k}{2}\\right)} x^{\\frac{k}{2} - 1} \\exp\\left(-\\frac{x}{2}\\right), \\quad \\text{for } x  0$$\n其中 $\\Gamma(z)$ 是伽马函数。已知 $\\Gamma(1/2) = \\sqrt{\\pi}$。\n\n考虑一个新的随机变量 $Y$，定义为 $X$ 的平方根，即 $Y = \\sqrt{X}$。\n下列哪个表达式正确表示了随机变量 $Y$ 的概率密度函数，记为 $f_Y(y)$？\n\nA. $f_Y(y) = \\sqrt{\\frac{2}{\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$，其中 $y  0$\n\nB. $f_Y(y) = y \\exp\\left(-\\frac{y^2}{2}\\right)$，其中 $y  0$\n\nC. $f_Y(y) = \\frac{1}{2}\\exp\\left(-\\frac{y}{2}\\right)$，其中 $y  0$\n\nD. $f_Y(y) = \\frac{1}{\\sqrt{2\\pi y}} \\exp\\left(-\\frac{y}{2}\\right)$，其中 $y  0$\n\nE. $f_Y(y) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$，其中 $y  0$", "solution": "我们从自由度为1的卡方密度函数出发。当 $k=1$ 时，$X$ 的概率密度函数为\n$$\nf_{X}(x) = \\frac{1}{2^{1/2}\\Gamma\\left(\\frac{1}{2}\\right)} x^{\\frac{1}{2}-1} \\exp\\left(-\\frac{x}{2}\\right), \\quad x0.\n$$\n使用 $\\Gamma\\left(\\frac{1}{2}\\right)=\\sqrt{\\pi}$，上式可简化为\n$$\nf_{X}(x) = \\frac{1}{2^{1/2}\\sqrt{\\pi}}\\, x^{-1/2}\\, \\exp\\left(-\\frac{x}{2}\\right), \\quad x0.\n$$\n定义 $Y=\\sqrt{X}$。则变换为 $x = y^{2}$，其中 $y0$。由于 $x=y^{2}$ 在 $y0$ 上是严格递增的，根据变量变换公式可得\n$$\nf_{Y}(y) = f_{X}(x)\\left|\\frac{dx}{dy}\\right| \\bigg|_{x=y^{2}} = f_{X}\\left(y^{2}\\right)\\cdot 2y, \\quad y0.\n$$\n将 $x=y^{2}$ 代入 $f_{X}$ 中，\n$$\nf_{X}\\left(y^{2}\\right) = \\frac{1}{2^{1/2}\\sqrt{\\pi}} \\left(y^{2}\\right)^{-1/2} \\exp\\left(-\\frac{y^{2}}{2}\\right) = \\frac{1}{2^{1/2}\\sqrt{\\pi}} \\cdot \\frac{1}{y}\\, \\exp\\left(-\\frac{y^{2}}{2}\\right).\n$$\n因此，\n$$\nf_{Y}(y) = \\frac{1}{2^{1/2}\\sqrt{\\pi}} \\cdot \\frac{1}{y}\\, \\exp\\left(-\\frac{y^{2}}{2}\\right)\\cdot 2y = \\frac{2}{2^{1/2}\\sqrt{\\pi}} \\exp\\left(-\\frac{y^{2}}{2}\\right) = \\sqrt{\\frac{2}{\\pi}}\\, \\exp\\left(-\\frac{y^{2}}{2}\\right), \\quad y0.\n$$\n这与选项A相符。", "answer": "$$\\boxed{A}$$", "id": "1956488"}, {"introduction": "在掌握了单变量变换之后，一个自然的延伸是处理涉及多个随机变量的函数。本练习探讨了一个常见且重要的问题：求两个独立的随机变量之和的分布。这个问题中的模型，即将信号（指数分布）与噪声（正态分布）相加，在物理学和工程学中非常普遍。解决这个问题需要使用卷积积分，这本身就是二维变量变换技术的一个直接结果，它将帮助你把基本技能扩展到更复杂、更实际的应用场景中 [@problem_id:1902973]。", "problem": "在一个简化的粒子探测器模型中，一次事件记录到的能量 $Z$ 是两个独立分量的和：粒子的真实能量 $Y$ 和一个随机电子噪声分量 $X$。噪声 $X$ 被建模为一个服从标准正态分布的随机变量。其概率密度函数 (PDF) 为 $f_X(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^2}{2}\\right)$，其中 $-\\infty  x  \\infty$。真实能量 $Y$ 被建模为一个服从指数分布的随机变量，其率参数为 $\\lambda  0$。其 PDF 由 $f_Y(y) = \\lambda \\exp(-\\lambda y)$（当 $y \\ge 0$ 时）和 $f_Y(y) = 0$（当 $y  0$ 时）给出。总记录能量为 $Z = X+Y$。\n\n作为参考，标准正态随机变量的累积分布函数 (CDF) 表示为 $\\Phi(v) = \\int_{-\\infty}^{v} \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{t^2}{2}\\right) dt$。\n\n求随机变量 $Z$ 的 PDF，$f_Z(z)$。请将您的答案表示为单一的闭式解析表达式。", "solution": "设 $X$ 和 $Y$ 独立，其中 $X \\sim \\mathcal{N}(0,1)$ 且 $Y \\sim \\text{Exp}(\\lambda)$。和 $Z=X+Y$ 的 PDF 由卷积给出\n$$\nf_{Z}(z)=\\int_{-\\infty}^{\\infty} f_{X}(z-y) f_{Y}(y) \\, dy.\n$$\n由于当 $y0$ 时 $f_{Y}(y)=0$，这可以简化为\n$$\nf_{Z}(z)=\\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(z-y)^{2}}{2}\\right) \\, \\lambda \\exp(-\\lambda y) \\, dy.\n$$\n合并指数部分：\n$$\n-\\frac{(z-y)^{2}}{2}-\\lambda y=-\\frac{z^{2}}{2}+zy-\\frac{y^{2}}{2}-\\lambda y=-\\frac{1}{2}\\left(y-(z-\\lambda)\\right)^{2}+\\frac{1}{2}(z-\\lambda)^{2}-\\frac{z^{2}}{2}.\n$$\n因此，\n$$\nf_{Z}(z)=\\lambda \\exp\\!\\left(\\frac{1}{2}(z-\\lambda)^{2}-\\frac{z^{2}}{2}\\right)\\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{1}{2}\\left(y-(z-\\lambda)\\right)^{2}\\right) dy.\n$$\n换元 $t=y-(z-\\lambda)$，则当 $y=0$ 时，$t=-(z-\\lambda)$，且当 $y \\to \\infty$ 时，$t \\to \\infty$。积分变为\n$$\n\\int_{-(z-\\lambda)}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{t^{2}}{2}\\right) dt\n=1-\\Phi\\!\\left(-(z-\\lambda)\\right)=\\Phi(z-\\lambda).\n$$\n简化前面的因子，\n$$\n\\frac{1}{2}(z-\\lambda)^{2}-\\frac{z^{2}}{2}=-\\lambda z+\\frac{\\lambda^{2}}{2}.\n$$\n因此，\n$$\nf_{Z}(z)=\\lambda \\exp\\!\\left(-\\lambda z+\\frac{\\lambda^{2}}{2}\\right)\\Phi(z-\\lambda), \\quad -\\infty  z  \\infty.\n$$", "answer": "$$\\boxed{\\lambda \\exp\\!\\left(-\\lambda z+\\frac{\\lambda^{2}}{2}\\right)\\Phi(z-\\lambda)}$$", "id": "1902973"}, {"introduction": "现实世界中的许多变换并不是简单的“一对一”关系，这为寻找新变量的分布带来了额外的挑战。这个练习将带你进入一个更高级的领域：处理非单调函数变换。我们将研究一个来自信息论的概念——香农熵，它是一个对称函数，意味着多个输入值可以映射到同一个输出值。通过解决这个问题，你将学会如何推广变量变换公式以应对这种情况，这需要对函数的每个“分支”的贡献进行求和，从而为你处理更广泛、更复杂的变换问题提供了一个强大的通用框架 [@problem_id:1902960]。", "problem": "在贝叶斯统计模型中，未知的成功概率 $P$ 被视为一个随机变量。$P$ 的一个常用无信息先验分布是区间 $(0, 1)$ 上的连续均匀分布。相关伯努利试验的不确定性由香农熵量化，香农熵本身也是一个随机变量 $S$，由变换 $S = H(P) = -P\\log_2(P) - (1-P)\\log_2(1-P)$ 给出。$S$ 的概率密度函数 (PDF) 记为 $f_S(s)$。找出一个函数 $G(p)$，它给出了该 PDF 的一个参数表示，使得对于定义在区间 $(0, 1/2)$ 上的参数 $p$，有 $f_S(H(p)) = G(p)$。将你的答案表示为 $p$ 的解析函数。", "solution": "设随机变量 $P$ 服从 $(0, 1)$ 上的连续均匀分布。其概率密度函数 (PDF) 为：\n$$\nf_P(p) = \\begin{cases} 1  \\text{if } 0  p  1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n我们关心的是随机变量 $S$ 的分布，它是 $P$ 的一个变换：\n$$\nS = g(P) = -P\\log_2(P) - (1-P)\\log_2(1-P)\n$$\n为了求出 $S$ 的 PDF $f_S(s)$，我们使用变量替换法。首先，我们分析变换函数 $s = g(p)$。我们求它关于 $p$ 的导数：\n$$\n\\frac{ds}{dp} = g'(p) = \\frac{d}{dp} [-p\\log_2(p) - (1-p)\\log_2(1-p)]\n$$\n使用乘法法则和链式求导法则，并回顾 $\\frac{d}{dx}(\\log_b(x)) = \\frac{1}{x \\ln(b)}$：\n$$\n\\frac{d}{dp}(-p\\log_2(p)) = -1 \\cdot \\log_2(p) - p \\cdot \\frac{1}{p \\ln(2)} = -\\log_2(p) - \\frac{1}{\\ln(2)}\n$$\n$$\n\\frac{d}{dp}(-(1-p)\\log_2(1-p)) = - \\left[ (-1)\\log_2(1-p) + (1-p) \\frac{-1}{(1-p)\\ln(2)} \\right] = \\log_2(1-p) + \\frac{1}{\\ln(2)}\n$$\n将这两个结果相加，得到 $g(p)$ 的导数：\n$$\ng'(p) = \\left(-\\log_2(p) - \\frac{1}{\\ln(2)}\\right) + \\left(\\log_2(1-p) + \\frac{1}{\\ln(2)}\\right) = \\log_2(1-p) - \\log_2(p) = \\log_2\\left(\\frac{1-p}{p}\\right)\n$$\n函数 $g(p)$ 关于 $p=1/2$ 对称。函数的草图显示，对于 $g(p)$ 值域中的任何值 $s$，都有两个 $p$ 值映射到 $s$（除了在最大值点 $p=1/2$ 处）。设这两个根为 $p_1$ 和 $p_2$。由于 $g(p)$ 的对称性，如果 $p_1$ 是一个解，那么 $p_2 = 1 - p_1$ 也是一个解。我们可以定义 $p_1$ 为 $(0, 1/2)$ 内的根，$p_2$ 为 $(1/2, 1)$ 内的根。\n\n$S$ 的 PDF 可以使用非一对一变换的公式求得：\n$$\nf_S(s) = \\sum_{i} f_P(p_i(s)) \\left| \\frac{dp_i}{ds} \\right|\n$$\n其中求和是对所有方程 $g(p) = s$ 的根 $p_i$ 进行的。在我们的情况下，对于任何 $s \\in (0,1)$，都有两个根 $p_1$ 和 $p_2$。\n$$\nf_S(s) = f_P(p_1) \\left| \\frac{dp_1}{ds} \\right| + f_P(p_2) \\left| \\frac{dp_2}{ds} \\right|\n$$\n由于 $P$ 在 $(0,1)$ 上是均匀分布的，所以 $p_1$ 和 $p_2$ 都在 $f_P(p)$ 的支撑集内，因此 $f_P(p_1) = 1$ 且 $f_P(p_2) = 1$。表达式简化为：\n$$\nf_S(s) = \\left| \\frac{dp_1}{ds} \\right| + \\left| \\frac{dp_2}{ds} \\right|\n$$\n使用反函数定理，$\\frac{dp}{ds} = \\frac{1}{ds/dp} = \\frac{1}{g'(p)}$。所以我们有：\n$$\nf_S(s) = \\left| \\frac{1}{g'(p_1)} \\right| + \\left| \\frac{1}{g'(p_2)} \\right|\n$$\n我们来分析 $g'(p) = \\log_2\\left(\\frac{1-p}{p}\\right)$ 的符号。\n对于 $p_1 \\in (0, 1/2)$，我们有 $\\frac{1-p_1}{p_1}  1$，所以 $g'(p_1)  0$。\n对于 $p_2 \\in (1/2, 1)$，我们有 $0  \\frac{1-p_2}{p_2}  1$，所以 $g'(p_2)  0$。\n因此，PDF 为：\n$$\nf_S(s) = \\frac{1}{g'(p_1)} - \\frac{1}{g'(p_2)}\n$$\n现在我们将 $g'(p_2)$ 与 $g'(p_1)$ 联系起来。由于 $p_2 = 1-p_1$：\n$$\ng'(p_2) = g'(1-p_1) = \\log_2\\left(\\frac{1-(1-p_1)}{1-p_1}\\right) = \\log_2\\left(\\frac{p_1}{1-p_1}\\right) = -\\log_2\\left(\\frac{1-p_1}{p_1}\\right) = -g'(p_1)\n$$\n将此代回 $f_S(s)$ 的表达式中：\n$$\nf_S(s) = \\frac{1}{g'(p_1)} - \\frac{1}{-g'(p_1)} = \\frac{1}{g'(p_1)} + \\frac{1}{g'(p_1)} = \\frac{2}{g'(p_1)}\n$$\n这个表达式给出了 PDF $f_S(s)$ 的值，用 $p_1$ 表示，其中 $p_1$ 是 $g(p)=s$ 的较小根。问题要求的是 PDF 的参数表示，$f_S(H(p)) = G(p)$，其中 $p \\in (0, 1/2)$。这正是我们所求得的，其中 $p$ 作为我们的参数 $p_1$。\n所以，对于任何 $p \\in (0, 1/2)$，我们设 $s = H(p)$ 并求出在该 $s$ 处的 PDF 值。\n$$\nG(p) = f_S(H(p)) = \\frac{2}{g'(p)}\n$$\n代入 $g'(p)$ 的表达式：\n$$\nG(p) = \\frac{2}{\\log_2\\left(\\frac{1-p}{p}\\right)}\n$$\n这就是所要求的函数 $G(p)$，其中 $p \\in (0, 1/2)$。", "answer": "$$\\boxed{\\frac{2}{\\log_{2}\\left(\\frac{1-p}{p}\\right)}}$$", "id": "1902960"}]}