{"hands_on_practices": [{"introduction": "在大数据时代，我们常常需要实时处理信息流，而无法存储整个数据集。这个练习将挑战你像数据科学家一样思考，推导出一个计算移动平均值 $\\mu_n$ 的递归公式。这种“在线算法”是高效处理数据流的基石，理解其推导过程能让你洞察算术平均数的基本结构 [@problem_id:1934443]。", "problem": "一个深空探测器的机载计算机负责分析高能粒子的通量。探测器的传感器生成一个测量数据流 $x_1, x_2, x_3, \\dots$，其中 $x_k$ 是在时间步 $k$ 进行的测量。由于严格的内存限制，该计算机无法存储所有历史测量数据。因此，它必须在单次遍历中计算移动算术平均值。\n\n设 $\\mu_n$ 为前 $n$ 个测量值的算术平均值，即 $\\mu_n = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。当一个新的测量值 $x_n$ 到达时（对于 $n > 1$），计算机将前一个平均值 $\\mu_{n-1}$ 更新为新的平均值 $\\mu_n$。这个更新规则可以表示为前一个平均值和新数据点的线性组合：\n$$ \\mu_n = A_n \\mu_{n-1} + B_n x_n $$\n其中系数 $A_n$ 和 $B_n$ 是测量次数 $n$ 的函数。\n\n确定系数 $B_n$ 作为 $n$ 的函数的表达式。", "solution": "我们从前 $n$ 个测量值的移动平均值的定义开始：\n$$\n\\mu_{n}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n将总和拆分为前 $n-1$ 项和第 $n$ 项：\n$$\n\\mu_{n}=\\frac{1}{n}\\left(\\sum_{i=1}^{n-1}x_{i}+x_{n}\\right).\n$$\n使用定义 $\\mu_{n-1}=\\frac{1}{n-1}\\sum_{i=1}^{n-1}x_{i}$，将部分和 $\\sum_{i=1}^{n-1}x_{i}$ 用 $\\mu_{n-1}$ 表示，这意味着\n$$\n\\sum_{i=1}^{n-1}x_{i}=(n-1)\\mu_{n-1}.\n$$\n将此代入 $\\mu_{n}$ 的表达式中：\n$$\n\\mu_{n}=\\frac{1}{n}\\left((n-1)\\mu_{n-1}+x_{n}\\right)=\\frac{n-1}{n}\\mu_{n-1}+\\frac{1}{n}x_{n}.\n$$\n与更新形式 $\\mu_{n}=A_{n}\\mu_{n-1}+B_{n}x_{n}$ 进行比较，我们确定\n$$\nB_{n}=\\frac{1}{n}.\n$$", "answer": "$$\\boxed{\\frac{1}{n}}$$", "id": "1934443"}, {"introduction": "期望值（均值）的一个关键性质是其线性性：$E[X+Y] = E[X] + E[Y]$。作为另一种集中趋势的度量，中位数是否也共享这一直观的性质呢？本题将通过一个具体的反例引导你证明，通常情况下 $\\text{median}(X+Y) \\ne \\text{median}(X) + \\text{median}(Y)$，从而揭示这两种重要统计度量之间的一个根本区别 [@problem_id:1934426]。", "problem": "在概率论中，虽然随机变量之和的期望总是等于它们期望之和，但对于中位数而言，这个性质并不成立。本题通过一个具体的例子来探讨这个性质。\n\n设 $X_1$ 和 $X_2$ 是两个独立同分布的离散随机变量。它们共同的概率质量函数由下式给出：\n$$ P(X_i = 1) = \\frac{2}{3} $$\n$$ P(X_i = 100) = \\frac{1}{3} $$\n对 $i=1, 2$ 成立。\n\n对于一个累积分布函数为 $F_W(w) = P(W \\le w)$ 的随机变量 $W$，其中位数定义为 $\\text{median}(W) = \\inf\\{w \\in \\mathbb{R} \\mid F_W(w) \\ge 0.5\\}$。\n\n计算差值 $\\Delta = \\text{median}(X_1+X_2) - (\\text{median}(X_1) + \\text{median}(X_2))$。", "solution": "根据定义，对于任意一个累积分布函数为 $F_{W}(w)=P(W\\le w)$ 的随机变量 $W$，其中位数是 $\\inf\\{w\\in\\mathbb{R}\\mid F_{W}(w)\\ge 0.5\\}$。\n\n首先计算 $\\text{median}(X_{i})$。$X_{i}$ 的分布为 $P(X_{i}=1)=\\frac{2}{3}$ 和 $P(X_{i}=100)=\\frac{1}{3}$。其累积分布函数满足当 $w1$ 时 $F_{X_{i}}(w)=0$，$F_{X_{i}}(1)=\\frac{2}{3}$，以及当 $w\\ge 100$ 时 $F_{X_{i}}(w)=1$。由于 $F_{X_{i}}(1)=\\frac{2}{3}\\ge 0.5$ 并且对于 $w1$ 有 $F_{X_{i}}(w)=0  0.5$，可得\n$$\n\\text{median}(X_{i})=1.\n$$\n因此 $\\text{median}(X_{1})+\\text{median}(X_{2})=1+1=2$。\n\n接下来计算 $S=X_{1}+X_{2}$ 的分布。根据独立性，\n$$\nP(S=2)=P(X_{1}=1,X_{2}=1)=\\left(\\frac{2}{3}\\right)^{2}=\\frac{4}{9},\n$$\n$$\nP(S=101)=P(X_{1}=1,X_{2}=100)+P(X_{1}=100,X_{2}=1)=2\\cdot \\frac{2}{3}\\cdot \\frac{1}{3}=\\frac{4}{9},\n$$\n$$\nP(S=200)=P(X_{1}=100,X_{2}=100)=\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{9}.\n$$\n因此 $S$ 的累积分布函数满足\n$$\nF_{S}(w)=\\begin{cases}\n0,  w2,\\\\\n\\frac{4}{9},  2\\le w101,\\\\\n\\frac{8}{9},  101\\le w200,\\\\\n1,  w\\ge 200.\n\\end{cases}\n$$\n$S$ 的中位数是使得 $F_{S}(w)\\ge 0.5$ 成立的 $w$ 的下确界。我们有 $F_{S}(2)=\\frac{4}{9}  0.5$ 且 $F_{S}(101)=\\frac{8}{9}\\ge 0.5$，所以\n$$\n\\text{median}(X_{1}+X_{2})=101.\n$$\n因此，差值为\n$$\n\\Delta=\\text{median}(X_{1}+X_{2})-\\bigl(\\text{median}(X_{1})+\\text{median}(X_{2})\\bigr)=101-2=99.\n$$", "answer": "$$\\boxed{99}$$", "id": "1934426"}, {"introduction": "中位数以其对异常值的稳健性而闻名，但是当一个数据集被新的、非极端的数值更新时，它会如何表现？本练习通过检验在何种精确条件下，增加一个新数据点 $x_{new}$ 不会改变中位数的值，来探讨中位数的稳定性。掌握这些条件能让你对中位数的定义及其在动态数据集中的行为有更深刻、更形式化的理解 [@problem_id:1934422]。", "problem": "一个数据集 $S$ 由 $n$ 个数值数据点组成。设按非递减顺序排序的数据点为 $x_1, x_2, \\dots, x_n$。此数据集的中位数，记为 $M$，定义如下：\n- 如果 $n$ 是奇数，则 $M = x_{(n+1)/2}$。\n- 如果 $n$ 是偶数，则 $M = \\frac{1}{2}(x_{n/2} + x_{n/2+1})$。\n\n一个新的数据点 $x_{new}$ 被添加到数据集 $S$ 中，形成一个大小为 $n+1$ 的新数据集 $S'$。设 $M'$ 是 $S'$ 的中位数。\n\n考虑关于条件 $M' = M$ 的以下陈述。这些陈述中哪些必然为真？选择所有适用的选项。\n\nA. 如果 $n$ 是奇数，添加一个新数据点 $x_{new}$ 使得 $x_{new} = M$，将总是导致 $M' = M$。\n\nB. 如果 $n$ 是偶数，添加一个新数据点 $x_{new}$ 使得 $x_{new} = M$，将总是导致 $M' = M$。\n\nC. 如果 $n$ 是偶数且 $x_{n/2} = x_{n/2+1}$，那么添加任何新数据点 $x_{new}$ 都将总是导致 $M' = M$。\n\nD. 如果 $n$ 是奇数且 $x_{(n+1)/2} = x_{(n+1)/2 + 1}$，那么添加任何新数据点 $x_{new}$ 使得 $x_{new} > M$，将总是导致 $M' = M$。\n\nE. 如果 $n$ 是奇数且 $x_{(n+1)/2 - 1} = x_{(n+1)/2}$，那么添加任何新数据点 $x_{new}$ 使得 $x_{new}  M$，将总是导致 $M' = M$。", "solution": "设排序后的数据集为 $x_1 \\le x_2 \\le \\dots \\le x_n$。记 $M$ 为 $S$ 的中位数，$M'$ 为在 $S$ 中插入一个新点 $x_{\\text{new}}$ 形成大小为 $n+1$ 的新数据集 $S'$ 后的中位数。\n\n**情况 1: $n$ 为奇数**\n设 $n=2k+1$。中位数的索引为 $k+1$，因此 $M = x_{k+1}$。添加一个数据点后，新数据集大小为 $n+1 = 2k+2$（偶数）。新中位数 $M'$ 是排序后第 $k+1$ 和第 $k+2$ 个元素的平均值，即 $M' = \\frac{1}{2}(x'_{k+1} + x'_{k+2})$。\n\n*   **A. 如果 $x_{\\text{new}} = M$:**\n    将 $x_{\\text{new}} = x_{k+1}$ 添加到数据集中。无论原始数据中 $M$ 出现多少次，添加一个新的 $M$ 后，排序后列表 $S'$ 的第 $k+1$ 和第 $k+2$ 个位置的值都将是 $M$。因此，$x'_{k+1} = M$ 且 $x'_{k+2} = M$。所以 $M' = \\frac{1}{2}(M + M) = M$。**陈述 A 为真。**\n\n*   **D. 如果 $x_{(n+1)/2} = x_{(n+1)/2 + 1}$ (即 $x_{k+1} = x_{k+2}$) 且 $x_{\\text{new}} > M$:**\n    给定 $M = x_{k+1}$ 且 $x_{k+1}=x_{k+2}$。由于 $x_{\\text{new}} > M = x_{k+2}$，它将被插入到 $x_{k+2}$ 的右侧。因此，新列表 $S'$ 的前 $k+2$ 个元素与原列表 $S$ 相同。即 $x'_{k+1} = x_{k+1} = M$ 且 $x'_{k+2} = x_{k+2} = M$。所以 $M' = \\frac{1}{2}(M + M) = M$。**陈述 D 为真。**\n\n*   **E. 如果 $x_{(n+1)/2 - 1} = x_{(n+1)/2}$ (即 $x_k = x_{k+1}$) 且 $x_{\\text{new}}  M$:**\n    给定 $M = x_{k+1}$ 且 $x_k=x_{k+1}$。由于 $x_{\\text{new}}  M = x_k$，它将被插入到 $x_k$ 的左侧。因此，原列表中的 $x_k$ 和 $x_{k+1}$ 在新列表 $S'$ 中将移动到第 $k+1$ 和第 $k+2$ 个位置。即 $x'_{k+1} = x_k = M$ 且 $x'_{k+2} = x_{k+1} = M$。所以 $M' = \\frac{1}{2}(M + M) = M$。**陈述 E 为真。**\n\n**情况 2: $n$ 为偶数**\n设 $n=2k$。中位数为 $M = \\frac{1}{2}(x_k + x_{k+1})$。添加一个数据点后，新数据集大小为 $n+1 = 2k+1$（奇数）。新中位数 $M'$ 是排序后第 $k+1$ 个元素，即 $M' = x'_{k+1}$。\n\n*   **B. 如果 $x_{\\textnew} = M$:**\n    我们将 $x_{\\text{new}} = \\frac{1}{2}(x_k + x_{k+1})$ 添加到数据集中。根据定义，$x_k \\le M \\le x_{k+1}$。因此，当 $x_{\\text{new}}$ 被插入时，它会位于 $x_k$ 和 $x_{k+1}$ 之间（或等于其中之一）。新列表 $S'$ 的第 $k+1$ 个元素将是 $x_{\\text{new}}$。所以 $M' = x'_{k+1} = x_{\\text{new}} = M$。**陈述 B 为真。**\n\n*   **C. 如果 $x_{n/2} = x_{n/2+1}$ (即 $x_k = x_{k+1}$) 且添加任意 $x_{\\text{new}}$:**\n    给定 $x_k = x_{k+1}$，这意味着 $M = \\frac{1}{2}(x_k+x_k) = x_k$。\n    - 如果 $x_{\\text{new}} \\le x_k$，它将被插入到 $x_k$ 的左侧（或其位置）。原列表中的 $x_k$ 将成为新列表中的第 $k+1$ 个元素。所以 $M' = x'_{k+1} = x_k = M$。\n    - 如果 $x_{\\text{new}} > x_k (=x_{k+1})$，它将被插入到 $x_{k+1}$ 的右侧。原列表中的 $x_k$ 仍然是新列表中的第 $k+1$ 个元素。所以 $M' = x'_{k+1} = x_k = M$。\n    在这两种情况下，$M' = M$。**陈述 C 为真。**\n\n由于所有五个陈述都为真，所以应选择所有选项。", "answer": "$$\\boxed{ABCDE}$$", "id": "1934422"}]}