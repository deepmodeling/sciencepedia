{"hands_on_practices": [{"introduction": "第一个练习将总方差定律应用于一个经典的两阶段随机游戏。通过将问题分解为每个结果*内部*的方差和不同结果*之间*的方差，我们可以看到该定律如何将总变异划分为易于理解的部分。这个练习对于掌握该公式的计算机制至关重要。[@problem_id:1401034]", "problem": "一位玩家参与一个两阶段的随机游戏。在第一阶段，他们掷一个均匀的六面骰子。设掷骰子的结果为随机变量 $K$。在第二阶段，玩家抽取一个有货币价值的奖品，其价值由随机变量 $X$ 表示。抽取奖品价值的分布取决于掷骰子的结果。具体来说，对于给定的骰子结果 $K=k$，奖品价值 $X$ 从一个均值为 $k$、方差为 $k^2$ 的分布中抽取。\n\n计算奖品价值的总方差 $\\operatorname{Var}(X)$。将您的答案表示为最简精确分数形式。", "solution": "设 $K$ 为掷一个均匀六面骰子的结果，因此 $K \\in \\{1,2,3,4,5,6\\}$，每个结果的概率相等。给定 $K=k$，$X$ 的条件均值和条件方差分别为 $\\mathbb{E}[X \\mid K=k]=k$ 和 $\\operatorname{Var}(X \\mid K=k)=k^2$。\n\n根据全方差公式，\n$$\n\\operatorname{Var}(X)=\\mathbb{E}\\!\\left[\\operatorname{Var}(X \\mid K)\\right]+\\operatorname{Var}\\!\\left(\\mathbb{E}[X \\mid K]\\right).\n$$\n使用给定的条件矩，上式变为\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[K^2]+\\operatorname{Var}(K).\n$$\n\n计算均匀骰子结果 $K$ 的矩：\n$$\n\\mathbb{E}[K]=\\frac{1}{6}\\sum_{k=1}^{6}k=\\frac{21}{6}=\\frac{7}{2},\n$$\n$$\n\\mathbb{E}[K^2]=\\frac{1}{6}\\sum_{k=1}^{6}k^2=\\frac{91}{6}.\n$$\n因此，\n$$\n\\operatorname{Var}(K)=\\mathbb{E}[K^2]-(\\mathbb{E}[K])^2=\\frac{91}{6}-\\left(\\frac{7}{2}\\right)^{2}=\\frac{91}{6}-\\frac{49}{4}=\\frac{35}{12}.\n$$\n所以，\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[K^2]+\\operatorname{Var}(K)=\\frac{91}{6}+\\frac{35}{12}=\\frac{182+35}{12}=\\frac{217}{12}.\n$$\n此分数为最简形式。", "answer": "$$\\boxed{\\frac{217}{12}}$$", "id": "1401034"}, {"introduction": "在这个问题中，我们探索方差分解的一个更具概念性的应用，其中不确定性来自于模型本身——在本例中是随机选择一个函数。这个练习展示了“条件期望的方差”为零的情形，从而将总方差简化为“条件方差的期望”。这凸显了识别哪种随机性来源对总方差有贡献的重要性。[@problem_id:1929471]", "problem": "考虑一个两阶段随机过程。\n在第一阶段，选择一个函数，我们称之为$F$。有 $1/2$ 的概率，该函数是 $F(x) = \\sin(x)$。以剩下的 $1/2$ 概率，该函数是 $F(x) = \\cos(x)$。\n在第二阶段，从区间 $[0, 2\\pi]$ 上的连续均匀分布中抽取一个随机变量角度 $\\Theta$。\n然后定义一个新的随机变量 $Y$，其值为将所选函数 $F$ 应用于随机角度 $\\Theta$ 的结果，即 $Y = F(\\Theta)$。\n\n计算随机变量 $Y$ 的总方差。", "solution": "令 $S$ 表示函数的随机选择，其中 $\\mathbb{P}(S=\\sin)=\\mathbb{P}(S=\\cos)=\\frac{1}{2}$。令 $\\Theta$ 与 $S$ 相互独立，且在 $[0,2\\pi]$ 上均匀分布。定义当 $S=\\sin$ 时 $Y=\\sin(\\Theta)$，当 $S=\\cos$ 时 $Y=\\cos(\\Theta)$。\n\n根据全方差公式，\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}\\!\\left[\\operatorname{Var}(Y\\mid S)\\right]+\\operatorname{Var}\\!\\left(\\mathbb{E}[Y\\mid S]\\right).\n$$\n\n首先计算条件期望。当 $S=\\sin$ 时，\n$$\n\\mathbb{E}[Y\\mid S=\\sin]=\\mathbb{E}[\\sin(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin(x)\\,dx=0,\n$$\n而当 $S=\\cos$ 时，\n$$\n\\mathbb{E}[Y\\mid S=\\cos]=\\mathbb{E}[\\cos(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\cos(x)\\,dx=0.\n$$\n因此 $\\mathbb{E}[Y\\mid S]=0$ 几乎必然成立，所以\n$$\n\\operatorname{Var}\\!\\left(\\mathbb{E}[Y\\mid S]\\right)=0.\n$$\n\n接下来计算条件方差。当 $S=\\sin$ 时，\n$$\n\\operatorname{Var}(Y\\mid S=\\sin)=\\mathbb{E}[\\sin^{2}(\\Theta)]-\\left(\\mathbb{E}[\\sin(\\Theta)]\\right)^{2}=\\mathbb{E}[\\sin^{2}(\\Theta)],\n$$\n并且\n$$\n\\mathbb{E}[\\sin^{2}(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin^{2}(x)\\,dx=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\frac{1-\\cos(2x)}{2}\\,dx=\\frac{1}{2\\pi}\\left[\\frac{x}{2}-\\frac{\\sin(2x)}{4}\\right]_{0}^{2\\pi}=\\frac{1}{2}.\n$$\n类似地，当 $S=\\cos$ 时，\n$$\n\\operatorname{Var}(Y\\mid S=\\cos)=\\mathbb{E}[\\cos^{2}(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\cos^{2}(x)\\,dx=\\frac{1}{2}.\n$$\n因此，\n$$\n\\mathbb{E}\\!\\left[\\operatorname{Var}(Y\\mid S)\\right]=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}.\n$$\n\n综合起来，我们得到\n$$\n\\operatorname{Var}(Y)=\\frac{1}{2}+0=\\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1929471"}, {"introduction": "接下来是一个更高级的应用，该问题模拟了一个运行随机步数的过程，这是模拟和随机建模中的常见场景。通过应用总方差定律，我们可以简洁地计算随机个随机变量之和的方差，这一结果也称为方差的 Wald 恒等式。这个练习展示了该定理在解决应用概率论中复杂问题时的强大威力。[@problem_id:1401012]", "problem": "一个计算服务器被编程来运行一个迭代模拟。该模拟以离散的时间步进行。在每一步 $i$ 中，模拟会生成一个实值数值更新 $X_i$。这些更新，$X_1, X_2, X_3, \\dots$，是独立同分布（i.i.d.）的随机变量，每个都有均值 $\\mathbb{E}[X_i] = \\mu$ 和方差 $\\operatorname{Var}(X_i) = \\sigma^2$。均值 $\\mu$ 非零，方差 $\\sigma^2$ 是有限的正数。\n\n该模拟包含一个概率性停止规则。在每一步之后，都会进行一次独立的检查来决定是否终止。在任何给定步骤后终止的概率是一个常数 $p$，其中 $p \\in (0, 1)$。该模拟保证至少运行一步。设 $T$ 是表示模拟运行总步数的随机变量。\n\n模拟的最终输出是所有生成的更新的累积和，记为 $S_T = \\sum_{i=1}^{T} X_i$。\n\n请确定此最终输出的方差 $\\operatorname{Var}(S_T)$ 的一个闭式表达式，用参数 $\\mu$、$\\sigma^2$ 和 $p$ 表示。", "solution": "设 $\\{X_i\\}_{i \\ge 1}$ 是独立同分布的，其期望为 $\\mathbb{E}[X_i] = \\mu$，方差为 $\\operatorname{Var}(X_i) = \\sigma^2$。设 $T$ 独立于 $X_i$，并且服从支撑集为 $\\{1,2,\\dots\\}$、参数为 $p \\in (0,1)$ 的几何分布，因此 $\\mathbb{P}(T=t) = p(1-p)^{t-1}$。\n\n我们要求解 $S_T = \\sum_{i=1}^{T} X_i$ 的方差 $\\operatorname{Var}(S_T)$。根据全方差公式，\n$$\n\\operatorname{Var}(S_T) = \\mathbb{E}\\!\\left[\\operatorname{Var}(S_T\\mid T)\\right] + \\operatorname{Var}\\!\\left(\\mathbb{E}[S_T\\mid T]\\right).\n$$\n给定 $T=t$，$S_T$ 是 $t$ 个独立同分布变量的和，所以\n$$\n\\mathbb{E}[S_T\\mid T=t] = t\\mu,\\qquad \\operatorname{Var}(S_T\\mid T=t) = t\\sigma^2.\n$$\n因此，\n$$\n\\operatorname{Var}(S_T) = \\sigma^2\\mathbb{E}[T] + \\mu^2\\operatorname{Var}(T).\n$$\n\n接下来需要计算在 $\\{1,2,\\dots\\}$ 上服从几何分布 $T \\sim \\text{Geom}(p)$ 的 $\\mathbb{E}[T]$ 和 $\\operatorname{Var}(T)$。设 $q = 1 - p$。那么\n$$\n\\mathbb{E}[T] = \\sum_{t=1}^{\\infty} t\\, p q^{t-1} = p \\sum_{t=1}^{\\infty} t q^{t-1}.\n$$\n利用几何级数 $\\sum_{t=0}^{\\infty} q^{t} = \\frac{1}{1-q}$（对于 $|q|<1$）并对 $q$ 求导，我们得到\n$$\n\\sum_{t=1}^{\\infty} t q^{t-1} = \\frac{1}{(1-q)^{2}},\n$$\n所以\n$$\n\\mathbb{E}[T] = p \\cdot \\frac{1}{(1-q)^{2}} = p \\cdot \\frac{1}{p^{2}} = \\frac{1}{p}.\n$$\n接下来，\n$$\n\\mathbb{E}[T^{2}] = \\sum_{t=1}^{\\infty} t^{2} p q^{t-1} = p \\sum_{t=1}^{\\infty} t^{2} q^{t-1}.\n$$\n从 $g(q) = \\sum_{t=1}^{\\infty} t q^{t} = \\frac{q}{(1-q)^{2}}$ 开始，对其求导得到\n$$\n\\sum_{t=1}^{\\infty} t^{2} q^{t-1} = g'(q) = \\frac{1+q}{(1-q)^{3}},\n$$\n因此\n$$\n\\mathbb{E}[T^2] = p \\cdot \\frac{1+q}{(1-q)^{3}} = p \\cdot \\frac{2 - p}{p^{3}} = \\frac{2 - p}{p^{2}}.\n$$\n因此，\n$$\n\\operatorname{Var}(T) = \\mathbb{E}[T^2] - (\\mathbb{E}[T])^{2} = \\frac{2 - p}{p^{2}} - \\frac{1}{p^{2}} = \\frac{1 - p}{p^{2}}.\n$$\n代入 $\\operatorname{Var}(S_T)$ 的表达式中，得到\n$$\n\\operatorname{Var}(S_T) = \\sigma^2\\left(\\frac{1}{p}\\right) + \\mu^2\\left(\\frac{1 - p}{p^2}\\right) = \\frac{\\sigma^2}{p} + \\frac{\\mu^2(1 - p)}{p^2}.\n$$\n这就是所求的闭式表达式。", "answer": "$$\\boxed{\\frac{\\sigma^2}{p}+\\frac{\\mu^2(1-p)}{p^2}}$$", "id": "1401012"}]}