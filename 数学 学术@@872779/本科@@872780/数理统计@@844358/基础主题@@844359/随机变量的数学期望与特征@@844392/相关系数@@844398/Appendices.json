{"hands_on_practices": [{"introduction": "一个常见的误解是，相关系数为 $0$ 意味着两个变量之间没有关系。本练习通过构建一个具有完美、确定的非线性关系但相关系数却为 $0$ 的场景，来挑战这一观念。掌握这一概念对于正确解释统计结果和避免得出关于独立性的错误结论至关重要。[@problem_id:3526]", "problem": "考虑一个由三个点 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 组成的数据集。$x$ 坐标由 $x_1 = -a$、$x_2 = 0$ 和 $x_3 = a$ 给出，其中 $a$ 是一个非零实数常量。$y$ 坐标由二次关系 $y_i = kx_i^2 + c$ 确定，其中 $k$ 和 $c$ 是非零实数常量。\n\n样本皮尔逊相关系数 $r$ 是衡量两组数据之间线性相关性的度量。其定义为：\n$$\nr = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^n (x_i - \\bar{x})^2} \\sqrt{\\sum_{i=1}^n (y_i - \\bar{y})^2}}\n$$\n其中 $\\bar{x}$ 是 $x_i$ 值的均值，$\\bar{y}$ 是 $y_i$ 值的均值。\n\n给定这个 $y$ 是 $x$ 的一个确定性的非线性函数的数据集，请推导样本皮尔逊相关系数 $r$ 的值。", "solution": "首先，计算均值 $\\bar{x}$ 和 $\\bar{y}$。我们有\n$$\\bar{x} = \\frac{-a + 0 + a}{3} = 0,$$\n$$\\bar{y} = \\frac{(k a^2 + c) + c + (k a^2 + c)}{3} = \\frac{2 k a^2 + 3 c}{3} = \\frac{2}{3} k a^2 + c.$$\n\n接下来，计算偏差 $x_i - \\bar{x}$ 和 $y_i - \\bar{y}$。由于 $\\bar{x}=0$，所以 $x_i - \\bar{x} = x_i$。我们得到\n$$y_1 - \\bar{y} = k a^2 + c - \\Bigl(\\frac{2}{3} k a^2 + c\\Bigr) = \\frac{1}{3} k a^2,$$\n$$y_2 - \\bar{y} = c - \\Bigl(\\frac{2}{3} k a^2 + c\\Bigr) = -\\frac{2}{3} k a^2,$$\n$$y_3 - \\bar{y} = k a^2 + c - \\Bigl(\\frac{2}{3} k a^2 + c\\Bigr) = \\frac{1}{3} k a^2.$$\n\n$r$ 的分子是\n$$\\sum_{i=1}^3 (x_i - \\bar{x})(y_i - \\bar{y})\n= (-a)\\frac{1}{3}k a^2 + 0\\cdot\\Bigl(-\\frac{2}{3}k a^2\\Bigr)\n+ a\\frac{1}{3}k a^2\n= -\\frac{1}{3}k a^3 + \\frac{1}{3}k a^3 = 0.$$\n\n分母不为零，因为\n$$\\sum_{i=1}^3 (x_i - \\bar{x})^2 = a^2 + 0 + a^2 = 2a^2,$$\n$$\\sum_{i=1}^3 (y_i - \\bar{y})^2\n= 2\\Bigl(\\frac{1}{3}k a^2\\Bigr)^2 + \\Bigl(-\\frac{2}{3}k a^2\\Bigr)^2\n= \\frac{6}{9}k^2 a^4 = \\frac{2}{3}k^2 a^4.$$\n因此，样本皮尔逊相关系数为\n$$r = 0.$$", "answer": "$$\\boxed{0}$$", "id": "3526"}, {"introduction": "皮尔逊相关系数是一个强大的工具，但它对异常值可能高度敏感。这个实践问题通过展示单个异常值如何能将一个完美的正相关彻底逆转，生动地说明了这种敏感性。此练习将帮助你培养对数据的批判性眼光，并理解为什么在进行统计计算之前，直观地检查散点图是不可或缺的一步。[@problem_id:1911174]", "problem": "一位统计学家正在分析两个相关的二元数据集。\n数据集 A 由以下四个 $(x, y)$ 对组成：$(1, 5), (2, 7), (3, 9), (4, 11)$。\n数据集 B 是在数据集 A 的基础上增加一个额外的数据点 $(10, 0)$ 而创建的。\n\n一个包含 $n$ 对 $(x_i, y_i)$ 的数据集的样本相关系数 $r$ 由以下公式给出：\n$$ r = \\frac{n \\sum_{i=1}^{n} x_i y_i - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{\\sqrt{[n \\sum_{i=1}^{n} x_i^2 - (\\sum_{i=1}^{n} x_i)^2][n \\sum_{i=1}^{n} y_i^2 - (\\sum_{i=1}^{n} y_i)^2]}} $$\n\n令 $r_A$ 为数据集 A 的样本相关系数，$r_B$ 为数据集 B 的样本相关系数。计算相关系数的变化量 $\\Delta r = r_B - r_A$。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "问题要求计算两个数据集之间样本相关系数的变化量 $\\Delta r = r_B - r_A$。我们将首先计算数据集 A 的相关系数 $r_A$，然后计算数据集 B 的相关系数 $r_B$。\n\n**步骤 1：计算数据集 A 的相关系数 $r_A$。**\n数据集 A 为 $\\{(1, 5), (2, 7), (3, 9), (4, 11)\\}$。数据点的数量为 $n_A = 4$。\n我们首先需要计算必要的总和：\n$$ \\sum x_i = 1 + 2 + 3 + 4 = 10 $$\n$$ \\sum y_i = 5 + 7 + 9 + 11 = 32 $$\n$$ \\sum x_i^2 = 1^2 + 2^2 + 3^2 + 4^2 = 1 + 4 + 9 + 16 = 30 $$\n$$ \\sum y_i^2 = 5^2 + 7^2 + 9^2 + 11^2 = 25 + 49 + 81 + 121 = 276 $$\n$$ \\sum x_i y_i = (1)(5) + (2)(7) + (3)(9) + (4)(11) = 5 + 14 + 27 + 44 = 90 $$\n\n现在，我们将这些总和代入样本相关系数 $r_A$ 的公式中：\n$$ r_A = \\frac{n_A \\sum x_i y_i - (\\sum x_i)(\\sum y_i)}{\\sqrt{[n_A \\sum x_i^2 - (\\sum x_i)^2][n_A \\sum y_i^2 - (\\sum y_i)^2]}} $$\n$$ r_A = \\frac{4(90) - (10)(32)}{\\sqrt{[4(30) - (10)^2][4(276) - (32)^2]}} $$\n$$ r_A = \\frac{360 - 320}{\\sqrt{[120 - 100][1104 - 1024]}} $$\n$$ r_A = \\frac{40}{\\sqrt{[20][80]}} $$\n$$ r_A = \\frac{40}{\\sqrt{1600}} = \\frac{40}{40} = 1 $$\n因此，数据集 A 的相关系数为 $r_A = 1$。这是预料之中的，因为数据集 A 中的点完全位于直线 $y=2x+3$ 上。\n\n**步骤 2：计算数据集 B 的相关系数 $r_B$。**\n数据集 B 为 $\\{(1, 5), (2, 7), (3, 9), (4, 11), (10, 0)\\}$。数据点的数量为 $n_B = 5$。\n我们可以通过将新数据点 $(10, 0)$ 的贡献加到数据集 A 的总和上来计算新的总和：\n$$ \\sum x_i = 10 + 10 = 20 $$\n$$ \\sum y_i = 32 + 0 = 32 $$\n$$ \\sum x_i^2 = 30 + 10^2 = 30 + 100 = 130 $$\n$$ \\sum y_i^2 = 276 + 0^2 = 276 $$\n$$ \\sum x_i y_i = 90 + (10)(0) = 90 $$\n\n现在，将这些新的总和代入 $r_B$ 的公式中：\n$$ r_B = \\frac{n_B \\sum x_i y_i - (\\sum x_i)(\\sum y_i)}{\\sqrt{[n_B \\sum x_i^2 - (\\sum x_i)^2][n_B \\sum y_i^2 - (\\sum y_i)^2]}} $$\n$$ r_B = \\frac{5(90) - (20)(32)}{\\sqrt{[5(130) - (20)^2][5(276) - (32)^2]}} $$\n$$ r_B = \\frac{450 - 640}{\\sqrt{[650 - 400][1380 - 1024]}} $$\n$$ r_B = \\frac{-190}{\\sqrt{[250][356]}} $$\n$$ r_B = \\frac{-190}{\\sqrt{89000}} \\approx \\frac{-190}{298.328677...} \\approx -0.636901... $$\n\n**步骤 3：计算变化量 $\\Delta r = r_B - r_A$。**\n使用我们找到的 $r_A$ 和 $r_B$ 的值：\n$$ \\Delta r = r_B - r_A \\approx -0.636901... - 1 $$\n$$ \\Delta r \\approx -1.636901... $$\n\n**步骤 4：对最终答案进行四舍五入。**\n问题要求将最终答案四舍五入到三位有效数字。\n$$ \\Delta r \\approx -1.64 $$", "answer": "$$\\boxed{-1.64}$$", "id": "1911174"}, {"introduction": "相关性不仅适用于静态数据集，它对于理解随时间演变的动态系统（如股票价格或粒子扩散）也至关重要。本问题通过研究简单随机游走这一随机过程中的基础模型，来探讨自相关的概念。通过计算一个粒子在两个不同时间的位移之间的相关性，你将深入理解一个系统对其过去状态的“记忆”是如何随时间衰减的。[@problem_id:1911213]", "problem": "考虑一个一维简单对称随机游走，记为 $S_k$，它描述了一个粒子在 $k$ 个离散时间步后的位置。该游走从原点开始，所以 $S_0 = 0$。在每个时间步 $i=1, 2, 3, \\dots$，粒子走一步，由随机变量 $X_i$ 表示。步长 $\\{X_i\\}$ 是独立同分布的（i.i.d.）。对于这个简单对称游走，向右走一步（$X_i = +1$）的概率是 $1/2$，向左走一步（$X_i = -1$）的概率也是 $1/2$。粒子在时刻 $k$ 的位置是到该时刻为止所有步长的和：$S_k = \\sum_{i=1}^k X_i$。\n\n设 $m$ 和 $n$ 是两个正整数，代表两个不同的时间点，且满足条件 $n  m$。\n\n求粒子在时刻 $m$ 的位置 $S_m$ 与其在稍后时刻 $n$ 的位置 $S_n$ 之间的相关系数。用 $m$ 和 $n$ 将你的答案表示为一个闭式解析表达式。", "solution": "给定一个一维简单对称随机游走 $S_{k}=\\sum_{i=1}^{k}X_{i}$，其中 $\\{X_{i}\\}$ 是独立同分布的，满足 $P(X_{i}=1)=\\frac{1}{2}$ 和 $P(X_{i}=-1)=\\frac{1}{2}$。首先计算单步的前两阶矩：\n$$\n\\mathbb{E}[X_{1}]=\\frac{1}{2}\\cdot 1+\\frac{1}{2}\\cdot(-1)=0,\\qquad\n\\mathbb{E}[X_{1}^{2}]=\\frac{1}{2}\\cdot 1^{2}+\\frac{1}{2}\\cdot(-1)^{2}=1,\n$$\n因此\n$$\n\\operatorname{Var}(X_{1})=\\mathbb{E}[X_{1}^{2}]-(\\mathbb{E}[X_{1}])^{2}=1.\n$$\n根据线性和独立性，\n$$\n\\mathbb{E}[S_{k}]=\\sum_{i=1}^{k}\\mathbb{E}[X_{i}]=0,\\qquad\n\\operatorname{Var}(S_{k})=\\sum_{i=1}^{k}\\operatorname{Var}(X_{i})=k\\operatorname{Var}(X_{1})=k.\n$$\n对于 $nm$，写出 $S_{n}=S_{m}+\\sum_{i=m+1}^{n}X_{i}$。利用增量的独立性，$S_{m}$ 与 $\\sum_{i=m+1}^{n}X_{i}$ 是独立的，因此\n$$\n\\operatorname{Cov}(S_{m},S_{n})=\\operatorname{Cov}\\!\\left(S_{m},\\,S_{m}+\\sum_{i=m+1}^{n}X_{i}\\right)\n=\\operatorname{Cov}(S_{m},S_{m})+\\sum_{i=m+1}^{n}\\operatorname{Cov}(S_{m},X_{i})\n=\\operatorname{Var}(S_{m})+0=m.\n$$\n相关系数为\n$$\n\\rho(S_{m},S_{n})=\\frac{\\operatorname{Cov}(S_{m},S_{n})}{\\sqrt{\\operatorname{Var}(S_{m})\\,\\operatorname{Var}(S_{n})}}\n=\\frac{m}{\\sqrt{m\\,n}}=\\sqrt{\\frac{m}{n}}.\n$$\n这就得到了所需的用 $m$ 和 $n$ 表示的闭式表达式。", "answer": "$$\\boxed{\\sqrt{\\frac{m}{n}}}$$", "id": "1911213"}]}