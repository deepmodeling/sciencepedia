{"hands_on_practices": [{"introduction": "从样本中估计总体特征是统计学的核心任务。样本协方差是衡量两个变量之间关系的重要工具。本练习 [@problem_id:1949420] 深入探讨了该估计量一个微妙但关键的方面：当我们使用样本数据时出现的偏差。通过解决这个问题，你将理解为什么看似直观的样本协方差版本是有偏的，并领会标准“无偏”公式背后的逻辑。", "problem": "在统计分析中，通常从数据样本中估计总体参数。考虑一组 $n$ 个二元数据点 $(X_1, Y_1), (X_2, Y_2), \\dots, (X_n, Y_n)$，它们构成来自一个总体的随机样本。这个样本被认为是独立同分布的（IID），意味着每一对 $(X_i, Y_i)$ 都来自相同的潜在二元概率分布，并且与其他所有对都是独立的。\n\n设总体参数如下：\n- $X$ 的总体均值：$E[X_i] = \\mu_X$\n- $Y$ 的总体均值：$E[Y_i] = \\mu_Y$\n- $X$ 的总体方差：$\\operatorname{Var}(X_i) = \\sigma_X^2$\n- $Y$ 的总体方差：$\\operatorname{Var}(Y_i) = \\sigma_Y^2$\n- $X$ 和 $Y$ 的总体协方差：$\\operatorname{Cov}(X_i, Y_i) = E[(X_i - \\mu_X)(Y_i - \\mu_Y)] = \\sigma_{xy}$\n\n一个用于总体协方差的“朴素”估计量，类似于正态性下的最大似然估计量，定义为：\n$$ \\hat{\\sigma}_{xy} = \\frac{1}{n} \\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y}) $$\n其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 和 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i$是样本均值。\n\n估计量的偏差是其期望值与被估计参数真值之间的差异。对于此估计量，其偏差由 $B(\\hat{\\sigma}_{xy}) = E[\\hat{\\sigma}_{xy}] - \\sigma_{xy}$ 给出。\n\n确定朴素样本协方差估计量 $\\hat{\\sigma}_{xy}$ 的偏差。请用总体协方差 $\\sigma_{xy}$ 和样本大小 $n$ 的封闭形式解析表达式来表示你的答案。", "solution": "我们从朴素样本协方差估计量的定义开始：\n$$\n\\hat{\\sigma}_{xy}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})(Y_{i}-\\bar{Y}),\n$$\n其中 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$ 且 $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$。\n\n首先，使用中心化交叉乘积的代数恒等式：\n$$\n\\sum_{i=1}^{n}(X_{i}-\\bar{X})(Y_{i}-\\bar{Y})\n=\\sum_{i=1}^{n}X_{i}Y_{i}-\\bar{Y}\\sum_{i=1}^{n}X_{i}-\\bar{X}\\sum_{i=1}^{n}Y_{i}+n\\bar{X}\\bar{Y}.\n$$\n由于 $\\sum_{i=1}^{n}X_{i}=n\\bar{X}$ 和 $\\sum_{i=1}^{n}Y_{i}=n\\bar{Y}$，上式可简化为\n$$\n\\sum_{i=1}^{n}(X_{i}-\\bar{X})(Y_{i}-\\bar{Y})=\\sum_{i=1}^{n}X_{i}Y_{i}-n\\bar{X}\\bar{Y}.\n$$\n因此，\n$$\nE[\\hat{\\sigma}_{xy}]=\\frac{1}{n}\\sum_{i=1}^{n}E[X_{i}Y_{i}]-E[\\bar{X}\\bar{Y}].\n$$\n\n计算每个期望值：\n1) 根据协方差的定义，$\\operatorname{Cov}(X_{i},Y_{i})=E[X_{i}Y_{i}]-\\mu_{X}\\mu_{Y}=\\sigma_{xy}$，因此\n$$\nE[X_{i}Y_{i}]=\\sigma_{xy}+\\mu_{X}\\mu_{Y}.\n$$\n于是，\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}E[X_{i}Y_{i}]=\\sigma_{xy}+\\mu_{X}\\mu_{Y}.\n$$\n\n2) 对于 $E[\\bar{X}\\bar{Y}]$，我们写出\n$$\n\\bar{X}\\bar{Y}=\\frac{1}{n^{2}}\\sum_{i=1}^{n}\\sum_{j=1}^{n}X_{i}Y_{j}.\n$$\n因为数据对 $(X_{i},Y_{i})$ 是独立同分布的，且在不同的 $i$ 之间是独立的，我们有当 $i\\neq j$ 时：$X_{i}$ 与 $Y_{j}$ 独立，所以 $E[X_{i}Y_{j}]=E[X_{i}]E[Y_{j}]=\\mu_{X}\\mu_{Y}$。当 $i=j$ 时，$E[X_{i}Y_{i}]=\\sigma_{xy}+\\mu_{X}\\mu_{Y}$。因此，\n$$\nE[\\bar{X}\\bar{Y}]=\\frac{1}{n^{2}}\\left[n(\\sigma_{xy}+\\mu_{X}\\mu_{Y})+n(n-1)\\mu_{X}\\mu_{Y}\\right]\n=\\frac{\\sigma_{xy}}{n}+\\mu_{X}\\mu_{Y}.\n$$\n\n代回原式，\n$$\nE[\\hat{\\sigma}_{xy}]=\\left(\\sigma_{xy}+\\mu_{X}\\mu_{Y}\\right)-\\left(\\frac{\\sigma_{xy}}{n}+\\mu_{X}\\mu_{Y}\\right)\n=\\left(1-\\frac{1}{n}\\right)\\sigma_{xy}=\\frac{n-1}{n}\\,\\sigma_{xy}.\n$$\n\n因此偏差为\n$$\nB(\\hat{\\sigma}_{xy})=E[\\hat{\\sigma}_{xy}]-\\sigma_{xy}=\\frac{n-1}{n}\\sigma_{xy}-\\sigma_{xy}=-\\frac{1}{n}\\sigma_{xy}.\n$$", "answer": "$$\\boxed{-\\frac{\\sigma_{xy}}{n}}$$", "id": "1949420"}, {"introduction": "数据是独立同分布（I.I.D.）的假设是许多统计模型的基石，但了解其不适用的情况至关重要。本练习 [@problem_id:1949462] 探讨了一个最常见的例外：从有限总体中进行无放回抽样。通过计算协方差，你将直接看到不放回抽样的行为如何在抽取之间产生依赖性，从而与 I.I.D. 的情况形成鲜明对比。", "problem": "一个制造商生产了一批数量为 $N$ 的先进微处理器。为了进行质量控制，对每个芯片测量一项关键性能指标。设第 $i$ 个芯片的该指标值为 $c_i$，其中 $i=1, \\ldots, N$。所有 $N$ 个指标值的集合 $\\{c_1, \\ldots, c_N\\}$ 构成一个有限总体。该指标的总体均值为 $\\mu$，总体方差为 $\\sigma^2$，定义为 $\\sigma^2 = \\frac{1}{N} \\sum_{i=1}^{N} (c_i - \\mu)^2$。\n\n一名检验员进行一次大小为二的简单随机抽样，从这批芯片中不放回地抽取两个不同的芯片。设随机变量 $X_1$ 表示第一个选出芯片的指标值，随机变量 $X_2$ 表示第二个选出芯片的指标值。\n\n求这两个测量值之间的协方差 $\\operatorname{Cov}(X_1, X_2)$。将答案表示为关于总体大小 $N$ 和总体方差 $\\sigma^2$ 的闭式解析表达式。", "solution": "设有限总体为值 $\\{c_{1},\\ldots,c_{N}\\}$，其总体均值为 $\\mu$，方差为 $\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N}(c_{i}-\\mu)^{2}$。检验员不放回地抽取两个不同的芯片，$X_{1}$ 和 $X_{2}$ 分别表示在第一次和第二次抽取中观测到的指标值。\n\n首先，计算期望：\n$$\n\\mathbb{E}[X_{1}]=\\sum_{i=1}^{N}c_{i}\\cdot\\frac{1}{N}=\\frac{1}{N}\\sum_{i=1}^{N}c_{i}=\\mu,\n\\qquad\n\\mathbb{E}[X_{2}]=\\mu,\n$$\n根据对称性和均匀抽样。\n\n接下来，计算 $\\mathbb{E}[X_{1}X_{2}]$。因为抽样是不放回的，对于 $i\\neq j$，\n$$\n\\mathbb{P}(X_{1}=c_{i},X_{2}=c_{j})=\\frac{1}{N}\\cdot\\frac{1}{N-1}.\n$$\n因此，\n$$\n\\mathbb{E}[X_{1}X_{2}]\n=\\sum_{i=1}^{N}\\sum_{\\substack{j=1\\\\ j\\neq i}}^{N} c_{i}c_{j}\\cdot\\frac{1}{N}\\cdot\\frac{1}{N-1}\n=\\frac{1}{N(N-1)}\\sum_{i\\neq j}c_{i}c_{j}.\n$$\n使用恒等式\n$$\n\\sum_{i\\neq j}c_{i}c_{j}=\\left(\\sum_{i=1}^{N}c_{i}\\right)^{2}-\\sum_{i=1}^{N}c_{i}^{2}=(N\\mu)^{2}-\\sum_{i=1}^{N}c_{i}^{2}.\n$$\n根据 $\\sigma^{2}$ 的定义，\n$$\n\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N}(c_{i}-\\mu)^{2}\n=\\frac{1}{N}\\left(\\sum_{i=1}^{N}c_{i}^{2}-2\\mu\\sum_{i=1}^{N}c_{i}+N\\mu^{2}\\right)\n=\\frac{1}{N}\\left(\\sum_{i=1}^{N}c_{i}^{2}-N\\mu^{2}\\right),\n$$\n所以\n$$\n\\sum_{i=1}^{N}c_{i}^{2}=N(\\sigma^{2}+\\mu^{2}).\n$$\n因此，\n$$\n\\sum_{i\\neq j}c_{i}c_{j}=N^{2}\\mu^{2}-N(\\sigma^{2}+\\mu^{2})=N(N-1)\\mu^{2}-N\\sigma^{2}.\n$$\n将其代入 $\\mathbb{E}[X_{1}X_{2}]$ 可得\n$$\n\\mathbb{E}[X_{1}X_{2}]\n=\\frac{1}{N(N-1)}\\left(N(N-1)\\mu^{2}-N\\sigma^{2}\\right)\n=\\mu^{2}-\\frac{\\sigma^{2}}{N-1}.\n$$\n最后，协方差为\n$$\n\\operatorname{Cov}(X_{1},X_{2})=\\mathbb{E}[X_{1}X_{2}]-\\mathbb{E}[X_{1}]\\mathbb{E}[X_{2}]\n=\\left(\\mu^{2}-\\frac{\\sigma^{2}}{N-1}\\right)-\\mu^{2}\n=-\\frac{\\sigma^{2}}{N-1}.\n$$", "answer": "$$\\boxed{-\\frac{\\sigma^{2}}{N-1}}$$", "id": "1949462"}, {"introduction": "除了定义估计量，我们还需要评估它们的质量，而方差是衡量估计量稳定性的关键指标。这个问题 [@problem_id:1949474] 以一个实际的数字信号处理场景为背景，要求你计算一个用于测量信号功率的统计量的方差。本练习展示了如何将 I.I.D. 样本的一般性质与基础概率分布（在此例中为正态分布）的特定矩性质相结合，以全面描述一个统计量的行为。", "problem": "在数字信号处理 (DSP) 领域，一个常见的任务是描述含噪信号的特性。考虑一个由 $n$ 个电压测量值组成的序列，$V_1, V_2, \\ldots, V_n$。该序列被建模为一个随机样本，其中每次测量 $V_i$ 都来自一个正态分布，其平均直流偏置 $\\mu$ 和噪声方差 $\\sigma^2$ 均为常数但未知。这些测量是独立同分布的（I.I.D.）。\n\n一位工程师提出了一个简单的统计量 $T$，用以量化采样周期内接收信号的平均功率。该统计量定义为电压值平方的均值：\n$$T = \\frac{1}{n} \\sum_{i=1}^{n} V_i^2$$\n为了评估该统计量的可靠性，理解其变异性至关重要。确定统计量 $T$ 的方差。您的答案应该是一个关于样本大小 $n$、平均直流偏置 $\\mu$ 和噪声方差 $\\sigma^2$ 的单一闭式解析表达式。", "solution": "我们定义 $Y_{i} = V_{i}^{2}$，因此 $T = \\frac{1}{n} \\sum_{i=1}^{n} Y_{i}$。因为 $V_{i}$ 是独立同分布的，所以 $Y_{i}$ 也是独立同分布的。因此，根据独立随机变量和的方差性质，\n$$\n\\operatorname{Var}(T) = \\operatorname{Var}\\!\\left(\\frac{1}{n} \\sum_{i=1}^{n} Y_{i}\\right) = \\frac{1}{n^{2}} \\sum_{i=1}^{n} \\operatorname{Var}(Y_{i}) = \\frac{1}{n} \\operatorname{Var}(Y_{1}) = \\frac{1}{n} \\operatorname{Var}(V^{2}),\n$$\n其中 $V \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。\n\n我们通过矩来计算 $\\operatorname{Var}(V^{2})$。首先，\n$$\n\\mathbb{E}[V^{2}] = \\operatorname{Var}(V) + (\\mathbb{E}[V])^{2} = \\sigma^{2} + \\mu^{2}.\n$$\n为了求 $\\mathbb{E}[V^{4}]$，我们令 $V = \\mu + Z$，其中 $Z \\sim \\mathcal{N}(0,\\sigma^{2})$。则\n$$\nV^{4} = (\\mu + Z)^{4} = \\mu^{4} + 4 \\mu^{3} Z + 6 \\mu^{2} Z^{2} + 4 \\mu Z^{3} + Z^{4}.\n$$\n取期望，并利用 $\\mathbb{E}[Z] = 0$、$\\mathbb{E}[Z^{3}] = 0$、$\\mathbb{E}[Z^{2}] = \\sigma^{2}$，以及对于零均值正态分布有 $\\mathbb{E}[Z^{4}] = 3 \\sigma^{4}$，我们得到\n$$\n\\mathbb{E}[V^{4}] = \\mu^{4} + 6 \\mu^{2} \\sigma^{2} + 3 \\sigma^{4}.\n$$\n因此，\n$$\n\\operatorname{Var}(V^{2}) = \\mathbb{E}[V^{4}] - \\big(\\mathbb{E}[V^{2}]\\big)^{2} = \\left(\\mu^{4} + 6 \\mu^{2} \\sigma^{2} + 3 \\sigma^{4}\\right) - \\left(\\mu^{2} + \\sigma^{2}\\right)^{2} = 4 \\mu^{2} \\sigma^{2} + 2 \\sigma^{4}.\n$$\n最后，\n$$\n\\operatorname{Var}(T) = \\frac{1}{n} \\operatorname{Var}(V^{2}) = \\frac{1}{n} \\left(4 \\mu^{2} \\sigma^{2} + 2 \\sigma^{4}\\right) = \\frac{2 \\sigma^{2} \\left(2 \\mu^{2} + \\sigma^{2}\\right)}{n}.\n$$", "answer": "$$\\boxed{\\frac{2 \\sigma^{2} \\left(2 \\mu^{2} + \\sigma^{2}\\right)}{n}}$$", "id": "1949474"}]}