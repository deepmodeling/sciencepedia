{"hands_on_practices": [{"introduction": "我们从一个基础练习开始。负二项分布的核心是计算为达到预定成功次数所需的试验次数的概率。下面的问题 [@problem_id:12863] 将引导您直接使用负二项概率质量函数来计算特定结果的概率，这是理解该分布如何为一系列独立试验中的“等待时间”建模的关键。", "problem": "考虑一系列独立的伯努利试验，每次试验可能出现两种结果之一：“成功”或“失败”。在任何一次给定的试验中，成功的概率是恒定的，记为 $p$，而失败的概率是 $1-p$。\n\n令随机变量 $X$ 为第 $r$ 次成功发生时的试验次数。在本问题中，我们感兴趣的是一个具体情况，即我们想要找到第3次成功发生在第10次试验时的概率。\n\n推导当 $r=3$ 次成功时，概率 $P(X=10)$ 的表达式。您的最终答案应该是一个以成功概率 $p$ 表示的封闭形式表达式。", "solution": "我们用负二项分布来模拟在成功概率为 $p$ 的独立伯努利试验中，获得 $r$ 次成功所需的试验次数 $X$。第 $r$ 次成功发生在第 $n$ 次试验的概率是\n$$\nP(X=n)\\;=\\;\\binom{n-1}{r-1}\\,p^r\\,(1-p)^{\\,n-r}\\,.\n$$\n对于 $r=3$ 和 $n=10$，这给出\n$$\nP(X=10)\n=\\binom{10-1}{3-1}\\,p^3\\,(1-p)^{10-3}\n=\\binom{9}{2}\\,p^3\\,(1-p)^7.\n$$\n由于\n$$\n\\binom{9}{2}=\\frac{9\\cdot8}{2}=36,\n$$\n我们得到\n$$\nP(X=10)=36\\,p^3\\,(1-p)^7.\n$$", "answer": "$$\\boxed{36\\,p^3\\,(1-p)^7}$$", "id": "12863"}, {"introduction": "现在，让我们架起理论与实践之间的桥梁。在现实世界的应用中，我们往往从数据出发，而不是已知的参数。这个练习 [@problem_id:1939495] 演示了如何利用观测到的统计数据（如均值和方差）来反向估计负二项分布的底层参数 $r$ 和 $p$，这种技术被称为矩估计法。它还引入了负二项随机变量的一种常见备选定义，即在达到 $r$ 次成功之前所经历的失败次数。", "problem": "一个数据科学家团队正在为一个新的社交媒体平台的用户参与度建模。他们感兴趣的是，一个用户在获得一定数量的“成功”帖子之前所发布的帖子数量，其中“成功”帖子被定义为获得高度社区互动的帖子。\n\n该团队使用负二项分布来对此过程进行建模。设随机变量 $X$ 表示用户在达到 $r$ 个成功帖子的目标之前，所发布的“不成功”帖子的数量。任何给定帖子成功的概率为 $p$，且每次发帖都是一次独立的试验。\n\n从大量的用户历史数据集中，该团队计算出了不成功帖子数量的样本均值和方差。估计的均值为 $E[X] = 10$，估计的方差为 $Var(X) = 20$。\n\n基于这些经验估计，确定模拟此过程的负二项分布的参数：成功帖子的目标数量 $r$，以及单次帖子成功的概率 $p$。你的答案应为一个有序对 $(r, p)$。", "solution": "设 $X$ 表示在成功概率为 $p$ 的独立伯努利试验中，取得 $r$ 次成功之前的失败次数。在这种负二项分布的参数化中，$X$ 可以写成 $r$ 个独立的几何随机变量（每个变量都计算一次成功之前的失败次数）之和，每个变量的均值为 $(1-p)/p$，方差为 $(1-p)/p^{2}$。因此，\n$$\nE[X]=r\\frac{1-p}{p},\\qquad \\operatorname{Var}(X)=r\\frac{1-p}{p^{2}}.\n$$\n设 $\\mu=E[X]$ 且 $\\sigma^{2}=\\operatorname{Var}(X)$。那么\n$$\n\\frac{\\sigma^{2}}{\\mu}=\\frac{r(1-p)/p^{2}}{r(1-p)/p}=\\frac{1}{p}\\quad\\Longrightarrow\\quad p=\\frac{\\mu}{\\sigma^{2}}.\n$$\n接下来，从均值中解出 $r$：\n$$\n\\mu=r\\frac{1-p}{p}\\quad\\Longrightarrow\\quad r=\\frac{\\mu p}{1-p}.\n$$\n代入 $p=\\mu/\\sigma^{2}$：\n$$\nr=\\frac{\\mu\\left(\\frac{\\mu}{\\sigma^{2}}\\right)}{1-\\frac{\\mu}{\\sigma^{2}}}\n=\\frac{\\mu^{2}}{\\sigma^{2}-\\mu}.\n$$\n使用经验估计值 $\\mu=10$ 和 $\\sigma^{2}=20$，我们得到\n$$\np=\\frac{10}{20}=\\frac{1}{2},\\qquad r=\\frac{10^{2}}{20-10}=\\frac{100}{10}=10.\n$$\n因此，参数为 $(r,p)=(10,\\frac{1}{2})$。", "answer": "$$\\boxed{\\begin{pmatrix}10  \\frac{1}{2}\\end{pmatrix}}$$", "id": "1939495"}, {"introduction": "为了真正掌握负二项分布，我们必须理解它在变化条件下的行为。最后一个练习 [@problem_id:1939527] 探讨了负二项过程中的条件概率概念。您将看到初始结果如何影响未来事件的概率，从而更深入地洞察等待时间过程的“记忆”特性。", "problem": "一名制药实验室的研究员正在筛选一个大型化合物库，以寻找一种能抑制特定酶的化合物。对每种化合物的筛选过程被视为一次独立试验。任何给定化合物是抑制剂（一次“成功”）的概率为 $p$，其中 $0  p  1$。研究员计划继续测试化合物，直到恰好找到 $r=4$ 种抑制剂。\n\n假设已知测试的前 $k=6$ 种化合物*不是*抑制剂（即它们是失败的）。在给定此信息的情况下，总共需要进行恰好 $n=15$ 次试验才能找到这4种抑制剂的概率是多少？\n\n将您的答案表示为 $p$ 的函数。", "solution": "设试验是独立的，成功概率为 $p$，并令 $N$ 表示获得 $r=4$ 次成功所需的总试验次数。我们已知前 $k=6$ 次试验是失败的。我们要求解\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6}).\n$$\n根据条件概率的定义，\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6})=\\frac{\\Pr(N=15, F_{1},\\ldots,F_{6})}{\\Pr(F_{1},\\ldots,F_{6})}.\n$$\n试验的独立性给出\n$$\n\\Pr(F_{1},\\ldots,F_{6})=(1-p)^{6}.\n$$\n对于分子中的联合事件，事件 $N=15$ 意味着在前 $14$ 次试验中恰好有 $3$ 次成功，并且第 $15$ 次试验是成功的。在已知前 $6$ 次试验失败的条件下，这等价于在第 $7$ 次到第 $14$ 次试验中恰好有 $3$ 次成功，并且第 $15$ 次试验是成功的。根据独立性，\n$$\n\\Pr(N=15, F_{1},\\ldots,F_{6})=(1-p)^{6}\\left[\\binom{8}{3}p^{3}(1-p)^{5}\\right]p=\\binom{8}{3}p^{4}(1-p)^{11}.\n$$\n因此，\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6})=\\frac{\\binom{8}{3}p^{4}(1-p)^{11}}{(1-p)^{6}}=\\binom{8}{3}p^{4}(1-p)^{5}.\n$$\n等价地，以前 $6$ 次失败为条件，意味着获得 $4$ 次成功所需的额外试验次数服从参数为 $r=4$ 和 $p$ 的负二项分布，因此对于 $15-6=9$ 次额外试验，\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6})=\\binom{9-1}{4-1}p^{4}(1-p)^{9-4}=\\binom{8}{3}p^{4}(1-p)^{5}.\n$$", "answer": "$$\\boxed{\\binom{8}{3}p^{4}(1-p)^{5}}$$", "id": "1939527"}]}