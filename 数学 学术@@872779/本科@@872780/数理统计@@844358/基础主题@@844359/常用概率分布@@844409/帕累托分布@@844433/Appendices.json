{"hands_on_practices": [{"introduction": "要真正理解一个概率分布，学会如何生成遵循该分布的数据是很有帮助的，这对于经济学或物理学等领域的仿真是至关重要的。我们将从使用反变换采样法开始，这是一种将简单的均匀分布随机数转换为遵循更复杂的帕累托分布变量的基本技术。这个练习 [@problem_id:1943026] 填补了理论累积分布函数（CDF）与实际数据生成之间的鸿沟。", "problem": "一位经济学家正在开发一个模拟程序，用于模拟一个小型、孤立经济体中的财富分配。根据经验数据，个人财富的分布 $X$（以千货币单位计）可以很好地用帕累托分布来近似。该分布的概率密度函数 (PDF) 如下所示：\n$$f(x; x_m, \\alpha) = \\frac{\\alpha x_m^{\\alpha}}{x^{\\alpha+1}} \\quad \\text{for } x \\ge x_m$$\n并且当 $x  x_m$ 时，$f(x) = 0$。\n\n该经济模型的参数估计为最小财富 $x_m = 10$（以千货币单位计）和形状参数 $\\alpha = 1.5$。\n\n为了运行该模拟，经济学家需要为一个新代理生成一个初始财富值。生成过程依赖于从一个标准均匀分布中抽取一个值并对其进行变换。一个伪随机数生成器从区间 $(0, 1)$ 上的均匀分布中产生一个值 $u = 0.72$。\n\n使用这个值 $u$ 作为逆变换采样过程的输入，为新代理生成的相应财富 $X$ 是多少？答案以千货币单位表示，并四舍五入到三位有效数字。", "solution": "我们从给定的帕累托概率密度函数开始，对于 $x \\ge x_{m}$：\n$$\nf(x;x_{m},\\alpha)=\\frac{\\alpha x_{m}^{\\alpha}}{x^{\\alpha+1}}.\n$$\n对于 $x \\ge x_{m}$，累积分布函数 $F(x)$ 通过将概率密度函数从 $x_{m}$ 积分到 $x$ 得到：\n$$\nF(x)=\\int_{x_{m}}^{x}\\frac{\\alpha x_{m}^{\\alpha}}{t^{\\alpha+1}}\\,dt=\\alpha x_{m}^{\\alpha}\\int_{x_{m}}^{x}t^{-(\\alpha+1)}\\,dt.\n$$\n使用 $\\int t^{-(\\alpha+1)}\\,dt=-\\frac{1}{\\alpha}t^{-\\alpha}$，我们得到\n$$\nF(x)=\\alpha x_{m}^{\\alpha}\\left[-\\frac{1}{\\alpha}t^{-\\alpha}\\right]_{t=x_{m}}^{t=x}=-x_{m}^{\\alpha}x^{-\\alpha}+x_{m}^{\\alpha}x_{m}^{-\\alpha}=1-\\left(\\frac{x_{m}}{x}\\right)^{\\alpha}.\n$$\n因此，对于 $x \\ge x_{m}$，\n$$\nF(x)=1-\\left(\\frac{x_{m}}{x}\\right)^{\\alpha}.\n$$\n逆变换采样设置 $U\\sim\\mathrm{Unif}(0,1)$，并求解 $U=F(X)$ 以得到 $X$。设 $U=u$ 为一个实现值。则\n$$\nu=1-\\left(\\frac{x_{m}}{X}\\right)^{\\alpha}\\quad\\Longrightarrow\\quad 1-u=\\left(\\frac{x_{m}}{X}\\right)^{\\alpha}.\n$$\n将两边取 $1/\\alpha$ 次幂，并求解 $X$ 可得\n$$\n\\frac{x_{m}}{X}=(1-u)^{1/\\alpha}\\quad\\Longrightarrow\\quad X=x_{m}(1-u)^{-1/\\alpha}.\n$$\n代入给定参数 $x_{m}=10$ 和 $\\alpha=1.5=\\frac{3}{2}$，因此 $-\\frac{1}{\\alpha}=-\\frac{2}{3}$，以及给定的 $u=0.72$：\n$$\nX=10\\,(1-0.72)^{-1/1.5}=10\\,(0.28)^{-2/3}.\n$$\n计算数值并四舍五入到三位有效数字：\n$$\n(0.28)^{-2/3}\\approx 2.3369,\\quad X\\approx 10\\times 2.3369=23.369\\ \\text{(千)}\\ \\approx 23.4\\ \\text{(千)}.\n$$\n因此，生成的财富以千货币单位计，精确到三位有效数字为 $23.4$。", "answer": "$$\\boxed{23.4}$$", "id": "1943026"}, {"introduction": "当我们收集到我们认为遵循帕累托分布的数据后，下一步就是估计其参数。最大似然估计（Maximum Likelihood Estimation, MLE）是完成此任务的一种强大且广泛使用的方法。这项练习 [@problem_id:1943033] 将指导你推导形状参数 $\\alpha$ 的最大似然估计量，这是将模型拟合到如网络流量或文件大小等真实世界数据的关键技能。", "problem": "在一个分布式云存储系统中，大文件的体积通常可以用幂律分布来建模。观测发现，对于大于某个最小体积的文件，其体积分布 $x$ 可以很好地用帕累托I型分布来近似。该分布的概率密度函数 (PDF) 由下式给出：\n$$ f(x; \\alpha, x_m) = \\frac{\\alpha x_m^{\\alpha}}{x^{\\alpha+1}} \\quad \\text{for } x \\ge x_m $$\n其中 $x_m$ 是已知的最小文件体积（尺度参数），而 $\\alpha$ 是一个未知的形状参数，它表征了分布的“尾部”特性。\n\n一位工程师收集了 $n$ 个文件体积的随机样本，记为 $x_1, x_2, \\dots, x_n$，所有这些样本都大于或等于已知的最小体积 $x_m$。你的任务是基于这些观测数据，确定形状参数 $\\alpha$ 的最大似然估计 (MLE)。\n\n推导 $\\alpha$ 的最大似然估计（我们记为 $\\hat{\\alpha}$）的闭式解析表达式，该表达式应以 $n$、$x_m$ 和观测数据 $x_i$ 表示。", "solution": "对于来自帕累托I型分布的独立观测值 $x_{1},\\dots,x_{n}$（其中 $x_{m}$ 已知，参数 $\\alpha0$），其联合似然函数为\n$$\nL(\\alpha)=\\prod_{i=1}^{n} f(x_{i};\\alpha,x_{m})\n=\\prod_{i=1}^{n}\\left(\\frac{\\alpha x_{m}^{\\alpha}}{x_{i}^{\\alpha+1}}\\right)\n=\\alpha^{n}\\,x_{m}^{n\\alpha}\\,\\prod_{i=1}^{n}x_{i}^{-(\\alpha+1)}.\n$$\n对数似然函数为\n$$\n\\ell(\\alpha)=\\ln L(\\alpha)=n\\ln\\alpha+n\\alpha\\ln x_{m}-(\\alpha+1)\\sum_{i=1}^{n}\\ln x_{i}.\n$$\n对 $\\alpha$ 求导并令其为零以求最大值：\n$$\n\\frac{\\partial \\ell}{\\partial \\alpha}=\\frac{n}{\\alpha}+n\\ln x_{m}-\\sum_{i=1}^{n}\\ln x_{i}=0.\n$$\n解出 $\\alpha$ 可得\n$$\n\\hat{\\alpha}=\\frac{n}{\\sum_{i=1}^{n}\\ln x_{i}-n\\ln x_{m}}=\\frac{n}{\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{x_{i}}{x_{m}}\\right)}.\n$$\n为验证其为最大值，计算二阶导数：\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\alpha^{2}}=-\\frac{n}{\\alpha^{2}}  0 \\quad \\text{for } \\alpha0,\n$$\n因此该临界点确实是一个最大值。所以，最大似然估计量为\n$$\n\\hat{\\alpha}=\\frac{n}{\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{x_{i}}{x_{m}}\\right)}.\n$$\n这要求至少有一个 $x_{i}x_{m}$，以确保分母为正且有限。", "answer": "$$\\boxed{\\frac{n}{\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{x_{i}}{x_{m}}\\right)}}$$", "id": "1943033"}, {"introduction": "最大似然估计并非估计参数的唯一方法。矩估计法（Method of Moments, MoM）提供了另一种通常更简单的方法。通过将分布的理论矩（如均值）与其样本对应值等同起来，我们可以推导出另一个有效的估计量。这个练习 [@problem_id:1943011] 演示了如何为帕累托分布的形状参数 $\\alpha$ 应用矩估计法，让你能够比较和对比不同的估计思想。", "problem": "在计量经济学中，一个总体中最高收入人群的年收入分布通常使用帕累托I型分布进行建模。该模型由一个最低收入阈值 $x_m$ 和一个形状参数 $\\alpha$ 定义。\n\n假设收入超过某一特定阈值的个体的年收入 $X$ 由一个随机变量描述，该随机变量服从一个帕累托分布，其已知的最低收入为 $x_m  0$。该分布的概率密度函数 (PDF) 由下式给出：\n$$\nf(x; \\alpha, x_m) =\n\\begin{cases}\n\\frac{\\alpha x_m^\\alpha}{x^{\\alpha+1}}  \\text{for } x \\ge x_m \\\\\n0  \\text{for } x  x_m\n\\end{cases}\n$$\n形状参数 $\\alpha$ 是一个正的未知常数，且已知 $\\alpha  1$。\n\n给定一个来自该总体的包含 $n$ 个收入的随机样本，记为 $X_1, X_2, \\ldots, X_n$。令样本均值表示为 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n使用矩估计法，为形状参数 $\\alpha$ 推导一个估计量，我们将其记为 $\\hat{\\alpha}$。将您的最终答案表示为用样本均值 $\\bar{X}$ 和最低收入 $x_m$ 表示的闭式解析表达式。", "solution": "我们使用矩估计法，令一阶样本矩等于一阶理论矩。对于参数为 $\\alpha1$ 和已知 $x_{m}0$ 的帕累托I型分布，其均值存在且为\n$$\n\\mathbb{E}[X] \\;=\\; \\int_{x_{m}}^{\\infty} x \\,\\frac{\\alpha x_{m}^{\\alpha}}{x^{\\alpha+1}} \\, dx\n\\;=\\; \\alpha x_{m}^{\\alpha} \\int_{x_{m}}^{\\infty} x^{-\\alpha} \\, dx.\n$$\n对于 $\\alpha1$，\n$$\n\\int_{x_{m}}^{\\infty} x^{-\\alpha} \\, dx \\;=\\; \\left[ \\frac{x^{1-\\alpha}}{1-\\alpha} \\right]_{x_{m}}^{\\infty}\n\\;=\\; 0 \\;-\\; \\frac{x_{m}^{1-\\alpha}}{1-\\alpha}\n\\;=\\; \\frac{x_{m}^{1-\\alpha}}{\\alpha-1}.\n$$\n因此，\n$$\n\\mathbb{E}[X] \\;=\\; \\alpha x_{m}^{\\alpha}\\,\\frac{x_{m}^{1-\\alpha}}{\\alpha-1}\n\\;=\\; \\frac{\\alpha x_{m}}{\\alpha-1}.\n$$\n矩估计法设定 $\\bar{X}=\\mathbb{E}[X]$，因此\n$$\n\\bar{X} \\;=\\; \\frac{\\alpha x_{m}}{\\alpha-1}.\n$$\n求解 $\\alpha$：\n$$\n\\bar{X}(\\alpha-1) \\;=\\; \\alpha x_{m}\n\\;\\Rightarrow\\; \\alpha\\bar{X} - \\bar{X} \\;=\\; \\alpha x_{m}\n\\;\\Rightarrow\\; \\alpha(\\bar{X}-x_{m}) \\;=\\; \\bar{X}\n\\;\\Rightarrow\\; \\alpha \\;=\\; \\frac{\\bar{X}}{\\bar{X}-x_{m}}.\n$$\n这得到了矩估计量 $\\hat{\\alpha} = \\frac{\\bar{X}}{\\bar{X}-x_{m}}$，当 $\\bar{X}  x_{m}$ 时，该估计量有明确定义，这与 $\\alpha1$ 相一致。", "answer": "$$\\boxed{\\frac{\\bar{X}}{\\bar{X}-x_{m}}}$$", "id": "1943011"}]}