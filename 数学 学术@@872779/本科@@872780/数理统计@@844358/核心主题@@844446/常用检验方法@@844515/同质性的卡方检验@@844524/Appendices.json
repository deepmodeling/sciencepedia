{"hands_on_practices": [{"introduction": "让我们从一个基础应用开始，掌握同质性卡方检验的核心计算步骤。这个练习将带你走过一个完整的检验流程，从计算列联表中的期望频数到得出最终的检验统计量，并与临界值进行比较，最终做出统计决策。通过这个关于不同年龄段用户操作系统偏好的市场研究案例[@problem_id:1904251]，你将建立起对该检验的基本直觉。", "problem": "一家科技市场研究公司正在调查消费者对手机操作系统的偏好在不同年龄段的人群中是否一致。该公司调查了两组独立的近期智能手机购买者：“Group A”由大学生组成，“Group B”由老年人组成。每个人的操作系统选择被分为“OS 1”、“OS 2”或“其他”。收集到的数据总结在下方的列联表中：\n\n| 组别 | OS 1 | OS 2 | 其他 |\n| :--- | :---: | :---: | :---: |\n| **Group A (学生)** | 81 | 145 | 24 |\n| **Group B (老年人)**| 69 | 95 | 16 |\n\n使用 $\\alpha = 0.05$ 的显著性水平，通过正式的假设检验确定正确的结论。在此显著性水平下，自由度为2的卡方分布的临界值为 $\\chi^2_{0.05, 2} = 5.991$。\n\n以下哪个陈述是最恰当的结论？\n\nA. 数据提供了充分的证据，可以断定两个组的操作系统选择分布是不同的。\n\nB. 数据没有提供充分的证据，可以断定两个组的操作系统选择分布是不同的。\n\nC. 数据证明了两个组的操作系统选择分布是相同的。\n\nD. 在得出任何统计结论之前，需要更大的样本量。", "solution": "我们使用卡方检验来检验两个独立组之间分类分布的同质性。\n\n定义假设：\n$H_{0}$：Group A和Group B的操作系统选择分布相同。\n$H_{1}$：Group A和Group B的操作系统选择分布不同。\n\n计算行总计、列总计和总计：\n$$n_{A}=81+145+24=250,\\quad n_{B}=69+95+16=180,$$\n$$c_{1}=81+69=150,\\quad c_{2}=145+95=240,\\quad c_{3}=24+16=40,$$\n$$N=250+180=430.$$\n\n在$H_{0}$下，单元格$(i,j)$的期望计数是$E_{ij}=\\dfrac{(\\text{row total}_{i})(\\text{column total}_{j})}{N}$。因此，对于Group A：\n$$E_{A,1}=\\frac{250\\cdot 150}{430}=\\frac{3750}{43},\\quad E_{A,2}=\\frac{250\\cdot 240}{430}=\\frac{6000}{43},\\quad E_{A,3}=\\frac{250\\cdot 40}{430}=\\frac{1000}{43},$$\n以及对于Group B：\n$$E_{B,1}=\\frac{180\\cdot 150}{430}=\\frac{2700}{43},\\quad E_{B,2}=\\frac{180\\cdot 240}{430}=\\frac{4320}{43},\\quad E_{B,3}=\\frac{180\\cdot 40}{430}=\\frac{720}{43}.$$\n\n卡方检验统计量是\n$$\\chi^{2}=\\sum_{i,j}\\frac{(O_{ij}-E_{ij})^{2}}{E_{ij}}.$$\n精确计算每个部分的贡献：\n$$\\frac{(81-\\frac{3750}{43})^{2}}{\\frac{3750}{43}}=\\frac{71289}{161250},\\quad \\frac{(145-\\frac{6000}{43})^{2}}{\\frac{6000}{43}}=\\frac{55225}{258000},\\quad \\frac{(24-\\frac{1000}{43})^{2}}{\\frac{1000}{43}}=\\frac{1024}{43000},$$\n$$\\frac{(69-\\frac{2700}{43})^{2}}{\\frac{2700}{43}}=\\frac{71289}{116100},\\quad \\frac{(95-\\frac{4320}{43})^{2}}{\\frac{4320}{43}}=\\frac{55225}{185760},\\quad \\frac{(16-\\frac{720}{43})^{2}}{\\frac{720}{43}}=\\frac{1024}{30960}.$$\n数值上，它们的和为\n$$\\chi^{2}\\approx 0.442102+0.214050+0.023814+0.614031+0.297405+0.033075\\approx 1.624477.$$\n\n自由度为 $(r-1)(c-1)=(2-1)(3-1)=2$。在显著性水平 $\\alpha=0.05$ 下，临界值为 $\\chi^{2}_{0.05,2}=5.991$。由于\n$$\\chi^{2}\\approx 1.624  5.991,$$\n我们未能拒绝 $H_{0}$。\n\n结论：数据没有提供足够的证据来断定这两个组的操作系统选择分布有所不同。最合适的选项是B。", "answer": "$$\\boxed{B}$$", "id": "1904251"}, {"introduction": "掌握了计算方法后，我们必须关注一个更深层次的问题：检验的基本假设。此练习[@problem_id:1904293]强调了卡方检验中一个至关重要的前提——观测独立性。它展示了一个常见的现实世界陷阱：如果不仔细定义独立的观测单位（例如，将单个用户会话而不是会话内的每次点击作为单位），将会导致错误的统计推断，尤其是在分析用户行为日志等数据时。", "problem": "一家电子商务公司的数据科学团队正在进行一项 A/B 测试，以评估一种新的推荐算法。一组用户，即实验组 ($G_T$)，接触新的算法，而另一组用户，即对照组 ($G_C$)，继续使用旧的算法。在实验期间，对照组记录了 $N_C = 20,000$ 次用户会话，实验组记录了 $N_T = 20,000$ 次用户会话。\n\n该团队的目标是确定新算法是否改变了用户行为的分布。用户行为由三个主要操作来表征：搜索 (S)、添加到购物车 (AC) 和购买 (P)。\n\n根据原始日志数据生成了两种不同的摘要。\n\n**数据集1：总操作计数**\n此表显示了在所有会话中，每个组记录的每种操作的总次数。\n| 操作类型 | 对照组 ($G_C$) | 实验组 ($G_T$) |\n|-----------------|-----------------------|-------------------------|\n| 搜索 (S) | 45,500 | 43,580 |\n| 添加到购物车 (AC)| 15,300 | 16,950 |\n| 购买 (P) | 5,950 | 6,350 |\n\n**数据集2：会话构成计数**\n此表根据会话中发生的唯一操作集，将 40,000 个会话中的每一个分类到七个互斥类别中的一个。例如，一个包含三次搜索和一次“添加到购物车”操作的会话将被分类为 `{S, AC}`。\n| 会话类别 | 对照组 ($G_C$) | 实验组 ($G_T$) |\n|------------------|-----------------------|-------------------------|\n| {S} | 12,500 | 11,800 |\n| {AC} | 100 | 150 |\n| {P} | 50 | 70 |\n| {S, AC} | 3,500 | 3,800 |\n| {S, P} | 450 | 500 |\n| {AC, P} | 900 | 1,100 |\n| {S, AC, P} | 2,500 | 2,580 |\n| **总会话数** | **20,000** | **20,000** |\n\n\n您的任务是检验原假设，即对照组和实验组的用户行为分布是相同的。您的分析必须基于一种能够正确处理观测值统计独立性的方法。\n\n计算此假设检验的卡方($\\chi^2$)检验统计量的值。将您的最终答案四舍五入到四位有效数字。", "solution": "我们必须使用统计上独立的观测单位来比较两组之间的用户行为分布。会话中的单个操作不是独立的，因此数据集1（操作计数）会违反独立性假设。数据集2将每个会话分类到七个互斥类别之一；会话是独立的，因此对这个 2x7 的列联表进行卡方同质性检验是合适的。\n\n设 $O_{ij}$ 表示行 $i \\in \\{G_{C},G_{T}\\}$ 和类别 $j \\in \\{1,\\dots,7\\}$ 的观测计数。设列总计为 $C_{j}$，总计为 $N=40000$。行总计为 $N_{C}=N_{T}=20000$。在原假设（即两个组的会话类别分布相同）下，期望计数为\n$$\nE_{ij}=\\frac{(\\text{row total }i)(\\text{column total }j)}{N}=\\frac{20000\\cdot C_{j}}{40000}=\\frac{C_{j}}{2}.\n$$\n根据数据集2，列总计为：\n$$\n\\begin{aligned}\nC_{1}=12500+11800=24300,  C_{2}=100+150=250,  C_{3}=50+70=120, \\\\\nC_{4}=3500+3800=7300,  C_{5}=450+500=950,  C_{6}=900+1100=2000, \\\\\nC_{7}=2500+2580=5080.\n\\end{aligned}\n$$\n因此，每个组在每个类别中的期望计数为\n$$\nE_{1}=12150,\\quad E_{2}=125,\\quad E_{3}=60,\\quad E_{4}=3650,\\quad E_{5}=475,\\quad E_{6}=1000,\\quad E_{7}=2540.\n$$\n卡方统计量为\n$$\n\\chi^{2}=\\sum_{j=1}^{7}\\sum_{i\\in\\{G_{C},G_{T}\\}}\\frac{(O_{ij}-E_{ij})^{2}}{E_{ij}}.\n$$\n因为对于每个 $j$，都有 $E_{G_{C},j}=E_{G_{T},j}$ 且 $O_{G_{C},j}-E_{j}=-(O_{G_{T},j}-E_{j})$，所以类别 $j$ 的贡献简化为\n$$\n\\frac{(O_{G_{C},j}-E_{j})^{2}}{E_{j}}+\\frac{(O_{G_{T},j}-E_{j})^{2}}{E_{j}}=2\\cdot\\frac{(O_{G_{C},j}-E_{j})^{2}}{E_{j}}.\n$$\n使用对照组的偏差 $d_{j}=O_{G_{C},j}-E_{j}$ 计算每个类别的贡献：\n- $j=1$：$d_{1}=12500-12150=350$，贡献 $=2\\cdot\\frac{350^{2}}{12150}=\\frac{4900}{243}$。\n- $j=2$：$d_{2}=100-125=-25$，贡献 $=2\\cdot\\frac{25^{2}}{125}=10$。\n- $j=3$：$d_{3}=50-60=-10$，贡献 $=2\\cdot\\frac{10^{2}}{60}=\\frac{10}{3}$。\n- $j=4$：$d_{4}=3500-3650=-150$，贡献 $=2\\cdot\\frac{150^{2}}{3650}=\\frac{900}{73}$。\n- $j=5$：$d_{5}=450-475=-25$，贡献 $=2\\cdot\\frac{25^{2}}{475}=\\frac{50}{19}$。\n- $j=6$：$d_{6}=900-1000=-100$，贡献 $=2\\cdot\\frac{100^{2}}{1000}=20$。\n- $j=7$：$d_{7}=2500-2540=-40$，贡献 $=2\\cdot\\frac{40^{2}}{2540}=\\frac{160}{127}$。\n\n因此，\n$$\n\\chi^{2}=\\frac{4900}{243}+10+\\frac{10}{3}+\\frac{900}{73}+\\frac{50}{19}+20+\\frac{160}{127}\\approx 69.718130977,\n$$\n保留四位有效数字后为 $69.72$。", "answer": "$$\\boxed{69.72}$$", "id": "1904293"}, {"introduction": "当卡方检验的结果显著，拒绝了同质性的原假设后，我们的分析并未结束。一个整体的显著性结果只告诉我们“存在差异”，但没有指明差异的来源。这个高级练习[@problem_id:1904284]将教你一种重要的后续分析技术——分割卡方统计量，通过合并列联表的行或列来定位造成异质性的具体群体或类别，从而从数据中获得更深入的洞见。", "problem": "一位生物学家正在研究一个特定基因在三种不同脑细胞类型中的表达模式：神经元 (C1)、星形胶质细胞 (C2) 和小胶质细胞 (C3)。对于每种细胞类型，一个细胞样本根据基因的表达水平被分为四类：低 (G1)、中 (G2)、高 (G3) 或未检测到 (G4)。观测到的计数汇总在下面的列联表中：\n\n| 细胞类型 | G1 (低) | G2 (中) | G3 (高) | G4 (未检测到) |\n|:---:|:---:|:---:|:---:|:---:|\n| C1 | 5 | 25 | 40 | 10 |\n| C2 | 15 | 30 | 15 | 20 |\n| C3 | 20 | 25 | 10 | 25 |\n\n一项初步分析拒绝了总体同质性零假设，表明基因表达水平的分布在所有三种细胞类型中并不相同。为了确定这种异质性的来源，一位研究人员假设神经元细胞 (C1) 的表达谱与胶质细胞（C2 和 C3）组合相比有显著不同。\n\n计算 C1 细胞组与 C2 和 C3 细胞组合组进行比较的皮尔逊卡方统计量。将您的最终答案四舍五入到四位有效数字。", "solution": "我们比较一个 2x4 的列联表：第 1 行是 $C1$，观测计数为 $(5,25,40,10)$；第 2 行是组合的胶质细胞 $(C2+C3)$，观测计数为 $(35,55,25,45)$。行总计为 $n_{1}=80$，$n_{2}=160$，总计为 $N=240$。列总计为 $T_{1}=40$，$T_{2}=80$，$T_{3}=65$，$T_{4}=55$。\n\n在 $C1$ 和 $(C2+C3)$ 之间同质性的零假设下，期望计数为 $E_{ij} = \\frac{n_{i}T_{j}}{N}$。因此对于 $C1$：\n$$\nE_{1\\cdot}=\\left(\\frac{80\\cdot 40}{240},\\frac{80\\cdot 80}{240},\\frac{80\\cdot 65}{240},\\frac{80\\cdot 55}{240}\\right)=\\left(\\frac{40}{3},\\frac{80}{3},\\frac{65}{3},\\frac{55}{3}\\right),\n$$\n对于 $(C2+C3)$：\n$$\nE_{2\\cdot}=\\left(\\frac{160\\cdot 40}{240},\\frac{160\\cdot 80}{240},\\frac{160\\cdot 65}{240},\\frac{160\\cdot 55}{240}\\right)=\\left(\\frac{80}{3},\\frac{160}{3},\\frac{130}{3},\\frac{110}{3}\\right).\n$$\n\nPearson 卡方统计量是\n$$\n\\chi^{2}=\\sum_{i=1}^{2}\\sum_{j=1}^{4}\\frac{(O_{ij}-E_{ij})^{2}}{E_{ij}}.\n$$\n计算每一项：\n$$\n\\frac{(5-\\frac{40}{3})^{2}}{\\frac{40}{3}}=\\frac{((-25/3)^{2})}{40/3}=\\frac{625}{9}\\cdot\\frac{3}{40}=\\frac{125}{24},\n$$\n$$\n\\frac{(25-\\frac{80}{3})^{2}}{\\frac{80}{3}}=\\frac{((-5/3)^{2})}{80/3}=\\frac{25}{9}\\cdot\\frac{3}{80}=\\frac{5}{48},\n$$\n$$\n\\frac{(40-\\frac{65}{3})^{2}}{\\frac{65}{3}}=\\frac{((55/3)^{2})}{65/3}=\\frac{3025}{9}\\cdot\\frac{3}{65}=\\frac{605}{39},\n$$\n$$\n\\frac{(10-\\frac{55}{3})^{2}}{\\frac{55}{3}}=\\frac{((-25/3)^{2})}{55/3}=\\frac{625}{9}\\cdot\\frac{3}{55}=\\frac{125}{33},\n$$\n$$\n\\frac{(35-\\frac{80}{3})^{2}}{\\frac{80}{3}}=\\frac{((25/3)^{2})}{80/3}=\\frac{625}{9}\\cdot\\frac{3}{80}=\\frac{125}{48},\n$$\n$$\n\\frac{(55-\\frac{160}{3})^{2}}{\\frac{160}{3}}=\\frac{((5/3)^{2})}{160/3}=\\frac{25}{9}\\cdot\\frac{3}{160}=\\frac{5}{96},\n$$\n$$\n\\frac{(25-\\frac{130}{3})^{2}}{\\frac{130}{3}}=\\frac{((-55/3)^{2})}{130/3}=\\frac{3025}{9}\\cdot\\frac{3}{130}=\\frac{605}{78},\n$$\n$$\n\\frac{(45-\\frac{110}{3})^{2}}{\\frac{110}{3}}=\\frac{((25/3)^{2})}{110/3}=\\frac{625}{9}\\cdot\\frac{3}{110}=\\frac{125}{66}.\n$$\n\n求和得出\n$$\n\\chi^{2}=\\frac{125}{24}+\\frac{5}{48}+\\frac{605}{39}+\\frac{125}{33}+\\frac{125}{48}+\\frac{5}{96}+\\frac{605}{78}+\\frac{125}{66}=\\frac{168945}{4576}\\approx 36.9197895105.\n$$\n四舍五入到四位有效数字，结果为 $36.92$。", "answer": "$$\\boxed{36.92}$$", "id": "1904284"}]}