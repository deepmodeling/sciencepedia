{"hands_on_practices": [{"introduction": "配对t检验的核心在于计算一个检验统计量，以评估两组成对样本均值之间的差异是否具有统计显著性。本练习提供了一个经典的工程学场景，旨在帮助你掌握配对t检验的基本计算步骤。通过分析一种新型混凝土固化工艺的效果，你将学会如何处理原始数据，计算差值，并最终得出t统计量的值 [@problem_id:1942773]。", "problem": "一位土木工程师正在研究一种旨在提高混凝土抗压强度的新专有养护工艺。为检验这一说法，该工程师使用来自九个不同批次的混凝土进行了一项实验。从每个批次中，浇筑了两个相同的立方体试块。其中一个试块使用标准方法进行养护，另一个则使用新的实验工艺进行养护。这种配对确保了批次之间混凝土混合料的差异不会对结果产生混淆影响。\n\n28天后，测量了每个立方体试块的抗压强度，单位为兆帕 (MPa)。结果如下：\n\n- 批次 1：标准方法 = 35.1 MPa, 新工艺 = 36.2 MPa\n- 批次 2：标准方法 = 34.8 MPa, 新工艺 = 35.9 MPa\n- 批次 3：标准方法 = 36.5 MPa, 新工艺 = 37.0 MPa\n- 批次 4：标准方法 = 33.9 MPa, 新工艺 = 35.5 MPa\n- 批次 5：标准方法 = 37.2 MPa, 新工艺 = 37.5 MPa\n- 批次 6：标准方法 = 35.5 MPa, 新工艺 = 36.8 MPa\n- 批次 7：标准方法 = 34.1 MPa, 新工艺 = 35.1 MPa\n- 批次 8：标准方法 = 36.0 MPa, 新工艺 = 36.3 MPa\n- 批次 9：标准方法 = 35.8 MPa, 新工艺 = 37.1 MPa\n\n该工程师希望检验与标准工艺相比，新工艺是否能产生显著更高的平均抗压强度。假设配对试块之间的抗压强度差异近似服从正态分布。\n\n计算用于此假设检验的t检验统计量的值。将最终答案四舍五入到四位有效数字。", "solution": "我们对每个批次的差异值 $d_{i} = \\text{新工艺} - \\text{标准方法}$ 进行配对t检验。假设为 $H_{0}:\\mu_{d}=0$ 对立于 $H_{1}:\\mu_{d}0$，检验统计量为\n$$\nt=\\frac{\\bar{d}}{s_{d}/\\sqrt{n}},\n$$\n其中 $\\bar{d}$ 是差异的样本均值，$s_{d}$ 是差异的样本标准差，$n$ 是配对的数量。\n\n计算差异值：\n$$\nd=\\{1.1,\\,1.1,\\,0.5,\\,1.6,\\,0.3,\\,1.3,\\,1.0,\\,0.3,\\,1.3\\}.\n$$\n差异之和：\n$$\n\\sum d_{i}=8.5,\\quad n=9,\\quad \\bar{d}=\\frac{8.5}{9}=\\frac{17}{18}.\n$$\n计算与均值的离差平方和。首先，离差平方和为\n$$\n\\sum_{i=1}^{9}(d_{i}-\\bar{d})^{2}=\\sum d_{i}^{2}-n\\bar{d}^{2}.\n$$\n我们有\n$$\n\\sum d_{i}^{2}=1.21+1.21+0.25+2.56+0.09+1.69+1.00+0.09+1.69=9.79=\\frac{979}{100},\n$$\n并且\n$$\nn\\bar{d}^{2}=9\\left(\\frac{17}{18}\\right)^{2}=\\frac{289}{36}.\n$$\n因此，\n$$\n\\sum_{i=1}^{9}(d_{i}-\\bar{d})^{2}=\\frac{979}{100}-\\frac{289}{36}=\\frac{793}{450}.\n$$\n差异的样本方差和样本标准差分别为\n$$\ns_{d}^{2}=\\frac{1}{n-1}\\sum_{i=1}^{9}(d_{i}-\\bar{d})^{2}=\\frac{1}{8}\\cdot\\frac{793}{450}=\\frac{793}{3600},\\qquad s_{d}=\\frac{\\sqrt{793}}{60}.\n$$\n因此，t统计量为\n$$\nt=\\frac{\\bar{d}}{s_{d}/\\sqrt{n}}=\\frac{\\frac{17}{18}}{\\frac{\\sqrt{793}}{60}/3}=\\frac{170}{\\sqrt{793}}.\n$$\n数值上，\n$$\nt\\approx\\frac{170}{\\sqrt{793}}\\approx 6.03688\\ \\Rightarrow\\ \\text{保留四位有效数字：} 6.037\n$$", "answer": "$$\\boxed{6.037}$$", "id": "1942773"}, {"introduction": "虽然配对t检验是一个强大的工具，但它的有效性依赖于关键的假设，即配对差异近似服从正态分布。当数据中存在异常值时，这一假设可能不成立。本练习将引导你进行批判性思考，探讨何时应优先选择非参数替代方法（如符号检验），从而加深你对统计检验选择背后假设重要性的理解 [@problem_id:1963411]。", "problem": "一位认知心理学家正在研究一种特定的草药补充剂对认知反应速度的影响。十名健康的成年志愿者参与了这项研究。每位参与者在服用补充剂前对视觉刺激的反应时间（以毫秒 ms 计）被测量。在服用标准剂量的补充剂一小时后，他们对同类型刺激的反应时间被再次测量。十名参与者的配对测量值（服用前，服用后）记录如下：(510, 495), (530, 520), (480, 485), (505, 490), (650, 530), (515, 500), (495, 490), (525, 510), (720, 540) 和 (500, 495)。\n\n研究人员想确定该补充剂是否对反应时间有统计学上的显著影响。在决定使用配对t检验还是符号检验来分析这些数据时，有人主张优先选择符号检验。下列哪个陈述为这一偏好提供了最佳的统计学理由？\n\nA. 配对t检验假设配对观测值之间的差异近似服从正态分布。该数据集中存在的少数几个非常大的差异使得这一假设值得怀疑，而符号检验则不要求正态性。\n\nB. 无论数据分布如何，符号检验的统计功效总是比配对t检验更强，这使其成为检测效应的更优选择。\n\nC. 样本量为10太小，无法使用配对t检验，根据中心极限定理，该检验需要至少30个观测值才有效。\n\nD. 必须使用符号检验，因为数据中包含负差值 (480 - 485 = -5)，而配对t检验仅在所有差值均为正时才有效。\n\nE. 符号检验的计算要简单得多，因此比配对t检验所需的更复杂的公式更不容易出现计算错误。", "solution": "定义配对差异为 $d_{i} = \\text{服用后}_i - \\text{服用前}_i$，其中 $i=1,\\dots,10$。根据数据，这些差异是\n$$\nd_{1}=-15,\\ d_{2}=-10,\\ d_{3}=+5,\\ d_{4}=-15,\\ d_{5}=-120,\\ d_{6}=-15,\\ d_{7}=-5,\\ d_{8}=-15,\\ d_{9}=-180,\\ d_{10}=-5.\n$$\n配对$t$检验将差异建模为独立同分布的正态随机变量，$d_{i}\\sim \\mathcal{N}(\\mu_{d},\\sigma_{d}^{2})$，并使用统计量\n$$\nt=\\frac{\\bar{d}-0}{s_{d}/\\sqrt{n}},\n$$\n来检验 $H_{0}:\\mu_{d}=0$。当$n$较小时，该检验依赖于 $d_{i}$ 的近似正态性。相对于其余差异，存在两个绝对值非常大的差异，即 $-120$ 和 $-180$，这使得 $d_{i}$ 的正态性假设值得怀疑，并且使得$t$检验对异常值敏感。\n\n相比之下，符号检验检验的是差异的中位数，而无需假设正态性。在中位数差异为零的原假设 $H_{0}$ 下，$d_{i}$ 的符号被建模为独立同分布的伯努利变量，其中 $P(d_{i}0)=\\frac{1}{2}$，从而得到正号的二项计数。由于它只使用符号而不使用数值大小，因此它对异常值具有稳健性，并且不要求 $d_{i}$ 的正态性。\n\n因此，在此处优先选择符号检验的统计学上合理的理由是，由于存在少数几个非常大的差异，配对差异的近似正态性假设是可疑的，而符号检验则不要求正态性。这对应于选项A。其他选项是不正确的：符号检验并非总是比配对$t$检验更具统计功效；配对$t$检验不要求 $n\\geq 30$；负差值的存在不会使$t$检验无效；计算简单性不是一个统计学上的理由。", "answer": "$$\\boxed{A}$$", "id": "1963411"}, {"introduction": "配对t检验的威力在很大程度上源于它能够有效控制配对样本间的变异。本挑战性练习将揭示这种威力背后的数学原理，要求你推导出一个描述配对样本相关性与检验显著性之间关系的公式。通过解决这个问题，你将深入理解为何在配对样本高度相关时，配对t检验能更灵敏地检测出均值之间的微小差异 [@problem_id:1942781]。", "problem": "一位数据科学家使用 $k$ 折交叉验证程序，在分类任务上评估两个不同的机器学习模型，模型 A 和模型 B。两个模型使用相同的 $k$ 个数据折，从而产生 $k$ 组配对的准确率测量值。设 $A_i$ 和 $B_i$ 分别是模型 A 和模型 B 在第 $i$ 折上的准确率，其中 $i = 1, \\dots, k$。\n\n由于存储故障，每折的原始准确率数据已经丢失。但是，以下汇总统计数据得以保留：\n- 折数，$k$。\n- 模型 A 的样本平均准确率 $\\bar{A}$，以及模型 B 的样本平均准确率 $\\bar{B}$。\n- 模型 A 准确率的样本标准差 $s_A$，以及模型 B 准确率的样本标准差 $s_B$。\n\n该数据科学家想要检验原假设 $H_0: \\mu_A = \\mu_B$ 与备择假设 $H_1: \\mu_A \\neq \\mu_B$，其中 $\\mu_A$ 和 $\\mu_B$ 是真实的平均准确率。配对 t 检验适用于此场景。检验将在显著性水平 $\\alpha$ 下进行。设 $t_{crit}$ 是自由度为 $k-1$ 的 t 分布的正临界值，如果计算出的 t 统计量的绝对值大于或等于 $t_{crit}$，则结果具有统计显著性。\n\n假设观察到的样本均值显示模型 A 表现更好，即 $\\bar{A} > \\bar{B}$。该数据科学家还有一个工具可以计算准确率集合 $\\{A_1, \\dots, A_k\\}$ 和 $\\{B_1, \\dots, B_k\\}$ 之间的 Pearson 相关系数 $r$。为了达到统计显著性，必须观测到的该相关系数的最小值 $r_{min}$ 是多少？\n\n请推导一个用 $k$、$\\bar{A}$、$\\bar{B}$、$s_A$、$s_B$ 和 $t_{crit}$ 表示 $r_{min}$ 的封闭形式解析表达式。", "solution": "问题要求使用配对 t 检验来确定模型 A 和模型 B 性能之间存在统计显著性差异所需的最小 Pearson 相关系数 $r_{min}$。\n\n对于这种配对数据，适用的检验是配对 t 检验。我们定义一个新变量 $D_i = A_i - B_i$，表示每折 $i$ 的准确率差异。原假设是这些差异的真实均值为零，$H_0: \\mu_D = 0$，备择假设是 $H_1: \\mu_D \\neq 0$。\n\n差异的样本均值为 $\\bar{D} = \\frac{1}{k}\\sum_{i=1}^k D_i = \\frac{1}{k}\\sum_{i=1}^k (A_i - B_i) = \\bar{A} - \\bar{B}$。\n差异的样本标准差为 $s_D$。配对 t 检验统计量由下式给出：\n$$t = \\frac{\\bar{D} - 0}{s_D / \\sqrt{k}} = \\frac{\\bar{A} - \\bar{B}}{s_D / \\sqrt{k}}$$\n为了使结果在与临界值 $t_{crit}$ 对应的水平上具有统计显著性，t 统计量的绝对值必须满足 $|t| \\ge t_{crit}$。由于问题陈述 $\\bar{A} > \\bar{B}$，我们有 $\\bar{D} > 0$，因此 t 统计量将为正。该条件简化为 $t \\ge t_{crit}$。\n\n主要的挑战是用给定的量（包括 $s_A$、$s_B$ 和相关系数 $r$）来表示 $s_D$。差异的样本方差 $s_D^2$ 定义为：\n$$s_D^2 = \\frac{1}{k-1} \\sum_{i=1}^k (D_i - \\bar{D})^2$$\n代入 $D_i = A_i - B_i$ 和 $\\bar{D} = \\bar{A} - \\bar{B}$：\n$$D_i - \\bar{D} = (A_i - B_i) - (\\bar{A} - \\bar{B}) = (A_i - \\bar{A}) - (B_i - \\bar{B})$$\n因此，$s_D^2$ 的表达式变为：\n$$s_D^2 = \\frac{1}{k-1} \\sum_{i=1}^k \\left[ (A_i - \\bar{A}) - (B_i - \\bar{B}) \\right]^2$$\n展开求和号内的平方项：\n$$s_D^2 = \\frac{1}{k-1} \\sum_{i=1}^k \\left[ (A_i - \\bar{A})^2 - 2(A_i - \\bar{A})(B_i - \\bar{B}) + (B_i - \\bar{B})^2 \\right]$$\n我们可以分配求和以及因子 $\\frac{1}{k-1}$：\n$$s_D^2 = \\frac{\\sum_{i=1}^k (A_i - \\bar{A})^2}{k-1} + \\frac{\\sum_{i=1}^k (B_i - \\bar{B})^2}{k-1} - 2 \\frac{\\sum_{i=1}^k (A_i - \\bar{A})(B_i - \\bar{B})}{k-1}$$\n我们识别出这些项是样本方差和样本协方差：\n- A 的样本方差：$s_A^2 = \\frac{\\sum_{i=1}^k (A_i - \\bar{A})^2}{k-1}$\n- B 的样本方差：$s_B^2 = \\frac{\\sum_{i=1}^k (B_i - \\bar{B})^2}{k-1}$\n- A 和 B 的样本协方差：$s_{AB} = \\frac{\\sum_{i=1}^k (A_i - \\bar{A})(B_i - \\bar{B})}{k-1}$\n\n因此，差异的方差可以写成：\n$$s_D^2 = s_A^2 + s_B^2 - 2 s_{AB}$$\nPearson 相关系数 $r$ 定义为 $r = \\frac{s_{AB}}{s_A s_B}$。我们可以将协方差表示为 $s_{AB} = r s_A s_B$。将此代入 $s_D^2$ 的方程中：\n$$s_D^2 = s_A^2 + s_B^2 - 2 r s_A s_B$$\n现在，将 $s_D^2$ 的这个表达式代回 t 统计量公式中：\n$$t = \\frac{\\bar{A} - \\bar{B}}{\\sqrt{\\frac{s_A^2 + s_B^2 - 2 r s_A s_B}{k}}}$$\n统计显著性的条件是 $t \\ge t_{crit}$。我们正在寻找满足此条件的 $r$ 的最小值。分母越小，t 值越大。当项 $s_A^2 + s_B^2 - 2 r s_A s_B$ 最小时，分母最小化。这发生在 $r$ 取最大可能值时。相反，为了满足阈值 $t \\ge t_{crit}$，我们需要分母足够小。让我们解关于 $r$ 的不等式：\n$$\\frac{\\bar{A} - \\bar{B}}{\\sqrt{\\frac{s_A^2 + s_B^2 - 2 r s_A s_B}{k}}} \\ge t_{crit}$$\n由于两边都是正数，我们可以对它们进行平方而不改变不等式的方向：\n$$\\frac{(\\bar{A} - \\bar{B})^2}{\\frac{s_A^2 + s_B^2 - 2 r s_A s_B}{k}} \\ge t_{crit}^2$$\n现在，我们重新整理不等式以求解 $r$：\n$$k (\\bar{A} - \\bar{B})^2 \\ge t_{crit}^2 (s_A^2 + s_B^2 - 2 r s_A s_B)$$\n$$\\frac{k (\\bar{A} - \\bar{B})^2}{t_{crit}^2} \\ge s_A^2 + s_B^2 - 2 r s_A s_B$$\n分离含有 $r$ 的项：\n$$2 r s_A s_B \\ge s_A^2 + s_B^2 - \\frac{k (\\bar{A} - \\bar{B})^2}{t_{crit}^2}$$\n由于 $s_A$ 和 $s_B$ 是标准差，它们是非负的。假设它们不为零（否则相关性未定义或无意义），我们可以除以 $2 s_A s_B$：\n$$r \\ge \\frac{s_A^2 + s_B^2}{2 s_A s_B} - \\frac{k (\\bar{A} - \\bar{B})^2}{2 s_A s_B t_{crit}^2}$$\n这个不等式给出了 $r$ 为使结果显著而必须满足的条件。因此，所需的 $r$ 的最小值 $r_{min}$ 是不等式的右侧。\n\n$$r_{min} = \\frac{s_A^2 + s_B^2}{2 s_A s_B} - \\frac{k (\\bar{A} - \\bar{B})^2}{2 s_A s_B t_{crit}^2}$$\n这可以更紧凑地写成：\n$$r_{min} = \\frac{1}{2 s_A s_B} \\left( s_A^2 + s_B^2 - \\frac{k (\\bar{A} - \\bar{B})^2}{t_{crit}^2} \\right)$$\n这是所需的最小相关系数的最终表达式。", "answer": "$$\\boxed{\\frac{s_A^2 + s_B^2}{2 s_A s_B} - \\frac{k (\\bar{A} - \\bar{B})^2}{2 s_A s_B t_{crit}^2}}$$", "id": "1942781"}]}