{"hands_on_practices": [{"introduction": "最小二乘法的核心思想是找到一条线，使得所有数据点到该线的垂直距离的平方和最小。在着手最小化任何函数之前，我们必须首先明确地写出这个函数。本练习 [@problem_id:1935126] 将指导你为一个具体的小数据集构建这个被称为“残差平方和”的目标函数，这是掌握最小二乘法的第一步。", "problem": "在统计建模中，通常使用简单线性回归模型来描述预测变量 $x$ 和响应变量 $y$ 之间的关系。该模型由方程 $y = \\beta_0 + \\beta_1 x$ 给出，其中 $\\beta_0$ 表示$y$轴截距，$\\beta_1$ 表示斜率。最小二乘法提供了一种估计参数 $\\beta_0$ 和 $\\beta_1$ 的方法，它通过找到一条直线，使观测响应值与线性模型预测的响应值之间的平方差之和最小。\n\n假设一个实验产生了以下三个数据点 $(x, y)$:\n$$ \\{(0, 1), (1, 3), (2, 4)\\} $$\n为了找到最小二乘回归线，我们必须最小化一个函数 $S(\\beta_0, \\beta_1)$，该函数表示此数据集的残差平方和。\n\n请确定函数 $S(\\beta_0, \\beta_1)$ 关于参数 $\\beta_0$ 和 $\\beta_1$ 的显式形式。", "solution": "最小二乘准则旨在最小化残差平方和。对于线性模型 $y=\\beta_{0}+\\beta_{1}x$ 和数据点 $(x_{i},y_{i})$，第 $i$ 个点的残差是 $r_{i}=y_{i}-(\\beta_{0}+\\beta_{1}x_{i})$，残差平方和为\n$$\nS(\\beta_{0},\\beta_{1})=\\sum_{i=1}^{n}\\left[y_{i}-(\\beta_{0}+\\beta_{1}x_{i})\\right]^{2}.\n$$\n对于给定的三个点 $(0,1)$、$(1,3)$ 和 $(2,4)$，该式变为\n$$\nS(\\beta_{0},\\beta_{1})=\\left[1-(\\beta_{0}+\\beta_{1}\\cdot 0)\\right]^{2}+\\left[3-(\\beta_{0}+\\beta_{1}\\cdot 1)\\right]^{2}+\\left[4-(\\beta_{0}+\\beta_{1}\\cdot 2)\\right]^{2}.\n$$\n化简平方项内的表达式得到\n$$\nS(\\beta_{0},\\beta_{1})=(1-\\beta_{0})^{2}+(3-\\beta_{0}-\\beta_{1})^{2}+(4-\\beta_{0}-2\\beta_{1})^{2}.\n$$\n展开每一项：\n$$\n(1-\\beta_{0})^{2}=\\beta_{0}^{2}-2\\beta_{0}+1,\n$$\n$$\n(3-\\beta_{0}-\\beta_{1})^{2}=\\beta_{0}^{2}+2\\beta_{0}\\beta_{1}+\\beta_{1}^{2}-6\\beta_{0}-6\\beta_{1}+9,\n$$\n$$\n(4-\\beta_{0}-2\\beta_{1})^{2}=\\beta_{0}^{2}+4\\beta_{0}\\beta_{1}+4\\beta_{1}^{2}-8\\beta_{0}-16\\beta_{1}+16.\n$$\n求和并合并同类项得到\n$$\nS(\\beta_{0},\\beta_{1})=3\\beta_{0}^{2}+6\\beta_{0}\\beta_{1}+5\\beta_{1}^{2}-16\\beta_{0}-22\\beta_{1}+26.\n$$", "answer": "$$\\boxed{3 \\beta_{0}^{2} + 6 \\beta_{0} \\beta_{1} + 5 \\beta_{1}^{2} - 16 \\beta_{0} - 22 \\beta_{1} + 26}$$", "id": "1935126"}, {"introduction": "通过最小二乘法得到“最佳拟合”线后，我们得到的残差（即观测值与拟合值之间的差异）并非毫无规律。这些残差具有一些重要的数学特性，这些特性是最小二乘法几何意义的直接体现。通过这个练习 [@problem_id:1935149]，你将探索残差与原始预测变量之间的关系，揭示一个在模型诊断中至关重要的基本性质。", "problem": "在统计建模的背景下，考虑对一个包含 $n$ 对观测值 $(x_1, y_1), (x_2, y_2), \\dots, (x_n, y_n)$ 的数据集进行简单线性回归，我们假设并非所有的 $x_i$ 值都相同。模型由 $y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$ 给出。使用最小二乘法来寻找截距 $\\hat{\\beta}_0$ 和斜率 $\\hat{\\beta}_1$ 的估计量。\n\n从这个初始回归中，拟合值计算为 $\\hat{y}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_i$。然后为每个观测值计算相应的残差 $e_i = y_i - \\hat{y}_i$。\n\n现在，假设您进行第二次新的简单线性回归。在这个新回归中，您将计算出的残差 $e_i$ 作为新的响应变量，并将原始的 $x_i$ 值作为预测变量。这个新模型的形式为 $e_i = \\gamma_0 + \\gamma_1 x_i + \\delta_i$。\n\n确定这次回归的截距 $\\hat{\\gamma}_0$ 和斜率 $\\hat{\\gamma}_1$ 的最小二乘估计量的值。将您的最终答案表示为一个包含两个元素的行矩阵，其中第一个元素是 $\\hat{\\gamma}_0$ 的值，第二个元素是 $\\hat{\\gamma}_1$ 的值。", "solution": "考虑第一个最小二乘问题，模型为 $y_i=\\beta_{0}+\\beta_{1}x_i+\\epsilon_i$，残差为 $e_i=y_i-\\hat{y}_i=y_i-\\hat{\\beta}_{0}-\\hat{\\beta}_{1}x_i$。最小二乘估计量 $(\\hat{\\beta}_{0},\\hat{\\beta}_{1})$ 最小化\n$$\nS(\\beta_{0},\\beta_{1})=\\sum_{i=1}^{n}\\left(y_i-\\beta_{0}-\\beta_{1}x_i\\right)^{2}.\n$$\n通过将偏导数设为零得到正规方程组：\n$$\n\\frac{\\partial S}{\\partial \\beta_{0}}=-2\\sum_{i=1}^{n}\\left(y_i-\\beta_{0}-\\beta_{1}x_i\\right)=0,\\quad\n\\frac{\\partial S}{\\partial \\beta_{1}}=-2\\sum_{i=1}^{n}x_i\\left(y_i-\\beta_{0}-\\beta_{1}x_i\\right)=0.\n$$\n在 $(\\hat{\\beta}_{0},\\hat{\\beta}_{1})$ 处求值，得到\n$$\n\\sum_{i=1}^{n}e_i=0,\\qquad \\sum_{i=1}^{n}x_i e_i=0.\n$$\n因此，第一次回归的残差满足和为零以及与 $x$ 正交。\n\n现在考虑以 $e_i$ 为响应、$x_i$ 为预测变量的第二次回归：\n$$\ne_i=\\gamma_{0}+\\gamma_{1}x_i+\\delta_i,\n$$\n其最小二乘估计量 $(\\hat{\\gamma}_{0},\\hat{\\gamma}_{1})$ 最小化\n$$\nT(\\gamma_{0},\\gamma_{1})=\\sum_{i=1}^{n}\\left(e_i-\\gamma_{0}-\\gamma_{1}x_i\\right)^{2}.\n$$\n正规方程组为\n$$\n\\frac{\\partial T}{\\partial \\gamma_{0}}=-2\\sum_{i=1}^{n}\\left(e_i-\\gamma_{0}-\\gamma_{1}x_i\\right)=0,\\qquad\n\\frac{\\partial T}{\\partial \\gamma_{1}}=-2\\sum_{i=1}^{n}x_i\\left(e_i-\\gamma_{0}-\\gamma_{1}x_i\\right)=0.\n$$\n令 $\\bar{e}=\\frac{1}{n}\\sum_{i=1}^{n}e_i$ 且 $\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_i$。以标准方式求解正规方程组可得\n$$\n\\hat{\\gamma}_{1}=\\frac{\\sum_{i=1}^{n}(x_i-\\bar{x})(e_i-\\bar{e})}{\\sum_{i=1}^{n}(x_i-\\bar{x})^{2}},\\qquad\n\\hat{\\gamma}_{0}=\\bar{e}-\\hat{\\gamma}_{1}\\bar{x}.\n$$\n从第一次回归我们有 $\\sum_{i=1}^{n}e_i=0$，因此 $\\bar{e}=0$，并且 $\\sum_{i=1}^{n}x_i e_i=0$。因此\n$$\n\\sum_{i=1}^{n}(x_i-\\bar{x})(e_i-\\bar{e})=\\sum_{i=1}^{n}x_i e_i - n\\bar{x}\\bar{e}=0- n\\bar{x}\\cdot 0=0.\n$$\n因为并非所有的 $x_i$ 都相等，所以分母 $\\sum_{i=1}^{n}(x_i-\\bar{x})^{2}>0$。于是\n$$\n\\hat{\\gamma}_{1}=0,\\qquad \\hat{\\gamma}_{0}=\\bar{e}-\\hat{\\gamma}_{1}\\bar{x}=0-0\\cdot \\bar{x}=0.\n$$\n根据当 $\\sum_{i=1}^{n}(x_i-\\bar{x})^{2}>0$ 时最小二乘解的唯一性，这些就是第二次回归的最小二乘估计量。", "answer": "$$\\boxed{\\begin{pmatrix}0  0\\end{pmatrix}}$$", "id": "1935149"}, {"introduction": "最小二乘法的原理不仅限于简单的双变量线性关系，它同样可以应用于更复杂的模型。这个练习 [@problem_id:1935134] 展示了如何通过巧妙的代数变换，将一个带有参数约束的多元回归问题转化为我们熟悉的简单线性回归形式。这不仅体现了该方法的灵活性，也锻炼了将新问题转化为已知问题来解决的建模能力。", "problem": "一位生态学家正在研究一个湖泊中某种浮游生物 $Y$ 的种群密度。该生态学家假设，其种群密度与两个关键环境因素线性相关：水温 $x_1$ 和特定营养物质的浓度 $x_2$。基于一个初步的生态系统模型，有理论依据认为，控制温度和营养物质浓度的边际效应的参数是耦合的。\n\n对于湖中 $n$ 个不同地点采集的样本，收集了数据 $(Y_i, x_{i1}, x_{i2})$，其中 $i = 1, \\dots, n$。提出的统计模型如下：\n$$ Y_i = \\beta_0 + \\theta x_{i1} + (1-\\theta)x_{i2} + \\epsilon_i $$\n在此模型中，$Y_i$ 是地点 $i$ 的浮游生物密度（单位：细胞/升），$x_{i1}$ 是水温（单位：摄氏度），$x_{i2}$ 是营养物质浓度（单位：微摩尔/升）。参数 $\\theta$ 是一个划分综合效应的无量纲常数，$\\beta_0$ 是基线密度，$\\epsilon_i$ 是独立同分布的随机误差，其均值为零，方差为常数 $\\sigma^2$。\n\n您的任务是求参数 $\\theta$ 的最小二乘估计量，记为 $\\hat{\\theta}$。请将您的答案表示为关于观测数据 $Y_i, x_{i1}, x_{i2}$ 及其相应样本均值 $\\bar{Y}, \\bar{x}_1, \\bar{x}_2$ 的单一闭式解析表达式。对于任意变量 $v$，样本均值定义为 $\\bar{v} = \\frac{1}{n} \\sum_{i=1}^{n} v_i$。", "solution": "我们给定的模型是\n$$\nY_i=\\beta_0+\\theta x_{i1}+(1-\\theta)x_{i2}+\\epsilon_i,\n$$\n可改写为\n$$\nY_i - x_{i2}=\\beta_0+\\theta\\left(x_{i1}-x_{i2}\\right)+\\epsilon_i.\n$$\n定义 $b_i=Y_i-x_{i2}$ 和 $d_i=x_{i1}-x_{i2}$。则模型为\n$$\nb_i=\\beta_0+\\theta d_i+\\epsilon_i.\n$$\n普通最小二乘估计量旨在最小化\n$$\nS(\\beta_0,\\theta)=\\sum_{i=1}^{n}\\left(b_i-\\beta_0-\\theta d_i\\right)^{2}.\n$$\n通过将偏导数设为零，可得正规方程：\n$$\n\\frac{\\partial S}{\\partial \\beta_0}=-2\\sum_{i=1}^{n}\\left(b_i-\\beta_0-\\theta d_i\\right)=0,\\qquad\n\\frac{\\partial S}{\\partial \\theta}=-2\\sum_{i=1}^{n}d_i\\left(b_i-\\beta_0-\\theta d_i\\right)=0.\n$$\n由第一个方程可得，\n$$\n\\sum_{i=1}^{n} b_i - n\\beta_0 - \\theta \\sum_{i=1}^{n} d_i=0\n\\;\\;\\Rightarrow\\;\\;\n\\beta_0=\\bar{b}-\\theta \\bar{d},\n$$\n其中 $\\bar{b}=\\frac{1}{n}\\sum_{i=1}^{n}b_i=\\bar{Y}-\\bar{x}_2$ 且 $\\bar{d}=\\frac{1}{n}\\sum_{i=1}^{n}d_i=\\bar{x}_1-\\bar{x}_2$。将 $\\beta_0=\\bar{b}-\\theta \\bar{d}$ 代入第二个正规方程：\n$$\n\\sum_{i=1}^{n} d_i\\left[b_i-(\\bar{b}-\\theta \\bar{d})-\\theta d_i\\right]=0\n\\;\\;\\Rightarrow\\;\\;\n\\sum_{i=1}^{n} d_i\\left[(b_i-\\bar{b})-\\theta(d_i-\\bar{d})\\right]=0.\n$$\n重新整理得，\n$$\n\\sum_{i=1}^{n} d_i(b_i-\\bar{b})-\\theta \\sum_{i=1}^{n} d_i(d_i-\\bar{d})=0.\n$$\n利用 $d_i=d_i-\\bar{d}+\\bar{d}$ 以及 $\\sum_{i=1}^{n}(b_i-\\bar{b})=0$ 和 $\\sum_{i=1}^{n}(d_i-\\bar{d})=0$ 的事实，我们得到中心化形式\n$$\n\\sum_{i=1}^{n} (d_i-\\bar{d})(b_i-\\bar{b})-\\theta \\sum_{i=1}^{n} (d_i-\\bar{d})^{2}=0.\n$$\n解出 $\\theta$ 可得\n$$\n\\hat{\\theta}=\\frac{\\sum_{i=1}^{n} (d_i-\\bar{d})(b_i-\\bar{b})}{\\sum_{i=1}^{n} (d_i-\\bar{d})^{2}}.\n$$\n将 $d_i=x_{i1}-x_{i2}$，$\\bar{d}=\\bar{x}_1-\\bar{x}_2$，$b_i=Y_i-x_{i2}$ 和 $\\bar{b}=\\bar{Y}-\\bar{x}_2$ 代回，我们得到以观测变量及其均值表示的所需闭式表达式：\n$$\n\\hat{\\theta}=\\frac{\\sum_{i=1}^{n}\\left[(x_{i1}-x_{i2})-(\\bar{x}_1-\\bar{x}_2)\\right]\\left[(Y_i-x_{i2})-(\\bar{Y}-\\bar{x}_2)\\right]}{\\sum_{i=1}^{n}\\left[(x_{i1}-x_{i2})-(\\bar{x}_1-\\bar{x}_2)\\right]^{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{n}\\left[(x_{i1}-x_{i2})-(\\bar{x}_1-\\bar{x}_2)\\right]\\left[(Y_i-x_{i2})-(\\bar{Y}-\\bar{x}_2)\\right]}{\\sum_{i=1}^{n}\\left[(x_{i1}-x_{i2})-(\\bar{x}_1-\\bar{x}_2)\\right]^{2}}}$$", "id": "1935134"}]}