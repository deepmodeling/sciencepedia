{"hands_on_practices": [{"introduction": "这第一个练习是极大似然估计过程的经典入门。通过分析制造业环境中的缺陷计数，你将把极大似然估计的核心步骤应用于一个离散分布，并了解不变性原理如何让我们不仅能估计分布的参数，还能估计该参数的函数，比如其方差。[@problem_id:1917484]", "problem": "一家纺织品制造商正在实施一项新的质量控制协议。在随机选择的一平方米织物区域中发现的瑕疵（如抽丝或变色）数量，可以用一个泊松分布来建模，其率参数 $\\lambda$ 未知。这个参数 $\\lambda$ 表示每平方米的平均瑕疵数。\n\n为了评估一批新织物，一位质量控制工程师检查了 $n=8$ 个独立的一平方米样本，并记录了每个样本的瑕疵数量。观察到的计数如下：\n$$3, 5, 2, 4, 3, 4, 6, 3$$\n\n假设这些观测值是来自此泊松分布的独立同分布样本，求这批织物每平方米瑕疵数量方差的最大似然估计 (MLE)。", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布于 $\\operatorname{Poisson}(\\lambda)$ 的随机变量，其概率质量函数 (pmf) 为 $P(X=x)=\\frac{\\lambda^{x}\\exp(-\\lambda)}{x!}$，其中 $x\\in\\{0,1,2,\\dots\\}$。对于观测值 $x_{1},\\dots,x_{n}$，其似然函数为\n$$\nL(\\lambda)=\\prod_{i=1}^{n}\\frac{\\lambda^{x_{i}}\\exp(-\\lambda)}{x_{i}!}\n=\\frac{\\lambda^{\\sum_{i=1}^{n}x_{i}}\\exp(-n\\lambda)}{\\prod_{i=1}^{n}x_{i}!}.\n$$\n对数似然函数为\n$$\n\\ell(\\lambda)=\\ln L(\\lambda)=\\left(\\sum_{i=1}^{n}x_{i}\\right)\\ln\\lambda - n\\lambda - \\sum_{i=1}^{n}\\ln(x_{i}!).\n$$\n对 $\\lambda$ 求导并令其为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda}=\\frac{\\sum_{i=1}^{n}x_{i}}{\\lambda}-n=0\n\\quad\\Longrightarrow\\quad\n\\hat{\\lambda}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n二阶导数为 $\\frac{\\partial^{2}\\ell}{\\partial \\lambda^{2}}=-\\frac{\\sum_{i=1}^{n}x_{i}}{\\lambda^{2}}  0$（对于 $\\lambda0$），这确认了该点为极大值。\n\n对于泊松分布，其方差等于其参数：$\\operatorname{Var}(X)=\\lambda$。因此，方差的最大似然估计 (MLE) 就是 $\\lambda$ 的最大似然估计：\n$$\n\\widehat{\\operatorname{Var}}(X)=\\hat{\\lambda}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n根据给定的数据 $3,5,2,4,3,4,6,3$，我们有\n$$\n\\sum_{i=1}^{8}x_{i}=3+5+2+4+3+4+6+3=30,\\quad n=8,\n$$\n所以\n$$\n\\widehat{\\operatorname{Var}}(X)=\\hat{\\lambda}=\\frac{30}{8}=\\frac{15}{4}.\n$$", "answer": "$$\\boxed{\\frac{15}{4}}$$", "id": "1917484"}, {"introduction": "从离散计数转向连续测量，这个问题挑战你寻找拉普拉斯分布尺度参数的极大似然估计量。这个源自量子光学的场景表明，即使处理包含绝对值等特征的概率密度函数，极大似然估计的基本机制依然稳健，从而在一个新的统计背景下巩固你的微积分技能。[@problem_id:1917514]", "problem": "在量子光学领域，研究人员正在开发一种先进的传感器，用于探测真空中的微小能量涨落。理论模型预测，在传感器被校准使其平均误差为零后，每次测量的误差（由随机变量 $X$ 表示）服从拉普拉斯分布。该分布的离散程度，也即传感器的精度，由一个未知的尺度参数 $b  0$ 来表征。\n\n在给定尺度参数 $b$ 的条件下，单次测量误差 $x$ 的概率密度函数 (PDF) 为：\n$$ f(x | b) = \\frac{1}{2b} \\exp\\left( -\\frac{|x|}{b} \\right), \\quad \\text{for } -\\infty  x  \\infty $$\n\n现进行一项实验，得到一个包含 $n$ 次独立测量的随机样本：$x_1, x_2, \\ldots, x_n$。你的任务是确定尺度参数 $b$ 的最大似然估计量 (MLE)。将你的答案（记作 $\\hat{b}$）表示为一个用样本大小 $n$ 和测量值 $x_i$ 表示的闭式解析表达式。", "solution": "我们有来自均值为零、尺度为 $b0$ 的拉普拉斯密度函数的独立观测值 $x_{1},\\ldots,x_{n}$：\n$$\nf(x\\mid b)=\\frac{1}{2b}\\exp\\!\\left(-\\frac{|x|}{b}\\right).\n$$\n给定样本时，$b$ 的似然函数为\n$$\nL(b)=\\prod_{i=1}^{n}\\frac{1}{2b}\\exp\\!\\left(-\\frac{|x_{i}|}{b}\\right)\n=\\left(\\frac{1}{2b}\\right)^{n}\\exp\\!\\left(-\\frac{1}{b}\\sum_{i=1}^{n}|x_{i}|\\right).\n$$\n对数似然函数为\n$$\n\\ell(b)=\\ln L(b)=-n\\ln 2 - n\\ln b - \\frac{1}{b}\\sum_{i=1}^{n}|x_{i}|.\n$$\n对 $b$ 求导并令其为零：\n$$\n\\frac{d\\ell}{db}=-\\frac{n}{b}+\\frac{1}{b^{2}}\\sum_{i=1}^{n}|x_{i}|=0.\n$$\n令 $S=\\sum_{i=1}^{n}|x_{i}|$。则得分方程变为\n$$\n-\\frac{n}{b}+\\frac{S}{b^{2}}=0 \\quad\\Longrightarrow\\quad S=nb \\quad\\Longrightarrow\\quad \\hat{b}=\\frac{S}{n}=\\frac{1}{n}\\sum_{i=1}^{n}|x_{i}|.\n$$\n为验证这是一个最大值，计算二阶导数：\n$$\n\\frac{d^{2}\\ell}{db^{2}}=\\frac{n}{b^{2}}-\\frac{2S}{b^{3}}.\n$$\n在 $b=\\hat{b}=S/n$ 处，\n$$\n\\frac{d^{2}\\ell}{db^{2}}\\bigg|_{b=\\hat{b}}=\\frac{n}{(S/n)^{2}}-\\frac{2S}{(S/n)^{3}}=\\frac{n^{3}}{S^{2}}-\\frac{2n^{3}}{S^{2}}=-\\frac{n^{3}}{S^{2}}  0\n$$\n只要 $S0$，就确认了这是一个最大值。在 $S=0$ 的退化情况下，当 $b\\to 0^{+}$ 时似然函数无界，估计量取边界值 $0$，这与 $\\hat{b}=(1/n)\\sum_{i=1}^{n}|x_{i}|$ 是一致的。\n因此，MLE 是样本绝对值的均值。", "answer": "$$\\boxed{\\frac{1}{n}\\sum_{i=1}^{n}|x_{i}|}$$", "id": "1917514"}, {"introduction": "最后的这个练习介绍了一种不同但重要的估计问题：估计一个离散参数。利用著名的“捕捉-再捕捉”方法，你将估计一个必须为整数的总种群数量。由于微分不再适用，你将学习如何使用似然比来精确定位使观测数据概率最大化的整数值。[@problem_id:1917490]", "problem": "一位野生动物生物学家正在进行一项研究，以估算一个孤立湖泊中特定鱼类的种群数量。这个实验被称为“捕获-再捕获”研究，分两个阶段进行。在第一阶段，生物学家捕捉、标记并释放了 $k$ 条鱼。在留出足够时间让被标记的鱼与整个种群充分混合后，进行第二阶段。在这一阶段，从湖中捕获一个大小为 $n$ 的鱼样本。经检查，发现其中有 $m$ 条鱼是第一阶段被标记的。\n\n我们假设湖中鱼的总数（记为 $N$）在两个阶段之间保持不变（即没有出生、死亡、迁入或迁出）。我们还假设种群中的每一条鱼在任一样本中被捕获的概率均等，并且标记不会脱落或影响鱼被再次捕获的先验概率。\n\n你的任务是找出一个关于 $N$ 值的公式，该公式使得观察到的结果（在大小为 $n$ 的第二个样本中发现 $m$ 条被标记的鱼）最有可能发生。这个值被称为 $N$ 的最大似然估计。用 $k$、$n$ 和 $m$ 将你的答案表示为单个公式。", "solution": "第二个样本中被标记的“成功”项的数量服从超几何分布，其参数为总种群大小 $N$、标记项数量 $k$、抽样大小 $n$ 以及观察到的成功次数 $m$。似然函数，视为 $N$ 的函数（其中 $k, n, m$ 固定），为\n$$\nL(N)=\\Pr(M=m\\mid N)=\\frac{\\binom{k}{m}\\binom{N-k}{\\,n-m\\,}}{\\binom{N}{n}},\n$$\n可行域为 $N\\in\\{N_{\\min},N_{\\min}+1,\\ldots\\}$，其中 $N_{\\min}=k+n-m$（因此 $0\\leq n-m\\leq N-k$）。因子 $\\binom{k}{m}$ 不依赖于 $N$，因此最大化 $L(N)$ 等价于最大化\n$$\n\\tilde{L}(N)=\\frac{\\binom{N-k}{\\,n-m\\,}}{\\binom{N}{n}}。\n$$\n\n为了找到在整数 $N\\geq N_{\\min}$ 上的最大值点，我们考虑连续似然值的比率：\n$$\nr(N)=\\frac{\\tilde{L}(N+1)}{\\tilde{L}(N)}\n=\\frac{\\binom{N+1-k}{\\,n-m\\,}}{\\binom{N-k}{\\,n-m\\,}}\\cdot\\frac{\\binom{N}{n}}{\\binom{N+1}{n}}。\n$$\n使用恒等式 $\\frac{\\binom{a+1}{b}}{\\binom{a}{b}}=\\frac{a+1}{a+1-b}$ 和 $\\frac{\\binom{A}{B}}{\\binom{A+1}{B}}=\\frac{A+1-B}{A+1}$，并令 $a=N-k$，$b=n-m$，$A=N$，$B=n$，我们得到\n$$\nr(N)=\\frac{N+1-k}{N+1-k-(n-m)}\\cdot\\frac{N+1-n}{N+1}\n=\\frac{(N+1-k)(N+1-n)}{(N+1-k-n+m)(N+1)}。\n$$\n为了确定序列 $\\tilde{L}(N)$ 在何处递增或递减，求解 $r(N)\\geq 1$：\n$$\n\\frac{(N+1-k)(N+1-n)}{(N+1-k-n+m)(N+1)}\\geq 1\n\\;\\Longleftrightarrow\\;\n(N+1-k)(N+1-n)\\geq (N+1-k-n+m)(N+1)。\n$$\n令 $X=N+1$。展开两边，\n$$\n(X-k)(X-n)\\geq (X-k-n+m)X\n\\;\\Longleftrightarrow\\;\nX^{2}-X(k+n)+kn \\geq X^{2}-X(k+n-m)。\n$$\n两边减去 $X^{2}$ 并合并同类项，得到\n$$\n-X(k+n)+kn \\geq -X(k+n-m)\n\\;\\Longleftrightarrow\\;\nkn - mX \\geq 0\n\\;\\Longleftrightarrow\\;\nX \\leq \\frac{kn}{m}。\n$$\n因此，对于 $m0$，当且仅当 $N+1\\leq \\frac{kn}{m}$ 时，有 $r(N)\\geq 1$。因此，随着 $N$ 增加，$\\tilde{L}(N)$ 是非递减的，直到满足 $N+1\\leq \\frac{kn}{m}$ 的最大 $N$ 值，此后是非递增的。因此，任何最大值点 $N^{\\ast}$ 都必须满足\n$$\nr(N^{\\ast}-1)\\geq 1\n\\quad\\text{和}\\quad\nr(N^{\\ast})\\leq 1,\n$$\n这等价于\n$$\nN^{\\ast} \\leq \\frac{kn}{m}\n\\quad\\text{和}\\quad\nN^{\\ast}+1 \\geq \\frac{kn}{m}。\n$$\n因此，当 $\\frac{kn}{m}$ 不是整数时，唯一的最大化整数是\n$$\nN^{\\ast}=\\left\\lfloor \\frac{kn}{m}\\right\\rfloor。\n$$\n当 $\\frac{kn}{m}$ 是整数时，$N^{\\ast}=\\frac{kn}{m}-1$ 和 $N^{\\ast}=\\frac{kn}{m}$ 都能达到相同的最大似然值；选择 $N^{\\ast}=\\left\\lfloor \\frac{kn}{m}\\right\\rfloor$ 是选择了一个有效的最大值点。可行性约束是自动满足的，因为\n$$\n\\frac{kn}{m}\\geq k+n-m\n\\quad\\text{因为}\\quad\nkn - m(k+n-m)=(k-m)(n-m)\\geq 0,\n$$\n所以 $\\left\\lfloor \\frac{kn}{m}\\right\\rfloor \\geq k+n-m$。\n\n如果 $m=0$，那么对于所有可行的 $N$ 都有 $r(N)\\geq 1$，所以 $\\tilde{L}(N)$ 是无界非递减的，不存在有限的最大值点（似然值随 $N$ 增加而增加）。因此，对于 $m0$，最大似然估计由下面的单一公式给出。", "answer": "$$\\boxed{\\left\\lfloor \\frac{k n}{m} \\right\\rfloor}$$", "id": "1917490"}]}