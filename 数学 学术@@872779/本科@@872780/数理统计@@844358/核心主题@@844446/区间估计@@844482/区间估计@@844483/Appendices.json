{"hands_on_practices": [{"introduction": "在许多科学研究中，一个关键的初始步骤是确定需要收集多少数据。本练习探讨了实验设计的这一基本方面。你将学习如何计算所需的最小样本量，以在给定的置信水平和精度要求下估计总体均值，从而在统计理论与实际研究规划之间建立起切实的联系。[@problem_id:1923787]", "problem": "一个材料科学研究小组正在为下一代处理器开发一种新型半导体晶圆。这些晶圆的一个关键特性是其电阻率。根据在类似制造工艺中积累的大量经验，已知电阻率测量的标准差为 $\\sigma = 0.050$ 欧姆-厘米。该团队希望通过测试晶圆样本来估计这种新材料的真实平均电阻率 $\\mu$。他们要求，一个有99%概率包含真实均值 $\\mu$ 的估计区间的总宽度不超过 $W = 0.020$ 欧姆-厘米。假设电阻率测量值呈正态分布。确定为满足此要求必须测试的最小晶圆数量。您的答案必须是整数。", "solution": "我们正在估计一个标准差 $\\sigma$ 已知的正态分布的总体均值 $\\mu$，因此基于样本量为 $n$ 的 $\\mu$ 的双侧 $(1-\\alpha)=0.99$ 置信区间的形式为\n$$\n\\bar{X} \\pm z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt{n}},\n$$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $(\\alpha/2)$ 分位数。该区间的总宽度为\n$$\nW \\;=\\; 2\\,z_{1-\\alpha/2}\\,\\frac{\\sigma}{\\sqrt{n}}.\n$$\n要求是 $W \\leq 0.020$，其中 $\\sigma = 0.050$，置信水平为 $0.99$（因此 $\\alpha = 0.01$ 且 $z_{1-\\alpha/2} = z_{0.995}$）。解不等式\n$2\\,z_{0.995}\\,\\frac{\\sigma}{\\sqrt{n}} \\leq W$\n关于 $n$ 可得\n$$\n\\sqrt{n} \\;\\geq\\; \\frac{2\\,z_{0.995}\\,\\sigma}{W}\n\\quad\\Longrightarrow\\quad\nn \\;\\geq\\; \\left(\\frac{2\\,z_{0.995}\\,\\sigma}{W}\\right)^{2}.\n$$\n代入给定值并化简，\n$$\n\\frac{\\sigma}{W} \\;=\\; \\frac{0.050}{0.020} \\;=\\; 2.5,\n\\qquad\nn \\;\\geq\\; \\left(2 \\cdot z_{0.995} \\cdot 2.5\\right)^{2}\n\\;=\\; \\left(5\\,z_{0.995}\\right)^{2}\n\\;=\\; 25\\,z_{0.995}^{2}.\n$$\n使用 $z_{0.995} \\approx 2.575829$，我们得到\n$$\nn \\;\\geq\\; 25 \\times (2.575829)^{2} \\;\\approx\\; 25 \\times 6.63489658 \\;\\approx\\; 165.8724.\n$$\n由于 $n$ 必须是整数并且必须满足宽度约束，我们取其上取整：\n$$\nn_{\\min} \\;=\\; \\lceil 165.8724 \\rceil \\;=\\; 166.\n$$", "answer": "$$\\boxed{166}$$", "id": "1923787"}, {"introduction": "置信区间带有一个宣称的“名义”置信水平，但这是否总是与实际情况相符？本练习深入探讨了常见的大样本Wald区间在小样本情景下的表现。通过计算区间包含真实参数的*实际*概率，你将更深刻地理解近似方法的局限性以及名义覆盖率与实际覆盖率之间的差异。[@problem_id:1923793]", "problem": "在统计推断中，置信区间为未知的总体参数提供了一个合理值的范围。对于一个有 $n$ 次试验且成功概率 $p$ 未知的二项试验，成功次数 $X$ 服从二项分布，即 $X \\sim \\text{Bin}(n, p)$。构建 $p$ 的置信区间的一个常用方法是瓦尔德区间，该方法基于正态近似。\n\n令 $\\hat{p} = X/n$ 为成功样本比例。则 $p$ 的 $(1-\\alpha) \\times 100\\%$ 瓦尔德置信区间由下式给出：\n$$ \\hat{p} \\pm z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n其中 $z_{\\alpha/2}$ 是标准正态分布的临界值，其上尾面积为 $\\alpha/2$。\n\n该区间的*名义覆盖水平*是 $1-\\alpha$。然而，对于有限的样本量 $n$，*实际覆盖概率*——即随机区间包含参数 $p$ 的真实概率——可能与名义水平不同。对于较小的 $n$ 尤其如此。\n\n考虑一个场景，研究人员进行了一项包含 $n=10$ 次试验的实验。他们决定为真实但未知的比例 $p$ 构建一个名义 95% 的瓦尔德置信区间。95% 置信水平的临界值是 $z_{0.025} \\approx 1.96$。\n\n假设真实的成功概率恰好是 $p=0.3$，计算该名义 95% 瓦尔德置信区间的实际覆盖概率。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $X \\sim \\text{Bin}(n,p)$，其中 $n=10$ 且 $p=0.3$。基于 $\\hat{p}=X/n$ 且 $z_{0.025}=1.96$ 的 $p$ 的瓦尔德区间是\n$$\n\\left[\\hat{p} - 1.96 \\sqrt{\\frac{\\hat{p}\\left(1-\\hat{p}\\right)}{10}},\\ \\hat{p} + 1.96 \\sqrt{\\frac{\\hat{p}\\left(1-\\hat{p}\\right)}{10}}\\right].\n$$\n对于一个实现的 $X=k$，有 $\\hat{p}=k/10$，其半宽度为\n$$\nh(k)=1.96\\sqrt{\\frac{\\left(\\frac{k}{10}\\right)\\left(1-\\frac{k}{10}\\right)}{10}} \\;=\\; 1.96 \\sqrt{\\frac{k(10-k)}{1000}}.\n$$\n该区间覆盖真实值 $p=0.3$ 当且仅当\n$$\n\\left|\\frac{k}{10}-0.3\\right| \\leq h(k).\n$$\n对 $k=0,1,\\dots,10$ 计算该式：\n- $k=0$: $h(0)=0$，区间 $[0,0]$ 不包含 $0.3$。\n- $k=1$: $h(1)=1.96\\sqrt{9/1000}\\approx 0.18594$，区间 $[-0.08594,\\,0.28594]$ 不包含 $0.3$。\n- $k=2$: $h(2)=1.96\\sqrt{16/1000}\\approx 0.24792$，区间 $[-0.04792,\\,0.44792]$ 包含 $0.3$。\n- $k=3$: $h(3)=1.96\\sqrt{21/1000}\\approx 0.28403$，区间 $[0.01597,\\,0.58403]$ 包含 $0.3$。\n- $k=4$: $h(4)=1.96\\sqrt{24/1000}\\approx 0.30364$，区间 $[0.09636,\\,0.70364]$ 包含 $0.3$。\n- $k=5$: $h(5)=1.96\\sqrt{25/1000}=1.96\\cdot 5/\\sqrt{1000}\\approx 0.30990$，区间 $[0.19010,\\,0.80990]$ 包含 $0.3$。\n- $k=6$: $h(6)=h(4)\\approx 0.30364$，区间 $[0.29636,\\,0.90364]$ 包含 $0.3$。\n- $k=7$: $h(7)=h(3)\\approx 0.28403$，区间 $[0.7-0.28403,\\,0.7+0.28403]=[0.41597,\\,0.98403]$ 不包含 $0.3$。\n- $k=8$: $h(8)=h(2)\\approx 0.24792$，区间 $[0.8-0.24792,\\,0.8+0.24792]=[0.55208,\\,1.04792]$ 不包含 $0.3$。\n- $k=9$: $h(9)=h(1)\\approx 0.18594$，区间 $[0.9-0.18594,\\,0.9+0.18594]=[0.71406,\\,1.08594]$ 不包含 $0.3$。\n- $k=10$: $h(10)=0$，区间 $[1,1]$ 不包含 $0.3$。\n\n因此，当且仅当 $k \\in \\{2,3,4,5,6\\}$ 时，区间才会覆盖真实值。实际覆盖概率为\n$$\n\\sum_{k=2}^{6} \\binom{10}{k} (0.3)^{k} (0.7)^{10-k}.\n$$\n计算每一项：\n$$\n\\begin{aligned}\n\\Pr(X=2) = \\binom{10}{2} (0.3)^{2} (0.7)^{8} = 45 \\cdot 0.09 \\cdot 0.05764801 \\approx 0.2334744405,\\\\\n\\Pr(X=3) = \\binom{10}{3} (0.3)^{3} (0.7)^{7} = 120 \\cdot 0.027 \\cdot 0.0823543 \\approx 0.2668279320,\\\\\n\\Pr(X=4) = \\binom{10}{4} (0.3)^{4} (0.7)^{6} = 210 \\cdot 0.0081 \\cdot 0.117649 \\approx 0.2001209490,\\\\\n\\Pr(X=5) = \\binom{10}{5} (0.3)^{5} (0.7)^{5} = 252 \\cdot 0.00243 \\cdot 0.16807 \\approx 0.1029193452,\\\\\n\\Pr(X=6) = \\binom{10}{6} (0.3)^{6} (0.7)^{4} = 210 \\cdot 0.000729 \\cdot 0.2401 \\approx 0.0367569090.\n\\end{aligned}\n$$\n求和，\n$$\n0.2334744405 + 0.2668279320 + 0.2001209490 + 0.1029193452 + 0.0367569090 \\approx 0.8400995757.\n$$\n四舍五入到四位有效数字，得到 $0.8401$。", "answer": "$$\\boxed{0.8401}$$", "id": "1923793"}, {"introduction": "当我们的数据不遵循像正态分布那样理想的理论分布时，我们该怎么办？本练习介绍了自助法（bootstrap），这是一种强大的计算方法，可以在没有很强分布假设的情况下构建置信区间。利用自助法模拟的输出结果，你将学习如何为中位数构建一个非参数置信区间，这对于处理偏态数据是一个至关重要的技能。[@problem_id:1923794]", "problem": "一位环境科学家正在研究某湖泊中一种持久性有机污染物的浓度。由于分析成本高昂且过程复杂，只能采集少量水样。从七个随机选择的地点采集的水样中测得的浓度（单位为百万分率，ppm）如下：\n$\\{10.4, 11.2, 10.9, 25.1, 11.5, 12.0, 10.7\\}$。\n由于存在局部污染源，该污染物浓度的总体分布未知，并被怀疑为非正态分布。为了估计真实总体中位数浓度的置信区间，采用了一种计算重抽样方法。\n\n从原始样本中，通过有放回地抽取观测值，生成了1000个大小为7的新“重抽样样本”。对这1000个重抽样样本中的每一个，都计算了其中位数浓度。然后将这1000个中位数按升序排序，形成一个中位数分布。\n\n设这1000个排序后的中位数列表表示为 $M = (m_1, m_2, \\dots, m_{1000})$。提供了此排序列表中的以下特定值：\n- 第40个中位数, $m_{40} = 10.90$\n- 第41个中位数, $m_{41} = 10.90$\n- 第960个中位数, $m_{960} = 12.00$\n- 第961个中位数, $m_{961} = 18.05$\n\n您的任务是使用百分位数法，根据这个中位数分布，为总体中位数浓度构建一个92%的置信区间。对于一个大小为$N$的数据集，其第$p$百分位数通过计算秩 $k = (p/100) \\times N$ 来找到。如果$k$是整数，则该百分位数是秩为$k$和$k+1$处值的平均值。如果$k$不是整数，则将秩向上取整到最接近的整数。\n\n请以 ppm 为单位表示您的答案，即置信区间的下限和上限。将每个界限保留三位有效数字。", "solution": "我们寻求使用排序后的自助法中位数 $M=(m_{1},\\dots,m_{1000})$ 和给定的百分位数规则，来计算总体中位数的百分位数自助法置信区间。设置信水平为 $c=0.92$；则 $\\alpha=1-c=0.08$，下百分位数和上百分位数分别为 $p_{L}=\\alpha/2=0.04$ 和 $p_{U}=1-\\alpha/2=0.96$。\n\n对于$N=1000$个中位数，第$p$百分位数的秩为 $k=(p/100)\\times N$。根据所述约定：如果$k$是整数，则百分位数为秩为$k$和$k+1$处值的平均值；否则取位于秩$k$向上取整后位置上的值。\n\n下限：\n$$\nk_{L}=0.04\\times 1000=40 \\quad\\text{(整数)},\n$$\n因此，下百分位数是 $m_{40}$ 和 $m_{41}$ 的平均值。使用给定值 $m_{40}=10.90$ 和 $m_{41}=10.90$，\n$$\n\\text{下限}=\\frac{10.90+10.90}{2}=10.90.\n$$\n保留三位有效数字，结果为 $10.9$。\n\n上限：\n$$\nk_{U}=0.96\\times 1000=960 \\quad\\text{(整数)},\n$$\n因此，上百分位数是 $m_{960}$ 和 $m_{961}$ 的平均值。使用 $m_{960}=12.00$ 和 $m_{961}=18.05$，\n$$\n\\text{上限}=\\frac{12.00+18.05}{2}=15.025.\n$$\n保留三位有效数字，结果为 $15.0$。\n\n因此，使用百分位数法，并将结果保留三位有效数字，总体中位数浓度的 $0.92$ 置信区间为 $[10.9,\\,15.0]$ ppm。", "answer": "$$\\boxed{[10.9, 15.0]}$$", "id": "1923794"}]}