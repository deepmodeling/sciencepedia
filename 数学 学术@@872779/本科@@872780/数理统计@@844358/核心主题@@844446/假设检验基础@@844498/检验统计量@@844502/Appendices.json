{"hands_on_practices": [{"introduction": "假设检验的第一步往往也是最基础的一步：将样本数据汇总成一个信息丰富的数值，即检验统计量。本练习 [@problem_id:1958165] 将在伯努利试验的背景下探讨这一基本概念。通过确定成功总数的精确概率分布，您将练习一项关键技能——将可观测的统计量与其在原假设下的理论行为联系起来，这是所有统计检验的逻辑基石。", "problem": "一家半导体制造商开发了一种在硅晶片上制造逻辑门的新蚀刻工艺。该公司的内部规格声称，此工艺生产的次品门比例恰好为 $p_0$。为验证这一说法，一位质量控制工程师计划进行一项实验。从生产线上随机抽取 $n$ 个逻辑门的样本，并对每个门进行测试。这些测试是独立的，每个门被分为“次品”或“非次品”。\n\n设 $X_i$ 为第 $i$ 个被测试门的指示随机变量，如果该门是次品，则 $X_i=1$，否则 $X_i=0$。工程师的目标是进行一个精确假设检验，检验原假设 $H_0: p = p_0$ 与双侧备择假设 $H_1: p \\neq p_0$。其中 $p$ 是次品门的真实比例。\n\n检验统计量（我们称之为 $T$）被选为样本中观察到的次品门的总数。对于一个*精确*检验，在原假设 $H_0$ 为真的前提下，以下哪个陈述正确地指出了检验统计量 $T$ 及其精确概率分布？\n\nA. 检验统计量为 $T = \\frac{\\sum_{i=1}^{n} X_i - n p_0}{\\sqrt{n p_0 (1-p_0)}}$，其在 $H_0$ 下的分布为标准正态分布 $N(0,1)$。\n\nB. 检验统计量为 $T = \\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布为参数为 $\\lambda = n p_0$ 的泊松分布。\n\nC. 检验统计量为 $T = \\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布为参数为 $n$ 和 $p_0$ 的二项分布。\n\nD. 检验统计量为 $T = \\frac{1}{n}\\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布为参数为 $p_0$ 的伯努利分布。\n\nE. 检验统计量为 $T = \\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布为参数为 $p_0$ 的几何分布。", "solution": "在原假设 $H_{0}: p = p_{0}$ 下，每个指示变量 $X_{i}$ 是一个参数为 $p_{0}$ 的伯努利随机变量，即 $\\Pr(X_{i}=1 \\mid H_{0}) = p_{0}$ 且 $\\Pr(X_{i}=0 \\mid H_{0}) = 1 - p_{0}$。题目陈述了测试是独立的，因此在 $H_{0}$ 下，$X_{1}, \\ldots, X_{n}$ 独立同分布于 $\\text{Bernoulli}(p_{0})$。\n\n所选择的检验统计量是次品的总数，\n$$\nT = \\sum_{i=1}^{n} X_{i}。\n$$\n关于独立伯努利随机变量之和的一个基本结论是，其和服从二项分布。因此，在 $H_{0}$ 下，\n$$\nT \\sim \\text{Binomial}(n, p_{0}),\n$$\n其精确的概率质量函数为\n$$\n\\Pr(T = k \\mid H_{0}) = \\binom{n}{k} p_{0}^{k} (1 - p_{0})^{n-k}, \\quad k = 0, 1, \\ldots, n.\n$$\n\n这证明了在 $H_{0}$ 下，$T$ 的精确分布是参数为 $n$ 和 $p_{0}$ 的二项分布，这与选项 C 相符。为完整起见，关于其他选项的说明如下：选项 A 将 $T$ 标准化，通过中心极限定理使用正态近似，这不是精确的；选项 B 使用泊松近似，这在 $n$ 很大且 $p_{0}$ 很小时有效，但也不是精确的；选项 D 使用样本比例，其精确分布是经过缩放的二项分布，而不是伯努利分布；选项 E 提到了几何分布，它适用于直到第一次出现次品所需的试验次数，这与所定义的 $T$ 不符。", "answer": "$$\\boxed{C}$$", "id": "1958165"}, {"introduction": "除了检验单个参数，我们常常需要评估数据是否符合某个特定的理论分布。卡方（$\\chi^2$）拟合优度检验是实现这一目标的强大工具，而本练习 [@problem_id:1958160] 提供了一次动手计算的实践机会。您将学习如何通过比较观测频数与基于泊松分布假设的期望频数来计算 $\\chi^2$ 统计量，这是从网络工程到生物学等众多领域的常见任务。", "problem": "一位热门视频流媒体服务的网络管理员正在分析高峰时段的流量模式。该管理员假设每秒到达的新用户会话请求数服从均值为 $\\lambda = 3.0$ 的泊松分布。为检验此假设，该管理员记录了在200个不同的一秒时间间隔内的请求数。观测频数总结在下表中：\n\n| 每秒请求数 | 观测频数（时间间隔数） |\n|:-----------------------------:|:----------------------------------------:|\n| 0                             | 8                                        |\n| 1                             | 32                                       |\n| 2                             | 45                                       |\n| 3                             | 50                                       |\n| 4                             | 35                                       |\n| 5                             | 20                                       |\n| 6 或更多                     | 10                                       |\n\n使用这些数据，计算卡方($\\chi^2$)拟合优度检验统计量的值，以评估管理员的假设。将你的最终答案四舍五入至三位有效数字。", "solution": "我们对 $N=200$ 个一秒时间间隔检验一个均值为 $\\lambda=3$ 的泊松模型。对于一个泊松$(\\lambda)$随机变量 $X$，其概率为 $p_k=\\Pr(X=k)=\\exp(-\\lambda)\\lambda^k/k!$。每个类别的期望频数为 $E_k=N p_k$，对于分组的尾部 $k \\ge 6$，我们使用 $p_{\\ge 6}=1-\\sum_{k=0}^{5}p_k$，且 $E_{\\ge 6}=N p_{\\ge 6}$。当 $\\lambda=3$ 时，\n$$\n\\begin{aligned}\np_0 =\\exp(-3) \\\\\np_1 =3\\exp(-3) \\\\\np_2 =\\frac{3^2}{2}\\exp(-3) \\\\\np_3 =\\frac{3^3}{3!}\\exp(-3)=p_2 \\\\\np_4 =\\frac{3}{4}p_3 \\\\\np_5 =\\frac{3}{5}p_4 \\\\\np_{\\ge 6} =1-\\sum_{k=0}^{5}p_k\n\\end{aligned}\n$$\n数值上，\n$$\n\\begin{aligned}\np_0 \\approx 0.0497871, \\quad p_1 \\approx 0.149361, \\quad p_2 \\approx 0.224042, \\quad p_3 \\approx 0.224042, \\\\\np_4 \\approx 0.168031, \\quad p_5 \\approx 0.100819, \\quad p_{\\ge 6} \\approx 0.0839179,\n\\end{aligned}\n$$\n因此\n$$\n\\begin{aligned}\nE_0 \\approx 9.95741, \\quad E_1 \\approx 29.87224, \\quad E_2 \\approx 44.80836, \\quad E_3 \\approx 44.80836, \\\\\nE_4 \\approx 33.60627, \\quad E_5 \\approx 20.16376, \\quad E_{\\ge 6} \\approx 16.78359,\n\\end{aligned}\n$$\n它们的和为 $200$，符合要求。卡方统计量为\n$$\n\\chi^{2}=\\sum_{\\text{cats}}\\frac{(O-E)^{2}}{E},\n$$\n观测计数为 $(O_0,O_1,O_2,O_3,O_4,O_5,O_{\\ge 6})=(8,32,45,50,35,20,10)$。计算每一项：\n$$\n\\begin{aligned}\n\\frac{(8-9.95741)^2}{9.95741} \\approx 0.3847 \\\\\n\\frac{(32-29.87224)^2}{29.87224} \\approx 0.1516 \\\\\n\\frac{(45-44.80836)^2}{44.80836} \\approx 0.000820 \\\\\n\\frac{(50-44.80836)^2}{44.80836} \\approx 0.6013 \\\\\n\\frac{(35-33.60627)^2}{33.60627} \\approx 0.0578 \\\\\n\\frac{(20-20.16376)^2}{20.16376} \\approx 0.00133 \\\\\n\\frac{(10-16.78359)^2}{16.78359} \\approx 2.7406\n\\end{aligned}\n$$\n求和得出\n$$\n\\chi^2 \\approx 3.93815 \\approx 3.94\n$$\n四舍五入到三位有效数字后为 $3.94$。", "answer": "$$\\boxed{3.94}$$", "id": "1958160"}, {"introduction": "一位熟练的数据分析师不仅应懂得如何计算检验统计量，更要理解它如何响应数据的不同特征。本练习 [@problem_id:1954966] 通过考察夏皮罗-威尔克（Shapiro-Wilk）正态性检验对极端异常值存在的敏感性，深入探讨了这一关键问题。通过思考这个假设性场景，您将培养关于数据质量如何影响统计推断的批判性直觉，这是进行稳健可靠分析的必备技能。", "problem": "一位数据分析师正在处理一个包含15个测量值的小数据集，这些测量值被认为是从一个正态分布的总体中抽样得到的。为了验证这一假设，该分析师进行了一项Shapiro-Wilk检验。该检验是一种用于检验正态性的正式统计检验，其原假设是样本数据来自一个正态分布的总体。检验统计量，记为 $W$，其取值范围在0到1之间。$W$ 的值接近1表示支持原假设（即表明数据具有正态性），而接近0的值则提供了反对原假设的证据。\n\n最初，该数据集似乎很好地符合正态性。在复查时，该分析师发现了一个数据录入错误。其中一个接近样本均值的测量值被修正了。修正后的值是一个极端离群值，远离其他14个数据点。分析师对这个包含离群值的新修正数据集重新运行了Shapiro-Wilk检验。\n\n与初始的、表现良好的数据集相比，这个单一极端离群值的存在最有可能如何影响Shapiro-Wilk检验统计量 $W$ 及其对应的p值？\n\nA. 统计量 $W$ 和p值都会增加。\n\nB. 统计量 $W$ 会增加，而p值会减小。\n\nC. 统计量 $W$ 会减小，而p值会增加。\n\nD. 统计量 $W$ 和p值都会减小。", "solution": "Shapiro-Wilk检验使用统计量 $W$ 来评估正态性。对于一个大小为 $n$、顺序统计量为 $x_{(1)} \\le \\cdots \\le x_{(n)}$ 的样本， $W$ 的定义如下：\n$$\nW = \\frac{\\left(\\sum_{i=1}^{m} a_{i}\\,\\big(x_{(n+1-i)} - x_{(i)}\\big)\\right)^{2}}{\\sum_{i=1}^{n} \\big(x_{i} - \\bar{x}\\big)^{2}}, \\quad m = \\left\\lfloor \\frac{n}{2} \\right\\rfloor,\n$$\n其中常数 $a_{i}$ 仅取决于 $n$ 和标准正态样本的期望顺序统计量。在 $H_{0}$（正态性）假设下，$W$ 的值趋向于接近1；较小的 $W$ 值表示偏离了正态性。$p$ 值为 $p = \\mathbb{P}\\!\\left(W \\le w_{\\text{obs}} \\mid H_{0}\\right)$，它是 $w_{\\text{obs}}$ 的一个递减函数。\n\n考虑将一个接近均值的观测值替换为一个极端离群值所产生的影响。假设修正后的最大观测值为 $x_{(n)}$，其数值非常大，而其余的 $n-1$ 个观测值保持在其原始值附近。分析分子和分母：\n\n1) 对分母的影响：\n$$\nS^{2} = \\sum_{i=1}^{n} \\big(x_{i} - \\bar{x}\\big)^{2}.\n$$\n当存在一个极端离群值时，样本均值 $\\bar{x}$ 的移动量级为 $\\frac{x_{(n)}}{n}$，而项 $\\big(x_{(n)} - \\bar{x}\\big)^{2}$ 在总和中占主导地位，因此 $S^{2}$ 的增长量级与 $\\big(x_{(n)} - \\bar{x}\\big)^{2}$ 相同，这是一个很大的值。\n\n2) 对分子的影响：\n$$\nN = \\sum_{i=1}^{m} a_{i}\\,\\big(x_{(n+1-i)} - x_{(i)}\\big).\n$$\n只有 $i=1$ 的项包含 $x_{(n)}$；所有其他项都涉及未受影响的顺序统计量，因此保持有界。因此，\n$$\nN = a_{1}\\big(x_{(n)} - x_{(1)}\\big) + C,\n$$\n其中 $C$ 相对于 $x_{(n)}$ 是有界的。因此 $N$ 最多随 $x_{(n)}$ 线性增长，而 $N^{2}$ 的增长量级为 $x_{(n)}^{2}$。\n\n3) 对 $W$ 的综合影响：\n$$\nW = \\frac{N^{2}}{S^{2}} \\approx \\frac{a_{1}^{2}\\,x_{(n)}^{2}}{\\big(x_{(n)} - \\bar{x}\\big)^{2}} \\to a_{1}^{2},\n$$\n当 $|x_{(n)}|$ 变得非常大时，其中 $0  a_{1}^{2}  1$。由于对于一个表现良好的类正态样本，$W$ 通常接近1，引入一个极端离群值将使 $W$ 从接近1的数值显著减小，趋向于一个由 $a_{1}$ 决定的较小常数，即 $W$ 减小。\n\n因为 $p$ 值为 $p = \\mathbb{P}\\!\\left(W \\le w_{\\text{obs}} \\mid H_{0}\\right)$，并且是 $w_{\\text{obs}}$ 的单调递减函数，所以 $W$ 的减小也会导致 $p$ 值的减小。因此，与初始的、表现良好的数据集相比，单个极端离群值的存在会使 $W$ 及其对应的 $p$ 值都变小。\n\n所以，$W$ 及其 $p$ 值都会减小。", "answer": "$$\\boxed{D}$$", "id": "1954966"}]}