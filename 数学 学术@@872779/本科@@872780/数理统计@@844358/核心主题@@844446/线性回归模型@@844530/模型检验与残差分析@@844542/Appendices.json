{"hands_on_practices": [{"introduction": "模型诊断的第一步通常是视觉检查，而残差图是最有力的工具之一。本练习强调了一个关键点：即使决定系数 $R^2$ 很高，也不能保证模型是合适的。通过分析一个具有明显U形模式的残差图，你将学会识别线性模型何时无法捕捉数据中潜在的非线性关系，这对于避免错误的结论至关重要。[@problem_id:1936332]", "problem": "一位材料科学家正在研究一种新型电池的工作温度与其有效寿命之间的关系。他们收集了 50 个电池的数据，记录了恒定的工作温度（$x$，单位为摄氏度）和寿命（$y$，单位为千小时）。\n\n该科学家进行了一项简单线性回归分析，并获得了以下拟合回归线：\n$$ \\hat{y} = 45.2 - 0.3x $$\n该模型的决定系数计算得出为 $R^2 = 0.85$。\n\n在检查诊断图时，该科学家观察到残差与拟合值（$\\hat{y}$）的散点图。该残差图上的点并非随机散布在零水平线周围。相反，它们形成了一个清晰、独特的 U 形（抛物线）模式，对于中间的拟合值，残差为负，而对于较低和较高的拟合值，残差为正。\n\n根据这些信息，以下哪个结论最准确？\n\nA. 高达 0.85 的 $R^2$ 值表明线性模型非常适合该数据，而残差中的模式可以忽略，因为它可能是由少数异常值引起的。\n\nB. 残差图中的清晰模式表明模型存在根本性问题，因此高 $R^2$ 值必定是计算错误的结果。\n\nC. 模型解释了寿命中很大一部分的方差，但残差中的 U 形模式表明温度和寿命之间的潜在关系是非线性的，这使得简单线性模型不适用。\n\nD. 残差图中的 U 形模式是多重共线性的典型标志，这意味着预测变量与其他未观测到的变量相关。\n\nE. 残差图中的 U 形模式表明误差的方差不恒定（异方差性），应使用对数对数据进行变换。", "solution": "在简单线性回归中，假定的模型是 $y=\\beta_{0}+\\beta_{1}x+\\varepsilon$，其标准假设为 $E[\\varepsilon \\mid x]=0$ 和 $\\operatorname{Var}(\\varepsilon \\mid x)=\\sigma^{2}$，并且条件均值 $E[y \\mid x]$ 是 $x$ 的线性函数。拟合值为 $\\hat{y}_{i}=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x_{i}$，残差为 $e_{i}=y_{i}-\\hat{y}_{i}$。如果模型设定正确，一幅 $e_{i}$ 对 $\\hat{y}_{i}$ 的图应该不显示任何系统性模式；具体来说，我们期望在整个拟合值范围内，$E[e \\mid \\hat{y}]=0$。\n\n残差对拟合值图中清晰的 U 形（抛物线）模式表明 $E[e \\mid \\hat{y}]$ 并非一致为零，而是随 $\\hat{y}$ 系统性地变化，这是均值结构设定错误的诊断特征，通常意味着 $y$ 和 $x$ 之间存在非线性关系。一个常见的原因是真实关系包含曲率，例如 $E[y \\mid x]=\\beta_{0}+\\beta_{1}x+\\beta_{2}x^{2}$ 且 $\\beta_{2}\\neq 0$。如果只拟合线性项，被忽略的曲率会表现为残差中的 U 形模式。\n\n决定系数 $R^{2}$ 衡量了由拟合的线性函数解释的方差比例，即使函数形式不正确，它也可能很大；因此，高 $R^{2}$ 值并不能验证线性假设或模型的充分性。因此，陈述 A 是不正确的。\n\n没有理由从残差中存在曲率就推断 $R^{2}$ 的计算有误；高 $R^{2}$ 和设定错误的均值函数可以并存。因此，陈述 B 是不正确的。\n\n多重共线性涉及多个预测变量之间的相关性，不适用于只有一个预测变量的简单线性回归。U 形残差模式不是多重共线性的标志。因此，陈述 D 是不正确的。\n\n异方差性指的是 $\\operatorname{Var}(\\varepsilon \\mid x)$ 随 $x$ 变化，并且在残差图中通常表现为漏斗形或扇形散布，而不是形成 U 形的系统性符号变化。虽然变换有时可以同时解决非线性和异方差性问题，但此处的主要诊断特征是均值中的非线性，而不是非恒定方差。因此，陈述 E 不是最准确的解释。\n\n因此，正确的结论是模型解释了很大一部分方差，但违反了线性假设；一个非线性模型（例如，包含 $x^{2}$ 或其他适当的变换）更为合适。", "answer": "$$\\boxed{C}$$", "id": "1936332"}, {"introduction": "在处理按时间顺序收集的数据时，误差项的独立性假设常常被违反，出现所谓的“自相关”。德宾-瓦特森（Durbin-Watson）检验是检测一阶自相关性的标准工具。本练习将要求你解释一个在实际应用中可能遇到的德宾-瓦特森统计量值，从而加深对如何诊断模型中残差序列相关性的理解。[@problem_id:1936355]", "problem": "一位运营分析师的任务是为一个公司的月度小部件生产量建模。他们提出了一个简单线性回归模型，根据上个月的原材料库存 $I_{t-1}$ 来预测当月的生产量 $P_t$。该模型形式为 $P_t = \\beta_0 + \\beta_1 I_{t-1} + \\epsilon_t$，其中 $t$ 是月份的索引，$\\epsilon_t$ 代表误差项。在对连续60个月的数据进行模型拟合后，该分析师检查了残差 $e_t$ 的性质，以评估模型的有效性。他们计算了残差序列的 Durbin-Watson 统计量，并得到了一个值为 $3.96$。\n\n基于这个结果，关于模型的误差项，以下哪个结论最有可能？\n\nA. 误差项表现出强正一阶自相关。\n\nB. 误差项不存在自相关。\n\nC. 模型在预测变量之间存在显著的多重共线性。\n\nD. 误差项表现出强负一阶自相关。\n\nE. 误差项的方差不恒定（异方差性）。", "solution": "我们从给定的月度生产线性回归模型开始：\n$$\nP_{t}=\\beta_{0}+\\beta_{1} I_{t-1}+\\epsilon_{t},\n$$\n其中 $t$ 是以月为单位的时间索引，$\\epsilon_{t}$ 是误差项。令 $e_{t}$ 表示对 $n=60$ 个月的数据进行模型拟合得到的 OLS 残差。\n\n为了评估残差中的一阶自相关，Durbin-Watson 统计量计算如下\n$$\nd=\\frac{\\sum_{t=2}^{n}\\left(e_{t}-e_{t-1}\\right)^{2}}{\\sum_{t=1}^{n} e_{t}^{2}}.\n$$\n其取值范围是 $0 \\leq d \\leq 4$，并有以下解释：\n- $d \\approx 2$ 表明没有一阶自相关。\n- $d  2$ 表明存在正一阶自相关，其中 $d$ 接近 $0$ 表示强正自相关。\n- $d > 2$ 表明存在负一阶自相关，其中 $d$ 接近 $4$ 表示强负自相关。\n\n在 $d$ 和残差的一阶自相关系数 $\\rho_{1}$ 之间也存在一个近似关系：\n$$\nd \\approx 2\\left(1-\\rho_{1}\\right).\n$$\n求解 $\\rho_{1}$ 可得\n$$\n\\rho_{1} \\approx 1-\\frac{d}{2}.\n$$\n根据报告的值 $d=3.96$，\n$$\n\\rho_{1} \\approx 1-\\frac{3.96}{2}=1-1.98=-0.98,\n$$\n这表明存在非常强的负一阶自相关。\n\n因此，最可能的结论是误差项表现出强负一阶自相关。\n\n为了排除其他选项：\n- 强正自相关对应的 $d$ 值应接近 $0$，而不是 $3.96$，因此 A 不一致。\n- 无自相关对应的 $d$ 值应接近 $2$，而不是 $3.96$，因此 B 不一致。\n- Durbin-Watson 统计量不用于检验预测变量间的多重共线性，因此 C 在此是无关的。\n- Durbin-Watson 统计量检测的是序列相关性，而不是异方差性，因此 E 是无关的。\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "1936355"}, {"introduction": "并非所有数据点对回归模型的影响都相同；有些点被称为“影响点”，它们能显著改变模型的系数。库克距离（Cook's Distance）是量化这种影响的关键指标，它巧妙地结合了数据点的杠杆率（leverage）和残差大小。通过亲手计算一个高杠杆点的库克距离，你将具体理解一个数据点的位置（$x$ 值）如何放大其对整个模型拟合结果的影响力。[@problem_id:1936315]", "problem": "一位材料科学家正在研究一种新的化学气相沉积工艺，用于制造超薄半导体薄膜。假设薄膜的厚度 $Y$（单位为纳米，nm）与沉积持续时间 $X$（单位为秒，s）之间存在线性关系。一个形式为 $Y_i = \\beta_0 + \\beta_1 X_i + \\epsilon_i$ 的简单线性回归模型被拟合到来自 $n=30$ 次实验运行的数据上。该模型有 $p=2$ 个估计参数（截距 $\\beta_0$ 和斜率 $\\beta_1$）。\n\n对所有30个数据点进行回归分析，得到以下汇总统计量：\n- 平均沉积持续时间为 $\\bar{x} = 55.0$ s。\n- 沉积持续时间的离差平方和为 $\\sum_{j=1}^{30} (x_j - \\bar{x})^2 = 25000$ s$^2$。\n- 模型的均方误差 (MSE) 为 $\\hat{\\sigma}^2 = 40.0$ nm$^2$。\n\n这位科学家对某一次特定的实验运行，即第 $k$ 个观测值，特别感兴趣，该实验是在非同寻常的条件下进行的。对于这个数据点：\n- 沉积持续时间为 $x_k = 155.0$ s。\n- 原始残差（观测厚度与预测厚度之差）为 $e_k = y_k - \\hat{y}_k = 5.0$ nm。\n\n为了评估这单个观测值对整体回归模型的影响，要求您计算其库克距离 $D_k$。所需公式如下：\n- 第 $i$ 个观测值的杠杆值 $h_{ii}$ 由 $h_{ii} = \\frac{1}{n} + \\frac{(x_i - \\bar{x})^2}{\\sum_{j=1}^n (x_j - \\bar{x})^2}$ 给出。\n- 第 $i$ 个观测值的内部学生化残差 $r_i$ 由 $r_i = \\frac{e_i}{\\hat{\\sigma}\\sqrt{1-h_{ii}}}$ 给出。\n- 第 $i$ 个观测值的库克距离 $D_i$ 与这些量相关，关系式为 $D_i = \\frac{r_i^2}{p} \\frac{h_{ii}}{1-h_{ii}}$。\n\n计算这次特定实验运行的库克距离 $D_k$ 的值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们给定一个具有 $n=30$ 个观测值和 $p=2$ 个参数的简单线性回归。对于第 $k$ 个观测值，我们使用提供的公式计算其杠杆值、内部学生化残差，然后计算库克距离。\n\n首先，计算杠杆值 $h_{kk}$：\n$$\nh_{kk} = \\frac{1}{n} + \\frac{(x_{k} - \\bar{x})^{2}}{\\sum_{j=1}^{n} (x_{j} - \\bar{x})^{2}} = \\frac{1}{30} + \\frac{(155.0 - 55.0)^{2}}{25000} = \\frac{1}{30} + \\frac{10000}{25000} = \\frac{1}{30} + \\frac{2}{5} = \\frac{13}{30}.\n$$\n\n接下来，均方误差为 $\\hat{\\sigma}^{2} = 40.0$，所以 $\\hat{\\sigma} = \\sqrt{40}$。内部学生化残差为\n$$\nr_{k} = \\frac{e_{k}}{\\hat{\\sigma}\\sqrt{1 - h_{kk}}} = \\frac{5.0}{\\sqrt{40}\\sqrt{1 - \\frac{13}{30}}} = \\frac{5.0}{\\sqrt{40}\\sqrt{\\frac{17}{30}}}.\n$$\n计算 $r_{k}^{2}$ 会很方便：\n$$\nr_{k}^{2} = \\frac{e_{k}^{2}}{\\hat{\\sigma}^{2}(1 - h_{kk})} = \\frac{25}{40 \\cdot \\frac{17}{30}} = \\frac{25 \\cdot 30}{40 \\cdot 17} = \\frac{75}{68}.\n$$\n\n现在计算因子 $\\frac{h_{kk}}{1 - h_{kk}}$：\n$$\n\\frac{h_{kk}}{1 - h_{kk}} = \\frac{\\frac{13}{30}}{\\frac{17}{30}} = \\frac{13}{17}.\n$$\n\n此观测值的库克距离为\n$$\nD_{k} = \\frac{r_{k}^{2}}{p}\\cdot \\frac{h_{kk}}{1 - h_{kk}} = \\frac{\\frac{75}{68}}{2} \\cdot \\frac{13}{17} = \\frac{75}{136} \\cdot \\frac{13}{17} = \\frac{975}{2312}.\n$$\n数值上，$\\frac{975}{2312} \\approx 0.4217\\ldots$，四舍五入到三位有效数字为 $0.422$。", "answer": "$$\\boxed{0.422}$$", "id": "1936315"}]}