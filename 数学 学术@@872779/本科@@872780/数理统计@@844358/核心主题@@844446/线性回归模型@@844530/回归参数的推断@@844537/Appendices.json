{"hands_on_practices": [{"introduction": "在回归分析中，首要任务是判断变量之间是否存在真实且有意义的关系。本练习将引导你完成一个基础的假设检验，即检验斜率参数的显著性，这是验证任何线性模型的基石。通过利用摘要数据计算t统计量，你将亲身实践如何量化评估一个自变量是否对因变量产生统计上显著的影响 [@problem_id:1923256]。", "problem": "一个农业研究所正在研究一种新型生物刺激素对藜麦产量的影响。在一项对照实验中，对 $n=20$ 块相同的土地施用了不同量的生物刺激素。提出了一个简单线性回归模型 $Y = \\beta_0 + \\beta_1 x + \\epsilon$，用来关联藜麦产量 $Y$（单位：公斤/公顷）与所施用的生物刺激素的量 $x$（单位：升/公顷）。随机误差 $\\epsilon$ 被假定为独立同分布，服从均值为0、方差为常数 $\\sigma^2$ 的正态分布。\n\n研究人员想要确定是否有证据表明生物刺激素对产量有积极影响。为此，他们将对回归线的斜率进行假设检验。\n\n根据实验数据，计算出以下汇总统计量：\n- $\\sum_{i=1}^{20} x_i = 100$\n- $\\sum_{i=1}^{20} y_i = 35000$\n- $\\sum_{i=1}^{20} x_i^2 = 620$\n- $\\sum_{i=1}^{20} y_i^2 = 61850000$\n- $\\sum_{i=1}^{20} x_i y_i = 181000$\n\n计算用于检验原假设 $H_0: \\beta_1 = 0$ 与备择假设 $H_a: \\beta_1 > 0$ 的检验统计量的值。将最终答案四舍五入至三位有效数字。", "solution": "我们使用 $t$-统计量来检验 $H_{0}: \\beta_{1}=0$ 与 $H_{a}: \\beta_{1}>0$\n$$\nt=\\frac{\\hat{\\beta}_{1}-0}{\\operatorname{SE}(\\hat{\\beta}_{1})}, \\quad \\operatorname{SE}(\\hat{\\beta}_{1})=\\sqrt{\\frac{\\hat{\\sigma}^{2}}{S_{xx}}}, \\quad \\hat{\\sigma}^{2}=\\frac{\\text{SSE}}{n-2}.\n$$\n对于简单线性回归，\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}}, \\quad S_{xx}=\\sum x_{i}^{2}-\\frac{\\left(\\sum x_{i}\\right)^{2}}{n}, \\quad S_{yy}=\\sum y_{i}^{2}-\\frac{\\left(\\sum y_{i}\\right)^{2}}{n}, \\quad S_{xy}=\\sum x_{i}y_{i}-\\frac{\\left(\\sum x_{i}\\right)\\left(\\sum y_{i}\\right)}{n}.\n$$\n给定 $n=20$，$\\sum x_{i}=100$，$\\sum y_{i}=35000$，$\\sum x_{i}^{2}=620$，$\\sum y_{i}^{2}=61850000$，$\\sum x_{i}y_{i}=181000$，计算\n$$\nS_{xx}=620-\\frac{100^{2}}{20}=620-500=120,\n$$\n$$\nS_{yy}=61850000-\\frac{35000^{2}}{20}=61850000-61250000=600000,\n$$\n$$\nS_{xy}=181000-\\frac{(100)(35000)}{20}=181000-175000=6000.\n$$\n那么\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}}=\\frac{6000}{120}=50.\n$$\n误差平方和为\n$$\n\\text{SSE}=S_{yy}-\\hat{\\beta}_{1}S_{xy}=600000-(50)(6000)=300000,\n$$\n所以\n$$\n\\hat{\\sigma}^{2}=\\frac{\\text{SSE}}{n-2}=\\frac{300000}{18}=\\frac{50000}{3}.\n$$\n$\\hat{\\beta}_{1}$ 的标准误是\n$$\n\\operatorname{SE}(\\hat{\\beta}_{1})=\\sqrt{\\frac{\\hat{\\sigma}^{2}}{S_{xx}}}=\\sqrt{\\frac{50000/3}{120}}=\\sqrt{\\frac{1250}{9}}.\n$$\n因此，检验统计量为\n$$\nt=\\frac{\\hat{\\beta}_{1}}{\\operatorname{SE}(\\hat{\\beta}_{1})} = \\frac{50}{\\sqrt{1250/9}} = \\frac{50 \\times 3}{\\sqrt{1250}} = \\frac{150}{25\\sqrt{2}} = \\frac{6}{\\sqrt{2}} = 3\\sqrt{2}\\approx 4.24.\n$$\n自由度为 $n-2=18$，并且由于 $\\hat{\\beta}_{1}>0$，单侧检验统计量为 $t=3\\sqrt{2}$。", "answer": "$$\\boxed{4.24}$$", "id": "1923256"}, {"introduction": "一旦确认变量间存在显著关系，我们便可以利用回归模型进行估计和预测。本练习着重于为特定预测变量值构建均值响应的置信区间，这是将模型应用于实际决策的关键一步。掌握此方法可以让我们量化模型预测的平均结果的不确定性，从而做出更可靠的推断 [@problem_id:1923200]。", "problem": "一所大学的数据科学团队正在分析一个新的在线辅导平台的使用情况与学生在一门具有挑战性的物理入门课程中的表现之间的关系。他们从一个由25名学生组成的随机样本中收集数据。设 $Y$ 为课程的最终成绩（满分为100分的数值分数），设 $X$ 为学生每周使用该辅导平台的平均小时数。\n\n该团队拟合了一个形式为 $Y_i = \\beta_0 + \\beta_1 X_i + \\epsilon_i$ 的简单线性回归模型，其中误差 $\\epsilon_i$ 假定为相互独立且服从均值为0、方差为常数 $\\sigma^2$ 的正态分布。\n\n从这25名学生的样本中，分析得出以下汇总统计数据：\n- 估计的截距：$\\hat{\\beta}_0 = 63.0$\n- 估计的斜率：$\\hat{\\beta}_1 = 3.0$\n- 每周小时数的样本均值：$\\bar{x} = 4.0$ 小时\n- 每周小时数的离差平方和：$S_{xx} = \\sum_{i=1}^{25} (x_i - \\bar{x})^2 = 100.0 \\text{ hours}^2$\n- 回归标准误：$s_e = 5.0$ 分\n\n利用这些信息，为每周在该平台上花费恰好 $x_0 = 5.0$ 小时的所有学生的子群体的真实平均最终成绩构建一个95%的置信区间。此计算所需的t分布临界值为 $t_{0.025, 23} = 2.069$。\n\n按顺序提供置信区间的下限和上限。将您的最终答案四舍五入到四位有效数字。", "solution": "我们拟合简单线性回归模型 $Y_{i}=\\beta_{0}+\\beta_{1}X_{i}+\\epsilon_{i}$，其中 $\\epsilon_{i}\\sim \\mathcal{N}(0,\\sigma^{2})$ 相互独立。在 $x_{0}$ 处的平均响应为 $\\mu_{Y|X=x_{0}}=\\beta_{0}+\\beta_{1}x_{0}$，其估计值为 $\\hat{Y}(x_{0})=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x_{0}$。对于 $x_{0}=5.0$，点估计为\n$$\n\\hat{Y}(5)=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}\\cdot 5=63.0+3.0\\cdot 5=78.0.\n$$\n在 $x_{0}$ 处估计的平均响应的标准误为\n$$\n\\operatorname{SE}\\big(\\hat{Y}(x_{0})\\big)=s_{e}\\sqrt{\\frac{1}{n}+\\frac{(x_{0}-\\bar{x})^{2}}{S_{xx}}},\n$$\n其中 $n=25$，$\\bar{x}=4.0$，$S_{xx}=100.0$，$s_{e}=5.0$。将这些值代入 $x_{0}=5.0$ 的情况，得到\n$$\n\\operatorname{SE}\\big(\\hat{Y}(5)\\big)=5.0\\sqrt{\\frac{1}{25}+\\frac{(5.0-4.0)^{2}}{100.0}}=5.0\\sqrt{0.04+0.01}=5.0\\sqrt{0.05}=\\frac{\\sqrt{5}}{2}.\n$$\n在 $x_{0}$ 处平均响应的双侧 $95\\%$ 置信区间为\n$$\n\\hat{Y}(x_{0})\\pm t_{0.025,\\,n-2}\\,\\operatorname{SE}\\big(\\hat{Y}(x_{0})\\big),\n$$\n其中 $t_{0.025,\\,23}=2.069$。因此，\n$$\n78.0\\pm 2.069\\cdot \\frac{\\sqrt{5}}{2}.\n$$\n计算边际误差，\n$$\n2.069\\cdot \\frac{\\sqrt{5}}{2}\\approx 2.3132123227,\n$$\n因此区间近似为\n$$\n[78.0-2.3132123227,\\;78.0+2.3132123227]=[75.6867876773,\\;80.3132123227].\n$$\n四舍五入到四位有效数字，得到下限和上限分别为 $75.69$ 和 $80.31$。", "answer": "$$\\boxed{\\begin{pmatrix} 75.69  80.31 \\end{pmatrix}}$$", "id": "1923200"}, {"introduction": "一个出色的统计分析师不仅要掌握计算方法，更要深刻理解模型结果对数据点的敏感性。此练习是一个思想实验，旨在挑战你分析一个具有高杠杆率的特殊数据点如何影响斜率的t统计量。通过逻辑推演t统计量各个组成部分的变化，你将对“影响点”如何塑造我们的统计结论建立起更深刻的直觉 [@problem_id:1923258]。", "problem": "在统计建模的背景下，一位分析师正在研究影响点对简单线性回归（SLR）模型的影响。最初的分析基于一个包含 $n$ 个观测值 $(x_i, y_i)$（$i=1, \\dots, n$，$n \\geq 4$）的数据集。SLR模型由 $Y = \\beta_0 + \\beta_1 X + \\epsilon$ 给出，其中误差 $\\epsilon_i$ 假定为独立同分布，其均值为0，方差为 $\\sigma^2$。\n\n从这个初始数据集中，计算出截距和斜率的普通最小二乘估计值分别为 $\\hat{\\beta}_{0,n}$ 和 $\\hat{\\beta}_{1,n}$。用于检验原假设 $H_0: \\beta_1 = 0$ 的相关t统计量记为 $t_n$。您应假设初始斜率估计值 $\\hat{\\beta}_{1,n}$ 和初始残差平方和（$SSE_n$）均为非零。\n\n现在，一个新数据点 $(x_{n+1}, y_{n+1})$ 被添加到数据集中。这个新点具有以下两个特性：\n1.  它具有极高的杠杆值，意味着其预测变量值 $x_{n+1}$ 远离开原始预测变量的均值 $\\bar{x}_n = \\frac{1}{n}\\sum_{i=1}^n x_i$。\n2.  它相对于原始回归线的残差为零。也就是说，该点恰好落在由初始估计值定义的直线上：$y_{n+1} = \\hat{\\beta}_{0,n} + \\hat{\\beta}_{1,n} x_{n+1}$。\n\n添加这个第 $(n+1)$ 个点后，对包含 $n+1$ 个点的完整数据集拟合一个新的SLR模型，并计算出用于检验 $H_0: \\beta_1 = 0$ 的新t统计量，记为 $t_{n+1}$。下列哪个陈述正确描述了 $t_{n+1}$ 和 $t_n$ 之间的关系？\n\nA. t统计量保持完全相同 ($t_{n+1} = t_n$)。\nB. t统计量的绝对值减小 ($|t_{n+1}|  |t_n|$)。\nC. t统计量的绝对值增大 ($|t_{n+1}| > |t_n|$)。\nD. t统计量变为零 ($t_{n+1} = 0$)。\nE. 如果没有关于原始数据集的更具体信息，无法确定t统计量的变化。", "solution": "设对前 $n$ 个观测值的初始普通最小二乘（OLS）拟合得到 $(\\hat{\\beta}_{0,n},\\hat{\\beta}_{1,n})$，其中 $\\hat{\\beta}_{1,n}$ 非零且 $SSE_n0$。用于检验 $H_{0}:\\beta_{1}=0$ 的标准t统计量为\n$$\nt_{n}=\\frac{\\hat{\\beta}_{1,n}}{\\operatorname{SE}(\\hat{\\beta}_{1,n})}=\\frac{\\hat{\\beta}_{1,n}}{\\sqrt{\\widehat{\\sigma}_{n}^{2}/S_{xx,n}}},\n$$\n其中\n$$\n\\widehat{\\sigma}_{n}^{2}=\\frac{SSE_{n}}{n-2},\\qquad S_{xx,n}=\\sum_{i=1}^{n}(x_{i}-\\bar{x}_{n})^{2},\\qquad \\bar{x}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n\n现在加入点 $(x_{n+1},y_{n+1})$，满足 $y_{n+1}=\\hat{\\beta}_{0,n}+\\hat{\\beta}_{1,n}x_{n+1}$ 且 $x_{n+1}$ 远离 $\\bar{x}_{n}$。将对全部 $n+1$ 个点的OLS拟合结果记为 $(\\hat{\\beta}_{0,n+1},\\hat{\\beta}_{1,n+1})$。\n\n首先，SLR的OLS正规方程组在解处意味着 $\\sum_{i} e_{i}=0$ 和 $\\sum_{i} x_{i}e_{i}=0$，其中 $e_{i}=y_{i}-(\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x_{i})$。在原始估计下，前 $n$ 个点的残差满足\n$$\n\\sum_{i=1}^{n} e_{i,n}=0,\\qquad \\sum_{i=1}^{n} x_{i} e_{i,n}=0,\n$$\n并且新点的残差根据构造为 $e_{n+1}=y_{n+1}-(\\hat{\\beta}_{0,n}+\\hat{\\beta}_{1,n}x_{n+1})=0$。因此，同样的 $(\\hat{\\beta}_{0,n},\\hat{\\beta}_{1,n})$ 也满足包含 $n+1$ 个点的问题的正规方程组：\n$$\n\\sum_{i=1}^{n+1} e_{i}=0,\\qquad \\sum_{i=1}^{n+1} x_{i} e_{i}=0.\n$$\n因为设计矩阵是满秩的（$x_i$ 不全相等且 $n\\geq 4$），所以OLS解是唯一的，因此\n$$\n\\hat{\\beta}_{1,n+1}=\\hat{\\beta}_{1,n},\\qquad \\hat{\\beta}_{0,n+1}=\\hat{\\beta}_{0,n}.\n$$\n\n第二，加入新点后的残差平方和是\n$$\nSSE_{n+1}=\\sum_{i=1}^{n} e_{i,n}^{2}+e_{n+1}^{2}=SSE_{n}+0=SSE_{n}.\n$$\n因此，均方误差减小，因为自由度增加了：\n$$\n\\widehat{\\sigma}_{n+1}^{2}=\\frac{SSE_{n+1}}{(n+1)-2}=\\frac{SSE_{n}}{n-1},\\qquad \\frac{\\widehat{\\sigma}_{n}^{2}}{\\widehat{\\sigma}_{n+1}^{2}}=\\frac{n-1}{n-2}1.\n$$\n\n第三，记\n$$\n\\bar{x}_{n+1}=\\frac{n\\bar{x}_{n}+x_{n+1}}{n+1},\\qquad S_{xx,n+1}=\\sum_{i=1}^{n+1}(x_{i}-\\bar{x}_{n+1})^{2}.\n$$\n直接的代数更新可得\n$$\nS_{xx,n+1}=S_{xx,n}+\\frac{n}{n+1}\\bigl(x_{n+1}-\\bar{x}_{n}\\bigr)^{2}.\n$$\n为验证此式，写出\n$$\nS_{xx,n+1}=\\sum_{i=1}^{n}(x_{i}-\\bar{x}_{n+1})^{2}+(x_{n+1}-\\bar{x}_{n+1})^{2}\n$$\n并使用 $\\sum_{i=1}^{n}(x_{i}-\\bar{x}_{n})=0$ 和 $\\bar{x}_{n+1}-\\bar{x}_{n}=(x_{n+1}-\\bar{x}_{n})/(n+1)$ 展开得到\n$$\n\\sum_{i=1}^{n}(x_{i}-\\bar{x}_{n+1})^{2}=S_{xx,n}+n(\\bar{x}_{n}-\\bar{x}_{n+1})^{2}=S_{xx,n}+\\frac{n}{(n+1)^{2}}(x_{n+1}-\\bar{x}_{n})^{2},\n$$\n$$\n(x_{n+1}-\\bar{x}_{n+1})^{2}=\\frac{n^{2}}{(n+1)^{2}}(x_{n+1}-\\bar{x}_{n})^{2},\n$$\n它们相加得到 $S_{xx,n}+\\frac{n}{n+1}(x_{n+1}-\\bar{x}_{n})^{2}$。由于 $x_{n+1}$ 远离 $\\bar{x}_{n}$，我们有 $S_{xx,n+1}S_{xx,n}$，并且其增量可能非常大。\n\n新的t统计量是\n$$\nt_{n+1}=\\frac{\\hat{\\beta}_{1,n+1}}{\\sqrt{\\widehat{\\sigma}_{n+1}^{2}/S_{xx,n+1}}}=\\frac{\\hat{\\beta}_{1,n}}{\\sqrt{\\widehat{\\sigma}_{n+1}^{2}/S_{xx,n+1}}}.\n$$\n因此，\n$$\n\\frac{|t_{n+1}|}{|t_{n}|}=\\sqrt{\\frac{S_{xx,n+1}}{S_{xx,n}}\\cdot\\frac{\\widehat{\\sigma}_{n}^{2}}{\\widehat{\\sigma}_{n+1}^{2}}}=\\sqrt{\\left(1+\\frac{n}{n+1}\\frac{(x_{n+1}-\\bar{x}_{n})^{2}}{S_{xx,n}}\\right)\\cdot\\frac{n-1}{n-2}}.\n$$\n这里 $S_{xx,n}0$，$(n-1)/(n-2)1$，且 $(x_{n+1}-\\bar{x}_{n})^{2}0$，所以平方根内的乘积严格大于1。因此，\n$$\n|t_{n+1}||t_{n}|.\n$$\n因此，正确的选项是t统计量的绝对值增大。", "answer": "$$\\boxed{C}$$", "id": "1923258"}]}