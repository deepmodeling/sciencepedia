## 引言
[无界自伴算子](@entry_id:189288)的[谱理论](@entry_id:275351)是现代数学和物理学交叉领域的一块基石。相较于性质良好的[有界算子](@entry_id:264879)，动量、位置等关键物理量在数学上常表现为[无界算子](@entry_id:144655)，这引入了深刻的挑战与丰富的结构，其中最核心的就是对称性与自伴性之间的微妙差别。本文旨在系统地揭开这层面纱，为读者构建一个清晰的理论框架。在接下来的内容中，我们将首先在“原理与机制”一章中深入探讨对称性、自伴性、[亏指数](@entry_id:266905)以及谱的基本性质，为后续的理解奠定坚实的数学基础。随后，我们将在“应用与[交叉](@entry_id:147634)学科联系”一章中，展示这些抽象理论如何在量子力学、凝聚态物理等领域大放异彩，解释从原子能级到晶体能带等关键物理现象。最后，通过“动手实践”部分的精选问题，读者将有机会亲手应用所学知识，巩固并深化理解。让我们从最核心的原理出发，开启对[无界算子](@entry_id:144655)谱世界的探索。

## 原理与机制

本章在前一章介绍的背景之上，深入探讨[无界自伴算子](@entry_id:189288)谱理论的核心原理与机制。在[有界算子](@entry_id:264879)的世界里，对称性与自伴性是等价的，这大大简化了它们的分析。然而，在物理学（尤其是在量子力学中）和数学的许多分支中，我们不可避免地会遇到[无界算子](@entry_id:144655)，例如动量和位置算子。对于这些算子，对称性与自伴性之间的区别变得至关重要，而这种区别正是[谱理论](@entry_id:275351)丰富而深刻的根源。本章将系统地阐明这些关键概念，并揭示它们如何决定[算子的谱](@entry_id:272027)特性。

### 对称性与自伴性：[无界算子](@entry_id:144655)的微妙之处

在[希尔伯特空间](@entry_id:261193) $\mathcal{H}$ 中，一个稠定（即其定义域 $D(A)$ 在 $\mathcal{H}$ 中是稠密的）线性算子 $A$ 被称为**对称的 (symmetric)**，如果对于所有 $f, g \in D(A)$，都满足：
$$ \langle Af, g \rangle = \langle f, Ag \rangle $$
这个定义看起来很自然，但它隐藏了一个关键的复杂性，这与[算子的定义域](@entry_id:152686)有关。为了全面理解这一点，我们需要引入**[伴随算子](@entry_id:140236) (adjoint operator)** $A^*$ 的概念。对于一个[稠定算子](@entry_id:264952) $A$，其[伴随算子](@entry_id:140236) $A^*$ 的定义域 $D(A^*)$ 包含所有满足以下条件的向量 $g \in \mathcal{H}$：存在一个唯一的向量 $h \in \mathcal{H}$，使得对于所有 $f \in D(A)$，都有 $\langle Af, g \rangle = \langle f, h \rangle$。此时，我们定义 $A^*g = h$。

有了伴随算子的定义，[对称算子](@entry_id:272489)可以被更精确地描述为 $D(A) \subseteq D(A^*)$ 且对于所有 $f \in D(A)$ 都有 $A f = A^* f$。换言之，一个[对称算子](@entry_id:272489)是其伴随算子的一个限制。

一个算子 $A$ 被称为**自伴的 (self-adjoint)**，如果它等于其伴随算子，即 $A = A^*$。这包含两个条件：
1.  定义域相同：$D(A) = D(A^*)$。
2.  作用相同：对于所有 $f \in D(A)$，$Af = A^*f$。

对于[有界算子](@entry_id:264879)，对称性直接蕴含了自伴性。然而，对于[无界算子](@entry_id:144655)，一个算子可以是还对称的但非自伴的。这种区别是理解[无界算子](@entry_id:144655)[谱理论](@entry_id:275351)的第一个核心要点。

让我们通过一个核心例子——微分算子——来阐明这些概念。考虑希尔伯特空间 $H = L^2([0,1])$，其中的[内积](@entry_id:158127)为 $\langle f, g \rangle = \int_0^1 f(x) \overline{g(x)} \,dx$。我们研究算子 $Tf = i \frac{d}{dx}f(x)$，它的性质极度依赖于其定义域 $D(T)$ 的选择。

通过分部积分，我们可以探索 $T$ 和其[伴随算子](@entry_id:140236)之间的关系。对于足够光滑的函数 $u, v$，我们有：
$$ \langle Tu, v \rangle = \int_0^1 i u'(x) \overline{v(x)} \,dx = i[u(x)\overline{v(x)}]_0^1 - \int_0^1 i u(x) \overline{v'(x)} \,dx = i(u(1)\overline{v(1)} - u(0)\overline{v(0)}) + \langle u, Tv \rangle $$
这个恒等式中的边界项 $i(u(1)\overline{v(1)} - u(0)\overline{v(0)})$ 是关键。算子的对称性和自伴性完全取决于如何通过定义域的边界条件来控制这个边界项。

- **对称但非自伴的情形** [@problem_id:1881968]
  假设我们选择定义域为 $D(T_1) = \{f \in C^1([0,1]) \mid f(0) = 0 \text{ and } f(1) = 0\}$。对于任何 $f, g \in D(T_1)$，边界条件使得 $f(0)=g(0)=0$ 和 $f(1)=g(1)=0$，因此边界项为零。这意味着 $\langle T_1f, g \rangle = \langle f, T_1g \rangle$，所以 $T_1$ 是对称的。
  然而，要确定其伴随算子 $T_1^*$，我们需要找到所有 $g \in H$，使得 $\langle T_1f, g \rangle = \langle f, h \rangle$ 对所有 $f \in D(T_1)$ 成立。由于 $f(0)=f(1)=0$，分部积分后的边界项 $i(f(1)\overline{g(1)} - f(0)\overline{g(0)})$ 总是为零，*而无需对 $g$ 施加任何边界条件*。因此，$T_1^*$ 的定义域是所有足够光滑的函数，没有任何边界限制，即 $D(T_1^*) = \{g \in AC([0,1]) \mid g' \in L^2([0,1])\}$。显然，$D(T_1) \subset D(T_1^*)$ 且 $D(T_1) \neq D(T_1^*)$。因此，$T_1$ 是对称的，但不是自伴的。

- **自伴的情形** [@problem_id:1881968] [@problem_id:1881193]
  现在考虑周期性边界条件 $D(T_2) = \{f \in C^1([0,1]) \mid f(0) = f(1)\}$。对于 $f, g \in D(T_2)$，边界项变为 $i(f(1)\overline{g(1)} - f(0)\overline{g(0)}) = i(f(0)\overline{g(0)} - f(0)\overline{g(0)}) = 0$。所以 $T_2$ 是对称的。
  为了确定 $D(T_2^*)$，我们要求边界项对所有 $f \in D(T_2)$ 为零，即 $i(f(1)\overline{g(1)} - f(0)\overline{g(0)}) = i f(0) (\overline{g(1)} - \overline{g(0)}) = 0$。由于 $f(0)$ 可以是任意非零值，这迫使我们必须有 $\overline{g(1)} - \overline{g(0)} = 0$，即 $g(1) = g(0)$。这意味着 $D(T_2^*)$ 具有与 $D(T_2)$ 相同的边界条件。因此，$D(T_2) = D(T_2^*)$，$T_2$ 是自伴的。
  更一般地，对于边界条件为 $u(1) = \alpha u(0)$ 的算子 $T$，其中 $\alpha$ 是一个复常数，要使算子对称，对于任意 $u, v \in D(T)$，我们需要边界项 $i(u(1)\overline{v(1)} - u(0)\overline{v(0)}) = i(\alpha u(0) \overline{\alpha v(0)} - u(0)\overline{v(0)}) = i(|\alpha|^2 - 1) u(0)\overline{v(0)}$ 为零。这要求 $|\alpha|=1$。进一步的计算表明，当且仅当 $|\alpha|=1$ 时，$D(T)$ 和 $D(T^*)$ 的边界条件等价，从而使得算子是自伴的 [@problem_id:1881193]。

- **非对称的情形** [@problem_id:1881162]
  如果定义域是 $D(T_3) = \{f \in AC([0,1]) \mid f' \in L^2([0,1]) \text{ and } f(0) = 0\}$，边界项为 $i(f(1)\overline{g(1)} - f(0)\overline{g(0)}) = i f(1)\overline{g(1)}$。由于 $f(1)$ 和 $g(1)$ 通常不为零，这个算子甚至不是对称的。它的[伴随算子](@entry_id:140236) $T_3^*$ 的定义域被发现需要满足 $g(1)=0$ 的边界条件。因此，$D(T_3)$ 和 $D(T_3^*)$ 是两个不同的[子空间](@entry_id:150286)，它们没有包含关系。

- **内在的非自伴性** [@problem_id:1881174]
  有些算子，无论如何选择边界条件，都无法成为[自伴算子](@entry_id:152188)。一个典型的例子是 $A = \frac{d}{dx}$。通过分部积分，我们发现其形式伴随是 $A_{\text{formal}}^* = -\frac{d}{dx}$。自伴性要求 $A=A^*$，即 $\frac{d}{dx} = -\frac{d}{dx}$，这意味着 $\frac{d}{dx}f = 0$ 对定义域中所有函数都成立。这将导致定义域仅包含常数函数，这样的集合在 $L^2([0,1])$ 中不是稠密的，违反了自伴算子必须是稠定的前提。因此，算子 $\frac{d}{dx}$ 的作用形式本身就阻止了它成为[自伴算子](@entry_id:152188)。与其密切相关的算子 $i\frac{d}{dx}$ 则可以通过选择合适的边界条件成为自伴算子，这是因为引入因子 $i$ 后，形式伴随算子变成了 $(-i)(-\frac{d}{dx}) = i\frac{d}{dx}$，与原算子形式相同。

### [自伴扩张](@entry_id:264525)与[亏指数](@entry_id:266905)

我们已经看到，一个[对称算子](@entry_id:272489) $T$ 可能是某个更大的[自伴算子](@entry_id:152188) $\tilde{T}$ 的一部分（即 $T \subseteq \tilde{T}$）。在这种情况下，$\tilde{T}$ 被称为 $T$ 的一个**[自伴扩张](@entry_id:264525) (self-adjoint extension)**。在量子力学中，一个[物理可观测量](@entry_id:154692)必须由一个自伴算子来描述。通常，物理原理只能为我们提供一个[对称算子](@entry_id:272489)（例如，在某个区域内作用的动量算子），而寻找其所有可能的[自伴扩张](@entry_id:264525)，则对应于探索所有可能的物理边界条件。

冯·诺伊曼 ([John von Neumann](@entry_id:270356)) 的杰出理论为我们提供了判断一个[对称算子](@entry_id:272489)是否存在[自伴扩张](@entry_id:264525)以及有多少种扩张的方法。该理论的核心是**[亏指数](@entry_id:266905) (deficiency indices)**，记为 $(n_+, n_-)$。它们被定义为两个[子空间](@entry_id:150286)的维度：
$$ n_+ = \dim(\ker(T^* - iI)) $$
$$ n_- = \dim(\ker(T^* + iI)) $$
其中 $\ker(A)$ 表示算子 $A$ 的[零空间](@entry_id:171336)（或核），$I$ 是单位算子。这两个维度衡量了 $T$“偏离”自伴性的程度。

冯·诺伊曼基本定理指出：
1.  一个[对称算子](@entry_id:272489) $T$ 存在[自伴扩张](@entry_id:264525)的充分必要条件是其[亏指数](@entry_id:266905)相等，即 $n_+ = n_-$。
2.  如果 $n_+ = n_- = 0$，则 $T$ 本身就是自伴的，并且是唯一的[自伴扩张](@entry_id:264525)。
3.  如果 $n_+ = n_- = k \ge 1$，则 $T$ 有无穷多个[自伴扩张](@entry_id:264525)，这些扩张可以通过一个 $k \times k$ 的[酉矩阵](@entry_id:138978)族来参数化。
4.  如果 $n_+ \neq n_-$，则 $T$ 没有任何[自伴扩张](@entry_id:264525)。

例如，考虑在 $L^2(0, \infty)$ 上的动量算子 $Tf = -i \frac{d}{dx}f$，其初始定义域为 $C_c^\infty(0, \infty)$（在 $(0, \infty)$ 内具有[紧支撑](@entry_id:276214)的无限[可微函数](@entry_id:144590)）[@problem_id:1881167]。其[伴随算子](@entry_id:140236) $T^*$ 的作用形式相同，但定义域更广，为 $\{f \in L^2 \mid f \text{ 绝对连续}, f' \in L^2\}$。
-  为了计算 $n_+$，我们求解 $T^*f = if$，即 $-i f' = if$，或 $f' = -f$。通解是 $f(x) = C e^{-x}$。这个函数属于 $L^2(0, \infty)$。因此，$\ker(T^* - iI)$ 是一维的，$n_+ = 1$。
-  为了计算 $n_-$，我们求解 $T^*f = -if$，即 $-i f' = -if$，或 $f' = f$。通解是 $f(x) = C e^{x}$。除非 $C=0$，否则这个函数不属于 $L^2(0, \infty)$。因此，$\ker(T^* + iI)$ 是[零空间](@entry_id:171336)，$n_- = 0$。

由于[亏指数](@entry_id:266905)为 $(1, 0)$，它们不相等，所以这个在半无限直线上定义的动量算子没有任何[自伴扩张](@entry_id:264525)。这在物理上意味着，一个被限制在半直线上的粒子，其动量不能简单地由 $-i\frac{d}{dx}$ 来描述，必须在边界 $x=0$ 处施加一个边界条件来构建一个自伴的[哈密顿量](@entry_id:172864)。

### [自伴算子](@entry_id:152188)的谱

一旦我们确定了一个算子是自伴的，我们就可以研究它的**谱 (spectrum)** $\sigma(A)$。谱是复数 $\lambda$ 的集合，对于这些 $\lambda$，算子 $A - \lambda I$ 没有一个在整个希尔伯特空间上定义的有界逆。

#### 谱的实数性

自伴算子的一个最基本和最重要的性质是它们的谱必须是实数。
**定理：** 如果 $A$ 是一个自伴算子，则 $\sigma(A) \subseteq \mathbb{R}$。

**证明思路** [@problem_id:1881189]：
令 $\lambda = x + iy$ 是一个复数，其中 $y = \text{Im}(\lambda) \neq 0$。对于任何 $\psi \in D(A)$，我们计算 $\|(A - \lambda I)\psi\|^2$：
$$ \|(A - \lambda I)\psi\|^2 = \langle (A - xI - iyI)\psi, (A - xI - iyI)\psi \rangle $$
由于 $A$ 是自伴的，$(A-xI)$ 也是自伴的，因此 $\langle (A-xI)\psi, \psi \rangle$ 是实数。展开[内积](@entry_id:158127)后，交叉项会抵消，剩下：
$$ \|(A - \lambda I)\psi\|^2 = \|(A - xI)\psi\|^2 + y^2 \|\psi\|^2 $$
由此可得一个至关重要的不等式：
$$ \|(A - \lambda I)\psi\| \ge |y| \|\psi\| = |\text{Im}(\lambda)| \|\psi\| $$
这个不等式表明，只要 $\lambda$ 不是实数，$(A - \lambda I)$ 就是一个下[有界算子](@entry_id:264879)，因此是单射的。进一步的分析可以证明它的值域是闭的且在 $\mathcal{H}$ 中稠密，因此是全空间。这意味着 $(A - \lambda I)$ 存在有界逆。所以，任何非实数的 $\lambda$ 都不在谱中，谱必须是实的。

从这个不等式还可以直接得到关于**[预解式](@entry_id:199555) (resolvent)** $R(\lambda, A) = (A - \lambda I)^{-1}$ 范数的一个重要界限：
$$ \|R(\lambda, A)\| \le \frac{1}{|\text{Im}(\lambda)|} $$
这个界限在理论和应用中都非常有用。例如，在量子系统中，[预解式](@entry_id:199555)的范数衡量了系统在[复能量](@entry_id:263929) $E$ 处的响应强度。要最小化响应，就需要最大化 $|\text{Im}(E)|$ 或者，如果虚部固定，最大化 $E$ 的实部与谱 $\sigma(H)$ 中各点之间的距离 [@problem_id:1881178]。

### 谱的分类

对于自伴算子，其谱 $\sigma(A)$ 可以被分解为两个不相交的部分：**[点谱](@entry_id:274057) (point spectrum)** $\sigma_p(A)$ 和**连续谱 (continuous spectrum)** $\sigma_c(A)$。（对于一般算子还存在第三种谱——[剩余谱](@entry_id:269789)，但对于自伴算子，[剩余谱](@entry_id:269789)总是空的）。

1.  **[点谱](@entry_id:274057) $\sigma_p(A)$**：
    [点谱](@entry_id:274057)就是算子 $A$ 的所有**[特征值](@entry_id:154894) (eigenvalues)** 的集合。一个数 $\lambda$ 是[特征值](@entry_id:154894)，如果存在一个非零向量 $\psi$（称为**[特征向量](@entry_id:151813) (eigenvector)**）使得 $A\psi = \lambda\psi$。在量子力学中，[特征值](@entry_id:154894)对应于[物理可观测量](@entry_id:154692)可能取到的确定值。

2.  **[连续谱](@entry_id:155477) $\sigma_c(A)$**：
    连续谱包含所有不属于[点谱](@entry_id:274057)的谱点 $\lambda$。对于这样的 $\lambda$，算子 $(A - \lambda I)$ 是[单射](@entry_id:183792)的（因为没有[特征向量](@entry_id:151813)），但其值域在 $\mathcal{H}$ 中是稠密的，却不等于整个 $\mathcal{H}$。这意味着它的（无界）逆算子定义在一个稠集上。物理上，[连续谱](@entry_id:155477)对应于[可观测量](@entry_id:267133)可以取值的连续范围，例如[自由粒子](@entry_id:148748)的能量或位置。

乘法算子是理解[连续谱](@entry_id:155477)的典范。考虑在 $L^2([a,b])$ 上的**位置算子 (position operator)** $Q$，其作用为 $(Qu)(x) = x u(x)$ [@problem_id:1881160]。
-   **[点谱](@entry_id:274057)**：我们寻找[特征值](@entry_id:154894) $\lambda$，即求解 $(Q - \lambda I)u = 0$，也就是 $(x-\lambda)u(x) = 0$。这个方程要求 $u(x)$ [几乎处处](@entry_id:146631)为零。在 $L^2$ 空间中，这样的函数等价于[零向量](@entry_id:156189)。因此，$Q$ 没有[特征值](@entry_id:154894)，$\sigma_p(Q) = \emptyset$。
-   **谱**：如果 $\lambda \notin [a,b]$，那么函数 $\frac{1}{x-\lambda}$ 在 $[a,b]$ 上是有界的。我们可以定义一个有界逆算子 $(R_\lambda f)(x) = \frac{f(x)}{x-\lambda}$。因此，所有不在 $[a,b]$ 中的 $\lambda$ 都不在谱中，即 $\sigma(Q) \subseteq [a,b]$。
-   如果 $\lambda \in [a,b]$，函数 $\frac{1}{x-\lambda}$ 在 $x=\lambda$ 处是无界的。这意味着 $(Q - \lambda I)^{-1}$ 是一个[无界算子](@entry_id:144655)，因此 $\lambda$ 属于谱。
综合来看，$\sigma(Q) = [a,b]$。由于[点谱](@entry_id:274057)为空，我们得出结论：位置算子 $Q$ 的谱是纯连续谱，$\sigma_c(Q) = [a,b]$。

这个原理可以推广：对于一个由实值函数 $f(x)$ 定义的乘法算子 $T_f u(x) = f(x)u(x)$，其谱 $\sigma(T_f)$ 就是函数 $f(x)$ 的**本质值域 (essential range)**，即 $f$ 的值域的闭包 [@problem_id:1881152]。例如，在 $L^2([-1,1])$ 上，算子 $A u(x) = |x| u(x)$ 的谱是函数 $|x|$ 在 $[-1,1]$ 上的值域 $[0,1]$ [@problem_id:1881169]。同样，在 $L^2(\mathbb{R})$ 上，由 $f(x) = \arctan(x)$ 定义的乘法[算子的谱](@entry_id:272027)是 $[-\frac{\pi}{2}, \frac{\pi}{2}]$ [@problem_id:1881152]。在这些例子中，由于 $f(x)=\lambda$ 的[解集](@entry_id:154326)测度为零，所以[点谱](@entry_id:274057)都为空，谱完全是连续的。

通过对定义域、边界条件和算子形式的仔细分析，我们揭示了[无界算子](@entry_id:144655)谱理论的丰富结构。从对称性到自伴性，再到谱的实数性和分类，这些原理共同构成了现代[数学物理](@entry_id:265403)的基础框架。