{"hands_on_practices": [{"introduction": "在复分析中，一个核心技能是从一个已知的调和函数（解析函数的实部或虚部）出发，重建整个解析函数。这个过程不仅是数学上的一个优美练习，在物理学中也至关重要，例如从电势分布（实部）推导出完整的复势函数。这项练习将引导你使用柯西-黎曼方程，这是连接调和函数真实部与虚部的桥梁，来完成这一重建过程 [@problem_id:2249550]。", "problem": "考虑一个关于复变量 $z=x+iy$ 的解析函数 $f(z)$，其中 $x$ 和 $y$ 是实变量。该函数的实部由 $u(x, y) = \\text{Re}[f(z)] = e^{-y}\\cos(x) + xy$ 给出。已知该函数满足条件 $f(0) = 1$，求仅用复变量 $z$ 表示的函数 $f(z)$。", "solution": "我们已知一个解析函数 $f(z)=u(x,y)+i v(x,y)$ 的实部为\n$$\nu(x,y)=\\exp(-y)\\cos x + x y,\n$$\n其中 $z=x+i y$ 且满足条件 $f(0)=1$。由于 $f$ 是解析的，其调和共轭函数 $v$ 满足柯西-黎曼方程：\n$$\nu_{x}=v_{y}, \\quad u_{y}=-v_{x}.\n$$\n计算 $u$ 的偏导数：\n$$\nu_{x}=\\frac{\\partial}{\\partial x}\\big(\\exp(-y)\\cos x + x y\\big)=-\\exp(-y)\\sin x + y,\n$$\n$$\nu_{y}=\\frac{\\partial}{\\partial y}\\big(\\exp(-y)\\cos x + x y\\big)=-\\exp(-y)\\cos x + x.\n$$\n由 $v_{y}=u_{x}$，对 $y$ 积分：\n$$\nv(x,y)=\\int\\big(-\\exp(-y)\\sin x + y\\big)\\,dy=\\exp(-y)\\sin x + \\frac{y^{2}}{2} + \\phi(x),\n$$\n其中 $\\phi$ 是一个仅关于 $x$ 的函数。将其对 $x$ 求导：\n$$\nv_{x}=\\exp(-y)\\cos x + \\phi'(x).\n$$\n使用第二个柯西-黎曼方程 $v_{x}=-u_{y}$ 可得\n$$\n\\exp(-y)\\cos x + \\phi'(x)=\\exp(-y)\\cos x - x \\;\\;\\Rightarrow\\;\\; \\phi'(x)=-x,\n$$\n因此\n$$\n\\phi(x)=-\\frac{x^{2}}{2}+C,\n$$\n其中 $C\\in\\mathbb{R}$ 是一个常数。因此\n$$\nv(x,y)=\\exp(-y)\\sin x + \\frac{y^{2}}{2} - \\frac{x^{2}}{2} + C,\n$$\n解析函数为\n$$\nf(z)=u+i v=\\big(\\exp(-y)\\cos x\\big)+i\\big(\\exp(-y)\\sin x\\big) + \\Big(x y + i\\big(\\frac{y^{2}}{2}-\\frac{x^{2}}{2}\\big)\\Big) + i C.\n$$\n代入条件 $f(0)=1$。在 $(x,y)=(0,0)$ 处，我们有 $u(0,0)=\\exp(0)\\cos 0=1$ 和 $v(0,0)=C$，所以 $f(0)=1+i C=1$ 意味着 $C=0$。\n\n现在将 $f$ 完全用 $z$ 来表示。注意到\n$$\n\\exp(i z)=\\exp(i x - y)=\\exp(-y)\\big(\\cos x + i \\sin x\\big),\n$$\n以及\n$$\nz^{2}=(x+i y)^{2}=x^{2}-y^{2}+2 i x y.\n$$\n那么\n$$\n-\\frac{i}{2}z^2 = -\\frac{i}{2}(x^2 - y^2 + 2ixy) = xy + i\\frac{y^2-x^2}{2},\n$$\n因此剩余的项完全匹配。因此\n$$\nf(z)=\\exp(i z)-\\frac{i}{2} z^{2},\n$$\n这也满足 $f(0)=1$。", "answer": "$$\\boxed{\\exp(i z)-\\frac{i}{2} z^{2}}$$", "id": "2249550"}, {"introduction": "调和函数的一个显著特性是极值原理，它指出非恒定的调和函数在有界区域内的极值（最大值和最小值）必然出现在区域的边界上。这个原理在物理中有直观的解释，例如在没有热源的稳定温度场中，最热点和最冷点不会出现在区域内部。本练习将让你亲手应用这一强大原理，在一个单位圆盘上寻找一个给定调和函数的最大值和最小值 [@problem_id:2249485]。", "problem": "在物理学中，一个解析复函数的实部通常表示一个标量势，例如静电势或温度分布。这类函数是调和函数，意味着它们在复函数解析的区域内满足拉普拉斯方程。\n\n考虑一个定义在闭单位圆盘 $D = \\{z \\in \\mathbb{C} : |z| \\leq 1\\}$ 上的调和势函数 $\\Phi(x, y)$，其中 $z=x+iy$。该势由复函数 $F(z) = (z-a)^2$ 给出，即 $\\Phi(x, y) = \\text{Re}(F(z))$。常数 $a$ 是一个实数，指定为 $a=1/2$。\n\n你的任务是找出圆盘 $D$ 上势函数 $\\Phi(x,y)$ 达到其绝对最大值和绝对最小值的点。下列哪个选项正确地指出了最大值位置（记为 $z_{max}$）和最小值位置（记为 $z_{min}$）？\n\nA. $z_{max} = 1$; $z_{min} = -1$。\n\nB. $z_{max} = -1$; $z_{min}$ 是集合 $\\{ \\frac{1}{4} + i\\frac{\\sqrt{15}}{4}, \\frac{1}{4} - i\\frac{\\sqrt{15}}{4} \\}$ 中的两个点。\n\nC. $z_{max}$ 是集合 $\\{1, -1\\}$ 中的两个点; $z_{min}$ 是集合 $\\{i, -i\\}$ 中的两个点。\n\nD. $z_{max} = 1/2$; $z_{min} = -1$。\n\nE. $z_{max} = 1$; $z_{min}$ 是集合 $\\{ \\frac{1}{2} + i\\frac{\\sqrt{3}}{2}, \\frac{1}{2} - i\\frac{\\sqrt{3}}{2} \\}$ 中的两个点。", "solution": "给定 $F(z)=(z-a)^{2}$，其中 $a=\\frac{1}{2}$ 是实数，以及在闭单位圆盘 $D=\\{z\\in\\mathbb{C}:|z|\\leq 1\\}$ 上的 $\\Phi(x,y)=\\operatorname{Re}(F(z))$。由于 $F$ 在 $D$ 的一个邻域上是解析的，所以 $\\Phi$ 在 $D$ 上是调和的。根据调和函数的最大/最小值原理，一个非常数的调和函数在边界 $|z|=1$ 上达到其绝对最大值和最小值。\n\n记 $z=x+iy$ 并设 $u=x-\\frac{1}{2}$，$v=y$。那么\n$$\nF(z)=(u+iv)^{2}=u^{2}-v^{2}+2iuv,\n$$\n所以\n$$\n\\Phi(x,y)=\\operatorname{Re}(F(z))=u^{2}-v^{2}=(x-\\tfrac{1}{2})^{2}-y^{2}.\n$$\n限制在边界 $x^{2}+y^{2}=1$ 上，用 $x=\\cos\\theta$，$y=\\sin\\theta$ 进行参数化。那么\n$$\n\\Phi(\\theta)=(\\cos\\theta-\\tfrac{1}{2})^{2}-\\sin^{2}\\theta=\\cos^{2}\\theta-\\cos\\theta+\\tfrac{1}{4}-(1-\\cos^{2}\\theta)=2\\cos^{2}\\theta-\\cos\\theta-\\tfrac{3}{4}.\n$$\n令 $u=\\cos\\theta\\in[-1,1]$。那么\n$$\n\\Phi(u)=2u^{2}-u-\\tfrac{3}{4}.\n$$\n这是一个关于 $u$ 的二次函数，其首项系数为正，所以它在 $[-1,1]$ 上的最小值出现在顶点 $u=\\frac{1}{4}$ 处，而其在 $[-1,1]$ 上的最大值出现在某个端点处。计算这些值：\n$$\n\\Phi\\!\\left(\\tfrac{1}{4}\\right)=2\\cdot\\tfrac{1}{16}-\\tfrac{1}{4}-\\tfrac{3}{4}=\\tfrac{1}{8}-1=-\\tfrac{7}{8},\n$$\n$$\n\\Phi(-1)=2\\cdot 1-(-1)-\\tfrac{3}{4}=\\tfrac{9}{4},\\quad \\Phi(1)=2\\cdot 1-1-\\tfrac{3}{4}=\\tfrac{1}{4}.\n$$\n因此，绝对最大值在 $u=-1$ 处取得，即 $x=\\cos\\theta=-1$，$y=0$，所以 $z_{\\max}=-1$。绝对最小值在 $u=\\cos\\theta=\\frac{1}{4}$ 处取得，这给出 $x=\\frac{1}{4}$ 且 $y=\\pm\\sqrt{1-\\frac{1}{16}}=\\pm\\frac{\\sqrt{15}}{4}$，即 $z_{\\min}\\in\\left\\{\\frac{1}{4}\\pm i\\frac{\\sqrt{15}}{4}\\right\\}$。\n\n这些位置与选项 B 相符。", "answer": "$$\\boxed{B}$$", "id": "2249485"}, {"introduction": "理论的深刻理解往往来自于实践的验证。本练习旨在通过数值计算的方式，验证调和函数的另一个基本性质——平均值性质。该性质表明，调和函数在某一点的值等于其在该点周围任意一个圆上取值的平均值。通过编写一个简单的程序来计算这个平均值并与中心点的值进行比较，你将能够直观地“看到”这个定理的成立，从而在理论与计算之间建立起一座桥梁 [@problem_id:2406764]。", "problem": "您将设计并实现一个程序，以数值方式验证与二维拉普拉斯方程解相关的均值性质。此项任务的基础是调和函数的定义，即一个满足二维拉普拉斯方程 $\\Delta u = u_{xx} + u_{yy} = 0$ 的足够光滑的函数 $u(x,y)$，以及在平面上沿圆周对函数求平均的经典概念。请完全以纯数学术语进行操作。所有角度必须以弧度为单位。\n\n您的任务如下：\n- 对于每个测试用例，考虑一个定义在 $\\mathbb{R}^2$ 子集上的函数 $u(x,y)$、一个中心点 $(x_0,y_0)$、一个半径 $r \\ge 0$ 和一个正整数 $M$。\n- 通过 $\\theta \\in [0,2\\pi)$ 定义圆的参数化，并将以 $(x_0,y_0)$ 为中心、半径为 $r$ 的圆定义为 $(x(\\theta),y(\\theta)) = (x_0 + r\\cos\\theta, y_0 + r\\sin\\theta)$。\n- 将 $u$ 沿圆周的角度平均值定义为在 $\\theta \\in [0,2\\pi)$ 上的积分平均值。使用 $M$ 个等距样本 $\\theta_j = \\frac{2\\pi j}{M}$（其中 $j=0,1,\\dots,M-1$）来数值近似这个角度平均值。使用简单的等距样本均值作为角度平均值的数值近似。当 $r = 0$ 时，将圆解释为单点 $(x_0,y_0)$，并将平均值取为 $u(x_0,y_0)$。\n- 对于每个测试用例，计算中心点处的函数值与圆周上的数值角度平均值之间的绝对差，即计算 $\\left|u(x_0,y_0) - \\overline{u}\\right|$，其中 $\\overline{u}$ 是上述的数值平均值。\n\n实现以下包含 6 个用例的测试套件，这些用例共同涵盖了典型行为、边界情况以及与非调和函数的对比。在所有情况下，角度均以弧度为单位：\n- 情况 1（2 次调和多项式）：$u(x,y) = x^2 - y^2$，中心点 $(x_0,y_0) = (0.1,-0.2)$，半径 $r = 0.4$，样本数 $M = 4096$。\n- 情况 2（3 次调和多项式）：$u(x,y) = x^3 - 3xy^2$，中心点 $(x_0,y_0) = (-0.3,0.25)$，半径 $r = 0.2$，样本数 $M = 4096$。\n- 情况 3（调和但非多项式；仅在原点处奇异）：$u(x,y) = \\log\\!\\big(\\sqrt{x^2 + y^2}\\big)$，中心点 $(x_0,y_0) = (0.5,0.4)$，半径 $r = 0.3$，样本数 $M = 8192$。在这种情况下，整个圆周与原点的距离严格大于 0。\n- 情况 4（非调和函数对比）：$u(x,y) = x^2 + y^2$，中心点 $(x_0,y_0) = (0.1,0.2)$，半径 $r = 0.4$，样本数 $M = 4096$。\n- 情况 5（退化半径）：$u(x,y) = x^2 - y^2$，中心点 $(x_0,y_0) = (-0.75,0.6)$，半径 $r = 0.0$，样本数 $M = 16$。\n- 情况 6（在非多项式调和函数上进行粗略采样）：$u(x,y) = \\log\\!\\big(\\sqrt{x^2 + y^2}\\big)$，中心点 $(x_0,y_0) = (0.5,0.4)$，半径 $r = 0.3$，样本数 $M = 32$。\n\n您的程序必须：\n- 实现上述数值过程，将角度平均值近似为 $M$ 个样本的离散均值。\n- 对于每种情况，计算并收集绝对差 $\\left|u(x_0,y_0) - \\overline{u}\\right|$，结果为浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按情况 1 到 6 的顺序排列的结果，格式为方括号内以逗号分隔的列表，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$，其中每个 $r_k$ 是情况 $k$ 的浮点数绝对差。", "solution": "所述问题是有效、自洽且科学合理的。它提出了计算物理学中的一个标准任务：对一个基本数学定理进行数值验证。我们将着手推导解决方案。\n\n这个问题的核心在于调和函数的均值性质。一个定义在域 $\\Omega \\subseteq \\mathbb{R}^2$ 上的双实变函数 $u(x,y)$，如果它是 $C^2$ 类函数并且在整个 $\\Omega$ 上满足二维拉普拉斯方程，则被称为调和函数：\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\n调和函数的均值定理是位势论中的一个核心结果。它指出，如果 $u$ 是域 $\\Omega$ 上的一个调和函数，那么对于 $\\Omega$ 中的任意点 $(x_0, y_0)$ 以及任何一个以 $(x_0, y_0)$ 为中心且完全包含在 $\\Omega$ 内的圆盘 $D$，该函数在圆盘中心的值等于其在该圆盘边界圆上的值的平均值。\n\n设圆为 $C_r$，中心为 $(x_0, y_0)$，半径为 $r  0$。我们可以使用角度 $\\theta \\in [0, 2\\pi)$ 将此圆参数化为 $(x(\\theta), y(\\theta)) = (x_0 + r\\cos\\theta, y_0 + r\\sin\\theta)$。该定理指出：\n$$\nu(x_0, y_0) = \\frac{1}{2\\pi r} \\oint_{C_r} u(x,y) \\, ds = \\frac{1}{2\\pi} \\int_0^{2\\pi} u(x_0 + r\\cos\\theta, y_0 + r\\sin\\theta) \\, d\\theta\n$$\n其中 $ds$ 是弧长元素。问题要求我们对这一性质进行数值验证。\n\n指定的数值过程是用离散样本均值来近似连续积分平均值。我们将角度 $\\theta$ 离散化为 $M$ 个等距点：\n$$\n\\theta_j = \\frac{2\\pi j}{M}, \\quad \\text{for } j = 0, 1, \\dots, M-1\n$$\n圆上的相应点是 $(x_j, y_j) = (x_0 + r\\cos\\theta_j, y_0 + r\\sin\\theta_j)$。平均值的数值近似（我们记为 $\\overline{u}$）是这些点上函数值的算术平均值：\n$$\n\\overline{u} = \\frac{1}{M} \\sum_{j=0}^{M-1} u(x_j, y_j)\n$$\n这是一种标准的数值积分技术，对于周期函数在其周期上的积分，它等价于矩形法则或梯形法则。\n\n目标是为几个测试用例计算绝对差 $\\left|u(x_0, y_0) - \\overline{u}\\right|$。对于半径 $r=0$ 的特殊情况，圆退化为点 $(x_0, y_0)$。问题正确地指明，在这种情况下，平均值就是 $u(x_0, y_0)$，因此绝对差恰好为 $0$。\n\n我们将基于这些原则分析测试用例：\n\n-   情况 1、2、3 和 6 涉及的函数在包含积分圆的区域内是调和的。\n    -   在情况 1 中，$u(x,y) = x^2 - y^2$。我们验证其调和性：$u_{xx} = 2$，$u_{yy} = -2$，所以 $\\Delta u = 2-2=0$。\n    -   在情况 2 中，$u(x,y) = x^3 - 3xy^2$。我们验证：$u_{xx} = 6x$，$u_{yy} = -6x$，所以 $\\Delta u = 6x-6x=0$。\n    -   情况 3 和 6 使用 $u(x,y) = \\log\\sqrt{x^2+y^2} = \\frac{1}{2}\\log(x^2+y^2)$。此函数除了在原点 $(0,0)$ 外处处调和。对于给定的参数 $(x_0,y_0)=(0.5,0.4)$ 和 $r=0.3$，中心点到原点的距离为 $\\sqrt{0.5^2+0.4^2} = \\sqrt{0.41} \\approx 0.64$。由于 $r  \\sqrt{0.41}$，该圆不包含位于 $(0,0)$ 的奇点，因此函数在该圆上及其内部是调和的。\n    -   对于这些调和情况，理论差值为 $0$。因此，计算出的量 $\\left|u(x_0, y_0) - \\overline{u}\\right|$ 是离散近似的数值误差的度量。对于 $\\sin\\theta$ 和 $\\cos\\theta$ 的多项式函数，梯形法则极其精确，因此对于具有较大 $M$ 的情况 1 和 2，误差应接近机器精度。对于情况 3，$M=8192$，误差应该很小。对于情况 6，由于 $M=32$ 小得多，数值误差预计将显著大于情况 3。\n\n-   情况 4 提供了一个与非调和函数的对比，$u(x,y) = x^2 + y^2$。这里，$\\Delta u = 2+2=4 \\neq 0$。均值定理不适用。精确的积分平均值为 $u(x_0,y_0)+r^2$。理论差值为 $\\left|u(x_0,y_0) - (u(x_0,y_0)+r^2)\\right| = r^2$。对于 $r=0.4$，此值为 $0.16$。数值结果应非常接近此值，因为对于该被积函数，数值积分是精确的。\n\n-   情况 5 是一个 $r=0$ 的退化情况。如题所述，$\\overline{u} = u(x_0, y_0)$，所以差值 $\\left|u(x_0, y_0) - \\overline{u}\\right|$ 恰好为 $0$。\n\n实现将包含一个主函数，该函数遍历所提供的测试用例。对于每个用例，它将计算 $u(x_0, y_0)$ 并根据离散求和公式计算 $\\overline{u}$。然后计算并存储绝对差。一个特殊条件会按定义处理 $r=0$ 的情况。最后收集结果并格式化为所需的输出字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically verifying the mean value property for\n    harmonic functions.\n    \"\"\"\n\n    # Define the functions for each test case.\n    # Note: Using np.sqrt and np.log for vectorized operations.\n    u1 = lambda x, y: x**2 - y**2\n    u2 = lambda x, y: x**3 - 3*x*y**2\n    u3 = lambda x, y: np.log(np.sqrt(x**2 + y**2))\n    u4 = lambda x, y: x**2 + y**2\n    # Case 5 uses the same function as Case 1.\n    u5 = u1\n    # Case 6 uses the same function as Case 3.\n    u6 = u3\n\n    test_cases = [\n        # (function, (x0, y0), r, M)\n        {'u': u1, 'center': (0.1, -0.2), 'r': 0.4, 'M': 4096},\n        {'u': u2, 'center': (-0.3, 0.25), 'r': 0.2, 'M': 4096},\n        {'u': u3, 'center': (0.5, 0.4), 'r': 0.3, 'M': 8192},\n        {'u': u4, 'center': (0.1, 0.2), 'r': 0.4, 'M': 4096},\n        {'u': u5, 'center': (-0.75, 0.6), 'r': 0.0, 'M': 16},\n        {'u': u6, 'center': (0.5, 0.4), 'r': 0.3, 'M': 32},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        u_func = case['u']\n        x0, y0 = case['center']\n        r = case['r']\n        M = case['M']\n\n        # Calculate the function value at the center.\n        u_at_center = u_func(x0, y0)\n\n        # Calculate the numerical average on the circle.\n        if r == 0.0:\n            # Per problem definition, the average is the function value at the center.\n            u_average = u_at_center\n        else:\n            # Generate M equispaced angles from 0 to 2*pi (exclusive of 2*pi).\n            # theta_j = 2*pi*j/M for j=0, ..., M-1.\n            thetas = np.linspace(0, 2 * np.pi, M, endpoint=False)\n            \n            # Parametrize the circle points.\n            x_coords = x0 + r * np.cos(thetas)\n            y_coords = y0 + r * np.sin(thetas)\n            \n            # Evaluate the function at all points on the circle.\n            u_values_on_circle = u_func(x_coords, y_coords)\n            \n            # Compute the sample mean.\n            u_average = np.mean(u_values_on_circle)\n\n        # Compute the absolute difference.\n        abs_diff = np.abs(u_at_center - u_average)\n        results.append(abs_diff)\n    \n    # Format the output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2406764"}]}