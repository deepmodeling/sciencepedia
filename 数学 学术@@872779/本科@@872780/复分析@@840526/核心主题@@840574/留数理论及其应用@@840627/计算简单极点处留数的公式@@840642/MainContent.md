## 引言
留数是复分析中的一个基石概念，它不仅是柯西留数定理的核心，也是理解函数在[奇点](@entry_id:137764)附近行为的关键。然而，仅仅理解留数的定义是不够的；掌握高效、准确的计算方法是将其付诸实践的前提。本文聚焦于最常见的一类[奇点](@entry_id:137764)——单极点，系统地解答了“如何计算留数？”这一核心问题。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。**第一章：原理与机制**将详细推导并阐释计算单极点留数的两大核心公式。**第二章：应用与跨学科联系**将展示这些数学工具如何在物理、工程乃至数论等领域发挥其强大威力。最后，**第三章：动手实践**提供了一系列精心设计的问题，帮助读者巩固所学知识并提升解决实际问题的能力。

## 原理与机制

在对[复变函数](@entry_id:175282)理论的探索中，留数是一个中心概念，它揭示了函数在其[奇点](@entry_id:137764)周围的深刻行为。上一章我们介绍了留数的定义及其在柯西留数定理中的关键作用。本章我们将深入探讨计算留数的具体方法，特别聚焦于最常见也最重要的一类[奇点](@entry_id:137764)——**单极点**（simple pole）。掌握这些计算技巧，是应用[留数定理](@entry_id:164878)解决[复积分](@entry_id:202758)、求和以及其他问题的基础。

### 单极点与留数的计算基础

我们首先回顾一下单极点的定义。一个函数 $f(z)$ 在[孤立奇点](@entry_id:178349) $z_0$ 处的[洛朗级数展开](@entry_id:176045)为：
$$ f(z) = \sum_{n=-\infty}^{\infty} a_n (z-z_0)^n = \dots + \frac{a_{-2}}{(z-z_0)^2} + \frac{a_{-1}}{z-z_0} + a_0 + a_1(z-z_0) + \dots $$
如果这个展开式中包含负幂次项，但最低的负幂次是 $-1$（即对所有的 $n  -1$ 都有 $a_n = 0$，且 $a_{-1} \neq 0$），那么我们称 $z_0$ 是 $f(z)$ 的一个**单极点**。

根据定义，函数 $f(z)$ 在 $z_0$ 的**留数**（residue）就是其[洛朗级数展开](@entry_id:176045)式中 $(z-z_0)^{-1}$ 项的系数 $a_{-1}$，记作 $\operatorname{Res}(f; z_0)$。

从洛朗级数的结构出发，我们可以推导出计算单极点留数的第一个基本公式。如果 $z_0$ 是一个单极点，那么函数 $(z-z_0)f(z)$ 在 $z_0$ 点是解析的。具体来看：
$$ (z-z_0)f(z) = (z-z_0) \left( \frac{a_{-1}}{z-z_0} + a_0 + a_1(z-z_0) + \dots \right) = a_{-1} + a_0(z-z_0) + a_1(z-z_0)^2 + \dots $$
当 $z \to z_0$ 时，上式右边的所有含 $(z-z_0)$ 的项都趋于零，只剩下常数项 $a_{-1}$。因此，我们得到了计算单极点留数的一个极限公式：
$$ \operatorname{Res}(f; z_0) = \lim_{z \to z_0} (z-z_0) f(z) $$

这个公式为我们提供了一个直接的计算途径。例如，考虑函数 $f(z) = \cot(z)$，我们想知道它在 $z_0 = \pi$ 处的[洛朗级数](@entry_id:170999)系数 $a_{-1}$，也就是其留数 [@problem_id:2241827]。我们可以将函数写作 $\cot(z) = \frac{\cos(z)}{\sin(z)}$。当 $z \to \pi$ 时，分子 $\cos(z) \to \cos(\pi) = -1$，而分母 $\sin(z) \to 0$。这表明 $z_0 = \pi$ 是一个[奇点](@entry_id:137764)。利用泰勒展开，我们知道在 $z=\pi$ 附近，$\sin(z) = \sin(\pi + (z-\pi)) = -\sin(z-\pi) \approx -(z-\pi)$。因此，
$$ \lim_{z \to \pi} (z-\pi)\cot(z) = \lim_{z \to \pi} (z-\pi)\frac{\cos(z)}{\sin(z)} = \lim_{z \to \pi} \frac{(z-\pi)}{\sin(z)} \cos(z) $$
由于 $\lim_{z \to \pi} \frac{z-\pi}{\sin(z)} = \lim_{u \to 0} \frac{u}{\sin(u+\pi)} = \lim_{u \to 0} \frac{u}{-\sin u} = -1$，且 $\lim_{z \to \pi} \cos(z) = -1$，故留数为 $(-1) \times (-1) = 1$。

### 商函数的核心计算公式

虽然极限公式在理论上很完美，但在实际计算中，尤其是当涉及到[洛必达法则](@entry_id:147503)时，过程可能较为繁琐。幸运的是，对于绝大多数以商形式出现的函数，有一个更为直接和高效的公式。

假设函数 $f(z)$ 可以表示为两个[解析函数](@entry_id:139584) $g(z)$ 和 $h(z)$ 的商，即 $f(z) = \frac{g(z)}{h(z)}$。如果 $z_0$ 是 $f(z)$ 的一个单极点，通常情况下这是因为分母 $h(z)$ 在 $z_0$ 处有一个**单零点**（simple zero），而分子 $g(z)$ 在该点不为零。也就是说，满足以下条件：
1.  $g(z_0) \neq 0$
2.  $h(z_0) = 0$
3.  $h'(z_0) \neq 0$ (此条件保证了 $z_0$ 是 $h(z)$ 的单零点)

在这些条件下，我们可以推导出留数的一个优雅公式。我们从极限公式出发：
$$ \operatorname{Res}(f; z_0) = \lim_{z \to z_0} (z-z_0) \frac{g(z)}{h(z)} = \lim_{z \to z_0} g(z) \cdot \lim_{z \to z_0} \frac{z-z_0}{h(z)} $$
由于 $h(z_0) = 0$，我们可以将第二个极限重写为：
$$ \lim_{z \to z_0} \frac{z-z_0}{h(z)} = \lim_{z \to z_0} \frac{1}{\frac{h(z) - h(z_0)}{z-z_0}} $$
分母的表达式正是导数 $h'(z_0)$ 的定义。因此，
$$ \lim_{z \to z_0} \frac{1}{\frac{h(z) - h(z_0)}{z-z_0}} = \frac{1}{h'(z_0)} $$
结合起来，我们便得到了这个极其有用的公式：
$$ \operatorname{Res}(f; z_0) = \frac{g(z_0)}{h'(z_0)} $$

这个公式的强大之处在于它将留数的计算转化为了简单的函数求值和求导，完全避免了[计算极限](@entry_id:138209)或者进行繁琐的洛朗展开。

### 公式的广泛应用

下面我们将通过一系列例子，展示如何应用 $\frac{g(z_0)}{h'(z_0)}$ 这个公式来处理各种类型的函数。

#### [有理函数](@entry_id:154279)与多项式分母

当函数的分母是多项式时，情况最为直接。考虑一个函数 $f(z) = \frac{1}{P(z)}$，其中 $P(z)$ 是一个 $n$ 次多项式，其根 $z_1, z_2, \dots, z_n$ 都是单根。对于任意一个根 $z_k$，它都是 $f(z)$ 的单极点。这里，$g(z)=1$，$h(z)=P(z)$。应用我们的公式，可以立即得到一个普适性的结论 [@problem_id:2241826]：
$$ \operatorname{Res}(f; z_k) = \frac{g(z_k)}{h'(z_k)} = \frac{1}{P'(z_k)} $$

让我们看一个具体的例子。考虑函数 $f(z) = \frac{\exp(cz)}{z^2 + a^2}$，其中 $a>0$ 是实常数，$c$ 是非零实常数 [@problem_id:2241840]。该[函数的极点](@entry_id:189069)由分母 $z^2+a^2=0$ 决定，即 $z = \pm ia$。这两个都是单极点。假设我们关心位于[上半平面](@entry_id:199119)的极点 $z_0 = ia$。这里，$g(z) = \exp(cz)$，$h(z) = z^2+a^2$。分母的导数是 $h'(z)=2z$。因此，留数为：
$$ \operatorname{Res}(f; ia) = \frac{g(ia)}{h'(ia)} = \frac{\exp(c(ia))}{2(ia)} = \frac{\exp(iac)}{2ia} $$
这个形式在通过[围道积分](@entry_id:169446)计算[傅里叶变换](@entry_id:142120)类型的积[分时](@entry_id:274419)非常常见。

再比如函数 $f(z) = \frac{z \exp(i \pi z)}{2z + i}$ [@problem_id:2241800]。其唯一的[奇点](@entry_id:137764)在分母为零处，即 $2z+i=0$，解得 $z_0 = -\frac{i}{2}$。这是一个单极点。令 $g(z)=z \exp(i \pi z)$ 和 $h(z)=2z+i$。易得 $h'(z)=2$。于是留数为：
$$ \operatorname{Res}\left(f; -\frac{i}{2}\right) = \frac{g(-i/2)}{h'(-i/2)} = \frac{(-i/2) \exp(i\pi(-i/2))}{2} = \frac{(-i/2)\exp(\pi/2)}{2} = -\frac{i}{4}\exp\left(\frac{\pi}{2}\right) $$

#### 三角函数、[指数函数](@entry_id:161417)与[双曲函数](@entry_id:165175)

我们的公式同样适用于分母为[超越函数](@entry_id:271750)的情形。这类函数的零点常常呈周期性[分布](@entry_id:182848)，从而导致无穷多个极点。

我们再次审视 $f(z) = \cot(z) = \frac{\cos(z)}{\sin(z)}$ [@problem_id:2241827]。它的极点是所有满足 $\sin(z)=0$ 的点，即 $z_n = n\pi$，$n$ 为任意整数。我们来验证这些都是单极点。令 $g(z)=\cos(z)$，$h(z)=\sin(z)$。则 $h'(z)=\cos(z)$。在 $z_n=n\pi$ 处，$h(z_n)=\sin(n\pi)=0$，而 $h'(z_n)=\cos(n\pi)=(-1)^n \neq 0$。因此，所有这些点都是单极点。留数为：
$$ \operatorname{Res}(f; n\pi) = \frac{g(n\pi)}{h'(n\pi)} = \frac{\cos(n\pi)}{\cos(n\pi)} = 1 $$
这说明 $\cot(z)$ 在其所有极点处的留数都是 1。

另一个例子是 $f(z) = \frac{z}{1 - \exp(z)}$ [@problem_id:2241795]。极点满足 $\exp(z) = 1$，即 $z_k = 2k\pi i$，$k$ 为整数。当 $k=0$ 时，$z_0=0$ 是一个[可去奇点](@entry_id:175597)（因为分子也为零）。对于所有非零整数 $k$，这些点都是单极点。例如，我们计算在 $z_0 = 2\pi i$ 处的留数。这里 $g(z)=z$，$h(z)=1-\exp(z)$。$h'(z)=-\exp(z)$。留数为：
$$ \operatorname{Res}(f; 2\pi i) = \frac{g(2\pi i)}{h'(2\pi i)} = \frac{2\pi i}{-\exp(2\pi i)} = \frac{2\pi i}{-1} = -2\pi i $$

对于[双曲函数](@entry_id:165175)，方法完全相同。考虑 $f(z) = \operatorname{csch}(z) = \frac{1}{\sinh(z)}$ [@problem_id:2241844]。其极点在 $\sinh(z)=0$ 处，即 $z_n=n\pi i$ (其中 $n$ 为任意整数)。令 $g(z)=1$，$h(z)=\sinh(z)$，则 $h'(z)=\cosh(z)$。留数为 $\frac{1}{\cosh(n\pi i)}$。利用恒等式 $\cosh(ix)=\cos(x)$，我们得到：
$$ \operatorname{Res}(\operatorname{csch}; n\pi i) = \frac{1}{\cosh(n\pi i)} = \frac{1}{\cos(n\pi)} = \frac{1}{(-1)^n} = (-1)^n $$
这个优美的结果给出了在任意一个极点处的留数值。

#### 涉及[分支切割](@entry_id:174657)的函数

当函数中包含对数、根式等[多值函数](@entry_id:165813)时，我们必须格外小心。在计算留数之前，必须明确函数所使用的**分支**（branch）。通常，我们默认使用**[主分支](@entry_id:164844)**（principal branch）。

考虑函数 $f(z) = \frac{\log(z)}{z^2 + 4}$ [@problem_id:2241813]，其中 $\log(z)$ 表示对数函数的[主分支](@entry_id:164844)，其虚部（辐角）取值于 $(-\pi, \pi]$。该函数在[上半平面](@entry_id:199119)的极点是 $z_0=2i$。应用公式，留数为 $\frac{\log(2i)}{h'(2i)}$，其中 $h(z)=z^2+4$，$h'(z)=2z$。关键在于计算分子 $\log(2i)$。根据[主分支](@entry_id:164844)的定义，对于 $z=r\exp(i\theta)$，有 $\log(z) = \ln|z| + i\operatorname{Arg}(z)$。对于 $z=2i$，其极坐标表示为 $2\exp(i\frac{\pi}{2})$。因此，$|2i|=2$，[主辐角](@entry_id:171517) $\operatorname{Arg}(2i)=\frac{\pi}{2}$。所以，
$$ \log(2i) = \ln(2) + i\frac{\pi}{2} $$
代入[留数公式](@entry_id:176966)：
$$ \operatorname{Res}(f; 2i) = \frac{\ln(2) + i\frac{\pi}{2}}{2(2i)} = \frac{\ln(2) + i\frac{\pi}{2}}{4i} = \frac{\pi}{8} - i\frac{\ln 2}{4} $$

类似地，对于带有根号的函数 $f(z) = \frac{\sqrt{z}}{z^2 + 4}$，其中 $\sqrt{z}$ 也是[主分支](@entry_id:164844) [@problem_id:2241822]。在极点 $z_0=2i$ 处的留数是 $\frac{\sqrt{2i}}{4i}$。我们需要计算 $\sqrt{2i}$ 的[主值](@entry_id:189577)。对于 $z=r\exp(i\theta)$，[主平方根](@entry_id:180892)定义为 $\sqrt{z} = \sqrt{r}\exp(i\theta/2)$。由于 $2i = 2\exp(i\frac{\pi}{2})$，我们有：
$$ \sqrt{2i} = \sqrt{2}\exp\left(i\frac{\pi}{4}\right) = \sqrt{2}\left(\cos\frac{\pi}{4} + i\sin\frac{\pi}{4}\right) = \sqrt{2}\left(\frac{1}{\sqrt{2}} + i\frac{1}{\sqrt{2}}\right) = 1+i $$
因此，留数为：
$$ \operatorname{Res}(f; 2i) = \frac{1+i}{4i} = \frac{(1+i)(-i)}{4i(-i)} = \frac{-i-i^2}{4} = \frac{1-i}{4} $$

### 高级原理与推广

#### 公式的抽象应用

值得强调的是，[留数公式](@entry_id:176966) $\frac{g(z_0)}{h'(z_0)}$ 体现了一种深刻的**局部性**。留数的值只依赖于函数在[奇点](@entry_id:137764) $z_0$ 处的局部信息，即分子在该点的值和分母导数在该点的值，而与函数在其他地方的复杂形式无关。

我们可以通过一个抽象的例子来体会这一点 [@problem_id:2241852]。假设一个函数 $f(z) = \frac{g(z)}{h(z)}$，我们只知道 $h(z)$ 在 $z_0=i$ 有一个单零点，并且 $g(i) = 2\exp(i\frac{\pi}{2})$ 和 $h'(i) = 1+i$。我们无需知道 $g(z)$ 和 $h(z)$ 的完整表达式，就可以直接计算留数：
$$ \operatorname{Res}(f; i) = \frac{g(i)}{h'(i)} = \frac{2\exp(i\pi/2)}{1+i} $$
利用欧拉公式 $\exp(i\pi/2) = i$，我们得到：
$$ \operatorname{Res}(f; i) = \frac{2i}{1+i} = \frac{2i(1-i)}{(1+i)(1-i)} = \frac{2i - 2i^2}{1^2 - i^2} = \frac{2i+2}{2} = 1+i $$
这个例子清晰地表明，留数是一个高度局域化的量。

#### [复合函数](@entry_id:147347)的留数：一种“链式法则”

最后，我们探讨一个更高级的话题：如何计算[复合函数](@entry_id:147347)的留数。这可以被看作是[留数计算](@entry_id:174587)的“[链式法则](@entry_id:190743)”。

考虑一个复合函数 $h(z) = g(f(z))$ [@problem_id:2241838]。假设我们知道：
1.  外部函数 $g(w)$ 在 $w=0$ 处有一个单极点，其留数为 $\operatorname{Res}(g; 0) = R_g$。
2.  内部函数 $f(z)$ 在 $z_0$ 处有一个单零点，即 $f(z_0)=0$ 且 $f'(z_0) \neq 0$。

那么，$h(z)$ 在 $z_0$ 处的行为是怎样的呢？由于当 $z \to z_0$ 时 $f(z) \to 0$，而 $g(w)$ 在 $w=0$ 处发散，因此 $h(z)$ 在 $z_0$ 处有一个[奇点](@entry_id:137764)。为了求其留数，我们可以分析函数的结构。

$g(w)$ 在 $w=0$ 附近的洛朗展开为 $g(w) = \frac{R_g}{w} + \phi(w)$，其中 $\phi(w)$ 是在 $w=0$ 处的解析部分。将 $w=f(z)$ 代入，得到：
$$ h(z) = g(f(z)) = \frac{R_g}{f(z)} + \phi(f(z)) $$
由于 $f(z_0)=0$ 且 $\phi(w)$ 在 $w=0$ 处解析，复合函数 $\phi(f(z))$ 在 $z_0$ 处是解析的。因此，它对 $h(z)$ 在 $z_0$ 处的留数没有贡献。所有的奇异性都来自于第一项 $\frac{R_g}{f(z)}$。所以：
$$ \operatorname{Res}(h; z_0) = \operatorname{Res}\left(\frac{R_g}{f(z)}; z_0\right) = R_g \cdot \operatorname{Res}\left(\frac{1}{f(z)}; z_0\right) $$
现在问题转化为求 $\frac{1}{f(z)}$ 在 $z_0$ 的留数。这是一个商函数的形式，分子是常数1，分母是 $f(z)$。根据我们的主公式，它的留数是 $\frac{1}{f'(z_0)}$。

综上，我们得到了一个非常优雅的结果：
$$ \operatorname{Res}(g(f(z)); z_0) = \frac{\operatorname{Res}(g; 0)}{f'(z_0)} $$

例如，若 $g(w)$ 在 $w=0$ 有留数 $R_g$，而 $f(z)=z\cos(z)$，我们想求 $h(z)=g(f(z))$ 在 $z_0 = \pi/2$ 的留数。首先，$f(\pi/2) = (\pi/2)\cos(\pi/2)=0$。其次， $f'(z) = \cos(z) - z\sin(z)$，所以 $f'(\pi/2) = \cos(\pi/2) - (\pi/2)\sin(\pi/2) = -\frac{\pi}{2} \neq 0$。这是一个单零点。应用上述公式：
$$ \operatorname{Res}(h; \pi/2) = \frac{R_g}{f'(\pi/2)} = \frac{R_g}{-\pi/2} = -\frac{2R_g}{\pi} $$
这个结论优雅地连接了内外函数的性质，是[留数理论](@entry_id:164118)深刻内在结构的又一体现。