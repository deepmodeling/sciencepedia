{"hands_on_practices": [{"introduction": "微分几何中的概念，如参数化曲线及其导数，在计算机动画中有着直接的应用。这个练习将带你探索一个物体的运动如何直接影响其在场景中的视觉表现。通过计算沿圆形路径运动的圆盘的速度向量，并用其定义表面法线，我们将推导出其在特定光照模型下的亮度变化率[@problem_id:1623888]。", "problem": "在一个计算机生成的动画中，一个小的、扁平的、反光的圆盘在 $xy$ 平面上沿圆形路径运动。\n\n在时间 $t \\ge 0$ 时，圆盘中心的位置由向量 $\\vec{p}(t) = (R \\cos(\\omega t), R \\sin(\\omega t), 0)$ 给出，其中 $R$ 和 $\\omega$ 是分别表示半径和角频率的正常数。\n\n为了使动画逼真，圆盘的朝向使其表面法向量 $\\vec{n}(t)$ 始终指向其瞬时速度的方向。法向量 $\\vec{n}(t)$ 必须是一个单位向量。\n\n场景由一个位于位置 $\\vec{L} = (X_L, 0, H)$ 的单一、静止的点光源照亮，其中 $X_L$ 和 $H$ 是正常数。\n\n在像兰伯特反射模型这样的简单光照模型中，圆盘的感知亮度与圆盘的单位法向量和从圆盘指向光源的单位向量的点积成正比。设此亮度因子为 $B(t) = \\vec{n}(t) \\cdot \\vec{s}(t)$，其中 $\\vec{s}(t)$ 是从圆盘位置 $\\vec{p}(t)$ 指向光源 $\\vec{L}$ 的单位向量。\n\n推导亮度因子变化率 $\\frac{dB}{dt}$ 关于时间 $t$ 以及常数 $R, \\omega, X_L, H$ 的封闭形式解析表达式。", "solution": "圆盘的中心位于 $\\vec{p}(t) = \\left(R \\cos(\\omega t), R \\sin(\\omega t), 0\\right)$。其速度为\n$$\n\\vec{v}(t) = \\frac{d\\vec{p}}{dt} = \\left(-R \\omega \\sin(\\omega t), R \\omega \\cos(\\omega t), 0\\right),\n$$\n其大小为 $\\|\\vec{v}(t)\\| = R \\omega$。由于表面法向量 $\\vec{n}(t)$ 是一个指向速度方向的单位向量，\n$$\n\\vec{n}(t) = \\frac{\\vec{v}(t)}{\\|\\vec{v}(t)\\|} = \\left(-\\sin(\\omega t), \\cos(\\omega t), 0\\right).\n$$\n\n从圆盘到光源的向量是\n$$\n\\vec{r}(t) = \\vec{L} - \\vec{p}(t) = \\left(X_{L} - R \\cos(\\omega t), - R \\sin(\\omega t), H\\right),\n$$\n其长度为\n$$\nd(t) = \\|\\vec{r}(t)\\| = \\sqrt{\\left(X_{L} - R \\cos(\\omega t)\\right)^{2} + \\left(R \\sin(\\omega t)\\right)^{2} + H^{2}} = \\sqrt{X_{L}^{2} - 2 X_{L} R \\cos(\\omega t) + R^{2} + H^{2}}.\n$$\n因此，朝向光源的单位向量是\n$$\n\\vec{s}(t) = \\frac{\\vec{r}(t)}{d(t)}.\n$$\n\n亮度因子为 $B(t) = \\vec{n}(t) \\cdot \\vec{s}(t)$。计算点积：\n$$\nB(t) = \\frac{\\left(-\\sin(\\omega t), \\cos(\\omega t), 0\\right) \\cdot \\left(X_{L} - R \\cos(\\omega t), - R \\sin(\\omega t), H\\right)}{d(t)}.\n$$\n分子可简化为\n$$\n-\\sin(\\omega t)\\left(X_{L} - R \\cos(\\omega t)\\right) + \\cos(\\omega t)\\left(- R \\sin(\\omega t)\\right) = - X_{L} \\sin(\\omega t),\n$$\n所以\n$$\nB(t) = \\frac{- X_{L} \\sin(\\omega t)}{d(t)} = \\frac{- X_{L} \\sin(\\omega t)}{\\sqrt{X_{L}^{2} - 2 X_{L} R \\cos(\\omega t) + R^{2} + H^{2}}}.\n$$\n\n使用商法则（或乘积法则）对 $B(t)$ 求导。设 $A(t) = - X_{L} \\sin(\\omega t)$ 且 $g(t) = X_{L}^{2} - 2 X_{L} R \\cos(\\omega t) + R^{2} + H^{2}$，所以 $d(t) = \\sqrt{g(t)}$。那么\n$$\nA'(t) = - X_{L} \\omega \\cos(\\omega t),\n$$\n且\n$$\ng'(t) = 2 X_{L} R \\omega \\sin(\\omega t), \\quad d'(t) = \\frac{g'(t)}{2 \\sqrt{g(t)}} = \\frac{X_{L} R \\omega \\sin(\\omega t)}{d(t)}.\n$$\n使用 $B = A/d$，\n$$\n\\frac{dB}{dt} = \\frac{A'}{d} - \\frac{A d'}{d^{2}} = \\frac{- X_{L} \\omega \\cos(\\omega t)}{d(t)} + \\frac{X_{L}^{2} R \\omega \\sin^{2}(\\omega t)}{d(t)^{3}}.\n$$\n合并到公分母 $d(t)^{3}$ 下，并代入 $d(t)^{2} = g(t)$：\n$$\n\\frac{dB}{dt} = \\frac{- X_{L} \\omega \\cos(\\omega t)\\, g(t) + X_{L}^{2} R \\omega \\sin^{2}(\\omega t)}{g(t)^{\\frac{3}{2}}}.\n$$\n展开并使用 $\\sin^{2}(\\omega t) = 1 - \\cos^{2}(\\omega t)$ 简化分子，得到\n$$\n\\frac{dB}{dt} = \\frac{X_{L} \\omega \\left[ - \\left( X_{L}^{2} + R^{2} + H^{2} \\right) \\cos(\\omega t) + X_{L} R \\left( 1 + \\cos^{2}(\\omega t) \\right) \\right]}{\\left( X_{L}^{2} - 2 X_{L} R \\cos(\\omega t) + R^{2} + H^{2} \\right)^{\\frac{3}{2}}}.\n$$\n这就是亮度因子变化率关于时间 $t$ 以及常数 $R, \\omega, X_{L}, H$ 的封闭形式解析表达式。", "answer": "$$\\boxed{\\frac{X_{L} \\omega \\left[ - \\left( X_{L}^{2} + R^{2} + H^{2} \\right) \\cos(\\omega t) + X_{L} R \\left( 1 + \\cos^{2}(\\omega t) \\right) \\right]}{\\left( X_{L}^{2} - 2 X_{L} R \\cos(\\omega t) + R^{2} + H^{2} \\right)^{\\frac{3}{2}}}}$$", "id": "1623888"}, {"introduction": "在计算机图形学中，将二维纹理贴到三维模型上是一项基本任务，但几何变换常常会引起不希望的视觉畸变。这个实践将帮助你理解这种畸变是如何产生的，以及如何用微分几何的语言来量化它。我们将研究一个简单的旋转和缩放变换如何改变纹理空间中的切向量，并计算这些变换后向量之间的夹角，从而揭示纹理被拉伸或剪切的程度[@problem_id:1623913]。", "problem": "在计算机图形学中，一项基本任务是将二维纹理映射到三维表面上。结果的视觉质量在很大程度上取决于此映射如何扭曲原始纹理。考虑一个简单的场景，其中一个由纹理空间中的坐标 $(u, v)$ 参数化的二维纹理被应用到三维世界空间中的一个平面上。\n\n从纹理点 $P_{tex} = (u,v,0)$ 到世界点 $P_{world}$ 的映射通过两个连续的几何变换发生：\n1.  绕 z 轴旋转角度 $\\theta$ 的旋转变换 $R$。\n2.  一个非均匀缩放变换 $S$，沿 x 轴的缩放因子为 $s_x$，沿 y 轴的缩放因子为 $s_y$。沿 z 轴的缩放因子为 1。\n\n总变换由复合变换 $P_{world} = S \\cdot (R \\cdot P_{tex})$ 给出。最终表面上纹理的局部扭曲由纹理空间正交基向量的变换来表征。这些变换后的向量是切向量 $\\mathbf{T}_u = \\frac{\\partial P_{world}}{\\partial u}$ 和 $\\mathbf{T}_v = \\frac{\\partial P_{world}}{\\partial v}$，它们描述了纹理网格在世界空间平面上是如何被拉伸和剪切的。\n\n求这两个变换后的基向量 $\\mathbf{T}_u$ 和 $\\mathbf{T}_v$ 之间夹角 $\\phi$ 的余弦值。您的答案应该是一个用 $\\theta$、$s_x$ 和 $s_y$ 表示的符号表达式。", "solution": "设绕 z 轴旋转角度 $\\theta$ 的旋转矩阵为\n$$\nR=\\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta  0\\\\\n\\sin\\theta  \\cos\\theta  0\\\\\n0  0  1\n\\end{pmatrix},\n$$\n非均匀缩放矩阵为\n$$\nS=\\begin{pmatrix}\ns_{x}  0  0\\\\\n0  s_{y}  0\\\\\n0  0  1\n\\end{pmatrix}.\n$$\n一个纹理点为 $P_{tex}=(u,v,0)^{\\top}$。旋转后，\n$$\nR\\,P_{tex}=\\begin{pmatrix}\nu\\cos\\theta - v\\sin\\theta\\\\\nu\\sin\\theta + v\\cos\\theta\\\\\n0\n\\end{pmatrix}.\n$$\n缩放后，\n$$\nP_{world}=S\\,(R\\,P_{tex})=\\begin{pmatrix}\ns_{x}\\left(u\\cos\\theta - v\\sin\\theta\\right)\\\\\ns_{y}\\left(u\\sin\\theta + v\\cos\\theta\\right)\\\\\n0\n\\end{pmatrix}.\n$$\n切向量是关于 $u$ 和 $v$ 的偏导数：\n$$\n\\mathbf{T}_{u}=\\frac{\\partial P_{world}}{\\partial u}=\\begin{pmatrix}\ns_{x}\\cos\\theta\\\\\ns_{y}\\sin\\theta\\\\\n0\n\\end{pmatrix},\\qquad\n\\mathbf{T}_{v}=\\frac{\\partial P_{world}}{\\partial v}=\\begin{pmatrix}\n-\\,s_{x}\\sin\\theta\\\\\ns_{y}\\cos\\theta\\\\\n0\n\\end{pmatrix}.\n$$\n$\\mathbf{T}_{u}$ 和 $\\mathbf{T}_{v}$ 之间夹角 $\\phi$ 的余弦值为\n$$\n\\cos\\phi=\\frac{\\mathbf{T}_{u}\\cdot\\mathbf{T}_{v}}{\\|\\mathbf{T}_{u}\\|\\,\\|\\mathbf{T}_{v}\\|}.\n$$\n计算分子：\n$$\n\\mathbf{T}_{u}\\cdot\\mathbf{T}_{v}=(s_{x}\\cos\\theta)(-s_{x}\\sin\\theta)+(s_{y}\\sin\\theta)(s_{y}\\cos\\theta)=(s_{y}^{2}-s_{x}^{2})\\sin\\theta\\cos\\theta.\n$$\n计算范数：\n$$\n\\|\\mathbf{T}_{u}\\|=\\sqrt{s_{x}^{2}\\cos^{2}\\theta+s_{y}^{2}\\sin^{2}\\theta},\\qquad\n\\|\\mathbf{T}_{v}\\|=\\sqrt{s_{x}^{2}\\sin^{2}\\theta+s_{y}^{2}\\cos^{2}\\theta}.\n$$\n因此，\n$$\n\\cos\\phi=\\frac{(s_{y}^{2}-s_{x}^{2})\\sin\\theta\\cos\\theta}{\\sqrt{s_{x}^{2}\\cos^{2}\\theta+s_{y}^{2}\\sin^{2}\\theta}\\,\\sqrt{s_{x}^{2}\\sin^{2}\\theta+s_{y}^{2}\\cos^{2}\\theta}}.\n$$", "answer": "$$\\boxed{\\frac{(s_{y}^{2}-s_{x}^{2})\\sin\\theta\\cos\\theta}{\\sqrt{s_{x}^{2}\\cos^{2}\\theta+s_{y}^{2}\\sin^{2}\\theta}\\,\\sqrt{s_{x}^{2}\\sin^{2}\\theta+s_{y}^{2}\\cos^{2}\\theta}}}$$", "id": "1623913"}, {"introduction": "光滑曲面的微分几何理论如何应用于由离散三角形构成的网格模型？这个问题是数字几何处理领域的核心。本练习将向你介绍一种强大的工具——余切公式，用于计算三角网格上顶点的离san平均曲率，它为我们提供了一种量化表面局部弯曲程度的方法[@problem_id:1623928]。", "problem": "在数字几何处理领域，一种常见的方法是使用离散算子来近似一个由三角网格表示的光滑曲面的曲率。其中一种算子定义了顶点上的离散平均曲率向量。\n\n考虑三角网格上的一个顶点 $p_i$。其邻接点（通过边与 $p_i$ 相连的顶点）构成了它的 1-环邻域，记为 $j \\in N(i)$。顶点 $p_i$ 处的离散平均曲率向量 $\\vec{K}_i$ 定义为从 $p_i$ 指向其邻接点的向量的加权和：\n$$ \\vec{K}_i = \\sum_{j \\in N(i)} w_{ij} (p_j - p_i) $$\n与边 $(p_i, p_j)$ 相关联的权重 $w_{ij}$ 由“余切公式”给出：\n$$ w_{ij} = \\frac{1}{2} (\\cot \\alpha_{ij} + \\cot \\beta_{ij}) $$\n此处，$\\alpha_{ij}$ 和 $\\beta_{ij}$ 是与边 $(p_i, p_j)$ 相邻的两个三角形中，位于该边对面的两个角。\n\n给定一个中心顶点 $P_0$ 及其由三个顶点 $P_1, P_2, P_3$ 组成的 1-环邻域。这些顶点的坐标是：\n$P_0 = (0, 0, 1)$\n$P_1 = (\\sqrt{3}, 1, 0)$\n$P_2 = (-\\sqrt{3}, 1, 0)$\n$P_3 = (0, -2, 0)$\n\n这些顶点构成了三个在 $P_0$ 处相交的三角形：$\\triangle P_0 P_1 P_2$、$\\triangle P_0 P_2 P_3$ 和 $\\triangle P_0 P_3 P_1$。\n\n计算顶点 $P_0$ 处的离散平均曲率向量 $\\vec{K}_0$ 的分量 $(K_x, K_y, K_z)$。请用精确值表示答案，不要使用小数近似值。", "solution": "我们使用给定的在 $P_{0}$ 处的离散平均曲率向量定义：\n$$\\vec{K}_{0}=\\sum_{j \\in \\{1,2,3\\}} w_{0j}\\,(P_{j}-P_{0}), \\quad w_{0j}=\\frac{1}{2}\\left(\\cot \\alpha_{0j}+\\cot \\beta_{0j}\\right),$$\n其中 $\\alpha_{0j}$ 和 $\\beta_{0j}$ 是两个相邻三角形中与边 $(P_{0},P_{j})$ 相对的角。对于由向量 $u$ 和 $v$ 在顶点 $V$ 处形成的角，我们计算\n$$\\cot \\angle(u,v)=\\frac{u \\cdot v}{|u \\times v|}.$$\n\n首先，列出所需的差向量：\n$$P_{0}=(0,0,1),\\quad P_{1}=(\\sqrt{3},1,0),\\quad P_{2}=(-\\sqrt{3},1,0),\\quad P_{3}=(0,-2,0),$$\n$$P_{1}-P_{0}=(\\sqrt{3},1,-1),\\quad P_{2}-P_{0}=(-\\sqrt{3},1,-1),\\quad P_{3}-P_{0}=(0,-2,-1),$$\n$$P_{0}-P_{2}=(\\sqrt{3},-1,1),\\quad P_{1}-P_{2}=(2\\sqrt{3},0,0),\\quad P_{0}-P_{3}=(0,2,1),\\quad P_{1}-P_{3}=(\\sqrt{3},3,0),$$\n$$P_{3}-P_{2}=(\\sqrt{3},-3,0),\\quad P_{3}-P_{1}=(-\\sqrt{3},-3,0).$$\n\n边 $(P_{0},P_{1})$：相邻三角形为 $P_{0}P_{1}P_{2}$ 和 $P_{0}P_{3}P_{1}$。\n- 在 $\\triangle P_{0}P_{1}P_{2}$ 中，位于 $P_{2}$ 的对角，由 $u=P_{0}-P_{2}=(\\sqrt{3},-1,1)$ 和 $v=P_{1}-P_{2}=(2\\sqrt{3},0,0)$ 形成：\n$$u \\cdot v=6,\\quad u \\times v=(0,2\\sqrt{3},2\\sqrt{3}),\\quad |u \\times v|=2\\sqrt{6},$$\n$$\\cot \\alpha_{01}=\\frac{6}{2\\sqrt{6}}=\\frac{\\sqrt{6}}{2}.$$\n- 在 $\\triangle P_{0}P_{3}P_{1}$ 中，位于 $P_{3}$ 的对角，由 $u=P_{0}-P_{3}=(0,2,1)$ 和 $v=P_{1}-P_{3}=(\\sqrt{3},3,0)$ 形成：\n$$u \\cdot v=6,\\quad u \\times v=(-3,\\sqrt{3},-2\\sqrt{3}),\\quad |u \\times v|=2\\sqrt{6},$$\n$$\\cot \\beta_{01}=\\frac{6}{2\\sqrt{6}}=\\frac{\\sqrt{6}}{2}.$$\n因此，\n$$w_{01}=\\frac{1}{2}\\left(\\frac{\\sqrt{6}}{2}+\\frac{\\sqrt{6}}{2}\\right)=\\frac{\\sqrt{6}}{2}.$$\n\n边 $(P_{0},P_{2})$：相邻三角形为 $P_{0}P_{1}P_{2}$ 和 $P_{0}P_{2}P_{3}$。\n- 在 $\\triangle P_{0}P_{1}P_{2}$ 中，位于 $P_{1}$ 的对角，由 $u=P_{0}-P_{1}=(-\\sqrt{3},-1,1)$ 和 $v=P_{2}-P_{1}=(-2\\sqrt{3},0,0)$ 形成：\n$$u \\cdot v=6,\\quad u \\times v=(0,-2\\sqrt{3},-2\\sqrt{3}),\\quad |u \\times v|=2\\sqrt{6},$$\n$$\\cot \\alpha_{02}=\\frac{6}{2\\sqrt{6}}=\\frac{\\sqrt{6}}{2}.$$\n- 在 $\\triangle P_{0}P_{2}P_{3}$ 中，位于 $P_{3}$ 的对角，由 $u=P_{0}-P_{3}=(0,2,1)$ 和 $v=P_{2}-P_{3}=(-\\sqrt{3},3,0)$ 形成：\n$$u \\cdot v=6,\\quad u \\times v=(-3,-\\sqrt{3},2\\sqrt{3}),\\quad |u \\times v|=2\\sqrt{6},$$\n$$\\cot \\beta_{02}=\\frac{6}{2\\sqrt{6}}=\\frac{\\sqrt{6}}{2}.$$\n因此，\n$$w_{02}=\\frac{1}{2}\\left(\\frac{\\sqrt{6}}{2}+\\frac{\\sqrt{6}}{2}\\right)=\\frac{\\sqrt{6}}{2}.$$\n\n边 $(P_{0},P_{3})$：相邻三角形为 $P_{0}P_{2}P_{3}$ 和 $P_{0}P_{3}P_{1}$。\n- 在 $\\triangle P_{0}P_{2}P_{3}$ 中，位于 $P_{2}$ 的对角，由 $u=P_{0}-P_{2}=(\\sqrt{3},-1,1)$ 和 $v=P_{3}-P_{2}=(\\sqrt{3},-3,0)$ 形成：\n$$u \\cdot v=6,\\quad u \\times v=(3,\\sqrt{3},-2\\sqrt{3}),\\quad |u \\times v|=2\\sqrt{6},$$\n$$\\cot \\alpha_{03}=\\frac{6}{2\\sqrt{6}}=\\frac{\\sqrt{6}}{2}.$$\n- 在 $\\triangle P_{0}P_{3}P_{1}$ 中，位于 $P_{1}$ 的对角，由 $u=P_{0}-P_{1}=(-\\sqrt{3},-1,1)$ 和 $v=P_{3}-P_{1}=(-\\sqrt{3},-3,0)$ 形成：\n$$u \\cdot v=6,\\quad u \\times v=(3,-\\sqrt{3},2\\sqrt{3}),\\quad |u \\times v|=2\\sqrt{6},$$\n$$\\cot \\beta_{03}=\\frac{6}{2\\sqrt{6}}=\\frac{\\sqrt{6}}{2}.$$\n因此，\n$$w_{03}=\\frac{1}{2}\\left(\\frac{\\sqrt{6}}{2}+\\frac{\\sqrt{6}}{2}\\right)=\\frac{\\sqrt{6}}{2}.$$\n\n因此所有三个权重都相等：$w_{01}=w_{02}=w_{03}=\\frac{\\sqrt{6}}{2}$。所以\n$$\\vec{K}_{0}=\\frac{\\sqrt{6}}{2}\\,\\big[(P_{1}-P_{0})+(P_{2}-P_{0})+(P_{3}-P_{0})\\big].$$\n计算总和：\n$$(P_{1}-P_{0})+(P_{2}-P_{0})+(P_{3}-P_{0})=(\\sqrt{3}-\\sqrt{3}+0,\\;1+1-2,\\;-1-1-1)=(0,0,-3).$$\n因此\n$$\\vec{K}_{0}=\\left(0,\\;0,\\;-\\frac{3\\sqrt{6}}{2}\\right).$$\n因此，使用精确值表示，其分量为 $K_{x}=0$，$K_{y}=0$，$K_{z}=-\\frac{3\\sqrt{6}}{2}$。", "answer": "$$\\boxed{\\begin{pmatrix}0  0  -\\frac{3\\sqrt{6}}{2}\\end{pmatrix}}$$", "id": "1623928"}]}