{"hands_on_practices": [{"introduction": "Building a species distribution model is only half the battle; the other half is critically evaluating its predictions. No model is perfect, so understanding the specific ways it can be wrong is essential for its responsible use. This first practice introduces two fundamental types of error—errors of commission and errors of omission—which help us interpret what a model's predictions mean in the real world, especially for conservation decisions [@problem_id:1882310].", "problem": "A conservation biologist is using a Species Distribution Model (SDM), a tool that correlates species occurrence data with environmental variables to predict where a species is likely to be found. The target species is a rare and elusive snow leopard (*Panthera uncia*). The model generates a habitat suitability map, classifying the mountainous terrain into \"suitable\" and \"unsuitable\" areas. To validate the model's accuracy, the biologist compares the model's predictions with new field data.\n\nConsider the following two independent outcomes from the validation process:\n\n*   **Outcome 1:** The SDM predicted a remote valley as \"suitable\" habitat. However, a comprehensive field survey using camera traps over a one-year period fails to detect any presence of snow leopards in that valley.\n*   **Outcome 2:** A new, previously unknown population of snow leopards is discovered by local rangers in a mountain range that the SDM had classified as \"unsuitable\" habitat.\n\nWhich of the following statements correctly identifies the type of error represented by each outcome from the perspective of the SDM's predictions?\n\nA. Outcome 1 represents an error of omission, and Outcome 2 represents an error of commission.\n\nB. Outcome 1 represents an error of commission, and Outcome 2 represents an error of omission.\n\nC. Both Outcome 1 and Outcome 2 represent errors of omission.\n\nD. Both Outcome 1 and Outcome 2 represent errors of commission.", "solution": "Define the SDM prediction as $P \\in \\{\\text{suitable}, \\text{unsuitable}\\}$ and the field-validated reality as $R \\in \\{\\text{presence}, \\text{absence}\\}$. In model validation terminology:\n- An error of commission is a false positive: the model predicts suitable (or presence) where reality indicates absence. Symbolically, this is $P=\\text{suitable}$ with $R=\\text{absence}$.\n- An error of omission is a false negative: the model predicts unsuitable (or absence) where reality indicates presence. Symbolically, this is $P=\\text{unsuitable}$ with $R=\\text{presence}$.\n\nApply these definitions to each outcome:\n- Outcome 1: The SDM predicted suitable, but a comprehensive field survey failed to detect the species, which is taken as evidence of absence for validation. Thus $P=\\text{suitable}$ and $R=\\text{absence}$, which matches an error of commission.\n- Outcome 2: The SDM predicted unsuitable, yet rangers discovered a population, so $P=\\text{unsuitable}$ and $R=\\text{presence}$, which matches an error of omission.\n\nTherefore, Outcome 1 is an error of commission and Outcome 2 is an error of omission, corresponding to option B.", "answer": "$$\\boxed{B}$$", "id": "1882310"}, {"introduction": "The predictions of a species distribution model are only as good as the data used to build it. A common challenge is multicollinearity, where environmental variables are highly correlated with each other, which can confuse the model and make its results unreliable. This exercise guides you through a standard procedure for preparing your data by using the Variance Inflation Factor ($VIF$) to identify and remove these redundant variables before you begin modeling [@problem_id:1882322].", "problem": "An ecologist is developing a Species Distribution Model (SDM) for a rare alpine plant species. To avoid issues with multicollinearity, the ecologist decides to pre-process a set of four potential climatic predictor variables using a stepwise selection procedure based on the Variance Inflation Factor (VIF). The initial set of variables is:\n- $V_1$: Mean Annual Temperature\n- $V_2$: Total Annual Precipitation\n- $V_3$: Annual Temperature Range\n- $V_4$: Altitude\n\nThe VIF for a predictor variable $V_j$ is calculated as $VIF_j = \\frac{1}{1 - R^2_j}$, where $R^2_j$ is the coefficient of determination from a linear regression of $V_j$ against all other predictor variables in the current set.\n\nThe selection procedure is as follows:\n1. Calculate the VIF for all variables in the current set.\n2. Identify the variable with the highest VIF.\n3. If this highest VIF is greater than a threshold of 5.0, remove that variable from the set.\n4. Repeat the process with the remaining variables until all variables in the set have a VIF less than or equal to 5.0.\n\nThe following data from the linear regression analyses are available:\n\n**Round 1 (Set: {$V_1, V_2, V_3, V_4$}):**\n- Regression of $V_1$ on {$V_2, V_3, V_4$}: $R^2_1 = 0.980$\n- Regression of $V_2$ on {$V_1, V_3, V_4$}: $R^2_2 = 0.600$\n- Regression of $V_3$ on {$V_1, V_2, V_4$}: $R^2_3 = 0.750$\n- Regression of $V_4$ on {$V_1, V_2, V_3$}: $R^2_4 = 0.970$\n\nAfter removing the variable with the highest VIF from Round 1, the analysis is repeated.\n\n**Round 2 (Remaining variables):**\nLet the remaining variables be denoted as a new set. The coefficients of determination for this new set are:\n- Regression of $V_2$ on {$V_3, V_4$}: $R^2_2 = 0.450$\n- Regression of $V_3$ on {$V_2, V_4$}: $R^2_3 = 0.300$\n- Regression of $V_4$ on {$V_2, V_3$}: $R^2_4 = 0.820$\n\nAfter removing the variable with the highest VIF from Round 2, the analysis is repeated on the final pair of variables.\n\n**Round 3 (Final pair):**\n- The coefficient of determination for the regression between the two remaining variables is 0.200.\n\nBased on this stepwise procedure, which set of variables should be retained for the final model?\n\nA. {$V_1, V_2$}\n\nB. {$V_2, V_3$}\n\nC. {$V_2, V_4$}\n\nD. {$V_1, V_3, V_4$}\n\nE. {$V_2, V_3, V_4$}", "solution": "The problem asks us to perform a stepwise variable selection using the Variance Inflation Factor (VIF) with a removal threshold of 5.0. The VIF for a variable $V_j$ is given by $VIF_j = \\frac{1}{1 - R^2_j}$.\n\n**Round 1: Initial set {$V_1, V_2, V_3, V_4$}**\n\nFirst, we calculate the VIF for each of the four initial variables using the provided $R^2$ values.\n\nFor $V_1$:\n$VIF_1 = \\frac{1}{1 - R^2_1} = \\frac{1}{1 - 0.980} = \\frac{1}{0.020} = 50.0$\n\nFor $V_2$:\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.600} = \\frac{1}{0.400} = 2.5$\n\nFor $V_3$:\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.750} = \\frac{1}{0.250} = 4.0$\n\nFor $V_4$:\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.970} = \\frac{1}{0.030} \\approx 33.33$\n\nThe calculated VIF values are: $VIF_1 = 50.0$, $VIF_2 = 2.5$, $VIF_3 = 4.0$, and $VIF_4 \\approx 33.33$.\n\nAccording to the procedure, we identify the variable with the highest VIF. This is $V_1$, with $VIF_1 = 50.0$.\nWe then compare this value to the threshold of 5.0. Since $50.0 > 5.0$, we must remove variable $V_1$.\n\nThe set of remaining variables for the next round is {$V_2, V_3, V_4$}.\n\n**Round 2: Set {$V_2, V_3, V_4$}**\n\nNow we repeat the process for the remaining variables using the $R^2$ values provided for Round 2. Note that the problem statement for Round 2 is self-contained and does not require us to know which variable was removed, but our step-by-step derivation has identified it as $V_1$, so the new regressions are for $V_2$ on {$V_3, V_4$}, $V_3$ on {$V_2, V_4$}, and $V_4$ on {$V_2, V_3$}.\n\nFor $V_2$:\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.450} = \\frac{1}{0.550} \\approx 1.82$\n\nFor $V_3$:\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.300} = \\frac{1}{0.700} \\approx 1.43$\n\nFor $V_4$:\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.820} = \\frac{1}{0.180} \\approx 5.56$\n\nThe new VIF values are: $VIF_2 \\approx 1.82$, $VIF_3 \\approx 1.43$, and $VIF_4 \\approx 5.56$.\n\nThe variable with the highest VIF in this set is $V_4$, with $VIF_4 \\approx 5.56$.\nWe compare this to the threshold: $5.56 > 5.0$. Therefore, we must remove variable $V_4$.\n\nThe set of remaining variables is {$V_2, V_3$}.\n\n**Round 3: Set {$V_2, V_3$}**\n\nFinally, we analyze the last remaining pair of variables, {$V_2, V_3$}. When there are only two variables, the VIF is the same for both. The $R^2$ for the regression of $V_2$ on $V_3$ is the same as the $R^2$ for the regression of $V_3$ on $V_2$. The problem states this value is 0.200.\n\nThe VIF for both remaining variables is:\n$VIF_{final} = \\frac{1}{1 - 0.200} = \\frac{1}{0.800} = 1.25$\n\nWe check if this VIF value is greater than the threshold of 5.0. Since $1.25 \\le 5.0$, the condition for removal is not met. The stepwise procedure stops.\n\nThe final set of variables to be retained for the model is {$V_2, V_3$}. This corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1882322"}, {"introduction": "Once you have built a model with a carefully selected set of variables, you need to quantify its performance. While we can describe errors qualitatively, metrics like the Area Under the Curve ($AUC$) and the True Skill Statistic ($TSS$) provide a standardized, quantitative measure of predictive accuracy. This practice will have you calculate these two vital metrics, demonstrating how to assess a model's ability to distinguish suitable from unsuitable habitat and evaluate its performance at a specific classification threshold [@problem_id:1882368].", "problem": "An ecologist is developing a Species Distribution Model (SDM) for a newly discovered and critically rare deep-sea coral, *Corallium profundum*. The species has only been observed at nine distinct locations. Due to this extremely small sample size, the ecologist is concerned about model overfitting and chooses a leave-one-out cross-validation approach for model evaluation.\n\nIn this procedure, for each of the nine presence points, a model is trained on the other eight points and then used to predict the habitat suitability (a value from 0 to 1) for the single point that was left out. The predicted habitat suitability scores for the nine presence points are:\n{0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81, 0.75, 0.70}\n\nTo evaluate the model's ability to distinguish suitable from unsuitable habitat, the model also predicts suitability for 1000 random 'background' points, which represent the range of environmental conditions in the study area. The evaluation will use two metrics: the Area Under the Curve (AUC) of the Receiver Operating Characteristic (ROC) curve and the True Skill Statistic (TSS).\n\nFor the AUC calculation, the following data is available. It shows, for each of the nine presence point scores, how many of the 1000 background points had a lower predicted suitability score.\n- For a score of 0.99, 995 background points scored lower.\n- For a score of 0.98, 980 background points scored lower.\n- For a score of 0.96, 960 background points scored lower.\n- For a score of 0.94, 930 background points scored lower.\n- For a score of 0.90, 890 background points scored lower.\n- For a score of 0.85, 840 background points scored lower.\n- For a score of 0.81, 785 background points scored lower.\n- For a score of 0.75, 700 background points scored lower.\n- For a score of 0.70, 670 background points scored lower.\n\nThe AUC can be calculated as the average proportion of background points that have a lower score than a given presence point.\n\nFor the TSS calculation, the continuous suitability scores must be converted to binary predictions (presence/absence) using a threshold. The ecologist uses a threshold of $T = 0.80$. Any location with a score greater than 0.80 is predicted as 'presence', and any location with a score less than or equal to 0.80 is predicted as 'absence'. From the model predictions on the 1000 background points, it was found that 220 of them had a suitability score greater than 0.80.\n\nThe TSS is calculated as: $TSS = \\text{Sensitivity} + \\text{Specificity} - 1$.\n- Sensitivity (or True Positive Rate) is the proportion of actual presence sites correctly predicted as presence.\n- Specificity (or True Negative Rate) is the proportion of actual absence (background) sites correctly predicted as absence.\n\nBased on the data provided, calculate the values for AUC and TSS. Round both final values to three significant figures. Which of the following statements is correct?\n\nA. The AUC is 0.861 and the TSS is 0.558.\n\nB. The AUC is 0.861 and the TSS is 0.635.\n\nC. The AUC is 0.775 and the TSS is 0.558.\n\nD. The AUC is 0.900 and the TSS is 0.778.\n\nE. The AUC is 0.850 and the TSS is 0.780.", "solution": "The goal is to calculate two model performance metrics, the Area Under the Curve (AUC) and the True Skill Statistic (TSS), based on the provided species distribution model outputs.\n\n**Step 1: Calculate the Area Under the Curve (AUC)**\n\nThe problem states that the AUC can be calculated as the average proportion of background points that have a lower score than a given presence point. We have 9 presence points and 1000 background points.\n\nFor each of the 9 presence point scores, we are given the number of background points with a lower score. We first find the proportion for each presence point and then average these proportions.\n\nThe proportions are:\n- For the score of 0.99: $995 / 1000 = 0.995$\n- For the score of 0.98: $980 / 1000 = 0.980$\n- For the score of 0.96: $960 / 1000 = 0.960$\n- For the score of 0.94: $930 / 1000 = 0.930$\n- For the score of 0.90: $890 / 1000 = 0.890$\n- For the score of 0.85: $840 / 1000 = 0.840$\n- For the score of 0.81: $785 / 1000 = 0.785$\n- For the score of 0.75: $700 / 1000 = 0.700$\n- For the score of 0.70: $670 / 1000 = 0.670$\n\nNow, we calculate the average of these proportions:\n$$ \\text{AUC} = \\frac{0.995 + 0.980 + 0.960 + 0.930 + 0.890 + 0.840 + 0.785 + 0.700 + 0.670}{9} $$\nThe sum of the proportions is:\n$$ \\text{Sum} = 7.750 $$\nThe average is:\n$$ \\text{AUC} = \\frac{7.750}{9} \\approx 0.86111... $$\nRounding to three significant figures, we get $\\text{AUC} = 0.861$.\n\n**Step 2: Calculate the True Skill Statistic (TSS)**\n\nThe TSS calculation requires classifying the continuous predictions into binary outcomes (presence/absence) using the given threshold of $T = 0.80$.\n$TSS = \\text{Sensitivity} + \\text{Specificity} - 1$.\n\nFirst, we need to build a confusion matrix by determining the number of True Positives (TP), False Negatives (FN), True Negatives (TN), and False Positives (FP).\n\n**Analysis of Presence Data:**\nWe have 9 actual presence sites with the following scores: {0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81, 0.75, 0.70}.\n- A site is predicted as 'presence' if its score is $> 0.80$.\n- A site is predicted as 'absence' if its score is $\\le 0.80$.\n\nThe scores greater than 0.80 are {0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81}. There are 7 such scores. These are the True Positives (TP).\n$$ \\text{TP} = 7 $$\nThe scores less than or equal to 0.80 are {0.75, 0.70}. There are 2 such scores. These are the False Negatives (FN), i.e., actual presences incorrectly predicted as absences.\n$$ \\text{FN} = 2 $$\nThe total number of actual presence sites is $N_{presence} = TP + FN = 7 + 2 = 9$.\n\n**Analysis of Background (Absence) Data:**\nWe have 1000 background points, which we treat as absences for this evaluation.\n- The problem states that 220 of the background points had a suitability score greater than 0.80. These are actual absences incorrectly predicted as presences, so they are False Positives (FP).\n$$ \\text{FP} = 220 $$\n- The remaining background points must have a score less than or equal to 0.80. These are correctly predicted as absences, so they are True Negatives (TN).\n$$ \\text{TN} = 1000 - \\text{FP} = 1000 - 220 = 780 $$\nThe total number of actual absence sites is $N_{absence} = FP + TN = 220 + 780 = 1000$.\n\n**Step 3: Calculate Sensitivity, Specificity, and TSS**\n\n- **Sensitivity** (True Positive Rate) = $\\frac{\\text{TP}}{N_{presence}} = \\frac{7}{9}$\n- **Specificity** (True Negative Rate) = $\\frac{\\text{TN}}{N_{absence}} = \\frac{780}{1000} = 0.78$\n\nNow, we can calculate the TSS:\n$$ \\text{TSS} = \\text{Sensitivity} + \\text{Specificity} - 1 $$\n$$ \\text{TSS} = \\frac{7}{9} + 0.78 - 1 $$\n$$ \\text{TSS} \\approx 0.7777... + 0.78 - 1 = 1.5577... - 1 = 0.5577... $$\nRounding to three significant figures, we get $\\text{TSS} = 0.558$.\n\n**Conclusion**\n\nThe calculated values are $\\text{AUC} \\approx 0.861$ and $\\text{TSS} \\approx 0.558$. Comparing these with the given options, we find that option A matches our results.\n- A. The AUC is 0.861 and the TSS is 0.558.\n- B. The AUC is 0.861 and the TSS is 0.635.\n- C. The AUC is 0.775 and the TSS is 0.558.\n- D. The AUC is 0.900 and the TSS is 0.778.\n- E. The AUC is 0.850 and the TSS is 0.780.\n\nThe correct option is A.", "answer": "$$\\boxed{A}$$", "id": "1882368"}]}