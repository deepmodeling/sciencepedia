{"hands_on_practices": [{"introduction": "Bioinformatics often serves as a bridge between experimental data and biological identity. In the field of proteomics, one of the most fundamental tasks is identifying an unknown protein from a sample. This exercise simulates the computational core of a classic technique called Peptide Mass Fingerprinting (PMF), where you will use a set of experimentally measured peptide masses to computationally sift through candidate protein sequences [@problem_id:2281806]. By performing an *in silico* digestion and calculating theoretical peptide masses, you will practice the logical, step-by-step problem-solving that is essential for analyzing high-throughput biological data.", "problem": "In a proteomics laboratory, an unknown protein is isolated and analyzed using mass spectrometry. The first step involves digesting the protein with a specific protease enzyme. The resulting mixture of smaller peptides is then introduced into a mass spectrometer, which measures the mass-to-charge ratio of each peptide, allowing for the determination of their individual masses. This technique is known as Peptide Mass Fingerprinting (PMF).\n\nYour task is to identify the unknown protein from a list of candidates based on the experimental data.\n\n**Experimental Data and Conditions:**\n1.  The mass spectrometer analysis yielded a list of peptide masses: `[289, 607, 638]`. All masses are in Daltons (Da).\n2.  The protein was digested with trypsin, an enzyme that cleaves the peptide bond on the C-terminal side of (i.e., immediately after) every Arginine (R) and Lysine (K) residue. Assume the digestion proceeds to completion, meaning a cut occurs at every possible site.\n3.  The mass of a peptide is calculated as the sum of the average integer masses of its constituent amino acid residues, plus the mass of one water molecule (H2O, mass 18 Da) to account for the terminal groups.\n4.  The average integer masses (in Da) for the 20 common amino acids are provided in the table below:\n\n| Amino Acid | 1-Letter Code | Mass (Da) | Amino Acid | 1-Letter Code | Mass (Da) |\n| :--- | :---: | :---: | :--- | :---: | :---: |\n| Alanine | A | 71 | Leucine | L | 113 |\n| Arginine | R | 156 | Lysine | K | 128 |\n| Asparagine | N | 114 | Methionine | M | 131 |\n| Aspartic Acid | D | 115 | Phenylalanine | F | 147 |\n| Cysteine | C | 103 | Proline | P | 97 |\n| Glutamic Acid | E | 129 | Serine | S | 87 |\n| Glutamine | Q | 128 | Threonine | T | 101 |\n| Glycine | G | 57 | Tryptophan | W | 186 |\n| Histidine | H | 137 | Tyrosine | Y | 163 |\n| Isoleucine | I | 113 | Valine | V | 99 |\n\n**Candidate Protein Sequences:**\nBelow are four candidate protein sequences, represented by their one-letter amino acid codes.\n\n*   **Protein A:** `M-S-D-Q-K-G-F-I-F-R-A-T-V`\n*   **Protein B:** `G-L-V-K-M-A-T-R-S-P-Y`\n*   **Protein C:** `A-G-Q-R-M-S-D-Q-K-P-T-V`\n*   **Protein D:** `M-F-E-A-P-K-H-T-G-R-V-I`\n\nBased on the information provided, which of the candidate proteins is the unknown protein?\n\nA. Protein A\n\nB. Protein B\n\nC. Protein C\n\nD. Protein D", "solution": "Trypsin cleaves on the C-terminal side of every lysine (K) and arginine (R). With complete digestion, the sequence is segmented after every K or R that is not already the C-terminus. The mass of each peptide is computed as the sum of the integer residue masses plus one water mass to account for termini, i.e., for a peptide with residues of masses $m_{1},\\dots,m_{n}$, the peptide mass is\n$$\nM=\\left(\\sum_{i=1}^{n} m_{i}\\right)+18.\n$$\nThe observed peptide masses are $[289,607,638]$.\n\nEvaluate each candidate:\n\nProtein A: M-S-D-Q-K-G-F-I-F-R-A-T-V. Cleavage after K and R yields three peptides: MSDQK, GFIFFR, ATV.\nMasses:\n$$\nM(\\text{MSDQK})=(131+87+115+128+128)+18=589+18=607,\n$$\n$$\nM(\\text{GFIFFR})=(57+147+113+147+156)+18=620+18=638,\n$$\n$$\nM(\\text{ATV})=(71+101+99)+18=271+18=289.\n$$\nThese are exactly $[289,607,638]$.\n\nProtein B: G-L-V-K-M-A-T-R-S-P-Y. Peptides: GLVK, MATR, SPY. Masses:\n$$\nM(\\text{GLVK})=(57+113+99+128)+18=397+18=415,\n$$\n$$\nM(\\text{MATR})=(131+71+101+156)+18=459+18=477,\n$$\n$$\nM(\\text{SPY})=(87+97+163)+18=347+18=365.\n$$\nNone match the observed set.\n\nProtein C: A-G-Q-R-M-S-D-Q-K-P-T-V. Peptides: AGQR, MSDQK, PTV. Masses:\n$$\nM(\\text{AGQR})=(71+57+128+156)+18=412+18=430,\n$$\n$$\nM(\\text{MSDQK})=(131+87+115+128+128)+18=589+18=607,\n$$\n$$\nM(\\text{PTV})=(97+101+99)+18=297+18=315.\n$$\nOnly one observed mass (607) appears; the others do not.\n\nProtein D: M-F-E-A-P-K-H-T-G-R-V-I. Peptides: MFEAPK, HTGR, VI. Masses:\n$$\nM(\\text{MFEAPK})=(131+147+129+71+97+128)+18=703+18=721,\n$$\n$$\nM(\\text{HTGR})=(137+101+57+156)+18=451+18=469,\n$$\n$$\nM(\\text{VI})=(99+113)+18=212+18=230.\n$$\nNo matches with the observed set.\n\nOnly Protein A reproduces all three observed peptide masses, so the unknown protein is Protein A.", "answer": "$$\\boxed{A}$$", "id": "2281806"}, {"introduction": "Beyond identifying what molecules are present, bioinformatics aims to uncover the complex web of interactions that regulate cellular life. This practice shifts our focus to gene regulation, specifically how tiny RNA molecules called microRNAs can silence genes by binding to messenger RNA (mRNA) [@problem_id:2281848]. You will step into the role of an algorithm designer, using a defined set of rules that mimic real-world prediction software to score potential target sites. This exercise demonstrates how multiple lines of evidence—such as seed region pairing, evolutionary conservation, and site accessibility—are integrated into a quantitative score to predict biological function.", "problem": "A computational biology team is investigating a newly discovered microRNA, `miR-Z`, and aims to predict its messenger RNA (mRNA) targets. Your task is to evaluate three potential target sites, located in the 3' Untranslated Regions (3' UTRs) of three different genes (GeneA, GeneB, and GeneC), using a simplified scoring algorithm. The site with the highest score is considered the most likely target.\n\n**Given Information:**\n\n1.  **`miR-Z` sequence (21 nucleotides):**\n    `5'-UCAGUGCUAUUGCACUUGGAC-3'`\n\n2.  **Candidate mRNA binding sites:** The sequences below are from the respective mRNAs, provided pre-aligned in the 3' to 5' orientation for direct comparison with the 5' to 3' `miR-Z` sequence.\n    -   **Site A (from GeneA):** `3'-AGUCACGACGUUGCGUGAACCUG-5'`\n    -   **Site B (from GeneB):** `3'-AGCCACGACAUAGCACGAACCUG-5'`\n    -   **Site C (from GeneC):** `3'-AGUCACGAUUUUCACUGAACCUG-5'`\n\n3.  **Site-specific parameters:**\n    -   **Site A:** Designated as \"Conserved\", with an Accessibility Penalty, `P_acc`, of 5.\n    -   **Site B:** Designated as \"Not conserved\", with an Accessibility Penalty, `P_acc`, of 15.\n    -   **Site C:** Designated as \"Conserved\", with an Accessibility Penalty, `P_acc`, of 2.\n\n**The Scoring Algorithm:**\n\nThe total binding score, `S`, for a `miR-Z`-mRNA interaction is calculated as:\n$$S = S_{\\text{seed}} + S_{\\text{3'prime}} + B_{\\text{cons}} - P_{\\text{acc}}$$\n\nThe calculation is governed by the following rules:\n\n-   **Rule 1 (Anchor Filter):** A valid target site *must* have an Adenine ('A') on the mRNA that pairs with nucleotide 1 of `miR-Z`. If this condition is not met, the site is invalid and is not scored.\n\n-   **Rule 2 (Seed Score, $S_{\\text{seed}}$):** This score evaluates the binding of `miR-Z` nucleotides 2 through 8 (the \"seed region\").\n    -   Perfect Watson-Crick (WC) pair (A-U or G-C): `+5` points per pair.\n    -   G-U \"wobble\" pair: `+2` points per pair.\n    -   Mismatch (any other pair): `-10` points per pair.\n\n-   **Rule 3 (3' Pairing Score, $S_{\\text{3'prime}}$):** This score evaluates the binding of `miR-Z` nucleotides 13 through 19.\n    -   WC or G-U wobble pair: `+2` points per pair.\n    -   Mismatch: `-1` point per pair.\n\n-   **Rule 4 (Conservation Bonus, $B_{\\text{cons}}$):** If the site is designated as \"Conserved,\" add `+10` points. Otherwise, add 0.\n\n-   **Rule 5 (Accessibility Penalty, $P_{\\text{acc}}$):** Subtract the given `P_acc` value for the site.\n\n**Question:**\n\nCalculate the binding score `S` for each of the three potential sites. Determine the most likely target for `miR-Z` by finding the site with the highest score. What is this maximum score? Your final answer should be a single integer.", "solution": "The mRNA sites are given in 3' to 5' orientation and are pre-aligned for direct, index-wise comparison with the 5' to 3' sequence of miR-Z. Denote the total score by\n$$S = S_{\\text{seed}} + S_{\\text{3'prime}} + B_{\\text{cons}} - P_{\\text{acc}}.$$\nFirst apply the Anchor Filter (Rule 1): nucleotide 1 of miR-Z is $U$, so a valid site must have $A$ opposite position 1. All three sites start with $A$ at position 1, so all pass the filter.\n\nCompute the seed score $S_{\\text{seed}}$ (Rule 2) from miR-Z positions $2$ through $8$, comparing index-wise to the given mRNA sequences:\n- Watson-Crick (WC) pair $=$ $+5$, wobble $G\\!-\\!U$ $=$ $+2$, mismatch $=$ $-10$.\n\nCompute the 3' pairing score $S_{\\text{3'prime}}$ (Rule 3) from miR-Z positions $13$ through $19$:\n- WC or $G\\!-\\!U$ wobble $=$ $+2$, mismatch $=$ $-1$.\n\nAdd conservation bonus $B_{\\text{cons}}$ (Rule 4) and subtract accessibility penalty $P_{\\text{acc}}$ (Rule 5).\n\nSite A: 3'-AGUCACGACGUUGCGUGAACCUG-5', Conserved, $P_{\\text{acc}}=5$.\n- Anchor: passes ($A$ at position $1$).\n- Seed (positions $2$–$8$): all seven are WC pairs, so\n$$S_{\\text{seed}} = 7 \\times 5 = 35.$$\n- 3' pairing (positions $13$–$19$): pairs are $C\\!-\\!G$ $(+2)$, $A\\!-\\!C$ $(-1)$, $C\\!-\\!G$ $(+2)$, $U\\!-\\!U$ $(-1)$, $U\\!-\\!G$ $(+2)$, $G\\!-\\!A$ $(-1)$, $G\\!-\\!A$ $(-1)$, hence\n$$S_{\\text{3'prime}} = 2 - 1 + 2 - 1 + 2 - 1 - 1 = 2.$$\n- Conservation and accessibility: $B_{\\text{cons}}=10$, $P_{\\text{acc}}=5$.\n- Total:\n$$S_{A} = 35 + 2 + 10 - 5 = 42.$$\n\nSite B: 3'-AGCCACGACAUAGCACGAACCUG-5', Not conserved, $P_{\\text{acc}}=15$.\n- Anchor: passes ($A$ at position $1$).\n- Seed (positions $2$–$8$): $C\\!-\\!G$ $(+5)$, $A\\!-\\!C$ $(-10)$, $G\\!-\\!C$ $(+5)$, $U\\!-\\!A$ $(+5)$, $G\\!-\\!C$ $(+5)$, $C\\!-\\!G$ $(+5)$, $U\\!-\\!A$ $(+5)$, hence\n$$S_{\\text{seed}} = 5 - 10 + 5 + 5 + 5 + 5 + 5 = 20.$$\n- 3' pairing (positions $13$–$19$): $C\\!-\\!G$ $(+2)$, $A\\!-\\!C$ $(-1)$, $C\\!-\\!A$ $(-1)$, $U\\!-\\!C$ $(-1)$, $U\\!-\\!G$ $(+2)$, $G\\!-\\!A$ $(-1)$, $G\\!-\\!A$ $(-1)$, hence\n$$S_{\\text{3'prime}} = 2 - 1 - 1 - 1 + 2 - 1 - 1 = -1.$$\n- Conservation and accessibility: $B_{\\text{cons}}=0$, $P_{\\text{acc}}=15$.\n- Total:\n$$S_{B} = 20 + (-1) + 0 - 15 = 4.$$\n\nSite C: 3'-AGUCACGAUUUUCACUGAACCUG-5', Conserved, $P_{\\text{acc}}=2$.\n- Anchor: passes ($A$ at position $1$).\n- Seed (positions $2$–$8$): all seven are WC pairs, so\n$$S_{\\text{seed}} = 7 \\times 5 = 35.$$\n- 3' pairing (positions $13$–$19$): $C\\!-\\!C$ $(-1)$, $A\\!-\\!A$ $(-1)$, $C\\!-\\!C$ $(-1)$, $U\\!-\\!U$ $(-1)$, $U\\!-\\!G$ $(+2)$, $G\\!-\\!A$ $(-1)$, $G\\!-\\!A$ $(-1)$, hence\n$$S_{\\text{3'prime}} = -1 - 1 - 1 - 1 + 2 - 1 - 1 = -4.$$\n- Conservation and accessibility: $B_{\\text{cons}}=10$, $P_{\\text{acc}}=2$.\n- Total:\n$$S_{C} = 35 + (-4) + 10 - 2 = 39.$$\n\nComparing the totals, $S_{A}=42$, $S_{B}=4$, and $S_{C}=39$. The highest score is $42$ for Site A, making GeneA the most likely target.", "answer": "$$\\boxed{42}$$", "id": "2281848"}, {"introduction": "A powerful application of computational biology is its ability to act as a 'time machine,' allowing us to infer the properties of ancestral genes and proteins from their modern-day descendants. This exercise introduces the fascinating concept of ancestral sequence reconstruction, a cornerstone of evolutionary bioinformatics [@problem_id:2281799]. Rather than simple guesswork, you will use the principle of maximum likelihood and a probabilistic model of evolution to determine the most likely ancestral state at a specific site in a protein. This practice provides a window into how statistical inference allows us to reconstruct evolutionary history and understand how proteins have changed over millions of years.", "problem": "In the field of computational evolutionary biology, researchers often infer the characteristics of ancestral organisms by analyzing the genetic sequences of their modern descendants. Consider a simplified scenario involving a protein from three related species, `S1`, `S2`, and `S3`. A phylogenetic analysis has established that an internal node `N` represents the most recent common ancestor of these three species. The evolutionary relationship is a simple star phylogeny, where branches radiate from the ancestor `N` to each of the three descendants.\n\nAt a particular amino acid site in this protein, the observed states are: Alanine (A) in species `S1`, Glycine (G) in species `S2`, and Alanine (A) in species `S3`.\n\nFor this specific site, let's assume that mutations only occur between Alanine and Glycine. The evolutionary process is modeled by a continuous-time Markov model with a single substitution rate parameter, $\\alpha$. The probability $P(i \\rightarrow j | t)$ of an initial amino acid `i` changing to an amino acid `j` over a branch of length `t` (representing evolutionary time) is given by:\n- $P(i \\rightarrow j | t) = 0.5 \\times (1 - \\exp(-\\alpha t))$ for $i \\neq j$\n- $P(i \\rightarrow i | t) = 0.5 \\times (1 + \\exp(-\\alpha t))$ for $i = j$\nwhere `i` and `j` can be either Alanine (A) or Glycine (G).\n\nThe relevant parameters have been estimated as follows:\n- Substitution rate parameter: $\\alpha = 1.0$\n- Branch length from `N` to `S1`: $t_{N,S1} = 0.4$\n- Branch length from `N` to `S2`: $t_{N,S2} = 0.6$\n- Branch length from `N` to `S3`: $t_{N,S3} = 0.4$\n\nUsing the principle of maximum likelihood, determine the most likely ancestral state at node `N`. To do this, calculate the ratio of the likelihood that the ancestral state was Alanine to the likelihood that it was Glycine. That is, compute the value of $L(\\text{Data} | N=A) / L(\\text{Data} | N=G)$. Round your final answer to three significant figures.", "solution": "We model the site as a two-state continuous-time Markov chain on a star phylogeny with ancestor $N$ and three independent branches to $S1$, $S2$, and $S3$. Conditional on the ancestral state at $N$, the likelihood of the observed data is the product of transition probabilities along each branch.\n\nLet $t_{1}=t_{N,S1}=0.4$, $t_{2}=t_{N,S2}=0.6$, and $t_{3}=t_{N,S3}=0.4$. The observed states are $S1=A$, $S2=G$, $S3=A$. Under the given model with rate $\\alpha$, the transition probabilities for $i,j\\in\\{A,G\\}$ are\n$$\nP(i\\rightarrow j\\mid t)=\\begin{cases}\n\\frac{1}{2}\\left(1-\\exp(-\\alpha t)\\right), & i\\neq j,\\\n$$4pt]\n\\frac{1}{2}\\left(1+\\exp(-\\alpha t)\\right), & i=j.\n\\end{cases}\n$$\nTherefore, the conditional likelihoods are\n$$\nL(\\text{Data}\\mid N=A)=P(A\\rightarrow A\\mid t_{1})\\,P(A\\rightarrow G\\mid t_{2})\\,P(A\\rightarrow A\\mid t_{3}),\n$$\n$$\nL(\\text{Data}\\mid N=G)=P(G\\rightarrow A\\mid t_{1})\\,P(G\\rightarrow G\\mid t_{2})\\,P(G\\rightarrow A\\mid t_{3}).\n$$\nUsing the symmetry of the two-state model (same vs. different), we have\n$$\nL(\\text{Data}\\mid N=A)=\\left[\\tfrac{1}{2}\\left(1+\\exp(-\\alpha t_{1})\\right)\\right]\\left[\\tfrac{1}{2}\\left(1-\\exp(-\\alpha t_{2})\\right)\\right]\\left[\\tfrac{1}{2}\\left(1+\\exp(-\\alpha t_{3})\\right)\\right],\n$$\n$$\nL(\\text{Data}\\mid N=G)=\\left[\\tfrac{1}{2}\\left(1-\\exp(-\\alpha t_{1})\\right)\\right]\\left[\\tfrac{1}{2}\\left(1+\\exp(-\\alpha t_{2})\\right)\\right]\\left[\\tfrac{1}{2}\\left(1-\\exp(-\\alpha t_{3})\\right)\\right].\n$$\nThus the likelihood ratio simplifies (the factors $\\tfrac{1}{2}$ cancel) to\n$$\nR=\\frac{L(\\text{Data}\\mid N=A)}{L(\\text{Data}\\mid N=G)}=\\frac{\\left(1+\\exp(-\\alpha t_{1})\\right)\\left(1-\\exp(-\\alpha t_{2})\\right)\\left(1+\\exp(-\\alpha t_{3})\\right)}{\\left(1-\\exp(-\\alpha t_{1})\\right)\\left(1+\\exp(-\\alpha t_{2})\\right)\\left(1-\\exp(-\\alpha t_{3})\\right)}.\n$$\nWith $t_{1}=t_{3}=0.4$, $t_{2}=0.6$, and $\\alpha=1$, this becomes\n$$\nR=\\frac{\\left(1+\\exp(-0.4)\\right)^{2}\\left(1-\\exp(-0.6)\\right)}{\\left(1-\\exp(-0.4)\\right)^{2}\\left(1+\\exp(-0.6)\\right)}.\n$$\nNumerically, $\\exp(-0.4)\\approx 0.670320046$ and $\\exp(-0.6)\\approx 0.548811636$, giving\n$$\nR\\approx \\frac{(1+0.670320046)^{2}(1-0.548811636)}{(0.329679954)^{2}\\cdot 1.548811636}=\\frac{(1.670320046)^{2}\\cdot 0.451188364}{(0.329679954)^{2}\\cdot 1.548811636}\\approx 7.48.\n$$\nSince $R>1$, the most likely ancestral state at $N$ is Alanine (A). The requested ratio is $R\\approx 7.48$, rounded to three significant figures.", "answer": "$$\\boxed{7.48}$$", "id": "2281799"}]}