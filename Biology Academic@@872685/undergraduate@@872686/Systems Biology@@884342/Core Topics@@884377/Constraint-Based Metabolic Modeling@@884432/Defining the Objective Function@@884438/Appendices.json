{"hands_on_practices": [{"introduction": "In metabolic modeling, a common goal is to predict the maximum growth rate of an organism. To do this, we must first mathematically define \"growth\" itself through a biomass objective function, which acts as a recipe listing all the necessary molecular building blocks. This exercise provides hands-on practice in translating empirical data on a cell's composition into the precise stoichiometric coefficients for this function, a foundational skill for Flux Balance Analysis (FBA) [@problem_id:2038523].", "problem": "In the field of synthetic biology, Flux Balance Analysis (FBA) is a powerful computational method used to predict metabolic flux distributions in a genome-scale model of an organism. A critical component of FBA is the \"biomass objective function,\" a pseudo-reaction that represents the stoichiometric requirements for synthesizing all cellular components to produce 1 gram of dry weight (gDW).\n\nConsider a hypothetical microorganism, *Artificium aedificator*, whose biomass has been simplified for modeling purposes. The dry weight of this organism is composed of three classes of macromolecules: Structurin (S), Energin (E), and Informatin (I). The composition of 1 gram of its dry weight is as follows:\n- 0.600 g of Structurin (S)\n- 0.300 g of Energin (E)\n- 0.100 g of Informatin (I)\n\nThese macromolecules are synthesized from three precursor metabolites: a generic Amino Acid (AA), a generic Nucleotide (NT), and a generic Fatty Acid (FA). The synthesis reactions for the macromolecules are given by the following stoichiometries:\n- Synthesis of Structurin: $8 \\text{ AA} + 2 \\text{ FA} \\longrightarrow 1 \\text{ S}$\n- Synthesis of Energin: $10 \\text{ FA} \\longrightarrow 1 \\text{ E}$\n- Synthesis of Informatin: $12 \\text{ NT} \\longrightarrow 1 \\text{ I}$\n\nThe molar masses of the precursors and macromolecules have been determined as:\n- Molar Mass of AA: $0.110 \\text{ g/mmol}$\n- Molar Mass of NT: $0.330 \\text{ g/mmol}$\n- Molar Mass of FA: $0.280 \\text{ g/mmol}$\n- Molar Mass of S: $1.440 \\text{ g/mmol}$\n- Molar Mass of E: $2.800 \\text{ g/mmol}$\n- Molar Mass of I: $3.960 \\text{ g/mmol}$\n\nWhich of the following stoichiometric equations correctly represents the biomass objective function for producing 1 gram of dry weight (gDW) of *A. aedificator*?\n\nA. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{40}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nB. $\\frac{24}{5} \\text{ AA} + \\frac{6}{5} \\text{ NT} + \\frac{21}{5} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nC. $8 \\text{ AA} + 12 \\text{ NT} + 12 \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nD. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{92}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$", "solution": "Goal: Derive the biomass objective function coefficients (in mmol per gDW) for AA, NT, and FA such that their combination produces exactly 1 gDW of biomass composed of 0.600 g S, 0.300 g E, and 0.100 g I, consistent with macromolecule synthesis stoichiometries and molar masses.\n\n1) Convert macromolecular mass fractions to moles (mmol) using $n = \\frac{m}{M}$ with given masses (in g) and molar masses (in g/mmol):\n$$\nn_{S} = \\frac{0.600}{1.440} = \\frac{600}{1440} = \\frac{5}{12} \\text{ mmol},\\quad\nn_{E} = \\frac{0.300}{2.800} = \\frac{300}{2800} = \\frac{3}{28} \\text{ mmol},\\quad\nn_{I} = \\frac{0.100}{3.960} = \\frac{100}{3960} = \\frac{5}{198} \\text{ mmol}.\n$$\n\n2) Use synthesis stoichiometries to compute precursor requirements per 1 gDW:\n- Structurin: $8\\,\\text{AA} + 2\\,\\text{FA} \\longrightarrow 1\\,\\text{S}$. For $n_{S} = \\frac{5}{12}$ mmol S:\n$$\n\\text{AA from S}: 8\\,n_{S} = 8 \\cdot \\frac{5}{12} = \\frac{10}{3} \\text{ mmol},\\quad\n\\text{FA from S}: 2\\,n_{S} = 2 \\cdot \\frac{5}{12} = \\frac{5}{6} \\text{ mmol}.\n$$\n- Energin: $10\\,\\text{FA} \\longrightarrow 1\\,\\text{E}$. For $n_{E} = \\frac{3}{28}$ mmol E:\n$$\n\\text{FA from E}: 10\\,n_{E} = 10 \\cdot \\frac{3}{28} = \\frac{15}{14} \\text{ mmol}.\n$$\n- Informatin: $12\\,\\text{NT} \\longrightarrow 1\\,\\text{I}$. For $n_{I} = \\frac{5}{198}$ mmol I:\n$$\n\\text{NT from I}: 12\\,n_{I} = 12 \\cdot \\frac{5}{198} = \\frac{60}{198} = \\frac{10}{33} \\text{ mmol}.\n$$\n\n3) Sum precursor demands across macromolecules:\n$$\nn_{\\text{AA}} = \\frac{10}{3},\\quad\nn_{\\text{NT}} = \\frac{10}{33},\\quad\nn_{\\text{FA}} = \\frac{5}{6} + \\frac{15}{14} = \\frac{35}{42} + \\frac{45}{42} = \\frac{80}{42} = \\frac{40}{21}.\n$$\n\n4) Biomass objective function (per 1 gDW) therefore is:\n$$\n\\frac{10}{3}\\,\\text{AA} + \\frac{10}{33}\\,\\text{NT} + \\frac{40}{21}\\,\\text{FA} \\longrightarrow 1\\,\\text{gDW}.\n$$\n\n5) Mass consistency check using precursor molar masses $M_{\\text{AA}} = 0.110$, $M_{\\text{NT}} = 0.330$, $M_{\\text{FA}} = 0.280$ g/mmol:\n$$\nm_{\\text{AA}} = \\frac{10}{3} \\cdot 0.110 = \\frac{1.1}{3} \\text{ g},\\quad\nm_{\\text{NT}} = \\frac{10}{33} \\cdot 0.330 = \\frac{3.3}{33} = 0.100 \\text{ g},\\quad\nm_{\\text{FA}} = \\frac{40}{21} \\cdot 0.280 = \\frac{11.2}{21} \\text{ g}.\n$$\nSumming gives\n$$\n\\frac{1.1}{3} + 0.100 + \\frac{11.2}{21} = 0.366\\overline{6} + 0.100 + 0.533\\overline{3} = 1.000 \\text{ g},\n$$\nconfirming the correct 1 gDW. This matches option A.", "answer": "$$\\boxed{A}$$", "id": "2038523"}, {"introduction": "A central task in systems biology is not just to build models, but to ensure they accurately reflect experimental reality. An objective function provides a quantitative way to measure the \"goodness-of-fit\" between a model's predictions and experimental data. This practice illustrates how to calculate a weighted sum of squared errors, a standard objective function that correctly normalizes for measurement uncertainty and allows for the integration of diverse data types [@problem_id:1427249].", "problem": "A systems biologist is developing a mathematical model for a cellular signaling pathway. In this pathway, an external signal triggers the phosphorylation of a protein, let's call it `P`. The phosphorylated form of this protein, `pP`, then acts as a transcription factor to increase the expression of a specific gene, `G`. The model, described by a set of parameters $\\theta$, aims to predict the concentration of `pP` and the relative abundance of mRNA from gene `G` over time.\n\nTo validate the model and find the best parameters, the biologist has collected two different types of experimental data:\n1.  **Phosphoproteomics Data**: Measurements of the concentration of `pP`.\n    -   At time $t_1 = 10 \\text{ min}$, the measured concentration of `pP` is $45.2 \\text{ nM}$, with a measurement standard deviation of $\\sigma_1 = 3.5 \\text{ nM}$.\n    -   At time $t_2 = 20 \\text{ min}$, the measured concentration of `pP` is $88.9 \\text{ nM}$, with a measurement standard deviation of $\\sigma_2 = 6.1 \\text{ nM}$.\n2.  **Gene Expression Data**: Measurements of the relative abundance of mRNA from gene `G` using Quantitative Polymerase Chain Reaction (qPCR).\n    -   At time $t_3 = 60 \\text{ min}$, the measured relative abundance of `G`-mRNA is $8.2$ units, with a measurement standard deviation of $\\sigma_3 = 0.7$ units.\n\nThe biologist is testing a specific parameter set, $\\theta_0$. With this set of parameters, the model gives the following predictions:\n-   Predicted `pP` concentration at $t_1 = 10 \\text{ min}$ is $41.8 \\text{ nM}$.\n-   Predicted `pP` concentration at $t_2 = 20 \\text{ min}$ is $95.3 \\text{ nM}$.\n-   Predicted `G`-mRNA relative abundance at $t_3 = 60 \\text{ min}$ is $9.4$ units.\n\nTo quantify how well the parameter set $\\theta_0$ explains the data, you need to calculate an objective function. Calculate the value of the total weighted sum of squared errors between the experimental data and the model's predictions. Assume the standard statistical practice where the weight for each squared error term is the inverse of the variance of the corresponding experimental measurement. The final answer is a dimensionless quantity. Round your final answer to three significant figures.", "solution": "The goal is to compute the value of an objective function, specifically the weighted sum of squared errors (often denoted as $\\chi^2$), which quantifies the discrepancy between experimental measurements and model predictions for a given set of parameters.\n\nThe general formula for the weighted sum of squared errors is:\n$$ \\chi^2 = \\sum_{i=1}^{N} w_i (y_i^{\\text{exp}} - y_i^{\\text{model}})^2 $$\nwhere $N$ is the total number of data points, $y_i^{\\text{exp}}$ is the $i$-th experimental measurement, $y_i^{\\text{model}}$ is the corresponding model prediction, and $w_i$ is the weight for the $i$-th data point.\n\nThe problem states that the weight for each term is the inverse of the variance of the corresponding measurement. The variance, $\\sigma_i^2$, is the square of the standard deviation, $\\sigma_i$. Therefore, the weight $w_i$ is given by $w_i = \\frac{1}{\\sigma_i^2}$.\n\nSubstituting this into the general formula gives the specific objective function to be calculated:\n$$ \\chi^2 = \\sum_{i=1}^{N} \\frac{(y_i^{\\text{exp}} - y_i^{\\text{model}})^2}{\\sigma_i^2} $$\n\nWe have three experimental data points, so $N=3$. Let's identify the values for each data point from the problem statement.\n\n**Data Point 1: `pP` concentration at $t_1 = 10$ min**\n-   Experimental measurement: $y_1^{\\text{exp}} = 45.2 \\text{ nM}$\n-   Model prediction: $y_1^{\\text{model}} = 41.8 \\text{ nM}$\n-   Standard deviation: $\\sigma_1 = 3.5 \\text{ nM}$\n\n**Data Point 2: `pP` concentration at $t_2 = 20$ min**\n-   Experimental measurement: $y_2^{\\text{exp}} = 88.9 \\text{ nM}$\n-   Model prediction: $y_2^{\\text{model}} = 95.3 \\text{ nM}$\n-   Standard deviation: $\\sigma_2 = 6.1 \\text{ nM}$\n\n**Data Point 3: `G`-mRNA abundance at $t_3 = 60$ min**\n-   Experimental measurement: $y_3^{\\text{exp}} = 8.2 \\text{ units}$\n-   Model prediction: $y_3^{\\text{model}} = 9.4 \\text{ units}$\n-   Standard deviation: $\\sigma_3 = 0.7 \\text{ units}$\n\nNow we can calculate the contribution of each data point to the total $\\chi^2$ value.\n\n**Term 1:**\n$$ \\frac{(y_1^{\\text{exp}} - y_1^{\\text{model}})^2}{\\sigma_1^2} = \\frac{(45.2 - 41.8)^2}{(3.5)^2} = \\frac{(3.4)^2}{12.25} = \\frac{11.56}{12.25} \\approx 0.943673 $$\n\n**Term 2:**\n$$ \\frac{(y_2^{\\text{exp}} - y_2^{\\text{model}})^2}{\\sigma_2^2} = \\frac{(88.9 - 95.3)^2}{(6.1)^2} = \\frac{(-6.4)^2}{37.21} = \\frac{40.96}{37.21} \\approx 1.099435 $$\n\n**Term 3:**\n$$ \\frac{(y_3^{\\text{exp}} - y_3^{\\text{model}})^2}{\\sigma_3^2} = \\frac{(8.2 - 9.4)^2}{(0.7)^2} = \\frac{(-1.2)^2}{0.49} = \\frac{1.44}{0.49} \\approx 2.938775 $$\n\nThe total weighted sum of squared errors is the sum of these three terms:\n$$ \\chi^2 = 0.943673 + 1.099435 + 2.938775 = 4.981883 $$\n\nThe problem asks for the answer to be rounded to three significant figures.\nThe calculated value is $4.981883$. The first three significant figures are 4, 9, and 8. The next digit is 1, which is less than 5, so we round down.\n\nTherefore, the final answer is $4.98$.", "answer": "$$\\boxed{4.98}$$", "id": "1427249"}, {"introduction": "Objective functions are at the heart of understanding how biological systems achieve optimal performance in the face of constraints and uncertainty. For instance, cells must often make critical fate decisions based on noisy environmental signals, a process we can frame as an optimization problem to minimize error. This thought experiment guides you to define the probability of an incorrect decision as the objective function and then find the ideal internal threshold that optimizes the cell's decision-making strategy [@problem_id:1427241].", "problem": "A biological system involves a progenitor cell that must decide between two distinct terminal fates, Fate A and Fate B. This decision is controlled by the external concentration of a signaling molecule. A low concentration, $C_{\\text{low}}$, is intended to signal for Fate B, while a high concentration, $C_{\\text{high}}$ (where $C_{\\text{high}} > C_{\\text{low}}$), signals for Fate A.\n\nDue to inherent biological noise, the cell does not perceive the external concentration perfectly. The cell's internal measurement of the concentration, denoted by $c$, is a random variable. When the true external concentration is $C$, the measured value $c$ is drawn from a normal (Gaussian) distribution with a mean equal to the true concentration $C$ and a constant standard deviation $\\sigma$.\n\nThe cell uses a threshold-based mechanism to make its decision. It has an internal decision threshold, $c_{\\text{th}}$. If the measured concentration $c$ is greater than or equal to this threshold ($c \\ge c_{\\text{th}}$), the cell commits to Fate A. If the measured concentration is less than the threshold ($c  c_{\\text{th}}$), it commits to Fate B.\n\nAssume that in its natural environment, the cell has an equal probability of being exposed to the low concentration signal ($C_{\\text{low}}$) and the high concentration signal ($C_{\\text{high}}$). An incorrect decision occurs if the cell commits to Fate A when the signal is $C_{\\text{low}}$, or to Fate B when the signal is $C_{\\text{high}}$.\n\nYour task is to determine the optimal decision threshold, $c_{\\text{th}}^*$, that minimizes the overall probability of the cell making an incorrect fate choice. Provide your answer as a symbolic expression in terms of $C_{\\text{low}}$ and $C_{\\text{high}}$.", "solution": "Let the measurement noise be Gaussian with constant standard deviation $\\sigma$. Then\n$$\np(c\\,|\\,C_{low})=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(c-C_{low})^{2}}{2\\sigma^{2}}\\right),\\qquad\np(c\\,|\\,C_{high})=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(c-C_{high})^{2}}{2\\sigma^{2}}\\right).\n$$\nWith equal exposure probabilities to $C_{low}$ and $C_{high}$ and a threshold rule “choose A if $c\\ge c_{th}$, else B,” the overall error probability is\n$$\nP_{\\text{err}}(c_{th})=\\frac{1}{2}\\Pr(c\\ge c_{th}\\,|\\,C_{low})+\\frac{1}{2}\\Pr(cc_{th}\\,|\\,C_{high}).\n$$\nLet $\\Phi$ denote the standard normal cumulative distribution function and $\\phi$ its probability density. Then\n$$\n\\Pr(c\\ge c_{th}\\,|\\,C_{low})=1-\\Phi\\!\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right),\\qquad\n\\Pr(cc_{th}\\,|\\,C_{high})=\\Phi\\!\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right),\n$$\nso\n$$\nP_{\\text{err}}(c_{th})=\\frac{1}{2}\\left[1-\\Phi\\!\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right)+\\Phi\\!\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right)\\right].\n$$\nDifferentiate with respect to $c_{th}$, using $\\frac{d}{dx}\\Phi(x)=\\phi(x)$ and the chain rule:\n$$\n\\frac{dP_{\\text{err}}}{dc_{th}}=\\frac{1}{2}\\left[-\\phi\\!\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right)\\frac{1}{\\sigma}+\\phi\\!\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right)\\frac{1}{\\sigma}\\right]\n=\\frac{1}{2\\sigma}\\left[\\phi\\!\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right)-\\phi\\!\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right)\\right].\n$$\nSet the derivative to zero to find critical points:\n$$\n\\phi\\!\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right)=\\phi\\!\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right).\n$$\nUsing $\\phi(x)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{x^{2}}{2}\\right)$, the equality implies\n$$\n\\exp\\!\\left(-\\frac{(c_{th}-C_{high})^{2}}{2\\sigma^{2}}\\right)=\\exp\\!\\left(-\\frac{(c_{th}-C_{low})^{2}}{2\\sigma^{2}}\\right)\n\\;\\;\\Longrightarrow\\;\\;\n(c_{th}-C_{high})^{2}=(c_{th}-C_{low})^{2}.\n$$\nThus either $c_{th}-C_{high}=c_{th}-C_{low}$, which would require $C_{high}=C_{low}$ (excluded by $C_{high}C_{low}$), or\n$$\nc_{th}-C_{low}=-(c_{th}-C_{high})\\;\\;\\Longrightarrow\\;\\;2c_{th}=C_{low}+C_{high}\\;\\;\\Longrightarrow\\;\\;c_{th}^{*}=\\frac{C_{low}+C_{high}}{2}.\n$$\nTo confirm this is a minimum, compute the second derivative:\n$$\n\\frac{d^{2}P_{\\text{err}}}{dc_{th}^{2}}=\\frac{1}{2\\sigma^{2}}\\left[-\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right)\\phi\\!\\left(\\frac{c_{th}-C_{high}}{\\sigma}\\right)+\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right)\\phi\\!\\left(\\frac{c_{th}-C_{low}}{\\sigma}\\right)\\right].\n$$\nAt the critical point, let $a=(c_{th}-C_{low})/\\sigma$ and $b=(c_{th}-C_{high})/\\sigma=-a$, and use $\\phi(a)=\\phi(b)$ to get\n$$\n\\frac{d^{2}P_{\\text{err}}}{dc_{th}^{2}}=\\frac{1}{\\sigma^{2}}\\,a\\,\\phi(a)0,\n$$\nsince $a0$ when $c_{th}$ lies between $C_{low}$ and $C_{high}$. Therefore, $c_{th}^{*}=(C_{low}+C_{high})/2$ minimizes the error. This agrees with the likelihood-ratio test for equal priors and equal variances, which sets the threshold at the point where $p(c\\,|\\,C_{low})=p(c\\,|\\,C_{high})$, yielding the same midpoint.", "answer": "$$\\boxed{\\frac{C_{low}+C_{high}}{2}}$$", "id": "1427241"}]}