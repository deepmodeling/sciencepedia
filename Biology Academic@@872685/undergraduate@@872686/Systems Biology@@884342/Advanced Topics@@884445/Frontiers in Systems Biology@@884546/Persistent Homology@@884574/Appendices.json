{"hands_on_practices": [{"introduction": "The best way to develop an intuition for persistent homology is to build a filtration by hand. This exercise walks you through the fundamental process of constructing a Vietoris-Rips complex on a simple set of points, representing protein locations. By manually increasing the radius parameter $\\epsilon$, you will directly observe how individual components merge and how a topological hole is born and later filled, providing a concrete understanding of how Betti numbers $\\beta_0$ and $\\beta_1$ capture a system's changing topology [@problem_id:1457473].", "problem": "In systems biology, topological data analysis is used to study the spatial organization of molecules within a cell. Consider a simplified model where the locations of four key signaling proteins have been identified using super-resolution microscopy. The proteins, labeled P1, P2, P3, and P4, are treated as points in a 2D plane with the following coordinates (in nanometers, nm):\n- P1: (0, 0)\n- P2: (3, 0)\n- P3: (0, 4)\n- P4: (3, 4)\n\nTo analyze the clustering of these proteins, we can construct a sequence of simplicial complexes known as a Vietoris-Rips filtration. A simplicial complex is a collection of points (0-simplices), edges connecting pairs of points (1-simplices), filled triangles connecting triples of points (2-simplices), and their higher-dimensional counterparts.\n\nFor a given radius $\\epsilon$, the Vietoris-Rips (VR) complex is constructed as follows: a set of $k+1$ protein locations forms a $k$-simplex if and only if the Euclidean distance between any two locations in the set is less than or equal to $2\\epsilon$. The filtration is the sequence of VR complexes generated by gradually increasing $\\epsilon$.\n\nThe topology of each complex in the filtration can be characterized by its Betti numbers. For our purposes, we are interested in:\n- $\\beta_0$: The number of connected components in the complex.\n- $\\beta_1$: The number of one-dimensional loops or \"holes\" in the complex.\n\nFor the three specific filtration values $\\epsilon_1 = 1.6 \\text{ nm}$, $\\epsilon_2 = 2.1 \\text{ nm}$, and $\\epsilon_3 = 2.6 \\text{ nm}$, determine the Betti numbers $\\beta_0$ and $\\beta_1$ for the resulting Vietoris-Rips complex at each step.\n\nProvide your six results as a single row matrix in the order $(\\beta_0(\\epsilon_1), \\beta_1(\\epsilon_1), \\beta_0(\\epsilon_2), \\beta_1(\\epsilon_2), \\beta_0(\\epsilon_3), \\beta_1(\\epsilon_3))$.", "solution": "The problem asks for the Betti numbers $\\beta_0$ and $\\beta_1$ of the Vietoris-Rips (VR) complex constructed from four points at three different radii $\\epsilon$. The four points are $P_1(0, 0)$, $P_2(3, 0)$, $P_3(0, 4)$, and $P_4(3, 4)$.\n\nFirst, we calculate the pairwise Euclidean distances between all points. Let $d(P_i, P_j)$ be the distance between protein $i$ and protein $j$.\n- $d(P_1, P_2) = \\sqrt{(3-0)^2 + (0-0)^2} = \\sqrt{9} = 3$\n- $d(P_1, P_3) = \\sqrt{(0-0)^2 + (4-0)^2} = \\sqrt{16} = 4$\n- $d(P_1, P_4) = \\sqrt{(3-0)^2 + (4-0)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$\n- $d(P_2, P_3) = \\sqrt{(0-3)^2 + (4-0)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$\n- $d(P_2, P_4) = \\sqrt{(3-3)^2 + (4-0)^2} = \\sqrt{16} = 4$\n- $d(P_3, P_4) = \\sqrt{(3-0)^2 + (4-4)^2} = \\sqrt{9} = 3$\n\nThe set of unique distances is $\\{3, 4, 5\\}$. According to the definition of the VR complex, an edge (1-simplex) exists between two points if their distance $d$ is less than or equal to the diameter $2\\epsilon$. A triangle (2-simplex) exists on three points if all three pairwise distances are $\\le 2\\epsilon$.\n\n**Step 1: Analysis for $\\epsilon_1 = 1.6$ nm**\n\nThe condition for forming simplices is $d \\le 2\\epsilon_1 = 2 \\times 1.6 = 3.2$.\nWe check which pairwise distances satisfy this condition:\n- $d(P_1, P_2) = 3 \\le 3.2$ (Edge $P_1-P_2$ forms)\n- $d(P_3, P_4) = 3 \\le 3.2$ (Edge $P_3-P_4$ forms)\n- All other distances (4 and 5) are greater than 3.2.\n\nThe complex at $\\epsilon_1=1.6$ consists of the four vertices (0-simplices) and two edges (1-simplices): $\\{P_1, P_2\\}$ and $\\{P_3, P_4\\}$.\n- To find $\\beta_0$, we count the number of connected components. The points form two separate components: one containing $\\{P_1, P_2\\}$ and the other containing $\\{P_3, P_4\\}$. Thus, $\\beta_0(\\epsilon_1) = 2$.\n- To find $\\beta_1$, we look for 1D holes (cycles). There are no cycles in the complex. Thus, $\\beta_1(\\epsilon_1) = 0$.\n\n**Step 2: Analysis for $\\epsilon_2 = 2.1$ nm**\n\nThe condition for forming simplices is $d \\le 2\\epsilon_2 = 2 \\times 2.1 = 4.2$.\nWe check which pairwise distances satisfy this condition:\n- Distances of 3: $d(P_1, P_2)$ and $d(P_3, P_4)$ are $\\le 4.2$.\n- Distances of 4: $d(P_1, P_3)$ and $d(P_2, P_4)$ are $\\le 4.2$.\n- Distances of 5: $d(P_1, P_4)$ and $d(P_2, P_3)$ are $> 4.2$.\n\nThe edges that form are $(P_1, P_2)$, $(P_3, P_4)$, $(P_1, P_3)$, and $(P_2, P_4)$.\n- To find $\\beta_0$, we check connectivity. The edge $(P_1, P_3)$ connects the two components from the previous step. For example, $P_1$ is connected to $P_3$, which is connected to $P_4$, which is connected to $P_2$ (via $P_1$ and $P_3$). All four points are now in a single connected component. Thus, $\\beta_0(\\epsilon_2) = 1$.\n- To find $\\beta_1$, we look for holes. The four edges form a cycle: $P_1-P_3-P_4-P_2-P_1$. This is a potential 1D hole. A hole exists if this cycle is not the boundary of a collection of 2-simplices (triangles). We need to check if any triangles have formed.\n    - Triangle $\\{P_1, P_2, P_3\\}$? Requires $d(P_2, P_3) = 5$, which is $> 4.2$. No.\n    - Triangle $\\{P_1, P_3, P_4\\}$? Requires $d(P_1, P_4) = 5$, which is $> 4.2$. No.\n    - Triangle $\\{P_1, P_2, P_4\\}$? Requires $d(P_1, P_4) = 5$, which is $> 4.2$. No.\n    - Triangle $\\{P_2, P_4, P_3\\}$? Requires $d(P_2, P_3) = 5$, which is $> 4.2$. No.\nSince no 2-simplices are formed, the cycle is not filled in. It represents a genuine 1D hole. Thus, $\\beta_1(\\epsilon_2) = 1$.\n\n**Step 3: Analysis for $\\epsilon_3 = 2.6$ nm**\n\nThe condition for forming simplices is $d \\le 2\\epsilon_3 = 2 \\times 2.6 = 5.2$.\nWe check which pairwise distances satisfy this condition:\n- Distances of 3, 4, and 5 are all $\\le 5.2$.\nThis means all possible pairs of points are connected by an edge. The graph is the complete graph $K_4$.\n- Since the graph is connected, $\\beta_0(\\epsilon_3) = 1$.\n- To find $\\beta_1$, we check if the hole from the previous step has been filled. We look for 2-simplices.\n    - Triangle $\\{P_1, P_2, P_3\\}$: Distances are $\\{3, 4, 5\\}$. All are $\\le 5.2$. This 2-simplex forms.\n    - Triangle $\\{P_1, P_3, P_4\\}$: Distances are $\\{4, 5, 3\\}$. All are $\\le 5.2$. This 2-simplex forms.\n    - Triangle $\\{P_2, P_4, P_3\\}$: Distances are $\\{4, 5, 3\\}$. All are $\\le 5.2$. This 2-simplex forms.\n    - Triangle $\\{P_1, P_2, P_4\\}$: Distances are $\\{3, 5, 4\\}$. All are $\\le 5.2$. This 2-simplex forms.\nThe cycle $P_1-P_3-P_4-P_2-P_1$ from the previous step is now filled. For example, the cycle can be seen as the boundary of the union of the two triangles $\\{P_1, P_3, P_4\\}$ and $\\{P_1, P_4, P_2\\}$. Since the cycle is now a boundary of a 2-chain (a sum of 2-simplices), it no longer represents a hole in homology. In fact, the four points and all their connecting edges and faces form a tetrahedron (a 3-simplex), which is contractible and has no holes. Thus, $\\beta_1(\\epsilon_3) = 0$.\n\nSummary of results:\n- For $\\epsilon_1 = 1.6$: $(\\beta_0, \\beta_1) = (2, 0)$\n- For $\\epsilon_2 = 2.1$: $(\\beta_0, \\beta_1) = (1, 1)$\n- For $\\epsilon_3 = 2.6$: $(\\beta_0, \\beta_1) = (1, 0)$\n\nThe requested final answer is the row matrix $(\\beta_0(\\epsilon_1), \\beta_1(\\epsilon_1), \\beta_0(\\epsilon_2), \\beta_1(\\epsilon_2), \\beta_0(\\epsilon_3), \\beta_1(\\epsilon_3))$.\nThis corresponds to $(2, 0, 1, 1, 1, 0)$.", "answer": "$$\\boxed{\\begin{pmatrix} 2  0  1  1  1  0 \\end{pmatrix}}$$", "id": "1457473"}, {"introduction": "While manual construction is instructive, real-world topological data analysis relies on computational outputs like persistence barcodes. This practice shifts our focus from construction to interpretation, a crucial skill for any biologist using these methods. Using a hypothetical barcode from a cell colony analysis, you will learn to read the birth and death times of connected components ($H_0$ features) to determine the number of distinct cell clusters present at a specific spatial scale [@problem_id:1457508].", "problem": "A systems biologist is analyzing the spatial organization of a developing cell colony using techniques from Topological Data Analysis (TDA). The positions of individual cells are recorded at a specific time point. To understand the clustering behavior, a persistence barcode for the 0-th homology group ($H_0$) is computed. This barcode tracks the formation and merging of connected components (cell clusters) as a \"connectivity radius\" $\\epsilon$ is increased.\n\nEach bar in the barcode is represented by a pair of values $(\\epsilon_{\\text{birth}}, \\epsilon_{\\text{death}})$, where:\n- $\\epsilon_{\\text{birth}}$ is the radius at which a new, isolated cluster appears. For this analysis, individual cells are present from the beginning, so $\\epsilon_{\\text{birth}} = 0$ for all primary components.\n- $\\epsilon_{\\text{death}}$ is the radius at which this cluster merges with another, older cluster and thus \"dies\" as a distinct component.\n\nOne component, representing the entire colony once all cells are connected, persists indefinitely. This is represented by a death time of infinity.\n\nThe biologist obtains the following set of (birth, death) pairs, where the radius $\\epsilon$ is measured in micrometers ($\\mu$m):\n`{(0, 1.2), (0, 4.5), (0, 2.8), (0, 9.1), (0, 0.7), (0, 3.6), (0, infinity)}`\n\nBased on this persistence data, how many distinct cell clusters exist at the moment the connectivity radius is exactly $\\epsilon = 3.0$ $\\mu$m?", "solution": "We analyze the $H_{0}$ persistence barcode, where each connected component is represented by an interval $(\\epsilon_{\\text{birth}}, \\epsilon_{\\text{death}})$. The number of connected components at a given scale $\\epsilon$ equals the number of bars whose intervals contain $\\epsilon$ under the convention that a bar is alive for $\\epsilon_{\\text{birth}} \\le \\epsilon  \\epsilon_{\\text{death}}$, since the component dies at $\\epsilon = \\epsilon_{\\text{death}}$ when it merges into an older component.\n\nFormally, the number of clusters at scale $\\epsilon$ is\n$$\nN(\\epsilon) = \\left|\\left\\{i : \\epsilon_{\\text{birth},i} \\le \\epsilon  \\epsilon_{\\text{death},i}\\right\\}\\right|.\n$$\nGiven that all primary components have $\\epsilon_{\\text{birth}} = 0$, this simplifies to\n$$\nN(\\epsilon) = \\left|\\left\\{i : \\epsilon  \\epsilon_{\\text{death},i}\\right\\}\\right|.\n$$\n\nThe provided death times are $\\{0.7, 1.2, 2.8, 3.6, 4.5, 9.1, \\infty\\}$. At $\\epsilon = 3.0$, the components with $\\epsilon_{\\text{death}} \\le 3.0$ have already died, and those with $\\epsilon_{\\text{death}} > 3.0$ are still alive. The death times greater than $3.0$ are $3.6$, $4.5$, $9.1$, and $\\infty$. Therefore,\n$$\nN(3.0) = 4.\n$$\nHence, there are $4$ distinct clusters at $\\epsilon = 3.0$.", "answer": "$$\\boxed{4}$$", "id": "1457508"}, {"introduction": "This final practice synthesizes the concepts of construction and interpretation in a more complex, applied scenario modeling the spread of a virus. You will analyze spatiotemporal case data using a non-Euclidean distance metric (Chebyshev distance) that is particularly suited for this type of data. By tracking the merging of case clusters and calculating a summary statistic known as total persistence, you will see how persistent homology can be used to quantify the underlying structure of a dynamic biological process [@problem_id:1457477].", "problem": "An epidemiologist is analyzing the initial spread of a novel virus to understand its transmission dynamics. The data consists of the first five confirmed cases, recorded by their spatial location and time of symptom onset. To simplify the model, the spatial location is represented by a single coordinate $x$ in kilometers along a transportation corridor, and time $t$ is measured in days from the first observation. The five cases, labeled $P_1$ through $P_5$, are given by the following $(x, t)$ coordinates:\n$P_1 = (1, 2)$\n$P_2 = (3, 1)$\n$P_3 = (10, 8)$\n$P_4 = (8, 10)$\n$P_5 = (6, 6)$\n\nTo quantify the clustering of these cases, you will perform a persistent homology analysis on this dataset. The \"distance\" between any two cases, $P_i=(x_i, t_i)$ and $P_j=(x_j, t_j)$, is defined using the Chebyshev distance (or max-norm), given by $d(P_i, P_j) = \\max(|x_i - x_j|, |t_i - t_j|)$.\n\nThe analysis focuses on 0-dimensional homology features ($H_0$), which correspond to connected components. The process, known as a filtration, is as follows:\n1.  At a filtration value $\\epsilon = 0$, each of the five data points is considered an independent connected component. The \"birth\" time for each of these components is 0.\n2.  As the filtration value $\\epsilon$ increases, an edge is considered to exist between any two points $P_i$ and $P_j$ if $d(P_i, P_j) \\le \\epsilon$.\n3.  When a new edge connects two previously disconnected components, they merge. To maintain a clear lineage, a standard rule is applied: the component associated with the higher-indexed point merges into the component associated with the lower-indexed point. For example, if an edge connects the component containing $P_3$ to the component containing $P_5$, the component of $P_5$ dies and merges with that of $P_3$. The \"death\" time of the dying component is the value of $\\epsilon$ at which the merger occurs.\n4.  One component, associated with the lowest-indexed point of the final merged set, will never die. It has an infinite persistence.\n\nThe persistence of a component is defined as its death time minus its birth time. Calculate the total persistence, which is the sum of the persistences for all components that have a finite lifetime. Express your final answer in units of days.", "solution": "We are given five points in the plane with coordinates $(x,t)$ and the Chebyshev distance\n$$\nd(P_{i},P_{j})=\\max\\left(|x_{i}-x_{j}|,\\;|t_{i}-t_{j}|\\right).\n$$\nWe analyze the $H_{0}$ persistence under the Vietorisâ€“Rips filtration induced by this distance: edges appear when $d(P_{i},P_{j})\\leq \\epsilon$, and connected components merge when an edge connects two previously disconnected components. Each component is born at $\\epsilon=0$, and when two components merge, the one associated with the higher-indexed point dies; one component (associated with the lowest index in the final component set) persists forever. The total persistence is the sum of the death times of all components that die (i.e., all but the final surviving component).\n\nFirst compute all pairwise Chebyshev distances:\n- Between $P_{1}=(1,2)$ and $P_{2}=(3,1)$:\n$$\nd(P_{1},P_{2})=\\max(|1-3|,|2-1|)=\\max(2,1)=2.\n$$\n- Between $P_{1}=(1,2)$ and $P_{3}=(10,8)$:\n$$\nd(P_{1},P_{3})=\\max(|1-10|,|2-8|)=\\max(9,6)=9.\n$$\n- Between $P_{1}=(1,2)$ and $P_{4}=(8,10)$:\n$$\nd(P_{1},P_{4})=\\max(|1-8|,|2-10|)=\\max(7,8)=8.\n$$\n- Between $P_{1}=(1,2)$ and $P_{5}=(6,6)$:\n$$\nd(P_{1},P_{5})=\\max(|1-6|,|2-6|)=\\max(5,4)=5.\n$$\n- Between $P_{2}=(3,1)$ and $P_{3}=(10,8)$:\n$$\nd(P_{2},P_{3})=\\max(|3-10|,|1-8|)=\\max(7,7)=7.\n$$\n- Between $P_{2}=(3,1)$ and $P_{4}=(8,10)$:\n$$\nd(P_{2},P_{4})=\\max(|3-8|,|1-10|)=\\max(5,9)=9.\n$$\n- Between $P_{2}=(3,1)$ and $P_{5}=(6,6)$:\n$$\nd(P_{2},P_{5})=\\max(|3-6|,|1-6|)=\\max(3,5)=5.\n$$\n- Between $P_{3}=(10,8)$ and $P_{4}=(8,10)$:\n$$\nd(P_{3},P_{4})=\\max(|10-8|,|8-10|)=\\max(2,2)=2.\n$$\n- Between $P_{3}=(10,8)$ and $P_{5}=(6,6)$:\n$$\nd(P_{3},P_{5})=\\max(|10-6|,|8-6|)=\\max(4,2)=4.\n$$\n- Between $P_{4}=(8,10)$ and $P_{5}=(6,6)$:\n$$\nd(P_{4},P_{5})=\\max(|8-6|,|10-6|)=\\max(2,4)=4.\n$$\n\nSort the potential edges by increasing $\\epsilon$ (distance):\n- $\\epsilon=2$: edges $(1,2)$ and $(3,4)$.\n- $\\epsilon=4$: edges $(3,5)$ and $(4,5)$.\n- $\\epsilon=5$: edges $(1,5)$ and $(2,5)$.\n- $\\epsilon=7$: edge $(2,3)$.\n- $\\epsilon=8$: edge $(1,4)$.\n- $\\epsilon=9$: edges $(1,3)$ and $(2,4)$.\n\nNow run the filtration, merging components when an edge first connects two previously disconnected components, and applying the elder (lower-index) rule to determine which component dies:\n- At $\\epsilon=0$: five components $\\{1\\}$, $\\{2\\}$, $\\{3\\}$, $\\{4\\}$, $\\{5\\}$, all born at $0$.\n- At $\\epsilon=2$:\n  - Edge $(1,2)$ connects $\\{1\\}$ and $\\{2\\}$. The lower index is $1$, so component of $2$ dies at $\\epsilon=2$, and $\\{1,2\\}$ remains with representative $1$.\n  - Edge $(3,4)$ connects $\\{3\\}$ and $\\{4\\}$. The lower index is $3$, so component of $4$ dies at $\\epsilon=2$, and $\\{3,4\\}$ remains with representative $3$.\n  Current components: $\\{1,2\\}$ (rep $1$), $\\{3,4\\}$ (rep $3$), $\\{5\\}$ (rep $5$).\n- At $\\epsilon=4$:\n  - Edge $(3,5)$ connects $\\{3,4\\}$ and $\\{5\\}$. The lower index between reps $3$ and $5$ is $3$, so component of $5$ dies at $\\epsilon=4$, and $\\{3,4,5\\}$ remains with rep $3$.\n  - Edge $(4,5)$ is redundant (both already in the same component), so no effect.\n  Current components: $\\{1,2\\}$ (rep $1$), $\\{3,4,5\\}$ (rep $3$).\n- At $\\epsilon=5$:\n  - Edge $(1,5)$ connects $\\{1,2\\}$ (rep $1$) and $\\{3,4,5\\}$ (rep $3$). The lower index is $1$, so the component with rep $3$ dies at $\\epsilon=5$, merging into the component with rep $1$. Now all points are in one component $\\{1,2,3,4,5\\}$ with rep $1$.\n  - Edge $(2,5)$ is redundant, as the graph is already connected.\n- For larger $\\epsilon$, any additional edges connect points already in the single component; no further deaths occur. The component represented by point $1$ persists forever.\n\nThus, the finite lifetimes (persistences) are:\n- Component of $2$: death at $2$; persistence $2-0=2$.\n- Component of $4$: death at $2$; persistence $2-0=2$.\n- Component of $5$: death at $4$; persistence $4-0=4$.\n- Component of $3$: death at $5$; persistence $5-0=5$.\nThe component of $1$ has infinite persistence and is excluded from the sum.\n\nTherefore, the total persistence (sum over finite lifetimes) is\n$$\n2+2+4+5=13.\n$$\nBy the theory of $H_{0}$ persistence under such filtrations, this sum also equals the total weight of a minimum spanning tree on the points with edge weights given by the Chebyshev distances, which here is $2+2+4+5=13$, confirming the result.\n\nThe final answer, in days, is $13$.", "answer": "$$\\boxed{13}$$", "id": "1457477"}]}