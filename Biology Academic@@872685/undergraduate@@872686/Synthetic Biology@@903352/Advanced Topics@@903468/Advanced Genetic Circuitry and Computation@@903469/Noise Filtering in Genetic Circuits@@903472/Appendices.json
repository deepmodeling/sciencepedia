{"hands_on_practices": [{"introduction": "Before we can design circuits to filter noise, we must first understand how it travels through a system. In this first exercise, we will analyze a simple two-gene transcriptional cascade, a fundamental building block in many synthetic constructs. You will quantify how random fluctuations, or noise, from an upstream activator protein propagate to a downstream target, and see how the cell's natural protein turnover rates create a basic low-pass filter [@problem_id:2051273]. This calculation provides a concrete baseline for understanding the necessity and impact of more sophisticated noise-filtering strategies.", "problem": "In the field of synthetic biology, understanding and controlling noise in gene expression is crucial for engineering robust biological circuits. Consider a simple transcriptional cascade designed in a bacterium, where a protein X acts as a transcriptional activator for a downstream gene that produces protein Y.\n\nThe dynamics of the system at the protein level are modeled as follows:\n- Protein X is produced at a constant average rate and is degraded or diluted with a first-order rate constant $\\gamma_X$. At steady state, a consequence of these stochastic birth-death processes is that the number of X molecules, $n_X$, can be modeled by a Poisson distribution. This results in a squared coefficient of variation (a measure of noise strength) of $CV_X^2 = 1/\\langle n_X \\rangle$, where $\\langle n_X \\rangle$ is the mean number of X molecules.\n- The production rate of protein Y is linearly dependent on the number of X activator molecules, such that the instantaneous rate is $k_{s,Y} = \\beta n_X$, for some constant $\\beta$. Protein Y is degraded or diluted with a first-order rate constant $\\gamma_Y$.\n\nFor such a linear cascade, the total noise strength of the downstream protein Y, $CV_Y^2 = \\sigma_Y^2 / \\langle n_Y \\rangle^2$, is the sum of its intrinsic noise (from its own stochastic production and degradation) and the extrinsic noise propagated from the upstream activator X. The theory of stochastic gene expression provides the following relation for the total noise:\n$$CV_Y^2 = \\frac{1}{\\langle n_Y \\rangle} + \\left( \\frac{\\gamma_Y}{\\gamma_X + \\gamma_Y} \\right) CV_X^2$$\nThe term $\\frac{\\gamma_Y}{\\gamma_X + \\gamma_Y}$ acts as a low-pass filter, determining the fraction of noise from X that is transmitted to Y based on their relative degradation (turnover) rates.\n\nYou are given the following steady-state parameters for the system:\n- Mean number of activator molecules, $\\langle n_X \\rangle = 100$.\n- Mean number of output molecules, $\\langle n_Y \\rangle = 500$.\n- Degradation rate constant for X, $\\gamma_X = 0.020 \\text{ min}^{-1}$.\n- Degradation rate constant for Y, $\\gamma_Y = 0.10 \\text{ min}^{-1}$.\n\nCalculate the total noise strength, $CV_Y^2$, for the output protein Y. Provide your answer as a single numerical value, rounded to three significant figures.", "solution": "We use the provided relation for the total noise of the downstream protein:\n$$CV_{Y}^{2}=\\frac{1}{\\langle n_{Y}\\rangle}+\\left(\\frac{\\gamma_{Y}}{\\gamma_{X}+\\gamma_{Y}}\\right)CV_{X}^{2}.$$\nFor a Poisson-distributed upstream species, the squared coefficient of variation is\n$$CV_{X}^{2}=\\frac{1}{\\langle n_{X}\\rangle}=\\frac{1}{100}.$$\nThe intrinsic noise term for protein Y is\n$$\\frac{1}{\\langle n_{Y}\\rangle}=\\frac{1}{500}.$$\nThe low-pass filtering factor is\n$$\\frac{\\gamma_{Y}}{\\gamma_{X}+\\gamma_{Y}}=\\frac{0.10}{0.020+0.10}=\\frac{0.10}{0.12}=\\frac{5}{6}.$$\nHence the extrinsic contribution to $CV_{Y}^{2}$ is\n$$\\left(\\frac{5}{6}\\right)\\left(\\frac{1}{100}\\right)=\\frac{1}{120}.$$\nTherefore, the total noise strength is\n$$CV_{Y}^{2}=\\frac{1}{500}+\\frac{1}{120}=\\frac{12}{6000}+\\frac{50}{6000}=\\frac{62}{6000}=\\frac{31}{3000}.$$\nConverting to a decimal and rounding to three significant figures:\n$$\\frac{31}{3000}=0.010333\\ldots \\approx 0.0103.$$", "answer": "$$\\boxed{0.0103}$$", "id": "2051273"}, {"introduction": "Having seen how noise propagates, we now turn to a powerful and ubiquitous design motif for actively suppressing it: negative feedback. In biology, negative autoregulation—where a protein inhibits its own production—is a key mechanism for maintaining homeostasis and ensuring robust function against perturbations. This practice challenges you to apply the principles of linear systems theory to a genetic circuit, modeling it to derive a quantitative measure of its noise-suppression capability [@problem_id:2051274]. By doing so, you will see precisely how feedback enhances the stability of a genetic circuit against noisy inputs.", "problem": "In synthetic biology, a common design challenge is to create genetic circuits that are robust to fluctuations in the cell's metabolic state. Consider a synthetic gene circuit designed to produce a protein $P$. The production of this protein is activated by the cell's energetic state, which we represent by the concentration of a signaling molecule $A$ (conceptually related to the ratio of Adenosine Triphosphate (ATP) to Adenosine Diphosphate (ADP)). To buffer against rapid fluctuations, or \"noise\", in the energy state, the circuit employs a negative feedback loop where the protein $P$ represses its own transcription.\n\nThe dynamics of this system can be modeled by a set of linearized differential equations describing the fluctuations of the messenger RNA (mRNA) concentration, $\\delta m(t)$, and the protein concentration, $\\delta p(t)$, around their stable steady-state operating point. These equations are given by:\n$$ \\frac{d(\\delta m)}{dt} = G_A \\delta A(t) - G_p \\delta p(t) - \\gamma_m \\delta m(t) $$\n$$ \\frac{d(\\delta p)}{dt} = k_{tln} \\delta m(t) - \\gamma_p \\delta p(t) $$\n\nHere, $\\delta A(t)$ represents the fluctuation in the signaling molecule concentration around its mean value. The parameters of the model are all positive real constants:\n-   $G_A$: The gain that quantifies how strongly the signaling molecule $A$ activates transcription.\n-   $G_p$: The gain of the negative feedback loop from the protein $P$ to its own transcription.\n-   $\\gamma_m$: The effective degradation and dilution rate of the mRNA.\n-   $\\gamma_p$: The effective degradation and dilution rate of the protein.\n-   $k_{tln}$: The rate of protein translation from mRNA.\n\nThe fluctuations in the cellular energy state, $\\delta A(t)$, are modeled as a white noise process. This means the fluctuations have no temporal correlation and their power is distributed uniformly across all frequencies. The power spectral density of this input noise is constant, $S_A(\\omega) = \\eta$, for all angular frequencies $\\omega$.\n\nYour task is to quantify the effectiveness of the negative feedback loop in suppressing noise. Calculate the noise suppression factor, $\\mathcal{S}$, which is defined as the ratio of the total variance of the protein concentration fluctuations with feedback ($\\sigma_p^2$) to the total variance that would be present if the feedback loop were disabled ($\\sigma_{p,0}^2$). A system without feedback is described by the same set of equations, but with $G_p = 0$.\n\nExpress your answer as a closed-form analytic expression in terms of the given system parameters: $\\gamma_m$, $\\gamma_p$, $k_{tln}$, and $G_p$.", "solution": "We begin by deriving the transfer function from the input fluctuation $\\delta A(t)$ to the protein fluctuation $\\delta p(t)$. Taking the Laplace transform of the linearized system,\n$$\ns M(s) = G_A A(s) - G_p P(s) - \\gamma_m M(s), \\quad\ns P(s) = k_{tln} M(s) - \\gamma_p P(s),\n$$\nwe solve the first equation for $M(s)$:\n$$\nM(s) = \\frac{G_A A(s) - G_p P(s)}{s + \\gamma_m}.\n$$\nSubstituting into the second equation gives\n$$\n(s + \\gamma_p) P(s) = \\frac{k_{tln}}{s + \\gamma_m}\\left(G_A A(s) - G_p P(s)\\right),\n$$\nwhich rearranges to\n$$\n\\left[(s + \\gamma_p)(s + \\gamma_m) + k_{tln} G_p\\right] P(s) = k_{tln} G_A A(s).\n$$\nHence the transfer function from $A$ to $p$ is\n$$\nH(s) \\equiv \\frac{P(s)}{A(s)} = \\frac{k_{tln} G_A}{(s + \\gamma_p)(s + \\gamma_m) + k_{tln} G_p}.\n$$\nWith feedback disabled ($G_p = 0$), the transfer function becomes\n$$\nH_0(s) = \\frac{k_{tln} G_A}{(s + \\gamma_p)(s + \\gamma_m)}.\n$$\n\nThe input $\\delta A(t)$ is white noise with power spectral density $S_A(\\omega) = \\eta$. For a stable, strictly proper LTI system, the output variance is\n$$\n\\sigma_p^{2} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_A(\\omega) \\left|H(i\\omega)\\right|^{2} d\\omega = \\eta \\left\\|H\\right\\|_{2}^{2},\n$$\nwhere $\\left\\|H\\right\\|_{2}^{2}$ is the squared $\\mathcal{H}_{2}$ norm. Therefore, the noise suppression factor is the ratio of squared $\\mathcal{H}_{2}$ norms,\n$$\n\\mathcal{S} = \\frac{\\sigma_p^{2}}{\\sigma_{p,0}^{2}} = \\frac{\\left\\|H\\right\\|_{2}^{2}}{\\left\\|H_0\\right\\|_{2}^{2}},\n$$\nwhich is independent of both $G_A$ and $\\eta$.\n\nTo compute $\\left\\|H\\right\\|_{2}^{2}$, we use the state-space realization\n$$\n\\frac{d}{dt}\\begin{bmatrix} \\delta m \\\\ \\delta p \\end{bmatrix}\n=\n\\underbrace{\\begin{bmatrix} -\\gamma_m & -G_p \\\\ k_{tln} & -\\gamma_p \\end{bmatrix}}_{A}\n\\begin{bmatrix} \\delta m \\\\ \\delta p \\end{bmatrix}\n+\n\\underbrace{\\begin{bmatrix} G_A \\\\ 0 \\end{bmatrix}}_{B}\\delta A, \\quad\n\\delta p = \\underbrace{\\begin{bmatrix} 0 & 1 \\end{bmatrix}}_{C}\n\\begin{bmatrix} \\delta m \\\\ \\delta p \\end{bmatrix}.\n$$\nFor a stable system with $D=0$, the squared $\\mathcal{H}_{2}$ norm equals $C P C^{\\top}$, where $P$ is the controllability Gramian solving the Lyapunov equation\n$$\nA P + P A^{\\top} + B B^{\\top} = 0.\n$$\nLet $P = \\begin{bmatrix} x & y \\\\ y & z \\end{bmatrix}$ and $B B^{\\top} = \\begin{bmatrix} G_A^{2} & 0 \\\\ 0 & 0 \\end{bmatrix}$. Computing $A P + P A^{\\top} + B B^{\\top}$ elementwise yields\n$$\n-2 \\gamma_m x - 2 G_p y + G_A^{2} = 0,\n$$\n$$\nk_{tln} x - (\\gamma_m + \\gamma_p) y - G_p z = 0,\n$$\n$$\n2 k_{tln} y - 2 \\gamma_p z = 0.\n$$\nFrom the third equation, $y = (\\gamma_p / k_{tln}) z$. Substituting into the second gives\n$$\nk_{tln} x = \\left(\\frac{(\\gamma_m + \\gamma_p)\\gamma_p}{k_{tln}} + G_p\\right) z,\n$$\nso\n$$\nx = \\left(\\frac{(\\gamma_m + \\gamma_p)\\gamma_p}{k_{tln}^{2}} + \\frac{G_p}{k_{tln}}\\right) z.\n$$\nSubstituting $x$ and $y$ into the first equation yields\n$$\nG_A^{2} = 2 \\gamma_m x + 2 G_p y\n= \\frac{2 z}{k_{tln}^{2}}\\left[\\gamma_m (\\gamma_m + \\gamma_p)\\gamma_p + k_{tln} G_p (\\gamma_m + \\gamma_p)\\right].\n$$\nTherefore,\n$$\nz = P_{22} = \\frac{G_A^{2} k_{tln}^{2}}{2 (\\gamma_m + \\gamma_p)\\left(\\gamma_m \\gamma_p + k_{tln} G_p\\right)}.\n$$\nSince $\\left\\|H\\right\\|_{2}^{2} = C P C^{\\top} = z$, we have\n$$\n\\left\\|H\\right\\|_{2}^{2} = \\frac{G_A^{2} k_{tln}^{2}}{2 (\\gamma_m + \\gamma_p)\\left(\\gamma_m \\gamma_p + k_{tln} G_p\\right)}.\n$$\nIn the absence of feedback ($G_p = 0$),\n$$\n\\left\\|H_0\\right\\|_{2}^{2} = \\frac{G_A^{2} k_{tln}^{2}}{2 (\\gamma_m + \\gamma_p)\\left(\\gamma_m \\gamma_p\\right)}.\n$$\nTaking the ratio, the factors $G_A^{2}$, $k_{tln}^{2}$, and $(\\gamma_m + \\gamma_p)$ cancel, giving the noise suppression factor\n$$\n\\mathcal{S} = \\frac{\\gamma_m \\gamma_p}{\\gamma_m \\gamma_p + k_{tln} G_p}.\n$$\nThis expression depends only on $\\gamma_m$, $\\gamma_p$, $k_{tln}$, and $G_p$, and satisfies $0 < \\mathcal{S} < 1$ for $G_p > 0$, as expected for effective negative feedback.", "answer": "$$\\boxed{\\frac{\\gamma_m \\gamma_p}{\\gamma_m \\gamma_p + k_{tln} G_p}}$$", "id": "2051274"}, {"introduction": "An alternative to actively suppressing noise is to design a circuit whose output is inherently immune to it. This final practice explores ratiometric sensing, an elegant feed-forward strategy where the output of a target protein is normalized by that of a co-expressed reference protein. This design is particularly effective at cancelling out \"extrinsic\" noise from global cellular fluctuations, such as changes in ribosome availability, which affect both proteins similarly [@problem_id:2051303]. Your task is to analyze the transient behavior of such a system, revealing both the power of this approach and its potential limitations during dynamic changes.", "problem": "A synthetic genetic circuit is designed to function as a biosensor inside a living cell. The sensor's goal is to provide a stable reading of a constant environmental signal, even when the cell's internal state fluctuates. The circuit produces a target protein, T, whose production rate is proportional to the signal, and a reference protein, R, which is produced at a constant rate.\n\nThe concentrations of the two proteins, denoted as $[T]$ and $[R]$, are governed by the following rate equations:\n$$\n\\frac{d[R]}{dt} = \\alpha_R \\eta(t) - \\delta_R [R]\n$$\n$$\n\\frac{d[T]}{dt} = \\alpha_T \\eta(t) - \\delta_T [T]\n$$\nHere, $\\alpha_R$ and $\\alpha_T$ are constant production rate parameters, with $\\alpha_T$ representing the strength of the environmental signal. The terms $\\delta_R$ and $\\delta_T$ are the first-order degradation rate constants for R and T, respectively. A key design constraint of this circuit is that the target protein is engineered to degrade exactly twice as fast as the reference protein, such that $\\delta_T = 2\\delta_R$.\n\nThe function $\\eta(t)$ represents the time-varying global state of the cell's protein synthesis machinery (e.g., availability of ribosomes and amino acids). It acts as a multiplicative extrinsic noise source.\n\nInitially, for all time $t < 0$, the cell is in a stable, steady state with $\\eta(t) = 1$. At time $t=0$, the cell experiences a sudden stress that reduces the available resources, causing the global synthesis factor to instantly drop to a new constant value $\\eta(t) = \\eta_0$ for all $t \\ge 0$, where $0 < \\eta_0 < 1$.\n\nThe sensor's output is the ratiometric value $Z(t) = [T](t)/[R](t)$. The performance of the sensor during the transient period is assessed by the transient relative error, defined as $\\epsilon(t) = (Z(t) / Z_{ss}) - 1$, where $Z_{ss}$ is the constant steady-state ratio observed when $\\eta(t)$ is constant.\n\nDetermine the maximum magnitude of this transient relative error, $|\\epsilon_{max}|$, that occurs for $t > 0$. Express your answer as a symbolic expression in terms of $\\eta_0$.", "solution": "Under constant $\\eta(t)=\\eta$, the steady states satisfy $0=\\alpha_{R}\\eta-\\delta_{R}[R]$ and $0=\\alpha_{T}\\eta-\\delta_{T}[T]$, giving\n$$\n[R]_{ss}=\\frac{\\alpha_{R}\\eta}{\\delta_{R}},\\qquad [T]_{ss}=\\frac{\\alpha_{T}\\eta}{\\delta_{T}}.\n$$\nHence the steady-state ratio is\n$$\nZ_{ss}=\\frac{[T]_{ss}}{[R]_{ss}}=\\frac{\\alpha_{T}/\\delta_{T}}{\\alpha_{R}/\\delta_{R}},\n$$\nwhich is independent of $\\eta$.\n\nFor $t<0$, $\\eta(t)=1$ and the system is at steady state:\n$$\n[R](0)=\\frac{\\alpha_{R}}{\\delta_{R}},\\qquad [T](0)=\\frac{\\alpha_{T}}{\\delta_{T}}.\n$$\nFor $t\\ge 0$, $\\eta(t)=\\eta_{0}$ is constant. With $\\delta_{T}=2\\delta_{R}$, let $\\delta_{R}=d$ so $\\delta_{T}=2d$. Solving the linear ODEs with step input and the above initial conditions gives\n$$\n[R](t)=\\frac{\\alpha_{R}\\eta_{0}}{d}+\\left(\\frac{\\alpha_{R}}{d}-\\frac{\\alpha_{R}\\eta_{0}}{d}\\right)\\exp(-d t)\n=\\frac{\\alpha_{R}}{d}\\left[\\eta_{0}+(1-\\eta_{0})\\exp(-d t)\\right],\n$$\n$$\n[T](t)=\\frac{\\alpha_{T}\\eta_{0}}{2d}+\\left(\\frac{\\alpha_{T}}{2d}-\\frac{\\alpha_{T}\\eta_{0}}{2d}\\right)\\exp(-2d t)\n=\\frac{\\alpha_{T}}{2d}\\left[\\eta_{0}+(1-\\eta_{0})\\exp(-2d t)\\right].\n$$\nTherefore,\n$$\nZ(t)=\\frac{[T](t)}{[R](t)}=\\frac{\\alpha_{T}}{2\\alpha_{R}}\\cdot\n\\frac{\\eta_{0}+(1-\\eta_{0})\\exp(-2d t)}{\\eta_{0}+(1-\\eta_{0})\\exp(-d t)}.\n$$\nSince $Z_{ss}=\\alpha_{T}/(2\\alpha_{R})$, the transient relative error is\n$$\n\\epsilon(t)=\\frac{Z(t)}{Z_{ss}}-1=\\frac{\\eta_{0}+(1-\\eta_{0})\\exp(-2d t)}{\\eta_{0}+(1-\\eta_{0})\\exp(-d t)}-1\n=\\frac{(1-\\eta_{0})\\left[\\exp(-2d t)-\\exp(-d t)\\right]}{\\eta_{0}+(1-\\eta_{0})\\exp(-d t)}.\n$$\nFor $t>0$, $\\exp(-2d t)-\\exp(-d t)<0$ and $0<\\eta_{0}<1$, so $\\epsilon(t)<0$. Let $y=\\exp(-d t)\\in(0,1)$; then\n$$\n\\epsilon(y)=\\frac{(1-\\eta_{0})(y^{2}-y)}{\\eta_{0}+(1-\\eta_{0})y}.\n$$\nTo find the extremum on $y\\in(0,1)$, differentiate and set to zero. With $A=1-\\eta_{0}$ and $B=\\eta_{0}$,\n$$\n\\epsilon(y)=\\frac{A(y^{2}-y)}{B+Ay},\\qquad\n\\frac{d\\epsilon}{dy}=\\frac{A\\left[Ay^{2}+2By-B\\right]}{(B+Ay)^{2}}.\n$$\nSetting the numerator to zero yields the quadratic\n$$\nA y^{2}+2B y-B=0.\n$$\nSolving gives\n$$\ny^{*}=\\frac{-B+\\sqrt{B(B+A)}}{A}=\\frac{\\sqrt{B}-B}{A}.\n$$\nWith $B=\\eta_{0}$ and $A=1-\\eta_{0}$, let $s=\\sqrt{\\eta_{0}}$ so $A=1-s^{2}$; then\n$$\ny^{*}=\\frac{s}{1+s}.\n$$\nEvaluate $\\epsilon$ at $y^{*}$. Using $y^{*}=s/(1+s)$,\n$$\ny^{*2}-y^{*}=-\\frac{s}{(1+s)^{2}},\\qquad B+Ay^{*}=s^{2}+(1-s^{2})\\frac{s}{1+s}=s.\n$$\nHence\n$$\n\\epsilon(y^{*})=\\frac{A(y^{*2}-y^{*})}{B+Ay^{*}}\n=\\frac{(1-s^{2})\\left[-\\frac{s}{(1+s)^{2}}\\right]}{s}\n=-\\frac{1-s}{1+s}.\n$$\nTherefore the maximum magnitude of the transient relative error for $t>0$ is\n$$\n|\\epsilon_{max}|=\\frac{1-\\sqrt{\\eta_{0}}}{1+\\sqrt{\\eta_{0}}}.\n$$", "answer": "$$\\boxed{\\frac{1-\\sqrt{\\eta_{0}}}{1+\\sqrt{\\eta_{0}}}}$$", "id": "2051303"}]}