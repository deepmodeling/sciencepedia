{"hands_on_practices": [{"introduction": "Before building complex counters, we must first understand the dynamics of a single bit flip. This exercise explores the fundamental kinetics of gene expression, modeling the transition of a genetic switch from an 'OFF' to an 'ON' state [@problem_id:2022490]. By solving for the time it takes to reach a threshold protein concentration, you will gain a quantitative appreciation for the delays and transient behaviors inherent in biological circuits.", "problem": "A synthetic biologist is constructing a genetic toggle switch, a fundamental component for creating a biological counter in a cell. The state of one bit in this counter is represented by the concentration of a reporter protein. When the bit is '0', the gene for this protein is completely repressed. When the bit flips to '1', this repression is removed, and the gene is expressed.\n\nConsider a simplified model of this \"flip\" process. At time $t < 0$, the system is in the '0' state, so the concentrations of both the reporter's messenger RNA (mRNA) and the reporter protein itself are zero. At $t = 0$, an inducer molecule is introduced, which instantly and completely lifts the repression. The gene begins to be transcribed and subsequently translated.\n\nThe dynamics of the system for $t \\ge 0$ can be modeled by the following processes:\n1.  The concentration of mRNA, $M(t)$, is produced at a constant rate $\\alpha_M$ and degrades with a first-order rate constant $\\delta_M$.\n2.  The concentration of the reporter protein, $P(t)$, is translated from the mRNA at a rate proportional to $M(t)$ with a rate constant $\\alpha_P$, and it degrades with a first-order rate constant $\\delta_P$.\n\nTo simplify the analysis, assume that the degradation rate constants for the mRNA and the protein are equal: $\\delta_M = \\delta_P = \\delta$.\n\nThe bit is considered to have successfully flipped from '0' to '1' when the protein concentration $P(t)$ reaches exactly half of its final, long-term steady-state value. Determine the analytic expression for the time $T$ required for this flip to occur, expressed in terms of the given parameters.", "solution": "The problem asks for the time $T$ at which the protein concentration $P(t)$ reaches half of its steady-state value. We first need to find the expression for $P(t)$ by solving the system of differential equations that describe the model.\n\nThe system of differential equations is given by:\n1.  mRNA dynamics: $\\frac{dM}{dt} = \\alpha_M - \\delta M$\n2.  Protein dynamics: $\\frac{dP}{dt} = \\alpha_P M - \\delta P$\n\nThe initial conditions are $M(0) = 0$ and $P(0) = 0$.\n\nFirst, we solve the differential equation for the mRNA concentration, $M(t)$. This is a first-order linear ordinary differential equation.\n$$ \\frac{dM}{dt} + \\delta M = \\alpha_M $$\nThe solution can be found using an integrating factor $e^{\\int \\delta dt} = e^{\\delta t}$.\n$$ \\frac{d}{dt}(M e^{\\delta t}) = \\alpha_M e^{\\delta t} $$\nIntegrating with respect to $t$:\n$$ M(t) e^{\\delta t} = \\int \\alpha_M e^{\\delta t} dt = \\frac{\\alpha_M}{\\delta} e^{\\delta t} + C_1 $$\nwhere $C_1$ is the constant of integration.\nSolving for $M(t)$:\n$$ M(t) = \\frac{\\alpha_M}{\\delta} + C_1 e^{-\\delta t} $$\nUsing the initial condition $M(0) = 0$:\n$$ 0 = \\frac{\\alpha_M}{\\delta} + C_1 e^0 \\implies C_1 = -\\frac{\\alpha_M}{\\delta} $$\nSo, the concentration of mRNA as a function of time is:\n$$ M(t) = \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) $$\n\nNext, we solve the differential equation for the protein concentration, $P(t)$, by substituting the expression for $M(t)$:\n$$ \\frac{dP}{dt} + \\delta P = \\alpha_P M(t) = \\alpha_P \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) $$\nThis is another first-order linear ODE. The integrating factor is again $e^{\\delta t}$.\n$$ \\frac{d}{dt}(P e^{\\delta t}) = \\alpha_P \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) e^{\\delta t} = \\frac{\\alpha_P \\alpha_M}{\\delta} (e^{\\delta t} - 1) $$\nIntegrating with respect to $t$:\n$$ P(t) e^{\\delta t} = \\int \\frac{\\alpha_P \\alpha_M}{\\delta} (e^{\\delta t} - 1) dt = \\frac{\\alpha_P \\alpha_M}{\\delta} \\left(\\frac{1}{\\delta}e^{\\delta t} - t\\right) + C_2 $$\nwhere $C_2$ is the constant of integration.\nSolving for $P(t)$:\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - \\frac{\\alpha_P \\alpha_M}{\\delta} t e^{-\\delta t} + C_2 e^{-\\delta t} $$\nUsing the initial condition $P(0)=0$:\n$$ 0 = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - 0 + C_2 e^0 \\implies C_2 = -\\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\nSubstituting $C_2$ back into the expression for $P(t)$:\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - \\frac{\\alpha_P \\alpha_M}{\\delta} t e^{-\\delta t} - \\frac{\\alpha_P \\alpha_M}{\\delta^2} e^{-\\delta t} $$\nFactoring out the constant term gives the final expression for $P(t)$:\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta t} - \\delta t e^{-\\delta t} \\right) $$\n\nNow, we must find the steady-state protein concentration, $P_{ss}$. This is the limit of $P(t)$ as $t \\to \\infty$.\n$$ P_{ss} = \\lim_{t \\to \\infty} P(t) = \\lim_{t \\to \\infty} \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta t} - \\delta t e^{-\\delta t} \\right) $$\nSince $\\delta > 0$, both $e^{-\\delta t}$ and $t e^{-\\delta t}$ approach 0 as $t \\to \\infty$.\n$$ P_{ss} = \\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n\nThe problem defines the switching time $T$ as the time when $P(T) = \\frac{1}{2} P_{ss}$.\n$$ \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta T} - \\delta T e^{-\\delta T} \\right) = \\frac{1}{2} \\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\nThe term $\\frac{\\alpha_P \\alpha_M}{\\delta^2}$ cancels from both sides:\n$$ 1 - e^{-\\delta T} - \\delta T e^{-\\delta T} = \\frac{1}{2} $$\n$$ \\frac{1}{2} = e^{-\\delta T} (1 + \\delta T) $$\nThis is a transcendental equation for $T$. Let $x = \\delta T$. The equation becomes:\n$$ (1+x)e^{-x} = \\frac{1}{2} \\implies 1+x = \\frac{1}{2} e^x $$\nTo solve for $x$, we use the Lambert W function, which is defined as the solution to the equation $W(z)e^{W(z)} = z$. We need to manipulate our equation into this form.\n$$ -(1+x) = -\\frac{1}{2}e^x $$\nMultiply by $e^{-1}$:\n$$ -(1+x)e^{-1} = -\\frac{1}{2}e^{x-1} $$\nLet $y = -(1+x)$. Then $x = -1-y$. Substituting this gives:\n$$ y e^{-1} = -\\frac{1}{2}e^{(-1-y)-1} = -\\frac{1}{2}e^{-y-2} $$\n$$ y e^{y} = -\\frac{1}{2}e^{-2}e^{-1} = -\\frac{e^{-1}}{2} $$\nSo we have $y e^y = z$ with $z = -\\frac{1}{2e}$.\nThis means $y = W(-\\frac{1}{2e})$, where $W$ is the Lambert W function.\nFor an argument $z \\in [-1/e, 0)$, the Lambert W function has two real branches: the principal branch $W_0(z)$ (with range $[-1, \\infty)$) and the lower branch $W_{-1}(z)$ (with range $(-\\infty, -1]$).\nOur argument is $z = -1/(2e) \\approx -0.184$, which lies in this interval.\nSince $x = \\delta T > 0$, we have $y = -(1+x) < -1$. Therefore, we must choose the $W_{-1}$ branch, as its range is $(-\\infty, -1]$.\nSo, $y = W_{-1}(-\\frac{1}{2e})$.\nNow we solve for $T$:\n$$ x = -1-y = -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) $$\n$$ \\delta T = -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) $$\n$$ T = \\frac{1}{\\delta} \\left[ -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) \\right] $$\nThis is the final analytic expression for the switching time $T$.", "answer": "$$\\boxed{\\frac{1}{\\delta}\\left(-1 - W_{-1}\\left(-\\frac{1}{2e}\\right)\\right)}$$", "id": "2022490"}, {"introduction": "Real-world biological circuits often need to integrate logic with memory to make robust decisions. This problem challenges you to analyze a 'fail-safe' system that uses a site-specific recombinase to create an irreversible memory of a specific event [@problem_id:2022438]. You will practice combining logical interpretation of the circuit's behavior with the calculation of its dynamic output, a crucial skill in designing predictable synthetic systems.", "problem": "A synthetic biology research team is engineering a bacterial \"fail-safe\" system in *E. coli*. The system is designed to produce a valuable enzyme, modeled by the Green Fluorescent Protein (GFP), in response to a specific chemical inducer `Y`. However, to prevent unintended production in case of a contamination event flagged by a different chemical `X`, the system must be permanently shut down if it is ever exposed to `X`.\n\nThe genetic circuit implementing this logic is constructed as follows:\n\n1.  **Contamination Sensor Module**: The presence of chemical `X` induces a promoter `P_X`, leading to the production of a site-specific recombinase protein, `Rec`.\n2.  **Production Inducer Module**: The presence of chemical `Y` induces a promoter `P_Y`, leading to the production of an activator protein, `Act_Y`.\n3.  **Memory & Inhibition Module**: A strong constitutive promoter, `P_const`, is placed upstream of a DNA sequence encoding an inhibitor protein, `Inh`. Between `P_const` and the `Inh` gene, there is a strong transcriptional terminator sequence, `Term`, which is flanked by `Rec` recognition sites. The recombinase `Rec` can recognize these sites and irreversibly excise the `Term` sequence from the DNA. The inhibitor protein `Inh` functions by binding to the output promoter `P_out` and preventing its activation.\n4.  **Output Module**: The gene for GFP is placed under the control of the output promoter `P_out`. This promoter is activated only when the activator protein `Act_Y` binds to it. This activation is completely blocked if the `Inh` protein is also bound to `P_out`.\n\nFor your analysis, assume the following:\n- All promoters are \"tight,\" meaning there is no expression in their inactive state.\n- `P_const` is always active, but transcription is completely blocked as long as the `Term` sequence is present.\n- The action of the `Rec` recombinase is instantaneous and irreversible upon its production. The subsequent production of `Inh` and its binding to `P_out` are also considered instantaneous for the purposes of turning off `P_out`.\n- The production rate of GFP from a fully activated and uninhibited `P_out` promoter is a constant `\\alpha`.\n- The degradation and dilution rate of GFP is proportional to its current concentration, `[GFP]`, with a rate constant `\\gamma`. Thus, the concentration of GFP evolves according to $\\frac{d[\\text{GFP}]}{dt} = \\alpha - \\gamma[\\text{GFP}]$ when the promoter is ON, and $\\frac{d[\\text{GFP}]}{dt} = - \\gamma[\\text{GFP}]$ when the promoter is OFF.\n\nThe experiment starts at `t=0` with a bacterial culture that has no GFP, so `[GFP](0) = 0`. The following protocol is applied:\n- From `t=0` to `t=T`, the culture is exposed to chemical `Y` only.\n- From `t=T` to `t=2T`, chemical `X` is added to the culture, so both `X` and `Y` are present.\n- At `t=2T`, both chemicals are completely washed away.\n\nDetermine the concentration of GFP, `[GFP]`, at time `t = 3T`. Your answer should be a closed-form expression in terms of `\\alpha`, `\\gamma`, and `T`.", "solution": "Interpret the circuit logic and timing:\n- For $0 \\leq t < T$, only $Y$ is present, so $P_{Y}$ produces $Act\\_Y$, $P\\_{out}$ is activated (uninhibited because $Term$ is present and blocks $Inh$ expression), and GFP is produced. The governing ODE is $d[GFP]/dt=\\alpha-\\gamma[GFP]$ with initial condition $[GFP](0)=0$.\n- At $t=T$, $X$ is added. $P_{X}$ drives $Rec$ production, which instantaneously excises $Term$. This unblocks $P\\_{const}$, and $Inh$ is produced and binds $P\\_{out}$, turning it OFF immediately and irreversibly. Thus for $t \\geq T$, $P\\_{out}$ remains OFF even after the wash at $t=2T$ because $Inh$ is constitutively produced. The governing ODE for $t \\geq T$ is $d[GFP]/dt=-\\gamma[GFP]$ with continuity $[GFP](T^{-})=[GFP](T^{+})$.\n\nSolve on $[0,T)$:\nThe linear ODE $dG/dt=\\alpha-\\gamma G$ with $G(0)=0$ has solution\n$$\nG(t)=\\frac{\\alpha}{\\gamma}\\left(1-\\exp(-\\gamma t)\\right).\n$$\nTherefore,\n$$\nG(T)=\\frac{\\alpha}{\\gamma}\\left(1-\\exp(-\\gamma T)\\right).\n$$\n\nSolve on $[T,3T]$:\nWith the promoter OFF, $dG/dt=-\\gamma G$ and initial condition $G(T)$ from above gives\n$$\nG(t)=G(T)\\exp\\!\\left(-\\gamma(t-T)\\right).\n$$\nEvaluating at $t=3T$,\n$$\nG(3T)=\\frac{\\alpha}{\\gamma}\\left(1-\\exp(-\\gamma T)\\right)\\exp(-2\\gamma T)\n=\\frac{\\alpha}{\\gamma}\\left(\\exp(-2\\gamma T)-\\exp(-3\\gamma T)\\right).\n$$\nThis uses the fact that $\\left(1-\\exp(-\\gamma T)\\right)\\exp(-2\\gamma T)=\\exp(-2\\gamma T)-\\exp(-3\\gamma T)$.\n\nHence the GFP concentration at time $t=3T$ is the stated expression in terms of $\\alpha$, $\\gamma$, and $T$.", "answer": "$$\\boxed{\\frac{\\alpha}{\\gamma}\\left(\\exp(-2\\gamma T)-\\exp(-3\\gamma T)\\right)}$$", "id": "2022438"}, {"introduction": "While many counters rely on fluctuating protein concentrations, an alternative and powerful strategy uses DNA itself as a rewritable memory tape. This exercise introduces a DNA-based counter built from nested, invertible segments, a design sometimes called a 'genetic odometer' [@problem_id:2022417]. By modeling the system's state space, you will determine its counting capacity and explore a different paradigm for recording the history of cellular events.", "problem": "A synthetic biologist is designing a biological event counter using DNA as a storage medium. The system consists of four distinct, invertible DNA segments, labeled 1 to 4 from innermost to outermost. The orientation of each segment can be flipped by a specific recombinase enzyme. There are two types of recombinases available: Cre, which acts exclusively on `loxP` sites, and Flp, which acts on `FRT` sites. A segment flanked by `loxP` sites is called a 'Cre-unit', and one flanked by `FRT` sites is a 'Flp-unit'.\n\nThe segments are arranged in a nested 'Russian doll' architecture: Segment 2 contains Segment 1, Segment 3 contains Segment 2, and Segment 4 contains Segment 3. The state of the counter is defined by the orientation vector of the four segments relative to the main chromosome (the external frame of reference). For example, a state might be (forward, reverse, forward, forward). It has been established that when a segment is flipped by its corresponding recombinase, all segments nested inside it are also inverted with respect to the external frame. A pulse of a given recombinase (e.g., Cre) will simultaneously flip every segment that is a target for that recombinase (e.g., all Cre-units).\n\nIn this specific design, the innermost segment (1) and the outermost segment (4) are designated as Cre-units. The two middle segments (2 and 3) are designated as Flp-units. The counter starts in an initial state where all four segments are in the forward orientation. An 'event' consists of applying a pulse of either Cre or Flp recombinase.\n\nWhat is the maximum number of unique, sequential events, $N$, that this counter can record before any state (including the initial state) is repeated?", "solution": "Let each segment orientation be encoded by $x_{i} \\in \\{0,1\\}$ for $i \\in \\{1,2,3,4\\}$, where $x_{i}=0$ denotes forward and $x_{i}=1$ denotes reverse relative to the external frame. The initial state is $x^{(0)}=(0,0,0,0)$.\n\nA pulse of a given recombinase inverts the targeted segments and, by the nested architecture, also inverts all segments contained inside any targeted segment. Therefore, for a pulse targeting a set $T \\subset \\{1,2,3,4\\}$, the net effect on $x_{i}$ is to add (modulo $2$) the parity of the number of targeted ancestors of segment $i$, that is,\n$$\nx_{i} \\mapsto x_{i} + m_{i}(T) \\quad \\text{with} \\quad m_{i}(T) = \\left(\\sum_{j \\in T,\\, j \\ge i} 1\\right) \\bmod 2.\n$$\nHence a pulse is a translation $x \\mapsto x + m(T)$ in $\\mathbb{Z}_{2}^{4}$, where $m(T)=(m_{1}(T),m_{2}(T),m_{3}(T),m_{4}(T))$.\n\nIn this design, Cre targets $T_{C}=\\{1,4\\}$ and Flp targets $T_{F}=\\{2,3\\}$. Compute the masks:\n\n- For Cre, $T_{C}=\\{1,4\\}$:\n  - $m_{1}(T_{C}) = (1+1) \\bmod 2 = 0$,\n  - $m_{2}(T_{C}) = 1 \\bmod 2 = 1$ (only segment $4$ counts),\n  - $m_{3}(T_{C}) = 1 \\bmod 2 = 1$,\n  - $m_{4}(T_{C}) = 1 \\bmod 2 = 1$.\n  Thus,\n  $$\n  m^{C}=(0,1,1,1),\n  $$\n  i.e., a Cre pulse maps $(s_{1},s_{2},s_{3},s_{4}) \\mapsto (s_{1},-s_{2},-s_{3},-s_{4})$.\n\n- For Flp, $T_{F}=\\{2,3\\}$:\n  - $m_{1}(T_{F}) = (1+1) \\bmod 2 = 0$,\n  - $m_{2}(T_{F}) = (1+1) \\bmod 2 = 0$,\n  - $m_{3}(T_{F}) = 1 \\bmod 2 = 1$,\n  - $m_{4}(T_{F}) = 0$.\n  Thus,\n  $$\n  m^{F}=(0,0,1,0),\n  $$\n  i.e., a Flp pulse maps $(s_{1},s_{2},s_{3},s_{4}) \\mapsto (s_{1},s_{2},-s_{3},s_{4})$.\n\nTherefore, from $x^{(0)}=(0,0,0,0)$, the set of reachable states is the affine set\n$$\n\\{\\,x^{(0)} + a\\,m^{C} + b\\,m^{F} \\;:\\; a,b \\in \\{0,1\\}\\,\\},\n$$\nsince each pulse adds $m^{C}$ or $m^{F}$ in $\\mathbb{Z}_{2}^{4}$ and the operations commute. Because $m^{C}$ and $m^{F}$ are linearly independent over $\\mathbb{Z}_{2}$, there are exactly $2^{2}=4$ distinct reachable states. Consequently, at most $4$ unique states (including the initial state) can be visited.\n\nAn event is a pulse; to avoid any repeated state (including the initial state), one can visit all $4$ distinct states in at most $3$ events. For example, apply the sequence Flp, Cre, Flp to obtain four distinct states; any fourth event would repeat a previously visited state. Hence the maximum number of unique, sequential events recorded before any state repeats is\n$$\nN=4-1=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "2022417"}]}