{"hands_on_practices": [{"introduction": "The principle of parsimony, often likened to Occam's razor, is a fundamental concept in evolutionary biology that prefers the simplest explanation—the one requiring the fewest evolutionary changes. This first practice exercise [@problem_id:1908137] will guide you through calculating the parsimony score for a discrete trait on a given phylogeny. By working through this hypothetical scenario, you'll gain hands-on experience with the Fitch algorithm, a cornerstone method for ancestral state reconstruction.", "problem": "An evolutionary biologist is studying the evolution of larval behavior in a group of fictitious insects. The evolutionary relationships (phylogeny) among five extant species are described as follows: *Glimmerwing* and *Shadowspinner* are sister species (they share a most recent common ancestor). This pair's closest relative is the species *Stonemantle*. A different pair of sister species, *Sunstreaker* and *Duskdiver*, form a separate distinct clade. The clade containing *Glimmerwing*, *Shadowspinner*, and *Stonemantle* and the clade containing *Sunstreaker* and *Duskdiver* are themselves sister groups, originating from the single common ancestor of all five species.\n\nA key trait under investigation is the feeding behavior of larvae, which can be one of two states: 'feeder' (larvae actively consume food) or 'non-feeder' (larvae develop entirely on yolk reserves from the egg). The observed states in the five living species are:\n- *Glimmerwing*: Feeder\n- *Shadowspinner*: Feeder\n- *Stonemantle*: Non-feeder\n- *Sunstreaker*: Feeder\n- *Duskdiver*: Non-feeder\n\nAssuming the common ancestor of all five species was a 'non-feeder', determine the minimum number of evolutionary changes (i.e., transitions between 'feeder' and 'non-feeder' states) required to explain this distribution of traits on the phylogeny. This value is known as the total parsimony score.", "solution": "Let the two larval states be denoted by symbols $F$ (feeder) and $N$ (non-feeder). Abbreviate the five species as follows: $G$ = Glimmerwing $(F)$, $H$ = Shadowspinner $(F)$, $T$ = Stonemantle $(N)$, $U$ = Sunstreaker $(F)$, $D$ = Duskdiver $(N)$. The phylogeny is $(((G,H),T),(U,D))$, with root $R$ being the common ancestor of all five species. Define internal nodes: $X$ as the most recent common ancestor of $G$ and $H$, $A$ as the ancestor of $X$ and $T$, and $B$ as the ancestor of $U$ and $D$.\n\nUse the Fitch parsimony algorithm. For each node $v$, let $S_{v}$ be the set of possible states minimizing changes in the subtree rooted at $v$.\n\nLeaf sets:\n$$\nS_{G}=\\{F\\},\\quad S_{H}=\\{F\\},\\quad S_{T}=\\{N\\},\\quad S_{U}=\\{F\\},\\quad S_{D}=\\{N\\}.\n$$\n\nCompute internal-node sets bottom-up:\n- For $X$ (children $G$ and $H$), $S_{X}=S_{G}\\cap S_{H}=\\{F\\}$ (no change added).\n- For $A$ (children $X$ and $T$), $S_{A}=S_{X}\\cap S_{T}=\\emptyset$, so set $S_{A}=S_{X}\\cup S_{T}=\\{F,N\\}$ and add $1$ change.\n- For $B$ (children $U$ and $D$), $S_{B}=S_{U}\\cap S_{D}=\\emptyset$, so set $S_{B}=S_{U}\\cup S_{D}=\\{F,N\\}$ and add $1$ change.\n- For the root $R$ (children $A$ and $B$), $S_{R}=S_{A}\\cap S_{B}=\\{F,N\\}$ (no additional change).\n\nThus, the minimal number of changes with an unspecified root is $1+1=2$. Now incorporate the given root state: the ancestor of all five species was $N$. Since $N\\in S_{R}$, we assign $R=N$ without incurring any extra change.\n\nAssign states top-down to realize the minimum:\n- Choose $A=N$ and $B=N$ because $N\\in S_{A}$ and $N\\in S_{B}$, avoiding extra changes on branches $R\\to A$ and $R\\to B$.\n- In clade $A$: $A=N$ to $X=\\{F\\}$ requires one change $N\\to F$; $A=N$ to $T=N$ requires no change; $X=F$ to $G=F$ and $H=F$ require no changes.\n- In clade $B$: $B=N$ to $U=F$ requires one change $N\\to F$; $B=N$ to $D=N$ requires no change.\n\nTherefore, the total parsimony score is $1+1=2$, which is the minimum compatible with the observed tip states and the specified non-feeding root.", "answer": "$$\\boxed{2}$$", "id": "1908137"}, {"introduction": "While parsimony provides a powerful framework for inferring evolutionary history, it does not always yield a single, definitive answer. In many real-world cases, multiple different evolutionary histories can be equally parsimonious, leading to ambiguity in the reconstructed ancestral state. This practice problem [@problem_id:1908175] explores such a scenario, demonstrating how to identify when an ancestral state is ambiguous and why this is a critical concept in interpreting evolutionary reconstructions.", "problem": "An evolutionary biologist is studying the origin of different trapping mechanisms in carnivorous plants. The two mechanisms are categorized as 'Passive' (e.g., pitfall traps that do not move to capture prey) and 'Active' (e.g., snap traps or sticky tentacles that move to capture prey). For the purpose of reconstruction, the Passive state is coded as 0 and the Active state is coded as 1.\n\nThe study includes four species with the following trapping mechanisms:\n- *Dionaea* (Venus Flytrap): Active (1)\n- *Sarracenia* (North American Pitcher Plant): Passive (0)\n- *Drosera* (Sundew): Active (1)\n- *Cephalotus* (Albany Pitcher Plant): Passive (0)\n\nPhylogenetic analysis reveals that the evolutionary relationships among these four species can be represented by an unrooted tree. In this tree, there is a single internal branch that connects two internal nodes. One internal node is the most recent common ancestor of *Dionaea* and *Sarracenia*, and the other internal node is the most recent common ancestor of *Drosera* and *Cephalotus*.\n\nBased on the principle of maximum parsimony, which seeks to minimize the total number of evolutionary changes (state transitions from 0 to 1 or 1 to 0), what is the minimum possible parsimony score for this entire unrooted tree? Furthermore, what ancestral state (or states) for the internal branch is consistent with this minimum score?\n\nChoose the option that correctly identifies both the score and the consistent ancestral state(s).\n\nA. Score: 1, State: Active only\n\nB. Score: 1, State: Passive only\n\nC. Score: 2, State: Active only\n\nD. Score: 2, State: Passive only\n\nE. Score: 2, State: Both Active and Passive are equally plausible\n\nF. Score: 3, State: Both Active and Passive are equally plausible", "solution": "We have four taxa with binary states: Dionaea $=1$, Sarracenia $=0$, Drosera $=1$, Cephalotus $=0$. The unrooted topology is the split that connects the most recent common ancestor (MRCA) of Dionaea and Sarracenia to the MRCA of Drosera and Cephalotus via a single internal branch. To compute the maximum parsimony (MP) score for this binary character on this fixed unrooted tree, use the Fitch algorithm. Root the tree arbitrarily on the single internal branch connecting the two internal nodes; this does not change the parsimony score.\n\nFitch recurrence: for an internal node with child state sets $S_{1}$ and $S_{2}$,\n- if $S_{1}\\cap S_{2}\\neq \\emptyset$, then assign $S(v)=S_{1}\\cap S_{2}$ and add $0$ to the score;\n- if $S_{1}\\cap S_{2}=\\emptyset$, then assign $S(v)=S_{1}\\cup S_{2}$ and add $1$ to the score.\n\nApply this to the two child subtrees:\n- Left internal node (MRCA of Dionaea and Sarracenia): children have states $\\{1\\}$ and $\\{0\\}$. Since $\\{1\\}\\cap\\{0\\}=\\emptyset$, assign $S(v_{L})=\\{0,1\\}$ and add $1$ change.\n- Right internal node (MRCA of Drosera and Cephalotus): children have states $\\{1\\}$ and $\\{0\\}$. Since $\\{1\\}\\cap\\{0\\}=\\emptyset$, assign $S(v_{R})=\\{0,1\\}$ and add $1$ change.\n\nAt the root (the internal branch between $v_{L}$ and $v_{R}$), the two child sets are $S(v_{L})=\\{0,1\\}$ and $S(v_{R})=\\{0,1\\}$. Their intersection is $\\{0,1\\}\\cap\\{0,1\\}=\\{0,1\\}$, so assign $S(\\text{root})=\\{0,1\\}$ and add $0$ changes.\n\nTherefore, the minimum parsimony score for the entire unrooted tree is $1+1+0=2$. Because both adjacent internal nodes carry the ambiguous set $\\{0,1\\}$, either state $0$ (Passive) or $1$ (Active) on the internal branch is consistent with this minimum score; both are equally plausible under MP.\n\nThus the correct option is: Score $=2$, State $=$ both Active and Passive are equally plausible.", "answer": "$$\\boxed{E}$$", "id": "1908175"}, {"introduction": "Beyond counting steps, we can use probabilistic methods to reconstruct ancestral states, with Maximum Likelihood (ML) being one of the most powerful approaches. ML methods incorporate an explicit model of evolution, allowing for a more nuanced evaluation of competing hypotheses about the past. This exercise [@problem_id:1908136] provides a direct comparison between parsimony and maximum likelihood, allowing you to see how different assumptions can lead to different insights about the ancestral state of a trait.", "problem": "An evolutionary biologist is studying the evolution of behavior in domestic dogs. A simplified phylogenetic tree of four specific breeds is constructed based on genomic data. The tree consists of two primary clades which share a single common ancestor, representing the root of this domestic dog phylogeny. The first clade contains the German Shepherd and the Border Collie. The second clade contains the Pug and the Beagle.\n\nThe biologist is interested in reconstructing the ancestral state of the 'herding instinct', a complex behavioral trait. This trait is categorized as being in one of two discrete states for each breed: Herding (H) or Non-herding (N). The observed states for the four breeds are:\n- German Shepherd: H\n- Border Collie: H\n- Pug: N\n- Beagle: N\n\nIt is known that the progenitor of all domestic dogs, the wolf, is classified as Non-herding (N) for this specific trait category. You are tasked with reconstructing the state of this trait at the root of the domestic dog phylogeny using two different computational methods.\n\n**Part 1: Parsimony Analysis**\nApply the principle of maximum parsimony to this phylogeny and trait data. Determine the minimum number of evolutionary changes (i.e., from H to N or N to H) required to explain the observed distribution of the herding instinct.\n\n**Part 2: Maximum Likelihood Analysis**\nFor a maximum likelihood analysis, a simple, non-symmetrical model of trait evolution is proposed. The model assumes that on any given branch of the phylogeny, the probability of the trait changing from Herding to Non-herding (a loss event) is $p_{\\text{H}\\to\\text{N}} = 0.3$, and the probability of it changing from Non-herding to Herding (a gain event) is $p_{\\text{N}\\to\\text{H}} = 0.1$. Consequently, the probability of the state remaining Herding is $p_{\\text{H}\\to\\text{H}} = 0.7$, and the probability of it remaining Non-herding is $p_{\\text{N}\\to\\text{N}} = 0.9$. These probabilities are assumed to be uniform across all branches of the phylogeny.\n\nCalculate the ratio of the likelihood that the root ancestor had the Herding trait to the likelihood that it had the Non-herding trait, defined as $R = \\frac{L(\\text{root state = H})}{L(\\text{root state = N})}$.\n\nYour task is to provide the minimum number of changes from Part 1, and the numerical value of the ratio $R$ from Part 2. Round the value of $R$ to four significant figures.", "solution": "Parsimony analysis: The four-tip rooted tree consists of two cherries: clade A with German Shepherd and Border Collie, both observed as $H$, and clade B with Pug and Beagle, both observed as $N$. Using the Fitch parsimony procedure, assign sets at the leaves: $\\{H\\}$ for both members of clade A and $\\{N\\}$ for both members of clade B. At the internal nodes subtending each cherry, intersections are non-empty, giving $\\{H\\}$ at the ancestor of clade A and $\\{N\\}$ at the ancestor of clade B. At the root, the intersection of $\\{H\\}$ and $\\{N\\}$ is empty, so one change is required along the single edge separating the $H$ and $N$ subtrees. Therefore, the minimum number of changes explaining the observed distribution is $1$.\n\nMaximum likelihood analysis: Each branch has the same transition probabilities\n$$\np_{\\text{H}\\to\\text{H}}=0.7,\\quad p_{\\text{H}\\to\\text{N}}=0.3,\\quad p_{\\text{N}\\to\\text{H}}=0.1,\\quad p_{\\text{N}\\to\\text{N}}=0.9.\n$$\nFor clade A (two $H$ leaves), the conditional likelihood of the subtree given the clade ancestor’s state $i\\in\\{H,N\\}$ is\n$$\nf_{A}(H)=(p_{\\text{H}\\to\\text{H}})^{2}=0.7^{2}=0.49,\\qquad f_{A}(N)=(p_{\\text{N}\\to\\text{H}})^{2}=0.1^{2}=0.01.\n$$\nFor clade B (two $N$ leaves), the conditional likelihoods are\n$$\nf_{B}(H)=(p_{\\text{H}\\to\\text{N}})^{2}=0.3^{2}=0.09,\\qquad f_{B}(N)=(p_{\\text{N}\\to\\text{N}})^{2}=0.9^{2}=0.81.\n$$\nLet $L(H)$ denote the likelihood of the observed tip states given that the root is $H$, and $L(N)$ for root $N$. Summing over the unknown states at the two internal clade ancestors yields\n$$\ng_{A}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{A}(N)=0.7\\cdot 0.49+0.3\\cdot 0.01=0.346,\n$$\n$$\ng_{B}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{B}(N)=0.7\\cdot 0.09+0.3\\cdot 0.81=0.306,\n$$\nso\n$$\nL(H)=g_{A}(H)\\,g_{B}(H)=0.346\\cdot 0.306=0.105876.\n$$\nSimilarly,\n$$\ng_{A}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{A}(N)=0.1\\cdot 0.49+0.9\\cdot 0.01=0.058,\n$$\n$$\ng_{B}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{B}(N)=0.1\\cdot 0.09+0.9\\cdot 0.81=0.738,\n$$\nso\n$$\nL(N)=g_{A}(N)\\,g_{B}(N)=0.058\\cdot 0.738=0.042804.\n$$\nThe requested ratio is\n$$\nR=\\frac{L(\\text{root state}=H)}{L(\\text{root state}=N)}=\\frac{0.105876}{0.042804}\\approx 2.474,\n$$\nrounded to four significant figures.\n\nThus, the minimum number of changes under parsimony is $1$, and the likelihood ratio $R$ is approximately $2.474$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2.474 \\end{pmatrix}}$$", "id": "1908136"}]}