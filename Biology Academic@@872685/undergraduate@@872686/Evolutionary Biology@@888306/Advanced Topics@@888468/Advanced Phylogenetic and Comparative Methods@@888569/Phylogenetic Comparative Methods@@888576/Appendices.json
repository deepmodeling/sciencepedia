{"hands_on_practices": [{"introduction": "A foundational challenge in comparative biology is that closely related species are not independent data points. The method of Phylogenetically Independent Contrasts (PICs) directly addresses this by transforming trait data from a set of related species into a set of statistically independent values. This exercise [@problem_id:1761373] provides a step-by-step walkthrough of the PIC algorithm, giving you hands-on practice with one of the most important tools for studying the evolution of continuous traits.", "problem": "An evolutionary biologist is studying the evolution of body size in a small group of scarab beetles. She has constructed a phylogeny and collected body size data for three species: *Rhinoceps ferox*, *Goliathus parvus*, and *Chalcosoma medius*. The phylogenetic relationships are as follows: *R. ferox* and *G. parvus* are sister species, and their common ancestor represents a clade that is sister to *C. medius*.\n\nThe branch lengths, representing evolutionary time in millions of years (Myr), are given:\n- The branch from the common ancestor of *R. ferox* and *G. parvus* to the present-day *R. ferox* is 2 Myr.\n- The branch from the common ancestor of *R. ferox* and *G. parvus* to the present-day *G. parvus* is 2 Myr.\n- The branch from the root of the three-species tree to the common ancestor of *R. ferox* and *G. parvus* is 3 Myr.\n- The branch from the root of the tree to the present-day *C. medius* is 5 Myr.\n\nThe average adult body lengths for these species are:\n- *Rhinoceps ferox*: 45.5 mm\n- *Goliathus parvus*: 52.1 mm\n- *Chalcosoma medius*: 38.0 mm\n\nTo prepare for a comparative analysis, one must compute the phylogenetically independent contrasts for the body length trait. Using the standard algorithm for this method, calculate the numerical value of the independent contrast computed at the root of this three-species tree. Assume a Brownian motion model of trait evolution. Express your answer rounded to three significant figures.", "solution": "The problem asks for the calculation of the phylogenetically independent contrast at the root of a three-species tree. We will use Felsenstein's algorithm, which proceeds from the tips of the tree down to the root.\n\nLet's denote the species and their traits and branch lengths with symbols for clarity.\nLet species A be *Rhinoceps ferox*, species B be *Goliathus parvus*, and species C be *Chalcosoma medius*.\nThe trait values (body length) are:\n$x_A = 45.5$ mm\n$x_B = 52.1$ mm\n$x_C = 38.0$ mm\n\nThe branch lengths are:\n- The terminal branch leading to A, $v_A = 2$ Myr.\n- The terminal branch leading to B, $v_B = 2$ Myr.\n- The terminal branch leading to C, $v_C = 5$ Myr.\n- The internal branch leading to the common ancestor of A and B, which we'll call Node 1, has length $v_{1, \\text{stem}} = 3$ Myr.\n\nThe algorithm consists of two main parts for this tree: first, calculating the contrast between the sister species A and B and estimating the state at their common ancestor (Node 1); second, calculating the contrast between Node 1 and species C.\n\n**Step 1: Calculate the contrast between sister species A and B.**\nThe first independent contrast, $C_1$, is the difference in trait values between A and B, scaled by the square root of the sum of their branch lengths. The order of subtraction is arbitrary; we will compute $x_B - x_A$.\n$$\nC_1 = \\frac{x_B - x_A}{\\sqrt{v_A + v_B}}\n$$\nSubstituting the values:\n$$\nC_1 = \\frac{52.1 - 45.5}{\\sqrt{2 + 2}} = \\frac{6.6}{\\sqrt{4}} = \\frac{6.6}{2} = 3.3\n$$\n\n**Step 2: Estimate the trait value at the common ancestor (Node 1).**\nThe trait value at Node 1, $x_1$, is estimated as a weighted average of the trait values of its descendants, where the weights are the inverse of the respective branch lengths.\n$$\nx_1 = \\frac{\\frac{1}{v_A}x_A + \\frac{1}{v_B}x_B}{\\frac{1}{v_A} + \\frac{1}{v_B}}\n$$\nSince $v_A = v_B = 2$, this simplifies to the arithmetic mean:\n$$\nx_1 = \\frac{x_A + x_B}{2} = \\frac{45.5 + 52.1}{2} = \\frac{97.6}{2} = 48.8\n$$\nSo, the estimated body length of the ancestor at Node 1 is 48.8 mm.\n\n**Step 3: Update the branch length for Node 1.**\nNode 1 now acts like a tip for the next calculation. Its branch length needs to be adjusted to account for the variance introduced by the estimation in Step 2. The new branch length, $v'_1$, is its original stem branch length plus a term related to the lengths of the branches descending from it.\n$$\nv'_1 = v_{1, \\text{stem}} + \\frac{v_A v_B}{v_A + v_B}\n$$\nSubstituting the values:\n$$\nv'_1 = 3 + \\frac{2 \\times 2}{2 + 2} = 3 + \\frac{4}{4} = 3 + 1 = 4\n$$\nThe adjusted branch length for Node 1 is 4 Myr.\n\n**Step 4: Calculate the contrast at the root.**\nThe final step is to calculate the contrast at the root of the tree. This contrast, $C_{\\text{root}}$, is between the newly characterized Node 1 and the remaining species, C. We use their respective trait values ($x_1$ and $x_C$) and branch lengths ($v'_1$ and $v_C$).\n$$\nC_{\\text{root}} = \\frac{x_1 - x_C}{\\sqrt{v'_1 + v_C}}\n$$\nSubstituting the calculated and given values:\n$$\nC_{\\text{root}} = \\frac{48.8 - 38.0}{\\sqrt{4 + 5}} = \\frac{10.8}{\\sqrt{9}} = \\frac{10.8}{3} = 3.6\n$$\nThe value of the independent contrast computed at the root is 3.6.\n\n**Step 5: Final rounding.**\nThe problem asks for the answer to be rounded to three significant figures. The calculated value is 3.6, which when expressed with three significant figures is 3.60.", "answer": "$$\\boxed{3.60}$$", "id": "1761373"}, {"introduction": "While PICs are designed for continuous traits like body size, many evolutionary questions involve discrete characters, such as the presence or absence of a feature or a change in color. Maximum parsimony is a classic method for inferring the evolutionary history of such traits by identifying the scenario that requires the fewest evolutionary changes. In this practice problem [@problem_id:1761335], you will apply the logic of parsimony to reconstruct the ancestral state of flower color, a fundamental skill for tracing the history of character evolution.", "problem": "A botanist is investigating the evolutionary history of flower color in a small clade of five hypothetical plant species: *Floris aenigma*, *Floris bardi*, *Floris caeruleus*, *Floris duo*, and *Floris electra*. Based on molecular data, the phylogenetic relationships are well-established. Species *F. aenigma* and *F. bardi* are sister taxa, forming a distinct lineage. Species *F. duo* and *F. electra* are also sister taxa. The clade containing *F. duo* and *F. electra* is, in turn, sister to *F. caeruleus*. Finally, the lineage containing *F. aenigma* and *F. bardi* is sister to the lineage containing *F. caeruleus*, *F. duo*, and *F. electra*.\n\nThe flower colors for these five extant species have been observed as follows:\n- *F. aenigma*: Blue\n- *F. bardi*: Red\n- *F. caeruleus*: Blue\n- *F. duo*: Red\n- *F. electra*: Red\n\nUsing the principle of maximum parsimony, determine the most likely ancestral state for flower color (either Blue or Red) at the basal node (the common ancestor of all five species) and the minimum number of evolutionary changes (state transitions from Blue-to-Red or Red-to-Blue) required. Which of the following statements accurately describes the reconstruction?\n\nA. The ancestral state is unambiguously Blue, with a total of 2 evolutionary changes.\n\nB. The ancestral state is unambiguously Red, with a total of 2 evolutionary changes.\n\nC. The ancestral state is ambiguous (could be either Blue or Red), with a total of 2 evolutionary changes.\n\nD. The ancestral state is unambiguously Blue, with a total of 3 evolutionary changes.\n\nE. The ancestral state is ambiguous (could be either Blue or Red), with a total of 3 evolutionary changes.\n\nF. The reconstruction is not possible with the given information.", "solution": "The problem asks for the ancestral state reconstruction of flower color at the basal node of a given phylogeny, using the principle of maximum parsimony. This principle states that the preferred evolutionary hypothesis is the one that requires the fewest evolutionary changes. We can solve this using a two-pass algorithm, often known as Fitch's algorithm.\n\nFirst, let's represent the phylogeny and the character states. We can denote the species by their first letters: A (*F. aenigma*), B (*F. bardi*), C (*F. caeruleus*), D (*F. duo*), and E (*F. electra*). The states are Blue (L) and Red (R).\nThe observed states at the tips of the tree are: A=L, B=R, C=L, D=R, E=R.\n\nThe textual description of the phylogeny corresponds to the parenthetical notation ((A, B), (C, (D, E))). Let's label the internal nodes:\n- `N1`: The most recent common ancestor of D and E.\n- `N2`: The most recent common ancestor of C, D, and E (i.e., of C and `N1`).\n- `N3`: The most recent common ancestor of A and B.\n- `N4`: The basal node, the most recent common ancestor of all five species (i.e., of `N2` and `N3`).\n\n**Pass 1: Bottom-up Assignment of State Sets**\nIn this pass, we work from the tips of the tree upwards to the root (`N4`), assigning a set of possible states to each internal node. We also calculate the total number of changes (the parsimony score).\n\nThe rule for determining the state set of a parent node from its two descendant nodes is as follows:\n- If the state sets of the descendants have a non-empty intersection, the parent's state set is this intersection.\n- If the state sets of the descendants have an empty intersection, the parent's state set is their union. In this case, we increment a counter for the number of evolutionary changes by one.\n\nLet's apply this:\n\n1.  **Node `N1` (ancestor of D and E):**\n    -   Descendant D has state set {R}.\n    -   Descendant E has state set {R}.\n    -   The intersection of {R} and {R} is {R}.\n    -   So, the state set for `N1` is {R}.\n    -   The intersection is non-empty, so the change count increment is 0.\n\n2.  **Node `N3` (ancestor of A and B):**\n    -   Descendant A has state set {L}.\n    -   Descendant B has state set {R}.\n    -   The intersection of {L} and {R} is empty.\n    -   The union is {L, R}. So, the state set for `N3` is {L, R}.\n    -   The intersection is empty, so we increment the change count: score = 1.\n\n3.  **Node `N2` (ancestor of C and `N1`):**\n    -   Descendant C has state set {L}.\n    -   Descendant `N1` has state set {R}.\n    -   The intersection of {L} and {R} is empty.\n    -   The union is {L, R}. So, the state set for `N2` is {L, R}.\n    -   The intersection is empty, so we increment the change count: score = 1 + 1 = 2.\n\n4.  **Node `N4` (Basal Node, ancestor of `N2` and `N3`):**\n    -   Descendant `N2` has state set {L, R}.\n    -   Descendant `N3` has state set {L, R}.\n    -   The intersection of {L, R} and {L, R} is {L, R}.\n    -   So, the state set for `N4` is {L, R}.\n    -   The intersection is non-empty, so the change count increment is 0.\n\nAt the end of Pass 1, the total minimum number of evolutionary changes (the parsimony score) is 2. The state set at the basal node `N4` is {L, R}.\n\n**Pass 2: Top-down Assignment of Final States**\nThe state set {L, R} at the basal node `N4` indicates that the ancestral state is ambiguous. Either Blue (L) or Red (R) could be the ancestral state, and both will result in the same total number of changes (2). Let's verify this.\n\nThe rule for the top-down pass is:\n- If a descendant node's state set contains the state assigned to its parent, then the descendant is assigned that state.\n- If a descendant node's state set does not contain the state of its parent, we can choose any state from the descendant's set. This forces a change on the branch leading to that descendant.\n\n**Scenario 1: Assume basal node `N4` is Blue (L).**\n- `N4` = L.\n- `N3` has state set {L, R}. It contains L, so we assign `N3` = L.\n- `N2` has state set {L, R}. It contains L, so we assign `N2` = L.\n- Now we look at the children of these nodes:\n    - From `N3`=L: A is L (no change), B is R (1 change).\n    - From `N2`=L: C is L (no change), `N1` must be assigned a state. `N1`'s state set is {R}, which does not contain L. So we assign `N1` a state from its set, `N1`=R. This requires 1 change on the branch from `N2` to `N1`.\n- Total changes for this scenario: 1 (for B) + 1 (for `N1`) = 2.\n\n**Scenario 2: Assume basal node `N4` is Red (R).**\n- `N4` = R.\n- `N3` has state set {L, R}. It contains R, so we assign `N3` = R.\n- `N2` has state set {L, R}. It contains R, so we assign `N2` = R.\n- Now we look at the children of these nodes:\n    - From `N3`=R: A is L (1 change), B is R (no change).\n    - From `N2`=R: C is L (1 change), `N1`'s state set is {R}, which contains R. So we assign `N1`=R (no change).\n- Total changes for this scenario: 1 (for A) + 1 (for C) = 2.\n\nBoth scenarios result in a total of 2 changes, which is the minimum possible score we calculated in Pass 1. Since both Blue and Red are equally parsimonious choices for the basal node's state, the ancestral state is ambiguous.\n\nTherefore, the reconstruction requires a minimum of 2 evolutionary changes, and the ancestral state at the basal node is ambiguous (it could be Blue or Red). This corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1761335"}, {"introduction": "Modern comparative methods often involve fitting statistical models, such as Phylogenetic Generalized Least Squares (PGLS), to test hypotheses about trait relationships. However, fitting a model is only the first step; a crucial part of the scientific process is evaluating how well that model explains the data. This problem [@problem_id:1953854] delves into model diagnostics by asking you to interpret a common outcome: finding a strong phylogenetic signal in the model's residuals. This skill is vital for refining evolutionary hypotheses and identifying potentially overlooked factors driving trait evolution.", "problem": "An evolutionary biologist is investigating the drivers of venom complexity in a large clade of vipers. Their primary hypothesis is that species with a broader diet (i.e., more prey types) are under selective pressure to evolve more complex venoms to subdue a wider variety of prey. To test this, the biologist collects data on venom complexity (a continuous variable measured biochemically) and diet breadth (a continuous variable measured from stomach content analysis) for 150 species in the clade.\n\nAware that species are not independent data points due to their shared evolutionary history, the biologist uses the Phylogenetic Generalized Least Squares (PGLS) method. This statistical approach models the relationship between traits while accounting for the expected covariance among species based on a well-resolved phylogeny.\n\nThe biologist fits the PGLS model: `Venom Complexity ~ Diet Breadth`.\n\nAfter fitting the model, the researcher calculates the model's residuals. The residuals represent the variation in venom complexity that is not explained by diet breadth. The researcher then tests these residuals for a phylogenetic signal using Pagel's lambda, a statistic where a value near 0 indicates no phylogenetic signal and a value near 1 indicates a strong signal consistent with a Brownian motion model of evolution along the phylogeny. The test reveals a strong and statistically significant phylogenetic signal in these residuals (lambda = 0.92, p < 0.001).\n\nWhich of the following is the most direct and mechanistically plausible evolutionary interpretation of this result?\n\nA. There is likely a missing predictor variable in the model that is itself phylogenetically patterned, and its influence on venom complexity is causing the observed residual structure.\n\nB. The model has over-corrected for phylogeny, indicating that the evolution of venom complexity is completely independent of the species' shared evolutionary history.\n\nC. The underlying phylogenetic tree used for the analysis is almost certainly inaccurate, and a different tree topology would remove the phylogenetic signal in the residuals.\n\nD. The significant phylogenetic signal in the residuals proves that any observed relationship between diet breadth and venom complexity is a spurious, non-causal artifact of shared ancestry.\n\nE. The predictor variable, diet breadth, must have evolved under a non-Brownian evolutionary process, violating a key assumption of the PGLS model.", "solution": "1) Specify the fitted PGLS model. Let $y$ denote venom complexity and $x$ denote diet breadth across species indexed by $i=1,\\dots,n$. The PGLS regression is\n$$\ny = \\beta_{0} + \\beta_{1} x + \\varepsilon,\n$$\nwith errors modeled as\n$$\n\\varepsilon \\sim \\mathcal{N}\\!\\left(0,\\ \\sigma^{2}\\mathbf{C}(\\lambda)\\right),\n$$\nwhere $\\mathbf{C}(\\lambda)$ is the phylogenetic covariance matrix implied by the tree, with off-diagonal elements scaled by Pagel’s $\\lambda$ and diagonal elements preserving species-specific variances. Under this model, phylogenetically structured similarity among species is explicitly incorporated into the error covariance.\n\n2) Interpret residual phylogenetic signal after fitting. After estimation, define residuals $\\hat{\\varepsilon}=y-\\hat{\\beta}_{0}-\\hat{\\beta}_{1}x$. If the predictor(s) and the error structure adequately capture the phylogenetically structured components of $y$, then the remaining residuals should show little to no additional phylogenetic signal. Conversely, if $\\hat{\\varepsilon}$ exhibits strong phylogenetic signal, i.e., testing $\\hat{\\lambda}$ for $\\hat{\\varepsilon}$ yields a value near 1 with $p$-value near 0, then there remains substantial variation in $y$ not explained by $x$ that is nonetheless aligned with the phylogeny. Formally, a large estimate $\\hat{\\lambda}$ for the residuals indicates that\n$$\n\\operatorname{Cov}(\\hat{\\varepsilon}) \\approx \\sigma^{2}\\mathbf{C}_{phy},\n$$\nso unexplained differences among species covary as expected under a Brownian-like process along the tree.\n\n3) Mechanistic evolutionary interpretation. Because PGLS already accounts for phylogenetic covariance in the errors, strong phylogenetic signal in $\\hat{\\varepsilon}$ implies that there are determinants of venom complexity beyond diet breadth that are themselves phylogenetically conserved, producing clade-level similarity in the unexplained component of $y$. In other words, omitted variables (e.g., prey defensive traits, foraging mode, morphology, life history, or other ecological or physiological correlates) that are phylogenetically patterned likely drive a substantial portion of venom complexity, leaving phylogenetically structured residuals after controlling for diet breadth.\n\n4) Evaluate the options:\n- A: Posits a missing predictor that is phylogenetically patterned and influences venom complexity, yielding phylogenetically structured residuals. This directly matches the logic in step 3 and is the most parsimonious, mechanistically plausible interpretation.\n- B: Claims over-correction and complete independence from phylogeny. This contradicts the observed strong phylogenetic signal in residuals; over-correction would reduce, not increase, such signal.\n- C: Attributes the result to an almost certainly inaccurate tree. While tree error can affect estimates, the presence of strong residual signal does not by itself imply a wrong topology; this is not the most direct or mechanistic explanation.\n- D: Asserts that the relationship between diet breadth and venom complexity is spurious. PGLS explicitly adjusts for shared ancestry; residual phylogenetic signal indicates unexplained, phylogenetically structured variance, not that the $x$–$y$ relationship is necessarily spurious.\n- E: Claims diet breadth must evolve non-Brownian, violating assumptions. Residual signal in $y$ does not by itself diagnose the evolutionary model of $x$; moreover, PGLS with $\\lambda$ is robust to deviations from strict Brownian motion in $y$’s covariance.\n\nTherefore, the most direct and mechanistically plausible interpretation is that an omitted, phylogenetically structured factor (or factors) influences venom complexity, causing the residual phylogenetic signal.", "answer": "$$\\boxed{A}$$", "id": "1953854"}]}