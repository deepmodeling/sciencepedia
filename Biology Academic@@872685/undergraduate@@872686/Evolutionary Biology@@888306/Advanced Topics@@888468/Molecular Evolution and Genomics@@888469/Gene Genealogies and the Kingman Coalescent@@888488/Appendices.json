{"hands_on_practices": [{"introduction": "The most fundamental calculation in coalescent theory is determining the expected waiting time until the first two lineages in a sample merge into a common ancestor. This exercise [@problem_id:1931569] provides a foundational hands-on experience with the Kingman coalescent model. By working through this problem, you will see how effective population size ($N_e$) and sample size ($n$) directly influence the timescale of the most recent ancestral events in a population's history.", "problem": "A population geneticist is investigating the recent evolutionary history of a pathogenic bacterium using genomic data. The bacteria are maintained in a large, controlled laboratory environment, and their population dynamics can be approximated by the Wright-Fisher model for haploid organisms. The effective population size, $N_e$, is estimated to be a constant $5.0 \\times 10^7$.\n\nFrom this population, the geneticist obtains the complete DNA sequence of a non-recombining gene from a sample of $n = 25$ individual bacteria. Using coalescent theory, she wishes to determine the expected time scale for the earliest ancestral event in her sample.\n\nCalculate the expected number of generations, looking backwards in time, until the first coalescent event occurs among the sampled gene lineages. Express your answer in generations, rounded to three significant figures.", "solution": "We model the sample genealogy using the standard coalescent for a haploid Wright-Fisher population with constant effective size $N_{e}$. When there are $k$ ancestral lineages, the probability that any particular pair coalesces in the immediately preceding generation is $1/N_{e}$ (haploid), and there are $\\binom{k}{2}$ distinct pairs. For large $N_{e}$, the probability of multiple coalescences in the same generation is negligible, so the waiting time to the next coalescent event is approximately geometric with parameter\n$$\np_{k} \\approx \\frac{\\binom{k}{2}}{N_{e}},\n$$\nwhich is well-approximated by an exponential with rate\n$$\n\\lambda_{k} = \\frac{\\binom{k}{2}}{N_{e}}.\n$$\nThus, the expected waiting time (in generations) until the next coalescent event, given $k$ lineages, is\n$$\n\\mathbb{E}[T_{k}] = \\frac{1}{\\lambda_{k}} = \\frac{N_{e}}{\\binom{k}{2}}.\n$$\nFor the earliest ancestral event in a sample of size $n=25$, we set $k=n$:\n$$\n\\mathbb{E}[T_{\\text{first}}] = \\frac{N_{e}}{\\binom{25}{2}} = \\frac{5.0 \\times 10^{7}}{\\frac{25 \\cdot 24}{2}} = \\frac{5.0 \\times 10^{7}}{300}.\n$$\nCarrying out the division and rounding to three significant figures gives\n$$\n\\mathbb{E}[T_{\\text{first}}] = 1.67 \\times 10^{5}.\n$$\nThis is the expected number of generations back to the first coalescent event among the $25$ sampled lineages.", "answer": "$$\\boxed{1.67 \\times 10^{5}}$$", "id": "1931569"}, {"introduction": "While understanding the first coalescent event is crucial, population geneticists are often interested in the age of specific ancestral relationships within a sample. This practice problem [@problem_id:1931609] builds on the previous concept by exploring how to calculate the Time to the Most Recent Common Ancestor (TMRCA) for a specific pair of gene copies. It requires summing the expected waiting times across multiple coalescent intervals, demonstrating how the total time to a common ancestor accumulates as we trace lineages back through the past.", "problem": "A population geneticist is studying the evolutionary history of a particular gene in a species of haploid fungus. The population is assumed to have maintained a constant effective population size of $N_e = 50,000$ individuals over a long period. Five gene samples, labeled A, B, C, D, and E, are collected from the population. By analyzing genetic differences, the branching order of their gene genealogy is reconstructed.\n\nThe history of these gene copies, when traced backward in time, follows a specific sequence of coalescence events:\n1. The first event to occur is the merging of the lineages leading to samples D and E.\n2. The second event is the merging of the lineage of sample C with the common ancestral lineage of D and E.\n3. The third event is the merging of the lineages leading to samples A and B.\n4. The final event joins the two remaining ancestral lineages, forming the single most recent common ancestor of the entire sample.\n\nThis process can be modeled using the standard Kingman coalescent framework. For a haploid population of constant effective size $N_e$, the expected waiting time for any two out of $k$ distinct lineages to coalesce into a single ancestral lineage is given by the formula $\\frac{N_e}{\\binom{k}{2}}$ generations.\n\nCalculate the expected Time to the Most Recent Common Ancestor (TMRCA) for the pair of samples A and B. Express your answer in generations, rounded to three significant figures.", "solution": "We model the genealogy with the standard Kingman coalescent for a haploid population of constant effective size $N_{e}$. With $k$ active lineages, the waiting time to the next coalescent event is exponential with mean $\\frac{N_{e}}{\\binom{k}{2}}$, and the identity of the coalescing pair is independent of this waiting time.\n\nThe specified order of events is:\n- First: $D$ and $E$ coalesce, taking the process from $k=5$ to $k=4$.\n- Second: $C$ merges with $(DE)$, taking $k=4$ to $k=3$.\n- Third: $A$ and $B$ coalesce, taking $k=3$ to $k=2$.\n\nTherefore, the time from the present to the most recent common ancestor of samples $A$ and $B$ is the sum of the waiting times over the intervals with $k=5$, $k=4$, and $k=3$ lineages:\n$$\n\\mathbb{E}[T_{AB}] \\;=\\; \\frac{N_{e}}{\\binom{5}{2}} \\;+\\; \\frac{N_{e}}{\\binom{4}{2}} \\;+\\; \\frac{N_{e}}{\\binom{3}{2}} \\,.\n$$\nEvaluating the binomial coefficients gives\n$$\n\\mathbb{E}[T_{AB}] \\;=\\; N_{e}\\left(\\frac{1}{10} \\;+\\; \\frac{1}{6} \\;+\\; \\frac{1}{3}\\right)\n\\;=\\; N_{e}\\left(\\frac{3 + 5 + 10}{30}\\right)\n\\;=\\; \\frac{18}{30}\\,N_{e} \\;=\\; \\frac{3}{5}\\,N_{e}.\n$$\nSubstituting $N_{e} = 50{,}000$ generations yields\n$$\n\\mathbb{E}[T_{AB}] \\;=\\; \\frac{3}{5}\\times 50{,}000 \\;=\\; 30{,}000 \\text{ generations}.\n$$\nRounded to three significant figures, this is $3.00 \\times 10^{4}$ generations.", "answer": "$$\\boxed{3.00 \\times 10^{4}}$$", "id": "1931609"}, {"introduction": "The power of the coalescent framework lies in its adaptability to diverse biological scenarios. Genes in different parts of the genome can have different evolutionary histories due to their unique modes of inheritance. This problem [@problem_id:1931615] challenges you to apply coalescent principles to compare the expected TMRCA for genes on an autosome versus an X chromosome. It highlights the critical concept that effective population size ($N_e$) is not always a single value for a species but can vary depending on the specific genetic locus being studied.", "problem": "Consider a hypothetical species of moth, the Arcturian Sky-Moth, which has a constant population size of $N$ individuals and follows the assumptions of the standard Wright-Fisher model of population genetics. This includes discrete, non-overlapping generations and random mating. The species is diploid, with a sex-determination system analogous to humans: females are the homogametic sex (XX) and males are the heterogametic sex (XY). The sex ratio in the population is consistently 1:1 (i.e., equal numbers of males and females).\n\nAn evolutionary biologist is studying the deep ancestral history of two different neutral gene loci in this species. One locus is on an autosome, and the other is on the X chromosome. Under the Kingman coalescent model, the average or expected Time to the Most Recent Common Ancestor ($E[T_{MRCA}]$) for all gene copies at a locus within the population is proportional to the effective population size ($N_e$) for that locus.\n\nDetermine the theoretical ratio of the expected time to the most recent common ancestor for the X-linked locus to that of the autosomal locus. Express your answer as a single, closed-form analytic expression.", "solution": "We are given a Wright-Fisher population with $N$ diploid individuals, equal numbers of males and females, and a neutral locus either on an autosome or on the X chromosome. Under the Kingman coalescent, the expected time to the MRCA at a locus is proportional to the locus-specific effective population size, so for two loci $L_{1}$ and $L_{2}$,\n$$\n\\frac{E[T_{MRCA}(L_{1})]}{E[T_{MRCA}(L_{2})]}=\\frac{N_{e}^{L_{1}}}{N_{e}^{L_{2}}}.\n$$\nThus, it suffices to compute the ratio $N_{e}^{X}/N_{e}^{A}$.\n\nLet $N_{f}$ and $N_{m}$ denote the numbers of females and males, respectively. The sex ratio is $1:1$, so\n$$\nN_{f}=\\frac{N}{2},\\qquad N_{m}=\\frac{N}{2}.\n$$\n\nAutosomal locus:\n- The total number of autosomal gene copies in each generation is\n$$\nM_{A}=2N.\n$$\n- In the Wright-Fisher gene-copy model, each gene copy in generation $t$ chooses its parent uniformly from the $M_{A}$ copies in generation $t-1$, so the per-generation coalescence probability for a pair of lineages is $1/M_{A}$.\n- The continuous-time Kingman coalescent for a diploid autosomal locus has pairwise coalescence rate $1/(2N_{e}^{A})$. Matching the discrete and continuous parameterizations yields\n$$\n\\frac{1}{M_{A}}=\\frac{1}{2N_{e}^{A}}\\quad\\Longrightarrow\\quad 2N_{e}^{A}=M_{A}=2N\\quad\\Longrightarrow\\quad N_{e}^{A}=N.\n$$\n\nX-linked locus:\n- The total number of X-chromosome copies in each generation is\n$$\nM_{X}=2N_{f}+1\\cdot N_{m}=2\\cdot\\frac{N}{2}+\\frac{N}{2}=\\frac{3N}{2}.\n$$\n- To justify uniform parental choice over these $M_{X}$ copies, note that each offspring inherits exactly one maternal X. The total number of maternal X transmissions per generation is $N$, and there are $2N_{f}$ maternal X copies, so the expected number of descendant X copies per maternal X copy is $N/(2N_{f})=1$. Only daughters inherit a paternal X; there are $N/2$ daughters and $N_{m}$ paternal X copies, so the expected number of descendant X copies per paternal X copy is $(N/2)/N_{m}=1$. Hence each X copy has equal expected reproductive output, and the Wright-Fisher parental choice at the X locus is uniform over the $M_{X}$ copies. Therefore the per-generation coalescence probability for a pair of X lineages is $1/M_{X}$.\n- Matching to the Kingman parameterization for the X locus gives\n$$\n\\frac{1}{M_{X}}=\\frac{1}{2N_{e}^{X}}\\quad\\Longrightarrow\\quad 2N_{e}^{X}=M_{X}=\\frac{3N}{2}\\quad\\Longrightarrow\\quad N_{e}^{X}=\\frac{3N}{4}.\n$$\n\nTherefore, by proportionality of $E[T_{MRCA}]$ to $N_{e}$,\n$$\n\\frac{E[T_{MRCA}(X)]}{E[T_{MRCA}(A)]}=\\frac{N_{e}^{X}}{N_{e}^{A}}=\\frac{\\frac{3N}{4}}{N}=\\frac{3}{4}.\n$$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "1931615"}]}