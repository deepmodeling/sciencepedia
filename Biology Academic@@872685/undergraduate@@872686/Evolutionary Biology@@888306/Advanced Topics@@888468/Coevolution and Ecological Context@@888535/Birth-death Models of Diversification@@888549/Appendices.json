{"hands_on_practices": [{"introduction": "Diversification is fundamentally a game of chance, especially for new lineages. This exercise [@problem_id:1911784] explores this stochasticity by calculating the ultimate probability that a clade, starting from a single species, goes extinct even when conditions are favorable for growth ($\\lambda \\gt \\mu$). This foundational calculation reveals the inherent vulnerability of small populations to random events.", "problem": "A team of evolutionary biologists is investigating the long-term fate of a new clade. The clade originates from a single founding species that colonizes a pristine, isolated continent. To model its diversification, they employ a simple continuous-time birth-death model.\n\nIn this model, the following rules apply:\n1.  The process starts with a single species at time $t=0$.\n2.  Each species present on the continent has a constant per-capita rate of speciation, $\\lambda$. Speciation is an event where one species splits into two distinct species.\n3.  Each species also has a constant per-capita rate of extinction, $\\mu$.\n4.  If there are $N$ species present at any given time, the total rate of speciation for the entire clade is $N\\lambda$, and the total rate of extinction is $N\\mu$.\n5.  The evolutionary fates of separate species are independent of one another.\n\nThe biologists are analyzing a scenario where environmental conditions are favorable for diversification, meaning the speciation rate is strictly greater than the extinction rate ($\\lambda > \\mu$). Even under these favorable conditions, it is possible for the entire clade to go extinct due to stochastic events, especially when the number of species is small.\n\nCalculate the probability that this entire clade, which starts from a single founding species, will eventually go extinct. Express your answer as a closed-form analytic expression in terms of $\\lambda$ and $\\mu$.", "solution": "Let $q$ denote the probability that the clade eventually goes extinct when starting from a single species. Consider a small time interval of length $\\mathrm{d}t$. In this interval, three disjoint events can occur for the single species:\n- With probability $\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)$, a speciation event occurs, producing two descendant species. By the branching and independence assumptions, the two descendant lineages go extinct independently, so the extinction probability given this event is $q^{2}$.\n- With probability $\\mu\\,\\mathrm{d}t + o(\\mathrm{d}t)$, the species goes extinct, and thus the clade goes extinct with probability $1$.\n- With probability $1 - (\\lambda + \\mu)\\,\\mathrm{d}t + o(\\mathrm{d}t)$, no event occurs, and the extinction probability remains $q$.\n\nApplying the law of total probability and retaining terms to first order in $\\mathrm{d}t$ gives\n$$\nq \\,=\\, \\lambda\\,\\mathrm{d}t\\, q^{2} \\;+\\; \\mu\\,\\mathrm{d}t \\cdot 1 \\;+\\; \\bigl(1 - (\\lambda + \\mu)\\,\\mathrm{d}t\\bigr)\\, q \\;+\\; o(\\mathrm{d}t).\n$$\nSubtract $q$ from both sides, divide by $\\mathrm{d}t$, and take the limit as $\\mathrm{d}t \\to 0$ to obtain\n$$\n0 \\,=\\, \\lambda\\,(q^{2} - q) \\;+\\; \\mu\\,(1 - q).\n$$\nRearranging yields the quadratic equation\n$$\n\\lambda q^{2} - (\\lambda + \\mu) q + \\mu \\,=\\, 0.\n$$\nThis factors as\n$$\n(\\lambda q - \\mu)(q - 1) \\,=\\, 0,\n$$\nso the candidate solutions are $q = \\mu/\\lambda$ and $q = 1$. The extinction probability is the smallest root in $[0,1]$ consistent with the process. For a supercritical process with $\\lambda  \\mu$, we have $\\mu/\\lambda  1$, and the extinction probability is\n$$\nq \\,=\\, \\frac{\\mu}{\\lambda}.\n$$\n(For completeness, when $\\lambda \\leq \\mu$, the only admissible root is $q = 1$.) Under the stated assumption $\\lambda  \\mu$, the required extinction probability is $\\mu/\\lambda$.", "answer": "$$\\boxed{\\frac{\\mu}{\\lambda}}$$", "id": "1911784"}, {"introduction": "Birth-death models serve as powerful hypotheses about the macroevolutionary processes shaping the tree of life. In this practice [@problem_id:1911781], we move from theory to application by using phylogenetic data to compare two competing models: one with constant rates and another where speciation slows as diversity increases. You will use the Akaike Information Criterion (AIC) to determine which model provides a better explanation for the data, a core skill in modern evolutionary analysis.", "problem": "An evolutionary biologist is investigating the diversification dynamics of a clade of deep-sea corals using a time-calibrated molecular phylogeny. To test competing hypotheses about the macroevolutionary processes at play, the biologist fits two different stochastic birth-death models to the branching times observed in the phylogeny.\n\nThe first model is a Constant-Rate Birth-Death (CR-BD) model. This model posits that the rate of speciation ($\\lambda$) and the rate of extinction ($\\mu$) are constant through time and across all lineages. As it estimates two parameters ($\\lambda$ and $\\mu$), this model has $k=2$ free parameters. After numerical optimization, the maximum log-likelihood for this model was found to be $\\ln(L_{\\text{CR-BD}}) = -152.8$.\n\nThe second model is a Diversity-Dependent Speciation (DDS) model. This model assumes that the extinction rate ($\\mu$) is constant, but the speciation rate declines linearly as the number of contemporary lineages, $N$, increases. The speciation rate is given by $\\lambda(N) = \\lambda_0 - \\alpha N$, where $\\lambda_0$ is the initial speciation rate and $\\alpha$ quantifies the strength of the diversity-dependence. This model has three free parameters ($\\lambda_0$, $\\alpha$, and $\\mu$), so $k=3$. The maximum log-likelihood for the DDS model was found to be $\\ln(L_{\\text{DDS}}) = -149.5$.\n\nTo compare the explanatory power of these two models while penalizing for the increased complexity of the DDS model, the biologist uses a model selection approach based on the Akaike Information Criterion (AIC). The AIC for a model is calculated using the formula:\n$$ \\text{AIC} = 2k - 2\\ln(L) $$\nwhere $k$ is the number of free parameters in the model and $\\ln(L)$ is the maximized log-likelihood. A lower AIC value indicates a better-fitting model.\n\nThe relative support for each model in a set can be expressed as an Akaike weight, $w_i$. To calculate this for a model $i$ from a set of $R$ candidate models, one first computes the difference between its AIC value and the minimum AIC value in the set: $\\Delta_i = \\text{AIC}_i - \\text{AIC}_{\\text{min}}$. The Akaike weight for model $i$ is then given by:\n$$ w_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)} $$\nThe Akaike weight $w_i$ can be interpreted as the probability that model $i$ is the best model in the set, given the data.\n\nUsing the information provided, calculate the Akaike weight for the Diversity-Dependent Speciation (DDS) model. Round your final answer to three significant figures.", "solution": "We need to compare two models using the Akaike Information Criterion. By definition,\n$$ \\text{AIC} = 2k - 2\\ln(L). $$\n\nFor the CR-BD model with $k=2$ and $\\ln(L_{\\text{CR-BD}})=-152.8$,\n$$ \\text{AIC}_{\\text{CR-BD}} = 2\\cdot 2 - 2(-152.8) = 4 + 305.6 = 309.6. $$\n\nFor the DDS model with $k=3$ and $\\ln(L_{\\text{DDS}})=-149.5$,\n$$ \\text{AIC}_{\\text{DDS}} = 2\\cdot 3 - 2(-149.5) = 6 + 299.0 = 305.0. $$\n\nThe minimum AIC is $\\text{AIC}_{\\text{min}}=305.0$ (DDS). The AIC differences are\n$$ \\Delta_{\\text{DDS}} = 305.0 - 305.0 = 0, \\quad \\Delta_{\\text{CR-BD}} = 309.6 - 305.0 = 4.6. $$\n\nWith $R=2$ models, the Akaike weight of the DDS model is\n$$ w_{\\text{DDS}} = \\frac{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right)}{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right) + \\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{CR-BD}}\\right)} = \\frac{1}{1 + \\exp\\!\\left(-\\frac{1}{2}\\cdot 4.6\\right)} = \\frac{1}{1 + \\exp(-2.3)}. $$\n\nNumerically, $\\exp(-2.3) \\approx 0.1002588435$, hence\n$$ w_{\\text{DDS}} \\approx \\frac{1}{1 + 0.1002588435} \\approx 0.908877. $$\n\nRounding to three significant figures gives $0.909$.", "answer": "$$\\boxed{0.909}$$", "id": "1911781"}, {"introduction": "Macroevolutionary dynamics are rarely constant, often shaped by historical crises and recoveries. This advanced problem [@problem_id:1911836] uses a time-dependent birth-death model to explore the \"Dead Clade Walking\" phenomenon, where a lineage appears to be recovering but is already on an irreversible path to extinction. This illustrates how the models can capture the lasting impact of past events and reveal complex, non-intuitive evolutionary trajectories.", "problem": "An ancient lineage of marine organisms, which we will model as a clade starting from a single ancestral species at time $t=0$, faces a severe environmental crisis. The diversification of this clade can be described by a time-dependent birth-death process with two distinct phases. All rates are given in units of events per million years (Myr).\n\n**Phase 1: The Crisis (from $t=0$ to $t=T$)**\nDuring this initial period of duration $T$, the environment is harsh. The speciation rate is constant at $\\lambda_1 = 0.20$ events/Myr, and the extinction rate is constant at $\\mu_1 = 0.80$ events/Myr.\n\n**Phase 2: The Recovery (for $t  T$)**\nAfter the crisis, the environment improves significantly and remains stable. The speciation rate for any surviving lineages becomes $\\lambda_2 = 0.50$ events/Myr, and the extinction rate falls to $\\mu_2 = 0.20$ events/Myr. Note that during this phase, the net diversification rate is positive, suggesting the clade might be recovering.\n\nDespite the apparent recovery in Phase 2, the initial damage during the crisis phase can be so severe that the clade is still overwhelmingly likely to go extinct in the long run. There exists a critical crisis duration, $T_{crit}$, for which the ultimate probability of the entire clade going extinct is precisely $0.999$.\n\nCalculate the value of this critical duration $T_{crit}$. Express your final answer in millions of years (Myr), rounded to three significant figures.", "solution": "We model the clade as a continuous-time birth-death branching process starting from one lineage at $t=0$. Let $N_{T}$ be the number of lineages at the end of Phase 1. In Phase 2 (with constant rates $\\lambda_{2}$, $\\mu_{2}$ and $\\lambda_{2}  \\mu_{2}$), the ultimate extinction probability starting from one lineage is $q_{2} = \\mu_{2}/\\lambda_{2}$, and starting from $k$ independent lineages it is $q_{2}^{k}$. Therefore, the ultimate extinction probability for the whole clade is\n$$\nP_{\\text{ext}} \\,=\\, \\mathbb{E}\\!\\left[q_{2}^{N_{T}}\\right] \\,=\\, F_{1}(T, q_{2}),\n$$\nwhere $F_{1}(t,s) = \\mathbb{E}[s^{N_{t}}]$ is the probability generating function (pgf) for the Phase 1 birth-death process with rates $(\\lambda_{1}, \\mu_{1})$, starting from one lineage.\n\nFor a linear birth-death process with constant rates $(\\lambda, \\mu)$ and initial condition $F(0,s)=s$, the pgf satisfies the Kolmogorov backward equation\n$$\n\\frac{\\partial F}{\\partial t} \\,=\\, \\lambda\\left(F^{2} - F\\right) + \\mu\\left(1 - F\\right),\n$$\nwhich can be written as\n$$\n\\frac{dF}{dt} \\,=\\, \\lambda F^{2} - (\\lambda + \\mu) F + \\mu \\,=\\, \\lambda (F - 1)\\!\\left(F - \\frac{\\mu}{\\lambda}\\right).\n$$\nLet $y(t) = F(t,s)$. Separating variables and integrating using the fixed points $1$ and $\\mu/\\lambda$ gives\n$$\n\\int \\frac{dy}{(y - 1)\\!\\left(y - \\frac{\\mu}{\\lambda}\\right)} \\,=\\, \\lambda \\int dt,\n$$\nwhich yields\n$$\n\\ln\\!\\left(\\frac{y - 1}{y - \\mu/\\lambda}\\right) \\,=\\, (\\lambda - \\mu) t + C.\n$$\nImposing $y(0)=s$ gives $C = \\ln\\!\\left(\\frac{s - 1}{s - \\mu/\\lambda}\\right)$, hence\n$$\n\\frac{y - 1}{y - \\mu/\\lambda} \\,=\\, \\frac{s - 1}{s - \\mu/\\lambda} \\,\\exp\\!\\left((\\lambda - \\mu) t\\right).\n$$\nSolving for $y=F(t,s)$,\n$$\nF(t,s) \\,=\\, \\frac{\\left(s - \\frac{\\mu}{\\lambda}\\right) - \\frac{\\mu}{\\lambda}(s - 1)\\,\\exp\\!\\left((\\lambda - \\mu) t\\right)}{\\left(s - \\frac{\\mu}{\\lambda}\\right) - (s - 1)\\,\\exp\\!\\left((\\lambda - \\mu) t\\right)}.\n$$\n\nFor Phase 1 parameters $\\lambda_{1} = 0.20$, $\\mu_{1} = 0.80$ and Phase 2 extinction probability $q_{2} = \\mu_{2}/\\lambda_{2} = 0.20/0.50 = 0.4$, set $s = q_{2}$, $\\lambda = \\lambda_{1}$, $\\mu = \\mu_{1}$, and $t = T$. Then $\\mu_{1}/\\lambda_{1} = 4$ and $\\exp\\!\\left((\\lambda_{1} - \\mu_{1}) T\\right) = \\exp(-0.60\\,T)$. Substituting,\n$$\nP_{\\text{ext}} \\,=\\, F_{1}(T, 0.4) \\,=\\, \\frac{(0.4 - 4) - 4(0.4 - 1)\\,\\exp(-0.60\\,T)}{(0.4 - 4) - (0.4 - 1)\\,\\exp(-0.60\\,T)} \\,=\\, \\frac{6 - 4\\,\\exp(-0.60\\,T)}{6 - \\exp(-0.60\\,T)}.\n$$\nWe require $P_{\\text{ext}} = 0.999$. Let $x = \\exp(-0.60\\,T)$. Then\n$$\n\\frac{6 - 4x}{6 - x} = 0.999 \\;\\;\\Rightarrow\\;\\; 6 - 4x = 0.999(6 - x) \\;\\;\\Rightarrow\\;\\; 0.006 = 3.001\\,x \\;\\;\\Rightarrow\\;\\; x = \\frac{6}{3001}.\n$$\nTherefore,\n$$\n\\exp(-0.60\\,T_{\\text{crit}}) = \\frac{6}{3001} \\;\\;\\Rightarrow\\;\\; T_{\\text{crit}} = -\\frac{1}{0.60}\\,\\ln\\!\\left(\\frac{6}{3001}\\right) \\,=\\, \\frac{5}{3}\\,\\ln\\!\\left(\\frac{3001}{6}\\right).\n$$\nNumerically,\n$$\nT_{\\text{crit}} \\approx \\frac{5}{3}\\times 6.214941376 \\approx 10.358235627 \\text{ Myr},\n$$\nwhich rounded to three significant figures is $10.4$ Myr.", "answer": "$$\\boxed{10.4}$$", "id": "1911836"}]}