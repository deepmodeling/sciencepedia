{"hands_on_practices": [{"introduction": "A neuron's fundamental computation is to integrate incoming signals and decide whether to fire an action potential. This first exercise [@problem_id:2599721] simplifies this complex process to its biophysical core, treating the neuron as a single electrical compartment. By applying Ohm's law, you will calculate the minimum number of synchronous excitatory synapses required to depolarize the membrane from rest to the spike threshold, providing a tangible sense of synaptic efficacy and the principles of linear summation.", "problem": "A spherical soma can be modeled as a single isopotential compartment with passive leak conductance and no active voltage-dependent channels over the timescale of interest. Let the resting membrane potential be $V_{\\text{rest}}=-65\\ \\text{mV}$, the spike threshold be $V_{\\text{th}}=-50\\ \\text{mV}$, and the somatic input resistance be $R_{\\text{in}}=150\\ \\text{M}\\Omega$. A set of identical, co-localized, and perfectly synchronous $\\alpha$-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid (AMPA) synapses activate at the soma. Each synapse produces a peak conductance change of $g_{\\text{AMPA}}=0.5\\ \\text{nS}$ with reversal potential $E_{\\text{AMPA}}=0\\ \\text{mV}$. Assume that (i) synaptic kinetics are slow enough relative to the somatic membrane time constant that the peak voltage deflection is well-approximated by a quasi-steady ohmic response, (ii) the membrane behaves linearly near rest so that synaptic currents sum linearly, and (iii) the driving force for each synapse can be approximated by the resting value during the rising phase of the synchronous event.\n\nStarting from the passive membrane current balance and Ohm’s law, derive an expression for the number $n$ of synchronous AMPA synapses needed to bring the soma from $V_{\\text{rest}}$ to $V_{\\text{th}}$ under these assumptions, and compute the minimal integer $n$ that achieves threshold. Report the final answer as a single integer with no units. No rounding by significant figures is required because the answer is a count.", "solution": "The problem requires the determination of the minimum number of synchronous synapses, $n$, needed to depolarize a neuron from its resting potential, $V_{\\text{rest}}$, to its spike threshold, $V_{\\text{th}}$. The analysis will be based on a passive, single-compartment model of the soma, adhering to the specified assumptions.\n\nThe fundamental principle governing the change in membrane potential in response to a steady injected current is Ohm's law, applied to the neuron as a whole. The problem states that the membrane behaves linearly near rest and that the event can be approximated as a quasi-steady ohmic response. This justifies the use of the following relation:\n$$ \\Delta V = I_{\\text{inj}} R_{\\text{in}} $$\nwhere $\\Delta V$ is the change in membrane potential, $I_{\\text{inj}}$ is the net injected current, and $R_{\\text{in}}$ is the somatic input resistance.\n\nThe required change in potential to reach threshold is the difference between the threshold and resting potentials:\n$$ \\Delta V = V_{\\text{th}} - V_{\\text{rest}} $$\n\nThe injected current, $I_{\\text{inj}}$, is generated by the simultaneous activation of $n$ identical AMPA synapses. Assumption (ii) states that these synaptic currents sum linearly. Assumption (iii) dictates that the driving force for each synapse is to be approximated using the resting membrane potential, $V_{\\text{rest}}$. The current contributed by a single AMPA synapse, $I_{\\text{AMPA}}$, is therefore given by its conductance, $g_{\\text{AMPA}}$, multiplied by this approximated driving force:\n$$ I_{\\text{AMPA}} = g_{\\text{AMPA}} (E_{\\text{AMPA}} - V_{\\text{rest}}) $$\nwhere $E_{\\text{AMPA}}$ is the reversal potential of the AMPA receptor channels.\n\nThe total injected current from $n$ synapses is the sum of the individual currents:\n$$ I_{\\text{inj}} = n \\cdot I_{\\text{AMPA}} = n \\cdot g_{\\text{AMPA}} (E_{\\text{AMPA}} - V_{\\text{rest}}) $$\n\nBy substituting the expressions for $\\Delta V$ and $I_{\\text{inj}}$ into the somatic Ohm's law equation, we establish the condition for reaching threshold:\n$$ V_{\\text{th}} - V_{\\text{rest}} = \\left[n \\cdot g_{\\text{AMPA}} (E_{\\text{AMPA}} - V_{\\text{rest}})\\right] R_{\\text{in}} $$\n\nThis equation can be rearranged to derive an expression for the number of synapses, $n$:\n$$ n = \\frac{V_{\\text{th}} - V_{\\text{rest}}}{R_{\\text{in}} \\cdot g_{\\text{AMPA}} \\cdot (E_{\\text{AMPA}} - V_{\\text{rest}})} $$\n\nWe now substitute the given numerical values into this expression. The values are:\n$V_{\\text{rest}} = -65\\ \\text{mV} = -6.5 \\times 10^{-2}\\ \\text{V}$\n$V_{\\text{th}} = -50\\ \\text{mV} = -5.0 \\times 10^{-2}\\ \\text{V}$\n$R_{\\text{in}} = 150\\ \\text{M}\\Omega = 1.5 \\times 10^{8}\\ \\Omega$\n$g_{\\text{AMPA}} = 0.5\\ \\text{nS} = 5.0 \\times 10^{-10}\\ \\text{S}$\n$E_{\\text{AMPA}} = 0\\ \\text{mV} = 0\\ \\text{V}$\n\nFirst, we calculate the potential differences:\n$$ V_{\\text{th}} - V_{\\text{rest}} = (-5.0 \\times 10^{-2}\\ \\text{V}) - (-6.5 \\times 10^{-2}\\ \\text{V}) = 1.5 \\times 10^{-2}\\ \\text{V} $$\n$$ E_{\\text{AMPA}} - V_{\\text{rest}} = (0\\ \\text{V}) - (-6.5 \\times 10^{-2}\\ \\text{V}) = 6.5 \\times 10^{-2}\\ \\text{V} $$\n\nNext, we compute the product in the denominator:\n$$ R_{\\text{in}} \\cdot g_{\\text{AMPA}} = (1.5 \\times 10^{8}\\ \\Omega) \\cdot (5.0 \\times 10^{-10}\\ \\text{S}) = 7.5 \\times 10^{-2} $$\nThe product of resistance and conductance is a dimensionless quantity.\n\nNow, we calculate $n$:\n$$ n = \\frac{1.5 \\times 10^{-2}}{ (7.5 \\times 10^{-2}) \\cdot (6.5 \\times 10^{-2}) } = \\frac{1.5}{(7.5) \\cdot (6.5 \\times 10^{-2})} = \\frac{1.5}{0.4875} $$\nTo simplify the fraction:\n$$ n = \\frac{15000}{4875} = \\frac{1000}{325} = \\frac{40}{13} $$\nNumerically, this is approximately:\n$$ n \\approx 3.0769... $$\n\nThe number of synapses, $n$, must be an integer. To *achieve* the threshold potential, the number of synapses must be sufficient to produce a potential change greater than or equal to $V_{\\text{th}}-V_{\\text{rest}}$. Therefore, we must take the ceiling of the calculated value.\n$$ n_{\\text{min}} = \\lceil \\frac{40}{13} \\rceil = 4 $$\nThus, a minimum of $4$ synchronous AMPA synapses are required to bring the soma to spike threshold under the given assumptions.", "answer": "$$\\boxed{4}$$", "id": "2599721"}, {"introduction": "Synaptic inputs rarely arrive in perfect synchrony; their timing is critical. This practice [@problem_id:2599694] explores this crucial temporal dimension of synaptic integration. You will model the summation of two sequential postsynaptic potentials to derive how the membrane's intrinsic passive properties, encapsulated by the membrane time constant $\\tau$, allow it to 'remember' recent inputs and integrate them over time.", "problem": "A neuron is modeled as a passive resistor-capacitor (RC) membrane in the subthreshold linear regime, characterized by a membrane time constant $\\tau$. Two identical excitatory postsynaptic potentials (EPSPs) arrive at times $t=0$ and $t=\\Delta t$. Each synaptic event is approximated as producing an instantaneous postsynaptic voltage increment of amplitude $V_{0}$ at its onset, followed by passive exponential decay governed by the membrane time constant $\\tau$. Assume the membrane behaves as a linear time-invariant system and that synaptic inputs sum linearly.\n\nStarting from the passive RC membrane dynamics and the principle of superposition for linear time-invariant systems, derive an analytic expression for the summed peak postsynaptic voltage amplitude after the second input as a function of $\\Delta t$ and $\\tau$. Then, using your derived expression, compute the ratio of these peak amplitudes for $\\Delta t=5\\,\\text{ms}$ versus $\\Delta t=20\\,\\text{ms}$, with $\\tau=15\\,\\text{ms}$. Report the ratio as a pure number, and round your answer to four significant figures.", "solution": "The problem statement is a valid exercise in biophysical modeling and is scientifically grounded, well-posed, and objective. We shall proceed with the derivation.\n\nThe subthreshold behavior of the neuronal membrane is modeled as a passive resistor-capacitor (RC) circuit. The voltage $V(t)$ across such a membrane, in the absence of input current after being charged to a certain potential, decays exponentially toward the resting potential (which we define as $0$ for convenience). This decay is governed by the differential equation:\n$$ \\tau \\frac{dV}{dt} + V = 0 $$\nwhere $\\tau = RC$ is the membrane time constant.\n\nA single excitatory postsynaptic potential (EPSP) is modeled as an instantaneous event at time $t_i$ that increases the membrane potential by an amplitude $V_0$. For an event at $t_i=0$, the voltage for $t \\ge 0$ is given by the solution to the above equation with the initial condition $V(0) = V_0$. The solution is:\n$$ V_1(t) = V_0 \\exp\\left(-\\frac{t}{\\tau}\\right) \\quad \\text{for } t \\ge 0 $$\n\nThe problem specifies two such identical events. The first occurs at $t=0$, and the second at $t=\\Delta t$.\nThe voltage response due to the first EPSP is:\n$$ V_1(t) = V_0 \\exp\\left(-\\frac{t}{\\tau}\\right) H(t) $$\nwhere $H(t)$ is the Heaviside step function, which is $1$ for $t \\ge 0$ and $0$ for $t  0$.\n\nThe voltage response due to the second EPSP, which is identical but delayed by $\\Delta t$, is:\n$$ V_2(t) = V_0 \\exp\\left(-\\frac{t-\\Delta t}{\\tau}\\right) H(t-\\Delta t) $$\n\nThe problem states that the membrane behaves as a linear time-invariant (LTI) system and that synaptic inputs sum linearly. This is the principle of superposition. Therefore, the total postsynaptic potential, $V_{total}(t)$, is the sum of the individual responses:\n$$ V_{total}(t) = V_1(t) + V_2(t) $$\n$$ V_{total}(t) = V_0 \\exp\\left(-\\frac{t}{\\tau}\\right) H(t) + V_0 \\exp\\left(-\\frac{t-\\Delta t}{\\tau}\\right) H(t-\\Delta t) $$\n\nWe are asked for the peak postsynaptic voltage amplitude *after* the second input. The second input occurs at $t=\\Delta t$. We must therefore analyze $V_{total}(t)$ for the interval $t \\ge \\Delta t$. In this interval, both Heaviside functions are equal to $1$, so the expression for the total voltage simplifies to:\n$$ V_{total}(t) = V_0 \\exp\\left(-\\frac{t}{\\tau}\\right) + V_0 \\exp\\left(-\\frac{t-\\Delta t}{\\tau}\\right) \\quad \\text{for } t \\ge \\Delta t $$\n\nTo find the peak amplitude in this interval, we analyze the derivative of $V_{total}(t)$ with respect to time $t$:\n$$ \\frac{dV_{total}}{dt} = \\frac{d}{dt} \\left[ V_0 \\exp\\left(-\\frac{t}{\\tau}\\right) + V_0 \\exp\\left(-\\frac{t-\\Delta t}{\\tau}\\right) \\right] $$\n$$ \\frac{dV_{total}}{dt} = V_0 \\left( -\\frac{1}{\\tau} \\right) \\exp\\left(-\\frac{t}{\\tau}\\right) + V_0 \\left( -\\frac{1}{\\tau} \\right) \\exp\\left(-\\frac{t-\\Delta t}{\\tau}\\right) $$\n$$ \\frac{dV_{total}}{dt} = -\\frac{V_0}{\\tau} \\left[ \\exp\\left(-\\frac{t}{\\tau}\\right) + \\exp\\left(-\\frac{t-\\Delta t}{\\tau}\\right) \\right] $$\nSince the parameters $V_0$ (excitatory input amplitude) and $\\tau$ (time constant) are physically positive, and the exponential function is always positive, the term in the square brackets is strictly positive. Consequently, the derivative $\\frac{dV_{total}}{dt}$ is strictly negative for all $t \\ge \\Delta t$.\n\nA function with a negative derivative over an interval is monotonically decreasing. Therefore, the maximum value of $V_{total}(t)$ for $t \\ge \\Delta t$ must occur at the very beginning of this interval, precisely at $t = \\Delta t$. This is the moment the second EPSP arrives and adds to the decaying potential from the first EPSP.\n\nWe now calculate this peak voltage, which we denote $V_{peak}$, by evaluating $V_{total}(t)$ at $t=\\Delta t$:\n$$ V_{peak}(\\Delta t, \\tau) = V_{total}(\\Delta t) = V_0 \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) + V_0 \\exp\\left(-\\frac{\\Delta t-\\Delta t}{\\tau}\\right) $$\n$$ V_{peak}(\\Delta t, \\tau) = V_0 \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) + V_0 \\exp(0) $$\n$$ V_{peak}(\\Delta t, \\tau) = V_0 \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) + V_0 $$\nFactoring out $V_0$, we obtain the required analytic expression for the peak amplitude as a function of $\\Delta t$ and $\\tau$:\n$$ V_{peak}(\\Delta t, \\tau) = V_0 \\left( 1 + \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) \\right) $$\n\nNext, we must compute the ratio of these peak amplitudes for two different inter-stimulus intervals, $\\Delta t_1 = 5\\,\\text{ms}$ and $\\Delta t_2 = 20\\,\\text{ms}$, given the membrane time constant $\\tau = 15\\,\\text{ms}$.\n\nLet $V_{peak,1}$ be the peak amplitude for $\\Delta t_1$ and $V_{peak,2}$ be the peak amplitude for $\\Delta t_2$.\n$$ V_{peak,1} = V_0 \\left( 1 + \\exp\\left(-\\frac{\\Delta t_1}{\\tau}\\right) \\right) $$\n$$ V_{peak,2} = V_0 \\left( 1 + \\exp\\left(-\\frac{\\Delta t_2}{\\tau}\\right) \\right) $$\n\nThe ratio $R$ is:\n$$ R = \\frac{V_{peak,1}}{V_{peak,2}} = \\frac{V_0 \\left( 1 + \\exp\\left(-\\frac{\\Delta t_1}{\\tau}\\right) \\right)}{V_0 \\left( 1 + \\exp\\left(-\\frac{\\Delta t_2}{\\tau}\\right) \\right)} = \\frac{1 + \\exp\\left(-\\frac{\\Delta t_1}{\\tau}\\right)}{1 + \\exp\\left(-\\frac{\\Delta t_2}{\\tau}\\right)} $$\nThe unknown initial amplitude $V_0$ cancels, as expected. Substituting the given values:\n$$ \\Delta t_1 = 5\\,\\text{ms} $$\n$$ \\Delta t_2 = 20\\,\\text{ms} $$\n$$ \\tau = 15\\,\\text{ms} $$\nThe exponents become:\n$$ -\\frac{\\Delta t_1}{\\tau} = -\\frac{5}{15} = -\\frac{1}{3} $$\n$$ -\\frac{\\Delta t_2}{\\tau} = -\\frac{20}{15} = -\\frac{4}{3} $$\nThe ratio is therefore:\n$$ R = \\frac{1 + \\exp\\left(-\\frac{1}{3}\\right)}{1 + \\exp\\left(-\\frac{4}{3}\\right)} $$\nNow, we compute the numerical value:\n$$ \\exp\\left(-\\frac{1}{3}\\right) \\approx 0.71653131 $$\n$$ \\exp\\left(-\\frac{4}{3}\\right) \\approx 0.26359714 $$\n$$ R = \\frac{1 + 0.71653131}{1 + 0.26359714} = \\frac{1.71653131}{1.26359714} \\approx 1.3584506 $$\nRounding the result to four significant figures, we get $1.358$.", "answer": "$$\n\\boxed{1.358}\n$$", "id": "2599694"}, {"introduction": "Synapses are not all created equal; their location on the intricate dendritic tree dramatically influences their impact. This final hands-on practice [@problem_id:2599662] moves from idealized models to a more realistic computational simulation, investigating the unique properties of synapses located on dendritic spines. By building a two-compartment model, you will explore how the high electrical resistance of a spine neck can create a privileged local signaling domain, powerfully engaging voltage-dependent channels like the NMDA receptor that are critical for synaptic plasticity.", "problem": "You are asked to implement and simulate a small passive-compartment model to examine how placing the same synaptic conductance on a dendritic spine versus directly on the dendritic shaft changes local depolarization and the activation of N-methyl-D-aspartate (NMDA) receptors due to isolation by spine-neck resistance. Your implementation must start from fundamental principles of current balance and passive membrane biophysics, without using pre-derived shortcut solutions for the full system response.\n\nStart from the following foundational base:\n- Kirchhoff’s Current Law (KCL): the algebraic sum of currents into a node equals zero. For a membrane compartment, current balance is expressed as capacitive current equal to the sum of all transmembrane ionic and coupling currents.\n- Ohm’s Law: current equals conductance times driving force.\n- The membrane as a capacitor-leak element: capacitive current equals capacitance times the time derivative of voltage; leak current equals leak conductance times the voltage difference to the leak reversal potential.\n- Synaptic current as a conductance change with a fixed reversal potential. The alpha-like kinetics is modeled as a normalized double-exponential conductance time course.\n- NMDA receptor voltage dependence due to magnesium block: the fraction of unblocked channels depends on voltage and extracellular magnesium concentration via a well-tested empirical formula.\n\nModel specifications and equations:\n1. Dendritic shaft-only placement (single-compartment model). Let the dendritic voltage be $V_{\\mathrm{d}}(t)$, membrane capacitance be $C_{\\mathrm{d}}$, leak conductance be $g_{\\mathrm{L,d}}$, leak reversal potential be $E_{\\mathrm{L}}$, and synaptic reversal potential be $E_{\\mathrm{syn}}$. The synapse consists of two components: an AMPA-like conductance $g_{\\mathrm{A}}(t)$ and an NMDA-like conductance $g_{\\mathrm{N}}(t)$ that is modulated by a voltage-dependent magnesium block factor $B(V)$. The current balance is\n$$\nC_{\\mathrm{d}} \\frac{d V_{\\mathrm{d}}}{dt} \\;=\\; - g_{\\mathrm{L,d}} \\big(V_{\\mathrm{d}} - E_{\\mathrm{L}}\\big) \\;-\\; g_{\\mathrm{A}}(t)\\big(V_{\\mathrm{d}} - E_{\\mathrm{syn}}\\big) \\;-\\; g_{\\mathrm{N}}(t)\\,B\\!\\big(V_{\\mathrm{d}}\\big)\\,\\big(V_{\\mathrm{d}} - E_{\\mathrm{syn}}\\big).\n$$\n\n2. Spine-head placement (two-compartment model). A spine head with voltage $V_{\\mathrm{h}}(t)$ is connected to the dendrite with voltage $V_{\\mathrm{d}}(t)$ by a spine neck resistance $R_{\\mathrm{neck}}$, equivalently a neck conductance $g_{\\mathrm{neck}} = 1/R_{\\mathrm{neck}}$. The spine head has capacitance $C_{\\mathrm{h}}$ and leak conductance $g_{\\mathrm{L,h}}$. The same synapse (AMPA and NMDA components) is placed on the head. The current balance equations are\n$$\n\\begin{aligned}\nC_{\\mathrm{h}} \\frac{d V_{\\mathrm{h}}}{dt} = - g_{\\mathrm{L,h}} \\big(V_{\\mathrm{h}} - E_{\\mathrm{L}}\\big) - g_{\\mathrm{A}}(t)\\big(V_{\\mathrm{h}} - E_{\\mathrm{syn}}\\big) - g_{\\mathrm{N}}(t)\\,B\\!\\big(V_{\\mathrm{h}}\\big)\\,\\big(V_{\\mathrm{h}} - E_{\\mathrm{syn}}\\big) - g_{\\mathrm{neck}}\\big(V_{\\mathrm{h}} - V_{\\mathrm{d}}\\big), \\\\\nC_{\\mathrm{d}} \\frac{d V_{\\mathrm{d}}}{dt} = - g_{\\mathrm{L,d}} \\big(V_{\\mathrm{d}} - E_{\\mathrm{L}}\\big) - g_{\\mathrm{neck}}\\big(V_{\\mathrm{d}} - V_{\\mathrm{h}}\\big).\n\\end{aligned}\n$$\nThe local synaptic site voltage is $V_{\\mathrm{d}}(t)$ in the shaft-only case and $V_{\\mathrm{h}}(t)$ in the spine case.\n\n3. Synaptic kinetics. The AMPA and NMDA conductances rise and decay according to normalized double exponentials:\n$$\ns(t;\\tau_{\\mathrm{r}},\\tau_{\\mathrm{d}}) \\;=\\; \\frac{e^{-t/\\tau_{\\mathrm{d}}} - e^{-t/\\tau_{\\mathrm{r}}}}{\\max_{u \\ge 0}\\big(e^{-u/\\tau_{\\mathrm{d}}} - e^{-u/\\tau_{\\mathrm{r}}}\\big)} \\quad \\text{for } t \\ge 0,\n$$\nand $s(t)=0$ for $t0$. The conductances are $g_{\\mathrm{A}}(t) = \\bar{g}_{\\mathrm{A}}\\,s(t;\\tau_{\\mathrm{r,A}},\\tau_{\\mathrm{d,A}})$ and $g_{\\mathrm{N}}(t) = \\bar{g}_{\\mathrm{N}}\\,s(t;\\tau_{\\mathrm{r,N}},\\tau_{\\mathrm{d,N}})$.\n\n4. NMDA magnesium block. Use the empirically established magnesium block function\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\big([\\mathrm{Mg}^{2+}]/3.57\\big)\\,\\exp\\!\\big(-0.062\\,V\\big)},\n$$\nwhere $V$ is in millivolts and $[\\mathrm{Mg}^{2+}]$ is in millimolar, so that the effective NMDA current is $I_{\\mathrm{N}}(t)=g_{\\mathrm{N}}(t)\\,B\\!\\big(V_{\\text{local}}(t)\\big)\\,\\big(V_{\\text{local}}(t) - E_{\\mathrm{syn}}\\big)$ at the local synaptic site voltage $V_{\\text{local}}$.\n\nParameter values, units, and simulation protocol:\n- Use $E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$ and $E_{\\mathrm{syn}}=0\\,\\mathrm{mV}$.\n- Dendrite: $C_{\\mathrm{d}} = 100\\,\\mathrm{pF}$, $g_{\\mathrm{L,d}} = 10\\,\\mathrm{nS}$.\n- Spine head: $C_{\\mathrm{h}} = 10\\,\\mathrm{pF}$, $g_{\\mathrm{L,h}} = 1\\,\\mathrm{nS}$.\n- Synapse: $\\bar{g}_{\\mathrm{A}} = 1.0\\,\\mathrm{nS}$ with $\\tau_{\\mathrm{r,A}}=0.5\\,\\mathrm{ms}$ and $\\tau_{\\mathrm{d,A}}=5\\,\\mathrm{ms}$; $\\bar{g}_{\\mathrm{N}} = 0.5\\,\\mathrm{nS}$ with $\\tau_{\\mathrm{r,N}}=3\\,\\mathrm{ms}$ and $\\tau_{\\mathrm{d,N}}=100\\,\\mathrm{ms}$. The two components share the same onset time $t=0$.\n- Magnesium: $[\\mathrm{Mg}^{2+}]=1.0\\,\\mathrm{mM}$.\n- Spine neck conductance is $g_{\\mathrm{neck}} = 1/R_{\\mathrm{neck}}$ with $R_{\\mathrm{neck}}$ specified in megaohms. Convert units so that conductances are in nanosiemens; note that $1\\,\\mathrm{M}\\Omega$ corresponds to $1000\\,\\mathrm{nS}$, so $g_{\\mathrm{neck}} \\text{ [in nS]} = 1000 / (R_{\\mathrm{neck}} \\text{ [in M}\\Omega\\text{]})$.\n- Initial conditions: $V_{\\mathrm{d}}(0)=V_{\\mathrm{h}}(0)=E_{\\mathrm{L}}$.\n- Time discretization: use a fixed-step forward Euler method consistent with KCL and Ohm’s Law, with time step $\\Delta t = 0.01\\,\\mathrm{ms}$ for a total simulation duration of $200\\,\\mathrm{ms}$. All computations must maintain unit consistency such that $1\\,\\mathrm{pA}/1\\,\\mathrm{pF}=1\\,\\mathrm{mV}/\\mathrm{ms}$ and $1\\,\\mathrm{nS}\\cdot 1\\,\\mathrm{mV}=1\\,\\mathrm{pA}$.\n\nQuantities to report per test case:\n- The peak local depolarization at the synaptic site above rest, $\\max_t\\big(V_{\\text{local}}(t) - E_{\\mathrm{L}}\\big)$, reported in millivolts.\n- The peak absolute NMDA current magnitude at the synaptic site, $\\max_t \\big|I_{\\mathrm{N}}(t)\\big|$, reported in picoamperes.\n\nTest suite:\nProvide results for the following four parameter sets. Each test case specifies placement, $R_{\\mathrm{neck}}$ (ignored for shaft), and uses all other parameters exactly as above.\n1. Placement shaft, $R_{\\mathrm{neck}}=150\\,\\mathrm{M}\\Omega$.\n2. Placement spine, $R_{\\mathrm{neck}}=150\\,\\mathrm{M}\\Omega$.\n3. Placement spine, $R_{\\mathrm{neck}}=500\\,\\mathrm{M}\\Omega$.\n4. Placement spine, $R_{\\mathrm{neck}}=5\\,\\mathrm{M}\\Omega$.\n\nAngle units do not apply. Express all voltages in millivolts and currents in picoamperes, each rounded to three decimal places. Your program should produce a single line of output containing the results as a comma-separated JSON-like nested list in the order above, where each inner list is of the form $[\\text{peak\\_depol\\_mV}, \\text{peak\\_abs\\_I\\_NMDA\\_pA}]$. For example, a valid output structure is\n[[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\nwith no spaces.", "solution": "The problem statement presented is a well-posed and scientifically sound exercise in computational neuroscience, a sub-discipline of biophysics and quantitative physiology. It is based on established principles, namely Kirchhoff's Current Law and Ohm's Law, applied to a passive compartmental model of a neuron. The equations and parameters are standard and biophysically realistic. The problem is complete, unambiguous, and requires the application of fundamental numerical methods to solve a system of ordinary differential equations (ODEs). Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe core of the problem is to simulate the voltage dynamics of a dendritic compartment, and optionally a connected spine compartment, in response to a synaptic input. This is achieved by numerically integrating the governing ODEs. The specified method is the forward Euler algorithm, a first-order numerical procedure for solving ODEs with a given initial value.\n\nFirst, we must formalize the components of the model.\n\n**1. Synaptic Conductance Time Course**\n\nThe synaptic conductances, $g_{\\mathrm{A}}(t)$ for AMPA and $g_{\\mathrm{N}}(t)$ for NMDA, follow a normalized double-exponential function $s(t;\\tau_{\\mathrm{r}},\\tau_{\\mathrm{d}})$.\n$$\ns(t;\\tau_{\\mathrm{r}},\\tau_{\\mathrm{d}}) \\;=\\; \\frac{e^{-t/\\tau_{\\mathrm{d}}} - e^{-t/\\tau_{\\mathrm{r}}}}{N}\n$$\nwhere $N$ is the normalization factor, equal to the peak value of the unnormalized function $f(t) = e^{-t/\\tau_{\\mathrm{d}}} - e^{-t/\\tau_{\\mathrm{r}}}$. The time-to-peak, $t_{\\mathrm{peak}}$, is found by setting the derivative $df/dt$ to zero:\n$$\n\\frac{d}{dt}\\left(e^{-t/\\tau_{\\mathrm{d}}} - e^{-t/\\tau_{\\mathrm{r}}}\\right) = -\\frac{1}{\\tau_{\\mathrm{d}}}e^{-t/\\tau_{\\mathrm{d}}} + \\frac{1}{\\tau_{\\mathrm{r}}}e^{-t/\\tau_{\\mathrm{r}}} = 0\n$$\nSolving for $t$ gives the time-to-peak:\n$$\nt_{\\mathrm{peak}} = \\frac{\\tau_{\\mathrm{r}}\\tau_{\\mathrm{d}}}{\\tau_{\\mathrm{d}} - \\tau_{\\mathrm{r}}} \\ln\\left(\\frac{\\tau_{\\mathrm{d}}}{\\tau_{\\mathrm{r}}}\\right)\n$$\nThe normalization factor is then $N = f(t_{\\mathrm{peak}})$. The full time-dependent conductances are thus $g_{\\mathrm{A}}(t) = \\bar{g}_{\\mathrm{A}}\\,s(t;\\tau_{\\mathrm{r,A}},\\tau_{\\mathrm{d,A}})$ and $g_{\\mathrm{N}}(t) = \\bar{g}_{\\mathrm{N}}\\,s(t;\\tau_{\\mathrm{r,N}},\\tau_{\\mathrm{d,N}})$. These conductance time series will be pre-calculated for the entire simulation duration from $t=0$ to $t=200\\,\\mathrm{ms}$.\n\n**2. NMDA Receptor Magnesium Block**\n\nThe voltage-dependent magnesium block of the NMDA receptor is modeled by the function $B(V)$:\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\frac{[\\mathrm{Mg}^{2+}]}{3.57\\,\\mathrm{mM}}\\,\\exp\\left(\\frac{-0.062}{\\mathrm{mV}}\\,V\\right)}\n$$\nThis function describes the fraction of NMDA channels that are unblocked and thus able to conduct current. The function will be evaluated at each time step using the membrane potential of the compartment where the synapse is located.\n\n**3. Numerical Integration (Forward Euler Method)**\n\nThe systems of ODEs are solved using the forward Euler method. For a general ODE of the form $C \\frac{dV}{dt} = I_{\\mathrm{total}}(V, t)$, the voltage at the next time step, $V(t_{i+1})$, is approximated from the voltage at the current step, $V(t_i)$, as:\n$$\nV(t_{i+1}) \\approx V(t_i) + \\Delta t \\cdot \\frac{dV}{dt}\\bigg|_{t_i} = V(t_i) + \\frac{\\Delta t}{C} I_{\\mathrm{total}}(V(t_i), t_i)\n$$\nwhere $\\Delta t$ is the time step, specified as $0.01\\,\\mathrm{ms}$. The unit system is chosen to be consistent: voltages in millivolts ($\\mathrm{mV}$), time in milliseconds ($\\mathrm{ms}$), capacitances in picofarads ($\\mathrm{pF}$), conductances in nanosiemens ($\\mathrm{nS}$), and currents in picoamperes ($\\mathrm{pA}$). This system satisfies the required relationships $1\\,\\mathrm{nS} \\cdot 1\\,\\mathrm{mV} = 1\\,\\mathrm{pA}$ and $1\\,\\mathrm{pA} / 1\\,\\mathrm{pF} = 1\\,\\mathrm{mV/ms}$.\n\nThe specific update rules are derived for each case.\n\n**Case 1: Synapse on Dendritic Shaft (1-Compartment Model)**\nThe single ODE is:\n$$\n\\frac{d V_{\\mathrm{d}}}{dt} \\;=\\; \\frac{1}{C_{\\mathrm{d}}} \\left[ - g_{\\mathrm{L,d}} (V_{\\mathrm{d}} - E_{\\mathrm{L}}) - g_{\\mathrm{A}}(t)(V_{\\mathrm{d}} - E_{\\mathrm{syn}}) - g_{\\mathrm{N}}(t) B(V_{\\mathrm{d}})(V_{\\mathrm{d}} - E_{\\mathrm{syn}}) \\right]\n$$\nThe Euler update for the dendritic voltage $V_{\\mathrm{d}}$ from step $i$ to $i+1$ is:\n$$\nV_{\\mathrm{d}, i+1} = V_{\\mathrm{d}, i} + \\frac{\\Delta t}{C_{\\mathrm{d}}} \\left[ - g_{\\mathrm{L,d}} (V_{\\mathrm{d}, i} - E_{\\mathrm{L}}) - g_{\\mathrm{A}}(t_i)(V_{\\mathrm{d}, i} - E_{\\mathrm{syn}}) - g_{\\mathrm{N}}(t_i) B(V_{\\mathrm{d}, i})(V_{\\mathrm{d}, i} - E_{\\mathrm{syn}}) \\right]\n$$\nThe initial condition is $V_{\\mathrm{d},0} = E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$. The local voltage for the synapse is $V_{\\text{local}} = V_{\\mathrm{d}}$.\n\n**Case 2: Synapse on Spine Head (2-Compartment Model)**\nWe have a system of two coupled ODEs:\n$$\n\\frac{d V_{\\mathrm{h}}}{dt} = \\frac{1}{C_{\\mathrm{h}}} \\left[- g_{\\mathrm{L,h}} (V_{\\mathrm{h}} - E_{\\mathrm{L}}) - g_{\\mathrm{A}}(t)(V_{\\mathrm{h}} - E_{\\mathrm{syn}}) - g_{\\mathrm{N}}(t) B(V_{\\mathrm{h}})(V_{\\mathrm{h}} - E_{\\mathrm{syn}}) - g_{\\mathrm{neck}}(V_{\\mathrm{h}} - V_{\\mathrm{d}})\\right]\n$$\n$$\n\\frac{d V_{\\mathrm{d}}}{dt} = \\frac{1}{C_{\\mathrm{d}}} \\left[- g_{\\mathrm{L,d}} (V_{\\mathrm{d}} - E_{\\mathrm{L}}) - g_{\\mathrm{neck}}(V_{\\mathrm{d}} - V_{\\mathrm{h}})\\right]\n$$\nThe neck conductance $g_{\\mathrm{neck}}$ is calculated from the neck resistance $R_{\\mathrm{neck}}$ as $g_{\\mathrm{neck}} [\\mathrm{nS}] = 1000 / R_{\\mathrm{neck}} [\\mathrm{M}\\Omega]$. The Euler updates for the spine head voltage $V_{\\mathrm{h}}$ and dendritic voltage $V_{\\mathrm{d}}$ are performed simultaneously using the values from step $i$:\n$$\nI_{\\mathrm{h},i} = - g_{\\mathrm{L,h}} (V_{\\mathrm{h},i} - E_{\\mathrm{L}}) - g_{\\mathrm{A}}(t_i)(V_{\\mathrm{h},i} - E_{\\mathrm{syn}}) - g_{\\mathrm{N}}(t_i) B(V_{\\mathrm{h},i})(V_{\\mathrm{h},i} - E_{\\mathrm{syn}}) - g_{\\mathrm{neck}}(V_{\\mathrm{h},i} - V_{\\mathrm{d},i})\n$$\n$$\nI_{\\mathrm{d},i} = - g_{\\mathrm{L,d}}(V_{\\mathrm{d},i} - E_{\\mathrm{L}}) - g_{\\mathrm{neck}}(V_{\\mathrm{d},i} - V_{\\mathrm{h},i})\n$$\n$$\nV_{\\mathrm{h}, i+1} = V_{\\mathrm{h}, i} + \\frac{\\Delta t}{C_{\\mathrm{h}}} I_{\\mathrm{h}, i}\n$$\n$$\nV_{\\mathrm{d}, i+1} = V_{\\mathrm{d}, i} + \\frac{\\Delta t}{C_{\\mathrm{d}}} I_{\\mathrm{d}, i}\n$$\nThe initial conditions are $V_{\\mathrm{h},0} = V_{\\mathrm{d},0} = E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$. The local voltage for the synapse is $V_{\\text{local}} = V_{\\mathrm{h}}$.\n\n**4. Calculation of Output Quantities**\nFor each simulation run corresponding to a test case, two quantities are calculated:\n1.  **Peak local depolarization**: This is the maximum voltage achieved at the synaptic site minus the resting potential, $E_{\\mathrm{L}}$.\n    $\\Delta V_{\\mathrm{peak}} = \\max_t\\big(V_{\\text{local}}(t) - E_{\\mathrm{L}}\\big)$.\n2.  **Peak absolute NMDA current**: The NMDA current is calculated at each time step as $I_{\\mathrm{N}}(t_i) = g_{\\mathrm{N}}(t_i) B(V_{\\text{local}, i})(V_{\\text{local}, i} - E_{\\mathrm{syn}})$. The maximum of the absolute value of this current over the entire simulation is determined.\n    $I_{\\mathrm{N,peak}} = \\max_t|I_{\\mathrm{N}}(t)|$.\n\n**5. Implementation Code**\nThe following Python script implements the simulation and calculation logic described above.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n\n    # Test cases from the problem statement\n    # Each tuple: (placement_str, R_neck_MOhm)\n    test_cases = [\n        ('shaft', 150.0),\n        ('spine', 150.0),\n        ('spine', 500.0),\n        ('spine', 5.0),\n    ]\n\n    all_results = []\n    for placement, R_neck in test_cases:\n        # Run the simulation for the current test case\n        peak_depol, peak_current = run_simulation(placement, R_neck)\n        \n        # Round results to three decimal places\n        rounded_depol = round(peak_depol, 3)\n        rounded_current = round(peak_current, 3)\n        \n        all_results.append([rounded_depol, rounded_current])\n\n    # Format the output string as per the requirement: [[x1,y1],[x2,y2],...]\n    result_strings = [f\"[{res[0]},{res[1]}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    return final_output\n\n\ndef run_simulation(placement, R_neck_MOhm):\n    \"\"\"\n    Simulates the compartmental model for a single test case.\n\n    Args:\n        placement (str): 'shaft' or 'spine'.\n        R_neck_MOhm (float): Spine neck resistance in MegaOhms.\n\n    Returns:\n        tuple: (peak_depol_mV, peak_abs_I_NMDA_pA)\n    \"\"\"\n    # --- Model Parameters (all units are consistent: mV, ms, pF, nS, pA) ---\n    E_L = -65.0       # Leak reversal potential (mV)\n    E_syn = 0.0       # Synaptic reversal potential (mV)\n    C_d = 100.0       # Dendrite capacitance (pF)\n    g_L_d = 10.0      # Dendrite leak conductance (nS)\n    C_h = 10.0        # Spine head capacitance (pF)\n    g_L_h = 1.0       # Spine head leak conductance (nS)\n    \n    g_peak_A = 1.0    # Peak AMPA conductance (nS)\n    tau_r_A = 0.5     # AMPA rise time constant (ms)\n    tau_d_A = 5.0     # AMPA decay time constant (ms)\n    \n    g_peak_N = 0.5    # Peak NMDA conductance (nS)\n    tau_r_N = 3.0     # NMDA rise time constant (ms)\n    tau_d_N = 100.0   # NMDA decay time constant (ms)\n    \n    Mg_conc = 1.0     # Extracellular Magnesium concentration (mM)\n    \n    # Spine neck conductance (nS)\n    g_neck = 1000.0 / R_neck_MOhm if R_neck_MOhm > 0 else np.inf\n\n    # --- Simulation Protocol ---\n    dt = 0.01         # Time step (ms)\n    t_total = 200.0   # Total simulation duration (ms)\n    time_pts = np.arange(0, t_total, dt)\n    num_steps = len(time_pts)\n\n    # --- Helper Functions ---\n    def s_func(t, tau_r, tau_d):\n        \"\"\"Normalized double-exponential function for synaptic conductance.\"\"\"\n        if tau_r == tau_d: # Avoid division by zero, though not expected here\n            t_peak = tau_r / np.e\n        else:\n             t_peak = (tau_r * tau_d) / (tau_d - tau_r) * np.log(tau_d / tau_r)\n        \n        norm_factor = np.exp(-t_peak / tau_d) - np.exp(-t_peak / tau_r)\n        \n        if norm_factor == 0: return np.zeros_like(t)\n        \n        return (np.exp(-t / tau_d) - np.exp(-t / tau_r)) / norm_factor\n\n    def B_func(V, mg):\n        \"\"\"Voltage-dependent magnesium block of NMDA receptors.\"\"\"\n        return 1.0 / (1.0 + (mg / 3.57) * np.exp(-0.062 * V))\n\n    # --- Pre-calculate synaptic conductances ---\n    g_A_t = g_peak_A * s_func(time_pts, tau_r_A, tau_d_A)\n    g_N_t = g_peak_N * s_func(time_pts, tau_r_N, tau_d_N)\n    \n    # --- Initialize state variables and recorders ---\n    V_d_t = np.zeros(num_steps)\n    V_h_t = np.zeros(num_steps)\n    V_d_t[0] = E_L\n    V_h_t[0] = E_L\n    \n    I_NMDA_t = np.zeros(num_steps)\n\n    # --- Forward Euler Integration Loop ---\n    for i in range(num_steps - 1):\n        if placement == 'shaft':\n            V_local = V_d_t[i]\n            \n            # Currents in pA\n            I_L = g_L_d * (V_local - E_L)\n            I_A = g_A_t[i] * (V_local - E_syn)\n            I_N_inst = g_N_t[i] * B_func(V_local, Mg_conc) * (V_local - E_syn)\n            I_NMDA_t[i] = I_N_inst\n\n            # Update voltage (dV/dt = I_total / C)\n            dVd_dt = (-I_L - I_A - I_N_inst) / C_d\n            V_d_t[i+1] = V_d_t[i] + dVd_dt * dt\n            \n        elif placement == 'spine':\n            V_h = V_h_t[i]\n            V_d = V_d_t[i]\n            V_local = V_h\n            \n            # Head currents in pA\n            I_L_h = g_L_h * (V_h - E_L)\n            I_A = g_A_t[i] * (V_h - E_syn)\n            I_N_inst = g_N_t[i] * B_func(V_h, Mg_conc) * (V_h - E_syn)\n            I_NMDA_t[i] = I_N_inst\n            I_neck = g_neck * (V_h - V_d)\n            \n            dVh_dt = (-I_L_h - I_A - I_N_inst - I_neck) / C_h\n            V_h_t[i+1] = V_h + dVh_dt * dt\n            \n            # Dendrite currents in pA\n            I_L_d = g_L_d * (V_d - E_L)\n            \n            # Note I_neck sign convention change\n            dVd_dt = (-I_L_d + I_neck) / C_d\n            V_d_t[i+1] = V_d + dVd_dt * dt\n    \n    # --- Calculate and return final metrics ---\n    if placement == 'shaft':\n        peak_depol_mV = np.max(V_d_t) - E_L\n    else: # spine\n        peak_depol_mV = np.max(V_h_t) - E_L\n        \n    peak_abs_I_NMDA_pA = np.max(np.abs(I_NMDA_t))\n    \n    return peak_depol_mV, peak_abs_I_NMDA_pA\n\n# The final answer is generated by running solve()\n# final_answer_string = solve()\n\n```\nThe simulation described above yields the numerical results for the four test cases.", "answer": "[[10.648,-11.233],[30.638,-44.646],[40.528,-63.099],[4.706,-4.244]]", "id": "2599662"}]}