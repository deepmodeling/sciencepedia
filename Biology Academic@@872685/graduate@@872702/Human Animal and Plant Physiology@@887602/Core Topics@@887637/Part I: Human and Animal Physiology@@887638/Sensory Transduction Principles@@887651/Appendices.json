{"hands_on_practices": [{"introduction": "At the heart of sensory transduction lies a change in the electrical state of a receptor cell. This first practice provides a foundational exercise in modeling this process using the principles of cellular electrophysiology. By treating a vertebrate photoreceptor as a simple electrical circuit, you will derive the receptor potential from first principles, reinforcing the crucial link between stimulus-induced ion channel gating, membrane conductance, and the resulting voltage signal that initiates the process of vision [@problem_id:2607356].", "problem": "A vertebrate rod photoreceptor at a fixed temperature is modeled as a single isopotential compartment with two parallel membrane conductances: a cyclic guanosine monophosphate (cGMP)-gated nonselective cation conductance with reversal potential $E_{\\mathrm{cGMP}}$ and a voltage-independent leak conductance with reversal potential $E_{L}$. In darkness, the cGMP-gated channels are open, and the total membrane conductance (cGMP plus leak) is $12\\,\\mathrm{nS}$. Upon a steady step of light, cGMP-gated channels close, reducing the total membrane conductance to $7\\,\\mathrm{nS}$. The leak conductance is $g_{L}=2\\,\\mathrm{nS}$ with $E_{L}=-65\\,\\mathrm{mV}$, the cGMP-gated reversal potential is $E_{\\mathrm{cGMP}}=0\\,\\mathrm{mV}$, and the membrane capacitance is $C_{m}=20\\,\\mathrm{pF}$. Assume no other ionic conductances, no active currents, and no axial currents; there is no externally injected current.\n\nUsing only first principles of passive membrane current balance, derive the steady-state membrane potential in darkness and in light, and from these compute the receptor potential, defined here as the steady-state change in membrane potential due to light, $\\Delta V \\equiv V_{\\text{light}}-V_{\\text{dark}}$. Round your final numeric answer for $\\Delta V$ to four significant figures and express it in millivolts. State only the final numeric value as your answer.", "solution": "The problem presents a valid and well-posed scenario based on fundamental principles of cellular electrophysiology. We will proceed to derive the solution from first principles as requested.\n\nThe photoreceptor is modeled as a single isopotential compartment. The membrane potential, $V_m$, is governed by the total current across the membrane. According to the principle of conservation of charge, the net current across the membrane must be zero in the absence of an external current source. The total current, $I_{\\text{total}}$, is the sum of the capacitive current, $I_C$, and the ionic currents. In this problem, the ionic currents are the cGMP-gated current, $I_{\\text{cGMP}}$, and the leak current, $I_L$.\n$$I_{\\text{total}} = I_C + I_{\\text{cGMP}} + I_L = 0$$\nThe capacitive current is given by $I_C = C_m \\frac{dV_m}{dt}$, where $C_m$ is the membrane capacitance and $\\frac{dV_m}{dt}$ is the rate of change of the membrane potential.\nAt steady state, the membrane potential is constant, so $\\frac{dV_m}{dt}=0$. This implies that the capacitive current $I_C=0$. The steady-state condition is therefore that the sum of all ionic currents across the membrane is zero:\n$$I_{\\text{cGMP}} + I_L = 0$$\nEach ionic current follows Ohm's law, where the current is the product of the conductance ($g$) and the driving force ($V_m - E_{\\text{rev}}$), where $E_{\\text{rev}}$ is the reversal potential for that ion channel.\nThe cGMP-gated current is:\n$$I_{\\text{cGMP}} = g_{\\text{cGMP}}(V_m - E_{\\text{cGMP}})$$\nThe leak current is:\n$$I_L = g_L(V_m - E_L)$$\nSubstituting these into the steady-state condition gives:\n$$g_{\\text{cGMP}}(V_m - E_{\\text{cGMP}}) + g_L(V_m - E_L) = 0$$\nWe can solve this equation for the steady-state membrane potential $V_m$:\n$$g_{\\text{cGMP}}V_m - g_{\\text{cGMP}}E_{\\text{cGMP}} + g_LV_m - g_LE_L = 0$$\n$$(g_{\\text{cGMP}} + g_L)V_m = g_{\\text{cGMP}}E_{\\text{cGMP}} + g_LE_L$$\nThe term $(g_{\\text{cGMP}} + g_L)$ is the total membrane conductance, $g_{\\text{total}}$. Thus, the general expression for the steady-state membrane potential is a weighted average of the reversal potentials:\n$$V_m = \\frac{g_{\\text{cGMP}}E_{\\text{cGMP}} + g_LE_L}{g_{\\text{total}}}$$\n\nWe are given the following values:\nLeak conductance: $g_L = 2\\,\\mathrm{nS}$\nLeak reversal potential: $E_L = -65\\,\\mathrm{mV}$\ncGMP-gated reversal potential: $E_{\\text{cGMP}} = 0\\,\\mathrm{mV}$\nTotal conductance in darkness: $g_{\\text{total,dark}} = 12\\,\\mathrm{nS}$\nTotal conductance in light: $g_{\\text{total,light}} = 7\\,\\mathrm{nS}$\n\nFirst, we calculate the steady-state membrane potential in darkness, $V_{\\text{dark}}$.\nThe cGMP-gated conductance in darkness is $g_{\\text{cGMP,dark}} = g_{\\text{total,dark}} - g_L = 12\\,\\mathrm{nS} - 2\\,\\mathrm{nS} = 10\\,\\mathrm{nS}$.\nUsing the general formula for $V_m$:\n$$V_{\\text{dark}} = \\frac{g_{\\text{cGMP,dark}}E_{\\text{cGMP}} + g_LE_L}{g_{\\text{total,dark}}} = \\frac{(10\\,\\mathrm{nS})(0\\,\\mathrm{mV}) + (2\\,\\mathrm{nS})(-65\\,\\mathrm{mV})}{12\\,\\mathrm{nS}}$$\n$$V_{\\text{dark}} = \\frac{-130\\,\\mathrm{nS} \\cdot \\mathrm{mV}}{12\\,\\mathrm{nS}} = -\\frac{130}{12}\\,\\mathrm{mV} = -\\frac{65}{6}\\,\\mathrm{mV}$$\n\nNext, we calculate the steady-state membrane potential in light, $V_{\\text{light}}$.\nThe cGMP-gated conductance in light is $g_{\\text{cGMP,light}} = g_{\\text{total,light}} - g_L = 7\\,\\mathrm{nS} - 2\\,\\mathrm{nS} = 5\\,\\mathrm{nS}$.\nUsing the general formula for $V_m$:\n$$V_{\\text{light}} = \\frac{g_{\\text{cGMP,light}}E_{\\text{cGMP}} + g_LE_L}{g_{\\text{total,light}}} = \\frac{(5\\,\\mathrm{nS})(0\\,\\mathrm{mV}) + (2\\,\\mathrm{nS})(-65\\,\\mathrm{mV})}{7\\,\\mathrm{nS}}$$\n$$V_{\\text{light}} = \\frac{-130\\,\\mathrm{nS} \\cdot \\mathrm{mV}}{7\\,\\mathrm{nS}} = -\\frac{130}{7}\\,\\mathrm{mV}$$\nNote that the value of the membrane capacitance, $C_m = 20\\,\\mathrm{pF}$, is not required for the calculation of steady-state potentials, as it only influences the transient dynamics.\n\nFinally, we compute the receptor potential, $\\Delta V$, defined as the change in membrane potential due to light: $\\Delta V \\equiv V_{\\text{light}} - V_{\\text{dark}}$.\n$$\\Delta V = \\left(-\\frac{130}{7}\\,\\mathrm{mV}\\right) - \\left(-\\frac{65}{6}\\,\\mathrm{mV}\\right) = -\\frac{130}{7} + \\frac{130}{12}\\,\\mathrm{mV}$$\n$$\\Delta V = 130 \\left(\\frac{1}{12} - \\frac{1}{7}\\right)\\,\\mathrm{mV} = 130 \\left(\\frac{7 - 12}{84}\\right)\\,\\mathrm{mV}$$\n$$\\Delta V = 130 \\left(\\frac{-5}{84}\\right)\\,\\mathrm{mV} = -\\frac{650}{84}\\,\\mathrm{mV} = -\\frac{325}{42}\\,\\mathrm{mV}$$\nNow, we must provide the numeric value rounded to four significant figures.\n$$\\Delta V = -\\frac{325}{42} \\approx -7.7380952... \\,\\mathrm{mV}$$\nRounding to four significant figures yields $-7.738$.", "answer": "$$\\boxed{-7.738}$$", "id": "2607356"}, {"introduction": "Building on the fundamental electrical model, we now delve deeper into the biophysical machinery that converts a physical stimulus into an electrical one. This exercise models the hair cell of the inner ear, a marvel of mechanosensitivity, using the canonical \"gating spring\" framework. You will use small-signal linearization—a powerful and widely applicable analytical technique—to explore how the mechanical properties of the transduction apparatus, such as the stiffness of its molecular springs, shape the cell's electrical and mechanical response to sound [@problem_id:2607313].", "problem": "A single hair cell is modeled by a canonical gating-spring transduction scheme. The hair bundle displacement along its sensitive axis is denoted by $X(t)$, and the bundle is clamped and driven sinusoidally around a resting operating point $X=0$ by an external stimulus $X(t)=A \\sin(\\omega t)$, with amplitude $A$ and angular frequency $\\omega$. The bundle’s passive pivot stiffness is $K_{b}$, and each of the $N$ identical mechanotransduction elements consists of a gating spring of stiffness $k_{g}$ controlling a channel whose opening shortens the spring by the gating swing $d$. The channels are independent and equilibrate rapidly relative to the stimulus period (quasi-static gating). The single-channel current is ohmic with conductance $g_{c}$ and driving force $V_{m}-E_{\\mathrm{rev}}$, where $V_{m}$ is the membrane potential and $E_{\\mathrm{rev}}$ is the reversal potential.\n\nFundamental relations:\n- Hooke’s law for the gating spring gives the mean spring tension $T(X,P_{o})=k_{g}\\left(X-d\\,P_{o}\\right)$, where $P_{o}$ is the open probability.\n- The external force required to hold the bundle at displacement $X$ is $F(X)=K_{b}\\,X+N\\,T(X,P_{o})$.\n- The open probability is given by the Boltzmann distribution based on the gating free-energy difference $\\Delta G$, with\n$$P_{o}=\\frac{1}{1+\\exp\\!\\left(\\frac{\\Delta G}{k_{B}T}\\right)},\\quad \\Delta G=\\Delta G_{0}-T(X,P_{o})\\,d,$$\nwhere $k_{B}$ is the Boltzmann constant and $T$ (on the right-hand side) is absolute temperature.\n\nAt the operating point $X=0$, the resting open probability is $P_{o0}=0.20$ (this sets $\\Delta G_{0}$ implicitly and need not be computed explicitly). Assume small-signal linearization about $X=0$.\n\nParameters for numerical evaluation:\n- $N=50$,\n- $k_{g}=5.0\\times 10^{-4}\\ \\mathrm{N/m}$,\n- $d=5.0\\times 10^{-9}\\ \\mathrm{m}$,\n- $K_{b}=1.0\\times 10^{-4}\\ \\mathrm{N/m}$,\n- $T=300\\ \\mathrm{K}$,\n- Boltzmann constant $k_{B}=1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$,\n- $g_{c}=1.0\\times 10^{-10}\\ \\mathrm{S}$,\n- $V_{m}=-60\\ \\mathrm{mV}$, $E_{\\mathrm{rev}}=0\\ \\mathrm{mV}$ (so the single-channel current is $i_{c}=g_{c}(V_{m}-E_{\\mathrm{rev}})$),\n- stimulus amplitude $A=5.0\\times 10^{-9}\\ \\mathrm{m}$.\n\nTasks:\n1) Starting only from the relations above and first principles of Hooke’s law and the Boltzmann distribution, linearize around $X=0$ to obtain:\n- the first-harmonic (signed) amplitude of the receptor current $I_{1}$ in response to $X(t)=A\\sin(\\omega t)$,\n- the effective linear stiffness $K_{\\mathrm{eff}}=\\left.\\frac{dF}{dX}\\right|_{X=0}$ defining the force-displacement relationship $F(t)\\approx F_{0}+K_{\\mathrm{eff}}\\,A\\sin(\\omega t)$.\n2) Evaluate these quantities numerically for the parameters above.\n\nAnswer specification:\n- Express the final answer as a row matrix $\\begin{pmatrix}I_{1,\\mathrm{amp}}  K_{\\mathrm{eff}}\\end{pmatrix}$, where $I_{1,\\mathrm{amp}}$ is the signed first-harmonic amplitude of the receptor current expressed in picoamperes (pA), and $K_{\\mathrm{eff}}$ is expressed in millinewtons per meter (mN/m).\n- Round both entries to three significant figures.\n- If needed, assume the quasi-static limit so that no additional kinetic time constants appear and the response is in phase with the stimulus.", "solution": "The posed problem is a standard exercise in biophysics, concerning the linearization of a canonical model of hair cell mechanotransduction. It is scientifically grounded, well-posed, and all necessary parameters are provided. Therefore, the problem is valid, and we may proceed with its solution. The notational choice of using $T$ for both tension and absolute temperature is unfortunate but does not create ambiguity when one reads the defining equations with sufficient attention to context.\n\nThe problem asks for two quantities derived from a small-signal linearization of the system around the operating point $X=0$: the first-harmonic amplitude of the receptor current, $I_{1}$, and the effective linear stiffness, $K_{\\mathrm{eff}}$.\n\nFirst, we must determine the sensitivity of the channel open probability $P_o$ to hair bundle displacement $X$. This is the derivative $\\chi = \\left.\\frac{dP_o}{dX}\\right|_{X=0}$. The open probability $P_o$ is given by a Boltzmann distribution, but it depends on the gating spring tension $T(X,P_o)$, which itself depends on $P_o$. This creates a self-consistent relationship.\n\nThe equations are:\n$$P_{o} = \\frac{1}{1+\\exp\\left(\\frac{\\Delta G}{k_{B}T}\\right)}$$\n$$\\Delta G = \\Delta G_{0}-T(X,P_{o})\\,d$$\n$$T(X,P_{o}) = k_{g}\\left(X-d\\,P_{o}\\right)$$\nHere, $T$ in the denominator of the exponential's argument is the absolute temperature, whereas $T(X,P_o)$ is the tension in the gating spring.\n\nSubstituting the expressions for $\\Delta G$ and $T(X,P_o)$ into the equation for $P_o$ yields an implicit equation for $P_o$ as a function of $X$:\n$$P_{o}(X) = \\frac{1}{1+\\exp\\left(\\frac{\\Delta G_0 - k_g d(X - d P_o(X))}{k_B T}\\right)}$$\nTo find $\\chi$, we differentiate this equation with respect to $X$ using the chain rule. Let the argument of the exponential be $Z(X) = \\frac{\\Delta G_0 - k_g d X + k_g d^2 P_o(X)}{k_B T}$.\n$$\\frac{dP_o}{dX} = \\frac{d}{dZ}\\left(\\frac{1}{1+e^Z}\\right) \\frac{dZ}{dX} = - P_o (1 - P_o) \\frac{dZ}{dX}$$\nThe derivative of $Z(X)$ is:\n$$\\frac{dZ}{dX} = \\frac{1}{k_B T} \\left(-k_g d + k_g d^2 \\frac{dP_o}{dX}\\right)$$\nSubstituting this back, we obtain an equation for $\\frac{dP_o}{dX}$:\n$$\\frac{dP_o}{dX} = -P_o(1-P_o) \\frac{1}{k_B T} \\left(-k_g d + k_g d^2 \\frac{dP_o}{dX}\\right)$$\n$$\\frac{dP_o}{dX} = \\frac{P_o(1-P_o)k_g d}{k_B T} - \\frac{P_o(1-P_o)k_g d^2}{k_B T} \\frac{dP_o}{dX}$$\nWe solve for $\\frac{dP_o}{dX}$:\n$$\\frac{dP_o}{dX} \\left(1 + \\frac{P_o(1-P_o)k_g d^2}{k_B T}\\right) = \\frac{P_o(1-P_o)k_g d}{k_B T}$$\nThe sensitivity $\\chi$ is this derivative evaluated at the operating point $X=0$, where $P_o = P_{o0}$:\n$$\\chi = \\left.\\frac{dP_o}{dX}\\right|_{X=0} = \\frac{\\frac{P_{o0}(1-P_{o0})k_g d}{k_B T}}{1 + \\frac{P_{o0}(1-P_{o0})k_g d^2}{k_B T}}$$\n\nWith this sensitivity $\\chi$, we can find the requested quantities.\n\n1) First-harmonic receptor current amplitude, $I_1$:\nThe total receptor current is $I(t) = N i_c P_o(X(t))$, where $i_c = g_c(V_m - E_{\\mathrm{rev}})$ is the constant single-channel current. For a small sinusoidal stimulus $X(t) = A\\sin(\\omega t)$, we linearize $P_o(X(t))$ around $X=0$:\n$$P_o(X(t)) \\approx P_{o0} + \\chi X(t) = P_{o0} + \\chi A \\sin(\\omega t)$$\nThe current is then:\n$$I(t) \\approx N i_c (P_{o0} + \\chi A \\sin(\\omega t)) = N i_c P_{o0} + N i_c \\chi A \\sin(\\omega t)$$\nThe first term is the DC component. The second term is the first harmonic, whose signed amplitude is:\n$$I_{1,\\mathrm{amp}} = N i_c \\chi A = N g_c (V_m - E_{\\mathrm{rev}}) A \\chi$$\n\n2) Effective linear stiffness, $K_{\\mathrm{eff}}$:\nThe external force required to hold the bundle at displacement $X$ is $F(X)=K_{b}\\,X+N\\,T(X,P_{o}(X))$. Substituting $T(X,P_o) = k_g(X - d P_o(X))$, we have:\n$$F(X) = K_{b}\\,X+N k_g (X - d P_o(X))$$\nThe effective stiffness is the derivative of this force with respect to displacement, evaluated at the operating point $X=0$:\n$$K_{\\mathrm{eff}} = \\left.\\frac{dF}{dX}\\right|_{X=0} = K_b + N k_g \\left(1 - d \\left.\\frac{dP_o}{dX}\\right|_{X=0}\\right) = K_b + N k_g (1 - d\\chi)$$\nSubstituting the expression for $\\chi$ and simplifying:\n$$K_{\\mathrm{eff}} = K_b + N k_g \\left(1 - d \\frac{\\frac{P_{o0}(1-P_{o0})k_g d}{k_B T}}{1 + \\frac{P_{o0}(1-P_{o0})k_g d^2}{k_B T}}\\right) = K_b + N k_g \\left(1 - \\frac{\\frac{P_{o0}(1-P_{o0})k_g d^2}{k_B T}}{1 + \\frac{P_{o0}(1-P_{o0})k_g d^2}{k_B T}}\\right)$$\nLetting $C = \\frac{P_{o0}(1-P_{o0})k_g d^2}{k_B T}$, the expression becomes:\n$$K_{\\mathrm{eff}} = K_b + N k_g \\left(\\frac{1+C-C}{1+C}\\right) = K_b + \\frac{N k_g}{1 + \\frac{P_{o0}(1-P_{o0})k_g d^2}{k_B T}}$$\n\nNow, we evaluate these quantities numerically with the given parameters:\n- $N=50$\n- $k_{g}=5.0\\times 10^{-4}\\ \\mathrm{N/m}$\n- $d=5.0\\times 10^{-9}\\ \\mathrm{m}$\n- $K_{b}=1.0\\times 10^{-4}\\ \\mathrm{N/m}$\n- $T=300\\ \\mathrm{K}$\n- $k_{B}=1.380649\\times 10^{-23}\\ \\mathrm{J/K}$\n- $g_{c}=1.0\\times 10^{-10}\\ \\mathrm{S}$\n- $V_{m}=-60\\ \\mathrm{mV} = -0.060\\ \\mathrm{V}$, $E_{\\mathrm{rev}}=0\\ \\mathrm{mV} = 0\\ \\mathrm{V}$\n- $A=5.0\\times 10^{-9}\\ \\mathrm{m}$\n- $P_{o0}=0.20$\n\nFirst, calculate the thermal energy: $k_B T = (1.380649\\times 10^{-23}\\ \\mathrm{J/K}) \\times (300\\ \\mathrm{K}) \\approx 4.1419 \\times 10^{-21}\\ \\mathrm{J}$.\nNext, the term $P_{o0}(1-P_{o0}) = 0.20 \\times (1-0.20) = 0.16$.\nThe dimensionless energy ratio is $\\frac{k_g d^2}{k_B T} = \\frac{(5.0\\times 10^{-4}\\ \\mathrm{N/m}) (5.0\\times 10^{-9}\\ \\mathrm{m})^2}{4.1419 \\times 10^{-21}\\ \\mathrm{J}} \\approx 3.018$.\nThe factor appearing in the denominators is $1 + P_{o0}(1-P_{o0})\\frac{k_g d^2}{k_B T} \\approx 1 + 0.16 \\times 3.018 \\approx 1.4829$.\n\nNow calculate the sensitivity $\\chi$:\n$$\\chi = \\frac{P_{o0}(1-P_{o0})\\frac{k_g d}{k_B T}}{1 + P_{o0}(1-P_{o0})\\frac{k_g d^2}{k_B T}} = \\frac{0.16 \\times \\frac{(5.0\\times 10^{-4}\\ \\mathrm{N/m})(5.0\\times 10^{-9}\\ \\mathrm{m})}{4.1419 \\times 10^{-21}\\ \\mathrm{J}}}{1.4829} \\approx \\frac{0.16 \\times 6.0358 \\times 10^8\\ \\mathrm{m}^{-1}}{1.4829} \\approx 6.512 \\times 10^7\\ \\mathrm{m}^{-1}$$\n\nCalculate the current amplitude $I_{1,\\mathrm{amp}}$:\nSingle-channel current $i_c = g_c(V_m - E_{\\mathrm{rev}}) = (1.0 \\times 10^{-10}\\ \\mathrm{S})(-0.060\\ \\mathrm{V}) = -6.0 \\times 10^{-12}\\ \\mathrm{A}$.\n$$I_{1,\\mathrm{amp}} = N i_c \\chi A = 50 \\times (-6.0 \\times 10^{-12}\\ \\mathrm{A}) \\times (6.512 \\times 10^7\\ \\mathrm{m}^{-1}) \\times (5.0 \\times 10^{-9}\\ \\mathrm{m})$$\n$$I_{1,\\mathrm{amp}} \\approx -9.768 \\times 10^{-11}\\ \\mathrm{A} = -97.68\\ \\mathrm{pA}$$\nRounding to three significant figures, $I_{1,\\mathrm{amp}} = -97.7\\ \\mathrm{pA}$.\n\nCalculate the effective stiffness $K_{\\mathrm{eff}}$:\n$$K_{\\mathrm{eff}} = K_b + \\frac{N k_g}{1 + P_{o0}(1-P_{o0})\\frac{k_g d^2}{k_B T}} \\approx 1.0\\times 10^{-4}\\ \\mathrm{N/m} + \\frac{50 \\times 5.0\\times 10^{-4}\\ \\mathrm{N/m}}{1.4829}$$\n$$K_{\\mathrm{eff}} \\approx 1.0\\times 10^{-4}\\ \\mathrm{N/m} + \\frac{2.5\\times 10^{-2}\\ \\mathrm{N/m}}{1.4829} \\approx 1.0\\times 10^{-4} + 0.016859\\ \\mathrm{N/m}$$\n$$K_{\\mathrm{eff}} \\approx 0.016959\\ \\mathrm{N/m} = 16.959\\ \\mathrm{mN/m}$$\nRounding to three significant figures, $K_{\\mathrm{eff}} = 17.0\\ \\mathrm{mN/m}$.\n\nThe final requested values are $I_{1,\\mathrm{amp}} = -97.7$ pA and $K_{\\mathrm{eff}} = 17.0$ mN/m.", "answer": "$$\\boxed{\\begin{pmatrix}-97.7  17.0\\end{pmatrix}}$$", "id": "2607313"}, {"introduction": "Our final practice bridges the gap between single-cell biophysics and systems-level neural coding, exploring how the physical limits of transduction constrain perception. This computational task focuses on the auditory system, where the timing of neural spikes encodes information about sound localization through interaural time differences (ITDs). By simulating spike trains and analyzing their phase-locking precision, you will determine the upper frequency limit at which this neural code can operate, grappling with the fundamental trade-offs between temporal precision and phase ambiguity that all sensory systems face [@problem_id:2607305].", "problem": "You are given a principled modeling task grounded in auditory sensory transduction. A spike train is recorded from a phase-locking auditory fiber responding to a pure tone at frequency $f$ (in Hz). For each frequency, spikes are recorded over multiple stimulus cycles. Your goal is to compute the synchronization (vector strength) from the spike times, convert it to a circular phase-noise estimate, and then predict the largest carrier frequency at which fine-structure interaural time difference (ITD) detection remains supported by phase locking, subject to both precision and phase-ambiguity limits.\n\nUse the following foundational definitions and well-tested relations.\n\n1. Phase extraction from spike times: For a given frequency $f$ and spike time $t_k$ (in s), define the spike phase by $\\theta_k = \\operatorname{mod}(2\\pi f t_k, 2\\pi)$ in radians.\n\n2. Vector strength (synchronization index): Given $N$ spikes with phases $\\{\\theta_k\\}_{k=1}^N$, the vector strength is\n$$\nR(f) = \\left|\\frac{1}{N}\\sum_{k=1}^{N} e^{i \\theta_k}\\right|.\n$$\n\n3. Phase noise under a wrapped normal approximation: If the phase jitter is approximately wrapped normal with circular standard deviation $\\sigma_\\phi(f)$ (in radians), then the resultant length satisfies the relation\n$$\nR(f) \\approx e^{-\\sigma_\\phi(f)^2/2},\n$$\nso that\n$$\n\\sigma_\\phi(f) = \\sqrt{-2 \\ln(R(f))}.\n$$\n\n4. Discriminability of an interaural time difference: Under a Gaussian-noise approximation, the discriminability index $d'$ for a phase difference $\\Delta \\phi$ is $d' = \\Delta\\phi / \\sigma_\\phi$. For a two-alternative forced choice with standard criterion, require\n$$\nd' \\ge 1 \\quad \\Longleftrightarrow \\quad \\frac{2\\pi f \\Delta t}{\\sigma_\\phi(f)} \\ge 1,\n$$\nwhere $\\Delta t$ is the interaural time difference (in s).\n\n5. Phase-ambiguity (aliasing) constraint for fine-structure ITD: To avoid $2\\pi$ phase wrap ambiguity for a single-frequency code, require\n$$\n|2\\pi f \\Delta t| \\le \\pi \\quad \\Longleftrightarrow \\quad f \\le \\frac{1}{2\\Delta t}.\n$$\n\nA frequency $f$ is deemed to support fine-structure ITD detection if both the precision constraint and the phase-ambiguity constraint hold.\n\nYou are to implement a program that, for each test case, does the following:\n- Generates spike times for each tested frequency from specified von Mises phase distributions (unitless concentration parameter $\\kappa$), over a fixed number of stimulus cycles and spikes per cycle, using a fixed random seed.\n- Computes $R(f)$ from the spike times via the definition above.\n- Computes $\\sigma_\\phi(f)$ from $R(f)$ using $\\sigma_\\phi(f) = \\sqrt{-2\\ln R(f)}$.\n- Determines which frequencies satisfy both $2\\pi f \\Delta t / \\sigma_\\phi(f) \\ge 1$ and $f \\le 1/(2\\Delta t)$.\n- Predicts the upper frequency limit as the largest tested frequency satisfying both conditions. If none satisfies, return $0$. If all satisfy up to the largest tested frequency $f_c$, return $f_c$.\n\nSpike-time generation protocol for a given frequency $f$:\n- For each cycle index $n \\in \\{0, 1, \\dots, M-1\\}$ (where $M$ is the number of cycles), and for each spike per cycle, independently draw a raw phase sample $\\psi$ from a von Mises distribution with mean $0$ and concentration $\\kappa(f)$ (radians).\n- Map $\\psi$ into $[0, 2\\pi)$ via $\\theta = \\operatorname{mod}(\\psi, 2\\pi)$.\n- Set spike time $t = \\frac{n}{f} + \\frac{\\theta}{2\\pi f}$ in seconds. All phases are in radians; all times are in seconds; all frequencies are in Hz.\n\nAngle unit requirement: All angles must be treated in radians.\n\nUnit requirement: The final frequency answers must be expressed in Hz as integers.\n\nTest suite. For every test case, use the same set of tested frequencies\n$$\n\\mathcal{F} = [\\,100,\\,200,\\,300,\\,400,\\,500,\\,600,\\,700,\\,800,\\,900,\\,1000\\,],\n$$\nso that $f_c = 1000$ Hz. Use $M = 400$ cycles, $1$ spike per cycle, and $\\Delta t = 0.0006$ s. For von Mises sampling, use the specified random seed and the concentration function $\\kappa(f)$ for each test case below.\n\n- Test case $1$ (happy path, decreasing locking): seed $= 123$, $\\kappa(f) = 20 \\cdot e^{-f/800}$.\n- Test case $2$ (near-perfect locking within ambiguity): seed $= 456$, $\\kappa(f) = 150$.\n- Test case $3$ (weak locking): seed $= 789$, $\\kappa(f) = 0.5$.\n- Test case $4$ (nonmonotonic locking): seed $= 321$, $\\kappa(f) = 0.8 + 15 \\cdot \\exp\\!\\big(-(f-400)^2/(2 \\cdot 150^2)\\big)$.\n\nNumerical cautions:\n- When computing $\\ln(R)$, clip $R$ away from $0$ by replacing $R$ with $\\max(R, 10^{-12})$.\n- If $\\sigma_\\phi(f) = 0$, treat the precision constraint as satisfied for that $f$.\n\nFinal output specification:\n- Your program should produce a single line containing the predicted upper frequency (in Hz) for each test case as a comma-separated list of integers enclosed in square brackets, in the order of the four test cases defined above (for example, $[800,800,0,800]$).", "solution": "The problem is well-posed, scientifically grounded, and objective. It presents a computational modeling task based on established principles of auditory sensory transduction. All necessary data, models, and constraints are provided. The problem is valid. I will proceed with a solution.\n\nThe objective is to determine the maximum frequency, $f_{max}$, from a given set of test frequencies $\\mathcal{F}$, at which a model auditory neuron can support the detection of interaural time differences (ITDs). A frequency $f \\in \\mathcal{F}$ is considered to support ITD detection if it satisfies two conditions simultaneously: a precision constraint and a phase-ambiguity constraint.\n\nThe procedure for each test case involves the following steps:\n1.  For each frequency $f$ in the set $\\mathcal{F} = [100, 200, \\dots, 1000]$ Hz, generate a synthetic spike train.\n2.  From the spike train, compute the vector strength $R(f)$, which quantifies the degree of phase-locking to the stimulus.\n3.  Estimate the standard deviation of the phase noise, $\\sigma_\\phi(f)$, from the vector strength $R(f)$.\n4.  Check if the frequency $f$ satisfies both the precision and phase-ambiguity constraints.\n5.  The final result for the test case is the largest frequency in $\\mathcal{F}$ that satisfies both constraints. If no frequency is valid, the result is $0$.\n\nLet us detail each step.\n\n**Step 1: Spike Phase Generation**\nFor a given frequency $f$, we are to generate $N$ spikes. The problem specifies $M = 400$ stimulus cycles with $1$ spike per cycle, so the total number of spikes is $N=M \\times 1 = 400$. The spike times are not explicitly needed for the calculation of vector strength, as the phase $\\theta_k$ can be generated directly.\nThe protocol is to draw $N$ independent samples, $\\psi_k$, from a von Mises distribution with a mean direction of $\\mu=0$ radians and a frequency-dependent concentration parameter $\\kappa(f)$. The von Mises distribution is a circular analogue of the normal distribution and is defined by the probability density function:\n$$\np(\\psi | \\mu, \\kappa) = \\frac{e^{\\kappa \\cos(\\psi - \\mu)}}{2\\pi I_0(\\kappa)}\n$$\nwhere $I_0(\\kappa)$ is the modified Bessel function of the first kind of order $0$. For our case, $\\mu=0$.\nThe raw phase samples $\\psi_k$ are drawn from this distribution. These samples typically fall in the range $[-\\pi, \\pi)$. They are then mapped to the interval $[0, 2\\pi)$ to represent the spike phase $\\theta_k$ within a single cycle:\n$$\n\\theta_k = \\operatorname{mod}(\\psi_k, 2\\pi)\n$$\nThis constitutes the set of $N=400$ spike phases $\\{\\theta_k\\}_{k=1}^N$ used for the subsequent analysis at frequency $f$.\n\n**Step 2: Vector Strength Calculation**\nThe vector strength, $R(f)$, measures the synchronization of the spikes to the stimulus cycle. It is calculated as the magnitude of the mean of the phase vectors $e^{i\\theta_k}$ in the complex plane. Given the $N$ spike phases $\\{\\theta_k\\}$, the formula is:\n$$\nR(f) = \\left|\\frac{1}{N}\\sum_{k=1}^{N} e^{i \\theta_k}\\right|\n$$\nA value of $R(f) = 1$ indicates perfect phase-locking (all spikes occur at the same phase), while $R(f) = 0$ indicates a complete lack of synchronization (phases are uniformly distributed).\n\n**Step 3: Phase Noise Estimation**\nThe vector strength $R(f)$ is related to the circular standard deviation of the phase jitter, $\\sigma_\\phi(f)$, under the assumption that the phase distribution can be approximated by a wrapped normal distribution. The given relation is:\n$$\nR(f) \\approx e^{-\\sigma_\\phi(f)^2/2}\n$$\nInverting this to solve for $\\sigma_\\phi(f)$ gives:\n$$\n\\sigma_\\phi(f) = \\sqrt{-2 \\ln(R(f))}\n$$\nTo handle the case where random sampling might yield $R(f)=0$, which would make the logarithm undefined, we apply a numerical clip as specified: we compute $\\ln(\\max(R(f), 10^{-12}))$.\n\n**Step 4: Checking the Constraints**\nFor a frequency $f$ to be considered valid for fine-structure ITD detection, it must satisfy two constraints using the given interaural time difference $\\Delta t = 0.0006$ s.\n\n*   **Phase-Ambiguity Constraint**: The total phase difference corresponding to the ITD, $\\Delta \\phi = 2\\pi f \\Delta t$, must not exceed half a cycle ($\\pi$ radians) to avoid confusing a small ITD with a large one.\n    $$\n    |2\\pi f \\Delta t| \\le \\pi \\implies f \\le \\frac{1}{2\\Delta t}\n    $$\n    With $\\Delta t = 0.0006$ s, the upper frequency limit due to ambiguity is:\n    $$\n    f_{ambiguity} = \\frac{1}{2 \\times 0.0006 \\text{ s}} = \\frac{1}{0.0012 \\text{ s}} \\approx 833.33 \\text{ Hz}\n    $$\n    Therefore, any frequency $f  833.33$ Hz is invalid. In our test set $\\mathcal{F}$, this immediately disqualifies $f=900$ Hz and $f=1000$ Hz.\n\n*   **Precision Constraint**: The phase difference $\\Delta \\phi = 2\\pi f \\Delta t$ must be discriminable from zero phase difference, given the neuron's phase noise $\\sigma_\\phi(f)$. The discriminability index $d'$ is required to be at least $1$:\n    $$\n    d' = \\frac{\\Delta\\phi}{\\sigma_\\phi(f)} = \\frac{2\\pi f \\Delta t}{\\sigma_\\phi(f)} \\ge 1\n    $$\n    If sampling results in perfect locking, such that $R(f)=1$, then $\\sigma_\\phi(f) = 0$. In this special case, the precision is infinite, and the constraint is considered satisfied.\n\n**Step 5: Final Determination of the Upper Frequency Limit**\nFor each test case, we iterate through the frequencies $f \\in \\{100, 200, \\dots, 1000\\}$. For each $f$, we generate spike phases, compute $R(f)$ and $\\sigma_\\phi(f)$, and check if both the ambiguity and precision constraints are met. We build a list of all such valid frequencies. The final answer for the test case is the maximum value in this list. If the list is empty (no frequency satisfies both conditions), the answer is $0$.\n\nThis entire procedure is implemented for each of the four specified test cases, each defined by a unique random seed and a function for $\\kappa(f)$:\n1.  `seed = 123`, $\\kappa(f) = 20 \\cdot e^{-f/800}$\n2.  `seed = 456`, $\\kappa(f) = 150$\n3.  `seed = 789`, $\\kappa(f) = 0.5$\n4.  `seed = 321`, $\\kappa(f) = 0.8 + 15 \\cdot \\exp\\!\\big(-(f-400)^2/(2 \\cdot 150^2)\\big)$\n\nThe implementation will now proceed to execute this logic.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the auditory sensory transduction problem by finding the upper frequency limit\n    for ITD detection based on phase-locking constraints for four different test cases.\n    \"\"\"\n\n    # --- Global Parameters ---\n    # Tested frequencies in Hz\n    test_frequencies = np.arange(100, 1001, 100)\n    # Number of stimulus cycles\n    M = 400\n    # Spikes per cycle\n    spikes_per_cycle = 1\n    # Total number of spikes\n    N = M * spikes_per_cycle\n    # Interaural time difference in seconds\n    delta_t = 0.0006\n    # Logarithm floor for numerical stability\n    R_CLIP = 1e-12\n\n    # --- Constraint Calculation ---\n    # Phase-ambiguity frequency limit\n    f_ambiguity_limit = 1 / (2 * delta_t)\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"seed\": 123,\n            \"kappa_func\": lambda f: 20 * np.exp(-f / 800),\n            \"name\": \"Decreasing locking\"\n        },\n        {\n            \"seed\": 456,\n            \"kappa_func\": lambda f: 150,\n            \"name\": \"Near-perfect locking\"\n        },\n        {\n            \"seed\": 789,\n            \"kappa_func\": lambda f: 0.5,\n            \"name\": \"Weak locking\"\n        },\n        {\n            \"seed\": 321,\n            \"kappa_func\": lambda f: 0.8 + 15 * np.exp(-(f - 400)**2 / (2 * 150**2)),\n            \"name\": \"Nonmonotonic locking\"\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Set the random seed for reproducibility\n        np.random.seed(case[\"seed\"])\n        kappa_func = case[\"kappa_func\"]\n        \n        valid_frequencies = []\n\n        for f in test_frequencies:\n            # --- Step 1: Spike Phase Generation ---\n            # Get concentration parameter for the current frequency\n            kappa = kappa_func(f)\n            \n            # Draw raw phase samples from von Mises distribution (mean=0, concentration=kappa)\n            # np.random.vonmises output is in [-pi, pi]\n            raw_phases = np.random.vonmises(mu=0, kappa=kappa, size=N)\n            \n            # Map phases to [0, 2*pi) as per problem spec\n            phases = np.mod(raw_phases, 2 * np.pi)\n\n            # --- Step 2: Vector Strength Calculation ---\n            # Convert phases to complex numbers and compute the mean vector\n            mean_vector = np.mean(np.exp(1j * phases))\n            # The vector strength R is the magnitude of the mean vector\n            R = np.abs(mean_vector)\n\n            # --- Step 3: Phase Noise Estimation ---\n            # Handle R=1 case which leads to log(0)\n            if R >= 1.0: # Account for potential float inaccuracies\n                sigma_phi = 0.0\n            else:\n                # Clip R away from 0 for numerical stability of log\n                R_clipped = np.maximum(R, R_CLIP)\n                sigma_phi = np.sqrt(-2 * np.log(R_clipped))\n\n            # --- Step 4: Check Constraints ---\n            # Constraint 1: Phase-ambiguity\n            ambiguity_constraint_satisfied = (f = f_ambiguity_limit)\n            \n            # Constraint 2: Precision\n            if sigma_phi == 0:\n                # Infinite precision, constraint is satisfied\n                precision_constraint_satisfied = True\n            else:\n                d_prime = (2 * np.pi * f * delta_t) / sigma_phi\n                precision_constraint_satisfied = (d_prime >= 1)\n\n            # --- Final check ---\n            if ambiguity_constraint_satisfied and precision_constraint_satisfied:\n                valid_frequencies.append(f)\n\n        # --- Step 5: Determine Upper Frequency Limit ---\n        if not valid_frequencies:\n            upper_limit = 0\n        else:\n            upper_limit = max(valid_frequencies)\n            \n        results.append(int(upper_limit))\n\n    # --- Final Output ---\n    # Format the output as a comma-separated list of integers in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2607305"}]}