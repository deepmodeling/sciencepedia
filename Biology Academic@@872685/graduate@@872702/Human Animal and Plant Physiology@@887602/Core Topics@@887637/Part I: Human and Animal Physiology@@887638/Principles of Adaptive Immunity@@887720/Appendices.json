{"hands_on_practices": [{"introduction": "The adaptive immune system's power relies on its ability to distinguish self from non-self. This fundamental capability is established in the thymus, where developing T cells undergo a stringent selection process. This practice [@problem_id:2600008] invites you to build a quantitative model of this critical checkpoint, translating the biological rules of positive and negative selection into the language of probability. By calculating a thymocyte's chance of survival based on its binding affinities to self-antigens, you will gain a deeper appreciation for how the immune system filters a vast random repertoire into a smaller set of cells that are both useful and safe.", "problem": "A thymocyte bearing a single T cell receptor (TCR) is screened in the thymic cortex against self peptide–Major Histocompatibility Complex (MHC) ligands. Adopt the following biologically grounded rules: positive selection occurs if the TCR binds at least one encountered self peptide–MHC with a binding free energy in a “moderate” window, and negative selection (clonal deletion) occurs if the TCR binds any encountered peptide–MHC more strongly than a stricter “strong-binding” threshold. Model binding free energies so that smaller energy corresponds to stronger binding. Let the negative selection threshold be $E_{n}$ and the positive selection threshold be $E_{p}$, with $E_{n} < E_{p}$.\n\nConsider a pool of $N$ distinct self peptides. For this thymocyte, the $N$ peptide–MHC binding free energies are fixed numbers $\\{E_{1},\\dots,E_{N}\\}$. Exactly $n_{s}$ of these satisfy $E_{i} \\leq E_{n}$ (strong binders that trigger negative selection), exactly $n_{m}$ satisfy $E_{n} < E_{i} \\leq E_{p}$ (moderate binders that can mediate positive selection without negative selection), and the remaining $N - n_{s} - n_{m}$ satisfy $E_{i} > E_{p}$ (too weak to signal).\n\nDuring cortical scanning, the thymocyte makes $m$ independent encounters with peptide–MHC selected uniformly at random with replacement from the pool of $N$ self peptides. The thymocyte will pass positive selection but not negative selection if and only if, over these $m$ encounters, it sees at least one moderate binder and sees no strong binders.\n\nUsing only core probability rules (independence of trials and the complement rule) and the above definitions of selection thresholds, compute the probability that the thymocyte passes positive selection but not negative selection for the following values: $N = 10000$, $n_{s} = 12$, $n_{m} = 180$, and $m = 300$. Express your final result as a decimal rounded to four significant figures (no percent sign).", "solution": "The problem as stated is subjected to validation before any solution is attempted.\n\nStep 1: Extracted Givens.\n- A thymocyte with a single T cell receptor (TCR) is screened against a pool of $N$ distinct self peptide–Major Histocompatibility Complex (pMHC) ligands.\n- Binding free energies are denoted as $\\{E_{1}, \\dots, E_{N}\\}$, where smaller energy implies stronger binding.\n- Negative selection threshold is $E_{n}$.\n- Positive selection threshold is $E_{p}$, with the condition $E_{n} < E_{p}$.\n- The number of strong-binding peptides is $n_{s}$, defined by $E_{i} \\leq E_{n}$.\n- The number of moderate-binding peptides is $n_{m}$, defined by $E_{n} < E_{i} \\leq E_{p}$.\n- The number of weak-binding peptides is $N - n_{s} - n_{m}$, defined by $E_{i} > E_{p}$.\n- The thymocyte undergoes $m$ independent encounters, with pMHC selected uniformly at random with replacement from the pool of $N$.\n- Condition for a successful outcome (survival): The thymocyte must encounter at least one moderate binder AND no strong binders over the course of the $m$ encounters.\n- Numerical values provided: $N = 10000$, $n_{s} = 12$, $n_{m} = 180$, and $m = 300$.\n- The final result must be a decimal rounded to four significant figures.\n\nStep 2: Validation Using Extracted Givens.\n- **Scientifically Grounded**: The problem presents a simplified mathematical model of thymic selection, a core concept in immunology. The use of binding energy thresholds and probabilistic encounters is a standard and valid approach in quantitative biology. The model is an abstraction but is founded on established scientific principles. It is not pseudoscientific.\n- **Well-Posed**: The problem is well-defined. All variables are specified, the probabilistic framework (sampling with replacement, independent trials) is clear, and the event whose probability is to be calculated is described without ambiguity. A unique numerical solution exists.\n- **Objective**: The problem is stated in objective, mathematical language.\n- The problem is self-contained, consistent, and scientifically formalizable. It does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A solution will be furnished.\n\nThe task is to calculate the probability of an event derived from a sequence of $m$ independent trials. In each trial, a peptide-MHC complex is drawn uniformly at random with replacement from a pool of $N$ peptides. The pool is categorized into three disjoint sets: strong binders, moderate binders, and weak binders.\n\nLet us define the probabilities for a single random encounter:\n- The probability of encountering a strong binder, $p_s$, is the ratio of the number of strong binders to the total number of peptides:\n$$p_s = \\frac{n_s}{N}$$\n- The probability of encountering a moderate binder, $p_m$, is:\n$$p_m = \\frac{n_m}{N}$$\n- The probability of encountering a weak binder, $p_w$, is:\n$$p_w = \\frac{N - n_s - n_m}{N}$$\nThese three events are mutually exclusive and exhaustive for a single encounter, so $p_s + p_m + p_w = 1$.\n\nThe condition for the thymocyte to survive is that over the $m$ encounters, two conditions must be met simultaneously:\n1. Event $A$: No strong binders are encountered.\n2. Event $B$: At least one moderate binder is encountered.\n\nWe must compute the probability of the intersection of these two events, $P(A \\cap B)$.\nIt is often simpler to work with complementary events. Let us use the law of total probability, which states $P(A) = P(A \\cap B) + P(A \\cap B^c)$, where $B^c$ is the complement of event $B$. Rearranging gives:\n$$P(A \\cap B) = P(A) - P(A \\cap B^c)$$\n\nLet us analyze each term:\nEvent $A$ is \"no strong binders are encountered in $m$ trials\". This means that for each of the $m$ independent trials, the outcome must not be a strong binder. The probability of a single trial not being a strong binder is $1 - p_s = p_m + p_w = \\frac{N - n_s}{N}$. Since the trials are independent, the probability of this happening for all $m$ trials is:\n$$P(A) = \\left(1 - p_s\\right)^m = \\left(\\frac{N - n_s}{N}\\right)^m$$\n\nEvent $B^c$ is the complement of event $B$, meaning \"no moderate binders are encountered in $m$ trials\".\nThe event $A \\cap B^c$ is \"no strong binders are encountered in $m$ trials AND no moderate binders are encountered in $m$ trials\". This is equivalent to the event that all $m$ encounters must be with weak binders. The probability of encountering a weak binder in a single trial is $p_w$. As trials are independent, the probability of this occurring for all $m$ trials is:\n$$P(A \\cap B^c) = (p_w)^m = \\left(\\frac{N - n_s - n_m}{N}\\right)^m$$\n\nNow, we can substitute these results back into our expression for the desired probability, $P(\\text{survival}) = P(A \\cap B)$:\n$$P(\\text{survival}) = P(A) - P(A \\cap B^c) = \\left(\\frac{N - n_s}{N}\\right)^m - \\left(\\frac{N - n_s - n_m}{N}\\right)^m$$\n\nWe are given the numerical values: $N = 10000$, $n_s = 12$, $n_m = 180$, and $m = 300$.\nLet's substitute these values into the formula.\nFirst, calculate the bases of the exponents:\n- The base for the first term is $\\frac{N - n_s}{N} = \\frac{10000 - 12}{10000} = \\frac{9988}{10000} = 0.9988$.\n- The base for the second term is $\\frac{N - n_s - n_m}{N} = \\frac{10000 - 12 - 180}{10000} = \\frac{9808}{10000} = 0.9808$.\n\nThe probability is then:\n$$P(\\text{survival}) = (0.9988)^{300} - (0.9808)^{300}$$\n\nNow, we compute the numerical values of these terms.\n$(0.9988)^{300} \\approx 0.697529366$\n$(0.9808)^{300} \\approx 0.002981358$\n\nThe final probability is the difference between these two values:\n$$P(\\text{survival}) \\approx 0.697529366 - 0.002981358 = 0.694548008$$\n\nThe problem requires the result to be rounded to four significant figures.\nThe calculated probability is $0.694548008...$. The first four significant figures are $6$, $9$, $4$, and $5$. The fifth significant figure is $4$, which is less than $5$, so we round down.\nThe final result is $0.6945$.", "answer": "$$\\boxed{0.6945}$$", "id": "2600008"}, {"introduction": "Once a T cell is activated by a foreign antigen, it must proliferate rapidly to generate an army of clones capable of clearing the infection. This process, known as clonal expansion, is a dramatic example of population dynamics at the cellular level. This exercise [@problem_id:2600015] models this phenomenon as a branching process, where each cell's fate is governed by probabilities of division, death, or quiescence. By deriving the expected size of the expanding clone from first principles, you will develop a foundational understanding of the quantitative laws that govern the magnitude and kinetics of an adaptive immune response.", "problem": "In the clonal expansion of antigen-specific T lymphocytes during the adaptive immune response, Interleukin-2 (IL-2) limited signaling constrains per-cell proliferation and survival. Consider a single antigen-specific clone evolving over discrete cell cycles in a well-mixed environment with fixed Interleukin-2 (IL-2) availability over the time window of interest. Model each cycle as follows for each cell present at the beginning of the cycle:\n- with probability $p$, the cell completes a division within the cycle and yields $2$ viable daughter cells by the start of the next cycle;\n- with probability $d$, the cell undergoes apoptosis within the cycle and yields $0$ cells by the start of the next cycle;\n- with probability $1 - p - d$, the cell neither divides nor dies within the cycle and yields $1$ viable cell by the start of the next cycle.\n\nAssume $0 \\leq p \\leq 1$, $0 \\leq d \\leq 1$, and $p + d \\leq 1$. Assume independence of these outcomes across cells and cycles, conditional on the fixed IL-2 environment. Let $N_0$ denote the initial size of the clone at cycle $0$, and let $N_n$ denote the clone size after $n$ complete cycles.\n\nStarting from fundamental definitions of expectation and independence in branching processes and without invoking any pre-derived growth formulas, derive a closed-form expression for the expected clone size $\\mathbb{E}[N_n]$ in terms of $N_0$, $p$, $d$, and $n$. In your derivation, make explicit how the dependence on the difference $p - d$ emerges from the per-cell outcomes under IL-2 limitation. Provide your final result as a single closed-form analytical expression in terms of $N_0$, $p$, $d$, and $n$. Do not approximate or round.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim as follows:\n- A single antigen-specific clone evolves over discrete cell cycles.\n- The environment has a fixed Interleukin-2 (IL-2) availability.\n- For each cell at the beginning of a cycle:\n    - with probability $p$, it divides, yielding $2$ daughter cells.\n    - with probability $d$, it undergoes apoptosis, yielding $0$ cells.\n    - with probability $1 - p - d$, it neither divides nor dies, yielding $1$ cell.\n- Constraints: $0 \\leq p \\leq 1$, $0 \\leq d \\leq 1$, and $p + d \\leq 1$.\n- Outcomes are independent across cells and cycles.\n- $N_0$ is the initial clone size at cycle $0$.\n- $N_n$ is the clone size after $n$ complete cycles.\n- The task is to derive a closed-form expression for the expected clone size $\\mathbb{E}[N_n]$ from fundamental principles.\n\nValidation against criteria:\n- **Scientific Grounding**: The model is a simplified but standard representation of lymphocyte population dynamics (a branching process), grounded in the established principles of immunology concerning clonal expansion, IL-2 signaling, cell division, and apoptosis. It is scientifically sound as a modeling exercise.\n- **Well-Posed**: The problem is well-posed. It provides all necessary parameters ($N_0$, $p$, $d$, $n$) and a clear probabilistic structure. The objective—to find the expected value $\\mathbb{E}[N_n]$—is a mathematically precise and solvable task.\n- **Objective**: The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n\nThe problem contains no scientific or factual unsoundness, is formalizable, complete, and internally consistent. It is a standard problem in stochastic processes applied to biology and is not trivial. Therefore, the problem is declared valid.\n\nThe derivation proceeds from the fundamental definition of expected value and the properties of conditional expectation. Let $N_n$ be the random variable for the number of cells in the clone at the end of cycle $n$. The initial population size, $N_0$, is a given constant.\n\nThe number of cells at cycle $n$, $N_n$, is the sum of the offspring from the $N_{n-1}$ cells present at the start of that cycle. Let $X_i$ be the random variable representing the number of daughter cells produced by the $i$-th cell during a single cycle. The probability distribution of $X_i$ is given as:\n$$\nP(X_i = 2) = p \\\\\nP(X_i = 0) = d \\\\\nP(X_i = 1) = 1 - p - d\n$$\nBecause the fates of all cells are independent, all $X_i$ are independent and identically distributed (i.i.d.).\n\nThe total population at cycle $n$ can be expressed as the sum of offspring from the population at cycle $n-1$:\n$$\nN_n = \\sum_{i=1}^{N_{n-1}} X_i^{(n-1)}\n$$\nwhere $X_i^{(n-1)}$ denotes the number of offspring from cell $i$ existing at the beginning of cycle $n$.\n\nTo find the expected value $\\mathbb{E}[N_n]$, we use the law of total expectation (also known as the tower property):\n$$\n\\mathbb{E}[N_n] = \\mathbb{E}[\\mathbb{E}[N_n | N_{n-1}]]\n$$\nFirst, we compute the inner conditional expectation, $\\mathbb{E}[N_n | N_{n-1}]$. Given that the clone size at cycle $n-1$ is $N_{n-1}$, we have:\n$$\n\\mathbb{E}[N_n | N_{n-1}] = \\mathbb{E}\\left[\\sum_{i=1}^{N_{n-1}} X_i^{(n-1)} \\Big| N_{n-1}\\right]\n$$\nBy the linearity of expectation, and because $N_{n-1}$ is treated as a constant within the conditional expectation, this becomes:\n$$\n\\mathbb{E}[N_n | N_{n-1}] = \\sum_{i=1}^{N_{n-1}} \\mathbb{E}[X_i^{(n-1)} | N_{n-1}]\n$$\nSince the outcome for each cell is independent of the total number of cells, $\\mathbb{E}[X_i^{(n-1)} | N_{n-1}] = \\mathbb{E}[X_i^{(n-1)}]$. Since all $X_i$ are identically distributed, let us define their common mean as $\\mu$:\n$$\n\\mu = \\mathbb{E}[X_i]\n$$\nTherefore, the conditional expectation simplifies to:\n$$\n\\mathbb{E}[N_n | N_{n-1}] = \\sum_{i=1}^{N_{n-1}} \\mu = N_{n-1} \\mu\n$$\nNow, we calculate $\\mu$, the mean number of offspring per cell per cycle, from its definition:\n$$\n\\mu = (2 \\cdot P(X_i=2)) + (0 \\cdot P(X_i=0)) + (1 \\cdot P(X_i=1))\n$$\n$$\n\\mu = 2p + 0 \\cdot d + 1(1 - p - d) = 2p + 1 - p - d = 1 + p - d\n$$\nThis expression, $\\mu = 1 + p - d$, is the average multiplication factor for the cell population per cycle. The term $p-d$ represents the net effect of division versus apoptosis on the population count. If $p>d$, the clone tends to expand; if $p<d$, it tends to contract. This explicitly shows how the dependence on the difference $p-d$ emerges from the per-cell outcomes as requested.\n\nSubstituting the expression for $\\mathbb{E}[N_n | N_{n-1}]$ back into the law of total expectation:\n$$\n\\mathbb{E}[N_n] = \\mathbb{E}[N_{n-1} \\mu]\n$$\nSince $\\mu$ is a constant, it can be factored out of the expectation:\n$$\n\\mathbb{E}[N_n] = \\mu \\mathbb{E}[N_{n-1}] = (1 + p - d) \\mathbb{E}[N_{n-1}]\n$$\nThis is a first-order linear recurrence relation for the expected clone size. We can solve it by iteration starting from $n=0$:\nThe base case is $\\mathbb{E}[N_0] = N_0$, since $N_0$ is a specified constant.\nFor $n=1$:\n$$\n\\mathbb{E}[N_1] = (1 + p - d) \\mathbb{E}[N_0] = N_0(1 + p - d)\n$$\nFor $n=2$:\n$$\n\\mathbb{E}[N_2] = (1 + p - d) \\mathbb{E}[N_1] = (1 + p - d) [N_0(1 + p - d)] = N_0(1 + p - d)^2\n$$\nBy induction, we can establish the general formula for any integer $n \\ge 0$. Assume $\\mathbb{E}[N_k] = N_0(1+p-d)^k$ holds for some $k$. Then for $k+1$:\n$$\n\\mathbb{E}[N_{k+1}] = (1 + p - d) \\mathbb{E}[N_k] = (1 + p - d) [N_0(1+p-d)^k] = N_0(1+p-d)^{k+1}\n$$\nThe formula holds for $k+1$. Thus, the closed-form expression for the expected clone size after $n$ cycles is:\n$$\n\\mathbb{E}[N_n] = N_0(1 + p - d)^n\n$$\nThis is the final result derived from first principles as required.", "answer": "$$\\boxed{N_0(1 + p - d)^{n}}$$", "id": "2600015"}, {"introduction": "Immunological memory provides long-lasting protection, but it is constantly challenged by evolving pathogens that change their antigenic signatures—a process known as antigenic drift. Understanding how our antibody repertoire copes with these moving targets is a central problem in vaccinology and epidemiology. This hands-on coding practice [@problem_id:2600020] tasks you with building a simulation in \"antigenic space\" to explore this dynamic interplay. By modeling how the breadth ($B$) and mean affinity ($A$) of a memory antibody response decay as a virus drifts, you will gain practical experience with the kind of quantitative modeling that informs the design of next-generation vaccines.", "problem": "You are tasked with building and evaluating a minimal, principled model of how antigenic drift alters the effective breadth and affinity of serum antibodies using an antigenic space representation with cross-reactivity that decays with antigenic distance. The model must be grounded in the following fundamental base and well-tested facts from adaptive immunity: (i) clonal selection of B lymphocytes (B cells) produces distinct antibody specificities, (ii) immunological memory encodes a set of antibody specificities distributed around previously encountered antigens, and (iii) cross-reactivity empirically decays with increasing antigenic distance between antibody paratopes and antigen epitopes. Your task is to translate these principles into a quantitative and testable algorithm that computes two metrics in response to antigenic drift away from the original antigen.\n\nModel definitions and assumptions to use:\n- Antigenic space is a $2$-dimensional Euclidean plane $\\mathbb{R}^2$. The originally encountered antigen is at the origin $(0,0)$.\n- The memory serum antibody repertoire is represented by $N$ identical-weight B cell-derived clone centers placed uniformly on a circle of radius $r$ around the origin. Explicitly, for $i \\in \\{0,1,\\dots,N-1\\}$,\n  $$\\mu_i = \\left(r \\cos\\left(\\frac{2\\pi i}{N}\\right),\\ r \\sin\\left(\\frac{2\\pi i}{N}\\right)\\right).$$\n  All clone weights are equal and sum to $1$, so each clone weight is $w_i = 1/N$.\n- Cross-reactivity is modeled by a Gaussian kernel that depends only on antigenic distance. For an antigen at position $x \\in \\mathbb{R}^2$ and a clone center $\\mu_i$, the per-clone binding affinity is\n  $$K\\!\\left(\\|x - \\mu_i\\|\\right) = \\exp\\!\\left(-\\frac{\\|x - \\mu_i\\|^2}{2\\tau^2}\\right),$$\n  where $\\tau > 0$ is the cross-reactivity length scale and $\\|\\cdot\\|$ is the Euclidean norm.\n- Antigenic drift displaces the antigen from the origin by a vector of polar form $(\\delta,\\phi)$, i.e.,\n  $$x = \\left(\\delta \\cos\\phi,\\ \\delta \\sin\\phi\\right),$$\n  where $\\delta \\ge 0$ is the drift magnitude and $\\phi$ is the drift angle (in radians).\n- Define a positivity threshold $\\alpha_{\\min} \\in (0,1)$ for functional binding. A clone is considered functionally contributing if and only if its affinity meets or exceeds the threshold:\n  $$K\\!\\left(\\|x - \\mu_i\\|\\right) \\ge \\alpha_{\\min}.$$\n\nQuantities to compute for each test case:\n- Breadth $B$ is the fraction of clones meeting the threshold, weighted by $w_i$ (which here are equal). Since all $w_i$ are equal, this reduces to the fraction of indices $i$ that satisfy $K(\\|x-\\mu_i\\|) \\ge \\alpha_{\\min}$. Formally,\n  $$B = \\frac{\\sum_{i=0}^{N-1} w_i \\,\\mathbf{1}\\!\\left[K\\!\\left(\\|x-\\mu_i\\|\\right) \\ge \\alpha_{\\min}\\right]}{\\sum_{i=0}^{N-1} w_i} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\mathbf{1}\\!\\left[K\\!\\left(\\|x-\\mu_i\\|\\right) \\ge \\alpha_{\\min}\\right].$$\n- Mean affinity among contributing clones $A$ is the weight-normalized mean of $K(\\|x-\\mu_i\\|)$ over those clones that meet the threshold. If no clone meets the threshold, define $A=0$. Formally, with $S=\\{i: K(\\|x-\\mu_i\\|)\\ge \\alpha_{\\min}\\}$,\n  $$A = \\begin{cases}\n  \\dfrac{\\sum_{i \\in S} w_i\\, K\\!\\left(\\|x - \\mu_i\\|\\right)}{\\sum_{i \\in S} w_i}, & \\text{if } |S| > 0 \\\\\n  0, & \\text{if } |S| = 0\n  \\end{cases}$$\n\nFixed repertoire configuration for all test cases:\n- Number of clones $N = 8$.\n- Repertoire radius $r = 2.0$ (dimensionless).\n- All quantities are dimensionless; there are no physical units.\n\nInput specification (implicit within the program): For each test case, you will receive a parameter tuple $(\\delta,\\phi,\\tau,\\alpha_{\\min})$ as described above. Angles must be interpreted in radians.\n\nTest suite to implement:\n- Case $1$: $(\\delta,\\phi,\\tau,\\alpha_{\\min}) = (1.5,\\ \\pi/6,\\ 1.0,\\ 0.2)$.\n- Case $2$: $(\\delta,\\phi,\\tau,\\alpha_{\\min}) = (0.0,\\ 0.0,\\ 1.0,\\ 0.5)$.\n- Case $3$: $(\\delta,\\phi,\\tau,\\alpha_{\\min}) = (5.0,\\ \\pi/3,\\ 1.0,\\ 0.1)$.\n- Case $4$: $(\\delta,\\phi,\\tau,\\alpha_{\\min}) = (3.0,\\ \\pi/2,\\ 2.0,\\ 0.2)$.\n- Case $5$: $(\\delta,\\phi,\\tau,\\alpha_{\\min}) = (2.0,\\ \\pi/4,\\ 0.8,\\ 0.4)$.\n- Case $6$: $(\\delta,\\phi,\\tau,\\alpha_{\\min}) = (3.0,\\ 0.0,\\ 0.5,\\ 0.7)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list being $[B,A]$ for a test case, in the same order as listed above.\n- Each $B$ and $A$ must be printed as decimal floats rounded to $6$ decimal places.\n- The single line must look like\n  $$\\texttt{[[B\\_1,A\\_1],[B\\_2,A\\_2],\\dots,[B\\_6,A\\_6]]}$$\n  with no additional text before or after.\n\nYour deliverable must be a complete, runnable program that computes the specified quantities for the fixed repertoire configuration and the given test suite, and prints the results in the exact specified format. All computations are dimensionless. No user input or external files are permitted.", "solution": "The problem statement is found to be valid. It is scientifically grounded in established immunological principles, quantitatively well-posed, and free of contradiction or ambiguity. We proceed with the solution.\n\nThe task is to compute two metrics, breadth $B$ and mean affinity $A$, for a model of an antibody repertoire responding to an antigen that has undergone antigenic drift. The model is defined by a set of fixed parameters and variable test case parameters.\n\nFixed parameters:\n- Number of antibody clones: $N = 8$.\n- Radius of the memory repertoire: $r = 2.0$.\n\nThe clone centers, representing distinct antibody specificities, are given by the vectors $\\mu_i$ for $i \\in \\{0, 1, \\dots, N-1\\}$:\n$$ \\mu_i = \\left(r \\cos\\left(\\frac{2\\pi i}{N}\\right),\\ r \\sin\\left(\\frac{2\\pi i}{N}\\right)\\right) $$\n\nThe antigen, originally at the origin $(0,0)$, drifts to a new position $x$ defined in polar coordinates by $(\\delta, \\phi)$:\n$$ x = (\\delta \\cos\\phi, \\delta \\sin\\phi) $$\n\nThe binding affinity $K_i$ of the $i$-th clone to the drifted antigen at position $x$ is modeled by a Gaussian function of the Euclidean distance $\\|x - \\mu_i\\|$:\n$$ K_i = K(\\|x - \\mu_i\\|) = \\exp\\left(-\\frac{\\|x - \\mu_i\\|^2}{2\\tau^2}\\right) $$\nwhere $\\tau$ is the cross-reactivity length scale.\n\nA clone is considered functionally contributing if its affinity $K_i$ meets or exceeds a threshold $\\alpha_{\\min}$. The set of indices of contributing clones is denoted $S = \\{i : K_i \\ge \\alpha_{\\min}\\}$.\n\nThe two quantities to be computed are:\n1.  Breadth $B$: The fraction of clones that are functionally contributing. Since the clone weights $w_i = 1/N$ are uniform, this simplifies to the ratio of the number of contributing clones to the total number of clones.\n    $$ B = \\frac{|S|}{N} $$\n2.  Mean Affinity $A$: The average affinity of the contributing clones. If no clones contribute ($S$ is empty), $A=0$. Again, due to uniform weights, this is the simple arithmetic mean.\n    $$ A = \\begin{cases} \\frac{1}{|S|} \\sum_{i \\in S} K_i, & \\text{if } |S| > 0 \\\\ 0, & \\text{if } |S| = 0 \\end{cases} $$\n\nThe computational procedure for each test case $(\\delta, \\phi, \\tau, \\alpha_{\\min})$ is as follows:\n\n1.  **Construct Repertoire**: Generate the $N=8$ clone center coordinates $\\mu_i$ using the given formula with $r=2.0$. These are stored as a set of $2$-dimensional vectors.\n\n2.  **Determine Antigen Position**: Calculate the Cartesian coordinates of the drifted antigen $x$ from its polar coordinates $(\\delta, \\phi)$.\n\n3.  **Calculate All Affinities**: For each clone $i$ from $0$ to $7$:\n    a.  Compute the squared Euclidean distance $d_i^2 = \\|x - \\mu_i\\|^2$.\n    b.  Compute the affinity $K_i = \\exp(-d_i^2 / (2\\tau^2))$.\n\n4.  **Identify Contributing Clones**: Create a boolean mask by comparing each calculated affinity $K_i$ against the threshold $\\alpha_{\\min}$. A clone contributes if $K_i \\ge \\alpha_{\\min}$.\n\n5.  **Compute Breadth $B$**: The number of contributing clones, $|S|$, is the count of `true` values in the boolean mask. The breadth is then $B = |S| / N$.\n\n6.  **Compute Mean Affinity $A$**:\n    a.  If $|S| > 0$, the mean affinity $A$ is the arithmetic mean of the affinities for the contributing clones.\n    b.  If $|S| = 0$, $A$ is set to $0$.\n\nThis algorithm is implemented using vector operations for efficiency and is applied to each of the six specified test cases. The resulting pairs $[B, A]$ are calculated and formatted to $6$ decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_metrics(delta, phi, tau, alpha_min, N, r):\n    \"\"\"\n    Computes breadth B and mean affinity A for a given set of parameters.\n\n    Args:\n        delta (float): Antigenic drift magnitude.\n        phi (float): Antigenic drift angle in radians.\n        tau (float): Cross-reactivity length scale.\n        alpha_min (float): Functional binding affinity threshold.\n        N (int): Number of antibody clones.\n        r (float): Radius of the memory repertoire.\n\n    Returns:\n        tuple: A tuple containing (breadth, mean_affinity).\n    \"\"\"\n    # 1. Construct Repertoire: Generate clone center coordinates\n    # Create an array of clone indices from 0 to N-1\n    i_vals = np.arange(N)\n    # Calculate the angle for each clone\n    thetas = 2 * np.pi * i_vals / N\n    # Calculate the cartesian coordinates for all clone centers using vectorization\n    mu = r * np.stack((np.cos(thetas), np.sin(thetas)), axis=1)\n\n    # 2. Determine Antigen Position: Calculate cartesian coordinates of the antigen\n    x = np.array([delta * np.cos(phi), delta * np.sin(phi)])\n\n    # 3. Calculate All Affinities\n    # Calculate the squared Euclidean distance from the antigen to each clone center\n    # Broadcasting is used here: mu is (N, 2), x is (2,), so (mu - x) is (N, 2)\n    dist_sq = np.sum((mu - x)**2, axis=1)\n    # Calculate the affinity for each clone\n    affinities = np.exp(-dist_sq / (2 * tau**2))\n\n    # 4. Identify Contributing Clones using a boolean mask\n    contributing_mask = affinities >= alpha_min\n    \n    # 5. Compute Breadth B\n    num_contributing = np.sum(contributing_mask)\n    breadth = num_contributing / N\n    \n    # 6. Compute Mean Affinity A\n    if num_contributing > 0:\n        # Calculate the mean of affinities for only the contributing clones\n        mean_affinity = np.mean(affinities[contributing_mask])\n    else:\n        # As per the definition, A is 0 if no clones contribute\n        mean_affinity = 0.0\n\n    return breadth, mean_affinity\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the result.\n    \"\"\"\n    # Fixed repertoire configuration\n    N = 8\n    r = 2.0\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.5, np.pi/6, 1.0, 0.2),\n        (0.0, 0.0, 1.0, 0.5),\n        (5.0, np.pi/3, 1.0, 0.1),\n        (3.0, np.pi/2, 2.0, 0.2),\n        (2.0, np.pi/4, 0.8, 0.4),\n        (3.0, 0.0, 0.5, 0.7),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, phi, tau, alpha_min = case\n        B, A = compute_metrics(delta, phi, tau, alpha_min, N=N, r=r)\n        results.append((B, A))\n\n    # Format the final output string exactly as specified.\n    # Each pair [B, A] is formatted to 6 decimal places.\n    # The pairs are joined by commas, and the whole list is enclosed in brackets.\n    formatted_pairs = [f\"[{b:.6f},{a:.6f}]\" for b, a in results]\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2600020"}]}