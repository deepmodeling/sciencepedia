{"hands_on_practices": [{"introduction": "To comprehend how a photoreceptor responds to light, we must first establish its baseline condition in darkness. This initial practice focuses on the fundamental principle of steady-state dynamics governing the concentration of the key second messenger, cyclic guanosine monophosphate ($cGMP$). By balancing the constant synthesis of $cGMP$ by guanylyl cyclase against its first-order hydrolysis, you will calculate the resting concentration of $cGMP$ and the resulting open probability of the cyclic nucleotide-gated (CNG) channels that generate the characteristic 'dark current' [@problem_id:2593556].", "problem": "A rod photoreceptor outer segment maintains a dark steady state of cyclic guanosine monophosphate (cGMP) through a balance between synthesis by guanylyl cyclase and hydrolysis by phosphodiesterase. Assume that in darkness the cGMP synthesis rate is constant at $\\alpha$ and hydrolysis follows first-order kinetics with rate constant $\\beta$, so that the cGMP concentration $[cGMP](t)$ obeys mass balance. The cyclic nucleotide-gated (CNG) channels in the outer segment open with a probability $P_o$ that depends on $[cGMP]$ via cooperative ligand binding characterized by a half-activation concentration $K_{1/2}$ and Hill coefficient $n$, under the standard assumptions of rapid binding equilibrium and identical, independent binding sites within the Hill approximation. Given $\\alpha = 4\\,\\mu\\mathrm{M/s}$, $\\beta = 1\\,\\mathrm{s^{-1}}$, $K_{1/2} = 20\\,\\mu\\mathrm{M}$, and $n = 3$, determine the steady-state cGMP concentration in darkness and the corresponding open probability of the CNG channels.\n\nExpress the steady-state $[cGMP]$ in $\\mu\\mathrm{M}$ and $P_o$ as a decimal number. Round both results to three significant figures.", "solution": "The problem is first subjected to validation to ensure it is scientifically grounded, well-posed, and objective.\n\nStep 1: Extract Givens.\nThe problem provides the following data and relationships:\n-   Rate of cGMP synthesis: $\\alpha = 4\\,\\mu\\mathrm{M/s}$, a constant.\n-   Kinetics of cGMP hydrolysis: First-order, with rate constant $\\beta = 1\\,\\mathrm{s^{-1}}$.\n-   Mass balance equation for cGMP concentration, $[cGMP](t)$: The rate of change is synthesis minus hydrolysis.\n-   CNG channel open probability, $P_o$, is described by a Hill equation.\n-   Half-activation concentration for CNG channels: $K_{1/2} = 20\\,\\mu\\mathrm{M}$.\n-   Hill coefficient: $n = 3$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem describes a standard model of cyclic nucleotide dynamics in a photoreceptor outer segment, a core topic in sensory physiology. The use of mass balance, first-order kinetics, and the Hill equation for cooperative binding are standard, well-established formalisms in biochemistry and cell biology. All parameters are given with consistent units, and their values are physiologically plausible. The problem is self-contained, unambiguous, and seeks a unique, computable solution based on the provided information. It is free from scientific inaccuracies, subjective claims, or logical contradictions.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A solution will now be derived.\n\nThe dynamics of the cGMP concentration, which we denote as $C(t) \\equiv [cGMP](t)$, are governed by a mass balance equation. The rate of change of the concentration is the difference between the rate of synthesis and the rate of hydrolysis.\nThe synthesis rate is given as a constant, $\\alpha$.\nThe hydrolysis rate follows first-order kinetics, meaning it is proportional to the current concentration, given by $\\beta C(t)$.\nThus, the governing ordinary differential equation is:\n$$ \\frac{dC(t)}{dt} = \\alpha - \\beta C(t) $$\nThe problem asks for the steady-state concentration in darkness. In the steady state, the concentration is constant with respect to time. We denote this concentration as $C_{ss}$. This condition implies that the rate of change is zero:\n$$ \\frac{dC_{ss}}{dt} = 0 $$\nSubstituting this into the differential equation gives:\n$$ 0 = \\alpha - \\beta C_{ss} $$\nWe solve this algebraic equation for $C_{ss}$:\n$$ \\beta C_{ss} = \\alpha $$\n$$ C_{ss} = \\frac{\\alpha}{\\beta} $$\nNow, we substitute the provided numerical values for $\\alpha$ and $\\beta$:\n$$ \\alpha = 4\\,\\mu\\mathrm{M/s} $$\n$$ \\beta = 1\\,\\mathrm{s^{-1}} $$\nThe steady-state concentration is therefore:\n$$ C_{ss} = \\frac{4\\,\\mu\\mathrm{M/s}}{1\\,\\mathrm{s^{-1}}} = 4\\,\\mu\\mathrm{M} $$\nThe problem requires this result rounded to three significant figures, which is $4.00\\,\\mu\\mathrm{M}$.\n\nNext, we must determine the corresponding open probability, $P_o$, of the cyclic nucleotide-gated (CNG) channels. The problem states this probability follows the Hill equation, which describes cooperative ligand binding. The general form of the Hill equation for activation is:\n$$ P_o = \\frac{[L]^n}{[L]^n + K_{1/2}^n} $$\nIn this context, the ligand $[L]$ is the steady-state cGMP concentration, $C_{ss}$. The other parameters are the Hill coefficient, $n$, and the half-activation concentration, $K_{1/2}$.\nSubstituting the relevant variables and values:\n-   $C_{ss} = 4\\,\\mu\\mathrm{M}$\n-   $n = 3$\n-   $K_{1/2} = 20\\,\\mu\\mathrm{M}$\n\nThe open probability $P_o$ is calculated as:\n$$ P_o = \\frac{(C_{ss})^n}{(C_{ss})^n + (K_{1/2})^n} = \\frac{(4)^3}{(4)^3 + (20)^3} $$\nThe units of concentration ($\\mu\\mathrm{M}$) cancel, as expected for a dimensionless probability.\nWe compute the numerical values:\n$$ 4^3 = 64 $$\n$$ 20^3 = 8000 $$\nSubstituting these into the expression for $P_o$:\n$$ P_o = \\frac{64}{64 + 8000} = \\frac{64}{8064} $$\nTo obtain the decimal value, we perform the division:\n$$ P_o \\approx 0.0079365079... $$\nThe problem requires this result to be rounded to three significant figures. The first non-zero digit is $7$, so we retain it and the next two digits, $9$ and $3$. The following digit is $6$, which is greater than or equal to $5$, so we round up the last significant digit.\n$$ P_o \\approx 0.00794 $$\nThe two requested quantities are the steady-state cGMP concentration, $4.00\\,\\mu\\mathrm{M}$, and the CNG channel open probability, $0.00794$.", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 & 0.00794 \\end{pmatrix}}$$", "id": "2593556"}, {"introduction": "The essence of phototransduction is the conversion of a biochemical change into an electrical signal. This exercise delves into the critical link between the concentration of $cGMP$ and the macroscopic photocurrent flowing through CNG channels [@problem_id:2593522]. You will apply the Hill equation to model the cooperative nature of channel gating and quantify the significant reduction in current that results from a light-induced drop in $cGMP$, providing insight into the high sensitivity of the photoreceptor's electrical response.", "problem": "In vertebrate rod photoreceptors, cyclic guanosine monophosphate (cGMP) binds cooperatively to cGMP-gated cation channels in the outer segment plasma membrane. The open probability of these channels increases with cGMP concentration and is characterized by a Hill-type cooperative binding with a half-saturation concentration $K_{1/2}$ (defined as the concentration at which the open probability is one-half) and a Hill coefficient $n$ (the cooperativity order). Under whole-cell voltage clamp at a fixed command potential, assume that the macroscopic current through these channels obeys Ohm’s law and that the total conductance is proportional to the channel open probability, so that the current is proportional to the open probability when the driving force is held constant.\n\nConsider a voltage-clamp experiment in which cytosolic $[\\mathrm{cGMP}]$ falls from $4\\,\\mu\\mathrm{M}$ to $2\\,\\mu\\mathrm{M}$ following photoactivation, with parameters $K_{1/2}=2\\,\\mu\\mathrm{M}$ and $n=3$. Using only the above assumptions and standard cooperative binding for ligand-gated channels, compute the fractional reduction of the macroscopic current, defined as $\\left(I_{\\mathrm{initial}}-I_{\\mathrm{final}}\\right)/I_{\\mathrm{initial}}$, where $I_{\\mathrm{initial}}$ and $I_{\\mathrm{final}}$ are the steady currents before and after the change in $[\\mathrm{cGMP}]$, respectively.\n\nExpress your final answer as a pure number without units. If you choose to give a decimal, it must be exact or derived from an exact fraction; no rounding is required.", "solution": "The problem as stated is valid, scientifically grounded, and possesses a unique solution. It requires the application of the standard biophysical model for cooperative ligand binding, specifically the Hill equation.\n\nLet $C$ represent the concentration of cyclic guanosine monophosphate, $[\\mathrm{cGMP}]$. The open probability, $P_o$, of the cGMP-gated channels as a function of $C$ is described by the Hill equation:\n$$ P_o(C) = \\frac{C^n}{K_{d} + C^n} $$\nwhere $n$ is the Hill coefficient and $K_d$ is the dissociation constant. The problem provides the half-saturation concentration, $K_{1/2}$, which is the concentration at which $P_o = 1/2$. By definition, this implies:\n$$ \\frac{1}{2} = \\frac{(K_{1/2})^n}{K_{d} + (K_{1/2})^n} \\implies K_{d} + (K_{1/2})^n = 2(K_{1/2})^n \\implies K_{d} = (K_{1/2})^n $$\nTherefore, the Hill equation can be expressed in terms of the given parameters $n$ and $K_{1/2}$ as:\n$$ P_o(C) = \\frac{C^n}{(K_{1/2})^n + C^n} $$\nIt is convenient to normalize the concentration with respect to $K_{1/2}$ by defining a dimensionless concentration $c = C/K_{1/2}$. Substituting $C = c \\cdot K_{1/2}$ into the equation gives:\n$$ P_o(c) = \\frac{(c \\cdot K_{1/2})^n}{(K_{1/2})^n + (c \\cdot K_{1/2})^n} = \\frac{c^n (K_{1/2})^n}{(K_{1/2})^n (1 + c^n)} = \\frac{c^n}{1 + c^n} $$\nThe problem states that the macroscopic current, $I$, is proportional to the total conductance, which in turn is proportional to the channel open probability $P_o$, as the voltage is clamped. Thus, we have the direct proportionality $I \\propto P_o$. Let this be expressed as $I = \\alpha P_o$, where $\\alpha$ is a constant of proportionality that incorporates the single-channel conductance, the number of channels, and the electrochemical driving force.\n\nWe are tasked with computing the fractional reduction of the current, which is defined as:\n$$ \\text{Fractional Reduction} = \\frac{I_{\\mathrm{initial}} - I_{\\mathrm{final}}}{I_{\\mathrm{initial}}} = 1 - \\frac{I_{\\mathrm{final}}}{I_{\\mathrm{initial}}} $$\nUsing the proportionality between current and open probability, the ratio of final to initial current is equal to the ratio of final to initial open probability:\n$$ \\frac{I_{\\mathrm{final}}}{I_{\\mathrm{initial}}} = \\frac{\\alpha P_{o, \\mathrm{final}}}{\\alpha P_{o, \\mathrm{initial}}} = \\frac{P_{o, \\mathrm{final}}}{P_{o, \\mathrm{initial}}} $$\nThe given parameters are $K_{1/2} = 2\\,\\mu\\mathrm{M}$ and $n=3$. The initial and final concentrations are $C_{\\mathrm{initial}} = 4\\,\\mu\\mathrm{M}$ and $C_{\\mathrm{final}} = 2\\,\\mu\\mathrm{M}$, respectively.\n\nWe first compute the dimensionless concentrations:\nThe initial dimensionless concentration is $c_{\\mathrm{initial}} = \\frac{C_{\\mathrm{initial}}}{K_{1/2}} = \\frac{4\\,\\mu\\mathrm{M}}{2\\,\\mu\\mathrm{M}} = 2$.\nThe final dimensionless concentration is $c_{\\mathrm{final}} = \\frac{C_{\\mathrm{final}}}{K_{1/2}} = \\frac{2\\,\\mu\\mathrm{M}}{2\\,\\mu\\mathrm{M}} = 1$.\n\nNext, we calculate the open probabilities for the initial and final states using the normalized Hill equation and the Hill coefficient $n=3$:\n$$ P_{o, \\mathrm{initial}} = P_o(c_{\\mathrm{initial}}) = \\frac{c_{\\mathrm{initial}}^n}{1 + c_{\\mathrm{initial}}^n} = \\frac{2^3}{1 + 2^3} = \\frac{8}{1 + 8} = \\frac{8}{9} $$\n$$ P_{o, \\mathrm{final}} = P_o(c_{\\mathrm{final}}) = \\frac{c_{\\mathrm{final}}^n}{1 + c_{\\mathrm{final}}^n} = \\frac{1^3}{1 + 1^3} = \\frac{1}{1 + 1} = \\frac{1}{2} $$\nThe result for $P_{o, \\mathrm{final}}$ is as expected, since the final concentration equals the half-saturation concentration $K_{1/2}$.\n\nNow, we compute the ratio of the currents:\n$$ \\frac{I_{\\mathrm{final}}}{I_{\\mathrm{initial}}} = \\frac{P_{o, \\mathrm{final}}}{P_{o, \\mathrm{initial}}} = \\frac{1/2}{8/9} = \\frac{1}{2} \\cdot \\frac{9}{8} = \\frac{9}{16} $$\nFinally, we calculate the fractional reduction of the current:\n$$ \\text{Fractional Reduction} = 1 - \\frac{I_{\\mathrm{final}}}{I_{\\mathrm{initial}}} = 1 - \\frac{9}{16} = \\frac{16}{16} - \\frac{9}{16} = \\frac{7}{16} $$\nThis value represents the fractional decrease in current as the $[\\mathrm{cGMP}]$ falls from $4\\,\\mu\\mathrm{M}$ to $2\\,\\mu\\mathrm{M}$.", "answer": "$$\\boxed{\\frac{7}{16}}$$", "id": "2593522"}, {"introduction": "Moving beyond static snapshots, this capstone practice challenges you to synthesize the core components of phototransduction into a single, integrated dynamical system. You will construct a model using ordinary differential equations (ODEs) that captures the time-dependent interplay between light activation, $cGMP$ levels, calcium feedback, and the resulting photocurrent [@problem_id:2593606]. This computational exercise not only simulates the full light response but also introduces the advanced concept of parameter identifiability, a crucial topic in systems biology for validating models against experimental data.", "problem": "You are asked to formalize and analyze a dynamical model for phototransduction focusing on cyclic guanosine monophosphate (cGMP) concentration and its connection to the photocurrent. Your task is to derive an ordinary differential equation (ODE) for cGMP dynamics from foundational physiological principles, link it to the measurable photocurrent, and implement a computational identifiability analysis for key parameters using only synthetic photocurrent recordings.\n\nStarting point: use only the following foundational facts as your base.\n- Mass balance for a molecular species implies production rate minus consumption rate equals the time derivative of its concentration. If a reaction removes a species in a first-order manner with respect to that species, the loss rate is proportional to its concentration multiplied by an activity coefficient of the catalyst.\n- In vertebrate photoreceptors, cGMP is synthesized by guanylate cyclase, which is inhibited by calcium ions. Let the synthesis rate be a decreasing function of free calcium concentration $C(t)$, denoted $\\alpha(C)$.\n- cGMP is hydrolyzed by phosphodiesterase type $6$ (PDE6) activated downstream of photoactivated rhodopsin $R^*(t)$. Assume first-order cGMP hydrolysis with respect to cGMP concentration $c(t)$, scaled by the instantaneous activity of $R^*(t)$ and a proportionality constant $\\beta$.\n- Light-evoked $R^*(t)$ activity can be modeled as the sum of a dark baseline $R_{\\text{dark}}$ and a flash-evoked component with amplitude $A$ and exponential decay with time constant $\\tau_R$: for $t \\ge 0$, $R^*(t) = R_{\\text{dark}} + A \\exp(-t/\\tau_R)$.\n- The fraction of open cyclic nucleotide-gated (CNG) channels is a Hill function of cGMP: if the Hill coefficient is $m$ and the half-activation concentration is $K_c$, the open probability is $P_{\\text{open}}(t) = \\dfrac{c(t)^m}{K_c^m + c(t)^m}$. The macroscopic photocurrent is $I(t) = I_{\\max} P_{\\text{open}}(t)$.\n- Free calcium is buffered but follows a linear first-order dynamic balance between extrusion and influx through CNG channels: $\\dfrac{dC}{dt} = -k_{\\text{ex}} \\left(C(t) - C_{\\text{base}}\\right) + \\xi I(t)$, where $k_{\\text{ex}}$ is the extrusion rate constant, $C_{\\text{base}}$ is the dark reference calcium level, and $\\xi$ is the influx gain that converts channel current into effective changes in free calcium.\n- The guanylate cyclase activity is a decreasing Hill function of calcium via guanylate cyclase-activating proteins: $\\alpha(C) = \\dfrac{\\alpha_{\\max}}{1 + \\left(\\dfrac{C}{K_{\\text{Ca}}}\\right)^n}$, with Hill coefficient $n$ and half-inhibition $K_{\\text{Ca}}$.\n\nDerivation target. Use the above facts to:\n- Derive the closed ODE system for $c(t)$ and $C(t)$ driven by $R^*(t)$, explicitly writing the mass balance for $c(t)$ as synthesis minus hydrolysis and the calcium dynamics for $C(t)$ as linear influx–extrusion balance. Do not assume any other reactions or pathways beyond those stated above.\n- Derive the algebraic mapping from $c(t)$ to the measurable $I(t)$ using the CNG channel gating relationship provided.\n\nSteady state and stimulation. Assume a dark steady state holds for $t < 0$ under $R^*(t) \\equiv R_{\\text{dark}}$, where $\\dfrac{dc}{dt} = 0$ and $\\dfrac{dC}{dt} = 0$. At $t = 0$, a flash of amplitude $A$ is applied, and for $t \\ge 0$, $R^*(t) = R_{\\text{dark}} + A \\exp(-t/\\tau_R)$.\n\nIdentifiability target. Consider the parameter vector of interest $\\theta = \\left[\\alpha_{\\max}, \\beta\\right]$ and the nuisance parameters $\\eta$ depending on the case. Your goal is to assess local, practical identifiability of the components of $\\theta$ from a noiseless synthetic photocurrent trace $I(t)$ by computing a numerical Fisher Information Matrix (FIM) from finite-difference sensitivities of the flash-evoked photocurrent. To avoid contamination by the unknown absolute dark current, the sensitivity should be computed for the flash-evoked component $\\Delta I(t) = I(t) - I_{\\text{dark}}$, where $I_{\\text{dark}}$ is the steady-state current at $t < 0$. The FIM can be approximated as $\\mathcal{I} = \\dfrac{1}{\\sigma^2} J^\\top J$, where $J$ is the Jacobian matrix of $\\Delta I(t)$ with respect to the unknown parameters evaluated along the simulated trajectory, and $\\sigma$ is an assumed measurement noise scale. Use the singular value decomposition of $\\mathcal{I}$ to determine the numerical rank and, when nuisance parameters are present, the nullspace direction(s) to decide which components of $\\theta$ are locally identifiable.\n\nImplementation requirements. Implement a program that:\n- Uses the following fixed parameter values unless specified as unknown in a test case: $m = 3$, $K_c = 3\\,\\mu\\text{M}$, $I_{\\max} = 25\\,\\text{pA}$, $K_{\\text{Ca}} = 0.3\\,\\mu\\text{M}$, $n = 3$, $C_{\\text{base}} = 0.3\\,\\mu\\text{M}$, $\\xi = 0.02\\,\\mu\\text{M}\\,\\text{s}^{-1}\\,\\text{pA}^{-1}$, $k_{\\text{ex}} = 3\\,\\text{s}^{-1}$, $R_{\\text{dark}} = 0.05$ (dimensionless activity units), $\\tau_R = 0.2\\,\\text{s}$, simulation horizon $T = 2.0\\,\\text{s}$. Use nominal unknowns $\\alpha_{\\max} = 10.0\\,\\mu\\text{M}\\,\\text{s}^{-1}$ and $\\beta = 1.0\\,\\text{s}^{-1}$.\n- Computes the dark steady state by solving the steady-state equations at $R^*(t) \\equiv R_{\\text{dark}}$ for $c$ and $C$.\n- Simulates the ODE system for $t \\in [0, T]$ under the specified $R^*(t)$ using an ODE solver.\n- Constructs $J$ using central finite differences with a small relative step for each unknown parameter around the nominal values. Use an assumed noise standard deviation $\\sigma = 0.2\\,\\text{pA}$ for the FIM scaling.\n- Determines the number of identifiable parameters among $\\theta = \\left[\\alpha_{\\max}, \\beta\\right]$ as follows:\n  - If no nuisance parameters are present, compute the numerical rank of the FIM with a singular value threshold $\\tau_{\\text{sv}} = 10^{-6} \\times s_{\\max} + 10^{-12}$, where $s_{\\max}$ is the largest singular value. The count of singular values above the threshold is the number of identifiable parameters among $\\alpha_{\\max}$ and $\\beta$.\n  - If one nuisance parameter is present (unknown $K_c$), compute the FIM including all unknowns and identify which of $\\alpha_{\\max}$ and $\\beta$ are identifiable by inspecting the right singular vector corresponding to the smallest singular value. Classify a parameter as non-identifiable if the absolute value of its component in this nullspace vector exceeds a threshold $\\tau_{\\text{null}} = 0.25$. Count how many among $\\alpha_{\\max}$ and $\\beta$ are identifiable under this rule.\n\nTest suite. Your program must run the following cases and report a single result per case as an integer equal to the number of identifiable parameters among $\\left[\\alpha_{\\max}, \\beta\\right]$.\n- Case $1$ (happy path): $A = 1.0$, unknowns $\\left[\\alpha_{\\max}, \\beta\\right]$, with $K_c$ known. Expect both parameters to be locally identifiable from the transient photocurrent shape.\n- Case $2$ (structural confounding): $A = 1.0$, unknowns $\\left[\\alpha_{\\max}, \\beta, K_c\\right]$. Due to scale invariance between $c(t)$ and $K_c$, only one of $\\left[\\alpha_{\\max}, \\beta\\right]$ is structurally locally identifiable; identify how many are identifiable using the nullspace rule.\n- Case $3$ (practical unidentifiability at vanishing stimulus): $A = 10^{-8}$, unknowns $\\left[\\alpha_{\\max}, \\beta\\right]$, with $K_c$ known. The flash-evoked signal is negligible, so neither parameter should be practically identifiable from $\\Delta I(t)$.\n- Case $4$ (bright flash): $A = 30.0$, unknowns $\\left[\\alpha_{\\max}, \\beta\\right]$, with $K_c$ known. The strong transient should provide sufficient excitation for both parameters to be locally identifiable.\n\nAngle units do not arise in this problem. All physical quantities stated above are in the units specified next to each parameter. The output of your program should not include units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[2,1,0,2]\").\n\nYour final program must be self-contained and executable as given, with no external input.", "solution": "The problem statement is a valid, well-posed, and scientifically grounded exercise in computational systems biology. It outlines a standard, albeit simplified, model of vertebrate phototransduction and poses a clear task: to derive the model's governing equations, and then to implement a numerical parameter identifiability analysis. All required parameters, functional forms, and analysis procedures are provided, rendering the problem self-contained and tractable. The premises are based on established physiological facts, and the task is to apply standard mathematical and computational methods to this system. Therefore, I will proceed with a full solution.\n\n### 1. Derivation of the Mathematical Model\n\nThe model describes the dynamics of the concentrations of cyclic guanosine monophosphate ($c(t)$) and free intracellular calcium ($C(t)$), and the resulting membrane photocurrent ($I(t)$). The derivation is based on the principles of mass-action kinetics and established empirical relationships for component activities.\n\n#### 1.1. cGMP Dynamics\nThe concentration of cGMP, denoted $c(t)$, is governed by a mass balance equation:\n$$ \\frac{dc}{dt} = \\text{Rate of Synthesis} - \\text{Rate of Hydrolysis} $$\nThe synthesis of cGMP is catalyzed by guanylate cyclase (GC), whose activity, $\\alpha(C)$, is inhibited by calcium ions. This relationship is given as a decreasing Hill function:\n$$ \\text{Rate of Synthesis} = \\alpha(C(t)) = \\frac{\\alpha_{\\max}}{1 + \\left(\\frac{C(t)}{K_{\\text{Ca}}}\\right)^n} $$\nwhere $\\alpha_{\\max}$ is the maximal synthesis rate, $K_{\\text{Ca}}$ is the half-inhibition constant for calcium, and $n$ is the Hill coefficient for this inhibition.\n\nThe hydrolysis of cGMP is catalyzed by phosphodiesterase (PDE6), which is activated by photo-excited rhodopsin, $R^*(t)$. The problem states this is a first-order reaction with respect to $c(t)$, with a rate proportional to the activity of $R^*(t)$:\n$$ \\text{Rate of Hydrolysis} = \\beta R^*(t) c(t) $$\nwhere $\\beta$ is a proportionality constant representing the effectiveness of activated PDE.\n\nCombining synthesis and hydrolysis, the ordinary differential equation for cGMP concentration is:\n$$ \\frac{dc}{dt} = \\frac{\\alpha_{\\max}}{1 + \\left(\\frac{C(t)}{K_{\\text{Ca}}}\\right)^n} - \\beta R^*(t) c(t) $$\n\n#### 1.2. Calcium Dynamics\nThe dynamics of free intracellular calcium, $C(t)$, are described by a linear first-order balance between extrusion and influx.\n$$ \\frac{dC}{dt} = \\text{Rate of Influx} - \\text{Rate of Extrusion} $$\nThe extrusion mechanism, typically a $\\mathrm{Na}^+/\\mathrm{Ca}^{2+},\\mathrm{K}^+$ exchanger, is modeled with a rate proportional to the deviation of $C(t)$ from a baseline level, $C_{\\text{base}}$:\n$$ \\text{Rate of Extrusion} = k_{\\text{ex}} (C(t) - C_{\\text{base}}) $$\nwhere $k_{\\text{ex}}$ is the extrusion rate constant.\nThe influx of calcium occurs through the cyclic nucleotide-gated (CNG) channels, and is thus proportional to the photocurrent $I(t)$:\n$$ \\text{Rate of Influx} = \\xi I(t) $$\nwhere $\\xi$ is an influx gain factor that converts current to a change in concentration.\nThe resulting ODE for calcium is:\n$$ \\frac{dC}{dt} = \\xi I(t) - k_{\\text{ex}} (C(t) - C_{\\text{base}}) $$\n\n#### 1.3. Photocurrent Generation\nThe photocurrent $I(t)$ is generated by the flow of ions through CNG channels. The fraction of open channels, $P_{\\text{open}}$, is a cooperative function of the cGMP concentration, $c(t)$, modeled by a Hill equation:\n$$ P_{\\text{open}}(t) = \\frac{c(t)^m}{K_c^m + c(t)^m} $$\nwhere $K_c$ is the cGMP concentration for half-maximal activation, and $m$ is the Hill coefficient. The total photocurrent is the product of the maximum possible current, $I_{\\max}$, and this open probability:\n$$ I(t) = I_{\\max} P_{\\text{open}}(t) = I_{\\max} \\frac{c(t)^m}{K_c^m + c(t)^m} $$\n\n#### 1.4. Full System\nThe complete model is a system of two coupled, non-linear ordinary differential equations driven by the light-induced activity $R^*(t)$. For $t \\ge 0$, a flash of amplitude $A$ is applied, so $R^*(t) = R_{\\text{dark}} + A \\exp(-t/\\tau_R)$.\nThe full system is:\n$$\n\\begin{cases}\n\\dfrac{dc}{dt} = \\dfrac{\\alpha_{\\max}}{1 + \\left(\\frac{C(t)}{K_{\\text{Ca}}}\\right)^n} - \\beta \\left(R_{\\text{dark}} + A e^{-t/\\tau_R}\\right) c(t) \\\\\n\\dfrac{dC}{dt} = -k_{\\text{ex}} (C(t) - C_{\\text{base}}) + \\xi I_{\\max} \\dfrac{c(t)^m}{K_c^m + c(t)^m}\n\\end{cases}\n$$\nThe initial conditions, $(c(0), C(0))$, are determined by the steady state of the system in darkness ($A=0$).\n\n### 2. Steady-State Analysis\nIn the dark, for $t < 0$, the system is at a steady state where $R^*(t) = R_{\\text{dark}}$ and all time derivatives are zero. Let the steady-state concentrations be $c_{\\text{dark}}$ and $C_{\\text{dark}}$.\nSetting $\\frac{dc}{dt}=0$ and $\\fracdC}{dt}=0$:\n$$ 0 = \\frac{\\alpha_{\\max}}{1 + \\left(\\frac{C_{\\text{dark}}}{K_{\\text{Ca}}}\\right)^n} - \\beta R_{\\text{dark}} c_{\\text{dark}} $$\n$$ 0 = -k_{\\text{ex}} (C_{\\text{dark}} - C_{\\text{base}}) + \\xi I_{\\max} \\frac{c_{\\text{dark}}^m}{K_c^m + c_{\\text{dark}}^m} $$\nThis is a system of two coupled, non-linear algebraic equations for $(c_{\\text{dark}}, C_{\\text{dark}})$. These equations must be solved numerically to find the initial conditions for the dynamic simulation of the light response.\n\n### 3. Parameter Identifiability Analysis\n\nThe objective is to determine which parameters in the vector of interest, $\\theta = [\\alpha_{\\max}, \\beta]$, can be reliably estimated from measurements of the flash-evoked photocurrent, $\\Delta I(t) = I(t) - I_{\\text{dark}}$.\n\n#### 3.1. Fisher Information Matrix (FIM)\nFor a model with additive Gaussian noise with standard deviation $\\sigma$, the Fisher Information Matrix (FIM), $\\mathcal{I}$, can be approximated from the sensitivity of the model output to its parameters. The sensitivity (or Jacobian) matrix $J$ has elements $J_{ij} = \\frac{\\partial \\Delta I(t_i)}{\\partial p_j}$, where $p_j$ is the $j$-th parameter. The FIM is then:\n$$ \\mathcal{I} = \\frac{1}{\\sigma^2} J^\\top J $$\nThe rank and eigensystem of $\\mathcal{I}$ reveal which parameters or combinations of parameters are identifiable.\n\n#### 3.2. Numerical Implementation\nThe sensitivity matrix $J$ is computed using central finite differences. For each unknown parameter $p_j$, the model is simulated twice: once with $p_j$ perturbed to $p_j(1+\\epsilon)$ and once to $p_j(1-\\epsilon)$, for a small relative step $\\epsilon$. The corresponding column of $J$ is then:\n$$ \\frac{\\partial \\Delta I(t)}{\\partial p_j} \\approx \\frac{\\Delta I(t; p_j(1+\\epsilon)) - \\Delta I(t; p_j(1-\\epsilon))}{2 \\epsilon p_j} $$\nThe simulation involves:\n1.  Solving the non-linear algebraic system for the dark steady state $(c_{\\text{dark}}, C_{\\text{dark}})$.\n2.  Integrating the ODE system from $t=0$ to $T$ starting from this steady state.\n3.  Calculating the photocurrent response $\\Delta I(t)$.\n\n#### 3.3. Identifiability Criteria\nThe number of identifiable parameters is determined by analyzing the singular values of the FIM.\n- **No nuisance parameters:** The number of identifiable parameters equals the numerical rank of the FIM. This is the count of singular values $s_k$ that exceed a threshold: $s_k > \\tau_{\\text{sv}} = 10^{-6} s_{\\max} + 10^{-12}$, where $s_{\\max}$ is the largest singular value. A rank-deficient FIM indicates that some parameters are not independently determinable.\n- **With nuisance parameters:** When parameters outside the vector of interest $\\theta$ are also unknown (e.g., $K_c$), they are included in the FIM calculation. Structural non-identifiabilities manifest as near-zero singular values. The corresponding right singular vector (the \"nullspace\" vector) indicates the combination of parameters that is unresolvable. A parameter $p_j$ is deemed non-identifiable if its corresponding component in the normalized nullspace vector has an absolute value greater than a threshold, $|v_j| > \\tau_{\\text{null}} = 0.25$. We count how many parameters within the set of interest, $[\\alpha_{\\max}, \\beta]$, satisfy this criterion for being identifiable.\n\nThe provided test cases explore scenarios of standard identifiability (Cases 1, 4), structural non-identifiability due to model symmetries (Case 2), and practical non-identifiability due to lack of stimulus (Case 3).", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Main function to run the phototransduction model identifiability analysis for all test cases.\n    \"\"\"\n    # Fixed model parameters from the problem statement\n    FIXED_PARAMS = {\n        'm': 3.0,\n        'I_max': 25.0,  # pA\n        'K_Ca': 0.3,    # uM\n        'n': 3.0,\n        'C_base': 0.3,  # uM\n        'xi': 0.02,     # uM * s^-1 * pA^-1\n        'k_ex': 3.0,    # s^-1\n        'R_dark': 0.05, # dimensionless activity\n        'tau_R': 0.2,   # s\n    }\n\n    # Nominal values for potentially unknown parameters\n    NOMINAL_UNKNOWNS = {\n        'alpha_max': 10.0, # uM * s^-1\n        'beta': 1.0,       # s^-1\n        'K_c': 3.0,        # uM\n    }\n\n    # Simulation and analysis settings\n    T_SIM = 2.0  # s\n    N_POINTS = 201\n    REL_STEP = 1e-6\n    NOISE_STD_DEV = 0.2  # pA\n\n    # Test case definitions\n    test_cases_spec = [\n        {'A': 1.0, 'unknowns': ['alpha_max', 'beta'], 'is_nuisance': False},\n        {'A': 1.0, 'unknowns': ['alpha_max', 'beta', 'K_c'], 'is_nuisance': True},\n        {'A': 1e-8, 'unknowns': ['alpha_max', 'beta'], 'is_nuisance': False},\n        {'A': 30.0, 'unknowns': ['alpha_max', 'beta'], 'is_nuisance': False},\n    ]\n\n    results = []\n    t_eval = np.linspace(0, T_SIM, N_POINTS)\n\n    def solve_steady_state(params):\n        \"\"\"Solves for dark steady state c and C.\"\"\"\n        def equations(x):\n            c_dark, C_dark = x\n            alpha_C = params['alpha_max'] / (1 + (C_dark / params['K_Ca']) ** params['n'])\n            I_dark = params['I_max'] * (c_dark ** params['m']) / (params['K_c'] ** params['m'] + c_dark ** params['m'])\n            \n            eq1 = alpha_C - params['beta'] * params['R_dark'] * c_dark\n            eq2 = -params['k_ex'] * (C_dark - params['C_base']) + params['xi'] * I_dark\n            return [eq1, eq2]\n\n        # Initial guess\n        c_guess = params['K_c']\n        C_guess = params['C_base']\n        sol = root(equations, [c_guess, C_guess], method='hybr')\n        if not sol.success:\n            raise RuntimeError(f\"Steady state solver failed: {sol.message}\")\n        return sol.x\n\n    def phototransduction_ode(t, y, params, A):\n        \"\"\"Defines the ODE system.\"\"\"\n        c, C = y\n        R_star = params['R_dark'] + A * np.exp(-t / params['tau_R'])\n        \n        alpha_C = params['alpha_max'] / (1 + (C / params['K_Ca']) ** params['n'])\n        dc_dt = alpha_C - params['beta'] * R_star * c\n        \n        I = params['I_max'] * (c ** params['m']) / (params['K_c'] ** params['m'] + c ** params['m'])\n        dC_dt = -params['k_ex'] * (C - params['C_base']) + params['xi'] * I\n        \n        return [dc_dt, dC_dt]\n\n    def get_photocurrent_response(params, A):\n        \"\"\"Simulates the system and returns the photocurrent response.\"\"\"\n        c_dark, C_dark = solve_steady_state(params)\n        y0 = [c_dark, C_dark]\n        \n        I_dark = params['I_max'] * (c_dark ** params['m']) / (params['K_c'] ** params['m'] + c_dark ** params['m'])\n\n        sol = solve_ivp(phototransduction_ode, [0, T_SIM], y0, args=(params, A), dense_output=True, t_eval=t_eval)\n        \n        c_t = sol.y[0]\n        I_t = params['I_max'] * (c_t ** params['m']) / (params['K_c'] ** params['m'] + c_t ** params['m'])\n        \n        return I_t - I_dark\n\n    for case in test_cases_spec:\n        A = case['A']\n        unknowns = case['unknowns']\n        is_nuisance_case = case['is_nuisance']\n        \n        current_params = {**FIXED_PARAMS, **NOMINAL_UNKNOWNS}\n        \n        # Calculate baseline response\n        base_response = get_photocurrent_response(current_params, A)\n        \n        # Construct Jacobian matrix J\n        J = np.zeros((len(t_eval), len(unknowns)))\n        for i, p_name in enumerate(unknowns):\n            p_val = current_params[p_name]\n            \n            # Avoid h=0 for p_val=0, although not expected here\n            h = REL_STEP * p_val if p_val != 0 else REL_STEP\n            \n            params_plus = current_params.copy()\n            params_plus[p_name] += h\n            \n            params_minus = current_params.copy()\n            params_minus[p_name] -= h\n            \n            resp_plus = get_photocurrent_response(params_plus, A)\n            resp_minus = get_photocurrent_response(params_minus, A)\n            \n            # Central difference for sensitivity\n            sensitivity_col = (resp_plus - resp_minus) / (2 * h)\n            J[:, i] = sensitivity_col\n\n        # Compute FIM and perform SVD\n        FIM = (1 / NOISE_STD_DEV**2) * J.T @ J\n        U, s, Vh = np.linalg.svd(FIM)\n        \n        identifiable_count = 0\n        if not is_nuisance_case:\n            # Case 1, 3, 4: Rank of FIM for [alpha_max, beta]\n            s_max = s[0] if len(s) > 0 else 0\n            threshold = 1e-6 * s_max + 1e-12\n            identifiable_count = np.sum(s > threshold)\n        else:\n            # Case 2: Nullspace analysis for [alpha_max, beta, K_c]\n            null_vec = Vh[-1]\n            tau_null = 0.25\n            \n            # Find indices for alpha_max and beta in the unknown list\n            idx_alpha_max = unknowns.index('alpha_max')\n            idx_beta = unknowns.index('beta')\n            \n            is_alpha_max_identifiable = abs(null_vec[idx_alpha_max]) <= tau_null\n            is_beta_identifiable = abs(null_vec[idx_beta]) <= tau_null\n            \n            identifiable_count = int(is_alpha_max_identifiable) + int(is_beta_identifiable)\n            \n        results.append(identifiable_count)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2593606"}]}