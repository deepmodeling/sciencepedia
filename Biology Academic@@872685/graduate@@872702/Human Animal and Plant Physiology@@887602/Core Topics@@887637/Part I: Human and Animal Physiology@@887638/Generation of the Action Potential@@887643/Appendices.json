{"hands_on_practices": [{"introduction": "To begin our exploration of neuronal excitability, we start with the simplest quantitative model of a neuron's membrane: the passive RC circuit. This model treats the membrane as a resistor ($R_m$) and capacitor ($C_m$) in parallel, capturing the fundamental properties of current leakage and charge storage. By analyzing this circuit's response to a current injection, we can derive the classic strength-duration relationship and understand the biophysical basis of two cornerstone excitability metrics: rheobase and chronaxie [@problem_id:2570314]. This foundational exercise connects abstract electrical parameters to concrete, measurable features of neuronal firing.", "problem": "A neuron membrane is modeled as a leaky Resistive–Capacitive (RC) element, equivalent to a resistor of membrane resistance $R_{m}$ in parallel with a capacitor of membrane capacitance $C_{m}$. A rectangular depolarizing current pulse of amplitude $I$ and duration $t_{p}$ is injected at time $t=0$. The membrane potential relative to rest, $V(t)$, obeys the linear first-order membrane equation $C_{m}\\,\\frac{dV}{dt}+\\frac{V}{R_{m}}=I$ for $0 \\le t \\le t_{p}$, with $V(0)=0$. The neuron fires an action potential if $V(t_{p})$ reaches a fixed threshold deflection $\\Delta V_{\\text{th}}$.\n\nStarting from these premises only, perform the following:\n\n1) Derive an explicit expression for the minimal threshold current amplitude $I_{\\text{th}}(t_{p})$ required to reach $V(t_{p})=\\Delta V_{\\text{th}}$ as a function of the pulse duration $t_{p}$ and the membrane time constant $\\tau_{m}=R_{m}C_{m}$.\n\n2) From your expression, define the rheobase $I_{r}$ as the asymptotic threshold for very long pulses, and the chronaxie $t_{c}$ as the pulse duration at which the threshold equals twice the rheobase. Express $I_{r}$ and $t_{c}$ in terms of the underlying parameters $R_{m}$, $C_{m}$, and $\\Delta V_{\\text{th}}$.\n\n3) In a voltage-clamp-free stimulation experiment on this neuron, the measured threshold currents for rectangular pulses were $I_{\\text{th}}(t_{p}=1.00\\,\\mathrm{ms})=20.0\\,\\mu\\mathrm{A}$ and $I_{\\text{th}}(t_{p}=3.00\\,\\mathrm{ms})=11.43\\,\\mu\\mathrm{A}$. Use your derived strength–duration relationship to estimate $I_{r}$ and $\\tau_{m}$, and then compute the chronaxie $t_{c}$.\n\n4) Briefly explain the biophysical meaning of $I_{r}$ and $t_{c}$ in terms of $R_{m}$ and $C_{m}$, making clear how changes in $R_{m}$ or $C_{m}$ would be reflected in these excitability metrics.\n\nReport only the numerical value of the chronaxie $t_{c}$ from part (3), in milliseconds, rounded to three significant figures. Do not include units in your final boxed answer.", "solution": "The problem will be validated before any attempt at a solution is made.\n\n### Step 1: Extract Givens\nThe explicit information provided in the problem statement is as follows:\n- **Model**: Neuron membrane as a parallel RC circuit with membrane resistance $R_{m}$ and membrane capacitance $C_{m}$.\n- **Input Stimulus**: A rectangular current pulse of amplitude $I$ and duration $t_{p}$, injected at time $t=0$.\n- **Governing Equation**: The membrane potential relative to rest, $V(t)$, obeys the differential equation $C_{m}\\,\\frac{dV}{dt}+\\frac{V}{R_{m}}=I$ for the interval $0 \\le t \\le t_{p}$.\n- **Initial Condition**: $V(0)=0$.\n- **Firing Threshold Condition**: An action potential is fired if $V(t_{p})$ reaches a fixed threshold deflection, i.e., $V(t_{p})=\\Delta V_{\\text{th}}$.\n- **Definitions**:\n    - Membrane time constant: $\\tau_{m}=R_{m}C_{m}$.\n    - Rheobase $I_{r}$: The asymptotic threshold current for very long pulses, $I_{r} = \\lim_{t_p \\to \\infty} I_{\\text{th}}(t_{p})$.\n    - Chronaxie $t_{c}$: The pulse duration at which the threshold current equals twice the rheobase, i.e., $I_{\\text{th}}(t_{c})=2I_{r}$.\n- **Experimental Data**:\n    - $I_{\\text{th}}(t_{p}=1.00\\,\\mathrm{ms})=20.0\\,\\mu\\mathrm{A}$.\n    - $I_{\\text{th}}(t_{p}=3.00\\,\\mathrm{ms})=11.43\\,\\mu\\mathrm{A}$.\n- **Required Output**: Report the numerical value of the chronaxie $t_{c}$ from part (3) in milliseconds, rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem uses the leaky integrate-and-fire model, which is a canonical and fundamentally sound model in computational neuroscience and biophysics. The governing equation is a direct application of Kirchhoff's circuit laws. This is scientifically grounded.\n- **Well-Posedness**: The problem describes a first-order linear ordinary differential equation with a constant forcing term and a specified initial condition. This system is well-posed and has a unique solution. The definitions of rheobase and chronaxie are standard and unambiguous. The tasks are mathematically well-defined.\n- **Objectivity**: The problem is stated using precise, quantitative, and objective language. There are no subjective or opinion-based claims.\n- **Completeness and Consistency**: The problem provides all necessary equations, initial conditions, definitions, and data to carry out the required derivations and calculations. The setup is internally consistent.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and complete. It is deemed **valid**. A rigorous solution will now be provided.\n\n---\n\n**1) Derivation of the Strength-Duration Relationship**\n\nWe begin with the given differential equation for the membrane potential $V(t)$:\n$$C_{m}\\,\\frac{dV}{dt}+\\frac{V}{R_{m}}=I$$\nThis equation is valid for the duration of the current pulse, $0 \\le t \\le t_{p}$. We divide by $C_{m}$ and introduce the membrane time constant $\\tau_{m} = R_{m}C_{m}$:\n$$\\frac{dV}{dt}+\\frac{V}{\\tau_{m}}=\\frac{I}{C_{m}}$$\nThis is a first-order linear ordinary differential equation. The homogeneous solution is $V_h(t) = A\\exp(-t/\\tau_m)$. A particular solution for a constant forcing term is the steady-state voltage, $V_{ss}$, which is found by setting $\\frac{dV}{dt}=0$:\n$$\\frac{V_{ss}}{R_{m}} = I \\implies V_{ss} = I R_m$$\nThe general solution is the sum of the homogeneous and particular solutions:\n$$V(t) = I R_{m} + A\\exp\\left(-\\frac{t}{\\tau_{m}}\\right)$$\nWe determine the integration constant $A$ using the initial condition $V(0)=0$:\n$$V(0) = 0 = I R_{m} + A\\exp(0) \\implies A = -I R_{m}$$\nSubstituting $A$ back into the general solution yields the voltage evolution during the pulse:\n$$V(t) = I R_{m} \\left(1 - \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)\\right)$$\nAn action potential is triggered if the voltage at the end of the pulse, $V(t_{p})$, reaches the threshold $\\Delta V_{\\text{th}}$. For a current just at the threshold amplitude, $I = I_{\\text{th}}(t_{p})$, this condition is met exactly:\n$$\\Delta V_{\\text{th}} = V(t_{p}) = I_{\\text{th}}(t_{p}) R_{m} \\left(1 - \\exp\\left(-\\frac{t_{p}}{\\tau_{m}}\\right)\\right)$$\nSolving for the threshold current $I_{\\text{th}}(t_{p})$ gives the strength-duration relationship:\n$$I_{\\text{th}}(t_{p}) = \\frac{\\Delta V_{\\text{th}}}{R_{m}\\left(1 - \\exp\\left(-\\frac{t_{p}}{\\tau_{m}}\\right)\\right)}$$\n\n**2) Expression for Rheobase ($I_r$) and Chronaxie ($t_c$)**\n\nThe rheobase, $I_{r}$, is the threshold current for an infinitely long pulse ($t_{p} \\to \\infty$). In this limit, the exponential term vanishes:\n$$I_{r} = \\lim_{t_{p}\\to\\infty} I_{\\text{th}}(t_{p}) = \\frac{\\Delta V_{\\text{th}}}{R_{m}\\left(1 - 0\\right)} = \\frac{\\Delta V_{\\text{th}}}{R_{m}}$$\nThe chronaxie, $t_{c}$, is the pulse duration $t_{p}$ for which the threshold current is twice the rheobase, $I_{\\text{th}}(t_{c}) = 2I_{r}$. Substituting the expressions for $I_{\\text{th}}$ and $I_{r}$:\n$$\\frac{\\Delta V_{\\text{th}}}{R_{m}\\left(1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)\\right)} = 2 \\left(\\frac{\\Delta V_{\\text{th}}}{R_{m}}\\right)$$\nWe cancel the common term $\\frac{\\Delta V_{\\text{th}}}{R_{m}}$ from both sides (assuming $\\Delta V_{\\text{th}} \\neq 0$ and $R_{m}$ is finite and non-zero):\n$$\\frac{1}{1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)} = 2$$\n$$1 = 2 \\left(1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)\\right)$$\n$$\\frac{1}{2} = 1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)$$\n$$\\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right) = \\frac{1}{2}$$\nTaking the natural logarithm of both sides:\n$$-\\frac{t_{c}}{\\tau_{m}} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)$$\n$$t_{c} = \\tau_{m}\\ln(2)$$\n\n**3) Estimation of $I_{r}$, $\\tau_{m}$, and $t_{c}$ from Data**\n\nThe strength-duration relationship can be written in terms of the rheobase $I_{r}$:\n$$I_{\\text{th}}(t_{p}) = \\frac{I_{r}}{1 - \\exp\\left(-\\frac{t_{p}}{\\tau_{m}}\\right)}$$\nWe are given two data points:\n1. $I_{1} = 20.0\\,\\mu\\mathrm{A}$ at $t_{1} = 1.00\\,\\mathrm{ms}$\n2. $I_{2} = 11.43\\,\\mu\\mathrm{A}$ at $t_{2} = 3.00\\,\\mathrm{ms}$\n\nThis forms a system of two nonlinear equations for the two unknowns, $I_{r}$ and $\\tau_{m}$:\n$$20.0 = \\frac{I_{r}}{1 - \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)}$$\n$$11.43 = \\frac{I_{r}}{1 - \\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right)}$$\nWe can express $I_{r}$ from both equations:\n$$I_{r} = 20.0 \\left(1 - \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)\\right)$$\n$$I_{r} = 11.43 \\left(1 - \\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right)\\right)$$\nEquating these two expressions for $I_{r}$:\n$$20.0 \\left(1 - \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)\\right) = 11.43 \\left(1 - \\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right)\\right)$$\nLet $x = \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)$. Then $\\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right) = \\left(\\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)\\right)^3 = x^3$. The equation becomes:\n$$20.0(1 - x) = 11.43(1 - x^3)$$\nUsing the identity $1 - x^3 = (1 - x)(1 + x + x^2)$:\n$$20.0(1 - x) = 11.43(1 - x)(1 + x + x^2)$$\nSince $\\tau_{m}  0$, $x = \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)$ is strictly between $0$ and $1$, so $1-x \\neq 0$. We can divide both sides by $(1 - x)$:\n$$20.0 = 11.43(1 + x + x^2)$$\n$$x^2 + x + 1 - \\frac{20.0}{11.43} = 0$$\nThis is a quadratic equation: $11.43x^2 + 11.43x - 8.57 = 0$. Using the quadratic formula $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$x = \\frac{-11.43 \\pm \\sqrt{11.43^2 - 4(11.43)(-8.57)}}{2(11.43)} = \\frac{-11.43 \\pm \\sqrt{130.6449 + 391.8024}}{22.86} = \\frac{-11.43 \\pm \\sqrt{522.4473}}{22.86}$$\n$$x = \\frac{-11.43 \\pm 22.857106}{22.86}$$\nSince $x$ must be positive, we take the positive root:\n$$x = \\frac{11.427106}{22.86} \\approx 0.499873$$\nFrom the definition of $x$:\n$$\\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right) = 0.499873$$\n$$-\\frac{1.00}{\\tau_{m}} = \\ln(0.499873) \\approx -0.693399$$\n$$\\tau_{m} \\approx \\frac{1.00}{0.693399} \\approx 1.4422\\,\\mathrm{ms}$$\nThe values provided suggest that the intended theoretical relation is exact. If we set $I_r = 10.0\\,\\mu\\mathrm{A}$, then $I_{\\text{th}}(1.00\\,\\mathrm{ms}) = 2I_r$, which by definition means $t_{p}=1.00\\,\\mathrm{ms}$ is the chronaxie. Let us verify this. If $t_c=1.00\\,\\mathrm{ms}$, then $t_c = \\tau_m \\ln(2)$ implies $\\tau_m = \\frac{t_c}{\\ln(2)} = \\frac{1.00}{\\ln(2)}\\,\\mathrm{ms}$. Let us check if this parameter set reproduces the second data point:\n$$I_{\\text{th}}(3.00\\,\\mathrm{ms}) = \\frac{I_r}{1 - \\exp(-3.00/\\tau_m)} = \\frac{10.0}{1 - \\exp(-3.00 \\ln(2) / 1.00)} = \\frac{10.0}{1 - \\exp(-3\\ln(2))}$$\n$$= \\frac{10.0}{1 - \\exp(\\ln(2^{-3}))} = \\frac{10.0}{1 - 2^{-3}} = \\frac{10.0}{1 - 1/8} = \\frac{10.0}{7/8} = \\frac{80.0}{7} \\approx 11.42857\\,\\mu\\mathrm{A}$$\nThis matches the given value of $11.43\\,\\mu\\mathrm{A}$. Therefore, the parameters are indeed $I_{r}=10.0\\,\\mu\\mathrm{A}$ and $t_c=1.00\\,\\mathrm{ms}$.\nThe time constant is $\\tau_{m} = \\frac{t_{c}}{\\ln(2)} = \\frac{1.00}{\\ln(2)} \\approx 1.443\\,\\mathrm{ms}$.\nThe chronaxie is $t_c = 1.00\\,\\mathrm{ms}$.\n\n**4) Biophysical Meaning of $I_r$ and $t_c$**\n\n- The **rheobase**, $I_r = \\frac{\\Delta V_{\\text{th}}}{R_m}$, represents the minimum current amplitude required to reach the voltage threshold, achievable only with a current pulse of infinite duration. It is a measure of the steady-state excitability. A lower $I_r$ indicates a more excitable neuron. $I_r$ is inversely proportional to the membrane resistance $R_m$. An increase in $R_m$ (e.g., by closing resting leak channels) reduces the current leakage across the membrane, so a smaller injected current is sufficient to depolarize the membrane to threshold. This decreases $I_r$, increasing excitability. Conversely, decreasing $R_m$ increases $I_r$. $I_r$ is independent of membrane capacitance $C_m$, as $C_m$ only affects the rate of voltage change, not the final steady-state voltage.\n\n- The **chronaxie**, $t_c = \\tau_m \\ln(2) = R_m C_m \\ln(2)$, represents the pulse duration required for a stimulus of twice the rheobasic strength to be effective. It is a measure of the temporal characteristics of excitability, reflecting how quickly the membrane can respond to a stimulus. A shorter $t_c$ indicates a faster-responding, more readily excitable membrane for brief stimuli. $t_c$ is directly proportional to the membrane time constant $\\tau_m$. An increase in either $R_m$ or $C_m$ will increase $\\tau_m$ and thus increase $t_c$. A larger $R_m$ slows the dissipation of charge, while a larger $C_m$ requires more charge to achieve the same potential change; both factors slow the membrane's voltage response and lengthen the chronaxie.\n\nThe problem asks only for the numerical value of the chronaxie $t_c$ from part (3), rounded to three significant figures. As calculated, $t_c = 1.00\\,\\mathrm{ms}$.", "answer": "$$\\boxed{1.00}$$", "id": "2570314"}, {"introduction": "While the RC model provides a valuable first approximation, the true generation of an action potential relies on the complex, voltage-dependent dance of ion channels. The Hodgkin-Huxley model provides the definitive quantitative description of this process, but how were its parameters determined? This practice places you in the role of an experimental electrophysiologist, tasked with designing a series of voltage-clamp experiments to systematically dissect the components of the action potential [@problem_id:2570324]. By leveraging pharmacological blockers and precisely designed voltage protocols, you will develop a protocol to isolate and characterize the sodium and potassium conductances, their gating kinetics, and reversal potentials, reinforcing the empirical foundation of modern neurophysiology.", "problem": "You are given a single isoform of a voltage-gated axon in a two-electrode voltage-clamp at temperature $T$ with fully defined internal and external ionic activities for sodium and potassium (so that the Nernst reversal potentials are predictable a priori), and near-complete series-resistance compensation. Pharmacological tools include tetrodotoxin (TTX) and tetraethylammonium (TEA), and leak subtraction can be performed by a standard $P/n$ procedure. Your goal is to design a protocol that, using only peak and steady-state currents recorded during voltage steps, permits extraction of the sodium reversal potential $E_{Na}$, the potassium reversal potential $E_{K}$, the leak conductance $g_{L}$, and the voltage dependence of the steady-state gating variables $m_{\\infty}(V)$, $h_{\\infty}(V)$, and $n_{\\infty}(V)$ under the classical Hodgkin–Huxley framework, assuming recording stability and negligible calcium-activated currents.\n\nWhich option(s) below provides a scientifically sound, self-consistent protocol that achieves this goal, relying exclusively on peak and steady-state currents and known ionic solutions?\n\nA. \n- Determine $g_{L}$: Hold at $-80\\,\\mathrm{mV}$; apply a family of small hyperpolarizing steps to $-85\\,\\mathrm{mV}$, $-90\\,\\mathrm{mV}$, and $-95\\,\\mathrm{mV}$. Use the steady-state current $I_{\\infty}$ versus $V$ relation to obtain the slope conductance; take the slope as $g_{L}$ after verifying minimal time-dependent currents.\n- Determine $E_{Na}$: In $10\\,\\mathrm{mM}$ external tetraethylammonium (TEA) to suppress potassium currents, prepulse to $-120\\,\\mathrm{mV}$ for $100\\,\\mathrm{ms}$ to remove inactivation, then briefly depolarize to $0\\,\\mathrm{mV}$ for $1\\,\\mathrm{ms}$ to open sodium channels. Immediately step to a series of test voltages between $-40\\,\\mathrm{mV}$ and $+60\\,\\mathrm{mV}$ and measure the instantaneous tail current at the start of each test step; the test voltage at which the tail current changes sign estimates $E_{Na}$ (after leak subtraction and liquid-junction correction).\n- Determine $E_{K}$: In $1\\,\\mu\\mathrm{M}$ tetrodotoxin (TTX), apply $200\\,\\mathrm{ms}$ depolarizations to a series of voltages from $-40\\,\\mathrm{mV}$ to $+40\\,\\mathrm{mV}$ to reach steady-state potassium activation, then step to a range of tail voltages between $-100\\,\\mathrm{mV}$ and $-40\\,\\mathrm{mV}$; identify the tail voltage with zero instantaneous tail current as $E_{K}$ (after leak subtraction). Alternatively, locate the zero crossing of the steady-state $I$–$V$ relation.\n- Determine $m_{\\infty}(V)$: With potassium suppressed by TEA, hold at $-120\\,\\mathrm{mV}$, then deliver $5\\,\\mathrm{ms}$ test steps from $-70\\,\\mathrm{mV}$ to $+50\\,\\mathrm{mV}$ and measure the peak inward current early in the step. Convert peak current to peak conductance using the measured $E_{Na}$ and divide by the asymptotic maximal peak conductance at large depolarizations to obtain the fractional activation; infer $m_{\\infty}(V)$ from the cubic relationship of sodium activation.\n- Determine $h_{\\infty}(V)$: With potassium suppressed by TEA and a fixed $10\\,\\mathrm{ms}$ test pulse to $-10\\,\\mathrm{mV}$, precede the test by $200\\,\\mathrm{ms}$ conditioning prepulses between $-130\\,\\mathrm{mV}$ and $-40\\,\\mathrm{mV}$. Normalize the peak test currents by the value obtained after the most negative conditioning pulse to obtain availability versus conditioning voltage; interpret this fraction as $h_{\\infty}(V)$.\n- Determine $n_{\\infty}(V)$: In TTX, apply long ($\\geq 200\\,\\mathrm{ms}$) steps to voltages between $-50\\,\\mathrm{mV}$ and $+40\\,\\mathrm{mV}$ and measure steady-state outward current. Convert to conductance using $E_{K}$, normalize by the maximal steady-state conductance at saturating depolarizations, and use the fourth-root transformation to infer $n_{\\infty}(V)$.\n\nB.\n- Determine $g_{L}$ from the slope of the steady-state current at depolarized voltages between $0\\,\\mathrm{mV}$ and $+40\\,\\mathrm{mV}$ without blockers.\n- Determine $E_{Na}$ from the voltage at which the peak inward current during a depolarizing step crosses zero in control saline containing both sodium and potassium conductances, without leak subtraction.\n- Determine $E_{K}$ from the most negative voltage at which the peak current remains outward during a depolarizing step, assuming this crossing reflects potassium reversal.\n- Determine $m_{\\infty}(V)$ and $n_{\\infty}(V)$ by directly normalizing the peak currents by driving force, without pharmacological isolation, and assign $h_{\\infty}(V)$ as $1 - m_{\\infty}(V)$.\n\nC.\n- Determine $g_{L}$ by $P/4$ subtraction using subpulses scaled from the largest depolarizing step to $+40\\,\\mathrm{mV}$ and take the residual slope of the leak-subtracted $I$–$V$ as leak.\n- Determine $E_{Na}$ by stepping to a range of voltages from $-80\\,\\mathrm{mV}$ to $+60\\,\\mathrm{mV}$ and finding the zero-current crossing of the peak inward current under control conditions; confirm the value by comparing with the Nernst prediction from known activities.\n- Determine $E_{K}$ by replacing external sodium with an impermeant cation and equating the zero-current crossing of the steady-state current to $E_{K}$, without sodium block.\n- Determine $m_{\\infty}(V)$ and $n_{\\infty}(V)$ by fitting the voltage dependence of peak and steady-state currents to sigmoids, without transforming to conductance or normalizing by maximal values. Estimate $h_{\\infty}(V)$ as the ratio of steady-state to peak current during depolarizations.\n\nD.\n- Use current clamp to elicit action potentials from different holding potentials. Identify threshold voltage and spike amplitude to estimate $E_{Na}$ and $E_{K}$.\n- Fit the upstroke slope to estimate $m_{\\infty}(V)$ and the afterhyperpolarization depth to estimate $n_{\\infty}(V)$. Set $g_{L}$ from the resting input resistance measured in current clamp.\n- Infer $h_{\\infty}(V)$ from the degree of spike-frequency adaptation during a long depolarizing current pulse.\n\nE.\n- Determine $g_{L}$ from the slope of the steady-state $I$-$V$ relation between $-100\\,\\mathrm{mV}$ and $-70\\,\\mathrm{mV}$ using small hyperpolarizing steps.\n- Determine $E_{Na}$ by TTX block of sodium, measuring the zero crossing of the residual inward current during depolarizations.\n- Determine $E_{K}$ in the presence of TEA by measuring the reversal of peak outward current during strong depolarizations.\n- Determine $m_{\\infty}(V)$ from the steady-state current during long depolarizations with TEA present and $n_{\\infty}(V)$ from the peak outward current in control; assign $h_{\\infty}(V)$ from the complement of $m_{\\infty}(V)$.\n\nSelect all that apply. Provide no additional justification in your final answer beyond the option letter(s).", "solution": "The problem statement describes a classical biophysical experiment based on the Hodgkin-Huxley model of the axon. The goal is to design a set of voltage-clamp protocols to determine key parameters of the model: the leak conductance ($g_L$), the reversal potentials for sodium ($E_{Na}$) and potassium ($E_K$), and the voltage-dependence of the steady-state gating variables for sodium activation ($m_{\\infty}(V)$), sodium inactivation ($h_{\\infty}(V)$), and potassium activation ($n_{\\infty}(V)$). The provided tools and assumptions—voltage clamp, specific pharmacological blockers (TTX and TEA), known ionic activities, leak subtraction, and negligible calcium currents—are standard and sufficient for this task. The problem statement is therefore scientifically sound, well-posed, and free of contradictions.\n\nThe total ionic current ($I_{ion}$) under the Hodgkin-Huxley framework is given by the sum of the sodium, potassium, and leak currents:\n$$I_{ion} = I_{Na} + I_{K} + I_{L}$$\nThese components are defined as:\n$$I_{Na} = \\bar{g}_{Na} m^3 h (V - E_{Na})$$\n$$I_{K} = \\bar{g}_{K} n^4 (V - E_{K})$$\n$$I_{L} = g_{L} (V - E_{L})$$\nwhere $\\bar{g}_{Na}$ and $\\bar{g}_{K}$ are the maximal conductances, $g_{L}$ is the leak conductance, $V$ is the membrane potential, and $E_{ion}$ are the Nernst reversal potentials. The gating variables $m$, $h$, and $n$ represent probabilities and their steady-state values ($m_{\\infty}$, $h_{\\infty}$, $n_{\\infty}$) as a function of voltage are the target of measurement. A valid protocol must correctly isolate each current component and use appropriate voltage steps to measure the parameters.\n\nWe will now evaluate each option.\n\n**Option A Evaluation**\n- **$g_{L}$ determination**: This protocol proposes measuring the current-voltage ($I$-$V$) relationship in a voltage range where voltage-gated channels are expected to be closed (e.g., steps from $-80\\,\\mathrm{mV}$ to more negative potentials). In this range, the membrane current is dominated by the leak current $I_{L} = g_{L}(V - E_{L})$. The slope of the $I$-$V$ curve, $dI/dV$, is therefore an excellent measure of $g_{L}$. This is a standard and correct method.\n- **$E_{Na}$ determination**: The protocol describes using TEA to block potassium channels, thereby isolating the sodium current. It then employs a classic tail-current protocol. A prepulse to $-120\\,\\mathrm{mV}$ removes inactivation (sets $h \\approx 1$), a brief depolarization to $0\\,\\mathrm{mV}$ activates the channels (opens $m$ gates), and subsequent steps to various test potentials are used to measure the instantaneous current. This instantaneous current, $I_{tail}$, is given by $I_{tail} = g_{Na}(V_{test} - E_{Na})$, where $g_{Na}$ is the large, fixed conductance at the moment of the voltage step. The voltage $V_{test}$ at which $I_{tail} = 0$ is, by definition, $E_{Na}$. This is the most accurate method for determining a reversal potential. The mention of leak subtraction and junction potential correction confirms a rigorous approach. This is correct.\n- **$E_{K}$ determination**: This applies the same tail-current logic to the potassium current. TTX is used to block sodium channels. A long depolarizing pulse activates potassium channels (opens $n$ gates). The reversal potential is then found by stepping to various tail potentials and identifying the voltage where the instantaneous tail current is zero. This is correct. The alternative suggestion of using the zero-crossing of the steady-state $I$-$V$ curve is theoretically possible for a non-inactivating current like $I_K$, but it is often less precise because the K$^{+}$ conductance is very low near the typical $E_K$ (around $-90\\,\\mathrm{mV}$). However, the primary proposed method is sound. This is correct.\n- **$m_{\\infty}(V)$ determination**: The protocol correctly proposes to isolate $I_{Na}$ with TEA, remove inactivation with a hyperpolarizing prepulse, and then measure the peak inward current $I_{Na,peak}$ over a range of test potentials $V$. The peak current is a good approximation for the current when activation ($m$) is maximal for that voltage and inactivation ($h$) has not yet become significant. The peak conductance is calculated as $g_{Na,peak}(V) = I_{Na,peak}(V) / (V - E_{Na})$. Normalizing this to its maximum value gives $g_{Na,peak}(V)/g_{Na,max} \\approx m_{\\infty}^3(V)$. From this, $m_{\\infty}(V)$ can be determined by taking the cube root. This is the standard, correct procedure.\n- **$h_{\\infty}(V)$ determination**: This describes the standard two-pulse protocol for measuring steady-state inactivation. A long conditioning prepulse to a voltage $V_{cond}$ sets the level of inactivation to $h_{\\infty}(V_{cond})$. A subsequent test pulse measures the fraction of channels available to open. By normalizing the peak current from the test pulse to the maximum peak current (obtained after a prepulse to a very negative potential where $h_{\\infty} \\approx 1$), one directly obtains the curve $h_{\\infty}(V)$. This must be done in TEA to isolate $I_{Na}$. This is correct.\n- **$n_{\\infty}(V)$ determination**: The protocol correctly proposes to isolate $I_{K}$ with TTX and measure the steady-state current $I_{K,ss}$ from long voltage steps. The steady-state conductance is $g_{K,ss}(V) = I_{K,ss}(V) / (V - E_{K})$. Normalizing this by the maximal potassium conductance gives $g_{K,ss}(V)/\\bar{g}_{K} = n_{\\infty}^4(V)$. One then takes the fourth root to find $n_{\\infty}(V)$. This is correct.\n\nAll parts of this protocol are scientifically sound and represent the canonical methods for characterizing Hodgkin-Huxley parameters.\n**Verdict: Correct**\n\n**Option B Evaluation**\n- **$g_{L}$ determination**: Measuring slope at depolarized potentials without blockers is incorrect. In this range, $g_K$ is large and time-variant, so the slope would primarily reflect potassium conductance, not leak.\n- **$E_{Na}$ determination**: The zero-crossing of the peak *total* current is not $E_{Na}$. At the voltage $V = E_{Na}$, the sodium current is zero, but the outward potassium and leak currents are not. Thus, the total current would be outward, not zero.\n- **$E_{K}$ determination**: This method is vaguely described and fundamentally incorrect. The peak current is dominated by the inward sodium current for most relevant voltages.\n- **Gating variables determination**: Normalizing mixed currents is invalid. The relationship $h_{\\infty}(V) = 1 - m_{\\infty}(V)$ is false; activation and inactivation are separate biophysical processes with different voltage dependencies.\n**Verdict: Incorrect**\n\n**Option C Evaluation**\n- **$g_{L}$ determination**: A $P/n$ procedure *subtracts* the leak current; it does not measure it. The procedure described is nonsensical.\n- **$E_{Na}$ determination**: This repeats the error from option B, equating the reversal of the total peak current with $E_{Na}$.\n- **$E_{K}$ determination**: Replacing external Na$^{+}$ removes $I_{Na}$, but the zero-crossing of the remaining steady-state current ($I_K + I_L$) occurs where $I_K = -I_L$, which is not $E_K$ unless $E_L = E_K$, an unlikely coincidence.\n- **Gating variables determination**: Fitting raw currents to sigmoids without converting to conductance is wrong, as the current is a product of conductance and driving force ($V - E_{ion}$). The suggested estimation for $h_{\\infty}(V)$ is also non-standard and inaccurate.\n**Verdict: Incorrect**\n\n**Option D Evaluation**\n- The entire protocol relies on **current-clamp** experiments. The problem explicitly states the experiment is to be performed in **voltage-clamp** and that parameters must be extracted from voltage steps. This option violates the fundamental constraints of the problem. Furthermore, the proposed methods (e.g., estimating $E_{Na}$ from spike peak) are approximations, not the precise measurements achievable with voltage clamp.\n**Verdict: Incorrect**\n\n**Option E Evaluation**\n- **$E_{Na}$ determination**: This suggests measuring $E_{Na}$ after blocking the sodium current with TTX. This is illogical. If $I_{Na}$ is blocked, its reversal potential cannot be measured.\n- **$E_{K}$ determination**: Similarly, this suggests measuring $E_K$ after blocking the potassium current with TEA. This is also illogical.\n- **$m_{\\infty}(V)$ determination**: Using steady-state current to determine $m_{\\infty}(V)$ is incorrect because this current is contaminated by inactivation ($h_{\\infty}(V)$). One must use the peak current.\n- **$n_{\\infty}(V)$ determination**: \"Peak outward current\" is ambiguous and does not represent an isolated potassium conductance.\n- **$h_{\\infty}(V)$ determination**: The relation $h_{\\infty}(V) = 1 - m_{\\infty}(V)$ is fundamentally incorrect.\n**Verdict: Incorrect**\n\nBased on this analysis, only Option A details a complete, scientifically valid, and internally consistent set of protocols that correctly adheres to the principles of voltage-clamp analysis within the Hodgkin-Huxley framework.", "answer": "$$\\boxed{A}$$", "id": "2570324"}, {"introduction": "An action potential's true power lies in its ability to propagate faithfully along an axon, transmitting information over long distances. To understand this dynamic process, we must extend our single-point model into the spatial domain by using the cable equation. This final practice is a comprehensive computational exercise: you will build a full Hodgkin-Huxley simulation of an unmyelinated axon from first principles [@problem_id:2570337]. This powerful in-silico tool will allow you to observe a traveling action potential emerge and to investigate how pathological conditions, such as a graded loss of sodium channels, can impair conduction velocity and ultimately lead to propagation failure.", "problem": "You are to implement a one-dimensional, unmyelinated axon model with voltage-gated sodium and potassium channels that follows the canonical Hodgkin–Huxley formalism. The fundamental basis is the conservation of charge across a cylindrical membrane segment, the definition of axial current by Ohm’s law, and first-order kinetics for voltage-dependent channel gates. Use the following well-tested facts and definitions as the foundation: (i) the membrane behaves as a capacitor with specific capacitance $C_m$ that scales with membrane area, (ii) each voltage-gated current density is the product of a maximal conductance density and a gating variable function of voltage multiplied by the driving force, and (iii) axial coupling between adjacent compartments follows Ohm’s law with axial resistance computed from cable geometry and cytoplasmic resistivity.\n\nModel the axon as $N$ isopotential cylindrical compartments of equal length $\\Delta x$ and radius $a$. In each compartment $i$, membrane potential $V_i(t)$ evolves by conservation of charge:\nthe total membrane capacitance of compartment $i$ times $\\mathrm{d}V_i/\\mathrm{d}t$ equals the algebraic sum of axial currents to neighbors, external stimulus current, and transmembrane ionic currents (with the sign convention that outward ionic current is positive). Use sealed-end boundary conditions (no axial current to the outside of the cable ends). Maximal sodium conductance density is graded linearly along the axon to model partial sodium channel block:\n$$ \\bar{g}_{Na}(x) = \\bar{g}_{Na,0}\\,\\max\\!\\left(0,\\,1 - s\\,\\frac{x}{L}\\right), $$\nwhere $s \\in [0,1]$ is the fractional drop at the distal end, $x$ is axial position, and $L$ is the total length. All other parameters are uniform.\n\nNumerical integration requirement:\n- Discretize in space with compartments of equal $\\Delta x$ determined by a target spatial resolution and the specified length $L$; choose $N$ so that $\\Delta x$ is approximately the target.\n- Integrate in time with an explicit forward-Euler method with fixed time step $\\Delta t$.\n- Gating variables for sodium activation $m$, sodium inactivation $h$, and potassium activation $n$ obey first-order kinetics $\\mathrm{d}y/\\mathrm{d}t = \\alpha_y(V)(1-y) - \\beta_y(V)\\,y$ for $y \\in \\{m,h,n\\}$, with the classical Hodgkin–Huxley rate functions.\n\nBiophysical and numerical constants to use (express all quantities in the indicated units):\n- Axon radius: $a = 0.025\\,\\mathrm{cm}$.\n- Axial (intracellular) resistivity: $R_i = 0.0354\\,\\mathrm{k}\\Omega\\cdot\\mathrm{cm}$.\n- Specific capacitance: $C_m = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$.\n- Maximal conductance densities: $\\bar{g}_{Na,0} = 120\\,\\mathrm{mS}/\\mathrm{cm}^2$, $\\bar{g}_K = 36\\,\\mathrm{mS}/\\mathrm{cm}^2$, $\\bar{g}_L = 0.3\\,\\mathrm{mS}/\\mathrm{cm}^2$.\n- Reversal potentials: $E_{Na} = 50\\,\\mathrm{mV}$, $E_K = -77\\,\\mathrm{mV}$, $E_L = -54.4\\,\\mathrm{mV}$.\n- Initial conditions: $V_i(0) = -65\\,\\mathrm{mV}$ for all $i$, and $m,h,n$ initialized to their steady-state values at $V=-65\\,\\mathrm{mV}$.\n- Stimulation: a square current density pulse applied only to the first compartment (the most proximal end) with amplitude $I_{stim} = 20\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$ from time $t_{on} = 1.0\\,\\mathrm{ms}$ to $t_{off} = 1.5\\,\\mathrm{ms}$, zero elsewhere.\n- Spatial resolution target: $\\Delta x_{target} = 0.005\\,\\mathrm{cm}$; set $N = \\lfloor L/\\Delta x_{target} \\rfloor + 1$ and define $\\Delta x = L/(N-1)$.\n- Time step: $\\Delta t = 0.01\\,\\mathrm{ms}$.\n- Total simulation time: $T = 12.0\\,\\mathrm{ms}$.\n- Boundary conditions: sealed ends (no axial current to outside at either end).\n\nImplement Hodgkin–Huxley rate functions using $V$ in $\\mathrm{mV}$ and $t$ in $\\mathrm{ms}$:\n- $\\alpha_m(V) = 0.1\\,(V+40)/\\left(1 - e^{-(V+40)/10}\\right)$, $\\beta_m(V) = 4\\,e^{-(V+65)/18}$.\n- $\\alpha_h(V) = 0.07\\,e^{-(V+65)/20}$, $\\beta_h(V) = \\dfrac{1}{1 + e^{-(V+35)/10}}$.\n- $\\alpha_n(V) = 0.01\\,(V+55)/\\left(1 - e^{-(V+55)/10}\\right)$, $\\beta_n(V) = 0.125\\,e^{-(V+65)/80}$.\nNumerically regularize divisions at singular points by using the corresponding smooth limits.\n\nGeometric and circuit relations (in consistent mixed units as specified):\n- Compartment membrane area $A = 2\\pi a\\,\\Delta x$ (in $\\mathrm{cm}^2$); total compartment capacitance $C = C_m A$ (in $\\mu\\mathrm{F}$).\n- Axial resistance between adjacent compartments $R_{ax} = R_i\\,\\Delta x / (\\pi a^2)$ (in $\\mathrm{k}\\Omega$). The axial current between compartments $i$ and $j$ is $(V_j - V_i)/R_{ax}$ (in $\\mu\\mathrm{A}$), which, together with ionic and stimulus currents in $\\mu\\mathrm{A}$, yields $\\mathrm{d}V/\\mathrm{d}t$ in $\\mathrm{mV}/\\mathrm{ms}$ via $C\\,\\mathrm{d}V/\\mathrm{d}t = \\sum I$.\n\nFor each simulation, determine:\n- Conduction success: whether the distal end compartment (index $N-1$) exhibits an upward threshold crossing at $V=0\\,\\mathrm{mV}$ by time $T$.\n- Conduction velocity: if a traveling action potential is observed, record the first upward threshold crossing times $t_1$ and $t_2$ at positions $x_1 = 0.2\\,L$ and $x_2 = 0.8\\,L$ (rounded to the nearest compartments). Compute velocity $v = (x_2 - x_1)/(t_2 - t_1)$ expressed in $\\mathrm{m}/\\mathrm{s}$, where distances are converted from $\\mathrm{cm}$ to $\\mathrm{m}$ and times from $\\mathrm{ms}$ to $\\mathrm{s}$. If either crossing is absent, define the velocity as $v = 0.0$.\n\nFailure threshold with respect to graded sodium block:\n- For a fixed set of parameters and axon length $L$, define the failure threshold $s^\\star$ as the supremum of $s \\in [0, s_{max}]$ for which conduction success occurs, where $s_{max} = 0.95$. Approximate $s^\\star$ by bisection on $[0, s_{max}]$ for a fixed number of iterations, assuming monotonic loss of conduction with increasing $s$. If success holds at $s_{max}$, report $s^\\star = s_{max}$; if failure holds at $s=0$, report $s^\\star = 0.0$.\n\nTest suite:\nRun your program for the following four parameter sets, each specifying the axon length $L$ (in $\\mathrm{cm}$) and the baseline graded sodium block parameter $s_{base}$ used to compute the baseline conduction velocity and success flag. For each case, also compute $s^\\star$ via bisection as defined above.\n- Case A: $L = 1.0\\,\\mathrm{cm}$, $s_{base} = 0.0$.\n- Case B: $L = 1.0\\,\\mathrm{cm}$, $s_{base} = 0.4$.\n- Case C: $L = 1.0\\,\\mathrm{cm}$, $s_{base} = 0.7$.\n- Case D: $L = 0.5\\,\\mathrm{cm}$, $s_{base} = 0.8$.\n\nAnswer specification:\n- For each case, produce a list $[v, \\mathrm{success}, s^\\star]$, where $v$ is the baseline conduction velocity in $\\mathrm{m}/\\mathrm{s}$ rounded to three decimals, $\\mathrm{success}$ is a boolean indicating whether the distal end crosses $0\\,\\mathrm{mV}$ by time $T$, and $s^\\star$ is the failure threshold rounded to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list of these four per-case lists, enclosed in square brackets. For example, a valid output format is\n\"[ [v_A,success_A,sstar_A],[v_B,success_B,sstar_B],[v_C,success_C,sstar_C],[v_D,success_D,sstar_D] ]\"\nwith no extra whitespace requirements beyond being valid Python list syntax.", "solution": "The problem proposed is a standard, well-posed exercise in computational biophysics. It requests the implementation of the Hodgkin-Huxley model for an unmyelinated axon, which is a cornerstone of quantitative neurophysiology. All provided parameters, equations, and boundary conditions are scientifically sound and internally consistent. The problem is free of factual errors, contradictions, or ambiguities that would render it invalid. We therefore proceed with a complete solution.\n\nThe core of the problem is to solve a system of coupled partial differential equations describing the spatiotemporal evolution of the membrane potential $V(x,t)$ along an axon of length $L$. The axon is treated as a one-dimensional cable. The governing equation, based on conservation of charge for a segment of membrane, is the cable equation:\n$$ C_m \\frac{\\partial V}{\\partial t} = \\frac{a}{2 R_i} \\frac{\\partial^2 V}{\\partial x^2} - J_{ion}(V, m, h, n) + J_{stim}(x, t) $$\nwhere $C_m$ is the specific membrane capacitance, $a$ is the axon radius, and $R_i$ is the intracellular resistivity. The term $J_{ion}$ represents the total ionic current density across the membrane, and $J_{stim}$ is the externally applied stimulus current density.\n\nThe ionic current density $J_{ion}$ is the sum of currents through sodium ($Na$), potassium ($K$), and leak ($L$) channels:\n$$ J_{ion} = J_{Na} + J_K + J_L $$\nEach current density is defined by Ohm's law, where the conductance is voltage-dependent for sodium and potassium channels:\n$$ J_{Na} = \\bar{g}_{Na}(x) m^3 h (V - E_{Na}) $$\n$$ J_K = \\bar{g}_K n^4 (V - E_K) $$\n$$ J_L = \\bar{g}_L (V - E_L) $$\nHere, $\\bar{g}_{Na}(x)$, $\\bar{g}_K$, and $\\bar{g}_L$ are the maximal conductance densities. $E_{Na}$, $E_K$, and $E_L$ are the Nernst equilibrium potentials for the respective ions. The sodium conductance is specified to be spatially graded:\n$$ \\bar{g}_{Na}(x) = \\bar{g}_{Na,0}\\,\\max\\!\\left(0,\\,1 - s\\,\\frac{x}{L}\\right) $$\nThe variables $m$, $h$, and $n$ are dimensionless gating variables, representing sodium channel activation, sodium channel inactivation, and potassium channel activation, respectively. Their dynamics are described by first-order ordinary differential equations:\n$$ \\frac{dy}{dt} = \\alpha_y(V)(1-y) - \\beta_y(V)y, \\quad y \\in \\{m, h, n\\} $$\nThe voltage-dependent rate functions $\\alpha_y(V)$ and $\\beta_y(V)$ are given by the standard Hodgkin-Huxley empirical formulae:\n$$ \\alpha_m(V) = \\frac{0.1(V+40)}{1 - e^{-(V+40)/10}}, \\quad \\beta_m(V) = 4e^{-(V+65)/18} $$\n$$ \\alpha_h(V) = 0.07e^{-(V+65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}} $$\n$$ \\alpha_n(V) = \\frac{0.01(V+55)}{1 - e^{-(V+55)/10}}, \\quad \\beta_n(V) = 0.125e^{-(V+65)/80} $$\nSingularities in $\\alpha_m(V)$ at $V=-40\\,\\mathrm{mV}$ and $\\alpha_n(V)$ at $V=-55\\,\\mathrm{mV}$ are handled by taking their mathematical limits, which are $1.0$ and $0.1$, respectively.\n\nTo solve this system numerically, we employ the method of lines. First, we discretize the spatial domain $x \\in [0, L]$ into $N$ compartments of equal length $\\Delta x = L/(N-1)$. The membrane potential in the $i$-th compartment is denoted $V_i(t) \\equiv V(x_i, t)$, where $x_i = i\\Delta x$ for $i=0, 1, \\dots, N-1$. The spatial second derivative $\\partial^2 V / \\partial x^2$ is approximated using a standard central difference formula. At the boundaries ($x=0$ and $x=L$), sealed-end conditions imply zero axial current, which is equivalent to a zero-flux Neumann boundary condition, $\\partial V / \\partial x = 0$. This is implemented using ghost points, leading to specific forms for the discretized Laplacian at the endpoints. The semi-discretized system becomes a large set of coupled ordinary differential equations (ODEs), one for each state variable ($V_i, m_i, h_i, n_i$) in each compartment.\n\nFor an internal compartment ($0  i  N-1$):\n$$ \\frac{dV_i}{dt} = \\frac{1}{C_m}\\left( \\frac{a}{2R_i(\\Delta x)^2}(V_{i-1} - 2V_i + V_{i+1}) - J_{ion, i} \\right) $$\nFor the first compartment ($i=0$), with stimulus $J_{stim,0}$:\n$$ \\frac{dV_0}{dt} = \\frac{1}{C_m}\\left( \\frac{a}{2R_i(\\Delta x)^2}(2V_1 - 2V_0) - J_{ion, 0} + J_{stim,0} \\right) $$\nFor the last compartment ($i=N-1$):\n$$ \\frac{dV_{N-1}}{dt} = \\frac{1}{C_m}\\left( \\frac{a}{2R_i(\\Delta x)^2}(2V_{N-2} - 2V_{N-1}) - J_{ion, N-1} \\right) $$\nThe gating variable ODEs are localized to each compartment:\n$$ \\frac{dy_i}{dt} = \\alpha_y(V_i)(1-y_i) - \\beta_y(V_i)y_i, \\quad y \\in \\{m, h, n\\} $$\n\nThis system of ODEs is integrated in time using the explicit forward-Euler method with a fixed time step $\\Delta t$:\n$$ Y(t+\\Delta t) = Y(t) + \\Delta t \\cdot \\frac{dY}{dt}|_{t} $$\nwhere $Y$ is the state vector containing all $V_i, m_i, h_i, n_i$.\n\nThe computational procedure is as follows:\n$1$. Initialize all state variables: $V_i(0) = -65\\,\\mathrm{mV}$, and $m_i, h_i, n_i$ are set to their steady-state values $y_{\\infty}(V) = \\alpha_y(V)/(\\alpha_y(V) + \\beta_y(V))$ at $V=-65\\,\\mathrm{mV}$.\n$2$. Iterate through time from $t=0$ to $T$ with step $\\Delta t$. In each step:\n   a. Calculate all derivatives $\\mathrm{d}V_i/\\mathrm{d}t$, $\\mathrm{d}m_i/\\mathrm{d}t$, $\\mathrm{d}h_i/\\mathrm{d}t$, $\\mathrm{d}n_i/\\mathrm{d}t$ based on the state at the current time $t$.\n   b. Update all state variables to their values at time $t+\\Delta t$ using the Euler formula.\n   c. Record threshold crossings ($V=0\\,\\mathrm{mV}$) at specified locations to determine conduction success and velocity.\n$3$. Conduction velocity $v$ is calculated as $v = \\Delta x_{eff} / \\Delta t_{cross}$, where $\\Delta x_{eff}$ is the distance between measurement points ($x=0.2L$ and $x=0.8L$) and $\\Delta t_{cross}$ is the time difference of their first upward threshold crossings. If any crossing is missed, $v=0.0$.\n$4$. The failure threshold $s^\\star$ is found using a bisection search on the interval $[0, 0.95]$. A simulation is run at the midpoint $s_{mid}$. If conduction succeeds, the lower bound of the search is updated to $s_{mid}$; otherwise, the upper bound is updated. This is repeated for a fixed number of iterations ($15$) sufficient to achieve the required precision.\n\nThis algorithm is implemented for each test case to produce the required output.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Hodgkin-Huxley axon model.\n    \"\"\"\n\n    class HodgkinHuxleyAxon:\n        \"\"\"\n        Implements a one-dimensional Hodgkin-Huxley axon model.\n        \"\"\"\n        def __init__(self, L, s, dt=0.01, dx_target=0.005, T=12.0):\n            # Physical parameters\n            self.L = float(L)  # Axon length [cm]\n            self.s = float(s)    # Sodium channel block parameter\n            self.a = 0.025   # Radius [cm]\n            self.R_i = 0.0354 # Axial resistivity [kOhm.cm]\n            self.C_m = 1.0     # Membrane capacitance [uF/cm^2]\n\n            # Conductances and potentials\n            self.g_Na_bar0 = 120.0 # [mS/cm^2]\n            self.g_K_bar = 36.0    # [mS/cm^2]\n            self.g_L_bar = 0.3     # [mS/cm^2]\n            self.E_Na = 50.0       # [mV]\n            self.E_K = -77.0       # [mV]\n            self.E_L = -54.4       # [mV]\n            self.V_rest = -65.0    # [mV]\n\n            # Stimulation\n            self.I_stim_amp = 20.0 # [uA/cm^2]\n            self.t_on = 1.0        # [ms]\n            self.t_off = 1.5       # [ms]\n\n            # Numerical parameters\n            self.dt = dt           # [ms]\n            self.T = T             # [ms]\n            \n            # Spatial discretization\n            self.N = int(np.floor(self.L / dx_target)) + 1\n            if self.N  2: self.N = 2 # Ensure at least 2 compartments for propagation\n            self.dx = self.L / (self.N - 1)\n            self.x = np.linspace(0, self.L, self.N)\n\n            # Graded sodium conductance\n            self.g_Na_bar = self.g_Na_bar0 * np.maximum(0, 1 - self.s * self.x / self.L)\n            self.g_Na_bar = self.g_Na_bar.reshape(-1, 1)\n\n        # Gating variable rate functions\n        def alpha_m(self, V):\n            V_term = V + 40.0\n            if np.any(np.abs(V_term)  1e-6): # Regularize singularity\n                return np.where(np.abs(V_term)  1e-6, 1.0, 0.1 * V_term / (1.0 - np.exp(-V_term / 10.0)))\n            return 0.1 * V_term / (1.0 - np.exp(-V_term / 10.0))\n        def beta_m(self, V): return 4.0 * np.exp(-(V + 65.0) / 18.0)\n        def alpha_h(self, V): return 0.07 * np.exp(-(V + 65.0) / 20.0)\n        def beta_h(self, V): return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n        def alpha_n(self, V):\n            V_term = V + 55.0\n            if np.any(np.abs(V_term)  1e-6): # Regularize singularity\n                return np.where(np.abs(V_term)  1e-6, 0.1, 0.01 * V_term / (1.0 - np.exp(-V_term / 10.0)))\n            return 0.01 * V_term / (1.0 - np.exp(-V_term / 10.0))\n        def beta_n(self, V): return 0.125 * np.exp(-(V + 65.0) / 80.0)\n        \n        def run(self):\n            \"\"\"Runs the simulation and returns conduction velocity and success.\"\"\"\n            # Initialize state variables\n            V = np.full((self.N, 1), self.V_rest)\n            m = np.full((self.N, 1), self.alpha_m(self.V_rest) / (self.alpha_m(self.V_rest) + self.beta_m(self.V_rest)))\n            h = np.full((self.N, 1), self.alpha_h(self.V_rest) / (self.alpha_h(self.V_rest) + self.beta_h(self.V_rest)))\n            n = np.full((self.N, 1), self.alpha_n(self.V_rest) / (self.alpha_n(self.V_rest) + self.beta_n(self.V_rest)))\n\n            time_steps = np.arange(0, self.T, self.dt)\n            \n            # Setup for tracking outputs\n            v_thresh = 0.0\n            distal_crossed = False\n            idx1 = int(round(0.2 * self.L / self.dx))\n            idx2 = int(round(0.8 * self.L / self.dx))\n            t_cross_1, t_cross_2 = -1.0, -1.0\n\n            coeff_axial = self.a / (2.0 * self.R_i * self.dx**2)\n\n            for t in time_steps:\n                V_prev = np.copy(V)\n\n                # Stimulus current density\n                I_stim = np.zeros((self.N, 1))\n                if self.t_on = t  self.t_off:\n                    I_stim[0] = self.I_stim_amp\n\n                # Ionic current densities\n                I_Na = self.g_Na_bar * (m**3) * h * (V - self.E_Na)\n                I_K = self.g_K_bar * (n**4) * (V - self.E_K)\n                I_L = self.g_L_bar * (V - self.E_L)\n                I_ion = I_Na + I_K + I_L\n\n                # Discretized Laplacian for axial current\n                laplacian_V = np.zeros((self.N, 1))\n                laplacian_V[1:-1] = V[:-2] - 2 * V[1:-1] + V[2:]\n                laplacian_V[0] = 2 * (V[1] - V[0]) # Sealed-end BC\n                laplacian_V[-1] = 2 * (V[-2] - V[-1]) # Sealed-end BC\n\n                # Derivatives using current state\n                dV_dt = (1.0 / self.C_m) * (coeff_axial * laplacian_V - I_ion + I_stim)\n                dm_dt = self.alpha_m(V) * (1.0 - m) - self.beta_m(V) * m\n                dh_dt = self.alpha_h(V) * (1.0 - h) - self.beta_h(V) * h\n                dn_dt = self.alpha_n(V) * (1.0 - n) - self.beta_n(V) * n\n\n                # Update state variables using Forward Euler\n                V += self.dt * dV_dt\n                m += self.dt * dm_dt\n                h += self.dt * dh_dt\n                n += self.dt * dn_dt\n\n                # Check for threshold crossings\n                if not distal_crossed and V_prev[-1]  v_thresh and V[-1] = v_thresh:\n                    distal_crossed = True\n                if t_cross_1  0 and V_prev[idx1]  v_thresh and V[idx1] = v_thresh:\n                    t_cross_1 = t\n                if t_cross_2  0 and V_prev[idx2]  v_thresh and V[idx2] = v_thresh:\n                    t_cross_2 = t\n\n            velocity = 0.0\n            if t_cross_1  0 and t_cross_2  t_cross_1:\n                dist_m = (self.x[idx2] - self.x[idx1]) / 100.0  # cm to m\n                time_s = (t_cross_2 - t_cross_1) / 1000.0  # ms to s\n                if time_s  0:\n                    velocity = dist_m / time_s\n            \n            return velocity, distal_crossed\n\n    def find_s_star(L):\n        s_max = 0.95\n        \n        _, success_at_0 = HodgkinHuxleyAxon(L, 0.0).run()\n        if not success_at_0:\n            return 0.0\n        \n        _, success_at_max = HodgkinHuxleyAxon(L, s_max).run()\n        if success_at_max:\n            return s_max\n\n        s_low, s_high = 0.0, s_max\n        num_iterations = 15  # Sufficient for 3 decimal places\n        for _ in range(num_iterations):\n            s_mid = (s_low + s_high) / 2.0\n            _, success = HodgkinHuxleyAxon(L, s_mid).run()\n            if success:\n                s_low = s_mid\n            else:\n                s_high = s_mid\n        return s_low\n    \n    test_cases = [\n        (1.0, 0.0), # Case A\n        (1.0, 0.4), # Case B\n        (1.0, 0.7), # Case C\n        (0.5, 0.8), # Case D\n    ]\n    \n    all_results = []\n    \n    for L_cm, s_base in test_cases:\n        # Run baseline simulation\n        sim_base = HodgkinHuxleyAxon(L=L_cm, s=s_base)\n        v_base, success_base = sim_base.run()\n        \n        # Find failure threshold s_star\n        s_star = find_s_star(L=L_cm)\n        \n        # Format and append\n        v_rounded = round(v_base, 3)\n        s_star_rounded = round(s_star, 3)\n        all_results.append([v_rounded, success_base, s_star_rounded])\n        \n    # Generate the final output string\n    result_str = str(all_results).replace(\" \", \"\")\n    print(result_str)\n\nsolve()\n```", "id": "2570337"}]}