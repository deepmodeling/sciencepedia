{"hands_on_practices": [{"introduction": "This problem serves as a practical introduction to genetic mapping, one of the foundational applications of the Chromosomal Theory of Inheritance. By analyzing hypothetical recombination frequencies, you will reconstruct the linear order of linked genes on a chromosome. This exercise reinforces the core principle that recombination frequency acts as a proxy for the physical distance separating genes [@problem_id:2318096].", "problem": "A geneticist is studying a newly discovered species of flowering plant, *Astraea floribunda*. Through a series of genetic crosses, four linked genes on a single chromosome were identified. These genes control distinct traits: petal color (locus *P*), fruit shape (locus *F*), stem texture (locus *S*), and leaf margin (locus *L*). To determine the arrangement of these genes, the geneticist performed a series of two-point test crosses and recorded the following recombination frequencies between pairs of genes:\n\n- *F* and *S*: 15%\n- *P* and *S*: 25%\n- *F* and *P*: 10%\n- *S* and *L*: 5%\n- *P* and *L*: 30%\n- *F* and *L*: 20%\n\nBased on these data, determine the linear order of the four genes on the chromosome.\n\nA. P-S-F-L\n\nB. F-P-L-S\n\nC. P-F-S-L\n\nD. L-P-S-F\n\nE. S-F-P-L", "solution": "We use that for linked genes with recombination fractions $r0.5$, the two-point recombination fraction approximates the map distance (in Morgans or centiMorgans), and for short intervals these distances are additive along a linear chromosome.\n\nGiven recombination fractions (expressed as decimals):\n- $r(F,S)=0.15$\n- $r(P,S)=0.25$\n- $r(F,P)=0.10$\n- $r(S,L)=0.05$\n- $r(P,L)=0.30$\n- $r(F,L)=0.20$\n\nStep 1: Identify the closest pair to set adjacency. The smallest value is $r(S,L)=0.05$, so $S$ and $L$ are adjacent.\n\nStep 2: Place $F$ relative to the $S$–$L$ pair using $r(F,S)=0.15$ and $r(F,L)=0.20$.\n- If the order is $F$–$S$–$L$, then the additive distance from $F$ to $L$ is $0.15+0.05=0.20$, which matches $r(F,L)=0.20$. Thus $F$ lies on the side of $S$ opposite $L$, giving $F$–$S$–$L$ (equivalently, $L$–$S$–$F$ by direction).\n\nStep 3: Place $P$ using $r(P,F)=0.10$, $r(P,S)=0.25$, and $r(P,L)=0.30$, relative to the established $F$–$S$–$L$ segment with distances $F$–$S=0.15$ and $S$–$L=0.05$.\n- Try $P$ to the left of $F$: order $P$–$F$–$S$–$L$.\n  Then $r(P,F)=0.10$ (given), $r(P,S)=0.10+0.15=0.25$ (matches), and $r(P,L)=0.10+0.15+0.05=0.30$ (matches). All three pairwise distances are satisfied.\n- Alternatives (e.g., placing $P$ between $F$ and $S$ or to the right of $L$) fail. For instance, if $F$–$P$–$S$–$L$ with $F$–$P=0.10$, then $P$–$S$ would be $0.05$ to keep $F$–$S=0.15$, which would imply $P$–$L=0.05+0.05=0.10\\neq 0.30$, a contradiction. Any placement of $P$ between $S$ and $L$ would force $r(P,F)\\geq r(F,S)=0.15$, contradicting $r(P,F)=0.10$.\n\nTherefore, the unique linear order consistent with all pairwise recombination fractions is $P$–$F$–$S$–$L$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "2318096"}, {"introduction": "Building upon basic gene mapping, this exercise explores the phenomenon of crossover interference, where one recombination event influences the likelihood of another nearby. You will use data from a three-point testcross to calculate the coefficient of coincidence and interference, quantifying this important regulatory feature of meiosis [@problem_id:2842598]. This practice highlights that the process of genetic exchange is more complex than a simple independent assortment of chromosomal segments.", "problem": "In a three-point testcross in the fruit fly Drosophila melanogaster involving loci $A$, $B$, and $C$, an investigator counts $n = 10{,}000$ progeny and classifies them into four disjoint categories according to crossover structure inferred from phenotypes: nonrecombinant across both intervals $A$–$B$ and $B$–$C$, single crossover in $A$–$B$ only, single crossover in $B$–$C$ only, and double crossover in both intervals. The observed counts are: nonrecombinant $8{,}060$, single crossover in $A$–$B$ $1{,}140$, single crossover in $B$–$C$ $740$, and double crossover $60$. Using only foundational principles of the chromosomal theory of inheritance—namely, that alleles reside on physical chromosomes, that homologous chromosomes pair and segregate in meiosis, that crossing over occurs as physical exchange between non-sister chromatids producing recombinant chromatids, and that a testcross maps gametic genotypes to progeny phenotypes without masking—derive from first principles how to compute the expected number of double crossovers under the assumption that crossover formation in adjacent intervals is independent when there is no interference. Then compute the coefficient of coincidence and interference from the observed and expected double crossovers. Finally, provide a brief biological interpretation of the numerical values obtained in terms of interference direction and magnitude. Express the coefficient of coincidence and the interference as dimensionless decimals, each rounded to four significant figures. The final reported answer must list, in order, the coefficient of coincidence and the interference.", "solution": "The problem requires the derivation of the expected number of double crossovers under the assumption of independence, followed by the calculation of the coefficient of coincidence and interference from provided testcross data, and a biological interpretation of the results. The problem is valid as it is scientifically grounded, well-posed, and internally consistent.\n\nFirst, let us establish the foundational principles. A three-point testcross involves a parent heterozygous for three linked loci ($A$, $B$, $C$) crossed with a parent homozygous recessive for all three loci. The phenotypes of the progeny directly reflect the gametic genotypes produced by the heterozygous parent. Recombination frequency between two loci is defined as the proportion of recombinant gametes (and thus, progeny) out of the total. It is calculated as the sum of progeny resulting from a crossover event in the interval between the two loci, divided by the total number of progeny.\n\nThe provided data are categorized by crossover events in two adjacent chromosomal intervals, which we shall label as interval $1$ (between loci $A$ and $B$) and interval $2$ (between loci $B$ and $C$). The given counts are:\nTotal progeny, $n = 10{,}000$\nNonrecombinant (NCO) count, $N_{NCO} = 8{,}060$\nSingle crossover in interval $1$ (SCO I), $N_{SCO_1} = 1{,}140$\nSingle crossover in interval $2$ (SCO II), $N_{SCO_2} = 740$\nDouble crossover (DCO), $N_{DCO} = 60$\nThe sum is $8{,}060 + 1{,}140 + 740 + 60 = 10{,}000$, which is consistent with the total progeny count $n$.\n\nThe recombination frequency for interval $1$, $RF_1$, is the proportion of progeny that resulted from a crossover in this interval. These include the single crossovers in interval $1$ and the double crossovers.\n$$RF_1 = \\frac{N_{SCO_1} + N_{DCO}}{n} = \\frac{1{,}140 + 60}{10{,}000} = \\frac{1{,}200}{10{,}000} = 0.12$$\n\nSimilarly, the recombination frequency for interval $2$, $RF_2$, is the proportion of progeny that resulted from a crossover in this second interval. These include the single crossovers in interval $2$ and the double crossovers.\n$$RF_2 = \\frac{N_{SCO_2} + N_{DCO}}{n} = \\frac{740 + 60}{10{,}000} = \\frac{800}{10{,}000} = 0.08$$\n\nThe problem asks for a derivation of the expected number of double crossovers under the assumption that crossover events in adjacent intervals are independent. This condition signifies an absence of interference. According to the laws of probability, the probability of two independent events occurring simultaneously is the product of their individual probabilities.\nLet $P(CO_1)$ be the probability of a crossover in interval $1$, and $P(CO_2)$ be the probability of a crossover in interval $2$. Per the definition of recombination frequency, $P(CO_1) = RF_1$ and $P(CO_2) = RF_2$.\nIf the events are independent, the probability of a double crossover, $P(DCO)$, is:\n$$P(DCO)_{\\text{expected}} = P(CO_1) \\times P(CO_2) = RF_1 \\times RF_2$$\nThis is the expected frequency of double crossovers. To find the expected *number* of double crossover progeny, $N_{DCO, \\text{exp}}$, in a population of size $n$, we multiply this probability by $n$:\n$$N_{DCO, \\text{exp}} = n \\times P(DCO)_{\\text{expected}} = n \\times RF_1 \\times RF_2$$\nThis concludes the derivation from first principles.\n\nNow, we substitute the calculated values of $RF_1$ and $RF_2$ to find the expected number of double crossovers:\n$$N_{DCO, \\text{exp}} = 10{,}000 \\times 0.12 \\times 0.08 = 10{,}000 \\times 0.0096 = 96$$\nThe expected count of double crossovers, assuming no interference, is $96$. The observed count is $N_{DCO, \\text{obs}} = 60$.\n\nThe coefficient of coincidence, $C$, is the ratio of the observed number of double crossovers to the expected number of double crossovers. It measures the extent to which the expected number of double crossovers is realized.\n$$C = \\frac{N_{DCO, \\text{obs}}}{N_{DCO, \\text{exp}}} = \\frac{60}{96} = \\frac{5}{8} = 0.625$$\nRounding to four significant figures, we get $C = 0.6250$.\n\nInterference, $I$, quantifies the degree to which one crossover event influences the probability of a second crossover event in an adjacent region. It is defined as:\n$$I = 1 - C$$\nSubstituting the value of $C$:\n$$I = 1 - 0.625 = 0.375$$\nRounding to four significant figures, we get $I = 0.3750$.\n\nFinally, a brief biological interpretation of these values is required.\nThe coefficient of coincidence, $C = 0.6250$, indicates that the observed frequency of double crossovers is only $62.5\\%$ of what would be expected if crossovers in the two intervals were independent events.\nThe interference value, $I = 0.3750$, is positive. This signifies positive interference, a common biological phenomenon where the formation of one crossover (chiasma) on a chromosome mechanically or biochemically inhibits the formation of a second crossover in a nearby region. In this specific case, $37.5\\%$ of the expected double crossovers were prevented from occurring due to this inhibitory effect. The presence of a crossover in one interval has reduced the likelihood of a crossover in the adjacent interval by $37.5\\%$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.6250  0.3750 \\end{pmatrix}}$$", "id": "2842598"}, {"introduction": "This final practice problem bridges classical genetics with modern functional genomics to investigate dosage compensation. Using a hypothetical RNA-sequencing dataset, you will develop and apply a quantitative index to assess how organisms balance gene expression from sex chromosomes present in different copy numbers between males and females [@problem_id:2965681]. This task demonstrates the enduring relevance of chromosomal principles in interpreting large-scale biological data.", "problem": "You are given paired Ribonucleic Acid sequencing (RNA-seq) data from male and female tissues for small gene sets, along with chromosome annotations identifying X-linked and autosomal genes. Your task is to formalize, derive from first principles, and compute a dimensionless index that quantifies dosage compensation between the sexes, then apply it to a fixed test suite and report numerical results.\n\nBackground and permissible foundations: The chromosomal theory of inheritance asserts that genes reside on chromosomes and segregate according to chromosomal behavior. In many species, males and females differ in the copy number of the X chromosome. The Central Dogma of molecular biology states that deoxyribonucleic acid (DNA) is transcribed into ribonucleic acid (RNA), which is translated into protein. RNA-seq measurements provide an estimate of gene expression abundance. Sex differences in X chromosome copy number can lead to dosage differences in X-linked gene expression unless compensated by regulatory mechanisms such as X-chromosome inactivation (XCI) or X-linked hypertranscription. Because sequencing depth and global transcriptional activity can vary between samples, autosomal expression provides a baseline to normalize sex-specific differences not due to X dosage.\n\nDesign and derive an index from the following principles. Let $M_i$ and $F_i$ denote expression measurements for gene $i$ in male and female samples, respectively, measured in Transcripts Per Million (TPM), and let $C_i \\in \\{\\text{\"X\"}, \\text{\"A\"}\\}$ be the chromosome label (\"X\" for X-linked, \"A\" for autosomal). Let $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$, $A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$, $X_F = \\sum_{i : C_i = \\text{\"X\"}} F_i$, and $A_F = \\sum_{i : C_i = \\text{\"A\"}} F_i$ denote the total X-linked and autosomal expression in each sex. Your index must satisfy:\n- Scale normalization: It must compare X-linked expression relative to autosomal expression within each sex to remove global scaling, that is, it must depend on $X_M$, $A_M$, $X_F$, and $A_F$ only through within-sex X-to-autosome comparisons.\n- Invariance to global rescaling: If all male expression values are multiplied by a positive constant $s_M$ and all female expression values by a positive constant $s_F$, the index must remain unchanged.\n- Interpretability in fold-changes: If the male within-sex X-to-autosome comparison differs from the female by a multiplicative factor $k0$, the index must change additively by a quantity proportional to $\\log_2 k$, so that $k=2$ corresponds to an increment of $+1$, $k=1/2$ to $-1$, and $k=1$ to $0$.\n- Sign convention: The index is $0$ if and only if the male and female within-sex comparisons are equal, is positive if the male within-sex comparison exceeds the female’s, and is negative in the opposite case.\n- Numerical stability: To handle cases where any of $X_M$, $A_M$, $X_F$, or $A_F$ may be $0$, use a small positive stabilizer $\\epsilon = 10^{-6}$ added to all numerators and denominators before forming any ratio.\n\nImplement a program that:\n1. From these principles, constructs a concrete, well-defined function of $X_M$, $A_M$, $X_F$, and $A_F$ satisfying all properties above.\n2. Applies it to each dataset in the test suite below.\n3. Outputs the results for all cases as a single line: a comma-separated list of the computed values, each rounded to $3$ decimal places, enclosed in square brackets.\n\nAll expression inputs are in Transcripts Per Million (TPM); there is no unit to report for the index. Use the base-$2$ logarithm when a logarithm is required by your derivation.\n\nTest suite (each case provides a tuple: male TPMs list, female TPMs list, chromosome labels list). Each list is aligned by index, and each number must be interpreted as TPM. The labels are \"X\" for X-linked genes and \"A\" for autosomal genes.\n- Case $1$ (compensated baseline; within-sex X-to-autosome balance is equal across sexes):\n  - Male TPMs: [$50$, $30$, $100$, $120$, $80$, $150$]\n  - Female TPMs: [$90$, $70$, $200$, $240$, $160$, $300$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- Case $2$ (no dosage compensation; female X is approximately doubled relative to male with similar autosomal baselines):\n  - Male TPMs: [$50$, $30$, $100$, $120$, $80$, $150$]\n  - Female TPMs: [$100$, $60$, $100$, $120$, $80$, $150$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- Case $3$ (male hypertranscription of X relative to female):\n  - Male TPMs: [$80$, $60$, $60$, $200$, $300$]\n  - Female TPMs: [$50$, $50$, $50$, $300$, $450$]\n  - Chromosomes: [\"X\", \"X\", \"X\", \"A\", \"A\"]\n- Case $4$ (global expression shift across sexes but preserved compensation; normalization should cancel the shift):\n  - Male TPMs: [$40$, $40$, $200$, $220$, $230$]\n  - Female TPMs: [$120$, $120$, $600$, $660$, $690$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\"]\n- Case $5$ (edge case with near-absent male X expression for one gene):\n  - Male TPMs: [$0$, $5$, $100$, $100$, $100$]\n  - Female TPMs: [$10$, $10$, $150$, $150$, $150$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\"]\n- Case $6$ (partial escape from inactivation; modest female excess of X relative to autosomes):\n  - Male TPMs: [$30$, $30$, $30$, $200$, $200$, $200$, $200$]\n  - Female TPMs: [$40$, $40$, $40$, $200$, $200$, $200$, $200$]\n  - Chromosomes: [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, [$v_1$,$v_2$,$v_3$,$v_4$,$v_5$,$v_6$]), where each $v_i$ is your computed index for case $i$, rounded to $3$ decimal places as base-$10$ decimals.", "solution": "We begin from first principles anchored in the chromosomal theory of inheritance and the Central Dogma. The copy number difference of the X chromosome between males and females creates a potential two-fold imbalance in X-linked gene dosage. Organisms often evolve regulatory mechanisms such as X-chromosome inactivation (XCI) or hypertranscription that act to equalize the effective X-linked gene expression between sexes. RNA sequencing (RNA-seq) provides quantitative estimates of gene expression, commonly normalized as Transcripts Per Million (TPM). However, overall sequencing depth and global transcriptional activity can vary between samples. Therefore, comparing X-linked expression relative to autosomal expression within each sex controls for global scaling factors not related to sex chromosome dosage.\n\nWe are asked to design an index that satisfies five key properties: scale normalization via within-sex X-to-autosome comparison, invariance to global rescaling, interpretability in fold-changes through additivity under multiplicative deviations, a sign convention with a zero point at equality, and numerical stability through addition of a small positive stabilizer $\\epsilon = 10^{-6}$ to prevent division by zero.\n\nLet $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$ and $A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$ denote the male totals for X-linked and autosomal expression, respectively, and similarly $X_F$ and $A_F$ for female. Define the within-sex X-to-autosome normalized quantities\n$$\nR_M = \\frac{X_M + \\epsilon}{A_M + \\epsilon}, \\quad R_F = \\frac{X_F + \\epsilon}{A_F + \\epsilon},\n$$\nwith $\\epsilon = 10^{-6}$ added to both numerator and denominator for stability. This construction enforces scale normalization and removes the effect of global scaling: multiplying all male expressions by a positive constant $s_M$ multiplies both $X_M$ and $A_M$ by $s_M$, leaving $R_M$ unchanged (and likewise for $R_F$). Hence the index must be a function of the ratio $R_M / R_F$ to satisfy the invariance requirement and the sign convention with $0$ at equality.\n\nTo enforce interpretability in fold-changes such that multiplicative differences become additive and $2$-fold corresponds to $+1$, we require a function $g$ such that $g\\!\\left(k\\right)$ is additive in $k$ under multiplication and is measured in base-$2$ fold-change units. The standard and unique (up to a multiplicative constant) continuous function mapping multiplicative differences to additive differences is the logarithm. Choosing the base-$2$ logarithm sets the unit so that a factor of $2$ maps to $+1$, $1/2$ maps to $-1$, and equality ($1$) maps to $0$. Therefore, the only natural choice satisfying all constraints is\n$$\n\\mathrm{DCI} \\equiv \\log_2 \\left( \\frac{R_M}{R_F} \\right) \\;=\\; \\log_2 \\left( \\frac{X_M + \\epsilon}{A_M + \\epsilon} \\cdot \\frac{A_F + \\epsilon}{X_F + \\epsilon} \\right).\n$$\nThis Dosage Compensation Index (DCI) is dimensionless, equals $0$ if and only if the normalized X-to-autosome ratios are equal between sexes, is positive when the male normalized X level exceeds the female’s, and negative in the opposite case. The stabilizer $\\epsilon = 10^{-6}$ ensures numerical robustness in degenerate cases.\n\nWe now compute the DCI for each case, rounding to $3$ decimals.\n\n- Case $1$:\n  - Male: $X_M = 50 + 30 = 80$, $A_M = 100 + 120 + 80 + 150 = 450$, so $R_M = \\frac{80 + 10^{-6}}{450 + 10^{-6}} \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$.\n  - Female: $X_F = 90 + 70 = 160$, $A_F = 200 + 240 + 160 + 300 = 900$, so $R_F = \\frac{160 + 10^{-6}}{900 + 10^{-6}} \\approx \\frac{160}{900} \\approx 0.177\\overline{7}$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx 1$, hence $\\mathrm{DCI} \\approx \\log_2(1) = 0.000$.\n\n- Case $2$:\n  - Male: $X_M = 80$, $A_M = 450$, $R_M \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$.\n  - Female: $X_F = 100 + 60 = 160$, $A_F = 100 + 120 + 80 + 150 = 450$, $R_F \\approx \\frac{160}{450} \\approx 0.355\\overline{5}$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx \\frac{80/450}{160/450} = \\frac{1}{2}$, so $\\mathrm{DCI} = \\log_2\\!\\left(\\frac{1}{2}\\right) = -1.000$.\n\n- Case $3$:\n  - Male: $X_M = 80 + 60 + 60 = 200$, $A_M = 200 + 300 = 500$, $R_M = \\frac{200}{500} = 0.4$.\n  - Female: $X_F = 50 + 50 + 50 = 150$, $A_F = 300 + 450 = 750$, $R_F = \\frac{150}{750} = 0.2$.\n  - Ratio: $\\frac{R_M}{R_F} = \\frac{0.4}{0.2} = 2$, hence $\\mathrm{DCI} = \\log_2(2) = 1.000$.\n\n- Case $4$:\n  - Male: $X_M = 40 + 40 = 80$, $A_M = 200 + 220 + 230 = 650$, $R_M \\approx \\frac{80}{650} \\approx 0.1230769$.\n  - Female: $X_F = 120 + 120 = 240$, $A_F = 600 + 660 + 690 = 1950$, $R_F \\approx \\frac{240}{1950} \\approx 0.1230769$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx 1$, so $\\mathrm{DCI} \\approx 0.000$.\n\n- Case $5$:\n  - Male: $X_M = 0 + 5 = 5$, $A_M = 100 + 100 + 100 = 300$, $R_M \\approx \\frac{5 + 10^{-6}}{300 + 10^{-6}} \\approx \\frac{5}{300} \\approx 0.016\\overline{6}$.\n  - Female: $X_F = 10 + 10 = 20$, $A_F = 150 + 150 + 150 = 450$, $R_F \\approx \\frac{20}{450} \\approx 0.044\\overline{4}$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx \\frac{0.016\\overline{6}}{0.044\\overline{4}} = 0.375$, so $\\mathrm{DCI} = \\log_2(0.375) = \\log_2\\!\\left(\\frac{3}{8}\\right) = \\log_2(3) - 3 \\approx 1.58496 - 3 = -1.41504$, rounded to $-1.415$.\n\n- Case $6$:\n  - Male: $X_M = 30 + 30 + 30 = 90$, $A_M = 200 \\times 4 = 800$, $R_M = \\frac{90}{800} = 0.1125$.\n  - Female: $X_F = 40 + 40 + 40 = 120$, $A_F = 200 \\times 4 = 800$, $R_F = \\frac{120}{800} = 0.15$.\n  - Ratio: $\\frac{R_M}{R_F} = \\frac{0.1125}{0.15} = 0.75$, giving $\\mathrm{DCI} = \\log_2(0.75) \\approx -0.415037$, rounded to $-0.415$.\n\nThus, after rounding each to $3$ decimals, the expected outputs in order are:\n- Case $1$: $0.000$\n- Case $2$: $-1.000$\n- Case $3$: $1.000$\n- Case $4$: $0.000$\n- Case $5$: $-1.415$\n- Case $6$: $-0.415$\n\nThe program computes $X_M$, $A_M$, $X_F$, and $A_F$ by summation using the provided chromosome labels, forms $R_M$ and $R_F$ with $\\epsilon = 10^{-6}$, computes $\\mathrm{DCI} = \\log_2\\!\\left(R_M/R_F\\right)$, rounds to $3$ decimals, and prints the list in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6):\n    \"\"\"\n    Compute the Dosage Compensation Index (DCI) for one dataset.\n    DCI = log2( ( (X_M + eps)/(A_M + eps) ) / ( (X_F + eps)/(A_F + eps) ) )\n    where X_* and A_* are sums of TPMs over X-linked and autosomal genes.\n    \"\"\"\n    male_tpm = np.asarray(male_tpm, dtype=float)\n    female_tpm = np.asarray(female_tpm, dtype=float)\n    chrom_labels = np.asarray(chrom_labels)\n\n    x_mask = chrom_labels == \"X\"\n    a_mask = chrom_labels == \"A\"\n\n    XM = float(male_tpm[x_mask].sum())\n    AM = float(male_tpm[a_mask].sum())\n    XF = float(female_tpm[x_mask].sum())\n    AF = float(female_tpm[a_mask].sum())\n\n    RM = (XM + eps) / (AM + eps)\n    RF = (XF + eps) / (AF + eps)\n\n    dci = np.log2(RM / RF)\n    return dci\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            [50, 30, 100, 120, 80, 150],\n            [90, 70, 200, 240, 160, 300],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 2\n        (\n            [50, 30, 100, 120, 80, 150],\n            [100, 60, 100, 120, 80, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 3\n        (\n            [80, 60, 60, 200, 300],\n            [50, 50, 50, 300, 450],\n            [\"X\", \"X\", \"X\", \"A\", \"A\"],\n        ),\n        # Case 4\n        (\n            [40, 40, 200, 220, 230],\n            [120, 120, 600, 660, 690],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 5\n        (\n            [0, 5, 100, 100, 100],\n            [10, 10, 150, 150, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 6\n        (\n            [30, 30, 30, 200, 200, 200, 200],\n            [40, 40, 40, 200, 200, 200, 200],\n            [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n    ]\n\n    results = []\n    for male_tpm, female_tpm, chrom_labels in test_cases:\n        dci = compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6)\n        results.append(dci)\n\n    # Final print statement in the exact required format, rounded to 3 decimals.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2965681"}]}