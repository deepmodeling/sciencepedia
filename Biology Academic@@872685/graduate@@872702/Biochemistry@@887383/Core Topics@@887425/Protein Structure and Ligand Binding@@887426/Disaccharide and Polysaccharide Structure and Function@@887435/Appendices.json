{"hands_on_practices": [{"introduction": "The immense structural diversity of carbohydrates is a cornerstone of their functional versatility in biology, far exceeding that of proteins or nucleic acids built from a similar number of monomers. This problem challenges you to explore this \"combinatorial explosion\" by systematically applying the fundamental rules of glycosidic bond formation to a defined set of building blocks. By calculating the total number of unique disaccharides possible, you will gain a concrete appreciation for the structural complexity that underpins the field of glycobiology. [@problem_id:2556528]", "problem": "A biochemist is cataloging all possible oxygen-glycosidic (O-glycosidic) disaccharides that can be built from a set of three D-hexose-derived monosaccharides under a simplified but scientifically realistic structural model. The three monosaccharides are: D-glucose (Glc), N-acetyl-D-glucosamine (GlcNAc), and D-glucuronic acid (GlcA). Assume the following foundational biochemical facts and constraints, and use only these as your starting point:\n\n- A glycosidic bond is an acetal linkage formed when the anomeric hydroxyl at carbon $C_1$ (the hemiacetal carbon) of a donor monosaccharide reacts with a hydroxyl group on an acceptor monosaccharide to form an O-glycosidic bond.\n- A D-hexose can cyclize to either a six-membered ring (pyranose) or a five-membered ring (furanose). In the pyranose, ring closure involves the hydroxyl at $C_5$, making the ring oxygen originate from $O_5$; in the furanose, ring closure involves the hydroxyl at $C_4$, making the ring oxygen originate from $O_4$. In both cases, a new anomeric hydroxyl appears at $C_1$ in the cyclic hemiacetal, which can be either $\\alpha$ or $\\beta$.\n- Hydroxyl-bearing carbons capable of acting as acceptor sites are precisely those carbons that bear free hydroxyl groups in the cyclic form, including the anomeric hydroxyl at $C_1$. The set of hydroxyl-bearing positions differs between pyranose and furanose because of which hydroxyl participates in ring formation.\n- Substitutions that remove hydroxyl groups eliminate those positions as O-glycosyl acceptor sites. Specifically: GlcNAc has $C_2$ substituted by an acetamido group (no hydroxyl at $C_2$), and GlcA has $C_6$ oxidized to a carboxylate (no hydroxyl at $C_6$). All other positions retain their normal hydroxyls for a D-hexose, except the position used for ring formation ($C_5$ in the pyranose, $C_4$ in the furanose). No other modifications are present.\n- Only O-glycosidic linkages are allowed. Ignore any N- or C-glycosidic linkages and any additional derivatizations such as phosphorylation or sulfation.\n- A disaccharide is represented as an oriented pair “$\\text{donor} \\to \\text{acceptor}$,” where the donor contributes its anomeric carbon $C_1$ to form the glycosidic bond. The donor is specified by its monosaccharide identity, its ring size (pyranose or furanose), and its anomeric configuration ($\\alpha$ or $\\beta$) at $C_1$. The acceptor is specified by its monosaccharide identity, its ring size (pyranose or furanose), and the position that bears the hydroxyl to which the glycosidic oxygen is attached. If the acceptor hydroxyl is the anomeric hydroxyl at $C_1$, then the acceptor’s anomeric configuration at $C_1$ is also fixed by the glycosidic bond and can be either $\\alpha$ or $\\beta$, giving distinct structures.\n- Two disaccharides are considered distinct if they differ in any of the following: donor monosaccharide identity, donor ring size, donor anomeric configuration, acceptor monosaccharide identity, acceptor ring size, acceptor linkage position (which carbon on the acceptor), or, when the acceptor position is $C_1$, the acceptor anomeric configuration. The oriented nature of the pair means reversing donor and acceptor yields a different disaccharide.\n- Consider only D-series monosaccharides and ignore mutarotation equilibria of free reducing ends; count each fixed configuration as a distinct structure.\n\nUsing only the above facts and constraints, compute the total number of distinct oriented O-glycosidic disaccharides that can be formed when the donor and the acceptor are each chosen independently from the set $\\{\\text{Glc}, \\text{GlcNAc}, \\text{GlcA}\\}$. Express your final answer as an integer with no units.", "solution": "The problem as stated is scientifically grounded, formally coherent, and well-posed. It presents a combinatorial enumeration problem based on established principles of carbohydrate chemistry. No invalidating flaws are present. We shall proceed with the solution.\n\nThe problem requires the computation of the total number of distinct oriented O-glycosidic disaccharides that can be formed from a given set of three monosaccharides. An oriented disaccharide is defined as a \"$\\text{donor} \\to \\text{acceptor}$\" pair. According to the problem's criteria for distinctness and the independence of choices for the donor and acceptor moieties, the total number of distinct disaccharides, $N_{total}$, can be calculated as the product of the number of possible donor configurations, $N_{donor}$, and the total number of possible acceptor linkage configurations, $L_{total}$.\n\n$$N_{total} = N_{donor} \\times L_{total}$$\n\nFirst, we determine the number of distinct donor configurations, $N_{donor}$. A donor is specified by three independent properties:\n1.  Monosaccharide identity: There are $3$ choices: D-glucose (Glc), N-acetyl-D-glucosamine (GlcNAc), or D-glucuronic acid (GlcA).\n2.  Ring size: There are $2$ choices for a hexose: pyranose (a $6$-membered ring) or furanose (a $5$-membered ring).\n3.  Anomeric configuration at the glycosidic bond: There are $2$ choices: $\\alpha$ or $\\beta$.\n\nThe number of possible donor configurations is the product of the number of choices for each property:\n$$N_{donor} = 3 \\times 2 \\times 2 = 12$$\n\nNext, we determine the total number of acceptor linkage configurations, $L_{total}$. This quantity is the sum of all possible linkage options over all possible acceptor molecules. An acceptor molecule is defined by its monosaccharide identity and its ring size. There are $3$ choices for identity and $2$ for ring size, resulting in $3 \\times 2 = 6$ unique acceptor molecule types.\n\nFor each acceptor molecule type, we must count the number of available hydroxyl groups that can participate in forming a glycosidic bond. The problem states that if the linkage is at the anomeric carbon ($C_1$), both $\\alpha$ and $\\beta$ configurations of the newly formed glycosidic bond result in distinct structures. Therefore, the anomeric hydroxyl at $C_1$ provides $2$ linkage options, while any other hydroxyl provides $1$ option.\n\nLet us analyze the number of available hydroxyls for each of the $6$ acceptor molecule types.\n\n1.  **D-glucose (Glc)**: This is an unmodified D-hexose.\n    *   **Pyranose form (Glcp)**: Ring formation involves the hydroxyl at $C_5$. The available hydroxyls are at positions $C_1$, $C_2$, $C_3$, $C_4$, and $C_6$. There is $1$ anomeric hydroxyl ($C_1$) and $4$ non-anomeric hydroxyls. The number of linkage options is $ (1 \\times 2) + 4 = 6$.\n    *   **Furanose form (Glcf)**: Ring formation involves the hydroxyl at $C_4$. The available hydroxyls are at positions $C_1$, $C_2$, $C_3$, $C_5$, and $C_6$. There is $1$ anomeric hydroxyl ($C_1$) and $4$ non-anomeric hydroxyls. The number of linkage options is $ (1 \\times 2) + 4 = 6$.\n\n2.  **N-acetyl-D-glucosamine (GlcNAc)**: The hydroxyl at $C_2$ is replaced by an acetamido group.\n    *   **Pyranose form (GlcNAcp)**: The available hydroxyls for a generic hexopyranose are at {$C_1, C_2, C_3, C_4, C_6$}. The substitution at $C_2$ removes it from this set. The available hydroxyls are at {$C_1, C_3, C_4, C_6$}. There is $1$ anomeric hydroxyl ($C_1$) and $3$ non-anomeric hydroxyls. The number of linkage options is $ (1 \\times 2) + 3 = 5$.\n    *   **Furanose form (GlcNAcf)**: The available hydroxyls for a generic hexofuranose are at {$C_1, C_2, C_3, C_5, C_6$}. The substitution at $C_2$ removes it. The available hydroxyls are at {$C_1, C_3, C_5, C_6$}. There is $1$ anomeric hydroxyl ($C_1$) and $3$ non-anomeric hydroxyls. The number of linkage options is $ (1 \\times 2) + 3 = 5$.\n\n3.  **D-glucuronic acid (GlcA)**: The hydroxymethyl group at $C_6$ is oxidized to a carboxylate group, removing the hydroxyl.\n    *   **Pyranose form (GlcAp)**: The available hydroxyls for a generic hexopyranose are at {$C_1, C_2, C_3, C_4, C_6$}. The oxidation at $C_6$ removes it. The available hydroxyls are at {$C_1, C_2, C_3, C_4$}. There is $1$ anomeric hydroxyl ($C_1$) and $3$ non-anomeric hydroxyls. The number of linkage options is $ (1 \\times 2) + 3 = 5$.\n    *   **Furanose form (GlcAf)**: The available hydroxyls for a generic hexofuranose are at {$C_1, C_2, C_3, C_5, C_6$}. The oxidation at $C_6$ removes it. The available hydroxyls are at {$C_1, C_2, C_3, C_5$}. There is $1$ anomeric hydroxyl ($C_1$) and $3$ non-anomeric hydroxyls. The number of linkage options is $ (1 \\times 2) + 3 = 5$.\n\nNow, we sum the linkage options for all possible acceptor molecules to find $L_{total}$:\n$$L_{total} = (\\text{options for Glcp}) + (\\text{options for Glcf}) + (\\text{options for GlcNAcp}) + (\\text{options for GlcNAcf}) + (\\text{options for GlcAp}) + (\\text{options for GlcAf})$$\n$$L_{total} = 6 + 6 + 5 + 5 + 5 + 5 = 32$$\n\nFinally, we compute the total number of distinct disaccharides by multiplying the number of donor configurations by the total number of acceptor linkage configurations:\n$$N_{total} = N_{donor} \\times L_{total} = 12 \\times 32$$\n$$N_{total} = 384$$\n\nTherefore, there are $384$ distinct oriented O-glycosidic disaccharides that can be formed under the given constraints.", "answer": "$$\\boxed{384}$$", "id": "2556528"}, {"introduction": "While the theoretical number of possible carbohydrate structures is vast, the practical challenge for a biochemist is often to determine the single, precise structure of a molecule isolated from a biological source. This exercise places you in the role of a structural analyst, tasking you with integrating multi-dimensional data from Nuclear Magnetic Resonance (NMR) spectroscopy and tandem Mass Spectrometry (MS/MS). Successfully solving this puzzle requires applying core biophysical principles to translate spectral features into a definitive chemical structure, a critical skill in modern biochemical research. [@problem_id:2556518]", "problem": "An unknown disaccharide composed of two D-hexopyranose units is subjected to Nuclear Magnetic Resonance (NMR) and tandem Mass Spectrometry (MS/MS) for structural characterization. The sample was first reduced at its reducing end to the corresponding alditol to simplify anomeric analysis. Consider the following foundational bases for interpretation: (i) three-bond scalar couplings between vicinal protons in a six-membered ring depend on the dihedral angle connecting them, as captured by the Karplus relationship; (ii) formation of a glycosidic bond perturbs the electronic environment and typically causes a downfield perturbation of the carbon at the substitution site in carbon-13 NMR, relative to unsubstituted positions in the same ring; (iii) in collision-induced dissociation of oligosaccharides, glycosidic cleavages produce B/Y ions and cross-ring cleavages at the reducing-end residue produce $^{i,j}A$/$^{i,j}X$ ions whose presence or absence is dependent on the linkage position.\n\nYou obtain the following experimentally grounded observations:\n\n- One anomeric proton signal is observed in the one-dimensional proton spectrum at $\\delta$ 5.38 ppm, appearing as a doublet with coupling constant $J_{1,2} = 3.6\\,\\mathrm{Hz}$. Heteronuclear single-quantum coherence places its directly attached carbon at $\\delta$ 99.8 ppm, consistent with an anomeric carbon of a glycosidically substituted residue. Rotating-frame Overhauser spectroscopy shows a nuclear Overhauser effect between this anomeric proton and a proton assigned to $H_3$ of the same residue.\n- For the reduced residue (the former reducing end), heteronuclear single-quantum coherence shows $C_4$ at $\\delta$ 80.2 ppm with a directly attached proton at $\\delta$ 3.59 ppm, whereas $C_6$ resonates at $\\delta$ 61.8 ppm. Heteronuclear multiple-bond correlation shows a three-bond correlation from the anomeric proton at $\\delta$ 5.38 ppm to the carbon at $\\delta$ 80.2 ppm, but no long-range correlation to the carbon at $\\delta$ 61.8 ppm.\n- Positive-ion electrospray ionization of the native disaccharide yields a sodium-adduct molecular ion at $m/z$ 365.11 consistent with a neutral mass of $\\approx 342.12\\,\\mathrm{Da}$. Collision-induced dissociation of the $m/z$ 365.11 ion yields a prominent cross-ring fragment annotated as $^{0,2}A_{\\mathrm{red}}$, assigned to the reduced residue, while the $^{0,3}A_{\\mathrm{red}}$ is not observed above the noise. Diagnostic glycosidic fragments consistent with a Hex–Hex composition are present, but do not distinguish linkage position by themselves.\n\nWhich structure best matches the combined NMR and MS/MS evidence for the original (unreduced) disaccharide?\n\nA. $\\alpha$-D-Glcp-$(1\\rightarrow 4)$-D-Glcp (maltose)\n\nB. $\\beta$-D-Glcp-$(1\\rightarrow 4)$-D-Glcp (cellobiose)\n\nC. $\\alpha$-D-Glcp-$(1\\rightarrow 6)$-D-Glcp (isomaltose)\n\nD. $\\beta$-D-Glcp-$(1\\rightarrow 6)$-D-Glcp (gentiobiose)", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Disaccharide composition:** Two D-hexopyranose units.\n- **Sample preparation:** The disaccharide was reduced at its reducing end to form an alditol for NMR analysis.\n- **Underlying principles:**\n    - (i) Karplus relationship for vicinal proton couplings ($^{3}J$) in a six-membered ring.\n    - (ii) Downfield perturbation of $^{13}\\text{C}$ chemical shift upon glycosidic substitution.\n    - (iii) Diagnostic collision-induced dissociation (CID) fragmentation patterns for oligosaccharides (B/Y, A/X ions).\n- **NMR Data (on reduced sample):**\n    - One anomeric proton signal: $\\delta = 5.38$ ppm.\n    - Anomeric proton coupling: doublet, $J_{1,2} = 3.6\\,\\mathrm{Hz}$.\n    - Anomeric carbon chemical shift (HSQC): $\\delta = 99.8$ ppm.\n    - ROESY: Nuclear Overhauser effect (NOE) observed between the anomeric proton ($H_{1'}$) and a proton assigned to $H_3$ of the same non-reducing residue.\n    - Reduced residue (alditol) assignments: $C_4$ at $\\delta = 80.2$ ppm (attached H at $\\delta = 3.59$ ppm); $C_6$ at $\\delta = 61.8$ ppm.\n    - HMBC: A three-bond correlation exists from the anomeric proton ($\\delta = 5.38$ ppm) to the carbon at $\\delta = 80.2$ ppm ($C_4$ of alditol). No correlation is seen to the carbon at $\\delta = 61.8$ ppm ($C_6$ of alditol).\n- **MS/MS Data (on native sample):**\n    - Molecular ion: Sodium adduct $[\\text{M}+\\text{Na}]^+$ at $m/z = 365.11$.\n    - Neutral mass is consistent with a hexose-hexose disaccharide ($C_{12}H_{22}O_{11}$, molar mass $342.30\\,\\mathrm{g/mol}$).\n    - CID of the $m/z = 365.11$ ion yields a prominent cross-ring fragment $^{0,2}A_{\\mathrm{red}}$ from the reducing-end residue.\n    - The $^{0,3}A_{\\mathrm{red}}$ cross-ring fragment is not observed.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly based on established principles of structural elucidation using Nuclear Magnetic Resonance (NMR) spectroscopy and tandem Mass Spectrometry (MS/MS), which are standard techniques in carbohydrate chemistry. The provided data values (chemical shifts, coupling constants, m/z values) are physically realistic for a disaccharide.\n- **Well-Posedness:** The problem provides sufficient, non-contradictory data to logically deduce the anomeric configuration and linkage position of the disaccharide, allowing for a unique solution among the given choices.\n- **Objectivity:** The problem is stated using precise, objective, and technical language, free from any subjective or biased elements.\n- **Flaw Analysis:**\n    - The problem is scientifically and factually sound.\n    - It is a formalizable problem in analytical biochemistry.\n    - The setup is complete and consistent. The use of both a native and a reduced sample for different experiments (MS and NMR, respectively) is a common and valid experimental strategy.\n    - The conditions and data are realistic.\n    - It is a well-posed problem that admits a unique solution from the provided data.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid.\n- **Action:** Proceed to the solution.\n\n**Derivation of the Solution**\n\nThe structure of the disaccharide is determined by analyzing the provided spectroscopic and spectrometric data. Let us denote the non-reducing residue with a prime (') and the reducing-end residue without.\n\n1.  **Determination of Anomeric Configuration:**\n    - The anomeric proton of the non-reducing residue ($H_{1'}$) resonates at $\\delta = 5.38$ ppm. The key piece of information is the scalar coupling constant to the vicinal proton $H_{2'}$, $J_{1',2'} = 3.6\\,\\mathrm{Hz}$.\n    - According to the Karplus relationship (principle i), a small $^{3}J$ coupling constant (typically $< 4\\,\\mathrm{Hz}$) in a pyranose ring indicates an axial-equatorial or equatorial-equatorial relationship between the coupled protons. For hexopyranoses like glucose in a standard $ ^4C_1 $ chair conformation, an $\\alpha$-anomer has $H_{1'}$ in an axial position and $H_{2'}$ in an equatorial position, resulting in a dihedral angle of approximately $60^\\circ$ and a small $J_{1',2'}$. In contrast, a $\\beta$-anomer has both $H_{1'}$ and $H_{2'}$ in axial positions, leading to a dihedral angle of nearly $180^\\circ$ and a large coupling constant (typically $7-9\\,\\mathrm{Hz}$).\n    - The measured $J_{1',2'} = 3.6\\,\\mathrm{Hz}$ is small and thus unequivocally indicates an **$\\alpha$-anomeric linkage**.\n    - This conclusion is further supported by the ROESY data, which shows an NOE between $H_{1'}$ and $H_3$. In an $\\alpha$-glucopyranosyl unit, $H_{1'}$ and $H_3$ are in a 1,3-diaxial arrangement, placing them in close spatial proximity and giving rise to a strong NOE. This is a characteristic feature of an $\\alpha$-linkage.\n\n2.  **Determination of Linkage Position:**\n    - The linkage position is determined from the Heteronuclear Multiple-Bond Correlation (HMBC) spectrum, which reveals three-bond couplings between protons and carbons ($^{3}J_{C,H}$).\n    - The experiment shows a correlation from the anomeric proton of the non-reducing unit ($H_{1'}$ at $\\delta = 5.38$ ppm) to a carbon in the reduced residue at $\\delta = 80.2$ ppm. This carbon is identified as $C_4$. The correlation path is $H_{1'}—O—C_4—C-\\dots$, which establishes a covalent link between $C_{1'}$ and the oxygen attached to $C_4$.\n    - Therefore, the disaccharide possesses a **$(1\\rightarrow 4)$ linkage**.\n    - The significant downfield shift of $C_4$ ($\\delta = 80.2$ ppm) compared to its position in an unsubstituted alditol (e.g., glucitol, where $C_4$ is $\\approx 70$ ppm) is consistent with the deshielding effect of glycosylation at this position (principle ii).\n    - The explicit absence of an HMBC correlation from $H_{1'}$ to $C_6$ (at the typical unsubstituted primary alcohol shift of $\\delta = 61.8$ ppm) rules out a $(1\\rightarrow 6)$ linkage.\n    - The MS/MS data provides confirmatory evidence. Cross-ring cleavage fragments of the A-type are highly diagnostic of linkage position. The observation of a prominent $^{0,2}A$ fragment (cleavage of $C_2-C_3$ and $C_0-C_1$ bonds) is characteristic of a $(1\\rightarrow 4)$ linkage. Conversely, the absence of the $^{0,3}A$ fragment, which is expected for $(1\\rightarrow 6)$ linkages, strongly argues against that possibility.\n\n3.  **Synthesis of the Structure:**\n    - The monomer units are D-hexopyranoses, and the options specify D-glucopyranose (D-Glcp).\n    - The anomeric configuration of the glycosidic bond is $\\alpha$.\n    - The linkage position is $(1\\rightarrow 4)$.\n    - Combining these findings, the determined structure is **$\\alpha$-D-glucopyranosyl-$(1\\rightarrow 4)$-D-glucopyranose**. This is the chemical name for maltose.\n\n**Evaluation of Options**\n\n*   **A. $\\alpha$-D-Glcp-$(1\\rightarrow 4)$-D-Glcp (maltose)**\n    This structure features an $\\alpha$-(1→4) linkage between two D-glucose units. This matches our derivation perfectly: the $\\alpha$-linkage is consistent with $J_{1',2'} = 3.6\\,\\mathrm{Hz}$ and the $H_{1'}$ to $H_3$ NOE, and the $(1\\rightarrow 4)$ linkage is confirmed by the specific HMBC correlation ($H_{1'}$ to $C_4$) and the MS/MS fragmentation pattern ($^{0,2}A$ fragment).\n    **Verdict: Correct.**\n\n*   **B. $\\beta$-D-Glcp-$(1\\rightarrow 4)$-D-Glcp (cellobiose)**\n    This structure has a $\\beta$-anomeric linkage. This would result in a large $J_{1',2'}$ coupling constant (~$8\\,\\mathrm{Hz}$), which contradicts the experimental value of $3.6\\,\\mathrm{Hz}$.\n    **Verdict: Incorrect.**\n\n*   **C. $\\alpha$-D-Glcp-$(1\\rightarrow 6)$-D-Glcp (isomaltose)**\n    This structure has the correct $\\alpha$-anomeric configuration but an incorrect $(1\\rightarrow 6)$ linkage. This linkage is inconsistent with the HMBC data, which showed a correlation to $C_4$ and none to $C_6$. It is also inconsistent with the MS/MS fragmentation data.\n    **Verdict: Incorrect.**\n\n*   **D. $\\beta$-D-Glcp-$(1\\rightarrow 6)$-D-Glcp (gentiobiose)**\n    This structure is incorrect in both its anomeric configuration ($\\beta$ instead of $\\alpha$) and its linkage position ($(1\\rightarrow 6)$ instead of $(1\\rightarrow 4)$). It is contradicted by all major pieces of experimental evidence.\n    **Verdict: Incorrect.**\n\nThe only structure that is fully consistent with the entire set of NMR and MS/MS data is maltose.", "answer": "$$\\boxed{A}$$", "id": "2556518"}, {"introduction": "Understanding a polysaccharide’s function requires moving beyond its static covalent connectivity to its dynamic behavior and conformational preferences in solution, which are governed by the rotation around glycosidic bonds. This computational problem introduces you to the world of molecular modeling, where a force field is used to describe the potential energy landscape of these torsional angles, $\\phi$ and $\\psi$. By implementing an algorithm rooted in statistical mechanics, you will compute the free energy difference between conformational states, gaining hands-on experience in how computational tools connect atomic-level energies to macroscopic properties. [@problem_id:2556527]", "problem": "A coarse-grained force-field representation of a carbohydrate disaccharide treats the glycosidic linkage as two coupled torsional degrees of freedom, denoted by the dihedral angles $\\phi$ and $\\psi$ (angles in degrees). The potential energy function is defined as a sum of Fourier torsional terms for each angle plus a coupling term between the two angles. Specifically, the energy at a configuration $(\\phi,\\psi)$ is\n$$\nE(\\phi,\\psi) \\;=\\; \\sum_{m=1}^{M_\\phi} k_{\\phi,m}\\,\\bigl(1+\\cos\\bigl(n_{\\phi,m}\\,\\phi - \\delta_{\\phi,m}\\bigr)\\bigr) \\;+\\; \\sum_{m=1}^{M_\\psi} k_{\\psi,m}\\,\\bigl(1+\\cos\\bigl(n_{\\psi,m}\\,\\psi - \\delta_{\\psi,m}\\bigr)\\bigr) \\;+\\; k_c\\,\\bigl(1+\\cos\\bigl(\\phi - \\psi - \\delta_c\\bigr)\\bigr),\n$$\nwhere all Fourier phase offsets $\\delta$ and angles are in degrees but must be converted to radians before evaluation of the cosine. All force constants $k$ are in kilocalories per mole. The system is assumed to be in the canonical ensemble at absolute temperature $T$ (in Kelvin), with the Boltzmann distribution $p(\\phi,\\psi) \\propto \\exp\\!\\bigl(-\\beta\\,E(\\phi,\\psi)\\bigr)$, where $\\beta = 1/(k_B T)$ and the Boltzmann constant is $k_B = 0.0019872041$ kilocalories per mole per Kelvin.\n\nDefine the “syn” region $\\mathcal{A}$ as the set of torsions with $|\\phi|\\le 90^\\circ$ and $|\\psi|\\le 90^\\circ$, and let $\\mathcal{B}$ be its complement in the full torsional domain $(-180^\\circ,180^\\circ]\\times(-180^\\circ,180^\\circ]$. The free energy difference between regions is\n$$\n\\Delta G_{\\mathcal{A}\\to \\mathcal{B}} \\;=\\; -\\,k_B\\,T\\,\\ln\\!\\left(\\frac{P(\\mathcal{A})}{P(\\mathcal{B})}\\right),\n$$\nwhere $P(\\mathcal{A})$ and $P(\\mathcal{B})$ are the equilibrium probabilities of being in $\\mathcal{A}$ and $\\mathcal{B}$ respectively.\n\nYour task is to write a complete program that, for each parameter set in the test suite below, computes $\\Delta G_{\\mathcal{A}\\to \\mathcal{B}}$ in kilocalories per mole using the following numerical procedure, which must be implemented exactly as stated:\n1. Discretize each torsional angle into a uniform grid with step size $s$ degrees, using midpoints so that the grid points for a single angle are $\\{-180^\\circ + s/2,\\,-180^\\circ + 3s/2,\\,\\dots,\\,180^\\circ - s/2\\}$, producing exactly $360^\\circ/s$ uniformly spaced values per angle.\n2. For each grid point $(\\phi,\\psi)$, evaluate $E(\\phi,\\psi)$ by converting all angles from degrees to radians wherever they appear as arguments of the cosine function.\n3. Compute unnormalized Boltzmann weights $w(\\phi,\\psi) = \\exp\\!\\bigl(-\\beta\\,[E(\\phi,\\psi)-E_{\\min}]\\bigr)$, where $E_{\\min}$ is the minimum energy over the entire grid (this shift is required for numerical stability and does not change probabilities).\n4. Approximate $P(\\mathcal{A})$ and $P(\\mathcal{B})$ by normalized sums of $w(\\phi,\\psi)$ over the respective regions on the grid, with the uniform measure implied by the grid. That is, $P(\\mathcal{A}) = \\sum_{(\\phi,\\psi)\\in\\mathcal{A}} w(\\phi,\\psi) \\big/ \\sum_{\\text{all}} w(\\phi,\\psi)$ and $P(\\mathcal{B}) = 1 - P(\\mathcal{A})$.\n5. Compute $\\Delta G_{\\mathcal{A}\\to \\mathcal{B}}$ using the definition above, in kilocalories per mole.\n\nAngle unit: degrees must be used for all input parameters and region definitions, and radians must be used for the cosine evaluations. Energy unit: kilocalories per mole. Temperature unit: Kelvin. The final values of $\\Delta G_{\\mathcal{A}\\to \\mathcal{B}}$ must be reported in kilocalories per mole as floating-point numbers.\n\nTest suite (each case specifies $T$ in Kelvin, lists of Fourier terms for $\\phi$ and $\\psi$ as triples $(k, n, \\delta)$ with $k$ in kilocalories per mole, $n$ unitless integer, $\\delta$ in degrees, the coupling parameters $(k_c,\\delta_c)$, and the grid step $s$ in degrees):\n- Case $1$: $T = 300$, $\\phi$-terms $=\\,$empty list, $\\psi$-terms $=\\,$empty list, $(k_c,\\delta_c) = (0,0)$, $s = 10$.\n- Case $2$: $T = 300$, $\\phi$-terms $=\\,[\\,(1.0,\\,3,\\,180)\\,]$, $\\psi$-terms $=\\,[\\,(1.0,\\,3,\\,180)\\,]$, $(k_c,\\delta_c) = (2.0,\\,180)$, $s = 10$.\n- Case $3$: $T = 900$, $\\phi$-terms $=\\,[\\,(1.0,\\,3,\\,180)\\,]$, $\\psi$-terms $=\\,[\\,(1.0,\\,3,\\,180)\\,]$, $(k_c,\\delta_c) = (2.0,\\,180)$, $s = 10$.\n- Case $4$: $T = 50$, $\\phi$-terms $=\\,[\\,(0.5,\\,1,\\,180),\\,(1.0,\\,3,\\,180)\\,]$, $\\psi$-terms $=\\,[\\,(0.5,\\,1,\\,180),\\,(1.0,\\,3,\\,180)\\,]$, $(k_c,\\delta_c) = (5.0,\\,180)$, $s = 10$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$), where each $\\text{result}_i$ is the computed $\\Delta G_{\\mathcal{A}\\to \\mathcal{B}}$ (in kilocalories per mole) for Case $i$, in the same order as above.", "solution": "The problem statement submitted for analysis is deemed valid. It is scientifically sound, well-posed, and presented with objective, unambiguous language. It describes a standard problem in computational biophysics: the calculation of a free energy difference between conformational substates from a potential energy surface. The provided energy function, statistical mechanical framework, and numerical integration procedure are all standard and well-defined. We may therefore proceed with a rigorous solution.\n\nThe solution is developed in two parts. First, we will establish the theoretical and mathematical foundation of the problem. Second, we will describe the specified numerical algorithm that operationalizes this theory for computation.\n\n**1. Theoretical Framework**\n\nThe conformational state of the disaccharide is described by two torsional angles, $\\phi$ and $\\psi$. The potential energy of the system as a function of these angles, $E(\\phi, \\psi)$, defines a two-dimensional potential energy surface (PES). The energy function is given as a sum of three components:\n$$\nE(\\phi,\\psi) \\;=\\; E_\\phi(\\phi) + E_\\psi(\\psi) + E_c(\\phi, \\psi)\n$$\nwhere $E_\\phi(\\phi)$ and $E_\\psi(\\psi)$ are sums of Fourier series terms representing the intrinsic torsional potentials for each angle, and $E_c(\\phi, \\psi)$ is a coupling term. The explicit forms are:\n$$\nE_\\phi(\\phi) = \\sum_{m=1}^{M_\\phi} k_{\\phi,m}\\,\\bigl(1+\\cos\\bigl(n_{\\phi,m}\\,\\phi - \\delta_{\\phi,m}\\bigr)\\bigr)\n$$\n$$\nE_\\psi(\\psi) = \\sum_{m=1}^{M_\\psi} k_{\\psi,m}\\,\\bigl(1+\\cos\\bigl(n_{\\psi,m}\\,\\psi - \\delta_{\\psi,m}\\bigr)\\bigr)\n$$\n$$\nE_c(\\phi, \\psi) = k_c\\,\\bigl(1+\\cos\\bigl(\\phi - \\psi - \\delta_c\\bigr)\\bigr)\n$$\nHere, the parameters $k$ are force constants (energy), $n$ are periodicities (unitless), and $\\delta$ are phase shifts (degrees). It is a strict requirement that all angle arguments to the cosine function, namely $(n\\phi - \\delta)$ and $(\\phi-\\psi-\\delta_c)$, must be converted from degrees to radians for correct evaluation.\n\nThe system is in thermal equilibrium at a temperature $T$, described by the canonical ensemble. According to the principles of statistical mechanics, the probability of observing the system in a particular conformation $(\\phi, \\psi)$ is given by the Boltzmann distribution:\n$$\np(\\phi, \\psi) = \\frac{1}{Z} \\exp\\bigl(-\\beta E(\\phi, \\psi)\\bigr)\n$$\nwhere $\\beta = 1/(k_B T)$ is the inverse thermal energy, with $k_B$ being the Boltzmann constant. The normalization factor $Z$, known as the partition function, is given by the integral over all possible conformations:\n$$\nZ = \\int_{-180^\\circ}^{180^\\circ} \\int_{-180^\\circ}^{180^\\circ} \\exp\\bigl(-\\beta E(\\phi, \\psi)\\bigr) \\,d\\phi\\,d\\psi\n$$\nThe probability of finding the system within a specific region of conformational space, such as region $\\mathcal{A}$ (the \"syn\" region, where $|\\phi| \\le 90^\\circ$ and $|\\psi| \\le 90^\\circ$), is obtained by integrating the probability density over that region:\n$$\nP(\\mathcal{A}) = \\iint_{\\mathcal{A}} p(\\phi, \\psi) \\,d\\phi\\,d\\psi = \\frac{1}{Z} \\iint_{\\mathcal{A}} \\exp\\bigl(-\\beta E(\\phi, \\psi)\\bigr) \\,d\\phi\\,d\\psi\n$$\nSimilarly for its complement, region $\\mathcal{B}$. The free energy difference between these two regions is defined in the problem as:\n$$\n\\Delta G_{\\mathcal{A}\\to \\mathcal{B}} = -k_B T \\ln\\left(\\frac{P(\\mathcal{A})}{P(\\mathcal{B})}\\right)\n$$\nThis quantity corresponds to the difference in free energy $G_{\\mathcal{A}} - G_{\\mathcal{B}}$, where the free energy of a region $\\mathcal{R}$ is given by:\n$$\nG_{\\mathcal{R}} = -k_B T \\ln Z_{\\mathcal{R}}\n$$\nand $Z_{\\mathcal{R}}$ is the partition function integral restricted to that region.\n\n**2. Numerical Procedure**\n\nThe continuous integrals for the probabilities are analytically intractable for a general energy function $E(\\phi, \\psi)$. Therefore, we must employ a numerical approximation, as specified.\n\n**Step 2.1: Grid Discretization**\nThe continuous two-dimensional domain $(\\phi, \\psi) \\in (-180^\\circ, 180^\\circ] \\times (-180^\\circ, 180^\\circ]$ is discretized into a uniform grid. For a step size of $s$ degrees, the grid points for a single angle are specified as the midpoints of the intervals: $\\{-180^\\circ + s/2, -180^\\circ + 3s/2, \\dots, 180^\\circ - s/2\\}$. This generates $N = 360/s$ points for each angle. The two-dimensional grid is then the set of all pairs $(\\phi_i, \\psi_j)$, where $i, j \\in \\{1, \\dots, N\\}$.\n\n**Step 2.2: Energy Matrix Evaluation**\nThe potential energy $E(\\phi, \\psi)$ is evaluated at each point $(\\phi_i, \\psi_j)$ of the grid, producing an $N \\times N$ energy matrix $E_{ij} = E(\\phi_i, \\psi_j)$. As mandated, all angles and phase shifts are converted to radians prior to evaluation of trigonometric functions.\n\n**Step 2.3: Boltzmann Weight Calculation**\nThe integral of the Boltzmann factor is approximated by a sum. To prevent numerical overflow or underflow when exponents are very large or small, the energies are shifted by the minimum energy on the grid, $E_{\\min} = \\min_{i,j}(E_{ij})$. This shift cancels out in the probability ratios and does not affect the final result. The unnormalized Boltzmann weight at each grid point is:\n$$\nw_{ij} = \\exp\\bigl(-\\beta (E_{ij} - E_{\\min})\\bigr)\n$$\n\n**Step 2.4: Probability Approximation**\nThe integrals for the partition functions are replaced by sums of these weights over the grid points. The sum of weights over all points in region $\\mathcal{A}$ is $W_{\\mathcal{A}} = \\sum_{(\\phi_i, \\psi_j) \\in \\mathcal{A}} w_{ij}$. The total sum of weights over the entire grid is $W_{\\text{total}} = \\sum_{i,j} w_{ij}$. The probability of being in region $\\mathcal{A}$ is then approximated by the ratio of these sums:\n$$\nP(\\mathcal{A}) \\approx \\frac{W_{\\mathcal{A}}}{W_{\\text{total}}}\n$$\nThe probability of being in the complementary region $\\mathcal{B}$ is simply $P(\\mathcal{B}) = 1 - P(\\mathcal{A})$.\n\n**Step 2.5: Free Energy Calculation**\nFinally, the computed probabilities are substituted into the given formula to calculate the free energy difference in kilocalories per mole:\n$$\n\\Delta G_{\\mathcal{A}\\to \\mathcal{B}} = -k_B T \\ln\\left(\\frac{P(\\mathcal{A})}{P(\\mathcal{B})}\\right)\n$$\nIf $P(\\mathcal{B})$ is zero, the argument of the logarithm becomes infinite, and the free energy difference will be correctly evaluated as $-\\infty$. Conversely, if $P(\\mathcal{A})$ is zero, the result will be $+\\infty$. This entire procedure is implemented for each test case provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases specified.\n    \"\"\"\n    KB_KCAL_MOL_K = 0.0019872041  # Boltzmann constant in kcal/mol/K\n\n    # Each case: T, phi_terms, psi_terms, (kc, dc), s\n    test_cases = [\n        # Case 1\n        (300.0, [], [], (0.0, 0.0), 10.0),\n        # Case 2\n        (300.0, [(1.0, 3, 180.0)], [(1.0, 3, 180.0)], (2.0, 180.0), 10.0),\n        # Case 3\n        (900.0, [(1.0, 3, 180.0)], [(1.0, 3, 180.0)], (2.0, 180.0), 10.0),\n        # Case 4\n        (50.0, [(0.5, 1, 180.0), (1.0, 3, 180.0)], [(0.5, 1, 180.0), (1.0, 3, 180.0)], (5.0, 180.0), 10.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T, phi_terms, psi_terms, coupling_params, s = case\n        \n        # 1. Discretize torsional angles\n        # Grid points are midpoints: -180+s/2, -180+3s/2, ..., 180-s/2\n        grid_1d = np.arange(-180.0 + s / 2.0, 180.0, s)\n        phi_grid_deg, psi_grid_deg = np.meshgrid(grid_1d, grid_1d)\n\n        # 2. Evaluate potential energy E(phi, psi)\n        energy = np.zeros_like(phi_grid_deg, dtype=np.float64)\n\n        # Convert grids to radians for cosine evaluation\n        phi_grid_rad = np.deg2rad(phi_grid_deg)\n        psi_grid_rad = np.deg2rad(psi_grid_deg)\n\n        # Add phi torsional terms\n        for k_phi, n_phi, d_phi in phi_terms:\n            d_phi_rad = np.deg2rad(d_phi)\n            energy += k_phi * (1.0 + np.cos(n_phi * phi_grid_rad - d_phi_rad))\n\n        # Add psi torsional terms\n        for k_psi, n_psi, d_psi in psi_terms:\n            d_psi_rad = np.deg2rad(d_psi)\n            energy += k_psi * (1.0 + np.cos(n_psi * psi_grid_rad - d_psi_rad))\n            \n        # Add coupling term\n        k_c, d_c = coupling_params\n        if k_c != 0.0:\n            d_c_rad = np.deg2rad(d_c)\n            energy += k_c * (1.0 + np.cos(phi_grid_rad - psi_grid_rad - d_c_rad))\n\n        # 3. Compute unnormalized Boltzmann weights\n        if T > 0:\n            beta = 1.0 / (KB_KCAL_MOL_K * T)\n            e_min = np.min(energy)\n            weights = np.exp(-beta * (energy - e_min))\n        else: # Handle T=0 case: only min energy state is populated\n            weights = np.zeros_like(energy)\n            weights[energy == np.min(energy)] = 1.0\n\n\n        # 4. Approximate probabilities P(A) and P(B)\n        # Define region A mask: |phi| <= 90 and |psi| <= 90\n        mask_A = (np.abs(phi_grid_deg) <= 90.0) & (np.abs(psi_grid_deg) <= 90.0)\n        \n        sum_weights_A = np.sum(weights[mask_A])\n        sum_weights_total = np.sum(weights)\n\n        if sum_weights_total == 0.0:\n            # This can happen if T=0 and min energy is not on grid, though unlikely here\n            # Or if weights underflow to zero everywhere.\n            # In this case, probabilities are ill-defined. Let's assume P(A)=0, P(B)=1\n            # as a fallback, which would lead to +inf free energy.\n            prob_A = 0.0\n        else:\n            prob_A = sum_weights_A / sum_weights_total\n        \n        prob_B = 1.0 - prob_A\n\n        # 5. Compute free energy difference\n        if prob_B == 0.0:\n            # System is always in A. P(A)/P(B) -> +inf. log -> +inf. deltaG -> -inf.\n            delta_G = -np.inf\n        elif prob_A == 0.0:\n            # System is always in B. P(A)/P(B) -> 0. log -> -inf. deltaG -> +inf.\n            delta_G = np.inf\n        else:\n            ratio = prob_A / prob_B\n            delta_G = -KB_KCAL_MOL_K * T * np.log(ratio)\n\n        results.append(delta_G)\n\n    # Print results in the required format\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2556527"}]}