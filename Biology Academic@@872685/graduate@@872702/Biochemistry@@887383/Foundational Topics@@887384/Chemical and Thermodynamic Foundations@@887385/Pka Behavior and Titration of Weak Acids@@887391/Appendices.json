{"hands_on_practices": [{"introduction": "The Henderson-Hasselbalch equation is a cornerstone of daily work in a biochemistry lab, offering a quick way to estimate the pH of a buffer. However, its simplicity belies a foundation built on key approximations. This exercise takes you back to first principles, requiring you to derive the pH of a buffer solution from the fundamental laws of mass balance and electroneutrality, and then to justify the approximations that lead to the familiar, simplified equation. Mastering this process is crucial for understanding the limits of our models and for troubleshooting when experimental results deviate from expectations [@problem_id:2587753].", "problem": "An aqueous buffer is prepared at temperature $T = 298~\\mathrm{K}$ by dissolving a monoprotic weak acid $\\mathrm{HA}$ and its sodium salt $\\mathrm{NaA}$ to give formal (analytical) concentrations $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ and $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$, respectively, in a final volume that can be taken as unchanged by mixing. The acid dissociation constant $K_{a}$ of $\\mathrm{HA}$ at $T = 298~\\mathrm{K}$ corresponds to $pK_{a} = 5.00$, with $K_{a} = 10^{-pK_{a}}$. Assume ideal solution behavior (activity coefficients equal to $1$ for all ionic species) and that sodium ions do not undergo hydrolysis. The ionic product of water is $K_{w} = 1.0 \\times 10^{-14}$. \n\nStarting only from the definitions of the acid dissociation equilibrium constant, the electroneutrality (charge balance) condition, the total mass balance for the acid moiety, and the definition of acidity $pH = -\\log_{10}\\left[ \\mathrm{H^{+}} \\right]$, determine the equilibrium $pH$ of the solution. Justify any approximations you make by checking their self-consistency against the scales set by $F_{\\mathrm{HA}}$, $F_{\\mathrm{A^{-}}}$, and $K_{w}$. Report the final $pH$ as a pure number (no unit), rounded to three significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard scenario in aqueous equilibrium chemistry. All necessary data are provided, and the premises are consistent with fundamental chemical principles. Therefore, the problem is valid, and a solution can be formulated.\n\nThe task is to determine the equilibrium $pH$ of a buffer solution prepared from a weak acid $\\mathrm{HA}$ and its conjugate base salt $\\mathrm{NaA}$. We must start from fundamental principles as specified.\n\nThe chemical species present in the aqueous solution are $\\mathrm{H}^{+}$, $\\mathrm{OH}^{-}$, $\\mathrm{Na}^{+}$, $\\mathrm{HA}$, and $\\mathrm{A}^{-}$. Their concentrations are governed by the following equilibria and conservation laws.\n\n1.  **Acid Dissociation Equilibrium**: The dissociation of the weak acid $\\mathrm{HA}$ is described by its acid dissociation constant, $K_a$.\n    $$K_a = \\frac{[\\mathrm{H}^{+}][\\mathrm{A}^{-}]}{[\\mathrm{HA}]}$$\n    Given $pK_a = 5.00$, the constant is $K_a = 10^{-5.00}$.\n\n2.  **Water Autoionization**: The dissociation of water establishes an equilibrium between hydronium and hydroxide ions.\n    $$K_w = [\\mathrm{H}^{+}][\\mathrm{OH}^{-}]$$\n    At $T = 298~\\mathrm{K}$, $K_w = 1.0 \\times 10^{-14}$.\n\n3.  **Mass Balance**: The total concentration of the acid moiety (species containing 'A') is the sum of the initial formal concentrations, $F_{\\mathrm{HA}}$ and $F_{\\mathrm{A^{-}}}$.\n    $$[\\mathrm{HA}] + [\\mathrm{A}^{-}] = F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}$$\n    Here, $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ and $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$.\n\n4.  **Electroneutrality (Charge Balance)**: The solution as a whole must be electrically neutral. The sum of the concentrations of positive ions must equal the sum of the concentrations of negative ions. The sodium salt $\\mathrm{NaA}$ is a strong electrolyte and dissociates completely, thus $[\\mathrm{Na}^{+}] = F_{\\mathrm{A^{-}}}$.\n    $$[\\mathrm{Na}^{+}] + [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}]$$\n    Substituting for $[\\mathrm{Na}^{+}]$, we have:\n    $$F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}]$$\n\nThese four equations form a complete system to determine the five unknown concentrations. We seek to find $[\\mathrm{H}^{+}]$.\n\nFrom the charge balance equation, we can express the equilibrium concentration of the conjugate base, $[\\mathrm{A}^{-}]$:\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}]$$\nUsing the water autoionization equilibrium, we replace $[\\mathrm{OH}^{-}]$ with $\\frac{K_w}{[\\mathrm{H}^{+}]}$:\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}$$\nFrom the mass balance equation, we express the equilibrium concentration of the weak acid, $[\\mathrm{HA}]$:\n$$[\\mathrm{HA}] = (F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}) - [\\mathrm{A}^{-}]$$\nSubstituting the expression for $[\\mathrm{A}^{-}]$:\n$$[\\mathrm{HA}] = (F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}) - \\left(F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}\\right) = F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]}$$\nNow, we substitute these exact expressions for $[\\mathrm{HA}]$ and $[\\mathrm{A}^{-}]$ into the acid dissociation equilibrium equation:\n$$K_a = \\frac{[\\mathrm{H}^{+}] \\left(F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}\\right)}{F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]}}$$\nThis equation is exact but forms a cubic polynomial in $[\\mathrm{H}^{+}]$. We can solve it, but it is standard practice to use justified approximations for buffer systems.\n\nThe problem requires justification of any approximations. The solution is a buffer with a $pK_a = 5.00$. Therefore, we expect the $pH$ to be close to $5$, meaning $[\\mathrm{H}^{+}] \\approx 10^{-5}~\\mathrm{M}$ and $[\\mathrm{OH}^{-}] = K_w / [\\mathrm{H}^{+}] \\approx 10^{-9}~\\mathrm{M}$. We compare these values to the formal concentrations $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ and $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$.\nWe observe that $[\\mathrm{H}^{+}] \\ll F_{\\mathrm{HA}}$, $[\\mathrm{H}^{+}] \\ll F_{\\mathrm{A^{-}}}$, $[\\mathrm{OH}^{-}] \\ll F_{\\mathrm{HA}}$, and $[\\mathrm{OH}^{-}] \\ll F_{\\mathrm{A^{-}}}$.\nThis suggests that the terms $[\\mathrm{H}^{+}]$ and $[\\mathrm{OH}^{-}]$ are negligible compared to $F_{\\mathrm{HA}}$ and $F_{\\mathrm{A^{-}}}$ in the expressions for the equilibrium concentrations $[\\mathrm{HA}]$ and $[\\mathrm{A}^{-}]$.\n\nLet us apply this approximation:\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}] \\approx F_{\\mathrm{A^{-}}}$$\n$$[\\mathrm{HA}] = F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]} \\approx F_{\\mathrm{HA}}$$\nThis approximation is valid if the extent of dissociation of $\\mathrm{HA}$ and hydrolysis of $\\mathrm{A}^{-}$ is small compared to their initial formal concentrations.\nSubstituting these approximations into the $K_a$ expression gives the simplified relation:\n$$K_a \\approx \\frac{[\\mathrm{H}^{+}]F_{\\mathrm{A^{-}}}}{F_{\\mathrm{HA}}}$$\nSolving for $[\\mathrm{H}^{+}]$:\n$$[\\mathrm{H}^{+}] \\approx K_a \\frac{F_{\\mathrm{HA}}}{F_{\\mathrm{A^{-}}}}$$\nWe substitute the given values:\n$$[\\mathrm{H}^{+}] \\approx (10^{-5.00}) \\times \\frac{0.100}{0.050} = (1.00 \\times 10^{-5}) \\times 2.00 = 2.00 \\times 10^{-5}~\\mathrm{M}$$\n\nNow, we perform the self-consistency check for the approximations. Using our calculated value $[\\mathrm{H}^{+}] \\approx 2.00 \\times 10^{-5}~\\mathrm{M}$:\n$$[\\mathrm{OH}^{-}] = \\frac{K_w}{[\\mathrm{H}^{+}]} = \\frac{1.0 \\times 10^{-14}}{2.00 \\times 10^{-5}} = 5.0 \\times 10^{-10}~\\mathrm{M}$$\nWe check the fractional error in the approximation for $[\\mathrm{A}^{-}]$:\nThe term we neglected relative to $F_{\\mathrm{A^{-}}}$ is $([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])$.\n$$\\frac{|[\\mathrm{H}^{+}]-[\\mathrm{OH}^{-}]|}{F_{\\mathrm{A^{-}}}}=\\frac{|2.00 \\times 10^{-5} - 5.0 \\times 10^{-10}|}{0.050} \\approx \\frac{2.00 \\times 10^{-5}}{0.050} = 4.0 \\times 10^{-4}$$\nThis corresponds to a relative error of $0.04 \\%$.\nWe check the fractional error in the approximation for $[\\mathrm{HA}]$:\nThe term we neglected relative to $F_{\\mathrm{HA}}$ is also $([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])$, but it appears as $([\\mathrm{H}^{+}] - K_w/[\\mathrm{H}^{+}])$ with a negative sign.\n$$\\frac{|-([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])|}{F_{\\mathrm{HA}}}=\\frac{|-(2.00 \\times 10^{-5} - 5.0 \\times 10^{-10})|}{0.100} \\approx \\frac{2.00 \\times 10^{-5}}{0.100} = 2.0 \\times 10^{-4}$$\nThis corresponds to a relative error of $0.02 \\%$.\nBoth errors are very small, confirming that the approximations $[\\mathrm{A}^{-}] \\approx F_{\\mathrm{A^{-}}}$ and $[\\mathrm{HA}] \\approx F_{\\mathrm{HA}}$ are justified for the required precision.\n\nWith the value of $[\\mathrm{H}^{+}]$ validated, we can now calculate the $pH$:\n$$pH = -\\log_{10}([\\mathrm{H}^{+}]) = -\\log_{10}(2.00 \\times 10^{-5})$$\n$$pH = -(\\log_{10}(2.00) + \\log_{10}(10^{-5})) = 5.00 - \\log_{10}(2.00)$$\nUsing a calculator, $\\log_{10}(2.00) \\approx 0.30103$.\n$$pH \\approx 5.00 - 0.30103 = 4.69897$$\nThe problem requires the answer to be rounded to three significant figures.\n$$pH \\approx 4.70$$\nThis final result is consistent with our initial assessment and has been derived strictly from the given principles, with all approximations rigorously justified.", "answer": "$$\\boxed{4.70}$$", "id": "2587753"}, {"introduction": "Ideal titrations exist only in textbooks; real-world experiments are often complicated by unforeseen factors. This practice explores a classic and highly practical scenario: the contamination of a strong base titrant with atmospheric carbon dioxide, forming carbonate. You will quantify how this contamination affects the total base equivalents in the titrant and, consequently, shifts the measured equivalence point. This problem sharpens your stoichiometric reasoning and underscores the importance of accounting for all reactive species to ensure accuracy in experimental analysis [@problem_id:2587754].", "problem": "A monoprotic weak acid solution with acid dissociation constant $pK_{a} = 4.76$ is prepared at concentration $C_{\\mathrm{HA}} = 0.1000\\ \\mathrm{mol\\ L^{-1}}$, volume $V_{\\mathrm{HA}} = 50.00\\ \\mathrm{mL}$. It is titrated at constant temperature with a sodium hydroxide titrant of nominal hydroxide concentration $C_{\\mathrm{OH^{-}}} = 0.1000\\ \\mathrm{mol\\ L^{-1}}$. The titrant is contaminated by dissolved sodium carbonate at concentration $C_{\\mathrm{CO_{3}^{2-}}} = 0.00050\\ \\mathrm{mol\\ L^{-1}}$ due to carbon dioxide uptake during storage. Assume carbon dioxide exchange with the atmosphere during titration is negligible, activity coefficients are unity, and the potentiometric detection identifies the stoichiometric equivalence point accurately. Treat carbonate as a dibasic base capable of accepting two protons in the acidic regime encountered before the equivalence point of the weak acid titration. \n\nStarting from the Brønsted–Lowry definitions of acids and bases and conservation of mass and charge, derive the expression for the stoichiometric equivalence volume when the titrant contains both hydroxide and carbonate. Then compute the numerical shift in the apparent equivalence volume, defined as $\\Delta V \\equiv V_{\\mathrm{eq,\\,contam}} - V_{\\mathrm{eq,\\,pure}}$, where $V_{\\mathrm{eq,\\,pure}}$ is the equivalence volume if the titrant contained only hydroxide at concentration $C_{\\mathrm{OH^{-}}}$ and $V_{\\mathrm{eq,\\,contam}}$ is the equivalence volume with the stated carbonate contamination. \n\nExpress your final answer for $\\Delta V$ in $\\mathrm{mL}$ and round your answer to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It describes a realistic scenario in analytical chemistry and is based on fundamental principles of stoichiometry. Therefore, the problem is valid, and a solution will be provided.\n\nThe stoichiometric equivalence point of an acid-base titration is defined as the point at which the number of moles of base equivalents added from the titrant is equal to the number of moles of acid originally present in the analyte. The acid is monoprotic, so each mole of acid, $\\mathrm{HA}$, provides one mole of protons.\n\nLet $n_{\\mathrm{HA}}$ be the initial moles of the weak acid. This is given by the product of its initial concentration, $C_{\\mathrm{HA}}$, and its initial volume, $V_{\\mathrm{HA}}$.\n$$n_{\\mathrm{HA}} = C_{\\mathrm{HA}} V_{\\mathrm{HA}}$$\nUsing the provided values:\n$C_{\\mathrm{HA}} = 0.1000\\ \\mathrm{mol\\ L^{-1}}$\n$V_{\\mathrm{HA}} = 50.00\\ \\mathrm{mL} = 0.05000\\ \\mathrm{L}$\n$$n_{\\mathrm{HA}} = (0.1000\\ \\mathrm{mol\\ L^{-1}}) \\times (0.05000\\ \\mathrm{L}) = 0.005000\\ \\mathrm{mol}$$\n\nFirst, consider the ideal case with a pure sodium hydroxide titrant. The only base is hydroxide, $\\mathrm{OH^{-}}$, which accepts one proton per ion. At the equivalence point, the moles of added hydroxide, $n_{\\mathrm{OH^{-}}}$, must equal the initial moles of acid, $n_{\\mathrm{HA}}$.\n$$n_{\\mathrm{OH^{-}}} = n_{\\mathrm{HA}}$$\nThe moles of added hydroxide are given by the product of its concentration, $C_{\\mathrm{OH^{-}}}$, and the volume of titrant added, $V_{\\mathrm{eq,\\,pure}}$.\n$$C_{\\mathrm{OH^{-}}} V_{\\mathrm{eq,\\,pure}} = C_{\\mathrm{HA}} V_{\\mathrm{HA}}$$\nSolving for the pure equivalence volume, $V_{\\mathrm{eq,\\,pure}}$:\n$$V_{\\mathrm{eq,\\,pure}} = \\frac{C_{\\mathrm{HA}} V_{\\mathrm{HA}}}{C_{\\mathrm{OH^{-}}}}$$\n\nNext, consider the case with the contaminated titrant. The titrant contains both hydroxide, $\\mathrm{OH^{-}}$, at concentration $C_{\\mathrm{OH^{-}}}$, and carbonate, $\\mathrm{CO_{3}^{2-}}$, at concentration $C_{\\mathrm{CO_{3}^{2-}}}$. According to the Brønsted–Lowry definition, both are bases as they are proton acceptors. Hydroxide accepts one proton: $\\mathrm{OH^{-}} + \\mathrm{H^{+}} \\rightarrow \\mathrm{H_{2}O}$. The problem specifies that carbonate is to be treated as a dibasic base, accepting two protons in the acidic environment of the titration: $\\mathrm{CO_{3}^{2-}} + 2\\mathrm{H^{+}} \\rightarrow \\mathrm{H_{2}CO_{3}}$.\n\nFor a volume $V_{\\mathrm{eq,\\,contam}}$ of contaminated titrant added, the moles of each base are:\nMoles of hydroxide: $n_{\\mathrm{OH^{-}}} = C_{\\mathrm{OH^{-}}} V_{\\mathrm{eq,\\,contam}}$\nMoles of carbonate: $n_{\\mathrm{CO_{3}^{2-}}} = C_{\\mathrm{CO_{3}^{2-}}} V_{\\mathrm{eq,\\,contam}}$\n\nThe total number of moles of protons accepted by the bases in this volume of titrant, which we can call the total base equivalents $n_{\\mathrm{base,\\,total}}$, is the sum of protons accepted by each species.\n$$n_{\\mathrm{base,\\,total}} = (1 \\times n_{\\mathrm{OH^{-}}}) + (2 \\times n_{\\mathrm{CO_{3}^{2-}}})$$\nSubstituting the expressions for moles:\n$$n_{\\mathrm{base,\\,total}} = C_{\\mathrm{OH^{-}}} V_{\\mathrm{eq,\\,contam}} + 2 C_{\\mathrm{CO_{3}^{2-}}} V_{\\mathrm{eq,\\,contam}}$$\nFactoring out $V_{\\mathrm{eq,\\,contam}}$:\n$$n_{\\mathrm{base,\\,total}} = (C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}}) V_{\\mathrm{eq,\\,contam}}$$\nThe term $(C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}})$ represents the total normality or equivalent concentration of the basic titrant.\n\nAt the stoichiometric equivalence point, the total base equivalents added must equal the initial moles of acid.\n$$n_{\\mathrm{base,\\,total}} = n_{\\mathrm{HA}}$$\n$$(C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}}) V_{\\mathrm{eq,\\,contam}} = C_{\\mathrm{HA}} V_{\\mathrm{HA}}$$\nThis is the required relationship. Solving for the equivalence volume with contaminated titrant, $V_{\\mathrm{eq,\\,contam}}$:\n$$V_{\\mathrm{eq,\\,contam}} = \\frac{C_{\\mathrm{HA}} V_{\\mathrm{HA}}}{C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}}}$$\n\nThe problem requires the calculation of the shift in equivalence volume, $\\Delta V$, defined as $\\Delta V \\equiv V_{\\mathrm{eq,\\,contam}} - V_{\\mathrm{eq,\\,pure}}$.\nSubstituting the derived expressions for both volumes:\n$$\\Delta V = \\frac{C_{\\mathrm{HA}} V_{\\mathrm{HA}}}{C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}}} - \\frac{C_{\\mathrm{HA}} V_{\\mathrm{HA}}}{C_{\\mathrm{OH^{-}}}}$$\nFactor out the common term $C_{\\mathrm{HA}} V_{\\mathrm{HA}}$:\n$$\\Delta V = C_{\\mathrm{HA}} V_{\\mathrm{HA}} \\left( \\frac{1}{C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}}} - \\frac{1}{C_{\\mathrm{OH^{-}}}} \\right)$$\nTo simplify, combine the fractions inside the parentheses by finding a common denominator:\n$$\\Delta V = C_{\\mathrm{HA}} V_{\\mathrm{HA}} \\left( \\frac{C_{\\mathrm{OH^{-}}} - (C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}})}{C_{\\mathrm{OH^{-}}}(C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}})} \\right)$$\n$$\\Delta V = C_{\\mathrm{HA}} V_{\\mathrm{HA}} \\left( \\frac{-2 C_{\\mathrm{CO_{3}^{2-}}}}{C_{\\mathrm{OH^{-}}}(C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}})} \\right)$$\nThe final expression for the shift in volume is:\n$$\\Delta V = - \\frac{2 C_{\\mathrm{HA}} V_{\\mathrm{HA}} C_{\\mathrm{CO_{3}^{2-}}}}{C_{\\mathrm{OH^{-}}}(C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}})}$$\nThe negative sign indicates that a smaller volume of the contaminated titrant is required to reach the equivalence point, which is logical because the contaminated titrant has a higher total base normality.\n\nNow, we substitute the given numerical values to compute $\\Delta V$.\n$C_{\\mathrm{HA}} = 0.1000\\ \\mathrm{mol\\ L^{-1}}$\n$V_{\\mathrm{HA}} = 50.00\\ \\mathrm{mL}$\n$C_{\\mathrm{OH^{-}}} = 0.1000\\ \\mathrm{mol\\ L^{-1}}$\n$C_{\\mathrm{CO_{3}^{2-}}} = 0.00050\\ \\mathrm{mol\\ L^{-1}}$\n\nAll concentration units are in $\\mathrm{mol\\ L^{-1}}$, which can be written as $\\mathrm{M}$. These units will cancel, leaving the final result in the units of $V_{\\mathrm{HA}}$, which is $\\mathrm{mL}$.\n$$\\Delta V = - \\frac{2 (0.1000\\ \\mathrm{M}) (50.00\\ \\mathrm{mL}) (0.00050\\ \\mathrm{M})}{(0.1000\\ \\mathrm{M})(0.1000\\ \\mathrm{M} + 2 \\times 0.00050\\ \\mathrm{M})}$$\nFirst, evaluate the denominator term:\n$$C_{\\mathrm{OH^{-}}} + 2 C_{\\mathrm{CO_{3}^{2-}}} = 0.1000 + 2(0.00050) = 0.1000 + 0.00100 = 0.10100\\ \\mathrm{M}$$\nNow substitute this back into the expression for $\\Delta V$:\n$$\\Delta V = - \\frac{2 \\times 0.1000 \\times 50.00 \\times 0.00050}{0.1000 \\times 0.10100}\\ \\mathrm{mL}$$\nCalculate the numerator:\n$$2 \\times 0.1000 \\times 50.00 \\times 0.00050 = 0.005000$$\nCalculate the denominator:\n$$0.1000 \\times 0.10100 = 0.01010$$\n$$\\Delta V = - \\frac{0.005000}{0.01010}\\ \\mathrm{mL} = -0.4950495...\\ \\mathrm{mL}$$\nRounding the result to four significant figures as requested gives:\n$$\\Delta V = -0.4950\\ \\mathrm{mL}$$\nThe $pK_a$ value was not required for the stoichiometric calculation, but it serves to establish that the weak acid is sufficiently acidic for the assumed reactions with carbonate to be chemically reasonable.", "answer": "$$\\boxed{-0.4950}$$", "id": "2587754"}, {"introduction": "In proteins and nucleic acids, titratable groups are rarely isolated and their ionization behavior can be coupled through electrostatic interactions. This advanced practice moves beyond simple titrations to the realm of biophysical modeling, a core skill in modern biochemistry. You will develop a statistical thermodynamic model for a two-site system with coupled equilibria, simulate spectroscopic data, and perform a global nonlinear fit to disentangle the overlapping microscopic $pK_a$ values and their interaction energy. This exercise provides a powerful look at how we can use macroscopic data to deduce the microscopic properties that govern biological function [@problem_id:2587737].", "problem": "You are tasked with designing and analyzing a titration experiment to disentangle overlapping acid dissociation constants, denoted as $pK_a$, of two nearby titratable residues that may interact. The experiment uses two independent spectroscopic probes whose signals depend on the microstate of protonation of the two residues. Your program must simulate titration curves for specified parameter sets and then perform a global nonlinear least-squares fit to recover the $pK_a$ values and an interaction parameter from the combined probe data. The problem must be addressed from first principles of acid-base equilibrium and mass-action, and the program must implement the derived equations without using shortcut formulas.\n\nBegin from the following base facts only:\n- The acid dissociation constant is defined by $K_a = \\frac{[\\mathrm{A}^-][\\mathrm{H}^+]}{[\\mathrm{HA}]}$, and $pK_a = -\\log_{10} K_a$.\n- For a fixed hydrogen ion activity, $[\\mathrm{H}^+]$, the relative propensity to deprotonate a site is governed by mass action.\n- The spectroscopic signal is the population-weighted average of microstate-specific signals.\n\nModel the two residues as a coupled two-site acid-base system with four microstates: both protonated, residue $\\mathrm{A}$ deprotonated only, residue $\\mathrm{B}$ deprotonated only, and both deprotonated. Let the microscopic $pK_a$ values be $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$, and let $c$ be a dimensionless cooperativity factor such that the statistical weight of the doubly deprotonated state is multiplied by $c$ relative to the case of no coupling ($c = 1$ corresponds to independent sites; $c > 1$ indicates positive cooperativity; $c  1$ indicates negative cooperativity). Let $\\mathrm{pH}$ be the solution acidity, treated as a unitless quantity.\n\nFor each spectroscopic probe $j \\in \\{1,2\\}$, define fixed, known microstate-specific signals $s^{(j)}_{00}$, $s^{(j)}_{10}$, $s^{(j)}_{01}$, and $s^{(j)}_{11}$ corresponding to the four microstates: ($00$) both protonated, ($10$) only $\\mathrm{A}$ deprotonated, ($01$) only $\\mathrm{B}$ deprotonated, and ($11$) both deprotonated. The observed signal at a given $\\mathrm{pH}$ is the population-weighted average of these microstate signals.\n\nYour program must:\n- Use the mass-action model to compute microstate weights as functions of $\\mathrm{pH}$, $pK_{a,\\mathrm{A}}$, $pK_{a,\\mathrm{B}}$, and $c$, normalize them to populations, and use them to compute probe signals as population-weighted averages.\n- Generate synthetic titration data at a specified set of $\\mathrm{pH}$ values with known parameters by evaluating the forward model, without adding noise.\n- Perform a global nonlinear least-squares fit across both probes and all $\\mathrm{pH}$ points to estimate $pK_{a,\\mathrm{A}}$, $pK_{a,\\mathrm{B}}$, and $c$ simultaneously from the combined data. Implement parameter bounds such that $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$ remain within $[3,11]$ and $c$ remains within $[10^{-2},10^{2}]$.\n- Return the estimated parameters for each test case.\n\nUse the following fixed microstate-specific signals (arbitrary units) for the two probes, which are known to the fitting model:\n- Probe $\\#1$: $s^{(1)}_{00} = 0.20$, $s^{(1)}_{10} = 1.00$, $s^{(1)}_{01} = 0.25$, $s^{(1)}_{11} = 1.05$.\n- Probe $\\#2$: $s^{(2)}_{00} = 0.30$, $s^{(2)}_{10} = 0.35$, $s^{(2)}_{01} = 1.10$, $s^{(2)}_{11} = 1.15$.\n\nUse the following $\\mathrm{pH}$ grid (unitless) for all cases:\n- $\\mathrm{pH}$ points: $[4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0]$.\n\nTest Suite:\nEach test case specifies true $(pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c)$. Simulate the data using these true parameters, then fit to recover them.\n- Case $1$ (distinct, independent): $(6.50, 8.20, 1.00)$.\n- Case $2$ (overlapping, independent): $(6.90, 7.00, 1.00)$.\n- Case $3$ (moderate positive cooperativity): $(6.80, 7.20, 5.00)$.\n- Case $4$ (negative cooperativity): $(6.80, 7.20, 0.20)$.\n\nAnswer format and units:\n- Report $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$ as unitless numbers rounded to two decimal places.\n- Report $c$ as a unitless number rounded to two decimal places.\n- If your fit internally labels the sites differently, sort the reported $pK_a$ values in ascending order before output; report the same fitted $c$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of lists, enclosed in square brackets. Each inner list must contain three floats $[pK_{a,\\min}, pK_{a,\\max}, c]$ for that case. For example, a valid output for two cases would look like: $[[6.50,7.80,1.00],[6.90,7.00,1.00]]$.\n\nYour program must be a complete, runnable program that produces exactly one line in the specified format and nothing else.", "solution": "The problem presented is a well-posed exercise in biophysical chemistry, requiring the derivation and application of a statistical thermodynamic model for coupled equilibria. It is based on sound scientific principles and is free of logical or factual inconsistencies. Therefore, we shall proceed with a complete solution.\n\nThe system consists of two titratable sites, $\\mathrm{A}$ and $\\mathrm{B}$, which can exist in one of four protonation microstates: $M_{00}$ ($\\mathrm{HA}-\\mathrm{HB}$), $M_{10}$ ($\\mathrm{A}^{-}-\\mathrm{HB}$), $M_{01}$ ($\\mathrm{HA}-\\mathrm{B}^{-}$), and $M_{11}$ ($\\mathrm{A}^{-}-\\mathrm{B}^{-}$). The objective is to determine the intrinsic acid dissociation constants, $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$, and a parameter $c$ quantifying their interaction, from spectroscopic titration data.\n\nWe begin from first principles of mass-action. The microscopic acid dissociation equilibria are:\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+} \\quad \\text{with} \\quad K_a = \\frac{[\\mathrm{A}^{-}][\\mathrm{H}^{+}]}{[\\mathrm{HA}]}\n$$\nFrom this, we define $pK_a = -\\log_{10} K_a$ and use the definition of $\\mathrm{pH} = -\\log_{10} [\\mathrm{H}^{+}]$. Note that $\\mathrm{pH}$ is treated as a unitless quantity as specified.\n\nTo model the system, we define statistical weights for each of the four microstates relative to the fully protonated state, $M_{00}$, whose weight is set to unity by convention, $w_{00} = 1$.\n\nThe equilibrium between $M_{00}$ and $M_{10}$ is $M_{00} \\rightleftharpoons M_{10} + \\mathrm{H}^{+}$. The equilibrium constant is the microscopic constant for site $\\mathrm{A}$, $K_{a,\\mathrm{A}}$.\n$$\nK_{a,\\mathrm{A}} = \\frac{[M_{10}][\\mathrm{H}^{+}]}{[M_{00}]} \\implies \\frac{[M_{10}]}{[M_{00}]} = \\frac{K_{a,\\mathrm{A}}}{[\\mathrm{H}^{+}]} = 10^{-pK_{a,\\mathrm{A}}} \\cdot 10^{\\mathrm{pH}} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}\n$$\nThe statistical weight of $M_{10}$ is therefore $w_{10} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}$.\nBy identical logic for site $\\mathrm{B}$, the statistical weight of $M_{01}$ is $w_{01} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{B}}}$.\n\nFor the doubly deprotonated state, $M_{11}$, we consider the overall equilibrium $M_{00} \\rightleftharpoons M_{11} + 2\\mathrm{H}^{+}$. The statistical weight $w_{11}$ is given by $[M_{11}]/[M_{00}]$. In the absence of coupling ($c = 1$), the sites titrate independently. The thermodynamic path from $M_{00}$ to $M_{11}$ involves two proton dissociations with constants $K_{a,\\mathrm{A}}$ and $K_{a,\\mathrm{B}}$, leading to $w_{11, \\text{uncoupled}} = \\frac{K_{a,\\mathrm{A}}K_{a,\\mathrm{B}}}{[\\mathrm{H}^{+}]^2} = 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}$.\nThe problem introduces a cooperativity factor, $c$, which modifies the statistical weight of the $M_{11}$ state. This factor directly accounts for the interaction energy between the sites. Thus, the weight of the doubly deprotonated state is:\n$$\nw_{11} = c \\cdot w_{11, \\text{uncoupled}} = c \\cdot 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}\n$$\nA value of $c > 1$ denotes positive cooperativity (deprotonation of one site facilitates deprotonation of the other), while $c  1$ denotes negative cooperativity.\n\nThe set of statistical weights is:\n$w_{00} = 1$\n$w_{10} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}$\n$w_{01} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{B}}}$\n$w_{11} = c \\cdot 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}$\n\nThe probability, or population, of each microstate is its weight divided by the sum of all weights, which is the partition function $Z$:\n$$\nZ(\\mathrm{pH}; pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c) = w_{00} + w_{10} + w_{01} + w_{11}\n$$\nThe populations are:\n$P_{00} = w_{00}/Z$, $P_{10} = w_{10}/Z$, $P_{01} = w_{01}/Z$, $P_{11} = w_{11}/Z$.\n\nThe observed signal for each spectroscopic probe $j \\in \\{1, 2\\}$ is the population-weighted average of the signals from each of the four microstates ($s^{(j)}_{00}, s^{(j)}_{10}, s^{(j)}_{01}, s^{(j)}_{11}$):\n$$\nS^{(j)}(\\mathrm{pH}) = P_{00} s^{(j)}_{00} + P_{10} s^{(j)}_{10} + P_{01} s^{(j)}_{01} + P_{11} s^{(j)}_{11}\n$$\nThis equation constitutes the forward model, which predicts the spectroscopic signal at any $\\mathrm{pH}$ for a given set of parameters $\\theta = (pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c)$.\n\nTo recover the parameters from experimental data, we perform a global nonlinear least-squares fit. The goal is to find the parameter set $\\theta_{fit}$ that minimizes the sum of squared residuals (SSR) between the synthetic data ($S^{(j)}_{data}$) and the model's predictions ($S^{(j)}_{model}$) across both probes and all $\\mathrm{pH}$ points:\n$$\n\\text{SSR}(\\theta) = \\sum_{j=1}^{2} \\sum_{i} \\left[ S^{(j)}_{data}(\\mathrm{pH}_i) - S^{(j)}_{model}(\\mathrm{pH}_i; \\theta) \\right]^2\n$$\nThis optimization will be performed numerically using the Levenberg-Marquardt algorithm, as implemented in the `scipy.optimize.least_squares` library function. Parameter bounds are imposed as specified: $pK_a \\in [3, 11]$ and $c \\in [10^{-2}, 10^2]$.\n\nThe procedure for each test case is as follows:\n$1$. Generate synthetic titration data for both probes across the given $\\mathrm{pH}$ grid using the forward model with the true parameters.\n$2$. Define a residual function that computes the difference between the synthetic data and the model prediction for a given set of trial parameters.\n$3$. Execute the numerical optimization to find the parameters that minimize the sum of the squares of these residuals.\n$4$. The resulting fitted $pK_a$ values must be sorted in ascending order to ensure a unique representation, as the model is symmetric with respect to the exchange of site labels $\\mathrm{A}$ and $\\mathrm{B}$. The final parameters are then reported with the required precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting coupled pKa values from simulated spectroscopic data.\n    \"\"\"\n\n    # --- Fixed parameters from the problem statement ---\n\n    # Microstate-specific signals for Probe 1 and Probe 2\n    # s_j_ik where j is probe index (0-indexed) and ik is microstate (00, 10, 01, 11)\n    # Microstates: 00 (H-H), 10 (A- - H), 01 (H - B-), 11 (A- - B-)\n    S_MICROSTATE = np.array([\n        [0.20, 1.00, 0.25, 1.05],  # Probe 1 signals\n        [0.30, 0.35, 1.10, 1.15]   # Probe 2 signals\n    ])\n    S00, S10, S01, S11 = S_MICROSTATE[:, 0], S_MICROSTATE[:, 1], S_MICROSTATE[:, 2], S_MICROSTATE[:, 3]\n\n    # pH grid for the titration\n    PH_GRID = np.array([4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0])\n\n    # Test cases: (pKa_A, pKa_B, c)\n    test_cases = [\n        (6.50, 8.20, 1.00),\n        (6.90, 7.00, 1.00),\n        (6.80, 7.20, 5.00),\n        (6.80, 7.20, 0.20),\n    ]\n\n    def forward_model(ph_values, pka_a, pka_b, c):\n        \"\"\"\n        Calculates the theoretical spectroscopic signal for both probes.\n        \n        Args:\n            ph_values (np.ndarray): Array of pH values.\n            pka_a (float): Microscopic pKa of site A.\n            pka_b (float): Microscopic pKa of site B.\n            c (float): Cooperativity factor.\n\n        Returns:\n            np.ndarray: A (2, N) array where N is the number of pH points.\n                        Row 0 is the signal for Probe 1, Row 1 for Probe 2.\n        \"\"\"\n        # Calculate statistical weights for each microstate at each pH\n        exp_ph_pkaa = 10**(ph_values - pka_a)\n        exp_ph_pkab = 10**(ph_values - pka_b)\n\n        w00 = np.ones_like(ph_values)\n        w10 = exp_ph_pkaa\n        w01 = exp_ph_pkab\n        w11 = c * exp_ph_pkaa * exp_ph_pkab\n        \n        # Partition function (sum of weights)\n        Z = w00 + w10 + w01 + w11\n\n        # Calculate population of each microstate\n        p00 = w00 / Z\n        p10 = w10 / Z\n        p01 = w01 / Z\n        p11 = w11 / Z\n\n        # Calculate predicted signal as population-weighted average\n        # S00, S10, S01, S11 are (2,) arrays (for each probe), broadcasting works\n        signal_p1 = p00 * S00[0] + p10 * S10[0] + p01 * S01[0] + p11 * S11[0]\n        signal_p2 = p00 * S00[1] + p10 * S10[1] + p01 * S01[1] + p11 * S11[1]\n\n        return np.array([signal_p1, signal_p2])\n\n    results = []\n    for case in test_cases:\n        pka_a_true, pka_b_true, c_true = case\n\n        # 1. Generate synthetic data using the true parameters\n        synthetic_data = forward_model(PH_GRID, pka_a_true, pka_b_true, c_true)\n\n        # 2. Define the residual function for the least-squares fitting\n        def residuals(params, ph_grid, data):\n            \"\"\"\n            Calculates the residuals between the model and the data.\n            `params` is a list/tuple: [pka_a, pka_b, c].\n            `data` is the (2, N) array of synthetic measurements.\n            \"\"\"\n            pka_a_fit, pka_b_fit, c_fit = params\n            model_prediction = forward_model(ph_grid, pka_a_fit, pka_b_fit, c_fit)\n            # Flatten the residuals for both probes into a single array\n            return (model_prediction - data).flatten()\n\n        # 3. Perform the nonlinear least-squares fit\n        initial_guess = [7.0, 7.0, 1.0] # A reasonable starting point\n        # Bounds: pKa in [3, 11], c in [0.01, 100]\n        bounds = ([3.0, 3.0, 1e-2], [11.0, 11.0, 1e2])\n        \n        fit_result = least_squares(\n            residuals,\n            initial_guess,\n            bounds=bounds,\n            args=(PH_GRID, synthetic_data),\n            method='trf' # Trust Region Reflective algorithm, good for bounds\n        )\n        \n        # 4. Extract, sort, and format the fitted parameters\n        pka_a_fit, pka_b_fit, c_fit = fit_result.x\n        \n        # Sort pKa values in ascending order\n        pka_sorted = sorted([pka_a_fit, pka_b_fit])\n        \n        # Round to two decimal places\n        pka1_rounded = round(pka_sorted[0], 2)\n        pka2_rounded = round(pka_sorted[1], 2)\n        c_rounded = round(c_fit, 2)\n        \n        results.append([pka1_rounded, pka2_rounded, c_rounded])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2587737"}]}