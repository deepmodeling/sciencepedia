{"hands_on_practices": [{"introduction": "The concept of electrochemical potential is central to cellular energy transduction, most famously as the proton-motive force that drives ATP synthesis. This exercise [@problem_id:2549720] challenges you to build the expression for the electrochemical potential difference from first principles, combining the chemical work of moving against a concentration (pH) gradient with the electrical work of traversing a potential difference. Mastering this derivation is fundamental to understanding how cells store and utilize energy across membranes.", "problem": "Consider a well-mixed cellular region where a proton can move between two locations labeled \"source\" and \"destination.\" The local hydrogen ion activity and electric potential can differ between these locations because of pH microdomains near membranes. Your goal is to derive, from first principles, the molar electrochemical potential difference for moving protons from the source to the destination and then implement a program to compute this quantity for a specified test suite.\n\nStart from the following foundations:\n- The chemical potential of a component is defined as the partial derivative of the Gibbs free energy with respect to the number of moles of that component at fixed temperature and pressure, i.e., $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j\\neq i}}$.\n- In dilute aqueous solutions, the thermodynamic driving force for a species depends on its activity; the activity of hydrogen ions relates to pH by $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$.\n- Charged species experience electrical work in an electric potential field, which must be included consistently with their charge when forming an electrochemical potential.\n\nDo not use any \"shortcut\" formulas that jump directly to the final result. Instead, assemble the result logically from the definitions above.\n\nAfter you obtain a general expression for the molar electrochemical potential difference for moving one mole of protons from the source to the destination, implement it in a program and evaluate it for the test suite below. Use the following constants and conventions:\n- Gas constant: $R = 8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$.\n- Faraday constant: $F = 96485.33212\\ \\mathrm{C}\\ \\mathrm{mol}^{-1}$.\n- Proton charge number: $z = +1$.\n- Temperature symbol: $T$ in $\\mathrm{K}$.\n- Electric potential: $\\psi$ in $\\mathrm{V}$.\n- Express the final answers as the molar electrochemical potential difference in $\\mathrm{J}\\ \\mathrm{mol}^{-1}$, rounded to the nearest integer.\n- Adopt the sign convention $\\Delta \\tilde{\\mu} = \\tilde{\\mu}_{\\text{destination}} - \\tilde{\\mu}_{\\text{source}}$, corresponding to the driving force for moving one mole of protons from \"source\" to \"destination.\"\n\nTest suite (each case provides $(\\mathrm{pH}_{\\text{source}},\\ \\psi_{\\text{source}},\\ \\mathrm{pH}_{\\text{destination}},\\ \\psi_{\\text{destination}},\\ T)$):\n- Case A (happy path, concurrent pH and potential effects):\n  - $\\mathrm{pH}_{\\text{source}} = 7.20$, $\\psi_{\\text{source}} = -0.040\\ \\mathrm{V}$,\n  - $\\mathrm{pH}_{\\text{destination}} = 6.80$, $\\psi_{\\text{destination}} = -0.060\\ \\mathrm{V}$,\n  - $T = 310\\ \\mathrm{K}$.\n- Case B (boundary, no gradients):\n  - $\\mathrm{pH}_{\\text{source}} = 7.00$, $\\psi_{\\text{source}} = 0.000\\ \\mathrm{V}$,\n  - $\\mathrm{pH}_{\\text{destination}} = 7.00$, $\\psi_{\\text{destination}} = 0.000\\ \\mathrm{V}$,\n  - $T = 298\\ \\mathrm{K}$.\n- Case C (electric-only gradient):\n  - $\\mathrm{pH}_{\\text{source}} = 7.00$, $\\psi_{\\text{source}} = 0.000\\ \\mathrm{V}$,\n  - $\\mathrm{pH}_{\\text{destination}} = 7.00$, $\\psi_{\\text{destination}} = -0.050\\ \\mathrm{V}$,\n  - $T = 298\\ \\mathrm{K}$.\n- Case D (pH-only gradient of one unit):\n  - $\\mathrm{pH}_{\\text{source}} = 7.00$, $\\psi_{\\text{source}} = 0.000\\ \\mathrm{V}$,\n  - $\\mathrm{pH}_{\\text{destination}} = 6.00$, $\\psi_{\\text{destination}} = 0.000\\ \\mathrm{V}$,\n  - $T = 298\\ \\mathrm{K}$.\n- Case E (temperature effect with pure pH gradient):\n  - $\\mathrm{pH}_{\\text{source}} = 7.40$, $\\psi_{\\text{source}} = -0.070\\ \\mathrm{V}$,\n  - $\\mathrm{pH}_{\\text{destination}} = 7.00$, $\\psi_{\\text{destination}} = -0.070\\ \\mathrm{V}$,\n  - $T = 320\\ \\mathrm{K}$.\n\nYour program should compute $\\Delta \\tilde{\\mu}$ for each case in the order A, B, C, D, E and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no extra spaces and no additional text. For example, the required format is analogous to a list such as $[r_a,r_b,r_c,r_d,r_e]$ where each $r_\\cdot$ is the rounded result for a case.", "solution": "The problem requires the derivation of the molar electrochemical potential difference for a proton moving between two locations, designated \"source\" and \"destination\". This derivation must proceed from fundamental thermodynamic and electrochemical principles, not from pre-existing formulas.\n\nWe begin with the formal definition of the chemical potential, $\\mu_i$, for a species $i$ in a dilute solution, which is its partial molar Gibbs free energy. It is expressed as a function of its activity, $a_i$:\n$$\n\\mu_i = \\mu_i^\\ominus + RT \\ln a_i\n$$\nHere, $\\mu_i^\\ominus$ is the standard chemical potential of species $i$ at unit activity, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nFor a charged species, such as a proton ($\\mathrm{H}^+$), we must also account for the electrical work required to move it within an electric field. The total Gibbs free energy per mole is then the electrochemical potential, $\\tilde{\\mu}_i$. It is the sum of the chemical potential and the molar electrical potential energy, $z_i F \\psi$, where $z_i$ is the charge number of the ion, $F$ is the Faraday constant, and $\\psi$ is the local electric potential.\n$$\n\\tilde{\\mu}_i = \\mu_i + z_i F \\psi = \\mu_i^\\ominus + RT \\ln a_i + z_i F \\psi\n$$\nFor the proton, the species of interest, its charge number is $z_{\\mathrm{H}^+} = +1$. The electrochemical potential of a proton, which we denote $\\tilde{\\mu}_p$, is therefore:\n$$\n\\tilde{\\mu}_p = \\mu_p^\\ominus + RT \\ln a_{\\mathrm{H}^+} + F \\psi\n$$\nThe problem asks for the change in molar electrochemical potential, $\\Delta \\tilde{\\mu}_p$, when one mole of protons is transferred from a source location (subscript $s$) to a destination location (subscript $d$). This is defined as $\\Delta \\tilde{\\mu}_p = \\tilde{\\mu}_{p,d} - \\tilde{\\mu}_{p,s}$.\n\nWe write the expressions for the electrochemical potential at both locations:\n$$\n\\tilde{\\mu}_{p,d} = \\mu_p^\\ominus + RT \\ln a_{\\mathrm{H}^+,d} + F \\psi_d\n$$\n$$\n\\tilde{\\mu}_{p,s} = \\mu_p^\\ominus + RT \\ln a_{\\mathrm{H}^+,s} + F \\psi_s\n$$\nThe standard chemical potential, $\\mu_p^\\ominus$, is a constant for the proton under standard conditions and is independent of its location within the system. Thus, when we compute the difference, this term is eliminated:\n$$\n\\Delta \\tilde{\\mu}_p = (\\mu_p^\\ominus + RT \\ln a_{\\mathrm{H}^+,d} + F \\psi_d) - (\\mu_p^\\ominus + RT \\ln a_{\\mathrm{H}^+,s} + F \\psi_s)\n$$\n$$\n\\Delta \\tilde{\\mu}_p = RT (\\ln a_{\\mathrm{H}^+,d} - \\ln a_{\\mathrm{H}^+,s}) + F (\\psi_d - \\psi_s)\n$$\nUsing the identity $\\ln x - \\ln y = \\ln(x/y)$, we consolidate the logarithmic terms:\n$$\n\\Delta \\tilde{\\mu}_p = RT \\ln\\left(\\frac{a_{\\mathrm{H}^+,d}}{a_{\\mathrm{H}^+,s}}\\right) + F(\\psi_d - \\psi_s)\n$$\nThe problem provides data in terms of $\\mathrm{pH}$, not activity. The relationship between these quantities is given as $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$. This can be rearranged to express activity as $a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}$. We substitute this into our expression for the ratio of activities:\n$$\n\\frac{a_{\\mathrm{H}^+,d}}{a_{\\mathrm{H}^+,s}} = \\frac{10^{-\\mathrm{pH}_d}}{10^{-\\mathrm{pH}_s}} = 10^{\\mathrm{pH}_s - \\mathrm{pH}_d}\n$$\nInserting this back into the equation for $\\Delta \\tilde{\\mu}_p$:\n$$\n\\Delta \\tilde{\\mu}_p = RT \\ln\\left(10^{\\mathrm{pH}_s - \\mathrm{pH}_d}\\right) + F(\\psi_d - \\psi_s)\n$$\nUsing the logarithmic property $\\ln(x^y) = y \\ln x$, we arrive at the final expression for the molar electrochemical potential difference. In this form, it is ready for computation using the provided parameters. Note that we replace the generic subscripts $s$ and $d$ with the explicit terms \"source\" and \"destination\" as per the problem statement:\n$$\n\\Delta \\tilde{\\mu} = (\\ln 10)RT(\\mathrm{pH}_{\\text{source}} - \\mathrm{pH}_{\\text{destination}}) + F(\\psi_{\\text{destination}} - \\psi_{\\text{source}})\n$$\nThis expression is rigorously derived from first principles. The first term represents the chemical work associated with the pH gradient, and the second term represents the electrical work associated with the electric potential gradient.\n\nThis derived formula is implemented in the following program to compute the numerical results for the specified test cases. The result for each case is calculated in units of Joules per mole and rounded to the nearest integer as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the molar electrochemical potential difference for protons.\n    \"\"\"\n    # Define physical constants as provided in the problem statement.\n    R = 8.314462618  # Gas constant in J mol^-1 K^-1\n    F = 96485.33212  # Faraday constant in C mol^-1\n    Z_PROTON = 1     # Charge number for a proton\n\n    # Test suite: (pH_source, psi_source, pH_destination, psi_destination, T)\n    # psi is electric potential in V, T is temperature in K.\n    test_cases = [\n        # Case A\n        (7.20, -0.040, 6.80, -0.060, 310.0),\n        # Case B\n        (7.00, 0.000, 7.00, 0.000, 298.0),\n        # Case C\n        (7.00, 0.000, 7.00, -0.050, 298.0),\n        # Case D\n        (7.00, 0.000, 6.00, 0.000, 298.0),\n        # Case E\n        (7.40, -0.070, 7.00, -0.070, 320.0),\n    ]\n\n    results = []\n    \n    # Pre-calculate ln(10)\n    ln_10 = np.log(10)\n\n    for case in test_cases:\n        ph_source, psi_source, ph_destination, psi_destination, T = case\n\n        # The electrochemical potential difference is given by:\n        # Delta_mu = mu_destination - mu_source\n        #\n        # From first principles, this is derived as:\n        # Delta_mu = z*F*(psi_destination - psi_source) + R*T*ln(a_destination / a_source)\n        #\n        # Since a = 10^(-pH), then ln(a_dest/a_source) = ln(10^(pH_source - pH_dest))\n        # This simplifies to (pH_source - pH_dest) * ln(10).\n        \n        # Chemical potential difference component due to pH gradient\n        delta_mu_chemical = ln_10 * R * T * (ph_source - ph_destination)\n        \n        # Electrical potential difference component due to electric potential gradient\n        delta_psi = psi_destination - psi_source\n        delta_mu_electrical = Z_PROTON * F * delta_psi\n        \n        # Total electrochemical potential difference in J/mol\n        delta_mu_total = delta_mu_chemical + delta_mu_electrical\n        \n        # Round the result to the nearest integer as required.\n        rounded_result = int(np.round(delta_mu_total))\n        results.append(rounded_result)\n\n    # Format the output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2549720"}, {"introduction": "Biochemical reactions rarely occur under idealized standard conditions. This practice [@problem_id:2549748] explores the adenylate kinase reaction, a vital part of cellular energy homeostasis, demonstrating how to calculate its actual Gibbs free energy ($\\Delta G$) in a realistic cytosolic environment. You will learn to account for the crucial effects of coupled equilibria, such as the binding of nucleotides to magnesium ions, which significantly modulate reaction thermodynamics and spontaneity.", "problem": "Adenylate kinase in the cytosol catalyzes the reaction that interconverts adenosine diphosphate (ADP) with adenosine triphosphate (ATP) and adenosine monophosphate (AMP):\n$$\n2\\,\\mathrm{ADP} \\rightleftharpoons \\mathrm{ATP} + \\mathrm{AMP}.\n$$\nIn a well-buffered mammalian cell at temperature $T = 310\\ \\mathrm{K}$ and pH $= 7.20$, the free magnesium ion $\\mathrm{Mg}^{2+}$ is maintained at a constant concentration $[\\mathrm{Mg}^{2+}] = 0.50\\ \\mathrm{mM}$ by cytosolic chelators, and magnesium binding to each nucleotide is fast and at equilibrium. Treat the one-to-one magnesium binding reactions\n$$\n\\mathrm{ATP}^{4-} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\mathrm{MgATP}^{2-},\\quad\n\\mathrm{ADP}^{3-} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\mathrm{MgADP}^{-},\\quad\n\\mathrm{AMP}^{2-} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\mathrm{MgAMP}^{0}\n$$\nas independent equilibria with association constants\n$$\nK_{\\mathrm{ATP}} = 1.0 \\times 10^{4}\\ \\mathrm{M}^{-1},\\quad\nK_{\\mathrm{ADP}} = 2.0 \\times 10^{3}\\ \\mathrm{M}^{-1},\\quad\nK_{\\mathrm{AMP}} = 3.2 \\times 10^{1}\\ \\mathrm{M}^{-1}.\n$$\nAssume that ionic-strength effects on activities are negligible in the apparent, magnesium-buffered description below, so that the activity of each total nucleotide equals its molar concentration. The transformed standard Gibbs energy change for the metal-free biochemical reaction at pH $= 7.20$ and $T = 310\\ \\mathrm{K}$ is\n$$\n\\Delta G^{\\circ}_{0} = +1.00\\ \\mathrm{kJ\\ mol}^{-1}.\n$$\nIn the cytosol, the measured total nucleotide concentrations (free plus magnesium-bound) are\n$$\n[\\mathrm{ATP}]_{\\mathrm{tot}} = 3.20\\ \\mathrm{mM},\\quad [\\mathrm{ADP}]_{\\mathrm{tot}} = 0.80\\ \\mathrm{mM},\\quad [\\mathrm{AMP}]_{\\mathrm{tot}} = 0.10\\ \\mathrm{mM}.\n$$\nStarting from the definition of chemical potential and mass action, and explicitly accounting for coupling to $\\mathrm{Mg}^{2+}$ through binding polynomials at fixed $[\\mathrm{Mg}^{2+}]$, derive an expression for the reaction Gibbs energy $\\Delta G$ in terms of $\\Delta G^{\\circ}_{0}$, $T$, the gas constant $R$, $[\\mathrm{Mg}^{2+}]$, the binding constants $K_{i}$, and the total nucleotide concentrations. Then evaluate $\\Delta G$ numerically under the given conditions. Use $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ and express the final value of $\\Delta G$ in $\\mathrm{kJ\\ mol^{-1}}$. Round your answer to four significant figures.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and an objective problem in biochemical thermodynamics. All required data are provided, and there are no inconsistencies. The solution proceeds.\n\nThe reaction Gibbs energy, $\\Delta G$, quantifies the spontaneity of the adenylate kinase reaction under the specified cellular conditions.\n$$\n2\\,\\mathrm{ADP} \\rightleftharpoons \\mathrm{ATP} + \\mathrm{AMP}\n$$\nThis reaction is coupled to magnesium binding equilibria. The overall Gibbs energy change is independent of the specific chemical species used to describe the state, provided the description is complete. The problem provides the standard transformed Gibbs energy change, $\\Delta G^{\\circ}_{0}$, for the reaction involving the metal-free species at pH $7.20$ and $T = 310\\ \\mathrm{K}$:\n$$\n2\\,\\mathrm{ADP}_{\\text{free}} \\rightleftharpoons \\mathrm{ATP}_{\\text{free}} + \\mathrm{AMP}_{\\text{free}}\n$$\nFor this reaction, the Gibbs energy change $\\Delta G$ under any set of concentrations is given by:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln \\left( \\frac{[\\mathrm{ATP}_{\\text{free}}][\\mathrm{AMP}_{\\text{free}}]}{[\\mathrm{ADP}_{\\text{free}}]^{2}} \\right)\n$$\nwhere $R$ is the gas constant, $T$ is the absolute temperature, and concentrations are treated as activities.\n\nTo evaluate $\\Delta G$, we must relate the concentrations of the free nucleotide species ($[\\mathrm{ATP}_{\\text{free}}]$, $[\\mathrm{ADP}_{\\text{free}}]$, $[\\mathrm{AMP}_{\\text{free}}]$) to the given total concentrations ($[\\mathrm{ATP}]_{\\mathrm{tot}}$, $[\\mathrm{ADP}]_{\\mathrm{tot}}$, $[\\mathrm{AMP}]_{\\mathrm{tot}}$). This relationship is governed by the magnesium binding equilibria.\n\nFor any nucleotide species $N$, where $N$ can be $\\mathrm{ATP}$, $\\mathrm{ADP}$, or $\\mathrm{AMP}$, the total concentration is the sum of the free species and the magnesium-bound complex:\n$$\n[N]_{\\mathrm{tot}} = [N_{\\text{free}}] + [\\mathrm{Mg}N]\n$$\nThe one-to-one binding is described by an association constant, $K_{N}$:\n$$\nK_{N} = \\frac{[\\mathrm{Mg}N]}{[N_{\\text{free}}][\\mathrm{Mg}^{2+}]}\n$$\nFrom this, the concentration of the bound form is $[\\mathrm{Mg}N] = K_{N} [N_{\\text{free}}][\\mathrm{Mg}^{2+}]$. Substituting this into the expression for the total concentration gives:\n$$\n[N]_{\\mathrm{tot}} = [N_{\\text{free}}] + K_{N} [N_{\\text{free}}][\\mathrm{Mg}^{2+}] = [N_{\\text{free}}] (1 + K_{N} [\\mathrm{Mg}^{2+}])\n$$\nThe term $(1 + K_{N} [\\mathrm{Mg}^{2+}])$ is the binding polynomial for species $N$ at a fixed $[\\mathrm{Mg}^{2+}]$. Let us denote this polynomial as $P_{N}$.\n$$\nP_{N} = 1 + K_{N} [\\mathrm{Mg}^{2+}]\n$$\nWe can now express the concentration of the free species in terms of the total concentration:\n$$\n[N_{\\text{free}}] = \\frac{[N]_{\\mathrm{tot}}}{P_{N}} = \\frac{[N]_{\\mathrm{tot}}}{1 + K_{N} [\\mathrm{Mg}^{2+}]}\n$$\nThis holds for $\\mathrm{ATP}$, $\\mathrm{ADP}$, and $\\mathrm{AMP}$. Substituting these expressions back into the equation for $\\Delta G$:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln \\left( \\frac{ \\left( \\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}}{P_{\\mathrm{ATP}}} \\right) \\left( \\frac{[\\mathrm{AMP}]_{\\mathrm{tot}}}{P_{\\mathrm{AMP}}} \\right) }{ \\left( \\frac{[\\mathrm{ADP}]_{\\mathrm{tot}}}{P_{\\mathrm{ADP}}} \\right)^2 } \\right)\n$$\nUsing the properties of logarithms, we can separate the terms involving total concentrations and the binding polynomials:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln \\left( \\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}[\\mathrm{AMP}]_{\\mathrm{tot}}}{[\\mathrm{ADP}]_{\\mathrm{tot}}^{2}} \\right) + RT \\ln \\left( \\frac{P_{\\mathrm{ADP}}^2}{P_{\\mathrm{ATP}}P_{\\mathrm{AMP}}} \\right)\n$$\nThis equation is the derived expression for the reaction Gibbs energy. The term $\\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}[\\mathrm{AMP}]_{\\mathrm{tot}}}{[\\mathrm{ADP}]_{\\mathrm{tot}}^{2}}$ is the apparent reaction quotient, $Q'_{\\mathrm{tot}}$. The term involving the binding polynomials corrects the standard state Gibbs energy for the effect of the fixed free magnesium concentration.\n\nThe expression can be written as:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln(Q'_{\\mathrm{tot}}) + RT \\ln \\left( \\frac{(1 + K_{\\mathrm{ADP}} [\\mathrm{Mg}^{2+}])^{2}}{(1 + K_{\\mathrm{ATP}} [\\mathrm{Mg}^{2+}]) (1 + K_{\\mathrm{AMP}} [\\mathrm{Mg}^{2+}])} \\right)\n$$\nThis completes the derivation. Now, we evaluate $\\Delta G$ numerically.\n\nThe given values are:\n$T = 310\\ \\mathrm{K}$\n$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n$\\Delta G^{\\circ}_{0} = +1.00\\ \\mathrm{kJ\\ mol}^{-1} = 1000\\ \\mathrm{J\\ mol}^{-1}$\n$[\\mathrm{Mg}^{2+}] = 0.50\\ \\mathrm{mM} = 5.0 \\times 10^{-4}\\ \\mathrm{M}$\n$K_{\\mathrm{ATP}} = 1.0 \\times 10^{4}\\ \\mathrm{M}^{-1}$\n$K_{\\mathrm{ADP}} = 2.0 \\times 10^{3}\\ \\mathrm{M}^{-1}$\n$K_{\\mathrm{AMP}} = 3.2 \\times 10^{1}\\ \\mathrm{M}^{-1}$\n$[\\mathrm{ATP}]_{\\mathrm{tot}} = 3.20\\ \\mathrm{mM} = 3.20 \\times 10^{-3}\\ \\mathrm{M}$\n$[\\mathrm{ADP}]_{\\mathrm{tot}} = 0.80\\ \\mathrm{mM} = 0.80 \\times 10^{-3}\\ \\mathrm{M}$\n$[\\mathrm{AMP}]_{\\mathrm{tot}} = 0.10\\ \\mathrm{mM} = 0.10 \\times 10^{-3}\\ \\mathrm{M}$\n\nFirst, calculate the binding polynomials $P_N$:\n$P_{\\mathrm{ATP}} = 1 + K_{\\mathrm{ATP}} [\\mathrm{Mg}^{2+}] = 1 + (1.0 \\times 10^{4}\\ \\mathrm{M}^{-1})(5.0 \\times 10^{-4}\\ \\mathrm{M}) = 1 + 5.0 = 6.0$\n$P_{\\mathrm{ADP}} = 1 + K_{\\mathrm{ADP}} [\\mathrm{Mg}^{2+}] = 1 + (2.0 \\times 10^{3}\\ \\mathrm{M}^{-1})(5.0 \\times 10^{-4}\\ \\mathrm{M}) = 1 + 1.0 = 2.0$\n$P_{\\mathrm{AMP}} = 1 + K_{\\mathrm{AMP}} [\\mathrm{Mg}^{2+}] = 1 + (3.2 \\times 10^{1}\\ \\mathrm{M}^{-1})(5.0 \\times 10^{-4}\\ \\mathrm{M}) = 1 + 0.016 = 1.016$\n\nNext, calculate the apparent reaction quotient $Q'_{\\mathrm{tot}}$:\n$$\nQ'_{\\mathrm{tot}} = \\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}[\\mathrm{AMP}]_{\\mathrm{tot}}}{[\\mathrm{ADP}]_{\\mathrm{tot}}^{2}} = \\frac{(3.20 \\times 10^{-3}\\ \\mathrm{M})(0.10 \\times 10^{-3}\\ \\mathrm{M})}{(0.80 \\times 10^{-3}\\ \\mathrm{M})^2} = \\frac{3.20 \\times 0.10}{0.80^2} = \\frac{0.320}{0.640} = 0.5\n$$\nThe product $RT$ is:\n$$\nRT = (8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})(310\\ \\mathrm{K}) \\approx 2577.483\\ \\mathrm{J\\ mol}^{-1}\n$$\nNow, substitute the values into the full expression for $\\Delta G$:\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + RT \\ln(0.5) + RT \\ln \\left( \\frac{2.0^2}{6.0 \\times 1.016} \\right)\n$$\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln(0.5) + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln \\left( \\frac{4}{6.096} \\right)\n$$\nWe can combine the logarithmic terms:\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln \\left( 0.5 \\times \\frac{4}{6.096} \\right)\n$$\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln \\left( \\frac{2}{6.096} \\right)\n$$\n$$\n\\Delta G \\approx 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln(0.3280839895)\n$$\n$$\n\\Delta G \\approx 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) (-1.114559)\n$$\n$$\n\\Delta G \\approx 1000\\ \\mathrm{J\\ mol}^{-1} - 2872.68\\ \\mathrm{J\\ mol}^{-1} = -1872.68\\ \\mathrm{J\\ mol}^{-1}\n$$\nThe problem requires the answer in $\\mathrm{kJ\\ mol}^{-1}$ rounded to four significant figures.\n$$\n\\Delta G = -1.87268\\ \\mathrm{kJ\\ mol}^{-1}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta G = -1.873\\ \\mathrm{kJ\\ mol}^{-1}\n$$\nThe negative value indicates that under the given cytosolic conditions, the adenylate kinase reaction is spontaneous in the direction of $\\mathrm{ATP}$ and $\\mathrm{AMP}$ formation from $\\mathrm{ADP}$.", "answer": "$$\\boxed{-1.873}$$", "id": "2549748"}, {"introduction": "Cells are not uniform, well-mixed solutions; they are spatially organized and crowded environments where gradients are the norm. This final exercise [@problem_id:2549764] connects the thermodynamic concept of chemical potential to the kinetic phenomenon of transport, guiding you to derive the flux of a solute driven by gradients in concentration, electric potential, and non-ideal activity. This practice provides a powerful link between thermodynamics and the Nernst-Planck equation, a cornerstone of modeling transport in biological systems.", "problem": "Consider a single solute species $X$ in a one-dimensional (1D) inhomogeneous cellular environment at temperature $T$, where both the concentration $c(x)$, the activity coefficient $\\gamma(x)$ (to account for non-ideality due to crowding), and the electrical potential $\\psi(x)$ may vary with position $x$. The solute has integer valence $z$ (positive for cations, negative for anions, and zero for neutral solutes). Use the following universally accepted bases:\n- The chemical potential $\\mu$ of a species is the partial molar Gibbs free energy.\n- For an ideal dilute solution, the entropy of mixing leads to a logarithmic dependence of the chemical potential on concentration; non-ideality can be captured via an activity coefficient factor.\n- The reversible work to move a charge $q$ through an electrical potential difference is $q \\Delta \\psi$.\n- In linear irreversible thermodynamics near local equilibrium, the molar flux $J$ of a solute in 1D is proportional to the gradient of its chemical potential, with proportionality determined by a mobility that, for dilute solutions, relates to the diffusion coefficient.\n\nYour tasks are:\n1) Starting from the above bases, and without appealing to any shortcut formula, derive the spatial dependence $\\mu_X(x)$ for a solute $X$ in a dilute aqueous medium with spatially varying $c(x)$, $\\gamma(x)$, and $\\psi(x)$, including the contribution of electrostatic work for a species of valence $z$. Clearly indicate every term, its origin, and its physical dimension.\n2) From your expression in task $1$, derive an explicit expression for the chemical potential difference $\\Delta \\mu_X = \\mu_X(x_2) - \\mu_X(x_1)$ between two positions $x_1$ and $x_2$ in terms of $T$, $z$, $c(x_1)$, $c(x_2)$, $\\gamma(x_1)$, $\\gamma(x_2)$, $\\psi(x_1)$, and $\\psi(x_2)$, using a common standard state so that any standard-state contribution cancels in the difference.\n3) Using the framework of linear irreversible thermodynamics for a dilute solute, and restricting to small gradients around an average state, show that the 1D steady-state molar flux $J$ can be approximated by combining the definition of the chemical potential gradient with Fickian diffusion. Concretely, argue that for a segment of length $L = x_2 - x_1$ with linear profiles and small relative variations, one may linearize about the arithmetic means $c_{\\mathrm{avg}} = \\tfrac{1}{2}[c(x_1) + c(x_2)]$ and $\\gamma_{\\mathrm{avg}} = \\tfrac{1}{2}[\\gamma(x_1) + \\gamma(x_2)]$ to obtain an approximation of the form\n$$\nJ \\approx -\\frac{D\\,c_{\\mathrm{avg}}}{R T}\\,\\frac{\\Delta \\mu_X}{L}\n$$\nor, equivalently, an expression written in terms of finite differences that agrees with the Nernstâ€“Planck form to first order in the gradients. Here $D$ is the diffusion coefficient of the solute, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n4) Implement a program that evaluates, for each provided test case, both the chemical potential difference $\\Delta \\mu_X$ and the approximate steady-state molar flux $J$ using your derived expressions. Use the International System of Units (SI) consistently, with the following conventions and constants:\n- Temperatures must be in kelvin $[\\mathrm{K}]$.\n- Electrical potentials must be in volts $[\\mathrm{V}]$.\n- Concentrations must be in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Lengths must be in meters $[\\mathrm{m}]$.\n- Diffusion coefficients must be in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- The universal gas constant is $R = 8.31446261815324\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- The Faraday constant is $F = 96485.33212\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$.\n- The standard concentration $c^0$ is the same at $x_1$ and $x_2$ and cancels in $\\Delta \\mu_X$.\n- For numerical convenience, you may use the linearization\n$$\n\\frac{\\partial \\mu_X}{\\partial x}\\bigg|_{\\mathrm{avg}} \\approx R T\\left(\\frac{1}{c_{\\mathrm{avg}}}\\frac{\\Delta c}{L} + \\frac{1}{\\gamma_{\\mathrm{avg}}}\\frac{\\Delta \\gamma}{L} \\right) + z F \\frac{\\Delta \\psi}{L}\n$$\nand then $J \\approx -\\dfrac{D\\,c_{\\mathrm{avg}}}{R T}\\,\\dfrac{\\partial \\mu_X}{\\partial x}\\big|_{\\mathrm{avg}}$, where $\\Delta c = c(x_2)-c(x_1)$, $\\Delta \\gamma = \\gamma(x_2)-\\gamma(x_1)$, and $\\Delta \\psi = \\psi(x_2)-\\psi(x_1)$.\n- Conversion aids: $1\\,\\mathrm{mM} = 1\\,\\mathrm{mol\\,m^{-3}}$, $1\\,\\mathrm{mV} = 10^{-3}\\,\\mathrm{V}$, $1\\,\\mathrm{\\mu m} = 10^{-6}\\,\\mathrm{m}$.\n\nTest suite (each case specifies $(z, T, c(x_1), c(x_2), \\gamma(x_1), \\gamma(x_2), \\psi(x_1), \\psi(x_2), L, D)$ with units):\n- Case A (happy path, monovalent cation, opposing gradients): $z = +1$, $T = 310\\ \\mathrm{K}$, $c(x_1) = 5\\ \\mathrm{mM}$, $c(x_2) = 50\\ \\mathrm{mM}$, $\\gamma(x_1) = 1.0$, $\\gamma(x_2) = 0.85$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = -80\\ \\mathrm{mV}$, $L = 10\\ \\mu\\mathrm{m}$, $D = 1.5\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case B (near Nernst balance): $z = +1$, $T = 310\\ \\mathrm{K}$, $c(x_1) = 5\\ \\mathrm{mM}$, $c(x_2) = 100\\ \\mathrm{mM}$, $\\gamma(x_1) = 1.0$, $\\gamma(x_2) = 1.0$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = -80\\ \\mathrm{mV}$, $L = 10\\ \\mu\\mathrm{m}$, $D = 1.5\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case C (neutral solute with strong crowding gradient): $z = 0$, $T = 298\\ \\mathrm{K}$, $c(x_1) = 2\\ \\mathrm{mM}$, $c(x_2) = 10\\ \\mathrm{mM}$, $\\gamma(x_1) = 0.6$, $\\gamma(x_2) = 0.3$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = 0\\ \\mathrm{mV}$, $L = 5\\ \\mu\\mathrm{m}$, $D = 5\\times 10^{-10}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case D (anion with reversed gradients): $z = -1$, $T = 310\\ \\mathrm{K}$, $c(x_1) = 60\\ \\mathrm{mM}$, $c(x_2) = 10\\ \\mathrm{mM}$, $\\gamma(x_1) = 0.9$, $\\gamma(x_2) = 1.0$, $\\psi(x_1) = -50\\ \\mathrm{mV}$, $\\psi(x_2) = 0\\ \\mathrm{mV}$, $L = 2\\ \\mu\\mathrm{m}$, $D = 1\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case E (small gradients, divalent cation): $z = +2$, $T = 300\\ \\mathrm{K}$, $c(x_1) = 10\\ \\mathrm{mM}$, $c(x_2) = 10.1\\ \\mathrm{mM}$, $\\gamma(x_1) = 1.0$, $\\gamma(x_2) = 0.99$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = 1\\ \\mathrm{mV}$, $L = 100\\ \\mu\\mathrm{m}$, $D = 1\\times 10^{-10}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n\nProgramming and output requirements:\n- For each test case, compute two quantities: (i) the chemical potential difference $\\Delta \\mu_X$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, and (ii) the approximate steady-state molar flux $J$ in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ using the linearized expression described above.\n- Express both $\\Delta \\mu_X$ and $J$ in SI units as specified above.\n- Your program should produce a single line of output containing the results as a comma-separated list of two-element lists, enclosed in square brackets. Each number must be written in scientific notation with six significant figures, and there must be no spaces anywhere in the line. For example, a valid output with two fictitious results would look like: `[[1.23457e+03,-6.54321e-04],[9.87654e+00,1.00000e-02]]`.", "solution": "The problem presented is a standard, well-posed exercise in biophysical chemistry. It is scientifically sound, internally consistent, and contains all necessary information for a complete solution. We shall proceed with the derivation and subsequent calculation.\n\n### Task 1: Derivation of the Electrochemical Potential $\\mu_X(x)$\n\nThe total driving force for the transport of a charged species in a solution is given by its electrochemical potential, which is the partial molar Gibbs free energy under the given conditions. We construct this quantity, denoted here by $\\mu_X(x)$, from fundamental principles. The subscript $X$ denotes the solute species, and the dependence on position $x$ indicates an inhomogeneous system.\n\nThe electrochemical potential is the sum of three distinct contributions: a standard state component, a concentration-dependent component arising from the entropy of mixing (corrected for non-ideality), and an electrical component.\n\n1.  **Standard Chemical Potential ($\\mu^0$)**: This is a reference term, representing the chemical potential of the solute $X$ under standard conditions, typically defined as a standard concentration $c^0$ (e.g., $1\\ \\mathrm{mol}\\,\\mathrm{L}^{-1}$ or $1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$) at a given temperature and pressure. By definition, this term is independent of position. Its physical dimension is energy per mole, $[\\mathrm{J}\\,\\mathrm{mol}^{-1}]$.\n\n2.  **Concentration and Activity Contribution**: For an ideal dilute solution, the chemical potential's dependence on concentration $c(x)$ is given by the term $R T \\ln(c(x)/c^0)$, where $R$ is the universal gas constant and $T$ is the absolute temperature. This term has its origin in the statistical mechanics of mixing (entropy of mixing). To account for non-ideal interactions in a real solution, such as molecular crowding in a cellular environment, the concentration $c(x)$ is replaced by the chemical activity $a(x) = \\gamma(x) c(x)$. Here, $\\gamma(x)$ is the dimensionless activity coefficient, which itself may vary with position. The contribution to the chemical potential is therefore $R T \\ln(a(x)/a^0) = R T \\ln(\\gamma(x) c(x)/c^0)$, assuming the standard state is defined at unit activity and concentration $c^0$ where $\\gamma=1$. This term has dimensions of energy per mole, $[\\mathrm{J}\\,\\mathrm{mol}^{-1}]$.\n\n3.  **Electrical Potential Contribution**: If the solute $X$ carries an electric charge, work is done when it moves through an electric field. The molar charge of the solute is $q = zF$, where $z$ is the dimensionless integer valence and $F$ is the Faraday constant (the magnitude of charge per mole of electrons). The work required to move one mole of this solute from a reference point of zero potential to a point $x$ with electrical potential $\\psi(x)$ is $W_{\\text{elec}} = z F \\psi(x)$. This work represents a change in the molar Gibbs free energy. This term has dimensions of charge per mole multiplied by energy per charge, $[\\mathrm{C}\\,\\mathrm{mol}^{-1}] \\times [\\mathrm{V}] = [\\mathrm{J}\\,\\mathrm{mol}^{-1}]$.\n\nCombining these three components, the complete position-dependent electrochemical potential of species $X$ is:\n$$\n\\mu_X(x) = \\mu^0 + R T \\ln\\left(\\frac{\\gamma(x) c(x)}{c^0}\\right) + z F \\psi(x)\n$$\nHereafter, we follow the common convention in biophysics of referring to this full expression as the \"chemical potential,\" as it represents the total potential energy driving chemical processes, including transport.\n\n### Task 2: Derivation of the Chemical Potential Difference $\\Delta \\mu_X$\n\nWe seek the difference in chemical potential, $\\Delta \\mu_X$, between two points, $x_1$ and $x_2$. We apply the expression derived in Task 1 at each point:\n$$\n\\mu_X(x_1) = \\mu^0 + R T \\ln\\left(\\frac{\\gamma(x_1) c(x_1)}{c^0}\\right) + z F \\psi(x_1)\n$$\n$$\n\\mu_X(x_2) = \\mu^0 + R T \\ln\\left(\\frac{\\gamma(x_2) c(x_2)}{c^0}\\right) + z F \\psi(x_2)\n$$\nThe difference is $\\Delta \\mu_X = \\mu_X(x_2) - \\mu_X(x_1)$. Upon subtraction, the standard chemical potential $\\mu^0$ and the standard concentration $c^0$ are eliminated, as they are constants independent of position.\n$$\n\\Delta \\mu_X = \\left[ \\mu^0 + R T \\ln\\left(\\frac{\\gamma_2 c_2}{c^0}\\right) + z F \\psi(x_2) \\right] - \\left[ \\mu^0 + R T \\ln\\left(\\frac{\\gamma_1 c_1}{c^0}\\right) + z F \\psi(x_1) \\right]\n$$\n$$\n\\Delta \\mu_X = R T \\left[ \\ln\\left(\\frac{\\gamma_2 c_2}{c^0}\\right) - \\ln\\left(\\frac{\\gamma_1 c_1}{c^0}\\right) \\right] + z F (\\psi_2 - \\psi_1)\n$$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$, we obtain the final expression:\n$$\n\\Delta \\mu_X = R T \\ln\\left(\\frac{\\gamma(x_2) c(x_2)}{\\gamma(x_1) c(x_1)}\\right) + z F (\\psi(x_2) - \\psi(x_1))\n$$\nThis equation gives the change in molar Gibbs free energy for moving the solute from $x_1$ to $x_2$.\n\n### Task 3: Derivation of the Approximate Molar Flux $J$\n\nIn the framework of linear irreversible thermodynamics, the molar flux $J$ of a species is proportional to the negative gradient of its chemical potential, which acts as the thermodynamic driving force.\n$$\nJ = -M \\frac{\\partial \\mu_X}{\\partial x}\n$$\nHere, $M$ is a a positive-definite mobility coefficient. To relate $M$ to the diffusion coefficient $D$, we consider the simplified case of an ideal, uncharged solute in the absence of an electric field and activity gradients ($\\gamma=1, z=0, \\psi=0$). In this case, $\\mu_X(x) = \\mu^0 + RT\\ln(c(x)/c^0)$, and its gradient is $\\frac{\\partial \\mu_X}{\\partial x} = \\frac{RT}{c(x)} \\frac{\\partial c(x)}{\\partial x}$. The flux becomes:\n$$\nJ = -M \\left( \\frac{RT}{c(x)} \\right) \\frac{\\partial c(x)}{\\partial x}\n$$\nThis expression must be identical to Fick's first law of diffusion, $J = -D \\frac{\\partial c(x)}{\\partial x}$. By comparing the two expressions, we identify the relationship between mobility and the diffusion coefficient, known as the Nernst-Einstein relation:\n$$\nD = M \\frac{RT}{c(x)} \\quad \\implies \\quad M = \\frac{D c(x)}{RT}\n$$\nSubstituting this mobility back into the general flux equation, we get the fundamental Nernst-Planck equation:\n$$\nJ = -\\frac{D c(x)}{RT} \\frac{\\partial \\mu_X}{\\partial x}\n$$\nFor a finite segment of length $L = x_2 - x_1$ with small gradients, we can make an approximation. The continuous variable $c(x)$ in the mobility pre-factor can be replaced by its arithmetic mean, $c_{\\mathrm{avg}} = \\frac{1}{2}[c(x_1) + c(x_2)]$. The gradient $\\frac{\\partial \\mu_X}{\\partial x}$ can be approximated by the finite difference ratio $\\frac{\\Delta \\mu_X}{L} = \\frac{\\mu_X(x_2) - \\mu_X(x_1)}{x_2 - x_1}$. Combining these approximations yields the desired form:\n$$\nJ \\approx -\\frac{D c_{\\mathrm{avg}}}{RT} \\frac{\\Delta \\mu_X}{L}\n$$\nThis form connects the net flux over a small region to the overall chemical potential difference across it. It is equivalent to a first-order finite difference approximation of the full Nernst-Planck equation. To see this, one can expand the gradient $\\frac{\\partial \\mu_X}{\\partial x}$ and then linearize the resulting expression by replacing continuous variables with their average values and derivatives with finite differences, which yields the expression provided in the problem for numerical computation. This confirms the consistency of the approach.\n\n### Task 4: Numerical Implementation\n\nThe program below will implement the derived formulas. For the chemical potential difference $\\Delta \\mu_X$, we will use the exact expression from Task 2. For the flux $J$, we will strictly follow the specified numerical recipe, which uses a linearized approximation for the chemical potential gradient. All parameters will be converted to and handled in SI units.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating chemical potential difference and molar flux\n    for a solute in an inhomogeneous cellular environment.\n    \"\"\"\n    # Universal constants in SI units\n    R = 8.31446261815324  # J mol^-1 K^-1\n    F = 96485.33212       # C mol^-1\n\n    # Test suite from the problem statement.\n    # Each case: (z, T, c1, c2, g1, g2, psi1, psi2, L, D)\n    # Units are converted to SI upon definition.\n    # 1 mM = 1 mol m^-3\n    # 1 mV = 1e-3 V\n    # 1 um = 1e-6 m\n    test_cases = [\n        # Case A\n        (1, 310.0, 5.0, 50.0, 1.0, 0.85, 0.0, -80.0e-3, 10.0e-6, 1.5e-9),\n        # Case B\n        (1, 310.0, 5.0, 100.0, 1.0, 1.0, 0.0, -80.0e-3, 10.0e-6, 1.5e-9),\n        # Case C\n        (0, 298.0, 2.0, 10.0, 0.6, 0.3, 0.0, 0.0, 5.0e-6, 5.0e-10),\n        # Case D\n        (-1, 310.0, 60.0, 10.0, 0.9, 1.0, -50.0e-3, 0.0, 2.0e-6, 1.0e-9),\n        # Case E\n        (2, 300.0, 10.0, 10.1, 1.0, 0.99, 0.0, 1.0e-3, 100.0e-6, 1.0e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        z, T, c1, c2, g1, g2, psi1, psi2, L, D = case\n\n        # Task 2: Calculate Chemical Potential Difference (delta_mu) in J/mol\n        # delta_mu = R*T*ln((g2*c2)/(g1*c1)) + z*F*(psi2 - psi1)\n        # We must guard against non-positive arguments to log\n        log_arg = (g2 * c2) / (g1 * c1)\n        if log_arg <= 0:\n            # This is not expected for the given test cases but is good practice.\n            # In a real scenario, this would imply an invalid physical state or error.\n            # We can skip or handle it, here we assume it won't happen.\n            pass\n        \n        term_conc = R * T * np.log(log_arg)\n        term_elec = z * F * (psi2 - psi1)\n        delta_mu = term_conc + term_elec\n\n        # Task 4: Calculate Approximate Molar Flux (J) in mol m^-2 s^-1\n        # Using the specified linearization for the gradient\n        # J_approx = - (D * c_avg / (R*T)) * (dmu_dx)_avg\n        # (dmu_dx)_avg = R*T*( (1/c_avg)*(dc/L) + (1/g_avg)*(dg/L) ) + z*F*(dpsi/L)\n        \n        # Calculate intermediate values\n        dc = c2 - c1\n        dg = g2 - g1\n        dpsi = psi2 - psi1\n        \n        c_avg = (c1 + c2) / 2.0\n        g_avg = (g1 + g2) / 2.0\n        \n        # Handle potential division by zero if averages are zero, although not expected here.\n        if c_avg == 0 or g_avg == 0:\n             # This physical situation is ill-defined for this model.\n             # We assume it does not occur in the test cases.\n             dmu_dx_avg = np.nan # Or other error value\n        else:\n            term1 = (R * T / c_avg) * (dc / L)\n            term2 = (R * T / g_avg) * (dg / L)\n            term3 = z * F * (dpsi / L)\n            dmu_dx_avg = term1 + term2 + term3\n\n        J_approx = - (D * c_avg / (R * T)) * dmu_dx_avg\n        \n        results.append((delta_mu, J_approx))\n\n    # Format output according to the problem specification\n    # [[val1,val2],[val3,val4],...], scientific notation with 6 significant figures (e.g., X.YYYYYe+ZZ)\n    results_str = [f\"[{dmu:.5e},{j:.5e}]\" for dmu, j in results]\n    final_output = f\"[{','.join(results_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2549764"}]}