{"hands_on_practices": [{"introduction": "Development unfolds on a strict schedule where key molecular events must occur within specific \"competency windows.\" This exercise introduces the crucial concept of stochasticity in gene expression by modeling the activation of the master switch SRY as a probabilistic event. By applying the normal distribution, you will quantify the risk of developmental failure when the timing of this critical gene burst falls outside its required window, providing a quantitative framework for understanding developmental robustness. [@problem_id:2628688]", "problem": "In mammalian gonadogenesis, testis determination in an embryo with a Y chromosome requires timely transcriptional activation of Sex-determining Region Y (SRY). Experimental observations support that the earliest robust transcriptional burst of SRY in the supporting cell lineage must occur within a finite competency window for Sertoli cell specification, modeled here as the closed time interval $\\left[t_{1}, t_{2}\\right]$ measured relative to the formation of the bipotential gonadal ridge at time $t=0$. Stochastic transcriptional bursting introduces embryo-to-embryo variability in the onset time of the first SRY burst. Assume the onset time $T$ is a continuous random variable distributed as a normal (Gaussian) with mean $\\mu$ and variance $\\sigma^{2}$, with $\\sigma>0$, where all times are measured in the same units. Sertoli specification succeeds if and only if $T \\in \\left[t_{1}, t_{2}\\right]$; otherwise it fails (misses the window).\n\nUsing only (i) the definition of probability for continuous random variables, (ii) basic properties of the normal distribution and standardization, and (iii) the cumulative distribution function of the standard normal, derive a closed-form analytic expression for the probability that SRY misses the competency window, that is, for $\\mathbb{P}\\!\\left(T<t_{1}\\ \\text{or}\\ T>t_{2}\\right)$, in terms of $\\mu$, $\\sigma$, $t_{1}$, $t_{2}$, and the standard normal cumulative distribution function $\\Phi$. Present your final answer as a single simplified analytic expression. No numerical evaluation is required, and no rounding instruction applies. Assume $t_{1}<t_{2}$ and $\\sigma>0$.", "solution": "The problem statement submitted for analysis is subjected to rigorous validation.\n\nStep 1: Extracted Givens.\n- The system is mammalian gonadogenesis, specifically testis determination.\n- The key molecular event is the transcriptional activation of the Sex-determining Region Y (SRY) gene.\n- A finite competency window for Sertoli cell specification is defined as the closed time interval $[t_{1}, t_{2}]$, where $t=0$ corresponds to the formation of the bipotential gonadal ridge.\n- The onset time of the first robust SRY transcriptional burst is a continuous random variable $T$.\n- The distribution of $T$ is given as normal (Gaussian) with mean $\\mu$ and variance $\\sigma^2$, denoted $T \\sim N(\\mu, \\sigma^2)$.\n- The parameter $\\sigma$ is positive, $\\sigma > 0$.\n- The time points are ordered, $t_1 < t_2$.\n- The condition for successful Sertoli specification is $T \\in [t_{1}, t_{2}]$.\n- The condition for failure is that SRY misses the competency window, i.e., $T < t_{1}$ or $T > t_{2}$.\n- The objective is to derive a closed-form analytic expression for the probability of failure, $\\mathbb{P}(T < t_{1} \\text{ or } T > t_{2})$.\n- The derivation must use only: (i) the definition of probability for continuous random variables, (ii) properties of the normal distribution and standardization, and (iii) the standard normal cumulative distribution function, denoted $\\Phi$.\n- The final expression must be in terms of $\\mu$, $\\sigma$, $t_{1}$, $t_{2}$, and $\\Phi$.\n\nStep 2: Validation Using Extracted Givens.\nThe problem is assessed against the required criteria:\n- **Scientifically Grounded**: The problem is an application of probability theory to model a real biological phenomenon. The role of SRY, the concept of a critical developmental window, and the stochastic nature of gene expression are all established principles in developmental biology. Modeling this stochasticity with a normal distribution is a standard and valid simplification in quantitative biology. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly defined. The random variable, its distribution, the parameters, and the event of interest are all specified unambiguously. A unique, stable solution exists and is derivable from the given information.\n- **Objective**: The language is precise and devoid of subjectivity or non-scientific claims.\n- **Completeness and Consistency**: The problem is self-contained. All necessary information ($\\mu$, $\\sigma$, $t_1$, $t_2$, the distribution type) is provided symbolically. The constraints $t_1 < t_2$ and $\\sigma > 0$ are consistent and necessary for a meaningful result.\n\nStep 3: Verdict and Action.\nThe problem is deemed **valid**. It is a standard exercise in probability theory applied to a biological context. I will now proceed with the derivation.\n\nThe quantity to be determined is the probability that the random variable $T$ falls outside the interval $[t_{1}, t_{2}]$. This event is the union of two other events: $\\{T < t_{1}\\}$ and $\\{T > t_{2}\\}$. We are asked to find $\\mathbb{P}(T < t_{1} \\text{ or } T > t_{2})$, which can be written as $\\mathbb{P}(\\{T < t_{1}\\} \\cup \\{T > t_{2}\\})$.\n\nGiven the condition $t_{1} < t_{2}$, the events $\\{T < t_{1}\\}$ and $\\{T > t_{2}\\}$ are mutually exclusive (disjoint). A single realization of the random variable $T$ cannot be simultaneously less than $t_{1}$ and greater than $t_{2}$. For disjoint events, the probability of their union is the sum of their individual probabilities.\n$$ \\mathbb{P}(\\{T < t_{1}\\} \\cup \\{T > t_{2}\\}) = \\mathbb{P}(T < t_{1}) + \\mathbb{P}(T > t_{2}) $$\nThe random variable $T$ follows a normal distribution with mean $\\mu$ and variance $\\sigma^{2}$, written as $T \\sim N(\\mu, \\sigma^2)$. To compute these probabilities, we must use the provided standard normal cumulative distribution function (CDF), $\\Phi(z)$, which is the CDF for a standard normal variable $Z \\sim N(0, 1)$. This requires standardizing the variable $T$.\n\nThe standardized form of $T$ is the random variable $Z = \\frac{T - \\mu}{\\sigma}$. This variable $Z$ has a mean of $0$ and a variance of $1$.\n\nLet us evaluate the first term, $\\mathbb{P}(T < t_{1})$. We transform the inequality for $T$ into an inequality for $Z$:\n$$ \\mathbb{P}(T < t_{1}) = \\mathbb{P}(T - \\mu < t_{1} - \\mu) $$\nSince $\\sigma > 0$, dividing by $\\sigma$ preserves the inequality direction:\n$$ \\mathbb{P}(T < t_{1}) = \\mathbb{P}\\left(\\frac{T - \\mu}{\\sigma} < \\frac{t_{1} - \\mu}{\\sigma}\\right) = \\mathbb{P}\\left(Z < \\frac{t_{1} - \\mu}{\\sigma}\\right) $$\nBy definition of the CDF for a standard normal variable, $\\mathbb{P}(Z \\le z) = \\Phi(z)$. For any continuous random variable, the probability of being strictly less than a value is equal to the probability of being less than or equal to that value. Thus, $\\mathbb{P}(Z < z) = \\mathbb{P}(Z \\le z) = \\Phi(z)$.\nTherefore, the first term is:\n$$ \\mathbb{P}(T < t_{1}) = \\Phi\\left(\\frac{t_{1} - \\mu}{\\sigma}\\right) $$\nNext, we evaluate the second term, $\\mathbb{P}(T > t_{2})$. We use the property that for any continuous random variable $X$, $\\mathbb{P}(X > x) = 1 - \\mathbb{P}(X \\le x)$.\n$$ \\mathbb{P}(T > t_{2}) = 1 - \\mathbb{P}(T \\le t_{2}) $$\nWe again standardize the variable $T$:\n$$ \\mathbb{P}(T \\le t_{2}) = \\mathbb{P}(T - \\mu \\le t_{2} - \\mu) = \\mathbb{P}\\left(\\frac{T - \\mu}{\\sigma} \\le \\fract_{2} - \\mu}{\\sigma}\\right) = \\mathbb{P}\\left(Z \\le \\frac{t_{2} - \\mu}{\\sigma}\\right) $$\nThis expression is, by definition, the standard normal CDF evaluated at $\\frac{t_{2} - \\mu}{\\sigma}$:\n$$ \\mathbb{P}(T \\le t_{2}) = \\Phi\\left(\\frac{t_{2} - \\mu}{\\sigma}\\right) $$\nSubstituting this back into the expression for $\\mathbb{P}(T > t_{2})$ gives:\n$$ \\mathbb{P}(T > t_{2}) = 1 - \\Phi\\left(\\frac{t_{2} - \\mu}{\\sigma}\\right) $$\nFinally, we sum the probabilities of the two disjoint events to find the total probability of failure:\n$$ \\mathbb{P}(\\text{failure}) = \\mathbb{P}(T < t_{1}) + \\mathbb{P}(T > t_{2}) = \\Phi\\left(\\frac{t_{1} - \\mu}{\\sigma}\\right) + \\left[1 - \\Phi\\left(\\frac{t_{2} - \\mu}{\\sigma}\\right)\\right] $$\nThis simplifies to the final analytical expression:\n$$ \\mathbb{P}(\\text{failure}) = 1 + \\Phi\\left(\\frac{t_{1} - \\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{t_{2} - \\mu}{\\sigma}\\right) $$\nThis is the closed-form expression for the probability that the SRY transcriptional burst misses the competency window, given in terms of the specified parameters and the standard normal CDF. The derivation is complete.", "answer": "$$\n\\boxed{1 + \\Phi\\left(\\frac{t_{1} - \\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{t_{2} - \\mu}{\\sigma}\\right)}\n$$", "id": "2628688"}, {"introduction": "How do cells make robust, all-or-none fate decisions in a noisy environment? This practice delves into the heart of developmental decision-making by analyzing a genetic \"toggle switch\" between the key fate determinants SOX$9$ and $\\beta$-catenin. Using the tools of nonlinear dynamics, you will explore how mutual repression can create bistability and hysteresis, a form of cellular memory that enables the system to filter transient noise and lock into a stable fate. [@problem_id:2628685]", "problem": "In the bipotential gonad, fate choice between testis and ovary is governed by a mutually antagonistic gene regulatory toggle between SRY-box transcription factor $9$ (SOX$9$) and beta-catenin (the downstream effector of the Wingless/Integrated (WNT) pathway). A standard biophysical description models transcriptional repression with Hill functions and protein turnover with first-order decay. Consider the following nondimensionalized, symmetric mutual-repression model with a transient SRY-like input $u(t)$ that directly drives SOX$9$ synthesis:\n$$\n\\frac{d x}{d t} \\;=\\; \\frac{\\alpha}{1 + y^{h}} \\;-\\; x \\;+\\; u(t),\\qquad\n\\frac{d y}{d t} \\;=\\; \\frac{\\alpha}{1 + x^{h}} \\;-\\; y,\n$$\nwhere $x$ denotes SOX$9$, $y$ denotes beta-catenin, $\\alpha$ is the maximal promoter strength (scaled by the degradation rate), and $h$ is the Hill coefficient (cooperativity) of repression. Assume $u(t)=0$ for the analysis of equilibria and their stability. This model captures the core, widely used facts that transcriptional repression is sigmoidal with Hill exponent $h\\geq 1$, and that protein loss is approximately first order.\n\nTasks:\n$1.$ Starting from these equations and using only phase-plane geometry and linear stability analysis, justify why bistability (and thus hysteresis) can arise in this toggle for sufficiently strong repression and production. Then, by analyzing the symmetric equilibrium $x=y=s$ and identifying the onset of its loss of stability, derive an explicit closed-form expression $\\alpha_{c}(h)$ giving the critical production strength at which a pitchfork bifurcation creates bistability. Express $\\alpha_{c}$ solely as a function of $h$.\n$2.$ Using the geometry of bistability, explain how hysteresis filters transient fluctuations: specifically, argue why a short, finite-amplitude input $u(t)$ of duration $T$ that does not carry the state across the separatrix cannot induce a permanent fate switch, whereas inputs that push the state past the unstable saddle do. You may refer to nullclines, fixed points, and the separatrix in your argument, but you should not compute $T$.\n\nProvide as your final answer the closed-form expression $\\alpha_{c}(h)$ obtained in Task $1$. No numerical evaluation is required, and no units are needed for $\\alpha$ because the system is nondimensionalized.", "solution": "The provided problem statement is a valid exercise in nonlinear dynamics and bifurcation theory, applied to a canonical model of a genetic toggle switch. It is scientifically grounded, mathematically well-posed, and contains all necessary information for its resolution. I will proceed with the analysis.\n\nThe system of equations describing the dynamics of SOX$9$ ($x$) and beta-catenin ($y$) is given by:\n$$\n\\frac{d x}{d t} \\;=\\; \\frac{\\alpha}{1 + y^{h}} \\;-\\; x \\;+\\; u(t)\n$$\n$$\n\\frac{d y}{d t} \\;=\\; \\frac{\\alpha}{1 + x^{h}} \\;-\\; y\n$$\nFor the analysis of equilibria (Task $1$), we set the external input $u(t) = 0$. The system becomes:\n$$\n\\frac{d x}{d t} \\;=\\; f(x,y) \\;=\\; \\frac{\\alpha}{1 + y^{h}} \\;-\\; x\n$$\n$$\n\\frac{d y}{d t} \\;=\\; g(x,y) \\;=\\; \\frac{\\alpha}{1 + x^{h}} \\;-\\; y\n$$\n\nTask $1$: Justification of Bistability and Derivation of $\\alpha_{c}(h)$\n\nTo analyze the system, we first identify the nullclines, which are curves in the phase plane where one of the derivatives is zero.\nThe $x$-nullcline is defined by $\\frac{dx}{dt} = 0$, which gives the equation:\n$$\nx = \\frac{\\alpha}{1 + y^{h}}\n$$\nThe $y$-nullcline is defined by $\\frac{dy}{dt} = 0$, which gives the equation:\n$$\ny = \\frac{\\alpha}{1 + x^{h}}\n$$\nThe fixed points of the system are the intersections of these two nullclines. The $y$-nullcline is a sigmoidal curve that decreases from $y=\\alpha$ at $x=0$ to $y \\to 0$ as $x \\to \\infty$. The $x$-nullcline has the same shape but is reflected across the line $y=x$.\n\nDue to the symmetry of the equations, there is always at least one fixed point on the line $x=y$. Let this symmetric equilibrium be $(s, s)$. Substituting $x=y=s$ into the nullcline equation yields:\n$$\ns = \\frac{\\alpha}{1 + s^{h}}\n$$\nBistability requires the existence of three fixed points. Geometrically, this occurs when the nullclines intersect three times. This happens if, at the symmetric fixed point $(s,s)$, the slope of the $y$-nullcline, $\\frac{dy}{dx}$, is sufficiently steep. Specifically, the condition for multiple intersections is that the magnitude of the slope of the $y$-nullcline at $x=s$ must be greater than $1$. If $|\\frac{dy}{dx}|_{x=s} > 1$, the nullclines must cross again on either side of the symmetric point. The two outer fixed points will be stable, while the central one will be an unstable saddle, creating two basins of attraction. This is the geometric origin of bistability and hysteresis.\n\nThe onset of bistability occurs when the central symmetric equilibrium loses its stability. This corresponds to a pitchfork bifurcation. We analyze the linear stability of the symmetric equilibrium $(s,s)$. The Jacobian matrix $J$ of the system is:\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -1 & -\\frac{\\alpha h y^{h-1}}{(1+y^{h})^2} \\\\ -\\frac{\\alpha h x^{h-1}}{(1+x^{h})^2} & -1 \\end{pmatrix}\n$$\nEvaluating the Jacobian at the symmetric fixed point $(s, s)$:\n$$\nJ(s,s) = \\begin{pmatrix} -1 & -\\frac{\\alpha h s^{h-1}}{(1+s^{h})^2} \\\\ -\\frac{\\alpha h s^{h-1}}{(1+s^{h})^2} & -1 \\end{pmatrix}\n$$\nLet's define the off-diagonal term as $k = -\\frac{\\alpha h s^{h-1}}{(1+s^{h})^2}$. The Jacobian becomes $J(s,s) = \\begin{pmatrix} -1 & k \\\\ k & -1 \\end{pmatrix}$.\nThe eigenvalues $\\lambda$ are found from the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n(-1 - \\lambda)^2 - k^2 = 0 \\implies -1 - \\lambda = \\pm k \\implies \\lambda = -1 \\pm k\n$$\nThe eigenvalues are $\\lambda_{1} = -1 - |k|$ and $\\lambda_{2} = -1 + |k|$.\nNote that $|k| = \\frac{\\alpha h s^{h-1}}{(1+s^{h})^2} \\ge 0$.\nThe eigenvalue $\\lambda_{1}$ is always negative. The stability of the equilibrium is therefore determined by $\\lambda_{2}$. The fixed point is stable if $\\lambda_{2} < 0$, which means $|k| < 1$. The fixed point loses stability when $\\lambda_{2}$ crosses zero, i.e., at $\\lambda_2 = 0$. This bifurcation occurs precisely when $|k|=1$.\n\nThe pitchfork bifurcation creating bistability occurs at the critical production strength $\\alpha_{c}$ where the following two conditions are met simultaneously:\n$1$. The point $(s,s)$ is an equilibrium: $s = \\frac{\\alpha_{c}}{1 + s^{h}}$\n$2$. The bifurcation condition is met: $|k| = 1 \\implies \\frac{\\alpha_{c} h s^{h-1}}{(1+s^{h})^2} = 1$\n\nWe must now solve this system of two equations for $\\alpha_c$ in terms of $h$.\nFrom condition $1$, we can write $\\alpha_{c} = s(1+s^{h})$. Substitute this into condition $2$:\n$$\n\\frac{s(1+s^{h}) h s^{h-1}}{(1+s^{h})^2} = 1\n$$\n$$\n\\frac{h s^{h}}{1+s^{h}} = 1\n$$\n$$\nh s^{h} = 1 + s^{h}\n$$\n$$\n(h-1)s^{h} = 1\n$$\nThis gives $s^{h} = \\frac{1}{h-1}$. For a real, positive solution for $s$, we must have $h>1$, which is consistent with the requirement of cooperativity for a switch-like response.\nFrom this, we find $s = \\left(\\frac{1}{h-1}\\right)^{\\frac{1}{h}} = (h-1)^{-\\frac{1}{h}}$.\n\nNow, we substitute this back into the expression for $\\alpha_{c}$:\n$$\n\\alpha_{c} = s(1+s^{h}) = (h-1)^{-\\frac{1}{h}} \\left(1 + \\frac{1}{h-1}\\right)\n$$\n$$\n\\alpha_{c} = (h-1)^{-\\frac{1}{h}} \\left(\\frac{h-1+1}{h-1}\\right)\n$$\n$$\n\\alpha_{c} = (h-1)^{-\\frac{1}{h}} \\left(\\frac{h}{h-1}\\right)\n$$\n$$\n\\alpha_{c} = h \\cdot (h-1)^{-1} \\cdot (h-1)^{-\\frac{1}{h}} = h (h-1)^{-(1+\\frac{1}{h})}\n$$\n$$\n\\alpha_{c}(h) = h (h-1)^{-\\frac{h+1}{h}}\n$$\nThis is the closed-form expression for the critical production strength.\n\nTask $2$: Hysteresis and Filtering of Fluctuations\n\nWhen $\\alpha > \\alpha_{c}(h)$, the system is bistable. The phase plane contains three fixed points: two stable fixed points (nodes or foci) and one unstable saddle point at the center. The stable fixed points represent the determined cell fates: one with high $x$ (SOX$9$) and low $y$ (beta-catenin), corresponding to the testis fate, and the other with low $x$ and high $y$, corresponding to the ovary fate.\n\nThe phase space is partitioned into two basins of attraction. The boundary between these basins is a curve known as the separatrix, which is the stable manifold of the saddle point. Trajectories starting on one side of the separatrix will converge to one stable fixed point, while trajectories starting on the other side will converge to the other.\n\nThis structure explains how the system filters transient fluctuations. Suppose the system resides at the \"ovary\" stable state (low $x$, high $y$). A transient input $u(t)$ of duration $T$ acts as a perturbation that drives an increase in $x$. This pushes the state of the system $(x(t), y(t))$ away from its initial equilibrium.\n\nIf the perturbation is small (in amplitude or duration $T$), the state trajectory will be displaced but will remain within the initial basin of attraction. When the input $u(t)$ ceases at time $t=T$, the state $(x(T), y(T))$ has not crossed the separatrix. The system's dynamics will then cause the state to relax back to the original \"ovary\" stable fixed point. In this case, the transient signal is filtered out, and no permanent change in cell fate occurs.\n\nHowever, if the input $u(t)$ is sufficiently strong or prolonged, it can push the state of the system across the separatrix into the basin of attraction of the \"testis\" state. At the moment the pulse ends at time $t=T$, the state $(x(T), y(T))$ is now in the other basin. The system's intrinsic dynamics will then guide the trajectory not back to the original state, but forward to the other stable fixed point (high $x$, low $y$). This results in a permanent, irreversible switch in cell fate.\n\nTherefore, the separatrix acts as a critical threshold. The geometry of bistability provides robustness by ignoring sub-threshold noise and fluctuations, while responding decisively to supra-threshold signals. This property, where the system's final state depends on its history of large perturbations, is the definition of hysteresis.", "answer": "$$\n\\boxed{h (h-1)^{-\\frac{h+1}{h}}}\n$$", "id": "2628685"}, {"introduction": "Cell fate decisions do not happen in isolation; they are coordinated across a developing tissue to form a functional organ. This computational exercise challenges you to build a spatial model of the developing gonad, where the initial expression of SRY is mosaic. You will implement a paracrine signaling mechanism to investigate how local cell-cell communication can overcome this initial heterogeneity, leading to a robust, tissue-wide commitment to the Sertoli cell fate. [@problem_id:2628681]", "problem": "You are modeling coordination of Sertoli cell differentiation across the embryonic genital ridge under mosaic expression of Sex-determining Region Y (SRY). Build a one-dimensional periodic lattice model in which each site represents a pre-Sertoli cell. A cell at lattice index $i$ has a dimensionless, continuous differentiation state $s_i(t) \\in [0,1]$, where $s_i(t) \\approx 1$ indicates a mature Sertoli-like state and $s_i(t) \\approx 0$ indicates an undifferentiated state. The SRY promoter mosaicism is represented by a fixed, dimensionless field $r_i \\in \\{0,1\\}$, where $r_i = 1$ denotes intrinsic SRY expression and $r_i = 0$ denotes its absence. You will propose and implement a spatial coupling mechanism that captures local coordination via paracrine signaling.\n\nFundamental base:\n- In developmental biology, differentiation is driven by gene regulatory inputs that often exhibit sigmoidal input-output relationships that can be captured by a Hill function. We will use a Hill activation $H(u) = \\dfrac{u^n}{K^n + u^n}$ for input $u \\ge 0$, with Hill coefficient $n$ and half-activation constant $K$.\n- Paracrine signaling from differentiated cells accumulates locally and spreads over short distances; at timescales longer than molecular diffusion and degradation, the signaling field can be approximated as proportional to a local spatial average of the source. On a lattice, the simplest closure is to approximate the paracrine signal sensed by a cell as the average of the differentiation states of its neighbors within a finite radius.\n\nCoupling mechanism and model equations:\n- Let the sensed paracrine signal at site $i$ be the neighbor average $A_i(t)$ over a symmetric neighborhood of radius $R$ on a periodic lattice, defined by\n$$\nA_i(t) = \\frac{1}{2R} \\sum_{j=1}^{R} \\left( s_{i-j}(t) + s_{i+j}(t) \\right),\n$$\nwith all indices taken modulo $N$.\n- Let the effective differentiation input be $u_i(t) = r_i + \\eta \\, A_i(t)$, where $\\eta \\ge 0$ is the coupling strength that maps the paracrine signal onto the regulatory input domain. The dynamics of $s_i(t)$ is taken as a logistic-like relaxation driven by the activated input, countered by decay:\n$$\n\\frac{ds_i}{dt} = k_{\\mathrm{on}} \\, H\\!\\left(u_i(t)\\right) \\, \\left(1 - s_i(t)\\right) - k_{\\mathrm{off}} \\, s_i(t),\n$$\nwhere $k_{\\mathrm{on}} > 0$ and $k_{\\mathrm{off}} > 0$ are rate constants. All quantities are dimensionless in this model.\n\nSimulation protocol:\n- Lattice size: $N$ sites, periodic boundary conditions.\n- Initial condition: $s_i(0) = 0$ for all $i$.\n- Time discretization: explicit Euler with time step $\\Delta t$ for a total simulated time $T$. After each step, you may clamp $s_i(t)$ to the interval $[0,1]$ to maintain physical bounds.\n- Differentiation readout: define a threshold $s_{\\mathrm{th}}$; a site is considered differentiated if $s_i(T) \\ge s_{\\mathrm{th}}$.\n\nMosaic SRY patterns:\n- Define $r_i$ via a modular rule: for integers $m \\ge 1$ and a subset $S \\subset \\{0,1,\\dots,m-1\\}$,\n$$\nr_i = \\begin{cases}\n1, & \\text{if } (i \\bmod m) \\in S,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nParameter values to use throughout unless otherwise specified:\n- Hill parameters: $n = 3$, $K = 0.5$.\n- Kinetics: $k_{\\mathrm{on}} = 2.0$, $k_{\\mathrm{off}} = 0.1$.\n- Numerical integration: $\\Delta t = 0.01$, $T = 20.0$.\n- Differentiation threshold: $s_{\\mathrm{th}} = 0.8$.\n\nTask:\n- Implement the above model and compute, for each test case below, the fraction of differentiated cells at time $T$, defined as\n$$\n\\phi = \\frac{1}{N} \\sum_{i=0}^{N-1} \\mathbf{1}\\{ s_i(T) \\ge s_{\\mathrm{th}} \\},\n$$\nwhere $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n\nTest suite:\n- Case 1 (no coupling baseline):\n  - $N = 60$, $m = 5$, $S = \\{0\\}$, $\\eta = 0.0$, $R = 1$.\n- Case 2 (nearest-neighbor coupling, moderate strength):\n  - $N = 60$, $m = 5$, $S = \\{0\\}$, $\\eta = 0.7$, $R = 1$.\n- Case 3 (wider coupling, strong strength):\n  - $N = 60$, $m = 5$, $S = \\{0\\}$, $\\eta = 1.5$, $R = 2$.\n- Case 4 (sparser mosaic, wider coupling):\n  - $N = 60$, $m = 10$, $S = \\{0\\}$, $\\eta = 1.5$, $R = 3$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the four results, in order of the cases above, as a comma-separated list enclosed in square brackets, rounded to three decimal places (for example, if the fractions were $0.2$ and $1.0$ the output would include $0.200$ and $1.000$). The output must be exactly of the form\n$$\n[\\phi_1,\\phi_2,\\phi_3,\\phi_4].\n$$\nNo additional text should be printed. All quantities are dimensionless; no physical units are required. Angles are not used. Percentages must be expressed as decimal fractions as specified above.", "solution": "The user has provided a valid problem statement. The problem is scientifically grounded, well-posed, and all necessary parameters and conditions are specified. It asks for the implementation of a numerical simulation of a system of coupled ordinary differential equations on a one-dimensional periodic lattice, modeling cell differentiation. The problem is a standard computational task in mathematical biology. I will now proceed with the solution.\n\nThe solution involves simulating the time evolution of the differentiation state $s_i(t)$ for a system of $N$ cells on a periodic lattice. The dynamics of each cell $i$ are governed by the differential equation:\n$$\n\\frac{ds_i}{dt} = k_{\\mathrm{on}} \\, H\\!\\left(u_i(t)\\right) \\, \\left(1 - s_i(t)\\right) - k_{\\mathrm{off}} \\, s_i(t)\n$$\nwhere the input $u_i(t) = r_i + \\eta A_i(t)$ depends on a fixed intrinsic SRY expression pattern $r_i$ and a paracrine signal $A_i(t)$ from neighboring cells. The simulation will be implemented using the explicit Euler method for numerical integration.\n\nThe overall algorithm is as follows:\n1.  Initialize the system for each test case. This includes setting up the lattice of size $N$, the SRY expression pattern $r$, and the initial differentiation state $s(0)$.\n2.  Perform numerical integration over the time interval $[0, T]$ with a time step $\\Delta t$.\n3.  In each time step, calculate the state-dependent terms of the ODE system ($A_i(t)$ and subsequently $u_i(t)$ and $H(u_i(t))$) for all cells.\n4.  Update the state vector $s(t)$ using the Euler formula.\n5.  After the final time step, calculate the fraction of differentiated cells $\\phi$ based on the final state $s(T)$.\n\nA step-by-step description of the implementation is provided below.\n\n**1. System Initialization**\n\nFor each test case, we define the parameters: lattice size $N$, mosaic periodicity $m$, SRY-positive indices subset $S$, coupling strength $\\eta$, and neighborhood radius $R$.\n-   The SRY expression pattern is represented by a vector $r$ of length $N$. We initialize $r$ to all zeros. Then, we iterate through each site index $i$ from $0$ to $N-1$ and set $r_i = 1$ if $(i \\pmod m) \\in S$.\n-   The differentiation state is a vector $s$ of length $N$. According to the initial condition $s_i(0)=0$, this vector is initialized to all zeros.\n-   The constant parameters are fixed as $n=3$, $K=0.5$, $k_{\\mathrm{on}}=2.0$, $k_{\\mathrm{off}}=0.1$, $\\Delta t=0.01$, $T=20.0$, and $s_{\\mathrm{th}}=0.8$.\n\n**2. Numerical Integration Loop**\n\nThe time evolution is simulated for a total number of steps equal to $T / \\Delta t$. We use `NumPy` for efficient, vectorized operations on the state array $s$. The loop proceeds as follows:\n\n-   **Calculation of Neighbor Average $A(t)$**: The paracrine signal $A_i(t)$ is the average state of the $2R$ neighbors of site $i$.\n    $$\n    A_i(t) = \\frac{1}{2R} \\sum_{j=1}^{R} \\left( s_{i-j}(t) + s_{i+j}(t) \\right)\n    $$\n    where indices are taken modulo $N$. This operation is implemented efficiently for the entire lattice. An auxiliary array, initialized to zeros, accumulates the states of all neighbors. For each $j$ from $1$ to $R$, we add `np.roll(s, j)` and `np.roll(s, -j)` to the accumulator. The `np.roll` function handles the periodic boundary conditions correctly: `np.roll(s, j)` effectively provides the vector of $s_{i-j}$ values. After the loop, the accumulated sum is divided by $2R$ to get the final average array $A(t)$.\n\n-   **Calculation of Effective Input $u(t)$**: The total input to the differentiation machinery is $u_i(t) = r_i + \\eta A_i(t)$. This is computed in a single vectorized operation: $u = r + \\eta A$.\n\n-   **Evaluation of the Time Derivative**: The right-hand side of the ODE system, $\\frac{ds}{dt}$, is calculated. This involves applying the Hill function $H(u) = \\frac{u^n}{K^n + u^n}$ to the input vector $u$, and then evaluating the full expression for all sites:\n    $$\n    \\frac{ds}{dt} = k_{\\mathrm{on}} \\cdot H(u) \\odot (1 - s) - k_{\\mathrm{off}} \\cdot s\n    $$\n    where $\\odot$ denotes element-wise multiplication.\n\n-   **Euler Update**: The state vector is updated using the explicit Euler formula:\n    $$\n    s(t + \\Delta t) = s(t) + \\frac{ds}{dt} \\Delta t\n    $$\n\n-   **State Clamping**: To ensure the state variable $s_i$ remains within its physical bounds $[0,1]$, we apply a clamping operation after each update step: $s_i \\leftarrow \\max(0, \\min(1, s_i))$. This is done using `np.clip(s, 0, 1)`.\n\n**3. Final Readout**\n\nAfter the simulation loop completes at time $T$, the final state vector $s(T)$ is obtained. The fraction of differentiated cells, $\\phi$, is computed as:\n$$\n\\phi = \\frac{1}{N} \\sum_{i=0}^{N-1} \\mathbf{1}\\{ s_i(T) \\ge s_{\\mathrm{th}} \\}\n$$\nwhere $\\mathbf{1}\\{\\cdot\\}$ is the indicator function. In implementation, this is achieved by creating a boolean array from the condition $s \\ge s_{\\mathrm{th}}$ and then calculating its mean value, which gives the desired fraction.\n\nThis process is repeated for all four test cases provided in the problem statement. The resulting four values of $\\phi$ are collected and formatted into the specified output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the 1D lattice model for Sertoli cell differentiation\n    and computes the fraction of differentiated cells for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, m, S, eta, R)\n        (60, 5, {0}, 0.0, 1),  # Case 1\n        (60, 5, {0}, 0.7, 1),  # Case 2\n        (60, 5, {0}, 1.5, 2),  # Case 3\n        (60, 10, {0}, 1.5, 3), # Case 4\n    ]\n\n    # Global parameter values\n    n = 3.0\n    K = 0.5\n    k_on = 2.0\n    k_off = 0.1\n    dt = 0.01\n    T = 20.0\n    s_th = 0.8\n\n    results = []\n\n    def hill_activation(u, n_h, K_h):\n        \"\"\"Vectorized Hill activation function.\"\"\"\n        u_pow_n = np.power(u, n_h)\n        return u_pow_n / (np.power(K_h, n_h) + u_pow_n)\n\n    for N, m, S, eta, R in test_cases:\n        # 1. Initialize SRY pattern `r`\n        r = np.zeros(N, dtype=float)\n        for i in range(N):\n            if (i % m) in S:\n                r[i] = 1.0\n\n        # 2. Initialize state vector `s`\n        s = np.zeros(N, dtype=float)\n\n        # 3. Time evolution loop\n        num_steps = int(T / dt)\n        for _ in range(num_steps):\n            # Calculate neighbor average `A`\n            if R > 0:\n                A_sum = np.zeros(N, dtype=float)\n                for j in range(1, R + 1):\n                    # np.roll handles periodic boundary conditions\n                    A_sum += np.roll(s, j) + np.roll(s, -j)\n                A = A_sum / (2.0 * R)\n            else:\n                A = np.zeros(N, dtype=float)\n            \n            # Calculate effective input `u`\n            u = r + eta * A\n            \n            # Calculate time derivative `ds/dt`\n            H_u = hill_activation(u, n, K)\n            ds_dt = k_on * H_u * (1.0 - s) - k_off * s\n            \n            # Update state `s` using explicit Euler method\n            s += ds_dt * dt\n            \n            # Clamp state to the interval [0, 1]\n            np.clip(s, 0.0, 1.0, out=s)\n\n        # 4. Compute final fraction of differentiated cells\n        differentiated_mask = s >= s_th\n        phi = np.mean(differentiated_mask)\n        results.append(phi)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2628681"}]}