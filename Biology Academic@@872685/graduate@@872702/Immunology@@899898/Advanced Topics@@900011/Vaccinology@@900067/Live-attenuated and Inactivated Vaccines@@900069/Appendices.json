{"hands_on_practices": [{"introduction": "The efficacy of any vaccine begins with its dose, but for an immunologist, 'dose' signifies more than just a mass of protein. This practice challenges you to think from first principles, building a quantitative framework to translate the macroscopic amount of antigen in an inactivated vaccine into the microscopic currency of immunity: the number of available epitopes ready to engage a rare, specific B cell in a lymph node [@problem_id:2864489]. Mastering this type of calculation provides a fundamental tool for reasoning about the initial conditions of an immune response and the stoichiometry of lymphocyte activation.", "problem": "An inactivated protein vaccine dose contains a defined mass of a purified antigen that presents a conformational B cell epitope. You are asked to construct, from first principles, a quantitative framework that converts the administered protein mass into an estimate of the total epitope copy number available in the primary draining lymph node (dLN), and then relates this to the expected number of naive epitope-specific B cell precursors present in that node to yield a per-precursor epitope availability ratio.\n\nUse only the following fundamental bases and definitions:\n- The number of antigen molecules equals the number of moles times Avogadro’s constant (Avogadro’s constant (N_A) is $N_A = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$).\n- Moles equal mass divided by molecular weight, with unit consistency (use $1\\ \\mu\\mathrm{g} = 10^{-6}\\ \\mathrm{g}$).\n- If each antigen molecule presents $c_e$ copies of the epitope, then total epitope copies equal molecules times $c_e$.\n- If a fraction $q$ of antigen molecules retains the correct epitope conformation following inactivation and formulation, and a fraction $h$ of the administered dose reaches and is retained in the dLN in an intact, B cell–accessible form, then the total accessible epitope copies in the dLN are scaled by the product $q h$.\n- The expected number of naive epitope-specific B cell precursors in the dLN equals the total B cell count $N_B$ in that node times the precursor frequency $f_p$.\n\nAssume that ligand depletion by B cell receptors is negligible at the time of initial antigen arrival (so counting epitopes does not require occupancy corrections), and that epitope copies on a given molecule are independently accessible.\n\nDerive a dimensionally consistent expression for the ratio $R$ defined as the number of accessible epitope copies per epitope-specific naive B cell precursor in the dLN, in terms of the parameters $m$, $M_W$, $N_A$, $c_e$, $q$, $h$, $N_B$, and $f_p$. Then evaluate $R$ numerically for the following scientifically plausible parameter values:\n- Dose protein mass $m = 15\\ \\mu\\mathrm{g}$,\n- Antigen molecular weight $M_W = 6.3 \\times 10^{4}\\ \\mathrm{g/mol}$,\n- Epitope copies per antigen molecule $c_e = 1$,\n- Antigenic integrity fraction $q = 0.05$,\n- dLN delivery and retention fraction $h = 0.05$,\n- Total B cells in the dLN $N_B = 2.0 \\times 10^{7}$,\n- Naive epitope-specific B cell precursor frequency $f_p = 1.0 \\times 10^{-5}$.\n\nReport the final value of $R$ as a pure number (copies per cell). Round your answer to three significant figures.", "solution": "The problem as stated must first be rigorously validated.\n\n**Step 1: Extraction of Givens**\n- The number of antigen molecules is the product of the number of moles and Avogadro's constant, $N_A = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$.\n- The number of moles is the mass divided by the molecular weight. A unit conversion is provided: $1\\ \\mu\\mathrm{g} = 10^{-6}\\ \\mathrm{g}$.\n- Total epitope copies = (number of molecules) $\\times c_e$, where $c_e$ is the number of epitope copies per molecule.\n- The number of accessible epitope copies in the draining lymph node (dLN) is the total number of administered epitopes scaled by two factors: $q$, the fraction with correct conformation, and $h$, the fraction reaching the dLN.\n- The expected number of naive epitope-specific B cell precursors in the dLN is the product of the total B cell count in that node, $N_B$, and the precursor frequency, $f_p$.\n- The ratio to be derived is $R = (\\text{accessible epitope copies in dLN}) / (\\text{naive epitope-specific B cell precursors in dLN})$.\n- The derivation is to be in terms of the parameters: dose protein mass $m$, antigen molecular weight $M_W$, Avogadro's constant $N_A$, epitope copies per molecule $c_e$, antigenic integrity fraction $q$, dLN delivery fraction $h$, total B cells in dLN $N_B$, and precursor frequency $f_p$.\n- Numerical values for evaluation:\n  - $m = 15\\ \\mu\\mathrm{g}$\n  - $M_W = 6.3 \\times 10^{4}\\ \\mathrm{g/mol}$\n  - $c_e = 1$\n  - $q = 0.05$\n  - $h = 0.05$\n  - $N_B = 2.0 \\times 10^{7}$\n  - $f_p = 1.0 \\times 10^{-5}$\n\n**Step 2: Validation**\nThe problem is scientifically grounded in fundamental principles of chemistry (stoichiometry) and immunology (vaccine antigen delivery and B cell biology). It is well-posed, providing all necessary definitions, constants, and variables for a unique solution. The language is objective and precise. The parameters are stated to be, and are, scientifically plausible. The problem is a formalizable and relevant exercise in quantitative immunology. It does not violate any of the specified criteria for invalidity.\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be constructed.\n\nThe task is to derive an expression for the ratio $R$, defined as the number of accessible epitope copies per epitope-specific naive B cell precursor in the dLN.\n$$R = \\frac{\\text{Number of accessible epitope copies in dLN}}{\\text{Number of epitope-specific B cell precursors in dLN}}$$\nLet us construct the numerator and denominator from the given first principles.\n\nFirst, we determine the numerator: the number of accessible epitope copies in the dLN, which we denote as $E_{acc}$.\nThe administered mass of the protein is $m$. The problem specifies the value of $m$ in micrograms ($\\mu\\mathrm{g}$). To maintain dimensional consistency with the molecular weight $M_W$ (in $\\mathrm{g/mol}$), we must convert the mass $m$ to grams. Using the provided conversion, the mass in grams is $m \\times 10^{-6}\\ \\mathrm{g}$.\nThe number of moles of antigen, $n_{ag}$, is the mass in grams divided by the molecular weight:\n$$n_{ag} = \\frac{m \\times 10^{-6}}{M_W}$$\nThe total number of antigen molecules administered, $N_{ag}$, is the number of moles multiplied by Avogadro's constant, $N_A$:\n$$N_{ag} = n_{ag} \\times N_A = \\frac{m \\times 10^{-6} \\times N_A}{M_W}$$\nEach antigen molecule presents $c_e$ copies of the epitope. Therefore, the total number of epitope copies administered, $E_{total}$, is:\n$$E_{total} = N_{ag} \\times c_e = \\frac{m \\times 10^{-6} \\times N_A \\times c_e}{M_W}$$\nAccording to the problem statement, only a fraction $q$ of these epitopes are conformationally intact, and of those, only a fraction $h$ are delivered to and retained in the dLN in an accessible form. Thus, the total number of accessible epitopes in the dLN, $E_{acc}$, is:\n$$E_{acc} = E_{total} \\times q \\times h = \\frac{m \\times 10^{-6} \\times N_A \\times c_e \\times q \\times h}{M_W}$$\nThis is the numerator of our ratio $R$.\n\nNext, we determine the denominator: the number of epitope-specific naive B cell precursors in the dLN, which we denote as $N_{spec}$.\nThis is given as the product of the total number of B cells in the dLN, $N_B$, and the frequency of precursors specific for the epitope, $f_p$:\n$$N_{spec} = N_B \\times f_p$$\nThis is the denominator of our ratio $R$.\n\nNow, we can write the complete expression for the ratio $R$ by dividing $E_{acc}$ by $N_{spec}$:\n$$R = \\frac{E_{acc}}{N_{spec}} = \\frac{\\left(\\frac{m \\times 10^{-6} \\times N_A \\times c_e \\times q \\times h}{M_W}\\right)}{N_B \\times f_p}$$\nThis expression can be written more cleanly as:\n$$R = \\frac{m \\times 10^{-6} \\times N_A \\times c_e \\times q \\times h}{M_W \\times N_B \\times f_p}$$\nThis is the required dimensionally consistent expression. The numerator is a pure number (epitope copies), and the denominator is a pure number (cells), making $R$ a dimensionless ratio (copies per cell).\n\nFinally, we evaluate $R$ using the provided numerical values:\n- $m = 15$\n- $N_A = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$\n- $c_e = 1$\n- $q = 0.05$\n- $h = 0.05$\n- $M_W = 6.3 \\times 10^{4}\\ \\mathrm{g/mol}$\n- $N_B = 2.0 \\times 10^{7}$\n- $f_p = 1.0 \\times 10^{-5}$\n\nSubstituting these values into the derived expression for $R$:\n$$R = \\frac{15 \\times 10^{-6} \\times (6.022 \\times 10^{23}) \\times 1 \\times 0.05 \\times 0.05}{(6.3 \\times 10^{4}) \\times (2.0 \\times 10^{7}) \\times (1.0 \\times 10^{-5})}$$\nWe compute the numerator and denominator separately.\nNumerator:\n$$15 \\times 10^{-6} \\times 6.022 \\times 10^{23} \\times 1 \\times 0.05 \\times 0.05 = (15 \\times 6.022 \\times 0.0025) \\times 10^{23-6}$$\n$$= 0.225825 \\times 10^{17} = 2.25825 \\times 10^{16}$$\nDenominator:\n$$(6.3 \\times 10^{4}) \\times (2.0 \\times 10^{7}) \\times (1.0 \\times 10^{-5}) = (6.3 \\times 2.0 \\times 1.0) \\times 10^{4+7-5}$$\n$$= 12.6 \\times 10^{6} = 1.26 \\times 10^{7}$$\nNow, we compute the ratio $R$:\n$$R = \\frac{2.25825 \\times 10^{16}}{1.26 \\times 10^{7}} = \\frac{2.25825}{1.26} \\times 10^{16-7}$$\n$$R \\approx 1.7922619... \\times 10^{9}$$\nThe problem requires the result to be rounded to three significant figures.\n$$R \\approx 1.79 \\times 10^{9}$$\nThis final value represents the ratio of accessible antigen epitopes to specific B cells in the lymph node under the specified conditions.", "answer": "$$\\boxed{1.79 \\times 10^{9}}$$", "id": "2864489"}, {"introduction": "A core distinction between inactivated and live-attenuated vaccines lies in their antigen dynamics. While an inactivated vaccine delivers a non-replicating 'bolus' of antigen that simply decays, a live-attenuated vaccine establishes a transient, self-amplifying infection. This exercise uses the tools of mathematical modeling to capture this fundamental difference, asking you to calculate and compare the total integrated antigen exposure, $\\int V(t) dt$, from both vaccine types [@problem_id:2864497]. This analysis provides a quantitative basis for understanding why replicating vaccines often generate more robust and durable immunity.", "problem": "A live-attenuated viral vaccine is administered at time $t=0$ with an initial within-host viral load $V(0)=V_{0}$, where $0<V_{0}<K$. Before the adaptive immune response is established, the viral load replicates with resource limitation and innate losses, which are modeled as logistic growth. At a fixed time $t=\\tau>0$, the adaptive immune response becomes dominant and enforces rapid clearance that halts replication and causes monotone decay. Specifically, assume the following piecewise dynamics based on fundamental within-host immunology:\n- For $0 \\le t < \\tau$, the viral load $V(t)$ obeys the ordinary differential equation (ODE) $\\,\\frac{dV}{dt} = r\\,V\\left(1-\\frac{V}{K}\\right)$ with $V(0)=V_{0}$, where $r>0$ is the intrinsic replication rate and $K>0$ is an effective carrying capacity arising from target-cell limitation and early innate constraints.\n- For $t \\ge \\tau$, the adaptive response induces clearance with rate $\\mu>0$ such that $\\,\\frac{dV}{dt} = -\\mu\\,V$, with the initial condition $V(\\tau^{+})=V(\\tau^{-})$.\n\nThe cumulative antigen exposure for the live-attenuated vaccine is defined as the area under the viral load curve, $\\,\\int_{0}^{\\infty} V(t)\\,dt\\,$, which captures the total time-integrated presence of antigen. An inactivated vaccine is instead modeled as a single bolus of antigen $A_{0}$ at $t=0$ that does not replicate and is cleared exponentially by the same host mechanisms with rate $\\mu_{a}>0$, so that $\\,\\frac{dA}{dt}=-\\mu_{a}A\\,$ and $\\,A(0)=A_{0}$. Its cumulative antigen exposure is $\\,\\int_{0}^{\\infty} A(t)\\,dt$.\n\nUsing only the above mechanistic assumptions and starting from the ODE definitions and standard solution methods for separable equations, derive a closed-form analytic expression for the initial bolus $A_{0}$ of the inactivated vaccine that yields the same cumulative antigen exposure as the live-attenuated vaccine; that is, determine $A_{0}$ such that\n$$\n\\int_{0}^{\\infty} A(t)\\,dt \\;=\\; \\int_{0}^{\\infty} V(t)\\,dt.\n$$\nExpress your final answer as a single closed-form expression in terms of $r$, $K$, $V_{0}$, $\\tau$, $\\mu$, and $\\mu_{a}$. No numerical values are to be substituted, and no rounding is required. The expression represents an antigen load in consistent antigen-load units (do not include units in your final boxed answer).", "solution": "The problem statement is parsed and validated against the required criteria.\n\nGivens extracted:\n1.  For a live-attenuated vaccine, the viral load $V(t)$ follows a piecewise ordinary differential equation (ODE) system.\n2.  For $0 \\le t < \\tau$: $\\frac{dV}{dt} = r V\\left(1-\\frac{V}{K}\\right)$, with initial condition $V(0)=V_{0}$. The parameters are the replication rate $r>0$, carrying capacity $K>0$, and initial load $V_{0}$ such that $0 < V_{0} < K$. The time of switch to adaptive response is $\\tau>0$.\n3.  For $t \\ge \\tau$: $\\frac{dV}{dt} = -\\mu V$, with clearance rate $\\mu>0$. The viral load is continuous at $t=\\tau$, so $V(\\tau^{+})=V(\\tau^{-})$.\n4.  For an inactivated vaccine, the antigen load $A(t)$ dynamics are $\\frac{dA}{dt}=-\\mu_{a}A$, with initial condition $A(0)=A_{0}$ and clearance rate $\\mu_{a}>0$.\n5.  The objective is to find the initial bolus $A_{0}$ of the inactivated vaccine that produces the same cumulative antigen exposure as the live-attenuated vaccine, which is defined by the equality $\\int_{0}^{\\infty} A(t)\\,dt = \\int_{0}^{\\infty} V(t)\\,dt$.\n\nValidation Verdict:\nThe problem is scientifically grounded, using standard compartmental models from mathematical immunology (logistic growth and exponential decay). It is well-posed, with all necessary parameters and conditions defined to ensure a unique solution exists. The language is objective and precise. The problem is a standard exercise in solving and integrating ordinary differential equations, and it is free from any of the listed invalidity flaws. Therefore, the problem is deemed **valid**. We proceed to the solution.\n\nThe task is to find an expression for $A_{0}$ by equating the total area under the curves $A(t)$ and $V(t)$.\n\nFirst, we calculate the cumulative exposure for the inactivated vaccine. The governing ODE is $\\frac{dA}{dt} = -\\mu_{a}A$ with $A(0)=A_{0}$. This is a separable first-order linear ODE whose solution is $A(t) = A_{0}\\exp(-\\mu_{a}t)$. The cumulative exposure is the integral over its entire time course:\n$$ \\int_{0}^{\\infty} A(t)\\,dt = \\int_{0}^{\\infty} A_{0}\\exp(-\\mu_{a}t)\\,dt = A_{0}\\left[-\\frac{1}{\\mu_{a}}\\exp(-\\mu_{a}t)\\right]_{0}^{\\infty} = A_{0}\\left(0 - \\left(-\\frac{1}{\\mu_{a}}\\right)\\right) = \\frac{A_{0}}{\\mu_{a}} $$\n\nNext, we calculate the cumulative exposure for the live-attenuated vaccine, $\\int_{0}^{\\infty} V(t)\\,dt$. This integral must be split into two parts corresponding to the two phases of the dynamics:\n$$ \\int_{0}^{\\infty} V(t)\\,dt = \\int_{0}^{\\tau} V(t)\\,dt + \\int_{\\tau}^{\\infty} V(t)\\,dt $$\n\nFor the second phase, $t \\ge \\tau$, the dynamics obey $\\frac{dV}{dt} = -\\mu V$. The solution is $V(t) = V(\\tau)\\exp(-\\mu(t-\\tau))$, where $V(\\tau)$ is the viral load at the end of the first phase. The exposure during this clearance phase is:\n$$ \\int_{\\tau}^{\\infty} V(t)\\,dt = \\int_{\\tau}^{\\infty} V(\\tau)\\exp(-\\mu(t-\\tau))\\,dt $$\nUsing the substitution $s = t-\\tau$, the integral becomes:\n$$ \\int_{0}^{\\infty} V(\\tau)\\exp(-\\mu s)\\,ds = V(\\tau)\\left[-\\frac{1}{\\mu}\\exp(-\\mu s)\\right]_{0}^{\\infty} = \\frac{V(\\tau)}{\\mu} $$\n\nFor the first phase, $0 \\le t < \\tau$, the viral load follows the logistic equation $\\frac{dV}{dt} = rV\\left(1-\\frac{V}{K}\\right)$. To find the integral $\\int_{0}^{\\tau} V(t)\\,dt$, we can rearrange the ODE itself, rather than solving for $V(t)$ and then integrating the complex resulting expression.\n$$ \\frac{1}{V}\\frac{dV}{dt} = r\\left(1-\\frac{V}{K}\\right) = r - \\frac{r}{K}V $$\nRearranging for $V$:\n$$ V = K - \\frac{K}{r} \\frac{1}{V}\\frac{dV}{dt} $$\nNow, we integrate this expression with respect to time from $t=0$ to $t=\\tau$:\n$$ \\int_{0}^{\\tau} V(t)\\,dt = \\int_{0}^{\\tau} K\\,dt - \\frac{K}{r} \\int_{0}^{\\tau} \\frac{1}{V(t)}\\frac{dV}{dt}\\,dt $$\nThe first integral is simply $K\\tau$. The second integral is an exact differential:\n$$ \\int_{0}^{\\tau} \\frac{1}{V}\\frac{dV}{dt}\\,dt = \\int_{V(0)}^{V(\\tau)} \\frac{1}{V}\\,dV = [\\ln(V)]_{V_{0}}^{V(\\tau)} = \\ln(V(\\tau)) - \\ln(V_{0}) = \\ln\\left(\\frac{V(\\tau)}{V_{0}}\\right) $$\nThus, the exposure during the first phase is:\n$$ \\int_{0}^{\\tau} V(t)\\,dt = K\\tau - \\frac{K}{r}\\ln\\left(\\frac{V(\\tau)}{V_{0}}\\right) $$\nThis expression can be simplified. We use the known solution to the logistic equation, which relates $V(\\tau)$ to $V_{0}$:\n$$ V(\\tau) = \\frac{K V_{0} \\exp(r\\tau)}{K - V_{0} + V_{0}\\exp(r\\tau)} $$\nFrom this, an identity can be established: $\\frac{K}{r}\\ln\\left(\\frac{K-V_0}{K-V(\\tau)}\\right) = K\\tau - \\frac{K}{r}\\ln\\left(\\frac{V(\\tau)}{V_0}\\right)$. We evaluate the argument of the logarithm:\n$$ \\frac{K-V_{0}}{K-V(\\tau)} = \\frac{K-V_{0}}{K - \\frac{K V_{0} \\exp(r\\tau)}{K - V_{0} + V_{0}\\exp(r\\tau)}} = \\frac{(K-V_{0})(K - V_{0} + V_{0}\\exp(r\\tau))}{K(K - V_{0} + V_{0}\\exp(r\\tau)) - K V_{0} \\exp(r\\tau)} = \\frac{(K-V_{0})(K - V_{0} + V_{0}\\exp(r\\tau))}{K(K-V_0)} = \\frac{K - V_{0} + V_{0}\\exp(r\\tau)}{K} = 1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1) $$\nTherefore, the integral for the first phase has the more compact form:\n$$ \\int_{0}^{\\tau} V(t)\\,dt = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) $$\n\nThe total cumulative exposure for the live-attenuated vaccine is the sum of the exposures from both phases:\n$$ \\int_{0}^{\\infty} V(t)\\,dt = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V(\\tau)}{\\mu} $$\nWe express $V(\\tau)$ in terms of the new denominator found above:\n$$ V(\\tau) = \\frac{K V_{0} \\exp(r\\tau)}{K(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1))} = \\frac{V_{0}\\exp(r\\tau)}{1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)} $$\nSubstituting this into the total exposure expression gives:\n$$ \\int_{0}^{\\infty} V(t)\\,dt = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{1}{\\mu}\\frac{V_{0}\\exp(r\\tau)}{1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)} $$\n\nFinally, we equate the cumulative exposures for the two vaccine types and solve for $A_{0}$:\n$$ \\frac{A_{0}}{\\mu_{a}} = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V_{0}\\exp(r\\tau)}{\\mu\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right)} $$\n$$ A_{0} = \\mu_{a}\\left[ \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V_{0}\\exp(r\\tau)}{\\mu\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right)} \\right] $$\nThis is the required closed-form analytic expression for $A_{0}$.", "answer": "$$\\boxed{\\mu_{a}\\left[ \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V_{0}\\exp(r\\tau)}{\\mu\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right)} \\right]}$$", "id": "2864497"}, {"introduction": "After considering the antigen dose and its dynamics, the crucial question becomes: how does the resulting immune response translate into clinical protection? This practice delves into 'correlates of protection,' a cornerstone of vaccine evaluation, by linking a measurable immune response to a functional outcome. You will implement a widely used statistical model to connect neutralizing antibody titers to the probability of protection against disease, interpreting how this relationship can differ between vaccine platforms [@problem_id:2864475]. This exercise provides direct experience with the quantitative methods used to determine how much immunity is 'enough' and to compare vaccine performance.", "problem": "A vaccine efficacy model posits that neutralizing antibody titer $T$ modulates the probability of protection $P$ via a logistic regression with a logarithmic predictor: protection probability is $P(T) = \\dfrac{1}{1+\\exp\\!\\left(-(\\alpha + \\beta \\ln T)\\right)}$, where $\\ln$ denotes the natural logarithm. This formulation aligns with the observation that neutralizing titers are multiplicative across dilutions and that dose–response relationships in immunology are often sigmoidal. The odds of protection are $O(T) = \\dfrac{P(T)}{1-P(T)}$. Two vaccine platforms are considered: live-attenuated (Live-Attenuated (LA)) and inactivated (Inactivated (IN)), each characterized by its own parameters $(\\alpha,\\beta)$, where $\\alpha$ is the intercept and $\\beta$ is the slope with respect to $\\ln T$.\n\nStarting from this model and only from fundamental definitions of probability, odds, and the logistic function, derive expressions needed to:\n- Compute protection probability $P(T)$.\n- Quantify the effect of a fold-change in titer $f$ on the odds $O(T)$ in terms of $\\beta$ and $f$.\n- Compute the titer $T^\\star$ required to achieve a specified target protection probability $p^\\star$.\n\nYour task is to write a complete, runnable program that implements these derived expressions and evaluates them for the following test suite. Use the natural logarithm throughout. All probabilities must be expressed as decimals in $[0,1]$.\n\nTest suite parameters:\n- Live-Attenuated (LA): $\\alpha_{\\mathrm{LA}}=-3.0$, $\\beta_{\\mathrm{LA}}=2.2$.\n- Inactivated (IN): $\\alpha_{\\mathrm{IN}}=-2.5$, $\\beta_{\\mathrm{IN}}=1.3$.\n- Titers: $T_{1}=100$, $T_{2}=0.5$, $T_{3}=10000$.\n- Fold changes: $f_{1}=4$, $f_{2}=2$.\n- Target protection: $p^\\star=0.8$.\n- Additional slopes for edge-case odds-multiplier evaluation: $\\beta_{\\mathrm{small}}=0.1$, $\\beta_{\\mathrm{large}}=3.0$.\n\nYour program must compute, in this exact order:\n$1.$ $P_{\\mathrm{LA}}(T_{1})$ using $(\\alpha_{\\mathrm{LA}},\\beta_{\\mathrm{LA}})$ and $T_{1}$.\n$2.$ $P_{\\mathrm{IN}}(T_{1})$ using $(\\alpha_{\\mathrm{IN}},\\beta_{\\mathrm{IN}})$ and $T_{1}$.\n$3.$ $P_{\\mathrm{LA}}(T_{2})$ using $(\\alpha_{\\mathrm{LA}},\\beta_{\\mathrm{LA}})$ and $T_{2}$.\n$4.$ $P_{\\mathrm{IN}}(T_{3})$ using $(\\alpha_{\\mathrm{IN}},\\beta_{\\mathrm{IN}})$ and $T_{3}$.\n$5.$ The odds multiplier for a $f_{1}$-fold increase in titer under LA, i.e., the factor by which $O(T)$ changes when $T \\mapsto f_{1}T$, given $\\beta_{\\mathrm{LA}}$.\n$6.$ The odds multiplier for a $f_{1}$-fold increase in titer under IN, given $\\beta_{\\mathrm{IN}}$.\n$7.$ The titer $T^\\star_{\\mathrm{LA}}$ needed to achieve $p^\\star$ under LA.\n$8.$ The titer $T^\\star_{\\mathrm{IN}}$ needed to achieve $p^\\star$ under IN.\n$9.$ The odds multiplier for a $f_{2}$-fold increase in titer with $\\beta_{\\mathrm{small}}$.\n$10.$ The odds multiplier for a $f_{2}$-fold increase in titer with $\\beta_{\\mathrm{large}}$.\n\nDesign for coverage:\n- Items $1$–$2$ test the general-use prediction at moderate titer (happy path).\n- Item $3$ tests very low titer (edge case near baseline).\n- Item $4$ tests very high titer (saturation edge case).\n- Items $5$–$6$ test interpretation of $\\beta$ via fold-change effects on odds for two vaccine types.\n- Items $7$–$8$ test inversion to find the required titer for a target protection level.\n- Items $9$–$10$ test boundary behavior of the odds multiplier for very small and very large slopes.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and in the order specified above. Round every float to $6$ decimal places before printing. For example, the printed line should look like a Python list literal containing $10$ decimal numbers, with no extra text or spaces outside the brackets.\n\nConstraints:\n- Use the natural logarithm for all $\\ln$ operations.\n- Assume $T>0$ whenever $\\ln T$ is evaluated.\n- All returned quantities must be real numbers.", "solution": "The problem has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in established immunological and biostatistical principles, well-posed with all necessary parameters defined, and formulated with objective, unambiguous language. The model presented, a logistic regression on a logarithmic predictor, is a standard approach for analyzing dose-response relationships in biology. The tasks required are direct applications and inversions of this model, which are mathematically sound and logically consistent. We may therefore proceed with the derivation and solution.\n\nThe objective is to derive expressions for three quantities based on the provided logistic model for protection probability $P(T)$ as a function of antibody titer $T$:\n$1$. The protection probability $P(T)$.\n$2$. The odds multiplier, which is the factor by which the odds of protection $O(T)$ increase for a given fold-change $f$ in the titer.\n$3$. The required titer $T^\\star$ to achieve a specified target protection probability $p^\\star$.\n\nThe fundamental model is given as:\n$$P(T) = \\frac{1}{1 + \\exp(-(\\alpha + \\beta \\ln T))}$$\nwhere $\\alpha$ is the intercept and $\\beta$ is the slope parameter.\n\n**Derivation 1: Protection Probability $P(T)$**\n\nThe expression for $P(T)$ is provided directly in the problem statement. It is the standard sigmoid or logistic function applied to a linear predictor in $\\ln T$. The linear predictor is $z = \\alpha + \\beta \\ln T$. Thus, the formula for implementation is as given:\n$$P(T) = \\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T)}}$$\nThis formula will be used to compute items $1$, $2$, $3$, and $4$ of the test suite.\n\n**Derivation 2: Odds Multiplier for a Fold-Change in Titer**\n\nThe odds of an event are defined as the ratio of the probability of the event occurring to the probability of it not occurring. Here, the odds of protection are:\n$$O(T) = \\frac{P(T)}{1 - P(T)}$$\nFirst, we derive an explicit expression for $O(T)$. The probability of non-protection is:\n$$1 - P(T) = 1 - \\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T)}} = \\frac{1 + e^{-(\\alpha + \\beta \\ln T)} - 1}{1 + e^{-(\\alpha + \\beta \\ln T)}} = \\frac{e^{-(\\alpha + \\beta \\ln T)}}{1 + e^{-(\\alpha + \\beta \\ln T)}}$$\nSubstituting these into the odds definition:\n$$O(T) = \\frac{\\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T)}}}{\\frac{e^{-(\\alpha + \\beta \\ln T)}}{1 + e^{-(\\alpha + \\beta \\ln T)}}} = \\frac{1}{e^{-(\\alpha + \\beta \\ln T)}} = e^{\\alpha + \\beta \\ln T}$$\nThis reveals a key property of the logistic model: the natural logarithm of the odds, known as the log-odds or logit, is a linear function of the predictor variables.\n$$\\ln(O(T)) = \\alpha + \\beta \\ln T$$\nNow, consider a new titer $T'$ that is an $f$-fold increase over the original titer $T$, such that $T' = f \\cdot T$. The new odds are $O(T') = O(fT)$.\n$$O(fT) = e^{\\alpha + \\beta \\ln(fT)}$$\nUsing the logarithm property $\\ln(ab) = \\ln a + \\ln b$, we have:\n$$O(fT) = e^{\\alpha + \\beta (\\ln f + \\ln T)} = e^{\\alpha + \\beta \\ln T + \\beta \\ln f} = (e^{\\alpha + \\beta \\ln T}) \\cdot (e^{\\beta \\ln f})$$\nRecognizing that the first term is simply the original odds $O(T)$, we get:\n$$O(fT) = O(T) \\cdot e^{\\beta \\ln f}$$\nThe term $e^{\\beta \\ln f}$ can be simplified using the power rule of logarithms, $y \\ln x = \\ln(x^y)$:\n$$e^{\\beta \\ln f} = e^{\\ln(f^\\beta)} = f^\\beta$$\nThe odds multiplier, which is the ratio of the new odds to the old odds, is therefore:\n$$\\text{Odds Multiplier} = \\frac{O(fT)}{O(T)} = f^\\beta$$\nThis remarkably simple expression shows that for a logistic model with a log-transformed predictor, a fold-change $f$ in the predictor variable results in the odds being multiplied by $f^\\beta$. This expression will be used to compute items $5$, $6$, $9$, and $10$.\n\n**Derivation 3: Titer for Target Protection $T^\\star$**\n\nWe seek to find the titer $T^\\star$ that corresponds to a target protection probability $p^\\star$. We set $P(T^\\star) = p^\\star$ and solve for $T^\\star$.\n$$p^\\star = \\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T^\\star)}}$$\nWe perform algebraic rearrangement to isolate $T^\\star$:\n$$1 + e^{-(\\alpha + \\beta \\ln T^\\star)} = \\frac{1}{p^\\star}$$\n$$e^{-(\\alpha + \\beta \\ln T^\\star)} = \\frac{1}{p^\\star} - 1 = \\frac{1 - p^\\star}{p^\\star}$$\nTake the natural logarithm of both sides:\n$$-(\\alpha + \\beta \\ln T^\\star) = \\ln\\left(\\frac{1 - p^\\star}{p^\\star}\\right)$$\nUsing the property $\\ln(1/x) = -\\ln(x)$:\n$$\\alpha + \\beta \\ln T^\\star = -\\ln\\left(\\frac{1 - p^\\star}{p^\\star}\\right) = \\ln\\left(\\left(\\frac{1 - p^\\star}{p^\\star}\\right)^{-1}\\right) = \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right)$$\nThis term, $\\ln(p^\\star / (1 - p^\\star))$, is the logit of $p^\\star$. Now, we solve for $\\ln T^\\star$:\n$$\\beta \\ln T^\\star = \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right) - \\alpha$$\n$$\\ln T^\\star = \\frac{1}{\\beta} \\left( \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right) - \\alpha \\right)$$\nFinally, we exponentiate to find $T^\\star$:\n$$T^\\star = \\exp\\left( \\frac{1}{\\beta} \\left( \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right) - \\alpha \\right) \\right)$$\nThis is the required formula for computing the titer needed to achieve a target protection level. It will be used for items $7$ and $8$.\n\nThese three derived expressions will now be implemented in a program to compute the specified quantities for the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vaccine efficacy modeling problem by implementing the derived formulas\n    and evaluating them for the given test suite.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Live-Attenuated (LA) model parameters\n    alpha_la = -3.0\n    beta_la = 2.2\n\n    # Inactivated (IN) model parameters\n    alpha_in = -2.5\n    beta_in = 1.3\n\n    # Test titers\n    T1 = 100.0\n    T2 = 0.5\n    T3 = 10000.0\n\n    # Fold changes\n    f1 = 4.0\n    f2 = 2.0\n\n    # Target protection probability\n    p_star = 0.8\n\n    # Additional slopes for edge-case evaluation\n    beta_small = 0.1\n    beta_large = 3.0\n\n    # --- Derived Functions ---\n\n    def calculate_protection_probability(T, alpha, beta):\n        \"\"\"\n        Computes protection probability P(T) using the logistic regression model.\n        P(T) = 1 / (1 + exp(-(alpha + beta * ln(T))))\n        \"\"\"\n        # Ensure T > 0 for log operation\n        if T = 0:\n            return 0.0\n        linear_predictor = alpha + beta * np.log(T)\n        return 1.0 / (1.0 + np.exp(-linear_predictor))\n\n    def calculate_odds_multiplier(f, beta):\n        \"\"\"\n        Computes the odds multiplier for an f-fold increase in titer.\n        Multiplier = f^beta\n        \"\"\"\n        return f ** beta\n\n    def calculate_target_titer(p_star, alpha, beta):\n        \"\"\"\n        Computes the titer T* required to achieve a target protection probability p*.\n        T* = exp((logit(p*) - alpha) / beta)\n        where logit(p*) = ln(p* / (1 - p*))\n        \"\"\"\n        # Ensure p_star is a valid probability (0  p_star  1)\n        if not (0  p_star  1):\n            raise ValueError(\"Target probability must be between 0 and 1.\")\n        \n        logit_p_star = np.log(p_star / (1.0 - p_star))\n        log_T_star = (logit_p_star - alpha) / beta\n        return np.exp(log_T_star)\n\n    # --- Computation for the Test Suite ---\n    results = []\n\n    # 1. P_LA(T1) using (alpha_la, beta_la) and T1\n    results.append(calculate_protection_probability(T1, alpha_la, beta_la))\n\n    # 2. P_IN(T1) using (alpha_in, beta_in) and T1\n    results.append(calculate_protection_probability(T1, alpha_in, beta_in))\n\n    # 3. P_LA(T2) using (alpha_la, beta_la) and T2\n    results.append(calculate_protection_probability(T2, alpha_la, beta_la))\n\n    # 4. P_IN(T3) using (alpha_in, beta_in) and T3\n    results.append(calculate_protection_probability(T3, alpha_in, beta_in))\n\n    # 5. Odds multiplier for f1 under LA (beta_la)\n    results.append(calculate_odds_multiplier(f1, beta_la))\n\n    # 6. Odds multiplier for f1 under IN (beta_in)\n    results.append(calculate_odds_multiplier(f1, beta_in))\n\n    # 7. Titer T*_LA to achieve p* under LA\n    results.append(calculate_target_titer(p_star, alpha_la, beta_la))\n\n    # 8. Titer T*_IN to achieve p* under IN\n    results.append(calculate_target_titer(p_star, alpha_in, beta_in))\n\n    # 9. Odds multiplier for f2 with beta_small\n    results.append(calculate_odds_multiplier(f2, beta_small))\n\n    # 10. Odds multiplier for f2 with beta_large\n    results.append(calculate_odds_multiplier(f2, beta_large))\n\n    # --- Final Output Formatting ---\n    # Format results to 6 decimal places and print in the required format.\n    formatted_results = [f'{x:.6f}' for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution\nsolve()\n\n```", "id": "2864475"}]}