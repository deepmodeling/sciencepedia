{"hands_on_practices": [{"introduction": "Understanding the viral replication cycle begins with the initial encounter between virus and host cell. When a viral inoculum is added to a cell culture, the distribution of virions across the cell population is not uniform. This exercise introduces the Poisson distribution, a fundamental tool in quantitative biology, as a model for these random infection events. By deriving this distribution from first principles, you will gain a deeper appreciation for the statistical nature of infection and learn to calculate key population outcomes, such as the fraction of cells that are uninfected, singly infected, or multiply infected—a crucial factor for phenomena like genetic complementation [@problem_id:2544916].", "problem": "A clonal population of susceptible cells is exposed to a lytic virus inoculum with multiplicity of infection (MOI) $m = 0.3$. Assume adsorption events of individual virions to a given cell occur independently and are rare, with the total number of adsorption events per cell being the sum of many independent Bernoulli trials with small success probability. Work from this independence assumption and the law of rare events to obtain the distribution of the number of adsorbed virions per cell, then use that distribution to compute population fractions.\n\nStarting from first principles (i.e., independent adsorption of $N$ virions across $M$ cells with per-virion per-cell hit probability $p = 1/M$, and keeping $m = Np$ fixed as $N \\to \\infty$, $p \\to 0$), derive the probability mass function for the number of virions $K$ adsorbed by a given cell. Then, for $m = 0.3$, compute the fraction of cells that are uninfected ($K = 0$), singly infected ($K = 1$), and multiply infected ($K \\geq 2$). Finally, consider a strict genetic complementation scenario in which productive output requires at least two distinct viral genomes coinfecting the same cell; under the idealized assumption that any cell with $K \\geq 2$ coinfections achieves complementation with probability $1$, whereas cells with $K \\leq 1$ do not complement, determine the expected fraction of cells that are capable of complementation at MOI $m = 0.3$.\n\nReport only the complementation-capable fraction as your final answer, expressed as a decimal fraction and rounded to $4$ significant figures. Do not use a percent sign.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed problem in mathematical biology, grounded in the established principles of viral infection kinetics and statistical mechanics. The assumptions are clearly stated, and the objectives are quantifiable. We will proceed with the solution.\n\nThe problem asks for the derivation of the distribution for the number of virions, $K$, adsorbed to a single cell, under the specified \"law of rare events\" limiting conditions. We are given $N$ virions and $M$ cells. For any individual virion, the probability of adsorbing to a specific, designated cell is $p = 1/M$. The adsorption of each of the $N$ virions to our target cell is an independent Bernoulli trial. Therefore, the total number of successful adsorption events, $K$, follows a binomial distribution with parameters $N$ (number of trials) and $p$ (probability of success):\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\nThe problem instructs us to consider the limit where $N \\to \\infty$ and $M \\to \\infty$ such that the multiplicity of infection (MOI), $m = N/M$, remains constant. The probability $p$ is related to $m$ and $N$ by $p = 1/M = m/N$. As $N \\to \\infty$ while $m$ is fixed, it follows that $p \\to 0$. This is the classic Poisson limit of the binomial distribution. We perform this derivation formally.\n\nSubstitute $p = m/N$ into the binomial probability mass function:\n$$P(K=k) = \\frac{N!}{k!(N-k)!} \\left(\\frac{m}{N}\\right)^k \\left(1-\\frac{m}{N}\\right)^{N-k}$$\nWe rearrange the terms to analyze the limit as $N \\to \\infty$:\n$$P(K=k) = \\frac{m^k}{k!} \\frac{N(N-1)\\cdots(N-k+1)}{N^k} \\left(1-\\frac{m}{N}\\right)^N \\left(1-\\frac{m}{N}\\right)^{-k}$$\nWe evaluate the limit of each component as $N \\to \\infty$:\n1.  The term $\\frac{m^k}{k!}$ is independent of $N$.\n2.  The product $\\frac{N(N-1)\\cdots(N-k+1)}{N^k} = \\frac{N}{N} \\cdot \\frac{N-1}{N} \\cdots \\frac{N-k+1}{N} = 1 \\cdot \\left(1-\\frac{1}{N}\\right) \\cdots \\left(1-\\frac{k-1}{N}\\right)$. For any fixed integer $k$, this product approaches $1$ as $N \\to \\infty$.\n3.  By the definition of the exponential function, $\\lim_{N\\to\\infty} \\left(1-\\frac{m}{N}\\right)^N = \\exp(-m)$.\n4.  For any fixed $k$, $\\lim_{N\\to\\infty} \\left(1-\\frac{m}{N}\\right)^{-k} = (1-0)^{-k} = 1$.\n\nCombining these results, the limiting distribution is:\n$$\\lim_{N\\to\\infty} P(K=k) = \\frac{m^k}{k!} \\cdot 1 \\cdot \\exp(-m) \\cdot 1 = \\frac{\\exp(-m) m^k}{k!}$$\nThis is the probability mass function of the Poisson distribution with parameter $m$. The fraction of cells in a large population that are infected by exactly $k$ virions is well-approximated by this probability.\n\nThe problem asks for the fraction of cells that can support genetic complementation. According to the stated conditions, complementation occurs if and only if a cell is infected by at least two virions, i.e., $K \\ge 2$. The fraction of such cells, denoted $F_{comp}$, is therefore $P(K \\ge 2)$. It is more direct to calculate this by finding the sum of the probabilities of the complementary events, $K=0$ and $K=1$, and subtracting from $1$.\n$$F_{comp} = P(K \\ge 2) = 1 - P(K < 2) = 1 - \\big( P(K=0) + P(K=1) \\big)$$\nUsing the derived Poisson PMF:\n$$P(K=0) = \\frac{\\exp(-m) m^0}{0!} = \\exp(-m)$$\n$$P(K=1) = \\frac{\\exp(-m) m^1}{1!} = m \\exp(-m)$$\nSubstituting these into the expression for $F_{comp}$:\n$$F_{comp} = 1 - (\\exp(-m) + m \\exp(-m)) = 1 - (1+m)\\exp(-m)$$\nWe are given an MOI of $m = 0.3$. We substitute this value into our derived formula:\n$$F_{comp} = 1 - (1+0.3)\\exp(-0.3) = 1 - 1.3\\exp(-0.3)$$\nNow, we compute the numerical value.\n$$ \\exp(-0.3) \\approx 0.74081822 $$\n$$ F_{comp} \\approx 1 - 1.3 \\times 0.74081822 = 1 - 0.963063686 = 0.036936314 $$\nThe problem requires the answer to be rounded to $4$ significant figures. The first four significant figures are $3$, $6$, $9$, $3$. The fifth significant figure is $6$, so we round up the fourth digit.\n$$ F_{comp} \\approx 0.03694 $$\nThis is the expected fraction of cells in the population that are capable of complementation.", "answer": "$$\\boxed{0.03694}$$", "id": "2544916"}, {"introduction": "A key insight in virology is that the number of physical viral particles produced often far exceeds the number of truly infectious units. The particle-to-PFU (Plaque Forming Unit) ratio is a critical metric that quantifies this discrepancy and serves as a measure of a virus's specific infectivity. This practice challenges you to act as a quantitative virologist, using mock experimental data from two standard assays—qPCR for total genome-containing particles and plaque assays for infectious virions—to diagnose replication defects. You will learn how mutations affecting different stages, such as assembly versus entry, create distinct quantitative signatures, allowing you to pinpoint the functional impact of genetic changes [@problem_id:2544906].", "problem": "A viral preparation is characterized by two independent assays that probe distinct stages of the viral replication cycle. A plaque assay reports the concentration of infectious virions as plaque-forming units (PFU), reflecting successful completion of attachment, entry, genome delivery, and initiation of productive infection. A capsid-protected quantitative Polymerase Chain Reaction (qPCR) assay, performed after nuclease treatment to remove unencapsidated nucleic acids, reports the concentration of genome-containing particles in the extracellular supernatant, reflecting successful completion of assembly and release of genome-packaging competent virions, regardless of their subsequent infectivity. By core definitions used in virology, the particle-to-PFU ratio for a given preparation equals the number of genome-containing particles per infectious unit, and the reciprocal of this ratio is the fraction of particles that are infectious.\n\nYou analyze three otherwise isogenic viral strains: wild-type (WT), MutA (a capsid assembly mutant), and MutE (an entry/fusion mutant). For each strain, you measure the following at the same post-infection time point from clarified supernatants:\n- WT: plaque assay titer $2.5 \\times 10^{8}$ PFU per milliliter, capsid-protected qPCR genome count $1.0 \\times 10^{10}$ genomes per milliliter.\n- MutA: plaque assay titer $1.5 \\times 10^{8}$ PFU per milliliter, capsid-protected qPCR genome count $4.5 \\times 10^{10}$ genomes per milliliter.\n- MutE: plaque assay titer $2.0 \\times 10^{7}$ PFU per milliliter, capsid-protected qPCR genome count $1.2 \\times 10^{10}$ genomes per milliliter.\n\nUsing only fundamental definitions of what each assay measures in the viral life cycle (attachment and entry for infectivity; assembly and release for genome-containing particle production), first derive the particle-to-PFU ratio for each strain from the provided data. Then, define the fold-change in particle-to-PFU ratio relative to wild-type for strain $i$ as $F_{i} = \\left(\\text{particle-to-PFU ratio of strain } i\\right) \\Big/ \\left(\\text{particle-to-PFU ratio of WT}\\right)$. Finally, compute the comparative index\n$$\nR \\equiv \\frac{F_{\\mathrm{MutE}}}{F_{\\mathrm{MutA}}}\n$$.\nReport $R$ as a pure number (no units) and round to $3$ significant figures.\n\nIn your reasoning, explain mechanistically, using the stages of the replication cycle (attachment, entry, synthesis, assembly, and release), why an assembly defect versus an entry defect is expected to differentially change the particle-to-PFU ratio, and why the above ratio $R$ captures that difference. Only the single numerical value of $R$ should be provided as the final answer.", "solution": "The problem presented is a quantitative analysis of viral infectivity based on standard virological assays. Before proceeding to a solution, we must first validate the problem statement for scientific soundness, logical consistency, and completeness.\n\n**Problem Validation**\n\nStep 1: Extracted Givens\n- A plaque assay measures the concentration of infectious virions, denoted as plaque-forming units per milliliter (PFU/mL). This assay quantifies the successful completion of attachment, entry, and initiation of infection.\n- A capsid-protected quantitative Polymerase Chain Reaction (qPCR) assay measures the concentration of genome-containing particles in genomes per milliliter. This assay quantifies the successful completion of virion assembly and release.\n- The particle-to-PFU ratio is defined as the number of genome-containing particles per infectious unit.\n- The reciprocal of the particle-to-PFU ratio is the fraction of particles that are infectious.\n- Experimental data are provided for three viral strains: wild-type (WT), an assembly mutant (MutA), and an entry/fusion mutant (MutE).\n- WT data: Plaque titer is $2.5 \\times 10^{8}$ PFU/mL; genome count is $1.0 \\times 10^{10}$ genomes/mL.\n- MutA data: Plaque titer is $1.5 \\times 10^{8}$ PFU/mL; genome count is $4.5 \\times 10^{10}$ genomes/mL.\n- MutE data: Plaque titer is $2.0 \\times 10^{7}$ PFU/mL; genome count is $1.2 \\times 10^{10}$ genomes/mL.\n- The fold-change in particle-to-PFU ratio for a strain $i$ relative to WT is defined as $F_{i} = \\left(\\text{particle-to-PFU ratio of strain } i\\right) \\Big/ \\left(\\text{particle-to-PFU ratio of WT}\\right)$.\n- The objective is to compute the comparative index $R \\equiv \\frac{F_{\\mathrm{MutE}}}{F_{\\mathrm{MutA}}}$ and report the value rounded to $3$ significant figures.\n\nStep 2: Validation Using Extracted Givens\nThe problem is scientifically grounded, using standard concepts and methodologies from quantitative virology. The definitions provided are correct and conventional. The problem is well-posed, as all necessary data and relationships are explicitly given to compute a unique solution. The data are numerically plausible for viral preparations. There are no contradictions, ambiguities, or reliance on pseudoscience.\n\nStep 3: Verdict and Action\nThe problem is valid. We will now proceed with the solution.\n\n**Solution Derivation**\n\nLet $T_{i}$ denote the plaque assay titer in PFU/mL and $G_{i}$ denote the capsid-protected genome count in genomes/mL for a strain $i$, where $i \\in \\{\\text{WT, MutA, MutE}\\}$.\n\nThe particle-to-PFU ratio, which we will denote by $\\rho_{i}$, is defined as the ratio of the concentration of genome-containing particles to the concentration of infectious units.\n$$\n\\rho_{i} = \\frac{G_{i}}{T_{i}}\n$$\nThis ratio is an inverse measure of specific infectivity; a higher value signifies that a larger number of physical particles are required to produce a single infectious event, indicating a lower quality of viral particles in the preparation.\n\nMechanistically, the particle-to-PFU ratio is sensitive to defects at different stages of the viral life cycle. The qPCR assay quantifies particles that have successfully completed assembly and release. The plaque assay quantifies particles that, in addition, can successfully complete attachment and entry.\n- A mutation in assembly (MutA) affects the formation of the virion particle itself. This can result in an increased production of defective particles that contain a genome ($G_{\\text{MutA}}$ is high) but are not structurally sound and therefore fail to infect ($T_{\\text{MutA}}$ is low or reduced). This will increase the ratio $\\rho_{\\text{MutA}}$ relative to the wild-type $\\rho_{\\text{WT}}$.\n- A mutation in entry (MutE) affects a step subsequent to particle formation. Virions may be assembled and released correctly ($G_{\\text{MutE}}$ may be near normal), but they are functionally impaired in their ability to enter a host cell. This leads to a sharp decrease in infectious units ($T_{\\text{MutE}}$) for a given number of physical particles, thereby significantly increasing the ratio $\\rho_{\\text{MutE}}$.\n\nThe index $R = F_{\\mathrm{MutE}}/F_{\\mathrm{MutA}}$ compares the magnitude of the defect on per-particle infectivity for the entry mutant versus the assembly mutant, after normalizing both to the wild-type baseline.\n\nWe now compute the necessary quantities using the provided data.\n\n$1$. Calculation of the particle-to-PFU ratio ($\\rho_{i}$) for each strain:\n- For Wild-Type (WT):\n$T_{\\text{WT}} = 2.5 \\times 10^{8}$ PFU/mL\n$G_{\\text{WT}} = 1.0 \\times 10^{10}$ genomes/mL\n$$\n\\rho_{\\text{WT}} = \\frac{G_{\\text{WT}}}{T_{\\text{WT}}} = \\frac{1.0 \\times 10^{10}}{2.5 \\times 10^{8}} = \\frac{100 \\times 10^{8}}{2.5 \\times 10^{8}} = 40\n$$\n- For the Assembly Mutant (MutA):\n$T_{\\text{MutA}} = 1.5 \\times 10^{8}$ PFU/mL\n$G_{\\text{MutA}} = 4.5 \\times 10^{10}$ genomes/mL\n$$\n\\rho_{\\text{MutA}} = \\frac{G_{\\text{MutA}}}{T_{\\text{MutA}}} = \\frac{4.5 \\times 10^{10}}{1.5 \\times 10^{8}} = \\frac{450 \\times 10^{8}}{1.5 \\times 10^{8}} = 300\n$$\n- For the Entry Mutant (MutE):\n$T_{\\text{MutE}} = 2.0 \\times 10^{7}$ PFU/mL\n$G_{\\text{MutE}} = 1.2 \\times 10^{10}$ genomes/mL\n$$\n\\rho_{\\text{MutE}} = \\frac{G_{\\text{MutE}}}{T_{\\text{MutE}}} = \\frac{1.2 \\times 10^{10}}{2.0 \\times 10^{7}} = \\frac{1200 \\times 10^{7}}{2.0 \\times 10^{7}} = 600\n$$\n\n$2$. Calculation of the fold-change ($F_{i}$) relative to WT:\n- For MutA:\n$$\nF_{\\text{MutA}} = \\frac{\\rho_{\\text{MutA}}}{\\rho_{\\text{WT}}} = \\frac{300}{40} = 7.5\n$$\n- For MutE:\n$$\nF_{\\text{MutE}} = \\frac{\\rho_{\\text{MutE}}}{\\rho_{\\text{WT}}} = \\frac{600}{40} = 15\n$$\n\n$3$. Calculation of the comparative index $R$:\n$$\nR = \\frac{F_{\\mathrm{MutE}}}{F_{\\mathrm{MutA}}} = \\frac{15}{7.5} = 2\n$$\n\nThe result is an exact integer $2$. The problem requires the answer to be rounded to $3$ significant figures. Therefore, we express the answer as $2.00$. The value $R=2.00$ indicates that the specific entry defect in MutE causes a two-fold greater increase in the particle-to-PFU ratio (relative to WT) than the assembly defect in MutA.", "answer": "$$\n\\boxed{2.00}\n$$", "id": "2544906"}, {"introduction": "Segmented viruses, such as influenza virus, face a unique and complex assembly problem: a new infectious virion must be packaged with a complete set of distinct genome segments. This co-packaging requirement represents a significant probabilistic bottleneck that constrains viral replication. This advanced computational practice guides you to model this stochastic assembly process by building a program from first principles. You will use Poisson statistics to model the synthesis of each segment and then calculate the expected yield of fully assembled virions, providing hands-on experience in modeling how fundamental molecular constraints shape viral fitness and population dynamics [@problem_id:2544941].", "problem": "Consider a segmented negative-sense single-stranded Ribonucleic Acid (-ssRNA) virus that requires one copy of each of $S$ distinct genome segments to assemble an infectious virion. Use only core, well-tested microbiological and probabilistic principles as the modeling base:\n- During the synthesis stage, each genome segment is replicated independently, yielding a random count of copies per infected cell in one replication cycle. Under the law of rare events and molecular independence assumptions, these counts can be modeled by independent $\\mathrm{Poisson}$ random variables.\n- A copy of a segment is packaging-competent with some probability, independently of other copies; thinning of a $\\mathrm{Poisson}$ process implies that the competent copies remain $\\mathrm{Poisson}$ distributed.\n- The assembly step requires exactly one competent copy of each segment; therefore, the number of fully assembled infectious virions per infected cell equals the minimum across segment copy counts.\n- The attachment/entry and release steps are captured by a per-virion success factor that maps released infectious virions to the expected number of new infected cells in the next generation.\n\nFormalize the following model. Let $S$ be the number of segments. For segment $i \\in \\{1,\\dots,S\\}$, let $\\mu_i$ denote the expected number of total copies produced during the synthesis stage per infected cell in one replication cycle, and let $p_i \\in [0,1]$ denote the probability that a given copy of segment $i$ is packaging-competent. The number of packaging-competent copies of segment $i$ is modeled as $N_i \\sim \\mathrm{Poisson}(\\lambda_i)$ with $\\lambda_i = \\mu_i \\, p_i$, independently across $i$. The number of completely assembled infectious virions released from one infected cell in a cycle is $V = \\min_{1 \\le i \\le S} N_i$. Let $\\beta > 0$ be the effective per-virion success constant aggregating attachment, entry, and productive infection. The expected number of newly infected cells generated by a single infected cell in the next replication cycle is defined as\n$R = \\beta \\, \\mathbb{E}[V]$.\n\nYour task is to write a program that, given $S$, the vector of $\\mu_i$, the vector of $p_i$, and $\\beta$, computes $R$ by numerically evaluating $\\mathbb{E}[\\min_{i} N_i]$ with sufficient precision using only first principles and standard probability identities. Do not assume any shortcut formulas beyond those derivable from the definitions and the $\\mathrm{Poisson}$ and independence assumptions. The output for each test case must be a single real number $R$ rounded to 6 decimal places.\n\nTest suite:\n- Case A (balanced synthesis): $S = 3$, $\\mu = [50, 50, 50]$, $p = [1, 1, 1]$, $\\beta = 0.02$.\n- Case B (one limiting segment): $S = 3$, $\\mu = [50, 50, 5]$, $p = [1, 1, 1]$, $\\beta = 0.02$.\n- Case C (low-copy regime): $S = 3$, $\\mu = [1, 1, 1]$, $p = [1, 1, 1]$, $\\beta = 1$.\n- Case D (competence bottleneck): $S = 3$, $\\mu = [40, 40, 40]$, $p = [0.5, 0.5, 0.1]$, $\\beta = 0.05$.\n- Case E (assembly impossible): $S = 3$, $\\mu = [10, 0, 10]$, $p = [1, 1, 1]$, $\\beta = 1$.\n\nRequirements:\n- Your program must compute $R$ for each case by evaluating $\\mathbb{E}[V]$ from the model above to numerical convergence, not by simulation, and not by relying on closed-form shortcut expressions that are not directly derivable from the definitions.\n- Round each $R$ to 6 decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases A through E, for example, $[r_A,r_B,r_C,r_D,r_E]$, where each $r_*$ is a decimal with exactly 6 places.\n- No physical units are required in the answer, and no angles are involved. All fractional values must be decimals, not ratios.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. The model is based on established principles of virology and probability theory, specifically the use of Poisson processes for modeling molecular counts and the derivation of system behavior from component properties. All parameters are provided for the specified test cases. Therefore, I will proceed with a solution.\n\nThe central task is to compute the expected number of newly infected cells, $R$, defined by the equation $R = \\beta \\, \\mathbb{E}[V]$. Here, $\\beta$ is a given constant, and $V$ is the number of infectious virions assembled in a single cell. The number of virions is limited by the least abundant packaging-competent genome segment, so $V = \\min_{1 \\le i \\le S} N_i$. The variables $N_i$ represent the count of packaging-competent copies of segment $i$, and are modeled as independent Poisson random variables, $N_i \\sim \\mathrm{Poisson}(\\lambda_i)$, with rate parameters $\\lambda_i = \\mu_i p_i$.\n\nTo compute $R$, we must first determine the expectation $\\mathbb{E}[V] = \\mathbb{E}[\\min_{1 \\le i \\le S} N_i]$. As $V$ is a non-negative, integer-valued random variable, its expectation can be calculated using the tail-sum formula, which is often more convenient for computation than the direct definition based on the probability mass function. The formula states:\n$$ \\mathbb{E}[V] = \\sum_{k=1}^{\\infty} P(V \\ge k) $$\nThis identity is derived as follows:\n$$ \\mathbb{E}[V] = \\sum_{j=0}^{\\infty} j \\cdot P(V=j) = \\sum_{j=1}^{\\infty} j \\cdot P(V=j) = \\sum_{j=1}^{\\infty} \\sum_{k=1}^{j} P(V=j) $$\nBy changing the order of summation, we get:\n$$ \\mathbb{E}[V] = \\sum_{k=1}^{\\infty} \\sum_{j=k}^{\\infty} P(V=j) = \\sum_{k=1}^{\\infty} P(V \\ge k) $$\n\nThe event $\\{V \\ge k\\}$ is equivalent to the event $\\{\\min_{1 \\le i \\le S} N_i \\ge k\\}$, which occurs if and only if $N_i \\ge k$ for all segments $i \\in \\{1, \\dots, S\\}$.\n$$ P(V \\ge k) = P(N_1 \\ge k, N_2 \\ge k, \\dots, N_S \\ge k) $$\nBecause the random variables $N_i$ are independent, the joint probability is the product of the marginal probabilities:\n$$ P(V \\ge k) = \\prod_{i=1}^{S} P(N_i \\ge k) $$\nThe term $P(N_i \\ge k)$ is the survival function of the Poisson distribution with parameter $\\lambda_i$. It is the complement of the cumulative distribution function (CDF) at $k-1$:\n$$ P(N_i \\ge k) = 1 - P(N_i \\le k-1) = 1 - \\sum_{m=0}^{k-1} \\frac{e^{-\\lambda_i} \\lambda_i^m}{m!} $$\nSubstituting this back into the expression for $\\mathbb{E}[V]$, we obtain the formula for numerical computation:\n$$ \\mathbb{E}[V] = \\sum_{k=1}^{\\infty} \\left( \\prod_{i=1}^{S} P(N_i \\ge k) \\right) $$\n\nTo implement a numerical solution, this infinite series must be truncated. The terms of the series are positive and decrease as $k$ increases, eventually becoming negligible. We can approximate the sum by summing up to a sufficiently large integer $K_{max}$, chosen such that the contribution of subsequent terms is smaller than a pre-defined numerical tolerance, $\\epsilon$. The algorithm is as follows:\n1. For a given test case, the parameters $S$, $\\{\\mu_i\\}_{i=1}^S$, $\\{p_i\\}_{i=1}^S$, and $\\beta$ are used to calculate the Poisson rate parameters $\\lambda_i = \\mu_i p_i$ for each segment.\n2. An important edge case is when any $\\lambda_i = 0$. A Poisson variable with rate $0$ is identically $0$ ($P(N_i=0)=1$). In this case, $V = \\min_i N_i = 0$, so its expectation $\\mathbb{E}[V]$ is $0$, and thus $R = 0$. This occurs in Case E.\n3. For the general case where all $\\lambda_i > 0$, we initialize a sum for $\\mathbb{E}[V]$ to $0.0$.\n4. We iterate through $k = 1, 2, 3, \\dots$. In each iteration, we compute the term $T_k = \\prod_{i=1}^{S} P(N_i \\ge k)$.\n5. The survival function $P(N_i \\ge k)$ for each segment is calculated using a robust numerical library function (`scipy.stats.poisson.sf`), which provides a stable and accurate evaluation.\n6. The term $T_k$ is added to the running sum for $\\mathbb{E}[V]$.\n7. The iteration continues until $T_k$ falls below a small tolerance (e.g., $\\epsilon = 10^{-18}$), at which point the series is considered to have converged.\n8. The final expectation $\\mathbb{E}[V]$ is then multiplied by the success factor $\\beta$ to obtain $R$.\n9. The result $R$ for each case is rounded to $6$ decimal places as required. This procedure is applied to each test case to generate the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import poisson\n\ndef compute_r(S, mu, p, beta):\n    \"\"\"\n    Computes the expected number of newly infected cells, R.\n\n    This function implements the numerical calculation of R based on the derived\n    tail-sum formula for the expectation of the minimum of independent Poisson\n    random variables.\n    \"\"\"\n    # Step 1: Calculate Poisson rate parameters lambda_i\n    # The parameters lambda_i = mu_i * p_i\n    lambdas = np.array(mu) * np.array(p)\n\n    # Step 2: Handle the edge case where a segment is not produced\n    # If any lambda_i is 0, then N_i is always 0, so min(N_i) is 0.\n    if np.any(lambdas == 0):\n        return 0.0\n\n    # Step 3: Compute E[V] using the tail-sum formula\n    # E[V] = sum_{k=1 to infinity} P(V >= k)\n    #      = sum_{k=1 to infinity} product_{i=1 to S} P(N_i >= k)\n    expected_v = 0.0\n    k = 1\n    # Tolerance for numerical convergence\n    tolerance = 1e-18\n\n    while True:\n        # P(N_i >= k) is the survival function at k-1\n        # scipy.stats.poisson.sf(k-1, lambda) computes P(N > k-1)\n        prob_ge_k_all_segments = poisson.sf(k - 1, lambdas)\n\n        # The term to be added in the sum\n        term_k = np.prod(prob_ge_k_all_segments)\n\n        # Check for convergence\n        if term_k < tolerance:\n            break\n\n        # Add term to the expectation\n        expected_v += term_k\n        k += 1\n\n    # Step 4: Calculate R\n    R = beta * expected_v\n    return R\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (S, mu, p, beta)\n        (3, [50, 50, 50], [1, 1, 1], 0.02),      # Case A\n        (3, [50, 50, 5], [1, 1, 1], 0.02),       # Case B\n        (3, [1, 1, 1], [1, 1, 1], 1.0),          # Case C\n        (3, [40, 40, 40], [0.5, 0.5, 0.1], 0.05),# Case D\n        (3, [10, 0, 10], [1, 1, 1], 1.0)         # Case E\n    ]\n\n    results = []\n    for S, mu, p, beta in test_cases:\n        r_val = compute_r(S, mu, p, beta)\n        # Format the result to 6 decimal places.\n        results.append(f\"{r_val:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2544941"}]}