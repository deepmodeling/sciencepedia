{"hands_on_practices": [{"introduction": "Characterizing the fleeting structure of the protein folding transition state is a central challenge in biophysics. This high-energy state is the kinetic bottleneck for folding, yet it is too transient to be observed directly. This practice introduces you to $\\phi$-value analysis, an elegant protein engineering method that uses site-directed mutagenesis to build a low-resolution picture of the transition state structure. By analyzing how mutations affect folding and unfolding rates, you will calculate $\\phi$-values to determine which residues have formed their native-like contacts at the apex of the folding energy barrier, thereby identifying the protein's \"folding nucleus\" [@problem_id:2765799].", "problem": "In a synthetic biology design project aimed at engineering folding robustness, you are analyzing a small single-domain protein that folds by a two-state mechanism. You perform classical Transition State Theory (TST) analysis under isothermal conditions and quantify the effects of six alanine-to-glycine point mutations (one per site) on the folding and unfolding rates relative to wild type. Assume the following foundations: (i) classical Transition State Theory with a constant transmission coefficient so that relative rate changes reflect changes in activation free energies, and (ii) a two-state folding mechanism where the equilibrium stability is determined by the ratio of folding and unfolding rates. The temperature is fixed and identical for all measurements, and the wild-type rates are denoted by $k_{f}^{\\mathrm{WT}}$ and $k_{u}^{\\mathrm{WT}}$. For each mutation $i \\in \\{1,2,3,4,5,6\\}$, the observed rate changes are given as fold-change factors relative to wild type at the same temperature:\n- Mutation $1$: $k_{f}^{(1)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.2)$, $k_{u}^{(1)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.8)$\n- Mutation $2$: $k_{f}^{(2)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-1.0)$, $k_{u}^{(2)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.5)$\n- Mutation $3$: $k_{f}^{(3)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.8)$, $k_{u}^{(3)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.2)$\n- Mutation $4$: $k_{f}^{(4)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.6)$, $k_{u}^{(4)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.3)$\n- Mutation $5$: $k_{f}^{(5)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.1)$, $k_{u}^{(5)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.9)$\n- Mutation $6$: $k_{f}^{(6)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.3)$, $k_{u}^{(6)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.9)$\n\nHere $\\exp(\\cdot)$ denotes the exponential function, and all rate constants are at the same temperature so that the pre-exponential factors in Transition State Theory cancel in ratios. Define the $\\phi$-value for mutation $i$ as the ratio of the mutation-induced change in the folding activation free energy to the mutation-induced change in the equilibrium stability (native-state free energy), both in units of $RT$, where $R$ is the universal gas constant and $T$ is the absolute temperature.\n\nYou are also given a native-state residue-residue contact graph whose vertices are the six mutated sites $\\{1,2,3,4,5,6\\}$ and whose undirected edges indicate side-chain contacts within a $5 \\,\\mathrm{\\AA}$ cutoff in the native structure. The edges are:\n- $\\{1,2\\}$, $\\{2,3\\}$, $\\{3,4\\}$, $\\{4,5\\}$, $\\{5,6\\}$, $\\{2,4\\}$\n\nDefine a $\\phi$-threshold $\\theta = 0.5$. The folding nucleus is operationally defined as the largest connected component of the induced subgraph on the set of residues with $\\phi \\ge \\theta$.\n\nUsing only the above foundations and data, compute the $\\phi$-values for the six mutations, construct the induced subgraph at threshold $\\theta$, and determine the size (number of residues) of the folding nucleus. Report only this size as your final answer. No rounding is required, and the final answer should be an integer without units.", "solution": "The problem requires the determination of the size of a protein folding nucleus based on kinetic data from a series of point mutations. The analysis must be grounded in classical Transition State Theory (TST) and the principles of $\\phi$-value analysis.\n\nFirst, we must formalize the relationship between the given rate constants and the relevant thermodynamic quantities. According to TST, for a reaction with activation free energy $\\Delta G^{\\ddagger}$, the rate constant $k$ at temperature $T$ is given by:\n$$ k = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right) $$\nwhere $\\kappa$ is the transmission coefficient, $k_B$ is the Boltzmann constant, and $h$ is the Planck constant. The problem states that $\\kappa$ is constant and all measurements are at the same temperature $T$. For a mutation $i$, the ratio of the mutant rate constant $k^{(i)}$ to the wild-type rate constant $k^{\\mathrm{WT}}$ is:\n$$ \\frac{k^{(i)}}{k^{\\mathrm{WT}}} = \\frac{\\exp\\left(-\\frac{\\Delta G^{\\ddagger, (i)}}{RT}\\right)}{\\exp\\left(-\\frac{\\Delta G^{\\ddagger, \\mathrm{WT}}}{RT}\\right)} = \\exp\\left(-\\frac{\\Delta G^{\\ddagger, (i)} - \\Delta G^{\\ddagger, \\mathrm{WT}}}{RT}\\right) = \\exp\\left(-\\frac{\\Delta \\Delta G^{\\ddagger, (i)}}{RT}\\right) $$\nHere, $\\Delta \\Delta G^{\\ddagger, (i)}$ represents the change in activation free energy due to mutation $i$. Taking the natural logarithm gives the change in activation free energy in units of $RT$:\n$$ \\frac{\\Delta \\Delta G^{\\ddagger, (i)}}{RT} = -\\ln\\left(\\frac{k^{(i)}}{k^{\\mathrm{WT}}}\\right) $$\nThis relation applies to both the folding ($k_f$) and unfolding ($k_u$) processes, with their respective activation free energies $\\Delta G_f^{\\ddagger}$ and $\\Delta G_u^{\\ddagger}$.\n\nThe problem defines the $\\phi$-value for a mutation $i$ as the ratio of the change in the folding activation free energy to the change in the equilibrium free energy of folding (stability), $\\Delta G_{N-U}$:\n$$ \\phi_i = \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}}{\\Delta \\Delta G_{N-U,i}} $$\nThe change in stability, $\\Delta \\Delta G_{N-U,i}$, can be related to the changes in activation energies. The free energy of folding is $\\Delta G_{N-U} = G_N - G_U$. The activation barriers are defined from the unfolded state $U$ and the native state $N$ to the transition state $TS$: $\\Delta G_f^{\\ddagger} = G_{TS} - G_U$ and $\\Delta G_u^{\\ddagger} = G_{TS} - G_N$. From these definitions, it follows that $\\Delta G_{N-U} = \\Delta G_f^{\\ddagger} - \\Delta G_u^{\\ddagger}$. The change in this quantity upon mutation is:\n$$ \\Delta \\Delta G_{N-U,i} = \\Delta \\Delta G_{f,i}^{\\ddagger} - \\Delta \\Delta G_{u,i}^{\\ddagger} $$\nTherefore, the $\\phi$-value, expressed in units of $RT$, is:\n$$ \\phi_i = \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}/RT}{\\Delta \\Delta G_{N-U,i}/RT} = \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}/RT}{\\Delta \\Delta G_{f,i}^{\\ddagger}/RT - \\Delta \\Delta G_{u,i}^{\\ddagger}/RT} $$\nUsing the relationships derived from TST:\n$$ \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}}{RT} = -\\ln\\left(\\frac{k_f^{(i)}}{k_f^{\\mathrm{WT}}}\\right) \\quad \\text{and} \\quad \\frac{\\Delta \\Delta G_{u,i}^{\\ddagger}}{RT} = -\\ln\\left(\\frac{k_u^{(i)}}{k_u^{\\mathrm{WT}}}\\right) $$\nThe problem provides the values of $\\ln(k_f^{(i)}/k_f^{\\mathrm{WT}})$ and $\\ln(k_u^{(i)}/k_u^{\\mathrm{WT}})$ directly within the exponential terms. Let these values be denoted by $X_i$ and $Y_i$ respectively. So, $k_f^{(i)}/k_f^{\\mathrm{WT}} = \\exp(X_i)$ and $k_u^{(i)}/k_u^{\\mathrm{WT}} = \\exp(Y_i)$.\nThen, $\\Delta \\Delta G_{f,i}^{\\ddagger}/RT = -X_i$ and $\\Delta \\Delta G_{u,i}^{\\ddagger}/RT = -Y_i$. Substituting these into the expression for $\\phi_i$ yields:\n$$ \\phi_i = \\frac{-X_i}{-X_i - (-Y_i)} = \\frac{-X_i}{Y_i - X_i} $$\nWe now compute the $\\phi$-value for each of the $6$ mutations.\n\n- **Mutation 1:** $X_1 = -0.2$, $Y_1 = 0.8$.\n  $$ \\phi_1 = \\frac{-(-0.2)}{0.8 - (-0.2)} = \\frac{0.2}{1.0} = 0.2 $$\n- **Mutation 2:** $X_2 = -1.0$, $Y_2 = 0.5$.\n  $$ \\phi_2 = \\frac{-(-1.0)}{0.5 - (-1.0)} = \\frac{1.0}{1.5} = \\frac{2}{3} $$\n- **Mutation 3:** $X_3 = -0.8$, $Y_3 = 0.2$.\n  $$ \\phi_3 = \\frac{-(-0.8)}{0.2 - (-0.8)} = \\frac{0.8}{1.0} = 0.8 $$\n- **Mutation 4:** $X_4 = -0.6$, $Y_4 = 0.3$.\n  $$ \\phi_4 = \\frac{-(-0.6)}{0.3 - (-0.6)} = \\frac{0.6}{0.9} = \\frac{2}{3} $$\n- **Mutation 5:** $X_5 = -0.1$, $Y_5 = 0.9$.\n  $$ \\phi_5 = \\frac{-(-0.1)}{0.9 - (-0.1)} = \\frac{0.1}{1.0} = 0.1 $$\n- **Mutation 6:** $X_6 = -0.3$, $Y_6 = 0.9$.\n  $$ \\phi_6 = \\frac{-(-0.3)}{0.9 - (-0.3)} = \\frac{0.3}{1.2} = \\frac{1}{4} = 0.25 $$\n\nThe folding nucleus is defined based on a $\\phi$-threshold of $\\theta = 0.5$. The residues that constitute the nucleus are those for which $\\phi_i \\ge \\theta$. We evaluate this condition for each residue:\n- $\\phi_1 = 0.2  0.5$\n- $\\phi_2 = 2/3 \\approx 0.667 \\ge 0.5$\n- $\\phi_3 = 0.8 \\ge 0.5$\n- $\\phi_4 = 2/3 \\approx 0.667 \\ge 0.5$\n- $\\phi_5 = 0.1  0.5$\n- $\\phi_6 = 0.25  0.5$\n\nThe set of residues with $\\phi$-values greater than or equal to the threshold is $S = \\{2, 3, 4\\}$.\nThe folding nucleus is the largest connected component of the induced subgraph on this set $S$. The original graph of residue contacts has vertices $V = \\{1, 2, 3, 4, 5, 6\\}$ and edges $E = \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{2,4\\}\\}$.\nThe induced subgraph $G[S]$ contains the vertices $S = \\{2, 3, 4\\}$ and all edges from $E$ that connect pairs of vertices within $S$. We inspect the edge set $E$:\n- The edge $\\{2,3\\}$ connects two vertices in $S$. It is included.\n- The edge $\\{3,4\\}$ connects two vertices in $S$. It is included.\n- The edge $\\{2,4\\}$ connects two vertices in $S$. It is included.\n- All other edges in $E$ have at least one vertex not in $S$ and are therefore excluded.\n\nThe induced subgraph on $S$ consists of the vertices $\\{2, 3, 4\\}$ and the edges $\\{\\{2,3\\}, \\{3,4\\}, \\{2,4\\}\\}$. In this subgraph, every vertex is connected to every other vertex by an edge. Consequently, all three vertices belong to a single connected component.\nThe size of this component is the number of vertices it contains, which is $3$. This is the only component, and thus it is the largest.\nThe size of the folding nucleus is $3$.", "answer": "$$\n\\boxed{3}\n$$", "id": "2765799"}, {"introduction": "While a protein's intrinsic folding pathway is dictated by its amino acid sequence, the cellular environment is crowded and presents many opportunities for misfolding and aggregation. To ensure fidelity, cells employ a suite of molecular chaperones. This exercise provides a quantitative look into the action of Hsp70, a key ATP-dependent chaperone, in preventing aggregation [@problem_id:2765789]. You will build a kinetic model from first principles, integrating the chaperone's nucleotide cycle with client binding dynamics to calculate how effectively Hsp70 can sequester aggregation-prone species and improve the yield of correctly folded proteins.", "problem": "A client polypeptide transiently binds to Heat Shock Protein 70 (Hsp70) during its folding cycle. In each binding cycle, the client experiences two sequential nucleotide states of the chaperone: Adenosine Triphosphate (ATP)-bound followed by Adenosine Diphosphate (ADP)-bound, before release. You measure the mean dwell times of the client while bound to Hsp70 in each state to be $ \\tau_{\\mathrm{ATP}} = 0.60\\,\\text{s}$ and $ \\tau_{\\mathrm{ADP}} = 9.0\\,\\text{s}$, respectively. The free Hsp70 nucleotide cycle is a two-state process, with ATP-to-ADP conversion (hydrolysis) occurring at rate $k_{\\mathrm{hyd}} = 1.20\\,\\text{s}^{-1}$ and ADP-to-ATP nucleotide exchange at rate $k_{\\mathrm{exch}} = 0.30\\,\\text{s}^{-1}$. The total concentration of free Hsp70 is $C_{\\mathrm{tot}} = 5.0\\,\\mu\\text{M}$, and the client association (second-order) rate constant to ATP-bound Hsp70 is $k_{\\mathrm{on}} = 1.0 \\times 10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}$. The unprotected client nucleates aggregation as a Poisson process with baseline rate $k_{\\mathrm{agg}}^{0} = 1.00 \\times 10^{-2}\\,\\text{s}^{-1}$.\n\nAssumptions:\n- The free Hsp70 nucleotide states form a two-state continuous-time Markov chain with steady-state flows determined by the given interconversion rates.\n- Client capture occurs only via ATP-bound Hsp70; thus the instantaneous binding rate per unbound client is $k_{\\mathrm{on}}$ times the steady-state ATP-Hsp70 concentration.\n- Unbound waiting times for client capture are exponentially distributed with mean equal to the reciprocal of the capture rate (Poisson arrivals).\n- Within a binding event, the ATP and ADP phases occur sequentially, so the mean bound duration per event is the sum of the mean ATP and ADP dwell times.\n- Aggregation nucleation is blocked while the client is bound to Hsp70; thus the effective aggregation rate equals the baseline rate multiplied by the long-time fraction that the client is unbound.\n\nStarting from these principles and using only first-principles reasoning (e.g., steady-state balance in two-state Markov chains, mass action for binding, Poisson/exponential waiting time properties, and renewal fraction-of-time arguments), compute the effective aggregation rate under chaperoning, $k_{\\mathrm{agg,eff}}$, for a single client molecule at steady state. Express $k_{\\mathrm{agg,eff}}$ in $\\text{s}^{-1}$ and round your final answer to three significant figures. The final answer must be a single number.", "solution": "The objective is to compute the effective aggregation rate, $k_{\\mathrm{agg,eff}}$, of a client polypeptide under the action of the Hsp70 chaperone system. According to the problem's fifth assumption, aggregation is blocked when the client is bound to Hsp70. The effective aggregation rate is therefore the baseline aggregation rate, $k_{\\mathrm{agg}}^{0}$, modulated by the fraction of time the client is unbound, $P_{\\mathrm{unbound}}$.\n$$k_{\\mathrm{agg,eff}} = k_{\\mathrm{agg}}^{0} \\times P_{\\mathrm{unbound}}$$\nThe client's state alternates between being unbound and bound to Hsp70. This constitutes a renewal process. For such a process, the long-time fraction spent in a particular state is the ratio of the mean duration of that state to the mean total cycle time.\n$$P_{\\mathrm{unbound}} = \\frac{\\langle T_{\\mathrm{unbound}} \\rangle}{\\langle T_{\\mathrm{unbound}} \\rangle + \\langle T_{\\mathrm{bound}} \\rangle}$$\nHere, $\\langle T_{\\mathrm{unbound}} \\rangle$ is the mean time the client is unbound, and $\\langle T_{\\mathrm{bound}} \\rangle$ is the mean time the client is bound to Hsp70 during a single cycle.\n\nFirst, we calculate the mean bound time, $\\langle T_{\\mathrm{bound}} \\rangle$. The problem states that a binding event consists of two sequential phases: an ATP-bound phase and an ADP-bound phase. The mean duration of a complete binding event is the sum of the mean dwell times in each state.\n$$\\langle T_{\\mathrm{bound}} \\rangle = \\tau_{\\mathrm{ATP}} + \\tau_{\\mathrm{ADP}}$$\nUsing the provided values, $\\tau_{\\mathrm{ATP}} = 0.60\\,\\text{s}$ and $\\tau_{\\mathrm{ADP}} = 9.0\\,\\text{s}$:\n$$\\langle T_{\\mathrm{bound}} \\rangle = 0.60\\,\\text{s} + 9.0\\,\\text{s} = 9.6\\,\\text{s}$$\n\nNext, we calculate the mean unbound time, $\\langle T_{\\mathrm{unbound}} \\rangle$. According to the assumptions, the capture of an unbound client is a Poisson process. The mean waiting time for an event in a Poisson process is the reciprocal of its rate. The rate of capture, $\\lambda_{\\text{capture}}$, is given by the law of mass action: it is the product of the second-order association rate constant, $k_{\\mathrm{on}}$, and the concentration of the species available for binding, which is the ATP-bound Hsp70, denoted as $[H_{ATP}]$.\n$$\\langle T_{\\mathrm{unbound}} \\rangle = \\frac{1}{\\lambda_{\\text{capture}}} = \\frac{1}{k_{\\mathrm{on}} [H_{ATP}]}$$\n\nTo find $[H_{ATP}]$, we must determine the steady-state concentrations of the free Hsp70 nucleotide states. The problem describes the free Hsp70 nucleotide cycle as a two-state continuous-time Markov process involving ATP-bound Hsp70 ($H_{ATP}$) and ADP-bound Hsp70 ($H_{ADP}$).\n$$H_{ATP} \\underset{k_{\\mathrm{exch}}}{\\stackrel{k_{\\mathrm{hyd}}}{\\rightleftharpoons}} H_{ADP}$$\nAt steady state, the flux from the ATP state to the ADP state must balance the flux from the ADP state to the ATP state.\n$$k_{\\mathrm{hyd}} [H_{ATP}] = k_{\\mathrm{exch}} [H_{ADP}]$$\nFurthermore, the sum of the concentrations of the two states equals the total concentration of free Hsp70, $C_{\\mathrm{tot}}$.\n$$[H_{ATP}] + [H_{ADP}] = C_{\\mathrm{tot}}$$\nWe can solve this system of two linear equations. From the second equation, we express $[H_{ADP}] = C_{\\mathrm{tot}} - [H_{ATP}]$ and substitute it into the first equation:\n$$k_{\\mathrm{hyd}} [H_{ATP}] = k_{\\mathrm{exch}} (C_{\\mathrm{tot}} - [H_{ATP}])$$\nSolving for $[H_{ATP}]$:\n$$k_{\\mathrm{hyd}} [H_{ATP}] + k_{\\mathrm{exch}} [H_{ATP}] = k_{\\mathrm{exch}} C_{\\mathrm{tot}}$$\n$$[H_{ATP}] (k_{\\mathrm{hyd}} + k_{\\mathrm{exch}}) = k_{\\mathrm{exch}} C_{\\mathrm{tot}}$$\n$$[H_{ATP}] = C_{\\mathrm{tot}} \\frac{k_{\\mathrm{exch}}}{k_{\\mathrm{hyd}} + k_{\\mathrm{exch}}}$$\nNow, we substitute the given numerical values: $C_{\\mathrm{tot}} = 5.0\\,\\mu\\text{M} = 5.0 \\times 10^{-6}\\,\\text{M}$, $k_{\\mathrm{exch}} = 0.30\\,\\text{s}^{-1}$, and $k_{\\mathrm{hyd}} = 1.20\\,\\text{s}^{-1}$.\n$$[H_{ATP}] = (5.0 \\times 10^{-6}\\,\\text{M}) \\frac{0.30\\,\\text{s}^{-1}}{1.20\\,\\text{s}^{-1} + 0.30\\,\\text{s}^{-1}} = (5.0 \\times 10^{-6}\\,\\text{M}) \\frac{0.30}{1.50} = (5.0 \\times 10^{-6}\\,\\text{M}) \\times 0.2 = 1.0 \\times 10^{-6}\\,\\text{M}$$\n\nWith the concentration of ATP-bound Hsp70, we can calculate the capture rate $\\lambda_{\\text{capture}}$ using $k_{\\mathrm{on}} = 1.0 \\times 10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}$.\n$$\\lambda_{\\text{capture}} = k_{\\mathrm{on}} [H_{ATP}] = (1.0 \\times 10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}) \\times (1.0 \\times 10^{-6}\\,\\text{M}) = 1.0\\,\\text{s}^{-1}$$\nThe mean unbound time is the reciprocal of this rate:\n$$\\langle T_{\\mathrm{unbound}} \\rangle = \\frac{1}{\\lambda_{\\text{capture}}} = \\frac{1}{1.0\\,\\text{s}^{-1}} = 1.0\\,\\text{s}$$\n\nNow we have both mean times: $\\langle T_{\\mathrm{unbound}} \\rangle = 1.0\\,\\text{s}$ and $\\langle T_{\\mathrm{bound}} \\rangle = 9.6\\,\\text{s}$. We can compute the fraction of time the client is unbound:\n$$P_{\\mathrm{unbound}} = \\frac{\\langle T_{\\mathrm{unbound}} \\rangle}{\\langle T_{\\mathrm{unbound}} \\rangle + \\langle T_{\\mathrm{bound}} \\rangle} = \\frac{1.0\\,\\text{s}}{1.0\\,\\text{s} + 9.6\\,\\text{s}} = \\frac{1.0}{10.6}$$\n\nFinally, we calculate the effective aggregation rate, $k_{\\mathrm{agg,eff}}$, using the baseline rate $k_{\\mathrm{agg}}^{0} = 1.00 \\times 10^{-2}\\,\\text{s}^{-1}$.\n$$k_{\\mathrm{agg,eff}} = k_{\\mathrm{agg}}^{0} \\times P_{\\mathrm{unbound}} = (1.00 \\times 10^{-2}\\,\\text{s}^{-1}) \\times \\frac{1.0}{10.6} \\approx 9.43396 \\times 10^{-4}\\,\\text{s}^{-1}$$\nRounding the result to three significant figures, we get $9.43 \\times 10^{-4}\\,\\text{s}^{-1}$.", "answer": "$$\\boxed{9.43 \\times 10^{-4}}$$", "id": "2765789"}, {"introduction": "Protein folding does not always occur post-translationally in dilute solution; for many proteins, it begins co-translationally as the nascent polypeptide chain emerges from the ribosome. This intricate coupling between synthesis and folding suggests that translation dynamics can profoundly influence the final folded structure. This advanced practice guides you through the development of a sophisticated computational model to explore this link [@problem_id:2765779]. Using a continuous-time Markov chain framework, you will quantify how synonymous codon choices, which can introduce translational pauses, alter the competition between correct folding and misfolding for a nascent protein domain.", "problem": "You are tasked with quantifying, from first principles, how synonymous codon changes that introduce translational pauses alter the probability that a single protein domain misfolds during its co-translational emergence. Formalize co-translational folding as a continuous-time birth-death process over a one-dimensional reaction coordinate representing the nascent chainâ€™s progression toward either a productive native basin or a non-productive misfolded basin. You must implement a program that computes the misfolding probability for a given elongation-rate profile, and then reports the change in misfolding probability induced by introducing pauses at specified codons.\n\nAssumptions and foundational base:\n- Translation elongation by the ribosome is modeled as a sequence of codon additions. The waiting time to elongate any specific codon is exponentially distributed with rate parameter $r_i$ (units: $\\mathrm{s}^{-1}$) at codon index $i$. This is consistent with a Poissonian elongation mechanism where each step is a memoryless event.\n- Co-translational folding dynamics for the emergent domain at a fixed codon index $i$ are modeled as a continuous-time Markov chain (CTMC) with a tridiagonal birth-death generator $Q_i$ over discrete states $\\{0,1,\\dots,K\\}$, where $0$ is an absorbing native state and $K$ is an absorbing misfolded state. Non-absorbing states are $k \\in \\{1,\\dots,K-1\\}$.\n- For $k \\in \\{1,\\dots,K-1\\}$ at codon index $i$, the birth (toward misfold) and death (toward native) transition rates are denoted $\\lambda_i(k)$ and $\\mu_i(k)$, respectively, both in $\\mathrm{s}^{-1}$. The generator $Q_i$ has entries $[Q_i]_{k,k+1}=\\lambda_i(k)$, $[Q_i]_{k,k-1}=\\mu_i(k)$, $[Q_i]_{k,k}=-(\\lambda_i(k)+\\mu_i(k))$, with $[Q_i]_{0,\\cdot}=\\mathbf{0}$ and $[Q_i]_{K,\\cdot}=\\mathbf{0}$ (absorbing boundaries).\n- The codon-dependent bias in the local energy landscape is represented by a scalar weight $w_i0$ that modulates the forward and reverse rates. The effect of a cytosolic chaperone is represented by a concentration $C$ (units: $\\mu\\mathrm{M}$) that increases the reverse rates $\\mu_i(k)$ according to a linear rescue term.\n\nRate parameterization to be used for all computations:\n- For $k \\in \\{1,\\dots,K-1\\}$ and codon $i$, define base coefficients $a_k$ and $b_k$ by\n  $$\n  a_k \\equiv a_0 \\left(1 + s\\,(k-1)\\right), \\quad b_k \\equiv b_0 \\left(1 + t\\,(K-1-k)\\right),\n  $$\n  with constants $a_0=0.5\\,\\mathrm{s}^{-1}$, $s=0.3$, $b_0=0.8\\,\\mathrm{s}^{-1}$, $t=0.2$.\n- Define the chaperone-rescue scaling as $(1+\\gamma C)$ with $\\gamma=0.06\\,\\mu\\mathrm{M}^{-1}$ and $C$ in $\\mu\\mathrm{M}$.\n- The codon-dependent weight $w_i$ is piecewise:\n  - For $i \\in \\{1,\\dots,24\\}$, set $w_i=0.7$.\n  - For $i \\in \\{25,\\dots,45\\}$, set $w_i=1.8$.\n  - For $i \\in \\{46,\\dots,60\\}$, set $w_i=1.2$.\n- Construct the position-specific rates as\n  $$\n  \\lambda_i(k) = w_i \\, a_k, \\qquad \\mu_i(k) = \\frac{(1+\\gamma C)\\, b_k}{w_i}.\n  $$\n\nElongation-rate profiles:\n- Let the domain length be $L=60$ codons. For each codon $i \\in \\{1,\\dots,L\\}$, the elongation waiting time is exponential with rate $r_i$ (units: $\\mathrm{s}^{-1}$). The baseline profile is constant for a given test case, and the paused profile equals the baseline except in specified windows where $r_i$ is reduced to represent synonymous codon pauses.\n\nFolding trajectory composition:\n- The nascent chain starts at state $k_0=3$ at $i=1$ in all test cases.\n- While the ribosome dwells at codon $i$ for a random time with exponential distribution of rate $r_i$, the CTMC with generator $Q_i$ evolves. After elongation proceeds to codon $i+1$, the generator changes to $Q_{i+1}$. This continues until $i=L$. The native and misfolded states ($0$ and $K$) are absorbing throughout.\n\nObjective:\n- For a given elongation-rate profile $\\{r_i\\}_{i=1}^L$ and chaperone concentration $C$, compute the exact misfolding probability at the end of translation, defined as the probability mass in the absorbing misfolded state $K$ after codon $L$.\n- For each test case, compute two misfolding probabilities: one using the baseline elongation-rate profile and one using the paused profile; report the difference as a float equal to $\\text{paused} - \\text{baseline}$.\n\nFundamental starting point for derivation:\n- Use only the following as starting points: the Central Dogma of Molecular Biology (DNA to RNA to protein), the definition of a continuous-time Markov chain with generator matrix, and the property that exponential waiting times generate memoryless switching of the generator when environments change at random exponential times. You must not assume any pre-derived shortcut formulas beyond these foundations.\n\nTest suite (all with $K=5$, $k_0=3$, $L=60$ codons and $w_i$ as specified above):\n- Case $1$: $C=1.0$. Baseline profile: $r_i=10.0$ for all $i$. Paused profile: $r_i=2.0$ for $i \\in \\{30,31,32,33,34,35\\}$ and $r_i=10.0$ otherwise.\n- Case $2$: $C=5.0$. Baseline profile: $r_i=10.0$ for all $i$. Paused profile: $r_i=2.0$ for $i \\in \\{30,\\dots,45\\}$ and $r_i=10.0$ otherwise.\n- Case $3$: $C=10.0$. Baseline profile: $r_i=10.0$ for all $i$. Paused profile: $r_i=2.0$ for $i \\in \\{30,\\dots,45\\}$ and $r_i=10.0$ otherwise.\n- Case $4$: $C=0.0$. Baseline profile: $r_i=20.0$ for all $i$. Paused profile: $r_i=0.5$ for $i \\in \\{25,\\dots,45\\}$ and $r_i=20.0$ otherwise.\n\nWhat your program must do:\n- Implement the birth-death CTMC with absorbing endpoints as specified.\n- Compose the full co-translational evolution across codons by correctly combining the within-codon dynamics under exponential dwell times and the switching of generators between codons.\n- For each case, compute the misfolding probability for the baseline and paused profiles and output the difference (paused minus baseline) as a float.\n\nAnswer specification and output format:\n- All outputs are dimensionless probabilities. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,x_3,x_4]$), where each $x_j$ is the misfolding probability difference for case $j$, rounded to exactly $6$ decimal places.", "solution": "The problem requires the calculation of the probability of protein misfolding under a co-translational folding model. The model is a continuous-time Markov chain (CTMC) for the folding state, whose governing parameters switch at random, exponentially distributed times corresponding to ribosome elongation steps. The solution must be derived from first principles.\n\nLet the state of the system be described by a probability vector $\\mathbf{p}(t) \\in \\mathbb{R}^{K+1}$, where $p_k(t)$ is the probability of the nascent chain being in folding state $k \\in \\{0, 1, \\dots, K\\}$ at time $t$. The states $k=0$ (native) and $k=K$ (misfolded) are absorbing.\n\nThe evolution of the system is partitioned into intervals corresponding to the ribosome dwelling at each codon $i \\in \\{1, \\dots, L\\}$. During the dwell time at codon $i$, denoted $T_i$, the folding dynamics are governed by a constant generator matrix $Q_i$. The probability vector $\\mathbf{p}(t)$ evolves according to the forward master equation:\n$$\n\\frac{d\\mathbf{p}(t)}{dt} = Q_i^T \\mathbf{p}(t)\n$$\nwhere $Q_i^T$ is the transpose of the generator matrix $Q_i$. The formal solution, given a distribution $\\mathbf{p}_{\\text{start}}$ at the beginning of the interval, is\n$$\n\\mathbf{p}(t) = e^{Q_i^T t} \\mathbf{p}_{\\text{start}}\n$$\n\nThe dwell time $T_i$ is not a fixed value but a random variable following an exponential distribution with rate parameter $r_i$, i.e., $T_i \\sim \\text{Exp}(r_i)$. The probability density function is $f_{T_i}(t) = r_i e^{-r_i t}$ for $t \\ge 0$. To find the probability distribution at the end of this random interval, one must average the solution over all possible values of $t$, weighted by this density.\n\nLet $\\mathbf{p}_i$ be the probability distribution vector at the precise moment the ribosome begins processing codon $i$. The distribution at the start of the subsequent codon, $\\mathbf{p}_{i+1}$, is the expectation of the evolved state over the random dwell time $T_i$:\n$$\n\\mathbf{p}_{i+1} = \\mathbb{E}_{T_i \\sim \\text{Exp}(r_i)} \\left[ e^{Q_i^T T_i} \\mathbf{p}_i \\right]\n$$\nBy the law of the unconscious statistician, this expectation is computed by the integral:\n$$\n\\mathbf{p}_{i+1} = \\int_{0}^{\\infty} \\left( e^{Q_i^T t} \\mathbf{p}_i \\right) (r_i e^{-r_i t}) dt\n$$\nSince $\\mathbf{p}_i$ is a constant with respect to the integration variable $t$, it can be factored out:\n$$\n\\mathbf{p}_{i+1} = \\left( r_i \\int_{0}^{\\infty} e^{-r_i t} e^{Q_i^T t} dt \\right) \\mathbf{p}_i\n$$\nThe integral expression is the definition of the Laplace transform of the matrix exponential $e^{Q_i^T t}$, evaluated at $s=r_i$. The Laplace transform of $e^{At}$ is $(sI - A)^{-1}$. Applying this fundamental property, we obtain:\n$$\n\\int_{0}^{\\infty} e^{-s t} e^{Q_i^T t} dt = (sI - Q_i^T)^{-1}\n$$\nSubstituting $s = r_i$, the update rule for the probability vector becomes:\n$$\n\\mathbf{p}_{i+1} = M_i \\mathbf{p}_i, \\quad \\text{where} \\quad M_i = r_i (r_i I - Q_i^T)^{-1}\n$$\nThe matrix $M_i$ acts as a propagator, mapping the probability distribution from the start of codon $i$ to the start of codon $i+1$.\n\nThe entire process of translation from codon $i=1$ to $i=L$ is a sequence of such propagation steps. The initial condition is given at the start of codon $1$: the nascent chain begins in state $k_0$. This corresponds to an initial probability vector $\\mathbf{p}_1$ where the entry at index $k_0$ is $1$ and all other entries are $0$.\nThe distribution at the start of codon $2$ is $\\mathbf{p}_2 = M_1 \\mathbf{p}_1$.\nThe distribution at the start of codon $3$ is $\\mathbf{p}_3 = M_2 \\mathbf{p}_2 = M_2 M_1 \\mathbf{p}_1$.\nThis iterative process continues for all $L$ codons. The final probability distribution, after the dwell time at codon $L$ has elapsed, is given by:\n$$\n\\mathbf{p}_{\\text{final}} = M_L M_{L-1} \\cdots M_2 M_1 \\mathbf{p}_1\n$$\nThe probability of misfolding is the component of this final vector corresponding to the absorbing misfolded state $K$. Let our states be indexed $\\{0, 1, \\dots, K\\}$. Then the misfolding probability $P_{\\text{misfold}}$ is the element of $\\mathbf{p}_{\\text{final}}$ at index $K$:\n$$\nP_{\\text{misfold}} = [\\mathbf{p}_{\\text{final}}]_K\n$$\n\nThe algorithm for the computation proceeds as follows:\n1.  Initialize constants as per the problem statement: $K=5$, $k_0=3$, $L=60$, and the biophysical parameters $a_0$, $s$, $b_0$, $t$, $\\gamma$.\n2.  Pre-compute the state-dependent but codon-independent rate coefficients $a_k$ and $b_k$ for $k \\in \\{1, \\dots, K-1\\}$.\n3.  For each test case (defined by a chaperone concentration $C$ and two elongation profiles, `baseline` and `paused`), execute the following computational loop twice, once for each profile.\n4.  For a given profile, initialize the probability vector $\\mathbf{p}$ of size $(K+1)$ with a $1$ at index $k_0=3$ and $0$ elsewhere.\n5.  Iterate through codons $i$ from $1$ to $L$. In each iteration:\n    a. Determine the codon-dependent weight $w_i$ and the elongation rate $r_i$ from the profile.\n    b. Calculate the folding rates $\\lambda_i(k) = w_i a_k$ and $\\mu_i(k) = (1+\\gamma C) b_k / w_i$.\n    c. Construct the $(K+1) \\times (K+1)$ generator matrix $Q_i$ for a birth-death process on states $\\{1, \\dots, K-1\\}$ with absorbing boundaries at $0$ and $K$. The non-zero off-diagonal elements are $[Q_i]_{k, k+1} = \\lambda_i(k)$ and $[Q_i]_{k, k-1} = \\mu_i(k)$ for states $k$ that are not boundaries. The diagonal elements are $[Q_i]_{k,k} = -(\\sum_{j \\ne k} Q_{k,j})$. The rows for states $0$ and $K$ are zero.\n    d. Compute the propagator matrix $M_i = r_i (r_i I - Q_i^T)^{-1}$ using numerical linear algebra, specifically matrix inversion.\n    e. Update the probability vector: $\\mathbf{p} \\leftarrow M_i \\mathbf{p}$.\n6.  After iterating through all $L$ codons, the final vector $\\mathbf{p}$ is obtained. The misfolding probability is the element $\\mathbf{p}[K]$.\n7.  After computing the misfolding probability for both `baseline` ($P_{\\text{base}}$) and `paused` ($P_{\\text{paused}}$) profiles, calculate the difference $\\Delta P = P_{\\text{paused}} - P_{\\text{base}}$.\n8.  The final output is a list of these differences for all test cases.\n\nThis procedure constitutes a complete and exact solution to the problem as formulated. It is derived directly from the definition of a continuous-time Markov chain and the properties of the exponential distribution, as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import inv\n\ndef solve():\n    \"\"\"\n    Computes the change in misfolding probability due to translational pauses\n    based on a co-translational folding model.\n    \"\"\"\n    \n    # Define problem constants and parameters\n    K = 5\n    k0 = 3\n    L = 60\n    a0 = 0.5\n    s = 0.3\n    b0 = 0.8\n    t = 0.2\n    gamma = 0.06\n\n    # Pre-calculate state-dependent but codon-independent rate coefficients\n    # k runs from 1 to K-1=4\n    k_vals = np.arange(1, K)\n    a_k_base = a0 * (1 + s * (k_vals - 1))\n    b_k_base = b0 * (1 + t * (K - 1 - k_vals))\n\n    def get_w(i):\n        \"\"\"Returns the codon-dependent weight w_i for codon i.\"\"\"\n        if 1 = i = 24:\n            return 0.7\n        elif 25 = i = 45:\n            return 1.8\n        elif 46 = i = 60:\n            return 1.2\n        else:\n            # This case should not be reached with L=60\n            raise ValueError(\"Codon index out of bounds\")\n\n    def calculate_misfolding_prob(C, r_profile):\n        \"\"\"\n        Calculates the final misfolding probability for a given chaperone\n        concentration and elongation rate profile.\n        \"\"\"\n        # Initialize probability vector p, with the system starting in state k0\n        p = np.zeros(K + 1)\n        p[k0] = 1.0\n\n        # Calculate chaperone rescue factor\n        chaperone_factor = 1 + gamma * C\n\n        # Iterate through all codons from 1 to L\n        for i in range(1, L + 1):\n            wi = get_w(i)\n            ri = r_profile[i - 1] # r_profile is 0-indexed\n\n            # Calculate position-specific rates lambda_i(k), mu_i(k)\n            # These are for k in {1, ..., K-1}\n            lambda_i = wi * a_k_base\n            mu_i = (chaperone_factor * b_k_base) / wi\n\n            # Build the generator matrix Q_i of size (K+1)x(K+1)\n            Q = np.zeros((K + 1, K + 1))\n            \n            # Populate Q for intermediate states k=1 to K-1 (indices 1 to 4)\n            for k_idx, k in enumerate(range(1, K)):\n                lam = lambda_i[k_idx]\n                mu = mu_i[k_idx]\n                \n                Q[k, k + 1] = lam  # Transition k - k+1\n                Q[k, k - 1] = mu   # Transition k - k-1\n                Q[k, k] = -(lam + mu) # Total rate out of k\n\n            # Propagator matrix M_i = r_i * inv(r_i * I - Q_i^T)\n            I = np.identity(K + 1)\n            Q_T = Q.T\n            M = ri * inv(ri * I - Q_T)\n\n            # Update probability vector: p_{i+1} = M_i * p_i\n            p = M @ p\n        \n        # Final misfolding probability is the probability in the last state, K\n        misfolding_prob = p[K]\n        return misfolding_prob\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1\n        {\"C\": 1.0, \"r_base_val\": 10.0, \"r_paused_val\": 2.0, \"pause_window\": (30, 35)},\n        # Case 2\n        {\"C\": 5.0, \"r_base_val\": 10.0, \"r_paused_val\": 2.0, \"pause_window\": (30, 45)},\n        # Case 3\n        {\"C\": 10.0, \"r_base_val\": 10.0, \"r_paused_val\": 2.0, \"pause_window\": (30, 45)},\n        # Case 4\n        {\"C\": 0.0, \"r_base_val\": 20.0, \"r_paused_val\": 0.5, \"pause_window\": (25, 45)},\n    ]\n\n    results = []\n    for case in test_cases:\n        C = case[\"C\"]\n        r_base_val = case[\"r_base_val\"]\n        r_paused_val = case[\"r_paused_val\"]\n        start, end = case[\"pause_window\"]\n        \n        # Create baseline and paused elongation rate profiles\n        r_base_profile = np.full(L, r_base_val)\n        \n        r_paused_profile = np.full(L, r_base_val)\n        # Apply pause (note: 1-based index from problem to 0-based Python slicing)\n        r_paused_profile[start - 1 : end] = r_paused_val\n\n        # Calculate misfolding probability for both profiles\n        prob_base = calculate_misfolding_prob(C, r_base_profile)\n        prob_paused = calculate_misfolding_prob(C, r_paused_profile)\n        \n        # The result is the difference: paused - baseline\n        diff = prob_paused - prob_base\n        results.append(diff)\n\n    # Format the final output string as specified\n    output_str = \",\".join([f\"{res:.6f}\" for res in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "2765779"}]}