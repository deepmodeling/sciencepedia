{"hands_on_practices": [{"introduction": "Modern synthetic biology relies on a toolkit of precisely controllable genetic parts. This first practice focuses on deriving the quantitative behavior of one of the most powerful tools for gene repression: CRISPR interference (CRISPRi). By applying the principles of mass-action kinetics, you will model the interaction between a dCas9:gRNA complex and its target promoter to derive the system's input-output relationship, also known as its transfer function [@problem_id:2535726]. This exercise is fundamental to understanding how to quantitatively predict and engineer gene repression in synthetic circuits.", "problem": "A deoxyribonuclease-dead clustered regularly interspaced short palindromic repeats interference (CRISPRi) repression module uses a catalytically inactive CRISPR-associated protein 9 ($\\mathrm{dCas9}$) loaded with a guide ribonucleic acid (gRNA) to bind a target promoter and block transcription initiation. Consider a promoter that can exist in two states: unbound, denoted by $P$, and bound by the $\\mathrm{dCas9}$:gRNA complex, denoted by $P^{\\ast}$. Let $g$ denote the free gRNA concentration and $d$ denote the free $\\mathrm{dCas9}$ concentration. Assume that promoter copies are dilute so that $g$ and $d$ are not appreciably depleted by promoter binding.\n\nModel the effective binding of the two-component repressor to the promoter as a single rapid-equilibrium step with a lumped dissociation constant $K$ defined by the mass-action relation\n$$\nK \\equiv \\frac{[P]\\,[d]\\,[g]}{[P^{\\ast}]}\\,,\n$$\nwhich coarse-grains the rapid pre-equilibrium loading of gRNA onto $\\mathrm{dCas9}$ together with promoter binding into one effective step. Assume that transcription is fully blocked when the promoter is in state $P^{\\ast}$ and proceeds at its unrepressed maximal rate when the promoter is in state $P$.\n\nDefine the normalized input-output relation $y(g,d)$ as the steady-state transcriptional output divided by the unrepressed maximal rate, which under these assumptions equals the equilibrium probability that the promoter is unbound. Using only the law of mass action, the definition of $K$ above, and the conservation of promoter states, derive a closed-form analytic expression for $y(g,d)$ as a function of $g$, $d$, and $K$. Express your final answer as a single simplified analytic expression. No numerical evaluation is required, and no units are needed because $y$ is dimensionless by definition.", "solution": "The problem statement is first subjected to critical validation.\n\n**Step 1: Extract Givens**\n- The system involves a promoter with two states: unbound ($P$) and dCas9:gRNA-bound ($P^{\\ast}$).\n- The free gRNA concentration is denoted by $g$.\n- The free dCas9 concentration is denoted by $d$.\n- Assumption: The concentrations $g$ and $d$ are not significantly depleted by binding to the promoter.\n- An effective, lumped dissociation constant $K$ is defined by the mass-action relation: $K \\equiv \\frac{[P]\\,[d]\\,[g]}{[P^{\\ast}]}$. In the problem's notation, this is $K = \\frac{[P]\\,d\\,g}{[P^{\\ast}]}$.\n- Condition: Transcription is fully blocked from state $P^{\\ast}$.\n- Condition: Transcription proceeds at the maximal unrepressed rate from state $P$.\n- Definition: The normalized input-output relation, $y(g,d)$, is the ratio of the steady-state transcriptional output to the maximal unrepressed rate.\n- Equivalence: $y(g,d)$ is equal to the equilibrium probability that the promoter is in the unbound state, $P$.\n- Objective: Derive a closed-form analytic expression for $y(g,d)$ as a function of $g$, $d$, and $K$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the established criteria.\n- **Scientifically Grounded:** The problem describes a simplified, but standard and fundamentally correct, model of CRISPRi-based gene repression. This coarse-graining of a multi-step binding process into a single effective equilibrium is a common and valid approach in quantitative biology for creating tractable models. The model is based on the law of mass action, a fundamental principle of chemical kinetics.\n- **Well-Posed:** The problem is clearly stated, with all necessary definitions, assumptions, and constraints provided to derive a unique analytical solution.\n- **Objective:** The language is technical, precise, and free of subjective or non-scientific content.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed exercise in applying the principles of chemical equilibrium to a biological system. A solution will be derived.\n\n**Derivation of the Solution**\nThe objective is to find the normalized input-output relation $y(g,d)$. The problem states that this quantity is equivalent to the equilibrium probability of the promoter being in its unbound state, $P$.\n\nLet $P_{total}$ be the total concentration of the promoter. The conservation of promoter states dictates that the total concentration is the sum of the concentrations of all possible states. In this system, there are only two states, $P$ and $P^{\\ast}$. Therefore, we have the conservation equation:\n$$\n[P_{total}] = [P] + [P^{\\ast}]\n$$\nThe probability that a promoter is unbound is the fraction of the total promoter population that is in the state $P$. At equilibrium, this probability is given by:\n$$\ny(g,d) = \\frac{[P]}{[P_{total}]} = \\frac{[P]}{[P] + [P^{\\ast}]}\n$$\nThis expression currently contains the concentration terms $[P]$ and $[P^{\\ast}]$. To fulfill the problem requirements, we must express $y(g,d)$ solely in terms of the input concentrations $g$ and $d$, and the constant $K$. We use the provided definition of the lumped dissociation constant $K$:\n$$\nK = \\frac{[P]\\,d\\,g}{[P^{\\ast}]}\n$$\nFrom this relation, we can express the concentration of the bound promoter, $[P^{\\ast}]$, as a function of the unbound promoter concentration, $[P]$, and the other system parameters:\n$$\n[P^{\\ast}] = \\frac{[P]\\,d\\,g}{K}\n$$\nNow, we substitute this expression for $[P^{\\ast}]$ into our equation for $y(g,d)$:\n$$\ny(g,d) = \\frac{[P]}{[P] + \\frac{[P]\\,d\\,g}{K}}\n$$\nWe can factor the term $[P]$ from the denominator:\n$$\ny(g,d) = \\frac{[P]}{[P]\\left(1 + \\frac{d\\,g}{K}\\right)}\n$$\nThe concentration of the unbound promoter, $[P]$, is a non-zero quantity (unless repression is absolute and total, a singular case), and thus it can be cancelled from the numerator and the denominator. This cancellation is a critical step, as it removes the dependence on the absolute promoter concentrations, yielding a general transfer function.\nThe resulting simplified expression for the normalized output is:\n$$\ny(g,d) = \\frac{1}{1 + \\frac{d\\,g}{K}}\n$$\nThis is the final, closed-form analytic expression for the normalized transcriptional output as a function of the free gRNA concentration $g$, the free dCas9 concentration $d$, and the lumped dissociation constant $K$. It correctly describes the repressive action, where $y \\to 1$ as $d\\,g \\to 0$ (no repression) and $y \\to 0$ as $d\\,g \\to \\infty$ (saturating repression). The expression is dimensionless, as required.", "answer": "$$\n\\boxed{\\frac{1}{1 + \\frac{dg}{K}}}\n$$", "id": "2535726"}, {"introduction": "Synthetic genetic circuits are not isolated from their host cell's physiology; they must compete for a finite pool of cellular resources, such as RNA polymerases and ribosomes. This resource competition can lead to unexpected \"crosstalk\" where one genetic component's activity affects another's, even without a direct regulatory link. In this exercise, you will use mass-action binding and conservation laws to model and quantify how upregulating one promoter affects the output of another by sequestering a shared, limited pool of RNA polymerase [@problem_id:2535637]. Mastering this concept is essential for designing robust circuits that perform reliably as the system's complexity grows.", "problem": "Two Escherichia coli promoters, each recognized by the same sigma factor (sigma factor $\\sigma^{70}$), compete for a single limiting pool of RNA polymerase holoenzyme. Assume rapid binding equilibrium between promoters and the holoenzyme and that transcription initiation is limited by promoter occupancy (i.e., the initiation rate at a given promoter is proportional to its occupancy by holoenzyme). The binding of holoenzyme to each promoter follows a simple one-to-one reversible binding with a common dissociation constant $K_{d}$. The total holoenzyme concentration is fixed and denoted $R_{T}$. Let the total concentrations of available promoter binding sites for promoter $1$ and promoter $2$ be $S_{1,T}$ and $S_{2,T}$, respectively. Let $R$ denote the free holoenzyme concentration at steady state, which is set by conservation of mass among free and promoter-bound states. Prior to any perturbation, the parameters are:\n- $R_{T} = 0.20\\,\\mu\\mathrm{M}$,\n- $K_{d} = 0.050\\,\\mu\\mathrm{M}$ for both promoters,\n- $S_{1,T} = 0.10\\,\\mu\\mathrm{M}$,\n- $S_{2,T} = 0.10\\,\\mu\\mathrm{M}$.\n\nAn intervention upregulates promoter $2$ twofold by doubling its available site concentration (e.g., a copy-number increase) to $S_{2,T}' = 0.20\\,\\mu\\mathrm{M}$, while $K_{d}$ and $R_{T}$ remain unchanged and promoter $1$ is unmodified.\n\nUsing only the assumptions above and starting from first principles of mass-action binding and conservation of mass, determine the expected fractional reduction (expressed as a dimensionless decimal) in the transcription rate of promoter $1$ caused by the twofold upregulation of promoter $2$. Round your answer to four significant figures and report it as a unitless number.", "solution": "We model competition for a limiting RNA polymerase holoenzyme pool under rapid equilibrium. The fundamental base is:\n- Mass-action binding for a one-to-one reversible interaction: for a promoter class $i$ with total site concentration $S_{i,T}$ and free holoenzyme concentration $R$, the concentration of promoter–holoenzyme complex is $C_{i} = S_{i,T}\\,\\theta_{i}$ with occupancy fraction $\\theta_{i} = \\dfrac{R}{K_{d} + R}$.\n- Conservation of mass for the holoenzyme: $R_{T} = R + \\sum_{i} C_{i}$.\n- Transcription initiation is initiation-limited and proportional to promoter occupancy, so the transcription rate for promoter $i$ is $r_{i} \\propto S_{i,T}\\,\\theta_{i}$. For fixed $S_{1,T}$, the ratio of promoter $1$’s rates before and after a perturbation is the ratio of its occupancy fractions, since $S_{1,T}$ and the catalytic factor cancel.\n\nDefine $R$ as the free holoenzyme concentration at steady state. With two promoter classes, conservation of mass gives\n$$\nR_{T} \\;=\\; R \\;+\\; S_{1,T}\\,\\frac{R}{K_{d}+R} \\;+\\; S_{2,T}\\,\\frac{R}{K_{d}+R}\n\\;=\\; R \\;+\\; \\left(S_{1,T}+S_{2,T}\\right)\\frac{R}{K_{d}+R}.\n$$\nLet $S_{\\mathrm{tot}} = S_{1,T} + S_{2,T}$. Then\n$$\nR_{T}(K_{d}+R) \\;=\\; R(K_{d}+R) \\;+\\; S_{\\mathrm{tot}}\\,R,\n$$\nwhich rearranges to a quadratic in $R$:\n$$\nR^{2} \\;+\\; \\left(S_{\\mathrm{tot}} + K_{d} - R_{T}\\right) R \\;-\\; R_{T}K_{d} \\;=\\; 0.\n$$\nThe physically relevant (positive) root is\n$$\nR \\;=\\; \\frac{-\\left(S_{\\mathrm{tot}}+K_{d}-R_{T}\\right) + \\sqrt{\\left(S_{\\mathrm{tot}}+K_{d}-R_{T}\\right)^{2} + 4 R_{T}K_{d}}}{2}.\n$$\n\nBefore upregulation, $S_{\\mathrm{tot}}^{\\mathrm{(before)}} = S_{1,T} + S_{2,T} = 0.10\\,\\mu\\mathrm{M} + 0.10\\,\\mu\\mathrm{M} = 0.20\\,\\mu\\mathrm{M}$. With $R_{T} = 0.20\\,\\mu\\mathrm{M}$ and $K_{d} = 0.050\\,\\mu\\mathrm{M}$,\n$$\nS_{\\mathrm{tot}}+K_{d}-R_{T} \\;=\\; 0.20 + 0.050 - 0.20 \\;=\\; 0.050\\,\\mu\\mathrm{M},\n$$\n$$\n4 R_{T}K_{d} \\;=\\; 4 \\times 0.20 \\times 0.050 \\;=\\; 0.040\\,\\mu\\mathrm{M}^{2},\n$$\n$$\n\\sqrt{\\left(0.050\\right)^{2} + 0.040} \\;=\\; \\sqrt{0.0025 + 0.0400} \\;=\\; \\sqrt{0.0425} \\;\\approx\\; 0.20615528\\,\\mu\\mathrm{M}.\n$$\nThus\n$$\nR_{\\mathrm{before}} \\;=\\; \\frac{-0.050 + 0.20615528}{2} \\;\\approx\\; 0.07807764\\,\\mu\\mathrm{M}.\n$$\nPromoter $1$’s occupancy fraction before is\n$$\n\\theta_{1,\\mathrm{before}} \\;=\\; \\frac{R_{\\mathrm{before}}}{K_{d} + R_{\\mathrm{before}}}\n\\;=\\; \\frac{0.07807764}{0.050 + 0.07807764}\n\\;=\\; 1 - \\frac{0.050}{0.12807764}\n\\;\\approx\\; 0.60961175.\n$$\n\nAfter upregulation, $S_{2,T}$ doubles to $S_{2,T}' = 0.20\\,\\mu\\mathrm{M}$, so $S_{\\mathrm{tot}}^{\\mathrm{(after)}} = S_{1,T} + S_{2,T}' = 0.10 + 0.20 = 0.30\\,\\mu\\mathrm{M}$. Then\n$$\nS_{\\mathrm{tot}}+K_{d}-R_{T} \\;=\\; 0.30 + 0.050 - 0.20 \\;=\\; 0.150\\,\\mu\\mathrm{M},\n$$\n$$\n\\sqrt{\\left(0.150\\right)^{2} + 0.040} \\;=\\; \\sqrt{0.0225 + 0.0400} \\;=\\; \\sqrt{0.0625} \\;=\\; 0.250\\,\\mu\\mathrm{M},\n$$\nso\n$$\nR_{\\mathrm{after}} \\;=\\; \\frac{-0.150 + 0.250}{2} \\;=\\; 0.050\\,\\mu\\mathrm{M}.\n$$\nPromoter $1$’s occupancy fraction after is\n$$\n\\theta_{1,\\mathrm{after}} \\;=\\; \\frac{R_{\\mathrm{after}}}{K_{d} + R_{\\mathrm{after}}}\n\\;=\\; \\frac{0.050}{0.050 + 0.050}\n\\;=\\; 0.50000000.\n$$\n\nBecause the transcription rate of promoter $1$ is proportional to $S_{1,T}\\,\\theta_{1}$ with $S_{1,T}$ unchanged, the fold-change in promoter $1$’s transcription is\n$$\n\\frac{r_{1,\\mathrm{after}}}{r_{1,\\mathrm{before}}} \\;=\\; \\frac{\\theta_{1,\\mathrm{after}}}{\\theta_{1,\\mathrm{before}}}\n\\;=\\; \\frac{0.50000000}{0.60961175}\n\\;\\approx\\; 0.8201942.\n$$\nTherefore, the fractional reduction (decrease relative to the original) is\n$$\n\\Delta \\;=\\; 1 \\;-\\; \\frac{r_{1,\\mathrm{after}}}{r_{1,\\mathrm{before}}}\n\\;\\approx\\; 1 - 0.8201942\n\\;=\\; 0.1798058.\n$$\nRounded to four significant figures (unitless), the expected fractional reduction is $0.1798$.", "answer": "$$\\boxed{0.1798}$$", "id": "2535637"}, {"introduction": "A central challenge in synthetic biology is connecting theoretical models with experimental reality. This final practice bridges that gap by tasking you with estimating a model's kinetic parameters from mock experimental data [@problem_id:2535689]. You will fit the analytical solution of a two-state kinetic model, representing a toehold switch, to time-series fluorescence data using nonlinear least squares. This computational exercise simulates the crucial process of model validation and parameterization, a fundamental skill for any quantitative biologist aiming to engineer predictable biological systems.", "problem": "You are given time-resolved fluorescence measurements from a toehold switch reporter that transitions between an inactive state (OFF) and an active state (ON) in response to an RNA trigger at a fixed concentration. Assume a two-state, mass-action kinetic model with pseudo-first-order activation due to excess trigger. Let the fraction of switches in the ON state be denoted by $p_{\\mathrm{on}}(t)$. The switching kinetics follow the differential equation\n$$\\frac{dp_{\\mathrm{on}}}{dt} = k_{\\mathrm{on}} [T]\\,(1 - p_{\\mathrm{on}}) - k_{\\mathrm{off}}\\,p_{\\mathrm{on}},$$\nwhere $k_{\\mathrm{on}}$ is the bimolecular on-rate constant, $k_{\\mathrm{off}}$ is the unimolecular off-rate constant, and $[T]$ is the constant trigger concentration. The initial condition at trigger addition is $p_{\\mathrm{on}}(0) = 0$. The measurable fluorescence $F(t)$ is assumed to be an affine function of $p_{\\mathrm{on}}(t)$,\n$$F(t) = F_{\\min} + \\left(F_{\\max} - F_{\\min}\\right)\\,p_{\\mathrm{on}}(t),$$\nwhere $F_{\\min}$ and $F_{\\max}$ are known instrument-specific values. The fundamental base for modeling is chemical kinetics under the law of mass action and the assumption of pseudo-first-order activation due to excess trigger.\n\nYour task is to estimate $k_{\\mathrm{on}}$ and $k_{\\mathrm{off}}$ by nonlinear least squares for each provided dataset, using only the above model. Use time in minutes and concentration in nanomolar. Report $k_{\\mathrm{on}}$ in $\\mathrm{nM}^{-1}\\,\\mathrm{min}^{-1}$ and $k_{\\mathrm{off}}$ in $\\mathrm{min}^{-1}$, each rounded to six decimal places. Angles are not involved. Do not introduce additional parameters or alternative models.\n\nTest suite:\n- Case A (general identifiable regime):\n  - $[T] = 10\\,\\mathrm{nM}$, $F_{\\min} = 100\\,\\mathrm{a.u.}$, $F_{\\max} = 1000\\,\\mathrm{a.u.}$.\n  - Time points in minutes: $[\\,0,\\,10,\\,20,\\,30,\\,40,\\,50,\\,60\\,]$.\n  - Measured fluorescence $F(t)$ in arbitrary units (a.u.): $[\\,100.0,\\,852.18020434,\\,944.28950558,\\,955.57294524,\\,956.95011372,\\,957.11966984,\\,957.13998175\\,]$.\n- Case B (boundary with negligible deactivation):\n  - $[T] = 5\\,\\mathrm{nM}$, $F_{\\min} = 50\\,\\mathrm{a.u.}$, $F_{\\max} = 800\\,\\mathrm{a.u.}$.\n  - Time points in minutes: $[\\,0,\\,5,\\,10,\\,20,\\,40\\,]$.\n  - Measured fluorescence $F(t)$ in a.u.: $[\\,50.0,\\,585.12140235,\\,738.43625103,\\,794.94653975,\\,799.96595005\\,]$.\n- Case C (fast deactivation relative to activation):\n  - $[T] = 2\\,\\mathrm{nM}$, $F_{\\min} = 200\\,\\mathrm{a.u.}$, $F_{\\max} = 700\\,\\mathrm{a.u.}$.\n  - Time points in minutes: $[\\,0,\\,10,\\,20,\\,30,\\,60\\,]$.\n  - Measured fluorescence $F(t)$ in a.u.: $[\\,200.0,\\,271.91638517,\\,307.62900515,\\,325.36336754,\\,340.71491760\\,]$.\n\nYour program must:\n- For each case, fit $k_{\\mathrm{on}} \\ge 0$ and $k_{\\mathrm{off}} \\ge 0$ by minimizing the sum of squared residuals between measured $F(t)$ and the model-predicted $F(t)$ implied by the kinetic equation and the fluorescence mapping.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case contributes a two-element list $[k_{\\mathrm{on}},k_{\\mathrm{off}}]$, in order A, B, C. For example: $[[k_{\\mathrm{on,A}},k_{\\mathrm{off,A}}],[k_{\\mathrm{on,B}},k_{\\mathrm{off,B}}],[k_{\\mathrm{on,C}},k_{\\mathrm{off,C}}]]$.\n- Round each reported parameter to six decimal places.\n\nAll parameter values are to be expressed in their specified units. The final line must be printed with no additional text.", "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and complete. We shall proceed with the derivation and solution.\n\nThe core of the problem lies in determining the kinetic rate constants, $k_{\\mathrm{on}}$ and $k_{\\mathrm{off}}$, from time-series data. The system is described by a first-order ordinary differential equation (ODE) for the fraction of toehold switches in the ON state, $p_{\\mathrm{on}}(t)$:\n$$\n\\frac{dp_{\\mathrm{on}}}{dt} = k_{\\mathrm{on}} [T]\\,(1 - p_{\\mathrm{on}}) - k_{\\mathrm{off}}\\,p_{\\mathrm{on}}\n$$\nThis equation is formulated under the law of mass action, with the assumption of pseudo-first-order activation kinetics due to a constant and excess concentration of the trigger molecule, $[T]$. The initial condition is given as $p_{\\mathrm{on}}(0) = 0$.\n\nFirst, we must find the analytical solution to this ODE. The equation is a linear first-order ODE, which can be rearranged into the standard form $\\frac{dy}{dt} + P(t)y = Q(t)$.\n$$\n\\frac{dp_{\\mathrm{on}}}{dt} + (k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})p_{\\mathrm{on}} = k_{\\mathrm{on}}[T]\n$$\nHere, the integrating factor is $I(t) = \\exp\\left(\\int (k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}) dt\\right) = e^{(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t}$. Multiplying the ODE by $I(t)$ yields:\n$$\n\\frac{d}{dt}\\left(p_{\\mathrm{on}} e^{(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t}\\right) = k_{\\mathrm{on}}[T] e^{(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t}\n$$\nIntegrating both sides with respect to time $t$ gives:\n$$\np_{\\mathrm{on}}(t) e^{(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t} = \\frac{k_{\\mathrm{on}}[T]}{k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}} e^{(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t} + C\n$$\nwhere $C$ is the constant of integration. Dividing by the exponential term, we obtain the general solution for $p_{\\mathrm{on}}(t)$:\n$$\np_{\\mathrm{on}}(t) = \\frac{k_{\\mathrm{on}}[T]}{k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}} + C e^{-(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t}\n$$\nThe constant $C$ is determined by the initial condition $p_{\\mathrm{on}}(0) = 0$:\n$$\n0 = \\frac{k_{\\mathrm{on}}[T]}{k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}} + C \\implies C = -\\frac{k_{\\mathrm{on}}[T]}{k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}}\n$$\nSubstituting $C$ back into the solution, we arrive at the specific solution for $p_{\\mathrm{on}}(t)$:\n$$\np_{\\mathrm{on}}(t) = \\frac{k_{\\mathrm{on}}[T]}{k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}} \\left( 1 - e^{-(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t} \\right)\n$$\nThis equation describes the time evolution of the fraction of active switches as a function of the unknown parameters $k_{\\mathrm{on}}$ and $k_{\\mathrm{off}}$.\n\nThe measured signal is the fluorescence $F(t)$, which is related to $p_{\\mathrm{on}}(t)$ by the provided affine transformation:\n$$\nF(t) = F_{\\min} + (F_{\\max} - F_{\\min}) p_{\\mathrm{on}}(t)\n$$\nBy substituting the expression for $p_{\\mathrm{on}}(t)$, we obtain the complete model function for fluorescence, which we must fit to the data:\n$$\nF(t; k_{\\mathrm{on}}, k_{\\mathrm{off}}) = F_{\\min} + (F_{\\max} - F_{\\min}) \\left( \\frac{k_{\\mathrm{on}}[T]}{k_{\\mathrm{on}}[T] + k_{\\mathrm{off}}} \\right) \\left( 1 - e^{-(k_{\\mathrm{on}}[T] + k_{\\mathrm{off}})t} \\right)\n$$\nOur task is to estimate $k_{\\mathrm{on}}$ and $k_{\\mathrm{off}}$ for each dataset. This is a parameter estimation problem, which we will solve using the method of nonlinear least squares. The objective is to find the parameter values that minimize the sum of squared residuals (SSR) between the measured fluorescence values, $F_{\\mathrm{data}}(t_i)$, and the values predicted by our model, $F(t_i; k_{\\mathrm{on}}, k_{\\mathrm{off}})$:\n$$\n\\text{SSR}(k_{\\mathrm{on}}, k_{\\mathrm{off}}) = \\sum_{i} \\left( F_{\\mathrm{data}}(t_i) - F(t_i; k_{\\mathrm{on}}, k_{\\mathrm{off}}) \\right)^2\n$$\nThe summation is performed over all measured time points $t_i$. The optimization must be performed under the physical constraints $k_{\\mathrm{on}} \\ge 0$ and $k_{\\mathrm{off}} \\ge 0$.\n\nFor the numerical implementation, we will use the `curve_fit` function from the `scipy.optimize` library. This function is designed for curve fitting and implements a robust Levenberg-Marquardt algorithm (or Trust Region Reflective when bounds are provided). For each of the three test cases, we will:\n1.  Define the model function $F(t; k_{\\mathrm{on}}, k_{\\mathrm{off}})$ using the known values of $[T]$, $F_{\\min}$, and $F_{\\max}$ for that case.\n2.  Provide the experimental data $(t_i, F_{\\mathrm{data}}(t_i))$.\n3.  Call `curve_fit` with an initial guess for the parameters and the non-negativity bounds.\n4.  The function will return the optimal values for $k_{\\mathrm{on}}$ and $k_{\\mathrm{off}}$.\n5.  These resulting parameters will be rounded to six decimal places, as required, and formatted into the final output structure.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves for the kinetic parameters k_on and k_off for three test cases\n    by fitting a kinetic model to fluorescence data using nonlinear least squares.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"T\": 10.0,\n            \"F_min\": 100.0,\n            \"F_max\": 1000.0,\n            \"t_data\": np.array([0., 10., 20., 30., 40., 50., 60.]),\n            \"F_data\": np.array([100.0, 852.18020434, 944.28950558, 955.57294524, 956.95011372, 957.11966984, 957.13998175]),\n        },\n        {\n            \"name\": \"Case B\",\n            \"T\": 5.0,\n            \"F_min\": 50.0,\n            \"F_max\": 800.0,\n            \"t_data\": np.array([0., 5., 10., 20., 40.]),\n            \"F_data\": np.array([50.0, 585.12140235, 738.43625103, 794.94653975, 799.96595005]),\n        },\n        {\n            \"name\": \"Case C\",\n            \"T\": 2.0,\n            \"F_min\": 200.0,\n            \"F_max\": 700.0,\n            \"t_data\": np.array([0., 10., 20., 30., 60.]),\n            \"F_data\": np.array([200.0, 271.91638517, 307.62900515, 325.36336754, 340.71491760]),\n        },\n    ]\n\n    def model_fluorescence(t, k_on, k_off, T, F_min, F_max):\n        \"\"\"\n        Analytical solution for the fluorescence F(t).\n        F(t) = F_min + (F_max - F_min) * p_on(t)\n        p_on(t) = (k_on*[T])/(k_on*[T]+k_off) * (1 - exp(-(k_on*[T]+k_off)*t))\n        \"\"\"\n        # To avoid division by zero or invalid values if k_on[T] + k_off is zero.\n        # Given the constraints and data, this is unlikely.\n        k_obs = k_on * T + k_off\n        if k_obs == 0:\n            # This corresponds to no reaction. p_on(t) would be 0.\n            p_on_inf = 0.0\n        else:\n            p_on_inf = (k_on * T) / k_obs\n        \n        p_on_t = p_on_inf * (1 - np.exp(-k_obs * t))\n        \n        return F_min + (F_max - F_min) * p_on_t\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        F_min = case[\"F_min\"]\n        F_max = case[\"F_max\"]\n        t_data = case[\"t_data\"]\n        F_data = case[\"F_data\"]\n\n        # The function to be fitted by curve_fit. It must have the signature f(x, ...params).\n        # We use a lambda function to pass the fixed parameters T, F_min, F_max.\n        fit_func = lambda t, k_on, k_off: model_fluorescence(t, k_on, k_off, T, F_min, F_max)\n        \n        # Initial guess for the parameters [k_on, k_off]\n        p0 = [0.1, 0.1]\n        \n        # Bounds for the parameters: k_on = 0, k_off = 0\n        bounds = ([0, 0], [np.inf, np.inf])\n\n        # Perform the nonlinear least squares fit\n        popt, _ = curve_fit(fit_func, t_data, F_data, p0=p0, bounds=bounds)\n        \n        k_on_fit, k_off_fit = popt\n        \n        # Round the results to six decimal places\n        k_on_rounded = round(k_on_fit, 6)\n        k_off_rounded = round(k_off_fit, 6)\n        \n        results.append([k_on_rounded, k_off_rounded])\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2535689"}]}