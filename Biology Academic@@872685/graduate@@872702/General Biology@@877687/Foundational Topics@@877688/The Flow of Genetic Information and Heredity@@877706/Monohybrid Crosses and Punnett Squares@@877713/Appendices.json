{"hands_on_practices": [{"introduction": "The Punnett square is a foundational heuristic in genetics, but at its core, it is a visual representation of fundamental probability theory. This first exercise moves beyond the grid, challenging you to derive the classic $1:2:1$ genotypic ratio from a monohybrid cross using only the first principles of probability. By formalizing the random union of gametes as a matrix of joint probabilities [@problem_id:2819168], you will reinforce the mathematical underpinnings of Mendelian inheritance and develop a more rigorous framework for genetic analysis.", "problem": "Consider a single autosomal locus with alleles $A$ and $a$ in a diploid organism. Two heterozygous parents mate, so the parental genotypes are $Aa \\times Aa$. Assume classical Mendelian conditions: the Law of Segregation holds so that each heterozygous parent transmits each allele with equal probability, there is random union of gametes, and there is no segregation distortion or differential viability among gametes or zygotes. Using only these fundamental principles together with the addition and multiplication rules of probability, proceed as follows without drawing a Punnett grid: \n\n(1) Define random variables for the maternal and paternal gametic alleles, each taking values in $\\{A,a\\}$. From first principles, formalize the joint distribution of gametic alleles as a $2 \\times 2$ probability matrix whose rows correspond to the paternal gamete allele and whose columns correspond to the maternal gamete allele. \n\n(2) Using that matrix and the definition of genotype as the unordered pair of alleles at this locus, derive the exact values of $P(AA)$, $P(Aa)$, and $P(aa)$ for the offspring. \n\nReport your final answer as a single row matrix $(P(AA),\\,P(Aa),\\,P(aa))$ with entries given as exact fractions. Do not round.", "solution": "**Solution Derivation**\n\nLet $M$ be the random variable representing the allele contributed by the maternal gamete, and let $P$ be the random variable representing the allele contributed by the paternal gamete. Both parents are heterozygous with genotype $Aa$. The sample space for both random variables is the set of alleles, $\\{A, a\\}$.\n\nAccording to the Law of Segregation as stated, a heterozygous parent transmits each of its two alleles with equal probability.\nFor the maternal parent ($Aa$), the probabilities of the alleles in her gametes are:\n$P(M = A) = \\frac{1}{2}$\n$P(M = a) = \\frac{1}{2}$\n\nSimilarly, for the paternal parent ($Aa$), the probabilities of the alleles in his gametes are:\n$P(P = A) = \\frac{1}{2}$\n$P(P = a) = \\frac{1}{2}$\n\n**Part (1): Joint Distribution of Gametic Alleles**\nThe problem states there is a random union of gametes. In probabilistic terms, this means that the choice of the maternal allele and the choice of the paternal allele are independent events. The joint probability of a specific paternal allele and a specific maternal allele combining is given by the multiplication rule for independent events:\n$P(P=i, M=j) = P(P=i) \\times P(M=j)$ for any alleles $i, j \\in \\{A, a\\}$.\n\nWe can now construct the $2 \\times 2$ joint probability matrix, where rows represent the paternal allele and columns represent the maternal allele.\n\nThe entry in row $i$ and column $j$ is $P(P=i, M=j)$.\n-   $P(P=A, M=A) = P(P=A) \\times P(M=A) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$. This is the probability that the offspring receives an $A$ allele from the father and an $A$ allele from the mother.\n-   $P(P=A, M=a) = P(P=A) \\times P(M=a) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$. This is the probability that the offspring receives an $A$ allele from the father and an $a$ allele from the mother.\n-   $P(P=a, M=A) = P(P=a) \\times P(M=A) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$. This is the probability that the offspring receives an $a$ allele from the father and an $A$ allele from the mother.\n-   $P(P=a, M=a) = P(P=a) \\times P(M=a) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$. This is the probability that the offspring receives an $a$ allele from the father and an $a$ allele from the mother.\n\nThe resulting joint probability matrix is:\n$$\n\\begin{array}{c|cc}\n  & M=A & M=a \\\\\n\\hline\nP=A & \\frac{1}{4} & \\frac{1}{4} \\\\\nP=a & \\frac{1}{4} & \\frac{1}{4}\n\\end{array}\n$$\n\n**Part (2): Derivation of Offspring Genotype Probabilities**\nThe genotype of the offspring is the unordered pair of alleles inherited from the parents. We use the joint probability matrix and the addition rule of probability for mutually exclusive events to find the probabilities of the three possible genotypes: $AA$, $Aa$, and $aa$.\n\n-   **Probability of genotype $AA$**:\n    The homozygous dominant genotype $AA$ can only be formed in one way: by inheriting an $A$ allele from the father and an $A$ allele from the mother. This corresponds to the single outcome $(P=A, M=A)$.\n    $$P(AA) = P(P=A, M=A) = \\frac{1}{4}$$\n\n-   **Probability of genotype $aa$**:\n    The homozygous recessive genotype $aa$ can also only be formed in one way: by inheriting an $a$ allele from the father and an $a$ allele from the mother. This corresponds to the single outcome $(P=a, M=a)$.\n    $$P(aa) = P(P=a, M=a) = \\frac{1}{4}$$\n\n-   **Probability of genotype $Aa$**:\n    The heterozygous genotype $Aa$ is formed if the offspring inherits one $A$ allele and one $a$ allele. This can happen in two mutually exclusive ways:\n    1.  The offspring inherits $A$ from the father and $a$ from the mother. This is the event $(P=A, M=a)$.\n    2.  The offspring inherits $a$ from the father and $A$ from the mother. This is the event $(P=a, M=A)$.\n\n    Since these are mutually exclusive events, the total probability of forming a heterozygous genotype is the sum of their individual probabilities (addition rule):\n    $$P(Aa) = P(P=A, M=a) + P(P=a, M=A)$$\n    Using the values from our matrix:\n    $$P(Aa) = \\frac{1}{4} + \\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2}$$\n\nThe probabilities of the offspring genotypes are $P(AA) = \\frac{1}{4}$, $P(Aa) = \\frac{1}{2}$, and $P(aa) = \\frac{1}{4}$. As a necessary check, the sum of these probabilities must be $1$: $\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4} = 1$. The calculation is consistent. The final result is the ordered triplet of these probabilities.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{2} & \\frac{1}{4}\n\\end{pmatrix}\n}\n$$", "id": "2819168"}, {"introduction": "Building upon the probabilities for a single offspring, genetic analysis often requires predicting outcomes for entire families or populations. This practice extends the principles of single-event probability to multiple independent events—the births of $n$ successive offspring. You will employ the complement rule, a powerful tool in probability, to calculate the likelihood of observing at least one individual with a specific genotype [@problem_id:2819164]. This exercise is crucial for understanding statistical predictions in genetics and forms a basis for designing and interpreting experimental crosses.", "problem": "A diploid organism has a single autosomal locus with two alleles, denoted $A$ and $a$. The allele $A$ is completely dominant to $a$ (complete dominance affects phenotype but not genotype frequencies under Mendelian inheritance). Two heterozygous individuals, each of genotype $Aa$, mate to produce $n$ independent offspring. Assume Mendel’s law of segregation holds exactly, meiosis produces gametes with equal allele frequencies in each $Aa$ parent, fertilization is random, and successive fertilization events are independent, with no transmission distortion, no viability selection, and no inbreeding.\n\nUsing only the foundational principles stated (Mendel’s law of segregation, random union of gametes, and independence of successive fertilizations) and Punnett square reasoning to justify single-offspring genotype probabilities, derive from first principles a closed-form analytic expression, in terms of $n$, for the probability that among the $n$ offspring at least one is homozygous recessive (genotype $aa$).\n\nExpress your final result as a single exact expression in terms of $n$. Do not approximate or round, and do not use percentages.", "solution": "The problem requires the derivation of a probability concerning the genotypes of offspring from a specific monohybrid cross. We begin by establishing the fundamental probabilities for a single offspring.\n\nThe parents are both heterozygous, with genotype $Aa$. According to Mendel’s Law of Segregation, during gamete formation (meiosis), the $2$ alleles at a locus segregate from each other, so that each gamete receives only $1$ of the $2$ alleles. The problem specifies that gametes are produced with equal allele frequencies. Therefore, for each $Aa$ parent, the probability of producing a gamete carrying the $A$ allele is $P(A) = \\frac{1}{2}$, and the probability of producing a gamete carrying the $a$ allele is $P(a) = \\frac{1}{2}$.\n\nThe genotypes of the offspring are determined by the random union of these parental gametes. We can represent all possible combinations using a Punnett square for the cross $Aa \\times Aa$:\n\n$$\n\\begin{array}{c|cc}\n & \\text{Parent 2 Gamete } A & \\text{Parent 2 Gamete } a \\\\\n & (P = \\frac{1}{2}) & (P = \\frac{1}{2}) \\\\\n\\hline\n\\text{Parent 1 Gamete } A & AA & Aa \\\\\n (P = \\frac{1}{2}) & (P = \\frac{1}{4}) & (P = \\frac{1}{4}) \\\\\n\\text{Parent 1 Gamete } a & Aa & aa \\\\\n(P = \\frac{1}{2}) & (P = \\frac{1}{4}) & (P = \\frac{1}{4}) \\\\\n\\end{array}\n$$\n\nThe assumption of random fertilization implies that the probability of a particular offspring genotype is the product of the probabilities of the gametes that form it. From the Punnett square, we derive the probabilities for the $3$ possible genotypes for any single offspring:\n1.  Homozygous dominant ($AA$): $P(AA) = P(A) \\times P(A) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n2.  Heterozygous ($Aa$): $P(Aa) = (P(A) \\times P(a)) + (P(a) \\times P(A)) = (\\frac{1}{2} \\times \\frac{1}{2}) + (\\frac{1}{2} \\times \\frac{1}{2}) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$.\n3.  Homozygous recessive ($aa$): $P(aa) = P(a) \\times P(a) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n\nThe sum of these probabilities is $\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4} = 1$, as required for a complete probability distribution. The information about complete dominance of $A$ over $a$ pertains to the phenotype, which would be the same for genotypes $AA$ and $Aa$, but is not relevant for calculating genotype frequencies, which is the core of the problem.\n\nThe problem asks for the probability that *at least one* of the $n$ offspring has the genotype $aa$. Let this event be denoted by $E$. Calculating this probability directly involves summing the probabilities of exactly $1$ offspring being $aa$, exactly $2$ offspring being $aa$, and so on, up to all $n$ offspring being $aa$. This is a cumbersome application of the binomial distribution.\n\nA more direct and logical approach is to consider the complementary event, denoted $E^c$. The complement of \"at least one offspring is $aa$\" is \"no offspring are $aa$\". By the fundamental axiom of probability, $P(E) = 1 - P(E^c)$.\n\nLet us first determine the probability that a single, randomly chosen offspring is *not* of genotype $aa$. This is the sum of the probabilities of the other possible genotypes:\n$$P(\\text{not } aa) = P(AA) + P(Aa) = \\frac{1}{4} + \\frac{1}{2} = \\frac{3}{4}$$\nAlternatively, and more simply:\n$$P(\\text{not } aa) = 1 - P(aa) = 1 - \\frac{1}{4} = \\frac{3}{4}$$\n\nThe problem states that the $n$ offspring are independent events. This means that the genotype of one offspring does not influence the genotype of another. Therefore, the probability that *all* $n$ offspring are not of genotype $aa$ is the product of the individual probabilities for each offspring.\n$$P(E^c) = P(\\text{1st is not } aa \\text{ AND 2nd is not } aa \\text{ AND } \\dots \\text{ AND } n\\text{-th is not } aa)$$\nDue to independence, this becomes:\n$$P(E^c) = \\prod_{i=1}^{n} P(\\text{i-th is not } aa) = \\left( P(\\text{not } aa) \\right)^n = \\left(\\frac{3}{4}\\right)^n$$\n\nFinally, we can find the probability of the original event $E$ (at least one $aa$ offspring) by subtracting the probability of its complement from $1$:\n$$P(\\text{at least one } aa) = P(E) = 1 - P(E^c) = 1 - \\left(\\frac{3}{4}\\right)^n$$\n\nThis is the closed-form analytic expression for the desired probability, derived strictly from the first principles of Mendelian genetics and probability theory as requested. The expression is a function of $n$, the number of offspring.", "answer": "$$\\boxed{1 - \\left(\\frac{3}{4}\\right)^n}$$", "id": "2819164"}, {"introduction": "The predictive power of Mendelian genetics lies in its logical, rule-based structure, which lends itself perfectly to computational modeling. This final hands-on practice challenges you to translate the biological processes of gamete segregation and random fertilization into a precise computer algorithm. By programming a tool that generates a Punnett square and calculates offspring genotype frequencies, you will solidify your understanding through formalization [@problem_id:2819142]. This exercise bridges the gap between theoretical genetics and bioinformatics, demonstrating how abstract principles can be transformed into powerful predictive models.", "problem": "Implement a program that constructs a Punnett square for any bi-allelic monohybrid cross directly from two parental genotypes, and validates the resulting offspring genotype distribution against expected values for a small test suite. Your design must start from the following fundamental principles and definitions: (i) Mendel’s law of segregation, which states that in a heterozygous diploid parent the two alleles segregate such that each gamete receives exactly one allele with equal probability; (ii) random union of gametes at fertilization; (iii) a genotype is an ordered pair of alleles at a single locus, here restricted to a single letter with uppercase denoting the dominant allele and its lowercase counterpart denoting the recessive allele; (iv) a monohybrid cross involves exactly one locus with two alleles. From these, derive a general algorithm that generates a $2 \\times 2$ Punnett square as the Cartesian product of the two parents’ gamete sets and uses the square to compute genotype probabilities.\n\nConstraints and assumptions:\n- Input representation: Each parental genotype is provided as a string of length $2$ over a single letter with case indicating allele state, for example \"AA\", \"Aa\", \"aA\", \"aa\", \"Bb\". Both characters of a genotype must be the same letter ignoring case; the two parents must refer to the same letter ignoring case.\n- Gamete formation: Under Mendel’s law of segregation, a homozygote produces two identical gametes (both the same allele), and a heterozygote produces two different gametes, each with probability $1/2$.\n- Punnett square construction: Always form a $2 \\times 2$ square using the two gametes from the first parent as row headers and the two gametes from the second parent as column headers. Fill each cell by combining the row and column allele into an offspring genotype and canonicalizing it by placing the uppercase allele (if present) first, e.g., \"Aa\" not \"aA\".\n- Probability model: Because each row and each column is selected with probability $1/2$, every cell in the $2 \\times 2$ grid has probability $1/4$. The genotype distribution is the relative frequency of each genotype class: homozygous dominant ($DD$), heterozygous ($DR$), homozygous recessive ($RR$), where $D$ denotes the uppercase allele letter and $R$ its lowercase counterpart.\n- Validation: For each test case, compare the computed distribution against the expected distribution using an absolute tolerance of $10^{-9}$ for each component.\n\nTasks for your program:\n1. Implement a routine that, given two parental genotypes, constructs the $2 \\times 2$ Punnett square and computes the offspring genotype probability distribution as a list of three floating-point numbers in the order $[P(DD), P(DR), P(RR)]$.\n2. Validate the routine on the following test suite, where each case is given as (parent$1$, parent$2$, expected $[P(DD), P(DR), P(RR)]$):\n   - (\"AA\", \"aa\", [$0$, $1$, $0$])\n   - (\"Aa\", \"Aa\", [$0.25$, $0.5$, $0.25$])\n   - (\"Aa\", \"aa\", [$0$, $0.5$, $0.5$])\n   - (\"Aa\", \"AA\", [$0.5$, $0.5$, $0$])\n   - (\"aa\", \"aa\", [$0$, $0$, $1$])\n   - (\"aA\", \"Aa\", [$0.25$, $0.5$, $0.25$])  // order-insensitivity check\n   - (\"Bb\", \"Bb\", [$0.25$, $0.5$, $0.25$])  // non-\"A/a\" allele letter check\n3. Your program should produce a single line of output containing the validation results as a comma-separated list enclosed in square brackets, with one boolean per test case in the same order as above, for example: \"[True,True,False]\" if three tests were run.\n\nAdditional requirements:\n- The program must not request user input and must not read from or write to files.\n- All numeric comparisons for floats must use an absolute tolerance of $10^{-9}$.\n- There are no physical units in this problem.\n- The final output must be exactly one line in the specified format.", "solution": "**Derivation of the Algorithm**\n\nThe task is to construct a computational model for a bi-allelic monohybrid cross. This will be developed systematically from the given principles.\n\n**1. Gamete Formation from Parental Genotypes**\nA parental genotype, denoted `$G_p$`, is a string of length `$2$`, consisting of two alleles, `$a_1$` and `$a_2$`. Per the problem statement, a parent produces two gametes for the construction of the `$2 \\times 2$` Punnett square. These two gametes are simply the two alleles composing the genotype.\nLet `$G_{p1}$` and `$G_{p2}$` be the genotypes of parent `$1$` and parent `$2$`, respectively.\n- The gamete set for parent `$1$`, `$S_1$`, is `{`$G_{p1}[0], G_{p1}[1]$`}`.\n- The gamete set for parent `$2$`, `$S_2$`, is `{`$G_{p2}[0], G_{p2}[1]$`}`.\n\nFor a heterozygous parent such as \"Aa\", the gamete set is `{`'A', 'a'`}`. For a homozygous parent such as \"AA\", the gamete set is `{`'A', 'A'`}`, which we must treat as two distinct entities for the purpose of constructing the square.\n\n**2. Punnett Square as a Cartesian Product**\nThe Punnett square represents all possible combinations of gametes from the two parents. This is formally the Cartesian product of the two gamete sets, `$S_1 \\times S_2$`. The result is a set of `$2 \\times 2 = 4$` offspring genotypes.\nLet `$g_{1,i} \\in S_1$` and `$g_{2,j} \\in S_2$`, where `$i, j \\in \\{1, 2\\}$`. Each cell of the Punnett square contains a resulting offspring genotype formed by the union of one gamete from each parent, `{`$g_{1,i}, g_{2,j}$`}`.\n\n**3. Canonicalization of Offspring Genotypes**\nThe problem mandates a canonical representation for genotypes: the dominant (uppercase) allele must appear first. For any two alleles `$a_i, a_j$` forming an offspring, the genotype string `$G_o$` is constructed by sorting them such that `str.islower` is the secondary sort key (or equivalently, `str.isupper` is the primary key).\nFor example, if the gametes are 'a' and 'A', the combination `('a', 'A')` is canonicalized to the string \"Aa\". The combination `('B', 'b')` is canonicalized to \"Bb\".\n\n**4. Probability Calculation**\nThe law of segregation implies that for a heterozygous parent, each of the two different alleles is passed to a gamete with probability `$1/2$`. For a homozygous parent, the single allele type is passed with probability `$1$`. The problem simplifies this by stating that each of the two gametes (even if identical) from a parent's set `$S_p$` is selected with probability `$1/2$`.\nGiven the principle of random union, the probability of any specific combination of gametes `$g_{1,i}$` and `$g_{2,j}$` is the product of their individual probabilities: `$P(g_{1,i} \\text{ and } g_{2,j}) = P(g_{1,i}) \\times P(g_{2,j}) = (1/2) \\times (1/2) = 1/4$`.\nThis confirms the given premise: each of the `$4$` cells in the Punnett square represents an outcome with a probability of `$1/4$`.\n\nTo find the probability of a genotype class (e.g., homozygous dominant, `$DD$`), we must sum the probabilities of all outcomes corresponding to that class. Let `$C(G_o)$` be the count of occurrences of a canonicalized genotype `$G_o$` in the `$4$` cells of the square. The probability of that genotype is:\n`$$P(G_o) = \\frac{C(G_o)}{4}$$`\n\nThe final probability distribution is a list of three values: `$[P(DD), P(DR), P(RR)]$`. The specific allele letter (`A`, `B`, etc.) must be identified from the input genotypes. Let the letter be `$L$`. Then `$D = L.upper()` and `$R = L.lower()`. The three required probabilities are `$P(DD), P(DR), P(rr)$`.\n\n**Algorithmic Synthesis**\nThe complete algorithm is as follows:\n\n1.  **Input**: Two parental genotype strings, `$G_{p1}$` and `$G_{p2}$`.\n2.  **Identify Alleles**: Determine the dominant (`$D$`) and recessive (`$R$`) allele characters from an input genotype, for example, `$D = G_{p1}[0].upper()`, `$R = G_{p1}[0].lower()`.\n3.  **Define Genotype Classes**: Construct the string representations for the three genotype classes: `$G_{DD} = D+D$`, `$G_{DR} = D+R$`, `$G_{RR} = R+R$`.\n4.  **Generate Gametes**: Extract the gametes for each parent: `$S_1 = list(G_{p1})$`, `$S_2 = list(G_{p2})$`.\n5.  **Initialize Counters**: Create counters for each genotype class, initialized to zero: `$C_{DD} = 0, C_{DR} = 0, C_{RR} = 0$`.\n6.  **Iterate and Classify**: Loop through all `$4$` combinations of gametes `$(g_1, g_2)$` where `$g_1 \\in S_1$` and `$g_2 \\in S_2$`.\n    a. For each pair `$(g_1, g_2)$`, form the canonical offspring genotype string `$G_o` by sorting the alleles.\n    b. Compare `$G_o$` to the class strings and increment the corresponding counter. If `$G_o = G_{DD}$`, increment `$C_{DD}$`. If `$G_o = G_{DR}$`, increment `$C_{DR}$`. Otherwise, increment `$C_{RR}$`.\n7.  **Calculate Probabilities**: Compute the final probabilities by dividing each count by `$4.0$`:\n    - `$P(DD) = C_{DD} / 4.0$`\n    - `$P(DR) = C_{DR} / 4.0$`\n    - `$P(RR) = C_{RR} / 4.0$`\n8.  **Output**: Return the list `$[P(DD), P(DR), P(RR)]$`.\n\nThis algorithm is a direct translation of the problem's specified first principles into a deterministic computational procedure. It will be implemented to validate the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef punnett_square_probabilities(parent1_genotype: str, parent2_genotype: str) -> list[float]:\n    \"\"\"\n    Computes offspring genotype probabilities from a bi-allelic monohybrid cross.\n\n    This function implements the principles of Mendelian genetics to derive the\n    probability distribution for offspring genotypes from two parental genotypes.\n\n    Args:\n        parent1_genotype: A string of length 2 representing the first parent's genotype (e.g., \"Aa\").\n        parent2_genotype: A string of length 2 representing the second parent's genotype (e.g., \"aa\").\n\n    Returns:\n        A list of three floats representing the probabilities of homozygous dominant (DD),\n        heterozygous (DR), and homozygous recessive (RR) offspring, in that order.\n    \"\"\"\n    # Principle 1: Gamete Formation\n    # Each parent contributes two gametes, which are the two alleles in its genotype.\n    gametes1 = list(parent1_genotype)\n    gametes2 = list(parent2_genotype)\n\n    # From the genotypes, determine the dominant (D) and recessive (R) allele characters.\n    # We can use the first allele of the first parent, as all alleles for a given\n    # cross must be the same letter.\n    allele_char = parent1_genotype[0]\n    dominant_allele = allele_char.upper()\n    recessive_allele = allele_char.lower()\n\n    # Define the canonical string representations for the three genotype classes.\n    homozygous_dominant_str = dominant_allele + dominant_allele\n    heterozygous_str = dominant_allele + recessive_allele\n    homozygous_recessive_str = recessive_allele + recessive_allele\n\n    # Initialize counters for each of the 4 possible offspring genotypes in the Punnett square.\n    offspring_genotype_counts = {\n        homozygous_dominant_str: 0,\n        heterozygous_str: 0,\n        homozygous_recessive_str: 0\n    }\n\n    # Principle 2 & 3: Punnett Square Construction and Canonicalization\n    # The Punnett square is the Cartesian product of the gamete sets. We iterate through it.\n    for gamete1 in gametes1:\n        for gamete2 in gametes2:\n            # Combine gametes to form an offspring's alleles.\n            offspring_alleles = [gamete1, gamete2]\n            \n            # Canonicalize the genotype string: dominant allele (uppercase) must be first.\n            # sorted() with a key is a clean way to enforce this rule.\n            # str.islower returns True for lowercase, False for uppercase.\n            # Sorting by this value (False=0, True=1) places uppercase letters first.\n            canonical_genotype = \"\".join(sorted(offspring_alleles, key=str.islower))\n            \n            # Increment the counter for the resulting genotype class.\n            if canonical_genotype in offspring_genotype_counts:\n                offspring_genotype_counts[canonical_genotype] += 1\n\n    # Principle 4: Probability Calculation\n    # Each of the 4 cells in the Punnett square has a probability of 1/4.\n    # The probability of a genotype is its count divided by the total number of cells (4).\n    total_outcomes = 4.0\n    prob_dd = offspring_genotype_counts[homozygous_dominant_str] / total_outcomes\n    prob_dr = offspring_genotype_counts[heterozygous_str] / total_outcomes\n    prob_rr = offspring_genotype_counts[homozygous_recessive_str] / total_outcomes\n    \n    return [prob_dd, prob_dr, prob_rr]\n\ndef solve():\n    \"\"\"\n    Runs the validation of the Punnett square routine against the specified test suite.\n    \"\"\"\n    # The test suite provided in the problem statement.\n    # Format: (parent1_genotype, parent2_genotype, expected_probabilities)\n    test_cases = [\n        (\"AA\", \"aa\", [0.0, 1.0, 0.0]),\n        (\"Aa\", \"Aa\", [0.25, 0.5, 0.25]),\n        (\"Aa\", \"aa\", [0.0, 0.5, 0.5]),\n        (\"Aa\", \"AA\", [0.5, 0.5, 0.0]),\n        (\"aa\", \"aa\", [0.0, 0.0, 1.0]),\n        (\"aA\", \"Aa\", [0.25, 0.5, 0.25]),  # Order-insensitivity check\n        (\"Bb\", \"Bb\", [0.25, 0.5, 0.25]),  # Non-\"A/a\" allele letter check\n    ]\n\n    validation_results = []\n    \n    # Absolute tolerance for floating-point comparisons.\n    tolerance = 1e-9\n\n    for case in test_cases:\n        parent1, parent2, expected = case\n        \n        # Calculate the probabilities using the derived function.\n        calculated = punnett_square_probabilities(parent1, parent2)\n        \n        # Validate the calculated distribution against the expected distribution.\n        # np.allclose is used for robust floating-point array comparison.\n        # rtol=0 ensures the comparison is based purely on the absolute tolerance (atol).\n        is_valid = np.allclose(calculated, expected, rtol=0, atol=tolerance)\n        validation_results.append(is_valid)\n\n    # Final print statement must produce the exact required format.\n    print(f\"[{','.join(map(str, validation_results))}]\")\n\nsolve()\n\n```", "id": "2819142"}]}