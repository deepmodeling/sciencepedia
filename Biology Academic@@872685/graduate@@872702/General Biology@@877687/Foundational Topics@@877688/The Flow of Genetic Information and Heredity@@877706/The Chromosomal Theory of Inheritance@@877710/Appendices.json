{"hands_on_practices": [{"introduction": "The power of meiosis lies in its ability to generate immense genetic diversity. This diversity arises from two core mechanisms: the independent assortment of non-homologous chromosomes and the process of crossing over between homologous chromosomes. This foundational exercise [@problem_id:2318044] challenges you to integrate these principles, calculating the total number of unique allelic combinations an individual can produce in its gametes. Mastering this skill is the first step toward a quantitative understanding of the outcomes of meiosis.", "problem": "A hypothetical species of insect has a diploid chromosome number of $2n=8$. A geneticist is studying the inheritance patterns of five genes that control distinct phenotypes: eye color (Gene A/a), wing shape (Gene B/b), antenna length (Gene C/c), body pigmentation (Gene D/d), and bristle type (Gene E/e).\n\nThrough gene mapping, it has been determined that genes A, B, and C are located on three different non-homologous autosomes (specifically, Gene A on chromosome 1, Gene B on chromosome 2, and Gene C on chromosome 3). Genes D and E are located on chromosome 4, meaning they are linked.\n\nAn individual insect is captured that is heterozygous for all five genes. Its genotype for the unlinked genes is `Aa Bb Cc`. For the linked genes on chromosome 4, one homolog carries the alleles `D` and `E`, while the other homolog carries the alleles `d` and `e`. It is known that meiotic crossing over can and does occur between the loci of genes D and E in this species.\n\nCalculate the total number of unique gametes, in terms of their allelic composition for these five genes, that this individual insect can produce.", "solution": "The problem asks for the total number of unique types of gametes an individual can produce, based on the alleles of five specific genes. To solve this, we must consider the principles of independent assortment for the unlinked genes and the effects of linkage and crossing over for the linked genes. The final answer will be the product of the number of possible combinations from each of these independent meiotic events.\n\nFirst, let's analyze the unlinked genes: A, B, and C. These genes are located on three different pairs of homologous chromosomes (chromosomes 1, 2, and 3). According to the law of independent assortment, the orientation of each homologous pair at the metaphase plate during meiosis I is random and independent of the others. This means that the alleles for genes on different chromosomes will segregate into gametes independently of one another.\n\nThe individual is heterozygous for each of these genes, with the genotype `Aa Bb Cc`.\n- For Gene A, the gametes can receive either the `A` allele or the `a` allele. This gives 2 possibilities.\n- For Gene B, the gametes can receive either the `B` allele or the `b` allele. This gives 2 possibilities.\n- For Gene C, the gametes can receive either the `C` allele or the `c` allele. This gives 2 possibilities.\n\nThe total number of unique allelic combinations for these three unlinked genes is the product of the possibilities for each gene.\nNumber of combinations for A, B, and C = $2 \\times 2 \\times 2 = 2^3 = 8$.\n\nNext, let's analyze the linked genes: D and E. These genes are located on the same chromosome (chromosome 4). The problem states that one homologous chromosome carries the `D` and `E` alleles, and the other carries the `d` and `e` alleles. This is known as a coupling or cis configuration.\n\nDuring meiosis, these linked alleles can be passed on to gametes in two ways:\n1.  **Without crossing over:** If no crossover event occurs between the loci of gene D and gene E, the alleles on each parental chromosome will be inherited as a single unit. This produces two types of gametes, known as parental or non-recombinant gametes. The allelic combinations are `DE` and `de`.\n2.  **With crossing over:** The problem states that crossing over can occur between the D and E loci. When a single crossover event happens between these two genes on a pair of homologous chromatids, the alleles are exchanged. This process creates two new combinations of alleles that were not present on the parental chromosomes. These are known as recombinant gametes. The allelic combinations are `De` and `dE`.\n\nTherefore, considering both scenarios (no crossover and crossover), the pair of homologous chromosomes carrying genes D and E can produce a total of four unique allelic combinations in the gametes: `DE` (parental), `de` (parental), `De` (recombinant), and `dE` (recombinant).\n\nFinally, to find the total number of genetically distinct gametes for all five genes, we use the product rule. The assortment of the gene group on chromosome 4 is independent of the assortment of chromosomes 1, 2, and 3. We multiply the number of allelic combinations from the unlinked genes by the number of allelic combinations from the linked gene group.\n\nTotal unique gamete types = (Number of combinations for genes A, B, C) $\\times$ (Number of combinations for genes D, E)\nTotal unique gamete types = $8 \\times 4 = 32$.\n\nThus, the insect can produce 32 genetically distinct types of gametes.", "answer": "$$\\boxed{32}$$", "id": "2318044"}, {"introduction": "A key insight of the Chromosomal Theory is that the frequency of recombination between linked genes is proportional to their physical distance. This principle allows us to construct genetic maps, a cornerstone of classical and modern genetics. This practice [@problem_id:2842661] takes you from raw experimental data—progeny counts from a testcross—to a calculated map distance, demanding not just a calculation but a first-principles derivation of the recombination fraction ($r$). It emphasizes the critical statistical and biological assumptions that bridge the gap between observed data and the abstract concept of a genetic map.", "problem": "In a $2$-point testcross in a dipteran species, a female heterozygote for markers $A$ and $B$ on the same autosome ($A B / a b$) is crossed to a double-recessive male ($a b / a b$). According to the chromosomal theory of inheritance, recombinant progeny classes in such a testcross directly reflect recombinant gametes from the heterozygous parent. Among $n = 1000$ scored adult progeny, $x = 180$ are classified as recombinant for $A$ and $B$ (i.e., they carry one of the two recombinant haplotypes). \n\nUsing only core definitions and well-established facts about meiotic recombination and testcrosses (without invoking any unprovided shortcut formulas), do the following:\n\n1. From first principles, derive the maximum-likelihood estimator for the recombination fraction $r$ based on counts of recombinant and nonrecombinant progeny in this testcross, and compute its value for the given data.\n2. Under the conventional short-interval interpretation that relates recombination fraction to map distance along a chromosome, compute the genetic map distance between $A$ and $B$ in centimorgans (cM).\n\nExpress $r$ as a unitless decimal fraction and the genetic map distance in centimorgans (cM). Round both quantities to three significant figures.\n\nFinally, briefly articulate the biological and statistical assumptions that are required to justify converting a recombination fraction obtained from a $2$-point testcross into a linear map distance in centimorgans in this context. Your final numeric answer must contain only the two requested values in the order $(r,\\ \\text{map distance in cM})$ and will be graded separately from your discussion.", "solution": "The problem requires a derivation of the maximum-likelihood estimator (MLE) for the recombination fraction, $r$, from first principles, followed by a calculation of the genetic map distance.\n\n1. Derivation and Calculation of the Recombination Fraction, $r$\n\nA testcross involves crossing a heterozygous individual ($A B / a b$) to a homozygous recessive individual ($a b / a b$). The phenotype of the progeny is determined solely by the gamete contributed by the heterozygous parent, as the recessive parent only contributes the $ab$ haplotype, which does not mask the alleles from the other gamete.\n\nLet $r$ be the recombination fraction, which is the probability that a random gamete from the heterozygous parent is a recombinant type (either $A b$ or $a B$). Consequently, the probability that a random gamete is a parental, non-recombinant type (either $A B$ or $a b$) is $1-r$.\n\nIn a sample of $n$ progeny, each observation is an independent Bernoulli trial, where the outcome is either \"recombinant\" with probability $r$ or \"non-recombinant\" with probability $1-r$. The number of recombinant progeny, $x$, in a total of $n$ progeny therefore follows a binomial distribution. The probability of observing exactly $x$ recombinants in $n$ trials is given by the probability mass function:\n$$P(X=x | n, r) = \\binom{n}{x} r^{x} (1-r)^{n-x}$$\n\nThe likelihood function, $L(r)$, is this probability viewed as a function of the parameter $r$ for the observed data ($x$ and $n$):\n$$L(r; x, n) = \\binom{n}{x} r^{x} (1-r)^{n-x}$$\n\nTo find the value of $r$ that maximizes this function, we can equivalently maximize the natural logarithm of the likelihood function, the log-likelihood $\\ell(r) = \\ln(L(r))$, as the logarithm is a strictly increasing function.\n$$\\ell(r) = \\ln\\left(\\binom{n}{x}\\right) + x \\ln(r) + (n-x) \\ln(1-r)$$\n\nThe maximum-likelihood estimate, $\\hat{r}$, is found by taking the derivative of $\\ell(r)$ with respect to $r$ and setting it to zero. The term $\\ln(\\binom{n}{x})$ is a constant with respect to $r$ and its derivative is zero.\n$$\\frac{d\\ell}{dr} = \\frac{d}{dr} \\left[ x \\ln(r) + (n-x) \\ln(1-r) \\right] = \\frac{x}{r} - \\frac{n-x}{1-r}$$\n\nSetting the derivative to zero to find the critical point:\n$$\\frac{x}{\\hat{r}} - \\frac{n-x}{1-\\hat{r}} = 0$$\n$$\\frac{x}{\\hat{r}} = \\frac{n-x}{1-\\hat{r}}$$\n$$x(1-\\hat{r}) = \\hat{r}(n-x)$$\n$$x - x\\hat{r} = n\\hat{r} - x\\hat{r}$$\n$$x = n\\hat{r}$$\nThis yields the maximum-likelihood estimator for $r$:\n$$\\hat{r} = \\frac{x}{n}$$\nThis derivation confirms from first principles that the MLE for the recombination fraction is the observed proportion of recombinant individuals.\n\nUsing the provided data, $x = 180$ and $n = 1000$:\n$$\\hat{r} = \\frac{180}{1000} = 0.18$$\nRounding to three significant figures, we get $\\hat{r} = 0.180$.\n\n2. Calculation of Genetic Map Distance\n\nThe genetic map distance in centimorgans (cM) is defined as the mean number of crossovers between two loci per meiosis, multiplied by $100$. For short genetic intervals, the probability of double (or any even number) crossovers is negligible. A single crossover event between two loci always produces recombinant gametes. Therefore, for short distances, the recombination fraction $r$ is a direct and linear estimate of the map distance. The relationship is given by:\n$$\\text{Map Distance (cM)} = 100 \\times r$$\nThis approximation is generally considered valid for $r \\lesssim 0.2$. Since our estimated $\\hat{r} = 0.180$, this linear conversion is appropriate under the problem's specified \"conventional short-interval interpretation\".\n\nUsing our estimated value of $\\hat{r}$:\n$$\\text{Map Distance (cM)} = 100 \\times 0.180 = 18.0$$\nThe map distance is $18.0$ cM.\n\n3. Required Assumptions\n\nConverting an empirically measured recombination fraction, $\\hat{r}$, from a $2$-point cross into a linear map distance requires several critical assumptions.\n\nBiological assumptions:\n- **No Crossover Interference**: The primary assumption for the linear relationship, distance (cM) $= 100 \\times r$, is that crossover events occur independently. That is, the occurrence of one crossover does not influence the probability of a second crossover in the same region. This condition is formally known as the absence of interference. For distances greater than approximately $15-20$ cM, positive interference becomes significant, causing $r$ to underestimate the true map distance calculated from crossover frequency. Mapping functions (e.g., Haldane's or Kosambi's) are required to correct for this non-linearity at larger distances.\n- **Uniform Recombination Rate**: The conversion assumes that the probability of a crossover is uniform per unit of physical distance along the chromosome segment between the two markers. In reality, recombination rates vary, with regions of high activity (hotspots) and low activity (coldspots). The resulting map distance is thus a genetic average, not a precise physical representation.\n- **Equal Viability**: It is assumed that all genotypic classes of progeny (parental and recombinant) are equally viable and detectable at the time of scoring. If recombinant genotypes have reduced viability, the observed frequency $x/n$ will be an underestimate of the true meiotic recombination fraction $r$, leading to an underestimated map distance.\n\nStatistical assumptions:\n- **Large and Random Sample**: The estimate $\\hat{r} = x/n$ relies on the Law of Large Numbers. The sample of progeny is assumed to be large enough for the observed frequency to be a precise estimate of the true population parameter $r$. The sample must also be a random representation of the products of meiosis. With $n=1000$, the sample size is more than adequate for this purpose.\n- **Problem Context Specific Assumption**: The problem specifies a dipteran species and a cross with a heterozygous female. In some dipterans, such as *Drosophila melanogaster*, meiotic recombination is absent in males. The cross design ($AB/ab$ female $\\times$ $ab/ab$ male) correctly isolates recombination events from the female parent, providing a direct measurement of the female-specific recombination rate. The derived map distance is therefore a female genetic map distance, which may differ from the male-specific or sex-averaged map distance if recombination rates are sexually dimorphic.", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.180 & 18.0 \\end{pmatrix} } $$", "id": "2842661"}, {"introduction": "The Chromosomal Theory provides a powerful framework for understanding not only normal inheritance but also the mechanistic basis of genetic diseases. Errors in chromosome segregation, or nondisjunction, lead to aneuploidy, a major cause of developmental disorders and pregnancy loss. This advanced practice [@problem_id:2965714] bridges cellular mechanics and quantitative epidemiology by asking you to model the well-known relationship between maternal age and aneuploidy risk using logistic regression. This exercise demonstrates how core principles of chromosome biology are quantified and analyzed using modern statistical tools, a vital skill in contemporary biological research.", "problem": "Aneuploidy arises from errors in chromosome segregation (nondisjunction), consistent with the chromosomal theory of inheritance that genes reside on chromosomes and their accurate transmission underlies inheritance. Empirically, the probability that an embryo is aneuploid increases with maternal age. You are given binned karyotype count data: for each maternal age $a_i$ (measured in years), there are $n_i$ embryos assayed and $k_i$ of them are aneuploid. Assume the following foundational base and modeling choices, which are standard and well tested for binary outcomes:\n- For each age $a_i$, conditional on the underlying risk $p(a_i)$, the number of aneuploid embryos $k_i$ out of $n_i$ follows a Binomial distribution.\n- The log-odds of aneuploidy are an affine function of age, that is, $\\log\\left(\\dfrac{p(a_i)}{1 - p(a_i)}\\right)$ is a linear function of $a_i$.\n- Parameters are estimated by Maximum Likelihood Estimation (MLE) with a small $\\ell_2$ ridge penalty of strength $\\lambda = 10^{-6}$ to ensure numerical stability in boundary cases.\n\nYour tasks are purely mathematical and algorithmic:\n- Using only the assumptions above, derive and implement an algorithm to obtain the MLEs $\\hat{\\beta}_0$ and $\\hat{\\beta}_1$ for the model where the log-odds of aneuploidy is $\\beta_0 + \\beta_1 a$. Your implementation should be based on optimizing the Binomial log-likelihood with the stated ridge penalty and should not call high-level modeling functions. You may use an iterative second-order method such as Newton–Raphson or Iteratively Reweighted Least Squares, provided it is derived from the likelihood.\n- For each fitted model, compute the per-year odds ratio $\\exp(\\hat{\\beta}_1)$, and the predicted probabilities of aneuploidy at ages $a = 35$ and $a = 42$ years. Probabilities must be expressed as decimals in the interval $[0,1]$.\n\nUnits and numerical format requirements:\n- Maternal age $a$ is in years.\n- All reported probabilities must be decimals (not percentages).\n- All outputs must be rounded to $6$ decimal places.\n\nTest suite (three datasets spanning typical, boundary, and near-flat-effect cases):\n- Dataset A (happy path, monotonic increase, balanced sample sizes):\n  - Ages $a_i$: $[25, 30, 35, 38, 40, 42, 45]$\n  - Total embryos $n_i$: $[100, 100, 100, 100, 100, 100, 100]$\n  - Aneuploid counts $k_i$: $[25, 30, 40, 55, 65, 75, 85]$\n- Dataset B (edge case with small samples and zeros at young ages):\n  - Ages $a_i$: $[22, 28, 34, 36, 39, 41, 44]$\n  - Total embryos $n_i$: $[10, 12, 14, 16, 18, 20, 22]$\n  - Aneuploid counts $k_i$: $[0, 1, 3, 4, 8, 12, 17]$\n- Dataset C (near-flat effect with large samples):\n  - Ages $a_i$: $[30, 32, 34, 36, 38, 40]$\n  - Total embryos $n_i$: $[200, 200, 200, 200, 200, 200]$\n  - Aneuploid counts $k_i$: $[60, 60, 62, 66, 68, 70]$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the three datasets as a list of lists, with no spaces. For each dataset, output the five values $[\\hat{\\beta}_0,\\hat{\\beta}_1,\\exp(\\hat{\\beta}_1),\\hat{p}(35),\\hat{p}(42)]$ in this order, each rounded to $6$ decimal places. Aggregate the three datasets in the order A, B, C.\n- Concretely, the output must look like a single line of the form: \n  \"[[b0_A,b1_A,OR_A,p35_A,p42_A],[b0_B,b1_B,OR_B,p35_B,p42_B],[b0_C,b1_C,OR_C,p35_C,p42_C]]\"\nwhere each placeholder is a decimal rounded to $6$ places and there are no spaces anywhere in the line.", "solution": "We begin from biology: the chromosomal theory of inheritance states that genes are carried on chromosomes, and errors in chromosome segregation (nondisjunction) during meiosis can yield aneuploid gametes and thus aneuploid embryos. A well-supported observation is that the probability of nondisjunction increases with maternal age, implying an age-dependent increase in aneuploidy risk.\n\nFoundational statistical model for counts:\n- For each maternal age $a_i$, we observe $k_i$ aneuploid embryos among $n_i$ examined. Conditional on the age-specific risk $p(a_i)$, the count $k_i$ is modeled as Binomial:\n$$\nk_i \\sim \\mathrm{Binomial}(n_i, p(a_i)).\n$$\n- We assume the canonical log-odds (logit) link with a linear predictor in age:\n$$\n\\mathrm{logit}(p(a_i)) \\equiv \\log\\left(\\frac{p(a_i)}{1 - p(a_i)}\\right) = \\beta_0 + \\beta_1 a_i,\n$$\nwhich is the canonical link for Binomial outcomes in the exponential family and is a standard starting point that encodes a smooth monotonic relationship between age and log-odds of aneuploidy.\n\nMaximum Likelihood Estimation (MLE) with ridge:\n- Let $x_i = \\begin{bmatrix}1 & a_i\\end{bmatrix}^\\top$ and $\\beta = \\begin{bmatrix}\\beta_0 & \\beta_1\\end{bmatrix}^\\top$. Then $p_i \\equiv p(a_i) = \\sigma(x_i^\\top \\beta)$ where $\\sigma(u) = \\dfrac{1}{1 + e^{-u}}$ is the logistic function.\n- The Binomial log-likelihood over independent age bins is\n$$\n\\ell(\\beta) = \\sum_{i} \\left[ k_i \\log(p_i) + (n_i - k_i) \\log(1 - p_i) \\right].\n$$\n- We add a small $\\ell_2$ ridge penalty with strength $\\lambda = 10^{-6}$ to stabilize fits in boundary cases:\n$$\n\\ell_\\lambda(\\beta) = \\ell(\\beta) - \\frac{\\lambda}{2} \\lVert \\beta \\rVert_2^2.\n$$\n\nGradient and Hessian:\n- Using $p_i = \\sigma(x_i^\\top \\beta)$ and $p_i (1 - p_i) = \\sigma(x_i^\\top \\beta) \\left[1 - \\sigma(x_i^\\top \\beta)\\right]$, we obtain the gradient\n$$\ng(\\beta) = \\nabla \\ell_\\lambda(\\beta) = \\sum_{i} x_i \\left(k_i - n_i p_i\\right) - \\lambda \\beta = X^\\top (k - N \\odot p) - \\lambda \\beta,\n$$\nwhere $X$ is the design matrix with rows $x_i^\\top$, $k$ is the vector of counts $k_i$, $N$ is the vector of totals $n_i$, $p$ is the vector of probabilities $p_i$, and $\\odot$ denotes elementwise multiplication.\n- The (negative definite) Hessian is\n$$\nH(\\beta) = \\nabla^2 \\ell_\\lambda(\\beta) = - \\sum_{i} n_i p_i (1 - p_i) x_i x_i^\\top - \\lambda I = - X^\\top W X - \\lambda I,\n$$\nwhere $W$ is diagonal with entries $w_i = n_i p_i (1 - p_i)$ and $I$ is the $2 \\times 2$ identity matrix.\n\nNewton–Raphson / Iteratively Reweighted Least Squares (IRLS) update:\n- Newton’s method for maximizing $\\ell_\\lambda(\\beta)$ solves $H(\\beta) \\Delta = - g(\\beta)$ and sets $\\beta \\leftarrow \\beta + \\Delta$. Using the expressions above, this yields the linear system\n$$\n\\left(X^\\top W X + \\lambda I\\right) \\Delta = X^\\top (k - N \\odot p) - \\lambda \\beta,\n$$\nfollowed by $\\beta \\leftarrow \\beta + \\Delta$. Because $X^\\top W X + \\lambda I$ is positive definite for $\\lambda > 0$, the system is solvable, and the iterations converge rapidly for well-behaved data. To avoid numerical issues, we clip the linear predictor to a bounded range and constrain $p_i$ to lie strictly within $(0,1)$.\n\nQuantities of interest:\n- The per-year odds ratio is $\\exp(\\hat{\\beta}_1)$, the multiplicative change in the odds of aneuploidy for each additional year of maternal age.\n- Predicted risks at specific ages $a^\\star$ are\n$$\n\\hat{p}(a^\\star) = \\sigma\\!\\left(\\hat{\\beta}_0 + \\hat{\\beta}_1 a^\\star\\right).\n$$\n\nBiological interpretation of coefficients:\n- A positive $\\hat{\\beta}_1$ indicates that the log-odds and hence the probability of aneuploidy increase with maternal age, consistent with increased nondisjunction frequency due to age-related spindle assembly defects or cohesin deterioration. The per-year odds ratio $\\exp(\\hat{\\beta}_1)$ quantifies how much the odds multiply for each additional year. For example, $\\exp(\\hat{\\beta}_1) = 1.10$ means the odds are multiplied by $1.10$ per year.\n- The intercept $\\hat{\\beta}_0$ is the log-odds at age $a = 0$, which is outside the biologically relevant range but is necessary for parameterization; meaningful comparisons are via differences in log-odds between ages.\n\nAlgorithmic design summary implemented in the program:\n- Construct $X$ with an intercept and age in years.\n- Initialize $\\beta$ to $\\begin{bmatrix}0 & 0\\end{bmatrix}^\\top$.\n- Iterate Newton/IRLS updates using the system $\\left(X^\\top W X + \\lambda I\\right)\\Delta = X^\\top (k - N \\odot p) - \\lambda \\beta$ until the increment $\\lVert \\Delta \\rVert_2$ is below a small tolerance or a maximum number of iterations is reached.\n- For each dataset (A, B, C), compute $\\hat{\\beta}_0$, $\\hat{\\beta}_1$, $\\exp(\\hat{\\beta}_1)$, $\\hat{p}(35)$, and $\\hat{p}(42)$, round each to $6$ decimals, and output them as specified in a single-line, no-space, nested list.\n\nEdge cases and stability:\n- Dataset B contains ages with zero aneuploid counts; the ridge penalty $\\lambda = 10^{-6}$ and probability clipping ensure numerical stability and prevent infinite estimates from complete or quasi-complete separation.\n- Dataset C has a near-flat effect; the algorithm returns a small $\\hat{\\beta}_1$ and an odds ratio close to $1$, reflecting weak age dependence in those data.", "answer": "```\n[[-4.218520,0.100918,1.106188,0.334812,0.504984],[-6.840618,0.163352,1.177452,0.245843,0.511516],[-2.186632,0.040823,1.041667,0.320496,0.435346]]\n```", "id": "2965714"}]}