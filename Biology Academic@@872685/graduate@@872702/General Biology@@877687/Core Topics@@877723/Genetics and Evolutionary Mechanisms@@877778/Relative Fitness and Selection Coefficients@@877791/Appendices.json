{"hands_on_practices": [{"introduction": "This practice explores the classic case of overdominance, or heterozygote advantage, a powerful mechanism of balancing selection. By deriving the conditions for a protected polymorphism, you will understand how natural selection can actively maintain genetic diversity within a population. This exercise solidifies the core mechanics of modeling allele frequency change from first principles. [@problem_id:2832508]", "problem": "A large, randomly mating diploid population with non-overlapping generations experiences viability selection at a single autosomal locus with two alleles, denoted $A$ and $a$. Let $p$ be the frequency of allele $A$ in zygotes prior to selection and $q = 1 - p$ the frequency of allele $a$. Assume Hardy–Weinberg equilibrium (HWE) holds at the zygote stage. The genotypic viabilities are given by $w_{AA} = 1 - s$, $w_{Aa} = 1$, and $w_{aa} = 1 - t$, where the selection coefficients $s$ and $t$ are nonnegative and strictly less than $1$.\n\nStarting from the definitions of HWE and viability selection as a change in genotype frequencies proportional to genotype viabilities, derive from first principles:\n- the allele frequency recursion $p \\mapsto p'$ after one generation of selection;\n- the condition, stated in terms of $s$ and $t$, under which both alleles are protected when rare (that is, each allele increases in frequency when introduced at vanishingly small frequency into a population fixed for the other);\n- the internal equilibrium allele frequency $p^{*}$ and its local stability.\n\nReport only the closed-form expression for the internal equilibrium allele $A$ frequency $p^{*}$ as your final answer. Do not include any units. No numerical rounding is required.", "solution": "The problem is a well-posed, standard exercise in theoretical population genetics. It is scientifically sound and contains all necessary information for derivation. We proceed with the solution.\n\nLet $p$ be the frequency of allele $A$ and $q = 1 - p$ be the frequency of allele $a$ in the zygote population of a given generation. Under the assumption of random mating, the genotype frequencies at the zygote stage follow Hardy-Weinberg proportions:\n-   Frequency of $AA$: $P_{AA} = p^2$\n-   Frequency of $Aa$: $P_{Aa} = 2pq$\n-   Frequency of $aa$: $P_{aa} = q^2 = (1-p)^2$\n\nViability selection occurs before the adult stage. The relative frequencies of the genotypes after selection are proportional to their initial frequencies multiplied by their respective viabilities, $w_{AA} = 1 - s$, $w_{Aa} = 1$, and $w_{aa} = 1 - t$.\n\nTo find the absolute frequencies of the surviving genotypes, we must normalize by the mean fitness of the population, $\\bar{w}$. The mean fitness is the weighted average of the genotype viabilities, where the weights are the genotype frequencies at the zygote stage.\n$$ \\bar{w} = P_{AA} w_{AA} + P_{Aa} w_{Aa} + P_{aa} w_{aa} $$\nSubstituting the expressions for frequencies and viabilities:\n$$ \\bar{w} = p^2 (1 - s) + 2p(1-p)(1) + (1-p)^2 (1 - t) $$\nExpanding and simplifying this expression:\n$$ \\bar{w} = p^2 - sp^2 + 2p - 2p^2 + (1 - 2p + p^2)(1 - t) $$\n$$ \\bar{w} = 2p - p^2 - sp^2 + 1 - 2p + p^2 - t(1 - 2p + p^2) $$\n$$ \\bar{w} = 1 - sp^2 - t(1-p)^2 $$\n\nThe frequency of allele $A$ in the next generation, denoted $p'$, is the frequency of allele $A$ in the gene pool of the individuals that survived selection. This is given by the frequency of surviving $AA$ homozygotes plus half the frequency of surviving $Aa$ heterozygotes.\n$$ p' = \\frac{P_{AA} w_{AA} + \\frac{1}{2}P_{Aa} w_{Aa}}{\\bar{w}} = \\frac{p^2(1-s) + p(1-p)(1)}{\\bar{w}} $$\n$$ p' = \\frac{p^2 - sp^2 + p - p^2}{\\bar{w}} = \\frac{p - sp^2}{1 - sp^2 - t(1-p)^2} = \\frac{p(1-sp)}{1 - sp^2 - t(1-p)^2} $$\nThis is the required allele frequency recursion $p \\mapsto p'$.\n\nAn allele is \"protected when rare\" if it tends to increase in frequency when its current frequency is very low.\n-   Allele $A$ is protected if $p'  p$ as $p \\to 0$. This is equivalent to the boundary equilibrium $p=0$ being unstable. The stability is determined by the derivative of the recursion map $f(p) = p'$ evaluated at $p=0$. The equilibrium is unstable if $f'(0)  1$.\n    $$ f'(p) = \\frac{d}{dp} \\left( \\frac{p(1-sp)}{1 - sp^2 - t(1-p)^2} \\right) $$\n    At $p=0$, the numerator is $p(1-sp) \\to 0$ and the denominator is $1 - t$. Using the quotient rule is straightforward, but it is simpler to linearize $f(p)$ around $p=0$:\n    $$ f(p) \\approx \\frac{p(1-0)}{1-0-t(1-0)^2} = \\frac{p}{1-t} $$\n    The condition $p'  p$ becomes $\\frac{p}{1-t}  p$, which for $p0$ implies $\\frac{1}{1-t}  1$. Given $0 \\le t  1$, this condition simplifies to $t0$.\n\n-   Allele $a$ is protected if its frequency $q'=(1-p')$ is greater than $q=(1-p)$ when $q \\to 0$ (i.e., as $p \\to 1$). This is equivalent to the boundary equilibrium $p=1$ being unstable, which means $p'  p$ for $p$ close to $1$. Symmetrically, the condition for allele $a$ to increase when rare is $s  0$.\n\nThus, both alleles are protected when rare if $s0$ and $t0$. This corresponds to heterozygote advantage or overdominance, where $w_{Aa}  w_{AA}$ and $w_{Aa}  w_{aa}$.\n\nAn equilibrium allele frequency, $p^*$, is a value of $p$ for which the frequency does not change from one generation to the next, i.e., $p' = p$.\n$$ p = \\frac{p(1-sp)}{1 - sp^2 - t(1-p)^2} $$\nThis equation has trivial solutions at the boundaries of the frequency domain: $p^* = 0$ and $p^* = 1$.\nTo find the internal equilibrium ($0  p^*  1$), we assume $p \\neq 0$ and divide by $p$:\n$$ 1 = \\frac{1-sp}{1 - sp^2 - t(1-p)^2} $$\n$$ 1 - sp^2 - t(1-p)^2 = 1 - sp $$\n$$ -sp^2 - t(1-2p+p^2) = -sp $$\n$$ -sp^2 - t + 2tp - tp^2 = -sp $$\nRearranging the terms to form a quadratic equation in $p$:\n$$ (s+t)p^2 - (s+2t)p + t = 0 $$\nWe can factor this quadratic expression. Knowing that $p=1$ is a solution (as it is a boundary equilibrium), $(p-1)$ must be a factor.\n$$ (p-1)((s+t)p - t) = (s+t)p^2 - tp - (s+t)p + t = (s+t)p^2 - (s+2t)p + t = 0 $$\nThe factorization is correct. The solutions are $p=1$ and $(s+t)p - t = 0$.\nThe second solution gives the internal equilibrium frequency $p^*$:\n$$ (s+t)p^* = t \\implies p^* = \\frac{t}{s+t} $$\nThis internal equilibrium is biologically meaningful only if $0  p^*  1$.\n-   $p^*  0$ requires $\\frac{t}{s+t}  0$. Since $s \\ge 0$ and $t \\ge 0$, this implies $t  0$.\n-   $p^*  1$ requires $\\frac{t}{s+t}  1$, which implies $t  s+t$, or $s  0$.\nThe internal equilibrium exists if and only if $s  0$ and $t  0$, precisely the condition for protected polymorphism.\nWhen this condition holds, the boundary equilibria at $p=0$ and $p=1$ are both unstable. In a $1$-dimensional system such as this, if the two boundary equilibria are unstable, the internal equilibrium must be locally stable. Therefore, $p^* = \\frac{t}{s+t}$ is a stable equilibrium.\n\nThe problem asks for the closed-form expression for the internal equilibrium allele $A$ frequency $p^*$.", "answer": "$$\\boxed{\\frac{t}{s+t}}$$", "id": "2832508"}, {"introduction": "This problem investigates the dynamic equilibrium that arises from the interplay of two opposing evolutionary forces: mutation and selection. You will model a scenario where deleterious alleles are continuously introduced by mutation and simultaneously removed by negative selection. Deriving the equilibrium frequency for this process is fundamental to understanding why many harmful genetic variants persist at low frequencies in populations. [@problem_id:2832591]", "problem": "Consider an infinitely large haploid population with discrete, non-overlapping generations. There are two allelic types at a single locus: a wild-type allele $A$ with relative fitness $w_{A}=1$ and a deleterious allele $a$ with relative fitness $w_{a}=1-s$, where $s \\in (0,1)$ is the selection coefficient against $a$ and is constant over time. In each generation, new deleterious alleles arise by forward mutation from $A$ to $a$ at per-generation rate $u \\in (0,1)$; assume no back mutation from $a$ to $A$. Let $q_{t}$ denote the population frequency of allele $a$ immediately before selection in generation $t$.\n\nUsing only the definitions of relative fitness, selection coefficient, and mutation rate, and assuming determinism (infinite population size so that sampling error is negligible), derive from first principles the deterministic recurrence for $q_{t}$ across one generation under the life cycle “viability selection followed by mutation.” Then, by imposing equilibrium ($q_{t+1}=q_{t}=q^{*}$), solve exactly for the interior equilibrium frequency $q^{*}$ in terms of $u$ and $s$, and extract the leading-order term in the limit $u \\ll s$ (equivalently, $u \\to 0$ with fixed $s \\in (0,1)$). Report your final answer as the leading-order expression for $q^{*}$ in terms of $u$ and $s$. No units are required, and no rounding is needed. Your final answer must be a single analytic expression.", "solution": "The problem requires the derivation of the equilibrium frequency of a deleterious allele under a mutation-selection balance model. The analysis must be conducted from first principles for a haploid population undergoing discrete generations with a specified life cycle.\n\nLet $q_t$ be the frequency of the deleterious allele $a$, and $p_t = 1 - q_t$ be the frequency of the wild-type allele $A$ at the beginning of generation $t$, before any life cycle events occur. The population size is considered infinite, which implies a deterministic model.\n\nThe life cycle is specified as \"viability selection followed by mutation.\" We will model these two processes sequentially.\n\nStep 1: Viability Selection.\nThe relative fitnesses of the alleles are given as $w_A = 1$ for the wild-type allele and $w_a = 1-s$ for the deleterious allele, where $s \\in (0,1)$ is the selection coefficient. The change in allele frequencies due to selection is determined by the mean fitness of the population, $\\bar{w}_t$.\n$$ \\bar{w}_t = p_t w_A + q_t w_a = (1-q_t)(1) + q_t(1-s) = 1 - q_t + q_t - sq_t = 1 - sq_t $$\nAfter selection, the frequency of allele $a$, which we denote $q'_t$, is the frequency before selection multiplied by its relative fitness, and normalized by the mean fitness of the population.\n$$ q'_t = \\frac{q_t w_a}{\\bar{w}_t} = \\frac{q_t(1-s)}{1-sq_t} $$\nSimilarly, the frequency of allele $A$ after selection, $p'_t$, is:\n$$ p'_t = \\frac{p_t w_A}{\\bar{w}_t} = \\frac{1-q_t}{1-sq_t} $$\nAs a check, $p'_t + q'_t = \\frac{1-q_t + q_t(1-s)}{1-sq_t} = \\frac{1-q_t+q_t-sq_t}{1-sq_t} = \\frac{1-sq_t}{1-sq_t} = 1$.\n\nStep 2: Mutation.\nFollowing selection, mutation occurs. New deleterious alleles $a$ arise from wild-type alleles $A$ at a rate of $u \\in (0,1)$ per generation. There is no back mutation from $a$ to $A$. The frequency of allele $a$ in the next generation, $q_{t+1}$, is the sum of the frequency of $a$ alleles that survived selection ($q'_t$) and the frequency of new $a$ alleles that arose from mutation of $A$ alleles ($u \\cdot p'_t$).\n$$ q_{t+1} = q'_t + u \\cdot p'_t $$\nSubstituting the expressions for $q'_t$ and $p'_t$ derived in Step 1:\n$$ q_{t+1} = \\frac{q_t(1-s)}{1-sq_t} + u \\left( \\frac{1-q_t}{1-sq_t} \\right) $$\nCombining the terms gives the exact recurrence relation for $q_t$:\n$$ q_{t+1} = \\frac{q_t(1-s) + u(1-q_t)}{1-sq_t} = \\frac{q_t - sq_t + u - uq_t}{1-sq_t} = \\frac{q_t(1-s-u) + u}{1-sq_t} $$\nTo find the equilibrium frequency, $q^*$, we impose the condition $q_{t+1} = q_t = q^*$.\n$$ q^* = \\frac{q^*(1-s-u) + u}{1-sq^*} $$\nWe now solve this equation for $q^*$.\n$$ q^*(1-sq^*) = q^*(1-s-u) + u $$\n$$ q^* - s(q^*)^2 = q^* - sq^* - uq^* + u $$\nCanceling the $q^*$ term from both sides and rearranging yields a quadratic equation for $q^*$:\n$$ -s(q^*)^2 = -sq^* - uq^* + u $$\n$$ s(q^*)^2 - (s+u)q^* + u = 0 $$\nThis quadratic equation can be solved by factoring. We seek two numbers that sum to $-(s+u)$ and have a product of $su$. The factors are clearly visible.\n$$ (sq^* - u)(q^* - 1) = s(q^*)^2 - sq^* - uq^* + u = s(q^*)^2 - (s+u)q^* + u = 0 $$\nThe two exact solutions for the equilibrium frequency are found by setting each factor to zero:\n1.  $q^* - 1 = 0 \\implies q^* = 1$. This is a boundary equilibrium corresponding to the fixation of the deleterious allele.\n2.  $sq^* - u = 0 \\implies q^* = \\frac{u}{s}$. This is the interior equilibrium ($0  q^*  1$), which is biologically meaningful for a mutation-selection balance. The condition $u \\ll s$ given in the problem ensures that $q^*  1$.\n\nThe problem asks for the leading-order term of the exact solution for $q^*$ in the limit $u \\ll s$. The exact solution for the interior equilibrium is $q^* = \\frac{u}{s}$. This expression is a single term, linear in $u$ and inversely proportional to $s$. It contains no higher-order terms in $u$ or any other small parameter. Therefore, the expression itself is its own leading-order term. No approximation or expansion is necessary. The leading-order expression is the exact expression.", "answer": "$$\\boxed{\\frac{u}{s}}$$", "id": "2832591"}, {"introduction": "Shifting our focus from deterministic outcomes in infinite populations, this exercise addresses a crucial question: what is the chance that a single new beneficial mutation survives and spreads? You will use a branching process approximation to account for the powerful role of random genetic drift when an allele is rare. This derivation leads to a celebrated result in population genetics, linking the selection coefficient $s$ directly to the probability of evolutionary success. [@problem_id:2832501]", "problem": "In a diploid Wright–Fisher population of constant census size $N$ with nonoverlapping generations, a single new beneficial allele $A$ arises in an otherwise monomorphic population fixed for allele $a$. Assume genotypic relative fitnesses are $w_{aa} = 1$, $w_{Aa} = 1 + s$, and $w_{AA} = 1 + 2s$ with $0  s \\ll 1$, so that the beneficial effect is semi-dominant (dominance coefficient $h = 0.5$ when parameterized relative to the homozygote difference). The allele starts as a single copy in a heterozygous individual. Assume random mating, no mutation after the initial event, and that selection acts through viability before sampling. Work in the regime $N s \\gg 1$ and $s \\to 0^{+}$.\n\nStarting from the definitions of relative fitness and stochastic sampling in the Wright–Fisher model, and invoking a rare-allele branching-process approximation for the initial stochastic phase while the allele is rare, derive an asymptotic, closed-form expression for the probability that the new allele ultimately fixes in the population as a function of $s$ only. Your final answer must be a single analytical expression in terms of $s$ (no other parameters). Do not use percentage notation. No rounding is required.", "solution": "The problem asks for the fixation probability, $P_{\\text{fix}}$, of a new beneficial allele $A$ in a diploid Wright-Fisher population. We are given the genotypic relative fitnesses as $w_{aa} = 1$, $w_{Aa} = 1 + s$, and $w_{AA} = 1 + 2s$, where $s$ is a small, positive selection coefficient ($0  s \\ll 1$). The allele arises as a single copy in a population of constant size $N$, and we operate in the regime where selection is strong compared to drift ($Ns \\gg 1$).\n\nWe will solve this problem by modeling the initial phase of the allele's trajectory, when it is rare, using a branching process approximation. The ultimate fate of the allele—fixation or loss—is largely determined during this early stochastic phase. If the allele's lineage can survive random extinction while rare, its frequency will eventually become large enough for deterministic positive selection to drive it to fixation, an outcome made highly probable by the condition $Ns \\gg 1$. Therefore, the probability of fixation is approximately equal to the probability that the allele's lineage does not go extinct.\n\nLet $k_g$ be the number of copies of the allele $A$ in generation $g$. We begin with $k_0 = 1$. The frequency of allele $A$ is $p_g = k_g / (2N)$. In the Wright–Fisher model, the number of copies in the next generation, $k_{g+1}$, is drawn from a binomial distribution:\n$$k_{g+1} \\sim \\text{Binomial}(2N, p_g')$$\nwhere $p_g'$ is the frequency of allele $A$ in the gamete pool after selection has acted on the parent generation. The frequency $p_g'$ is given by:\n$$p_g' = \\frac{p_g^2 w_{AA} + p_g(1-p_g)w_{Aa}}{\\bar{w}}$$\nwhere $\\bar{w}$ is the mean fitness of the population:\n$$\\bar{w} = p_g^2 w_{AA} + 2p_g(1-p_g)w_{Aa} + (1-p_g)^2 w_{aa}$$\n\nWhen the allele is rare ($p_g \\ll 1$), we can make several simplifying approximations. The mean fitness $\\bar{w}$ is close to the fitness of the wild-type, $\\bar{w} \\approx w_{aa} = 1$. Also, the term $p_g^2 w_{AA}$ is negligible compared to the term involving $p_g$. Thus, the frequency after selection is approximately:\n$$p_g' \\approx \\frac{p_g(1-p_g)w_{Aa}}{\\bar{w}} \\approx \\frac{p_g (1+s)}{1} = p_g(1+s)$$\nThe expected number of copies of allele $A$ in generation $g+1$ is $E[k_{g+1}] = 2N p_g'$. Substituting our approximation for $p_g'$ and using $p_g = k_g / (2N)$, we find:\n$$E[k_{g+1} | k_g] \\approx 2N \\left( \\frac{k_g}{2N} (1+s) \\right) = k_g(1+s)$$\nThis shows that each copy of the allele $A$ is expected to leave $1+s$ descendant copies in the next generation.\n\nWe can now model the number of descendants of the single initial copy as a branching process. The number of offspring of the single allele copy, $k_1$, is drawn from the distribution $\\text{Binomial}(2N, p_0')$ with $p_0' \\approx p_0(1+s) = \\frac{1}{2N}(1+s)$. For large $N$, this binomial distribution is accurately approximated by a Poisson distribution with mean $\\lambda = 2N \\times p_0' = 1+s$.\n\nIn a branching process, the probability of ultimate extinction, $P_{\\text{ext}}$, is the smallest non-negative root of the equation $x = G(x)$, where $G(z)$ is the probability generating function (PGF) of the offspring distribution. For a Poisson distribution with mean $\\lambda$, the PGF is $G(z) = \\exp(\\lambda(z-1))$. In our case, $\\lambda = 1+s$, so we must solve:\n$$x = \\exp((1+s)(x-1))$$\nOne trivial root is $x=1$, which corresponds to certain extinction. Since the mean number of offspring $\\lambda = 1+s  1$, there exists a second root $x \\in [0, 1)$, which represents the true probability of extinction for a lineage starting with one individual.\n\nTo find this root, we assume that for small $s$, the probability of survival is also small, meaning the probability of extinction $x$ is close to $1$. Let $x = 1 - \\delta$, where $\\delta$ represents the probability of survival (and ultimate fixation), so $\\delta \\ll 1$. Substituting this into the equation:\n$$1 - \\delta = \\exp((1+s)(1-\\delta-1)) = \\exp(-(1+s)\\delta)$$\nWe now perform a Taylor expansion of the exponential function, $\\exp(-y) \\approx 1 - y + \\frac{y^2}{2}$, for the small argument $y = (1+s)\\delta$:\n$$1 - \\delta \\approx 1 - (1+s)\\delta + \\frac{((1+s)\\delta)^2}{2}$$\nSimplifying the expression yields:\n$$0 \\approx -s\\delta + \\frac{(1+s)^2 \\delta^2}{2}$$\nSince we are seeking the non-trivial solution where survival is possible ($\\delta \\neq 0$), we can divide the equation by $\\delta$:\n$$s \\approx \\frac{(1+s)^2 \\delta}{2}$$\nSolving for $\\delta$, the probability of survival, gives:\n$$\\delta = \\frac{2s}{(1+s)^2}$$\nThe probability of fixation is precisely this survival probability, $P_{\\text{fix}} = \\delta$. Thus, we have an expression for the fixation probability:\n$$P_{\\text{fix}} = \\frac{2s}{(1+s)^2}$$\nThe problem asks for an asymptotic expression as $s \\to 0^+$. In this limit, the denominator $(1+s)^2 = 1 + 2s + s^2$ approaches $1$. The leading-order term for the fixation probability is therefore:\n$$P_{\\text{fix}} \\approx 2s$$\nThis is the classic result first derived by Haldane. The selective advantage of the heterozygote, $s$, determines the fixation probability in this diploid model. The fitness of the $AA$ homozygote does not influence the initial survival probability because the allele is too rare for homozygotes to form.", "answer": "$$ \\boxed{2s} $$", "id": "2832501"}]}