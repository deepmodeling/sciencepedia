{"hands_on_practices": [{"introduction": "This exercise provides a foundational workout in maximum parsimony. To compare the fitness of different phylogenetic trees, we first need a method to calculate the \"cost\" of a single tree, defined as the minimum number of evolutionary changes required to explain the character states we see in living species. The Fitch algorithm [@problem_id:2810415] is a classic and efficient procedure for calculating this parsimony score and for identifying which ancestral nodes have an ambiguous state assignment, laying the groundwork for all further parsimony-based interpretation.", "problem": "A single unordered, binary morphological character is observed across four taxa labeled A, B, C, and D. The character has two possible states, coded as $0$ (ancestral) and $1$ (derived). The phylogeny relating these taxa is given in Newick format as \"((A,B),(C,D));\", which you may treat as a rooted, fully bifurcating tree with a root whose two children are the internal ancestors of A with B, and of C with D, respectively. The observed tip states are A: $0$, B: $1$, C: $1$, and D: $1$.\n\nUnder the principle of maximum parsimony (Fitch parsimony), infer the minimum number of state-change steps required on this tree and determine which internal nodes (if any) are ambiguous in their inferred state sets when applying the standard bottom-up set-propagation procedure. For clarity, let $v_{1}$ denote the most recent common ancestor of A and B, $v_{2}$ denote the most recent common ancestor of C and D, and $r$ denote the root.\n\nDefine an internal node to be “ambiguous” if the set of possible character states assigned to that node under the bottom-up pass has cardinality greater than $1$. Provide any necessary reasoning starting from the parsimony principle that seeks to minimize total changes across the tree.\n\nReport only the minimum number of state-change steps as your final answer. Express the final answer as a pure number with no units. No rounding is required.", "solution": "The Fitch algorithm proceeds in two passes. The first pass is a bottom-up traversal of the tree to assign a set of possible states to each internal node. The second pass is a top-down traversal to assign a single state to each node. The total number of state changes is calculated during the first pass.\n\nLet $S(k)$ denote the set of possible states for a node $k$. For the terminal nodes (tips), the state sets are determined by their observed states:\n$S(A) = \\{0\\}$\n$S(B) = \\{1\\}$\n$S(C) = \\{1\\}$\n$S(D) = \\{1\\}$\n\nThe first pass proceeds from the tips to the root. For any internal node $k$ with children $i$ and $j$, the state set $S(k)$ is determined by the following rule:\nIf $S(i) \\cap S(j)$ is not an empty set ($\\neq \\emptyset$), then $S(k) = S(i) \\cap S(j)$.\nIf $S(i) \\cap S(j)$ is an empty set ($= \\emptyset$), then $S(k) = S(i) \\cup S(j)$. A state change is inferred on the subtree rooted at $k$, and the total step count is incremented by $1$.\n\nLet us apply this procedure to the given tree.\n\nFirst, consider the internal node $v_{1}$, the most recent common ancestor of $A$ and $B$. Its children are $A$ and $B$.\nThe state sets of its children are $S(A) = \\{0\\}$ and $S(B) = \\{1\\}$.\nThe intersection is $S(A) \\cap S(B) = \\{0\\} \\cap \\{1\\} = \\emptyset$.\nSince the intersection is empty, we take the union: $S(v_{1}) = S(A) \\cup S(B) = \\{0\\} \\cup \\{1\\} = \\{0, 1\\}$.\nThe application of the union rule signifies a required state change. The number of steps for this subtree is $1$.\nThe cardinality of $S(v_{1})$ is $|S(v_{1})| = 2$. Since $2 > 1$, the node $v_{1}$ is ambiguous.\n\nNext, consider the internal node $v_{2}$, the most recent common ancestor of $C$ and $D$. Its children are $C$ and $D$.\nThe state sets of its children are $S(C) = \\{1\\}$ and $S(D) = \\{1\\}$.\nThe intersection is $S(C) \\cap S(D) = \\{1\\} \\cap \\{1\\} = \\{1\\}$.\nSince the intersection is not empty, we assign the intersection to the parent node: $S(v_{2}) = \\{1\\}$.\nNo state change is required on this subtree. The number of steps is $0$.\nThe cardinality of $S(v_{2})$ is $|S(v_{2})| = 1$. This node is not ambiguous.\n\nFinally, consider the root node $r$, whose children are $v_{1}$ and $v_{2}$.\nThe state sets of its children are $S(v_{1}) = \\{0, 1\\}$ and $S(v_{2}) = \\{1\\}$.\nThe intersection is $S(v_{1}) \\cap S(v_{2}) = \\{0, 1\\} \\cap \\{1\\} = \\{1\\}$.\nSince the intersection is not empty, we assign the intersection to the root: $S(r) = \\{1\\}$.\nNo state change is required on the branch connecting $v_{1}$ or $v_{2}$ to the root during this part of the calculation. The number of steps is $0$.\nThe cardinality of $S(r)$ is $|S(r)| = 1$. The root node is not ambiguous.\n\nThe minimum total number of state changes for the entire tree is the sum of the steps accumulated during the bottom-up pass.\nTotal steps = (steps at $v_{1}$) + (steps at $v_{2}$) + (steps at $r$).\nIn our calculation, a step was counted only when computing the state set for $v_{1}$.\nTotal steps = $1 + 0 + 0 = 1$.\n\nTo confirm, we can perform the second (top-down) pass, though it is not strictly required to find the minimum number of steps. The root state-set is $S(r)=\\{1\\}$, so we must assign state $1$ to the root. For its children, we assign states to minimize further changes. For $v_2$, its state-set is $\\{1\\}$, so it is assigned state $1$. For $v_1$, its state-set is $\\{0,1\\}$. Since the parent state is $1$, we choose $1$ for $v_1$ to avoid a change. Now, we have states for the internal nodes: state($r$)=$1$, state($v_2$)=$1$, state($v_1$)=$1$.\nWe compare these to the states of their children.\nBranch $r \\to v_1$: $1 \\to 1$ (no change).\nBranch $r \\to v_2$: $1 \\to 1$ (no change).\nBranch $v_1 \\to A$: $1 \\to 0$ ($1$ change).\nBranch $v_1 \\to B$: $1 \\to 1$ (no change).\nBranch $v_2 \\to C$: $1 \\to 1$ (no change).\nBranch $v_2 \\to D$: $1 \\to 1$ (no change).\nThe total number of changes is $1$, which occurs on the branch leading to taxon $A$. This confirms the result from the first pass.\n\nThe minimum number of state-change steps required on this tree is $1$. The only ambiguous internal node is $v_{1}$. The problem asks only for the number of steps.", "answer": "$$\\boxed{1}$$", "id": "2810415"}, {"introduction": "After calculating a parsimony score, $s$, the next logical step is to interpret what that score means. A character requiring two changes might be perfectly consistent with one tree but highly inconsistent with another. This practice introduces two key metrics, the Consistency Index ($CI$) and the Retention Index ($RI$), which contextualize the parsimony score by comparing it to the theoretical minimum ($m$) and maximum ($g$) number of changes the character could require [@problem_id:2810395]. By calculating these indices, you will learn to quantify the degree of homoplasy (convergent evolution or reversal) and assess how well a character's distribution fits a given phylogenetic hypothesis.", "problem": "A single unordered, reversible, equal-weight binary character is observed on four taxa related by the fully resolved unrooted tree written in Newick notation as \"((A,B),(C,D));\". The observed tip states are: $A:0$, $B:0$, $C:1$, $D:1$. Using the foundational definitions that (i) the parsimony score $s$ of a character on a fixed tree is the minimum number of state changes required to explain the observed tip states on that tree, (ii) the theoretical minimum number of steps $m$ for that character is the minimum over all possible fully resolved trees on the same set of taxa, and (iii) the theoretical maximum number of steps $g$ for that character is the maximum over all possible fully resolved trees on the same set of taxa consistent with the observed state frequencies, compute the Consistency Index ($CI$) and the Retention Index ($RI$) for this character on the given tree. Explicitly show the values of $m$, $s$, and $g$ you use before computing $CI$ and $RI$. Provide exact values with no rounding. The final answer must include both $CI$ and $RI$.", "solution": "The solution proceeds by first calculating the three fundamental quantities: the parsimony score ($s$), the theoretical minimum number of steps ($m$), and the theoretical maximum number of steps ($g$). Subsequently, these values are used to compute the Consistency Index ($CI$) and the Retention Index ($RI$).\n\n**1. Calculation of the Parsimony Score ($s$)**\n\nThe parsimony score, $s$, is the minimum number of character state changes on the given tree, \"((A,B),(C,D));\". This unrooted tree topology groups taxa $A$ and $B$ together, and taxa $C$ and $D$ together. There is a single internal branch connecting the common ancestor of the $(A,B)$ clade and the common ancestor of the $(C,D)$ clade.\n\nWe can determine $s$ using Fitch's algorithm, or by direct inspection for a simple case such as this.\n- The states for the tips are $A:0$, $B:0$, $C:1$, $D:1$.\n- Consider the clade $(A,B)$. Both taxa have state $0$. Therefore, their most recent common ancestor can be assigned state $0$ with zero changes on the branches leading to $A$ and $B$.\n- Consider the clade $(C,D)$. Both taxa have state $1$. Therefore, their most recent common ancestor can be assigned state $1$ with zero changes on the branches leading to $C$ and $D$.\n- The tree now consists of two internal nodes, one with an optimal state of $0$ and the other with an optimal state of $1$, connected by the central internal branch. To reconcile these states, exactly one change (from $0$ to $1$, or $1$ to $0$, as the character is reversible) is required on this internal branch.\n- The total number of changes is the sum of changes on all branches: $0 + 0 + 1 = 1$.\nThus, the parsimony score on the given tree is $s = 1$.\n\n**2. Calculation of the Theoretical Minimum Steps ($m$)**\n\nThe value $m$ is the minimum number of changes required for a character, regardless of the tree topology. For any character with $r$ distinct states observed among the taxa, at least $r-1$ changes are necessary to connect all states. This is the intrinsic minimum for the character's state distribution.\n- The observed states are $0$ and $1$.\n- The number of distinct states is $r = 2$.\n- Therefore, the theoretical minimum number of steps is $m = r - 1 = 2 - 1 = 1$.\n\n**3. Calculation of the Theoretical Maximum Steps ($g$)**\n\nThe value $g$ is the maximum parsimony score over all possible fully resolved unrooted trees for the four taxa $A, B, C, D$. For four taxa, there are three possible unrooted tree topologies:\n- Tree 1: `((A,B),(C,D));` (the given tree). As calculated, the score is $s_1 = 1$.\n- Tree 2: `((A,C),(B,D));`. Here, clade $(A,C)$ has states $(0,1)$, and clade $(B,D)$ has states $(0,1)$. Each of these clades requires a minimum of one change to be explained. The total score is the sum of the minimum changes in each partition created by the central branch. The partition is $\\{A, C\\}$ and $\\{B, D\\}$. Minimum changes for $\\{A,C\\}$ is $1$. Minimum changes for $\\{B,D\\}$ is $1$. The total changes on this tree is $s_2 = 1 + 1 = 2$.\n- Tree 3: `((A,D),(B,C));`. Here, clade $(A,D)$ has states $(0,1)$ and clade $(B,C)$ has states $(0,1)$. By symmetry with Tree 2, the score is $s_3 = 2$.\n\nThe set of possible parsimony scores for this character across all valid tree topologies is $\\{1, 2\\}$. The maximum value in this set is $2$.\nTherefore, the theoretical maximum number of steps is $g = 2$.\n\nAlternatively, for a binary character with $n_0$ taxa in state $0$ and $n_1$ taxa in state $1$, the value of $g$ can be calculated by the formula $g = (n_0 + n_1) - \\max(n_0, n_1)$.\n- In this problem, $n_0 = 2$ (taxa $A, B$) and $n_1 = 2$ (taxa $C, D$).\n- $g = (2+2) - \\max(2,2) = 4 - 2 = 2$.\nThis confirms the result from enumeration.\n\n**4. Calculation of the Consistency Index ($CI$) and Retention Index ($RI$)**\n\nThe required values are now available:\n- $s = 1$\n- $m = 1$\n- $g = 2$\n\nThe Consistency Index ($CI$) is defined as the ratio of the theoretical minimum steps to the actual parsimony score on the tree:\n$$CI = \\frac{m}{s}$$\n$$CI = \\frac{1}{1} = 1$$\nA $CI$ of $1$ signifies that the character exhibits no homoplasy (convergent or parallel evolution, or reversal) on the given tree.\n\nThe Retention Index ($RI$) is defined as:\n$$RI = \\frac{g - s}{g - m}$$\nThis index measures the fraction of potential synapomorphy that is realized as actual synapomorphy on the tree.\n$$RI = \\frac{2 - 1}{2 - 1} = \\frac{1}{1} = 1$$\nAn $RI$ of $1$ indicates that the character fits the given tree topology perfectly, maximizing the synapomorphy that the character's distribution allows.\n\nThe computed values are $CI = 1$ and $RI = 1$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1 & 1 \\end{pmatrix}\n}\n$$", "id": "2810395"}, {"introduction": "Knowing the minimum number of changes is one thing, but pinpointing where those changes occurred on the tree is crucial for building evolutionary narratives. Often, parsimony analysis results in ambiguity, where several different histories of character change are equally parsimonious. This exercise explores how to resolve this ambiguity using optimization criteria like ACCTRAN (which favors reversals) and DELTRAN (which favors parallelisms) [@problem_id:2810446]. Working through this problem will give you a hands-on understanding of how these different optimizations can lead to different inferences about the evolutionary process, such as whether a trait was gained and then lost, or gained independently multiple times.", "problem": "A single unordered binary morphological character is observed in four ingroup taxa on the rooted tree topology written in Newick form as \"((A,B),(C,D));\". The observed tip states are: taxon A has state $1$, taxon B has state $0$, taxon C has state $1$, and taxon D has state $0$. Assume equal costs for $0 \\leftrightarrow 1$ changes and that the tree is rooted at the internal node joining the two clades $(A,B)$ and $(C,D)$. An outgroup (not shown) supports an ancestral root state of $0$, so take the root state to be $0$.\n\nUsing the parsimony definition that the optimal reconstruction minimizes the number of state changes on the tree, and using the standard Fitch set algorithm for unordered characters, do the following:\n\n1. Determine the minimum number of steps required by this character on the given tree.\n2. Resolve the remaining ambiguities under accelerated transformation (ACCTRAN; accelerated transformation) and delayed transformation (DELTRAN; delayed transformation) optimizations, and for each, count the number of gains ($0 \\to 1$) and the number of losses ($1 \\to 0$) on the branches.\n\nLet $G_{\\text{ACC}}$ and $L_{\\text{ACC}}$ denote, respectively, the numbers of gains and losses under accelerated transformation, and let $G_{\\text{DEL}}$ and $L_{\\text{DEL}}$ denote, respectively, the numbers of gains and losses under delayed transformation.\n\nCompute the single quantity $S = G_{\\text{ACC}} + L_{\\text{DEL}}$ and report it as a real number. No rounding is required.", "solution": "The problem requires us to analyze the evolution of a binary character on a given rooted phylogenetic tree. The provided information is as follows:\n-   Tree topology in Newick format: `((A,B),(C,D));`. This describes a rooted tree where the root node, let us call it $R$, has two daughter nodes. The first daughter node, $N_1$, is the most recent common ancestor of taxa $A$ and $B$. The second daughter node, $N_2$, is the most recent common ancestor of taxa $C$ and $D$.\n-   Character states at the tips (terminal taxa):\n    -   Taxon $A$: state $1$.\n    -   Taxon $B$: state $0$.\n    -   Taxon $C$: state $1$.\n    -   Taxon $D$: state $0$.\n-   Root state: The state of the root node $R$ is specified as $0$.\n-   Cost model: The character is unordered, meaning the cost of a change from $0 \\to 1$ is equal to the cost of a change from $1 \\to 0$. We assign a cost of $1$ for any change and $0$ for no change.\n-   Objective: We must first find the minimum number of steps (tree length), then apply ACCTRAN and DELTRAN optimizations to count gains ($G$) and losses ($L$), and finally compute $S = G_{\\text{ACC}} + L_{\\text{DEL}}$.\n\nPart 1: Determine the minimum number of steps (Tree Length) using the Fitch algorithm.\n\nThe Fitch algorithm consists of a bottom-up pass (from tips to root) to determine the possible states for each internal node and the total tree length.\nLet $S_u$ be the set of possible states for a node $u$.\nFor terminal nodes (tips), the state set is the observed state:\n-   $S_A = \\{1\\}$\n-   $S_B = \\{0\\}$\n-   $S_C = \\{1\\}$\n-   $S_D = \\{0\\}$\n\nFor an internal node $p$ with daughter nodes $l$ and $r$, the state set $S_p$ is determined as follows:\n-   If $S_l \\cap S_r$ is non-empty, then $S_p = S_l \\cap S_r$. No change is necessary on the branches leading from $p$.\n-   If $S_l \\cap S_r$ is empty, then $S_p = S_l \\cup S_r$. One change (a step) is added to the tree length.\n\nLet's apply this to our tree:\n1.  Node $N_1$ (ancestor of $A$ and $B$):\n    -   $S_A = \\{1\\}$, $S_B = \\{0\\}$.\n    -   $S_A \\cap S_B = \\{1\\} \\cap \\{0\\} = \\emptyset$.\n    -   Therefore, $S_{N_1} = S_A \\cup S_B = \\{0, 1\\}$.\n    -   We add $1$ step to the total length.\n\n2.  Node $N_2$ (ancestor of $C$ and $D$):\n    -   $S_C = \\{1\\}$, $S_D = \\{0\\}$.\n    -   $S_C \\cap S_D = \\{1\\} \\cap \\{0\\} = \\emptyset$.\n    -   Therefore, $S_{N_2} = S_C \\cup S_D = \\{0, 1\\}$.\n    -   We add another $1$ step to the total length.\n\n3.  Node $R$ (root, ancestor of $N_1$ and $N_2$):\n    -   $S_{N_1} = \\{0, 1\\}$, $S_{N_2} = \\{0, 1\\}$.\n    -   $S_{N_1} \\cap S_{N_2} = \\{0, 1\\} \\cap \\{0, 1\\} = \\{0, 1\\} \\neq \\emptyset$.\n    -   Therefore, $S_R = S_{N_1} \\cap S_{N_2} = \\{0, 1\\}$.\n    -   No additional step is added.\n\nThe total minimum number of steps is the sum of steps counted, which is $1 + 1 = 2$.\n\nPart 2: Determine ancestral states and resolve ambiguities.\n\nThe second phase is to assign a definite state to each internal node. The problem specifies the root state $s(R) = 0$. We must find the states for $N_1$ and $N_2$, denoted $s(N_1)$ and $s(N_2)$, that result in a total of exactly $2$ steps.\n\nLet us analyze the total number of changes (cost) as a function of the states assigned to $N_1$ and $N_2$.\nThe total cost $L$ is the sum of changes over all branches:\n$L = |s(R)-s(N_1)| + |s(R)-s(N_2)| + |s(N_1)-s(A)| + |s(N_1)-s(B)| + |s(N_2)-s(C)| + |s(N_2)-s(D)|$.\nSubstituting the known values $s(R)=0$, $s(A)=1$, $s(B)=0$, $s(C)=1$, $s(D)=0$:\n$L(s(N_1), s(N_2)) = |0-s(N_1)| + |0-s(N_2)| + |s(N_1)-1| + |s(N_1)-0| + |s(N_2)-1| + |s(N_2)-0|$.\n\nThe Fitch sets tell us that the optimal states must be chosen from $s(N_1) \\in \\{0, 1\\}$ and $s(N_2) \\in \\{0, 1\\}$. We test the four possibilities:\n-   Case 1: $s(N_1)=0, s(N_2)=0$.\n    $L(0,0) = |0-0|+|0-0|+|0-1|+|0-0|+|0-1|+|0-0| = 0+0+1+0+1+0 = 2$.\n-   Case 2: $s(N_1)=0, s(N_2)=1$.\n    $L(0,1) = |0-0|+|0-1|+|0-1|+|0-0|+|1-1|+|1-0| = 0+1+1+0+0+1 = 3$.\n-   Case 3: $s(N_1)=1, s(N_2)=0$.\n    $L(1,0) = |0-1|+|0-0|+|1-1|+|1-0|+|0-1|+|0-0| = 1+0+0+1+1+0 = 3$.\n-   Case 4: $s(N_1)=1, s(N_2)=1$.\n    $L(1,1) = |0-1|+|0-1|+|1-1|+|1-0|+|1-1|+|1-0| = 1+1+0+1+0+1 = 4$.\n\nThe calculation confirms that the minimum length is $2$, and this is achieved only when $s(N_1)=0$ and $s(N_2)=0$.\n\nThis result is critical. ACCTRAN and DELTRAN are optimization criteria used to resolve ambiguity in ancestral state assignments, i.e., when multiple different state assignments for internal nodes yield the same minimum tree length. In this problem, there is only one most-parsimonious reconstruction. There is no ambiguity. Consequently, the ACCTRAN and DELTRAN reconstructions must be identical.\n\nPart 3: Count gains and losses for the unique parsimonious reconstruction.\n\nThe unique optimal reconstruction is:\n-   $s(R) = 0$\n-   $s(N_1) = 0$\n-   $s(N_2) = 0$\n\nNow, we count the changes on each branch:\n-   Branch $R \\to N_1$: $0 \\to 0$ (no change)\n-   Branch $R \\to N_2$: $0 \\to 0$ (no change)\n-   Branch $N_1 \\to A$: $0 \\to 1$ (This is a GAIN)\n-   Branch $N_1 \\to B$: $0 \\to 0$ (no change)\n-   Branch $N_2 \\to C$: $0 \\to 1$ (This is a GAIN)\n-   Branch $N_2 \\to D$: $0 \\to 0$ (no change)\n\nThe total changes are indeed $2$. Both changes are gains ($0 \\to 1$). There are no losses ($1 \\to 0$).\n\nSince this is the only parsimonious reconstruction, it is the result for both optimizations.\n-   For ACCTRAN: $G_{\\text{ACC}} = 2$, $L_{\\text{ACC}} = 0$.\n-   For DELTRAN: $G_{\\text{DEL}} = 2$, $L_{\\text{DEL}} = 0$.\n\nPart 4: Compute the final quantity S.\n\nThe problem asks for the quantity $S = G_{\\text{ACC}} + L_{\\text{DEL}}$.\nUsing the values derived:\n$S = 2 + 0 = 2$.\nThe crucial point is the recognition that no ambiguity exists for ACCTRAN/DELTRAN to resolve, making their outcomes identical.\n\nFinal values:\n-   Minimum steps: $2$.\n-   $G_{\\text{ACC}} = 2$.\n-   $L_{\\text{DEL}} = 0$.\n-   $S = 2 + 0 = 2$.", "answer": "$$\\boxed{2}$$", "id": "2810446"}]}