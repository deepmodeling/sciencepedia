{"hands_on_practices": [{"introduction": "Before a plasmid can spread between hosts, it must stably maintain itself within a single cell line. This exercise [@problem_id:2831703] explores the fundamental trade-off between replication and host burden by modeling the molecular control of plasmid copy number. By deriving the steady-state copy number from first principles, you will gain quantitative insight into how regulatory mechanisms determine resistance gene dosage and the fitness cost imposed on the bacterial host.", "problem": "A single bacterial cell harbors a resistance plasmid (R plasmid) whose copy number is controlled by two mechanistically independent negative-feedback elements: antisense ribonucleic acid (RNA) inhibition of replication-protein expression and iteron-mediated (tandem origin repeats) origin handcuffing. Assume the following minimal, dimensionless, mass-action model of these controls during balanced exponential growth at a constant dilution rate $\\,\\mu\\,\\gt\\,0\\,$ (cell division rate):\n\n- Let $\\,n\\,$ denote plasmid copy number per cell.\n- The per-plasmid initiation rate of replication is inhibited by antisense RNA with an inhibitory factor $\\,\\left(1+n/\\kappa_{A}\\right)^{-1}\\,$ and by iteron handcuffing with a factor $\\,\\left(1+n/\\kappa_{I}\\right)^{-1}\\,$, where $\\,\\kappa_{A}\\,\\gt\\,0\\,$ and $\\,\\kappa_{I}\\,\\gt\\,0\\,$ are dimensionless sensitivities capturing the strength of antisense titration and handcuffing, respectively.\n- The intrinsic initiation capacity (in the absence of inhibition) is a constant $\\,\\rho\\,\\gt\\,0\\,$, so the net per-plasmid initiation rate is\n$$\nr(n)\\;=\\;\\rho\\,\\left(1+\\frac{n}{\\kappa_{A}}\\right)^{-1}\\left(1+\\frac{n}{\\kappa_{I}}\\right)^{-1}.\n$$\n- During balanced growth, the steady-state copy number $\\,n^{\\ast}\\,$ is defined by equality of replication and dilution, i.e., $\\,r(n^{\\ast})=\\mu\\,$.\n\nTo connect copy-number control to resistance gene dosage and host burden, assume that the per-plasmid expression of the resistance determinant yields a dimensionless dosage gain $\\,g\\,\\gt\\,0\\,$ per copy and that each plasmid imposes a dimensionless metabolic burden cost $\\,c\\,\\gt\\,0\\,$ per copy. Thus, at copy number $\\,n\\,$, the total dosage is $\\,D(n)=g\\,n\\,$ and the total burden is $\\,B(n)=c\\,n\\,$.\n\nStarting only from the statements above and standard balanced-growth bookkeeping (replication equals dilution at steady state) together with mass-action style inhibition of initiation by antisense RNA and iteron pairing, derive a closed-form expression for $\\,n^{\\ast}\\,$ in terms of $\\,\\rho\\,$, $\\,\\mu\\,$, $\\,\\kappa_{A}\\,$, and $\\,\\kappa_{I}\\,$. Then express $\\,D(n^{\\ast})\\,$ and $\\,B(n^{\\ast})\\,$ explicitly.\n\nProvide your final answer as a single row matrix $\\,\\bigl[n^{\\ast}\\;,\\;D(n^{\\ast})\\;,\\;B(n^{\\ast})\\bigr]\\,$. No units are required. Do not approximate; give exact expressions.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a simplified but standard mass-action model for plasmid copy number control, a common approach in quantitative biology. All necessary definitions and parameters are provided to establish a solvable mathematical problem. The task is to derive the steady-state plasmid copy number and related quantities from the given governing equations. The problem is therefore deemed valid and a solution will be furnished.\n\nThe steady state of the system is defined by the condition that the total rate of plasmid replication equals the total rate of plasmid loss due to dilution. The per-cell replication rate is the per-plasmid initiation rate, $r(n)$, multiplied by the number of plasmids, $n$. The per-cell dilution rate is the per-plasmid dilution rate, $\\mu$, multiplied by the number of plasmids, $n$. At steady state, with copy number $n^{\\ast}$, we have:\n$$ n^{\\ast} r(n^{\\ast}) = \\mu n^{\\ast} $$\nFor a non-trivial steady state where the plasmid is maintained in the cell population, we must have $n^{\\ast} > 0$. In this case, we can divide by $n^{\\ast}$ to obtain the condition provided in the problem statement:\n$$ r(n^{\\ast}) = \\mu $$\nSubstituting the given expression for $r(n)$:\n$$ \\rho \\left(1+\\frac{n^{\\ast}}{\\kappa_{A}}\\right)^{-1}\\left(1+\\frac{n^{\\ast}}{\\kappa_{I}}\\right)^{-1} = \\mu $$\nThis equation defines the steady-state copy number $n^{\\ast}$. For a steady-state solution to exist for $n^{\\ast} > 0$, the maximum possible replication rate must exceed the dilution rate. The replication rate $r(n)$ is a monotonically decreasing function for $n \\ge 0$. Its maximum value occurs at $n=0$, where $r(0) = \\rho$. Therefore, a necessary condition for the existence of a non-trivial steady state ($n^{\\ast} > 0$) is that $r(0) > \\mu$, which implies $\\rho > \\mu$. If this condition is not met, the plasmids are washed out faster than they can replicate, and the only steady state is the trivial one, $n^{\\ast} = 0$. The problem implicitly assumes a non-trivial steady state exists, so we proceed under the condition $\\rho > \\mu$.\n\nTo solve for $n^{\\ast}$, we rearrange the equation into a standard quadratic form.\n$$ \\frac{\\rho}{\\mu} = \\left(1+\\frac{n^{\\ast}}{\\kappa_{A}}\\right)\\left(1+\\frac{n^{\\ast}}{\\kappa_{I}}\\right) $$\nExpanding the product on the right-hand side yields:\n$$ \\frac{\\rho}{\\mu} = 1 + \\frac{n^{\\ast}}{\\kappa_{I}} + \\frac{n^{\\ast}}{\\kappa_{A}} + \\frac{(n^{\\ast})^2}{\\kappa_{A}\\kappa_{I}} $$\nWe can group terms by powers of $n^{\\ast}$ and set the equation to zero:\n$$ \\left(\\frac{1}{\\kappa_{A}\\kappa_{I}}\\right)(n^{\\ast})^2 + \\left(\\frac{1}{\\kappa_{A}} + \\frac{1}{\\kappa_{I}}\\right)n^{\\ast} + \\left(1 - \\frac{\\rho}{\\mu}\\right) = 0 $$\nTo simplify, we multiply the entire equation by $\\kappa_{A}\\kappa_{I}$:\n$$ (n^{\\ast})^2 + (\\kappa_{A} + \\kappa_{I})n^{\\ast} + \\kappa_{A}\\kappa_{I}\\left(1 - \\frac{\\rho}{\\mu}\\right) = 0 $$\nThis is a quadratic equation of the form $an^2 + bn + c = 0$ with $n=n^{\\ast}$ and coefficients:\n$a = 1$\n$b = \\kappa_{A} + \\kappa_{I}$\n$c = \\kappa_{A}\\kappa_{I}\\left(1 - \\frac{\\rho}{\\mu}\\right)$\n\nWe apply the quadratic formula to find the roots:\n$$ n^{\\ast} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\nSubstituting the coefficients:\n$$ n^{\\ast} = \\frac{-(\\kappa_{A} + \\kappa_{I}) \\pm \\sqrt{(\\kappa_{A} + \\kappa_{I})^2 - 4(1)\\left(\\kappa_{A}\\kappa_{I}\\left(1 - \\frac{\\rho}{\\mu}\\right)\\right)}}{2} $$\nLet us simplify the discriminant, $\\Delta = b^2 - 4ac$:\n$$ \\Delta = (\\kappa_{A} + \\kappa_{I})^2 - 4\\kappa_{A}\\kappa_{I} + \\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu} $$\n$$ \\Delta = (\\kappa_{A}^2 + 2\\kappa_{A}\\kappa_{I} + \\kappa_{I}^2) - 4\\kappa_{A}\\kappa_{I} + \\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu} $$\n$$ \\Delta = \\kappa_{A}^2 - 2\\kappa_{A}\\kappa_{I} + \\kappa_{I}^2 + \\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu} $$\n$$ \\Delta = (\\kappa_{A} - \\kappa_{I})^2 + \\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu} $$\nSince all parameters $\\rho, \\mu, \\kappa_{A}, \\kappa_{I}$ are positive, the discriminant $\\Delta$ is always positive. Thus, there are two distinct real roots.\n\nThe two roots for $n^{\\ast}$ are:\n$$ n^{\\ast} = \\frac{-(\\kappa_{A} + \\kappa_{I}) \\pm \\sqrt{(\\kappa_{A} - \\kappa_{I})^2 + \\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu}}}{2} $$\nAs copy number $n^{\\ast}$ must be a non-negative quantity, we must select the physically valid solution. The parameters $\\kappa_{A}$ and $\\kappa_{I}$ are positive, so the term $-(\\kappa_{A} + \\kappa_{I})$ is negative. The root with the minus sign in front of the square root will therefore certainly be negative.\nThe physically meaningful solution must be the one with the plus sign:\n$$ n^{\\ast} = \\frac{-(\\kappa_{A} + \\kappa_{I}) + \\sqrt{(\\kappa_{A} - \\kappa_{I})^2 + \\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu}}}{2} $$\nWe confirm that this root is positive under the condition $\\rho > \\mu$. The term under the square root is $(\\kappa_{A} - \\kappa_{I})^2 + \\frac{4\\rho}{\\mu}\\kappa_{A}\\kappa_{I}$. Compare this to $(\\kappa_{A} + \\kappa_{I})^2 = (\\kappa_{A} - \\kappa_{I})^2 + 4\\kappa_{A}\\kappa_{I}$. Since $\\rho > \\mu$, we have $\\frac{\\rho}{\\mu} > 1$, which implies $\\frac{4\\rho\\kappa_{A}\\kappa_{I}}{\\mu} > 4\\kappa_{A}\\kappa_{I}$. Therefore, the term under the square root is greater than $(\\kappa_{A} + \\kappa_{I})^2$, and its square root is greater than $(\\kappa_{A} + \\kappa_{I})$. This guarantees that the numerator is positive, and thus $n^{\\ast} > 0$.\n\nHaving obtained the expression for $n^{\\ast}$, we can now find the total dosage, $D(n^{\\ast})$, and the total burden, $B(n^{\\ast})$:\n$$ D(n^{\\ast}) = g n^{\\ast} = g \\left( \\frac{\\sqrt{(\\kappa_{A}-\\kappa_{I})^2 + \\frac{4\\rho\\kappa_A\\kappa_I}{\\mu}} - (\\kappa_{A}+\\kappa_{I})}{2} \\right) $$\n$$ B(n^{\\ast}) = c n^{\\ast} = c \\left( \\frac{\\sqrt{(\\kappa_{A}-\\kappa_{I})^2 + \\frac{4\\rho\\kappa_A\\kappa_I}{\\mu}} - (\\kappa_{A}+\\kappa_{I})}{2} \\right) $$\nThese are the required closed-form expressions. The final result is presented as a row matrix as requested.", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{\\sqrt{(\\kappa_A-\\kappa_I)^{2} + \\frac{4\\rho\\kappa_A\\kappa_I}{\\mu}} - (\\kappa_A+\\kappa_I)}{2} & g\\left(\\frac{\\sqrt{(\\kappa_A-\\kappa_I)^{2} + \\frac{4\\rho\\kappa_A\\kappa_I}{\\mu}} - (\\kappa_A+\\kappa_I)}{2}\\right) & c\\left(\\frac{\\sqrt{(\\kappa_A-\\kappa_I)^{2} + \\frac{4\\rho\\kappa_A\\kappa_I}{\\mu}} - (\\kappa_A+\\kappa_I)}{2}\\right) \\end{pmatrix}} $$", "id": "2831703"}, {"introduction": "Having established itself within a cell, a plasmid's evolutionary success hinges on its ability to transfer to new hosts faster than it is lost. This practice [@problem_id:2831708] guides you through the construction of a compartmental model for plasmid epidemiology, a cornerstone of modeling infectious agents. You will derive the basic reproduction number ($R_0$) using the next-generation matrix method, a powerful technique for determining the invasion threshold for any transmissible element.", "problem": "In a well-mixed bacterial population, consider three compartments corresponding to plasmid epidemiology: donors $D$ (cells that carry a conjugative resistance plasmid and can transfer it), recipients $R$ (plasmid-free cells), and transconjugants $T$ (cells that have newly acquired the plasmid by conjugation and can themselves transfer it). Assume the following foundational biological principles hold:\n- Logistic population regulation: each cell type contributes to a total population $N$ with logistic limitation at carrying capacity $K$. Plasmid-free cells have per capita birth rate $b$, while plasmid-bearing cells (both $D$ and $T$) have a fitness cost $c$ so their per capita birth rate is $b(1-c)$, with $0 \\le c < 1$. All cells have an identical per capita natural death rate $m$.\n- Mass-action conjugation: donor–recipient and transconjugant–recipient encounters occur at mass-action rates with constants $\\beta_D$ and $\\beta_T$, respectively, each event converting one $R$ into one $T$.\n- Plasmid segregation loss: plasmid-bearing cells can lose the plasmid at per capita rates $\\sigma_D$ (for $D$) and $\\sigma_T$ (for $T$), converting to $R$.\n- No other transitions occur: $D$ and $T$ do not interconvert by conjugation; all conjugation converts $R$ to $T$.\n\nStarting only from the above principles and the definitions of mass-action kinetics and logistic growth, perform the following:\n1. Derive a minimal closed ordinary differential equation (ODE) system for the dynamics of $D(t)$, $R(t)$, and $T(t)$, clearly justifying each term based on the stated principles.\n2. Identify the plasmid-free equilibrium (commonly called the disease-free equilibrium (DFE)) in which $D=0$ and $T=0$, and determine $R^{\\ast}$ in terms of $b$, $m$, and $K$, including the condition for its biological feasibility.\n3. Using the next-generation matrix construction for compartmental infection models, define the vector of infected compartments, decompose the linearized system at the DFE into the form $\\dot{x} = F x - V x$ where $F$ contains terms corresponding to the appearance of new plasmid infections and $V$ contains all other transitions and losses among infected compartments, and derive the basic reproduction number $R_0$ (the basic reproduction number) as the spectral radius of $F V^{-1}$.\n4. Express your final answer for $R_0$ as a single closed-form expression in terms of $b$, $c$, $m$, $\\sigma_D$, $\\sigma_T$, $\\beta_D$, $\\beta_T$, and $K$ only. Do not substitute numerical values. Your final answer must be a single analytical expression. Do not include any units. Do not round.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a standard compartmental model in mathematical biology, and the tasks required are based on established analytical techniques. The problem is valid.\n\nThe solution is developed in four parts as requested.\n\nPart 1: Derivation of the Ordinary Differential Equation (ODE) System\n\nThe system models the population dynamics of three compartments: Donors ($D$), Recipients ($R$), and Transconjugants ($T$). The total population is $N(t) = D(t) + R(t) + T(t)$. The dynamics are governed by logistic growth, natural death, plasmid conjugation, and plasmid segregation. We construct the rate equation for each compartment by summing the rates of all processes that increase or decrease its population.\n\n1.  Rate of change of Donors, $\\frac{dD}{dt}$:\n    -   Birth: Plasmid-bearing cells, including Donors, have a per capita birth rate of $b(1-c)$, subject to logistic limitation with carrying capacity $K$. The growth term is $b(1-c) D \\left(1 - \\frac{N}{K}\\right)$.\n    -   Death: All cells have a per capita natural death rate of $m$. The loss term is $-m D$.\n    -   Plasmid Segregation: Donors lose plasmids at a per capita rate of $\\sigma_D$, becoming Recipients. The loss term is $-\\sigma_D D$.\n    -   Conjugation: According to the problem, Donors act to convert Recipients to Transconjugants. They are not created or lost in this process, and no new Donors are formed via conjugation.\n    Combining these terms, the ODE for $D$ is:\n    $$ \\frac{dD}{dt} = b(1-c) D \\left(1 - \\frac{D+R+T}{K}\\right) - m D - \\sigma_D D $$\n\n2.  Rate of change of Recipients, $\\frac{dR}{dt}$:\n    -   Birth: Plasmid-free Recipient cells have a per capita birth rate of $b$, with logistic limitation. The growth term is $b R \\left(1 - \\frac{N}{K}\\right)$.\n    -   Death: The loss term due to natural death is $-m R$.\n    -   Gain from Segregation: Recipients are formed when Donors and Transconjugants lose their plasmids, at rates $\\sigma_D D$ and $\\sigma_T T$ respectively. The gain term is $+\\sigma_D D + \\sigma_T T$.\n    -   Loss to Conjugation: Recipients are converted to Transconjugants upon contact with Donors or Transconjugants. These events occur at mass-action rates $\\beta_D D R$ and $\\beta_T T R$. The loss term is $-\\beta_D D R - \\beta_T T R$.\n    Combining these terms, the ODE for $R$ is:\n    $$ \\frac{dR}{dt} = b R \\left(1 - \\frac{D+R+T}{K}\\right) - m R + \\sigma_D D + \\sigma_T T - (\\beta_D D + \\beta_T T)R $$\n\n3.  Rate of change of Transconjugants, $\\frac{dT}{dt}$:\n    -   Birth: As plasmid-bearing cells, Transconjugants have a per capita birth rate of $b(1-c)$, with logistic limitation. The growth term is $b(1-c) T \\left(1 - \\frac{N}{K}\\right)$.\n    -   Death: The loss term due to natural death is $-m T$.\n    -   Plasmid Segregation: Transconjugants lose plasmids at a per capita rate of $\\sigma_T$, becoming Recipients. The loss term is $-\\sigma_T T$.\n    -   Gain from Conjugation: Transconjugants are created from Recipients through conjugation with both Donors and Transconjugants. The gain term is $+\\beta_D D R + \\beta_T T R$.\n    Combining these terms, the ODE for $T$ is:\n    $$ \\frac{dT}{dt} = b(1-c) T \\left(1 - \\frac{D+R+T}{K}\\right) - m T - \\sigma_T T + (\\beta_D D + \\beta_T T)R $$\n\nThe complete, closed ODE system is:\n$$ \\frac{dD}{dt} = D \\left[ b(1-c) \\left(1 - \\frac{D+R+T}{K}\\right) - m - \\sigma_D \\right] $$\n$$ \\frac{dR}{dt} = R \\left[ b \\left(1 - \\frac{D+R+T}{K}\\right) - m \\right] + \\sigma_D D + \\sigma_T T - (\\beta_D D + \\beta_T T)R $$\n$$ \\frac{dT}{dt} = T \\left[ b(1-c) \\left(1 - \\frac{D+R+T}{K}\\right) - m - \\sigma_T \\right] + (\\beta_D D + \\beta_T T)R $$\n\nPart 2: Plasmid-Free Equilibrium (DFE)\n\nThe plasmid-free equilibrium (PFE), or disease-free equilibrium (DFE), is a steady state where no plasmids are present in the population. We find this state by setting $D=0$, $T=0$, and $\\frac{dD}{dt}=\\frac{dR}{dt}=\\frac{dT}{dt}=0$.\nWith $D=0$ and $T=0$, the equations for $D$ and $T$ are trivially satisfied. The equation for $R$ becomes:\n$$ \\frac{dR}{dt} = b R \\left(1 - \\frac{R}{K}\\right) - m R = 0 $$\nFactoring out $R$, we get:\n$$ R \\left[ b \\left(1 - \\frac{R}{K}\\right) - m \\right] = 0 $$\nThis equation has two solutions for $R$: the trivial solution $R=0$ (total population extinction) and the non-trivial solution found by setting the bracketed term to zero:\n$$ b \\left(1 - \\frac{R}{K}\\right) - m = 0 $$\n$$ 1 - \\frac{R}{K} = \\frac{m}{b} $$\n$$ \\frac{R}{K} = 1 - \\frac{m}{b} = \\frac{b-m}{b} $$\nSolving for $R$ gives the equilibrium recipient population size, denoted $R^{\\ast}$:\n$$ R^{\\ast} = K \\left(1 - \\frac{m}{b}\\right) = K \\frac{b-m}{b} $$\nFor this equilibrium to be biologically feasible, the population size must be positive, i.e., $R^{\\ast} > 0$. This requires $b-m > 0$, or $b > m$. The per capita birth rate must exceed the per capita death rate for the plasmid-free population to persist.\nThe DFE is thus given by the state $(D, R, T) = (0, R^{\\ast}, 0) = \\left(0, K\\frac{b-m}{b}, 0\\right)$.\n\nPart 3: Next-Generation Matrix Construction\n\nWe use the next-generation matrix (NGM) method to find the basic reproduction number, $R_0$. The infected compartments are those carrying the plasmid, so the state vector of infected compartments is $x = (D, T)^T$.\nThe dynamics of the infected compartments can be written as $\\dot{x} = \\mathcal{F}(x) - \\mathcal{V}(x)$, where $\\mathcal{F}$ is the rate of appearance of new infections and $\\mathcal{V}$ is the rate of all other transitions (growth, death, recovery).\n\nThe terms corresponding to the creation of new plasmid-carrying cells (new infections) are those from conjugation. Since all conjugation events produce Transconjugants, new infections only appear in the $T$ compartment.\n$$ \\mathcal{F} = \\begin{pmatrix} \\mathcal{F}_D \\\\ \\mathcal{F}_T \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ (\\beta_D D + \\beta_T T)R \\end{pmatrix} $$\nThe remaining terms constitute the transitions part, $\\mathcal{V}$:\n$$ \\mathcal{V} = \\begin{pmatrix} \\mathcal{V}_D \\\\ \\mathcal{V}_T \\end{pmatrix} = \\begin{pmatrix} -D \\left[ b(1-c) \\left(1 - \\frac{D+R+T}{K}\\right) - m - \\sigma_D \\right] \\\\ -T \\left[ b(1-c) \\left(1 - \\frac{D+R+T}{K}\\right) - m - \\sigma_T \\right] \\end{pmatrix} $$\nThe matrices $F$ and $V$ are the Jacobians of $\\mathcal{F}$ and $\\mathcal{V}$ with respect to the infected variables $(D, T)$, evaluated at the DFE $(0, R^{\\ast}, 0)$.\n\nThe matrix $F$ is:\n$$ F = \\left. \\begin{pmatrix} \\frac{\\partial \\mathcal{F}_D}{\\partial D} & \\frac{\\partial \\mathcal{F}_D}{\\partial T} \\\\ \\frac{\\partial \\mathcal{F}_T}{\\partial D} & \\frac{\\partial \\mathcal{F}_T}{\\partial T} \\end{pmatrix} \\right|_{(0,R^{\\ast},0)} = \\left. \\begin{pmatrix} 0 & 0 \\\\ \\beta_D R & \\beta_T R \\end{pmatrix} \\right|_{(0,R^{\\ast},0)} = \\begin{pmatrix} 0 & 0 \\\\ \\beta_D R^{\\ast} & \\beta_T R^{\\ast} \\end{pmatrix} $$\nThe matrix $V$ is:\n$$ V = \\left. \\begin{pmatrix} \\frac{\\partial \\mathcal{V}_D}{\\partial D} & \\frac{\\partial \\mathcal{V}_D}{\\partial T} \\\\ \\frac{\\partial \\mathcal{V}_T}{\\partial D} & \\frac{\\partial \\mathcal{V}_T}{\\partial T} \\end{pmatrix} \\right|_{(0,R^{\\ast},0)} $$\nLet's compute the partial derivatives of $\\mathcal{V}$:\n$\\frac{\\partial \\mathcal{V}_D}{\\partial D} = -\\left[ b(1-c) \\left(1-\\frac{D+R+T}{K}\\right) - m - \\sigma_D \\right] - D \\left[ b(1-c)\\left(-\\frac{1}{K}\\right) \\right]$.\nAt the DFE: $\\frac{\\partial \\mathcal{V}_D}{\\partial D} = -\\left[ b(1-c) \\left(1-\\frac{R^{\\ast}}{K}\\right) - m - \\sigma_D \\right]$. Since $1-\\frac{R^{\\ast}}{K} = \\frac{m}{b}$, this simplifies to $-\\left[ b(1-c)\\frac{m}{b} - m - \\sigma_D \\right] = -[m(1-c) - m - \\sigma_D] = -[-mc - \\sigma_D] = \\sigma_D + mc$.\n$\\frac{\\partial \\mathcal{V}_D}{\\partial T} = -D \\left[ b(1-c)\\left(-\\frac{1}{K}\\right) \\right]$. At the DFE, $D=0$, so $\\frac{\\partial \\mathcal{V}_D}{\\partial T} = 0$.\nBy symmetry, the derivatives for $\\mathcal{V}_T$ are analogous:\n$\\frac{\\partial \\mathcal{V}_T}{\\partial T} = \\sigma_T + mc$.\n$\\frac{\\partial \\mathcal{V}_T}{\\partial D} = 0$.\nSo the matrix $V$ is:\n$$ V = \\begin{pmatrix} \\sigma_D + mc & 0 \\\\ 0 & \\sigma_T + mc \\end{pmatrix} $$\n\nPart 4: Derivation of the Basic Reproduction Number $R_0$\n\n$R_0$ is the spectral radius of the next-generation matrix $K_L = FV^{-1}$. First, we find the inverse of $V$:\n$$ V^{-1} = \\begin{pmatrix} \\frac{1}{\\sigma_D + mc} & 0 \\\\ 0 & \\frac{1}{\\sigma_T + mc} \\end{pmatrix} $$\nThis inverse is well-defined provided the diagonal entries of $V$ are non-zero. Since $m>0$ is required for a stable DFE, and $c, \\sigma_D, \\sigma_T \\ge 0$, the denominators are positive.\n\nNow, we compute $K_L$:\n$$ K_L = FV^{-1} = \\begin{pmatrix} 0 & 0 \\\\ \\beta_D R^{\\ast} & \\beta_T R^{\\ast} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sigma_D + mc} & 0 \\\\ 0 & \\frac{1}{\\sigma_T + mc} \\end{pmatrix} $$\n$$ K_L = \\begin{pmatrix} 0 & 0 \\\\ \\frac{\\beta_D R^{\\ast}}{\\sigma_D + mc} & \\frac{\\beta_T R^{\\ast}}{\\sigma_T + mc} \\end{pmatrix} $$\n$R_0$ is the largest absolute eigenvalue of $K_L$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(K_L - \\lambda I)=0$:\n$$ \\det \\begin{pmatrix} -\\lambda & 0 \\\\ \\frac{\\beta_D R^{\\ast}}{\\sigma_D + mc} & \\frac{\\beta_T R^{\\ast}}{\\sigma_T + mc} - \\lambda \\end{pmatrix} = (-\\lambda)\\left(\\frac{\\beta_T R^{\\ast}}{\\sigma_T + mc} - \\lambda\\right) = 0 $$\nThe eigenvalues are $\\lambda_1=0$ and $\\lambda_2 = \\frac{\\beta_T R^{\\ast}}{\\sigma_T + mc}$. Since all parameters are non-negative, the spectral radius is $\\rho(K_L) = \\lambda_2$.\n$$ R_0 = \\frac{\\beta_T R^{\\ast}}{\\sigma_T + mc} $$\nThis result signifies that the capacity of the plasmid to invade is determined by the reproductive fitness of the transconjugants ($T$) alone, as they are the only self-replenishing infectious class.\n\nFinally, we substitute the expression for $R^{\\ast} = K\\frac{b-m}{b}$ to obtain the final form of $R_0$:\n$$ R_0 = \\frac{\\beta_T \\left(K\\frac{b-m}{b}\\right)}{\\sigma_T + mc} = \\frac{\\beta_T K (b-m)}{b(\\sigma_T + mc)} $$", "answer": "$$\\boxed{\\frac{\\beta_T K (b-m)}{b(\\sigma_T + mc)}}$$", "id": "2831708"}, {"introduction": "Real-world transmission of resistance does not occur in a well-mixed soup but across structured contact networks, such as patients moving between hospital wards. This exercise [@problem_id:2831788] bridges the gap between population dynamics and network science to model plasmid spread in a metapopulation. By constructing a network-based model, you will compute key epidemiological metrics and discover how the architecture of a contact network fundamentally shapes outbreak potential and the large-scale dissemination of R plasmids.", "problem": "You are to formalize the early-phase spread of Resistance plasmids (R plasmids) in a hospital system as a network-coupled process and compute network metrics that predict invasion and outbreak potential. The setting is a metapopulation across wards and hospitals in which patients move or are co-located, creating opportunities for conjugation-driven transfer of R plasmids. You must implement the following model and metrics from first principles and compute results on a provided test suite.\n\nAssumptions and foundational base. Conjugative plasmid transfer is a contact-driven process between bacterial hosts. At low prevalence, the early-phase dynamics of a Susceptible-Infected-Susceptible (SIS) type process with plasmid loss can be linearized around the plasmid-free state. Let $C$ be a nonnegative, symmetric, weighted contact matrix in which $C_{ij}$ represents the effective contact intensity between locations $i$ and $j$ after accounting for ward structure. Let $\\beta$ be the per-contact effective conjugation rate and $\\gamma$ be the per-capita effective loss rate of the plasmid lineage (for example, segregation loss or negative selection in the absence of antibiotics). Linearization yields early growth governed by the Jacobian $J = \\beta C - \\gamma I$, where $I$ is the identity matrix. The invasion threshold is determined by the sign of the dominant eigenvalue of $J$, which equivalently reduces to the basic reproduction number $R_0 = (\\beta/\\gamma)\\,\\lambda_{\\max}(C)$, where $\\lambda_{\\max}(C)$ is the spectral radius of $C$. If $R_0 \\leq 1$, invasion fails; if $R_0 &gt; 1$, invasion is possible. Under a Poisson offspring approximation to a multitype branching process, a conservative and widely used approximation to the probability of a major outbreak from a single initial introduction is $P_{\\mathrm{major}} = \\max\\{0,\\, 1 - 1/R_0\\}$.\n\nWard-structured contacts. Let $A$ be a base, symmetric, nonnegative adjacency matrix describing potential contact or transfer opportunities, and let $w(i)$ map node $i$ to its ward label. Define two positive multipliers: $c_{\\mathrm{w}}$ for within-ward amplification of effective contact and $c_{\\mathrm{b}}$ for between-ward attenuation of effective contact. Construct the effective contact matrix $C$ by\n$$\nC_{ij} =\n\\begin{cases}\nc_{\\mathrm{w}}\\,A_{ij}, & \\text{if } w(i) = w(j),\\\\\nc_{\\mathrm{b}}\\,A_{ij}, & \\text{if } w(i) \\neq w(j).\n\\end{cases}\n$$\nAll diagonals satisfy $C_{ii} = 0$.\n\nNetwork metrics to compute. For each test case, compute:\n- The spectral radius $\\lambda_{\\max}(C)$.\n- The basic reproduction number $R_0 = (\\beta/\\gamma)\\,\\lambda_{\\max}(C)$.\n- The major outbreak probability $P_{\\mathrm{major}} = \\max\\{0,\\, 1 - 1/R_0\\}$ if $R_0 &gt; 1$, else $0$.\n- The average node strength $\\bar{s} = \\frac{1}{n}\\sum_{i=1}^{n}\\sum_{j=1}^{n} C_{ij}$, where $n$ is the number of nodes.\n- The intra-ward weight fraction\n$$\nF_{\\mathrm{intra}} = \\frac{\\sum_{i\\neq j,\\; w(i)=w(j)} C_{ij}}{\\sum_{i\\neq j} C_{ij}},\n$$\nexpressed as a decimal (not a percentage).\n\nNumerical and output requirements. Your program must:\n- Implement the constructions and metrics above exactly as specified.\n- For the outbreak probability, use the convention $P_{\\mathrm{major}}=0$ whenever $R_0 \\leq 1$.\n- Round each reported floating-point result to exactly six digits after the decimal point.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case yields a list in the order $[R_0, P_{\\mathrm{major}}, \\lambda_{\\max}, \\bar{s}, F_{\\mathrm{intra}}]$.\n\nTest suite. Use the following three test cases without alteration. All numbers are given as exact values.\n\nTest case $1$ (heterogeneous $2$-ward hospital with cross-ward bridges):\n- Base adjacency\n$$\nA = \\begin{bmatrix}\n0 & 1.0 & 0.5 & 0 & 0\\\\\n1.0 & 0 & 1.0 & 0.1 & 0\\\\\n0.5 & 1.0 & 0 & 0.2 & 0.1\\\\\n0 & 0.1 & 0.2 & 0 & 1.0\\\\\n0 & 0 & 0.1 & 1.0 & 0\n\\end{bmatrix}.\n$$\n- Ward labels $w = [0,\\,0,\\,0,\\,1,\\,1]$.\n- Parameters: $\\beta = 0.6$, $\\gamma = 0.3$, $c_{\\mathrm{w}} = 2.0$, $c_{\\mathrm{b}} = 0.5$.\n\nTest case $2$ (two wards, single inter-ward link at threshold):\n- Base adjacency\n$$\nA = \\begin{bmatrix}\n0 & 1\\\\\n1 & 0\n\\end{bmatrix}.\n$$\n- Ward labels $w = [0,\\,1]$.\n- Parameters: $\\beta = 0.2$, $\\gamma = 0.2$, $c_{\\mathrm{w}} = 1.0$, $c_{\\mathrm{b}} = 1.0$.\n\nTest case $3$ (strongly modular $2$-ward hospital, dense intra-ward, sparse inter-ward):\n- Base adjacency $A$ on $6$ nodes with two cliques of size $3$ and all cross-ward edges present:\nFor nodes $0,1,2$ in ward $0$ and nodes $3,4,5$ in ward $1$, set $A_{ij} = 1.0$ if $i \\neq j$ and both $i,j \\in \\{0,1,2\\}$ or both $i,j \\in \\{3,4,5\\}$; set $A_{ij} = 0.05$ if $i \\in \\{0,1,2\\}$ and $j \\in \\{3,4,5\\}$ or vice versa; set $A_{ii}=0$.\n- Ward labels $w = [0,\\,0,\\,0,\\,1,\\,1,\\,1]$.\n- Parameters: $\\beta = 0.08$, $\\gamma = 0.4$, $c_{\\mathrm{w}} = 2.0$, $c_{\\mathrm{b}} = 0.5$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case in the order $1$, $2$, $3$, and each element is itself a list in the order $[R_0, P_{\\mathrm{major}}, \\lambda_{\\max}, \\bar{s}, F_{\\mathrm{intra}}]$, with each float rounded to exactly six digits after the decimal point. For example: $[[0.123456,0.000000,0.987654,0.543210,0.333333],[\\dots],[\\dots]]$.", "solution": "The problem presented is a well-defined exercise in mathematical biology, specifically modeling the epidemiological dynamics of antibiotic resistance spread. It is scientifically grounded, internally consistent, and computationally tractable. All required parameters, matrices, and functional forms for the metrics are provided unambiguously. Therefore, the problem is valid, and a solution will be derived.\n\nThe core of the problem is to construct a ward-structured effective contact matrix, $C$, and then compute several network and epidemiological metrics based on it. The process is deterministic once the initial parameters are specified. We will proceed step-by-step for each test case as demanded.\n\nThe anlaysis begins with the construction of the effective contact matrix $C$ from a given base adjacency matrix $A$, a vector of ward assignments $w$, and two parameters: $c_{\\mathrm{w}}$ for intra-ward contact amplification and $c_{\\mathrm{b}}$ for inter-ward contact attenuation. The formula is given as:\n$$\nC_{ij} =\n\\begin{cases}\nc_{\\mathrm{w}}\\,A_{ij}, & \\text{if } w(i) = w(j) \\text{ and } i \\neq j, \\\\\nc_{\\mathrm{b}}\\,A_{ij}, & \\text{if } w(i) \\neq w(j) \\text{ and } i \\neq j, \\\\\n0, & \\text{if } i = j.\n\\end{cases}\n$$\nThis matrix $C$ is symmetric and non-negative, as required.\n\nOnce $C$ is constructed, we compute the five specified metrics:\n1.  **Spectral Radius, $\\lambda_{\\max}(C)$**: As $C$ is a non-negative real symmetric matrix, its spectral radius is its largest eigenvalue. We compute the eigenvalues of $C$ and take the maximum. This metric quantifies the maximal rate of infectious transmission amplification by the contact network.\n\n2.  **Basic Reproduction Number, $R_0$**: This is defined as $R_0 = (\\beta/\\gamma)\\,\\lambda_{\\max}(C)$, where $\\beta$ is the effective conjugation rate and $\\gamma$ is the plasmid loss rate. $R_0 > 1$ is the condition for an invasion to be possible.\n\n3.  **Major Outbreak Probability, $P_{\\mathrm{major}}$**: Based on a branching process approximation, this is given by $P_{\\mathrm{major}} = \\max\\{0, 1 - 1/R_0\\}$. The problem specifies that if $R_0 \\le 1$, $P_{\\mathrm{major}}$ must be $0$.\n\n4.  **Average Node Strength, $\\bar{s}$**: This is the arithmetic mean of the total weighted contacts for each node, calculated as $\\bar{s} = \\frac{1}{n}\\sum_{i=1}^{n}\\sum_{j=1}^{n} C_{ij}$, where $n$ is the number of nodes.\n\n5.  **Intra-ward Weight Fraction, $F_{\\mathrm{intra}}$**: This quantifies the degree of modularity in the contact structure. It is the fraction of total contact weight that occurs between nodes within the same ward: $F_{\\mathrm{intra}} = \\frac{\\sum_{i\\neq j,\\; w(i)=w(j)} C_{ij}}{\\sum_{i\\neq j} C_{ij}}$. Since $C_{ii}=0$, the denominator is simply the sum of all elements in $C$.\n\nWe will now apply this procedure to each of the three test cases.\n\n**Test Case 1:**\n- Nodes: $n=5$. Parameters: $\\beta = 0.6$, $\\gamma = 0.3$, $c_{\\mathrm{w}} = 2.0$, $c_{\\mathrm{b}} = 0.5$.\n- Ward labels $w = [0, 0, 0, 1, 1]$.\n- Applying the multipliers to the base adjacency matrix $A$ yields the contact matrix $C$:\n$$\nC_1 = \\begin{bmatrix}\n0 & 2.0 & 1.0 & 0 & 0 \\\\\n2.0 & 0 & 2.0 & 0.05 & 0 \\\\\n1.0 & 2.0 & 0 & 0.1 & 0.05 \\\\\n0 & 0.05 & 0.1 & 0 & 2.0 \\\\\n0 & 0 & 0.05 & 2.0 & 0\n\\end{bmatrix}\n$$\n- Computation yields:\n    - $\\lambda_{\\max}(C_1) \\approx 3.013533$\n    - $R_0 = (0.6/0.3) \\times \\lambda_{\\max}(C_1) = 2 \\times 3.013533 \\approx 6.027067$\n    - $P_{\\mathrm{major}} = 1 - 1/R_0 \\approx 1 - 1/6.027067 \\approx 0.834080$\n    - $\\sum C_{1,ij} = 14.4$. $\\bar{s} = 14.4 / 5 = 2.88$\n    - $\\sum_{\\text{intra}} C_{1,ij} = 2.0 \\times (1.0+0.5+1.0+1.0) \\times 2 = 14.0$. $F_{\\mathrm{intra}} = 14.0 / 14.4 \\approx 0.972222$\n\n**Test Case 2:**\n- Nodes: $n=2$. Parameters: $\\beta = 0.2$, $\\gamma = 0.2$, $c_{\\mathrm{w}} = 1.0$, $c_{\\mathrm{b}} = 1.0$.\n- Ward labels $w = [0, 1]$. The single link is between wards.\n- The contact matrix is $C_2 = \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$.\n- Computation yields:\n    - $\\lambda_{\\max}(C_2) = 1.0$ (exact).\n    - $R_0 = (0.2/0.2) \\times 1.0 = 1.0$.\n    - $P_{\\mathrm{major}} = 0$, since $R_0 \\le 1$.\n    - $\\sum C_{2,ij} = 2.0$. $\\bar{s} = 2.0 / 2 = 1.0$.\n    - $\\sum_{\\text{intra}} C_{2,ij} = 0$. $F_{\\mathrm{intra}} = 0 / 2.0 = 0.0$.\n\n**Test Case 3:**\n- Nodes: $n=6$. Parameters: $\\beta = 0.08$, $\\gamma = 0.4$, $c_{\\mathrm{w}} = 2.0$, $c_{\\mathrm{b}} = 0.5$.\n- Ward labels $w = [0, 0, 0, 1, 1, 1]$.\n- The structure is two 3-cliques (within-ward) and all-to-all connections between them (between-ward).\n- The contact matrix $C_3$ consists of two diagonal blocks with off-diagonal entries of $c_{\\mathrm{w}} \\times 1.0 = 2.0$, and two off-diagonal blocks with all entries $c_{\\mathrm{b}} \\times 0.05 = 0.025$.\n- This matrix corresponds to a weighted regular graph where every node has the same strength: $s_i = 2 \\times 2.0 + 3 \\times 0.025 = 4.075$.\n- For a regular graph, the spectral radius is equal to the common node strength.\n- Computation yields:\n    - $\\lambda_{\\max}(C_3) = 4.075$ (exact).\n    - $R_0 = (0.08/0.4) \\times 4.075 = 0.2 \\times 4.075 = 0.815$.\n    - $P_{\\mathrm{major}} = 0$, since $R_0 \\le 1$.\n    - $\\bar{s} = (\\sum s_i)/n = (6 \\times 4.075) / 6 = 4.075$.\n    - $\\sum C_{3,ij} = 6 \\times 4.075 = 24.45$. $\\sum_{\\text{intra}} C_{3,ij} = 2 \\times (3 \\times 2 \\times 2.0) = 24.0$. $F_{\\mathrm{intra}} = 24.0 / 24.45 \\approx 0.981595$.\n\nThe following program implements this logic precisely and produces the required output.", "answer": "[[6.027067,0.834080,3.013533,2.880000,0.972222],[1.000000,0.000000,1.000000,1.000000,0.000000],[0.815000,0.000000,4.075000,4.075000,0.981595]]", "id": "2831788"}]}