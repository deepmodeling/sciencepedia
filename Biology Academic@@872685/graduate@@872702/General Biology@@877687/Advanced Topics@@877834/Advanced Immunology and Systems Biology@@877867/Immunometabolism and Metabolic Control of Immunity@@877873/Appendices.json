{"hands_on_practices": [{"introduction": "At the heart of immunometabolism lies the cell's energy budget. This exercise grounds the abstract concept of metabolic programming in concrete, quantitative terms by asking you to calculate the glucose required to meet a fixed ATP demand under different metabolic scenarios [@problem_id:2808683]. By comparing a purely oxidative program with a mixed glycolytic/oxidative one, you will gain a tangible appreciation for the efficiency trade-offs inherent in the metabolic choices an immune cell makes.", "problem": "An activated cytotoxic T lymphocyte maintains a constant adenosine triphosphate (ATP) hydrolysis rate of $R_{\\mathrm{ATP}} = 1.00 \\times 10^{9}$ ATP molecules per second per cell. Glucose is the only carbon source. You will estimate the minimal glucose uptake rate required to meet this ATP demand under two metabolic programs relevant to immunometabolism.\n\nBiochemical bases to use:\n- Glycolysis yields a net of $2$ ATP per glucose via substrate-level phosphorylation in the cytosol.\n- Complete oxidation of $1$ glucose to $\\mathrm{CO}_{2}$ yields reducing equivalents as follows: $2$ cytosolic nicotinamide adenine dinucleotide (NADH) from glycolysis, $2$ mitochondrial NADH from pyruvate dehydrogenase, $6$ mitochondrial NADH and $2$ mitochondrial flavin adenine dinucleotide (FADH$_{2}$) from the tricarboxylic acid (TCA) cycle, and $2$ ATP equivalents from TCA cycle substrate-level phosphorylation (guanosine triphosphate).\n- The mitochondrial phosphorylation-to-oxygen ratio is $P/O = 2.5$ for NADH and $1.5$ for FADH$_{2}$. Cytosolic NADH is reoxidized via the malate–aspartate shuttle without loss, yielding the same $P/O$ as mitochondrial NADH.\n- For the purpose of attributing ATP shares by mechanism, define “glycolytic ATP” as ATP made by cytosolic glycolytic substrate-level phosphorylation, and group all other ATP (oxidative phosphorylation plus mitochondrial substrate-level phosphorylation) into the “oxidative phosphorylation (OXPHOS)-associated” pool.\n\nTwo metabolic programs:\n1) Pure oxidative phosphorylation program: all glucose taken up is fully oxidized to $\\mathrm{CO}_{2}$.\n2) Mixed program: the cell enforces that a fraction $0.70$ of total ATP production arises from glycolytic substrate-level phosphorylation, and a fraction $0.30$ arises from the OXPHOS-associated pool. Assume the fraction of glucose routed to the OXPHOS-associated pool is fully oxidized, while the remainder is reduced to lactate to maintain redox balance.\n\nTasks:\n- Starting from the biochemical bases above, derive the ATP yield per glucose under full oxidation and under the mixed program constraint.\n- Compute the minimal glucose uptake rates $v_{\\mathrm{glc,OX}}$ (pure oxidative phosphorylation program) and $v_{\\mathrm{glc,mix}}$ (mixed program) required to meet $R_{\\mathrm{ATP}}$.\n- Express both uptake rates in molecules per second per cell.\n- Round each result to four significant figures.\n\nProvide your final answer as a row matrix $\\begin{pmatrix} v_{\\mathrm{glc,OX}} & v_{\\mathrm{glc,mix}} \\end{pmatrix}$.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It provides all necessary information for a unique solution based on established principles of biochemistry. Therefore, I will proceed with a full derivation of the solution.\n\nThe central task is to determine the glucose uptake rate, $v_{\\mathrm{glc}}$, required to sustain a constant rate of ATP hydrolysis, $R_{\\mathrm{ATP}}$, under two distinct metabolic scenarios. The relationship is given by:\n$$v_{\\mathrm{glc}} = \\frac{R_{\\mathrm{ATP}}}{Y_{\\mathrm{ATP}}}$$\nwhere $Y_{\\mathrm{ATP}}$ is the yield of ATP molecules per molecule of glucose for a given metabolic program.\n\nFirst, we must calculate the ATP yield for the complete oxidation of one molecule of glucose. This serves as the basis for both scenarios. Let us denote this yield as $Y_{\\mathrm{ATP,OX}}$. We sum the contributions from substrate-level phosphorylation (SLP) and oxidative phosphorylation (OXPHOS).\n\nThe stoichiometry for the complete oxidation of $1$ molecule of glucose is as follows:\n1.  **Glycolysis**: Produces a net of $2$ ATP via SLP and $2$ cytosolic NADH.\n2.  **Pyruvate Dehydrogenase Complex**: Converts $2$ pyruvate to $2$ acetyl-CoA, producing $2$ mitochondrial NADH.\n3.  **Tricarboxylic Acid (TCA) Cycle**: For $2$ turns (from $1$ glucose), produces $2$ GTP (equivalent to $2$ ATP) via SLP, $6$ mitochondrial NADH, and $2$ mitochondrial FADH$_{2}$.\n\nThe total count of reducing equivalents is:\n- Total NADH = $2$ (glycolysis) $+ 2$ (PDH) $+ 6$ (TCA) = $10$ NADH.\n- Total FADH$_{2}$ = $2$ (TCA).\n\nThe problem specifies the phosphorylation-to-oxygen ($P/O$) ratios are $2.5$ for NADH and $1.5$ for FADH$_{2}$. It is also given that cytosolic NADH is reoxidized via the malate-aspartate shuttle without energy loss, thus yielding the same amount of ATP as mitochondrial NADH.\n\nThe ATP produced from OXPHOS is:\n$$Y_{\\mathrm{OXPHOS}} = (10 \\text{ NADH} \\times 2.5 \\frac{\\text{ATP}}{\\text{NADH}}) + (2 \\text{ FADH}_2 \\times 1.5 \\frac{\\text{ATP}}{\\text{FADH}_2}) = 25 \\text{ ATP} + 3 \\text{ ATP} = 28 \\text{ ATP}$$\n\nThe total ATP yield from complete oxidation, $Y_{\\mathrm{ATP,OX}}$, is the sum of ATP from SLP and OXPHOS:\n$$Y_{\\mathrm{ATP,OX}} = (\\text{ATP from Glycolysis SLP}) + (\\text{ATP from TCA SLP}) + Y_{\\mathrm{OXPHOS}}$$\n$$Y_{\\mathrm{ATP,OX}} = 2 \\text{ ATP} + 2 \\text{ ATP} + 28 \\text{ ATP} = 32 \\text{ ATP per glucose}$$\n\nFor analytical clarity in the second part of the problem, we must categorize this yield according to the problem's definitions:\n- **Glycolytic ATP**: $2$ ATP from glycolytic SLP.\n- **OXPHOS-associated ATP**: All other ATP, which is $(2 \\text{ ATP from TCA SLP}) + (28 \\text{ ATP from OXPHOS}) = 30$ ATP.\nThe total sum is $2 + 30 = 32$ ATP, which is consistent.\n\n**Program 1: Pure Oxidative Phosphorylation Program**\nIn this program, all glucose is fully oxidized. The glucose uptake rate, $v_{\\mathrm{glc,OX}}$, is calculated using the total yield $Y_{\\mathrm{ATP,OX}}$.\nGiven $R_{\\mathrm{ATP}} = 1.00 \\times 10^9$ ATP molecules/s.\n$$v_{\\mathrm{glc,OX}} = \\frac{R_{\\mathrm{ATP}}}{Y_{\\mathrm{ATP,OX}}} = \\frac{1.00 \\times 10^9 \\text{ s}^{-1}}{32} = 3.125 \\times 10^7 \\text{ molecules s}^{-1}$$\n\n**Program 2: Mixed Program**\nIn this program, the cell maintains a specific ratio of ATP production sources: $70\\%$ from glycolytic ATP and $30\\%$ from OXPHOS-associated ATP. A fraction of glucose is fully oxidized, and the remainder is converted to lactate.\n\nLet $v_{\\mathrm{glc,mix}}$ be the total glucose uptake rate. For every molecule of glucose that enters the cell, it generates $2$ ATP via glycolytic SLP, regardless of whether it is subsequently oxidized or converted to lactate. Therefore, the total rate of \"Glycolytic ATP\" production, $R_{\\mathrm{glyc}}$, is directly proportional to the total glucose uptake rate:\n$$R_{\\mathrm{glyc}} = v_{\\mathrm{glc,mix}} \\times 2 \\frac{\\text{ATP}}{\\text{glucose}}$$\nThe problem states that this must constitute a fraction $f_{\\mathrm{glyc}} = 0.70$ of the total ATP production rate, $R_{\\mathrm{ATP}}$.\n$$R_{\\mathrm{glyc}} = f_{\\mathrm{glyc}} \\times R_{\\mathrm{ATP}}$$\n$$2 \\cdot v_{\\mathrm{glc,mix}} = 0.70 \\cdot R_{\\mathrm{ATP}}$$\nWe can directly solve for the required glucose uptake rate, $v_{\\mathrm{glc,mix}}$:\n$$v_{\\mathrm{glc,mix}} = \\frac{0.70 \\cdot R_{\\mathrm{ATP}}}{2} = 0.35 \\cdot R_{\\mathrm{ATP}}$$\nSubstituting the value for $R_{\\mathrm{ATP}}$:\n$$v_{\\mathrm{glc,mix}} = 0.35 \\times (1.00 \\times 10^9 \\text{ s}^{-1}) = 3.5 \\times 10^8 \\text{ molecules s}^{-1}$$\n\nTo verify this, we can determine the effective ATP yield per glucose, $Y_{\\mathrm{ATP,mix}}$, under this program.\n$$Y_{\\mathrm{ATP,mix}} = \\frac{R_{\\mathrm{ATP}}}{v_{\\mathrm{glc,mix}}} = \\frac{R_{\\mathrm{ATP}}}{0.35 \\cdot R_{\\mathrm{ATP}}} = \\frac{1}{0.35} = \\frac{1}{7/20} = \\frac{20}{7} \\text{ ATP per glucose}$$\nThe remaining $30\\%$ of ATP must come from the OXPHOS-associated pool. Let $x$ be the fraction of glucose molecules that are fully oxidized. The rate of production of OXPHOS-associated ATP is due only to this fraction, and the yield is $30$ ATP per oxidized glucose.\n$$R_{\\mathrm{oxphos\\_assoc}} = (x \\cdot v_{\\mathrm{glc,mix}}) \\times 30 \\frac{\\text{ATP}}{\\text{glucose}} = 0.30 \\cdot R_{\\mathrm{ATP}}$$\nSubstituting $v_{\\mathrm{glc,mix}} = 0.35 \\cdot R_{\\mathrm{ATP}}$:\n$$(x \\cdot 0.35 \\cdot R_{\\mathrm{ATP}}) \\times 30 = 0.30 \\cdot R_{\\mathrm{ATP}}$$\n$$10.5 \\cdot x = 0.30 \\implies x = \\frac{0.30}{10.5} = \\frac{1}{35}$$\nThus, only a fraction $x = 1/35$ of incoming glucose is fully oxidized, while the fraction $1 - x = 34/35$ is converted to lactate. The overall ATP yield is consistent with this partitioning:\n$$Y_{\\mathrm{ATP,mix}} = \\left( (1-x) \\times 2 \\right) + \\left( x \\times 32 \\right) = \\left(\\frac{34}{35} \\times 2\\right) + \\left(\\frac{1}{35} \\times 32\\right) = \\frac{68+32}{35} = \\frac{100}{35} = \\frac{20}{7}$$\nThis confirms the validity of our direct calculation for $v_{\\mathrm{glc,mix}}$.\n\nThe problem requires rounding each result to four significant figures.\n$v_{\\mathrm{glc,OX}} = 3.125 \\times 10^7$. This value is exact and has four significant figures.\n$v_{\\mathrm{glc,mix}} = 3.5 \\times 10^8$. To express this with four significant figures, it is $3.500 \\times 10^8$.\n\nThe final results are:\n$v_{\\mathrm{glc,OX}} = 3.125 \\times 10^7$ molecules s$^{-1}$ per cell.\n$v_{\\mathrm{glc,mix}} = 3.500 \\times 10^8$ molecules s$^{-1}$ per cell.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 3.125 \\times 10^7 & 3.500 \\times 10^8 \\end{pmatrix}\n}\n$$", "id": "2808683"}, {"introduction": "Translating theoretical knowledge into experimental insight is a crucial skill in modern biology. This problem simulates the analysis of data from an extracellular flux analyzer, a workhorse instrument in immunometabolism research used to measure cellular respiration and glycolysis in real-time [@problem_id:2808728]. You will calculate a key parameter, mitochondrial coupling efficiency, from raw data and interpret how a metabolic inhibitor alters the cell's bioenergetic state, providing a direct link between experimental measurement and physiological interpretation.", "problem": "A population of polyclonally activated primary mouse CD8 T cells is analyzed using an extracellular flux assay to quantify mitochondrial respiration and glycolysis. Oxygen Consumption Rate (OCR) and Extracellular Acidification Rate (ECAR) traces are recorded under sequential injections of the adenosine triphosphate (ATP) synthase inhibitor oligomycin and the complex I and III inhibitors rotenone and antimycin A, respectively. The following foundational definitions are assumed: (i) basal respiration represents mitochondrial oxygen consumption after subtracting non-mitochondrial oxygen consumption, which is revealed after inhibition of complexes I and III, (ii) ATP-linked respiration is the component of basal oxygen consumption that is sensitive to ATP synthase inhibition, and (iii) coupling efficiency is the fraction of basal respiration that is devoted to ATP synthesis by the mitochondrial ATP synthase. These are standard, well-tested definitions in bioenergetics for interpreting such assays.\n\nTwo conditions are compared: vehicle-treated control and metformin-treated. Metformin is a biguanide known to inhibit mitochondrial complex I, thereby altering Adenosine Monophosphate-Activated Protein Kinase (AMPK) signaling and metabolic partitioning.\n\nAll OCR values are in pmol $O_2$/min and all ECAR values are in mpH/min. For each condition, the steady-state plateaus immediately before and after each injection are recorded as follows.\n\nControl T cells:\n- Basal OCR (before any injection): $120$\n- OCR after oligomycin: $70$\n- OCR after rotenone/antimycin A: $10$\n- Basal ECAR: $20$\n- ECAR after glucose: $45$\n- ECAR after oligomycin: $75$\n- ECAR after $2$-deoxyglucose: $5$\n\nMetformin-treated T cells:\n- Basal OCR (before any injection): $85$\n- OCR after oligomycin: $60$\n- OCR after rotenone/antimycin A: $10$\n- Basal ECAR: $25$\n- ECAR after glucose: $60$\n- ECAR after oligomycin: $100$\n- ECAR after $2$-deoxyglucose: $5$\n\nUsing only the foundational definitions stated above and these measurements, compute the change in coupling efficiency defined as (metformin-treated coupling efficiency) minus (control coupling efficiency). Express your final numerical change as an exact fraction in simplest terms, with no units.\n\nSeparately, in your reasoning (not in the final numerical answer), interpret how the computed change, together with the ECAR responses, would be expected to influence acute effector functions such as cytokine production and cytotoxicity in these T cells under nutrient-replete conditions, based on first principles of immunometabolism. The final answer must be a single number in exact fractional form, unitless.", "solution": "We begin from the foundational definitions of components of respiration measured by extracellular flux analysis.\n\nDefinition of non-mitochondrial oxygen consumption: the residual OCR after combined inhibition of the electron transport chain at complexes I and III (rotenone and antimycin A) is considered non-mitochondrial oxygen consumption. This is a standard, well-tested observation.\n\nDefinition of basal respiration: the mitochondrial component of basal oxygen consumption is the difference between the basal OCR and the non-mitochondrial OCR. Symbolically, if $O_{\\text{basal}}$ is basal OCR and $O_{\\text{non-mito}}$ is non-mitochondrial OCR (after rotenone/antimycin A), then the basal mitochondrial respiration is\n$$\nO_{\\text{basal, mito}} = O_{\\text{basal}} - O_{\\text{non-mito}}.\n$$\n\nDefinition of ATP-linked respiration: the portion of basal mitochondrial oxygen consumption coupled to ATP synthesis is inhibited by oligomycin (an ATP synthase inhibitor). If $O_{\\text{oligo}}$ is the OCR after oligomycin, then the ATP-linked respiration is\n$$\nO_{\\text{ATP-linked}} = O_{\\text{basal}} - O_{\\text{oligo}}.\n$$\n\nDefinition of coupling efficiency: the fraction of basal mitochondrial respiration devoted to ATP synthesis is given by\n$$\n\\eta = \\frac{O_{\\text{ATP-linked}}}{O_{\\text{basal, mito}}}.\n$$\n\nWe compute these quantities for control and metformin conditions.\n\nControl condition:\n- Basal OCR $O_{\\text{basal}}^{(c)} = 120$.\n- OCR after oligomycin $O_{\\text{oligo}}^{(c)} = 70$.\n- Non-mitochondrial OCR $O_{\\text{non-mito}}^{(c)} = 10$.\n\nCompute basal mitochondrial respiration for control:\n$$\nO_{\\text{basal, mito}}^{(c)} = 120 - 10 = 110.\n$$\n\nCompute ATP-linked respiration for control:\n$$\nO_{\\text{ATP-linked}}^{(c)} = 120 - 70 = 50.\n$$\n\nCompute coupling efficiency for control:\n$$\n\\eta^{(c)} = \\frac{50}{110} = \\frac{5}{11}.\n$$\n\nMetformin-treated condition:\n- Basal OCR $O_{\\text{basal}}^{(m)} = 85$.\n- OCR after oligomycin $O_{\\text{oligo}}^{(m)} = 60$.\n- Non-mitochondrial OCR $O_{\\text{non-mito}}^{(m)} = 10$.\n\nCompute basal mitochondrial respiration for metformin:\n$$\nO_{\\text{basal, mito}}^{(m)} = 85 - 10 = 75.\n$$\n\nCompute ATP-linked respiration for metformin:\n$$\nO_{\\text{ATP-linked}}^{(m)} = 85 - 60 = 25.\n$$\n\nCompute coupling efficiency for metformin:\n$$\n\\eta^{(m)} = \\frac{25}{75} = \\frac{1}{3}.\n$$\n\nCompute the change in coupling efficiency defined as metformin minus control:\n$$\n\\Delta \\eta = \\eta^{(m)} - \\eta^{(c)} = \\frac{1}{3} - \\frac{5}{11}.\n$$\nBring to a common denominator:\n$$\n\\Delta \\eta = \\frac{11}{33} - \\frac{15}{33} = -\\frac{4}{33}.\n$$\nThis is already in simplest terms.\n\nInterpretation of impact on effector function (qualitative reasoning, not part of the final numerical answer): Metformin reduces coupling efficiency from $\\frac{5}{11}$ to $\\frac{1}{3}$, i.e., $\\Delta \\eta = -\\frac{4}{33}$, indicating that a smaller fraction of basal mitochondrial respiration is used for ATP synthesis, consistent with complex I inhibition and/or increased proton leak relative to ATP production. The ECAR responses show higher glycolytic engagement in metformin-treated cells (basal ECAR increases from $20$ to $25$, glucose-stimulated ECAR from $45$ to $60$, and oligomycin-stimulated glycolytic capacity from $75$ to $100$), indicating compensatory upregulation of glycolysis. From immunometabolic principles, effector T cells rely heavily on aerobic glycolysis for rapid cytokine production and cytotoxic function under nutrient-replete conditions, while mitochondrial respiration supports bioenergetic flexibility, mitochondrial ATP supply in specific subcellular locales, calcium homeostasis, and sustained effector functions. The observed decrease in coupling efficiency suggests impaired mitochondrial ATP generation capacity, which may dampen sustained effector functions and reduce efficiency under stress, even as increased glycolysis may partially preserve acute effector outputs. Therefore, the net expectation is a partial impairment of mitochondrial support for effector function with glycolytic compensation; acutely, some effector activities may be maintained, but overall effector potency and durability are likely reduced, with a potential shift toward a more memory-like metabolic profile over time driven by Adenosine Monophosphate-Activated Protein Kinase (AMPK) activation and mechanistic target of rapamycin complex 1 (mTORC1) restraint.", "answer": "$$\\boxed{-\\frac{4}{33}}$$", "id": "2808728"}, {"introduction": "Immune cells must make strategic decisions, allocating finite resources to optimize functions like proliferation or cytokine production. This advanced practice introduces a systems-level perspective, asking you to formalize these metabolic choices into a mathematical optimization model [@problem_id:2808725]. By determining the optimal allocation of glucose between energy generation and biosynthesis to maximize proliferation rate under defined constraints, you will develop an intuitive understanding of how complex metabolic phenotypes can arise from fundamental trade-offs and cellular limitations.", "problem": "Consider an activated immune cell that allocates a fixed glucose uptake flux to two ATP-generating pathways: glycolysis and oxidative phosphorylation (OXPHOS). Let the total glucose uptake flux be $u_g$, which is constrained by a transporter-limited maximum $G_{\\max}$. Assume $u_g = G_{\\max}$ is achieved. Glycolysis yields $y_g$ adenosine triphosphate (ATP) molecules per unit glucose flux allocated to glycolysis, while OXPHOS yields $y_o$ ATP molecules per unit glucose flux allocated to OXPHOS. Mitochondrial respiration is limited by a finite ATP production capacity $M_{\\max}$, so the ATP flux from OXPHOS cannot exceed $M_{\\max}$. Define the decision variable $x \\in [0,1]$ as the fraction of the glucose uptake flux allocated to glycolysis; thus the fraction allocated to OXPHOS is $(1-x)$.\n\nFoundational base and model assumptions are the following well-tested biological principles and capacity constraints:\n- Glycolysis produces approximately $2$ ATP per glucose, and oxidative phosphorylation produces approximately $30$ ATP per glucose equivalent under physiological conditions.\n- Proliferation requires both ATP and biosynthetic precursors; the rate is limited by the scarcest of these supplies.\n- Transport and organelle capacities impose upper bounds on fluxes.\n\nDefine ATP supply as\n$$\nA(x) = y_g \\, x \\, u_g \\;+\\; y_o \\, \\min\\big((1-x)\\,u_g,\\; s_o\\big),\n$$\nwhere $s_o = M_{\\max}/y_o$ is the maximum glucose-equivalent flux that OXPHOS can process under the ATP capacity cap $M_{\\max}$. Define a linear proxy for biosynthetic precursor generation as\n$$\nP(x) = u_g\\left(p_o + (p_g - p_o)\\,x\\right),\n$$\nwhere $p_g$ and $p_o$ are nonnegative coefficients representing precursor equivalents per unit glucose flux when directed to glycolysis and OXPHOS, respectively, with typically $p_g \\ge p_o$ because glycolysis releases intermediates that feed biosynthesis. Let $A_{\\mathrm{req}}$ and $C_{\\mathrm{req}}$ be positive constants denoting the ATP-equivalent requirement and the carbon-precursor-equivalent requirement, respectively, to support a unit proliferation rate. The proliferation rate as a function of allocation $x$ is then\n$$\nr(x) = \\min\\!\\left(\\frac{A(x)}{A_{\\mathrm{req}}},\\;\\frac{P(x)}{C_{\\mathrm{req}}}\\right).\n$$\n\nOptimization problem: Choose $x \\in [0,1]$ to maximize $r(x)$ subject to the above constraints. If multiple values of $x$ achieve the same maximal proliferation rate, select the smallest such $x$.\n\nYour task is to write a program that, for each parameter set in the test suite below, computes the optimal allocation $x^\\star$ and the maximal proliferation rate $r^\\star = r(x^\\star)$. All computations are to be treated as dimensionless. Your program should not read any input and should use the following test suite exactly.\n\nTest suite (each line lists $(G_{\\max}, M_{\\max}, y_g, y_o, p_g, p_o, A_{\\mathrm{req}}, C_{\\mathrm{req}})$):\n- Test case $1$: $(1.0,\\, 50.0,\\, 2.0,\\, 30.0,\\, 0.8,\\, 0.2,\\, 10.0,\\, 1.0)$.\n- Test case $2$: $(1.0,\\, 10.0,\\, 2.0,\\, 30.0,\\, 0.8,\\, 0.2,\\, 4.0,\\, 1.0)$.\n- Test case $3$: $(1.0,\\, 0.0,\\, 2.0,\\, 30.0,\\, 0.8,\\, 0.2,\\, 20.0,\\, 1.0)$.\n- Test case $4$: $(1.0,\\, 100.0,\\, 2.0,\\, 30.0,\\, 0.8,\\, 0.2,\\, 2.0,\\, 1.0)$.\n- Test case $5$: $(1.0,\\, 15.0,\\, 2.0,\\, 30.0,\\, 0.5,\\, 0.5,\\, 5.0,\\, 1.0)$.\n\nFinal output format: Your program should produce a single line containing a flat list with entries alternating $x^\\star$ and $r^\\star$ for the test cases in the order given. Round each real number to $6$ decimal places. For example, a valid output format is\n$$\n[\\,x^\\star_1, r^\\star_1, x^\\star_2, r^\\star_2, \\ldots, x^\\star_5, r^\\star_5\\,].\n$$", "solution": "The problem presented is a well-posed optimization task grounded in the principles of immunometabolism. It involves maximizing a biologically relevant objective function, the proliferation rate $r(x)$, which depends on a single decision variable $x$. The problem is self-contained, scientifically sound within its modeling framework, and all parameters are clearly defined. Therefore, a rigorous analytical and computational solution can be pursued.\n\nThe optimization problem is to find $x^\\star$ that maximizes the proliferation rate $r(x)$ over the compact interval $x \\in [0,1]$:\n$$\n\\max_{x \\in [0,1]} r(x)\n$$\nwhere\n$$\nr(x) = \\min\\!\\left(\\frac{A(x)}{A_{\\mathrm{req}}},\\;\\frac{P(x)}{C_{\\mathrm{req}}}\\right).\n$$\nIf the maximum rate $r^\\star$ is achieved for multiple values of $x$, the smallest such value is to be selected.\n\nLet us define the ATP-limited proliferation rate as $r_A(x) = A(x)/A_{\\mathrm{req}}$ and the precursor-limited proliferation rate as $r_P(x) = P(x)/C_{\\mathrm{req}}$. The problem is thus to maximize $r(x) = \\min(r_A(x), r_P(x))$.\n\nFirst, we analyze the functional forms of $r_P(x)$ and $r_A(x)$.\n\nThe precursor supply function is given as $P(x) = u_g(p_o + (p_g - p_o)x)$. Since $u_g$, $C_{\\mathrm{req}}$, $p_o$ are positive and $p_g \\ge p_o$ is assumed, the precursor-limited rate $r_P(x) = P(x)/C_{\\mathrm{req}}$ is a linear, non-decreasing function of $x$.\n\nThe ATP supply function $A(x)$ is defined as:\n$$\nA(x) = y_g \\, x \\, u_g \\;+\\; y_o \\, \\min\\big((1-x)\\,u_g,\\; s_o\\big)\n$$\nwhere $s_o = M_{\\max}/y_o$. The `min` operator makes this function piecewise linear. The behavior of $A(x)$ changes at the point where the arguments of the `min` function are equal. Let this critical allocation be denoted by $x_c$.\n$$\n(1-x_c)u_g = s_o \\implies x_c = 1 - \\frac{s_o}{u_g} = 1 - \\frac{M_{\\max}}{y_o u_g}\n$$\nThe value of $u_g$ is fixed to the maximum uptake rate, $u_g = G_{\\max}$.\n\nThe function $A(x)$ can be written in a piecewise form:\n$$\nA(x) = \\begin{cases}\ny_g \\, x \\, u_g + y_o s_o = y_g \\, x \\, u_g + M_{\\max} & \\text{if } x < x_c \\\\\ny_g \\, x \\, u_g + y_o (1-x) u_g & \\text{if } x \\ge x_c\n\\end{cases}\n$$\nLet us analyze the derivative of $A(x)$ with respect to $x$ for each piece.\nFor $x < x_c$, the slope is $A'(x) = y_g u_g > 0$.\nFor $x > x_c$, the slope is $A'(x) = (y_g - y_o)u_g < 0$, since it is a biological fact that $y_o > y_g$.\n\nThus, $A(x)$, and consequently $r_A(x)$, is a continuous, unimodal function. If $x_c \\in (0,1)$, $r_A(x)$ increases for $x \\in [0, x_c)$ and decreases for $x \\in (x_c, 1]$, with a maximum at $x=x_c$. If $x_c \\le 0$, $r_A(x)$ is decreasing on $[0,1]$. If $x_c \\ge 1$, $r_A(x)$ is increasing on $[0,1]$.\n\nThe function to be maximized, $r(x) = \\min(r_A(x), r_P(x))$, is the lower envelope of a non-decreasing linear function and a unimodal (or monotonic) piecewise linear function. According to the principles of optimization, the maximum of such a continuous, piecewise-differentiable function on a compact domain must occur at a point belonging to a finite set of candidates:\n1.  The boundary points of the domain: $x=0$ and $x=1$.\n2.  Points where the derivative is zero or undefined. For $r(x)$, this includes the peak of $r_A(x)$, which is $x_c$ (if it is within the domain $(0,1)$), as $r_A(x)$ is the active constraint, i.e., $r_A(x_c) < r_P(x_c)$.\n3.  Points where the constituent functions are equal, i.e., $r_A(x) = r_P(x)$. These are the intersection points of the two rate functions.\n\nThis logic leads to a robust algorithm. We identify all such candidate points, evaluate the function $r(x)$ at each, and find the global maximum.\n\nThe candidate points $x_{cand}$ for the optimal allocation $x^\\star$ are:\n1.  The boundary points: $0$ and $1$.\n2.  The critical point $x_c = 1 - M_{\\max}/(y_o u_g)$, if $x_c \\in (0,1)$.\n3.  The intersection points where $C_{\\mathrm{req}}A(x) = A_{\\mathrm{req}}P(x)$. We must solve this equation for each linear piece of $A(x)$.\n\n**Intersection for $x \\ge x_c$ (and $x \\in [0,1]$):**\nThe equation is $C_{\\mathrm{req}} u_g (y_g x + y_o (1-x)) = A_{\\mathrm{req}} u_g (p_o + (p_g - p_o)x)$. The term $u_g$ cancels.\n$$\nC_{\\mathrm{req}}(y_o + (y_g-y_o)x) = A_{\\mathrm{req}}(p_o + (p_g-p_o)x)\n$$\nSolving for $x$, we find a potential candidate $x_1$:\n$$\nx_1 = \\frac{A_{\\mathrm{req}}p_o - C_{\\mathrm{req}}y_o}{C_{\\mathrm{req}}(y_g - y_o) - A_{\\mathrm{req}}(p_g - p_o)}\n$$\nThis $x_1$ is a valid candidate only if it falls within its interval of definition, i.e., $x_1 \\in [\\max(0,x_c), 1]$.\n\n**Intersection for $x < x_c$ (and $x \\in [0,1]$):**\nThe equation is $C_{\\mathrm{req}} (y_g x u_g + M_{\\max}) = A_{\\mathrm{req}} u_g (p_o + (p_g - p_o)x)$.\nSolving for $x$, we find a potential candidate $x_2$:\n$$\nx_2 = \\frac{A_{\\mathrm{req}}u_g p_o - C_{\\mathrm{req}}M_{\\max}}{u_g(C_{\\mathrm{req}} y_g - A_{\\mathrm{req}}(p_g - p_o))}\n$$\nThis $x_2$ is a valid candidate only if $x_2 \\in [0, \\min(1,x_c))$.\n\nThe final algorithm is as follows:\n1.  For a given set of parameters, calculate $u_g=G_{\\max}$ and $x_c$.\n2.  Compile a set of candidate points, starting with $\\{0, 1\\}$.\n3.  If $x_c \\in (0,1)$, add $x_c$ to the set.\n4.  Calculate potential intersection points $x_1$ and $x_2$. If they are valid (exist and lie in their respective domains), add them to the set.\n5.  Evaluate $r(x)$ for every unique candidate point $x$ in the set.\n6.  The maximum value found is $r^\\star$.\n7.  The optimal allocation $x^\\star$ is the smallest candidate point that yields the rate $r^\\star$. This process guarantees finding the correct and unique solution as specified by the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the immunometabolism optimization problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # (G_max, M_max, y_g, y_o, p_g, p_o, A_req, C_req)\n        (1.0, 50.0, 2.0, 30.0, 0.8, 0.2, 10.0, 1.0),\n        (1.0, 10.0, 2.0, 30.0, 0.8, 0.2, 4.0, 1.0),\n        (1.0, 0.0, 2.0, 30.0, 0.8, 0.2, 20.0, 1.0),\n        (1.0, 100.0, 2.0, 30.0, 0.8, 0.2, 2.0, 1.0),\n        (1.0, 15.0, 2.0, 30.0, 0.5, 0.5, 5.0, 1.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        x_star, r_star = calculate_optimal_allocation(params)\n        results.extend([x_star, r_star])\n\n    # Format the final output string\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_optimal_allocation(params):\n    \"\"\"\n    Computes the optimal allocation x* and maximal proliferation rate r*\n    for a single set of parameters.\n    \"\"\"\n    G_max, M_max, y_g, y_o, p_g, p_o, A_req, C_req = params\n    u_g = G_max\n    \n    # Define s_o, the max glucose-equivalent flux for OXPHOS\n    s_o = M_max / y_o if y_o > 0 else float('inf')\n\n    # Define the rate functions r_A(x) and r_P(x)\n    def r_A(x):\n        # A(x) = y_g*x*u_g + y_o*min((1-x)*u_g, s_o)\n        oxphos_flux = min((1.0 - x) * u_g, s_o)\n        atp_supply = y_g * x * u_g + y_o * oxphos_flux\n        return atp_supply / A_req\n\n    def r_P(x):\n        # P(x) = u_g * (p_o + (p_g - p_o)*x)\n        precursor_supply = u_g * (p_o + (p_g - p_o) * x)\n        return precursor_supply / C_req\n\n    def r(x):\n        return min(r_A(x), r_P(x))\n\n    # --- Find candidate points for the maximum ---\n    candidates = {0.0, 1.0}\n\n    # Critical point x_c where OXPHOS capacity is met\n    x_c = 1.0 - s_o / u_g if u_g > 0 else float('inf')\n    if 0.0  x_c  1.0:\n        candidates.add(x_c)\n\n    # --- Find intersection points r_A(x) = r_P(x) ---\n    # This is equivalent to C_req * A(x) = A_req * P(x)\n\n    # Case 1: x >= x_c (OXPHOS not saturated)\n    # C_req * u_g * (y_g*x + y_o*(1-x)) = A_req * u_g * (p_o + (p_g-p_o)*x)\n    # u_g cancels\n    # C_req*(y_o + (y_g-y_o)*x) = A_req*(p_o + (p_g-p_o)*x)\n    den1 = C_req * (y_g - y_o) - A_req * (p_g - p_o)\n    num1 = A_req * p_o - C_req * y_o\n    if abs(den1) > 1e-9:\n        x1 = num1 / den1\n        valid_min_x1 = np.maximum(0.0, x_c) if x_c = 1.0 else 1.0 + 1e-9 # Empty range if x_c > 1\n        if valid_min_x1 = x1 = 1.0:\n            candidates.add(x1)\n\n    # Case 2: x  x_c (OXPHOS saturated)\n    # C_req * (y_g*x*u_g + M_max) = A_req * u_g * (p_o + (p_g-p_o)*x)\n    if u_g > 0:\n        den2 = u_g * (C_req * y_g - A_req * (p_g - p_o))\n        num2 = A_req * u_g * p_o - C_req * M_max\n        if abs(den2) > 1e-9:\n            x2 = num2 / den2\n            valid_max_x2 = np.minimum(1.0, x_c) if x_c >= 0 else -1e-9 # Empty range if x_c  0\n            if 0.0 = x2  valid_max_x2:\n                 candidates.add(x2)\n\n    # --- Evaluate candidates to find the optimum ---\n    best_x_list = []\n    max_r = -1.0\n    \n    # Sort candidates to handle cases where multiple x yield max_r\n    sorted_candidates = sorted(list(candidates))\n\n    for x_cand in sorted_candidates:\n        if 0.0 = x_cand = 1.0:\n            current_r = r(x_cand)\n            if current_r > max_r + 1e-9:\n                max_r = current_r\n                best_x_list = [x_cand]\n            elif abs(current_r - max_r)  1e-9:\n                best_x_list.append(x_cand)\n\n    # The problem asks for the smallest x if multiple x achieve the same maximal rate.\n    # By iterating through sorted candidates and only resetting the list on a strict improvement,\n    # the first element of best_x_list will be the smallest x.\n    return best_x_list[0], max_r\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2808725"}]}