{"hands_on_practices": [{"introduction": "The regulation of gene expression begins with the physical binding of proteins, such as transcription factors (TFs), to specific DNA sites. Understanding this process quantitatively is essential for building predictive models of cis-regulation. This exercise guides you through the derivation of the fundamental relationship between TF concentration and DNA binding occupancy, starting from the law of mass action and extending to the important case of cooperative binding between multiple factors [@problem_id:2786758].", "problem": "You are studying the equilibrium binding of a single Transcription Factor (TF) to a Deoxyribonucleic Acid (DNA) site and then extending to two DNA sites with thermodynamic cooperativity. Use only the Law of Mass Action, the definition of the equilibrium dissociation constant, and the statistical mechanics of equilibrium occupancy, without assuming any target formula in advance.\n\nPart A (single site): Consider the equilibrium reaction $TF + S \\rightleftharpoons TF\\cdot S$, where $S$ denotes a single binding site on DNA. Let the dissociation constant be defined by $K_{d} = \\frac{[TF][S]}{[TF\\cdot S]}$ at equilibrium. Define the fractional occupancy $\\theta$ of the site as $\\theta = \\frac{[TF\\cdot S]}{[S]_{\\text{tot}}}$, where $[S]_{\\text{tot}} = [S] + [TF\\cdot S]$ is the total site concentration. Starting from these definitions, derive an expression for $\\theta$ as a function of $[TF]$ and $K_{d}$.\n\nPart B (two sites with cooperativity): Now consider two distinct DNA sites, $S_{1}$ and $S_{2}$, both binding the same TF with dissociation constants $K_{d1}$ and $K_{d2}$, respectively. Assume that when both sites are bound simultaneously, there is an interaction free energy that modifies the double-bound state’s statistical weight by a dimensionless cooperativity factor $\\omega$ (with $\\omega = \\exp(-\\beta \\Delta G_{\\text{int}})$, $\\beta = \\frac{1}{k_{B}T}$, $k_{B}$ the Boltzmann constant, and $T$ the absolute temperature). Using equilibrium statistical mechanics with the Law of Mass Action, enumerate the microstates and their statistical weights, construct the partition function, and derive the probability $P_{2}$ that both sites are bound simultaneously in terms of $[TF]$, $K_{d1}$, $K_{d2}$, and $\\omega$.\n\nPart C (numerical evaluation): Specialize to the symmetric case $K_{d1} = K_{d2} = K$. Let $K = 10\\,\\text{nM}$ and $\\omega = 9$. Compute the concentration $[TF]$ (in $\\text{nM}$) at which the probability that both sites are bound is exactly $0.5$. Express your final numerical answer in nanomolar and round to three significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. It presents a standard, canonical exercise in the physical chemistry of macromolecular binding, which is a fundamental topic in molecular biology. All necessary definitions and parameters are provided. We shall proceed with the derivation in three parts.\n\nPart A: The fractional occupancy $\\theta$ of a single binding site.\nThe analysis begins with the law of mass action applied to the specified equilibrium reaction:\n$$TF + S \\rightleftharpoons TF\\cdot S$$\nThe equilibrium dissociation constant, $K_{d}$, is defined by the ratio of concentrations of dissociated species to the associated complex:\n$$K_{d} = \\frac{[TF][S]}{[TF\\cdot S]}$$\nHere, $[TF]$ is the concentration of free transcription factor, $[S]$ is the concentration of free binding sites, and $[TF\\cdot S]$ is the concentration of the bound complex. Our objective is to find the fractional occupancy, $\\theta$, defined as the fraction of total sites that are occupied:\n$$\\theta = \\frac{[TF\\cdot S]}{[S]_{\\text{tot}}}$$\nThe total concentration of sites, $[S]_{\\text{tot}}$, is the sum of free sites and bound sites:\n$$[S]_{\\text{tot}} = [S] + [TF\\cdot S]$$\nFrom the definition of $K_{d}$, we express the concentration of free sites, $[S]$, in terms of the bound complex concentration, $[TF\\cdot S]$:\n$$[S] = K_{d} \\frac{[TF\\cdot S]}{[TF]}$$\nNow, we substitute this expression for $[S]$ into the equation for the total site concentration:\n$$[S]_{\\text{tot}} = K_{d} \\frac{[TF\\cdot S]}{[TF]} + [TF\\cdot S]$$\nFactoring out the term $[TF\\cdot S]$ yields:\n$$[S]_{\\text{tot}} = [TF\\cdot S] \\left( \\frac{K_{d}}{[TF]} + 1 \\right)$$\nTo find $\\theta$, we rearrange this equation to form the ratio $\\frac{[TF\\cdot S]}{[S]_{\\text{tot}}}$:\n$$\\theta = \\frac{[TF\\cdot S]}{[S]_{\\text{tot}}} = \\frac{1}{\\frac{K_{d}}{[TF]} + 1}$$\nMultiplying the numerator and denominator by $[TF]$ gives the final, standard expression for the fractional occupancy, which is a function of $[TF]$ and $K_{d}$:\n$$\\theta = \\frac{[TF]}{[TF] + K_{d}}$$\nThis result is also known as the Langmuir binding isotherm.\n\nPart B: The probability of simultaneous binding to two cooperative sites.\nWe now consider a system with two distinct binding sites, $S_1$ and $S_2$, on the same DNA molecule. We use the framework of equilibrium statistical mechanics. The system can exist in four possible microstates depending on the binding status of the two sites:\n$1$. State $00$: Both sites $S_1$ and $S_2$ are empty.\n$2$. State $10$: Site $S_1$ is bound by $TF$, site $S_2$ is empty.\n$3$. State $01$: Site $S_1$ is empty, site $S_2$ is bound by $TF$.\n$4$. State $11$: Both sites $S_1$ and $S_2$ are bound by $TF$.\n\nThe probability of finding the system in any particular microstate is determined by its statistical weight relative to the sum of all statistical weights. Let us define the statistical weight of the reference state (State $00$) as $W_{00} = 1$. The weights of the other states are determined relative to this state, based on the law of mass action.\n\nThe concentration of State $10$ is related to the concentration of State $00$ by the binding equilibrium at site $S_1$: $[State_{10}] = \\frac{[TF]}{K_{d1}} [State_{00}]$. Thus, its statistical weight is:\n$$W_{10} = \\frac{[TF]}{K_{d1}}$$\nSimilarly, for State $01$, binding occurs at site $S_2$:\n$$W_{01} = \\frac{[TF]}{K_{d2}}$$\nFor State $11$, both sites are bound. This process can be viewed as two sequential binding events. The binding of the second $TF$ is modified by the cooperativity factor $\\omega$. The equilibrium for the formation of the double-bound state from the empty state and two $TF$ molecules is $[State_{11}] = \\frac{1}{K_{d1}} \\frac{\\omega}{K_{d2}} [TF]^2 [State_{00}]$. Therefore, the statistical weight is:\n$$W_{11} = \\frac{\\omega [TF]^2}{K_{d1} K_{d2}}$$\nThe term $\\omega = \\exp(-\\beta \\Delta G_{\\text{int}})$ accounts for the interaction energy $\\Delta G_{\\text{int}}$ between the two bound TFs. If $\\omega  1$, the interaction is favorable (positive cooperativity).\n\nThe partition function, $Z$, for this system is the sum of the statistical weights of all possible microstates:\n$$Z = W_{00} + W_{10} + W_{01} + W_{11} = 1 + \\frac{[TF]}{K_{d1}} + \\frac{[TF]}{K_{d2}} + \\frac{\\omega [TF]^2}{K_{d1} K_{d2}}$$\nThe probability of a specific microstate is its weight divided by the partition function. The problem asks for $P_2$, the probability that *both* sites are bound, which corresponds to State $11$.\n$$P_2 = \\frac{W_{11}}{Z} = \\frac{\\frac{\\omega [TF]^2}{K_{d1} K_{d2}}}{1 + \\frac{[TF]}{K_{d1}} + \\frac{[TF]}{K_{d2}} + \\frac{\\omega [TF]^2}{K_{d1} K_{d2}}}$$\n\nPart C: Numerical calculation for a symmetric system.\nWe are given the symmetric case $K_{d1} = K_{d2} = K$. The expression for $P_2$ simplifies to:\n$$P_2 = \\frac{\\frac{\\omega [TF]^2}{K^2}}{1 + \\frac{2[TF]}{K} + \\frac{\\omega [TF]^2}{K^2}}$$\nWe are given $K = 10\\,\\text{nM}$, $\\omega = 9$, and the condition $P_2 = 0.5$. Let $x$ represent the concentration $[TF]$ in units of $\\text{nM}$. We substitute the values into the equation:\n$$0.5 = \\frac{\\frac{9 x^2}{10^2}}{1 + \\frac{2x}{10} + \\frac{9 x^2}{10^2}} = \\frac{0.09 x^2}{1 + 0.2 x + 0.09 x^2}$$\nWe must now solve for $x$:\n$$0.5 (1 + 0.2 x + 0.09 x^2) = 0.09 x^2$$\n$$0.5 + 0.1 x + 0.045 x^2 = 0.09 x^2$$\nRearranging the terms gives a quadratic equation:\n$$0.045 x^2 - 0.1 x - 0.5 = 0$$\nTo simplify, we can multiply the entire equation by $200$:\n$$9 x^2 - 20 x - 100 = 0$$\nWe solve this equation for $x$ using the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=9$, $b=-20$, and $c=-100$:\n$$x = \\frac{-(-20) \\pm \\sqrt{(-20)^2 - 4(9)(-100)}}{2(9)}$$\n$$x = \\frac{20 \\pm \\sqrt{400 + 3600}}{18}$$\n$$x = \\frac{20 \\pm \\sqrt{4000}}{18} = \\frac{20 \\pm 20\\sqrt{10}}{18} = \\frac{10 \\pm 10\\sqrt{10}}{9}$$\nSince concentration, $x = [TF]$, must be a non-negative physical quantity, we must choose the positive root:\n$$x = \\frac{10 + 10\\sqrt{10}}{9}$$\nNow we evaluate this expression numerically:\n$$x = \\frac{10(1 + \\sqrt{10})}{9} \\approx \\frac{10(1 + 3.162277...)}{9} = \\frac{41.62277...}{9} \\approx 4.62475...$$\nRounding the result to three significant figures, as required, we obtain the concentration of the transcription factor.\n$$[TF] \\approx 4.62\\,\\text{nM}$$", "answer": "$$\\boxed{4.62}$$", "id": "2786758"}, {"introduction": "High-throughput Chromosome Conformation Capture (Hi-C) experiments provide genome-wide maps of chromatin contacts, revealing large-scale organizational features like Topologically Associating Domains (TADs). A critical step in analyzing these maps is to computationally identify the boundaries that separate these domains. This practice introduces the \"insulation score\" method, a powerful and intuitive algorithm for locating TAD boundaries by quantifying the relative lack of interaction across them in a Hi-C matrix [@problem_id:2786767].", "problem": "A High-throughput Chromosome Conformation Capture (Hi-C) experiment yields a symmetric contact matrix $C \\in \\mathbb{R}_{\\ge 0}^{N \\times N}$, where $C_{ij}$ counts contacts between genomic bins $i$ and $j$ at a fixed bin size, with $C_{ij} = C_{ji}$. A Topologically Associating Domain (TAD) boundary is operationally defined as a genomic position where cross-boundary interaction frequency is reduced relative to adjacent positions, implying that a localized measure of cross-boundary contact “flux” should be minimal at boundaries. The insulation-score approach estimates this flux at each putative boundary index $k$ by aggregating contacts in a small, fixed-size neighborhood that straddles $k$. Boundaries are then identified as local minima of this score along the genome.\n\nStarting from these principles and definitions, consider the following $N \\times N$ Hi-C contact matrix with $N = 6$ bins (diagonal entries $C_{ii}$ are shown for completeness but are not required for the calculation described below):\n$$\nC \\;=\\;\n\\begin{pmatrix}\n0  50  40  5  3  2 \\\\\n50  0  45  6  4  3 \\\\\n40  45  0  7  5  4 \\\\\n5  6  7  0  55  42 \\\\\n3  4  5  55  0  48 \\\\\n2  3  4  42  48  0\n\\end{pmatrix}.\n$$\nAssume a sliding-window half-width $w = 2$, and restrict computation to boundary indices $k$ for which the window is fully contained, i.e., $w \\le k \\le N-w$. The task is to define a principled insulation score $I(k)$ that captures cross-boundary flux at $k$ using only contacts that straddle $k$ within a $(2w) \\times (2w)$ neighborhood around the diagonal, transform it into a one-dimensional track $s(k)$ suitable for comparing neighboring positions, and declare boundaries as local minima of that track. No bias-correction normalization is required for this example, and you may use a small pseudocount if you perform a logarithmic transformation. For the matrix above and $w = 2$, your procedure should correctly identify the dominant boundary.\n\nWhich option below most correctly specifies such a procedure and yields the correct boundary index for the given matrix?\n\nA. For each boundary index $k \\in \\{2,3,4\\}$, compute a cross-boundary sum\n$$\nI(k) \\;=\\; \\sum_{i=k-w+1}^{k} \\sum_{j=k+1}^{k+w} C_{ij},\n$$\ndefine $s(k) \\;=\\; \\log_{2}\\!\\big(I(k) + 1\\big)$, and call boundaries at local minima of $s(k)$ along $k$. For the given $C$ with $w = 2$, the unique minimum occurs at $k = 3$.\n\nB. For each $k \\in \\{2,3,4\\}$, compute an intra-domain sum\n$$\nI(k) \\;=\\; \\sum_{i=k-w+1}^{k} \\sum_{j=k-w+1}^{k} C_{ij} \\;+\\; \\sum_{i=k+1}^{k+w} \\sum_{j=k+1}^{k+w} C_{ij},\n$$\ndefine $s(k) \\;=\\; \\log_{2}\\!\\big(I(k)+1\\big)$, and call boundaries at local maxima of $s(k)$ because strong domains produce large $I(k)$. For the given $C$ with $w = 2$, the maximum occurs at $k = 3$.\n\nC. For each $k \\in \\{2,3,4\\}$, compute the mean contact value $\\bar{I}(k)$ across the diagonal band $\\{(i,j): |i-j| \\le w\\}$ centered at $k$ (i.e., spanning rows and columns $k-w$ through $k+w$), define $s(k) \\;=\\; \\bar{I}(k)$, and call boundaries where $s(k)$ attains local minima. For the given $C$ with $w = 2$, the minimum occurs at $k = 2$.\n\nD. For each $k \\in \\{2,3,4\\}$, compute the cross-boundary sum\n$$\nI(k) \\;=\\; \\sum_{i=k-w+1}^{k} \\sum_{j=k+1}^{k+w} C_{ij},\n$$\ndivide by the sum of the corresponding row and column marginals to correct coverage, define $s(k) \\;=\\; I(k)$, and call boundaries at local maxima because cross-boundary interactions peak at boundaries. For the given $C$ with $w = 2$, the maximum occurs at $k = 4$.", "solution": "We begin from the core definition that a Topologically Associating Domain (TAD) is a genomic region with enriched intra-domain interactions and depleted inter-domain interactions. A TAD boundary should therefore coincide with a local reduction in cross-boundary contact frequency. In a Hi-C contact matrix $C$, cross-boundary frequency around a genomic index $k$ can be probed by summing entries that straddle $k$, i.e., entries with $i \\le k  j$, within a local square neighborhood of half-width $w$ around the diagonal to limit contributions to nearby loci. This motivates defining an “insulation” statistic $I(k)$ at $k$ as the sum over a $(2w)\\times(2w)$ window that is split at $k$ into a left block $[k-w+1,k]$ and a right block $[k+1,k+w]$, with only cross terms contributing:\n$$\nI(k) \\;=\\; \\sum_{i=k-w+1}^{k} \\sum_{j=k+1}^{k+w} C_{ij}.\n$$\nBecause $I(k)$ is a positive sum, taking a logarithm stabilizes variance and compresses dynamic range; with a small pseudocount $\\epsilon$, a practical one-dimensional track is $s(k) = \\log_{2}\\!\\big(I(k)+\\epsilon\\big)$. Boundaries then appear as local minima of $s(k)$ because the cross-boundary flux is reduced where insulation is strongest.\n\nWe now apply this to the provided matrix with $N=6$ and $w=2$. The admissible boundary indices are $k \\in \\{2,3,4\\}$ since $w \\le k \\le N-w$.\n\nCompute $I(k)$ for each $k$ under the cross-boundary definition:\n\nFor $k=2$ with $i \\in \\{1,2\\}$ and $j \\in \\{3,4\\}$,\n$$\nI(2) \\;=\\; C_{1,3} + C_{1,4} + C_{2,3} + C_{2,4} \\;=\\; 40 + 5 + 45 + 6 \\;=\\; 96.\n$$\n\nFor $k=3$ with $i \\in \\{2,3\\}$ and $j \\in \\{4,5\\}$,\n$$\nI(3) \\;=\\; C_{2,4} + C_{2,5} + C_{3,4} + C_{3,5} \\;=\\; 6 + 4 + 7 + 5 \\;=\\; 22.\n$$\n\nFor $k=4$ with $i \\in \\{3,4\\}$ and $j \\in \\{5,6\\}$,\n$$\nI(4) \\;=\\; C_{3,5} + C_{3,6} + C_{4,5} + C_{4,6} \\;=\\; 5 + 4 + 55 + 42 \\;=\\; 106.\n$$\n\nIf we define $s(k) = \\log_{2}\\!\\big(I(k)+1\\big)$ (pseudocount $\\epsilon = 1$), then $s(2) = \\log_{2}(97)$, $s(3) = \\log_{2}(23)$, and $s(4) = \\log_{2}(107)$. Since $22  96  106$, it follows that $s(3)$ is the unique local minimum among $k \\in \\{2,3,4\\}$. This index $k=3$ corresponds to the boundary between bins $3$ and $4$, which is consistent with the visible block structure of $C$ (bins $1$ through $3$ form one domain with large intra-block values, and bins $4$ through $6$ form another, with small cross-block values).\n\nWe now analyze each option:\n\nOption A: The definition\n$$\nI(k) \\;=\\; \\sum_{i=k-w+1}^{k} \\sum_{j=k+1}^{k+w} C_{ij}\n$$\nimplements the cross-boundary “diamond” sum within a $(2w)\\times(2w)$ neighborhood centered on the diagonal and split at $k$, exactly capturing the intended local cross-boundary flux. The transformation $s(k) = \\log_{2}\\!\\big(I(k)+1\\big)$ is a standard monotone variance-stabilizing step, and calling local minima of $s(k)$ follows from the principle that boundaries minimize cross-boundary contact frequency. The numerical evaluation above yields a unique minimum at $k=3$ for the given $C$ and $w=2$, matching the expected TAD boundary between bins $3$ and $4$. Verdict — Correct.\n\nOption B: This option sums intra-domain blocks on each side of $k$:\n$$\nI(k) \\;=\\; \\sum_{i=k-w+1}^{k} \\sum_{j=k-w+1}^{k} C_{ij} \\;+\\; \\sum_{i=k+1}^{k+w} \\sum_{j=k+1}^{k+w} C_{ij}.\n$$\nThis measures intra-domain enrichment rather than cross-boundary flux. Maximizing such a statistic will preferentially pick indices deep within strong domains, not the boundary between them. Moreover, calling boundaries at local maxima contradicts the boundary-as-insulator principle. For the provided matrix, this will not isolate the boundary between bins $3$ and $4$ as a minimum; instead it risks selecting positions where both flanking windows are strong. Verdict — Incorrect.\n\nOption C: Averaging contacts across a diagonal band $\\{(i,j) : |i-j| \\le w\\}$ centered at $k$ mixes intra-domain and cross-boundary contacts and is not aligned to the split at $k$. It is not a directed cross-boundary measure and can be dominated by short-range contacts irrespective of whether they cross $k$. Minimizing such a band-average does not generically indicate a boundary and is confounded by distance-decay and domain-internal structure. The claimed minimum at $k=2$ does not follow from a principled cross-boundary insulation definition. Verdict — Incorrect.\n\nOption D: Although the initial cross-boundary sum matches the correct structure, the option then asserts calling local maxima because “cross-boundary interactions peak at boundaries,” which inverts the defining logic of insulation (boundaries exhibit reduced cross-boundary flux). Even with additional coverage normalization (e.g., dividing by row or column marginals), the correct decision rule remains to call local minima, not maxima. The stated choice of $k=4$ therefore contradicts the insulation criterion. Verdict — Incorrect.\n\nTherefore, the option that both correctly defines the insulation score grounded in first principles and correctly identifies $k=3$ as the boundary for the provided matrix is Option A.", "answer": "$$\\boxed{A}$$", "id": "2786767"}, {"introduction": "A central goal of modern genomics is to predict the functional consequences of genetic variation, particularly for non-coding variants that may disrupt gene regulation. This advanced exercise challenges you to synthesize multiple layers of genomic and biophysical information into a single, principled model. You will design and implement a scoring rule to prioritize variants that alter CTCF-mediated boundaries by integrating sequence affinity, DNA methylation, and long-range chromatin contact data from HiChIP [@problem_id:2786824].", "problem": "You are tasked with formalizing and implementing a principled, quantitative ranking rule to prioritize genetic variants that alter CCCTC-binding factor (CTCF) binding at boundary elements by integrating changes in sequence-specific affinity, cytosine methylation, and chromatin contact evidence from High-throughput Chromatin conformation capture combined with Chromatin Immunoprecipitation (HiChIP). Your solution must be derived from fundamental, well-tested biophysical and genomic principles and must be implemented as a runnable program that processes a fixed test suite and outputs the computed prioritization scores.\n\nFoundational base to use:\n- Thermodynamic occupancy model of transcription factor binding: at thermodynamic equilibrium, the probability of specific binding at a site with effective binding free energy $E$ relative to a chemical potential $\\mu$ follows the Fermi-Dirac form $p(E) = \\dfrac{1}{1 + \\exp\\left(\\beta\\,(E - \\mu)\\right)}$, where $\\beta$ is the inverse thermal energy in units of $1/(k_B T)$.\n- Sequence affinity to energy mapping: a position weight matrix (PWM) score $S$ for CTCF can be mapped to a binding energy via a linear transformation $E_{\\text{seq}} = -\\alpha\\, S$, where $\\alpha$ is a positive scaling constant measured in units of $k_B T$ per PWM unit, and higher $S$ implies lower $E_{\\text{seq}}$ (stronger binding).\n- Methylation penalty: CpG methylation at the site reduces CTCF binding affinity. Let the methylation fraction be $m \\in [0, 1]$. Model this as an additive penalty to the effective energy, $E_{\\text{meth}} = \\gamma\\, m$, where $\\gamma$ is a positive constant in units of $k_B T$.\n- Distance-dependent regulatory impact: the contribution of a site to a boundary element decays with genomic distance $D$ (in kilobases) to the boundary according to an exponential kernel $w(D) = \\exp\\left(-D/\\lambda\\right)$, where $\\lambda$ is a positive length scale in kilobases.\n- Boundary coupling by HiChIP: HiChIP provides a normalized coupling factor $L \\in [0, 1]$ representing the fractional strength of contact of the site to boundary anchors, with larger $L$ indicating stronger boundary coupling.\n\nTask:\n- Using only the foundational base above, derive a quantitative prioritization rule that ranks variants by their expected disruption of boundary insulation through altered CTCF occupancy. Your rule must:\n  - Compare the reference allele and alternate allele by computing their respective effective energies and occupancies using the same $\\alpha$, $\\beta$, $\\gamma$, and $\\mu$.\n  - Account for methylation identically on both alleles via the methylation penalty.\n  - Emphasize boundary relevance by jointly incorporating $L$ and $w(D)$.\n  - Prioritize occupancy loss events; occupancy gains must not increase the score.\n- Implement this rule in code and apply it to the provided test suite.\n\nConstants to use for this exercise (biophysically reasonable and fixed across all test cases):\n- $\\alpha = 0.1$\n- $\\beta = 1.0$\n- $\\gamma = 2.0$\n- $\\mu = 0.0$\n- $\\lambda = 50.0$ (kilobases)\n\nInput schema for each test case:\n- Reference PWM score $S_{\\text{ref}}$ (float)\n- Alternate PWM score $S_{\\text{alt}}$ (float)\n- Methylation fraction $m$ (float in $[0,1]$)\n- HiChIP boundary coupling $L$ (float in $[0,1]$)\n- Distance to boundary $D$ (float, in kilobases)\n\nTest suite:\n- Case $1$: $(S_{\\text{ref}} = 12.0,\\; S_{\\text{alt}} = 6.0,\\; m = 0.1,\\; L = 0.9,\\; D = 5.0)$\n- Case $2$: $(S_{\\text{ref}} = 8.0,\\; S_{\\text{alt}} = 12.0,\\; m = 0.0,\\; L = 0.85,\\; D = 10.0)$\n- Case $3$: $(S_{\\text{ref}} = 12.0,\\; S_{\\text{alt}} = 6.0,\\; m = 1.0,\\; L = 0.9,\\; D = 5.0)$\n- Case $4$: $(S_{\\text{ref}} = 10.0,\\; S_{\\text{alt}} = 4.0,\\; m = 0.2,\\; L = 0.0,\\; D = 2.0)$\n- Case $5$: $(S_{\\text{ref}} = 9.0,\\; S_{\\text{alt}} = 7.0,\\; m = 0.5,\\; L = 0.5,\\; D = 200.0)$\n- Case $6$: $(S_{\\text{ref}} = 10.0,\\; S_{\\text{alt}} = 9.5,\\; m = 0.2,\\; L = 0.8,\\; D = 5.0)$\n\nProgramming requirements:\n- Your program must compute the prioritization score for each test case derived from the principles above.\n- Report each score as a float rounded to six decimal places.\n- Final output format: a single line containing a comma-separated list of the six results enclosed in square brackets with no spaces, for example $[x_1,x_2,x_3,x_4,x_5,x_6]$ where each $x_i$ is a float rounded to six decimals.", "solution": "The problem statement has been subjected to rigorous validation and is deemed to be valid. It is scientifically grounded in established principles of biophysical chemistry and genomics, is well-posed, objective, and internally consistent. It provides a complete set of models, parameters, and data required to derive and implement a quantitative prioritization rule for genetic variants. We will therefore proceed with the derivation of the solution.\n\nThe objective is to construct a prioritization score, which we will denote as $\\mathcal{S}$, to quantify the disruptive impact of a genetic variant on CTCF binding at a boundary element. This score must integrate the change in binding occupancy with the site's structural importance to the boundary. The derivation proceeds from the foundational principles provided.\n\nFirst, we define the effective binding free energy, $E$, of CTCF to a specific DNA site. This energy is a sum of the sequence-dependent contribution, $E_{\\text{seq}}$, and an energy penalty due to cytosine methylation, $E_{\\text{meth}}$.\nThe problem states that $E_{\\text{seq}} = -\\alpha S$, where $S$ is the Position Weight Matrix (PWM) score and $\\alpha$ is a positive scaling constant. The methylation penalty is given by $E_{\\text{meth}} = \\gamma m$, where $m$ is the methylation fraction and $\\gamma$ is a positive penalty constant.\nThus, the total effective energy for a site with PWM score $S$ and methylation fraction $m$ is:\n$$E(S, m) = E_{\\text{seq}} + E_{\\text{meth}} = -\\alpha S + \\gamma m$$\nThis formulation correctly captures that a higher PWM score (stronger sequence motif) leads to a lower, more favorable binding energy, while increased methylation leads to a higher, less favorable energy.\n\nWe apply this model to both the reference and alternate alleles, which differ only in their PWM scores, $S_{\\text{ref}}$ and $S_{\\text{alt}}$, respectively. The methylation fraction $m$ is assumed to be identical for both alleles at the locus.\nThe energy for the reference allele is:\n$$E_{\\text{ref}} = E(S_{\\text{ref}}, m) = -\\alpha S_{\\text{ref}} + \\gamma m$$\nThe energy for the alternate allele is:\n$$E_{\\text{alt}} = E(S_{\\text{alt}}, m) = -\\alpha S_{\\text{alt}} + \\gamma m$$\n\nNext, we determine the probability of CTCF occupancy, $p$, at the site. This is governed by the provided thermodynamic model, which follows a Fermi-Dirac distribution. The occupancy $p$ for a site with energy $E$ is given relative to a chemical potential $\\mu$:\n$$p(E) = \\frac{1}{1 + \\exp(\\beta(E - \\mu))}$$\nHere, $\\beta$ is the inverse thermal energy. We can now compute the specific occupancies for the reference allele, $p_{\\text{ref}}$, and the alternate allele, $p_{\\text{alt}}$:\n$$p_{\\text{ref}} = p(E_{\\text{ref}}) = \\frac{1}{1 + \\exp(\\beta(E_{\\text{ref}} - \\mu))}$$\n$$p_{\\text{alt}} = p(E_{\\text{alt}}) = \\frac{1}{1 + \\exp(\\beta(E_{\\text{alt}} - \\mu))}$$\n\nThe problem requires prioritization of variants that cause a *loss* of occupancy, as this corresponds to a weakening of the boundary element. An increase in occupancy (i.e., a gain-of-function) should not contribute to the score. We therefore define the occupancy loss, $\\Delta p_{\\text{loss}}$, as the rectified difference between the reference and alternate occupancies:\n$$\\Delta p_{\\text{loss}} = \\max(0, p_{\\text{ref}} - p_{\\text{alt}})$$\nIf $p_{\\text{alt}} \\ge p_{\\text{ref}}$, the score contribution from occupancy change is zero, correctly implementing the constraint.\n\nFinally, the disruptive impact of this occupancy loss must be weighted by the site's importance to the boundary's function. This importance is determined by two independent factors: the HiChIP-measured contact strength, $L$, and the genomic distance to the boundary, $D$. The problem mandates that these be \"jointly incorporated.\" The logical approach to combining such independent weight factors is through multiplication.\nThe distance-dependent weight is given by the exponential kernel $w(D) = \\exp(-D/\\lambda)$, where $\\lambda$ is the characteristic decay length. The total relevance weight, $W$, is therefore:\n$$W(L, D) = L \\cdot w(D) = L \\cdot \\exp(-D/\\lambda)$$\nA value of $L=0$ or a very large $D$ will rightly result in a weight approaching zero, indicating the site is irrelevant to the boundary regardless of occupancy change.\n\nThe final prioritization score, $\\mathcal{S}$, is the product of the occupancy loss and the relevance weight. This synthesizes the magnitude of the biochemical defect with its functional context.\n$$\\mathcal{S} = W(L, D) \\cdot \\Delta p_{\\text{loss}}$$\nSubstituting all components, we arrive at the complete scoring rule:\n$$\\mathcal{S}(S_{\\text{ref}}, S_{\\text{alt}}, m, L, D) = \\left( L \\cdot \\exp(-D/\\lambda) \\right) \\cdot \\max\\left(0, \\frac{1}{1 + \\exp(\\beta(-\\alpha S_{\\text{ref}} + \\gamma m - \\mu))} - \\frac{1}{1 + \\exp(\\beta(-\\alpha S_{\\text{alt}} + \\gamma m - \\mu))}\\right)$$\n\nThis derived rule satisfies all constraints of the problem statement. The following constants are used for computation: $\\alpha = 0.1$, $\\beta = 1.0$, $\\gamma = 2.0$, $\\mu = 0.0$, and $\\lambda = 50.0$. The implementation will apply this formula to each case in the provided test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a quantitative rule to prioritize genetic variants\n    based on their impact on CTCF binding and boundary insulation.\n    \"\"\"\n\n    # Define the fixed biophysical constants from the problem statement.\n    alpha = 0.1  # k_B T per PWM unit\n    beta = 1.0   # 1 / (k_B T)\n    gamma = 2.0  # k_B T\n    mu = 0.0     # k_B T\n    lambda_dist = 50.0  # kilobases\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (S_ref, S_alt, m, L, D)\n    test_cases = [\n        (12.0, 6.0, 0.1, 0.9, 5.0),    # Case 1\n        (8.0, 12.0, 0.0, 0.85, 10.0),  # Case 2\n        (12.0, 6.0, 1.0, 0.9, 5.0),    # Case 3\n        (10.0, 4.0, 0.2, 0.0, 2.0),    # Case 4\n        (9.0, 7.0, 0.5, 0.5, 200.0),   # Case 5\n        (10.0, 9.5, 0.2, 0.8, 5.0),    # Case 6\n    ]\n\n    def calculate_prioritization_score(s_ref, s_alt, m, l_hichip, d_dist):\n        \"\"\"\n        Computes the prioritization score for a single variant.\n        \"\"\"\n        # Step 1: Calculate allele-specific effective binding energies.\n        # E = -alpha * S + gamma * m\n        e_ref = -alpha * s_ref + gamma * m\n        e_alt = -alpha * s_alt + gamma * m\n\n        # Step 2: Calculate allele-specific binding occupancies using Fermi-Dirac model.\n        # p(E) = 1 / (1 + exp(beta * (E - mu)))\n        p_ref = 1.0 / (1.0 + np.exp(beta * (e_ref - mu)))\n        p_alt = 1.0 / (1.0 + np.exp(beta * (e_alt - mu)))\n\n        # Step 3: Calculate occupancy loss, ensuring it's non-negative.\n        # The score only considers loss of occupancy, not gain.\n        occupancy_loss = max(0.0, p_ref - p_alt)\n\n        # Step 4: Calculate the site relevance weight.\n        # W = L * exp(-D / lambda)\n        relevance_weight = l_hichip * np.exp(-d_dist / lambda_dist)\n\n        # Step 5: Compute the final score.\n        # Score is the product of relevance weight and occupancy loss.\n        score = relevance_weight * occupancy_loss\n        \n        return score\n\n    results = []\n    for case in test_cases:\n        s_ref, s_alt, m, l_hichip, d_dist = case\n        score = calculate_prioritization_score(s_ref, s_alt, m, l_hichip, d_dist)\n        # Round the result to six decimal places as required.\n        results.append(f\"{score:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2786824"}]}