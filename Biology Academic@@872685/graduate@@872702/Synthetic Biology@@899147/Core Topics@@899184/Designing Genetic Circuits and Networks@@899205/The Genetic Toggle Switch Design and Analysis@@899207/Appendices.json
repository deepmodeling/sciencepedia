{"hands_on_practices": [{"introduction": "A robust genetic toggle switch must operate in a specific parameter regime to exhibit bistability. This foundational exercise guides you through the classic mathematical analysis that reveals these conditions. By nondimensionalizing the governing equations and performing a linear stability analysis, you will derive the critical threshold where the system transitions from a single stable state to two, providing deep insight into the essential roles of cooperativity and synthesis rate in creating a functional switch [@problem_id:2783261].", "problem": "A canonical mutual-repression genetic toggle switch consists of two genes whose protein products repress each other’s transcription. Under standard quasi–steady-state assumptions for transcriptional regulation and first-order protein degradation, a minimal model for the protein concentrations $U(t)$ and $V(t)$ is given by the ordinary differential equations (ODEs)\n$$\n\\frac{dU}{dt}=\\frac{\\alpha_{1}}{1+\\left(\\frac{V}{K_{2}}\\right)^{n_{2}}}-\\delta_{1}\\,U,\\qquad\n\\frac{dV}{dt}=\\frac{\\alpha_{2}}{1+\\left(\\frac{U}{K_{1}}\\right)^{n_{1}}}-\\delta_{2}\\,V,\n$$\nwhere $t$ is time, $\\alpha_{i}$ are maximal synthesis rates, $\\delta_{i}$ are protein degradation (or dilution) rates, $K_{i}$ are repression thresholds, and $n_{i}$ are Hill coefficients capturing cooperative repression.\n\nStarting from this dimensional model and using only the following fundamentals:\n- Transcriptional repression at steady state is represented by a Hill function of the form $1/\\left(1+(X/K)^{n}\\right)$.\n- Protein removal is dominated by first-order processes with rate constants $\\delta_{i}$.\n- Nondimensionalization proceeds by defining scaled variables that absorb physical units to reduce parameter count.\n\nPerform the following tasks:\n1. Introduce nondimensional variables by scaling concentrations by their repression thresholds and time by a degradation time scale, and derive the nondimensional ODEs with the minimal independent dimensionless parameter groups made explicit.\n2. Specialize to the symmetric case defined by $\\alpha_{1}=\\alpha_{2}=\\alpha$, $\\delta_{1}=\\delta_{2}=\\delta$, $K_{1}=K_{2}=K$, and $n_{1}=n_{2}=n\\geq 1$, and analyze linear stability of the symmetric fixed point along the invariant subspace where the two concentrations are equal. Determine the critical value of the dimensionless production parameter at which this symmetric fixed point first loses stability through a zero eigenvalue, signaling the onset of bistability.\n\nYour final answer must be a single closed-form analytic expression, in terms of the Hill coefficient $n$ only, for the critical dimensionless production parameter. No units are required for the final answer. Do not provide intermediate steps or additional text in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a canonical model from synthetic biology and asks for a standard, albeit non-trivial, mathematical analysis. All necessary information is provided, and the premises are consistent. We may therefore proceed with the solution.\n\nThe problem requires a two-part analysis of a genetic toggle switch model. First, we must nondimensionalize the governing ordinary differential equations (ODEs). Second, we must analyze the stability of the symmetric fixed point in the specialized symmetric case to find the critical parameter value for the onset of bistability.\n\nThe dimensional model is given by the coupled ODEs:\n$$\n\\frac{dU}{dt}=\\frac{\\alpha_{1}}{1+\\left(\\frac{V}{K_{2}}\\right)^{n_{2}}}-\\delta_{1}\\,U\n$$\n$$\n\\frac{dV}{dt}=\\frac{\\alpha_{2}}{1+\\left(\\frac{U}{K_{1}}\\right)^{n_{1}}}-\\delta_{2}\\,V\n$$\nHere, $U(t)$ and $V(t)$ are protein concentrations, $t$ is time, $\\alpha_{i}$ are maximal synthesis rates, $\\delta_{i}$ are first-order degradation rates, $K_{i}$ are repression thresholds (concentrations for half-maximal repression), and $n_{i}$ are Hill coefficients signifying the cooperativity of repression.\n\n**Part 1: Nondimensionalization**\nWe introduce dimensionless variables as instructed. We scale the concentrations by their respective repression thresholds:\n$$\nu = \\frac{U}{K_{1}}, \\qquad v = \\frac{V}{K_{2}}\n$$\nWe scale time by one of the degradation time scales. Let us choose $\\frac{1}{\\delta_1}$, defining dimensionless time $\\tau$:\n$$\n\\tau = \\delta_{1}t\n$$\nFrom these definitions, we have $U = u K_{1}$, $V = v K_{2}$, and $t = \\frac{\\tau}{\\delta_1}$. The time derivative transforms as $\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = \\delta_{1}\\frac{d}{d\\tau}$.\n\nSubstituting these into the first ODE:\n$$\n\\delta_{1}\\frac{d(u K_{1})}{d\\tau} = \\frac{\\alpha_{1}}{1+v^{n_{2}}} - \\delta_{1} u K_{1}\n$$\n$$\nK_{1}\\delta_{1}\\frac{du}{d\\tau} = \\frac{\\alpha_{1}}{1+v^{n_{2}}} - \\delta_{1} u K_{1}\n$$\nDividing by $K_{1}\\delta_{1}$:\n$$\n\\frac{du}{d\\tau} = \\frac{\\alpha_{1}}{K_{1}\\delta_{1}}\\frac{1}{1+v^{n_{2}}} - u\n$$\nNow, substituting into the second ODE:\n$$\n\\delta_{1}\\frac{d(v K_{2})}{d\\tau} = \\frac{\\alpha_{2}}{1+u^{n_{1}}} - \\delta_{2} v K_{2}\n$$\n$$\nK_{2}\\delta_{1}\\frac{dv}{d\\tau} = \\frac{\\alpha_{2}}{1+u^{n_{1}}} - \\delta_{2} v K_{2}\n$$\nDividing by $K_{2}\\delta_{1}$:\n$$\n\\frac{dv}{d\\tau} = \\frac{\\alpha_{2}}{K_{2}\\delta_{1}}\\frac{1}{1+u^{n_{1}}} - \\frac{\\delta_{2}}{\\delta_{1}} v\n$$\nThe system is now expressed in terms of dimensionless variables $\\{u, v, \\tau\\}$. We identify the independent dimensionless parameter groups:\n- Dimensionless synthesis rates: $\\tilde{\\alpha}_{1} = \\frac{\\alpha_{1}}{K_{1}\\delta_{1}}$ and $\\tilde{\\alpha}_{2} = \\frac{\\alpha_{2}}{K_{2}\\delta_{1}}$.\n- Ratio of degradation rates: $\\gamma = \\frac{\\delta_{2}}{\\delta_{1}}$.\nThe Hill coefficients $n_{1}$ and $n_{2}$ are already dimensionless.\n\nThe nondimensional system is:\n$$\n\\frac{du}{d\\tau} = \\frac{\\tilde{\\alpha}_{1}}{1+v^{n_{2}}} - u\n$$\n$$\n\\frac{dv}{d\\tau} = \\frac{\\tilde{\\alpha}_{2}}{1+u^{n_{1}}} - \\gamma v\n$$\n\n**Part 2: Stability Analysis of the Symmetric Case**\nWe now specialize to the symmetric case, where $\\alpha_{1}=\\alpha_{2}=\\alpha$, $\\delta_{1}=\\delta_{2}=\\delta$, $K_{1}=K_{2}=K$, and $n_{1}=n_{2}=n$.\nThe dimensionless parameters become:\n- $\\tilde{\\alpha}_{1} = \\frac{\\alpha}{K\\delta}$ and $\\tilde{\\alpha}_{2} = \\frac{\\alpha}{K\\delta}$. Let us denote this common dimensionless production parameter as $\\beta = \\frac{\\alpha}{K\\delta}$.\n- $\\gamma = \\frac{\\delta}{\\delta} = 1$.\n\nThe symmetric dimensionless system is:\n$$\n\\frac{du}{d\\tau} = \\frac{\\beta}{1+v^{n}} - u \\equiv f(u,v)\n$$\n$$\n\\frac{dv}{d\\tau} = \\frac{\\beta}{1+u^{n}} - v \\equiv g(u,v)\n$$\nWe seek the symmetric fixed point, where $u=v$. Let the fixed point coordinates be $(u^{*}, v^{*})$. For a symmetric fixed point, $u^{*} = v^{*} = x^{*}$. Setting the time derivatives to zero, the fixed point condition becomes a single equation:\n$$\nx^{*} = \\frac{\\beta}{1+(x^{*})^{n}}\n$$\nTo analyze the linear stability of this fixed point, we compute the Jacobian matrix $J$ of the system:\n$$\nJ(u,v) = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\beta n v^{n-1}}{(1+v^{n})^{2}} \\\\ -\\frac{\\beta n u^{n-1}}{(1+u^{n})^{2}}  -1 \\end{pmatrix}\n$$\nEvaluating the Jacobian at the symmetric fixed point $(x^{*}, x^{*})$:\n$$\nJ(x^{*},x^{*}) = \\begin{pmatrix} -1  -\\frac{\\beta n (x^{*})^{n-1}}{(1+(x^{*})^{n})^{2}} \\\\ -\\frac{\\beta n (x^{*})^{n-1}}{(1+(x^{*})^{n})^{2}}  -1 \\end{pmatrix}\n$$\nFrom the fixed point equation, we can substitute $\\beta = x^{*}(1+(x^{*})^{n})$. The off-diagonal terms become:\n$$\n-\\frac{x^{*}(1+(x^{*})^{n}) n (x^{*})^{n-1}}{(1+(x^{*})^{n})^{2}} = -\\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}\n$$\nLet this term be denoted by $C$. The Jacobian at the fixed point is $J = \\begin{pmatrix} -1  C \\\\ C  -1 \\end{pmatrix}$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -1-\\lambda  C \\\\ C  -1-\\lambda \\end{pmatrix} = (-1-\\lambda)^{2} - C^{2} = 0\n$$\n$$\n(\\lambda+1)^{2} = C^{2} \\implies \\lambda+1 = \\pm C \\implies \\lambda = -1 \\pm C\n$$\nThe two eigenvalues are:\n$$\n\\lambda_{1} = -1 + C = -1 - \\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}\n$$\n$$\n\\lambda_{2} = -1 - C = -1 + \\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}\n$$\nFor the fixed point to be stable, both eigenvalues must have negative real parts.\nSince $n \\ge 1$ and $x^{*} > 0$, the term $\\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}$ is always positive. Therefore, $\\lambda_{1}$ is always negative. Stability is determined by the sign of $\\lambda_{2}$.\nThe symmetric fixed point loses stability when $\\lambda_{2}$ passes through zero from negative to positive. This bifurcation marks the emergence of new, asymmetric fixed points, corresponding to the onset of bistability. The critical condition is $\\lambda_{2}=0$. Let $x^{*}_{c}$ be the fixed point value at the bifurcation.\n$$\n-1 + \\frac{n (x^{*}_{c})^{n}}{1+(x^{*}_{c})^{n}} = 0\n$$\n$$\nn (x^{*}_{c})^{n} = 1+(x^{*}_{c})^{n}\n$$\n$$\n(n-1)(x^{*}_{c})^{n} = 1\n$$\nThis equation has a meaningful solution for $x^{*}_{c} > 0$ only if $n > 1$. If $n=1$, the equation becomes $0=1$, which is impossible. For $n=1$, $\\lambda_{2} = -1 + \\frac{x^{*}}{1+x^{*}} = -\\frac{1}{1+x^{*}}  0$, so the system is always monostable. The phenomenon of bistability in this switch requires cooperative repression, i.e., $n1$.\n\nFor $n1$, we solve for the critical fixed point concentration $x^{*}_{c}$:\n$$\n(x^{*}_{c})^{n} = \\frac{1}{n-1} \\implies x^{*}_{c} = \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}}\n$$\nThe problem asks for the critical value of the dimensionless production parameter, $\\beta_{c}$. We find this by substituting $x^{*}_{c}$ back into the fixed point equation:\n$$\n\\beta_{c} = x^{*}_{c}(1+(x^{*}_{c})^{n})\n$$\n$$\n\\beta_{c} = \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}} \\left(1 + \\frac{1}{n-1}\\right)\n$$\nSimplifying the second term:\n$$\n1 + \\frac{1}{n-1} = \\frac{n-1+1}{n-1} = \\frac{n}{n-1}\n$$\nThus, the critical value $\\beta_{c}$ is:\n$$\n\\beta_{c} = \\frac{n}{n-1} \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}} = \\frac{n}{(n-1)^{1} (n-1)^{\\frac{1}{n}}} = \\frac{n}{(n-1)^{1+\\frac{1}{n}}}\n$$\nThis expression can be written finally as:\n$$\n\\beta_{c} = \\frac{n}{(n-1)^{\\frac{n+1}{n}}}\n$$\nThis is the critical value of the dimensionless production parameter at which the symmetric steady state loses stability, giving rise to bistability. This bifurcation is a supercritical pitchfork bifurcation.", "answer": "$$\n\\boxed{\\frac{n}{(n-1)^{\\frac{n+1}{n}}}}\n$$", "id": "2783261"}, {"introduction": "While analytical methods reveal the conditions for bistability, they often fall short in providing the exact steady-state concentrations for specific, potentially asymmetric, designs. This computational practice addresses that gap by having you develop a numerical algorithm to find all fixed points of the toggle switch system. This technique, based on finding the intersections of the system's nullclines, is a powerful and generalizable tool for analyzing the behavior of any complex regulatory network [@problem_id:2783277].", "problem": "You will design and implement a numerical procedure to compute all distinct fixed points of a classical two-gene Genetic Toggle Switch model under transcriptional repression with Hill-type regulation and to report the number of solutions for each of several parameter sets. The toggle switch is modeled at the protein level by the following dimensionless ordinary differential equations, derived from the Central Dogma of Molecular Biology (DNA transcribed to RNA, translated to protein) and well-tested Hill repression functions for transcriptional control:\n- For protein concentrations $x(t)$ and $y(t)$,\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^{n}} \\;-\\; x,\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^{m}} \\;-\\; y.\n$$\nHere $\\alpha_x,\\alpha_y$ are dimensionless maximal synthesis parameters, $K_x,K_y$ are dimensionless repression thresholds, and $n,m$ are Hill coefficients (cooperativity). A fixed point is any pair $(x^\\ast,y^\\ast)$ that satisfies the steady-state conditions $\\frac{dx}{dt}=0$ and $\\frac{dy}{dt}=0$ simultaneously.\n\nYour program must, for each parameter set in the test suite below, compute all distinct fixed points $(x^\\ast,y^\\ast)$ with $x^\\ast \\ge 0$ and $y^\\ast \\ge 0$, and then output only the number of distinct solutions found. Distinctness must be determined by the following criterion: two solutions $(x_1,y_1)$ and $(x_2,y_2)$ represent the same fixed point if both $|x_1-x_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|x_1|,|x_2|\\}$ and $|y_1-y_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|y_1|,|y_2|\\}$, where $\\varepsilon_{\\text{abs}} = 10^{-8}$ and $\\varepsilon_{\\text{rel}} = 10^{-6}$.\n\nScientific assumptions and constraints:\n- All parameters $\\alpha_x,\\alpha_y,K_x,K_y,n,m$ are strictly positive real numbers.\n- Physically admissible fixed points have $x^\\ast \\ge 0$ and $y^\\ast \\ge 0$. Any candidate solutions that violate these inequalities must be discarded.\n- Units are dimensionless by construction; report only dimensionless counts for the number of solutions.\n- Your search domain for $x^\\ast$ and $y^\\ast$ may be bounded using model-implied maxima; it is rigorously true that any fixed point must satisfy $0 \\le x^\\ast \\le \\alpha_x$ and $0 \\le y^\\ast \\le \\alpha_y$.\n\nYour numerical procedure must be general and robust across the test suite, and it must not rely on analytical closed forms for the fixed points. You may use floating-point computations. Angle units are not applicable. Results must be deterministic.\n\nTest suite (each item is a tuple $(\\alpha_x,\\alpha_y,K_x,K_y,n,m)$):\n- Case A: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (50,50,1,1,4,4)$\n- Case B: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (10,10,1,1,1,1)$\n- Case C: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (40,8,1,1,4,4)$\n- Case D: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (10,10,5,5,3,3)$\n- Case E: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (6,6,1,1,1.5,1.5)$\n\nFinal output specification:\n- Your program should produce a single line of output containing a list of integers, one per test case in the order listed above, giving the number of distinct fixed points found for each case.\n- The output must be a single line in the exact format\n\"[rA,rB,rC,rD,rE]\"\nwhere $rA$ is the integer result for Case A, and so on.", "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded in the established theory of genetic regulatory networks, mathematically well-posed, and presented with objective, unambiguous specifications. It represents a standard, non-trivial problem in computational systems biology. We may therefore proceed with a solution.\n\nThe task is to find the number of distinct, non-negative fixed points $(x^\\ast, y^\\ast)$ for a system of two coupled ordinary differential equations representing a genetic toggle switch. A fixed point is a steady-state solution where the time derivatives are zero. The system is given by:\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^{m}} - y\n$$\nSetting the derivatives to zero provides the conditions for the fixed points $(x^\\ast, y^\\ast)$:\n$$\nx^\\ast = \\frac{\\alpha_x}{1 + \\left(\\frac{y^\\ast}{K_y}\\right)^{n}} \\quad \\equiv f(y^\\ast)\n$$\n$$\ny^\\ast = \\frac{\\alpha_y}{1 + \\left(\\frac{x^\\ast}{K_x}\\right)^{m}} \\quad \\equiv g(x^\\ast)\n$$\nThese two equations define the nullclines of the system. The fixed points are the intersection points of these two nullclines in the non-negative quadrant of the $(x, y)$ plane.\n\nTo solve this system numerically without relying on analytical forms, we can reduce it to a root-finding problem for a single variable. By substituting the expression for $y^\\ast$ into the equation for $x^\\ast$, we obtain a single equation for $x^\\ast$:\n$$\nx^\\ast = f(g(x^\\ast)) = \\frac{\\alpha_x}{1 + \\left( \\frac{1}{K_y} \\left( \\frac{\\alpha_y}{1 + \\left(\\frac{x^\\ast}{K_x}\\right)^{m}} \\right) \\right)^{n}}\n$$\nA fixed point's $x$-coordinate, $x^\\ast$, must be a root of the function $H(x)$:\n$$\nH(x) = x - f(g(x)) = 0\n$$\nThe problem statement correctly indicates that any physically meaningful solution must satisfy $0 \\le x^\\ast \\le \\alpha_x$ and $0 \\le y^\\ast \\le \\alpha_y$. This is because the Hill-type repression terms are bounded. Consequently, we can confine our search for the roots of $H(x)=0$ to the closed interval $[0, \\alpha_x]$.\n\nThe numerical procedure to find all such roots is as follows:\n1.  **Discretize the Domain**: The search interval $[0, \\alpha_x]$ for $x$ is divided into a large number of small subintervals using a fine grid. Let the grid points be $x_i$ for $i=0, 1, \\dots, N$.\n2.  **Bracket Potential Roots**: The function $H(x)$ is evaluated at each grid point $x_i$. A root is guaranteed to exist in a subinterval $[x_i, x_{i+1}]$ if $H(x_i)$ and $H(x_{i+1})$ have opposite signs, i.e., $H(x_i) \\cdot H(x_{i+1})  0$. This is a consequence of the Intermediate Value Theorem, as the function $H(x)$ is continuous. We also explicitly check for roots that fall exactly on a grid point, where $H(x_i) = 0$.\n3.  **Refine Roots**: For each subinterval $[x_i, x_{i+1}]$ that brackets a root, a robust numerical root-finding algorithm is employed to determine the root $x^\\ast$ with high precision. The Brent-Dekker method (`brentq` in `scipy.optimize`) is an excellent choice for this task as it combines guaranteed convergence with high efficiency.\n4.  **Construct Full Solution**: For each distinct root $x^\\ast_j$ found, the corresponding $y$-coordinate is calculated using the nullcline equation $y^\\ast_j = g(x^\\ast_j)$. This gives a candidate fixed point $(x^\\ast_j, y^\\ast_j)$.\n5.  **Filter for Distinct Solutions**: The procedure may find multiple numerical approximations of the same mathematical root due to the nature of the grid search. Therefore, the list of candidate solutions must be filtered to retain only distinct fixed points. This is accomplished by iterating through the list of solutions and comparing each new solution to the already-accepted distinct solutions using the precise tolerance criterion specified in the problem: two points $(x_1, y_1)$ and $(x_2, y_2)$ are considered identical if $|x_1 - x_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|x_1|, |x_2|\\}$ and $|y_1 - y_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|y_1|, |y_2|\\}$, with $\\varepsilon_{\\text{abs}} = 10^{-8}$ and $\\varepsilon_{\\text{rel}} = 10^{-6}$.\n\nThis systematic approach ensures that all fixed points within the specified domain are found and counted accurately, in adherence to the problem's constraints. The final Python implementation will execute this logic for each parameter set provided in the test suite.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the genetic toggle switch problem for all test cases.\n    It computes the number of distinct fixed points for each parameter set and\n    prints the results in the specified format.\n    \"\"\"\n    test_cases = [\n        # (alpha_x, alpha_y, K_x, K_y, n, m)\n        (50.0, 50.0, 1.0, 1.0, 4.0, 4.0),  # Case A\n        (10.0, 10.0, 1.0, 1.0, 1.0, 1.0),  # Case B\n        (40.0, 8.0, 1.0, 1.0, 4.0, 4.0),   # Case C\n        (10.0, 10.0, 5.0, 5.0, 3.0, 3.0),  # Case D\n        (6.0, 6.0, 1.0, 1.0, 1.5, 1.5),    # Case E\n    ]\n\n    results = []\n    for params in test_cases:\n        num_solutions = count_fixed_points(params)\n        results.append(num_solutions)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef count_fixed_points(params):\n    \"\"\"\n    Calculates the number of distinct fixed points for a given set of parameters.\n    \"\"\"\n    alpha_x, alpha_y, K_x, K_y, n, m = params\n    \n    eps_abs = 1e-8\n    eps_rel = 1e-6\n\n    def is_close(p1, p2):\n        \"\"\"\n        Custom comparison function to determine if two points are the same\n        based on the problem's specific tolerance definition.\n        \"\"\"\n        x1, y1 = p1\n        x2, y2 = p2\n        \n        x_tol = eps_abs + eps_rel * max(abs(x1), abs(x2))\n        y_tol = eps_abs + eps_rel * max(abs(y1), abs(y2))\n        \n        return abs(x1 - x2) = x_tol and abs(y1 - y2) = y_tol\n\n    def g(x_val):\n        \"\"\"Defines the nullcline function y = g(x).\"\"\"\n        x_safe = np.maximum(x_val, 0)\n        return alpha_y / (1.0 + (x_safe / K_x)**m)\n\n    def f(y_val):\n        \"\"\"Defines the nullcline function x = f(y).\"\"\"\n        y_safe = np.maximum(y_val, 0)\n        return alpha_x / (1.0 + (y_safe / K_y)**n)\n\n    def H(x_val):\n        \"\"\"Root-finding function H(x) = x - f(g(x)).\"\"\"\n        return x_val - f(g(x_val))\n\n    search_min = 0.0\n    search_max = alpha_x\n    \n    N_grid = 20000\n    x_grid = np.linspace(search_min, search_max, N_grid)\n    \n    solutions = []\n\n    try:\n        h_vals = np.array([H(xi) for xi in x_grid])\n    except (OverflowError, ValueError):\n        # Fallback for numerical instability, though not expected here\n        print(\"Warning: Numerical instability encountered.\")\n        return 0\n\n    # Grid scan to bracket and find roots\n    for i in range(N_grid - 1):\n        h1, h2 = h_vals[i], h_vals[i+1]\n        x1, x2 = x_grid[i], x_grid[i+1]\n\n        root_to_add = None\n        if h1 * h2  0:\n            try:\n                # A root is bracketed, refine it with brentq\n                root_to_add = brentq(H, x1, x2)\n            except ValueError:\n                # This should not be reached if h1*h2  0, but is a safeguard\n                pass\n        elif h1 == 0:\n            # A root lies exactly on a grid point\n            root_to_add = x1\n            \n        if root_to_add is not None:\n            solutions.append((root_to_add, g(root_to_add)))\n    \n    # Check the very last grid point\n    if h_vals[-1] == 0:\n        root_to_add = x_grid[-1]\n        solutions.append((root_to_add, g(root_to_add)))\n\n    # Filter for distinct solutions using the specified tolerance\n    distinct_solutions = []\n    if not solutions:\n        return 0\n    \n    for sol in solutions:\n        is_distinct = True\n        for d_sol in distinct_solutions:\n            if is_close(sol, d_sol):\n                is_distinct = False\n                break\n        if is_distinct:\n            # Check physical admissibility (x>=0, y>=0)\n            if sol[0] >= 0 and sol[1] >= 0:\n                distinct_solutions.append(sol)\n            \n    return len(distinct_solutions)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2783277"}, {"introduction": "A central challenge in synthetic biology is bridging the gap between abstract mathematical models and real biological systems. This practice immerses you in this process by tasking you with fitting a thermodynamic model of gene regulation to simulated experimental data. By performing a nonlinear least-squares fit, you will infer a key biophysical parameter—the repressor-operator binding energy—and learn how to quantitatively connect theoretical models with experimental measurements [@problem_id:2783204].", "problem": "You are tasked with implementing and validating a thermodynamic promoter-occupancy model for a single-input dose-response measurement extracted from a two-gene genetic toggle switch. The toggle switch is comprised of two mutually repressing transcription factors, but you will focus on steady-state dose-response measurements obtained when the opposing arm is fully inactivated by saturating inducer, so that the measured promoter is effectively under simple repression by a single repressor species whose activity is controlled by its cognate inducer. Your goal is to infer the sequence-specific repressor-operator binding free energy from each dataset by fitting the model to the measurements and then quantitatively compare the inferred binding energies to literature benchmarks.\n\nModeling assumptions and constraints:\n- Use a thermodynamic occupancy model for simple repression grounded in equilibrium statistical mechanics. Start from the principle that the probability that the promoter is unbound and transcriptionally active is set by the ratio of Boltzmann weights for the unbound versus repressor-bound states.\n- The repressor fluctuates between active and inactive conformations depending on the inducer concentration. Assume that ligand binding follows reversible equilibrium with an effective dissociation constant and an effective cooperativity, so that the fraction of active repressor decreases monotonically with inducer concentration. Use this standard equilibrium form as the only description of ligand dependence.\n- You may assume the number of nonspecific binding sites on the genome is fixed and known. You may also assume that the number of repressor molecules per cell, the inducer dissociation constant, and the effective cooperativity are known for each dataset and do not need to be inferred.\n\nYour tasks:\n1. Derive, from the promoter occupancy framework and equilibrium ligand binding, an explicit expression for the steady-state fold-change in gene expression as a function of inducer concentration, the repressor copy number, the genomic nonspecific site count, the ligand-binding parameters, and the sequence-specific repressor-operator binding free energy. In your derivation, treat the free energy in units of Boltzmann constant times temperature.\n2. Devise and implement a numerical estimator that, for a given dataset, fits the single unknown parameter (the sequence-specific repressor-operator binding free energy) by minimizing the sum of squared residuals between the model-predicted fold-change and the measured fold-change values.\n3. For each dataset in the test suite below, infer the binding free energy, compare it to the specified literature benchmark, and report the absolute error. Energies must be expressed in the unit Boltzmann constant times temperature. Concentrations are given in micromolar.\n\nConstants and parameter definitions:\n- Genomic nonspecific site count: use $N_{\\mathrm{NS}} = 4.6 \\times 10^{6}$ (dimensionless).\n- For each dataset, the following are provided:\n  - Repressor copy number per cell $R$ (dimensionless).\n  - Inducer dissociation constant $K$ (in micromolar).\n  - Effective cooperativity $h$ (dimensionless).\n  - Measured inducer concentrations $c$ (in micromolar).\n  - Measured steady-state fold-change values $\\mathrm{FC}_{\\mathrm{meas}}$ (dimensionless).\n  - Literature binding free energy $\\Delta \\varepsilon_{\\mathrm{lit}}$ (in units of $k_{\\mathrm{B}}T$).\n\nTest suite (provide complete coverage: a typical strong binder, a mid-strength binder with high-affinity inducer, and a weaker binder):\n- Case A:\n  - $R = 20$, $K = 10.0$ micromolar, $h = 2.0$.\n  - $c$ (micromolar) = [$0.0$, $0.01$, $0.1$, $1.0$, $10.0$, $100.0$].\n  - $\\mathrm{FC}_{\\mathrm{meas}}$ = [$0.066$, $0.066$, $0.066$, $0.066$, $0.123$, $0.877$].\n  - $\\Delta \\varepsilon_{\\mathrm{lit}} = -15.0$ in $k_{\\mathrm{B}}T$.\n- Case B:\n  - $R = 40$, $K = 0.05$ micromolar, $h = 1.0$.\n  - $c$ (micromolar) = [$0.0$, $0.01$, $0.05$, $0.5$, $5.0$].\n  - $\\mathrm{FC}_{\\mathrm{meas}}$ = [$0.206$, $0.238$, $0.342$, $0.741$, $0.962$].\n  - $\\Delta \\varepsilon_{\\mathrm{lit}} = -13.0$ in $k_{\\mathrm{B}}T$.\n- Case C:\n  - $R = 100$, $K = 1.0$ micromolar, $h = 1.0$.\n  - $c$ (micromolar) = [$0.0$, $0.1$, $1.0$, $10.0$].\n  - $\\mathrm{FC}_{\\mathrm{meas}}$ = [$0.677$, $0.697$, $0.808$, $0.958$].\n  - $\\Delta \\varepsilon_{\\mathrm{lit}} = -10.0$ in $k_{\\mathrm{B}}T$.\n\nAngle units are not applicable. No other physical units appear beyond those explicitly stated.\n\nProgram requirements:\n- Implement the estimator and apply it to all three cases.\n- For each case, compute the absolute error $|\\Delta \\varepsilon_{\\mathrm{fit}} - \\Delta \\varepsilon_{\\mathrm{lit}}|$ in units of $k_{\\mathrm{B}}T$.\n- Your program should produce a single line of output containing the absolute errors for the three cases as a comma-separated list enclosed in square brackets, with each value rounded to three decimal places, for example: [$x_{A}$,$x_{B}$,$x_{C}$], where each $x$ is a float in $k_{\\mathrm{B}}T$.\n\nYour implementation must be completely self-contained and runnable without any user input. The only acceptable outputs are real numbers as specified. No text other than the required single-line list is permitted in the program’s output.", "solution": "We begin from the promoter occupancy model for simple repression under equilibrium statistical mechanics. The states are: promoter unbound and transcriptionally active, and promoter bound by an active repressor and transcriptionally inactive. The probability of a state is proportional to its Boltzmann weight. Denote by $R_{\\mathrm{A}}$ the number of active repressors per cell, by $N_{\\mathrm{NS}}$ the number of nonspecific genomic binding sites, and by $\\Delta \\varepsilon$ the sequence-specific repressor-operator binding free energy relative to nonspecific binding, in units of Boltzmann constant times temperature ($k_{\\mathrm{B}}T$). The effective statistical weight for the repressor-bound state relative to the unbound state scales as the product of the availability term $R_{\\mathrm{A}}/N_{\\mathrm{NS}}$ and the specific binding factor $\\exp\\left(-\\Delta \\varepsilon\\right)$, where the minus sign follows from the convention that favorable specific binding has $\\Delta \\varepsilon  0$.\n\nLet the fold-change in gene expression $\\mathrm{FC}$ be the transcriptional activity normalized to the unregulated promoter activity. For simple repression with a single operator, the fold-change is the probability that the operator is unoccupied by an active repressor, which is the weight of the unbound state divided by the sum of the weights of the unbound and repressor-bound states. Denoting the ratio of the bound to unbound weights by $w$, we have\n$$\n\\mathrm{FC} = \\frac{1}{1 + w}.\n$$\nUnder simple repression with $R_{\\mathrm{A}}$ active repressors,\n$$\nw = \\frac{R_{\\mathrm{A}}}{N_{\\mathrm{NS}}}\\,\\exp\\left(-\\Delta \\varepsilon\\right).\n$$\nLigand (inducer) reduces the fraction of repressors in the active DNA-binding conformation. Assume standard reversible ligand binding with an effective dissociation constant $K$ and an effective cooperativity $h$, so that the fraction of active repressors is a decreasing sigmoidal function of inducer concentration $c$. A widely used equilibrium representation for the active fraction is the Hill form\n$$\nf_{\\mathrm{A}}(c) = \\frac{1}{1 + \\left(\\frac{c}{K}\\right)^{h}},\n$$\nwhich follows from the law of mass action when $h$ binding sites contribute cooperatively. Then $R_{\\mathrm{A}} = R \\, f_{\\mathrm{A}}(c)$, where $R$ is the total repressor copy number per cell. Substituting, the fold-change as a function of $c$ becomes\n$$\n\\mathrm{FC}(c; \\Delta \\varepsilon) = \\frac{1}{1 + \\left(\\frac{R}{N_{\\mathrm{NS}}}\\right)\\exp\\left(-\\Delta \\varepsilon\\right)\\, f_{\\mathrm{A}}(c)}.\n$$\nIn these expressions, $\\Delta \\varepsilon$ is in units of $k_{\\mathrm{B}}T$, making it dimensionless, $R$ and $N_{\\mathrm{NS}}$ are dimensionless counts, and $f_{\\mathrm{A}}(c)$ is dimensionless.\n\nEstimation strategy: For each dataset with known $R$, $K$, $h$, $N_{\\mathrm{NS}}$, measured inducer concentrations $\\{c_{i}\\}$, and measured fold-changes $\\{\\mathrm{FC}_{i}^{\\mathrm{meas}}\\}$, we fit the single unknown $\\Delta \\varepsilon$ by minimizing the sum of squared residuals\n$$\n\\mathrm{SSE}(\\Delta \\varepsilon) = \\sum_{i} \\left[ \\mathrm{FC}\\!\\left(c_{i}; \\Delta \\varepsilon\\right) - \\mathrm{FC}_{i}^{\\mathrm{meas}} \\right]^{2}.\n$$\nThis is a one-dimensional, smooth, bounded optimization problem. We constrain $\\Delta \\varepsilon$ to a physically plausible interval, for example $\\Delta \\varepsilon \\in [-25, -5]$ in units of $k_{\\mathrm{B}}T$, consistent with typical bacterial repressor-operator specificities. We solve\n$$\n\\Delta \\varepsilon_{\\mathrm{fit}} = \\arg\\min_{\\Delta \\varepsilon \\in [-25,-5]} \\mathrm{SSE}(\\Delta \\varepsilon)\n$$\nusing a robust bounded scalar minimization algorithm.\n\nAfter fitting, we quantify agreement with literature by computing the absolute error for each dataset:\n$$\n\\text{AbsErr} = \\left| \\Delta \\varepsilon_{\\mathrm{fit}} - \\Delta \\varepsilon_{\\mathrm{lit}} \\right| \\quad \\text{in } k_{\\mathrm{B}}T.\n$$\n\nAlgorithmic steps implemented in the program:\n- Define $N_{\\mathrm{NS}} = 4.6 \\times 10^{6}$.\n- For each test case, load $R$, $K$ (micromolar), $h$, the vector of inducer concentrations $c$ (micromolar), the vector of measured fold-changes, and $\\Delta \\varepsilon_{\\mathrm{lit}}$ ($k_{\\mathrm{B}}T$).\n- For a trial $\\Delta \\varepsilon$, compute $f_{\\mathrm{A}}(c) = \\left[1 + (c/K)^{h}\\right]^{-1}$, then $\\mathrm{FC}(c; \\Delta \\varepsilon) = \\left[1 + (R/N_{\\mathrm{NS}})\\,\\exp(-\\Delta \\varepsilon)\\, f_{\\mathrm{A}}(c)\\right]^{-1}$, and evaluate $\\mathrm{SSE}(\\Delta \\varepsilon)$.\n- Minimize $\\mathrm{SSE}(\\Delta \\varepsilon)$ over $\\Delta \\varepsilon \\in [-25,-5]$ to obtain $\\Delta \\varepsilon_{\\mathrm{fit}}$.\n- Compute $\\text{AbsErr} = \\left|\\Delta \\varepsilon_{\\mathrm{fit}} - \\Delta \\varepsilon_{\\mathrm{lit}}\\right|$.\n- Report the three absolute errors as a single list, formatted as a single line: [$x_{A}$,$x_{B}$,$x_{C}$], with each $x$ rounded to three decimal places. All three values are in $k_{\\mathrm{B}}T$.\n\nNotes on scientific realism and edge cases:\n- The test cases span strong binding ($\\Delta \\varepsilon \\approx -15$), moderate binding ($\\Delta \\varepsilon \\approx -13$) with high-affinity inducer ($K \\approx 0.05$ micromolar), and weaker binding ($\\Delta \\varepsilon \\approx -10$), providing coverage over repression strengths and inducer regimes.\n- The inclusion of $c = 0$ ensures the boundary condition where all repressors are active ($f_{\\mathrm{A}}(0) = 1$). At high $c$, $f_{\\mathrm{A}}(c) \\to 0$, recovering near-unregulated activity. The estimator remains well-posed across these limits because the fold-change remains bounded between $0$ and $1$.\n- All energies are reported in $k_{\\mathrm{B}}T$ as required, and all concentrations are specified in micromolar. There are no angles or percentage units in this task.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef active_fraction(c, K, h):\n    # c and K in micromolar, h dimensionless\n    # Hill-form active fraction for an inducer that reduces activity\n    return 1.0 / (1.0 + (c / K) ** h)\n\ndef fold_change(c, R, N_NS, K, h, delta_e):\n    # delta_e in k_B T (dimensionless)\n    fA = active_fraction(c, K, h)\n    a = (R / N_NS) * np.exp(-delta_e)\n    return 1.0 / (1.0 + a * fA)\n\ndef fit_delta_e(c_vals, fc_meas, R, N_NS, K, h, bounds=(-25.0, -5.0)):\n    c_vals = np.asarray(c_vals, dtype=float)\n    fc_meas = np.asarray(fc_meas, dtype=float)\n\n    def sse(delta_e):\n        fc_pred = fold_change(c_vals, R, N_NS, K, h, delta_e)\n        return np.sum((fc_pred - fc_meas) ** 2)\n\n    res = minimize_scalar(sse, bounds=bounds, method='bounded', options={'xatol': 1e-8, 'maxiter': 500})\n    return res.x\n\ndef solve():\n    N_NS = 4.6e6  # genomic nonspecific sites (dimensionless)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A',\n            'R': 20.0,\n            'K': 10.0,   # micromolar\n            'h': 2.0,\n            'c': np.array([0.0, 0.01, 0.1, 1.0, 10.0, 100.0], dtype=float),\n            'fc_meas': np.array([0.066, 0.066, 0.066, 0.066, 0.123, 0.877], dtype=float),\n            'delta_e_lit': -15.0  # k_B T\n        },\n        {\n            'name': 'B',\n            'R': 40.0,\n            'K': 0.05,   # micromolar\n            'h': 1.0,\n            'c': np.array([0.0, 0.01, 0.05, 0.5, 5.0], dtype=float),\n            'fc_meas': np.array([0.206, 0.238, 0.342, 0.741, 0.962], dtype=float),\n            'delta_e_lit': -13.0  # k_B T\n        },\n        {\n            'name': 'C',\n            'R': 100.0,\n            'K': 1.0,    # micromolar\n            'h': 1.0,\n            'c': np.array([0.0, 0.1, 1.0, 10.0], dtype=float),\n            'fc_meas': np.array([0.677, 0.697, 0.808, 0.958], dtype=float),\n            'delta_e_lit': -10.0  # k_B T\n        },\n    ]\n\n    errors = []\n    for case in test_cases:\n        delta_fit = fit_delta_e(case['c'], case['fc_meas'], case['R'], N_NS, case['K'], case['h'])\n        abs_err = abs(delta_fit - case['delta_e_lit'])\n        errors.append(abs_err)\n\n    # Final print statement in the exact required format: three numbers rounded to 3 decimals.\n    formatted = \"[\" + \",\".join(f\"{e:.3f}\" for e in errors) + \"]\"\n    print(formatted)\n\nsolve()\n```", "id": "2783204"}]}