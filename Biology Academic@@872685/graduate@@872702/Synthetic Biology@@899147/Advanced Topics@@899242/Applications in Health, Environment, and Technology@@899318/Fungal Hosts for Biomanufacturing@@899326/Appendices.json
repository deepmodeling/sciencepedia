{"hands_on_practices": [{"introduction": "Understanding the theoretical limits of a bioprocess is the first step in metabolic engineering. This practice guides you through the calculation of maximum theoretical yields for biomass and a product in *Saccharomyces cerevisiae*, a workhorse of biomanufacturing. By applying fundamental principles of mass, energy, and redox balancing, you will quantitatively explore the profound impact of metabolic strategy—respiration versus fermentation—on cellular resource allocation and efficiency [@problem_id:2739985].", "problem": "Saccharomyces cerevisiae is used as a fungal host for biomanufacturing. Consider growth on glucose with ammonia as the sole nitrogen source. Assume the following, each assumption reflecting a well-tested base in stoichiometric metabolism, energy conservation, and redox balance:\n\n- Biomass elemental composition is represented by the empirical formula $\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$ per carbon mole (C-mol). Use atomic masses $\\mathrm{C}=12$, $\\mathrm{H}=1$, $\\mathrm{O}=16$, $\\mathrm{N}=14$ to compute the mass corresponding to one C-mol of biomass.\n- Glycolysis (Embden–Meyerhof–Parnas pathway) yields $2$ mol adenosine triphosphate (ATP) per mol glucose, independent of the downstream fate of carbon.\n- Oxidative phosphorylation couples the reoxidation of one nicotinamide adenine dinucleotide (reduced form) equivalent (one pair of electrons) to $c=1.0$ mol ATP. Treat all respiratory reducing equivalents as nicotinamide adenine dinucleotide (reduced form) equivalents.\n- Growth-associated maintenance energy (GAM) requirement is $b=1.5$ mol ATP per C-mol biomass formed. Neglect non-growth-associated maintenance.\n- Degrees of reduction for elements are $\\gamma_{\\mathrm{C}}=4$, $\\gamma_{\\mathrm{H}}=1$, $\\gamma_{\\mathrm{O}}=-2$, $\\gamma_{\\mathrm{N}}=-3$, and degree of reduction is conserved in the absence of external electron acceptors.\n- Two physiological regimes:\n  1. Respiratory regime: Oxygen is non-limiting. All electrons not retained in biomass are transferred to oxygen. No reduced byproducts (e.g., ethanol) are secreted.\n  2. Fermentative regime: Oxygen is absent. The only extracellular products, besides biomass, are ethanol and carbon dioxide. No glycerol or other products are formed.\n\nLet $Y_{X/S}$ denote the biomass yield on substrate (glucose) in $\\mathrm{g\\ g^{-1}}$, and $Y_{P/S}$ denote the ethanol yield on substrate in $\\mathrm{g\\ g^{-1}}$. The molar masses of glucose and ethanol are $M_{\\mathrm{glc}}=180$ and $M_{\\mathrm{eth}}=46$, respectively.\n\nUsing only elemental mass balances, degree-of-reduction accounting, and the ATP budget implied by the assumptions above, derive the theoretical maximum $Y_{X/S}$ and the associated $Y_{P/S}$ for each regime. Report your four results in the order $\\big(Y_{X/S}^{\\mathrm{resp}},\\ Y_{P/S}^{\\mathrm{resp}},\\ Y_{X/S}^{\\mathrm{ferm}},\\ Y_{P/S}^{\\mathrm{ferm}}\\big)$, expressed in $\\mathrm{g\\ g^{-1}}$. Round your final numerical values to four significant figures.", "solution": "The problem is valid and will be solved by applying the principles of elemental mass balance, degree of reduction balance, and ATP energy balance for the two specified physiological regimes.\n\nFirst, we establish fundamental parameters required for the calculations.\n\nThe molar mass of biomass per C-mol ($M_X$) is calculated from its empirical formula, $\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$, and the given atomic masses ($M_C=12 \\ \\mathrm{g \\ mol^{-1}}$, $M_H=1 \\ \\mathrm{g \\ mol^{-1}}$, $M_O=16 \\ \\mathrm{g \\ mol^{-1}}$, $M_N=14 \\ \\mathrm{g \\ mol^{-1}}$):\n$$ M_X = 1 \\cdot M_C + 1.8 \\cdot M_H + 0.5 \\cdot M_O + 0.2 \\cdot M_N = 1(12) + 1.8(1) + 0.5(16) + 0.2(14) = 12 + 1.8 + 8 + 2.8 = 24.6 \\ \\mathrm{g \\ (C-mol)^{-1}} $$\nThe degrees of reduction ($\\gamma$) for the relevant species are determined using the elemental contributions $\\gamma_{\\mathrm{C}}=4$, $\\gamma_{\\mathrm{H}}=1$, $\\gamma_{\\mathrm{O}}=-2$, and $\\gamma_{\\mathrm{N}}=-3$:\n- Glucose ($\\mathrm{C_6H_{12}O_6}$): Per mole, $\\gamma_{glc} = 6(4) + 12(1) + 6(-2) = 24$.\n- Biomass ($\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$): Per C-mol, $\\gamma_X = 1(4) + 1.8(1) + 0.5(-2) + 0.2(-3) = 4.2$.\n- Ethanol ($\\mathrm{C_2H_6O}$): Per mole, $\\gamma_{eth} = 2(4) + 6(1) + 1(-2) = 12$.\n- Carbon Dioxide ($\\mathrm{CO_2}$): Per mole, $\\gamma_{CO_2} = 1(4) + 2(-2) = 0$.\n- Oxygen ($\\mathrm{O_2}$): Per mole, $\\gamma_{O_2} = 2(-2) = -4$.\n- Ammonia ($\\mathrm{NH_3}$): Per mole, $\\gamma_{NH_3} = 1(-3) + 3(1) = 0$.\n\nLet $y_X$ be the molar yield of biomass in C-mol per mole of glucose, and $y_P$ be the molar yield of ethanol in mol per mole of glucose.\n\n**Respiratory Regime**\nIn this regime, oxygen is the sole electron acceptor. The overall reaction is:\n$$ \\mathrm{C_6H_{12}O_6} + a_{\\mathrm{N}} \\mathrm{NH_3} + a_{\\mathrm{O}} \\mathrm{O_2} \\rightarrow y_X \\mathrm{CH_{1.8}O_{0.5}N_{0.2}} + y_C \\mathrm{CO_2} + a_{\\mathrm{W}} \\mathrm{H_2O} $$\nElemental balances provide relationships between the stoichiometric coefficients:\n- Nitrogen balance: $a_N = 0.2 y_X$.\n- Carbon balance: $6 = y_X + y_C \\implies y_C = 6 - y_X$.\nThe degree of reduction balance is used to find the oxygen consumption, $a_O$:\n$$ \\gamma_{glc} + a_{\\mathrm{O}} \\gamma_{O_2} = y_X \\gamma_X + y_C \\gamma_{CO_2} $$\n$$ 24 + a_{\\mathrm{O}}(-4) = y_X(4.2) + (6-y_X)(0) \\implies 4a_{\\mathrm{O}} = 24 - 4.2 y_X \\implies a_{\\mathrm{O}} = 6 - 1.05 y_X $$\nThe number of moles of NADH equivalents reoxidized by respiration is $2 a_{\\mathrm{O}}$, as each $\\mathrm{O_2}$ molecule accepts $4$ electrons (or $2$ NADH equivalent pairs).\n$$ \\text{NADH}_{\\text{resp}} = 2 a_{\\mathrm{O}} = 2(6 - 1.05 y_X) = 12 - 2.1 y_X $$\nThe ATP balance is constructed on a basis of $1$ mole of glucose.\n- ATP Generation: This comes from glycolysis ($2$ mol ATP per mol glucose) and oxidative phosphorylation ($c=1.0$ mol ATP per mol NADH equivalent).\n$$ \\text{ATP}_{\\text{gen}} = 2 + c \\cdot \\text{NADH}_{\\text{resp}} = 2 + 1.0(12 - 2.1 y_X) = 14 - 2.1 y_X $$\n- ATP Consumption: This is for growth-associated maintenance (GAM), with a requirement of $b=1.5$ mol ATP per C-mol of biomass.\n$$ \\text{ATP}_{\\text{cons}} = b \\cdot y_X = 1.5 y_X $$\nEquating generation and consumption to find $y_X$:\n$$ 14 - 2.1 y_X = 1.5 y_X \\implies 14 = 3.6 y_X \\implies y_X = \\frac{14}{3.6} = \\frac{35}{9} $$\nThe mass yield of biomass on glucose, $Y_{X/S}^{\\mathrm{resp}}$, is calculated using the molar masses $M_X=24.6 \\ \\mathrm{g \\ (C-mol)^{-1}}$ and $M_{glc}=180 \\ \\mathrm{g \\ mol^{-1}}$:\n$$ Y_{X/S}^{\\mathrm{resp}} = \\frac{y_X \\cdot M_X}{M_{glc}} = \\frac{(35/9) \\cdot 24.6}{180} = \\frac{861}{1620} \\approx 0.53148 \\ \\mathrm{g \\ g^{-1}} $$\nIn the respiratory regime, no ethanol is produced, so $Y_{P/S}^{\\mathrm{resp}} = 0 \\ \\mathrm{g \\ g^{-1}}$.\n\n**Fermentative Regime**\nIn this anaerobic regime, biomass, ethanol, and carbon dioxide are the only products. The reaction is:\n$$ \\mathrm{C_6H_{12}O_6} + a_{\\mathrm{N}} \\mathrm{NH_3} \\rightarrow y_X \\mathrm{CH_{1.8}O_{0.5}N_{0.2}} + y_P \\mathrm{C_2H_6O} + y_C \\mathrm{CO_2} + a_{\\mathrm{W}} \\mathrm{H_2O} $$\nThe degree of reduction is conserved among carbon compounds as there is no external electron acceptor:\n$$ \\gamma_{glc} = y_X \\gamma_X + y_P \\gamma_{eth} + y_C \\gamma_{CO_2} $$\n$$ 24 = y_X(4.2) + y_P(12) + y_C(0) \\implies 24 = 4.2 y_X + 12 y_P $$\nThe ATP balance is simpler:\n- ATP Generation: Only from glycolysis, so $\\text{ATP}_{\\text{gen}} = 2$ mol ATP per mol glucose.\n- ATP Consumption: For GAM, $\\text{ATP}_{\\text{cons}} = 1.5 y_X$.\nEquating generation and consumption:\n$$ 2 = 1.5 y_X \\implies y_X = \\frac{2}{1.5} = \\frac{4}{3} $$\nThe mass yield of biomass, $Y_{X/S}^{\\mathrm{ferm}}$, is:\n$$ Y_{X/S}^{\\mathrm{ferm}} = \\frac{y_X \\cdot M_X}{M_{glc}} = \\frac{(4/3) \\cdot 24.6}{180} = \\frac{98.4}{540} \\approx 0.18222 \\ \\mathrm{g \\ g^{-1}} $$\nTo find the ethanol yield, substitute $y_X=4/3$ into the redox balance equation:\n$$ 24 = 4.2 \\left(\\frac{4}{3}\\right) + 12 y_P \\implies 24 = 5.6 + 12 y_P \\implies 12 y_P = 18.4 \\implies y_P = \\frac{18.4}{12} = \\frac{4.6}{3} $$\nThe mass yield of ethanol on glucose, $Y_{P/S}^{\\mathrm{ferm}}$, is calculated using $M_{eth}=46 \\ \\mathrm{g \\ mol^{-1}}$:\n$$ Y_{P/S}^{\\mathrm{ferm}} = \\frac{y_P \\cdot M_{eth}}{M_{glc}} = \\frac{(4.6/3) \\cdot 46}{180} = \\frac{211.6}{540} \\approx 0.39185 \\ \\mathrm{g \\ g^{-1}} $$\nThe four requested values, rounded to four significant figures, are:\n$Y_{X/S}^{\\mathrm{resp}} = 0.5315 \\ \\mathrm{g \\ g^{-1}}$\n$Y_{P/S}^{\\mathrm{resp}} = 0 \\ \\mathrm{g \\ g^{-1}}$\n$Y_{X/S}^{\\mathrm{ferm}} = 0.1822 \\ \\mathrm{g \\ g^{-1}}$\n$Y_{P/S}^{\\mathrm{ferm}} = 0.3919 \\ \\mathrm{g \\ g^{-1}}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5315  0  0.1822  0.3919\n\\end{pmatrix}\n}\n$$", "id": "2739985"}, {"introduction": "While stoichiometric models define theoretical maxima, achieving high productivity often requires overcoming kinetic bottlenecks within complex pathways like protein secretion. This exercise employs a compartmental mass balance model to diagnose the rate-limiting step in a recombinant protein's journey through the endoplasmic reticulum, Golgi, and cell wall [@problem_id:2739958]. By analyzing transient accumulation data, you will learn to pinpoint the specific stage that constrains overall secretion, a critical skill for rationally designing hyper-producing fungal strains.", "problem": "A recombinant protease is secreted by a filamentous fungal host engineered for biomanufacturing. Consider a minimal, serial compartment model for secretion with three intracellular compartments: endoplasmic reticulum (ER), Golgi, and periplasmic/exocytic vesicle space adjacent to the cell wall. Let the corresponding compartmental amounts be $E(t)$, $G(t)$, and $P(t)$, respectively. The secretory pathway is modeled as three irreversible, first-order transfer steps in series with fluxes $v_{1}(t)$ (ER export), $v_{2}(t)$ (Golgi trafficking), and $v_{3}(t)$ (cell wall passage), and an externally measurable secretion flux $J_{s}(t)$ into the medium. The synthesis of nascent, transport-competent protease into the ER occurs at a time-dependent rate $S(t)$. Neglect degradation and dilution on the time scale of the measurement. The mass balances are, by conservation of mass,\n- $\\,\\frac{dE}{dt} = S - v_{1}$,\n- $\\,\\frac{dG}{dt} = v_{1} - v_{2}$,\n- $\\,\\frac{dP}{dt} = v_{2} - v_{3}$,\nand the extracellular secretion flux satisfies $J_{s} = v_{3}$.\n\nAt a particular instant $t = t^{\\ast}$ during a controlled induction transient (shortly after a step increase in expression), the following are measured:\n- The extracellular secretion flux is $J_{s}(t^{\\ast}) = 37.5$ mg per gram of dry cell weight per hour (mg gDCW$^{-1}$ h$^{-1}$), where grams of dry cell weight (gDCW) denotes biomass.\n- The net intracellular accumulation rate is $\\frac{d}{dt}\\left[E+G+P\\right]\\big|_{t^{\\ast}} = +12.5$ mg gDCW$^{-1}$ h$^{-1}$.\n- Subcellular kinetic partitioning at $t^{\\ast}$ reveals that the instantaneous intracellular accumulation rate is distributed across compartments in the fractions $f_{\\mathrm{ER}} = 0.62$, $f_{\\mathrm{Golgi}} = 0.28$, and $f_{\\mathrm{Peri}} = 0.10$, where $f_{\\mathrm{ER}} + f_{\\mathrm{Golgi}} + f_{\\mathrm{Peri}} = 1$, and $f_{i}$ denotes the fraction of the net intracellular accumulation rate occurring in compartment $i$ at that instant.\n\nStarting only from the compartmental mass balances above and the definition of fluxes, derive the instantaneous synthesis rate $S(t^{\\ast})$ and then compute the compartment-specific accumulation rates $a_{\\mathrm{ER}}$, $a_{\\mathrm{Golgi}}$, and $a_{\\mathrm{Peri}}$ at $t^{\\ast}$, where $a_{i}$ is the rate of accumulation in compartment $i$. Define a dimensionless diagnostic bottleneck index for each step as $B_{1} = \\frac{a_{\\mathrm{ER}}}{S(t^{\\ast})}$, $B_{2} = \\frac{a_{\\mathrm{Golgi}}}{S(t^{\\ast})}$, and $B_{3} = \\frac{a_{\\mathrm{Peri}}}{S(t^{\\ast})}$. The largest of $\\{B_{1},B_{2},B_{3}\\}$ indicates the step at which mass accumulates most strongly relative to synthesis and therefore the dominant bottleneck at $t^{\\ast}$.\n\nCompute the value of $B_{\\max} = \\max\\{B_{1},B_{2},B_{3}\\}$ using the provided data. Round your answer to four significant figures. Because $B_{\\max}$ is dimensionless, report it without units.", "solution": "We begin from conservation of mass across the three serial compartments. Let $X_{\\mathrm{in}}(t) \\equiv E(t) + G(t) + P(t)$ denote the total intracellular amount of the secreted protease. Summing the three mass balances yields\n$$\n\\frac{d}{dt}\\left[E+G+P\\right] \\;=\\; \\left(S - v_{1}\\right) + \\left(v_{1} - v_{2}\\right) + \\left(v_{2} - v_{3}\\right) \\;=\\; S - v_{3}.\n$$\nBy the problem statement, the secretion flux into the medium satisfies $J_{s} = v_{3}$. Therefore,\n$$\n\\frac{dX_{\\mathrm{in}}}{dt} \\;=\\; S - J_{s}.\n$$\nThis identity holds at any time $t$ under the stated assumptions. Evaluating at $t = t^{\\ast}$ and rearranging gives the instantaneous synthesis rate,\n$$\nS(t^{\\ast}) \\;=\\; J_{s}(t^{\\ast}) + \\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}}.\n$$\nWe are given $J_{s}(t^{\\ast}) = 37.5$ mg gDCW$^{-1}$ h$^{-1}$ and $\\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}} = +12.5$ mg gDCW$^{-1}$ h$^{-1}$. Hence,\n$$\nS(t^{\\ast}) \\;=\\; 37.5 + 12.5 \\;=\\; 50.0 \\quad \\text{mg gDCW}^{-1}\\,\\text{h}^{-1}.\n$$\n\nNext, we relate the measured subcellular kinetic partitioning to the compartment-specific accumulation rates. By definition, $f_{\\mathrm{ER}}$, $f_{\\mathrm{Golgi}}$, and $f_{\\mathrm{Peri}}$ are the fractions of the net intracellular accumulation rate occurring in each compartment at $t^{\\ast}$. If we denote $a_{\\mathrm{ER}} \\equiv \\left.\\frac{dE}{dt}\\right|_{t^{\\ast}}$, $a_{\\mathrm{Golgi}} \\equiv \\left.\\frac{dG}{dt}\\right|_{t^{\\ast}}$, and $a_{\\mathrm{Peri}} \\equiv \\left.\\frac{dP}{dt}\\right|_{t^{\\ast}}$, then by construction\n$$\na_{\\mathrm{ER}} + a_{\\mathrm{Golgi}} + a_{\\mathrm{Peri}} \\;=\\; \\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}},\n$$\nand\n$$\na_{\\mathrm{ER}} \\;=\\; f_{\\mathrm{ER}} \\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}}, \\quad\na_{\\mathrm{Golgi}} \\;=\\; f_{\\mathrm{Golgi}} \\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}}, \\quad\na_{\\mathrm{Peri}} \\;=\\; f_{\\mathrm{Peri}} \\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}}.\n$$\nUsing the given fractions $f_{\\mathrm{ER}} = 0.62$, $f_{\\mathrm{Golgi}} = 0.28$, and $f_{\\mathrm{Peri}} = 0.10$, and the net intracellular accumulation rate $\\left.\\frac{dX_{\\mathrm{in}}}{dt}\\right|_{t^{\\ast}} = 12.5$ mg gDCW$^{-1}$ h$^{-1}$, we compute\n$$\na_{\\mathrm{ER}} \\;=\\; 0.62 \\times 12.5 \\;=\\; 7.75 \\;\\text{mg gDCW}^{-1}\\,\\text{h}^{-1},\n$$\n$$\na_{\\mathrm{Golgi}} \\;=\\; 0.28 \\times 12.5 \\;=\\; 3.50 \\;\\text{mg gDCW}^{-1}\\,\\text{h}^{-1},\n$$\n$$\na_{\\mathrm{Peri}} \\;=\\; 0.10 \\times 12.5 \\;=\\; 1.25 \\;\\text{mg gDCW}^{-1}\\,\\text{h}^{-1}.\n$$\n\nThe diagnostic bottleneck indices are defined as the ratios of these accumulation rates to the instantaneous synthesis rate $S(t^{\\ast})$:\n$$\nB_{1} \\;=\\; \\frac{a_{\\mathrm{ER}}}{S(t^{\\ast})} \\;=\\; \\frac{7.75}{50.0} \\;=\\; 0.155,\n$$\n$$\nB_{2} \\;=\\; \\frac{a_{\\mathrm{Golgi}}}{S(t^{\\ast})} \\;=\\; \\frac{3.50}{50.0} \\;=\\; 0.070,\n$$\n$$\nB_{3} \\;=\\; \\frac{a_{\\mathrm{Peri}}}{S(t^{\\ast})} \\;=\\; \\frac{1.25}{50.0} \\;=\\; 0.025.\n$$\nThus,\n$$\nB_{\\max} \\;=\\; \\max\\{B_{1},B_{2},B_{3}\\} \\;=\\; 0.155.\n$$\nInterpreting these values, the largest fraction of synthesis that is being trapped as intracellular accumulation resides in the endoplasmic reticulum, indicating an ER export bottleneck at $t^{\\ast}$. The requested numerical quantity is $B_{\\max}$, which to four significant figures is $0.1550$.", "answer": "$$\\boxed{0.1550}$$", "id": "2739958"}, {"introduction": "Building upon foundational principles, we now advance to a systems-level optimization of metabolic networks using Flux Balance Analysis (FBA). This powerful computational technique allows us to predict the optimal flux distribution for maximizing a desired output, such as a high-value isoprenoid, under given constraints [@problem_id:2740036]. In this practice, you will formulate a linear programming problem to allocate carbon flux between glycolysis and the pentose phosphate pathway, balancing the cellular budget of acetyl-CoA, ATP, and NADPH to achieve the maximal theoretical product yield.", "problem": "You are working with a coarse-grained, steady-state metabolic model of a fungal host (for example, Saccharomyces cerevisiae) engineered to produce a non-oxidized isoprenoid via the mevalonate pathway. Use the principles of Flux Balance Analysis (FBA) to allocate glucose flux between glycolysis and the oxidative branch of the pentose phosphate pathway (PPP), and to optionally send acetyl-Coenzyme A (acetyl-CoA) into the tricarboxylic acid (TCA) cycle to satisfy adenosine triphosphate (ATP) demand. The objective is to maximize the steady-state flux to the isoprenoid product under a fixed glucose uptake rate, and then report the maximal theoretical yield defined as mol isoprenoid per mol glucose consumed (dimensionless, reported as a decimal).\n\nFundamental base and assumptions:\n- At steady state, intracellular metabolites satisfy mass balance and capacity constraints; this is expressed as linear constraints on reaction fluxes in Flux Balance Analysis (FBA).\n- The Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein) justifies that enzyme levels can be engineered to support feasible steady states, but enzyme kinetics are not explicitly modeled here.\n- The following coarse-grained, stoichiometrically consistent bundle reactions are assumed as well-tested simplifications of central carbon metabolism in fungi under aerobic conditions:\n  - Glycolytic entry (glucose through upper glycolysis followed by pyruvate dehydrogenase): per glucose flux $x$, this route yields $2$ acetyl-CoA, $2$ ATP, $4$ nicotinamide adenine dinucleotide (NADH), and $2$ carbon dioxide ($\\mathrm{CO_2}$).\n  - Oxidative PPP entry combined with non-oxidative rearrangements, lower glycolysis, and pyruvate dehydrogenase: per glucose flux $y$, this route yields $\\frac{5}{3}$ acetyl-CoA, $\\frac{10}{3}$ ATP, $\\frac{10}{3}$ NADH, $2$ nicotinamide adenine dinucleotide phosphate (NADPH), and $\\frac{8}{3}$ $\\mathrm{CO_2}$.\n  - Respiratory chain: per NADH flux $v_{\\mathrm{resp}}$, this yields $p_{\\mathrm{ATP}}$ ATP; assume $p_{\\mathrm{ATP}} = 2.5$.\n  - TCA cycled oxidation of acetyl-CoA with oxidative phosphorylation lumped: per acetyl-CoA flux $v_{\\mathrm{tca}}$, this yields $t_{\\mathrm{TCA}}$ ATP; assume $t_{\\mathrm{TCA}} = 10$.\n- Isoprenoid synthesis via the mevalonate pathway from acetyl-CoA to the non-oxidized final product requires per $\\mathrm{C}_5$ isopentenyl pyrophosphate (IPP) unit: $3$ acetyl-CoA, $2$ NADPH, $3$ ATP, and releases $1$ $\\mathrm{CO_2}$. Let the product have $U$ such $\\mathrm{C}_5$ units (for example, $U=2$ for a $\\mathrm{C}_{10}$ monoterpene, $U=3$ for a $\\mathrm{C}_{15}$ sesquiterpene, $U=4$ for a $\\mathrm{C}_{20}$ diterpene). Then per unit flux $v_{\\mathrm{iso}}$ of product:\n  - Acetyl-CoA demand is $3U\\,v_{\\mathrm{iso}}$.\n  - NADPH demand is $2U\\,v_{\\mathrm{iso}}$.\n  - ATP demand is $3U\\,v_{\\mathrm{iso}}$.\n  - Carbon dioxide is produced but is unconstrained.\n- No interconversion between NADH and NADPH is allowed; NADPH is supplied only by the oxidative PPP in this model.\n- All fluxes are nonnegative and the glucose uptake $v_{\\mathrm{glc}}$ is fixed and supplied.\n\nDecision variables for the linear program:\n- $x \\ge 0$: glucose flux directed to the glycolytic entry route.\n- $y \\ge 0$: glucose flux directed to the oxidative PPP entry route.\n- $v_{\\mathrm{tca}} \\ge 0$: acetyl-CoA flux sent to TCA.\n- $v_{\\mathrm{resp}} \\ge 0$: NADH flux sent to respiration.\n- $v_{\\mathrm{iso}} \\ge 0$: isoprenoid production flux (the objective to maximize).\n\nParameters:\n- $v_{\\mathrm{glc}}$: glucose uptake rate (fixed).\n- $U$: number of $\\mathrm{C}_5$ units in the target isoprenoid.\n- Constants: $a_G=2$, $t_G=2$, $h_G=4$ for glycolytic entry; $a_P=\\frac{5}{3}$, $t_P=\\frac{10}{3}$, $h_P=\\frac{10}{3}$, $n_P=2$ for PPP entry; $p_{\\mathrm{ATP}}=2.5$; $t_{\\mathrm{TCA}}=10$.\n\nConstraints (all fluxes in consistent arbitrary time units; glucose flux and isoprenoid flux in the same time basis):\n- Glucose split: $x + y = v_{\\mathrm{glc}}$.\n- Acetyl-CoA availability: $3U\\,v_{\\mathrm{iso}} + v_{\\mathrm{tca}} \\le a_G x + a_P y$.\n- ATP availability: $3U\\,v_{\\mathrm{iso}} \\le t_G x + t_P y + t_{\\mathrm{TCA}} v_{\\mathrm{tca}} + p_{\\mathrm{ATP}} v_{\\mathrm{resp}}$.\n- NADPH availability: $2U\\,v_{\\mathrm{iso}} \\le n_P y$.\n- NADH supply to respiration: $v_{\\mathrm{resp}} \\le h_G x + h_P y$.\n\nObjective:\n- Maximize $v_{\\mathrm{iso}}$, then report the maximal theoretical yield $Y = \\frac{v_{\\mathrm{iso}}}{v_{\\mathrm{glc}}}$ as mol isoprenoid per mol glucose (dimensionless), rounded to six decimal places.\n\nTest suite:\n- Case $1$: $v_{\\mathrm{glc}} = 1.0$, $U = 3$.\n- Case $2$: $v_{\\mathrm{glc}} = 10.0$, $U = 3$.\n- Case $3$: $v_{\\mathrm{glc}} = 1.0$, $U = 4$.\n- Case $4$: $v_{\\mathrm{glc}} = 0.0$, $U = 3$.\n- Case $5$: $v_{\\mathrm{glc}} = 1.0$, $U = 2$.\n\nProgramming task:\n- Implement a program that sets up and solves the linear program for each test case using the constraints above, computes $Y = \\frac{v_{\\mathrm{iso}}}{v_{\\mathrm{glc}}}$ for $v_{\\mathrm{glc}} gt; 0$, and returns $Y = 0$ when $v_{\\mathrm{glc}} = 0$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[$r_1$,$r_2$,$r_3$,$r_4$,$r_5$]\"), with each $r_i$ rounded to six decimal places. Do not include any additional text.\n\nAll numerical quantities in this statement are dimensionless or cancel by ratio; report yields as mol per mol (dimensionless decimal).", "solution": "The problem requires the determination of the maximal theoretical yield of an isoprenoid product from glucose in a simplified fungal metabolic model. This is a problem of resource allocation under stoichiometric constraints, which is canonically addressed using Flux Balance Analysis (FBA). The FBA formulation leads to a Linear Programming (LP) problem.\n\nThe state of the system is defined by a vector of metabolic fluxes, $\\mathbf{z} = [x, y, v_{\\mathrm{tca}}, v_{\\mathrm{resp}}, v_{\\mathrm{iso}}]^T$. These variables represent:\n- $x$: The flux of glucose through the glycolytic entry route.\n- $y$: The flux of glucose through the pentose phosphate pathway (PPP) entry route.\n- $v_{\\mathrm{tca}}$: The flux of acetyl-CoA entering the TCA cycle for oxidation.\n- $v_{\\mathrm{resp}}$: The flux of NADH entering the respiratory chain.\n- $v_{\\mathrm{iso}}$: The flux of carbon towards the synthesis of the isoprenoid product.\n\nThe objective is to maximize the production flux $v_{\\mathrm{iso}}$. In the standard form of an LP solver that performs minimization, this is equivalent to minimizing $-v_{\\mathrm{iso}}$. The objective function is thus $f(\\mathbf{z}) = c^T \\mathbf{z}$, with the cost vector $c = [0, 0, 0, 0, -1]^T$.\n\nThe optimization is subject to a set of linear constraints derived from steady-state mass balances for key metabolites and the fixed total glucose uptake.\n\n1.  **Glucose Balance**: The total glucose uptake rate, $v_{\\mathrm{glc}}$, is split between the two entry pathways. This is an equality constraint:\n    $$x + y = v_{\\mathrm{glc}}$$\n\n2.  **Metabolite Balances**: For intracellular metabolites, the total production rate must be greater than or equal to the total consumption rate at steady state. This yields a set of inequality constraints. Let us arrange them into the standard form $A_{ub}\\mathbf{z} \\le b_{ub}$:\n    - **Acetyl-CoA**: The consumption for isoprenoid synthesis ($3U v_{\\mathrm{iso}}$) and TCA cycle ($v_{\\mathrm{tca}}$) cannot exceed production from glycolysis ($a_G x$) and PPP ($a_P y$).\n      $$3U v_{\\mathrm{iso}} + v_{\\mathrm{tca}} \\le a_G x + a_P y \\implies -a_G x - a_P y + v_{\\mathrm{tca}} + 3U v_{\\mathrm{iso}} \\le 0$$\n      Substituting the given constants $a_G=2$ and $a_P=5/3$:\n      $$-2x - \\frac{5}{3}y + v_{\\mathrm{tca}} + 3U v_{\\mathrm{iso}} \\le 0$$\n    - **ATP**: Consumption for isoprenoid synthesis ($3U v_{\\mathrm{iso}}$) must be met by production from glycolysis ($t_G x$), PPP ($t_P y$), TCA cycle ($t_{\\mathrm{TCA}} v_{\\mathrm{tca}}$), and oxidative phosphorylation ($p_{\\mathrm{ATP}} v_{\\mathrm{resp}}$).\n      $$3U v_{\\mathrm{iso}} \\le t_G x + t_P y + t_{\\mathrm{TCA}} v_{\\mathrm{tca}} + p_{\\mathrm{ATP}} v_{\\mathrm{resp}} \\implies -t_G x - t_P y - t_{\\mathrm{TCA}} v_{\\mathrm{tca}} - p_{\\mathrm{ATP}} v_{\\mathrm{resp}} + 3U v_{\\mathrm{iso}} \\le 0$$\n      Substituting $t_G=2$, $t_P=10/3$, $t_{\\mathrm{TCA}}=10$, and $p_{\\mathrm{ATP}}=2.5$:\n      $$-2x - \\frac{10}{3}y - 10v_{\\mathrm{tca}} - 2.5v_{\\mathrm{resp}} + 3U v_{\\mathrm{iso}} \\le 0$$\n    - **NADPH**: Consumption for isoprenoid synthesis ($2U v_{\\mathrm{iso}}$) must be supplied by the PPP ($n_P y$), the sole source in this model.\n      $$2U v_{\\mathrm{iso}} \\le n_P y \\implies -n_P y + 2U v_{\\mathrm{iso}} \\le 0$$\n      Substituting $n_P=2$:\n      $$-2y + 2U v_{\\mathrm{iso}} \\le 0$$\n    - **NADH**: The amount directed to respiration ($v_{\\mathrm{resp}}$) cannot exceed the total production from glycolysis ($h_G x$) and PPP ($h_P y$).\n      $$v_{\\mathrm{resp}} \\le h_G x + h_P y \\implies -h_G x - h_P y + v_{\\mathrm{resp}} \\le 0$$\n      Substituting $h_G=4$ and $h_P=10/3$:\n      $$-4x - \\frac{10}{3}y + v_{\\mathrm{resp}} \\le 0$$\n\n3.  **Flux Bounds**: All metabolic fluxes are irreversible and thus must be non-negative:\n    $$x \\ge 0, \\quad y \\ge 0, \\quad v_{\\mathrm{tca}} \\ge 0, \\quad v_{\\mathrm{resp}} \\ge 0, \\quad v_{\\mathrm{iso}} \\ge 0$$\n\nThis complete LP formulation can be solved numerically for any given set of parameters ($v_{\\mathrm{glc}}$, $U$). The program implements a function that constructs the LP matrices ($A_{ub}, b_{ub}, A_{eq}, b_{eq}$) and vector ($c$) from these parameters and solves for the optimal flux vector $\\mathbf{z}$ using the `scipy.optimize.linprog` function.\n\nFor $v_{\\mathrm{glc}}  0$, the maximal product flux $v_{\\mathrm{iso}}$ is directly proportional to $v_{\\mathrm{glc}}$. Consequently, the maximal yield $Y = v_{\\mathrm{iso}}/v_{\\mathrm{glc}}$ is independent of the absolute glucose uptake rate. This is evident as all constraints are homogeneous. For the special case $v_{\\mathrm{glc}} = 0$, all fluxes must be $0$, hence the yield $Y$ is defined as $0$. The implemented program follows this logic, solving the LP for each test case and reporting the computed yield rounded to six decimal places.```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Sets up and solves the linear program for each test case to find the\n    maximal theoretical yield of isoprenoid production.\n    \"\"\"\n    test_cases = [\n        (1.0, 3),  # Case 1\n        (10.0, 3), # Case 2\n        (1.0, 4),  # Case 3\n        (0.0, 3),  # Case 4\n        (1.0, 2),  # Case 5\n    ]\n\n    results = []\n    for v_glc, U in test_cases:\n        yield_val = calculate_max_yield(v_glc, U)\n        # Format the result to six decimal places as a string.\n        results.append(f\"{yield_val:.6f}\")\n\n    # Print the final comma-separated list in the required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_max_yield(v_glc, U):\n    \"\"\"\n    Solves the linear programming problem for a given glucose uptake rate\n    and number of C5 units in the isoprenoid product.\n\n    Args:\n        v_glc (float): The fixed glucose uptake rate.\n        U (int): The number of C5 units in the target isoprenoid.\n\n    Returns:\n        float: The maximal theoretical yield (mol isoprenoid / mol glucose).\n    \"\"\"\n    if v_glc == 0.0:\n        return 0.0\n\n    # Define stoichiometric and energetic constants from the problem statement.\n    a_G, t_G, h_G = 2.0, 2.0, 4.0\n    a_P, t_P, h_P, n_P = 5.0/3.0, 10.0/3.0, 10.0/3.0, 2.0\n    p_ATP = 2.5\n    t_TCA = 10.0\n\n    # The vector of decision variables is z = [x, y, v_tca, v_resp, v_iso].\n    # The objective is to maximize v_iso, which is equivalent to minimizing -v_iso.\n    c = np.array([0.0, 0.0, 0.0, 0.0, -1.0])\n\n    # Inequality constraints (A_ub @ z = b_ub).\n    # 1. Acetyl-CoA: -a_G*x - a_P*y + v_tca + 3*U*v_iso = 0\n    # 2. ATP: -t_G*x - t_P*y - t_TCA*v_tca - p_ATP*v_resp + 3*U*v_iso = 0\n    # 3. NADPH: -n_P*y + 2*U*v_iso = 0\n    # 4. NADH: -h_G*x - h_P*y + v_resp = 0\n    A_ub = np.array([\n        [-a_G, -a_P,    1.0,      0.0, 3.0*U],\n        [-t_G, -t_P, -t_TCA, -p_ATP, 3.0*U],\n        [   0.0, -n_P,    0.0,      0.0, 2.0*U],\n        [-h_G, -h_P,    0.0,      1.0,   0.0]\n    ])\n    b_ub = np.zeros(4)\n\n    # Equality constraint (A_eq @ z = b_eq).\n    # 1. Glucose split: x + y = v_glc\n    A_eq = np.array([[1.0, 1.0, 0.0, 0.0, 0.0]])\n    b_eq = np.array([v_glc])\n\n    # All fluxes must be non-negative.\n    bounds = (0, None)\n\n    # Solve the linear program. The 'highs' method is robust and default in recent scipy.\n    result = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if not result.success:\n        # This case should not be reached for this well-posed problem.\n        # A robust implementation would raise an exception.\n        raise ValueError(f\"Linear programming solver failed for v_glc={v_glc}, U={U}.\")\n\n    # The maximum value of v_iso is the negative of the minimized objective function.\n    max_v_iso = -result.fun if result.fun is not None else 0.0\n    \n    # Calculate the yield.\n    yield_val = max_v_iso / v_glc if v_glc  0.0 else 0.0\n    \n    return yield_val\n\nif __name__ == '__main__':\n    solve()\n```", "answer": "$$\\boxed{[0.052632, 0.052632, 0.038462, 0.000000, 0.083333]}$$", "id": "2740036"}]}