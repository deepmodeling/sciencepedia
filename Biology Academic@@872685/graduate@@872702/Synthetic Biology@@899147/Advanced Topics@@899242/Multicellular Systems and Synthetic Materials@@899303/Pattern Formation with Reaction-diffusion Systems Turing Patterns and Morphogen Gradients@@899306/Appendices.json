{"hands_on_practices": [{"introduction": "The simplest spatial patterns in biology are morphogen gradients, which provide positional information to cells. This exercise explores a foundational model where a morphogen diffuses and is linearly degraded, leading to a characteristic exponential decay profile. By analyzing this system, you will connect the theoretical diffusion coefficient $D$ and degradation rate $\\lambda$ to the observable gradient length scale $\\ell$, and practice the crucial skill of fitting this model to experimental data to estimate these biophysical parameters [@problem_id:2758441].", "problem": "You are modeling a one-dimensional morphogen gradient at steady state in a homogeneous medium, relevant to synthetic biology patterning. A diffusible morphogen of concentration $c(x)$ diffuses with diffusion coefficient $D$ (in $\\mu\\text{m}^2/\\text{s}$) and is degraded with a first-order rate constant $\\lambda$ (in $\\text{s}^{-1}$). Away from any localized source region, the steady-state balance of diffusion and degradation is captured by the reaction-diffusion equation\n$$D\\,\\frac{d^2 c}{dx^2} - \\lambda\\,c = 0,$$\nsubject to the condition that $c(x)$ remains finite as $x \\to +\\infty$.\n\nYour tasks are:\n\n- Starting from the steady-state balance law above and fundamental properties of linear ordinary differential equations, derive the functional form of $c(x)$ and identify a characteristic length scale $\\ell$ that controls the spatial decay. Provide the relation between $\\ell$, $D$, and $\\lambda$ that follows from your derivation.\n- Suppose you have discrete measurements $\\{(x_i, c_i)\\}_{i=1}^N$ with known standard deviations $\\{\\sigma_{c,i}\\}_{i=1}^N$ for each concentration measurement (in the same units as $c$), taken at positions (in $\\mu\\text{m}$) $\\{x_i\\}$. Under the assumption that the measurement noise in $c_i$ is independent and Gaussian, and that deviations are small enough for a first-order error propagation through the logarithm, implement an estimator for $\\ell$ based on fitting the model’s implied functional form using Weighted Least Squares (WLS). Use the linearization $y_i = \\ln c_i$ and the first-order propagated standard deviations $\\sigma_{y,i} \\approx \\sigma_{c,i}/c_i$ to define weights $w_i = 1/\\sigma_{y,i}^2$ for WLS on the linear model $y_i = a + b\\,x_i$, where $b$ is related to $\\ell$. Use the normal equations with design matrix $X$ (column of ones and column of $x_i$) and weight matrix $W = \\mathrm{diag}(w_i)$ to obtain the parameter vector $\\theta = (a,b)^\\top$ via $(X^\\top W X)\\,\\theta = X^\\top W y$, and obtain the parameter covariance $\\mathrm{Cov}(\\theta) = (X^\\top W X)^{-1}$ (treating $\\sigma_{y,i}$ as known).\n- Propagate the uncertainty from the fitted slope to obtain a standard uncertainty for $\\ell$ via first-order (delta method) error propagation. Then compute $D$ using the relation you derived between $\\ell$, $D$, and $\\lambda$ under the assumption that $\\lambda$ is known exactly. Propagate uncertainty from $\\ell$ to $D$ using first-order error propagation. Report both $\\ell$ and $D$ with their standard uncertainties.\n- Implement a complete program that performs these computations for the test suite below and prints the outputs in the requested format.\n\nTest suite (each case provides positions $x_i$ in $\\mu\\text{m}$, measured concentrations $c_i$ in arbitrary but consistent units, concentration standard deviations $\\sigma_{c,i}$ in the same units as $c_i$, and the known degradation rate $\\lambda$ in $\\text{s}^{-1}$):\n\n- Case $1$ (general well-conditioned case):\n  - $x = [0, 10, 20, 30, 40, 50]$\n  - $c = [121.0, 89.3, 68.5, 49.8, 39.1, 28.0]$\n  - $\\sigma_c = [2.0, 2.0, 2.0, 2.0, 2.0, 2.0]$\n  - $\\lambda = 0.01$\n- Case $2$ (short length scale, rapidly decaying):\n  - $x = [0, 5, 10, 15, 20]$\n  - $c = [60.5, 21.5, 8.3, 2.8, 1.0]$\n  - $\\sigma_c = [0.3, 0.3, 0.3, 0.3, 0.3]$\n  - $\\lambda = 0.04$\n- Case $3$ (long length scale, shallow gradient):\n  - $x = [0, 50, 100, 150, 200, 250, 300]$\n  - $c = [99.0, 78.2, 60.1, 47.9, 36.2, 28.9, 22.0]$\n  - $\\sigma_c = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]$\n  - $\\lambda = 0.0025$\n\nNumerical and output requirements:\n\n- Use the linearized WLS estimator as specified above to estimate the slope $b$ and intercept $a$ of $y_i = a + b\\,x_i$, then compute $\\ell$ and its standard uncertainty. Then compute $D$ and its standard uncertainty.\n- Express the final $\\ell$ in $\\mu\\text{m}$, $D$ in $\\mu\\text{m}^2/\\text{s}$, and their standard uncertainties in the same respective units. Round all reported numbers to exactly $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of per-case result lists, each in the order $[\\ell, \\sigma_\\ell, D, \\sigma_D]$, enclosed in a single pair of square brackets. For example: $[[\\ell_1,\\sigma_{\\ell,1},D_1,\\sigma_{D,1}],[\\ell_2,\\sigma_{\\ell,2},D_2,\\sigma_{D,2}],\\dots]$.", "solution": "The problem presented is a standard exercise in biophysical modeling and data analysis, focused on a one-dimensional reaction-diffusion system. Before presenting the solution, the problem statement must be validated for scientific and logical integrity.\n\n**Problem Validation**\n\nThe givens are:\n1.  The governing differential equation for steady-state concentration $c(x)$ is $D\\,\\frac{d^2 c}{dx^2} - \\lambda\\,c = 0$.\n2.  The boundary condition is that $c(x)$ remains finite as $x \\to +\\infty$.\n3.  Experimental data are provided as sets of $\\{x_i, c_i, \\sigma_{c,i}\\}$ along with a known degradation rate $\\lambda$.\n4.  The estimation procedure is specified as a Weighted Least Squares (WLS) fit to a linearized model, $y_i = \\ln c_i$, with weights derived from first-order error propagation, $w_i = 1/\\sigma_{y,i}^2$ where $\\sigma_{y,i} \\approx \\sigma_{c,i}/c_i$.\n5.  The formulas for parameter estimation, $\\theta = (X^\\top W X)^{-1} X^\\top W y$, and parameter covariance, $\\mathrm{Cov}(\\theta) = (X^\\top W X)^{-1}$, are given.\n6.  The objective is to find the characteristic length scale $\\ell$, the diffusion coefficient $D$, and their respective standard uncertainties.\n\nThe problem is scientifically grounded, as the reaction-diffusion equation is a fundamental model in physics and biology. It is well-posed, providing a clear mathematical and statistical framework that leads to a unique solution. The language is objective and precise. The data and parameters are within physically realistic ranges for biological systems. There are no contradictions, ambiguities, or logical flaws. The problem is valid. We proceed to the solution.\n\n**Part 1: Derivation of the Morphogen Profile and Characteristic Length**\n\nThe governing equation is a second-order linear homogeneous ordinary differential equation with constant coefficients:\n$$D\\,\\frac{d^2 c}{dx^2} - \\lambda\\,c = 0$$\nWe can rewrite this as:\n$$\\frac{d^2 c}{dx^2} - \\frac{\\lambda}{D}\\,c = 0$$\nThe characteristic equation is obtained by substituting $c(x) = e^{rx}$, which yields:\n$$r^2 - \\frac{\\lambda}{D} = 0$$\nThe roots of this equation are $r_{1,2} = \\pm\\sqrt{\\frac{\\lambda}{D}}$. The general solution is a linear combination of the two independent solutions:\n$$c(x) = A\\,e^{\\sqrt{\\lambda/D}\\,x} + B\\,e^{-\\sqrt{\\lambda/D}\\,x}$$\nwhere $A$ and $B$ are constants determined by boundary conditions. The problem states that the concentration $c(x)$ must remain finite as $x \\to +\\infty$. Since $D  0$ and $\\lambda  0$, the term $\\sqrt{\\lambda/D}$ is real and positive. The term $e^{\\sqrt{\\lambda/D}\\,x}$ diverges as $x \\to +\\infty$. To satisfy the boundary condition, its coefficient must be zero, so $A=0$.\n\nThe solution thus simplifies to:\n$$c(x) = B\\,e^{-\\sqrt{\\lambda/D}\\,x}$$\nThe constant $B$ corresponds to the concentration at $x=0$, i.e., $c(0) = c_0$. The functional form is an exponential decay:\n$$c(x) = c_0\\,e^{-x/\\ell}$$\nBy comparing this form with the derived solution, we can identify the characteristic length scale $\\ell$, which describes the distance over which the concentration falls by a factor of $e$.\n$$\\frac{1}{\\ell} = \\sqrt{\\frac{\\lambda}{D}}$$\nFrom this, we derive the relationship between $\\ell$, $D$, and $\\lambda$:\n$$\\ell = \\sqrt{\\frac{D}{\\lambda}} \\quad \\implies \\quad D = \\lambda\\,\\ell^2$$\n\n**Part 2: Parameter Estimation via Weighted Least Squares**\n\nTo estimate $\\ell$ from discrete data $\\{(x_i, c_i)\\}$, we linearize the model by taking the natural logarithm:\n$$y(x) = \\ln c(x) = \\ln(c_0 e^{-x/\\ell}) = \\ln c_0 - \\frac{1}{\\ell} x$$\nThis corresponds to the linear model $y_i = a + b x_i$ for our data points $(x_i, y_i = \\ln c_i)$, where the intercept is $a = \\ln c_0$ and the slope is $b = -1/\\ell$.\n\nThe uncertainties $\\sigma_{c,i}$ on the concentration measurements propagate to the linearized variable $y_i = \\ln c_i$. Using a first-order Taylor expansion (the delta method), the variance of $y_i$ is approximately:\n$$\\sigma_{y,i}^2 \\approx \\left( \\frac{d(\\ln c_i)}{dc_i} \\right)^2 \\sigma_{c,i}^2 = \\left( \\frac{1}{c_i} \\right)^2 \\sigma_{c,i}^2 = \\frac{\\sigma_{c,i}^2}{c_i^2}$$\nSince the variances of the $y_i$ are not equal, a Weighted Least Squares (WLS) regression is appropriate. The optimal weights are the inverse of the variances:\n$$w_i = \\frac{1}{\\sigma_{y,i}^2} = \\frac{c_i^2}{\\sigma_{c,i}^2}$$\nThe WLS problem is to find the parameter vector $\\theta = [a, b]^\\top$ that minimizes the weighted sum of squared residuals, $\\sum w_i (y_i - (a+bx_i))^2$. The solution is given by the normal equations:\n$$(X^\\top W X)\\,\\theta = X^\\top W y$$\nwhere $y$ is the vector of $[\\ln c_i]$, $X$ is the design matrix with a column of ones and a column of $x_i$, and $W$ is the diagonal matrix of weights $w_i$. The solution for the parameters is:\n$$\\theta = (X^\\top W X)^{-1} X^\\top W y$$\nThe covariance matrix of the estimated parameters, assuming the model is correct and weights are known, is given by:\n$$\\mathrm{Cov}(\\theta) = (X^\\top W X)^{-1}$$\nThe variance of the slope, $\\sigma_b^2$, is the element $\\mathrm{Cov}(\\theta)_{2,2}$.\n\n**Part 3: Uncertainty Propagation for $\\ell$ and $D$**\n\nOnce we have the estimate for the slope $b$ and its variance $\\sigma_b^2$, we can determine $\\ell$ and its uncertainty.\nFrom $b = -1/\\ell$, we have $\\ell = -1/b$.\nUsing first-order error propagation:\n$$\\sigma_\\ell^2 \\approx \\left( \\frac{d\\ell}{db} \\right)^2 \\sigma_b^2 = \\left( \\frac{1}{b^2} \\right)^2 \\sigma_b^2 = (\\ell^2)^2 \\sigma_b^2 = \\ell^4 \\sigma_b^2$$\nThe standard uncertainty is $\\sigma_\\ell = \\sqrt{\\sigma_\\ell^2} \\approx \\ell^2 \\sigma_b$.\n\nNext, we compute the diffusion coefficient $D = \\lambda \\ell^2$. The problem states that $\\lambda$ is known exactly, so uncertainty in $D$ arises solely from the uncertainty in $\\ell$. Applying error propagation again:\n$$\\sigma_D^2 \\approx \\left( \\frac{\\partial D}{\\partial \\ell} \\right)^2 \\sigma_\\ell^2 = (2\\lambda \\ell)^2 \\sigma_\\ell^2$$\nThe standard uncertainty is $\\sigma_D = \\sqrt{\\sigma_D^2} \\approx 2\\lambda \\ell \\sigma_\\ell$.\n\nThe following program implements this entire procedure for the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the characteristic length and diffusion coefficient for a series of\n    reaction-diffusion system measurement test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: general well-conditioned case\n        {\n            \"x\": np.array([0, 10, 20, 30, 40, 50], dtype=float),\n            \"c\": np.array([121.0, 89.3, 68.5, 49.8, 39.1, 28.0], dtype=float),\n            \"sigma_c\": np.array([2.0, 2.0, 2.0, 2.0, 2.0, 2.0], dtype=float),\n            \"lambda\": 0.01\n        },\n        # Case 2: short length scale, rapidly decaying\n        {\n            \"x\": np.array([0, 5, 10, 15, 20], dtype=float),\n            \"c\": np.array([60.5, 21.5, 8.3, 2.8, 1.0], dtype=float),\n            \"sigma_c\": np.array([0.3, 0.3, 0.3, 0.3, 0.3], dtype=float),\n            \"lambda\": 0.04\n        },\n        # Case 3: long length scale, shallow gradient\n        {\n            \"x\": np.array([0, 50, 100, 150, 200, 250, 300], dtype=float),\n            \"c\": np.array([99.0, 78.2, 60.1, 47.9, 36.2, 28.9, 22.0], dtype=float),\n            \"sigma_c\": np.array([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], dtype=float),\n            \"lambda\": 0.0025\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        x = case[\"x\"]\n        c = case[\"c\"]\n        sigma_c = case[\"sigma_c\"]\n        lambda_val = case[\"lambda\"]\n\n        # Linearize the concentration data\n        y = np.log(c)\n\n        # Calculate weights for WLS. w_i = 1/sigma_y_i^2 = (c_i/sigma_c_i)^2\n        weights = (c / sigma_c)**2\n\n        # Construct the design matrix X\n        # Column of ones, column of x_i\n        X = np.vstack((np.ones_like(x), x)).T\n\n        # Construct the diagonal weight matrix W\n        W = np.diag(weights)\n\n        # Solve the normal equations for WLS: theta = (X.T @ W @ X)^-1 @ (X.T @ W @ y)\n        # First, calculate X.T @ W @ X\n        XT_W_X = X.T @ W @ X\n        \n        # Then, calculate X.T @ W @ y\n        XT_W_y = X.T @ W @ y\n\n        # Invert XT_W_X to get the parameter covariance matrix\n        # and solve for the parameter vector theta\n        try:\n            param_cov_matrix = np.linalg.inv(XT_W_X)\n            theta = param_cov_matrix @ XT_W_y\n        except np.linalg.LinAlgError:\n            # Handle cases where the matrix is singular, although not expected for valid inputs\n            all_results.append([float('nan')] * 4)\n            continue\n\n        # Extract intercept 'a', slope 'b', and variance of slope 'var_b'\n        # a = theta[0] # not needed for further calculations\n        b = theta[1]\n        var_b = param_cov_matrix[1, 1]\n        sigma_b = np.sqrt(var_b)\n\n        # Calculate characteristic length l = -1/b\n        ell = -1.0 / b\n\n        # Propagate uncertainty to l: sigma_l = l^2 * sigma_b\n        sigma_ell = (ell**2) * sigma_b\n\n        # Calculate diffusion coefficient D = lambda * l^2\n        D = lambda_val * (ell**2)\n        \n        # Propagate uncertainty to D: sigma_D = 2 * lambda * l * sigma_l\n        sigma_D = 2.0 * lambda_val * ell * sigma_ell\n\n        # Round results to 6 decimal places and store\n        results = [\n            round(ell, 6),\n            round(sigma_ell, 6),\n            round(D, 6),\n            round(sigma_D, 6)\n        ]\n        all_results.append(results)\n\n    # Format the final output string\n    # e.g., [[l1,sl1,D1,sD1],[l2,sl2,D2,sD2],...]\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2758441"}, {"introduction": "While simple gradients are powerful, many complex biological patterns arise from the interactions of multiple diffusing species. Before investigating how these interactions can generate patterns, we must first identify the system's baseline state: the spatially homogeneous steady state where all concentrations are constant in space and time. This exercise provides practice in finding this steady state for a two-species reaction network, a critical first step in performing the stability analysis that reveals the potential for pattern formation [@problem_id:2758480].", "problem": "In a two-species reaction-diffusion model of a synthetic gene circuit on a spatial domain, the spatially homogeneous steady states are defined by the vanishing of the local reaction kinetics, independent of diffusion, because homogeneity eliminates spatial gradients. Consider the local reaction kinetics given by the functions $f(u,v)=\\rho - k u - \\eta u v$ and $g(u,v)=\\sigma u - \\lambda v$, where $u$ and $v$ are concentrations of two gene products and $\\rho, k, \\eta, \\sigma, \\lambda$ are real parameters representing production, degradation, and interaction rates. By definition, a spatially homogeneous steady state $(u^{*}, v^{*})$ satisfies $f(u^{*}, v^{*})=0$ and $g(u^{*}, v^{*})=0$.\n\nStarting from the fundamental definition of a homogeneous steady state for a reaction-diffusion partial differential equation (PDE), derive the explicit closed-form expression for $(u^{*}, v^{*})$ in terms of the parameters. Then determine the necessary and sufficient conditions on the parameters under which both components of the steady state are strictly positive (biologically meaningful in the first orthant). You may assume all parameters are real and that any divisions performed are well-defined.\n\nReport your final answer as the closed-form expression of $(u^{*}, v^{*})$ only. No numerical evaluation or rounding is required, and no units are needed.", "solution": "The problem as stated is valid. It is a well-posed mathematical problem grounded in the standard theory of reaction-diffusion systems. We will proceed with the derivation.\n\nA spatially homogeneous steady state, denoted by $(u^{*}, v^{*})$, of a reaction-diffusion system is defined by the condition that the local reaction kinetics vanish. For the given system, this is expressed by the set of algebraic equations:\n$$f(u^{*}, v^{*}) = \\rho - k u^{*} - \\eta u^{*} v^{*} = 0$$\n$$g(u^{*}, v^{*}) = \\sigma u^{*} - \\lambda v^{*} = 0$$\n\nHere, $u^{*}$ and $v^{*}$ are the steady-state concentrations of the two species, and $\\rho$, $k$, $\\eta$, $\\sigma$, $\\lambda$ are real parameters. The problem demands a closed-form expression for $(u^{*}, v^{*})$ and the conditions under which $u^{*}  0$ and $v^{*}  0$.\n\nFrom the second equation, $g(u^{*}, v^{*}) = 0$, we can express $v^{*}$ in terms of $u^{*}$. Assuming $\\lambda \\neq 0$:\n$$\\sigma u^{*} = \\lambda v^{*}$$\n$$v^{*} = \\frac{\\sigma}{\\lambda} u^{*}$$\n\nNext, we substitute this expression for $v^{*}$ into the first equation, $f(u^{*}, v^{*}) = 0$:\n$$\\rho - k u^{*} - \\eta u^{*} \\left(\\frac{\\sigma}{\\lambda} u^{*}\\right) = 0$$\n\nThis gives a quadratic equation for $u^{*}$:\n$$\\rho - k u^{*} - \\frac{\\eta \\sigma}{\\lambda} (u^{*})^{2} = 0$$\n\nTo facilitate solving this equation, we rearrange it into the standard quadratic form $Ax^2 + Bx + C = 0$:\n$$\\left(\\frac{\\eta \\sigma}{\\lambda}\\right) (u^{*})^{2} + k u^{*} - \\rho = 0$$\n\nWe solve for $u^{*}$ using the quadratic formula, $u^{*} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$, where $A = \\frac{\\eta \\sigma}{\\lambda}$, $B = k$, and $C = -\\rho$. The use of the formula requires $A \\neq 0$, so we assume $\\eta \\neq 0$ and $\\sigma \\neq 0$.\n$$u^{*} = \\frac{-k \\pm \\sqrt{k^2 - 4 \\left(\\frac{\\eta \\sigma}{\\lambda}\\right)(-\\rho)}}{2 \\left(\\frac{\\eta \\sigma}{\\lambda}\\right)}$$\n$$u^{*} = \\frac{-k \\pm \\sqrt{k^2 + \\frac{4\\eta\\sigma\\rho}{\\lambda}}}{\\frac{2\\eta\\sigma}{\\lambda}}$$\n$$u^{*} = \\frac{\\lambda}{2\\eta\\sigma} \\left( -k \\pm \\sqrt{k^2 + \\frac{4\\eta\\sigma\\rho}{\\lambda}} \\right)$$\n\nThe problem requires a biologically meaningful steady state, which dictates that concentrations must be strictly positive, i.e., $u^{*}  0$ and $v^{*}  0$. From the relation $v^{*} = \\frac{\\sigma}{\\lambda} u^{*}$, if $u^{*}  0$, then $v^{*}  0$ if and only if $\\frac{\\sigma}{\\lambda}  0$. This means $\\sigma$ and $\\lambda$ must have the same sign.\n\nFor a unique positive solution for $u^{*}$ to exist, the product of the roots of the quadratic equation must be negative. The product of the roots is given by $\\frac{C}{A}$.\n$$u^{*}_1 u^{*}_2 = \\frac{-\\rho}{\\frac{\\eta\\sigma}{\\lambda}} = -\\frac{\\rho\\lambda}{\\eta\\sigma}$$\nFor one root to be positive and the other negative, we require $u^{*}_1 u^{*}_2  0$, which implies:\n$$-\\frac{\\rho\\lambda}{\\eta\\sigma}  0 \\quad\\implies\\quad \\frac{\\rho\\lambda}{\\eta\\sigma}  0$$\nThis is equivalent to $\\frac{\\rho}{\\eta} \\frac{\\lambda}{\\sigma}  0$. Since we already established that $\\frac{\\sigma}{\\lambda}  0$ (and thus $\\frac{\\lambda}{\\sigma}  0$), this condition simplifies to $\\frac{\\rho}{\\eta}  0$. This means $\\rho$ and $\\eta$ must have the same sign.\n\nLet's check the discriminant, $\\Delta = k^2 + \\frac{4\\eta\\sigma\\rho}{\\lambda}$. Under the conditions $\\frac{\\sigma}{\\lambda}  0$ and $\\frac{\\rho}{\\eta}  0$, we have $\\rho\\eta  0$ and therefore the term $\\frac{4\\eta\\sigma\\rho}{\\lambda} = 4(\\rho\\eta)\\left(\\frac{\\sigma}{\\lambda}\\right)$ is strictly positive. Thus, $\\Delta = k^2 + (\\text{positive term})  0$, guaranteeing two distinct real roots.\n\nThe two roots for $u^{*}$ are $u^{*}_{\\pm} = \\frac{\\lambda}{2\\eta\\sigma} \\left( -k \\pm \\sqrt{\\Delta} \\right)$.\nThe conditions $\\frac{\\sigma}{\\lambda}  0$ and $\\frac{\\rho}{\\eta}  0$ imply $\\frac{\\lambda}{2\\eta\\sigma}  0$.\nThe term $\\sqrt{\\Delta} = \\sqrt{k^2 + (\\text{positive term})}  \\sqrt{k^2} = |k|$.\nTherefore, the numerator $-k + \\sqrt{\\Delta}$ is always positive. The numerator $-k - \\sqrt{\\Delta}$ is always negative.\nSince the prefactor $\\frac{\\lambda}{2\\eta\\sigma}$ is positive, the positive root corresponds to the '+' sign.\n\nThus, the unique biologically meaningful solution is:\n$$u^{*} = \\frac{\\lambda}{2\\eta\\sigma} \\left( -k + \\sqrt{k^2 + \\frac{4\\eta\\sigma\\rho}{\\lambda}} \\right)$$\n\nThe corresponding steady-state concentration $v^{*}$ is:\n$$v^{*} = \\frac{\\sigma}{\\lambda} u^{*} = \\frac{\\sigma}{\\lambda} \\left[ \\frac{\\lambda}{2\\eta\\sigma} \\left( -k + \\sqrt{k^2 + \\frac{4\\eta\\sigma\\rho}{\\lambda}} \\right) \\right]$$\n$$v^{*} = \\frac{1}{2\\eta} \\left( -k + \\sqrt{k^2 + \\frac{4\\eta\\sigma\\rho}{\\lambda}} \\right)$$\n\nThe necessary and sufficient conditions for this unique, strictly positive steady state $(u^{*}, v^{*})$ to exist are:\n$1$. $\\lambda, \\eta, \\sigma \\neq 0$.\n$2$. $\\frac{\\sigma}{\\lambda}  0$.\n$3$. $\\frac{\\rho}{\\eta}  0$.\nIn most physical models, all parameters $\\rho, k, \\eta, \\sigma, \\lambda$ are assumed to be positive, in which case these conditions are satisfied.\n\nThe final closed-form expression for the steady state $(u^{*}, v^{*})$ is given by the expressions derived.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\lambda}{2 \\eta \\sigma} \\left( -k + \\sqrt{k^2 + \\frac{4 \\eta \\sigma \\rho}{\\lambda}} \\right)  \\frac{1}{2 \\eta} \\left( -k + \\sqrt{k^2 + \\frac{4 \\eta \\sigma \\rho}{\\lambda}} \\right)\n\\end{pmatrix}\n}\n$$", "id": "2758480"}, {"introduction": "The spontaneous emergence of intricate patterns from a uniform state, a phenomenon predicted by Alan Turing, is a cornerstone of developmental biology and a grand challenge in synthetic biology. This process, known as diffusion-driven instability, occurs when interacting molecules with different diffusion rates break spatial symmetry. In this exercise, you will apply linear stability analysis to a classic activator-inhibitor system to derive its dispersion relation and predict which specific spatial pattern will be the first to emerge from the homogeneous steady state [@problem_id:2758478].", "problem": "A synthetic two-gene activator–inhibitor circuit drives pattern formation by diffusion of its protein products along a one-dimensional tissue of length $L$ with zero-flux (Neumann) boundary conditions at $x=0$ and $x=L$. The spatiotemporal dynamics of small deviations $u(x,t)$ and $v(x,t)$ in the concentrations of the activator and inhibitor from a spatially uniform steady state $(u^{\\ast},v^{\\ast})$ are modeled by the Reaction–Diffusion Partial Differential Equations (PDEs)\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u \\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; f_u\\,u \\;+\\; f_v\\,v,\n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v \\,\\frac{\\partial^2 v}{\\partial x^2} \\;+\\; g_u\\,u \\;+\\; g_v\\,v,\n$$\nwhere $D_u$ and $D_v$ are the diffusion coefficients and $f_u, f_v, g_u, g_v$ are the entries of the Jacobian matrix of the well-mixed kinetics evaluated at $(u^{\\ast},v^{\\ast})$. Assume that the well-mixed steady state is linearly stable in the absence of diffusion.\n\nIn a designed construct, the parameters at $(u^{\\ast},v^{\\ast})$ are\n$$\nD_u \\;=\\; 1, \\qquad D_v \\;=\\; 20, \\qquad\n\\begin{pmatrix}\nf_u  f_v \\\\[4pt]\ng_u  g_v\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0.5  -1 \\\\[4pt]\n1  -1\n\\end{pmatrix},\n$$\nand the tissue length is $L=20$ (arbitrary length units). Under zero-flux boundary conditions on $[0,L]$, the spatial Laplacian eigenmodes are cosine modes with discrete wavenumbers $k_n = n\\pi/L$ for integers $n \\ge 0$.\n\nStarting from the Reaction–Diffusion PDEs and the definition of linear stability for the well-mixed Jacobian, derive from first principles the dispersion relation for the temporal growth rate $\\lambda(k)$ of a spatial Fourier mode with wavenumber $k$ and then determine, among the discrete admissible wavenumbers $k_n = n\\pi/L$, which integer mode number $n$ attains the largest real part $\\mathrm{Re}(\\lambda(k_n))$ at $t=0^{+}$ and is therefore selected initially. Give the single integer $n$ that maximizes $\\mathrm{Re}(\\lambda(k_n))$. Do not include any other text in your final answer.", "solution": "The problem requires the derivation of the dispersion relation for a linearized one-dimensional reaction-diffusion system and the identification of the initially selected unstable spatial mode.\n\nThe governing equations for the small deviations $u(x,t)$ and $v(x,t)$ from a uniform steady state are given by the system of linear partial differential equations (PDEs):\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\frac{\\partial^2 u}{\\partial x^2} + f_u u + f_v v\n$$\n$$\n\\frac{\\partial v}{\\partial t} = D_v \\frac{\\partial^2 v}{\\partial x^2} + g_u u + g_v v\n$$\nThis can be written in vector form as:\n$$\n\\frac{\\partial \\mathbf{c}}{\\partial t} = \\mathbf{D} \\frac{\\partial^2 \\mathbf{c}}{\\partial x^2} + \\mathbf{J} \\mathbf{c}\n$$\nwhere $\\mathbf{c} = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$, $\\mathbf{D} = \\begin{pmatrix} D_u  0 \\\\ 0  D_v \\end{pmatrix}$, and $\\mathbf{J} = \\begin{pmatrix} f_u  f_v \\\\ g_u  g_v \\end{pmatrix}$.\n\nThe domain is a one-dimensional interval $[0, L]$ with zero-flux (Neumann) boundary conditions. The eigenfunctions of the spatial Laplacian operator $\\frac{\\partial^2}{\\partial x^2}$ satisfying these boundary conditions are cosine modes, $\\cos(k_n x)$, with corresponding eigenvalues $-k_n^2$, where the wavenumbers $k_n = \\frac{n\\pi}{L}$ for integers $n \\ge 0$. Any solution $\\mathbf{c}(x,t)$ can be decomposed into a series of these spatial modes. We analyze the stability of each mode individually by considering a solution of the form:\n$$\n\\mathbf{c}(x,t) = \\mathbf{c}_n \\exp(\\lambda(k_n)t) \\cos(k_n x)\n$$\nwhere $\\mathbf{c}_n$ is a constant vector of amplitudes and $\\lambda(k_n)$ is the temporal growth rate (an eigenvalue) associated with the mode of wavenumber $k_n$. Substituting this ansatz into the PDE system yields an algebraic eigenvalue problem for $\\lambda$. For a generic wavenumber $k$:\n$$\n\\lambda \\mathbf{c}_k \\exp(\\lambda t) \\cos(kx) = \\mathbf{D} (-k^2) \\mathbf{c}_k \\exp(\\lambda t) \\cos(kx) + \\mathbf{J} \\mathbf{c}_k \\exp(\\lambda t) \\cos(kx)\n$$\nDividing by the spatiotemporal terms, we obtain:\n$$\n\\lambda \\mathbf{c}_k = (-k^2 \\mathbf{D} + \\mathbf{J}) \\mathbf{c}_k\n$$\nThis is an eigenvalue problem where $\\lambda$ is an eigenvalue of the matrix $\\mathbf{J}_k = \\mathbf{J} - k^2 \\mathbf{D}$. For a non-trivial solution for $\\mathbf{c}_k$, the determinant of $(\\mathbf{J}_k - \\lambda \\mathbf{I})$ must be zero, where $\\mathbf{I}$ is the identity matrix.\n$$\n\\det(\\mathbf{J}_k - \\lambda \\mathbf{I}) = \\det\\begin{pmatrix} f_u - D_u k^2 - \\lambda  f_v \\\\ g_u  g_v - D_v k^2 - \\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant yields the characteristic equation for $\\lambda$:\n$$\n(f_u - D_u k^2 - \\lambda)(g_v - D_v k^2 - \\lambda) - f_v g_u = 0\n$$\n$$\n\\lambda^2 - (f_u + g_v - (D_u + D_v)k^2)\\lambda + ((f_u - D_u k^2)(g_v - D_v k^2) - f_v g_u) = 0\n$$\nThis quadratic equation in $\\lambda$ is the dispersion relation. It can be written more compactly using the trace and determinant of the reaction Jacobian $\\mathbf{J}$:\n$$\n\\mathrm{Tr}(\\mathbf{J}) = f_u + g_v \\qquad \\det(\\mathbf{J}) = f_u g_v - f_v g_u\n$$\nThe equation becomes:\n$$\n\\lambda^2 - (\\mathrm{Tr}(\\mathbf{J}) - (D_u+D_v)k^2)\\lambda + (\\det(\\mathbf{J}) - (D_u g_v + D_v f_u)k^2 + D_u D_v k^4) = 0\n$$\nLet $T(k^2) = \\mathrm{Tr}(\\mathbf{J}) - (D_u+D_v)k^2$ and $\\Delta(k^2) = \\det(\\mathbf{J}) - (D_u g_v + D_v f_u)k^2 + D_u D_v k^4$. The solutions for $\\lambda(k)$ are:\n$$\n\\lambda_{\\pm}(k) = \\frac{T(k^2) \\pm \\sqrt{T(k^2)^2 - 4\\Delta(k^2)}}{2}\n$$\nThe stability of a mode with wavenumber $k$ is determined by the sign of the real part of the largest eigenvalue, $\\mathrm{Re}(\\lambda_+(k))$. An instability occurs if $\\mathrm{Re}(\\lambda_+(k))  0$.\n\nFirst, we verify the given condition that the well-mixed system ($k=0$) is stable. The parameters are:\n$D_u = 1$, $D_v = 20$, $L=20$.\n$\\mathbf{J} = \\begin{pmatrix} 0.5  -1 \\\\ 1  -1 \\end{pmatrix}$. So, $f_u=0.5, f_v=-1, g_u=1, g_v=-1$.\n\nFor $k=0$, the system is stable if $\\mathrm{Tr}(\\mathbf{J})  0$ and $\\det(\\mathbf{J})  0$.\n$\\mathrm{Tr}(\\mathbf{J}) = 0.5 + (-1) = -0.5  0$.\n$\\det(\\mathbf{J}) = (0.5)(-1) - (-1)(1) = -0.5 + 1 = 0.5  0$.\nThe conditions are satisfied, so the spatially uniform steady state is stable.\n\nFor diffusion-driven (Turing) instability, we need $\\mathrm{Re}(\\lambda_+(k))  0$ for some $k  0$.\nSince $T(k^2) = \\mathrm{Tr}(\\mathbf{J}) - (D_u+D_v)k^2$ is always negative for $k \\ge 0$ (as $\\mathrm{Tr}(\\mathbf{J})  0$), a positive growth rate can only emerge if the discriminant $T(k^2)^2 - 4\\Delta(k^2)$ is real and sufficiently large. This requires $\\Delta(k^2)$ to become negative, which in turn guarantees the discriminant is positive. Thus, instability occurs when the eigenvalues are real, and the condition for instability simplifies to $\\lambda_+(k)  0$. This requires $\\Delta(k^2)  0$.\n\nLet us analyze the function $\\Delta(k^2)$:\n$$\n\\Delta(k^2) = D_u D_v k^4 - (D_u g_v + D_v f_u) k^2 + \\det(\\mathbf{J})\n$$\nSubstituting the parameter values:\n$D_uD_v = (1)(20) = 20$.\n$D_u g_v + D_v f_u = (1)(-1) + (20)(0.5) = -1 + 10 = 9$.\n$\\det(\\mathbf{J}) = 0.5$.\nSo, $\\Delta(k^2) = 20 k^4 - 9 k^2 + 0.5$.\nA range of unstable modes exists if the minimum of this quadratic in $k^2$ is negative. The minimum occurs at $k^2 = -(-9)/(2 \\cdot 20) = 9/40$, and the minimum value is $20(9/40)^2 - 9(9/40) + 0.5 = -0.6125  0$, confirming the existence of an unstable band of wavenumbers.\n\nThe initially selected mode is the one with the largest growth rate, i.e., the one corresponding to the wavenumber $k_{max}$ that maximizes $\\mathrm{Re}(\\lambda_+(k))$. The function to maximize is $\\lambda_+(k) = \\frac{1}{2}\\left(T(k^2) + \\sqrt{T(k^2)^2 - 4\\Delta(k^2)}\\right)$. Maximizing this complex function is non-trivial. However, in the standard analysis of Turing systems, the maximum of the growth rate is well-approximated by the minimum of the determinant function $\\Delta(k^2)$. This is because the variation in $\\Delta(k^2)$, which has a quadratic dependence on $k^2$, typically dominates the behavior of the growth rate near its maximum, compared to the linear dependence of $T(k^2)$.\n\nWe therefore find the wavenumber $k_{max}$ that maximizes the instability by minimizing $\\Delta(k^2)$ with respect to $k^2$.\n$$\n\\frac{d}{d(k^2)} \\Delta(k^2) = \\frac{d}{d(k^2)} (20(k^2)^2 - 9k^2 + 0.5) = 40k^2 - 9\n$$\nSetting the derivative to zero gives the optimal squared wavenumber:\n$$\n40 k_{max}^2 - 9 = 0 \\implies k_{max}^2 = \\frac{9}{40} = 0.225\n$$\nThe corresponding wavenumber is $k_{max} = \\sqrt{0.225} \\approx 0.474$.\n\nThe system supports only discrete wavenumbers $k_n = \\frac{n\\pi}{L}$ for integers $n \\ge 0$. With $L=20$, this is $k_n = \\frac{n\\pi}{20}$.\nThe squared wavenumbers are $k_n^2 = \\frac{n^2\\pi^2}{400}$.\nWe must find the integer $n \\ge 1$ (since $n=0$ is stable) for which $k_n^2$ is closest to $k_{max}^2 = 0.225$.\n$$\n\\frac{n^2\\pi^2}{400} \\approx 0.225\n$$\n$$\nn^2 \\approx \\frac{400 \\times 0.225}{\\pi^2} = \\frac{90}{\\pi^2}\n$$\nUsing $\\pi \\approx 3.14159$, we have $\\pi^2 \\approx 9.8696$.\n$$\nn^2 \\approx \\frac{90}{9.8696} \\approx 9.1189\n$$\n$$\nn \\approx \\sqrt{9.1189} \\approx 3.0198\n$$\nThe integer closest to this value is $n=3$.\nTo confirm, let's compare $k_n^2$ for $n=2, 3, 4$ to $k_{max}^2 = 0.225$:\n- For $n=2$: $k_2^2 = \\frac{4\\pi^2}{400} = \\frac{\\pi^2}{100} \\approx 0.0987$. $|0.0987 - 0.225| = 0.1263$.\n- For $n=3$: $k_3^2 = \\frac{9\\pi^2}{400} \\approx \\frac{9 \\times 9.8696}{400} \\approx 0.2221$. $|0.2221 - 0.225| = 0.0029$.\n- For $n=4$: $k_4^2 = \\frac{16\\pi^2}{400} = \\frac{\\pi^2}{25} \\approx 0.3948$. $|0.3948 - 0.225| = 0.1698$.\n\nThe value of $k_3^2$ is significantly closer to the optimal value $k_{max}^2$ than any other mode. Therefore, the mode with integer number $n=3$ will have the largest growth rate and will be the one selected initially to form a spatial pattern.", "answer": "$$\\boxed{3}$$", "id": "2758478"}]}