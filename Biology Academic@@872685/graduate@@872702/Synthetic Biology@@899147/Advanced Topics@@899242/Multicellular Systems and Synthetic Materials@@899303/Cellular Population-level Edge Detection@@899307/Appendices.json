{"hands_on_practices": [{"introduction": "This first practice is a foundational exercise in mathematical biology. We will take a classic reaction-diffusion model for an activator-inhibitor system and use nondimensionalization to reveal the essential physics. This powerful technique distills a complex set of parameters into a few key dimensionless groups that govern the system's ability to form sharp spatial patterns [@problem_id:2719110].", "problem": "A spatially extended microbial population implements edge detection using two diffusible species: an intracellularly produced activator, denoted by concentration $a(x,t)$, and a diffusible inhibitor, denoted by concentration $i(x,t)$. The population lies in a $1$-dimensional strip of characteristic length $\\mathcal{L}$ with spatial coordinate $x \\in [0,\\mathcal{L}]$. Both species obey Fickian diffusion and first-order decay. The activator is produced in response to an externally maintained morphogen profile $m(x)$ with Hill-type regulation, while the inhibitor is produced proportionally to the local activator level. The governing reaction-diffusion equations are\n$$\n\\frac{\\partial a}{\\partial t} \\;=\\; D_{a}\\,\\frac{\\partial^{2} a}{\\partial x^{2}} \\;+\\; s_{a}\\,f\\!\\left(m(x)\\right) \\;-\\; k_{a}\\,a,\n\\qquad\n\\frac{\\partial i}{\\partial t} \\;=\\; D_{i}\\,\\frac{\\partial^{2} i}{\\partial x^{2}} \\;+\\; s_{i}\\,a \\;-\\; k_{i}\\,i,\n$$\nwhere $D_{a}$ and $D_{i}$ are diffusion coefficients, $k_{a}$ and $k_{i}$ are first-order decay rates, $s_{a}$ and $s_{i}$ are production rate constants, and the Hill regulation is\n$$\nf\\!\\left(m\\right) \\;=\\; \\frac{m^{n}}{K^{n} + m^{n}},\n$$\nwith Hill coefficient $n \\geq 1$ and activation threshold $K0$. Assume no-flux boundary conditions at $x=0$ and $x=\\mathcal{L}$. The external morphogen $m(x)$ is prescribed and varies smoothly on the spatial domain.\n\nStarting from the fundamental principles of Fickian diffusion and first-order reaction kinetics, introduce characteristic scales for time $T$, length $L$, and concentrations $A_{0}$ and $I_{0}$ to nondimensionalize the system. Define the dimensionless variables $\\tau = t/T$, $\\xi = x/L$, $\\alpha(\\xi,\\tau) = a(x,t)/A_{0}$, and $\\iota(\\xi,\\tau) = i(x,t)/I_{0}$. Derive the nondimensional equations and identify the minimal set of dimensionless groups that govern the shape of the steady-state spatial patterns and the sharpness of the detected edge at the interface of high and low morphogen. Discuss the physical meaning of each dimensionless group you identify in terms of relative diffusion lengths, production versus decay balance, and regulatory steepness.\n\nDefine the edge sharpness index $\\Gamma$ to be the ratio of the activator diffusion length to the inhibitor diffusion length, where the diffusion length of a species with diffusion coefficient $D$ and decay rate $k$ is defined as $\\ell \\equiv \\sqrt{D/k}$. Express $\\Gamma$ in closed form in terms of the dimensional parameters $D_{a}$, $D_{i}$, $k_{a}$, and $k_{i}$. Your final reported answer should be this expression for $\\Gamma$ only, which is dimensionless and thus must be expressed without units.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard activator-inhibitor system, a cornerstone model in the study of biological pattern formation, described by a set of reaction-diffusion partial differential equations. The parameters and functions are clearly defined, and the task—to nondimensionalize the system, identify governing dimensionless parameters, and derive a specific index—is a standard and rigorous procedure in mathematical biology and physics. Therefore, we will proceed with the solution.\n\nThe problem requires us to analyze the dynamics of an activator $a(x,t)$ and an inhibitor $i(x,t)$ governed by the following system of equations in a one-dimensional domain $x \\in [0, \\mathcal{L}]$:\n$$\n\\frac{\\partial a}{\\partial t} = D_{a}\\,\\frac{\\partial^{2} a}{\\partial x^{2}} + s_{a}\\,f\\!\\left(m(x)\\right) - k_{a}\\,a\n$$\n$$\n\\frac{\\partial i}{\\partial t} = D_{i}\\,\\frac{\\partial^{2} i}{\\partial x^{2}} + s_{i}\\,a - k_{i}\\,i\n$$\nThe first step is to nondimensionalize this system. We introduce the dimensionless variables $\\tau = t/T$, $\\xi = x/L$, $\\alpha(\\xi,\\tau) = a(x,t)/A_{0}$, and $\\iota(\\xi,\\tau) = i(x,t)/I_{0}$, where $T$, $L$, $A_{0}$, and $I_{0}$ are characteristic scales for time, length, activator concentration, and inhibitor concentration, respectively.\n\nThe partial derivatives transform as follows:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{1}{T}\\frac{\\partial}{\\partial \\tau}, \\qquad \\frac{\\partial^{2}}{\\partial x^{2}} = \\frac{1}{L^{2}}\\frac{\\partial^{2}}{\\partial \\xi^{2}}\n$$\nSubstituting these into the governing equations, we obtain:\n$$\n\\frac{A_{0}}{T}\\frac{\\partial \\alpha}{\\partial \\tau} = D_{a}\\frac{A_{0}}{L^{2}}\\frac{\\partial^{2} \\alpha}{\\partial \\xi^{2}} + s_{a}\\,f\\!\\left(m(L\\xi)\\right) - k_{a}A_{0}\\alpha\n$$\n$$\n\\frac{I_{0}}{T}\\frac{\\partial \\iota}{\\partial \\tau} = D_{i}\\frac{I_{0}}{L^{2}}\\frac{\\partial^{2} \\iota}{\\partial \\xi^{2}} + s_{i}A_{0}\\alpha - k_{i}I_{0}\\iota\n$$\nWe must now choose the characteristic scales. A logical choice for the length scale is the system size, $L = \\mathcal{L}$. For the time scale, we select the inverse of the activator decay rate, $T = 1/k_{a}$, as this represents a fundamental timescale of the system's reaction kinetics. For the activator concentration scale $A_{0}$, we balance the maximum production rate, $s_{a}$ (since $0 \\le f(m) \\le 1$), with the decay rate, yielding $A_{0} = s_{a}/k_{a}$. For the inhibitor concentration scale $I_{0}$, we balance its production from a characteristic activator level $A_{0}$ with its decay, yielding $s_{i}A_{0} = k_{i}I_{0}$, so $I_{0} = s_{i}A_{0}/k_{i} = s_{i}s_{a}/(k_{a}k_{i})$.\n\nWith these scales, we substitute and simplify. First, for the activator equation:\n$$\n\\frac{s_{a}/k_{a}}{1/k_{a}}\\frac{\\partial \\alpha}{\\partial \\tau} = D_{a}\\frac{s_{a}/k_{a}}{\\mathcal{L}^{2}}\\frac{\\partial^{2} \\alpha}{\\partial \\xi^{2}} + s_{a}\\,f\\!\\left(m(\\mathcal{L}\\xi)\\right) - k_{a}(s_{a}/k_{a})\\alpha\n$$\nDividing by $s_{a}$ gives:\n$$\n\\frac{\\partial \\alpha}{\\partial \\tau} = \\frac{D_{a}}{k_{a}\\mathcal{L}^{2}}\\frac{\\partial^{2} \\alpha}{\\partial \\xi^{2}} + f\\!\\left(m(\\mathcal{L}\\xi)\\right) - \\alpha\n$$\nNext, for the inhibitor equation:\n$$\n\\frac{I_{0}}{1/k_{a}}\\frac{\\partial \\iota}{\\partial \\tau} = D_{i}\\frac{I_{0}}{\\mathcal{L}^{2}}\\frac{\\partial^{2} \\iota}{\\partial \\xi^{2}} + s_{i}A_{0}\\alpha - k_{i}I_{0}\\iota\n$$\nDividing by $k_{a}I_{0}$ gives:\n$$\n\\frac{\\partial \\iota}{\\partial \\tau} = \\frac{D_{i}}{k_{a}\\mathcal{L}^{2}}\\frac{\\partial^{2} \\iota}{\\partial \\xi^{2}} + \\frac{s_{i}A_{0}}{k_{a}I_{0}}\\alpha - \\frac{k_{i}}{k_{a}}\\iota\n$$\nSubstituting our chosen scales for $A_{0}$ and $I_{0}$ into the coefficient of $\\alpha$:\n$$\n\\frac{s_{i}A_{0}}{k_{a}I_{0}} = \\frac{s_{i}(s_{a}/k_{a})}{k_{a}(s_{i}s_{a}/(k_{a}k_{i}))} = \\frac{s_{i}s_{a}/k_{a}}{s_{i}s_{a}/k_{i}} = \\frac{k_{i}}{k_{a}}\n$$\nThus, the dimensionless system of equations is:\n$$\n\\frac{\\partial \\alpha}{\\partial \\tau} = \\left(\\frac{D_{a}}{k_{a}\\mathcal{L}^{2}}\\right)\\frac{\\partial^{2} \\alpha}{\\partial \\xi^{2}} + \\tilde{f}(\\xi) - \\alpha\n$$\n$$\n\\frac{\\partial \\iota}{\\partial \\tau} = \\left(\\frac{D_{i}}{k_{a}\\mathcal{L}^{2}}\\right)\\frac{\\partial^{2} \\iota}{\\partial \\xi^{2}} + \\frac{k_{i}}{k_{a}}\\left(\\alpha - \\iota\\right)\n$$\nwhere $\\tilde{f}(\\xi) = f(m(\\mathcal{L}\\xi))$.\n\nThe problem asks for the parameters governing the steady-state patterns ($ \\partial/\\partial\\tau = 0 $). The steady-state equations are:\n$$\n0 = \\left(\\frac{D_{a}}{k_{a}\\mathcal{L}^{2}}\\right)\\frac{d^{2} \\alpha}{d \\xi^{2}} + \\tilde{f}(\\xi) - \\alpha\n$$\n$$\n0 = \\left(\\frac{D_{i}}{k_{a}\\mathcal{L}^{2}}\\right)\\frac{d^{2} \\iota}{d \\xi^{2}} + \\frac{k_{i}}{k_{a}}\\left(\\alpha - \\iota\\right)\n$$\nUsing the definition of a diffusion length $\\ell \\equiv \\sqrt{D/k}$, we have $\\ell_{a} = \\sqrt{D_{a}/k_{a}}$ and $\\ell_{i} = \\sqrt{D_{i}/k_{i}}$. The coefficients can be rewritten in terms of these fundamental lengths:\n$$\n\\frac{D_{a}}{k_{a}\\mathcal{L}^{2}} = \\left(\\frac{\\ell_{a}}{\\mathcal{L}}\\right)^{2}, \\qquad \\frac{D_{i}}{k_{a}\\mathcal{L}^{2}} = \\frac{D_{i}}{k_{i}\\mathcal{L}^{2}}\\frac{k_{i}}{k_{a}} = \\left(\\frac{\\ell_{i}}{\\mathcal{L}}\\right)^{2}\\frac{k_{i}}{k_{a}}\n$$\nSubstituting these into the second steady-state equation:\n$$\n0 = \\left(\\frac{\\ell_{i}}{\\mathcal{L}}\\right)^{2}\\frac{k_{i}}{k_{a}}\\frac{d^{2} \\iota}{d \\xi^{2}} + \\frac{k_{i}}{k_{a}}\\left(\\alpha - \\iota\\right)\n$$\nSince $k_{i}/k_{a} \\neq 0$, we can divide by it. The final steady-state system is:\n$$\n\\alpha - \\left(\\frac{\\ell_{a}}{\\mathcal{L}}\\right)^{2}\\frac{d^{2} \\alpha}{d \\xi^{2}} = \\tilde{f}(\\xi)\n$$\n$$\n\\iota - \\left(\\frac{\\ell_{i}}{\\mathcal{L}}\\right)^{2}\\frac{d^{2} \\iota}{d \\xi^{2}} = \\alpha\n$$\nFrom this form, the minimal set of dimensionless groups governing the spatial pattern shape is evident:\n1.  $\\Pi_{1} = \\ell_{a}/\\mathcal{L}$: The activator diffusion length relative to the system size. This group represents the ratio of two timescales: the square root of the activator decay timescale ($1/k_a$) to the diffusion timescale across the system ($\\mathcal{L}^2/D_a$). It determines the degree of spatial filtering, or blurring, of the input morphogen profile $\\tilde{f}(\\xi)$ to produce the activator profile $\\alpha(\\xi)$.\n2.  $\\Pi_{2} = \\ell_{i}/\\mathcal{L}$: The inhibitor diffusion length relative to the system size. Analogous to $\\Pi_{1}$, it sets the length scale over which the inhibitor profile $\\iota(\\xi)$ is smoothed relative to its source, the activator profile $\\alpha(\\xi)$.\n3.  $n$: The Hill coefficient. This parameter, originating from the function $\\tilde{f}$, controls the steepness or ultrasensitivity of the production response to the morphogen $m(x)$. A high value of $n$ leads to a more switch-like response, which is a prerequisite for a sharp edge.\n\nFor effective edge detection via lateral inhibition, the inhibitor must diffuse significantly farther than the activator, i.e., $\\ell_{i}  \\ell_{a}$. This ensures that cells in a high-morphogen region activate their neighbors but also inhibit cells further away, confining the activation to a sharp boundary. Therefore, the ratio $\\ell_{i}/\\ell_{a}$ is the most critical parameter for the sharpness of the edge. The set $\\{\\ell_{a}/\\mathcal{L}, \\ell_{i}/\\ell_{a}, n\\}$ is an equivalent minimal set describing the pattern-forming capability.\n\nFinally, we are asked to find the expression for the edge sharpness index $\\Gamma$, which is defined in the problem as the ratio of the activator diffusion length to the inhibitor diffusion length.\n$$\n\\Gamma \\equiv \\frac{\\ell_{a}}{\\ell_{i}}\n$$\nUsing the definition of diffusion length $\\ell = \\sqrt{D/k}$, we have:\n$$\n\\ell_{a} = \\sqrt{\\frac{D_{a}}{k_{a}}}, \\qquad \\ell_{i} = \\sqrt{\\frac{D_{i}}{k_{i}}}\n$$\nSubstituting these into the expression for $\\Gamma$:\n$$\n\\Gamma = \\frac{\\sqrt{D_{a}/k_{a}}}{\\sqrt{D_{i}/k_{i}}} = \\sqrt{\\frac{D_{a}/k_{a}}{D_{i}/k_{i}}} = \\sqrt{\\frac{D_{a} k_{i}}{D_{i} k_{a}}}\n$$\nThis dimensionless quantity captures the crucial balance of diffusion and decay rates between the activator and inhibitor species that determines the system's ability to form a sharp spatial boundary. A value of $\\Gamma  1$ is required for this mechanism of edge detection.", "answer": "$$\\boxed{\\sqrt{\\frac{D_{a} k_{i}}{D_{i} k_{a}}}}$$", "id": "2719110"}, {"introduction": "Theoretical models often assume a continuous medium, but biological systems consist of discrete cells. This computational exercise explores the important gap between continuum theory and discrete reality. You will implement both a continuous and a discrete version of a simple edge detector to quantify how finite cell numbers and spacing can affect the perceived location of a biological boundary [@problem_id:2719084].", "problem": "Consider a one-dimensional population of cells arranged along a line segment of length $L$, with $N$ cells uniformly spaced at positions $x_i = i \\,\\Delta x$ for $i \\in \\{0,1,\\dots,N-1\\}$ and $\\Delta x = L/(N-1)$. An external morphogen field varies along the domain according to the widely observed steady-state of a diffusion-decay process, modeled as $M(x) = M_0 \\exp(-x/\\lambda)$ for $x \\in [0,L]$, where $M_0  0$ is the morphogen concentration at the left boundary and $\\lambda  0$ is the characteristic decay length. A reporter gene is activated in each cell by the morphogen according to a standard Hill-type input-output function $r(x) = \\dfrac{M(x)^n}{K^n + M(x)^n}$, where $K  0$ is the half-activation constant and $n \\ge 1$ is the Hill coefficient.\n\nDefine a population-level edge as the spatial location that maximizes the magnitude of the spatial derivative of reporter activity. Concretely:\n- The continuum-predicted edge location $x_c$ is any maximizer of $|dr/dx|$ on the interval $[0,L]$. If the maximizer would lie outside $[0,L]$ for the given parameters, define $x_c$ to be the closest point in $[0,L]$ to that unconstrained maximizer (i.e., the projection of the unconstrained maximizer onto $[0,L]$).\n- The discrete-predicted edge location $x_d$ is computed by first evaluating $r_i = r(x_i)$ at each cell position $x_i$, then approximating the spatial derivative at interior indices via the centered difference $g_i = \\dfrac{r_{i+1}-r_{i-1}}{2\\,\\Delta x}$ for $i \\in \\{1,2,\\dots,N-2\\}$, and finally selecting $x_d = x_{i^\\star}$ where $i^\\star$ is any index that maximizes $|g_i|$ over interior indices. If there are multiple maximizers, choose the smallest such index $i^\\star$.\n\nYour task is to write a program that, for each test case below, computes the boundary localization difference $\\delta = x_d - x_c$ using the definitions above. Express all answers as unitless real numbers. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each number must be rounded to exactly six digits after the decimal point.\n\nUse the following test suite of parameter sets $(N,L,M_0,K,\\lambda,n)$, chosen to probe general behavior, boundary-dominated conditions, and discretization-limited regimes:\n1. $(N,L,M_0,K,\\lambda,n) = (\\,9,\\,1,\\,1,\\,0.2,\\,0.2,\\,2\\,)$.\n2. $(N,L,M_0,K,\\lambda,n) = (\\,5,\\,1,\\,0.3,\\,0.5,\\,0.2,\\,2\\,)$.\n3. $(N,L,M_0,K,\\lambda,n) = (\\,7,\\,1,\\,5,\\,0.1,\\,0.3,\\,2\\,)$.\n4. $(N,L,M_0,K,\\lambda,n) = (\\,17,\\,1,\\,1,\\,0.2,\\,0.1,\\,2\\,)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each \"result\" is the computed $\\delta$ for the corresponding test case, rounded to six digits after the decimal point.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and complete. It presents a standard model from biophysics involving a diffusion-decay morphogen gradient and a Hill-type genetic response. The definitions of the continuum and discrete edge locations are precise and unambiguous, allowing for a unique solution to be systematically computed. The problem is therefore valid.\n\nThe task is to compute the difference $\\delta = x_d - x_c$ between the discretely computed edge location, $x_d$, and the continuum-predicted edge location, $x_c$. The solution is derived in two stages: first, an analytical expression for $x_c$ is determined, and second, a numerical procedure for finding $x_d$ is specified.\n\nFirst, we determine the continuum edge location, $x_c$. This is defined as the location $x \\in [0,L]$ that maximizes the magnitude of the spatial derivative of the reporter activity, $|\\frac{dr}{dx}|$. The reporter activity $r$ is a function of the morphogen concentration $M$, which in turn is a function of position $x$. The chain rule for differentiation yields:\n$$\n\\frac{dr}{dx} = \\frac{dr}{dM} \\frac{dM}{dx}\n$$\nThe morphogen concentration is given by $M(x) = M_0 \\exp(-x/\\lambda)$. Its derivative with respect to $x$ is:\n$$\n\\frac{dM}{dx} = \\frac{d}{dx} \\left( M_0 e^{-x/\\lambda} \\right) = -\\frac{M_0}{\\lambda} e^{-x/\\lambda} = -\\frac{M(x)}{\\lambda}\n$$\nThe reporter activity is given by the Hill function $r(M) = \\frac{M(x)^n}{K^n + M(x)^n}$. Its derivative with respect to $M$ is:\n$$\n\\frac{dr}{dM} = \\frac{d}{dM} \\left( \\frac{M^n}{K^n + M^n} \\right) = \\frac{n M^{n-1}(K^n + M^n) - M^n(n M^{n-1})}{(K^n + M^n)^2} = \\frac{n K^n M^{n-1}}{(K^n + M^n)^2}\n$$\nCombining these results, the spatial derivative of the reporter activity is:\n$$\n\\frac{dr}{dx} = \\left( \\frac{n K^n M(x)^{n-1}}{(K^n + M(x)^n)^2} \\right) \\left( -\\frac{M(x)}{\\lambda} \\right) = -\\frac{n K^n M(x)^n}{\\lambda (K^n + M(x)^n)^2}\n$$\nSince $M(x)$ is a strictly decreasing function for $x \\in [0,L]$, the derivative $\\frac{dr}{dx}$ is always negative. Therefore, maximizing its magnitude, $|\\frac{dr}{dx}|$, is equivalent to finding the minimum value of $\\frac{dr}{dx}$ (the most negative value). We find the extremum of $\\frac{dr}{dx}$ by setting its derivative with respect to $x$ to zero, $\\frac{d}{dx}(\\frac{dr}{dx}) = 0$. Using the chain rule again:\n$$\n\\frac{d}{dx}\\left(\\frac{dr}{dx}\\right) = \\frac{d}{dM}\\left(\\frac{dr}{dx}\\right) \\frac{dM}{dx} = 0\n$$\nSince $\\frac{dM}{dx} \\neq 0$, we require $\\frac{d}{dM}(\\frac{dr}{dx}) = 0$. Let us find the extremum of the $M$-dependent part of $\\frac{dr}{dx}$, which is the function $f(M) = \\frac{M^n}{(K^n + M^n)^2}$. Setting its derivative with respect to $M$ to zero:\n$$\n\\frac{df}{dM} = \\frac{n M^{n-1}(K^n+M^n)^2 - M^n \\cdot 2(K^n+M^n) \\cdot n M^{n-1}}{(K^n+M^n)^4} = 0\n$$\nFor $M  0$ and $K  0$, this simplifies to:\n$$\n(K^n + M^n) - 2M^n = 0 \\implies K^n - M^n = 0 \\implies M = K\n$$\nThus, the magnitude of the gradient is maximized when the morphogen concentration equals the half-activation constant, $M(x) = K$. We solve for the location $x$ where this occurs:\n$$\nM_0 e^{-x/\\lambda} = K \\implies e^{-x/\\lambda} = \\frac{K}{M_0} \\implies -\\frac{x}{\\lambda} = \\ln\\left(\\frac{K}{M_0}\\right)\n$$\nThis gives the unconstrained maximizer $x_c^{\\text{unconstrained}} = -\\lambda \\ln(\\frac{K}{M_0}) = \\lambda \\ln(\\frac{M_0}{K})$.\nAs per the problem definition, this value must be projected onto the domain $[0,L]$. Therefore, the continuum edge location $x_c$ is:\n$$\nx_c = \\max\\left(0, \\min\\left(L, \\lambda \\ln\\left(\\frac{M_0}{K}\\right)\\right)\\right)\n$$\n\nSecond, we determine the discrete edge location, $x_d$. This is found by a numerical procedure:\n1.  Define the uniform grid of $N$ cell positions $x_i = i \\cdot \\Delta x$ for $i \\in \\{0, 1, \\dots, N-1\\}$, where the spacing is $\\Delta x = L/(N-1)$.\n2.  Evaluate the reporter activity at each position, $r_i = r(x_i) = \\frac{M(x_i)^n}{K^n + M(x_i)^n}$, where $M(x_i) = M_0 \\exp(-x_i/\\lambda)$.\n3.  Approximate the spatial derivative at each interior cell position $i \\in \\{1, 2, \\dots, N-2\\}$ using the centered difference formula, $g_i = \\frac{r_{i+1}-r_{i-1}}{2\\,\\Delta x}$.\n4.  Find the index $i^\\star$ that maximizes the magnitude $|g_i|$. If multiple indices yield the same maximum value, the smallest such index is chosen.\n5.  The discrete edge location is then $x_d = x_{i^\\star} = i^\\star \\cdot \\Delta x$.\n\nFinally, for each parameter set $(N,L,M_0,K,\\lambda,n)$, the difference $\\delta = x_d - x_c$ is computed. The implementation of this two-part procedure will yield the required results for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the boundary localization difference delta = xd - xc for a set of\n    test cases based on a synthetic biology edge detection model.\n    \"\"\"\n\n    # Test suite of parameter sets (N, L, M0, K, lambda, n)\n    test_cases = [\n        (9, 1.0, 1.0, 0.2, 0.2, 2.0),\n        (5, 1.0, 0.3, 0.5, 0.2, 2.0),\n        (7, 1.0, 5.0, 0.1, 0.3, 2.0),\n        (17, 1.0, 1.0, 0.2, 0.1, 2.0),\n    ]\n\n    results = []\n\n    for params in test_cases:\n        N, L, M0, K, lam, n = params\n\n        # Part 1: Calculate the continuum-predicted edge location, xc\n        # xc is the location that maximizes |dr/dx|. This occurs where M(x) = K.\n        # M0 * exp(-xc / lam) = K  =  xc = lam * log(M0 / K)\n        # We must clip xc to the domain [0, L].\n        if M0 / K = 0:\n            # Taking log of non-positive number is undefined. In our model M00, K0.\n            # However, if M0/K - 0, log(M0/K) - -inf.\n            # Physically, this means the condition M=K is met at x - +inf.\n            # The closest point in [0, L] is L.\n            unconstrained_xc = float('inf')\n        else:\n            unconstrained_xc = lam * np.log(M0 / K)\n        \n        xc = np.clip(unconstrained_xc, 0.0, L)\n\n        # Part 2: Calculate the discrete-predicted edge location, xd\n        # Create the grid of cell positions.\n        # Note: N-1 must be non-zero. The cases have N  1.\n        dx = L / (N - 1)\n        x_positions = np.linspace(0, L, N)\n\n        # Evaluate morphogen and reporter at each position.\n        M_vals = M0 * np.exp(-x_positions / lam)\n        r_vals = (M_vals**n) / (K**n + M_vals**n)\n\n        # Approximate the derivative at interior indices using centered difference.\n        # g_i = (r_{i+1} - r_{i-1}) / (2 * dx) for i in {1, ..., N-2}.\n        # Python slicing r_vals[2:] corresponds to r_{i+1} where i starts from 1.\n        # r_vals[:-2] corresponds to r_{i-1} where i starts from 1.\n        g_vals = (r_vals[2:] - r_vals[:-2]) / (2 * dx)\n        \n        # We are interested in the magnitude.\n        g_mags = np.abs(g_vals)\n\n        # Find the index i_star that maximizes |g_i|.\n        # np.argmax returns the first occurrence of the maximum, fulfilling the tie-breaking rule.\n        # The index returned by argmax is relative to g_mags. We need to shift it by 1\n        # because our loop for g_i started from i=1.\n        if len(g_mags)  0:\n            i_star = np.argmax(g_mags) + 1\n            xd = x_positions[i_star]\n        else:\n            # Case where N  3, so no interior points exist.\n            # This is not triggered by the test cases but is a valid consideration.\n            # In this scenario, xd is undefined. We can set it to a sentinel value.\n            # The problem constraints ensure N is large enough.\n            # For N=5, N-2=3 interior points. For N=7, N-2=5. For N=9, N-2=7.\n            # This branch is not taken.\n            xd = np.nan\n\n        # Part 3: Calculate the difference delta = xd - xc\n        delta = xd - xc\n        results.append(f\"{delta:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2719084"}, {"introduction": "Moving from analysis to design is a key step in synthetic biology. This final practice places you in the role of a circuit designer, tasked with optimizing a genetic band-pass filter—a common architecture for edge detection. Through a systematic parameter search, you will discover how molecular details like binding cooperativity and expression strength can be tuned to engineer a precise and sharp cellular response to a spatial gradient [@problem_id:2719114].", "problem": "A synthetic multicellular edge detector can be modeled by a band-pass gene expression circuit in which a morphogen concentration field varies across space and each cell’s steady-state output is the product of an activating Hill function and a repressing Hill function evaluated at the local morphogen level. The objective is to identify the activation and repression strengths and Hill coefficients that minimize the band width of the population response while maintaining a nonzero peak output in the presence of a spatial gradient.\n\nStart from the following well-tested facts and modeling assumptions. Gene expression driven by a transcription factor (the morphogen) can be approximated by Hill-type occupancy functions. Let the morphogen gradient be a smooth, monotone function of space, and let steady-state output be proportional to the product of an activation term and a repression term. For spatial position $x$ in a one-dimensional domain $[0,1]$, define the morphogen profile\n$$\ng(x) \\;=\\; g_{\\mathrm{lo}} \\;+\\; \\frac{g_{\\mathrm{hi}} - g_{\\mathrm{lo}}}{1 + \\exp\\!\\left(-\\frac{x - x_0}{\\sigma}\\right)} \\,,\n$$\nwith $g_{\\mathrm{lo}} \\in \\mathbb{R}_{0}$, $g_{\\mathrm{hi}} \\in \\mathbb{R}_{0}$, $x_0 \\in (0,1)$, and $\\sigma \\in \\mathbb{R}_{0}$. The activation term is\n$$\n\\mathrm{Act}(g; K_a, n) \\;=\\; \\frac{g^n}{K_a^n + g^n} \\,,\n$$\nand the repression term is\n$$\n\\mathrm{Rep}(g; K_r, m) \\;=\\; \\frac{K_r^m}{K_r^m + g^m} \\,.\n$$\nDefine the steady-state output of a cell at position $x$ by\n$$\ny(x; s_a, s_r, n, m) \\;=\\; \\left[\\mathrm{Act}\\!\\left(g(x); K_a, n\\right)\\right]^{s_a} \\cdot \\left[\\mathrm{Rep}\\!\\left(g(x); K_r, m\\right)\\right]^{s_r} \\,,\n$$\nwhere $s_a \\in \\mathbb{R}_{0}$ and $s_r \\in \\mathbb{R}_{0}$ are the activation and repression strengths, and $n \\in \\mathbb{N}$ and $m \\in \\mathbb{N}$ are the Hill coefficients for activation and repression, respectively. The thresholds $K_a$ and $K_r$ are fixed, with $K_a  K_r$, ensuring a band-pass regime for intermediate $g$.\n\nDefine the band width using the full width at half maximum (FWHM), where Full Width at Half Maximum (FWHM) is the spatial width over which the output exceeds half of its peak value. Let $y_{\\max} = \\max_{x \\in [0,1]} y(x)$ and $\\tau = \\frac{1}{2} y_{\\max}$. The FWHM is the measure\n$$\nW \\;=\\; \\max\\{x \\in [0,1] \\;|\\; y(x) \\ge \\tau\\} \\;-\\; \\min\\{x \\in [0,1] \\;|\\; y(x) \\ge \\tau\\} \\,,\n$$\ncomputed on a discrete grid. To avoid trivial solutions, require a nonzero peak by imposing $y_{\\max} \\ge \\varepsilon$ for a small $\\varepsilon \\in \\mathbb{R}_{0}$.\n\nYour task is to write a complete, runnable program that, for each specified test case, searches a discrete parameter grid for $(s_a, s_r, n, m)$ and returns the parameter tuple that minimizes the band width $W$ subject to $y_{\\max} \\ge \\varepsilon$. If there are ties in $W$ within numerical tolerance, prefer the tuple with larger $y_{\\max}$; if still tied, prefer the tuple with smaller $\\ell_2$ norm $\\sqrt{s_a^2 + s_r^2 + n^2 + m^2}$.\n\nAll quantities are dimensionless. Angles are not used. No percentages are used.\n\nUse the following fixed constants for all test cases:\n- $K_a = 0.5$,\n- $K_r = 2.0$,\n- $g_{\\mathrm{lo}} = 0.01$,\n- $g_{\\mathrm{hi}} = 10.0$,\n- $x_0 = 0.5$,\n- $\\varepsilon = 10^{-3}$,\n- Spatial domain $x \\in [0,1]$ discretized uniformly with $N = 1001$ points.\n\nUse the following parameter search grid for every test case:\n- Activation strength $s_a \\in \\{0.5, 1.0, 2.0\\}$,\n- Repression strength $s_r \\in \\{0.5, 1.0, 2.0\\}$,\n- Activation Hill coefficient $n \\in \\{1, 2, 3, 4\\}$,\n- Repression Hill coefficient $m \\in \\{1, 2, 3, 4\\}$.\n\nUse the following test suite of gradient steepness values:\n- Test case A: $\\sigma = 0.02$,\n- Test case B: $\\sigma = 0.10$,\n- Test case C: $\\sigma = 0.50$.\n\nFor each test case, compute the best tuple $(s_a, s_r, n, m)$, its achieved FWHM $W$, and its peak output $y_{\\max}$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The result for each test case must be a list of the form $[s_a, s_r, n, m, W, y_{\\max}]$ with $W$ and $y_{\\max}$ rounded to $6$ decimal places, in the order of the test cases A, B, C. For example, the overall output format must be\n$$\n\\big[ [s_a^{(A)}, s_r^{(A)}, n^{(A)}, m^{(A)}, W^{(A)}, y_{\\max}^{(A)}], [s_a^{(B)}, s_r^{(B)}, n^{(B)}, m^{(B)}, W^{(B)}, y_{\\max}^{(B)}], [s_a^{(C)}, s_r^{(C)}, n^{(C)}, m^{(C)}, W^{(C)}, y_{\\max}^{(C)}] \\big].\n$$\nNo additional text should be printed.", "solution": "The problem presented is a well-defined computational optimization task rooted in the field of synthetic biology. The objective is to determine the optimal parameters for a synthetic gene circuit designed to function as a population-level edge detector. This is achieved by engineering a band-pass filter response to a spatially varying morphogen concentration. The optimal parameters are those that minimize the spatial width of the gene expression band while ensuring a sufficiently high peak expression level.\n\nThe system is modeled as follows. A one-dimensional spatial domain is defined for $x \\in [0,1]$. Across this domain, a morphogen concentration profile $g(x)$ is established, described by a sigmoidal function:\n$$\ng(x) = g_{\\mathrm{lo}} + \\frac{g_{\\mathrm{hi}} - g_{\\mathrm{lo}}}{1 + \\exp\\left(-\\frac{x - x_0}{\\sigma}\\right)}\n$$\nHere, $g_{\\mathrm{lo}}$ and $g_{\\mathrm{hi}}$ are the minimum and maximum morphogen concentrations, $x_0$ is the center of the gradient, and $\\sigma$ controls the steepness of the gradient.\n\nCells at each position $x$ respond to the local morphogen concentration $g(x)$ through a gene circuit. The steady-state output of this circuit, denoted $y(x)$, is modeled as the product of an activating term and a repressing term. Both terms are described by Hill functions, which are standard for modeling cooperative molecular interactions.\n\nThe activation term, $\\mathrm{Act}(g)$, is given by:\n$$\n\\mathrm{Act}(g; K_a, n) = \\frac{g^n}{K_a^n + g^n}\n$$\nwhere $K_a$ is the activation threshold and $n$ is the activation Hill coefficient, which quantifies the steepness of the response.\n\nThe repression term, $\\mathrm{Rep}(g)$, is given by:\n$$\n\\mathrm{Rep}(g; K_r, m) = \\frac{K_r^m}{K_r^m + g^m}\n$$\nwhere $K_r$ is the repression threshold and $m$ is the repression Hill coefficient. The condition $K_a  K_r$ ensures that activation occurs at lower morphogen concentrations than repression, creating a band of expression at intermediate concentrations.\n\nThe total cell output $y(x)$ is a function of four tunable parameters: the activation strength $s_a$, the repression strength $s_r$, and the Hill coefficients $n$ and $m$.\n$$\ny(x; s_a, s_r, n, m) = \\left[\\mathrm{Act}(g(x); K_a, n)\\right]^{s_a} \\cdot \\left[\\mathrm{Rep}(g(x); K_r, m)\\right]^{s_r}\n$$\n\nThe primary optimization objective is to minimize the band width, $W$, of the expression profile $y(x)$. The band width is quantified by the Full Width at Half Maximum (FWHM). First, the peak output is found: $y_{\\max} = \\max_{x \\in [0,1]} y(x)$. The FWHM is then defined as the spatial distance between the two points where the output $y(x)$ is equal to half of its maximum value, $\\tau = \\frac{1}{2} y_{\\max}$. Formally:\n$$\nW = \\max\\{x \\in [0,1] \\mid y(x) \\ge \\tau\\} - \\min\\{x \\in [0,1] \\mid y(x) \\ge \\tau\\}\n$$\nTo prevent trivial solutions (e.g., zero output everywhere, which has a width of zero), a constraint is imposed: the peak output must be above a minimum threshold $\\varepsilon$.\n$$\ny_{\\max} \\ge \\varepsilon\n$$\nThe optimization problem is thus:\n$$\n\\min_{(s_a, s_r, n, m)} W \\quad \\text{subject to} \\quad y_{\\max} \\ge \\varepsilon\n$$\nThe search for the optimal parameter set $(s_a, s_r, n, m)$ is conducted over a specified discrete grid. Given the discrete nature of the search space, a solution is guaranteed to exist. To ensure a unique solution, a set of tie-breaking rules is defined:\n1.  If multiple parameter sets yield the same minimal width $W$ (within a small numerical tolerance), the set that produces the largest peak output $y_{\\max}$ is preferred.\n2.  If a tie still persists, the set with the smallest $\\ell_2$ norm, $\\sqrt{s_a^2 + s_r^2 + n^2 + m^2}$, is chosen.\n\nThe computational procedure to solve this problem for each test case involves the following steps:\n1.  Discretize the spatial domain $x \\in [0,1]$ into $N=1001$ equally spaced points.\n2.  For a given test case value of $\\sigma$, calculate the morphogen profile $g(x)$ over the discrete grid.\n3.  Iterate through every possible combination of $(s_a, s_r, n, m)$ from the provided parameter search grid.\n4.  For each parameter combination, calculate the output profile $y(x)$, find its maximum $y_{\\max}$, and verify that $y_{\\max} \\ge \\varepsilon$.\n5.  If the constraint is met, calculate the band width $W$.\n6.  Compare the resulting $(W, y_{\\max})$ and the parameter norm with the best values found so far, applying the hierarchical optimization criteria to update the best-known solution.\n7.  After exploring the entire parameter grid, the optimal parameter tuple $(s_a, s_r, n, m)$ and its corresponding metrics $W$ and $y_{\\max}$ are recorded. This process is repeated for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the synthetic biology edge detector optimization problem.\n    \"\"\"\n\n    # --- Fixed constants ---\n    KA = 0.5\n    KR = 2.0\n    G_LO = 0.01\n    G_HI = 10.0\n    X0 = 0.5\n    EPSILON = 1e-3\n    N_POINTS = 1001\n\n    # --- Spatial domain ---\n    x_grid = np.linspace(0, 1, N_POINTS)\n\n    # --- Parameter search grid ---\n    sa_grid = [0.5, 1.0, 2.0]\n    sr_grid = [0.5, 1.0, 2.0]\n    n_grid = [1, 2, 3, 4]\n    m_grid = [1, 2, 3, 4]\n\n    # --- Test cases for gradient steepness ---\n    test_cases = [\n        0.02,  # Case A\n        0.10,  # Case B\n        0.50,  # Case C\n    ]\n\n    all_results = []\n    TOL = 1e-9  # Numerical tolerance for float comparisons\n\n    for sigma in test_cases:\n        # Calculate morphogen profile for the current test case\n        g = G_LO + (G_HI - G_LO) / (1.0 + np.exp(-(x_grid - X0) / sigma))\n\n        # Initialize tracking variables for the best parameters\n        best_W = float('inf')\n        best_y_max_at_W = -1.0\n        best_norm_at_tie = float('inf')\n        best_params = None\n\n        # Grid search over all parameter combinations\n        for sa in sa_grid:\n            for sr in sr_grid:\n                for n in n_grid:\n                    for m in m_grid:\n                        # Calculate activation and repression terms\n                        gn = np.power(g, n)\n                        gm = np.power(g, m)\n                        \n                        act = gn / (KA**n + gn)\n                        rep = (KR**m) / (KR**m + gm)\n                        \n                        # Calculate cell output profile\n                        y = np.power(act, sa) * np.power(rep, sr)\n\n                        # Find peak output and check constraint\n                        y_max = np.max(y)\n                        if y_max  EPSILON:\n                            continue\n\n                        # Calculate Full Width at Half Maximum (FWHM)\n                        tau = 0.5 * y_max\n                        above_half_max_indices = np.where(y = tau)[0]\n                        \n                        if above_half_max_indices.size  1:\n                            W = x_grid[above_half_max_indices[-1]] - x_grid[above_half_max_indices[0]]\n                        else:\n                            # If only one point is at/above half-max, width is zero.\n                            W = 0.0\n\n                        # Apply optimization criteria with tie-breaking\n                        is_better = False\n                        if W  best_W - TOL:\n                            is_better = True\n                        elif W  best_W + TOL:  # Tie in W\n                            if y_max  best_y_max_at_W + TOL:\n                                is_better = True\n                            elif y_max  best_y_max_at_W - TOL:  # Tie in W and y_max\n                                norm = np.sqrt(sa**2 + sr**2 + n**2 + m**2)\n                                if norm  best_norm_at_tie - TOL:\n                                    is_better = True\n                        \n                        if is_better:\n                            best_W = W\n                            best_y_max_at_W = y_max\n                            best_norm_at_tie = np.sqrt(sa**2 + sr**2 + n**2 + m**2)\n                            best_params = (sa, sr, n, m)\n                            \n        # Store the result for the current test case\n        if best_params:\n            sa_opt, sr_opt, n_opt, m_opt = best_params\n            # Recalculate y_max for the optimal parameters, as best_y_max_at_W might be from a different set in case of a norm tie\n            gn_opt = np.power(g, n_opt)\n            gm_opt = np.power(g, m_opt)\n            act_opt = gn_opt / (KA**n_opt + gn_opt)\n            rep_opt = (KR**m_opt) / (KR**m_opt + gm_opt)\n            y_opt = np.power(act_opt, sa_opt) * np.power(rep_opt, sr_opt)\n            final_y_max = np.max(y_opt)\n\n            all_results.append([sa_opt, sr_opt, n_opt, m_opt, best_W, final_y_max])\n\n    # Format the final output string exactly as required\n    result_strings = []\n    for res in all_results:\n        sa, sr, n, m, W, y_max = res\n        result_strings.append(f\"[{sa}, {sr}, {n}, {m}, {W:.6f}, {y_max:.6f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2719114"}]}