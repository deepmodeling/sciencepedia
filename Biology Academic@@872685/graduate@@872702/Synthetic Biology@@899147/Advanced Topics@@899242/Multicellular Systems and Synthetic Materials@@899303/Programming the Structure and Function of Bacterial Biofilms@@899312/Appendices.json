{"hands_on_practices": [{"introduction": "A defining characteristic of biofilms is their remarkable tolerance to antimicrobials, a property stemming directly from their spatial structure. This exercise guides you through building a computational model to explore how the interplay between drug diffusion and degradation creates protected niches deep within a biofilm. By deriving the antibiotic concentration profile and numerically integrating survival probability [@problem_id:2763767], you will gain a quantitative grasp of how transport limitations fundamentally challenge therapeutic strategies and why understanding this spatial heterogeneity is critical for designing effective treatments.", "problem": "You are designing a computational routine to predict the survival fraction of bacteria in a spatially structured biofilm under exposure to an antibiotic with first-order kill kinetics. Use the following foundational bases and definitions.\n\n- Local bacterial population dynamics under time-dependent antibiotic exposure obeys first-order kill kinetics: for a small subpopulation at depth coordinate $z$, the local population $N(t,z)$ satisfies $dN/dt = -k(S(z))\\,N$, where $S(z)$ is the local antibiotic concentration at depth $z$ and $k(S)$ is a rate constant that depends on $S$.\n- The antibiotic concentration profile $S(z)$ within a one-dimensional biofilm slab of thickness $L$ under steady-state diffusion with first-order degradation satisfies $0 = D\\,d^2S/dz^2 - k_{\\mathrm{deg}}\\,S$ with boundary conditions $S(0) = S_{\\mathrm{ext}}$ (fixed concentration at the biofilm-bulk interface) and $\\left.\\frac{dS}{dz}\\right|_{z=L} = 0$ (no-flux at the base).\n- The pharmacodynamic kill rate follows the saturating form $k(S) = k_{\\max}\\,\\frac{S}{K_S + S}$, where $k_{\\max}$ is the maximum kill rate and $K_S$ is a half-saturation concentration.\n- The initial cell density across the biofilm is $\\rho(z) \\ge 0$. The survival fraction after a constant exposure for time $T$ is the weighted integral of the local survival $e^{-k(S(z))\\,T}$:\n$$\nF(T) = \\frac{\\int_0^L \\rho(z)\\,e^{-k(S(z))\\,T}\\,dz}{\\int_0^L \\rho(z)\\,dz}.\n$$\n- Assume the cell density profile is $\\rho(z) = \\exp(-\\beta z)$, where $\\beta$ is a real constant (with units of inverse length). For $\\beta = 0$, this reduces to a uniform density.\n\nYour task is to write a complete program that:\n1. Derives or otherwise computes the concentration profile $S(z)$ consistent with the steady-state diffusion-degradation model and boundary conditions above.\n2. Computes $F(T)$ by numerically evaluating the integral in $z \\in [0,L]$ using the provided $k(S)$ and $\\rho(z)$.\n3. Applies this computation to the following five test cases.\n\nUse the following units consistently:\n- Distance $z$ and thickness $L$ in meters (m).\n- Time $T$ in seconds (s).\n- Diffusion coefficient $D$ in square meters per second ($\\mathrm{m}^2/\\mathrm{s}$).\n- Degradation rate $k_{\\mathrm{deg}}$ and kill parameters $k_{\\max}$ in per second ($\\mathrm{s}^{-1}$).\n- Antibiotic concentrations $S$ and $K_S$ in micrograms per milliliter ($\\mu\\mathrm{g}/\\mathrm{mL}$).\n- The survival fraction $F(T)$ is unitless and must be reported as a decimal number.\n\nTest suite (each line is a parameter tuple $(L, D, k_{\\mathrm{deg}}, S_{\\mathrm{ext}}, k_{\\max}, K_S, T, \\beta)$):\n- Case 1 (happy path): $(L=\\;1.0\\times 10^{-4}\\,\\mathrm{m},\\; D=\\;5.0\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s},\\; k_{\\mathrm{deg}}=\\;1.0\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; S_{\\mathrm{ext}}=\\;8.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; k_{\\max}=\\;1.2\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; K_S=\\;1.5\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; T=\\;7200\\,\\mathrm{s},\\; \\beta=\\;1.0\\times 10^{4}\\,\\mathrm{m}^{-1})$.\n- Case 2 (boundary: very thin biofilm): $(L=\\;1.0\\times 10^{-6}\\,\\mathrm{m},\\; D=\\;5.0\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s},\\; k_{\\mathrm{deg}}=\\;1.0\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; S_{\\mathrm{ext}}=\\;8.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; k_{\\max}=\\;1.2\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; K_S=\\;1.5\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; T=\\;7200\\,\\mathrm{s},\\; \\beta=\\;0.0\\,\\mathrm{m}^{-1})$.\n- Case 3 (boundary: no degradation, uniform $S$): $(L=\\;2.0\\times 10^{-4}\\,\\mathrm{m},\\; D=\\;4.0\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s},\\; k_{\\mathrm{deg}}=\\;0.0\\,\\mathrm{s}^{-1},\\; S_{\\mathrm{ext}}=\\;6.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; k_{\\max}=\\;2.0\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; K_S=\\;2.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; T=\\;3600\\,\\mathrm{s},\\; \\beta=\\;5.0\\times 10^{3}\\,\\mathrm{m}^{-1})$.\n- Case 4 (edge: strong degradation and deep-weighted cells): $(L=\\;2.0\\times 10^{-4}\\,\\mathrm{m},\\; D=\\;3.0\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s},\\; k_{\\mathrm{deg}}=\\;5.0\\times 10^{-2}\\,\\mathrm{s}^{-1},\\; S_{\\mathrm{ext}}=\\;10.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; k_{\\max}=\\;1.5\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; K_S=\\;1.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; T=\\;5400\\,\\mathrm{s},\\; \\beta=\\;-5.0\\times 10^{3}\\,\\mathrm{m}^{-1})$.\n- Case 5 (edge: low antibiotic exposure): $(L=\\;1.5\\times 10^{-4}\\,\\mathrm{m},\\; D=\\;6.0\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s},\\; k_{\\mathrm{deg}}=\\;2.0\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; S_{\\mathrm{ext}}=\\;0.1\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; k_{\\max}=\\;2.0\\times 10^{-3}\\,\\mathrm{s}^{-1},\\; K_S=\\;5.0\\,\\mu\\mathrm{g}/\\mathrm{mL},\\; T=\\;1800\\,\\mathrm{s},\\; \\beta=\\;0.0\\,\\mathrm{m}^{-1})$.\n\nYour program should produce a single line of output containing the five survival fractions as a comma-separated list enclosed in square brackets, in the order of the cases above (for example, \"[f1,f2,f3,f4,f5]\"). Each $f_i$ must be a floating-point decimal number (unitless).", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and provides a complete, consistent set of data and definitions for a solvable problem in computational systems biology. No flaws were identified.\n\nThe solution proceeds in two stages. First, an analytical expression for the steady-state antibiotic concentration profile $S(z)$ is derived. Second, this expression is used to formulate the survival fraction $F(T)$ as an integral, which is then computed numerically.\n\nThe antibiotic concentration profile $S(z)$ within the biofilm of thickness $L$ is governed by the steady-state reaction-diffusion equation:\n$$D \\frac{d^2S}{dz^2} - k_{\\mathrm{deg}}S = 0$$\nwith boundary conditions $S(0) = S_{\\mathrm{ext}}$ and $\\left.\\frac{dS}{dz}\\right|_{z=L} = 0$. The coordinate $z=0$ represents the biofilm-bulk interface, and $z=L$ represents the impermeable base of the biofilm.\n\nWe analyze two cases for the degradation rate constant $k_{\\mathrm{deg}}$.\n\nCase 1: $k_{\\mathrm{deg}} > 0$.\nThe equation can be rewritten as $\\frac{d^2S}{dz^2} - \\lambda^2 S = 0$, where $\\lambda = \\sqrt{k_{\\mathrm{deg}}/D}$ is the inverse characteristic length of antibiotic penetration. The general solution to this ordinary differential equation is:\n$$S(z) = C_1 \\cosh(\\lambda z) + C_2 \\sinh(\\lambda z)$$\nThe constants $C_1$ and $C_2$ are determined by the boundary conditions.\nApplying the first boundary condition at $z=0$:\n$$S(0) = S_{\\mathrm{ext}} = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1$$\nThus, $C_1 = S_{\\mathrm{ext}}$. The solution becomes $S(z) = S_{\\mathrm{ext}} \\cosh(\\lambda z) + C_2 \\sinh(\\lambda z)$.\nTo apply the second boundary condition, we first find the derivative:\n$$\\frac{dS}{dz} = \\lambda S_{\\mathrm{ext}} \\sinh(\\lambda z) + \\lambda C_2 \\cosh(\\lambda z)$$\nApplying the no-flux condition at $z=L$:\n$$\\left.\\frac{dS}{dz}\\right|_{z=L} = \\lambda S_{\\mathrm{ext}} \\sinh(\\lambda L) + \\lambda C_2 \\cosh(\\lambda L) = 0$$\nSolving for $C_2$ (assuming $\\lambda \\ne 0$):\n$$C_2 = -S_{\\mathrm{ext}} \\frac{\\sinh(\\lambda L)}{\\cosh(\\lambda L)} = -S_{\\mathrm{ext}} \\tanh(\\lambda L)$$\nSubstituting $C_1$ and $C_2$ back into the expression for $S(z)$:\n$$S(z) = S_{\\mathrm{ext}} \\cosh(\\lambda z) - S_{\\mathrm{ext}} \\tanh(\\lambda L) \\sinh(\\lambda z)$$\nUsing the identity $\\cosh(A-B) = \\cosh(A)\\cosh(B) - \\sinh(A)\\sinh(B)$, we can simplify this expression:\n$$S(z) = S_{\\mathrm{ext}} \\frac{\\cosh(\\lambda L)\\cosh(\\lambda z) - \\sinh(\\lambda L)\\sinh(\\lambda z)}{\\cosh(\\lambda L)} = S_{\\mathrm{ext}} \\frac{\\cosh(\\lambda(L-z))}{\\cosh(\\lambda L)}$$\nThis is the analytical solution for the concentration profile when antibiotic degradation occurs.\n\nCase 2: $k_{\\mathrm{deg}} = 0$.\nThe governing equation simplifies to $\\frac{d^2S}{dz^2} = 0$. Integrating twice yields the linear profile $S(z) = C_1 z + C_2$.\nApplying the boundary conditions:\n$$S(0) = S_{\\mathrm{ext}} \\implies C_2 = S_{\\mathrm{ext}}$$\n$$\\left.\\frac{dS}{dz}\\right|_{z=L} = C_1 = 0$$\nTherefore, for the case of no degradation, the concentration is uniform throughout the biofilm:\n$$S(z) = S_{\\mathrm{ext}}$$\n\nWith the concentration profile $S(z)$ determined, we can compute the survival fraction $F(T)$. The formula is given as the ratio of two integrals:\n$$F(T) = \\frac{\\int_0^L \\rho(z)\\,e^{-k(S(z))\\,T}\\,dz}{\\int_0^L \\rho(z)\\,dz}$$\nwhere the initial cell density is $\\rho(z) = \\exp(-\\beta z)$ and the kill rate is $k(S) = k_{\\max}\\,\\frac{S}{K_S + S}$.\n\nThe denominator, representing the total initial cell mass, can be calculated analytically:\n$$I_{\\text{den}} = \\int_0^L \\exp(-\\beta z) dz$$\nIf $\\beta \\neq 0$:\n$$I_{\\text{den}} = \\left[-\\frac{1}{\\beta}\\exp(-\\beta z)\\right]_0^L = \\frac{1 - \\exp(-\\beta L)}{\\beta}$$\nIf $\\beta = 0$, the density $\\rho(z)=1$ is uniform, and the integral is simply:\n$$I_{\\text{den}} = \\int_0^L 1 dz = L$$\n\nThe numerator integral is:\n$$I_{\\text{num}} = \\int_0^L \\exp(-\\beta z) \\exp\\left(-T \\cdot k_{\\max} \\frac{S(z)}{K_S + S(z)}\\right) dz$$\nwhere $S(z)$ is the profile derived earlier. This integral does not generally have a closed-form analytical solution due to the complex form of the integrand. Therefore, it will be computed using numerical quadrature.\n\nThe complete algorithm for each test case is as follows:\n1.  Given the parameters $(L, D, k_{\\mathrm{deg}}, S_{\\mathrm{ext}}, k_{\\max}, K_S, T, \\beta)$, determine the functional form of $S(z)$ based on whether $k_{\\mathrm{deg}}$ is zero or positive.\n2.  Calculate the denominator integral $I_{\\text{den}}$ analytically, handling the cases $\\beta=0$ and $\\beta \\neq 0$ separately.\n3.  Define the integrand for the numerator, $f_{\\text{num}}(z) = \\exp(-\\beta z) \\exp(-T k(S(z)))$.\n4.  Numerically evaluate the numerator integral $I_{\\text{num}} = \\int_0^L f_{\\text{num}}(z) dz$ using a standard numerical integration routine like `scipy.integrate.quad`.\n5.  Compute the survival fraction $F(T) = I_{\\text{num}} / I_{\\text{den}}$.\n\nThis procedure is implemented for each provided set of parameters to generate the final results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to run the biofilm survival simulation for all test cases.\n    \"\"\"\n    # Test suite (L, D, k_deg, S_ext, k_max, K_S, T, beta)\n    test_cases = [\n        # Case 1 (happy path)\n        (1.0e-4, 5.0e-10, 1.0e-3, 8.0, 1.2e-3, 1.5, 7200, 1.0e4),\n        # Case 2 (boundary: very thin biofilm, uniform density)\n        (1.0e-6, 5.0e-10, 1.0e-3, 8.0, 1.2e-3, 1.5, 7200, 0.0),\n        # Case 3 (boundary: no degradation, uniform S)\n        (2.0e-4, 4.0e-10, 0.0, 6.0, 2.0e-3, 2.0, 3600, 5.0e3),\n        # Case 4 (edge: strong degradation and deep-weighted cells)\n        (2.0e-4, 3.0e-10, 5.0e-2, 10.0, 1.5e-3, 1.0, 5400, -5.0e3),\n        # Case 5 (edge: low antibiotic exposure)\n        (1.5e-4, 6.0e-10, 2.0e-3, 0.1, 2.0e-3, 5.0, 1800, 0.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        survival_fraction = calculate_survival_fraction(*params)\n        results.append(f\"{survival_fraction:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_survival_fraction(L, D, k_deg, S_ext, k_max, K_S, T, beta):\n    \"\"\"\n    Calculates the bacterial survival fraction in a biofilm.\n\n    Args:\n        L (float): Biofilm thickness (m).\n        D (float): Diffusion coefficient (m^2/s).\n        k_deg (float): Antibiotic degradation rate (s^-1).\n        S_ext (float): External antibiotic concentration (μg/mL).\n        k_max (float): Maximum kill rate (s^-1).\n        K_S (float): Half-saturation concentration for killing (μg/mL).\n        T (float): Exposure time (s).\n        beta (float): Parameter for cell density profile (m^-1).\n\n    Returns:\n        float: The unitless survival fraction F(T).\n    \"\"\"\n\n    # 1. Define the antibiotic concentration profile function S(z)\n    if k_deg > 0:\n        # Case with antibiotic degradation\n        lam = np.sqrt(k_deg / D)\n        cosh_lam_L = np.cosh(lam * L)\n        def S(z):\n            return S_ext * np.cosh(lam * (L - z)) / cosh_lam_L\n    else:  # k_deg == 0\n        # Case with no degradation, concentration is uniform\n        def S(z):\n            # The function must accept z, even if unused, for quad compatibility.\n            return S_ext * np.ones_like(z) if isinstance(z, np.ndarray) else S_ext\n\n    # 2. Define the pharmacodynamic kill rate function k(S)\n    def k(s_val):\n        return k_max * s_val / (K_S + s_val)\n\n    # 3. Define the integrand for the numerator of F(T)\n    def numerator_integrand(z):\n        s_z = S(z)\n        kill_rate = k(s_z)\n        # Factor for cell density profile\n        density_factor = np.exp(-beta * z)\n        # Factor for cell survival at depth z\n        survival_factor = np.exp(-kill_rate * T)\n        return density_factor * survival_factor\n\n    # 4. Compute the numerator integral I_num numerically\n    # We use quad from scipy for robust numerical integration.\n    I_num, _ = quad(numerator_integrand, 0, L, epsabs=1.49e-12, epsrel=1.49e-12)\n\n    # 5. Compute the denominator integral I_den analytically\n    # This represents the total initial number of cells, weighted.\n    if beta == 0:\n        # Uniform density profile\n        I_den = L\n    else:\n        # Exponential density profile\n        I_den = (1.0 - np.exp(-beta * L)) / beta\n    \n    # Check for non-physical cases like L=0 leading to I_den=0\n    if I_den == 0:\n        # For a biofilm of zero thickness, the concept of survival fraction\n        # is ill-defined. The problem constraints (L>0) prevent this.\n        # If it were to happen, the total number of cells is zero.\n        return 0.0\n\n    # 6. Calculate the final survival fraction\n    survival_fraction = I_num / I_den\n    return survival_fraction\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2763767"}, {"introduction": "Moving from analyzing natural biofilm properties to engineering new ones, this practice explores the dynamic control of cellular function. We will simulate how an external periodic signal, such as light in an optogenetic system, can entrain a synthetic gene oscillator across a biofilm population. This exercise [@problem_id:2763789] provides a hands-on introduction to the powerful framework of phase reduction, allowing you to model complex oscillatory dynamics with a simple yet predictive scalar equation and determine the conditions for successful frequency locking.", "problem": "You are modeling a spatially homogeneous patch of a bacterial biofilm hosting a synthetic gene expression oscillator whose dynamics can be approximated by a stable limit cycle in the absence of external inputs. The biofilm is illuminated by an optogenetic light program, modeled as a periodic stimulus with a prescribed angular frequency and amplitude. You will analyze entrainment of the oscillator by the periodic light and determine whether each tested condition lies within the one-to-one Arnold tongue in frequency-amplitude space.\n\nFundamental bases to be used include: the Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein), the existence of a stable limit cycle for a sustained biochemical oscillator, the concept of a phase variable for limit cycle dynamics, and first-order phase reduction for weak periodic forcing using a phase response curve. Assume weak forcing and a Type I phase response curve (PRC) dominated by its first Fourier harmonic, such that the reduced forcing term is sinusoidal in the phase difference at leading order. Angles must be in radians, time in hours, and angular frequencies in radians per hour. Your program must numerically integrate a reduced, first-order, scalar phase model derived from these bases to detect one-to-one entrainment under periodic forcing. Specifically, implement a time-domain simulation that evolves the oscillator phase under periodic forcing, discards an initial transient, and then computes the long-time average angular frequency of the oscillator to test if it matches the forcing angular frequency within a given numerical tolerance.\n\nMathematically, you must proceed from the assumption of a stable limit cycle oscillator with natural angular frequency $\\,\\omega_0\\,$ and a weak periodic input with forcing angular frequency $\\,\\Omega\\,$ and amplitude $\\,\\varepsilon\\,$. Use first-order phase reduction with a Type I phase response curve approximated by its leading sinusoidal harmonic to obtain a scalar phase evolution law driven by the periodic input. Then integrate this scalar phase model in continuous time using a fixed time step $\\,\\Delta t\\,$. After a transient of duration $\\,T_{\\mathrm{trans}}\\,$, estimate the long-time average angular frequency of the oscillator by a finite difference quotient over a window of length $\\,T_{\\mathrm{avg}}\\,$, and declare one-to-one entrainment if the absolute difference between the estimated average angular frequency and the forcing angular frequency is less than or equal to a specified tolerance $\\,\\delta\\,$. You must use angles in radians and report a boolean for each test case indicating whether entrainment is detected.\n\nNumerical requirements:\n- Use a total simulation time $\\,T_{\\mathrm{total}} = 200\\,$ hours, with a fixed time step $\\,\\Delta t = 0.005\\,$ hours.\n- Use a transient duration $\\,T_{\\mathrm{trans}} = 100\\,$ hours and an averaging window of length $\\,T_{\\mathrm{avg}} = T_{\\mathrm{total}} - T_{\\mathrm{trans}} = 100\\,$ hours.\n- Use a locking tolerance $\\,\\delta = 0.01\\,$ radians per hour for determining whether the oscillator is entrained in a one-to-one manner to the input.\n- Initialize the oscillator phase at $\\,\\theta(0) = 0\\,$ radians.\n\nAngle unit: radians. Time unit: hours. Angular frequencies must be in radians per hour.\n\nTest suite:\nFor each case, parameters are ordered as the tuple $\\,(\\omega_0,\\ \\Omega,\\ \\varepsilon)\\,$.\n\n- Case $\\,1\\,$: $\\,\\omega_0 = 6.283185307179586\\,$, $\\,\\Omega = 6.283185307179586\\,$, $\\,\\varepsilon = 0.1\\,$.\n- Case $\\,2\\,$: $\\,\\omega_0 = 6.283185307179586\\,$, $\\,\\Omega = 5.5\\,$, $\\,\\varepsilon = 0.5\\,$.\n- Case $\\,3\\,$: $\\,\\omega_0 = 6.283185307179586\\,$, $\\,\\Omega = 5.9\\,$, $\\,\\varepsilon = 0.5\\,$.\n- Case $\\,4\\,$: $\\,\\omega_0 = 6.283185307179586\\,$, $\\,\\Omega = 6.073185307179586\\,$, $\\,\\varepsilon = 0.2\\,$.\n- Case $\\,5\\,$: $\\,\\omega_0 = 6.283185307179586\\,$, $\\,\\Omega = 7.0\\,$, $\\,\\varepsilon = 1.0\\,$.\n- Case $\\,6\\,$: $\\,\\omega_0 = 6.283185307179586\\,$, $\\,\\Omega = 6.0\\,$, $\\,\\varepsilon = 0.0\\,$.\n\nYour program must:\n- Implement the reduced scalar phase model derived from the fundamental bases described above.\n- For each test case, simulate the model, compute the long-time average angular frequency over the averaging window, compare it to the forcing angular frequency with tolerance $\\,\\delta\\,$, and record a boolean indicating one-to-one entrainment.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above. For example, an output of the form $\\,[$True,False,True$]\\,$ is acceptable.\n\nThe required final output format is exactly one line:\n- A single Python list literal containing $\\,6\\,$ booleans corresponding to the $\\,6\\,$ cases, e.g., $\\,[$True,False,True,False,True,False$]\\,$. No extra whitespace or text is permitted.", "solution": "We consider a synthetic gene expression oscillator embedded in a bacterial biofilm. In the absence of external input, assume the oscillator converges to a stable limit cycle with angular frequency $\\,\\omega_0\\,$. Under weak, periodic optogenetic forcing, the system can be reduced to a scalar phase description at first order using phase reduction. The fundamental basis is that near a stable limit cycle, the state of the oscillator can be parameterized by a phase $\\,\\theta \\in [0,2\\pi)\\,$ whose dynamics obey $\\,\\dot{\\theta} = \\omega_0\\,$ when unforced. Under a weak input $\\,u(t)\\,$, the leading-order effect on the phase is $\\,\\dot{\\theta} = \\omega_0 + \\varepsilon Z(\\theta) u(t)\\,$, where $\\,Z(\\theta)\\,$ is the infinitesimal phase response curve (PRC), $\\,\\varepsilon\\,$ scales the input strength, and $\\,u(t)\\,$ is the time-varying stimulus. This is a well-tested and widely used formula in the theory of weakly forced oscillators derived from linearization along isochrons.\n\nAssume a Type I PRC dominated by its fundamental Fourier component, so that $\\,Z(\\theta)\\,$ can be approximated by a sinusoid at leading order. Let the light stimulus be periodic with angular frequency $\\,\\Omega\\,$; for definiteness, take $\\,u(t) = \\sin(\\Omega t)\\,$ with amplitude absorbed into $\\,\\varepsilon\\,$. With the PRC approximation and by averaging or harmonic balance at leading order, the phase dynamics can be reduced to a phase-difference form where only the relative phase between the oscillator and the drive matters. A standard and well-supported reduced model in this setting is\n$$\n\\dot{\\theta} = \\omega_0 + \\varepsilon \\,\\sin(\\Omega t - \\theta),\n$$\nwhich is obtained by taking the first harmonic of the interaction function between the PRC and the sinusoidal input. Define the phase difference $\\,\\phi = \\theta - \\Omega t\\,$. Differentiating gives\n$$\n\\dot{\\phi} = \\dot{\\theta} - \\Omega = \\omega_0 - \\Omega - \\varepsilon \\sin(\\phi) = \\Delta - \\varepsilon \\sin(\\phi),\n$$\nwhere $\\,\\Delta = \\omega_0 - \\Omega\\,$ is the detuning. Fixed points of $\\,\\dot{\\phi}\\,$ satisfy $\\,0 = \\Delta - \\varepsilon \\sin(\\phi^\\ast)\\,$, which exist if and only if $\\,|\\Delta| \\le \\varepsilon\\,$. When a fixed point exists and is stable, $\\,\\phi(t)\\,$ converges to $\\,\\phi^\\ast\\,$, and the oscillator is one-to-one phase-locked (entrained), with long-time average angular frequency equal to the drive, that is $\\,\\langle \\dot{\\theta} \\rangle = \\Omega\\,$. The set $\\,\\{(\\Omega,\\varepsilon): |\\omega_0 - \\Omega| \\le \\varepsilon\\}\\,$ defines a classical one-to-one Arnold tongue.\n\nAlgorithmic design:\n- We simulate the reduced scalar phase model $\\,\\dot{\\theta} = \\omega_0 + \\varepsilon \\sin(\\Omega t - \\theta)\\,$ in continuous time to remain faithful to the first-principles derivation without invoking the explicit fixed-point criterion as a shortcut. We integrate with a fixed time step $\\,\\Delta t\\,$ using a fourth-order Runge–Kutta scheme for accuracy.\n- Numerical parameters: total simulation time $\\,T_{\\mathrm{total}} = 200\\,$ hours, time step $\\,\\Delta t = 0.005\\,$ hours, transient duration $\\,T_{\\mathrm{trans}} = 100\\,$ hours, averaging window $\\,T_{\\mathrm{avg}} = 100\\,$ hours. Initial phase $\\,\\theta(0) = 0\\,$ radians.\n- For each test case with parameters $\\,(\\omega_0,\\Omega,\\varepsilon)\\,$, we integrate $\\,\\theta(t)\\,$ over $\\,t \\in [0,T_{\\mathrm{total}}]\\,$. To estimate the long-time average angular frequency, we compute\n$$\n\\hat{\\omega} = \\frac{\\theta(T_{\\mathrm{total}}) - \\theta(T_{\\mathrm{trans}})}{T_{\\mathrm{total}} - T_{\\mathrm{trans}}}.\n$$\n- We declare entrainment if $\\,|\\hat{\\omega} - \\Omega| \\le \\delta\\,$ with $\\,\\delta = 0.01\\,$ radians per hour. This condition detects one-to-one frequency locking.\n- This approach inherently respects the requirement that angles are in radians and times are in hours.\n\nExpected qualitative outcomes for the test suite:\n- Case $\\,1\\,$: Zero detuning with nonzero forcing, entrained (boolean True).\n- Case $\\,2\\,$: Detuning magnitude approximately $\\,0.783185\\,$ greater than amplitude $\\,0.5\\,$, outside the Arnold tongue, not entrained (boolean False).\n- Case $\\,3\\,$: Detuning magnitude approximately $\\,0.383185\\,$ less than amplitude $\\,0.5\\,$, inside the Arnold tongue, entrained (boolean True).\n- Case $\\,4\\,$: Detuning magnitude approximately $\\,0.21\\,$ greater than amplitude $\\,0.2\\,$, outside the Arnold tongue, not entrained (boolean False).\n- Case $\\,5\\,$: Detuning magnitude approximately $\\,0.716815\\,$ less than amplitude $\\,1.0\\,$, inside the Arnold tongue, entrained (boolean True).\n- Case $\\,6\\,$: Zero forcing with nonzero detuning, no entrainment (boolean False).\n\nThe final program implements the integration and produces a single-line list of booleans in the specified order.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rk4_step(theta, t, dt, omega0, Omega, eps):\n    # dtheta/dt = omega0 + eps * sin(Omega * t - theta)\n    def f(th, time):\n        return omega0 + eps * np.sin(Omega * time - th)\n    k1 = f(theta, t)\n    k2 = f(theta + 0.5 * dt * k1, t + 0.5 * dt)\n    k3 = f(theta + 0.5 * dt * k2, t + 0.5 * dt)\n    k4 = f(theta + dt * k3, t + dt)\n    return theta + (dt / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\ndef simulate_and_check_lock(omega0, Omega, eps,\n                            T_total=200.0, dt=0.005,\n                            T_trans=100.0, tol=0.01):\n    steps = int(np.round(T_total / dt))\n    trans_steps = int(np.round(T_trans / dt))\n    t = 0.0\n    theta = 0.0\n    # Integrate\n    for i in range(steps):\n        theta = rk4_step(theta, t, dt, omega0, Omega, eps)\n        t += dt\n        # Keep theta from overflowing to maintain numerical stability\n        # but preserve monotonicity (unwrap); no modulo.\n        # No special action needed; theta can grow.\n        pass\n    # Re-simulate to get theta at T_trans and T_total without storing the entire trajectory\n    t = 0.0\n    theta_trans = 0.0\n    for i in range(trans_steps):\n        theta_trans = rk4_step(theta_trans, t, dt, omega0, Omega, eps)\n        t += dt\n    # theta at T_total already computed as 'theta'\n    avg_omega = (theta - theta_trans) / (T_total - T_trans)\n    return abs(avg_omega - Omega) = tol\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (omega0, Omega, epsilon)\n    test_cases = [\n        (6.283185307179586, 6.283185307179586, 0.1),   # Case 1\n        (6.283185307179586, 5.5,                0.5),  # Case 2\n        (6.283185307179586, 5.9,                0.5),  # Case 3\n        (6.283185307179586, 6.073185307179586,  0.2),  # Case 4\n        (6.283185307179586, 7.0,                1.0),  # Case 5\n        (6.283185307179586, 6.0,                0.0),  # Case 6\n    ]\n\n    # Numerical parameters (must match the problem statement)\n    T_total = 200.0\n    dt = 0.005\n    T_trans = 100.0\n    tol = 0.01\n\n    results = []\n    for omega0, Omega, eps in test_cases:\n        locked = simulate_and_check_lock(omega0, Omega, eps,\n                                         T_total=T_total, dt=dt,\n                                         T_trans=T_trans, tol=tol)\n        results.append(locked)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2763789"}, {"introduction": "Engineered biological systems are subject to evolutionary pressures, a reality that synthetic biologists must confront to ensure the long-term stability of their designs. This advanced practice challenges you to model an eco-evolutionary race: the emergence and spread of phage-resistant bacteria at a biofilm's expanding frontier. By synthesizing principles from reaction-diffusion theory, population genetics, and stochastic processes [@problem_id:2763812], you will predict the probability of evolutionary rescue and appreciate how spatial structure critically shapes the fate of new mutations.", "problem": "Consider a one-dimensional abstraction of a bacterial biofilm leading edge interacting with lytic bacteriophage, modeled as a stepping-stone array of local neighborhoods (demes) coupled by short-range migration. You will formalize conditions under which a genetically resistant bacterial lineage evolves and persists at the front despite phage predation, by balancing mutation supply against the impeded selective sweeps caused by limited mixing. Use only fundamental transport and population-process principles as your starting point: linear diffusion, linearized growth at low density, and the classical birth–death branching process. Do not assume any shortcut formula beyond these foundational bases.\n\nDefinitions and assumptions:\n- The biofilm edge is approximated as a one-dimensional medium. Bacterial resistant cells and phage disperse as diffusive processes with effective diffusion coefficients set by nearest-neighbor migration rates between demes.\n- Let $r$ denote the per-capita bacterial division rate at the leading edge, measured in $\\mathrm{h}^{-1}$. Let $c$ denote the fractional cost of resistance such that the resistant birth rate is $r(1-c)$.\n- Let $\\mu$ denote the per-division mutation rate to resistance (dimensionless per division), and $K$ denote the effective number of bacteria per deme that participate in growth at the leading edge (cells).\n- Let $m$ denote the bacterial between-deme migration rate (in demes$^2$ per hour), which sets the bacterial effective diffusion coefficient. Let $m_P$ denote the phage between-deme migration rate (in demes$^2$ per hour), which sets the phage effective diffusion coefficient. Let $\\alpha$ denote the phage net per-capita Malthusian growth parameter when rare on a susceptible background near the front (in $\\mathrm{h}^{-1}$).\n- Let $k$ denote the effective per-capita killing pressure exerted by phage on susceptible bacteria near the front (in $\\mathrm{h}^{-1}$). The resistant lineage has an effective selective advantage against the susceptible background given by $s_{\\mathrm{eff}} = k - rc$.\n- Limited mixing at the biofilm edge causes mechanical loss of mutant lineages from the tip at a rate proportional to the bacterial migration rate. Model this as a loss rate $d_R = \\gamma m$ (in $\\mathrm{h}^{-1}$), where $\\gamma$ is a dimensionless proportionality constant supplied as a parameter.\n- The initial distance between the phage invasion origin and the biofilm leading edge is $L_0$ (in demes). The resistant wave and the phage wave each propagate as pulled reaction–diffusion fronts determined by linear diffusion and linearized growth at low density. The bacterial growth-layer correlation length is set by the diffusion–growth balance at the edge.\n\nTasks to be derived from first principles and implemented:\n1. Derive the wave propagation speed for a pulled reaction–diffusion front from the linear diffusion equation with linearized growth at low density. Use this to express the resistant-front speed $v_R$ in demes per hour in terms of the bacterial diffusion coefficient and the resistant Malthusian growth rate, and the phage-front speed $v_P$ in terms of the phage diffusion coefficient and phage Malthusian growth rate.\n2. From diffusion–growth balance, derive a characteristic growth-layer correlation length $L_g$ (in demes) at the front from the bacterial diffusion coefficient and the growth rate $r$.\n3. Using the per-division mutation rate $\\,\\mu\\,$, the division rate $\\,r\\,$ and the effective number of cells in the growth layer $\\,N_{\\mathrm{eff}} = K L_g\\,$, derive the mutation supply rate $\\,U\\,$ (in $\\mathrm{h}^{-1}$) at the front.\n4. Using the classical continuous-time birth–death branching process with birth rate $b_R = r(1-c)$ and loss (death) rate $d_R = \\gamma m$ for a nascent resistant lineage at the front, derive the establishment probability $p_{\\mathrm{est}}$ for a single resistant mutant. If $b_R \\le d_R$, then $p_{\\mathrm{est}}=0$; otherwise $p_{\\mathrm{est}} = 1 - d_R/b_R$.\n5. The time available before the phage front reaches the leading edge is $T_{\\mathrm{avail}}$, determined by the initial separation $L_0$ and the phage wave speed. The expected number of established resistant lineages that arise before phage arrival is $\\Lambda = U\\,p_{\\mathrm{est}}\\,T_{\\mathrm{avail}}$. Assuming a Poisson arrival of established lineages, the probability that at least one resistant lineage establishes before phage arrival is $P = 1 - e^{-\\Lambda}$.\n6. Evolutionary success additionally requires that the resistant front outruns the phage front and that resistance is actually advantageous in the phage-exposed environment. Impose the conditions $v_R  v_P$ and $s_{\\mathrm{eff}}  0$. If either condition fails, set $P=0$.\n\nComputation requirements:\n- For each test case, compute the probability $P$ as a decimal in $[0,1]$ using the derivation above. All intermediate constructs must be grounded in the stated fundamental principles.\n- Physical units: rates must be used in $\\mathrm{h}^{-1}$, distances in demes, and probabilities must be output as unitless decimals.\n- Final output format: Your program should produce a single line containing a comma-separated list of the four probabilities, rounded to six decimal places and enclosed in square brackets, for example: $[0.123456,0.000001,0.314159,1.000000]$.\n\nTest suite:\nProvide code that computes $P$ for the following four parameter sets, each given as the ordered tuple $(r,c,m,\\mu,K,\\gamma,k,m_P,\\alpha,L_0)$ with units as defined above.\n\n- Case A (happy path: sufficient mutation supply and resistant wave faster than phage): $(1.0,\\;0.05,\\;0.5,\\;1.0\\times 10^{-7},\\;100000,\\;0.2,\\;0.2,\\;0.2,\\;0.2,\\;50)$.\n- Case B (boundary where phage wave outruns resistant wave, forcing failure): $(0.6,\\;0.10,\\;0.2,\\;1.0\\times 10^{-6},\\;100000,\\;0.1,\\;0.2,\\;0.6,\\;0.6,\\;20)$.\n- Case C (very low mutation supply despite favorable wave race): $(1.0,\\;0.05,\\;0.5,\\;1.0\\times 10^{-10},\\;100000,\\;0.2,\\;0.2,\\;0.2,\\;0.2,\\;50)$.\n- Case D (limited mixing causes high loss from the front so establishment fails): $(1.0,\\;0.05,\\;10.0,\\;1.0\\times 10^{-7},\\;100000,\\;0.2,\\;0.2,\\;0.2,\\;0.2,\\;50)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases above, rounded to six decimal places.", "solution": "The problem posed is a valid exercise in theoretical biology, requiring the synthesis of principles from reaction-diffusion theory, population genetics, and stochastic processes. It is self-contained, scientifically grounded, and well-posed. We shall proceed with the derivation as specified.\n\nThe validation steps confirm the problem's integrity.\n**Givens:**\n- Per-capita bacterial division rate: $r$ ($\\mathrm{h}^{-1}$)\n- Fractional cost of resistance: $c$ (dimensionless)\n- Resistant birth rate: $r(1-c)$ ($\\mathrm{h}^{-1}$)\n- Per-division mutation rate to resistance: $\\mu$ (dimensionless)\n- Effective number of bacteria per deme: $K$ (cells)\n- Bacterial between-deme migration rate (diffusion coefficient): $m$ (demes$^2/\\mathrm{h}$)\n- Phage between-deme migration rate (diffusion coefficient): $m_P$ (demes$^2/\\mathrm{h}$)\n- Phage net per-capita Malthusian growth parameter: $\\alpha$ ($\\mathrm{h}^{-1}$)\n- Phage per-capita killing pressure on susceptible bacteria: $k$ ($\\mathrm{h}^{-1}$)\n- Effective selective advantage of resistance: $S_{\\mathrm{eff}} = k - rc$ ($\\mathrm{h}^{-1}$)\n- Loss rate of mutant lineages from the tip: $d_R = \\gamma m$ ($\\mathrm{h}^{-1}$)\n- Dimensionless proportionality constant for loss: $\\gamma$\n- Initial phage-biofilm distance: $L_0$ (demes)\n- Wave propagation model: Pulled reaction-diffusion fronts.\n- Bacterial growth-layer correlation length: $L_g$, derived from diffusion-growth balance.\n- Effective number of cells in growth layer: $N_{\\mathrm{eff}} = K L_g$.\n\n**Verdict:** The problem is scientifically sound, objective, and provides a complete, consistent set of definitions and parameters to derive a unique solution. It is a valid problem.\n\nWe now derive the required quantities from first principles.\n\n**1. Wave Propagation Speed ($v_R, v_P$)**\n\nA pulled reaction-diffusion front is governed by the dynamics at the leading edge where the population density is low. The general one-dimensional reaction-diffusion equation is:\n$$\n\\frac{\\partial N}{\\partial t} = D \\frac{\\partial^2 N}{\\partial x^2} + f(N)\n$$\nwhere $N(x,t)$ is the population density, $D$ is the diffusion coefficient, and $f(N)$ is the reaction (growth) term. At low density ($N \\to 0$), the growth term can be linearized: $f(N) \\approx r_{\\mathrm{eff}} N$, where $r_{\\mathrm{eff}}$ is the Malthusian growth rate. The equation becomes:\n$$\n\\frac{\\partial N}{\\partial t} = D \\frac{\\partial^2 N}{\\partial x^2} + r_{\\mathrm{eff}} N\n$$\nThis is the Fisher-Kolmogorov-Petrovsky-Piskunov (FKPP) equation in its linear form. We seek a traveling wave solution of the form $N(x,t) = g(x-vt)$, where $v$ is the wave speed. Substituting this into the PDE yields an ordinary differential equation for $g(z)$ with $z = x-vt$:\n$$\nD g''(z) + v g'(z) + r_{\\mathrm{eff}} g(z) = 0\n$$\nAn ansatz for the decaying tail of the wave is $g(z) \\propto e^{-\\lambda z}$ for some $\\lambda  0$. Substitution provides the characteristic equation:\n$$\nD \\lambda^2 - v \\lambda + r_{\\mathrm{eff}} = 0\n$$\nFor a real, positive $\\lambda$, the discriminant must be non-negative: $v^2 - 4 D r_{\\mathrm{eff}} \\ge 0$. This implies a minimum possible speed, which is the one selected by a pulled front:\n$$\nv_{\\mathrm{min}} = \\sqrt{4 D r_{\\mathrm{eff}}} = 2 \\sqrt{D r_{\\mathrm{eff}}}\n$$\nApplying this to the resistant bacterial front: the diffusion coefficient is $D \\equiv m$, and the Malthusian growth rate is $r_{\\mathrm{eff}} = r(1-c)$. Thus, the resistant front speed $v_R$ is:\n$$\nv_R = 2 \\sqrt{m r(1-c)}\n$$\nApplying this to the phage front: the diffusion coefficient is $D \\equiv m_P$, and the Malthusian growth rate is given as $\\alpha$. Thus, the phage front speed $v_P$ is:\n$$\nv_P = 2 \\sqrt{m_P \\alpha}\n$$\n\n**2. Characteristic Correlation Length ($L_g$)**\n\nThe characteristic length scale of the growth layer, $L_g$, is where the effects of diffusion and growth are balanced. The characteristic timescale for diffusion to act over a length $L$ is $\\tau_{\\mathrm{diff}} \\approx L^2/D$. The characteristic timescale for exponential growth is $\\tau_{\\mathrm{growth}} \\approx 1/r_{\\mathrm{eff}}$. Equating these timescales, $\\tau_{\\mathrm{diff}} = \\tau_{\\mathrm{growth}}$, gives:\n$$\n\\frac{L_g^2}{D} = \\frac{1}{r_{\\mathrm{eff}}} \\implies L_g = \\sqrt{\\frac{D}{r_{\\mathrm{eff}}}}\n$$\nFor the bacterial front, the diffusion coefficient is $D=m$ and the relevant growth rate is $r$. Therefore, the growth-layer correlation length is:\n$$\nL_g = \\sqrt{\\frac{m}{r}}\n$$\n\n**3. Mutation Supply Rate ($U$)**\n\nThe mutation supply rate, $U$, is the total number of new resistant mutants appearing per unit time across the entire growth layer.\nThe effective number of cells in the growth layer is $N_{\\mathrm{eff}} = K L_g$, where $K$ is the density per deme and $L_g$ is the length of the layer in demes.\nEach of these $N_{\\mathrm{eff}}$ cells divides at a rate $r$ (divisions per cell per hour).\nThe total number of divisions per hour in the growth layer is $N_{\\mathrm{eff}} \\times r$.\nThe mutation rate is $\\mu$ per division.\nTherefore, the rate of new mutants appearing is:\n$$\nU = (\\text{total cells}) \\times (\\text{division rate}) \\times (\\text{mutation rate}) = N_{\\mathrm{eff}} \\cdot r \\cdot \\mu = (K L_g) \\cdot r \\cdot \\mu\n$$\nSubstituting the expression for $L_g$:\n$$\nU = K \\left(\\sqrt{\\frac{m}{r}}\\right) r \\mu = K \\mu \\sqrt{m r}\n$$\n\n**4. Establishment Probability ($p_{\\mathrm{est}}$)**\n\nThe fate of a single mutant lineage is modeled as a continuous-time birth-death process. The birth rate for the resistant lineage is $b_R = r(1-c)$. The death rate, representing stochastic loss and mechanical removal from the front, is $d_R = \\gamma m$.\nThe probability of eventual extinction of a lineage starting with a single individual is $q_{\\mathrm{ext}}$. For a continuous-time birth-death process, this probability is given by $1$ if the birth rate is less than or equal to the death rate ($b_R \\le d_R$), and $d_R/b_R$ if the birth rate exceeds the death rate ($b_R  d_R$).\nThe probability of establishment, $p_{\\mathrm{est}}$, is the complement of the extinction probability, $p_{\\mathrm{est}} = 1 - q_{\\mathrm{ext}}$.\nTherefore:\n- If $b_R \\le d_R$, then $p_{\\mathrm{est}} = 0$.\n- If $b_R  d_R$, then $p_{\\mathrm{est}} = 1 - \\frac{d_R}{b_R}$.\nSubstituting the defined rates:\n$$\np_{\\mathrm{est}} = \\begin{cases}\n0  \\text{if } r(1-c) \\le \\gamma m \\\\\n1 - \\frac{\\gamma m}{r(1-c)}  \\text{if } r(1-c)  \\gamma m\n\\end{cases}\n$$\n\n**5. Total Probability of Establishment Before Phage Arrival ($P$)**\n\nThe phage front is initially at a distance $L_0$ and travels at speed $v_P$. The time available for a resistant lineage to arise and establish is:\n$$\nT_{\\mathrm{avail}} = \\frac{L_0}{v_P}\n$$\nEstablished mutants arise at a mean rate of $U \\cdot p_{\\mathrm{est}}$ (events per hour). Assuming these events follow a Poisson process, the expected number of established lineages, $\\Lambda$, that appear during the time $T_{\\mathrm{avail}}$ is:\n$$\n\\Lambda = (U \\cdot p_{\\mathrm{est}}) \\cdot T_{\\mathrm{avail}} = U p_{\\mathrm{est}} \\frac{L_0}{v_P}\n$$\nThe probability of observing $n$ events in a Poisson process with mean $\\Lambda$ is $P(n) = e^{-\\Lambda} \\Lambda^n / n!$. The probability of zero established lineages arising is $P(n=0) = e^{-\\Lambda}$.\nThe probability of at least one lineage establishing, $P$, is the complement:\n$$\nP = 1 - P(n=0) = 1 - e^{-\\Lambda}\n$$\n\n**6. Final Conditions for Evolutionary Success**\n\nThe final probability $P$ is subject to two overriding conditions for evolutionary success:\n1.  The resistant front must be able to outrun the phage front: $v_R  v_P$.\n2.  Resistance must confer a net advantage in the presence of phage. The effective selection coefficient must be positive: $s_{\\mathrm{eff}}  0$. The problem defines this as $k - rc  0$.\n\nIf either of these conditions is not met, the evolutionary scenario fails, and the probability of success is $P=0$, regardless of the value calculated from the Poisson process.\n\nThe complete calculation for each test case proceeds by evaluating these derived expressions in sequence and applying the final conditions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the probability of resistant lineage establishment based on the\n    provided model and test cases.\n    \"\"\"\n    \n    # Test cases defined as tuples: (r, c, m, mu, K, gamma, k, m_P, alpha, L_0)\n    test_cases = [\n        # Case A: happy path\n        (1.0, 0.05, 0.5, 1.0e-7, 100000, 0.2, 0.2, 0.2, 0.2, 50),\n        # Case B: phage wave outruns resistant wave\n        (0.6, 0.10, 0.2, 1.0e-6, 100000, 0.1, 0.2, 0.6, 0.6, 20),\n        # Case C: very low mutation supply\n        (1.0, 0.05, 0.5, 1.0e-10, 100000, 0.2, 0.2, 0.2, 0.2, 50),\n        # Case D: high loss from the front prevents establishment\n        (1.0, 0.05, 10.0, 1.0e-7, 100000, 0.2, 0.2, 0.2, 0.2, 50),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        r, c, m, mu, K, gamma, k, m_P, alpha, L_0 = case\n        \n        # --- Begin derivation implementation ---\n\n        # Step 6: Check primary conditions for evolutionary success first.\n        # Condition 1: Resistance must be advantageous.\n        s_eff = k - r * c\n        if s_eff = 0:\n            results.append(0.0)\n            continue\n            \n        # Step 1: Derive wave propagation speeds.\n        # Speed of resistant bacterial front (v_R).\n        # Calculation requires the term under the square root to be non-negative.\n        # r, m are rates/coefficients and are non-negative. 1-c > 0 since c is a small fractional cost.\n        v_R = 2 * np.sqrt(m * r * (1 - c))\n        \n        # Speed of phage front (v_P).\n        # alpha, m_P are Malthusian parameter and diffusion coeff, must be non-negative.\n        if m_P = 0 or alpha = 0:\n            v_P = 0.0\n        else:\n            v_P = 2 * np.sqrt(m_P * alpha)\n        \n        # Condition 2: Resistant front must outrun the phage front.\n        if v_R = v_P:\n            results.append(0.0)\n            continue\n\n        # If v_P is zero, phage front never arrives. T_avail is infinite.\n        # If U*p_est > 0, Lambda is infinite, and P = 1.\n        if v_P == 0:\n            # We proceed to check if U*p_est > 0.\n            # Step 4: Calculate establishment probability.\n            birth_rate_R = r * (1 - c)\n            loss_rate_R = gamma * m\n        \n            if birth_rate_R = loss_rate_R:\n                p_est = 0.0\n            else:\n                p_est = 1 - (loss_rate_R / birth_rate_R)\n            \n            # Step 3: Calculate mutation supply rate.\n            # L_g (correlation length) is needed. L_g = sqrt(m/r).\n            if m  0 or r = 0:\n                 U = 0.0\n            else:\n                 U = K * mu * np.sqrt(m * r)\n            \n            if U > 0 and p_est > 0:\n                results.append(1.0)\n            else:\n                results.append(0.0)\n            continue\n\n        # --- Proceed with main calculation for v_P > 0 ---\n\n        # Step 2: Characteristic correlation length (L_g).\n        # We can skip explicit calculation of L_g, as it's absorbed into the formula for U.\n\n        # Step 3: Mutation supply rate (U).\n        # U = K * mu * sqrt(m*r).\n        if m  0 or r  0:\n             U = 0.0\n        else:\n             U = K * mu * np.sqrt(m * r)\n\n        # Step 4: Establishment probability (p_est).\n        birth_rate_R = r * (1 - c)\n        loss_rate_R = gamma * m\n        \n        if birth_rate_R = loss_rate_R:\n            p_est = 0.0\n        else:\n            p_est = 1 - (loss_rate_R / birth_rate_R)\n        \n        # If either U or p_est is zero, Lambda will be zero, and P will be zero.\n        if U == 0.0 or p_est == 0.0:\n            results.append(0.0)\n            continue\n            \n        # Step 5: Total probability of establishment (P).\n        # Time available before phage arrival.\n        T_avail = L_0 / v_P\n        \n        # Expected number of established lineages.\n        Lambda = U * p_est * T_avail\n        \n        # Probability of at least one establishment.\n        P = 1.0 - np.exp(-Lambda)\n        \n        results.append(P)\n\n    # Format final output as a comma-separated list of probabilities\n    # rounded to six decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2763812"}]}