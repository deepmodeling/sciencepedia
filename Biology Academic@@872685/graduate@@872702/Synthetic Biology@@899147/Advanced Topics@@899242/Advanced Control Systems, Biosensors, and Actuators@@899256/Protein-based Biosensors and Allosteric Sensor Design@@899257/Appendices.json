{"hands_on_practices": [{"introduction": "The Monod-Wyman-Changeux (MWC) model provides a powerful thermodynamic framework for understanding allostery. This first exercise grounds your understanding by tasking you with deriving the core equations for a simple monomeric sensor from first principles [@problem_id:2766590]. By calculating the fraction of protein in the active state and the overall ligand occupancy, you will build a quantitative intuition for how a ligand shifts the conformational equilibrium of a protein.", "problem": "A monomeric allosteric transcription factor used as a protein-based biosensor interconverts between a low-activity tense state and a high-activity relaxed state as defined by the Monod–Wyman–Changeux (MWC) two-state model (Monod–Wyman–Changeux (MWC)). In the absence of ligand, the equilibrium constant between the tense state and the relaxed state is $L_{0} \\equiv [T]/[R]$. A ligand of interest binds to both conformations according to the law of mass action with dissociation constants $K_{T}$ for the tense state and $K_{R}$ for the relaxed state, where $K_{R}  K_{T}$. Assume a single ligand-binding site per protein molecule, ideal solution behavior, and thermodynamic equilibrium.\n\nStarting only from the definitions of the equilibrium constant $L_{0}$, the dissociation constants $K_{T}$ and $K_{R}$ (with $K_{d} \\equiv [P][L]/[PL]$ for each conformation), and the enumeration of the microstates of the protein–ligand system, derive appropriate expressions to compute:\n- the fraction of protein molecules in the relaxed state, and\n- the mean ligand occupancy (the ensemble-average fraction of binding sites that are ligand-bound).\n\nUse the following parameter values: $L_{0} = 100$, $K_{T} = 10\\ \\mu\\text{M}$, $K_{R} = 0.1\\ \\mu\\text{M}$, and free ligand concentration $[L] = 1\\ \\mu\\text{M}$. Provide both requested quantities as decimals rounded to $4$ significant figures. The requested quantities are dimensionless; report them without units.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We shall proceed with the derivation based on the fundamental principles of statistical thermodynamics as applied to biochemical systems, according to the Monod–Wyman–Changeux (MWC) model.\n\nThe system consists of a monomeric protein that can exist in four distinct microstates at thermodynamic equilibrium:\n1.  Unbound tense state: $T$\n2.  Unbound relaxed state: $R$\n3.  Ligand-bound tense state: $TL$\n4.  Ligand-bound relaxed state: $RL$\n\nThe concentrations of these species are governed by the equilibria defined in the problem. We select the unbound relaxed state, $R$, as our reference state and express the concentrations of all other states relative to the concentration of $R$, denoted as $[R]$.\n\nFrom the definition of the allosteric equilibrium constant, $L_0 \\equiv [T]/[R]$, the concentration of the unbound tense state is:\n$$\n[T] = L_0 [R]\n$$\n\nFrom the law of mass action for ligand binding to the relaxed state, defined by the dissociation constant $K_R \\equiv [R][L]/[RL]$, the concentration of the ligand-bound relaxed state is:\n$$\n[RL] = \\frac{[R][L]}{K_R}\n$$\n\nSimilarly, for the tense state, the dissociation constant is $K_T \\equiv [T][L]/[TL]$. The concentration of the ligand-bound tense state is:\n$$\n[TL] = \\frac{[T][L]}{K_T}\n$$\nSubstituting the expression for $[T]$, we have:\n$$\n[TL] = \\frac{(L_0 [R])[L]}{K_T} = \\frac{L_0 [L]}{K_T} [R]\n$$\n\nThe total concentration of protein, $[P]_{\\text{total}}$, is the sum of the concentrations of all four microstates:\n$$\n[P]_{\\text{total}} = [R] + [T] + [RL] + [TL]\n$$\nSubstituting the expressions derived above, we can write the total protein concentration in terms of $[R]$:\n$$\n[P]_{\\text{total}} = [R] + L_0 [R] + \\frac{[R][L]}{K_R} + \\frac{L_0 [L]}{K_T} [R]\n$$\nFactoring out $[R]$ yields the partition function of the system, multiplied by $[R]$:\n$$\n[P]_{\\text{total}} = [R] \\left( 1 + L_0 + \\frac{[L]}{K_R} + \\frac{L_0 [L]}{K_T} \\right)\n$$\n\nWe are now equipped to derive the two requested quantities.\n\nFirst, we compute the fraction of protein molecules in the relaxed state, which we will denote as $f_R$. This fraction is the ratio of the sum of concentrations of all relaxed species ($R$ and $RL$) to the total protein concentration.\n$$\nf_R = \\frac{[R] + [RL]}{[P]_{\\text{total}}}\n$$\nSubstituting the expressions in terms of $[R]$:\n$$\nf_R = \\frac{[R] + \\frac{[R][L]}{K_R}}{[R] \\left( 1 + L_0 + \\frac{[L]}{K_R} + \\frac{L_0 [L]}{K_T} \\right)}\n$$\nThe term $[R]$ cancels from the numerator and denominator, yielding an expression that depends only on the ligand concentration and the intrinsic equilibrium constants:\n$$\nf_R = \\frac{1 + \\frac{[L]}{K_R}}{1 + L_0 + \\frac{[L]}{K_R} + \\frac{L_0 [L]}{K_T}}\n$$\nThis expression can be rearranged to highlight the contributions of the relaxed and tense state populations:\n$$\nf_R = \\frac{1 + \\frac{[L]}{K_R}}{\\left(1 + \\frac{[L]}{K_R}\\right) + L_0 \\left(1 + \\frac{[L]}{K_T}\\right)}\n$$\n\nSecond, we compute the mean ligand occupancy, $\\langle \\theta \\rangle$. This is the fraction of all protein molecules that are bound to a ligand, which corresponds to the species $RL$ and $TL$.\n$$\n\\langle \\theta \\rangle = \\frac{[RL] + [TL]}{[P]_{\\text{total}}}\n$$\nAgain, we substitute the expressions in terms of $[R]$:\n$$\n\\langle \\theta \\rangle = \\frac{\\frac{[R][L]}{K_R} + \\frac{L_0 [L]}{K_T} [R]}{[R] \\left( 1 + L_0 + \\frac{[L]}{K_R} + \\frac{L_0 [L]}{K_T} \\right)}\n$$\nCanceling $[R]$ gives the final expression for mean occupancy:\n$$\n\\langle \\theta \\rangle = \\frac{\\frac{[L]}{K_R} + \\frac{L_0 [L]}{K_T}}{1 + L_0 + \\frac{[L]}{K_R} + \\frac{L_0 [L]}{K_T}}\n$$\nSimilarly, this can be written as:\n$$\n\\langle \\theta \\rangle = \\frac{\\frac{[L]}{K_R} + L_0 \\frac{[L]}{K_T}}{\\left(1 + \\frac{[L]}{K_R}\\right) + L_0 \\left(1 + \\frac{[L]}{K_T}\\right)}\n$$\n\nNow we substitute the given numerical values into these derived expressions. The parameters are:\n$L_0 = 100$\n$K_T = 10\\ \\mu\\text{M}$\n$K_R = 0.1\\ \\mu\\text{M}$\n$[L] = 1\\ \\mu\\text{M}$\n\nIt is convenient to first compute the dimensionless normalized ligand concentrations:\n$$\n\\frac{[L]}{K_R} = \\frac{1\\ \\mu\\text{M}}{0.1\\ \\mu\\text{M}} = 10\n$$\n$$\n\\frac{[L]}{K_T} = \\frac{1\\ \\mu\\text{M}}{10\\ \\mu\\text{M}} = 0.1\n$$\n\nLet us calculate the common denominator for both fractions, which corresponds to the partition function:\n$$\n\\text{Denominator} = \\left(1 + \\frac{[L]}{K_R}\\right) + L_0 \\left(1 + \\frac{[L]}{K_T}\\right) = (1 + 10) + 100 \\times (1 + 0.1) = 11 + 100 \\times 1.1 = 11 + 110 = 121\n$$\n\nFor the fraction of protein in the relaxed state, $f_R$:\n$$\nf_R = \\frac{1 + \\frac{[L]}{K_R}}{\\text{Denominator}} = \\frac{1 + 10}{121} = \\frac{11}{121} = \\frac{1}{11} \\approx 0.090909...\n$$\nRounding to $4$ significant figures, we get $f_R \\approx 0.09091$.\n\nFor the mean ligand occupancy, $\\langle \\theta \\rangle$:\n$$\n\\langle \\theta \\rangle = \\frac{\\frac{[L]}{K_R} + L_0 \\frac{[L]}{K_T}}{\\text{Denominator}} = \\frac{10 + 100 \\times 0.1}{121} = \\frac{10 + 10}{121} = \\frac{20}{121} \\approx 0.165289...\n$$\nRounding to $4$ significant figures, we get $\\langle \\theta \\rangle \\approx 0.1653$.\n\nThese results are consistent with the MWC model. The large value of $L_0$ ensures the protein is predominantly in the tense state in the absence of ligand. The ligand concentration of $1\\ \\mu\\text{M}$ is $10$ times $K_R$ but only $0.1$ times $K_T$, meaning it binds strongly to the $R$ state, pulling the equilibrium from $T$ towards $R$ and leading to a non-negligible population of the relaxed state ($f_R \\approx 9.1\\%$) and significant ligand binding, which occurs predominantly through the high-affinity $R$ state.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.09091  0.1653\n\\end{pmatrix}\n}\n$$", "id": "2766590"}, {"introduction": "A key goal in biosensor design is to maximize the output signal change in response to a ligand. This practice moves from understanding the MWC model to applying it for design optimization [@problem_id:2766540]. You will derive the theoretical upper limit on a sensor's dynamic range, revealing its direct dependence on the coupling free energy, $\\Delta G_{c}$, and demonstrating how to think about the fundamental performance limits of an allosteric switch.", "problem": "An engineered protein-based biosensor is designed as a two-state allosteric switch between an inactive conformation and an active conformation. The sensor’s output is proportional to the probability of the active conformation. Consider the classical two-state Monod–Wyman–Changeux (MWC) framework, where in the absence of ligand the free energy difference between the active and inactive conformations is an unknown parameter $\\Delta G_{0}$, and at saturating ligand the ligand differentially stabilizes the active conformation by a coupling free energy $\\Delta G_{c}$ relative to the inactive conformation. Assume equilibrium thermodynamics in the canonical ensemble and that conformational state probabilities follow Boltzmann statistics.\n\nDefine the dynamic range as the fold-change in output between saturating ligand and zero ligand, that is, the ratio of the steady-state output at ligand saturation to that at zero ligand. Using only the assumptions above and first principles, derive an analytic expression for the theoretical upper bound on this dynamic range as a function of $\\Delta G_{c}$ and temperature $T$. Then, evaluate this upper bound for a coupling energy budget of $\\Delta G_{c} = -2\\,\\mathrm{kcal/mol}$ at $T = 298\\,\\mathrm{K}$. Use the universal gas constant $R = 1.9872\\times 10^{-3}\\,\\mathrm{kcal\\,mol^{-1}\\,K^{-1}}$. Round your final numerical answer to $3$ significant figures. Express the final dynamic range as a dimensionless number.", "solution": "The problem statement will first be subjected to a rigorous validation procedure before any attempt at a solution is made.\n\n**Step 1: Extraction of Givens**\nThe problem provides the following information:\n- The system is an engineered protein-based biosensor functioning as a two-state allosteric switch (inactive and active conformations).\n- The sensor's output is proportional to the probability of the active conformation.\n- The framework is the classical two-state Monod–Wyman–Changeux (MWC) model.\n- At zero ligand, the free energy difference between the active and inactive conformations is $\\Delta G_{0}$.\n- At saturating ligand, the ligand differentially stabilizes the active conformation by a coupling free energy $\\Delta G_{c}$.\n- Equilibrium thermodynamics in the canonical ensemble is assumed.\n- Conformational state probabilities follow Boltzmann statistics.\n- Dynamic range ($DR$) is defined as the ratio of the steady-state output at ligand saturation to that at zero ligand.\n- The task is to derive an analytic expression for the theoretical upper bound on this dynamic range as a function of $\\Delta G_{c}$ and temperature $T$.\n- The task requires evaluation of this upper bound for $\\Delta G_{c} = -2\\,\\mathrm{kcal/mol}$ at $T = 298\\,\\mathrm{K}$.\n- The universal gas constant is given as $R = 1.9872\\times 10^{-3}\\,\\mathrm{kcal\\,mol^{-1}\\,K^{-1}}$.\n- The final numerical answer must be rounded to $3$ significant figures and expressed as a dimensionless number.\n\n**Step 2: Validation of Problem Statement**\nThe problem is assessed against the required criteria:\n- **Scientific Grounding**: The problem is firmly based on the MWC model of allostery and the principles of statistical mechanics (Boltzmann distribution), which are fundamental concepts in biophysics and chemistry. The premises are scientifically sound.\n- **Well-Posedness**: The problem clearly defines the system, the model, the parameters, and the objective. The objective is to find an upper bound, which implies an optimization with respect to the unknown parameter $\\Delta G_{0}$. This is a well-defined mathematical task leading to a unique solution.\n- **Objectivity**: The problem is stated in precise, technical language, free from subjective or ambiguous terms.\n- **Completeness and Consistency**: The problem provides all necessary parameters ($\\Delta G_c$, $T$, $R$) and definitions to derive and evaluate the required quantity. The parameter $\\Delta G_{0}$ is correctly treated as an unknown variable over which the dynamic range is to be maximized.\n\n**Step 3: Verdict**\nThe problem is scientifically sound, well-posed, objective, and self-contained. There are no contradictions, no missing information, and no violations of physical principles. Therefore, the problem is deemed **valid**. We will proceed with the derivation of a solution.\n\n**Solution Derivation**\n\nLet the inactive state be denoted by $I$ and the active state by $A$. According to the principles of statistical mechanics for a system in thermal equilibrium, the probability of finding the system in a particular state is governed by the Boltzmann distribution. For a two-state system, the probability of being in the active state, $P(A)$, is given by:\n$$\nP(A) = \\frac{\\exp(-G_A/(RT))}{ \\exp(-G_I/(RT)) + \\exp(-G_A/(RT)) }\n$$\nwhere $G_I$ and $G_A$ are the free energies of the inactive and active states, respectively, $R$ is the universal gas constant, and $T$ is the absolute temperature. This expression can be rewritten in terms of the free energy difference $\\Delta G = G_A - G_I$:\n$$\nP(A) = \\frac{1}{1 + \\exp(\\Delta G/(RT))}\n$$\n\nWe must consider two conditions as specified by the problem.\n\n**Case 1: Zero Ligand Concentration**\nIn the absence of ligand, the free energy difference between the conformations is given as $\\Delta G_{0} = G_A^0 - G_I^0$. The probability of the sensor being in the active state, $P(A)_0$, is:\n$$\nP(A)_0 = \\frac{1}{1 + \\exp(\\Delta G_{0}/(RT))}\n$$\n\n**Case 2: Saturating Ligand Concentration**\nAt saturating ligand concentration, the ligand binding differentially stabilizes the active conformation by a coupling free energy $\\Delta G_{c}$. This means the free energy difference between the ligand-bound active state and the ligand-bound inactive state is shifted. The new free energy difference, $\\Delta G_{\\text{sat}}$, is:\n$$\n\\Delta G_{\\text{sat}} = \\Delta G_{0} + \\Delta G_{c}\n$$\nThe probability of the sensor being in the active state at saturation, $P(A)_{\\text{sat}}$, is therefore:\n$$\nP(A)_{\\text{sat}} = \\frac{1}{1 + \\exp((\\Delta G_{0} + \\Delta G_{c})/(RT))}\n$$\n\n**Dynamic Range and its Maximization**\nThe problem defines the dynamic range, $DR$, as the fold-change in output. Since the output is proportional to the probability of the active state, the proportionality constant cancels out in the ratio:\n$$\nDR = \\frac{P(A)_{\\text{sat}}}{P(A)_0} = \\frac{1 / (1 + \\exp((\\Delta G_{0} + \\Delta G_{c})/(RT)))}{1 / (1 + \\exp(\\Delta G_{0}/(RT)))} = \\frac{1 + \\exp(\\Delta G_{0}/(RT))}{1 + \\exp(\\Delta G_{0}/(RT))\\exp(\\Delta G_{c}/(RT))}\n$$\nTo find the theoretical upper bound on the dynamic range, we must maximize this expression with respect to the parameter $\\Delta G_{0}$. The value of $\\Delta G_{0}$ is unknown and depends on the specific protein design, so we can treat it as a variable over its possible range from $-\\infty$ to $+\\infty$.\n\nLet us define a variable $x = \\exp(\\Delta G_{0}/(RT))$ and a constant $k = \\exp(\\Delta G_{c}/(RT))$. Since $\\Delta G_{0}$ can range from $-\\infty$ to $+\\infty$, the variable $x$ can range from $0$ to $+\\infty$. The expression for the dynamic range becomes a function of $x$:\n$$\nDR(x) = \\frac{1+x}{1+kx}\n$$\nTo find the maximum of $DR(x)$, we can examine its derivative with respect to $x$:\n$$\n\\frac{d(DR)}{dx} = \\frac{(1)(1+kx) - (1+x)(k)}{(1+kx)^2} = \\frac{1+kx-k-kx}{(1+kx)^2} = \\frac{1-k}{(1+kx)^2}\n$$\nThe sign of the derivative depends only on the term $1-k$, as the denominator is always positive. The problem specifies a biosensor where ligand binding promotes activation, which corresponds to a negative coupling energy, $\\Delta G_{c}  0$.\nGiven $\\Delta G_{c}  0$, the argument of the exponential $\\Delta G_{c}/(RT)$ is negative. Thus, $k = \\exp(\\Delta G_{c}/(RT))$ is a positive constant less than $1$ (i.e., $0  k  1$).\nConsequently, $1-k > 0$, which means $\\frac{d(DR)}{dx} > 0$ for all $x > 0$. The function $DR(x)$ is therefore monotonically increasing with $x$.\n\nThe maximum value of $DR(x)$ must occur at the upper boundary of the domain of $x$, which is $x \\to \\infty$. This corresponds to the physical limit where $\\Delta G_{0} \\to +\\infty$. We evaluate the limit of $DR(x)$ as $x \\to \\infty$:\n$$\nDR_{\\text{max}} = \\lim_{x\\to\\infty} \\frac{1+x}{1+kx} = \\lim_{x\\to\\infty} \\frac{x(1/x + 1)}{x(1/x + k)} = \\frac{1}{k}\n$$\nSubstituting back the definition of $k$, we obtain the analytical expression for the theoretical upper bound on the dynamic range:\n$$\nDR_{\\text{max}} = \\frac{1}{\\exp(\\Delta G_{c}/(RT))} = \\exp\\left(-\\frac{\\Delta G_{c}}{RT}\\right)\n$$\nThis expression represents the first part of the required answer.\n\n**Numerical Evaluation**\nNext, we evaluate this upper bound for the given parameters:\n$\\Delta G_{c} = -2\\,\\mathrm{kcal/mol}$\n$T = 298\\,\\mathrm{K}$\n$R = 1.9872 \\times 10^{-3}\\,\\mathrm{kcal\\,mol^{-1}\\,K^{-1}}$\n\nFirst, we calculate the value of the thermal energy, $RT$:\n$$\nRT = (1.9872 \\times 10^{-3}\\,\\mathrm{kcal\\,mol^{-1}\\,K^{-1}}) \\times (298\\,\\mathrm{K}) \\approx 0.5921856\\,\\mathrm{kcal\\,mol^{-1}}\n$$\nNow, we compute the exponent in the expression for $DR_{\\text{max}}$:\n$$\n-\\frac{\\Delta G_{c}}{RT} = -\\frac{-2\\,\\mathrm{kcal\\,mol^{-1}}}{0.5921856\\,\\mathrm{kcal\\,mol^{-1}}} = \\frac{2}{0.5921856} \\approx 3.37715\n$$\nFinally, we calculate the upper bound on the dynamic range:\n$$\nDR_{\\text{max}} = \\exp(3.37715) \\approx 29.2863\n$$\nRounding this result to $3$ significant figures as requested gives $29.3$. This is a dimensionless quantity as required.", "answer": "$$\\boxed{29.3}$$", "id": "2766540"}, {"introduction": "Individual protein sensors are the components of larger biological circuits. This final practice challenges you to integrate the principles of allosteric regulation into a systems-level model of a complete transcriptional biosensor, from ligand binding to final protein output [@problem_id:2766526]. By building a computational model that predicts the dose-response curve, you will learn how parameters at the molecular level—such as binding affinities and cooperativity—propagate to determine the behavior of the entire system.", "problem": "A transcriptional biosensor couples the binding of a small-molecule ligand to a repressible promoter controlling Green Fluorescent Protein (GFP) output. Consider a minimal equilibrium, state-based model of a single prokaryotic promoter with one operator overlapping the core promoter such that Ribonucleic Acid Polymerase (RNAP) and the active form of a repressor cannot bind simultaneously. Assume fast binding-unbinding relative to transcription initiation and GFP maturation-degradation, so that binding equilibria can be used to determine promoter occupancy. The following fundamental base is given.\n\n- Law of mass action for equilibrium binding: for a binding site and ligand with dissociation constant $K_{\\mathrm{d}}$ and free ligand concentration $[X]$, the statistical weight of the bound state relative to the unbound state is proportional to $[X]/K_{\\mathrm{d}}$.\n- State enumeration: the promoter has three mutually exclusive microstates with statistical weights $w_{\\emptyset} = 1$ (empty), $w_{\\mathrm{P}} \\propto [\\mathrm{P}]/K_{\\mathrm{P}}$ (RNAP-bound), and $w_{\\mathrm{R}} \\propto [\\mathrm{R}_{\\mathrm{A}}]/K_{\\mathrm{O}}$ (active-repressor-bound), where $[\\mathrm{P}]$ is the free RNAP concentration, $[\\mathrm{R}_{\\mathrm{A}}]$ is the concentration of repressor in its active (DNA-binding competent) state, $K_{\\mathrm{P}}$ is the RNAP dissociation constant for the promoter, and $K_{\\mathrm{O}}$ is the active repressor dissociation constant for the operator.\n- The active fraction of a repressor controlled by an inducing ligand $L$ follows the Hill-Langmuir model for independent binding: the active fraction is $f_{\\mathrm{A}}(L) = \\dfrac{1}{1 + (L/K_{\\mathrm{L}})^{n}}$, where $K_{\\mathrm{L}}$ is the ligand scale concentration and $n$ is the Hill coefficient. Then $[\\mathrm{R}_{\\mathrm{A}}] = f_{\\mathrm{A}}(L)\\,[\\mathrm{R}_{\\mathrm{tot}}]$, where $[\\mathrm{R}_{\\mathrm{tot}}]$ is the total repressor concentration.\n- Transcription initiation rate is proportional to RNAP occupancy of the promoter. Let the basal leak rate (with no RNAP bound) be $r_{\\mathrm{leak}}$ and the maximum rate be $r_{\\max}$. If the RNAP occupancy is $p_{\\mathrm{on}}(L)$, the initiation rate is $r(L) = r_{\\mathrm{leak}} + (r_{\\max} - r_{\\mathrm{leak}})\\,p_{\\mathrm{on}}(L)$.\n- Steady-state GFP level results from a birth–death balance: if each transcript yields a constant factor $c_{\\mathrm{eff}}$ of mature fluorescent units, and the first-order loss rate constant is $\\gamma$, then the steady-state GFP is $G_{\\mathrm{ss}}(L) = \\dfrac{c_{\\mathrm{eff}}\\; r(L)}{\\gamma}$.\n\nTask. Starting strictly from the above base, derive expressions that relate $G_{\\mathrm{ss}}(L)$ to $[\\mathrm{P}]$, $K_{\\mathrm{P}}$, $[\\mathrm{R}_{\\mathrm{tot}}]$, $K_{\\mathrm{O}}$, $K_{\\mathrm{L}}$, $n$, $r_{\\mathrm{leak}}$, $r_{\\max}$, $c_{\\mathrm{eff}}$, and $\\gamma$. Then implement a program that, for each test case below, computes the dose-response vector $\\{G_{\\mathrm{ss}}(L_{1}), G_{\\mathrm{ss}}(L_{2}), \\ldots\\}$ across the specified ligand concentrations.\n\nAll concentrations must be treated in nanomolar (nM). All rates $r_{\\mathrm{leak}}$ and $r_{\\max}$ must be treated in transcripts per minute. The factor $c_{\\mathrm{eff}}$ is in arbitrary fluorescence units per transcript, and $\\gamma$ is in per minute. Your program must output steady-state GFP values in arbitrary fluorescence units (AU), each rounded to six decimal places.\n\nTest suite. Use the following parameter sets. For each case, compute $\\{G_{\\mathrm{ss}}(L)\\}$ over the specified ligand concentrations (in nanomolar).\n\n- Case A (happy path, moderate binding): $[\\mathrm{P}] = 50$, $K_{\\mathrm{P}} = 25$, $[\\mathrm{R}_{\\mathrm{tot}}] = 100$, $K_{\\mathrm{O}} = 10$, $K_{\\mathrm{L}} = 100$, $n = 2$, $r_{\\max} = 1.0$, $r_{\\mathrm{leak}} = 0.02$, $c_{\\mathrm{eff}} = 100$, $\\gamma = 0.1$, ligand set $\\{0, 10, 100, 1000\\}$.\n- Case B (boundary, no RNAP): $[\\mathrm{P}] = 0$, $K_{\\mathrm{P}} = 25$, $[\\mathrm{R}_{\\mathrm{tot}}] = 100$, $K_{\\mathrm{O}} = 10$, $K_{\\mathrm{L}} = 100$, $n = 2$, $r_{\\max} = 1.0$, $r_{\\mathrm{leak}} = 0.02$, $c_{\\mathrm{eff}} = 100$, $\\gamma = 0.1$, ligand set $\\{0, 100, 10^{6}\\}$.\n- Case C (edge, no repressor): $[\\mathrm{P}] = 50$, $K_{\\mathrm{P}} = 25$, $[\\mathrm{R}_{\\mathrm{tot}}] = 0$, $K_{\\mathrm{O}} = 10$, $K_{\\mathrm{L}} = 100$, $n = 2$, $r_{\\max} = 1.0$, $r_{\\mathrm{leak}} = 0.02$, $c_{\\mathrm{eff}} = 100$, $\\gamma = 0.1$, ligand set $\\{0, 100\\}$.\n- Case D (tight operator, cooperative inactivation): $[\\mathrm{P}] = 25$, $K_{\\mathrm{P}} = 25$, $[\\mathrm{R}_{\\mathrm{tot}}] = 100$, $K_{\\mathrm{O}} = 1$, $K_{\\mathrm{L}} = 50$, $n = 3$, $r_{\\max} = 1.0$, $r_{\\mathrm{leak}} = 0.02$, $c_{\\mathrm{eff}} = 100$, $\\gamma = 0.1$, ligand set $\\{0, 50, 500\\}$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a bracketed, comma-separated list of floats corresponding to the dose-response values for that test case, in AU and rounded to six decimal places. For example, a valid shape is $\\big[\\,[x_{1},x_{2}],\\,[y_{1},y_{2},y_{3}]\\,\\big]$ with no extra whitespace. The program must be self-contained, must not read any input, and must not perform any random sampling.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of statistical mechanics and biochemical kinetics, well-posed with a clear objective and sufficient data, and formulated using precise, objective language. The model presented is a standard and appropriate simplification for describing the behavior of a synthetic gene circuit. We may therefore proceed with the derivation and solution.\n\nThe task is to derive an expression for the steady-state Green Fluorescent Protein (GFP) level, $G_{\\mathrm{ss}}(L)$, as a function of ligand concentration $L$, and then to compute this value for several test cases. The derivation begins from the fundamental principles provided.\n\nFirst, we determine the probability of the promoter being bound by RNA Polymerase (RNAP), denoted as $p_{\\mathrm{on}}(L)$. This is based on a thermodynamic model of competing states at the promoter. The system has three mutually exclusive microstates: empty ($\\emptyset$), bound by RNAP ($P$), and bound by the active form of the repressor ($R_A$). The statistical weight of each state is given relative to the empty state, for which $w_{\\emptyset} = 1$. The weights for the bound states are:\n$$ w_{\\mathrm{P}} = \\frac{[\\mathrm{P}]}{K_{\\mathrm{P}}} $$\n$$ w_{\\mathrm{R}} = \\frac{[\\mathrm{R}_{\\mathrm{A}}]}{K_{\\mathrm{O}}} $$\nwhere $[\\mathrm{P}]$ is the free RNAP concentration, $K_{\\mathrm{P}}$ is its dissociation constant; $[\\mathrm{R}_{\\mathrm{A}}]$ is the active repressor concentration, and $K_{\\mathrm{O}}$ is its dissociation constant for the operator.\n\nThe partition function, $Z$, is the sum of the statistical weights of all possible states:\n$$ Z = w_{\\emptyset} + w_{\\mathrm{P}} + w_{\\mathrm{R}} = 1 + \\frac{[\\mathrm{P}]}{K_{\\mathrm{P}}} + \\frac{[\\mathrm{R}_{\\mathrm{A}}]}{K_{\\mathrm{O}}} $$\nThe probability of a given state is its statistical weight divided by the partition function. Thus, the RNAP occupancy, $p_{\\mathrm{on}}$, which is the probability of the promoter being in the RNAP-bound state, is:\n$$ p_{\\mathrm{on}} = \\frac{w_{\\mathrm{P}}}{Z} = \\frac{[\\mathrm{P}]/K_{\\mathrm{P}}}{1 + [\\mathrm{P}]/K_{\\mathrm{P}} + [\\mathrm{R}_{\\mathrm{A}}]/K_{\\mathrm{O}}} $$\nThe concentration of active repressor, $[\\mathrm{R}_{\\mathrm{A}}]$, is dependent on the inducer ligand concentration, $L$. This dependence is described by the Hill-Langmuir model:\n$$ [\\mathrm{R}_{\\mathrm{A}}](L) = [\\mathrm{R}_{\\mathrm{tot}}] \\cdot f_{\\mathrm{A}}(L) = [\\mathrm{R}_{\\mathrm{tot}}] \\cdot \\frac{1}{1 + (L/K_{\\mathrm{L}})^{n}} $$\nwhere $[\\mathrm{R}_{\\mathrm{tot}}]$ is the total repressor concentration, $K_{\\mathrm{L}}$ is the ligand's effective concentration for half-inactivation, and $n$ is the Hill coefficient.\n\nSubstituting the expression for $[\\mathrm{R}_{\\mathrm{A}}](L)$ into the equation for $p_{\\mathrm{on}}$ yields the ligand-dependent RNAP occupancy:\n$$ p_{\\mathrm{on}}(L) = \\frac{[\\mathrm{P}]/K_{\\mathrm{P}}}{1 + \\frac{[\\mathrm{P}]}{K_{\\mathrm{P}}} + \\frac{[\\mathrm{R}_{\\mathrm{tot}}]}{K_{\\mathrm{O}}} \\left( \\frac{1}{1 + (L/K_{\\mathrm{L}})^{n}} \\right)} $$\nThe transcription initiation rate, $r(L)$, is a linear function of this occupancy, accounting for a basal leak rate $r_{\\mathrm{leak}}$ and a maximum rate $r_{\\max}$:\n$$ r(L) = r_{\\mathrm{leak}} + (r_{\\max} - r_{\\mathrm{leak}}) \\cdot p_{\\mathrm{on}}(L) $$\nFinally, the steady-state GFP level, $G_{\\mathrm{ss}}(L)$, is determined by the balance of protein synthesis and degradation/dilution. Synthesis is proportional to the transcription rate $r(L)$ by a factor $c_{\\mathrm{eff}}$, and loss is a first-order process with rate constant $\\gamma$:\n$$ G_{\\mathrm{ss}}(L) = \\frac{c_{\\mathrm{eff}} \\cdot r(L)}{\\gamma} $$\nCombining these equations gives the final expression for the steady-state GFP as a function of ligand concentration and system parameters:\n$$ G_{\\mathrm{ss}}(L) = \\frac{c_{\\mathrm{eff}}}{\\gamma} \\left[ r_{\\mathrm{leak}} + (r_{\\max} - r_{\\mathrm{leak}}) \\left( \\frac{[\\mathrm{P}]/K_{\\mathrm{P}}}{1 + \\frac{[\\mathrm{P}]}{K_{\\mathrm{P}}} + \\frac{[\\mathrm{R}_{\\mathrm{tot}}]}{K_{\\mathrm{O}} \\left(1 + (L/K_{\\mathrm{L}})^{n}\\right)}} \\right) \\right] $$\nThis complete analytical expression will be implemented in the program. The calculation for each test case will be vectorized over the specified set of ligand concentrations using the `numpy` library for efficiency and clarity. The final results will be rounded to six decimal places as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the transcriptional biosensor problem for the given test cases.\n    It derives and computes the steady-state GFP response G_ss(L) across\n    a range of ligand concentrations for different parameter sets.\n    \"\"\"\n\n    test_cases = [\n        # Case A (happy path, moderate binding)\n        {'P_conc': 50.0, 'K_P': 25.0, 'R_tot': 100.0, 'K_O': 10.0, 'K_L': 100.0, 'n': 2.0,\n         'r_max': 1.0, 'r_leak': 0.02, 'c_eff': 100.0, 'gamma': 0.1,\n         'L_set': [0.0, 10.0, 100.0, 1000.0]},\n        # Case B (boundary, no RNAP)\n        {'P_conc': 0.0, 'K_P': 25.0, 'R_tot': 100.0, 'K_O': 10.0, 'K_L': 100.0, 'n': 2.0,\n         'r_max': 1.0, 'r_leak': 0.02, 'c_eff': 100.0, 'gamma': 0.1,\n         'L_set': [0.0, 100.0, 1e6]},\n        # Case C (edge, no repressor)\n        {'P_conc': 50.0, 'K_P': 25.0, 'R_tot': 0.0, 'K_O': 10.0, 'K_L': 100.0, 'n': 2.0,\n         'r_max': 1.0, 'r_leak': 0.02, 'c_eff': 100.0, 'gamma': 0.1,\n         'L_set': [0.0, 100.0]},\n        # Case D (tight operator, cooperative inactivation)\n        {'P_conc': 25.0, 'K_P': 25.0, 'R_tot': 100.0, 'K_O': 1.0, 'K_L': 50.0, 'n': 3.0,\n         'r_max': 1.0, 'r_leak': 0.02, 'c_eff': 100.0, 'gamma': 0.1,\n         'L_set': [0.0, 50.0, 500.0]}\n    ]\n\n    def calculate_g_ss(params):\n        \"\"\"\n        Calculates steady-state GFP levels for a given set of parameters\n        and a vector of ligand concentrations.\n        \"\"\"\n        P_conc = params['P_conc']\n        K_P = params['K_P']\n        R_tot = params['R_tot']\n        K_O = params['K_O']\n        K_L = params['K_L']\n        n = params['n']\n        r_max = params['r_max']\n        r_leak = params['r_leak']\n        c_eff = params['c_eff']\n        gamma = params['gamma']\n        L = np.array(params['L_set'], dtype=float)\n\n        # Handle potential division by zero if K_L is zero, though not in test cases.\n        if K_L == 0:\n            # If L is also 0, the term is ill-defined. Assume 0-th power of 0 is 1. All other L > 0 is infinity.\n            ligand_term = np.full_like(L, np.inf)\n            ligand_term[L == 0] = 1.0\n        else:\n            ligand_term = (L / K_L)**n\n            \n        # Repressor Term in partition function\n        repressor_term = (R_tot / K_O) / (1.0 + ligand_term)\n\n        # RNAP statistical weight\n        w_p = P_conc / K_P\n        \n        # Partition function Z\n        Z = 1.0 + w_p + repressor_term\n        \n        # RNAP occupancy p_on\n        # If P_conc is 0, w_p is 0, so p_on is 0.\n        p_on = w_p / Z\n        \n        # Transcription rate r(L)\n        r_L = r_leak + (r_max - r_leak) * p_on\n        \n        # Steady-state GFP G_ss(L)\n        g_ss = (c_eff / gamma) * r_L\n        \n        return g_ss\n\n    all_results = []\n    for case in test_cases:\n        g_ss_values = calculate_g_ss(case)\n        # Round each value to six decimal places\n        rounded_values = [round(val, 6) for val in g_ss_values]\n        all_results.append(rounded_values)\n\n    # Format the final output string to be a compact list of lists of floats\n    # e.g., [[x1,x2],[y1,y2,y3]] with no extra whitespace.\n    final_output_str = str(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```", "id": "2766526"}]}