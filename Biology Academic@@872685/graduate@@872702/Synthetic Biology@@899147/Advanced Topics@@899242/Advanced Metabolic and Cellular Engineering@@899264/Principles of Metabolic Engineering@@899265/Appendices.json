{"hands_on_practices": [{"introduction": "The performance of an engineered metabolic pathway is often dictated by the kinetics of its individual enzymes. While simple models are useful, real enzymes can exhibit complex behaviors like substrate inhibition, where high substrate concentrations paradoxically decrease the reaction rate $v$. This exercise [@problem_id:2762798] challenges you to apply calculus to determine the optimal substrate concentration $S$ that maximizes flux, a crucial skill for fine-tuning pathway performance and avoiding detrimental inhibitory effects.", "problem": "A metabolic engineer is optimizing the feed concentration for a single enzyme-catalyzed step in a heterologous pathway expressed in Escherichia coli (E. coli). The enzyme exhibits substrate inhibition, and the steady-state specific rate as a function of substrate concentration $S$ is given by the empirically validated substrate-inhibition form\n$$\nv(S) \\;=\\; V_{\\max}\\,\\frac{S}{K_m + S + \\frac{S^2}{K_i}} \\,,\n$$\nwhere $V_{\\max}$, $K_m$, and $K_i$ are positive constants. This form is consistent with elementary enzyme-substrate binding augmented by an inhibitory complex at high $S$. The design goal is to choose a feed concentration that maximizes the instantaneous flux through this step.\n\nUsing first principles from calculus (optimization via stationary points) and the provided kinetic description, determine the substrate concentration $S$ that maximizes $v(S)$ for parameters $V_{\\max}=50$ (rate units), $K_m=0.1$ millimolar, and $K_i=10$ millimolar. Express the final substrate concentration in millimolar (mM). If the maximizing value is exact, do not round; otherwise, round your final result to four significant figures.", "solution": "The problem requires finding the substrate concentration, denoted by $S$, that maximizes the specific reaction rate $v(S)$. The rate is described by the substrate-inhibition model:\n$$\nv(S) = V_{\\max} \\frac{S}{K_m + S + \\frac{S^2}{K_i}}\n$$\nwhere $V_{\\max}$, $K_m$, and $K_i$ are positive constants. The provided values are $V_{\\max}=50$ in arbitrary rate units, $K_m=0.1$ millimolar, and $K_i=10$ millimolar.\n\nThe problem is a standard optimization task that can be solved using differential calculus. To find the value of $S$ that maximizes $v(S)$, we must find the critical points of the function by computing its first derivative with respect to $S$ and setting it to zero. A critical point corresponds to a maximum, a minimum, or a point of inflection.\n\nFirst, we compute the derivative $\\frac{dv}{dS}$. Since $V_{\\max}$ is a positive constant, finding the maximum of $v(S)$ is equivalent to finding the maximum of the term $\\frac{S}{K_m + S + \\frac{S^2}{K_i}}$. We can use the quotient rule for differentiation, which states that for a function $f(x) = \\frac{u(x)}{w(x)}$, its derivative is $f'(x) = \\frac{u'(x)w(x) - u(x)w'(x)}{[w(x)]^2}$.\n\nLet $u(S) = S$ and $w(S) = K_m + S + \\frac{S^2}{K_i}$.\nThe derivatives are:\n$u'(S) = \\frac{d}{dS}(S) = 1$\n$w'(S) = \\frac{d}{dS}\\left(K_m + S + \\frac{S^2}{K_i}\\right) = 0 + 1 + \\frac{2S}{K_i} = 1 + \\frac{2S}{K_i}$\n\nNow, we apply the quotient rule to find $\\frac{dv}{dS}$:\n$$\n\\frac{dv}{dS} = V_{\\max} \\left[ \\frac{(1)\\left(K_m + S + \\frac{S^2}{K_i}\\right) - (S)\\left(1 + \\frac{2S}{K_i}\\right)}{\\left(K_m + S + \\frac{S^2}{K_i}\\right)^2} \\right]\n$$\nTo find the critical points, we set the derivative equal to zero: $\\frac{dv}{dS} = 0$. Since $V_{\\max}$ is a non-zero constant and the denominator is positive for any physical substrate concentration ($S \\ge 0$), this condition is satisfied only when the numerator is zero.\n$$\n\\left(K_m + S + \\frac{S^2}{K_i}\\right) - S\\left(1 + \\frac{2S}{K_i}\\right) = 0\n$$\nWe expand and simplify the expression:\n$$\nK_m + S + \\frac{S^2}{K_i} - S - \\frac{2S^2}{K_i} = 0\n$$\nThe terms involving $S$ cancel out:\n$$\nK_m - \\frac{S^2}{K_i} = 0\n$$\nNow, we solve for $S$:\n$$\n\\frac{S^2}{K_i} = K_m\n$$\n$$\nS^2 = K_m K_i\n$$\nSince substrate concentration $S$ must be a non-negative quantity, we take the positive square root:\n$$\nS = \\sqrt{K_m K_i}\n$$\nThis is the symbolic expression for the substrate concentration that maximizes the reaction rate. We can confirm this is a maximum by examining the sign of the derivative. The numerator, $K_m - \\frac{S^2}{K_i}$, is positive for $S  \\sqrt{K_m K_i}$ and negative for $S  \\sqrt{K_m K_i}$. This indicates that the function $v(S)$ increases until $S = \\sqrt{K_m K_i}$ and decreases thereafter, confirming that this point is indeed a maximum.\n\nNow, we substitute the given numerical values for the parameters $K_m$ and $K_i$:\n$K_m = 0.1$ millimolar\n$K_i = 10$ millimolar\n\nThe optimal substrate concentration, $S_{\\text{opt}}$, is:\n$$\nS_{\\text{opt}} = \\sqrt{(0.1)\\,(10)} = \\sqrt{1} = 1\n$$\nThe units are consistent, as $\\sqrt{(\\text{millimolar}) \\times (\\text{millimolar})} = \\text{millimolar}$. The resulting substrate concentration is $1$ millimolar. As this value is an exact integer, no rounding is necessary according to the problem statement.", "answer": "$$\\boxed{1}$$", "id": "2762798"}, {"introduction": "Moving from a single reaction to an interconnected network requires a systems-level approach, where the steady-state condition is often described by the matrix equation $S\\mathbf{v}=\\mathbf{0}$. Flux Balance Analysis (FBA) is a powerful constraint-based technique used to predict optimal flux distributions $\\mathbf{v}$ in large-scale metabolic networks. This practice [@problem_id:2762811] strips FBA down to its essential mathematical principles, using a simple network to provide a hands-on understanding of how to define a feasible flux space and solve for an optimal steady-state solution.", "problem": "Consider a steady-state metabolic network represented by the stoichiometric matrix $S \\in \\mathbb{R}^{2 \\times 3}$ with\n$$\nS=\\begin{bmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix},\n$$\nand a flux vector $\\mathbf{v}\\in\\mathbb{R}^{3}$ satisfying the steady-state mass balance $S\\mathbf{v}=\\mathbf{0}$. In Flux Balance Analysis (FBA), one seeks to maximize a linear cellular objective $z=\\mathbf{c}^{\\top}\\mathbf{v}$ subject to steady-state and bound constraints. Let the objective coefficient vector be\n$$\n\\mathbf{c}=\\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix},\n$$\nand impose nonnegativity lower bounds and no finite upper bounds,\n$$\n\\mathbf{l}=\\mathbf{0},\\quad \\mathbf{u}=\\boldsymbol{\\infty},\n$$\nso that the feasible set is defined by\n$$\nS\\mathbf{v}=\\mathbf{0},\\quad \\mathbf{v}\\ge \\mathbf{0}.\n$$\nStart from the definitions of steady-state mass balance and linear programming feasibility, without invoking any pre-derived shortcuts, and reason from first principles.\n\nTasks:\n- Determine whether the FBA problem $\\max_{\\mathbf{v}}\\{\\mathbf{c}^{\\top}\\mathbf{v}\\mid S\\mathbf{v}=\\mathbf{0},\\ \\mathbf{v}\\ge \\mathbf{0}\\}$ is bounded. Justify your conclusion using linear algebraic properties of $S$ and the geometry of the feasible set.\n- If the problem is unbounded, identify the optimal extreme ray of the feasible cone that increases the objective, and then impose the normalization $v_{1}=1$ (a scaling condition to report a unique representative of the optimal ray). Under this normalization, compute the corresponding flux vector $\\mathbf{v}$.\n\nExpress your final answer as a single row matrix using a $\\mathrm{pmatrix}$ with no units. No rounding is required.", "solution": "The task is to determine if the objective function is bounded over the feasible set and, if not, to find a representative flux vector along the optimal ray. The feasible set is the region in $\\mathbb{R}^{3}$ defined by the constraints $S\\mathbf{v}=\\mathbf{0}$ and $\\mathbf{v} \\ge \\mathbf{0}$. This set is a polyhedral cone, as its constraints consist of homogeneous linear equalities and non-negativity bounds.\n\nFirst, we must characterize the null space of the matrix $S$, which is the set of all vectors $\\mathbf{v}$ satisfying $S\\mathbf{v}=\\mathbf{0}$. The matrix equation is:\n$$\n\\begin{bmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix}\n\\begin{pmatrix}\nv_{1} \\\\\nv_{2} \\\\\nv_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nThis expands into a system of two linear equations:\n$$(1) \\quad 1 \\cdot v_{1} - 1 \\cdot v_{2} + 0 \\cdot v_{3} = 0$$\n$$(2) \\quad 0 \\cdot v_{1} + 1 \\cdot v_{2} - 1 \\cdot v_{3} = 0$$\nFrom equation $(1)$, we find $v_{1} = v_{2}$. From equation $(2)$, we find $v_{2} = v_{3}$. Therefore, any vector in the null space must satisfy $v_{1} = v_{2} = v_{3}$. We can express any such vector as a scalar multiple of a basis vector. Let $v_{3} = k$ for some scalar $k \\in \\mathbb{R}$. Then $v_{1} = v_{2} = v_{3} = k$. The null space of $S$, denoted $\\text{ker}(S)$, is the one-dimensional subspace spanned by the vector $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$. Any vector $\\mathbf{v} \\in \\text{ker}(S)$ can be written as:\n$$\n\\mathbf{v} = k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n\nNext, we apply the non-negativity constraint, $\\mathbf{v} \\ge \\mathbf{0}$. This requires each component of $\\mathbf{v}$ to be non-negative:\n$$\nv_{1} = k \\ge 0\n$$\n$$\nv_{2} = k \\ge 0\n$$\n$$\nv_{3} = k \\ge 0\n$$\nAll three conditions are satisfied if and only if $k \\ge 0$. Thus, the feasible set is the ray starting from the origin in the direction of the vector $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$. Any feasible flux vector $\\mathbf{v}$ has the form $\\mathbf{v} = k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ for some $k \\ge 0$.\n\nNow, we evaluate the objective function $z = \\mathbf{c}^{\\top}\\mathbf{v}$ for any vector in the feasible set:\n$$\nz = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\left( k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = k \\left( \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = k(0 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 1) = k\n$$\nThe value of the objective function is $z=k$. Since $k$ can be any non-negative real number ($k \\ge 0$), the value of $z$ can be made arbitrarily large by increasing $k$. Consequently, the maximization problem has no finite maximum, and the FBA problem is unbounded.\n\nThe problem is unbounded because the feasible cone possesses an extreme ray, with direction vector $\\mathbf{d} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$, along which the objective function increases. This is confirmed by checking that $\\mathbf{c}^{\\top}\\mathbf{d} = 1 > 0$. As this is the only ray in the feasible cone (besides the origin), it is the optimal extreme ray.\n\nThe final task is to find the specific flux vector $\\mathbf{v}$ that lies on this optimal ray and satisfies the normalization condition $v_{1}=1$. A general point on the ray is given by $\\mathbf{v} = \\begin{pmatrix} k \\\\ k \\\\ k \\end{pmatrix}$. Applying the condition $v_{1}=1$ gives $k=1$. Substituting this value of $k$ back into the general form of $\\mathbf{v}$, we obtain the normalized flux vector:\n$$\n\\mathbf{v} = 1 \\cdot \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\nThis vector represents the unique point on the optimal ray satisfying the specified scaling condition.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1\n\\end{pmatrix}\n}\n$$", "id": "2762811"}, {"introduction": "A key engineering question is: which step offers the most effective control over pathway flux $J$ or metabolite levels $S_i$? Metabolic Control Analysis (MCA) provides a quantitative framework to identify these crucial control points. In this problem [@problem_id:2762794], you will use local enzyme properties (elasticities, $\\varepsilon$) to calculate a global system property (a control coefficient, $C$), revealing how control is distributed within a simple metabolic pathway.", "problem": "A single-internal-metabolite linear pathway converts an external substrate $S_0$ to an external product $S_2$ via two enzymatic steps: $S_0 \\xrightarrow{v_1} S_1 \\xrightarrow{v_2} S_2$. The internal metabolite is $S_1$. The system is at steady state, and all variables are considered in the framework of Metabolic Control Analysis using scaled (dimensionless) quantities. The scaled elasticity of each rate $v_i$ with respect to the internal metabolite concentration $S_1$ is provided as follows: $\\varepsilon_{v_1}^{S_1} = -\\frac{1}{2}$ and $\\varepsilon_{v_2}^{S_1} = 1$. Using only first principles of Metabolic Control Analysis for steady states in unbranched pathways, determine the concentration control coefficient of $S_1$ with respect to enzyme $E_1$, denoted $C_{E_1}^{S_1}$, defined as the scaled sensitivity of the steady-state concentration of $S_1$ to a change in the activity (concentration) of enzyme $E_1$. Express your final answer as an exact number without units. No rounding is required.", "solution": "The analysis begins with the fundamental condition for steady state for the internal metabolite $S_1$. At steady state, the concentration of $S_1$ is constant, which requires its rate of production, $v_1$, to be equal to its rate of consumption, $v_2$. Let $S_1$ denote the steady-state concentration.\n$$v_1 = v_2$$\nThe reaction rates $v_1$ and $v_2$ are functions of reactant concentrations and the concentrations of the enzymes that catalyze them, $E_1$ and $E_2$, respectively. For this system, we can write the steady-state condition as:\n$$v_1(S_1, E_1) = v_2(S_1, E_2)$$\nThe concentration control coefficient, $C_{E_1}^{S_1}$, quantifies the relative change in the steady-state concentration of $S_1$ resulting from a relative change in the concentration (or activity) of enzyme $E_1$. It is defined as:\n$$C_{E_1}^{S_1} = \\frac{\\partial \\ln(S_1)}{\\partial \\ln(E_1)} = \\frac{E_1}{S_1} \\frac{\\partial S_1}{\\partial E_1}$$\nTo find this coefficient, we investigate how a perturbation in $E_1$ affects the steady-state condition. We apply a total differentiation to the steady-state equation with respect to $E_1$:\n$$\\frac{d}{dE_1} [v_1(S_1, E_1)] = \\frac{d}{dE_1} [v_2(S_1, E_2)]$$\nApplying the chain rule for differentiation yields:\n$$\\frac{\\partial v_1}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1} + \\frac{\\partial v_1}{\\partial E_1} \\frac{\\partial E_1}{\\partial E_1} = \\frac{\\partial v_2}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1} + \\frac{\\partial v_2}{\\partial E_2} \\frac{\\partial E_2}{\\partial E_1}$$\nSince the enzyme concentrations $E_1$ and $E_2$ are independent parameters, $\\frac{\\partial E_2}{\\partial E_1} = 0$. The equation simplifies to:\n$$\\frac{\\partial v_1}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1} + \\frac{\\partial v_1}{\\partial E_1} = \\frac{\\partial v_2}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1}$$\nWe rearrange this equation to solve for the unscaled response coefficient, $\\frac{\\partial S_1}{\\partial E_1}$:\n$$\\left( \\frac{\\partial v_2}{\\partial S_1} - \\frac{\\partial v_1}{\\partial S_1} \\right) \\frac{\\partial S_1}{\\partial E_1} = \\frac{\\partial v_1}{\\partial E_1}$$\n$$\\frac{\\partial S_1}{\\partial E_1} = \\frac{\\frac{\\partial v_1}{\\partial E_1}}{\\frac{\\partial v_2}{\\partial S_1} - \\frac{\\partial v_1}{\\partial S_1}}$$\nTo express this result in terms of scaled coefficients, we use the definitions of elasticity coefficients ($\\varepsilon$) and the property of enzyme elasticities. The elasticity of a rate $v_i$ with respect to a metabolite concentration $S_j$ is given by:\n$$\\varepsilon_{v_i}^{S_j} = \\frac{S_j}{v_i} \\frac{\\partial v_i}{\\partial S_j}$$\nA foundational assumption in MCA is that reaction rates are directly proportional to the concentration of the catalyzing enzyme, i.e., $v_i \\propto E_i$. Consequently, the partial derivative $\\frac{\\partial v_i}{\\partial E_i}$ is equal to $\\frac{v_i}{E_i}$.\nUsing these definitions, we can rewrite the terms in the expression for $\\frac{\\partial S_1}{\\partial E_1}$:\n$$\\frac{\\partial v_1}{\\partial E_1} = \\frac{v_1}{E_1}$$\n$$\\frac{\\partial v_1}{\\partial S_1} = \\frac{v_1}{S_1} \\varepsilon_{v_1}^{S_1}$$\n$$\\frac{\\partial v_2}{\\partial S_1} = \\frac{v_2}{S_1} \\varepsilon_{v_2}^{S_1}$$\nSubstituting these into the equation for $\\frac{\\partial S_1}{\\partial E_1}$:\n$$\\frac{\\partial S_1}{\\partial E_1} = \\frac{\\frac{v_1}{E_1}}{\\frac{v_2}{S_1} \\varepsilon_{v_2}^{S_1} - \\frac{v_1}{S_1} \\varepsilon_{v_1}^{S_1}}$$\nAt steady state, $v_1 = v_2$. Let us denote this steady-state flux as $J$.\n$$\\frac{\\partial S_1}{\\partial E_1} = \\frac{\\frac{J}{E_1}}{\\frac{J}{S_1} (\\varepsilon_{v_2}^{S_1} - \\varepsilon_{v_1}^{S_1})} = \\frac{J}{E_1} \\frac{S_1}{J (\\varepsilon_{v_2}^{S_1} - \\varepsilon_{v_1}^{S_1})} = \\frac{S_1}{E_1} \\frac{1}{\\varepsilon_{v_2}^{S_1} - \\varepsilon_{v_1}^{S_1}}$$\nNow, we can compute the desired control coefficient $C_{E_1}^{S_1}$:\n$$C_{E_1}^{S_1} = \\frac{E_1}{S_1} \\frac{\\partial S_1}{\\partial E_1} = \\frac{E_1}{S_1} \\left( \\frac{S_1}{E_1} \\frac{1}{\\varepsilon_{v_2}^{S_1} - \\varepsilon_{v_1}^{S_1}} \\right)$$\nAlgebraic simplification yields the general formula for this type of pathway:\n$$C_{E_1}^{S_1} = \\frac{1}{\\varepsilon_{v_2}^{S_1} - \\varepsilon_{v_1}^{S_1}}$$\nThe final step is to substitute the given values for the elasticity coefficients:\n$$\\varepsilon_{v_1}^{S_1} = -\\frac{1}{2}$$\n$$\\varepsilon_{v_2}^{S_1} = 1$$\nSubstituting these into the derived formula:\n$$C_{E_1}^{S_1} = \\frac{1}{1 - (-\\frac{1}{2})} = \\frac{1}{1 + \\frac{1}{2}} = \\frac{1}{\\frac{3}{2}}$$\n$$C_{E_1}^{S_1} = \\frac{2}{3}$$\nThis result indicates that a $1\\%$ increase in the activity of enzyme $E_1$ will lead to a $\\frac{2}{3}\\%$ increase in the steady-state concentration of metabolite $S_1$.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2762794"}]}