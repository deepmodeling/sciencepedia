{"hands_on_practices": [{"introduction": "A cell-free system's productivity is fundamentally governed by its energy supply. This exercise delves into the bioenergetic heart of a TX-TL reaction, challenging you to balance the books between ATP generation and its consumption by transcription and translation. By building a steady-state model based on biochemical stoichiometry and enzyme kinetics [@problem_id:2718524], you will develop a quantitative understanding of how the system's energy metabolism constrains its synthetic output.", "problem": "A cell-free transcription-translation (TX-TL) reaction uses an energy regeneration module to supply adenosine triphosphate (ATP) needed by transcription and translation. The energy module is based on phosphoenolpyruvate (PEP) with pyruvate kinase (PK), supported by adenylate kinase and nucleoside diphosphate kinase to maintain balanced nucleoside triphosphate pools. Assume the following foundational facts and stoichiometries:\n\n1. Central Dogma consumption in ATP-equivalents: for each ribonucleotide added during transcription, one nucleoside triphosphate is hydrolyzed, which, under balanced regeneration by nucleoside diphosphate kinase, counts as one ATP-equivalent per nucleotide. For translation, each amino acid incorporated consumes one ATP to adenosine monophosphate (two ATP-equivalents) for aminoacylation and two guanosine triphosphates (two ATP-equivalents) during elongation. In addition, initiation and termination together consume two guanosine triphosphates (two ATP-equivalents) per completed polypeptide. Thus, the ATP-equivalent cost per synthesized protein of length $L_{\\mathrm{aa}}$ is $4L_{\\mathrm{aa}} + 2$.\n\n2. The PK-based regeneration rate follows Michaelis–Menten kinetics for PEP: if the total PK concentration is $E_{\\mathrm{PK}}$ and the turnover number is $k_{\\mathrm{cat}}$, then the ATP production rate is\n$$\nv_{\\mathrm{prod}} \\;=\\; k_{\\mathrm{cat}}\\,E_{\\mathrm{PK}}\\,\\frac{[{\\mathrm{PEP}}]}{K_{M}^{\\mathrm{PEP}} + [{\\mathrm{PEP}}]}\\,,\n$$\nwith stoichiometry $1$ PEP $\\to$ $1$ ATP.\n\nConsider a single protein-coding gene with the following measured synthesis fluxes and sizes:\n- Messenger RNA (mRNA) synthesis flux $J_{m} = 0.002\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$, transcript length $L_{\\mathrm{nt}} = 1200\\,\\mathrm{nt}$.\n- Protein synthesis flux $J_{p} = 0.000277\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ (that is, $0.277\\,\\mathrm{nM}\\,\\mathrm{s}^{-1}$), protein length $L_{\\mathrm{aa}} = 400\\,\\mathrm{aa}$.\n\nThe energy module parameters are:\n- $E_{\\mathrm{PK}} = 0.2\\,\\mu\\mathrm{M}$,\n- $k_{\\mathrm{cat}} = 150\\,\\mathrm{s}^{-1}$,\n- $K_{M}^{\\mathrm{PEP}} = 70\\,\\mu\\mathrm{M}$,\n- $[{\\mathrm{PEP}}] = 10\\,\\mathrm{mM}$.\n\nAssume no other ATP sinks or sources. Formulate the steady-state constraint-based balance in which total ATP production equals total consumption by transcription and translation, with nonnegativity and capacity bounds implicit from the stoichiometry and Michaelis–Menten rate. Then, using these data, solve for the steady ATP turnover rate $v^{*}$ (the common value of production and consumption at steady state). Express your final numerical answer in $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ and round to four significant figures.", "solution": "The problem is valid. It is scientifically grounded in the principles of biochemical kinetics and the stoichiometry of macromolecular synthesis, and it is well-posed, providing all necessary information for a unique solution.\n\nThe fundamental principle to be applied is the condition of steady state for the concentration of adenosine triphosphate (ATP). In a steady state, the total rate of production of a species must be equal to its total rate of consumption. For ATP in this cell-free system, this balance is expressed as:\n$$v_{\\mathrm{prod}} = v_{\\mathrm{cons}}$$\nwhere $v_{\\mathrm{prod}}$ is the rate of ATP regeneration by the energy module and $v_{\\mathrm{cons}}$ is the rate of ATP consumption by the processes of transcription and translation. The problem asks for the steady-state ATP turnover rate, $v^{*}$, which is the common value of these rates, $v^{*} = v_{\\mathrm{prod}} = v_{\\mathrm{cons}}$.\n\nThe problem provides the synthesis fluxes for messenger RNA (mRNA), $J_{m}$, and protein, $J_{p}$, which characterize the specific steady state of the system. Therefore, the total consumption rate can be calculated directly from these fluxes and the given stoichiometries. This calculated consumption rate is, by definition, the steady-state turnover rate $v^{*}$.\n\nThe total consumption rate, $v_{\\mathrm{cons}}$, is the sum of the consumption rates for transcription ($v_{\\mathrm{cons, tx}}$) and translation ($v_{\\mathrm{cons, tl}}$):\n$$v^{*} = v_{\\mathrm{cons}} = v_{\\mathrm{cons, tx}} + v_{\\mathrm{cons, tl}}$$\n\nFirst, we calculate the ATP consumption rate for transcription, $v_{\\mathrm{cons, tx}}$. The problem states that the incorporation of each ribonucleotide requires one ATP-equivalent. The length of the mRNA transcript is given as $L_{\\mathrm{nt}} = 1200\\,\\mathrm{nt}$. The rate of synthesis of full-length mRNA molecules is given by the flux $J_{m} = 0.002\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$. The total rate of nucleotide incorporation is the product of the number of nucleotides per transcript and the flux of transcripts.\n$$v_{\\mathrm{cons, tx}} = L_{\\mathrm{nt}} \\times J_{m}$$\nSubstituting the given values:\n$$v_{\\mathrm{cons, tx}} = 1200 \\times 0.002\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 2.4\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nSecond, we calculate the ATP consumption rate for translation, $v_{\\mathrm{cons, tl}}$. The problem specifies that the synthesis of a single protein of length $L_{\\mathrm{aa}}$ amino acids consumes a total of $4L_{\\mathrm{aa}} + 2$ ATP-equivalents. The protein length is given as $L_{\\mathrm{aa}} = 400\\,\\mathrm{aa}$. The rate of synthesis of full-length protein molecules is given by the flux $J_{p} = 0.000277\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$. The total ATP consumption rate for translation is the product of the energetic cost per protein and the flux of proteins.\nThe cost per protein is:\n$$C_{\\mathrm{tl}} = 4L_{\\mathrm{aa}} + 2 = 4(400) + 2 = 1600 + 2 = 1602 \\text{ ATP-equivalents/protein}$$\nThe consumption rate is then:\n$$v_{\\mathrm{cons, tl}} = C_{\\mathrm{tl}} \\times J_{p} = 1602 \\times 0.000277\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 0.443754\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nNow, we can find the total consumption rate, which is the steady-state turnover rate $v^{*}$:\n$$v^{*} = v_{\\mathrm{cons, tx}} + v_{\\mathrm{cons, tl}} = 2.4\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} + 0.443754\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 2.843754\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$v^{*} \\approx 2.844\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nFor completeness, we verify that this required turnover rate is feasible given the capacity of the energy regeneration module. The production rate $v_{\\mathrm{prod}}$ is given by the Michaelis–Menten equation:\n$$v_{\\mathrm{prod}} = k_{\\mathrm{cat}}\\,E_{\\mathrm{PK}}\\,\\frac{[{\\mathrm{PEP}}]}{K_{M}^{\\mathrm{PEP}} + [{\\mathrm{PEP}}]}$$\nThe parameters are $k_{\\mathrm{cat}} = 150\\,\\mathrm{s}^{-1}$, $E_{\\mathrm{PK}} = 0.2\\,\\mu\\mathrm{M}$, $K_{M}^{\\mathrm{PEP}} = 70\\,\\mu\\mathrm{M}$, and $[{\\mathrm{PEP}}] = 10\\,\\mathrm{mM} = 10000\\,\\mu\\mathrm{M}$.\n$$v_{\\mathrm{prod}} = (150\\,\\mathrm{s}^{-1})(0.2\\,\\mu\\mathrm{M}) \\frac{10000\\,\\mu\\mathrm{M}}{70\\,\\mu\\mathrm{M} + 10000\\,\\mu\\mathrm{M}}$$\n$$v_{\\mathrm{prod}} = 30\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} \\times \\frac{10000}{10070} \\approx 30 \\times 0.99305\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} \\approx 29.79\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\nSince $v_{\\mathrm{prod}} \\approx 29.79\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ is substantially greater than the required consumption rate $v^{*} \\approx 2.844\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$, the energy regeneration system has sufficient capacity to sustain the specified steady state of transcription and translation. The actual production rate in this steady state must match the consumption rate, $v^{*}$, not the maximum potential rate.\nThe steady-state turnover rate is thus determined by the consumption processes.", "answer": "$$\\boxed{2.844}$$", "id": "2718524"}, {"introduction": "Interpreting experimental data is a core skill in synthetic biology, and raw measurements often require careful modeling to reveal the underlying biological process. This practice focuses on converting a time-series of fluorescence data from a reporter protein into the instantaneous synthesis rate [@problem_id:2718570]. You will learn to account for the kinetic delay of chromophore maturation, applying principles of differential equations and numerical approximation to deconvolve the true production dynamics from the observed signal.", "problem": "A cell-free transcription-translation (TX-TL) reaction expressing green fluorescent protein (GFP) is monitored over time using a microplate reader that reports arbitrary fluorescence units (AU). The measurement reports predominantly the mature fluorescent species. Assume the following foundational principles and facts:\n- Under linear detection conditions, the measured fluorescence is proportional to the number of mature fluorescent protein molecules per unit volume.\n- Protein folding and chromophore maturation can be modeled as a first-order process from a nonfluorescent immature state to a fluorescent mature state.\n- The instantaneous synthesis rate of protein equals the rate at which new immature molecules are produced.\n- Instantaneous rates are defined as time derivatives.\n\nYou are given:\n- A background fluorescence measured in a no-DNA control: $F_{\\mathrm{blank}} = 120$ AU.\n- A calibration factor converting fluorescence to molecules per volume: $\\alpha = 4.8 \\times 10^{9}$ molecules per AU per $\\mu$L.\n- A first-order maturation rate constant at the reaction temperature: $k_{\\mathrm{mat}} = 0.10$ $\\mathrm{min}^{-1}$.\n- A time series of fluorescence readings for the TX-TL reaction at uniform sampling interval $\\Delta t = 15$ $\\mathrm{min}$:\n  - $t = 0$ $\\mathrm{min}$, $F = 120$ AU\n  - $t = 15$ $\\mathrm{min}$, $F = 240$ AU\n  - $t = 30$ $\\mathrm{min}$, $F = 480$ AU\n  - $t = 45$ $\\mathrm{min}$, $F = 840$ AU\n  - $t = 60$ $\\mathrm{min}$, $F = 1200$ AU\n  - $t = 75$ $\\mathrm{min}$, $F = 1440$ AU\n  - $t = 90$ $\\mathrm{min}$, $F = 1560$ AU\n\nLet $F(t)$ denote the measured fluorescence and let $M(t)$ denote the number of mature fluorescent protein molecules per $\\mu$L. Assume the instrument response is linear and that photobleaching and protein degradation are negligible over the time window considered.\n\nTask: Starting from first principles, derive an expression for the instantaneous protein synthesis rate $S(t)$ (in molecules per $\\mu$L per min) in terms of $M(t)$ and its time derivatives, explicitly accounting for first-order maturation. Then, using the provided data and assuming that time derivatives at $t = 60$ $\\mathrm{min}$ can be approximated by second-order central differences based on the adjacent time points, compute the numerical value of $S(60\\,\\mathrm{min})$. \n\nInstructions:\n- Convert fluorescence to mature molecules per $\\mu$L using the given calibration and background.\n- Use second-order central differences at $t = 60$ $\\mathrm{min}$ with $\\Delta t = 15$ $\\mathrm{min}$ to approximate the first and second time derivatives of $M(t)$.\n- Report the final synthesis rate as a single number in molecules per $\\mu$L per min, and round your answer to three significant figures.", "solution": "We begin by formalizing the measurement and the maturation kinetics. The plate reader reports fluorescence $F(t)$ in arbitrary units (AU). Under linear response, the number of mature fluorescent molecules per unit volume is proportional to the background-subtracted fluorescence. With calibration factor $\\alpha$ in molecules per AU per $\\mu$L and background $F_{\\mathrm{blank}}$, the mature species abundance per $\\mu$L is\n$$\nM(t) = \\alpha \\left[F(t) - F_{\\mathrm{blank}}\\right].\n$$\n\nWe next model the maturation process. Let $U(t)$ denote the number of immature, nonfluorescent protein molecules per $\\mu$L. First-order maturation from $U$ to $M$ at rate constant $k_{\\mathrm{mat}}$ implies the kinetic equations\n$$\n\\frac{dU}{dt} = S(t) - k_{\\mathrm{mat}} U(t), \\quad \\frac{dM}{dt} = k_{\\mathrm{mat}} U(t),\n$$\nwhere $S(t)$ is the instantaneous synthesis rate (production rate of immature protein).\n\nWe eliminate $U(t)$ in favor of $M(t)$. From $\\frac{dM}{dt} = k_{\\mathrm{mat}} U(t)$ we have\n$$\nU(t) = \\frac{1}{k_{\\mathrm{mat}}} \\frac{dM}{dt}.\n$$\nDifferentiating this relation gives\n$$\n\\frac{dU}{dt} = \\frac{1}{k_{\\mathrm{mat}}} \\frac{d^{2}M}{dt^{2}}.\n$$\nSubstitute $U(t)$ and $\\frac{dU}{dt}$ into the equation for $\\frac{dU}{dt}$:\n$$\n\\frac{1}{k_{\\mathrm{mat}}} \\frac{d^{2}M}{dt^{2}} = S(t) - k_{\\mathrm{mat}} \\left( \\frac{1}{k_{\\mathrm{mat}}} \\frac{dM}{dt} \\right).\n$$\nRearrange to solve for $S(t)$:\n$$\nS(t) = \\frac{dM}{dt} + \\frac{1}{k_{\\mathrm{mat}}} \\frac{d^{2}M}{dt^{2}}.\n$$\nThus, the synthesis rate equals the sum of the first derivative of the mature species and a correction proportional to its second derivative, with proportionality $1/k_{\\mathrm{mat}}$.\n\nWe now compute $M(t)$ from the given fluorescence data. Background is $F_{\\mathrm{blank}} = 120$ AU and calibration is $\\alpha = 4.8 \\times 10^{9}$ molecules per AU per $\\mu$L. We will need $M(t)$ at $t = 45$ $\\mathrm{min}$, $t = 60$ $\\mathrm{min}$, and $t = 75$ $\\mathrm{min}$ to form central differences at $t = 60$ $\\mathrm{min}$.\n\nCompute background-subtracted fluorescence:\n- At $t = 45$ $\\mathrm{min}$: $F(45) = 840$ AU, so $F(45) - F_{\\mathrm{blank}} = 840 - 120 = 720$ AU.\n- At $t = 60$ $\\mathrm{min}$: $F(60) = 1200$ AU, so $F(60) - F_{\\mathrm{blank}} = 1200 - 120 = 1080$ AU.\n- At $t = 75$ $\\mathrm{min}$: $F(75) = 1440$ AU, so $F(75) - F_{\\mathrm{blank}} = 1440 - 120 = 1320$ AU.\n\nConvert to molecules per $\\mu$L:\n$$\nM(45) = \\alpha \\times 720 = \\left(4.8 \\times 10^{9}\\right) \\times 720 = 3.456 \\times 10^{12}\n$$\n$$\nM(60) = \\alpha \\times 1080 = \\left(4.8 \\times 10^{9}\\right) \\times 1080 = 5.184 \\times 10^{12}\n$$\n$$\nM(75) = \\alpha \\times 1320 = \\left(4.8 \\times 10^{9}\\right) \\times 1320 = 6.336 \\times 10^{12}\n$$\n\nLet the sampling interval be $\\Delta t = 15$ $\\mathrm{min}$. Using second-order central differences at $t = 60$ $\\mathrm{min}$, the first derivative is approximated by\n$$\n\\left.\\frac{dM}{dt}\\right|_{t=60} \\approx \\frac{M(75) - M(45)}{2 \\Delta t} = \\frac{6.336 \\times 10^{12} - 3.456 \\times 10^{12}}{2 \\times 15}.\n$$\nCompute the numerator: $6.336 \\times 10^{12} - 3.456 \\times 10^{12} = 2.880 \\times 10^{12}$. Therefore,\n$$\n\\left.\\frac{dM}{dt}\\right|_{t=60} \\approx \\frac{2.880 \\times 10^{12}}{30} = 9.60 \\times 10^{10} \\ \\text{molecules per } \\mu\\text{L per min}.\n$$\n\nThe second derivative is approximated by\n$$\n\\left.\\frac{d^{2}M}{dt^{2}}\\right|_{t=60} \\approx \\frac{M(45) - 2 M(60) + M(75)}{(\\Delta t)^{2}} = \\frac{3.456 \\times 10^{12} - 2 \\times 5.184 \\times 10^{12} + 6.336 \\times 10^{12}}{15^{2}}.\n$$\nCompute the numerator: $3.456 \\times 10^{12} - 10.368 \\times 10^{12} + 6.336 \\times 10^{12} = -0.576 \\times 10^{12} = -5.76 \\times 10^{11}$. The denominator is $225$. Thus,\n$$\n\\left.\\frac{d^{2}M}{dt^{2}}\\right|_{t=60} \\approx \\frac{-5.76 \\times 10^{11}}{225} = -2.56 \\times 10^{9} \\ \\text{molecules per } \\mu\\text{L per min}^{2}.\n$$\n\nWith $k_{\\mathrm{mat}} = 0.10$ $\\mathrm{min}^{-1}$, the synthesis rate at $t = 60$ $\\mathrm{min}$ is\n$$\nS(60) = \\left.\\frac{dM}{dt}\\right|_{t=60} + \\frac{1}{k_{\\mathrm{mat}}} \\left.\\frac{d^{2}M}{dt^{2}}\\right|_{t=60} = \\left(9.60 \\times 10^{10}\\right) + \\left(\\frac{1}{0.10}\\right)\\left(-2.56 \\times 10^{9}\\right).\n$$\nCompute the correction term: $\\frac{1}{0.10} = 10$, so $10 \\times \\left(-2.56 \\times 10^{9}\\right) = -2.56 \\times 10^{10}$. Therefore,\n$$\nS(60) = 9.60 \\times 10^{10} - 2.56 \\times 10^{10} = 7.04 \\times 10^{10}.\n$$\n\nRounded to three significant figures, the instantaneous synthesis rate at $t = 60$ $\\mathrm{min}$ is $7.04 \\times 10^{10}$ molecules per $\\mu$L per $\\mathrm{min}$.", "answer": "$$\\boxed{7.04 \\times 10^{10}}$$", "id": "2718570"}, {"introduction": "As we build more complex genetic circuits, the components inevitably compete for a finite pool of shared resources like RNA polymerase and ribosomes. This resource competition is a central challenge in synthetic biology. This final exercise [@problem_id:2718598] frames the design of a multi-gene system as a formal optimization problem, where you must allocate limited resources to maximize a weighted output. By formulating and solving this as a linear program, you will engage with a powerful engineering approach for designing and predicting the behavior of complex biological systems.", "problem": "In a cell-free transcription-translation (TX-TL) reaction, deoxyribonucleic acid (DNA) templates for multiple genes compete for a finite pool of RNA polymerase (RNAP) and ribosomes to produce proteins. According to the Central Dogma of molecular biology, information flows from DNA to ribonucleic acid (RNA) to protein. In a well-mixed batch TX-TL system, the total number of RNAP and ribosomes is limited and conserved during the time window of interest, and each gene’s protein production rate is jointly limited by transcriptional capacity (how much RNA is produced per RNAP allocated) and translational capacity (how many proteins are produced per ribosome allocated).\n\nConsider a coarse-grained, steady-state allocation model with the following elements:\n- There are $n$ genes indexed by $i \\in \\{1, \\dots, n\\}$.\n- Decision variables per gene $i$: $r_i \\ge 0$ (RNAP molecules allocated), $b_i \\ge 0$ (ribosomes allocated), and $p_i \\ge 0$ (steady-state protein production rate).\n- Parameters per gene $i$: $\\alpha_i > 0$ (transcription-to-protein effective rate in proteins per minute per RNAP), $\\beta_i > 0$ (translation rate in proteins per minute per ribosome), and $w_i > 0$ (non-dimensional priority weight).\n- Global resource constraints: $\\sum_{i=1}^{n} r_i \\le R_{\\mathrm{tot}}$ and $\\sum_{i=1}^{n} b_i \\le B_{\\mathrm{tot}}$, where $R_{\\mathrm{tot}}$ and $B_{\\mathrm{tot}}$ are the available RNAP and ribosome molecule counts, respectively.\n\nBiophysically, protein production is jointly limited by transcription and translation. A standard conservative approximation is to bound the per-gene rate by both steps:\n$$\np_i \\le \\alpha_i r_i, \\quad p_i \\le \\beta_i b_i, \\quad \\text{for all } i \\in \\{1,\\dots,n\\}.\n$$\nThe design goal is to allocate RNAP and ribosomes across genes to maximize a weighted sum of protein production rates:\n$$\n\\max_{p_i,r_i,b_i \\ge 0} \\;\\; \\sum_{i=1}^{n} w_i p_i\n$$\nsubject to the resource and per-gene capacity constraints above. All protein production rates $p_i$ are to be interpreted in proteins per minute, and $R_{\\mathrm{tot}}$ and $B_{\\mathrm{tot}}$ in molecule counts. The weights $w_i$ are dimensionless.\n\nYour task is to implement a program that, given specific parameter sets $\\{\\alpha_i\\}$, $\\{\\beta_i\\}$, $\\{w_i\\}$ and totals $R_{\\mathrm{tot}}$, $B_{\\mathrm{tot}}$, formulates and solves the linear program to return the optimal objective value\n$$\nJ^\\star = \\sum_{i=1}^{n} w_i p_i^\\star,\n$$\nexpressed in proteins per minute. For each test case below, output $J^\\star$ as a floating-point number rounded to six decimal places.\n\nUse the following test suite. For each case, $n$ is the number of genes, and all rates $\\alpha_i$ and $\\beta_i$ are in proteins per minute per RNAP and proteins per minute per ribosome, respectively. Totals $R_{\\mathrm{tot}}$ and $B_{\\mathrm{tot}}$ are molecule counts.\n\n- Case A:\n  - $n = 3$\n  - $\\alpha_1 = 0.3$, $\\alpha_2 = 0.1$, $\\alpha_3 = 0.2$\n  - $\\beta_1 = 0.05$, $\\beta_2 = 0.2$, $\\beta_3 = 0.08$\n  - $w_1 = 1.0$, $w_2 = 0.5$, $w_3 = 2.0$\n  - $R_{\\mathrm{tot}} = 40$, $B_{\\mathrm{tot}} = 120$\n\n- Case B (boundary with no resources):\n  - $n = 2$\n  - $\\alpha_1 = 0.2$, $\\alpha_2 = 0.2$\n  - $\\beta_1 = 0.1$, $\\beta_2 = 0.1$\n  - $w_1 = 1.0$, $w_2 = 1.0$\n  - $R_{\\mathrm{tot}} = 0$, $B_{\\mathrm{tot}} = 0$\n\n- Case C (dominant weight on a single gene):\n  - $n = 3$\n  - $\\alpha_1 = 0.25$, $\\alpha_2 = 0.15$, $\\alpha_3 = 0.05$\n  - $\\beta_1 = 0.02$, $\\beta_2 = 0.05$, $\\beta_3 = 0.03$\n  - $w_1 = 10.0$, $w_2 = 1.0$, $w_3 = 1.0$\n  - $R_{\\mathrm{tot}} = 50$, $B_{\\mathrm{tot}} = 100$\n\n- Case D (strongly transcription-limited regime):\n  - $n = 3$\n  - $\\alpha_1 = 0.01$, $\\alpha_2 = 0.02$, $\\alpha_3 = 0.015$\n  - $\\beta_1 = 0.2$, $\\beta_2 = 0.2$, $\\beta_3 = 0.2$\n  - $w_1 = 1.0$, $w_2 = 1.0$, $w_3 = 1.0$\n  - $R_{\\mathrm{tot}} = 30$, $B_{\\mathrm{tot}} = 1000$\n\n- Case E (strongly translation-limited regime):\n  - $n = 3$\n  - $\\alpha_1 = 0.2$, $\\alpha_2 = 0.25$, $\\alpha_3 = 0.22$\n  - $\\beta_1 = 0.005$, $\\beta_2 = 0.004$, $\\beta_3 = 0.006$\n  - $w_1 = 1.0$, $w_2 = 2.0$, $w_3 = 1.5$\n  - $R_{\\mathrm{tot}} = 500$, $B_{\\mathrm{tot}} = 30$\n\nFinal output format: your program should produce a single line of output containing the results for Cases A through E, in that order, as a comma-separated list enclosed in square brackets, with no spaces, for example $[x_A,x_B,x_C,x_D,x_E]$. Each entry must be a decimal representing $J^\\star$ in proteins per minute, rounded to six decimal places.", "solution": "The problem statement is submitted to validation.\n\n**Step 1: Extracted Givens**\n- Number of genes: $n$.\n- Decision variables: $r_i \\ge 0$ (RNAP molecules), $b_i \\ge 0$ (ribosomes), $p_i \\ge 0$ (protein production rate).\n- Parameters: $\\alpha_i > 0$ (transcription-to-protein rate), $\\beta_i > 0$ (translation rate), $w_i > 0$ (priority weight).\n- Resource constraints: $\\sum_{i=1}^{n} r_i \\le R_{\\mathrm{tot}}$, $\\sum_{i=1}^{n} b_i \\le B_{\\mathrm{tot}}$.\n- Production constraints: $p_i \\le \\alpha_i r_i$ and $p_i \\le \\beta_i b_i$ for all $i \\in \\{1, \\dots, n\\}$.\n- Objective: Maximize the weighted sum of protein production, $\\sum_{i=1}^{n} w_i p_i$.\n- Test cases with specific numerical values for all parameters are provided.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is assessed against the required criteria.\n- **Scientifically Grounded**: The model is a standard, albeit simplified, representation of resource competition in synthetic biology, rooted in the Central Dogma. The formulation is physically and biologically coherent.\n- **Well-Posed**: The problem is structured as a linear program (LP). The objective function is linear, and all constraints are linear inequalities. The feasible set is a convex polyhedron, and since resources are non-negative, it is non-empty and compact. Therefore, a solution exists and is well-defined.\n- **Objective**: The problem is stated using precise, unambiguous mathematical language.\n- The problem is self-contained, with no missing information or contradictions. It is formalizable, relevant, and scientifically verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be provided.\n\nThe problem is to solve the following optimization problem:\n$$\n\\max_{p_i, r_i, b_i \\ge 0} \\;\\; \\sum_{i=1}^{n} w_i p_i\n$$\nsubject to:\n$$\n\\begin{align*}\np_i &\\le \\alpha_i r_i, \\quad \\forall i \\in \\{1, \\dots, n\\} \\\\\np_i &\\le \\beta_i b_i, \\quad \\forall i \\in \\{1, \\dots, n\\} \\\\\n\\sum_{i=1}^{n} r_i &\\le R_{\\mathrm{tot}} \\\\\n\\sum_{i=1}^{n} b_i &\\le B_{\\mathrm{tot}}\n\\end{align*}\n$$\nThis is a linear program with $3n$ variables and $2n + 2$ constraints. We can simplify this formulation. The objective is to maximize a weighted sum of $p_i$ with positive weights $w_i > 0$. To achieve any non-zero production rate $p_i > 0$, the resource allocation must satisfy $r_i \\ge p_i / \\alpha_i$ and $b_i \\ge p_i / \\beta_i$. To maximize the objective, we must use resources as efficiently as possible. Therefore, at the optimum, any allocated resources will be minimal for the production rate they support, meaning $r_i^\\star = p_i^\\star / \\alpha_i$ and $b_i^\\star = p_i^\\star / \\beta_i$. We can substitute these expressions into the total resource constraints, eliminating the variables $r_i$ and $b_i$.\n\nThe optimization problem is reduced to an equivalent, more compact LP in terms of the $n$ variables $p_i$ only:\n$$\n\\max_{p_i \\ge 0} \\;\\; \\sum_{i=1}^{n} w_i p_i\n$$\nsubject to:\n$$\n\\begin{align*}\n\\sum_{i=1}^{n} \\frac{1}{\\alpha_i} p_i &\\le R_{\\mathrm{tot}} \\\\\n\\sum_{i=1}^{n} \\frac{1}{\\beta_i} p_i &\\le B_{\\mathrm{tot}}\n\\end{align*}\n$$\nThis is a standard LP formulation. This problem will be solved using the `linprog` function from the `scipy.optimize` library, which is a robust, well-established numerical solver for such problems. The `linprog` function is designed to solve minimization problems of the form:\n$$\n\\min_{x} \\;\\; c^T x\n$$\nsubject to $A_{ub} x \\le b_{ub}$ and $A_{eq} x = b_{eq}$, with bounds on $x$.\n\nTo match our problem to this format, we must perform the following transformations:\n$1$. The decision variable vector is $x = [p_1, p_2, \\dots, p_n]^T$.\n$2$. Maximizing $\\sum w_i p_i$ is equivalent to minimizing $-\\sum w_i p_i$. Therefore, the objective vector for the solver is $c = [-w_1, -w_2, \\dots, -w_n]^T$.\n$3$. The constraints are already in the form $A_{ub} x \\le b_{ub}$. The constraint matrix $A_{ub}$ is a $2 \\times n$ matrix, and the vector $b_{ub}$ has $2$ elements:\n$$\nA_{ub} = \\begin{pmatrix}\n1/\\alpha_1 & 1/\\alpha_2 & \\dots & 1/\\alpha_n \\\\\n1/\\beta_1 & 1/\\beta_2 & \\dots & 1/\\beta_n\n\\end{pmatrix}\n, \\quad\nb_{ub} = \\begin{pmatrix}\nR_{\\mathrm{tot}} \\\\\nB_{\\mathrm{tot}}\n\\end{pmatrix}\n$$\n$4$. The variables are non-negative, so the bounds for each $p_i$ are $[0, \\infty)$.\n\nThe solver will return an object containing the result. The optimal objective value of the minimization problem is `result.fun`. The optimal value for our original maximization problem is therefore $J^\\star = -(\\text{result.fun})$. The implementation will loop through each test case, construct the LP parameters $c$, $A_{ub}$, and $b_{ub}$ as defined, call the solver, and report the calculated optimal objective value, formatted to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"alphas\": [0.3, 0.1, 0.2],\n            \"betas\": [0.05, 0.2, 0.08],\n            \"weights\": [1.0, 0.5, 2.0],\n            \"R_tot\": 40.0,\n            \"B_tot\": 120.0,\n        },\n        # Case B (boundary with no resources)\n        {\n            \"alphas\": [0.2, 0.2],\n            \"betas\": [0.1, 0.1],\n            \"weights\": [1.0, 1.0],\n            \"R_tot\": 0.0,\n            \"B_tot\": 0.0,\n        },\n        # Case C (dominant weight on a single gene)\n        {\n            \"alphas\": [0.25, 0.15, 0.05],\n            \"betas\": [0.02, 0.05, 0.03],\n            \"weights\": [10.0, 1.0, 1.0],\n            \"R_tot\": 50.0,\n            \"B_tot\": 100.0,\n        },\n        # Case D (strongly transcription-limited regime)\n        {\n            \"alphas\": [0.01, 0.02, 0.015],\n            \"betas\": [0.2, 0.2, 0.2],\n            \"weights\": [1.0, 1.0, 1.0],\n            \"R_tot\": 30.0,\n            \"B_tot\": 1000.0,\n        },\n        # Case E (strongly translation-limited regime)\n        {\n            \"alphas\": [0.2, 0.25, 0.22],\n            \"betas\": [0.005, 0.004, 0.006],\n            \"weights\": [1.0, 2.0, 1.5],\n            \"R_tot\": 500.0,\n            \"B_tot\": 30.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        alphas = np.array(case[\"alphas\"])\n        betas = np.array(case[\"betas\"])\n        weights = np.array(case[\"weights\"])\n        R_tot = case[\"R_tot\"]\n        B_tot = case[\"B_tot\"]\n\n        # Objective function for minimization: c^T * x\n        # We maximize sum(w_i * p_i), which is equivalent to minimizing sum(-w_i * p_i).\n        c = -weights\n\n        # Inequality constraints: A_ub * x = b_ub\n        # Constraint 1: sum(p_i / alpha_i) = R_tot\n        # Constraint 2: sum(p_i / beta_i) = B_tot\n        A_ub = np.array([\n            1.0 / alphas,\n            1.0 / betas\n        ])\n        b_ub = np.array([R_tot, B_tot])\n\n        # Bounds for variables p_i are [0, infinity).\n        p_bounds = (0, None)\n\n        # Solve the linear program using the 'highs' method.\n        res = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=p_bounds, method='highs')\n\n        # The result from linprog is the minimum of the objective function.\n        # The maximum value for the original problem is the negative of this result.\n        if res.success:\n            # res.fun is the optimal value of the objective function for minimization.\n            optimal_value = -res.fun\n        else:\n            # Handle edge cases where the only feasible solution is zero, \n            # which might be flagged as a failure by the solver depending on the context.\n            if R_tot == 0.0 and B_tot == 0.0:\n                 optimal_value = 0.0\n            else:\n                 # In a well-posed problem like this, failure is unexpected. \n                 # However, we can use the reported (though non-optimal) value if it exists,\n                 # or default to 0. A robust implementation would log this event.\n                 optimal_value = -res.fun if res.fun is not None else 0.0\n\n        results.append(optimal_value)\n\n    # Format output as a comma-separated list in brackets, with each number\n    # formatted as a float with six decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2718598"}]}