{"hands_on_practices": [{"introduction": "Understanding complex genetic filters begins with analyzing their fundamental components. This first exercise focuses on a single-gene expression module, a ubiquitous building block in synthetic circuits. By deriving its steady-state behavior and frequency response, you will demonstrate how the interplay of protein production and degradation naturally creates a low-pass filter, a system that responds to slow signals but attenuates rapid fluctuations [@problem_id:2715245].", "problem": "Consider a single-gene production-degradation module often used as a low-pass stage within band-pass and band-stop genetic filters. The protein concentration is denoted by $x(t)$, the input transcriptional activator concentration is $u(t)$, the maximal production rate is $\\alpha$, the half-saturation constant is $K$, and the first-order degradation-dilution rate is $\\gamma$. The dynamics obey the ordinary differential equation\n$$\n\\dot{x}(t) \\;=\\; \\frac{\\alpha\\,u(t)}{K+u(t)} \\;-\\; \\gamma\\,x(t).\n$$\nStarting from the definitions of steady state and small-signal linearization, do the following:\n\n1) Derive the steady-state input-output relationship $x_{\\mathrm{ss}}(u)$ for a constant input $u(t)\\equiv u$.\n\n2) Fix a constant baseline input $u_{0} > 0$ that sets a steady state $x_{0}=x_{\\mathrm{ss}}(u_{0})$. Now consider a small sinusoidal perturbation $\\delta u(t)$ superimposed on $u_{0}$ so that $u(t)=u_{0}+\\delta u(t)$ with $\\delta u(t)$ sufficiently small in amplitude to justify a first-order Taylor expansion around $(u_{0},x_{0})$. Linearize the dynamics around the steady state and derive the frequency response magnitude $|G(j\\omega)|$ of the linearized input-output map from $\\delta u$ to $\\delta x$, evaluated at angular frequency $\\omega$ (in radians per unit time). Express $|G(j\\omega)|$ in terms of $\\alpha$, $K$, $\\gamma$, $u_{0}$, and $\\omega$.\n\nYour final answer should present the pair of expressions for $x_{\\mathrm{ss}}(u)$ and $|G(j\\omega)|$. No numerical evaluation is required, and no rounding is needed. The final answer must be given as two expressions in a single row matrix, in that order.", "solution": "The problem statement is scientifically grounded, well-posed, and complete. It presents a standard exercise in the analysis of dynamical systems in biology, specifically the derivation of steady-state behavior and the frequency response of a linearized model. There are no inconsistencies, ambiguities, or violations of fundamental principles. We proceed with the solution.\n\nThe dynamics of the protein concentration $x(t)$ are given by the ordinary differential equation:\n$$\n\\dot{x}(t) = \\frac{\\alpha u(t)}{K+u(t)} - \\gamma x(t)\n$$\nwhere $x(t)$ is the protein concentration, $u(t)$ is the input activator concentration, $\\alpha$ is the maximal production rate, $K$ is the half-saturation constant, and $\\gamma$ is the first-order degradation-dilution rate.\n\nPart 1: Derive the steady-state input-output relationship $x_{\\mathrm{ss}}(u)$.\nAt steady state, all time derivatives are zero, so $\\dot{x}(t) = 0$. The input is a constant value, which we denote as $u$. The protein concentration reaches a constant steady-state value, $x_{\\mathrm{ss}}$. Substituting these conditions into the governing equation gives:\n$$\n0 = \\frac{\\alpha u}{K+u} - \\gamma x_{\\mathrm{ss}}\n$$\nWe can now solve for $x_{\\mathrm{ss}}$ as a function of $u$.\n$$\n\\gamma x_{\\mathrm{ss}} = \\frac{\\alpha u}{K+u}\n$$\nIsolating $x_{\\mathrm{ss}}$ yields the steady-state input-output relationship:\n$$\nx_{\\mathrm{ss}}(u) = \\frac{\\alpha u}{\\gamma(K+u)}\n$$\n\nPart 2: Linearize the dynamics and derive the frequency response magnitude $|G(j\\omega)|$.\nWe linearize the system around a steady-state operating point $(u_0, x_0)$, where $u_0 > 0$ is a constant input and $x_0 = x_{\\mathrm{ss}}(u_0)$. The input and output signals are expressed as the sum of the steady-state values and small perturbations:\n$$\nu(t) = u_0 + \\delta u(t)\n$$\n$$\nx(t) = x_0 + \\delta x(t)\n$$\nSubstituting these into the original differential equation, we have:\n$$\n\\frac{d}{dt}(x_0 + \\delta x(t)) = \\frac{\\alpha (u_0 + \\delta u(t))}{K + (u_0 + \\delta u(t))} - \\gamma (x_0 + \\delta x(t))\n$$\nSince $x_0$ is a constant, its derivative is zero, so $\\frac{d}{dt}(x_0 + \\delta x(t)) = \\dot{\\delta x}(t)$. The equation becomes:\n$$\n\\dot{\\delta x}(t) = \\frac{\\alpha (u_0 + \\delta u(t))}{K + u_0 + \\delta u(t)} - \\gamma x_0 - \\gamma \\delta x(t)\n$$\nWe perform a first-order Taylor series expansion of the nonlinear production term $f(u) = \\frac{\\alpha u}{K+u}$ around $u=u_0$.\n$$\nf(u_0 + \\delta u(t)) \\approx f(u_0) + \\left. \\frac{df}{du} \\right|_{u=u_0} \\delta u(t)\n$$\nFirst, calculate the derivative of $f(u)$ with respect to $u$:\n$$\n\\frac{df}{du} = \\frac{d}{du}\\left(\\frac{\\alpha u}{K+u}\\right) = \\frac{\\alpha(K+u) - \\alpha u(1)}{(K+u)^2} = \\frac{\\alpha K}{(K+u)^2}\n$$\nEvaluating this derivative at $u_0$:\n$$\n\\left. \\frac{df}{du} \\right|_{u=u_0} = \\frac{\\alpha K}{(K+u_0)^2}\n$$\nThe expansion of the production term is:\n$$\n\\frac{\\alpha (u_0 + \\delta u(t))}{K + u_0 + \\delta u(t)} \\approx \\frac{\\alpha u_0}{K+u_0} + \\frac{\\alpha K}{(K+u_0)^2} \\delta u(t)\n$$\nSubstituting this back into the dynamic equation for the perturbations:\n$$\n\\dot{\\delta x}(t) \\approx \\left( \\frac{\\alpha u_0}{K+u_0} + \\frac{\\alpha K}{(K+u_0)^2} \\delta u(t) \\right) - \\gamma x_0 - \\gamma \\delta x(t)\n$$\nBy definition of the steady state, we know that $\\frac{\\alpha u_0}{K+u_0} - \\gamma x_0 = 0$. These terms cancel out, leaving the linearized equation for the perturbations:\n$$\n\\dot{\\delta x}(t) = \\frac{\\alpha K}{(K+u_0)^2} \\delta u(t) - \\gamma \\delta x(t)\n$$\nTo find the frequency response, we analyze this linear time-invariant (LTI) system in the frequency domain. We take the Laplace transform of the equation, letting $\\Delta X(s) = \\mathcal{L}\\{\\delta x(t)\\}$ and $\\Delta U(s) = \\mathcal{L}\\{\\delta u(t)\\}$.\n$$\ns \\Delta X(s) = \\frac{\\alpha K}{(K+u_0)^2} \\Delta U(s) - \\gamma \\Delta X(s)\n$$\nRearranging the terms to solve for the transfer function $G(s) = \\frac{\\Delta X(s)}{\\Delta U(s)}$:\n$$\ns \\Delta X(s) + \\gamma \\Delta X(s) = \\frac{\\alpha K}{(K+u_0)^2} \\Delta U(s)\n$$\n$$\n(s + \\gamma) \\Delta X(s) = \\frac{\\alpha K}{(K+u_0)^2} \\Delta U(s)\n$$\n$$\nG(s) = \\frac{\\Delta X(s)}{\\Delta U(s)} = \\frac{\\frac{\\alpha K}{(K+u_0)^2}}{s + \\gamma}\n$$\nThe frequency response $G(j\\omega)$ is obtained by substituting $s = j\\omega$, where $j$ is the imaginary unit and $\\omega$ is the angular frequency.\n$$\nG(j\\omega) = \\frac{\\frac{\\alpha K}{(K+u_0)^2}}{j\\omega + \\gamma}\n$$\nWe are asked for the magnitude of the frequency response, $|G(j\\omega)|$. The magnitude of a complex number of the form $\\frac{A}{B}$ is $\\frac{|A|}{|B|}$. The numerator is a real, positive constant since $\\alpha > 0$, $K > 0$, and $u_0 > 0$. The magnitude of the complex denominator $\\gamma+j\\omega$ is $\\sqrt{\\gamma^2 + \\omega^2}$.\n$$\n|G(j\\omega)| = \\frac{\\left| \\frac{\\alpha K}{(K+u_0)^2} \\right|}{|\\gamma + j\\omega|} = \\frac{\\frac{\\alpha K}{(K+u_0)^2}}{\\sqrt{\\gamma^2 + \\omega^2}}\n$$\nThis simplifies to:\n$$\n|G(j\\omega)| = \\frac{\\alpha K}{(K+u_0)^2 \\sqrt{\\gamma^2 + \\omega^2}}\n$$\nThis expression represents the gain of the linearized system for a sinusoidal input perturbation of frequency $\\omega$. It shows the characteristic low-pass filter behavior, where the gain decreases as the frequency $\\omega$ increases.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha u}{\\gamma(K+u)} & \\frac{\\alpha K}{(K+u_0)^{2} \\sqrt{\\gamma^{2} + \\omega^{2}}}\n\\end{pmatrix}\n}\n$$", "id": "2715245"}, {"introduction": "With an understanding of low-pass filtering, we can now construct a more sophisticated device. This practice explores the incoherent type-1 feed-forward loop (I1-FFL), a classic network motif that acts as a band-pass filter [@problem_id:2715264]. You will derive how the combination of a fast activating pathway and a slow, filtered repressive pathway enables the circuit to respond selectively to signals of an intermediate frequency, a key principle in designing dynamic cellular behaviors.", "problem": "An incoherent type-$1$ feed-forward loop (I1-FFL) is a three-node genetic motif in which an input transcription factor $x$ activates both an intermediate regulator $v$ and an output gene product $z$, while $v$ represses $z$. Consider small perturbations about a stable steady state so that linear response theory applies. Let $v$ and $z$ denote deviations from steady state of the corresponding species concentrations, and let $x$ denote a small deviation of the input transcription factor concentration. Assume first-order production and decay around the operating point so that the small-signal dynamics are governed by\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x, \\quad \\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v,\n$$\nwhere $\\gamma_{v}>0$ and $\\gamma_{z}>0$ are effective first-order dilution-degradation rates (equivalently, inverse characteristic times), and $k_{v}>0$, $k_{x}>0$, $k_{vz}>0$ are effective small-signal gains arising from linearization of regulatory interactions. Let $G(s)$ denote the transfer function from $x$ to $z$ in the Laplace domain, and let $|G(j\\omega)|$ denote its magnitude at angular frequency $\\omega$.\n\nStarting from the Central Dogma of Molecular Biology and first-order mass-action degradation, and using linear system theory as a well-tested analytical framework for small perturbations in genetic circuits, do the following:\n\n- Derive $G(s)$ for the I1-FFL described above.\n- From first principles, derive the condition under which the steady-state (zero-frequency) small-signal gain is exactly zero (perfect adaptation of $z$ to a step in $x$).\n- Under that condition, determine whether $|G(j\\omega)|$ exhibits a peak at a finite nonzero frequency and, if it does, compute the angular frequency $\\omega_{\\text{peak}}$ at which the magnitude attains its maximum. Express $\\omega_{\\text{peak}}$ in terms of $\\gamma_{v}$ and $\\gamma_{z}$. Use radians as the unit for angular frequency.\n\nYour final reported answer must be a single closed-form expression for $\\omega_{\\text{peak}}$ in terms of $\\gamma_{v}$ and $\\gamma_{z}$. Do not include units in the final boxed answer, and do not round or approximate the expression.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It describes a canonical incoherent type-1 feed-forward loop (I1-FFL) and asks for an analysis of its small-signal frequency response under the condition of perfect adaptation. The use of linearized dynamics and transfer function analysis is a standard and appropriate methodology for this task. We shall proceed with the solution.\n\nThe system dynamics are given by the following set of linear ordinary differential equations:\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x\n$$\n$$\n\\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v\n$$\nwhere all parameters $\\gamma_v, \\gamma_z, k_v, k_x, k_{vz}$ are positive constants.\n\nOur first task is to derive the transfer function $G(s)$ from the input $x$ to the output $z$. We apply the Laplace transform to the system of equations, assuming zero initial conditions. Let $X(s)$, $V(s)$, and $Z(s)$ be the Laplace transforms of $x(t)$, $v(t)$, and $z(t)$, respectively.\nThe transformed equations are:\n$$\nsV(s) = -\\gamma_{v} V(s) + k_{v} X(s)\n$$\n$$\nsZ(s) = -\\gamma_{z} Z(s) + k_{x} X(s) - k_{vz} V(s)\n$$\nFrom the first equation, we solve for $V(s)$ in terms of $X(s)$:\n$$\n(s + \\gamma_{v}) V(s) = k_{v} X(s) \\implies V(s) = \\frac{k_{v}}{s + \\gamma_{v}} X(s)\n$$\nNext, we substitute this expression for $V(s)$ into the second transformed equation:\n$$\n(s + \\gamma_{z}) Z(s) = k_{x} X(s) - k_{vz} \\left( \\frac{k_{v}}{s + \\gamma_{v}} \\right) X(s)\n$$\nThe transfer function $G(s)$ is defined as the ratio $Z(s)/X(s)$. We rearrange the equation to find this ratio:\n$$\nG(s) = \\frac{Z(s)}{X(s)} = \\frac{1}{s + \\gamma_{z}} \\left( k_{x} - \\frac{k_{vz} k_{v}}{s + \\gamma_{v}} \\right)\n$$\nTo express this as a single rational function, we find a common denominator:\n$$\nG(s) = \\frac{k_{x}(s + \\gamma_{v}) - k_{vz} k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\nThis is the required transfer function from $x$ to $z$.\n\nThe second task is to find the condition for perfect adaptation. Perfect adaptation implies that the steady-state response of the output $z$ to a constant step change in the input $x$ is zero. In the context of linear systems, this corresponds to the steady-state gain, or zero-frequency gain, being zero. The steady-state gain is given by $G(s)$ evaluated at $s=0$.\n$$\nG(0) = \\frac{k_{x}(0) + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(0 + \\gamma_{z})(0 + \\gamma_{v})} = \\frac{k_{x}\\gamma_{v} - k_{vz}k_{v}}{\\gamma_{z}\\gamma_{v}}\n$$\nFor perfect adaptation, we must have $G(0) = 0$. Since $\\gamma_z > 0$ and $\\gamma_v > 0$, the denominator is non-zero. Thus, the numerator must be zero:\n$$\nk_{x}\\gamma_{v} - k_{vz}k_{v} = 0\n$$\nThis yields the condition for perfect adaptation:\n$$\nk_{x}\\gamma_{v} = k_{vz}k_{v}\n$$\n\nThe final task is to determine the peak frequency of the magnitude response $|G(j\\omega)|$ under the condition of perfect adaptation. We substitute the condition $k_{x}\\gamma_{v} = k_{vz}k_{v}$ back into the expression for $G(s)$:\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{x}\\gamma_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})} = \\frac{k_{x}s}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\nThis transfer function has a zero at the origin ($s=0$) and two real poles at $s=-\\gamma_z$ and $s=-\\gamma_v$. This structure is characteristic of a band-pass filter. The gain is zero at $\\omega=0$ and as $\\omega \\to \\infty$, which implies that if a maximum exists for $\\omega > 0$, it must occur at a finite, non-zero frequency.\n\nTo find this peak frequency, $\\omega_{\\text{peak}}$, we analyze the magnitude of the frequency response, $|G(j\\omega)|$. We obtain the frequency response by setting $s=j\\omega$:\n$$\nG(j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})}\n$$\nThe squared magnitude is easier to work with for maximization:\n$$\n|G(j\\omega)|^2 = G(j\\omega)G(-j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})} \\cdot \\frac{k_{x}(-j\\omega)}{(-j\\omega + \\gamma_{z})(-j\\omega + \\gamma_{v})}\n$$\n$$\n|G(j\\omega)|^2 = \\frac{k_{x}^2 \\omega^2}{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}\n$$\nThe frequency $\\omega_{\\text{peak}}$ that maximizes $|G(j\\omega)|$ also maximizes $|G(j\\omega)|^2$. To find this maximum, we can minimize the reciprocal of the frequency-dependent part of $|G(j\\omega)|^2$. Let us define a function $H(\\omega)$:\n$$\nH(\\omega) = \\frac{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}{\\omega^2}\n$$\nWe seek to find the value of $\\omega > 0$ that minimizes $H(\\omega)$. Expanding the numerator and dividing by $\\omega^2$ gives:\n$$\nH(\\omega) = \\frac{\\omega^4 + (\\gamma_{z}^2 + \\gamma_{v}^2)\\omega^2 + \\gamma_{z}^2\\gamma_{v}^2}{\\omega^2} = \\omega^2 + (\\gamma_{z}^2 + \\gamma_{v}^2) + \\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^2}\n$$\nTo find the minimum, we compute the derivative of $H(\\omega)$ with respect to $\\omega$ and set it to zero:\n$$\n\\frac{dH}{d\\omega} = 2\\omega - 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\nSetting the derivative to zero for $\\omega \\neq 0$:\n$$\n2\\omega = 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\n$$\n\\omega^4 = \\gamma_{z}^2\\gamma_{v}^2\n$$\nSince $\\omega$ must be a real, positive frequency, we take the positive square root twice:\n$$\n\\omega^2 = \\sqrt{\\gamma_{z}^2\\gamma_{v}^2} = \\gamma_{z}\\gamma_{v} \\quad (\\text{since } \\gamma_z > 0, \\gamma_v > 0)\n$$\n$$\n\\omega = \\sqrt{\\gamma_{z}\\gamma_{v}}\n$$\nThis stationary point corresponds to a minimum for $H(\\omega)$ (and thus a maximum for $|G(j\\omega)|^2$) because the second derivative $\\frac{d^2H}{d\\omega^2} = 2 + 6\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^4}$ is strictly positive for all real $\\omega \\neq 0$. Therefore, the peak angular frequency is the geometric mean of the two degradation rates.\n$$\n\\omega_{\\text{peak}} = \\sqrt{\\gamma_{v}\\gamma_{z}}\n$$", "answer": "$$\\boxed{\\sqrt{\\gamma_{v}\\gamma_{z}}}$$", "id": "2715264"}, {"introduction": "Analytical derivations provide powerful insights, but the quantitative characterization of a specific design requires computation. This final practice challenges you to bridge theory and application by numerically analyzing a band-pass filter model [@problem_id:2715289]. By implementing the frequency response calculation in code, you will extract key performance metrics like the peak frequency and bandwidth, translating abstract mathematical descriptions into concrete engineering specifications for a synthetic circuit.", "problem": "You are given a small-signal, linearized model for a genetic network implementing an adaptive incoherent feed-forward motif that acts as a band-pass filter on small perturbations of an input inducer concentration. The derivation should start from the fundamental base that biochemical reaction networks near a stable steady state can be approximated by linear ordinary differential equations (ODEs) obtained by small-signal linearization of mass-action or Hill-type kinetics, and that the frequency response of a linear time-invariant (LTI) system can be computed by applying the Laplace transform and evaluating the resulting transfer function on the imaginary axis. The model consists of two internal states whose production and degradation are first-order in the small-signal limit, and an output defined as a difference of two internal species to encode incoherent feed-forward action. Specifically, let $u(t)$ denote the small-signal input, $x(t)$ and $z(t)$ denote internal small-signal states (e.g., transcription factor activities), and $y(t)$ denote the small-signal output (e.g., reporter fluorescence in linear units). The linearized dynamics are\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\nwhere $\\alpha > 0$ and $\\gamma > 0$ are effective first-order degradation or dilution rates (in $\\mathrm{s}^{-1}$), and $\\beta > 0$ and $\\delta \\ge 0$ are effective production gains (with units chosen so that $y$ is dimensionless in the small-signal normalization). Perfect adaptation at zero frequency occurs when the steady-state gains of the two incoherent paths balance, which corresponds to a condition on parameters that you should recover during the derivation. Your task is to compute the frequency response magnitude of this LTI system by first deriving the transfer function $G(s)$ from $u$ to $y$ using first principles (Laplace transform of the ODEs, linear algebraic solution for the output-to-input ratio), and then evaluating $|G(j\\omega)|$ numerically across a logarithmic grid of angular frequencies covering three decades.\n\nFor each parameter set provided in the test suite, do the following:\n- Derive the transfer function $G(s)$ from the given ODEs without invoking any pre-memorized filter formulas, and write $|G(j\\omega)|$ as a function of $\\omega$, $\\alpha$, $\\beta$, $\\gamma$, and $\\delta$.\n- For numerical evaluation, define an estimated center frequency as $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha\\,\\gamma}$ (in $\\mathrm{s}^{-1}$). Construct a logarithmically spaced grid of $N = 121$ angular frequencies $\\omega_k$ spanning exactly three decades centered on $\\omega_0^{\\mathrm{est}}$ by choosing\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}} \\sqrt{1000},\n$$\nand sampling $N$ points uniformly in $\\log_{10} \\omega$ between $\\log_{10}\\omega_{\\min}$ and $\\log_{10}\\omega_{\\max}$.\n- Compute $|G(j\\omega_k)|$ at each grid point.\n- Identify the peak magnitude $|G|_{\\max}$ and the corresponding frequency $\\omega_0$ at which the peak occurs (if the peak falls between grid points, use the grid point of maximum magnitude; no sub-grid optimization is required).\n- Define the half-power magnitude threshold $|G|_{\\mathrm{hp}} = |G|_{\\max} / \\sqrt{2}$. Identify the lower cutoff frequency $\\omega_L$ and upper cutoff frequency $\\omega_H$ as the frequencies on the left and right of $\\omega_0$, respectively, where $|G(j\\omega)|$ crosses $|G|_{\\mathrm{hp}}$. Use linear interpolation in $\\log_{10}\\omega$ against $\\ln |G|$ between the two nearest sampled points that straddle the threshold on each side to estimate $\\omega_L$ and $\\omega_H$. If a cutoff lies outside the sampled range, treat that case as ill-posed; however, the provided test suite avoids such cases.\n- Express all frequencies in $\\mathrm{s}^{-1}$, rounded to six decimal places.\n\nTest Suite (each case is given as $(\\alpha, \\gamma, \\beta, \\delta)$, all in $\\mathrm{s}^{-1}$):\n1. (Case A) $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$.\n2. (Case B) $(\\alpha, \\gamma, \\beta, \\delta) = (0.1, 0.1, 1.0, 0.1)$.\n3. (Case C) $(\\alpha, \\gamma, \\beta, \\delta) = (0.005, 0.5, 2.0, 0.5)$.\n4. (Case D) Imperfect adaptation: $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.198)$.\n\nYour program must compute, for each test case, the triplet $[\\omega_L, \\omega_0, \\omega_H]$ in $\\mathrm{s}^{-1}$, each rounded to six decimal places, using the procedure above. Your program should produce a single line of output containing the results as a comma-separated Python-style list of lists, in the order of the test suite, for example:\n[[wL_A,w0_A,wH_A],[wL_B,w0_B,wH_B],[wL_C,w0_C,wH_C],[wL_D,w0_D,wH_D]]\nNo additional text should be printed.", "solution": "We begin from the principle that near a stable steady state, biochemical reaction networks governed by mass-action or saturating Hill kinetics can be approximated by linear ordinary differential equations (ODEs) describing small-signal deviations. For linear time-invariant (LTI) systems, the frequency response is captured by the transfer function $G(s)$, which is the Laplace-domain ratio of output to input, evaluated at $s = j\\omega$ for sinusoidal steady-state analysis. This approach is grounded in the linear systems theory and the validity of the Laplace transform for stable linear ODEs.\n\nGiven the linearized dynamics\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\nwe apply the Laplace transform (with zero initial conditions appropriate for frequency response) to obtain\n$$\ns X(s) = -\\alpha X(s) + \\beta U(s), \\quad\ns Z(s) = -\\gamma Z(s) + \\delta X(s), \\quad\nY(s) = X(s) - Z(s).\n$$\nSolving the first equation yields\n$$\nX(s) = \\frac{\\beta}{s + \\alpha} U(s).\n$$\nSubstituting into the second yields\n$$\nZ(s) = \\frac{\\delta}{s + \\gamma} X(s) = \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} U(s).\n$$\nThus,\n$$\nY(s) = X(s) - Z(s) = \\left( \\frac{\\beta}{s + \\alpha} - \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} \\right) U(s) = \\frac{\\beta\\big[(s+\\gamma) - \\delta\\big]}{(s+\\alpha)(s+\\gamma)} U(s).\n$$\nTherefore, the transfer function is\n$$\nG(s) \\equiv \\frac{Y(s)}{U(s)} = \\frac{\\beta\\big(s + \\gamma - \\delta\\big)}{(s + \\alpha)(s + \\gamma)}.\n$$\nTwo key facts follow:\n- The zero-frequency (steady-state) gain is $G(0) = \\dfrac{\\beta(\\gamma - \\delta)}{\\alpha \\gamma}$, which vanishes under the perfect adaptation condition $\\delta = \\gamma$, yielding a high-pass characteristic at low frequency.\n- The poles at $s = -\\alpha$ and $s = -\\gamma$ define a two-pole low-pass behavior at high frequency. Combined with the low-frequency zero under $\\delta = \\gamma$, this creates a band-pass response. The qualitative band-pass behavior persists when $\\delta$ is close (but not equal) to $\\gamma$, albeit with finite low-frequency gain.\n\nTo compute the magnitude response, evaluate at $s = j\\omega$:\n$$\nG(j\\omega) = \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)}.\n$$\nThe magnitude is then\n$$\n\\left|G(j\\omega)\\right| = \\left| \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)} \\right|.\n$$\nFor the perfect adaptation case $\\delta = \\gamma$, this simplifies to\n$$\n\\left|G(j\\omega)\\right| = \\frac{\\beta\\, \\omega}{\\sqrt{(\\omega^2 + \\alpha^2)(\\omega^2 + \\gamma^2)}}.\n$$\nHowever, to preserve generality we will use the unsimplified expression in the numerical algorithm.\n\nNumerical algorithm design:\n1. For each parameter set $(\\alpha, \\gamma, \\beta, \\delta)$, define an estimated center frequency $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha \\gamma}$ based on the geometric mean of the pole rates. This is motivated by the observation that many second-order band-pass systems with separated first-order processes exhibit peak magnitude near the geometric mean of their dominant rates.\n2. Construct a logarithmic grid of $N = 121$ points spanning exactly three decades centered on $\\omega_0^{\\mathrm{est}}$ by taking\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}}\\sqrt{1000},\n$$\nand sampling uniformly in $\\log_{10}\\omega$ between these bounds. This symmetric log-span ensures coverage around the anticipated peak for a wide range of $(\\alpha,\\gamma)$.\n3. Evaluate $\\left|G(j\\omega_k)\\right|$ on the grid using the exact complex expression. Identify the discrete peak magnitude and its frequency $\\omega_0$ by taking the grid point with maximum magnitude.\n4. Compute the half-power threshold $|G|_{\\mathrm{hp}} = |G|_{\\max}/\\sqrt{2}$. To determine the lower cutoff $\\omega_L$, find consecutive grid indices $(k,k+1)$ on the left of the peak where $\\left|G(j\\omega_k)\\right| \\le |G|_{\\mathrm{hp}}$ and $\\left|G(j\\omega_{k+1})\\right| \\ge |G|_{\\mathrm{hp}}$. Similarly, for the upper cutoff $\\omega_H$, find consecutive indices $(k,k+1)$ on the right of the peak where the magnitude crosses the threshold in the opposite direction. Perform linear interpolation in $\\log_{10}\\omega$ against $\\ln\\left|G\\right|$ for numerical stability:\n   - Let $x = \\log_{10}\\omega$ and $y = \\ln\\left|G\\right|$. If the threshold is $y^\\star = \\ln(|G|_{\\mathrm{hp}})$ and it lies between $(x_0,y_0)$ and $(x_1,y_1)$, estimate the crossing at\n     $$\n     x^\\star = x_0 + (x_1 - x_0)\\frac{y^\\star - y_0}{y_1 - y_0}, \\quad \\omega^\\star = 10^{x^\\star}.\n     $$\n   This interpolation balances the wide dynamic range of both frequency and magnitude typically encountered in biological filter responses.\n5. Round $\\omega_L$, $\\omega_0$, and $\\omega_H$ to six decimal places. All frequencies are in $\\mathrm{s}^{-1}$.\n\nApplication to the test suite:\n- Case A $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$ matches perfect adaptation with separated time scales, yielding a clear band-pass with peak near $\\omega_0 \\approx \\sqrt{0.02 \\cdot 0.2}$.\n- Case B $(0.1, 0.1, 1.0, 0.1)$ has identical rates, producing a symmetric response with peak near $\\omega_0 \\approx 0.1$.\n- Case C $(0.005, 0.5, 2.0, 0.5)$ increases the gain and widens the pole separation, affecting the peak magnitude but not the cutoff locations strongly in relative terms.\n- Case D $(0.02, 0.2, 1.0, 0.198)$ slightly perturbs the perfect adaptation condition, introducing a finite low-frequency gain while maintaining a well-defined band-pass with identifiable $-3\\,\\mathrm{dB}$ cutoff frequencies.\n\nThe accompanying program implements this algorithm precisely and outputs a single Python-style list of the triplets $[\\omega_L, \\omega_0, \\omega_H]$ for the four cases, rounded to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef magnitude_G(omega, alpha, gamma, beta, delta):\n    \"\"\"\n    Compute |G(j*omega)| for the linearized genetic band-pass model:\n    G(s) = beta * (s + gamma - delta) / ((s + alpha) * (s + gamma))\n    \"\"\"\n    s = 1j * omega\n    num = beta * (s + (gamma - delta))\n    den = (s + alpha) * (s + gamma)\n    G = num / den\n    return np.abs(G)\n\ndef find_cutoff_log_interp(freqs, mags, peak_index):\n    \"\"\"\n    Find omega_L and omega_H as -3 dB cutoffs around the peak magnitude.\n    Interpolate linearly in log10(freq) vs ln(mag).\n    \"\"\"\n    peak_mag = mags[peak_index]\n    target = peak_mag / np.sqrt(2.0)\n    ln_target = np.log(target)\n    logf = np.log10(freqs)\n    lnm = np.log(mags)\n\n    # Find left cutoff: increasing magnitude on the left\n    omega_L = None\n    for k in range(peak_index - 1, -1, -1):\n        if mags[k] <= target <= mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_L = 10.0 ** x_star\n            break\n\n    # Find right cutoff: decreasing magnitude on the right\n    omega_H = None\n    n = len(freqs)\n    for k in range(peak_index, n - 1):\n        if mags[k] >= target >= mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_H = 10.0 ** x_star\n            break\n\n    return omega_L, omega_H\n\ndef analyze_case(alpha, gamma, beta, delta, N=121):\n    # Estimated center frequency based on pole geometric mean\n    omega0_est = np.sqrt(alpha * gamma)\n    # Three decades total span centered on omega0_est\n    span = np.sqrt(1000.0)\n    wmin = omega0_est / span\n    wmax = omega0_est * span\n    freqs = np.logspace(np.log10(wmin), np.log10(wmax), N)\n\n    mags = magnitude_G(freqs, alpha, gamma, beta, delta)\n\n    # Identify discrete peak\n    peak_index = int(np.argmax(mags))\n    omega0 = freqs[peak_index]\n\n    # Find -3 dB cutoffs\n    omega_L, omega_H = find_cutoff_log_interp(freqs, mags, peak_index)\n\n    # Round to six decimals as required\n    def rnd(x):\n        return round(float(x), 6)\n\n    return rnd(omega_L), rnd(omega0), rnd(omega_H)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (alpha, gamma, beta, delta) in s^-1\n    test_cases = [\n        (0.02, 0.2, 1.0, 0.2),     # Case A: perfect adaptation\n        (0.1, 0.1, 1.0, 0.1),      # Case B: equal rates\n        (0.005, 0.5, 2.0, 0.5),    # Case C: wider separation, higher gain\n        (0.02, 0.2, 1.0, 0.198),   # Case D: imperfect adaptation\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, gamma, beta, delta = case\n        wL, w0, wH = analyze_case(alpha, gamma, beta, delta, N=121)\n        results.append([wL, w0, wH])\n\n    # Final print statement in the exact required format.\n    # Python-style list of lists with comma-separated entries, single line.\n    print(str(results))\n\nsolve()\n```", "id": "2715289"}]}