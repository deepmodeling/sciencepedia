{"hands_on_practices": [{"introduction": "A fundamental challenge in genome refactoring is to redesign sequences to meet multiple, often competing, design specifications. This exercise simulates a common scenario where a genomic region with overlapping reading frames must be altered to remove an undesirable sequence motif, such as a restriction site, without changing the amino acid sequences of the encoded proteins. Solving this puzzle-like constraint satisfaction problem [@problem_id:2787320] develops the logical and algorithmic thinking required for practical sequence engineering in synthetic genomics.", "problem": "In whole-genome synthesis and refactoring, sequence engineering often requires removing prohibited motifs (for example, the Escherichia coli restriction endonuclease I (EcoRI) recognition site) while preserving encoded proteins, even across overlapping reading frames. Consider a $7$-nucleotide genomic window with two overlapping genes, one read in the zero frame and one read in the $+1$ frame. Let the nucleotide sequence be $S = s_{1}s_{2}s_{3}s_{4}s_{5}s_{6}s_{7} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$. The following coding relationships hold by the Central Dogma and the standard genetic code:\n\n- Zero frame (frame $0$): codon $s_{1}s_{2}s_{3}$ encodes arginine, and codon $s_{4}s_{5}s_{6}$ encodes isoleucine.\n- Plus-one frame (frame $+1$): codon $s_{2}s_{3}s_{4}$ encodes glutamate, and codon $s_{5}s_{6}s_{7}$ encodes phenylalanine.\n\nUse the standard genetic code degeneracy:\n- Arginine (Arg): $\\{\\mathrm{C}\\mathrm{G}\\mathrm{T}, \\mathrm{C}\\mathrm{G}\\mathrm{C}, \\mathrm{C}\\mathrm{G}\\mathrm{A}, \\mathrm{C}\\mathrm{G}\\mathrm{G}, \\mathrm{A}\\mathrm{G}\\mathrm{A}, \\mathrm{A}\\mathrm{G}\\mathrm{G}\\}$.\n- Isoleucine (Ile): $\\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$.\n- Glutamate (Glu): $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$.\n- Phenylalanine (Phe): $\\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$.\n\nA prohibited motif, the EcoRI site $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$, currently spans positions $2$ through $7$ of $S$. You are tasked with modeling the synonymous recoding of $S$ as a constraint satisfaction problem in which each position $s_{i}$ is a variable over $\\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$ subject to:\n- Preservation of both protein sequences (the zero-frame amino acids remain arginine and isoleucine at $s_{1}s_{2}s_{3}$ and $s_{4}s_{5}s_{6}$, respectively; the $+1$-frame amino acids remain glutamate and phenylalanine at $s_{2}s_{3}s_{4}$ and $s_{5}s_{6}s_{7}$, respectively).\n- Elimination of the EcoRI site across $s_{2}\\dots s_{7}$.\n\nAssume that recoding is allowed only within this $7$-nucleotide window, and fix $s_{1}$ to its original value to avoid extraneous degrees of freedom. Define $m$ as the minimal number of nucleotide substitutions within positions $2$ through $7$ required to eliminate the motif while satisfying all coding constraints, and let $N(m)$ be the number of distinct sequences within this window that achieve exactly $m$ substitutions and satisfy all constraints. Compute $N(m)$. Provide your answer as a single integer with no units. No rounding is required.", "solution": "The problem presented is a well-posed constraint satisfaction problem grounded in the principles of molecular biology and gene synthesis. It is internally consistent, scientifically sound, and contains all necessary information for a unique solution. Therefore, the problem is valid, and a full solution will be provided.\n\nThe objective is to find the number of distinct sequences, $N(m)$, that can be formed by recoding a $7$-nucleotide window $S = s_{1}s_{2}s_{3}s_{4}s_{5}s_{6}s_{7} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$. This recoding must satisfy a set of constraints, and $m$ represents the minimal number of nucleotide substitutions within positions $2$ through $7$ required to do so.\n\nLet the new sequence be denoted by $S' = s'_{1}s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7}$. The constraints are as follows:\n\n1.  The first nucleotide is fixed: $s'_{1} = \\mathrm{A}$.\n2.  The protein sequence in frame $0$ is preserved:\n    -   Codon $s'_{1}s'_{2}s'_{3}$ must encode Arginine (Arg). The set of synonymous codons for Arg is $\\{\\mathrm{C}\\mathrm{G}\\mathrm{T}, \\mathrm{C}\\mathrm{G}\\mathrm{C}, \\mathrm{C}\\mathrm{G}\\mathrm{A}, \\mathrm{C}\\mathrm{G}\\mathrm{G}, \\mathrm{A}\\mathrm{G}\\mathrm{A}, \\mathrm{A}\\mathrm{G}\\mathrm{G}\\}$.\n    -   Codon $s'_{4}s'_{5}s'_{6}$ must encode Isoleucine (Ile). The set of synonymous codons for Ile is $\\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$.\n3.  The protein sequence in frame $+1$ is preserved:\n    -   Codon $s'_{2}s'_{3}s'_{4}$ must encode Glutamate (Glu). The set of synonymous codons for Glu is $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$.\n    -   Codon $s'_{5}s'_{6}s'_{7}$ must encode Phenylalanine (Phe). The set of synonymous codons for Phe is $\\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$.\n4.  The EcoRI restriction site is eliminated: The subsequence $s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7}$ cannot be $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$.\n\nWe will systematically resolve these constraints.\n\nFirst, consider the codon $s'_{1}s'_{2}s'_{3}$ for Arg. Since $s'_{1}$ is fixed as $\\mathrm{A}$, we filter the set of Arg codons for those beginning with $\\mathrm{A}$. This leaves us with $\\{\\mathrm{A}\\mathrm{G}\\mathrm{A}, \\mathrm{A}\\mathrm{G}\\mathrm{G}\\}$. This implies that $s'_{2}$ must be $\\mathrm{G}$ and $s'_{3}$ must be in the set $\\{\\mathrm{A}, \\mathrm{G}\\}$.\n\nNext, we incorporate the constraint on the overlapping codon $s'_{2}s'_{3}s'_{4}$ for Glu, for which the choices are $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$.\n-   If we hypothesize $s'_{2}s'_{3} = \\mathrm{G}\\mathrm{A}$, then the Glu codon is $\\mathrm{G}\\mathrm{A}s'_{4}$. For this to be a valid Glu codon, $s'_{4}$ must be in $\\{\\mathrm{A}, \\mathrm{G}\\}$. This is a consistent possibility.\n-   If we hypothesize $s'_{2}s'_{3} = \\mathrm{G}\\mathrm{G}$, the Glu codon would be $\\mathrm{G}\\mathrm{G}s'_{4}$. This cannot match either of the valid Glu codons, $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$. This hypothesis is therefore invalid.\nSo, we must have $s'_{2} = \\mathrm{G}$ and $s'_{3} = \\mathrm{A}$. This also implies that $s'_{4} \\in \\{\\mathrm{A}, \\mathrm{G}\\}$.\n\nNow, we analyze the codon $s'_{4}s'_{5}s'_{6}$ for Ile. The synonymous codons are $\\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$. All of these codons begin with the nucleotide $\\mathrm{A}$. Therefore, $s'_{4}$ must be $\\mathrm{A}$.\nCombining this with our finding from the previous step ($s'_{4} \\in \\{\\mathrm{A}, \\mathrm{G}\\}$), the only viable nucleotide for position $4$ is $s'_{4} = \\mathrm{A}$.\n\nSo far, we have determined that the first four nucleotides are unchangeable: $s'_{1}s'_{2}s'_{3}s'_{4} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}$.\n\nWith $s'_{4} = \\mathrm{A}$, the constraint on the Ile codon $s'_{4}s'_{5}s'_{6}$ becomes $\\mathrm{A}s'_{5}s'_{6} \\in \\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$. This requires $s'_{5} = \\mathrm{T}$ and $s'_{6} \\in \\{\\mathrm{T}, \\mathrm{C}, \\mathrm{A}\\}$.\n\nNext, we examine the final overlapping codon $s'_{5}s'_{6}s'_{7}$ for Phe. The permissible codons are $\\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$. This requires that the first two nucleotides of the codon, $s'_{5}s'_{6}$, must be $\\mathrm{T}\\mathrm{T}$.\nCombining this with the constraint from the Ile codon ($s'_{5} = \\mathrm{T}$ and $s'_{6} \\in \\{\\mathrm{T}, \\mathrm{C}, \\mathrm{A}\\}$), we find that we must have $s'_{5} = \\mathrm{T}$ and $s'_{6} = \\mathrm{T}$.\n\nWith $s'_{5}s'_{6} = \\mathrm{T}\\mathrm{T}$, the Phe codon constraint $s'_{5}s'_{6}s'_{7} = \\mathrm{T}\\mathrm{T}s'_{7} \\in \\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$ implies that $s'_{7}$ must be in the set $\\{\\mathrm{T}, \\mathrm{C}\\}$.\n\nIn summary, after satisfying all coding constraints (constraints $1$, $2$, and $3$), the set of possible sequences is reduced to two:\n-   Sequence $S'_{A}$: $\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$\n-   Sequence $S'_{B}$: $\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$\n\nFinally, we apply the fourth constraint: elimination of the EcoRI site. The prohibited subsequence $s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7}$ is $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$.\n-   For sequence $S'_{A}$, the subsequence from position $2$ to $7$ is $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$. This is not the prohibited site. Thus, $S'_{A}$ is a valid solution.\n-   For sequence $S'_{B}$, the subsequence is $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$. This is precisely the prohibited site. Thus, $S'_{B}$ is invalid.\n\nThis leaves us with only one sequence that satisfies all constraints: $S'_{\\text{valid}} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$.\n\nThe problem asks for $N(m)$, where $m$ is the minimal number of substitutions in positions $2$ through $7$.\nThe original subsequence is $s_{2}s_{3}s_{4}s_{5}s_{6}s_{7} = \\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$.\nThe only valid recoded subsequence is $s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7} = \\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$.\nComparing these two subsequences, we see a single substitution at position $7$ (from $\\mathrm{C}$ to $\\mathrm{T}$). The number of substitutions is $1$.\nSince there is only one valid solution, the number of substitutions required is by definition minimal. Thus, $m = 1$.\nThe number of distinct sequences that achieve exactly $m=1$ substitutions is the number of valid solutions we found. We found only one.\nTherefore, $N(m) = N(1) = 1$.", "answer": "$$\\boxed{1}$$", "id": "2787320"}, {"introduction": "Beyond merely encoding the correct proteins, refactored genomes are often designed to precisely control the dynamics of gene expression. This practice explores how codon usage, a primary target of refactoring, influences the rate of translation using the Ribosome Flow Model (RFM), a powerful biophysical framework. By deriving the steady-state protein production rate from first principles [@problem_id:2787291], you will gain a quantitative understanding of how engineered codon bottlenecks can be used to regulate cellular resource allocation and protein output.", "problem": "A central goal of whole-genome synthesis and refactoring is to systematically redesign coding sequences to control translation dynamics in vivo. Consider a single messenger ribonucleic acid (mRNA) open reading frame that has been refactored to concentrate its codon-dependent slowdown into one dominant bottleneck segment, followed by a fast termination step. Model translation on this mRNA as a one-dimensional exclusion process at the mean-field level, also known as the Ribosome Flow Model (RFM), which is a coarse-grained limit of the Totally Asymmetric Simple Exclusion Process (TASEP). Let there be two coarse-grained sites representing the codon-dependent bottleneck and the terminal site, respectively. Let the ribosome initiation rate be $\\alpha$, the codon-dependent elongation (hopping) rate across the internal bottleneck site be $\\lambda_1$, and the exit (termination) rate be $\\lambda_2$. Assume all rates are positive constants and that ribosomes obey hard exclusion: a ribosome can only move forward if the next site is empty.\n\nDefine $x_{1}(t)$ and $x_{2}(t)$ as the mean occupancies of the first and second coarse-grained sites at time $t$, with $x_{i}(t) \\in [0,1]$. Starting only from the following fundamental bases:\n- The Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein) and the physical principle of steric exclusion of ribosomes on mRNA.\n- The mean-field approximation of TASEP, in which the probability of a hop equals the product of the occupancy of the source and the vacancy of the target times the corresponding rate constant.\n- Conservation of flux at steady state, where the production (protein output) equals the steady exit flux.\n\nFirst, derive the coupled mean-field dynamics for $x_{1}(t)$ and $x_{2}(t)$ implied by these principles. Then, by imposing steady state, eliminate $x_{1}$ and $x_{2}$ to obtain a closed-form analytical expression for the steady-state protein output $J(\\alpha)$, defined as the steady exit flux, as an explicit function of $\\alpha$, $\\lambda_1$, and $\\lambda_2$. Your expression must be a single closed-form formula that is valid for all positive $\\alpha$, $\\lambda_1$, and $\\lambda_2$, and it must correspond to the physically admissible branch that satisfies $J(\\alpha) \\to 0$ as $\\alpha \\to 0$ and $J(\\alpha) \\leq \\min\\{\\alpha,\\lambda_2\\}$.\n\nProvide only the final closed-form expression for $J(\\alpha)$ as your answer. Do not substitute numerical values, and do not include units in your final expression. If you perform any approximations, they must be justified from first principles; however, the requested final answer must be the exact, closed-form expression.", "solution": "The problem requires the derivation of a closed-form analytical expression for the steady-state protein output, denoted by the flux $J(\\alpha)$, for a two-site Ribosome Flow Model (RFM). The derivation must proceed from the fundamental principles provided.\n\nLet $x_1(t)$ and $x_2(t)$ be the mean occupancies of the first (bottleneck) and second (terminal) coarse-grained sites, respectively. The rates are the initiation rate $\\alpha$, the hopping rate between sites $\\lambda_1$, and the termination rate $\\lambda_2$. Ribosomes obey hard steric exclusion.\n\nWe apply the mean-field approximation for the Totally Asymmetric Simple Exclusion Process (TASEP), where the flux between sites is proportional to the occupancy of the source site and the vacancy of the target site.\n\nThe rate of change of occupancy for each site, $\\frac{dx_i}{dt}$, is the difference between the total inflow rate and the total outflow rate for that site.\n\nFor the first site, the inflow is from ribosome initiation onto a vacant site, given by the flux $J_{in} = \\alpha (1 - x_1(t))$. The outflow is the hopping of ribosomes to the second site, which requires the first site to be occupied and the second site to be vacant. This flux is $J_{1 \\to 2} = \\lambda_1 x_1(t) (1 - x_2(t))$. The dynamical equation for $x_1(t)$ is thus:\n$$ \\frac{dx_1(t)}{dt} = \\alpha (1 - x_1(t)) - \\lambda_1 x_1(t) (1 - x_2(t)) $$\n\nFor the second site, the inflow is the hopping from the first site, $J_{1 \\to 2} = \\lambda_1 x_1(t) (1 - x_2(t))$. The outflow is the termination process, which requires the second site to be occupied. The \"target\" site for termination can be considered permanently vacant. This flux is $J_{out} = \\lambda_2 x_2(t)$. The dynamical equation for $x_2(t)$ is:\n$$ \\frac{dx_2(t)}{dt} = \\lambda_1 x_1(t) (1 - x_2(t)) - \\lambda_2 x_2(t) $$\n\nAt steady state, the occupancies are constant, so $\\frac{dx_1}{dt} = 0$ and $\\frac{dx_2}{dt} = 0$. Let $x_1^*$ and $x_2^*$ denote the steady-state occupancies. The system of equations becomes:\n$$ \\alpha (1 - x_1^*) = \\lambda_1 x_1^* (1 - x_2^*) $$\n$$ \\lambda_1 x_1^* (1 - x_2^*) = \\lambda_2 x_2^* $$\n\nThe principle of conservation of flux at steady state dictates that all fluxes are equal. We define this steady-state flux as the protein output $J$.\n$$ J = \\alpha (1 - x_1^*) = \\lambda_1 x_1^* (1 - x_2^*) = \\lambda_2 x_2^* $$\n\nOur task is to find an expression for $J$ in terms of $\\alpha$, $\\lambda_1$, and $\\lambda_2$. We can express the steady-state occupancies $x_1^*$ and $x_2^*$ in terms of $J$:\nFrom $J = \\alpha (1 - x_1^*)$, we solve for $x_1^*$:\n$$ x_1^* = 1 - \\frac{J}{\\alpha} $$\nFrom $J = \\lambda_2 x_2^*$, we solve for $x_2^*$:\n$$ x_2^* = \\frac{J}{\\lambda_2} $$\nFor these occupancies to be physically meaningful, they must be in the interval $[0,1]$, which implies $0 \\le J \\le \\alpha$ and $0 \\le J \\le \\lambda_2$.\n\nNow, we substitute these expressions for $x_1^*$ and $x_2^*$ into the middle flux equation, $J = \\lambda_1 x_1^* (1 - x_2^*)$:\n$$ J = \\lambda_1 \\left(1 - \\frac{J}{\\alpha}\\right) \\left(1 - \\frac{J}{\\lambda_2}\\right) $$\nThis is the governing equation for the steady-state flux $J$. We must solve it.\n$$ J = \\lambda_1 \\left(\\frac{\\alpha - J}{\\alpha}\\right) \\left(\\frac{\\lambda_2 - J}{\\lambda_2}\\right) $$\nMultiplying both sides by $\\alpha \\lambda_2$ to clear the denominators gives:\n$$ J \\alpha \\lambda_2 = \\lambda_1 (\\alpha - J)(\\lambda_2 - J) $$\n$$ J \\alpha \\lambda_2 = \\lambda_1 (\\alpha \\lambda_2 - \\alpha J - \\lambda_2 J + J^2) $$\nRearranging the terms yields a quadratic equation for $J$ in the standard form $aJ^2 + bJ + c = 0$:\n$$ \\lambda_1 J^2 - (\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2) J + \\alpha \\lambda_1 \\lambda_2 = 0 $$\n\nWe solve this equation using the quadratic formula $J = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, where:\n$a = \\lambda_1$\n$b = -(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)$\n$c = \\alpha \\lambda_1 \\lambda_2$\n\nThe solution is:\n$$ J = \\frac{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2) \\pm \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4(\\lambda_1)(\\alpha \\lambda_1 \\lambda_2)}}{2 \\lambda_1} $$\n$$ J = \\frac{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2) \\pm \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2}}{2 \\lambda_1} $$\n\nThe problem specifies that we must choose the physically admissible branch that satisfies the condition $J(\\alpha) \\to 0$ as $\\alpha \\to 0$. Let us examine the two solutions in this limit. As $\\alpha \\to 0$:\n- The term $(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)$ approaches $\\lambda_1 \\lambda_2$.\n- The discriminant $(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2$ approaches $(\\lambda_1 \\lambda_2)^2$.\n- The square root of the discriminant approaches $\\lambda_1 \\lambda_2$.\n\nThe two solutions for $J$ thus approach:\n$J_+ \\to \\frac{\\lambda_1 \\lambda_2 + \\lambda_1 \\lambda_2}{2 \\lambda_1} = \\frac{2 \\lambda_1 \\lambda_2}{2 \\lambda_1} = \\lambda_2$\n$J_- \\to \\frac{\\lambda_1 \\lambda_2 - \\lambda_1 \\lambda_2}{2 \\lambda_1} = 0$\n\nTo satisfy the condition $J(\\alpha) \\to 0$ as $\\alpha \\to 0$, we must select the solution with the minus sign. Therefore, the single, closed-form expression for the steady-state protein output is:\n$$ J(\\alpha) = \\frac{\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2 - \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2}}{2 \\lambda_1} $$\nThis expression is valid for all positive $\\alpha, \\lambda_1, \\lambda_2$ and satisfies the given physical constraints.", "answer": "$$ \\boxed{\\frac{\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2 - \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2}}{2 \\lambda_1}} $$", "id": "2787291"}, {"introduction": "Whole-genome synthesis enables the redesign of not just local sequences but also large-scale chromosome architecture. A key architectural decision is the placement of replication origins, which has profound effects on the cell cycle. This computational exercise [@problem_id:2787222] asks you to model the process of DNA replication on a synthetic chromosome, calculating the total replication time and peak resource demand as a function of origin layout, thereby evaluating the design's robustness under different constraints.", "problem": "Consider a circular Deoxyribonucleic Acid (DNA) chromosome undergoing whole-genome synthesis and refactoring, where the placement of replication origins is an engineering decision. Assume the following foundational bases, which you must use to derive your solution: replication initiates at designated origins simultaneously at time $t=0$, each origin launches exactly two replication forks that propagate in opposite directions along the chromosome, forks move at a constant fork velocity $v$ (in base pairs per second, bp/s) determined by growth condition, and replication proceeds until converging forks meet and terminate. The genome length is $L$ (in base pairs, bp). Cellular resources impose a finite capacity $C$ (in bp/s) on the total instantaneous DNA synthesis rate. A growth condition also sets a replication time budget $T_{\\text{budget}}$ (in seconds, s) within which replication must complete to avoid conflicts with cell-cycle progression. Your task is to, for each provided test case, compute three quantities from first principles and predict robustness.\n\nRequired computations per test case:\n- Time to complete replication, $T_{\\text{rep}}$ (in seconds), derived from the spatial distribution of origins and the fork kinematics described above.\n- Peak demand ratio, defined as the ratio of the maximum instantaneous DNA synthesis demand implied by the origin configuration and fork kinematics to the capacity $C$. You must determine the peak demand from first principles using the stated base and the set of origins.\n- Robustness prediction, a boolean that is true if and only if $T_{\\text{rep}} \\le T_{\\text{budget}}$ and the peak demand ratio $\\le 1$.\n\nAdditionally, report a robustness score in $[0,1]$ defined as the product of two dimensionless margins, each clamped to $1$: a time margin equal to $T_{\\text{budget}}/T_{\\text{rep}}$ and a capacity margin equal to $C/R_{\\text{peak}}$, where $R_{\\text{peak}}$ is the peak instantaneous replication demand you derive. Thus, the robustness score is $\\min(1, T_{\\text{budget}}/T_{\\text{rep}}) \\times \\min(1, C/R_{\\text{peak}})$.\n\nInput specification for each test case:\n- Chromosome length $L$ in base pairs (bp).\n- A list of origin positions $\\mathcal{O}$ given as integers in $[0, L)$ in base pairs (bp) on the circular genome.\n- Fork velocity $v$ in bp/s.\n- Capacity $C$ in bp/s.\n- Replication time budget $T_{\\text{budget}}$ in seconds.\n\nOutput specification per test case:\n- A list $[ \\text{robust}, T_{\\text{rep}}, \\text{peak\\_demand\\_ratio}, \\text{robustness\\_score} ]$, where $\\text{robust}$ is a boolean, the remaining entries are floats rounded to six decimal places. The peak demand ratio is the dimensionless value $R_{\\text{peak}}/C$.\n\nYour program must evaluate the following test suite:\n- Test case 1 (happy path, uniform spacing):\n  - $L = 4{,}600{,}000$, $\\mathcal{O} = [0, 1{,}150{,}000, 2{,}300{,}000, 3{,}450{,}000]$, $v = 1000$, $C = 10{,}000{,}000$, $T_{\\text{budget}} = 1800$.\n- Test case 2 (single origin, time-limited growth):\n  - $L = 4{,}600{,}000$, $\\mathcal{O} = [0]$, $v = 1000$, $C = 5{,}000$, $T_{\\text{budget}} = 1800$.\n- Test case 3 (clustered origins, capacity-limited growth):\n  - $L = 3{,}000{,}000$, $\\mathcal{O} = [0, 1000, 2000, 300{,}000, 1{,}500{,}000, 2{,}000{,}000]$, $v = 1200$, $C = 14{,}000$, $T_{\\text{budget}} = 600$.\n- Test case 4 (boundary on time budget with high velocity and uniform spacing):\n  - $L = 1{,}000{,}000$, $\\mathcal{O} = [0, 125{,}000, 250{,}000, 375{,}000, 500{,}000, 625{,}000, 750{,}000, 875{,}000]$, $v = 3500$, $C = 60{,}000$, $T_{\\text{budget}} = 17.857142857142858$.\n- Test case 5 (boundary on capacity with sufficient time):\n  - $L = 2{,}000{,}000$, $\\mathcal{O} = [0, 1{,}000{,}000]$, $v = 2500$, $C = 10{,}000$, $T_{\\text{budget}} = 250$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list for one test case in the order given above. For example, the output should have the form $[[\\cdots],[\\cdots],\\ldots]$ with no spaces, and all floats rounded to six decimal places: $[ [\\text{robust}_1,T_{\\text{rep},1},\\text{ratio}_1,\\text{score}_1], [\\text{robust}_2,T_{\\text{rep},2},\\text{ratio}_2,\\text{score}_2], \\ldots ]$.", "solution": "The problem statement has been subjected to rigorous validation and is determined to be valid. It is scientifically grounded in a standard biophysical model of DNA replication, is mathematically well-posed, objective, and provides all necessary information for a unique solution. We shall therefore proceed with a complete derivation of the required quantities from first principles.\n\nThe central task is to analyze the dynamics of genome replication on a circular chromosome and evaluate its performance against specified time and resource constraints. The analysis requires the calculation of three key metrics: the total replication time ($T_{\\text{rep}}$), the peak demand for nucleotide synthesis ($R_{\\text{peak}}$) expressed as a ratio to capacity, and two robustness indicators derived from these values.\n\n**1. Derivation of Replication Time ($T_{\\text{rep}}$)**\n\nThe model posits that replication initiates simultaneously at all specified origin positions $\\mathcal{O} = \\{o_1, o_2, \\ldots, o_n\\}$ on a circular chromosome of length $L$. From each origin $o_i$, two replication forks are launched, propagating in opposite directions at a constant velocity $v$. Replication is complete when the entire chromosome has been duplicated, which occurs when all converging forks have met and terminated.\n\nThe time to complete replication, $T_{\\text{rep}}$, is therefore dictated by the time required to replicate the longest segment of DNA between any two adjacent replication origins. Let us first sort the origin positions in ascending order, $0 \\le o_1 < o_2 < \\ldots < o_n < L$. These $n$ origins partition the circular chromosome into $n$ segments. The lengths of these segments are the distances between adjacent origins. For origins $o_i$ and $o_{i+1}$ where $i \\in \\{1, \\ldots, n-1\\}$, the segment length is $d_i = o_{i+1} - o_i$. Due to the circular topology of the chromosome, we must also consider the segment connecting the last origin, $o_n$, to the first origin, $o_1$. The length of this wrap-around segment is $d_n = (L - o_n) + o_1$.\n\nIn the special case of a single origin ($n=1$), the two forks depart from $o_1$ and travel in opposite directions around the circle, meeting at the antipode. The distance each fork must travel is $L/2$. The effective segment length that these two forks must replicate is the entire chromosome, thus $d_{\\text{max}} = L$.\n\nFor any given segment of length $d$, replication is carried out by two forks, one emanating from each end of the segment and moving toward the center. The relative velocity of these two converging forks is $v + v = 2v$. The time required to fully replicate this segment is therefore:\n$$t_{\\text{segment}} = \\frac{d}{2v}$$\nSince all segments are replicated in parallel, the total time to replicate the entire chromosome, $T_{\\text{rep}}$, is determined by the maximum time required for any single segment. This corresponds to the largest inter-origin distance, $d_{\\text{max}}$.\n$$d_{\\text{max}} = \\max(\\{o_{i+1} - o_i\\}_{i=1}^{n-1} \\cup \\{L - o_n + o_1\\})$$\nThus, the total replication time is:\n$$T_{\\text{rep}} = \\frac{d_{\\text{max}}}{2v}$$\n\n**2. Derivation of Peak Synthesis Demand ($R_{\\text{peak}}$)**\n\nThe total instantaneous DNA synthesis rate, $R(t)$, is the sum of the synthesis rates of all active replication forks at time $t$. Each fork synthesizes DNA at a constant rate of $v$ base pairs per second. At time $t=0$, replication initiates at all $n = |\\mathcal{O}|$ origins. Each origin launches two forks, so the initial number of active forks is $2n$.\n\nThe total synthesis rate is therefore $R(t) = N_{\\text{forks}}(t) \\times v$, where $N_{\\text{forks}}(t)$ is the number of active forks at time $t$. Forks become inactive upon colliding with another fork. The first collision event occurs at time $t_{\\text{min}} = d_{\\text{min}} / (2v)$, where $d_{\\text{min}}$ is the shortest inter-origin distance. For any time $t$ in the interval $0 < t < t_{\\text{min}}$, no forks have terminated, and the number of active forks remains at its maximum initial value of $2n$. Consequently, the synthesis rate $R(t)$ is maximal at the onset of replication.\n\nThe peak instantaneous synthesis demand, $R_{\\text{peak}}$, is:\n$$R_{\\text{peak}} = R(t \\to 0^+) = (\\text{number of origins}) \\times 2 \\times v = 2|\\mathcal{O}|v$$\nThe problem asks for the peak demand ratio, which is this peak demand normalized by the cellular synthesis capacity, $C$.\n$$\\text{Peak Demand Ratio} = \\frac{R_{\\text{peak}}}{C} = \\frac{2|\\mathcal{O}|v}{C}$$\n\n**3. Computation of Robustness and Score**\n\nWith $T_{\\text{rep}}$ and $R_{\\text{peak}}$ derived, the remaining quantities are computed directly from their definitions.\n\nA design is considered robust if and only if it satisfies both the time and capacity constraints. The boolean robustness indicator, $\\text{robust}$, is therefore:\n$$\\text{robust} = (T_{\\text{rep}} \\le T_{\\text{budget}}) \\land \\left(\\frac{R_{\\text{peak}}}{C} \\le 1\\right)$$\nThe robustness score is defined as the product of the time margin and the capacity margin, where each margin is clamped to a maximum value of $1$. The time margin is $m_T = T_{\\text{budget}} / T_{\\text{rep}}$ and the capacity margin is $m_C = C / R_{\\text{peak}}$.\n$$\\text{Robustness Score} = \\min\\left(1, \\frac{T_{\\text{budget}}}{T_{\\text{rep}}}\\right) \\times \\min\\left(1, \\frac{C}{R_{\\text{peak}}}\\right)$$\nIf a design is robust, both margins are $\\ge 1$, so both clamped terms are $1$, yielding a score of $1$. If a design fails one or both constraints, the corresponding margin(s) will be less than $1$, resulting in a score between $0$ and $1$ that quantifies the degree of failure.\n\nThese principles provide a complete algorithm to solve the problem for any given test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DNA replication problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (happy path, uniform spacing)\n        {\n            \"L\": 4600000,\n            \"origins\": [0, 1150000, 2300000, 3450000],\n            \"v\": 1000,\n            \"C\": 10000000,\n            \"T_budget\": 1800,\n        },\n        # Test case 2 (single origin, time-limited growth)\n        {\n            \"L\": 4600000,\n            \"origins\": [0],\n            \"v\": 1000,\n            \"C\": 5000,\n            \"T_budget\": 1800,\n        },\n        # Test case 3 (clustered origins, capacity-limited growth)\n        {\n            \"L\": 3000000,\n            \"origins\": [0, 1000, 2000, 300000, 1500000, 2000000],\n            \"v\": 1200,\n            \"C\": 14000,\n            \"T_budget\": 600,\n        },\n        # Test case 4 (boundary on time budget with high velocity and uniform spacing)\n        {\n            \"L\": 1000000,\n            \"origins\": [0, 125000, 250000, 375000, 500000, 625000, 750000, 875000],\n            \"v\": 3500,\n            \"C\": 60000,\n            \"T_budget\": 17.857142857142858,\n        },\n        # Test case 5 (boundary on capacity with sufficient time)\n        {\n            \"L\": 2000000,\n            \"origins\": [0, 1000000],\n            \"v\": 2500,\n            \"C\": 10000,\n            \"T_budget\": 250,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        origins = case[\"origins\"]\n        v = case[\"v\"]\n        C = case[\"C\"]\n        T_budget = case[\"T_budget\"]\n        \n        n_origins = len(origins)\n\n        # 1. Calculate replication time (T_rep)\n        if n_origins == 0:\n            # Assuming replication does not happen if no origins.\n            # T_rep would be infinite. Programmatically handle this case.\n            d_max = float('inf') \n        elif n_origins == 1:\n            # Two forks from one origin travel around and meet at the antipode.\n            # The effective segment length is the entire chromosome.\n            d_max = L\n        else:\n            sorted_origins = np.sort(origins)\n            # Distances between adjacent origins\n            distances = np.diff(sorted_origins)\n            # Wrap-around distance\n            wrap_around_dist = L - sorted_origins[-1] + sorted_origins[0]\n            d_max = np.max(np.append(distances, wrap_around_dist))\n\n        T_rep = d_max / (2 * v)\n\n        # 2. Calculate peak demand and ratio\n        R_peak = 2 * n_origins * v\n        peak_demand_ratio = R_peak / C if C > 0 else float('inf')\n\n        # 3. Calculate robustness prediction\n        is_robust = (T_rep = T_budget) and (peak_demand_ratio = 1)\n\n        # 4. Calculate robustness score\n        time_margin = T_budget / T_rep if T_rep > 0 else float('inf')\n        capacity_margin = C / R_peak if R_peak > 0 else float('inf')\n        \n        robustness_score = min(1.0, time_margin) * min(1.0, capacity_margin)\n\n        results.append([is_robust, T_rep, peak_demand_ratio, robustness_score])\n\n    # Format the final output string exactly as specified, with no spaces.\n    result_strings = []\n    for r in results:\n        # Python str(bool) is 'True'/'False' which is fine\n        # Floats must be formatted to 6 decimal places.\n        res_str = f\"[{str(r[0])},{r[1]:.6f},{r[2]:.6f},{r[3]:.6f}]\"\n        result_strings.append(res_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[[{str(results[0][0])},{results[0][1]:.6f},{results[0][2]:.6f},{results[0][3]:.6f}],[{str(results[1][0])},{results[1][1]:.6f},{results[1][2]:.6f},{results[1][3]:.6f}],[{str(results[2][0])},{results[2][1]:.6f},{results[2][2]:.6f},{results[2][3]:.6f}],[{str(results[3][0])},{results[3][1]:.6f},{results[3][2]:.6f},{results[3][3]:.6f}],[{str(results[4][0])},{results[4][1]:.6f},{results[4][2]:.6f},{results[4][3]:.6f}]]\")\n\nsolve()\n```", "id": "2787222"}]}