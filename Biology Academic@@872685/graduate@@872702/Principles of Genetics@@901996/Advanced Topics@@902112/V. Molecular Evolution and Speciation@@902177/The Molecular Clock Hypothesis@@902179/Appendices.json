{"hands_on_practices": [{"introduction": "The most fundamental application of the molecular clock hypothesis is to estimate the divergence time between two lineages. This practice exercise guides you through the process of calibrating a molecular clock using a known calibration point, such as a fossil, which is a common technique in evolutionary biology. By calculating the rate of genetic change from a known divergence, you can then extrapolate to estimate the age of other evolutionary splits, as demonstrated in this problem [@problem_id:1947959].", "problem": "A team of astrobiologists studying a newly discovered moon in our solar system has found evidence of microbial life. They have successfully isolated and cultured three distinct species, designated Alpha, Beta, and Gamma. A key objective is to estimate the evolutionary timeline of these extraterrestrial life forms.\n\nA geological survey of the moon revealed a catastrophic impact event that created a large basin. Fossilized microbes, confirmed by morphological and chemical analysis to be the last common ancestor (LCA) of species Alpha and Beta, were found in a layer of rock just below the impact ejecta. Radiometric dating of this layer places the age of this LCA at 50.0 million years.\n\nThe astrobiologists then sequenced a highly conserved gene responsible for energy metabolism from all three species. An analysis of the aligned Deoxyribonucleic Acid (DNA) sequences provides the following pairwise genetic divergences:\n- The sequence divergence between species Alpha and species Beta is 8.00%.\n- The sequence divergence between species Alpha and species Gamma is 11.6%.\n\nAssuming a constant rate of molecular evolution (i.e., the molecular clock hypothesis holds true) for this gene across all three lineages, use the fossil record to calibrate the molecular clock. Then, estimate the age of the last common ancestor of species Alpha and Gamma.\n\nExpress your final answer in millions of years, rounded to three significant figures.", "solution": "Under the molecular clock hypothesis, for two species $X$ and $Y$ that diverged $t_{XY}$ time units ago, with a constant substitution rate $r$ per site per unit time, the expected pairwise sequence divergence is\n$$\nD_{XY} = 2 r t_{XY},\n$$\nbecause substitutions accumulate independently along both lineages.\n\nFrom the fossil calibration, the last common ancestor of Alpha and Beta is dated to $t_{AB} = 50.0$ million years, and the observed divergence between Alpha and Beta is $D_{AB} = 0.0800$. Therefore, the substitution rate is obtained by solving\n$$\nD_{AB} = 2 r t_{AB} \\quad \\Rightarrow \\quad r = \\frac{D_{AB}}{2 t_{AB}}.\n$$\n\nFor Alpha and Gamma, with observed divergence $D_{AG} = 0.116$, the divergence time $t_{AG}$ satisfies\n$$\nD_{AG} = 2 r t_{AG}.\n$$\nSubstituting the calibrated rate gives\n$$\nt_{AG} = \\frac{D_{AG}}{2 r} = \\frac{D_{AG}}{2} \\cdot \\frac{2 t_{AB}}{D_{AB}} = \\frac{D_{AG} \\, t_{AB}}{D_{AB}}.\n$$\nPlugging in the measured values yields\n$$\nt_{AG} = \\frac{0.116 \\times 50.0}{0.0800} = 72.5,\n$$\nwhich is the age in millions of years. Rounded to three significant figures, this remains $72.5$.", "answer": "$$\\boxed{72.5}$$", "id": "1947959"}, {"introduction": "A simple molecular clock assumes a single, constant rate of evolution, but reality is more complex, as different types of mutations accumulate at different speeds due to varying levels of natural selection. This problem [@problem_id:2435918] challenges you to compare divergence time estimates derived from synonymous ($d_S$) and non-synonymous ($d_N$) substitution rates. This exercise reveals how purifying selection can cause clocks to 'tick' at different speeds, providing a deeper understanding of the forces that shape molecular evolution.", "problem": "A pair of closely related mammal species is analyzed under the molecular clock hypothesis. A codon-based analysis of a protein-coding gene yields estimated pairwise substitutions per site at synonymous sites, denoted $d_S$, and at non-synonymous sites, denoted $d_N$, with $d_S = 0.027$ and $d_N = 0.0048$. Independent calibrations from a large mammalian clade provide constant substitution rates per site per million years (Myr) for these site classes: a synonymous rate $r_S = 1.2\\times 10^{-3}$ per site per Myr and a non-synonymous rate $r_N = 3.0\\times 10^{-4}$ per site per Myr. Assume a strict molecular clock in which pairwise divergence accumulates independently along the two lineages at the respective rates.\n\nWhich option best describes the divergence time estimates obtained using a synonymous substitution clock versus a non-synonymous substitution clock and provides the correct interpretation?\n\nA. Using the synonymous clock, the divergence time is approximately $11.25$ Myr, and using the non-synonymous clock, it is approximately $8.0$ Myr; this discrepancy is consistent with stronger purifying selection in this lineage than in the calibration set, which makes the applied non-synonymous rate too high and its time estimate too small.\n\nB. Both clocks necessarily yield the same divergence time because the ratio of non-synonymous to synonymous substitution rates ($d_N/d_S$) is constant; the time is approximately $9.6$ Myr in both cases.\n\nC. The non-synonymous clock must yield a larger time than the synonymous clock because non-synonymous sites evolve more slowly; with the given values $T_N \\approx 16$ Myr and $T_S \\approx 11.25$ Myr.\n\nD. The synonymous clock is invalid without accounting for codon usage bias; only the non-synonymous clock should be used, giving $T \\approx 8.0$ Myr, which must equal the true divergence time regardless of lineage-specific selection.", "solution": "The problem statement is first subjected to validation.\n\n**Givens:**\n1.  Estimated pairwise synonymous substitutions per site: $d_S = 0.027$.\n2.  Estimated pairwise non-synonymous substitutions per site: $d_N = 0.0048$.\n3.  Calibrated synonymous substitution rate: $r_S = 1.2 \\times 10^{-3}$ per site per million years (Myr).\n4.  Calibrated non-synonymous substitution rate: $r_N = 3.0 \\times 10^{-4}$ per site per Myr.\n5.  Assumption: A strict molecular clock in which pairwise divergence accumulates independently along two lineages.\n\n**Validation Verdict:**\nThe problem is scientifically grounded in the principles of molecular evolution, specifically the molecular clock hypothesis. It is well-posed, providing all necessary data ($d_S$, $d_N$, $r_S$, $r_N$) and a clear objective. The parameters are within a realistic range for mammalian evolution. The problem is self-contained and free of contradictions or ambiguities. It is therefore deemed **valid**. We may proceed with the solution.\n\n**Derivation of Divergence Time Estimates:**\n\nThe molecular clock hypothesis posits a relationship between the genetic distance (substitutions per site, $d$) and the divergence time ($T$). Since divergence occurs along two separate lineages from a common ancestor, the total number of substitutions is a function of twice the divergence time. The governing equation is:\n$$d = 2 \\cdot r \\cdot T$$\nwhere $r$ is the substitution rate per site per unit time. We can solve for the divergence time $T$ as:\n$$T = \\frac{d}{2r}$$\n\nWe will now apply this formula to the synonymous and non-synonymous data sets independently.\n\n1.  **Divergence Time from Synonymous Substitutions ($T_S$):**\n    Using the provided values $d_S = 0.027$ and $r_S = 1.2 \\times 10^{-3} \\text{ Myr}^{-1}$:\n    $$T_S = \\frac{d_S}{2r_S} = \\frac{0.027}{2 \\times (1.2 \\times 10^{-3})} = \\frac{0.027}{2.4 \\times 10^{-3}} \\text{ Myr}$$\n    $$T_S = \\frac{27}{2.4} = \\frac{270}{24} = 11.25 \\text{ Myr}$$\n\n2.  **Divergence Time from Non-synonymous Substitutions ($T_N$):**\n    Using the provided values $d_N = 0.0048$ and $r_N = 3.0 \\times 10^{-4} \\text{ Myr}^{-1}$:\n    $$T_N = \\frac{d_N}{2r_N} = \\frac{0.0048}{2 \\times (3.0 \\times 10^{-4})} = \\frac{0.0048}{6.0 \\times 10^{-4}} \\text{ Myr}$$\n    $$T_N = \\frac{48}{6} = 8.0 \\text{ Myr}$$\n\nThe calculations yield two distinct estimates for the divergence time: $T_S = 11.25$ Myr and $T_N = 8.0$ Myr. This discrepancy indicates that the rates from the general calibration set are not both applicable to the specific pair of species being studied. One or both of the clocks are not behaving as assumed. Synonymous substitutions are generally less affected by selective pressures than non-synonymous ones, making $T_S$ a more robust, though not infallible, estimate of time. The discrepancy suggests that the non-synonymous substitution rate in this particular lineage differs from the calibrated average rate $r_N$.\n\nIf we assume the true divergence time is closer to $T_S \\approx 11.25$ Myr, we can infer the actual non-synonymous rate in this lineage ($r_{N, \\text{lineage}}$):\n$$r_{N, \\text{lineage}} = \\frac{d_N}{2T_S} = \\frac{0.0048}{2 \\times 11.25} = \\frac{0.0048}{22.5} \\approx 2.13 \\times 10^{-4} \\text{ Myr}^{-1}$$\nThis rate ($2.13 \\times 10^{-4}$) is slower than the calibrated rate ($r_N = 3.0 \\times 10^{-4}$). A slower rate of non-synonymous substitution is the hallmark of stronger purifying (negative) selection, which more efficiently removes deleterious amino acid changes. Therefore, using the calibrated rate $r_N$, which is too high for this lineage, results in an underestimation of the divergence time ($T_N < T_S$).\n\n**Evaluation of Options:**\n\n**A. Using the synonymous clock, the divergence time is approximately $11.25$ Myr, and using the non-synonymous clock, it is approximately $8.0$ Myr; this discrepancy is consistent with stronger purifying selection in this lineage than in the calibration set, which makes the applied non-synonymous rate too high and its time estimate too small.**\n- **Analysis:** This option correctly reports the calculated values of $T_S = 11.25$ Myr and $T_N = 8.0$ Myr. The interpretation is scientifically sound and perfectly matches our derivation. Stronger purifying selection in the specific lineage lowers its actual non-synonymous rate compared to the calibration set's average rate. Applying this overly high calibrated rate ($r_N$) to the observed distance ($d_N$) logically leads to a smaller, underestimated time ($T_N$).\n- **Verdict:** **Correct**.\n\n**B. Both clocks necessarily yield the same divergence time because the ratio of non-synonymous to synonymous substitution rates ($d_N/d_S$) is constant; the time is approximately $9.6$ Myr in both cases.**\n- **Analysis:** This statement is incorrect on multiple grounds. First, our calculations show that the clocks do not yield the same time. Second, the assertion that they *must* is false; they would only yield the same time if the ratio of distances ($d_S/d_N$) were equal to the ratio of calibrated rates ($r_S/r_N$). Here, $d_S/d_N = 0.027/0.0048 = 5.625$, while $r_S/r_N = (1.2 \\times 10^{-3})/(3.0 \\times 10^{-4}) = 4$. Since $5.625 \\neq 4$, the clocks are inconsistent. Third, the calculation of $9.6$ Myr is arbitrary and not based on the model. The reasoning provided is nonsensical.\n- **Verdict:** **Incorrect**.\n\n**C. The non-synonymous clock must yield a larger time than the synonymous clock because non-synonymous sites evolve more slowly; with the given values $T_N \\approx 16$ Myr and $T_S \\approx 11.25$ Myr.**\n- **Analysis:** The calculation for $T_N$ is erroneous. They have computed $T_N = d_N / r_N = 0.0048 / (3.0 \\times 10^{-4}) = 16$ Myr, failing to include the factor of $2$ for the two diverging lineages. This is a fundamental error. Furthermore, the claim that $T_N$ must be larger than $T_S$ is not a general rule and is factually contradicted by the correct calculation ($T_N = 8.0$ Myr, which is less than $T_S = 11.25$ Myr).\n- **Verdict:** **Incorrect**.\n\n**D. The synonymous clock is invalid without accounting for codon usage bias; only the non-synonymous clock should be used, giving $T \\approx 8.0$ Myr, which must equal the true divergence time regardless of lineage-specific selection.**\n- **Analysis:** This statement contains severe misconceptions. While codon usage bias can be a factor, it does not automatically invalidate the use of a synonymous clock, especially at low divergence ($d_S=0.027$). In fact, the near-neutral nature of synonymous sites often makes them superior to non-synonymous sites for time estimation. The assertion that the non-synonymous clock result \"$T \\approx 8.0$ Myr ... must equal the true divergence time regardless of lineage-specific selection\" is fundamentally wrong. Non-synonymous rates are highly sensitive to selective pressures. A change in selection intensity invalidates a clock calibrated under different conditions.\n- **Verdict:** **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2435918"}, {"introduction": "While the strict clock is a useful starting point, most modern phylogenetic analyses employ 'relaxed' clock models, which allow evolutionary rates to vary across the tree. This advanced practice [@problem_id:2435916] moves into the realm of computational simulation to explore a critical question: how many calibration points are needed to reliably estimate the average rate in such a model? By building a simulation from first principles, you will gain a deeper appreciation for the statistical challenges and data requirements inherent in dating the tree of life.", "problem": "You are asked to investigate, by first principles simulation, the minimum number of fossil calibration points required to reliably estimate the mean substitution rate under a relaxed molecular clock. Consider a rooted, fully binary, ultrametric phylogenetic tree with $8$ leaves and the following fixed topology and branch durations (in abstract time units): the root splits into two internal nodes each at duration $0.5$; each of those splits into two internal nodes at duration $0.25$; and each of those splits into two leaves at duration $0.25$. Thus, every root-to-leaf path has total time $1.0$. Formally, label nodes so that the parent-child edges and their durations are: $(0 \\rightarrow 1, 0.5)$, $(0 \\rightarrow 2, 0.5)$, $(1 \\rightarrow 3, 0.25)$, $(1 \\rightarrow 4, 0.25)$, $(3 \\rightarrow 5, 0.25)$, $(3 \\rightarrow 6, 0.25)$, $(4 \\rightarrow 7, 0.25)$, $(4 \\rightarrow 8, 0.25)$, $(2 \\rightarrow 9, 0.25)$, $(2 \\rightarrow 10, 0.25)$, $(9 \\rightarrow 11, 0.25)$, $(9 \\rightarrow 12, 0.25)$, $(10 \\rightarrow 13, 0.25)$, $(10 \\rightarrow 14, 0.25)$. The root is node $0$. The internal nodes excluding the root are $\\{1,2,3,4,9,10\\}$ and are eligible for calibration.\n\nAssume branch-specific substitution rates are independent and identically distributed according to a Lognormal distribution with mean $r$ and variance $v$ (both in substitutions per site per unit time). For each branch $b$ with duration $t_b$ and latent rate $r_b$, the number of substitutions across $L$ independent sites is modeled as a Poisson random variable with mean $L \\, r_b \\, t_b$. Define, for any node $c$, the total realized substitutions per site along the path from the root to $c$ as\n$$\nS_c \\equiv \\frac{1}{L} \\sum_{b \\in \\text{path}(0 \\rightarrow c)} X_b,\n$$\nwhere $X_b \\sim \\text{Poisson}(L \\, r_b \\, t_b)$ are independent across branches, and denote the true root-to-node time by\n$$\nT_c \\equiv \\sum_{b \\in \\text{path}(0 \\rightarrow c)} t_b.\n$$\n\nFor a chosen number $k$ of calibration points, select $k$ distinct nodes uniformly at random without replacement from the calibration-eligible set $\\{1,2,3,4,9,10\\}$. Define the rate estimator $\\widehat{r}_k$ for that replicate and that calibration set as the slope of the least-squares fit constrained through the origin of $S_c$ onto $T_c$ across the $k$ calibrated nodes:\n$$\n\\widehat{r}_k \\equiv \\frac{\\sum_{c} T_c S_c}{\\sum_{c} T_c^2},\n$$\nwhere the sums are over the chosen $k$ calibrated nodes.\n\nDefine reliability for a given $k$ as the probability, over independent simulation replicates and random calibration-node choices, that the relative absolute error of $\\widehat{r}_k$ is at most $\\varepsilon$, that is,\n$$\n\\Pr\\left( \\frac{|\\widehat{r}_k - r|}{r} \\le \\varepsilon \\right).\n$$\nGiven a reliability threshold $p_{\\text{thr}}$ and a finite number of replicates $R$, approximate this probability by the empirical fraction of the $R$ replicates satisfying the error criterion. The minimum number of calibration points is the smallest $k \\in \\{1,2,3,4,5,6\\}$ such that the empirical fraction is at least $p_{\\text{thr}}$. If no such $k$ exists, return $-1$.\n\nYour program must implement this simulation exactly as specified and evaluate the minimum $k$ for each of the following test cases. For each test case, the parameters are specified as an ordered tuple $(r, v, L, \\varepsilon, p_{\\text{thr}}, R, \\text{seed})$, where $\\text{seed}$ is an integer to initialize the pseudo-random number generator, $r$ is the mean branch rate, $v$ is the variance of branch rates, $L$ is the number of sites, $\\varepsilon$ is the relative error tolerance, $p_{\\text{thr}}$ is the reliability threshold expressed as a decimal, and $R$ is the number of replicates:\n\n- Test case $1$: $(1.0, 0.10, 4000, 0.10, 0.90, 300, 1337)$.\n- Test case $2$: $(1.0, 0.50, 2000, 0.10, 0.90, 300, 1338)$.\n- Test case $3$: $(1.0, 0.01, 1000, 0.10, 0.90, 300, 1339)$.\n- Test case $4$: $(1.0, 1.00, 500, 0.20, 0.80, 300, 1340)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of integers enclosed in square brackets (for example, \"[1,2,3,4]\"). The $i$-th integer in the list must be the minimum $k$ for test case $i$, or $-1$ if no $k \\in \\{1,2,3,4,5,6\\}$ achieves the required reliability. No other output is permitted.", "solution": "The problem requires a simulation-based investigation to determine the minimum number of fossil calibration points, denoted by $k$, necessary to estimate the mean substitution rate, $r$, of a relaxed molecular clock with a specified reliability. The solution involves constructing a detailed simulation that adheres precisely to the provided model of molecular evolution and the specified estimation procedure.\n\nFirst, we must formalize the components of the simulation. The phylogenetic tree is fixed, rooted, binary, and ultrametric, with $8$ leaves. The total time from the root to any leaf is $1.0$ abstract time unit. The specific topology and branch durations, $t_b$, are provided. There are $14$ branches in total. A specific set of $6$ internal nodes, $\\{1,2,3,4,9,10\\}$, are designated as eligible for use as calibration points.\n\nThe evolutionary process along each branch $b$ is governed by a relaxed molecular clock model. The substitution rate for each branch, $r_b$, is an independent and identically distributed random variable drawn from a Lognormal distribution. The problem specifies this distribution by its mean, $r$, and variance, $v$. To sample from this distribution using standard library functions, which are typically parameterized by the mean, $\\mu$, and standard deviation, $\\sigma$, of the underlying Normal distribution, we must convert $(r, v)$ to $(\\mu, \\sigma)$. The relationships are:\n$$r = \\exp(\\mu + \\sigma^2/2)$$\n$$v = (\\exp(\\sigma^2) - 1) \\exp(2\\mu + \\sigma^2)$$\nFrom these, we can derive the parameters for the underlying Normal distribution:\n$$\\sigma^2 = \\ln\\left(\\frac{v}{r^2} + 1\\right)$$\n$$\\mu = \\ln(r) - \\frac{\\sigma^2}{2}$$\nFor each test case, we compute $\\mu$ and $\\sigma$ from the given $r$ and $v$.\n\nGiven the branch-specific rate $r_b$ and its duration $t_b$, the number of substitutions, $X_b$, occurring across a sequence of $L$ independent sites is modeled as a Poisson random variable:\n$$X_b \\sim \\text{Poisson}(\\lambda_b = L \\cdot r_b \\cdot t_b)$$\nThe value $S_c$, representing the observed total substitutions per site along the path from the root (node $0$) to a specific node $c$, is calculated as:\n$$S_c = \\frac{1}{L} \\sum_{b \\in \\text{path}(0 \\rightarrow c)} X_b$$\nThe true time from the root to node $c$, $T_c$, is the sum of the durations of the branches on that path. These times are fixed by the tree's structure. For the eligible calibration nodes, the times are $T_1 = T_2 = 0.5$ and $T_3 = T_4 = T_9 = T_{10} = 0.75$.\n\nThe core of the problem is to evaluate an estimator for the mean rate $r$. For a given number of calibration points, $k$, we first select $k$ distinct nodes uniformly at random from the eligible set. Using the pairs of true times $(T_c)$ and simulated substitutions-per-site $(S_c)$ for these $k$ nodes, we compute the rate estimate $\\widehat{r}_k$ as the slope of a linear regression constrained to pass through the origin:\n$$\\widehat{r}_k = \\frac{\\sum_{c} T_c S_c}{\\sum_{c} T_c^2}$$\nwhere the summation is over the $k$ chosen calibration nodes.\n\nThe reliability of this estimation process for a given $k$ is defined as the probability that the relative absolute error of the estimate is no more than a tolerance $\\varepsilon$:\n$$\\text{Reliability}(k) = \\Pr\\left( \\frac{|\\widehat{r}_k - r|}{r} \\le \\varepsilon \\right)$$\nWe approximate this probability empirically by running $R$ independent simulation replicates. In each replicate, we generate new branch rates and substitution counts, randomly choose $k$ calibration nodes, compute $\\widehat{r}_k$, and check if the error criterion is met. The empirical reliability is the fraction of the $R$ replicates that satisfy the criterion.\n\nThe final objective is to find the minimum integer $k \\in \\{1, 2, 3, 4, 5, 6\\}$ for which this empirical reliability is at least a given threshold, $p_{\\text{thr}}$. If no such $k$ exists within this range, the result is $-1$.\n\nThe overall algorithm for each test case $(r, v, L, \\varepsilon, p_{\\text{thr}}, R, \\text{seed})$ is as follows:\n$1$. Initialize a pseudo-random number generator with the given $\\text{seed}$.\n$2$. Pre-compute the tree structure: branch list, branch durations, paths from the root to each eligible calibration node, and the true times $T_c$ for these nodes.\n$3$. Calculate the parameters $\\mu$ and $\\sigma$ for the Lognormal rate distribution from the given $r$ and $v$.\n$4$. Iterate through $k$ from $1$ to $6$. For each $k$:\n    a. Initialize a success counter to $0$.\n    b. Run a loop for $R$ replicates. In each replicate:\n        i. Draw $14$ independent branch rates, $\\{r_b\\}$, from $\\text{Lognormal}(\\mu, \\sigma)$.\n        ii. For each of the $14$ branches, calculate the Poisson mean $\\lambda_b = L \\cdot r_b \\cdot t_b$ and draw the number of substitutions $X_b \\sim \\text{Poisson}(\\lambda_b)$.\n        iii. Select $k$ distinct calibration nodes at random from the eligible set $\\{1, 2, 3, 4, 9, 10\\}$.\n        iv. For each chosen calibration node $c$, compute $S_c$ by summing the simulated substitutions $X_b$ along its pre-computed path and dividing by $L$.\n        v. Compute the rate estimate $\\widehat{r}_k$ using the formula for the constrained least-squares slope.\n        vi. If $|\\widehat{r}_k - r| / r \\le \\varepsilon$, increment the success counter.\n    c. Calculate the empirical reliability as $\\text{success\\_count} / R$.\n    d. If this reliability is $\\ge p_{\\text{thr}}$, then the current value of $k$ is the minimum required. Record this value and terminate the search for this test case.\n$5$. If the loop over $k$ completes without meeting the threshold, the result for the test case is $-1$.\nThis procedure is repeated for all provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (1.0, 0.10, 4000, 0.10, 0.90, 300, 1337),\n        (1.0, 0.50, 2000, 0.10, 0.90, 300, 1338),\n        (1.0, 0.01, 1000, 0.10, 0.90, 300, 1339),\n        (1.0, 1.00, 500, 0.20, 0.80, 300, 1340),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _simulate_case(case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _simulate_case(case_params):\n    \"\"\"\n    Performs the simulation for a single test case to find the minimum k.\n\n    Args:\n        case_params (tuple): A tuple containing (r, v, L, epsilon, p_thr, R, seed).\n\n    Returns:\n        int: The minimum number of calibration points k, or -1 if no k satisfies the criteria.\n    \"\"\"\n    r, v, L, epsilon, p_thr, R, seed = case_params\n    rng = np.random.default_rng(seed)\n\n    # --- Pre-computation of Tree Structure ---\n    # The 14 branches in the order given in the problem statement\n    branches = [\n        (0, 1), (0, 2), (1, 3), (1, 4), (3, 5), (3, 6), (4, 7), (4, 8),\n        (2, 9), (2, 10), (9, 11), (9, 12), (10, 13), (10, 14)\n    ]\n    branch_to_idx = {branch: i for i, branch in enumerate(branches)}\n    \n    branch_durations = np.array([\n        0.5, 0.5, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25,\n        0.25, 0.25, 0.25, 0.25, 0.25, 0.25\n    ])\n\n    calibration_nodes = np.array([1, 2, 3, 4, 9, 10])\n\n    # Paths from root (0) to each eligible calibration node, by branch index\n    paths = {\n        1: [branch_to_idx[(0, 1)]],\n        2: [branch_to_idx[(0, 2)]],\n        3: [branch_to_idx[(0, 1)], branch_to_idx[(1, 3)]],\n        4: [branch_to_idx[(0, 1)], branch_to_idx[(1, 4)]],\n        9: [branch_to_idx[(0, 2)], branch_to_idx[(2, 9)]],\n        10: [branch_to_idx[(0, 2)], branch_to_idx[(2, 10)]],\n    }\n\n    # True times from root to each eligible calibration node\n    node_times = {\n        node: sum(branch_durations[i] for i in path)\n        for node, path in paths.items()\n    }\n\n    # --- Lognormal Distribution Parameter Conversion ---\n    # Convert mean (r) and variance (v) to underlying Normal params (mu, sigma)\n    # sigma_sq = ln(v/r^2 + 1)\n    # mu = ln(r) - sigma_sq / 2\n    if r > 0:\n        sigma_sq = np.log(v / (r**2) + 1.0)\n        mu = np.log(r) - sigma_sq / 2.0\n    else: # Should not happen with given test cases\n        mu, sigma_sq = 0, 0\n    sigma = np.sqrt(sigma_sq)\n\n    min_k_found = -1\n\n    for k in range(1, 7):\n        success_count = 0\n        for _ in range(R):\n            # 1. Generate branch-specific rates from Lognormal distribution\n            branch_rates = rng.lognormal(mu, sigma, size=len(branches))\n\n            # 2. Simulate substitutions on each branch using Poisson distribution\n            poisson_means = L * branch_rates * branch_durations\n            substitutions = rng.poisson(poisson_means)\n\n            # 3. Select k calibration nodes randomly\n            chosen_nodes = rng.choice(calibration_nodes, size=k, replace=False)\n\n            # 4. Calculate estimator r_hat\n            sum_ts = 0.0\n            sum_t_sq = 0.0\n            \n            for node_c in chosen_nodes:\n                path_indices = paths[node_c]\n                total_subs_on_path = np.sum(substitutions[path_indices])\n                \n                s_c = total_subs_on_path / L\n                t_c = node_times[node_c]\n\n                sum_ts += t_c * s_c\n                sum_t_sq += t_c**2\n            \n            if sum_t_sq == 0:\n                 # This should not happen if k > 0 and nodes are chosen correctly\n                 continue\n\n            r_hat_k = sum_ts / sum_t_sq\n\n            # 5. Check reliability criterion\n            relative_error = np.abs(r_hat_k - r) / r\n            if relative_error = epsilon:\n                success_count += 1\n        \n        empirical_reliability = success_count / R\n\n        if empirical_reliability >= p_thr:\n            min_k_found = k\n            break\n            \n    return min_k_found\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2435916"}]}