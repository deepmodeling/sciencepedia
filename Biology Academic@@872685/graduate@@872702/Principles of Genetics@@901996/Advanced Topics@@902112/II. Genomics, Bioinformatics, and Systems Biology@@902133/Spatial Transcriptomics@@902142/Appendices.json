{"hands_on_practices": [{"introduction": "This first exercise grounds you in the fundamental data structure of spatial transcriptomics. Before applying advanced algorithms, it is essential to understand how gene expression measurements (UMI counts) are mapped to physical locations (coordinates) in the tissue. This problem provides a simplified dataset to practice basic data handling and spatial querying, a foundational skill for any analysis pipeline [@problem_id:1467347].", "problem": "In a simplified spatial transcriptomics experiment, gene expression is measured at different locations on a tissue slide. Each measurement location is called a \"spot\" and has a unique set of spatial coordinates $(x, y)$. The expression level of a gene at a spot is quantified by counting the number of Unique Molecular Identifiers (UMIs) corresponding to that gene's messenger RNA.\n\nAn experiment yields the following data for four distinct spots and three genes (*GeneA*, *GeneB*, *GeneC*):\n\n*   **Spot 1** is located at coordinates $(x=15, y=10)$ and has UMI counts of 80 for *GeneA*, 210 for *GeneB*, and 15 for *GeneC*.\n*   **Spot 2** is located at coordinates $(x=15, y=30)$ and has UMI counts of 95 for *GeneA*, 190 for *GeneB*, and 120 for *GeneC*.\n*   **Spot 3** is located at coordinates $(x=40, y=12)$ and has UMI counts of 25 for *GeneA*, 50 for *GeneB*, and 310 for *GeneC*.\n*   **Spot 4** is located at coordinates $(x=40, y=35)$ and has UMI counts of 30 for *GeneA*, 45 for *GeneB*, and 90 for *GeneC*.\n\nA researcher defines a \"region of interest\" for a particular gene as the set of all spots where the UMI count for that gene is greater than 100. Based on the data provided, calculate the average y-coordinate for the region of interest defined for *GeneC*.", "solution": "The region of interest (ROI) for GeneC is defined as the set of spots where the GeneC UMI count is greater than 100. From the data:\n- Spot 1: GeneC count is 15, which does not satisfy $100$.\n- Spot 2: GeneC count is 120, which satisfies $100$ with $y=30$.\n- Spot 3: GeneC count is 310, which satisfies $100$ with $y=12$.\n- Spot 4: GeneC count is 90, which does not satisfy $100$.\n\nThus, the ROI consists of Spot 2 and Spot 3. The average $y$-coordinate is the arithmetic mean of the $y$-coordinates of these spots:\n$$\\bar{y}=\\frac{1}{n}\\sum_{i=1}^{n} y_{i},$$\nwhere $n=2$, $y_{1}=30$, and $y_{2}=12$. Therefore,\n$$\\bar{y}=\\frac{30+12}{2}=\\frac{42}{2}=21.$$", "answer": "$$\\boxed{21}$$", "id": "1467347"}, {"introduction": "A key challenge in interpreting spot-based spatial transcriptomics is that each measurement represents a mixture of different cell types. This exercise introduces the critical task of \"deconvolution,\" the computational process of estimating the cellular composition of each spot. By formulating this as a constrained regression problem, you will gain hands-on experience with the mathematical model that allows us to infer cell-type proportions from mixed-signal data [@problem_id:2852356].", "problem": "A spatial transcriptomics spot captures messenger ribonucleic acid (mRNA) from a mixture of cell types present in the capture area. Under the Central Dogma and linear additivity of mRNA counts, the expected spot-level expression of each gene equals the sum of contributions from each constituent cell type, proportional to that cell type’s abundance in the spot. Assume that both the spatial spot and the reference single-cell expression profiles have been normalized to the same scale (for example, transcripts per $10^{4}$), so that linear mixing across genes is valid.\n\nYou are given a reference single-cell expression matrix for $2$ marker genes across $2$ cell types, and a spatial spot gene expression vector:\n$$\nS_{\\text{ref}} \\in \\mathbb{R}^{2 \\times 2} = \n\\begin{pmatrix}\n10  2 \\\\\n5  8\n\\end{pmatrix},\n\\quad\ny \\in \\mathbb{R}^{2} =\n\\begin{pmatrix}\n7.6 \\\\\n6.1\n\\end{pmatrix}.\n$$\nLet $p \\in \\mathbb{R}^{2}$ denote the unknown nonnegative mixing proportions of the two cell types in the spot. Formulate the deconvolution as a nonnegative constrained regression problem that estimates $p$ by minimizing the squared residuals between the observed spot expression $y$ and the reconstructed expression $S_{\\text{ref}} p$, subject to the constraints that each entry of $p$ is nonnegative and the proportions sum to one. Then, solve for $p$.\n\nProvide your final answer as a row vector $\\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix}$, where $p_{1}$ and $p_{2}$ are the estimated proportions of cell type $1$ and cell type $2$, respectively. Round each estimated proportion to four significant figures. Do not include any units in your answer.", "solution": "The problem is to find the vector $p = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}$ that minimizes the objective function $L(p)$, defined as the squared Euclidean norm of the residual vector:\n$$\nL(p) = \\| y - S_{\\text{ref}} p \\|^2\n$$\nsubject to the constraints $p_1 \\ge 0$, $p_2 \\ge 0$, and $p_1 + p_2 = 1$.\n\nWe can use the equality constraint $p_1 + p_2 = 1$ to simplify the problem by expressing $p_2$ in terms of $p_1$:\n$$\np_2 = 1 - p_1\n$$\nThe nonnegativity constraints $p_1 \\ge 0$ and $p_2 \\ge 0$ become $p_1 \\ge 0$ and $1 - p_1 \\ge 0$, which simplifies to $0 \\le p_1 \\le 1$. The problem is now reduced to a one-dimensional optimization problem for $p_1$ over the closed interval $[0, 1]$.\n\nFirst, we write out the expression for the reconstructed expression vector $S_{\\text{ref}} p$:\n$$\nS_{\\text{ref}} p = \\begin{pmatrix} 10  2 \\\\ 5  8 \\end{pmatrix} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} = \\begin{pmatrix} 10p_1 + 2p_2 \\\\ 5p_1 + 8p_2 \\end{pmatrix}\n$$\nSubstituting $p_2 = 1 - p_1$:\n$$\nS_{\\text{ref}} p = \\begin{pmatrix} 10p_1 + 2(1 - p_1) \\\\ 5p_1 + 8(1 - p_1) \\end{pmatrix} = \\begin{pmatrix} 10p_1 + 2 - 2p_1 \\\\ 5p_1 + 8 - 8p_1 \\end{pmatrix} = \\begin{pmatrix} 8p_1 + 2 \\\\ -3p_1 + 8 \\end{pmatrix}\n$$\nNow, we formulate the objective function $L(p_1)$ in terms of $p_1$ only:\n$$\nL(p_1) = \\left\\| \\begin{pmatrix} 7.6 \\\\ 6.1 \\end{pmatrix} - \\begin{pmatrix} 8p_1 + 2 \\\\ -3p_1 + 8 \\end{pmatrix} \\right\\|^2 = \\left\\| \\begin{pmatrix} 5.6 - 8p_1 \\\\ 3p_1 - 1.9 \\end{pmatrix} \\right\\|^2\n$$\n$$\nL(p_1) = (5.6 - 8p_1)^2 + (3p_1 - 1.9)^2\n$$\nTo find the minimum, we compute the first derivative of $L(p_1)$ with respect to $p_1$ and set it to zero.\n$$\n\\frac{d L}{d p_1} = 2(5.6 - 8p_1)(-8) + 2(3p_1 - 1.9)(3) = 146p_1 - 101\n$$\nSet the derivative to zero to find the critical point:\n$$\n146p_1 - 101 = 0 \\implies p_1 = \\frac{101}{146}\n$$\nThe second derivative is $\\frac{d^2 L}{d p_1^2} = 146  0$, confirming that this critical point corresponds to a global minimum. The calculated value $p_1 \\approx 0.6918$ lies within the feasible interval $[0, 1]$, so the unconstrained minimum is the constrained minimum.\n\nWe calculate the numerical values for $p_1$ and $p_2$:\n$$\np_1 = \\frac{101}{146} \\approx 0.6917808...\n$$\n$$\np_2 = 1 - p_1 = 1 - \\frac{101}{146} = \\frac{45}{146} \\approx 0.3082191...\n$$\nRounding each proportion to four significant figures gives $p_1 \\approx 0.6918$ and $p_2 \\approx 0.3082$. The estimated proportion vector is $p = \\begin{pmatrix} 0.6918 \\\\ 0.3082 \\end{pmatrix}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.6918  0.3082 \\end{pmatrix}}\n$$", "id": "2852356"}, {"introduction": "Identifying genes with spatially structured expression patterns is a primary goal of these experiments, often accomplished using statistical models that assume spatial continuity. This practice presents a thought experiment designed to foster critical thinking about the validity of such models. By examining a tissue with discrete, biologically distinct structures, you will explore how a model's core assumptions can conflict with the underlying biology, a crucial consideration for robust scientific conclusions [@problem_id:1467346].", "problem": "A systems biologist is studying the spatial expression pattern of a specific gene, Gene-X, in a simulated two-dimensional tissue sample. A statistical model is proposed to describe the gene expression landscape. The model operates on a core assumption: the similarity in gene expression between any two points is expected to be high if they are close together and low if they are far apart. More formally, the model posits that the expected absolute difference in expression values between two points, $|E_i - E_j|$, should be a monotonically increasing function of the Euclidean distance, $d_{ij}$, between them.\n\nThe simulated tissue is defined on a 2D Cartesian plane and contains two discrete, circular \"active regions,\" Region-A and Region-B, embedded in a quiescent \"background\" tissue.\n- Region-A is a circle of radius $R_A = 5$ units, centered at $C_A = (15, 15)$.\n- Region-B is a circle of radius $R_B = 5$ units, centered at $C_B = (45, 45)$.\n- The expression level of Gene-X, $E(x,y)$, is defined as follows: if a point $(x,y)$ is inside either Region-A or Region-B, its expression is $E=100$. If the point is in the background tissue, its expression is $E=10$.\n\nTo evaluate the model's suitability, four specific points are sampled:\n- $P_1 = (14, 15)$\n- $P_2 = (16, 15)$\n- $P_3 = (46, 45)$\n- $P_4 = (21, 15)$\n\nGiven the model's core assumption, which of the following scenarios presents the most fundamental challenge to the model's ability to accurately represent the underlying biological organization of this tissue?\n\nA. The relationship between points $P_1$ and $P_2$.\n\nB. The relationship between points $P_1$ and $P_3$.\n\nC. The relationship between points $P_1$ and $P_4$.\n\nD. The model is well-suited for this data, and none of these scenarios present a fundamental challenge.", "solution": "The tissue has two circular active regions with expression $E=100$ and background with expression $E=10$. Formally,\n$$\nE(x,y)=\\begin{cases}\n100,  (x-15)^{2}+(y-15)^{2}\\leq 25 \\text{ or } (x-45)^{2}+(y-45)^{2}\\leq 25,\\\\\n10,  \\text{otherwise}.\n\\end{cases}\n$$\nThe model’s core assumption is that the expected absolute difference $|E_{i}-E_{j}|$ is a monotonically increasing function of Euclidean distance $d_{ij}$.\n\nFirst, determine the expression at each sampled point.\n- $P_{1}=(14,15)$: $(14-15)^{2}+(15-15)^{2}=1\\leq 25$, so $E_{1}=100$.\n- $P_{2}=(16,15)$: $(16-15)^{2}+(15-15)^{2}=1\\leq 25$, so $E_{2}=100$.\n- $P_{3}=(46,45)$: $(46-45)^{2}+(45-45)^{2}=1\\leq 25$, so $E_{3}=100$.\n- $P_{4}=(21,15)$: $(21-15)^{2}+(15-15)^{2}=3625$ and $(21-45)^{2}+(15-45)^{2}=24^{2}+30^{2}=147625$, so $E_{4}=10$.\n\nNext, compute the pairwise distances and absolute differences relevant to the options.\n- For $P_{1}$ and $P_{2}$:\n$$\nd_{12}=\\sqrt{(14-16)^{2}+(15-15)^{2}}=\\sqrt{4}=2,\\quad |E_{1}-E_{2}|=|100-100|=0.\n$$\n- For $P_{1}$ and $P_{3}$:\n$$\nd_{13}=\\sqrt{(14-46)^{2}+(15-45)^{2}}=\\sqrt{32^{2}+30^{2}}=\\sqrt{1024+900}=\\sqrt{1924} \\approx 43.9,\\quad |E_{1}-E_{3}|=|100-100|=0.\n$$\n- For $P_{1}$ and $P_{4}$:\n$$\nd_{14}=\\sqrt{(14-21)^{2}+(15-15)^{2}}=\\sqrt{49}=7,\\quad |E_{1}-E_{4}|=|100-10|=90.\n$$\n\nWe order the distances and the corresponding observed absolute differences:\n- $d_{12} = 2$, $|E_1 - E_2| = 0$\n- $d_{14} = 7$, $|E_1 - E_4| = 90$\n- $d_{13} \\approx 43.9$, $|E_1 - E_3| = 0$\n\nThe model assumes that as distance increases, the expected expression difference also increases. The relationship between points $P_1$ and $P_3$ is the most direct contradiction to this assumption. These two points are very far apart (the largest distance among the pairs considered) but have an expression difference of zero. This is because they belong to two distinct but biologically identical active regions. A model based solely on Euclidean distance would predict a large difference between $P_1$ and $P_3$. The existence of such discrete, repeating biological structures systematically violates the model's assumption of continuous spatial correlation, posing a fundamental challenge. The pair $(P_1, P_2)$ is consistent with the model (small distance, small difference). The pair $(P_1, P_4)$ shows a sharp change across a boundary, which is challenging for continuous models but is not as fundamental a violation as the long-range similarity shown by $(P_1, P_3)$.", "answer": "$$\\boxed{B}$$", "id": "1467346"}]}