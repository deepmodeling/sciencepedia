{"hands_on_practices": [{"introduction": "Before any genetic mapping can occur, the raw data from a meiotic cross—the genotypes of the four spores in a tetrad—must be accurately classified. This foundational exercise ([@problem_id:2864980]) challenges you to develop a precise algorithmic rule to sort unordered tetrads into their fundamental types: Parental Ditype (PD), Nonparental Ditype (NPD), and Tetratype (T), while also identifying invalid data that violates the laws of meiotic segregation. Mastering this step ensures the integrity of all subsequent genetic analyses.", "problem": "You are given an unordered tetrad from a single meiosis in an ascomycete-like organism, heterozygous at two biallelic markers. Let the two loci be denoted by alleles $A/a$ and $B/b$, and assume the diploid prior to meiosis is formed by crossing two haploid parents $AB$ and $ab$, so the zygote is in coupling phase $AB/ab$. Each tetrad is represented as a multiset of $4$ haploid two-locus genotypes drawn from the set $\\{AB, Ab, aB, ab\\}$. The four spores are unordered; that is, any permutation of the $4$ genotypes denotes the same tetrad. The foundational facts to be used are: (i) at each locus in a complete tetrad, meiotic segregation yields a $2{:}2$ distribution of alleles (exactly two spores carry $A$ and two carry $a$; likewise exactly two carry $B$ and two carry $b$), and (ii) recombination can generate nonparental two-locus combinations $Ab$ and $aB$.\n\nYour task is to design a program that implements an algorithmic classification rule that maps any given tetrad into exactly one of the following classes, encoded numerically as specified below:\n- Parental Ditype (PD): code $0$.\n- Tetratype (T): code $1$.\n- Nonparental Ditype (NPD): code $2$.\n- Invalid (violates $2{:}2$ segregation at either locus or contains symbols outside $\\{A,a,B,b\\}$): code $-1$.\n\nThe algorithm you implement must be derived from first principles starting from the facts above. In particular, you must rigorously base your classification solely on the multiset of $4$ observed two-locus genotypes and the $2{:}2$ segregation constraints at each locus, without relying on prepackaged formulas. Your program must:\n- Treat the tetrad as unordered (classification must be invariant to spore permutation).\n- Verify the $2{:}2$ segregation constraint at each locus before classifying; if violated or if any genotype contains a character not in $\\{A,a,B,b\\}$ or is not exactly of length $2$, return the code $-1$.\n- Otherwise, map the tetrad to $0$ for Parental Ditype if and only if it contains exactly the two parental genotypes $AB$ and $ab$, each appearing with multiplicity $2$; map to $2$ for Nonparental Ditype if and only if it contains exactly the two nonparental genotypes $Ab$ and $aB$, each appearing with multiplicity $2$; map to $1$ for Tetratype if and only if it contains all four genotypes $\\{AB, Ab, aB, ab\\}$ each with multiplicity $1$.\n\nTest suite and output specification:\n- Use the following $5$ tetrads as the fixed test suite, in this order:\n    $1.$ $\\{AB, AB, ab, ab\\}$.\n    $2.$ $\\{Ab, Ab, aB, aB\\}$.\n    $3.$ $\\{AB, Ab, aB, ab\\}$.\n    $4.$ $\\{AB, AB, Ab, ab\\}$.\n    $5.$ $\\{AB, ab, aB, aX\\}$.\n- Your program should produce a single line of output containing the results as a comma-separated list of integers enclosed in square brackets, with no spaces. For example, an output of the form $[r_1,r_2,r_3,r_4,r_5]$ where each $r_i$ is the code for test case $i$.\n- There are no physical units or angles in this problem. All results are integers.\n\nYour implementation must be a complete, runnable program that produces only the final required output line when executed.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of meiotic genetics, is mathematically well-posed, and is defined with objective, unambiguous language. It does not violate any of the criteria for invalidity. I will therefore proceed with a solution derived from first principles.\n\nThe task is to construct a classification algorithm for an unordered meiotic tetrad from a diploid zygote of genotype $AB/ab$. The classification must distinguish between Parental Ditype ($PD$), Nonparental Ditype ($NPD$), Tetratype ($T$), and Invalid tetrads.\n\n**Derivation of the Algorithm from First Principles**\n\nThe algorithm must first enforce the fundamental constraints of genetics and the problem's definitions before any classification is attempted. This establishes a logical hierarchy: validation precedes classification.\n\n**1. Validation Phase: Enforcing Biological and Formal Correctness**\n\nLet the input tetrad be a multiset of four two-locus genotypes, $T = \\{g_1, g_2, g_3, g_4\\}$.\n\n- **Formal Validity**: The problem defines genotypes as two-character strings. The first character must be from the set $\\{A, a\\}$ and the second from $\\{B, b\\}$. Any deviation from this format, such as incorrect string length or the presence of undefined symbols (e.g., '$X$'), constitutes a formal violation. Such an input is not a valid tetrad under the problem's specification and must be rejected.\n\n- **Biological Validity (The $2{:}2$ Segregation Law)**: A cornerstone of meiosis at a single heterozygous locus is the law of segregation, which dictates that a complete tetrad must contain a $2{:}2$ ratio of the alleles. For the two loci in question, this translates to four strict conditions. Let $C(x)$ be the total count of allele $x$ across all four spores in the tetrad. The conditions are:\n$$\nC(A) = 2 \\quad \\land \\quad C(a) = 2\n$$\n$$\nC(B) = 2 \\quad \\land \\quad C(b) = 2\n$$\nIf any of these four equalities are not met, the tetrad represents an aneuploidy or other meiotic error, or is simply a malformed input. In either case, it is classified as Invalid (code $-1$).\n\nAn algorithm must begin by iterating through the four given genotypes, verifying their formal structure and simultaneously computing the aggregate allele counts $C(A), C(a), C(B), C(b)$. If any check fails, the process terminates and returns $-1$.\n\n**2. Classification Phase: Analysis of Valid Tetrads**\n\nA tetrad that successfully passes the validation phase is a legitimate meiotic product conforming to the $2{:}2$ segregation rule. Its classification into $PD$, $NPD$, or $T$ is based on its composition of parental ($AB, ab$) and nonparental ($Ab, aB$) genotypes.\n\nA crucial insight arises from analyzing the number of distinct genotype *types* a valid tetrad can contain.\n- **One distinct type**: A tetrad of $\\{g, g, g, g\\}$ cannot satisfy the $2{:}2$ rule. For example, $\\{AB, AB, AB, AB\\}$ gives $C(A)=4$, not $2$. So, this is impossible.\n- **Three distinct types**: A tetrad of the form $\\{g_1, g_1, g_2, g_3\\}$ for distinct $g_1, g_2, g_3$ also cannot satisfy the $2{:}2$ rule. If we let $g_1=AB$, the first two spores contribute counts of $C(A)=2, C(B)=2$. To satisfy the overall $2{:}2$ rule, the remaining spores $g_2, g_3$ must contribute $C(a)=2, C(b)=2$, which means $g_2=ab$ and $g_3=ab$. This forces the tetrad to be $\\{AB, AB, ab, ab\\}$, which has only two distinct types, a contradiction. So, three distinct types are impossible.\n\nTherefore, any valid tetrad must contain exactly **two** or **four** distinct genotype types. This key deduction provides a robust framework for classification.\n\n- **Case 1: Four Distinct Genotypes**\n  If a tetrad contains four distinct genotypes, and given that the total number of spores is four, it must be the multiset $\\{AB, Ab, aB, ab\\}$, with each genotype appearing with multiplicity $1$. This is the definition of a **Tetratype (T)**. We can verify it is valid: $C(A)$ comes from $AB$ and $Ab$, so $C(A)=2$. $C(a)$ from $aB$ and $ab$, so $C(a)=2$. Similarly, $C(B)=2$ and $C(b)=2$. Such a tetrad is classified as $T$ (code $1$).\n\n- **Case 2: Two Distinct Genotypes**\n  If a tetrad contains two distinct genotypes, its form must be $\\{g_1, g_1, g_2, g_2\\}$. To satisfy the $2{:}2$ rule for both loci, the genotypes $g_1$ and $g_2$ must be complementary. For instance, if $g_1=AB$, its contribution is $1A, 1B$. To reach the target of $2A, 2a, 2B, 2b$, the two spores of type $g_2$ must collectively contribute $1A, 2a, 1B, 2b$. This is impossible. Instead, the two $g_1$ spores contribute $2A, 2B$. The two $g_2$ spores must then contribute $0A, 2a, 0B, 2b$, meaning $g_2=ab$. Thus, the only possible pairs of genotypes are $(AB, ab)$ and $(Ab, aB)$. This leads to two sub-cases:\n  - **Parental Ditype (PD)**: The two genotypes are the parental types, $\\{AB, ab\\}$. The tetrad is $\\{AB, AB, ab, ab\\}$. This is classified as $PD$ (code $0$).\n  - **Nonparental Ditype (NPD)**: The two genotypes are the nonparental types, $\\{Ab, aB\\}$. The tetrad is $\\{Ab, Ab, aB, aB\\}$. This is classified as $NPD$ (code $2$).\n\n**Final Algorithm Structure**\n1.  Implement the validation checks (formal and biological). Return $-1$ upon failure.\n2.  If the tetrad is valid, count the multiplicities of the four possible genotypes: $N_{AB}, N_{Ab}, N_{aB}, N_{ab}$.\n3.  Apply the classification rules based on these counts, which are mutually exclusive.\n    - If $N_{AB}=2$ and $N_{ab}=2$, return $0$ (PD).\n    - If $N_{Ab}=2$ and $N_{aB}=2$, return $2$ (NPD).\n    - If $N_{AB}=1, N_{Ab}=1, N_{aB}=1, N_{ab}=1$, return $1$ (T).\nThis procedure is complete, correct, and derived directly from the axiomatic foundations of the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport collections\n\ndef solve():\n    \"\"\"\n    Solves the tetrad classification problem for the specified test suite.\n    \"\"\"\n\n    def classify_tetrad(tetrad: list[str]) - int:\n        \"\"\"\n        Classifies a single meiotic tetrad based on genetic principles.\n\n        The classification follows a two-step process: validation and then classification.\n        A tetrad is invalid if it violates formal structure or the 2:2 allele segregation law.\n        A valid tetrad is classified as PD, T, or NPD based on its genotype composition.\n\n        Args:\n            tetrad: A list of 4 strings representing the genotypes of the spores.\n\n        Returns:\n            An integer code: 0 for PD, 1 for T, 2 for NPD, -1 for Invalid.\n        \"\"\"\n        # --- Step 1: Validation ---\n        \n        # 1a: Check basic structure (must be 4 spores)\n        if len(tetrad) != 4:\n            return -1\n\n        # 1b: Check allele validity and count alleles for segregation check\n        allele_counts = collections.defaultdict(int)\n        valid_alleles_locus1 = {'A', 'a'}\n        valid_alleles_locus2 = {'B', 'b'}\n\n        for genotype in tetrad:\n            # Genotype must be a string of length 2\n            if not isinstance(genotype, str) or len(genotype) != 2:\n                return -1\n            \n            allele1, allele2 = genotype[0], genotype[1]\n            \n            # Alleles must be from the allowed sets\n            if allele1 not in valid_alleles_locus1 or allele2 not in valid_alleles_locus2:\n                return -1\n\n            allele_counts[allele1] += 1\n            allele_counts[allele2] += 1\n\n        # 1c: Check for 2:2 allele segregation law\n        if not (allele_counts.get('A', 0) == 2 and allele_counts.get('a', 0) == 2 and\n                allele_counts.get('B', 0) == 2 and allele_counts.get('b', 0) == 2):\n            return -1\n\n        # --- Step 2: Classification of Valid Tetrads ---\n        \n        genotype_counts = collections.Counter(tetrad)\n        \n        # Parental Ditype (PD): code 0\n        # Contains exactly the two parental genotypes, AB and ab, each with multiplicity 2.\n        if genotype_counts.get('AB', 0) == 2 and genotype_counts.get('ab', 0) == 2:\n            return 0\n            \n        # Nonparental Ditype (NPD): code 2\n        # Contains exactly the two nonparental genotypes, Ab and aB, each with multiplicity 2.\n        if genotype_counts.get('Ab', 0) == 2 and genotype_counts.get('aB', 0) == 2:\n            return 2\n            \n        # Tetratype (T): code 1\n        # Contains all four genotypes {AB, Ab, aB, ab}, each with multiplicity 1.\n        if (genotype_counts.get('AB', 0) == 1 and genotype_counts.get('Ab', 0) == 1 and\n            genotype_counts.get('aB', 0) == 1 and genotype_counts.get('ab', 0) == 1):\n            return 1\n            \n        # Per the derivation, a valid tetrad must fall into one of the above three categories.\n        # This fallback is for logical completeness but should not be reached.\n        return -1\n\n\n    # Define the fixed test suite from the problem statement.\n    test_cases = [\n        ['AB', 'AB', 'ab', 'ab'],    # Case 1: PD\n        ['Ab', 'Ab', 'aB', 'aB'],    # Case 2: NPD\n        ['AB', 'Ab', 'aB', 'ab'],    # Case 3: T\n        ['AB', 'AB', 'Ab', 'ab'],    # Case 4: Invalid (violates 2:2 segregation rule)\n        ['AB', 'ab', 'aB', 'aX']     # Case 5: Invalid (contains illegal character 'X')\n    ]\n\n    results = []\n    for case in test_cases:\n        result = classify_tetrad(case)\n        results.append(result)\n\n    # Final print statement must produce only the required single-line format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2864980"}, {"introduction": "With classified tetrad counts in hand, we can move from simple description to mechanistic inference. This practice ([@problem_id:2865003]) guides you through deriving a crucial estimator that uses the observed numbers of Tetratype ($T$) and Nonparental Ditype ($NPD$) asci to infer the frequency of single crossover events. This process illuminates how observed tetrad patterns are a composite signal of different, underlying crossover events and introduces the concept of chromatid interference as a testable biological hypothesis.", "problem": "In an unordered tetrad analysis for two loci in the yeast Saccharomyces cerevisiae, each meiotic tetrad is scored as parental ditype (PD), tetratype (T), or nonparental ditype (NPD). Assume the following fundamental and well-established facts about how recombination classes map to tetrad categories for two linked loci:\n\n- A single chromosomal exchange between the two loci during meiosis yields a tetratype ascus.\n- A double exchange yields one of three chromatid-involvement classes: two-strand, three-strand, or four-strand. These produce, respectively, parental ditype, tetratype, and nonparental ditype asci.\n- Under the assumption of no chromatid interference, the three classes of double exchanges occur with probabilities in the ratio $1:2:1$ for two-strand, three-strand, and four-strand double crossovers, respectively.\n\nLet $T$ and $NPD$ denote the observed numbers of tetratype and nonparental ditype asci in a sample of $n$ unordered tetrads. Let $S$ denote the (unknown) number of tetrads that experienced a single crossover between the loci, and let $D_{2}$, $D_{3}$, and $D_{4}$ denote the (unknown) numbers of double-crossover tetrads of the two-strand, three-strand, and four-strand types, respectively.\n\nStarting from the definitions above, derive an estimator for $S$ that depends only on the observed counts $T$ and $NPD$ under the no chromatid interference assumption. Express your final estimator as a single closed-form algebraic expression in terms of $T$ and $NPD$. If the estimator can be negative for some data sets, state briefly what a negative value would diagnose conceptually. Your final reported answer must be only the algebraic expression for the estimator (no units), written in simplest form. No rounding is required.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of meiotic genetics, well-posed, and objective. It presents a standard exercise in deriving an estimator from a simple mechanistic model of genetic recombination. We shall now proceed with the derivation.\n\nThe task is to derive an estimator for $S$, the number of single-crossover tetrads, using only the observed counts of tetratype ($T$) and nonparental ditype ($NPD$) asci. The derivation depends on the relationships between crossover events and the resulting tetrad types, under the explicit assumption of no chromatid interference.\n\nLet us formalize the relationships between the unobserved counts of crossover events and the observed counts of tetrad types. The problem provides the following mappings:\n$1$. A single crossover (SCO) between the two loci results in a tetratype ($T$) ascus. The total number of such events is $S$.\n$2$. A four-strand double crossover (DCO) results in a nonparental ditype ($NPD$) ascus. The total number of such events is $D_4$.\n$3$. A three-strand DCO results in a tetratype ($T$) ascus. The total number of such events is $D_3$.\n$4$. A two-strand DCO results in a parental ditype ($PD$) ascus. The total number of such events is $D_2$.\n\nFrom these definitions, we can write equations for the total observed counts of $T$ and $NPD$ asci. The total number of tetratype asci, $T$, is the sum of those produced by single crossovers and those produced by three-strand double crossovers.\n$$T = S + D_3 \\quad (1)$$\nThe total number of nonparental ditype asci, $NPD$, arises exclusively from four-strand double crossovers.\n$$NPD = D_4 \\quad (2)$$\nThe problem states that we must assume no chromatid interference. This assumption has a precise mathematical consequence: the three classes of double crossovers (two-strand, three-strand, and four-strand) occur in the ratio $1:2:1$. Therefore, their counts in a large sample are expected to follow the same ratio:\n$$D_2 : D_3 : D_4 = 1:2:1$$\nFrom this ratio, we can establish direct relationships between the counts of the double-crossover classes. Specifically, we are interested in the relationship involving $D_3$ and $D_4$, as these are connected to our observables $T$ and $NPD$.\n$$D_3 = 2 D_4 \\quad (3)$$\nAnd also,\n$$D_2 = D_4 \\quad (4)$$\nOur objective is to find an expression for $S$ in terms of $T$ and $NPD$. We begin with equation $(1)$:\n$$S = T - D_3$$\nTo complete the derivation, we must express $D_3$ using the observable quantities. Using equation $(3)$, we relate $D_3$ to $D_4$.\n$$D_3 = 2 D_4$$\nNext, we use equation $(2)$ to substitute the observable count $NPD$ for the unobservable count $D_4$.\n$$D_4 = NPD$$\nSubstituting this into the expression for $D_3$ yields:\n$$D_3 = 2 \\times NPD$$\nFinally, we substitute this expression for $D_3$ back into our equation for $S$:\n$$S = T - (2 \\times NPD)$$\nThis expression provides the estimator for the number of single-crossover tetrads, $\\hat{S}$, based solely on the observed counts $T$ and $NPD$.\n$$\\hat{S} = T - 2NPD$$\nThe problem also requires a conceptual diagnosis for a negative value of this estimator. The number of single-crossover events, $S$, is a physical count and must be non-negative, $S \\ge 0$. Therefore, a negative estimate $\\hat{S}  0$ is a physical impossibility and points to a failure in the model or its applicability to the dataset.\nA negative estimate, where $T  2NPD$, signifies that the observed number of tetratypes is insufficient to account for the number of three-strand double crossovers predicted from the observed nonparental ditypes under the no-interference model. Such a result diagnoses one of two possibilities:\n$1$. **Sampling error**: In a finite sample, particularly a small one, random fluctuations can lead to a deviation from the expected ratios (e.g., an over-representation of $NPD$ asci or under-representation of $T$ asci relative to their true mean frequencies), causing the estimator to become negative by chance.\n$2$. **Violation of the \"no chromatid interference\" assumption**: This is a more fundamental biological interpretation. The model's prediction that $D_3 = 2 D_4$ may be incorrect for the organism or genomic region being studied. A negative $\\hat{S}$ suggests that the true ratio $D_3 / D_4$ is less than $2$. This phenomenon, where the proportions of double-crossover types deviate from the $1:2:1$ expectation, is known as chromatid interference. Therefore, a negative estimate for $S$ is a primary indicator of chromatid interference.", "answer": "$$\\boxed{T - 2NPD}$$", "id": "2865003"}, {"introduction": "The ultimate goal of many linkage studies is to construct a linear genetic map that represents the arrangement and spacing of genes on a chromosome. This final exercise ([@problem_id:2865030]) tackles a common real-world challenge: reconciling pairwise distance estimates that are individually subject to sampling error and may not be perfectly additive. You will use logical deduction to determine the most likely gene order and then apply a least-squares adjustment to produce a statistically robust and coherent three-point map.", "problem": "In a homothallic fungus that forms unordered tetrads, three loci $A$, $B$, and $C$ were genotyped across a large number of asci. For each pair of loci, the investigator computed a preliminary pairwise map distance estimate $\\hat{d}_{ij}$ in morgans by first converting the observed frequencies of Tetratype ($f_T$) and Nonparental Ditype ($f_{NPD}$) tetrads to an estimated chromatid recombination fraction $\\hat{r}_{ij}$ via the formula $\\hat{r}_{ij} = \\frac{f_T}{2} + f_{NPD}$, and then applying the no-interference (Haldane) mapping function to obtain $\\hat{d}_{ij} = -\\frac{1}{2}\\ln(1 - 2\\hat{r}_{ij})$. The resulting preliminary interlocus distance estimates (in morgans) are:\n- $\\hat{d}_{AB} = 0.145$,\n- $\\hat{d}_{BC} = 0.202$,\n- $\\hat{d}_{AC} = 0.331$.\n\nBecause true map distances are additive along a linear order but the preliminary estimates $\\hat{d}_{ij}$ contain sampling noise, they need not satisfy additivity exactly. Assume no crossover interference (so that Haldane distances are additive) and that true segment distances are nonnegative. Among the three possible linear orders, select the order that is consistent with these constraints and then perform an unweighted least-squares adjustment to enforce additivity for that order. Concretely, if the chosen order is $A$–$B$–$C$, introduce unknown nonnegative segment lengths $a = d_{AB}$ and $b = d_{BC}$, predict $d_{AC}$ by $a + b$, and choose $a$ and $b$ to minimize the sum of squared deviations between the predicted distances and the preliminary estimates $\\hat{d}_{ij}$.\n\nWhat is the adjusted map distance between loci $A$ and $C$ in morgans after enforcing additivity by this least-squares projection under the selected order? Round your answer to four significant figures and express it in morgans. Do not include units in your final answer.", "solution": "The problem requires the determination of a linear gene order for three loci, $A$, $B$, and $C$, and a subsequent least-squares adjustment of the map distances to enforce additivity.\n\nThe solution proceeds in two stages: determination of the gene order and least-squares adjustment.\n\n**Stage 1: Determination of Gene Order**\nThere are $3$ possible linear orders for three loci: $A-B-C$, $A-C-B$, and $B-A-C$. Assuming additivity of map distances, the distance between the two outermost loci should be equal to the sum of the distances between the adjacent loci. We compare the sum of the two smaller estimated distances with the largest estimated distance for each possible order to find the one with the minimum discrepancy.\n\nThe given preliminary distance estimates are:\n$\\hat{d}_{AB} = 0.145$ morgans\n$\\hat{d}_{BC} = 0.202$ morgans\n$\\hat{d}_{AC} = 0.331$ morgans\n\nCase 1: Order $A-B-C$. The expected relationship is $d_{AC} = d_{AB} + d_{BC}$. Using the estimates, we check $\\hat{d}_{AB} + \\hat{d}_{BC}$ against $\\hat{d}_{AC}$.\n$\\hat{d}_{AB} + \\hat{d}_{BC} = 0.145 + 0.202 = 0.347$.\nThe discrepancy is $|(\\hat{d}_{AB} + \\hat{d}_{BC}) - \\hat{d}_{AC}| = |0.347 - 0.331| = 0.016$.\n\nCase 2: Order $A-C-B$. The expected relationship is $d_{AB} = d_{AC} + d_{CB}$. Using the estimates, we check $\\hat{d}_{AC} + \\hat{d}_{BC}$ against $\\hat{d}_{AB}$.\n$\\hat{d}_{AC} + \\hat{d}_{BC} = 0.331 + 0.202 = 0.533$.\nThe discrepancy is $|(\\hat{d}_{AC} + \\hat{d}_{BC}) - \\hat{d}_{AB}| = |0.533 - 0.145| = 0.388$.\n\nCase 3: Order $B-A-C$. The expected relationship is $d_{BC} = d_{BA} + d_{AC}$. Using the estimates, we check $\\hat{d}_{AB} + \\hat{d}_{AC}$ against $\\hat{d}_{BC}$.\n$\\hat{d}_{AB} + \\hat{d}_{AC} = 0.145 + 0.331 = 0.476$.\nThe discrepancy is $|(\\hat{d}_{AB} + \\hat{d}_{AC}) - \\hat{d}_{BC}| = |0.476 - 0.202| = 0.274$.\n\nThe smallest discrepancy ($0.016$) corresponds to the order $A-B-C$. This is selected as the most probable linear order.\n\n**Stage 2: Unweighted Least-Squares Adjustment**\nFor the order $A-B-C$, let the adjusted, nonnegative segment distances be $a = d_{AB}$ and $b = d_{BC}$. By the additivity principle, the adjusted distance between the outer loci is $d_{AC} = a + b$.\n\nThe objective is to find the values of $a$ and $b$ that minimize the sum of squared deviations, $S(a, b)$, between the preliminary estimates $\\hat{d}_{ij}$ and the adjusted distances.\n$$S(a, b) = (\\hat{d}_{AB} - a)^2 + (\\hat{d}_{BC} - b)^2 + (\\hat{d}_{AC} - (a+b))^2$$\nSubstituting the given numerical values:\n$$S(a, b) = (0.145 - a)^2 + (0.202 - b)^2 + (0.331 - a - b)^2$$\nTo find the minimum, we compute the partial derivatives of $S$ with respect to $a$ and $b$ and set them to $0$.\n$$\\frac{\\partial S}{\\partial a} = -2(0.145 - a) - 2(0.331 - a - b) = 0$$\n$$\\frac{\\partial S}{\\partial b} = -2(0.202 - b) - 2(0.331 - a - b) = 0$$\nDividing by $-2$ simplifies the system:\n$$ (0.145 - a) + (0.331 - a - b) = 0 $$\n$$ (0.202 - b) + (0.331 - a - b) = 0 $$\nCombining terms, we obtain a system of two linear equations:\n$$ 2a + b - 0.476 = 0 \\implies 2a + b = 0.476 \\quad (1) $$\n$$ a + 2b - 0.533 = 0 \\implies a + 2b = 0.533 \\quad (2) $$\nWe must solve this system for $a$ and $b$. From equation $(1)$, $b = 0.476 - 2a$. Substituting this into equation $(2)$:\n$$ a + 2(0.476 - 2a) = 0.533 $$\n$$ a + 0.952 - 4a = 0.533 $$\n$$ -3a = 0.533 - 0.952 $$\n$$ -3a = -0.419 $$\n$$ a = \\frac{0.419}{3} $$\nNow, substitute the value of $a$ back into the expression for $b$:\n$$ b = 0.476 - 2\\left(\\frac{0.419}{3}\\right) = \\frac{1.428}{3} - \\frac{0.838}{3} = \\frac{0.590}{3} $$\nBoth $a$ and $b$ are positive, satisfying the nonnegativity constraint.\n\nThe problem asks for the adjusted map distance between loci $A$ and $C$, which is $d_{AC} = a + b$.\n$$ d_{AC} = a + b = \\frac{0.419}{3} + \\frac{0.590}{3} = \\frac{0.419 + 0.590}{3} = \\frac{1.009}{3} $$\nCalculating the numerical value:\n$$ d_{AC} \\approx 0.336333... $$\nRounding to four significant figures as required, we get $0.3363$. This is the adjusted map distance between $A$ and $C$.", "answer": "$$\\boxed{0.3363}$$", "id": "2865030"}]}