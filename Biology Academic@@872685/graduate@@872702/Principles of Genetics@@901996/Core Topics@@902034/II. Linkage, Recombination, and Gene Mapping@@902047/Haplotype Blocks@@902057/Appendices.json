{"hands_on_practices": [{"introduction": "The foundation of identifying haplotype blocks lies in detecting historical recombination events. The four-gamete test provides a powerful, direct method for this purpose. This practice exercise challenges you to apply this test to a set of phased haplotypes to pinpoint the minimal number of recombination breakpoints, a fundamental skill for parsing the structure of a chromosome. [@problem_id:2820834]", "problem": "A genomic region contains $4$ ordered single-nucleotide polymorphisms (SNPs), denoted $S_1, S_2, S_3, S_4$. Under the infinite-sites model with no recurrent mutation, no gene conversion, and random mating, you have phased haplotypes for $6$ sampled chromosomes across these SNPs, with alleles encoded as $0$ and $1$ in the order $(S_1,S_2,S_3,S_4)$:\n- $H_1 = (0,0,0,0)$\n- $H_2 = (0,1,0,0)$\n- $H_3 = (1,0,0,0)$\n- $H_4 = (1,1,0,0)$\n- $H_5 = (0,0,1,0)$\n- $H_6 = (0,1,1,1)$\n\nApply the four-gamete test to each adjacent SNP pair $(S_1,S_2)$, $(S_2,S_3)$, and $(S_3,S_4)$. A recombination breakpoint is defined here as the presence of at least one historical recombination event in the inter-SNP interval between adjacent markers. Identify the minimal set of inter-SNP intervals that must contain recombination breakpoints to be consistent with the observed phased haplotypes under the model assumptions.\n\nReport only the minimal number of distinct recombination breakpoints between adjacent SNPs. Provide the number only. No rounding is necessary.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on fundamental principles of population genetics, specifically the infinite-sites model and the four-gamete test for detecting recombination. All necessary data and definitions are provided, and the problem is free of ambiguity or contradiction. It is a valid and solvable problem.\n\nThe core principle to be applied is the four-gamete test. Under the infinite-sites model, where each mutation arises at a unique position on the chromosome and never reverts, the genealogical history of a set of non-recombining sequences can be represented by a single perfect phylogeny (a tree). For any two biallelic single-nucleotide polymorphisms (SNPs), with alleles denoted as $0$ and $1$, there are four possible two-site haplotypes (gametes): $(0,0)$, $(0,1)$, $(1,0)$, and $(1,1)$. If there has been no recombination between the two SNP loci, only three of these four gametes can be present in a sample. The appearance of the fourth gamete can only be explained by a historical recombination event that brought together alleles from different ancestral backgrounds. Therefore, the observation of all four gametes between two sites is sufficient evidence to infer at least one recombination event in the interval separating them.\n\nWe are given $4$ ordered SNPs, $S_1, S_2, S_3, S_4$, and $6$ phased haplotypes:\n$H_1 = (0,0,0,0)$\n$H_2 = (0,1,0,0)$\n$H_3 = (1,0,0,0)$\n$H_4 = (1,1,0,0)$\n$H_5 = (0,0,1,0)$\n$H_6 = (0,1,1,1)$\n\nWe will apply the four-gamete test to each of the $3$ adjacent inter-SNP intervals.\n\n1.  Interval between $S_1$ and $S_2$:\n    We extract the two-site haplotypes for the pair $(S_1, S_2)$ from the $6$ given full haplotypes:\n    - From $H_1$: $(0,0)$\n    - From $H_2$: $(0,1)$\n    - From $H_3$: $(1,0)$\n    - From $H_4$: $(1,1)$\n    - From $H_5$: $(0,0)$\n    - From $H_6$: $(0,1)$\n    The set of unique two-site haplotypes observed is $\\{(0,0), (0,1), (1,0), (1,1)\\}$. Since all four possible gametes are present, we must conclude that at least one historical recombination event has occurred in the interval between $S_1$ and $S_2$. This interval must contain a recombination breakpoint.\n\n2.  Interval between $S_2$ and $S_3$:\n    We extract the two-site haplotypes for the pair $(S_2, S_3)$:\n    - From $H_1$: $(0,0)$\n    - From $H_2$: $(1,0)$\n    - From $H_3$: $(0,0)$\n    - From $H_4$: $(1,0)$\n    - From $H_5$: $(0,1)$\n    - From $H_6$: $(1,1)$\n    The set of unique two-site haplotypes observed is $\\{(0,0), (1,0), (0,1), (1,1)\\}$. Again, all four possible gametes are present. Therefore, we must infer that at least one recombination event has occurred in the interval between $S_2$ and $S_3$. This interval must also contain a recombination breakpoint.\n\n3.  Interval between $S_3$ and $S_4$:\n    We extract the two-site haplotypes for the pair $(S_3, S_4)$:\n    - From $H_1$: $(0,0)$\n    - From $H_2$: $(0,0)$\n    - From $H_3$: $(0,0)$\n    - From $H_4$: $(0,0)$\n    - From $H_5$: $(1,0)$\n    - From $H_6$: $(1,1)$\n    The set of unique two-site haplotypes observed is $\\{(0,0), (1,0), (1,1)\\}$. In this case, only three of the four possible gametes are present. The gamete $(0,1)$ is not observed in the sample. The absence of the fourth gamete means that the data are consistent with a history of no recombination between loci $S_3$ and $S_4$. Therefore, the four-gamete test does not provide evidence for, and does not require, a recombination breakpoint in this interval.\n\nBased on this systematic analysis, the minimal set of inter-SNP intervals that must contain recombination breakpoints to be consistent with the data comprises the interval between $S_1$ and $S_2$, and the interval between $S_2$ and $S_3$.\n\nThe minimal number of distinct recombination breakpoints between adjacent SNPs is therefore $2$.", "answer": "$$\\boxed{2}$$", "id": "2820834"}, {"introduction": "While phased haplotypes are ideal, genomic data from diploid organisms often consists of unphased genotypes. A classic and powerful method for resolving this ambiguity is to use data from family trios (two parents and an offspring). By applying the principles of Mendelian inheritance, you can deduce which alleles were transmitted together, effectively reconstructing the haplotypes and identifying block structures as demonstrated in this problem. [@problem_id:2820870]", "problem": "A genotyped family trio consists of two parents and one offspring typed at three adjacent biallelic Single Nucleotide Polymorphism (SNP) markers, denoted $S_1$, $S_2$, and $S_3$, ordered along a chromosome from left to right. Each SNP has alleles encoded as $0$ and $1$. Assume no genotyping errors, no de novo mutations, and Mendelian segregation. The observed unphased diploid genotypes are:\n- Mother: $S_1 = 0/1$, $S_2 = 0/1$, $S_3 = 0/1$.\n- Father: $S_1 = 0/0$, $S_2 = 1/1$, $S_3 = 0/1$.\n- Offspring: $S_1 = 0/1$, $S_2 = 0/1$, $S_3 = 0/1$.\n\nUsing only Mendelian inheritance and the ordering of the SNPs, reconstruct the parental haplotypes where they are determinable from the trio and deduce the most parsimonious haplotype block structure. For this problem, define a haplotype block as a maximal contiguous set of SNPs for which the parental haplotypes can be assigned unambiguously in this trio without invoking any recombination event within that block in the meioses that produced the offspring.\n\nReport the minimal number of such haplotype blocks consistent with the data as a single integer. No rounding is required. Express the final answer as an integer with no units.", "solution": "The problem requires the reconstruction of parental haplotypes for a family trio at three adjacent SNP markers, $S_1$, $S_2$, and $S_3$, and the subsequent determination of the minimal number of haplotype blocks consistent with the provided genotype data. A haplotype block is defined as a maximal contiguous set of SNPs for which the parental haplotypes can be assigned unambiguously for this trio, assuming no recombination within the block.\n\nThe provided unphased diploid genotypes are:\n- Mother (M): $S_1 = 0/1$, $S_2 = 0/1$, $S_3 = 0/1$.\n- Father (F): $S_1 = 0/0$, $S_2 = 1/1$, $S_3 = 0/1$.\n- Offspring (O): $S_1 = 0/1$, $S_2 = 0/1$, $S_3 = 0/1$.\n\nAssumptions are: no genotyping errors, no de novo mutations, and Mendelian segregation.\n\nFirst, we validate the problem statement.\nStep 1: Extract Givens.\n- Family structure: Mother, Father, Offspring.\n- Markers: Three ordered, adjacent, biallelic SNPs ($S_1, S_2, S_3$) with alleles $\\{0, 1\\}$.\n- Mother's genotype: $(S_1: 0/1, S_2: 0/1, S_3: 0/1)$.\n- Father's genotype: $(S_1: 0/0, S_2: 1/1, S_3: 0/1)$.\n- Offspring's genotype: $(S_1: 0/1, S_2: 0/1, S_3: 0/1)$.\n- Constraints: No genotyping errors, no de novo mutations, Mendelian segregation.\n- Definition of haplotype block: \"a maximal contiguous set of SNPs for which the parental haplotypes can be assigned unambiguously in this trio without invoking any recombination event within that block in the meioses that produced the offspring.\"\n- Objective: Report the minimal number of such haplotype blocks.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded in the principles of Mendelian genetics, a fundamental concept in biology. The data and terminology are standard in population genetics and genomics. The problem is well-posed, providing sufficient information and a clear objective based on a precise definition. The language is objective and unambiguous. The problem does not violate any of the specified invalidity criteria; it is a standard, solvable genetics puzzle.\n\nStep 3: Verdict and Action.\nThe problem is valid. We proceed with the solution.\n\nLet a haplotype be represented by an ordered triplet of alleles $(a_1, a_2, a_3)$ corresponding to SNPs $S_1, S_2, S_3$.\n\n1.  **Determine Paternal Haplotypes.**\nThe father's genotype is $S_1(0/0)$, $S_2(1/1)$, $S_3(0/1)$. Since he is homozygous at $S_1$ and $S_2$, any haplotype he possesses must have a $0$ at $S_1$ and a $1$ at $S_2$. As he is heterozygous at $S_3$, his two haplotypes must differ at this locus. Therefore, the father's two chromosomal haplotypes are unambiguously determined to be $(0, 1, 0)$ and $(0, 1, 1)$. We denote this as $F: (0, 1, 0) / (0, 1, 1)$. The phase is known across all three markers.\n\n2.  **Determine Transmitted Alleles.**\nThe offspring's genotype is the combination of one haplotype from the mother and one from the father.\n- At $S_1$, the father is $0/0$ and the offspring is $0/1$. The father must have transmitted a $0$ allele. For the offspring to be $0/1$, the mother must have transmitted a $1$ allele.\n- At $S_2$, the father is $1/1$ and the offspring is $0/1$. The father must have transmitted a $1$ allele. For the offspring to be $0/1$, the mother must have transmitted a $0$ allele.\n- At $S_3$, both parents are $0/1$ and the offspring is $0/1$. We cannot unambiguously determine the parental origin of the alleles. The father could have transmitted a $0$ and the mother a $1$, or the father could have transmitted a $1$ and the mother a $0$.\n\n3.  **Deduce Parental Phase and Haplotype Blocks.**\nWe now apply the definition of a haplotype block, which requires unambiguous assignment of parental haplotypes for a contiguous set of SNPs.\n\n**Analysis of the SNP set $\\{S_1, S_2\\}$:**\n- **Father's Haplotypes for $\\{S_1, S_2\\}$**: His genotype is $S_1(0/0), S_2(1/1)$. His haplotypes over this region must be $(0, 1)$ and $(0, 1)$. This phase is unambiguously determined.\n- **Mother's Haplotypes for $\\{S_1, S_2\\}$**: Her genotype is $S_1(0/1), S_2(0/1)$. From step 2, we deduced that the haplotype she transmitted to the offspring contains the alleles $(1, 0)$ for $(S_1, S_2)$. Since her genotype is heterozygous at both loci, her other, non-transmitted haplotype must be $(0, 1)$ to account for the alleles not passed on. Thus, the mother's haplotypes for this region are unambiguously determined to be $(1, 0) / (0, 1)$.\n\nSince the parental haplotypes for both parents can be assigned unambiguously for the contiguous set $\\{S_1, S_2\\}$, this set meets the criteria to be part of a block.\n\n**Analysis of the SNP set $\\{S_1, S_2, S_3\\}$:**\nTo be a single block, the maternal and paternal haplotypes must be unambiguously assigned over all three markers.\n- **Father's Haplotypes for $\\{S_1, S_2, S_3\\}$**: As determined in step 1, these are unambiguously $(0, 1, 0) / (0, 1, 1)$.\n- **Mother's Haplotypes for $\\{S_1, S_2, S_3\\}$**: We know her haplotypes for $\\{S_1, S_2\\}$ are $(1, 0)$ and $(0, 1)$. Her genotype at $S_3$ is $0/1$. This leads to two possibilities for her full haplotypes:\n    - Possibility A: $(1, 0, 0) / (0, 1, 1)$\n    - Possibility B: $(1, 0, 1) / (0, 1, 0)$\n\nTo distinguish between these possibilities, we examine the entire transmission event, assuming no recombination.\n- If the mother's phase is Possibility A, she could transmit $(1, 0, 0)$. For the offspring to have genotype $(0/1, 0/1, 0/1)$, the father must have transmitted $(0, 1, 1)$. This is consistent with the father's haplotypes.\n- If the mother's phase is Possibility B, she could transmit $(1, 0, 1)$. For the offspring to have genotype $(0/1, 0/1, 0/1)$, the father must have transmitted $(0, 1, 0)$. This is also consistent with the father's haplotypes.\n\nSince both possibilities (A and B) result in a valid, non-recombinant explanation for the offspring's genotype, we cannot distinguish between them based on the trio data. Therefore, the mother's haplotypes for the set $\\{S_1, S_2, S_3\\}$ cannot be assigned unambiguously.\nThis means the set $\\{S_1, S_2, S_3\\}$ is not a single haplotype block. This also implies that the set $\\{S_2, S_3\\}$ is not a block, as the maternal phase ambiguity between $S_2$ and $S_3$ is the source of the problem.\n\n4.  **Determine the Minimal Number of Blocks.**\nWe have established that $\\{S_1, S_2\\}$ qualifies as a block and is maximal because the larger set $\\{S_1, S_2, S_3\\}$ does not qualify. This defines the first block. The set of all markers is $\\{S_1, S_2, S_3\\}$. The first block, $B_1 = \\{S_1, S_2\\}$, covers the first two markers. The remaining marker, $\\{S_3\\}$, must form its own block, $B_2 = \\{S_3\\}$. A single SNP trivially forms a haplotype block as its \"haplotypes\" (alleles) are given by the genotype.\n\nThe region is therefore partitioned into two contiguous haplotype blocks: $\\{S_1, S_2\\}$ and $\\{S_3\\}$. This is a partition into $2$ blocks. An alternative partition would be $\\{S_1\\}$, $\\{S_2\\}$, $\\{S_3\\}$, which is $3$ blocks. The question asks for the minimal number of blocks. Since a partition into a single block is not possible, the minimal number of blocks is $2$.\n\nThe minimal number of haplotype blocks consistent with the data is $2$.", "answer": "$$\n\\boxed{2}\n$$", "id": "2820870"}, {"introduction": "Defining haplotype blocks requires moving beyond simply detecting recombination to quantifying the strength of association, or Linkage Disequilibrium (LD), between markers. This computational exercise guides you through calculating the standardized LD metric $D'$ and, crucially, using a nonparametric bootstrap to build a confidence interval around your estimate. You will then apply a formal rule to determine if pairs of SNPs are in 'strong LD', mirroring the rigorous statistical approach used in modern genomic analysis. [@problem_id:2820833]", "problem": "You are given phased haplotype count data for pairs of biallelic single-nucleotide polymorphisms (SNPs) that reside within a candidate haplotype block. For each SNP pair, you must compute a nonparametric bootstrap confidence interval for the normalized linkage disequilibrium measure $D'$ and then decide whether the pair qualifies as being in strong linkage disequilibrium under the Gabriel criteria. Your program must implement the following, starting from core definitions and widely accepted procedures:\n\n- Consider two biallelic SNPs with alleles $A/a$ and $B/b$. Let the observed phased haplotype counts be the ordered quadruple $\\left[n_{AB}, n_{Ab}, n_{aB}, n_{ab}\\right]$, where each $n_{\\cdot}$ is a nonnegative integer count and the total number of chromosomes is $N = n_{AB} + n_{Ab} + n_{aB} + n_{ab}$. Define the haplotype frequencies as $f_{AB} = n_{AB}/N$, $f_{Ab} = n_{Ab}/N$, $f_{aB} = n_{aB}/N$, and $f_{ab} = n_{ab}/N$, which satisfy $f_{AB} + f_{Ab} + f_{aB} + f_{ab} = 1$.\n- Define the allele frequencies $p_A = f_{AB} + f_{Ab}$ and $p_B = f_{AB} + f_{aB}$. The linkage disequilibrium coefficient is $D = f_{AB} - p_A p_B$.\n- The normalized disequilibrium $D'$ is defined to be the magnitude of $D$ scaled by its theoretical maximum given the observed allele frequencies, namely\n  $$\n  D' = \\begin{cases}\n  \\dfrac{|D|}{\\min\\left(p_A\\left(1-p_B\\right),\\left(1-p_A\\right)p_B\\right)}  \\text{if } D \\ge 0, \\\\\n  \\dfrac{|D|}{\\min\\left(p_A p_B,\\left(1-p_A\\right)\\left(1-p_B\\right)\\right)}  \\text{if } D  0,\n  \\end{cases}\n  $$\n  with the convention that if the denominator is $0$ then $D'$ is defined to be $0$. By construction $D'$ lies in the closed interval $[0,1]$.\n- To quantify sampling uncertainty, use a nonparametric bootstrap on chromosomes: resample $N$ haplotypes with replacement from the multiset containing each of the four haplotypes repeated according to $\\left[n_{AB}, n_{Ab}, n_{aB}, n_{ab}\\right]$, recompute $D'$ on the resampled data, and repeat this procedure for $R$ bootstrap replicates to obtain a bootstrap sample $\\{D'_1, D'_2, \\dots, D'_R\\}$. Use the percentile method to form a two-sided confidence interval with nominal coverage $1-\\alpha$ by taking the lower bound as the empirical $\\alpha/2$ quantile and the upper bound as the empirical $1-\\alpha/2$ quantile of the bootstrap sample of $D'$ values.\n- Apply the Gabriel criteria for strong linkage disequilibrium on the resulting interval: a SNP pair is classified as in strong linkage disequilibrium if the upper confidence bound on $D'$ is strictly greater than $0.98$ and the lower confidence bound on $D'$ is strictly greater than $0.7$.\n\nImplementation rules and required constants:\n- Use a fixed pseudo-random number generator seed $s = 1729$ for the bootstrap to ensure deterministic results.\n- Use $R = 5000$ bootstrap replicates and a two-sided nominal coverage of $1-\\alpha = 0.95$ (that is, $\\alpha = 0.05$ so the percentile quantiles are at $0.025$ and $0.975$).\n- Express all reported $D'$ values and confidence bounds as decimals rounded to exactly three digits after the decimal point. Do not use a percentage sign.\n\nTest suite:\n- You must compute results for the following five test cases, each specified by the haplotype count quadruple $\\left[n_{AB}, n_{Ab}, n_{aB}, n_{ab}\\right]$:\n  1. Case $\\mathrm{A}$: $\\left[40, 0, 0, 60\\right]$.\n  2. Case $\\mathrm{B}$: $\\left[35, 5, 5, 55\\right]$.\n  3. Case $\\mathrm{C}$: $\\left[25, 25, 25, 25\\right]$.\n  4. Case $\\mathrm{D}$: $\\left[9, 1, 1, 89\\right]$.\n  5. Case $\\mathrm{E}$: $\\left[49, 1, 1, 49\\right]$.\n\nOutput specification:\n- For each case, compute the point estimate $D'$ from the observed counts, the bootstrap lower and upper bounds at $\\alpha/2 = 0.025$ and $1-\\alpha/2 = 0.975$, and the boolean decision under the Gabriel criteria.\n- Your program should produce a single line of output containing a list of length $5$, where each element corresponds to one case in the order $\\mathrm{A}$ through $\\mathrm{E}$. Each element must itself be a list of the form $\\left[\\text{Dprime}, \\text{Lower}, \\text{Upper}, \\text{Strong}\\right]$ where $\\text{Dprime}$, $\\text{Lower}$, and $\\text{Upper}$ are decimals rounded to exactly three places, and $\\text{Strong}$ is a boolean. For example, a syntactically valid output for two hypothetical cases would look like $\\left[\\left[0.832, 0.701, 0.994, \\mathrm{True}\\right], \\left[0.412, 0.205, 0.673, \\mathrm{False}\\right]\\right]$. Your program must output exactly one such line with the results for all five specified cases in the order given.", "solution": "The problem presented requires the implementation of a statistical procedure to assess linkage disequilibrium (LD) between pairs of single-nucleotide polymorphisms (SNPs). The problem is scientifically valid, well-posed, and provides all necessary definitions and parameters for a unique, reproducible solution. The methods described—calculation of the normalized linkage disequilibrium coefficient $D'$, the use of nonparametric bootstrapping to estimate confidence intervals, and the application of the Gabriel criteria—are standard and well-established in the field of population genetics. I will proceed with a rigorous solution.\n\nThe solution is structured as follows. First, we define a function to compute the point estimate of the normalized linkage disequilibrium, $D'$, from a given set of four haplotype counts. Second, we implement the nonparametric bootstrap procedure to generate an empirical distribution of $D'$ values. Third, we use this distribution to construct a percentile-based confidence interval. Finally, we apply the specified Gabriel criteria to this interval to make a determination of strong LD. This entire process is then applied to each of the five test cases provided.\n\n**1. Mathematical Formulation**\n\nLet the observed phased haplotype counts for two biallelic loci with alleles ($A/a$, $B/b$) be given by the vector $\\mathbf{n} = [n_{AB}, n_{Ab}, n_{aB}, n_{ab}]$. The total number of chromosomes sampled is $N = \\sum_i n_i = n_{AB} + n_{Ab} + n_{aB} + n_{ab}$.\n\nThe frequencies of the four haplotypes are estimated as:\n$$\nf_{AB} = \\frac{n_{AB}}{N}, \\quad f_{Ab} = \\frac{n_{Ab}}{N}, \\quad f_{aB} = \\frac{n_{aB}}{N}, \\quad f_{ab} = \\frac{n_{ab}}{N}\n$$\nFrom these, the allele frequencies for allele $A$ at the first locus and allele $B$ at the second locus are:\n$$\np_A = f_{AB} + f_{Ab}\n$$\n$$\np_B = f_{AB} + f_{aB}\n$$\nThe linkage disequilibrium coefficient, $D$, measures the deviation of the observed haplotype frequency $f_{AB}$ from the frequency expected under linkage equilibrium, $p_A p_B$:\n$$\nD = f_{AB} - p_A p_B\n$$\nThe value of $D$ is constrained by the allele frequencies. To create a standardized measure, $D$ is normalized by its maximum possible absolute value, $D_{max}$, yielding $D'$. The value of $D_{max}$ depends on the sign of $D$:\n$$\nD_{max} = \\begin{cases}\n\\min(p_A(1-p_B), (1-p_A)p_B)  \\text{if } D \\ge 0, \\\\\n\\min(p_A p_B, (1-p_A)(1-p_B))  \\text{if } D  0.\n\\end{cases}\n$$\nThe normalized linkage disequilibrium, $D'$, is then defined as:\n$$\nD' = \\frac{|D|}{D_{max}}\n$$\nBy convention, if $D_{max} = 0$, then $D'$ is defined as $0$. By construction, $D' \\in [0, 1]$.\n\n**2. Algorithmic Implementation of the Statistical Analysis**\n\nA primary function, which we may call `compute_d_prime`, is designed to execute these calculations. For robustness and efficiency, this function is implemented using `NumPy` to support vectorized operations, allowing it to process a batch of haplotype count vectors simultaneously. This is particularly advantageous for the bootstrap procedure.\n\n**2.1. Point Estimate Calculation**\nFor each test case, we first compute the point estimate of $D'$ directly from the provided haplotype counts $[n_{AB}, n_{Ab}, n_{aB}, n_{ab}]$ using the `compute_d_prime` function.\n\n**2.2. Nonparametric Bootstrap**\nTo quantify the uncertainty in the point estimate of $D'$, we employ a nonparametric bootstrap. The procedure is as follows:\n- The set of $N$ observed chromosomes is treated as an empirical distribution. The probability of drawing each haplotype is given by its observed frequency, $\\mathbf{p} = [f_{AB}, f_{Ab}, f_{aB}, f_{ab}]$.\n- A bootstrap sample is generated by drawing $N$ chromosomes with replacement from this empirical distribution. This is computationally equivalent to drawing one sample of size $N$ from a multinomial distribution with parameters $N$ and probability vector $\\mathbf{p}$.\n- For each bootstrap sample of counts, we recompute the $D'$ value.\n- This process is repeated $R = 5000$ times, yielding a bootstrap distribution of $D'$ values: $\\{D'_1, D'_2, \\dots, D'_R\\}$.\n- To ensure reproducibility, the pseudo-random number generator is seeded with the specified value $s = 1729$.\n\nThe generation of all $R$ bootstrap samples is performed in a single, efficient operation using `numpy.random.default_rng().multinomial(N, p, size=R)`. The subsequent calculation of $D'$ for all $R$ replicates is then performed in a fully vectorized manner.\n\n**2.3. Confidence Interval Construction**\nThe percentile method is used to construct the $1 - \\alpha = 0.95$ confidence interval for $D'$. The lower and upper bounds of the confidence interval are the empirical $\\alpha/2 = 0.025$ and $1 - \\alpha/2 = 0.975$ quantiles of the sorted bootstrap distribution of $D'$ values. These are computed efficiently using `numpy.quantile`.\n\n**2.4. Gabriel Criteria for Strong Linkage Disequilibrium**\nFinally, the computed confidence interval, $[L, U]$, is evaluated against the Gabriel criteria. A SNP pair is classified as being in strong LD if both of the following conditions are met:\n- The lower confidence bound $L  0.7$.\n- The upper confidence bound $U  0.98$.\nThis results in a boolean decision (`True` or `False`).\n\n**3. Output Generation**\nThe final output is constructed by iterating through the five test cases. For each case, the point estimate of $D'$, the lower and upper confidence bounds, and the boolean strong LD decision are calculated. These four values are formatted into a list, where the floating-point numbers are represented as strings rounded to exactly three decimal places. The lists for all five cases are then aggregated into a single list, which is printed as a continuous line of text, strictly adhering to the specified format. The use of formatted strings (f-strings in Python) ensures the precise representation of the numerical results.", "answer": "[[1.000, 1.000, 1.000, True],[0.636, 0.318, 1.000, False],[0.000, 0.000, 0.000, False],[0.817, 0.548, 1.000, False],[1.000, 1.000, 1.000, True]]", "id": "2820833"}]}