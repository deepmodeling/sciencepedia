{"hands_on_practices": [{"introduction": "This practice explores the core engine of genetic drift by deriving its effect on genetic variation from first principles. You will see how the random, binomial sampling of alleles inherent in the Wright-Fisher model leads to a predictable exponential decay in expected heterozygosity. Mastering this derivation [@problem_id:2816926] is essential, as the relationship between the rate of drift and effective population size, $N_e$, underpins our entire understanding of how genetic diversity is lost in finite populations.", "problem": "In a closed diploid population evolving under the Wright–Fisher model with constant effective population size $N_e$, no mutation, no migration, and no selection, let $p_t$ denote the allele frequency at a neutral biallelic locus in generation $t$, and let the expected heterozygosity be defined as $H_t \\equiv \\mathbb{E}[2\\,p_t(1-p_t)]$. Begin from the fundamental property of binomial sampling in this model: conditional on $p_t$, the next-generation allele frequency $p_{t+1}$ is given by a binomial draw with $2N_e$ trials and success probability $p_t$, implying $\\mathbb{E}[p_{t+1}\\,|\\,p_t]=p_t$ and $\\operatorname{Var}(p_{t+1}\\,|\\,p_t)=\\dfrac{p_t(1-p_t)}{2N_e}$. Using only these facts and the definition of $H_t$, derive the closed-form expression for $H_t$ as a function of $H_0$, $t$, and $N_e$ under pure genetic drift. Then evaluate your expression at $t=20$, $H_0=0.8$, and $N_e=100$. Round your final numerical answer to $4$ significant figures and express it as a decimal (no units).", "solution": "The objective is to find a closed-form expression for the expected heterozygosity, $H_t$, as a function of the initial expected heterozygosity $H_0$, the number of generations $t$, and the effective population size $N_e$. The expected heterozygosity at generation $t$ is defined as:\n$$H_t \\equiv \\mathbb{E}[2\\,p_t(1-p_t)]$$\nwhere $p_t$ is the allele frequency at generation $t$.\n\nWe begin by establishing a recurrence relation for $H_t$. We express $H_{t+1}$ in terms of $H_t$. By definition:\n$$H_{t+1} = \\mathbb{E}[2\\,p_{t+1}(1-p_{t+1})]$$\nWe can rewrite the expectation using the law of total expectation, conditioning on the allele frequency in the previous generation, $p_t$:\n$$H_{t+1} = \\mathbb{E}[\\mathbb{E}[2\\,p_{t+1}(1-p_{t+1})\\,|\\,p_t]]$$\nLet us analyze the inner conditional expectation. Using the linearity of expectation:\n$$\\mathbb{E}[2\\,p_{t+1}(1-p_{t+1})\\,|\\,p_t] = 2\\,\\mathbb{E}[p_{t+1} - p_{t+1}^2\\,|\\,p_t] = 2(\\mathbb{E}[p_{t+1}\\,|\\,p_t] - \\mathbb{E}[p_{t+1}^2\\,|\\,p_t])$$\nThe problem statement provides the conditional mean of $p_{t+1}$:\n$$\\mathbb{E}[p_{t+1}\\,|\\,p_t] = p_t$$\nTo find the conditional second moment, $\\mathbb{E}[p_{t+1}^2\\,|\\,p_t]$, we use the definition of conditional variance:\n$$\\operatorname{Var}(p_{t+1}\\,|\\,p_t) = \\mathbb{E}[p_{t+1}^2\\,|\\,p_t] - (\\mathbb{E}[p_{t+1}\\,|\\,p_t])^2$$\nRearranging and substituting the known conditional mean and the given conditional variance, $\\operatorname{Var}(p_{t+1}\\,|\\,p_t)=\\dfrac{p_t(1-p_t)}{2N_e}$:\n$$\\mathbb{E}[p_{t+1}^2\\,|\\,p_t] = \\operatorname{Var}(p_{t+1}\\,|\\,p_t) + (\\mathbb{E}[p_{t+1}\\,|\\,p_t])^2 = \\frac{p_t(1-p_t)}{2N_e} + p_t^2$$\nNow, we substitute the expressions for $\\mathbb{E}[p_{t+1}\\,|\\,p_t]$ and $\\mathbb{E}[p_{t+1}^2\\,|\\,p_t]$ back into the equation for the inner conditional expectation:\n$$\\mathbb{E}[2\\,p_{t+1}(1-p_{t+1})\\,|\\,p_t] = 2\\left(p_t - \\left(\\frac{p_t(1-p_t)}{2N_e} + p_t^2\\right)\\right)$$\n$$= 2\\left(p_t - p_t^2 - \\frac{p_t(1-p_t)}{2N_e}\\right)$$\n$$= 2\\left(p_t(1-p_t) - \\frac{p_t(1-p_t)}{2N_e}\\right)$$\nFactoring out the term $p_t(1-p_t)$:\n$$= 2\\,p_t(1-p_t)\\left(1 - \\frac{1}{2N_e}\\right)$$\nNow we substitute this result back into the expression for $H_{t+1}$:\n$$H_{t+1} = \\mathbb{E}\\left[2\\,p_t(1-p_t)\\left(1 - \\frac{1}{2N_e}\\right)\\right]$$\nSince $\\left(1 - \\frac{1}{2N_e}\\right)$ is a constant, it can be factored out of the expectation:\n$$H_{t+1} = \\left(1 - \\frac{1}{2N_e}\\right) \\mathbb{E}[2\\,p_t(1-p_t)]$$\nBy definition, $\\mathbb{E}[2\\,p_t(1-p_t)] = H_t$. Therefore, we arrive at the recurrence relation:\n$$H_{t+1} = H_t \\left(1 - \\frac{1}{2N_e}\\right)$$\nThis is a simple geometric progression. By recursive substitution, we can express $H_t$ in terms of $H_0$:\n$$H_t = H_{t-1} \\left(1 - \\frac{1}{2N_e}\\right) = H_{t-2} \\left(1 - \\frac{1}{2N_e}\\right)^2 = \\dots = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^t$$\nThis is the required closed-form expression for $H_t$. This equation shows that expected heterozygosity decays exponentially over time due to genetic drift at a rate of $\\frac{1}{2N_e}$ per generation.\n\nThe second part of the problem requires us to evaluate this expression for the specific values $t=20$, $H_0=0.8$, and $N_e=100$.\nSubstituting these values into the derived formula:\n$$H_{20} = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^{20} = 0.8 \\left(1 - \\frac{1}{2(100)}\\right)^{20}$$\n$$H_{20} = 0.8 \\left(1 - \\frac{1}{200}\\right)^{20} = 0.8 \\left(\\frac{199}{200}\\right)^{20} = 0.8 (0.995)^{20}$$\nCalculating the numerical value:\n$$(0.995)^{20} \\approx 0.904608308$$\n$$H_{20} \\approx 0.8 \\times 0.904608308 \\approx 0.723686646$$\nThe problem requires the answer to be rounded to $4$ significant figures.\n$$H_{20} \\approx 0.7237$$", "answer": "$$\\boxed{0.7237}$$", "id": "2816926"}, {"introduction": "While the idealized Wright-Fisher model assumes a constant population size, real populations fluctuate. This exercise [@problem_id:2816933] demonstrates how to quantify the cumulative impact of drift across generations of varying sizes, leading to the derivation of the harmonic mean effective population size. This principle is fundamental to understanding bottlenecks, as it mathematically explains why small population phases disproportionately accelerate the loss of genetic diversity and govern the long-term effective size.", "problem": "A closed, randomly mating diploid population experiences a short bottleneck over three discrete, nonoverlapping generations with census sizes $N_{1}=100$, $N_{2}=50$, and $N_{3}=200$. Assume equal sex ratio, no selection, no mutation, no migration, and that reproduction in each generation follows the binomial sampling inherent to the idealized Wright–Fisher model, so that drift is the only evolutionary force changing allele frequencies. Let $p_{t}$ denote the allele frequency at generation $t$. Define the effective population size $N_{e}$ over these three generations as the constant size of an ideal Wright–Fisher population that would produce the same cumulative drift effect on identity-by-descent (equivalently, the same cumulative rate of random genetic drift) across the three generations as the observed variable census sizes.\n\nStarting from the foundational definition that, in an ideal Wright–Fisher population of size $N$, the per-generation increase in the inbreeding coefficient (probability of identity-by-descent) due to genetic drift is approximately $1/(2N)$, derive a general expression for $N_{e}$ over $T$ generations with variable census sizes $\\{N_{1},\\dots,N_{T}\\}$ by equating the cumulative drift in the variable-size population to that in a constant-size population of size $N_{e}$. Then evaluate this expression for $T=3$ with $N_{1}=100$, $N_{2}=50$, and $N_{3}=200$. Round your final numerical answer to four significant figures. Do not include any units.", "solution": "The principles of the problem are grounded in the standard Wright–Fisher model of population genetics, which describes the change in allele frequencies in a population under the influence of genetic drift. We are tasked with defining and calculating the effective population size, $N_e$, for a population with fluctuating census sizes over time. The definition provided is based on the rate of inbreeding, which is equivalent to considering the rate of loss of heterozygosity.\n\nLet $H_t$ be the heterozygosity in generation $t$. For an idealized diploid population of constant size $N$, the expected heterozygosity in the next generation, $H_{t+1}$, is related to the current heterozygosity $H_t$ by the recurrence relation:\n$$ H_{t+1} = \\left(1 - \\frac{1}{2N}\\right) H_t $$\nThe factor $(1 - \\frac{1}{2N})$ represents the probability that two alleles drawn from generation $t+1$ are not identical by descent. The term $\\frac{1}{2N}$ is the probability that they are, which corresponds to the per-generation increase in the inbreeding coefficient, $f$. The problem gives this increase as approximately $\\frac{1}{2N}$, which is consistent with the standard model where we approximate the change $\\Delta f_t = f_{t+1} - f_t = \\frac{1-f_t}{2N} \\approx \\frac{1}{2N}$ for small $f_t$.\n\nFirst, we will derive the general expression for $N_e$ over $T$ generations. For a population with variable census sizes $N_1, N_2, \\dots, N_T$, the heterozygosity at the end of generation $T$, denoted $H_T$, starting from an initial heterozygosity $H_0$, can be found by applying the recurrence relation iteratively:\n$$ H_1 = \\left(1 - \\frac{1}{2N_1}\\right) H_0 $$\n$$ H_2 = \\left(1 - \\frac{1}{2N_2}\\right) H_1 = \\left(1 - \\frac{1}{2N_2}\\right) \\left(1 - \\frac{1}{2N_1}\\right) H_0 $$\nAfter $T$ generations, the final heterozygosity is:\n$$ H_T = H_0 \\prod_{t=1}^{T} \\left(1 - \\frac{1}{2N_t}\\right) $$\nThe cumulative effect of drift is represented by the total multiplicative factor $\\prod_{t=1}^{T} (1 - \\frac{1}{2N_t})$.\n\nNow, consider an idealized population with a constant effective size $N_e$. Over the same $T$ generations, its heterozygosity would decay as:\n$$ H_T' = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^T $$\nThe problem defines $N_e$ as the size of such a population that produces the same cumulative drift effect. This requires that the final proportion of heterozygosity remaining is identical in both scenarios, meaning $H_T = H_T'$, or equivalently:\n$$ \\left(1 - \\frac{1}{2N_e}\\right)^T = \\prod_{t=1}^{T} \\left(1 - \\frac{1}{2N_t}\\right) $$\nTo solve for $N_e$, we take the natural logarithm of both sides:\n$$ T \\ln\\left(1 - \\frac{1}{2N_e}\\right) = \\sum_{t=1}^{T} \\ln\\left(1 - \\frac{1}{2N_t}\\right) $$\nFor large population sizes, which is a standard assumption when this concept is applied, the term $\\frac{1}{2N}$ is small. We can therefore use the Taylor series approximation for the natural logarithm, $\\ln(1 - x) \\approx -x$ for small $x$. Applying this approximation to both sides of the equation yields:\n$$ T \\left(-\\frac{1}{2N_e}\\right) \\approx \\sum_{t=1}^{T} \\left(-\\frac{1}{2N_t}\\right) $$\nMultiplying through by $-2$ gives:\n$$ \\frac{T}{N_e} \\approx \\sum_{t=1}^{T} \\frac{1}{N_t} $$\nSolving for $N_e$, we obtain the general expression. The effective population size is the harmonic mean of the census sizes over the generations:\n$$ N_e = \\frac{T}{\\sum_{t=1}^{T} \\frac{1}{N_t}} $$\n\nNow, we must evaluate this expression for the specific case given in the problem. The number of generations is $T = 3$, and the census sizes are $N_1 = 100$, $N_2 = 50$, and $N_3 = 200$.\nSubstituting these values into the derived formula:\n$$ N_e = \\frac{3}{\\frac{1}{100} + \\frac{1}{50} + \\frac{1}{200}} $$\nTo compute the sum in the denominator, we find a common denominator, which is $200$:\n$$ \\sum_{t=1}^{3} \\frac{1}{N_t} = \\frac{2}{200} + \\frac{4}{200} + \\frac{1}{200} = \\frac{2+4+1}{200} = \\frac{7}{200} $$\nNow substitute this sum back into the expression for $N_e$:\n$$ N_e = \\frac{3}{\\frac{7}{200}} = 3 \\times \\frac{200}{7} = \\frac{600}{7} $$\nThe final step is to provide a numerical value rounded to four significant figures.\n$$ N_e = \\frac{600}{7} \\approx 85.7142857\\dots $$\nRounding this value to four significant figures gives $85.71$. The small size of the bottleneck generation, $N_2=50$, disproportionately lowers the effective population size over the entire period, as is characteristic of the harmonic mean.", "answer": "$$\\boxed{85.71}$$", "id": "2816933"}, {"introduction": "This final practice bridges theory and application by asking you to analyze hypothetical genetic data sampled through time to infer a past demographic event. You will use the fixation index, $F_{ST}$, to quantify the genetic divergence caused by drift during a population bottleneck. This exercise [@problem_id:2816892] illustrates a powerful approach used in conservation genetics and molecular ecology: inverting theoretical population genetic models to estimate key demographic parameters, such as the effective size of a bottleneck, from contemporary or ancient DNA data.", "problem": "A closed deme (no migration) experienced a short, severe reduction in census size (a bottleneck) lasting $2$ consecutive generations, after which the deme rapidly recovered to a very large size. You collect temporal samples of $50$ diploid individuals (that is, $100$ gene copies) from the same deme at three time points: before the bottleneck at generation $t=0$, immediately after the bottleneck at generation $t=2$, and after recovery at generation $t=10$. At each time point you genotype $6$ independent, neutral, biallelic single nucleotide polymorphism (SNP) loci. Assume Hardy–Weinberg equilibrium within each time point, no selection, and negligible mutation over the sampling interval.\n\nFor each locus, the count of allele $\\mathrm{A}$ among the $100$ gene copies is given below (each count is out of $100$):\n\n- Locus $1$: $t=0$: $50$, $t=2$: $20$, $t=10$: $18$.\n- Locus $2$: $t=0$: $30$, $t=2$: $60$, $t=10$: $58$.\n- Locus $3$: $t=0$: $70$, $t=2$: $40$, $t=10$: $42$.\n- Locus $4$: $t=0$: $10$, $t=2$: $30$, $t=10$: $31$.\n- Locus $5$: $t=0$: $80$, $t=2$: $50$, $t=10$: $48$.\n- Locus $6$: $t=0$: $25$, $t=2$: $55$, $t=10$: $56$.\n\nTasks:\n1) Treat each pair of time points as if they were two subpopulations derived from a common ancestor and estimate the fixation index (F-statistics) $F_{ST}$ between $t=0$ and $t=2$, between $t=0$ and $t=10$, and between $t=2$ and $t=10$. Base your calculation on the core definition of $F_{ST}$ in terms of total and within-subpopulation expected heterozygosity computed from allele frequencies, and aggregate appropriately across loci.\n\n2) Interpret the temporal pattern of your $F_{ST}$ estimates in terms of genetic drift strength across intervals.\n\n3) Assuming genetic drift is the only force changing allele frequencies, and that after the bottleneck the effective population size is so large that additional drift over $8$ generations is negligible, use your estimate of $F_{ST}$ between $t=0$ and $t=2$ to infer the bottleneck effective population size $N_{b}$ under a Wright–Fisher model of drift. Report your estimate of $N_{b}$ rounded to three significant figures. Provide only the numerical value as your final answer (no units).", "solution": "The solution is structured according to the three tasks presented in the problem.\n\nFirst, we convert the allele counts into frequencies, $p$, for allele $\\mathrm{A}$ at each locus $i$ and time point $t$. The sample size of gene copies is $n=100$.\n\n- Locus $1$: $p_{1,0}=0.50$, $p_{1,2}=0.20$, $p_{1,10}=0.18$.\n- Locus $2$: $p_{2,0}=0.30$, $p_{2,2}=0.60$, $p_{2,10}=0.58$.\n- Locus $3$: $p_{3,0}=0.70$, $p_{3,2}=0.40$, $p_{3,10}=0.42$.\n- Locus $4$: $p_{4,0}=0.10$, $p_{4,2}=0.30$, $p_{4,10}=0.31$.\n- Locus $5$: $p_{5,0}=0.80$, $p_{5,2}=0.50$, $p_{5,10}=0.48$.\n- Locus $6$: $p_{6,0}=0.25$, $p_{6,2}=0.55$, $p_{6,10}=0.56$.\n\n**Task 1: Estimate the fixation index $F_{ST}$**\n\nThe fixation index $F_{ST}$ is estimated using the formula based on expected heterozygosities for two subpopulations (here, time points), aggregated over loci:\n$$ F_{ST} = \\frac{\\overline{H}_T - \\overline{H}_S}{\\overline{H}_T} $$\nwhere $\\overline{H}_S$ is the average expected heterozygosity within subpopulations, and $\\overline{H}_T$ is the expected heterozygosity in the total population. For a single biallelic locus $i$ with allele frequencies $p_a$ and $p_b$ in two populations, $H_{S,i} = \\frac{2p_a(1-p_a) + 2p_b(1-p_b)}{2}$ and $H_{T,i} = 2\\bar{p}(1-\\bar{p})$, where $\\bar{p} = \\frac{p_a+p_b}{2}$. We average these heterozygosity components over all $L=6$ loci.\n$$ \\overline{H}_S = \\frac{1}{L} \\sum_{i=1}^{L} H_{S,i} \\quad \\text{and} \\quad \\overline{H}_T = \\frac{1}{L} \\sum_{i=1}^{L} H_{T,i} $$\n\n**1(a). $F_{ST}$ between $t=0$ and $t=2$:**\n- For each of the $6$ loci, we calculate $H_{S,i}$ and $H_{T,i}$ using the frequencies $p_{i,0}$ and $p_{i,2}$.\n- Averaging over the $6$ loci, we find:\n$$ \\overline{H}_S(0,2) = \\frac{1}{6} \\sum_{i=1}^{6} \\frac{2p_{i,0}(1-p_{i,0}) + 2p_{i,2}(1-p_{i,2})}{2} \\approx 0.40917 $$\n$$ \\overline{H}_T(0,2) = \\frac{1}{6} \\sum_{i=1}^{6} 2\\left(\\frac{p_{i,0}+p_{i,2}}{2}\\right)\\left(1-\\frac{p_{i,0}+p_{i,2}}{2}\\right) = 0.45000 $$\n- The fixation index is:\n$$ F_{ST}(0,2) = \\frac{0.45000 - 0.40917}{0.45000} \\approx 0.09074 $$\n\n**1(b). $F_{ST}$ between $t=0$ and $t=10$:**\n- We repeat the calculation for time points $t=0$ and $t=10$.\n$$ \\overline{H}_S(0,10) = \\frac{1}{6} \\sum_{i=1}^{6} \\frac{2p_{i,0}(1-p_{i,0}) + 2p_{i,10}(1-p_{i,10})}{2} \\approx 0.40870 $$\n$$ \\overline{H}_T(0,10) = \\frac{1}{6} \\sum_{i=1}^{6} 2\\left(\\frac{p_{i,0}+p_{i,10}}{2}\\right)\\left(1-\\frac{p_{i,0}+p_{i,10}}{2}\\right) \\approx 0.45052 $$\n- The fixation index is:\n$$ F_{ST}(0,10) = \\frac{0.45052 - 0.40870}{0.45052} \\approx 0.09282 $$\n\n**1(c). $F_{ST}$ between $t=2$ and $t=10$:**\n- We repeat the calculation for time points $t=2$ and $t=10$.\n$$ \\overline{H}_S(2,10) = \\frac{1}{6} \\sum_{i=1}^{6} \\frac{2p_{i,2}(1-p_{i,2}) + 2p_{i,10}(1-p_{i,10})}{2} \\approx 0.44870 $$\n$$ \\overline{H}_T(2,10) = \\frac{1}{6} \\sum_{i=1}^{6} 2\\left(\\frac{p_{i,2}+p_{i,10}}{2}\\right)\\left(1-\\frac{p_{i,2}+p_{i,10}}{2}\\right) \\approx 0.44885 $$\n- The fixation index is:\n$$ F_{ST}(2,10) = \\frac{0.44885 - 0.44870}{0.44885} \\approx 0.00033 $$\n\n**Task 2: Interpret the temporal pattern of $F_{ST}$**\n\nThe $F_{ST}$ value quantifies the extent of genetic divergence between populations, which in this temporal context reflects the magnitude of allele frequency change due to genetic drift.\n- The relatively large value of $F_{ST}(0,2) \\approx 0.091$ indicates significant genetic differentiation occurred between generations $t=0$ and $t=2$. This is the direct consequence of strong genetic drift operating during the two-generation bottleneck, where the small population size leads to rapid, random shifts in allele frequencies.\n- The extremely small value of $F_{ST}(2,10) \\approx 0.00033$ shows that there was negligible allele frequency change between generations $t=2$ and $t=10$. This is consistent with the problem statement that the population \"rapidly recovered to a very large size,\" where the effects of genetic drift become minimal.\n- The value of $F_{ST}(0,10) \\approx 0.093$ is very similar to $F_{ST}(0,2)$. This demonstrates that almost all the genetic divergence from the ancestral state at $t=0$ occurred during the bottleneck phase. After the bottleneck, the allele frequencies stabilized, so the population at $t=10$ is genetically almost identical to the population at $t=2$, and thus shows a comparable level of divergence from the pre-bottleneck population at $t=0$.\n\n**Task 3: Infer the bottleneck effective population size $N_b$**\n\nUnder the Wright-Fisher model, the expected value of $F_{ST}$ between a population and its ancestor after $t$ generations of drift with a constant effective size $N_e$ is given by:\n$$ F_{ST} = 1 - \\left(1 - \\frac{1}{2N_e}\\right)^t $$\nWe use our estimate for the bottleneck interval, $F_{ST}(0,2) \\approx 0.09074$, where the duration of drift is $t=2$ generations and the effective size is the bottleneck size, $N_b$. The assumption that drift is negligible after $t=2$ justifies isolating this interval for the estimation of $N_b$.\n\nWe set up the equation:\n$$ 0.09074 = 1 - \\left(1 - \\frac{1}{2N_b}\\right)^2 $$\nSolving for $N_b$:\n$$ \\left(1 - \\frac{1}{2N_b}\\right)^2 = 1 - 0.09074 = 0.90926 $$\n$$ 1 - \\frac{1}{2N_b} = \\sqrt{0.90926} \\approx 0.95355 $$\n$$ \\frac{1}{2N_b} = 1 - 0.95355 = 0.04645 $$\n$$ 2N_b = \\frac{1}{0.04645} \\approx 21.529 $$\n$$ N_b = \\frac{21.529}{2} \\approx 10.7645 $$\nRounding the result to three significant figures, as required, gives an estimated bottleneck effective population size of $10.8$.", "answer": "$$\\boxed{10.8}$$", "id": "2816892"}]}