{"hands_on_practices": [{"introduction": "To build our quantitative understanding of natural selection, we begin with the simplest possible scenario: a haploid, asexual population. This exercise strips away the complexities of diploid genetics to focus on the core engine of evolutionary change. By calculating the shift in genotype frequencies in a single generation, you will directly apply the foundational principle that a genotype's future success is proportional to its relative fitness [@problem_id:2832271].", "problem": "A large, well-mixed, asexual haploid population consists of three genotypes, indexed by $i \\in \\{1,2,3\\}$. Each genotype $i$ has a constant Wrightian fitness $w_i$ that scales its expected contribution to the next generation in a single, discrete, non-overlapping generation life cycle with no mutation, migration, or genetic drift. At the start of generation $t$, the genotype frequency vector is $(p_1, p_2, p_3)$ with $p_1 + p_2 + p_3 = 1$. Selection acts via differential survival/reproduction so that the expected number of surviving offspring descending from genotype $i$ is proportional to $w_i$ times the number of genotype-$i$ parents. Let $\\bar{w}$ denote the population mean fitness (the average per-capita success across genotypes, weighted by current frequencies), and let $(p_1', p_2', p_3')$ denote the genotype frequencies at the start of generation $t+1$ after selection and normalization. \n\nIn a particular experiment, the three genotypes have fitnesses $w = (1.00, 1.05, 0.98)$ and initial frequencies $(p_1, p_2, p_3) = (0.5, 0.3, 0.2)$ at generation $t$. Starting strictly from the definitions above (that genotype contributions are proportional to $w_i$ and that frequencies must normalize to sum to $1$), compute the next-generation frequency vector $(p_1', p_2', p_3')$ and the next-generation mean fitness $\\bar{w}'$. \n\nReport your final numerical results as a single row vector $(p_1', p_2', p_3', \\bar{w}')$, with each entry rounded to four significant figures. Express the entries as plain decimals (no percentage signs). No other quantities should be reported.", "solution": "The problem presents a standard model of discrete-time population genetics for a haploid, asexual population. The task is to compute the genotype frequencies and the population mean fitness in the next generation, given the initial frequencies and fitness values for three genotypes. The problem statement is scientifically grounded, well-posed, and contains all necessary information. It is therefore valid.\n\nLet the population at generation $t$ be described by the frequency vector of the three genotypes, $\\boldsymbol{p} = (p_1, p_2, p_3)$, where $\\sum_{i=1}^{3} p_i = 1$. The corresponding Wrightian fitnesses are given by the vector $\\boldsymbol{w} = (w_1, w_2, w_3)$. The problem states that the expected contribution of each genotype to the subsequent generation is proportional to its fitness and current frequency.\n\nLet the total population size at the beginning of generation $t$ be $N$. The number of individuals of genotype $i$ is $N_i = p_i N$. The number of offspring produced by genotype $i$, let us denote it $N'_i$, is proportional to $w_i N_i$. Therefore, we can write $N'_i = C w_i N_i$ for some constant of proportionality $C$ that is identical for all genotypes.\n\nThe total number of individuals in the offspring generation, before normalization, is the sum over all genotypes:\n$$N' = \\sum_{i=1}^{3} N'_i = \\sum_{i=1}^{3} C w_i N_i = C \\sum_{i=1}^{3} w_i (p_i N) = C N \\sum_{i=1}^{3} w_i p_i$$\nThe frequency of genotype $i$ in the next generation, $p'_i$, is the ratio of the number of its offspring to the total number of offspring:\n$$p'_i = \\frac{N'_i}{N'} = \\frac{C w_i N_i}{\\sum_{j=1}^{3} C w_j N_j} = \\frac{w_i (p_i N)}{\\sum_{j=1}^{3} w_j (p_j N)}$$\nThe constants $C$ and $N$ cancel, yielding the fundamental recurrence relation:\n$$p'_i = \\frac{p_i w_i}{\\sum_{j=1}^{3} p_j w_j}$$\nThe denominator is the population mean fitness at generation $t$, defined as the weighted average of the individual fitnesses:\n$$\\bar{w} = \\sum_{i=1}^{3} p_i w_i$$\nThus, the frequency of genotype $i$ at generation $t+1$ is given by:\n$$p'_i = \\frac{p_i w_i}{\\bar{w}}$$\nThe given data for generation $t$ are:\n- Frequencies: $(p_1, p_2, p_3) = (0.5, 0.3, 0.2)$\n- Fitnesses: $(w_1, w_2, w_3) = (1.00, 1.05, 0.98)$\n\nFirst, we compute the mean fitness $\\bar{w}$ for generation $t$:\n$$\\bar{w} = p_1 w_1 + p_2 w_2 + p_3 w_3$$\n$$\\bar{w} = (0.5)(1.00) + (0.3)(1.05) + (0.2)(0.98) = 0.500 + 0.315 + 0.196 = 1.011$$\nNow we can compute the frequencies for the next generation, $(p'_1, p'_2, p'_3)$:\n$$p'_1 = \\frac{p_1 w_1}{\\bar{w}} = \\frac{(0.5)(1.00)}{1.011} = \\frac{0.500}{1.011} \\approx 0.4945598...$$\n$$p'_2 = \\frac{p_2 w_2}{\\bar{w}} = \\frac{(0.3)(1.05)}{1.011} = \\frac{0.315}{1.011} \\approx 0.3115727...$$\n$$p'_3 = \\frac{p_3 w_3}{\\bar{w}} = \\frac{(0.2)(0.98)}{1.011} = \\frac{0.196}{1.011} \\approx 0.1938674...$$\nThe problem requires these values to be rounded to four significant figures:\n- $p'_1 \\approx 0.4946$\n- $p'_2 \\approx 0.3116$\n- $p'_3 \\approx 0.1939$\n\nNext, we must compute the mean fitness of the population at generation $t+1$, denoted $\\bar{w}'$. This is calculated using the newly computed frequencies $(p'_1, p'_2, p'_3)$:\n$$\\bar{w}' = p'_1 w_1 + p'_2 w_2 + p'_3 w_3$$\nTo avoid propagation of rounding error, we should substitute the exact expressions for $p'_i$:\n$$\\bar{w}' = \\sum_{i=1}^{3} p'_i w_i = \\sum_{i=1}^{3} \\left(\\frac{p_i w_i}{\\bar{w}}\\right) w_i = \\frac{1}{\\bar{w}} \\sum_{i=1}^{3} p_i w_i^2$$\nWe first calculate the sum $\\sum_{i=1}^{3} p_i w_i^2$:\n$$\\sum_{i=1}^{3} p_i w_i^2 = (0.5)(1.00)^2 + (0.3)(1.05)^2 + (0.2)(0.98)^2$$\n$$\\sum_{i=1}^{3} p_i w_i^2 = (0.5)(1.0000) + (0.3)(1.1025) + (0.2)(0.9604)$$\n$$\\sum_{i=1}^{3} p_i w_i^2 = 0.50000 + 0.33075 + 0.19208 = 1.02283$$\nNow, we can find $\\bar{w}'$:\n$$\\bar{w}' = \\frac{1.02283}{1.011} \\approx 1.01170128...$$\nRounding to four significant figures gives:\n- $\\bar{w}' \\approx 1.012$\n\nThe final result is the row vector $(p'_1, p'_2, p'_3, \\bar{w}')$ with each entry rounded to four significant figures.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4946  0.3116  0.1939  1.012\n\\end{pmatrix}\n}\n$$", "id": "2832271"}, {"introduction": "Building upon the haploid case, we now incorporate the genetic realities of diploid organisms, including random mating and dominance. Here, selection acts on genotypes, but we track the evolutionary outcome by focusing on the change in allele frequencies. This practice demonstrates how to calculate the next-generation allele frequency, $p'$, by considering how selection differentially affects the homozygous and heterozygous carriers of the allele [@problem_id:2832269].", "problem": "A large, randomly mating diploid population harbors two alleles, $A$ and $a$, at a single autosomal locus. Zygotes form by random union of gametes, so before selection genotype frequencies follow Hardy–Weinberg Equilibrium (HWE): $p^{2}$ for $AA$, $2pq$ for $Aa$, and $q^{2}$ for $aa$, where $p$ is the allele $A$ frequency and $q=1-p$. Viability selection then acts with relative genotype fitnesses $w_{AA}=1+s$, $w_{Aa}=1+hs$, and $w_{aa}=1$, where $s$ is the selection coefficient and $h$ is the dominance parameter. Assume no other evolutionary forces and that adults contribute gametes proportionally to their post-selection frequencies.\n\nStarting from these definitions only, derive the expression for the next-generation allele-$A$ frequency $p'$ after viability selection and compute its value for $p=0.3$, $s=0.02$, and $h=0.25$. Express your final numerical answer as a decimal rounded to four significant figures.", "solution": "The problem requires the derivation of the allele frequency in the next generation, $p'$, under viability selection, starting from first principles. Subsequently, this expression must be evaluated for a specific set of parameters.\n\nThe initial state of the population is described by Hardy-Weinberg Equilibrium (HWE) frequencies for a single locus with two alleles, $A$ and $a$. Let $p$ be the frequency of allele $A$ and $q=1-p$ be the frequency of allele $a$. The genotype frequencies at the zygote stage (before selection) are:\n- Frequency of $AA$: $f_{zygote}(AA) = p^2$\n- Frequency of $Aa$: $f_{zygote}(Aa) = 2pq$\n- Frequency of $aa$: $f_{zygote}(aa) = q^2$\n\nViability selection acts on these genotypes. The relative fitnesses are given as $w_{AA} = 1+s$, $w_{Aa} = 1+hs$, and $w_{aa} = 1$. The frequency of each genotype among the surviving adults is proportional to its initial frequency multiplied by its relative fitness. To obtain the true frequencies of the adult genotypes, we must normalize these products by their sum. This sum is the mean fitness of the population, $\\bar{w}$.\n\nThe mean fitness $\\bar{w}$ is calculated as the weighted average of the genotype fitnesses, where the weights are the HWE genotype frequencies:\n$$ \\bar{w} = f_{zygote}(AA) \\cdot w_{AA} + f_{zygote}(Aa) \\cdot w_{Aa} + f_{zygote}(aa) \\cdot w_{aa} $$\nSubstituting the given expressions, we have:\n$$ \\bar{w} = p^2(1+s) + 2pq(1+hs) + q^2(1) $$\n\nThe frequencies of the genotypes among the adult population that survives to reproduce are then:\n- Frequency of adult $AA$: $f_{adult}(AA) = \\frac{p^2 w_{AA}}{\\bar{w}} = \\frac{p^2(1+s)}{\\bar{w}}$\n- Frequency of adult $Aa$: $f_{adult}(Aa) = \\frac{2pq w_{Aa}}{\\bar{w}} = \\frac{2pq(1+hs)}{\\bar{w}}$\n- Frequency of adult $aa$: $f_{adult}(aa) = \\frac{q^2 w_{aa}}{\\bar{w}} = \\frac{q^2}{\\bar{w}}$\n\nThe allele frequency of $A$ in the next generation, $p'$, is the frequency of $A$ alleles in the gamete pool produced by these surviving adults. Assuming Mendelian genetics, homozygous $AA$ individuals produce only $A$ gametes, while heterozygous $Aa$ individuals produce $A$ and $a$ gametes in equal proportion ($1/2$ each). Therefore, $p'$ is the sum of the frequency of $AA$ adults and half the frequency of $Aa$ adults:\n$$ p' = f_{adult}(AA) + \\frac{1}{2} f_{adult}(Aa) $$\nSubstituting the expressions for the adult frequencies:\n$$ p' = \\frac{p^2 w_{AA}}{\\bar{w}} + \\frac{1}{2} \\left( \\frac{2pq w_{Aa}}{\\bar{w}} \\right) = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}} $$\nFactoring out $p$ from the numerator gives an alternative form:\n$$ p' = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} $$\nSubstituting the full expression for $\\bar{w}$ and the specific fitness values, we arrive at the general formula for the allele frequency in the next generation:\n$$ p' = \\frac{p^2(1+s) + pq(1+hs)}{p^2(1+s) + 2pq(1+hs) + q^2} $$\nThis concludes the derivation.\n\nNext, we must compute the numerical value of $p'$ given $p=0.3$, $s=0.02$, and $h=0.25$.\nFirst, we determine the frequency of the $a$ allele: $q = 1-p = 1-0.3 = 0.7$.\n\nWe calculate the numerator of the expression for $p'$:\n$$ \\text{Numerator} = p^2(1+s) + pq(1+hs) $$\n$$ \\text{Numerator} = (0.3)^2(1+0.02) + (0.3)(0.7)(1+(0.25)(0.02)) $$\n$$ \\text{Numerator} = (0.09)(1.02) + (0.21)(1+0.005) $$\n$$ \\text{Numerator} = (0.09)(1.02) + (0.21)(1.005) $$\n$$ \\text{Numerator} = 0.0918 + 0.21105 = 0.30285 $$\n\nNext, we calculate the denominator, which is the mean fitness $\\bar{w}$:\n$$ \\bar{w} = p^2(1+s) + 2pq(1+hs) + q^2 $$\n$$ \\bar{w} = (0.3)^2(1+0.02) + 2(0.3)(0.7)(1.005) + (0.7)^2 $$\n$$ \\bar{w} = 0.0918 + (0.42)(1.005) + 0.49 $$\n$$ \\bar{w} = 0.0918 + 0.4221 + 0.49 = 1.0039 $$\n\nFinally, we compute $p'$ by dividing the numerator by the denominator:\n$$ p' = \\frac{0.30285}{1.0039} \\approx 0.3016635123... $$\nThe problem requires the result to be rounded to four significant figures. The fifth significant figure is $6$, so we round up the fourth.\n$$ p' \\approx 0.3017 $$", "answer": "$$ \\boxed{0.3017} $$", "id": "2832269"}, {"introduction": "Selection does not always drive an allele to fixation; in some cases, it can actively maintain genetic diversity. This exercise explores the classic case of overdominance, or heterozygote advantage, where the heterozygote genotype has the highest fitness. You will derive the conditions for a stable polymorphic equilibrium and calculate this balancing point, revealing how selection can lead to a steady state with multiple alleles coexisting in the population [@problem_id:2832267].", "problem": "Consider a very large, randomly mating diploid population with discrete non-overlapping generations under viability selection at a single locus with two alleles $A$ and $a$. Assume Hardy–Weinberg Equilibrium (HWE) before selection in each generation. The genotype relative viabilities are $w_{AA}=0.9$, $w_{Aa}=1$, and $w_{aa}=0.8$. Let $p$ denote the frequency of allele $A$ among zygotes before selection and $q=1-p$.\n\nStarting from the foundational definitions of relative fitness, mean fitness, and the allele-frequency recursion under viability selection (obtained by weighting genotype frequencies by their relative fitnesses and normalizing by the mean fitness), do the following:\n\n1. Derive the condition that characterizes any internal equilibrium allele frequency $p^{*}\\in(0,1)$ under overdominance (that is, when the heterozygote has the highest viability), expressed in terms of the fitness parameters.\n2. Using that condition, determine the internal equilibrium allele frequency $p^{*}$ for the given fitness values.\n3. Evaluate the mean fitness $\\bar{w}$ at this equilibrium frequency.\n\nReport only the mean fitness at equilibrium as your final answer, and express it as an exact rational number. Do not include any units.", "solution": "The problem posed is a standard exercise in theoretical population genetics and is well-defined. We shall proceed with its solution.\n\nThe foundational principle of viability selection in a diploid population is that different genotypes survive from the zygote stage to the adult stage at different rates. These differential survival rates are quantified by relative fitnesses, or viabilities, which we denote as $w_{AA}$, $w_{Aa}$, and $w_{aa}$.\n\nWe begin by considering a very large population where mating is random. Under these conditions, the genotype frequencies among zygotes in any generation are given by the Hardy-Weinberg proportions:\n- Frequency of $AA$ zygotes: $f(AA)_{zygotes} = p^2$\n- Frequency of $Aa$ zygotes: $f(Aa)_{zygotes} = 2pq$\n- Frequency of $aa$ zygotes: $f(aa)_{zygotes} = q^2$\nwhere $p$ is the frequency of allele $A$ and $q = 1-p$ is the frequency of allele $a$ in the gene pool of the previous generation.\n\nAfter selection, the frequencies of the three genotypes among the surviving adults are proportional to their initial frequencies multiplied by their respective relative viabilities.\n- Proportional frequency of $AA$ adults $\\propto p^2 w_{AA}$\n- Proportional frequency of $Aa$ adults $\\propto 2pq w_{Aa}$\n- Proportional frequency of $aa$ adults $\\propto q^2 w_{aa}$\n\nThe sum of these proportional frequencies gives the mean fitness of the population, $\\bar{w}$, which serves as the normalization constant to bring the frequencies of surviving adults to sum to $1$.\n$$ \\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$\n\nThe frequency of allele $A$ in the next generation, denoted $p'$, is the frequency of allele $A$ among the gametes produced by the surviving adults. Since $AA$ individuals produce only $A$ gametes and $Aa$ individuals produce $A$ gametes with a frequency of $1/2$, the frequency $p'$ is given by the sum of the frequencies of $AA$ adults and half the frequency of $Aa$ adults.\n$$ p' = \\frac{p^2 w_{AA} + \\frac{1}{2}(2pq w_{Aa})}{\\bar{w}} = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}} = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} $$\nThis equation is the allele-frequency recursion under viability selection.\n\nAn equilibrium is a state where the allele frequency does not change between generations, i.e., $p' = p$. The change in allele frequency per generation is $\\Delta p = p' - p$.\n$$ \\Delta p = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} - p = \\frac{p(p w_{AA} + q w_{Aa}) - p\\bar{w}}{\\bar{w}} $$\nWe can express $\\bar{w}$ in terms of the average fitnesses of the alleles, $\\bar{w}_A = p w_{AA} + q w_{Aa}$ and $\\bar{w}_a = p w_{Aa} + q w_{aa}$, such that $\\bar{w} = p \\bar{w}_A + q \\bar{w}_a$.\nSubstituting this into the expression for $\\Delta p$:\n$$ \\Delta p = \\frac{p \\bar{w}_A - p(p\\bar{w}_A + q\\bar{w}_a)}{\\bar{w}} = \\frac{p \\bar{w}_A (1 - p) - pq\\bar{w}_a}{\\bar{w}} = \\frac{pq(\\bar{w}_A - \\bar{w}_a)}{\\bar{w}} $$\nEquilibrium ($\\Delta p = 0$) occurs if $p=0$, $q=0$ (i.e., $p=1$), or $\\bar{w}_A - \\bar{w}_a = 0$. The first two are trivial equilibria where one allele is fixed. An internal equilibrium, where both alleles are maintained in the population ($p^* \\in (0,1)$), requires the third condition:\n$$ \\bar{w}_A = \\bar{w}_a $$\nThis is the general condition for an internal equilibrium.\n\n1. To derive the equilibrium allele frequency $p^*$ in terms of fitness parameters, we solve this condition:\n$$ p^* w_{AA} + (1-p^*) w_{Aa} = p^* w_{Aa} + (1-p^*) w_{aa} $$\nRearranging the terms to solve for $p^*$:\n$$ p^*(w_{AA} - w_{Aa}) + w_{Aa} = p^*(w_{Aa} - w_{aa}) + w_{aa} $$\n$$ w_{Aa} - w_{aa} = p^*(w_{Aa} - w_{aa} - (w_{AA} - w_{Aa})) $$\n$$ w_{Aa} - w_{aa} = p^*(2w_{Aa} - w_{AA} - w_{aa}) $$\nThis yields the expression for the internal equilibrium allele frequency:\n$$ p^* = \\frac{w_{Aa} - w_{aa}}{2w_{Aa} - w_{AA} - w_{aa}} $$\nThis equilibrium is stable under overdominance, where $w_{Aa}  w_{AA}$ and $w_{Aa}  w_{aa}$. In this case, both the numerator ($w_{Aa} - w_{aa}$) and the denominator ($(w_{Aa} - w_{AA}) + (w_{Aa} - w_{aa})$) are positive, ensuring $p^*  0$. It can also be shown that $p^*  1$.\n\n2. We now use the given fitness values: $w_{AA}=0.9$, $w_{Aa}=1$, and $w_{aa}=0.8$. These values correspond to overdominance. We substitute them into the derived formula for $p^*$:\n$$ p^* = \\frac{1 - 0.8}{2(1) - 0.9 - 0.8} = \\frac{0.2}{2 - 1.7} = \\frac{0.2}{0.3} = \\frac{2}{3} $$\nThe internal equilibrium frequency for allele $A$ is $p^* = 2/3$. Consequently, the equilibrium frequency for allele $a$ is $q^* = 1 - p^* = 1/3$.\n\n3. Finally, we evaluate the mean fitness of the population at this equilibrium, $\\bar{w}^*$. At equilibrium, we have the identity $\\bar{w}^* = \\bar{w}_A = \\bar{w}_a$. We can use either expression. Let us use $\\bar{w}_A = p w_{AA} + q w_{Aa}$:\n$$ \\bar{w}^* = p^* w_{AA} + q^* w_{Aa} = \\left(\\frac{2}{3}\\right)(0.9) + \\left(\\frac{1}{3}\\right)(1) $$\n$$ \\bar{w}^* = \\left(\\frac{2}{3}\\right)\\left(\\frac{9}{10}\\right) + \\frac{1}{3} = \\frac{18}{30} + \\frac{1}{3} = \\frac{3}{5} + \\frac{1}{3} $$\nTo sum these fractions, we find a common denominator of $15$:\n$$ \\bar{w}^* = \\frac{9}{15} + \\frac{5}{15} = \\frac{14}{15} $$\nThis is the mean fitness at the stable internal equilibrium, expressed as an exact rational number.\nAs a check, we can compute $\\bar{w}^*$ using the full expression:\n$$ \\bar{w}^* = (p^*)^2 w_{AA} + 2p^*q^* w_{Aa} + (q^*)^2 w_{aa} = \\left(\\frac{2}{3}\\right)^2(0.9) + 2\\left(\\frac{2}{3}\\right)\\left(\\frac{1}{3}\\right)(1) + \\left(\\frac{1}{3}\\right)^2(0.8) $$\n$$ \\bar{w}^* = \\left(\\frac{4}{9}\\right)\\left(\\frac{9}{10}\\right) + \\frac{4}{9} + \\left(\\frac{1}{9}\\right)\\left(\\frac{8}{10}\\right) = \\frac{36}{90} + \\frac{40}{90} + \\frac{8}{90} = \\frac{84}{90} = \\frac{14}{15} $$\nThe result is consistent.", "answer": "$$\\boxed{\\frac{14}{15}}$$", "id": "2832267"}]}