{"hands_on_practices": [{"introduction": "This exercise provides hands-on practice with one of the most fundamental tools in a geneticist's toolkit: the chi-squared ($\\chi^2$) goodness-of-fit test. After observing the outcomes of a genetic cross, we must determine if the data conform to the predictions of a specific genetic model, such as the $9\\!:\\!3\\!:\\!4$ ratio expected for recessive epistasis. This practice will guide you through calculating the $\\chi^2$ statistic and interpreting its associated $p$-value to make a statistically sound conclusion about your genetic hypothesis [@problem_id:2808178].", "problem": "In a species where two unlinked loci, denoted by $A$ and $B$, independently assort, consider a dihybrid self-cross that produces the second filial generation (F$2$). Under recessive epistasis at locus $A$ such that genotype $aa$ masks any allelic state at locus $B$, the classical modified segregation ratio in the F$2$ is $9:3:4$ when phenotypes are grouped as follows: class $1$ is $A\\_-\\;B\\_-$, class $2$ is $A\\_-\\;bb$, and class $3$ is $aa\\;\\_\\_$ (where the underscore denotes either allele at that locus). This $9:3:4$ expectation follows from Mendelian segregation ($1:2:1$ at each locus) and independent assortment, together with the epistatic masking rule that collapses genotypes into phenotypic classes.\n\nAn experimental F$2$ sample yields the following observed counts: class $1$ has $92$ individuals, class $2$ has $27$ individuals, and class $3$ has $41$ individuals.\n\nUsing a $\\chi^2$ goodness-of-fit framework grounded in the above genetic assumptions, test the fit of the observed counts to the $9:3:4$ epistatic model by calculating the exact probability value ($p$-value) from the $\\chi^2$ distribution with the appropriate degrees of freedom. Express the $p$-value as a decimal and round your answer to four significant figures.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\nGivens are extracted verbatim:\n1.  Two unlinked loci, $A$ and $B$, independently assort.\n2.  A dihybrid self-cross produces the second filial generation (F$2$).\n3.  Recessive epistasis at locus $A$ results in genotype $aa$ masking locus $B$.\n4.  The theoretical modified segregation ratio is $9:3:4$ for phenotypic classes $A\\_-\\;B\\_-$, $A\\_-\\;bb$, and $aa\\;\\_\\_$, respectively.\n5.  Observed counts are: $92$ for class $1$, $27$ for class $2$, and $41$ for class $3$.\n6.  The task is to perform a $\\chi^2$ goodness-of-fit test and calculate the $p$-value, rounded to four significant figures.\n\nValidation Verdict:\nThe problem is valid. It is scientifically grounded in established principles of Mendelian genetics (independent assortment, epistasis) and statistical analysis ($\\chi^2$ test). It is well-posed, providing all necessary data (observed counts, theoretical model) and a clear objective. There are no contradictions, ambiguities, or factual inaccuracies. The problem is a standard, formal exercise in quantitative genetics.\n\nProceeding with the solution.\n\nThe objective is to test the null hypothesis ($H_0$) that the observed phenotypic counts are consistent with the theoretical $9:3:4$ ratio expected from recessive epistasis. The alternative hypothesis ($H_A$) is that the data do not fit this ratio.\n\nFirst, the total number of individuals in the sample, $N$, is calculated:\n$$N = 92 + 27 + 41 = 160$$\n\nNext, we calculate the expected counts ($E_i$) for each of the $k=3$ phenotypic classes based on the total sample size $N$ and the theoretical ratio $9:3:4$. The sum of the ratio parts is $9 + 3 + 4 = 16$.\n\nThe expected count for class $1$ ($A\\_-\\;B\\_-$) is:\n$$E_1 = N \\times \\frac{9}{16} = 160 \\times \\frac{9}{16} = 90$$\nThe expected count for class $2$ ($A\\_-\\;bb$) is:\n$$E_2 = N \\times \\frac{3}{16} = 160 \\times \\frac{3}{16} = 30$$\nThe expected count for class $3$ ($aa\\;\\_\\_$) is:\n$$E_3 = N \\times \\frac{4}{16} = 160 \\times \\frac{4}{16} = 40$$\nA check confirms that the sum of expected counts equals the total sample size: $90 + 30 + 40 = 160$.\n\nThe $\\chi^2$ (chi-squared) statistic is calculated using the formula:\n$$\\chi^2 = \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i}$$\nwhere $O_i$ are the observed counts and $E_i$ are the expected counts.\n\nSubstituting the observed values ($O_1=92$, $O_2=27$, $O_3=41$) and expected values ($E_1=90$, $E_2=30$, $E_3=40$):\n$$\\chi^2 = \\frac{(92 - 90)^2}{90} + \\frac{(27 - 30)^2}{30} + \\frac{(41 - 40)^2}{40}$$\n$$\\chi^2 = \\frac{2^2}{90} + \\frac{(-3)^2}{30} + \\frac{1^2}{40}$$\n$$\\chi^2 = \\frac{4}{90} + \\frac{9}{30} + \\frac{1}{40}$$\nTo compute this precisely, we find a common denominator, which is $360$.\n$$\\chi^2 = \\frac{16}{360} + \\frac{108}{360} + \\frac{9}{360} = \\frac{16 + 108 + 9}{360} = \\frac{133}{360}$$\n\nThe degrees of freedom ($df$) for a goodness-of-fit test are given by $df = k - 1 - m$, where $k$ is the number of categories and $m$ is the number of parameters estimated from the data. In this case, the theoretical ratio is given by the genetic model and no parameters are estimated from the sample. Thus, $m=0$.\n$$df = k - 1 = 3 - 1 = 2$$\n\nThe $p$-value is the probability of obtaining a $\\chi^2$ value greater than or equal to the calculated statistic, given a $\\chi^2$ distribution with $2$ degrees of freedom.\n$$p = P(\\chi^2_{df=2} \\ge \\frac{133}{360})$$\nCalculating the decimal value of the statistic:\n$$\\frac{133}{360} \\approx 0.369444...$$\nThe $p$-value is found by integrating the probability density function of the $\\chi^2$ distribution with $2$ degrees of freedom from $\\frac{133}{360}$ to infinity, or more practically, by using a statistical calculator or software.\nFor $\\chi^2 \\approx 0.3694$ and $df=2$, the corresponding right-tail probability is:\n$$p \\approx 0.83132$$\nThe problem requires the answer to be rounded to four significant figures.\n$$p \\approx 0.8313$$\nThis high $p$-value (typically, $p > 0.05$) indicates that there is no statistically significant evidence to reject the null hypothesis. The observed data are consistent with the $9:3:4$ model of recessive epistasis.", "answer": "$$\n\\boxed{0.8313}\n$$", "id": "2808178"}, {"introduction": "While F2 segregation ratios provide a broad overview of a genetic interaction, a deeper understanding requires dissecting the genotypes hidden within each phenotypic class. This problem explores the classical method of progeny testing, where F2 individuals are self-fertilized to reveal their underlying genetic makeup through the segregation patterns of their F3 offspring. By deriving these expected F3 outcomes from first principles, you will solidify your understanding of how Mendelian laws operate over multiple generations and confirm the specific nature of the epistatic interaction at play [@problem_id:2808192].", "problem": "A plant species exhibits three discrete phenotypic classes, denoted $\\mathcal{P}_{1}$, $\\mathcal{P}_{2}$, and $\\mathcal{P}_{3}$. Two unlinked nuclear loci, $A/a$ and $B/b$, determine these phenotypes under recessive epistasis at $B/b$ as follows: any individual with genotype $b b$ expresses $\\mathcal{P}_{3}$ regardless of genotype at $A/a$; in the presence of at least one dominant $B$ allele (i.e., $B\\_$), individuals with at least one dominant $A$ allele ($A\\_$) express $\\mathcal{P}_{1}$, while $a a B\\_$ individuals express $\\mathcal{P}_{2}$. Two true-breeding lines are crossed: line $1$ is $A A B B$ (expressing $\\mathcal{P}_{1}$) and line $2$ is $a a b b$ (expressing $\\mathcal{P}_{3}$), producing the first filial generation (F1) $A a B b$. The F1 is selfed to produce the second filial generation (F2). By the laws of segregation and independent assortment, the F2 exhibits the classical modified segregation ratio for recessive epistasis.\n\nYou randomly sample F2 individuals by phenotypic class and self each selected F2 to produce an F3 family. Assume infinite F3 progeny per family so that each family’s observed segregation matches its expectation exactly (no sampling variance). Using only the following foundational principles:\n- Mendel’s law of segregation at each locus,\n- Mendel’s law of independent assortment between $A/a$ and $B/b$,\n- The epistasis rule described above,\n\nderive from first principles the expected mixture of F3 segregation types produced by selfing F2 parents drawn from each of the three F2 phenotypic classes $\\mathcal{P}_{1}$, $\\mathcal{P}_{2}$, and $\\mathcal{P}_{3}$. Then, treating draws of F2 individuals from different classes as independent, compute the probability that the following joint event occurs when you independently select one random F2 individual from the $\\mathcal{P}_{1}$ class and one random F2 individual from the $\\mathcal{P}_{2}$ class and self both:\n\n- The F3 family from the $\\mathcal{P}_{1}$ parent shows a $3:1$ segregation between $\\mathcal{P}_{1}:\\mathcal{P}_{3}$.\n- The F3 family from the $\\mathcal{P}_{2}$ parent shows a $3:1$ segregation between $\\mathcal{P}_{2}:\\mathcal{P}_{3}$.\n\nExpress your final answer as a single reduced fraction (no units). No rounding is required or allowed.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of givens based on fundamental principles of Mendelian genetics, specifically the laws of segregation and independent assortment, combined with a clearly defined rule for recessive epistasis. The problem is a standard exercise in transmission genetics and is valid for solution. I will now proceed with a derivation from first principles.\n\nThe initial cross is between two true-breeding lines, $A A B B$ (phenotype $\\mathcal{P}_{1}$) and $a a b b$ (phenotype $\\mathcal{P}_{3}$). The first filial generation (F1) consists entirely of individuals with genotype $A a B b$. The F1 is self-crossed ($A a B b \\times A a B b$) to produce the second filial generation (F2). According to the law of independent assortment, the expected genotypic proportions in the F2 are the product of the proportions for each locus independently. A self-cross of $A a \\times A a$ yields genotypes $A A$, $A a$, and $a a$ in a $1:2:1$ ratio. Similarly, $B b \\times B b$ yields $B B$, $B b$, and $b b$ in a $1:2:1$ ratio. The resulting $16$-part genotypic ratio in the F2 is as follows, grouped by their corresponding phenotypes:\n\nThe epistasis rule defines the mapping from genotype to phenotype:\n- $\\mathcal{P}_{1}$: $A\\_ B\\_$\n- $\\mathcal{P}_{2}$: $a a B\\_$\n- $\\mathcal{P}_{3}$: $\\_\\_ b b$\n\nThe F2 phenotypic ratio is derived by summing the frequencies of the underlying genotypes:\n- $P(\\mathcal{P}_{1}) = P(A\\_ B\\_) = P(A\\_) \\times P(B\\_) = (\\frac{3}{4}) \\times (\\frac{3}{4}) = \\frac{9}{16}$.\n- $P(\\mathcal{P}_{2}) = P(a a B\\_) = P(a a) \\times P(B\\_) = (\\frac{1}{4}) \\times (\\frac{3}{4}) = \\frac{3}{16}$.\n- $P(\\mathcal{P}_{3}) = P(\\_\\_ b b) = P(b b) = \\frac{1}{4} = \\frac{4}{16}$.\nThis confirms the classical $9:3:4$ modified Mendelian ratio for recessive epistasis.\n\nNext, we must determine the expected segregation patterns in the F3 generation resulting from self-fertilizing F2 individuals sampled from each phenotypic class.\n\n**F3 Segregation from F2 Class $\\mathcal{P}_{1}$ ($A\\_ B\\_$)**\nThe $A\\_ B\\_$ class comprises four genotypes with total frequency $\\frac{9}{16}$: $A A B B$ ($\\frac{1}{16}$), $A A B b$ ($\\frac{2}{16}$), $A a B B$ ($\\frac{2}{16}$), and $A a B b$ ($\\frac{4}{16}$). The conditional probability of drawing an individual with a specific genotype from this class is its frequency relative to the class frequency ($\\frac{9}{16}$).\n1.  F2 parent $A A B B$ (Prob. within class: $\\frac{1/16}{9/16} = \\frac{1}{9}$): Selfing gives all $A A B B$ progeny, which express $\\mathcal{P}_{1}$. This family breeds true for $\\mathcal{P}_{1}$.\n2.  F2 parent $A A B b$ (Prob. within class: $\\frac{2/16}{9/16} = \\frac{2}{9}$): Selfing gives progeny genotypes $\\frac{1}{4} A A B B$, $\\frac{2}{4} A A B b$, and $\\frac{1}{4} A A b b$. The phenotypic ratio is $\\frac{3}{4} A A B\\_ (\\mathcal{P}_{1}) : \\frac{1}{4} A A b b (\\mathcal{P}_{3})$, a $3:1$ segregation of $\\mathcal{P}_{1}:\\mathcal{P}_{3}$.\n3.  F2 parent $A a B B$ (Prob. within class: $\\frac{2/16}{9/16} = \\frac{2}{9}$): Selfing gives progeny genotypes $\\frac{1}{4} A A B B$, $\\frac{2}{4} A a B B$, and $\\frac{1}{4} a a B B$. The phenotypic ratio is $\\frac{3}{4} A\\_ B B (\\mathcal{P}_{1}) : \\frac{1}{4} a a B B (\\mathcal{P}_{2})$, a $3:1$ segregation of $\\mathcal{P}_{1}:\\mathcal{P}_{2}$.\n4.  F2 parent $A a B b$ (Prob. within class: $\\frac{4/16}{9/16} = \\frac{4}{9}$): Selfing gives the original $9:3:4$ phenotypic ratio of $\\mathcal{P}_{1}:\\mathcal{P}_{2}:\\mathcal{P}_{3}$.\n\n**F3 Segregation from F2 Class $\\mathcal{P}_{2}$ ($a a B\\_$)**\nThe $a a B\\_$ class comprises two genotypes with total frequency $\\frac{3}{16}$: $a a B B$ ($\\frac{1}{16}$) and $a a B b$ ($\\frac{2}{16}$).\n1.  F2 parent $a a B B$ (Prob. within class: $\\frac{1/16}{3/16} = \\frac{1}{3}$): Selfing gives all $a a B B$ progeny, which express $\\mathcal{P}_{2}$. This family breeds true for $\\mathcal{P}_{2}$.\n2.  F2 parent $a a B b$ (Prob. within class: $\\frac{2/16}{3/16} = \\frac{2}{3}$): Selfing gives progeny genotypes $\\frac{1}{4} a a B B$, $\\frac{2}{4} a a B b$, and $\\frac{1}{4} a a b b$. The phenotypic ratio is $\\frac{3}{4} a a B\\_ (\\mathcal{P}_{2}) : \\frac{1}{4} a a b b (\\mathcal{P}_{3})$, a $3:1$ segregation of $\\mathcal{P}_{2}:\\mathcal{P}_{3}$.\n\n**F3 Segregation from F2 Class $\\mathcal{P}_{3}$ ($\\_\\_ b b$)**\nThis class includes genotypes $A A b b$ ($\\frac{1}{16}$), $A a b b$ ($\\frac{2}{16}$), and $a a b b$ ($\\frac{1}{16}$). All individuals are homozygous recessive $b b$. Upon selfing, any parent with genotype $\\_\\_ b b$ can only produce $b$ gametes at the $B/b$ locus. Therefore, all F3 progeny will have genotype $\\_\\_ b b$ and will express phenotype $\\mathcal{P}_{3}$, regardless of the segregation at the $A/a$ locus. Thus, any F2 individual from class $\\mathcal{P}_{3}$ will breed true for $\\mathcal{P}_{3}$.\n\nWith the F3 segregation analysis complete, we can now compute the required probability. The problem asks for the probability of a joint event involving two independent selections.\n\nLet $E_{1}$ be the event that a randomly selected F2 individual from class $\\mathcal{P}_{1}$ produces an F3 family with a $3:1$ segregation of $\\mathcal{P}_{1}:\\mathcal{P}_{3}$. From our analysis, this specific segregation occurs only if the F2 parent's genotype is $A A B b$. The probability of selecting such an individual from the $\\mathcal{P}_{1}$ population is the proportion of $A A B b$ genotypes within that class.\n$$P(E_{1}) = P(\\text{genotype is } A A B b \\mid \\text{phenotype is } \\mathcal{P}_{1}) = \\frac{P(A A B b)}{P(\\mathcal{P}_{1})} = \\frac{2/16}{9/16} = \\frac{2}{9}$$\n\nLet $E_{2}$ be the event that a randomly selected F2 individual from class $\\mathcal{P}_{2}$ produces an F3 family with a $3:1$ segregation of $\\mathcal{P}_{2}:\\mathcal{P}_{3}$. From our analysis, this segregation occurs only if the F2 parent's genotype is $a a B b$. The probability of selecting such an individual from the $\\mathcal{P}_{2}$ population is the proportion of $a a B b$ genotypes within that class.\n$$P(E_{2}) = P(\\text{genotype is } a a B b \\mid \\text{phenotype is } \\mathcal{P}_{2}) = \\frac{P(a a B b)}{P(\\mathcal{P}_{2})} = \\frac{2/16}{3/16} = \\frac{2}{3}$$\n\nThe problem states that the two selections are independent. Therefore, the probability of the joint event ($E_{1}$ and $E_{2}$) is the product of their individual probabilities.\n$$P(E_{1} \\cap E_{2}) = P(E_{1}) \\times P(E_{2})$$\n$$P(E_{1} \\cap E_{2}) = \\frac{2}{9} \\times \\frac{2}{3} = \\frac{4}{27}$$\n\nThis fraction is in its simplest form.", "answer": "$$\n\\boxed{\\frac{4}{27}}\n$$", "id": "2808192"}, {"introduction": "Moving beyond classical ratios, this exercise introduces a powerful modern framework for quantifying epistasis using statistical models. You will learn to interpret epistasis not just as a modification of Mendelian ratios, but as a statistical interaction term within a logistic regression model, a concept central to quantitative genetics and genome-wide association studies. This practice involves fitting a model to data to estimate the magnitude of epistasis on the log-odds scale, providing a quantitative measure of the non-additive effects of genes on a trait's risk [@problem_id:2808168].", "problem": "You must write a complete program that, for a dihybrid $\\mathrm{F}_2$ cross with two unlinked loci and a binary phenotype, fits a logistic regression model with an interaction term and interprets the interaction coefficient as an epistatic deviation from multiplicativity on the odds scale. The model and all quantities are to be computed from provided aggregated counts. The program must output a single line containing the computed results for several test cases.\n\nBackground and fundamental base:\n- Under Mendelian segregation with independent assortment and complete gametic randomization, the presence of at least one dominant allele at locus $A$ occurs in an $\\mathrm{F}_2$ individual with probability $3/4$, and similarly for locus $B$. Hence, across the four joint indicator classes $\\left(x_A,x_B\\right)\\in\\{0,1\\}^2$ with $x_A=1$ if at least one dominant $A$ allele is present and $x_A=0$ otherwise (and analogously for $x_B$), the $\\mathrm{F}_2$ genotype-class frequencies are $9/16$ for $\\left(1,1\\right)$, $3/16$ for $\\left(1,0\\right)$, $3/16$ for $\\left(0,1\\right)$, and $1/16$ for $\\left(0,0\\right)$.\n- For each class $\\left(x_A,x_B\\right)$, let $Y\\in\\{0,1\\}$ denote the binary phenotype. Assume that, conditional on $\\left(x_A,x_B\\right)$, $Y$ is Bernoulli with penetrance $p_{x_A x_B}=\\Pr\\!\\left(Y=1\\mid x_A,x_B\\right)$, and that aggregated counts within a class are binomially distributed. The log-likelihood therefore factorizes across classes as a sum of binomial log-likelihoods.\n- Consider the logistic regression model with interaction\n$$\n\\operatorname{logit}\\!\\left(p_{x_A x_B}\\right)=\\log\\!\\left(\\frac{p_{x_A x_B}}{1-p_{x_A x_B}}\\right)=\\beta_0+\\beta_A x_A+\\beta_B x_B+\\beta_{AB}\\,x_A x_B,\n$$\nwhere $\\beta_0$, $\\beta_A$, $\\beta_B$, and $\\beta_{AB}$ are parameters to be estimated by maximum likelihood using the aggregated binomial data. In this model, absence of epistasis on the odds scale corresponds to additivity on the log-odds scale, that is, $\\beta_{AB}=0$. The coefficient $\\beta_{AB}$ therefore quantifies epistatic deviation from multiplicativity on the odds scale. On the risk (probability) scale, a related epistasis measure is the deviation from multiplicativity\n$$\nE_{\\text{risk}}=\\log\\!\\left(p_{11}\\right)-\\log\\!\\left(p_{10}\\right)-\\log\\!\\left(p_{01}\\right)+\\log\\!\\left(p_{00}\\right),\n$$\nwhich equals zero if and only if $p_{11}=\\dfrac{p_{10}\\,p_{01}}{p_{00}}$.\n- The modified segregation ratio among affected individuals expected in an $\\mathrm{F}_2$ can be expressed per $16$ progeny as the vector\n$$\n\\left[\\,9\\,p_{11},\\,3\\,p_{10},\\,3\\,p_{01},\\,1\\,p_{00}\\,\\right],\n$$\ncorresponding respectively to the $\\left(x_A,x_B\\right)$ classes $\\left(1,1\\right)$, $\\left(1,0\\right)$, $\\left(0,1\\right)$, and $\\left(0,0\\right)$.\n\nTasks to implement:\n- For each provided test case, you are given aggregated counts for the four $\\left(x_A,x_B\\right)$ classes, in the fixed order $\\left[\\left(1,1\\right),\\left(1,0\\right),\\left(0,1\\right),\\left(0,0\\right)\\right]$. Each entry is a pair $\\left(y,n\\!-\\!y\\right)$, where $y$ is the number of affected individuals and $n\\!-\\!y$ is the number of unaffected individuals in that class, with $n=y+(n-y)$ the class total. From these counts:\n  1. Compute the sample penetrance estimates $\\hat p_{x_A x_B}=y/n$ for each class.\n  2. Fit the logistic regression model by maximizing the aggregated binomial likelihood. Because the design with $\\left(x_A,x_B,x_A x_B\\right)$ is saturated for the four classes, the maximum likelihood estimates satisfy\n     $$\n     \\widehat{\\beta}_{AB}=\\operatorname{logit}\\!\\left(\\hat p_{11}\\right)-\\operatorname{logit}\\!\\left(\\hat p_{10}\\right)-\\operatorname{logit}\\!\\left(\\hat p_{01}\\right)+\\operatorname{logit}\\!\\left(\\hat p_{00}\\right),\n     $$\n     and similarly for $\\widehat{\\beta}_0,\\widehat{\\beta}_A,\\widehat{\\beta}_B$ via linear combinations of the four logits. You may compute $\\widehat{\\beta}_{AB}$ either by explicit maximization or by these identities.\n  3. Compute the odds-scale epistasis from the fitted probabilities,\n     $$\n     E_{\\text{odds}}=\\operatorname{logit}\\!\\left(\\hat p_{11}\\right)-\\operatorname{logit}\\!\\left(\\hat p_{10}\\right)-\\operatorname{logit}\\!\\left(\\hat p_{01}\\right)+\\operatorname{logit}\\!\\left(\\hat p_{00}\\right),\n     $$\n     which must equal $\\widehat{\\beta}_{AB}$ for the saturated model.\n  4. Compute the risk-scale multiplicative deviation\n     $$\n     E_{\\text{risk}}=\\log\\!\\left(\\hat p_{11}\\right)-\\log\\!\\left(\\hat p_{10}\\right)-\\log\\!\\left(\\hat p_{01}\\right)+\\log\\!\\left(\\hat p_{00}\\right).\n     $$\n  5. Compute the expected modified segregation counts among affected per $16$ progeny,\n     $$\n     \\left[\\,9\\,\\hat p_{11},\\,3\\,\\hat p_{10},\\,3\\,\\hat p_{01},\\,1\\,\\hat p_{00}\\,\\right].\n     $$\n- The final output for each test case must be the list\n  $$\n  \\left[\\,\\widehat{\\beta}_{AB},\\,E_{\\text{odds}},\\,9\\,\\hat p_{11},\\,3\\,\\hat p_{10},\\,3\\,\\hat p_{01},\\,\\hat p_{00}\\,\\right],\n  $$\n  with all floats rounded to $6$ decimal places. Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these per-case lists enclosed in square brackets, for example $\\left[\\,[\\cdots],[\\cdots]\\,\\right]$.\n\nTest suite:\n- Test case $1$ data in the order $\\left[\\left(1,1\\right),\\left(1,0\\right),\\left(0,1\\right),\\left(0,0\\right)\\right]$:\n  - $\\left(540,360\\right)$, $\\left(60,240\\right)$, $\\left(90,210\\right)$, $\\left(10,90\\right)$.\n- Test case $2$ data:\n  - $\\left(450,450\\right)$, $\\left(120,180\\right)$, $\\left(120,180\\right)$, $\\left(25,75\\right)$.\n- Test case $3$ data:\n  - $\\left(720,270\\right)$, $\\left(132,198\\right)$, $\\left(165,165\\right)$, $\\left(22,88\\right)$.\n\nAnswer specification:\n- For each test case, your program must emit the list $\\left[\\,\\widehat{\\beta}_{AB},\\,E_{\\text{odds}},\\,9\\,\\hat p_{11},\\,3\\,\\hat p_{10},\\,3\\,\\hat p_{01},\\,\\hat p_{00}\\,\\right]$, rounded to $6$ decimal places.\n- Aggregate the results across all test cases into a single list, and print exactly one line containing this list in the format $\\left[\\,[r_{1,1},\\dots,r_{1,6}],[r_{2,1},\\dots,r_{2,6}],[r_{3,1},\\dots,r_{3,6}]\\,\\right]$ with no extra text.\n- No physical units or angle units are involved. All proportions must be expressed as decimals, not percentages.", "solution": "The problem presented is subjected to rigorous validation and is determined to be valid. It is scientifically grounded in the principles of Mendelian genetics and biostatistics, specifically concerning the analysis of gene-gene interactions (epistasis). The problem is well-posed, providing all necessary data and definitions for a unique and computable solution. The terminology is precise and objective, and the premises are factually correct within the context of the genetic model described.\n\nThe task is to analyze aggregated count data from a dihybrid $\\mathrm{F}_2$ cross to quantify epistasis and compute expected segregation ratios. The procedure for each test case is as follows.\n\nLet the aggregated count data for the four genotype classes be given. The classes correspond to the indicator variables $(x_A, x_B) \\in \\{(1,1), (1,0), (0,1), (0,0)\\}$, where $x_A=1$ denotes the presence of at least one dominant allele at locus $A$, and $x_A=0$ denotes the homozygous recessive genotype. The problem provides counts in the order corresponding to classes $(1,1)$, $(1,0)$, $(0,1)$, and $(0,0)$. For each class $(x_A, x_B)$, we are given a pair of counts $(y_{x_A x_B}, n_{x_A x_B} - y_{x_A x_B})$, where $y_{x_A x_B}$ is the number of affected individuals and $n_{x_A x_B}$ is the total number of individuals.\n\n1.  **Sample Penetrance Estimation**: The penetrance $p_{x_A x_B}$ is the probability of an individual with genotype class $(x_A, x_B)$ being affected. The maximum likelihood estimate of this probability, given the binomial count data, is the sample proportion:\n    $$\n    \\hat{p}_{x_A x_B} = \\frac{y_{x_A x_B}}{n_{x_A x_B}}\n    $$\n    This calculation is performed for all four classes: $\\hat{p}_{11}$, $\\hat{p}_{10}$, $\\hat{p}_{01}$, and $\\hat{p}_{00}$.\n\n2.  **Logistic Regression Model and Parameter Estimation**: The problem defines a logistic regression model for the penetrances:\n    $$\n    \\operatorname{logit}(p_{x_A x_B}) = \\log\\left(\\frac{p_{x_A x_B}}{1-p_{x_A x_B}}\\right) = \\beta_0 + \\beta_A x_A + \\beta_B x_B + \\beta_{AB} x_A x_B\n    $$\n    This represents a system of four linear equations for the four logit-transformed penetrances:\n    \\begin{align*}\n    \\operatorname{logit}(p_{00}) = \\beta_0  (x_A=0, x_B=0) \\\\\n    \\operatorname{logit}(p_{01}) = \\beta_0 + \\beta_B  (x_A=0, x_B=1) \\\\\n    \\operatorname{logit}(p_{10}) = \\beta_0 + \\beta_A  (x_A=1, x_B=0) \\\\\n    \\operatorname{logit}(p_{11}) = \\beta_0 + \\beta_A + \\beta_B + \\beta_{AB}  (x_A=1, x_B=1)\n    \\end{align*}\n    Since this model is saturated (four parameters for four data points), the maximum likelihood estimates of the parameters, denoted $\\widehat{\\beta}$, are found by replacing $p_{x_A x_B}$ with their estimates $\\hat{p}_{x_A x_B}$ and solving the system. The interaction coefficient $\\widehat{\\beta}_{AB}$, which quantifies epistasis on the log-odds scale, is found by a linear combination of the empirical logits:\n    $$\n    \\widehat{\\beta}_{AB} = \\operatorname{logit}(\\hat{p}_{11}) - \\operatorname{logit}(\\hat{p}_{10}) - \\operatorname{logit}(\\hat{p}_{01}) + \\operatorname{logit}(\\hat{p}_{00})\n    $$\n    The problem provides that the input data counts are all non-zero, ensuring that $0  \\hat{p}_{x_A x_B}  1$, so the logit function is well-defined.\n\n3.  **Quantification of Epistasis**: The problem specifies two measures of epistasis.\n    - The odds-scale epistasis, $E_{\\text{odds}}$, is defined as:\n      $$\n      E_{\\text{odds}} = \\operatorname{logit}(\\hat{p}_{11}) - \\operatorname{logit}(\\hat{p}_{10}) - \\operatorname{logit}(\\hat{p}_{01}) + \\operatorname{logit}(\\hat{p}_{00})\n      $$\n      By definition, for this saturated model, $E_{\\text{odds}} = \\widehat{\\beta}_{AB}$. We compute this quantity as a required part of the output.\n    - The risk-scale multiplicative deviation, $E_{\\text{risk}}$, is also defined for completeness, although not part of the final output vector:\n      $$\n      E_{\\text{risk}} = \\log(\\hat{p}_{11}) - \\log(\\hat{p}_{10}) - \\log(\\hat{p}_{01}) + \\log(\\hat{p}_{00})\n      $$\n      This measures deviation from multiplicative effects on the probability scale, i.e., whether $p_{11} p_{00} = p_{10} p_{01}$.\n\n4.  **Modified Segregation Ratio**: With unlinked loci, the genotypes underlying the classes $(1,1), (1,0), (0,1), (0,0)$ segregate in a $9:3:3:1$ ratio in the $\\mathrm{F}_2$ generation. The expected proportions of affected individuals in the $\\mathrm{F}_2$ population are therefore proportional to $9 p_{11}$, $3 p_{10}$, $3 p_{01}$, and $1 p_{00}$. Using the estimated penetrances, we compute the expected counts of affected individuals per $16$ progeny as the vector:\n    $$\n    [9\\hat{p}_{11}, 3\\hat{p}_{10}, 3\\hat{p}_{01}, \\hat{p}_{00}]\n    $$\n\n5.  **Final Output Assembly**: For each test case, the required output is a list containing six floating-point values rounded to six decimal places:\n    $$\n    [\\widehat{\\beta}_{AB}, E_{\\text{odds}}, 9\\hat{p}_{11}, 3\\hat{p}_{10}, 3\\hat{p}_{01}, \\hat{p}_{00}]\n    $$\n    The results from all test cases are then aggregated into a single list of lists for the final output. The implementation will proceed by applying these formulas to the given test case data.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the genetic analysis problem for the provided test cases.\n    For each case, it computes epistasis measures and modified segregation ratios\n    from aggregated count data of a dihybrid F2 cross.\n    \"\"\"\n\n    # Test cases data in the order [(1,1), (1,0), (0,1), (0,0)]\n    # Each entry is a tuple (y, n-y) where y is #affected, n-y is #unaffected.\n    test_cases = [\n        # Test case 1 data\n        [(540, 360), (60, 240), (90, 210), (10, 90)],\n        # Test case 2 data\n        [(450, 450), (120, 180), (120, 180), (25, 75)],\n        # Test case 3 data\n        [(720, 270), (132, 198), (165, 165), (22, 88)],\n    ]\n\n    # List to store the results for all test cases\n    all_results = []\n\n    for case_data in test_cases:\n        # Unpack counts for the four genotype classes\n        # Order: (1,1), (1,0), (0,1), (0,0)\n        (y11, u11), (y10, u10), (y01, u01), (y00, u00) = case_data\n\n        # 1. Compute sample penetrance estimates (p_hat = y/n)\n        p_hat_11 = y11 / (y11 + u11)\n        p_hat_10 = y10 / (y10 + u10)\n        p_hat_01 = y01 / (y01 + u01)\n        p_hat_00 = y00 / (y00 + u00)\n        \n        # Define the logit function\n        def logit(p):\n            return np.log(p / (1 - p))\n\n        # Calculate the logit of each estimated penetrance\n        logit_p11 = logit(p_hat_11)\n        logit_p10 = logit(p_hat_10)\n        logit_p01 = logit(p_hat_01)\n        logit_p00 = logit(p_hat_00)\n\n        # 2. Compute the interaction coefficient beta_hat_AB from the saturated model\n        # This also serves as the odds-scale epistasis measure E_odds\n        beta_hat_AB = logit_p11 - logit_p10 - logit_p01 + logit_p00\n        \n        # 3. Compute E_odds (which must equal beta_hat_AB)\n        E_odds = beta_hat_AB\n\n        # 4. Compute expected modified segregation counts per 16 progeny\n        seg_count_11 = 9 * p_hat_11\n        seg_count_10 = 3 * p_hat_10\n        seg_count_01 = 3 * p_hat_01\n        seg_count_00 = 1 * p_hat_00\n\n        # 5. Assemble the results list for the current test case\n        case_results = [\n            beta_hat_AB,\n            E_odds,\n            seg_count_11,\n            seg_count_10,\n            seg_count_01,\n            seg_count_00\n        ]\n        \n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified.\n    # Each sublist is formatted, then joined by commas, then enclosed in brackets.\n    result_strings = []\n    for res_list in all_results:\n        # Round each number to 6 decimal places and format as a string\n        # f'{x:.6f}' is used for proper zero-padding and rounding.\n        formatted_nums = [f'{x:.6f}' for x in res_list]\n        # Join numbers into a string '[num1,num2,...]' without spaces\n        result_strings.append(f\"[{','.join(formatted_nums)}]\")\n    \n    # Join the individual case strings into the final output '[ [...],[...],[...] ]'\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Print the final, single-line output\n    print(final_output)\n\nsolve()\n```", "id": "2808168"}]}