{"hands_on_practices": [{"introduction": "The stability of any ribonucleic acid (RNA) secondary structure is fundamentally a question of thermodynamics. The nearest-neighbor model is a cornerstone of RNA biophysics, allowing us to predict the folding free energy ($\\Delta G$) of a structure by systematically summing the energy contributions of adjacent base pairs and loops. This practice [@problem_id:2848597] offers a foundational exercise in applying this model, building a quantitative intuition for how a local RNA sequence dictates the energetic feasibility of its folded state.", "problem": "An intramolecular hairpin forms within a messenger ribonucleic acid (mRNA) segment of a longer ribonucleic acid (RNA) molecule at temperature $37^{\\circ}\\mathrm{C}$. The local sequence that folds is\n5'-G C G C A A A U U G C G C-3',\nwhich forms a hairpin with a $5$-nucleotide loop (sequence A A A U U) and a $4$-base-pair Watson–Crick stem in which the $5'$ arm is G C G C and the $3'$ arm is its reverse complement G C G C. Assume there are no noncanonical pairs, no dangling ends, and no tertiary interactions.\n\nUse the thermodynamic nearest-neighbor additivity model for RNA secondary structure at $37^{\\circ}\\mathrm{C}$, where the folding free energy change $\\Delta G_{37}$ is the sum of:\n- Base-pair stacking contributions for each adjacent pair of base pairs along the stem, using the following Watson–Crick nearest-neighbor free energies (in kcal/mol):\n  - GC/CG: $\\Delta G_{37} = -3.40$\n  - CG/GC: $\\Delta G_{37} = -2.40$\n- A hairpin loop initiation penalty that depends only on loop length (in kcal/mol):\n  - Loop length $5$: $\\Delta G_{37} = +5.60$\n- A terminal penalty at an external helix end for each terminal AU or GU base pair (in kcal/mol):\n  - AU or GU at a helix end: $\\Delta G_{37} = +0.45$ per such terminal pair\n  - GC at a helix end: $\\Delta G_{37} = 0.00$\n\nNo additional bonuses or penalties apply.\n\nCompute the total folding free energy change $\\Delta G_{37}$ (in kcal/mol) for this hairpin. Round your answer to three significant figures. Express the final energy in kcal/mol.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and internally consistent. It presents a standard biophysical calculation based on the established nearest-neighbor model for ribonucleic acid (RNA) secondary structure. All necessary parameters are provided.\n\nThe objective is to compute the total folding free energy change, $\\Delta G_{37}$, for the formation of a specified intramolecular hairpin structure. According to the thermodynamic nearest-neighbor additivity model provided, the total free energy change is the sum of contributions from base-pair stacking, loop initiation, and terminal penalties.\nThe governing equation is:\n$$\n\\Delta G_{37, \\text{total}} = \\Delta G_{\\text{stacking}} + \\Delta G_{\\text{loop}} + \\Delta G_{\\text{terminal}}\n$$\n\nFirst, we must meticulously dissect the structure of the hairpin formed by the sequence $5'$-G C G C A A A U U G C G C-$3'$. The problem states this forms a hairpin with a $4$-base-pair stem and a $5$-nucleotide loop. The $5'$ arm of the stem is the sequence $5'$-G C G C-$3'$, and the $3'$ arm is its reverse complement, $5'$-G C G C-$3'$. In the full sequence, $5'$-G$_1$C$_2$G$_3$C$_4$A$_5$A$_6$A$_7$U$_8$U$_9$G$_{10}$C$_{11}$G$_{12}$C$_{13}$-$3'$, this corresponds to the pairing of the $5'$ segment G$_1$C$_2$G$_3$C$_4$ with the $3'$ segment G$_{10}$C$_{11}$G$_{12}$C$_{13}$. Specifically, the Watson-Crick pairs are G$_1$-C$_{13}$, C$_2$-G$_{12}$, G$_3$-C$_{11}$, and C$_4$-G$_{10}$. The nucleotides between the paired segments, A$_5$A$_6$A$_7$U$_8$U$_9$, form the $5$-nucleotide loop.\n\nWith the structure defined, we calculate each energy contribution.\n\n$1$. $\\Delta G_{\\text{stacking}}$: The stacking free energy is the sum of contributions from adjacent base pairs in the stem. There are $n-1 = 4-1 = 3$ such stacking interactions. We identify them from the external end of the helix towards the loop:\n- The first stack is between the pair G$_1$-C$_{13}$ and C$_2$-G$_{12}$. This corresponds to a $5'$-GC-$3'$ dinucleotide on one strand stacked over a $3'$-CG-$5'$ dinucleotide on the other. This is a GC/CG stack. The provided free energy is $\\Delta G_{37}(\\text{GC/CG}) = -3.40~\\mathrm{kcal/mol}$.\n- The second stack is between the pair C$_2$-G$_{12}$ and G$_3$-C$_{11}$. This corresponds to a $5'$-CG-$3'$ dinucleotide stacked over a $3'$-GC-$5'$ dinucleotide. This is a CG/GC stack. The provided free energy is $\\Delta G_{37}(\\text{CG/GC}) = -2.40~\\mathrm{kcal/mol}$.\n- The third stack is between the pair G$_3$-C$_{11}$ and C$_4$-G$_{10}$. This corresponds to a $5'$-GC-$3'$ dinucleotide stacked over a $3'$-CG-$5'$ dinucleotide. This is another GC/CG stack. The provided free energy is $\\Delta G_{37}(\\text{GC/CG}) = -3.40~\\mathrm{kcal/mol}$.\n\nThe total stacking free energy is the sum of these contributions:\n$$\n\\Delta G_{\\text{stacking}} = (-3.40) + (-2.40) + (-3.40) = -9.20~\\mathrm{kcal/mol}\n$$\n\n$2$. $\\Delta G_{\\text{loop}}$: The hairpin loop initiation penalty depends on the length of the loop. The loop consists of $5$ nucleotides (A$_5$A$_6$A$_7$U$_8$U$_9$). The problem specifies the penalty for a loop of length $5$:\n$$\n\\Delta G_{\\text{loop}} = +5.60~\\mathrm{kcal/mol}\n$$\n\n$3$. $\\Delta G_{\\text{terminal}}$: A penalty is applied for terminal AU or GU pairs at an external helix end. The external end of this hairpin stem is the G$_1$-C$_{13}$ base pair. Since this is a GC pair, the specified penalty is zero.\n$$\n\\Delta G_{\\text{terminal}} = 0.00~\\mathrm{kcal/mol}\n$$\n\nFinally, we sum these components to find the total free energy change for hairpin formation:\n$$\n\\Delta G_{37, \\text{total}} = \\Delta G_{\\text{stacking}} + \\Delta G_{\\text{loop}} + \\Delta G_{\\text{terminal}}\n$$\n$$\n\\Delta G_{37, \\text{total}} = (-9.20) + (5.60) + (0.00) = -3.60~\\mathrm{kcal/mol}\n$$\nThe result, $-3.60$, is already expressed with three significant figures as required. A negative value for $\\Delta G_{37}$ indicates that the formation of this hairpin structure is spontaneous under the specified conditions.", "answer": "$$ \\boxed{-3.60} $$", "id": "2848597"}, {"introduction": "While theoretical models provide a powerful framework, predicting RNA structure in the complex cellular environment is greatly enhanced by incorporating experimental data. This problem introduces a computational approach to integrate data from Selective 2’-Hydroxyl Acylation analyzed by Primer Extension (SHAPE), which measures nucleotide flexibility, into a thermodynamic folding algorithm. By implementing a dynamic programming algorithm that uses SHAPE data as a pseudo-free energy constraint [@problem_id:2848657], you will learn a core technique in bioinformatics for building more accurate, data-informed models of RNA structure.", "problem": "You are to implement a program that integrates Selective 2’-Hydroxyl Acylation analyzed by Primer Extension (SHAPE) reactivity into a simplified thermodynamic model for RNA secondary structure prediction and computes the minimum free energy (MFE) structure under a no-pseudoknot constraint. Your implementation must rely only on the following core definitions and widely accepted rules:\n\n- The Central Dogma of molecular biology and ribonucleic acid (RNA) structure principles imply that single-stranded RNA folds via intramolecular base pairing into secondary structures constrained by complementary interactions and steric feasibility.\n- Canonical Watson–Crick base pairs obey $\\mathrm{A}\\text{-}\\mathrm{U}$ and $\\mathrm{G}\\text{-}\\mathrm{C}$ complementarity; wobble base pairs $\\mathrm{G}\\text{-}\\mathrm{U}$ are allowed. These base pairs are supported by well-established thermodynamic observations.\n- SHAPE reactivity empirically correlates with nucleotide flexibility. A common approach integrates reactivity into a pseudo-free energy term that penalizes pairing at highly reactive positions. For each nucleotide at position $i$, define the pseudo-free energy when paired as\n$$\n\\Delta G_{\\mathrm{SHAPE}}(i) = m \\cdot r_i + b,\n$$\nwhere $r_i$ is the SHAPE reactivity, $m$ is a slope, and $b$ is an intercept. Units for energy are $\\mathrm{kcal/mol}$.\n\nYou must use the following simplified, explicit thermodynamic model:\n\n- Allowed base pairs and their base-pair energies $E_{\\mathrm{bp}}$ in $\\mathrm{kcal/mol}$:\n  - $\\mathrm{A}\\text{-}\\mathrm{U}$ and $\\mathrm{U}\\text{-}\\mathrm{A}$: $-2.0$,\n  - $\\mathrm{G}\\text{-}\\mathrm{C}$ and $\\mathrm{C}\\text{-}\\mathrm{G}$: $-3.0$,\n  - $\\mathrm{G}\\text{-}\\mathrm{U}$ and $\\mathrm{U}\\text{-}\\mathrm{G}$: $-1.0$.\n- Hairpin loop length constraint: a pair $(i,j)$ can form only if $j - i - 1 \\ge L$, with $L = 3$.\n- No pseudoknots are allowed.\n- Energy additivity: the total free energy of a valid secondary structure is the sum over all formed base pairs of\n$$\nE_{\\text{pair}}(i,j) = E_{\\mathrm{bp}}(\\text{pair}(i,j)) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j),\n$$\nand unpaired nucleotides contribute $0$ energy. Express energies in $\\mathrm{kcal/mol}$.\n- Objective: minimize the total free energy under the above constraints.\n\nDynamic programming specification to be implemented:\n\n- Let $n$ be the length of the sequence. For subsequences indexed inclusively, define $E[i,j]$ for $0 \\le i \\le j \\le n-1$ as the minimal achievable energy on the interval $[i,j]$.\n- Boundary conditions: $E[i,j] = 0$ when $i \\ge j$.\n- Recurrence for $i < j$:\n  - Unpaired options:\n    - Leave $i$ unpaired: $E[i,j] \\leftarrow \\min\\left(E[i,j], E[i+1,j]\\right)$,\n    - Leave $j$ unpaired: $E[i,j] \\leftarrow \\min\\left(E[i,j], E[i,j-1]\\right)$.\n  - Pairing option if allowed: if nucleotides at $(i,j)$ can form an allowed pair and $j - i - 1 \\ge L$, then\n    $$\n    E[i,j] \\leftarrow \\min\\left(E[i,j], E[i+1,j-1] + E_{\\mathrm{bp}}(i,j) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j)\\right).\n    $$\n  - Bifurcation (concatenation) over $k$ with $i \\le k < j$:\n    $$\n    E[i,j] \\leftarrow \\min\\left(E[i,j], E[i,k] + E[k+1,j]\\right).\n    $$\n\nBacktracking must reconstruct one optimal structure consistent with the minimal energy. Represent the structure as a list of length $n$, where the element at index $p$ is the $1$-based index of the nucleotide paired with position $p+1$. If position $p+1$ is unpaired, store $0$ at index $p$. For example, the structure for $n=4$ with pairs $(1,4)$ and unpaired $(2,3)$ is $[4,0,0,1]$.\n\nAngle units are not applicable. Energies must be interpreted in $\\mathrm{kcal/mol}$ as specified. The output, however, is the integer partner-index representation and therefore unitless.\n\nTest suite to implement inside the program (no user input). For each case, use the given RNA sequence, SHAPE reactivities $r_i$, and $(m,b)$:\n\n- Case $1$ (general happy path):\n  - Sequence: \"GCGAAUUGCGCU\".\n  - Reactivities: $[0.10, 0.20, 0.15, 1.20, 1.00, 0.90, 0.85, 1.10, 0.25, 0.15, 0.20, 0.10]$.\n  - Parameters: $m = 1.8$, $b = -0.6$.\n- Case $2$ (boundary: all reactivities zero, pairing strongly favored by negative intercept):\n  - Sequence: \"AUGCUAGC\".\n  - Reactivities: $[0,0,0,0,0,0,0,0]$.\n  - Parameters: $m = 1.8$, $b = -0.6$.\n- Case $3$ (edge: no allowed pairs due to homopolymer of $\\mathrm{A}$):\n  - Sequence: \"AAAAAA\".\n  - Reactivities: $[0.5, 0.7, 0.9, 0.1, 0.2, 0.3]$.\n  - Parameters: $m = 1.0$, $b = 0.0$.\n- Case $4$ (edge: sequence too short to satisfy hairpin constraint with $L=3$):\n  - Sequence: \"GCUG\".\n  - Reactivities: $[0.9, 0.2, 1.1, 0.3]$.\n  - Parameters: $m = 1.8$, $b = -0.6$.\n\nFinal Output Format:\n\n- For each test case, compute the MFE partner-index list of integers (length $n$) using $1$-based indices for partners and $0$ for unpaired positions.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result is itself a bracketed list of integers. For example: \"[[4,0,0,1],[...],[...],[...]]\".", "solution": "The problem statement is evaluated and found to be valid. It describes a simplified, yet scientifically grounded, computational problem in bioinformatics: predicting an RNA secondary structure that minimizes a pseudo-free energy function. The model incorporates empirical SHAPE data, a standard technique, and relies on a well-defined dynamic programming approach to find the Minimum Free Energy (MFE) structure under a no-pseudoknot constraint. The problem is well-posed, objective, and contains all necessary information for a unique solution to be computed.\n\nThe core of the solution is a dynamic programming algorithm based on the principles of the Nussinov-Jacobson or Zuker algorithms. Let $n$ be the length of the RNA sequence. We define $E[i,j]$ as the minimum free energy for the subsequence from index $i$ to $j$, inclusive, for $0 \\le i \\le j < n$. The goal is to compute $E[0, n-1]$.\n\nThe provided recurrence relation is:\n$$\nE[i,j] = \\min \\begin{cases}\nE[i+1, j] \\\\\nE[i, j-1] \\\\\nE[i+1, j-1] + E_{\\text{pair}}(i,j) \\\\\n\\min_{i \\le k < j} (E[i,k] + E[k+1,j])\n\\end{cases}\n$$\nA critical analysis reveals that the first two terms, representing unpaired nucleotides at the ends, are redundant. The bifurcation term, $\\min_{i \\le k < j} (E[i,k] + E[k+1,j])$, inherently includes these cases. Specifically, when $k=i$, the term becomes $E[i,i] + E[i+1,j]$. Since $E[i,i]=0$ (the energy of an empty subsequence), this simplifies to $E[i+1,j]$, which is the case of leaving nucleotide $i$ unpaired. Similarly, when $k=j-1$, the term becomes $E[i,j-1] + E[j,j] = E[i,j-1]$, covering the case where $j$ is unpaired.\n\nTherefore, for a more efficient and elegant implementation, the recurrence is consolidated into two fundamental cases for the structure on the interval $[i,j]$:\n1.  Nucleotides $i$ and $j$ form a base pair. This is only possible if they are complementary ($\\mathrm{A}\\text{-}\\mathrm{U}$, $\\mathrm{G}\\text{-}\\mathrm{C}$, or $\\mathrm{G}\\text{-}\\mathrm{U}$) and satisfy the minimum loop length constraint $j - i - 1 \\ge L$, where $L=3$. The energy is the sum of the intrinsic base pair energy, the SHAPE-derived pseudo-energies for both nucleotides, and the MFE of the enclosed subsequence $[i+1,j-1]$.\n    $$ E_{1} = E[i+1, j-1] + E_{\\mathrm{bp}}(i,j) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j) $$\n2.  The structure on $[i,j]$ is a concatenation of two independent substructures on $[i,k]$ and $[k+1,j]$ for some split point $k$ where $i \\le k < j$. The total energy is the sum of the energies of the two substructures. The algorithm must find the split point $k$ that minimizes this sum.\n    $$ E_{2} = \\min_{i \\le k < j} (E[i,k] + E[k+1,j]) $$\n\nThe final energy $E[i,j]$ is the minimum of these possibilities: $E[i,j] = \\min(E_1, E_2)$, considering $E_1$ only when pairing is allowed.\n\nThe algorithm proceeds as follows:\nFirst, the SHAPE pseudo-free energy contributions, $\\Delta G_{\\mathrm{SHAPE}}(p) = m \\cdot r_p + b$, are pre-calculated for each nucleotide $p$ in the sequence.\n\nA $2$-dimensional matrix $E$ of size $n \\times n$ is initialized. The base cases are $E[i,j] = 0$ for all $i \\ge j$. The matrix is filled for increasing subsequence lengths $d=j-i$, from $d=1$ to $d=n-1$. This ensures that when computing $E[i,j]$, the energies for all smaller subsequences it depends on have already been computed.\n\nTo reconstruct the optimal structure, a second matrix, `trace`, of the same dimensions is used. `trace`$[i,j]$ stores which choice led to the minimum energy for $E[i,j]$. A special value (e.g., $-1$) indicates that the minimum was achieved by pairing $(i,j)$. Otherwise, `trace`$[i,j]$ stores the optimal split point $k$ from the bifurcation case.\n\nAfter the $E$ and `trace` matrices are fully populated, a recursive backtracking function is initiated, starting from `backtrack(0, n-1)`. This function traverses the `trace` matrix to rebuild the set of base pairs that constitute one of the MFE structures. If `trace`$[i,j]$ indicates a pair, the pair $(i,j)$ is recorded, and the function recurses on the enclosed interval, `backtrack(i+1, j-1)`. If it indicates a bifurcation at $k$, the function recurses on the two independent sub-intervals, `backtrack(i, k)` and `backtrack(k+1, j)`.\n\nThe final result is stored in an array of length $n$, where each position holds the $1$-based index of its partner or $0$ if it is unpaired. This process is systematically applied to each test case provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the specified test cases for RNA MFE structure prediction.\n    \"\"\"\n    test_cases = [\n        (\"GCGAAUUGCGCU\", [0.10, 0.20, 0.15, 1.20, 1.00, 0.90, 0.85, 1.10, 0.25, 0.15, 0.20, 0.10], (1.8, -0.6)),\n        (\"AUGCUAGC\", [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], (1.8, -0.6)),\n        (\"AAAAAA\", [0.5, 0.7, 0.9, 0.1, 0.2, 0.3], (1.0, 0.0)),\n        (\"GCUG\", [0.9, 0.2, 1.1, 0.3], (1.8, -0.6)),\n    ]\n\n    results = []\n    for case in test_cases:\n        seq, reactivities, params = case\n        result = compute_mfe_structure(seq, reactivities, params)\n        results.append(result)\n\n    def list_to_str(lst):\n        return f\"[{','.join(map(str, lst))}]\"\n\n    formatted_results = ','.join(map(list_to_str, results))\n    print(f\"[{formatted_results}]\")\n\ndef compute_mfe_structure(sequence, reactivities, params):\n    \"\"\"\n    Computes the Minimum Free Energy (MFE) secondary structure of an RNA sequence\n    using a simplified thermodynamic model with SHAPE data.\n    \"\"\"\n    n = len(sequence)\n    m, b = params\n    L = 3  # Minimum hairpin loop length\n\n    base_pair_energies = {\n        frozenset({'A', 'U'}): -2.0,\n        frozenset({'G', 'C'}): -3.0,\n        frozenset({'G', 'U'}): -1.0,\n    }\n\n    def can_pair(b1, b2):\n        return frozenset({b1, b2}) in base_pair_energies\n\n    def get_pair_energy(b1, b2):\n        return base_pair_energies.get(frozenset({b1, b2}), float('inf'))\n\n    delta_g_shape = np.array([m * r + b for r in reactivities])\n\n    E = np.full((n, n), float('inf'))\n    trace = np.zeros((n, n), dtype=int)\n\n    for i in range(n):\n        E[i, i] = 0\n    for i in range(n - 1):\n        E[i + 1, i] = 0\n\n    for d in range(1, n):  # d = j - i\n        for i in range(n - d):\n            j = i + d\n\n            # Option 1: Bifurcation (covers unpaired ends via k=i or k=j-1)\n            min_bifurcation_energy = float('inf')\n            best_k = -1\n            for k in range(i, j):\n                energy = E[i, k] + E[k + 1, j]\n                if energy < min_bifurcation_energy:\n                    min_bifurcation_energy = energy\n                    best_k = k\n            \n            E[i, j] = min_bifurcation_energy\n            trace[i, j] = best_k\n\n            # Option 2: Nucleotides i and j form a pair\n            if can_pair(sequence[i], sequence[j]) and j - i - 1 >= L:\n                pair_energy_term = get_pair_energy(sequence[i], sequence[j]) \\\n                                 + delta_g_shape[i] + delta_g_shape[j]\n                \n                total_pair_energy = E[i + 1, j - 1] + pair_energy_term\n                \n                if total_pair_energy < E[i, j]:\n                    E[i, j] = total_pair_energy\n                    trace[i, j] = -1  # Special value indicates pairing\n\n    partners = [0] * n\n    \n    # Using a stack for non-recursive backtracking to avoid recursion depth limits\n    # on potentially long sequences, though not an issue for these test cases.\n    stack = [(0, n - 1)]\n    while stack:\n        i, j = stack.pop()\n        \n        if i >= j:\n            continue\n            \n        trace_val = trace[i, j]\n        \n        if trace_val == -1:  # (i, j) form a pair\n            partners[i] = j + 1\n            partners[j] = i + 1\n            stack.append((i + 1, j - 1))\n        else:  # Bifurcation at k\n            k = trace_val\n            stack.append((i, k))\n            stack.append((k + 1, j))\n\n    return partners\n\nsolve()\n```", "id": "2848657"}, {"introduction": "The life of an mRNA molecule is tightly regulated by quality control mechanisms that ensure the fidelity of gene expression. This practice explores Nonsense-Mediated Decay (NMD), a critical surveillance pathway that identifies and degrades mRNAs containing premature termination codons. By constructing a quantitative model based on the positions of Exon Junction Complexes (EJCs) relative to a stop codon [@problem_id:2848618], you will gain a deeper, systems-level understanding of how molecular events like splicing and translation are integrated to safeguard cellular function.", "problem": "A messenger ribonucleic acid (mRNA) in a eukaryote is produced by transcription and splicing. After exon ligation, Exon Junction Complexes (EJCs) are deposited a characteristic distance upstream of each exon–exon junction. During the pioneer round of translation, ribosomes remove EJCs that they traverse. Nonsense-Mediated Decay (NMD) is a translation-dependent quality-control pathway that is triggered when translation terminates prematurely while at least one downstream EJC remains sufficiently far from the terminating ribosome to enable productive interaction between the termination Surveillance Complex (often termed the SURF complex, containing Up-frameshift protein 1 (UPF1) and Eukaryotic Release Factors (eRF1 and eRF3)) and the EJC (via UPF2 and UPF3), rather than being suppressed by Poly(A)-Binding Protein Cytoplasmic 1 (PABPC1) near a normal stop codon.\n\nAssume the following empirically supported features and simplifications:\n- EJCs are deposited exactly $e$ nucleotides upstream of each exon–exon junction and are removed by any translating ribosome that passes through them.\n- NMD is triggered if and only if, at premature termination position $x$ (measured in nucleotides from the start codon along the coding sequence), there exists at least one downstream EJC whose position is at least $s$ nucleotides downstream of $x$. Ignore EJC-independent NMD and any effects of three-prime untranslated region length beyond this criterion.\n- Conditional on a nonsense mutation occurring in the coding sequence, its position $x$ is uniformly distributed on the interval $\\left[0, L\\right)$, where $L$ is the coding sequence length in nucleotides.\n\nConsider a single mRNA whose coding sequence spans $E=4$ exons of lengths $l_{1}=300$, $l_{2}=600$, $l_{3}=450$, and $l_{4}=654$ nucleotides, respectively, in this order from the start codon. Let the EJC deposition offset be $e=24$ nucleotides upstream of each junction, and let the minimal separation required to trigger NMD be $s=50$ nucleotides. Let $L=\\sum_{i=1}^{E} l_{i}$.\n\nStarting from the Central Dogma (deoxyribonucleic acid to ribonucleic acid to protein), the definition of splicing-coupled EJC deposition and ribosome-mediated EJC removal, and the definition of NMD as termination in the presence of a sufficiently separated downstream EJC, do the following:\n1. Derive, from first principles given above, a condition on $x$ that determines whether NMD is triggered in terms of the locations of downstream EJCs. Show that this condition reduces to a single inequality involving only the EJC deposited at the last exon–exon junction.\n2. Using that condition, derive a closed-form expression for the probability that a uniformly random premature termination (as defined above) triggers NMD, as a function of $\\{l_{i}\\}_{i=1}^{E}$, $e$, $s$, and $L$.\n3. Evaluate this probability numerically for the specified exon–intron architecture and parameters. Round your final numerical answer to four significant figures and express it as a decimal in the interval $\\left[0,1\\right]$.", "solution": "The problem presented is a quantitative exercise in molecular biology, grounded in the established mechanisms of gene expression and RNA surveillance, specifically Nonsense-Mediated Decay (NMD). The problem is self-contained, scientifically sound within its defined model, and mathematically well-posed. It requires the application of basic probability theory to a simplified but realistic biological scenario. Therefore, the problem is valid, and we proceed with a rigorous derivation.\n\nFirst, we establish a coordinate system for the messenger ribonucleic acid (mRNA) coding sequence (CDS). Let the start codon correspond to position $0$ and the end of the CDS be at position $L$. The position of a premature termination codon (PTC), denoted by $x$, is a point within the interval $\\left[0, L\\right)$. The total length of the CDS is the sum of the lengths of its $E$ exons:\n$$L = \\sum_{i=1}^{E} l_{i}$$\n\nThe transcript has $E-1$ exon–exon junctions. The position of the $k$-th junction, $P_{J_k}$, which separates exon $k$ from exon $k+1$, is located at the cumulative length of the preceding exons:\n$$P_{J_k} = \\sum_{i=1}^{k} l_{i}$$\nwhere $k \\in \\{1, 2, \\dots, E-1\\}$.\n\nAccording to the problem statement, an Exon Junction Complex (EJC) is deposited a distance $e$ upstream of each junction. The position of the EJC associated with the $k$-th junction, $P_{\\text{EJC}_k}$, is therefore:\n$$P_{\\text{EJC}_k} = P_{J_k} - e = \\left(\\sum_{i=1}^{k} l_{i}\\right) - e$$\n\nThe NMD pathway is triggered if a ribosome terminates translation at a PTC at position $x$, and at least one EJC remains downstream, sufficiently far from the termination site. During translation, the ribosome removes all EJCs it traverses. Thus, for a PTC at position $x$, the set of remaining EJCs are those for which $P_{\\text{EJC}_k} > x$. The condition for NMD triggering states that for at least one of these remaining EJCs, its distance from the PTC must be at least $s$. This can be formulated as follows:\nNMD is triggered if and only if there exists a $k \\in \\{1, 2, \\dots, E-1\\}$ such that two conditions are met:\n1. The EJC is downstream of the PTC: $P_{\\text{EJC}_k} > x$.\n2. The separation between the EJC and the PTC is sufficient: $P_{\\text{EJC}_k} - x \\ge s$.\n\nThe second condition, $x \\le P_{\\text{EJC}_k} - s$, is more restrictive and implies the first, provided that $s > 0$. Since $s=50$, this is the case. Therefore, the overall condition for NMD triggering simplifies to the existence of an index $k$ such that:\n$$x \\le P_{\\text{EJC}_k} - s$$\n\nThis means that NMD is triggered if the PTC position $x$ is less than or equal to at least one of the values in the set $\\{P_{\\text{EJC}_1} - s, P_{\\text{EJC}_2} - s, \\dots, P_{\\text{EJC}_{E-1}} - s\\}$. This is a logical OR condition. If a number is less than or equal to at least one value in a set, it must be less than or equal to the maximum value in that set. Thus, the condition is equivalent to:\n$$x \\le \\max_{k \\in \\{1, \\dots, E-1\\}} \\left( P_{\\text{EJC}_k} - s \\right)$$\n\nThe exon lengths $l_i$ are all positive. Consequently, the junction positions $P_{J_k}$ are strictly increasing with $k$. This implies that the EJC positions $P_{\\text{EJC}_k} = P_{J_k} - e$ are also strictly increasing with $k$. Therefore, the maximum value in the set corresponds to the largest index, $k = E-1$. This is the EJC deposited at the last exon–exon junction. The condition for NMD triggering reduces to a single inequality:\n$$x \\le P_{\\text{EJC}_{E-1}} - s$$\nThis completes the first part of the derivation. The PTC must occur at or before a position $s$ nucleotides upstream of the final EJC.\n\nFor the second part, we derive a closed-form expression for the probability of NMD. The position of the PTC, $x$, is a random variable uniformly distributed on the interval $\\left[0, L\\right)$. The probability of an event for a uniform distribution is the ratio of the length of the favorable region to the length of the total sample space.\n\nThe favorable region consists of all positions $x$ that trigger NMD. This is the interval of $x$ values satisfying $x \\le P_{\\text{EJC}_{E-1}} - s$. Since $x$ cannot be negative (as it is a position), the NMD-sensitive region is $\\left[0, x_{\\text{NMD}}\\right]$, where:\n$$x_{\\text{NMD}} = P_{\\text{EJC}_{E-1}} - s = \\left(\\left(\\sum_{i=1}^{E-1} l_i\\right) - e\\right) - s$$\nThe length of this favorable region is $x_{\\text{NMD}}$. The total length of the sample space is $L$. The probability, $P(\\text{NMD})$, is therefore:\n$$P(\\text{NMD}) = \\frac{x_{\\text{NMD}}}{L} = \\frac{\\left(\\sum_{i=1}^{E-1} l_i\\right) - e - s}{L}$$\nSubstituting $L = \\sum_{i=1}^{E} l_i$, we obtain the closed-form expression:\n$$P(\\text{NMD}) = \\frac{\\left(\\sum_{i=1}^{E-1} l_i\\right) - e - s}{\\sum_{i=1}^{E} l_i}$$\nThis expression is a function of the exon lengths $\\{l_i\\}$, the EJC offset $e$, the NMD separation distance $s$, and the total CDS length $L$ (which is dependent on $\\{l_i\\}$). This completes the second part.\n\nFor the third part, we evaluate this probability using the given numerical values:\n$E=4$, $l_1=300$, $l_2=600$, $l_3=450$, $l_4=654$.\n$e=24$.\n$s=50$.\n\nFirst, we calculate the sum of the lengths of the first $E-1=3$ exons:\n$$\\sum_{i=1}^{3} l_i = l_1 + l_2 + l_3 = 300 + 600 + 450 = 1350$$\nThis corresponds to the position of the last junction, $P_{J_3}$. The position of the final EJC is $P_{\\text{EJC}_3} = 1350 - e = 1350 - 24 = 1326$. The upper bound for an NMD-triggering PTC is $x_{\\text{NMD}} = P_{\\text{EJC}_3} - s = 1326 - 50 = 1276$. So, any PTC in the interval $\\left[0, 1276\\right]$ will trigger NMD.\n\nNext, we calculate the total CDS length, $L$:\n$$L = \\sum_{i=1}^{4} l_i = (l_1+l_2+l_3) + l_4 = 1350 + 654 = 2004$$\n\nThe probability is the ratio of the length of the NMD-sensitive region to the total CDS length:\n$$P(\\text{NMD}) = \\frac{x_{\\text{NMD}}}{L} = \\frac{1276}{2004}$$\n\nNow, we compute the numerical value and round to four significant figures:\n$$P(\\text{NMD}) = \\frac{1276}{2004} \\approx 0.6367265469...$$\nRounding to four significant figures gives $0.6367$. This represents the probability that a randomly occurring nonsense mutation in this specific gene's coding sequence will lead to the degradation of its mRNA via the NMD pathway.", "answer": "$$ \\boxed{0.6367} $$", "id": "2848618"}]}