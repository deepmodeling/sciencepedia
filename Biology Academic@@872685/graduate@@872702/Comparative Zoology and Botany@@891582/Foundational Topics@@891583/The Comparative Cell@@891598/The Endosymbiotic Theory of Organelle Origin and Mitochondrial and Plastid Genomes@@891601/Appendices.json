{"hands_on_practices": [{"introduction": "Understanding the endosymbiotic theory begins with visualizing the physical process of one cell engulfing another. This exercise is a fundamental thought experiment that challenges you to trace the fate of cellular membranes through successive rounds of endosymbiosis. By applying the principles of phagocytosis to a sequence of primary, secondary, and tertiary events, you can predict the theoretical number of membranes surrounding a \"complex\" plastid and reason about why real-world examples often deviate from this maximum [@problem_id:2616619]. This practice hones your ability to build a robust mental model of a complex cellular process from first principles.", "problem": "A eukaryotic lineage acquires photosynthesis through serial endosymbioses. Start from the following widely accepted facts and definitions:\n\n- Many bacteria, including cyanobacteria, are Gram-negative, with a cell envelope comprising two lipid bilayers (an inner and an outer membrane) separated by a peptidoglycan layer. The peptidoglycan layer is not a membrane.\n- Eukaryotic cells are bounded by a single plasma membrane.\n- During phagocytosis, a eukaryotic host engulfs a prey cell, enclosing it within a vesicle whose boundary is derived from the host plasma membrane; this vesicle boundary is termed the phagosomal membrane.\n- If an engulfed symbiont persists and is retained, membranes can be retained, lost, or structurally fused with host endomembranes such as the Endoplasmic Reticulum (ER). Membrane loss can occur by degradation, and fusion can yield continuous bilayers integrated into the host endomembrane system.\n\nConsider a lineage that first acquired a primary plastid from a cyanobacterium, then underwent a secondary endosymbiosis in which a eukaryotic alga bearing a primary plastid was engulfed, and finally a tertiary endosymbiosis in which a eukaryote bearing a secondary plastid was engulfed. Assume initially that all membranes formed at each step are retained, with no loss or fusion, and then reason about real-world deviations.\n\nWhich option best states the expected number of plastid-surrounding membranes after primary, secondary, and tertiary endosymbioses under full retention, and correctly rationalizes how observed exceptions with fewer membranes arise in nature?\n\nA. Expected counts are $2$, $3$, and $4$, respectively, because each endosymbiotic event adds $+1$ membrane. Deviations arise primarily from genome reduction, which directly reduces membrane number without structural changes.\n\nB. Expected counts are $2$, $4$, and $6$, respectively, because each endosymbiotic event can add the prey plasma membrane and a host-derived phagosomal membrane (total $+2$ per event). Deviations with $3$–$5$ membranes arise via selective membrane loss (for example, loss of the endosymbiont plasma membrane) or membrane fusion (for example, conversion of the outermost phagosomal membrane into a plastid-associated ER membrane continuous with host endomembranes).\n\nC. Expected counts are $3$, $5$, and $7$, respectively, because the peptidoglycan layer of cyanobacteria counts as a membrane and is retained. Deviations occur when peptidoglycan is degraded, reducing the count by $-1$ at any stage.\n\nD. Expected counts are $2$, $5$, and $7$, respectively, because the endosymbiont’s nuclear envelope contributes two membranes to the plastid at the secondary stage. Deviations occur when the nuclear envelope is lost, yielding $3$ membranes at secondary endosymbiosis.\n\nE. Expected counts are $2$, $4$, and $5$, respectively, because tertiary endosymbiosis adds only the prey plasma membrane ($+1$) while the host phagosomal membrane never persists. Deviations arise solely from gene transfer to the host nucleus, which removes membranes associated with protein import complexes.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n### Step 1: Extract Givens\n-   Gram-negative bacteria (e.g., cyanobacteria) possess two lipid bilayers (inner and outer membranes) and a peptidoglycan layer, which is not a membrane.\n-   Eukaryotic cells possess a single plasma membrane.\n-   Phagocytosis results in a prey cell being enclosed in a host-derived phagosomal membrane.\n-   Following endosymbiosis, membranes can be retained, lost, or fused with the host endomembrane system (e.g., Endoplasmic Reticulum, ER).\n-   A sequence of three endosymbiotic events occurs:\n    1.  **Primary:** A eukaryote engulfs a cyanobacterium.\n    2.  **Secondary:** A different eukaryote engulfs the product of the primary endosymbiosis (a eukaryotic alga).\n    3.  **Tertiary:** A third eukaryote engulfs the product of the secondary endosymbiosis.\n-   The initial calculation must assume full retention of all membranes formed at each step.\n-   The question asks for the theoretical number of membranes surrounding the plastid after each of the three stages, assuming full retention, and the correct biological explanation for observed deviations where fewer membranes are present.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n\n-   **Scientific Grounding**: The problem is based on the endosymbiotic theory, a fundamental and well-established principle in evolutionary biology. The descriptions of bacterial and eukaryotic cell structures, as well as the process of phagocytosis, are accurate representations of core concepts in cell biology. The concepts of primary, secondary, and tertiary endosymbiosis, along with subsequent membrane loss or modification, are central to the study of plastid evolution. The problem is scientifically grounded.\n-   **Well-Posedness**: The problem defines a clear, step-by-step hypothetical process (sequential endosymbioses with an initial assumption of full membrane retention). It asks for a quantitative prediction based on this process and a qualitative explanation for real-world deviations. This structure allows for a unique, logical, and meaningful solution. The problem is well-posed.\n-   **Objectivity**: The problem uses precise, standard scientific terminology and is free from subjective or ambiguous language. The premises are presented as \"widely accepted facts,\" which is appropriate for this domain. The problem is objective.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A solution will be derived.\n\n### Solution Derivation\n\nThe number of membranes surrounding the plastid at each stage will be calculated under the assumption of full membrane retention, followed by an analysis of the provided options. The starting point for this calculation is the structure of the entities involved.\n\n-   A cyanobacterium has $2$ membranes (inner and outer).\n-   A eukaryotic host has $1$ plasma membrane.\n\n**Stage 1: Primary Endosymbiosis**\nA eukaryotic host engulfs a cyanobacterium. During phagocytosis, the host's plasma membrane envelops the cyanobacterium, forming a phagosomal membrane. Therefore, the engulfed cyanobacterium would initially be surrounded by $3$ membranes: its own inner and outer membranes, and the host's phagosomal membrane.\nHowever, it is a universally accepted fact in biology that the resulting primary plastids in the Archaeplastida (red algae, green algae, and land plants) possess only $2$ membranes. These correspond to the original inner and outer membranes of the ancestral cyanobacterium. This implies that the outermost, host-derived phagosomal membrane was lost early in the evolution of primary plastids.\nThe options provided, with four out of five starting with a count of $2$, strongly indicate that the problem expects the use of this established biological outcome for the primary plastid as the baseline, rather than the transient $3$-membrane state. The instruction \"assume initially that all membranes... are retained\" is best interpreted as applying to the subsequent secondary and tertiary events, starting from the stable $2$-membrane primary plastid.\nTherefore, the number of membranes after primary endosymbiosis is taken to be $2$.\n$$N_{\\text{primary}} = 2$$\n\n**Stage 2: Secondary Endosymbiosis**\nA new eukaryotic host engulfs a eukaryotic alga that already contains a $2$-membrane primary plastid.\n1.  The prey is the entire algal cell. The plastid within is surrounded by its $2$ membranes.\n2.  The algal cell itself is bounded by its own plasma membrane ($1$ membrane).\n3.  The new host engulfs the alga via phagocytosis, enclosing it within a new phagosomal membrane ($1$ membrane).\nUnder the assumption of full retention, the total number of membranes surrounding the plastid is the sum of the plastid's own membranes, the algal plasma membrane, and the new host's phagosomal membrane.\n$$N_{\\text{secondary}} = N_{\\text{primary}} + (\\text{algal plasma membrane}) + (\\text{host phagosomal membrane})$$\n$$N_{\\text{secondary}} = 2 + 1 + 1 = 4$$\n\n**Stage 3: Tertiary Endosymbiosis**\nA new eukaryotic host engulfs a eukaryotic alga that contains a $4$-membrane secondary plastid.\n1.  The prey is the secondary alga. The plastid within is now surrounded by $4$ membranes.\n2.  This secondary alga is bounded by its own plasma membrane ($1$ membrane).\n3.  The tertiary host engulfs this alga, enclosing it in a new phagosomal membrane ($1$ membrane).\nThe total number of membranes surrounding the plastid is:\n$$N_{\\text{tertiary}} = N_{\\text{secondary}} + (\\text{algal plasma membrane}) + (\\text{host phagosomal membrane})$$\n$$N_{\\text{tertiary}} = 4 + 1 + 1 = 6$$\n\nThus, the expected sequence of membrane counts under the specified model is $2$, $4$, and $6$.\n\nNow, we must consider the reasons for deviations, where fewer membranes are observed in nature. Plastids originating from secondary endosymbiosis are known to have $4$ or $3$ membranes. Plastids from tertiary endosymbiosis also show reductions. These reductions are achieved by the loss of one or more membranes. For example, loss of the outermost phagosomal membrane would reduce the count from $4$ to $3$ in a secondary plastid. Another known modification is the fusion of the outermost membrane with the host's ER, making it a \"plastid-ER\" or \"chloroplast-ER\" (CER). This membrane is still present but is integrated into the host endomembrane system.\n\n### Option-by-Option Analysis\n\n**A. Expected counts are $2$, $3$, and $4$, respectively, because each endosymbiotic event adds $+1$ membrane. Deviations arise primarily from genome reduction, which directly reduces membrane number without structural changes.**\n-   The expected counts ($2$, $3$, $4$) are incorrect. The calculation shows the counts should be $2$, $4$, and $6$. A secondary or tertiary endosymbiosis, involving the engulfment of a whole eukaryotic cell, adds two membranes around the pre-existing plastid (the prey's plasma membrane and the host's phagosome).\n-   The explanation for deviations is incorrect. Genome reduction (gene transfer to the host nucleus) is a process related to organelle integration, but it does not directly cause the physical elimination of a lipid bilayer. Membrane loss is a separate, structural event.\n-   **Verdict: Incorrect.**\n\n**B. Expected counts are $2$, $4$, and $6$, respectively, because each endosymbiotic event can add the prey plasma membrane and a host-derived phagosomal membrane (total $+2$ per event). Deviations with $3$–$5$ membranes arise via selective membrane loss (for example, loss of the endosymbiont plasma membrane) or membrane fusion (for example, conversion of the outermost phagosomal membrane into a plastid-associated ER membrane continuous with host endomembranes).**\n-   The expected counts ($2$, $4$, $6$) match our derivation precisely.\n-   The reasoning for the counts is also correct: each subsequent endosymbiotic event (secondary, tertiary) involves engulfing a eukaryotic cell, thus adding its plasma membrane ($+1$) and a new phagosomal membrane ($+1$), for a total increase of $2$ membranes around the existing plastid.\n-   The explanation for deviations is biologically accurate. Plastids with fewer than the theoretical maximum number of membranes are common. This is correctly attributed to \"selective membrane loss.\" Furthermore, the specific example of the outermost membrane becoming continuous with the host ER is a well-documented phenomenon in lineages with secondary plastids (e.g., stramenopiles, haptophytes).\n-   **Verdict: Correct.**\n\n**C. Expected counts are $3$, $5$, and $7$, respectively, because the peptidoglycan layer of cyanobacteria counts as a membrane and is retained. Deviations occur when peptidoglycan is degraded, reducing the count by $-1$ at any stage.**\n-   The reasoning for the counts is fundamentally flawed. The problem statement explicitly says, \"The peptidoglycan layer is not a membrane.\" This option directly contradicts a given fact.\n-   Even if the counts ($3, 5, 7$) could be derived from a literal \"full retention from scratch\" model, the justification provided makes the entire option invalid.\n-   **Verdict: Incorrect.**\n\n**D. Expected counts are $2$, $5$, and $7$, respectively, because the endosymbiont’s nuclear envelope contributes two membranes to the plastid at the secondary stage. Deviations occur when the nuclear envelope is lost, yielding $3$ membranes at secondary endosymbiosis.**\n-   The expected counts ($2$, $5$, $7$) are incorrect. The secondary count should be $4$, not $5$.\n-   The reasoning for the count of $5$ is based on a misunderstanding of cell topology. The endosymbiont's nuclear envelope surrounds its nucleus, not its plastid (which resides in the cytoplasm). The host engulfs the entire cell; the plastid and nucleus are separate contents within the engulfed cytoplasm. The nuclear envelope does not become layered around the plastid.\n-   **Verdict: Incorrect.**\n\n**E. Expected counts are $2$, $4$, and $5$, respectively, because tertiary endosymbiosis adds only the prey plasma membrane ($+1$) while the host phagosomal membrane never persists. Deviations arise solely from gene transfer to the host nucleus, which removes membranes associated with protein import complexes.**\n-   The expected counts ($2$, $4$, $5$) are incorrect. The tertiary count should be $6$.\n-   The reasoning for the count of $5$ makes an unsubstantiated claim that the phagosomal membrane \"never persists\" in tertiary endosymbiosis, which contradicts the problem's explicit instruction to assume full retention.\n-   The explanation for deviations is incorrect and mirrors the flawed logic of option A, wrongly linking gene transfer directly to the physical removal of entire membranes.\n-   **Verdict: Incorrect.**\n\nBased on the rigorous derivation and analysis, only option B provides the correct theoretical counts and a factually sound explanation for both the model and its real-world variations.", "answer": "$$\\boxed{B}$$", "id": "2616619"}, {"introduction": "Scientific theories are powerful not in isolation, but in their ability to explain data better than competing hypotheses. This practice places you in the role of a researcher evaluating the core claim of the endosymbiotic theory against an alternative—the autogenous model—using a powerful statistical tool, the Akaike Information Criterion ($AIC$) [@problem_id:2616682]. Using hypothetical but realistic comparative data, you will learn how to quantify the relative support for different evolutionary models, appreciating how modern biology uses information theory to bring rigor to historical questions.", "problem": "A comparative analysis of organelle genome evolution is conducted across representative lineages in animals, fungi, plants, and algae to evaluate two mechanistic hypotheses for the origin of organelle gene complements: the endosymbiotic model and the autogenous model. The endosymbiotic model posits that mitochondria and plastids derive from ancestral bacteria that established endosymbiosis, with organelle genomes and many nuclear-encoded organelle-targeted genes tracing to those bacterial donors. The autogenous model posits that organelle-like functions arose by internal innovation without a bacterial endosymbiont lineage providing the ancestral gene pool. Two independent datasets are assembled: a mitochondrial dataset $M$ (metazoans and fungi) that scores gene-content and sequence-similarity features diagnostic of alpha-proteobacterial ancestry, and a plastid dataset $P$ (green plants, red algae, and related lineages) that scores analogous features diagnostic of cyanobacterial ancestry. Each dataset is modeled under both hypotheses using a likelihood framework grounded in the definition of likelihood and the principle of maximum likelihood, and model selection is performed using the Akaike Information Criterion (AIC), a well-tested model selection metric that approximates selection by minimizing expected Kullback–Leibler (KL) divergence.\n\nAssume the datasets $M$ and $P$ are statistically independent and that, for each hypothesis, parameters governing $M$ and $P$ are disjoint so that joint likelihoods factor and parameter counts add. The maximum log-likelihoods and free-parameter counts obtained from fitting each hypothesis to each dataset are:\n\n- For dataset $M$:\n  - Endosymbiotic model: maximized log-likelihood $\\ln L_{E,M} = -96.213$ with $k_{E,M} = 3$.\n  - Autogenous model: maximized log-likelihood $\\ln L_{A,M} = -94.084$ with $k_{A,M} = 6$.\n\n- For dataset $P$:\n  - Endosymbiotic model: maximized log-likelihood $\\ln L_{E,P} = -120.321$ with $k_{E,P} = 4$.\n  - Autogenous model: maximized log-likelihood $\\ln L_{A,P} = -125.955$ with $k_{A,P} = 6$.\n\nUsing the standard formulation of the Akaike Information Criterion $\\,\\mathrm{AIC} = 2k - 2 \\ln L\\,$ applied to each dataset and summed across independent datasets with disjoint parameters, compute the combined difference\n$$\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{\\mathrm{autogenous},\\,M+P} - \\mathrm{AIC}_{\\mathrm{endosymbiotic},\\,M+P}.$$\nReport only the numerical value of $\\Delta \\mathrm{AIC}$ as your final answer. Round your answer to four significant figures.", "solution": "The problem statement is submitted for validation.\n\nFirst, the given information is extracted.\n- Two competing hypotheses: the endosymbiotic model ($E$) and the autogenous model ($A$).\n- Two independent datasets: $M$ for mitochondria and $P$ for plastids.\n- The formulation for the Akaike Information Criterion is given as $\\mathrm{AIC} = 2k - 2 \\ln L$, where $k$ is the number of free parameters and $\\ln L$ is the maximized log-likelihood.\n- It is stated that due to statistical independence and disjoint parameters for datasets $M$ and $P$, joint likelihoods factor and parameter counts add.\n- The data provided are as follows:\n- For dataset $M$:\n  - Endosymbiotic model: maximized log-likelihood $\\ln L_{E,M} = -96.213$ with $k_{E,M} = 3$.\n  - Autogenous model: maximized log-likelihood $\\ln L_{A,M} = -94.084$ with $k_{A,M} = 6$.\n- For dataset $P$:\n  - Endosymbiotic model: maximized log-likelihood $\\ln L_{E,P} = -120.321$ with $k_{E,P} = 4$.\n  - Autogenous model: maximized log-likelihood $\\ln L_{A,P} = -125.955$ with $k_{A,P} = 6$.\n- The objective is to compute the combined difference $\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{\\mathrm{autogenous},\\,M+P} - \\mathrm{AIC}_{\\mathrm{endosymbiotic},\\,M+P}$.\n\nNext, the validity of the problem is assessed. The problem is scientifically grounded, as it concerns the endosymbiotic theory, a central concept in cell biology, and employs the Akaike Information Criterion, a standard and widely accepted method for statistical model selection. The problem is well-posed; it provides all necessary data and a clear, unambiguous objective. The terms are defined, the context is relevant to the specified field of comparative biology, and the constraints are consistent and sufficient for a unique solution. The numerical values are plausible for a problem of this type. There are no logical contradictions, factual inaccuracies, or violations of scientific principles. Thus, the problem is deemed valid.\n\nThe solution proceeds. The task is to calculate the difference in the Akaike Information Criterion ($\\Delta \\mathrm{AIC}$) between the combined autogenous model and the combined endosymbiotic model. The AIC is defined as:\n$$\n\\mathrm{AIC} = 2k - 2 \\ln L\n$$\nwhere $k$ is the number of free parameters and $\\ln L$ is the maximized value of the log-likelihood function.\n\nThe problem states that the datasets $M$ and $P$ are statistically independent and their parameters are disjoint. This property allows for the calculation of the total AIC for a combined dataset ($M+P$) by summing the individual AIC values for each dataset.\n$$\n\\mathrm{AIC}_{M+P} = \\mathrm{AIC}_M + \\mathrm{AIC}_P\n$$\nThis is equivalent to summing the parameter counts and the log-likelihoods before calculating the AIC:\n$$\n\\mathrm{AIC}_{M+P} = 2(k_M + k_P) - 2(\\ln L_M + \\ln L_P)\n$$\nWe apply this principle to both the endosymbiotic ($E$) and autogenous ($A$) models.\n\nFirst, we calculate the total AIC for the endosymbiotic model, $\\mathrm{AIC}_{E, M+P}$.\nThe total number of parameters for the endosymbiotic model is the sum of the parameters for each dataset:\n$$\nk_{E, M+P} = k_{E,M} + k_{E,P} = 3 + 4 = 7\n$$\nThe total maximized log-likelihood for the endosymbiotic model is the sum of the log-likelihoods for each dataset:\n$$\n\\ln L_{E, M+P} = \\ln L_{E,M} + \\ln L_{E,P} = -96.213 + (-120.321) = -216.534\n$$\nNow, we can compute the combined AIC for the endosymbiotic model:\n$$\n\\mathrm{AIC}_{E, M+P} = 2k_{E, M+P} - 2\\ln L_{E, M+P} = 2(7) - 2(-216.534) = 14 + 433.068 = 447.068\n$$\n\nNext, we calculate the total AIC for the autogenous model, $\\mathrm{AIC}_{A, M+P}$.\nThe total number of parameters for the autogenous model is:\n$$\nk_{A, M+P} = k_{A,M} + k_{A,P} = 6 + 6 = 12\n$$\nThe total maximized log-likelihood for the autogenous model is:\n$$\n\\ln L_{A, M+P} = \\ln L_{A,M} + \\ln L_{A,P} = -94.084 + (-125.955) = -220.039\n$$\nWe compute the combined AIC for the autogenous model:\n$$\n\\mathrm{AIC}_{A, M+P} = 2k_{A, M+P} - 2\\ln L_{A, M+P} = 2(12) - 2(-220.039) = 24 + 440.078 = 464.078\n$$\n\nFinally, we compute the required difference, $\\Delta \\mathrm{AIC}$:\n$$\n\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{A, M+P} - \\mathrm{AIC}_{E, M+P}\n$$\nSubstituting the calculated values:\n$$\n\\Delta \\mathrm{AIC} = 464.078 - 447.068 = 17.01\n$$\nAlternatively, the calculation can be structured as follows:\n$$\n\\Delta \\mathrm{AIC} = (\\mathrm{AIC}_{A, M} + \\mathrm{AIC}_{A, P}) - (\\mathrm{AIC}_{E, M} + \\mathrm{AIC}_{E, P})\n$$\n$$\n\\Delta \\mathrm{AIC} = (2k_{A,M} - 2\\ln L_{A,M} + 2k_{A,P} - 2\\ln L_{A,P}) - (2k_{E,M} - 2\\ln L_{E,M} + 2k_{E,P} - 2\\ln L_{E,P})\n$$\n$$\n\\Delta \\mathrm{AIC} = 2(k_{A,M} + k_{A,P} - k_{E,M} - k_{E,P}) - 2(\\ln L_{A,M} + \\ln L_{A,P} - \\ln L_{E,M} - \\ln L_{E,P})\n$$\nSubstituting the given values into this expression:\n$$\n\\Delta \\mathrm{AIC} = 2(6 + 6 - 3 - 4) - 2(-94.084 - 125.955 - (-96.213) - (-120.321))\n$$\n$$\n\\Delta \\mathrm{AIC} = 2(12 - 7) - 2(-220.039 - (-216.534))\n$$\n$$\n\\Delta \\mathrm{AIC} = 2(5) - 2(-220.039 + 216.534)\n$$\n$$\n\\Delta \\mathrm{AIC} = 10 - 2(-3.505)\n$$\n$$\n\\Delta \\mathrm{AIC} = 10 + 7.01 = 17.01\n$$\nBoth methods yield the identical result. The problem requires the answer to be rounded to four significant figures. The calculated value of $17.01$ already has four significant figures. A positive $\\Delta \\mathrm{AIC}$ indicates that the autogenous model is less supported by the data than the endosymbiotic model, as the AIC is a measure of information loss, and a lower AIC value is preferred.\nThe final numerical answer is $17.01$.", "answer": "$$\\boxed{17.01}$$", "id": "2616682"}, {"introduction": "The relationship between an organelle and its host cell is dynamic, characterized by an ongoing transfer of genetic material from the former to the latter, leaving 'fossils' of mitochondrial or plastid DNA in the nuclear genome. This advanced computational exercise guides you through the process of building a bioinformatic pipeline to detect these nuclear organelle DNA segments (NUMTs or NUPTs) and estimate their age [@problem_id:2616685]. By combining statistical tests for sequence similarity with evolutionary models for distance correction and dating, you will engage with the methods used at the forefront of comparative genomics to reconstruct the evolutionary history written in our genomes.", "problem": "You are asked to formalize a computational pipeline for detecting and dating Nuclear Mitochondrial DNA segment (NUMT) insertions using organelle read alignments to a nuclear genome and molecular evolutionary rate models. The task must be expressed entirely in mathematical-statistical terms derived from foundational principles. The goal is to implement a program that, for a small set of test cases, decides whether a nuclear genomic window contains a NUMT (or a nuclear plastid DNA insertion) and, if so, estimates the time since insertion. The principles to use are: (i) the binomial model for assessing similarity significance under a random-matching null hypothesis, (ii) the Jukes–Cantor (JC) model for correcting multiple substitutions in the observed Hamming divergence between homologous DNA sequences, and (iii) the molecular clock interpretation that equates expected corrected substitutions to the product of substitution rate and time. All time must be expressed in million years (Myr).\n\nFundamental base and definitions to use:\n- Detection significance is assessed by testing whether the number of matches in an alignment of length $L$ is unusually large under a null model where each site matches with probability $q = 0.25$ (assuming independent sites and uniform base composition). The number of matches $X$ under the null follows a binomial distribution $X \\sim \\mathrm{Binomial}(L, q)$.\n- The one-sided tail probability $\\Pr[X \\ge k]$ for $k$ observed matches provides a $p$-value for enrichment of similarity beyond random expectation. If this $p$-value is below a prespecified significance threshold $\\alpha$, the similarity is significant.\n- The observed Hamming proportion of differences between a NUMT and its current organelle homolog is $p_{\\mathrm{obs}} = m / L$, where $m$ is the count of mismatches in an alignment of length $L$.\n- Under the Jukes–Cantor model, the corrected number of substitutions per site is \n$$\nK = -\\frac{3}{4}\\ln\\!\\left(1 - \\frac{4}{3}p_{\\mathrm{obs}}\\right),\n$$\napplicable only when $p_{\\mathrm{obs}}  0.75$.\n- After insertion time $t$, the expected corrected distance between the NUMT (evolving in the nucleus) and the organelle lineage equals the sum of branch lengths since insertion: \n$$\nK \\approx \\left(r_{\\mathrm{nuc}} + r_{\\mathrm{org}}\\right)t,\n$$\nwhere $r_{\\mathrm{nuc}}$ is the nuclear substitution rate and $r_{\\mathrm{org}}$ is the organelle rate (mitochondrial or plastid), all in substitutions per site per million years. Thus, when applicable,\n$$\nt = \\frac{K}{r_{\\mathrm{nuc}} + r_{\\mathrm{org}}}.\n$$\n- Coverage of a nuclear window by organelle-derived reads is computed as $c = \\frac{R \\cdot \\ell}{L}$, where $R$ is the number of mapped reads, $\\ell$ is the read length, and $L$ is the window length. A minimal coverage threshold $c_{\\min}$ must be satisfied to call a NUMT.\n\nDecision rule to implement:\n- Given $(L, m, R, \\ell)$, compute $k = L - m$, $c = \\frac{R \\cdot \\ell}{L}$, and the one-sided binomial tail probability $p_{\\text{val}} = \\Pr[X \\ge k]$ for $X \\sim \\mathrm{Binomial}(L, 0.25)$. Call a window a valid NUMT (or nuclear plastid insertion) if both $c \\ge c_{\\min}$ and $p_{\\text{val}}  \\alpha$.\n- If a window is valid and $p_{\\mathrm{obs}}  0.75$, compute $K$ via the Jukes–Cantor model and then compute $t = \\frac{K}{r_{\\mathrm{nuc}} + r_{\\mathrm{org}}}$. If $p_{\\mathrm{obs}} \\ge 0.75$, the date is undefined due to saturation; treat this as not dateable.\n- For non-NUMT windows or undateable cases, return a sentinel value.\n\nRequired program behavior:\n- Implement the above logic for the provided test suite. Use $\\alpha = 0.01$ and $c_{\\min} = 5$.\n- Each test case supplies whether the organelle is mitochondrial or plastid, the alignment length $L$ (in base pairs), the mismatch count $m$, the number of mapped reads $R$, the read length $\\ell$ (in base pairs), and the substitution rates $r_{\\mathrm{nuc}}$, $r_{\\mathrm{mt}}$, and $r_{\\mathrm{pt}}$ in substitutions per site per million years. Choose $r_{\\mathrm{org}} = r_{\\mathrm{mt}}$ if the organelle flag is mitochondrial and $r_{\\mathrm{org}} = r_{\\mathrm{pt}}$ if plastid.\n- For each test case, output a single floating-point number equal to the estimated insertion time $t$ in million years, rounded to exactly three decimal places, if the window is a valid and dateable NUMT (or nuclear plastid insertion). Otherwise, output the sentinel value $-1.000$.\n- The final program output must be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets, with no spaces, for example `[3.142,-1.000,0.000]`.\n\nTest suite (each case is a tuple: $(\\text{organelle}, L, m, R, \\ell, r_{\\mathrm{nuc}}, r_{\\mathrm{mt}}, r_{\\mathrm{pt}})$):\n- Case $1$: $(\\text{\"mt\"},\\, 1000,\\, 80,\\, 600,\\, 100,\\, 0.002,\\, 0.020,\\, 0.003)$.\n- Case $2$: $(\\text{\"mt\"},\\, 150,\\, 50,\\, 3,\\, 100,\\, 0.002,\\, 0.020,\\, 0.003)$.\n- Case $3$: $(\\text{\"mt\"},\\, 800,\\, 620,\\, 300,\\, 100,\\, 0.002,\\, 0.020,\\, 0.003)$.\n- Case $4$: $(\\text{\"pt\"},\\, 1200,\\, 60,\\, 240,\\, 100,\\, 0.001,\\, 0.020,\\, 0.003)$.\n- Case $5$: $(\\text{\"mt\"},\\, 500,\\, 0,\\, 50,\\, 100,\\, 0.002,\\, 0.015,\\, 0.003)$.\n- Case $6$: $(\\text{\"mt\"},\\, 100,\\, 70,\\, 20,\\, 100,\\, 0.002,\\, 0.020,\\, 0.003)$.\n\nAngle units are not applicable. There are no physical units other than time, which must be reported in million years (Myr). Percentages should not be used; fractional values must be decimals or fractions.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[3.818,-1.000,12.938,...]`).", "solution": "The solution implements the specified bioinformatic pipeline by applying the detection and dating logic to each test case sequentially. The final output is a list of insertion time estimates or sentinel values.\n\n**Constants for Pipeline:**\n- Significance threshold, $\\alpha = 0.01$\n- Minimum coverage threshold, $c_{\\min} = 5$\n- Null hypothesis match probability, $q = 0.25$\n- Sentinel value for failure, $-1.000$\n\n**Case-by-Case Analysis:**\n\n**Case 1:** $(\\text{\"mt\"}, L=1000, m=80, R=600, \\ell=100, r_{\\text{nuc}}=0.002, r_{\\text{mt}}=0.020, \\dots)$\n1.  **Detection:**\n    -   Coverage: $c = (600 \\cdot 100) / 1000 = 60.0$. This is $\\ge c_{\\min}$. **Pass.**\n    -   Significance: Matches $k = 1000 - 80 = 920$. For $X \\sim \\text{Binomial}(1000, 0.25)$, the expected number of matches is 250. The probability $\\Pr[X \\ge 920]$ is extremely small, so $p_{\\text{val}}  0.01$. **Pass.**\n    -   *Verdict: Valid NUMT.*\n2.  **Dating:**\n    -   Divergence: $p_{\\text{obs}} = 80/1000 = 0.08$. This is $ 0.75$. **Dateable.**\n    -   Corrected Distance: $K = -\\frac{3}{4}\\ln(1 - \\frac{4}{3} \\cdot 0.08) \\approx 0.08453$.\n    -   Total Rate: $r_{\\text{total}} = r_{\\text{nuc}} + r_{\\text{mt}} = 0.002 + 0.020 = 0.022$.\n    -   Time: $t = K / r_{\\text{total}} = 0.08453 / 0.022 \\approx 3.842$ Myr.\n\n**Case 2:** $(\\text{\"mt\"}, L=150, m=50, R=3, \\ell=100, \\dots)$\n1.  **Detection:**\n    -   Coverage: $c = (3 \\cdot 100) / 150 = 2.0$. This is $ c_{\\min}$. **Fail.**\n    -   *Verdict: Not a valid NUMT.* Result: -1.000.\n\n**Case 3:** $(\\text{\"mt\"}, L=800, m=620, R=300, \\ell=100, \\dots)$\n1.  **Detection:**\n    -   Coverage: $c = (300 \\cdot 100) / 800 = 37.5$. This is $\\ge c_{\\min}$. **Pass.**\n    -   Significance: Matches $k = 800 - 620 = 180$. For $X \\sim \\text{Binomial}(800, 0.25)$, the expected matches are 200. Observing fewer than the random expectation means the sequence is not significantly similar. $\\Pr[X \\ge 180]$ is high ($>0.95$), not less than 0.01. **Fail.**\n    -   *Verdict: Not a valid NUMT.* Result: -1.000.\n\n**Case 4:** $(\\text{\"pt\"}, L=1200, m=60, R=240, \\ell=100, r_{\\text{nuc}}=0.001, \\dots, r_{\\text{pt}}=0.003)$\n1.  **Detection:**\n    -   Coverage: $c = (240 \\cdot 100) / 1200 = 20.0$. This is $\\ge c_{\\min}$. **Pass.**\n    -   Significance: Matches $k = 1200 - 60 = 1140$. Expected matches are 300. $p_{\\text{val}} \\ll 0.01$. **Pass.**\n    -   *Verdict: Valid NUPT.*\n2.  **Dating:**\n    -   Divergence: $p_{\\text{obs}} = 60/1200 = 0.05$. This is $ 0.75$. **Dateable.**\n    -   Corrected Distance: $K = -\\frac{3}{4}\\ln(1 - \\frac{4}{3} \\cdot 0.05) \\approx 0.05185$.\n    -   Total Rate: $r_{\\text{total}} = r_{\\text{nuc}} + r_{\\text{pt}} = 0.001 + 0.003 = 0.004$.\n    -   Time: $t = K / r_{\\text{total}} = 0.05185 / 0.004 \\approx 12.963$ Myr.\n\n**Case 5:** $(\\text{\"mt\"}, L=500, m=0, R=50, \\ell=100, \\dots, r_{\\text{mt}}=0.015, \\dots)$\n1.  **Detection:**\n    -   Coverage: $c = (50 \\cdot 100) / 500 = 10.0$. This is $\\ge c_{\\min}$. **Pass.**\n    -   Significance: Matches $k = 500 - 0 = 500$. Expected matches are 125. $p_{\\text{val}} \\ll 0.01$. **Pass.**\n    -   *Verdict: Valid NUMT.*\n2.  **Dating:**\n    -   Divergence: $p_{\\text{obs}} = 0/500 = 0.0$.\n    -   Corrected Distance: $K = 0$.\n    -   Time: $t = 0 / (0.002 + 0.015) = 0.000$ Myr.\n\n**Case 6:** $(\\text{\"mt\"}, L=100, m=70, R=20, \\ell=100, \\dots)$\n1.  **Detection:**\n    -   Coverage: $c = (20 \\cdot 100) / 100 = 20.0$. This is $\\ge c_{\\min}$. **Pass.**\n    -   Significance: Matches $k = 100 - 70 = 30$. Expected matches are 25. For $X \\sim \\text{Binomial}(100, 0.25)$, $\\Pr[X \\ge 30] \\approx 0.149$. This is not $ 0.01$. **Fail.**\n    -   *Verdict: Not a valid NUMT.* Result: -1.000.\n\n**Final Result List:**\nThe calculated values, rounded to three decimal places, are compiled into the final list.\n[3.842, -1.000, -1.000, 12.963, 0.000, -1.000]", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import binom\n\ndef solve():\n    \"\"\"\n    Solves the NUMT detection and dating problem for a series of test cases.\n\n    The pipeline follows these steps for each case:\n    1.  Detection:\n        a. Calculate read coverage. Must be >= 5.\n        b. Calculate the p-value for the number of matches under a binomial\n           null model (p=0.25). Must be  0.01.\n        c. If either check fails, the window is not a valid NUMT.\n\n    2.  Dating:\n        a. If the window is a valid NUMT, calculate the observed divergence p_obs.\n        b. If p_obs >= 0.75, the sequence is saturated and undateable.\n        c. Otherwise, calculate the corrected distance K using the Jukes-Cantor model.\n        d. Calculate the insertion time t using the molecular clock equation with\n           the appropriate nuclear and organelle substitution rates.\n\n    3.  Output:\n        a. For valid and dateable NUMTs, return the time t rounded to 3 decimal places.\n        b. Otherwise, return the sentinel value -1.000.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (organelle, L, m, R, l, r_nuc, r_mt, r_pt)\n    test_cases = [\n        (\"mt\", 1000, 80, 600, 100, 0.002, 0.020, 0.003),   # Case 1\n        (\"mt\", 150, 50, 3, 100, 0.002, 0.020, 0.003),      # Case 2\n        (\"mt\", 800, 620, 300, 100, 0.002, 0.020, 0.003),   # Case 3\n        (\"pt\", 1200, 60, 240, 100, 0.001, 0.020, 0.003),   # Case 4\n        (\"mt\", 500, 0, 50, 100, 0.002, 0.015, 0.003),      # Case 5\n        (\"mt\", 100, 70, 20, 100, 0.002, 0.020, 0.003),      # Case 6\n    ]\n\n    # Constants and thresholds\n    alpha = 0.01\n    c_min = 5.0\n    q_null = 0.25\n    sentinel_value = -1.0\n\n    results = []\n\n    for case in test_cases:\n        organelle, L, m, R, l, r_nuc, r_mt, r_pt = case\n        \n        # --- DETECTION STAGE ---\n\n        # 1. Coverage criterion\n        coverage = (R * l) / L\n        is_coverage_sufficient = coverage >= c_min\n        \n        # 2. Significance criterion\n        num_matches = L - m\n        # Calculate one-sided p-value: Pr[X >= k] where X ~ Binomial(L, q)\n        # scipy.stats.binom.sf(k-1, n, p) calculates Pr[X >= k]\n        p_value = binom.sf(num_matches - 1, L, q_null)\n        is_significant = p_value  alpha\n        \n        is_valid_numt = is_coverage_sufficient and is_significant\n        \n        # --- DATING STAGE ---\n        \n        if is_valid_numt:\n            p_obs = m / L\n            \n            # Check if divergence is within the range of the Jukes-Cantor model\n            if p_obs  0.75:\n                # Calculate corrected distance K\n                if p_obs == 0:\n                    K = 0.0\n                else:\n                    K = -0.75 * np.log(1.0 - (4.0 / 3.0) * p_obs)\n                \n                # Select appropriate organelle rate\n                r_org = r_mt if organelle == \"mt\" else r_pt\n                \n                # Calculate total rate and time\n                r_total = r_nuc + r_org\n                \n                # Check for division by zero, though rates are positive\n                if r_total > 0:\n                    t = K / r_total\n                    results.append(t)\n                else: # Should not happen with given data\n                    results.append(sentinel_value)\n\n            else: # Undateable due to saturation\n                results.append(sentinel_value)\n        else: # Not a valid NUMT\n            results.append(sentinel_value)\n\n    # Format results to exactly three decimal places and create the final output string\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2616685"}]}