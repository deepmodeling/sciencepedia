{"hands_on_practices": [{"introduction": "To appreciate the cohesion-tension theory, one must first quantify the fundamental physical challenge of lifting water against gravity. This foundational exercise involves calculating the gravitational component of water potential, $\\Psi_g$, which establishes the baseline tension that any tall plant must generate just to support its water column. This calculation provides a crucial physical reference for contextualizing the much larger tensions created by transpiration [@problem_id:2555396].", "problem": "A central prediction of the cohesion–tension theory is that water ascends in the xylem under negative pressure (tension), and that the gravitational component of water potential increases with elevation, thereby imposing an added pressure difference that must be balanced by tension generated by transpiration. Consider a straight, water-filled xylem pathway from the soil surface at the base of a tree to leaves at height $H = 35$ m. Assume the water column is static with respect to vertical acceleration (quasi-steady), the fluid is incompressible, and temperature effects on density are negligible. Starting from hydrostatic equilibrium $\\frac{dP}{dz} = -\\rho g$ and the definition of water potential as energy per unit volume (with units of pressure), derive the gravitational contribution to the water potential difference between base and leaves as a function of elevation difference. Then compute its magnitude for $H = 35$ m using $\\rho = 1.00 \\times 10^{3}$ kg m$^{-3}$ and $g = 9.81$ m s$^{-2}$, and express the final numerical result in megapascal (MPa). Round your numerical result to four significant figures.\n\nFinally, interpret the magnitude you obtain relative to measured midday leaf water potentials in well-watered temperate trees (approximately $-1.0$ to $-2.5$ MPa) and in arid-adapted shrubs (approximately $-3.0$ to $-6.0$ MPa), explaining the relative contribution of gravity to the total tension required by the cohesion–tension mechanism. Your final reported answer must be only the computed numerical value in MPa.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on the established principles of fluid statics and the cohesion-tension theory of water transport in plants. All necessary constants and conditions are provided, and no contradictions exist. The problem is therefore valid for solution.\n\nWe begin by formalizing the concept of water potential, $\\Psi$, which is defined as the potential energy of water per unit volume. For the purpose of this problem, we consider the two most relevant components: the pressure potential, $\\Psi_p$, which is equivalent to the hydrostatic pressure $P$, and the gravitational potential, $\\Psi_g$. The total water potential at an elevation $z$ is thus given by the sum:\n$$ \\Psi(z) = \\Psi_p(z) + \\Psi_g(z) $$\nThe gravitational potential energy of a mass $m$ of water at height $z$ is $U_g = mgz$. The corresponding potential per unit volume $V$ is $\\frac{U_g}{V} = \\frac{m}{V} g z$. Recognizing that density $\\rho = \\frac{m}{V}$, the gravitational potential in units of pressure is:\n$$ \\Psi_g(z) = \\rho g z $$\nwhere $g$ is the acceleration due to gravity.\n\nThe problem states that the water column is in hydrostatic equilibrium, which is described by the differential equation:\n$$ \\frac{dP}{dz} = -\\rho g $$\nThis equation indicates that hydrostatic pressure $P$ decreases linearly with increasing height $z$.\n\nThe first task is to derive the gravitational contribution to the water potential difference between the base of the tree (let's define as $z_1 = 0$) and the leaves at height $H$ (at $z_2 = H = 35$ m). This contribution is simply the difference in the gravitational potential term, $\\Delta\\Psi_g$, between these two elevations.\n$$ \\Delta\\Psi_g = \\Psi_g(z_2) - \\Psi_g(z_1) $$\nSubstituting the expression for $\\Psi_g(z)$, we have:\n$$ \\Delta\\Psi_g = \\rho g z_2 - \\rho g z_1 = \\rho g H - \\rho g (0) = \\rho g H $$\nThis is the analytical expression for the gravitational contribution to the water potential difference. It represents the potential energy per unit volume required to lift the water to height $H$ against gravity.\n\nNext, we compute the numerical magnitude of this contribution using the provided values: water density $\\rho = 1.00 \\times 10^{3}$ kg m$^{-3}$, gravitational acceleration $g = 9.81$ m s$^{-2}$, and height $H = 35$ m.\n$$ \\Delta\\Psi_g = (1.00 \\times 10^{3} \\, \\text{kg m}^{-3}) \\times (9.81 \\, \\text{m s}^{-2}) \\times (35 \\, \\text{m}) $$\nThe calculation yields:\n$$ \\Delta\\Psi_g = 343350 \\, \\text{kg m}^{-1} \\text{s}^{-2} $$\nThe unit kg m$^{-1}$ s$^{-2}$ is equivalent to the Pascal (Pa), the standard unit of pressure.\n$$ \\Delta\\Psi_g = 343350 \\, \\text{Pa} $$\nTo express this result in megapascals (MPa), we use the conversion $1$ MPa $= 10^6$ Pa.\n$$ \\Delta\\Psi_g = \\frac{343350}{10^6} \\, \\text{MPa} = 0.343350 \\, \\text{MPa} $$\nThe problem requires rounding this numerical result to four significant figures. The fifth significant figure is a $5$, so we round the fourth digit up.\n$$ \\Delta\\Psi_g \\approx 0.3434 \\, \\text{MPa} $$\n\nFinally, we interpret this magnitude. The value $\\Delta\\Psi_g \\approx +0.3434$ MPa represents the \"cost\" of lifting water against gravity to a height of $35$ m. Within the framework of the cohesion-tension theory, the total water potential generally decreases from soil to leaf to drive water flow. The total leaf water potential, $\\Psi_{\\text{leaf}}$, is the sum of its components: $\\Psi_{\\text{leaf}} = \\Psi_{p, \\text{leaf}} + \\Psi_{g, \\text{leaf}}$. The gravitational component at the leaf is $\\Psi_{g, \\text{leaf}} = \\rho g H = +0.3434$ MPa. The pressure component, $\\Psi_{p, \\text{leaf}}$, is the tension, which is negative.\nFor a well-watered temperate tree with a typical midday $\\Psi_{\\text{leaf}}$ of approximately $-1.5$ MPa, the tension required is:\n$$ \\Psi_{p, \\text{leaf}} = \\Psi_{\\text{leaf}} - \\Psi_{g, \\text{leaf}} \\approx -1.5 \\, \\text{MPa} - 0.3434 \\, \\text{MPa} \\approx -1.84 \\, \\text{MPa} $$\nIn this case, the gravitational potential constitutes a significant portion of the total water potential budget. The tension must be sufficiently negative to overcome both the gravitational potential and other factors like the water potential of the soil and frictional resistances. For arid-adapted shrubs, which generate much lower leaf water potentials (e.g., $-4.5$ MPa) to extract water from dry soil, the required tension would be $\\Psi_{p, \\text{leaf}} \\approx -4.5 \\, \\text{MPa} - 0.3434 \\, \\text{MPa} \\approx -4.84 \\, \\text{MPa}$. Although the relative contribution of gravity is smaller in such cases, it remains an ineluctable physical barrier that must be surmounted by the tension generated via transpiration. Therefore, our calculated value of $0.3434$ MPa quantifies a fundamental constraint imposed by gravity on the height of vascular plants.", "answer": "$$\\boxed{0.3434}$$", "id": "2555396"}, {"introduction": "The existence of water under extreme tension begs the question of how the vascular system resists catastrophic failure from air leaks. This practice delves into the microscopic physics of pit membranes, the structures that connect xylem conduits. By applying the Young-Laplace equation, you will quantify the immense capillary pressure that nanoscale pores can sustain, revealing the mechanism that isolates embolisms and preserves the integrity of the hydraulic network [@problem_id:2555348].", "problem": "In the cohesion–tension framework for xylem transport, air seeding into a water-filled conduit is opposed by the capillary pressure across the air–water interface (meniscus) spanning nanoscale pores in pit membranes. Consider a single cylindrical pore of radius $r$ that opens between an embolized (gas) conduit and an adjacent water-filled conduit. The air–water surface tension is $\\gamma$ at temperature $T$, and the static contact angle (measured through the liquid) at the hydrophilic pit membrane is $\\theta$. Under quasi-static conditions, the meniscus adopts a shape of constant mean curvature and pins at the pore rim.\n\nStarting from interfacial thermodynamics and mechanical equilibrium of a curved interface, namely from the differential balance between pressure–volume work and surface free energy for a virtual displacement of the meniscus, derive an expression for the pressure difference across the interface (gas minus liquid), $\\Delta P$, in terms of $\\gamma$, $r$, and $\\theta$, using only the geometry of a spherical cap in a circular pore. Then, using $r=50\\ \\text{nm}$, $\\gamma=0.072\\ \\text{N m}^{-1}$, and $\\theta=0^\\circ$, evaluate the magnitude of $\\Delta P$.\n\nExpress your final answer in megapascals and round to two significant figures.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. We will proceed to derive the expression for the pressure difference across the interface and then evaluate its magnitude.\n\nThe problem requires a derivation from the principle of virtual work, relating the pressure-volume work to the change in interfacial free energy. We consider a system composed of a gas phase and a liquid (water) phase, separated by an interface forming a meniscus within a cylindrical pore of radius $r$. The meniscus is a spherical cap. The contact line of the three phases (gas, liquid, solid) is pinned at the pore rim, a circle of radius $r$. The contact angle, $\\theta$, is defined at this contact line. $\\Delta P$ is the pressure difference $P_{\\text{gas}} - P_{\\text{liquid}}$.\n\nLet us consider a virtual displacement of the liquid-gas interface. The most convenient virtual displacement for this problem is an infinitesimal translation $dz$ of the fluid along the axis of the cylindrical pore. This displacement causes the three-phase contact line to move along the solid wall of the pore.\n\nThe first law of thermodynamics for a system at constant temperature, undergoing a reversible process, can be expressed in terms of the Helmholtz free energy, $F = U - TS$. The differential change is $dF = -P dV + \\sum_i \\gamma_i dA_i$, where the second term represents the change in surface free energy. For a multi-phase system in mechanical equilibrium, the total change in Helmholtz free energy for a virtual displacement must be zero, $dF_{\\text{total}} = 0$.\n\nThe total free energy of our system is the sum of the bulk and interfacial energies:\n$F_{\\text{total}} = F_{\\text{liquid}} + F_{\\text{gas}} + F_{\\text{interface}}$\nFor a virtual displacement, the change is:\n$dF_{\\text{total}} = dF_{\\text{liquid}} + dF_{\\text{gas}} + dF_{\\text{interface}} = 0$\n\nThe work terms for the bulk phases are $dF_{\\text{liquid}} = -P_{\\text{liquid}} dV_{\\text{liquid}}$ and $dF_{\\text{gas}} = -P_{\\text{gas}} dV_{\\text{gas}}$. In our virtual displacement $dz$, the volume of the liquid increases by $dV_{\\text{liquid}} = \\pi r^2 dz$, and the volume of the gas decreases by the same amount, so $dV_{\\text{gas}} = -\\pi r^2 dz$.\nThe total change in the bulk free energy is:\n$dF_{\\text{bulk}} = -P_{\\text{liquid}}(\\pi r^2 dz) - P_{\\text{gas}}(-\\pi r^2 dz) = (P_{\\text{gas}} - P_{\\text{liquid}})\\pi r^2 dz = \\Delta P \\pi r^2 dz$.\n\nThe interfacial free energy has three components, corresponding to the solid-gas, solid-liquid, and liquid-gas interfaces. Let their respective surface tensions be $\\gamma_{sg}$, $\\gamma_{sl}$, and $\\gamma_{lg}$ (denoted as $\\gamma$ in the problem).\n$F_{\\text{interface}} = \\gamma_{sg} A_{sg} + \\gamma_{sl} A_{sl} + \\gamma A_{lg}$.\nDuring the displacement $dz$, the liquid-gas interface of area $A_{lg}$ is translated, so its area does not change to first order, $dA_{lg}=0$. However, the area of the solid-liquid interface increases as it advances along the pore wall: $dA_{sl} = 2\\pi r dz$. Correspondingly, the area of the solid-gas interface decreases: $dA_{sg} = -2\\pi r dz$.\nThe change in interfacial free energy is:\n$dF_{\\text{interface}} = \\gamma_{sg} (-2\\pi r dz) + \\gamma_{sl} (2\\pi r dz) = (\\gamma_{sl} - \\gamma_{sg}) 2\\pi r dz$.\n\nAt equilibrium, the total free energy change is zero:\n$dF_{\\text{total}} = \\Delta P \\pi r^2 dz + (\\gamma_{sl} - \\gamma_{sg}) 2\\pi r dz = 0$.\n$\\Delta P \\pi r^2 = -(\\gamma_{sl} - \\gamma_{sg}) 2\\pi r = (\\gamma_{sg} - \\gamma_{sl}) 2\\pi r$.\n\nThe term $(\\gamma_{sg} - \\gamma_{sl})$ is related to the liquid-gas surface tension $\\gamma$ and the contact angle $\\theta$ by the Young-Dupré equation for the equilibrium contact line:\n$\\gamma_{sg} = \\gamma_{sl} + \\gamma \\cos\\theta$.\nTherefore, $\\gamma_{sg} - \\gamma_{sl} = \\gamma \\cos\\theta$.\n\nSubstituting this into our equilibrium condition gives:\n$\\Delta P \\pi r^2 = (\\gamma \\cos\\theta) 2\\pi r$.\n\nSolving for $\\Delta P = P_{\\text{gas}} - P_{\\text{liquid}}$, we obtain the desired expression:\n$$\n\\Delta P = \\frac{2\\gamma \\cos\\theta}{r}\n$$\nThis is the required expression, which is a specific form of the Young-Laplace equation for a spherical meniscus in a cylindrical capillary.\n\nNow, we evaluate the magnitude of $\\Delta P$ using the given values:\nPore radius, $r = 50 \\ \\text{nm} = 50 \\times 10^{-9} \\ \\text{m}$.\nAir-water surface tension, $\\gamma = 0.072 \\ \\text{N m}^{-1}$.\nContact angle, $\\theta = 0^\\circ$.\n\nSubstituting these values into the derived formula:\n$\\Delta P = \\frac{2 \\times (0.072 \\ \\text{N m}^{-1}) \\times \\cos(0^\\circ)}{50 \\times 10^{-9} \\ \\text{m}}$.\nSince $\\cos(0^\\circ) = 1$:\n$\\Delta P = \\frac{2 \\times 0.072}{50 \\times 10^{-9}} \\ \\frac{\\text{N}}{\\text{m}^2}$.\nThe unit $\\text{N m}^{-2}$ is equivalent to the Pascal ($\\text{Pa}$).\n$\\Delta P = \\frac{0.144}{50 \\times 10^{-9}} \\ \\text{Pa} = \\frac{0.144}{5 \\times 10^{-8}} \\ \\text{Pa} = 0.0288 \\times 10^8 \\ \\text{Pa} = 2.88 \\times 10^6 \\ \\text{Pa}$.\n\nThe problem requires the answer to be expressed in megapascals ($\\text{MPa}$), where $1 \\ \\text{MPa} = 10^6 \\ \\text{Pa}$.\n$\\Delta P = 2.88 \\ \\text{MPa}$.\n\nFinally, we must round the result to two significant figures.\n$\\Delta P \\approx 2.9 \\ \\text{MPa}$.\n\nThis positive pressure difference represents the pressure that must be applied to the gas phase relative to the liquid phase to force air through the pore, a phenomenon known as air seeding. It is also equal to the magnitude of the tension (negative pressure) that the water column can sustain before cavitation occurs via air seeding from an adjacent gas-filled conduit.", "answer": "$$\n\\boxed{2.9}\n$$", "id": "2555348"}, {"introduction": "While pit membranes provide protection, they can fail under extreme tension, leading to cavitation and loss of hydraulic conductivity. This practice introduces the concept of the xylem vulnerability curve, a key tool for quantifying a plant's drought tolerance. You will derive a standard mathematical model for these curves and implement a method to fit its parameters to experimental data, bridging theoretical principles with practical data analysis techniques used in modern ecophysiology [@problem_id:2555382].", "problem": "You are asked to formalize and fit a mechanistic model of xylem vulnerability to cavitation within the cohesion-tension framework in a way that is universally implementable. The goal is to derive, from first principles, a scale-invariant probabilistic model for the fraction of embolized conduits as a function of absolute xylem tension, and to fit its key parameters to provided data in a reproducible computational manner.\n\nBackground and base assumptions: The cohesion-tension theory states that xylem sap is under negative pressure, denoted by the water potential $\\psi$ in megapascals (MPa), and that transpiration-generated tension pulls water upward. Embolism in conduits reduces whole-xylem hydraulic conductivity. Define $x = -\\psi$ as the absolute xylem tension. Let $\\mathrm{PLC}$ denote Percent Loss of Conductivity (PLC), the fraction of conductivity lost (multiplied by $100$ to express in percent). Assume:\n- Independent conduit failures.\n- Scale-invariant failure odds with respect to $x$ such that additive increments in $\\ln x$ add linearly to the log-odds of failure.\n- Monotonicity and boundedness of the failure fraction, with $\\mathrm{PLC}(x) \\to 0$ as $x \\to 0^+$ and $\\mathrm{PLC}(x) \\to 100$ as $x \\to \\infty$.\n\nTasks to be solved and implemented:\n1) From the above base, derive a model class that maps $x$ to the fraction embolized, in which the log-odds of embolism is an affine function of $\\ln x$. Show that this induces a two-parameter family that is a valid candidate for xylem vulnerability curves. Let the two interpretable parameters be:\n- $x_{50}$, the absolute tension at which $\\mathrm{PLC} = 50$.\n- $k$, a dimensionless steepness (shape) parameter controlling the rate of transition.\nDefine the slope at the mid-point (the \"slope at fifty\") as $S_{50}$, the derivative of $\\mathrm{PLC}$ with respect to $x$ evaluated at $x = x_{50}$, expressed in percent per megapascal. Express $S_{50}$ in terms of $x_{50}$ and $k$.\n\n2) Devise a linearization that admits direct estimation of $x_{50}$ and $k$ from noisy $\\{\\psi,\\mathrm{PLC}\\}$ measurements by ordinary least squares. Your algorithm must:\n- Transform $\\psi$ to $x = -\\psi > 0$.\n- Handle data where $\\mathrm{PLC}$ values lie in $(0,100)$; to avoid divergences in the log-odds, clip $\\mathrm{PLC}$ to an open interval $(\\epsilon,100-\\epsilon)$ for some small $\\epsilon$.\n- Fit the linearized relationship to obtain $k$ and $x_{50}$.\n- Report $\\mathrm{P50} = -x_{50}$ (in MPa; note that this value is negative by convention) and $S_{50}$ (in percent per MPa).\n\n3) Implement the method and apply it to the following three test datasets. Each dataset consists of a list of water potentials $\\psi$ (in MPa; negative values) and corresponding $\\mathrm{PLC}$ values (in percent). The datasets are designed to challenge your method across a range of steepness and midpoints, including an edge case with near-extreme $\\mathrm{PLC}$ values.\n\n- Test case $1$:\n  - $\\psi$ in MPa: $\\{-0.5,-1.0,-1.5,-2.0,-2.5,-3.0,-3.5,-4.0,-5.0,-6.0\\}$\n  - $\\mathrm{PLC}$ in percent: $\\{0.6,5.1,16.3,32.9,50.0,64.2,74.6,81.8,90.2,94.3\\}$\n\n- Test case $2$ (edge case with very steep transition and near-extreme $\\mathrm{PLC}$ values):\n  - $\\psi$ in MPa: $\\{-0.3,-0.5,-0.7,-0.9,-1.1,-1.2,-1.3,-1.5,-1.8,-2.2\\}$\n  - $\\mathrm{PLC}$ in percent: $\\{0.0,0.2,2.2,11.8,35.2,50.0,63.6,82.7,94.5,98.6\\}$\n\n- Test case $3$:\n  - $\\psi$ in MPa: $\\{-0.8,-1.2,-1.8,-2.5,-3.2,-4.0,-4.8,-6.0,-7.5,-9.0\\}$\n  - $\\mathrm{PLC}$ in percent: $\\{0.1,0.4,2.7,10.8,26.8,50.0,69.4,86.1,94.4,97.5\\}$\n\nOutput requirements:\n- For each test case, compute and return a list of two floating-point numbers: $[\\mathrm{P50}, S_{50}]$, where $\\mathrm{P50}$ must be expressed in MPa (negative number) and $S_{50}$ in percent per MPa.\n- Round both numbers to $3$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one sublist per test case in the same order as above. For example: $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$.", "solution": "The problem statement presented is valid. It is scientifically grounded in the established cohesion-tension theory of plant physiology and presents a well-posed task of model derivation and parameter fitting. The problem is objective, formalizable, and internally consistent. It contains all necessary information to proceed, with the minor exception of specifying a value for the clipping parameter $\\epsilon$, which can be resolved by making a reasonable and explicitly stated choice. We proceed with the solution.\n\nThe task is to derive a probabilistic model for xylem embolism, linearize it for parameter estimation, and apply this method to provided datasets.\n\n**Part 1: Model Derivation**\n\nWe begin from the foundational assumption that the log-odds of conduit failure (embolism) is an affine function of the logarithm of the absolute xylem tension, $x = -\\psi > 0$. Let $F(x)$ be the fraction of embolized conduits, ranging from $0$ to $1$. The Percent Loss of Conductivity, $\\mathrm{PLC}(x)$, is then $100 \\cdot F(x)$.\n\nThe odds of failure are given by the ratio $\\frac{F(x)}{1 - F(x)}$. The problem states that the logarithm of the odds is a linear function of $\\ln x$:\n$$\n\\ln\\left(\\frac{F(x)}{1 - F(x)}\\right) = a \\cdot \\ln x + b\n$$\nfor some constants $a$ and $b$. We must re-parameterize this model in terms of two physically interpretable parameters: $x_{50}$, the tension at which $50\\%$ of conductivity is lost, and $k$, a dimensionless shape parameter.\n\nBy definition, at $x = x_{50}$, $\\mathrm{PLC}(x_{50}) = 50$, which implies $F(x_{50}) = 0.5$. At this point, the odds are $\\frac{0.5}{1 - 0.5} = 1$, and the log-odds are $\\ln(1) = 0$. Substituting this into the model equation:\n$$\n0 = a \\cdot \\ln x_{50} + b\n$$\nThis allows us to express the intercept $b$ in terms of $a$ and $x_{50}$:\n$$\nb = -a \\cdot \\ln x_{50}\n$$\nSubstituting this back into the original equation yields:\n$$\n\\ln\\left(\\frac{F(x)}{1 - F(x)}\\right) = a \\cdot \\ln x - a \\cdot \\ln x_{50} = a \\left(\\ln x - \\ln x_{50}\\right) = a \\cdot \\ln\\left(\\frac{x}{x_{50}}\\right)\n$$\nTo find the functional form of $F(x)$, we exponentiate both sides:\n$$\n\\frac{F(x)}{1 - F(x)} = \\exp\\left(a \\cdot \\ln\\left(\\frac{x}{x_{50}}\\right)\\right) = \\left(\\frac{x}{x_{50}}\\right)^a\n$$\nSolving for $F(x)$:\n$$\nF(x) = (1 - F(x)) \\left(\\frac{x}{x_{50}}\\right)^a \\\\\nF(x) \\left[1 + \\left(\\frac{x}{x_{50}}\\right)^a\\right] = \\left(\\frac{x}{x_{50}}\\right)^a \\\\\nF(x) = \\frac{\\left(\\frac{x}{x_{50}}\\right)^a}{1 + \\left(\\frac{x}{x_{50}}\\right)^a} = \\frac{1}{\\left(\\frac{x}{x_{50}}\\right)^{-a} + 1} = \\frac{1}{1 + \\left(\\frac{x_{50}}{x}\\right)^a}\n$$\nThis is a standard sigmoidal function. Identifying the constant $a$ with the dimensionless steepness parameter $k$, and expressing the result as Percent Loss of Conductivity, we obtain the two-parameter model for the xylem vulnerability curve:\n$$\n\\mathrm{PLC}(x) = 100 \\cdot F(x) = \\frac{100}{1 + \\left(\\frac{x_{50}}{x}\\right)^k}\n$$\nThis model satisfies the boundary conditions: as $x \\to 0^+$, $(x_{50}/x) \\to \\infty$, so $\\mathrm{PLC}(x) \\to 0$. As $x \\to \\infty$, $(x_{50}/x) \\to 0$, so $\\mathrm{PLC}(x) \\to 100$.\n\nNext, we derive the expression for the slope at the midpoint, $S_{50}$. This is the derivative of $\\mathrm{PLC}(x)$ with respect to $x$, evaluated at $x = x_{50}$:\n$$\nS_{50} = \\left. \\frac{d(\\mathrm{PLC})}{dx} \\right|_{x=x_{50}}\n$$\nWe compute the derivative using the chain rule:\n$$\n\\frac{d(\\mathrm{PLC})}{dx} = \\frac{d}{dx} \\left[ 100 \\left(1 + x_{50}^k x^{-k}\\right)^{-1} \\right] \\\\\n= 100 \\cdot (-1) \\left(1 + x_{50}^k x^{-k}\\right)^{-2} \\cdot \\left( x_{50}^k (-k) x^{-k-1} \\right) \\\\\n= 100 k \\cdot x_{50}^k \\cdot x^{-k-1} \\cdot \\left(1 + \\left(\\frac{x_{50}}{x}\\right)^k\\right)^{-2}\n$$\nNow, we evaluate this expression at $x = x_{50}$:\n$$\nS_{50} = 100 k \\cdot x_{50}^k \\cdot x_{50}^{-k-1} \\cdot \\left(1 + \\left(\\frac{x_{50}}{x_{50}}\\right)^k\\right)^{-2} \\\\\n= 100 k \\cdot x_{50}^{-1} \\cdot (1 + 1)^{-2} \\\\\n= \\frac{100 k}{x_{50}} \\cdot \\frac{1}{4}\n$$\nThus, the slope at the midpoint is:\n$$\nS_{50} = \\frac{25 k}{x_{50}}\n$$\nThis expression relates the steepness $S_{50}$ (in units of percent per MPa) to the model parameters $x_{50}$ (in MPa) and $k$ (dimensionless).\n\n**Part 2: Parameter Estimation by Linearization**\n\nThe derived model can be linearized to allow for parameter estimation using ordinary least squares (OLS). Starting from the log-odds form:\n$$\n\\ln\\left(\\frac{F(x)}{1 - F(x)}\\right) = k \\cdot \\ln\\left(\\frac{x}{x_{50}}\\right) = k \\ln x - k \\ln x_{50}\n$$\nLet us define the transformed variables:\n$$\nY = \\ln\\left(\\frac{F(x)}{1 - F(x)}\\right) = \\ln\\left(\\frac{\\mathrm{PLC}(x)/100}{1 - \\mathrm{PLC}(x)/100}\\right) = \\ln\\left(\\frac{\\mathrm{PLC}(x)}{100 - \\mathrm{PLC}(x)}\\right)\n$$\n$$\nX = \\ln x\n$$\nWith these transformations, the model becomes a linear equation:\n$$\nY = mX + c\n$$\nThis is an equation of a straight line, $Y = mX + c$, where the slope is $m = k$ and the y-intercept is $c = -k \\ln x_{50}$.\n\nGiven a set of noisy measurements $\\{\\psi_i, \\mathrm{PLC}_i\\}$, we can estimate the parameters $k$ and $x_{50}$ with the following procedure:\n1.  For each data point, convert the water potential $\\psi_i$ (MPa) to absolute tension $x_i = -\\psi_i$ (MPa).\n2.  The log-odds transformation is undefined for $\\mathrm{PLC}$ values of exactly $0$ or $100$. To ensure numerical stability, we clip the measured $\\mathrm{PLC}_i$ values to a small open interval $(\\epsilon, 100-\\epsilon)$. A small value such as $\\epsilon = 10^{-6}$ is appropriate, as it is far smaller than typical measurement error and only affects extreme values, thus preventing divergence without introducing significant bias.\n3.  Calculate the fractional loss of conductivity $P_i = \\mathrm{PLC}_i / 100$.\n4.  Transform the data to the linear space: $X_i = \\ln x_i$ and $Y_i = \\ln(P_i / (1 - P_i))$.\n5.  Perform a linear regression of $Y$ on $X$ to obtain estimates for the slope, $\\hat{m}$, and the intercept, $\\hat{c}$.\n6.  From the regression results, calculate the model parameters:\n    -   $\\hat{k} = \\hat{m}$\n    -   $\\hat{c} = -\\hat{k} \\ln \\hat{x}_{50} \\implies \\ln \\hat{x}_{50} = -\\hat{c}/\\hat{k} \\implies \\hat{x}_{50} = \\exp(-\\hat{c}/\\hat{k})$\n7.  Finally, compute the required output quantities:\n    -   The water potential at $50\\%$ loss of conductivity, $\\mathrm{P50} = -\\hat{x}_{50}$ (in MPa).\n    -   The slope at the midpoint, $S_{50} = \\frac{25 \\hat{k}}{\\hat{x}_{50}}$ (in percent per MPa).\n\nThis complete algorithm is implemented in the following computational solution to analyze the provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and fits a model for xylem vulnerability to cavitation.\n\n    The function implements a method based on linearizing a sigmoidal model\n    of Percent Loss of Conductivity (PLC) vs. xylem tension. It calculates\n    P50 (water potential at 50% PLC) and S50 (the slope of the curve at that point).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"psi\": [-0.5, -1.0, -1.5, -2.0, -2.5, -3.0, -3.5, -4.0, -5.0, -6.0],\n            \"plc\": [0.6, 5.1, 16.3, 32.9, 50.0, 64.2, 74.6, 81.8, 90.2, 94.3]\n        },\n        {\n            \"psi\": [-0.3, -0.5, -0.7, -0.9, -1.1, -1.2, -1.3, -1.5, -1.8, -2.2],\n            \"plc\": [0.0, 0.2, 2.2, 11.8, 35.2, 50.0, 63.6, 82.7, 94.5, 98.6]\n        },\n        {\n            \"psi\": [-0.8, -1.2, -1.8, -2.5, -3.2, -4.0, -4.8, -6.0, -7.5, -9.0],\n            \"plc\": [0.1, 0.4, 2.7, 10.8, 26.8, 50.0, 69.4, 86.1, 94.4, 97.5]\n        }\n    ]\n\n    results = []\n    # Set a small epsilon for clipping PLC values to avoid log(0) or division by zero.\n    epsilon = 1e-6\n\n    for case in test_cases:\n        psi = np.array(case[\"psi\"])\n        plc = np.array(case[\"plc\"])\n\n        # Step 1: Convert water potential psi to absolute tension x.\n        x = -psi\n\n        # Step 2: Clip PLC values to the open interval (epsilon, 100-epsilon).\n        plc_clipped = np.clip(plc, epsilon, 100.0 - epsilon)\n\n        # Step 3: Convert PLC from percent to a fraction P.\n        P = plc_clipped / 100.0\n\n        # Step 4: Transform variables for linear regression.\n        # X = ln(x)\n        # Y = ln(P/(1-P)) which is the log-odds transformation.\n        X = np.log(x)\n        Y = np.log(P / (1.0 - P))\n\n        # Step 5: Perform ordinary least squares (OLS) linear regression.\n        # np.polyfit with degree 1 returns [slope, intercept].\n        m, c = np.polyfit(X, Y, 1)\n\n        # Step 6: Calculate model parameters k (steepness) and x50 from slope (m) and intercept (c).\n        # From the derivation, m = k and c = -k * ln(x50).\n        k = m\n        x50 = np.exp(-c / m)\n\n        # Step 7: Calculate the final required outputs: P50 and S50.\n        # P50 is the water potential (negative) at 50% loss of conductivity.\n        P50 = -x50\n        # S50 is the slope of the PLC curve at x = x50.\n        S50 = (25.0 * k) / x50\n\n        # Round results to 3 decimal places as required.\n        P50_rounded = round(P50, 3)\n        S50_rounded = round(S50, 3)\n        \n        results.append([P50_rounded, S50_rounded])\n\n    # Format the output string to exactly match the required format '[[a,b],[c,d]]'\n    # without extra spaces within the inner lists.\n    sublist_strings = [f\"[{item[0]},{item[1]}]\" for item in results]\n    output_string = f\"[{','.join(sublist_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```", "id": "2555382"}]}