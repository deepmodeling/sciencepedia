{"hands_on_practices": [{"introduction": "Before a plant can interpret photoperiod, its photoreceptors must first quantify the ambient light environment. This practice focuses on this fundamental first step by asking you to calculate the Phytochrome Photostationary State (PSS), which represents the equilibrium ratio of active phytochrome ($P_{\\mathrm{fr}}$) to the total phytochrome pool. By working through this calculation [@problem_id:2599087], you will directly connect the physical properties of light—its spectral composition—to a critical biochemical state that serves as the primary input for photoperiodic timekeeping.", "problem": "A controlled-environment chamber is used to test flowering induction in a vernalized long-day angiosperm. To connect the light regime to the phytochrome-mediated photoperiodic signal, you are asked to compute the Phytochrome Photostationary State (PSS), defined as the steady-state fraction of the far-red-absorbing conformer, denoted by $P_{\\mathrm{fr}}$. Assume a two-state photochemical model of phytochrome in which red-absorbing phytochrome ($\\mathrm{P}_{\\mathrm{r}}$) and far-red-absorbing phytochrome ($\\mathrm{P}_{\\mathrm{fr}}$) interconvert under illumination via wavelength-dependent photoconversion with photoconversion cross-sections $\\sigma_{r}(\\lambda)$ for $\\mathrm{P}_{\\mathrm{r}}\\rightarrow \\mathrm{P}_{\\mathrm{fr}}$ and $\\sigma_{fr}(\\lambda)$ for $\\mathrm{P}_{\\mathrm{fr}}\\rightarrow \\mathrm{P}_{\\mathrm{r}}$. Let the spectral photon irradiance be $E(\\lambda)$ in photons m$^{-2}$ s$^{-1}$ nm$^{-1}$. Neglect thermal reversion and any dark processes.\n\nStarting from mass-action kinetics for a two-state interconversion driven by photon absorption and the definition of steady state for $P_{\\mathrm{fr}}$, derive an expression for $P_{\\mathrm{fr}}$ in terms of $E(\\lambda)$, $\\sigma_{r}(\\lambda)$, and $\\sigma_{fr}(\\lambda)$, and then evaluate it for the following spectrally structured light field that approximates a red plus far-red lighting treatment:\n\n- For $\\lambda \\in [620,680]$ nm (red band): $E(\\lambda)=A_{r}+B_{r}(\\lambda-620)$ with $A_{r}=2.0\\times 10^{16}$ and $B_{r}=-1.0\\times 10^{14}$; $\\sigma_{r}(\\lambda)=1.5\\times 10^{-21}$ m$^{2}$; $\\sigma_{fr}(\\lambda)=1.5\\times 10^{-22}$ m$^{2}$.\n- For $\\lambda \\in [700,740]$ nm (far-red band): $E(\\lambda)=A_{fr}+B_{fr}(\\lambda-700)$ with $A_{fr}=1.2\\times 10^{16}$ and $B_{fr}=5.0\\times 10^{13}$; $\\sigma_{r}(\\lambda)=2.0\\times 10^{-22}$ m$^{2}$; $\\sigma_{fr}(\\lambda)=1.2\\times 10^{-21}$ m$^{2}$.\n- For all other $\\lambda$, $E(\\lambda)=0$ and the cross-sections are negligible.\n\nAll numbers above are given exactly. Compute $P_{\\mathrm{fr}}$ as a unitless decimal and round your final answer to four significant figures.", "solution": "The problem is scientifically grounded, well-posed, and objective. There are no identifiable flaws. A solution will be provided.\n\nThe problem asks for the photostationary state (PSS) of phytochrome, which is defined as the steady-state fraction of the far-red absorbing form, $P_{\\mathrm{fr}}$. Let $[P_r]$ and $[P_{fr}]$ represent the amounts or concentrations of the red-absorbing and far-red-absorbing conformers, respectively. The total amount of phytochrome, $[P_{total}] = [P_r] + [P_{fr}]$, is conserved.\n\nThe interconversion between the two states is driven by photon absorption. According to mass-action kinetics, the rate of change of $[P_{fr}]$ is given by:\n$$\n\\frac{d[P_{fr}]}{dt} = (\\text{rate of } P_r \\to P_{fr}) - (\\text{rate of } P_{fr} \\to P_r)\n$$\nThe rate of photochemical conversion is proportional to the amount of the reactant species, the spectral photon irradiance $E(\\lambda)$, and the photoconversion cross-section. To obtain the total rate constant for each conversion pathway, we must integrate over all wavelengths $\\lambda$.\n\nThe rate of formation of $P_{fr}$ from $P_r$ is:\n$$\n\\text{Rate}_{r \\to fr} = [P_r] \\int_{0}^{\\infty} \\sigma_r(\\lambda) E(\\lambda) d\\lambda = k_r [P_r]\n$$\nwhere $k_r = \\int_{0}^{\\infty} \\sigma_r(\\lambda) E(\\lambda) d\\lambda$ is the first-order rate constant for the $P_r \\to P_{fr}$ conversion.\n\nThe rate of reversion of $P_{fr}$ to $P_r$ is:\n$$\n\\text{Rate}_{fr \\to r} = [P_{fr}] \\int_{0}^{\\infty} \\sigma_{fr}(\\lambda) E(\\lambda) d\\lambda = k_{fr} [P_{fr}]\n$$\nwhere $k_{fr} = \\int_{0}^{\\infty} \\sigma_{fr}(\\lambda) E(\\lambda) d\\lambda$ is the first-order rate constant for the $P_{fr} \\to P_r$ conversion.\n\nThe kinetic equation is thus:\n$$\n\\frac{d[P_{fr}]}{dt} = k_r [P_r] - k_{fr} [P_{fr}]\n$$\nAt steady state (the photostationary state), $\\frac{d[P_{fr}]}{dt} = 0$. Let $[P_r]_{ss}$ and $[P_{fr}]_{ss}$ be the steady-state amounts.\n$$\nk_r [P_r]_{ss} = k_{fr} [P_{fr}]_{ss}\n$$\nUsing the conservation relation $[P_r]_{ss} = [P_{total}] - [P_{fr}]_{ss}$, we substitute this into the steady-state equation:\n$$\nk_r ([P_{total}] - [P_{fr}]_{ss}) = k_{fr} [P_{fr}]_{ss}\n$$\n$$\nk_r [P_{total}] = (k_r + k_{fr}) [P_{fr}]_{ss}\n$$\nThe PSS is the fraction $\\frac{[P_{fr}]_{ss}}{[P_{total}]}$. The problem statement denotes this fraction by $P_{\\mathrm{fr}}$.\n$$\nP_{\\mathrm{fr}} = \\frac{k_r}{k_r + k_{fr}}\n$$\nSubstituting the integral expressions for the rate constants:\n$$\nP_{\\mathrm{fr}} = \\frac{\\int_{0}^{\\infty} \\sigma_r(\\lambda) E(\\lambda) d\\lambda}{\\int_{0}^{\\infty} \\sigma_r(\\lambda) E(\\lambda) d\\lambda + \\int_{0}^{\\infty} \\sigma_{fr}(\\lambda) E(\\lambda) d\\lambda} = \\frac{\\int_{0}^{\\infty} \\sigma_r(\\lambda) E(\\lambda) d\\lambda}{\\int_{0}^{\\infty} (\\sigma_r(\\lambda) + \\sigma_{fr}(\\lambda)) E(\\lambda) d\\lambda}\n$$\nWe now evaluate the integrals for the given spectral irradiance $E(\\lambda)$ and cross-sections $\\sigma(\\lambda)$. The irradiance is non-zero only in two bands, so the integrals become sums over these bands.\n\nLet $I_R = \\int_{620}^{680} E(\\lambda) d\\lambda$ be the total photon flux in the red band and $I_{FR} = \\int_{700}^{740} E(\\lambda) d\\lambda$ in the far-red band. Since the cross-sections are given as constant within each band, the rate constants are:\n$$\nk_r = \\sigma_{r,R} I_R + \\sigma_{r,FR} I_{FR}\n$$\n$$\nk_{fr} = \\sigma_{fr,R} I_R + \\sigma_{fr,FR} I_{FR}\n$$\n\nFirst, we calculate the integrated photon flux for the red band, $\\lambda \\in [620, 680]$ nm:\n$E(\\lambda)=A_{r}+B_{r}(\\lambda-620)$, with $A_{r}=2.0\\times 10^{16}$ and $B_{r}=-1.0\\times 10^{14}$.\nLet $u = \\lambda - 620$. The integration limits are $u=0$ to $u=60$.\n$$\nI_R = \\int_{0}^{60} (A_r + B_r u) du = \\left[ A_r u + \\frac{B_r u^2}{2} \\right]_{0}^{60} = A_r(60) + B_r \\frac{60^2}{2}\n$$\n$$\nI_R = (2.0 \\times 10^{16})(60) + (-1.0 \\times 10^{14})(1800) = 1.2 \\times 10^{18} - 0.18 \\times 10^{18} = 1.02 \\times 10^{18} \\text{ photons m}^{-2} \\text{s}^{-1}\n$$\n\nNext, we calculate the integrated photon flux for the far-red band, $\\lambda \\in [700, 740]$ nm:\n$E(\\lambda)=A_{fr}+B_{fr}(\\lambda-700)$, with $A_{fr}=1.2\\times 10^{16}$ and $B_{fr}=5.0\\times 10^{13}$.\nLet $v = \\lambda - 700$. The integration limits are $v=0$ to $v=40$.\n$$\nI_{FR} = \\int_{0}^{40} (A_{fr} + B_{fr} v) dv = \\left[ A_{fr} v + \\frac{B_{fr} v^2}{2} \\right]_{0}^{40} = A_{fr}(40) + B_{fr} \\frac{40^2}{2}\n$$\n$$\nI_{FR} = (1.2 \\times 10^{16})(40) + (5.0 \\times 10^{13})(800) = 4.8 \\times 10^{17} + 0.4 \\times 10^{17} = 5.2 \\times 10^{17} \\text{ photons m}^{-2} \\text{s}^{-1}\n$$\n\nNow, we calculate the rate constants.\nGiven cross-sections:\nRed band $(\\lambda \\in [620,680]\\text{ nm})$: $\\sigma_{r,R} = 1.5 \\times 10^{-21} \\text{ m}^2$, $\\sigma_{fr,R} = 1.5 \\times 10^{-22} \\text{ m}^2$.\nFar-red band $(\\lambda \\in [700,740]\\text{ nm})$: $\\sigma_{r,FR} = 2.0 \\times 10^{-22} \\text{ m}^2$, $\\sigma_{fr,FR} = 1.2 \\times 10^{-21} \\text{ m}^2$.\n\nContribution to $k_r$ from the red band:\n$$\nk_{r,R} = \\sigma_{r,R} I_R = (1.5 \\times 10^{-21}) (1.02 \\times 10^{18}) = 1.53 \\times 10^{-3} \\text{ s}^{-1}\n$$\nContribution to $k_r$ from the far-red band:\n$$\nk_{r,FR} = \\sigma_{r,FR} I_{FR} = (2.0 \\times 10^{-22}) (5.2 \\times 10^{17}) = 1.04 \\times 10^{-4} \\text{ s}^{-1}\n$$\nTotal rate constant $k_r$:\n$$\nk_r = k_{r,R} + k_{r,FR} = 1.53 \\times 10^{-3} + 1.04 \\times 10^{-4} = 1.53 \\times 10^{-3} + 0.104 \\times 10^{-3} = 1.634 \\times 10^{-3} \\text{ s}^{-1}\n$$\n\nContribution to $k_{fr}$ from the red band:\n$$\nk_{fr,R} = \\sigma_{fr,R} I_R = (1.5 \\times 10^{-22}) (1.02 \\times 10^{18}) = 1.53 \\times 10^{-4} \\text{ s}^{-1}\n$$\nContribution to $k_{fr}$ from the far-red band:\n$$\nk_{fr,FR} = \\sigma_{fr,FR} I_{FR} = (1.2 \\times 10^{-21}) (5.2 \\times 10^{17}) = 6.24 \\times 10^{-4} \\text{ s}^{-1}\n$$\nTotal rate constant $k_{fr}$:\n$$\nk_{fr} = k_{fr,R} + k_{fr,FR} = 1.53 \\times 10^{-4} + 6.24 \\times 10^{-4} = 7.77 \\times 10^{-4} \\text{ s}^{-1}\n$$\n\nFinally, we compute the PSS, $P_{\\mathrm{fr}}$:\n$$\nP_{\\mathrm{fr}} = \\frac{k_r}{k_r + k_{fr}} = \\frac{1.634 \\times 10^{-3}}{1.634 \\times 10^{-3} + 7.77 \\times 10^{-4}} = \\frac{1.634 \\times 10^{-3}}{1.634 \\times 10^{-3} + 0.777 \\times 10^{-3}}\n$$\n$$\nP_{\\mathrm{fr}} = \\frac{1.634 \\times 10^{-3}}{2.411 \\times 10^{-3}} = \\frac{1.634}{2.411} \\approx 0.67772708...\n$$\nRounding to four significant figures, we get $0.6777$.", "answer": "$$\n\\boxed{0.6777}\n$$", "id": "2599087"}, {"introduction": "Once the phytochrome system has established a photostationary state, the plant must interpret this signal in the context of its internal circadian clock. This exercise provides a hands-on application of the \"External Coincidence Model,\" a cornerstone of photoperiodism, by translating it into a quantitative framework. You will model the interaction between a light signal and a circadian \"gate\" of sensitivity to derive and calculate the critical daylength for flowering induction [@problem_id:2598994], offering a concrete understanding of how plants measure the length of the day.", "problem": "In long-day plants, the External Coincidence model posits that transcriptional activation of FLOWERING LOCUS T (FT) occurs when a light-dependent photoreceptor signal (for example, phytochrome in its biologically active form) coincides with a circadian-phase gate that permits CONSTANS (CO) accumulation. Consider a phenomenological gate function $g(t)$ that describes the circadian permissive phase for FT activation, where $t$ is Zeitgeber Time (ZT, hours from dawn), and a light schedule $L(t)$ that is a step function with $L(t)=1$ during the photoperiod and $L(t)=0$ otherwise.\n\nAssume the following:\n- The gate is a Gaussian of unit amplitude centered at $\\mu = 16\\,\\mathrm{h}$ with standard deviation $\\sigma = 3\\,\\mathrm{h}$,\n  $$g(t) = \\exp\\!\\left(-\\frac{(t-\\mu)^{2}}{2\\sigma^{2}}\\right).$$\n- The light schedule is $L(t)=1$ for $t \\in [0,D)$ and $L(t)=0$ for $t \\in [D,24)$, where $D$ is the daylength in hours.\n- The daily FT-inducing signal is the overlap integral\n  $$S(D) = \\int_{0}^{24} g(t)\\,L(t)\\,dt = \\int_{0}^{D} g(t)\\,dt.$$\n- Define the “critical daylength” $D_{c}$ as the unique $D$ satisfying $S(D_{c}) = \\frac{1}{2}S_{\\max}$, where $S_{\\max} \\equiv \\int_{0}^{24} g(t)\\,dt$ is the overlap under continuous light across the $24\\,\\mathrm{h}$ cycle.\n- Assume that contributions of the Gaussian gate from adjacent circadian cycles across the $t=0$ and $t=24$ boundaries are negligible relative to the main lobe at $t=\\mu$ under the given $\\sigma$; this is justified by the rapid Gaussian decay over $\\sim 8\\,\\mathrm{h}$ beyond the center.\n\nStarting from these assumptions and using only standard properties of Gaussian integrals, derive an analytic expression for $D_{c}$ and compute its numerical value. Express your final answer for $D_{c}$ in hours and round your answer to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a simplified but valid phenomenological model from plant photoperiodism, using standard mathematical functions and definitions. All necessary data are provided. We proceed with the derivation.\n\nThe objective is to find the critical daylength $D_c$ that satisfies the condition $S(D_c) = \\frac{1}{2}S_{\\max}$. The daily FT-inducing signal $S(D)$ is given by the integral:\n$$S(D) = \\int_{0}^{D} g(t)\\,dt = \\int_{0}^{D} \\exp\\left(-\\frac{(t-\\mu)^{2}}{2\\sigma^{2}}\\right) dt$$\nThe maximum signal, $S_{\\max}$, is the signal accumulated over the entire $24$-hour cycle, which corresponds to $D=24$:\n$$S_{\\max} = S(24) = \\int_{0}^{24} \\exp\\left(-\\frac{(t-\\mu)^{2}}{2\\sigma^{2}}\\right) dt$$\nThe integral of a Gaussian function does not have an elementary antiderivative. It is expressed in terms of the error function, $\\mathrm{erf}(x)$, or more conveniently for this problem, the standard normal cumulative distribution function (CDF), $\\Phi(z)$. The standard normal CDF is defined as:\n$$\\Phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{z} \\exp\\left(-\\frac{x^2}{2}\\right) dx$$\nTo relate our integral to $\\Phi(z)$, we perform a change of variables. Let $z = \\frac{t-\\mu}{\\sigma}$. Then $t = \\sigma z + \\mu$, and $dt = \\sigma\\,dz$.\nThe limits of integration for $S(D)$ change from $t=0$ and $t=D$ to $z_0 = \\frac{0-\\mu}{\\sigma}$ and $z_D = \\frac{D-\\mu}{\\sigma}$. The integral for $S(D)$ becomes:\n$$S(D) = \\int_{(-\\mu)/\\sigma}^{(D-\\mu)/\\sigma} \\exp\\left(-\\frac{z^2}{2}\\right) (\\sigma\\,dz) = \\sigma \\int_{(-\\mu)/\\sigma}^{(D-\\mu)/\\sigma} \\exp\\left(-\\frac{z^2}{2}\\right) dz$$\nBy the definition of the CDF, $\\int_a^b \\frac{1}{\\sqrt{2\\pi}}e^{-x^2/2} dx = \\Phi(b) - \\Phi(a)$. Therefore, $\\int_a^b e^{-x^2/2} dx = \\sqrt{2\\pi}(\\Phi(b)-\\Phi(a))$.\nApplying this property, $S(D)$ can be written as:\n$$S(D) = \\sigma\\sqrt{2\\pi} \\left[ \\Phi\\left(\\frac{D-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right]$$\nSimilarly, $S_{\\max}$ is given by:\n$$S_{\\max} = \\sigma\\sqrt{2\\pi} \\left[ \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right]$$\nThe condition for the critical daylength is $S(D_c) = \\frac{1}{2}S_{\\max}$. Substituting the expressions for $S(D_c)$ and $S_{\\max}$:\n$$\\sigma\\sqrt{2\\pi} \\left[ \\Phi\\left(\\frac{D_c-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right] = \\frac{1}{2} \\sigma\\sqrt{2\\pi} \\left[ \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right]$$\nThe factor $\\sigma\\sqrt{2\\pi}$ cancels from both sides:\n$$\\Phi\\left(\\frac{D_c-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) = \\frac{1}{2} \\left[ \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right]$$\nWe solve for $\\Phi\\left(\\frac{D_c-\\mu}{\\sigma}\\right)$:\n$$\\Phi\\left(\\frac{D_c-\\mu}{\\sigma}\\right) = \\frac{1}{2} \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) - \\frac{1}{2} \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) + \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right)$$\n$$\\Phi\\left(\\frac{D_c-\\mu}{\\sigma}\\right) = \\frac{1}{2} \\left[ \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) + \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right]$$\nTo find $D_c$, we take the inverse standard normal CDF, $\\Phi^{-1}$:\n$$\\frac{D_c-\\mu}{\\sigma} = \\Phi^{-1}\\left( \\frac{1}{2} \\left[ \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) + \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right] \\right)$$\nThis gives the final analytic expression for $D_c$:\n$$D_c = \\mu + \\sigma \\Phi^{-1}\\left( \\frac{1}{2} \\left[ \\Phi\\left(\\frac{24-\\mu}{\\sigma}\\right) + \\Phi\\left(\\frac{-\\mu}{\\sigma}\\right) \\right] \\right)$$\nNow we substitute the numerical values provided: $\\mu = 16\\,\\mathrm{h}$ and $\\sigma = 3\\,\\mathrm{h}$.\nFirst, we calculate the arguments of the $\\Phi$ function:\n$$\\frac{24-\\mu}{\\sigma} = \\frac{24-16}{3} = \\frac{8}{3}$$\n$$\\frac{-\\mu}{\\sigma} = \\frac{-16}{3}$$\nNext, we evaluate the CDF at these points:\n$$\\Phi\\left(\\frac{8}{3}\\right) \\approx \\Phi(2.6667) \\approx 0.996168$$\n$$\\Phi\\left(\\frac{-16}{3}\\right) \\approx \\Phi(-5.3333) \\approx 4.791 \\times 10^{-8}$$\nThe argument for the inverse CDF is:\n$$\\frac{1}{2} \\left[ \\Phi\\left(\\frac{8}{3}\\right) + \\Phi\\left(\\frac{-16}{3}\\right) \\right] \\approx \\frac{1}{2} \\left( 0.996168 + 4.791 \\times 10^{-8} \\right) \\approx 0.498084$$\nNow we compute the inverse CDF of this value:\n$$z = \\Phi^{-1}(0.498084) \\approx -0.004803$$\nFinally, we calculate $D_c$:\n$$D_c = 16 + 3 \\times (-0.004803) = 16 - 0.014409 = 15.985591$$\nRounding the result to four significant figures gives $15.99$. This result is logical: because the integration interval $[0, 24]$ cuts off more of the Gaussian's right tail (from $t=24$ to $\\infty$) than its left tail (from $-\\infty$ to $t=0$), the midpoint of the captured area is shifted slightly to the left of the peak, $\\mu = 16$.", "answer": "$$\\boxed{15.99}$$", "id": "2598994"}, {"introduction": "This final practice integrates the preceding concepts into a dynamic, systems-level simulation, moving from static calculations to predictive modeling. You will construct a complete model of the flowering induction pathway, coupling phytochrome kinetics with a circadian gate and a downstream integrator that culminates in a flowering decision. By simulating the system's response to various classic experimental light schedules, such as night-breaks and skeleton photoperiods [@problem_id:2599064], you will gain practical experience in computational plant biology and develop a deeper intuition for the logic and robustness of the photoperiodic control circuit.", "problem": "A flowering induction decision in photoperiodic plants can be represented using a minimal dynamical system that couples a phytochrome state variable with a circadian gating window and an integrative flowering signal. Consider a dimensionless fraction of active phytochrome in the far-red absorbing state, denoted by $p(t) \\in [0,1]$, that evolves under a light drive $L(t) \\in [0,1]$ according to the ordinary differential equation\n$$\n\\frac{dp}{dt} = k_{\\ell}\\,\\big(1 - p(t)\\big)\\,L(t) - k_{d}\\,p(t),\n$$\nwhere $k_{\\ell} > 0$ is the light-driven conversion rate and $k_{d} > 0$ is the dark reversion rate. The light drive $L(t)$ is a piecewise-constant function over each day-night cycle of duration $T=\\;24$ hours, with possible short pulses (“night-breaks” or “skeleton photoperiods”). The circadian gate $g(t)$ is a binary function that is $1$ during a fixed daily window of duration $w$ hours, offset from dawn by a phase $\\phi$ hours, and $0$ otherwise:\n$$\ng(t) = \\begin{cases}\n1, & \\text{if } (t \\bmod 24) \\in [\\phi,\\;\\phi + w),\\\\\n0, & \\text{otherwise.}\n\\end{cases}\n$$\nThe flowering integrator $F(t) \\ge 0$ obeys the first-order linear differential equation\n$$\n\\frac{dF}{dt} = \\alpha\\,S(t) - \\beta\\,F(t),\n$$\nwhere $\\alpha > 0$ and $\\beta > 0$ are constants, and $S(t)$ is a coincidence source that depends on plant type and the states $p(t)$ and $g(t)$. For a long-day plant (LD), induction requires light-driven phytochrome activation during the gate, modeled as\n$$\nS_{\\text{LD}}(t) = H\\big(p(t) - \\theta_p\\big)\\,g(t),\n$$\nand for a short-day plant (SD), induction requires darkness during the gate, modeled as\n$$\nS_{\\text{SD}}(t) = H\\big(\\theta_p - p(t)\\big)\\,g(t),\n$$\nwhere $H(x)$ is the Heaviside step function with $H(x)=1$ for $x&gt;0$ and $H(x)=0$ otherwise, and $\\theta_p \\in (0,1)$ is a fixed threshold. The system starts from $p(0)=0$ and $F(0)=0$. All times must be treated in hours.\n\nTo assess robustness to intensity noise, the effective light drive is\n$$\nL_{\\text{eff}}(t) = \\operatorname{clip}\\big(L_{\\text{base}}(t) + A\\,\\xi(t),\\,0,\\,1\\big),\n$$\nwhere $L_{\\text{base}}(t)\\in\\{0,1\\}$ is the deterministic schedule, $A \\ge 0$ is the noise amplitude, $\\xi(t)$ is an independent and identically distributed random variable drawn at each time step from a uniform distribution on $[-1,1]$, and $\\operatorname{clip}(\\cdot)$ saturates to the interval $[0,1]$. The ordinary differential equation for $p(t)$ uses $L_{\\text{eff}}(t)$ as its input. The decision “flowered” is defined by comparing the time-average of $F(t)$ over the last day, $\\overline{F}$, to a type-specific threshold:\n$$\n\\overline{F} = \\frac{1}{24}\\int_{t_{\\text{end}}-24}^{t_{\\text{end}}} F(t)\\,dt,\\quad\n\\text{flowered}=\\begin{cases}\n\\text{True}, & \\text{if } \\overline{F} \\ge \\Theta_{\\text{LD}} \\text{ for LD},\\\\\n\\text{True}, & \\text{if } \\overline{F} \\ge \\Theta_{\\text{SD}} \\text{ for SD},\\\\\n\\text{False}, & \\text{otherwise.}\n\\end{cases}\n$$\n\nImplement a numerical simulation using the explicit Euler method with fixed time step $\\Delta t$, over $N$ days, with the parameter values\n- $k_{\\ell} = 2.0\\ \\text{h}^{-1}$, $k_{d} = 0.5\\ \\text{h}^{-1}$,\n- $\\alpha = 0.1\\ \\text{h}^{-1}$, $\\beta = 0.01\\ \\text{h}^{-1}$,\n- $\\theta_p = 0.6$,\n- $\\phi = 13.0\\ \\text{h}$, $w = 4.0\\ \\text{h}$,\n- $\\Theta_{\\text{LD}} = 0.3$, $\\Theta_{\\text{SD}} = 1.3$,\n- $\\Delta t = 0.02\\ \\text{h}$, $N = 40$.\n\nConstruct $L_{\\text{base}}(t)$ over each $24$-hour day from the following schedules:\n- A standard photoperiod with day length $D$ hours: $L_{\\text{base}}(t) = 1$ if $(t \\bmod 24) \\in [0,D)$ and $0$ otherwise.\n- A night-break schedule augments the standard $D$-hour day by setting $L_{\\text{base}}(t)=1$ on an additional pulse interval $[t_p,\\,t_p + d_p)$ located in the dark portion.\n- A skeleton photoperiod sets $D=0$ and uses two brief light pulses to mimic dawn and dusk: $L_{\\text{base}}(t)=1$ on both intervals $[t_1,\\,t_1+d_1)$ and $[t_2,\\,t_2+d_2)$, otherwise $0$.\n\nUse the following test suite of nine cases, each specified by plant type, schedule type, base parameters for $L_{\\text{base}}$, and noise amplitude $A$:\n1. Long-day plant, standard $D=8$, no noise: $(\\text{LD}, \\text{standard}, D=8, A=0.0)$.\n2. Long-day plant, standard $D=16$, no noise: $(\\text{LD}, \\text{standard}, D=16, A=0.0)$.\n3. Long-day plant, night-break on short day: $(\\text{LD}, \\text{nightbreak}, D=8, t_p=16, d_p=1, A=0.0)$.\n4. Long-day plant, skeleton photoperiod: $(\\text{LD}, \\text{skeleton}, D=0, (t_1,d_1)=(0,1), (t_2,d_2)=(16,1), A=0.0)$.\n5. Long-day plant, night-break with noise: $(\\text{LD}, \\text{nightbreak}, D=8, t_p=16, d_p=1, A=0.2)$.\n6. Short-day plant, standard $D=8$, no noise: $(\\text{SD}, \\text{standard}, D=8, A=0.0)$.\n7. Short-day plant, night-break on short day: $(\\text{SD}, \\text{nightbreak}, D=8, t_p=16, d_p=1, A=0.0)$.\n8. Short-day plant, skeleton photoperiod: $(\\text{SD}, \\text{skeleton}, D=0, (t_1,d_1)=(0,1), (t_2,d_2)=(16,1), A=0.0)$.\n9. Short-day plant, standard $D=8$ with noise: $(\\text{SD}, \\text{standard}, D=8, A=0.2)$.\n\nYour program must simulate each case independently using the same random seed for noise realization across all noisy cases to ensure reproducibility. Angle units are not applicable. All time quantities must be in hours. The final output must be a single line containing the nine boolean results in order as a comma-separated list enclosed in square brackets (e.g., \"[True,False,...]\").", "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n\n-   **Phytochrome dynamics**: $\\frac{dp}{dt} = k_{\\ell}\\,\\big(1 - p(t)\\big)\\,L(t) - k_{d}\\,p(t)$, with $p(t) \\in [0,1]$.\n-   **Flowering integrator dynamics**: $\\frac{dF}{dt} = \\alpha\\,S(t) - \\beta\\,F(t)$, with $F(t) \\ge 0$.\n-   **Initial Conditions**: $p(0)=0$, $F(0)=0$.\n-   **Light Drive**: $L(t)$ is replaced by $L_{\\text{eff}}(t) = \\operatorname{clip}\\big(L_{\\text{base}}(t) + A\\,\\xi(t),\\,0,\\,1\\big)$, where $\\xi(t) \\sim U[-1,1]$.\n-   **Circadian Gate**: $g(t) = 1$ for $(t \\bmod 24) \\in [\\phi,\\;\\phi + w)$, and $0$ otherwise.\n-   **Coincidence Source**:\n    -   Long-Day (LD): $S_{\\text{LD}}(t) = H\\big(p(t) - \\theta_p\\big)\\,g(t)$.\n    -   Short-Day (SD): $S_{\\text{SD}}(t) = H\\big(\\theta_p - p(t)\\big)\\,g(t)$.\n-   **Heaviside Function**: $H(x)=1$ for $x>0$, $H(x)=0$ for $x \\le 0$.\n-   **Flowering Decision**: Based on $\\overline{F} = \\frac{1}{24}\\int_{t_{\\text{end}}-24}^{t_{\\text{end}}} F(t)\\,dt$. Flowered is True if $\\overline{F} \\ge \\Theta_{\\text{LD}}$ (for LD) or $\\overline{F} \\ge \\Theta_{\\text{SD}}$ (for SD).\n-   **Numerical Method**: Explicit Euler with time step $\\Delta t$.\n-   **Parameter Values**:\n    -   $k_{\\ell} = 2.0\\ \\text{h}^{-1}$, $k_{d} = 0.5\\ \\text{h}^{-1}$.\n    -   $\\alpha = 0.1\\ \\text{h}^{-1}$, $\\beta = 0.01\\ \\text{h}^{-1}$.\n    -   $\\theta_p = 0.6$.\n    -   $\\phi = 13.0\\ \\text{h}$, $w = 4.0\\ \\text{h}$.\n    -   $\\Theta_{\\text{LD}} = 0.3$, $\\Theta_{\\text{SD}} = 1.3$.\n    -   $\\Delta t = 0.02\\ \\text{h}$, $N = 40$ days.\n-   **Light Schedules $L_{\\text{base}}(t)$**: Standard, Night-break, Skeleton, specified for nine test cases with plant type and noise amplitude $A$.\n-   **Reproducibility**: Use a fixed random seed for all simulations involving noise.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n1.  **Scientifically Grounded**: The problem presents a simplified but standard \"external coincidence\" model of plant photoperiodism, a valid and well-established concept in chronobiology. The equations represent first-order kinetics, which is a sound physical basis. The model is scientifically grounded.\n2.  **Well-Posed**: The problem defines a system of coupled first-order ordinary differential equations with specified initial conditions, parameters, and forcing functions. The numerical integration method is specified. A unique solution is therefore computable. The problem is well-posed.\n3.  **Objective**: All descriptions are quantitative and based on established mathematical and biological formalism. No subjective or opinion-based statements are present.\n4.  **Complete, Consistent, and Unambiguous**: All necessary parameters and conditions are provided. The functions are defined unambiguously. The request to use \"the same random seed for noise realization across all noisy cases\" is a directive for implementation that ensures reproducibility. The problem is self-contained and consistent.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is a well-defined computational problem grounded in an established scientific model. A solution will be provided.\n\n### Solution\n\nThe problem requires the numerical simulation of a dynamical system modeling flowering induction in plants. The system consists of two coupled first-order ordinary differential equations (ODEs), one for the phytochrome state $p(t)$ and one for the flowering integrator $F(t)$. These are solved numerically using the explicit Euler method.\n\nThe state equations are:\n$$\n\\frac{dp}{dt} = k_{\\ell}\\,\\big(1 - p(t)\\big)\\,L_{\\text{eff}}(t) - k_{d}\\,p(t)\n$$\n$$\n\\frac{dF}{dt} = \\alpha\\,S(t) - \\beta\\,F(t)\n$$\n\nThe explicit Euler method discretizes these ODEs with a time step $\\Delta t$. For a variable $y(t)$ with derivative $y'(t) = f(y, t)$, the update rule is $y_{i+1} = y_i + f(y_i, t_i) \\Delta t$, where $y_i \\approx y(t_i)$ and $t_i = i \\Delta t$. Applying this to our system:\n$$\np_{i+1} = p_i + \\left[ k_{\\ell}\\,\\big(1 - p_i\\big)\\,L_{\\text{eff},i} - k_{d}\\,p_i \\right] \\Delta t\n$$\n$$\nF_{i+1} = F_i + \\left[ \\alpha\\,S_i - \\beta\\,F_i \\right] \\Delta t\n$$\nwhere $L_{\\text{eff},i}$ and $S_i$ are the values of the effective light drive and the source term at time step $i$. The simulation starts with initial conditions $p_0=0$ and $F_0=0$ and runs for $N=40$ days, which corresponds to a total time of $T_{\\text{end}} = 40 \\times 24 = 960$ hours. The total number of steps is $N_{\\text{steps}} = T_{\\text{end}} / \\Delta t$.\n\nThe implementation requires a main loop that iterates over the nine specified test cases. For each case, a nested loop performs the time-stepping simulation.\n\n1.  **Light Drive and Noise**: At each time step $t_i$, the base light level $L_{\\text{base},i}$ is determined based on the case's schedule type ('standard', 'nightbreak', or 'skeleton') and its parameters. The time of day, $t_i \\pmod{24}$, dictates whether light is on or off. For cases with noise ($A>0$), a random number $\\xi_i$ is drawn from a uniform distribution on $[-1,1]$, and the effective light drive is calculated as $L_{\\text{eff},i} = \\operatorname{clip}\\big(L_{\\text{base},i} + A\\,\\xi_i,\\,0,\\,1\\big)$. For cases with no noise ($A=0$), $L_{\\text{eff},i} = L_{\\text{base},i}$. To ensure reproducibility across noisy simulations, the random number generator is re-initialized with the same seed before each noisy case simulation begins.\n\n2.  **Gating and Source Term**: The circadian gate $g_i$ is active ($g_i=1$) if $t_i \\pmod{24}$ is within the interval $[\\phi, \\phi+w)$. The coincidence source term $S_i$ depends on the plant type (LD or SD), the phytochrome level $p_i$, and the gate state $g_i$.\n    -   For a Long-Day plant: $S_i=1$ if $p_i > \\theta_p$ and $g_i=1$; otherwise $S_i=0$.\n    -   For a Short-Day plant: $S_i=1$ if $p_i < \\theta_p$ and $g_i=1$; otherwise $S_i=0$.\n    This logic directly implements the Heaviside step functions as defined.\n\n3.  **Flowering Decision**: After completing the simulation over $N=40$ days, the model's prediction for flowering is determined. This requires computing the time-average of the flowering integrator, $\\overline{F}$, over the final $24$-hour period. Numerically, this integral is approximated by taking the mean of the stored values of $F_i$ over the time steps corresponding to the last day of the simulation.\n$$\n\\overline{F} \\approx \\text{mean}( \\{ F_i \\}_{i \\in \\text{last day}} )\n$$\nThe number of steps in one day is $24 / \\Delta t$. The resulting $\\overline{F}$ is then compared to the type-specific threshold, $\\Theta_{\\text{LD}}$ or $\\Theta_{\\text{SD}}$, to yield a boolean 'flowered' decision.\n\nThe entire process is automated in a Python script. Each of the nine test cases is simulated independently, and the final boolean results are collected and printed in the specified format. The use of NumPy allows for efficient array operations and numerical calculations.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a photoperiodic flowering model for various plant types and light schedules.\n    \"\"\"\n    # Define model parameters as given in the problem statement\n    k_l = 2.0  # h^-1\n    k_d = 0.5  # h^-1\n    alpha = 0.1  # h^-1\n    beta = 0.01  # h^-1\n    theta_p = 0.6\n    phi = 13.0  # h\n    w = 4.0   # h\n    Theta_LD = 0.3\n    Theta_SD = 1.3\n    dt = 0.02  # h\n    N_days = 40\n\n    # Define the 9 test cases\n    test_cases = [\n        # 1. LD, standard short day\n        ('LD', 'standard', {'D': 8}, 0.0),\n        # 2. LD, standard long day\n        ('LD', 'standard', {'D': 16}, 0.0),\n        # 3. LD, night-break on short day\n        ('LD', 'nightbreak', {'D': 8, 'tp': 16, 'dp': 1}, 0.0),\n        # 4. LD, skeleton photoperiod\n        ('LD', 'skeleton', {'t1_d1': (0, 1), 't2_d2': (16, 1)}, 0.0),\n        # 5. LD, night-break with noise\n        ('LD', 'nightbreak', {'D': 8, 'tp': 16, 'dp': 1}, 0.2),\n        # 6. SD, standard short day\n        ('SD', 'standard', {'D': 8}, 0.0),\n        # 7. SD, night-break on short day\n        ('SD', 'nightbreak', {'D': 8, 'tp': 16, 'dp': 1}, 0.0),\n        # 8. SD, skeleton photoperiod\n        ('SD', 'skeleton', {'t1_d1': (0, 1), 't2_d2': (16, 1)}, 0.0),\n        # 9. SD, standard short day with noise\n        ('SD', 'standard', {'D': 8}, 0.2),\n    ]\n\n    results = []\n    # Fixed seed for reproducibility of noisy simulations\n    random_seed = 0\n\n    for case in test_cases:\n        plant_type, schedule_type, schedule_params, A = case\n\n        # Reset seed for each noisy case to ensure same noise realization\n        if A > 0:\n            np.random.seed(random_seed)\n\n        # Simulation setup\n        T_day = 24.0\n        T_total = N_days * T_day\n        num_steps = int(T_total / dt)\n\n        # Initialize state variables and history storage\n        p = 0.0\n        F = 0.0\n        F_hist = np.zeros(num_steps + 1)\n        F_hist[0] = F\n\n        # Main simulation loop using Explicit Euler\n        for i in range(num_steps):\n            t = i * dt\n            t_mod_24 = t % T_day\n\n            # 1. Determine base light schedule L_base(t)\n            L_base = 0.0\n            if schedule_type == 'standard':\n                D = schedule_params['D']\n                if t_mod_24  D:\n                    L_base = 1.0\n            elif schedule_type == 'nightbreak':\n                D = schedule_params['D']\n                tp, dp = schedule_params['tp'], schedule_params['dp']\n                if t_mod_24  D or (t_mod_24 >= tp and t_mod_24  tp + dp):\n                    L_base = 1.0\n            elif schedule_type == 'skeleton':\n                t1, d1 = schedule_params['t1_d1']\n                t2, d2 = schedule_params['t2_d2']\n                if (t_mod_24 >= t1 and t_mod_24  t1 + d1) or \\\n                   (t_mod_24 >= t2 and t_mod_24  t2 + d2):\n                    L_base = 1.0\n\n            # 2. Calculate effective light L_eff(t) with noise\n            L_eff = L_base\n            if A > 0:\n                xi = np.random.uniform(-1.0, 1.0)\n                L_eff = np.clip(L_base + A * xi, 0.0, 1.0)\n\n            # 3. Determine circadian gate state g(t)\n            g = 1.0 if (t_mod_24 >= phi and t_mod_24  phi + w) else 0.0\n\n            # 4. Calculate coincidence source term S(t)\n            S = 0.0\n            if plant_type == 'LD':\n                if p > theta_p:  # Implements H(p - theta_p)\n                    S = 1.0 * g\n            elif plant_type == 'SD':\n                if p  theta_p:  # Implements H(theta_p - p)\n                    S = 1.0 * g\n\n            # 5. Perform Euler step for p and F\n            dp_dt = k_l * (1.0 - p) * L_eff - k_d * p\n            dF_dt = alpha * S - beta * F\n\n            p = p + dp_dt * dt\n            F = F + dF_dt * dt\n            F_hist[i + 1] = F\n\n        # 6. Calculate average F over the last day\n        steps_per_day = int(T_day / dt)\n        last_day_F_hist = F_hist[-steps_per_day:]\n        F_avg = np.mean(last_day_F_hist)\n\n        # 7. Make flowering decision\n        flowered = False\n        if plant_type == 'LD':\n            if F_avg >= Theta_LD:\n                flowered = True\n        elif plant_type == 'SD':\n            if F_avg >= Theta_SD:\n                flowered = True\n        \n        results.append(flowered)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2599064"}]}