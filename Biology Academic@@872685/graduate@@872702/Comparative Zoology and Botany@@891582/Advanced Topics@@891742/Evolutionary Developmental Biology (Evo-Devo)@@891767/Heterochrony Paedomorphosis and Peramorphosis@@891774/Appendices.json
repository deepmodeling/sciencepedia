{"hands_on_practices": [{"introduction": "To build a quantitative understanding of heterochrony, we begin with a foundational exercise using a simplified linear growth model. This practice focuses on isolating a single developmental parameter—the timing of growth termination—to see its direct effect on adult morphology. By calculating the change in trait size resulting from an extended growth period, you will solidify your grasp of hypermorphosis, a key mechanism of peramorphosis [@problem_id:2580467].", "problem": "In comparative zoology and botany, heterochrony refers to evolutionary change in the timing or rate of developmental processes that produces morphological divergence between ancestor and descendant. Consider a single morphological trait whose ontogenetic trajectory is well-approximated by a constant-rate growth model, which is a standard approximation for a mid-development window: the trait value $X(t)$ satisfies the differential equation $dX/dt=r$ for $t$ in the growth interval, with an initial condition $X(t_0)=X_0$. The solution is $X(t)=X_0+r(t-t_0)$ for $t\\in[t_0,t_1]$, where $t_1$ denotes the termination of growth for that trait. \n\nSuppose an ancestral lineage exhibits parameters $(t_{0,\\mathrm{anc}},r_{\\mathrm{anc}},t_{1,\\mathrm{anc}})$ and a descendant lineage exhibits $(t_{0,\\mathrm{des}},r_{\\mathrm{des}},t_{1,\\mathrm{des}})$. Assume both lineages share the same baseline trait value at onset, $X_{0,\\mathrm{anc}}=X_{0,\\mathrm{des}}=X_0$. Define the adult trait disparity\n$$\\Delta X \\equiv X_{\\mathrm{des}}(t_{1,\\mathrm{des}})-X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}}).$$\nA positive value of $\\Delta X$ indicates peramorphosis and a negative value indicates paedomorphosis; when the start time and rate are unchanged, a later termination time in the descendant specifically corresponds to hypermorphosis.\n\nFor a specific case, take the ancestor parameters $(t_{0,\\mathrm{anc}}=0,\\ r_{\\mathrm{anc}}=1,\\ t_{1,\\mathrm{anc}}=10)$ and the descendant parameters $(t_{0,\\mathrm{des}}=0,\\ r_{\\mathrm{des}}=1,\\ t_{1,\\mathrm{des}}=12)$, all in consistent time and trait units. Compute the exact value of $\\Delta X$ in trait units. Do not include units in your final boxed answer. In your reasoning, determine which heterochronic mechanism is implicated by the sign of $\\Delta X$ under these parameter relationships.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n**Step 1: Extract Givens**\nThe following information is provided verbatim:\n-   Ontogenetic trajectory model: The trait value $X(t)$ satisfies the differential equation $dX/dt=r$ for $t$ in the growth interval.\n-   Initial condition: $X(t_0)=X_0$.\n-   Solution to the model: $X(t)=X_0+r(t-t_0)$ for $t\\in[t_0,t_1]$.\n-   Parameters for an ancestral lineage: $(t_{0,\\mathrm{anc}},r_{\\mathrm{anc}},t_{1,\\mathrm{anc}})$.\n-   Parameters for a descendant lineage: $(t_{0,\\mathrm{des}},r_{\\mathrm{des}},t_{1,\\mathrm{des}})$.\n-   Shared initial trait value: $X_{0,\\mathrm{anc}}=X_{0,\\mathrm{des}}=X_0$.\n-   Definition of adult trait disparity: $\\Delta X \\equiv X_{\\mathrm{des}}(t_{1,\\mathrm{des}})-X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}})$.\n-   Definition of peramorphosis: $\\Delta X > 0$.\n-   Definition of paedomorphosis: $\\Delta X < 0$.\n-   Definition of hypermorphosis: A specific case of peramorphosis where $t_{0,\\mathrm{des}}=t_{0,\\mathrm{anc}}$, $r_{\\mathrm{des}}=r_{\\mathrm{anc}}$, and $t_{1,\\mathrm{des}}>t_{1,\\mathrm{anc}}$.\n-   Specific parameters for the ancestor: $(t_{0,\\mathrm{anc}}=0,\\ r_{\\mathrm{anc}}=1,\\ t_{1,\\mathrm{anc}}=10)$.\n-   Specific parameters for the descendant: $(t_{0,\\mathrm{des}}=0,\\ r_{\\mathrm{des}}=1,\\ t_{1,\\mathrm{des}}=12)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the required criteria.\n-   **Scientifically Grounded**: The model of linear growth, $dX/dt = r$, is a standard and valid simplification used in allometry and developmental biology to approximate growth over specific ontogenetic windows. The concepts of heterochrony, peramorphosis, and hypermorphosis are fundamental to evolutionary developmental biology. The problem is scientifically sound.\n-   **Well-Posed**: The problem is mathematically well-posed. All necessary parameters and definitions are provided to calculate a unique value for $\\Delta X$.\n-   **Objective**: The language is precise, quantitative, and devoid of subjective or speculative content.\n\nThe problem statement has no scientific or factual unsoundness, is formal and relevant, is complete and consistent, is realistic within the modeling context, is well-posed, and is not trivial. It is a direct application of defined principles.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\nThe problem requires the calculation of the adult trait disparity, $\\Delta X$, and the identification of the corresponding heterochronic mechanism.\n\nThe adult trait value for any lineage is given by the provided solution to the growth equation, evaluated at the time of growth termination, $t_1$:\n$$X(t_1) = X_0 + r(t_1 - t_0)$$\n\nFor the ancestral lineage, the adult trait value, $X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}})$, is found by substituting its specific parameters into this equation:\n$$X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}}) = X_0 + r_{\\mathrm{anc}}(t_{1,\\mathrm{anc}} - t_{0,\\mathrm{anc}})$$\nThe initial condition is $X(t_{0,\\mathrm{anc}}) = X_0$, as specified by the common value $X_0$.\n\nSimilarly, for the descendant lineage, the adult trait value, $X_{\\mathrm{des}}(t_{1,\\mathrm{des}})$, is:\n$$X_{\\mathrm{des}}(t_{1,\\mathrm{des}}) = X_0 + r_{\\mathrm{des}}(t_{1,\\mathrm{des}} - t_{0,\\mathrm{des}})$$\nThe initial condition is $X(t_{0,\\mathrm{des}}) = X_0$.\n\nThe adult trait disparity, $\\Delta X$, is defined as the difference between these two final trait values:\n$$\\Delta X = X_{\\mathrm{des}}(t_{1,\\mathrm{des}}) - X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}})$$\nSubstituting the expressions for each adult trait value:\n$$\\Delta X = [X_0 + r_{\\mathrm{des}}(t_{1,\\mathrm{des}} - t_{0,\\mathrm{des}})] - [X_0 + r_{\\mathrm{anc}}(t_{1,\\mathrm{anc}} - t_{0,\\mathrm{anc}})]$$\nThe common initial value $X_0$ cancels, simplifying the expression to:\n$$\\Delta X = r_{\\mathrm{des}}(t_{1,\\mathrm{des}} - t_{0,\\mathrm{des}}) - r_{\\mathrm{anc}}(t_{1,\\mathrm{anc}} - t_{0,\\mathrm{anc}})$$\n\nNow, we substitute the given numerical values for the parameters:\n-   Ancestor: $t_{0,\\mathrm{anc}}=0$, $r_{\\mathrm{anc}}=1$, $t_{1,\\mathrm{anc}}=10$.\n-   Descendant: $t_{0,\\mathrm{des}}=0$, $r_{\\mathrm{des}}=1$, $t_{1,\\mathrm{des}}=12$.\n\nThe calculation proceeds as follows:\n$$\\Delta X = 1 \\cdot (12 - 0) - 1 \\cdot (10 - 0)$$\n$$\\Delta X = 1 \\cdot 12 - 1 \\cdot 10$$\n$$\\Delta X = 12 - 10$$\n$$\\Delta X = 2$$\n\nThe calculated value of the trait disparity is $\\Delta X = 2$.\nAccording to the problem's definitions, since $\\Delta X > 0$, the observed evolutionary change is a form of **peramorphosis**, where the descendant extends or exaggerates the ancestral morphology.\n\nFurthermore, the problem provides specific conditions for **hypermorphosis**:\n1.  Unchanged start time: $t_{0,\\mathrm{des}} = t_{0,\\mathrm{anc}}$. Here, $0 = 0$. This condition is met.\n2.  Unchanged growth rate: $r_{\\mathrm{des}} = r_{\\mathrm{anc}}$. Here, $1 = 1$. This condition is met.\n3.  Later termination time in the descendant: $t_{1,\\mathrm{des}} > t_{1,\\mathrm{anc}}$. Here, $12 > 10$. This condition is met.\n\nSince all three conditions are satisfied, the specific heterochronic mechanism is hypermorphosis, which is a peramorphic process resulting from the extension of the growth period. The result $\\Delta X = 2$ is the quantitative measure of this peramorphic shift. The question asks for the exact value of $\\Delta X$.", "answer": "$$\\boxed{2}$$", "id": "2580467"}, {"introduction": "Evolutionary changes rarely involve a single parameter in isolation. This next exercise explores the more complex and realistic scenario where multiple aspects of a developmental program are altered simultaneously. You will derive an analytical expression that reveals how changes in developmental timing, such as onset and offset, can be offset by adjustments in growth rate to produce an identical adult phenotype [@problem_id:2580473]. This practice illuminates the critical concept of developmental trade-offs and demonstrates that different evolutionary pathways can converge on the same morphological outcome.", "problem": "In comparative zoology and botany, a simple mechanistic model for a trait's linear growth during development is given by the affine function $X(t) = X_{0} + r\\,(t - t_{0})$ for $t \\ge t_{0}$ and $X(t) = X_{0}$ for $t < t_{0}$. Here, $X_{0}$ is the initial trait value prior to the onset of trait-specific growth at time $t_{0}$, and $r$ is the constant rate of trait growth during the interval in which growth occurs. Let the ancestral lineage have parameters $(X_{0}, r, t_{0}, t_{1})$ with $t_{1} > t_{0}$ defining the termination of growth (the end of development for this trait), so the ancestral adult size is $X_{\\mathrm{A}} = X_{0} + r\\,(t_{1} - t_{0})$.\n\nConsider a descendant lineage that differs by heterochronic parameter shifts in onset and offset times and potentially also in rate, as follows: its onset time is shifted by $\\Delta_{0}$ to $t_{0}' = t_{0} + \\Delta_{0}$, its termination time is shifted by $\\Delta_{1}$ to $t_{1}' = t_{1} + \\Delta_{1}$, and its growth rate becomes $r'$. Assume $t_{1}' > t_{0}'$ so that the duration of growth remains positive in the descendant.\n\nUsing only first principles and core definitions of heterochrony (changes in onset time, offset time, and rate) together with the linear growth model defined above, derive a closed-form analytic expression for $r'$ in terms of $r$, $t_{0}$, $t_{1}$, $\\Delta_{0}$, and $\\Delta_{1}$ under the constraint that the descendant achieves the same adult size as the ancestor, that is, $X_{0} + r'\\,(t_{1}' - t_{0}') = X_{0} + r\\,(t_{1} - t_{0})$. Your derivation should make clear the assumption connecting adult size to the product of rate and duration in this model.\n\nThen, using the sign of $\\Delta_{0}$ and $\\Delta_{1}$ and the relative magnitude of $r'$ versus $r$, classify the resulting heterochronic mode(s) in the standard terminology (predisplacement or postdisplacement for onset shifts; hypermorphosis or progenesis for offset shifts; acceleration or neoteny for rate changes). Provide at least one example of parameter shifts $(\\Delta_{0}, \\Delta_{1})$ that yield identical adult size but different developmental histories (for example, a delayed onset compensated by a higher rate versus an earlier onset compensated by a lower rate), and justify the classification for each example.\n\nImportant: Your final answer must be only the analytic expression for $r'$; do not include the classification in the final answer. No rounding is required, and no units are needed because the expression is symbolic.", "solution": "The problem as stated is subjected to validation.\n\nFirst, the givens are extracted verbatim.\n- Ancestral trait growth model: $X(t) = X_{0} + r\\,(t - t_{0})$ for $t \\ge t_{0}$ and $X(t) = X_{0}$ for $t < t_{0}$.\n- Ancestral initial trait value: $X_{0}$.\n- Ancestral growth rate: $r$.\n- Ancestral growth onset time: $t_{0}$.\n- Ancestral growth termination time: $t_{1}$, with $t_{1} > t_{0}$.\n- Ancestral adult size: $X_{\\mathrm{A}} = X_{0} + r\\,(t_{1} - t_{0})$.\n- Descendant growth onset time: $t_{0}' = t_{0} + \\Delta_{0}$.\n- Descendant growth termination time: $t_{1}' = t_{1} + \\Delta_{1}$.\n- Descendant growth rate: $r'$.\n- Constraint on descendant growth duration: $t_{1}' > t_{0}'$.\n- Constraint for the derivation: The descendant achieves the same adult size as the ancestor, expressed as $X_{0} + r'\\,(t_{1}' - t_{0}') = X_{0} + r\\,(t_{1} - t_{0})$.\n\nThe problem is now validated against the required criteria.\n1.  **Scientific Grounding**: The problem is grounded in the field of evolutionary developmental biology, specifically concerning heterochrony. The linear growth model is a standard first-order approximation, and the parameters ($\\Delta_{0}$, $\\Delta_{1}$, $r'$) are the formal representations of changes in developmental timing and rate. The problem is scientifically sound.\n2.  **Well-Posedness**: The problem is well-posed. It provides a clear algebraic constraint and sufficient information to derive the requested expression for $r'$. The condition $t_{1}' > t_{0}'$ ensures that the duration of growth is positive, preventing a division-by-zero singularity and guaranteeing a unique, meaningful solution for $r'$.\n3.  **Objectivity**: The problem is stated in precise, objective mathematical and biological language. The terms used have standard, unambiguous definitions within the relevant scientific discipline.\n\nThe verdict is that the problem is **valid**. It is a straightforward exercise in algebraic manipulation and conceptual application of established biological principles. A solution will now be derived.\n\nThe fundamental premise is the equivalence of adult size in the ancestor and the descendant. The total size $X(t)$ is the sum of the initial size $X_{0}$ and the growth accumulated during development. The problem states that the initial size $X_0$ is the same for both lineages. Therefore, for the final adult sizes to be equal, the total amount of growth accumulated must also be equal. The accumulated growth for the ancestor is the product of its growth rate $r$ and its growth duration $(t_{1} - t_{0})$. Similarly, for the descendant, it is the product of its rate $r'$ and duration $(t_{1}' - t_{0}')$.\n\nThe constraint is given by the equation:\n$$X_{0} + r'\\,(t_{1}' - t_{0}') = X_{0} + r\\,(t_{1} - t_{0})$$\nThis equation properly formalizes the condition that the adult trait values are identical. We begin by simplifying this expression. The initial size $X_{0}$ is a common term on both sides of the equation and can be canceled:\n$$r'\\,(t_{1}' - t_{0}') = r\\,(t_{1} - t_{0})$$\nThis equation makes explicit the core assumption: the product of rate and duration is an invariant for the evolutionary change under consideration.\n\nThe problem defines the descendant's onset and offset times in terms of the ancestral times and parametric shifts $\\Delta_{0}$ and $\\Delta_{1}$:\n$$t_{0}' = t_{0} + \\Delta_{0}$$\n$$t_{1}' = t_{1} + \\Delta_{1}$$\nWe substitute these definitions into the simplified constraint equation:\n$$r'\\,((t_{1} + \\Delta_{1}) - (t_{0} + \\Delta_{0})) = r\\,(t_{1} - t_{0})$$\nThe term in the parentheses on the left-hand side can be rearranged to group the ancestral duration and the time shifts:\n$$r'\\,(t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}) = r\\,(t_{1} - t_{0})$$\nTo find the expression for the descendant's rate, $r'$, we must isolate it. This is achieved by dividing both sides by the descendant's growth duration, $(t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0})$. This operation is valid because the problem statement includes the constraint $t_{1}' > t_{0}'$, which implies $(t_{1} + \\Delta_{1}) > (t_{0} + \\Delta_{0})$, and thus $(t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}) \\neq 0$.\nThe resulting closed-form analytic expression for $r'$ is:\n$$r' = r \\frac{t_{1} - t_{0}}{t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}}$$\nThis concludes the first part of the task.\n\nFor the second part, we classify the heterochronic modes. The terminology is defined as follows:\n- Onset timing: An earlier start to development ($\\Delta_{0} < 0$) is **predisplacement**. A later start ($\\Delta_{0} > 0$) is **postdisplacement**.\n- Offset timing: An earlier end to development ($\\Delta_{1} < 0$) is **progenesis**. A later end ($\\Delta_{1} > 0$) is **hypermorphosis**.\n- Growth rate: A faster rate ($r' > r$) is **acceleration**. A slower rate ($r' < r$) is **neoteny**.\n\nThe change in rate is coupled to the change in duration. Let the ancestral duration be $T = t_{1} - t_{0}$ and the descendant duration be $T' = t_{1}' - t_{0}' = T + \\Delta_{1} - \\Delta_{0}$. Our derived expression is equivalent to $r' = r \\frac{T}{T'}$.\n- If the descendant's growth duration is shortened ($T' < T$, which means $\\Delta_{1} - \\Delta_{0} < 0$), then $r' > r$. This is compensation by **acceleration**.\n- If the descendant's growth duration is lengthened ($T' > T$, which means $\\Delta_{1} - \\Delta_{0} > 0$), then $r' < r$. This is compensation by **neoteny**.\n- If the duration is unchanged ($T' = T$, which means $\\Delta_{1} = \\Delta_{0}$), then $r' = r$. This is a pure temporal displacement with no rate change, known as isochrony.\n\nWe now provide two examples with different developmental histories leading to the same adult size. Let us define a simple ancestral state with parameters $t_{0} = 5$, $t_{1} = 15$, and $r = 10$. The ancestral growth duration is $T = t_{1} - t_{0} = 10$. The total growth is $rT = 10 \\times 10 = 100$.\n\nExample 1: Delayed onset compensated by acceleration.\nLet the onset of growth be delayed by $2$ time units, and the offset be brought forward by $3$ time units.\n- $\\Delta_{0} = 2$. This is **postdisplacement**.\n- $\\Delta_{1} = -3$. This is **progenesis**.\nThe new descendant times are $t_{0}' = 5 + 2 = 7$ and $t_{1}' = 15 - 3 = 12$. The new duration is $T' = 12 - 7 = 5$.\nSince the duration has been halved ($T' = T/2$), the rate must double to maintain the same total growth. We verify this with our derived formula:\n$$r' = r \\frac{T}{T'} = 10 \\frac{10}{5} = 20$$\nSince $r' = 20 > r = 10$, this change constitutes **acceleration**. The total growth is $r'T' = 20 \\times 5 = 100$, which is identical to the ancestor. This descendant shows postdisplacement, progenesis, and acceleration.\n\nExample 2: Earlier onset compensated by neoteny.\nLet the onset of growth occur $2$ time units earlier, and the offset be delayed by $8$ time units.\n- $\\Delta_{0} = -2$. This is **predisplacement**.\n- $\\Delta_{1} = 8$. This is **hypermorphosis**.\nThe new descendant times are $t_{0}' = 5 - 2 = 3$ and $t_{1}' = 15 + 8 = 23$. The new duration is $T' = 23 - 3 = 20$.\nSince the duration has been doubled ($T' = 2T$), the rate must be halved. We verify:\n$$r' = r \\frac{T}{T'} = 10 \\frac{10}{20} = 5$$\nSince $r' = 5 < r = 10$, this change constitutes **neoteny**. The total growth is $r'T' = 5 \\times 20 = 100$, identical to the ancestor. This descendant shows predisplacement, hypermorphosis, and neoteny.\n\nBoth examples result in an identical change in adult size (zero change, in fact) but through entirely different modifications of the developmental program, as correctly captured by the heterochronic terminology.", "answer": "$$\\boxed{r \\frac{t_{1} - t_{0}}{t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}}}$$", "id": "2580473"}, {"introduction": "Bridging theory and practice, this final exercise moves from deterministic models to the statistical analysis of empirical data. Here, you will confront the real-world complexities of phenotypic variation, including plastic responses to environmental change and genotype-by-environment (GxE) interactions. By fitting a linear mixed model to provided datasets, you will learn to operationalize the concept of paedomorphosis into a testable statistical hypothesis, a vital skill for any evolutionary biologist working with quantitative data [@problem_id:2580447].", "problem": "You are given balanced measurements of a developmental event time $t_1$ (in hours) for multiple genotypes measured in two environments. The biological context is heterochrony: plastic shifts in $t_1$ across environments can indicate paedomorphosis when developmental timings are earlier in one environment and the shift is consistent across genotypes without strong genotype-by-environment variation. You must formulate and fit a linear mixed model and then make an algorithmic decision about paedomorphosis under plasticity based only on the quantitative criteria defined below. Your task is purely mathematical and computational and does not require biological background beyond the definitions provided.\n\nFundamental base and modeling assumptions:\n- Let $y_{ijk}$ be the measured $t_1$ for genotype $i$ ($i \\in \\{1,\\dots,G\\}$), environment $j$ ($j \\in \\{1,2\\}$), and replicate $k$ ($k \\in \\{1,\\dots,r\\}$). Units of $t_1$ are hours.\n- Use the linear mixed model $y_{ijk} = \\mu + \\alpha_j + g_i + (g\\!:\\!e)_{ij} + \\varepsilon_{ijk}$, where $\\mu$ is the grand mean, $\\alpha_j$ is the fixed effect of environment $j$ (two levels), $g_i \\sim \\mathcal{N}(0,\\sigma_G^2)$ is a random genotype effect, $(g\\!:\\!e)_{ij} \\sim \\mathcal{N}(0,\\sigma_{G\\times E}^2)$ is a random genotype-by-environment (GxE) interaction effect, and $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma_\\varepsilon^2)$ is the residual. All random effects are mutually independent.\n- Derive unbiased method-of-moments estimators for the variance components $\\sigma_{G\\times E}^2$ and $\\sigma_\\varepsilon^2$ by starting from the expected mean squares of the balanced two-way layout (genotype random, environment fixed), and then invert to obtain variance component estimates. Treat any negative variance component estimate as $0$ (a standard truncation).\n- Define the reaction norm slope for genotype $i$ as $s_i = \\bar{y}_{i2\\cdot} - \\bar{y}_{i1\\cdot}$, where $\\bar{y}_{ij\\cdot}$ is the mean over replicates in environment $j$. With environments coded as $1$ and $2$, this slope is the mean difference between environment $2$ and environment $1$ for each genotype.\n\nDecision rule for paedomorphosis under plasticity (operationalization):\n- Let $\\bar{s}$ be the average of $s_i$ over all genotypes.\n- Let $\\pi_-$ be the fraction of genotypes with $s_i &lt; 0$.\n- Let $V_{\\text{sum}} = \\sigma_G^2 + \\sigma_{G\\times E}^2 + \\sigma_\\varepsilon^2$ and define the relative GxE magnitude $q = \\sigma_{G\\times E}^2 / V_{\\text{sum}}$ when $V_{\\text{sum}} &gt; 0$ and $q=0$ if $V_{\\text{sum}} = 0$.\n- Declare \"paedomorphosis under plasticity\" to be present if and only if all of the following hold: $\\bar{s} &lt; 0$, $\\pi_- \\ge \\phi$, and $q \\le \\tau$ with thresholds $\\phi = 0.75$ and $\\tau = 0.05$ (both thresholds are unitless).\n\nRequired outputs:\n- For each dataset in the test suite, output two values: the estimated $\\sigma_{G\\times E}^2$ in $\\text{hours}^2$ (rounded to $3$ decimals) and an indicator of paedomorphosis under plasticity encoded as an integer ($1$ if present, $0$ otherwise).\n- The final output must be a single line containing a Python-style list of per-dataset results, where each result is a two-element list formatted without spaces after commas; for example, a two-dataset output should look like $[[x_1,y_1],[x_2,y_2]]$.\n\nData constraints and units:\n- All $t_1$ measurements are in hours. Report $\\sigma_{G\\times E}^2$ in $\\text{hours}^2$ rounded to $3$ decimals. The indicator is an integer $0$ or $1$.\n\nTest suite:\n- The design is balanced with $G=4$ genotypes, $E=2$ environments, and $r=3$ replicates per genotype-by-environment cell for every dataset.\n\nProvide a program that uses the following three datasets:\n\n- Dataset A (uniform earlier timing in environment $2$):\n  - Genotype $1$: environment $1$ replicates $[98,101,100]$, environment $2$ replicates $[88,91,90]$.\n  - Genotype $2$: environment $1$ replicates $[105,102,104]$, environment $2$ replicates $[93,95,94]$.\n  - Genotype $3$: environment $1$ replicates $[97,99,98]$, environment $2$ replicates $[85,87,88]$.\n  - Genotype $4$: environment $1$ replicates $[110,108,109]$, environment $2$ replicates $[97,96,98]$.\n\n- Dataset B (no systematic shift across environments):\n  - Genotype $1$: environment $1$ replicates $[100,101,99]$, environment $2$ replicates $[100,99,101]$.\n  - Genotype $2$: environment $1$ replicates $[104,103,102]$, environment $2$ replicates $[104,103,102]$.\n  - Genotype $3$: environment $1$ replicates $[98,97,99]$, environment $2$ replicates $[98,99,97]$.\n  - Genotype $4$: environment $1$ replicates $[110,109,111]$, environment $2$ replicates $[110,111,109]$.\n\n- Dataset C (strong genotype-by-environment interaction; mixed slopes):\n  - Genotype $1$: environment $1$ replicates $[100,101,99]$, environment $2$ replicates $[95,96,94]$.\n  - Genotype $2$: environment $1$ replicates $[102,100,101]$, environment $2$ replicates $[106,107,105]$.\n  - Genotype $3$: environment $1$ replicates $[98,99,97]$, environment $2$ replicates $[92,93,91]$.\n  - Genotype $4$: environment $1$ replicates $[105,104,106]$, environment $2$ replicates $[110,109,111]$.\n\nImplementation requirements:\n- Implement the balanced two-way analysis to compute sums of squares and mean squares for genotype, environment, genotype-by-environment, and residual. From the expected mean squares, construct the unbiased method-of-moments estimates of $\\sigma_{G\\times E}^2$ and $\\sigma_\\varepsilon^2$, and also $\\sigma_G^2$ if needed for $V_{\\text{sum}}$. Truncate any negative variance component estimate to $0$.\n- Compute $s_i$ for each genotype, $\\bar{s}$, and $\\pi_-$. Compute $q$ from the estimated variance components.\n- For each dataset, output the pair $[\\sigma_{G\\times E}^2, I]$, where $I \\in \\{0,1\\}$ is the indicator defined above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each per-dataset result written as $[x,y]$ without spaces after commas, for example $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$.", "solution": "The problem is valid. It presents a clear, self-contained, and scientifically grounded task in quantitative genetics, requiring the application of a linear mixed model and a specified decision algorithm. The problem is well-posed, with all necessary data and definitions provided.\n\nThe problem requires a statistical analysis based on the linear mixed model:\n$$y_{ijk} = \\mu + \\alpha_j + g_i + (g\\!:\\!e)_{ij} + \\varepsilon_{ijk}$$\nHere, $y_{ijk}$ is the developmental event time for genotype $i$ ($i \\in \\{1,\\dots,G\\}$) in environment $j$ ($j \\in \\{1,2\\}$) for replicate $k$ ($k \\in \\{1,\\dots,r\\}$). The parameters are: $\\mu$, the grand mean; $\\alpha_j$, the fixed effect of environment $j$; $g_i$, the random effect of genotype $i$, with $g_i \\sim \\mathcal{N}(0, \\sigma_G^2)$; $(g\\!:\\!e)_{ij}$, the random genotype-by-environment (GxE) interaction effect, with $(g\\!:\\!e)_{ij} \\sim \\mathcal{N}(0, \\sigma_{G\\times E}^2)$; and $\\varepsilon_{ijk}$, the residual error, with $\\varepsilon_{ijk} \\sim \\mathcal{N}(0, \\sigma_\\varepsilon^2)$. The design is balanced with $G=4$, $E=2$, and $r=3$.\n\nThe variance components $\\sigma_G^2$, $\\sigma_{G\\times E}^2$, and $\\sigma_\\varepsilon^2$ are to be estimated using the method of moments (MOM), derived from the expected mean squares (EMS) of a balanced two-way Analysis of Variance (ANOVA). For this mixed model (Environment fixed, Genotype random), the EMS equations are:\n$E(MS_\\varepsilon) = \\sigma_\\varepsilon^2$\n$E(MS_{G \\times E}) = \\sigma_\\varepsilon^2 + r\\sigma_{G\\times E}^2$\n$E(MS_G) = \\sigma_\\varepsilon^2 + r\\sigma_{G\\times E}^2 + Er\\sigma_G^2$\n\nBy equating the observed mean squares (MS) to their expectations, we derive the MOM estimators.\nFirst, we must calculate the sums of squares (SS):\nLet $N=G \\cdot E \\cdot r$ be the total number of observations.\nLet $y_{ij\\cdot} = \\sum_{k=1}^r y_{ijk}$, $y_{i\\cdot\\cdot} = \\sum_{j=1}^E \\sum_{k=1}^r y_{ijk}$, $y_{\\cdot j\\cdot} = \\sum_{i=1}^G \\sum_{k=1}^r y_{ijk}$, and $T = \\sum_{i=1}^G \\sum_{j=1}^E \\sum_{k=1}^r y_{ijk}$.\nThe correction factor is $CF = T^2 / N$.\n$$SS_G = \\frac{\\sum_{i=1}^G y_{i\\cdot\\cdot}^2}{Er} - CF$$\n$$SS_E = \\frac{\\sum_{j=1}^E y_{\\cdot j\\cdot}^2}{Gr} - CF$$\n$$SS_{\\text{Cells}} = \\frac{\\sum_{i=1}^G \\sum_{j=1}^E y_{ij\\cdot}^2}{r} - CF$$\n$$SS_{G \\times E} = SS_{\\text{Cells}} - SS_G - SS_E$$\n$$SS_\\varepsilon = \\sum_{i,j,k} y_{ijk}^2 - \\frac{\\sum_{i,j} y_{ij\\cdot}^2}{r}$$\n\nThe mean squares (MS) are obtained by dividing the SS by their respective degrees of freedom (df):\n$df_G = G-1$\n$df_E = E-1$\n$df_{G \\times E} = (G-1)(E-1)$\n$df_\\varepsilon = GE(r-1)$\n$$MS_G = \\frac{SS_G}{df_G}, \\quad MS_{G \\times E} = \\frac{SS_{G \\times E}}{df_{G \\times E}}, \\quad MS_\\varepsilon = \\frac{SS_\\varepsilon}{df_\\varepsilon}$$\n\nInverting the EMS equations yields the estimators for the variance components:\n$$\\hat{\\sigma}_\\varepsilon^2 = MS_\\varepsilon$$\n$$\\hat{\\sigma}_{G\\times E}^2 = \\frac{MS_{G \\times E} - MS_\\varepsilon}{r}$$\n$$\\hat{\\sigma}_G^2 = \\frac{MS_G - MS_{G\\times E}}{Er}$$\nAs stipulated, any negative estimate for a variance component must be truncated to $0$.\n\nThe decision rule for \"paedomorphosis under plasticity\" is based on three conditions.\nFirst, we define the reaction norm slope for each genotype $i$ as $s_i = \\bar{y}_{i2\\cdot} - \\bar{y}_{i1\\cdot}$, where $\\bar{y}_{ij\\cdot} = y_{ij\\cdot}/r$ is the mean for genotype $i$ in environment $j$.\nThen we compute three metrics:\n1. The average slope, $\\bar{s} = \\frac{1}{G} \\sum_{i=1}^G s_i$.\n2. The fraction of negative slopes, $\\pi_- = \\frac{1}{G} \\times |\\{i \\mid s_i < 0\\}|$.\n3. The relative magnitude of GxE variance, $q = \\frac{\\hat{\\sigma}_{G\\times E}^2}{V_{\\text{sum}}}$, where $V_{\\text{sum}} = \\hat{\\sigma}_G^2 + \\hat{\\sigma}_{G\\times E}^2 + \\hat{\\sigma}_\\varepsilon^2$. If $V_{\\text{sum}}=0$, then $q=0$.\n\nThe declaration of paedomorphosis ($I=1$) is made if and only if all three of the following conditions are met, using the given thresholds $\\phi=0.75$ and $\\tau=0.05$:\n1. $\\bar{s} < 0$\n2. $\\pi_- \\ge \\phi$\n3. $q \\le \\tau$\nIf any condition is not met, the indicator is $I=0$.\n\nThe computational procedure for each dataset is as follows:\n1. Reshape the input data into a $G \\times E \\times r$ array.\n2. Compute the sums of squares ($SS_G$, $SS_E$, $SS_{G \\times E}$, $SS_\\varepsilon$).\n3. Compute the mean squares ($MS_G$, $MS_{G \\times E}$, $MS_\\varepsilon$).\n4. Estimate the variance components ($\\hat{\\sigma}_G^2, \\hat{\\sigma}_{G\\times E}^2, \\hat{\\sigma}_\\varepsilon^2$), applying truncation to $0$ if any estimate is negative.\n5. Calculate the reaction norm slopes ($s_i$) and the decision metrics ($\\bar{s}, \\pi_-, q$).\n6. Apply the decision rule to determine the indicator $I \\in \\{0, 1\\}$.\n7. The output for the dataset is $[\\text{round}(\\hat{\\sigma}_{G\\times E}^2, 3), I]$.\nThis procedure is applied to each of the three provided datasets.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the provided test suite of datasets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        np.array([[[98, 101, 100], [88, 91, 90]],   # Genotype 1\n                  [[105, 102, 104], [93, 95, 94]],  # Genotype 2\n                  [[97, 99, 98], [85, 87, 88]],   # Genotype 3\n                  [[110, 108, 109], [97, 96, 98]]]),# Genotype 4\n\n        # Dataset B\n        np.array([[[100, 101, 99], [100, 99, 101]],\n                  [[104, 103, 102], [104, 103, 102]],\n                  [[98, 97, 99], [98, 99, 97]],\n                  [[110, 109, 111], [110, 111, 109]]]),\n\n        # Dataset C\n        np.array([[[100, 101, 99], [95, 96, 94]],\n                  [[102, 100, 101], [106, 107, 105]],\n                  [[98, 99, 97], [92, 93, 91]],\n                  [[105, 104, 106], [110, 109, 111]]])\n    ]\n\n    phi = 0.75\n    tau = 0.05\n    results = []\n\n    for data in test_cases:\n        # Step 1: Calculate ANOVA quantities\n        G, E, r = data.shape\n        N = G * E * r\n\n        # Sums\n        y_ijk = data\n        y_ij_dot = np.sum(data, axis=2)\n        y_i_dot_dot = np.sum(y_ij_dot, axis=1)\n        y_dot_j_dot = np.sum(y_ij_dot, axis=0)\n        T = np.sum(y_ijk)\n\n        # Correction Factor\n        CF = T**2 / N\n\n        # Sum of Squares (SS)\n        SS_total = np.sum(y_ijk**2) - CF\n        SS_G = np.sum(y_i_dot_dot**2) / (E * r) - CF\n        SS_E = np.sum(y_dot_j_dot**2) / (G * r) - CF\n        SS_cells = np.sum(y_ij_dot**2) / r - CF\n        SS_GxE = SS_cells - SS_G - SS_E\n        SS_error = SS_total - SS_cells\n\n        # Degrees of Freedom (df)\n        df_G = G - 1\n        df_E = E - 1\n        df_GxE = (G - 1) * (E - 1)\n        df_error = G * E * (r - 1)\n\n        # Mean Squares (MS)\n        MS_G = SS_G / df_G\n        MS_GxE = SS_GxE / df_GxE if df_GxE > 0 else 0\n        MS_error = SS_error / df_error\n\n        # Step 2: Estimate Variance Components\n        sigma_sq_error = MS_error\n        sigma_sq_GxE = max(0, (MS_GxE - MS_error) / r)\n        sigma_sq_G = max(0, (MS_G - MS_GxE) / (E * r))\n\n        # Step 3: Apply Decision Rule\n        # Reaction norm slopes\n        slopes = []\n        cell_means = y_ij_dot / r\n        for i in range(G):\n            s_i = cell_means[i, 1] - cell_means[i, 0]\n            slopes.append(s_i)\n        \n        slopes = np.array(slopes)\n        \n        # Condition 1: Average slope\n        s_bar = np.mean(slopes)\n        cond1 = s_bar  0\n\n        # Condition 2: Fraction of negative slopes\n        pi_minus = np.sum(slopes  0) / G\n        cond2 = pi_minus >= phi\n\n        # Condition 3: Relative GxE magnitude\n        V_sum = sigma_sq_G + sigma_sq_GxE + sigma_sq_error\n        q = sigma_sq_GxE / V_sum if V_sum > 0 else 0\n        cond3 = q = tau\n\n        # Final decision\n        indicator = 1 if cond1 and cond2 and cond3 else 0\n\n        # Step 4: Assemble result\n        sigma_sq_GxE_rounded = round(sigma_sq_GxE, 3)\n        results.append([sigma_sq_GxE_rounded, indicator])\n    \n    # Final print statement must be a single line in the exact specified format.\n    # The format is [[x1,y1],[x2,y2],...], without spaces.\n    result_strings = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "2580447"}]}