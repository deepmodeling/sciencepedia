{"hands_on_practices": [{"introduction": "The journey into understanding molecular selection begins at the most fundamental level: the sequence alignment. This exercise [@problem_id:2754869] provides a hands-on opportunity to translate a raw codon alignment into the basic quantities needed for evolutionary analysis. By manually counting synonymous and nonsynonymous sites and differences, you will build an intuition for how the genetic code's structure directly informs our initial estimates of sequence divergence, yielding the uncorrected proportions $p_S$ and $p_N$.", "problem": "A pairwise codon alignment of two orthologous protein-coding sequences is given below. The sequences are in-frame, codon-aligned, and read in the $5^{\\prime}\\to 3^{\\prime}$ direction. The aligned sequences span $4$ codons (i.e., $12$ nucleotides).\n\nSequence 1 (reference): GCT TTT AGA GAA\nSequence 2 (query):     GCC TAT GCA GAC\n\nUsing only the following foundational definitions and assumptions:\n\n- A synonymous change is a single-nucleotide change within a codon that does not change the encoded amino acid; a nonsynonymous change is one that does change the encoded amino acid. Single-nucleotide changes that yield a stop codon are to be counted as nonsynonymous.\n- For each codon, the number of synonymous sites is defined as the sum over the three codon positions of the fraction of the three possible single-nucleotide changes at that position that are synonymous. The number of nonsynonymous sites is the remainder so that the sum of synonymous and nonsynonymous sites per codon equals $3$.\n- For a codon pair with multiple nucleotide differences, decompose the difference into single-nucleotide steps along all shortest paths (i.e., the Hamming distance between the codons), count synonymous versus nonsynonymous steps on each path, and take the average over these paths (equal-path weighting, as in the Nei–Gojobori framework).\n- Use the Standard Nuclear Genetic Code with the following relevant codon families: alanine is encoded by GCT, GCC, GCA, GCG; phenylalanine by TTT, TTC; tyrosine by TAT, TAC; arginine by CGT, CGC, CGA, CGG, AGA, AGG; glutamic acid by GAA, GAG; aspartic acid by GAT, GAC. No other genetic code details are needed.\n\nTasks:\n\n1. Compute the total number of synonymous sites $S$ and nonsynonymous sites $N$ for the alignment by first computing these site counts for each codon in both sequences, averaging the counts across the paired codons at each position, and summing over the $4$ codon positions.\n2. Compute the expected numbers of synonymous differences $S_{d}$ and nonsynonymous differences $N_{d}$ across the alignment using single-step classification for single-nucleotide differences and equal-path weighting for codon pairs with two differences.\n3. From these, derive $p_{S} = S_{d}/S$ and $p_{N} = N_{d}/N$.\n\nReport your final answer as the ordered pair $(p_{S}, p_{N})$. Round each of $p_{S}$ and $p_{N}$ to four significant figures. Express the final answer without units.", "solution": "The problem requires the calculation of the proportion of synonymous differences per synonymous site, $p_{S}$, and the proportion of nonsynonymous differences per nonsynonymous site, $p_{N}$, for a given pairwise codon alignment. The validation has confirmed that the problem is scientifically grounded, well-posed, and contains sufficient information for a unique solution. The calculation will be executed in three stages as specified.\n\n**Stage 1: Calculation of Total Synonymous Sites ($S$) and Nonsynonymous Sites ($N$)**\n\nFirst, we must determine the number of synonymous sites ($s$) and nonsynonymous sites ($n$) for each of the unique codons in the alignment. The number of sites per codon is $3$. The number of synonymous sites for a codon is calculated as $s = \\sum_{i=1}^{3} f_{i,S}$, where $f_{i,S}$ is the fraction of single-nucleotide changes at position $i$ that are synonymous. The number of nonsynonymous sites is $n = 3 - s$. The relevant genetic code is provided.\n\nThe alignment is:\nSequence 1: GCT TTT AGA GAA\nSequence 2: GCC TAT GCA GAC\n\nCalculations for each unique codon:\n- **GCT (Alanine):** Positions $1$ and $2$ are non-degenerate. Position $3$ is a $4$-fold degenerate site.\n  $s_{\\text{GCT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{3}{3} = 1$. So, $n_{\\text{GCT}} = 3 - 1 = 2$.\n- **GCC (Alanine):** Identical properties to GCT.\n  $s_{\\text{GCC}} = 1$ and $n_{\\text{GCC}} = 2$.\n- **TTT (Phenylalanine):** Positions $1$ and $2$ are non-degenerate. At position $3$, one of the three possible changes (to TTC) is synonymous.\n  $s_{\\text{TTT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$. So, $n_{\\text{TTT}} = 3 - \\frac{1}{3} = \\frac{8}{3}$.\n- **TAT (Tyrosine):** Positions $1$ and $2$ are non-degenerate. At position $3$, one of the three possible changes (to TAC) is synonymous.\n  $s_{\\text{TAT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$. So, $n_{\\text{TAT}} = 3 - \\frac{1}{3} = \\frac{8}{3}$.\n- **AGA (Arginine):** At position $1$, one change (to CGA) is synonymous. At position $2$, all changes are nonsynonymous. At position $3$, one change (to AGG) is synonymous.\n  $s_{\\text{AGA}} = \\frac{1}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{2}{3}$. So, $n_{\\text{AGA}} = 3 - \\frac{2}{3} = \\frac{7}{3}$.\n- **GCA (Alanine):** Identical properties to GCT.\n  $s_{\\text{GCA}} = 1$ and $n_{\\text{GCA}} = 2$.\n- **GAA (Glutamic Acid):** Positions $1$ and $2$ are non-degenerate. At position $3$, one change (to GAG) is synonymous.\n  $s_{\\text{GAA}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$. So, $n_{\\text{GAA}} = 3 - \\frac{1}{3} = \\frac{8}{3}$.\n- **GAC (Aspartic Acid):** Positions $1$ and $2$ are non-degenerate. At position $3$, one change (to GAT) is synonymous.\n  $s_{\\text{GAC}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$. So, $n_{\\text{GAC}} = 3 - \\frac{1}{3} = \\frac{8}{3}$.\n\nNext, we average the site counts for each codon pair in the alignment.\n1.  **Codon pair 1 (GCT, GCC):**\n    $\\bar{s}_1 = \\frac{s_{\\text{GCT}} + s_{\\text{GCC}}}{2} = \\frac{1+1}{2} = 1$.\n    $\\bar{n}_1 = \\frac{n_{\\text{GCT}} + n_{\\text{GCC}}}{2} = \\frac{2+2}{2} = 2$.\n2.  **Codon pair 2 (TTT, TAT):**\n    $\\bar{s}_2 = \\frac{s_{\\text{TTT}} + s_{\\text{TAT}}}{2} = \\frac{1/3+1/3}{2} = \\frac{1}{3}$.\n    $\\bar{n}_2 = \\frac{n_{\\text{TTT}} + n_{\\text{TAT}}}{2} = \\frac{8/3+8/3}{2} = \\frac{8}{3}$.\n3.  **Codon pair 3 (AGA, GCA):**\n    $\\bar{s}_3 = \\frac{s_{\\text{AGA}} + s_{\\text{GCA}}}{2} = \\frac{2/3+1}{2} = \\frac{5/3}{2} = \\frac{5}{6}$.\n    $\\bar{n}_3 = \\frac{n_{\\text{AGA}} + n_{\\text{GCA}}}{2} = \\frac{7/3+2}{2} = \\frac{13/3}{2} = \\frac{13}{6}$.\n4.  **Codon pair 4 (GAA, GAC):**\n    $\\bar{s}_4 = \\frac{s_{\\text{GAA}} + s_{\\text{GAC}}}{2} = \\frac{1/3+1/3}{2} = \\frac{1}{3}$.\n    $\\bar{n}_4 = \\frac{n_{\\text{GAA}} + n_{\\text{GAC}}}{2} = \\frac{8/3+8/3}{2} = \\frac{8}{3}$.\n\nFinally, we sum these averaged counts to find the total $S$ and $N$ for the alignment.\n$S = \\bar{s}_1 + \\bar{s}_2 + \\bar{s}_3 + \\bar{s}_4 = 1 + \\frac{1}{3} + \\frac{5}{6} + \\frac{1}{3} = \\frac{6+2+5+2}{6} = \\frac{15}{6} = 2.5$.\n$N = \\bar{n}_1 + \\bar{n}_2 + \\bar{n}_3 + \\bar{n}_4 = 2 + \\frac{8}{3} + \\frac{13}{6} + \\frac{8}{3} = \\frac{12+16+13+16}{6} = \\frac{57}{6} = 9.5$.\nThe sum $S+N = 2.5+9.5 = 12$, which is correct for a $4$-codon alignment.\n\n**Stage 2: Calculation of Synonymous ($S_d$) and Nonsynonymous ($N_d$) Differences**\n\nWe now classify the nucleotide differences for each codon pair.\n1.  **Pair 1 (GCT vs GCC):** There is $1$ difference (T $\\to$ C). GCT (Ala) $\\to$ GCC (Ala) is a synonymous change.\n    $s_{d,1} = 1$, $n_{d,1} = 0$.\n2.  **Pair 2 (TTT vs TAT):** There is $1$ difference (T $\\to$ A). TTT (Phe) $\\to$ TAT (Tyr) is a nonsynonymous change.\n    $s_{d,2} = 0$, $n_{d,2} = 1$.\n3.  **Pair 3 (AGA vs GCA):** There are $2$ differences (A $\\to$ G, G $\\to$ C). We examine the two shortest evolutionary paths:\n    - Path A: AGA (Arg) $\\to$ GGA (Gly) $\\to$ GCA (Ala). Both steps are nonsynonymous. Path A: $0$ S, $2$ N steps.\n    - Path B: AGA (Arg) $\\to$ ACA (Thr) $\\to$ GCA (Ala). Both steps are nonsynonymous. Path B: $0$ S, $2$ N steps.\n    Averaging over the paths: $s_{d,3} = \\frac{0+0}{2}=0$, $n_{d,3} = \\frac{2+2}{2}=2$.\n4.  **Pair 4 (GAA vs GAC):** There is $1$ difference (A $\\to$ C). GAA (Glu) $\\to$ GAC (Asp) is a nonsynonymous change.\n    $s_{d,4} = 0$, $n_{d,4} = 1$.\n\nTotal number of differences:\n$S_d = \\sum s_{d,i} = 1 + 0 + 0 + 0 = 1$.\n$N_d = \\sum n_{d,i} = 0 + 1 + 2 + 1 = 4$.\n\n**Stage 3: Calculation of $p_S$ and $p_N$**\n\nThe proportions are calculated as the number of differences divided by the number of sites.\n$p_S = \\frac{S_d}{S} = \\frac{1}{2.5} = 0.4$.\n$p_N = \\frac{N_d}{N} = \\frac{4}{9.5} = \\frac{4}{19/2} = \\frac{8}{19}$.\n\nFinally, we express the values in decimal form rounded to four significant figures.\n$p_S = 0.4000$.\n$p_N = \\frac{8}{19} \\approx 0.4210526...$, which rounds to $0.4211$.\n\nThe final answer is the ordered pair $(p_S, p_N)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4000  0.4211\n\\end{pmatrix}\n}\n$$", "id": "2754869"}, {"introduction": "Observed sequence differences often conceal the true history of substitution events, as multiple changes at the same site can revert or obscure one another. This practice [@problem_id:2754886] delves into the crucial step of correcting for these \"multiple hits\" using the classic Jukes-Cantor model of nucleotide substitution. By deriving the correction from first principles and applying it to hypothetical data, you will see how we move from observable proportions ($p_S$, $p_N$) to the estimated evolutionary rates ($d_S$, $d_N$) that form the basis of the $\\omega$ ratio.", "problem": "Two orthologous protein-coding sequences are aligned without gaps. Across sites classified as synonymous and nonsynonymous, the observed fractions of nucleotide differences between the two sequences are $p_{S}=0.3$ and $p_{N}=0.05$, respectively. Assume that, within each site class separately, nucleotide substitutions follow the continuous-time Jukes–Cantor model (equal equilibrium base frequencies and equal instantaneous rates among all distinct nucleotide pairs), sites evolve independently, and there is no rate heterogeneity among sites.\n\nStarting from the definition of a continuous-time Markov chain with generator matrix having identical off-diagonal entries and using the Kolmogorov forward equations, derive the Jukes–Cantor correction that maps an observed fraction of differences $p$ at time $t$ to the expected number of substitutions per site $d$ under this model. Apply this correction independently to the synonymous and nonsynonymous site classes to obtain $d_{S}$ and $d_{N}$ from $p_{S}$ and $p_{N}$. Then compute the nonsynonymous-to-synonymous rate ratio $\\omega = d_{N}/d_{S}$.\n\nProvide only the value of $\\omega$ as your final answer. Round your reported value of $\\omega$ to four significant figures. Do not include units.", "solution": "The problem requires the derivation of the Jukes-Cantor correction from first principles and its application to calculate the nonsynonymous-to-synonymous rate ratio, $\\omega$.\n\nFirst, we validate the problem. The givens are:\n- Observed fraction of differences at synonymous sites, $p_{S} = 0.3$.\n- Observed fraction of differences at nonsynonymous sites, $p_{N} = 0.05$.\n- The substitution process follows the continuous-time Jukes–Cantor (JC69) model.\nThe problem is scientifically grounded in evolutionary biology, is well-posed with sufficient information, and uses objective, standard terminology. There are no logical contradictions, factual errors, or ambiguities. The problem is valid.\n\nWe now proceed with the solution.\n\nThe Jukes-Cantor model describes nucleotide substitution as a continuous-time Markov process on the state space of four nucleotides. The model assumes an equal rate of substitution, $\\alpha$, between any pair of distinct nucleotides. The generator matrix, $Q$, which contains the instantaneous transition rates, is given by:\n$$\nQ =\n\\begin{pmatrix}\n-3\\alpha  \\alpha  \\alpha  \\alpha \\\\\n\\alpha  -3\\alpha  \\alpha  \\alpha \\\\\n\\alpha  \\alpha  -3\\alpha  \\alpha \\\\\n\\alpha  \\alpha  \\alpha  -3\\alpha\n\\end{pmatrix}\n$$\nThe diagonal elements $Q_{ii} = -3\\alpha$ represent the total rate of substitution away from nucleotide $i$, ensuring that the rows of $Q$ sum to zero.\n\nThe matrix of transition probabilities, $P(t)$, where $P_{ij}(t)$ is the probability of being in state $j$ at time $t$ given the state was $i$ at time $t=0$, evolves according to the Kolmogorov forward equations:\n$$ \\frac{d P(t)}{dt} = P(t) Q $$\nwith the initial condition $P(0) = I$, the identity matrix.\n\nDue to the symmetry of the $Q$ matrix, the transition probabilities depend only on whether the initial and final states are the same or different. Let $P_{ii}(t)$ be the probability of no change over time $t$, and $P_{ij}(t)$ for $i \\neq j$ be the probability of a specific change. For any $i$, the probabilities must sum to one:\n$$ P_{ii}(t) + \\sum_{j \\neq i} P_{ij}(t) = 1 $$\nBy symmetry, all $P_{ij}(t)$ for $i \\neq j$ are equal. So, $P_{ii}(t) + 3P_{ij}(t) = 1$, which implies $P_{ij}(t) = \\frac{1 - P_{ii}(t)}{3}$.\n\nWe can write a differential equation for $P_{ii}(t)$ from the matrix equation. For any row $i$:\n$$ \\frac{dP_{ii}(t)}{dt} = \\sum_{k=1}^{4} P_{ik}(t) Q_{ki} = P_{ii}(t) Q_{ii} + \\sum_{k \\neq i} P_{ik}(t) Q_{ki} $$\n$$ \\frac{dP_{ii}(t)}{dt} = P_{ii}(t)(-3\\alpha) + 3 P_{ij}(t)(\\alpha) $$\nSubstituting $P_{ij}(t) = \\frac{1 - P_{ii}(t)}{3}$:\n$$ \\frac{dP_{ii}(t)}{dt} = -3\\alpha P_{ii}(t) + 3\\alpha \\left(\\frac{1 - P_{ii}(t)}{3}\\right) = -3\\alpha P_{ii}(t) + \\alpha - \\alpha P_{ii}(t) $$\n$$ \\frac{dP_{ii}(t)}{dt} = \\alpha - 4\\alpha P_{ii}(t) $$\nThis is a first-order linear ordinary differential equation. With the initial condition $P_{ii}(0) = 1$, the solution is:\n$$ P_{ii}(t) = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha t) $$\n\nThe observed fraction of differences, $p$, between two sequences that diverged from a common ancestor $t$ time units ago, is the probability that the nucleotides at a homologous site are different. The total evolutionary time separating the two sequences is $2t$. The probability of difference between the sequences is equivalent to the probability that a single lineage changes its state over a time interval of $2t$.\nLet $T = 2t$. The probability of observing no change over this total time is $P_{ii}(T) = P_{ii}(2t)$.\n$$ P_{\\text{same}} = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha(2t)) = \\frac{1}{4} + \\frac{3}{4} \\exp(-8\\alpha t) $$\nThe probability of observing a difference, $p$, is $1 - P_{\\text{same}}$:\n$$ p = 1 - \\left( \\frac{1}{4} + \\frac{3}{4} \\exp(-8\\alpha t) \\right) = \\frac{3}{4} (1 - \\exp(-8\\alpha t)) $$\n\nThe expected number of substitutions per site, $d$, is the substitution rate multiplied by the total time elapsed. The rate of substitution from any nucleotide is $3\\alpha$. Over a total time of $2t$, the expected number of substitutions is:\n$$ d = (3\\alpha) \\times (2t) = 6\\alpha t $$\n\nWe must now express $d$ in terms of $p$. From the equation for $p$:\n$$ \\frac{4p}{3} = 1 - \\exp(-8\\alpha t) $$\n$$ \\exp(-8\\alpha t) = 1 - \\frac{4p}{3} $$\n$$ -8\\alpha t = \\ln\\left(1 - \\frac{4p}{3}\\right) $$\nWe need $d = 6\\alpha t$. We can find this from $8\\alpha t$:\n$$ 6\\alpha t = \\frac{6}{8} (8\\alpha t) = \\frac{3}{4} (8\\alpha t) = \\frac{3}{4} \\left[ -\\ln\\left(1 - \\frac{4p}{3}\\right) \\right] $$\nThus, the Jukes-Cantor correction is:\n$$ d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p\\right) $$\n\nNow, we apply this formula to the synonymous and nonsynonymous sites independently.\nGiven $p_{S} = 0.3$:\n$$ d_S = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_S\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.3\\right) $$\n$$ d_S = -\\frac{3}{4} \\ln(1 - 0.4) = -\\frac{3}{4} \\ln(0.6) $$\n\nGiven $p_{N} = 0.05$:\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_N\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.05\\right) $$\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{1}{15}\\right) = -\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right) $$\n\nThe nonsynonymous-to-synonymous rate ratio $\\omega$ is computed as the ratio of $d_N$ to $d_S$:\n$$ \\omega = \\frac{d_N}{d_S} = \\frac{-\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right)}{-\\frac{3}{4} \\ln(0.6)} = \\frac{\\ln(14/15)}{\\ln(0.6)} $$\nWe now compute the numerical value:\n$$ \\ln(0.6) \\approx -0.5108256 $$\n$$ \\ln(14/15) \\approx \\ln(0.9333...) \\approx -0.0689929 $$\n$$ \\omega \\approx \\frac{-0.0689929}{-0.5108256} \\approx 0.135061 $$\nRounding the result to four significant figures, we obtain $\\omega \\approx 0.1351$.", "answer": "$$\\boxed{0.1351}$$", "id": "2754886"}, {"introduction": "While an overall $\\omega$ ratio for a gene is informative, the real power of selection analysis often lies in pinpointing specific amino acid sites that are the targets of adaptation. This advanced practice [@problem_id:2754811] demonstrates how modern phylogenetic methods use site-mixture models to detect positive selection with codon-level precision. You will apply the Bayes Empirical Bayes (BEB) procedure to calculate the posterior probability that a specific site is evolving under positive selection ($\\omega \\gt 1$), showcasing a powerful statistical approach used at the forefront of molecular evolution research.", "problem": "A single protein-coding gene has been analyzed under the codon-substitution mixture model commonly denoted as M8 (Beta and $\\omega1$), where $\\omega = dN/dS$ is the nonsynonymous to synonymous substitution rate ratio. Under this model, sites are drawn from a mixture of latent site classes: a set of classes with $\\omega$ values in $(0,1)$ governed by a Beta distribution (approximated here by a finite set of discrete categories), and one class with $\\omega1$ representing positive selection. The model’s parameters have been estimated by maximum likelihood on a fixed phylogeny and branch lengths. For a particular alignment site, you are given the following for the site-class mixture at the fitted parameter values:\n\n- Discrete approximations to the Beta component: four site classes with $\\omega$ values $ \\omega_{1} = 0.05$, $\\omega_{2} = 0.25$, $\\omega_{3} = 0.55$, $\\omega_{4} = 0.85$ and prior mixture proportions $\\pi_{1} = 0.15$, $\\pi_{2} = 0.25$, $\\pi_{3} = 0.30$, $\\pi_{4} = 0.20$.\n- A positive-selection class with $\\omega_{+} = 2.4$ and prior mixture proportion $\\pi_{+} = 0.10$.\n\nFor this focal site, the class-conditional site log-likelihoods (computed under the codon model with the above $\\omega$ values, conditional on the fixed phylogeny and all other fitted parameters) are:\n- $\\ell_{1} = -210.8$,\n- $\\ell_{2} = -209.5$,\n- $\\ell_{3} = -209.0$,\n- $\\ell_{4} = -208.7$,\n- $\\ell_{+} = -207.9$.\n\nTreat the given prior mixture proportions as the priors over site classes as in the Bayes Empirical Bayes (BEB) framework. Using the provided log-likelihoods, compute the BEB posterior probability that this site belongs to the positive-selection class. Use numerically stable computation when combining log-likelihoods with mixture proportions. Round your final answer to four significant figures. The answer should be dimensionless.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of molecular evolution and statistical phylogenetics, presenting a well-posed question with a complete and consistent set of parameters. It is an objective problem that is formalizable and requires a standard, non-trivial calculation.\n\nThe task is to compute the posterior probability that a specific alignment site belongs to the positive-selection class, given a set of prior probabilities and class-conditional likelihoods. This calculation is a direct application of Bayes' theorem within the Bayes Empirical Bayes (BEB) framework.\n\nLet $C_k$ be the event that the site belongs to class $k$, where the set of classes is indexed by $k \\in \\{1, 2, 3, 4, +\\}$. Let $D$ represent the observed data for the focal site (i.e., the alignment column). According to Bayes' theorem, the posterior probability of the site belonging to class $C_k$ given the data $D$ is:\n$$ P(C_k | D) = \\frac{P(D | C_k) P(C_k)}{P(D)} $$\nIn this context:\n-   $P(C_k)$ is the prior probability of class $k$, which is given by the mixture proportion $\\pi_k$.\n-   $P(D | C_k)$ is the likelihood of the data given class $k$, which we will denote as $L_k$. The problem provides the natural logarithm of the likelihoods, $\\ell_k = \\ln(L_k)$. Therefore, $L_k = \\exp(\\ell_k)$.\n-   $P(D)$ is the marginal likelihood of the data, also known as the evidence. It is calculated by summing the joint probabilities over all possible classes, thus serving as a normalization constant:\n    $$ P(D) = \\sum_{j \\in \\{1, 2, 3, 4, +\\}} P(D, C_j) = \\sum_{j} P(D | C_j) P(C_j) = \\sum_{j} L_j \\pi_j $$\n\nWe are required to compute the posterior probability for the positive-selection class, $C_{+}$. The formula is:\n$$ P(C_{+} | D) = \\frac{L_{+} \\pi_{+}}{\\sum_{j} L_j \\pi_j} = \\frac{\\exp(\\ell_{+}) \\pi_{+}}{\\sum_{j} \\exp(\\ell_{j}) \\pi_{j}} $$\nThe given log-likelihood values are large negative numbers. Direct computation of $\\exp(\\ell_j)$ will lead to numerical underflow, where the values are too small to be represented by standard floating-point arithmetic. To perform a numerically stable calculation, we must rescale the terms. Let $\\ell_{\\max} = \\max_{j} \\{\\ell_j\\}$. We can multiply the numerator and the denominator by $\\exp(-\\ell_{\\max})$ without changing the value of the fraction:\n$$ P(C_{+} | D) = \\frac{\\exp(\\ell_{+}) \\exp(-\\ell_{\\max}) \\pi_{+}}{\\left( \\sum_{j} \\exp(\\ell_{j}) \\pi_{j} \\right) \\exp(-\\ell_{\\max})} = \\frac{\\exp(\\ell_{+} - \\ell_{\\max}) \\pi_{+}}{\\sum_{j} \\exp(\\ell_{j} - \\ell_{\\max}) \\pi_{j}} $$\nThis method ensures that the largest exponent in any term is $0$, preventing underflow.\n\nThe provided parameters are:\n-   Prior proportions: $\\pi_{1} = 0.15$, $\\pi_{2} = 0.25$, $\\pi_{3} = 0.30$, $\\pi_{4} = 0.20$, $\\pi_{+} = 0.10$.\n-   Class-conditional log-likelihoods: $\\ell_{1} = -210.8$, $\\ell_{2} = -209.5$, $\\ell_{3} = -209.0$, $\\ell_{4} = -208.7$, $\\ell_{+} = -207.9$.\n\nFirst, we identify the maximum log-likelihood:\n$$ \\ell_{\\max} = \\max\\{-210.8, -209.5, -209.0, -208.7, -207.9\\} = -207.9 $$\nWe note that $\\ell_{\\max} = \\ell_{+}$.\n\nNext, we compute the unnormalized posterior support for each class, which we denote as $w_j = \\exp(\\ell_j - \\ell_{\\max}) \\pi_j$.\n-   $w_1 = \\exp(-210.8 - (-207.9)) \\times 0.15 = \\exp(-2.9) \\times 0.15$\n-   $w_2 = \\exp(-209.5 - (-207.9)) \\times 0.25 = \\exp(-1.6) \\times 0.25$\n-   $w_3 = \\exp(-209.0 - (-207.9)) \\times 0.30 = \\exp(-1.1) \\times 0.30$\n-   $w_4 = \\exp(-208.7 - (-207.9)) \\times 0.20 = \\exp(-0.8) \\times 0.20$\n-   $w_{+} = \\exp(-207.9 - (-207.9)) \\times 0.10 = \\exp(0) \\times 0.10 = 1 \\times 0.10 = 0.10$\n\nWe proceed with the numerical evaluation of these terms:\n-   $w_1 \\approx 0.055023 \\times 0.15 \\approx 0.008253$\n-   $w_2 \\approx 0.201897 \\times 0.25 \\approx 0.050474$\n-   $w_3 \\approx 0.332871 \\times 0.30 \\approx 0.099861$\n-   $w_4 \\approx 0.449329 \\times 0.20 \\approx 0.089866$\n-   $w_{+} = 0.10$\n\nThe denominator of the posterior probability formula is the sum of these values:\n$$ \\sum_{j} w_j \\approx 0.008253 + 0.050474 + 0.099861 + 0.089866 + 0.10 = 0.348454 $$\nThe numerator is the term for the positive selection class, $w_{+} = 0.10$.\n\nFinally, the posterior probability is the ratio:\n$$ P(C_{+} | D) = \\frac{w_{+}}{\\sum_{j} w_j} \\approx \\frac{0.10}{0.348454} \\approx 0.286981... $$\nThe problem requires the result to be rounded to four significant figures.\n$$ P(C_{+} | D) \\approx 0.2870 $$\nThis value is dimensionless, as is required for a probability.", "answer": "$$\n\\boxed{0.2870}\n$$", "id": "2754811"}]}