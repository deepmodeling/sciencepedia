{"hands_on_practices": [{"introduction": "A central goal of population genetics is to predict the amount of genetic variation expected within a population at equilibrium. This exercise serves as a fundamental building block, guiding you through the derivation of the expected number of segregating sites ($S$) in a sample. By linking the abstract coalescent process to this observable quantity, you will formalize the relationship between mutation, genetic drift, and the patterns of polymorphism we see in sequence data [@problem_id:2737613].", "problem": "A panmictic diploid population of constant size is at mutation-drift equilibrium with effective population size $N_{e}$. Consider a random sample of $n$ homologous sequences, each of length $L$ sites, evolving neutrally under the Infinite-Sites Model (ISM). Mutations occur along genealogical branches as a Poisson process with rate $\\mu$ per site per generation. Let $S$ denote the total number of segregating sites observed in the sample across the $L$ sites. Assume the standard neutral coalescent for a constant-size population, in which when there are $k$ ancestral lineages ($k \\in \\{2,\\dots,n\\}$), the waiting time $T_{k}$ to the next coalescent event is exponentially distributed with mean $\\mathbb{E}[T_{k}]$ that depends on $k$ and $N_{e}$. Define the population-scaled mutation parameter $\\theta$ for this sample as $\\theta = 4 N_{e} \\mu L$.\n\nStarting only from these foundations and the definitions above, derive a closed-form expression for $\\mathbb{E}[S]$ in terms of $\\theta$ and $n$. Your derivation should relate $\\mathbb{E}[S]$ to the expected total branch length of the genealogy and should identify and explain why the dependence on $n$ takes the form of the harmonic number $a_{n-1}$. For the final answer, provide the closed-form expression for $\\mathbb{E}[S]$ using only $\\theta$, $n$, and standard mathematical functions, with no numerical evaluation. No rounding is required and no units should be reported in the final answer.", "solution": "We begin from the Infinite-Sites Model (ISM) and the neutral coalescent under a constant effective population size $N_{e}$. Under ISM, conditional on a fixed genealogy of the $n$ sampled sequences, mutations fall along the branches of the genealogy as a Poisson process with rate $\\mu$ per site per generation. Across $L$ independent sites, the total mutation rate along a branch is $L \\mu$, so the conditional distribution of the total number of mutations on the entire genealogy is Poisson with mean $L \\mu$ times the total branch length (in generations). Because a site mutated at least once becomes segregating under ISM and recurrent mutation is disallowed, the expected number of segregating sites equals the expected total number of mutations across the genealogy. Therefore,\n$$\n\\mathbb{E}[S] \\;=\\; L \\mu \\cdot \\mathbb{E}\\!\\left[\\text{total branch length of the genealogy in generations}\\right].\n$$\n\nThus, the task reduces to computing the expected total branch length of the sample genealogy. Under the standard neutral coalescent for a constant-size diploid population, when there are $k$ ancestral lineages, the time $T_{k}$ to the next coalescent event is exponentially distributed with rate $\\binom{k}{2}/(2 N_{e})$, so its mean is\n$$\n\\mathbb{E}[T_{k}] \\;=\\; \\frac{2 N_{e}}{\\binom{k}{2}} \\;=\\; \\frac{2 N_{e}}{k(k-1)/2} \\;=\\; \\frac{4 N_{e}}{k(k-1)}.\n$$\nDuring the epoch with $k$ lineages, there are $k$ branches extant, so the contribution of that epoch to the total branch length is $k T_{k}$. Summing over epochs from $k=n$ down to $k=2$, the expected total branch length is\n$$\n\\mathbb{E}\\!\\left[\\text{total branch length}\\right]\n\\;=\\; \\sum_{k=2}^{n} k \\, \\mathbb{E}[T_{k}]\n\\;=\\; \\sum_{k=2}^{n} k \\cdot \\frac{4 N_{e}}{k(k-1)}\n\\;=\\; 4 N_{e} \\sum_{k=2}^{n} \\frac{1}{k-1}.\n$$\nRelabeling the index with $i = k-1$ gives\n$$\n\\mathbb{E}\\!\\left[\\text{total branch length}\\right]\n\\;=\\; 4 N_{e} \\sum_{i=1}^{n-1} \\frac{1}{i}.\n$$\n\nSubstituting this into the expression for $\\mathbb{E}[S]$ yields\n$$\n\\mathbb{E}[S]\n\\;=\\; L \\mu \\cdot 4 N_{e} \\sum_{i=1}^{n-1} \\frac{1}{i}\n\\;=\\; \\left(4 N_{e} \\mu L\\right) \\sum_{i=1}^{n-1} \\frac{1}{i}.\n$$\nBy the definition $\\theta = 4 N_{e} \\mu L$, we obtain the closed form\n$$\n\\mathbb{E}[S] \\;=\\; \\theta \\sum_{i=1}^{n-1} \\frac{1}{i}.\n$$\n\nTo explain the harmonic number dependence: the sum $\\sum_{i=1}^{n-1} \\frac{1}{i}$ is the $(n-1)$-th harmonic number, often denoted $a_{n-1}$. Its appearance arises because the expected waiting time between coalescent events with $k$ lineages scales as $\\mathbb{E}[T_{k}] \\propto \\frac{1}{k(k-1)}$, while there are $k$ concurrent branches during that epoch. The product $k \\cdot \\mathbb{E}[T_{k}]$ therefore scales as $\\frac{1}{k-1}$, and summing these contributions from $k=2$ to $k=n$ produces the harmonic series $\\sum_{i=1}^{n-1} \\frac{1}{i}$. Intuitively, as $n$ grows, additional sampled lineages add shorter and shorter coalescent intervals, but because there are more lineages present during those intervals, each stage contributes a term inversely proportional to the number of lineages minus $1$, yielding the harmonic number structure.", "answer": "$$\\boxed{\\theta \\sum_{i=1}^{n-1} \\frac{1}{i}}$$", "id": "2737613"}, {"introduction": "While the expected value of $S$ provides a crucial baseline, a complete understanding requires us to quantify its variability across the genome. This practice delves deeper into the stochastic nature of the evolutionary process by deriving the variance of the number of segregating sites [@problem_id:2737598]. By applying the law of total variance, you will learn to partition the total randomness into two distinct sources: the stochasticity of the mutation process itself and the underlying randomness of the genealogical history.", "problem": "Consider a sample of size $n$ chromosomes drawn from a panmictic diploid population of constant effective size $N_e$ evolving under the neutral infinite-sites model at mutation-drift equilibrium. Let the per-generation mutation rate per haploid genome be $\\mu$, and define the population-scaled mutation rate $\\theta = 4 N_e \\mu$. Assume Kingman’s coalescent, in which, going backward in time, when there are $k$ lineages, the waiting time $T_k$ until the next coalescent event is exponentially distributed with rate $\\binom{k}{2}$, and the waiting times $\\{T_k\\}_{k=2}^{n}$ are independent. Conditional on the genealogy, mutations occur on each lineage as a Poisson process with constant rate, and the number of segregating sites $S$ in the sample equals the total number of mutations on the tree under the infinite-sites assumption. Work in coalescent time scaled in units of $2 N_e$ generations, so that the per-lineage mutation rate per unit coalescent time is $\\theta/2$.\n\nStarting from these foundations and using the law of total variance, derive the variance of the number of segregating sites $S$ across independent loci at equilibrium as a function of $n$ and $\\theta$. Express the final result explicitly as a finite sum in $n$, avoiding undefined shorthand. Additionally, identify the collections of terms that are conventionally denoted $a_{n-1}$ and $b_{n-1}$ and explain their biological interpretation in terms of properties of the coalescent tree.\n\nYour final answer must be a single closed-form analytic expression involving only $n$ and $\\theta$ (finite sums are permitted). No numerical evaluation is required.", "solution": "The problem statement is rigorously grounded in the standard neutral theory of molecular evolution, specifically utilizing Kingman's n-coalescent and the infinite-sites model. All parameters and assumptions are standard, self-contained, and consistent. The problem is well-posed and valid for formal analysis. We proceed with the derivation.\n\nThe objective is to find the variance of the number of segregating sites, $\\text{Var}(S)$. We will employ the law of total variance, conditioning on the total branch length of the coalescent tree. Let $L$ be the total length of all branches in the genealogy, measured in units of $2 N_e$ generations. The tree is composed of intervals during which there are $k$ distinct ancestral lineages, for $k$ from $n$ down to $2$. The time spent in the state with $k$ lineages is $T_k$. The total length of the tree is the sum of the products of the number of lineages and the duration of the interval:\n$$L = \\sum_{k=2}^{n} k T_k$$\nThe waiting time $T_k$ until the next coalescent event is given as an exponential random variable with rate $\\lambda_k = \\binom{k}{2}$. The times $\\{T_k\\}_{k=2}^{n}$ are mutually independent.\n\nUnder the infinite-sites model, mutations occur as a Poisson process along the branches of the tree. The rate of mutation per lineage per unit of coalescent time is given as $\\theta/2$. Conditional on the total tree length $L$, the total number of mutations $S$ follows a Poisson distribution with a mean equal to the product of the rate and the total length.\n$$S | L \\sim \\text{Poisson}\\left(\\frac{\\theta}{2} L\\right)$$\nFor a Poisson distribution with parameter $\\lambda$, both the expectation and the variance are equal to $\\lambda$. Thus, the conditional expectation and variance of $S$ are:\n$$\\text{E}[S | L] = \\frac{\\theta}{2} L$$\n$$\\text{Var}(S | L) = \\frac{\\theta}{2} L$$\nThe law of total variance states:\n$$\\text{Var}(S) = \\text{E}[\\text{Var}(S | L)] + \\text{Var}(\\text{E}[S | L])$$\nSubstituting our conditional moments into this formula, we obtain:\n$$\\text{Var}(S) = \\text{E}\\left[\\frac{\\theta}{2} L\\right] + \\text{Var}\\left(\\frac{\\theta}{2} L\\right)$$\nUsing the properties of expectation and variance, where $\\text{E}[cX] = c\\text{E}[X]$ and $\\text{Var}(cX) = c^2\\text{Var}(X)$ for a constant $c$, this becomes:\n$$\\text{Var}(S) = \\frac{\\theta}{2} \\text{E}[L] + \\frac{\\theta^2}{4} \\text{Var}(L)$$\nOur task is now reduced to finding the expectation and variance of the total tree length, $L$.\n\nFor an exponential distribution $T_k \\sim \\text{Exp}(\\lambda_k)$ with $\\lambda_k = \\binom{k}{2}$, the moments are $\\text{E}[T_k] = 1/\\lambda_k$ and $\\text{Var}(T_k) = 1/\\lambda_k^2$.\n\nFirst, we calculate the expectation of $L$:\n$$\\text{E}[L] = \\text{E}\\left[\\sum_{k=2}^{n} k T_k\\right] = \\sum_{k=2}^{n} k \\text{E}[T_k]$$\n$$\\text{E}[L] = \\sum_{k=2}^{n} k \\frac{1}{\\binom{k}{2}} = \\sum_{k=2}^{n} k \\frac{2}{k(k-1)} = \\sum_{k=2}^{n} \\frac{2}{k-1}$$\nBy changing the index of summation $i = k-1$, the sum runs from $i=1$ to $i=n-1$:\n$$\\text{E}[L] = 2 \\sum_{i=1}^{n-1} \\frac{1}{i}$$\nThis sum is conventionally written as $2 a_{n-1}$, where $a_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i}$.\n\nNext, we calculate the variance of $L$. Since the waiting times $\\{T_k\\}$ are independent, the variance of the sum is the sum of the variances:\n$$\\text{Var}(L) = \\text{Var}\\left(\\sum_{k=2}^{n} k T_k\\right) = \\sum_{k=2}^{n} \\text{Var}(k T_k) = \\sum_{k=2}^{n} k^2 \\text{Var}(T_k)$$\n$$\\text{Var}(L) = \\sum_{k=2}^{n} k^2 \\frac{1}{\\left(\\binom{k}{2}\\right)^2} = \\sum_{k=2}^{n} k^2 \\left(\\frac{2}{k(k-1)}\\right)^2 = \\sum_{k=2}^{n} k^2 \\frac{4}{k^2(k-1)^2} = \\sum_{k=2}^{n} \\frac{4}{(k-1)^2}$$\nAgain, changing the index $i = k-1$:\n$$\\text{Var}(L) = 4 \\sum_{i=1}^{n-1} \\frac{1}{i^2}$$\nThis sum is conventionally written as $4 b_{n-1}$, where $b_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i^2}$.\n\nNow we substitute the expressions for $\\text{E}[L]$ and $\\text{Var}(L)$ back into our equation for $\\text{Var}(S)$:\n$$\\text{Var}(S) = \\frac{\\theta}{2} \\left(2 \\sum_{i=1}^{n-1} \\frac{1}{i}\\right) + \\frac{\\theta^2}{4} \\left(4 \\sum_{i=1}^{n-1} \\frac{1}{i^2}\\right)$$\n$$\\text{Var}(S) = \\theta \\sum_{i=1}^{n-1} \\frac{1}{i} + \\theta^2 \\sum_{i=1}^{n-1} \\frac{1}{i^2}$$\nThis is the final expression for the variance of the number of segregating sites.\n\nThe problem requires identification and interpretation of the terms $a_{n-1}$ and $b_{n-1}$.\nThe term $a_{n-1}$ is the sum $\\sum_{i=1}^{n-1} \\frac{1}{i}$. It relates to the expected total length of the coalescent tree, $\\text{E}[L] = 2 a_{n-1}$. Therefore, $a_{n-1}$ represents half the expected total branch length of the genealogy. Its biological interpretation is that it quantifies the average amount of evolutionary time, scaled in units of $2 N_e$ generations, during which mutations can accumulate on the ancestral lineages of the sample. The first component of the variance, $\\theta a_{n-1}$, is equal to the expected number of segregating sites, $\\text{E}[S]$. This component reflects the stochasticity inherent in the Poisson mutation process itself, superimposed on a genealogy of average length.\n\nThe term $b_{n-1}$ is the sum $\\sum_{i=1}^{n-1} \\frac{1}{i^2}$. It relates to the variance of the total length of the coalescent tree, $\\text{Var}(L) = 4 b_{n-1}$. Thus, $b_{n-1}$ represents one quarter of the variance in the total branch length of the genealogy. Its biological interpretation is that it quantifies the variability in the evolutionary history of the sample due to the random nature of the coalescent process. Different realizations of the genealogy will have different total branch lengths, and $b_{n-1}$ captures this stochastic fluctuation. The second component of the variance, $\\theta^2 b_{n-1}$, directly arises from this genealogical variance, representing the contribution to $\\text{Var}(S)$ from randomness in the tree structure itself.", "answer": "$$\\boxed{\\theta \\left( \\sum_{i=1}^{n-1} \\frac{1}{i} \\right) + \\theta^2 \\left( \\sum_{i=1}^{n-1} \\frac{1}{i^2} \\right)}$$", "id": "2737598"}, {"introduction": "Armed with an understanding of the expectation and variance of genetic variation, we can now use these principles for hypothesis testing. This problem introduces a second estimator for the population mutation parameter, $\\theta$, based on the average number of differences between pairs of sequences ($\\hat{\\pi}$). By comparing the behavior of $\\hat{\\pi}$ with that of the estimator based on the number of segregating sites ($\\hat{\\theta}_W$), you will understand the theoretical basis of Tajima's $D$ statistic, a powerful tool for detecting deviations from the standard neutral model of evolution [@problem_id:2737616].", "problem": "A panmictic diploid population of constant effective size is evolving neutrally under the infinite-sites mutation model with per-site mutation rate $\\mu$ and no overlapping generations. Let $N_e$ denote the effective population size and define $\\theta \\equiv 4 N_e \\mu$. A sample of size $n$ sequences is taken from this population. Consider two classical per-site estimators of $\\theta$: (i) the average pairwise nucleotide diversity $\\hat{\\pi}$ (the mean number of pairwise differences per site across all $\\binom{n}{2}$ pairs in the sample), and (ii) Watterson’s estimator $\\hat{\\theta}_W \\equiv S/(a_1 L)$, where $S$ is the number of segregating sites across a locus of length $L$ sites, and $a_1 \\equiv \\sum_{i=1}^{n-1} 1/i$.\n\nStarting from fundamental coalescent expectations under the standard neutral model (SNM; neutral evolution, constant $N_e$, panmixia, and infinite-sites mutational process), determine the expected value of $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ for any $n \\ge 2$, and explain why this expectation takes that value in terms of the expected pairwise coalescent time and the expected total genealogical branch length. Then, interpret how the sign of an observed deviation of $\\hat{\\pi} - \\hat{\\theta}_W$ from its SNM expectation can indicate departures from mutation-drift equilibrium via distortions of the site frequency spectrum (the distribution of allele frequencies across polymorphic sites).\n\nWhich of the following statements are correct?\n\nA. Under the SNM with infinite-sites, for any sample size $n$, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$ because both $\\hat{\\pi}$ and $\\hat{\\theta}_W$ are unbiased for $\\theta = 4 N_e \\mu$. Observing $\\hat{\\pi}  \\hat{\\theta}_W$ suggests an excess of intermediate-frequency variants relative to mutation-drift equilibrium, as expected under balancing selection or population subdivision.\n\nB. Under the SNM, the presence of recombination changes $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ away from $0$ because recombination reduces linkage disequilibrium among sites.\n\nC. Observing $\\hat{\\pi} - \\hat{\\theta}_W  0$ is characteristic of an excess of low-frequency polymorphisms, as expected after a recent population expansion, under purifying selection against deleterious variants, or following a recent hard selective sweep.\n\nD. In any demographic scenario that is at mutation-drift equilibrium, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$ even if the population has undergone a recent change in size.\n\nE. Under the SNM, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ depends on $n$ through the harmonic term $a_1$, so it generally differs from $0$ unless $n$ is large.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n### Step 1: Extract Givens\n- Population model: Panmictic, diploid, constant effective size $N_e$, no overlapping generations.\n- Evolutionary model: Neutral evolution, infinite-sites mutation model.\n- Parameters: Per-site mutation rate $\\mu$, population mutation rate $\\theta \\equiv 4 N_e \\mu$.\n- Sample: $n$ sequences.\n- Estimators of $\\theta$:\n    - $\\hat{\\pi}$: average pairwise nucleotide diversity (mean number of pairwise differences per site across all $\\binom{n}{2}$ pairs).\n    - $\\hat{\\theta}_W \\equiv S/(a_1 L)$: Watterson’s estimator, where $S$ is the number of segregating sites in a locus of length $L$, and $a_1 \\equiv \\sum_{i=1}^{n-1} 1/i$.\n- Task:\n    1. Determine the expected value $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ under the standard neutral model (SNM) for $n \\ge 2$.\n    2. Explain the result in terms of coalescent theory.\n    3. Interpret the sign of an observed deviation from this expectation as an indicator of departure from mutation-drift equilibrium.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is formulated within the standard framework of coalescent theory, a cornerstone of modern population genetics.\n- **Scientifically Grounded:** All concepts—panmixia, effective population size, neutral evolution, infinite-sites model, coalescent theory, and the estimators $\\hat{\\pi}$ and $\\hat{\\theta}_W$—are fundamental and well-established in evolutionary biology. The parameterization $\\theta = 4 N_e \\mu$ is standard for diploid organisms.\n- **Well-Posed:** The problem asks for the expectation of a well-defined statistic under a precisely specified model (the SNM). The existence of a unique, meaningful solution is guaranteed.\n- **Objective:** The problem is stated using precise, standard terminology, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and objective. It is a valid theoretical problem in population genetics. We may proceed with the solution.\n\n---\n\nThe task is to compute the expectation of the difference between two estimators for the population mutation rate, $\\theta$. This quantity is the numerator of Tajima's D statistic. We shall derive the expectation of each estimator separately under the Standard Neutral Model (SNM).\n\n**1. Expectation of the Pairwise Nucleotide Diversity, $\\mathbb{E}[\\hat{\\pi}]$**\n\nThe estimator $\\hat{\\pi}$ is the average number of nucleotide differences per site between all possible pairs of sequences in a sample of size $n$. By linearity of expectation, the expectation of this average is equal to the expectation of the number of differences between any single randomly chosen pair of sequences. Let us denote the number of differences per site between two sequences as $\\pi_{ij}$.\n$$\n\\mathbb{E}[\\hat{\\pi}] = \\mathbb{E}\\left[ \\frac{1}{\\binom{n}{2}} \\sum_{ij} \\pi_{ij} \\right] = \\frac{1}{\\binom{n}{2}} \\sum_{ij} \\mathbb{E}[\\pi_{ij}]\n$$\nSince all pairs are equivalent under the SNM, $\\mathbb{E}[\\pi_{ij}]$ is the same for all pairs $(i,j)$. Let this be $\\mathbb{E}[\\pi]$.\n$$\n\\mathbb{E}[\\hat{\\pi}] = \\mathbb{E}[\\pi]\n$$\nThe number of differences between two sequences depends on their shared history. In the coalescent framework, two lineages trace back to a most recent common ancestor (MRCA). The time to coalescence for two lineages, $T_2$, in a diploid population of effective size $N_e$ is exponentially distributed with a mean of $2N_e$ generations.\n$$\n\\mathbb{E}[T_2] = 2N_e\n$$\nMutations accumulate along the two branches leading from the MRCA to the present-day sequences. The total length of these two branches is $2 \\times T_2$. The expected total branch length for the pair is therefore:\n$$\n\\mathbb{E}[\\text{Total Branch Length for a Pair}] = 2 \\times \\mathbb{E}[T_2] = 2 \\times (2N_e) = 4N_e \\text{ generations}\n$$\nUnder the infinite-sites model, each mutation creates a new polymorphic site. Mutations occur at a rate $\\mu$ per site per generation. The expected number of differences per site is the mutation rate multiplied by the expected total branch length.\n$$\n\\mathbb{E}[\\pi] = \\mu \\times (4N_e) = 4N_e\\mu\n$$\nBy definition, $\\theta = 4N_e\\mu$. Therefore,\n$$\n\\mathbb{E}[\\hat{\\pi}] = \\theta\n$$\nThis demonstrates that $\\hat{\\pi}$ is an unbiased estimator of $\\theta$ under the SNM.\n\n**2. Expectation of Watterson’s Estimator, $\\mathbb{E}[\\hat{\\theta}_W]$**\n\nWatterson's estimator is defined as $\\hat{\\theta}_W = S / (a_1 L)$, where $S$ is the total number of segregating (polymorphic) sites across a locus of length $L$. Let us find the expectation $\\mathbb{E}[S]$.\nThe number of segregating sites $S$ is the result of mutations occurring on the entire genealogical tree of the sample of $n$ lineages. The expected number of segregating sites is the total mutation rate for the locus, $L\\mu$, multiplied by the expected total length of the genealogical tree, $\\mathbb{E}[T_{total}]$.\n$$\n\\mathbb{E}[S] = (L\\mu) \\times \\mathbb{E}[T_{total}]\n$$\nThe total length of the tree, $T_{total}$, is the sum of the lengths of all branches. We compute its expectation by summing the contributions from each coalescent interval. The coalescent process for a sample of size $n$ starts with $n$ lineages and ends when only one lineage (the MRCA of the sample) remains. The interval during which there are $k$ distinct lineages is denoted $T_k$. The time $T_k$ is exponentially distributed with rate $\\binom{k}{2} / (2N_e)$. Its expectation is:\n$$\n\\mathbb{E}[T_k] = \\frac{2N_e}{\\binom{k}{2}} = \\frac{2N_e}{k(k-1)/2} = \\frac{4N_e}{k(k-1)} \\text{ for } k = 2, 3, \\ldots, n\n$$\nDuring the interval $T_k$, there are $k$ active lineages. The total branch length contributed during this time is $k \\times T_k$. The expected total length of the genealogy is the sum of the expected contributions from each interval from $k=n$ down to $k=2$.\n$$\n\\mathbb{E}[T_{total}] = \\sum_{k=2}^{n} \\mathbb{E}[k \\cdot T_k] = \\sum_{k=2}^{n} k \\cdot \\mathbb{E}[T_k] = \\sum_{k=2}^{n} k \\cdot \\frac{4N_e}{k(k-1)} = 4N_e \\sum_{k=2}^{n} \\frac{1}{k-1}\n$$\nBy re-indexing with $j=k-1$, the sum becomes:\n$$\n\\mathbb{E}[T_{total}] = 4N_e \\sum_{j=1}^{n-1} \\frac{1}{j} = 4N_e a_1\n$$\nwhere $a_1 = \\sum_{i=1}^{n-1} 1/i$ is the $(n-1)$-th harmonic number.\nNow we can compute the expected number of segregating sites:\n$$\n\\mathbb{E}[S] = (L\\mu) \\times (4N_e a_1) = (4N_e\\mu) L a_1 = \\theta L a_1\n$$\nFinally, the expectation of Watterson's estimator is:\n$$\n\\mathbb{E}[\\hat{\\theta}_W] = \\mathbb{E}\\left[\\frac{S}{a_1 L}\\right] = \\frac{1}{a_1 L} \\mathbb{E}[S] = \\frac{1}{a_1 L} (\\theta L a_1) = \\theta\n$$\nThis demonstrates that $\\hat{\\theta}_W$ is also an unbiased estimator of $\\theta$ under the SNM.\n\n**3. Expectation of the Difference and Interpretation**\n\nUsing the linearity of expectation:\n$$\n\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = \\mathbb{E}[\\hat{\\pi}] - \\mathbb{E}[\\hat{\\theta}_W] = \\theta - \\theta = 0\n$$\nUnder the SNM, the expected value of the difference $\\hat{\\pi} - \\hat{\\theta}_W$ is exactly zero for any sample size $n \\ge 2$.\n\nThe two estimators are sensitive to different features of the site frequency spectrum (SFS), which is the distribution of allele frequencies at polymorphic sites.\n- $\\hat{\\pi}$ is a measure of heterozygosity. An allele with frequency $p$ contributes to pairwise differences in proportion to $p(1-p)$. This term is maximized for intermediate-frequency alleles ($p$ near $0.5$). Thus, $\\hat{\\pi}$ is most sensitive to common polymorphisms.\n- $\\hat{\\theta}_W$ is proportional to the number of segregating sites, $S$. It gives equal weight to any polymorphic site, regardless of its allele frequency. Since new mutations arise as rare alleles (singletons in a sample), and under the SNM there is an excess of rare alleles, $\\hat{\\theta}_W$ is strongly influenced by low-frequency variants.\n\nA non-zero value for an observed difference $\\hat{\\pi} - \\hat{\\theta}_W$ indicates that the SFS deviates from the SNM expectation, suggesting a departure from mutation-drift equilibrium due to demography or selection.\n- **$\\hat{\\pi} - \\hat{\\theta}_W  0$**: This indicates an excess of intermediate-frequency alleles relative to rare alleles. $\\hat{\\pi}$ is inflated more than $\\hat{\\theta}_W$. This pattern is created by:\n    - **Balancing selection**: Maintains alleles at intermediate frequencies.\n    - **Population subdivision**: When sampling from structured populations, alleles that are at high frequency in different subpopulations appear as intermediate-frequency polymorphisms in the combined sample.\n    - **Population bottleneck (contraction)**: Genetic drift is intensified, preferentially removing rare alleles and increasing the relative proportion of common alleles.\n- **$\\hat{\\pi} - \\hat{\\theta}_W  0$**: This indicates an excess of rare alleles and a deficit of intermediate-frequency alleles. $\\hat{\\theta}_W$ is inflated by the many rare variants, while $\\hat{\\pi}$ is not. This pattern is created by:\n    - **Recent population expansion**: The population grows, and many new mutations appear. These are all recent and thus at low frequencies. The genealogy of a rapidly expanding population resembles a star-like phylogeny with long terminal branches, leading to an excess of singletons.\n    - **Purifying (negative) selection**: Removes deleterious alleles, preventing them from reaching high frequencies. This results in an observed excess of rare, deleterious (or linked neutral) variants.\n    - **Recent selective sweep**: A beneficial mutation sweeps to fixation, purging linked neutral variation. Subsequently, new mutations accumulate on the homogeneous genetic background, all of which are recent and therefore rare.\n\n### Option-by-Option Analysis\n\n**A. Under the SNM with infinite-sites, for any sample size $n$, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$ because both $\\hat{\\pi}$ and $\\hat{\\theta}_W$ are unbiased for $\\theta = 4 N_e \\mu$. Observing $\\hat{\\pi}  \\hat{\\theta}_W$ suggests an excess of intermediate-frequency variants relative to mutation-drift equilibrium, as expected under balancing selection or population subdivision.**\nThe first part is precisely what we derived: both estimators are unbiased for $\\theta$, so the expectation of their difference is $0$. The second part correctly interprets a positive deviation ($\\hat{\\pi}  \\hat{\\theta}_W$) as a signal of excess intermediate-frequency variants and lists correct causal factors. This statement is entirely correct.\n**Verdict: Correct**\n\n**B. Under the SNM, the presence of recombination changes $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ away from $0$ because recombination reduces linkage disequilibrium among sites.**\nRecombination breaks apart linkage blocks, meaning different sites can have different genealogical histories. However, the expectation of a per-site measure like $\\hat{\\pi}$ or $\\hat{\\theta}_W$ is an average over the distribution of possible genealogies. Under the SNM assumptions (including constant $N_e$), the statistical properties of the genealogy at any single site are unchanged by recombination occurring elsewhere. Therefore, $\\mathbb{E}[\\hat{\\pi}] = \\theta$ and $\\mathbb{E}[\\hat{\\theta}_W] = \\theta$ at any given site, and also for the average over a locus. Recombination affects the *variance* of the estimators, but not their expectation. Thus, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ remains $0$.\n**Verdict: Incorrect**\n\n**C. Observing $\\hat{\\pi} - \\hat{\\theta}_W  0$ is characteristic of an excess of low-frequency polymorphisms, as expected after a recent population expansion, under purifying selection against deleterious variants, or following a recent hard selective sweep.**\nThis statement correctly interprets a negative deviation ($\\hat{\\pi}  \\hat{\\theta}_W$) as a signal of an excess of rare (low-frequency) variants. It also correctly lists the primary textbook examples of evolutionary processes that produce such a pattern: population expansion, purifying selection, and selective sweeps.\n**Verdict: Correct**\n\n**D. In any demographic scenario that is at mutation-drift equilibrium, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$ even if the population has undergone a recent change in size.**\nThis statement is logically contradictory. A population that has undergone a \"recent change in size\" is, by definition, not at demographic equilibrium. Its Site Frequency Spectrum is perturbed and is in a transient state, relaxing towards a new equilibrium. It is precisely these non-equilibrium dynamics that cause $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ to be non-zero. The condition \"at mutation-drift equilibrium\" and \"has undergone a recent change in size\" are mutually exclusive. If a population is at any stationary mutation-drift equilibrium (constant size or other stable demographic model), then the SFS is stable, and the expectations of the estimators can be calculated; for the SNM, this expectation is $0$. But a recent size change invalidates the equilibrium assumption.\n**Verdict: Incorrect**\n\n**E. Under the SNM, $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ depends on $n$ through the harmonic term $a_1$, so it generally differs from $0$ unless $n$ is large.**\nOur derivation shows that $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$ for *any* sample size $n \\ge 2$. While the term $a_1$ is present in the derivation of $\\mathbb{E}[\\hat{\\theta}_W]$, it arises from the total branch length of the genealogy and is canceled out exactly by the definition of $\\hat{\\theta}_W$. The expectation of the difference is identically zero and does not depend on $n$.\n**Verdict: Incorrect**", "answer": "$$\\boxed{AC}$$", "id": "2737616"}]}