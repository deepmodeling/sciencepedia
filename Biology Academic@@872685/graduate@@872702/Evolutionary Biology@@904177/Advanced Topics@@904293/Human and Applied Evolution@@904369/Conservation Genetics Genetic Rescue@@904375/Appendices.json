{"hands_on_practices": [{"introduction": "The primary motivation for genetic rescue is to alleviate inbreeding depression by introducing new genetic variation. This exercise provides a foundational, quantitative understanding of this process by modeling the immediate impact of migration on the population's average inbreeding coefficient. By deriving the relationship between the fraction of migrants ($m$) and the resulting inbreeding coefficient ($F'$) from first principles, you will gain a clear intuition for how rescue interventions are planned and how their initial genetic effect is predicted. [@problem_id:2698723]", "problem": "A small, isolated vertebrate population has an inbreeding coefficient $F_{\\mathrm{R}} = 0.25$ measured relative to a base population with negligible identity by descent. A conservation manager considers a single-generation genetic rescue by mixing this population with an introduced donor group. Let $m$ be the fraction of breeding adults that are immigrants drawn from a large, unrelated donor population. Assume the following:\n- Donors are unrelated among themselves and to all residents, so their inbreeding coefficient is $F_{\\mathrm{M}} = 0$, and the kinship between any donor and any resident is $0$.\n- After the immigrant pulse, mating is random among all adults, with equal contributions to the gamete pool from immigrants and residents proportional to their frequencies.\n- The inbreeding coefficient $F$ is defined as the probability that the two alleles at a locus in a randomly chosen individual are identical by descent (IBD).\n- Consider only the first offspring generation immediately following the pulse (ignore pedigree relationships beyond parental origin in that generation).\n\nStarting from the definition of $F$ as an IBD probability and basic probability rules for mixtures of independent sources, derive the expression for the expected offspring inbreeding coefficient $F'$ after the pulse as a function of $F_{\\mathrm{R}}$ and $m$, and then determine the smallest value of $m$ such that $F'$ is reduced from $0.25$ to $0.10$ in one generation.\n\nProvide the final value of $m$ as a decimal fraction (not a percentage). Round your answer to four significant figures.", "solution": "The problem first requires a validation of its statement.\n\nStep 1: Extract Givens\n- Initial inbreeding coefficient of resident population: $F_{\\mathrm{R}} = 0.25$.\n- Fraction of breeding adults that are immigrants (donors): $m$.\n- Donor population characteristics: Inbreeding coefficient $F_{\\mathrm{M}} = 0$, donors are unrelated among themselves, and donors are unrelated to all residents (kinship between any donor and any resident is $0$).\n- Event: A single generation of genetic rescue (immigrant pulse).\n- Mating system after pulse: Random mating among all adults (residents and donors).\n- Proportional contribution to gamete pool: Immigrants and residents contribute in proportion to their frequencies ($m$ and $1-m$).\n- Definition of inbreeding coefficient $F$: The probability that the two alleles at a locus in a randomly chosen individual are identical by descent (IBD).\n- Objective:\n    1. Derive the expression for the expected offspring inbreeding coefficient $F'$ as a function of $F_{\\mathrm{R}}$ and $m$.\n    2. Determine the smallest value of $m$ such that $F'$ is reduced to $0.10$.\n    3. Provide the final value of $m$ rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard application of fundamental principles of population genetics, specifically admixture and inbreeding theory. The concepts of inbreeding coefficient ($F$), identity by descent (IBD), and genetic rescue through admixture are central to conservation genetics. The problem is well-posed, with all necessary parameters and conditions defined, leading to a unique and meaningful solution. The language is objective and precise. The assumptions (e.g., random mating, properties of the donor population) are explicit and standard for such models. The problem does not violate any of the invalidity criteria. It is a valid, solvable problem in evolutionary biology.\n\nStep 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\nThe inbreeding coefficient of an individual in the next generation, which we denote as $F'$, is the probability that the two alleles at a given locus in that individual are identical by descent (IBD). An individual receives one allele from its sire and one from its dam. Therefore, $F'$ is equivalent to the kinship coefficient between its parents. With random mating in the admixed population, the expected inbreeding coefficient of the offspring generation, $F'$, is the weighted average of the kinship coefficients for all possible types of parental pairs.\n\nThe admixed population consists of two groups: original residents (R) and new immigrants (M, for migrants). The proportion of residents is $(1-m)$ and the proportion of immigrants is $m$. Under random mating, a parent is drawn from the resident group with probability $(1-m)$ and from the immigrant group with probability $m$. Since the sire and dam are chosen independently, we have four possible mating types with the following probabilities:\n1. Both parents are residents (R $\\times$ R): $P(\\text{R} \\times \\text{R}) = (1-m) \\times (1-m) = (1-m)^2$\n2. Sire is resident, dam is immigrant (R $\\times$ M): $P(\\text{R} \\times \\text{M}) = (1-m) \\times m$\n3. Sire is immigrant, dam is resident (M $\\times$ R): $P(\\text{M} \\times \\text{R}) = m \\times (1-m)$\n4. Both parents are immigrants (M $\\times$ M): $P(\\text{M} \\times \\text{M}) = m \\times m = m^2$\n\nThe expected inbreeding coefficient of an offspring, $F'$, is the average kinship coefficient of the parental pairs, weighted by the frequency of each pairing type. Let $\\phi_{XY}$ be the average kinship between a randomly chosen individual from group X and a randomly chosen individual from group Y. The problem statement gives us the necessary kinship values:\n- The average kinship between two randomly chosen residents, $\\phi_{\\mathrm{RR}}$, is equal to the inbreeding coefficient of the resident population, $F_{\\mathrm{R}}$. Thus, $\\phi_{\\mathrm{RR}} = F_{\\mathrm{R}} = 0.25$.\n- The kinship between any donor and any resident is given as $0$. Thus, $\\phi_{\\mathrm{RM}} = \\phi_{\\mathrm{MR}} = 0$.\n- The donors are unrelated among themselves. Thus, the average kinship between two randomly chosen immigrants is $\\phi_{\\mathrm{MM}} = 0$.\n\nThe expected offspring inbreeding coefficient $F'$ is calculated as follows:\n$$F' = P(\\text{R} \\times \\text{R}) \\cdot \\phi_{\\mathrm{RR}} + P(\\text{R} \\times \\text{M}) \\cdot \\phi_{\\mathrm{RM}} + P(\\text{M} \\times \\text{R}) \\cdot \\phi_{\\mathrm{MR}} + P(\\text{M} \\times \\text{M}) \\cdot \\phi_{\\mathrm{MM}}$$\nSubstituting the probabilities and kinship values:\n$$F' = (1-m)^2 \\cdot F_{\\mathrm{R}} + (1-m)m \\cdot 0 + m(1-m) \\cdot 0 + m^2 \\cdot 0$$\nThis simplifies to the required expression for $F'$ as a function of $F_{\\mathrm{R}}$ and $m$:\n$$F' = F_{\\mathrm{R}}(1-m)^2$$\nThis result is logical, as IBD in the offspring can only arise if both alleles are inherited from the original, inbred resident gene pool. The probability of drawing two gametes that both originate from residents is $(1-m)^2$, and the conditional probability that these two gametes are IBD is $F_{\\mathrm{R}}$.\n\nNow, we must solve for the value of $m$ that reduces the inbreeding coefficient from $F_{\\mathrm{R}} = 0.25$ to $F' = 0.10$. We substitute these values into the derived equation:\n$$0.10 = 0.25(1-m)^2$$\nFirst, we isolate the term $(1-m)^2$:\n$$(1-m)^2 = \\frac{0.10}{0.25} = \\frac{10}{25} = \\frac{2}{5} = 0.4$$\nNext, we take the square root of both sides. Since $m$ is a fraction of the population, $0 \\le m \\le 1$, which implies that $(1-m) \\ge 0$. Therefore, we only need to consider the positive root:\n$$1-m = \\sqrt{0.4}$$\nSolving for $m$:\n$$m = 1 - \\sqrt{0.4}$$\nTo obtain the numerical value, we compute the square root of $0.4$:\n$$\\sqrt{0.4} = \\sqrt{\\frac{4}{10}} = \\frac{2}{\\sqrt{10}} = \\frac{2\\sqrt{10}}{10} = \\frac{\\sqrt{10}}{5} \\approx 0.6324555...$$\nSubstituting this back into the expression for $m$:\n$$m \\approx 1 - 0.6324555... = 0.3675444...$$\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $4$, so we round down.\n$$m \\approx 0.3675$$\nThis is the smallest fraction of immigrants required to achieve the target reduction in inbreeding in a single generation under the specified conditions.", "answer": "$$\n\\boxed{0.3675}\n$$", "id": "2698723"}, {"introduction": "While genetic rescue can provide an immediate fitness boost through heterosis, it is not without risks, the most prominent being outbreeding depression. This phenomenon can occur when recombination in later generations breaks down favorable gene combinations, leading to a decline in fitness. This practice explores the genetic mechanisms of F2 breakdown by asking you to model how mean population fitness changes as a function of recombination rate ($r$) in a system with epistasis, providing a crucial perspective on the potential long-term consequences of admixture. [@problem_id:2698689]", "problem": "A small island population is the target of a genetic rescue. Two inbred source populations, denoted by population $\\mathcal{P}_{1}$ and population $\\mathcal{P}_{2}$, are fixed for different recessive deleterious alleles at two nuclear loci, $A$ and $B$, that are on the same autosome. Specifically, population $\\mathcal{P}_{1}$ is fixed for genotype $aaBB$ and population $\\mathcal{P}_{2}$ is fixed for genotype $AAbb$. A single round of rescue introduces migrants from both sources and produces first-generation hybrids (F1) that are all double heterozygotes $AaBb$. These F1 individuals then randomly mate among themselves to form the second generation (F2). Assume standard Mendelian segregation, no segregation distortion, and no viability selection prior to zygote formation. Let the recombination fraction between loci $A$ and $B$ in F1 meioses be $r$, with $0 \\le r \\le \\tfrac{1}{2}$.\n\nDefine per-locus fitness contributions as follows. For locus $A$, the fitnesses are $w_{AA} = 1$, $w_{Aa} = 1 - h_{A} s_{A}$, and $w_{aa} = 1 - s_{A}$. For locus $B$, the fitnesses are $w_{BB} = 1$, $w_{Bb} = 1 - h_{B} s_{B}$, and $w_{bb} = 1 - s_{B}$. Across loci, assume multiplicative fitness with an additional synergistic epistasis penalty $e$ applied only to the double-homozygous deleterious genotype $aabb$, so that the two-locus fitness is\n$$\nW = \\big(w_{A\\cdot}\\big)\\big(w_{B\\cdot}\\big)\\times\n\\begin{cases}\n1 - e,  \\text{if the genotype is } aabb,\\\\\n1,  \\text{otherwise}.\n\\end{cases}\n$$\n\nTake biologically plausible parameter values $s_{A} = 0.6$, $h_{A} = 0.1$, $s_{B} = 0.5$, $h_{B} = 0.2$, and $e = 0.4$. Under these values, F1 heterosis arises because $AaBb$ masks distinct recessive loads, whereas F2 recombination can reveal double homozygotes that express synergistic epistasis.\n\nUsing only Mendelian segregation and the definition of recombination in a two-locus F1 double heterozygote, derive the expected mean fitness in F2 as a function of the recombination fraction $r$ by averaging over all F2 two-locus genotypes formed by random union of F1 gametes. Then subtract the F1 mean fitness to obtain the expected mean fitness change $\\Delta(r) = \\mathbb{E}[W_{\\mathrm{F2}}](r) - W_{\\mathrm{F1}}$. Express your final answer as a closed-form polynomial in $r$. Do not include units. No rounding is required.", "solution": "The problem statement has been subjected to rigorous validation and is deemed to be scientifically grounded, well-posed, and objective. It represents a standard, albeit specific, problem in two-locus population genetics theory. All necessary parameters and conditions are provided for a unique solution. We shall therefore proceed with the derivation.\n\nThe objective is to derive the expression for the change in mean fitness from the F1 to the F2 generation, $\\Delta(r) = \\mathbb{E}[W_{\\mathrm{F2}}](r) - W_{\\mathrm{F1}}$, as a function of the recombination fraction $r$.\n\nFirst, we determine the mean fitness of the F1 generation, $W_{\\mathrm{F1}}$. The problem states that the F1 generation consists entirely of individuals with the genotype $AaBb$. Therefore, the mean fitness of this generation is the fitness of this specific genotype. According to the multiplicative fitness model provided,\n$$W_{\\mathrm{F1}} = W_{AaBb} = w_{Aa} \\cdot w_{Bb} = (1 - h_{A} s_{A})(1 - h_{B} s_{B})$$\nThe synergistic epistasis term does not apply as the genotype is not $aabb$. We substitute the given parameter values: $s_{A} = 0.6$, $h_{A} = 0.1$, $s_{B} = 0.5$, and $h_{B} = 0.2$.\n$$h_{A} s_{A} = 0.1 \\times 0.6 = 0.06$$\n$$h_{B} s_{B} = 0.2 \\times 0.5 = 0.1$$\nThus, the F1 fitness is:\n$$W_{\\mathrm{F1}} = (1 - 0.06)(1 - 0.1) = 0.94 \\times 0.9 = 0.846$$\n\nNext, we derive the expected mean fitness of the F2 generation, $\\mathbb{E}[W_{\\mathrm{F2}}](r)$. The F2 generation is formed by random mating among the F1 individuals. The F1 individuals are of genotype $AaBb$, formed from a cross between source populations fixed for $AAbb$ and $aaBB$. This implies the F1 individuals are double heterozygotes in repulsion (or trans) phase, with genotype configuration $\\frac{Ab}{aB}$.\n\nDuring meiosis in these F1 individuals, gametes are produced with frequencies dependent on the recombination fraction $r$.\n- The parental (non-recombinant) gametes are $Ab$ and $aB$. They are produced with a total frequency of $1-r$. Each has a frequency of $\\frac{1-r}{2}$.\n- The recombinant gametes are $AB$ and $ab$. They are produced with a total frequency of $r$. Each has a frequency of $\\frac{r}{2}$.\n\nThe F2 genotypes are formed by the random union of these four gamete types. The mean fitness is the average of the fitness of all possible F2 genotypes, weighted by their frequencies. A direct summation over the nine genotypes is laborious. A more structured approach consists of classifying the F2 zygotes based on the gametes from which they are formed.\n1.  **Parental $\\times$ Parental (PP):** A zygote formed by the union of two parental gametes ($Ab$ or $aB$). The total frequency of this event is $(1-r)^2$.\n2.  **Recombinant $\\times$ Recombinant (RR):** A zygote formed by the union of two recombinant gametes ($AB$ or $ab$). The total frequency of this event is $r^2$.\n3.  **Parental $\\times$ Recombinant (PR):** A zygote formed by the union of one parental and one recombinant gamete. The total frequency of this event is $2r(1-r)$.\n\nThe mean fitness can be expressed as:\n$$\\mathbb{E}[W_{\\mathrm{F2}}](r) = (1-r)^2 \\bar{W}_{\\mathrm{PP}} + r^2 \\bar{W}_{\\mathrm{RR}} + 2r(1-r) \\bar{W}_{\\mathrm{PR}}$$\nwhere $\\bar{W}_{\\mathrm{PP}}$, $\\bar{W}_{\\mathrm{RR}}$, and $\\bar{W}_{\\mathrm{PR}}$ are the constant mean fitnesses within each class of zygotes.\n\nFirst, we must calculate the fitness values for all nine possible genotypes using the provided parameters: $s_A = 0.6, h_A=0.1, s_B=0.5, h_B=0.2, e=0.4$.\n- Per-locus fitness components:\n$w_{AA} = 1$, $w_{Aa} = 1 - 0.06 = 0.94$, $w_{aa} = 1 - 0.6 = 0.4$.\n$w_{BB} = 1$, $w_{Bb} = 1 - 0.1 = 0.9$, $w_{bb} = 1 - 0.5 = 0.5$.\n- Two-locus fitness values ($W$):\n$W_{AABB} = 1 \\times 1 = 1$.\n$W_{AABb} = 1 \\times 0.9 = 0.9$.\n$W_{AAbb} = 1 \\times 0.5 = 0.5$.\n$W_{AaBB} = 0.94 \\times 1 = 0.94$.\n$W_{AaBb} = 0.94 \\times 0.9 = 0.846$.\n$W_{Aabb} = 0.94 \\times 0.5 = 0.47$.\n$W_{aaBB} = 0.4 \\times 1 = 0.4$.\n$W_{aaBb} = 0.4 \\times 0.9 = 0.36$.\n$W_{aabb} = (0.4 \\times 0.5) \\times (1 - 0.4) = 0.2 \\times 0.6 = 0.12$.\n\nNow we calculate the mean fitness for each zygote class:\n- $\\bar{W}_{\\mathrm{PP}}$: Zygotes from parental gametes ($Ab, aB$) are $AAbb$ (from $Ab \\times Ab$), $aaBB$ (from $aB \\times aB$), and $AaBb$ (from $Ab \\times aB$ and $aB \\times Ab$). The relative frequencies within this class are $\\frac{1}{4}$, $\\frac{1}{4}$, and $\\frac{1}{2}$, respectively.\n$$\\bar{W}_{\\mathrm{PP}} = \\frac{1}{4}W_{AAbb} + \\frac{1}{4}W_{aaBB} + \\frac{1}{2}W_{AaBb} = \\frac{1}{4}(0.5) + \\frac{1}{4}(0.4) + \\frac{1}{2}(0.846) = 0.125 + 0.1 + 0.423 = 0.648$$\n\n- $\\bar{W}_{\\mathrm{RR}}$: Zygotes from recombinant gametes ($AB, ab$) are $AABB$ (from $AB \\times AB$), $aabb$ (from $ab \\times ab$), and $AaBb$ (from $AB \\times ab$ and $ab \\times AB$). The relative frequencies are $\\frac{1}{4}$, $\\frac{1}{4}$, and $\\frac{1}{2}$.\n$$\\bar{W}_{\\mathrm{RR}} = \\frac{1}{4}W_{AABB} + \\frac{1}{4}W_{aabb} + \\frac{1}{2}W_{AaBb} = \\frac{1}{4}(1) + \\frac{1}{4}(0.12) + \\frac{1}{2}(0.846) = 0.25 + 0.03 + 0.423 = 0.703$$\n\n- $\\bar{W}_{\\mathrm{PR}}$: Zygotes from one parental and one recombinant gamete are $AABb$, $Aabb$, $AaBB$, and $aaBb$, each with a relative frequency of $\\frac{1}{4}$ within this class.\n$$\\bar{W}_{\\mathrm{PR}} = \\frac{1}{4}(W_{AABb} + W_{Aabb} + W_{AaBB} + W_{aaBb}) = \\frac{1}{4}(0.9 + 0.47 + 0.94 + 0.36) = \\frac{1}{4}(2.67) = 0.6675$$\n\nNow, substitute these constants back into the polynomial for $\\mathbb{E}[W_{\\mathrm{F2}}](r)$:\n$$\\mathbb{E}[W_{\\mathrm{F2}}](r) = (1 - 2r + r^2)\\bar{W}_{\\mathrm{PP}} + r^2\\bar{W}_{\\mathrm{RR}} + (2r - 2r^2)\\bar{W}_{\\mathrm{PR}}$$\nCollect terms by powers of $r$:\n$$\\mathbb{E}[W_{\\mathrm{F2}}](r) = (\\bar{W}_{\\mathrm{PP}} + \\bar{W}_{\\mathrm{RR}} - 2\\bar{W}_{\\mathrm{PR}}) r^2 + (-2\\bar{W}_{\\mathrm{PP}} + 2\\bar{W}_{\\mathrm{PR}}) r + \\bar{W}_{\\mathrm{PP}}$$\nSubstitute the numerical values of the constants:\nCoefficient of $r^2$: $0.648 + 0.703 - 2(0.6675) = 1.351 - 1.335 = 0.016$.\nCoefficient of $r$: $-2(0.648) + 2(0.6675) = 2(0.6675 - 0.648) = 2(0.0195) = 0.039$.\nConstant term: $0.648$.\n\nSo, the mean fitness in F2 is:\n$$\\mathbb{E}[W_{\\mathrm{F2}}](r) = 0.016 r^2 + 0.039 r + 0.648$$\n\nFinally, we compute the fitness change $\\Delta(r)$:\n$$\\Delta(r) = \\mathbb{E}[W_{\\mathrm{F2}}](r) - W_{\\mathrm{F1}} = (0.016 r^2 + 0.039 r + 0.648) - 0.846$$\n$$\\Delta(r) = 0.016 r^2 + 0.039 r - 0.198$$\nThis expression is the required closed-form polynomial in $r$, representing the change in mean fitness due to recombination and segregation in the F2 generation.", "answer": "$$\n\\boxed{0.016 r^{2} + 0.039 r - 0.198}\n$$", "id": "2698689"}, {"introduction": "Ultimately, the success of any conservation action must be demonstrated with empirical data, which requires careful experimental design and statistical analysis. Power analysis is an essential tool that allows conservation scientists to determine the likelihood of detecting a true effect, such as an increase in survival, given specific sample sizes and expected effect magnitudes. This hands-on coding exercise guides you through building a power analysis framework from fundamental statistical principles, equipping you with the practical skills to design robust monitoring programs and rigorously evaluate the outcomes of genetic rescue efforts. [@problem_id:2698729]", "problem": "A conservation program attempts a genetic rescue by introducing migrants into a small, isolated population. Let survival be modeled at the individual level as independent Bernoulli trials with survival probability $p$. You will design a power analysis framework to detect a multiplicative increase in survival following rescue. Assume pre-rescue survival probability $p_0$ and a post-rescue target of a $10$ percent relative increase so that the alternative survival probability is $p_1 = p_0(1 + 0.10)$. All probabilities must be expressed as decimals in $[0,1]$, not as percentages. Assume $p_0(1+0.10)  1$ for all test cases in this problem.\n\nYour framework must start from the following fundamental base:\n- Bernoulli sampling and the Binomial distribution: if $\\hat{p}$ is the sample proportion from $n$ independent Bernoulli trials with success probability $p$, then $\\mathrm{Var}(\\hat{p}) = \\frac{p(1-p)}{n}$.\n- The Central Limit Theorem (CLT): for sufficiently large $n$, $\\hat{p}$ is approximately Normal with mean $p$ and variance $\\frac{p(1-p)}{n}$.\n- Overdispersion typical of small populations can be approximated by a Beta-Binomial model or an intra-class correlation structure. Capture this via a variance inflation factor $1 + (n-1)\\rho$, where $\\rho \\in [0,\\infty)$ is an intra-class correlation parameter. Thus, use the inflated variance $\\frac{p(1-p)}{n} [1 + (n-1)\\rho]$ for the sampling distribution of $\\hat{p}$.\n\nUsing only these bases, derive from first principles a one-sided hypothesis test designed to detect an increase in survival after rescue at significance level $\\alpha$:\n- Null hypothesis $H_0$: $p_1 = p_0$.\n- Alternative hypothesis $H_1$: $p_1 = p_0(1+0.10) > p_0$.\n\nLet $n_0$ denote the pre-rescue sample size and $n_1$ the post-rescue sample size. Let $\\hat{p}_0$ and $\\hat{p}_1$ be the corresponding sample survival proportions. Construct a test statistic based on the difference $\\hat{p}_1 - \\hat{p}_0$. Using the above bases, derive the approximate sampling distribution of this difference under $H_0$ and under $H_1$ when including the variance inflation factor $1 + (n-1)\\rho$ separately for each group. Use a one-sided upper-tail rejection rule calibrated by the Type I error $\\alpha$ under $H_0$, and then derive a closed-form expression for the statistical power under $H_1$ as a function of $n_0$, $n_1$, $p_0$, $\\rho$, and $\\alpha$.\n\nImplement a program that, for a fixed $10$ percent relative increase and the inputs $(n_0, n_1, p_0, \\rho, \\alpha)$, computes the power as a real number in $[0,1]$. Use the Normal cumulative distribution function to evaluate tail probabilities. Round each reported power to exactly $6$ decimal places.\n\nTest suite to evaluate your implementation. For each of the following parameter sets $(n_0, n_1, p_0, \\rho, \\alpha)$, compute the power of the one-sided test for detecting the $10$ percent relative increase described above:\n- Case A: $(25, 25, 0.50, 0.02, 0.05)$.\n- Case B: $(10, 10, 0.60, 0.05, 0.05)$.\n- Case C: $(50, 50, 0.50, 0.00, 0.05)$.\n- Case D: $(40, 20, 0.70, 0.03, 0.05)$.\n- Case E: $(30, 30, 0.85, 0.01, 0.05)$.\n- Case F: $(100, 100, 0.40, 0.00, 0.01)$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above. For example, the output must look like\n\"[x_A,x_B,x_C,x_D,x_E,x_F]\"\nwhere $x_A$ through $x_F$ are the $6$-decimal rounded power values for Cases A through F, respectively.", "solution": "The supplied problem will first be subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n\n-   **Model**: Individual survival is a Bernoulli trial with probability $p$.\n-   **Parameter of Interest**: Survival probability $p$.\n-   **Pre-rescue survival probability**: $p_0$.\n-   **Post-rescue survival probability increase**: $10$ percent relative increase.\n-   **Alternative survival probability**: $p_1 = p_0(1 + 0.10)$.\n-   **Constraint**: $p_0(1+0.10)  1$.\n-   **Sampling Distribution of Sample Proportion $\\hat{p}$**: For a sample of size $n$, $\\hat{p}$ is approximately Normal with mean $p$ and variance $\\mathrm{Var}(\\hat{p}) = p(1-p)/n$. This is based on the Central Limit Theorem.\n-   **Variance Inflation**: A variance inflation factor of $1 + (n-1)\\rho$ is introduced to account for overdispersion, where $\\rho$ is the intra-class correlation.\n-   **Inflated Variance**: $\\mathrm{Var}(\\hat{p}) = \\frac{p(1-p)}{n} [1 + (n-1)\\rho]$.\n-   **Hypothesis Test**: One-sided test for an increase in survival.\n    -   Null Hypothesis $H_0$: $p_1 = p_0$.\n    -   Alternative Hypothesis $H_1$: $p_1 = p_0(1 + 0.10)  p_0$.\n-   **Significance Level**: $\\alpha$.\n-   **Sample Sizes**: Pre-rescue $n_0$, post-rescue $n_1$.\n-   **Sample Proportions**: Pre-rescue $\\hat{p}_0$, post-rescue $\\hat{p}_1$.\n-   **Test Statistic**: The difference in sample proportions, $D = \\hat{p}_1 - \\hat{p}_0$.\n-   **Objective**: Derive a closed-form expression for statistical power as a function of $n_0, n_1, p_0, \\rho, \\alpha$ and implement it.\n-   **Inputs for Implementation**: $(n_0, n_1, p_0, \\rho, \\alpha)$.\n-   **Test Suite**:\n    -   Case A: $(25, 25, 0.50, 0.02, 0.05)$\n    -   Case B: $(10, 10, 0.60, 0.05, 0.05)$\n    -   Case C: $(50, 50, 0.50, 0.00, 0.05)$\n    -   Case D: $(40, 20, 0.70, 0.03, 0.05)$\n    -   Case E: $(30, 30, 0.85, 0.01, 0.05)$\n    -   Case F: $(100, 100, 0.40, 0.00, 0.01)$\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is assessed for validity.\n1.  **Scientific Grounding**: The problem is constructed upon standard, fundamental principles of statistical inference: Bernoulli trials, the Central Limit Theorem, hypothesis testing, and power analysis. The inclusion of a variance inflation factor based on an intra-class correlation coefficient $\\rho$ is a standard and scientifically valid method to model overdispersion in clustered or correlated data, which is a realistic concern in population studies. The context of genetic rescue is a legitimate field within evolutionary biology. The problem is scientifically sound.\n2.  **Well-Posedness**: The problem is well-posed. It clearly defines the hypotheses, the test statistic, the underlying statistical model (including the specific form of variance), and all necessary parameters ($n_0, n_1, p_0, \\rho, \\alpha$). The goal is to derive and compute a specific quantity (statistical power), for which a unique solution exists under the given assumptions.\n3.  **Objectivity**: The language is precise, quantitative, and devoid of any subjective or speculative content.\n4.  **Completeness and Consistency**: The problem is self-contained. All variables and constants required for the derivation are provided. The condition $p_0(1+0.10)  1$ ensures that $p_1$ is a valid probability, preventing internal contradiction.\n5.  **Realism**: The parameters and the scenario are plausible within the context of a conservation biology study. The sample sizes and effect size are realistic.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. It is a formal, solvable problem in biostatistics.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be derived and implemented.\n\n**Derivation of Statistical Power**\n\nThe objective is to derive an expression for the power of a one-sided test to detect an increase in a proportion.\n\n1.  **Test Statistic and Its Distribution**\n    The test statistic is the difference between the post-rescue and pre-rescue sample survival proportions:\n    $$D = \\hat{p}_1 - \\hat{p}_0$$\n    The pre-rescue sample $(\\text{group } 0)$ and post-rescue sample $(\\text{group } 1)$ are independent. Based on the Central Limit Theorem and the provided variance structure, the sample proportions $\\hat{p}_0$ and $\\hat{p}_1$ are approximately normally distributed:\n    $$\\hat{p}_i \\sim \\mathcal{N}\\left(p_i, \\frac{p_i(1-p_i)}{n_i}[1 + (n_i-1)\\rho]\\right) \\quad \\text{for } i \\in \\{0, 1\\}$$\n    As a linear combination of independent normal random variables, their difference $D$ is also normally distributed.\n\n2.  **Distribution under the Null Hypothesis ($H_0$)**\n    Under $H_0: p_1 = p_0$, the true probabilities for both groups are equal to $p_0$.\n    The expected value of the difference is:\n    $$E[D | H_0] = E[\\hat{p}_1] - E[\\hat{p}_0] = p_0 - p_0 = 0$$\n    The variance of the difference is the sum of the variances:\n    $$\\mathrm{Var}(D | H_0) = \\mathrm{Var}(\\hat{p}_1) + \\mathrm{Var}(\\hat{p}_0)$$\n    Substituting $p_0$ for the probability in both variance terms:\n    $$\\sigma_0^2 \\equiv \\mathrm{Var}(D | H_0) = \\frac{p_0(1-p_0)}{n_1}[1 + (n_1-1)\\rho] + \\frac{p_0(1-p_0)}{n_0}[1 + (n_0-1)\\rho]$$\n    This can be factored:\n    $$\\sigma_0^2 = p_0(1-p_0) \\left( \\frac{1 + (n_1-1)\\rho}{n_1} + \\frac{1 + (n_0-1)\\rho}{n_0} \\right)$$\n    Thus, under $H_0$, the test statistic $D$ follows the distribution $D | H_0 \\sim \\mathcal{N}(0, \\sigma_0^2)$.\n\n3.  **Rejection Rule**\n    We conduct a one-sided, upper-tail test at a significance level of $\\alpha$. We reject $H_0$ if the observed difference is greater than a critical value, $d_{crit}$. This critical value is defined by the Type I error rate:\n    $$P(D  d_{crit} | H_0) = \\alpha$$\n    To find $d_{crit}$, we standardize the test statistic under $H_0$:\n    $$P\\left(\\frac{D - 0}{\\sigma_0}  \\frac{d_{crit}}{\\sigma_0} \\right) = \\alpha$$\n    Let $Z$ be a standard normal random variable, $Z \\sim \\mathcal{N}(0, 1)$. Let $z_\\alpha$ be the upper $\\alpha$-quantile of the standard normal distribution, where $P(Z  z_\\alpha) = \\alpha$.\n    Therefore, $\\frac{d_{crit}}{\\sigma_0} = z_\\alpha$, which gives the critical value:\n    $$d_{crit} = z_\\alpha \\sigma_0$$\n\n4.  **Distribution under the Alternative Hypothesis ($H_1$)**\n    Under $H_1$, the true probabilities are $p_0$ for the pre-rescue group and $p_1 = p_0(1 + 0.10) = 1.1 p_0$ for the post-rescue group.\n    The expected value of the difference is:\n    $$\\mu_1 \\equiv E[D | H_1] = E[\\hat{p}_1] - E[\\hat{p}_0] = p_1 - p_0 = 1.1 p_0 - p_0 = 0.1 p_0$$\n    The variance of the difference under $H_1$ uses the respective true probabilities for each group:\n    $$\\sigma_1^2 \\equiv \\mathrm{Var}(D | H_1) = \\mathrm{Var}(\\hat{p}_1) + \\mathrm{Var}(\\hat{p}_0) = \\frac{p_1(1-p_1)}{n_1}[1 + (n_1-1)\\rho] + \\frac{p_0(1-p_0)}{n_0}[1 + (n_0-1)\\rho]$$\n    Thus, under $H_1$, the test statistic $D$ follows the distribution $D | H_1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$.\n\n5.  **Power Calculation**\n    Statistical power is the probability of correctly rejecting $H_0$ when $H_1$ is true. This is the probability that the observed difference $D$ exceeds the critical value $d_{crit}$, calculated under the distribution of $H_1$.\n    $$\\text{Power} = P(D  d_{crit} | H_1)$$\n    Substituting $d_{crit} = z_\\alpha \\sigma_0$:\n    $$\\text{Power} = P(D  z_\\alpha \\sigma_0 | H_1)$$\n    To evaluate this probability, we standardize $D$ using its distribution under $H_1$:\n    $$\\text{Power} = P\\left(\\frac{D - \\mu_1}{\\sigma_1}  \\frac{z_\\alpha \\sigma_0 - \\mu_1}{\\sigma_1} \\right)$$\n    The term on the left is a standard normal variable $Z$. Let $\\Phi(\\cdot)$ denote the cumulative distribution function (CDF) of the standard normal distribution.\n    $$\\text{Power} = P\\left(Z  \\frac{z_\\alpha \\sigma_0 - \\mu_1}{\\sigma_1} \\right) = 1 - \\Phi\\left(\\frac{z_\\alpha \\sigma_0 - \\mu_1}{\\sigma_1}\\right)$$\n    Using the symmetry of the normal distribution, $\\Phi(-x) = 1 - \\Phi(x)$, this expression is equivalent to:\n    $$\\text{Power} = \\Phi\\left(-\\frac{z_\\alpha \\sigma_0 - \\mu_1}{\\sigma_1}\\right) = \\Phi\\left(\\frac{\\mu_1 - z_\\alpha \\sigma_0}{\\sigma_1}\\right)$$\n    This is the final closed-form expression for statistical power. The value $z_\\alpha$ is computed as $\\Phi^{-1}(1-\\alpha)$.\n\nThis concludes the derivation from first principles. The implementation will now follow.", "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the statistical power for detecting a 10% relative increase\n    in survival probability for a series of test cases.\n    \"\"\"\n    \n    # Test suite as defined in the problem statement.\n    # Each case is a tuple: (n0, n1, p0, rho, alpha)\n    test_cases = [\n        (25, 25, 0.50, 0.02, 0.05),  # Case A\n        (10, 10, 0.60, 0.05, 0.05),  # Case B\n        (50, 50, 0.50, 0.00, 0.05),  # Case C\n        (40, 20, 0.70, 0.03, 0.05),  # Case D\n        (30, 30, 0.85, 0.01, 0.05),  # Case E\n        (100, 100, 0.40, 0.00, 0.01), # Case F\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        n0, n1, p0, rho, alpha = case\n        \n        # Define probabilities under H0 and H1\n        p1 = p0 * (1.0 + 0.10)\n        \n        # Mean of the difference under H1\n        mu_1 = 0.1 * p0\n        \n        # Variance of the difference under H0\n        # sigma_0^2 = Var(D | H0)\n        var_p0_at_n0 = (p0 * (1 - p0) / n0) * (1 + (n0 - 1) * rho)\n        var_p0_at_n1 = (p0 * (1 - p0) / n1) * (1 + (n1 - 1) * rho)\n        sigma_0_squared = var_p0_at_n0 + var_p0_at_n1\n        sigma_0 = np.sqrt(sigma_0_squared)\n\n        # Variance of the difference under H1\n        # sigma_1^2 = Var(D | H1)\n        var_p1_at_n1 = (p1 * (1 - p1) / n1) * (1 + (n1 - 1) * rho)\n        sigma_1_squared = var_p0_at_n0 + var_p1_at_n1\n        sigma_1 = np.sqrt(sigma_1_squared)\n        \n        # Critical z-value for one-sided test\n        z_alpha = norm.ppf(1 - alpha)\n        \n        # Argument for the standard normal CDF\n        argument = (mu_1 - z_alpha * sigma_0) / sigma_1\n        \n        # Calculate Power = Phi(argument)\n        power = norm.cdf(argument)\n        \n        # Round to 6 decimal places and store\n        results.append(round(power, 6))\n\n    # Format the output as specified in the problem statement\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2698729"}]}