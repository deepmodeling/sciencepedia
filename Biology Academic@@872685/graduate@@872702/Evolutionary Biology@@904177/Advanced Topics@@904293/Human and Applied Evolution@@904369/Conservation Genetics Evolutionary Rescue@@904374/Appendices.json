{"hands_on_practices": [{"introduction": "Evolutionary rescue is fundamentally a stochastic process, representing a race between the deterministic decline of a population and the timely arrival and establishment of a successful adaptive lineage. This exercise guides you through building a rescue model from first principles, integrating continuous-time population dynamics with the probabilities of key evolutionary events. By modeling a scenario where rescue requires two mutational steps [@problem_id:2698500], you will learn to calculate the total expected number of successful lineages by accounting for mutational pathways, the fitness of intermediate genotypes, and the probability of establishment.", "problem": "A clonal microbial population experiences an abrupt environmental deterioration at time $t=0$ that renders the ancestral genotype (denoted $A_{0}$) maladapted. Assume continuous-time birth–death dynamics with per-capita birth rate fixed at $b=1$ for all genotypes, and genotype-specific Malthusian parameters $r_{i}=b-d_{i}$ determined by death rates $d_{i}$. The ancestral genotype has $r_{0}0$, so that in the absence of rescue the population declines deterministically as $N(t)=N_{0}\\exp(r_{0} t)$, and ultimately goes extinct. Mutations occur at division events.\n\nRescue requires two mutations and exhibits epistasis and path-dependence through two alternative mutational routes that produce distinct rescue genotypes with different growth rates:\n\n- Path $B$: $A_{0} \\xrightarrow{u_{b}} B \\xrightarrow{v_{b}} R^{(b)}$, where the intermediate $B$ has $r_{B}0$ and the final rescue genotype $R^{(b)}$ has $r_{R}^{(b)}0$.\n- Path $C$: $A_{0} \\xrightarrow{u_{c}} C \\xrightarrow{v_{c}} R^{(c)}$, where the intermediate $C$ has $r_{C}0$ and the final rescue genotype $R^{(c)}$ has $r_{R}^{(c)}0$.\n\nAssume the following standard and well-tested approximations: (i) rare-mutation, independent-event (Poisson) approximation for the arrival of new mutants; (ii) a single rare supercritical lineage with $r0$ in a linear birth–death process with $b=1$ has an exact establishment probability $p_{\\mathrm{est}}=r$; (iii) a single rare subcritical lineage with $r0$ and $b=1$ produces an expected total number of births over its entire lineage lifetime equal to $E[X]=\\frac{1}{-r}$.\n\nThe parameter values are:\n- Initial population size $N_{0}=1.2\\times 10^{11}$.\n- Ancestral Malthusian parameter $r_{0}=-0.1$.\n- First-step mutation rates $u_{b}=2.0\\times 10^{-7}$ and $u_{c}=5.0\\times 10^{-8}$ per birth.\n- Intermediate growth parameters $r_{B}=-0.02$ and $r_{C}=-0.05$.\n- Second-step mutation rates $v_{b}=1.0\\times 10^{-6}$ and $v_{c}=1.5\\times 10^{-6}$ per birth.\n- Rescue growth parameters $r_{R}^{(b)}=0.04$ and $r_{R}^{(c)}=0.02$.\n\nUsing only the foundational principles stated above and ignoring density dependence and clonal interference among successful rescue lineages, derive from first principles a closed-form expression for the total probability of evolutionary rescue, $P_{\\mathrm{rescue}}$, that accounts for the two-step, epistatic, and path-dependent structure described. Then evaluate $P_{\\mathrm{rescue}}$ for the parameter values given. Report your final numerical answer as a decimal rounded to four significant figures. Do not use a percent sign.", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and objective. It provides a self-contained and consistent set of definitions, parameters, and established approximations from evolutionary theory to permit a rigorous, unique solution. I will proceed with the derivation.\n\nThe total probability of evolutionary rescue, $P_{\\mathrm{rescue}}$, is the probability that at least one successful rescue lineage emerges and establishes. Based on the provided approximation of rare, independent events, the total number of successful rescue lineages follows a Poisson distribution. The probability of rescue is therefore $P_{\\mathrm{rescue}} = 1 - P(\\text{no rescue})$. If $\\Lambda_{\\mathrm{rescue}}$ is the expected total number of successful rescue lineages, then the probability of no rescue is $\\exp(-\\Lambda_{\\mathrm{rescue}})$. Thus, the problem reduces to calculating $\\Lambda_{\\mathrm{rescue}}$.\n\n$$P_{\\mathrm{rescue}} = 1 - \\exp(-\\Lambda_{\\mathrm{rescue}})$$\n\nThe problem specifies two independent mutational paths, B and C, and explicitly states to ignore clonal interference. Therefore, the total expected number of successful rescue lineages is the sum of the expectations from each path:\n\n$$\\Lambda_{\\mathrm{rescue}} = \\Lambda_{b} + \\Lambda_{c}$$\n\nHere, $\\Lambda_{b}$ and $\\Lambda_{c}$ are the expected numbers of successful rescue lineages arising from paths B and C, respectively. We must derive an expression for each.\n\nConsider path B: $A_{0} \\xrightarrow{u_{b}} B \\xrightarrow{v_{b}} R^{(b)}$.\nThe rate of production of intermediate mutants of type $B$ at time $t$ is given by the product of the ancestral population size $N(t)$, the per-capita birth rate $b=1$, and the mutation rate $u_{b}$. The ancestral population declines deterministically as $N(t) = N_{0}\\exp(r_{0} t)$.\nThe rate of appearance of new $B$ mutants is:\n$$ \\text{Rate}_{A_{0}\\to B}(t) = N(t) \\cdot b \\cdot u_{b} = N_{0}u_{b}\\exp(r_{0}t) $$\nEach newly formed $B$ mutant founds a lineage. This lineage is subcritical, with a Malthusian parameter $r_{B}  0$. According to the provided approximation (iii), the expected total number of births produced over the entire lifetime of a single such subcritical lineage is $E[X_{B}] = \\frac{1}{-r_{B}}$.\n\nEach birth within a $B$ lineage is an opportunity for a second mutation to the rescue genotype $R^{(b)}$, which occurs with rate $v_{b}$ per birth. Therefore, the expected number of $R^{(b)}$ mutants produced by a single $B$ lineage is:\n$$ E[N_{R^{(b)}} | \\text{1 B-lineage}] = v_{b} \\cdot E[X_{B}] = \\frac{v_{b}}{-r_{B}} $$\nThe rescue genotype $R^{(b)}$ is supercritical, with a Malthusian parameter $r_{R}^{(b)}  0$. According to approximation (ii), the probability that a single $R^{(b)}$ mutant establishes a successful, growing lineage is $p_{\\mathrm{est}}^{(b)} = r_{R}^{(b)}$.\n\nCombining these results, the probability that a single new $B$ mutant gives rise to a successful rescue lineage is the expected number of $R^{(b)}$ mutants it produces multiplied by their establishment probability:\n$$ P(\\text{rescue} | \\text{1 B-mutant}) = E[N_{R^{(b)}} | \\text{1 B-lineage}] \\cdot p_{\\mathrm{est}}^{(b)} = \\frac{v_{b}}{-r_{B}} \\cdot r_{R}^{(b)} $$\nThe rate at which successful rescue lineages arise via path B at time $t$, denoted $\\lambda_{b}(t)$, is the rate of $B$ mutant production multiplied by the probability that each leads to rescue:\n$$ \\lambda_{b}(t) = \\text{Rate}_{A_{0}\\to B}(t) \\cdot P(\\text{rescue} | \\text{1 B-mutant}) = N_{0}u_{b}\\exp(r_{0}t) \\frac{v_{b}r_{R}^{(b)}}{-r_{B}} $$\nThe total expected number of successful rescue lineages from path B, $\\Lambda_{b}$, is the integral of this rate over all time, from $t=0$ to $\\infty$:\n$$ \\Lambda_{b} = \\int_{0}^{\\infty} \\lambda_{b}(t) \\,dt = \\int_{0}^{\\infty} N_{0}u_{b} \\frac{v_{b}r_{R}^{(b)}}{-r_{B}} \\exp(r_{0}t) \\,dt $$\nSince the term $N_{0}u_{b}\\frac{v_{b}r_{R}^{(b)}}{-r_{B}}$ is constant, we can take it out of the integral:\n$$ \\Lambda_{b} = N_{0}u_{b} \\frac{v_{b}r_{R}^{(b)}}{-r_{B}} \\int_{0}^{\\infty} \\exp(r_{0}t) \\,dt $$\nThe integral evaluates to:\n$$ \\int_{0}^{\\infty} \\exp(r_{0}t) \\,dt = \\left[ \\frac{1}{r_{0}}\\exp(r_{0}t) \\right]_{0}^{\\infty} = 0 - \\frac{1}{r_{0}} = \\frac{-1}{r_{0}} \\quad (\\text{since } r_{0}  0) $$\nSubstituting this result back gives the expression for $\\Lambda_{b}$:\n$$ \\Lambda_{b} = N_{0}u_{b} \\frac{v_{b}r_{R}^{(b)}}{-r_{B}} \\left( \\frac{-1}{r_{0}} \\right) = \\frac{N_{0}u_{b}v_{b}r_{R}^{(b)}}{r_{0}r_{B}} $$\nBy identical logic, the expression for the expected number of successful rescue lineages from path C is:\n$$ \\Lambda_{c} = \\frac{N_{0}u_{c}v_{c}r_{R}^{(c)}}{r_{0}r_{C}} $$\nThe total expected number of rescue lineages is the sum of these two terms. The closed-form expression for the total probability of rescue is therefore:\n$$ P_{\\mathrm{rescue}} = 1 - \\exp\\left( -\\left( \\frac{N_{0}u_{b}v_{b}r_{R}^{(b)}}{r_{0}r_{B}} + \\frac{N_{0}u_{c}v_{c}r_{R}^{(c)}}{r_{0}r_{C}} \\right) \\right) = 1 - \\exp\\left( -\\frac{N_{0}}{r_{0}}\\left( \\frac{u_{b}v_{b}r_{R}^{(b)}}{r_{B}} + \\frac{u_{c}v_{c}r_{R}^{(c)}}{r_{C}} \\right) \\right) $$\nNow, we substitute the provided parameter values to obtain a numerical result.\nThe parameters are:\n$N_{0}=1.2\\times 10^{11}$, $r_{0}=-0.1$.\nFor path B: $u_{b}=2.0\\times 10^{-7}$, $r_{B}=-0.02$, $v_{b}=1.0\\times 10^{-6}$, $r_{R}^{(b)}=0.04$.\nFor path C: $u_{c}=5.0\\times 10^{-8}$, $r_{C}=-0.05$, $v_{c}=1.5\\times 10^{-6}$, $r_{R}^{(c)}=0.02$.\n\nFirst, calculate $\\Lambda_{b}$:\n$$ \\Lambda_{b} = \\frac{(1.2\\times 10^{11})(2.0\\times 10^{-7})(1.0\\times 10^{-6})(0.04)}{(-0.1)(-0.02)} = \\frac{9.6 \\times 10^{-4}}{0.002} = 0.48 $$\nNext, calculate $\\Lambda_{c}$:\n$$ \\Lambda_{c} = \\frac{(1.2\\times 10^{11})(5.0\\times 10^{-8})(1.5\\times 10^{-6})(0.02)}{(-0.1)(-0.05)} = \\frac{1.8 \\times 10^{-4}}{0.005} = 0.036 $$\nThe total expected number of successful rescue lineages is:\n$$ \\Lambda_{\\mathrm{rescue}} = \\Lambda_{b} + \\Lambda_{c} = 0.48 + 0.036 = 0.516 $$\nFinally, the total probability of rescue is:\n$$ P_{\\mathrm{rescue}} = 1 - \\exp(-\\Lambda_{\\mathrm{rescue}}) = 1 - \\exp(-0.516) \\approx 1 - 0.596899... \\approx 0.403100... $$\nRounding to four significant figures, the final result is $0.4031$.", "answer": "$$\\boxed{0.4031}$$", "id": "2698500"}, {"introduction": "While single-gene models are insightful, many traits relevant to conservation, such as thermal tolerance, are quantitative and influenced by many genes. This problem shifts our focus to adaptation via quantitative trait evolution and phenotypic plasticity, modeled through a reaction norm. You will apply the multivariate breeder's equation to determine the minimum amount of additive genetic variance in plasticity, $G_{bb}$, required for a population to avoid extinction after an abrupt environmental shift [@problem_id:2698506]. This practice provides critical insight into how the genetic architecture of a trait, including gene-by-environment interactions, dictates its potential for evolutionary rescue.", "problem": "A threatened population experiences an abrupt environmental shift from baseline environment $E_{0}=0$ to a new constant environment $E_{1}\\neq 0$ at generation $t=0$. A single quantitative phenotype $z$ determines absolute fitness via Gaussian stabilizing selection toward the environment-dependent optimum $z^{\\ast}(E)=\\kappa E$, so that individual absolute fitness is\n$$\nW(z,E) \\;=\\; \\exp\\!\\left(-\\frac{(z - z^{\\ast}(E))^{2}}{2\\,\\Omega^{2}}\\right).\n$$\nIn addition to selection, the population experiences density-independent demographic multiplication $R1$ per generation, so that the per-generation population multiplier at mean phenotype is $\\lambda \\,=\\, R\\,\\bar W$, where $\\bar W$ is mean absolute fitness.\n\nThe reaction norm for the phenotype is linear, $z(E) \\,=\\, a + b\\,E$, where $a$ is the intercept and $b$ is the plasticity slope. The additive genetic (co)variances of $(a,b)$ define the genetic variance-covariance matrix\n$$\n\\mathbf{G} \\;=\\; \\begin{pmatrix}\nG_{aa}  G_{ab} \\\\\nG_{ab}  G_{bb}\n\\end{pmatrix},\n$$\nwith $G_{aa}0$, $G_{ab}$ given constants, and $G_{bb}\\ge 0$ to be determined. At $t=0$, the mean reaction norm parameters are $(\\bar a_{0},\\bar b_{0})=(a_{0},b_{0})$, which are constants. Assume the Lande equation (multivariate breeder’s equation) holds for one generation in the new environment: $\\Delta \\boldsymbol{\\mu} \\,=\\, \\mathbf{G}\\,\\boldsymbol{\\beta}$, where $\\boldsymbol{\\mu}=(a,b)^{\\top}$ and $\\boldsymbol{\\beta}$ is the selection gradient on $(a,b)$ computed from $\\ln W$ at $E=E_{1}$. Assume phenotypic variance is sufficiently small that mean dynamics under selection are accurately captured by the selection gradient on $\\ln W$ evaluated at the mean phenotype.\n\nDefine the initial mismatch under the new environment as $\\delta \\,=\\, a_{0} + b_{0}E_{1} - \\kappa E_{1}$. After one generation of selection and genetic response, the new mean mismatch is $\\delta'$, and the new per-generation multiplier is $\\lambda_{1} = R\\,\\exp\\!\\left(-\\delta'^{2}/(2\\,\\Omega^{2})\\right)$. Define evolutionary rescue (at this one-generation horizon) as $\\lambda_{1}\\ge 1$.\n\nAssume that the parameters satisfy $0 \\le \\sqrt{2\\ln R}\\,\\Omega/|\\delta| \\le 1$ and that $\\mathbf{G}$ can be chosen such that its implied additive genetic variance for the expressed phenotype in environment $E_{1}$ is nonnegative. Under these assumptions, derive a closed-form analytic expression for the minimal additive genetic variance in the plasticity slope, $G_{bb}^{\\mathrm{crit}}$, that guarantees $\\lambda_{1}=1$ after one generation (the threshold for evolutionary rescue), in terms of $a_{0}$, $b_{0}$, $\\kappa$, $E_{1}$, $\\Omega^{2}$, $R$, $G_{aa}$, and $G_{ab}$.\n\nYour final answer must be a single closed-form expression. Do not include units in your final answer. If multiple algebraic branches exist, select the branch that yields the minimal $G_{bb}$ consistent with the stated assumption $0 \\le \\sqrt{2\\ln R}\\,\\Omega/|\\delta| \\le 1$.", "solution": "The problem asks for the minimal additive genetic variance in the plasticity slope, denoted $G_{bb}^{\\mathrm{crit}}$, that allows a population to achieve evolutionary rescue after one generation in a new environment. Evolutionary rescue is defined by the population's per-generation multiplier being at least one, i.e., $\\lambda_{1} \\ge 1$. We are asked to find the value of $G_{bb}$ for which $\\lambda_1=1$.\n\nFirst, we establish the condition for the rescue threshold, $\\lambda_{1}=1$. The per-generation multiplier is given by $\\lambda_{1} = R\\,\\exp\\left(-\\frac{\\delta'^{2}}{2\\,\\Omega^{2}}\\right)$, where $\\delta'$ is the mismatch between the mean phenotype and the optimum after one generation of selection. Setting $\\lambda_1=1$:\n$$\nR\\,\\exp\\left(-\\frac{\\delta'^{2}}{2\\,\\Omega^{2}}\\right) = 1\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln(R) - \\frac{\\delta'^{2}}{2\\,\\Omega^{2}} = 0\n$$\n$$\n\\delta'^{2} = 2\\,\\Omega^{2}\\ln(R)\n$$\nThis implies that the magnitude of the mismatch after one generation must be:\n$$\n|\\delta'| = \\Omega\\sqrt{2\\ln R}\n$$\nNext, we must relate the new mismatch $\\delta'$ to the initial state of the population. The new mismatch is $\\delta' = \\bar{z}_{1} - z^{\\ast}(E_{1})$, where $\\bar{z}_{1}$ is the mean phenotype in environment $E_1$ after selection and $z^{\\ast}(E_{1}) = \\kappa E_1$ is the optimal phenotype. The mean phenotype evolves according to the multivariate breeder's equation (Lande equation), $\\Delta \\boldsymbol{\\mu} = \\mathbf{G}\\,\\boldsymbol{\\beta}$, where $\\boldsymbol{\\mu} = (a, b)^{\\top}$ represents the mean reaction norm parameters. The new mean trait vector is $\\boldsymbol{\\mu}_1 = \\boldsymbol{\\mu}_0 + \\Delta\\boldsymbol{\\mu}$, with $\\boldsymbol{\\mu}_0 = (a_0, b_0)^{\\top}$.\n\nThe selection gradient $\\boldsymbol{\\beta}$ is the vector of partial derivatives of the logarithm of individual fitness, $\\ln W$, with respect to the traits $(a, b)$, evaluated at the mean trait values $(a_0, b_0)$ in the new environment $E_{1}$. The log-fitness function is:\n$$\n\\ln W(a,b,E_{1}) = -\\frac{(z(E_1) - z^{\\ast}(E_1))^{2}}{2\\,\\Omega^{2}} = -\\frac{(a + bE_{1} - \\kappa E_{1})^{2}}{2\\,\\Omega^{2}}\n$$\nThe components of the selection gradient are:\n$$\n\\beta_{a} = \\left.\\frac{\\partial \\ln W}{\\partial a}\\right|_{(a_0,b_0)} = -\\frac{a_{0} + b_{0}E_{1} - \\kappa E_{1}}{\\Omega^{2}} = -\\frac{\\delta}{\\Omega^{2}}\n$$\n$$\n\\beta_{b} = \\left.\\frac{\\partial \\ln W}{\\partial b}\\right|_{(a_0,b_0)} = -\\frac{(a_{0} + b_{0}E_{1} - \\kappa E_{1})E_{1}}{\\Omega^{2}} = -\\frac{\\delta E_{1}}{\\Omega^{2}}\n$$\nHere, $\\delta = a_{0} + b_{0}E_{1} - \\kappa E_{1}$ is the initial mismatch. The selection gradient vector is $\\boldsymbol{\\beta} = -\\frac{\\delta}{\\Omega^{2}}\\begin{pmatrix} 1 \\\\ E_{1} \\end{pmatrix}$.\n\nThe change in the mean reaction norm parameters is:\n$$\n\\Delta \\boldsymbol{\\mu} = \\begin{pmatrix} \\Delta \\bar{a} \\\\ \\Delta \\bar{b} \\end{pmatrix} = \\mathbf{G}\\boldsymbol{\\beta} = \\begin{pmatrix} G_{aa}  G_{ab} \\\\ G_{ab}  G_{bb} \\end{pmatrix} \\left(-\\frac{\\delta}{\\Omega^{2}} \\begin{pmatrix} 1 \\\\ E_{1} \\end{pmatrix}\\right) = -\\frac{\\delta}{\\Omega^{2}} \\begin{pmatrix} G_{aa} + G_{ab}E_{1} \\\\ G_{ab} + G_{bb}E_{1} \\end{pmatrix}\n$$\nThe new mean phenotype in environment $E_{1}$ is $\\bar{z}_{1} = \\bar{a}_{1} + \\bar{b}_{1}E_{1} = (a_0 + \\Delta \\bar{a}) + (b_0 + \\Delta \\bar{b})E_1$.\nThe new mismatch is $\\delta' = \\bar{z}_{1} - z^{\\ast}(E_{1}) = (a_{0} + b_{0}E_{1} - \\kappa E_{1}) + (\\Delta \\bar{a} + E_{1}\\Delta \\bar{b})$. This is $\\delta' = \\delta + \\Delta \\bar{z}$, where $\\Delta \\bar{z}$ is the change in the mean phenotype.\n$$\n\\Delta \\bar{z} = \\Delta \\bar{a} + E_{1}\\Delta \\bar{b} = -\\frac{\\delta}{\\Omega^{2}}(G_{aa} + G_{ab}E_{1}) - \\frac{\\delta}{\\Omega^{2}}(G_{ab} + G_{bb}E_{1})E_{1}\n$$\n$$\n\\Delta \\bar{z} = -\\frac{\\delta}{\\Omega^{2}} (G_{aa} + 2G_{ab}E_{1} + G_{bb}E_{1}^{2})\n$$\nThe term $V_{A,z}(E_1) = G_{aa} + 2G_{ab}E_{1} + G_{bb}E_{1}^{2}$ is the total additive genetic variance of the phenotype $z$ in environment $E_1$. Thus, $\\Delta \\bar{z} = -\\frac{\\delta}{\\Omega^2}V_{A,z}(E_1)$.\nThe new mismatch is:\n$$\n\\delta' = \\delta + \\Delta \\bar{z} = \\delta - \\frac{\\delta}{\\Omega^2}V_{A,z}(E_1) = \\delta\\left(1 - \\frac{V_{A,z}(E_1)}{\\Omega^2}\\right)\n$$\nNow we use the rescue condition $|\\delta'| = \\Omega\\sqrt{2\\ln R}$:\n$$\n|\\delta| \\left|1 - \\frac{V_{A,z}(E_1)}{\\Omega^2}\\right| = \\Omega\\sqrt{2\\ln R}\n$$\nRearranging gives:\n$$\n\\left|1 - \\frac{V_{A,z}(E_1)}{\\Omega^2}\\right| = \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\n$$\nThis equation has two possible solutions for the term inside the absolute value, corresponding to two algebraic branches:\n$$\n1 - \\frac{V_{A,z}(E_1)}{\\Omega^2} = \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|} \\quad \\text{or} \\quad 1 - \\frac{V_{A,z}(E_1)}{\\Omega^2} = -\\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\n$$\nSolving for $V_{A,z}(E_1)$ in each case:\n$$\nV_{A,z}(E_1) = \\Omega^2 \\left(1 - \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\\right) \\quad \\text{or} \\quad V_{A,z}(E_1) = \\Omega^2 \\left(1 + \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\\right)\n$$\nThe problem asks for the minimal $G_{bb}$ that guarantees rescue. Since $V_{A,z}(E_1) = G_{aa} + 2G_{ab}E_{1} + G_{bb}E_{1}^{2}$ and $E_1^2  0$, minimizing $G_{bb}$ is equivalent to minimizing $V_{A,z}(E_1)$. Given the assumption $0 \\le \\sqrt{2\\ln R}\\,\\Omega/|\\delta| \\le 1$, both potential values for $V_{A,z}(E_1)$ are non-negative. To find the minimal $G_{bb}$, we must choose the smaller value for $V_{A,z}(E_1)$, which corresponds to the first branch:\n$$\nV_{A,z}(E_1) = \\Omega^2 \\left(1 - \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\\right)\n$$\nSubstituting the expression for $V_{A,z}(E_1)$:\n$$\nG_{aa} + 2G_{ab}E_{1} + G_{bb}E_{1}^{2} = \\Omega^2 \\left(1 - \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\\right)\n$$\nWe can now solve for $G_{bb}^{\\mathrm{crit}}$:\n$$\nG_{bb}^{\\mathrm{crit}} E_{1}^{2} = \\Omega^2 \\left(1 - \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\\right) - G_{aa} - 2G_{ab}E_{1}\n$$\nSince $E_1 \\neq 0$, we can divide by $E_1^2$:\n$$\nG_{bb}^{\\mathrm{crit}} = \\frac{1}{E_{1}^{2}} \\left[ \\Omega^2 \\left(1 - \\frac{\\Omega\\sqrt{2\\ln R}}{|\\delta|}\\right) - G_{aa} - 2G_{ab}E_{1} \\right]\n$$\nFinally, substituting the definition $|\\delta| = |a_{0} + b_{0}E_{1} - \\kappa E_{1}|$:\n$$\nG_{bb}^{\\mathrm{crit}} = \\frac{1}{E_{1}^{2}} \\left[ \\Omega^2 - \\frac{\\Omega^3\\sqrt{2\\ln R}}{|a_{0} + b_{0}E_{1} - \\kappa E_{1}|} - G_{aa} - 2G_{ab}E_{1} \\right]\n$$\nThis expression represents the minimal additive genetic variance in the plasticity slope required to meet the threshold for evolutionary rescue after one generation, consistent with all problem assumptions.", "answer": "$$\n\\boxed{\\frac{1}{E_{1}^{2}} \\left[ \\Omega^{2} \\left(1 - \\frac{\\Omega\\sqrt{2\\ln R}}{|a_{0} + b_{0}E_{1} - \\kappa E_{1}|}\\right) - G_{aa} - 2G_{ab}E_{1} \\right]}\n$$", "id": "2698506"}, {"introduction": "Real populations are rarely isolated, and gene flow from other populations can be a powerful evolutionary force. This exercise explores the complexities of \"genetic rescue\" in a metapopulation context, where migration is a double-edged sword: it can introduce adaptive alleles but also cause \"migration load\" by bringing in genotypes maladapted to local conditions. In this hands-on coding problem [@problem_id:2698494], you will model this crucial trade-off by linking migration-selection dynamics for allele frequency to the overall demographic fate of a sink population, allowing you to determine whether gene flow ultimately leads to rescue or hastens extinction.", "problem": "Consider a two-deme metapopulation with a deteriorated focal population (the sink) and a non-deteriorated source. The focal population experiences environmental deterioration such that the wild-type genotype has a negative Malthusian growth rate $r_0 lt; 0$ at low density. A single biallelic locus affects adaptation in the deteriorated environment: allele $A$ increases the Malthusian growth rate additively by $s$ relative to the wild-type allele $a$. Gene flow from the source occurs at rate $m$ per generation and has two simultaneous genetic effects on the focal population: (i) it changes the frequency of allele $A$ via immigration from the source, which has allele $A$ frequency $p_S \\in [0,1]$, and (ii) it imposes migration load at many other loci due to maladaptation of immigrants, captured as a linear reduction $c\\,m$ in the focal population’s mean Malthusian growth rate, where $c \\ge 0$ is a constant summarizing genome-wide load per unit migration. Assume the focal population is sufficiently small that density dependence is negligible for the establishment phase, and that the only genetic processes at the focal locus are selection and migration (no mutation and no genetic drift in the allele frequency dynamics).\n\nUse the following foundational modeling ingredients, which are standard in population genetics and population dynamics:\n- The weak-selection, continuous-time migration–selection model for the allele frequency $p(t)$ of allele $A$ in the focal population:\n$$\n\\frac{dp}{dt} \\;=\\; m\\,(p_S - p) \\;+\\; s\\,p\\,(1-p),\n$$\nwhere $m \\ge 0$, $s$ can be positive, zero, or negative, and $p_S \\in [0,1]$ is constant.\n- The low-density demographic dynamics of the focal population are governed by a Malthusian growth rate given by the genetic average\n$$\n\\bar{r}(p) \\;=\\; r_0 \\;-\\; c\\,m \\;+\\; s\\,p,\n$$\nwhich adds the contribution $s\\,p$ from the focal locus and subtracts the migration load $c\\,m$.\n\nDefine “evolutionary rescue” here as the condition that, after the allele frequency relaxes to its migration–selection equilibrium $p^\\star \\in [0,1]$, the focal population’s mean low-density growth rate is strictly positive, i.e., $\\bar{r}(p^\\star)  0$. The equilibrium $p^\\star$ is defined by the condition $dp/dt = 0$ under the above migration–selection dynamics, together with the following biologically grounded boundary condition arising from the absence of mutation: if $m = 0$ or $p_S = 0$ and the focal population initially lacks allele $A$, then $p^\\star = 0$.\n\nTask: For each parameter set in the test suite below, compute whether evolutionary rescue occurs, defined as a Boolean value that is true if and only if $\\bar{r}(p^\\star)  0$. Your program must:\n- Determine $p^\\star$ by solving for the biologically valid equilibrium of the stated migration–selection dynamics on $[0,1]$ (do not assume a priori which equilibrium is stable), respecting the boundary condition that $p^\\star = 0$ when $m = 0$ or $p_S = 0$ in the absence of mutation.\n- Evaluate $\\bar{r}(p^\\star)$ and return true if and only if it is strictly positive, otherwise false.\n- Produce a single-line output containing a comma-separated list of the Boolean results for all test cases, enclosed in square brackets.\n\nTest suite (each case is an ordered tuple $(r_0, s, m, c, p_S)$):\n- Case $1$: $( -0.05,\\; 0.20,\\; 0.10,\\; 0.10,\\; 0.80 )$\n- Case $2$: $( -0.05,\\; 0.20,\\; 0.40,\\; 0.60,\\; 1.00 )$\n- Case $3$: $( -0.01,\\; 0.30,\\; 0.00,\\; 0.50,\\; 1.00 )$\n- Case $4$: $( -0.02,\\; 0.40,\\; 0.20,\\; 0.05,\\; 0.00 )$\n- Case $5$: $( -0.03,\\; 0.15,\\; 0.05,\\; 0.05,\\; 0.70 )$\n- Case $6$: $( -0.01,\\; 0.00,\\; 0.30,\\; 0.10,\\; 0.90 )$\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\texttt{[True,False,True]}$), in the exact order of the test suite.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It constitutes a well-posed problem within the established framework of theoretical population genetics, is scientifically grounded, and is free from ambiguity or logical contradiction. We proceed with the derivation of the solution.\n\nThe problem requires a determination of whether evolutionary rescue occurs for a given set of parameters $(r_0, s, m, c, p_S)$. By definition, this is true if and only if the mean Malthusian growth rate of the focal population, evaluated at the stable migration-selection equilibrium allele frequency $p^\\star$, is strictly positive. That is, $\\bar{r}(p^\\star)  0$.\n\nThe solution, therefore, is a two-step procedure: first, we must determine the equilibrium allele frequency $p^\\star \\in [0,1]$; second, we must evaluate the sign of the function $\\bar{r}(p^\\star)$.\n\n**Step 1: Determination of the Equilibrium Allele Frequency $p^\\star$**\n\nThe dynamics of the allele frequency $p(t)$ are given by the differential equation:\n$$\n\\frac{dp}{dt} \\;=\\; m\\,(p_S - p) \\;+\\; s\\,p\\,(1-p)\n$$\nThe equilibria of the system are the values of $p$ for which $dp/dt = 0$. Setting the right-hand side to $0$ and rearranging terms yields a quadratic equation for the equilibrium frequency $p$:\n$$\nm p_S - m p + s p - s p^2 = 0\n$$\n$$\ns p^2 + (m-s) p - m p_S = 0\n$$\nThis is a quadratic equation of the form $Ap^2 + Bp + C = 0$, where $A=s$, $B=m-s$, and $C=-m p_S$. The system will relax to a *stable* equilibrium $p^\\star$ within the biologically meaningful interval $[0,1]$. We analyze the solutions under different conditions for the parameters.\n\n**Boundary and Special Cases:**\n\nThe problem specifies a crucial boundary condition: if migration cannot introduce the allele $A$ (i.e., if $m=0$ or $p_S=0$), and the allele is initially absent, it cannot appear, as mutation is excluded. Thus, if the population starts at $p(0)=0$, it remains at $p=0$. This dictates the equilibrium for these cases.\n1.  **Case $m=0$:** The equation becomes $s p (1-p) = 0$. The equilibria are $p=0$ and $p=1$. Due to the absence of a source for allele $A$, we must select the equilibrium consistent with an initial state of $p(0)=0$. Therefore, $p^\\star = 0$.\n2.  **Case $p_S=0$:** Migration only introduces the wild-type allele $a$. As with the case of $m=0$, if allele $A$ is not initially present, it will never be introduced. The dynamics are $dp/dt = p(-m + s(1-p))$. $p=0$ is an equilibrium. Following the problem's condition, we set $p^\\star = 0$.\n3.  **Case $s=0$ (No Selection):** The equation simplifies to $m(p_S - p) = 0$.\n    -   If $m  0$, the unique equilibrium is $p^\\star = p_S$. Migration homogenizes the allele frequency to that of the source.\n    -   If $m = 0$, this falls under Case 1, and $p^\\star = 0$.\n\n**General Case ($s  0, m  0, p_S  0$):**\nFor this case, which applies to all test scenarios not covered by the special conditions above (the provided test cases only include $s \\ge 0$), we solve the quadratic equation $s p^2 + (m-s) p - m p_S = 0$. The solutions are given by the quadratic formula:\n$$\np = \\frac{-(m-s) \\pm \\sqrt{(m-s)^2 - 4(s)(-m p_S)}}{2s} = \\frac{s-m \\pm \\sqrt{(s-m)^2 + 4sm p_S}}{2s}\n$$\nThe product of the roots is $C/A = (-m p_S)/s$, which is negative since $s0, m0, p_S0$. This implies one root is positive and one is negative. The negative root is biologically meaningless. The stable, valid equilibrium $p^\\star$ must be the positive root:\n$$\np^\\star = \\frac{s-m + \\sqrt{(s-m)^2 + 4sm p_S}}{2s}\n$$\nIt can be shown that this root is always in the interval $(0, 1]$ for $p_S \\in (0,1]$ and $s,m0$. This single valid root is the one to which the allele frequency will relax.\n\n**Step 2: The Evolutionary Rescue Condition**\n\nWith the equilibrium frequency $p^\\star$ determined, we evaluate the focal population's mean low-density growth rate, given by:\n$$\n\\bar{r}(p) = r_0 - c m + s p\n$$\nEvolutionary rescue occurs if the population can establish and grow, which requires a strictly positive growth rate at this equilibrium:\n$$\n\\bar{r}(p^\\star) = r_0 - c m + s p^\\star  0\n$$\nThis inequality is evaluated for each parameter set in the test suite to yield a Boolean result. The computational procedure outlined above is applied to each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the evolutionary rescue problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite: each case is an ordered tuple (r_0, s, m, c, p_S)\n    test_cases = [\n        # Case 1\n        (-0.05, 0.20, 0.10, 0.10, 0.80),\n        # Case 2\n        (-0.05, 0.20, 0.40, 0.60, 1.00),\n        # Case 3\n        (-0.01, 0.30, 0.00, 0.50, 1.00),\n        # Case 4\n        (-0.02, 0.40, 0.20, 0.05, 0.00),\n        # Case 5\n        (-0.03, 0.15, 0.05, 0.05, 0.70),\n        # Case 6\n        (-0.01, 0.00, 0.30, 0.10, 0.90),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = check_evolutionary_rescue(*params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Note: str(True) -> \"True\", str(False) -> \"False\"\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef check_evolutionary_rescue(r0, s, m, c, pS):\n    \"\"\"\n    Determines if evolutionary rescue occurs for a given parameter set.\n\n    Rescue is defined as the condition where the mean Malthusian growth rate\n    at the stable migration-selection equilibrium (p_star) is strictly positive.\n\n    Args:\n        r0 (float): Wild-type Malthusian growth rate at low density.\n        s (float): Additive effect of allele A on the growth rate.\n        m (float): Migration rate from the source.\n        c (float): Constant for migration load per unit migration.\n        pS (float): Frequency of allele A in the source population.\n\n    Returns:\n        bool: True if rescue occurs, False otherwise.\n    \"\"\"\n    p_star = 0.0\n\n    # Determine the equilibrium allele frequency p_star based on the model and\n    # the specified boundary conditions.\n    # The boundary condition states p_star = 0 if m=0 or pS=0, as there is\n    # no source of the beneficial allele A (mutation is absent).\n    if m == 0.0 or pS == 0.0:\n        p_star = 0.0\n    # If there is no selection, allele frequency equilibrates to the source frequency.\n    elif s == 0.0:\n        p_star = pS\n    # General case: s > 0, m > 0, pS > 0.\n    # The equilibrium is the single biologically relevant (positive) root\n    # of the quadratic equation: s*p^2 + (m-s)*p - m*pS = 0.\n    else:\n        # We solve for p using the quadratic formula: p = (-b +/- sqrt(b^2 - 4ac)) / 2a\n        # where a=s, b=m-s, c=-m*pS.\n        # The stable equilibrium corresponds to the '+' solution.\n        discriminant = (s - m)**2 + 4 * s * m * pS\n        p_star = (s - m + np.sqrt(discriminant)) / (2 * s)\n\n    # Calculate the mean Malthusian growth rate at equilibrium.\n    r_bar_at_equilibrium = r0 - c * m + s * p_star\n\n    # Evolutionary rescue occurs if the growth rate is strictly positive.\n    return r_bar_at_equilibrium > 0\n\nsolve()\n```", "id": "2698494"}]}