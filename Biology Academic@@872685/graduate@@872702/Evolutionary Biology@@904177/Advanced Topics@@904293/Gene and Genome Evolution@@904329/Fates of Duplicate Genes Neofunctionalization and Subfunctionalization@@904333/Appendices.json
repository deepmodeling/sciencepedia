{"hands_on_practices": [{"introduction": "The most common fate for a newly duplicated gene, if it is truly redundant, is to decay into a nonfunctional pseudogene. Without selective pressure to preserve both copies, one is free to accumulate disabling mutations, a process governed by mutation and random genetic drift. This foundational exercise [@problem_id:2712752] challenges you to derive the expected survival time of a redundant duplicate from first principles of population genetics, providing a quantitative baseline against which all other, more creative, evolutionary fates must compete.", "problem": "Consider a newly arisen gene duplication that is fixed in a diploid population described by a Wright–Fisher model with constant effective population size $N_{e}$. Immediately after duplication, both paralogs are functionally redundant and under no positive or negative selection for redundancy: losing function at one copy has no fitness effect as long as the other copy remains functional. Let the per-generation, per-haploid, per-locus rate at which a mutation completely disables a copy (loss-of-function, LoF) be $\\mu_{L}$, and assume no back mutation or reactivation, no gene conversion, and independence of the two loci. Define “pseudogenization of the duplicate pair” as the time at which a LoF allele at either paralog fixes in the population, so that one copy is lost functionally across all individuals, leaving a single functional copy.\n\nStarting only from the following foundational facts:\n- In a Wright–Fisher population, a newly arisen neutral allele at initial frequency $p$ has fixation probability $p$.\n- In a population of effective size $N_{e}$, the number of new neutral mutations per generation at a locus is $2N_{e}\\mu$ (diploid), where $\\mu$ is the per-generation, per-haploid, per-locus mutation rate.\n- When fixations are rare and independent, neutral fixations over time can be modeled as a Poisson process with rate equal to the product of the rate of origin of new neutral alleles and their fixation probability.\n\nDerive:\n1) The survival function $S(T)$, the probability that the duplicate pair still retains two functional copies (i.e., has not pseudogenized) after $T$ generations as a function of $T$ and $\\mu_{L}$, explicitly accounting for genetic drift through $N_{e}$.\n2) The expected time until pseudogenization, $\\mathbb{E}[T_{\\text{pseudo}}]$, expressed in generations.\n\nProvide your final answer as a single closed-form analytic expression containing both results in a single row matrix $\\bigl(S(T), \\mathbb{E}[T_{\\text{pseudo}}]\\bigr)$, simplified in terms of $\\mu_{L}$ and $T$ only. No numerical approximation is required. Express the expected time in generations. Do not include any units in your boxed final answer.", "solution": "The problem statement will first be subjected to a rigorous validation procedure.\n\n**Step 1: Extraction of Givens**\n- **Model:** Diploid Wright–Fisher model.\n- **Population Size:** Constant effective population size $N_{e}$.\n- **Initial State:** A newly arisen gene duplication is fixed in the population. Both paralogs are functionally redundant.\n- **Selection Condition:** Loss of function (LoF) at one copy is neutral as long as the other copy is functional.\n- **Mutation Rate:** The per-generation, per-haploid, per-locus rate of a complete LoF mutation is $\\mu_{L}$.\n- **Assumptions:** No back mutation or reactivation; no gene conversion; independence of the two loci.\n- **Definition:** \"Pseudogenization of the duplicate pair\" is the event where a LoF allele at either paralog fixes in the population. The time of this event is $T_{\\text{pseudo}}$.\n- **Foundational Facts:**\n    1. A new neutral allele at initial frequency $p$ has a fixation probability of $p$.\n    2. The number of new neutral mutations per generation at a locus in a diploid population is $2N_{e}\\mu$.\n    3. The process of neutral fixations over time can be modeled as a Poisson process with a rate equal to the product of the rate of origin of new neutral alleles and their fixation probability.\n- **Required Derivations:**\n    1. The survival function $S(T)$, the probability that both copies remain functional after $T$ generations.\n    2. The expected time until pseudogenization, $\\mathbb{E}[T_{\\text{pseudo}}]$.\n- **Final Answer Constraint:** The final answer must be a single row matrix containing both results, simplified in terms of $\\mu_{L}$ and $T$ only.\n\n**Step 2: Validation of the Problem**\nThe problem is scientifically grounded, drawing upon foundational principles of population genetics, specifically the neutral theory of molecular evolution as applied to the fate of duplicate genes. This is a classic and well-established problem structure, often associated with the models proposed by Lynch and Conery. The problem is well-posed, with all necessary parameters ($\\mu_{L}$, $N_{e}$) and assumptions (diploid Wright-Fisher model, neutrality, no back mutation) clearly stated. The language is precise and objective. The provided \"foundational facts\" are cornerstones of population genetics theory and guide the derivation in a logically consistent manner. The setup is not contradictory; the final requirement to express the answer without $N_{e}$ is a direct consequence of the neutral substitution rate calculation, which the problem guides the solver to perform. The problem is not trivial, as it requires the correct synthesis of multiple concepts: mutation, genetic drift, fixation probability, and Poisson processes. Therefore, the problem is deemed valid.\n\n**Step 3: Solution Derivation**\nThe task is to determine the survival function and expected lifetime of a redundant gene pair before one of the copies is lost to pseudogenization via the fixation of a loss-of-function (LoF) allele. The process of fixation is driven by genetic drift.\n\nFirst, we must determine the rate at which pseudogenization occurs at a single locus. According to the problem statement, a LoF mutation is neutral. We are given the necessary principles to calculate the rate of substitution for such neutral alleles.\n\nLet us consider one of the two paralogous loci.\n1.  The rate of origin of new LoF mutations at this locus per generation is given as the product of the number of gene copies in the population ($2N_{e}$ for a diploid population of size $N_{e}$) and the per-copy mutation rate ($\\mu_{L}$).\n    Rate of new LoF mutations per locus per generation = $2N_{e}\\mu_{L}$.\n\n2.  A new mutation arises in a single chromosome. In a diploid population of size $N_{e}$, there are $2N_{e}$ total gene copies at that locus. Thus, the initial frequency $p$ of a newly arisen mutant allele is:\n    $$p = \\frac{1}{2N_{e}}$$\n\n3.  According to the foundational facts, the fixation probability for a neutral allele is equal to its initial frequency.\n    $$P_{\\text{fix}} = p = \\frac{1}{2N_{e}}$$\n\n4.  The rate of fixation of neutral alleles, which we can call the rate of substitution, is the product of the rate at which new mutations arise and their probability of fixation. Let us denote this rate for a single locus as $\\lambda_{1}$.\n    $$\\lambda_{1} = (\\text{Rate of new mutations}) \\times (P_{\\text{fix}})$$\n    $$\\lambda_{1} = (2N_{e}\\mu_{L}) \\times \\left(\\frac{1}{2N_{e}}\\right) = \\mu_{L}$$\nThis is a classical result from neutral theory: the rate of neutral substitution is equal to the neutral mutation rate per gamete per generation. Notice that the effective population size $N_{e}$ has cancelled out, which is consistent with the instruction for the final answer. The rate of pseudogenization for a single gene copy is therefore $\\mu_{L}$.\n\nNext, we consider the duplicate pair. Pseudogenization of the pair is defined as the fixation of a LoF allele at *either* of the two paralogs. The problem states that the two loci are independent. The process of fixation at each locus is a Poisson process with rate $\\lambda_{1} = \\mu_{L}$.\n\nThe event of interest is the first occurrence of fixation at either Locus 1 or Locus 2. For two independent Poisson processes with rates $\\lambda_{A}$ and $\\lambda_{B}$, the time until the first event in *either* process is exponentially distributed with a rate $\\Lambda = \\lambda_{A} + \\lambda_{B}$.\n\nIn our case, the rates for both loci are identical: $\\lambda_{1} = \\lambda_{2} = \\mu_{L}$.\nThe total rate of pseudogenization for the pair, $\\Lambda$, is therefore:\n$$\\Lambda = \\mu_{L} + \\mu_{L} = 2\\mu_{L}$$\n\nNow we can derive the two required quantities.\n\n**1) The Survival Function $S(T)$**\nThe survival function $S(T)$ is the probability that no pseudogenization event has occurred by generation $T$. For a Poisson process with rate $\\Lambda$, the probability of observing zero events in an interval of length $T$ is given by the Poisson distribution formula for $k=0$ events:\n$$P(k=0; \\Lambda T) = \\frac{(\\Lambda T)^{0} \\exp(-\\Lambda T)}{0!} = \\exp(-\\Lambda T)$$\nThus, the survival function is:\n$$S(T) = \\exp(-\\Lambda T)$$\nSubstituting $\\Lambda = 2\\mu_{L}$:\n$$S(T) = \\exp(-2\\mu_{L}T)$$\n\n**2) The Expected Time to Pseudogenization $\\mathbb{E}[T_{\\text{pseudo}}]$**\nThe time to the first event in a Poisson process with rate $\\Lambda$ follows an exponential distribution. The probability density function of this waiting time $t$ is $f(t) = \\Lambda \\exp(-\\Lambda t)$. The expected value, or mean, of an exponential distribution with rate parameter $\\Lambda$ is $\\frac{1}{\\Lambda}$.\nTherefore, the expected time until pseudogenization of the gene pair is:\n$$\\mathbb{E}[T_{\\text{pseudo}}] = \\frac{1}{\\Lambda}$$\nSubstituting $\\Lambda = 2\\mu_{L}$:\n$$\\mathbb{E}[T_{\\text{pseudo}}] = \\frac{1}{2\\mu_{L}}$$\n\nThe two results, $S(T)$ and $\\mathbb{E}[T_{\\text{pseudo}}]$, are expressed only in terms of $\\mu_{L}$ and $T$, as required.", "answer": "$$\\boxed{\\begin{pmatrix} \\exp(-2\\mu_{L}T)  \\frac{1}{2\\mu_{L}} \\end{pmatrix}}$$", "id": "2712752"}, {"introduction": "While many duplicates are lost to decay, some are preserved by acquiring novel, beneficial functions—a process known as neofunctionalization. This represents an escape from the relentless pressure of pseudogenization, driven by positive selection. This practice [@problem_id:2712805] shifts our focus from neutral decay to adaptation, asking you to calculate the expected waiting time for a neofunctionalizing mutation to arise and ultimately fix in a population, highlighting the crucial race between constructive evolution and neutral degradation.", "problem": "A newly duplicated gene pair segregates in a panmictic diploid population evolving according to the Wright–Fisher model with constant effective population size $N$ and non-overlapping generations. Consider neofunctionalization by a single beneficial mutation that confers a genic, semi-dominant selective advantage quantified by selection coefficient $s$ upon carriers of the mutation at either member of the duplicate pair. Assume that at each generation and for each haploid genome, the per-generation rate at which such neofunctionalizing beneficial mutations arise anywhere within the duplicate pair is $\\mu_{b}$, with $\\mu_{b} \\ll 1$ and $s \\ll 1$. You may use the widely accepted approximation for the fixation probability of a newly arisen semi-dominant beneficial mutation under genic selection in a large diploid Wright–Fisher population, $P_{\\text{fix}}(s) \\approx 2s$, provided its domain of validity is respected.\n\nStarting from the definitions of the Wright–Fisher process, the independence of rare mutational events, and the relationship between mutation supply and fixation into a population, derive the expected waiting time (in generations) to the first successful neofunctionalization event (defined as the first neofunctionalizing mutation that ultimately fixes). Express your final answer as a closed-form analytical expression in terms of $N$, $\\mu_{b}$, and $s$.\n\nFinally, briefly delineate the parameter regime and model assumptions under which your expression is expected to be accurate, highlighting any key limitations relative to realistic duplicate-gene evolution where subfunctionalization may also occur. Your final numerical expression should not include any units; the time unit is generations.", "solution": "The problem statement is subjected to validation.\n\nGivens extracted verbatim from the statement:\n1.  **Population and Model**: A panmictic diploid population, evolving according to the Wright–Fisher model.\n2.  **Population Size**: Constant effective population size $N$.\n3.  **Generations**: Non-overlapping.\n4.  **Evolutionary Process**: Neofunctionalization by a single beneficial mutation.\n5.  **Selection**: Genic, semi-dominant selective advantage quantified by selection coefficient $s$.\n6.  **Mutation Target**: Either member of the duplicate pair.\n7.  **Mutation Rate**: Per-generation rate at which neofunctionalizing beneficial mutations arise anywhere within the duplicate pair is $\\mu_{b}$ for each haploid genome.\n8.  **Parameter Constraints**: $\\mu_{b} \\ll 1$ and $s \\ll 1$.\n9.  **Provided Approximation**: The fixation probability of a newly arisen semi-dominant beneficial mutation is $P_{\\text{fix}}(s) \\approx 2s$, valid for a large diploid Wright–Fisher population.\n10. **Objective**: Derive the expected waiting time (in generations) to the first successful neofunctionalization event, defined as the first neofunctionalizing mutation that ultimately fixes.\n11. **Additional Task**: Delineate the parameter regime and model assumptions for which the derived expression is accurate and highlight limitations.\n\nValidation Verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of population genetics, namely the Wright–Fisher model, mutation, selection, and genetic drift. The concepts of neofunctionalization, selection coefficient, and fixation probability are standard in evolutionary biology. The problem provides all necessary parameters ($N$, $\\mu_{b}$, $s$) and a well-known approximation for the fixation probability, rendering it self-contained and solvable. There are no scientific or factual unsoundness, no contradictions, and no ambiguities in its formulation. The problem is a standard theoretical exercise in evolutionary dynamics. Therefore, the problem is deemed **valid**.\n\nThe solution proceeds as follows.\nThe goal is to determine the expected waiting time, in generations, until the first neofunctionalizing mutation arises and proceeds to fixation. This process can be modeled as a sequence of independent Bernoulli trials, where each generation is a trial. A \"success\" in a given generation is the event that a new neofunctionalizing mutation arises and is destined for fixation. The waiting time for the first success in such a sequence follows a geometric distribution. If $p$ is the probability of success in any single generation, the expected waiting time $E[T]$ is given by $E[T] = \\frac{1}{p}$.\n\nOur first task is to calculate this probability, $p$. This probability is the product of two quantities:\n1.  The rate at which new neofunctionalizing mutations enter the population per generation.\n2.  The probability that any such single new mutation will eventually fix in the population.\n\nLet us calculate the first quantity. The population is diploid with an effective size of $N$. This means there are $2N$ haploid genomes in the population. The per-generation rate of neofunctionalizing mutations per haploid genome is given as $\\mu_{b}$. Assuming mutational events are independent and rare ($\\mu_b \\ll 1$), the expected number of new neofunctionalizing mutations arising in the entire population in one generation is the product of the number of gene copies and the mutation rate per copy.\nLet $\\Lambda_{\\text{mut}}$ be the rate of mutational supply.\n$$\n\\Lambda_{\\text{mut}} = (2N) \\times \\mu_{b} = 2N\\mu_{b}\n$$\nThis quantity represents the average number of new beneficial mutations entering the population per generation.\n\nNext, we consider the second quantity: the probability of fixation. The problem provides the approximation for the fixation probability of a newly arisen semi-dominant beneficial mutation with selection coefficient $s$:\n$$\nP_{\\text{fix}}(s) \\approx 2s\n$$\nThis is a classic result from Kimura's diffusion theory, applicable when selection is weak ($s \\ll 1$) but strong enough to overcome random genetic drift (specifically, $2Ns \\gg 1$).\n\nThe probability of a successful event in a single generation, $p$, is the rate at which mutations that are destined for fixation arise. This is the product of the mutation supply rate and the fixation probability per mutation.\n$$\np = \\Lambda_{\\text{mut}} \\times P_{\\text{fix}}(s)\n$$\nSubstituting the expressions for each term:\n$$\np \\approx (2N\\mu_{b}) \\times (2s) = 4N\\mu_{b}s\n$$\nThis is the probability of a successful neofunctionalization initiating in any given generation.\n\nFinally, the expected waiting time, $E[T]$, for the first such event is the reciprocal of this probability, according to the properties of the geometric distribution.\n$$\nE[T] = \\frac{1}{p} = \\frac{1}{4N\\mu_{b}s}\n$$\nThis expression gives the expected number of generations until a neofunctionalizing mutation arises and fixes.\n\nNow, we must delineate the parameter regime and limitations of this result.\nThe validity of this expression rests on several key assumptions:\n1.  **Wright–Fisher Model**: The population evolves according to the Wright–Fisher model, which assumes a constant effective size $N$, non-overlapping generations, and random mating (panmixia).\n2.  **Parameter Regime for Fixation**: The approximation $P_{\\text{fix}}(s) \\approx 2s$ is valid for weak selection ($s \\ll 1$) in a large population where selection is nevertheless effective against drift. The formal condition is $2Ns \\gg 1$. If selection is too weak ($2Ns \\le 1$), drift dominates and the fixation probability is much lower, approaching the neutral value of $\\frac{1}{2N}$.\n3.  **Successive Sweeps Regime**: The derivation implicitly assumes that beneficial mutations arise sufficiently rarely that they do not compete with one another. This is the \"successive sweeps\" regime, where one beneficial mutation fixes before the next one arises. This requires that the rate of successful mutational input must be much less than $1$, i.e., $p = 4N\\mu_{b}s \\ll 1$. A more stringent condition is that the waiting time for a new successful mutation ($E[T]$) is much longer than the time it takes for a such a mutation to fix ($T_{\\text{fix}} \\approx \\frac{2}{s}\\ln(2N)$). This condition, $E[T] \\gg T_{\\text{fix}}$, ensures that the population is effectively monomorphic for the wild-type allele when the next successful mutation appears. If $4N\\mu_b s$ is not small, multiple beneficial mutations may segregate simultaneously, leading to clonal interference, which slows down adaptation and increases the waiting time.\n4.  **Nature of Mutation**: It is assumed that only one type of beneficial mutation is possible, with a specific rate $\\mu_{b}$ and selection coefficient $s$. The model treats neofunctionalization as a single-step process.\n\nKey limitations of this model relative to realistic duplicate-gene evolution:\n1.  **Neglect of Other Fates**: The model only considers neofunctionalization. In reality, the most probable fate of a duplicate gene is nonfunctionalization (becoming a pseudogene) through degenerative mutations, which occur at a much higher rate than beneficial mutations. The second major fate, subfunctionalization (partitioning of ancestral functions), is also ignored. A complete model would have to account for the competition between these different evolutionary pathways. The duplicate pair must persist long enough for neofunctionalization to occur, meaning the rate of nonfunctionalization must be sufficiently low relative to the rate of neofunctionalization. The derived waiting time is conditional on the duplicate pair not being lost.\n2.  **Simplified Genetics**: The model assumes a single beneficial mutation with a constant, genic selection coefficient $s$. Real-world neofunctionalization may be a multi-step process involving several mutations. Further, the selective advantage may not be constant; it could be dependent on the environment or the genetic background (epistasis).\n3.  **Stability of the Duplicate**: The derivation assumes the duplicate-gene pair is a stable entity in the genome, serving as a constant target for mutation. In reality, duplicate genes are often subject to rapid loss via non-allelic homologous recombination. The model does not include a rate of gene loss for the entire duplicate locus.\n\nIn summary, the derived expression is an accurate approximation for the waiting time to neofunctionalization in a large, idealized population where neofunctionalizing mutations are rare but strongly selected, and where other evolutionary fates of the duplicate gene are ignored.", "answer": "$$\\boxed{\\frac{1}{4N\\mu_{b}s}}$$", "id": "2712805"}, {"introduction": "Real evolutionary trajectories are rarely as simple as pure decay or unopposed innovation; often, multiple potential pathways are available. This capstone practice [@problem_id:2712820] moves from tractable analytical models to a more holistic computational simulation, placing you in the role of a theoretical biologist exploring an adaptive landscape. By implementing a simulation of an adaptive walk, you will directly investigate the competition between neofunctionalization and subfunctionalization, gaining intuition for how factors like functional redundancy and metabolic costs can steer the fate of a duplicate gene.", "problem": "You will implement and analyze a minimal evolutionary model for duplicate genes undergoing selection on a composite fitness function with tunable epistasis, and classify adaptive outcomes as neofunctionalization or subfunctionalization. The model must be fully specified, deterministic given the stated random seeds, and solved by simulation. All outputs must be numerical and reproducible.\n\nDefinitions and fundamental base:\n- Start from the principle that, under the strong selection weak mutation (SSWM) approximation, adaptive evolution proceeds via sequential fixation of single mutations that increase absolute fitness. In this regime, an adaptive walk is a greedy ascent on a fixed fitness landscape until a local optimum with no beneficial single-step neighbors is reached.\n- Represent the genotype of two duplicated gene copies by binary presence or absence of three functions: two ancestral subfunctions and one potential novel function. For copy index $j \\in \\{1,2\\}$ and function index $i \\in \\{1,2,N\\}$, let $x_{j i} \\in \\{0,1\\}$ denote presence ($1$) or absence ($0$) of function $i$ in copy $j$. The initial state immediately after duplication is $x_{11}=1$, $x_{12}=1$, $x_{1N}=0$, $x_{21}=1$, $x_{22}=1$, $x_{2N}=0$.\n- Let $r \\in [0,1]$ be an epistasis parameter that controls diminishing returns from redundancy across the two copies for any function. Define the per-function redundancy response $g:\\{0,1,2\\}\\to\\mathbb{R}_{\\ge 0}$ by $g(0)=0$, $g(1)=1$, $g(2)=2-r$. Thus $r=0$ yields additive benefits across copies and $r=1$ yields full redundancy with no additional benefit for a second copy of the same function.\n- Let $b_1>0$, $b_2>0$, and $b_N>0$ be per-function benefit coefficients for functions $1$, $2$, and $N$, respectively. Let $c \\ge 0$ be a per-function per-copy cost. The organismal fitness function is\n$$\nW(x) \\;=\\; b_1 \\, g(x_{11}+x_{21}) \\;+\\; b_2 \\, g(x_{12}+x_{22}) \\;+\\; b_N \\, g(x_{1N}+x_{2N})\n\\;-\\; c \\sum_{j=1}^{2}\\sum_{i\\in\\{1,2,N\\}} x_{j i}.\n$$\n- The adaptive walk proceeds as follows (SSWM greedy ascent):\n    1. From the current state $x$, enumerate all $6$ single-step neighbors obtained by flipping exactly one bit $x_{j i}\\mapsto 1-x_{j i}$.\n    2. Compute the fitness difference $\\Delta W$ for each neighbor relative to the current state.\n    3. If the maximum $\\Delta W$ is positive, move to one neighbor achieving this maximum. If there are ties, break them deterministically by scanning neighbors in lexicographic order of $(j,i)$ where $j$ increases from $1$ to $2$ and $i$ is ordered as $1,2,N$, and choosing the first neighbor encountered that attains the maximum $\\Delta W$.\n    4. If no neighbor has $\\Delta W>0$, stop; the current state is a local optimum under single-step mutations.\n- Landscape stochasticity across replicates:\n    - The ancestral benefit coefficients $b_1$ and $b_2$ are drawn independently from a Gamma distribution with shape $k_b=2$ and scale $\\theta_b=\\mu_b/k_b$, so that $\\mathbb{E}[b_1]=\\mathbb{E}[b_2]=\\mu_b$.\n    - The novel benefit $b_N$ is drawn from a Gamma distribution with shape $k_b=2$ and scale $\\theta_N=\\mu_N/k_b$, so that $\\mathbb{E}[b_N]=\\mu_N$.\n    - All other aspects of the landscape are fixed by $(r,c)$.\n- Outcome classification at the local optimum:\n    - Define coverage indicators $y_1=\\mathbf{1}\\{x_{11}+x_{21}\\ge 1\\}$ and $y_2=\\mathbf{1}\\{x_{12}+x_{22}\\ge 1\\}$, and the number of novel-function copies $n_N = x_{1N}+x_{2N}$.\n    - Neofunctionalization is recorded if and only if $n_N=1$, $y_1=1$, $y_2=1$, and at least one duplicate fully retains both ancestral functions, i.e., $\\max\\{x_{11}+x_{12}, x_{21}+x_{22}\\}=2$.\n    - Subfunctionalization is recorded if and only if $n_N=0$, $y_1=1$, $y_2=1$, and each duplicate retains exactly one ancestral subfunction, i.e., $x_{11}+x_{12}=1$ and $x_{21}+x_{22}=1$.\n    - Any other outcome (including loss of ancestral coverage, complete redundancy retention, or both duplicates acquiring the novel function) is recorded as neither.\n- Frequencies are measured as empirical proportions across $R$ independent replicates and must be expressed as decimal fractions in $[0,1]$.\n\nRequired algorithmic tasks:\n- Implement the above adaptive walk and classification.\n- For each test case, run $R$ replicates. In each replicate, independently draw $b_1$, $b_2$, and $b_N$ as specified. Use a pseudorandom number generator seeded by $S_i=S+10\\cdot i$ for test case index $i\\in\\{0,1,2,3\\}$ (zero-based), where $S$ is the base seed given below. Within each test case, use a single generator instance to draw all replicate random variates sequentially, ensuring determinism.\n- For each test case, output a pair $[\\text{neo\\_freq},\\text{sub\\_freq}]$ giving the fraction of replicates classified as neofunctionalization and subfunctionalization, respectively. Round each frequency to $6$ decimal places.\n\nTest suite:\n- Use the following $4$ test cases with parameters $(r,c,\\mu_b,\\mu_N,R,S)$:\n    1. $r=1.0$, $c=0.1$, $\\mu_b=1.0$, $\\mu_N=0.1$, $R=200$, $S=137$.\n    2. $r=1.0$, $c=0.1$, $\\mu_b=1.0$, $\\mu_N=2.0$, $R=200$, $S=137$.\n    3. $r=0.0$, $c=0.1$, $\\mu_b=1.0$, $\\mu_N=0.1$, $R=200$, $S=137$.\n    4. $r=0.5$, $c=0.2$, $\\mu_b=1.0$, $\\mu_N=1.0$, $R=200$, $S=137$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list in the same order as the test suite, for example, \"[[a,b],[c,d],[e,f],[g,h]]\". The values $a,b,c,d,e,f,g,h$ must be the rounded decimal frequencies as specified above. No other text may be printed.", "solution": "The problem statement has been critically evaluated and is deemed valid. It is scientifically grounded in established principles of theoretical evolutionary biology, specifically the study of gene duplication under the strong-selection weak-mutation (SSWM) approximation. The problem is well-posed, with all parameters, functions, initial conditions, and algorithmic procedures, including deterministic tie-breaking and pseudorandom number generation, being specified with rigor and clarity. The model is self-contained, computationally feasible, and free from contradiction or ambiguity.\n\nThe task is to implement a computational simulation of an adaptive walk on a fitness landscape to determine the evolutionary fate of a duplicated gene pair. The simulation will be performed for multiple parameter sets (test cases), and for each, the frequencies of two specific outcomes—neofunctionalization and subfunctionalization—will be calculated over a number of stochastic replicates.\n\nThe core of the model is the genotype and its associated fitness function. The genotype of the two gene copies is represented by a 6-dimensional binary vector, $x = (x_{11}, x_{12}, x_{1N}, x_{21}, x_{22}, x_{2N}) \\in \\{0,1\\}^6$. Here, $x_{ji}=1$ signifies that copy $j \\in \\{1,2\\}$ possesses function $i \\in \\{1,2,N\\}$, where functions $1$ and $2$ are ancestral subfunctions and $N$ is a potential novel function. The initial state after duplication is fixed as $x_{\\text{initial}} = (1, 1, 0, 1, 1, 0)$, meaning both copies initially possess both ancestral subfunctions but not the novel one.\n\nThe fitness, $W(x)$, is defined as a sum of benefits from each function minus a total cost for maintaining an active copy of any function. The fitness function is given by:\n$$\nW(x) \\;=\\; b_1 \\, g(x_{11}+x_{21}) \\;+\\; b_2 \\, g(x_{12}+x_{22}) \\;+\\; b_N \\, g(x_{1N}+x_{2N})\n\\;-\\; c \\sum_{j=1}^{2}\\sum_{i\\in\\{1,2,N\\}} x_{j i}\n$$\nwhere $b_1, b_2, b_N$ are benefit coefficients for the respective functions, and $c$ is a per-function, per-copy cost. The function $g(s)$ models the effect of redundancy, where $s$ is the total number of copies of a given function. It is defined as $g(0)=0$, $g(1)=1$, and $g(2)=2-r$. The parameter $r \\in [0,1]$ tunes the level of epistasis: $r=0$ corresponds to additive benefits (no redundancy effect), while $r=1$ signifies complete redundancy where a second copy of a function provides no additional benefit.\n\nThe evolutionary process is modeled as a greedy adaptive walk on this fitness landscape, consistent with the SSWM regime. Starting from the initial genotype $x_{\\text{initial}}$, the algorithm proceeds in discrete steps. At each step, all $6$ single-mutant neighbors, which are genotypes differing by a single bit flip ($x_{ji} \\mapsto 1-x_{ji}$), are evaluated. If any neighbor provides a fitness increase ($\\Delta W > 0$), the genotype transitions to the neighbor with the strictly largest fitness gain. In case of a tie for the maximum positive $\\Delta W$, the tie is broken by selecting the first such neighbor encountered while scanning in lexicographical order of the index pair $(j,i)$, with $j \\in \\{1,2\\}$ and $i \\in \\{1,2,N\\}$. This process repeats until the genotype reaches a local fitness optimum, defined as a state where no single-mutant neighbor has higher fitness.\n\nThe fitness landscape itself is stochastic across replicates. For each of the $R$ replicates in a given test case, the benefit coefficients are drawn from specific probability distributions. The ancestral benefits $b_1$ and $b_2$ are independently drawn from a Gamma distribution with shape $k_b=2$ and scale $\\theta_b=\\mu_b/k_b$, where $\\mu_b$ is the specified mean benefit. The novel function benefit $b_N$ is drawn from a Gamma distribution with the same shape parameter $k_b=2$ but a scale $\\theta_N=\\mu_N/k_b$, where $\\mu_N$ is its mean. This stochasticity is made reproducible by seeding a pseudorandom number generator (PRNG) with a specific seed $S_i = S + 10 \\cdot i$ for each test case $i$.\n\nUpon reaching a local optimum, the final genotype is classified into one of three categories. Let the final state be $x_{\\text{final}}$. We define the ancestral function coverage indicators $y_1=\\mathbf{1}\\{x_{11}+x_{21}\\ge 1\\}$ and $y_2=\\mathbf{1}\\{x_{12}+x_{22}\\ge 1\\}$, and the number of novel-function copies $n_N = x_{1N}+x_{2N}$.\n-   **Neofunctionalization** is declared if the novel function is acquired by one copy, both ancestral functions are retained across the gene pair, and at least one copy has remained fully ancestral (i.e., not lost either ancestral function): $n_N=1$, and $y_1=1$, and $y_2=1$, and $\\max\\{x_{11}+x_{12}, x_{21}+x_{22}\\} = 2$.\n-   **Subfunctionalization** is declared if the novel function is not acquired, both ancestral functions are retained, and each copy has specialized to one of the ancestral functions: $n_N=0$, and $y_1=1$, and $y_2=1$, and $x_{11}+x_{12}=1$, and $x_{21}+x_{22}=1$.\n-   Any other terminal genotype is classified as **Neither**.\n\nThe final output for each test case consists of the empirical frequencies of neofunctionalization and subfunctionalization, calculated as the proportion of the $R$ replicates that result in each outcome. These frequencies must be rounded to $6$ decimal places.\n\nThe implementation will proceed by first defining a function to calculate fitness for any given genotype $x$ and parameter set $(b_1, b_2, b_N, r, c)$. A second function will encapsulate the adaptive walk, iteratively finding the best neighbor and updating the state until a local optimum is reached. A third function will classify the final state according to the specified rules. The main program will loop through the test cases, and for each, run the specified number of replicate simulations, aggregate the outcomes, and compute the required frequencies.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef g(s, r):\n    \"\"\"Calculates the per-function redundancy response.\"\"\"\n    if s == 0:\n        return 0.0\n    elif s == 1:\n        return 1.0\n    elif s == 2:\n        return 2.0 - r\n    return 0.0 # Should not be reached with binary genotypes\n\ndef calculate_fitness(x, b_coeffs, r, c):\n    \"\"\"\n    Calculates the organismal fitness for a given genotype.\n    x: genotype vector [x11, x12, x1N, x21, x22, x2N]\n    b_coeffs: benefit coefficients [b1, b2, bN]\n    r: epistasis parameter\n    c: cost parameter\n    \"\"\"\n    b1, b2, bN = b_coeffs\n    \n    # Sum of functions across copies\n    s1 = x[0] + x[3]\n    s2 = x[1] + x[4]\n    sN = x[2] + x[5]\n    \n    benefit = b1 * g(s1, r) + b2 * g(s2, r) + bN * g(sN, r)\n    cost = c * np.sum(x)\n    \n    return benefit - cost\n\ndef classify_outcome(x_final):\n    \"\"\"\n    Classifies the final genotype as neofunctionalization, subfunctionalization, or neither.\n    x_final: The genotype at the local optimum.\n    \"\"\"\n    x11, x12, x1N, x21, x22, x2N = x_final\n    \n    y1 = (x11 + x21) >= 1\n    y2 = (x12 + x22) >= 1\n    nN = x1N + x2N\n    \n    # Neofunctionalization condition\n    anc_sum_copy1 = x11 + x12\n    anc_sum_copy2 = x21 + x22\n    is_neo = (nN == 1) and y1 and y2 and (max(anc_sum_copy1, anc_sum_copy2) == 2)\n    if is_neo:\n        return 'neo'\n        \n    # Subfunctionalization condition\n    is_sub = (nN == 0) and y1 and y2 and (anc_sum_copy1 == 1) and (anc_sum_copy2 == 1)\n    if is_sub:\n        return 'sub'\n        \n    return 'neither'\n\ndef run_simulation(r, c, mu_b, mu_N, R, seed):\n    \"\"\"\n    Runs R replicates of the adaptive walk simulation for a given parameter set.\n    \"\"\"\n    k_b = 2.0\n    theta_b = mu_b / k_b\n    theta_N = mu_N / k_b\n    \n    rng = np.random.default_rng(seed)\n    \n    neo_count = 0\n    sub_count = 0\n    \n    for _ in range(R):\n        # Draw benefit coefficients for this replicate\n        b1, b2 = rng.gamma(shape=k_b, scale=theta_b, size=2)\n        bN = rng.gamma(shape=k_b, scale=theta_N)\n        b_coeffs = [b1, b2, bN]\n        \n        # Initial state\n        x_current = np.array([1, 1, 0, 1, 1, 0], dtype=int)\n        \n        # Adaptive walk\n        while True:\n            current_fitness = calculate_fitness(x_current, b_coeffs, r, c)\n            max_delta_w = 0.0\n            best_neighbor = None\n            \n            # Enumerate neighbors in lexicographic order of (j,i)\n            # (1,1), (1,2), (1,N), (2,1), (2,2), (2,N) corresponds to indices 0..5\n            for i in range(6):\n                x_neighbor = x_current.copy()\n                x_neighbor[i] = 1 - x_neighbor[i]\n                \n                neighbor_fitness = calculate_fitness(x_neighbor, b_coeffs, r, c)\n                delta_w = neighbor_fitness - current_fitness\n                \n                if delta_w > max_delta_w:\n                    max_delta_w = delta_w\n                    best_neighbor = x_neighbor\n\n            if max_delta_w > 0:\n                x_current = best_neighbor\n            else:\n                # Local optimum reached\n                break\n        \n        x_final = x_current\n        outcome = classify_outcome(x_final)\n        \n        if outcome == 'neo':\n            neo_count += 1\n        elif outcome == 'sub':\n            sub_count += 1\n            \n    neo_freq = neo_count / R\n    sub_freq = sub_count / R\n    \n    return [neo_freq, sub_freq]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Parameters: (r, c, mu_b, mu_N, R, S)\n    test_cases = [\n        (1.0, 0.1, 1.0, 0.1, 200, 137),\n        (1.0, 0.1, 1.0, 2.0, 200, 137),\n        (0.0, 0.1, 1.0, 0.1, 200, 137),\n        (0.5, 0.2, 1.0, 1.0, 200, 137),\n    ]\n\n    results = []\n    for i, case in enumerate(test_cases):\n        r, c, mu_b, mu_N, R, S = case\n        seed = S + 10 * i\n        result = run_simulation(r, c, mu_b, mu_N, R, seed)\n        results.append(result)\n\n    # Format output as specified\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2712820"}]}