{"hands_on_practices": [{"introduction": "We begin by exploring the temporal dynamics of an adaptive allele under two competing scenarios: arising from a pre-existing variant (SGV) or from continuous new mutation (de novo). This exercise demonstrates a fundamental challenge in population genetics, showing how these distinct histories can generate identical allele frequencies at a single point in time. By deriving the mathematical basis for this ambiguity [@problem_id:2688422], you will uncover why richer datasets are often necessary to accurately reconstruct evolutionary events.", "problem": "A large haploid population of effective size $N$ experiences a sudden environmental shift at time $t=0$ that makes a particular allele beneficial with selection coefficient $s>0$. Consider two alternative models for the origin of this adaptive allele:\n\n- Standing Genetic Variation (SGV) model: the allele is present at frequency $p_0 \\in (0,1)$ at $t=0$.\n- De novo recurrent mutation model: the allele is absent at $t=0$ and arises by new beneficial mutation at rate $U_b$ mutations per genome per generation.\n\nAssume non-overlapping generations, random mating, no dominance (haploid), and that $N$ is large enough and $s$ is small enough that the following well-tested approximations are applicable during the early phase of the sweep when $p(t) \\ll 1$:\n\n- The deterministic selection dynamics for a beneficial allele satisfy $dp/dt = s\\,p\\,(1-p)$, and when $p(t) \\ll 1$ this reduces to $dp/dt \\approx s\\,p$.\n- The establishment probability of a single newly arisen beneficial mutant with selection coefficient $s$ is approximately $s$.\n- When a new beneficial lineage escapes drift, it enters deterministic growth at an effective frequency on the order of $p^{\\ast} \\approx \\frac{1}{N s}$.\n- In the de novo model with recurrent beneficial input, the rate at which such established lineages appear is $N U_b \\times s$, and, in the regime $p(t) \\ll 1$, their aggregate contribution to the allele-frequency dynamics can be represented as a constant influx term.\n\nLet $T>0$ be a fixed observation time (in generations). Using only these foundations, do the following:\n\n1. Derive the early-phase expected allele frequency trajectory $p_{\\mathrm{SGV}}(t)$ under the SGV model and $p_{\\mathrm{DN}}(t)$ under the de novo model.\n2. By requiring $p_{\\mathrm{SGV}}(T) = p_{\\mathrm{DN}}(T)$, solve symbolically for the value $U_b^{\\ast}$ (as a function of $s$, $p_0$, and $T$) that makes the two models predict the same allele frequency at time $T$. Report your final expression for $U_b^{\\ast}$ in units of mutations per genome per generation.\n3. Briefly explain, based on your derivation, why these two models can generate indistinguishable data at time $T$ under the parameter combination you found, and identify at least two types of additional data that would allow one to distinguish the models in practice. Your explanation is not part of the final numeric or symbolic answer.\n\nYour final answer must be a single closed-form analytic expression for $U_b^{\\ast}$. No rounding is required.", "solution": "The problem presented is a standard, well-posed exercise in theoretical population genetics. It is scientifically grounded, internally consistent, and requires the application of fundamental principles. We will proceed with the derivation.\n\nThe problem asks for three tasks to be completed. We address them in order.\n\n**1. Derivation of Allele Frequency Trajectories**\n\nWe must derive the expected allele frequency trajectories, $p_{\\mathrm{SGV}}(t)$ and $p_{\\mathrm{DN}}(t)$, under the assumption that the allele frequency $p(t)$ is much less than $1$ ($p(t) \\ll 1$).\n\n*   **Standing Genetic Variation (SGV) Model:**\n    In this model, the beneficial allele is already present in the population at time $t=0$ with an initial frequency $p_{0}$. The dynamics are governed by deterministic selection. The provided differential equation for the early phase of the sweep is:\n    $$\n    \\frac{dp}{dt} \\approx s p\n    $$\n    This is a first-order linear ordinary differential equation representing exponential growth. With the initial condition $p(0) = p_{0}$, the solution is found by direct integration:\n    $$\n    \\int_{p_{0}}^{p_{\\mathrm{SGV}}(t)} \\frac{dp}{p} = \\int_{0}^{t} s \\, d\\tau\n    $$\n    $$\n    \\ln\\left(\\frac{p_{\\mathrm{SGV}}(t)}{p_{0}}\\right) = st\n    $$\n    Exponentiating both sides yields the trajectory for the SGV model:\n    $$\n    p_{\\mathrm{SGV}}(t) = p_{0} \\exp(st)\n    $$\n\n*   **De novo Recurrent Mutation (DN) Model:**\n    In this model, the allele is absent at $t=0$, so $p(0) = 0$. New beneficial alleles arise via mutation at a rate $U_b$ per genome per generation. These new mutants must escape stochastic loss (genetic drift) to contribute to the deterministic frequency increase. The problem states that a new mutant establishes with probability $s$, so the rate of appearance of *established* lineages in the population of size $N$ is $N U_b \\times s$.\n    \n    The problem further specifies that the aggregate contribution of these continuously arising new lineages can be modeled as a constant influx term in the allele-frequency dynamics. The rate of increase in allele frequency, $dp/dt$, is the sum of two terms: the growth of the existing beneficial alleles ($s p$) and the influx from new, established mutations.\n    \n    In a time interval $dt$, the number of new established lineages is $N s U_b dt$. Each such lineage, upon escaping drift, effectively enters the deterministic phase with a frequency of $p^{\\ast} \\approx \\frac{1}{Ns}$. Therefore, the rate of frequency influx is the product of the rate of lineage establishment and the starting frequency of each:\n    $$\n    \\text{Influx rate} = (N s U_b) \\times \\left(\\frac{1}{Ns}\\right) = U_b\n    $$\n    This confirms that $U_b$ is the constant influx term. The governing differential equation for the DN model is thus:\n    $$\n    \\frac{dp}{dt} = s p + U_b\n    $$\n    This is a first-order linear inhomogeneous differential equation. We solve it using an integrating factor, $I(t) = \\exp\\left(-\\int s \\, dt\\right) = \\exp(-st)$. Multiplying the equation by $I(t)$ gives:\n    $$\n    \\exp(-st)\\frac{dp}{dt} - s\\exp(-st)p = U_b \\exp(-st)\n    $$\n    The left side is the derivative of $p(t)\\exp(-st)$ with respect to $t$.\n    $$\n    \\frac{d}{dt}\\left(p(t)\\exp(-st)\\right) = U_b \\exp(-st)\n    $$\n    Integrating from $\\tau=0$ to $\\tau=t$, and applying the initial condition $p(0)=0$:\n    $$\n    p_{\\mathrm{DN}}(t)\\exp(-st) - p_{\\mathrm{DN}}(0)\\exp(0) = \\int_{0}^{t} U_b \\exp(-s\\tau) \\, d\\tau\n    $$\n    $$\n    p_{\\mathrm{DN}}(t)\\exp(-st) = U_b \\left[ -\\frac{1}{s}\\exp(-s\\tau) \\right]_{0}^{t}\n    $$\n    $$\n    p_{\\mathrm{DN}}(t)\\exp(-st) = -\\frac{U_b}{s} (\\exp(-st) - \\exp(0)) = \\frac{U_b}{s} (1 - \\exp(-st))\n    $$\n    Multiplying by $\\exp(st)$ gives the trajectory for the DN model:\n    $$\n    p_{\\mathrm{DN}}(t) = \\frac{U_b}{s} (\\exp(st) - 1)\n    $$\n\n**2. Calculation of the Equivalent Mutation Rate $U_b^{\\ast}$**\n\nWe are required to find the specific mutation rate, which we will call $U_b^{\\ast}$, that makes the two models predict the same allele frequency at a fixed observation time $T > 0$. We set $p_{\\mathrm{SGV}}(T) = p_{\\mathrm{DN}}(T)$:\n$$\np_{0} \\exp(sT) = \\frac{U_b^{\\ast}}{s} (\\exp(sT) - 1)\n$$\nSolving for $U_b^{\\ast}$ is a matter of algebraic rearrangement:\n$$\nU_b^{\\ast} = s p_{0} \\frac{\\exp(sT)}{\\exp(sT) - 1}\n$$\nThis expression provides the value for the beneficial mutation rate required for the de novo model to match the final frequency from a standing variant with initial frequency $p_0$ after $T$ generations of selection.\n\n**3. Explanation of Indistinguishability and Distinguishing Data**\n\nThe reason these two distinct evolutionary histories can produce an identical allele frequency at a single time point $T$ is that one process involves the prolonged exponential growth of a single, older variant, while the other involves the integrated exponential growth of a multitude of younger variants arising continuously. The SGV model's final frequency, $p_0 \\exp(sT)$, results from amplifying an initial state $p_0$ over the full duration $T$. The DN model's final frequency, $\\frac{U_b}{s}(\\exp(sT)-1)$, is the sum of frequencies from many lineages, each starting small and growing for a duration less than or equal to $T$. Our derived equivalence for $U_b^{\\ast}$ shows the precise mathematical trade-off between the initial frequency $p_0$ and the mutation rate $U_b$ that makes these two different summations yield the same result at time $T$. Observing the system only at this single endpoint, one cannot resolve the underlying temporal dynamics.\n\nTo distinguish between the SGV and de novo models in practice, one would require data that are sensitive to the history of the adaptive allele, not just its final frequency. Two primary types of data would be effective:\n\n1.  **Haplotype Structure**: Adaptation from a single standing variant (a \"hard sweep\") implies that the beneficial allele and a large linked segment of its original chromosome (the haplotype) sweep to high frequency. The result is a region of very low genetic diversity surrounding the selected locus, with nearly all individuals carrying the same long-range haplotype. In contrast, adaptation from recurrent de novo mutations (a \"soft sweep\") means the beneficial allele arises independently on multiple different genetic backgrounds. Consequently, the beneficial allele will be found on several distinct haplotypes, and the reduction in diversity around the selected locus will be less severe. Sequencing the genomic region around the selected site in a sample of individuals would reveal this difference in haplotype diversity.\n\n2.  **Temporal Allele Frequency Data**: If allele frequencies could be measured at multiple time points leading up to $T$ (for example, through ancient DNA or in a laboratory evolution experiment), the two models could be distinguished by the functional form of their trajectories. A plot of $\\ln(p(t))$ versus $t$ for the SGV model would be a straight line, $\\ln(p(t)) = \\ln(p_0) + st$, with a y-intercept of $\\ln(p_0)$. For the DN model, the same plot would show a curve, $\\ln(p(t)) = \\ln\\left(\\frac{U_b}{s}\\right) + \\ln(\\exp(st)-1)$, which is not linear in $t$ and would approach $-\\infty$ as $t \\to 0$. Fitting these distinct mathematical models to time-series data would allow for robust model selection.", "answer": "$$\n\\boxed{s p_{0} \\frac{\\exp(sT)}{\\exp(sT) - 1}}\n$$", "id": "2688422"}, {"introduction": "The probability that adaptation proceeds from standing genetic variation is not arbitrary; it depends on a balance of core evolutionary forces. This practice uses sensitivity analysis to dissect a key theoretical model that quantifies the likelihood of SGV versus adaptation from new mutation [@problem_id:2688410]. By exploring how the outcome is affected by changes in population size, selection strength, and mutation rate, you will develop a quantitative intuition for the conditions that favor each adaptive path.", "problem": "In models of rapid adaptation following an environmental shift, the probability that adaptation proceeds from standing genetic variation rather than from a new mutation can be approximated for rare alleles by\n$$\nP_{\\text{SGV}} \\approx 1 - \\exp\\!\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right),\n$$\nwhere $N_{e}$ is the effective population size, $s_{b}$ is the selection coefficient of the allele after the shift (beneficial), $s_{d}$ is the selection coefficient of the allele before the shift (deleterious in the ancestral environment), and $\\mu$ is the per-generation mutation rate to the focal allele. Assume $0  P_{\\text{SGV}}  1$ and that all parameters are strictly positive.\n\nUsing definitions from calculus and standard sensitivity analysis, do the following:\n\n1. Compute the gradient of $P_{\\text{SGV}}$ with respect to $(N_{e}, s_{b}, \\mu, s_{d})$, i.e., compute each partial derivative $\\frac{\\partial P_{\\text{SGV}}}{\\partial N_{e}}$, $\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{b}}$, $\\frac{\\partial P_{\\text{SGV}}}{\\partial \\mu}$, and $\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{d}}$ as symbolic expressions in terms of $N_{e}$, $s_{b}$, $s_{d}$, and $\\mu$.\n\n2. Define the (dimensionless) log-elasticity of $P_{\\text{SGV}}$ with respect to a parameter $x$ as $E_{x} \\equiv \\frac{\\partial \\ln P_{\\text{SGV}}}{\\partial \\ln x} = \\frac{x}{P_{\\text{SGV}}}\\frac{\\partial P_{\\text{SGV}}}{\\partial x}$. Derive $E_{N_{e}}$, $E_{s_{b}}$, $E_{\\mu}$, and $E_{s_{d}}$ symbolically and use these to rank the influence (by absolute magnitude) of each parameter on $P_{\\text{SGV}}$.\n\n3. Finally, evaluate the common absolute magnitude of the log-elasticities at\n$$\nN_{e} = 10^{5},\\quad s_{b} = 0.02,\\quad s_{d} = 0.01,\\quad \\mu = 2 \\times 10^{-8}.\n$$\nProvide your final answer as a single decimal number equal to this common absolute log-elasticity magnitude, rounded to four significant figures. No units are required, and the number must be expressed as a decimal (do not use a percentage sign).", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on a standard approximation from the field of population genetics and presents a mathematically tractable problem in sensitivity analysis. All necessary parameters and conditions are provided, and there are no internal contradictions. Therefore, the problem is valid and we proceed with the solution.\n\nLet the probability of adaptation from standing genetic variation be denoted by $P_{\\text{SGV}}$. The given model is:\n$$\nP_{\\text{SGV}} = 1 - \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\nwhere $N_{e}$ is the effective population size, $s_{b}$ is the selection coefficient of the beneficial allele, $s_{d}$ is the selection coefficient of the deleterious allele in the ancestral environment, and $\\mu$ is the mutation rate. We are given that all parameters are strictly positive.\n\nFor notational convenience, let us define the dimensionless parameter group $X$ as:\n$$\nX = \\frac{4 N_{e} s_{b} \\mu}{s_{d}}\n$$\nWith this definition, $P_{\\text{SGV}} = 1 - \\exp(-X)$. Since we are given $0  P_{\\text{SGV}}  1$, it follows that $X > 0$.\n\n**1. Gradient of $P_{\\text{SGV}}$**\n\nThe gradient of $P_{\\text{SGV}}$ with respect to the vector of parameters $(N_{e}, s_{b}, \\mu, s_{d})$ is the vector of its partial derivatives. We compute each component using the chain rule. For a generic parameter $p \\in \\{N_{e}, s_{b}, \\mu, s_{d}\\}$, the derivative is:\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial p} = \\frac{\\partial}{\\partial p} (1 - \\exp(-X)) = -\\exp(-X) \\left(-\\frac{\\partial X}{\\partial p}\\right) = \\exp(-X) \\frac{\\partial X}{\\partial p}\n$$\nWe now compute the partial derivative of $X$ with respect to each parameter:\n- With respect to $N_{e}$: $\\frac{\\partial X}{\\partial N_{e}} = \\frac{4 s_{b} \\mu}{s_{d}}$\n- With respect to $s_{b}$: $\\frac{\\partial X}{\\partial s_{b}} = \\frac{4 N_{e} \\mu}{s_{d}}$\n- With respect to $\\mu$: $\\frac{\\partial X}{\\partial \\mu} = \\frac{4 N_{e} s_{b}}{s_{d}}$\n- With respect to $s_{d}$: $\\frac{\\partial X}{\\partial s_{d}} = \\frac{\\partial}{\\partial s_{d}} (4 N_{e} s_{b} \\mu s_{d}^{-1}) = -4 N_{e} s_{b} \\mu s_{d}^{-2} = -\\frac{4 N_{e} s_{b} \\mu}{s_{d}^{2}}$\n\nSubstituting these into the expression for $\\frac{\\partial P_{\\text{SGV}}}{\\partial p}$, we find the components of the gradient:\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial N_{e}} = \\frac{4 s_{b} \\mu}{s_{d}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{b}} = \\frac{4 N_{e} \\mu}{s_{d}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial \\mu} = \\frac{4 N_{e} s_{b}}{s_{d}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{d}} = -\\frac{4 N_{e} s_{b} \\mu}{s_{d}^{2}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n\n**2. Log-Elasticities and Ranking**\n\nThe log-elasticity of $P_{\\text{SGV}}$ with respect to a parameter $p$ is defined as $E_{p} = \\frac{p}{P_{\\text{SGV}}} \\frac{\\partial P_{\\text{SGV}}}{\\partial p}$. We compute this for each parameter.\n\nFor $p \\in \\{N_{e}, s_{b}, \\mu\\}$, we can observe a pattern. We can see that $\\frac{\\partial X}{\\partial p} = \\frac{X}{p}$. Therefore,\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial p} = \\exp(-X) \\frac{X}{p}\n$$\nThe elasticity is then:\n$$\nE_{p} = \\frac{p}{P_{\\text{SGV}}} \\left( \\exp(-X) \\frac{X}{p} \\right) = \\frac{X \\exp(-X)}{P_{\\text{SGV}}} = \\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\nThus, the elasticities for $N_{e}$, $s_{b}$, and $\\mu$ are identical:\n$$\nE_{N_{e}} = E_{s_{b}} = E_{\\mu} = \\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\n\nFor $s_{d}$, we found $\\frac{\\partial X}{\\partial s_{d}} = -\\frac{X}{s_{d}}$. Therefore,\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{d}} = \\exp(-X) \\left(-\\frac{X}{s_{d}}\\right) = -\\frac{X \\exp(-X)}{s_{d}}\n$$\nThe elasticity with respect to $s_{d}$ is:\n$$\nE_{s_{d}} = \\frac{s_{d}}{P_{\\text{SGV}}} \\left(-\\frac{X \\exp(-X)}{s_{d}}\\right) = -\\frac{X \\exp(-X)}{P_{\\text{SGV}}} = -\\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\nComparing the results, we see that $E_{s_{d}} = -E_{N_{e}} = -E_{s_{b}} = -E_{\\mu}$.\n\nTo rank the influence of each parameter by its absolute magnitude, we compute the absolute value of each elasticity:\n$$\n|E_{N_{e}}| = |E_{s_{b}}| = |E_{\\mu}| = |E_{s_{d}}| = \\left|\\frac{X \\exp(-X)}{1 - \\exp(-X)}\\right| = \\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\nThe last equality holds because $X > 0$, so $\\exp(-X) > 0$ and $1 - \\exp(-X) > 0$.\nSince the absolute magnitudes of the log-elasticities are identical for all four parameters, they are ranked equally in terms of their proportional influence on $P_{\\text{SGV}}$.\n\n**3. Numerical Evaluation**\n\nWe must now evaluate the common absolute magnitude of the log-elasticities at the given parameter values:\n$N_{e} = 10^{5}$, $s_{b} = 0.02$, $s_{d} = 0.01$, and $\\mu = 2 \\times 10^{-8}$.\n\nFirst, we compute the value of $X$:\n$$\nX = \\frac{4 N_{e} s_{b} \\mu}{s_{d}} = \\frac{4 \\times (10^{5}) \\times (0.02) \\times (2 \\times 10^{-8})}{0.01}\n$$\n$$\nX = \\frac{4 \\times 10^{5} \\times 2 \\times 10^{-2} \\times 2 \\times 10^{-8}}{10^{-2}} = \\frac{16 \\times 10^{5-2-8}}{10^{-2}} = \\frac{16 \\times 10^{-5}}{10^{-2}} = 16 \\times 10^{-3} = 0.016\n$$\nNow, we evaluate the common absolute elasticity, which we denote $E_{\\text{abs}}$:\n$$\nE_{\\text{abs}} = \\frac{X \\exp(-X)}{1 - \\exp(-X)} = \\frac{X}{\\exp(X) - 1}\n$$\nSubstituting $X = 0.016$:\n$$\nE_{\\text{abs}} = \\frac{0.016}{\\exp(0.016) - 1}\n$$\nUsing a calculator for the exponential function:\n$\\exp(0.016) \\approx 1.01612885$\n$$\nE_{\\text{abs}} \\approx \\frac{0.016}{1.01612885 - 1} = \\frac{0.016}{0.01612885} \\approx 0.992013038\n$$\nRounding to four significant figures, as required by the problem, we obtain $0.9920$.\nThis value represents the common absolute log-elasticity magnitude.", "answer": "$$\\boxed{0.9920}$$", "id": "2688410"}, {"introduction": "To resolve the ambiguity between adaptive histories, we can analyze the genomic region surrounding the beneficial allele. This exercise delves into the theory of genetic hitchhiking to predict the distinct signatures left in haplotype data by different types of selective sweeps [@problem_id:2688407]. By deriving expected values for common homozygosity statistics, you will learn how the number of founding haplotypes carrying a beneficial allele leaves a measurable footprint on linked genetic variation, providing a powerful tool for empirical inference.", "problem": "Consider a panmictic haploid Wrightâ€“Fisher population of constant size $N$ in which a beneficial allele with selection coefficient $s$ rises to fixation. You analyze a focal neutral haplotype window at recombination rate $r$ (per generation) from the selected site. Work in the strong selection, rare recombination regime where the structured coalescent with selection and recombination applies, and use the star-like approximation for the sweep genealogy at the selected site. Let $X(t)$ denote the deterministic allele-frequency trajectory of the beneficial allele during the sweep, and let the scaled recombination rate be $\\rho = 2 N r$. Under the structured coalescent, the probability that a sampled lineage at the neutral window does not recombine off the sweeping background over the duration of the sweep is\n$$\n\\lambda \\equiv \\exp\\!\\Big(-\\rho \\int_{0}^{T} X(t)\\,\\mathrm{d}t\\Big),\n$$\nwhere $T$ is the sweep duration. Assume the focal window is short enough that recombination within the window is negligible during the sweep.\n\nDefine haplotype homozygosity statistics on the sample frequency spectrum of haplotypes in the focal window as follows. Let $p_{1} \\ge p_{2} \\ge \\cdots \\ge p_{m}$ be the ordered haplotype frequencies in the (large) sample:\n- $H1 = \\sum_{i=1}^{m} p_{i}^{2}$,\n- $H12 = (p_{1} + p_{2})^{2} + \\sum_{i=3}^{m} p_{i}^{2}$,\n- $H2/H1 = \\dfrac{H1 - p_{1}^{2}}{H1}$.\n\nConsider two sweep origins:\n(i) a hard sweep from a single mutational origin,\n(ii) a soft sweep from standing genetic variation with $k$ founder haplotypes ($k \\ge 2$) at the onset of selection, whose contributions at the selected site form a frequency vector $\\mathbf{f} = (f_{1},\\dots,f_{k})$ with $\\sum_{i=1}^{k} f_{i} = 1$. Assume symmetry for the soft sweep so that $f_{i} = 1/k$ for all $i \\in \\{1,\\dots,k\\}$.\n\nAdopt the following simplifying but standard approximations for hitchhiking haplotypes in the focal window after fixation:\n- With probability $\\lambda$, a sampled lineage remains linked to one of the $k$ sweeping founder backgrounds throughout the sweep; conditional on linkage, the probability it is on founder background $i$ is $f_{i}$.\n- With probability $1-\\lambda$, a sampled lineage recombines off the sweeping background during the sweep; the resulting recombinant haplotypes are spread over a very large number of backgrounds so that their aggregate squared-frequency contribution to homozygosity is negligible in the large-sample limit.\n\nUnder these assumptions, derive the expected values of $H1$, $H12$, and $H2/H1$ in the large-sample limit for case (ii) with $k \\ge 2$ symmetric founders, and for case (i) (the hard sweep, which you may regard as $k=1$ with $f_{1}=1$). Express your final answer as a single row matrix listing the six expectations in the following order:\n$$\n\\big(\\,\\mathbb{E}[H1]_{\\mathrm{soft}},\\ \\mathbb{E}[H12]_{\\mathrm{soft}},\\ \\mathbb{E}[H2/H1]_{\\mathrm{soft}},\\ \\mathbb{E}[H1]_{\\mathrm{hard}},\\ \\mathbb{E}[H12]_{\\mathrm{hard}},\\ \\mathbb{E}[H2/H1]_{\\mathrm{hard}}\\,\\big),\n$$\nas closed-form analytic expressions in terms of $\\lambda$ and $k$. No numerical evaluation is required and no units apply. Provide exact expressions; do not approximate or round.", "solution": "The problem presented is a valid theoretical exercise in population genetics, grounded in the established theory of selective sweeps. It is well-posed, objective, and contains sufficient information for a unique solution under the given approximations. I will proceed with the derivation.\n\nThe core of the problem lies in determining the expected haplotype frequency spectrum after a selective sweep and then computing homozygosity statistics from this spectrum. We are given a model with two key approximations for a large sample from the population after the sweep is complete:\n1.  A lineage sampled at the neutral locus is a descendant of one of the original $k$ founder backgrounds (non-recombinant) with probability $\\lambda$. Conditioned on this, it is a descendant of founder $i$ with probability $f_i$. Thus, the population frequency of non-recombinant haplotypes descended from founder $i$ is $p_{\\text{founder},i} = \\lambda f_i$.\n2.  A lineage is a recombinant with probability $1-\\lambda$. These recombinant haplotypes are numerous and each individually has a very low frequency. Crucially, their aggregate contribution to homozygosity is negligible. That is, if $\\mathcal{R}$ is the set of recombinant haplotypes, then $\\sum_{j \\in \\mathcal{R}} p_j^2 \\approx 0$.\n\nIn the large-sample limit, we can equate the sample frequencies with these population frequencies. The problem asks for the expected values of the statistics $H1$, $H12$, and $H2/H1$. Because the model provides deterministic population frequencies (given $\\lambda$ and $f_i$), and in the large-sample limit the variance of sample frequencies tends to zero, the expectation of the statistics can be calculated by applying the formulas to these very population frequencies.\n\nWe will analyze two cases as specified: (i) a hard sweep, which corresponds to $k=1$ and $f_1=1$, and (ii) a symmetric soft sweep with $k \\ge 2$ founders, where $f_i = 1/k$ for all $i \\in \\{1, \\dots, k\\}$.\n\n**Case (ii): Symmetric Soft Sweep ($k \\ge 2$)**\n\nFor a symmetric soft sweep with $k$ founders, we have $f_i = 1/k$. The population frequencies of the $k$ founder-associated haplotypes are identical:\n$$\np_{\\text{founder},i} = \\lambda f_i = \\frac{\\lambda}{k} \\quad \\text{for } i=1, \\dots, k.\n$$\nThese will be the $k$ most frequent haplotypes in the population. Since they are all equal, the ordered frequencies are $p_1 = p_2 = \\dots = p_k = \\lambda/k$. All other haplotypes are recombinants with negligible squared frequencies.\n\n**1. Calculation of $\\mathbb{E}[H1]_{\\mathrm{soft}}$**\nThe statistic $H1$ is the sum of squared haplotype frequencies, $\\sum_{i=1}^{m} p_i^2$.\n$$\n\\mathbb{E}[H1]_{\\mathrm{soft}} = H1 = \\sum_{i=1}^{k} \\left(\\frac{\\lambda}{k}\\right)^2 + \\sum_{j \\in \\mathcal{R}} p_j^2\n$$\nUsing the approximation that the sum of squared recombinant frequencies is zero:\n$$\n\\mathbb{E}[H1]_{\\mathrm{soft}} \\approx k \\left(\\frac{\\lambda}{k}\\right)^2 = k \\frac{\\lambda^2}{k^2} = \\frac{\\lambda^2}{k}.\n$$\n\n**2. Calculation of $\\mathbb{E}[H12]_{\\mathrm{soft}}$**\nThe statistic $H12$ is defined as $(p_1 + p_2)^2 + \\sum_{i=3}^{m} p_i^2$. Since $k \\ge 2$, the two most frequent haplotypes, $p_1$ and $p_2$, are founder haplotypes with frequency $\\lambda/k$.\n$$\np_1 = \\frac{\\lambda}{k} \\quad \\text{and} \\quad p_2 = \\frac{\\lambda}{k}.\n$$\nThe sum $\\sum_{i=3}^{m} p_i^2$ includes the remaining $k-2$ founder haplotypes and all recombinant haplotypes.\n$$\n\\mathbb{E}[H12]_{\\mathrm{soft}} = H12 \\approx \\left(\\frac{\\lambda}{k} + \\frac{\\lambda}{k}\\right)^2 + \\sum_{i=3}^{k} \\left(\\frac{\\lambda}{k}\\right)^2 + \\sum_{j \\in \\mathcal{R}} p_j^2\n$$\n$$\n\\mathbb{E}[H12]_{\\mathrm{soft}} \\approx \\left(\\frac{2\\lambda}{k}\\right)^2 + (k-2)\\left(\\frac{\\lambda}{k}\\right)^2 = \\frac{4\\lambda^2}{k^2} + (k-2)\\frac{\\lambda^2}{k^2} = \\frac{(4+k-2)\\lambda^2}{k^2} = \\frac{(k+2)\\lambda^2}{k^2}.\n$$\nThis derivation is valid for $k \\ge 2$.\n\n**3. Calculation of $\\mathbb{E}[H2/H1]_{\\mathrm{soft}}$**\nThe statistic $H2/H1$ is defined as $\\frac{H1 - p_1^2}{H1} = 1 - \\frac{p_1^2}{H1}$.\nUsing our results for $p_1$ and $H1$:\n$$\n\\mathbb{E}[H2/H1]_{\\mathrm{soft}} \\approx 1 - \\frac{(\\lambda/k)^2}{\\lambda^2/k} = 1 - \\frac{\\lambda^2/k^2}{\\lambda^2/k} = 1 - \\frac{1}{k}.\n$$\n\n**Case (i): Hard Sweep ($k=1$)**\n\nFor a hard sweep, there is a single founder haplotype, so $k=1$ and $f_1=1$. The frequency of this haplotype is:\n$$\np_1 = \\lambda f_1 = \\lambda.\n$$\nAll other haplotypes are recombinants, so their frequencies $p_2, p_3, \\dots$ are very small, and their contribution to sums of squares is negligible.\n\n**1. Calculation of $\\mathbb{E}[H1]_{\\mathrm{hard}}$**\n$$\n\\mathbb{E}[H1]_{\\mathrm{hard}} = H1 \\approx p_1^2 + \\sum_{j \\in \\mathcal{R}} p_j^2 \\approx \\lambda^2 + 0 = \\lambda^2.\n$$\nThis result is consistent with the general formula for the soft sweep by setting $k=1$: $\\lambda^2/1 = \\lambda^2$.\n\n**2. Calculation of $\\mathbb{E}[H12]_{\\mathrm{hard}}$**\nHere, $p_1 \\approx \\lambda$, but the second most frequent haplotype, $p_2$, is the most frequent among the numerous recombinant haplotypes. By the problem's approximation, its frequency must be negligible, so $p_2 \\approx 0$.\n$$\n\\mathbb{E}[H12]_{\\mathrm{hard}} = H12 = (p_1 + p_2)^2 + \\sum_{i=3}^{m} p_i^2 \\approx (\\lambda + 0)^2 + 0 = \\lambda^2.\n$$\nNote that the formula derived for the soft sweep ($k \\ge 2$) does not apply here. The structure of the haplotype frequencies is fundamentally different with respect to the top two ranks.\n\n**3. Calculation of $\\mathbb{E}[H2/H1]_{\\mathrm{hard}}$**\n$$\n\\mathbb{E}[H2/H1]_{\\mathrm{hard}} = H2/H1 = 1 - \\frac{p_1^2}{H1} \\approx 1 - \\frac{\\lambda^2}{\\lambda^2} = 0.\n$$\nThis result is consistent with the general formula for the soft sweep by setting $k=1$: $1 - 1/1 = 0$.\n\n**Summary of Results**\nThe six requested expected values are:\n- $\\mathbb{E}[H1]_{\\mathrm{soft}} = \\frac{\\lambda^2}{k}$\n- $\\mathbb{E}[H12]_{\\mathrm{soft}} = \\frac{(k+2)\\lambda^2}{k^2}$\n- $\\mathbb{E}[H2/H1]_{\\mathrm{soft}} = 1 - \\frac{1}{k}$\n- $\\mathbb{E}[H1]_{\\mathrm{hard}} = \\lambda^2$\n- $\\mathbb{E}[H12]_{\\mathrm{hard}} = \\lambda^2$\n- $\\mathbb{E}[H2/H1]_{\\mathrm{hard}} = 0$\n\nThese are to be presented in a single row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\lambda^2}{k}  \\frac{(k+2)\\lambda^2}{k^2}  1 - \\frac{1}{k}  \\lambda^2  \\lambda^2  0 \\end{pmatrix}}\n$$", "id": "2688407"}]}