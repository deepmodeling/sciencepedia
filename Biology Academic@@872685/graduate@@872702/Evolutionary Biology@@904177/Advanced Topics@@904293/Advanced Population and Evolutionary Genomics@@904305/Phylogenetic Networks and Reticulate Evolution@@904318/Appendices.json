{"hands_on_practices": [{"introduction": "Phylogenetic networks are powerful tools for visualizing evolutionary conflict present in distance data. Instead of forcing relationships into a strictly branching tree, methods like NeighborNet can reveal more complex, web-like patterns. This first exercise provides a hands-on calculation of the initial step in the NeighborNet algorithm, demonstrating how it uses the neighbor-joining criterion to select the most closely related pair of taxa from a distance matrix, which forms the basis for constructing the network's circular ordering [@problem_id:2743224].", "problem": "A research team is analyzing reticulate evolution among five taxa using a distance-based method designed to recover split networks. They plan to use the first agglomeration step of the NeighborNet algorithm to initialize a circular ordering of the taxa from which a network can be constructed. You are given the symmetric taxon distance matrix $D=(d_{ij})$ on taxa $\\{A,B,C,D,E\\}$:\n$$\nD \\;=\\;\n\\begin{pmatrix}\n0 & 2 & 8 & 9 & 9 \\\\\n2 & 0 & 9 & 9 & 10 \\\\\n8 & 9 & 0 & 3 & 8 \\\\\n9 & 9 & 3 & 0 & 9 \\\\\n9 & 10 & 8 & 9 & 0\n\\end{pmatrix},\n$$\nwhere the $(i,j)$-entry $d_{ij}$ is the observed evolutionary distance between taxa $i$ and $j$, and $d_{ii}=0$ for all $i$. Assume the distances are additive approximations consistent with standard stochastic models of sequence evolution.\n\nUsing foundational facts for agglomerative distance methods, proceed as follows.\n\n- Use the neighbor-joining $Q$-criterion (as applied in the first step of NeighborNet when all clusters are singletons) to choose the first agglomerated pair. For $n$ taxa with pairwise distances $d_{ij}$ and row sums $r_i = \\sum_{k \\neq i} d_{ik}$, compute\n$$\nQ(i,j) = (n-2)d_{ij} - r_i - r_j,\n$$\nwith $n=5$, for all unordered pairs $\\{i,j\\}$, and select the pair with the minimal $Q$-value.\n\n- Starting from this agglomerated pair $(u,v)$, produce a circular ordering of all five taxa by the following nearest-neighbor extension rule: initialize an ordering with $(u,v)$; among the remaining taxa, at each step select the taxon $x$ minimizing $\\min\\{d_{ux}, d_{vx}\\}$, and attach $x$ to the end ($u$-end or $v$-end of the current ordering) to which it is closer, breaking ties by smaller $r_x$ and, if still tied, by smaller $d_{ux}$; after attachment, update the current ends accordingly; repeat until all taxa are placed to obtain a circular ordering up to rotation and reversal.\n\nShow your intermediate computations, including the $r_i$ values, the $Q(i,j)$ values, the selected pair, and the constructed circular ordering. Then, as your final reported quantity, provide the minimal $Q$-value you found for the first agglomeration. Express the final value as an exact integer (no rounding). Do not include any units in your final answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Taxa set: $\\{A, B, C, D, E\\}$\n- Number of taxa: $n=5$\n- Symmetric distance matrix $D = (d_{ij})$:\n$$\nD = \\begin{pmatrix}\n0 & 2 & 8 & 9 & 9 \\\\\n2 & 0 & 9 & 9 & 10 \\\\\n8 & 9 & 0 & 3 & 8 \\\\\n9 & 9 & 3 & 0 & 9 \\\\\n9 & 10 & 8 & 9 & 0\n\\end{pmatrix}\n$$\n- $Q$-criterion for agglomeration: $Q(i,j) = (n-2)d_{ij} - r_i - r_j$\n- Row sum definition: $r_i = \\sum_{k \\neq i} d_{ik}$\n- Circular ordering construction rule:\n    1. Initialize ordering with the pair $(u,v)$ that minimizes $Q(i,j)$.\n    2. At each step, select an unplaced taxon $x$ that minimizes $\\min\\{d_{ux}, d_{vx}\\}$, where $u$ and $v$ are the current ends of the ordered list.\n    3. Attach $x$ to the end ($u$ or $v$) to which it is closer.\n    4. Ties are broken first by smaller $r_x$, and then by smaller $d_{ux}$.\n    5. Repeat until all taxa are placed.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is based on the Neighbor-Joining ($Q$-criterion) and NeighborNet algorithms, which are standard and well-established methods in computational evolutionary biology for constructing phylogenetic trees and networks from distance data. The premise is scientifically sound.\n- **Well-Posed**: The problem provides all necessary data (distance matrix $D$), definitions (formulas for $r_i$ and $Q(i,j)$), and a complete, deterministic algorithm for constructing the circular ordering, including explicit tie-breaking rules. A unique solution is guaranteed.\n- **Objective**: The problem is stated in precise, formal language, free of ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem is self-contained. The size of the matrix ($5 \\times 5$) matches the number of taxa ($n=5$). No information is missing or contradictory.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-defined computational exercise in applying a known phylogenetic algorithm. A full solution will be provided.\n\nThe first task is to identify the pair of taxa $\\{i,j\\}$ that minimizes the $Q$-criterion. This requires calculating the row sums $r_i$ for each taxon, and then the $Q(i,j)$ values for all distinct pairs. The number of taxa is $n=5$.\n\nFirst, we compute the row sums $r_i = \\sum_{k \\neq i} d_{ik}$ for each taxon $i \\in \\{A, B, C, D, E\\}$.\n$$r_A = d_{AB} + d_{AC} + d_{AD} + d_{AE} = 2 + 8 + 9 + 9 = 28$$\n$$r_B = d_{BA} + d_{BC} + d_{BD} + d_{BE} = 2 + 9 + 9 + 10 = 30$$\n$$r_C = d_{CA} + d_{CB} + d_{CD} + d_{CE} = 8 + 9 + 3 + 8 = 28$$\n$$r_D = d_{DA} + d_{DB} + d_{DC} + d_{DE} = 9 + 9 + 3 + 9 = 30$$\n$$r_E = d_{EA} + d_{EB} + d_{EC} + d_{ED} = 9 + 10 + 8 + 9 = 36$$\n\nNext, we compute the $Q(i,j)$ values using the formula $Q(i,j) = (n-2)d_{ij} - r_i - r_j$. With $n=5$, this becomes $Q(i,j) = 3 d_{ij} - r_i - r_j$. There are $\\binom{5}{2} = 10$ unique pairs to evaluate.\n\n$Q(A,B) = 3 \\cdot d_{AB} - r_A - r_B = 3(2) - 28 - 30 = 6 - 58 = -52$\n$Q(A,C) = 3 \\cdot d_{AC} - r_A - r_C = 3(8) - 28 - 28 = 24 - 56 = -32$\n$Q(A,D) = 3 \\cdot d_{AD} - r_A - r_D = 3(9) - 28 - 30 = 27 - 58 = -31$\n$Q(A,E) = 3 \\cdot d_{AE} - r_A - r_E = 3(9) - 28 - 36 = 27 - 64 = -37$\n$Q(B,C) = 3 \\cdot d_{BC} - r_B - r_C = 3(9) - 30 - 28 = 27 - 58 = -31$\n$Q(B,D) = 3 \\cdot d_{BD} - r_B - r_D = 3(9) - 30 - 30 = 27 - 60 = -33$\n$Q(B,E) = 3 \\cdot d_{BE} - r_B - r_E = 3(10) - 30 - 36 = 30 - 66 = -36$\n$Q(C,D) = 3 \\cdot d_{CD} - r_C - r_D = 3(3) - 28 - 30 = 9 - 58 = -49$\n$Q(C,E) = 3 \\cdot d_{CE} - r_C - r_E = 3(8) - 28 - 36 = 24 - 64 = -40$\n$Q(D,E) = 3 \\cdot d_{DE} - r_D - r_E = 3(9) - 30 - 36 = 27 - 66 = -39$\n\nComparing the calculated $Q$-values: $\\{-52, -32, -31, -37, -31, -33, -36, -49, -40, -39\\}$. The minimum value is $-52$, which corresponds to the pair $\\{A, B\\}$. This is the first agglomerated pair.\n\nThe final reported quantity requested is this minimal $Q$-value. However, for completeness as instructed, we proceed with the construction of the circular ordering.\n\nThe initial ordering is $(A, B)$. The ends of the ordering are $u=A$ and $v=B$. The remaining unplaced taxa are $\\{C, D, E\\}$.\n\n**Iteration 1:**\nWe must select the taxon $x \\in \\{C, D, E\\}$ that minimizes $\\min\\{d_{Ax}, d_{Bx}\\}$.\n- For $x=C$: $\\min\\{d_{AC}, d_{BC}\\} = \\min\\{8, 9\\} = 8$.\n- For $x=D$: $\\min\\{d_{AD}, d_{BD}\\} = \\min\\{9, 9\\} = 9$.\n- For $x=E$: $\\min\\{d_{AE}, d_{BE}\\} = \\min\\{9, 10\\} = 9$.\nThe minimum is $8$, so we select taxon $C$. We attach $C$ to the end to which it is closer. Since $d_{AC} = 8$ is less than $d_{BC} = 9$, we attach $C$ to the $A$-end.\nThe new ordering is $(C, A, B)$. The ends are now $u=C$ and $v=B$. The remaining taxa are $\\{D, E\\}$.\n\n**Iteration 2:**\nWe select the taxon $x \\in \\{D, E\\}$ that minimizes $\\min\\{d_{Cx}, d_{Bx}\\}$.\n- For $x=D$: $\\min\\{d_{CD}, d_{BD}\\} = \\min\\{3, 9\\} = 3$.\n- For $x=E$: $\\min\\{d_{CE}, d_{BE}\\} = \\min\\{8, 10\\} = 8$.\nThe minimum is $3$, so we select taxon $D$. We attach $D$ to the end to which it is closer. Since $d_{CD} = 3$ is less than $d_{BD} = 9$, we attach $D$ to the $C$-end.\nThe new ordering is $(D, C, A, B)$. The ends are now $u=D$ and $v=B$. The only remaining taxon is $\\{E\\}$.\n\n**Iteration 3:**\nThe last taxon is $E$. We must attach it to end $D$ or end $B$.\nWe compare $d_{DE} = 9$ and $d_{BE} = 10$. Since $d_{DE} < d_{BE}$, we attach $E$ to the $D$-end.\nThe final linear ordering is $(E, D, C, A, B)$. This corresponds to the circular ordering $(A-B-E-D-C-A)$.\n\nThe intermediate computations are thus:\n- Row sums: $r_A=28, r_B=30, r_C=28, r_D=30, r_E=36$.\n- $Q$-values: $Q(A,B)=-52$, $Q(A,C)=-32$, $Q(A,D)=-31$, $Q(A,E)=-37$, $Q(B,C)=-31$, $Q(B,D)=-33$, $Q(B,E)=-36$, $Q(C,D)=-49$, $Q(C,E)=-40$, $Q(D,E)=-39$.\n- Selected pair: $\\{A, B\\}$ with minimal $Q$-value of $-52$.\n- Constructed circular ordering: $(A, B, E, D, C)$ up to rotation and reversal.\n\nThe question asks for the minimal $Q$-value found for the first agglomeration. This value has been determined to be $-52$.", "answer": "$$\\boxed{-52}$$", "id": "2743224"}, {"introduction": "An explicit phylogenetic network is not just a diagram of relationships; it is a quantitative model that generates a probability distribution of gene trees. This concept is central to statistical methods that infer networks or estimate parameters like inheritance probabilities ($\\gamma$). This practice problem illustrates this principle by asking you to calculate the probability of observing a specific gene tree topology, given a network with defined reticulation events and their associated inheritance probabilities [@problem_id:2743232]. Working through this calculation solidifies the connection between the abstract network graph and the concrete genetic data it aims to explain.", "problem": "A rooted binary phylogenetic network on leaves $a$, $b$, $c$, and $d$ is defined as follows. The root $\\rho$ splits into two ancestral lineages at an internal bifurcation, producing internal nodes $L$ and $M$. Node $L$ speciates into leaf $a$ and a continuing lineage $L'$. Node $M$ speciates into leaf $d$ and a continuing lineage $M'$. Two reticulation events occur subsequently:\n- Reticulation $R_1$ has parents $L'$ and $M'$ and a single child that leads directly to leaf $b$. The inheritance probability that the single locus at this reticulation is inherited from parent $L'$ is $\\gamma_1$, and from $M'$ is $1-\\gamma_1$.\n- Reticulation $R_2$ has parents $L'$ and $M'$ and a single child that leads directly to leaf $c$. The inheritance probability that the single locus at this reticulation is inherited from parent $L'$ is $\\gamma_2$, and from $M'$ is $1-\\gamma_2$.\n\nAssume the standard single-locus, no-recombination model for reticulate evolution: at each reticulation, exactly one incoming parental edge is chosen with its inheritance probability, choices at distinct reticulations are independent, and the resulting directed acyclic graph is reduced to the displayed rooted tree by suppressing all nodes of indegree $1$ and outdegree $1$.\n\nLet the inheritance probabilities be $\\gamma_1 = 0.73$ and $\\gamma_2 = 0.41$. Compute the probability that the displayed rooted tree has topology $T = ((a,b),(c,d))$. Give your answer as an exact decimal in $[0,1]$.", "solution": "The problem requires the computation of the probability that a specific rooted tree topology, $T = ((a,b),(c,d))$, is realized from a given phylogenetic network under a single-locus inheritance model. The process is governed by stochastic choices at reticulation events.\n\nFirst, we must formalize the structure of the phylogenetic network and the process of generating a tree from it. The network contains four leaves: $a$, $b$, $c$, and $d$. The root, $\\rho$, bifurcates into nodes $L$ and $M$. Node $L$ gives rise to leaf $a$ and an internal lineage $L'$. Node $M$ gives rise to leaf $d$ and an internal lineage $M'$. Two reticulation nodes exist, $R_1$ and $R_2$, which determine the ancestry of leaves $b$ and $c$, respectively. Both $R_1$ and $R_2$ have the same parental lineages, $L'$ and $M'$.\n\nA single-locus tree is generated by resolving each reticulation. At each reticulation node, one of the two parental lineages is chosen. The choices are independent events.\n- For leaf $b$, originating from reticulation $R_1$, the parental lineage is $L'$ with probability $\\gamma_1$, or $M'$ with probability $1-\\gamma_1$.\n- For leaf $c$, originating from reticulation $R_2$, the parental lineage is $L'$ with probability $\\gamma_2$, or $M'$ with probability $1-\\gamma_2$.\n\nSince there are two independent binary choices, there are $2 \\times 2 = 4$ possible resulting trees. We must analyze the topology of each of these four possible outcomes and calculate their respective probabilities.\n\nLet us denote the choice of parent for leaf $x$ as $x \\leftarrow P$, where $P$ is the parental lineage.\n\nCase 1: $b \\leftarrow L'$ and $c \\leftarrow L'$.\nThe probability of this joint event is $P_1 = \\gamma_1 \\gamma_2$.\nIn this scenario, the paths from the root $\\rho$ to the leaves are:\n- Path to $a$: $\\rho \\to L \\to a$\n- Path to $b$: $\\rho \\to L \\to L' \\to R_1 \\to b$\n- Path to $c$: $\\rho \\to L \\to L' \\to R_2 \\to c$\n- Path to $d$: $\\rho \\to M \\to d$\nThe Most Recent Common Ancestor (MRCA) of leaves $b$ and $c$ is a descendant of node $L'$. The MRCA of $a$ with the pair $(b,c)$ is node $L$. The MRCA of the clade $(a,b,c)$ with leaf $d$ is the root $\\rho$. After suppressing nodes of indegree $1$ and outdegree $1$, the resulting tree topology is $((a,(b,c)),d)$. This is not the target topology.\n\nCase 2: $b \\leftarrow L'$ and $c \\leftarrow M'$.\nThe probability of this joint event is $P_2 = \\gamma_1 (1-\\gamma_2)$.\nThe paths from the root $\\rho$ to the leaves are:\n- Path to $a$: $\\rho \\to L \\to a$\n- Path to $b$: $\\rho \\to L \\to L' \\to R_1 \\to b$\n- Path to $d$: $\\rho \\to M \\to d$\n- Path to $c$: $\\rho \\to M \\to M' \\to R_2 \\to c$\nAfter suppressing unifurcating nodes (such as $L'$, $M'$, $R_1$, $R_2$), the essential branching structure becomes:\n- The lineage to $a$ and the lineage to $b$ coalesce at node $L$. Thus, MRCA($a,b$) is $L$.\n- The lineage to $c$ and the lineage to $d$ coalesce at node $M$. Thus, MRCA($c,d$) is $M$.\nThe two clades, $(a,b)$ and $(c,d)$, coalesce at the root $\\rho$.\nThe resulting tree topology is $((a,b),(c,d))$. This matches the target topology $T$.\n\nCase 3: $b \\leftarrow M'$ and $c \\leftarrow L'$.\nThe probability of this joint event is $P_3 = (1-\\gamma_1) \\gamma_2$.\nThe paths from the root $\\rho$ to the leaves are:\n- Path to $a$: $\\rho \\to L \\to a$\n- Path to $c$: $\\rho \\to L \\to L' \\to R_2 \\to c$\n- Path to $d$: $\\rho \\to M \\to d$\n- Path to $b$: $\\rho \\to M \\to M' \\to R_1 \\to b$\nBy a similar analysis as in Case 2, MRCA($a,c$) is node $L$, and MRCA($b,d$) is node $M$. The resulting tree topology is $((a,c),(b,d))$. This is not the target topology.\n\nCase 4: $b \\leftarrow M'$ and $c \\leftarrow M'$.\nThe probability of this joint event is $P_4 = (1-\\gamma_1) (1-\\gamma_2)$.\nThe paths from the root $\\rho$ to the leaves are:\n- Path to $a$: $\\rho \\to L \\to a$\n- Path to $b$: $\\rho \\to M \\to M' \\to R_1 \\to b$\n- Path to $c$: $\\rho \\to M \\to M' \\to R_2 \\to c$\n- Path to $d$: $\\rho \\to M \\to d$\nThe MRCA of $b$ and $c$ is a descendant of node $M'$. The MRCA of the pair $(b,c)$ and leaf $d$ is node $M$. The MRCA of the clade $(b,c,d)$ and leaf $a$ is the root $\\rho$. The resulting tree topology is $(a,(d,(b,c)))$, which can also be written as $(a,((b,c),d))$. This is not the target topology.\n\nThe target topology $T = ((a,b),(c,d))$ is produced exclusively by Case 2. Therefore, the probability of observing topology $T$, denoted $P(T)$, is equal to the probability of Case 2.\n$$P(T) = P_2 = \\gamma_1 (1 - \\gamma_2)$$\nWe are given the numerical values for the inheritance probabilities: $\\gamma_1 = 0.73$ and $\\gamma_2 = 0.41$. Substituting these values into the expression for $P(T)$:\n$$P(T) = 0.73 \\times (1 - 0.41)$$\n$$P(T) = 0.73 \\times 0.59$$\nThe calculation is straightforward:\n$$P(T) = 0.4307$$\nThis result is an exact decimal as required.", "answer": "$$\\boxed{0.4307}$$", "id": "2743232"}, {"introduction": "A fundamental challenge in phylogenomics is distinguishing between gene tree discordance caused by incomplete lineage sorting (ILS) and that caused by reticulation (e.g., hybridization). The multispecies coalescent (MSC) model provides a theoretical baseline, making specific predictions about the expected frequencies of gene tree topologies due to ILS alone. This exercise guides you through a critical inference task: using quartet concordance factors—the proportion of genes supporting each of the three possible topologies for four taxa—to test whether the observed pattern of discordance is consistent with the MSC, or if an alternative model involving reticulation is required [@problem_id:2743287].", "problem": "Consider a single quartet of species with three possible unrooted gene tree topologies, denoted by the splits $(ab|cd)$, $(ac|bd)$, and $(ad|bc)$. Let the observed quartet concordance factors (the proportions of loci supporting each of the three resolved topologies) be $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$, which satisfy $q_{ab|cd} + q_{ac|bd} + q_{ad|bc} = 1$ and $q_{ij|kl} \\ge 0$ for all three topologies. Assume a large number of independent loci so that sampling noise can be neglected, and assume the Multi-Species Coalescent (MSC) model without gene flow, with an internal branch of length $x$ (in coalescent units) on the species tree. Under the MSC without reticulation, incomplete lineage sorting (ILS) is the only source of discordance from the dominant topology.\n\nStarting from first principles of the MSC (lineages coalesce within populations at rate $1$ per pair per coalescent unit; failure to coalesce on the internal branch passes lineages to the ancestral population where pairwise coalescences among three lineages are exchangeable), derive the necessary and sufficient constraints that the expected concordance factor triple must satisfy if discordance is due to ILS alone on some species tree topology and some internal branch length $x \\ge 0$. Use those constraints to test whether a given observed triple can be explained by ILS alone for the dominant topology (the topology with the largest coordinate of the triple).\n\nFor each option below, the triple is given in the order $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$. Select all options for which the deviation from the dominant topology can be fully explained by ILS alone under the MSC for some internal branch length $x \\ge 0$ (i.e., the triple lies in the MSC coalescent cone of its dominant topology).\n\nA. $\\left(\\dfrac{29}{50}, \\dfrac{21}{100}, \\dfrac{21}{100}\\right)$\n\nB. $\\left(\\dfrac{2}{5}, \\dfrac{3}{10}, \\dfrac{3}{10}\\right)$\n\nC. $\\left(\\dfrac{7}{10}, \\dfrac{1}{10}, \\dfrac{2}{10}\\right)$\n\nD. $\\left(\\dfrac{8}{25}, \\dfrac{17}{50}, \\dfrac{17}{50}\\right)$", "solution": "The problem requires the derivation of the constraints on quartet concordance factors $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$ under the Multi-Species Coalescent (MSC) model with incomplete lineage sorting (ILS) as the sole source of gene tree discordance. These constraints will then be used to evaluate the validity of four given concordance factor triples.\n\nLet us first derive the relationship between the expected concordance factors and the length of the internal branch of the species tree. Without loss of generality, assume the unrooted species tree topology is $((a,b),(c,d))$, which corresponds to the split $(ab|cd)$. Let the length of the internal branch separating the $(a,b)$ clade from the $(c,d)$ clade be $x$, measured in coalescent units. We are given to assume a large number of independent loci, so the observed concordance factors $q$ can be treated as the expected probabilities $p$ of each gene tree topology.\n\nLet $p_{ab|cd}$, $p_{ac|bd}$, and $p_{ad|bc}$ be the probabilities of observing the three possible unrooted gene tree topologies for the quartet. Under the MSC, the gene tree topology is determined by the sequence of coalescence events when tracing the four lineages, one from each species $\\{a,b,c,d\\}$, backwards in time.\n\nThe problem statement provides a crucial hint for the derivation: \"failure to coalesce on the internal branch passes lineages to the ancestral population where pairwise coalescences among three lineages are exchangeable\". This describes the standard model for a three-taxon tree, which we can adapt to the four-taxon case. Consider the species tree $((a,b),(c,d))$ and let us follow the lineages $l_a, l_b, l_c, l_d$ from the present backwards in time. Due to the assumption of a large number of loci drawn from a stationary process, we can conceptualize the process by first assuming that two of the lineages, for example $l_c$ and $l_d$, have already coalesced into a single ancestral lineage $L_{cd}$. Now, we consider the evolution of the three lineages $l_a, l_b,$ and $L_{cd}$ on the species tree $((a,b), (cd))$.\n\nThe lineages $l_a$ and $l_b$ enter their common ancestral population, which exists for a duration corresponding to the internal branch of length $x$ before merging with the population containing lineage $L_{cd}$.\n\nThe probability that the two lineages $l_a$ and $l_b$ coalesce within this branch of length $x$ is given by $P(\\text{coalesce}) = 1 - e^{-x}$. If this event occurs, the resulting gene tree will group $a$ and $b$ together first, yielding the topology $(ab|cd)$, which is concordant with the species tree.\n\nThe probability that $l_a$ and $l_b$ fail to coalesce on this internal branch is $P(\\text{no coalesce}) = e^{-x}$. In this scenario, three distinct lineages—$l_a$, $l_b$, and $L_{cd}$—enter the deeper ancestral population at the root of the three-taxon subtree. In this deep population, where the species tree is unresolved (a \"star\" phylogeny), any pair of lineages is equally likely to coalesce first. The three possible pairs are $(l_a, l_b)$, $(l_a, L_{cd})$, and $(l_b, L_{cd})$. Each pair has a probability of $\\dfrac{1}{3}$ of being the first to coalesce.\n\n*   If $(l_a, l_b)$ coalesce first, the gene tree topology is $(ab|cd)$. The probability of this path is $e^{-x} \\cdot \\dfrac{1}{3}$.\n*   If $(l_a, L_{cd})$ coalesce first, lineage $a$ is grouped with the ancestor of $c$ and $d$. The unrooted topology is $((a,(c,d)),b)$, which corresponds to the split $(ac|bd)$. The probability of this path is $e^{-x} \\cdot \\dfrac{1}{3}$.\n*   If $(l_b, L_{cd})$ coalesce first, lineage $b$ is grouped with the ancestor of $c$ and $d$. The unrooted topology is $((b,(c,d)),a)$, which corresponds to the split $(ad|bc)$. The probability of this path is $e^{-x} \\cdot \\dfrac{1}{3}$.\n\nSumming the probabilities for each topology:\nThe probability of the concordant topology $(ab|cd)$ is the sum of the probability of coalescence on the internal branch and the probability of the corresponding coalescence in the deep ancestral population:\n$$p_{ab|cd} = (1 - e^{-x}) + \\dfrac{1}{3}e^{-x} = 1 - \\dfrac{2}{3}e^{-x}$$\nThe probabilities of the two discordant topologies are:\n$$p_{ac|bd} = \\dfrac{1}{3}e^{-x}$$\n$$p_{ad|bc} = \\dfrac{1}{3}e^{-x}$$\n\nLet the observed concordance factors for the dominant topology be $q_1$, and for the two minor topologies be $q_2$ and $q_3$. For the data to be explainable by ILS alone on some species tree, the following necessary and sufficient conditions must be met:\n1.  The two minor (discordant) concordance factors must be equal: $q_2 = q_3$. This arises from the symmetry of the coalescent process in the deep ancestral population.\n2.  The branch length $x$ must be non-negative, $x \\ge 0$. The relationship $q_2 = \\dfrac{1}{3}e^{-x}$ implies $e^{-x} = 3q_2$. For $x \\ge 0$, we require $e^{-x} \\le 1$, which means $3q_2 \\le 1$, or $q_2 \\le \\dfrac{1}{3}$. Since $q_3 = q_2$, this also means $q_3 \\le \\dfrac{1}{3}$.\n\nThe condition $q_1+2q_2=1$ (since $q_2=q_3$ and $\\sum q_i=1$) is automatically satisfied if the first condition is met and the factors sum to $1$. The condition $q_1 \\ge 1/3$ is a direct consequence of $q_2 \\le 1/3$. Therefore, for a given triple where $q_1$ is the largest coordinate, the constraints reduce to:\n(i) The two smaller coordinates must be equal.\n(ii) The value of the smaller coordinates must not exceed $\\dfrac{1}{3}$.\n\nWe now test each option against these constraints.\n\n**A. $\\left(\\dfrac{29}{50}, \\dfrac{21}{100}, \\dfrac{21}{100}\\right)$**\nLet us write the coordinates as decimals: $(0.58, 0.21, 0.21)$.\nThe dominant topology is the first one, with $q_1 = 0.58$. The minor concordance factors are $q_2 = 0.21$ and $q_3 = 0.21$.\n1.  Check equality of minor factors: $q_2 = q_3$ ($0.21 = 0.21$). This condition is satisfied.\n2.  Check upper bound on minor factors: $q_2 = 0.21 \\le \\dfrac{1}{3} \\approx 0.333$. This condition is satisfied.\nBoth conditions are met. This triple can be explained by ILS alone on a species tree with topology $(ab|cd)$. The corresponding internal branch length would be $x = -\\ln(3q_2) = -\\ln(3 \\times 0.21) = -\\ln(0.63) \\ge 0$.\n**Verdict: Correct**\n\n**B. $\\left(\\dfrac{2}{5}, \\dfrac{3}{10}, \\dfrac{3}{10}\\right)$**\nLet us write the coordinates as decimals: $(0.4, 0.3, 0.3)$.\nThe dominant topology is the first one, with $q_1 = 0.4$. The minor concordance factors are $q_2 = 0.3$ and $q_3 = 0.3$.\n1.  Check equality of minor factors: $q_2 = q_3$ ($0.3 = 0.3$). This condition is satisfied.\n2.  Check upper bound on minor factors: $q_2 = 0.3 \\le \\dfrac{1}{3} \\approx 0.333$. This condition is satisfied.\nBoth conditions are met. This triple can be explained by ILS alone on a species tree with topology $(ab|cd)$. The corresponding internal branch length would be $x = -\\ln(3q_2) = -\\ln(3 \\times 0.3) = -\\ln(0.9) \\ge 0$.\n**Verdict: Correct**\n\n**C. $\\left(\\dfrac{7}{10}, \\dfrac{1}{10}, \\dfrac{2}{10}\\right)$**\nLet us write the coordinates as decimals: $(0.7, 0.1, 0.2)$.\nThe dominant topology is the first one, with $q_1 = 0.7$. The minor concordance factors are $q_2 = 0.1$ and $q_3 = 0.2$.\n1.  Check equality of minor factors: $q_2 \\ne q_3$ ($0.1 \\ne 0.2$). This condition is violated.\nThe asymmetry in the discordant topologies cannot be explained by ILS alone and suggests other evolutionary processes, such as reticulation.\n**Verdict: Incorrect**\n\n**D. $\\left(\\dfrac{8}{25}, \\dfrac{17}{50}, \\dfrac{17}{50}\\right)$**\nLet us write the coordinates as decimals: $(0.32, 0.34, 0.34)$.\nThe largest coordinate value is $0.34$, which corresponds to two topologies: $(ac|bd)$ and $(ad|bc)$. There is no unique dominant topology. The problem asks to evaluate consistency for the dominant topology. This case is ambiguous, but we can test each possibility.\nLet us assume the species tree corresponds to the topology $(ac|bd)$. Then the dominant concordance factor is $q_1' = q_{ac|bd} = 0.34$. The two minor factors must be the frequencies of the other two topologies, $(ab|cd)$ and $(ad|bc)$, which are $q_2' = 0.32$ and $q_3' = 0.34$.\n1.  Check equality of minor factors: $q_2' \\ne q_3'$ ($0.32 \\ne 0.34$). This condition is violated.\nThe same conclusion is reached if we assume the species tree is $(ad|bc)$.\nFurthermore, the two purportedly minor frequencies must be less than or equal to $\\dfrac{1}{3}$. Here, one or both of the non-dominant frequencies ($0.32$ and $0.34$) are candidates for being a discordant frequency. The value $0.34$ is greater than $\\dfrac{1}{3} \\approx 0.333$. A discordant gene tree topology cannot have a probability greater than $\\dfrac{1}{3}$ under the MSC model. This provides a second, independent reason for rejection.\nTherefore, this triple is inconsistent with the MSC/ILS model for any species tree topology.\n**Verdict: Incorrect**", "answer": "$$\\boxed{AB}$$", "id": "2743287"}]}