{"hands_on_practices": [{"introduction": "Before we can analyze the dynamics of the coalescent process, we must first establish its fundamental timescale. This exercise bridges the gap between a concrete biological scenario—a diploid population with different numbers of males and females—and the abstract parameter of effective population size, $N_e$. By deriving $N_e$ from first principles of Mendelian inheritance and random mating, you will solidify your understanding of how demographic realities are incorporated into the coalescent framework to set the rate of genetic drift and coalescence [@problem_id:2697186].", "problem": "Consider a closed, randomly mating, dioecious diploid population evolving under the classical Wright–Fisher (WF) model assumptions: discrete non-overlapping generations, constant numbers of breeders across generations, and no selection, mutation, or migration. There are $N_m$ breeding males and $N_f$ breeding females each generation. Each offspring has exactly one father and one mother, chosen uniformly at random from the $N_m$ males and $N_f$ females, respectively, and inherits one autosomal gene copy from each parent via Mendelian segregation.\n\nYou sample $2$ autosomal gene copies at the present (one from each of $2$ distinct diploid individuals). Using only first principles implied by the Wright–Fisher model and the diploid Mendelian transmission rules described above, do the following:\n\n1) Derive the per-generation probability that the two sampled lineages coalesce in the immediately preceding generation by explicitly decomposing the event into sex-specific contributions and accounting for Mendelian segregation within parents.\n\n2) Use your result to define an effective population size parameter $N_e$ for autosomes by matching to the canonical diploid coalescent scaling, and then express the expected time to the Most Recent Common Ancestor (MRCA) in generations for the two lineages in terms of $N_m$ and $N_f$.\n\n3) For $N_m = 37$, $N_f = 58$, and a generation time of $g = 26$ years, compute the expected time to the MRCA in years. Express the final time in years and round your answer to four significant figures.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It represents a standard derivation in theoretical population genetics. Thus, a solution is warranted.\n\nThe solution is presented in three parts as requested by the problem.\n\nStep 1: Derivation of the per-generation coalescence probability\n\nLet us consider two gene lineages, labeled $1$ and $2$, sampled from two distinct diploid individuals in the present generation. We seek to find the probability, $P_{coalesce}$, that these two lineages coalesce in the immediately preceding generation. Coalescence occurs if both lineages are copies of the very same ancestral gene copy in a single individual in the parent generation.\n\nThis process requires two conditions to be met simultaneously:\n1.  The two lineages must trace back to the same diploid parent individual.\n2.  Given they trace back to the same parent, they must be copies of the same one of the two gene copies within that diploid parent (due to Mendelian segregation).\n\nLet us analyze the event of tracing back to the same parent. A gene copy in any diploid offspring is inherited from its father with probability $1/2$ and from its mother with probability $1/2$. This follows from the principle of Mendelian segregation for autosomal genes. Tracing backward in time, any given lineage has a probability of $1/2$ of having originated from a male parent and a probability of $1/2$ of having originated from a female parent.\n\nThe population consists of $N_m$ breeding males and $N_f$ breeding females. The parents of each offspring are chosen uniformly and independently. Let's consider the origin of our two lineages, $1$ and $2$. There are two mutually exclusive paths for them to trace back to the same parental individual:\na) Both lineages originate from the same male parent.\nb) Both lineages originate from the same female parent.\n\nLet's calculate the probability for path (a).\nThe probability that lineage $1$ comes from a male is $1/2$. The probability that lineage $2$ comes from a male is also $1/2$. Thus, the probability that both lineages come from the male pool is $(1/2) \\times (1/2) = 1/4$.\nGiven that both lineages come from males, we need the probability that they come from the *same* male. Lineage $1$ comes from a specific male father. Since fathers are chosen uniformly at random from the $N_m$ available males, the probability that lineage $2$ comes from that same specific male is $1/N_m$.\nTherefore, the total probability of path (a) is:\n$P(\\text{same male parent}) = P(\\text{both from male pool}) \\times P(\\text{same male } | \\text{ both from male pool}) = \\frac{1}{4} \\times \\frac{1}{N_m} = \\frac{1}{4N_m}$.\n\nSimilarly, let's calculate the probability for path (b).\nThe probability that both lineages come from the female pool is $(1/2) \\times (1/2) = 1/4$.\nGiven this, the probability that they come from the same female is $1/N_f$, following the same logic as for males.\nTherefore, the total probability of path (b) is:\n$P(\\text{same female parent}) = \\frac{1}{4} \\times \\frac{1}{N_f} = \\frac{1}{4N_f}$.\n\nThe total probability that the two lineages trace back to the same parental individual is the sum of the probabilities of these two mutually exclusive events:\n$P(\\text{same parent}) = P(\\text{same male parent}) + P(\\text{same female parent}) = \\frac{1}{4N_m} + \\frac{1}{4N_f}$.\n\nNow, we must consider the second condition for coalescence: Mendelian segregation within the parent. Given that the two lineages trace to the same diploid parent, this parent has two copies of the gene. Each offspring gene copy is a random draw of one of these two copies. The probability that lineage $1$ is a copy of the parent's first gene copy is $1/2$. The probability that lineage $2$ is also a copy of that same first gene copy is $1/2$. So, the probability they are both copies of the first gene copy is $(1/2) \\times (1/2) = 1/4$. Similarly, the probability that both are copies of the parent's second gene copy is also $1/4$.\nThe probability that they are copies of the *same* ancestral gene copy is the sum of these two possibilities:\n$P(\\text{coalesce } | \\text{ same parent}) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$.\n\nFinally, the total probability of coalescence in one generation, $P_{coalesce}$, is the product of the probabilities of finding the same parent and of choosing the same gene copy from that parent:\n$P_{coalesce} = P(\\text{same parent}) \\times P(\\text{coalesce } | \\text{ same parent}) = \\left(\\frac{1}{4N_m} + \\frac{1}{4N_f}\\right) \\times \\frac{1}{2}$\n$P_{coalesce} = \\frac{1}{8N_m} + \\frac{1}{8N_f} = \\frac{1}{8}\\left(\\frac{1}{N_m} + \\frac{1}{N_f}\\right)$.\n\nStep 2: Effective population size and expected time to MRCA\n\nThe canonical Wright-Fisher model for a randomly mating monoecious diploid population of size $N$ has a coalescence probability of $p = 1/(2N)$. The effective population size, $N_e$, is defined as the size of an idealized population that would have the same rate of genetic drift (and thus the same coalescence probability) as the population under study. For a diploid organism, we match our derived probability to $1/(2N_e)$:\n$\\frac{1}{2N_e} = P_{coalesce} = \\frac{1}{8}\\left(\\frac{1}{N_m} + \\frac{1}{N_f}\\right)$.\n\nSolving for $N_e$:\n$\\frac{1}{N_e} = \\frac{2}{8}\\left(\\frac{1}{N_m} + \\frac{1}{N_f}\\right) = \\frac{1}{4}\\left(\\frac{N_f + N_m}{N_m N_f}\\right)$\n$N_e = \\frac{4 N_m N_f}{N_m + N_f}$.\n\nThe time to the most recent common ancestor (MRCA) for a pair of lineages, $T_{MRCA}$, is a random variable. The process of coalescence can be modeled as a series of Bernoulli trials, one per generation, with a \"success\" probability of $p = P_{coalesce}$. The number of generations until the first success (coalescence) follows a geometric distribution. The expected value of a geometric distribution with success probability $p$ is $1/p$.\nTherefore, the expected time to the MRCA, in generations, is:\n$E[T_{MRCA}] = \\frac{1}{P_{coalesce}} = \\frac{1}{\\frac{1}{2N_e}} = 2N_e$.\n\nSubstituting the expression for $N_e$ in terms of $N_m$ and $N_f$:\n$E[T_{MRCA}]_{\\text{gens}} = 2 \\left(\\frac{4 N_m N_f}{N_m + N_f}\\right) = \\frac{8 N_m N_f}{N_m + N_f}$.\n\nStep 3: Numerical calculation\n\nWe are given the following parameters:\nNumber of breeding males, $N_m = 37$.\nNumber of breeding females, $N_f = 58$.\nGeneration time, $g = 26$ years.\n\nFirst, we compute the expected time to the MRCA in generations using the formula derived in Step 2:\n$E[T_{MRCA}]_{\\text{gens}} = \\frac{8 \\times 37 \\times 58}{37 + 58} = \\frac{17168}{95} \\approx 180.7158 \\text{ generations}$.\n\nNext, we convert this time into years by multiplying by the generation time, $g$:\n$E[T_{MRCA}]_{\\text{years}} = E[T_{MRCA}]_{\\text{gens}} \\times g = \\frac{17168}{95} \\times 26 = \\frac{446368}{95} \\approx 4698.6105 \\text{ years}$.\n\nThe problem requires the final answer to be rounded to four significant figures. The calculated value is $4698.6105...$. The first four significant figures are $4$, $6$, $9$, and $8$. The fifth digit is $6$, which is greater than or equal to $5$, so we round up the fourth significant digit.\n$4698.6105... \\approx 4699$.\nThe expected time to the MRCA is approximately $4699$ years.", "answer": "$$\\boxed{4699}$$", "id": "2697186"}, {"introduction": "With the coalescent rate established, we can now explore the stochastic nature of genealogical history itself. This practice provides a hands-on derivation of the full probability distribution for the time to the most recent common ancestor ($T_{\\mathrm{MRCA}}$) for a small sample of three lineages. By applying the convolution integral to sum the independent exponential waiting times, you will see precisely how the Kingman coalescent model generates the hypoexponential distribution that governs the depth of recent genealogies [@problem_id:2697204].", "problem": "In the standard Kingman coalescent for a constant-size, panmictic population scaled in coalescent units, the waiting time until the next coalescent event when there are $k$ ancestral lineages is exponentially distributed with rate $\\lambda_{k}=\\binom{k}{2}$, and successive waiting times across epochs (as $k$ decreases by one at each coalescence) are independent. Consider a sample of size $n=3$. Let $T_{3}$ denote the waiting time to go from $k=3$ to $k=2$ lineages, and $T_{2}$ denote the waiting time to go from $k=2$ to $k=1$ lineage (the most recent common ancestor). The time to the most recent common ancestor (MRCA) is $T_{\\mathrm{MRCA}} = T_{3} + T_{2}$. Using only the fundamental definitions of the exponential distribution, independence, and the convolution of independent waiting times, derive the probability density function of $T_{\\mathrm{MRCA}}$ in closed form for this $n=3$ case, where $T_{3}\\sim \\mathrm{Exp}(\\lambda_{3})$ with $\\lambda_{3}=\\binom{3}{2}=3$ and $T_{2}\\sim \\mathrm{Exp}(\\lambda_{2})$ with $\\lambda_{2}=\\binom{2}{2}=1$. Provide the explicit analytic expression of the density $f_{T_{\\mathrm{MRCA}}}(t)$ as your final answer.", "solution": "The problem presented is a standard exercise in coalescent theory and the theory of probability. It is well-posed, scientifically sound, and contains all necessary information for a unique solution. We will proceed with the derivation as requested.\n\nThe problem asks for the probability density function (PDF) of the total time to the most recent common ancestor, $T_{\\mathrm{MRCA}}$, for a sample of size $n=3$ in a standard Kingman coalescent model. This total time is the sum of two independent waiting times: $T_{\\mathrm{MRCA}} = T_{3} + T_{2}$.\n\nAccording to the problem statement, the waiting times are independent and follow exponential distributions.\nThe time $T_{3}$ to go from $k=3$ to $k=2$ lineages is an exponential random variable with rate parameter $\\lambda_{3} = \\binom{3}{2} = 3$. Its PDF, $f_{T_{3}}(t)$, is given by:\n$$f_{T_{3}}(t) = \\begin{cases} \\lambda_{3}\\exp(-\\lambda_{3}t) = 3\\exp(-3t) & \\text{for } t \\geq 0 \\\\ 0 & \\text{for } t < 0 \\end{cases}$$\n\nThe time $T_{2}$ to go from $k=2$ to $k=1$ lineage is an exponential random variable with rate parameter $\\lambda_{2} = \\binom{2}{2} = 1$. Its PDF, $f_{T_{2}}(t)$, is given by:\n$$f_{T_{2}}(t) = \\begin{cases} \\lambda_{2}\\exp(-\\lambda_{2}t) = \\exp(-t) & \\text{for } t \\geq 0 \\\\ 0 & \\text{for } t < 0 \\end{cases}$$\n\nSince $T_{3}$ and $T_{2}$ are independent random variables, the PDF of their sum, $T_{\\mathrm{MRCA}} = T_{3} + T_{2}$, is found by the convolution of their individual PDFs. The general formula for the convolution of two PDFs, $f_{X}(x)$ and $f_{Y}(y)$, is:\n$$f_{X+Y}(t) = (f_{X} * f_{Y})(t) = \\int_{-\\infty}^{\\infty} f_{X}(\\tau) f_{Y}(t - \\tau) \\, d\\tau$$\n\nApplying this to our specific random variables, $T_{3}$ and $T_{2}$, we have:\n$$f_{T_{\\mathrm{MRCA}}}(t) = \\int_{-\\infty}^{\\infty} f_{T_{3}}(\\tau) f_{T_{2}}(t - \\tau) \\, d\\tau$$\n\nThe integrand, $f_{T_{3}}(\\tau) f_{T_{2}}(t - \\tau)$, is non-zero only when both arguments of the functions are non-negative. This requires $\\tau \\geq 0$ and $t - \\tau \\geq 0$, which implies $0 \\leq \\tau \\leq t$. Therefore, for any $t < 0$, the integral is zero. For $t \\geq 0$, the limits of integration become $0$ to $t$:\n$$f_{T_{\\mathrm{MRCA}}}(t) = \\int_{0}^{t} \\left( 3\\exp(-3\\tau) \\right) \\left( \\exp(-(t - \\tau)) \\right) \\, d\\tau$$\n\nWe now solve this integral. The term $\\exp(-t)$ is a constant with respect to the integration variable $\\tau$ and can be moved outside the integral:\n$$f_{T_{\\mathrm{MRCA}}}(t) = 3\\exp(-t) \\int_{0}^{t} \\exp(-3\\tau) \\exp(\\tau) \\, d\\tau$$\n$$f_{T_{\\mathrm{MRCA}}}(t) = 3\\exp(-t) \\int_{0}^{t} \\exp(-2\\tau) \\, d\\tau$$\n\nThe integral of $\\exp(-2\\tau)$ is straightforward:\n$$\\int \\exp(-2\\tau) \\, d\\tau = -\\frac{1}{2}\\exp(-2\\tau)$$\n\nEvaluating the definite integral from $\\tau=0$ to $\\tau=t$:\n$$\\int_{0}^{t} \\exp(-2\\tau) \\, d\\tau = \\left[ -\\frac{1}{2}\\exp(-2\\tau) \\right]_{0}^{t} = \\left(-\\frac{1}{2}\\exp(-2t)\\right) - \\left(-\\frac{1}{2}\\exp(0)\\right) = \\frac{1}{2} - \\frac{1}{2}\\exp(-2t)$$\n\nSubstituting this result back into the expression for $f_{T_{\\mathrm{MRCA}}}(t)$:\n$$f_{T_{\\mathrm{MRCA}}}(t) = 3\\exp(-t) \\left( \\frac{1}{2} - \\frac{1}{2}\\exp(-2t) \\right)$$\n\nDistributing the terms yields the final closed-form expression for the PDF:\n$$f_{T_{\\mathrm{MRCA}}}(t) = \\frac{3}{2}\\exp(-t) - \\frac{3}{2}\\exp(-t)\\exp(-2t) = \\frac{3}{2}(\\exp(-t) - \\exp(-3t))$$\n\nThis is the probability density function for the time to the most recent common ancestor for $t \\geq 0$. For $t < 0$, the density is $0$. This result corresponds to the PDF of a hypoexponential distribution with two stages having distinct rates $\\lambda_{3}=3$ and $\\lambda_{2}=1$. The derivation is complete and rigorously follows from first principles as required.", "answer": "$$\\boxed{\\frac{3}{2}(\\exp(-t) - \\exp(-3t))}$$", "id": "2697204"}, {"introduction": "Understanding the expected value of a random variable is only part of the story; its variance reveals the extent of its stochasticity. This practice moves from a specific case to a general property of the coalescent process by deriving an exact expression for the variance of $T_{\\mathrm{MRCA}}$ for any sample size $n$. Successfully completing this derivation demonstrates a deeper command of the properties of the coalescent and requires facility with the kind of series manipulations that are essential for advanced work in theoretical population genetics [@problem_id:2697211].", "problem": "Consider a constant-size panmictic population evolving under the standard Kingman coalescent, and measure time in coalescent units so that the per-pair coalescence rate is $1$. Let $n \\ge 2$ be the sample size, and let $T_{\\mathrm{MRCA}}$ denote the time to the most recent common ancestor (MRCA). In the Kingman coalescent, when there are $k$ ancestral lineages, the waiting time to the next coalescent event is exponentially distributed with rate $\\binom{k}{2}$, and successive waiting times are independent due to the Markov and memoryless properties.\n\nStarting strictly from these fundamental properties, derive an exact closed-form expression for $\\mathrm{Var}\\!\\left(T_{\\mathrm{MRCA}}\\right)$ as a function of $n$. Your derivation must proceed from first principles in the coalescent setup and may use canonical special functions where natural (for example, generalized harmonic numbers). Simplify the resulting finite sum as far as possible to obtain a compact analytic expression in $n$. The final answer must be a single closed-form analytic expression.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a standard, well-posed problem in mathematical population genetics, based on the fundamental principles of the Kingman coalescent model. The problem is scientifically grounded, objective, and contains all necessary information for derivation of a unique solution. We may proceed.\n\nThe time to the most recent common ancestor, $T_{\\mathrm{MRCA}}$, for a sample of size $n$ is the sum of the waiting times for each coalescent event, from $n$ lineages down to $2$. Let $W_k$ be the waiting time for the number of ancestral lineages to decrease from $k$ to $k-1$. The total time to coalescence is then:\n$$\nT_{\\mathrm{MRCA}} = \\sum_{k=2}^{n} W_k\n$$\nAccording to the problem statement, which specifies the standard Kingman coalescent model, the waiting time $W_k$ is an exponentially distributed random variable with rate $\\lambda_k = \\binom{k}{2}$. The rate is given in coalescent time units.\n$$\nW_k \\sim \\mathrm{Exp}\\left(\\lambda_k\\right) \\quad \\text{where} \\quad \\lambda_k = \\binom{k}{2} = \\frac{k(k-1)}{2}\n$$\nThe variance of an exponential random variable $X \\sim \\mathrm{Exp}(\\lambda)$ is $\\mathrm{Var}(X) = \\frac{1}{\\lambda^2}$. Therefore, the variance of the waiting time $W_k$ is:\n$$\n\\mathrm{Var}(W_k) = \\frac{1}{\\lambda_k^2} = \\frac{1}{\\left(\\binom{k}{2}\\right)^2} = \\frac{1}{\\left(\\frac{k(k-1)}{2}\\right)^2} = \\frac{4}{k^2(k-1)^2}\n$$\nThe problem states that successive waiting times are independent. For a sum of independent random variables, the variance of the sum is the sum of the variances. Thus, the variance of $T_{\\mathrm{MRCA}}$ is:\n$$\n\\mathrm{Var}(T_{\\mathrm{MRCA}}) = \\mathrm{Var}\\left(\\sum_{k=2}^{n} W_k\\right) = \\sum_{k=2}^{n} \\mathrm{Var}(W_k)\n$$\nSubstituting the expression for $\\mathrm{Var}(W_k)$, we obtain the following sum:\n$$\n\\mathrm{Var}(T_{\\mathrm{MRCA}}) = \\sum_{k=2}^{n} \\frac{4}{k^2(k-1)^2} = 4 \\sum_{k=2}^{n} \\frac{1}{k^2(k-1)^2}\n$$\nTo evaluate this sum, we perform a partial fraction decomposition of the summand. We recognize that $\\frac{1}{k(k-1)} = \\frac{1}{k-1} - \\frac{1}{k}$. Squaring this identity yields:\n$$\n\\frac{1}{k^2(k-1)^2} = \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)^2 = \\frac{1}{(k-1)^2} - \\frac{2}{k(k-1)} + \\frac{1}{k^2}\n$$\nApplying the partial fraction identity again to the middle term:\n$$\n\\frac{1}{k^2(k-1)^2} = \\frac{1}{(k-1)^2} + \\frac{1}{k^2} - 2\\left(\\frac{1}{k-1} - \\frac{1}{k}\\right) = \\frac{1}{(k-1)^2} + \\frac{1}{k^2} - \\frac{2}{k-1} + \\frac{2}{k}\n$$\nNow, we can evaluate the sum of this expression from $k=2$ to $n$:\n$$\n\\sum_{k=2}^{n} \\frac{1}{k^2(k-1)^2} = \\sum_{k=2}^{n} \\left( \\frac{1}{(k-1)^2} + \\frac{1}{k^2} - \\frac{2}{k-1} + \\frac{2}{k} \\right)\n$$\nWe can separate this into two parts: a sum over the squared terms and a sum over the linear terms.\nThe sum of the linear terms is a telescoping series:\n$$\n\\sum_{k=2}^{n} \\left(\\frac{2}{k} - \\frac{2}{k-1}\\right) = -2 \\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right) = -2 \\left[ \\left(\\frac{1}{1} - \\frac{1}{2}\\right) + \\left(\\frac{1}{2} - \\frac{1}{3}\\right) + \\dots + \\left(\\frac{1}{n-1} - \\frac{1}{n}\\right) \\right] = -2 \\left(1 - \\frac{1}{n}\\right)\n$$\nThe sum of the squared terms is:\n$$\n\\sum_{k=2}^{n} \\left(\\frac{1}{(k-1)^2} + \\frac{1}{k^2}\\right) = \\sum_{k=2}^{n} \\frac{1}{(k-1)^2} + \\sum_{k=2}^{n} \\frac{1}{k^2}\n$$\nLet us re-index the first sum with $j=k-1$:\n$$\n\\left(\\sum_{j=1}^{n-1} \\frac{1}{j^2}\\right) + \\left(\\sum_{k=2}^{n} \\frac{1}{k^2}\\right)\n$$\nThis can be expressed using the generalized harmonic number of order $2$, defined as $H_n^{(2)} = \\sum_{i=1}^{n} \\frac{1}{i^2}$:\n$$\nH_{n-1}^{(2)} + (H_n^{(2)} - 1)\n$$\nUsing the identity $H_{n-1}^{(2)} = H_n^{(2)} - \\frac{1}{n^2}$, the sum of squared terms becomes:\n$$\n\\left(H_n^{(2)} - \\frac{1}{n^2}\\right) + (H_n^{(2)} - 1) = 2H_n^{(2)} - 1 - \\frac{1}{n^2}\n$$\nCombining both parts, the total sum is:\n$$\n\\sum_{k=2}^{n} \\frac{1}{k^2(k-1)^2} = \\left(2H_n^{(2)} - 1 - \\frac{1}{n^2}\\right) - 2\\left(1 - \\frac{1}{n}\\right) = 2H_n^{(2)} - 1 - \\frac{1}{n^2} - 2 + \\frac{2}{n} = 2H_n^{(2)} - 3 + \\frac{2}{n} - \\frac{1}{n^2}\n$$\nFinally, we multiply by the factor of $4$ to obtain the variance:\n$$\n\\mathrm{Var}(T_{\\mathrm{MRCA}}) = 4 \\left( 2H_n^{(2)} - 3 + \\frac{2}{n} - \\frac{1}{n^2} \\right)\n$$\nFor a more compact representation, we combine the terms involving $n$:\n$$\n\\mathrm{Var}(T_{\\mathrm{MRCA}}) = 4 \\left( 2H_n^{(2)} - 3 + \\frac{2n-1}{n^2} \\right)\n$$\nThis is the final, exact closed-form expression for the variance of the time to the most recent common ancestor as a function of the sample size $n$.", "answer": "$$\n\\boxed{4\\left(2H_n^{(2)} - 3 + \\frac{2n-1}{n^2}\\right)}\n$$", "id": "2697211"}]}