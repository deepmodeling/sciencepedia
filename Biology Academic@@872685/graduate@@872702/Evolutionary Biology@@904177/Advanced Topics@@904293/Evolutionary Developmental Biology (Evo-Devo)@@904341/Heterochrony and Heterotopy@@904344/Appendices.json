{"hands_on_practices": [{"introduction": "To rigorously analyze heterochrony, we must translate its verbal concepts into a quantitative framework. This first practice introduces a simple linear growth model to formalize two classic paedomorphic processes: progenesis and neoteny. By deriving their effects on adult morphology, you will build a foundational understanding of how changes in developmental rate versus duration can be mathematically distinguished and compared [@problem_id:2722168].", "problem": "A morphometric trait in a clade is modeled during ontogeny by linear growth initiated at an onset age $t_0$ with initial value $y_0$ and constant growth rate $r$, such that for $t \\in [t_0, t_1]$ the trait follows $y(t) = y_0 + r(t - t_0)$ and growth ceases at the offset age $t_1$ (i.e., for $t \\ge t_1$, $y(t) = y(t_1)$). In the language of heterochrony, progenesis is a shift that advances maturation (earlier offset), while neoteny is a shift that reduces the rate of development without changing the onset or the offset schedule. Assume two alternative evolutionary modifications of this lineage from a common baseline defined by $(y_0, r, t_0, t_1)$ with $t_1 > t_0$ and $r > 0$:\n\n- Progenesis: the offset is advanced by an amount $\\Delta t_1$ with $0 < \\Delta t_1 < t_1 - t_0$, so that the new offset is $t_1' = t_1 - \\Delta t_1$ while $r$ is unchanged.\n- Neoteny: the growth rate is reduced by an amount $\\Delta r$ with $0 < \\Delta r < r$, so that the new rate is $r' = r - \\Delta r$ while the offset remains $t_1$.\n\nLet the adult value be the plateau value at the cessation of growth, and denote the baseline adult value by $y_{\\mathrm{adult}}$, the progenetic adult value by $y_{\\mathrm{prog}}$, and the neotenic adult value by $y_{\\mathrm{neo}}$. To compare magnitudes of heterochronic effects on the adult phenotype across these two mechanisms, define the effect size for any variant as the signed proportional change in the adult value relative to the baseline adult increment, where the baseline adult increment is the difference between the baseline adult value and $y_0$.\n\nStarting only from the linear growth model and these definitions, and treating all symbols $(y_0, r, t_0, t_1, \\Delta t_1, \\Delta r)$ as parameters, do the following:\n\n- Derive expressions for $y_{\\mathrm{adult}}$, $y_{\\mathrm{prog}}$, and $y_{\\mathrm{neo}}$.\n- Derive expressions for the effect sizes of progenesis and neoteny as functions of $(t_0, t_1, r, \\Delta t_1, \\Delta r)$.\n- Determine the unique value $\\Delta r_{\\mathrm{eq}}$ as a closed-form analytic expression in $(t_0, t_1, r, \\Delta t_1)$ that makes the absolute magnitudes of the progenetic and neotenic effect sizes exactly equal.\n\nProvide your final answer as the single closed-form expression for $\\Delta r_{\\mathrm{eq}}$. No numerical substitution is required, and no rounding is requested. Express the final answer without units.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- **Growth Model:** For a morphometric trait $y(t)$ during ontogeny from onset age $t_0$ to offset age $t_1$, the growth is linear: $y(t) = y_0 + r(t - t_0)$ for $t \\in [t_0, t_1]$.\n- **Growth Cessation:** For $t \\ge t_1$, growth ceases and the trait value is constant: $y(t) = y(t_1)$.\n- **Baseline Parameters:** The baseline lineage is defined by the set of parameters $(y_0, r, t_0, t_1)$.\n- **Parameter Constraints:** $t_1 > t_0$ and $r > 0$.\n- **Progenesis Modification:** The offset age is shifted to $t_1' = t_1 - \\Delta t_1$, with the growth rate $r$ unchanged. The constraint is $0 < \\Delta t_1 < t_1 - t_0$.\n- **Neoteny Modification:** The growth rate is reduced to $r' = r - \\Delta r$, with the offset age $t_1$ unchanged. The constraint is $0 < \\Delta r < r$.\n- **Adult Value Definition:** The adult value is the plateau value reached at the cessation of growth. These are denoted $y_{\\mathrm{adult}}$ (baseline), $y_{\\mathrm{prog}}$ (progenesis), and $y_{\\mathrm{neo}}$ (neoteny).\n- **Effect Size Definition:** The effect size of a modification is the \"signed proportional change in the adult value relative to the baseline adult increment.\"\n- **Baseline Adult Increment Definition:** The baseline adult increment is the difference between the baseline adult value and the initial value $y_0$.\n- **Task:** Derive expressions for the adult values and effect sizes, and determine the specific value $\\Delta r_{\\mathrm{eq}}$ that equates the absolute magnitudes of the progenetic and neotenic effect sizes.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded within the theoretical framework of evolutionary developmental biology. It uses a simplified linear model, which is a common and acceptable tool for formalizing biological concepts like heterochrony. The definitions of progenesis and neoteny are consistent with their established meanings in this field. The problem is well-posed, objective, and self-contained; all necessary parameters, definitions, and constraints are provided to specify a unique mathematical task. The problem requires a multi-step derivation based on these definitions, which is non-trivial and requires careful algebraic manipulation. There are no contradictions, ambiguities, or factual inaccuracies.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\nThe derivation proceeds as follows.\n\nFirst, we determine the adult values for the baseline, progenetic, and neotenic cases based on the provided linear growth model. The adult value is the trait value at the offset of growth.\n\nThe baseline adult value, $y_{\\mathrm{adult}}$, is the value of the trait at time $t_1$:\n$$y_{\\mathrm{adult}} = y(t_1) = y_0 + r(t_1 - t_0)$$\n\nThe progenetic adult value, $y_{\\mathrm{prog}}$, results from an earlier offset time $t_1' = t_1 - \\Delta t_1$. The growth rate $r$ and onset parameters $(y_0, t_0)$ are unchanged:\n$$y_{\\mathrm{prog}} = y(t_1') = y_0 + r(t_1' - t_0) = y_0 + r(t_1 - \\Delta t_1 - t_0)$$\n\nThe neotenic adult value, $y_{\\mathrm{neo}}$, results from a reduced growth rate $r' = r - \\Delta r$. The timing parameters $(t_0, t_1)$ are unchanged:\n$$y_{\\mathrm{neo}} = y_0 + r'(t_1 - t_0) = y_0 + (r - \\Delta r)(t_1 - t_0)$$\n\nNext, we derive the expressions for the effect sizes. The effect size, $E$, is defined as the signed proportional change in the adult value relative to the baseline adult increment. The baseline adult increment, which we denote as $I_{\\mathrm{adult}}$, is $y_{\\mathrm{adult}} - y_0$.\n$$I_{\\mathrm{adult}} = y_{\\mathrm{adult}} - y_0 = \\left(y_0 + r(t_1 - t_0)\\right) - y_0 = r(t_1 - t_0)$$\nThe formula for the effect size of a given modification with new adult value $y_{\\mathrm{new}}$ is:\n$$E = \\frac{y_{\\mathrm{new}} - y_{\\mathrm{adult}}}{I_{\\mathrm{adult}}}$$\n\nWe now calculate the effect size for progenesis, $E_{\\mathrm{prog}}$. The change in adult value is:\n$$y_{\\mathrm{prog}} - y_{\\mathrm{adult}} = \\left(y_0 + r(t_1 - \\Delta t_1 - t_0)\\right) - \\left(y_0 + r(t_1 - t_0)\\right) = r(t_1 - \\Delta t_1 - t_0 - t_1 + t_0) = -r \\Delta t_1$$\nThe effect size for progenesis is therefore:\n$$E_{\\mathrm{prog}} = \\frac{-r \\Delta t_1}{r(t_1 - t_0)} = -\\frac{\\Delta t_1}{t_1 - t_0}$$\nThis result is negative, which is consistent with progenesis truncating the growth period and leading to paedomorphosis (a smaller adult phenotype).\n\nSimilarly, we calculate the effect size for neoteny, $E_{\\mathrm{neo}}$. The change in adult value is:\n$$y_{\\mathrm{neo}} - y_{\\mathrm{adult}} = \\left(y_0 + (r - \\Delta r)(t_1 - t_0)\\right) - \\left(y_0 + r(t_1 - t_0)\\right) = (r - \\Delta r - r)(t_1 - t_0) = -\\Delta r (t_1 - t_0)$$\nThe effect size for neoteny is therefore:\n$$E_{\\mathrm{neo}} = \\frac{-\\Delta r (t_1 - t_0)}{r(t_1 - t_0)} = -\\frac{\\Delta r}{r}$$\nThis result is also negative, which is consistent with neoteny reducing the rate of development and leading to paedomorphosis.\n\nFinally, we must find the value $\\Delta r_{\\mathrm{eq}}$ such that the absolute magnitudes of the two effect sizes are equal. The condition is $|E_{\\mathrm{prog}}| = |E_{\\mathrm{neo}}|$.\n$$|E_{\\mathrm{prog}}| = \\left|-\\frac{\\Delta t_1}{t_1 - t_0}\\right|$$\n$$|E_{\\mathrm{neo}}| = \\left|-\\frac{\\Delta r}{r}\\right|$$\nGiven the constraints $t_1 > t_0$, $\\Delta t_1 > 0$, $r > 0$, and $\\Delta r > 0$, both expressions inside the absolute value are negative. Thus, we can write:\n$$|E_{\\mathrm{prog}}| = \\frac{\\Delta t_1}{t_1 - t_0}$$\n$$|E_{\\mathrm{neo}}| = \\frac{\\Delta r}{r}$$\nWe set these equal and substitute $\\Delta r_{\\mathrm{eq}}$ for $\\Delta r$:\n$$\\frac{\\Delta r_{\\mathrm{eq}}}{r} = \\frac{\\Delta t_1}{t_1 - t_0}$$\nSolving this equation for $\\Delta r_{\\mathrm{eq}}$ yields the unique closed-form expression:\n$$\\Delta r_{\\mathrm{eq}} = r \\frac{\\Delta t_1}{t_1 - t_0}$$\nThis expression gives the change in growth rate, $\\Delta r_{\\mathrm{eq}}$, that produces a neotenic effect of the same magnitude as a progenetic effect caused by a change in offset time of $\\Delta t_1$.", "answer": "$$\\boxed{r \\frac{\\Delta t_1}{t_1 - t_0}}$$", "id": "2722168"}, {"introduction": "Evolutionary change occurs not only in the timing of development but also in its spatial organization. This exercise explores heterotopy, the evolutionary change in the location of a developmental process, using the classic example of vertebrate limb patterning [@problem_id:2722088]. You will quantify a spatial shift in *HoxD13* gene expression between two species and connect this molecular-level change to differences in adult limb morphology, a crucial skill in modern evolutionary developmental biology.", "problem": "A comparative study of limb development investigates the spatial heterotopy of distal Homeobox D13 (HoxD13) expression along the proximal–distal axis of the forelimb bud in two taxa, denoted species $A$ and species $B$. Let the proximal–distal axis be parameterized by a coordinate $s$ with $s=0$ at the proximal base and $s=L$ at the distal tip, where $L$ is the total limb bud length at a homologous developmental stage established by transcriptomic staging. The posterior HoxD13 expression domain in the forelimb bud is distal, occupying $s \\ge s^{\\ast}$, where $s^{\\ast}$ is the measured boundary position for the onset of HoxD13 expression along the proximal–distal axis.\n\nYou are given the following measurements:\n- Species $A$: total limb bud length $L_{A} = 1.80$ millimeters and HoxD13 boundary position $s_{A}^{\\ast} = 1.26$ millimeters.\n- Species $B$: total limb bud length $L_{B} = 2.50$ millimeters and HoxD13 boundary position $s_{B}^{\\ast} = 1.50$ millimeters.\n\nTo compare boundary positions across species with different limb bud sizes, define the dimensionless boundary position $p = s^{\\ast}/L$ for each species, and then map the interspecific difference back onto a standardized limb of length $L_{\\mathrm{std}}$ by the displacement\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}},\n$$\nwith the sign convention that $\\Delta x_{\\mathrm{std}} > 0$ indicates a more distal boundary in species $B$ relative to species $A$.\n\nAdditionally, for evolutionary interpretation under a morphogen-threshold model of patterning (French flag model), the distal autopod proportion in the adult, denoted $R$, is observed to be $R_{A} = 0.31$ for species $A$ and $R_{B} = 0.42$ for species $B$. Assume only general principles: the HoxD13-positive distal domain corresponds to the prospective autopod territory and, under first-order approximation near these stages, the adult autopod proportion $R$ increases monotonically with the fractional extent of the HoxD13-positive domain along the proximal–distal axis.\n\nTask:\n- Compute the signed standardized displacement $\\Delta x_{\\mathrm{std}}$ using $L_{\\mathrm{std}} = 2.00$ millimeters. Express your answer in millimeters and round your answer to three significant figures.\n\nNote: You should base your reasoning on core definitions (dimensionless normalization, mapping across scales) and widely accepted facts of morphogen-threshold patterning without invoking any unprovided shortcut formulas. The final reported value must be a single real number.", "solution": "We begin by clarifying the coordinate system and definitions. For each species, the proximal–distal axis is represented by $s \\in [0,L]$, where $L$ is the limb bud length at the staged time point. The HoxD13-expressing domain occupies $s \\ge s^{\\ast}$, with $s^{\\ast}$ denoting the boundary location of the onset of expression. To compare boundary positions across species with different limb bud sizes, we first non-dimensionalize the boundary position by forming the fraction\n$$\np \\equiv \\frac{s^{\\ast}}{L}.\n$$\nThis step removes the influence of absolute size, retaining only the relative position along the limb. The spatial heterotopic displacement on a standardized limb of length $L_{\\mathrm{std}}$ is then defined as\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}},\n$$\nwith $\\Delta x_{\\mathrm{std}} > 0$ meaning species $B$ has a more distal (larger $s^{\\ast}$ relative to $L$) HoxD13 boundary compared to species $A$.\n\nCompute $p_{A}$ and $p_{B}$ from the given data:\n- For species $A$, $L_{A} = 1.80$ millimeters and $s_{A}^{\\ast} = 1.26$ millimeters. Therefore,\n$$\np_{A} = \\frac{s_{A}^{\\ast}}{L_{A}} = \\frac{1.26}{1.80} = 0.70.\n$$\n- For species $B$, $L_{B} = 2.50$ millimeters and $s_{B}^{\\ast} = 1.50$ millimeters. Therefore,\n$$\np_{B} = \\frac{s_{B}^{\\ast}}{L_{B}} = \\frac{1.50}{2.50} = 0.60.\n$$\n\nNow compute the standardized displacement using $L_{\\mathrm{std}} = 2.00$ millimeters:\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}} = \\left(0.60 - 0.70\\right) \\times 2.00 = (-0.10) \\times 2.00 = -0.20 \\text{ millimeters}.\n$$\n\nInterpretation in the context of heterotopy and morphological differences: Under the morphogen-threshold (French flag) model, a boundary at $s^{\\ast}$ demarcates the distal domain fate. The length of the HoxD13-positive domain is $L - s^{\\ast}$, so the distal (autopod) proportion is\n$$\nR = \\frac{L - s^{\\ast}}{L} = 1 - \\frac{s^{\\ast}}{L} = 1 - p.\n$$\nThis general relationship follows directly from the definition of $R$ as the fraction of the limb corresponding to the HoxD13-positive domain. Consequently, a decrease in $p$ implies an increase in $R$. In the measured data, $p_{B} - p_{A} = -0.10 < 0$, so we expect $R_{B} - R_{A} > 0$. The observed adult values $R_{A} = 0.31$ and $R_{B} = 0.42$ are consistent with this prediction, indicating that the proximal shift of the HoxD13 boundary in species $B$ is associated with an increased autopod proportion, as expected for a heterotopic change affecting distal limb morphology.\n\nFinally, we report the requested signed standardized displacement. Rounding $-0.20$ millimeters to three significant figures yields $-0.200$ millimeters.", "answer": "$$\\boxed{-0.200}$$", "id": "2722088"}, {"introduction": "In practice, different evolutionary processes can produce similar outcomes, and a key task for biologists is to determine the most likely underlying mechanism. This final practice places you in the role of a researcher evaluating competing hypotheses for the evolution of the bat wing, a classic case of peramorphosis [@problem_id:2722110]. Using a dataset, you will apply statistical model selection to decide whether a change in cellular proliferation rate or an extension of the growth period better explains the dramatic elongation of bat digits.", "problem": "Consider modeling peramorphic digit elongation under heterochrony using a minimal proliferative growth framework grounded in exponential cell population dynamics. Assume the proliferative cell population in the growth zone follows the ordinary differential equation $dN/dt = r N$, where $N$ is cell number and $r$ is the per-capita proliferation rate. If digit length $L$ at time $t$ is proportional to $N(t)$ through a constant of proportionality $k$ that is specific to a given digit bud, then $L(t) = k N_{0} e^{r t}$, where $N_{0}$ is the initial cell number at the onset of the elongation phase. For a focal digit $i$ in a reference species (mouse), let the mouse parameters be $r_{i}$ (in $\\text{day}^{-1}$), $T_{i}$ (in $\\text{days}$), and observed final length $L^{\\mathrm{mouse}}_{i}$ (in $\\text{mm}$). For a derived species (bat), the peramorphic length $L^{\\mathrm{bat}}_{i}$ (in $\\text{mm}$) is observed for the same digit $i$.\n\nTwo competing heterochronic hypotheses are to be evaluated across digits $i$:\n- Rate-shift model: $r^{\\mathrm{bat}}_{i} = \\alpha\\, r^{\\mathrm{mouse}}_{i}$ with a single rate multiplier $\\alpha \\geq 1$ and the same duration $T_{i}$.\n- Duration-shift model: $T^{\\mathrm{bat}}_{i} = T^{\\mathrm{mouse}}_{i} + \\Delta t$ with a single extension $\\Delta t \\geq 0$ (in $\\text{days}$) and the same rate $r_{i}$.\n\nUnder the proportionality assumption, the ratio $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ satisfies $\\ln R_{i} = (\\alpha - 1)\\, r_{i} T_{i}$ for the rate-shift model and $\\ln R_{i} = r_{i} \\Delta t$ for the duration-shift model. Given observed pairs $\\{L^{\\mathrm{mouse}}_{i}, L^{\\mathrm{bat}}_{i}\\}$ and known $\\{r_{i}, T_{i}\\}$, fit each model by Least Squares (LS) in log space to obtain $\\alpha$ and $\\Delta t$ that minimize the sum of squared residuals in $\\ln R_{i}$. Constrain $\\alpha \\geq 1$ and $\\Delta t \\geq 0$ by projecting the unconstrained LS estimates onto these domains.\n\nYour task is to write a program that, for each test case, decides which model better explains the observed peramorphic lengths by comparing the log-space sum of squared errors. If the absolute difference in the sums of squared errors is less than or equal to a tolerance $\\tau = 10^{-8}$, declare a tie.\n\nUse the following units: $L$ in $\\text{mm}$, $r$ in $\\text{day}^{-1}$, and $t$ and $T$ in $\\text{days}$. Angles are not involved. All outputs are unitless decision codes.\n\nFor each test case, you are given arrays for digits $2$ through $5$: mouse lengths $L^{\\mathrm{mouse}}_{i}$, mouse rates $r_{i}$, mouse durations $T_{i}$, and bat lengths $L^{\\mathrm{bat}}_{i}$. The test suite is:\n\n- Test case $1$ (rate-shift generated, distinct $T_{i}$):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,25.324,\\,29.240,\\,24.900,\\,28.404\\,]$ $\\text{mm}$\n\n- Test case $2$ (duration-shift generated, distinct $r_{i}$):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,19.921,\\,21.030,\\,20.387,\\,24.952\\,]$ $\\text{mm}$\n\n- Test case $3$ (boundary condition with identical $T_{i}$ that yields an exact tie when data match either model consistently):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,12.0,\\,12.0,\\,12.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,12.327,\\,13.538,\\,13.666,\\,14.838\\,]$ $\\text{mm}$\n\n- Test case $4$ (noisy duration-shift generated, distinct $T_{i}$):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,19.973,\\,21.322,\\,19.971,\\,20.503\\,]$ $\\text{mm}$\n\nFor each test case, your program must:\n- Compute $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ and $y_{i} = \\ln R_{i}$ for all digits $i$.\n- Fit the rate-shift model by LS in log space to estimate $\\alpha$ using $y_{i} \\approx (\\alpha - 1)\\, x_{i}$ with $x_{i} = r_{i} T_{i}$. The unconstrained LS estimate is $\\widehat{\\alpha}_{\\mathrm{unc}} = 1 + \\frac{\\sum_{i} x_{i} y_{i}}{\\sum_{i} x_{i}^{2}}$. Enforce the peramorphic constraint by setting $\\widehat{\\alpha} = \\max\\{1, \\widehat{\\alpha}_{\\mathrm{unc}}\\}$.\n- Fit the duration-shift model by LS in log space to estimate $\\Delta t$ using $y_{i} \\approx r_{i} \\Delta t$. The unconstrained LS estimate is $\\widehat{\\Delta t}_{\\mathrm{unc}} = \\frac{\\sum_{i} r_{i} y_{i}}{\\sum_{i} r_{i}^{2}}$. Enforce the peramorphic constraint by setting $\\widehat{\\Delta t} = \\max\\{0, \\widehat{\\Delta t}_{\\mathrm{unc}}\\}$.\n- Compute the sum of squared residuals in log space for each model,\n  $$\\mathrm{SSE}_{\\mathrm{rate}} = \\sum_{i} \\left(y_{i} - (\\widehat{\\alpha} - 1)\\, x_{i}\\right)^{2}, \\quad \\mathrm{SSE}_{\\mathrm{duration}} = \\sum_{i} \\left(y_{i} - r_{i} \\widehat{\\Delta t}\\right)^{2}.$$\n- Decide the better model using tolerance $\\tau = 10^{-8}$: output decision code $0$ if $\\mathrm{SSE}_{\\mathrm{rate}} + \\tau < \\mathrm{SSE}_{\\mathrm{duration}}$, code $1$ if $\\mathrm{SSE}_{\\mathrm{duration}} + \\tau < \\mathrm{SSE}_{\\mathrm{rate}}$, and code $2$ otherwise.\n\nFinal output format: Your program should produce a single line of output containing the decisions for the $4$ test cases as a comma-separated list enclosed in square brackets (for example, $[0,1,2,0]$). The program must not read any input and must not print anything else.", "solution": "The supplied problem is scientifically sound and mathematically well-posed. We will proceed with a solution.\n\nThe objective is to discriminate between two competing models of peramorphic evolution, a rate-shift model and a duration-shift model, based on observed digit lengths in a reference species (mouse) and a derived species (bat). The foundation for both models is an exponential growth law for digit length, $L(t) = L_{0} e^{r t}$, where $L_{0}$ is an initial length at the start of the growth phase ($t=0$), $r$ is the per-capita proliferation rate, and $t$ is time. The final length after a growth duration $T$ is $L=L_0 e^{rT}$.\n\nAssuming the initial condition parameters $L_0$ are conserved for a homologous digit $i$ between the two species, the ratio of final lengths $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ is given by:\n$$\nR_{i} = \\frac{L_{0, i} e^{r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i}}{L_{0, i} e^{r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i}} = e^{r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i - r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i}\n$$\nTaking the natural logarithm yields the core equation for our analysis:\n$$\n\\ln(R_{i}) = r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i - r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i\n$$\nLet us denote the observable log-ratio as $y_{i} = \\ln(R_{i})$, and the reference parameters as $r_{i} = r^{\\mathrm{mouse}}_i$ and $T_{i} = T^{\\mathrm{mouse}}_i$.\n\nThe two heterochronic hypotheses can be formulated as linear models in log-space:\n\n1.  **Rate-shift model**: This model posits that the evolutionary change is due to an acceleration of the growth rate by a factor $\\alpha \\ge 1$, while the duration remains unchanged. The parameters are related by $r^{\\mathrm{bat}}_i = \\alpha r_i$ and $T^{\\mathrm{bat}}_i = T_i$. Substituting these into the log-ratio equation gives:\n    $$\n    y_{i} = (\\alpha r_i) T_i - r_i T_i = (\\alpha - 1) r_i T_i\n    $$\n    This is a linear model of the form $y_{i} = \\beta_{\\mathrm{rate}} x_{i}$, where the predictor variable is $x_{i} = r_{i} T_{i}$ and the slope is $\\beta_{\\mathrm{rate}} = \\alpha - 1$. The constraint $\\alpha \\ge 1$ implies $\\beta_{\\mathrm{rate}} \\ge 0$.\n\n2.  **Duration-shift model**: This model posits that the change is due to an extension of the growth duration by an amount $\\Delta t \\ge 0$, while the rate remains constant. The parameters are related by $r^{\\mathrm{bat}}_i = r_i$ and $T^{\\mathrm{bat}}_i = T_i + \\Delta t$. Substitution yields:\n    $$\n    y_{i} = r_i (T_i + \\Delta t) - r_i T_i = r_i \\Delta t\n    $$\n    This is a linear model of the form $y_{i} = \\beta_{\\mathrm{duration}} z_{i}$, where the predictor variable is $z_{i} = r_{i}$ and the slope is $\\beta_{\\mathrm{duration}} = \\Delta t$. The constraint $\\Delta t \\ge 0$ implies $\\beta_{\\mathrm{duration}} \\ge 0$.\n\nTo estimate the parameters $\\alpha$ and $\\Delta t$, we employ the method of Ordinary Least Squares (LS) for a linear model with a zero intercept ($y = \\beta u$). The LS estimator for the slope $\\beta$ that minimizes the sum of squared residuals $\\sum (y_i - \\beta u_i)^2$ is given by:\n$$\n\\widehat{\\beta} = \\frac{\\sum_{i} u_{i} y_{i}}{\\sum_{i} u_{i}^{2}}\n$$\nApplying this to our models, we obtain the unconstrained estimates:\nFor the rate-shift model, with $u_{i} = x_{i} = r_{i}T_{i}$ and $\\widehat{\\beta}_{\\mathrm{rate, unc}} = \\widehat{\\alpha}_{\\mathrm{unc}} - 1$:\n$$\n\\widehat{\\alpha}_{\\mathrm{unc}} - 1 = \\frac{\\sum_{i} (r_{i}T_{i}) y_{i}}{\\sum_{i} (r_{i}T_{i})^{2}} \\implies \\widehat{\\alpha}_{\\mathrm{unc}} = 1 + \\frac{\\sum_{i} (r_{i}T_{i}) y_{i}}{\\sum_{i} (r_{i}T_{i})^{2}}\n$$\nFor the duration-shift model, with $u_{i} = z_{i} = r_{i}$ and $\\widehat{\\beta}_{\\mathrm{duration, unc}} = \\widehat{\\Delta t}_{\\mathrm{unc}}$:\n$$\n\\widehat{\\Delta t}_{\\mathrm{unc}} = \\frac{\\sum_{i} r_{i} y_{i}}{\\sum_{i} r_{i}^{2}}\n$$\nThe peramorphic constraints ($\\alpha \\geq 1$ and $\\Delta t \\geq 0$) are enforced by projecting these estimates onto their valid domains:\n$$\n\\widehat{\\alpha} = \\max\\{1, \\widehat{\\alpha}_{\\mathrm{unc}}\\}\n$$\n$$\n\\widehat{\\Delta t} = \\max\\{0, \\widehat{\\Delta t}_{\\mathrm{unc}}\\}\n$$\nThe goodness-of-fit for each model is quantified by its Sum of Squared Errors (SSE) in log-space, calculated using the constrained parameter estimates:\n$$\n\\mathrm{SSE}_{\\mathrm{rate}} = \\sum_{i} \\left( y_{i} - (\\widehat{\\alpha} - 1) r_{i} T_{i} \\right)^{2}\n$$\n$$\n\\mathrm{SSE}_{\\mathrm{duration}} = \\sum_{i} \\left( y_{i} - \\widehat{\\Delta t} r_{i} \\right)^{2}\n$$\nThe model with the lower SSE is considered the better explanation for the data. A decision rule with a tolerance $\\tau = 10^{-8}$ is used to handle cases of near-equal performance:\n- If $\\mathrm{SSE}_{\\mathrm{rate}} + \\tau < \\mathrm{SSE}_{\\mathrm{duration}}$, the rate-shift model is preferred (decision code $0$).\n- If $\\mathrm{SSE}_{\\mathrm{duration}} + \\tau < \\mathrm{SSE}_{\\mathrm{rate}}$, the duration-shift model is preferred (decision code $1$).\n- Otherwise, the models are considered to perform equally well (decision code $2$).\n\nThe provided algorithm automates this entire procedure for each test case, starting from the raw length, rate, and duration data.", "answer": "```python\n# The final and complete solution is a self-contained Python program.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heterochrony model comparison problem for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (rate-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([25.324, 29.240, 24.900, 28.404])\n        },\n        # Test case 2 (duration-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([19.921, 21.030, 20.387, 24.952])\n        },\n        # Test case 3 (boundary condition for tie)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 12.0, 12.0, 12.0]),\n            \"L_bat\": np.array([12.327, 13.538, 13.666, 14.838])\n        },\n        # Test case 4 (noisy duration-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([19.973, 21.322, 19.971, 20.503])\n        }\n    ]\n\n    results = []\n    tolerance = 1e-8\n\n    for case in test_cases:\n        L_mouse, r, T, L_bat = case[\"L_mouse\"], case[\"r\"], case[\"T\"], case[\"L_bat\"]\n\n        # Compute the response variable y_i = ln(R_i)\n        R_i = L_bat / L_mouse\n        y_i = np.log(R_i)\n\n        # Fit the rate-shift model\n        # Predictor variable x_i = r_i * T_i\n        x_i = r * T\n        # Unconstrained estimate for alpha\n        alpha_unc = 1.0 + np.dot(x_i, y_i) / np.dot(x_i, x_i)\n        # Constrained estimate, alpha >= 1\n        alpha_hat = np.maximum(1.0, alpha_unc)\n        \n        # Fit the duration-shift model\n        # Predictor variable is r_i\n        # Unconstrained estimate for Delta_t\n        delta_t_unc = np.dot(r, y_i) / np.dot(r, r)\n        # Constrained estimate, Delta_t >= 0\n        delta_t_hat = np.maximum(0.0, delta_t_unc)\n\n        # Compute Sum of Squared Errors (SSE) for each model\n        # SSE for rate-shift model\n        y_pred_rate = (alpha_hat - 1.0) * x_i\n        SSE_rate = np.sum((y_i - y_pred_rate)**2)\n        \n        # SSE for duration-shift model\n        y_pred_duration = delta_t_hat * r\n        SSE_duration = np.sum((y_i - y_pred_duration)**2)\n\n        # Decide which model is better based on SSE with tolerance\n        if SSE_rate + tolerance < SSE_duration:\n            decision_code = 0  # Rate-shift is better\n        elif SSE_duration + tolerance < SSE_rate:\n            decision_code = 1  # Duration-shift is better\n        else:\n            decision_code = 2  # Tie\n        \n        results.append(decision_code)\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2722110"}]}