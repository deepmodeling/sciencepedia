{"hands_on_practices": [{"introduction": "A fundamental skill in evolutionary biology is the ability to place fossils within an absolute temporal framework. This practice grounds your understanding of radiometric dating, the cornerstone of geochronology. You will apply the principles of radioactive decay to the Rubidium-Strontium ($^{87}\\text{Rb}$-$^{87}\\text{Sr}$) system to calculate the crystallization age of a volcanic ash layer, a common method for dating fossiliferous strata. Critically, this exercise [@problem_id:2706735] also links this absolute date to the fossil record by using the principle of superposition, demonstrating how geochronology provides hard constraints on the timing of evolutionary events.", "problem": "A volcanic ash bed that lies directly beneath a fossil-bearing sedimentary unit within a conformable stratigraphic succession has been analyzed using the rubidium–strontium (Rb–Sr) system. The measured present-day isotopic ratios for a whole-rock aliquot from the ash are $^{87}\\text{Rb}/^{87}\\text{Sr} = 0.25$ and $^{87}\\text{Sr}/^{86}\\text{Sr} = 0.7100$. An independent isochron constructed from co-genetic minerals constrains the initial strontium isotopic composition of the ash at the time of deposition to be $^{87}\\text{Sr}/^{86}\\text{Sr} = 0.6990$. The radioactive decay constant for $^{87}\\text{Rb}$ is $\\lambda = 1.42 \\times 10^{-11}\\,\\mathrm{yr}^{-1}$. Using only fundamental radioactive decay principles and isotope mass-balance relative to a stable reference isotope, compute the crystallization age of the ash bed. State, based on superposition, whether this absolute age constrains a maximum or a minimum age for the overlying fossil-bearing unit, and justify your choice in one sentence. Round your numerical age to $2$ significant figures and express the age in gigayears (Ga). Your final reported answer must be only the numerical value in Ga.", "solution": "The problem requires the calculation of the crystallization age of a volcanic ash bed using the rubidium-strontium (Rb-Sr) radiometric dating method and an analysis of its stratigraphic relationship to an overlying fossil-bearing unit.\n\nThe fundamental principle is the radioactive decay of the parent isotope $^{87}\\text{Rb}$ to the daughter isotope $^{87}\\text{Sr}$ via beta decay. The number of parent atoms remaining at a time $t$, denoted $N_{^{87}\\text{Rb}}(t)$, is related to the initial number of atoms $N_{^{87}\\text{Rb}}(0)$ by the exponential decay law:\n$$ N_{^{87}\\text{Rb}}(t) = N_{^{87}\\text{Rb}}(0) \\exp(-\\lambda t) $$\nwhere $\\lambda$ is the decay constant for $^{87}\\text{Rb}$.\n\nThe number of radiogenic daughter atoms, $D^*$ ($^{87}\\text{Sr}_{\\text{rad}}$), produced by this decay is the decrease in parent atoms:\n$$ D^* = N_{^{87}\\text{Rb}}(0) - N_{^{87}\\text{Rb}}(t) $$\nBy rearranging the decay law, $N_{^{87}\\text{Rb}}(0) = N_{^{87}\\text{Rb}}(t) \\exp(\\lambda t)$, we can express $D^*$ in terms of the present-day number of parent atoms:\n$$ D^* = N_{^{87}\\text{Rb}}(t) \\exp(\\lambda t) - N_{^{87}\\text{Rb}}(t) = N_{^{87}\\text{Rb}}(t)(\\exp(\\lambda t) - 1) $$\n\nThe total number of $^{87}\\text{Sr}$ atoms present today, $N_{^{87}\\text{Sr}}(t)$, is the sum of the initially present $^{87}\\text{Sr}$ atoms, $N_{^{87}\\text{Sr}}(0)$, and the radiogenic atoms $D^*$ produced since crystallization:\n$$ N_{^{87}\\text{Sr}}(t) = N_{^{87}\\text{Sr}}(0) + N_{^{87}\\text{Rb}}(t)(\\exp(\\lambda t) - 1) $$\n\nIn isotope geochemistry, it is standard practice to normalize these absolute abundances to a stable, non-radiogenic isotope of strontium, $^{86}\\text{Sr}$, whose abundance $N_{^{86}\\text{Sr}}$ is constant over time. Dividing the equation by $N_{^{86}\\text{Sr}}$ yields the standard isochron equation in terms of measurable isotope ratios:\n$$ \\frac{N_{^{87}\\text{Sr}}(t)}{N_{^{86}\\text{Sr}}} = \\frac{N_{^{87}\\text{Sr}}(0)}{N_{^{86}\\text{Sr}}} + \\frac{N_{^{87}\\text{Rb}}(t)}{N_{^{86}\\text{Sr}}} (\\exp(\\lambda t) - 1) $$\nUsing a more compact notation where $(\\cdot)_p$ indicates the present-day ratio and $(\\cdot)_0$ indicates the initial ratio at time $t=0$, this becomes:\n$$ \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p = \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_0 + \\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p (\\exp(\\lambda t) - 1) $$\nThe problem provides the following data:\nThe present-day measured ratio $(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}})_p = 0.7100$.\nThe initial ratio $(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}})_0 = 0.6990$.\nThe decay constant $\\lambda = 1.42 \\times 10^{-11}\\,\\text{yr}^{-1}$.\nThe present-day measured ratio $(\\frac{^{87}\\text{Rb}}{^{87}\\text{Sr}})_p = 0.25$.\n\nThe isochron equation requires the present-day parent-to-stable-daughter-isotope ratio, $(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}})_p$. This can be derived from the given ratios through algebraic manipulation:\n$$ \\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p = \\left(\\frac{^{87}\\text{Rb}}{^{87}\\text{Sr}}\\right)_p \\times \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p $$\nSubstituting the numerical values:\n$$ \\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p = 0.25 \\times 0.7100 = 0.1775 $$\nNow we have all necessary components to solve for the age, $t$. Let's rearrange the isochron equation to isolate $t$:\n$$ \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p - \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_0 = \\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p (\\exp(\\lambda t) - 1) $$\n$$ \\frac{\\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p - \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_0}{\\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p} = \\exp(\\lambda t) - 1 $$\n$$ 1 + \\frac{\\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p - \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_0}{\\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p} = \\exp(\\lambda t) $$\nTaking the natural logarithm of both sides:\n$$ \\ln\\left(1 + \\frac{\\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p - \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_0}{\\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p}\\right) = \\lambda t $$\nFinally, solving for $t$:\n$$ t = \\frac{1}{\\lambda} \\ln\\left(1 + \\frac{\\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_p - \\left(\\frac{^{87}\\text{Sr}}{^{86}\\text{Sr}}\\right)_0}{\\left(\\frac{^{87}\\text{Rb}}{^{86}\\text{Sr}}\\right)_p}\\right) $$\nSubstituting the numerical values into this expression:\n$$ t = \\frac{1}{1.42 \\times 10^{-11}\\,\\text{yr}^{-1}} \\ln\\left(1 + \\frac{0.7100 - 0.6990}{0.1775}\\right) $$\n$$ t = \\frac{1}{1.42 \\times 10^{-11}\\,\\text{yr}^{-1}} \\ln\\left(1 + \\frac{0.011}{0.1775}\\right) $$\n$$ t = \\frac{1}{1.42 \\times 10^{-11}\\,\\text{yr}^{-1}} \\ln(1 + 0.0619718...) $$\n$$ t = \\frac{1}{1.42 \\times 10^{-11}\\,\\text{yr}^{-1}} \\ln(1.0619718...) $$\n$$ t = \\frac{0.060126...}{1.42 \\times 10^{-11}\\,\\text{yr}^{-1}} \\approx 4.234 \\times 10^9\\,\\text{years} $$\nThe problem requires the age to be expressed in gigayears (Ga), where $1\\,\\text{Ga} = 10^9\\,\\text{years}$, and rounded to $2$ significant figures.\n$$ t \\approx 4.2\\,\\text{Ga} $$\nRegarding the stratigraphic constraint, the principle of superposition states that in a conformable sequence of strata, any given layer is younger than the one upon which it was deposited. Since the fossil-bearing sedimentary unit lies directly on top of the dated volcanic ash bed, the fossils must be younger than the ash. Therefore, the absolute age of the ash bed provides a maximum age for the overlying fossils.\n\nThe justification is as follows: The principle of superposition dictates that the overlying fossil-bearing unit is younger than the dated ash bed beneath it, thus the ash's age sets a maximum boundary for the age of the fossils.", "answer": "$$\\boxed{4.2}$$", "id": "2706735"}, {"introduction": "Once we have established a timeline for the fossil record, we can begin to quantify the tempo of evolutionary change. This exercise introduces a classic metric in macroevolution, the \"darwin,\" to measure the rate of morphological evolution. By calculating the rate of change in a mollusk lineage across a precisely dated stratigraphic interval [@problem_id:2706715], you will practice translating raw anatomical measurements and geological ages into a standardized evolutionary rate. This skill is essential for comparing the pace of evolution across different lineages, environments, and geological eras.", "problem": "A stratigraphic sequence preserves a continuous marine section in which a single lineage of mollusks is sampled at two horizons bounded by regionally correlatable volcanic ash layers. High-precision radiometric dating places the lower ash at an age of $34.00$ million years and the upper ash at an age of $32.00$ million years, establishing a temporal separation of $2.00$ million years between the fossil samples by the principle of superposition and absolute dating. The sample means of a linear morphological trait (shell rib width) are $5.00$ units at the lower horizon and $10.00$ units at the upper horizon, with adequate sample sizes to treat these means as precise for the present calculation. In macroevolutionary studies of the fossil record, the evolutionary rate in darwins is defined as the change in the natural logarithm of the trait mean per $1$ million years (Myr).\n\nUsing only these data and the definition above, compute the evolutionary rate in darwins for this lineage between the two horizons and briefly interpret its magnitude in terms of fold change per $1$ million years. Express the rate in darwins and round your answer to four significant figures.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens.\n- Lower ash layer age: $34.00$ million years.\n- Upper ash layer age: $32.00$ million years.\n- Temporal separation ($\\Delta t$): $2.00$ million years.\n- Mean trait value at lower horizon ($M_1$): $5.00$ units.\n- Mean trait value at upper horizon ($M_2$): $10.00$ units.\n- Definition of evolutionary rate in darwins ($d$): Change in the natural logarithm of the trait mean per $1$ million years.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is evaluated and found to be valid. It is scientifically grounded in established principles of paleontology, stratigraphy, and macroevolution. The provided data are consistent; the temporal separation of $2.00$ Myr is the correct difference between the ages of the ash layers ($34.00 - 32.00 = 2.00$). The problem is well-posed, objective, and contains all necessary information to compute a unique, meaningful solution. There are no logical contradictions, unrealistic assumptions, or ambiguities.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived.\n\nThe evolutionary rate in darwins, which we will denote by the symbol $d$, is defined as the change in the natural logarithm of a trait's mean value per million years. The mathematical formulation of this definition is:\n$$d = \\frac{\\ln(M_2) - \\ln(M_1)}{\\Delta t}$$\nHere, $M_1$ is the mean trait value at the initial time (lower horizon), $M_2$ is the mean trait value at the final time (upper horizon), and $\\Delta t$ is the duration of the interval in millions of years.\n\nThe givens from the problem are:\n- Initial mean trait value, $M_1 = 5.00$.\n- Final mean trait value, $M_2 = 10.00$.\n- Time interval, $\\Delta t = 2.00$ Myr.\n\nWe substitute these values into the rate equation:\n$$d = \\frac{\\ln(10.00) - \\ln(5.00)}{2.00}$$\nBy applying the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(\\frac{a}{b})$, we simplify the numerator:\n$$d = \\frac{\\ln\\left(\\frac{10.00}{5.00}\\right)}{2.00} = \\frac{\\ln(2.00)}{2.00}$$\nTo obtain a numerical value, we use the approximation for the natural logarithm of $2$, which is $\\ln(2) \\approx 0.69314718...$. The calculation for the rate $d$ is:\n$$d = \\frac{0.69314718...}{2.00} \\approx 0.34657359...$$\nThe problem specifies that the final answer must be rounded to four significant figures. The fourth significant figure is $5$, and the subsequent digit is $7$, so we round up.\n$$d \\approx 0.3466$$\n\nThe problem also requests an interpretation of this rate in terms of fold change per $1$ million years. An evolutionary rate $d$ implies that for a time interval of $\\Delta t = 1$ Myr, we have $d = \\ln(M_{\\text{final}}) - \\ln(M_{\\text{initial}})$. This can be rewritten as $d = \\ln\\left(\\frac{M_{\\text{final}}}{M_{\\text{initial}}}\\right)$. The ratio $\\frac{M_{\\text{final}}}{M_{\\text{initial}}}$ is the fold change, which we denote as $F$. Therefore, $d = \\ln(F)$. The fold change per million years is found by taking the exponential of the rate:\n$$F = \\exp(d)$$\nUsing the exact expression for our calculated rate, $d = \\frac{\\ln(2)}{2}$:\n$$F = \\exp\\left(\\frac{\\ln(2)}{2}\\right) = \\left(\\exp(\\ln(2))\\right)^{1/2} = 2^{1/2} = \\sqrt{2} \\approx 1.414$$\nThis result signifies that the morphological trait (shell rib width) increased by a factor of approximately $1.414$ each million years over the specified interval. This is consistent with the total observation: over a $2.00$ Myr period, the total fold change is from $5.00$ to $10.00$, which is a factor of $2$. Our calculated fold change per million years, when compounded over two million years, yields $(\\sqrt{2})^2 = 2$, which confirms the logical consistency of the result.", "answer": "$$\\boxed{0.3466}$$", "id": "2706715"}, {"introduction": "The fossil record provides more than just a timeline of change; it offers time-series data that can be used to test formal hypotheses about the evolutionary process itself. This advanced practice moves beyond simple rate calculations to the frontier of quantitative paleobiology: statistical model selection. You will fit two competing models of evolutionary mode—stasis versus an unbiased random walk—to a stratigraphic sequence of morphological data. By using the Akaike Information Criterion ($AIC$) to determine the best-fitting model [@problem_id:2706707], you will engage with the methods used to distinguish between periods of evolutionary stability and directional or random change, a central debate in macroevolutionary theory.", "problem": "You are given stratigraphically ordered time-series of mean shell size measurements of a single lineage, measured in millimeters and sampled at known stratigraphic ages measured in millions of years (Myr). You must implement two evolutionary models for trait change between successive stratigraphic horizons and select the model with the better fit based on the Akaike Information Criterion (AIC). The two models are defined as follows.\n\nModel S (stasis): Each observation $x_i$ is an independent realization from a Normal distribution with unknown constant mean $\\mu$ and variance $\\sigma^2$, that is, $x_i \\sim \\mathcal{N}(\\mu,\\sigma^2)$ for $i=1,\\dots,n$.\n\nModel RW (unbiased random walk in continuous time): The increments $d_i = x_i - x_{i-1}$ are independent and Normally distributed with mean $0$ and variance proportional to the elapsed time between samples, that is, $d_i \\sim \\mathcal{N}\\!\\left(0, v \\,\\Delta t_i\\right)$ for $i=2,\\dots,n$, where $\\Delta t_i = t_i - t_{i-1} > 0$ is the time between samples in Myr and $v$ is the unknown diffusion variance per Myr.\n\nAssume no additional observation error. Use Maximum Likelihood to estimate parameters for each model given the data. Use the Akaike Information Criterion (AIC), defined as $\\mathrm{AIC} = 2k - 2\\ln\\hat{L}$ where $k$ is the number of estimated parameters and $\\hat{L}$ is the maximized likelihood under the model, to select the better model (smaller AIC is better). For Model S, treat $k$ as $k_S = 2$ for parameters $\\mu$ and $\\sigma^2$. For Model RW, treat $k$ as $k_{RW} = 1$ for the diffusion variance $v$; the initial observation $x_1$ is treated as given (not a parameter).\n\nIn the event that the two AIC values are equal to within an absolute tolerance of $10^{-9}$, select the model with fewer parameters (that is, Model RW). Otherwise, select the model with the smaller AIC. You do not need to report parameter estimates; only report which model is selected per test case.\n\nAll physical quantities associated with input data carry units as specified, but your output is unitless. Ensure all logarithms are natural logarithms.\n\nImplement a program that evaluates the following test suite. For each test case, compute which model is preferred by AIC and output an integer code: output $0$ to indicate Model S (stasis) is selected, and output $1$ to indicate Model RW (unbiased random walk) is selected.\n\nTest suite:\n- Case $1$ (equal spacing): shell sizes (in mm) $[10, 10, 11, 10, 12, 12, 12, 13, 13, 13]$ at equally spaced stratigraphic levels separated by $\\Delta t = 0.5$ Myr. That is, times (in Myr) $t = [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5]$ and $x = [10, 10, 11, 10, 12, 12, 12, 13, 13, 13]$.\n- Case $2$ (near-stasis, modest noise): times (in Myr) $t = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]$ and shell sizes (in mm) $x = [10.0, 10.2, 9.9, 10.1, 10.0, 10.1, 9.95, 10.05]$.\n- Case $3$ (boundary length, two points): times (in Myr) $t = [0.0, 1.0]$ and shell sizes (in mm) $x = [5.0, 7.0]$.\n- Case $4$ (variable spacing, near-stasis): times (in Myr) $t = [0.0, 0.1, 0.6, 1.6, 2.6]$ and shell sizes (in mm) $x = [100.0, 100.1, 100.05, 100.0, 100.05]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above. For example, an output of the form $[m_1,m_2,m_3,m_4]$ where each $m_i \\in \\{0,1\\}$ indicates the selected model for case $i$.\n\nThe final output is a single line with the list of integers and no additional text.", "solution": "The problem presented is a valid exercise in statistical model selection, a fundamental task in the quantitative sciences. It requires the comparison of two standard models for evolutionary time-series data—stasis and unbiased random walk—using the Akaike Information Criterion (AIC). The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We will proceed by deriving the maximum likelihood estimators and AIC expressions for each model.\n\nLet the data be a time-series of $n$ trait measurements $\\mathbf{x} = \\{x_1, x_2, \\dots, x_n\\}$ at corresponding time points $\\mathbf{t} = \\{t_1, t_2, \\dots, t_n\\}$.\n\n**Model S: Stasis**\n\nThis model posits that the trait values are independent and identically distributed random draws from a single Normal distribution with a constant mean $\\mu$ and variance $\\sigma^2$. The model is expressed as:\n$$ x_i \\sim \\mathcal{N}(\\mu, \\sigma^2) \\quad \\text{for } i = 1, \\dots, n $$\nThe likelihood function $L_S(\\mu, \\sigma^2; \\mathbf{x})$ is the product of the individual probability densities:\n$$ L_S(\\mu, \\sigma^2; \\mathbf{x}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x_i - \\mu)^2}{2\\sigma^2}\\right) $$\nThe log-likelihood function is therefore:\n$$ \\ln L_S(\\mu, \\sigma^2; \\mathbf{x}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}(x_i - \\mu)^2 $$\nTo find the maximum likelihood estimators (MLEs) for $\\mu$ and $\\sigma^2$, we take the partial derivatives of $\\ln L_S$ with respect to each parameter and set them to zero. This procedure yields the sample mean as the MLE for $\\mu$ and the sample variance (with denominator $n$) as the MLE for $\\sigma^2$:\n$$ \\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^{n} x_i $$\n$$ \\hat{\\sigma}^2 = \\frac{1}{n} \\sum_{i=1}^{n} (x_i - \\hat{\\mu})^2 $$\nSubstituting these estimators back into the log-likelihood function gives the maximized log-likelihood, $\\ln\\hat{L}_S$:\n$$ \\ln \\hat{L}_S = -\\frac{n}{2}\\ln(2\\pi\\hat{\\sigma}^2) - \\frac{1}{2\\hat{\\sigma}^2} \\sum_{i=1}^{n}(x_i - \\hat{\\mu})^2 = -\\frac{n}{2}\\ln(2\\pi\\hat{\\sigma}^2) - \\frac{n\\hat{\\sigma}^2}{2\\hat{\\sigma}^2} $$\n$$ \\ln \\hat{L}_S = -\\frac{n}{2} \\left[ \\ln(2\\pi\\hat{\\sigma}^2) + 1 \\right] $$\nThe number of estimated parameters for this model is $k_S = 2$ (for $\\mu$ and $\\sigma^2$). The AIC is calculated as:\n$$ \\mathrm{AIC}_S = 2k_S - 2\\ln\\hat{L}_S = 4 - 2\\ln\\hat{L}_S $$\n\n**Model RW: Unbiased Random Walk**\n\nThis model describes the increments between successive observations, $d_i = x_i - x_{i-1}$, as independent random draws from a Normal distribution with mean $0$ and variance proportional to the time elapsed, $\\Delta t_i = t_i - t_{i-1}$. The model is:\n$$ d_i \\sim \\mathcal{N}(0, v\\Delta t_i) \\quad \\text{for } i = 2, \\dots, n $$\nHere, $v$ is the diffusion variance parameter. The likelihood function $L_{RW}(v; \\mathbf{d})$ is constructed from the $n-1$ increments:\n$$ L_{RW}(v; \\mathbf{d}) = \\prod_{i=2}^{n} \\frac{1}{\\sqrt{2\\pi v\\Delta t_i}} \\exp\\left(-\\frac{d_i^2}{2v\\Delta t_i}\\right) $$\nThe log-likelihood function is:\n$$ \\ln L_{RW}(v; \\mathbf{d}) = \\sum_{i=2}^{n} \\left[ -\\frac{1}{2}\\ln(2\\pi v\\Delta t_i) - \\frac{d_i^2}{2v\\Delta t_i} \\right] $$\n$$ \\ln L_{RW}(v; \\mathbf{d}) = -\\frac{n-1}{2}\\ln(v) - \\frac{1}{2v} \\sum_{i=2}^{n} \\frac{d_i^2}{\\Delta t_i} - \\frac{1}{2} \\sum_{i=2}^{n} \\ln(2\\pi\\Delta t_i) $$\nDifferentiating with respect to $v$ and setting the result to zero gives the MLE for $v$:\n$$ \\hat{v} = \\frac{1}{n-1} \\sum_{i=2}^{n} \\frac{d_i^2}{\\Delta t_i} = \\frac{1}{n-1} \\sum_{i=2}^{n} \\frac{(x_i - x_{i-1})^2}{t_i - t_{i-1}} $$\nThe maximized log-likelihood, $\\ln\\hat{L}_{RW}$, is obtained by substituting $\\hat{v}$ back into the log-likelihood function. This can be expressed in several forms; a direct computational form is:\n$$ \\ln \\hat{L}_{RW} = \\sum_{i=2}^{n} \\left[ -\\frac{1}{2}\\ln(2\\pi\\hat{v}\\Delta t_i) - \\frac{d_i^2}{2\\hat{v}\\Delta t_i} \\right] $$\nA simplified analytical form, useful for verification, is:\n$$ \\ln \\hat{L}_{RW} = -\\frac{n-1}{2}(1 + \\ln(2\\pi\\hat{v})) - \\frac{1}{2}\\sum_{i=2}^{n}\\ln(\\Delta t_i) $$\nThe number of estimated parameters is $k_{RW} = 1$ (for $v$, as $x_1$ is given). The AIC is:\n$$ \\mathrm{AIC}_{RW} = 2k_{RW} - 2\\ln\\hat{L}_{RW} = 2 - 2\\ln\\hat{L}_{RW} $$\n\n**Model Selection**\n\nThe preferred model is the one with the lower AIC value. In the case of a tie, defined as $|\\mathrm{AIC}_S - \\mathrm{AIC}_{RW}| \\le 10^{-9}$, the principle of parsimony dictates selecting the model with fewer parameters. Since $k_{RW} = 1 < k_S = 2$, Model RW is chosen in a tie. This leads to the following decision rule: select Model S if and only if its AIC score is significantly lower than that of Model RW; otherwise, select Model RW. Computationally, this is:\n- If $\\mathrm{AIC}_S < \\mathrm{AIC}_{RW} - 10^{-9}$, select Model S (output $0$).\n- Otherwise, select Model RW (output $1$).\n\nThe provided test cases will be evaluated according to these derived formulae.", "answer": "```python\nimport numpy as np\n\ndef calculate_aic_stasis(x: np.ndarray) -> float:\n    \"\"\"\n    Calculates the AIC for the stasis model (Model S).\n\n    Args:\n        x: A numpy array of trait measurements.\n\n    Returns:\n        The AIC value for the stasis model.\n    \"\"\"\n    n = len(x)\n    if n == 0:\n        return np.inf\n\n    # MLE for variance (np.var uses denominator n by default)\n    sigma2_hat = np.var(x)\n\n    if sigma2_hat <= 0:\n        # This case implies a perfect fit, log-likelihood is infinite,\n        # so AIC is -infinity.\n        return -np.inf\n\n    # Maximized log-likelihood for the stasis model.\n    # ln_L_S = -n/2 * (ln(2*pi*sigma2_hat) + 1)\n    ln_L_S = -n / 2.0 * (np.log(2 * np.pi * sigma2_hat) + 1.0)\n\n    # AIC = 2k - 2*ln(L), with k=2 parameters (mu, sigma^2).\n    k_S = 2\n    aic_S = 2 * k_S - 2 * ln_L_S\n    return aic_S\n\n\ndef calculate_aic_rw(t: np.ndarray, x: np.ndarray) -> float:\n    \"\"\"\n    Calculates the AIC for the unbiased random walk model (Model RW).\n\n    Args:\n        t: A numpy array of time points.\n        x: A numpy array of trait measurements.\n\n    Returns:\n        The AIC value for the random walk model.\n    \"\"\"\n    n = len(x)\n    if n < 2:\n        return np.inf\n\n    # Increments in trait and time\n    d = np.diff(x)\n    dt = np.diff(t)\n    \n    # Check for invalid time steps\n    if np.any(dt <= 0):\n        # This case is disallowed by the problem statement but is a robust check.\n        return np.inf\n\n    # MLE for diffusion variance v\n    # v_hat = (1/(n-1)) * sum(d_i^2 / dt_i)\n    # np.mean computes the sum and divides by the number of elements (n-1).\n    v_hat_terms = d**2 / dt\n    v_hat = np.mean(v_hat_terms)\n    \n    if v_hat <= 0:\n        # Perfect fit, all increments are zero. AIC is -infinity.\n        return -np.inf\n\n    # Maximized log-likelihood for the random walk model.\n    # ln_L_RW = sum( -1/2 * ln(2*pi*v_hat*dt_i) - d_i^2 / (2*v_hat*dt_i) )\n    ln_L_RW_terms = -0.5 * np.log(2 * np.pi * v_hat * dt) - v_hat_terms / (2 * v_hat)\n    ln_L_RW = np.sum(ln_L_RW_terms)\n\n    # AIC = 2k - 2*ln(L), with k=1 parameter (v).\n    k_RW = 1\n    aic_RW = 2 * k_RW - 2 * ln_L_RW\n    return aic_RW\n\n\ndef select_model(t: np.ndarray, x: np.ndarray) -> int:\n    \"\"\"\n    Selects the better model based on AIC.\n\n    Args:\n        t: A numpy array of time points.\n        x: A numpy array of trait measurements.\n\n    Returns:\n        0 if Model S (stasis) is selected, 1 if Model RW (random walk) is selected.\n    \"\"\"\n    aic_S = calculate_aic_stasis(x)\n    aic_RW = calculate_aic_rw(t, x)\n    \n    # Tolerance for floating point comparison\n    tolerance = 1e-9\n\n    # Select model S only if it is significantly better (lower AIC).\n    # Otherwise, select model RW (either because it's better, or because\n    # it's a tie and RW is more parsimonious).\n    if aic_S < aic_RW - tolerance:\n        return 0  # Model S is preferred\n    else:\n        return 1  # Model RW is preferred\n\n\ndef solve():\n    \"\"\"\n    Runs the full test suite and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (equal spacing)\n        (np.array([0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5]),\n         np.array([10., 10., 11., 10., 12., 12., 12., 13., 13., 13.])),\n        # Case 2 (near-stasis, modest noise)\n        (np.array([0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]),\n         np.array([10.0, 10.2, 9.9, 10.1, 10.0, 10.1, 9.95, 10.05])),\n        # Case 3 (boundary length, two points)\n        (np.array([0.0, 1.0]),\n         np.array([5.0, 7.0])),\n        # Case 4 (variable spacing, near-stasis)\n        (np.array([0.0, 0.1, 0.6, 1.6, 2.6]),\n         np.array([100.0, 100.1, 100.05, 100.0, 100.05]))\n    ]\n\n    results = []\n    for t, x in test_cases:\n        selected = select_model(t, x)\n        results.append(selected)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2706707"}]}