{"hands_on_practices": [{"introduction": "This practice serves as a foundational exercise, exploring how changes in vital rates at different ages disproportionately impact population growth. By working through a hypothetical scenario, you will gain a quantitative and intuitive understanding of why early-life survival has a much larger effect on the net reproductive rate, $R_0$, than late-life survival. This principle of age-specific sensitivity is a cornerstone of life history theory and has profound implications for conservation and management strategies [@problem_id:2491615].", "problem": "An age-structured population has discrete annual age classes $x \\in \\{0,1,2,3,4\\}$, with age-specific survival probabilities $p_x$ from age $x$ to age $x+1$ and age-specific female fecundities $m_x$ (daughters per female). The baseline life history is:\n- $p_0 = 0.6$, $p_1 = 0.8$, $p_2 = 0.7$, $p_3 = 0.5$,\n- $m_0 = 0$, $m_1 = 0.5$, $m_2 = 1.2$, $m_3 = 1.0$, $m_4 = 0.4$.\n\nConsider two counterfactual changes to the mortality schedule that are equal in absolute magnitude but applied at different ages, holding all other vital rates fixed:\n- Younger-mortality change: increase $p_0$ by $+0.1$.\n- Older-mortality change: increase $p_3$ by $+0.1$.\n\nStarting from the definitions of survivorship $l_x$ (with $l_0 = 1$ and $l_{x+1} = l_x p_x$), net reproductive rate $R_0$ (expected lifetime daughters per newborn), and generation time $T$ (mean age of reproduction weighted by realized births), do the following:\n- Compute the baseline $R_0$ and $T$.\n- Compute $R_0$ and $T$ under the younger-mortality change and under the older-mortality change.\n- Use these results to demonstrate how survivorship weights induce different sensitivities of $R_0$ and $T$ to mortality changes at young versus old ages.\n\nFor grading, report only the ratio of the changes in net reproductive rate between the two scenarios,\n$$\\frac{\\Delta R_{0,\\text{young}}}{\\Delta R_{0,\\text{old}}},$$\nas a pure number (unitless), rounded to four significant figures. No other numerical outputs should be reported in your final answer.", "solution": "The problem requires an analysis of the sensitivity of demographic rates, specifically the net reproductive rate $R_0$ and the generation time $T$, to changes in age-specific survival probabilities. We are asked to compare the effect of a mortality change at a young age versus an old age. The solution will proceed by first establishing the baseline demographic parameters, then calculating the parameters under two counterfactual scenarios, and finally analyzing the results to demonstrate the underlying principles of demographic sensitivity.\n\nThe fundamental quantities are defined as follows. Survivorship to age $x$, denoted $l_x$, is the probability a newborn survives to age $x$. It is calculated recursively with $l_0 = 1$ and $l_{x+1} = l_x p_x$, where $p_x$ is the probability of surviving from age $x$ to $x+1$. The net reproductive rate, $R_0$, is the expected number of female offspring produced by a female over her lifetime, given by $R_0 = \\sum_{x} l_x m_x$, where $m_x$ is the age-specific fecundity. The generation time, $T$, is the mean age of mothers in a cohort at the time of offspring birth, calculated as $T = \\frac{\\sum_{x} x l_x m_x}{R_0}$.\n\nLet us first calculate the life table and demographic rates for the baseline scenario. The given vital rates are:\n- Survival probabilities: $p_0 = 0.6$, $p_1 = 0.8$, $p_2 = 0.7$, $p_3 = 0.5$.\n- Fecundities: $m_0 = 0$, $m_1 = 0.5$, $m_2 = 1.2$, $m_3 = 1.0$, $m_4 = 0.4$.\n\nThe survivorship schedule $l_x$ is computed as:\n- $l_0 = 1$\n- $l_1 = l_0 p_0 = 1 \\times 0.6 = 0.6$\n- $l_2 = l_1 p_1 = 0.6 \\times 0.8 = 0.48$\n- $l_3 = l_2 p_2 = 0.48 \\times 0.7 = 0.336$\n- $l_4 = l_3 p_3 = 0.336 \\times 0.5 = 0.168$\n\nUsing these values, we construct the baseline life table:\n| Age $x$ | $p_x$ | $m_x$ | $l_x$ | $l_x m_x$ | $x l_x m_x$ |\n|---|---|---|---|---|---|\n| $0$ | $0.6$ | $0$ | $1$ | $0$ | $0$ |\n| $1$ | $0.8$ | $0.5$ | $0.6$ | $0.3$ | $0.3$ |\n| $2$ | $0.7$ | $1.2$ | $0.48$ | $0.576$ | $1.152$ |\n| $3$ | $0.5$ | $1.0$ | $0.336$ | $0.336$ | $1.008$ |\n| $4$ | - | $0.4$ | $0.168$ | $0.0672$ | $0.2688$ |\n\nFrom the table, we calculate the baseline net reproductive rate, $R_{0, \\text{baseline}}$:\n$$R_{0, \\text{baseline}} = \\sum_{x=0}^{4} l_x m_x = 0 + 0.3 + 0.576 + 0.336 + 0.0672 = 1.2792$$\nAnd the baseline generation time, $T_{\\text{baseline}}$:\n$$\\sum_{x=0}^{4} x l_x m_x = 0 + 0.3 + 1.152 + 1.008 + 0.2688 = 2.7288$$\n$$T_{\\text{baseline}} = \\frac{\\sum x l_x m_x}{R_{0, \\text{baseline}}} = \\frac{2.7288}{1.2792} \\approx 2.1332$$\n\nNext, we evaluate the \"younger-mortality change\" scenario, where $p_0$ is increased by $0.1$.\n$$p_{0, \\text{young}} = 0.6 + 0.1 = 0.7$$\nThis change propagates through the entire survivorship schedule from age $1$ onward. The new survivorship, $l'_{x}$, is related to the baseline $l_x$ by a constant factor for $x \\ge 1$: $l'_{x} = \\frac{p_{0, \\text{young}}}{p_{0, \\text{baseline}}} l_x = \\frac{0.7}{0.6}l_x$.\n- $l'_{0} = 1$\n- $l'_{1} = 1 \\times 0.7 = 0.7$\n- $l'_{2} = 0.7 \\times 0.8 = 0.56$\n- $l'_{3} = 0.56 \\times 0.7 = 0.392$\n- $l'_{4} = 0.392 \\times 0.5 = 0.196$\n\nThe new net reproductive rate, $R_{0, \\text{young}}$, is:\n$$R_{0, \\text{young}} = \\sum_{x=0}^{4} l'_{x} m_x = (1)(0) + (0.7)(0.5) + (0.56)(1.2) + (0.392)(1.0) + (0.196)(0.4)$$\n$$R_{0, \\text{young}} = 0 + 0.35 + 0.672 + 0.392 + 0.0784 = 1.4924$$\nThe change in the net reproductive rate is:\n$$\\Delta R_{0,\\text{young}} = R_{0, \\text{young}} - R_{0, \\text{baseline}} = 1.4924 - 1.2792 = 0.2132$$\nThe new generation time, $T_{\\text{young}}$, is calculated. Note that since $m_0=0$, the change in $p_0$ scales both the numerator and the denominator of the expression for $T$ by the same factor $\\frac{p_{0, \\text{young}}}{p_{0, \\text{baseline}}}$, leaving $T$ unchanged.\n$$\\sum_{x=0}^{4} x l'_{x} m_x = 0 + (1)(0.35) + (2)(0.672) + (3)(0.392) + (4)(0.0784) = 3.1836$$\n$$T_{\\text{young}} = \\frac{3.1836}{1.4924} = \\frac{\\frac{7}{6} \\times 2.7288}{\\frac{7}{6} \\times 1.2792} = T_{\\text{baseline}} \\approx 2.1332$$\n\nNow, we evaluate the \"older-mortality change\" scenario. The baseline life history is restored, and $p_3$ is increased by $0.1$.\n$$p_{3, \\text{old}} = 0.5 + 0.1 = 0.6$$\nThis change only affects survivorship from age $4$ onward. The survivorships $l''_{0}, l''_{1}, l''_{2}, l''_{3}$ are identical to the baseline values.\n- $l''_{4} = l''_{3} p_{3, \\text{old}} = l_{3, \\text{baseline}} \\times 0.6 = 0.336 \\times 0.6 = 0.2016$\nThe new net reproductive rate, $R_{0, \\text{old}}$, is computed by summing the baseline contributions up to age $3$ and adding the new contribution from age $4$:\n$$R_{0, \\text{old}} = \\sum_{x=0}^{3} l_x m_x + l''_{4} m_4 = (0 + 0.3 + 0.576 + 0.336) + (0.2016)(0.4)$$\n$$R_{0, \\text{old}} = 1.212 + 0.08064 = 1.29264$$\nThe change in the net reproductive rate is:\n$$\\Delta R_{0, \\text{old}} = R_{0, \\text{old}} - R_{0, \\text{baseline}} = 1.29264 - 1.2792 = 0.01344$$\nThe generation time $T_{\\text{old}}$ will change, as the relative contribution of the last age class is altered.\n$$\\sum_{x=0}^{4} x l''_{x} m_x = (0+0.3+1.152+1.008) + 4 \\times (0.2016)(0.4) = 2.46 + 0.32256 = 2.78256$$\n$$T_{\\text{old}} = \\frac{2.78256}{1.29264} \\approx 2.1526$$\n\nThe disparity in the magnitude of $\\Delta R_{0}$ between the two scenarios reveals a fundamental principle. The sensitivity of $R_0$ to a change in a survival probability $p_j$ is determined by the total future reproduction of individuals who survive past age $j$. The exact change in $R_0$ due to a change in $p_j$ is given by:\n$$\\Delta R_0 = \\left(\\frac{p'_{j}}{p_j}-1\\right) \\sum_{x=j+1}^{\\omega} l_x m_x = \\frac{\\Delta p_j}{p_j} \\sum_{x=j+1}^{\\omega} l_x m_x$$\nFor the younger-mortality change ($j=0$):\n$$\\Delta R_{0,\\text{young}} = \\frac{\\Delta p_0}{p_0} \\sum_{x=1}^{4} l_x m_x = \\frac{0.1}{0.6} \\times (0.3 + 0.576 + 0.336 + 0.0672) = \\frac{0.1}{0.6} \\times 1.2792 = 0.2132$$\nThis matches our direct calculation. The effect is large because an improvement in early survival allows more individuals to reach all subsequent reproductive ages.\nFor the older-mortality change ($j=3$):\n$$\\Delta R_{0,\\text{old}} = \\frac{\\Delta p_3}{p_3} \\sum_{x=4}^{4} l_x m_x = \\frac{\\Delta p_3}{p_3} (l_4 m_4) = \\frac{0.1}{0.5} \\times (0.168 \\times 0.4) = \\frac{0.1}{0.5} \\times 0.0672 = 0.01344$$\nThis also matches our calculation. The effect is small because an improvement in late-life survival only affects reproduction in the very last age class, which has low survivorship ($l_4$) and moderate fecundity.\n\nThe problem asks for the ratio of these changes.\n$$\\frac{\\Delta R_{0,\\text{young}}}{\\Delta R_{0,\\text{old}}} = \\frac{0.2132}{0.01344} \\approx 15.863095...$$\nRounding to four significant figures, the ratio is $15.86$. This demonstrates that, for this life history, population growth is over $15$ times more sensitive to a $0.1$ absolute change in survival of the youngest age class compared to the same absolute change for one of the oldest age classes.", "answer": "$$\\boxed{15.86}$$", "id": "2491615"}, {"introduction": "Moving from theoretical concepts to practical application is a critical skill in quantitative ecology. This hands-on coding exercise challenges you to implement a numerical solver for the Euler-Lotka equation, the fundamental relationship defining a population's intrinsic rate of increase, $r$. By translating this equation into working code, you will solidify your understanding of stable population dynamics and create a tool to directly test the accuracy of common demographic shortcuts like $\\hat{r} = \\frac{\\ln(R_0)}{T}$ [@problem_id:2491650].", "problem": "You are given discrete-age life tables consisting of three aligned arrays: ages in years, survivorship, and age-specific fertility. Each life table specifies ages $x$, survivorship schedule $l_x$ (probability of survival from birth to age $x$), and fertility schedule $m_x$ (expected number of female offspring produced by a female at age $x$ per year). Assume a time-invariant environment and a density-independent population so that, at demographic steady growth, the population grows or declines exponentially with constant intrinsic rate of increase $r$ per year and a stable age distribution. Use only the following fundamental base: the definitions of survivorship $l_x$, fertility $m_x$, the net reproductive rate $R_0$, and the mean generation time $T$; and the canonical balance condition that links $l_x$, $m_x$, and $r$ in a stable, exponentially growing population. From these, derive the equation that implicitly defines $r$ and design a numerical procedure to solve it. Then compute $R_0$ and $T$ from first principles and use them to form the approximation $\\ln(R_0)/T$. Finally, quantify the approximation error relative to the numerically solved $r$.\n\nImplement a program that, for each life table in the test suite, computes:\n- the intrinsic rate of increase $r$ per year by solving the implicit balance condition,\n- the approximation $\\widehat{r}=\\ln(R_0)/T$ per year, where $R_0$ is the net reproductive rate and $T$ is the mean generation time in years,\n- the absolute error $|r-\\widehat{r}|$.\n\nAll answers must be expressed in per-year units for $r$ and $\\widehat{r}$, and in years for $T$. The numerical outputs you print should be dimensionless floating-point numbers with fixed decimal formatting as specified below.\n\nTest suite:\n- Case A (early-to-mid reproduction, growing population):\n  - $x=\\,[\\,0,1,2,3,4,5,6\\,]$\n  - $l_x=\\,[\\,1.0,0.7,0.6,0.5,0.35,0.2,0.05\\,]$\n  - $m_x=\\,[\\,0.0,0.0,1.2,1.5,1.0,0.2,0.0\\,]$\n- Case B (delayed reproduction, growing population):\n  - $x=\\,[\\,0,1,2,3,4,5,6,7,8,9,10\\,]$\n  - $l_x=\\,[\\,1.0,0.9,0.82,0.74,0.66,0.58,0.5,0.42,0.34,0.26,0.18\\,]$\n  - $m_x=\\,[\\,0.0,0.0,0.0,0.0,0.0,0.0,0.8,1.0,1.0,0.6,0.0\\,]$\n- Case C (near-replacement with early reproduction):\n  - $x=\\,[\\,0,1,2,3,4,5\\,]$\n  - $l_x=\\,[\\,1.0,0.8,0.65,0.5,0.3,0.1\\,]$\n  - $m_x=\\,[\\,0.0,0.0,1.0,0.9,0.3,0.0\\,]$\n- Case D (declining population):\n  - $x=\\,[\\,0,1,2,3,4,5,6\\,]$\n  - $l_x=\\,[\\,1.0,0.6,0.4,0.25,0.12,0.05,0.01\\,]$\n  - $m_x=\\,[\\,0.0,0.0,0.7,0.4,0.1,0.0,0.0\\,]$\n\nAlgorithmic requirements:\n- Derive from first principles the implicit equation for $r$ and solve it numerically with a robust root-finding method on a bracket that guarantees existence and uniqueness under the given assumptions, without relying on closed-form shortcuts.\n- Compute $R_0=\\sum_x l_x m_x$ and $T=\\left(\\sum_x x\\,l_x m_x\\right)/R_0$ from the definitions.\n- Compute $\\widehat{r}=\\ln(R_0)/T$ and the absolute error $|r-\\widehat{r}|$.\n- Round $r$, $\\widehat{r}$, and $|r-\\widehat{r}|$ to $6$ decimal places for output.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case and is itself a list with three floating-point numbers $[r,\\widehat{r},|r-\\widehat{r}|]$, each formatted with exactly $6$ digits after the decimal point. For example, the printed structure must look like $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$ with no additional text.\n- No input is provided; the program must embed the test suite and run to completion on its own.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and contains all necessary information for a complete solution. It represents a standard exercise in quantitative population ecology. Therefore, a full solution will be provided.\n\nThe core of the problem is to determine the intrinsic rate of population increase, $r$, from a discrete life table and compare it to a common approximation. This requires the derivation and subsequent numerical solution of the Euler-Lotka equation.\n\n**1. Derivation of the Euler-Lotka Equation**\n\nThe model assumes a population with discrete age classes $x = 0, 1, 2, \\dots, \\omega$, where $\\omega$ is the maximum age. Let $N(x, t)$ be the number of females in age class $x$ at time $t$. The fundamental renewal process is described by two relationships:\n\nFirst, the number of newborn females at time $t$, denoted $N(0, t)$, is the sum of all offspring produced by females across all age classes:\n$$ N(0, t) = \\sum_{x=0}^{\\omega} N(x, t) m_x $$\nHere, $m_x$ is the age-specific fecundity, i.e., the average number of female offspring produced by a female of age $x$.\n\nSecond, the number of females of age $x$ at time $t$ is the number of females born at time $t-x$ who have survived to age $x$:\n$$ N(x, t) = N(0, t-x) l_x $$\nwhere $l_x$ is the probability of surviving from birth to age $x$.\n\nBy substituting the second expression into the first, we link the number of births at time $t$ to the number of births at previous times:\n$$ N(0, t) = \\sum_{x=0}^{\\omega} N(0, t-x) l_x m_x $$\nThis is the general renewal equation for the population.\n\nThe problem states that the population grows exponentially with a stable age distribution. This implies that the population size, and specifically the number of newborns, grows at a constant intrinsic rate $r$:\n$$ N(0, t) = N(0, 0) e^{rt} $$\nwhere $N(0, 0)$ is the number of newborns at $t=0$. From this, the number of newborns at time $t-x$ can be expressed as:\n$$ N(0, t-x) = N(0, 0) e^{r(t-x)} = (N(0, 0) e^{rt}) e^{-rx} = N(0, t) e^{-rx} $$\n\nSubstituting this back into the renewal equation yields:\n$$ N(0, t) = \\sum_{x=0}^{\\omega} \\left( N(0, t) e^{-rx} \\right) l_x m_x $$\nFor a non-extinct population, $N(0, t) > 0$, so we can divide both sides by $N(0, t)$. This gives the canonical balance condition, known as the discrete-time Euler-Lotka equation, which implicitly defines $r$:\n$$ 1 = \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} $$\n\n**2. Numerical Solution for the Intrinsic Rate of Increase, $r$**\n\nTo find $r$, we must solve the equation $f(r) = 0$, where:\n$$ f(r) = \\left( \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} \\right) - 1 $$\nTo ensure that a unique solution exists and can be found numerically, we examine the properties of $f(r)$. Its derivative with respect to $r$ is:\n$$ f'(r) = \\frac{d}{dr} \\left( \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} \\right) = - \\sum_{x=0}^{\\omega} x l_x m_x e^{-rx} $$\nSince age $x$, survivorship $l_x$, and fecundity $m_x$ are all non-negative, and the exponential term is always positive, the derivative $f'(r)$ is strictly negative (assuming reproduction occurs at any age $x>0$). This monotonicity guarantees that if a root for $r$ exists, it is unique.\n\nThe existence of a root is guaranteed by the Intermediate Value Theorem. As $r \\to \\infty$, $e^{-rx} \\to 0$ for $x>0$, so $f(r) \\to -1$ (assuming $m_0=0$). As $r \\to -\\infty$, $e^{-rx} \\to \\infty$ for $x>0$, so $f(r) \\to \\infty$. Since $f(r)$ is continuous and changes sign, a root must exist.\n\nA robust numerical method, such as Brent's method, can find this root if given a bracket $[a,b]$ where $f(a)$ and $f(b)$ have opposite signs. A convenient point to check is $r=0$:\n$$ f(0) = \\left( \\sum_{x=0}^{\\omega} l_x m_x \\right) - 1 = R_0 - 1 $$\nwhere $R_0$ is the net reproductive rate.\n- If $R_0 > 1$, then $f(0) > 0$, and the root $r$ must be positive.\n- If $R_0 < 1$, then $f(0) < 0$, and the root $r$ must be negative.\n- If $R_0 = 1$, then $f(0) = 0$, and the root is $r=0$.\nA bracketing interval such as $[-1, 1]$ is generally sufficient for populations with realistic demographic rates.\n\n**3. Calculation of Auxiliary Demographic Parameters**\n\nThe problem also requires calculating the net reproductive rate ($R_0$), the mean generation time ($T$), and an approximation of $r$ ($\\widehat{r}$).\n\n- **Net Reproductive Rate ($R_0$)**: $R_0$ is the expected number of female offspring produced by a female over her lifetime. For discrete age classes, it is calculated by summing the product of age-specific survivorship and fecundity:\n$$ R_0 = \\sum_{x=0}^{\\omega} l_x m_x $$\n\n- **Mean Generation Time ($T$)**: $T$ is the average age of mothers in a cohort of newborns. It is the mean of the age-specific net reproductive schedule, $l_x m_x$:\n$$ T = \\frac{\\sum_{x=0}^{\\omega} x l_x m_x}{\\sum_{x=0}^{\\omega} l_x m_x} = \\frac{\\sum_{x=0}^{\\omega} x l_x m_x}{R_0} $$\n\n- **Approximation of $r$ ($\\widehat{r}$)**: A widely used approximation for $r$ is:\n$$ \\widehat{r} = \\frac{\\ln(R_0)}{T} $$\nThis approximation is derived from a first-order Taylor series expansion of the Euler-Lotka equation around $r=0$ and is most accurate for populations near replacement level (i.e., $R_0 \\approx 1$).\n\n**4. Quantifying Approximation Error**\n\nThe accuracy of the approximation is assessed by computing the absolute error between the numerically solved value $r$ and the approximation $\\widehat{r}$:\n$$ \\text{Error} = |r - \\widehat{r}| $$\n\nThe implementation will follow these derivations, using numerical libraries for efficient calculation and root-finding.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for demographic rates r, r_hat, and their error for a suite of life tables.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (early-to-mid reproduction, growing)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6],\n            \"lx\": [1.0, 0.7, 0.6, 0.5, 0.35, 0.2, 0.05],\n            \"mx\": [0.0, 0.0, 1.2, 1.5, 1.0, 0.2, 0.0],\n        },\n        {\n            \"name\": \"Case B (delayed reproduction, growing)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n            \"lx\": [1.0, 0.9, 0.82, 0.74, 0.66, 0.58, 0.5, 0.42, 0.34, 0.26, 0.18],\n            \"mx\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.0, 1.0, 0.6, 0.0],\n        },\n        {\n            \"name\": \"Case C (near-replacement with early reproduction)\",\n            \"x\": [0, 1, 2, 3, 4, 5],\n            \"lx\": [1.0, 0.8, 0.65, 0.5, 0.3, 0.1],\n            \"mx\": [0.0, 0.0, 1.0, 0.9, 0.3, 0.0],\n        },\n        {\n            \"name\": \"Case D (declining population)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6],\n            \"lx\": [1.0, 0.6, 0.4, 0.25, 0.12, 0.05, 0.01],\n            \"mx\": [0.0, 0.0, 0.7, 0.4, 0.1, 0.0, 0.0],\n        }\n    ]\n\n    results_for_print = []\n    \n    for case in test_cases:\n        x = np.array(case[\"x\"], dtype=float)\n        lx = np.array(case[\"lx\"], dtype=float)\n        mx = np.array(case[\"mx\"], dtype=float)\n\n        # 1. Calculate Net Reproductive Rate (R0)\n        # R0 = sum(lx * mx)\n        R0 = np.sum(lx * mx)\n\n        # 2. Solve for the intrinsic rate of increase (r) using the Euler-Lotka equation.\n        # The equation is: sum(lx * mx * exp(-r*x)) = 1\n        # We find the root of the function f(r) = sum(lx * mx * exp(-r*x)) - 1\n        def euler_lotka_func(r_val):\n            return np.sum(lx * mx * np.exp(-r_val * x)) - 1.0\n\n        # If R0 is exactly 1, r is 0. Otherwise, solve numerically.\n        if np.isclose(R0, 1.0):\n            r = 0.0\n        else:\n            # A search bracket of [-1, 1] is robust for typical ecological data.\n            try:\n                r = brentq(euler_lotka_func, -1.0, 1.0)\n            except ValueError:\n                # In case the root is not in [-1, 1], expand the search.\n                # This is unlikely for the given test cases.\n                r = brentq(euler_lotka_func, -5.0, 5.0)\n\n        # 3. Calculate Mean Generation Time (T)\n        # T = sum(x * lx * mx) / R0\n        # If R0 is 0, T is undefined. However, mx values ensure R0 > 0 here.\n        if R0 > 0:\n            T = np.sum(x * lx * mx) / R0\n        else:\n            # This case should not be reached with the provided data.\n            T = np.nan\n\n        # 4. Calculate the approximation r_hat\n        # r_hat = ln(R0) / T\n        if R0 > 0 and T > 0:\n            r_hat = np.log(R0) / T\n        else:\n            r_hat = 0.0 if np.isclose(R0, 1.0) else np.nan\n\n        # 5. Calculate the absolute error\n        error = np.abs(r - r_hat)\n\n        # Append formatted results for the current case\n        sub_list = [f\"{val:.6f}\" for val in [r, r_hat, error]]\n        results_for_print.append(f\"[{','.join(sub_list)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_for_print)}]\")\n\nsolve()\n```", "id": "2491650"}, {"introduction": "The approximation $r \\approx \\frac{\\ln R_0}{T}$ is a ubiquitous tool in population biology, but its utility depends on conditions that are not always met. This exercise requires you to move beyond calculation and critically analyze the mathematical basis of this approximation. By identifying the specific life-history characteristics that determine its accuracy, you will develop a deeper appreciation for how the distribution of reproduction over an organism's lifetime shapes population dynamics and learn to apply theoretical shortcuts with appropriate caution [@problem_id:2491613].", "problem": "A continuous-time, age-structured population has intrinsic rate of increase $r$ defined implicitly by the Euler–Lotka equation, written here in discrete age classes for clarity as\n$$\\sum_{x=0}^{\\infty} e^{-r x} \\ell_x m_x \\;=\\; 1,$$\nwhere $\\ell_x$ is survivorship to age $x$ and $m_x$ is age-specific fertility. Define the cohort net reproductive rate $R_0$ and the cohort mean generation time $T$ as\n$$R_0 \\;=\\; \\sum_{x=0}^{\\infty} \\ell_x m_x,\\qquad T \\;=\\; \\frac{\\sum_{x=0}^{\\infty} x\\,\\ell_x m_x}{\\sum_{x=0}^{\\infty} \\ell_x m_x}.$$\nA widely used first-order relation connects $r$, $\\ln R_0$, and $T$ by linearizing the Euler–Lotka identity around $r=0$. Starting from these definitions and the Euler–Lotka equation alone (no other special assumptions), identify which statements correctly characterize when that first-order relation is accurate and when it fails.\n\nChoose all that apply.\n\nA. If all reproduction is concentrated at a single age $\\tau$ (zero variance of reproductive ages), then the first-order relation becomes exact regardless of the magnitude of $r$. More generally, if reproduction is concentrated in a narrow age window (small variance of reproductive ages) and $|r|$ is modest, the relation is first-order accurate; its error grows as the reproductive age distribution widens and as $|r|$ increases.\n\nB. The first-order relation is an algebraic consequence of the Euler–Lotka equation that holds exactly for any age schedule, because it does not rely on any approximation beyond the definitions of $R_0$ and $T$.\n\nC. When reproduction spans many age classes (large variance of reproductive ages) and the population grows or declines rapidly (large $|r|$), the relation can fail badly. In growing populations with broad reproductive schedules it typically underestimates $r$; the leading error term scales with the product of the variance of reproductive ages and $r^2$.\n\nD. The first-order relation is accurate if and only if age-specific survivorship and fertility are constant across ages.\n\nE. For populations with $2$ well-separated reproductive peaks of equal weight but the same $R_0$ and $T$ as a unimodal population, the relation remains exact because only $R_0$ and $T$ matter for $r$ to first order, regardless of higher moments of the reproductive age distribution.", "solution": "The validity of the problem statement must be established prior to any attempt at a solution. The problem is formulated using standard, canonical definitions from population ecology: the discrete-time Euler-Lotka equation, the net reproductive rate $R_0$, and the mean cohort generation time $T$. The givens are:\n1.  Euler-Lotka Equation: $$\\sum_{x=0}^{\\infty} e^{-r x} \\ell_x m_x \\;=\\; 1$$\n2.  Net Reproductive Rate: $$R_0 \\;=\\; \\sum_{x=0}^{\\infty} \\ell_x m_x$$\n3.  Mean Generation Time: $$T \\;=\\; \\frac{\\sum_{x=0}^{\\infty} x\\,\\ell_x m_x}{\\sum_{x=0}^{\\infty} \\ell_x m_x}$$\nThese definitions are self-consistent, mathematically precise, and fundamental to the field of demography. The task—to analyze the accuracy of a first-order approximation derived from these principles—is well-posed and requires substantive mathematical reasoning. The problem statement is therefore valid. We may proceed with the derivation and analysis.\n\nThe first step is to derive the \"first-order relation\" by linearizing the Euler–Lotka equation around $r=0$. A more rigorous approach utilizes the concept of cumulants. Let us define a probability distribution for the age of maternity, $p(x)$, as:\n$$p(x) \\;=\\; \\frac{\\ell_x m_x}{R_0} \\;=\\; \\frac{\\ell_x m_x}{\\sum_{x=0}^{\\infty} \\ell_x m_x}$$\nThe Euler-Lotka equation can then be rewritten by substituting $\\ell_x m_x = R_0 p(x)$:\n$$\\sum_{x=0}^{\\infty} e^{-rx} R_0 p(x) \\;=\\; 1 \\implies \\sum_{x=0}^{\\infty} e^{-rx} p(x) \\;=\\; \\frac{1}{R_0}$$\nThe summation term is the moment-generating function (MGF) of the age distribution $p(x)$, evaluated at $-r$. Let us denote the random variable for age as $X$. The MGF is $M_X(t) = E[e^{tX}]$. The equation is thus $M_X(-r) = 1/R_0$.\nTaking the natural logarithm of both sides gives:\n$$\\ln(M_X(-r)) \\;=\\; \\ln\\left(\\frac{1}{R_0}\\right) \\;=\\; -\\ln R_0$$\nThe left-hand side is, by definition, the cumulant-generating function (CGF) of $X$, $K_X(t) = \\ln(M_X(t))$, evaluated at $t=-r$. The CGF can be expressed as a Taylor series in terms of the cumulants $\\kappa_n$:\n$$K_X(t) \\;=\\; \\sum_{n=1}^{\\infty} \\frac{\\kappa_n t^n}{n!}$$\nThe first two cumulants are the mean and variance of the distribution. For the age of reproduction $X$:\n$\\kappa_1 = E[X] = \\sum_{x=0}^{\\infty} x p(x) = \\frac{\\sum x \\ell_x m_x}{R_0} = T$.\n$\\kappa_2 = \\text{Var}(X) = \\sigma_T^2$, the variance of the age of reproduction.\nSubstituting the CGF expansion into the equation gives the exact form of the Euler-Lotka equation:\n$$K_X(-r) \\;=\\; \\kappa_1(-r) + \\frac{\\kappa_2}{2!}(-r)^2 + \\frac{\\kappa_3}{3!}(-r)^3 + \\dots \\;=\\; -\\ln R_0$$\n$$-rT + \\frac{\\sigma_T^2}{2}r^2 - \\frac{\\kappa_3}{6}r^3 + \\dots \\;=\\; -\\ln R_0$$\nThe first-order relation is obtained by truncating this exact series, keeping only the term linear in $r$:\n$$-rT \\approx -\\ln R_0 \\quad \\implies \\quad r \\approx \\frac{\\ln R_0}{T}$$\nThe accuracy of this relation depends on the magnitude of the discarded terms. The leading error term is proportional to $\\frac{\\sigma_T^2}{2}r^2$. The approximation is therefore accurate when $|r|$ is small and/or the variance of reproductive ages, $\\sigma_T^2$, is small.\n\nWe will now evaluate each option based on this derivation.\n\nA. If all reproduction is concentrated at a single age $\\tau$ (zero variance of reproductive ages), then the first-order relation becomes exact regardless of the magnitude of $r$. More generally, if reproduction is concentrated in a narrow age window (small variance of reproductive ages) and $|r|$ is modest, the relation is first-order accurate; its error grows as the reproductive age distribution widens and as $|r|$ increases.\nThis statement is correct. If reproduction occurs only at a single age $x=\\tau$, the distribution $p(x)$ is a Dirac delta function centered at $\\tau$. For such a distribution, the mean is $\\kappa_1 = T = \\tau$ and all higher cumulants are zero ($\\kappa_n=0$ for $n \\ge 2$). In particular, the variance $\\sigma_T^2 = \\kappa_2 = 0$. The exact CGF expansion becomes $-rT = -\\ln R_0$, which is precisely $r = (\\ln R_0) / T$. The relation is exact. The second part of the statement correctly identifies that the accuracy of the approximation depends on keeping the error term, $\\frac{\\sigma_T^2}{2}r^2$, small. This is achieved when $\\sigma_T^2$ (variance) is small and $|r|$ is small. The error indeed grows with both quantities. Verdict: **Correct**.\n\nB. The first-order relation is an algebraic consequence of the Euler–Lotka equation that holds exactly for any age schedule, because it does not rely on any approximation beyond the definitions of $R_0$ and $T$.\nThis statement is false. The derivation explicitly involves a truncation of an infinite series (the CGF expansion), which is an approximation. It is not an exact algebraic consequence, except in the specific case of zero variance as described in option A. For any general age schedule with non-zero variance, the relation is an approximation. Verdict: **Incorrect**.\n\nC. When reproduction spans many age classes (large variance of reproductive ages) and the population grows or declines rapidly (large $|r|$), the relation can fail badly. In growing populations with broad reproductive schedules it typically underestimates $r$; the leading error term scales with the product of the variance of reproductive ages and $r^2$.\nThis statement is correct. The accuracy is dictated by the magnitude of neglected terms, the largest of which is typically $\\frac{\\sigma_T^2}{2}r^2$. If the variance $\\sigma_T^2$ is large (broad reproductive schedule) and $|r|$ is large (rapid growth/decline), this term becomes significant, causing the approximation to \"fail badly.\" To determine the direction of the error for a growing population ($r > 0$), we examine the more accurate relation: $rT \\approx \\ln R_0 + \\frac{\\sigma_T^2}{2}r^2$. Solving for $r$ gives $r \\approx \\frac{\\ln R_0}{T} + \\frac{\\sigma_T^2}{2T}r^2$. Since the correction term $\\frac{\\sigma_T^2}{2T}r^2$ is positive (for $\\sigma_T^2>0$), the true value of $r$ is greater than the approximation $r_{approx} = \\frac{\\ln R_0}{T}$. Thus, the approximation underestimates the true $r$. The leading error term in the equation for $\\ln R_0$ is of order $\\sigma_T^2 r^2$, as shown in the derivation. Verdict: **Correct**.\n\nD. The first-order relation is accurate if and only if age-specific survivorship and fertility are constant across ages.\nThis statement is nonsensical. If $\\ell_x$ and $m_x$ were constant for all $x \\geq 0$, the sums defining $R_0$ and $T$ would diverge to infinity, rendering the entire framework meaningless. The condition for exactness is that the net maternity function $\\ell_x m_x$ is a point mass (delta function), not a constant function. The condition for accuracy is small variance of the reproductive schedule and small $|r|$, which has no direct connection to $\\ell_x$ and $m_x$ being constant. The \"if and only if\" condition is patently false. Verdict: **Incorrect**.\n\nE. For populations with $2$ well-separated reproductive peaks of equal weight but the same $R_0$ and $T$ as a unimodal population, the relation remains exact because only $R_0$ and $T$ matter for $r$ to first order, regardless of higher moments of the reproductive age distribution.\nThis statement is fundamentally flawed. First, the relation is not \"exact\" for a bimodal distribution. Exactness is reserved for a single reproductive age. Second, while the first-order approximation $r \\approx (\\ln R_0)/T$ depends only on $R_0$ and $T$, its *accuracy* critically depends on the second moment (variance) and higher moments. A bimodal distribution with the same mean $T$ as a unimodal one will necessarily have a larger variance $\\sigma_T^2$. A larger variance leads to a larger error term $\\frac{\\sigma_T^2}{2}r^2$, making the approximation *less* accurate, not \"exact\". The reasoning confuses the variables used in the approximation with the factors determining its validity. Verdict: **Incorrect**.", "answer": "$$\\boxed{AC}$$", "id": "2491613"}]}