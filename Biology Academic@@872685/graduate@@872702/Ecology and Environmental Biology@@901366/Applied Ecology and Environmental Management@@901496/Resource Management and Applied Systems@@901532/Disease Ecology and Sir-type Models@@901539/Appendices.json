{"hands_on_practices": [{"introduction": "Understanding the long-term, stable behavior of an infectious disease is a central goal of epidemiology. This exercise explores the concept of endemic equilibrium, a state where the incidence of infection remains constant over time due to a balance between new infections and the replenishment of susceptible individuals. By working from the general Kermack-McKendrick renewal equation, you will derive one of the most fundamental and elegant results in disease ecology: the direct relationship between the basic reproduction number, $\\mathcal{R}_0$, and the fraction of the population that remains susceptible. This practice highlights the power of steady-state analysis and reveals a surprisingly simple principle governing disease persistence that holds true regardless of the specific timing of infectiousness during an infection [@problem_id:2480315].", "problem": "Consider a large, homogeneously mixing host population of constant size $N$ maintained by demography with per capita birth and death rate $ \\mu  0$. Individuals experience a single infection that confers permanent immunity (no loss of immunity), and infection does not alter the natural death rate $ \\mu$. Contacts are frequency dependent. Let $J(t)$ denote the incidence (new infections per unit time) at time $t$, $S(t)$ the number susceptible, and assume the infection process is described by a general Kermack–McKendrick renewal formulation with an age-of-infection kernel $K(a)$ defined as follows: for an individual infected at time $0$, $K(a)\\,\\mathrm{d}a$ is the expected number of effective transmission events that this individual generates into a wholly susceptible population during the small interval $[a, a+\\mathrm{d}a)$, with the understanding that $K(a)$ already accounts for survival to infection-age $a$ under the natural mortality rate $ \\mu$. The corresponding renewal system is\n$$\nJ(t) \\;=\\; \\frac{S(t)}{N} \\int_{0}^{\\infty} K(a)\\, J(t-a)\\,\\mathrm{d}a,\n$$\ntogether with conservation $S(t) + I(t) + R(t) = N$, where $I(t)$ and $R(t)$ are the numbers infected and recovered, respectively. The basic reproduction number is defined by\n$$\n\\mathcal{R}_{0} \\;=\\; \\int_{0}^{\\infty} K(a)\\,\\mathrm{d}a,\n$$\nwhich equals the expected number of secondary cases caused by a single typical infectious individual in a wholly susceptible population of size $N$.\n\nAssume that $ \\mathcal{R}_{0}  1$ and an endemic equilibrium with strictly positive, time-constant incidence $J^{\\ast}  0$ exists. Using only the foundational definitions above (mass-action with frequency-dependent transmission, the renewal equation, demographic stationarity, and the definition of the basic reproduction number), determine the endemic susceptible fraction $S^{\\ast}/N$ in closed form as a function of $ \\mathcal{R}_{0}$, independent of any further details of the distributions of recovery times or of within-host infectiousness over infection-age.\n\nThen, justify from first principles why your expression is robust to the exact shape of the infectiousness and recovery-time distributions, provided they are encoded in the kernel $K(a)$ and the assumptions stated above hold. Your final answer must be a single analytic expression involving only $ \\mathcal{R}_{0}$, with no units. Do not round.", "solution": "The problem is scientifically grounded, well-posed, and presented with objective, formal definitions. It is a standard problem in theoretical epidemiology and is therefore valid. We proceed to the solution.\n\nThe analysis begins by considering the system at an endemic equilibrium. By definition, an equilibrium state is one where all state variables are constant in time. Let these constant equilibrium values be denoted by a superscript asterisk ($*$). Thus, we have:\n$S(t) = S^{\\ast}$\n$J(t) = J^{\\ast}$\n\nThe problem states that an endemic equilibrium exists with a strictly positive incidence, $J^{\\ast}  0$. We substitute these equilibrium conditions into the governing Kermack–McKendrick renewal equation:\n$$\nJ(t) \\;=\\; \\frac{S(t)}{N} \\int_{0}^{\\infty} K(a)\\, J(t-a)\\,\\mathrm{d}a\n$$\nAt steady state, $J(t) = J^{\\ast}$ and $J(t-a) = J^{\\ast}$ for all $a \\ge 0$. The equation becomes:\n$$\nJ^{\\ast} \\;=\\; \\frac{S^{\\ast}}{N} \\int_{0}^{\\infty} K(a)\\, J^{\\ast}\\,\\mathrm{d}a\n$$\nSince $J^{\\ast}$ is a constant with respect to the integration variable $a$, it can be factored out of the integral:\n$$\nJ^{\\ast} \\;=\\; \\frac{S^{\\ast}}{N} J^{\\ast} \\int_{0}^{\\infty} K(a)\\,\\mathrm{d}a\n$$\nWe are given that the endemic equilibrium is non-trivial, meaning $J^{\\ast}  0$. Therefore, we can divide both sides of the equation by $J^{\\ast}$:\n$$\n1 \\;=\\; \\frac{S^{\\ast}}{N} \\int_{0}^{\\infty} K(a)\\,\\mathrm{d}a\n$$\nThe problem defines the basic reproduction number, $\\mathcal{R}_{0}$, as the total expected number of secondary infections generated by a single case in a fully susceptible population, given by the integral of the infection-age kernel:\n$$\n\\mathcal{R}_{0} \\;=\\; \\int_{0}^{\\infty} K(a)\\,\\mathrm{d}a\n$$\nSubstituting this definition into our simplified equilibrium equation yields:\n$$\n1 \\;=\\; \\frac{S^{\\ast}}{N} \\mathcal{R}_{0}\n$$\nSolving for the endemic susceptible fraction, $S^{\\ast}/N$, we arrive at the result:\n$$\n\\frac{S^{\\ast}}{N} \\;=\\; \\frac{1}{\\mathcal{R}_{0}}\n$$\n\nThe justification for why this expression is robust to the specific shape of the infectiousness kernel $K(a)$ is inherent in the derivation. At a steady state, the flow of new infections into the population is constant. For this to occur, each infected individual must, on average, produce exactly one new infection to replace itself in the chain of transmission. The basic reproduction number, $\\mathcal{R}_{0}$, represents the potential reproductive capacity of an infection in an entirely susceptible environment. In the endemic state, this potential is reduced by the fact that only a fraction of the population, $S^{\\ast}/N$, is susceptible.\n\nThe expression for the effective reproduction number, $\\mathcal{R}_{e}$, which is the average number of secondary cases per infection in the current state of the population, is $\\mathcal{R}_{e} = \\mathcal{R}_{0} \\frac{S(t)}{N}$. The condition for a constant level of infection (i.e., endemic equilibrium) is precisely that $\\mathcal{R}_{e} = 1$. This directly gives $1 = \\mathcal{R}_{0} \\frac{S^{\\ast}}{N}$, leading to the same result.\n\nThe key insight is that the steady-state condition considers the integrated, or total, effect of an infection over its entire duration. The integral $\\int_{0}^{\\infty} K(a)\\,\\mathrm{d}a$ collapses the entire time-course of infectiousness—whether it peaks early, late, or remains constant—into a single scalar value, $\\mathcal{R}_{0}$. The equilibrium state of the system is only sensitive to this total reproductive output, not the temporal pattern through which it is achieved. Any two different kernels, $K_{1}(a)$ and $K_{2}(a)$, that have the same area under the curve, $\\int K_{1}(a)\\,\\mathrm{d}a = \\int K_{2}(a)\\,\\mathrm{d}a = \\mathcal{R}_{0}$, will produce the identical endemic susceptible fraction $S^{\\ast}/N = 1/\\mathcal{R}_{0}$. The dynamics of how the system approaches this equilibrium will depend on the shape of $K(a)$, but the final equilibrium state itself will not. This is a fundamental property of the stationary analysis of such renewal processes.", "answer": "$$\n\\boxed{\\frac{1}{\\mathcal{R}_{0}}}\n$$", "id": "2480315"}, {"introduction": "The ability of a pathogen to invade a host population depends critically on the assumptions we make about how transmission occurs. This exercise challenges you to build and analyze SIR models based on two distinct, widely used frameworks for the force of infection: density-dependent and frequency-dependent transmission. By deriving the invasion threshold for each model, you will uncover how the predicted conditions for an epidemic takeoff are fundamentally tied to whether contact rates are assumed to depend on the absolute number or the proportion of infectious individuals [@problem_id:2480318]. This practice provides essential insight into the crucial role of model structure in epidemiology and its implications for public health interventions.", "problem": "A homogeneously mixing host population of constant size $N$ is modeled with a Susceptible-Infectious-Recovered (SIR) framework, where $S(t)$, $I(t)$, and $R(t)$ denote the numbers of susceptible, infectious, and recovered hosts at time $t$, respectively, and $S(t)+I(t)+R(t)=N$ for all $t$. Individuals recover at a per capita rate $\\gamma0$. Assume a short invasion phase with no births or deaths, so that $N$ is constant.\n\nTwo alternative formulations of the force of infection are considered, based on widely used assumptions about how contact rates scale with population size:\n1. Density-dependent (mass-action) incidence: the per capita force of infection on a susceptible is proportional to the density of infectious hosts.\n2. Frequency-dependent incidence: the per capita force of infection on a susceptible is proportional to the fraction of infectious hosts.\n\nStarting from these first principles and core definitions, do the following:\n- Derive the SIR differential equations for the density-dependent case with transmission parameter $\\beta_{D}0$, and for the frequency-dependent case with transmission parameter $\\beta_{F}0$.\n- Using a linearization about the disease-free state during the initial invasion phase (with $I(t)$ small and $S(t)\\approx S_{0}$ treated as quasi-constant over this short time), derive the invasion threshold in terms of the critical susceptible pool $S_{\\mathrm{crit}}$ for each case; that is, the minimal value of $S_{0}$ such that $I(t)$ initially increases.\n- Express the ratio of the critical susceptible thresholds between the frequency-dependent and density-dependent cases, $S_{\\mathrm{crit}}^{F}/S_{\\mathrm{crit}}^{D}$, as a closed-form expression in terms of $N$, $\\beta_{D}$, $\\beta_{F}$, and $\\gamma$.\n\nYour final answer must be a single closed-form analytic expression for $S_{\\mathrm{crit}}^{F}/S_{\\mathrm{crit}}^{D}$. Do not include any units. No numerical approximation or rounding is required.", "solution": "The problem requires the derivation of a ratio between the critical susceptible population thresholds for two distinct formulations of the force of infection in an SIR model: density-dependent and frequency-dependent. The analysis proceeds by first principles.\n\nFirst, we formulate the system of differential equations for the density-dependent (mass-action) case. The problem states that the per capita force of infection on a susceptible individual is proportional to the density of infectious hosts. In a homogeneously mixing population of constant size $N$, the density of infectious individuals can be taken to be proportional to their number, $I(t)$. Thus, the per capita force of infection, $\\lambda_D(t)$, is given by $\\lambda_D(t) = \\beta_D I(t)$, where $\\beta_D  0$ is the transmission parameter. The total rate of new infections is the product of the number of susceptibles, $S(t)$, and the per capita force of infection. Infected individuals recover at a constant per capita rate $\\gamma  0$. The governing SIR equations are:\n$$\n\\frac{dS}{dt} = - \\beta_D S(t) I(t)\n$$\n$$\n\\frac{dI}{dt} = \\beta_D S(t) I(t) - \\gamma I(t)\n$$\n$$\n\\frac{dR}{dt} = \\gamma I(t)\n$$\n\nNext, we formulate the equations for the frequency-dependent case. Here, the per capita force of infection is proportional to the fraction of infectious hosts in the population, which is $\\frac{I(t)}{N}$. The per capita force of infection, $\\lambda_F(t)$, is $\\lambda_F(t) = \\beta_F \\frac{I(t)}{N}$, with $\\beta_F  0$ as the transmission parameter. The corresponding SIR equations are:\n$$\n\\frac{dS}{dt} = - \\beta_F \\frac{S(t) I(t)}{N}\n$$\n$$\n\\frac{dI}{dt} = \\beta_F \\frac{S(t) I(t)}{N} - \\gamma I(t)\n$$\n$$\n\\frac{dR}{dt} = \\gamma I(t)\n$$\n\nThe invasion threshold is determined by the condition for the initial growth of the infectious population, i.e., $\\frac{dI}{dt}  0$ when the disease is introduced. At this early stage, the number of infected individuals $I(t)$ is very small, and the susceptible population $S(t)$ can be approximated as its initial value, $S(t) \\approx S_0$.\n\nFor the density-dependent model, the rate of change of the infected population is:\n$$\n\\frac{dI}{dt} = (\\beta_D S(t) - \\gamma) I(t)\n$$\nFor an invasion to occur, we require $\\frac{dI}{dt}  0$. Since $I(t)  0$, this condition becomes $\\beta_D S(t) - \\gamma  0$. At the moment of invasion ($S(t) \\approx S_0$), the condition is $\\beta_D S_0  \\gamma$, or $S_0  \\frac{\\gamma}{\\beta_D}$. The critical susceptible pool, $S_{\\mathrm{crit}}^D$, is the minimum value of $S_0$ for which this inequality holds. This corresponds to the boundary condition $\\frac{dI}{dt} = 0$.\n$$\nS_{\\mathrm{crit}}^D = \\frac{\\gamma}{\\beta_D}\n$$\n\nFor the frequency-dependent model, the rate of change of the infected population is:\n$$\n\\frac{dI}{dt} = \\left(\\beta_F \\frac{S(t)}{N} - \\gamma\\right) I(t)\n$$\nThe invasion condition $\\frac{dI}{dt}  0$ implies $\\beta_F \\frac{S(t)}{N} - \\gamma  0$. At the initial stage ($S(t) \\approx S_0$), this becomes $\\beta_F \\frac{S_0}{N}  \\gamma$, or $S_0  \\frac{\\gamma N}{\\beta_F}$. The critical susceptible pool for the frequency-dependent case, $S_{\\mathrm{crit}}^F$, is therefore:\n$$\nS_{\\mathrm{crit}}^F = \\frac{\\gamma N}{\\beta_F}\n$$\n\nFinally, we compute the ratio of the critical susceptible thresholds, $\\frac{S_{\\mathrm{crit}}^F}{S_{\\mathrm{crit}}^D}$. Substituting the derived expressions:\n$$\n\\frac{S_{\\mathrm{crit}}^F}{S_{\\mathrm{crit}}^D} = \\frac{\\left(\\frac{\\gamma N}{\\beta_F}\\right)}{\\left(\\frac{\\gamma}{\\beta_D}\\right)}\n$$\nSimplifying the compound fraction leads to:\n$$\n\\frac{S_{\\mathrm{crit}}^F}{S_{\\mathrm{crit}}^D} = \\frac{\\gamma N}{\\beta_F} \\cdot \\frac{\\beta_D}{\\gamma}\n$$\nThe recovery rate parameter $\\gamma$ cancels from the numerator and the denominator, yielding the final closed-form expression for the ratio:\n$$\n\\frac{S_{\\mathrm{crit}}^F}{S_{\\mathrm{crit}}^D} = \\frac{N \\beta_D}{\\beta_F}\n$$\nThis expression relates the thresholds in terms of the total population size $N$ and the transmission parameters $\\beta_D$ and $\\beta_F$ from each model.", "answer": "$$\\boxed{\\frac{N \\beta_D}{\\beta_F}}$$", "id": "2480318"}, {"introduction": "Moving from theoretical models to practical epidemic management requires tools to interpret real-world incidence data. This hands-on practice guides you through the derivation and implementation of the Wallinga-Teunis method, a cornerstone of modern epidemiological surveillance used to estimate the time-varying case reproduction number, $R_t$. You will start from first principles, viewing transmission as a renewal process, and translate this theory into a functional computer program [@problem_id:2480397]. This exercise bridges the gap between theory and application, equipping you with the skills to analyze incidence data and critically assess how sensitive your conclusions are to underlying assumptions like the generation interval distribution.", "problem": "You are asked to derive and implement the Wallinga–Teunis (WT) estimator of the time-varying case reproduction number from incidence time series in the context of Susceptible–Infectious–Removed (SIR) type models in disease ecology. Your derivation must start from the definition of the generation-interval distribution and the renewal description of transmission, without assuming any pre-existing WT formulas. You must then translate your derivation into a runnable program that computes the WT case reproduction number series from daily incidence and a discrete generation-interval probability mass function, and uses it to evaluate sensitivity when the generation-interval distribution is misspecified.\n\nThe scientific starting points you may use are the following fundamental definitions and facts:\n- A discrete-time generation-interval distribution is a probability mass function $w_s$ on lags $s \\in \\{1,2,\\dots,L\\}$ with $\\sum_{s=1}^{L} w_s = 1$, where $w_s$ is the probability that a secondary infection occurs $s$ days after its infector’s infection time.\n- The renewal representation of expected incidence states that, for a series of daily incidence $I_t$ and a time-varying case reproduction number $R_t$, the expected incidence at time $t$ satisfies $\\mathbb{E}[I_t] = \\sum_{s=1}^{L} R_{t-s} I_{t-s} w_s$.\n\nFrom these principles, derive an expression for the WT case reproduction number for each day $t$ that depends only on the observed incidence $I_t$ and the generation-interval distribution $w_s$. Your derivation must account for the fact that infections at day $u$ can be attributed probabilistically to potential infectors on earlier days in proportion to their incidence and the generation-interval probabilities. Carefully handle boundary conditions created by finite observation windows.\n\nImplementation requirements:\n- Given an incidence time series $(I_0,\\dots,I_{T-1})$ and a generation-interval probability mass function $(w_1,\\dots,w_L)$ with support on lags $1$ through $L$, compute the WT case reproduction number $R_t$ for each day $t$ where it is well-defined. If $I_t = 0$, treat $R_t$ as undefined for that day and exclude it from any averaging. If, for a recipient day $u$, the required denominator that aggregates contributions from all potential infectors is zero, exclude that day $u$ from the sums that define $R_t$.\n- To reduce right-censoring bias, when computing summary statistics (means across $t$), only include times $t$ satisfying $t \\le T-1-L$.\n\nSensitivity analysis requirement:\n- For each test case below, compute the average WT reproduction number using the true generation-interval distribution $w^{\\mathrm{true}}$ and also using a misspecified distribution $w^{\\mathrm{mis}}$. Report both averages and their difference (misspecified minus true).\n\nTest suite:\n- Test case A (growing epidemic, renewal-generated incidence):\n  - Horizon $T = 25$, initial incidence $I_0 = 10$, constant true reproduction number $R^{\\mathrm{true}} = 1.3$.\n  - True generation-interval distribution with support $L = 5$: $w^{\\mathrm{true}} = (w_1,\\dots,w_5) = (0.3, 0.4, 0.2, 0.07, 0.03)$.\n  - Misspecified generation-interval distribution: $w^{\\mathrm{mis}} = (0.5, 0.3, 0.15, 0.04, 0.01)$.\n  - Generate incidence deterministically from the renewal expectation: for $t \\in \\{1,\\dots,T-1\\}$, set $I_t = R^{\\mathrm{true}} \\sum_{s=1}^{\\min(L,t)} I_{t-s} w_s$.\n- Test case B (declining epidemic, renewal-generated incidence):\n  - Horizon $T = 30$, initial incidence $I_0 = 50$, constant true reproduction number $R^{\\mathrm{true}} = 0.8$.\n  - True generation-interval distribution with support $L = 5$: $w^{\\mathrm{true}} = (0.3, 0.4, 0.2, 0.07, 0.03)$.\n  - Misspecified generation-interval distribution: $w^{\\mathrm{mis}} = (0.1, 0.2, 0.3, 0.25, 0.15)$.\n  - Generate incidence deterministically from the renewal expectation as in Test case A.\n- Test case C (edge case with zeros in incidence and a non-renewal sequence):\n  - Horizon $T = 12$, incidence specified directly as $I = (0, 5, 0, 10, 0, 8, 4, 0, 1, 0, 0, 3)$.\n  - True generation-interval distribution with support $L = 3$: $w^{\\mathrm{true}} = (0.6, 0.3, 0.1)$.\n  - Misspecified generation-interval distribution: $w^{\\mathrm{mis}} = (0.05, 0.15, 0.8)$.\n\nOutput specification:\n- For each test case, compute three floats:\n  1. The average WT reproduction number using $w^{\\mathrm{true}}$ over days $t$ with $I_t  0$ and $t \\le T-1-L$.\n  2. The average WT reproduction number using $w^{\\mathrm{mis}}$ over the same set of $t$.\n  3. The difference between these two averages (misspecified minus true).\n- Your program should produce a single line of output containing the results for the three test cases concatenated in order A, B, C, as a comma-separated list enclosed in square brackets, for a total of nine numbers. For example, the output format must be exactly of the form $[x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8,x_9]$ with each $x_i$ a float. Round each float to $6$ decimal places before printing. Angles are not used, and there are no physical units to report.\n\nYour program must be a complete, runnable program that takes no input and prints only the single required output line.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. All definitions, data, and constraints are provided and are mutually consistent. It is a valid problem in computational epidemiology.\n\nThe task is to derive and implement the Wallinga-Teunis (WT) estimator for the time-varying case reproduction number, $R_t$. The number $R_t$ represents the average number of secondary infections generated by an individual infected at time $t$. The derivation proceeds from the principle of attributing new infections to past infectors.\n\nLet $I_t$ be the number of new infections (incidence) at discrete time $t$. Let $w_s$ be the probability mass function of the generation interval, representing the probability that the time between the infection of a primary case and a secondary case is $s$ days, for $s \\in \\{1, 2, \\dots, L\\}$. We have $\\sum_{s=1}^{L} w_s = 1$.\n\nConsider the cohort of $I_t$ individuals infected at time $t$. We wish to find the total number of secondary infections they produce, which, when divided by $I_t$, gives $R_t$. These secondary infections occur at future times $u  t$.\n\nThe WT method estimates the contribution of the cohort from time $t$ to the incidence at a future time $u=t+s$. The total \"infectious pressure\" or transmission potential, $\\Lambda_u$, that generates the $I_u$ cases at time $u$ is the sum of contributions from all possible antecedent infector cohorts. A cohort of size $I_k$ contributes in proportion to its size and the probability of the relevant generation interval, $w_{u-k}$. Thus, the total infectious pressure leading to infections on day $u$ is:\n$$\n\\Lambda_u = \\sum_{j=1}^{L} I_{u-j} w_j\n$$\nThis sum is over all possible generation intervals $j \\in \\{1, \\dots, L\\}$. The indices $u-j$ must be non-negative, as incidence is zero for negative time; within a finite observation window $(I_0, \\dots, I_{T-1})$, any $I_k$ with $k  0$ is implicitly zero.\n\nThe proportion of infections at time $u$ that can be attributed to the cohort infected at time $t  u$ is the ratio of the infectious pressure from cohort $t$ to the total infectious pressure at $u$. This proportion is:\n$$\np_{t \\to u} = \\frac{I_t w_{u-t}}{\\Lambda_u} = \\frac{I_t w_{u-t}}{\\sum_{j=1}^{L} I_{u-j} w_j}\n$$\nThe estimated number of infections at time $u$ caused by the cohort from time $t$, denoted $\\hat{C}_{t,u}$, is this proportion multiplied by the total incidence at time $u$:\n$$\n\\hat{C}_{t,u} = I_u \\cdot p_{t \\to u} = I_u \\frac{I_t w_{u-t}}{\\sum_{j=1}^{L} I_{u-j} w_j}\n$$\nThe total number of secondary cases generated by the entire cohort of $I_t$ individuals is the sum of these contributions over all possible future infection times $u = t+1$, $\\dots$, $u=t+L$, where $s \\in \\{1, \\dots, L\\}$.\n$$\n\\text{Total secondary infections from cohort } t = \\sum_{u=t+1}^{t+L} \\hat{C}_{t,u} = \\sum_{u=t+1}^{t+L} I_u \\frac{I_t w_{u-t}}{\\sum_{j=1}^{L} I_{u-j} w_j}\n$$\nThe case reproduction number $R_t$ is the average number of secondary infections per individual in the cohort of size $I_t$. Assuming $I_t  0$, we divide the total by $I_t$:\n$$\nR_t = \\frac{1}{I_t} \\sum_{u=t+1}^{t+L} I_u \\frac{I_t w_{u-t}}{\\sum_{j=1}^{L} I_{u-j} w_j} = \\sum_{u=t+1}^{t+L} \\frac{I_u w_{u-t}}{\\sum_{j=1}^{L} I_{u-j} w_j}\n$$\nBy substituting the summation index with the generation interval $s = u-t$, the expression becomes:\n$$\nR_t = \\sum_{s=1}^{L} \\frac{I_{t+s} w_s}{\\sum_{j=1}^{L} I_{t+s-j} w_j}\n$$\nThis is the derived WT estimator for the cohort reproduction number. If $I_t=0$, $R_t$ is undefined. If the denominator $\\Lambda_{t+s} = \\sum_{j=1}^{L} I_{t+s-j} w_j$ is zero for a particular $s$, that term's contribution to the sum for $R_t$ is zero.\n\nThe implementation consists of two main functions. First, a function to generate the incidence time series for Test cases A and B. Given an initial incidence $I_0$, a time horizon $T$, a true generation interval distribution $w^{\\mathrm{true}}$, and a true constant reproduction number $R^{\\mathrm{true}}$, the incidence $I_t$ for $t \\in \\{1,\\dots,T-1\\}$ is generated deterministically via the provided renewal equation:\n$$\nI_t = R^{\\mathrm{true}} \\sum_{s=1}^{\\min(L,t)} I_{t-s} w^{\\mathrm{true}}_s\n$$\nThe term $\\min(L,t)$ correctly handles boundary conditions at the start of the epidemic.\n\nSecond, a function to compute the average WT reproduction number from an incidence series $I = (I_0, \\dots, I_{T-1})$ and a generation interval distribution $w = (w_1, \\dots, w_L)$. This function implements the derived formula for $R_t$. It iterates through each time $t$ in the valid range $0 \\le t \\le T-1-L$. This upper bound on $t$ is required to avoid right-censoring bias, as the calculation of $R_t$ requires incidence data up to time $t+L$. For each valid $t$, if $I_t  0$, the function calculates $R_t$ by summing the terms over $s \\in \\{1, \\dots, L\\}$. For each term, it first computes the denominator $\\Lambda_{t+s}$. If this denominator is positive, the term $\\frac{I_{t+s} w_s}{\\Lambda_{t+s}}$ is added to the sum for $R_t$. Finally, the function returns the arithmetic mean of all computed $R_t$ values.\n\nThe sensitivity analysis compares the average $R_t$ computed with the true generation interval, $\\bar{R}_{\\mathrm{true}}$, to that computed with a misspecified one, $\\bar{R}_{\\mathrm{mis}}$. Their difference, $\\bar{R}_{\\mathrm{mis}} - \\bar{R}_{\\mathrm{true}}$, quantifies the estimation bias due to model misspecification. In a growing epidemic ($R  1$), a misspecified generation interval distribution that is more front-loaded (shorter mean generation time) than the true one typically leads to an underestimation of $R_t$. Conversely, in a declining epidemic ($R  1$), a misspecified distribution that is more back-loaded (longer mean generation time) also tends to cause an underestimation of $R_t$. These effects arise because the estimator structure is sensitive to the relative timing of incidence, which is shaped by the generation interval.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef generate_incidence(I0, T, L, w_true, R_true):\n    \"\"\"\n    Generates a deterministic incidence series based on the renewal equation.\n    \"\"\"\n    I = np.zeros(T, dtype=float)\n    I[0] = float(I0)\n    w = np.array(w_true, dtype=float)\n    for t in range(1, T):\n        # The sum is over s from 1 to min(L, t), as specified.\n        # This handles the boundary condition for early times.\n        limit_s = min(L, t)\n        weighted_sum = 0.0\n        for s in range(1, limit_s + 1):\n            weighted_sum += I[t-s] * w[s-1]\n        I[t] = R_true * weighted_sum\n    return I\n\ndef compute_avg_R(I, w):\n    \"\"\"\n    Computes the average Wallinga-Teunis reproduction number.\n    \"\"\"\n    T = len(I)\n    w = np.array(w, dtype=float)\n    L = len(w)\n    \n    R_values = []\n    # Averaging window for t to avoid right-censoring bias\n    t_max = T - 1 - L\n    \n    for t in range(t_max + 1):\n        # R_t is defined for cohorts with I_t  0\n        if I[t] = 0:\n            continue\n            \n        Rt = 0.0\n        # Sum over s from 1 to L to get contributions from future infections\n        for s in range(1, L + 1):\n            u = t + s # Time of secondary infection\n            \n            # The index u is at most (T-1-L)+L = T-1, which is a valid index for I.\n            \n            # Calculate the denominator (total infectious pressure at time u)\n            lambda_u = 0.0\n            # Sum over j from 1 to L for possible generation intervals\n            for j in range(1, L + 1):\n                idx = u - j\n                if idx = 0:\n                    lambda_u += I[idx] * w[j-1]\n\n            # Add term to Rt if the denominator is non-zero\n            if lambda_u  0:\n                numerator = I[u] * w[s-1]\n                term = numerator / lambda_u\n                Rt += term\n        \n        R_values.append(Rt)\n        \n    # Return the mean of valid R_t values.\n    # An empty list should not occur for the given test cases.\n    if not R_values:\n        return 0.0 \n    \n    return np.mean(R_values)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    all_results = []\n    \n    # Test case A\n    T_A = 25\n    I0_A = 10.0\n    R_true_A = 1.3\n    w_true_A = [0.3, 0.4, 0.2, 0.07, 0.03]\n    L_A = len(w_true_A)\n    w_mis_A = [0.5, 0.3, 0.15, 0.04, 0.01]\n    \n    I_A = generate_incidence(I0_A, T_A, L_A, w_true_A, R_true_A)\n    \n    avg_R_true_A = compute_avg_R(I_A, w_true_A)\n    avg_R_mis_A = compute_avg_R(I_A, w_mis_A)\n    diff_A = avg_R_mis_A - avg_R_true_A\n    all_results.extend([avg_R_true_A, avg_R_mis_A, diff_A])\n    \n    # Test case B\n    T_B = 30\n    I0_B = 50.0\n    R_true_B = 0.8\n    w_true_B = [0.3, 0.4, 0.2, 0.07, 0.03]\n    L_B = len(w_true_B)\n    w_mis_B = [0.1, 0.2, 0.3, 0.25, 0.15]\n    \n    I_B = generate_incidence(I0_B, T_B, L_B, w_true_B, R_true_B)\n    \n    avg_R_true_B = compute_avg_R(I_B, w_true_B)\n    avg_R_mis_B = compute_avg_R(I_B, w_mis_B)\n    diff_B = avg_R_mis_B - avg_R_true_B\n    all_results.extend([avg_R_true_B, avg_R_mis_B, diff_B])\n    \n    # Test case C\n    I_C = np.array([0, 5, 0, 10, 0, 8, 4, 0, 1, 0, 0, 3], dtype=float)\n    w_true_C = [0.6, 0.3, 0.1]\n    w_mis_C = [0.05, 0.15, 0.8]\n\n    avg_R_true_C = compute_avg_R(I_C, w_true_C)\n    avg_R_mis_C = compute_avg_R(I_C, w_mis_C)\n    diff_C = avg_R_mis_C - avg_R_true_C\n    all_results.extend([avg_R_true_C, avg_R_mis_C, diff_C])\n    \n    # Format and print the final output as a single line.\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution.\nsolve()\n```", "id": "2480397"}]}