{"hands_on_practices": [{"introduction": "To understand the risks faced by small populations, we must first quantify how genetic diversity is lost over time. This exercise guides you through a first-principles derivation of the decay of expected heterozygosity, $H_t$, in an idealized population of effective size $N_e$. By solving this fundamental recursion [@problem_id:2494469], you will establish the direct mathematical relationship between effective population size and the rate at which a population loses the genetic variation essential for adaptation.", "problem": "A closed, randomly mating, diploid population follows the Wright–Fisher model with constant effective population size $N_{e}$. You are studying a single neutral locus with no mutation, migration, or selection. Let $H_{t}$ denote the expected heterozygosity (the probability that two alleles sampled at random from generation $t$ are of different allelic states), and let $F_{t}$ denote the inbreeding coefficient (the probability that two alleles sampled at random from generation $t$ are identical by descent).\n\nStarting from the foundational definitions of $H_{t}$ and $F_{t}$ and the random union of gametes in a diploid population of size $N_{e}$, derive a first-principles recursion for $H_{t+1}$ in terms of $H_{t}$ and $N_{e}$, and then solve this recursion in closed form for $H_{t}$ as a function of $H_{0}$, $N_{e}$, and $t$.\n\nApply your result to a population with initial heterozygosity $H_{0} = 0.8$ and effective population size $N_{e} = 100$ to compute the expected heterozygosity after $t = 50$ generations, $H_{50}$, and the fraction of initial genetic diversity retained after $50$ generations, $H_{50}/H_{0}$. Express both requested quantities as pure numbers (no units). Round your numerical answers to four significant figures.", "solution": "We work under the Wright–Fisher assumptions: a closed, randomly mating, diploid population with constant effective size $N_{e}$, discrete generations, and a neutral locus with no mutation, migration, or selection. Let $H_{t}$ be the expected heterozygosity at generation $t$, and let $F_{t}$ be the inbreeding coefficient, the probability that two alleles sampled at random from generation $t$ are identical by descent.\n\nFundamental definitions and facts:\n- By definition, $F_{t}$ is the probability of identity by descent; under no mutation, identity by state coincides with identity by descent through time, so the expected heterozygosity is related to $F_{t}$ via the complement. More precisely, the probability that two sampled alleles are different equals the probability that they are not identical by descent propagated from the initial state. This yields the standard relation\n$$\nH_{t} = H_{0}\\bigl(1 - F_{t}\\bigr),\n$$\nwhich is a well-tested result connecting expected heterozygosity to the inbreeding coefficient.\n- Under random union of gametes in a diploid population of effective size $N_{e}$, the probability that two alleles sampled in generation $t+1$ coalesce in the immediately preceding generation (i.e., are copies of the same parental gene copy) is\n$$\n\\frac{1}{2N_{e}}.\n$$\nIf they do not coalesce immediately (probability $1 - \\frac{1}{2N_{e}}$), then their identity by descent is whatever it was in the previous generation. This leads to the classic recursion for the inbreeding coefficient:\n$$\nF_{t+1} \\;=\\; \\frac{1}{2N_{e}} \\;+\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) F_{t}.\n$$\n\nFrom the relation between $H_{t}$ and $F_{t}$, we derive the recursion for heterozygosity. Take complements on both sides of the $F$-recursion:\n\n$$\n1 - F_{t+1} \\;=\\; 1 - \\frac{1}{2N_{e}} - \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) F_{t}\n\\;=\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr)\\bigl(1 - F_{t}\\bigr).\n$$\n\nMultiplying both sides by $H_{0}$ and using $H_{t} = H_{0}(1 - F_{t})$ gives\n\n$$\nH_{t+1} \\;=\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) H_{t}.\n$$\n\nThis first-order linear difference equation solves by iteration to\n\n$$\nH_{t} \\;=\\; H_{0}\\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr)^{t}.\n$$\n\n\nWe now apply this to $H_{0} = 0.8$, $N_{e} = 100$, and $t = 50$. Compute the per-generation retention factor:\n\n$$\n1 - \\frac{1}{2N_{e}} \\;=\\; 1 - \\frac{1}{200} \\;=\\; \\frac{199}{200} \\;=\\; 0.995.\n$$\n\nTherefore,\n\n$$\nH_{50} \\;=\\; 0.8 \\times 0.995^{50}.\n$$\n\nTo compute the fraction of initial diversity retained after $50$ generations, we form\n\n$$\n\\frac{H_{50}}{H_{0}} \\;=\\; 0.995^{50}.\n$$\n\n\nWe now evaluate $0.995^{50}$. Using repeated squaring or logarithms yields\n\n$$\n0.995^{50} \\approx 0.7783151801\\ldots\n$$\n\nThus,\n\n$$\nH_{50} \\;=\\; 0.8 \\times 0.7783151801\\ldots \\;\\approx\\; 0.6226521441\\ldots\n$$\n\n\nRounding to four significant figures:\n- $H_{50} \\approx 0.6227$,\n- $H_{50}/H_{0} \\approx 0.7783$.\n\nBoth quantities are dimensionless, as requested.", "answer": "$$\n\\boxed{\\begin{pmatrix}0.6227 & 0.7783\\end{pmatrix}}\n$$", "id": "2494469"}, {"introduction": "While the model of steady decay is foundational, real-world populations often experience dramatic fluctuations in size. This practice explores the genetic consequences of a population bottleneck—a severe but temporary reduction in size, followed by a recovery [@problem_id:2494492]. By tracking heterozygosity through this dynamic history, you will see how the total loss of genetic diversity is disproportionately influenced by the period with the smallest effective population size, a principle with profound implications for conservation management.", "problem": "A closed, randomly mating, diploid population follows the standard Wright–Fisher model with discrete, non-overlapping generations, neutrality, and no mutation or migration. The effective population size ($N_e$) was historically large at $N_e=2000$ for a long time such that standing expected heterozygosity just before a demographic contraction is $H_0$. The population then undergoes a two-step demographic change: for the next $10$ generations, $N_e=50$, after which $N_e$ increases to $500$ and remains at that level. Let $T \\geq 0$ denote the number of generations elapsed at $N_e=500$ after the $10$-generation bottleneck ends.\n\nUsing only fundamental definitions relating expected heterozygosity to identity by descent and standard neutral genetic drift under the Wright–Fisher model, derive an exact closed-form expression, in terms of $T$, for the expected proportional loss of heterozygosity at generation $10+T$ relative to $H_0$. Your final answer must be a single closed-form analytic expression in $T$. In your derivation, justify briefly why the magnitude of the loss is especially sensitive to the smallest realized $N_e$ during the history described. Do not use or cite any pre-derived shortcut formulas beyond first principles of neutral drift and identity by descent. Do not report a percentage; express the proportional loss as a unitless decimal or algebraic expression.", "solution": "The fundamental principle governing the change in genetic variation due to drift in the Wright–Fisher model is the change in the probability of identity by descent, denoted as $F$. For a diploid population of effective size $N_e$, consider two gene copies sampled at random in generation $t$. These two copies can be identical by descent (IBD) through two mutually exclusive pathways:\n1. They are copies of the very same parental gene copy from generation $t-1$. In a population of $N_e$ diploid individuals, there are $2N_e$ gene copies in the gene pool. The probability of sampling the same gene copy twice with replacement is $\\frac{1}{2N_e}$.\n2. They are copies of two distinct parental gene copies from generation $t-1$. The probability of this event is $1 - \\frac{1}{2N_e}$. For these two copies to be IBD, their distinct parental copies must have themselves been IBD. The probability of this is $F_{t-1}$.\n\nCombining these pathways, the recurrence relation for the probability of identity by descent is:\n$$F_t = \\frac{1}{2N_e} + \\left(1 - \\frac{1}{2N_e}\\right) F_{t-1}$$\nExpected heterozygosity, $H_t$, is defined as the probability that two randomly sampled gene copies are *not* identical by descent. Thus, $H_t = 1 - F_t$. We can substitute this relationship into the recurrence for $F_t$ to derive the dynamics of $H_t$.\n$$1 - H_t = \\frac{1}{2N_e} + \\left(1 - \\frac{1}{2N_e}\\right) (1 - H_{t-1})$$\n$$1 - H_t = \\frac{1}{2N_e} + 1 - H_{t-1} - \\frac{1}{2N_e} + \\frac{H_{t-1}}{2N_e}$$\n$$-H_t = -H_{t-1} + \\frac{H_{t-1}}{2N_e}$$\n$$H_t = H_{t-1} \\left(1 - \\frac{1}{2N_e}\\right)$$\nThis is the fundamental first-principles equation for the decay of heterozygosity over one generation of random genetic drift. The problem statement requires us to apply this equation sequentially through the specified demographic history.\n\nThe history consists of two phases of change starting from an initial heterozygosity $H_0$.\n\nPhase 1: Bottleneck\nFor the first $t = 10$ generations, the effective population size is $N_{e,1} = 50$. The heterozygosity at the end of each generation is a fraction $\\left(1 - \\frac{1}{2N_{e,1}}\\right)$ of the heterozygosity at the start of that generation.\nThe factor for one generation is:\n$$1 - \\frac{1}{2 \\times 50} = 1 - \\frac{1}{100} = \\frac{99}{100}$$\nAfter $10$ such generations, the heterozygosity, which we denote as $H_{10}$, will be:\n$$H_{10} = H_0 \\left(1 - \\frac{1}{100}\\right)^{10} = H_0 \\left(\\frac{99}{100}\\right)^{10}$$\n\nPhase 2: Recovery\nAfter the $10$-generation bottleneck, the population size increases to $N_{e,2} = 500$ and remains at this level for $T$ generations. The initial heterozygosity for this phase is $H_{10}$.\nThe decay factor for one generation in this phase is:\n$$1 - \\frac{1}{2N_{e,2}} = 1 - \\frac{1}{2 \\times 500} = 1 - \\frac{1}{1000} = \\frac{999}{1000}$$\nLet $H_{10+T}$ be the heterozygosity after $T$ generations at $N_e = 500$. This is calculated relative to the heterozygosity at the beginning of this phase, $H_{10}$:\n$$H_{10+T} = H_{10} \\left(1 - \\frac{1}{1000}\\right)^T = H_{10} \\left(\\frac{999}{1000}\\right)^T$$\n\nTo find the final heterozygosity $H_{10+T}$ relative to the initial heterozygosity $H_0$, we substitute the expression for $H_{10}$:\n$$H_{10+T} = \\left[H_0 \\left(\\frac{99}{100}\\right)^{10}\\right] \\left(\\frac{999}{1000}\\right)^T = H_0 \\left(\\frac{99}{100}\\right)^{10} \\left(\\frac{999}{1000}\\right)^T$$\n\nThe problem asks for the proportional loss of heterozygosity at generation $10+T$ relative to $H_0$. This is defined as $\\frac{H_0 - H_{10+T}}{H_0}$.\n$$\\text{Proportional Loss} = \\frac{H_0 - H_{10+T}}{H_0} = 1 - \\frac{H_{10+T}}{H_0}$$\nSubstituting the expression for the ratio $\\frac{H_{10+T}}{H_0}$:\n$$\\frac{H_{10+T}}{H_0} = \\left(\\frac{99}{100}\\right)^{10} \\left(\\frac{999}{1000}\\right)^T$$\nTherefore, the proportional loss is:\n$$\\text{Proportional Loss} = 1 - \\left(\\frac{99}{100}\\right)^{10} \\left(\\frac{999}{1000}\\right)^T$$\nThis is the required exact, closed-form expression in terms of $T$.\n\nFinally, we must justify why the magnitude of heterozygosity loss is especially sensitive to the smallest realized $N_e$. The rate of loss of heterozygosity per generation is approximately $\\frac{1}{2N_e}$. This shows an inverse relationship between the rate of loss and the effective population size. When $N_e$ is small, the factor $\\left(1 - \\frac{1}{2N_e}\\right)$ by which heterozygosity is multiplied each generation is smallest, thus leading to the most rapid decay. Total heterozygosity retention over multiple generations is a product of these factors across time: $H_{\\text{final}} = H_0 \\prod_{i=1}^{t} \\left(1 - \\frac{1}{2N_{e,i}}\\right)$. In a product of terms less than $1$, the smallest terms have a disproportionately large effect on reducing the final value. In this specific problem, the per-generation loss rate during the bottleneck ($N_e=50$) is $\\frac{1}{100}$, while during the recovery phase ($N_e=500$) it is $\\frac{1}{1000}$. The rate of loss is an order of magnitude greater during the bottleneck. Consequently, a short period at a very small population size can eradicate more genetic diversity than a much longer period at a larger population size. This is mathematically analogous to how the harmonic mean of a series of numbers is dominated by the smallest values, which is why the long-term effective population size over a fluctuating history is calculated as the harmonic mean of the per-generation sizes.", "answer": "$$\n\\boxed{1 - \\left(\\frac{99}{100}\\right)^{10} \\left(\\frac{999}{1000}\\right)^{T}}\n$$", "id": "2494492"}, {"introduction": "The loss of genetic diversity is not merely a passive consequence of small population size; it can actively drive a population towards extinction. This hands-on modeling exercise challenges you to build a coupled demographic-genetic system to simulate the \"extinction vortex\" [@problem_id:2494475]. By implementing the feedback loop where small population size accelerates inbreeding, which in turn depresses population growth, you will explore the conditions under which a population can become trapped in a fatal downward spiral.", "problem": "You are asked to build and analyze a discrete-time coupled demographic–genetic model that captures the feedback between inbreeding accumulation and population growth in small populations. Your implementation must start from fundamental and well-tested relationships and must not rely on any unspecified heuristics.\n\nDefine a population size sequence $\\{N_t\\}_{t \\ge 0}$ and an inbreeding coefficient sequence $\\{F_t\\}_{t \\ge 0}$ with the following properties.\n\n- Demography. Use a Ricker-type density regulation and multiplicative Allee effect. The per-generation update of census size is\n$$\nN_{t+1} \\;=\\; N_t \\;\\exp\\!\\big(r \\,(1 - N_t/K)\\big)\\; \\exp(-B\\,F_t)\\; \\frac{N_t}{N_t + A},\n$$\nwhere $r$ is the intrinsic growth parameter, $K$ is the carrying capacity, $A$ is the Allee-effect scale, and $\\exp(-B F_t)$ is the mean fitness reduction due to inbreeding (with inbreeding load parameter $B$ measured in diploid lethal equivalents).\n\n- Genetics. In each generation, the inbreeding coefficient updates according to the standard Wright–Fisher random mating recursion without mutation or migration:\n$$\nF_{t+1} \\;=\\; F_t \\;+\\; \\frac{1 - F_t}{2\\,N_{e,t}},\n$$\nwhere the effective population size (denoted $N_{e,t}$) scales with census size as $N_{e,t} \\,=\\, \\alpha\\, N_t$ and $\\alpha \\in (0,1]$ captures variance in reproductive success and departures from ideal conditions. To maintain biological plausibility in very small populations, impose a lower bound on effective size such that $N_{e,t} \\leftarrow \\max(\\alpha N_t, N_e^{\\min})$ with $N_e^{\\min} = 1$.\n\n- Extinction boundary. Treat $N_t \\le N_{\\mathrm{ext}}$ as an absorbing extinction state with $N_{\\mathrm{ext}} = 10^{-3}$. Once $N_t \\le N_{\\mathrm{ext}}$, the population is considered extinct and remains there for classification purposes.\n\nInterpretation. The coupling creates a feedback: small $N_t$ reduces $N_{e,t}$, which accelerates the increase of $F_t$, which reduces mean fitness $\\exp(-B F_t)$, which can further depress $N_{t+1}$, possibly creating an extinction vortex. Conversely, sufficiently large $N_t$ increases $N_{e,t}$, slows the increase of $F_t$, and can allow persistence.\n\nTask. For each parameter set in the test suite below, run two deterministic simulations of the coupled system from initial conditions $(N_0^{\\mathrm{low}}, F_0)$ and $(N_0^{\\mathrm{high}}, F_0)$, with $F_0 = 0$. Evolve the system for exactly $T$ generations. Classify the long-run outcome for that parameter set by comparing the two runs:\n\n- If both trajectories hit extinction (i.e., $N_t \\le N_{\\mathrm{ext}}$ in $\\le T$ steps), return the integer $0$.\n- If both trajectories persist (i.e., neither hits extinction within $T$ steps), return the integer $1$.\n- If exactly one trajectory hits extinction and the other persists within $T$ steps, return the integer $2$ (evidence of bistability and an extinction vortex threshold).\n\nFundamental base for derivation. You must base your construction on: (i) the definition of inbreeding coefficient update in a Wright–Fisher population, (ii) the relation between effective and census sizes via a proportionality constant, (iii) multiplicative inbreeding depression on mean fitness modeled as $\\exp(-B F)$, and (iv) a Ricker-type demographic update with an Allee effect factor.\n\nNumerical requirements. This problem is posed in dimensionless form, so no physical units are required. Angles are not involved. Any fractions or proportions should be represented as decimals in the code. All numeric decisions in your algorithm (including extinction detection) must follow the definitions given above without deviation.\n\nTest suite. Use exactly the following parameter sets. Each tuple is $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$, all numbers are real and provided here:\n\n- Case 1: (1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300)\n- Case 2: (1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500)\n- Case 3: (1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300)\n- Case 4: (1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500)\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4]$), where $x_i$ is the integer classification for case $i$ in the order given above. No other output is allowed.", "solution": "The problem requires the simulation of a coupled system of two discrete-time deterministic equations describing the evolution of population size, $N_t$, and the average inbreeding coefficient, $F_t$. The analysis aims to classify the long-term behavior of the population based on its sensitivity to initial population size, which reveals the potential for an extinction vortex.\n\nThe system is defined by the following set of recurrence relations:\n\n$1$. **Demographic Dynamics**: The change in census population size from generation $t$ to $t+1$ is governed by a model incorporating intrinsic growth, density-dependent regulation, inbreeding depression, and an Allee effect. The equation is:\n$$\nN_{t+1} = N_t \\exp\\left(r \\left(1 - \\frac{N_t}{K}\\right)\\right) \\exp(-B F_t) \\frac{N_t}{N_t + A}\n$$\nHere, $r$ is the intrinsic rate of natural increase, $K$ is the carrying capacity, $B$ is the inbreeding load parameter (measuring the fitness reduction per unit of inbreeding), and $A$ is the Allee effect parameter defining the critical population size threshold. The term $\\exp(r (1 - N_t/K))$ is the Ricker model of density regulation. The term $\\exp(-B F_t)$ represents the reduction in the population's mean fitness due to inbreeding. The term $N_t / (N_t + A)$ models a component II Allee effect, where per-capita growth rate increases with density at low population sizes.\n\n$2$. **Genetic Dynamics**: The inbreeding coefficient, $F_t$, which is the probability that two alleles at a locus are identical by descent, evolves according to the standard Wright-Fisher model for a randomly mating population of finite size:\n$$\nF_{t+1} = F_t + \\frac{1 - F_t}{2 N_{e,t}}\n$$\nThis equation shows that inbreeding increases in each generation at a rate inversely proportional to the effective population size, $N_{e,t}$. The rate of increase slows as $F_t$ approaches its maximum value of $1$.\n\n$3$. **Eco-Evolutionary Coupling**: The demographic and genetic processes are coupled. The effective population size, $N_{e,t}$, is assumed to be a fraction of the census size, $N_t$, modified by a floor value:\n$$\nN_{e,t} = \\max(\\alpha N_t, N_e^{\\min})\n$$\nwhere $\\alpha \\in (0, 1]$ is a scaling factor and $N_e^{\\min} = 1$ is a minimum effective size to ensure the genetic update equation remains biologically plausible even as $N_t \\to 0$. The inbreeding coefficient $F_t$ in turn affects the demographic update for $N_{t+1}$, creating a feedback loop. Small $N_t$ leads to small $N_{e,t}$, accelerating the rise of $F_t$, which leads to greater inbreeding depression, further reducing $N_{t+1}$. This positive feedback is the mechanism for the extinction vortex.\n\n**Simulation Algorithm and Classification**\n\nFor each given parameter set $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$, the following algorithm is executed.\n\nFirst, a simulation function is defined. This function takes a parameter set and an initial population size $N_0$ as input, with the initial inbreeding coefficient fixed at $F_0 = 0$. It iterates for a maximum of $T$ generations.\n\nThe simulation for a single trajectory proceeds as follows:\n- Initialize state variables $N \\leftarrow N_0$ and $F \\leftarrow F_0$.\n- For each discrete time step $t$ from $0$ to $T-1$:\n    - Check for extinction: If $N \\leq N_{\\mathrm{ext}}$ (where $N_{\\mathrm{ext}} = 10^{-3}$), the population is considered extinct. The simulation for this trajectory terminates, and the outcome is recorded as \"extinction\".\n    - If not extinct, calculate the effective population size for the current generation: $N_e \\leftarrow \\max(\\alpha N, 1.0)$.\n    - Calculate the state for the next generation, $(N_{\\mathrm{next}}, F_{\\mathrm{next}})$, using the current state $(N, F)$ and the model equations:\n        $$\n        N_{\\mathrm{next}} \\leftarrow N \\exp\\left(r \\left(1 - \\frac{N}{K}\\right)\\right) \\exp(-B F) \\frac{N}{N + A}\n        $$\n        $$\n        F_{\\mathrm{next}} \\leftarrow F + \\frac{1 - F}{2 N_e}\n        $$\n    - Update the state: $N \\leftarrow N_{\\mathrm{next}}$ and $F \\leftarrow F_{\\mathrm{next}}$.\n- After the loop completes (i.e., after $T$ updates), if the population has not already been declared extinct, a final check is made: if $N \\leq N_{\\mathrm{ext}}$, the population is considered extinct at generation $T$. Otherwise, it has persisted.\n\nThis simulation function is called twice for each parameter set: once with the low initial size, $N_0^{\\mathrm{low}}$, and once with the high initial size, $N_0^{\\mathrm{high}}$. Let the outcomes be `extinct_low` and `extinct_high`, respectively (where each is a boolean value).\n\nThe final classification for the parameter set is determined by these two outcomes based on the specified rules:\n- If `extinct_low` is true AND `extinct_high` is true, the classification is $0$.\n- If `extinct_low` is false AND `extinct_high` is false, the classification is $1$.\n- If one is true and the other is false, the classification is $2$. This indicates bistability, where the long-term fate of the population depends on its initial size, a characteristic signature of an extinction vortex.\n\nThe implementation will apply this logic to each of the four test cases provided and format the results as a list of integers.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(r, K, A, alpha, B, N0, T, Next_val, Ne_min, F0):\n    \"\"\"\n    Simulates the coupled demographic-genetic model for T generations.\n\n    This function evolves the population size N and inbreeding coefficient F\n    according to the provided discrete-time equations.\n\n    Args:\n        r (float): Intrinsic growth parameter.\n        K (float): Carrying capacity.\n        A (float): Allee-effect scale.\n        alpha (float): Scaling factor for effective population size.\n        B (float): Inbreeding load parameter.\n        N0 (float): Initial census population size.\n        T (int): Number of generations to simulate.\n        Next_val (float): Extinction threshold for population size.\n        Ne_min (float): Minimum effective population size.\n        F0 (float): Initial inbreeding coefficient.\n\n    Returns:\n        bool: True if the population goes extinct within T generations,\n              False otherwise.\n    \"\"\"\n    N = float(N0)\n    F = float(F0)\n\n    for _ in range(T):\n        # 1. Check for extinction at the beginning of the generation.\n        if N <= Next_val:\n            return True\n\n        # 2. Calculate effective population size for the current generation.\n        Ne = max(alpha * N, Ne_min)\n\n        # 3. Calculate N and F for the next generation.\n        # The update for N_{t+1} depends on the state at time t (N_t, F_t).\n        N_next = N * np.exp(r * (1.0 - N / K)) * np.exp(-B * F) * (N / (N + A))\n        \n        # The update for F_{t+1} depends on F_t and N_{e,t} (which depends on N_t).\n        F_next = F + (1.0 - F) / (2.0 * Ne)\n\n        # 4. Update state variables.\n        N = N_next\n        F = F_next\n\n    # 5. Final check for extinction after T full generations.\n    if N <= Next_val:\n        return True\n\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Test suite: (r, K, A, alpha, B, N0_low, N0_high, T)\n    test_cases = [\n        (1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300),\n        (1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500),\n        (1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300),\n        (1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500),\n    ]\n\n    # Model constants as defined in the problem\n    Next_val = 1e-3\n    Ne_min = 1.0\n    F0 = 0.0\n\n    results = []\n    for params in test_cases:\n        r, K, A, alpha, B, N0_low, N0_high, T = params\n        \n        # Run simulation for the low initial population size\n        extinct_low = run_simulation(r, K, A, alpha, B, N0_low, T, Next_val, Ne_min, F0)\n        \n        # Run simulation for the high initial population size\n        extinct_high = run_simulation(r, K, A, alpha, B, N0_high, T, Next_val, Ne_min, F0)\n        \n        # Classify the outcome based on the two trajectories\n        if extinct_low and extinct_high:\n            # Both trajectories go to extinction\n            classification = 0\n        elif not extinct_low and not extinct_high:\n            # Both trajectories persist\n            classification = 1\n        else:\n            # One persists, one goes extinct (bistability)\n            classification = 2\n            \n        results.append(classification)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver.\nsolve()\n```", "id": "2494475"}]}