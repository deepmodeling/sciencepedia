{"hands_on_practices": [{"introduction": "The Fisher-KPP equation is a cornerstone of theoretical ecology, providing a baseline model for how a population grows and spreads in space. This exercise takes you through a fundamental analysis of this reaction-diffusion model. By non-dimensionalizing the equation, you will learn to distill a system to its essential mathematical form, a crucial skill in modeling. Subsequently, you will use traveling wave analysis to derive the classic formula for the minimal speed of an invasion, a key theoretical prediction in invasion biology. [@problem_id:2534611]", "problem": "A spatially explicit population with local logistic growth and random dispersal along a one-dimensional ($1$-D) unbounded habitat is modeled by the Fisher–Kolmogorov–Petrovsky–Piskunov (Fisher–KPP) reaction–diffusion equation\n$$\n\\frac{\\partial N}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2}N}{\\partial x^{2}} \\;+\\; r\\,N\\Bigl(1-\\frac{N}{K}\\Bigr),\n$$\nwhere $N(x,t)$ is the population density, $D$ is the diffusion coefficient, $r$ is the intrinsic growth rate, and $K$ is the carrying capacity. Consider a species for which $D=0.5\\,\\text{km}^{2}/\\text{yr}$, $r=0.2\\,\\text{yr}^{-1}$, and $K=100\\,\\text{ind}/\\text{km}^{2}$. \n\nUsing first principles of dimensional analysis and scaling, perform the following:\n\n1) Introduce dimensionless variables by selecting characteristic scales $L$ for space, $T$ for time, and $K$ for density to transform the equation into a dimensionless form. Choose $L$ and $T$ so that the coefficients of the diffusion and growth terms in the transformed equation are both equal to $1$. Write the resulting dimensionless partial differential equation and identify any remaining intrinsic dimensionless parameters appearing in the equation.\n\n2) On the unbounded line, consider monotone traveling invasion waves that connect the unstable state to the stable state. Starting from the dimensionless equation obtained in part ($1$), use a traveling-wave reduction and a linearization about the leading edge to determine the minimal dimensionless invasion speed. Then convert this minimal speed back to dimensional units to obtain an explicit expression in terms of $D$ and $r$. Finally, evaluate this minimal invasion speed numerically for the given species. Express your final numerical answer in $\\text{km}/\\text{yr}$ and round to four significant figures.\n\nYour final reported answer must be a single real number, representing the minimal invasion speed in $\\text{km}/\\text{yr}$, rounded to four significant figures.", "solution": "The problem presented is a standard and well-posed exercise in the analysis of reaction-diffusion equations, specifically the Fisher-Kolmogorov-Petrovsky-Piskunov (Fisher-KPP) equation. It is scientifically grounded, internally consistent, and contains all necessary information for a unique solution. We shall proceed with the analysis.\n\nThe governing equation is given as:\n$$\n\\frac{\\partial N}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2}N}{\\partial x^{2}} \\;+\\; r\\,N\\Bigl(1-\\frac{N}{K}\\Bigr)\n$$\nwhere $N(x,t)$ is population density, $D$ is the diffusion coefficient, $r$ is the intrinsic growth rate, and $K$ is the carrying capacity. The given parameter values are $D=0.5\\,\\text{km}^{2}/\\text{yr}$, $r=0.2\\,\\text{yr}^{-1}$, and $K=100\\,\\text{ind}/\\text{km}^{2}$.\n\n**Part 1: Nondimensionalization**\n\nWe introduce the following dimensionless variables, using the characteristic scales $L$ for length, $T$ for time, and $K$ for population density:\n$$\nu = \\frac{N}{K}, \\quad \\xi = \\frac{x}{L}, \\quad \\tau = \\frac{t}{T}\n$$\nHere, $u$, $\\xi$, and $\\tau$ are the dimensionless density, space, and time variables, respectively. We express the derivatives from the original equation in terms of these new variables using the chain rule:\n$$\n\\frac{\\partial N}{\\partial t} = \\frac{\\partial (Ku)}{\\partial \\tau} \\frac{\\partial \\tau}{\\partial t} = \\frac{K}{T} \\frac{\\partial u}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial N}{\\partial x} = \\frac{\\partial (Ku)}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial x} = \\frac{K}{L} \\frac{\\partial u}{\\partial \\xi} \\quad \\implies \\quad \\frac{\\partial^{2} N}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}\\left(\\frac{K}{L}\\frac{\\partial u}{\\partial \\xi}\\right) = \\frac{K}{L} \\frac{\\partial}{\\partial \\xi}\\left(\\frac{\\partial u}{\\partial \\xi}\\right) \\frac{\\partial \\xi}{\\partial x} = \\frac{K}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}}\n$$\nSubstituting these expressions into the Fisher-KPP equation yields:\n$$\n\\frac{K}{T} \\frac{\\partial u}{\\partial \\tau} = D \\frac{K}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}} + r (Ku) \\left(1 - \\frac{Ku}{K}\\right)\n$$\nDividing the entire equation by $K$ and rearranging gives:\n$$\n\\frac{1}{T} \\frac{\\partial u}{\\partial \\tau} = \\frac{D}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}} + r u(1 - u)\n$$\nMultiplying by $T$, we obtain:\n$$\n\\frac{\\partial u}{\\partial \\tau} = \\frac{DT}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}} + rT u(1 - u)\n$$\nThe problem requires that we choose the characteristic scales $L$ and $T$ such that the coefficients of the diffusion term and the reaction term are both equal to $1$. This gives a system of two algebraic equations for $L$ and $T$:\n$$\n\\frac{DT}{L^2} = 1\n$$\n$$\nrT = 1\n$$\nFrom the second equation, we find the characteristic time scale $T$:\n$$\nT = \\frac{1}{r}\n$$\nSubstituting this result into the first equation allows us to solve for the characteristic length scale $L$:\n$$\n\\frac{D(1/r)}{L^2} = 1 \\quad \\implies \\quad \\frac{D}{r} = L^2 \\quad \\implies \\quad L = \\sqrt{\\frac{D}{r}}\n$$\nWith these characteristic scales, the dimensionless form of the Fisher-KPP equation becomes:\n$$\n\\frac{\\partial u}{\\partial \\tau} = \\frac{\\partial^2 u}{\\partial \\xi^2} + u(1-u)\n$$\nIn this canonical form, all dimensional parameters ($D$, $r$, $K$) have been absorbed into the scaling of the variables. Therefore, there are no remaining intrinsic dimensionless parameters in the equation itself.\n\n**Part 2: Minimal Invasion Speed**\n\nWe analyze the dimensionless equation for traveling wave solutions of the form $u(\\xi, \\tau) = U(z)$, where $z = \\xi - c\\tau$ is the traveling wave coordinate and $c$ is the constant, dimensionless wave speed. The wave connects the unstable equilibrium state $u=0$ to the stable equilibrium state $u=1$. The derivatives transform as:\n$$\n\\frac{\\partial u}{\\partial \\tau} = -c \\frac{dU}{dz}, \\quad \\frac{\\partial^2 u}{\\partial \\xi^2} = \\frac{d^2 U}{dz^2}\n$$\nSubstituting these into the dimensionless PDE yields a second-order ordinary differential equation for the wave profile $U(z)$:\n$$\n-c U' = U'' + U(1-U) \\quad \\text{or} \\quad U'' + cU' + U(1-U) = 0\n$$\nThe boundary conditions for an invasion front are $U(z) \\to 0$ as $z \\to \\infty$ (the leading edge) and $U(z) \\to 1$ as $z \\to -\\infty$ (the trailing edge).\n\nTo determine the minimal speed, we analyze the behavior at the leading edge of the wave, where $U$ is close to $0$. In this limit, the term $U(1-U) = U - U^2$ can be linearized to just $U$. The ODE becomes:\n$$\nU'' + cU' + U \\approx 0\n$$\nThis is a linear homogeneous ODE with constant coefficients. We seek an exponential solution of the form $U(z) \\propto \\exp(-\\lambda z)$, which must decay for large $z$ (so $\\lambda > 0$). Substitution into the linearized ODE gives the characteristic equation for $\\lambda$:\n$$\n\\lambda^2 - c\\lambda + 1 = 0\n$$\nThe roots for $\\lambda$ are given by the quadratic formula:\n$$\n\\lambda = \\frac{c \\pm \\sqrt{c^2 - 4}}{2}\n$$\nFor a monotonic (non-oscillatory) decay of the population density at the leading edge, the roots $\\lambda$ must be real and positive. The condition for real roots is that the discriminant must be non-negative:\n$$\nc^2 - 4 \\ge 0 \\quad \\implies \\quad c^2 \\ge 4\n$$\nSince invasion speed $c$ must be positive, this implies $c \\ge 2$. The minimum possible dimensionless speed is therefore:\n$$\nc_{min} = 2\n$$\nNow, we must convert this minimal dimensionless speed back into dimensional units. The dimensional speed $v$ is related to the dimensionless speed $c$ by the characteristic speed $L/T$:\n$$\nv = c \\frac{L}{T}\n$$\nUsing the expressions for $L$ and $T$ derived earlier:\n$$\n\\frac{L}{T} = \\frac{\\sqrt{D/r}}{1/r} = r \\sqrt{\\frac{D}{r}} = \\sqrt{r^2 \\frac{D}{r}} = \\sqrt{Dr}\n$$\nThus, the dimensional speed is $v = c \\sqrt{Dr}$. The minimal invasion speed $v_{min}$ corresponds to $c_{min}=2$:\n$$\nv_{min} = 2\\sqrt{Dr}\n$$\nThis is the celebrated formula for the minimal speed of invasion for the Fisher-KPP equation.\n\nFinally, we evaluate this speed using the given parameter values: $D = 0.5\\,\\text{km}^{2}/\\text{yr}$ and $r = 0.2\\,\\text{yr}^{-1}$.\n$$\nv_{min} = 2 \\sqrt{(0.5\\,\\text{km}^{2}/\\text{yr})(0.2\\,\\text{yr}^{-1})} = 2 \\sqrt{0.1\\,\\text{km}^{2}/\\text{yr}^{2}}\n$$\n$$\nv_{min} = 2 \\sqrt{0.1} \\, \\text{km}/\\text{yr} \\approx 2 \\times 0.316227766... \\, \\text{km}/\\text{yr}\n$$\n$$\nv_{min} \\approx 0.632455532... \\, \\text{km}/\\text{yr}\n$$\nRounding the result to four significant figures as requested, we obtain $0.6325\\,\\text{km}/\\text{yr}$.", "answer": "$$\n\\boxed{0.6325}\n$$", "id": "2534611"}, {"introduction": "While the Fisher-KPP model provides an elegant prediction for invasion speed, empirical observations often reveal that species spread much faster. This discrepancy forces us to critically examine the model's underlying assumptions. This practice is a conceptual exercise in which you will play the role of a theoretical ecologist, identifying the physical and biological mechanisms that could accelerate an invasion beyond the classical prediction. Evaluating how phenomena like directional currents, cooperative behaviors, and long-distance dispersal events can be incorporated into the mathematical framework will deepen your understanding of the interplay between model structure and dynamic outcomes. [@problem_id:2534591]", "problem": "A population with density $u(x,t)$ is invading along a nearly linear habitat. Independent laboratory measurements provide a low-density per capita growth rate $r$ and an effective motility consistent with Fickian diffusion with coefficient $D$. In the field, the invasion front travels at a sustained speed $c_{\\mathrm{emp}}$ that is substantially larger than the classical Fisher–Kolmogorov–Petrovsky–Piskunov prediction for the minimal speed obtained by linearization at $u \\approx 0$ under Fickian diffusion and monotone per capita growth. The classical Fisher–Kolmogorov–Petrovsky–Piskunov model assumes local Fickian dispersal, spatial homogeneity, no bulk drift, and a reaction term $f(u)$ that is increasing for small $u$ and whose per capita growth $f(u)/u$ is nonincreasing in $u$ on $(0,K)$ for some carrying capacity $K$.\n\nFrom a first-principles perspective, identify mechanistic explanations that violate at least one Fisher–Kolmogorov–Petrovsky–Piskunov assumption and can plausibly produce faster, or even accelerating, spatial spread, and select the corresponding mathematically explicit model modifications that would capture the mechanism. Select all that apply.\n\nA. Persistent directional flow (e.g., wind or current) that advects individuals in the invasion direction. Modify the governing equation to\n$\\partial_t u + v \\,\\partial_x u = D \\,\\partial_{xx} u + f(u)$\nwith constant drift speed $v>0$ aligned with the invasion.\n\nB. Rare long-distance jump dispersal with a fat-tailed displacement distribution. Replace local diffusion by nonlocal dispersal, for example\n$\\partial_t u(x,t) = \\int_{\\mathbb{R}} K(x-y)\\,u(y,t)\\,dy - u(x,t) + f\\big(u(x,t)\\big)$\nwhere $K$ is a probability kernel with algebraic tails $K(z) \\propto |z|^{-1-\\alpha}$ for some $\\alpha \\in (0,2)$, or equivalently use a fractional Laplacian\n$\\partial_t u = -\\kappa\\,(-\\Delta)^{\\alpha/2} u + f(u)$\nwith $\\alpha \\in (0,2)$ and $\\kappa>0$.\n\nC. Positive density dependence in growth at low to intermediate density (cooperation or weak Allee effect) that makes $f(u)/u$ increase on some interval near $u=0$, leading to pushed fronts. Use a reaction term such as\n$f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\big(1+a\\,u\\big)$\nwith $a>0$.\n\nD. A strong Allee effect with a strict threshold, for example\n$f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\left(\\frac{u}{A}-1\\right)$\nwith $A \\in (0,K)$, on the premise that it generically yields faster waves than the classical Fisher–Kolmogorov–Petrovsky–Piskunov model when initiated above threshold.\n\nE. Switching from diffusion to an integrodifference model with a thin-tailed Gaussian dispersal kernel of the same variance as the diffusive step, e.g.,\n$u_{t+1}(x) = \\int_{\\mathbb{R}} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\!\\left(-\\frac{(x-y)^2}{2\\sigma^2}\\right) f\\big(u_t(y)\\big)\\,dy$,\narguing that nonlocality per se ensures faster spread relative to the classical Fisher–Kolmogorov–Petrovsky–Piskunov prediction.\n\nF. Density-dependent dispersal with higher motility at low density (e.g., mate-searching or avoidance of interference), so that the effective diffusion is larger on the leading edge than in laboratory assays. Use nonlinear diffusion\n$\\partial_t u = \\partial_x\\!\\big(D(u)\\,\\partial_x u\\big) + f(u)$\nwith $D(u)$ decreasing as $u \\downarrow 0$, so that $D(0)$ exceeds the laboratory estimate measured at moderate density.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Population density: $u(x,t)$\n- Habitat: nearly linear\n- Low-density per capita growth rate: $r$\n- Motility: Fickian diffusion with coefficient $D$\n- Observed invasion speed: $c_{\\mathrm{emp}}$\n- Observation: $c_{\\mathrm{emp}}$ is substantially larger than the classical Fisher–Kolmogorov–Petrovsky–Piskunov (FKPP) minimal speed prediction.\n- FKPP model reference assumptions:\n    1. Local Fickian dispersal: $\\partial_t u = D \\partial_{xx} u + f(u)$\n    2. Spatial homogeneity: $D$ and parameters of $f(u)$ are constant.\n    3. No bulk drift: No advection term.\n    4. Reaction term $f(u)$ is increasing for small $u$.\n    5. Per capita growth $f(u)/u$ is nonincreasing in $u$ on $(0,K)$.\n- The FKPP minimal speed is obtained by linearization at $u \\approx 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Groundedness**: The problem is anchored in the canonical theory of biological invasions, specifically reaction-diffusion equations and the well-known FKPP model. The observation that real-world invasion speeds often exceed the naive FKPP prediction is a major topic in mathematical ecology. The potential mechanisms listed for evaluation (advection, Allee effects, nonlocal dispersal, density-dependent dispersal) are standard and actively researched subjects. The problem is scientifically sound and factually correct.\n- **Well-Posedness**: The question asks for the identification of valid mechanistic models from a list that can account for a specific phenomenon. It is a conceptual problem with a definite set of correct answers based on established mathematical and ecological theory. The problem is well-posed.\n- **Objectivity**: The language is technical and precise. No subjective or opinion-based statements are present.\n- **Completeness and Consistency**: The problem provides sufficient context, defining the baseline model (FKPP) and its assumptions, and clearly states the discrepancy to be explained. The givens are self-consistent.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It presents a standard, non-trivial question in theoretical ecology. The solution process will now commence.\n\n**Derivation of the Solution**\nThe problem concerns mechanisms that can produce invasion speeds greater than the canonical FPKP speed. The FKPP equation is $\\partial_t u = D \\partial_{xx} u + f(u)$, subject to the listed assumptions. The key assumption #$5$, that $f(u)/u$ is non-increasing, means the per capita growth rate is maximal at $u=0$. This leads to a \"pulled\" traveling wave, whose speed is determined by the linear dynamics at the leading edge $u \\approx 0$. Linearization gives $\\partial_t u = D \\partial_{xx} u + f'(0) u$. For $f'(0)=r$, this equation admits traveling wave solutions for any speed $c \\ge 2\\sqrt{Dr}$. Invasions from localized initial data select the minimal speed, $c_{FKPP} = 2\\sqrt{Dr}$.\n\nWe must analyze each proposed modification to determine if it violates at least one FKPP assumption and can plausibly generate a sustained speed $c  c_{FKPP}$ or accelerating spread.\n\n**Evaluation of Options**\n\n**A. Persistent directional flow (e.g., wind or current)...**\nThe proposed model is $\\partial_t u + v \\,\\partial_x u = D \\,\\partial_{xx} u + f(u)$ with $v0$.\nThis modification violates the FKPP assumption of \"no bulk drift\". To find the wave speed, we can transform to a moving coordinate frame $\\xi = x - vt$. The equation in this frame becomes $\\partial_{\\tau} \\tilde{u} = D \\,\\partial_{\\xi\\xi} \\tilde{u} + f(\\tilde{u})$, where $\\tilde{u}(\\xi, \\tau) = u(x,t)$. This is the standard reaction-diffusion equation, which has a minimal invasion speed of $c_{FKPP} = 2\\sqrt{Dr}$. Transforming back to the stationary lab frame, the total speed of the front is the sum of the propagation speed in the moving medium and the speed of the medium itself.\n$c = v + c_{FKPP} = v + 2\\sqrt{Dr}$.\nSince $v  0$ is assumed, the resulting speed $c$ is strictly greater than $2\\sqrt{Dr}$. This mechanism is ecologically plausible and mathematically sound.\n**Verdict: Correct.**\n\n**B. Rare long-distance jump dispersal...**\nThis option replaces local diffusion with nonlocal dispersal, described by an integro-differential equation with a fat-tailed kernel $K(z) \\propto |z|^{-1-\\alpha}$ for $\\alpha \\in (0,2)$, or equivalently by a fractional diffusion equation $\\partial_t u = -\\kappa\\,(-\\Delta)^{\\alpha/2} u + f(u)$.\nThis violates the \"local Fickian dispersal\" assumption. Fickian diffusion corresponds to the limit of dispersal kernels with finite variance (thin tails). The proposed kernel has infinite variance. It is a fundamental result that for reaction equations with KPP-type growth, fat-tailed dispersal kernels do not lead to a constant-speed traveling wave. Instead, they produce an accelerating invasion front. The position of the front typically scales with time $t$ super-linearly. Since the front continuously accelerates, its instantaneous speed will eventually exceed any constant value, including $c_{FKPP}$. This is a well-established mechanism for faster-than-FKPP spread.\n**Verdict: Correct.**\n\n**C. Positive density dependence in growth at low to intermediate density...**\nThis option proposes a reaction term $f(u)$ such that the per capita growth rate $f(u)/u$ is increasing for small $u$. An example given is $f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\big(1+a\\,u\\big)$ with $a0$. This describes a weak Allee effect. For this mechanism to be effective, $f(u)/u$ must increase, which requires $\\frac{d}{du}(f(u)/u)|_{u=0}  0$. For the example provided, this corresponds to $a  1/K$. This violates the FKPP assumption #$5$ that $f(u)/u$ is non-increasing. When this condition is violated, the wave is no longer \"pulled\" by the dynamics at the tip. Instead, it becomes \"pushed\" by the higher growth rates at intermediate densities. The speed of a pushed wave is determined by the full nonlinear reaction term and is strictly greater than the speed predicted by linearization at $u=0$. That is, $c_{pushed}  c_{linear} = 2\\sqrt{Df'(0)} = 2\\sqrt{Dr}$.\n**Verdict: Correct.**\n\n**D. A strong Allee effect with a strict threshold...**\nThe model is $f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\left(\\frac{u}{A}-1\\right)$ with $A \\in(0,K)$. This represents a strong Allee effect, where populations decline to extinction below a density threshold $A$. Here, $f(u)  0$ for $u \\in (0,A)$, which implies $f'(0) = -r/A  0$. The problem states that laboratory measurements provide a \"low-density per capita growth rate $r$,\" which implies a positive growth rate was measured for small $u$. The proposed model, having a negative growth rate for all small $u  0$, is therefore inconsistent with the data provided in the problem statement. The premise of comparing its wave speed to the FKPP speed $2\\sqrt{Dr}$ is undefined, as $r$ in that formula must be $f'(0)$, which is negative here. This model cannot be a valid explanation for the given scenario.\n**Verdict: Incorrect.**\n\n**E. Switching from diffusion to an integrodifference model...**\nThis option proposes replacing the continuous partial differential equation with a discrete-time integrodifference equation using a Gaussian (thin-tailed) dispersal kernel. The argument is that \"nonlocality per se ensures faster spread\". This argument is fallacious. The qualitative nature of the invasion dynamics for nonlocal dispersal is determined by the tail-weight of the dispersal kernel, not by nonlocality itself. A thin-tailed kernel, such as a Gaussian, has all moments finite and, in appropriate limits, gives rise to dynamics that are qualitatively identical to those of the standard reaction-diffusion equation. It will produce a traveling wave with a constant, finite speed. There is no a priori reason for this speed to be substantially larger than its continuous-time analogue. The mechanism for accelerated or pushed waves is absent.\n**Verdict: Incorrect.**\n\n**F. Density-dependent dispersal with higher motility at low density...**\nThe proposed model is $\\partial_t u = \\partial_x\\!\\big(D(u)\\,\\partial_x u\\big) + f(u)$, violating the assumption of a constant diffusion coefficient. The option explains the mechanism as \"higher motility at low density,\" which implies that the diffusion coefficient $D(u)$ is a decreasing function of density $u$. The laboratory measurement of $D$ is made at some moderate density $u_{lab} > 0$, yielding a value $D_{lab} = D(u_{lab})$. The FKPP prediction would be based on this value: $c_{pred} = 2\\sqrt{D_{lab}r}$. However, the speed of a pulled wave is determined by the parameters at the leading edge, where $u \\to 0$. The actual speed of the invasion front is therefore $c_{actual} = 2\\sqrt{D(0)r}$. Since $D(u)$ is a decreasing function, $D(0)  D(u_{lab}) = D_{lab}$. Consequently, $c_{actual}  c_{pred}$. This mechanism provides a direct and plausible explanation for the observed discrepancy.\n\nNote: There is a linguistic error in the option's text: \"$D(u)$ decreasing as $u \\downarrow 0$\". A literal reading implies $D(u)$ is an increasing function of $u$, which would contradict the stated mechanism (\"higher motility at low density\") and the stated outcome (\"$D(0)$ exceeds the laboratory estimate\"). The clear scientific intent, derived from the surrounding context, is that $D(u)$ is a decreasing function of $u$. The option is evaluated based on this intended scientific meaning.\n**Verdict: Correct.**\n\nFinal summary: Options A, B, C, and F describe valid mechanisms and models that violate FKPP assumptions and can produce invasion dynamics faster than the classical FKPP prediction.", "answer": "$$\\boxed{ABCF}$$", "id": "2534591"}, {"introduction": "Our focus now shifts from continuous landscapes to discrete habitat patches, a modeling framework essential for understanding fragmented populations. This hands-on computational problem introduces you to the core concepts of metapopulation theory, including source-sink dynamics. You will first classify patches based on their intrinsic demographic rates and then implement a patch-occupancy model to explore how dispersal connectivity allows 'source' populations to rescue and sustain populations in 'sink' habitats. This exercise provides practical experience in building and analyzing a classic metapopulation model, revealing how spatial structure governs regional persistence. [@problem_id:2534600]", "problem": "You are given a spatially explicit, density-independent patch model. For each patch indexed by $i \\in \\{0,1,2,3,4\\}$, you have per-time-step per capita survival $s_i$ and per-time-step per capita fecundity measured in census recruits $f_i$. Assume a post-breeding census such that the local finite rate of increase is $\\lambda_i = s_i + f_i$. Define the intrinsic rate of increase as $r_i = \\ln(\\lambda_i)$. A patch is a source if $r_i  0$ and a sink if $r_i  0$. \n\nDispersal-driven colonization is modeled by a connectivity matrix $A(\\alpha)$ with entries\n$$\nA_{ij}(\\alpha) = \n\\begin{cases}\n\\exp\\left(-\\dfrac{d_{ij}}{\\alpha}\\right),  \\text{if } i \\neq j, \\\\\n0,  \\text{if } i = j,\n\\end{cases}\n$$\nwhere $d_{ij}$ is the Euclidean distance between the centroids of patches $i$ and $j$, and $\\alpha  0$ is a dispersal length-scale parameter. For each patch $i$, the colonization pressure is $c_i = \\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j$, where $p_i \\in [0,1]$ is the occupancy probability of patch $i$ at equilibrium, and $\\beta  0$ is a global colonization scaling. Local extinction rates are patch-type dependent: if patch $i$ is a source, $e_i = e_{\\text{src}}$; if patch $i$ is a sink, $e_i = e_{\\text{snk}}$. The occupancy dynamics follow the classical patch-occupancy differential equation\n$$\n\\frac{dp_i}{dt} = \\left(1 - p_i\\right) c_i - e_i p_i,\n$$\nand the equilibrium is determined by the fixed-point condition\n$$\np_i = \\frac{c_i}{c_i + e_i} \\quad \\text{with} \\quad c_i = \\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j.\n$$\nYou must solve for the stable fixed point $p \\in [0,1]^5$ by fixed-point iteration for each specified $\\alpha$, starting from any reasonable initial guess, and iterating until the infinity norm of the difference between successive iterates is below a strict tolerance.\n\nUse the following data:\n- Patch coordinates as $(x_i,y_i)$:\n  - Patch $0$: $(0.0, 0.0)$\n  - Patch $1$: $(1.5, 0.2)$\n  - Patch $2$: $(0.8, 1.0)$\n  - Patch $3$: $(2.5, 1.7)$\n  - Patch $4$: $(3.0, 0.1)$\n- Survival $s_i$ and fecundity $f_i$:\n  - $s = [0.70, 0.50, 0.65, 0.40, 0.55]$\n  - $f = [0.60, 0.30, 0.55, 0.35, 0.30]$\n- Colonization scaling and extinction parameters:\n  - $\\beta = 0.60$\n  - $e_{\\text{src}} = 0.10$\n  - $e_{\\text{snk}} = 0.50$\n\nYour tasks:\n1. Compute $\\lambda_i = s_i + f_i$ and $r_i = \\ln(\\lambda_i)$ for each $i \\in \\{0,1,2,3,4\\}$. Classify each patch as a source if $r_i  0$ and as a sink if $r_i  0$. Represent the classification as a list of integers of length $5$ with $1$ for source and $0$ for sink, in ascending patch index order.\n2. For each scenario value of the dispersal length-scale $\\alpha$, solve the equilibrium fixed-point system\n   $$\n   p_i = \\frac{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j}{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j + e_i}\n   $$\n   using fixed-point iteration with a strict convergence tolerance of $\\varepsilon = 10^{-12}$ on the infinity norm and a hard cap of $10^6$ iterations to avoid non-termination if convergence fails. Use the classification from step $1$ to set $e_i$ for each patch.\n3. For each scenario, report only the occupancy probabilities of the sink patches, in ascending patch index order, each rounded to exactly three decimal places as decimals.\n\nTest suite:\n- Use the following four $\\alpha$ values to constitute the test suite and assess model behavior across connectivity regimes: $\\alpha \\in \\{0.50, 1.00, 2.00, 4.00\\}$. This set includes a low-connectivity case, two intermediate cases, and a high-connectivity case.\n\nFinal output format:\n- Your program should produce a single line of output containing two items enclosed in an outer pair of square brackets.\n  1. The first item is the classification list of length $5$ with entries in $\\{0,1\\}$, indicating sink ($0$) or source ($1$), in patch-index order $[0,1,2,3,4]$.\n  2. The second item is a list of lists, one inner list per $\\alpha$ in the order $\\alpha = 0.50, 1.00, 2.00, 4.00$, where each inner list contains the equilibrium occupancy probabilities for sink patches only, ordered by ascending patch index and rounded to three decimals.\n- For example, the final line should look like:\n  $$\n  [[b_0,b_1,b_2,b_3,b_4],[[q_{1}^{(1)},q_{3}^{(1)},q_{4}^{(1)}],[q_{1}^{(2)},q_{3}^{(2)},q_{4}^{(2)}],[q_{1}^{(3)},q_{3}^{(3)},q_{4}^{(3)}],[q_{1}^{(4)},q_{3}^{(4)},q_{4}^{(4)}]]]\n  $$\n  where $b_i \\in \\{0,1\\}$ and each $q_{k}^{(\\ell)}$ is a decimal rounded to three places. Ensure the program prints only this line, with no extra whitespace or text.\n\nAll quantities in this problem are unitless and per time step. Angles are not involved. The required answers are lists of integers and lists of floats as specified above. Your solution must be implemented as a complete, runnable program.", "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and self-contained. It presents a standard patch-occupancy metapopulation model from theoretical ecology. All parameters and governing equations are explicitly defined. We shall proceed with the solution.\n\nThe problem requires a two-part computation. First, we must classify each patch as a source or a sink based on its intrinsic demographic properties. Second, for a given set of dispersal length-scales $\\alpha$, we must solve for the equilibrium patch occupancy probabilities $p_i$ using a fixed-point iteration scheme.\n\n**Part 1: Patch Classification**\n\nThe classification of a patch as a source or sink depends on its intrinsic rate of increase, $r_i$. This is derived from the per capita survival $s_i$ and fecundity $f_i$ for each patch $i \\in \\{0, 1, 2, 3, 4\\}$. The local finite rate of increase, $\\lambda_i$, is defined as the sum of survival and fecundity for a post-breeding census model:\n$$\n\\lambda_i = s_i + f_i\n$$\nThe intrinsic rate of increase, $r_i$, is the natural logarithm of $\\lambda_i$:\n$$\nr_i = \\ln(\\lambda_i)\n$$\nA patch $i$ is a source if its population would grow in isolation ($r_i  0$), and a sink if it would decline ($r_i  0$).\n\nThe given data are:\n- Survival rates: $s = [0.70, 0.50, 0.65, 0.40, 0.55]$\n- Fecundity rates: $f = [0.60, 0.30, 0.55, 0.35, 0.30]$\n\nWe calculate $\\lambda_i$ for each patch $i$:\n- $\\lambda_0 = s_0 + f_0 = 0.70 + 0.60 = 1.30$\n- $\\lambda_1 = s_1 + f_1 = 0.50 + 0.30 = 0.80$\n- $\\lambda_2 = s_2 + f_2 = 0.65 + 0.55 = 1.20$\n- $\\lambda_3 = s_3 + f_3 = 0.40 + 0.35 = 0.75$\n- $\\lambda_4 = s_4 + f_4 = 0.55 + 0.30 = 0.85$\n\nNext, we calculate $r_i = \\ln(\\lambda_i)$:\n- $r_0 = \\ln(1.30) \\approx 0.262  0 \\implies$ Source\n- $r_1 = \\ln(0.80) \\approx -0.223  0 \\implies$ Sink\n- $r_2 = \\ln(1.20) \\approx 0.182  0 \\implies$ Source\n- $r_3 = \\ln(0.75) \\approx -0.288  0 \\implies$ Sink\n- $r_4 = \\ln(0.85) \\approx -0.163  0 \\implies$ Sink\n\nThe classification, represented by $1$ for a source and $0$ for a sink, is $[1, 0, 1, 0, 0]$.\nThe corresponding local extinction rates $e_i$ are set according to this classification using the provided parameters $e_{\\text{src}} = 0.10$ and $e_{\\text{snk}} = 0.50$:\n$$\ne = [0.10, 0.50, 0.10, 0.50, 0.50]\n$$\n\n**Part 2: Equilibrium Occupancy Probabilities**\n\nThe equilibrium occupancy probabilities $p = [p_0, p_1, p_2, p_3, p_4]$ are determined by the fixed-point equation:\n$$\np_i = \\frac{c_i}{c_i + e_i}\n$$\nwhere the colonization pressure $c_i$ is given by\n$$\nc_i = \\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j\n$$\nThe global colonization scaling is $\\beta = 0.60$. The connectivity matrix $A(\\alpha)$ depends on the dispersal length-scale $\\alpha$ and the Euclidean distances $d_{ij}$ between patch centroids. The entries are $A_{ij}(\\alpha) = \\exp(-d_{ij}/\\alpha)$ for $i \\neq j$ and $A_{ii}(\\alpha) = 0$.\n\nFirst, we compute the symmetric distance matrix $D$ where $D_{ij} = d_{ij}$ using the patch coordinates:\n- $P_0=(0.0, 0.0)$, $P_1=(1.5, 0.2)$, $P_2=(0.8, 1.0)$, $P_3=(2.5, 1.7)$, $P_4=(3.0, 0.1)$.\nThis yields distances such as $d_{01} = \\sqrt{(1.5-0.0)^2 + (0.2-0.0)^2} \\approx 1.513$.\n\nWe must solve the system for each specified value of $\\alpha \\in \\{0.50, 1.00, 2.00, 4.00\\}$. The problem specifies using a fixed-point iteration method. Let the vector of probabilities be $p^{(k)}$ at iteration $k$. The next iterate $p^{(k+1)}$ is given by the mapping $F$:\n$$\np^{(k+1)} = F(p^{(k)})\n$$\nwhere the $i$-th component of the mapping is:\n$$\n[F(p)]_i = \\frac{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j}{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j + e_i}\n$$\nThe iteration proceeds as follows for each $\\alpha$:\n1.  Compute the connectivity matrix $A(\\alpha)$ using the pre-computed distance matrix $D$.\n2.  Initialize the probability vector $p^{(0)}$. A reasonable choice that avoids the trivial fixed point at $p=0$ is $p^{(0)}_i = 0.5$ for all $i$.\n3.  Iterate $p^{(k+1)} = F(p^{(k)})$ for $k = 0, 1, 2, \\ldots$\n4.  Stop when the infinity norm of the difference between successive iterates is below the tolerance $\\varepsilon = 10^{-12}$:\n    $$\n    \\|p^{(k+1)} - p^{(k)}\\|_{\\infty} = \\max_i |p_{i}^{(k+1)} - p_{i}^{(k)}|  \\varepsilon\n    $$\n5.  A maximum of $10^6$ iterations is enforced to prevent non-termination.\n\nOnce the iteration converges to a fixed point $p^*$, we extract the probabilities for the sink patches, which are patches $1$, $3$, and $4$. These probabilities ($p_1^*, p_3^*, p_4^*$) are then rounded to three decimal places. This process is repeated for each $\\alpha$ in the test suite.\n\nThe final output is a list containing two elements: the patch classification list and a list of lists, where each inner list contains the rounded equilibrium occupancy probabilities for the sink patches for a given $\\alpha$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the patch-occupancy model problem as specified.\n\n    1. Classifies patches as sources or sinks.\n    2. For each alpha, solves for equilibrium occupancies using fixed-point iteration.\n    3. Formats the results into the required output string.\n    \"\"\"\n    # Define given parameters\n    coords = np.array([\n        [0.0, 0.0],  # Patch 0\n        [1.5, 0.2],  # Patch 1\n        [0.8, 1.0],  # Patch 2\n        [2.5, 1.7],  # Patch 3\n        [3.0, 0.1]   # Patch 4\n    ])\n    s = np.array([0.70, 0.50, 0.65, 0.40, 0.55])\n    f = np.array([0.60, 0.30, 0.55, 0.35, 0.30])\n    \n    beta = 0.60\n    e_src = 0.10\n    e_snk = 0.50\n    \n    alphas = [0.50, 1.00, 2.00, 4.00]\n    tolerance = 1e-12\n    max_iterations = 1_000_000\n    n_patches = len(coords)\n\n    # --- Task 1: Patch Classification ---\n    lambda_vals = s + f\n    r_vals = np.log(lambda_vals)\n    \n    # Classification: 1 for source (r  0), 0 for sink (r  0)\n    classification = (r_vals  0).astype(int).tolist()\n    \n    # Assign extinction rates based on classification\n    e_rates = np.where(r_vals  0, e_src, e_snk)\n    \n    # Identify indices of sink patches for final reporting\n    sink_indices = np.where(r_vals  0)[0]\n    \n    # --- Pre-computation: Distance Matrix ---\n    dist_matrix = np.zeros((n_patches, n_patches))\n    for i in range(n_patches):\n        for j in range(i, n_patches):\n            dist = np.linalg.norm(coords[i] - coords[j])\n            dist_matrix[i, j] = dist\n            dist_matrix[j, i] = dist\n\n    # --- Task 2  3: Fixed-Point Iteration and Result Collection ---\n    all_sink_occupancies = []\n    \n    for alpha in alphas:\n        # Compute connectivity matrix A(alpha)\n        # We explicitly set a large value where alpha is zero to avoid division by zero,\n        # though the problem states alpha  0. This is just for robustness.\n        # The exponential of a large negative number will be zero.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            A = np.exp(-dist_matrix / alpha)\n        \n        # Diagonal entries are 0\n        np.fill_diagonal(A, 0)\n        \n        # Initialize occupancy probabilities (vector p)\n        # Start with 0.5 to avoid the trivial fixed point at p=0\n        p = np.full(n_patches, 0.5)\n\n        for _ in range(max_iterations):\n            p_old = p.copy()\n            \n            # Calculate colonization pressure (vector c)\n            c = beta * (A @ p_old)\n            \n            # Update occupancy probabilities using the fixed-point equation\n            # p_i = c_i / (c_i + e_i)\n            # Handle c_i + e_i = 0 case, though unlikely as e_i  0\n            denominator = c + e_rates\n            p = np.divide(c, denominator, out=np.zeros_like(c), where=denominator!=0)\n\n            # Check for convergence using the infinity norm\n            if np.linalg.norm(p - p_old, ord=np.inf)  tolerance:\n                break\n        \n        # Extract occupancy probabilities for sink patches\n        sink_p = p[sink_indices]\n        \n        # Round to three decimal places\n        rounded_sink_p = np.round(sink_p, 3).tolist()\n        all_sink_occupancies.append(rounded_sink_p)\n        \n    # --- Final Output Formatting ---\n    # Assemble the final data structure\n    final_result = [classification, all_sink_occupancies]\n    \n    # Convert the result to a string representation without spaces\n    output_str = str(final_result).replace(\" \", \"\")\n    \n    print(output_str)\n\nsolve()\n```", "id": "2534600"}]}