{"hands_on_practices": [{"introduction": "This first practice explores the fundamental dynamics of an ectotherm's body temperature using a simplified \"lumped-capacitance\" model. By applying Newton's law of cooling, we can derive an analytical solution for how an organism's temperature changes over time, introducing the crucial concept of the thermal time constant, $\\tau$. This exercise [@problem_id:2539055] is invaluable for building intuition about the timescales of heating and cooling in response to environmental shifts, a core aspect of behavioral thermoregulation.", "problem": "A small desert lizard is modeled as a spatially uniform ectotherm whose body temperature, denoted by $T_b(t)$, changes according to an energy balance between body heat content and net environmental heat exchange. Assume that over the time interval of interest: (i) the body can be treated as a lumped thermal mass with heat capacity $C$ (in $\\mathrm{J}\\,\\mathrm{K}^{-1}$), (ii) the net heat transfer with the environment is proportional to the difference between the operative environmental temperature $T_e$ (in $\\mathrm{K}$ or $^{\\circ}\\mathrm{C}$) and the body temperature $T_b$, with proportionality constant (overall conductance) $G$ (in $\\mathrm{W}\\,\\mathrm{K}^{-1}$), and (iii) the effective environmental temperature $T_e$ undergoes a step change at time $t=0$ when the lizard moves from shade to sun and then remains constant thereafter.\n\nStarting from the first-principles heat balance $C\\,\\frac{dT_b}{dt} = G\\,(T_e - T_b)$, with the thermal time constant defined as $\\tau \\equiv \\frac{C}{G}$, consider the following scenario. The lizard has been in the shade long enough that its initial body temperature at $t=0$ equals the shaded operative temperature, $T_b(0)=T_{e,\\mathrm{shade}} = 28\\,^{\\circ}\\mathrm{C}$. At $t=0$, it moves into full sun where the operative temperature is $T_{e,\\mathrm{sun}} = 38\\,^{\\circ}\\mathrm{C}$, which then remains constant. The lizard’s preferred body temperature is $T_{\\mathrm{pref}} = 35\\,^{\\circ}\\mathrm{C}$. The thermal time constant has been measured as $\\tau = 4\\,\\mathrm{min}$ under these conditions.\n\nUsing only the stated energy-balance model and definitions, derive $T_b(t)$ for $t \\ge 0$ and determine the unique time $t^{\\ast}$ at which $T_b(t^{\\ast}) = T_{\\mathrm{pref}}$. Express your final $t^{\\ast}$ in minutes, and round your answer to three significant figures.", "solution": "The problem as stated is subjected to validation.\n\nGivens are extracted verbatim:\n1.  Governing differential equation: $C\\,\\frac{dT_b}{dt} = G\\,(T_e - T_b)$\n2.  Definition of thermal time constant: $\\tau \\equiv \\frac{C}{G}$\n3.  Initial condition: $T_b(0) = T_{e,\\mathrm{shade}} = 28\\,^{\\circ}\\mathrm{C}$\n4.  Operative environmental temperature for $t \\ge 0$: $T_e = T_{e,\\mathrm{sun}} = 38\\,^{\\circ}\\mathrm{C}$\n5.  Target body temperature: $T_{\\mathrm{pref}} = 35\\,^{\\circ}\\mathrm{C}$\n6.  Value of thermal time constant: $\\tau = 4\\,\\mathrm{min}$\n\nValidation verdict:\nThe problem is scientifically grounded, well-posed, and objective. The governing equation is a standard representation of Newton's law of cooling, a fundamental principle of heat transfer. The problem provides a first-order linear ordinary differential equation with a specified initial condition, which constitutes a well-posed initial value problem guaranteeing a unique solution. All parameters are clearly defined and the given values are physically plausible. The problem is free of contradictions, ambiguities, and non-scientific claims. Therefore, it is deemed valid and a solution will be provided.\n\nThe analysis begins with the first-principles heat balance equation:\n$$C\\,\\frac{dT_b}{dt} = G\\,(T_e - T_b)$$\nHere, $T_b(t)$ is the body temperature at time $t$, $C$ is the heat capacity, $G$ is the thermal conductance, and $T_e$ is the operative environmental temperature.\nBy substituting the definition of the thermal time constant, $\\tau = \\frac{C}{G}$, into the equation, we simplify its form. Dividing the governing equation by $G$ yields:\n$$\\frac{C}{G}\\,\\frac{dT_b}{dt} = T_e - T_b$$\n$$\\tau\\,\\frac{dT_b}{dt} = T_e - T_b$$\nFor the time interval $t \\ge 0$, the operative temperature $T_e$ is constant and equal to $T_{e,\\mathrm{sun}}$. We rearrange the equation into a standard form for a first-order linear separable ordinary differential equation:\n$$\\frac{dT_b}{T_e - T_b} = \\frac{1}{\\tau}\\,dt$$\nIntegrating both sides of this equation gives:\n$$\\int \\frac{dT_b}{T_e - T_b} = \\int \\frac{1}{\\tau}\\,dt$$\nThe integration results in:\n$$-\\ln|T_e - T_b| = \\frac{t}{\\tau} + K$$\nwhere $K$ is the constant of integration. Since the lizard is warming up from a lower temperature to a higher one, $T_e - T_b$ will always be positive, so the absolute value is unnecessary.\n$$\\ln(T_e - T_b) = -\\frac{t}{\\tau} - K$$\nExponentiating both sides yields:\n$$T_e - T_b = \\exp\\left(-\\frac{t}{\\tau} - K\\right) = \\exp(-K)\\exp\\left(-\\frac{t}{\\tau}\\right)$$\nLet $A = \\exp(-K)$ be a new constant. The general solution for $T_b(t)$ is:\n$$T_b(t) = T_e - A\\exp\\left(-\\frac{t}{\\tau}\\right)$$\nWe determine the constant $A$ using the initial condition at $t=0$. We are given $T_b(0) = T_{e,\\mathrm{shade}}$ and for all $t \\ge 0$, $T_e = T_{e,\\mathrm{sun}}$.\n$$T_b(0) = T_{e,\\mathrm{sun}} - A\\exp(0)$$\n$$T_{e,\\mathrm{shade}} = T_{e,\\mathrm{sun}} - A$$\nSolving for $A$:\n$$A = T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}}$$\nSubstituting this expression for $A$ back into the general solution gives the specific solution for the lizard's body temperature for $t \\ge 0$:\n$$T_b(t) = T_{e,\\mathrm{sun}} - (T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}})\\exp\\left(-\\frac{t}{\\tau}\\right)$$\nThe problem requires finding the time $t^{\\ast}$ at which the body temperature reaches the preferred temperature, $T_b(t^{\\ast}) = T_{\\mathrm{pref}}$. We set $t = t^{\\ast}$ and $T_b(t^{\\ast})=T_{\\mathrm{pref}}$ in the solution:\n$$T_{\\mathrm{pref}} = T_{e,\\mathrm{sun}} - (T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}})\\exp\\left(-\\frac{t^{\\ast}}{\\tau}\\right)$$\nWe now solve for $t^{\\ast}$. Rearranging the terms:\n$$(T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}})\\exp\\left(-\\frac{t^{\\ast}}{\\tau}\\right) = T_{e,\\mathrm{sun}} - T_{\\mathrm{pref}}$$\n$$\\exp\\left(-\\frac{t^{\\ast}}{\\tau}\\right) = \\frac{T_{e,\\mathrm{sun}} - T_{\\mathrm{pref}}}{T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}}}$$\nTaking the natural logarithm of both sides:\n$$-\\frac{t^{\\ast}}{\\tau} = \\ln\\left(\\frac{T_{e,\\mathrm{sun}} - T_{\\mathrm{pref}}}{T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}}}\\right)$$\nFinally, solving for $t^{\\ast}$:\n$$t^{\\ast} = -\\tau \\ln\\left(\\frac{T_{e,\\mathrm{sun}} - T_{\\mathrm{pref}}}{T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}}}\\right) = \\tau \\ln\\left(\\left(\\frac{T_{e,\\mathrm{sun}} - T_{\\mathrm{pref}}}{T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}}}\\right)^{-1}\\right)$$\n$$t^{\\ast} = \\tau \\ln\\left(\\frac{T_{e,\\mathrm{sun}} - T_{e,\\mathrm{shade}}}{T_{e,\\mathrm{sun}} - T_{\\mathrm{pref}}}\\right)$$\nThis is the symbolic solution. We now substitute the given numerical values: $\\tau = 4\\,\\mathrm{min}$, $T_{e,\\mathrm{shade}} = 28\\,^{\\circ}\\mathrm{C}$, $T_{e,\\mathrm{sun}} = 38\\,^{\\circ}\\mathrm{C}$, and $T_{\\mathrm{pref}} = 35\\,^{\\circ}\\mathrm{C}$. Notice that since the formula uses only temperature differences, the Celsius scale is sufficient.\n$$t^{\\ast} = 4\\,\\ln\\left(\\frac{38 - 28}{38 - 35}\\right)$$\n$$t^{\\ast} = 4\\,\\ln\\left(\\frac{10}{3}\\right)$$\nCalculating the numerical value:\n$$t^{\\ast} = 4 \\times 1.203972... \\approx 4.81588... \\,\\mathrm{min}$$\nRounding to three significant figures as required by the problem gives:\n$$t^{\\ast} \\approx 4.82\\,\\mathrm{min}$$", "answer": "$$\n\\boxed{4.82}\n$$", "id": "2539055"}, {"introduction": "Building upon the simple dynamic model, this practice delves into a more comprehensive, steady-state heat budget that accounts for multiple simultaneous pathways of heat exchange. The inherent non-linearity from radiative heat transfer often precludes a simple exact solution for body temperature. This exercise [@problem_id:2539125] introduces the powerful technique of linearization to derive a closed-form approximation, offering deep insight into how an ectotherm's equilibrium temperature emerges from the interplay of solar radiation, convection, and other environmental factors.", "problem": "An ectothermic lizard at steady state exchanges heat with its environment by absorbing shortwave solar radiation, exchanging longwave radiation with the sky, convecting with air, and conducting with the substrate. Neglect evaporative heat loss. Let the steady-state surface energy balance be written as\n$$\n0 \\;=\\; \\alpha S A_p \\;+\\; \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{s}^{4}\\right) \\;+\\; h_c A \\left(T_a - T_s\\right) \\;+\\; h_k A_c \\left(T_{sub} - T_s\\right),\n$$\nwhere $T_s$ is the body surface temperature to be determined; $\\alpha$ is the shortwave absorptivity; $S$ is the direct-plus-diffuse shortwave solar irradiance; $A_p$ is the projected area to the sun; $\\epsilon$ is the hemispherical longwave emissivity; $\\sigma$ is the Stefan–Boltzmann constant; $A$ is the surface area participating in radiation and free-forced convection; $h_c$ is the convective heat transfer coefficient; $T_a$ is air temperature; $h_k$ is the effective thermal conductance to the substrate; $A_c$ is the contact area with the substrate; $T_{sub}$ is substrate temperature; and $T_{sky}$ is the effective sky radiative temperature. All quantities are assumed spatially uniform over the organismal surfaces and constant in time.\n\nStarting from the above balance and using only fundamental principles (energy conservation and the Stefan–Boltzmann law), derive an explicit closed-form approximation for $T_s$ by linearizing the longwave term $\\epsilon \\sigma A \\left(T_{sky}^{4} - T_{s}^{4}\\right)$ to first order about a reference temperature $T_{ref}$ that is representative of the organism’s radiative environment (for example, a mean radiant temperature). Do not assume $T_{ref} = T_s$. Express your final result for $T_s$ solely in terms of the given parameters $\\alpha, S, A_p, \\epsilon, \\sigma, A, h_c, T_a, h_k, A_c, T_{sub}, T_{sky}$ and the chosen $T_{ref}$. The final answer must be a single analytic expression for $T_s$.", "solution": "The problem is subjected to validation.\n\n**Step 1: Extract Givens**\n- The steady-state surface energy balance equation:\n$$0 = \\alpha S A_p + \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{s}^{4}\\right) + h_c A \\left(T_a - T_s\\right) + h_k A_c \\left(T_{sub} - T_s\\right)$$\n- The unknown variable to be determined is the body surface temperature, $T_s$.\n- Given parameters:\n    - $\\alpha$: shortwave absorptivity\n    - $S$: solar irradiance\n    - $A_p$: projected area to the sun\n    - $\\epsilon$: longwave emissivity\n    - $\\sigma$: Stefan–Boltzmann constant\n    - $A$: surface area for radiation and convection\n    - $T_{sky}$: effective sky radiative temperature\n    - $h_c$: convective heat transfer coefficient\n    - $T_a$: air temperature\n    - $h_k$: thermal conductance to the substrate\n    - $A_c$: contact area with the substrate\n    - $T_{sub}$: substrate temperature\n- Constraint: The derivation must use linearization of the longwave radiation term about a reference temperature $T_{ref}$, where $T_{ref} \\ne T_s$. The final result for $T_s$ must be an explicit closed-form expression in terms of the given parameters and $T_{ref}$.\n- Assumptions: Steady state, no evaporative heat loss, all parameters are spatially uniform and constant in time.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the First Law of Thermodynamics (energy conservation) applied to an ectotherm, a fundamental and well-established model in biophysical ecology. All terms represent standard modes of heat transfer.\n- **Well-Posed:** The problem asks for a specific derivation using a standard mathematical technique (linearization). This technique transforms the non-linear equation into a linear one for $T_s$, which guarantees a unique solution.\n- **Objective:** The problem is stated with precise, objective scientific language and definitions.\n- **Completeness and Consistency:** The problem is self-contained. It provides all necessary variables and a clear objective. There are no contradictions.\n- **Other criteria:** The problem is realistic, formally stated, non-trivial, and verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution is not only possible but required. We proceed to the derivation.\n\nThe starting point is the provided steady-state energy balance equation:\n$$0 = \\alpha S A_p + \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{s}^{4}\\right) + h_c A \\left(T_a - T_s\\right) + h_k A_c \\left(T_{sub} - T_s\\right)$$\nThis equation is non-linear with respect to the unknown surface temperature $T_s$ due to the $T_s^4$ term from the Stefan-Boltzmann law. The task is to find an approximate solution for $T_s$ by linearizing the longwave radiation term, $L_w = \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{s}^{4}\\right)$, with respect to $T_s$.\n\nThe linearization must be performed about a specified reference temperature, $T_{ref}$. We treat the longwave term as a function of $T_s$, denoted as $L_w(T_s)$. We apply a first-order Taylor series expansion of $L_w(T_s)$ around $T_s = T_{ref}$:\n$$L_w(T_s) \\approx L_w(T_{ref}) + \\left. \\frac{dL_w}{dT_s} \\right|_{T_s=T_{ref}} (T_s - T_{ref})$$\nFirst, we evaluate the function at $T_s = T_{ref}$:\n$$L_w(T_{ref}) = \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{ref}^{4}\\right)$$\nNext, we find the derivative of $L_w(T_s)$ with respect to $T_s$:\n$$\\frac{dL_w}{dT_s} = \\frac{d}{dT_s} \\left[ \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{s}^{4}\\right) \\right] = -\\epsilon \\sigma A \\left(4 T_s^3\\right)$$\nEvaluating the derivative at $T_s = T_{ref}$:\n$$\\left. \\frac{dL_w}{dT_s} \\right|_{T_s=T_{ref}} = -4 \\epsilon \\sigma A T_{ref}^3$$\nSubstituting these components back into the Taylor expansion gives the linearized longwave term:\n$$L_w(T_s) \\approx \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{ref}^{4}\\right) - 4 \\epsilon \\sigma A T_{ref}^3 (T_s - T_{ref})$$\nNow, we substitute this linearized expression back into the original energy balance equation:\n$$0 \\approx \\alpha S A_p + \\left[ \\epsilon \\sigma A \\left(T_{sky}^{4} - T_{ref}^{4}\\right) - 4 \\epsilon \\sigma A T_{ref}^3 (T_s - T_{ref}) \\right] + h_c A \\left(T_a - T_s\\right) + h_k A_c \\left(T_{sub} - T_s\\right)$$\nThis equation is now linear in $T_s$. We must perform algebraic manipulation to isolate $T_s$. We expand all terms:\n$$0 = \\alpha S A_p + \\epsilon \\sigma A T_{sky}^{4} - \\epsilon \\sigma A T_{ref}^{4} - 4 \\epsilon \\sigma A T_{ref}^3 T_s + 4 \\epsilon \\sigma A T_{ref}^4 + h_c A T_a - h_c A T_s + h_k A_c T_{sub} - h_k A_c T_s$$\nNext, we collect all terms containing $T_s$ on one side of the equation and all other terms on the opposite side.\n$$4 \\epsilon \\sigma A T_{ref}^3 T_s + h_c A T_s + h_k A_c T_s = \\alpha S A_p + \\epsilon \\sigma A T_{sky}^{4} - \\epsilon \\sigma A T_{ref}^{4} + 4 \\epsilon \\sigma A T_{ref}^4 + h_c A T_a + h_k A_c T_{sub}$$\nFactor out $T_s$ from the left side and combine the terms involving $T_{ref}^4$ on the right side:\n$$T_s \\left( 4 \\epsilon \\sigma A T_{ref}^3 + h_c A + h_k A_c \\right) = \\alpha S A_p + \\epsilon \\sigma A \\left(T_{sky}^4 + 3 T_{ref}^4\\right) + h_c A T_a + h_k A_c T_{sub}$$\nFinally, we solve for $T_s$ by dividing both sides by the coefficient of $T_s$:\n$$T_s = \\frac{\\alpha S A_p + h_c A T_a + h_k A_c T_{sub} + \\epsilon \\sigma A \\left(T_{sky}^4 + 3 T_{ref}^4\\right)}{4 \\epsilon \\sigma A T_{ref}^3 + h_c A + h_k A_c}$$\nThis is the required explicit closed-form approximation for the surface temperature $T_s$. It is expressed solely in terms of the given parameters and the reference temperature $T_{ref}$.\nThe denominator can be interpreted as a total thermal conductance, composed of a linearized radiative conductance $4\\epsilon\\sigma A T_{ref}^3$, a convective conductance $h_c A$, and a conductive conductance $h_k A_c$. The numerator is a sum of heat fluxes and temperature-weighted conductances that drive the system to its equilibrium temperature.", "answer": "$$\n\\boxed{\\frac{\\alpha S A_p + h_c A T_a + h_k A_c T_{sub} + \\epsilon \\sigma A \\left(T_{sky}^{4} + 3 T_{ref}^{4}\\right)}{h_c A + h_k A_c + 4 \\epsilon \\sigma A T_{ref}^{3}}}\n$$", "id": "2539125"}, {"introduction": "Our final practice serves as a capstone, integrating the physical principles of heat transfer into a dynamic, predictive simulation. We will move beyond steady-state approximations to model an ectotherm's body temperature over a full diel cycle with realistic, time-varying environmental conditions. This exercise [@problem_id:2539109] requires implementing a numerical solution to the complete, non-linear energy balance equation, providing hands-on experience with the type of biophysical modeling used to forecast organismal responses to weather and climate change and to quantify thermal performance opportunities in nature.", "problem": "A small ectotherm exchanges heat with its environment via shortwave solar absorption, longwave radiative exchange with sky and ground, convection with air, and conduction with the substrate. From first principles, use conservation of energy to model the body temperature trajectory over a diel cycle and compute summary performance metrics. The starting point is the conservation of energy for a well-mixed body: the rate of change of internal energy equals the net external heat flux, which yields the ordinary differential equation\n$$\nm c \\,\\frac{d T_b}{dt} = Q_{\\mathrm{sw}} + Q_{\\mathrm{lw}} + Q_{\\mathrm{conv}} + Q_{\\mathrm{cond}},\n$$\nwhere $m$ is mass, $c$ is specific heat capacity, $T_b$ is body temperature, $Q_{\\mathrm{sw}}$ is absorbed shortwave radiation, $Q_{\\mathrm{lw}}$ is net longwave radiative exchange with sky and ground, $Q_{\\mathrm{conv}}$ is convective heat exchange with air, and $Q_{\\mathrm{cond}}$ is conductive exchange with the substrate. Use the following well-tested physical laws and definitions as the fundamental base:\n- Shortwave absorption: $Q_{\\mathrm{sw}} = \\alpha_{\\mathrm{sw}} \\, S(t) \\, A_{\\mathrm{proj}}$, where $\\alpha_{\\mathrm{sw}}$ is shortwave absorptivity, $S(t)$ is global solar irradiance in $\\mathrm{W\\, m^{-2}}$, and $A_{\\mathrm{proj}}$ is the projected area normal to the sun. Model the body as a sphere of diameter $D$ with surface area $A_{\\mathrm{surf}} = 4 \\pi (D/2)^2$ and projected area $A_{\\mathrm{proj}} = \\pi (D/2)^2$.\n- Longwave radiation: Use the Stefan–Boltzmann law with emissivity $\\epsilon$ and Stefan–Boltzmann constant $\\sigma = 5.670374419 \\times 10^{-8}\\ \\mathrm{W\\, m^{-2}\\, K^{-4}}$. Let the view factors to sky and ground be $f_{\\mathrm{sky}} = 0.5$ and $f_{\\mathrm{gnd}} = 0.5$. Define an effective sky radiating temperature by $T_{\\mathrm{sky}}^4 = \\epsilon_{\\mathrm{sky}}\\, T_{\\mathrm{air}}^4$, where $\\epsilon_{\\mathrm{sky}}$ is an effective sky emissivity and $T_{\\mathrm{air}}$ is air temperature (both in $\\mathrm{K}$). Then\n$$\nQ_{\\mathrm{lw}} = \\epsilon \\sigma A_{\\mathrm{surf}} \\left[ f_{\\mathrm{sky}}\\left(T_{\\mathrm{sky}}^4 - T_b^4 \\right) + f_{\\mathrm{gnd}} \\left( T_{\\mathrm{g}}^4 - T_b^4 \\right) \\right],\n$$\nwhere $T_{\\mathrm{g}}$ is substrate temperature in $\\mathrm{K}$.\n- Convection: Use Newton’s law of cooling $Q_{\\mathrm{conv}} = h_c A_{\\mathrm{surf}} \\left( T_{\\mathrm{air}} - T_b \\right)$, with convective heat transfer coefficient $h_c = \\mathrm{Nu}\\, k_{\\mathrm{air}}/D$. Combine forced and free convection around a sphere using a Nusselt number combination\n$$\n\\mathrm{Nu} = \\left( \\mathrm{Nu}_{\\mathrm{forced}}^3 + \\mathrm{Nu}_{\\mathrm{nat}}^3 \\right)^{1/3},\n$$\nwhere $\\mathrm{Nu}_{\\mathrm{forced}} = 2 + 0.6 \\, \\mathrm{Re}^{1/2} \\, \\mathrm{Pr}^{1/3}$, $\\mathrm{Re} = U D / \\nu$, $U$ is wind speed, $\\nu$ is kinematic viscosity, $\\mathrm{Pr}$ is Prandtl number, and $k_{\\mathrm{air}}$ is air thermal conductivity. For natural convection, use the Churchill–Chu correlation for a sphere,\n$$\n\\mathrm{Nu}_{\\mathrm{nat}} = 2 + \\frac{0.589\\, \\mathrm{Ra}^{1/4}}{\\left[1 + \\left(0.469/\\mathrm{Pr}\\right)^{9/16}\\right]^{4/9}},\n\\quad\n\\mathrm{Ra} = \\frac{g \\beta |T_b - T_{\\mathrm{air}}| D^3}{\\nu \\alpha_{\\mathrm{air}}},\n$$\nwith gravitational acceleration $g = 9.81\\ \\mathrm{m\\, s^{-2}}$, volumetric thermal expansion coefficient $\\beta \\approx 1/T_{\\mathrm{film}}$ with $T_{\\mathrm{film}} = (T_b + T_{\\mathrm{air}})/2$, and thermal diffusivity $\\alpha_{\\mathrm{air}}$.\n- Conduction: Approximate contact conduction by $Q_{\\mathrm{cond}} = h_{\\mathrm{cond}} A_{\\mathrm{cond}} (T_{\\mathrm{g}} - T_b)$ with $h_{\\mathrm{cond}} = k_{\\mathrm{sub}}/d_{\\mathrm{cond}}$, where $k_{\\mathrm{sub}}$ is substrate thermal conductivity, $d_{\\mathrm{cond}}$ is an effective contact length scale, and $A_{\\mathrm{cond}} = \\eta_{\\mathrm{cond}} A_{\\mathrm{surf}}$ with contact fraction $\\eta_{\\mathrm{cond}}$.\n\nAssume air properties constants $k_{\\mathrm{air}} = 0.026\\ \\mathrm{W\\, m^{-1}\\, K^{-1}}$, $\\nu = 1.5 \\times 10^{-5}\\ \\mathrm{m^2\\, s^{-1}}$, $\\mathrm{Pr} = 0.71$, and $\\alpha_{\\mathrm{air}} = 2.1 \\times 10^{-5}\\ \\mathrm{m^2\\, s^{-1}}$. Use explicit Euler time stepping with time step $\\Delta t = 60\\ \\mathrm{s}$ over a $24$-hour period. Use initial condition $T_b(0) = T_{\\mathrm{air}}(0)$.\n\nForcing functions over the diel cycle use hours $t_h \\in [0, 24]$ and are defined as:\n- Solar irradiance $S(t_h) = S_{\\max} \\sin\\!\\left( \\pi \\frac{t_h - t_{\\mathrm{sunrise}}}{\\mathrm{daylength}} \\right)$ for $t_h \\in [t_{\\mathrm{sunrise}}, t_{\\mathrm{sunrise}} + \\mathrm{daylength}]$, and $S(t_h) = 0$ otherwise. $S$ is in $\\mathrm{W\\, m^{-2}}$.\n- Air temperature in degrees Celsius $T_{\\mathrm{air},^\\circ\\mathrm{C}}(t_h) = \\overline{T}_{\\mathrm{air}} + A_{\\mathrm{air}} \\sin\\!\\left( 2\\pi \\frac{t_h - \\phi_{\\mathrm{air}}}{24} \\right)$. Convert to Kelvin via $T_{\\mathrm{air}} = T_{\\mathrm{air},^\\circ\\mathrm{C}} + 273.15$.\n- Substrate temperature in degrees Celsius $T_{\\mathrm{g},^\\circ\\mathrm{C}}(t_h) = \\overline{T}_{\\mathrm{air}} + A_{\\mathrm{air}} (1 + \\gamma_{\\mathrm{g}}) \\sin\\!\\left( 2\\pi \\frac{t_h - \\phi_{\\mathrm{air}} - \\Delta \\phi_{\\mathrm{g}}}{24} \\right)$. Convert to Kelvin via $T_{\\mathrm{g}} = T_{\\mathrm{g},^\\circ\\mathrm{C}} + 273.15$.\n- Wind speed $U(t_h) = \\max\\!\\left( 0, \\overline{U} + A_U \\sin\\!\\left( 2\\pi \\frac{t_h - \\phi_U}{24} \\right) \\right)$ in $\\mathrm{m\\, s^{-1}}$.\n\nOutput requirements:\n- For each test case, compute two quantities: the maximum body temperature over the $24$-hour period expressed in degrees Celsius, and the total time with $T_b$ strictly above a thermal optimum $T_{\\mathrm{opt}}$ (defined in degrees Celsius) expressed in hours. Express the maximum body temperature in degrees Celsius rounded to three decimal places, and the total time above $T_{\\mathrm{opt}}$ as a decimal number of hours rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[\\mathrm{result1},\\mathrm{result2},\\ldots\\right]$), concatenating the two numbers from each test case in order.\n\nUse the following four scientifically plausible test cases. Unless otherwise specified, use $\\phi_{\\mathrm{air}} = 15.0\\ \\mathrm{h}$ and $\\phi_U = 14.0\\ \\mathrm{h}$, $f_{\\mathrm{sky}} = 0.5$, $f_{\\mathrm{gnd}} = 0.5$.\n\n- Test case $1$ (clear, moderate wind, small ectotherm):\n    - Morphology and materials: $m = 0.05\\ \\mathrm{kg}$, $D = 0.05\\ \\mathrm{m}$, $c = 3500\\ \\mathrm{J\\, kg^{-1}\\, K^{-1}}$, $\\alpha_{\\mathrm{sw}} = 0.85$, $\\epsilon = 0.95$, $\\eta_{\\mathrm{cond}} = 0.10$, $d_{\\mathrm{cond}} = 0.01\\ \\mathrm{m}$, $k_{\\mathrm{sub}} = 1.0\\ \\mathrm{W\\, m^{-1}\\, K^{-1}}$, $T_{\\mathrm{opt}} = 35.0^\\circ\\mathrm{C}$.\n    - Forcing: $S_{\\max} = 900\\ \\mathrm{W\\, m^{-2}}$, $\\epsilon_{\\mathrm{sky}} = 0.78$, $\\overline{T}_{\\mathrm{air}} = 25.0^\\circ\\mathrm{C}$, $A_{\\mathrm{air}} = 10.0^\\circ\\mathrm{C}$, $\\gamma_{\\mathrm{g}} = 0.5$, $\\Delta \\phi_{\\mathrm{g}} = -1.0\\ \\mathrm{h}$, $\\overline{U} = 1.0\\ \\mathrm{m\\, s^{-1}}$, $A_U = 1.0\\ \\mathrm{m\\, s^{-1}}$, $\\mathrm{daylength} = 12.0\\ \\mathrm{h}$, $t_{\\mathrm{sunrise}} = 6.0\\ \\mathrm{h}$.\n\n- Test case $2$ (cloudy, windier):\n    - Morphology and materials: identical to test case $1$ except $T_{\\mathrm{opt}} = 33.0^\\circ\\mathrm{C}$.\n    - Forcing: $S_{\\max} = 400\\ \\mathrm{W\\, m^{-2}}$, $\\epsilon_{\\mathrm{sky}} = 0.90$, $\\overline{T}_{\\mathrm{air}} = 22.0^\\circ\\mathrm{C}$, $A_{\\mathrm{air}} = 6.0^\\circ\\mathrm{C}$, $\\gamma_{\\mathrm{g}} = 0.3$, $\\Delta \\phi_{\\mathrm{g}} = -1.0\\ \\mathrm{h}$, $\\overline{U} = 2.0\\ \\mathrm{m\\, s^{-1}}$, $A_U = 1.0\\ \\mathrm{m\\, s^{-1}}$, $\\mathrm{daylength} = 12.0\\ \\mathrm{h}$, $t_{\\mathrm{sunrise}} = 6.0\\ \\mathrm{h}$.\n\n- Test case $3$ (very windy, cool mean air temperature):\n    - Morphology and materials: identical to test case $1$ except $T_{\\mathrm{opt}} = 34.0^\\circ\\mathrm{C}$.\n    - Forcing: $S_{\\max} = 900\\ \\mathrm{W\\, m^{-2}}$, $\\epsilon_{\\mathrm{sky}} = 0.80$, $\\overline{T}_{\\mathrm{air}} = 20.0^\\circ\\mathrm{C}$, $A_{\\mathrm{air}} = 8.0^\\circ\\mathrm{C}$, $\\gamma_{\\mathrm{g}} = 0.5$, $\\Delta \\phi_{\\mathrm{g}} = -1.0\\ \\mathrm{h}$, $\\overline{U} = 5.0\\ \\mathrm{m\\, s^{-1}}$, $A_U = 3.0\\ \\mathrm{m\\, s^{-1}}$, $\\mathrm{daylength} = 12.0\\ \\mathrm{h}$, $t_{\\mathrm{sunrise}} = 6.0\\ \\mathrm{h}$.\n\n- Test case $4$ (larger ectotherm, warmer mean conditions):\n    - Morphology and materials: $m = 0.30\\ \\mathrm{kg}$, $D = 0.09\\ \\mathrm{m}$, $c = 3500\\ \\mathrm{J\\, kg^{-1}\\, K^{-1}}$, $\\alpha_{\\mathrm{sw}} = 0.85$, $\\epsilon = 0.95$, $\\eta_{\\mathrm{cond}} = 0.10$, $d_{\\mathrm{cond}} = 0.01\\ \\mathrm{m}$, $k_{\\mathrm{sub}} = 1.0\\ \\mathrm{W\\, m^{-1}\\, K^{-1}}$, $T_{\\mathrm{opt}} = 38.0^\\circ\\mathrm{C}$.\n    - Forcing: $S_{\\max} = 900\\ \\mathrm{W\\, m^{-2}}$, $\\epsilon_{\\mathrm{sky}} = 0.80$, $\\overline{T}_{\\mathrm{air}} = 28.0^\\circ\\mathrm{C}$, $A_{\\mathrm{air}} = 12.0^\\circ\\mathrm{C}$, $\\gamma_{\\mathrm{g}} = 0.7$, $\\Delta \\phi_{\\mathrm{g}} = -1.0\\ \\mathrm{h}$, $\\overline{U} = 1.0\\ \\mathrm{m\\, s^{-1}}$, $A_U = 1.0\\ \\mathrm{m\\, s^{-1}}$, $\\mathrm{daylength} = 12.0\\ \\mathrm{h}$, $t_{\\mathrm{sunrise}} = 6.0\\ \\mathrm{h}$.\n\nAngle units: use radians for all trigonometric functions. Physical units: ensure all inputs and internal computations use International System of Units (SI) where applicable. The final answers must be expressed in the specified units: degrees Celsius for maximum body temperature and hours for time above $T_{\\mathrm{opt}}$, each rounded to three decimal places. The program must output a single line with the concatenated results for the four test cases in the exact format $\\left[\\mathrm{r}_1,\\mathrm{r}_2,\\ldots,\\mathrm{r}_8\\right]$ as described above, where $\\mathrm{r}_{2k-1}$ is the maximum body temperature (degrees Celsius) and $\\mathrm{r}_{2k}$ is the time above $T_{\\mathrm{opt}}$ (hours) for test case $k$.", "solution": "The problem statement presents a scientifically valid initial value problem grounded in the principles of biophysical ecology and heat transfer physics. It describes the thermal dynamics of a well-mixed, spherical ectotherm using a first-order ordinary differential equation (ODE) derived from the conservation of energy. All physical parameters, constants, forcing functions, and initial conditions are provided, making the problem well-posed and self-contained. The specified parameter values are physically realistic. Therefore, a meaningful numerical solution can be computed.\n\nThe core of the problem is to solve the ODE for the body temperature $T_b$ over a $24$-hour diel cycle:\n$$\nm c \\,\\frac{d T_b}{dt} = Q_{\\mathrm{net}}(t, T_b) = Q_{\\mathrm{sw}} + Q_{\\mathrm{lw}} + Q_{\\mathrm{conv}} + Q_{\\mathrm{cond}}\n$$\nwhere $m$ is the mass, $c$ is the specific heat capacity, and the terms on the right-hand side represent the net heat fluxes from shortwave radiation, longwave radiation, convection, and conduction, respectively.\n\nAs specified, this ODE is solved numerically using the explicit Euler method. The temperature at the next time step, $T_b(t+\\Delta t)$, is determined from the temperature at the current time step, $T_b(t)$, by the following update rule:\n$$\nT_b(t+\\Delta t) = T_b(t) + \\frac{\\Delta t}{m c} Q_{\\mathrm{net}}(t, T_b(t))\n$$\nThe simulation is performed over a $24$-hour period with a fixed time step of $\\Delta t=60$ seconds. The initial condition is $T_b(0) = T_{\\mathrm{air}}(0)$. All calculations are performed in SI units, with temperatures in Kelvin ($K$).\n\nThe solution is implemented through the following steps for each test case:\n\n1.  **Initialization and Environmental Forcing**: All physical constants and morphological parameters are defined. The time-dependent environmental variables—solar irradiance $S(t)$, air temperature $T_{\\mathrm{air}}(t)$, substrate temperature $T_{\\mathrm{g}}(t)$, and wind speed $U(t)$—are pre-calculated as time series arrays for the entire $24$-hour period, a total of $N = (24 \\times 3600) / 60 = 1440$ time steps. Forcing temperatures, given in degrees Celsius, are converted to Kelvin using the relation $T_K = T_{^\\circ\\mathrm{C}} + 273.15$. The time variable $t_h$ in hours is converted to seconds for the simulation. The body temperature history array, $T_b$, is initialized with $T_b(0) = T_{\\mathrm{air}}(0)$.\n\n2.  **Time-Stepping Simulation**: A loop iterates from $t=0$ to $t = 24 \\times 3600 - \\Delta t$. In each iteration $i$, corresponding to time $t_i$:\n    *   The current body temperature $T_{b,i}$ and environmental conditions ($S_i, T_{\\mathrm{air},i}, T_{\\mathrm{g},i}, U_i$) are used to compute the four heat flux terms.\n    *   **Shortwave Radiation ($Q_{\\mathrm{sw}}$)**: $Q_{\\mathrm{sw}} = \\alpha_{\\mathrm{sw}} \\, S(t_i) \\, A_{\\mathrm{proj}}$, where the projected area of the sphere is $A_{\\mathrm{proj}} = \\pi (D/2)^2$.\n    *   **Longwave Radiation ($Q_{\\mathrm{lw}}$)**: $Q_{\\mathrm{lw}} = \\epsilon \\sigma A_{\\mathrm{surf}} [ f_{\\mathrm{sky}}(T_{\\mathrm{sky},i}^4 - T_{b,i}^4) + f_{\\mathrm{gnd}}(T_{\\mathrm{g},i}^4 - T_{b,i}^4) ]$. The effective sky temperature is $T_{\\mathrm{sky},i} = (\\epsilon_{\\mathrm{sky}} T_{\\mathrm{air},i}^4)^{1/4}$. The surface area is $A_{\\mathrm{surf}} = \\pi D^2$ and view factors are $f_{\\mathrm{sky}}=f_{\\mathrm{gnd}}=0.5$.\n    *   **Convection ($Q_{\\mathrm{conv}}$)**: $Q_{\\mathrm{conv}} = h_{c,i} A_{\\mathrm{surf}} (T_{\\mathrm{air},i} - T_{b,i})$. The heat transfer coefficient $h_{c,i}$ depends on the combined Nusselt number $\\mathrm{Nu}_i = (\\mathrm{Nu}_{\\mathrm{forced},i}^3 + \\mathrm{Nu}_{\\mathrm{nat},i}^3)^{1/3}$. This requires calculating the Reynolds number $\\mathrm{Re}_i = U_i D / \\nu$ for forced convection and the Rayleigh number $\\mathrm{Ra}_i = g \\beta_i |T_{b,i} - T_{\\mathrm{air},i}| D^3 / (\\nu \\alpha_{\\mathrm{air}})$ for natural convection. The volumetric expansion coefficient $\\beta_i$ is approximated as $1/T_{\\mathrm{film},i}$ where $T_{\\mathrm{film},i}=(T_{b,i}+T_{\\mathrm{air},i})/2$.\n    *   **Conduction ($Q_{\\mathrm{cond}}$)**: $Q_{\\mathrm{cond}} = h_{\\mathrm{cond}} A_{\\mathrm{cond}} (T_{\\mathrm{g},i} - T_{b,i})$, with $h_{\\mathrm{cond}} = k_{\\mathrm{sub}}/d_{\\mathrm{cond}}$ and $A_{\\mathrm{cond}} = \\eta_{\\mathrm{cond}} A_{\\mathrm{surf}}$.\n    *   The net heat flux $Q_{\\mathrm{net},i}$ is summed, and the body temperature for the next time step, $T_{b,i+1}$, is calculated using the Euler formula.\n\n3.  **Post-Processing and Output**: After the simulation loop completes:\n    *   The entire body temperature history, $T_b$, is converted from Kelvin to degrees Celsius.\n    *   The maximum body temperature is found by taking the maximum value of the $T_b$ history in Celsius.\n    *   The total time for which the body temperature is strictly greater than the thermal optimum, $T_b > T_{\\mathrm{opt}}$, is calculated. This is achieved by summing the number of time steps (after $t=0$) where the condition is met and multiplying by the duration of a single time step, $\\Delta t = 60$ s. The result is converted to hours.\n    *   The two calculated metrics (maximum temperature in Celsius and time above optimum in hours) are rounded to three decimal places.\n\nThis procedure is repeated for all four test cases, and the results are concatenated into a single comma-separated list as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ectotherm thermal balance problem for the given test cases.\n    \"\"\"\n    # Physical and simulation constants\n    sigma = 5.670374419e-8  # Stefan-Boltzmann constant, W m^-2 K^-4\n    g = 9.81              # Gravitational acceleration, m s^-2\n    k_air = 0.026           # Thermal conductivity of air, W m^-1 K^-1\n    nu = 1.5e-5             # Kinematic viscosity of air, m^2 s^-1\n    Pr = 0.71               # Prandtl number for air\n    alpha_air = 2.1e-5      # Thermal diffusivity of air, m^2 s^-1\n    dt_s = 60.0             # Time step, s\n    sim_duration_h = 24.0\n    sim_duration_s = sim_duration_h * 3600.0\n    time_s = np.arange(0, sim_duration_s + dt_s, dt_s)\n    time_h = time_s / 3600.0\n    n_points = len(time_s)\n\n    # Test case parameters organized in a list of dictionaries\n    test_cases = [\n        {\n            \"m\": 0.05, \"D\": 0.05, \"c\": 3500, \"alpha_sw\": 0.85, \"epsilon\": 0.95,\n            \"eta_cond\": 0.10, \"d_cond\": 0.01, \"k_sub\": 1.0, \"T_opt_C\": 35.0,\n            \"S_max\": 900, \"epsilon_sky\": 0.78, \"T_air_mean_C\": 25.0, \"A_air_C\": 10.0,\n            \"gamma_g\": 0.5, \"Delta_phi_g\": -1.0, \"U_mean\": 1.0, \"A_U\": 1.0,\n            \"daylength\": 12.0, \"t_sunrise\": 6.0, \"phi_air\": 15.0, \"phi_U\": 14.0,\n            \"f_sky\": 0.5, \"f_gnd\": 0.5\n        },\n        {\n            \"m\": 0.05, \"D\": 0.05, \"c\": 3500, \"alpha_sw\": 0.85, \"epsilon\": 0.95,\n            \"eta_cond\": 0.10, \"d_cond\": 0.01, \"k_sub\": 1.0, \"T_opt_C\": 33.0,\n            \"S_max\": 400, \"epsilon_sky\": 0.90, \"T_air_mean_C\": 22.0, \"A_air_C\": 6.0,\n            \"gamma_g\": 0.3, \"Delta_phi_g\": -1.0, \"U_mean\": 2.0, \"A_U\": 1.0,\n            \"daylength\": 12.0, \"t_sunrise\": 6.0, \"phi_air\": 15.0, \"phi_U\": 14.0,\n            \"f_sky\": 0.5, \"f_gnd\": 0.5\n        },\n        {\n            \"m\": 0.05, \"D\": 0.05, \"c\": 3500, \"alpha_sw\": 0.85, \"epsilon\": 0.95,\n            \"eta_cond\": 0.10, \"d_cond\": 0.01, \"k_sub\": 1.0, \"T_opt_C\": 34.0,\n            \"S_max\": 900, \"epsilon_sky\": 0.80, \"T_air_mean_C\": 20.0, \"A_air_C\": 8.0,\n            \"gamma_g\": 0.5, \"Delta_phi_g\": -1.0, \"U_mean\": 5.0, \"A_U\": 3.0,\n            \"daylength\": 12.0, \"t_sunrise\": 6.0, \"phi_air\": 15.0, \"phi_U\": 14.0,\n            \"f_sky\": 0.5, \"f_gnd\": 0.5\n        },\n        {\n            \"m\": 0.30, \"D\": 0.09, \"c\": 3500, \"alpha_sw\": 0.85, \"epsilon\": 0.95,\n            \"eta_cond\": 0.10, \"d_cond\": 0.01, \"k_sub\": 1.0, \"T_opt_C\": 38.0,\n            \"S_max\": 900, \"epsilon_sky\": 0.80, \"T_air_mean_C\": 28.0, \"A_air_C\": 12.0,\n            \"gamma_g\": 0.7, \"Delta_phi_g\": -1.0, \"U_mean\": 1.0, \"A_U\": 1.0,\n            \"daylength\": 12.0, \"t_sunrise\": 6.0, \"phi_air\": 15.0, \"phi_U\": 14.0,\n            \"f_sky\": 0.5, \"f_gnd\": 0.5\n        }\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        # Pre-calculate time series for forcing functions\n        t_sun_phase = (time_h - params[\"t_sunrise\"]) / params[\"daylength\"]\n        S_t = np.zeros_like(time_h)\n        daylight_mask = (time_h >= params[\"t_sunrise\"]) & (time_h < (params[\"t_sunrise\"] + params[\"daylength\"]))\n        S_t[daylight_mask] = params[\"S_max\"] * np.sin(np.pi * t_sun_phase[daylight_mask])\n\n        T_air_C_t = params[\"T_air_mean_C\"] + params[\"A_air_C\"] * np.sin(2 * np.pi * (time_h - params[\"phi_air\"]) / 24.0)\n        T_air_K_t = T_air_C_t + 273.15\n\n        T_g_C_t = params[\"T_air_mean_C\"] + params[\"A_air_C\"] * (1 + params[\"gamma_g\"]) * np.sin(2 * np.pi * (time_h - params[\"phi_air\"] - params[\"Delta_phi_g\"]) / 24.0)\n        T_g_K_t = T_g_C_t + 273.15\n\n        U_raw = params[\"U_mean\"] + params[\"A_U\"] * np.sin(2 * np.pi * (time_h - params[\"phi_U\"]) / 24.0)\n        U_t = np.maximum(0, U_raw)\n\n        # Body and heat transfer parameters\n        m, c, D = params[\"m\"], params[\"c\"], params[\"D\"]\n        A_surf = np.pi * D**2\n        A_proj = np.pi * (D / 2)**2\n        A_cond = params[\"eta_cond\"] * A_surf\n        h_cond = params[\"k_sub\"] / params[\"d_cond\"]\n        mc_inv = 1.0 / (m * c)\n        \n        # Initialize body temperature history\n        Tb_K_history = np.zeros(n_points)\n        Tb_K_history[0] = T_air_K_t[0]\n\n        # Time-stepping loop\n        for i in range(n_points - 1):\n            Tb_K = Tb_K_history[i]\n            T_air_K, T_g_K, U, S = T_air_K_t[i], T_g_K_t[i], U_t[i], S_t[i]\n            \n            # 1. Shortwave radiation\n            Q_sw = params[\"alpha_sw\"] * S * A_proj\n\n            # 2. Longwave radiation\n            T_sky_K_4 = params[\"epsilon_sky\"] * T_air_K**4\n            Q_lw = params[\"epsilon\"] * sigma * A_surf * (\n                params[\"f_sky\"] * (T_sky_K_4 - Tb_K**4) + params[\"f_gnd\"] * (T_g_K**4 - Tb_K**4)\n            )\n            \n            # 3. Convection\n            T_film_K = (Tb_K + T_air_K) / 2\n            beta = 1.0 / T_film_K\n            Re = U * D / nu\n            Ra = (g * beta * abs(Tb_K - T_air_K) * D**3) / (nu * alpha_air)\n            Nu_forced = 2.0 + 0.6 * Re**0.5 * Pr**(1/3)\n            _nat_denom = (1 + (0.469 / Pr)**(9/16))**(4/9)\n            Nu_nat = 2.0 + (0.589 * Ra**0.25) / _nat_denom\n            Nu = (Nu_forced**3 + Nu_nat**3)**(1/3)\n            h_c = Nu * k_air / D\n            Q_conv = h_c * A_surf * (T_air_K - Tb_K)\n\n            # 4. Conduction\n            Q_cond = h_cond * A_cond * (T_g_K - Tb_K)\n\n            # Total heat flux and temperature update\n            Q_net = Q_sw + Q_lw + Q_conv + Q_cond\n            dTb_dt = Q_net * mc_inv\n            Tb_K_history[i+1] = Tb_K + dTb_dt * dt_s\n\n        # Post-processing\n        Tb_C_history = Tb_K_history - 273.15\n        max_Tb_C = np.max(Tb_C_history)\n        \n        # Calculate time above T_opt, excluding t=0 point\n        time_above_opt_s = np.sum(Tb_C_history[1:] > params[\"T_opt_C\"]) * dt_s\n        time_above_opt_h = time_above_opt_s / 3600.0\n\n        all_results.append(round(max_Tb_C, 3))\n        all_results.append(round(time_above_opt_h, 3))\n\n    # Format and print the final output string\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2539109"}]}