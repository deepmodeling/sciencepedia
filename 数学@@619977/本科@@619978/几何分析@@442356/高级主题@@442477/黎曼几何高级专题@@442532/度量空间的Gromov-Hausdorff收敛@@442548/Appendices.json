{"hands_on_practices": [{"introduction": "要真正掌握一个抽象的数学定义，最好的方法莫过于从最简单的非平凡例子入手。这个练习将引导你直接应用格罗莫夫-豪斯多夫距离（Gromov-Hausdorff distance）的原始定义，来计算两个仅有两点的度量空间之间的距离。通过构造一个巧妙的等距嵌入来找到距离的上限，并利用度量空间的内在性质来证明一个匹配的下限，你将熟练掌握证明格罗莫夫-豪斯多夫距离值的核心技巧。[@problem_id:3050664]", "problem": "设 $\\left(X,d_{X}\\right)$ 和 $\\left(Y,d_{Y}\\right)$ 是两个度量空间，并用 $d_{H}^{Z}(A,B)$ 表示度量空间 $\\left(Z,d_{Z}\\right)$ 的子集 $A$ 和 $B$ 之间的 Hausdorff 距离，其定义为\n$$\nd_{H}^{Z}(A,B) \\coloneqq \\max\\left\\{\\sup_{a \\in A}\\inf_{b \\in B} d_{Z}(a,b),\\ \\sup_{b \\in B}\\inf_{a \\in A} d_{Z}(b,a)\\right\\}.\n$$\n度量空间 $\\left(X,d_{X}\\right)$ 和 $\\left(Y,d_{Y}\\right)$ 之间的 Gromov–Hausdorff 距离（GH 距离）定义为\n$$\nd_{GH}(X,Y) \\coloneqq \\inf\\left\\{d_{H}^{Z}\\big(\\varphi(X),\\psi(Y)\\big)\\ :\\ \\text{$\\varphi:X\\to Z$ 和 $\\psi:Y\\to Z$ 是到某个度量空间 $Z$ 中的等距嵌入}\\right\\}.\n$$\n考虑两点度量空间 $X=\\{x_{1},x_{2}\\}$ 和 $Y=\\{y_{1},y_{2}\\}$，满足 $d_{X}(x_{1},x_{2})=a$ 和 $d_{Y}(y_{1},y_{2})=b$，其中 $a>0$ 且 $b>0$。仅使用上述定义和度量空间的标准性质，计算 $d_{GH}(X,Y)$ 的精确值，并以 $a$ 和 $b$ 的封闭形式表达式给出。请以最简的精确符号形式给出答案，无需舍入。", "solution": "用户提供的问题基于以下评估被判定为 **有效**。\n\n1.  **已知条件提取**：\n    *   度量空间为 $(X,d_{X})$ 和 $(Y,d_{Y})$。\n    *   Hausdorff 距离定义：$d_{H}^{Z}(A,B) \\coloneqq \\max\\left\\{\\sup_{a \\in A}\\inf_{b \\in B} d_{Z}(a,b),\\ \\sup_{b \\in B}\\inf_{a \\in A} d_{Z}(b,a)\\right\\}$。\n    *   Gromov–Hausdorff 距离定义：$d_{GH}(X,Y) \\coloneqq \\inf\\left\\{d_{H}^{Z}\\big(\\varphi(X),\\psi(Y)\\big)\\ :\\ \\text{$\\varphi:X\\to Z$ 和 $\\psi:Y\\to Z$ 是到某个度量空间 $Z$ 中的等距嵌入}\\right\\}$。\n    *   具体度量空间：$X=\\{x_{1},x_{2}\\}$ 满足 $d_{X}(x_{1},x_{2})=a$，其中 $a>0$。$Y=\\{y_{1},y_{2}\\}$ 满足 $d_{Y}(y_{1},y_{2})=b$，其中 $b>0$。\n    *   目标：计算以 $a$ 和 $b$ 表示的 $d_{GH}(X,Y)$ 的精确值。\n\n2.  **有效性验证**：\n    *   **科学基础**：该问题在度量几何这一数学分支内被正确地表述。所有定义都是标准的，并且在数学上是严谨的。\n    *   **适定性**：问题是无歧义的，旨在根据所提供的数据和定义求出一个特定的、可计算的量。存在唯一解。\n    *   **客观性**：问题陈述使用了精确、形式化的数学语言，不包含主观或不严谨的内容。\n    *   **结论**：该问题是自洽的、一致的且科学上有效的。它没有违反任何指定的无效性标准。我们可以继续进行求解。\n\n该解将通过为 $d_{GH}(X,Y)$ 寻找一个上界和一个与之匹配的下界来确定。\n\n**1. 寻找上界**\n\nGromov-Hausdorff 距离定义为，对于所有可能的到公共度量空间 $Z$ 的等距嵌入，其 Hausdorff 距离的下确界。为了找到一个上界，我们可以构造一个这样的特定嵌入，并计算相应的 Hausdorff 距离。\n\n设公共度量空间为具有标准度量的实数轴，$Z = (\\mathbb{R}, d)$，其中 $d(u,v)=|u-v|$。我们需要找到等距嵌入 $\\varphi: X \\to \\mathbb{R}$ 和 $\\psi: Y \\to \\mathbb{R}$。\n\n我们为 $X$ 定义嵌入 $\\varphi$：\n$\\varphi(x_1) = 0$\n$\\varphi(x_2) = a$\n像点之间的距离是 $d(\\varphi(x_1), \\varphi(x_2)) = |0-a|=a$，这等于 $d_X(x_1, x_2)$。因此，$\\varphi$ 是一个等距嵌入。其像为集合 $\\varphi(X)=\\{0, a\\}$。\n\n现在，我们为 $Y$ 定义嵌入 $\\psi$。为了保持一般性，我们引入一个自由参数 $c \\in \\mathbb{R}$，表示沿实数轴的平移。\n$\\psi(y_1) = c$\n$\\psi(y_2) = c+b$\n像点之间的距离是 $d(\\psi(y_1), \\psi(y_2)) = |c-(c+b)|=|-b|=b$，这等于 $d_Y(y_1, y_2)$。因此，对于 $c$ 的任何选择，$\\psi$ 都是一个等距嵌入。其像为集合 $\\psi(Y)=\\{c, c+b\\}$。\n\n现在，我们计算集合 $A=\\{0, a\\}$ 和 $B=\\{c, c+b\\}$ 之间的 Hausdorff 距离 $d_H^{\\mathbb{R}}(\\varphi(X), \\psi(Y))$。\n$d_H^{\\mathbb{R}}(A,B) = \\max\\left\\{\\sup_{p \\in A}\\inf_{q \\in B} |p-q|,\\ \\sup_{q \\in B}\\inf_{p \\in A} |q-p|\\right\\}$。\n\n我们来计算第一项，$\\sup_{p \\in A}\\inf_{q \\in B} |p-q|$：\n$$ \\sup_{p \\in \\{0,a\\}} \\min\\{|p-c|, |p-(c+b)|\\} = \\max\\{\\min\\{|c|, |c+b|\\}, \\min\\{|a-c|, |a-c-b|\\}\\} $$\n为了最小化 Hausdorff 距离，我们应该选择 $c$ 以使集合 $A$ 和 $B$ 尽可能“对齐”。一个自然的选择是使它们的中点对齐。$A$ 的中点是 $a/2$，$B$ 的中点是 $c+b/2$。令它们相等：\n$c+b/2 = a/2 \\implies c=\\frac{a-b}{2}$。\n\n我们来计算对于这个 $c$ 的选择所对应的 Hausdorff 距离。集合 $B$ 变为 $\\{\\frac{a-b}{2}, \\frac{a-b}{2}+b\\} = \\{\\frac{a-b}{2}, \\frac{a+b}{2}\\}$。不失一般性地，我们假设 $a \\ge b > 0$。\n\n第一项：$\\sup_{p \\in A} d(p,B) = \\max\\{d(0,B), d(a,B)\\}$。\n$d(0,B) = \\min\\{|0-\\frac{a-b}{2}|, |0-\\frac{a+b}{2}|\\} = \\min\\{\\frac{a-b}{2}, \\frac{a+b}{2}\\} = \\frac{a-b}{2}$。\n$d(a,B) = \\min\\{|a-\\frac{a-b}{2}|, |a-\\frac{a+b}{2}|\\} = \\min\\{|\\frac{a+b}{2}|, |\\frac{a-b}{2}|\\} = \\frac{a-b}{2}$。\n所以，$\\sup_{p \\in A} d(p,B) = \\max\\{\\frac{a-b}{2}, \\frac{a-b}{2}\\} = \\frac{a-b}{2}$。\n\n第二项：$\\sup_{q \\in B} d(q,A) = \\max\\{d(\\frac{a-b}{2},A), d(\\frac{a+b}{2},A)\\}$。\n$d(\\frac{a-b}{2},A) = \\min\\{|\\frac{a-b}{2}-0|, |\\frac{a-b}{2}-a|\\} = \\min\\{\\frac{a-b}{2}, |-\\frac{a+b}{2}|\\} = \\frac{a-b}{2}$。\n$d(\\frac{a+b}{2},A) = \\min\\{|\\frac{a+b}{2}-0|, |\\frac{a+b}{2}-a|\\} = \\min\\{\\frac{a+b}{2}, |-\\frac{a-b}{2}|\\} = \\frac{a-b}{2}$。\n所以，$\\sup_{q \\in B} d(q,A) = \\max\\{\\frac{a-b}{2}, \\frac{a-b}{2}\\} = \\frac{a-b}{2}$。\n\n对于此配置，Hausdorff 距离为 $d_H^{\\mathbb{R}}(A,B) = \\frac{a-b}{2}$。\n如果我们假设 $b \\ge a$，同样的计算会得到 $\\frac{b-a}{2}$。因此，对于任何 $a,b>0$，这种构造得出的 Hausdorff 距离为 $\\frac{|a-b|}{2}$。\n由于 Gromov-Hausdorff 距离是所有可能嵌入的下确界，这个特定值提供了一个上界：\n$$ d_{GH}(X,Y) \\le \\frac{|a-b|}{2} $$\n\n**2. 寻找下界**\n\n接下来，我们证明对于到任何度量空间 $Z$ 的任何等距嵌入，其 Hausdorff 距离不能小于 $\\frac{|a-b|}{2}$。\n\n设 $\\varphi: X \\to Z$ 和 $\\psi: Y \\to Z$ 是到任意度量空间 $(Z, d_Z)$ 的任何等距嵌入。\n令 $P = \\varphi(X) = \\{p_1, p_2\\}$ 和 $Q = \\psi(Y) = \\{q_1, q_2\\}$。\n由于嵌入是等距的，我们有 $d_Z(p_1, p_2) = a$ 和 $d_Z(q_1, q_2) = b$。\n\n令 $\\epsilon = d_H^Z(P, Q)$。根据 Hausdorff 距离的定义，对于一个集合中的每个点，在另一个集合中都存在一个点，其距离不大于 $\\epsilon$。具体来说：\n1. $d_Z(p_1, Q) = \\inf_{q \\in Q} d_Z(p_1, q) \\le \\epsilon$\n2. $d_Z(p_2, Q) = \\inf_{q \\in Q} d_Z(p_2, q) \\le \\epsilon$\n\n这意味着在 $Q$ 中存在一个点（我们称之为 $q_{j_1}$）使得 $d_Z(p_1, q_{j_1}) \\le \\epsilon$，以及另一个点（称之为 $q_{j_2}$）使得 $d_Z(p_2, q_{j_2}) \\le \\epsilon$。对于下标 $j_1$ 和 $j_2$ 有两种可能性。\n\n情况 1：$j_1 \\ne j_2$。我们可以重新标记 $Y$ 的点，使得 $j_1=1$ 且 $j_2=2$。\n这给出 $d_Z(p_1, q_1) \\le \\epsilon$ 和 $d_Z(p_2, q_2) \\le \\epsilon$。\n度量空间中四个点 $p_1, p_2, q_1, q_2$ 的三角不等式蕴含着四边形不等式：$|d_Z(p_1, p_2) - d_Z(q_1, q_2)| \\le d_Z(p_1, q_1) + d_Z(p_2, q_2)$。\n代入我们已知的距离和界限：\n$|a-b| \\le d_Z(p_1, q_1) + d_Z(p_2, q_2) \\le \\epsilon + \\epsilon = 2\\epsilon$。\n这意味着 $|a-b| \\le 2\\epsilon$，或者 $\\epsilon \\ge \\frac{|a-b|}{2}$。\n\n情况 2：$j_1 = j_2$。我们假设 $j_1=j_2=1$。\n这给出 $d_Z(p_1, q_1) \\le \\epsilon$ 和 $d_Z(p_2, q_1) \\le \\epsilon$。\n对点 $p_1, p_2, q_1$ 应用三角不等式：\n$a = d_Z(p_1, p_2) \\le d_Z(p_1, q_1) + d_Z(q_1, p_2) \\le \\epsilon + \\epsilon = 2\\epsilon$。\n所以，$\\epsilon \\ge a/2$。\n类似地，根据 Hausdorff 定义的另一部分，对于 $q_2 \\in Q$，必须存在一个点 $p_k \\in P$ 使得 $d_Z(q_2, p_k) \\le \\epsilon$。\n如果 $k=1$，那么 $d_Z(q_2, p_1) \\le \\epsilon$。结合 $d_Z(q_1, p_1) \\le \\epsilon$，三角不等式给出：\n$b = d_Z(q_1, q_2) \\le d_Z(q_1, p_1) + d_Z(p_1, q_2) \\le \\epsilon + \\epsilon = 2\\epsilon$。\n所以，$\\epsilon \\ge b/2$。在这种子情况下，我们同时有 $\\epsilon \\ge a/2$ 和 $\\epsilon \\ge b/2$，因此 $\\epsilon \\ge \\max(a,b)/2$。\n对 $k=2$ 进行类似分析也会得到 $\\epsilon \\ge \\max(a,b)/2$。\n\n任何嵌入配置都必须属于这些类别之一。因此，对于 $Z, \\varphi, \\psi$ 的任何选择，所产生的 Hausdorff 距离 $\\epsilon$ 都必须满足：\n$\\epsilon \\ge \\min \\left\\{ \\frac{|a-b|}{2}, \\frac{\\max(a,b)}{2} \\right\\}$。\n\n我们来分析这个下界。不失一般性地假设 $a \\ge b$。该界为 $\\min \\left\\{ \\frac{a-b}{2}, \\frac{a}{2} \\right\\}$。\n因为 $b>0$，我们有 $a-b  a$，所以 $\\frac{a-b}{2}  \\frac{a}{2}$。\n因此，最小值为 $\\frac{a-b}{2}$。\n如果我们假设 $b  a$，该界为 $\\min \\left\\{ \\frac{b-a}{2}, \\frac{b}{2} \\right\\}$，即 $\\frac{b-a}{2}$。\n在所有情况下，下界都简化为 $\\frac{|a-b|}{2}$。\n\n这意味着对于任何等距嵌入，Hausdorff 距离至少为 $\\frac{|a-b|}{2}$。Gromov-Hausdorff 距离作为所有这些距离的下确界，也必须满足这个界：\n$$ d_{GH}(X,Y) \\ge \\frac{|a-b|}{2} $$\n\n**3. 结论**\n\n我们已经为 Gromov-Hausdorff 距离建立了一个上界和一个下界：\n$$ \\frac{|a-b|}{2} \\le d_{GH}(X,Y) \\le \\frac{|a-b|}{2} $$\n这迫使等式成立。因此，两个指定度量空间之间的 Gromov-Hausdorff 距离的精确值为 $\\frac{|a-b|}{2}$。", "answer": "$$\n\\boxed{\\frac{|a-b|}{2}}\n$$", "id": "3050664"}, {"introduction": "除了通过等距嵌入来定义，格罗莫夫-豪斯多夫距离还有一个等价且非常强大的表述，即通过“对应”（correspondence）及其“扭曲度”（distortion）来刻画。这种观点在处理有限度量空间时尤其有效，它将几何问题转化为了一个组合优化问题。这个练习 [@problem_id:3048688] 将向你展示如何运用这个新视角，在一个比两点空间稍复杂的情形中，通过分析所有可能的对应关系来推导距离的下限，并最终精确地确定其值。", "problem": "设 $X=\\{0,1,2\\}$ 和 $Y=\\{0,2\\}$ 为有限度量空间，其度量由 $\\mathbb{R}$ 上的标准欧几里得距离诱导。紧度量空间之间的 Gromov–Hausdorff (GH) 距离 $d_{GH}(X,Y)$ 定义为，对于所有到公共度量空间 $Z$ 的等距嵌入 $\\varphi:X\\to Z$ 和 $\\psi:Y\\to Z$，$Z$ 中 Hausdorff 距离 $d_{H}^{Z}(\\varphi(X),\\psi(Y))$ 的下确界。其中，非空紧子集 $A,B\\subset Z$ 之间的 Hausdorff 距离为\n$$\nd_{H}^{Z}(A,B)=\\max\\left\\{\\sup_{a\\in A}\\inf_{b\\in B}d_{Z}(a,b),\\ \\sup_{b\\in B}\\inf_{a\\in A}d_{Z}(a,b)\\right\\}。\n$$\n等价地，对于紧度量空间，我们有如下的对应刻画\n$$\nd_{GH}(X,Y)=\\frac{1}{2}\\inf_{R}\\operatorname{dis}(R),\n$$\n其中，一个对应 $R\\subset X\\times Y$ 是一个到 $X$ 和 $Y$ 都是满射的关系，其失真为\n$$\n\\operatorname{dis}(R)=\\sup\\left\\{|d_{X}(x,x')-d_{Y}(y,y')|:\\ (x,y),(x',y')\\in R\\right\\}。\n$$\n仅使用这些定义，通过分析 $X$ 和 $Y$ 之间对应的失真，证明一个下界 $d_{GH}(X,Y)\\geq \\frac{1}{2}$。然后，构造 $X$ 和 $Y$ 到一个公共度量空间中的显式等距嵌入，使得 Hausdorff 距离为 $\\frac{1}{2}$，从而给出一个匹配的上界。求出 $d_{GH}(X,Y)$ 的确切值。将你的最终答案表示为最简分数。无需四舍五入。", "solution": "该问题是有效的，因为它是度量几何领域内一个定义明确的数学问题，使用了标准定义并提供了所有必要的信息。\n\n设这两个度量空间为 $(X, d_X)$ 和 $(Y, d_Y)$。集合 $X = \\{0, 1, 2\\}$ 配备了由 $\\mathbb{R}$ 上的标准欧几里得距离诱导的度量 $d_X$，因此 $d_X(x, x') = |x-x'|$。$X$ 中不同点之间的距离为 $d_X(0, 1) = 1$，$d_X(1, 2) = 1$ 和 $d_X(0, 2) = 2$。\n集合 $Y = \\{0, 2\\}$ 也配备了由标准欧几里得距离诱导的度量 $d_Y$，因此 $d_Y(y, y') = |y-y'|$。$Y$ 中唯一的非零距离是 $d_Y(0, 2) = 2$。\n问题要求通过建立一个下界和一个匹配的上界来求 Gromov-Hausdorff 距离 $d_{GH}(X, Y)$。\n\n首先，我们使用 Gromov-Hausdorff 距离的对应定义来证明下界 $d_{GH}(X,Y) \\geq \\frac{1}{2}$，该定义表明 $d_{GH}(X,Y) = \\frac{1}{2}\\inf_{R}\\operatorname{dis}(R)$。一个对应 $R \\subset X \\times Y$ 是一个关系，其到 $X$ 和 $Y$ 的投影是满射的，即 $\\pi_X(R) = X$ 且 $\\pi_Y(R) = Y$。$R$ 的失真是 $\\operatorname{dis}(R)=\\sup\\left\\{|d_{X}(x,x')-d_{Y}(y,y')|:\\ (x,y),(x',y')\\in R\\right\\}$。\n\n设 $R$ 是 $X$ 和 $Y$ 之间的任意对应。\n由于 $\\pi_X(R) = X$，对于点 $1 \\in X$，必须存在至少一个元素 $y_1 \\in Y$，使得对 $(1, y_1)$ 在 $R$ 中。集合 $Y$ 是 $\\{0, 2\\}$，所以 $y_1$ 必须是 $0$ 或 $2$。\n由于 $\\pi_Y(R) = Y$，对于元素 $y_2 \\in Y$ 且 $y_2 \\neq y_1$，必须存在至少一个元素 $x_2 \\in X$，使得对 $(x_2, y_2)$ 在 $R$ 中。\n\n让我们考虑这两对 $(1, y_1) \\in R$ 和 $(x_2, y_2) \\in R$。根据失真的定义，对于任何这样的对，$\\operatorname{dis}(R)$ 必须大于或等于值 $|d_X(1, x_2) - d_Y(y_1, y_2)|$。\n由于 $y_1 \\in Y$ 和 $y_2 \\in Y$ 且 $y_1 \\neq y_2$，我们有 $\\{y_1, y_2\\} = \\{0, 2\\}$，这意味着 $d_Y(y_1, y_2) = |y_1 - y_2| = 2$。\n点 $x_2$ 属于 $X = \\{0, 1, 2\\}$。我们分析 $d_X(1, x_2)$ 的可能值：\n\\begin{itemize}\n    \\item 如果 $x_2 = 0$，$d_X(1, 0) = 1$。失真贡献是 $|1 - 2| = 1$。\n    \\item 如果 $x_2 = 1$，$d_X(1, 1) = 0$。失真贡献是 $|0 - 2| = 2$。\n    \\item 如果 $x_2 = 2$，$d_X(1, 2) = 1$。失真贡献是 $|1 - 2| = 1$。\n\\end{itemize}\n对于任意对应的选择 $R$，我们总能找到两对点，其失真至少为 $1$。因此，在所有点对上的上确界 $\\operatorname{dis}(R)$ 必须至少为 $1$。\n因为这对任何对应 $R$ 都成立，我们有 $\\inf_{R} \\operatorname{dis}(R) \\geq 1$。\n使用 Gromov-Hausdorff 距离的对应公式，我们建立下界：\n$$d_{GH}(X, Y) = \\frac{1}{2}\\inf_R\\operatorname{dis}(R) \\geq \\frac{1}{2}(1) = \\frac{1}{2}。$$\n\n接下来，我们通过构造 $X$ 和 $Y$ 到一个公共度量空间 $Z$ 的显式等距嵌入，并证明它们像之间的 Hausdorff 距离为 $\\frac{1}{2}$，来建立一个匹配的上界 $d_{GH}(X,Y) \\leq \\frac{1}{2}$。这种嵌入的存在性为所有可能的嵌入的下确界提供了一个上界。\n\n设公共度量空间为 $Z = \\mathbb{R}$，其标准度量为 $d_Z(a, b) = |a-b|$。\n我们通过 $\\varphi(x) = x$ 定义一个等距嵌入 $\\varphi: X \\to \\mathbb{R}$。这是一个等距，因为 $d_Z(\\varphi(x), \\varphi(x')) = |x-x'| = d_X(x, x')$。$X$ 的像是集合 $A = \\varphi(X) = \\{0, 1, 2\\}$。\n我们通过 $\\psi(y) = y - \\frac{1}{2}$ 定义第二个等距嵌入 $\\psi: Y \\to \\mathbb{R}$。这是一个等距，因为 $d_Z(\\psi(y), \\psi(y')) = |(y-\\frac{1}{2}) - (y'-\\frac{1}{2})| = |y-y'| = d_Y(y, y')$。$Y$ 的像是集合 $B = \\psi(Y) = \\{0-\\frac{1}{2}, 2-\\frac{1}{2}\\} = \\{-\\frac{1}{2}, \\frac{3}{2}\\}$。\n\n现在，我们计算 $A=\\{0, 1, 2\\}$ 和 $B=\\{-\\frac{1}{2}, \\frac{3}{2}\\}$ 之间的 Hausdorff 距离 $d_H^Z(A, B)$。定义是 $d_H^Z(A, B) = \\max\\left\\{\\sup_{a\\in A}\\inf_{b\\in B}d_Z(a,b), \\sup_{b\\in B}\\inf_{a\\in A}d_Z(a,b)\\right\\}$。\n\n首先，我们计算 $\\sup_{a\\in A}\\inf_{b\\in B}d_Z(a,b)$:\n\\begin{itemize}\n    \\item 对于 $a=0$：$\\inf_{b\\in B} d_Z(0, b) = \\min\\{|0-(-\\frac{1}{2})|, |0-\\frac{3}{2}|\\} = \\min\\{\\frac{1}{2}, \\frac{3}{2}\\} = \\frac{1}{2}$。\n    \\item 对于 $a=1$：$\\inf_{b\\in B} d_Z(1, b) = \\min\\{|1-(-\\frac{1}{2})|, |1-\\frac{3}{2}|\\} = \\min\\{\\frac{3}{2}, |-\\frac{1}{2}|\\} = \\frac{1}{2}$。\n    \\item 对于 $a=2$：$\\inf_{b\\in B} d_Z(2, b) = \\min\\{|2-(-\\frac{1}{2})|, |2-\\frac{3}{2}|\\} = \\min\\{\\frac{5}{2}, \\frac{1}{2}\\} = \\frac{1}{2}$。\n\\end{itemize}\n这些值的上确界是 $\\sup\\{\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}\\} = \\frac{1}{2}$。\n\n其次，我们计算 $\\sup_{b\\in B}\\inf_{a\\in A}d_Z(a,b)$:\n\\begin{itemize}\n    \\item 对于 $b=-\\frac{1}{2}$：$\\inf_{a\\in A} d_Z(a, -\\frac{1}{2}) = \\min\\{|0-(-\\frac{1}{2})|, |1-(-\\frac{1}{2})|, |2-(-\\frac{1}{2})|\\} = \\min\\{\\frac{1}{2}, \\frac{3}{2}, \\frac{5}{2}\\} = \\frac{1}{2}$。\n    \\item 对于 $b=\\frac{3}{2}$：$\\inf_{a\\in A} d_Z(a, \\frac{3}{2}) = \\min\\{|0-\\frac{3}{2}|, |1-\\frac{3}{2}|, |2-\\frac{3}{2}|\\} = \\min\\{\\frac{3}{2}, |-\\frac{1}{2}|, \\frac{1}{2}\\} = \\frac{1}{2}$。\n\\end{itemize}\n这些值的上确界是 $\\sup\\{\\frac{1}{2}, \\frac{1}{2}\\} = \\frac{1}{2}$。\n\nHausdorff 距离是 $d_H^Z(A, B) = \\max\\{\\frac{1}{2}, \\frac{1}{2}\\} = \\frac{1}{2}$。\n由于 Gromov-Hausdorff 距离是所有到任意公共度量空间的可能等距嵌入所产生的 Hausdorff 距离的下确界，我们得到一个上界：\n$$d_{GH}(X,Y) \\leq d_H^Z(A,B) = \\frac{1}{2}。$$\n\n结合下界和上界，我们有 $\\frac{1}{2} \\leq d_{GH}(X,Y) \\leq \\frac{1}{2}$。\n因此，Gromov-Hausdorff 距离的确切值是 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3048688"}, {"introduction": "理论的深刻理解最终需要在实践中得到检验。虽然前面练习中的度量空间很简单，但当点的数量增加时，徒手计算格罗莫夫-豪斯多夫距离会因组合爆炸而变得不切实际。这个练习 [@problem_id:3050680] 将理论与计算实践联系起来，要求你设计并实现一个算法来估算有限度量空间之间的格罗莫夫-豪斯多夫距离。你不仅需要将抽象的“对应”和“扭曲度”概念转化为具体的代码，还必须直面这个问题在计算上的复杂性，这深刻体现了纯粹数学与算法设计之间的联系。", "problem": "给定两个有限度量空间，每个空间都由一个对角线为零且满足三角不等式的对称距离矩阵表示。目标是通过搜索对应关系来近似它们之间的格罗莫夫-豪斯多夫（Gromov-Hausdorff, GH）距离。从基本定义开始：对于两个紧度量空间 $(X,d_X)$ 和 $(Y,d_Y)$，一个对应 $R \\subset X \\times Y$ 是一个关系，其在 $X$ 和 $Y$ 上的投影是满射。一个对应 $R$ 的畸变（distortion）为\n$$\n\\mathrm{dis}(R) = \\sup\\left\\{ \\left| d_X(x,x') - d_Y(y,y') \\right| : (x,y) \\in R, (x',y') \\in R \\right\\},\n$$\n而格罗莫夫-豪斯多夫距离是\n$$\nd_{GH}(X,Y) = \\frac{1}{2} \\inf_{R} \\mathrm{dis}(R).\n$$\n对于有限空间，直接枚举所有对应在组合上是不可行的。一个实用的近似方法是限制在作为满射函数图像的对应上，这会产生对所有对应下确界的一个上界。具体来说：\n- 如果 $|X| = |Y|$，则限制在双射 $f : X \\to Y$ 上，并计算 $f$ 的图像的畸变 $\\mathrm{dis}(f) = \\sup_{x,x' \\in X} \\left| d_X(x,x') - d_Y(f(x),f(x')) \\right|$，然后取所有双射中的最小值以获得上界 $d_{GH}(X,Y) \\le \\frac{1}{2} \\min_f \\mathrm{dis}(f)$。\n- 如果 $|X| \\ge |Y|$，则限制在满射函数 $f : X \\to Y$ 上，并类似地计算 $f$ 的图像的畸变以获得上界。\n- 如果 $|X|  |Y|$，则交换角色并使用一个满射函数 $g : Y \\to X$。\n\n在提供上界的同时，也提供一个计算成本较低的下界\n$$\n\\mathrm{LB} = \\frac{1}{2} \\left| \\operatorname{diam}(X) - \\operatorname{diam}(Y) \\right|, \\quad \\text{其中 } \\operatorname{diam}(X) = \\max_{x,x' \\in X} d_X(x,x').\n$$\n从上述核心定义出发，讨论因枚举满射函数或双射而产生的计算复杂度。\n\n实现一个程序，该程序从显式点集构建距离矩阵，并计算：\n- 根据基数比较，通过对双射或满射进行枚举得到的上界 $U = \\frac{1}{2} \\min \\mathrm{dis}(\\cdot)$。\n- 下界 $L = \\frac{1}{2} \\left| \\operatorname{diam}(X) - \\operatorname{diam}(Y) \\right|$。\n\n对下面的所有点集，使用欧几里得距离 $d((u_1,\\dots,u_k),(v_1,\\dots,v_k)) = \\sqrt{\\sum_{i=1}^k (u_i - v_i)^2}$。角度（若适用）以弧度为单位。\n\n测试套件（每个案例将 $(X,Y)$ 定义为有限点集）：\n- 案例1（理想情况，相同的有限度量空间）：$X = \\{0,1,2\\}$，$Y = \\{0,1,2\\}$，在实数线上，距离为 $d(a,b) = |a-b|$。\n- 案例2（缩放差异，基数相等）：$X = \\{0,2,4\\}$，$Y = \\{0,1,2\\}$，在实数线上，距离为 $d(a,b) = |a-b|$。\n- 案例3（基数不等，存在满射 $X \\to Y$）：$X = \\{0,1,2,3\\}$，$Y = \\{0,1.5,3\\}$，在实数线上，距离为 $d(a,b) = |a-b|$。\n- 案例4（边界条件：单点集对两点空间）：$X = \\{0\\}$，$Y = \\{0,1\\}$，在实数线上，距离为 $d(a,b) = |a-b|$。\n- 案例5（平面上基数相等，旋转和缩放）：$X = \\{ (\\cos(2\\pi k/5), \\sin(2\\pi k/5)) : k = 0,1,2,3,4 \\}$, $Y = \\{ 1.05 \\cdot (\\cos(2\\pi k/5 + 0.1), \\sin(2\\pi k/5 + 0.1)) : k = 0,1,2,3,4 \\}$。\n\n您的程序应：\n- 根据给定的点集为每个案例构建距离矩阵。\n- 当 $|X| = |Y|$ 时，通过对双射进行穷举枚举来计算 $U$；否则，在从较大集合到较小集合的方向上对满射函数进行穷举枚举，将 $\\mathrm{dis}(\\cdot)$ 作为所有点对的上确界进行评估。\n- 从直径计算 $L$。\n- 将案例1到5的有序结果聚合为一行输出，该输出包含一个用方括号括起来的逗号分隔列表，其中每个项目是一个包含两个浮点数的列表 $[U,L]$，四舍五入到六位小数。例如，一个有效的输出格式是 $[[U_1,L_1],[U_2,L_2],\\dots,[U_5,L_5]]$。\n\n为覆盖率而设计：\n- 案例1测试完全相等和恒等对应。\n- 案例2测试基数相等但有均匀缩放的情况。\n- 案例3测试多对一满射以及合并点的影响。\n- 案例4测试单点集的边界情况，并验证其与直径相关的已知行为。\n- 案例5测试平面结构以及带缩放的旋转对称性。\n\n计算复杂度讨论要求：\n- 根据定义，说明为什么枚举对应关系在组合上数量巨大。\n- 推导受限搜索的复杂度：当 $|X|=|Y|$ 时，双射枚举的复杂度约为 $|X|!$；而满射函数枚举可以通过筛选 $|Y|^{|X|}$ 个函数以保留满射函数来实现（或者在角色互换时为 $|X|^{|Y|}$）。\n- 解释畸变评估如何对每个映射耗费 $O(|X|^2)$ 或 $O(|Y|^2)$ 的时间，从而导致双射的总时间复杂度约为 $|X|! \\cdot |X|^2$，对于 $X \\to Y$ 情况下的满射，其总时间复杂度约为 $|Y|^{|X|} \\cdot |X|^2$，对于 $Y \\to X$ 情况类似。\n\n不涉及物理单位；案例5中的角度以弧度为单位。最终输出为四舍五入到六位小数的浮点数。", "solution": "该问题要求计算两个有限度量空间 $(X,d_X)$ 和 $(Y,d_Y)$ 之间格罗莫夫-豪斯多夫距离的上界和下界。解决方案首先需要验证问题的前提条件，如果有效，则基于所提供的定义制定一个计算过程。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n- **定义**:\n  - 度量空间是一个对 $(Z, d_Z)$，其中 $Z$ 是一个集合，$d_Z$ 是一个距离函数。给定的空间是有限的。\n  - 对应 $R \\subset X \\times Y$ 是一个关系，其到 $X$ 和 $Y$ 的投影是满射。\n  - 对应 $R$ 的畸变为 $\\mathrm{dis}(R) = \\sup\\left\\{ \\left| d_X(x,x') - d_Y(y,y') \\right| : (x,y) \\in R, (x',y') \\in R \\right\\}$。\n  - 格罗莫夫-豪斯多夫距离为 $d_{GH}(X,Y) = \\frac{1}{2} \\inf_{R} \\mathrm{dis}(R)$，其中下确界取自所有对应 $R$。\n- **上界（$U$）的近似**：对下确界的搜索被限制为作为函数图像的对应。\n  - 如果 $|X| = |Y|$，考虑所有双射 $f : X \\to Y$。畸变为 $\\mathrm{dis}(f) = \\sup_{x,x' \\in X} \\left| d_X(x,x') - d_Y(f(x),f(x')) \\right|$。上界为 $U = \\frac{1}{2} \\min_f \\mathrm{dis}(f)$。\n  - 如果 $|X| \\ge |Y|$，考虑所有满射函数 $f : X \\to Y$。上界为 $U = \\frac{1}{2} \\min_f \\mathrm{dis}(f)$。\n  - 如果 $|X|  |Y|$，考虑所有满射函数 $g : Y \\to X$。上界为 $U = \\frac{1}{2} \\min_g \\mathrm{dis}(g)$。\n- **下界（$L$）**:\n  - $L = \\frac{1}{2} \\left| \\operatorname{diam}(X) - \\operatorname{diam}(Y) \\right|$，其中 $\\operatorname{diam}(X) = \\max_{x,x' \\in X} d_X(x,x')$。\n- **点集的距离度量**:\n  - 欧几里得距离：$d((u_1,\\dots,u_k),(v_1,\\dots,v_k)) = \\sqrt{\\sum_{i=1}^k (u_i - v_i)^2}$。\n- **计算复杂度讨论**：要求讨论枚举对应、双射和满射的复杂度。\n- **测试案例**:\n  - 案例1：$X = \\{0,1,2\\}, Y = \\{0,1,2\\}$ 在实数线上。\n  - 案例2：$X = \\{0,2,4\\}, Y = \\{0,1,2\\}$ 在实数线上。\n  - 案例3：$X = \\{0,1,2,3\\}, Y = \\{0,1.5,3\\}$ 在实数线上。\n  - 案例4：$X = \\{0\\}, Y = \\{0,1\\}$ 在实数线上。\n  - 案例5：$X = \\{ (\\cos(2\\pi k/5), \\sin(2\\pi k/5)) : k \\in \\{0,1,2,3,4\\} \\}$, $Y = \\{ 1.05 \\cdot (\\cos(2\\pi k/5 + 0.1), \\sin(2\\pi k/5 + 0.1)) : k \\in \\{0,1,2,3,4\\} \\}$。\n- **输出格式**：单行输出：`[[U_1,L_1],[U_2,L_2],...,[U_5,L_5]]`，每个值都是四舍五入到六位小数的浮点数。\n\n**第二步：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行分析：\n- **科学性**：该问题基于格罗莫夫-豪斯多夫距离的标准定义，这是度量几何和几何分析中的一个基本概念。公式 $d_{GH}(X,Y) = \\frac{1}{2} \\inf_R \\mathrm{dis}(R)$ 是正确的。通过将搜索限制在函数对应（双射或满射）上来近似 $d_{GH}$ 的方法，是获得上界的一种有效且众所周知的技术。提供的下界 $L = \\frac{1}{2} \\left| \\operatorname{diam}(X) - \\operatorname{diam}(Y) \\right|$ 是从 $d_{GH}$ 的性质推导出的一个标准结果。使用欧几里得距离和点集在数学上是合理的。\n- **良构性**：该问题是良构的。它要求为一组给定的有限度量空间计算特定的、唯一定义的量（$U$ 和 $L$）。指令明确无歧义，并且由于空间是有限的，双射和满射的搜索空间也是有限的，这保证了最小畸变的存在。\n- **客观性**：该问题以精确、客观的数学语言陈述。\n- **缺陷分析**：\n  1. *科学或事实上的不健全*：无。数学框架是正确的。\n  2. *非形式化或不相关*：该问题是形式化的，并直接关系到指定的格罗莫夫-豪斯多夫收敛主题。\n  3. *不完整或矛盾的设置*：无。所有必要的定义、数据和条件都已提供。\n  4. *不切实际或不可行*：计算任务是密集的，但问题明确承认了这一点，要求进行复杂度讨论并提供了基数较小的测试案例，使得穷举搜索是可行的。\n  5. *不良构或结构差*：无。问题结构逻辑清晰，可以为指定的界限得出唯一解。\n  6. *伪深刻、琐碎或同义反复*：无。该问题涉及一个真正复杂的主题，并使用简化但具说明性的例子来测试对核心概念的理解和实现。\n  7. *超出科学可验证性*：结果是数学上可计算的，因此是可验证的。\n\n**第三步：结论与行动**\n\n该问题被判定为**有效**。将提供解决方案。\n\n### 解决方案\n\n任务是计算两个有限度量空间 $(X, d_X)$ 和 $(Y, d_Y)$ 之间格罗莫夫-豪斯多夫距离 $d_{GH}(X,Y)$ 的一个上界 $U$ 和一个下界 $L$。\n\n**1. 理论基础**\n\n格罗莫夫-豪斯多夫距离 $d_{GH}(X,Y)$ 衡量了两个紧度量空间离等距的程度。它定义为 $d_{GH}(X,Y) = \\frac{1}{2} \\inf_{R \\subset X \\times Y} \\mathrm{dis}(R)$，其中下确界取自所有对应 $R$。一个对应 $R$ 是一个关系，其投影 $\\pi_1(R) = X$ 和 $\\pi_2(R) = Y$ 是满射。其畸变为 $\\mathrm{dis}(R) = \\sup \\{ |d_X(x,x') - d_Y(y,y')| : (x,y), (x',y') \\in R \\}$。\n\n**2. 计算策略**\n\n计算的核心是找到指定的界限 $U$ 和 $L$。\n\n**下界 $L$**：这个界的计算成本很低。它依赖于性质 $| \\operatorname{diam}(X) - \\operatorname{diam}(Y) | \\le 2d_{GH}(X,Y)$。\n- 首先，使用欧几里得度量为点集 $X$ 和 $Y$ 计算距离矩阵 $D_X$ 和 $D_Y$。\n- 每个空间的直径是其距离矩阵中的最大值：$\\operatorname{diam}(X) = \\max D_X$ 和 $\\operatorname{diam}(Y) = \\max D_Y$。\n- 然后下界为 $L = \\frac{1}{2} |\\operatorname{diam}(X) - \\operatorname{diam}(Y)|$。\n\n**上界 $U$**：这个界需要在一个受限的对应集合上进行穷举搜索。我们不考虑所有可能的关系，而只考虑作为函数图像的对应。\n令 $|X|=n$ 和 $|Y|=m$。该过程取决于基数：\n- **情况1：$n=m$（双射）**：我们搜索所有双射 $f: X \\to Y$。这样的函数有 $n!$ 个。对于每个双射 $f$，我们计算其畸变 $\\mathrm{dis}(f) = \\max_{i,j \\in \\{1,...,n\\}} |d_X(x_i, x_j) - d_Y(f(x_i), f(x_j))|$。上界是 $U = \\frac{1}{2} \\min_f \\mathrm{dis}(f)$。\n- **情况2：$n  m$（满射 $X \\to Y$）**：我们搜索所有满射函数 $f: X \\to Y$。此类函数的数量为 $m!S(n,m)$，其中 $S(n,m)$ 是第二类斯特林数。暴力方法是枚举从 $X$到 $Y$ 的所有 $m^n$ 个函数，并筛选出满射函数。对于每个满射函数 $f$，我们计算其畸变 $\\mathrm{dis}(f) = \\max_{i,j \\in \\{1,...,n\\}} |d_X(x_i, x_j) - d_Y(f(x_i), f(x_j))|$。上界是 $U = \\frac{1}{2} \\min_f \\mathrm{dis}(f)$。\n- **情况3：$n  m$（满射 $Y \\to X$）**：通过对称性，我们搜索所有满射函数 $g: Y \\to X$。对于每个这样的 $g$，畸变为 $\\mathrm{dis}(g) = \\max_{k,l \\in \\{1,...,m\\}} |d_Y(y_k, y_l) - d_X(g(y_k), g(y_l))|$。上界是 $U = \\frac{1}{2} \\min_g \\mathrm{dis}(g)$。\n\n**3. 计算复杂度分析**\n\n- **完全对应枚举**：所有对应的集合是巨大的。一个对应是 $X \\times Y$ 的一个子集，其投影是满射。当 $|X|=n$ 和 $|Y|=m$ 时，有 $2^{nm}$ 个 $X \\times Y$ 的子集。满足满射条件的子集数量由容斥原理给出，为 $\\sum_{i=0}^n \\sum_{j=0}^m (-1)^{i+j} \\binom{n}{i} \\binom{m}{j} 2^{(n-i)(m-j)}$。这个数字呈超指数级增长，使得即使对于小的 $n$ 和 $m$，枚举在计算上也是不可行的。\n\n- **受限搜索（双射）**：如果 $|X|=|Y|=n$，双射的数量是 $n!$。对于每个双射，计算畸变需要检查定义域中所有点对，这是一个 $O(n^2)$ 的操作。因此，找到最优双射的总时间复杂度是 $O(n^2 \\cdot n!)$。\n\n- **受限搜索（满射）**：如果 $|X|=n  |Y|=m$，一个直接的方法是生成从 $X$ 到 $Y$ 的所有 $m^n$ 个函数，并测试每个函数是否为满射。生成每个函数的时间是常数（在迭代方案中），检查满射性需要 $O(n)$ 时间，计算畸变需要 $O(n^2)$ 时间。这导致总复杂度为 $O(m^n \\cdot (n+n^2)) = O(n^2 \\cdot m^n)$。如果 $|Y|=m  |X|=n$，复杂度对称地为 $O(m^2 \\cdot n^m)$。这种暴力枚举是所要求的实现将要执行的，因为它易于实现并且对于所提供的小型测试用例是足够的。\n\n算法通过为每个测试案例实施这些步骤来进行。\n1. 定义点集 $X$ 和 $Y$。\n2. 使用欧几里得距离构建距离矩阵 $D_X$ 和 $D_Y$。\n3. 从矩阵直径计算下界 $L$。\n4. 确定 $|X|$ 和 $|Y|$ 之间的关系，并启动相应的穷举搜索（在双射或满射上）。\n5. 对于每个有效映射，计算其畸变。\n6. 在所有有效映射中找到最小畸变，并计算上界 $U$。\n7. 按规定收集并格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\nimport math\n\ndef solve():\n    \"\"\"\n    Computes upper and lower bounds for the Gromov-Hausdorff distance\n    for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Identical spaces\n        (np.array([[0], [1], [2]]), np.array([[0], [1], [2]])),\n        # Case 2: Scaled spaces, equal cardinality\n        (np.array([[0], [2], [4]]), np.array([[0], [1], [2]])),\n        # Case 3: Unequal cardinalities, surjection X - Y\n        (np.array([[0], [1], [2], [3]]), np.array([[0], [1.5], [3]])),\n        # Case 4: Singleton vs two-point space\n        (np.array([[0]]), np.array([[0], [1]])),\n        # Case 5: Rotated and scaled pentagons\n        (\n            np.array([[math.cos(2 * math.pi * k / 5), math.sin(2 * math.pi * k / 5)] for k in range(5)]),\n            np.array([[1.05 * math.cos(2 * math.pi * k / 5 + 0.1), 1.05 * math.sin(2 * math.pi * k / 5 + 0.1)] for k in range(5)])\n        ),\n    ]\n\n    results = []\n    for x_pts, y_pts in test_cases:\n        u, l = calculate_gh_bounds(x_pts, y_pts)\n        results.append([u, l])\n\n    # Format the results into the required string format.\n    formatted_results = [f\"[{u:.6f},{l:.6f}]\" for u, l in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef compute_distance_matrix(points):\n    \"\"\"Computes the Euclidean distance matrix for a set of points.\"\"\"\n    # Using broadcasting for efficient computation of pairwise distances\n    diffs = points[:, np.newaxis, :] - points[np.newaxis, :, :]\n    dist_matrix = np.sqrt(np.sum(diffs**2, axis=-1))\n    return dist_matrix\n\ndef generate_surjections(n, m):\n    \"\"\"Generates all surjective functions from a set of size n to a set of size m.\"\"\"\n    # Represents functions as tuples of length n with values in range(m)\n    for f_tuple in itertools.product(range(m), repeat=n):\n        if len(set(f_tuple)) == m:\n            yield np.array(f_tuple)\n\ndef calculate_gh_bounds(x_pts, y_pts):\n    \"\"\"\n    Calculates the upper bound U and lower bound L for the GH distance.\n    \n    Args:\n        x_pts (np.ndarray): The points of space X.\n        y_pts (np.ndarray): The points of space Y.\n    \n    Returns:\n        tuple: A tuple (U, L) containing the upper and lower bounds.\n    \"\"\"\n    # 1. Compute distance matrices\n    d_x = compute_distance_matrix(x_pts)\n    d_y = compute_distance_matrix(y_pts)\n\n    n = len(x_pts)\n    m = len(y_pts)\n\n    # 2. Compute the lower bound L\n    diam_x = np.max(d_x) if n  0 else 0\n    diam_y = np.max(d_y) if m  0 else 0\n    lower_bound = 0.5 * abs(diam_x - diam_y)\n\n    # 3. Compute the upper bound U\n    min_distortion = float('inf')\n\n    if n == 0 or m == 0:\n        if n == 0 and m == 0:\n            min_distortion = 0\n        elif n  0:\n            min_distortion = diam_x\n        else: # m > 0\n            min_distortion = diam_y\n            \n    elif n == m:\n        # Case |X| = |Y|: Enumerate bijections\n        indices_y = list(range(m))\n        for p in itertools.permutations(indices_y):\n            # p represents the bijection: map x_i to y_{p[i]}\n            d_y_permuted = d_y[np.ix_(p, p)]\n            distortion = np.max(np.abs(d_x - d_y_permuted))\n            if distortion  min_distortion:\n                min_distortion = distortion\n    \n    elif n  m:\n        # Case |X|  |Y|: Enumerate surjections X - Y\n        for f in generate_surjections(n, m):\n            # f is a map from index in X to index in Y\n            distortion_matrix = np.zeros((n,n))\n            for i in range(n):\n                for j in range(n):\n                    distortion_matrix[i, j] = abs(d_x[i, j] - d_y[f[i], f[j]])\n            \n            distortion = np.max(distortion_matrix)\n            if distortion  min_distortion:\n                min_distortion = distortion\n\n    else: # n  m\n        # Case |X|  |Y|: Enumerate surjections Y -> X\n        # By symmetry, swap roles of X and Y\n        for g in generate_surjections(m, n):\n            # g is a map from index in Y to index in X\n            distortion_matrix = np.zeros((m,m))\n            for i in range(m):\n                for j in range(m):\n                    distortion_matrix[i, j] = abs(d_y[i, j] - d_x[g[i], g[j]])\n\n            distortion = np.max(distortion_matrix)\n            if distortion  min_distortion:\n                min_distortion = distortion\n    \n    upper_bound = 0.5 * min_distortion\n    \n    return upper_bound, lower_bound\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3050680"}]}