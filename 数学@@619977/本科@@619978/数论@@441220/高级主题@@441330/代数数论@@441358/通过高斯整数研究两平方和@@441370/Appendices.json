{"hands_on_practices": [{"introduction": "欧几里得算法不仅是整数算术的基石，它在更广泛的数系中同样威力无穷，例如高斯整数环 $\\mathbb{Z}[i]$。掌握在高斯整数上执行欧几里得算法是揭示其深层算术性质（如唯一分解）的第一步。本练习[@problem_id:3090032]为后续更复杂的应用提供了坚实的基础，让你能够熟练地在高斯整数中计算最大公约数。", "problem": "令 $\\mathbb{Z}[i]$ 表示高斯整数环，它由所有形如 $a+bi$（其中 $a,b\\in\\mathbb{Z}$）的复数组成，其加法和乘法运算继承自复数集 $\\mathbb{C}$。$\\mathbb{Z}[i]$ 上的欧几里得函数是范数 $N(a+bi)=a^{2}+b^{2}$，该范数是积性的，并满足带余除法性质：对于任意 $x,y\\in\\mathbb{Z}[i]$ 且 $y\\neq 0$，存在 $q,r\\in\\mathbb{Z}[i]$ 使得 $x=qy+r$ 且 $N(r)  N(y)$。\n\n请使用欧几里得算法计算两个高斯整数 $z_1 = 7+5i$ 和 $z_2 = 3+8i$ 的最大公约数 (gcd)，并将其表示为 $z_1$ 和 $z_2$ 的线性组合。请将 gcd 表示为其四个相伴元中实部为正的那一个。", "solution": "任务是使用欧几里得算法计算两个高斯整数 $z_1 = 7+5i$ 和 $z_2 = 3+8i$ 的最大公约数 (gcd)，然后将此 gcd 表示为 $z_1$ 和 $z_2$ 的线性组合。\n\n高斯整数环 $\\mathbb{Z}[i]$ 是一个关于范数函数 $N(a+bi) = a^2+b^2$ 的欧几里得整环。欧几里得算法可以直接应用。我们记 $z_1 = 7+5i$ 和 $z_2 = 3+8i$。\n\n首先，我们比较它们的范数：\n$N(z_1) = N(7+5i) = 7^2 + 5^2 = 49 + 25 = 74$。\n$N(z_2) = N(3+8i) = 3^2 + 8^2 = 9 + 64 = 73$。\n由于 $N(z_1) > N(z_2)$，我们将用 $z_2$ 除 $z_1$。\n\n步骤 1：用 $z_2$ 除 $z_1$。\n为了在 $\\mathbb{Z}[i]$ 中找到商 $q_1$ 和余数 $r_1$ 使得 $z_1 = q_1 z_2 + r_1$ 且 $N(r_1)  N(z_2)$，我们首先在 $\\mathbb{C}$ 中计算商：\n$$ \\frac{z_1}{z_2} = \\frac{7+5i}{3+8i} = \\frac{(7+5i)(3-8i)}{(3+8i)(3-8i)} = \\frac{21 - 56i + 15i - 40i^2}{3^2+8^2} = \\frac{61 - 41i}{73} = \\frac{61}{73} - \\frac{41}{73}i $$\n与此复数最接近的高斯整数是通过将实部和虚部四舍五入到最近的整数得到的。\n$\\text{round}(\\frac{61}{73}) \\approx \\text{round}(0.835) = 1$。\n$\\text{round}(-\\frac{41}{73}) \\approx \\text{round}(-0.561) = -1$。\n因此，我们选择商 $q_1 = 1-i$。\n\n现在，我们计算余数 $r_1$：\n$$ r_1 = z_1 - q_1 z_2 = (7+5i) - (1-i)(3+8i) $$\n$$ r_1 = (7+5i) - (3+8i-3i-8i^2) = (7+5i) - (3+5i+8) = (7+5i) - (11+5i) = -4 $$\n第一个除法等式是 $7+5i = (1-i)(3+8i) - 4$。\n我们检查余数的范数：$N(r_1) = N(-4) = (-4)^2 = 16$。这满足条件 $N(r_1)  N(z_2)$，因为 $16  73$。\n\n步骤 2：用 $r_1$ 除 $z_2$。\n现在我们用余数 $r_1 = -4$ 除 $z_2 = 3+8i$。\n$$ \\frac{z_2}{r_1} = \\frac{3+8i}{-4} = -\\frac{3}{4} - 2i $$\n将实部和虚部四舍五入到最近的整数：\n$\\text{round}(-\\frac{3}{4}) = \\text{round}(-0.75) = -1$。\n$\\text{round}(-2) = -2$。\n因此，我们选择商 $q_2 = -1-2i$。\n\n现在，我们计算新的余数 $r_2$：\n$$ r_2 = z_2 - q_2 r_1 = (3+8i) - (-1-2i)(-4) = (3+8i) - (4+8i) = -1 $$\n第二个除法等式是 $3+8i = (-1-2i)(-4) - 1$。\n我们检查余数的范数：$N(r_2) = N(-1) = (-1)^2 = 1$。这满足 $N(r_2)  N(r_1)$，因为 $1  16$。\n\n步骤 3：用 $r_2$ 除 $r_1$。\n现在我们用 $r_2 = -1$ 除 $r_1 = -4$。\n$$ \\frac{r_1}{r_2} = \\frac{-4}{-1} = 4 $$\n商正好是 $q_3 = 4$ 且余数是 $r_3 = 0$。\n第三个除法等式是 $-4 = (4)(-1) + 0$。\n\n由于余数为 $0$，算法终止。最大公约数是最后一个非零余数，即 $r_2 = -1$。gcd 在 $\\mathbb{Z}[i]$ 中相差一个单位元的乘法下是唯一的。单位元是 $\\{1, -1, i, -i\\}$。$-1$ 的相伴元是 $\\{-1, 1, -i, i\\}$。题目规定 gcd 应该用实部为正的相伴元表示。在这些相伴元中，只有 $1$ 的实部为正。\n因此，$\\text{gcd}(7+5i, 3+8i) = 1$。\n\n接下来，我们使用扩展欧几里得算法将 gcd 表示为线性组合 $1 = U(7+5i) + V(3+8i)$，这涉及到回代。\n从步骤 2 中，我们得到最后一个非零余数 $-1$ 的表达式：\n$$ -1 = (3+8i) - (-1-2i)(-4) $$\n从步骤 1 中，我们可以将前一个余数 $-4$ 表示为原始数字的线性组合：\n$$ -4 = (7+5i) - (1-i)(3+8i) $$\n将 $-4$ 的这个表达式代入 $-1$ 的方程中：\n$$ -1 = (3+8i) - (-1-2i)\\left[ (7+5i) - (1-i)(3+8i) \\right] $$\n现在，我们展开并收集包含 $(7+5i)$ 和 $(3+8i)$ 的项：\n$$ -1 = (3+8i) - (-1-2i)(7+5i) + (-1-2i)(1-i)(3+8i) $$\n让我们对每个原始数的系数进行分组：\n$(7+5i)$ 的系数是 $-(-1-2i) = 1+2i$。\n$(3+8i)$ 的系数是 $1 + (-1-2i)(1-i)$。\n我们计算这个乘积：\n$$ (-1-2i)(1-i) = -1(1-i) - 2i(1-i) = -1+i-2i+2i^2 = -1-i-2 = -3-i $$\n所以，$(3+8i)$ 的系数是 $1 + (-3-i) = -2-i$。\n这给出了 $-1$ 的线性组合：\n$$ -1 = (1+2i)(7+5i) + (-2-i)(3+8i) $$\n为了找到 gcd $1$ 的线性组合，我们将整个方程乘以 $-1$：\n$$ 1 = -(1+2i)(7+5i) - (-2-i)(3+8i) $$\n$$ 1 = (-1-2i)(7+5i) + (2+i)(3+8i) $$\n这就是所求的表达式。我们有 $U = -1-2i$ 和 $V = 2+i$，它们都在 $\\mathbb{Z}[i]$ 中。\n最终的 gcd 是 $1$。", "answer": "$$ \\boxed{1} $$", "id": "3090032"}, {"introduction": "现在，我们将运用欧几里得算法来解决数论中的一个核心问题：将素数表示为两个平方之和。对于形如 $p \\equiv 1 \\pmod 4$ 的素数，通过找到方程 $x^2 \\equiv -1 \\pmod p$ 的解，我们可以在 $\\mathbb{Z}[i]$ 中构造一个特殊的数，它与 $p$ 的最大公约数将揭示 $p$ 的高斯整数因子。这个练习[@problem_id:3090039]具体地展示了整数模算术与高斯整数环中因子分解之间的深刻联系。", "problem": "在高斯整数环 $\\mathbb{Z}[i]=\\{a+bi: a,b\\in\\mathbb{Z}\\}$ 中进行计算，该环配备了范数 $N(a+bi)=a^{2}+b^{2}$ 和复共轭 $\\overline{a+bi}=a-bi$。环 $\\mathbb{Z}[i]$ 是一个关于范数 $N(\\,\\cdot\\,)$ 的欧几里得整环，因此欧几里得算法和带余除法适用。$\\mathbb{Z}[i]$ 中的单位是 $\\{\\pm 1,\\pm i\\}$。\n\n仅使用关于 $\\mathbb{Z}[i]$ 的这些基本事实以及 $\\mathbb{Z}/41\\mathbb{Z}$ 中的同余，执行以下步骤：\n\n- 找到一个整数 $x$，满足 $0  x  41/2$ 且 $x^2 \\equiv -1 \\pmod{41}$。\n- 在 $\\mathbb{Z}[i]$ 中使用欧几里得算法计算 $\\pi = \\text{gcd}(41, x+i)$。\n- 从 $\\pi$ 推导出满足 $41 = a^2+b^2$ 且 $a \\ge b$ 的正整数对 $(a, b)$。", "solution": "基本原理是，一个奇素数 $p$ 可以写成两个平方数之和，当且仅当 $p \\equiv 1 \\pmod{4}$。如果此条件成立，$p$ 在环 $\\mathbb{Z}[i]$ 中就不再是素元，而是分解为 $p = \\pi \\bar{\\pi}$，其中 $\\pi = a+bi$ 是某个高斯素数。对此方程取范数得到 $N(p) = N(\\pi)N(\\bar{\\pi})$。由于 $p$ 是一个实整数，因此 $N(p) = p^2$。$\\pi=a+bi$ 的范数是 $N(\\pi) = a^2+b^2$ 且 $N(\\bar{\\pi}) = a^2+(-b)^2 = a^2+b^2$。因此，$p^2 = (a^2+b^2)^2$，这意味着 $p=a^2+b^2$。本题引导我们找到这样一个因子 $\\pi$。\n\n首先，我们检查素数 $p=41$ 的条件。我们有 $41 = 4 \\times 10 + 1$，所以 $41 \\equiv 1 \\pmod{4}$。因此，$41$ 可以表示为两个平方数之和。\n\n步骤1：找到一个整数 $x$，满足 $0  x  41/2$ 且 $x^2 \\equiv -1 \\pmod{41}$。\n我们需要找到一个模 $41$ 的 $-1$ 的平方根。$41/2=20.5$，所以我们寻找在 $(0, 20.5)$ 范围内的 $x$。\n我们可以通过试错法来测试小的整数值：\n$1^2 \\equiv 1$\n$2^2 \\equiv 4$\n...\n$9^2 = 81 = 2 \\times 41 - 1 \\equiv -1 \\pmod{41}$。\n$x=9$ 满足条件 $0  9  20.5$。因此，我们的解是 $x=9$。\n\n步骤2：使用欧几里得算法计算 $\\pi = \\text{gcd}(41, 9+i)$。\n我们应用带余除法来计算高斯整数 $41$ 和 $9+i$ 的最大公约数。\n第一步，用 $9+i$ 除 $41$：\n$$ \\frac{41}{9+i} = \\frac{41(9-i)}{(9+i)(9-i)} = \\frac{369 - 41i}{9^2+1^2} = \\frac{369 - 41i}{82} = \\frac{369}{82} - \\frac{41}{82}i = 4.5 - 0.5i $$\n最接近的高斯整数是 $4-i$ 或 $5-i$。让我们选择 $q_1 = 4-i$。\n现在我们计算余数 $r_1$：\n$$ r_1 = 41 - q_1(9+i) = 41 - (4-i)(9+i) = 41 - (36+4i-9i-i^2) = 41 - (36-5i+1) = 41 - (37-5i) = 4+5i $$\n第二步，用余数 $r_1=4+5i$ 除 $9+i$：\n$$ \\frac{9+i}{4+5i} = \\frac{(9+i)(4-5i)}{(4+5i)(4-5i)} = \\frac{36-45i+4i-5i^2}{4^2+5^2} = \\frac{36-41i+5}{16+25} = \\frac{41-41i}{41} = 1-i $$\n商 $q_2 = 1-i$ 是一个高斯整数，因此余数 $r_2=0$。\n$9+i = (1-i)(4+5i) + 0$。\n算法终止。最大公约数是最后一个非零余数，即 $\\pi = r_1 = 4+5i$。\n\n步骤3：从 $\\pi$ 中找到 $a$ 和 $b$。\n我们已经找到了 $41$ 在 $\\mathbb{Z}[i]$ 中的一个素因子 $\\pi = 4+5i$。我们验证其范数：\n$N(\\pi) = N(4+5i) = 4^2+5^2 = 16+25 = 41$。\n由于 $N(\\pi) = 41$，而 $N(\\pi)=a^2+b^2$，我们有 $41=a^2+b^2$。高斯整数 $4+5i$ 给出了整数对 $(a,b)$，其值为 $(4,5)$ 或 $(5,4)$（取决于我们如何定义 $a$ 和 $b$）。问题要求 $a, b$ 为正整数且 $a \\ge b$。因此，我们选择 $a=5$ 和 $b=4$。\n\n验证：$5^2+4^2 = 25+16=41$。这确实是正确的。\n因此，满足条件的整数对是 $(5,4)$。", "answer": "$$\\boxed{\\begin{pmatrix} 5  4 \\end{pmatrix}}$$", "id": "3090039"}, {"introduction": "在掌握了如何将素数表示为两平方和之后，我们可以挑战更复杂的合数。本练习[@problem_id:3090046]探讨了如何利用高斯整数环中的唯一因子分解性质，来找出将一个合数表示为两个平方和的*所有*不同方式。通过将该数分解为其高斯素因子，我们可以像搭积木一样以不同方式重新组合它们，从而发现每一种独特的平方和表示。", "problem": "设 $\\mathbb{Z}[i]$ 表示高斯整数环，并设 $N:\\mathbb{Z}[i]\\to\\mathbb{Z}_{\\ge 0}$ 是由 $N(a+bi)=a^{2}+b^{2}$ 定义的范数。仅依据以下基本事实：$\\mathbb{Z}[i]$ 是一个欧几里得整环（因此是唯一分解整环），其单位群为 $\\{\\pm 1,\\pm i\\}$，$N$ 具有乘法性，以及一个有理素数 $p$ 在 $\\mathbb{Z}[i]$ 中是可约的当且仅当 $p=2$ 或 $p\\equiv 1\\pmod{4}$，判断 $130$ 是否能表示为两个整数的平方和。如果可以，找出在两个加数的置换和变号所生成的等价关系下的所有表示；也就是说，列出所有满足 $a^{2}+b^{2}=130$ 的非负整数对 $(a,b)$，其中 $a\\ge b$。\n\n你的最终答案必须是一个单行矩阵，其元素为规范对串联而成的形式 $(a_{1},b_{1},a_{2},b_{2},\\dots)$，其中每个 $(a_{j},b_{j})$ 是一个不同的等价类代表，满足 $a_{j}\\ge b_{j}\\ge 0$。无需四舍五入。最终答案中不要包含任何文字解释。", "solution": "问题要求判断整数 $130$ 是否能表示为两个整数的平方和，如果可以，则找出所有唯一的表示。一个整数 $n$ 能被写成两个整数的平方和 $n = a^2 + b^2$（其中 $a, b \\in \\mathbb{Z}$），当且仅当存在一个高斯整数 $\\alpha = a+bi \\in \\mathbb{Z}[i]$，其范数为 $n$。范数定义为 $N(\\alpha) = N(a+bi) = a^2+b^2$。因此，该问题等价于找到所有满足 $N(\\alpha)=130$ 的高斯整数 $\\alpha$，并从中推导出唯一的非负整数对 $(a,b)$，其中 $a \\ge b$。\n\n首先，我们必须确定是否存在这样的表示。题目给出了一个关键事实：有理素数 $p$ 在 $\\mathbb{Z}[i]$ 中是可约的，当且仅当 $p=2$ 或 $p \\equiv 1 \\pmod{4}$。数论中的一个基本定理（可由这些性质推导）指出，一个正整数 $n$ 能被写成两个平方数之和，当且仅当 $n$ 在 $\\mathbb{Z}$ 中的素因子分解不包含任何形如 $4k+3$ 的素数，且其幂次为奇数。\n\n让我们求出 $130$ 在整数环 $\\mathbb{Z}$ 中的素因子分解：\n$$130 = 10 \\times 13 = 2 \\times 5 \\times 13$$\n素因子是 $2$、$5$ 和 $13$。\n- 素数 $2$ 是给定规则中提到的特殊情况。\n- 素数 $5$ 满足 $5 \\equiv 1 \\pmod{4}$。\n- 素数 $13$ 满足 $13 \\equiv 1 \\pmod{4}$。\n$130$ 的素因子分解中不包含任何形如 $4k+3$ 的素因子。因此，$130$ 可以表示为两个平方数之和。\n\n为了找到所有这样的表示，我们利用 $\\mathbb{Z}[i]$ 是唯一分解整环（UFD）这一事实。我们需要找到 $130$ 在 $\\mathbb{Z}[i]$ 中的素因子分解。这涉及到将其有理素因子（$2$、$5$、$13$）分解为高斯素数。\n\n1.  分解 $2$：$2 = 1^2 + 1^2 = (1+i)(1-i)$。在 $\\mathbb{Z}[i]$ 中，素数 $1+i$ 和 $1-i$ 是相伴元，因为 $1-i = (-i)(1+i)$。其范数为 $N(1+i) = 1^2+1^2=2$。\n2.  分解 $5$：由于 $5 \\equiv 1 \\pmod{4}$，它是可约的。通过观察我们发现 $5 = 2^2+1^2$。这给出了分解式 $5 = (2+i)(2-i)$。因子 $2+i$ 和 $2-i$ 是高斯素数，因为它们的范数是 $5$，一个有理素数。它们不是相伴元，因为 $\\frac{2+i}{2-i} = \\frac{(2+i)^2}{5} = \\frac{3+4i}{5}$，它不是 $\\mathbb{Z}[i]$ 中的单位。\n3.  分解 $13$：由于 $13 \\equiv 1 \\pmod{4}$，它是可约的。通过观察我们发现 $13=3^2+2^2$。这给出了分解式 $13 = (3+2i)(3-2i)$。因子 $3+2i$ 和 $3-2i$ 是高斯素数，因为它们的范数是 $13$，一个有理素数。它们不是相伴元。\n\n综合这些，130 在 $\\mathbb{Z}[i]$ 中的素因子分解是：\n$$130 = (1+i)(1-i)(2+i)(2-i)(3+2i)(3-2i)$$\n我们在寻找 $\\alpha = a+bi$ 使得 $N(\\alpha) = \\alpha \\bar{\\alpha} = 130$。根据唯一分解性质，$\\alpha$ 的素因子必须从 $130$ 的素因子集合中选取。具体来说，对于每个在 $\\mathbb{Z}[i]$ 中分裂为 $p = \\pi \\bar{\\pi}$ 的有理素数 $p$，任何范数包含因子 $p$ 的 $\\alpha$ 都必须有因子 $\\pi$ 或 $\\bar{\\pi}$（或它们的相伴元）。\n所以，$\\alpha$ 必须具有以下形式：\n$$\\alpha = u \\cdot \\gamma_1 \\cdot \\gamma_2 \\cdot \\gamma_3$$\n其中 $u$ 是单位群 $\\{\\pm 1, \\pm i\\}$ 中的一个单位，并且：\n- $\\gamma_1$ 是 $2$ 的一个素因子，例如 $\\gamma_1=1+i$。\n- $\\gamma_2$ 是 $5$ 的一个素因子，即 $\\gamma_2 \\in \\{2+i, 2-i\\}$。\n- $\\gamma_3$ 是 $13$ 的一个素因子，即 $\\gamma_3 \\in \\{3+2i, 3-2i\\}$。\n\n为了找到不同的非负整数对 $(a,b)$，我们可以通过从每个共轭对中选取一个因子来计算 $\\alpha$ 的可能值。单位 $u$ 的选择和 $\\alpha$ 的整体共轭只影响 $a$ 和 $b$ 的符号和顺序。因此，我们可以固定 $\\gamma_1 = 1+i$（因为 $1-i$ 是其相伴元）并测试 $\\gamma_2$ 和 $\\gamma_3$ 的组合。共有 $2 \\times 2 = 4$ 种这样的组合。\n\n情况1：$\\alpha_1 = (1+i)(2+i)(3+2i)$\n首先，$(1+i)(2+i) = 2+i+2i+i^2 = 1+3i$。\n然后，$\\alpha_1 = (1+3i)(3+2i) = 3+2i+9i+6i^2 = 3+11i-6 = -3+11i$。\n其范数为 $N(\\alpha_1) = (-3)^2 + 11^2 = 9+121 = 130$。这个表示对应于和 $3^2+11^2=130$。满足 $a \\ge b \\ge 0$ 的规范对 $(a,b)$ 是 $(11,3)$。\n\n情况2：$\\alpha_2 = (1+i)(2+i)(3-2i)$\n使用上面得到的 $(1+i)(2+i)=1+3i$，\n$\\alpha_2 = (1+3i)(3-2i) = 3-2i+9i-6i^2 = 3+7i+6 = 9+7i$。\n其范数为 $N(\\alpha_2) = 9^2+7^2 = 81+49 = 130$。这个表示对应于和 $9^2+7^2=130$。规范对是 $(9,7)$。\n\n情况3：$\\alpha_3 = (1+i)(2-i)(3+2i)$\n首先，$(1+i)(2-i) = 2-i+2i-i^2 = 3+i$。\n然后，$\\alpha_3 = (3+i)(3+2i) = 9+6i+3i+2i^2 = 9+9i-2 = 7+9i$。\n其范数为 $N(\\alpha_3) = 7^2+9^2=49+81=130$。这给出了和 $7^2+9^2=130$，对应于与情况2相同的规范对 $(9,7)$。\n\n情况4：$\\alpha_4 = (1+i)(2-i)(3-2i)$\n使用上面得到的 $(1+i)(2-i)=3+i$，\n$\\alpha_4 = (3+i)(3-2i) = 9-6i+3i-2i^2 = 9-3i+2 = 11-3i$。\n其范数为 $N(\\alpha_4) = 11^2+(-3)^2=121+9=130$。这给出了和 $11^2+3^2=130$，对应于与情况1相同的规范对 $(11,3)$。\n\n对因子的其他可能选择（例如，从 $1-i$ 而不是 $1+i$ 开始）将产生与上述计算出的高斯整数共轭或相伴的整数，因此得到相同的平方和对。\n例如，$(1-i)(2-i)(3-2i) = \\overline{(1+i)(2+i)(3+2i)} = \\overline{-3+11i} = -3-11i$，这仍然给出和 $(-3)^2+(-11)^2=130$。\n\n因此，满足 $a^2+b^2=130$ 且 $a \\ge b$ 的不同非负整数对 $(a,b)$ 是 $(11,3)$ 和 $(9,7)$。\n题目要求将这些数对串联成一个单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11  3  9  7\n\\end{pmatrix}\n}\n$$", "id": "3090046"}]}