{"hands_on_practices": [{"introduction": "要真正掌握二元二次型的合论，最好的方法是从最基础的例子开始。这个练习将引导你研究判别式为 $D=-4$ 的情形，这是除平凡情况外最简单的一种。通过直接计算，你将验证主类（principal class）确实是类群中的单位元，即它与自身复合后仍得到自身。这个实践旨在巩固你对类群中单位元概念的理解，并熟悉寻找既约型的基本方法。[@problem_id:3015035]", "problem": "设 $Q(x,y) = a x^{2} + b x y + c y^{2}$ 是一个整系数的二元二次型，其判别式为 $D = b^{2} - 4 a c$。假设 $Q$ 是本原的，即 $\\gcd(a,b,c) = 1$，并且是正定的，即 $D  0$ 且 $a > 0$。如果存在一个矩阵 $\\gamma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 使得 $Q' = Q \\circ \\gamma$，其中 $Q \\circ \\gamma$ 表示由 $\\gamma$ 引起的变量替换，则称两个二次型 $Q$ 和 $Q'$ 是真等价的。对于固定的判别式 $D$，所有本原正定二次型的真等价类在高斯复合下构成一个有限阿贝尔群。一个既约型是其等价类中的一个代表元 $Q$，满足既约不等式 $|b| \\leq a \\leq c$，以及附加条件：如果 $|b| = a$ 或 $a = c$，则 $b \\geq 0$。\n\n对于判别式 $D = -4$，仅根据上述定义和事实，完成以下任务：\n\n1. 确定判别式为 $D = -4$ 的所有既约本原正定二元二次型的完整列表，并推导出类数 $h(-4)$。\n\n2. 使用高斯复合（根据二元二次型复合律的基本定义构建），计算判别式为 $-4$ 的主既约型与自身的显式复合，得到结果复合型的系数三元组 $(a'', b'', c'')$，其判别式也为 $-4$。通过求解必要的同余方程和整性约束来执行复合运算，以确保所得系数定义了一个判别式为 $-4$ 的本原二次型。\n\n将最终答案表示为一个单行矩阵，其中首先包含类数 $h(-4)$，然后是复合型的系数 $(a'', b'', c'')$，按此顺序排列。无需四舍五入。", "solution": "该问题分为两部分。首先，我们必须确定判别式为 $D = -4$ 的所有既约本原正定二元二次型的完整列表，从而求出类数 $h(-4)$。其次，我们必须计算主既约型与自身的高斯复合。\n\n第一部分：确定既约型和类数 $h(-4)$\n\n一个二元二次型 $Q(x,y) = ax^2 + bxy + cy^2$ 由整系数 $(a, b, c)$ 确定。判别式为 $D = b^2 - 4ac$。给定 $D = -4$。该二次型必须是本原的，即 $\\gcd(a, b, c) = 1$，并且是正定的，即 $D  0$ 且 $a > 0$。\n\n如果一个二次型满足不等式 $|b| \\leq a \\leq c$，以及附加条件：如果 $|b| = a$ 或 $a = c$，则 $b \\geq 0$，那么它就是既约的。\n\n让我们找出满足 $D=-4$ 条件的所有整数三元组 $(a, b, c)$。\n判别式方程为 $b^2 - 4ac = -4$，可以改写为 $4ac = b^2 + 4$。\n由于 $a$ 和 $c$ 是整数，$b^2+4$ 必须能被 $4$ 整除。这意味着 $b^2$ 必须能被 $4$ 整除，这又意味着 $b$ 必须是偶数。设 $b = 2k$，其中 $k$ 为某个整数。\n\n我们使用既约不等式来约束 $a$、$b$ 和 $c$ 的可能取值。\n根据正定条件，有 $a > 0$。\n既约条件是 $|b| \\leq a$ 和 $a \\leq c$。\n由于 $a \\leq c$，我们有 $4a^2 \\leq 4ac$。代入 $4ac = b^2 + 4$，得到 $4a^2 \\leq b^2 + 4$。\n由 $|b| \\leq a$，我们有 $b^2 \\leq a^2$。\n结合这些不等式，我们得到：\n$4a^2 \\leq b^2 + 4 \\leq a^2 + 4$\n这导致 $3a^2 \\leq 4$。\n\n由于 $a$ 必须是正整数，$a^2$ 也必须是正整数。不等式 $a^2 \\leq \\frac{4}{3}$ 对于 $a^2$ 只有一个正整数解，即 $a^2 = 1$。这意味着 $a = 1$。\n\n现在我们已经确定 $a=1$，我们使用条件 $|b| \\leq a$ 来求 $b$。\n$|b| \\leq 1$。\n如前所述，$b$ 必须是偶数。满足 $|b| \\leq 1$ 的唯一偶数 $b$ 是 $b = 0$。\n\n最后，我们使用判别式方程求出 $c$ 的值：\n$b^2 - 4ac = -4$\n$0^2 - 4(1)c = -4$\n$-4c = -4$\n$c = 1$。\n\n这给了我们一个唯一的既约型候选者：系数三元组 $(a,b,c) = (1, 0, 1)$。我们必须验证该二次型满足所有要求的条件。\n1. 二次型：$Q(x,y) = 1x^2 + 0xy + 1y^2 = x^2 + y^2$。\n2. 判别式：$D = 0^2 - 4(1)(1) = -4$。这是正确的。\n3. 正定性：$D  0$ 且 $a = 1 > 0$。这是正确的。\n4. 本原性：$\\gcd(a, b, c) = \\gcd(1, 0, 1) = 1$。这是正确的。\n5. 既约性：\n   - $|b| \\leq a \\implies |0| \\leq 1$，成立。\n   - $a \\leq c \\implies 1 \\leq 1$，成立。\n   - 附加条件：由于 $a=c=1$，我们必须有 $b \\geq 0$。我们的值 $b=0$ 满足此条件。\n二次型 $(1, 0, 1)$ 确实是判别式为 $D=-4$ 的一个既约本原正定二次型。由于这是我们找到的唯一一个这样的二次型，因此这类二次型的完整列表只包含这一个二次型。\n\n类数，记为 $h(D)$，是判别式为 $D$ 的本原正定二次型的不同真等价类的数量。这等于既约型的数量。\n由于只有一个既约型，所以类数为 $h(-4) = 1$。\n\n第二部分：高斯复合\n\n我们被要求将判别式为 $D=-4$ 的主既约型与自身进行复合。主型是代表类群单位元的二次型。对于正定二次型，这是 $a=1$ 的二次型。在我们的例子中，唯一的既约型是 $(1, 0, 1)$，所以它必然是主型。\n\n设 $Q_1(x_1, y_1) = x_1^2 + y_1^2$ 和 $Q_2(x_2, y_2) = x_2^2 + y_2^2$。系数分别为 $(a_1, b_1, c_1) = (1, 0, 1)$ 和 $(a_2, b_2, c_2) = (1, 0, 1)$。我们想要求出复合型 $Q'' = Q_1 \\circ Q_2$ 的系数 $(a'', b'', c'')$。\n\n高斯复合理论提供了一种构造复合型的方法。首先，我们计算 $g = \\gcd(a_1, a_2, \\frac{b_1+b_2}{2})$。\n使用我们的值，$g = \\gcd(1, 1, \\frac{0+0}{2}) = \\gcd(1, 1, 0) = 1$。\n\n复合型的第一个系数 $a''$ 由 $a'' = \\frac{a_1 a_2}{g^2}$ 给出。\n$a'' = \\frac{1 \\cdot 1}{1^2} = 1$。\n\n第二个系数 $b''$ 是一个整数 $B$，它是以下同余方程组的联立解：\n1. $B \\equiv b_1 \\pmod{2a_1/g}$\n2. $B \\equiv b_2 \\pmod{2a_2/g}$\n3. $B^2 \\equiv D \\pmod{4a_1 a_2 / g^2}$\n\n代入给定值 ($a_1=1, b_1=0, a_2=1, b_2=0, D=-4, g=1$)：\n1. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$。\n2. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$。\n3. $B^2 \\equiv -4 \\pmod{4(1)(1)/1^2} \\implies B^2 \\equiv 0 \\pmod 4$。\n\n从第一个同余方程可知，$B$ 必须是偶数。设 $B = 2k$，其中 $k \\in \\mathbb{Z}$ 是某个整数。\n将此代入第三个同余方程：$(2k)^2 = 4k^2$。这个数总能被 $4$ 整除，所以对于任何整数 $k$，$4k^2 \\equiv 0 \\pmod 4$。\n因此，任何偶数 $B$ 都是该同余方程组的有效解。$B$ 的具体选择会影响最终得到的是哪个等价类中的二次型。我们可以选择最简单的解，$B=0$。\n所以，我们取 $b'' = 0$。\n\n第三个系数 $c''$ 由复合型也必须具有判别式 $D = -4$ 这一要求确定：\n$b''^2 - 4a''c'' = D$\n$0^2 - 4(1)c'' = -4$\n$-4c'' = -4$\n$c'' = 1$。\n\n得到的复合型由系数 $(a'', b'', c'') = (1, 0, 1)$ 给出。\n我们必须检查该二次型是否是本原的：$\\gcd(a'', b'', c'') = \\gcd(1, 0, 1) = 1$。它是本原的。\n\n因此，主型 $(1, 0, 1)$ 与自身的复合产生二次型 $(1, 0, 1)$。这个结果是预料之中的，因为类群 $Cl(-4)$ 的阶为 $h(-4)=1$。唯一的元素是单位类，它必须是自身的逆元，将它与自身复合必须再次得到单位元。\n\n最终答案要求类数 $h(-4)$ 和复合型的系数 $(a'', b'', c'')$。\n$h(-4) = 1$\n$(a'', b'', c'') = (1, 0, 1)$", "answer": "$$\\boxed{\\begin{pmatrix} 1  1  0  1 \\end{pmatrix}}$$", "id": "3015035"}, {"introduction": "在理解了单位元的概念之后，我们来探索一个更丰富的结构——一个非平凡的类群。对于判别式 $D=-15$ 的情况，类群的阶数大于1。这个练习将让你亲手计算一个非主理想类自身的复合。通过这个计算，你将看到一个非单位元元素的平方如何通过高斯复合与既约化过程回到单位元，这清晰地揭示了类群中元素的“阶”的概念。[@problem_id:3085624]", "problem": "设 $D$ 为一个本原正定二元二次型的判别式，对于代表齐次多项式 $a x^{2} + b x y + c y^{2}$ 的二次型 $[a,b,c]$，其判别式定义为 $D = b^{2} - 4ac$。一个简约二次型满足 $|b| \\leq a \\leq c$，并且在 $|b| = a$ 或 $a = c$ 的情况下，要求 $b \\geq 0$。具有固定判别式的二元二次型类复合律定义了一个群结构（Gauss 复合），而简约算法在每个等价类中产生一个唯一的简约代表元。\n\n考虑两个具有相同负判别式 $D = -15$ 的简约本原正定二元二次型：\n- $f(x,y) = 2 x^{2} + x y + 2 y^{2}$，即 $[a,b,c] = [2,1,2]$；\n- $g(x,y) = 2 x^{2} + x y + 2 y^{2}$，即 $[a',b',c'] = [2,1,2]$。\n\n使用判别式为 $D = -15$ 的二次型类的复合律，计算 $f$ 和 $g$ 的复合，然后将所得二次型化简为其简约代表元。报告简约复合二次型的首项系数 $a$。提供精确的整数值，无需四舍五入。", "solution": "该问题要求计算一个本原正定二元二次型与其自身的复合，然后对所得的二次型进行简约化。给定的二次型是 $f(x,y) = 2x^2 + xy + 2y^2$，由系数三元组 $[a,b,c] = [2,1,2]$ 表示。第二个二次型 $g(x,y)$ 与 $f(x,y)$ 相同。该二次型的判别式为 $D = b^2 - 4ac = 1^2 - 4(2)(2) = 1 - 16 = -15$。问题陈述中判别式为 $D = -15$，这与计算结果一致。二次型 $[2,1,2]$ 是本原的，因为 $\\text{gcd}(2,1,2) = 1$。它也是简约的，因为它满足条件 $|b| \\leq a \\leq c$ (即 $|1| \\leq 2 \\leq 2$) 以及在 $a=c$ 的情况下 $b \\geq 0$。\n\n我们需要计算 $f$ 所在类与 $g$ 所在类的复合。由于 $f$ 和 $g$ 代表同一个二次型，我们实际上是在类群 $Cl(D) = Cl(-15)$ 中对 $[2,1,2]$ 所在的类进行平方运算。我们将使用 Dirichlet 复合算法。\n\n设两个二次型为 $f_1 = [a_1, b_1, c_1] = [2,1,2]$ 和 $f_2 = [a_2, b_2, c_2] = [2,1,2]$。两个二次型的判别式均为 $D = -15$。\n复合两个具有相同判别式的本原二次型的一般算法需要找到一个满足一个同余方程组的整数 $B$。首先，我们计算 $g = \\text{gcd}(a_1, a_2, \\frac{b_1+b_2}{2})$ 的值。\n在本例中，$a_1=2$，$a_2=2$，$b_1=1$，$b_2=1$。\n因此，$\\frac{b_1+b_2}{2} = \\frac{1+1}{2} = 1$。\n$g = \\text{gcd}(2, 2, 1) = 1$。\n\n整数 $B$ 必须满足以下同余式：\n1. $B \\equiv b_1 \\pmod{2a_1/g}$\n2. $B \\equiv b_2 \\pmod{2a_2/g}$\n3. $B^2 \\equiv D \\pmod{4a_1a_2/g^2}$\n\n代入给定值：\n1. $B \\equiv 1 \\pmod{2(2)/1} \\implies B \\equiv 1 \\pmod{4}$。\n2. $B \\equiv 1 \\pmod{2(2)/1} \\implies B \\equiv 1 \\pmod{4}$。此式是多余的。\n3. $B^2 \\equiv -15 \\pmod{4(2)(2)/1^2} \\implies B^2 \\equiv -15 \\pmod{16}$。\n\n我们必须求解这个关于 $B$ 的方程组。第三个同余式可简化为 $B^2 \\equiv 1 \\pmod{16}$，因为 $-15 \\equiv 1 \\pmod{16}$。\n根据第一个同余式，$B$ 必须具有 $B=4k+1$ 的形式，其中 $k$ 为某个整数。\n将此代入第二个条件：\n$(4k+1)^2 \\equiv 1 \\pmod{16}$\n$16k^2 + 8k + 1 \\equiv 1 \\pmod{16}$\n$8k \\equiv 0 \\pmod{16}$\n这意味着 $8k$ 是 $16$ 的倍数，所以 $k$ 必须是偶数。设 $k = 2j$，其中 $j$ 为某个整数。\n那么 $B = 4(2j)+1 = 8j+1$。这意味着 $B$ 必须满足 $B \\equiv 1 \\pmod 8$。\n我们可以选择最简单的解，即令 $j=0$，得到 $B=1$。\n\n复合二次型 $F = [A, B, C]$ 的系数由以下公式给出：\n$A = \\frac{a_1 a_2}{g^2} = \\frac{2 \\cdot 2}{1^2} = 4$。\n$B = 1$ (根据我们上面的选择)。\n$C = \\frac{B^2-D}{4A} = \\frac{1^2 - (-15)}{4 \\cdot 4} = \\frac{1+15}{16} = \\frac{16}{16} = 1$。\n\n所以，复合二次型是 $F = [4,1,1]$。\n该二次型的判别式是 $1^2 - 4(4)(1) = 1-16 = -15$，符合预期。\n\n接下来，我们必须找到 $F = [4,1,1]$ 所在类的唯一简约代表元。一个正定二次型 $[a,b,c]$ 是简约的，如果 $|b| \\leq a \\leq c$，并附加条件：若 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。\n对于二次型 $[4,1,1]$，我们有 $a=4$，$b=1$，$c=1$。\n条件 $a \\leq c$ 不满足，因为 $4 > 1$。因此，该二次型不是简约的。\n\n我们应用简约算法。\n步骤1：当前二次型为 $[4,1,1]$。由于 $a > c$，我们应用变换 $(a,b,c) \\to (c, -b, a)$，这是一个等价于变量替换 $(x,y) \\to (-y,x)$ 的等价变换。\n应用此变换，我们得到新的二次型 $[1, -1, 4]$。\n\n步骤2：现在我们检查二次型 $[1,-1,4]$。设其系数为 $a'=1, b'=-1, c'=4$。\n我们检查简约条件：\n$|b'| \\leq a' \\leq c'$ 转化为 $|-1| \\leq 1 \\leq 4$，即 $1 \\leq 1 \\leq 4$。这是成立的。\n但是，我们遇到了 $|b'|=a'$ 的情况。简约条件要求在这种情况下，中间系数必须为非负，即 $b' \\geq 0$。我们的二次型有 $b'=-1$，这违反了该条件。所以，$[1,-1,4]$ 还不是简约的。\n\n步骤3：为了解决这个问题，我们应用一个 $(a',b',c') \\to (a', b'+2a'k, c'')$ 类型的等价变换（$k$ 为整数），选择 $k$ 使得新的中间系数 $b'' = b'+2a'k$ 落在区间 $[-a', a']$ 内，并且在需要时满足非负条件。\n对于 $a'=1$ 和 $b'=-1$，我们有 $b'' = -1+2(1)k$。\n我们希望 $|b''| \\leq a'$，即 $|-1+2k| \\leq 1$。\n如果我们选择 $k=1$，那么 $b'' = -1+2(1) = 1$。\n条件 $|1| \\leq 1$ 得到满足。由于现在我们有 $|b''|=a'$，我们需要 $b'' \\geq 0$。我们新的 $b''=1$ 满足这个条件。\n所以，我们使用 $k=1$。新的二次型 $[a'', b'', c'']$ 将有 $a''=a'=1$ 和 $b''=1$。\n第三个系数 $c''$ 由判别式决定：\n$c'' = \\frac{(b'')^2-D}{4a''} = \\frac{1^2 - (-15)}{4 \\cdot 1} = \\frac{16}{4} = 4$。\n因此，新的二次型是 $[1,1,4]$。\n\n步骤4：最后，我们检查二次型 $[1,1,4]$ 是否是简约的。设 $a''=1, b''=1, c''=4$。\n条件 $|b''| \\leq a'' \\leq c''$ 转化为 $|1| \\leq 1 \\leq 4$，这是成立的。\n我们有 $|b''|=a''$，所以必须检查是否 $b'' \\geq 0$。由于 $b''=1$，这也成立。\n二次型 $[1,1,4]$ 是简约的。这是复合类的唯一简约代表元。\n\n问题要求简约复合二次型的首项系数 $a$。\n简约复合二次型是 $[1,1,4]$。其首项系数是 $1$。\n这个结果与类群 $Cl(-15)$ 的结构一致，这是一个2阶群。其元素是主形式 $[1,1,4]$（单位元）的类和二次型 $[2,1,2]$ 的类。将非单位元 $[2,1,2]$ 平方，得到单位元 $[1,1,4]$。\n简约复合二次型的首项系数是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3085624"}, {"introduction": "现在，让我们将前面学到的技巧结合起来，进行一次更全面的探索。这个练习要求你不仅执行复合运算，还要从头开始构建整个场景。你将首先通过既约化条件，找出判别式 $D=-20$ 的所有本原正定既约型，从而确定类群的全部成员。接着，你将通过计算非主类与自身的复合，来验证该类群的结构，并最终推导出类数 $h(-20)$。这项综合性实践将枚举二次型与分析群结构这两个核心过程紧密地联系在一起。[@problem_id:3083509]", "problem": "设二元二次型是函数 $f(x,y)=a x^{2}+b x y+c y^{2}$，其系数 $a$、$b$ 和 $c$ 为整数。其判别式为 $D=b^{2}-4 a c$。如果 $\\gcd(a,b,c)=1$，则该型称为本原的；如果 $D0$ 且 $a0$，则称为正定的。一个正定型被称为简约的，如果它满足简约不等式 $|b|\\leq a\\leq c$，并且当 $|b|=a$ 或 $a=c$ 时，还满足 $b\\geq 0$。如果一个型可以通过一个来自行列式为1的 $2\\times 2$ 整数矩阵的特殊线性群中的矩阵的变量变换转换成另一个型，则这两个型是真等价的。\n\n仅从这些定义出发，对判别式 $D=-20$ 执行以下操作：\n1. 直接根据简约不等式和定义条件 $b^{2}-4 a c=-20$，枚举出所有判别式为 $D=-20$ 的简约正定型。对于每个候选型，通过检查 $\\gcd(a,b,c)=1$ 来验证其是否为本原的。\n2. 使用固定判别式等价类上的经典 Gauss 二元二次型复合算法，将非主简约型与自身复合。在此复合中，通过以下方法确定乘积型 $(A,B,C)$：首先计算 $g=\\gcd(a,a',(b+b')/2)$，然后令 $A=\\frac{a a'}{g^{2}}$，接着选择 $B$ 以满足同余式 $B\\equiv b \\pmod{2 a}$ 和 $B\\equiv b' \\pmod{2 a'}$，且其方式与 $B$ 在模 $2A$ 下的定义一致，最后通过判别式条件 $B^{2}-4 A C=D$ 确定 $C$。\n3. 根据你的复合结果，推导出非主类的阶，并确定类数 $h(-20)$，其定义为判别式为 $-20$ 的本原正定二元二次型的真等价类的数量。\n\n将你的最终答案表示为等于 $h(-20)$ 的单个整数。", "solution": "该问题要求对判别式为 $D=-20$ 的二元二次型进行三部分分析，最终确定类数 $h(-20)$。我们将首先验证问题，然后进行求解。\n\n### 问题验证\n**步骤1：提取已知条件**\n- 二元二次型：$f(x,y)=a x^{2}+b x y+c y^{2}$，其中系数 $a$, $b$, $c$ 为整数。\n- 判别式：$D=b^{2}-4 a c$。\n- 本原的型：$\\gcd(a,b,c)=1$。\n- 正定型：$D0$ 且 $a0$。\n- 简约型：$|b|\\leq a\\leq c$，且如果 $|b|=a$ 或 $a=c$，则 $b\\geq 0$。\n- 真等价：通过 $SL_2(\\mathbb{Z})$ 中的矩阵进行变换。\n- 问题中的特定判别式：$D=-20$。\n- 任务1：枚举所有判别式为 $D=-20$ 的简约正定本原型。\n- 任务2：使用指定的 Gauss 复合方法将非主型与自身复合。该方法描述如下：$g=\\gcd(a,a',(b+b')/2)$，$A=\\frac{a a'}{g^{2}}$，$B$ 通过同余式 $B\\equiv b \\pmod{2 a}$ 和 $B\\equiv b' \\pmod{2 a'}$ 找到，而 $C$ 通过 $B^2 - 4AC = D$ 找到。\n- 任务3：推断非主类的阶并确定类数 $h(-20)$。\n- 最终答案：$h(-20)$ 的整数值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于经典数论，特别是 Gauss 建立的二元二次型理论。所有定义，包括本原、正定和简约型的定义，都是标准且正确的。问题是适定的，因为正定型的简约过程保证了每个等价类都有一个唯一的简约代表。任务是客观且可形式化的，需要基于所提供的定义和算法进行直接计算。不存在会妨碍唯一解的矛盾、信息缺失或歧义。所描述的复合算法虽然是一个更通用方法的具体实例，但对于当前任务来说在计算上是明确定义的。该问题不违反任何无效性标准。\n\n**步骤3：结论和行动**\n问题有效。我们继续进行求解。\n\n### 解答\n\n**第1部分：枚举简约型**\n我们寻求找到所有满足判别式为 $D=-20$ 的简约、本原、正定型条件的整数三元组 $(a,b,c)$。\n条件如下：\n1. $b^2 - 4ac = -20$，这意味着 $4ac = b^2 + 20$。\n2. $a > 0$。\n3. $|b| \\leq a \\leq c$。\n4. 如果 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。\n5. $\\gcd(a,b,c)=1$。\n\n从条件3，我们有 $|b| \\leq a$ 和 $a \\leq c$。\n将 $a \\leq c$ 代入判别式方程得到 $4a^2 \\leq 4ac = b^2 + 20$。\n另外， $|b| \\leq a$ 意味着 $b^2 \\leq a^2$。\n结合这些不等式，我们得到 $4a^2 \\leq b^2 + 20 \\leq a^2 + 20$。\n这导出了不等式 $3a^2 \\leq 20$，即 $a^2 \\leq \\frac{20}{3} \\approx 6.67$。\n由于 $a$ 必须是正整数，所以 $a$ 的唯一可能值为 1 和 2。\n\n情况1：$a=1$。\n简约条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$，所以 $b \\in \\{-1, 0, 1\\}$。\n- 如果 $b=0$：方程 $4ac = b^2 + 20$ 变为 $4(1)c = 0^2 + 20$，所以 $4c=20$，得到 $c=5$。我们得到型 $(1, 0, 5)$。\n  - 检查简约性：$|b|=0 \\leq a=1 \\leq c=5$。条件 $a \\leq c$ 满足。对于 $|b|=a$ 或 $a=c$ 的特殊条件不适用。该型是简约的。\n  - 检查本原性：$\\gcd(1, 0, 5) = 1$。该型是本原的。\n  - 因此，$x^2+5y^2$ 是一个有效的型。这是主型。\n\n- 如果 $b=1$：方程为 $4(1)c = 1^2 + 20$，所以 $4c=21$。这不会得到整数的 $c$ 值，所以不存在这样的型。\n- 如果 $b=-1$：简约条件 $|b|=1 \\leq a=1$ 满足。但是，由于 $|b|=a$，我们必须有 $b \\geq 0$。因为 $b=-1  0$，所以该型不是简约的。\n\n情况2：$a=2$。\n简约条件 $|b| \\leq a$ 意味着 $|b| \\leq 2$，所以 $b \\in \\{-2, -1, 0, 1, 2\\}$。\n判别式方程为 $4(2)c = b^2+20$，即 $8c = b^2+20$。为了使 $c$ 为整数，$b^2+20$ 必须能被 8 整除。\n- 如果 $b=0$，$8c=20$，没有整数解 $c$。\n- 如果 $b=\\pm 1$，$8c=21$，没有整数解 $c$。\n- 如果 $b=\\pm 2$，$8c = (\\pm 2)^2+20 = 24$，得到 $c=3$。\n  - 考虑从 $b=2$ 得到的可能型 $(2, 2, 3)$：\n    - 检查简约性：$|b|=2 \\leq a=2 \\leq c=3$。条件 $|b|\\leq a \\leq c$ 成立。由于 $|b|=a=2$，我们必须检查 $b \\geq 0$。因为 $b=2 \\geq 0$，所以该型是简约的。\n    - 检查本原性：$\\gcd(2, 2, 3) = 1$。该型是本原的。\n    - 因此，$2x^2+2xy+3y^2$ 是一个有效的型。\n  - 考虑从 $b=-2$ 得到的可能型 $(2, -2, 3)$：\n    - 检查简约性：$|b|=2 \\leq a=2 \\leq c=3$ 成立。但是，由于 $|b|=a=2$，我们必须有 $b\\geq 0$。因为 $b=-2  0$，所以该型不是简约的。\n\n总而言之，判别式为 $D=-20$ 的简约、本原、正定型恰好有两个：\n1. $(1, 0, 5)$\n2. $(2, 2, 3)$\n\n**第2部分：Gauss 复合**\n主型是 $(1, 0, 5)$，代表类群的单位元。非主型是 $(2, 2, 3)$。我们被要求将非主型与自身进行复合。\n设要复合的型为 $f_1 = (a_1, b_1, c_1) = (2, 2, 3)$ 和 $f_2 = (a_2, b_2, c_2) = (2, 2, 3)$。我们使用指定的算法。\n\n1. 计算 $g$：\n$g = \\gcd(a_1, a_2, (b_1+b_2)/2) = \\gcd(2, 2, (2+2)/2) = \\gcd(2, 2, 2) = 2$。\n\n2. 计算 $A$：\n$A = \\frac{a_1 a_2}{g^2} = \\frac{2 \\times 2}{2^2} = \\frac{4}{4} = 1$。\n\n3. 确定 $B$：\n问题陈述 $B$ 必须满足同余式 $B \\equiv b_1 \\pmod{2 a_1}$ 和 $B \\equiv b_2 \\pmod{2 a_2}$。\n$B \\equiv 2 \\pmod{2 \\times 2} \\implies B \\equiv 2 \\pmod{4}$。\n$B \\equiv 2 \\pmod{2 \\times 2} \\implies B \\equiv 2 \\pmod{4}$。\n这些同余式意味着 $B$ 必须是 $4k+2$ 的形式，其中 $k$ 是某个整数。问题还指出，这个选择必须与“$B$ 在模 $2A$ 下定义”相一致。这里，$2A = 2(1)=2$。任何 $4k+2$ 形式的数都是偶数，所以 $B \\equiv 0 \\pmod{2}$，这是模 2 下的单个值。这是一致的。\n\n4. 计算 $C$：\n第三个系数 $C$ 由判别式条件确定：$B^2 - 4AC = D$。\n$B^2 - 4(1)C = -20 \\implies 4C = B^2 + 20$。\n代入 $B=4k+2$：\n$4C = (4k+2)^2 + 20 = 16k^2 + 16k + 4 + 20 = 16k^2+16k+24$。\n$C = 4k^2 + 4k + 6$。\n得到的型是 $(A, B, C) = (1, 4k+2, 4k^2+4k+6)$。对于不同的整数 $k$ 值，所有这些型都属于同一个真等价类。我们选择最简单的情况，$k=0$，这给出 $B=2$ 和 $C=6$。乘积型为 $(1, 2, 6)$。\n\n5. 简约乘积型：\n型 $(1, 2, 6)$ 不是简约的，因为 $|b|=2 > a=1$。我们必须应用简约算法。我们使用一个 $\\begin{pmatrix} 1  m \\\\ 0  1 \\end{pmatrix}$ 类型的 $SL_2(\\mathbb{Z})$ 变换，它将一个型 $(a,b,c)$ 变换为 $(a, b+2am, am^2+bm+c)$。\n我们有 $(a,b,c)=(1,2,6)$。我们想选择一个整数 $m$ 来最小化 $|b+2am| = |2+2(1)m| = |2+2m|$。选择 $m=-1$ 得到新的中间系数 $b' = 2+2(-1)=0$。\n新的型 $(a', b', c')$ 具有：\n$a' = a = 1$。\n$b' = b+2am = 0$。\n$c' = am^2+bm+c = 1(-1)^2 + 2(-1) + 6 = 1-2+6 = 5$。\n简约型是 $(1, 0, 5)$。\n\n$(2, 2, 3)$ 的类与自身的复合产生 $(1, 0, 5)$ 的类。\n\n**第3部分：阶与类数**\n令 $[f]$ 表示型 $f$ 的等价类。在复合运算下，等价类的集合构成一个有限阿贝尔群，称为类群。该群的阶是类数 $h(D)$。主型 $[(1,0,5)]$ 的类是群的单位元。\n从第2部分，我们发现非主型 $[(2,2,3)]$ 的类与自身的复合结果是单位类：\n$$[(2, 2, 3)] \\circ [(2, 2, 3)] = [(1, 0, 5)]$$\n这意味着类 $[(2, 2, 3)]$ 是类群中一个阶为 2 的元素。\n在第1部分中，我们发现判别式为 $D=-20$ 的本原正定型恰好有两个等价类，由简约型 $(1, 0, 5)$ 和 $(2, 2, 3)$ 代表。\n根据定义，类数 $h(-20)$ 就是这些类的数量。\n因此，类数为 $h(-20)=2$。类群是一个阶为 2 的群，同构于 $\\mathbb{Z}/2\\mathbb{Z}$，其元素为单位类 $[(1,0,5)]$ 和阶为 2 的类 $[(2,2,3)]$。这与我们的复合结果一致。\n\n所要求的最终答案是 $h(-20)$ 的值。\n$h(-20) = 2$。", "answer": "$$\\boxed{2}$$", "id": "3083509"}]}