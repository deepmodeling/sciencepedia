{"hands_on_practices": [{"introduction": "在应用Minkowski定理之前，我们必须首先正确地构建它所作用的数学对象——格。这个练习将引导你形式化地定义与两数平方和问题相关的格 $\\Lambda$，证明它具备必要的属性，并计算其基本特征：行列式 [@problem_id:3081185]。这确保了我们使用的几何工具是定义明确且可靠的。", "problem": "设 $p$ 是一个奇素数，使得存在一个整数 $a$ 满足 $a^{2} \\equiv -1 \\pmod{p}$。考虑由下式定义的子集 $\\Lambda \\subset \\mathbb{R}^{2}$\n$$\n\\Lambda \\;=\\; \\{(x,y) \\in \\mathbb{Z}^{2} \\;:\\; x \\equiv a y \\pmod{p}\\}.\n$$\n这个格出现在通过 Minkowski 凸体定理将 $p$ 表示为两平方和的数的几何方法中。从 $\\mathbb{R}^{2}$ 中格的基本定义以及作为基本平行四边形面积的格的行列式（余体积）的定义出发，完成以下任务：\n- 证明 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 中的一个满秩格。\n- 构造一个用 $p$ 和 $a$ 表示的 $\\Lambda$ 的显式 $\\mathbb{Z}$-基。\n- 直接根据你构造的基计算行列式 $\\det(\\Lambda)$。\n\n你的最终答案必须是用 $p$ 和 $a$ 表示的 $\\det(\\Lambda)$ 的精确闭式表达式。不需要四舍五入。", "solution": "该问题要求对集合 $\\Lambda$ 进行分析并计算其行列式。\n问题陈述给出了以下已知条件：\n- $p$ 是一个奇素数。\n- 存在一个整数 $a$ 使得 $a^{2} \\equiv -1 \\pmod{p}$。\n- 集合 $\\Lambda \\subset \\mathbb{R}^{2}$ 定义为 $\\Lambda = \\{(x,y) \\in \\mathbb{Z}^{2} \\;:\\; x \\equiv a y \\pmod{p}\\}$。\n\n该问题经验证是合理的。这是数的几何（数论的一个分支）中的一个标准问题。所有术语都有明确定义，前提在数学上是正确的，且目标是可形式化和可解的。条件 $a^{2} \\equiv -1 \\pmod{p}$ 是将 $p$ 表示为两平方和的一个著名先决条件，这也是本题的背景。\n\n我们继续完成所要求的三项任务。\n\n**1. 证明 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 中的一个满秩格。**\n\n如果 $\\mathbb{R}^{n}$ 的一个子集是加法群 $(\\mathbb{R}^{n}, +)$ 的一个离散子群，则该子集是一个格。首先，我们证明 $\\Lambda$ 是 $(\\mathbb{Z}^{2}, +)$ 的一个子群。由于 $(\\mathbb{Z}^{2}, +)$ 是 $(\\mathbb{R}^{2}, +)$ 的一个离散子群，它的任何子群（包括 $\\Lambda$）也都是离散的。\n\n为了证明 $\\Lambda$ 是一个子群，我们使用子群判别法。\n- 集合 $\\Lambda$ 非空，因为 $(0,0) \\in \\mathbb{Z}^{2}$ 且 $0 \\equiv a \\cdot 0 \\pmod{p}$，所以 $(0,0) \\in \\Lambda$。\n- 设 $v_1 = (x_1, y_1)$ 和 $v_2 = (x_2, y_2)$ 是 $\\Lambda$ 的任意两个元素。根据定义，$x_1, y_1, x_2, y_2$ 都是整数。它们属于 $\\Lambda$ 的条件是：\n  $x_1 \\equiv a y_1 \\pmod{p}$\n  $x_2 \\equiv a y_2 \\pmod{p}$\n- 考虑差 $v_1 - v_2 = (x_1 - x_2, y_1 - y_2)$。由于 $x_1, x_2, y_1, y_2$ 是整数，差的分量也是整数，所以 $v_1 - v_2 \\in \\mathbb{Z}^{2}$。\n- 现在我们检验 $v_1 - v_2$ 的同余条件：\n  $$x_1 - x_2 \\equiv a y_1 - a y_2 \\pmod{p}$$\n  $$x_1 - x_2 \\equiv a(y_1 - y_2) \\pmod{p}$$\n- 这表明 $v_1 - v_2 \\in \\Lambda$。根据子群判别法，$\\Lambda$ 是 $(\\mathbb{Z}^{2}, +)$ 的一个子群。如前所述，这意味着 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 的一个离散子群，因此是一个格。\n\n为了证明 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 中的一个*满秩*格，我们必须证明它包含两个在 $\\mathbb{R}$ 上线性无关的向量。这等价于证明由 $\\Lambda$ 中元素张成的实向量空间就是 $\\mathbb{R}^{2}$ 本身。\n\n让我们在 $\\Lambda$ 中找出这样两个向量。\n- 考虑一个 $y$ 分量为 $y=0$ 的向量。条件变为 $x \\equiv a \\cdot 0 \\pmod{p}$，简化为 $x \\equiv 0 \\pmod{p}$。这意味着 $x$ 必须是 $p$ 的倍数。最简单的非零整数选择是 $x=p$。因此，向量 $v_1 = (p, 0)$ 属于 $\\Lambda$。\n- 考虑一个 $y$ 分量为 $y=1$ 的向量。条件变为 $x \\equiv a \\cdot 1 \\pmod p$。一个简单的整数选择是 $x=a$。因此，向量 $v_2 = (a, 1)$ 属于 $\\Lambda$。\n\n现在我们检验向量 $v_1 = (p, 0)$ 和 $v_2 = (a, 1)$ 是否在 $\\mathbb{R}$ 上线性无关。我们可以用这些向量构成一个矩阵，并检查其行列式是否非零。\n$$\n\\det\\begin{pmatrix} p  a \\\\ 0  1 \\end{pmatrix} = (p)(1) - (a)(0) = p\n$$\n因为 $p$ 是一个素数，所以 $p \\neq 0$。因此，向量 $v_1$ 和 $v_2$ 在 $\\mathbb{R}$ 上线性无关。由于 $\\Lambda$ 包含 $\\mathbb{R}^{2}$ 中的两个线性无关向量，它张成 $\\mathbb{R}^{2}$，是一个满秩格。\n\n**2. 构造一个 $\\Lambda$ 的显式 $\\mathbb{Z}$-基。**\n\n我们提出，上面找到的两个向量 $v_1 = (p, 0)$ 和 $v_2 = (a, 1)$ 构成了 $\\Lambda$ 的一个 $\\mathbb{Z}$-基。为了证明这一点，我们必须证明任何向量 $v = (x, y) \\in \\Lambda$ 都可以唯一地写成 $v_1$ 和 $v_2$ 的整系数线性组合。\n\n设 $v = (x,y)$ 是 $\\Lambda$ 的一个任意元素。我们想要找到整数 $c_1, c_2$ 使得：\n$$ (x,y) = c_1 v_1 + c_2 v_2 = c_1(p, 0) + c_2(a, 1) $$\n展开右边得：\n$$ (x,y) = (c_1 p + c_2 a, c_2) $$\n对等分量，我们得到一个由两个方程组成的方程组：\n1. $y = c_2$\n2. $x = c_1 p + c_2 a$\n\n由第一个方程得 $c_2 = y$。由于 $v=(x,y) \\in \\Lambda \\subset \\mathbb{Z}^{2}$，$y$ 是一个整数。所以 $c_2$ 是一个整数。\n将 $c_2=y$ 代入第二个方程得到：\n$$ x = c_1 p + y a $$\n$$ c_1 p = x - ya $$\n为了求出 $c_1$，我们必须检验 $x-ya$ 是否能被 $p$ 整除。根据 $\\Lambda$ 的定义，由于 $(x,y) \\in \\Lambda$，我们有 $x \\equiv ya \\pmod{p}$。这意味着 $x-ya$ 是 $p$ 的一个整数倍。设 $x - ya = k p$ 对于某个整数 $k$。\n那么 $c_1 p = kp$，这意味着 $c_1 = k$。因为 $k$ 是一个整数，所以 $c_1$ 也是一个整数。\n因此，对于任何 $v=(x,y) \\in \\Lambda$，我们都能找到唯一的整数 $c_1 = \\frac{x-ya}{p}$ 和 $c_2 = y$ 使得 $v = c_1 v_1 + c_2 v_2$。\n这证明了集合 $\\{v_1, v_2\\} = \\{(p, 0), (a, 1)\\}$ 构成了格 $\\Lambda$ 的一个 $\\mathbb{Z}$-基。\n\n**3. 直接根据你构造的基计算行列式 $\\det(\\Lambda)$。**\n\n$\\mathbb{R}^{n}$ 中格 $\\Lambda$ 的行列式（也称为其余体积）定义为由格的基向量作为行（或列）构成的矩阵的行列式的绝对值。\n使用我们构造的基 $v_1 = (p, 0)$ 和 $v_2 = (a, 1)$，我们构成基矩阵 $B$：\n$$\nB = \\begin{pmatrix} p  0 \\\\ a  1 \\end{pmatrix}\n$$\n该矩阵的行列式是：\n$$ \\det(B) = (p)(1) - (0)(a) = p $$\n格 $\\Lambda$ 的行列式是 $\\det(B)$ 的绝对值：\n$$ \\det(\\Lambda) = |\\det(B)| = |p| $$\n因为 $p$ 是一个素数，所以它是正数。因此 $|p| = p$。\n格 $\\Lambda$ 的行列式是 $p$。", "answer": "$$\\boxed{p}$$", "id": "3081185"}, {"introduction": "建立了格的结构之后，让我们为一个特定的素数完整地走一遍构造性证明的流程。这个针对 $p=29$ 的练习将使证明中的抽象步骤变得具体，从寻找模平方根到最终确定整数对 $(x,y)$ [@problem_id:3081193]。你将亲眼见证数之几何如何从理论走向一个确切的答案。", "problem": "设 $p=29$。利用平面 $\\mathbb{R}^{2}$ 上的闵可夫斯基凸体定理原理，以及当 $p \\equiv 1 \\pmod{4}$ 时，剩余类 $-1$ 在模 $p$ 意义下有平方根这一基本事实，执行以下步骤。\n\n- 构造一个行列式为 $p$ 的满秩格 $\\Lambda \\subset \\mathbb{R}^{2}$，该格对整数向量 $(x,y) \\in \\Lambda$ 编码了同余约束 $x^{2}+y^{2} \\equiv 0 \\pmod{p}$。\n- 选择一个中心对称的凸正方形 $B \\subset \\mathbb{R}^{2}$，其面积严格超过闵可夫斯基凸体定理对 $\\Lambda$ 所要求的阈值，并解释为什么闵可夫斯基定理保证了在 $\\Lambda \\cap B$ 中存在一个非零格点 $(x,y)$。\n- 证明你的选择迫使上面找到的非零点 $(x,y)$ 满足 $0  x^{2}+y^{2}  2p$，并由此推导出 $x^{2}+y^{2}=p$。\n- 用此方法计算出一个满足 $x^{2}+y^{2}=29$ 且具有最小非负坐标的明确整数对 $(x,y)$。\n\n使用 $\\pmatrix{\\cdot  \\cdot}$ 记法将最终的 $(x,y)$ 以单行形式给出。无需四舍五入，也不涉及单位。", "solution": "该问题要求应用闵可夫斯基凸体定理来为素数 $p=29$ 找到方程 $x^2+y^2=p$ 的一个整数解。该过程分为四个步骤，我们将系统地遵循这些步骤。\n\n首先，我们验证同余方程 $u^2 \\equiv -1 \\pmod{p}$ 有解这一前提。给定 $p=29$。这个素数满足 $29 \\equiv 1 \\pmod{4}$。根据费马平方和定理（或者更初等地，根据二次剩余的性质），同余方程 $u^2 \\equiv -1 \\pmod{p}$ 保证有整数解。对于 $p=29$，我们需要找到一个整数 $u$ 使得 $u^2 \\equiv -1 \\pmod{29}$，即 $u^2 \\equiv 28 \\pmod{29}$。通过测试较小的整数值，我们发现 $12^2 = 144$。$144$ 除以 $29$ 得到 $144 = 4 \\times 29 + 28$。因此，$12^2 \\equiv 28 \\pmod{29}$，我们可以选择 $u=12$。\n\n**步骤 1：构造格 $\\Lambda$**\n\n我们需要构造一个行列式为 $p=29$ 的满秩格 $\\Lambda \\subset \\mathbb{R}^2$，使得任意整数向量 $(x,y) \\in \\Lambda$ 都满足 $x^2+y^2 \\equiv 0 \\pmod{29}$。\n同余式 $x^2+y^2 \\equiv 0 \\pmod{p}$ 可以用我们的 $u$ 值改写为：\n$x^2 - u^2y^2 \\equiv 0 \\pmod{p} \\implies (x-uy)(x+uy) \\equiv 0 \\pmod{p}$。\n该同余式成立的条件是 $x \\equiv uy \\pmod{p}$ 或 $x \\equiv -uy \\pmod{p}$。我们可以选择其中一个条件来定义我们的格。我们选择 $x \\equiv uy \\pmod{p}$。当 $u=12$ 和 $p=29$ 时，该条件为 $x \\equiv 12y \\pmod{29}$。\n\n格是一组基向量的所有整系数线性组合的集合。我们寻求一组基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$，其张成的集合为所有满足 $x \\equiv 12y \\pmod{29}$ 的整数向量 $(x,y) \\in \\mathbb{Z}^2$。\n格中的一个点具有形式 $\\mathbf{v} = (x,y) = a\\mathbf{v}_1 + b\\mathbf{v}_2$，其中 $a, b$ 为整数。\n我们来构造一组基。条件 $x - 12y = 29k$（其中 $k$ 为某个整数）定义了这个点集。\n一个满足此条件的明显向量是 $(29,0)$，因为 $29 - 12(0) = 29(1)$。所以我们可以取 $\\mathbf{v}_1 = (29, 0)$。\n另一个简单的向量可以通过设置 $y=1$ 并找到满足 $x \\equiv 12 \\pmod{29}$ 的最小非负整数 $x$ 来得到。这个值是 $x=12$。所以，向量 $(12,1)$ 满足该同余式。我们选择 $\\mathbf{v}_2 = (12,1)$。\n\n格 $\\Lambda$ 是这些向量的所有整系数线性组合的集合：\n$$ \\Lambda = \\{ a(29, 0) + b(12, 1) \\mid a, b \\in \\mathbb{Z} \\} $$\n任何向量 $(x,y) \\in \\Lambda$ 都可以写成 $(x,y) = (29a+12b, b)$。对于这样的向量，我们来验证同余式：\n$x - 12y = (29a+12b) - 12(b) = 29a$。\n由于 $29a \\equiv 0 \\pmod{29}$，我们有 $x \\equiv 12y \\pmod{29}$，这意味着 $x^2 \\equiv 144y^2 \\equiv -y^2 \\pmod{29}$，因此 $x^2+y^2 \\equiv 0 \\pmod{29}$。该格正确地编码了此约束。\n\n格的行列式 $\\det(\\Lambda)$ 是由基向量构成的矩阵的行列式的绝对值：\n$$ \\det(\\Lambda) = \\left| \\det \\begin{pmatrix} 29  0 \\\\ 12  1 \\end{pmatrix} \\right| = |29 \\cdot 1 - 0 \\cdot 12| = 29 $$\n所以 $\\det(\\Lambda)=p=29$，符合要求。\n\n**步骤 2：选择凸体并应用闵可夫斯基定理**\n\n我们必须选择一个中心对称的凸正方形 $B \\subset \\mathbb{R}^2$，其面积严格大于 $4 \\det(\\Lambda)$。闵可夫斯基凸体定理指出，对于 $\\mathbb{R}^2$ 中的一个中心对称凸体 $B$，如果其面积 $\\text{Area}(B)  4 \\det(\\Lambda)$，那么 $B$ 必须包含至少一个 $\\Lambda$ 中的非零点。\n\n设 $B$ 是一个以原点为中心的开放正方形，定义为 $B = \\{ (x,y) \\in \\mathbb{R}^2 \\mid |x|  s, |y|  s \\}$，其中 $s$ 为某个实数。这个集合是凸集且中心对称。\n其面积为 $\\text{Area}(B) = (2s)^2 = 4s^2$。\n根据闵可夫斯基定理，条件是 $4s^2  4 \\det(\\Lambda) = 4p = 4(29) = 116$。\n这可以简化为 $s^2  29$。\n为了满足问题的下一步，我们需要审慎地选择 $s$。我们来做一个具体的选择。我们需要 $s  \\sqrt{29} \\approx 5.385$。我们选择一个 $s$ 使得 $s^2  29$ 但 $s$ 又不要太大。例如，取 $s=5.5$ 得到 $s^2 = 30.25$。\n由于 $30.25  29$，条件 $s^2  p$ 得到满足。在这个选择下，$\\text{Area}(B) = 4(30.25) = 121  116$。\n闵可夫斯基定理保证了在 $\\Lambda \\cap B$ 中存在一个非零整数向量 $(x,y)$。\n\n**步骤 3：推导 $x^2+y^2=p$**\n\n在步骤 2 中找到的非零向量 $(x,y)$ 具有整数坐标，并且同时属于格 $\\Lambda$ 和正方形 $B$。\n- 由于 $(x,y) \\in B$，我们有 $|x|  5.5$ 和 $|y|  5.5$。因为 $x$ 和 $y$ 是整数，这些不等式意味着 $|x| \\le 5$ 和 $|y| \\le 5$。\n- 根据这些整数界限，我们可以限定平方和：$x^2 \\le 25$ 和 $y^2 \\le 25$，所以 $x^2+y^2 \\le 25+25=50$。\n- 由于 $(x,y) \\in \\Lambda$，我们知道 $x^2+y^2$ 必须是 $p=29$ 的倍数。所以，$x^2+y^2 = k \\cdot 29$，其中 $k$ 为某个整数。\n- 由于 $(x,y)$ 是一个非零向量，$(x,y) \\ne (0,0)$，这意味着 $x^2+y^2  0$。因此，$k$ 必须是一个正整数，$k \\ge 1$。\n\n结合这些条件，我们得到 $x^2+y^2 = 29k \\le 50$。\n满足这个不等式的唯一正整数 $k$ 是 $k=1$。\n因此，我们必然有 $x^2+y^2=29$。\n\n这个结果 $x^2+y^2=29$ 满足条件 $0  x^2+y^2  2p$，因为 $0  29  2(29)=58$。选择边长参数为 $s=5.5$ 的正方形 $B$ 使得我们得到了期望的结论。\n\n**步骤 4：计算明确的整数对**\n\n我们需要找到一个位于我们的正方形 $B$ 内的明确的非零向量 $(x,y) \\in \\Lambda$。$\\Lambda$ 中的向量形式为 $(x,y) = (29a+12b, b)$，其中 $a, b$ 是整数。条件是 $|x| \\le 5$ 和 $|y| \\le 5$。\n条件 $|y| \\le 5$ 转化为 $|b| \\le 5$。我们寻找满足这些约束的整数对 $(a,b)$（不全为零）。\n我们来测试 $b$ 从 $1$到 $5$ 的值：\n- 如果 $b=1$：$|29a+12| \\le 5 \\implies -17 \\le 29a \\le -7$。对于 $a$ 没有整数解。\n- 如果 $b=2$：$|29a+24| \\le 5 \\implies -29 \\le 29a \\le -19$。这意味着 $a=-1$。\n  我们来检验这对 $(a,b)=(-1,2)$：\n  $x = 29(-1) + 12(2) = -29+24 = -5$。\n  $y = b = 2$。\n  向量是 $(-5, 2)$。这是一个非零向量。其坐标满足 $|-5| \\le 5$ 和 $|2| \\le 5$。其平方和是 $(-5)^2+2^2 = 25+4=29$。这是这样一个向量。\n- 如果 $b=3$：$|29a+36| \\le 5 \\implies -41 \\le 29a \\le -31$。对于 $a$ 没有整数解。\n- 如果 $b=4$：$|29a+48| \\le 5 \\implies -53 \\le 29a \\le -43$。对于 $a$ 没有整数解。\n- 如果 $b=5$：$|29a+60| \\le 5 \\implies -65 \\le 29a \\le -55$。这意味着 $a=-2$。\n  我们来检验这对 $(a,b)=(-2,5)$：\n  $x=29(-2)+12(5) = -58+60 = 2$。\n  $y=b=5$。\n  向量是 $(2,5)$。这是一个非零向量。其坐标满足 $|2|\\le 5$ 和 $|5|\\le 5$。其平方和是 $2^2+5^2=4+25=29$。\n\n我们找到了两个候选对（不计符号和顺序）：$(2,5)$ 和 $(5,2)$。问题要求找到具有最小非负坐标的整数对 $(x,y)$。具有非负坐标的整数对有来自 $(a,b)=(-2,5)$ 的 $(2,5)$，以及可能通过改变 $u$ 得到的其他对。在我们的构造中，我们找到了 $(2,5)$。按照惯例，我们先列出较小的坐标。\n\n整数对 $(2,5)$，即 $x=2, y=5$，由非负整数组成，满足 $2^2+5^2=29$，并且是我们为寻找闵可夫斯基定理所保证的点而进行的系统性搜索得出的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  5\n\\end{pmatrix}\n}\n$$", "id": "3081193"}, {"introduction": "构造性证明的真正威力在于其能够转化为算法。这最后一个练习将挑战你将整个过程代码化，从寻找 $-1$ 的模平方根到执行格基约化 [@problem_id:3081159]。通过实现这个方法，你将对这些数论概念如何转化为实用的计算工具有一个深刻的、操作层面的理解。", "problem": "设 $p$ 为一个满足 $p \\equiv 1 \\pmod{4}$ 的奇素数。目标是实现一个算法，对于每个这样的 $p$，使用源自 Minkowski 凸体定理的格方法构造一个 $p = x^2 + y^2$ 的表示。\n\n理论基础：\n- Minkowski 凸体定理（源于数的几何）：若 $\\Lambda \\subset \\mathbb{R}^n$ 是一个余体积为 $\\operatorname{covol}(\\Lambda)$ 的格，且 $K \\subset \\mathbb{R}^n$ 是一个中心对称凸体，其体积 $\\operatorname{vol}(K)  2^n \\operatorname{covol}(\\Lambda)$，则 $K$ 包含一个非零格点。\n- 定义：格 $\\Lambda \\subset \\mathbb{R}^2$ 是由两个线性无关向量生成的离散子群。余体积是基矩阵行列式的绝对值。$(x,y)$ 的范数是 $\\sqrt{x^2 + y^2}$。\n- 模素数的二次剩余：对于奇素数 $p$，$-1$ 是二次剩余当且仅当 $p \\equiv 1 \\pmod{4}$。\n\n您的程序必须：\n1. 对于每个满足 $p \\equiv 1 \\pmod{4}$ 的输入素数 $p$，使用一个对任何奇素数都有效（例如，不依赖于素性之外的 $p$ 的特殊同余关系的 Tonelli–Shanks 算法的变体）的通用模平方根算法，计算一个整数 $a$ 使得 $a^2 \\equiv -1 \\pmod{p}$。\n2. 构造格 $\\Lambda = \\{(x,y) \\in \\mathbb{Z}^2 : x \\equiv a y \\pmod{p}\\}$。给出一个 $\\Lambda$ 的 $\\mathbb{Z}$-基，并执行二维格归约（Gauss 归约）以获得一个短的非零向量 $(x,y) \\in \\Lambda$。\n3. 通过应用 Minkowski 凸体定理来证明，存在一个非零向量 $(x,y) \\in \\Lambda$ 满足 $x^2 + y^2  2p$。解释为什么当 $p$ 是素数且 $a^2 \\equiv -1 \\pmod{p}$ 时，任何这样的 $(x,y)$ 都必须满足 $x^2 + y^2 = p$。您的实现必须仅在 Minkowski 定理所证明的界限内搜索，即必须找到一个非零向量 $(x,y) \\in \\Lambda$ 满足 $x^2 + y^2  2p$。\n4. 对每个 $p$ 的输出对进行规范化，要求 $x \\ge 0$，$y \\ge 0$ 且 $x \\le y$。\n\n输入规范是隐式的：您的程序没有外部输入，必须在下面列出的固定素数测试集上运行。\n\n测试集：\n- 情况 1：$p = 5$。\n- 情况 2：$p = 13$。\n- 情况 3：$p = 29$。\n- 情况 4：$p = 37$。\n- 情况 5：$p = 97$。\n- 情况 6：$p = 101$。\n\n答案规范：\n- 对于每个测试用例素数 $p$，输出一对满足 $x^2 + y^2 = p$ 且 $x \\le y$ 的非负整数 $[x,y]$。整个测试集的结果必须是包含这些数对的单个列表，顺序与测试集相同。最终输出必须是一个单行字符串，其格式与 Python 的列表的列表字面量完全一样，例如 $[[x_1,y_1],[x_2,y_2],\\dots]$，除了列表语法要求的空格外，不添加或删除任何空格。\n- 所有量均为纯整数；没有物理单位。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，\"[[x1,y1],[x2,y2],[x3,y3]]\"）。", "solution": "我们从数论和数的几何中的标准原理开始。\n\n第 1 步：模 $p$ 的 $-1$ 平方根的存在性及其计算方法。\n- 对于奇素数 $p$，Euler 判别法指出，对于任何 $n \\not\\equiv 0 \\pmod{p}$，都有 $n^{(p-1)/2} \\equiv \\left(\\frac{n}{p}\\right) \\pmod{p}$，其中 $\\left(\\frac{n}{p}\\right)$ 是 Legendre 符号。特别地，$\\left(\\frac{-1}{p}\\right) = 1$ 当且仅当 $p \\equiv 1 \\pmod{4}$，这确保了存在一个 $a$ 使得 $a^2 \\equiv -1 \\pmod{p}$。\n- 要为一个通用奇素数 $p$ 算法化地计算这样的 $a$，我们可以使用 Tonelli–Shanks 算法。给定 $n \\equiv -1 \\pmod{p}$，Tonelli–Shanks 通过以下步骤计算满足 $a^2 \\equiv n \\pmod{p}$ 的 $a$：\n  - 将 $p-1$ 写成 $Q \\cdot 2^S$ 的形式，其中 $Q$ 为奇数。\n  - 找到一个满足 $\\left(\\frac{z}{p}\\right) = -1$ 的 $z$。\n  - 设置 $M = S$，$c \\equiv z^Q \\pmod{p}$，$t \\equiv n^Q \\pmod{p}$，$R \\equiv n^{(Q+1)/2} \\pmod{p}$。\n  - 迭代直到 $t \\equiv 1 \\pmod{p}$，使用连续平方来校正 $R$、$t$ 和 $c$ 以强制收敛。该算法是一个经过充分检验的标准算法，不依赖于像 $p \\equiv 3 \\pmod{4}$ 指数技巧这样的特例捷径。\n\n第 2 步：构造格 $\\Lambda$ 及其基。\n- 定义格 $\\Lambda = \\{ (x,y) \\in \\mathbb{Z}^2 : x \\equiv a y \\pmod{p} \\}$。这是 $\\mathbb{R}^2$ 中的一个满秩格。一个方便的 $\\mathbb{Z}$-基由以下两个向量给出\n  $$\n  \\mathbf{b}_1 = (a,1), \\quad \\mathbf{b}_2 = (p,0).\n  $$\n  确实，任何整数组合 $m \\mathbf{b}_1 + n \\mathbf{b}_2 = (ma + np, m)$ 都在 $\\Lambda$ 中，因为 $ma + np \\equiv a m \\equiv a y \\pmod{p}$。基矩阵\n  $$\n  B = \\begin{pmatrix} a  p \\\\ 1  0 \\end{pmatrix}\n  $$\n  的行列式为 $-p$，因此 $\\Lambda$ 的余体积为 $|\\det(B)| = p$。\n\n第 3 步：应用 Minkowski 凸体定理来界定搜索范围。\n- 考虑闭欧几里得圆盘\n  $$\n  K = \\{ (x,y) \\in \\mathbb{R}^2 : x^2 + y^2 \\le 2p \\}.\n  $$\n  这是一个在 $\\mathbb{R}^2$ 中的中心对称凸体，其面积为 $\\operatorname{vol}(K) = \\pi ( \\sqrt{2p} )^2 = 2 \\pi p$。由于 $2 \\pi p > 4 p = 2^2 \\cdot \\operatorname{covol}(\\Lambda)$ (因为 $\\pi > 2$)，Minkowski 凸体定理保证存在一个非零格点 $(x,y) \\in \\Lambda \\cap K$。因此，存在一个非零向量 $(x,y) \\in \\Lambda$ 满足\n  $$\n  x^2 + y^2 \\le 2p.\n  $$\n  使用鸽巢原理或考虑一个稍小的半径进行细化，可以为某个非零格向量得出严格不等式 $x^2 + y^2  2p$。特别地，$\\Lambda$ 中的最小非零平方范数严格小于 $2p$。\n- 根据 $\\Lambda$ 的定义同余式和 $a$ 的选择，任何 $(x,y) \\in \\Lambda$ 都满足\n  $$\n  x \\equiv a y \\pmod{p} \\quad \\Longrightarrow \\quad x^2 + y^2 \\equiv (a^2 + 1) y^2 \\equiv 0 \\pmod{p}.\n  $$\n  因此，对于任何非零向量 $(x,y) \\in \\Lambda$，整数 $x^2 + y^2$ 是 $p$ 的一个正倍数。如果此外还有 $x^2 + y^2  2p$，那么唯一可能性是\n  $$\n  x^2 + y^2 = p.\n  $$\n\n第 4 步：算法上提取短非零格向量。\n- 在二维空间中，Gauss 归约提供了一种为格寻找一个非常短的基的高效方法。从 $(\\mathbf{b}_1,\\mathbf{b}_2)$ 开始，重复执行：\n  - 如果 $\\|\\mathbf{b}_2\\|  \\|\\mathbf{b}_1\\|$，则交换它们。\n  - 设置 $\\mu = \\left\\lfloor \\frac{\\langle \\mathbf{b}_1, \\mathbf{b}_2 \\rangle}{\\|\\mathbf{b}_1\\|^2} \\right\\rceil$（最近整数），并用 $\\mathbf{b}_2 \\leftarrow \\mathbf{b}_2 - \\mu \\mathbf{b}_1$ 替换 $\\mathbf{b}_2$。\n  - 当 $|\\langle \\mathbf{b}_1, \\mathbf{b}_2 \\rangle| \\le \\frac{1}{2} \\|\\mathbf{b}_1\\|^2$ 且 $\\|\\mathbf{b}_1\\| \\le \\|\\mathbf{b}_2\\|$ 时终止。\n- 最终得到的第一个基向量是二维格中的一个最短非零向量。根据上面的 Minkowski 论证，其平方范数严格小于 $2p$，因此它能得到 $x^2 + y^2 = p$。\n\n第 5 步：规范化。\n- 为使输出唯一，通过改变符号并在需要时交换坐标来变换 $(x,y)$，以使得 $x \\ge 0$，$y \\ge 0$ 且 $x \\le y$。\n\n算法总结（结合原理与计算）：\n- 对 $n \\equiv -1 \\pmod{p}$ 使用 Tonelli–Shanks 算法找到满足 $a^2 \\equiv -1 \\pmod{p}$ 的 $a$。\n- 构造格基 $\\mathbf{b}_1 = (a,1)$，$\\mathbf{b}_2 = (p,0)$。\n- 应用 Gauss 归约获得 $\\Lambda$ 中的一个最短非零向量 $(x,y)$。\n- 根据模性质和 Minkowski 界，验证 $x^2 + y^2 = p$。\n- 将 $(x,y)$ 规范化为非负、有序形式。\n\n正确性证明：\n- $a$ 的存在性由 $p \\equiv 1 \\pmod{4}$ 和 Euler 判别法得出；Tonelli–Shanks 算法可以在关于 $\\log p$ 的多项式时间内计算出它。\n- 格 $\\Lambda$ 的余体积为 $p$；根据 Minkowski 定理，存在一个平方范数小于 $2p$ 的非零点。\n- 对于这样的 $(x,y)$，$x^2 + y^2$ 是 $p$ 的一个小于 $2p$ 的正倍数，因此等于 $p$。\n- Gauss 归约在二维空间中能找到最短向量，因此它能找到一个达到严格界的向量。\n\n测试集与输出：\n- 将算法应用于 $p \\in \\{5, 13, 29, 37, 97, 101\\}$。\n- 输出一个单行字符串，该字符串是一个 Python 列表，其中包含数对 $[x,y]$（满足 $x \\ge 0$，$y \\ge 0$，$x \\le y$），顺序与所列素数相同。", "answer": "[[1, 2], [2, 3], [2, 5], [1, 6], [4, 9], [1, 10]]", "id": "3081159"}]}