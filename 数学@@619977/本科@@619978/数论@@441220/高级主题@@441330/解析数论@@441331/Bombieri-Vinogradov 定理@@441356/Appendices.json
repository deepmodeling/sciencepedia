{"hands_on_practices": [{"introduction": "要想真正掌握数论中的概念，从抽象定义转向具体计算往往很有帮助。本练习要求您针对具体且可管理的数值，计算切比雪夫函数 $\\psi(x;q,a)$，并区分来自素数幂的贡献。通过这种直接计算，您将对该函数的行为有一个切实的理解，并看到它与其期望值之间的关系，从而以一种动手实践的方式阐明庞巴迪-维诺格拉多夫定理背后的核心思想。[@problem_id:3090386]", "problem": "令 $\\Lambda(n)$ 表示冯·曼戈尔特函数，对于整数 $q \\geq 1$ 和 $(a,q)=1$，定义等差数列切比雪夫函数\n$$\n\\psi(x;q,a) \\;=\\; \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\,(\\mathrm{mod}\\, q)}} \\Lambda(n).\n$$\n令 $\\chi$ 为模4的狄利克雷特征，并定义\n$$\n\\psi(x,\\chi) \\;=\\; \\sum_{n \\leq x} \\Lambda(n)\\,\\chi(n).\n$$\n你可以利用模4的狄利克雷特征的正交性，将 $\\psi(x;4,a)$ 写成 $\\psi(x,\\chi)$ 关于模4的特征 $\\chi$ 的线性组合。使用模4的两个特征：主特征 $\\chi_{0}$ 和非主特征 $\\chi_{4}$，其中对于偶数 $n$，$\\chi_{4}(n)=0$，$\\chi_{4}(1)=1$，以及 $\\chi_{4}(3)=-1$。\n\n从这些定义以及根据素数幂模4的余数进行的分类出发，推导 $\\psi(1000;4,1)$ 和 $\\psi(1000;4,3)$ 的显式闭式表达式，表达式应以素数自然对数的有限和形式给出，并通过计算所有来自素数幂 $p^{k} \\leq 1000$ 的重数来进行尽可能的简化。特别地，定义\n$$\n\\vartheta(x;4,a) \\;=\\; \\sum_{\\substack{p \\leq x \\\\ p \\equiv a \\,(\\mathrm{mod}\\, 4)}} \\ln p\n$$\n来表示一次幂（素数）的贡献，并通过分离出 $\\vartheta(1000;4,1)$ 和 $\\vartheta(1000;4,3)$ 并加上来自更高次素数幂的显式有限修正项来表达你的最终答案。\n\n然后，简要解释你的结果如何说明由庞巴迪-维诺格拉多夫定理（BVT）所启示的直观推断，即对于 $a \\in \\{1,3\\}$，$\\psi(x;4,a)$ 应接近 $x/\\varphi(4)$，其中 $\\varphi$ 表示欧拉总计函数。不需要进行数值近似。以 $\\big[\\psi(1000;4,1)\\;\\;\\psi(1000;4,3)\\big]$ 两个条目的形式返回你的最终结果。你的最终答案必须是单一的、无单位的闭式解析表达式。", "solution": "该问题要求给出 $\\psi(1000;4,1)$ 和 $\\psi(1000;4,3)$ 的显式闭式表达式，并定性解释这些结果如何与庞巴迪-维诺格拉多夫定理相关联。\n\n首先，我们验证问题的有效性。\n\n### 第1步：提取已知条件\n- $\\Lambda(n)$: 冯·曼戈尔特函数。\n- $\\psi(x;q,a) = \\sum_{n \\leq x, n \\equiv a \\,(\\mathrm{mod}\\, q)} \\Lambda(n)$，对于整数 $q \\geq 1$ 和 $(a,q)=1$。\n- $\\psi(x,\\chi) = \\sum_{n \\leq x} \\Lambda(n)\\,\\chi(n)$，对于一个狄利克雷特征 $\\chi$。\n- 问题涉及模 $q=4$ 以及特征 $\\chi_0$（主特征）和 $\\chi_4$（非主特征，满足 $\\chi_4(1)=1$，$\\chi_4(3)=-1$）。\n- 题目建议使用特征正交性将 $\\psi(x;4,a)$ 表示为 $\\psi(x,\\chi)$ 的线性组合。\n- 任务是推导 $\\psi(1000;4,1)$ 和 $\\psi(1000;4,3)$ 的显式表达式。\n- $\\vartheta(x;4,a) = \\sum_{p \\leq x, p \\equiv a \\,(\\mathrm{mod}\\, 4)} \\ln p$。$\\psi$ 的最终表达式应分离出这些 $\\vartheta$ 项。\n- 任务包括简要解释其与庞巴迪-维诺格拉多夫定理启示的直观推断的联系，即 $\\psi(x;4,a) \\approx x/\\varphi(4)$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在标准的解析数论中有科学依据。所有定义（$\\Lambda(n)$、$\\psi(x;q,a)$、狄利克雷特征）都是标准的。任务是适定的、客观的、自洽的，要求推导特定的数学表达式。它不违反任何基本原理，没有歧义，并且代表了该领域一个标准的、非平凡的计算。\n\n### 第3步：结论和行动\n问题有效。我们继续进行求解。\n\n函数 $\\psi(x;q,a)$ 定义为冯·曼戈尔特函数 $\\Lambda(n)$ 在一个等差数列上的和。冯·曼戈尔特函数的定义为：如果 $n = p^k$（其中 $p$ 为素数，整数 $k \\geq 1$），则 $\\Lambda(n) = \\ln p$，否则 $\\Lambda(n) = 0$。\n我们关心的是 $q=4$ 和 $a \\in \\{1, 3\\}$ 的情况。我们需要计算：\n$$\n\\psi(x;4,a) = \\sum_{\\substack{p^k \\leq x \\\\ p^k \\equiv a \\,(\\mathrm{mod}\\, 4)}} \\ln p\n$$\n当 $x=1000$ 时。问题要求将来自素数（$k=1$）的贡献与来自更高次素数幂（$k \\ge 2$）的贡献分开。素数的贡献由函数 $\\vartheta(x;4,a)$ 给出。因此我们写作：\n$$\n\\psi(x;4,a) = \\vartheta(x;4,a) + \\sum_{\\substack{p^k \\leq x, k \\geq 2 \\\\ p^k \\equiv a \\,(\\mathrm{mod}\\, 4)}} \\ln p\n$$\n\n我们必须根据素数幂 $p^k$ 模4的余数对其进行分类。素数 $p=2$ 的幂为 $2^1=2$，$2^2=4 \\equiv 0$，并且对于 $k \\ge 2$ 有 $2^k \\equiv 0 \\pmod 4$。由于 $a \\in \\{1, 3\\}$，2的幂对求和没有贡献。我们只需要考虑奇素数 $p$。\n- 如果 $p \\equiv 1 \\pmod 4$，那么对于所有 $k \\geq 1$，$p^k \\equiv 1^k \\equiv 1 \\pmod 4$。\n- 如果 $p \\equiv 3 \\pmod 4$，那么 $p^k \\equiv (-1)^k \\pmod 4$。所以，如果 $k$ 是偶数，$p^k \\equiv 1 \\pmod 4$；如果 $k$ 是奇数，$p^k \\equiv 3 \\pmod 4$。\n\n#### $\\psi(1000;4,1)$ 的计算\n我们需要对所有满足 $p^k \\leq 1000$ 且 $p^k \\equiv 1 \\pmod 4$ 的项求和 $\\ln p$。\n$$\n\\psi(1000;4,1) = \\sum_{\\substack{p \\leq 1000 \\\\ p \\equiv 1 \\,(\\mathrm{mod}\\, 4)}} \\ln p + \\sum_{\\substack{p^k \\leq 1000, k \\geq 2 \\\\ p^k \\equiv 1 \\,(\\mathrm{mod}\\, 4)}} \\ln p\n$$\n第一项是 $\\vartheta(1000;4,1)$。第二项是来自更高次幂的修正。我们通过对素数 $p$ 求和来计算这个修正项。我们只需要检查满足 $p^2 \\leq 1000$ 的素数 $p$，即 $p \\leq \\sqrt{1000} \\approx 31.6$。\n\n1.  对于素数 $p \\equiv 1 \\pmod 4$ (例如 $5, 13, 17, 29, \\dots$)：对于所有 $k \\geq 2$，$p^k \\equiv 1 \\pmod 4$。\n    -   $p=5$：$5^2=25$，$5^3=125$，$5^4=625$。$5^5=3125  1000$。幂次 $k=2,3,4$ 有贡献。总计：$3\\ln 5$。\n    -   $p=13$：$13^2=169$。$13^3=2197  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 13$。\n    -   $p=17$：$17^2=289$。$17^3=4913  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 17$。\n    -   $p=29$：$29^2=841$。$29^3  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 29$。\n    -   下一个满足 $p \\equiv 1 \\pmod 4$ 的素数是 $37$，而 $37^2  1000$。\n\n2.  对于素数 $p \\equiv 3 \\pmod 4$ (例如 $3, 7, 11, 19, \\dots$)：仅当 $k \\geq 2$ 为偶数时，$p^k \\equiv 1 \\pmod 4$。\n    -   $p=3$：我们需要偶数次幂。$3^2=9$，$3^4=81$，$3^6=729$。$3^8  1000$。幂次 $k=2,4,6$ 有贡献。总计：$3\\ln 3$。\n    -   $p=7$：$7^2=49$。$7^4=2401  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 7$。\n    -   $p=11$：$11^2=121$。$11^4  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 11$。\n    -   $p=19$：$19^2=361$。$19^4  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 19$。\n    -   $p=23$：$23^2=529$。$23^4  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 23$。\n    -   $p=31$：$31^2=961$。$31^4  1000$。幂次 $k=2$ 有贡献。总计：$\\ln 31$。\n    -   下一个满足 $p \\equiv 3 \\pmod 4$ 的素数是 $43$，而 $43^2>1000$。\n\n将所有这些来自更高次幂的贡献相加：\n$C_1 = 3\\ln 3 + 3\\ln 5 + \\ln 7 + \\ln 11 + \\ln 13 + \\ln 17 + \\ln 19 + \\ln 23 + \\ln 29 + \\ln 31$。\n因此，$\\psi(1000;4,1)$ 的表达式为：\n$$\n\\psi(1000;4,1) = \\vartheta(1000;4,1) + 3\\ln 3 + 3\\ln 5 + \\ln 7 + \\ln 11 + \\ln 13 + \\ln 17 + \\ln 19 + \\ln 23 + \\ln 29 + \\ln 31\n$$\n\n#### $\\psi(1000;4,3)$ 的计算\n我们需要对所有满足 $p^k \\leq 1000$ 且 $p^k \\equiv 3 \\pmod 4$ 的项求和 $\\ln p$。这要求 $p \\equiv 3 \\pmod 4$ 且 $k$ 为奇数。\n$$\n\\psi(1000;4,3) = \\sum_{\\substack{p^k \\leq 1000 \\\\ p \\equiv 3 \\,(\\mathrm{mod}\\, 4) \\\\ k \\text{ is odd}}} \\ln p = \\vartheta(1000;4,3) + \\sum_{\\substack{p^k \\leq 1000, k \\geq 3, k \\text{ odd} \\\\ p \\equiv 3 \\,(\\mathrm{mod}\\, 4)}} \\ln p\n$$\n第一项对应 $k=1$。我们计算来自更高奇次幂（$k=3, 5, \\dots$）的修正。\n-   $k=3$：我们需要 $p^3 \\leq 1000$ 且 $p \\equiv 3 \\pmod 4$。这意味着 $p \\leq \\sqrt[3]{1000}=10$。满足此条件的素数是 $p=3$ 和 $p=7$。贡献：$\\ln 3 + \\ln 7$。\n-   $k=5$：我们需要 $p^5 \\leq 1000$ 且 $p \\equiv 3 \\pmod 4$。这意味着 $p \\leq \\sqrt[5]{1000} \\approx 3.98$。唯一的素数是 $p=3$。贡献：$\\ln 3$。\n-   $k=7$：我们需要 $p^7 \\leq 1000$ 且 $p \\equiv 3 \\pmod 4$。这意味着 $p \\leq \\sqrt[7]{1000} \\approx 2.8$。没有奇素数满足此条件。\n\n来自更高次幂的总修正为 $C_3 = (\\ln 3 + \\ln 7) + \\ln 3 = 2\\ln 3 + \\ln 7$。\n因此，$\\psi(1000;4,3)$ 的表达式为：\n$$\n\\psi(1000;4,3) = \\vartheta(1000;4,3) + 2\\ln 3 + \\ln 7\n$$\n\n#### 与庞巴迪-维诺格拉多夫定理的联系\n庞巴迪-维诺格拉多夫定理对等差数列中的素数定理的误差项的平均大小给出了一个强有力的陈述。相关的直观推断是，对于固定的模 $q$ 和 $(a,q)=1$，$\\psi(x;q,a)$ 可以很好地由其期望值 $x/\\varphi(q)$ 来近似。在我们的例子中，$x=1000$ 且 $q=4$，因此 $\\varphi(4)=2$。该直观推断表明 $\\psi(1000;4,1) \\approx 1000/2 = 500$ 且 $\\psi(1000;4,3) \\approx 1000/2 = 500$。\n\n我们推导的表达式通过狄利克雷特征理论说明了这一点。利用特征正交性，可以证明：\n$$\n\\psi(x;4,1) = \\frac{1}{2}\\left(\\psi(x,\\chi_0) + \\psi(x,\\chi_4)\\right)\n$$\n$$\n\\psi(x;4,3) = \\frac{1}{2}\\left(\\psi(x,\\chi_0) - \\psi(x,\\chi_4)\\right)\n$$\n此处，$\\psi(x,\\chi_0) = \\sum_{n \\leq x, (n,4)=1} \\Lambda(n) = \\psi(x) - \\sum_{k \\geq 1, 2^k \\leq x} \\ln 2$。素数定理意味着 $\\psi(x) \\sim x$，因此 $\\psi(x,\\chi_0) \\sim x$。这是主导项。\n项 $\\psi(x,\\chi_4) = \\sum_{n \\leq x} \\Lambda(n)\\chi_4(n)$ 涉及非主特征 $\\chi_4$。解析数论的一个基石性结果是，对于任何非主特征 $\\chi$，都有 $\\psi(x,\\chi) = o(x)$。这意味着 $\\psi(x,\\chi_4)$ 的增长速度比 $x$ 慢。\n\n将这些渐近式代入 $\\psi(x;4,a)$ 的表达式中：\n$$\n\\psi(x;4,1) \\approx \\frac{1}{2}(x + o(x)) \\approx \\frac{x}{2}\n$$\n$$\n\\psi(x;4,3) \\approx \\frac{1}{2}(x - o(x)) \\approx \\frac{x}{2}\n$$\n两个量都渐近等于 $x/2 = x/\\varphi(4)$，这正是庞巴迪-维诺格拉多夫定理所启示的直观推断。我们的详细计算显示了当 $x=1000$ 时这些函数的精确构成，其中主项 $\\vartheta(x;q,a)$ 预计大小相近，而修正项相对较小。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\vartheta(1000;4,1) + 3\\ln 3 + 3\\ln 5 + \\ln 7 + \\ln 11 + \\ln 13 + \\ln 17 + \\ln 19 + \\ln 23 + \\ln 29 + \\ln 31 \\\\ \\vartheta(1000;4,3) + 2\\ln 3 + \\ln 7 \\end{pmatrix}}\n$$", "id": "3090386"}, {"introduction": "庞巴迪-维诺格拉多夫定理对算术级数中素数定理的平均误差大小给出了一个强有力的陈述。这个问题将焦点从具体计算转移到定理的一般性陈述上。通过处理总误差的形式化定义和定理的界限，您将巩固对该定理所保证内容的理解，并探索误差估计的强度与它所适用的模数范围之间的关键权衡。[@problem_id:3090400]", "problem": "设 $x \\ge 3$ 为一个实参数，并设 $A \\ge 1$ 为一个固定的常数。对于整数模 $q \\ge 1$ 和满足 $(a,q)=1$ 的剩余类 $a$，定义算术级数中的广义切比雪夫函数为\n$$\n\\psi(x;q,a) \\coloneqq \\sum_{\\substack{n \\le x \\\\ n \\equiv a \\; (\\bmod \\; q)}} \\Lambda(n),\n$$\n其中 $\\Lambda(n)$ 是冯·曼戈尔特函数，$\\phi(q)$ 是欧拉总计函数。考虑偏差\n$$\n\\Delta(x;q,a) \\coloneqq \\psi(x;q,a) - \\frac{x}{\\phi(q)}.\n$$\n定义模数至 $Q$ 的总偏差为\n$$\nS(x,Q) \\coloneqq \\sum_{q \\le Q} \\max_{(a,q)=1} \\left| \\Delta(x;q,a) \\right|.\n$$\n在无条件（不使用任何未证明的假设）下，仅使用解析数论中的基本定义和经过充分检验的结果，确定可以为 $S(x,Q)$ 保证的最紧的量级上界，该上界仅依赖于 $x$ 和 $A$，条件是 $Q$ 位于与庞巴迪-维诺格拉多夫定理（BVT）相关的容许范围内，即 $Q \\le x^{1/2} (\\ln x)^{-B}$，其中某个 $B=B(A)0$ 独立于 $x$ 和 $Q$。你最终报告的上界必须是仅包含 $x$ 和 $A$ 的单个闭式解析表达式（表达式中不得出现未指定的参数）。\n\n简要用文字解释在条件 $Q \\le x^{1/2} (\\ln x)^{-B(A)}$ 中，取更大的 $A$ 如何影响 $Q$ 的容许大小。你最终的数值报告必须是 $S(x,Q)$ 上界的单个解析表达式，不带单位。不要对你的答案进行四舍五入。", "solution": "**问题验证**\n\n**步骤1：提取给定信息**\n问题提供了以下定义和条件：\n- 实参数 $x \\ge 3$。\n- 固定常数 $A \\ge 1$。\n- 整数模 $q \\ge 1$。\n- 满足 $\\gcd(a,q)=1$ 的剩余类 $a$。\n- 冯·曼戈尔特函数 $\\Lambda(n)$。\n- 欧拉总计函数 $\\phi(q)$。\n- 算术级数中的广义切比雪夫函数：$\\psi(x;q,a) \\coloneqq \\sum_{\\substack{n \\le x \\\\ n \\equiv a \\; (\\bmod \\; q)}} \\Lambda(n)$。\n- 偏差项：$\\Delta(x;q,a) \\coloneqq \\psi(x;q,a) - \\frac{x}{\\phi(q)}$。\n- 总偏差：$S(x,Q) \\coloneqq \\sum_{q \\le Q} \\max_{(a,q)=1} \\left| \\Delta(x;q,a) \\right|$。\n- $Q$ 的范围：$Q \\le x^{1/2} (\\ln x)^{-B}$，其中某个 $B=B(A)0$。\n- 任务是找到 $S(x,Q)$ 的最紧无条件量级上界，表示为仅含 $x$ 和 $A$ 的闭式表达式。\n- 次要任务是解释选择 $A$ 与 $Q$ 的容许范围之间的关系。\n\n**步骤2：使用提取的信息进行验证**\n根据验证标准对问题进行评估：\n- **科学依据：** 该问题是解析数论中的一个标准课题。所有函数（$\\Lambda(n)$、$\\phi(q)$、$\\psi(x;q,a)$）和概念都是该领域的基础。问题围绕庞巴迪-维诺格拉多夫定理展开，这是一个基石性的、已获证明的结果。该问题在科学和数学上是合理的。\n- **适定性：** 该问题要求在指定约束条件下，为一个明确定义的数学量找到已知的最紧量级上界。正如庞巴迪-维诺格拉多夫定理所示，这样的上界是存在的，并且其函数形式是唯一的。\n- **客观性：** 问题使用精确、标准的数学符号和术语陈述。它没有歧义、主观性或观点。\n\n**步骤3：结论和行动**\n该问题在数学上是有效的、适定的，并直接涉及解析数论中的一个核心结果。没有发现任何缺陷。因此，我将继续进行解答。\n\n**解答推导**\n问题要求对量 $S(x,Q)$ 给出一个上界，其定义为：\n$$\nS(x,Q) \\coloneqq \\sum_{q \\le Q} \\max_{(a,q)=1} \\left| \\Delta(x;q,a) \\right|\n$$\n代入偏差 $\\Delta(x;q,a)$ 的定义，我们得到：\n$$\nS(x,Q) = \\sum_{q \\le Q} \\max_{(a,q)=1} \\left| \\psi(x;q,a) - \\frac{x}{\\phi(q)} \\right|\n$$\n这个表达式衡量了算术级数素数定理在模 $q \\le Q$ 上的平均误差。算术级数素数定理断言，对于固定的模 $q$，当 $x \\to \\infty$ 时，有 $\\psi(x;q,a) \\sim \\frac{x}{\\phi(q)}$。量 $S(x,Q)$ 提供了一个度量，衡量这个近似在模数最大到 $Q$ 的范围内平均有多好。\n\n问题要求一个无条件上界，这意味着它必须在不依赖于未证明的假设（如广义黎曼猜想，GRH）的情况下推导出来。对这类和式进行界定的最强大的无条件工具是庞巴迪-维诺格拉多夫定理。\n\n庞巴迪-维诺格拉多夫定理指出，对于任意给定的常数 $A  0$，存在一个常数 $B = B(A)  0$，使得如果 $Q \\le x^{1/2} (\\ln x)^{-B}$，则\n$$\n\\sum_{q \\le Q} \\max_{(a,q)=1} \\left| \\psi(x;q,a) - \\frac{x}{\\phi(q)} \\right| \\ll_A \\frac{x}{(\\ln x)^A}.\n$$\n符号 $f(x) \\ll_A g(x)$ 表示存在一个常数 $C$（可能依赖于 $A$），使得对于所有足够大的 $x$，都有 $|f(x)| \\le C g(x)$。\n\n问题指明 $Q$ 位于容许范围 $Q \\le x^{1/2} (\\ln x)^{-B}$ 内，其中某个 $B=B(A)0$。我们需要界定的量 $S(x,Q)$ 正是庞巴迪-维诺格拉多夫定理左侧的和式。因此，我们可以直接应用该定理。\n\n对于给定的固定常数 $A \\ge 1$，该定理保证：\n$$\nS(x,Q) \\ll_A \\frac{x}{(\\ln x)^A}\n$$\n问题要求“最紧的量级上界”。庞巴迪-维诺格拉多夫定理提供的上界确实是这类已知的最紧的无条件结果。“量级”指的是对 $x$ 和 $A$ 的函数依赖关系，即 $\\frac{x}{(\\ln x)^A}$。$\\ll_A$ 符号中隐含的常数依赖于 $A$，但不依赖于 $x$ 或 $Q$。因此，量级上界的解析表达式就是右侧的函数。\n\n关于次要问题：“简要用文字解释在条件 $Q \\le x^{1/2} (\\ln x)^{-B(A)}$ 中，取更大的 $A$ 如何影响 $Q$ 的容许大小。”\n\n庞巴迪-维诺格拉多夫定理建立了一种权衡关系。参数 $A$ 控制误差项上界的质量；更大的 $A$ 意味着更小的误差项 $\\frac{x}{(\\ln x)^A}$，这是一个更强或“更紧”的上界。$Q$ 的约束条件中的参数 $B(A)$ 是 $A$ 的一个增函数。该定理的证明表明，为了获得更强的上界（更大的 $A$），必须接受一个更大的 $B(A)$ 值。例如，该定理的一个常见的有效版本建立了诸如 $B(A) = 2A+5$ 的关系。\n\n当 $B(A)$ 增加时，对于 $x  e$，项 $(\\ln x)^{-B(A)}$ 会减小。这意味着模数范围的上限 $Q_{max} = x^{1/2} (\\ln x)^{-B(A)}$ 变小了。总之，要求对近似误差有更紧的上界（通过增加 $A$），会限制该定理的适用性，使其只能对更短的模数范围进行平均（通过减小 $Q$ 的最大允许值）。\n\n主要任务是报告 $S(x,Q)$ 上界的最终解析表达式。基于庞巴迪-维诺格拉多夫定理的直接应用，描述上界量级的函数就是这个。", "answer": "$$\\boxed{\\frac{x}{(\\ln(x))^{A}}}$$", "id": "3090400"}, {"introduction": "在解析数论中，研究结果通常是为加权的素数计数函数（如 $\\psi(x;q,a)$）证明的，因为它们具有更好的解析性质。然而，我们最终通常对素数本身的分布感兴趣，这由 $\\pi(x;q,a)$ 计数。这个进阶练习将指导您使用阿贝尔求和（分部求和）这一基本技巧，将一个关于 $\\psi(x;q,a)$ 的误差界限转移到 $\\pi(x;q,a)$ 上，从而展示了一个将强大定理更广泛应用的基础工具。[@problem_id:3090431]", "problem": "设 $q \\in \\mathbb{Z}_{\\ge 1}$，$a \\in \\mathbb{Z}$ 且 $(a,q)=1$，定义算术级数计数函数如下：\n- $\\pi(x;q,a)$ 为素数 $p \\le x$ 且满足 $p \\equiv a \\pmod{q}$ 的个数，\n- $\\psi(x;q,a) := \\sum_{\\substack{n \\le x \\\\ n \\equiv a \\!\\!\\!\\pmod{q}}} \\Lambda(n)$，其中 $\\Lambda(n)$ 是冯·曼戈尔特函数，\n- $\\theta(x;q,a) := \\sum_{\\substack{p \\le x \\\\ p \\equiv a \\!\\!\\!\\pmod{q}}} \\ln p$，\n以及主项：\n- $\\varphi(q)$ 是欧拉总计函数，\n- $\\operatorname{li}(x) := \\int_{2}^{x} \\frac{dt}{\\ln t}$ 是对数积分函数。\n\n假设以下庞巴迪-维诺格拉多夫型假设成立：对任意固定的 $A0$，存在常数 $B=B(A)0$，$C=C(A)0$ 和 $x_{0}=x_{0}(A)$，使得对所有 $x \\ge x_{0}$，所有满足 $Q \\le x^{1/2}/(\\ln x)^{B}$ 的 $Q$，以及所有满足 $2 \\le t \\le x$ 的 $t$，都有\n$$\n\\sum_{q \\le Q} \\max_{\\substack{(a,q)=1}} \\left| \\psi(t;q,a) - \\frac{t}{\\varphi(q)} \\right| \\le C \\,\\frac{t}{(\\ln t)^{A}}.\n$$\n\n仅从上述假设、$\\pi(x;q,a)$、$\\psi(x;q,a)$ 和 $\\theta(x;q,a)$ 的定义以及阿贝尔（分部）求和原理出发，推导出一个形如\n$$\n\\sum_{q \\le Q} \\max_{\\substack{(a,q)=1}} \\left| \\pi(x;q,a) - \\frac{\\operatorname{li}(x)}{\\varphi(q)} \\right| \\ll \\frac{x}{(\\ln x)^{\\alpha}},\n$$\n的平均界，该界对所有 $x \\ge x_{0}(A)$ 和所有满足 $Q \\le x^{1/2}/(\\ln x)^{B'(A)}$（其中某个 $B'(A)0$）的 $Q$ 均成立，此处的隐含常数可以依赖于 $A$。请以最简闭形式确定得到的指数 $\\alpha$（用 $A$ 表示）。\n\n你的最终答案必须是仅用 $A$ 表示 $\\alpha$ 的表达式。无需数值取整，也不涉及单位。仅将 $\\alpha$ 的值表示为关于 $A$ 的简化解析表达式。", "solution": "用户希望从一个关于 Chebyshev 函数 $\\psi(x;q,a)$ 平均误差的给定假设出发，为算术级数中的素数计数函数 $\\pi(x;q,a)$ 推导出一个平均误差界。\n\n此问题将通过以下三个主要步骤解决：\n1.  **问题验证**：确认问题陈述是自洽的、数学上合理的且适定的。\n2.  **关联 $\\psi$ 与 $\\theta$**：证明 $\\psi(x;q,a)$ 的误差界可以转移到 $\\theta(x;q,a)$，同时考虑素数幂的贡献。\n3.  **关联 $\\theta$ 与 $\\pi$**：使用阿贝尔求和原理，从为 $\\theta(x;q,a)$ 建立的误差界推导出 $\\pi(x;q,a)$ 的误差界。\n\n### 第 1 步：问题验证\n\n该问题是解析数论中的一个理论推导。\n-   **已知条件**：$\\pi(x;q,a)$、$\\psi(x;q,a)$、$\\theta(x;q,a)$、$\\varphi(q)$ 和 $\\operatorname{li}(x)$ 的所有定义都是标准的。该假设是庞巴迪-维诺格拉多夫定理的一个定义明确的强形式，且陈述为对 $t \\in [2,x]$ 一致成立。所用工具仅限于该假设、相关定义和阿贝尔求和法。\n-   **科学依据**：问题完全属于纯粹数学范畴，并且涉及数论中的标准对象和定理。它在科学上和事实上都是合理的。\n-   **适定性**：目标是确定指数 $\\alpha$（用 $A$ 表示）。从 $\\psi$ 到 $\\theta$ 再到 $\\pi$ 的推导路径是一个标准程序，表明可以获得一个唯一且有意义的解。\n-   **客观性**：问题以精确的数学语言陈述，没有歧义或主观论断。\n\n问题被认为是**有效的**。我们可以继续进行求解。\n\n### 第 2 步：$\\psi(x;q,a)$ 与 $\\theta(x;q,a)$ 之间的关系\n\nChebyshev 函数 $\\psi(x;q,a)$ 定义为 $\\sum_{n \\le x, n \\equiv a \\pmod{q}} \\Lambda(n)$，其中 $\\Lambda(n)$ 是冯·曼戈尔特函数。函数 $\\Lambda(n)$ 的值为 $\\ln p$，如果 $n=p^k$ (其中 $p$ 为素数，整数 $k \\ge 1$)，否则为 $0$。\n我们可以根据幂次 $k$ 将定义 $\\psi(x;q,a)$ 的和式分解：\n$$\n\\psi(x;q,a) = \\sum_{\\substack{p \\le x \\\\ p \\equiv a \\pmod{q}}} \\ln p + \\sum_{k=2}^{\\infty} \\sum_{\\substack{p^k \\le x \\\\ p^k \\equiv a \\pmod{q}}} \\ln p\n$$\n根据定义，第一项是 $\\theta(x;q,a)$。因此，我们有以下关系：\n$$\n\\psi(x;q,a) - \\theta(x;q,a) = \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} \\sum_{\\substack{p \\le x^{1/k} \\\\ p^k \\equiv a \\pmod{q}}} \\ln p\n$$\n我们可以通过去掉同余条件来界定这个差的大小：\n$$\n|\\psi(x;q,a) - \\theta(x;q,a)| \\le \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} \\sum_{p \\le x^{1/k}} \\ln p = \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} \\theta(x^{1/k})\n$$\n使用标准界 $\\theta(y) = O(y)$，该和式主要由 $k=2$ 的项决定：\n$$\n|\\psi(x;q,a) - \\theta(x;q,a)| = \\theta(x^{1/2}) + \\theta(x^{1/3}) + \\dots = O(x^{1/2})\n$$\n令 $E_\\psi(t;q,a) = \\psi(t;q,a) - \\frac{t}{\\varphi(q)}$ 及 $E_\\theta(t;q,a) = \\theta(t;q,a) - \\frac{t}{\\varphi(q)}$。\n则 $E_\\theta(t;q,a) = E_\\psi(t;q,a) - (\\psi(t;q,a) - \\theta(t;q,a))$。\n令 $S_\\psi(t, Q) = \\sum_{q \\le Q} \\max_{(a,q)=1} |E_\\psi(t;q,a)|$ 及 $S_\\theta(t,Q) = \\sum_{q \\le Q} \\max_{(a,q)=1} |E_\\theta(t;q,a)|$。\n使用三角不等式：\n$$\nS_\\theta(t,Q) \\le S_\\psi(t,Q) + \\sum_{q \\le Q} \\max_{(a,q)=1} |\\psi(t;q,a) - \\theta(t;q,a)|\n$$\n使用我们的逐点界 $|\\psi(t;q,a) - \\theta(t;q,a)| = O(t^{1/2})$，第二项的界为 $\\sum_{q \\le Q} O(t^{1/2}) = O(Q t^{1/2})$。\n给定假设表明，对于固定的 $A0$，存在 $B=B(A)0$，使得对于 $Q \\le x^{1/2}/(\\ln x)^B$ 和所有 $t \\in [2,x]$，$S_\\psi(t,Q) \\ll t/(\\ln t)^A$。在此及全文中，隐含的常数可能依赖于 $A$。\n因此，对于 $t \\in [2,x]$ 和指定范围内的 $Q$，我们有：\n$$\nS_\\theta(t,Q) \\ll \\frac{t}{(\\ln t)^A} + Q t^{1/2}\n$$\n\n### 第 3 步：$\\theta(x;q,a)$ 与 $\\pi(x;q,a)$ 之间的关系\n\n我们使用阿贝尔求和原理来关联 $\\pi(x;q,a) = \\sum_{p\\le x, p \\equiv a} 1$ 和 $\\theta(x;q,a) = \\sum_{p\\le x, p \\equiv a} \\ln p$。\n我们可以写出 $\\pi(x;q,a) = \\sum_{n \\le x, n \\text{ prime}, n\\equiv a} \\frac{\\ln n}{\\ln n}$。\n对项为 $\\ln n$（对于级数中的素数）否则为 0 的序列，以及函数 $f(t)=1/\\ln t$ 应用阿贝尔求和法：\n$$\n\\pi(x;q,a) = \\frac{\\theta(x;q,a)}{\\ln x} - \\int_2^x \\theta(t;q,a) \\left(\\frac{d}{dt} \\frac{1}{\\ln t}\\right) dt = \\frac{\\theta(x;q,a)}{\\ln x} + \\int_2^x \\frac{\\theta(t;q,a)}{t(\\ln t)^2} dt\n$$\n我们关心 $\\pi(x;q,a)$ 相对于其主项 $\\frac{\\operatorname{li}(x)}{\\varphi(q)}$ 的误差项。\n$$\n\\pi(x;q,a) - \\frac{\\operatorname{li}(x)}{\\varphi(q)} = \\frac{1}{\\ln x}\\left(\\frac{x}{\\varphi(q)} + E_\\theta(x;q,a)\\right) + \\int_2^x \\frac{t/\\varphi(q) + E_\\theta(t;q,a)}{t(\\ln t)^2} dt - \\frac{\\operatorname{li}(x)}{\\varphi(q)}\n$$\n将主项组合在一起：\n$$\n\\frac{1}{\\varphi(q)} \\left( \\frac{x}{\\ln x} + \\int_2^x \\frac{dt}{(\\ln t)^2} \\right) - \\frac{\\operatorname{li}(x)}{\\varphi(q)}\n$$\n对 $\\operatorname{li}(x)=\\int_2^x \\frac{dt}{\\ln t}$ 使用分部积分法得到 $\\operatorname{li}(x) = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} + \\int_2^x \\frac{dt}{(\\ln t)^2}$。\n因此，主项合并为 $-\\frac{2}{\\varphi(q)\\ln 2}$，这是一个 $O(1/\\varphi(q))$ 阶的项。\n因此误差由下式给出：\n$$\n\\pi(x;q,a) - \\frac{\\operatorname{li}(x)}{\\varphi(q)} = \\frac{E_\\theta(x;q,a)}{\\ln x} + \\int_2^x \\frac{E_\\theta(t;q,a)}{t(\\ln t)^2} dt + O\\left(\\frac{1}{\\varphi(q)}\\right)\n$$\n现在，我们对 $q \\le Q$ 求和，并对 $a$ 取最大值：\n$$\n\\sum_{q \\le Q} \\max_{(a,q)=1} \\left| \\pi(x;q,a) - \\frac{\\operatorname{li}(x)}{\\varphi(q)} \\right| \\le \\frac{S_\\theta(x,Q)}{\\ln x} + \\int_2^x \\frac{S_\\theta(t,Q)}{t(\\ln t)^2} dt + \\sum_{q \\le Q} O\\left(\\frac{1}{q^{1-\\epsilon}}\\right)\n$$\n最后一项是可忽略的，为 $O(Q^\\epsilon \\ln Q)$。让我们分析前两项。我们需要推导一个对 $Q \\le x^{1/2}/(\\ln x)^{B'(A)}$ 成立的形如 $\\ll x/(\\ln x)^\\alpha$ 的界。为了使用该假设，我们选择的 $B'$ 必须满足 $B' \\ge B(A)$。\n\n1.  **项 $\\frac{S_\\theta(x,Q)}{\\ln x}$**：\n    使用我们对 $S_\\theta(x,Q)$ 的界：\n    $$\n    \\frac{S_\\theta(x,Q)}{\\ln x} \\ll \\frac{1}{\\ln x} \\left(\\frac{x}{(\\ln x)^A} + Q x^{1/2}\\right) = \\frac{x}{(\\ln x)^{A+1}} + \\frac{Q x^{1/2}}{\\ln x}\n    $$\n2.  **积分项 $\\int_2^x \\frac{S_\\theta(t,Q)}{t(\\ln t)^2} dt$**：\n    我们分解积分并代入 $S_\\theta(t,Q)$ 的界。\n    $$\n    \\int_2^x \\frac{S_\\theta(t,Q)}{t(\\ln t)^2} dt \\ll \\int_2^x \\frac{t/(\\ln t)^A + Q t^{1/2}}{t(\\ln t)^2} dt = \\int_2^x \\frac{dt}{(\\ln t)^{A+2}} + Q \\int_2^x \\frac{dt}{t^{1/2}(\\ln t)^2}\n    $$\n    第一个积分是 $O(x/(\\ln x)^{A+2})$。第二个是 $O(x^{1/2}/(\\ln x)^2)$。所以，这部分贡献了 $O(x/(\\ln x)^{A+2} + Q x^{1/2}/(\\ln x)^2)$。\n\n合并所有项，总误差主要由以下各项决定：\n$$\n\\sum_{q \\le Q} \\max_a |\\dots| \\ll \\frac{x}{(\\ln x)^{A+1}} + \\frac{Q x^{1/2}}{\\ln x}\n$$\n现在我们使用关于 $Q$ 的条件。我们正在为 $\\pi$ 推导一个新定理，它在一个范围 $Q \\le x^{1/2}/(\\ln x)^{B'}$ 内成立。如前所述，为使推导有效，我们必须选择 $B' \\ge B(A)$。让我们做出这样的选择。第二项变为：\n$$\n\\frac{Q x^{1/2}}{\\ln x} \\le \\frac{x^{1/2}}{(\\ln x)^{B'}} \\frac{x^{1/2}}{\\ln x} = \\frac{x}{(\\ln x)^{B'+1}}\n$$\n所以总误差的界为：\n$$\n\\ll \\frac{x}{(\\ln x)^{A+1}} + \\frac{x}{(\\ln x)^{B'+1}} \\ll \\frac{x}{(\\ln x)^{\\min(A+1, B'+1)}}\n$$\n得到的指数是 $\\alpha = \\min(A+1, B'+1)$。问题要求仅用 $A$ 表示 $\\alpha$。在约束 $B' \\ge B(A)$ 下，我们可以为我们的新定理自由选择参数 $B'$。让我们选择 $B'(A) = \\max(A, B(A))$。这个选择满足 $B' \\ge B(A)$。在此选择下，指数变为：\n$$\n\\alpha = \\min(A+1, \\max(A, B(A))+1)\n$$\n我们考虑两种情况：\n-   情况 1：$B(A) \\le A$。那么 $\\max(A, B(A)) = A$，且 $\\alpha = \\min(A+1, A+1) = A+1$。\n-   情况 2：$B(A)  A$。那么 $\\max(A, B(A)) = B(A)$，且 $\\alpha = \\min(A+1, B(A)+1) = A+1$。\n\n在两种情况下，我们都发现得到的指数是 $\\alpha = A+1$。这个结果对 $Q \\le x^{1/2}/(\\ln x)^{B'(A)}$ 成立，其中 $B'(A) = \\max(A, B(A))$。\n\n因此，该指数仅由 $A$ 确定。", "answer": "$$\\boxed{A+1}$$", "id": "3090431"}]}