{"hands_on_practices": [{"introduction": "素数定理最精确的形式与对数积分函数 $\\mathrm{Li}(x)$ 密切相关。然而，在许多讨论中，人们会使用更简洁的近似式 $\\frac{x}{\\ln x}$。本练习将通过分部积分法，从第一性原理出发，揭示这两种表达方式之间的联系。你将亲自推导出 $\\frac{x}{\\ln x}$ 是 $\\mathrm{Li}(x)$ 渐近展开的首项，并学习如何计算后续的修正项，这项技能对于在解析数论中进行更精细的分析至关重要。[@problem_id:3092785]", "problem": "设 $x>2$，对数积分函数定义为反常积分\n$$\\mathrm{Li}(x)\\;=\\;\\int_{2}^{x}\\frac{dt}{\\ln t}.$$\n该函数在素数定理（PNT）的陈述中处于核心地位，该定理断言素数计数函数 $\\pi(x)$ 在 $x\\to\\infty$ 时渐近于 $\\mathrm{Li}(x)$。仅从 $\\mathrm{Li}(x)$ 的定义以及实分析和微积分的标准结果（包括黎曼积分、自然对数和分部积分法）出发，推导 $\\mathrm{Li}(x)$ 在 $x\\to\\infty$ 时的两项渐近展开式，并附带一个用兰道大O符号界定的余项。你的推导应从第一性原理证明余项的阶。\n\n将你的最终结果表示为一个包含 $x$、$\\ln x$ 和大O符号的单一解析表达式。不需要进行数值近似或舍入。最终答案必须是单个表达式，而非方程或不等式。", "solution": "本题要求推导对数积分函数 $\\mathrm{Li}(x)$ 的两项渐近展开式，该函数对 $x > 2$ 定义为：\n$$ \\mathrm{Li}(x) = \\int_{2}^{x} \\frac{dt}{\\ln t} $$\n推导必须从第一性原理出发，使用标准的微积分结果，主要是分部积分法。\n\n我们从 $\\mathrm{Li}(x)$ 的积分定义开始。为了找到其在 $x \\to \\infty$ 时的渐近行为，我们应用分部积分法，其公式为 $\\int u \\, dv = uv - \\int v \\, du$。我们对 $u$ 和 $dv$ 作如下选择：\n令 $u = \\frac{1}{\\ln t}$ 且 $dv = dt$。\n对 $u$ 求导，对 $dv$ 积分，我们得到：\n$du = \\frac{d}{dt} \\left( (\\ln t)^{-1} \\right) = -1 \\cdot (\\ln t)^{-2} \\cdot \\frac{1}{t} dt = -\\frac{dt}{t (\\ln t)^2}$。\n$v = \\int dt = t$。\n\n将此应用于 $\\mathrm{Li}(x)$ 的定积分：\n$$ \\mathrm{Li}(x) = \\left[ t \\cdot \\frac{1}{\\ln t} \\right]_{2}^{x} - \\int_{2}^{x} t \\left( -\\frac{1}{t (\\ln t)^2} \\right) dt $$\n计算边界项，我们得到：\n$$ \\left[ \\frac{t}{\\ln t} \\right]_{2}^{x} = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} $$\n积分部分简化为：\n$$ - \\int_{2}^{x} \\left( -\\frac{1}{(\\ln t)^2} \\right) dt = \\int_{2}^{x} \\frac{dt}{(\\ln t)^2} $$\n结合这些结果，得到我们展开式的第一步：\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} + \\int_{2}^{x} \\frac{dt}{(\\ln t)^2} $$\n项 $\\frac{x}{\\ln x}$ 是渐近展开式中的主项。项 $-\\frac{2}{\\ln 2}$ 是一个常数。积分 $\\int_{2}^{x} \\frac{dt}{(\\ln t)^2}$ 是一个余项，我们期望它的阶低于 $\\frac{x}{\\ln x}$。\n\n为了找到展开式的第二项，我们再次对余项积分应用分部积分法，记为 $I_1(x) = \\int_{2}^{x} \\frac{dt}{(\\ln t)^2}$。我们类似地选择分部：\n令 $u = \\frac{1}{(\\ln t)^2}$ 且 $dv = dt$。\n则 $du = -2(\\ln t)^{-3} \\cdot \\frac{1}{t} dt = -\\frac{2 dt}{t (\\ln t)^3}$ 且 $v = t$。\n对 $I_1(x)$ 应用分部积分法：\n$$ I_1(x) = \\left[ \\frac{t}{(\\ln t)^2} \\right]_{2}^{x} - \\int_{2}^{x} t \\left( -\\frac{2}{t (\\ln t)^3} \\right) dt $$\n$$ I_1(x) = \\frac{x}{(\\ln x)^2} - \\frac{2}{(\\ln 2)^2} + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3} $$\n现在，我们将 $I_1(x)$ 的这个表达式代回到我们关于 $\\mathrm{Li}(x)$ 的方程中：\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} + \\left( \\frac{x}{(\\ln x)^2} - \\frac{2}{(\\ln 2)^2} + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3} \\right) $$\n我们可以将各项分组以得到：\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} - C + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3} $$\n其中 $C = \\frac{2}{\\ln 2} + \\frac{2}{(\\ln 2)^2}$ 是一个常数。\n\n该表达式现在包含了展开式的前两项，$\\frac{x}{\\ln x}$ 和 $\\frac{x}{(\\ln x)^2}$。剩余部分是误差项，$E(x) = -C + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3}$。最后一步是使用兰道大O符号确定此项的渐近阶。\n\n常数 $-C$ 是 $O(1)$ 阶的。误差项的主要部分是积分 $R(x) = \\int_{2}^{x} \\frac{dt}{(\\ln t)^3}$。我们需要证明这个积分是 $O\\left(\\frac{x}{(\\ln x)^3}\\right)$ 阶的。为了严格地做到这一点，我们可以使用洛必达法则来计算当 $x \\to \\infty$ 时，$R(x)$ 与函数 $g(x) = \\frac{x}{(\\ln x)^3}$ 之比的极限。\n考虑极限：\n$$ L = \\lim_{x \\to \\infty} \\frac{R(x)}{g(x)} = \\lim_{x \\to \\infty} \\frac{\\int_{2}^{x} \\frac{dt}{(\\ln t)^3}}{x/(\\ln x)^3} $$\n该极限是 $\\frac{\\infty}{\\infty}$ 型的不定式。对于 $x > 2$，分子和分母都是 $x$ 的可微函数。因此，我们可以应用洛必达法则。\n根据微积分基本定理，分子的导数是：\n$$ \\frac{d}{dx} R(x) = \\frac{1}{(\\ln x)^3} $$\n分母的导数使用商法则求得：\n$$ \\frac{d}{dx} g(x) = \\frac{d}{dx} \\left( \\frac{x}{(\\ln x)^3} \\right) = \\frac{1 \\cdot (\\ln x)^3 - x \\cdot 3(\\ln x)^2 \\cdot (1/x)}{(\\ln x)^6} = \\frac{(\\ln x)^3 - 3(\\ln x)^2}{(\\ln x)^6} = \\frac{\\ln x - 3}{(\\ln x)^4} $$\n现在我们求导数之比的极限：\n$$ L = \\lim_{x \\to \\infty} \\frac{1/(\\ln x)^3}{(\\ln x - 3)/(\\ln x)^4} = \\lim_{x \\to \\infty} \\frac{(\\ln x)^4}{(\\ln x)^3 (\\ln x - 3)} = \\lim_{x \\to \\infty} \\frac{\\ln x}{\\ln x - 3} $$\n分子分母同除以 $\\ln x$：\n$$ L = \\lim_{x \\to \\infty} \\frac{1}{1 - 3/\\ln x} = \\frac{1}{1-0} = 1 $$\n由于极限 $L=1$ 存在且有限，我们证明了 $R(x) \\sim g(x)$，即 $\\int_{2}^{x} \\frac{dt}{(\\ln t)^3} \\sim \\frac{x}{(\\ln x)^3}$。根据渐近等价的定义，这意味着 $R(x) = O(g(x))$，所以 $R(x) = O\\left(\\frac{x}{(\\ln x)^3}\\right)$。\n\n完整的误差项是 $E(x) = -C + 2 R(x)$。代入 $R(x)$ 的阶，我们有：\n$$ E(x) = O(1) + 2 \\cdot O\\left(\\frac{x}{(\\ln x)^3}\\right) = O(1) + O\\left(\\frac{x}{(\\ln x)^3}\\right) $$\n当 $x \\to \\infty$ 时，项 $\\frac{x}{(\\ln x)^3}$ 无界增长，而 $O(1)$ 项保持有界。因此，$O(1)$ 项是次要的，被吸收到更大的大O项中：\n$$ E(x) = O\\left(\\frac{x}{(\\ln x)^3}\\right) $$\n将此误差项结果代回到我们对 $\\mathrm{Li}(x)$ 的表达式中，我们得到所求的两项渐近展开式：\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} + O\\left(\\frac{x}{(\\ln x)^3}\\right) $$\n这个表达式提供了 $\\mathrm{Li}(x)$ 渐近级数的前两项，以及一个余项，其阶已从第一性原理得到证明。", "answer": "$$\n\\boxed{\\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} + O\\left(\\frac{x}{(\\ln x)^3}\\right)}\n$$", "id": "3092785"}, {"introduction": "素数定理的一个直接推论是，我们能够估算大区间内素数的数量。这个问题将引导你解决一个经典问题：在 $x$ 和 $2x$ 之间大约有多少个素数？解决这个问题需要你熟练地处理渐近关系，并最终得出一个关于素数分布的深刻结论，即素数虽然愈发稀疏，但在不断扩大的区间内其数量仍然持续增长。[@problem_id:3092828]", "problem": "设 $\\pi(x)$ 表示素数计数函数，即小于或等于 $x$ 的素数的数量。仅使用素数定理 (PNT) 的陈述，即当 $x\\to\\infty$ 时 $\\pi(x)\\sim x/\\ln x$，推导区间 $(x,2x]$ 中素数数量的渐近估计。从基本恒等式 $\\pi(2x)-\\pi(x)$ 开始，并通过仔细比较由 PNT 产生的各项，证明该数量渐近于一个包含自然对数的关于 $x$ 的单一闭式表达式。你的最终答案必须是一个不含不等式的关于 $x$ 的单一解析表达式。", "solution": "该问题要求对区间 $(x, 2x]$ 中的素数数量进行渐近估计。这些素数的数量恰好由素数计数函数值的差给出，即 $\\pi(2x) - \\pi(x)$。我们被要求使用素数定理 (PNT) 来推导这个估计。\n\nPNT 的陈述为：当 $x \\to \\infty$ 时，$\\pi(x) \\sim \\frac{x}{\\ln x}$。根据定义，如果两个函数 $f(x)$ 和 $g(x)$ 的比值的极限为 $1$，则它们是彼此渐近的，记为 $f(x) \\sim g(x)$：\n$$ \\lim_{x\\to\\infty} \\frac{f(x)}{g(x)} = 1 $$\n\n我们寻求一个简单的函数 $g(x)$，使得 $\\pi(2x) - \\pi(x) \\sim g(x)$。$g(x)$ 的一个自然候选者是 $\\pi(2x)$ 和 $\\pi(x)$ 的渐近近似值之差。然而，必须谨慎，因为 $f_1(x) \\sim g_1(x)$ 和 $f_2(x) \\sim g_2(x)$ 通常并不意味着 $f_1(x) - f_2(x) \\sim g_1(x) - g_2(x)$，特别是当 $g_1(x)$ 和 $g_2(x)$ 的值非常接近时。\n\n一个严谨的方法是直接分析 $\\pi(2x) - \\pi(x)$ 与一个候选函数的比值的极限。让我们测试函数 $\\frac{x}{\\ln x}$ 作为渐近估计。我们必须验证以下极限是否成立：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = 1 $$\n\n使用极限的性质，我们可以将比值的极限表示为两个极限的差，前提是每个极限都存在且有限：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\left( \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} - \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) = \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} \\right) - \\left( \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) $$\n\n让我们分别计算每个极限。\n\n对于第二项，根据 PNT 的定义，我们有：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} = 1 $$\n\n对于第一项，我们可以通过乘以和除以 $\\pi(2x)$ 的渐近形式 $\\frac{2x}{\\ln(2x)}$ 来重写表达式，这是由 PNT 应用于参数 $2x$ 得出的：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\left( \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} \\cdot \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} \\right) $$\n使用极限的乘法法则，我们可以将其分成两个极限：\n$$ \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} \\right) \\cdot \\left( \\lim_{x\\to\\infty} \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} \\right) $$\n根据应用于参数 $2x$ 的 PNT，这两个极限中的第一个等于 $1$：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} = 1 $$\n第二个极限需要代数处理：\n$$ \\lim_{x\\to\\infty} \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\frac{2x}{\\ln(2x)} \\cdot \\frac{\\ln x}{x} = \\lim_{x\\to\\infty} \\frac{2\\ln x}{\\ln(2x)} $$\n使用对数性质 $\\ln(2x) = \\ln 2 + \\ln x$，我们有：\n$$ \\lim_{x\\to\\infty} \\frac{2\\ln x}{\\ln 2 + \\ln x} $$\n为了计算这个极限，我们将分子和分母同时除以 $\\ln x$：\n$$ \\lim_{x\\to\\infty} \\frac{2}{\\frac{\\ln 2}{\\ln x} + 1} $$\n当 $x \\to \\infty$ 时，$\\ln x \\to \\infty$，所以 $\\frac{\\ln 2}{\\ln x} \\to 0$。因此，极限为：\n$$ \\frac{2}{0 + 1} = 2 $$\n结合原始差值中第一项的结果：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} = 1 \\cdot 2 = 2 $$\n\n现在我们可以将这两个极限的值代回到差值极限的表达式中：\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} \\right) - \\left( \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) = 2 - 1 = 1 $$\n由于 $\\pi(2x) - \\pi(x)$ 与 $\\frac{x}{\\ln x}$ 的比值的极限为 $1$，我们已经严谨地证明了：\n$$ \\pi(2x) - \\pi(x) \\sim \\frac{x}{\\ln x} $$\n\n因此，区间 $(x, 2x]$ 中素数数量的渐近估计是 $\\frac{x}{\\ln x}$。这是一个符合要求的、关于 $x$ 的、包含自然对数的单一闭式表达式。", "answer": "$$\\boxed{\\frac{x}{\\ln x}}$$\\", "id": "3092828"}, {"introduction": "素数定理是一个渐近结果，意味着它在 $x$ 趋于无穷大时才绝对准确。但在处理具体数值时，我们需要明确的“有效”界限。本练习将带你从抽象的渐近世界走向具体的数值计算，使用著名的 Rosser-Schoenfeld 类型不等式来为 $\\pi(10^{10})$ 计算一个严格的置信区间。这个过程展示了理论数论如何为解决实际、高精度的计算问题提供强大的工具。[@problem_id:3092799]", "problem": "设 $\\pi(x)$ 表示素数计数函数。仅使用素数定理的既定推论和显式有效界，按以下步骤进行：\n\n- 陈述一对对于大 $x$ 成立的、显式的 Rosser–Schoenfeld 型 $\\pi(x)$ 不等式，并展示其在 $\\frac{1}{\\ln x}$ 中的一阶修正项，包含具体的数值常数。\n- 将您的不等式应用于 $x = 10^{10}$，并计算一个包含 $\\pi(10^{10})$ 的严格双边数值区间。\n- 从此区间中，通过取边界的中点，得出一个 $\\pi(10^{10})$ 的单一数值估计。然后，根据您获得的区间，确定您的估计的相对误差的一个上界，并确保此确定的相对误差不超过 $6.0 \\times 10^{-3}$。\n- 将您对 $\\pi(10^{10})$ 的最终数值估计四舍五入到四位有效数字。\n\n您的最终答案必须是一个单一的实数（按要求四舍五入）。", "solution": "问题要求基于与素数定理相关的显式界，估计素数计数函数 $\\pi(x)$ 在 $x=10^{10}$ 处的值。\n\n首先，我们陈述一对展示了一阶修正项的显式 $\\pi(x)$ 不等式。我们使用 Dusart 在2010年建立的界，这是对原始 Rosser-Schoenfeld 不等式的改进。对于 $x \\ge 599$，以下不等式成立：\n$$ \\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2}  \\pi(x) $$\n对于 $x \\ge 1$：\n$$ \\pi(x)  \\frac{x}{\\ln x} + \\frac{1.2762 x}{(\\ln x)^2} $$\n根据要求，这些可以写成 $\\frac{x}{\\ln x} \\left(1 + \\frac{C}{\\ln x}\\right)$ 的形式：\n$$ \\frac{x}{\\ln x}\\left(1 + \\frac{1}{\\ln x}\\right)  \\pi(x)  \\frac{x}{\\ln x}\\left(1 + \\frac{1.2762}{\\ln x}\\right) $$\n$x=10^{10}$ 满足条件 $x \\ge 599$。\n\n接下来，我们将这些不等式应用于 $x = 10^{10}$。我们必须计算 $\\ln(x)$：\n$$ \\ln(x) = \\ln(10^{10}) = 10 \\ln(10) $$\n使用 10 的自然对数的高精度值 $\\ln(10) \\approx 2.30258509299$，我们有：\n$$ L = \\ln(10^{10}) \\approx 10 \\times 2.30258509299 = 23.0258509299 $$\n设 $L_B$ 为 $\\pi(10^{10})$ 的下界，$U_B$ 为上界。\n$$ L_B = \\frac{10^{10}}{L} + \\frac{10^{10}}{L^2} $$\n$$ U_B = \\frac{10^{10}}{L} + \\frac{1.2762 \\times 10^{10}}{L^2} $$\n我们计算各项：\n$$ \\frac{10^{10}}{L} = \\frac{10^{10}}{10 \\ln 10} \\approx \\frac{10^{10}}{23.02585093} \\approx 434,294,481.90 $$\n$$ \\frac{10^{10}}{L^2} = \\frac{10^{10}}{(10 \\ln 10)^2} \\approx \\frac{10^{10}}{530.190108} \\approx 18,861,218.43 $$\n现在，我们可以计算这两个界：\n$$ L_B \\approx 434,294,481.90 + 18,861,218.43 = 453,155,700.33 $$\n$$ U_B \\approx 434,294,481.90 + 1.2762 \\times 18,861,218.43 \\approx 434,294,481.90 + 24,071,192.56 = 458,365,674.46 $$\n由于 $\\pi(10^{10})$ 必须是整数，我们可以建立严格的区间：\n$$ 453,155,701 \\le \\pi(10^{10}) \\le 458,365,674 $$\n\n问题要求通过取计算出的界 $[L_B, U_B]$ 的中点，得出一个单一的数值估计 $P_{est}$。\n$$ P_{est} = \\frac{L_B + U_B}{2} = \\frac{453,155,700.33 + 458,365,674.46}{2} = \\frac{911,521,374.79}{2} \\approx 455,760,687.4 $$\n\n然后，我们必须确定此估计的相对误差的一个上界。真值 $\\pi(x)$ 位于区间 $[L_B, U_B]$ 内，而我们的估计 $P_{est}$ 是中点。最大绝对误差是区间宽度的一半：\n$$ \\Delta P = \\frac{U_B - L_B}{2} $$\n相对误差为 $\\frac{|\\pi(x) - P_{est}|}{\\pi(x)}$。为了找到该量的上界，我们使用分子可能的最大绝对误差和分母可能的最小值，即 $L_B$。因此，确定的相对误差 $E_r$ 的界为：\n$$ E_r \\le \\frac{\\Delta P}{L_B} = \\frac{(U_B - L_B) / 2}{L_B} $$\n让我们用符号表示。我们的界的形式为 $\\frac{x}{L} + \\frac{C_1 x}{L^2}$ 和 $\\frac{x}{L} + \\frac{C_2 x}{L^2}$，其中 $L = \\ln x$，$C_1=1$，$C_2=1.2762$。\n$$ E_r \\le \\frac{\\left(\\frac{x}{L} + \\frac{C_2 x}{L^2}\\right) - \\left(\\frac{x}{L} + \\frac{C_1 x}{L^2}\\right)}{2 \\left(\\frac{x}{L} + \\frac{C_1 x}{L^2}\\right)} = \\frac{\\frac{(C_2-C_1)x}{L^2}}{2 \\frac{x(L+C_1)}{L^2}} = \\frac{C_2 - C_1}{2(L+C_1)} $$\n代入数值 $C_1=1$，$C_2=1.2762$ 和 $L=10 \\ln 10$：\n$$ E_r \\le \\frac{1.2762 - 1}{2(10 \\ln 10 + 1)} \\approx \\frac{0.2762}{2(23.02585093 + 1)} = \\frac{0.2762}{48.05170186} \\approx 0.00574796 $$\n问题要求这个确定的相对误差不超过 $6.0 \\times 10^{-3}$。我们的界满足这个条件：\n$$ 0.00574796  0.006 $$\n\n最后，我们将 $\\pi(10^{10})$ 的数值估计四舍五入到四位有效数字。\n$$ P_{est} \\approx 455,760,687.4 $$\n前四位有效数字是 $4$、$5$、$5$、$7$。随后的数字是 $6$，所以我们将第四位数字向上取整。\n$$ P_{est} \\approx 455,800,000 = 4.558 \\times 10^8 $$", "answer": "$$ \\boxed{4.558 \\times 10^{8}} $$", "id": "3092799"}]}