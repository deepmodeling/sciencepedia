{"hands_on_practices": [{"introduction": "在数论中，研究算术函数平均行为的一个基本工具是分析其和函数。这个练习将向你介绍一个强大的技巧：交换求和次序，它能将一个看似复杂的和式转化为更易于处理的形式。我们将这个技巧应用于和函数 $\\sum_{n \\le x} \\sigma(n)/n$，以揭示其线性增长率，这是解决更复杂问题的一项基本功。[@problem_id:3081674]", "problem": "设 $\\sigma(n)$ 表示正整数 $n$ 的所有正因数之和。对于实数参数 $x \\ge 2$，考虑求和函数\n$$\nS(x) \\coloneqq \\sum_{n \\le x} \\frac{\\sigma(n)}{n},\n$$\n其中，求和范围是所有满足 $n \\le x$ 的正整数 $n$。仅从 $\\sigma(n)$ 的定义和对倍数的基本计数出发，推导 $S(x)$ 的一个渐近表达式，该表达式需包含一个显式的主项和一个至多为对数级的误差项。你可以使用以下熟知的事实：$\\sum_{m=1}^{\\infty} \\frac{1}{m^{2}} = \\frac{\\pi^{2}}{6}$ 和 $\\sum_{m \\le x} \\frac{1}{m} = \\ln x + \\gamma + O\\!\\left(\\frac{1}{x}\\right)$，其中 $\\gamma$ 是欧拉-马歇罗尼常数。将你的最终答案表示为关于 $x$ 的单个解析表达式，并使用兰道大O记号。", "solution": "目标是为实数参数 $x \\ge 2$ 的求和函数 $S(x) \\coloneqq \\sum_{n \\le x} \\frac{\\sigma(n)}{n}$ 寻找一个渐近表达式。推导过程如下：首先将被加项 $\\frac{\\sigma(n)}{n}$ 表示为其因数的和，然后交换求和次序，最后利用给定的事实来估计得到的和。\n\n首先，我们重写 $\\frac{\\sigma(n)}{n}$ 这一项。函数 $\\sigma(n)$ 是 $n$ 的所有正因数之和，可以写成 $\\sigma(n) = \\sum_{d|n} d$。因此，\n$$\n\\frac{\\sigma(n)}{n} = \\frac{1}{n} \\sum_{d|n} d = \\sum_{d|n} \\frac{d}{n}。\n$$\n我们定义一个新的指标 $k = n/d$。当 $d$ 遍历 $n$ 的所有正因数时，$k$ 也同样会遍历 $n$ 的所有正因数。将 $d = n/k$ 代入和式中，得到\n$$\n\\frac{\\sigma(n)}{n} = \\sum_{k|n} \\frac{n/k}{n} = \\sum_{k|n} \\frac{1}{k}。\n$$\n这个恒等式对任何正整数 $n$ 都成立。\n\n现在，我们将其代回 $S(x)$ 的定义中：\n$$\nS(x) = \\sum_{n \\le x} \\sum_{k|n} \\frac{1}{k}。\n$$\n这是一个关于正整数对 $(n, k)$ 的双重求和，其中 $k$ 是 $n$ 的因数且 $n \\le x$。我们可以交换求和次序。我们可以先对 $k$ 求和，而不是先对 $n$ 求和。如果 $k|n$ 且 $n \\le x$，那么数对 $(n, k)$ 就包含在求和中。这等价于存在某个正整数 $m$ 使得 $n=mk$ 且 $mk \\le x$。\n所以，我们可以先对所有可能的 $k$ 值求和。对于 $n \\le x$ 和 $k|n$，我们必须有 $k \\le n \\le x$。因此 $k$ 的取值范围是从 $1$ 到 $\\lfloor x \\rfloor$。对于一个固定的 $k$，$n$ 必须是 $k$ 的倍数且满足 $n \\le x$。也就是说，$n \\in \\{k, 2k, 3k, \\dots, \\lfloor x/k \\rfloor k\\}$。\n重写求和，先对 $k$ 求和，然后对相应的 $n$ 的倍数求和：\n$$\nS(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\sum_{\\substack{n \\le x \\\\ k|n}} \\frac{1}{k}。\n$$\n内层求和是关于 $n$ 的。项 $\\frac{1}{k}$ 相对于 $n$ 是常数。内层和的项数是小于或等于 $x$ 的 $k$ 的倍数的数量，这恰好是 $\\lfloor \\frac{x}{k} \\rfloor$。\n因此，和式变为\n$$\nS(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} \\left\\lfloor \\frac{x}{k} \\right\\rfloor。\n$$\n为了分析这个和式，我们将向下取整函数 $\\lfloor u \\rfloor$ 表示为 $u - \\{u\\}$，其中 $\\{u\\}$ 是 $u$ 的小数部分，满足 $0 \\le \\{u\\}  1$。\n$$\nS(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} \\left( \\frac{x}{k} - \\left\\{\\frac{x}{k}\\right\\} \\right) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{x}{k^2} - \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}\\left\\{\\frac{x}{k}\\right\\}。\n$$\n我们分别分析右侧的两个和式。\n\n设第一个和式为 $S_1(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{x}{k^2} = x \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k^2}$。令 $N = \\lfloor x \\rfloor$。\n我们可以利用给定的无穷级数值 $\\sum_{k=1}^{\\infty} \\frac{1}{k^2} = \\frac{\\pi^2}{6}$ 来表示有限和 $\\sum_{k=1}^{N} \\frac{1}{k^2}$。\n$$\n\\sum_{k=1}^{N} \\frac{1}{k^2} = \\sum_{k=1}^{\\infty} \\frac{1}{k^2} - \\sum_{k=N+1}^{\\infty} \\frac{1}{k^2} = \\frac{\\pi^2}{6} - R_N,\n$$\n其中 $R_N = \\sum_{k=N+1}^{\\infty} \\frac{1}{k^2}$。由于 $f(t) = 1/t^2$ 在 $t > 0$ 时是一个正的递减函数，级数的尾部 $R_N$ 可以用一个积分来界定：\n$$\nR_N \\le \\int_{N}^{\\infty} \\frac{1}{t^2} dt = \\left[ -\\frac{1}{t} \\right]_N^{\\infty} = 0 - \\left(-\\frac{1}{N}\\right) = \\frac{1}{N}。\n$$\n所以，$R_N = O\\left(\\frac{1}{N}\\right)$。由于 $N = \\lfloor x \\rfloor$，我们有 $x-1  N \\le x$。对于 $x \\ge 2$，$N \\ge 1$，所以 $1/N \\le 1/(x-1) = O(1/x)$。因此，$R_N = O\\left(\\frac{1}{x}\\right)$。\n将此代回 $S_1(x)$ 的表达式中：\n$$\nS_1(x) = x \\left( \\frac{\\pi^2}{6} - O\\left(\\frac{1}{x}\\right) \\right) = \\frac{\\pi^2}{6}x - O(1)。\n$$\n这就得到了我们渐近公式的主项。\n\n设第二个和式为 $S_2(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}\\left\\{\\frac{x}{k}\\right\\}$。这将构成我们的误差项。\n根据小数部分的定义，我们有 $0 \\le \\left\\{\\frac{x}{k}\\right\\}  1$。这导致对 $S_2(x)$ 的界定：\n$$\n0 \\le S_2(x)  \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}。\n$$\n右边的和是到 $N=\\lfloor x \\rfloor$ 为止的调和级数。我们已知渐近公式 $\\sum_{m \\le y} \\frac{1}{m} = \\ln y + \\gamma + O\\left(\\frac{1}{y}\\right)$。将此应用于 $y=N$：\n$$\n\\sum_{k=1}^{N} \\frac{1}{k} = \\ln N + \\gamma + O\\left(\\frac{1}{N}\\right)。\n$$\n为了用 $x$ 表示这个式子，我们注意到 $\\ln N = \\ln(\\lfloor x \\rfloor)$。因为对于 $x \\ge 2$，有 $\\ln(x-1)  \\ln(\\lfloor x \\rfloor) \\le \\ln x$，并且 $\\ln(x-1) = \\ln(x(1-1/x)) = \\ln x + \\ln(1-1/x) = \\ln x + O(1/x)$，所以我们有 $\\ln(\\lfloor x \\rfloor) = \\ln x + O(1/x)$。\n因此，\n$$\n\\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} = \\ln x + O\\left(\\frac{1}{x}\\right) + \\gamma + O\\left(\\frac{1}{x}\\right) = \\ln x + \\gamma + O\\left(\\frac{1}{x}\\right)。\n$$\n从界限 $0 \\le S_2(x)  \\ln x + \\gamma + O(1/x)$，我们可以得出结论 $S_2(x) = O(\\ln x)$。\n\n最后，我们结合 $S_1(x)$ 和 $S_2(x)$ 的结果，得到 $S(x)$ 的渐近公式：\n$$\nS(x) = S_1(x) - S_2(x) = \\left(\\frac{\\pi^2}{6}x - O(1)\\right) - O(\\ln x)。\n$$\n误差项是两个误差项的和。总误差的量级由 $|-O(1) - O(\\ln x)| \\le |O(1)| + |O(\\ln x)|$ 界定。对于大的 $x$，$O(\\ln x)$ 项主导 $O(1)$ 项。因此，组合后的误差项是 $O(\\ln x)$。\n\n$S(x)$ 的最终渐近表达式是\n$$\nS(x) = \\frac{\\pi^2}{6}x + O(\\ln x)。\n$$\n这个表达式提供了所要求的主线性项和对数级的误差项。", "answer": "$$\n\\boxed{\\frac{\\pi^2}{6}x + O(\\ln x)}\n$$", "id": "3081674"}, {"introduction": "在之前交换求和次序技巧的基础上，我们现在引入一个更精妙且对称的版本——狄利克雷双曲线法。本练习将这个优雅的方法应用于数论中的一个经典问题：确定除数函数 $\\tau(n)$ 的平均阶。通过精确计算双曲线 $ab \\le x$ 下方的整点数量，我们不仅能找到主项，还能推导出次阶项中的精确常数，从而揭示它与欧拉-马歇罗尼常数 $\\gamma$ 之间出人意料的联系。[@problem_id:3081675]", "problem": "令 $\\tau(n)$ 表示 $n$ 的正因数个数，对于实数 $t \\geq 1$，令 $H_{t} := \\sum_{n \\leq t} \\frac{1}{n}$ 表示广义调和和。考虑对于实数 $x \\geq 1$ 的求和函数 $S(x) := \\sum_{n \\leq x} \\tau(n)$。从 $\\tau(n)$ 的基本定义和 $S(x)$ 作为满足 $d m \\leq x$ 的整数对 $(d,m)$ 数量的双重计数解释出发，推导出一个用向下取整函数的和表示 $S(x)$ 的精确恒等式。然后，通过在 $n = \\lfloor \\sqrt{x} \\rfloor$ 处对称地分割所得的和，使用 $x H_{\\lfloor \\sqrt{x} \\rfloor}$ 来近似主项，并仅使用初等界限来控制余项。假设广为人知的渐进展开式 $H_{t} = \\ln(t) + \\gamma + O\\!\\left(\\frac{1}{t}\\right)$，其中 $\\gamma$ 是欧拉-马歇罗尼常数。证明存在一个常数 $C$，使得\n$$\nS(x) = x \\ln(x) + C x + o(x),\n$$\n并确定 $C$ 的闭式表达式。你的最终答案必须是单一的解析表达式。不需要四舍五入。", "solution": "该问题要求推导除数函数的求和函数 $S(x) = \\sum_{n \\leq x} \\tau(n)$ 的渐进公式，并确定此公式中的一个特定常数。推导过程必须遵循指定的路径，包括双重计数论证、和的对称分割以及渐进分析。\n\n首先，我们为 $S(x)$ 建立一个精确恒等式。除数函数 $\\tau(n)$ 定义为整数 $n$ 的正因数个数，可以写成 $\\tau(n) = \\sum_{d|n, d>0} 1$。将此定义代入 $S(x)$ 的表达式中，得到：\n$$\nS(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\tau(n) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} 1\n$$\n我们可以交换求和顺序。该和是对满足 $d$ 整除 $n$ 且 $n \\leq x$ 的正整数对 $(n, d)$ 进行的。这等价于对满足 $n = dm$ 且 $dm \\leq x$ 的正整数对 $(d, m)$ 进行求和。因此，$S(x)$ 是第一象限中满足 $dm \\leq x$ 的整格点 $(d, m)$ 的数量。\n$$\nS(x) = \\sum_{d \\geq 1, m \\geq 1, dm \\leq x} 1\n$$\n为了将其表示为向下取整函数的和，我们可以先对 $d$ 求和。对于一个固定的正整数 $d$，$m$ 的条件是 $m \\leq \\frac{x}{d}$。由于 $m$ 必须是整数，我们有 $1 \\leq m \\leq \\lfloor \\frac{x}{d} \\rfloor$。$d$ 的最大可能值为 $\\lfloor x \\rfloor$，因为当 $d > x$ 时，$\\lfloor \\frac{x}{d} \\rfloor = 0$。因此，我们得到精确恒等式：\n$$\nS(x) = \\sum_{d=1}^{\\lfloor x \\rfloor} \\sum_{m=1}^{\\lfloor x/d \\rfloor} 1 = \\sum_{d=1}^{\\lfloor x \\rfloor} \\lfloor \\frac{x}{d} \\rfloor\n$$\n接下来，我们应用被称为狄利克雷双曲线法的技术，这对应于“对称分割”的指令。求和区域 $dm \\leq x$（其中 $d,m \\geq 1$）关于直线 $d=m$ 是对称的。这条直线与边界曲线 $dm=x$ 相交于点 $(\\sqrt{x}, \\sqrt{x})$。令 $N = \\lfloor \\sqrt{x} \\rfloor$。我们计算两个重叠矩形区域中的点数，然后减去它们交集的点数。\n第一个区域由 $1 \\leq d \\leq N$ 定义。该区域内的点数为 $\\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor$。\n第二个区域由 $1 \\leq m \\leq N$ 定义。点数为 $\\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor$。\n这两个区域的交集是由 $1 \\leq d \\leq N$ 和 $1 \\leq m \\leq N$ 定义的正方形。这个正方形内的点数为 $N \\times N = N^2$。\n根据容斥原理，总点数为：\n$$\nS(x) = \\left( \\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor \\right) + \\left( \\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor \\right) - N^2 = 2 \\sum_{n=1}^{N} \\lfloor \\frac{x}{n} \\rfloor - N^2\n$$\n其中我们使用 $n$ 作为哑求和指标。\n\n现在我们进行渐进分析。我们将向下取整函数分解为 $\\lfloor z \\rfloor = z - \\{z\\}$，其中 $\\{z\\}$ 是 $z$ 的小数部分，满足 $0 \\leq \\{z\\}  1$。\n$$\nS(x) = 2 \\sum_{n=1}^{N} \\left(\\frac{x}{n} - \\left\\{\\frac{x}{n}\\right\\}\\right) - N^2 = 2x \\sum_{n=1}^{N} \\frac{1}{n} - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\n第一项涉及广义调和和 $H_N = \\sum_{n=1}^{N} \\frac{1}{n}$。于是，表达式变为：\n$$\nS(x) = 2x H_N - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\n我们来分析每一项的大小。\n余项和是有界的：$0 \\leq \\sum_{n=1}^{N} \\{\\frac{x}{n}\\}  \\sum_{n=1}^{N} 1 = N$。因此，$2 \\sum_{n=1}^{N} \\{\\frac{x}{n}\\} = O(N) = O(\\sqrt{x})$。\n对于 $N^2$ 项，我们有 $N = \\lfloor\\sqrt{x}\\rfloor = \\sqrt{x} - \\{\\sqrt{x}\\}$。\n$$\nN^2 = (\\sqrt{x} - \\{\\sqrt{x}\\})^2 = x - 2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2\n$$\n由于 $0 \\leq \\{\\sqrt{x}\\}  1$，项 $-2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2$ 是 $O(\\sqrt{x})$。因此，我们可以写成 $N^2 = x + O(\\sqrt{x})$，或等价地 $-N^2 = -x + O(\\sqrt{x})$。\n将这些估计值代回 $S(x)$ 的表达式中：\n$$\nS(x) = 2x H_N - O(\\sqrt{x}) - (x + O(\\sqrt{x})) = 2x H_N - x + O(\\sqrt{x})\n$$\n问题给出了调和和的渐进展开式：$H_t = \\ln(t) + \\gamma + O(\\frac{1}{t})$，其中 $\\gamma$ 是欧拉-马歇罗尼常数。我们将其应用于 $t = N = \\lfloor\\sqrt{x}\\rfloor$。\n$$\nH_N = \\ln(N) + \\gamma + O(\\frac{1}{N})\n$$\n我们需要将 $\\ln(N)$ 与 $\\ln(x)$ 联系起来。\n$$\n\\ln(N) = \\ln(\\lfloor\\sqrt{x}\\rfloor) = \\ln(\\sqrt{x} - \\{\\sqrt{x}\\}) = \\ln\\left(\\sqrt{x}\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\\right)\n$$\n$$\n\\ln(N) = \\ln(\\sqrt{x}) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln(x) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\n$$\n对于小的 $u$，使用 Taylor 展开式 $\\ln(1-u) = -u - \\frac{u^2}{2} - \\dots$。这里 $u = \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}} = O(\\frac{1}{\\sqrt{x}})$。\n$$\n\\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\n因此，$\\ln(N) = \\frac{1}{2}\\ln(x) + O(\\frac{1}{\\sqrt{x}})$。因为 $1/N = O(1/\\sqrt{x})$，所以 $H_N$ 的近似式变为：\n$$\nH_N = \\left(\\frac{1}{2}\\ln(x) + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln(x) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\n最后，我们将此代入 $S(x)$ 的表达式中：\n$$\nS(x) = 2x \\left(\\frac{1}{2}\\ln(x) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) - x + O(\\sqrt{x})\n$$\n$$\nS(x) = x\\ln(x) + 2\\gamma x + 2x \\cdot O\\left(\\frac{1}{\\sqrt{x}}\\right) - x + O(\\sqrt{x})\n$$\n项 $2x \\cdot O(\\frac{1}{\\sqrt{x}})$ 是 $O(\\sqrt{x})$。合并所有误差项，得到：\n$$\nS(x) = x\\ln(x) + (2\\gamma - 1)x + O(\\sqrt{x})\n$$\n题目要求证明 $S(x) = x \\ln(x) + C x + o(x)$。一个 $O(\\sqrt{x})$ 的误差项是一个函数 $f(x)$，存在一个常数 $M$ 使得对于足够大的 $x$ 有 $|f(x)| \\leq M\\sqrt{x}$。由于 $\\lim_{x\\to\\infty} \\frac{\\sqrt{x}}{x} = \\lim_{x\\to\\infty} \\frac{1}{\\sqrt{x}} = 0$，任何 $O(\\sqrt{x})$ 的函数也都是 $o(x)$。\n因此，我们推导出的渐进公式具有所要求的形式：\n$$\nS(x) = x \\ln(x) + (2\\gamma - 1) x + o(x)\n$$\n通过将其与 $S(x) = x \\ln(x) + C x + o(x)$ 进行比较，我们确定常数 $C$。\n$$\nC = 2\\gamma - 1\n$$\n这就是常数 $C$ 的闭式表达式。", "answer": "$$\n\\boxed{2\\gamma - 1}\n$$", "id": "3081675"}, {"introduction": "上一个练习 [@problem_id:3081675] 在应用双曲线法时，对称地在 $\\sqrt{x}$ 处进行了分割。这引出了一个自然的问题：为什么选择这个特定的分割点？这个最后的练习将通过将分割点视为一个可变参数 $y$ 来回答这个问题。通过将误差项表示为 $y$ 的函数，你将执行解析数论中的一个关键步骤：优化参数以获得尽可能紧的误差界，从而更深刻地理解该方法的设计思想。[@problem_id:3081705]", "problem": "设 $x \\geq 1$ 是一个实数参数，并设 $\\tau(n)$ 表示整数 $n$ 的正因子个数。考虑除数求和函数 $D(x) = \\sum_{n \\leq x} \\tau(n)$，并将其解释为满足 $ab \\leq x$ 的正整数对 $(a,b)$ 的数量。固定一个分割参数 $y$，满足 $1 \\leq y \\leq \\sqrt{x}$，并将整数对 $(a,b)$ 的计数分解为 $a \\leq y$ 和 $b \\leq y$ 的情况，同时仔细处理重叠部分。\n\n从 $\\tau(n)$ 的基本定义和将 $D(x)$ 解释为双曲线 $ab \\leq x$ 下的格点计数的角度出发，推导出一个 $D(x)$ 的分解式，该分解式分离出由在 $y$ 处的分割产生的边界矩形的贡献。然后，仅使用初等分析中经过充分检验的事实来近似所得的和，特别是调和数满足 $H_{y} = \\sum_{n=1}^{\\lfloor y \\rfloor} \\frac{1}{n} = \\ln y + \\gamma + O\\!\\left(\\frac{1}{y}\\right)$，其中 $\\gamma$ 是欧拉-马歇罗尼常数。由此，得到 $D(x)$ 的一个显式主项和一个用 $x$ 和 $y$ 表示的显式误差界。\n\n最后，将总误差作为 $y$ 的函数，在 $1 \\leq y \\leq \\sqrt{x}$ 的范围内进行最小化，并以 $x$ 的闭合形式表达式报告 $y$ 的最优选择。不需要四舍五入，你必须将最终答案表示为单一的解析表达式。", "solution": "问题要求使用狄利克雷双曲线法，并带有一个通用的分割参数 $y$ ($1 \\leq y \\leq \\sqrt{x}$)，来分析除数求和函数 $D(x) = \\sum_{n \\leq x} \\tau(n)$。\n\n首先，我们从 $D(x)$ 的基本定义出发。函数 $D(x)$ 统计乘积 $ab \\leq x$ 的正整数对 $(a,b)$ 的数量。狄利克雷双曲线法是一种对这些格点进行计数的有效方法。我们使用容斥原理，将总数表示为两个重叠区域中点数之和，再减去其交集中的点数。设 $y$ 是一个参数，满足 $1 \\leq y \\leq x$。格点 $(a,b)$ 的集合可以分为 $a \\le y$ 的部分和 $b \\le x/y$ 的部分。$D(x)$ 可以精确地写为：\n$$ D(x) = \\sum_{a=1}^{\\lfloor y \\rfloor} \\sum_{b=1}^{\\lfloor x/a \\rfloor} 1 + \\sum_{b=1}^{\\lfloor x/y \\rfloor} \\sum_{a=1}^{\\lfloor x/b \\rfloor} 1 - \\sum_{a=1}^{\\lfloor y \\rfloor} \\sum_{b=1}^{\\lfloor x/y \\rfloor} 1 $$\n这可以简化为：\n$$ D(x) = \\sum_{a=1}^{\\lfloor y \\rfloor} \\left\\lfloor \\frac{x}{a} \\right\\rfloor + \\sum_{b=1}^{\\lfloor x/y \\rfloor} \\left\\lfloor \\frac{x}{b} \\right\\rfloor - \\lfloor y \\rfloor \\lfloor x/y \\rfloor $$\n注意，由于我们被限制在 $1 \\le y \\le \\sqrt{x}$，我们有 $x/y \\ge \\sqrt{x} \\ge y$。\n\n现在我们近似这个表达式中的每一项。我们使用近似 $\\lfloor z \\rfloor = z - \\{z\\} = z + O(1)$，以及调和数 $H_N = \\sum_{n=1}^N \\frac{1}{n} = \\ln N + \\gamma + O(1/N)$。\n\n1.  **第一个和式**：设 $Y = \\lfloor y \\rfloor$。\n    $$ \\sum_{a=1}^{Y} \\left\\lfloor \\frac{x}{a} \\right\\rfloor = \\sum_{a=1}^{Y} \\left( \\frac{x}{a} + O(1) \\right) = x \\sum_{a=1}^{Y} \\frac{1}{a} + O(Y) = x H_Y + O(y) $$\n    因为 $Y=y+O(1)$，$\\ln Y = \\ln y + O(1/y)$，所以 $H_Y = \\ln y + \\gamma + O(1/y)$。\n    $$ \\sum_{a=1}^{Y} \\left\\lfloor \\frac{x}{a} \\right\\rfloor = x(\\ln y + \\gamma + O(1/y)) + O(y) = x \\ln y + \\gamma x + O(x/y) + O(y) $$\n\n2.  **第二个和式**：设 $Z = \\lfloor x/y \\rfloor$。\n    $$ \\sum_{b=1}^{Z} \\left\\lfloor \\frac{x}{b} \\right\\rfloor = x H_Z + O(Z) = x(\\ln Z + \\gamma + O(1/Z)) + O(x/y) $$\n    因为 $Z = x/y + O(1)$，$\\ln Z = \\ln(x/y) + O(y/x) = \\ln x - \\ln y + O(y/x)$。\n    $$ \\sum_{b=1}^{Z} \\left\\lfloor \\frac{x}{b} \\right\\rfloor = x(\\ln x - \\ln y + \\gamma + O(y/x)) + O(x/y) = x\\ln x - x\\ln y + \\gamma x + O(y) + O(x/y) $$\n\n3.  **减去的部分**：\n    $$ \\lfloor y \\rfloor \\lfloor x/y \\rfloor = (y + O(1))(x/y + O(1)) = x + O(y) + O(x/y) + O(1) = x + O(y) + O(x/y) $$\n\n将这三项组合起来：\n$D(x) = (x \\ln y + \\gamma x + O(x/y) + O(y)) + (x\\ln x - x\\ln y + \\gamma x + O(y) + O(x/y)) - (x + O(y) + O(x/y))$\n\n合并主项：\n$D(x) = x\\ln x + (x \\ln y - x \\ln y) + (\\gamma x + \\gamma x - x) = x\\ln x + (2\\gamma - 1)x$\n\n合并误差项：\n误差 $= O(x/y) + O(y) + O(y) + O(x/y) + O(y) + O(x/y) = O(y + x/y)$。\n\n所以，我们得到 $D(x)$ 的渐近表达式，其误差项依赖于参数 $y$：\n$$ D(x) = x \\ln x + (2\\gamma - 1)x + O(y + x/y) $$\n\n最后，我们需要在 $1 \\leq y \\leq \\sqrt{x}$ 的范围内最小化误差项 $E(y) = O(y + x/y)$。这等价于最小化函数 $f(y) = c_1 y + c_2 \\frac{x}{y}$（对于某些正的常数 $c_1, c_2$）。为了找到最小值，我们将两个分量的大小设为相等：\n$$ c_1 y \\approx c_2 \\frac{x}{y} \\implies y^2 \\approx \\frac{c_2}{c_1} x \\implies y \\approx \\sqrt{\\frac{c_2}{c_1}} \\sqrt{x} $$\n这表明最优选择是 $y$ 与 $\\sqrt{x}$ 成正比。在没有关于常数 $c_1, c_2$ 的更多信息的情况下（它们取决于我们对 $O$ 符号中隐藏常数的具体分析），平衡两个误差项贡献的自然选择是令 $y$ 和 $x/y$ 的数量级相同。这发生在 $y \\approx \\sqrt{x}$ 时。\n当 $y = \\sqrt{x}$ 时，误差项 $O(\\sqrt{x} + x/\\sqrt{x}) = O(\\sqrt{x})$。\n因此，为了最小化误差界，最优的选择是将分割参数 $y$ 设为 $\\sqrt{x}$。", "answer": "$$\n\\boxed{\\sqrt{x}}\n$$", "id": "3081705"}]}