{"hands_on_practices": [{"introduction": "在深入研究一个深刻的数学证明之前，通过具体的数值来检验和感受一个猜想是至关重要的第一步。本练习旨在通过直接计算来验证伯特兰猜想在小整数范围内的表现，要求你为 $n$ 从 $2$ 到 $30$ 的情况，找出并计数区间 $(n, 2n)$ 内的所有质数。这个过程不仅能让你亲手验证猜想的正确性，还能帮助你观察质数分布的一些微妙规律，从而更好地理解证明策略为何需要克服的挑战。[@problem_id:3081805]", "problem": "令 $a(n)$ 表示严格介于 $n$ 和 $2n$ 之间的质数个数，即对于整数 $n$，集合 $\\{\\,p \\text{ prime} : n  p  2n\\,\\}$ 的基数。对于每个满足 $2 \\le n \\le 30$ 的整数 $n$，构建在 $(n,2n)$ 区间内的质数表并记录 $a(n)$。仅基于质数和质数计数函数 $\\pi(x)$ 的基本定义，以及诸如 $\\pi(x)$ 单调性等经过验证的普适事实，讨论你观察到的 $a(n)$ 中与伯特兰猜想（Bertrand’s postulate）的证明策略相关的任何定性模式（無需尝试证明该猜想或援引未经证实的论断）。最后，计算总量\n$$\nS \\;=\\; \\sum_{n=2}^{30} a(n).\n$$\n将 $S$ 的最终值表示为一个精确整数。无需四舍五入。", "solution": "该问题要求对整数值函数 $a(n)$ 进行三部分分析，该函数计算开区间 $(n, 2n)$ 内质数 $p$ 的数量。分析将在整数 $n$ 的范围 $2 \\le n \\le 30$ 内进行。首先，我们必须构建一个 $a(n)$ 的值表。其次，我们仅使用基本定义和事实，讨论 $a(n)$ 行为中与伯特兰猜想证明相关的定性模式。第三，我们必须计算总和 $S = \\sum_{n=2}^{30} a(n)$。\n\n首先，我们列出当 $n$ 最大取到 $30$ 时，区间 $(n, 2n)$ 所需的质数。$2n$ 的最大值为 $2 \\times 30 = 60$。小于 $60$ 的质数有：\n$2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59$。\n\n使用这个列表，我们为从 $2$ 到 $30$ 的每个整数 $n$ 构建一个表格，详细说明区间 $(n, 2n)$、该区间内的质数集合以及计数 $a(n)$。\n\n| $n$ | 区间 $(n, 2n)$ | $(n,2n)$ 内的质数集合 | $a(n)$ |\n|:---:|:---:|:---|:---:|\n| $2$ | $(2, 4)$ | $\\{3\\}$ | $1$ |\n| $3$ | $(3, 6)$ | $\\{5\\}$ | $1$ |\n| $4$ | $(4, 8)$ | $\\{5, 7\\}$ | $2$ |\n| $5$ | $(5, 10)$ | $\\{7\\}$ | $1$ |\n| $6$ | $(6, 12)$ | $\\{7, 11\\}$ | $2$ |\n| $7$ | $(7, 14)$ | $\\{11, 13\\}$ | $2$ |\n| $8$ | $(8, 16)$ | $\\{11, 13\\}$ | $2$ |\n| $9$ | $(9, 18)$ | $\\{11, 13, 17\\}$ | $3$ |\n| $10$ | $(10, 20)$ | $\\{11, 13, 17, 19\\}$ | $4$ |\n| $11$ | $(11, 22)$ | $\\{13, 17, 19\\}$ | $3$ |\n| $12$ | $(12, 24)$ | $\\{13, 17, 19, 23\\}$ | $4$ |\n| $13$ | $(13, 26)$ | $\\{17, 19, 23\\}$ | $3$ |\n| $14$ | $(14, 28)$ | $\\{17, 19, 23\\}$ | $3$ |\n| $15$ | $(15, 30)$ | $\\{17, 19, 23, 29\\}$ | $4$ |\n| $16$ | $(16, 32)$ | $\\{17, 19, 23, 29, 31\\}$ | $5$ |\n| $17$ | $(17, 34)$ | $\\{19, 23, 29, 31\\}$ | $4$ |\n| $18$ | $(18, 36)$ | $\\{19, 23, 29, 31\\}$ | $4$ |\n| $19$ | $(19, 38)$ | $\\{23, 29, 31, 37\\}$ | $4$ |\n| $20$ | $(20, 40)$ | $\\{23, 29, 31, 37\\}$ | $4$ |\n| $21$ | $(21, 42)$ | $\\{23, 29, 31, 37, 41\\}$ | $5$ |\n| $22$ | $(22, 44)$ | $\\{23, 29, 31, 37, 41, 43\\}$ | $6$ |\n| $23$ | $(23, 46)$ | $\\{29, 31, 37, 41, 43\\}$ | $5$ |\n| $24$ | $(24, 48)$ | $\\{29, 31, 37, 41, 43, 47\\}$ | $6$ |\n| $25$ | $(25, 50)$ | $\\{29, 31, 37, 41, 43, 47\\}$ | $6$ |\n| $26$ | $(26, 52)$ | $\\{29, 31, 37, 41, 43, 47\\}$ | $6$ |\n| $27$ | $(27, 54)$ | $\\{29, 31, 37, 41, 43, 47, 53\\}$ | $7$ |\n| $28$ | $(28, 56)$ | $\\{29, 31, 37, 41, 43, 47, 53\\}$ | $7$ |\n| $29$ | $(29, 58)$ | $\\{31, 37, 41, 43, 47, 53\\}$ | $6$ |\n| $30$ | $(30, 60)$ | $\\{31, 37, 41, 43, 47, 53, 59\\}$ | $7$ |\n\n接下来，我们讨论 $a(n)$ 的定性模式。伯特兰猜想指出，对于任何整数 $n  1$，都有 $a(n) \\ge 1$。\n1.  **经验性验证**：表格显示，对于范围 $2 \\le n \\le 30$ 内的每个整数 $n$，$a(n)$ 的值至少为 $1$。这为该猜想在这个有限范围内提供了经验证据。\n2.  **与质数计数函数的关系**：函数 $a(n)$ 与质数计数函数 $\\pi(x)$ 精确相关，$\\pi(x)$ 给出小于或等于 $x$ 的质数个数。严格介于 $n$ 和 $2n$ 之间的质数 $p$ 的数量，等于小于或等于 $2n-1$ 的质数数量减去小于或等于 $n$ 的质数数量。因此，我们可以写出 $a(n) = \\pi(2n-1) - \\pi(n)$。由于 $n \\ge 2$，$2n$ 是合数，所以这等价于 $a(n) = \\pi(2n) - \\pi(n)$。\n3.  **局部波动**：序列 $a(n)$ 不是单调的。例如，$a(4)=2$ 而 $a(5)=1$。我们可以精确地描述这种行为。让我们考察变化量 $a(n+1) - a(n)$：\n$$\na(n+1) - a(n) = (\\pi(2(n+1)-1) - \\pi(n+1)) - (\\pi(2n-1) - \\pi(n))\n$$\n$$\na(n+1) - a(n) = (\\pi(2n+1) - \\pi(2n-1)) - (\\pi(n+1) - \\pi(n))\n$$\n项 $\\pi(n+1) - \\pi(n)$ 计算满足 $n  p \\le n+1$ 的质数 $p$ 的数量。如果 $n+1$ 是质数，此计数为 $1$，否则为 $0$。\n项 $\\pi(2n+1) - \\pi(2n-1)$ 计算满足 $2n-1  p \\le 2n+1$ 的质数 $p$ 的数量。此区间中的整数是 $2n$ 和 $2n+1$。对于 $n \\ge 2$，$2n$ 是合数。因此，如果 $2n+1$ 是质数，此计数为 $1$，否则为 $0$。\n令 $\\mathbb{I}(C)$ 为指示函数，当条件 $C$ 为真时为 $1$，否则为 $0$。那么，\n$$\na(n+1) - a(n) = \\mathbb{I}(2n+1 \\text{ is prime}) - \\mathbb{I}(n+1 \\text{ is prime}).\n$$\n这个关系解释了观察到的波动。例如，当 $n=10$ 时，$n+1=11$ 是质数而 $2n+1=21$ 不是，所以 $a(11) - a(10) = 0 - 1 = -1$，这与 $a(11)=3$ 和 $a(10)=4$ 一致。$a(n)$ 可能减少这一事实意味着一个简单的归纳证明（即证明 $a(n) \\ge 1 \\implies a(n+1) \\ge 1$）是不可行的。一个成功的证明策略必须克服这种非单调性，例如通过为 $a(n)$ 建立一个足够强的下界，这个下界不会被这些局部减量所突破。Erdős 的著名证明，通过分析中心二项式系数 $\\binom{2n}{n}$ 的质因数分解，就是这种全局论证的一个例子。\n4.  **全局趋势**：尽管存在局部波动，表格中 $a(n)$ 的值呈现出明显的增长趋势。其值范围从 $1$ 到 $7$。这种增长与源自质数定理的启发式论证是一致的，质数定理表明 $\\pi(x) \\approx x/\\ln(x)$。这意味着 $a(n) = \\pi(2n) - \\pi(n) \\approx \\frac{2n}{\\ln(2n)} - \\frac{n}{\\ln(n)} \\approx \\frac{n}{\\ln(n)}$。这种近似形式表明 $a(n)$ 不仅保持为正，而且随 $n$ 增长。这强化了这样一种观点，即证明策略應侧重于质数的整体密度和分布，而不仅仅是它们的序列性质。\n\n最后，我们计算总量 $S$。\n$$\nS \\;=\\; \\sum_{n=2}^{30} a(n)\n$$\n使用表格中的值：\n$a(2)$ 到 $a(5)$：$1, 1, 2, 1$。和 = $5$。\n$a(6)$ 到 $a(10)$：$2, 2, 2, 3, 4$。和 = $13$。\n$a(11)$ 到 $a(15)$：$3, 4, 3, 3, 4$。和 = $17$。\n$a(16)$ 到 $a(20)$：$5, 4, 4, 4, 4$。和 = $21$。\n$a(21)$ 到 $a(25)$：$5, 6, 5, 6, 6$。和 = $28$。\n$a(26)$ 到 $a(30)$：$6, 7, 7, 6, 7$。和 = $33$。\n\n总和 $S$ 是这些部分和的总和：\n$$\nS = 5 + 13 + 17 + 21 + 28 + 33\n$$\n$$\nS = 18 + 17 + 21 + 28 + 33 = 35 + 21 + 28 + 33 = 56 + 28 + 33 = 84 + 33 = 117\n$$\n总和的值为 $117$。", "answer": "$$\\boxed{117}$$", "id": "3081805"}, {"introduction": "许多关于质数分布的证明，包括伯特兰猜想的证明，都巧妙地依赖于对中心二项式系数 $\\binom{2n}{n}$ 的分析。为了控制这个量，建立其精确的上下界是证明中的关键环节。这个练习将引导你探究证明中使用的一个基本下界不等式 $\\binom{2n}{n} \\ge \\frac{4^n}{2n+1}$，你需要证明它，并通过计算来评估它在小 $n$ 值时的“紧密”程度。这让你能亲身体会到驱动形式化证明的分析工具的力量。[@problem_id:3081802]", "problem": "在研究 $n$ 和 $2n$ 之间质数的存在性（伯特兰猜想）时，一种常见的方法是控制中心二项式系数 $\\binom{2n}{n}$。支撑若干论证的一个不等式是下界 $\\binom{2n}{n} \\ge \\frac{4^{n}}{2n+1}$。仅从二项式定理和二项式系数的定义出发，证明为什么 $\\binom{2n}{n}$ 必须满足 $\\binom{2n}{n} \\ge \\frac{4^{n}}{2n+1}$ 形式的下界。然后，为了评估这个界在小输入值下的强度，并确认它对于与伯特兰猜想相关的论证中的基础情况检验是足够的，定义比率\n$$\nR(n) = \\frac{(2n+1)\\binom{2n}{n}}{4^{n}}\n$$\n并计算当 $n=1,2,\\ldots,10$ 时 $R(n)$ 的值。确定 $R(n)$ 在此范围内的精确最小值。将你的最终答案表示为单个化简后的有理数。无需四舍五入。", "solution": "我们从二项式定理开始，这是一个基本恒等式，它表明对于任意非负整数 $m$，\n$$\n(1+1)^{m} = \\sum_{k=0}^{m} \\binom{m}{k}.\n$$\n令 $m=2n$ 可得\n$$\n\\sum_{k=0}^{2n} \\binom{2n}{k} = 2^{2n} = 4^{n}.\n$$\n接下来，我们证明中心项 $\\binom{2n}{n}$ 是所有 $\\binom{2n}{k}$ 中最大的。考虑对于 $0 \\le k \\le 2n-1$ 的连续项之比：\n$$\n\\frac{\\binom{2n}{k+1}}{\\binom{2n}{k}} = \\frac{2n-k}{k+1}.\n$$\n对于 $0 \\le k \\le n-1$，我们有 $2n-k \\ge n+1$ 且 $k+1 \\le n$，因此\n$$\n\\frac{2n-k}{k+1} \\ge \\frac{n+1}{n}  1,\n$$\n这表明 $\\binom{2n}{k}$ 在 $k$ 增加到 $n$ 的过程中是递增的。根据对称性 $\\binom{2n}{k} = \\binom{2n}{2n-k}$，该序列是单峰的，并在 $k=n$ 处达到最大值。因此，\n$$\n\\binom{2n}{n} \\ge \\frac{1}{2n+1} \\sum_{k=0}^{2n} \\binom{2n}{k} = \\frac{4^{n}}{2n+1}.\n$$\n这就仅用二项式定理和二项式系数的基本性质证明了不等式 $\\binom{2n}{n} \\ge \\frac{4^{n}}{2n+1}$。等价地，比率\n$$\nR(n) = \\frac{(2n+1)\\binom{2n}{n}}{4^{n}}\n$$\n对所有 $n \\in \\mathbb{N}$ 满足 $R(n) \\ge 1$。\n\n为评估此界对于小 $n$ 值的强度，我们显式地计算当 $n=1,2,\\ldots,10$ 时 $R(n)$ 的值。我们将使用中心二项式系数 $\\binom{2n}{n}$ 和 $4^{n}$ 的精确值。\n\n- 当 $n=1$ 时：$\\binom{2}{1} = 2$，$4^{1} = 4$，$2n+1 = 3$，因此\n$$\nR(1) = \\frac{3 \\cdot 2}{4} = \\frac{6}{4} = \\frac{3}{2}.\n$$\n\n- 当 $n=2$ 时：$\\binom{4}{2} = 6$，$4^{2} = 16$，$2n+1 = 5$，因此\n$$\nR(2) = \\frac{5 \\cdot 6}{16} = \\frac{30}{16} = \\frac{15}{8}.\n$$\n\n- 当 $n=3$ 时：$\\binom{6}{3} = 20$，$4^{3} = 64$，$2n+1 = 7$，因此\n$$\nR(3) = \\frac{7 \\cdot 20}{64} = \\frac{140}{64} = \\frac{35}{16}.\n$$\n\n- 当 $n=4$ 时：$\\binom{8}{4} = 70$，$4^{4} = 256$，$2n+1 = 9$，因此\n$$\nR(4) = \\frac{9 \\cdot 70}{256} = \\frac{630}{256} = \\frac{315}{128}.\n$$\n\n- 当 $n=5$ 时：$\\binom{10}{5} = 252$，$4^{5} = 1024$，$2n+1 = 11$，因此\n$$\nR(5) = \\frac{11 \\cdot 252}{1024} = \\frac{2772}{1024} = \\frac{693}{256}.\n$$\n\n- 当 $n=6$ 时：$\\binom{12}{6} = 924$，$4^{6} = 4096$，$2n+1 = 13$，因此\n$$\nR(6) = \\frac{13 \\cdot 924}{4096} = \\frac{12012}{4096} = \\frac{3003}{1024}.\n$$\n\n- 当 $n=7$ 时：$\\binom{14}{7} = 3432$，$4^{7} = 16384$，$2n+1 = 15$，因此\n$$\nR(7) = \\frac{15 \\cdot 3432}{16384} = \\frac{51480}{16384} = \\frac{6435}{2048}.\n$$\n\n- 当 $n=8$ 时：$\\binom{16}{8} = 12870$，$4^{8} = 65536$，$2n+1 = 17$，因此\n$$\nR(8) = \\frac{17 \\cdot 12870}{65536} = \\frac{218790}{65536} = \\frac{109395}{32768}.\n$$\n\n- 当 $n=9$ 时：$\\binom{18}{9} = 48620$，$4^{9} = 262144$，$2n+1 = 19$，因此\n$$\nR(9) = \\frac{19 \\cdot 48620}{262144} = \\frac{923780}{262144} = \\frac{230945}{65536}.\n$$\n\n- 当 $n=10$ 时：$\\binom{20}{10} = 184756$，$4^{10} = 1048576$，$2n+1 = 21$，因此\n$$\nR(10) = \\frac{21 \\cdot 184756}{1048576} = \\frac{3879876}{1048576} = \\frac{969969}{262144}.\n$$\n\n每个计算出的 $R(n)$ 都严格大于 1，这证实了界 $\\binom{2n}{n} \\ge \\frac{4^{n}}{2n+1}$ 成立，并且对于小的 $n$ 值，该界是严格的。在所列出的值中，最小值出现在 $n=1$ 处，为 $R(1) = \\frac{3}{2}$。因此，当 $n=1,2,\\ldots,10$ 时，$R(n)$ 的最小值是\n$$\n\\min_{1 \\le n \\le 10} R(n) = \\frac{3}{2}.\n$$\n这表明，即使在与伯特兰猜想的论证相关的基础情况检验的最小案例中，该不等式也是稳健的，其比率与 1 有界分离。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "3081802"}, {"introduction": "数论中的存在性定理，如伯特兰猜想，虽然看似抽象，但往往具有实际的计算意义。该猜想保证了在特定区间内质数的存在，但它并没有告诉我们如何找到这个质数。本练习挑战你将这一理论保证转化为一个具体的、确定性的算法，该算法能够可靠地在区间 $(n, 2n)$ 中找到一个质数。这鼓励我们思考如何搭建从理论数学到实际计算的桥梁，并分析其效率。[@problem_id:3081808]", "problem": "设计并论证一个确定性算法，该算法在给定整数 $n \\ge 2$ 的情况下，在开区间 $(n,2n)$ 内找到一个质数，使用以 $\\lfloor \\sqrt{2n} \\rfloor$ 为界的试除法。该算法必须在以下基本依据和约束条件下运行：\n\n- 从以下定义出发：一个整数 $m \\ge 2$ 是质数，当且仅当不存在整数除数 $d$（满足 $2 \\le d \\le \\lfloor \\sqrt{m} \\rfloor$）使得 $d$ 整除 $m$。\n- 使用伯特兰-切比雪夫定理（Bertrand's postulate / Chebyshev's theorem）：对于每个整数 $n \\ge 1$，存在一个质数 $p$ 满足 $n  p \\le 2n$。这确保了对于 $n \\ge 2$，在 $(n,2n)$ 区间内至少存在一个质数。\n- 以保持正确性的方式实现以 $\\lfloor \\sqrt{2n} \\rfloor$ 为界的试除法：对于 $(n,2n)$ 中的每个候选数 $m$，从 $2$ 开始递增地用整数 $d$ 进行整除性检查，一旦 $d^2 > m$ 或找到一个除数，就停止整除性循环。这种提前停止的合理性在于，任何合数 $m$ 都有一个不超过 $\\lfloor \\sqrt{m} \\rfloor$ 的因子。\n\n你的程序必须：\n1. 按递增顺序系统地测试满足 $n  m  2n$ 的连续整数 $m$，应用指定的试除法，并返回找到的第一个质数。这种确定性指的是严格按递增顺序扫描并在最早的质数处停止。\n2. 检测其执行过程以记录：\n   - 找到的质数 $p$。\n   - 在找到 $p$ 之前测试的候选整数数量。\n   - 执行的试除总次数（即，在所有测试的候选数中实际尝试的模运算 $m \\bmod d$ 的总次数）。\n   - 给定 $n$ 的试除次数的最坏情况上界，取值为 $(n-1)\\lfloor \\sqrt{2n} \\rfloor$，该值源于测试 $(n,2n)$ 中的所有 $n-1$ 个整数，并对每个整数可能尝试多达 $\\lfloor \\sqrt{2n} \\rfloor$ 次试除。\n\n在你的解决方案中，分析为什么该算法对于每个 $n \\ge 2$ 都会终止，并使用渐近符号推导以 $n$ 表示的最坏情况时间复杂度，将单次试除视为单位成本。\n\n测试套件和输出规范：\n- 使用以下输入 $n$ 的测试套件：$2$, $3$, $20$, $64$, $1000$, $4096$, $100000$。\n- 对于每个 $n$，生成四元组 $[p,\\text{candidates},\\text{divisions},\\text{upper\\_bound}]$，其中 $p$ 是在 $(n,2n)$ 中找到的质数，$\\text{candidates}$ 是测试的候选数的整数计数，$\\text{divisions}$ 是执行的试除次数的整数计数，$\\text{upper\\_bound}$ 是整数值 $(n-1)\\lfloor \\sqrt{2n} \\rfloor$。\n- 你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，不含空格，并且每个测试用例的结果都格式化为其自己的方括号列表。例如：$[[p_1,c_1,d_1,u_1],[p_2,c_2,d_2,u_2],\\dots]$。", "solution": "问题陈述是有效的。它在已建立的数论中有科学依据，问题定义明确，没有歧义。它描述了一个在区间 $(n, 2n)$ 中寻找质数的确定性算法，通过伯特兰-切比雪夫定理提供了必要的理论论证，并为实现、检测和分析指定了具体要求。\n\n### 算法设计与论证\n\n目标是构建一个确定性算法，对于任何整数 $n \\ge 2$，找到一个质数 $p$ 使得 $n  p  2n$。伯特兰-切比雪夫定理保证了这样一个质数的存在，该定理指出，对于任何整数 $n \\ge 1$，区间 $(n, 2n]$ 至少包含一个质数。对于 $n \\ge 2$，整数 $2n$ 是合数，因此区间 $(n, 2n)$ 必然包含一个质数。\n\n该算法按以下步骤进行：\n1.  初始化一个搜索整数 $m$ 为 $n+1$。\n2.  遍历连续整数 $m = n+1, n+2, n+3, \\dots, 2n-1$。这个严格的递增序列确保了算法的确定性；它将总能找到指定区间内最小的质数。\n3.  对于每个候选整数 $m$，判断它是否为质数。这通过一个质性测试子程序来完成。\n4.  第一个被识别为质数的整数 $m$ 就是期望的结果 $p$。算法终止并返回 $p$ 以及指定的性能指标。\n\n该算法的核心是质性测试。根据规定，该测试基于质数的基本定义：一个整数 $m \\ge 2$ 是质数，当且仅当它不能被 $2 \\le d \\le \\sqrt{m}$ 范围内的任何整数 $d$ 整除。\n\n对候选数 $m$ 的质性测试通过试除法实现：\n1.  初始化一个除数 $d$ 为 $2$。\n2.  只要条件 $d^2 \\le m$ 成立，就遍历除数 $d = 2, 3, 4, \\dots$。\n3.  在每次迭代中，执行模运算 $m \\bmod d$。\n4.  如果对于任何 $d$ 有 $m \\bmod d = 0$，则 $m$ 是合数。对 $m$ 的质性测试结束，主算法继续处理下一个候选数 $m+1$。\n5.  如果循环完成而没有找到任何除数（即 $d^2$ 变得大于 $m$），则 $m$ 在 $[2, \\sqrt{m}]$ 范围内没有除数，因此是质数。\n\n为满足检测要求，需要维护两个计数器：\n-   `candidates`：对于每个进行质性测试的整数 $m$，此计数器都会递增。它从 $m=n+1$ 时的 $1$ 开始，并在找到第一个质数时停止。如果找到的质数是 $p$，则此计数器的值将是 $p - n$。\n-   `divisions`：每次在试除循环中执行模运算（$m \\bmod d$）时，此计数器都会递增。\n\n最后，试除次数的最坏情况上界计算为 $(n-1)\\lfloor \\sqrt{2n} \\rfloor$。这个数字代表了区间 $(n, 2n)$ 中的候选总数（即 $n-1$）与该区间内任何单个候选数的试除次数的统一上界（即 $\\lfloor \\sqrt{2n} \\rfloor$）的乘积。\n\n### 终止性与复杂度分析\n\n**终止性保证：** 该算法保证对任何输入 $n \\ge 2$ 都会终止。伯特兰-切比雪夫定理确保对于任何这样的 $n$，在区间 $(n, 2n)$ 中至少存在一个质数 $p$。由于算法按递增顺序系统地测试此区间中的每个整数，它必然会遇到并识别出这些质数中的第一个，此时算法终止。\n\n**最坏情况时间复杂度：** 计算成本主要由试除操作的次数决定。设单位成本为一次模运算。\n\n该算法由一个遍历候选整数 $m$ 的外层循环和一个用于试除的内层循环组成。\n-   外层循环从 $m=n+1$ 迭代到第一个质数 $p$。在最坏情况下，第一个质数 $p$ 接近 $2n$。这意味着测试的候选数数量约为 $(2n-1) - (n+1) + 1 = n-1$。因此，外层循环的迭代次数为 $O(n)$ 数量级。\n-   内层循环对给定的候选数 $m$ 执行试除。它测试从 $2$ 到 $\\lfloor \\sqrt{m} \\rfloor$ 的除数 $d$。因此，除法次数约为 $\\sqrt{m}$。由于所有候选数都满足 $n  m  2n$，测试单个候选数 $m$ 的成本上界为 $O(\\sqrt{2n}) = O(\\sqrt{n})$。\n\n总的最坏情况时间复杂度 $T(n)$ 是测试的候选数数量与每个候选数最大成本的乘积。\n$$ T(n) = (\\text{候选数}) \\times (\\text{每个候选数的成本}) $$\n$$ T(n) \\approx O(n) \\times O(\\sqrt{n}) = O(n\\sqrt{n}) = O(n^{3/2}) $$\n\n更正式地说，最坏情况下除法总次数的上限是所有候选数从 $n+1$ 到 $2n-1$ 的除法次数之和：\n$$ \\text{总除法次数} \\le \\sum_{m=n+1}^{2n-1} \\lfloor \\sqrt{m} \\rfloor $$\n我们可以为这个和找到一个上界：\n$$ \\sum_{m=n+1}^{2n-1} \\lfloor \\sqrt{m} \\rfloor \\le \\sum_{m=n+1}^{2n-1} \\sqrt{2n} = (n-1)\\sqrt{2n} $$\n该表达式主要由 $n \\cdot \\sqrt{n}$ 项决定，证实了该算法的最坏情况时间复杂度为 $O(n^{3/2})$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Finds the first prime in (n, 2n) and reports performance metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [2, 3, 20, 64, 1000, 4096, 100000]\n\n    results = []\n    for n in test_cases:\n        # Initialize instrumentation variables for the current n\n        prime_found = 0\n        candidates_tested = 0\n        total_divisions = 0\n\n        # Calculate the worst-case upper bound as specified\n        # Note: 2n is a non-inclusive upper bound for the interval (n, 2n)\n        upper_bound = (n - 1) * int(np.sqrt(2 * n))\n\n        # Iterate through candidates m in the open interval (n, 2n)\n        for m in range(n + 1, 2 * n):\n            candidates_tested += 1\n            is_m_prime = True\n\n            # Primality test using trial division bounded by sqrt(m)\n            # The loop for divisor d runs as long as d*d = m\n            d = 2\n            while d * d = m:\n                total_divisions += 1\n                if m % d == 0:\n                    is_m_prime = False\n                    break\n                d += 1\n            \n            if is_m_prime:\n                prime_found = m\n                # Found the first prime, so we can stop searching.\n                break\n\n        # Store the result for this test case\n        results.append([prime_found, candidates_tested, total_divisions, upper_bound])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, with no spaces. str() adds spaces, so we remove them.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```", "id": "3081808"}]}