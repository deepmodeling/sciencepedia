{"hands_on_practices": [{"introduction": "要真正理解一个算法，除了掌握其原理，亲手计算并观察其行为同样重要。欧几里得算法以其惊人的效率而闻名，但其执行步数并非固定不变，而是取决于输入数值的特性。这个练习将通过一个经典场景——计算相邻斐波那契数的最大公约数——来让你直观感受算法的执行过程。你会发现，这种情况恰好是欧几里得算法的“最坏情况”之一，即对于给定大小的数，它需要最多的除法步骤，这为我们后续探讨算法效率提供了绝佳的切入点。[@problem_id:1406864]", "problem": "在计算机科学中，分析算法的性能是一项基本任务。欧几里得算法是计算两个整数最大公约数 (GCD) 的经典方法。其效率通常通过算法终止所需的除法步骤数来衡量。人们已经观察到，连续的斐波那契数代表了该算法的一种“最坏情况”输入场景，与输入数值的大小相比，它需要相对较多的步骤。\n\n斐波那契数列由递推关系 $F_n = F_{n-1} + F_{n-2}$（对于 $n \\ge 2$）定义，初始值为 $F_0 = 0$ 和 $F_1 = 1$。\n\n你的任务是分析这种行为的一个具体实例。考虑第12和第13个斐波那契数，即 $F_{12} = 144$ 和 $F_{13} = 233$。使用标准的欧几里得算法，确定计算 $233$ 和 $144$ 的最大公约数所需的除法步骤数。单个步骤定义为一次形式为 $a = qb + r$ 的除法算法应用，其中 $q$ 是商，$r$ 是余数。", "solution": "我们应用标准的欧几里得算法，其中每一步都是一次形式为 $a = qb + r$ 且满足 $0 \\le r  b$ 的除法，直到余数变为 $0$。从 $a = 233$ 和 $b = 144$ 开始：\n$$233 = 1 \\cdot 144 + 89$$\n$$144 = 1 \\cdot 89 + 55$$\n$$89 = 1 \\cdot 55 + 34$$\n$$55 = 1 \\cdot 34 + 21$$\n$$34 = 1 \\cdot 21 + 13$$\n$$21 = 1 \\cdot 13 + 8$$\n$$13 = 1 \\cdot 8 + 5$$\n$$8 = 1 \\cdot 5 + 3$$\n$$5 = 1 \\cdot 3 + 2$$\n$$3 = 1 \\cdot 2 + 1$$\n$$2 = 2 \\cdot 1 + 0$$\n在余数变为 $0$ 之前，共有 $11$ 次除法算法的应用，所以除法步骤数为 $11$。作为一致性检验，对于连续的斐波那契数 $F_{n+1}$ 和 $F_{n}$（其中 $n \\ge 2$），欧几里得算法需要 $n-1$ 步；这里 $n = 12$，得出 $12 - 1 = 11$ 步，与直接计算的结果相符。", "answer": "$$\\boxed{11}$$", "id": "1406864"}, {"introduction": "欧几里得算法的精髓远不止于计算一个简单的数字。它揭示了一个深刻的数论结构，即贝祖等式（Bézout's identity）所描述的整数线性组合。这个练习将引导你从第一性原理出发，证明由任意整数$x$和$y$构成的线性组合$|ax+by|$的最小正值恰好就是$a$和$b$的最大公约数。通过这个实践，你将不再仅仅将最大公约数看作一个计算结果，而是理解其作为所有线性组合的“基本构造块”的根本地位。[@problem_id:3090818]", "problem": "设 $a$ 和 $b$ 为不全为零的整数。考虑集合 $S=\\{|ax+by|: x,y \\in \\mathbb{Z}\\}$。请仅使用除法算法和整除性的性质，解释为什么 $S$ 有一个最小正元素，以及为什么欧几里得算法能高效地找到这个值。然后，对于具体的整数 $a=31784$ 和 $b=19532$，使用欧几里得算法确定 $|ax+by|$ 的最小正值。最后，根据 $a$、$b$ 以及扩展欧几里得算法的输出，一般性地刻画出所有使这个最小正值得以实现的整数对 $(x,y)$。你的最终答案应该是针对给定的 $a$ 和 $b$ 的唯一最小正值，它是一个精确的整数，没有四舍五入。", "solution": "首先，我们讨论集合 $S=\\{|ax+by|: x,y \\in \\mathbb{Z}\\}$ 中最小正元素的存在性。我们定义一个相关集合 $S' = \\{ ax+by : x,y \\in \\mathbb{Z} \\text{ 且 } ax+by > 0 \\}$。集合 $S'$ 是所有可以表示为 $a$ 和 $b$ 的线性组合的正整数值的集合。为了证明 $S'$ 有一个最小元素，我们必须首先确定存在一个正元素，即 $S'$ 是非空的。由于 $a$ 和 $b$ 不全为零，它们中至少有一个非零。不失一般性，假设 $a \\neq 0$。通过选择 $x=a$ 和 $y=0$，我们得到线性组合 $a(a) + b(0) = a^2$。因为 $a$ 是一个非零整数，所以 $a^2$ 是一个正整数。因此，$a^2 \\in S'$，这证明了 $S'$ 是一个非空的正整数集合。根据良序原则，任何非空的正整数集合必有最小元素。因此，$S'$ 拥有一个最小元素。设这个最小正元素为 $d$。根据定义，$S$ 的最小正元素就是这个值 $d$。\n\n接下来，我们证明这个最小正元素 $d$ 正是 $a$ 和 $b$ 的最大公约数，记为 $\\gcd(a,b)$。根据 $d$ 作为 $S'$ 最小正元素的定义，存在整数 $x_0$ 和 $y_0$ 使得 $d = ax_0 + by_0$。我们现在使用除法算法来证明 $d$ 同时整除 $a$ 和 $b$。任何整数，包括 $a$，都可以用 $d$ 表示为 $a = qd + r$，其中 $q$ 是商，$r$ 是满足 $0 \\le r  d$ 的余数。我们可以将余数 $r$ 表示为 $a$ 和 $b$ 的线性组合：\n$$ r = a - qd = a - q(ax_0 + by_0) = a(1-qx_0) + b(-qy_0) $$\n这个表达式表明 $r$ 是线性组合集合 $\\{ax+by\\}$ 中的一个元素。由于 $0 \\le r  d$ 且 $d$ 被定义为*最小正*线性组合，余数 $r$ 不可能是一个正整数。唯一可能性是 $r=0$。如果 $r=0$，那么 $a = qd$，这意味着 $d$ 整除 $a$。通过完全相同的论证，$d$ 也必须整除 $b$。因此，$d$ 是 $a$ 和 $b$ 的一个公约数。\n\n现在，设 $c$ 是 $a$ 和 $b$ 的任意一个公约数。这意味着对于某些整数 $k$ 和 $l$，有 $a = ck$ 和 $b = cl$。将这些代入 $d$ 的表达式中：\n$$ d = ax_0 + by_0 = (ck)x_0 + (cl)y_0 = c(kx_0 + ly_0) $$\n这表明任何公约数 $c$ 都必须整除 $d$。一个能被所有其他公约数 $c$ 整除的公约数 $d$，根据定义，就是最大公约数。因此，$d = \\gcd(a,b)$。这个结果被称为裴蜀恒等式。\n\n欧几里得算法是一个通过重复应用除法算法来计算两个整数的最大公约数的过程。该算法的一个基本性质是，它生成的最后一个非零余数就是最大公约数。既然我们已经证明 $|ax+by|$ 的最小正值是 $\\gcd(a,b)$，欧几里得算法直接计算了这个值。\n\n我们现在将欧几里得算法应用于具体的整数 $a=31784$ 和 $b=19532$。\n\\begin{align*} 31784 = 1 \\cdot 19532 + 12252 \\\\ 19532 = 1 \\cdot 12252 + 7280 \\\\ 12252 = 1 \\cdot 7280 + 4972 \\\\ 7280 = 1 \\cdot 4972 + 2308 \\\\ 4972 = 2 \\cdot 2308 + 356 \\\\ 2308 = 6 \\cdot 356 + 172 \\\\ 356 = 2 \\cdot 172 + 12 \\\\ 172 = 14 \\cdot 12 + 4 \\\\ 12 = 3 \\cdot 4 + 0 \\end{align*}\n最后一个非零余数是 $4$。因此，$|31784x + 19532y|$ 的最小正值是 $4$。\n\n最后，我们刻画出所有满足 $|ax+by| = d$（其中 $d=\\gcd(a,b)$）的整数对 $(x,y)$ 的集合。这等价于求解线性丢番图方程 $ax+by=d$。扩展欧几里得算法提供了一种找到该方程一个特解 $(x_p, y_p)$ 的方法。为了找到通解，我们考虑相关的齐次方程 $ax+by=0$，可以重写为 $\\frac{a}{d}x = -\\frac{b}{d}y$。由于 $\\frac{a}{d}$ 和 $\\frac{b}{d}$ 是互质的，齐次方程的通解是 $(x_h, y_h) = (k \\frac{b}{d}, -k \\frac{a}{d})$，其中 $k \\in \\mathbb{Z}$ 是任意整数。$ax+by=d$ 的通解是一个特解与齐次方程通解之和：\n$$ (x,y) = \\left( x_p + k \\frac{b}{d}, y_p - k \\frac{a}{d} \\right) \\quad \\text{for } k \\in \\mathbb{Z} $$\n这描述了所有满足 $ax+by=d$ 的数对 $(x,y)$。所有满足 $ax+by=-d$ 的数对也构成了满足 $|ax+by|=d$ 的解，其通解形式为 $(-x_p + k \\frac{b}{d}, -y_p - k \\frac{a}{d})$。因此，完整的解集是这两族解的并集。", "answer": "$$\\boxed{4}$$", "id": "3090818"}, {"introduction": "掌握了欧几里得算法的机制和其背后的贝祖等式，我们便拥有了解决数论中一类核心问题的强大工具：线性同余方程。这类方程在密码学、编码理论和计算机科学中无处不在。本练习将理论与应用相结合，要求你使用扩展欧几里得算法求解一个具体的线性同余方程，并从根本上证明解的数量和结构。它完美地展示了如何将一个古老的算法转化为解决现代计算问题的实用技术。[@problem_id:3090833]", "problem": "设 $a$, $b$, $m$ 为整数，其中 $m \\geq 2$。从最大公约数和模 $m$ 同余的核心定义出发，结合贝祖等式（存在整数 $u$ 和 $v$ 使得 $a u + m v = \\gcd(a,m)$）以及欧几里得算法的基本终止性质。证明以下命题，然后进行一个具体的计算。\n\n1. 证明如果线性同余方程 $a x \\equiv b \\pmod{m}$ 有解，那么它模 $m$ 的解集恰好由 $d = \\gcd(a,m)$ 个不同的剩余类组成。你的论证应从命题 $m \\mid a x - b$ 开始，并且只使用前述的基本事实。\n\n2. 通过推导欧几里得算法计算 $\\gcd(a,m)$ 所需除法步骤数的一个关于 $m$ 的对数的显式上界，来解释为什么扩展欧几里得算法（EEA, Extended Euclidean Algorithm）能高效地得出一个解。你的推导应基于该算法产生的余数的递推关系和基本估计；不要假定任何现成的复杂度结论。\n\n3. 将你的推理应用于具体实例 $a = 414$, $m = 662$, $b = 48$。使用扩展欧几里得算法计算 $414 x \\equiv 48 \\pmod{662}$ 的最小非负解 $x$。最终答案只需报告这个最小非负解 $x$ 的值。无需四舍五入。", "solution": "1. 关于线性同余方程解的个数的证明。\n\n题目要求我们证明，如果线性同余方程 $a x \\equiv b \\pmod{m}$ 有解，那么它的解集由模 $m$ 的恰好 $d = \\gcd(a,m)$ 个不同剩余类组成。\n设 $d = \\gcd(a,m)$。线性同余方程 $a x \\equiv b \\pmod{m}$ 有解的条件是 $d \\mid b$。问题陈述的前提是至少存在一个解。我们称这个解为 $x_0$。\n根据同余的定义，$a x_0 \\equiv b \\pmod{m}$ 意味着 $m \\mid (a x_0 - b)$。\n\n设 $x$ 是该同余方程的任意解。那么，我们有：\n$a x \\equiv b \\pmod{m}$\n$a x_0 \\equiv b \\pmod{m}$\n\n用第一个同余式减去第二个同余式得到：\n$a(x - x_0) \\equiv 0 \\pmod{m}$\n\n根据同余的定义，这意味着 $m \\mid a(x - x_0)$。\n设 $d = \\gcd(a,m)$。我们可以将 $a$ 和 $m$ 写成 $a = da'$ 和 $m = dm'$，其中 $a'$ 和 $m'$ 是整数，且 $\\gcd(a', m') = 1$。将这些代入整除关系中：\n$dm' \\mid da'(x - x_0)$\n\n由于 $d \\ge 1$，我们可以将两边同时除以 $d$：\n$m' \\mid a'(x - x_0)$\n\n由于 $\\gcd(a', m') = 1$，根据欧几里得引理，我们必然有：\n$m' \\mid (x - x_0)$\n\n这意味着 $x - x_0$ 是 $m'$ 的倍数。所以，$x - x_0 = k m'$，其中 $k$ 是某个整数。代入 $m' = m/d$：\n$x = x_0 + k \\frac{m}{d}$\n\n这个表达式给出了所有可能的整数解 $x$。现在，我们需要确定这些解中有多少个是模 $m$ 不同的。我们考虑 $k = 0, 1, 2, \\dots, d-1$ 这些值。这给出了如下解集：\n$S = \\{x_0, x_0 + \\frac{m}{d}, x_0 + 2\\frac{m}{d}, \\dots, x_0 + (d-1)\\frac{m}{d}\\}$\n\n首先，这 $d$ 个解是模 $m$ 不同的。假设对于两个整数 $i, j$ 满足 $0 \\le j  i \\le d-1$，我们有：\n$x_0 + i \\frac{m}{d} \\equiv x_0 + j \\frac{m}{d} \\pmod{m}$\n那么 $i \\frac{m}{d} \\equiv j \\frac{m}{d} \\pmod{m}$，这意味着 $m \\mid (i-j)\\frac{m}{d}$。\n这意味着存在一个整数 $q$ 使得 $(i-j)\\frac{m}{d} = qm$。两边同时除以 $m$ 得到 $\\frac{i-j}{d} = q$，这意味着 $d \\mid (i-j)$。\n然而，根据我们对 $i$ 和 $j$ 的选择，我们有 $0  i-j  d$。一个严格小于 $d$ 的正整数不可能被 $d$ 整除。这是一个矛盾。因此，集合 $S$ 中的 $d$ 个解都是模 $m$ 不同的。\n\n其次，该同余方程的任何解都与这 $d$ 个解中的一个同余。设 $x$ 是任意解，则 $x = x_0 + k \\frac{m}{d}$，其中 $k$ 是某个整数。根据带余除法算法，我们可以将 $k$ 写成 $k = qd + r$，其中 $q$ 和 $r$ 是整数且 $0 \\le r \\le d-1$。\n代入 $x$ 的表达式中：\n$x = x_0 + (qd + r)\\frac{m}{d} = x_0 + qm + r\\frac{m}{d}$\n考虑此方程模 $m$ 的情况：\n$x \\equiv x_0 + r\\frac{m}{d} \\pmod{m}$\n由于 $0 \\le r \\le d-1$，项 $x_0 + r\\frac{m}{d}$ 是集合 $S$ 中的 $d$ 个解之一。因此，任何解都与这 $d$ 个解中的一个同余。\n\n这就完成了证明：模 $m$ 恰好有 $d=\\gcd(a,m)$ 个不同的解。\n\n2. 欧几里得算法的效率。\n扩展欧几里得算法（EEA）与标准欧几里得算法具有相同数量的除法步骤。设算法的输入为 $r_0$ 和 $r_1$（对应于 $m$ 和 $a$），算法生成一个余数序列：\n$r_{i} = q_{i+1} r_{i+1} + r_{i+2}$, with $0 \\le r_{i+2}  r_{i+1}$\n设 $n$ 是除法步骤的次数。我们来分析余数的下降速率。\n由于 $r_{i+1} > r_{i+2}$，商 $q_{i+1} \\ge 1$。\n所以，$r_i = q_{i+1} r_{i+1} + r_{i+2} \\ge r_{i+1} + r_{i+2} > r_{i+2} + r_{i+2} = 2r_{i+2}$。\n这给了我们不等式 $r_{i+2}  \\frac{1}{2} r_i$。\n\n这个不等式表明，每两步，余数就会减少一半以上。\n对于从 $r_0=m, r_1=a$ 开始的序列，我们有：\n$r_{2k}  \\frac{m}{2^k}$\n$r_{2k+1}  \\frac{a}{2^k}$\n算法执行 $n$ 步，最后一个非零余数 $r_n \\ge 1$。\n如果 $n=2k$，则 $1 \\le r_{2k}  \\frac{m}{2^k}$，这意味着 $2^k  m$，所以 $k  \\log_2(m)$。步骤数 $n = 2k  2\\log_2(m)$。\n如果 $n=2k+1$，则 $1 \\le r_{2k+1}  \\frac{a}{2^k}$，这意味着 $2^k  a  m$，所以 $k  \\log_2(m)$。步骤数 $n = 2k+1  2\\log_2(m) + 1$。\n\n在所有情况下，步骤数 $n$ 都受限于 $2\\log_2(m)+1$。我们可以用自然对数来表示这个界：\n$n \\le 2\\frac{\\ln(m)}{\\ln(2)} + 1$。\n这表明除法步骤的数量最多是 $m$ 的对数的线性函数，因此算法是高效的。\n\n3. 应用于 $414 x \\equiv 48 \\pmod{662}$。\n给定 $a = 414, b = 48, m = 662$。首先，我们使用欧几里得算法计算 $d = \\gcd(414, 662)$：\n$662 = 1 \\cdot 414 + 248$\n$414 = 1 \\cdot 248 + 166$\n$248 = 1 \\cdot 166 + 82$\n$166 = 2 \\cdot 82 + 2$\n$82 = 41 \\cdot 2 + 0$\n最大公约数是 $d = 2$。由于 $d=2$ 整除 $b=48$，所以解存在。\n\n为了找到一个特解，我们使用扩展欧几里得算法将 $d$ 表示为 $a$ 和 $m$ 的线性组合：$414u + 662v = 2$。我们从除法步骤逆向回代：\n$2 = 166 - 2 \\cdot 82$\n$2 = 166 - 2 \\cdot (248 - 1 \\cdot 166) = 3 \\cdot 166 - 2 \\cdot 248$\n$2 = 3 \\cdot (414 - 1 \\cdot 248) - 2 \\cdot 248 = 3 \\cdot 414 - 5 \\cdot 248$\n$2 = 3 \\cdot 414 - 5 \\cdot (662 - 1 \\cdot 414) = 8 \\cdot 414 - 5 \\cdot 662$\n\n所以，我们找到了 $8 \\cdot 414 - 5 \\cdot 662 = 2$。\n考虑此方程模 $662$ 的情况：$8 \\cdot 414 \\equiv 2 \\pmod{662}$。\n我们想要求解 $414x \\equiv 48 \\pmod{662}$。我们将找到的同余式乘以一个因子 $48/d = 48/2 = 24$：\n$24 \\cdot (8 \\cdot 414) \\equiv 24 \\cdot 2 \\pmod{662}$\n$(24 \\cdot 8) \\cdot 414 \\equiv 48 \\pmod{662}$\n$192 \\cdot 414 \\equiv 48 \\pmod{662}$\n\n因此，一个特解是 $x_0 = 192$。\n通解由 $x = x_0 + k \\frac{m}{d} = 192 + k \\frac{662}{2} = 192 + 331k$ 给出，其中 $k$ 是任意整数。\n我们寻找最小的非负解。\n当 $k=0$ 时，$x = 192$。这是非负的。\n当 $k=-1$ 时，$x = 192 - 331 = -139$。\n因此，最小的非负解是 $192$。", "answer": "$$\\boxed{192}$$", "id": "3090833"}]}