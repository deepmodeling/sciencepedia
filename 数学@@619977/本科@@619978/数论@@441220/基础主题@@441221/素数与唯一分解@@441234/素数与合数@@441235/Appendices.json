{"hands_on_practices": [{"introduction": "掌握质数和合数的核心技能之一，是能够将一个数分解为其质因数。虽然对于任意大数来说这都非常困难，但我们可以利用代数恒等式来巧妙地处理具有特定形式的数。这个练习 [@problem_id:1392417] 将指导你如何系统地运用平方差和立方和/差公式，将一个看似庞大的数字逐步分解，最终找到其所有独特的质因数。", "problem": "考虑由表达式 $N = 3^{12} - 2^{12}$ 定义的整数 $N$。您的任务是找出这个整数的所有不同质因数，然后计算它们的和。最终结果应为一个整数。", "solution": "设 $N = 3^{12} - 2^{12}$。使用平方差公式：\n$$\nN = (3^{6} - 2^{6})(3^{6} + 2^{6}).\n$$\n令 $A = 3^{2}$ 且 $B = 2^{2}$，因此 $3^{6} = A^{3}$ 且 $2^{6} = B^{3}$。然后应用立方差和立方和公式：\n$$\n3^{6} - 2^{6} = A^{3} - B^{3} = (A - B)(A^{2} + AB + B^{2}),\n$$\n$$\n3^{6} + 2^{6} = A^{3} + B^{3} = (A + B)(A^{2} - AB + B^{2}).\n$$\n当 $A = 9$ 且 $B = 4$ 时，计算每个因式：\n$$\nA - B = 9 - 4 = 5,\\quad A^{2} + AB + B^{2} = 81 + 36 + 16 = 133,\n$$\n$$\nA + B = 9 + 4 = 13,\\quad A^{2} - AB + B^{2} = 81 - 36 + 16 = 61.\n$$\n因此，\n$$\nN = (5)(133)(13)(61).\n$$\n分解 $133$：\n$$\n133 = 7 \\times 19.\n$$\n所以，\n$$\nN = 5 \\times 7 \\times 13 \\times 19 \\times 61.\n$$\n因为 $\\gcd(3^{6} - 2^{6}, 3^{6} + 2^{6}) = 1$ （它们都是奇数，且对于 $\\gcd(3^{6},2^{6})=1$ 有 $\\gcd(a-b,a+b) \\mid 2\\gcd(a,b)$），所以这些质因数是互不相同的。不同的质因数集合为 $\\{5, 7, 13, 19, 61\\}$。\n\n它们的和是\n$$\n5 + 7 + 13 + 19 + 61 = 105.\n$$", "answer": "$$\\boxed{105}$$", "id": "1392417"}, {"introduction": "当面对没有特殊代数结构的数字时，我们需要一个更通用的方法来判断其素性。这个练习 [@problem_id:3091200] 介绍了一个基本但非常强大的算法：试除法，这是素性测试的基石。你将首先从第一性原理证明为何只需测试到其平方根 $ \\sqrt{n} $ 的因子，然后将此方法应用于一个具体数字，体验寻找质因数的系统化过程。", "problem": "设 $n$ 是一个正整数。一个大于等于 $2$ 的数 $p$ 被称为素数，如果它的正因数只有 $1$ 和 $p$。一个大于等于 $2$ 的数 $n$ 被称为合数，如果它有一个非平凡因式分解 $n = ab$，其中 $a,b \\in \\mathbb{Z}$，$1  a  n$ 且 $1  b  n$。算术基本定理（FTA）断言，每个大于等于 $2$ 的整数 $n$ 都可以唯一地（不计顺序）写成素数幂的乘积。从这些定义和事实出发，首先根据基本原理证明，要确定 $n$ 是素数还是合数，只需测试其能否被不大于 $\\sqrt{n}$ 的整数整除。然后应用此推理来确定 $8051$ 的唯一素因数分解，并使用以其平方根为界的整除性检验来证明你发现的任何非平凡因数的素性。将你的最终答案表示为素数的乘积。不需要四舍五入。", "solution": "该问题包含两个部分。首先，我们必须从基本原理出发，证明对于一个给定的整数 $n \\geq 2$，要确定 $n$ 是素数还是合数，只需测试其能否被不大于 $\\sqrt{n}$ 的整数整除。其次，我们必须应用此原理来找到整数 $n=8051$ 的唯一素因数分解。\n\n第一部分：素性检验界的证明\n\n设 $n \\geq 2$ 是一个整数。问题要求我们确定 $n$ 是素数还是合数。根据所给定义，如果 $n$ 是合数，它可以被写成乘积 $n = ab$ 的形式，其中 $a$ 和 $b$ 是满足 $1  a  n$ 和 $1  b  n$ 的整数。\n\n不失一般性，我们排列这些因数，使得 $a \\leq b$。\n我们现在用反证法证明 $a$ 必须小于或等于 $\\sqrt{n}$。让我们假设其反面成立，即 $a > \\sqrt{n}$。\n因为我们已经确定 $a \\leq b$，我们的假设 $a > \\sqrt{n}$ 意味着 $b$ 也必须大于 $\\sqrt{n}$。\n如果我们将这两个不等式相乘，$a > \\sqrt{n}$ 和 $b > \\sqrt{n}$，我们得到：\n$$ab > \\sqrt{n} \\cdot \\sqrt{n}$$\n代入 $n=ab$，我们得到：\n$$n > n$$\n这是一个逻辑矛盾。因此，我们最初的假设 $a > \\sqrt{n}$ 必定是错误的。\n由此得出结论，较小的因数 $a$ 必须满足不等式 $a \\leq \\sqrt{n}$。\n所以，如果一个整数 $n$ 是合数，它必须至少有一个除 $1$ 以外的因数 $a$，使得 $a \\leq \\sqrt{n}$。\n根据算术基本定理，这个因数 $a$ 本身必须有一个素因数 $p$。由于 $p$ 是 $a$ 的一个因数，我们有 $p \\leq a$。将此与我们推导出的结果相结合，我们得到 $p \\leq a \\leq \\sqrt{n}$。\n这意味着任何合数 $n$ 都必须有一个素因数 $p$ 满足 $p \\leq \\sqrt{n}$。\n\n因此，要确定一个整数 $n$ 是否是素数，我们只需要测试它能否被不大于 $\\lfloor\\sqrt{n}\\rfloor$ 的素数整除。如果没有找到这样的素因数，这意味着 $n$ 不可能是合数，因此，它必定是素数。测试其能否被所有不大于 $\\lfloor\\sqrt{n}\\rfloor$ 的整数整除也同样充分，尽管效率较低。\n\n第二部分：$8051$ 的素因数分解\n\n我们的任务是找出 $n = 8051$ 的唯一素因数分解。我们应用上面建立的原理。\n\n首先，我们计算 $8051$ 的平方根来确定我们整除性检验的上限。\n$$(\\sqrt{8051})^2 = 8051$$\n我们知道 $89^2 = 7921$ 且 $90^2 = 8100$。因此，$\\sqrt{8051}$ 在 $89$ 和 $90$ 之间。\n$$\\lfloor\\sqrt{8051}\\rfloor = 89$$\n我们需要测试其能否被满足 $p \\leq 89$ 的素数 $p$ 整除。这些素数的列表是：\n$2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89$。\n\n我们进行试除法：\n- 能否被 $2$ 整除：$8051$ 是奇数，所以不能被 $2$ 整除。\n- 能否被 $3$ 整除：各位数字之和是 $8+0+5+1=14$，不能被 $3$ 整除。所以 $8051$ 不能被 $3$ 整除。\n- 能否被 $5$ 整除：末位数字是 $1$，不是 $0$ 或 $5$。所以 $8051$ 不能被 $5$ 整除。\n- 能否被 $7$ 整除：$8051 = 7 \\times 1150 + 1$。不能被 $7$ 整除。\n- 能否被 $11$ 整除：交错位和是 $1-5+0-8 = -12$。不能被 $11$ 整除。\n- 能否被 $13$ 整除：$8051 = 13 \\times 619 + 4$。不能被 $13$ 整除。\n- 能否被 $17$ 整除：$8051 = 17 \\times 473 + 10$。不能被 $17$ 整除。\n- 能否被 $19$ 整除：$8051 = 19 \\times 423 + 14$。不能被 $19$ 整除。\n- 能否被 $23$ 整除：$8051 = 23 \\times 350 + 1$。不能被 $23$ 整除。\n- 能否被 $29$ 整除：$8051 = 29 \\times 277 + 18$。不能被 $29$ 整除。\n- 能否被 $31$ 整除：$8051 = 31 \\times 259 + 22$。不能被 $31$ 整除。\n- 能否被 $37$ 整除：$8051 = 37 \\times 217 + 22$。不能被 $37$ 整除。\n- 能否被 $41$ 整除：$8051 = 41 \\times 196 + 15$。不能被 $41$ 整除。\n- 能否被 $43$ 整除：$8051 = 43 \\times 187 + 10$。不能被 $43$ 整除。\n- 能否被 $47$ 整除：$8051 = 47 \\times 171 + 14$。不能被 $47$ 整除。\n- 能否被 $53$ 整除：$8051 = 53 \\times 151 + 48$。不能被 $53$ 整除。\n- 能否被 $59$ 整除：$8051 = 59 \\times 136 + 27$。不能被 $59$ 整除。\n- 能否被 $61$ 整除：$8051 = 61 \\times 131 + 60$。不能被 $61$ 整除。\n- 能否被 $67$ 整除：$8051 = 67 \\times 120 + 11$。不能被 $67$ 整除。\n- 能否被 $71$ 整除：$8051 = 71 \\times 113 + 28$。不能被 $71$ 整除。\n- 能否被 $73$ 整除：$8051 = 73 \\times 110 + 21$。不能被 $73$ 整除。\n- 能否被 $79$ 整除：$8051 = 79 \\times 101 + 72$。不能被 $79$ 整除。\n- 能否被 $83$ 整除：$8051 \\div 83$。我们进行除法运算：$8051 = 83 \\times 90 + 581$。而 $581 = 83 \\times 7$。因此，$8051 = 83 \\times 90 + 83 \\times 7 = 83 \\times (90+7) = 83 \\times 97$。\n\n我们找到了一个因式分解：$8051 = 83 \\times 97$。\n\n现在我们必须使用相同的原理来证明因数 $83$ 和 $97$ 是素数。\n\n$83$ 的素性证明：\n我们需要测试其能否被不大于 $\\lfloor\\sqrt{83}\\rfloor$ 的素因数整除。因为 $9^2 = 81$ 且 $10^2 = 100$，我们有 $\\lfloor\\sqrt{83}\\rfloor = 9$。\n需要测试的素数是 $2, 3, 5, 7$。\n- $83$ 不能被 $2$ 整除（它是奇数）。\n- $8+3=11$，不能被 $3$ 整除。\n- 末位不是 $0$ 或 $5$，不能被 $5$ 整除。\n- $83 = 7 \\times 11 + 6$，不能被 $7$ 整除。\n由于 $83$ 没有小于或等于其平方根的素因数，所以 $83$ 是一个素数。\n\n$97$ 的素性证明：\n我们需要测试其能否被不大于 $\\lfloor\\sqrt{97}\\rfloor$ 的素因数整除。因为 $9^2 = 81$ 且 $10^2 = 100$，我们有 $\\lfloor\\sqrt{97}\\rfloor = 9$。\n需要再次测试的素数是 $2, 3, 5, 7$。\n- $97$ 不能被 $2$ 整除（它是奇数）。\n- $9+7=16$，不能被 $3$ 整除。\n- 末位不是 $0$ 或 $5$，不能被 $5$ 整除。\n- $97 = 7 \\times 13 + 6$，不能被 $7$ 整除。\n由于 $97$ 没有小于或等于其平方根的素因数，所以 $97$ 是一个素数。\n\n$83$ 和 $97$ 这两个因数都是素数。因此，$8051$ 的唯一素因数分解是这两个素数的乘积。", "answer": "$$\\boxed{83 \\times 97}$$", "id": "3091200"}, {"introduction": "随着数字变得极大（例如在现代密码学中），试除法在计算上变得不可行。因此，我们转向更高效的概率性素性测试，如米勒-拉宾测试。这个练习 [@problem_id:3088449] 让你亲身体验该测试的核心思想，通过验证一个著名的“强伪素数”，理解为什么有些合数能“伪装”成素数，从而揭示设计可靠素性算法的微妙与挑战。", "problem": "在本问题中，您将验证一个特定的合数是关于给定底数的强伪素数，并计算在强可能素数检验中使用的相关参数。仅使用关于模运算、素数和合数的基本定义和经过验证的事实。\n\n令底为 $a=2$ 并考虑整数 $n=2047$。您将验证 $n$ 是合数，检查 $\\gcd(a,n)=1$（其中 $\\gcd$ 表示最大公约数(GCD)），然后通过分析 $n-1$ 分解为 $n-1=2^{s} d$（其中 $d$ 为奇数）的形式，来确定 $n$ 是否是关于底 $a$ 的强伪素数。使用以下定义：一个奇合数 $n$，若满足 $\\gcd(a,n)=1$，且满足 $a^{d} \\equiv 1 \\pmod{n}$ 或存在某个整数 $r$（$0 \\le r  s$）使得 $a^{2^{r} d} \\equiv -1 \\pmod{n}$，则称 $n$ 是关于底 $a$ 的强伪素数。\n\n计算分解式 $n-1=2^{s} d$（其中 $d$ 为奇数）中的参数 $s$ 和 $d$。然后，仅使用模运算的性质，根据上述定义验证 $n$ 是关于底 $a$ 的强伪素数。将您的最终答案报告为包含 $s$ 和 $d$ 的行矩阵，使用 LaTeX 的 $\\texttt{pmatrix}$ 环境书写。无需四舍五入。", "solution": "首先，验证 $n=2047$ 是一个合数。\n为了确定 $n=2047$ 是否是合数，我们寻找除 $1$ 和 $2047$ 之外的整数因子。我们可以测试是否能被小的素数整除。整数 $n=2047$ 不能被 $2$、$3$ 或 $5$ 整除。我们测试更大的素数。\n对于素数 $p=23$：\n$$\n2047 = 23 \\times q + r\n$$\n将 $2047$ 除以 $23$：\n$$\n2047 = 23 \\times 80 + (2047 - 1840) = 23 \\times 80 + 207\n$$\n我们检查 $207$ 是否能被 $23$ 整除：\n$$\n207 = 23 \\times 9\n$$\n因此，\n$$\n2047 = 23 \\times 80 + 23 \\times 9 = 23 \\times (80+9) = 23 \\times 89\n$$\n由于 $23$ 和 $89$ 都是素数，我们找到了 $2047$ 的一个非平凡因式分解。因此，$n=2047$ 是一个合数。\n\n其次，检查 $\\gcd(a,n)=1$。\n底为 $a=2$，整数为 $n=2047$。最大公约数 $\\gcd(2, 2047)$ 是能同时整除 $2$ 和 $2047$ 的最大正整数。由于 $n=2047$ 是一个奇数，其素因子（$23$ 和 $89$）都是奇数。因此，$2$ 不是 $2047$ 的因子。$2$ 的正因数只有 $1$ 和 $2$。因为 $2$ 不能整除 $2047$，所以最大公约数必须是 $1$。\n$$\n\\gcd(2, 2047) = 1\n$$\n此条件满足。\n\n接着，计算参数 $s$ 和 $d$。\n我们需要找到整数 $s$ 和 $d$（其中 $d$ 为奇数），使得 $n-1 = 2^s d$。\n首先，我们计算 $n-1$：\n$$\nn-1 = 2047 - 1 = 2046\n$$\n接下来，我们从 $2046$ 中分解出 $2$ 的最高次幂：\n$$\n2046 = 2 \\times 1023\n$$\n数字 $1023$ 是奇数，所以我们不能再分解出更多的 $2$ 的次幂。\n该表达式是 $2^s d$ 的形式，由此我们可以确定：\n$$\ns = 1\n$$\n$$\nd = 1023\n$$\n所以，参数为 $s=1$ 和 $d=1023$。\n\n最后，验证 $n=2047$ 是关于底 $a=2$ 的强伪素数。\n根据定义，一个奇合数 $n$，若满足 $\\gcd(a,n)=1$，则其为关于底 $a$ 的强伪素数，如果满足以下任一条件：\n1.  $a^d \\equiv 1 \\pmod{n}$，或\n2.  $a^{2^r d} \\equiv -1 \\pmod{n}$，对于某个整数 $r$ 且 $0 \\le r  s$。\n\n我们有 $a=2$，$n=2047$，$s=1$ 和 $d=1023$。\n我们来检查第一个条件：$2^{1023} \\equiv 1 \\pmod{2047}$ 是否成立？\n一个关键的观察是 $n=2047$ 是一个梅森数 $M_{11}$，因为 $2^{11} - 1 = 2048 - 1 = 2047$。\n由此，我们可以写出同余式：\n$$\n2^{11} \\equiv 1 \\pmod{2047}\n$$\n现在我们可以计算 $2^{1023}$ 模 $2047$。我们将指数 $d=1023$ 用 $11$ 来表示：\n$$\n1023 = 11 \\times 93\n$$\n利用这一点，我们可以重写表达式 $2^{1023}$：\n$$\n2^{1023} = 2^{11 \\times 93} = (2^{11})^{93}\n$$\n现在，我们应用同余关系：\n$$\n(2^{11})^{93} \\equiv 1^{93} \\pmod{2047}\n$$\n$$\n2^{1023} \\equiv 1 \\pmod{2047}\n$$\n第一个条件 $a^d \\equiv 1 \\pmod{n}$ 得到满足。\n由于定义使用了“或”子句，满足第一个条件就足以得出结论：$n=2047$ 是关于底 $a=2$ 的强伪素数。\n\n为完整起见，让我们分析第二个条件。当 $s=1$ 时，$r$ 的范围是 $0 \\le r  1$，这意味着唯一可能的整数值是 $r=0$。第二个条件变为：\n$$\na^{2^0 d} \\equiv -1 \\pmod{n} \\implies 2^{1023} \\equiv -1 \\pmod{2047}\n$$\n我们已经证明了 $2^{1023} \\equiv 1 \\pmod{2047}$。因为 $1 \\not\\equiv -1 \\pmod{2047}$（因为它们的差 $2$ 不是 $2047$ 的倍数），所以第二个条件不满足。然而，由于第一个条件已满足，整体定义得到满足。\n\n验证的所有步骤均已完成。$s$ 和 $d$ 的值分别为 $1$ 和 $1023$。问题要求将这些参数作为最终答案报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1023\n\\end{pmatrix}\n}\n$$", "id": "3088449"}]}