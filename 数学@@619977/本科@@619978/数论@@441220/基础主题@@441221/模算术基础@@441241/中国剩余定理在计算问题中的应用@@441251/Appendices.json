{"hands_on_practices": [{"introduction": "这第一个练习将带你深入中国剩余定理构造性证明的核心。你将从头开始构建一个“重构蓝图”，它能让你系统地找到同余方程组的唯一解。通过这个实践，你将巩固对中国剩余定理为何有效以及其解是如何构造的理解 [@problem_id:3081036]。", "problem": "在一个分布式存储环境中，一个未知的非负整数 $x$ 通过存储其模 $3$、$5$ 和 $7$ 的余数来进行冗余编码。你的任务是基于基本原理设计一个可复用的数值重构蓝图，然后将其应用于一个具体实例。\n\n仅从以下基本事实出发：\n- 如果整数 $m_1,\\dots,m_k$ 两两互质，那么对于任意余数 $r_1,\\dots,r_k$，同余方程组 $x\\equiv r_i \\pmod{m_i}$ 存在一个模 $M=m_1\\cdots m_k$ 的唯一解（中国剩余定理 (CRT)）。\n- 裴蜀定理：对于互质整数 $a$ 和 $b$，存在整数 $u$ 和 $v$ 使得 $au+bv=1$。\n\n完成以下任务：\n1) 在范围 $\\{0,1,\\dots,104\\}$ 内构造明确的整数 $b_3,b_5,b_7$，使得 $b_3\\equiv 1 \\pmod{3}$ 且 $b_3\\equiv 0 \\pmod{5}$ 且 $b_3\\equiv 0 \\pmod{7}$；$b_5\\equiv 0 \\pmod{3}$ 且 $b_5\\equiv 1 \\pmod{5}$ 且 $b_5\\equiv 0 \\pmod{7}$；$b_7\\equiv 0 \\pmod{3}$ 且 $b_7\\equiv 0 \\pmod{5}$ 且 $b_7\\equiv 1 \\pmod{7}$。这些整数构成一个可复用的数值重构蓝图，因为一旦确定，它们就可以与任意余数三元组 $(r_3,r_5,r_7)$ 线性组合，以得到模 $105$ 的唯一解。\n2) 使用你的蓝图，重构满足 $x\\equiv 2 \\pmod{3}$，$x\\equiv 4 \\pmod{5}$ 和 $x\\equiv 3 \\pmod{7}$ 的唯一解 $x\\in[0,105)$。\n3) 根据基本事实，证明你重构的解 $x$ 在区间 $[0,105)$ 内是唯一的。\n\n只需报告 $x$ 的值作为你的最终数值答案。无需四舍五入。", "solution": "该问题要求使用中国剩余定理 (CRT) 的原理来解一个线性同余方程组。模数分别为 $m_1 = 3$，$m_2 = 5$ 和 $m_3 = 7$。这些是两两互质的整数。模数的乘积为 $M = m_1 m_2 m_3 = 3 \\times 5 \\times 7 = 105$。解法按规定的三个阶段进行。\n\n**1) 构造数值重构蓝图**\n\n中国剩余定理构造性证明的核心是找到一组整数 $b_3, b_5, b_7$，其中每个 $b_i$ 都满足模 $m_i$ 同余于 $1$，而模 $m_j$ ($j \\neq i$) 同余于 $0$。\n\n- **计算 $b_3$**：\n我们要求 $b_3 \\equiv 1 \\pmod{3}$，$b_3 \\equiv 0 \\pmod{5}$ 以及 $b_3 \\equiv 0 \\pmod{7}$。后两个同余式意味着 $b_3$ 必须是 $5 \\times 7 = 35$ 的倍数，因为 $5$ 和 $7$ 互质。我们可以将 $b_3$ 写成 $b_3 = 35k$ 的形式，其中 $k$ 是某个整数。将此代入第一个同余式得到：\n$$35k \\equiv 1 \\pmod{3}$$\n因为 $35 = 11 \\times 3 + 2$，我们有 $35 \\equiv 2 \\pmod{3}$。该同余式化简为：\n$$2k \\equiv 1 \\pmod{3}$$\n为了解出 $k$，我们需求出 $2$ 模 $3$ 的乘法逆元。对于互质整数 $2$ 和 $3$，裴蜀定理保证了这种逆元的存在。通过观察，我们看到 $2 \\times 2 = 4 \\equiv 1 \\pmod{3}$，所以 $2$ 模 $3$ 的逆元是 $2$。将同余式两边乘以 $2$：\n$$2(2k) \\equiv 2(1) \\pmod{3} \\implies 4k \\equiv 2 \\pmod{3} \\implies k \\equiv 2 \\pmod{3}$$\n我们选择最小的非负整数 $k$，所以 $k=2$。这得出 $b_3 = 35 \\times 2 = 70$。这个值在要求的范围 $\\{0, 1, \\dots, 104\\}$ 内。\n\n- **计算 $b_5$**：\n我们要求 $b_5 \\equiv 0 \\pmod{3}$，$b_5 \\equiv 1 \\pmod{5}$ 以及 $b_5 \\equiv 0 \\pmod{7}$。这意味着 $b_5$ 必须是 $3 \\times 7 = 21$ 的倍数。所以，$b_5 = 21k$。将其代入第二个同余式：\n$$21k \\equiv 1 \\pmod{5}$$\n因为 $21 = 4 \\times 5 + 1$，我们有 $21 \\equiv 1 \\pmod{5}$。该同余式变为：\n$$k \\equiv 1 \\pmod{5}$$\n选择 $k=1$，我们得到 $b_5 = 21 \\times 1 = 21$。这个值在要求的范围内。\n\n- **计算 $b_7$**：\n我们要求 $b_7 \\equiv 0 \\pmod{3}$，$b_7 \\equiv 0 \\pmod{5}$ 以及 $b_7 \\equiv 1 \\pmod{7}$。这意味着 $b_7$ 必须是 $3 \\times 5 = 15$ 的倍数。所以，$b_7 = 15k$。将其代入第三个同余式：\n$$15k \\equiv 1 \\pmod{7}$$\n因为 $15 = 2 \\times 7 + 1$，我们有 $15 \\equiv 1 \\pmod{7}$。该同余式变为：\n$$k \\equiv 1 \\pmod{7}$$\n选择 $k=1$，我们得到 $b_7 = 15 \\times 1 = 15$。这个值在要求的范围内。\n\n得到的数值重构蓝图由整数 $b_3 = 70$，$b_5 = 21$ 和 $b_7 = 15$ 组成。\n\n**2) 重构 $x$**\n\n我们需要找到满足以下同余方程组的唯一整数 $x \\in [0, 105)$：\n$$x \\equiv 2 \\pmod{3}$$\n$$x \\equiv 4 \\pmod{5}$$\n$$x \\equiv 3 \\pmod{7}$$\n解 $x$ 可以通过蓝图整数 $b_i$ 与相应余数 $r_i$ 加权后的线性组合来构造：\n$$x = r_3 b_3 + r_5 b_5 + r_7 b_7$$\n任何这样的 $x$ 都满足这些同余式。例如，模 $3$ 时，$x \\equiv r_3(1) + r_5(0) + r_7(0) \\equiv r_3 \\pmod{3}$。同样的逻辑也适用于模 $5$ 和 $7$。\n代入给定的余数 $r_3 = 2$，$r_5 = 4$，$r_7 = 3$ 和计算出的 $b_i$ 值：\n$$x' = (2)(70) + (4)(21) + (3)(15) = 140 + 84 + 45 = 269$$\n为了找到在区间 $[0, 105)$ 内的唯一解，我们将结果对 $105$ 取模：\n$$x \\equiv 269 \\pmod{105}$$\n因为 $269 = 2 \\times 105 + 59$，余数是 $59$。因此，唯一解是 $x = 59$。\n\n**3) 唯一性证明**\n\n在区间 $[0, M)$ 内解的唯一性是中国剩余定理的基石。这可以从基本事实中得到证明。\n让我们假设在区间 $[0, 105)$ 内存在两个不同的解 $x_1$ 和 $x_2$。这两个解都必须满足给定的同余式：\n$$x_1 \\equiv r_i \\pmod{m_i} \\quad \\text{and} \\quad x_2 \\equiv r_i \\pmod{m_i} \\quad \\text{for } i \\in \\{1,2,3\\}$$\n将 $x_1$ 的同余式减去 $x_2$ 的同余式，我们得到：\n$$x_1 - x_2 \\equiv 0 \\pmod{3}$$\n$$x_1 - x_2 \\equiv 0 \\pmod{5}$$\n$$x_1 - x_2 \\equiv 0 \\pmod{7}$$\n这些同余式意味着差值 $x_1 - x_2$ 是 $3$、$5$ 和 $7$ 的倍数。由于 $3$、$5$ 和 $7$ 两两互质，它们的最小公倍数就是它们的乘积 $M=105$。因此，$x_1 - x_2$ 必须是 $105$ 的倍数。我们可以将其写为：\n$$x_1 - x_2 \\equiv 0 \\pmod{105}$$\n由于 $x_1$ 和 $x_2$ 都在区间 $[0, 105)$ 内，它们满足 $0 \\le x_1  105$ 和 $0 \\le x_2  105$。因此，它们的差值必须在范围 $-105  x_1 - x_2  105$ 内。在这个范围内，唯一是 $105$ 的倍数的整数是 $0$。\n因此，$x_1 - x_2 = 0$，这意味着 $x_1 = x_2$。这与 $x_1$ 和 $x_2$ 是不同解的假设相矛盾。所以，在区间 $[0, 105)$ 内的解必须是唯一的。", "answer": "$$\\boxed{59}$$", "id": "3081036"}, {"introduction": "中国剩余定理是一个强大的工具，能将复杂问题分解为更简单、可管理的部分。在此练习中，你将应用 CRT 作为一种“分治”策略，来解决一个模合数的二次同余方程。这个练习展示了如何通过求解方程在各素因子模下的解，然后重新组合这些解来获得完整解答 [@problem_id:3081017]。", "problem": "设 $p$ 和 $q$ 为不同的奇素数，设 $n=pq$，并设 $a$ 为一个整数，且 $a$ 是模 $p$ 和模 $q$ 的二次剩余。仅从模 $m$ 同余的定义、环 $\\mathbb{Z}/m\\mathbb{Z}$ 中单位元的基本性质、费马小定理、欧拉准则以及中国剩余定理（CRT）的陈述出发，推导一个计算过程，用于构造 $x^{2}\\equiv a \\pmod{n}$ 的所有解，该过程通过组合 $a$ 模 $p$ 和模 $q$ 的平方根，然后通过 CRT 将它们提升到模 $n$。将您的推导应用于具体实例 $p=11$，$q=19$，$n=209$ 和 $a=5$。计算满足 $x^{2}\\equiv 5 \\pmod{209}$ 的四个剩余类 $x\\in\\{0,1,\\dots,n-1\\}$ 的完整集合，并按升序报告它们。\n\n使用 $\\mathrm{pmatrix}$ 环境将您的最终答案表示为单行矩阵，其中条目按升序排列。无需四舍五入。", "solution": "**1. 通用过程的推导**\n\n设给定的同余式为 $x^{2}\\equiv a \\pmod{n}$。由于 $n=pq$ 且 $p, q$ 是不同的素数，所以它们是互素的。根据同余的定义，$n | (x^{2} - a)$，这意味着 $p | (x^{2} - a)$ 和 $q | (x^{2} - a)$。这等价于同余方程组：\n$$\n\\begin{cases}\nx^{2} \\equiv a \\pmod{p} \\\\\nx^{2} \\equiv a \\pmod{q}\n\\end{cases}\n$$\n问题陈述 $a$ 是模 $p$ 和模 $q$ 的二次剩余。由于 $p$ 和 $q$ 是奇素数，且 $a$ 是二次剩余，勒让德符号 $(\\frac{a}{p})$ 和 $(\\frac{a}{q})$ 必须都等于 $1$。这意味着 $a \\not\\equiv 0 \\pmod{p}$ 和 $a \\not\\equiv 0 \\pmod{q}$。因此，这些二次同余式中的每一个都恰好有两个不同的解。\n\n设 $y^{2} \\equiv a \\pmod{p}$ 的解为 $y \\equiv \\pm s_p \\pmod{p}$。\n设 $z^{2} \\equiv a \\pmod{q}$ 的解为 $z \\equiv \\pm s_q \\pmod{q}$。\n\n寻找满足 $x^2 \\equiv a \\pmod{n}$ 的 $x$ 的问题，现在简化为寻找同时满足以下四对可能的线性同余方程组之一的 $x$：\n$$\n\\text{系统 1: } \\begin{cases} x \\equiv s_p \\pmod{p} \\\\ x \\equiv s_q \\pmod{q} \\end{cases}\n\\quad\n\\text{系统 2: } \\begin{cases} x \\equiv s_p \\pmod{p} \\\\ x \\equiv -s_q \\pmod{q} \\end{cases}\n$$\n$$\n\\text{系统 3: } \\begin{cases} x \\equiv -s_p \\pmod{p} \\\\ x \\equiv s_q \\pmod{q} \\end{cases}\n\\quad\n\\text{系统 4: } \\begin{cases} x \\equiv -s_p \\pmod{p} \\\\ x \\equiv -s_q \\pmod{q} \\end{cases}\n$$\n中国剩余定理（CRT）保证对于这些系统中的每一个，都存在一个模 $n=pq$ 的唯一解 $x$。\n\n为了构造这些解，我们首先找到满足贝祖恒等式 $up + vq = 1$ 的整数 $u$ 和 $v$。这可以使用扩展欧几里得算法来完成。从这个恒等式，我们得到 $vq \\equiv 1 \\pmod{p}$ 和 $up \\equiv 1 \\pmod{q}$。\n\n对于形式为 $x \\equiv c_1 \\pmod{p}$ 和 $x \\equiv c_2 \\pmod{q}$ 的一般系统，解由以下公式给出：\n$$\nx \\equiv c_1(vq) + c_2(up) \\pmod{pq}\n$$\n我们验证这个构造：\n模 $p$ 时： $x \\equiv c_1(vq) + c_2(up) \\equiv c_1(1) + c_2(0) \\equiv c_1 \\pmod{p}$。\n模 $q$ 时： $x \\equiv c_1(vq) + c_2(up) \\equiv c_1(0) + c_2(1) \\equiv c_2 \\pmod{q}$。\n\n将此构造应用于四个系统，得到 $x^2 \\equiv a \\pmod{n}$ 的四个不同解。\n\n**2. 具体实例的应用**\n\n给定 $p=11$, $q=19$, $n=pq=209$, 以及 $a=5$。我们必须找到所有满足 $x^{2} \\equiv 5 \\pmod{209}$ 的 $x \\in \\{0, 1, \\dots, 208\\}$。\n\n**步骤 2a：求解模 $p=11$ 的根。**\n我们需要解 $x^2 \\equiv 5 \\pmod{11}$。$p=11$ 和 $q=19$ 都是与 $3 \\pmod{4}$ 同余的素数。对于这样的素数 $p$，二次剩余 $a$ 的平方根由 $\\pm a^{(p+1)/4} \\pmod{p}$ 给出。\n对于 $p=11$，指数是 $(11+1)/4 = 3$。\n所以，根是 $\\pm 5^3 \\pmod{11}$。\n$5^2 = 25 \\equiv 3 \\pmod{11}$。\n$5^3 = 5 \\cdot 5^2 \\equiv 5 \\cdot 3 = 15 \\equiv 4 \\pmod{11}$。\n因此，$s_p = 4$。两个解是 $x \\equiv 4 \\pmod{11}$ 和 $x \\equiv -4 \\equiv 7 \\pmod{11}$。\n\n**步骤 2b：求解模 $q=19$ 的根。**\n我们需要解 $x^2 \\equiv 5 \\pmod{19}$。\n对于 $q=19$，指数是 $(19+1)/4 = 5$。\n所以，根是 $\\pm 5^5 \\pmod{19}$。\n$5^2 = 25 \\equiv 6 \\pmod{19}$。\n$5^4 \\equiv 6^2 = 36 \\equiv 17 \\equiv -2 \\pmod{19}$。\n$5^5 = 5 \\cdot 5^4 \\equiv 5 \\cdot (-2) = -10 \\equiv 9 \\pmod{19}$。\n因此，$s_q = 9$。两个解是 $x \\equiv 9 \\pmod{19}$ 和 $x \\equiv -9 \\equiv 10 \\pmod{19}$。\n\n**步骤 2c：寻找 CRT 的系数。**\n我们必须找到整数 $u, v$ 使得 $11u + 19v = 1$。使用扩展欧几里得算法：\n$19 = 1 \\cdot 11 + 8$\n$11 = 1 \\cdot 8 + 3$\n$8 = 2 \\cdot 3 + 2$\n$3 = 1 \\cdot 2 + 1$\n反向回代：\n$1 = 3 - 1 \\cdot 2 = 3 - (8 - 2 \\cdot 3) = 3 \\cdot 3 - 8$\n$1 = 3(11 - 8) - 8 = 3 \\cdot 11 - 4 \\cdot 8$\n$1 = 3 \\cdot 11 - 4(19 - 1 \\cdot 11) = 3 \\cdot 11 - 4 \\cdot 19 + 4 \\cdot 11 = 7 \\cdot 11 - 4 \\cdot 19$。\n所以我们有 $u=7$ 和 $v=-4$。\nCRT 提升项为 $up = 7 \\cdot 11 = 77$ 和 $vq = -4 \\cdot 19 = -76$。\n\n**步骤 2d：构造模 209 的四个解。**\n通解形式为 $x \\equiv c_1(-76) + c_2(77) \\pmod{209}$，其中 $c_1$ 是模 11 的根，$c_2$ 是模 19 的根。\n\n系统 1: $c_1=4, c_2=9$.\n$x_1 \\equiv 4(-76) + 9(77) \\pmod{209}$\n$x_1 \\equiv -304 + 693 \\pmod{209}$\n$x_1 \\equiv (-209 - 95) + (3 \\cdot 209 + 66) \\pmod{209}$\n$x_1 \\equiv -95 + 66 = -29 \\equiv 180 \\pmod{209}$。\n\n系统 2: $c_1=4, c_2=10$.\n$x_2 \\equiv 4(-76) + 10(77) \\pmod{209}$\n$x_2 \\equiv -304 + 770 \\pmod{209}$\n$x_2 \\equiv -95 + (3 \\cdot 209 + 143) \\pmod{209}$\n$x_2 \\equiv -95 + 143 = 48 \\pmod{209}$。\n\n系统 3: $c_1=7, c_2=9$.\n$x_3 \\equiv 7(-76) + 9(77) \\pmod{209}$\n$x_3 \\equiv -532 + 693 \\pmod{209}$\n$x_3 \\equiv (-3 \\cdot 209 + 95) + 66 \\pmod{209}$\n$x_3 \\equiv 95 + 66 = 161 \\pmod{209}$。\n注意到 $x_3 \\equiv -x_2 \\pmod{209}$，因为它们的根分别是 $( -s_p, s_q )$ 和 $( s_p, -s_q )$。确实，$161 + 48 = 209 \\equiv 0 \\pmod{209}$。\n\n系统 4: $c_1=7, c_2=10$.\n$x_4 \\equiv 7(-76) + 10(77) \\pmod{209}$\n$x_4 \\equiv -532 + 770 \\pmod{209}$\n$x_4 \\equiv 95 + 143 = 238 \\pmod{209}$\n$x_4 \\equiv 29 \\pmod{209}$。\n注意到 $x_4 \\equiv -x_1 \\pmod{209}$，因为它们的根分别是 $( -s_p, -s_q )$ 和 $( s_p, s_q )$。确实，$29 + 180 = 209 \\equiv 0 \\pmod{209}$。\n\n在集合 $\\{0, 1, \\dots, 208\\}$ 中，$x$ 的四个解是 $29$, $48$, $161$, 和 $180$。\n我们验证一个解：$29^2 = 841 = 4 \\cdot 209 + 5$，所以 $29^2 \\equiv 5 \\pmod{209}$。由于其他解是 $\\pm 29 \\pmod{209}$ 和 $\\pm 48 \\pmod{209}$，它们的平方也必然与 $5 \\pmod{209}$ 同余。\n\n将解按升序排列，我们得到 $29, 48, 161, 180$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 29  48  161  180 \\end{pmatrix}}\n$$", "id": "3081017"}, {"introduction": "除了标准的构造方法，中国剩余定理的原理还与其他数值表示法（如混合基数系统）密切相关。这个练习要求你推导余数向量和混合基数数字之间的转换方法，这是一种高效的替代重构算法。它为中国剩余定理及其在计算机系统中的实际应用提供了一个算法视角 [@problem_id:3081044]。", "problem": "考虑中国剩余定理（CRT）的设定，其中模数两两互质。令 $p_1$、$p_2$、$p_3$ 为不同的素数，且 $M = p_1 p_2 p_3$。对于任意满足 $0 \\leq x  M$ 的整数 $x$，定义其剩余向量为 $(r_1, r_2, r_3)$，其中 $r_i \\equiv x \\pmod{p_i}$，并将其混合基数位 $(a_1, a_2, a_3)$ 定义为满足 $0 \\leq a_i  p_i$ ($i \\in \\{1,2,3\\}$) 的唯一整数，使得\n$$\nx = a_1 + a_2 p_1 + a_3 p_1 p_2.\n$$\n从CRT的核心论述（给定 $(r_1, r_2, r_3)$，则 $x \\bmod M$ 存在且唯一）和上述定义出发（不使用任何其他预先指定的公式），完成以下任务：\n\n- 推导一个构造性方案，在给定 $(r_1, r_2, r_3)$ 的情况下，计算出混合基数位 $(a_1, a_2, a_3)$，并通过模算术和模素数乘法逆元的存在性来证明每一步的合理性。\n- 推导从混合基数位 $(a_1, a_2, a_3)$ 返回到剩余向量 $(r_1, r_2, r_3)$ 的正向转换，并证明复合这两种转换（从剩余到混合基数，再到整数 $x$，然后回到剩余）可以恢复出相同的 $x$ 和原始的 $(r_1, r_2, r_3)$。\n- 将你的方案具体应用于小素数模 $p_1 = 7, p_2 = 11, p_3 = 13$ 和剩余向量 $(r_1, r_2, r_3) = (5, 8, 12)$。计算混合基数位 $(a_1, a_2, a_3)$，然后计算出满足 $0 \\leq x  M$ 的对应整数 $x$，并验证你的正向转换能得到 $(5, 8, 12)$。\n\n将你的最终答案表示为区间 $[0, M)$ 内的单个整数 $x$；无需四舍五入。", "solution": "该问题需要进行三部分分析：首先，推导一种从剩余表示转换为混合基数表示的方法；其次，推导其逆转换并验证一致性；第三，将此方法应用于一个具体的数值例子。\n\n令不同的素数模为 $p_1$、$p_2$ 和 $p_3$。令 $M = p_1 p_2 p_3$。我们给定一个在范围 $0 \\leq x  M$ 内的整数 $x$。\n其剩余向量为 $(r_1, r_2, r_3)$，其中对于 $i \\in \\{1, 2, 3\\}$ 有 $x \\equiv r_i \\pmod{p_i}$。\n其混合基数表示由 $x = a_1 + a_2 p_1 + a_3 p_1 p_2$ 给出，其中 $a_i$ 是满足 $0 \\leq a_i  p_i$ 的整数位。\n\n首先，我们推导构造性方案，从剩余向量 $(r_1, r_2, r_3)$ 确定混合基数位 $(a_1, a_2, a_3)$。这是通过依次考虑每个模下的 $x$ 方程来实现的。\n\n为了求 $a_1$，我们将 $x$ 的方程对 $p_1$ 取模：\n$$x \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_1}$$\n由于 $a_2 p_1$ 和 $a_3 p_1 p_2$ 都是 $p_1$ 的倍数，它们都与 $0 \\pmod{p_1}$ 同余。该方程简化为：\n$$x \\equiv a_1 \\pmod{p_1}$$\n我们已知 $x \\equiv r_1 \\pmod{p_1}$。因此，$a_1 \\equiv r_1 \\pmod{p_1}$。\n考虑到约束条件 $0 \\leq a_1  p_1$ 并且已知 $r_1$ 是一个余数（通常 $0 \\leq r_1  p_1$），我们可以唯一地确定 $a_1$：\n$$a_1 = r_1$$\n\n接下来，为了求 $a_2$，我们将 $x$ 的方程对 $p_2$ 取模：\n$$x \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_2}$$\n项 $a_3 p_1 p_2$ 是 $p_2$ 的倍数，所以它与 $0 \\pmod{p_2}$ 同余。方程简化为：\n$$x \\equiv a_1 + a_2 p_1 \\pmod{p_2}$$\n使用给定的剩余 $x \\equiv r_2 \\pmod{p_2}$，我们得到：\n$$r_2 \\equiv a_1 + a_2 p_1 \\pmod{p_2}$$\n我们可以重排这个同余式来求解 $a_2$：\n$$a_2 p_1 \\equiv r_2 - a_1 \\pmod{p_2}$$\n为了分离出 $a_2$，我们必须乘以 $p_1$ 模 $p_2$ 的乘法逆元。这个逆元记作 $(p_1^{-1} \\pmod{p_2})$，它存在且唯一，因为 $p_1$ 和 $p_2$ 是不同的素数，这意味着它们的最大公约数是 $\\gcd(p_1, p_2) = 1$。\n$$a_2 \\equiv (r_2 - a_1) (p_1^{-1} \\pmod{p_2}) \\pmod{p_2}$$\n约束条件 $0 \\leq a_2  p_2$ 确保了 $a_2$ 是在指定范围内满足此同余式的唯一整数。\n\n最后，为了求 $a_3$，我们将 $x$ 的方程对 $p_3$ 取模：\n$$x \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_3}$$\n使用给定的剩余 $x \\equiv r_3 \\pmod{p_3}$，我们得到：\n$$r_3 \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_3}$$\n重排以求解 $a_3$：\n$$a_3 p_1 p_2 \\equiv r_3 - a_1 - a_2 p_1 \\pmod{p_3}$$\n为了分离出 $a_3$，我们乘以 $p_1 p_2$ 模 $p_3$ 的乘法逆元。这个逆元 $((p_1 p_2)^{-1} \\pmod{p_3})$ 存在，因为 $p_1, p_2, p_3$ 是不同的素数，所以 $\\gcd(p_1, p_3) = 1$ 且 $\\gcd(p_2, p_3) = 1$，这意味着 $\\gcd(p_1 p_2, p_3) = 1$。该逆元可以计算为 $(p_1^{-1} \\pmod{p_3}) (p_2^{-1} \\pmod{p_3})$。\n$$a_3 \\equiv (r_3 - a_1 - a_2 p_1) ((p_1 p_2)^{-1} \\pmod{p_3}) \\pmod{p_3}$$\n约束条件 $0 \\leq a_3  p_3$ 再次确保了 $a_3$ 是唯一确定的。这样就完成了构造方案。\n\n其次，我们推导从混合基数位 $(a_1, a_2, a_3)$ 到剩余向量 $(r_1, r_2, r_3)$ 的正向转换，并证明其一致性。给定 $(a_1, a_2, a_3)$，$x$ 定义为 $x = a_1 + a_2 p_1 + a_3 p_1 p_2$。\n剩余计算如下：\n$r_1 = x \\pmod{p_1} \\equiv (a_1 + a_2 p_1 + a_3 p_1 p_2) \\pmod{p_1} \\equiv a_1 \\pmod{p_1}$。由于 $0 \\le a_1  p_1$，$r_1=a_1$。\n$r_2 = x \\pmod{p_2} \\equiv (a_1 + a_2 p_1 + a_3 p_1 p_2) \\pmod{p_2} \\equiv (a_1 + a_2 p_1) \\pmod{p_2}$。\n$r_3 = x \\pmod{p_3} \\equiv (a_1 + a_2 p_1 + a_3 p_1 p_2) \\pmod{p_3}$。\n\n为了证明一致性，我们展示了从一个剩余向量 $(r'_1, r'_2, r'_3)$ 开始，应用我们的方案得到 $(a_1, a_2, a_3)$，构造出 $x$，然后求其剩余 $(r_1, r_2, r_3)$，会返回原始向量。\n根据构造方案，我们有 $a_1=r'_1$，$a_2 \\equiv (r'_2 - a_1) (p_1^{-1} \\pmod{p_2}) \\pmod{p_2}$，以及 $a_3 \\equiv (r'_3 - a_1 - a_2 p_1) ((p_1 p_2)^{-1} \\pmod{p_3}) \\pmod{p_3}$。\n让我们求 $x = a_1 + a_2 p_1 + a_3 p_1 p_2$ 的剩余。\n$r_1 \\equiv x \\pmod{p_1} \\equiv a_1 \\pmod{p_1}$。由于 $a_1 = r'_1$，我们有 $r_1 \\equiv r'_1 \\pmod{p_1}$。因为两者都在 $[0, p_1-1]$ 范围内，$r_1 = r'_1$。\n$r_2 \\equiv x \\pmod{p_2} \\equiv a_1 + a_2 p_1 \\pmod{p_2}$。根据 $a_2$ 的定义，我们有 $a_2 p_1 \\equiv r'_2 - a_1 \\pmod{p_2}$。代入可得 $r_2 \\equiv a_1 + (r'_2 - a_1) \\pmod{p_2} \\equiv r'_2 \\pmod{p_2}$。因为两者都在 $[0, p_2-1]$ 范围内，$r_2 = r'_2$。\n$r_3 \\equiv x \\pmod{p_3} \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_3}$。根据 $a_3$ 的定义，我们有 $a_3 p_1 p_2 \\equiv r'_3 - a_1 - a_2 p_1 \\pmod{p_3}$。代入可得 $r_3 \\equiv (a_1 + a_2 p_1) + (r'_3 - a_1 - a_2 p_1) \\pmod{p_3} \\equiv r'_3 \\pmod{p_3}$。因为两者都在 $[0, p_3-1]$ 范围内，$r_3 = r'_3$。\n恢复的剩余向量 $(r_1, r_2, r_3)$ 与原始向量 $(r'_1, r'_2, r'_3)$ 完全相同。由CRT保证的 $x$ 模 $M$ 的唯一性确保了所构造的 $x$ 是正确的整数。\n\n第三，我们将此方案应用于给定的数值例子：$p_1 = 7, p_2 = 11, p_3 = 13$ 以及 $(r_1, r_2, r_3) = (5, 8, 12)$。模为 $M = 7 \\times 11 \\times 13 = 1001$。\n\n1.  计算 $a_1$:\n    $a_1 = r_1 = 5$。\n\n2.  计算 $a_2$:\n    $a_2 \\equiv (r_2 - a_1) (p_1^{-1} \\pmod{p_2}) \\pmod{p_2}$\n    $a_2 \\equiv (8 - 5) (7^{-1} \\pmod{11}) \\pmod{11}$\n    $a_2 \\equiv 3 \\cdot (7^{-1} \\pmod{11}) \\pmod{11}$。\n    为了求 $7^{-1} \\pmod{11}$，我们寻找一个整数 $y$ 使得 $7y \\equiv 1 \\pmod{11}$。通过观察，$7 \\times 8 = 56 = 5 \\times 11 + 1$，所以 $7^{-1} \\pmod{11} = 8$。\n    $a_2 \\equiv 3 \\times 8 \\pmod{11} \\equiv 24 \\pmod{11} \\equiv 2 \\pmod{11}$。\n    所以，$a_2 = 2$。\n\n3.  计算 $a_3$:\n    $a_3 \\equiv (r_3 - a_1 - a_2 p_1) ((p_1 p_2)^{-1} \\pmod{p_3}) \\pmod{p_3}$\n    $a_3 \\equiv (12 - 5 - 2 \\cdot 7) ((7 \\cdot 11)^{-1} \\pmod{13}) \\pmod{13}$\n    $a_3 \\equiv (12 - 5 - 14) (77^{-1} \\pmod{13}) \\pmod{13}$\n    $a_3 \\equiv -7 \\cdot (77^{-1} \\pmod{13}) \\pmod{13}$。\n    首先，我们对各项对 13 取模进行简化：\n    $-7 \\equiv 6 \\pmod{13}$。\n    $77 = 5 \\times 13 + 12$，所以 $77 \\equiv 12 \\equiv -1 \\pmod{13}$。\n    逆元是 $(77^{-1} \\pmod{13}) \\equiv (-1)^{-1} \\pmod{13} \\equiv -1 \\equiv 12 \\pmod{13}$。\n    将这些代回：\n    $a_3 \\equiv 6 \\times 12 \\pmod{13} \\equiv 72 \\pmod{13}$。\n    由于 $72 = 5 \\times 13 + 7$，我们有 $a_3 \\equiv 7 \\pmod{13}$。\n    所以，$a_3 = 7$。\n\n混合基数位是 $(a_1, a_2, a_3) = (5, 2, 7)$。\n\n现在，我们计算整数 $x$：\n$x = a_1 + a_2 p_1 + a_3 p_1 p_2$\n$x = 5 + 2(7) + 7(7 \\cdot 11)$\n$x = 5 + 14 + 7(77)$\n$x = 19 + 539$\n$x = 558$。\n\n我们必须验证 $x$ 的这个值在正确的范围内，$0 \\leq 558  1001$，事实也的确如此。最后，我们验证它的剩余：\n$x \\pmod{7} \\equiv 558 \\pmod{7}$。由于 $558 = 79 \\times 7 + 5$，$558 \\equiv 5 \\pmod{7}$。正确。\n$x \\pmod{11} \\equiv 558 \\pmod{11}$。由于 $558 = 50 \\times 11 + 8$，$558 \\equiv 8 \\pmod{11}$。正确。\n$x \\pmod{13} \\equiv 558 \\pmod{13}$。由于 $558 = 42 \\times 13 + 12$，$558 \\equiv 12 \\pmod{13}$。正确。\n计算出的剩余与 $(5, 8, 12)$ 匹配，证实了结果。\n最终答案是整数 $x$。", "answer": "$$\\boxed{558}$$", "id": "3081044"}]}