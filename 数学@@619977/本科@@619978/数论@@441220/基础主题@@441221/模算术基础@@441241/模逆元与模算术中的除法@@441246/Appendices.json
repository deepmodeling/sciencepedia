{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。求模逆元最基本、最重要的方法是使用扩展欧几里得算法。这个练习将带你一步步地应用该算法，找到一个数的模逆元。这个过程不仅是一个计算练习，更是对贝祖等式（Bézout's identity）的一个具体构造性证明，是理解模算术中“除法”为何可行的关键。[@problem_id:3087443]", "problem": "设 $n$ 为一个大于 1 的整数，我们考虑在模 $n$ 整数环中的算术。对于一个整数 $a$，其模 $n$ 的乘法逆元是一个整数 $x$，使得 $ax \\equiv 1 \\pmod{n}$。根据贝祖恒等式中整数解的存在性，这样的逆元存在的充要条件是 $\\gcd(a,n) = 1$。仅使用这些基础事实和扩展欧几里得算法 (EEA)，计算一个明确的整数 $x$ 使得 $37x \\equiv 1 \\pmod{101}$，然后通过将乘积直接进行模 101 约简来验证您计算的 $x$ 是否正确。请将 $x$ 表示为模 101 的最小正剩余。最终答案必须是一个整数。", "solution": "问题是要求一个整数 $x$，它代表在模 101 整数环中 37 的乘法逆元。该问题是适定的，并且在数学上是合理的。一个整数 $a$ 模 $n$ 的乘法逆元存在的充要条件是 $a$ 和 $n$ 的最大公约数（记为 $\\gcd(a, n)$）为 1。在本例中，$a=37$ 且 $n=101$。由于 101 是一个素数，且 37 不是 101 的倍数（因为 $1  37  101$），因此可以得出 $\\gcd(37, 101) = 1$。因此，37 模 101 的唯一乘法逆元存在。\n\n任务是找到一个整数 $x$，使得：\n$$37x \\equiv 1 \\pmod{101}$$\n该同余式等价于存在一个整数 $k$，使得 $37x - 1 = 101k$。整理该方程，可以得到一个由贝祖恒等式指定的线性丢番图方程形式：\n$$37x - 101k = 1$$\n我们可以使用扩展欧几里得算法 (EEA) 来求解整数 $x$ 和 $k$。我们将方程记为 $37x + 101y = 1$，其中 $y = -k$。EEA 应用于数对 $(101, 37)$。\n\n首先，我们为欧几里得算法执行一系列除法：\n\\begin{align*} 101 = 2 \\cdot 37 + 27 \\\\ 37 = 1 \\cdot 27 + 10 \\\\ 27 = 2 \\cdot 10 + 7 \\\\ 10 = 1 \\cdot 7 + 3 \\\\ 7 = 2 \\cdot 3 + 1 \\\\ 3 = 3 \\cdot 1 + 0 \\end{align*}\n最后一个非零余数是 $1$，这证实了 $\\gcd(101, 37)=1$。\n\n接下来，我们通过这些方程反向回溯，将最大公约数 $1$ 表示为 $101$ 和 $37$ 的线性组合。\n从倒数第二个方程开始，我们有：\n$$1 = 7 - 2 \\cdot 3$$\n现在，我们用前一个方程中余数 $3$ 的表达式（$3 = 10 - 1 \\cdot 7$）进行代换：\n$$1 = 7 - 2 \\cdot (10 - 1 \\cdot 7) = 7 - 2 \\cdot 10 + 2 \\cdot 7 = 3 \\cdot 7 - 2 \\cdot 10$$\n接下来，代入余数 $7$ 的表达式（$7 = 27 - 2 \\cdot 10$）：\n$$1 = 3 \\cdot (27 - 2 \\cdot 10) - 2 \\cdot 10 = 3 \\cdot 27 - 6 \\cdot 10 - 2 \\cdot 10 = 3 \\cdot 27 - 8 \\cdot 10$$\n接下来，代入余数 $10$ 的表达式（$10 = 37 - 1 \\cdot 27$）：\n$$1 = 3 \\cdot 27 - 8 \\cdot (37 - 1 \\cdot 27) = 3 \\cdot 27 - 8 \\cdot 37 + 8 \\cdot 27 = 11 \\cdot 27 - 8 \\cdot 37$$\n最后，代入余数 $27$ 的表达式（$27 = 101 - 2 \\cdot 37$）：\n$$1 = 11 \\cdot (101 - 2 \\cdot 37) - 8 \\cdot 37 = 11 \\cdot 101 - 22 \\cdot 37 - 8 \\cdot 37$$\n合并含有 $37$ 的项，我们得到：\n$$1 = 11 \\cdot 101 - 30 \\cdot 37$$\n这可以写成：\n$$(-30) \\cdot 37 + (11) \\cdot 101 = 1$$\n该方程的形式为 $ax + ny = \\gcd(a,n)$，其中 $a=37$, $n=101$, $x=-30$, $y=11$。对此方程取模 101：\n$$(-30) \\cdot 37 + (11) \\cdot 101 \\equiv 1 \\pmod{101}$$\n因为 $(11) \\cdot 101$ 是 $101$ 的倍数，所以它模 $101$ 的余数为 $0$。\n$$(-30) \\cdot 37 + 0 \\equiv 1 \\pmod{101}$$\n$$(-30) \\cdot 37 \\equiv 1 \\pmod{101}$$\n这表明 $x = -30$ 是 $37$ 模 $101$ 的一个有效乘法逆元。问题要求 $x$ 的最小正剩余。为了求得此值，我们将模数 $101$ 加到 $-30$ 上：\n$$x \\equiv -30 \\pmod{101} \\implies x \\equiv -30 + 101 \\pmod{101} \\implies x \\equiv 71 \\pmod{101}$$\n$x$ 的最小正整数值为 $71$。\n\n最后，我们必须通过将乘积 $37x$ 直接进行模 101 约简来验证此结果。我们计算乘积 $37 \\cdot 71$：\n$$37 \\cdot 71 = 2627$$\n为了求得 $2627$ 除以 $101$ 的余数，我们进行除法运算：\n$$2627 = 101 \\cdot q + r, \\quad \\text{其中 } 0 \\le r  101$$\n我们可以计算出商 $q$：$q = \\lfloor \\frac{2627}{101} \\rfloor = \\lfloor 26.009... \\rfloor = 26$。\n现在，我们求余数 $r$：\n$$2627 = 101 \\cdot 26 + r$$\n$$2627 = 2626 + r$$\n$$r = 1$$\n因此，$2627 \\equiv 1 \\pmod{101}$，这意味着 $37 \\cdot 71 \\equiv 1 \\pmod{101}$。计算出的值 $x=71$ 是正确的。", "answer": "$$\\boxed{71}$$", "id": "3087443"}, {"introduction": "掌握了如何计算模逆元之后，一个直接的应用就是求解线性同余方程。形如 $ax \\equiv b \\pmod{n}$ 的方程在密码学和计算机科学中非常常见。这个练习将向你展示如何将求解这类方程的问题，转化为我们已经熟悉的计算模逆元的问题，同时它也强调了解决问题前必须先判断解是否存在的关键一步。[@problem_id:3087491]", "problem": "设 $a=18$，$b=30$，$n=42$。回顾定义：对于整数 $x,y,n$ 且 $n \\neq 0$，同余式 $x \\equiv y \\pmod{n}$ 表示 $n$ 整除 $x-y$。仅使用此定义和整除性的性质（包括用于求最大公约数（GCD）的欧几里得算法和贝祖等式），完成以下任务：\n- 确定 $d=\\gcd(a,n)$。\n- 从第一性原理分析线性同余方程 $18x \\equiv 30 \\pmod{42}$，判断解是否存在。如果存在解，导出所有整数解的完整描述，并确定它们所代表的模 $42$ 的不同剩余类。\n将您的最终答案表示为给出 $d$ 和 $x$ 的解集的单个封闭形式解析表达式。无需四舍五入。", "solution": "所述问题定义明确、内部一致，并在数论领域有科学依据。所有必要的常数和定义均已提供。因此，我们可以进行形式化求解。\n\n问题要求我们分析线性同余方程 $18x \\equiv 30 \\pmod{42}$。给定 $a=18$，$b=30$，$n=42$。分析将从第一性原理出发，利用同余的定义、整除性的性质、欧几里得算法和贝祖等式。\n\n首先，我们确定 $d = \\gcd(a, n) = \\gcd(18, 42)$。我们应用欧几里得算法：\n$$42 = 2 \\cdot 18 + 6$$\n$$18 = 3 \\cdot 6 + 0$$\n最后一个非零余数即为最大公约数。因此，我们有 $d = \\gcd(18, 42) = 6$。\n\n接下来，我们分析同余方程 $18x \\equiv 30 \\pmod{42}$ 解的存在性。根据同余的定义，该命题等价于断言 $n$ 整除 $(ax-b)$，在本例中即为 $42$ 整除 $(18x - 30)$。这意味着存在一个整数，我们称之为 $k$，使得：\n$$18x - 30 = 42k$$\n整理该方程可得一个关于变量 $x$ 和 $k$ 的线性丢番图方程：\n$$18x - 42k = 30$$\n数论中的一个基本结果指出，形式为 $Ax + By = C$ 的线性丢番图方程有整数解 $(x, y)$ 的充要条件是 $\\gcd(A, B)$ 整除 $C$。在我们的情境中，$A=18$，$B=-42$，$C=30$。最大公约数为 $\\gcd(18, -42) = \\gcd(18, 42) = 6$。解存在的条件是 $6$ 必须整除 $30$。由于 $30 = 5 \\cdot 6$，此条件得到满足，因此我们得出结论，该同余方程有解。\n\n为求解，我们处理等价的丢番图方程。我们可以将整个方程除以 $d=6$：\n$$\\frac{18}{6}x - \\frac{42}{6}k = \\frac{30}{6}$$\n$$3x - 7k = 5$$\n这个简化后的方程等价于同余式 $3x \\equiv 5 \\pmod{7}$。为了解出 $x$，我们必须求出 $3$ 模 $7$ 的乘法逆元。我们可以使用扩展欧几里得算法，它是求最大公约数过程的延伸。从步骤 $7 = 2 \\cdot 3 + 1$ 中，我们可以将最大公约数 $1$ 表示为 $7$ 和 $3$ 的线性组合：\n$$1 = 7 - 2 \\cdot 3$$\n考虑此方程模 $7$ 的情况，我们有 $1 \\equiv -2 \\cdot 3 \\pmod{7}$。由于 $-2 \\equiv 5 \\pmod{7}$，这变为 $1 \\equiv 5 \\cdot 3 \\pmod{7}$。因此，$3$ 模 $7$ 的乘法逆元是 $5$。\n\n现在，我们将同余式 $3x \\equiv 5 \\pmod{7}$ 的两边乘以逆元 $5$：\n$$5 \\cdot (3x) \\equiv 5 \\cdot 5 \\pmod{7}$$\n$$(5 \\cdot 3) x \\equiv 25 \\pmod{7}$$\n$$1 \\cdot x \\equiv 4 \\pmod{7}$$\n最后一步是因为 $25 = 3 \\cdot 7 + 4$。因此，$x$ 的解是所有与 $4$ 模 $7$ 同余的整数。\n\n这组完整的整数解可以用参数形式表示。一个整数 $x$ 满足 $x \\equiv 4 \\pmod{7}$ 当且仅当它可以写成：\n$$x = 4 + 7m$$\n其中 $m$ 是某个整数 $m \\in \\mathbb{Z}$。因此，所有解的集合是等差数列 $\\{ \\dots, -10, -3, 4, 11, 18, \\dots \\}$，其形式上表示为集合 $4 + 7\\mathbb{Z}$。\n\n问题还要求模 $42$ 的不同剩余类。这些可以通过取 $m$ 从 $0$ 到 $d-1 = 5$ 的值来找到：\n当 $m=0$ 时，$x = 4$。\n当 $m=1$ 时，$x = 11$。\n当 $m=2$ 时，$x = 18$。\n当 $m=3$ 时，$x = 25$。\n当 $m=4$ 时，$x = 32$。\n当 $m=5$ 时，$x = 39$。\n当 $m=6$ 时，$x = 4 + 7(6) = 46 \\equiv 4 \\pmod{42}$，所以解开始重复。模 $42$ 有 $d=6$ 个不同的解。对于 $m \\in \\mathbb{Z}$ 的表达式 $x = 4+7m$ 是所有整数解的完整描述，这些解归结为模 $42$ 的这 $6$ 个不同的类。\n\n总而言之，$d=\\gcd(18, 42)=6$，且 $x$ 的所有整数解的集合由 $\\{x \\in \\mathbb{Z} \\mid x \\equiv 4 \\pmod{7}\\}$ 给出。", "answer": "$$\\boxed{\\pmatrix{6  4+7\\mathbb{Z}}}$$", "id": "3087491"}, {"introduction": "当模数 $N$ 是一个合数且其因子已知时，我们可以采用一种更巧妙、更高效的策略来计算模逆元。这个练习将引导你使用中国剩余定理（CRT）来解决问题，其核心思想是“分而治之”：将一个在大模数下的复杂问题分解为在较小素数模下的一系列简单问题，然后将结果组合起来。这个方法完美地展示了数论中不同核心概念之间的深刻联系。[@problem_id:3087494]", "problem": "设整数 $a$ 和 $N$ 满足 $a=35$ 和 $N=143$。整数 $N$ 可分解为 $N=11\\cdot 13$。从模逆元的定义和中国剩余定理（CRT）的陈述出发，确定最小非负整数 $x$ 使得 $a\\cdot x\\equiv 1\\pmod{N}$。求解过程为，首先求出 $a$ 模 $11$ 和模 $13$ 的逆，然后使用中国剩余定理（CRT）重构模 $N$ 的唯一解。请将您的最终答案表示为范围 $0\\leq x  N$ 内的整数。", "solution": "我们从定义开始：对于整数 $a$ 和 $m$ 且 $\\gcd(a,m)=1$，$a$ 模 $m$ 的模逆元是一个整数 $x$，使得 $a\\cdot x\\equiv 1\\pmod{m}$。此处 $a=35$ 且 $N=143=11\\cdot 13$。因为 $11$ 和 $13$ 是素数，我们只需检验 $\\gcd(35,11)=1$ 和 $\\gcd(35,13)=1$。此条件成立，因为 $35\\equiv 2\\pmod{11}$ 和 $35\\equiv 9\\pmod{13}$ 都是模素数的非零余数。\n\n步骤 $1$：计算 $a$ 模 $11$ 的逆。我们将 $a$ 模 $11$ 约化：$35\\equiv 2\\pmod{11}$。因此，求 $35$ 模 $11$ 的逆简化为求 $2$ 模 $11$ 的逆。根据扩展欧几里得算法，我们求解整数 $u$ 和 $v$ 使得 $2u+11v=1$。计算\n$$11=2\\cdot 5+1,$$\n整理后得到\n$$1=11-2\\cdot 5.$$\n模 $11$ 约化后得到 $1\\equiv -2\\cdot 5\\pmod{11}$，所以 $2$ 模 $11$ 的逆是 $-5\\equiv 6\\pmod{11}$。因此\n$$35^{-1}\\equiv 6\\pmod{11}.$$\n\n步骤 $2$：计算 $a$ 模 $13$ 的逆。将 $a$ 模 $13$ 约化：$35\\equiv 9\\pmod{13}$。我们使用扩展欧几里得算法求 $9$ 模 $13$ 的逆。计算\n$$13=9\\cdot 1+4,\\quad 9=4\\cdot 2+1.$$\n回代得到\n$$1=9-4\\cdot 2=9-\\left(13-9\\right)\\cdot 2=9\\cdot 3-13\\cdot 2.$$\n模 $13$ 约化后得到 $1\\equiv 9\\cdot 3\\pmod{13}$，所以 $9$ 模 $13$ 的逆是 $3$。因此\n$$35^{-1}\\equiv 3\\pmod{13}.$$\n\n步骤 $3$：使用中国剩余定理（CRT）重构模 $N=11\\cdot 13=143$ 的 $x$。中国剩余定理（CRT）指出，对于互质的模数 $11$ 和 $13$，联立同余方程组\n$$x\\equiv 6\\pmod{11},\\qquad x\\equiv 3\\pmod{13}$$\n在模 $143$ 下有唯一解。为求出具体解，设 $x=6+11k$（其中 $k$ 为某个整数），并代入第二个同余方程：\n$$6+11k\\equiv 3\\pmod{13}\\quad\\Longrightarrow\\quad 11k\\equiv -3\\equiv 10\\pmod{13}.$$\n我们现在求解 $k$ 模 $13$。为此，我们需要求 $11$ 模 $13$ 的逆。使用扩展欧几里得算法，\n$$13=11\\cdot 1+2,\\quad 11=2\\cdot 5+1,$$\n得到\n$$1=11-2\\cdot 5=11-\\left(13-11\\right)\\cdot 5=11\\cdot 6-13\\cdot 5.$$\n因此 $11\\cdot 6\\equiv 1\\pmod{13}$，所以 $11$ 模 $13$ 的逆是 $6$。将 $11k\\equiv 10\\pmod{13}$ 两边乘以 $6$ 得到\n$$k\\equiv 6\\cdot 10=60\\equiv 60-52=8\\pmod{13}.$$\n选择最小非负代表 $k=8$，我们得到\n$$x=6+11\\cdot 8=6+88=94.$$\n\n步骤 $4$：验证 $x=94$ 确实是 $35$ 模 $143$ 的逆。计算 $35\\cdot 94=3290$。模 $143$ 约化：\n$$143\\cdot 23=3289,\\quad 3290-3289=1,$$\n所以 $35\\cdot 94\\equiv 1\\pmod{143}$。根据模 $143$ 的唯一性，最小非负解是 $x=94$。\n\n因此，所求的模逆元是 $94$。", "answer": "$$\\boxed{94}$$", "id": "3087494"}]}