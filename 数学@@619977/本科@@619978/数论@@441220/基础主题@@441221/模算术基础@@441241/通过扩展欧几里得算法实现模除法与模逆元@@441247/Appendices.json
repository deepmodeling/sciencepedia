{"hands_on_practices": [{"introduction": "在尝试计算一个数的模逆元之前，一个至关重要的首要步骤是确定它是否存在。这个练习将引导你探讨一个模逆元不存在的情形，揭示其背后与最大公约数相关的根本性数学障碍。通过处理这种情况[@problem_id:3087269]，你将更深刻地理解贝祖等式 (Bézout's identity) 为何是判断可逆性的基石。", "problem": "考虑整数模 $n$。仅使用基本定义，通过第一性原理构建论证来判断可逆性，而不是依赖预先记忆的公式。给定 $a=840$ 和 $n=1001$，使用扩展欧几里得算法（EEA）来确定 $a$ 是否存在模 $n$ 的乘法逆元，如果存在则计算它。如果逆元不存在，请根据整除性解释其结构性障碍，并为了评分，报告 $d=\\gcd(a,n)$ 的值作为最终答案，其中 $\\gcd$ 表示最大公约数（gcd）。你的推理必须基于模逆元、最大公约数和整数线性组合的定义。最终答案必须是一个单一的数字。不需要四舍五入。", "solution": "问题要求我们确定整数 $a=840$ 是否存在模 $n=1001$ 的乘法逆元，如果存在则计算它。分析必须基于第一性原理并使用扩展欧几里得算法。\n\n首先，我们来确定基本定义。如果同余式 $ax \\equiv 1 \\pmod{n}$ 成立，则整数 $x$ 是 $a$ 模 $n$ 的乘法逆元。根据模同余的定义，这等价于陈述 $ax - 1$ 是 $n$ 的倍数。这意味着存在某个整数 $k$，使得 $ax - 1 = kn$。整理这个方程得到线性丢番图方程 $ax - kn = 1$。令 $y = -k$，我们寻求方程 $ax + ny = 1$ 的整数解 $(x, y)$。\n\n这类方程整数解的存在性由一个与最大公约数（gcd）相关的基本性质决定。两个整数 $a$ 和 $n$ 的最大公约数，记为 $d = \\gcd(a, n)$，是能同时整除 $a$ 和 $n$ 的最大正整数。一个关键结果，通常称为裴蜀恒等式（Bézout's identity），指出最大公约数 $d$ 可以表示为 $a$ 和 $n$ 的一个整数线性组合。也就是说，存在整数 $x'$ 和 $y'$ 使得 $ax' + ny' = d$。此外，$d$ 是可以以这种形式表示的最小正整数。因此，任何线性组合 $ax + ny$ 都必须是 $d = \\gcd(a, n)$ 的倍数。\n\n结合这些原理，$a$ 模 $n$ 的乘法逆元存在的充要条件是方程 $ax + ny = 1$ 有整数解。这仅在 $1$ 是 $d = \\gcd(a, n)$ 的倍数时才可能。由于 $d$ 是一个正整数，这个条件简化为 $d = 1$。因此，$a$ 模 $n$ 可逆的充要条件是 $a$ 和 $n$ 互质，即 $\\gcd(a, n) = 1$。\n\n我们现在使用欧几里得算法来计算 $a=840$ 和 $n=1001$ 的最大公约数。该算法通过一系列带余除法进行：\n$$1001 = 1 \\cdot 840 + 161$$\n$$840 = 5 \\cdot 161 + 35$$\n$$161 = 4 \\cdot 35 + 21$$\n$$35 = 1 \\cdot 21 + 14$$\n$$21 = 1 \\cdot 14 + 7$$\n$$14 = 2 \\cdot 7 + 0$$\n最后一个非零余数是最大公约数。在这种情况下，我们发现 $\\gcd(840, 1001) = 7$。\n\n由于 $\\gcd(840, 1001) = 7 \\neq 1$，整数 $a=840$ 不存在模 $n=1001$ 的乘法逆元。\n\n这个结构性障碍是最大公约数的直接结果。$840$ 和 $1001$ 的任何线性组合都必须是它们的最大公约数 $7$ 的倍数。具体来说，因为 $7$ 整除 $840$（即 $840 = 120 \\cdot 7$）并且 $7$ 整除 $1001$（即 $1001 = 143 \\cdot 7$），对于整数 $x$ 和 $y$，任何形式为 $840x + 1001y$ 的表达式都可以因式分解为：\n$$840x + 1001y = (120 \\cdot 7)x + (143 \\cdot 7)y = 7(120x + 143y)$$\n这表明任何可以表示为 $840$ 和 $1001$ 的线性组合的整数都必须能被 $7$ 整除。整数 $1$ 不能被 $7$ 整除，所以方程 $840x + 1001y = 1$ 没有整数解。这直接意味着同余式 $840x \\equiv 1 \\pmod{1001}$ 没有解 $x$。\n\n问题指出，如果逆元不存在，我们必须报告 $d = \\gcd(a, n)$ 的值。根据计算，这个值是 $7$。", "answer": "$$\\boxed{7}$$", "id": "3087269"}, {"introduction": "一旦确认模逆元存在，下一步就是掌握计算它的系统方法。这个实践提供了一个典型的计算实例[@problem_id:3087285]，它将带你完整地走一遍扩展欧几里得算法的“回代”过程。这个过程不仅是一个机械的计算，更是对贝祖等式构造性证明的直接应用，是数论中的一项基本功。", "problem": "在模 $n$ 整数环中，一个整数 $a$ 模 $n$ 乘法可逆，当且仅当存在一个整数 $x$ 使得 $a x \\equiv 1 \\pmod{n}$。根据裴蜀恒等式，这样一个 $x$ 的存在性等价于最大公约数条件 $\\gcd(a,n)=1$。裴蜀恒等式断言，存在整数 $u$ 和 $v$ 满足 $u a + v n = \\gcd(a,n)$。扩展欧几里得算法 (EEA) 是一个找出此类整数 $u$ 和 $v$ 的构造性过程。\n\n从这些基本定义和事实出发，通过计算 $\\gcd(425,987)$ 来判断 $a = 425$ 是否模 $n = 987$ 可逆。如果可逆，则使用扩展欧几里得算法计算唯一的最小非负余数 $x \\in \\{0,1,\\dots,986\\}$，使得 $425 x \\equiv 1 \\pmod{987}$。请将最终答案以指定范围内的单个整数形式给出。无需四舍五入。", "solution": "问题要求在模 $n=987$ 的整数环中求整数 $a=425$ 的乘法逆元。一个整数 $a$ 模 $n$ 有乘法逆元，当且仅当 $a$ 和 $n$ 的最大公约数为 $1$，即 $\\gcd(a, n) = 1$。\n\n首先，我们应用欧几里得算法来计算 $\\gcd(425, 987)$。\n除法序列如下：\n$$987 = 2 \\cdot 425 + 137$$\n$$425 = 3 \\cdot 137 + 14$$\n$$137 = 9 \\cdot 14 + 11$$\n$$14 = 1 \\cdot 11 + 3$$\n$$11 = 3 \\cdot 3 + 2$$\n$$3 = 1 \\cdot 2 + 1$$\n$$2 = 2 \\cdot 1 + 0$$\n此序列中最后一个非零余数是 $1$。因此，我们有 $\\gcd(425, 987) = 1$。由于最大公约数为 $1$，整数 $425$ 确实是模 $987$ 可逆的。\n\n接下来，我们使用扩展欧几里得算法来找到整数 $u$ 和 $v$，使得 $425u + 987v = 1$。我们通过从欧几里得算法的步骤中回溯，将最大公约数（$1$）表示为前面步骤中各数的线性组合来实现。\n\n从算法的倒数第二行开始：\n$$1 = 3 - 1 \\cdot 2$$\n用方程 $11 = 3 \\cdot 3 + 2$ 代入余数 $2$，得到 $2 = 11 - 3 \\cdot 3$：\n$$1 = 3 - 1 \\cdot (11 - 3 \\cdot 3) = 3 - 1 \\cdot 11 + 3 \\cdot 3 = 4 \\cdot 3 - 1 \\cdot 11$$\n用方程 $14 = 1 \\cdot 11 + 3$ 代入余数 $3$，得到 $3 = 14 - 1 \\cdot 11$：\n$$1 = 4 \\cdot (14 - 1 \\cdot 11) - 1 \\cdot 11 = 4 \\cdot 14 - 4 \\cdot 11 - 1 \\cdot 11 = 4 \\cdot 14 - 5 \\cdot 11$$\n用方程 $137 = 9 \\cdot 14 + 11$ 代入余数 $11$，得到 $11 = 137 - 9 \\cdot 14$：\n$$1 = 4 \\cdot 14 - 5 \\cdot (137 - 9 \\cdot 14) = 4 \\cdot 14 - 5 \\cdot 137 + 45 \\cdot 14 = 49 \\cdot 14 - 5 \\cdot 137$$\n用方程 $425 = 3 \\cdot 137 + 14$ 代入余数 $14$，得到 $14 = 425 - 3 \\cdot 137$：\n$$1 = 49 \\cdot (425 - 3 \\cdot 137) - 5 \\cdot 137 = 49 \\cdot 425 - 147 \\cdot 137 - 5 \\cdot 137 = 49 \\cdot 425 - 152 \\cdot 137$$\n最后，用方程 $987 = 2 \\cdot 425 + 137$ 代入余数 $137$，得到 $137 = 987 - 2 \\cdot 425$：\n$$1 = 49 \\cdot 425 - 152 \\cdot (987 - 2 \\cdot 425) = 49 \\cdot 425 - 152 \\cdot 987 + 304 \\cdot 425$$\n合并包含 $425$ 的项，我们得到：\n$$1 = (49 + 304) \\cdot 425 - 152 \\cdot 987$$\n$$1 = 353 \\cdot 425 - 152 \\cdot 987$$\n这个方程是 $a=425$ 和 $n=987$ 的裴蜀恒等式，其中 $u=353$ 且 $v=-152$。\n\n为了找到 $425$ 模 $987$ 的乘法逆元，我们在模 $987$ 的整数环中考虑这个恒等式：\n$$353 \\cdot 425 - 152 \\cdot 987 \\equiv 1 \\pmod{987}$$\n由于 $152 \\cdot 987$ 是 $987$ 的倍数，它模 $987$ 的余数是 $0$。\n$$353 \\cdot 425 - 0 \\equiv 1 \\pmod{987}$$\n$$353 \\cdot 425 \\equiv 1 \\pmod{987}$$\n这个同余关系表明 $x=353$ 是 $425$ 模 $987$ 的乘法逆元。\n\n问题要求集合 $\\{0, 1, \\dots, 986\\}$ 中的唯一最小非负余数 $x$。由于 $0 \\le 353 \\le 986$，我们的值 $x=353$ 即为所求的答案。", "answer": "$$\\boxed{353}$$", "id": "3087285"}, {"introduction": "求解模逆元 $a^{-1}$ 本质上是解一个特殊的线性同余方程 $ax \\equiv 1 \\pmod{m}$。然而，扩展欧几里得算法的威力远不止于此。这个最终的练习 [@problem_id:3087279] 将向你展示如何将已学技能推广，用以解决形如 $ax \\equiv b \\pmod{m}$ 的一般线性同余方程，并理解为何这类方程可能存在多个解。", "problem": "设 $a$、$b$ 和 $m$ 为整数，其中 $m \\geq 2$。回顾一下，$a x \\equiv b \\pmod{m}$ 意味着 $m$ 整除 $a x - b$，而最大公约数 $\\gcd(a,m)$ 是能同时整除 $a$ 和 $m$ 的最大正整数。从这些定义和基本的整除性质出发，对具体的同余式 $14 x \\equiv 21 \\pmod{35}$ 按以下步骤进行：\n1. 确定 $\\gcd(14,35)$ 并用它来判断该同余式是否可解。如果可解，通过除以 $\\gcd(14,35)$ 将其化简为一个具有更小模的等价同余式。\n2. 使用扩展欧几里得算法 (EEA) 找到一个乘法逆元来求解化简后的同余式，并得到一个在简化模下的规范解。\n3. 解释原同余式在模 $35$ 下有多少个互不同余的解，并仅使用整除性和同余的论据，通过从简化模提升到模 $35$ 来证明所有解的形式。\n4. 将所有在模 $35$ 下的互不同余解，以集合 $\\{0,1,2,\\dots,34\\}$ 中递增整数的形式列出。\n\n你的最终答案应该是这些整数的完整列表，使用 LaTeX 的 $\\pmatrix$ 符号写成一行，并按递增顺序排列。无需四舍五入。", "solution": "问题是求解线性同余式 $14x \\equiv 21 \\pmod{35}$。令 $a = 14$，$b = 21$，$m = 35$。该同余式的形式为 $ax \\equiv b \\pmod{m}$。\n\n1. 首先，我们确定 $a$ 和 $m$ 的最大公约数，即 $\\gcd(14, 35)$。我们使用欧几里得算法：\n$$35 = 2 \\cdot 14 + 7$$\n$$14 = 2 \\cdot 7 + 0$$\n最后一个非零余数是 $7$，所以 $d = \\gcd(14, 35) = 7$。\n线性同余式 $ax \\equiv b \\pmod{m}$ 有解的充要条件是 $d$ 整除 $b$。在本例中，$d=7$ 且 $b=21$。因为 $21 = 3 \\cdot 7$，所以 $d$ 整除 $b$，因此该同余式是可解的。\n为了化简该同余式，我们可以使用定义：$ax \\equiv b \\pmod{m}$ 等价于 $ax - b = mk$（对于某个整数 $k$）。对于我们的具体问题，即为 $14x - 21 = 35k$。我们可以将整个方程除以 $d=7$：\n$$(14/7)x - (21/7) = (35/7)k$$\n$$2x - 3 = 5k$$\n这个丢番图方程等价于化简后的同余式 $2x \\equiv 3 \\pmod{5}$。新的模是 $m' = m/d = 35/7 = 5$。\n\n2. 接下来，我们求解化简后的同余式 $2x \\equiv 3 \\pmod{5}$。为此，我们求 $2$ 模 $5$ 的乘法逆元。由于 $\\gcd(2, 5) = 1$，逆元存在。我们使用扩展欧几里得算法 (EEA)。用于求 $\\gcd(2, 5)$ 的欧几里得算法如下：\n$$5 = 2 \\cdot 2 + 1$$\n现在我们通过回溯将最大公约数 $1$ 表示为 $5$ 和 $2$ 的线性组合：\n$$1 = 5 - 2 \\cdot 2$$\n$$1 = (1) \\cdot 5 + (-2) \\cdot 2$$\n将此方程模 $5$ 运算，我们得到：\n$$(1) \\cdot 5 + (-2) \\cdot 2 \\equiv 1 \\pmod{5}$$\n$$0 + (-2) \\cdot 2 \\equiv 1 \\pmod{5}$$\n所以，$2$ 模 $5$ 的乘法逆元是 $-2$。在集合 $\\{0, 1, 2, 3, 4\\}$ 中的规范代表元是 $-2 + 5 = 3$。我们可以验证 $2 \\cdot 3 = 6 \\equiv 1 \\pmod{5}$。\n现在，我们将化简后的同余式 $2x \\equiv 3 \\pmod{5}$ 的两边都乘以逆元 $3$：\n$$3 \\cdot (2x) \\equiv 3 \\cdot 3 \\pmod{5}$$\n$$(3 \\cdot 2)x \\equiv 9 \\pmod{5}$$\n$$1 \\cdot x \\equiv 4 \\pmod{5}$$\n$$x \\equiv 4 \\pmod{5}$$\n在简化模 $5$ 下的规范解是 $x_0 = 4$。\n\n3. 同余式 $ax \\equiv b \\pmod{m}$ 的互不同余解的个数由 $d = \\gcd(a, m)$ 给出，前提是 $d|b$。这里，$d=7$，所以存在 $7$ 个模 $35$ 下互不同余的解。\n化简后的同余式的解 $x \\equiv 4 \\pmod{5}$ 意味着任何解 $x$ 都必须满足关系式 $x = 4 + 5k$（其中 $k$ 是某个整数）。我们现在需要找出哪些 $k$ 值可以生成模 $35$ 下的不同解。\n假设两个解 $x_1 = 4 + 5k_1$ 和 $x_2 = 4 + 5k_2$ 在模 $35$ 下是同余的。\n$$4 + 5k_1 \\equiv 4 + 5k_2 \\pmod{35}$$\n$$5k_1 \\equiv 5k_2 \\pmod{35}$$\n根据同余的定义，这意味着 $35 | (5k_1 - 5k_2)$，即 $35 | 5(k_1 - k_2)$。\n这意味着存在一个整数 $c$ 使得 $5(k_1 - k_2) = 35c$。两边除以 $5$，我们得到 $k_1 - k_2 = 7c$，这意味着 $7 | (k_1 - k_2)$，即 $k_1 \\equiv k_2 \\pmod{7}$。\n因此，我们通过选择模 $7$ 下互不同余的 $k$ 值来获得模 $35$ 下的不同解。$k$ 模 $7$ 的一个完全代表系是 $\\{0, 1, 2, 3, 4, 5, 6\\}$。这证实了恰好有 $7$ 个不同的解。\n完整的解集是通过将基础解 $x_0 = 4$ 从简化模 $5$ “提升”到原始模 $35$ 生成的。解的一般形式是 $x_k = x_0 + k(m/d)$，其中 $k = 0, 1, \\dots, d-1$。在我们的例子中，即为 $x_k = 4 + k(35/7) = 4 + 5k$，其中 $k \\in \\{0, 1, 2, 3, 4, 5, 6\\}$。\n\n4. 最后，我们将 $k$ 的值从 $0$ 到 $6$ 代入公式 $x = 4 + 5k$，列出所有 $7$ 个模 $35$ 下的互不同余解。这些解必须在集合 $\\{0, 1, \\dots, 34\\}$ 中。\n当 $k=0$ 时：$x = 4 + 5(0) = 4$\n当 $k=1$ 时：$x = 4 + 5(1) = 9$\n当 $k=2$ 时：$x = 4 + 5(2) = 14$\n当 $k=3$ 时：$x = 4 + 5(3) = 19$\n当 $k=4$ 时：$x = 4 + 5(4) = 24$\n当 $k=5$ 时：$x = 4 + 5(5) = 29$\n当 $k=6$ 时：$x = 4 + 5(6) = 34$\n所有互不同余解按递增顺序排列的完整列表是 $4, 9, 14, 19, 24, 29, 34$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  9  14  19  24  29  34\n\\end{pmatrix}\n}\n$$", "id": "3087279"}]}