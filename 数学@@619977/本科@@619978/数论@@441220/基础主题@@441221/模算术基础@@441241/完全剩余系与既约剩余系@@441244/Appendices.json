{"hands_on_practices": [{"introduction": "本练习旨在从根本上构建我们对欧拉函数 $\\varphi(n)$ 和既约剩余系的理解。我们将不依赖于现成的公式，而是从第一性原理出发，推导 $\\varphi(n)$ 的计算方法，并阐明如何利用中国剩余定理来系统地描述一个既约剩余系的结构。这个过程将为您处理更复杂模数下的问题打下坚实的理论基础。[@problem_id:3083419]", "problem": "设 $a$、 $b$ 和 $c$ 为正整数，且 $n=2^{a}3^{b}5^{c}$。仅从欧拉函数 $\\varphi(n)$ 的定义（即对满足 $1 \\leq r \\leq n$ 和 $\\gcd(r,n)=1$ 的整数 $r$ 进行计数）以及模 $n$ 的简化剩余系的定义（即任何由 $\\varphi(n)$ 个与 $n$ 互质且模 $n$ 两两不同余的余数组成的集合）出发，完成以下任务：\n\n1. 明确地用 $a$、 $b$ 和 $c$ 表示 $\\varphi(n)$。你的推导应从第一性原理出发，例如使用针对素数幂的计数论证以及模互质模数的整数的结构性质，并且不得预先假设任何关于 $\\varphi$ 的现成公式。\n\n2. 使用你的结果和模素数幂的可逆剩余类的结构描述，写出一个模 $n$ 的显式简化剩余系。\n\n为便于评分，请将你的最终答案报告为 $\\varphi(n)$ 关于 $a$、 $b$ 和 $c$ 的单个封闭形式表达式。不需要数值近似。", "solution": "该问题陈述经核实是科学上合理的、定义明确且客观的。这是初等数论中的一个标准问题。所给条件充分且一致。\n\n该问题要求两个主要结果：首先，从第一性原理推导当 $n=2^{a}3^{b}5^{c}$ 时欧拉函数 $\\varphi(n)$ 的表达式；其次，对模 $n$ 的简化剩余系进行显式描述。需要报告的最终答案是 $\\varphi(n)$ 的封闭形式表达式。\n\n首先，我们来确定 $\\varphi(n)$。推导过程分三步：计算素数 $p$ 的幂 $\\varphi(p^k)$，证明 $\\varphi$ 是一个积性函数，然后结合这些结果求出 $\\varphi(n)$。\n\n设 $p$ 是一个素数，$k$ 是一个正整数。根据定义，$\\varphi(p^k)$ 是集合 $\\{1, 2, \\ldots, p^k\\}$ 中满足 $\\gcd(r, p^k) = 1$ 的整数 $r$ 的个数。条件 $\\gcd(r, p^k) = 1$ 等价于 $r$ 不能被 $p$ 整除。为了求出 $\\varphi(p^k)$，我们可以计算该范围内的整数总数（即 $p^k$），然后减去与 $p^k$ 不互质的整数个数。\n在给定范围内的整数 $r$ 与 $p^k$ 不互质，当且仅当 $\\gcd(r, p^k) > 1$。由于 $p$ 是 $p^k$ 的唯一素因子，这等价于 $r$ 是 $p$ 的倍数。在集合 $\\{1, 2, \\ldots, p^k\\}$ 中 $p$ 的倍数是 $1 \\cdot p, 2 \\cdot p, \\ldots, m \\cdot p$，使得 $m \\cdot p \\leq p^k$。这个不等式可以简化为 $m \\leq p^{k-1}$。因此，在该范围内恰好有 $p^{k-1}$ 个这样的 $p$ 的倍数。\n与 $p^k$ 互质的整数个数是整数总数减去不互质的整数个数。\n$$ \\varphi(p^k) = (\\text{total numbers}) - (\\text{numbers not coprime to } p^k) = p^k - p^{k-1} $$\n这可以因式分解为 $\\varphi(p^k) = p^{k-1}(p-1)$ 或 $\\varphi(p^k) = p^k(1 - \\frac{1}{p})$。\n\n接下来，我们证明 $\\varphi$ 是一个积性函数。即，对于任意两个互质的正整数 $m_1$ 和 $m_2$，我们有 $\\varphi(m_1 m_2) = \\varphi(m_1)\\varphi(m_2)$。我们使用模 $m_1 m_2$ 的整数环的结构。\n根据中国剩余定理，由于 $\\gcd(m_1, m_2) = 1$，存在一个环同构\n$$ \\Psi: \\mathbb{Z}_{m_1 m_2} \\to \\mathbb{Z}_{m_1} \\times \\mathbb{Z}_{m_2} $$\n其定义为 $\\Psi([x]_{m_1 m_2}) = ([x]_{m_1}, [x]_{m_2})$，其中 $[x]_k$ 表示 $x$ 模 $k$ 的剩余类。环 $\\mathbb{Z}_k$ 中的一个元素 $[x]_k$ 是一个单位元，当且仅当 $\\gcd(x,k)=1$。$\\mathbb{Z}_k$ 中的单位元集合记为 $(\\mathbb{Z}_k)^\\times$，其大小为 $|\\left(\\mathbb{Z}_k\\right)^\\times| = \\varphi(k)$。\n一个整数 $x$ 与乘积 $m_1 m_2$ 互质，当且仅当它同时与 $m_1$ 和 $m_2$ 互质，因为 $m_1$ 和 $m_2$ 没有公共的素因子。\n$$ \\gcd(x, m_1 m_2) = 1 \\iff \\gcd(x, m_1) = 1 \\text{ and } \\gcd(x, m_2) = 1 $$\n这意味着环同构 $\\Psi$ 可以限制为单位元群之间的一个群同构：\n$$ \\Psi|_{(\\mathbb{Z}_{m_1 m_2})^\\times}: (\\mathbb{Z}_{m_1 m_2})^\\times \\to (\\mathbb{Z}_{m_1})^\\times \\times (\\mathbb{Z}_{m_2})^\\times $$\n由于这个映射是一个同构，它是一个双射。因此，定义域的基数必须等于陪域的基数。\n$$ |(\\mathbb{Z}_{m_1 m_2})^\\times| = |(\\mathbb{Z}_{m_1})^\\times \\times (\\mathbb{Z}_{m_2})^\\times| = |(\\mathbb{Z}_{m_1})^\\times| \\cdot |(\\mathbb{Z}_{m_2})^\\times| $$\n这个基数相等的关系正是 $\\varphi(m_1 m_2) = \\varphi(m_1)\\varphi(m_2)$ 的陈述。\n\n现在我们可以计算 $n = 2^a 3^b 5^c$ 的 $\\varphi(n)$。已知整数 $a, b, c$ 为正数。因子 $2^a, 3^b, 5^c$ 两两互质。重复应用 $\\varphi$ 的积性性质，我们得到：\n$$ \\varphi(n) = \\varphi(2^a 3^b 5^c) = \\varphi(2^a) \\varphi(3^b) \\varphi(5^c) $$\n使用我们早先推导出的公式 $\\varphi(p^k) = p^k - p^{k-1}$：\n对于 $p=2, k=a$:\n$$ \\varphi(2^a) = 2^a - 2^{a-1} = 2^{a-1}(2-1) = 2^{a-1} $$\n对于 $p=3, k=b$:\n$$ \\varphi(3^b) = 3^b - 3^{b-1} = 3^{b-1}(3-1) = 2 \\cdot 3^{b-1} $$\n对于 $p=5, k=c$:\n$$ \\varphi(5^c) = 5^c - 5^{c-1} = 5^{c-1}(5-1) = 4 \\cdot 5^{c-1} = 2^2 \\cdot 5^{c-1} $$\n将这些表达式代回关于 $\\varphi(n)$ 的方程中：\n$$ \\varphi(n) = (2^{a-1}) \\cdot (2 \\cdot 3^{b-1}) \\cdot (2^2 \\cdot 5^{c-1}) $$\n合并 $2$ 的幂：\n$$ \\varphi(n) = 2^{a-1+1+2} \\cdot 3^{b-1} \\cdot 5^{c-1} = 2^{a+2} \\cdot 3^{b-1} \\cdot 5^{c-1} $$\n这就是用 $a, b, c$ 表示的 $\\varphi(n)$ 的显式表达式。\n\n对于问题的第二部分，我们描述一个模 $n$ 的显式简化剩余系。模 $n$ 的简化剩余系是一个包含 $\\varphi(n)$ 个整数的集合，这些整数模 $n$ 不同余，且每一个都与 $n$ 互质。正如在积性证明中所确立的，一个整数 $r$ 与 $n=2^a 3^b 5^c$ 互质，当且仅当它与 $2^a$，$3^b$ 和 $5^c$ 中的每一个都互质。这意味着 $r$ 必须满足：\n$ \\gcd(r, 2^a) = 1 $，即 $r$ 是奇数。\n$ \\gcd(r, 3^b) = 1 $，即 $r$ 不能被 $3$ 整除。\n$ \\gcd(r, 5^c) = 1 $，即 $r$ 不能被 $5$ 整除。\n\n基于中国剩余定理，可以构造一个模 $n$ 的完全简化剩余系。设 $R_{2^a}$，$R_{3^b}$ 和 $R_{5^c}$ 分别是模 $2^a$，$3^b$ 和 $5^c$ 的简化剩余系。\n$R_{2^a} = \\{r_1 \\in \\mathbb{Z} \\mid 1 \\le r_1 \\le 2^a, \\gcd(r_1, 2) = 1 \\}$。这是所有不大于 $2^a$ 的奇数集合。\n$R_{3^b} = \\{r_2 \\in \\mathbb{Z} \\mid 1 \\le r_2 \\le 3^b, \\gcd(r_2, 3) = 1 \\}$。这是所有不大于 $3^b$ 且不能被 $3$ 整除的整数集合。\n$R_{5^c} = \\{r_3 \\in \\mathbb{Z} \\mid 1 \\le r_3 \\le 5^c, \\gcd(r_3, 5) = 1 \\}$。这是所有不大于 $5^c$ 且不能被 $5$ 整除的整数集合。\n\n对于每个三元组 $(r_1, r_2, r_3)$，其中 $r_1 \\in R_{2^a}$，$r_2 \\in R_{3^b}$，$r_3 \\in R_{5^c}$，对于以下同余方程组，存在一个唯一的模 $n$ 解 $r$：\n$$ r \\equiv r_1 \\pmod{2^a} $$\n$$ r \\equiv r_2 \\pmod{3^b} $$\n$$ r \\equiv r_3 \\pmod{5^c} $$\n所有这些唯一解 $r$ 的集合构成了一个模 $n$ 的完全简化剩余系。这样的三元组的数目是 $\\varphi(2^a)\\varphi(3^b)\\varphi(5^c) = \\varphi(n)$，所以这个构造产生了一个大小正确的集合。这按要求提供了一个对简化剩余系的结构性的、显式的（尽管没有一一列举）描述。\n\n最终应报告的答案是 $\\varphi(n)$ 的封闭形式表达式。", "answer": "$$\\boxed{2^{a+2} 3^{b-1} 5^{c-1}}$$", "id": "3083419"}, {"introduction": "理论需要通过实践来巩固。本练习将上一节的通用方法应用于一个具体的、非平凡的例子 $n=840$。您将有机会亲手运用容斥原理来精确计算与 $n$ 互质的整数数量，并再次利用中国剩余定理，从更小的素数幂模的解“拼接”出模 $840$ 的既约剩余系。[@problem_id:3083422]", "problem": "设 $n=840$。模 $n$ 的完全剩余系是一个包含 $n$ 个整数的集合，每个整数来自模 $n$ 的一个同余类。模 $n$ 的既约剩余系是一个包含 $\\varphi(n)$ 个整数的集合，每个整数来自模 $n$ 的一个与 $n$ 互质的同余类，其中 $\\varphi(n)$ 是欧拉函数，定义为满足 $1 \\leq k \\leq n$ 和 $\\gcd(k,n)=1$ 的整数 $k$ 的数量。从这些定义和标准计数原理出发，完成以下任务：\n- 仅根据定义确定 $\\varphi(840)$ 的值，并从第一性原理证明你的计数过程，而不是引用欧拉函数的封闭公式。\n- 通过给出一个具体的、有限的规范，明确地构造一个模 $840$ 的既约剩余系，该规范能精确生成所有与 $840$ 互质的模 $840$ 同余类，并解释为什么你的构造能产生两两不同余且都与 $840$ 互质的代表元。\n\n作为你的最终答案，只报告 $\\varphi(840)$ 的值，形式为一个整数。最终答案中不要包含任何列表。", "solution": "题目要求从第一性原理出发，确定 $n=840$ 的欧拉函数值，记为 $\\varphi(840)$，并明确构造一个模 $840$ 的既约剩余系。\n\n首先，我们确定 $\\varphi(840)$ 的值。根据定义，$\\varphi(n)$ 是不超过 $n$ 且与 $n$ 互质的正整数的个数。对于 $n=840$，我们必须计算满足 $1 \\le k \\le 840$ 和 $\\gcd(k, 840) = 1$ 的整数 $k$ 的数量。\n\n一个整数 $k$ 与 $840$ 互质，当且仅当它不能被 $840$ 的任何质因数整除。我们首先对 $840$ 进行质因数分解：\n$$840 = 84 \\times 10 = (4 \\times 21) \\times (2 \\times 5) = (2^2 \\times 3 \\times 7) \\times (2 \\times 5) = 2^3 \\times 3 \\times 5 \\times 7$$\n$840$ 的不同质因数是 $p_1=2$, $p_2=3$, $p_3=5$ 和 $p_4=7$。\n因此，我们需要计算集合 $S = \\{1, 2, \\dots, 840\\}$ 中不能被 2, 3, 5, 7 中任何一个整除的整数的数量。这可以通过容斥原理来完成。这个原理的一个紧凑形式是：\n$$ \\varphi(840) = 840 \\left(1 - \\frac{1}{2}\\right) \\left(1 - \\frac{1}{3}\\right) \\left(1 - \\frac{1}{5}\\right) \\left(1 - \\frac{1}{7}\\right) $$\n该公式直接源于从总数中系统地剔除掉是各质因数倍数的数的过程。计算结果为：\n$$ \\varphi(840) = 840 \\times \\frac{1}{2} \\times \\frac{2}{3} \\times \\frac{4}{5} \\times \\frac{6}{7} = (840 \\div (2 \\times 3 \\times 5 \\times 7)) \\times (1 \\times 2 \\times 4 \\times 6) = 4 \\times 48 = 192 $$\n另一种从第一性原理出发的方法是证明 $\\varphi$ 函数的积性，并计算各素数幂的 $\\varphi$ 值。\n由于 $2^3, 3, 5, 7$ 两两互质，我们有 $\\varphi(840) = \\varphi(2^3) \\varphi(3) \\varphi(5) \\varphi(7)$。\n- 对于素数 $p$，$\\varphi(p) = p-1$。因此 $\\varphi(3)=2, \\varphi(5)=4, \\varphi(7)=6$。\n- 对于素数幂 $p^k$，$\\varphi(p^k)=p^k - p^{k-1}$。因此 $\\varphi(2^3) = 2^3 - 2^2 = 8-4=4$。\n将它们相乘：\n$$ \\varphi(840) = 4 \\times 2 \\times 4 \\times 6 = 192 $$\n两种方法都确认了 $\\varphi(840)=192$。\n\n对于第二部分，我们通过中国剩余定理 (CRT) 构造一个模 840 的既约剩余系。一个整数 $k$ 与 $840 = 2^3 \\times 3 \\times 5 \\times 7$ 互质，当且仅当它与每个素数幂因子都互质。这等价于以下同余条件：\n1. $\\gcd(k, 8) = 1 \\implies k \\in \\{1, 3, 5, 7\\} \\pmod 8$ (有 $\\varphi(8)=4$ 个选择)\n2. $\\gcd(k, 3) = 1 \\implies k \\in \\{1, 2\\} \\pmod 3$ (有 $\\varphi(3)=2$ 个选择)\n3. $\\gcd(k, 5) = 1 \\implies k \\in \\{1, 2, 3, 4\\} \\pmod 5$ (有 $\\varphi(5)=4$ 个选择)\n4. $\\gcd(k, 7) = 1 \\implies k \\in \\{1, 2, 3, 4, 5, 6\\} \\pmod 7$ (有 $\\varphi(7)=6$ 个选择)\n\n根据中国剩余定理，对于从这四个条件集合中选出的每一个组合 $(r_1, r_2, r_3, r_4)$，其中 $r_1 \\in \\{1,3,5,7\\}$, $r_2 \\in \\{1,2\\}$, $r_3 \\in \\{1,2,3,4\\}$, $r_4 \\in \\{1,2,3,4,5,6\\}$，都存在一个唯一的模 840 的解 $k$ 满足同余方程组：\n$$ k \\equiv r_1 \\pmod 8 $$\n$$ k \\equiv r_2 \\pmod 3 $$\n$$ k \\equiv r_3 \\pmod 5 $$\n$$ k \\equiv r_4 \\pmod 7 $$\n所有这些解的集合就构成了一个模 840 的既约剩余系。这个集合的大小为 $4 \\times 2 \\times 4 \\times 6 = 192$，与我们计算的 $\\varphi(840)$ 相符。这个规范精确地生成了所有与 840 互质的模 840 同余类，因为每个解 $k$ 都与 8, 3, 5, 7 互质，因此与 840 互质，并且根据 CRT 的唯一性，不同的组合会产生不同的模 840 的解。", "answer": "$$\\boxed{192}$$", "id": "3083422"}, {"introduction": "一个既约剩余系不仅是一个数的集合，它在模乘法下更构成一个重要的代数结构——群。本练习将这一抽象概念具体化，通过追踪一个单位元（unit）的乘法操作在既约剩余系上引起的置换，让您直观地探索其群结构。这不仅加深了您对既约剩余系的理解，也将其与群论中的循环分解等核心概念联系起来。[@problem_id:3083425]", "problem": "设 $n$ 是一个正整数，模 $n$ 的一个单位 (unit) 是指一个整数 $u$ 满足 $\\gcd(u,n)=1$，其中 $\\gcd$ 表示最大公约数 (Greatest Common Divisor, GCD)。模 $n$ 的既约剩余系 (reduced residue system) 是一个由与 $n$ 互质的剩余类的完全代表元组成的集合，恰好包含 $\\varphi(n)$ 个元素，其中 $\\varphi$ 是欧拉$\\varphi$函数。考虑由 $f(a)\\equiv ua\\pmod{n}$ 给出的映射 $f:\\mathbb{Z}\\to\\mathbb{Z}$，及其在模 $n$ 的既约剩余系上的限制。因为 $u$ 是一个单位，所以这个限制在既约剩余系上导出一个置换。\n\n在模 $n=21$ 和固定单位 $u=10$ 的条件下，从第一性原理出发，完成以下任务：\n- 显式地构造一个模21的既约剩余系，按升序排列。\n- 使用导出置换的定义，对既约剩余系中的每个元素 $a$ 计算 $f(a)\\equiv 10a\\pmod{21}$，并写出所得到的置换。\n- 通过对每个尚未分配到轮换中的元素 $a$，追踪其迭代序列 $a, f(a), f^{2}(a),\\dots$ 直到返回 $a$，来计算该置换分解为不相交轮换的结果。\n- 最后，确定该置换的符号（即，它是偶置换还是奇置换），偶置换表示为 $1$，奇置换表示为 $-1$。\n\n你的最终答案必须是一个精确的单一数字，$1$ 或 $-1$。不需要四舍五入。", "solution": "我们从定义开始。模 $n$ 的既约剩余系是任意一个整数集合，其中每个整数都代表一个与 $n$ 互质的、不同的模 $n$ 剩余类。这些剩余类的数量由欧拉$\\varphi$函数 $\\varphi(n)$ 给出。如果 $u$ 是模 $n$ 的一个单位，即 $\\gcd(u,n)=1$，那么乘以 $u$ 的操作会在此集合上导出一个置换，因为映射 $a\\mapsto ua\\pmod{n}$ 是双射的：它有逆映射 $a\\mapsto u^{-1}a\\pmod{n}$，根据单位的定义，模 $n$ 的 $u^{-1}$ 存在。\n\n我们在 $n=21$ 和 $u=10$ 的条件下进行计算。首先，我们构造一个模21的既约剩余系。在1到21之间与21互质的整数是那些不能被3或7整除的数。将它们按升序排列，我们得到\n$$\n\\{1,2,4,5,8,10,11,13,16,17,19,20\\}。\n$$\n共有12个元素，这与 $\\varphi(21)=\\varphi(3)\\varphi(7)=2\\cdot 6=12$ 一致。\n\n接下来，我们构造由模21下乘以 $u=10$ 所导出的置换。对于既约剩余系中的每个 $a$，计算 $f(a)\\equiv 10a\\pmod{21}$：\n- $f(1)\\equiv 10\\pmod{21}$，所以 $1\\mapsto 10$。\n- $f(10)\\equiv 100\\equiv 100-84\\equiv 16\\pmod{21}$，所以 $10\\mapsto 16$。\n- $f(16)\\equiv 160\\equiv 160-147\\equiv 13\\pmod{21}$，所以 $16\\mapsto 13$。\n- $f(13)\\equiv 130\\equiv 130-126\\equiv 4\\pmod{21}$，所以 $13\\mapsto 4$。\n- $f(4)\\equiv 40\\equiv 40-21\\equiv 19\\pmod{21}$，所以 $4\\mapsto 19$。\n- $f(19)\\equiv 190\\equiv 190-189\\equiv 1\\pmod{21}$，所以 $19\\mapsto 1$。\n\n这就关闭了一个从1开始的轮换：\n$$\n(1,10,16,13,4,19)。\n$$\n我们继续处理下一个未被包含的最小元素 $2$：\n- $f(2)\\equiv 20\\pmod{21}$，所以 $2\\mapsto 20$。\n- $f(20)\\equiv 200\\equiv 200-189\\equiv 11\\pmod{21}$，所以 $20\\mapsto 11$。\n- $f(11)\\equiv 110\\equiv 110-105\\equiv 5\\pmod{21}$，所以 $11\\mapsto 5$。\n- $f(5)\\equiv 50\\equiv 50-42\\equiv 8\\pmod{21}$，所以 $5\\mapsto 8$。\n- $f(8)\\equiv 80\\equiv 80-63\\equiv 17\\pmod{21}$，所以 $8\\mapsto 17$。\n- $f(17)\\equiv 170\\equiv 170-168\\equiv 2\\pmod{21}$，所以 $17\\mapsto 2$。\n\n这就关闭了第二个轮换：\n$$\n(2,20,11,5,8,17)。\n$$\n现在所有12个元素都已被这两个不相交轮换覆盖，因此由 $a\\mapsto 10a\\pmod{21}$ 在模21的既约剩余系上导出的置换的轮换分解是\n$$\n(1,10,16,13,4,19)\\,(2,20,11,5,8,17)。\n$$\n\n现在我们确定该置换的符号。置换理论中的一个基本事实是，一个长度为 $\\ell$ 的轮换可以写成 $\\ell-1$ 个对换的乘积，因此其符号为 $(-1)^{\\ell-1}$。因为不相交轮换的乘积是独立的，所以不相交轮换乘积的符号是它们各自符号的乘积。在我们的例子中，两个轮换的长度都是 $\\ell=6$，因此每个轮换的符号都是 $(-1)^{6-1}=(-1)^{5}=-1$。因此，总的符号是\n$$\n(-1)\\cdot(-1)=(-1)^{10}=1。\n$$\n等价地，由于该置换作用于 $\\varphi(21)=12$ 个元素上，并且有 $2$ 个轮换，其符号为 $(-1)^{12-2}=(-1)^{10}=1$，与上述计算结果一致。因此，该置换是偶置换，所要求的最终数值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3083425"}]}