{"hands_on_practices": [{"introduction": "在构建伪素数之前，理解一个合数为何可能无法通过费马素性检验至关重要。这个练习将引导你完成一个诊断过程，通过计算特定基数在合数各素因子下的乘法阶，你将揭示导致费马素性检验失败的精确机制。这个基础分析是理解伪素数构造原理的第一步。 [@problem_id:3083753]", "problem": "一个合数 $n$ 被称为以 $a$ 为底的伪素数，如果 $a^{n-1} \\equiv 1 \\pmod{n}$，其中 $a$ 是满足 $\\gcd(a,n)=1$ 的整数。整数 $a$ 模素数 $p$ 的乘法阶 $\\operatorname{ord}_{p}(a)$ 是满足 $a^{d} \\equiv 1 \\pmod{p}$ 的最小正整数 $d$，前提是 $\\gcd(a,p)=1$。仅使用这些定义、关于素数的费马小定理以及同余的基本性质，考虑 $a=3$ 和 $n=77$。\n\n找出 $n$ 的一个素因子 $p \\mid n$，使得 $\\operatorname{ord}_{p}(3) \\nmid (n-1)$，并从第一性原理推断出 $n$ 不是以 3 为底的伪素数。然后计算由 $r \\equiv 3^{n-1} \\pmod{n}$ 定义的精确余数 $r$，其中 $0 \\le r  n$。将你的最终答案以单个整数 $r$ 的形式给出。", "solution": "问题要求我们分析整数 $n=77$ 相对于底 $a=3$ 的情况。我们需要确定 $n$ 是否为以 3 为底的伪素数，并计算 $r \\equiv 3^{n-1} \\pmod{n}$ 的值。\n\n首先，我们验证以 $a$ 为底的伪素数定义的先决条件是否满足。整数 $n=77$ 是合数，因为 $n=7 \\times 11$。底为 $a=3$。我们检查条件 $\\gcd(a,n)=1$：$\\gcd(3, 77) = \\gcd(3, 7 \\times 11) = 1$，因为 3 不是 7 或 11 的因子。该条件满足。\n\n根据所给定义，$n=77$ 是一个以 3 为底的伪素数，当且仅当 $3^{n-1} \\equiv 1 \\pmod{n}$。在我们的例子中，即 $3^{77-1} \\equiv 3^{76} \\equiv 1 \\pmod{77}$。\n根据模运算的性质，这个单一的同余式等价于以下同余方程组：\n$$\n\\begin{cases}\n3^{76} \\equiv 1 \\pmod{7} \\\\\n3^{76} \\equiv 1 \\pmod{11}\n\\end{cases}\n$$\n\n问题引导我们找出 $n$ 的一个素因子 $p$，使得 3 模 $p$ 的乘法阶（记为 $\\operatorname{ord}_{p}(3)$）不能整除 $n-1=76$。我们来研究素因子 $p=7$。\n\n根据费马小定理，由于 7 是素数且 $\\gcd(3,7)=1$，我们有 $3^{7-1} \\equiv 3^6 \\equiv 1 \\pmod{7}$。乘法阶 $\\operatorname{ord}_{7}(3)$ 是满足 $3^d \\equiv 1 \\pmod{7}$ 的最小正整数 $d$。基于此，$\\operatorname{ord}_{7}(3)$ 必须是 6 的一个因子。6 的因子有 1、2、3 和 6。我们逐一测试：\n\\begin{itemize}\n    \\item $3^1 \\equiv 3 \\pmod{7}$\n    \\item $3^2 \\equiv 9 \\equiv 2 \\pmod{7}$\n    \\item $3^3 \\equiv 3 \\cdot 2 = 6 \\equiv -1 \\pmod{7}$\n\\end{itemize}\n由于 $d=1, 2, 3$ 都不能得到 1，所以阶必定是 $\\operatorname{ord}_{7}(3) = 6$。\n\n现在我们检查 $\\operatorname{ord}_{7}(3)$ 是否能整除 $n-1=76$。我们进行除法运算：$76 = 12 \\times 6 + 4$。由于余数非零，6 不能整除 76。因此，$p=7$ 是 $n$ 的一个素因子，满足 $\\operatorname{ord}_{p}(3) \\nmid (n-1)$。\n\n由此，我们可以从第一性原理推断出 $n=77$ 不是以 3 为底的伪素数。乘法阶的一个基本性质是 $a^k \\equiv 1 \\pmod{p}$ 当且仅当 $\\operatorname{ord}_{p}(a) \\mid k$。在我们的例子中，$3^{76} \\equiv 1 \\pmod{7}$ 为真，当且仅当 $\\operatorname{ord}_{7}(3) \\mid 76$。正如我们刚刚证明的 $6 \\nmid 76$，所以必然有 $3^{76} \\not\\equiv 1 \\pmod{7}$。由于同余方程组中的一个同余式不成立，所以原始同余式 $3^{76} \\equiv 1 \\pmod{77}$ 不可能成立。因此，$n=77$ 不是以 3 为底的伪素数。\n\n最后，我们计算精确余数 $r \\equiv 3^{76} \\pmod{77}$，其中 $0 \\le r  77$。我们必须使用中国剩余定理来解这个同余方程组：\n$$\n\\begin{cases}\nr \\equiv 3^{76} \\pmod{7} \\\\\nr \\equiv 3^{76} \\pmod{11}\n\\end{cases}\n$$\n\n对于第一个同余式，模 7：\n由于 $76 = 12 \\times 6 + 4$ 且 $\\operatorname{ord}_{7}(3)=6$，我们有：\n$$3^{76} = 3^{12 \\cdot 6 + 4} = (3^6)^{12} \\cdot 3^4 \\equiv 1^{12} \\cdot 3^4 \\equiv 3^4 \\pmod{7}$$\n我们计算 $3^4$：$3^4 = 81 = 11 \\times 7 + 4$。所以，$3^4 \\equiv 4 \\pmod{7}$。\n第一个同余式是 $r \\equiv 4 \\pmod{7}$。\n\n对于第二个同余式，模 11：\n首先，我们求 $\\operatorname{ord}_{11}(3)$。根据费马小定理，$3^{10} \\equiv 1 \\pmod{11}$。阶必须是 10 的因子。10 的因子有 1、2、5、10。\n\\begin{itemize}\n    \\item $3^1 \\equiv 3 \\pmod{11}$\n    \\item $3^2 \\equiv 9 \\pmod{11}$\n    \\item $3^5 = 243 = 22 \\times 11 + 1 \\equiv 1 \\pmod{11}$\n\\end{itemize}\n最小的正次幂是 5，所以 $\\operatorname{ord}_{11}(3) = 5$。\n现在我们计算 $3^{76} \\pmod{11}$。我们将 76 用阶 5 来表示：$76 = 15 \\times 5 + 1$。\n$$3^{76} = 3^{15 \\cdot 5 + 1} = (3^5)^{15} \\cdot 3^1 \\equiv 1^{15} \\cdot 3 \\equiv 3 \\pmod{11}$$\n第二个同余式是 $r \\equiv 3 \\pmod{11}$。\n\n我们现在解这个方程组：\n$$\n\\begin{cases}\nr \\equiv 4 \\pmod{7} \\\\\nr \\equiv 3 \\pmod{11}\n\\end{cases}\n$$\n从第一个同余式，我们可以写出 $r = 7k + 4$，其中 $k$ 是某个整数。将此代入第二个同余式：\n$$7k + 4 \\equiv 3 \\pmod{11}$$\n$$7k \\equiv -1 \\pmod{11}$$\n$$7k \\equiv 10 \\pmod{11}$$\n为了解出 $k$，我们需要 7 模 11 的乘法逆元。我们可以看到 $7 \\times 8 = 56 = 5 \\times 11 + 1$，所以 $7^{-1} \\equiv 8 \\pmod{11}$。两边同乘以 8：\n$$8 \\cdot (7k) \\equiv 8 \\cdot 10 \\pmod{11}$$\n$$k \\equiv 80 \\pmod{11}$$\n因为 $80 = 7 \\times 11 + 3$，我们有 $k \\equiv 3 \\pmod{11}$。\n所以，$k$ 可以写成 $k = 11j + 3$，其中 $j$ 是某个整数。将此代回 $r$ 的表达式中：\n$$r = 7(11j + 3) + 4 = 77j + 21 + 4 = 77j + 25$$\n这意味着 $r \\equiv 25 \\pmod{77}$。在范围 $0 \\le r  77$ 内的唯一余数是 $r=25$。", "answer": "$$\\boxed{25}$$", "id": "3083753"}, {"introduction": "了解了检验失败的条件后，我们现在转向如何成功地构造一个伪素数。本练习将向你展示一种使用分圆多项式系统性地构建特定基数下的伪素数的方法。通过这个过程，你将发现分圆多项式因子的性质如何确保我们构造出的合数能够在费马检验中完美地“伪装”成一个素数。 [@problem_id:3083765]", "problem": "设 $a=2$ 且 $L=11$。一个合数 $n>1$ 且满足 $\\gcd(a,n)=1$，如果它满足 $a^{n-1}\\equiv 1 \\pmod n$，则称其为以 $a$ 为底的费马伪素数。设 $\\Phi_L(x)$ 表示第 $L$ 次分圆多项式。从模素数的乘法阶和分圆多项式的定义出发，并且只使用基础的数论事实，完成以下任务：\n- 计算 $\\Phi_{L}(a)$ 的素因子集合。\n- 对每个这样的素数 $p$，判断是否有 $p\\equiv 1 \\pmod L$。\n- 用至少两个这样的不同素数之积构成一个合数 $n$，并从第一性原理出发，通过展示其满足 $a^{n-1}\\equiv 1 \\pmod n$ 的结构性原因，来证明这个 $n$ 是一个以 $a$ 为底的费马伪素数。\n将最小的这样一个合数 $n$ 作为你的最终答案。将你的最终答案表示为一个精确的整数。", "solution": "我们首先回顾解决此问题所需的基础定义和原理。\n\n对于一个整数 $a$ 和一个正整数 $m$，其中 $\\gcd(a,m)=1$，整数 $a$ 模 $m$ 的乘法阶是满足 $a^k \\equiv 1 \\pmod m$ 的最小正整数 $k$。这被记为 $\\text{ord}_m(a)$。费马小定理的一个直接推论是，如果 $p$ 是一个素数，那么 $a^{p-1} \\equiv 1 \\pmod p$。这意味着 $\\text{ord}_p(a)$ 必须是 $p-1$ 的一个因子。\n\n第 $L$ 次分圆多项式，记作 $\\Phi_L(x)$，是唯一的首一不可约整系数多项式，它是 $x^L-1$ 的一个因子，但对于任何 $k  L$，它都不是 $x^k-1$ 的因子。$\\Phi_L(x)$ 的根是第 $L$ 次本原单位根。分圆多项式满足恒等式 $x^N-1 = \\prod_{d|N} \\Phi_d(x)$。对于 $L$ 是素数的特殊情况，该恒等式简化为 $x^L-1 = \\Phi_1(x) \\Phi_L(x) = (x-1)\\Phi_L(x)$，这给出了众所周知的公式：\n$$\\Phi_L(x) = \\frac{x^L-1}{x-1} = x^{L-1} + x^{L-2} + \\dots + x + 1$$\n\n问题指定了 $a=2$ 和 $L=11$。我们首先被要求计算 $\\Phi_L(a)$ 的素因子集合。\n代入给定值，我们计算 $\\Phi_{11}(2)$：\n$$\\Phi_{11}(2) = \\frac{2^{11}-1}{2-1} = 2^{11}-1 = 2048 - 1 = 2047$$\n\n接下来，我们求 $2047$ 的素因子分解。我们用小的素数进行试除。\n这个数不能被 $2$、$3$ 或 $5$ 整除。\n我们检查形如 $2kL+1$（即 $22k+1$）的素数的可除性，因为 $\\Phi_L(a)$ 的任何素因子 $p$ 必须满足 $p \\equiv 1 \\pmod{2L}$ 或 $p=L$。由于 $2047$ 不能被 $11$ 整除，我们检查形如 $22k+1$ 的素数。对于 $k=1$，我们测试 $p=23$。\n$$2047 \\div 23 = 89$$\n我们检查 $23$ 和 $89$ 是否为素数。$23$ 是一个素数。为了检查 $89$ 是否为素数，我们测试它是否能被小于等于 $\\sqrt{89} \\approx 9.4$ 的素数整除。这些素数是 $2$、$3$、$5$ 和 $7$。$89$ 不能被这些数中的任何一个整除，所以 $89$ 是素数。\n因此，$2047$ 的素因子分解是 $23 \\times 89$。$\\Phi_{11}(2)$ 的素因子集合是 $\\{23, 89\\}$。\n\n第二个任务是，对每个这样的素因子 $p$，判断是否有 $p \\equiv 1 \\pmod L$。这里，$L=11$。\n对于 $p=23$：$23 = 2 \\times 11 + 1$。因此，$23 \\equiv 1 \\pmod{11}$。\n对于 $p=89$：$89 = 8 \\times 11 + 1$。因此，$89 \\equiv 1 \\pmod{11}$。\n这个条件对两个素因子都成立。\n\n这个性质并非巧合。设 $p$ 是 $\\Phi_{11}(2)$ 的任意素因子。根据因子的定义，有 $\\Phi_{11}(2) \\equiv 0 \\pmod p$。由于 $\\Phi_{11}(2) = 2^{11}-1$，这意味着 $2^{11}-1 \\equiv 0 \\pmod p$，或者说 $2^{11} \\equiv 1 \\pmod p$。\n根据乘法阶的定义，这意味著 $\\text{ord}_p(2)$ 必须整除 $11$。因为 $11$ 是一个素数，所以 $\\text{ord}_p(2)$ 的可能值是 $1$ 和 $11$。\n如果 $\\text{ord}_p(2) = 1$，那么 $2^1 \\equiv 1 \\pmod p$，这意味着 $p$ 整除 $1$。这对于素数 $p$ 是不可能的。\n因此，$\\text{ord}_p(2)$ 必须恰好是 $11$。\n从费马小定理推导出的乘法阶性质可知，$\\text{ord}_p(2)$ 必须整除 $p-1$。\n所以，我们必须有 $11 | (p-1)$，这等价于条件 $p \\equiv 1 \\pmod{11}$。这为我们数值验证的结果提供了理论依据。\n\n第三个任务是，用至少两个这样的不同素数之积构成一个合数 $n$，并证明它是一个以 $a$ 为底的费马伪素数。我们找到的合格素数集合是 $\\{23, 89\\}$。要构成最小的这样一个合数 $n$，我们必须取两个最小的可用素数之积，即 $23$ 和 $89$。\n$$n = 23 \\times 89 = 2047$$\n以 $a$ 为底的费马伪素数是一个合数 $n$，满足 $a^{n-1} \\equiv 1 \\pmod n$，且 $\\gcd(a,n)=1$。此处，$a=2$ 且 $n=2047$。\n$n=2047$ 根据构造是合数。并且，由于 $2047$ 是奇数，$\\gcd(2, 2047)=1$。我们必须从第一性原理出发，证明 $2^{n-1} \\equiv 1 \\pmod n$。\n这等价于证明 $2^{2046} \\equiv 1 \\pmod{2047}$。根据中国剩余定理，这个同余式成立当且仅当它对 $n$ 的每个素因子取模都成立。也就是说，我们必须证明：\n1. $2^{2046} \\equiv 1 \\pmod{23}$\n2. $2^{2046} \\equiv 1 \\pmod{89}$\n\n对于第一个同余式，我们知道同余式 $a^k \\equiv 1 \\pmod p$ 成立当且仅当 $\\text{ord}_p(a)$ 整除 $k$。我们已经确定 $\\text{ord}_{23}(2) = 11$。所以我们需要检查 $11$ 是否整除指数 $2046$。\n$$2046 = 11 \\times 186$$\n由于 $11 | 2046$，因此有 $2^{2046} = (2^{11})^{186} \\equiv 1^{186} \\equiv 1 \\pmod{23}$。第一个同余式得到满足。\n\n对于第二个同余式，我们已经确定 $\\text{ord}_{89}(2) = 11$。由于 $11$ 也整除 $2046$，我们有 $2^{2046} = (2^{11})^{186} \\equiv 1^{186} \\equiv 1 \\pmod{89}$。第二个同余式也得到满足。\n\n因为 $2^{2046}-1$ 同时能被 $23$ 和 $89$ 整除，所以它必定能被它们的乘积 $2047$ 整除。因此，$2^{2046} \\equiv 1 \\pmod{2047}$。\n由于 $n=2047$ 是一个满足 $2^{n-1} \\equiv 1 \\pmod n$ 的合数，根据定义，它是一个以 $2$ 为底的费马伪素数。\n\n其结构性原因如下：设 $n = p_1 p_2 \\dots p_k$ 是不同素数的乘积，其中对于素数 $L$，每个 $p_i$ 都是 $\\Phi_L(a)$ 的因子。如前所示，这意味着对所有的 $i$ 都有 $\\text{ord}_{p_i}(a)=L$ 和 $p_i \\equiv 1 \\pmod L$。\n那么 $n = \\prod_{i=1}^k p_i \\equiv \\prod_{i=1}^k 1 \\equiv 1 \\pmod L$。\n这意味着 $n-1$ 是 $L$ 的倍数。设 $n-1 = m L$。\n为了检查是否有 $a^{n-1} \\equiv 1 \\pmod n$，我们对每个 $p_i$ 取模进行检查：\n$$a^{n-1} = a^{mL} = (a^L)^m$$\n由于 $\\text{ord}_{p_i}(a)=L$，我们有 $a^L \\equiv 1 \\pmod {p_i}$。\n因此，对每个 $i$ 都有 $(a^L)^m \\equiv 1^m \\equiv 1 \\pmod {p_i}$。\n根据中国剩余定理，$a^{n-1} \\equiv 1 \\pmod n$。\n\n最后的任务是报告最小的这样一个合数 $n$。在 $a=2$ 和 $L=11$ 的约束下，我们唯一能使用的素因子是 $23$ 和 $89$。问题要求 $n$ 是至少两个不同素数的乘积。最小的这样的乘积必然是 $23 \\times 89 = 2047$。", "answer": "$$\\boxed{2047}$$", "id": "3083765"}, {"introduction": "数论的世界充满了挑战我们直觉的惊奇结果。这个练习探讨了一个这样的案例，旨在回答一个深刻的问题：伪素数的性质是否会被其因子继承？通过分析著名的卡米克尔数 $561$ 及其因子 $33$，你将亲手证明一个伪素数的因子不一定本身也是一个伪素数，从而加深对伪素数性质的理解。 [@problem_id:3083768]", "problem": "设 $a \\in \\mathbb{Z}$ 且 $a \\ge 2$。一个合数 $n \\ge 2$ 且满足 $\\gcd(a,n)=1$，如果它满足 $a^{n-1} \\equiv 1 \\pmod{n}$，则称其为以 $a$ 为底的伪素数。人们很容易相信，如果 $n$ 是一个以 $a$ 为底的伪素数，且 $m \\mid n$ ($m>1$)，那么 $m$ 也必定是一个以 $a$ 为底的伪素数。从以 $a$ 为底的伪素数的定义以及费马小定理和中国剩余定理等基本结果出发，通过显式构造和计算，证明这个推论通常不成立。\n\n使用特定的底数 $a=2$。首先，通过验证 $561$ 是合数、$\\gcd(2,561)=1$ 以及 $2^{560} \\equiv 1 \\pmod{561}$，证明 $n=561$ 是一个以 $2$ 为底的伪素数。接下来，取 $561$ 的一个真合数因子 $m=33$，并计算 $2^{m-1} \\pmod{m}$。解释为什么计算出的值表明 $m$ 不是一个以 $2$ 为底的伪素数，尽管 $n$ 是。\n\n给出你的最终答案，即当 $m=33$ 时，等于 $2^{m-1} \\bmod m$ 的单个整数余数 $r$，其中 $0 \\le r  m$。无需四舍五入。", "solution": "该问题要求证明一个以 $a$ 为底的伪素数的因子不一定也是以相同底数的伪素数。我们将使用题目中给出的具体情况：底数 $a=2$，整数 $n=561$，及其真因子 $m=33$。\n\n首先，我们回顾以 $a$ 为底的伪素数的定义。一个合数 $n \\ge 2$，如果满足 $\\gcd(a,n)=1$ 且同余式 $a^{n-1} \\equiv 1 \\pmod{n}$ 成立，则称其为以 $a$ 为底的伪素数。\n\n任务的第一部分是证明 $n=561$ 是一个以 $2$ 为底的伪素数。我们必须验证三个条件：\n1.  $n=561$ 必须是合数。\n2.  $\\gcd(2, 561)$ 必须为 $1$。\n3.  同余式 $2^{561-1} \\equiv 1 \\pmod{561}$ 必须成立。\n\n对于第一个条件，我们确定 $561$ 的素数分解。其各位数字之和为 $5+6+1=12$，可以被 $3$ 整除，所以 $561$ 可以被 $3$ 整除。我们得到 $561 = 3 \\times 187$。为了分解 $187$，我们尝试用小的素数来除。它不能被 $2$、$3$ 或 $5$ 整除。对于 $7$，$187 = 7 \\times 26 + 5$。对于 $11$，我们有 $187 = 11 \\times 17$。因此，$n$ 的素数分解是 $n=561 = 3 \\times 11 \\times 17$。由于 $561$ 有除自身以外的素因子，所以它是一个合数。\n\n对于第二个条件，$561$ 的素因子是 $3$、$11$ 和 $17$。它们都不等于 $2$。因此，$n=561$ 和 $a=2$ 互素，即 $\\gcd(2, 561)=1$。\n\n对于第三个条件，我们需要验证 $2^{560} \\equiv 1 \\pmod{561}$。由于 $561 = 3 \\times 11 \\times 17$，根据中国剩余定理，这个同余式等价于以下同余方程组：\n$$\n\\begin{cases}\n2^{560} \\equiv 1 \\pmod{3} \\\\\n2^{560} \\equiv 1 \\pmod{11} \\\\\n2^{560} \\equiv 1 \\pmod{17}\n\\end{cases}\n$$\n我们使用费马小定理，该定理指出，如果 $p$ 是一个素数，那么对于任何不能被 $p$ 整除的整数 $a$，都有 $a^{p-1} \\equiv 1 \\pmod{p}$。\n\n-   模 $3$：因为 $3$ 是素数且 $\\gcd(2,3)=1$，我们有 $2^{3-1} \\equiv 2^2 \\equiv 1 \\pmod{3}$。指数为 $560 = 2 \\times 280$。所以，$2^{560} = (2^2)^{280} \\equiv 1^{280} \\equiv 1 \\pmod{3}$。\n\n-   模 $11$：因为 $11$ 是素数且 $\\gcd(2,11)=1$，我们有 $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$。指数为 $560 = 10 \\times 56$。所以，$2^{560} = (2^{10})^{56} \\equiv 1^{56} \\equiv 1 \\pmod{11}$。\n\n-   模 $17$：因为 $17$ 是素数且 $\\gcd(2,17)=1$，我们有 $2^{17-1} \\equiv 2^{16} \\equiv 1 \\pmod{17}$。指数为 $560 = 16 \\times 35$。所以，$2^{560} = (2^{16})^{35} \\equiv 1^{35} \\equiv 1 \\pmod{17}$。\n\n由于同余式 $2^{560} \\equiv 1$ 对两两互素的因子 $3$、$11$ 和 $17$ 都成立，因此它对它们的乘积 $561$ 也成立。\n所有三个条件都得到满足，所以 $n=561$ 确实是一个以 $2$ 为底的伪素数。\n\n任务的第二部分是研究 $n=561$ 的真因子 $m=33$。由于 $561 = 17 \\times 33$，所以 $m=33$ 是一个因子。因为它满足 $1  33  561$，所以它是一个真因子。它也是一个合数，因为 $33 = 3 \\times 11$。\n\n我们现在检验 $m=33$ 是否是一个以 $2$ 为底的伪素数。我们必须检查 $2^{m-1} \\equiv 1 \\pmod{m}$ 是否成立，也就是 $2^{32} \\equiv 1 \\pmod{33}$。我们计算 $2^{32} \\pmod{33}$ 的值。我们可以使用重复平方法：\n$2^1 \\equiv 2 \\pmod{33}$\n$2^2 \\equiv 4 \\pmod{33}$\n$2^4 \\equiv 16 \\pmod{33}$\n$2^5 = 32 \\equiv -1 \\pmod{33}$\n利用这个结果，我们可以求出 $2^{10}$：\n$2^{10} = (2^5)^2 \\equiv (-1)^2 \\equiv 1 \\pmod{33}$。\n现在我们可以计算 $2^{32}$：\n$2^{32} = 2^{3 \\times 10 + 2} = (2^{10})^3 \\times 2^2 \\equiv 1^3 \\times 4 \\equiv 4 \\pmod{33}$。\n\n或者，对模数 $33 = 3 \\times 11$ 使用中国剩余定理：\n-   模 $3$：$2^{32} = (2^2)^{16} \\equiv 1^{16} \\equiv 1 \\pmod{3}$。\n-   模 $11$：$2^{32} = 2^{3 \\times 10 + 2} = (2^{10})^3 \\times 2^2 \\equiv 1^3 \\times 4 \\equiv 4 \\pmod{11}$。\n\n我们需要找到一个整数 $x$，满足 $x \\equiv 1 \\pmod{3}$ 和 $x \\equiv 4 \\pmod{11}$。根据第一个同余式，对于某个整数 $k$，有 $x = 3k+1$。将此代入第二个同余式：\n$3k+1 \\equiv 4 \\pmod{11}$\n$3k \\equiv 3 \\pmod{11}$\n由于 $\\gcd(3, 11)=1$，我们可以两边同除以 $3$，得到 $k \\equiv 1 \\pmod{11}$。\n所以对于某个整数 $j$，有 $k = 11j+1$。\n代回原式，$x = 3(11j+1)+1 = 33j+3+1 = 33j+4$。\n因此，$x \\equiv 4 \\pmod{33}$。\n\n两种计算方法都表明 $2^{32} \\equiv 4 \\pmod{33}$。\n\n要成为以 $2$ 为底的伪素数，$m=33$ 必须满足 $2^{32} \\equiv 1 \\pmod{33}$。由于 $2^{32} \\equiv 4 \\pmod{33}$ 且 $4 \\not\\equiv 1 \\pmod{33}$，该条件不满足。尽管 $m=33$ 是合数且 $\\gcd(2, 33)=1$，但它不是一个以 $2$ 为底的伪素数。\n\n这个结果证明了伪素数的性质不一定被其因子继承。我们已经证明了 $n=561$ 是一个以 $2$ 为底的伪素数，但它的真合数因子 $m=33$ 却不是。这推翻了一般的推论。\n\n题目要求的最终答案是当 $m=33$ 时，$r = 2^{m-1} \\bmod m$ 的余数。这正是我们计算出的值：$2^{32} \\bmod 33 = 4$。", "answer": "$$\n\\boxed{4}\n$$", "id": "3083768"}]}