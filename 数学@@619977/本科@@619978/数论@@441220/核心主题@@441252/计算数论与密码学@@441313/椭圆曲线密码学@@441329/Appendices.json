{"hands_on_practices": [{"introduction": "在进行任何复杂运算之前，我们必须首先理解一个点的坐标与曲线方程之间的基本关系。这个练习通过一个具体任务——在给定曲线上一个已知点的情况下确定一个曲线参数——来巩固这一基础概念。这是对您在有限域上理解Weierstrass方程的根本性检验。[@problem_id:1366833]", "problem": "在椭圆曲线密码学领域，一个系统的安全性依赖于一组公开商定的参数。这些参数定义了一个有限域上的椭圆曲线。考虑一条由Weierstrass方程 $y^2 \\equiv x^3 + ax + b \\pmod{p}$ 定义的椭圆曲线，其中 $p$ 是一个素数，而 $a, b$ 是由模 $p$ 定义的有限域内的整数。\n\n对于一个特定的密码学设置，选定的素数模为 $p = 17$，系数 $a$ 被设为 $7$。因此，该曲线方程为 $y^2 \\equiv x^3 + 7x + b \\pmod{17}$。\n\n作为系统验证的一部分，已确认坐标为 $(x, y) = (2, 5)$ 的点位于此曲线上。你的任务是确定整数系数 $b$ 的值。$b$ 的值必须是范围 $0 \\le b  17$ 内的整数。", "solution": "我们已知在以素数 $p=17$ 为模的有限域上，椭圆曲线由 $y^{2} \\equiv x^{3} + 7x + b \\pmod{17}$ 定义，并且点 $(x,y)=(2,5)$ 位于该曲线上。将 $x=2$ 和 $y=5$ 代入曲线方程可得\n$$\n5^{2} \\equiv 2^{3} + 7\\cdot 2 + b \\pmod{17}.\n$$\n计算两边模 $17$ 的值。对于左边，\n$$\n5^{2} = 25 \\equiv 25 - 17 = 8 \\pmod{17}.\n$$\n对于不含 $b$ 的右边，\n$$\n2^{3} + 7\\cdot 2 = 8 + 14 = 22 \\equiv 22 - 17 = 5 \\pmod{17}.\n$$\n因此同余式变为\n$$\n8 \\equiv 5 + b \\pmod{17}.\n$$\n求解 $b$ 模 $17$ 的值可得\n$$\nb \\equiv 8 - 5 \\equiv 3 \\pmod{17}.\n$$\n要求的范围是 $0 \\leq b  17$，所以唯一的值是 $b=3$。", "answer": "$$\\boxed{3}$$", "id": "1366833"}, {"introduction": "椭圆曲线密码学的安全性依赖于“椭圆曲线离散对数问题”的难度，该问题与标量乘法（即计算 $kP$）这一运算紧密相关。本练习将引导您直接实践这一关键操作，通过组合必要的点加倍和点相加步骤来计算 $4P$。掌握此项技能是理解公钥如何生成的关键。[@problem_id:1366844]", "problem": "在椭圆曲线密码学中，公钥是通过对给定椭圆曲线上的一个基点 $P$ 进行标量乘法生成的。这个运算，记为 $kP$，包含将点 $P$ 与自身相加 $k-1$ 次，其中 $k$ 是一个整数私钥。椭圆曲线上的点加法遵循特定的代数规则。\n\n考虑一个在有限域 $\\mathbb{F}_p$ 上由方程 $y^2 \\equiv x^3 + ax + b \\pmod{p}$ 定义的椭圆曲线，其中 $p$ 是一个素数。\n\n将两个不同的点 $P=(x_1, y_1)$ 和 $Q=(x_2, y_2)$ 相加得到 $R=P+Q=(x_3, y_3)$ 的规则是：\n$$ \\lambda = (y_2 - y_1)(x_2-x_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - x_1 - x_2 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\n这里，$(x_2-x_1)^{-1}$ 表示 $(x_2-x_1)$ 模 $p$ 的乘法逆元。\n\n将一个点 $P=(x_1, y_1)$ 加倍得到 $R=2P=(x_3, y_3)$ 的规则是：\n$$ \\lambda = (3x_1^2 + a)(2y_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - 2x_1 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\n这里，$(2y_1)^{-1}$ 表示 $(2y_1)$ 模 $p$ 的乘法逆元。\n\n给定椭圆曲线 $y^2 \\equiv x^3 + x + 1 \\pmod{5}$ 以及此曲线上的一个基点 $P = (0, 1)$。一个用户选择私钥 $k=4$。\n\n计算结果点 $Q = 4P$ 的坐标。将你的答案表示为一个行矩阵 $\\begin{pmatrix} x  y \\end{pmatrix}$，其中 $x$ 和 $y$ 是结果点的坐标，其值在集合 $\\{0, 1, 2, 3, 4\\}$ 中。", "solution": "我们在有限域 $\\mathbb{F}_{5}$ 上，在曲线 $y^{2} \\equiv x^{3} + x + 1 \\pmod{5}$ 上进行计算，其中 $a=1$。基点是 $P=(0,1)$，我们要求解 $Q=4P$。\n\n首先，验证点 $P$ 在曲线上：\n$$\ny^{2} \\equiv 1^{2} \\equiv 1,\\quad x^{3}+x+1 \\equiv 0^{3}+0+1 \\equiv 1 \\pmod{5}.\n$$\n因此 $P$ 在曲线上。\n\n使用倍点规则计算 $2P$，其中 $x_{1}=0$，$y_{1}=1$：\n$$\n\\lambda = (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (0+1)\\cdot(2)^{-1} \\equiv 1\\cdot 3 \\equiv 3 \\pmod{5},\n$$\n因为 $2^{-1} \\equiv 3 \\pmod{5}$。\n然后\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 0 \\equiv 9 \\equiv 4 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 3(0-4) - 1 \\equiv 3\\cdot 1 - 1 \\equiv 2 \\pmod{5},\n$$\n使用 $0-4 \\equiv 1 \\pmod{5}$。因此 $2P=(4,2)$。\n\n使用加法规则计算 $3P = 2P + P$，其中 $(x_{1},y_{1})=(4,2)$ 且 $(x_{2},y_{2})=(0,1)$：\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-2)(0-4)^{-1} \\equiv (-1)(-4)^{-1} \\equiv 4\\cdot 1 \\equiv 4 \\pmod{5},\n$$\n因为 $-1 \\equiv 4$ 且 $-4 \\equiv 1$，所以 $(0-4)^{-1} \\equiv 1^{-1} \\equiv 1$。然后\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 4^{2} - 4 - 0 \\equiv 16 - 4 \\equiv 12 \\equiv 2 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 4(4-2) - 2 \\equiv 4\\cdot 2 - 2 \\equiv 8 - 2 \\equiv 6 \\equiv 1 \\pmod{5}.\n$$\n因此 $3P=(2,1)$。\n\n计算 $4P = 3P + P$，其中 $(x_{1},y_{1})=(2,1)$ 且 $(x_{2},y_{2})=(0,1)$：\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-1)(0-2)^{-1} \\equiv 0\\cdot(-2)^{-1} \\equiv 0 \\pmod{5},\n$$\n因为 $(0-2) \\equiv -2 \\equiv 3$ 且 $3^{-1} \\equiv 2$，但是 $0\\cdot 2 \\equiv 0$。然后\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 0 - 2 - 0 \\equiv -2 \\equiv 3 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 0\\cdot(2-3) - 1 \\equiv -1 \\equiv 4 \\pmod{5}.\n$$\n因此 $4P=(3,4)$。\n\n作为检验，$(3,4)$ 满足模 $5$ 的曲线方程：\n$$\ny^{2} \\equiv 4^{2} \\equiv 16 \\equiv 1,\\quad x^{3}+x+1 \\equiv 27+3+1 \\equiv 31 \\equiv 1 \\pmod{5}.\n$$\n因此结果是正确的。", "answer": "$$\\boxed{\\begin{pmatrix} 3  4 \\end{pmatrix}}$$", "id": "1366844"}, {"introduction": "现在，让我们将所有知识融会贯通。最后的这个练习将模拟一次完整的椭圆曲线迪菲-赫尔曼（ECDH）密钥交换过程，参与者为Alice和Bob。通过计算他们的公钥，并最终推导出相同的共享密钥，您将亲眼见证我们练习过的数学群定律如何实现安全通信。这个练习展示了ECC在实际应用中的强大功能与优雅之处。[@problem_id:3084656]", "problem": "考虑定义在有限域 $\\mathbb{F}_{17}$ 上的椭圆曲线\n$$E: y^2 \\equiv x^3 + 2x + 2 \\pmod{17}.$$\n点 $G=(5,1)$ 位于 $E$ 上，由 $G$ 生成的循环子群 $\\langle G \\rangle$ 的阶为素数 $n=19$。两方（Alice 和 Bob）在子群 $\\langle G \\rangle$ 中执行椭圆曲线 Diffie-Hellman (ECDH) 密钥交换。\n\nAlice 选择私有标量 $a=3$ 并公布 $A=[a]G$。Bob 选择私有标量 $b=10$ 并公布 $B=[b]G$。然后他们使用 $E(\\mathbb{F}_{17})$ 上的弦切群律计算共享密钥 $S_A=[a]B$ 和 $S_B=[b]A$。所有域运算均在模 $17$ 下进行。\n\n从有限域上椭圆曲线群的定义和显式的弦切加法法则（其中斜率 $m$ 由下式给出\n$$m \\equiv \\begin{cases}\n\\frac{y_2 - y_1}{x_2 - x_1} \\pmod{17},  \\text{对于 } P=(x_1,y_1)\\neq \\pm Q=(x_2,y_2) \\\\[6pt]\n\\frac{3x_1^2 + a}{2y_1} \\pmod{17},  \\text{对于 } P=Q \n\\end{cases}$$\n以及公式\n$$x_3 \\equiv m^2 - x_1 - x_2 \\pmod{17}, \\qquad y_3 \\equiv m(x_1 - x_3) - y_1 \\pmod{17},$$\n再加上通常的无穷远点作为单位元）出发，执行完整的 ECDH 交换：计算 $A=[a]G$、$B=[b]G$，然后计算 $S_A=[a]B$ 和 $S_B=[b]A$，并验证 $S_A=S_B$。\n\n报告共享密钥点 $S$ 的 $x$ 坐标 $x_S$，其为 $\\mathbb{F}_{17}$ 中的一个精确整数。无需四舍五入，最终答案必须是单个数字。", "solution": "问题是执行一次椭圆曲线 Diffie-Hellman (ECDH) 密钥交换。参数如下：\n有限域为 $\\mathbb{F}_{17}$。\n椭圆曲线为 $E: y^2 \\equiv x^3 + 2x + 2 \\pmod{17}$。因此，点倍增公式的系数为 $a_{curve}=2$。\n生成点为 $G=(5,1)$。\nAlice 的私钥为 $a=3$。\nBob 的私钥为 $b=10$。\n\n所有算术运算都在模 $17$ 下进行。在 $\\mathbb{F}_{17}$ 中，数 $z$ 的乘法逆元记为 $z^{-1}$。\n\n**1. 计算 Alice 的公钥 $A=[a]G=[3]G$**\n\n首先，我们通过点倍增计算 $[2]G = G+G$。\n设 $G=(x_1, y_1) = (5, 1)$。倍增的斜率 $m$ 由 $m \\equiv \\frac{3x_1^2 + a_{curve}}{2y_1} \\pmod{17}$ 给出。\n$$m \\equiv \\frac{3(5^2) + 2}{2(1)} = \\frac{3(25)+2}{2} = \\frac{75+2}{2} = \\frac{77}{2} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$77 \\equiv 9$ 且 $2^{-1} \\equiv 9$（因为 $2 \\times 9 = 18 \\equiv 1$）。\n$$m \\equiv 9 \\times 9 = 81 \\equiv 13 \\pmod{17}$$\n$[2]G=(x_2, y_2)$ 的坐标为：\n$$x_2 \\equiv m^2 - x_1 - x_1 = 13^2 - 5 - 5 = 169 - 10 = 159 \\equiv 6 \\pmod{17}$$\n$$y_2 \\equiv m(x_1 - x_2) - y_1 = 13(5 - 6) - 1 = 13(-1) - 1 = -13 - 1 = -14 \\equiv 3 \\pmod{17}$$\n所以，$[2]G = (6, 3)$。\n\n接下来，我们通过点加法计算 $A = [3]G = [2]G + G$。\n设 $P=(x_P, y_P)=[2]G=(6,3)$ 且 $Q=(x_Q, y_Q)=G=(5,1)$。斜率为 $m \\equiv \\frac{y_Q - y_P}{x_Q - x_P} \\pmod{17}$。\n$$m \\equiv \\frac{1 - 3}{5 - 6} = \\frac{-2}{-1} = 2 \\pmod{17}$$\n$A=(x_A, y_A)$ 的坐标为：\n$$x_A \\equiv m^2 - x_P - x_Q = 2^2 - 6 - 5 = 4 - 11 = -7 \\equiv 10 \\pmod{17}$$\n$$y_A \\equiv m(x_P - x_A) - y_P = 2(6 - 10) - 3 = 2(-4) - 3 = -8 - 3 = -11 \\equiv 6 \\pmod{17}$$\nAlice 的公钥为 $A = (10, 6)$。\n\n**2. 计算 Bob 的公钥 $B=[b]G=[10]G$**\n\n我们使用倍增-加法算法。由于 $10 = 8+2$，我们计算 $B = [8]G + [2]G$。我们已有 $[2]G=(6,3)$。\n首先，我们通过对 $[2]G = (6,3)$ 进行倍增来找到 $[4]G = [2]([2]G)$。\n$$m \\equiv \\frac{3(6^2)+2}{2(3)} = \\frac{3(36)+2}{6} = \\frac{108+2}{6} = \\frac{110}{6} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$110 \\equiv 8$ 且 $6^{-1} \\equiv 3$。\n$$m \\equiv 8 \\times 3 = 24 \\equiv 7 \\pmod{17}$$\n$$x_4 \\equiv 7^2 - 6 - 6 = 49 - 12 = 37 \\equiv 3 \\pmod{17}$$\n$$y_4 \\equiv 7(6 - 3) - 3 = 7(3) - 3 = 21 - 3 = 18 \\equiv 1 \\pmod{17}$$\n所以，$[4]G = (3, 1)$。\n\n接下来，我们通过对 $[4]G=(3,1)$ 进行倍增来找到 $[8]G = [2]([4]G)$。\n$$m \\equiv \\frac{3(3^2)+2}{2(1)} = \\frac{27+2}{2} = \\frac{29}{2} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$29 \\equiv 12$ 且 $2^{-1} \\equiv 9$。\n$$m \\equiv 12 \\times 9 = 108 \\equiv 6 \\pmod{17}$$\n$$x_8 \\equiv 6^2 - 3 - 3 = 36 - 6 = 30 \\equiv 13 \\pmod{17}$$\n$$y_8 \\equiv 6(3 - 13) - 1 = 6(-10) - 1 = -60 - 1 = -61 \\equiv 7 \\pmod{17}$$\n所以，$[8]G = (13, 7)$。\n\n最后，我们计算 $B = [10]G = [8]G + [2]G$。设 $P=(13,7)$ 和 $Q=(6,3)$。\n$$m \\equiv \\frac{3-7}{6-13} = \\frac{-4}{-7} = \\frac{4}{7} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$7^{-1} \\equiv 5$。\n$$m \\equiv 4 \\times 5 = 20 \\equiv 3 \\pmod{17}$$\n$B=(x_B, y_B)$ 的坐标为：\n$$x_B \\equiv 3^2 - 13 - 6 = 9 - 19 = -10 \\equiv 7 \\pmod{17}$$\n$$y_B \\equiv 3(13 - 7) - 7 = 3(6) - 7 = 18 - 7 = 11 \\pmod{17}$$\nBob 的公钥为 $B = (7, 11)$。\n\n**3. 计算共享密钥 $S_A = [a]B = [3]B$**\n\nAlice 计算共享密钥 $S_A = [3]B = [2]B + B$。设 $B=(7,11)$。\n首先，我们对 $B$ 进行倍增以得到 $[2]B$。\n$$m \\equiv \\frac{3(7^2)+2}{2(11)} = \\frac{3(49)+2}{22} = \\frac{147+2}{22} = \\frac{149}{22} \\pmod{17}$$\n在 $\\mathbb{F}_{17}$ 中，$149 \\equiv 13$ 且 $22 \\equiv 5$。我们有 $5^{-1} \\equiv 7$。\n$$m \\equiv 13 \\times 7 = 91 \\equiv 6 \\pmod{17}$$\n$$x_{2B} \\equiv 6^2 - 7 - 7 = 36 - 14 = 22 \\equiv 5 \\pmod{17}$$\n$$y_{2B} \\equiv 6(7 - 5) - 11 = 6(2) - 11 = 12 - 11 = 1 \\pmod{17}$$\n所以，$[2]B = (5, 1)$，即生成元 $G$。\n\n现在 Alice 计算 $S_A = [2]B + B = G+B$。设 $P=G=(5,1)$ 和 $Q=B=(7,11)$。\n$$m \\equiv \\frac{11-1}{7-5} = \\frac{10}{2} = 5 \\pmod{17}$$\n共享密钥 $S_A = (x_S, y_S)$ 的坐标为：\n$$x_S \\equiv 5^2 - 5 - 7 = 25 - 12 = 13 \\pmod{17}$$\n$$y_S \\equiv 5(5 - 13) - 1 = 5(-8) - 1 = -40 - 1 = -41 \\equiv 10 \\pmod{17}$$\nAlice 计算出的共享密钥为 $S_A = (13, 10)$。\n\n**4. 计算并验证共享密钥 $S_B = [b]A = [10]A$**\n\nBob 计算共享密钥 $S_B = [10]A = [8]A + [2]A$。我们有 $A=(10,6)$。\n我们首先计算 $[2]A$、$[4]A$ 和 $[8]A$。\n$[2]A$：对 $A=(10,6)$ 进行倍增。\n$$m \\equiv \\frac{3(10^2)+2}{2(6)} = \\frac{302}{12} \\pmod{17}$$\n$302 \\equiv 13$ 且 $12^{-1} \\equiv 10$。所以 $m \\equiv 13 \\times 10 = 130 \\equiv 11$。\n$x_{2A} \\equiv 11^2 - 10 - 10 = 121 - 20 = 101 \\equiv 16$。\n$y_{2A} \\equiv 11(10-16)-6 = -66-6 = -72 \\equiv 13$。所以 $[2]A=(16,13)$。\n\n$[4]A$：对 $[2]A=(16,13)$ 进行倍增。\n$$m \\equiv \\frac{3(16^2)+2}{2(13)} = \\frac{3(256)+2}{26} \\equiv \\frac{3(1)+2}{9} = \\frac{5}{9} \\pmod{17}$$\n$9^{-1} \\equiv 2$。所以 $m \\equiv 5 \\times 2 = 10$。\n$x_{4A} \\equiv 10^2 - 16 - 16 = 100 - 32 = 68 \\equiv 0$。\n$y_{4A} \\equiv 10(16-0)-13 = 160-13 = 147 \\equiv 11$。所以 $[4]A=(0,11)$。\n\n$[8]A$：对 $[4]A=(0,11)$ 进行倍增。\n$$m \\equiv \\frac{3(0^2)+2}{2(11)} = \\frac{2}{22} \\equiv \\frac{2}{5} \\pmod{17}$$\n$5^{-1} \\equiv 7$。所以 $m \\equiv 2 \\times 7 = 14$。\n$x_{8A} \\equiv 14^2 - 0 - 0 = 196 \\equiv 9$。\n$y_{8A} \\equiv 14(0-9)-11 = -126-11 = -137 \\equiv 16$。所以 $[8]A=(9,16)$。\n\n最后，Bob 计算 $S_B = [8]A + [2]A$。设 $P=[8]A=(9,16)$ 和 $Q=[2]A=(16,13)$。\n$$m \\equiv \\frac{13-16}{16-9} = \\frac{-3}{7} = \\frac{14}{7} = 2 \\pmod{17}$$\n$S_B=(x'_S, y'_S)$ 的坐标为：\n$$x'_S \\equiv 2^2 - 9 - 16 = 4 - 25 = -21 \\equiv 13 \\pmod{17}$$\n$$y'_S \\equiv 2(9 - 13) - 16 = 2(-4) - 16 = -8 - 16 = -24 \\equiv 10 \\pmod{17}$$\nBob 计算出的共享密钥为 $S_B = (13, 10)$。\n\n我们验证 $S_A = (13, 10) = S_B$，因此 ECDH 交换成功。共享密钥点为 $S = (13, 10)$。问题要求 $x$ 坐标 $x_S$。\n\n$x_S = 13$。", "answer": "$$\n\\boxed{13}\n$$", "id": "3084656"}]}