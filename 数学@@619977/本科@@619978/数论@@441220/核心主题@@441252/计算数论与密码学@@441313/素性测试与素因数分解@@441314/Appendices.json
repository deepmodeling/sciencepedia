{"hands_on_practices": [{"introduction": "本练习将探讨最直接的质因数分解方法——试除法 [@problem_id:3088395]。我们将强调其基本原理：每个合数 $n$ 都必然有一个小于或等于 $\\sqrt{n}$ 的质因数。通过这个练习，你将体会到这个看似简单的原理如何导出一个计算量随数字大小急剧增加的算法，从而理解为何质因数分解被视为一个“难题”。", "problem": "设 $n \\in \\mathbb{Z}_{\\geq 2}$。仅使用可除性和合数的基本定义，首先证明以下论断：如果 $n$ 是合数，则存在一个整数因子 $d$ 满足 $2 \\leq d \\leq \\sqrt{n}$ 且 $d \\mid n$。然后，设计并执行一个计算过程，利用这个界限通过试除法来分解特定整数 $n = 246246$。你的过程应该按递增顺序测试连续的潜在质因子，并且在找到因子时，可以将搜索上限更新为当前剩余因子的平方根。将 $246246$ 的最终质因数分解表示为质数按非递减顺序排列的单一乘积形式。提供精确的表达式；无需四舍五入。", "solution": "这个问题包含两部分。第一部分是关于合数因子的一个证明，第二部分是应用此结果来分解一个特定的整数。我将按顺序处理每个部分。\n\n第一部分：因子界限性质的证明\n\n我们需要证明以下论断：如果一个整数 $n \\in \\mathbb{Z}_{\\geq 2}$ 是合数，那么存在一个 $n$ 的整数因子 $d$ 满足 $2 \\leq d \\leq \\sqrt{n}$。\n\n设 $n$ 是一个合数，且 $n \\geq 2$。根据合数的定义，存在整数 $a$ 和 $b$ 使得 $n = a \\cdot b$，并满足约束条件 $1  a  n$ 和 $1  b  n$。\n\n由于 $n = a \\cdot b$，不可能同时有 $a > \\sqrt{n}$ 和 $b > \\sqrt{n}$。为了证明这一点，我们使用反证法，假设这两个不等式同时成立。如果 $a > \\sqrt{n}$ 且 $b > \\sqrt{n}$，那么它们的乘积将满足不等式：\n$$a \\cdot b > \\sqrt{n} \\cdot \\sqrt{n}$$\n$$a \\cdot b > n$$\n这与我们的起始条件 $n = a \\cdot b$ 相矛盾。因此，关于 $a > \\sqrt{n}$ 和 $b > \\sqrt{n}$ 同时成立的假设必定是错误的。\n\n这意味着因子 $a$ 或 $b$ 中至少有一个必须小于或等于 $\\sqrt{n}$。不失一般性，我们假设 $a \\leq b$。于是我们有：\n$$a^2 \\leq a \\cdot b = n$$\n对两边取平方根，我们得到：\n$$a \\leq \\sqrt{n}$$\n根据合数的定义，我们有条件 $1  a$。由于 $a$ 是一个整数，这等价于 $a \\geq 2$。\n\n通过选择 $d = a$，我们找到了一个满足条件 $2 \\leq d \\leq \\sqrt{n}$ 的 $n$ 的整数因子。证明完毕。值得注意的是，这个证明保证了在此范围内存在任意一个因子，而不必是质数。然而，最小的这样一个因子 $d$ 必定是质数。这是因为如果 $d$ 是合数，它将有一个因子 $d'$ 满足 $1  d'  d$，并且 $d'$ 也能整除 $n$，这与 $d$ 的最小性相矛盾。这个推论是试除法算法的基础。\n\n第二部分：分解 $n = 246246$\n\n我们现在应用上面证明的原理来求出 $n = 246246$ 的质因数分解。其过程是从 $2$ 开始，用连续的质数测试可除性，直到被分解数的平方根。当找到一个因子时，我们将其除掉，得到一个更小的剩余因子，然后我们将搜索的上限更新为这个新剩余因子的平方根。\n\n第一步：初始分解\n要分解的数是 $n_0 = 246246$。这个数是偶数，所以能被第一个质数 $p_1 = 2$ 整除。\n$$246246 = 2 \\times 123123$$\n我们剩下的待分解的剩余因子是 $n_1 = 123123$。\n\n第二步：分解第一个剩余因子 $n_1 = 123123$\n我们搜索质因子的上限是 $\\sqrt{123123} \\approx 350.89$。我们测试连续的质数。\n下一个质数是 $p=3$。$n_1$ 的各位数字之和是 $1+2+3+1+2+3 = 12$，可以被 $3$ 整除。因此，$n_1$ 可以被 $3$ 整除。\n$$123123 = 3 \\times 41041$$\n到目前为止的分解是 $246246 = 2 \\times 3 \\times 41041$。新的待分解剩余因子是 $n_2 = 41041$。\n\n第三步：分解第二个剩余因子 $n_2 = 41041$\n新的上限是 $\\sqrt{41041} \\approx 202.58$。我们从上一个成功找到的因子 $3$ 开始，继续测试质数。$n_2$ 的各位数字之和是 $4+1+0+4+1 = 10$，不能被 $3$ 整除。该数不以 $0$ 或 $5$ 结尾，所以不能被 $5$ 整除。我们测试下一个质数 $p=7$。\n$$41041 \\div 7 = 5863$$\n除法是精确的。所以，$p_3=7$ 是一个因子。\n现在的分解是 $246246 = 2 \\times 3 \\times 7 \\times 5863$。新的剩余因子是 $n_3 = 5863$。\n\n第四步：分解第三个剩余因子 $n_3 = 5863$\n新的上限是 $\\sqrt{5863} \\approx 76.57$。我们从 $7$ 开始继续测试质数。\n$5863 \\div 7$ 有余数，所以 $7$ 不是一个重复因子。我们测试下一个质数 $p=11$。其交错数字和为 $3 - 6 + 8 - 5 = 0$。由于和为 $0$，该数可以被 $11$ 整除。\n$$5863 \\div 11 = 533$$\n所以，$p_4=11$ 是一个因子。\n现在的分解是 $246246 = 2 \\times 3 \\times 7 \\times 11 \\times 533$。新的剩余因子是 $n_4 = 533$。\n\n第五步：分解第四个剩余因子 $n_4 = 533$\n新的上限是 $\\sqrt{533} \\approx 23.09$。我们从 $11$ 开始测试质数。\n$533$ 不能被 $11$ 整除（交错和为 $3-3+5=5$）。我们测试下一个质数 $p=13$。\n$$533 \\div 13 = 41$$\n除法是精确的。所以，$p_5=13$ 是一个因子。\n现在的分解是 $246246 = 2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41$。新的剩余因子是 $n_5 = 41$。\n\n第六步：分解最后一个剩余因子 $n_5 = 41$\n新的上限是 $\\sqrt{41} \\approx 6.4$。小于这个界限的质数是 $2$、$3$ 和 $5$。\n$41$ 不能被 $2$ 整除（它是奇数）。\n$41$ 不能被 $3$ 整除（各位数字之和是 $5$）。\n$41$ 不能被 $5$ 整除。\n由于 $41$ 没有小于或等于其平方根的质因子，它必定是一个质数。因此，$p_6 = 41$ 是最后一个质因子。\n\n将找到的所有质因子按非递减顺序组合起来，我们得到 $246246$ 的完整质因数分解。\n$246246 = 2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41$。\n快速验证一下：$2 \\times 3 \\times 7 = 42$。并且 $11 \\times 13 = 143$。而 $7 \\times 11 \\times 13 = 1001$。所以，$2 \\times 3 \\times (7 \\times 11 \\times 13) \\times 41 = 6 \\times 1001 \\times 41 = 6006 \\times 41 = 246246$。结果正确。\n\n以质数按非递减顺序排列的单一乘积形式表示的最终质因数分解是 $2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41$。", "answer": "$$\\boxed{2 \\times 3 \\times 7 \\times 11 \\times 13 \\times 41}$$", "id": "3088395"}, {"introduction": "与暴力破解式的因数分解相比，素性测试的效率可以非常高。本练习 [@problem_id:3088381] 将引导你完成一次强大的概率性算法——米勒-拉宾测试。你将看到该测试如何巧妙地寻找一个数的“合数证据”(witness to compositeness)，从而快速判定其为合数，而无需进行艰难的因数分解。", "problem": "考虑奇合数 $n=341$ 和底 $a=2$。米勒-拉宾强伪素数测试的过程是：先将 $n-1$ 写成 $2^r d$ 的形式（其中 $d$ 为奇数），然后计算模幂 $x_0 \\equiv a^d \\pmod n$，再构建平方链 $x_{j+1} \\equiv x_j^2 \\pmod n$（其中 $j=0, 1, \\dots, r-1$）。在此框架中，当对于某个 $j\\geq 1$ 出现 $x_j \\equiv 1 \\pmod n$ 而 $x_{j-1} \\not\\equiv \\pm 1 \\pmod n$ 时，便找到了一个证明其为合数的步骤，这揭示了模 $n$ 意义下 $1$ 的一个非平凡平方根。请使用模算术、幂运算以及 $n-1$ 的分解的定义，对给定的 $n$ 和 $a$ 执行一次完整的米勒-拉宾迭代：确定 $r$ 和 $d$ 的值，计算 $x_0$ 及后续的 $x_j$ 值直到 $j=r$，找出最早证明其为合数的步骤，然后利用最大公约数 (GCD) 从该步骤中提取 $n$ 的一个非平凡因子。\n\n请给出与第一个证明步骤相关的 $\\gcd(x_{j-1}-1, n)$ 的精确整数值作为最终答案。请勿四舍五入，以精确整数形式表示您的答案。", "solution": "该问题是米勒-拉宾素性检验的一个有效应用，这是数论中一个定义明确的算法。所有必要的数据（$n=341$，$a=2$）和定义均已提供，问题本身是自洽、客观且科学合理的。我们可以开始求解。\n\n目标是对整数 $n=341$ 和底 $a=2$ 执行一次米勒-拉宾测试，找出证明其为合数的步骤，并利用该信息找到一个非平凡因子。\n\n首先，我们必须将 $n-1$ 分解为 $2^r d$ 的形式，其中 $d$ 是一个奇数。\n给定 $n=341$，我们有 $n-1 = 340$。\n我们从 $340$ 中分解出 $2$ 的幂次：\n$$340 = 10 \\times 34 = (2 \\times 5) \\times (2 \\times 17) = 4 \\times 85 = 2^2 \\times 85$$\n这里，$d=85$ 是奇数。因此，我们确定 $r=2$，$d=85$。\n\n米勒-拉宾测试序列由 $x_0 \\equiv a^d \\pmod{n}$ 和 $x_{j+1} \\equiv x_j^2 \\pmod{n}$（其中 $j=0, 1, \\dots, r-1$）定义。\n\n我们首先计算 $x_0$：\n$$x_0 \\equiv a^d \\pmod{n} \\equiv 2^{85} \\pmod{341}$$\n为高效计算该模幂，我们使用二进制幂（也称为重复平方法）的方法。指数 $d=85$ 的二进制表示为 $1010101_2$，对应于 $2$ 的幂次之和：$85 = 64 + 16 + 4 + 1$。\n我们计算 $2$ 的各次幂模 $341$ 的值：\n\\begin{align*} 2^1 \\equiv 2 \\pmod{341} \\\\ 2^2 \\equiv 4 \\pmod{341} \\\\ 2^4 \\equiv 4^2 \\equiv 16 \\pmod{341} \\\\ 2^8 \\equiv 16^2 \\equiv 256 \\pmod{341} \\\\ 2^{16} \\equiv 256^2 = 65536 \\pmod{341} \\end{align*}\n为简化 $65536$，我们将其除以 $341$：$65536 = 192 \\times 341 + 4$。所以，$2^{16} \\equiv 4 \\pmod{341}$。\n\\begin{align*} 2^{32} \\equiv 4^2 \\equiv 16 \\pmod{341} \\\\ 2^{64} \\equiv 16^2 \\equiv 256 \\pmod{341} \\end{align*}\n现在，我们将这些结果组合起来计算 $2^{85}$：\n$$2^{85} = 2^{64} \\cdot 2^{16} \\cdot 2^4 \\cdot 2^1$$\n$$x_0 \\equiv 2^{85} \\equiv 256 \\cdot 4 \\cdot 16 \\cdot 2 \\pmod{341}$$\n我们分步计算这个乘积：\n$$256 \\cdot 4 = 1024$$\n将 $1024$ 除以 $341$ 得到 $1024 = 3 \\times 341 + 1$，所以 $1024 \\equiv 1 \\pmod{341}$。\n将此结果代回 $x_0$ 的表达式中：\n$$x_0 \\equiv (1) \\cdot 16 \\cdot 2 \\equiv 32 \\pmod{341}$$\n因此，$x_0 = 32$。\n\n测试首先检查 $x_0 \\equiv \\pm 1 \\pmod n$ 是否成立。由于 $32 \\not\\equiv 1 \\pmod{341}$ 且 $32 \\not\\equiv -1 \\pmod{341}$（因为 $-1 \\equiv 340 \\pmod{341}$），测试继续进行下一步。\n\n接下来，我们计算序列 $x_j$（其中 $j=1, \\dots, r-1$）。由于 $r=2$，我们只需计算 $x_1$。\n$$x_1 \\equiv x_0^2 \\pmod{n} \\equiv 32^2 \\pmod{341}$$\n$$x_1 \\equiv 1024 \\pmod{341}$$\n如前所述，$1024 = 3 \\times 341 + 1$。因此：\n$$x_1 \\equiv 1 \\pmod{341}$$\n测试发现，当 $j=1$ 时，我们有 $x_1 \\equiv 1 \\pmod{341}$。证明其为合数的条件已满足，因为 $x_1 \\equiv 1 \\pmod{n}$，而序列中的前一项 $x_{1-1}=x_0=32$ 不与 $\\pm 1 \\pmod{n}$ 同余。这是第一个证明 $n$ 是合数的步骤。\n\n存在这样的 $x_0$ 意味着它是模 $n$ 意义下 $1$ 的一个非平凡平方根。即 $x_0^2 \\equiv 1 \\pmod{n}$ 但 $x_0 \\not\\equiv \\pm 1 \\pmod{n}$。这可以改写为 $x_0^2 - 1 \\equiv 0 \\pmod{n}$，或 $(x_0 - 1)(x_0 + 1) \\equiv 0 \\pmod{n}$。\n这意味着 $n$ 整除乘积 $(x_0 - 1)(x_0 + 1)$。由于 $n$ 不能整除 $x_0-1$（因为 $x_0 \\not\\equiv 1 \\pmod n$），也不能整除 $x_0+1$（因为 $x_0 \\not\\equiv -1 \\pmod n$），所以 $n$ 必须与 $(x_0 - 1)$ 和 $(x_0 + 1)$ 各自都共享一个非平凡因子。\n\n问题要求从证明步骤中利用最大公约数 (GCD) 提取一个非平凡因子。具体来说，我们必须计算 $\\gcd(x_{j-1}-1, n)$，其中 $j=1$ 是第一个证明步骤。\n这需要计算 $\\gcd(x_0 - 1, n)$。\n代入我们找到的值：\n$$\\gcd(32 - 1, 341) = \\gcd(31, 341)$$\n要计算这个最大公约数，我们可以使用欧几里得算法。由于 $31$ 是一个素数，我们可以直接检验 $31$ 是否是 $341$ 的一个约数。\n$$341 \\div 31 = 11$$\n除法是整除的。因此，$31$ 是 $341$ 的一个约数，最大公约数是 $31$。\n$$\\gcd(31, 341) = 31$$\n这就是从米勒-拉宾测试中提取出的 $n=341$ 的非平凡因子。", "answer": "$$\\boxed{31}$$", "id": "3088381"}, {"introduction": "本练习将从实践算法延伸到计算理论的深层 [@problem_id:3088386]。我们将介绍“普拉特证书” (Pratt certificate) 这一概念，它是一种能够严格且高效地证明一个数为素数的形式化方法。通过亲手构建并验证这样一个证书，你将理解为何素性测试被认为是“容易”的：因为它的“是”答案（即“此数为素数”）可以被快速核实，这与质因数分解形成了鲜明对比。", "problem": "考虑一个任务：使用一个简洁的证书来证明一个给定的整数 $n$ 是素数，该证书可以在相对于 $\\log n$ 的多项式时间内被验证。一种经典方法是 Pratt 证书：对于一个声称的素数 $p$，提供 $p-1$ 的完整素因数分解，并且对于由此产生的因数树中的每个节点 $n$，提供一个底数 $a_n$，满足 $1  a_n  n$，$a_n^{n-1} \\equiv 1 \\pmod n$，以及对于 $n-1$ 的每个不同素因数 $q$，都有 $a_n^{(n-1)/q} \\not\\equiv 1 \\pmod n$。请解释为什么这样一个经过验证的证书能证明素性，并为 $p=97$ 构建并验证这样一个证书（使用 $a_{97}=5$ 和 $a_3=2$），然后计算在验证所有模同余检查中出现的所有指数的总和 $S$。", "solution": "问题要求解释用于素性测试的 Pratt 证书，为整数 $p=97$ 进行具体的构建和验证，并计算与验证指数相关的总和 $S$。\n\n首先，我们讨论 Pratt 证书的理论基础。目标是证明一个数 $p$ 是素数。证明的核心在于在模 $p$ 整数乘法群（记作 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$）中找到一个阶为 $p-1$ 的元素。这个群的阶由欧拉总计函数 $\\phi(p)$ 给出。根据定义，$p$ 是素数当且仅当 $\\phi(p) = p-1$。证书提供了证明 $\\phi(p) = p-1$ 所需的信息。对于一个候选素数 $p$ 的证书，会提供一个见证整数 $a_p$（满足 $1  a_p  p$），以及 $p-1$ 的完整素因数分解，比如说 $p-1 = q_1^{k_1} q_2^{k_2} \\cdots q_m^{k_m}$。对于每个素因数 $q_i$，其素性的递归证书也是整个证书的一部分。见证数 $a_p$ 必须满足两个条件：\n1. $a_p^{p-1} \\equiv 1 \\pmod{p}$\n2. 对于所有 $i \\in \\{1, 2, \\dots, m\\}$，$a_p^{(p-1)/q_i} \\not\\equiv 1 \\pmod{p}$\n\n为了理解为什么这些条件能证明素性，设 $k$ 是 $a_p$ 在群 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 中的阶。第一个条件 $a_p^{p-1} \\equiv 1 \\pmod{p}$，根据阶的定义，意味着 $k$ 必须整除 $p-1$。假设为了引出矛盾，$k$ 是 $p-1$ 的一个真因子，即 $k  p-1$。如果 $k$ 是一个真因子，那么整数 $(p-1)/k$ 大于 $1$ 并且必然有至少一个素因数，比如说 $q_j$。这意味着 $q_j$ 整除 $(p-1)/k$，可以写成 $k$ 整除 $(p-1)/q_j$。如果 $k$ 整除 $(p-1)/q_j$，那么存在一个整数 $c$ 使得 $(p-1)/q_j = kc$。这意味着 $a_p^{(p-1)/q_j} = a_p^{kc} = (a_p^k)^c \\equiv 1^c \\equiv 1 \\pmod{p}$。然而，这个结果直接与证书的第二个条件相矛盾。因此，我们最初的假设，即 $k$ 是 $p-1$ 的一个真因子，必定是错误的。唯一剩下的可能性是 $a_p$ 的阶恰好是 $k = p-1$。\n\n根据有限群论中的拉格朗日定理，有限群中任何元素的阶都必须整除群的阶。在我们的例子中，元素 $a_p$ 的阶是 $p-1$，它必须整除群 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 的阶，也就是 $\\phi(p)$。所以，我们有 $(p-1) | \\phi(p)$。对于任何整数 $p > 1$，已知 $\\phi(p) \\leq p-1$。在这个约束下，$(p-1)$ 要整除 $\\phi(p)$ 的唯一方式是这两个值相等：$\\phi(p) = p-1$。这个等式成立当且仅当 $p$ 是一个素数。这个逻辑递归地应用于 $p-1$ 的素因数 $q_i$，直到达到基例，即素数 $2$。\n\n证书的验证在关于输入大小的多项式时间内是可行的，输入大小是 $p$ 的位数，即 $O(\\log p)$。证书由一个素数树组成。这个树的深度最多是 $O(\\log p)$，因为 $n-1$ 的任何素因数 $q$ 都小于 $n$，通常 $q \\leq (n-1)/2$。树中节点的总数也是有界的，通常由 $O(\\log p)$ 界定。对于树中的每个非叶子节点 $n$，验证者必须执行几项检查：\n1. 确认 $n-1$ 等于其声称的素因数的乘积。这涉及少量乘法。\n2. 验证 $1 + \\omega(n-1)$ 个同余式，其中 $\\omega(n-1)$ 是 $n-1$ 的不同素因数的数量。每个同余式都是形如 $a^b \\pmod n$ 的模幂运算。使用二进制幂（重复平方）方法，这可以在 $O(\\log b)$ 次大小为 $O(\\log n)$ 的数的乘法中计算出来。因此，单个模幂运算可以在 $\\log n$ 的多项式时间内执行，例如 $O((\\log n)^3)$。\n由于节点数量和每个节点的检查数量都很小（在 $\\log p$ 中是多项式的），并且每个检查都花费多项式时间，所以总验证时间在 $\\log p$ 中是多项式的。\n\n现在，我们将为 $p=97$ 执行这个程序。\n1. 我们构建证书树。根节点是 $p=97$。我们必须分解 $p-1 = 96$。其素因数分解是 $96 = 2^5 \\times 3^1$。不同的素因数是 $2$ 和 $3$。素数 $2$ 是一个叶子节点（基例）。素数 $3$ 是一个非叶子节点，它本身需要认证。为了认证 $3$，我们分解 $3-1 = 2$。唯一的素因数是 $2$，一个叶子。因此，证书树由节点 $97$、$3$ 和 $2$ 组成。\n\n2. 我们展示并验证底数。\n对于节点 $n=97$，给定的底数是 $a_{97}=5$。$97-1=96$ 的素因数是 $q_1=2$ 和 $q_2=3$。我们必须验证：\n- $a_{97}^{96} \\equiv 1 \\pmod{97}$：使用费马小定理，验证者可以明确地检查：$5^{96} \\equiv 1 \\pmod{97}$。我们计算中间的幂：$5^2=25$，$5^4 \\equiv 43$，$5^8 \\equiv 6$，$5^{16} \\equiv 36$，$5^{32} \\equiv 35$，$5^{64} \\equiv 35^2 = 1225 \\equiv 1225 - 12 \\times 97 = 1225 - 1164 = 61 \\pmod{97}$。然后 $5^{96} = 5^{64} \\times 5^{32} \\equiv 61 \\times 35 = 2135 \\equiv 2135 - 22 \\times 97 = 2135 - 2134 = 1 \\pmod{97}$。条件成立。\n- $a_{97}^{(97-1)/2} = 5^{48} \\not\\equiv 1 \\pmod{97}$：$5^{48} = 5^{32} \\times 5^{16} \\equiv 35 \\times 36 = 1260 \\equiv 1260 - 12 \\times 97 = 1260 - 1164 = 96 \\equiv -1 \\pmod{97}$。由于 $96 \\not\\equiv 1 \\pmod{97}$，该条件成立。\n- $a_{97}^{(97-1)/3} = 5^{32} \\not\\equiv 1 \\pmod{97}$：如上计算，$5^{32} \\equiv 35 \\pmod{97}$。由于 $35 \\not\\equiv 1 \\pmod{97}$，该条件成立。\n\n对于节点 $n=3$，给定的底数是 $a_3=2$。$3-1=2$ 的素因数是 $q_1=2$。我们必须验证：\n- $a_3^{3-1} = 2^2 \\equiv 1 \\pmod 3$：$2^2=4 \\equiv 1 \\pmod 3$。此条件成立。\n- $a_3^{(3-1)/2} = 2^1 \\not\\equiv 1 \\pmod 3$：$2^1=2 \\not\\equiv 1 \\pmod 3$。此条件成立。\n\n3. 这个已验证数据的存在证明了 $97$ 是素数。对 $a_{97}=5$ 的检查确立了它模 $97$ 的阶恰好是 $96$。根据拉格朗日定理，这意味着 $\\phi(97)$ 是 $96$ 的倍数。由于 $\\phi(97) \\le 97-1=96$，因此必然有 $\\phi(97)=96$，这证明了 $97$ 是素数。这个推理是以 $96$ 的因数（即 $2$ 和 $3$）的素性为条件的。$2$ 的素性是公理性的，而 $3$ 的素性由节点 $n=3$ 的成功验证所证明。对 $97$ 的验证过程不需要分解任何数；$96$ 的分解是作为证书的一部分提供的。这表明素性测试属于复杂性类 NP（非确定性多项式时间），因为一个“是”的答案（“$97$ 是素数”）可以在给定一个合适的证书（猜测）的情况下在多项式时间内被验证。\n\n最后，我们计算在模同余检查中出现的所有指数的总和 $S$。\n对于节点 $n=97$，指数来自检查 $5^{96} \\equiv 1 \\pmod{97}$、$5^{48} \\not\\equiv 1 \\pmod{97}$ 和 $5^{32} \\not\\equiv 1 \\pmod{97}$。指数是 $96$、$48$ 和 $32$。\n对于节点 $n=3$，指数来自检查 $2^2 \\equiv 1 \\pmod 3$ 和 $2^1 \\not\\equiv 1 \\pmod 3$。指数是 $2$ 和 $1$。\n总和 $S$ 是所有这些指数的和：\n$$S = 96 + 48 + 32 + 2 + 1$$\n$$S = 176 + 3$$\n$$S = 179$$\n$S$ 的精确值是 $179$。", "answer": "$$\n\\boxed{179}\n$$", "id": "3088386"}]}