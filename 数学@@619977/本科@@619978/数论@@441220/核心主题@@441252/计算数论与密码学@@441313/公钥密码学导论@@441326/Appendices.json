{"hands_on_practices": [{"introduction": "公钥密码系统的安全性，尤其是RSA算法，依赖于使用两个巨大的素数作为其基础构建模块。然而，我们如何才能有效地找到这些素数呢？本练习将引导您完成米勒-拉宾素性检验（Miller-Rabin primality test）的一个迭代引理，这是一个在实践中用于快速识别大素数的关键概率性算法。通过这个练习[@problem_id:3086457]，您将理解我们如何在无需进行缓慢、穷尽的因子分解的情况下，以极高的置信度确定一个数是素数。", "problem": "在数论和公钥密码学导论的一门高阶本科课程中，通常会学习用于 Rivest–Shamir–Adleman (RSA) 方案密钥生成的素性检验方法。其中一种方法是 Miller–Rabin 素性检验，它依赖于模算术以及模一个合数候选数的整数乘法群的结构。从模幂运算的基本定义和费马小定理的陈述（如果 $p$ 是素数且 $\\gcd(a,p)=1$，则 $a^{p-1} \\equiv 1 \\pmod{p}$）出发，推导对奇整数 $n=341$ 和基 $a=2$ 进行一次 Miller–Rabin 迭代的步骤，方法是：将 $n-1$ 表示成 $2^{s} d$ 的形式（其中 $d$ 是奇数），计算 $x_{0} \\equiv a^{d} \\pmod{n}$，然后迭代地平方 $x_{i+1} \\equiv x_{i}^{2} \\pmod{n}$ 最多 $s-1$ 次，检查是否有任何 $x_{i}$ 等于 $-1 \\pmod{n}$。根据需要，仅使用模算术的性质和中国剩余定理来进行精确计算。根据强可能素数条件，判断 $a=2$ 是否为 $n=341$ 的合数性的 Miller–Rabin 见证。\n\n如果 $a=2$ 是 $n=341$ 的合数性见证，则将最终答案表示为 $1$，否则表示为 $0$。无需四舍五入，也不涉及单位。", "solution": "问题陈述已经过验证，被认为是有效的。它在数论方面有科学依据，问题提出得当，客观，并包含了推导唯一解所需的所有必要信息。我们可以开始求解。\n\n对于奇整数 $n  2$ 和基 $a$（其中 $1  a  n-1$），Miller-Rabin 素性检验是一种素性的概率性检验。它是基于费马小定理的检验的一种扩展。如果 $n$ 是一个素数，那么根据费马小定理，对于任何不能被 $n$ 整除的整数 $a$，有 $a^{n-1} \\equiv 1 \\pmod{n}$。此外，如果 $n$ 是素数，同余式 $x^2 \\equiv 1 \\pmod{n}$ 的唯一解是 $x \\equiv 1 \\pmod{n}$ 和 $x \\equiv -1 \\pmod{n}$。Miller-Rabin 检验利用了后一个性质。\n\n该算法按以下步骤进行：\n1.  首先，我们将 $n-1$ 写成 $2^s d$ 的形式，其中 $d$ 是一个奇整数且 $s \\ge 1$。\n2.  然后我们考虑模幂运算序列：\n    $$a^d \\pmod{n}, \\quad a^{2d} \\pmod{n}, \\quad a^{4d} \\pmod{n}, \\quad \\dots, \\quad a^{2^{s-1}d} \\pmod{n}$$\n    这个序列可以通过首先计算 $x_0 \\equiv a^d \\pmod{n}$，然后重复平方 $x_{i+1} \\equiv x_i^2 \\pmod{n}$（对于 $i=0, 1, \\dots, s-2$）来高效地计算。完整的数值序列是 $x_0, x_1, \\dots, x_{s-1}$。\n\n如果以下两个条件之一成立，整数 $n$ 被称为以 $a$ 为基的强可能素数：\n(A) $a^d \\equiv 1 \\pmod{n}$。\n(B) 对于某个在 $0 \\le i \\le s-1$ 范围内的整数 $i$，有 $a^{2^i d} \\equiv -1 \\pmod{n}$。\n\n如果这两个条件都不满足，那么 $n$ 必定是合数，而 $a$ 被称为 $n$ 的合数性的 Miller-Rabin 见证。这种情况发生在 $a^d \\not\\equiv 1 \\pmod{n}$ 且序列 $x_0, x_1, \\dots, x_{s-1}$ 中没有项同余于 $-1 \\pmod{n}$ 时。合数性的一个关键指标是找到“模 $n$ 的 1 的非平凡平方根”，即一个值 $x_i \\not\\equiv \\pm 1 \\pmod{n}$ 使得 $x_{i+1} \\equiv x_i^2 \\equiv 1 \\pmod{n}$。\n\n我们的任务是为整数 $n=341$ 和基 $a=2$ 执行一次 Miller-Rabin 迭代。\n\n首先，我们将 $n-1$ 分解成 $2^s d$ 的形式：\n$n - 1 = 341 - 1 = 340$。\n为了找到 $s$ 和 $d$，我们提出 2 的幂次因子：\n$340 = 2 \\times 170 = 2^2 \\times 85$。\n因为 $85$ 是奇数，所以我们有 $s=2$ 和 $d=85$。\n\n接下来，我们计算 $x_0 \\equiv a^d \\pmod{n}$：\n$x_0 \\equiv 2^{85} \\pmod{341}$。\n我们使用二进制取幂法（也称为平方求幂法）来计算这个值。指数 $85$ 的二进制表示是 $1010101_2$，对应于 $85 = 64 + 16 + 4 + 1 = 2^6 + 2^4 + 2^2 + 2^0$。\n我们计算 2 的幂模 341 的值：\n$2^1 \\equiv 2 \\pmod{341}$\n$2^2 \\equiv 4 \\pmod{341}$\n$2^4 \\equiv 4^2 \\equiv 16 \\pmod{341}$\n$2^8 \\equiv 16^2 \\equiv 256 \\pmod{341}$\n$2^{16} \\equiv 256^2 = 65536 \\pmod{341}$。为了化简，我们除以 $341$：$65536 = 192 \\times 341 + 64$。所以，$2^{16} \\equiv 64 \\pmod{341}$。\n$2^{32} \\equiv 64^2 = 4096 \\pmod{341}$。为了化简，我们除以 $341$：$4096 = 12 \\times 341 + 4$。所以，$2^{32} \\equiv 4 \\pmod{341}$。\n$2^{64} \\equiv 4^2 \\equiv 16 \\pmod{341}$。\n\n现在我们将指数 $85$ 所需的幂组合起来：\n$2^{85} = 2^{64} \\times 2^{16} \\times 2^4 \\times 2^1$\n$x_0 \\equiv 16 \\times 64 \\times 16 \\times 2 \\pmod{341}$\n让我们分步计算：\n$16 \\times 64 = 1024$。为了化简，$1024 = 3 \\times 341 + 1$。所以，$16 \\times 64 \\equiv 1 \\pmod{341}$。\n$x_0 \\equiv (16 \\times 64) \\times (16 \\times 2) \\equiv 1 \\times 32 \\equiv 32 \\pmod{341}$。\n所以，$x_0 = 32$。\n\n现在我们检查 $n=341$ 是以 $a=2$ 为基的强可能素数的条件。\n条件 (A)：$x_0 \\equiv 1 \\pmod{341}$ 是否成立？\n$32 \\not\\equiv 1 \\pmod{341}$。所以，条件 (A) 不成立。\n\n条件 (B)：对于某个 $i \\in \\{0, 1, \\dots, s-1\\}$，$x_i \\equiv -1 \\pmod{341}$ 是否成立？\n这里 $s=2$，所以我们检查 $i=0$ 和 $i=1$ 的情况。\n需要检查的值是 $x_0 = a^d \\pmod{n}$ 和 $x_1 = a^{2d} \\pmod{n}$。\n对于 $i=0$：$x_0 \\equiv -1 \\pmod{341}$ 是否成立？\n$-1 \\pmod{341}$ 是 $340$。我们有 $x_0 = 32$，且 $32 \\not\\equiv 340 \\pmod{341}$。\n\n对于 $i=1$：我们必须计算 $x_1 \\equiv x_0^2 \\pmod{341}$。\n$x_1 \\equiv 32^2 \\pmod{341}$\n$x_1 \\equiv 1024 \\pmod{341}$\n如前所算，$1024 = 3 \\times 341 + 1$，所以 $x_1 \\equiv 1 \\pmod{341}$。\n$x_1 \\equiv -1 \\pmod{341}$ 是否成立？\n因为 $n2$，所以 $1 \\not\\equiv -1 \\pmod{341}$。\n\n由于条件 (A) 和 (B) 均不满足，所以 $n=341$ 不是以 2 为基的强可能素数。因此，$a=2$ 是 $n=341$ 的合数性的 Miller-Rabin 见证。\n该检验揭示了其合数性，因为我们发现 $x_0=32 \\not\\equiv \\pm 1 \\pmod{341}$ 而 $x_1 \\equiv x_0^2 \\equiv 1 \\pmod{341}$。这意味着 $32$ 是模 $341$ 的 1 的一个非平凡平方根，这种情况只有在 $341$ 是合数时才会存在。这一发现意味着 $\\gcd(32-1, 341)$ 和 $\\gcd(32+1, 341)$ 是 $341$ 的非平凡因子。实际上，$\\gcd(31, 341) = 31$，这是 $341 = 11 \\times 31$ 的一个素因子。\n\n问题要求如果 $a=2$ 是 $n=341$ 的合数性见证，则答案为 $1$，否则为 $0$。我们的结论是 $a=2$ 是一个见证。", "answer": "$$\\boxed{1}$$", "id": "3086457"}, {"introduction": "一旦我们找到了所需的两个大素数，下一步就是构建RSA的公钥和私钥。这个过程是RSA机制的核心，它确立了加密和解密之间的数学关系。本练习[@problem_id:3086473]将带您动手实践RSA密钥生成的完整流程，从计算模数 $n$ 和欧拉函数 $\\varphi(n)$，到利用扩展欧几里得算法求解私钥指数 $d$。掌握这个过程对于理解公钥和私钥如何相互关联，以及为什么从公钥推导出私钥在计算上是困难的至关重要。", "problem": "在 Rivest–Shamir–Adleman (RSA) 公钥密码系统中，密钥是使用模一个合数的整数环上的算术来构造的。设 $p=61$ 和 $q=53$ 为不同的奇素数，公钥指数为 $e=17$。仅从欧拉函数、互质性和模逆元的定义出发，推导并明确计算：\n- 模数 $n$，\n- $\\varphi(n)$ 的值，以及\n- 满足 $e d \\equiv 1 \\pmod{\\varphi(n)}$ 的最小正整数 $d$。\n\n将您的最终答案以 $(n,\\ \\varphi(n),\\ d)$ 的顺序表示为单个行向量，写成行矩阵的形式。无需四舍五入；请提供精确整数。", "solution": "该问题表述清晰，其科学基础在于应用于公钥密码学的数论原理。所有必要数据均已提供，所需量可以唯一确定。因此，该问题被认为是 **有效的**。我们继续进行推导和计算。\n\n该问题要求计算与 RSA 密码系统相关的三个量：模数 $n$、欧拉函数 $\\varphi(n)$ 和私钥指数 $d$。给定两个不同的素数 $p=61$ 和 $q=53$，以及公钥指数 $e=17$。\n\n首先，我们计算模数 $n$。在 RSA 算法中，模数 $n$ 定义为两个大的、不同的素数的乘积，在本问题中记为 $p$ 和 $q$。\n$$n = p \\times q$$\n代入给定值 $p=61$ 和 $q=53$：\n$$n = 61 \\times 53$$\n计算过程如下：\n$$n = 61 \\times (50 + 3) = 61 \\times 50 + 61 \\times 3 = 3050 + 183 = 3233$$\n因此，模数为 $n = 3233$。\n\n其次，我们计算欧拉函数 $\\varphi(n)$ 的值。根据定义，$\\varphi(n)$ 计算小于等于 $n$ 且与 $n$ 互质的正整数的个数。欧拉函数的一个关键性质是它是积性函数。这意味着如果两个整数 $a$ 和 $b$ 互质，那么 $\\varphi(ab) = \\varphi(a)\\varphi(b)$。由于 $p$ 和 $q$ 是不同的素数，根据定义，它们是互质的。因此，我们可以写出：\n$$\\varphi(n) = \\varphi(pq) = \\varphi(p)\\varphi(q)$$\n对于任何素数 $k$，从 $1$ 到 $k-1$ 的所有整数都与 $k$ 互质。因此，对于一个素数 $k$，欧拉函数的值为 $\\varphi(k) = k-1$。将此应用于我们的素数 $p$ 和 $q$：\n$$\\varphi(p) = p - 1$$\n$$\\varphi(q) = q - 1$$\n结合这些结果，我们推导出 $\\varphi(n)$ 的公式：\n$$\\varphi(n) = (p-1)(q-1)$$\n代入给定值 $p=61$ 和 $q=53$：\n$$\\varphi(n) = (61 - 1)(53 - 1) = 60 \\times 52$$\n计算过程如下：\n$$\\varphi(n) = 60 \\times 52 = 3120$$\n因此，欧拉函数的值为 $\\varphi(n) = 3120$。\n\n第三，我们计算私钥指数 $d$。问题陈述 $d$ 是满足同余关系 $ed \\equiv 1 \\pmod{\\varphi(n)}$ 的最小正整数。这意味着 $d$ 是 $e$ 模 $\\varphi(n)$ 的模乘法逆元。给定 $e=17$，并且我们已经计算出 $\\varphi(n)=3120$。同余式为：\n$$17d \\equiv 1 \\pmod{3120}$$\n为了使逆元存在，$e$ 和 $\\varphi(n)$ 必须互质，即 $\\gcd(e, \\varphi(n)) = 1$。因为 $e=17$ 是一个素数，我们只需要检查 $17$ 是否是 $3120$ 的一个因子。除法 $3120 \\div 17$ 约等于 $183.5$，不是一个整数。因此，$\\gcd(17, 3120) = 1$，并且存在唯一的模逆元 $d$。\n\n为了找到 $d$，我们使用扩展欧几里得算法来求解关于整数 $d$ 和 $k$ 的丢番图方程 $17d + 3120k = 1$。该算法通过寻找 $3120$ 和 $17$ 的最大公约数来进行：\n$$\\begin{align*} 3120 = 183 \\times 17 + 9 \\\\ 17 = 1 \\times 9 + 8 \\\\ 9 = 1 \\times 8 + 1 \\end{align*}$$\n最后一个非零余数是 $1$，这证实了 $\\gcd(3120, 17) = 1$。现在，我们反向工作，将 $1$ 表示为 $17$ 和 $3120$ 的线性组合：\n从第三个方程，我们得到 $1 = 9 - 1 \\times 8$。\n从第二个方程代入 $8 = 17 - 1 \\times 9$：\n$$1 = 9 - 1 \\times (17 - 1 \\times 9) = 9 - 17 + 9 = 2 \\times 9 - 1 \\times 17$$\n从第一个方程代入 $9 = 3120 - 183 \\times 17$：\n$$1 = 2 \\times (3120 - 183 \\times 17) - 1 \\times 17$$\n$$1 = 2 \\times 3120 - 366 \\times 17 - 1 \\times 17$$\n$$1 = 2 \\times 3120 - 367 \\times 17$$\n这个方程可以写成 $(-367) \\times 17 + 2 \\times 3120 = 1$。对这个方程取模 $3120$：\n$$(-367) \\times 17 \\equiv 1 \\pmod{3120}$$\n这表明 $d \\equiv -367 \\pmod{3120}$。问题要求 $d$ 的最小正整数值。我们通过将模数加到负结果上来找到这个值：\n$$d = -367 + 3120 = 2753$$\n因此，私钥指数为 $d = 2753$。\n\n总之，计算出的值为：\n- $n = 3233$\n- $\\varphi(n) = 3120$\n- $d = 2753$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3233  3120  2753\n\\end{pmatrix}\n}\n$$", "id": "3086473"}, {"introduction": "无论是加密消息、解密密文，还是生成数字签名，RSA密码系统的所有核心操作都可以归结为一个基本的算术运算：模幂运算（modular exponentiation）。对于密码学中使用的大数而言，直接计算是不可行的，因此我们需要更聪明的算法。本练习[@problem_id:3086499]将让您运用“平方-乘”算法来高效地计算模幂，并使用费马小定理来验证结果，从而加深对数论理论与密码学实践之间紧密联系的理解。", "problem": "在Rivest–Shamir–Adleman (RSA)公钥密码学中，一个核心操作是在素数模环中的模幂运算，该运算依赖于高效的算法和数论的正确性保证。考虑计算模幂运算 $3^{200} \\bmod 101$ 的任务，其中 $101$ 是一个素数。通过在模 $101$ 的剩余类环中，实现基于二进制展开和重复平方的平方-乘算法来推导其值。然后，从模素数的乘法群的基本性质出发，使用费马小定理（FLT）对你计算的结果进行独立验证。将你的最终答案表示为集合 $\\{0,1,2,\\dots,100\\}$ 中的最小非负剩余。无需四舍五入。", "solution": "问题要求计算 $3^{200} \\bmod 101$。该问题陈述是有效的，因为它在数学上是适定的，在科学上以数论为基础，并且包含了推导唯一解所需的所有必要信息。模数 $101$ 是一个素数，这是所要求的验证方法的关键属性。\n\n我们将首先使用平方-乘算法计算其值。然后，我们将使用费马小定理提供一个独立的验证。\n\n### 方法一：平方-乘算法\n\n该算法通过使用指数 $e$ 的二进制表示来计算 $a^e \\pmod{n}$。底数是 $a=3$，指数是 $e=200$，模数是 $n=101$。\n\n首先，我们找到指数 $200$ 的二进制表示：\n$200 = 128 + 64 + 8 = 2^7 + 2^6 + 2^3$。\n用二进制表示，即为 $200_{10} = 11001000_2$。\n\n根据这个二进制展开，幂运算可以分解为：\n$$3^{200} = 3^{128+64+8} = 3^{128} \\cdot 3^{64} \\cdot 3^8$$\n我们需要通过重复平方计算 $k$ 直到 $7$ 的项 $3^{2^k}$，所有计算都在模 $101$ 下进行。\n\n平方的序列如下：\n$$\\begin{align*}\n3^1 \\equiv 3 \\pmod{101} \\\\\n3^2 \\equiv 3^2 = 9 \\pmod{101} \\\\\n3^4 \\equiv 9^2 = 81 \\pmod{101} \\\\\n3^8 \\equiv 81^2 = 6561 \\pmod{101}\n\\end{align*}$$\n为简化 $6561 \\pmod{101}$，我们进行除法运算：$6561 = 64 \\times 101 + 97$。因此，$3^8 \\equiv 97 \\pmod{101}$。使用绝对值较小的剩余进行计算通常更简单。由于 $97 \\equiv 97 - 101 \\equiv -4 \\pmod{101}$，我们可以在后续步骤中使用这个值。\n$$\\begin{align*}\n3^{16} \\equiv (3^8)^2 \\equiv 97^2 \\equiv (-4)^2 = 16 \\pmod{101} \\\\\n3^{32} \\equiv (3^{16})^2 \\equiv 16^2 = 256 \\pmod{101}\n\\end{align*}$$\n为简化 $256 \\pmod{101}$，我们进行除法运算：$256 = 2 \\times 101 + 54$。因此，$3^{32} \\equiv 54 \\pmod{101}$。\n$$\\begin{align*}\n3^{64} \\equiv (3^{32})^2 \\equiv 54^2 = 2916 \\pmod{101}\n\\end{align*}$$\n为简化 $2916 \\pmod{101}$，我们进行除法运算：$2916 = 28 \\times 101 + 88$。因此，$3^{64} \\equiv 88 \\pmod{101}$。\n$$\\begin{align*}\n3^{128} \\equiv (3^{64})^2 \\equiv 88^2 = 7744 \\pmod{101}\n\\end{align*}$$\n为简化 $7744 \\pmod{101}$，我们进行除法运算：$7744 = 76 \\times 101 + 68$。因此，$3^{128} \\equiv 68 \\pmod{101}$。\n\n现在，我们组合所需的 $3$ 的幂来计算最终结果：\n$$3^{200} \\equiv 3^{128} \\cdot 3^{64} \\cdot 3^8 \\pmod{101}$$\n代入计算出的值：\n$$3^{200} \\equiv 68 \\cdot 88 \\cdot 97 \\pmod{101}$$\n为简化乘法，我们可以在方便时使用负剩余：$88 \\equiv -13 \\pmod{101}$ 且 $97 \\equiv -4 \\pmod{101}$。\n$$3^{200} \\equiv 68 \\cdot (-13) \\cdot (-4) \\pmod{101}$$\n首先，将负数项相乘：\n$$(-13) \\cdot (-4) = 52$$\n因此表达式变为：\n$$3^{200} \\equiv 68 \\cdot 52 \\pmod{101}$$\n进行最后的乘法：\n$$68 \\cdot 52 = 3536$$\n为求模 $101$ 的剩余，我们将 $3536$ 除以 $101$：\n$$3536 = 35 \\times 101 + 1$$\n因此，我们得到：\n$$3^{200} \\equiv 1 \\pmod{101}$$\n\n### 方法二：使用费马小定理（FLT）进行验证\n\n费马小定理指出，如果 $p$ 是一个素数，那么对于任何不被 $p$ 整除的整数 $a$，我们有：\n$$a^{p-1} \\equiv 1 \\pmod{p}$$\n该定理是模素数 $p$ 的整数乘法群（记为 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$）的一个基本性质，该群的阶为 $p-1$。\n\n在本问题中，我们有 $p=101$，它是一个素数，底数是 $a=3$。由于 $101$ 不能整除 $3$，定理的条件得到满足。\n应用费马小定理，我们得到：\n$$3^{101-1} \\equiv 3^{100} \\equiv 1 \\pmod{101}$$\n我们的目标是计算 $3^{200} \\bmod 101$。我们可以用费马小定理中的指数 $100$ 来表示指数 $200$：\n$$200 = 2 \\times 100$$\n现在我们可以重写原始表达式：\n$$3^{200} = 3^{2 \\times 100} = (3^{100})^2$$\n将此表达式模 $101$ 并代入费马小定理的结果：\n$$3^{200} \\equiv (3^{100})^2 \\pmod{101}$$\n$$3^{200} \\equiv (1)^2 \\pmod{101}$$\n$$3^{200} \\equiv 1 \\pmod{101}$$\n两种方法都得到相同的结果 $1$。该值是集合 $\\{0,1,2,\\dots,100\\}$ 中所要求的最小非负剩余。", "answer": "$$\\boxed{1}$$", "id": "3086499"}]}