{"hands_on_practices": [{"introduction": "在我们运用椭圆曲线分解整数之前，我们必须首先掌握这些曲线上点的算术规则。本练习旨在在一个表现良好的素数域 $\\mathbb{F}_{101}$ 环境中，练习基本群运算——点加法和点倍加。通过完成这些计算，你将对支撑所有椭圆曲线算术的几何“弦切法”有一个具体的理解。[@problem_id:3091839]", "problem": "考虑有限域 $\\mathbb{F}_{101}$ 上的椭圆曲线 $E$，其方程为 $y^{2}=x^{3}+2x+3$。在Lenstra椭圆曲线分解法（ECM）中，人们对一个合数取模的椭圆曲线进行群运算，此时逆元可能不存在，从而揭示出一个非平凡因子。为了在一个所有非零元素都可逆的环境中练习底层的群运算，我们在素域 $\\mathbb{F}_{101}$ 上进行运算，并令 $(x_{1},y_{1})=(1,39)$ 和 $(x_{2},y_{2})=(3,6)$。\n\n任务：\n- 首先，通过在 $\\mathbb{F}_{101}$ 中直接检验定义方程 $y^{2}=x^{3}+2x+3$，从基本原理出发验证点 $(x_{1},y_{1})$ 和 $(x_{2},y_{2})$ 位于曲线 $E$ 上。\n- 仅使用弦切几何群律作为基本依据（即，通过两点的直线或在一点的切线与该三次曲线交于第三点，群和是此第三个交点关于 $x$ 轴的反射点），推导在 $\\mathbb{F}_{101}$ 上计算 $(x_{3},y_{3})=(x_{1},y_{1})+(x_{2},y_{2})$ 和 $(x_{4},y_{4})=2(x_{1},y_{1})$ 的代数公式。证明您所使用的乘法逆元在 $\\mathbb{F}_{101}$ 中存在，并明确地进行计算以得到 $(x_{3},y_{3})$ 和 $(x_{4},y_{4})$。\n- 令 $s$ 为 $x$ 坐标 $x_{3}$ 和 $x_{4}$ 之和对 101 取模的结果；即 $s\\equiv x_{3}+x_{4}\\pmod{101}$，其中 $s\\in\\{0,1,\\dots,100\\}$。将单个整数 $s$ 作为您的最终答案。\n\n您的最终答案必须是规范代表集 $\\{0,1,\\dots,100\\}$ 中的单个整数 $s$。无需四舍五入，不涉及单位。不要在最终答案中报告中间坐标；只提供 $s$。", "solution": "我们在素域 $\\mathbb{F}_{101}$ 上进行运算，因此每个非零元素都存在模 101 的乘法逆元。\n\n步骤 1：验证点 $(x_{1},y_{1})$ 和 $(x_{2},y_{2})$ 位于曲线 $E$ 上。\n\n- 对于 $(x_{1},y_{1})=(1,39)$，计算 $y_{1}^{2}$ 和 $x_{1}^{3}+2x_{1}+3$ 模 101 的值：\n$$y_{1}^{2}\\equiv 39^{2}\\equiv 1521\\equiv 1521-101\\cdot 15=1521-1515=6\\pmod{101}$$\n$$x_{1}^{3}+2x_{1}+3\\equiv 1^{3}+2\\cdot 1+3=1+2+3=6\\pmod{101}$$\n因此 $(1,39)$ 在 $\\mathbb{F}_{101}$ 中满足方程 $y^{2}=x^{3}+2x+3$。\n\n- 对于 $(x_{2},y_{2})=(3,6)$：\n$$y_{2}^{2}\\equiv 6^{2}=36\\pmod{101},$$\n$$x_{2}^{3}+2x_{2}+3\\equiv 3^{3}+2\\cdot 3+3=27+6+3=36\\pmod{101}$$\n因此 $(3,6)$ 满足曲线方程。\n\n步骤 2：从弦切律推导加法和倍点公式。\n\n基本原理：对于一个定义在特征不为 $2$ 或 $3$ 的域上的短Weierstrass方程 $y^{2}=x^{3}+ax+b$，其群律的几何定义如下。给定两个点 $P=(x_{1},y_{1})$ 和 $Q=(x_{2},y_{2})$，其中 $x_{1}\\neq x_{2}$，通过 $P$ 和 $Q$ 的唯一一条直线 $\\ell$ 的斜率为 $m$，方程为 $y=m(x-x_{1})+y_{1}$。将 $y$ 代入 $y^{2}=x^{3}+ax+b$ 会得到一个关于 $x$ 的三次方程，其根是直线 $\\ell$ 与曲线的三个交点的 $x$ 坐标。由于 $x_{1}$ 和 $x_{2}$ 是其中的两个根，设 $x_{3}$ 是第三个根。根据韦达定理，所有根的和等于 $m^{2}$，因此\n$$x_{1}+x_{2}+x_{3}=m^{2},\\quad\\text{so}\\quad x_{3}=m^{2}-x_{1}-x_{2}.$$\n曲线上的第三个交点是 $(x_{3},y_{3}^{\\prime})$，其中 $y_{3}^{\\prime}=m(x_{3}-x_{1})+y_{1}$ 在直线上；群和是通过关于 $x$ 轴的反射得到的，所以\n$$P+Q=(x_{3},-y_{3}^{\\prime})=(x_{3},\\,m(x_{1}-x_{3})-y_{1}).$$\n当 $P=Q$ 时，直线是点 $P$ 处的切线，其斜率通过对 $y^{2}=x^{3}+ax+b$ 进行隐函数求导得到：\n$$2y\\,\\frac{dy}{dx}=3x^{2}+a\\quad\\Rightarrow\\quad m=\\frac{3x_{1}^{2}+a}{2y_{1}}.$$\n将此 $m$ 代入相同的代数关系式中，得到\n$$x_{4}=m^{2}-2x_{1},\\qquad y_{4}=m(x_{1}-x_{4})-y_{1},$$\n这是 $2P=(x_{4},y_{4})$ 的计算公式。在 $\\mathbb{F}_{101}$ 上，只要分母不为零，它们就是可逆的。在我们的例子中，$x_{1}\\neq x_{2}$ 所以 $x_{2}-x_{1}\\neq 0$，并且 $y_{1}\\neq 0$ 所以 $2y_{1}\\neq 0$；因此逆元存在。\n\n现在我们在 $\\mathbb{F}_{101}$ 中，当 $a=2$ 时进行显式计算。\n\n步骤 3：计算 $(x_{3},y_{3})=(x_{1},y_{1})+(x_{2},y_{2})$。\n\n- 斜率 $m$：\n$$m\\equiv \\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\equiv \\frac{6-39}{3-1}\\equiv \\frac{-33}{2}\\equiv \\frac{68}{2}\\pmod{101}.$$\n$2$ 模 101 的逆元是 $51$，因为 $2\\cdot 51\\equiv 102\\equiv 1\\pmod{101}$。因此\n$$m\\equiv 68\\cdot 51\\equiv 3468\\equiv 3468-101\\cdot 34=3468-3434=34\\pmod{101}.$$\n\n- $x$ 坐标：\n$$x_{3}\\equiv m^{2}-x_{1}-x_{2}\\equiv 34^{2}-1-3\\pmod{101}.$$\n因为 $34^{2}=1156\\equiv 45\\pmod{101}$，我们得到\n$$x_{3}\\equiv 45-4=41\\pmod{101}.$$\n\n- $y$ 坐标：\n$$y_{3}\\equiv m(x_{1}-x_{3})-y_{1}\\equiv 34(1-41)-39\\equiv 34\\cdot (-40)-39\\pmod{101}.$$\n计算 $1-41\\equiv -40\\equiv 61\\pmod{101}$，所以\n$$y_{3}\\equiv 34\\cdot 61-39\\equiv 2074-39\\equiv (2074-101\\cdot 20)-39\\equiv 54-39=15\\pmod{101}.$$\n因此 $(x_{3},y_{3})=(41,15)$。快速验算：$y_{3}^{2}\\equiv 15^{2}=225\\equiv 23$，且 $x_{3}^{3}+2x_{3}+3\\equiv 41^{3}+82+3$。使用 $41^{2}\\equiv 65$ 得到 $41^{3}\\equiv 41\\cdot 65=2665\\equiv 39$，所以 $39+85\\equiv 124\\equiv 23$，与 $y_{3}^{2}$ 一致。\n\n步骤 4：计算 $(x_{4},y_{4})=2(x_{1},y_{1})$。\n\n- 切线斜率 $m$：\n$$m\\equiv \\frac{3x_{1}^{2}+a}{2y_{1}}\\equiv \\frac{3\\cdot 1^{2}+2}{2\\cdot 39}\\equiv \\frac{5}{78}\\pmod{101}.$$\n求 $78$ 模 101 的逆元。使用扩展欧几里得算法：\n$$101=78+23,\\quad 78=3\\cdot 23+9,\\quad 23=2\\cdot 9+5,\\quad 9=1\\cdot 5+4,\\quad 5=1\\cdot 4+1,$$\n回代得到 $-22\\cdot 78+17\\cdot 101=1$，所以 $78^{-1}\\equiv -22\\equiv 79\\pmod{101}$。因此\n$$m\\equiv 5\\cdot 79\\equiv 395\\equiv 395-101\\cdot 3=395-303=92\\pmod{101}.$$\n\n- $x$ 坐标：\n$$x_{4}\\equiv m^{2}-2x_{1}\\equiv 92^{2}-2\\cdot 1\\pmod{101}.$$\n因为 $92\\equiv -9$，所以 $92^{2}\\equiv 81$，得到\n$$x_{4}\\equiv 81-2=79\\pmod{101}.$$\n\n- $y$ 坐标：\n$$y_{4}\\equiv m(x_{1}-x_{4})-y_{1}\\equiv 92(1-79)-39\\equiv 92\\cdot (-78)-39\\pmod{101}.$$\n因为 $-78\\equiv 23$，我们有\n$$y_{4}\\equiv 92\\cdot 23-39\\equiv 2116-39\\equiv (2116-101\\cdot 20)-39\\equiv 96-39=57\\pmod{101}.$$\n因此 $(x_{4},y_{4})=(79,57)$。快速验算：$y_{4}^{2}\\equiv 57^{2}=3249\\equiv 17$，且 $x_{4}^{3}+2x_{4}+3\\equiv 79^{3}+161\\equiv 58+60=118\\equiv 17$。\n\n步骤 5：计算所要求的单个整数 $s$。\n\n根据定义，$s\\equiv x_{3}+x_{4}\\pmod{101}$，其中 $s\\in\\{0,1,\\dots,100\\}$。我们有 $x_{3}=41$ 和 $x_{4}=79$，所以\n$$s\\equiv 41+79=120\\equiv 120-101=19\\pmod{101}.$$\n因此，在规范代表集中 $s=19$。\n\n关于与Lenstra椭圆曲线分解法（ECM）的相关性备注：在ECM中，人们对一个合数 $N$ 取模进行相同的有理斜率计算。当像 $x_{2}-x_{1}$ 或 $2y_{1}$ 这样的分母在模 $N$ 下不可逆时，计算它与 $N$ 的最大公约数会得到一个非平凡因子。上述显式计算演示了ECM所依赖的群律步骤，这里是在素数模 $101$ 的安全环境下进行的，其中所有非零分母都是可逆的。", "answer": "$$\\boxed{19}$$", "id": "3091839"}, {"introduction": "现在我们理解了椭圆曲线算术在素数域中的工作原理，接下来让我们探讨当我们将相同的运算应用到合数模 $N$ 上时会发生什么。这正是 Lenstra 方法的核心思想。本练习将展示 ECM 的“魔力”：一个看似常规的计算可能会失败，而这种失败却能有效地揭示出 $N$ 的一个隐藏素因子。[@problem_id:3091785]", "problem": "设 $N$ 为合数模 $N = 10403$，并考虑由下式定义的三次曲线\n$$\nE: \\ y^{2} \\equiv x^{3} + a x + b \\pmod{N}\n$$\n其系数为 $a = 99$ 和 $b = 454$。设 $P = (x_{0}, y_{0}) = (26, 101)$ 为在 $\\mathbb{Z}_{N}$ 上应用 Lenstra 椭圆曲线分解法 (ECM) 所选的起始点。你可以将以下事实作为基础：在一个环上，Weierstrass 模型的标准弦切加法法则需要对某些分母模 $N$ 求逆；并且 $\\mathbb{Z}_{N}$ 中的一个非零元素是可逆的，当且仅当它与 $N$ 互质。\n\n任务：\n1. 验证点 $P$ 满足曲线方程 $E$ 模 $N$。\n2. 从 Weierstrass 模型上的群法则以及并非所有非零元素在 $\\mathbb{Z}_{N}$ 中都可逆这一事实出发，解释为什么尝试第一次倍点运算 $2P$ 会强制计算形如 $2 y_{0} \\pmod{N}$ 的分母的逆，以及为什么求逆失败会揭示一个与 $N$ 的非平凡最大公约数。\n3. 对于此处的 $E$ 和 $P$，明确计算该最大公约数，从而得到 $N$ 的一个非平凡素因子 $p$。作为基于奇异性定义的一致性检验，通过检验判别式因子 $4 a^{3} + 27 b^{2}$ 模 $p$ 和模 $N$ 的互补素因子 $q$ 的值，简要论证曲线 $E$ 模此 $p$ 是奇异的，而模 $q$ 是非奇异的。\n\n将你得到的素数 $p$ 作为最终答案。无需四舍五入，不涉及单位。你的答案必须是一个整数。", "solution": "我们从环 $\\mathbb{Z}_{N}$ 上的标准 Weierstrass 模型 $E: y^{2} \\equiv x^{3} + a x + b \\pmod{N}$ 开始。在 Lenstra 椭圆曲线分解法 (ECM) 中，我们使用常规的弦切公式在模 $N$ 下执行椭圆曲线加法和标量乘法。这些公式需要计算一个包含分子和分母的斜率 $\\lambda$；为了完成加法，必须对分母模 $N$ 求逆。在一个域上，每个非零元素都是可逆的，但在合数 $N$ 构成的环 $\\mathbb{Z}_{N}$ 上，一个非零元素是可逆的，当且仅当它与 $N$ 的最大公约数为 1。如果所需的分母与 $N$ 有一个非平凡的最大公约数，则求逆尝试会失败，而该最大公约数即为 $N$ 的一个因子。\n\n步骤 1：验证点 $P$ 位于曲线 $E$ 上（模 $N$）。\n我们计算\n$$\nx_{0}^{3} + a x_{0} + b \\equiv 26^{3} + 99 \\cdot 26 + 454 \\pmod{10403}.\n$$\n首先，$26^{3} = 17576$，且 $99 \\cdot 26 = 2574$，所以\n$$\nx_{0}^{3} + a x_{0} + b = 17576 + 2574 + 454 = 20604.\n$$\n模 $10403$ 约简：\n$$\n20604 \\equiv 20604 - 10403 = 10201 \\pmod{10403}.\n$$\n同时，\n$$\ny_{0}^{2} = 101^{2} = 10201.\n$$\n因此 $y_{0}^{2} \\equiv x_{0}^{3} + a x_{0} + b \\pmod{10403}$，所以点 $P$ 满足曲线方程。\n\n步骤 2：解释分母和最大公约数的作用。\n对于一个点 $P = (x_{0}, y_{0})$ 且 $y_{0} \\not\\equiv 0 \\pmod{N}$，Weierstrass 模型上的切线（倍点）公式使用斜率\n$$\n\\lambda \\equiv \\frac{3 x_{0}^{2} + a}{2 y_{0}} \\pmod{N},\n$$\n计算过程需要求 $2 y_{0}$ 模 $N$ 的模逆。在 $\\mathbb{Z}_{N}$ 上，这样的逆存在当且仅当 $\\gcd(2 y_{0}, N) = 1$。如果 $\\gcd(2 y_{0}, N) = d > 1$，则求逆失败，而计算 $\\gcd(2 y_{0}, N)$ 会立即得到 $N$ 的一个非平凡因子 $d$。这正是 ECM 利用模 $N$ 的一个隐藏素因子 $p$ 的偶然奇异性的机制：在模 $p$ 的奇异纤维上，群法则的分母可以在域 $\\mathbb{F}_{p}$ 中为零，而在 $\\mathbb{Z}_{N}$ 上，这表现为分母与 $N$ 共享一个非平凡的公约数，从而通过最大公约数计算揭示该公约数。\n\n步骤 3：计算本例中揭示因子的最大公约数。\n对于我们的点 $P = (26, 101)$，倍点运算的分母是 $2 y_{0} = 2 \\cdot 101 = 202$。计算\n$$\n\\gcd(2 y_{0}, N) = \\gcd(202, 10403).\n$$\n我们执行欧几里得算法：\n$$\n10403 = 202 \\cdot 51 + 101, \\quad 202 = 101 \\cdot 2 + 0,\n$$\n因此 $\\gcd(202, 10403) = 101$。因此，$p = 101$ 是 $N$ 的一个非平凡素因子，由倍点运算分母求逆失败而揭示。\n\n通过模素因子的奇异性和非奇异性进行一致性检验。\n$y^{2} = x^{3} + a x + b$ 的判别式是 $\\Delta = -16(4 a^{3} + 27 b^{2})$。模一个素数 $r$ 的奇异性等价于 $4 a^{3} + 27 b^{2} \\equiv 0 \\pmod{r}$。我们对此进行验证，分别模 $p = 101$ 和互补素数 $q = N / p = 10403 / 101 = 103$。\n\n模 $p = 101$ 计算：\n$$\na \\equiv 99 \\equiv -2 \\pmod{101}, \\quad b \\equiv 454 \\equiv 50 \\pmod{101}.\n$$\n则\n$$\n4 a^{3} + 27 b^{2} \\equiv 4(-2)^{3} + 27 \\cdot 50^{2} \\pmod{101}.\n$$\n将各项模 $101$ 约简：\n$$\n4(-8) \\equiv -32 \\equiv 69 \\pmod{101},\n$$\n以及\n$$\n50^{2} = 2500 \\equiv 2500 - 24 \\cdot 101 = 2500 - 2424 = 76 \\pmod{101}, \\quad 27 \\cdot 76 = 2052 \\equiv 2052 - 20 \\cdot 101 = 32 \\pmod{101}.\n$$\n因此\n$$\n4 a^{3} + 27 b^{2} \\equiv 69 + 32 = 101 \\equiv 0 \\pmod{101},\n$$\n所以 $E$ 模 $p$ 是奇异的。\n\n模 $q = 103$ 计算：\n$$\na \\equiv 99 \\pmod{103}, \\quad b \\equiv 454 \\equiv 42 \\pmod{103}.\n$$\n我们有 $a^{3} \\equiv 99^{3} \\equiv (-4)^{3} \\equiv -64 \\equiv 39 \\pmod{103}$，所以 $4 a^{3} \\equiv 4 \\cdot 39 \\equiv 156 \\equiv 53 \\pmod{103}$。另外 $b^{2} \\equiv 42^{2} = 1764 \\equiv 1764 - 17 \\cdot 103 = 13 \\pmod{103}$，因此 $27 b^{2} \\equiv 27 \\cdot 13 = 351 \\equiv 351 - 3 \\cdot 103 = 42 \\pmod{103}$。所以\n$$\n4 a^{3} + 27 b^{2} \\equiv 53 + 42 = 95 \\not\\equiv 0 \\pmod{103},\n$$\n所以 $E$ 模 $q$ 是非奇异的。\n\n这证实了我们选择的例子在模隐藏因子 $p$ 时是奇异的，并且第一步倍点运算立即触发了一次最大公约数计算，从而得到 $p$。\n\n因此，通过早期 ECM 算术揭示的素因子是 $p = 101$。", "answer": "$$\\boxed{101}$$", "id": "3091785"}, {"introduction": "直接计算点加法和点倍加需要频繁的模逆运算，这在计算上是相当昂贵的。ECM 的实际应用通常使用射影坐标来避免这些求逆运算。最后一个练习题将演示这种实用技术，展示计算如何在没有中间求逆的情况下进行，并最终同样揭示出模数的一个因子。[@problem_id:3091837]", "problem": "在用于整数分解的Lenstra椭圆曲线方法（ECM）中，算术运算在模一个合数的椭圆曲线上进行，以检测能揭示一个因子的不可逆元素。为避免点算术运算中的模逆运算，我们在雅可比射影坐标中进行运算，将任何求逆运算推迟到最后转换回仿射坐标时再进行。如果该求逆运算失败，计算最大公约数便会揭示模数的一个非平凡因子。\n\n设 $N=77$。考虑由短Weierstrass模型给出的模 $N$ 的椭圆曲线\n$$\nE: \\ y^{2} \\equiv x^{3} + a x + b \\pmod{N}\n$$\n其参数为 $a=1$ 和 $b=39$。所有运算都在模 $N$ 下进行。设点 $P$ 的仿射坐标为 $(x,y)=(2,7)$，其在雅可比射影坐标中表示为 $(X:Y:Z)=(2:7:1)$。\n\n仅使用椭圆曲线的群律和雅可比射影坐标的定义，通过执行点倍加计算来计算 $2P$ 模 $N$ 的雅可比射影坐标。展示您在倍点运算中引入的每个中间坐标或标量，并在每一步将每个算术结果模 $N$ 进行约化。然后，通过确定\n$$\nd=\\gcd(Z_{2},N),\n$$\n来模拟最后转换回仿射坐标的过程，其中 $(X_{2}:Y_{2}:Z_{2})$ 表示您计算出的 $2P$ 的雅可比射影坐标。将 $d$ 作为最终答案报告。无需四舍五入。最终答案必须是单个整数。", "solution": "我们首先验证所给点 $P=(2,7)$ 位于椭圆曲线 $E: y^{2} \\equiv x^{3} + x + 39 \\pmod{77}$ 上。我们计算 $y^2 = 7^2 = 49 \\pmod{77}$ 和 $x^3+x+39 = 2^3+2+39 = 49 \\pmod{77}$。两者相等，验证通过。\n\n我们将使用雅可比射影坐标 $(X:Y:Z)$ 来执行点倍加运算，其中点 $P$ 表示为 $(X_1:Y_1:Z_1) = (2:7:1)$。对于一个点 $P=(X_1, Y_1, Z_1)$，其倍加结果 $2P=(X_2, Y_2, Z_2)$ 的公式如下（假设 $Y_1 \\neq 0$）：\n$M = 3X_1^2 + aZ_1^4$\n$S = 4X_1Y_1^2$\n$X_2 = M^2 - 2S$\n$Y_2 = M(S - X_2) - 8Y_1^4$\n$Z_2 = 2Y_1Z_1$\n\n所有算术运算都在模 $N=77$ 下进行。\n\n1.  计算中间标量 $M$：\n    $$\n    M = 3X_1^2 + aZ_1^4 = 3(2^2) + (1)(1^4) = 3(4) + 1 = 12 + 1 = 13\n    $$\n    模 $77$ 下，我们有 $M \\equiv 13 \\pmod{77}$。\n\n2.  计算中间标量 $S$：\n    $$\n    S = 4X_1Y_1^2 = 4(2)(7^2) = 8(49) = 392\n    $$\n    为了将其模 $77$ 约化，我们发现 $392 = 5 \\times 77 + 7$。\n    因此，$S \\equiv 7 \\pmod{77}$。\n\n3.  计算坐标 $X_2$：\n    $$\n    X_2 = M^2 - 2S \\equiv 13^2 - 2(7) \\pmod{77}\n    $$\n    首先，$M^2 = 13^2 = 169$。模 $77$ 约化：$169 = 2 \\times 77 + 15$，所以 $M^2 \\equiv 15 \\pmod{77}$。\n    接着，$2S = 2(7) = 14$。\n    因此，\n    $$\n    X_2 \\equiv 15 - 14 = 1 \\pmod{77}\n    $$\n\n4.  计算坐标 $Y_2$：\n    $$\n    Y_2 = M(S - X_2) - 8Y_1^4 \\pmod{77}\n    $$\n    首先，我们计算 $S - X_2 \\equiv 7 - 1 = 6 \\pmod{77}$。\n    第一项是 $M(S - X_2) \\equiv 13(6) = 78$。模 $77$ 约化：$78 \\equiv 1 \\pmod{77}$。\n    第二项需要计算 $Y_1^4 = (Y_1^2)^2 = (7^2)^2 = 49^2$。\n    $49 \\equiv -28 \\pmod{77}$，所以 $49^2 \\equiv (-28)^2 = 784 \\pmod{77}$。\n    $784 = 10 \\times 77 + 14$，所以 $Y_1^4 \\equiv 14 \\pmod{77}$。\n    第二项是 $8Y_1^4 \\equiv 8(14) = 112$。\n    $112 = 1 \\times 77 + 35$，所以 $8Y_1^4 \\equiv 35 \\pmod{77}$。\n    合并 $Y_2$ 的各项：\n    $$\n    Y_2 \\equiv 1 - 35 = -34 \\equiv -34 + 77 = 43 \\pmod{77}\n    $$\n\n5.  计算坐标 $Z_2$：\n    $$\n    Z_2 = 2Y_1Z_1 = 2(7)(1) = 14\n    $$\n    模 $77$ 下，我们有 $Z_2 \\equiv 14 \\pmod{77}$。\n\n$2P$ 的雅可比射影坐标结果为 $(X_2:Y_2:Z_2) = (1:43:14)$。\n\n最后一步是按照指示计算 $d = \\gcd(Z_2, N)$。\n$$\nd = \\gcd(14, 77)\n$$\n$14$ 的素数分解是 $2 \\times 7$。\n$77$ 的素数分解是 $7 \\times 11$。\n最大公约数是公共素因子的乘积，即 $7$。\n$$\nd = 7\n$$\n这个结果展示了 ECM 的核心原理：$2P$ 的计算未能产生一个在模 $77$ 下 $Z$ 坐标可逆的点。尝试计算仿射坐标 $x_2 = X_2/Z_2^2$ 需要对 $Z_2=14$ 进行模 $77$ 的求逆运算，但这是不可能的，因为 $\\gcd(14, 77) > 1$。这个失败的求逆运算揭示了 $N=77$ 的一个非平凡因子 $7$。", "answer": "$$\\boxed{7}$$", "id": "3091837"}]}