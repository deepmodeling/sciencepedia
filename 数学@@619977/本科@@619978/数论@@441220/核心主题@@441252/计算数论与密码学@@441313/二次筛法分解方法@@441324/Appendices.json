{"hands_on_practices": [{"introduction": "在开始筛选之前，我们需要明智地选择我们的工具，即因子基。这个练习将指导你完成二次筛选法中关键的第一步：构建因子基 [@problem_id:3092957]。理解为何只有特定的素数（那些使 $N$ 成为二次剩余的素数）被选中，对于掌握该算法的效率和理论基础至关重要。", "problem": "您正在为整数分解的二次筛法（QS）准备因子基。设 $N=10403$，平滑度界限为 $B=31$。在此背景下，因子基 $\\mathcal{F}$ 定义为满足 $p \\leq B$ 的奇素数 $p$ 的集合，其中 $p$ 要么整除 $N$，要么 $N$ 是模 $p$ 的二次剩余，即勒让德符号 $\\left( \\frac{N}{p} \\right)=1$。在二次筛法中，素数 $2$ 是单独处理的，根据定义，它被排除在该集合之外。\n\n根据这些原则确定集合 $\\mathcal{F}$，然后计算总和的精确值\n$$S \\;=\\; \\sum_{p \\in \\mathcal{F}} p.$$\n您的最终答案应为一个精确整数（无四舍五入）。", "solution": "任务是为整数 $N=10403$ 在平滑度界限 $B=31$ 下确定因子基 $\\mathcal{F}$，然后计算该集合中素数的总和 $S$。\n\n根据问题陈述，因子基 $\\mathcal{F}$ 是满足 $p \\leq B$ 的奇素数 $p$ 的集合，其中 $p$ 要么整除 $N$，要么 $N$ 是模 $p$ 的二次剩余。第二个条件等价于勒让德符号 $\\left( \\frac{N}{p} \\right)$ 等于 $1$。素数 $p=2$ 被明确排除。\n\n首先，我们列出所有小于或等于平滑度界限 $B=31$ 的奇素数。这些素数是：\n$$ \\{3, 5, 7, 11, 13, 17, 19, 23, 29, 31\\} $$\n这是我们纳入 $\\mathcal{F}$ 的候选素数集合。\n\n对于每个候选素数 $p$，我们必须检查是否满足以下两个条件之一：\n1.  $p$ 整除 $N$，即 $N \\equiv 0 \\pmod{p}$。\n2.  $N$ 是模 $p$ 的二次剩余，即 $\\left( \\frac{N}{p} \\right) = 1$。\n\n我们首先研究这些素数中是否有任何一个能整除 $N = 10403$。快速检查小的素数因子可知 $N = 101 \\times 103$。由于 $N$ 的最小素数因子是 $101$，而所有候选素数 $p$ 都满足 $p \\leq 31$，很明显没有一个候选素数能整除 $N$。\n因此，素数 $p$ 属于 $\\mathcal{F}$ 的条件简化为仅第二个条件：$\\left( \\frac{N}{p} \\right) = 1$。\n\n我们现在为每个候选素数 $p$ 计算勒让德符号 $\\left( \\frac{N}{p} \\right) = \\left( \\frac{10403}{p} \\right)$。我们将使用性质 $\\left( \\frac{a}{p} \\right) = \\left( \\frac{a \\pmod{p}}{p} \\right)$ 和二次互反律。\n\n对于 $p=3$：\n$10403 \\equiv 1+0+4+0+3 \\equiv 8 \\equiv 2 \\pmod{3}$。\n$\\left( \\frac{10403}{3} \\right) = \\left( \\frac{2}{3} \\right) = -1$。因此，$3 \\notin \\mathcal{F}$。\n\n对于 $p=5$：\n$10403 \\equiv 3 \\pmod{5}$。\n$\\left( \\frac{10403}{5} \\right) = \\left( \\frac{3}{5} \\right) = \\left( \\frac{5}{3} \\right)(-1)^{\\frac{3-1}{2}\\frac{5-1}{2}} = \\left( \\frac{2}{3} \\right)(-1)^2 = -1$。因此，$5 \\notin \\mathcal{F}$。\n\n对于 $p=7$：\n$10403 = 7 \\times 1486 + 1$，所以 $10403 \\equiv 1 \\pmod{7}$。\n$\\left( \\frac{10403}{7} \\right) = \\left( \\frac{1}{7} \\right) = 1$。因此，$7 \\in \\mathcal{F}$。\n\n对于 $p=11$：\n$10403 = 11 \\times 945 + 8$，所以 $10403 \\equiv 8 \\pmod{11}$。\n$\\left( \\frac{10403}{11} \\right) = \\left( \\frac{8}{11} \\right) = \\left( \\frac{2^2 \\cdot 2}{11} \\right) = \\left( \\frac{2}{11} \\right) = -1$，因为 $11 \\equiv 3 \\pmod{8}$。因此，$11 \\notin \\mathcal{F}$。\n\n对于 $p=13$：\n$10403 = 13 \\times 800 + 3$，所以 $10403 \\equiv 3 \\pmod{13}$。\n$\\left( \\frac{10403}{13} \\right) = \\left( \\frac{3}{13} \\right) = \\left( \\frac{13}{3} \\right)(-1)^{\\frac{3-1}{2}\\frac{13-1}{2}} = \\left( \\frac{1}{3} \\right)(-1)^6 = 1$。因此，$13 \\in \\mathcal{F}$。\n\n对于 $p=17$：\n$10403 = 17 \\times 611 + 16$，所以 $10403 \\equiv 16 \\pmod{17}$。\n$\\left( \\frac{10403}{17} \\right) = \\left( \\frac{16}{17} \\right) = \\left( \\frac{4^2}{17} \\right) = 1$。因此，$17 \\in \\mathcal{F}$。\n\n对于 $p=19$：\n$10403 = 19 \\times 547 + 10$，所以 $10403 \\equiv 10 \\pmod{19}$。\n$\\left( \\frac{10403}{19} \\right) = \\left( \\frac{10}{19} \\right) = \\left( \\frac{2}{19} \\right)\\left( \\frac{5}{19} \\right)$。因为 $19 \\equiv 3 \\pmod{8}$，所以 $\\left( \\frac{2}{19} \\right)=-1$。对于第二项，$\\left( \\frac{5}{19} \\right) = \\left( \\frac{19}{5} \\right) = \\left( \\frac{4}{5} \\right) = 1$。所以，$\\left( \\frac{10}{19} \\right) = (-1)(1) = -1$。因此，$19 \\notin \\mathcal{F}$。\n\n对于 $p=23$：\n$10403 = 23 \\times 452 + 7$，所以 $10403 \\equiv 7 \\pmod{23}$。\n$\\left( \\frac{10403}{23} \\right) = \\left( \\frac{7}{23} \\right) = \\left( \\frac{23}{7} \\right)(-1)^{\\frac{7-1}{2}\\frac{23-1}{2}} = \\left( \\frac{2}{7} \\right)(-1)^{3 \\cdot 11} = (1)(-1) = -1$，因为 $7 \\equiv 7 \\pmod{8}$。因此，$23 \\notin \\mathcal{F}$。\n\n对于 $p=29$：\n$10403 = 29 \\times 358 + 21$，所以 $10403 \\equiv 21 \\pmod{29}$。\n$\\left( \\frac{10403}{29} \\right) = \\left( \\frac{21}{29} \\right) = \\left( \\frac{3}{29} \\right)\\left( \\frac{7}{29} \\right)$。对于第一项，$\\left( \\frac{3}{29} \\right) = \\left( \\frac{29}{3} \\right) = \\left( \\frac{2}{3} \\right) = -1$。对于第二项，$\\left( \\frac{7}{29} \\right) = \\left( \\frac{29}{7} \\right) = \\left( \\frac{1}{7} \\right)=1$。所以，$\\left( \\frac{21}{29} \\right) = (-1)(1) = -1$。因此，$29 \\notin \\mathcal{F}$。\n\n对于 $p=31$：\n$10403 = 31 \\times 335 + 18$，所以 $10403 \\equiv 18 \\pmod{31}$。\n$\\left( \\frac{10403}{31} \\right) = \\left( \\frac{18}{31} \\right) = \\left( \\frac{2 \\cdot 3^2}{31} \\right) = \\left( \\frac{2}{31} \\right) = 1$，因为 $31 \\equiv 7 \\pmod{8}$。因此，$31 \\in \\mathcal{F}$。\n\n满足条件的素数是 $\\{7, 13, 17, 31\\}$。\n因此，因子基为 $\\mathcal{F} = \\{7, 13, 17, 31\\}$。\n\n最后，我们计算 $\\mathcal{F}$ 中元素的总和 $S$：\n$$ S \\;=\\; \\sum_{p \\in \\mathcal{F}} p \\;=\\; 7 + 13 + 17 + 31 $$\n$$ S \\;=\\; 20 + 17 + 31 \\;=\\; 37 + 31 \\;=\\; 68 $$\n总和的精确值为 $68$。", "answer": "$$\\boxed{68}$$", "id": "3092957"}, {"introduction": "收集到足够多的“平滑”关系后，二次筛法的核心步骤便是利用线性代数找到这些关系的特定组合，以构造出一个完全平方数。这个练习 [@problem_id:3093030] 让你亲身体验这一过程，通过在有限域 $\\mathbb{F}_{2}$ 上操作奇偶性向量，你将学会如何从看似无关的等式中发现线性依赖关系，并最终构建出能够分解 $N$ 的关键同余式 $X^{2} \\equiv Y^{2} \\pmod{N}$。", "problem": "考虑整数 $N = 205$ 和由素数 $\\{2,3,5,7\\}$ 组成的因子基。在二次筛选法的框架下，假设获得了以下三个示例关系式：\n(i) $x_{1} = 15$，其中 $x_{1}^{2} - N = 20 = 2^{2} \\cdot 5$，\n(ii) $x_{2} = 17$，其中 $x_{2}^{2} - N = 84 = 2^{2} \\cdot 3 \\cdot 7$，\n(iii) $x_{3} = 25$，其中 $x_{3}^{2} - N = 420 = 2^{2} \\cdot 3 \\cdot 5 \\cdot 7$。\n使用因子基平滑性和在二元有限域（$\\mathbb{F}_{2}$）上的奇偶向量的定义，完成以下任务：\n1. 为这三个关系式构造奇偶向量（坐标按 $2,3,5,7$ 的顺序排列）。\n2. 在这三个向量中，找出在 $\\mathbb{F}_{2}$ 上的一个非平凡线性相关关系。\n3. 利用该相关关系构成一个平方同余式 $X^{2} \\equiv Y^{2} \\pmod{N}$，其中 $X$ 是所选 $x_{i}$ 值的乘积（如果需要，可以用 $-x_{i}$ 替换任何 $x_{i}$），$Y$ 是相应右侧各项乘积的平方根。然后计算最大公约数 $\\gcd(|X - Y|, N)$，该公约数是 $N$ 的一个非平凡因子。\n将你的最终答案表示为单个整数。无需四舍五入，不涉及单位。", "solution": "题目要求我们使用二次筛法分解的原理来找到整数 $N = 205$ 的一个非平凡因子。\n\n### 步骤 1：问题验证\n\n这个问题是数论中的一个标准练习题，展示了二次筛选算法的线性代数阶段。\n**已知条件：**\n- 待分解整数：$N = 205$。\n- 因子基：$B = \\{2, 3, 5, 7\\}$。因子基中的素数按 $(2, 3, 5, 7)$ 排序。\n- 关系式 (i)：$x_{1} = 15$，其中 $x_{1}^{2} - N = 15^{2} - 205 = 225 - 205 = 20$。其素数分解为 $20 = 2^{2} \\cdot 5^{1}$。\n- 关系式 (ii)：$x_{2} = 17$，其中 $x_{2}^{2} - N = 17^{2} - 205 = 289 - 205 = 84$。其素数分解为 $84 = 2^{2} \\cdot 3^{1} \\cdot 7^{1}$。\n- 关系式 (iii)：$x_{3} = 25$，其中 $x_{3}^{2} - N = 25^{2} - 205 = 625 - 205 = 420$。其素数分解为 $420 = 2^{2} \\cdot 3^{1} \\cdot 5^{1} \\cdot 7^{1}$。\n\n**使用提取的已知条件进行验证：**\n该问题：\n- **有科学依据：** 整个问题基于已建立的数论原理，特别是二次筛法。所有计算和前提在数学上都是正确的。\n- **适定性良好：** 问题提供了所有必要的数据和一组清晰的指令，可以得出一个唯一的解。\n- **客观性：** 语言精确，没有任何主观陈述。\n\n该问题被认为是有效的。\n\n### 步骤 2：求解\n\n#### 第 1 部分：构造奇偶向量\n\n对于每个关系式 $x_{i}^{2} - N$，它在因子基 $B = \\{2, 3, 5, 7\\}$ 上是平滑的，我们构造一个奇偶向量 $\\mathbf{v}_{i} \\in \\mathbb{F}_{2}^{4}$。向量的分量是 $x_{i}^{2} - N$ 的因式分解中素数 $(2, 3, 5, 7)$ 的指数模 $2$ 的结果。\n\n对于关系式 (i)，$x_{1}^{2} - N = 20 = 2^{2} \\cdot 3^{0} \\cdot 5^{1} \\cdot 7^{0}$。\n指数向量为 $(2, 0, 1, 0)$。奇偶向量为：\n$$ \\mathbf{v}_{1} = (2 \\pmod 2, 0 \\pmod 2, 1 \\pmod 2, 0 \\pmod 2) = (0, 0, 1, 0) $$\n\n对于关系式 (ii)，$x_{2}^{2} - N = 84 = 2^{2} \\cdot 3^{1} \\cdot 5^{0} \\cdot 7^{1}$。\n指数向量为 $(2, 1, 0, 1)$。奇偶向量为：\n$$ \\mathbf{v}_{2} = (2 \\pmod 2, 1 \\pmod 2, 0 \\pmod 2, 1 \\pmod 2) = (0, 1, 0, 1) $$\n\n对于关系式 (iii)，$x_{3}^{2} - N = 420 = 2^{2} \\cdot 3^{1} \\cdot 5^{1} \\cdot 7^{1}$。\n指数向量为 $(2, 1, 1, 1)$。奇偶向量为：\n$$ \\mathbf{v}_{3} = (2 \\pmod 2, 1 \\pmod 2, 1 \\pmod 2, 1 \\pmod 2) = (0, 1, 1, 1) $$\n\n#### 第 2 部分：找出线性相关关系\n\n我们需要找到 $\\{\\mathbf{v}_{1}, \\mathbf{v}_{2}, \\mathbf{v}_{3}\\}$ 的一个非空子集，其在 $\\mathbb{F}_{2}$ 上的和为零向量 $\\mathbf{0} = (0, 0, 0, 0)$。我们在寻找不全为零的系数 $c_{1}, c_{2}, c_{3} \\in \\{0, 1\\}$，使得 $c_{1}\\mathbf{v}_{1} + c_{2}\\mathbf{v}_{2} + c_{3}\\mathbf{v}_{3} = \\mathbf{0}$。\n通过观察，我们可以发现：\n$$ \\mathbf{v}_{1} + \\mathbf{v}_{2} = (0, 0, 1, 0) + (0, 1, 0, 1) = (0, 1, 1, 1) = \\mathbf{v}_{3} $$\n这意味着存在一个线性相关关系 $\\mathbf{v}_{1} + \\mathbf{v}_{2} - \\mathbf{v}_{3} = \\mathbf{0}$。在 $\\mathbb{F}_{2}$ 中，加法和减法是相同的，所以这等价于：\n$$ \\mathbf{v}_{1} + \\mathbf{v}_{2} + \\mathbf{v}_{3} = \\mathbf{0} $$\n让我们验证这个和：\n$$ (0, 0, 1, 0) + (0, 1, 0, 1) + (0, 1, 1, 1) = (0+0+0, 0+1+1, 1+0+1, 0+1+1) = (0, 2, 2, 2) \\equiv (0, 0, 0, 0) \\pmod 2 $$\n该相关关系涉及所有三个向量，这意味着我们将使用所有三个给定的关系式。\n\n#### 第 3 部分：构造平方同余式并找到一个因子\n\n线性相关关系 $\\mathbf{v}_{1} + \\mathbf{v}_{2} + \\mathbf{v}_{3} = \\mathbf{0}$ 意味着相应的平滑数之积 $(x_{1}^{2}-N)(x_{2}^{2}-N)(x_{3}^{2}-N)$ 是一个完全平方数。\n我们有以下同余式：\n$x_{1}^{2} \\equiv x_{1}^{2} - N \\pmod N \\implies 15^{2} \\equiv 20 \\pmod{205}$\n$x_{2}^{2} \\equiv x_{2}^{2} - N \\pmod N \\implies 17^{2} \\equiv 84 \\pmod{205}$\n$x_{3}^{2} \\equiv x_{3}^{2} - N \\pmod N \\implies 25^{2} \\equiv 420 \\pmod{205}$\n\n将这些同余式相乘得到：\n$$ (x_{1}x_{2}x_{3})^{2} \\equiv (20)(84)(420) \\pmod{205} $$\n这是一个形如 $X^{2} \\equiv Y^{2} \\pmod{N}$ 的同余式。\n我们将 $Y$ 定义为右侧乘积的正整数平方根。\n$$ Y^{2} = 20 \\cdot 84 \\cdot 420 = (2^{2} \\cdot 5) \\cdot (2^{2} \\cdot 3 \\cdot 7) \\cdot (2^{2} \\cdot 3 \\cdot 5 \\cdot 7) = 2^{6} \\cdot 3^{2} \\cdot 5^{2} \\cdot 7^{2} $$\n$$ Y = \\sqrt{2^{6} \\cdot 3^{2} \\cdot 5^{2} \\cdot 7^{2}} = 2^{3} \\cdot 3^{1} \\cdot 5^{1} \\cdot 7^{1} = 8 \\cdot 3 \\cdot 5 \\cdot 7 = 840 $$\n对于左侧，我们对 $X$ 有一个选择。让我们首先计算直接乘积：\n$$ X_{prod} = x_{1}x_{2}x_{3} = 15 \\cdot 17 \\cdot 25 = 6375 $$\n题目允许我们选择 $X$ 为 $X_{prod}$ 或 $-X_{prod}$，因为用 $-x_i$ 替换 $x_i$ 不会改变 $x_i^2$。我们必须选择 $X$ 以便找到一个非平凡因子。题目要求我们计算 $\\gcd(|X - Y|, N)$。\n\n情况 1：$X = X_{prod} = 6375$。\n我们计算 $\\gcd(|6375 - 840|, 205) = \\gcd(5535, 205)$。\n使用欧几里得算法：\n$5535 = 27 \\cdot 205 + 0$。\n因此，$\\gcd(5535, 205) = 205$。这是 $N$ 的一个平凡因子。$X$ 的这个选择未能分解 $N$。\n这个失败是可预见的，因为 $X_{prod} = 6375 \\equiv 20 \\pmod{205}$ 并且 $Y = 840 \\equiv 20 \\pmod{205}$，所以 $X_{prod} \\equiv Y \\pmod{205}$。这意味着 $X_{prod} - Y$ 是 $205$ 的倍数。\n\n情况 2：$X = -X_{prod} = -6375$。\n这对应于选择，例如，$(-x_{1})x_{2}x_{3}$。\n我们计算 $\\gcd(|-6375 - 840|, 205) = \\gcd(|-7215|, 205) = \\gcd(7215, 205)$。\n使用欧几里得算法：\n\\begin{align*} \\gcd(7215, 205) = \\gcd(205, 7215 \\pmod{205}) \\\\ 7215 = 35 \\cdot 205 + 40 \\\\ \\gcd(205, 40) = \\gcd(40, 205 \\pmod{40}) \\\\ 205 = 5 \\cdot 40 + 5 \\\\ \\gcd(40, 5) = \\gcd(5, 40 \\pmod 5) \\\\ 40 = 8 \\cdot 5 + 0 \\\\ \\gcd(5, 0) = 5 \\end{align*}\n最大公约数是 $5$。\n\n这是 $N = 205$ 的一个非平凡因子，因为 $1  5  205$。确实，$205 = 5 \\cdot 41$。\n题目要求计算这个非平凡因子。", "answer": "$$\\boxed{5}$$", "id": "3093030"}, {"introduction": "现在，是时候将所有部分组合起来，完整地执行一次二次筛法算法了。这个综合性练习 [@problem_id:3092961] 将引导你从头到尾对一个具体整数进行分解，涵盖了从定义二次多项式、构建因子基，到筛选平滑数、寻找依赖关系和计算最大公约数以提取因子的全过程。这是检验和巩固你对整个算法流程理解的最佳实践。", "problem": "设 $N$ 是一个合数。二次筛法旨在寻找一个平方同余式 $X^{2} \\equiv Y^{2} \\pmod{N}$，其中 $X \\not\\equiv \\pm Y \\pmod{N}$，然后利用最大公约数提取 $N$ 的一个非平凡因子。一种标准的构造方法是设 $a=\\lfloor \\sqrt{N} \\rfloor$ 和 $Q(x)=(a+x)^{2}-N$，然后搜索 $x$ 的值，使得 $Q(x)$ 能在一个称为因子基的小素数集合上完全分解。然后，利用模 2 的指数奇偶性来确定这些 $Q(x)$ 的一个乘法子集，该子集的乘积是一个完全平方数。\n\n以 $N=589$ 为例。执行以下步骤以获得一个平方同余式并提取 $N$ 的一个因子。\n\n1. 计算 $a=\\lfloor \\sqrt{N} \\rfloor$ 并定义 $Q(x)=(a+x)^{2}-N$。\n2. 取因子基界限 $B=13$。构建因子基 $\\mathcal{F}$，它由 $-1$、素数 $2$ 以及所有满足 $N$ 是模 $p$ 的二次剩余的奇素数 $p \\leq B$ 组成。\n3. 对于每个整数 $x$（$0 \\leq x \\leq 13$），计算 $Q(x)$ 并对其进行因式分解。只保留那些能在 $\\mathcal{F}$ 上完全分解的 $Q(x)$。\n4. 为每个保留的 $Q(x)$ 关联一个在 $\\mathbb{Z}/2\\mathbb{Z}$ 上的奇偶性向量，该向量由因子基元素的有序列表索引，记录了 $Q(x)$ 分解式中每个素数的指数模 2 的值（并通过 $-1$ 的指数包含符号）。找出一个依赖关系，即一个非空子集，其奇偶性向量之和为模 2 的零向量。\n5. 从这样一个子集 $S$ 中，构造 $X=\\prod_{x \\in S}(a+x)$ 和 $Y=\\sqrt{\\prod_{x \\in S}Q(x)}$，并使用 $\\gcd(|X-Y|,N)$ 来提取 $N$ 的一个非平凡因子。\n\n请以整数形式提供 $N$ 的较小素因子作为最终答案。无需四舍五入，也不涉及物理单位。你的最终答案必须是单个整数。", "solution": "目标是使用平方同余原理：如果 $X^{2} \\equiv Y^{2} \\pmod{N}$ 且 $X \\not\\equiv \\pm Y \\pmod{N}$，那么 $\\gcd(|X-Y|,N)$ 会得到 $N$ 的一个非平凡因子。二次筛法通过设置 $a=\\lfloor \\sqrt{N} \\rfloor$ 和 $Q(x)=(a+x)^{2}-N$，然后寻找 $Q(x)$ 值的乘积使其成为一个完全平方数，从而实现了这一原理。\n\n步骤 $1$：计算 $a$ 和 $Q(x)$。对于 $N=589$，$\\sqrt{N}$ 位于 $\\sqrt{576}=24$ 和 $\\sqrt{625}=25$ 之间，因此 $a=\\lfloor \\sqrt{589} \\rfloor=24$。定义 $Q(x)=(24+x)^{2}-589$。\n\n步骤 $2$：构建因子基。取 $B=13$。包括 $-1$ 和 $2$。对于奇素数 $p \\leq 13$，包括那些使 $N$ 成为模 $p$ 的二次剩余的素数。计算剩余：\n- 模 $3$，$589 \\equiv 1$，而 $1$ 是模 $3$ 的平方数，所以包括 $3$。\n- 模 $5$，$589 \\equiv 4$，而 $4$ 是模 $5$ 的平方数，所以包括 $5$。\n- 模 $7$，$589 \\equiv 1$，而 $1$ 是模 $7$ 的平方数，所以包括 $7$。\n- 模 $11$，$589 \\equiv 6$，而 $6$ 不是模 $11$ 的平方数，所以排除 $11$。\n- 模 $13$，$589 \\equiv 4$，而 $4$ 是模 $13$ 的平方数，所以包括 $13$。\n因此因子基是 $\\mathcal{F}=\\{-1,2,3,5,7,13\\}$。\n\n步骤 $3$：对 $0 \\leq x \\leq 13$ 计算 $Q(x)$ 并进行因式分解：\n- $x=0$: $Q(0)=24^{2}-589=576-589=-13=(-1)\\cdot 13$。\n- $x=1$: $Q(1)=25^{2}-589=625-589=36=2^{2}\\cdot 3^{2}$。\n- $x=2$: $Q(2)=26^{2}-589=676-589=87=3\\cdot 29$（不是 $\\mathcal{F}$-光滑数）。\n- $x=3$: $Q(3)=27^{2}-589=729-589=140=2^{2}\\cdot 5\\cdot 7$。\n- $x=4$: $Q(4)=28^{2}-589=784-589=195=3\\cdot 5\\cdot 13$。\n- $x=5$: $Q(5)=29^{2}-589=841-589=252=2^{2}\\cdot 3^{2}\\cdot 7$。\n- $x=6$: $Q(6)=30^{2}-589=900-589=311$（是素数，但不在 $\\mathcal{F}$ 中）。\n- $x=7$: $Q(7)=31^{2}-589=961-589=372=2^{2}\\cdot 3\\cdot 31$（不是 $\\mathcal{F}$-光滑数）。\n- $x=8$: $Q(8)=32^{2}-589=1024-589=435=3\\cdot 5\\cdot 29$（不是 $\\mathcal{F}$-光滑数）。\n- $x=9$: $Q(9)=33^{2}-589=1089-589=500=2^{2}\\cdot 5^{3}$。\n- $x=10$: $Q(10)=34^{2}-589=1156-589=567=3^{4}\\cdot 7$。\n- $x=11$: $Q(11)=35^{2}-589=1225-589=636=2^{2}\\cdot 3\\cdot 53$（不是 $\\mathcal{F}$-光滑数）。\n- $x=12$: $Q(12)=36^{2}-589=1296-589=707=7\\cdot 101$（不是 $\\mathcal{F}$-光滑数）。\n- $x=13$: $Q(13)=37^{2}-589=1369-589=780=2^{2}\\cdot 3\\cdot 5\\cdot 13$。\n$\\mathcal{F}$-光滑值出现在 $x \\in \\{0,1,3,4,5,9,10,13\\}$。\n\n步骤 $4$：针对有序因子基 $\\{-1,2,3,5,7,13\\}$ 构建模 $2$ 的奇偶性向量：\n- $x=0$: $Q(0)=(-1)^{1}\\cdot 13^{1}$ 得到 $[1,0,0,0,0,1]$。\n- $x=1$: $Q(1)=2^{2}\\cdot 3^{2}$ 得到 $[0,0,0,0,0,0]$。\n- $x=3$: $Q(3)=2^{2}\\cdot 5^{1}\\cdot 7^{1}$ 得到 $[0,0,0,1,1,0]$。\n- $x=4$: $Q(4)=3^{1}\\cdot 5^{1}\\cdot 13^{1}$ 得到 $[0,0,1,1,0,1]$。\n- $x=5$: $Q(5)=2^{2}\\cdot 3^{2}\\cdot 7^{1}$ 得到 $[0,0,0,0,1,0]$。\n- $x=9$: $Q(9)=2^{2}\\cdot 5^{3}$ 得到 $[0,0,0,1,0,0]$。\n- $x=10$: $Q(10)=3^{4}\\cdot 7^{1}$ 得到 $[0,0,0,0,1,0]$。\n- $x=13$: $Q(13)=2^{2}\\cdot 3^{1}\\cdot 5^{1}\\cdot 13^{1}$ 得到 $[0,0,1,1,0,1]$。\n\n一个依赖关系是一个非空子集，其奇偶性向量之和为模 2 的零向量。取 $x=4$ 和 $x=13$ 即可获得这样一个依赖关系，因为它们的奇偶性向量是相同的，所以它们的和在模 2 下为零向量。\n\n步骤 $5$：从此子集 $S=\\{4,13\\}$ 构造 $X$ 和 $Y$。计算\n- $X=\\prod_{x \\in S}(a+x)=(24+4)\\cdot(24+13)=28\\cdot 37=1036$。\n- $\\prod_{x \\in S}Q(x)=195\\cdot 780=(3\\cdot 5\\cdot 13)\\cdot(2^{2}\\cdot 3\\cdot 5\\cdot 13)=2^{2}\\cdot 3^{2}\\cdot 5^{2}\\cdot 13^{2}=Y^{2}$，所以 $Y=2\\cdot 3\\cdot 5\\cdot 13=390$。\n于是 $X^{2} \\equiv Y^{2} \\pmod{N}$，我们计算\n$\\gcd(|X-Y|,N)=\\gcd(|1036-390|,589)=\\gcd(646,589)=\\gcd(57,589)=19$，\n并且\n$\\gcd(|X+Y|,N)=\\gcd(1426,589)=\\gcd(248,589)=31$，\n得到因式分解 $589=19\\cdot 31$。较小的素因子是 $19$。", "answer": "$$\\boxed{19}$$", "id": "3092961"}]}