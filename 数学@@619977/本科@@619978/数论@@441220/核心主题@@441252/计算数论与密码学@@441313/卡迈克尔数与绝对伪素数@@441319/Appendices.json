{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方式就是动手实践。让我们从最小也是最著名的卡迈克尔数 $561$ 开始。这个练习将引导你使用数论的基本工具——费马小定理和中国剩余定理——来证明 $561$ 确实是一个卡迈克尔数。通过这个过程，你将深刻理解为什么这类数被称为“绝对伪素数”，因为对于费马素性检验来说，每一个与它互质的底数都是一个“撒谎者”[@problem_id:3082789]。", "problem": "设 $n = 561$。对于模 $n$ 的 Fermat 素性检验，如果 $n$ 是合数，$\\gcd(a,n) = 1$，且 $a^{n-1} \\equiv 1 \\pmod{n}$，则称基数 $a$ 模 $n$ 是一个 Fermat 骗子。一个合数 $n$ 被称为 Carmichael 数（也称为绝对 Fermat 伪素数），如果每个满足 $\\gcd(a,n) = 1$ 的模 $n$ 的剩余类 $a$ 都是 $n$ 的 Fermat 骗子。请仅使用初等数论的基本事实——即 Fermat's little theorem、Euler's theorem 和 Chinese Remainder Theorem (CRT)——通过对其素因子取模来证明 $561$ 是一个 Carmichael 数。然后，计算在 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$（模 $561$ 的单位群）中，作为 $561$ 的 Fermat 骗子的剩余类的比例。请将你的最终答案表示为单个实数。无需四舍五入。", "solution": "问题要求两个结果。第一，证明整数 $n = 561$ 是一个 Carmichael 数。第二，计算在模 $561$ 的单位群（记为 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$）中，作为 $n=561$ 的 Fermat 骗子的剩余类的比例。\n\n一个合数 $n$ 被定义为 Carmichael 数，如果对于每个满足 $\\gcd(a, n) = 1$ 的整数 $a$，同余式 $a^{n-1} \\equiv 1 \\pmod{n}$ 都成立。满足这些条件（$n$ 是合数，$\\gcd(a,n)=1$，以及 $a^{n-1} \\equiv 1 \\pmod{n}$）的元素 $a$ 被称为 Fermat 骗子。\n\n首先，我们证明 $561$ 是一个 Carmichael 数。\n为此，我们必须验证两个条件：\n1.  $n=561$ 是一个合数。\n2.  对于所有满足 $\\gcd(a, 561) = 1$ 的整数 $a$，同余式 $a^{561-1} \\equiv 1 \\pmod{561}$ 都成立。\n\n对于第一个条件，我们求 $561$ 的素数分解。数字 $561$ 可以被 $3$ 整除，因为其各位数字之和 $5+6+1=12$ 可以被 $3$ 整除。我们有 $561 = 3 \\times 187$。为了分解 $187$，我们可以测试小的素数。它不能被 $2, 3, 5, 7$ 整除。下一个素数是 $11$，我们发现 $187 = 11 \\times 17$。因此，$n$ 的素数分解是 $n = 561 = 3 \\times 11 \\times 17$。由于 $561$ 是多个素数的乘积，它是一个合数。\n\n对于第二个条件，我们需要证明对于任何满足 $\\gcd(a, 561) = 1$ 的整数 $a$，$a^{560} \\equiv 1 \\pmod{561}$ 成立。条件 $\\gcd(a, 561) = 1$ 等价于说 $a$ 不是 $3$、$11$ 或 $17$ 的倍数。也就是说，$\\gcd(a, 3) = 1$，$\\gcd(a, 11) = 1$ 且 $\\gcd(a, 17) = 1$。\n\n我们可以使用 Chinese Remainder Theorem (CRT)。同余式 $a^{560} \\equiv 1 \\pmod{561}$ 等价于以下同余方程组：\n$$\n\\begin{cases}\na^{560} \\equiv 1 \\pmod{3} \\\\\na^{560} \\equiv 1 \\pmod{11} \\\\\na^{560} \\equiv 1 \\pmod{17}\n\\end{cases}\n$$\n我们使用 Fermat's Little Theorem (FLT) 分别分析每个同余式。该定理指出，如果 $p$ 是一个素数，那么对于任何不能被 $p$ 整除的整数 $a$，我们有 $a^{p-1} \\equiv 1 \\pmod{p}$。\n\n1.  模 $3$：由于 $\\gcd(a, 3) = 1$，FLT 指出 $a^{3-1} \\equiv a^2 \\equiv 1 \\pmod{3}$。我们目标同余式中的指数是 $560$。我们可以用 $2$ 来表示 $560$：$560 = 2 \\times 280$。因此，\n    $$a^{560} = (a^2)^{280} \\equiv 1^{280} \\equiv 1 \\pmod{3}$$\n    这个同余式对任何不能被 $3$ 整除的 $a$ 都成立。\n\n2.  模 $11$：由于 $\\gcd(a, 11) = 1$，FLT 指出 $a^{11-1} \\equiv a^{10} \\equiv 1 \\pmod{11}$。指数是 $560$。我们用 $10$ 来表示 $560$：$560 = 10 \\times 56$。因此，\n    $$a^{560} = (a^{10})^{56} \\equiv 1^{56} \\equiv 1 \\pmod{11}$$\n    这个同余式对任何不能被 $11$ 整除的 $a$ 都成立。\n\n3.  模 $17$：由于 $\\gcd(a, 17) = 1$，FLT 指出 $a^{17-1} \\equiv a^{16} \\equiv 1 \\pmod{17}$。指数是 $560$。我们用 $16$ 来表示 $560$：$560 = 16 \\times 35$。因此，\n    $$a^{560} = (a^{16})^{35} \\equiv 1^{35} \\equiv 1 \\pmod{17}$$\n    这个同余式对任何不能被 $17$ 整除的 $a$ 都成立。\n\n我们已经证明，对于任何满足 $\\gcd(a, 561) = 1$ 的整数 $a$，同余式 $a^{560} \\equiv 1$ 对模 $3$、$11$ 和 $17$ 都成立。由于 $3$、$11$ 和 $17$ 两两互素，Chinese Remainder Theorem 允许我们得出结论，该同余式对其乘积也必须成立。\n$$a^{560} \\equiv 1 \\pmod{3 \\times 11 \\times 17}$$\n$$a^{560} \\equiv 1 \\pmod{561}$$\n由于 $561$ 是合数且对于所有与 $561$ 互素的整数 $a$ 都有 $a^{561-1} \\equiv 1 \\pmod{561}$，我们便证明了 $561$ 是一个 Carmichael 数。\n\n接下来，我们计算在 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 中，作为 $561$ 的 Fermat 骗子的剩余类的比例。\n单位群 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 是所有满足 $\\gcd(a, 561) = 1$ 的模 $561$ 的剩余类 $a$ 的集合。\n问题将 $n=561$ 的 Fermat 骗子定义为满足 $\\gcd(a, 561) = 1$ 和 $a^{561-1} \\equiv 1 \\pmod{561}$ 的基数 $a$。\n设 $S = \\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 是与 $561$ 互素的剩余类的集合。\n设 $L$ 是 $561$ 的 Fermat 骗子的集合。根据定义，$L$ 的成员必须与 $561$ 互素，因此 $L$ 是 $S$ 中所代表的剩余类的一个子集。\n\n在我们分析的第一部分，我们证明了对于每个满足 $\\gcd(a, 561) = 1$ 的整数 $a$，同余式 $a^{560} \\equiv 1 \\pmod{561}$ 成立。这意味着集合 $S$ 的每个元素都满足成为 Fermat 骗子的条件。\n因此，Fermat 骗子的集合 $L$ 与单位集 $S$ 是相同的。\n$$L = S$$\n问题要求的是 $S$ 中作为 Fermat 骗子的剩余类的比例。这个比例由 Fermat 骗子的数量与单位总数的比值给出：\n$$\\text{比例} = \\frac{|L|}{|S|}$$\n由于 $L=S$，这个比例是：\n$$\\frac{|S|}{|S|} = 1$$\n在 $\\left(\\mathbb{Z}/561\\mathbb{Z}\\right)^{\\times}$ 中，作为 $561$ 的 Fermat 骗子的剩余类的比例是 $1$。这是 $561$ 是一个 Carmichael 数的直接结果。\n\n最终答案应表示为单个实数。这个数字是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3082789"}, {"introduction": "在理解了原型卡迈克尔数 $561$ 的性质后，下一步是掌握识别这些特殊数字的系统方法。本练习为你提供了一个应用科塞尔特判别法（Korselt's criterion）的绝佳机会，你需要用它来检验一个更大的数 $8911$。这个练习旨在巩固你对判别法两个关键条件（无平方因子和整除性）的理解和应用能力[@problem_id:3082779]。", "problem": "如果一个正整数 $n$ 是合数，并且满足相对于其每个素因子的一组整除性条件，则称其为卡迈克尔数（也称为绝对伪素数）。考虑 $n=8911$，其给定的因式分解为 $8911=7\\cdot 19\\cdot 67$。在不重述问题陈述中任何判定定理的情况下，使用卡迈克尔数的适当充要条件来判断 $n$ 是否为卡迈克尔数。\n\n定义指示函数 $C(n)$ 如下：如果 $n$ 是卡迈克尔数，则 $C(n)=1$；否则 $C(n)=0$。计算 $C(8911)$。最终答案只需给出 $C(8911)$ 的值。无需四舍五入，也无需单位。", "solution": "问题要求我们判断整数 $n=8911$ 是否为卡迈克尔数，并基于此判断计算指示函数 $C(8911)$ 的值。问题给出了 $n$ 的素因数分解为 $8911 = 7 \\cdot 19 \\cdot 67$。\n\n一个合数 $n$ 是卡迈克尔数，当且仅当它满足 Korselt 准则。该准则陈述了两个条件：\n1. 数 $n$ 必须是无平方因子数，这意味着它不能被任何素数的平方整除。\n2. 对于 $n$ 的每一个素因子 $p$，整除关系 $(p-1) | (n-1)$ 必须成立。\n\n我们将为 $n=8911$ 系统地验证这些条件。\n\n首先，我们确定 $n$ 是一个合数。给定的因式分解 $n = 7 \\cdot 19 \\cdot 67$ 表明 $n$ 是三个不同素数的乘积。因为它有不止一个素因子，所以 $n$ 是合数。\n\n接下来，我们验证 Korselt 准则的第一个条件：$n$ 必须是无平方因子数。\n$n$ 的素因数分解是 $7^1 \\cdot 19^1 \\cdot 67^1$。每个素因子的指数都为 $1$。因此，$n$ 不能被任何素数的平方整除。这意味着 $n=8911$ 是无平方因子数，满足第一个条件。\n\n现在，我们验证 Korselt 准则的第二个条件。我们必须对 $n=8911$ 的每个素因子 $p$ 检查是否 $(p-1) | (n-1)$。\n$n-1$ 的值是 $8911 - 1 = 8910$。\n$n$ 的素因子是 $p_1 = 7$, $p_2 = 19$ 和 $p_3 = 67$。\n\n对于素因子 $p_1 = 7$：\n我们必须检查是否 $(p_1 - 1) | (n-1)$，即 $6 | 8910$。\n一个数如果能同时被 $2$ 和 $3$ 整除，那么它就能被 $6$ 整除。\n数 $8910$ 是偶数，所以它能被 $2$ 整除。\n$8910$ 的各位数字之和是 $8+9+1+0 = 18$。因为 $18$ 能被 $3$ 整除，所以数 $8910$ 能被 $3$ 整除。\n因为 $8910$ 能同时被 $2$ 和 $3$ 整除，所以它能被 $6$ 整除。计算证实了这一点：$8910 \\div 6 = 1485$。\n因此，该条件对 $p_1 = 7$ 成立。\n\n对于素因子 $p_2 = 19$：\n我们必须检查是否 $(p_2 - 1) | (n-1)$，即 $18 | 8910$。\n一个数如果能同时被 $2$ 和 $9$ 整除，那么它就能被 $18$ 整除。\n我们已经知道 $8910$ 能被 $2$ 整除。\n$8910$ 的各位数字之和是 $18$。因为 $18$ 能被 $9$ 整除，所以数 $8910$ 能被 $9$ 整除。\n因为 $8910$ 能同时被 $2$ 和 $9$ 整除，所以它能被 $18$ 整除。计算证实了这一点：$8910 \\div 18 = 495$。\n因此，该条件对 $p_2 = 19$ 成立。\n\n对于素因子 $p_3 = 67$：\n我们必须检查是否 $(p_3 - 1) | (n-1)$，即 $66 | 8910$。\n一个数如果能同时被 $6$ 和 $11$ 整除，那么它就能被 $66$ 整除，因为 $\\text{gcd}(6, 11)=1$。\n我们已经证明了 $8910$ 能被 $6$ 整除。\n要检查是否能被 $11$ 整除，我们计算 $8910$ 各位数字的交错和：$0 - 1 + 9 - 8 = 0$。由于结果是 $0$，而 $0$ 能被 $11$ 整除，所以数 $8910$ 能被 $11$ 整除。\n因为 $8910$ 能同时被 $6$ 和 $11$ 整除，所以它能被 $66$ 整除。计算证实了这一点：$8910 \\div 66 = 135$。\n因此，该条件对 $p_3 = 67$ 成立。\n\n由于 $n=8911$ 是一个合数、无平方因子数，并且对其所有素因子 $p$，条件 $(p-1) | (n-1)$ 都满足，因此我们得出结论：$n=8911$ 是一个卡迈克尔数。\n\n问题将指示函数 $C(n)$ 定义为：如果 $n$ 是卡迈克尔数，则 $C(n)=1$；否则 $C(n)=0$。由于我们已经证明 $8911$ 是一个卡迈克尔数，所以指示函数的值为 $C(8911)=1$。", "answer": "$$\\boxed{1}$$", "id": "3082779"}, {"introduction": "卡迈克尔数的存在揭示了费马素性检验的局限性，但这并不意味着我们无法有效地识别它们。这个练习回归到数字 $561$，但视角完全不同：它要求你展示更强大的米勒-拉宾（Miller-Rabin）强素性检验如何成功地“识破”$561$ 的伪装。通过找到一个使得检验失败的“证据”底数 $a$，你将亲身体会到现代素性检验算法的精妙之处，并理解为何卡迈克尔数是推动这些算法发展的关键动力[@problem_id:3082805]。", "problem": "令 $n=561$。我们回顾以下标准概念。\n- 一个合数 $n$ 被称为卡迈克尔数（Carmichael number），如果对于所有满足 $\\gcd(a,n)=1$ 的整数 $a$，都有 $a^{n-1}\\equiv 1 \\pmod{n}$。\n- 对于一个奇数 $n>1$，记 $n-1=2^{s}d$，其中 $d$ 为奇数。对于一个满足 $\\gcd(a,n)=1$ 的整数 $a$，如果 $a^{d}\\equiv 1 \\pmod{n}$ 或存在一个整数 $r$ 满足 $0\\le r  s$ 使得 $a^{2^r d}\\equiv -1 \\pmod{n}$，则称 $n$ 是以 $a$ 为底的强可能素数 (strong probable-prime)。\n\n请找到在范围 $2 \\le a \\le 100$ 内、满足 $\\gcd(a,561)=1$ 的最小整数底数 $a$，使得 $n=561$ *未能*通过此强可能素数检验。作为验证，请证明对于你找到的底数 $a$，同余式 $a^{n-1} \\equiv 1 \\pmod n$ 成立。", "solution": "题目要求找到在范围 $2 \\le a \\le 100$ 内、满足 $\\gcd(a, 561)=1$ 的最小整数底数 $a$，使得 $n=561$ 未能通过强可能素数检验。\n\n首先，我们分析给定的数 $n=561$，并确定强可能素数检验所需的参数。$n$ 的素因数分解为 $561 = 3 \\times 11 \\times 17$。这证实了 $n$ 是一个合数。\n\n该检验要求将 $n-1$ 写成 $2^s d$ 的形式，其中 $d$ 是一个奇数。\n我们有 $n-1 = 561-1 = 560$。\n将 $560$ 分解为 $2$ 的幂和一个奇数部分，我们得到 $560 = 16 \\times 35 = 2^4 \\times 35$。\n因此，我们有 $s=4$ 和 $d=35$。\n\n根据所给定义，$n$ 是以 $a$ 为底的强可能素数，需满足以下任一条件：\n1. $a^d \\equiv 1 \\pmod{n}$\n2. 存在一个整数 $r$ 满足 $0 \\le r  s$ 使得 $a^{2^r d} \\equiv -1 \\pmod{n}$。\n\n在我们的具体情况下，当 $n=561$，$d=35$，$s=4$ 时，如果 $a^{35} \\equiv 1 \\pmod{561}$ 或者对于某个 $r \\in \\{0, 1, 2, 3\\}$ 有 $a^{35 \\cdot 2^r} \\equiv -1 \\pmod{561}$，则 $561$ 是以 $a$ 为底的强可能素数。\n\n我们在寻找最小的整数 $a \\ge 2$，使得 $n=561$ *未能通过*此检验。当*同时*满足以下两个条件时，检验失败：\n1. $a^{35} \\not\\equiv 1 \\pmod{561}$\n2. 对于所有的 $r \\in \\{0, 1, 2, 3\\}$，都有 $a^{35 \\cdot 2^r} \\not\\equiv -1 \\pmod{561}$。\n\n我们必须从 $a=2$ 开始，在指定范围内寻找最小的整数 $a$。\n\n我们来测试 $a=2$。首先，检查前提条件 $\\gcd(a, n)=1$。\n因为 $561$ 是奇数，所以 $\\gcd(2, 561) = \\gcd(2, 3 \\times 11 \\times 17) = 1$。因此，$a=2$ 是一个有效的检验底数。\n\n现在，我们对 $n=561$ 和底数 $a=2$ 执行强可能素数检验。我们需要计算序列 $2^{35}$, $2^{70}$, $2^{140}$ 和 $2^{280}$ 模 $561$ 的值。我们将使用中国剩余定理（CRT）进行这些计算，分别对素因数 $3$, $11$ 和 $17$ 取模。\n\n计算 $2^{35} \\pmod{561}$：\n令 $x \\equiv 2^{35} \\pmod{561}$。这等价于以下同余方程组：\n- $x \\equiv 2^{35} \\pmod{3}$。因为 $2 \\equiv -1 \\pmod{3}$，我们有 $2^{35} \\equiv (-1)^{35} \\equiv -1 \\equiv 2 \\pmod{3}$。\n- $x \\equiv 2^{35} \\pmod{11}$。根据费马小定理，$2^{10} \\equiv 1 \\pmod{11}$。所以，$2^{35} = (2^{10})^3 \\cdot 2^5 \\equiv 1^3 \\cdot 32 \\equiv 32 \\equiv 10 \\pmod{11}$。\n- $x \\equiv 2^{35} \\pmod{17}$。根据费马小定理，$2^{16} \\equiv 1 \\pmod{17}$。所以，$2^{35} = (2^{16})^2 \\cdot 2^3 \\equiv 1^2 \\cdot 8 \\equiv 8 \\pmod{17}$。\n\n我们需要解这个方程组：\n$x \\equiv 2 \\pmod{3}$\n$x \\equiv 10 \\pmod{11}$\n$x \\equiv 8 \\pmod{17}$\n\n由 $x \\equiv 10 \\pmod{11}$，我们可以写出 $x = 11k + 10$，其中 $k$ 是某个整数。\n将此代入第一个同余式：$11k + 10 \\equiv 2 \\pmod{3} \\implies 2k + 1 \\equiv 2 \\pmod{3} \\implies 2k \\equiv 1 \\pmod{3}$。两边乘以 $2$，得到 $4k \\equiv 2 \\pmod{3} \\implies k \\equiv 2 \\pmod{3}$。所以，$k = 3j+2$，其中 $j$ 是某个整数。\n代回：$x = 11(3j+2) + 10 = 33j + 22 + 10 = 33j + 32$。\n现在，使用第三个同余式：$33j + 32 \\equiv 8 \\pmod{17} \\implies -j - 2 \\equiv 8 \\pmod{17} \\implies -j \\equiv 10 \\pmod{17} \\implies j \\equiv -10 \\equiv 7 \\pmod{17}$。所以，$j = 17m+7$，其中 $m$ 是某个整数。\n最后，$x = 33(17m+7) + 32 = 561m + 231 + 32 = 561m + 263$。\n因此，$2^{35} \\equiv 263 \\pmod{561}$。\n\n现在我们检查 $a=2$ 时检验失败的条件：\n1. 是否有 $a^d \\equiv 1 \\pmod n$？我们有 $2^{35} \\equiv 263 \\pmod{561}$。这不等于 $1$。所以第一个失败条件已满足。\n2. 我们现在检查当 $r \\in \\{0, 1, 2, 3\\}$ 时序列 $a^{d \\cdot 2^r} \\pmod n$ 的值。\n- 当 $r=0$ 时：$2^{35} \\equiv 263 \\pmod{561}$。这不等于 $-1 \\pmod{561}$（因为 $-1 \\equiv 560$）。\n- 当 $r=1$ 时：$2^{70} = (2^{35})^2 \\equiv 263^2 = 69169 \\pmod{561}$。\n$69169 = 123 \\times 561 + 166$。所以，$2^{70} \\equiv 166 \\pmod{561}$。这不等于 $-1 \\pmod{561}$。\n- 当 $r=2$ 时：$2^{140} = (2^{70})^2 \\equiv 166^2 = 27556 \\pmod{561}$。\n$27556 = 49 \\times 561 + 67$。所以，$2^{140} \\equiv 67 \\pmod{561}$。这不等于 $-1 \\pmod{561}$。\n- 当 $r=3$ 时：$2^{280} = (2^{140})^2 \\equiv 67^2 = 4489 \\pmod{561}$。\n$4489 = 8 \\times 561 + 1$。所以，$2^{280} \\equiv 1 \\pmod{561}$。这不等于 $-1 \\pmod{561}$。\n\n序列 $\\{a^d, a^{2d}, a^{4d}, a^{8d}\\}$ 模 $561$ 的值为 $\\{263, 166, 67, 1\\}$。\n这些值中没有一个与 $-1 \\pmod{561}$ 同余，并且第一项 $a^d$ 不与 $1 \\pmod{561}$ 同余。因此，$n=561$ 未能通过以 $a=2$ 为底的强可能素数检验。\n\n因为我们在寻找满足条件的最小整数 $a \\ge 2$，并且我们已经发现 $a=2$ 符合标准，所以答案是 $2$。\n\n最后，我们执行题目要求的额外验证：对于我们选择的底数 $a=2$，我们必须验证 $a^{560} \\equiv 1 \\pmod{561}$。\n我们有 $a^{n-1} = 2^{560}$。\n指数为 $560 = 2 \\times 280$。使用我们之前的计算：\n$2^{560} = (2^{280})^2 \\equiv 1^2 \\equiv 1 \\pmod{561}$。\n验证成立。这个结果是意料之中的，因为 $n=561$ 是一个卡迈克尔数。根据定义，对于任何满足 $\\gcd(a, n)=1$ 的整数 $a$，同余式 $a^{n-1} \\equiv 1 \\pmod{n}$ 都成立。本题表明，虽然 $n=561$ 通过了以 $2$ 为底的费马检验，但它未能通过更强的米勒-拉宾检验（Miller-Rabin test），后者正确地揭示了它的合数性质。\n\n使 $n=561$ 未能通过强可能素数检验的最小整数底数 $a$ 是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3082805"}]}