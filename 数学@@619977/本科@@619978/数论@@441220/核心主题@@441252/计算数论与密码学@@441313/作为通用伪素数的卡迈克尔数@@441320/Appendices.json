{"hands_on_practices": [{"introduction": "费马小定理是素数判定的一个有力工具，但它并非万无一失。一些合数，被称为伪素数，在特定基下会“伪装”成素数，满足 $a^{n-1} \\equiv 1 \\pmod{n}$。这个练习 [@problem_id:3082957] 将通过著名的例子 $n=341$ 来探索这一现象。你将证明它对于基 $2$ 是一个费马伪素数，但它并非一个卡迈克尔数，从而深刻理解“通用伪素数”这一概念的重要性。", "problem": "设 $n=341$。回顾以下标准定义。一个合数 $n$ 如果满足 $a^{n-1} \\equiv 1 \\pmod{n}$，则称其为以 $a$ 为底的费马伪素数。一个合数 $n$，如果对所有与 $n$ 互素的整数 $a$（即 $\\gcd(a, n)=1$）都满足 $a^{n-1} \\equiv 1 \\pmod{n}$，则称 $n$ 为卡迈克尔数。科塞尔特准则 (Korselt’s criterion) 指出，一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因子的，并且对于每个整除 $n$ 的素数 $p$，都有 $p-1 \\mid n-1$。\n\n从这些定义出发，证明 $n=341$ 是以 $2$ 为底的费马伪素数，但不是卡迈克尔数，然后确定满足 $a^{340} \\equiv 1 \\pmod{341}$ 的模 $341$ 的剩余类 $a$ 的确切数量 $N$。\n\n请将您的最终答案以精确整数 $N$ 的形式给出。", "solution": "本题要求我们分析数字 $n=341$ 关于费马伪素数和卡迈克尔数的性质，然后计算一个特定同余方程的解的个数。我们将系统地处理问题的每个部分。\n\n首先，我们证明 $n=341$ 是以 $2$ 为底的费马伪素数。\n一个数 $n$ 是以 $a$ 为底的费马伪素数，如果它是一个合数且满足 $a^{n-1} \\equiv 1 \\pmod{n}$。\n给定 $n=341$。我们对其进行素因数分解：$341 = 11 \\times 31$。由于 $11$ 和 $31$ 都是素数，所以 $n=341$ 是一个合数。\n接下来，我们必须验证同余式 $2^{341-1} \\equiv 1 \\pmod{341}$，即 $2^{340} \\equiv 1 \\pmod{341}$。我们可以通过检查模素因数 $11$ 和 $31$ 的同余情况，并使用中国剩余定理。\n1. 模 $11$：根据费马小定理，由于 $11$ 是素数且 $\\gcd(2, 11) = 1$，我们有 $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$。指数为 $340 = 10 \\times 34$。因此，\n$$2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$$\n2. 模 $31$：我们可以计算 $2$ 的幂模 $31$ 的值。我们注意到 $2^5 = 32 \\equiv 1 \\pmod{31}$。指数为 $340 = 5 \\times 68$。于是，\n$$2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$$\n由于 $2^{340} \\equiv 1 \\pmod{11}$ 且 $2^{340} \\equiv 1 \\pmod{31}$，并且已知 $\\gcd(11, 31) = 1$，根据中国剩余定理，可得 $2^{340} \\equiv 1 \\pmod{11 \\times 31}$，即 $2^{340} \\equiv 1 \\pmod{341}$。\n因为 $341$ 是合数且满足 $2^{340} \\equiv 1 \\pmod{341}$，所以它是以 $2$ 为底的费马伪素数。\n\n其次，我们证明 $n=341$ 不是一个卡迈克尔数。\n我们使用题目中提供的科塞尔特准则：一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因子的，并且对于每个整除 $n$ 的素数 $p$，$p-1$ 都整除 $n-1$。\n我们来检查 $n=341$ 是否满足这些条件：\n1. $n=341$ 是合数，这点我们已经证明了。\n2. $n=341=11 \\times 31$ 是无平方因子的，因为它的素因数的指数都为 $1$。\n3. 对于 $n$ 的每个素因数 $p$，我们必须检查是否有 $p-1 \\mid n-1$。这里 $n-1 = 340$。\n   - 对于素因数 $p=11$，我们检查 $p-1=10$ 是否整除 $n-1=340$。确实，$340 = 10 \\times 34$，所以 $10 \\mid 340$。这个条件成立。\n   - 对于素因数 $p=31$，我们检查 $p-1=30$ 是否整除 $n-1=340$。我们有 $340 = 11 \\times 30 + 10$。由于余数非零，$30$ 不能整除 $340$。\n由于条件 $p-1 \\mid n-1$ 对素因数 $p=31$ 不成立，根据科塞尔特准则，$n=341$ 不是卡迈克尔数。\n\n第三，我们确定满足 $a^{340} \\equiv 1 \\pmod{341}$ 的模 $341$ 的剩余类 $a$ 的数量 $N$。\n这等价于求多项式同余方程 $x^{340} - 1 \\equiv 0 \\pmod{341}$ 的解的个数。\n利用中国剩余定理，我们可以将其分解为一个同余方程组：\n$$a^{340} \\equiv 1 \\pmod{11}$$\n$$a^{340} \\equiv 1 \\pmod{31}$$\n我们分别求出每个同余方程的解的个数。\n1. 对于 $a^{340} \\equiv 1 \\pmod{11}$：\n   解不能是 $a \\equiv 0 \\pmod{11}$，因为 $0^{340} \\equiv 0 \\not\\equiv 1 \\pmod{11}$。所以，任何解都必须是模 $11$ 整数乘法群 $(\\mathbb{Z}/11\\mathbb{Z})^\\times$ 中的元素，该群的阶为 $\\phi(11) = 10$。\n   根据费马小定理，对于任何满足 $\\gcd(a,11)=1$ 的 $a$，我们有 $a^{10} \\equiv 1 \\pmod{11}$。\n   由于 $340 = 10 \\times 34$，我们有 $a^{340} = (a^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$。\n   这意味着该同余式对 $(\\mathbb{Z}/11\\mathbb{Z})^\\times$ 中所有元素都成立。这些元素的数量是 $\\phi(11) = 10$。因此，模 $11$ 有 $10$ 个解。\n\n2. 对于 $a^{340} \\equiv 1 \\pmod{31}$：\n   类似地，$a \\equiv 0 \\pmod{31}$ 不是一个解。我们在群 $(\\mathbb{Z}/31\\mathbb{Z})^\\times$ 中寻找解，这是一个阶为 $\\phi(31) = 30$ 的循环群。\n   在 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 中，同余方程 $x^k \\equiv 1 \\pmod{p}$ 的解的个数由 $\\gcd(k, p-1)$ 给出。\n   在我们的例子中，$k=340$ 且 $p=31$，所以 $p-1=30$。解的个数是 $\\gcd(340, 30)$。\n   我们计算最大公约数：\n   $340 = 34 \\times 10 = 2 \\times 17 \\times 2 \\times 5 = 2^2 \\times 5 \\times 17$\n   $30 = 3 \\times 10 = 2 \\times 3 \\times 5$\n   $\\gcd(340, 30) = 2^1 \\times 5^1 = 10$。\n   因此，同余式 $a^{340} \\equiv 1 \\pmod{31}$ 有 $10$ 个解。\n\n根据中国剩余定理，对于每一对解 $(r_{11}, r_{31})$（其中 $r_{11}$ 是模 $11$ 的解，$r_{31}$ 是模 $31$ 的解），都存在一个唯一的模 $341$ 的解 $a$。总解数 $N$ 是每个模的解数的乘积。\n$N = (\\text{模 } 11 \\text{ 的解数}) \\times (\\text{模 } 31 \\text{ 的解数}) = 10 \\times 10 = 100$。\n因此，恰好有 $100$ 个模 $341$ 的剩余类 $a$ 满足 $a^{340} \\equiv 1 \\pmod{341}$。", "answer": "$$\\boxed{100}$$", "id": "3082957"}, {"introduction": "在理解了普通伪素数与通用伪素数（即卡迈克尔数）的区别之后，下一个自然的问题是：我们如何找到这些特殊的数？科塞尔特准则是识别和构造卡迈克尔数的关键。这个练习 [@problem_id:3082961] 将引导你完成一个奠基性的任务：利用科塞尔特准则推导出卡迈克尔数的基本结构属性，并系统地找出最小的卡迈克尔数。这不仅是一次计算，更是一次从理论到实践的探索之旅。", "problem": "设 $n$ 是一个合数，且是一个卡迈克尔数，意即对于每个满足 $\\gcd(a, n)=1$ 的整数 $a$，都有 $a^{n-1} \\equiv 1 \\pmod{n}$。已知（Korselt 准则）一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因子数，并且对于每个整除 $n$ 的素数 $p$，都有 $p-1 \\mid n-1$。从这些基础定义和事实出发，确定最小的卡迈克尔数。你的推理必须：\n\n- 根据给定的定义和科塞尔特准则，建立卡迈克尔数的结构性约束（包括奇偶性和素因子个数）。\n- 特别考虑 $n=3qr$（其中 $3  q  r$ 是奇素数），然后系统地搜索最小的数。", "solution": "问题要求通过首先建立结构性质，然后进行系统性搜索，最后验证结果来找到最小的卡迈克尔数。\n\n一个卡迈克尔数 $n$ 是一个合数，使得对于所有满足 $\\gcd(a,n)=1$ 的整数 $a$，都有 $a^{n-1} \\equiv 1 \\pmod{n}$。科塞尔特准则指出，一个合数 $n$ 是卡迈克尔数，当且仅当 $n$ 是无平方因子的，并且对于 $n$ 的每个素因子 $p$，$p-1$ 整除 $n-1$。\n\n**第一步：卡迈克尔数的结构性约束**\n\n设 $n$ 是一个卡迈克尔数。根据科塞尔特准则，$n$ 必须是无平方因子的，这意味着 $n$ 是不同素数的乘积，例如 $n = p_1 p_2 \\cdots p_k$。由于 $n$ 是合数，它必须有至少两个不同的素因子，所以 $k \\ge 2$。\n\n1.  **$n$ 的奇偶性**：我们将证明 $n$ 必须是奇数。为证矛盾，假设 $n$ 是偶数。由于 $n$ 是无平方因子的，它的一个素因子必须是 $2$。设 $p_1=2$。那么 $n = 2 \\cdot p_2 \\cdots p_k$，其中 $p_2, \\dots, p_k$ 是不同的奇素数。由于 $n$ 是偶数，$n-1$ 是奇数。\n    科塞尔特准则要求对于 $n$ 的任意素因子 $p_i$，$p_i-1$ 必须整除 $n-1$。让我们考虑一个奇素因子 $p_i$（其中 $i \\ge 2$）。对于这样的素数，$p_i-1$ 是一个偶数。然而，一个偶数（$p_i-1$）不能整除一个奇数（$n-1$）。这是一个矛盾。因此，最初关于 $n$ 是偶数的假设必定是错误的。所有卡迈克尔数都必须是奇数。\n\n2.  **素因子个数**：我们将证明 $n$ 必须有至少三个素因子。我们已经知道 $n$ 必须是奇数且是合数，所以 $k \\ge 2$。让我们假设 $n$ 恰好有两个素因子，$n=pq$，其中 $p$ 和 $q$ 是不同的奇素数且 $p  q$。\n    根据科塞尔特准则：\n    - $p-1 \\mid pq-1$\n    - $q-1 \\mid pq-1$\n    我们分析第一个条件：$p-1 \\mid pq-1 = p(q-1) + p-1$。这个条件总是成立的，所以它没有提供任何信息。\n    我们分析第二个条件：$q-1 \\mid pq-1 = (p-1)q + q-1$。这也不提供信息。\n    让我们这样分析：$q-1 \\mid pq-1 = p(q-1) + p-1$。由于 $q-1$ 整除 $p(q-1)$，那么 $q-1$ 也必须整除 $p-1$。\n    由于 $p$ 和 $q$ 是正整数且 $p  q$，所以 $p-1  q-1$。一个较大的正整数（$q-1$）不能整除一个较小的正整数（$p-1$）。\n    因此，我们的假设是错误的。一个卡迈克尔数不能只有两个素因子。\n    由于 $k \\ge 2$，且 $k \\neq 2$，我们得出结论 $k \\ge 3$。\n\n因此，一个卡迈克尔数必须是至少三个不同奇素数的乘积。\n\n**第二步：系统性搜索**\n\n我们正在寻找最小的卡迈克尔数。基于我们的发现，这个数必须是三个或更多不同奇素数的乘积。为找到最小的这样的数，我们应该使用最小的奇素数。\n设 $n=pqr$ 形式，其中 $3 \\le p  q  r$ 是奇素数。\n最小的可能选择是 $p=3$。所以，我们寻找 $n=3qr$ 形式的最小卡迈克尔数，其中 $3  q  r$。\n应用科塞尔特准则：\n$p-1 \\mid n-1 \\Rightarrow 2 \\mid 3qr-1$ (这总是成立的，因为 $3qr$ 是奇数)\n$q-1 \\mid n-1 \\Rightarrow q-1 \\mid 3qr-1$\n$r-1 \\mid n-1 \\Rightarrow r-1 \\mid 3qr-1$\n\n让我们分析 $q-1 \\mid 3qr-1$。\n$3qr-1 = 3r(q-1) + 3r-1$。所以，$q-1 \\mid 3r-1$。\n同样，对于 $r-1 \\mid 3qr-1$：\n$3qr-1 = 3q(r-1) + 3q-1$。所以，$r-1 \\mid 3q-1$。\n\n现在我们有一个系统需要解决：\n1. $q-1 \\mid 3r-1$\n2. $r-1 \\mid 3q-1$\n\n我们从最小的可能值 $q=5$ 开始（因为 $q$ 必须是大于 3 的素数）。\n- 如果 $q=5$，我们的条件变为：\n  1. $4 \\mid 3r-1$\n  2. $r-1 \\mid 3(5)-1 = 14$\n  从第二个条件，$r-1$ 必须是 $14$ 的除数，即 $r-1 \\in \\{1, 2, 7, 14\\}$。\n  这给出了 $r \\in \\{2, 3, 8, 15\\}$。\n  $r$ 必须是比 $q=5$ 大的素数。这些值中没有符合条件的。\n\n- 接下来尝试 $q=7$。\n  1. $6 \\mid 3r-1$\n  2. $r-1 \\mid 3(7)-1 = 20$\n  从第二个条件，$r-1 \\in \\{1, 2, 4, 5, 10, 20\\}$。\n  这给出了 $r \\in \\{2, 3, 5, 6, 11, 21\\}$。\n  $r$ 必须是比 $q=7$ 大的素数。只有 $r=11$ 符合条件。\n  现在我们用 $r=11$ 来检验第一个条件：$6 \\mid 3(11)-1 = 32$。$6$ 不能整除 $32$。所以 $(3, 7, 11)$ 不行。\n\n- 接下来尝试 $q=11$。\n  1. $10 \\mid 3r-1$\n  2. $r-1 \\mid 3(11)-1 = 32$\n  从第二个条件，$r-1 \\in \\{1, 2, 4, 8, 16, 32\\}$。\n  这给出了 $r \\in \\{2, 3, 5, 9, 17, 33\\}$。\n  $r$ 必须是比 $q=11$ 大的素数。只有 $r=17$ 符合条件。\n  现在我们用 $r=17$ 来检验第一个条件：$10 \\mid 3(17)-1 = 50$。$10$ 整除 $50$。\n  两个条件都满足了。\n\n**第三步：验证候选数**\n\n我们已经找到了第一个候选数，由素数 $(3, 11, 17)$ 构成。\n$n = 3 \\times 11 \\times 17 = 33 \\times 17 = 561$。\n我们来验证 $n=561$ 是否为卡迈克尔数：\n1.  它是一个合数，并且是无平方因子的。\n2.  $n-1 = 560$。\n3.  $p-1=3-1=2$，且 $2 \\mid 560$。\n4.  $q-1=11-1=10$，且 $10 \\mid 560$。\n5.  $r-1=17-1=16$，且 $560 = 16 \\times 35$，所以 $16 \\mid 560$。\n所有条件都满足。由于我们是按顺序系统搜索的，我们找到了最小的可能组合，因此 $561$ 是最小的卡迈克尔数。", "answer": "$$\\boxed{561}$$", "id": "3082961"}, {"introduction": "掌握了构造最小卡迈克尔数的方法后，下一个关键技能是高效地检验一个给定的数是否满足卡迈克尔数的定义。这个练习 [@problem_id:3082962] 提供了一个更大的数 $n=41041$，并要求你运用科塞尔特准则进行判断。这是一个绝佳的机会，让你在一个更复杂的例子上熟练应用检验步骤，并加深对其中整除条件的理解。", "problem": "令 $n=41041=7\\cdot 11\\cdot 13\\cdot 41$。卡迈克尔数是一个合数的、无平方因子的整数 $n$，对于每一个与 $n$ 互质的整数 $a$（即 $\\gcd(a, n)=1$），都有 $a^{n-1}\\equiv 1 \\pmod n$ 成立，这使得 $n$ 成为一个通用费马伪素数。使用这样一个特征：当且仅当 $n$ 是无平方因子的，并且对于每一个整除 $n$ 的素数 $p$，都有 $p-1 \\mid n-1$ 成立时，$n$ 是卡迈克尔数。请按以下步骤进行：\n\n- 计算集合 $\\{p-1: p\\mid n\\}$ 及其最小公倍数 $L=\\operatorname{lcm}\\{p-1: p\\mid n\\}$。\n- 对于每一个整除 $n$ 的素数 $p$，验证 $p-1 \\mid n-1$ 是否成立，并判断 $n$ 是否为卡迈克尔数。\n- 以精确形式（不进行四舍五入）报告 $L$ 的值作为最终答案。", "solution": "本题要求使用科塞尔特准则（Korselt's criterion）验证 $n=41041$ 是否为卡迈克尔数，并计算一个特定的最小公倍数 $L$。\n\n首先，我们确定给定的信息。整数为 $n=41041$。其素因数分解已给出：$n = 7 \\cdot 11 \\cdot 13 \\cdot 41$。因此，$n$ 的素因数是 $p_1=7, p_2=11, p_3=13, p_4=41$。\n\n科塞尔特准则指出，一个合数 $n$ 是卡迈克尔数，当且仅当满足以下两个条件：\n1. $n$ 是无平方因子的。\n2. 对于 $n$ 的每一个素因数 $p$，整除关系 $p-1 \\mid n-1$ 成立。\n\n让我们来验证 $n=41041$ 是否满足这些条件。\n\n第一个条件：$n$ 是无平方因子的吗？\n$n$ 的素因数分解为 $7^1 \\cdot 11^1 \\cdot 13^1 \\cdot 41^1$。由于所有素因数的指数都为 $1$，所以没有重复的素因数。因此，$n$ 是无平方因子的。此条件满足。同时，由于 $n$ 是四个不同素数的乘积，它显然是一个合数。\n\n第二个条件：对于 $n$ 的所有素因数 $p$，$p-1 \\mid n-1$ 是否成立？\n为了验证这一点，我们首先按要求计算集合 $\\{p-1 : p \\mid n\\}$。\n对于 $p_1=7$，我们有 $p_1-1 = 7-1 = 6$。\n对于 $p_2=11$，我们有 $p_2-1 = 11-1 = 10$。\n对于 $p_3=13$，我们有 $p_3-1 = 13-1 = 12$。\n对于 $p_4=41$，我们有 $p_4-1 = 41-1 = 40$。\n该集合为 $\\{6, 10, 12, 40\\}$。\n\n接下来，我们计算这个集合的最小公倍数，记为 $L$。\n$L = \\operatorname{lcm}(6, 10, 12, 40)$。\n为了求最小公倍数，我们确定集合中每个数的素因数分解：\n$6 = 2 \\cdot 3 = 2^1 \\cdot 3^1$\n$10 = 2 \\cdot 5 = 2^1 \\cdot 5^1$\n$12 = 4 \\cdot 3 = 2^2 \\cdot 3^1$\n$40 = 8 \\cdot 5 = 2^3 \\cdot 5^1$\n最小公倍数是通过取这些分解中每个素因数的最高次幂得到的。这些素因数是 $2, 3, 5$。\n$2$ 的最高次幂是 $2^3$。\n$3$ 的最高次幂是 $3^1$。\n$5$ 的最高次幂是 $5^1$。\n因此，$L = 2^3 \\cdot 3^1 \\cdot 5^1 = 8 \\cdot 3 \\cdot 5 = 120$。\n\n现在我们必须验证对于每个 $p \\in \\{7, 11, 13, 41\\}$，$p-1 \\mid n-1$ 都成立。一个更有效的方法是利用最小公倍数的性质。如果 $L = \\operatorname{lcm}(p_1-1, p_2-1, \\dots, p_k-1)$，那么对于所有 $i$，$p_i-1 \\mid n-1$ 的条件等价于单一条件 $L \\mid n-1$。\n\n我们需要计算 $n-1$：\n$n-1 = 41041 - 1 = 41040$。\n\n然后我们检查 $L \\mid n-1$ 是否成立，也就是说，检查 $120 \\mid 41040$ 是否成立。我们进行除法运算：\n$$ \\frac{41040}{120} = \\frac{4104}{12} $$\n我们可以简化除法：\n$$ \\frac{4104}{12} = \\frac{3600 + 480 + 24}{12} = \\frac{3600}{12} + \\frac{480}{12} + \\frac{24}{12} = 300 + 40 + 2 = 342 $$\n由于除法结果是一个整数 $342$，所以整除条件 $120 \\mid 41040$ 成立。这意味着对于 $n$ 的所有素因数 $p$，$p-1 \\mid n-1$ 都成立。\n\n结论：\n由于 $n=41041$ 是一个无平方因子的合数，且对于每一个整除 $n$ 的素数 $p$，我们已验证 $p-1 \\mid n-1$ 成立，因此科塞尔特准则的两个条件均已满足。所以，$n=41041$ 是一个卡迈克尔数。\n\n本题要求报告 $L$ 的值。如计算所得，$L = 120$。", "answer": "$$\\boxed{120}$$", "id": "3082962"}]}