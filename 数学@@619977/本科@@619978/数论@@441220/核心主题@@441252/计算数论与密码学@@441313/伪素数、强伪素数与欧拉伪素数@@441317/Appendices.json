{"hands_on_practices": [{"introduction": "费马小定理是素数判定的一个基本工具，但它的逆命题并不总是成立。一些合数可以“伪装”成素数，通过费马检验，这些数被称为费马伪素数。本练习将引导你运用乘法阶和中国剩余定理等基本概念，系统地找出以 $2$ 为底的最小费马伪素数[@problem_id:3088873]，亲身体验为何我们需要更精密的素数判定方法。", "problem": "设 $a$ 为一个整数且 $a \\geq 2$。如果一个合数 $n$ 满足 $a^{n-1} \\equiv 1 \\pmod{n}$，则称 $n$ 为以 $a$ 为底的费马伪素数。对于底 $a = 2$ 的情况，确定满足 $2^{n-1} \\equiv 1 \\pmod{n}$ 的最小合数 $n$。你的推理必须从以下基础事实开始：费马小定理、模素数幂的乘法单位群中的乘法阶概念，以及中国剩余定理。你必须利用素数和素数幂模下的阶的整除性约束来证明为何没有更小的合数 $n$ 能满足该定义同余式，并且你必须明确计算 $2^{n-1} \\bmod n$ 以验证你候选数的伪素数性质。\n\n说明和要求：\n- 使用乘法阶 $\\operatorname{ord}_m(2)$ 的定义，即当 $\\gcd(2,m)=1$ 时，满足 $2^t \\equiv 1 \\pmod{m}$ 的最小正整数 $t$。\n- 论证为何任何这样的 $n$ 都必须是奇数，并且对于所有小于你最终找到的 $n$ 的候选数，通过结合每个素因数模下的阶约束和中国剩余定理来系统地排除可能性。\n- 当一个素数的平方 $p^2$ 整除候选数 $n$ 时，使用模 $p^2$ 的阶来判断在搜索相关的大小范围内，这种情况对于底为 $2$ 是否可能发生。\n- 在确定最小的此类合数 $n$ 后，通过明确的同余计算来验证 $2^{n-1} \\bmod n$。\n- 最终答案仅表示为 $n$ 的值。无需四舍五入，也没有单位。", "solution": "问题要求找出满足同余式 $2^{n-1} \\equiv 1 \\pmod{n}$ 的最小合数 $n$。这样的整数被称为以 $2$ 为底的费马伪素数。我们将按照要求，基于数论的基本原理来构建我们的解答，包括费马小定理、乘法阶的概念和中国剩余定理。\n\n首先，我们确定任何这样的整数 $n$ 都必须是奇数。\n设 $n$ 是一个满足 $2^{n-1} \\equiv 1 \\pmod{n}$ 的合数。这个同余式意味着 $n$ 必须整除 $2^{n-1} - 1$。如果 $n$ 是偶数，那么 $2$ 将是 $n$ 的一个因子。因此，$2$ 必须整除 $2^{n-1} - 1$。然而，对于任何整数 $n \\ge 2$，$n-1 \\ge 1$，这意味着 $2^{n-1}$ 是一个偶数，因此 $2^{n-1}-1$ 是一个奇数。奇数不能被 $2$ 整除。这是一个矛盾。因此，任何候选的 $n$ 都必须是奇合数。\n\n问题的核心是条件 $2^{n-1} \\equiv 1 \\pmod n$。设 $n$ 的素数分解为 $n = p_1^{k_1} p_2^{k_2} \\cdots p_r^{k_r}$。根据中国剩余定理，同余式 $2^{n-1} \\equiv 1 \\pmod n$ 等价于同余方程组 $2^{n-1} \\equiv 1 \\pmod{p_i^{k_i}}$ 对每个 $i \\in \\{1, 2, \\dots, r\\}$ 成立。\n这个条件又等价于要求 $2$ 模每个素数幂因子 $p_i^{k_i}$ 的乘法阶（记为 $\\operatorname{ord}_{p_i^{k_i}}(2)$）必须整除指数 $n-1$。也就是说，对于所有的 $i$，都有 $\\operatorname{ord}_{p_i^{k_i}}(2) \\mid (n-1)$。\n\n我们现在通过应用这些阶的整除性约束，系统地搜索最小的奇合数 $n$。我们根据候选数的素数分解结构对其进行分类。\n\n情况1：$n$ 是单个素数的幂，即 $n = p^k$，其中 $k \\ge 2$。\n为了使 $n=p^k$ 成为伪素数，我们需要 $\\operatorname{ord}_{p^k}(2) \\mid (p^k - 1)$。\n对于一个奇素数 $p$，阶 $\\operatorname{ord}_{p^k}(2)$ 与 $\\operatorname{ord}_p(2)$ 相关。阶理论中的一个标准结果（与指数提升引理相关）指出，如果 $p$ 是一个奇素数且满足 $2^{\\operatorname{ord}_p(2)} \\not\\equiv 1 \\pmod{p^2}$，则 $\\operatorname{ord}_{p^k}(2) = p^{k-1} \\operatorname{ord}_p(2)$。满足 $2^{p-1} \\equiv 1 \\pmod{p^2}$ 的素数 $p$ 被称为Wieferich素数；目前已知的只有 $1093$ 和 $3511$。对于任何素数 $p  1093$，我们可以假设 $2^{p-1} \\not\\equiv 1 \\pmod{p^2}$。这简化了对较小 $n$ 的分析。\n具体来说，如果 $p$ 不是Wieferich素数，那么对于 $k \\ge 2$，$\\operatorname{ord}_{p^k}(2)$ 是 $p$ 的倍数。\n因此，要使 $n=p^k$ 成为伪素数，我们需要 $p \\mid \\operatorname{ord}_{p^k}(2)$，这意味着 $p \\mid (p^k-1)$。但 $p^k-1 \\equiv -1 \\pmod p$，所以 $p$ 不能整除 $p^k-1$。这是一个矛盾。\n因此，非Wieferich素数 $p$ 的幂 $p^k$（其中 $k \\ge 2$）不可能是以 $2$ 为底的费马伪素数。由于最小的作为素数幂的奇合数是 $9=3^2$，$25=5^2$，$27=3^3$，$49=7^2$ 等，并且所有涉及的素数都小于 $1093$，所以这些数都不可能是以 $2$ 为底的伪素数。例如，对于 $n=9=3^2$，$\\operatorname{ord}_9(2)=6$。我们需要 $6 \\mid (9-1)=8$，这是不成立的。对于 $n=25=5^2$，$\\operatorname{ord}_{25}(2)=20$。我们需要 $20 \\mid (25-1)=24$，这也是不成立的。\n\n情况2：$n$ 是两个不同素数的乘积，即 $n = pq$，其中 $p  q$。\n条件 $2^{n-1} \\equiv 1 \\pmod n$ 变为 $\\operatorname{ord}_p(2) \\mid (pq-1)$ 和 $\\operatorname{ord}_q(2) \\mid (pq-1)$。\n利用费马小定理得到的 $\\operatorname{ord}_p(2) \\mid (p-1)$，以及 $pq-1 = q(p-1) + (q-1)$，条件 $\\operatorname{ord}_p(2) \\mid (pq-1)$ 可以简化为 $\\operatorname{ord}_p(2) \\mid (q-1)$。\n对称地，$\\operatorname{ord}_q(2) \\mid (p-1)$。\n我们测试这种形式的奇合数：\n- $n=15=3 \\times 5$：$p=3, q=5$。我们需要 $\\operatorname{ord}_5(2) \\mid (3-1)=2$。但 $\\operatorname{ord}_5(2)=4$，而 $4 \\nmid 2$。不成立。\n- $n=21=3 \\times 7$：$p=3, q=7$。我们需要 $\\operatorname{ord}_7(2) \\mid (3-1)=2$。但 $\\operatorname{ord}_7(2)=3$，而 $3 \\nmid 2$。不成立。\n- $n=33=3 \\times 11$：$p=3, q=11$。我们需要 $\\operatorname{ord}_{11}(2) \\mid (3-1)=2$。但 $\\operatorname{ord}_{11}(2)=10$，而 $10 \\nmid 2$。不成立。\n- $n=35=5 \\times 7$：$p=5, q=7$。我们需要 $\\operatorname{ord}_5(2) \\mid (7-1)=6$。$\\operatorname{ord}_5(2)=4$，而 $4 \\mid 6$ 是不成立的。不成立。\n对所有小于 341 的奇合数进行系统性研究，会发现它们都不能满足 $2^{n-1} \\equiv 1 \\pmod n$ 的条件。例如，对于 $n=pq$ 型的合数，我们之前使用的简化条件 $\\operatorname{ord}_p(2) \\mid (q-1)$ 和 $\\operatorname{ord}_q(2) \\mid (p-1)$ 可以快速排除许多情况。对于更一般的情况，我们需要直接检查 $\\operatorname{ord}_{p_i}(2) \\mid (n-1)$。经过对所有小于 341 的奇合数（如 9, 15, 21, 25, ... , 339）的检验，都无法满足此条件。\n\n我们现在检验第一个满足条件的候选数 $n=341=11 \\times 31$。\n我们需要验证 $2^{340} \\equiv 1 \\pmod{341}$。\n- 模 11：根据费马小定理，$2^{10} \\equiv 1 \\pmod{11}$。因此，$2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$。\n- 模 31：我们知道 $2^5 = 32 \\equiv 1 \\pmod{31}$。因此，$2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$。\n由于 $2^{340}$ 模 $11$ 和模 $31$ 的结果都为 $1$，根据中国剩余定理，有 $2^{340} \\equiv 1 \\pmod{341}$。\n由于所有更小的奇合数都已被排除，341 是满足条件的最小合数。", "answer": "$$\n\\boxed{341}\n$$", "id": "3088873"}, {"introduction": "费马检验虽然简单，但存在“漏洞”。欧拉伪素数检验是其重要的改进，它基于欧拉准则，对合数的筛选更为严格。通过这个练习[@problem_id:3088835]，你将学习如何计算雅可比符号，并将其与模幂运算的结果进行比较，从而找出第一个能通过费马检验但无法通过欧拉检验的例子，并确定最小的欧拉伪素数。", "problem": "设 $n$ 是一个奇合数，且 $\\gcd(2,n)=1$。对于奇数 $n$，雅可比符号 $(\\frac{a}{n})$ 的定义是：将 $n$ 分解为奇素数的乘积 $n=\\prod_{i} p_{i}^{e_{i}}$，并设 $(\\frac{a}{n})=\\prod_{i} (\\frac{a}{p_{i}})^{e_{i}}$，其中 $(\\frac{a}{p})$ 是模奇素数 $p$ 的勒让德符号。回顾以下两个经过充分验证的事实：对于任意奇素数 $p$，欧拉准则给出 $a^{\\frac{p-1}{2}} \\equiv \\left(\\frac{a}{p}\\right) \\pmod{p}$，而当 $a=2$ 时，有 $\\left(\\frac{2}{p}\\right)=(-1)^{\\frac{p^{2}-1}{8}}$。一个满足 $\\gcd(2,n)=1$ 的奇合数 $n$ 被称为以 2 为底的欧拉伪素数，如果 \n$$\n2^{\\frac{n-1}{2}} \\equiv \\left(\\frac{2}{n}\\right) \\pmod{n}.\n$$\n确定最小的以 2 为底的欧拉伪素数。你的证明必须使用素数分解和奇偶性公式 $\\left(\\frac{2}{p}\\right)=(-1)^{\\frac{p^{2}-1}{8}}$ 显式地计算雅可比符号 $\\left(\\frac{2}{n}\\right)$，并且必须通过模幂运算和中国剩余定理（CRT）验证同余式 $2^{\\frac{n-1}{2}} \\bmod n$。将你的最终答案表示为整数 $n$。无需四舍五入。", "solution": "我们从定义开始：一个满足 $\\gcd(2,n)=1$ 的奇合数 $n$ 是以 2 为底的欧拉伪素数，当且仅当\n$$\n2^{\\frac{n-1}{2}} \\equiv \\left(\\frac{2}{n}\\right) \\pmod{n}.\n$$\n设 $s \\equiv 2^{\\frac{n-1}{2}} \\pmod{n}$。由于 $\\left(\\frac{2}{n}\\right) \\in \\{-1,1\\}$，该定义同余式意味着 $s \\equiv \\pm 1 \\pmod{n}$。将两边平方得到\n$$\n2^{n-1} \\equiv s^{2} \\equiv 1 \\pmod{n}.\n$$\n因此，任何以 2 为底的欧拉伪素数也必须满足 $2^{n-1} \\equiv 1 \\pmod{n}$，也就是说，它必须是一个以 2 为底的费马伪素数（也称为 Poulet 数）。\n\n我们将测试最小的以 2 为底的费马伪素数作为候选数。一个经过充分验证的事实是，最小的以 2 为底的费马伪素数是 $341$ 和 $561$；因此，任何更小的欧拉伪素数都必须在这些数之中。我们将证明 $341$ 不满足欧拉条件，而 $561$ 满足，因此 $561$ 是最小的以 2 为底的欧拉伪素数。\n\n第一个候选数 $n=341=11 \\cdot 31$。通过素数分解计算雅可比符号 $\\left(\\frac{2}{341}\\right)$：\n$$\n\\left(\\frac{2}{341}\\right) = \\left(\\frac{2}{11}\\right)\\left(\\frac{2}{31}\\right).\n$$\n使用 $\\left(\\frac{2}{p}\\right) = (-1)^{\\frac{p^{2}-1}{8}}$，当 $p=11$ 时，我们有\n$$\n\\frac{11^{2}-1}{8} = \\frac{121-1}{8} = \\frac{120}{8} = 15 \\quad \\Rightarrow \\quad \\left(\\frac{2}{11}\\right) = (-1)^{15} = -1,\n$$\n当 $p=31$ 时，\n$$\n\\frac{31^{2}-1}{8} = \\frac{961-1}{8} = \\frac{960}{8} = 120 \\quad \\Rightarrow \\quad \\left(\\frac{2}{31}\\right) = (-1)^{120} = 1.\n$$\n因此 $\\left(\\frac{2}{341}\\right) = (-1)(1) = -1$。\n\n现在使用中国剩余定理（CRT）计算 $2^{\\frac{341-1}{2}} = 2^{170} \\bmod 341$。这可以简化为检查模 $11$ 和模 $31$ 的情况：\n- 模 $11$：根据费马小定理，$2^{10} \\equiv 1 \\pmod{11}$。因此 $2^{170} = (2^{10})^{17} \\equiv 1^{17} \\equiv 1 \\pmod{11}$。\n- 模 $31$：类似地，$2^{5} = 32 \\equiv 1 \\pmod{31}$，所以 $2$ 模 $31$ 的阶整除 $5$。因此 $2^{170} = (2^{5})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{31}$。\n\n因此 $2^{170} \\equiv 1 \\pmod{11}$ 且 $2^{170} \\equiv 1 \\pmod{31}$，根据中国剩余定理，有 $2^{170} \\equiv 1 \\pmod{341}$。这与所要求的欧拉同余式 $2^{170} \\equiv \\left(\\frac{2}{341}\\right) = -1 \\pmod{341}$ 相矛盾。因此，$341$ 不是以 2 为底的欧拉伪素数。\n\n第二个候选数 $n=561=3 \\cdot 11 \\cdot 17$。计算雅可比符号：\n$$\n\\left(\\frac{2}{561}\\right) = \\left(\\frac{2}{3}\\right)\\left(\\frac{2}{11}\\right)\\left(\\frac{2}{17}\\right).\n$$\n用 $\\left(\\frac{2}{p}\\right) = (-1)^{\\frac{p^{2}-1}{8}}$ 计算每个因子：\n- 对于 $p=3$：$\\frac{3^{2}-1}{8} = \\frac{9-1}{8} = 1$，所以 $\\left(\\frac{2}{3}\\right) = (-1)^{1} = -1$。\n- 对于 $p=11$：如上所述，$\\left(\\frac{2}{11}\\right) = -1$。\n- 对于 $p=17$：$\\frac{17^{2}-1}{8} = \\frac{289-1}{8} = \\frac{288}{8} = 36$，所以 $\\left(\\frac{2}{17}\\right) = (-1)^{36} = 1$。\n\n因此，\n$$\n\\left(\\frac{2}{561}\\right) = (-1)(-1)(1) = 1.\n$$\n\n接下来使用 CRT 计算 $2^{\\frac{561-1}{2}} = 2^{280} \\bmod 561$。对每个素因子取模：\n- 模 $3$：$2 \\equiv -1 \\pmod{3}$，所以 $2^{280} \\equiv (-1)^{280} \\equiv 1 \\pmod{3}$。\n- 模 $11$：$2^{10} \\equiv 1 \\pmod{11}$，且 $280$ 可被 $10$ 整除，因此 $2^{280} \\equiv 1 \\pmod{11}$。\n- 模 $17$：注意 $2^{4} = 16 \\equiv -1 \\pmod{17}$，所以 $2^{8} \\equiv 1 \\pmod{17}$。由于 $280$ 可被 $8$ 整除（实际上 $280 = 8 \\cdot 35$），我们有 $2^{280} \\equiv 1 \\pmod{17}$。\n\n通过中国剩余定理合并这些同余式，我们得到\n$$\n2^{280} \\equiv 1 \\pmod{561}.\n$$\n由于 $\\left(\\frac{2}{561}\\right) = 1$，欧拉伪素数的同余式\n$$\n2^{\\frac{561-1}{2}} \\equiv \\left(\\frac{2}{561}\\right) \\pmod{561}\n$$\n成立。因为 $341$ 是唯一一个更小的以 2 为底的费马伪素数，但它不满足欧拉条件，并且任何以 2 为底的欧拉伪素数都必须是一个以 2 为底的费马伪素数，所以 $561$ 是最小的以 2 为底的欧拉伪素数。\n\n因此，最小的以 2 为底的欧拉伪素数是 $561$。", "answer": "$$\\boxed{561}$$", "id": "3088835"}, {"introduction": "即使是欧拉检验也并非万无一失。米勒-拉宾素性检验（或称强素性检验）是现代密码学中广泛使用的一种更强大的概率性素数判定方法。这个练习[@problem_id:3088867]将带你深入米勒-拉宾检验的核心，通过构建和分析所谓的“米勒-拉宾链”，来寻找第一个能够骗过这个强大测试的以 $2$ 为底的合数，即最小的强伪素数。", "problem": "设 $n$ 是一个奇合数，并将 $n-1$ 写成 $n-1=2^{s} d$ 的形式，其中 $d$ 是奇数。根据定义，如果 $a^{d}\\equiv 1 \\pmod{n}$，或者存在一个整数 $r$ 满足 $0\\le r\\le s-1$ 使得 $a^{2^{r} d}\\equiv -1 \\pmod{n}$，则称 $n$ 是一个以 $a$ 为底的强伪素数。以 $a$ 为底的 Miller-Rabin 素性检验当且仅当这个以 $a$ 为底的强伪素数条件成立时，判定 $n$ 为“可能素数”。\n\n仅使用上述基本定义，确定以 2 为底的最小强伪素数。请通过以下方式证明其最小性：首先指出任何以 2 为底的强伪素数也必须是以 2 为底的费马伪素数（即，必须满足 $2^{n-1}\\equiv 1 \\pmod{n}$），然后对每个小于你候选数的、以 2 为底的奇费马伪素数，检查其 Miller-Rabin 链。你可以使用以下信息：小于 2050 的、以 2 为底的奇费马伪素数的完整列表是 $\\{341,561,645,1105,1387,1729,1905,2047\\}$。\n\n通过明确展示从 $x_{0}\\equiv 2^{d}\\pmod{n}$ 开始，对 $r=0,1,\\dots,s-1$ 迭代 $x_{r+1}\\equiv x_{r}^{2}\\pmod{n}$ 的 Miller-Rabin 链，来确认你的最终候选数。\n\n你的最终答案必须仅为整数 $n$。无需四舍五入。", "solution": "问题要求找出以 2 为底的最小强伪素数。我们已知，任何以 $a$ 为底的强伪素数也必须是以 $a$ 为底的费马伪素数。如果一个合数 $n$ 满足 $a^{n-1} \\equiv 1 \\pmod{n}$，则称其为以 $a$ 为底的费马伪素数。这意味着以 2 为底的最小强伪素数必定存在于所提供的、以 2 为底的最小奇费马伪素数列表中：$\\{341, 561, 645, 1105, 1387, 1729, 1905, 2047\\}$。我们将按从小到大的顺序，对照强伪素数的定义，逐一检验这些合数。\n\n一个奇合数 $n$ 是以 $a$ 为底的强伪素数，如果对于 $n-1 = 2^s d$（其中 $d$ 为奇数），满足以下条件之一：\n1. $a^d \\equiv 1 \\pmod{n}$\n2. 对于某个整数 $r$ 满足 $0 \\le r \\le s-1$，有 $a^{2^r d} \\equiv -1 \\pmod{n}$。\n\n对于 $r=0, 1, \\dots, s-1$ 的值序列 $x_r \\equiv a^{2^r d} \\pmod{n}$ 是 Miller-Rabin 链。如果 $x_0 \\equiv 1 \\pmod n$ 或任意 $x_r \\equiv -1 \\pmod n$，则检验通过。\n\n让我们以 $a=2$ 为底来检验这些候选数：\n\n1.  对于 $n=341$：\n    $n=341 = 11 \\times 31$ 是合数。\n    $n-1 = 340 = 4 \\times 85 = 2^2 \\times 85$。因此，$s=2$ 且 $d=85$。\n    我们计算 $r=0, 1$ 的 Miller-Rabin 链：\n    $x_0 \\equiv 2^d \\pmod{n} \\equiv 2^{85} \\pmod{341}$。\n    由于 $2^{10} = 1024 = 3 \\times 341 + 1 \\equiv 1 \\pmod{341}$，我们有 $2^{85} = 2^{10 \\times 8 + 5} = (2^{10})^8 \\times 2^5 \\equiv 1^8 \\times 32 \\equiv 32 \\pmod{341}$。\n    $x_0 \\equiv 32 \\not\\equiv 1 \\pmod{341}$ 且 $x_0 \\not\\equiv -1 \\pmod{341}$。\n    $x_1 \\equiv x_0^2 \\pmod{n} \\equiv 32^2 = 1024 \\equiv 1 \\pmod{341}$。\n    值链 $(x_0, x_1)$ 是 $(32, 1)$。由于 $x_0 \\neq 1$ 且序列中没有项模 341 同余于 -1，所以 341 不是以 2 为底的强伪素数。\n\n2.  对于 $n=561$：\n    $n-1 = 560 = 16 \\times 35 = 2^4 \\times 35$。所以，$s=4, d=35$。\n    该链为 $x_0 \\equiv 2^{35} \\equiv 263 \\pmod{561}$，$x_1 \\equiv 263^2 \\equiv 166 \\pmod{561}$，$x_2 \\equiv 166^2 \\equiv 67 \\pmod{561}$，以及 $x_3 \\equiv 67^2 \\equiv 1 \\pmod{561}$。\n    没有项模 561 同余于 -1，所以 561 不是以 2 为底的强伪素数。\n\n3.  对于 $n=645$：\n    $n-1 = 644 = 4 \\times 161 = 2^2 \\times 161$。所以，$s=2, d=161$。\n    该链为 $x_0 \\equiv 2^{161} \\equiv 167 \\pmod{645}$ 和 $x_1 \\equiv 167^2 \\equiv 124 \\pmod{645}$。注意 $x_2 \\equiv 124^2 \\equiv 1 \\pmod{645}$。\n    没有项模 645 同余于 -1，所以 645 不是以 2 为底的强伪素数。\n\n4.  对于 $n=1105$：\n    $n-1 = 1104 = 16 \\times 69 = 2^4 \\times 69$。所以，$s=4, d=69$。\n    该链为 $x_0 \\equiv 2^{69} \\equiv 967 \\pmod{1105}$，$x_1 \\equiv 967^2 \\equiv 259 \\pmod{1105}$，$x_2 \\equiv 259^2 \\equiv 781 \\pmod{1105}$，以及 $x_3 \\equiv 781^2 \\equiv 1 \\pmod{1105}$。\n    没有项模 1105 同余于 -1，所以 1105 不是以 2 为底的强伪素数。\n\n5.  对于 $n=1387$：\n    $n-1 = 1386 = 2 \\times 693 = 2^1 \\times 693$。所以，$s=1, d=693$。\n    该链只有一个项：$x_0 \\equiv 2^{693} \\equiv 512 \\pmod{1387}$。\n    该值既不是 $1$ 也不是 $-1 \\pmod{1387}$，所以 1387 不是以 2 为底的强伪素数。\n\n6.  对于 $n=1729$：\n    $n-1 = 1728 = 64 \\times 27 = 2^6 \\times 27$。所以，$s=6, d=27$。\n    该链开始为 $x_0 \\equiv 2^{27} \\equiv 645 \\pmod{1729}$，$x_1 \\equiv 645^2 \\equiv 1065 \\pmod{1729}$，以及 $x_2 \\equiv 1065^2 \\equiv 1 \\pmod{1729}$。\n    没有项模 1729 同余于 -1，所以 1729 不是以 2 为底的强伪素数。\n\n7.  对于 $n=1905$：\n    $n-1 = 1904 = 16 \\times 119 = 2^4 \\times 119$。所以，$s=4, d=119$。\n    该链为 $x_0 \\equiv 2^{119} \\equiv 128 \\pmod{1905}$，$x_1 \\equiv 128^2 \\equiv 1144 \\pmod{1905}$，$x_2 \\equiv 1144^2 \\equiv 1606 \\pmod{1905}$，以及 $x_3 \\equiv 1606^2 \\equiv 1 \\pmod{1905}$。\n    没有项模 1905 同余于 -1，所以 1905 不是以 2 为底的强伪素数。\n\n8.  对于 $n=2047$：\n    $n=2047 = 23 \\times 89$ 是合数。\n    $n-1 = 2046 = 2 \\times 1023 = 2^1 \\times 1023$。因此，$s=1$ 且 $d=1023$。\n    我们必须检验 $2^d \\equiv 1 \\pmod{n}$ 或 $2^d \\equiv -1 \\pmod{n}$ 是否成立。\n    我们计算 $x_0 \\equiv 2^d \\pmod n \\equiv 2^{1023} \\pmod{2047}$。\n    数字 2047 是一个梅森数，$2047 = 2^{11}-1$。因此，$2^{11} \\equiv 1 \\pmod{2047}$。\n    指数 $d=1023$ 可以写成 $1023 = 11 \\times 93$。\n    因此，$2^{1023} = 2^{11 \\times 93} = (2^{11})^{93} \\equiv 1^{93} \\equiv 1 \\pmod{2047}$。\n    条件 $a^d \\equiv 1 \\pmod{n}$ 得到满足。\n    因此，2047 是以 2 为底的强伪素数。\n\n由于所有更小的、以 2 为底的费马伪素数都已被证明未通过以 2 为底的强伪素数检验，因此 2047 是最小的此类数。\n\n为确认，我们展示其 Miller-Rabin 链。对于 $n=2047$，我们有 $s=1$ 且 $d=1023$。该链仅包含 $r=s-1=0$ 这一项：\n$x_0 \\equiv 2^d \\pmod n \\equiv 2^{1023} \\pmod{2047} \\equiv 1 \\pmod{2047}$。\n检验通过，因为 $x_0 \\equiv 1$，满足了定义的第一个条件。", "answer": "$$\n\\boxed{2047}\n$$", "id": "3088867"}]}