{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的情况开始：求解模奇素数幂的同余式 $x^2 \\equiv 1$。这个问题将引导我们通过第一性原理进行推导，核心在于分析 $x^2-1$ 的两个因子 $(x-1)$ 和 $(x+1)$。通过考察这两个因子的最大公约数，我们将揭示为何在这种情况下解的数量是确定的，并为更复杂的问题奠定坚实的基础。[@problem_id:3088927]", "problem": "设 $m$ 是一个正整数，且 $x \\equiv y \\pmod{m}$ 表示 $m$ 整除 $x - y$。考虑二次同余方程 $x^{2} \\equiv 1 \\pmod{169}$，其中 $169 = 13^{2}$ 是奇素数 $13$ 的幂。仅使用模 $m$ 同余的定义、因式分解 $x^{2} - 1 = (x - 1)(x + 1)$ 以及与奇素数相关的整除性的基本性质，确定满足 $x^{2} \\equiv 1 \\pmod{169}$ 的所有模 $169$ 的剩余类，并证明没有其他剩余类是该同余方程的解。将你的最终答案表示为所有解的模 $169$ 的最小非负剩余组成的行矩阵。", "solution": "该问题要求仅使用基本原理来找出二次同余方程 $x^{2} \\equiv 1 \\pmod{169}$ 的所有解。\n\n给定的同余方程是 $x^{2} \\equiv 1 \\pmod{169}$。\n根据同余的定义，$x \\equiv y \\pmod{m}$ 意味着 $m$ 整除 $x-y$，我们记作 $m | (x-y)$。\n将此定义应用于我们的问题，$x^{2} \\equiv 1 \\pmod{169}$ 等价于 $169$ 整除 $x^{2} - 1$ 的陈述。\n$$169 | (x^{2} - 1)$$\n问题中提供了因式分解 $x^{2} - 1 = (x - 1)(x + 1)$。将其代入我们的整除关系中，得到：\n$$169 | (x - 1)(x + 1)$$\n我们还知道模数是 $169 = 13^{2}$，其中 $13$ 是一个奇素数。因此，条件变为：\n$$13^{2} | (x - 1)(x + 1)$$\n这意味着两个整数 $(x-1)$ 和 $(x+1)$ 的乘积必须能被 $13^{2}$ 整除。我们来分析这两个因数的性质。它们之间的差是：\n$$(x + 1) - (x - 1) = 2$$\n设 $d$ 为 $(x-1)$ 和 $(x+1)$ 的最大公约数，记为 $d = \\gcd(x-1, x+1)$。最大公约数的一个基本性质是，它必须能整除这两个数的任何整数线性组合。特别是，它必须能整除它们的差。\n$$d | ((x+1) - (x-1)) \\implies d | 2$$\n由于 $d$ 整除 $2$，所以 $d$ 的可能正数值只有 $1$ 和 $2$。\n我们模数中的素数是 $p=13$。问题明确指出 $13$ 是一个奇素数。由于 $13$ 是奇数，它不能整除 $2$。\n$$13 \\nmid 2$$\n这意味着 $13$ 不可能是 $(x-1)$ 和 $(x+1)$ 的公约数，因为任何公约数都必须整除 $d$，而 $d$ 是 $1$ 或 $2$。因此，$\\gcd(x-1, x+1)$ 不可能是 $13$ 的倍数。\n\n现在我们回到条件 $13^{2} | (x - 1)(x + 1)$。由于 $13$ 是一个素数，欧几里得引理及其推广适用。要使乘积 $(x-1)(x+1)$ 能被 $13^2$ 整除，$13$ 的两个因子必须分布于 $(x-1)$ 和 $(x+1)$ 两项之间。然而，我们刚刚证明了 $13$ 不能同时整除 $(x-1)$ 和 $(x+1)$。这意味着其中一项根本不能被 $13$ 整除。\n因此，整个因子 $13^{2}$ 必须整除单独的一项。这导致了两种互斥的情况：\n\n情况1：整个因子 $13^2$ 整除 $(x-1)$。\n在这种情况下，我们有 $13^{2} | (x-1)$，即 $169 | (x-1)$。\n根据同余的定义，这等价于：\n$$x \\equiv 1 \\pmod{169}$$\n\n情况2：整个因子 $13^2$ 整除 $(x+1)$。\n在这种情况下，我们有 $13^{2} | (x+1)$，即 $169 | (x+1)$。\n根据同余的定义，这等价于：\n$$x \\equiv -1 \\pmod{169}$$\n\n这两种情况涵盖了从初始同余方程和关于奇素数 $13$ 的整除性性质推导出的所有逻辑可能性。因此，我们证明了任何解 $x$ 都必须满足 $x \\equiv 1 \\pmod{169}$ 或 $x \\equiv -1 \\pmod{169}$。\n\n为了找到所有的剩余类，我们确定这些解的最小非负剩余。我们考虑的整数集合是 $\\{0, 1, 2, \\dots, 168\\}$。\n同余式 $x \\equiv 1 \\pmod{169}$ 对应于最小非负剩余 $x = 1$。\n同余式 $x \\equiv -1 \\pmod{169}$ 对应于最小非负剩余 $x = -1 + 169 = 168$。\n\n我们可以验证这些解：\n对于 $x=1$，我们有 $1^{2} = 1$，且 $1 \\equiv 1 \\pmod{169}$，这是正确的。\n对于 $x=168$，我们有 $168 \\equiv -1 \\pmod{169}$。因此，$168^{2} \\equiv (-1)^{2} \\equiv 1 \\pmod{169}$，这也是正确的。\n\n所有解的集合，表示为模 $169$ 的最小非负剩余，是 $\\{1, 168\\}$。问题要求最终答案以行矩阵的形式表示。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  168\n\\end{pmatrix}\n}\n$$", "id": "3088927"}, {"introduction": "在处理模素数幂的二次同余式时，素数 $p=2$ 的情况总是需要特别注意。与奇素数不同，当模为 $2$ 的幂时，同余式 $x^2 \\equiv 1$ 的解的数量会发生变化。本练习将从基本的可除性性质出发，深入探究为何模 $32$ 会出现四个解，从而帮助你理解 $p=2$ 这一特殊情况的内在结构。[@problem_id:3088908]", "problem": "设 $m=2^{5}=32$。仅使用模 $m$ 同余的定义（即 $a \\equiv b \\pmod{m}$ 意味着 $m \\mid (a-b)$）、整数的基本整除性质以及因式分解 $x^{2}-1=(x-1)(x+1)$，求出所有满足 $x^{2} \\equiv 1 \\pmod{32}$ 的余数 $x \\in \\{0,1,\\dots,31\\}$。然后，从基本原理出发，证明模 32 恰好有四个不同的解。将最终答案表示为一个行矩阵，按升序排列所有不同的余数。无需四舍五入，不涉及单位。避免使用高等的分类定理；你的推理应基于基本性质，包括连续整数的最大公约数（GCD）。", "solution": "问题是求出所有满足同余式 $x^{2} \\equiv 1 \\pmod{32}$ 的余数 $x \\in \\{0,1,\\dots,31\\}$。解法必须仅使用基本原理推导得出。\n\n同余式 $x^{2} \\equiv 1 \\pmod{32}$ 根据同余的定义，等价于 $32$ 整除 $x^{2}-1$。我们已知因式分解 $x^{2}-1 = (x-1)(x+1)$。因此，问题转化为求出所有满足 $32 \\mid (x-1)(x+1)$ 的 $x \\in \\{0,1,\\dots,31\\}$。\n\n首先，我们分析 $x$ 的奇偶性。如果 $x$ 是一个偶数，比如说 $x=2k$（其中 $k$ 是某个整数），那么它的平方将是 $x^{2} = (2k)^{2} = 4k^{2}$。表达式 $x^{2}-1$ 将是 $4k^{2}-1$，这是一个奇数。一个偶数（如 32）不能整除一个奇数。因此，任何解 $x$ 都必须是奇数。\n\n由于 $x$ 是奇数，所以 $x-1$ 和 $x+1$ 都是偶数。此外，它们是连续的偶数。设 $x-1 = 2a$ 和 $x+1 = 2b$，其中 $a$ 和 $b$ 是某个整数。\n条件 $32 \\mid (x-1)(x+1)$ 可以改写为 $32 \\mid (2a)(2b)$，化简后为 $32 \\mid 4ab$。将整除关系的两边同时除以 4，我们得到 $8 \\mid ab$。\n\n我们来研究 $a$ 和 $b$ 之间的关系。我们有 $(x+1) - (x-1) = 2$。代入我们对 $x-1$ 和 $x+1$ 的表达式，得到 $2b - 2a = 2$，化简后为 $b-a=1$。这表明 $a$ 和 $b$ 是连续整数。\n\n整数的一个基本性质是，任意两个连续整数都是互质的，即它们的最大公约数为 1。因此，$\\gcd(a, b) = 1$。\n\n我们有条件 $8 \\mid ab$ 以及 $\\gcd(a,b)=1$。8 的质因数分解是 $2^{3}$。由于 $a$ 和 $b$ 互质，它们没有共同的质因数。因此，乘积 $ab$ 中所有的因数 2 必须完全属于 $a$ 或 $b$。这导出了两种互斥的可能性：要么 $8 \\mid a$，要么 $8 \\mid b$。\n如果 8 同时整除 $a$ 和 $b$，那么 $\\gcd(a, b)$ 将至少为 8，这与 $\\gcd(a,b)=1$ 矛盾。所以，这两个条件中必须恰好有一个成立。\n\n我们分别分析这两种情况。\n\n情况 1：$8 \\mid a$。\n如果 8 整除 $a$，我们可以写成 $a = 8k$，其中 $k$ 是某个整数。\n那么，$x-1 = 2a = 2(8k) = 16k$。\n这意味着 $x-1$ 是 16 的倍数，或者说 $x \\equiv 1 \\pmod{16}$。\n我们在集合 $\\{0, 1, \\dots, 31\\}$ 中寻找解 $x$。\n在此范围内满足 $x \\equiv 1 \\pmod{16}$ 的整数是 $x=1$ 和 $x=1+16 = 17$。\n\n我们来验证这些解：\n对于 $x=1$：$1^{2} - 1 = 0$。由于 $32 \\mid 0$，所以 $x=1$ 是一个解。\n对于 $x=17$：$17^{2} - 1 = (17-1)(17+1) = (16)(18) = 16 \\times (2 \\times 9) = 32 \\times 9$。由于 $32 \\mid (32 \\times 9)$，所以 $x=17$ 是一个解。\n\n情况 2：$8 \\mid b$。\n如果 8 整除 $b$，我们可以写成 $b = 8k$，其中 $k$ 是某个整数。\n那么，$x+1 = 2b = 2(8k) = 16k$。\n这意味着 $x+1$ 是 16 的倍数，或者说 $x \\equiv -1 \\pmod{16}$。\n这等价于 $x \\equiv 15 \\pmod{16}$。\n我们在集合 $\\{0, 1, \\dots, 31\\}$ 中寻找解 $x$。\n在此范围内满足 $x \\equiv 15 \\pmod{16}$ 的整数是 $x=15$ 和 $x=15+16 = 31$。\n\n我们来验证这些解：\n对于 $x=15$：$15^{2} - 1 = (15-1)(15+1) = (14)(16) = (7 \\times 2)(16) = 7 \\times 32$。由于 $32 \\mid (7 \\times 32)$，所以 $x=15$ 是一个解。\n对于 $x=31$：$31^{2} - 1 = (31-1)(31+1) = (30)(32)$。由于 $32 \\mid (30 \\times 32)$，所以 $x=31$ 是一个解。\n\n所遵循的逻辑是穷尽的。任何解 $x$ 都必须是奇数，这导致条件 $8 \\mid ab$，其中 $a$ 和 $b$ 是连续整数。这个条件必然要求要么 $8 \\mid a$，要么 $8 \\mid b$。这两种情况是不相交的（一个数不可能同时模 16 余 1 和 -1，因为那将意味着 $1 \\equiv -1 \\pmod{16}$，即 $2 \\equiv 0 \\pmod{16}$，这是错误的）。每种情况在指定范围内恰好产生两个解。因此，模 32 恰好有 $2+2=4$ 个不同的解。\n\n对于 $x \\in \\{0, 1, \\dots, 31\\}$ 的所有解的集合是 $\\{1, 15, 17, 31\\}$。\n按升序排列，我们得到 $1, 15, 17, 31$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  15  17  31\n\\end{pmatrix}\n}\n$$", "id": "3088908"}, {"introduction": "掌握了基本情况后，我们现在转向求解一般的二次同余式 $ax^2+bx+c \\equiv 0 \\pmod{p^k}$。这个问题是本章知识的综合应用，它将引导你完成一个完整的求解流程：首先将问题简化为模素数 $p$ 的情况，然后系统地将解“提升”到模 $p^k$。这个被称为“亨泽尔引理”的强大方法是解决此类问题的核心工具。[@problem_id:3088931]", "problem": "设素数 $p=5$，考虑模 $5^{3}=125$。求满足二次同余方程 $2x^{2}+3x+1 \\equiv 0 \\pmod{125}$ 的所有剩余类 $x \\bmod 125$。你的推导应从同余的定义和标准代数恒等式出发，并应在适当的非退化条件下证明为何模 $5$ 的解可以提升为模 $125$ 的解。将你的最终答案表示为一个包含模 $125$ 的最小非负剩余的单行矩阵。", "solution": "问题是要求解二次同余方程 $2x^{2}+3x+1 \\equiv 0 \\pmod{125}$ 的所有整数解 $x$。模为 $125 = 5^{3}$，其中 $p=5$ 是一个素数。这个问题可以使用将解从模 $p$ 提升到模 $p^k$ 的技巧来解决，这个方法由 Hensel 引理形式化。\n\n设 $f(x) = 2x^{2}+3x+1$。我们寻求 $f(x) \\equiv 0 \\pmod{5^3}$ 的解。过程始于求解模 $p=5$ 的同余方程。\n\n步骤 1：求解模 $5$ 的同余方程。\n我们必须找到所有 $x \\in \\{0, 1, 2, 3, 4\\}$ 使得 $f(x) \\equiv 0 \\pmod{5}$。\n多项式 $f(x)$ 可以在整数上分解为：$2x^2+3x+1 = (2x+1)(x+1)$。\n因此，同余方程变为 $(2x+1)(x+1) \\equiv 0 \\pmod{5}$。\n由于 $5$ 是一个素数，该模是一个素域 $\\mathbb{Z}_5$。在域中，一个乘积为零当且仅当至少有一个因子为零。因此，我们有两种可能性：\n1. $x+1 \\equiv 0 \\pmod{5} \\implies x \\equiv -1 \\equiv 4 \\pmod{5}$。\n2. $2x+1 \\equiv 0 \\pmod{5} \\implies 2x \\equiv -1 \\equiv 4 \\pmod{5}$。为了解出 $x$，我们需要 $2$ 模 $5$ 的乘法逆元。由于 $2 \\cdot 3 = 6 \\equiv 1 \\pmod{5}$，逆元是 $3$。将同余式两边乘以 $3$，我们得到 $3 \\cdot 2x \\equiv 3 \\cdot 4 \\pmod{5}$，化简为 $x \\equiv 12 \\equiv 2 \\pmod{5}$。\n\n因此，模 $5$ 有两个解：$x_0 \\equiv 2 \\pmod{5}$ 和 $x_0' \\equiv 4 \\pmod{5}$。\n\n步骤 2：提升原理 (Hensel 引理)。\n问题要求对提升解进行证明。设 $r$ 是 $f(x) \\equiv 0 \\pmod{p^k}$ (其中 $k \\ge 1$) 的一个解。我们寻求 $f(x) \\equiv 0 \\pmod{p^{k+1}}$ 的一个形式为 $x_{k+1} = r + tp^k$ 的解，其中整数 $t \\in \\{0, 1, \\dots, p-1\\}$。\n根据定义，$f(r) = mp^k$ 对于某个整数 $m$ 成立。我们将 $x$ 的新形式代入同余方程：\n$$f(r+tp^k) \\equiv 0 \\pmod{p^{k+1}}$$\n使用 $f(x)$ 在 $r$ 处的泰勒级数展开：\n$$f(r+tp^k) = f(r) + f'(r)(tp^k) + \\frac{f''(r)}{2}(tp^k)^2 + \\dots$$\n在模 $p^{k+1}$ 下，并且对于 $k \\ge 1$，含有 $(p^k)^2$ 及 $p^k$ 更高次幂的项都同余于 $0$。展开式简化为：\n$$f(r+tp^k) \\equiv f(r) + tp^k f'(r) \\pmod{p^{k+1}}$$\n代入 $f(r) = mp^k$，我们有：\n$$mp^k + tp^k f'(r) \\equiv 0 \\pmod{p^{k+1}}$$\n将整个同余方程除以 $p^k$：\n$$m + t f'(r) \\equiv 0 \\pmod p$$\n这等价于 $t f'(r) \\equiv -m \\pmod p$，或 $t f'(r) \\equiv -\\frac{f(r)}{p^k} \\pmod p$。\n这个关于 $t$ 的线性同余方程有唯一解，当且仅当 $f'(r)$ 存在模 $p$ 的乘法逆元，这又当且仅当 $f'(r) \\not\\equiv 0 \\pmod p$。这就是唯一提升的非退化条件。\n\n步骤 3：验证非退化条件。\n$f(x)$ 的导数是 $f'(x) = 4x+3$。我们在模 $5$ 的基础解上计算它的值。\n对于解 $r_1 = 2$：\n$f'(2) = 4(2)+3 = 11 \\equiv 1 \\pmod{5}$。\n由于 $f'(2) \\not\\equiv 0 \\pmod{5}$，解 $x \\equiv 2 \\pmod{5}$ 是非退化的，并且将唯一地提升为模 $25$ 的解，然后提升为模 $125$ 的解。\n\n对于解 $r_2 = 4$：\n$f'(4) = 4(4)+3 = 19 \\equiv 4 \\pmod{5}$。\n由于 $f'(4) \\not\\equiv 0 \\pmod{5}$，解 $x \\equiv 4 \\pmod{5}$ 也是非退化的，并将唯一地提升。\n\n步骤 4：提升解 $x \\equiv 2 \\pmod{5}$。\n首先，我们从模 $5$ 提升到模 $25$。解的形式为 $x_1 = 2 + 5t$。\n我们必须求解 $t f'(2) \\equiv -\\frac{f(2)}{5} \\pmod 5$。\n$f(2) = 2(2^2)+3(2)+1 = 8+6+1 = 15$。\n$f'(2) \\equiv 1 \\pmod 5$。\n关于 $t$ 的同余方程是 $t \\cdot 1 \\equiv -\\frac{15}{5} \\pmod 5$，即 $t \\equiv -3 \\equiv 2 \\pmod 5$。\n所以，提升后的解是 $x_1 = 2 + 5(2) = 12$。我们现在有 $x \\equiv 12 \\pmod{25}$。\n\n接下来，我们从模 $25$ 提升到模 $125$。解的形式为 $x_2 = 12 + 25t$。\n我们必须求解 $t f'(12) \\equiv -\\frac{f(12)}{25} \\pmod 5$。\n注意 $f'(12) = 4(12)+3 = 51 \\equiv 1 \\pmod 5$，这和预期一样，因为 $12 \\equiv 2 \\pmod 5$。\n$f(12) = 2(12^2)+3(12)+1 = 2(144)+36+1 = 288+37 = 325$。\n关于 $t$ 的同余方程是 $t \\cdot 1 \\equiv -\\frac{325}{25} \\pmod 5$，即 $t \\equiv -13 \\equiv 2 \\pmod 5$。\n所以，提升后的解是 $x_2 = 12 + 25(2) = 12+50 = 62$。\n模 $125$ 的第一个解是 $x \\equiv 62 \\pmod{125}$。\n\n步骤 5：提升解 $x \\equiv 4 \\pmod{5}$。\n首先，我们从模 $5$ 提升到模 $25$。解的形式为 $x_1' = 4 + 5t$。\n我们必须求解 $t f'(4) \\equiv -\\frac{f(4)}{5} \\pmod 5$。\n$f(4) = 2(4^2)+3(4)+1 = 32+12+1 = 45$。\n$f'(4) \\equiv 4 \\pmod 5$。$4$ 模 $5$ 的逆元是 $4$，因为 $4 \\cdot 4=16 \\equiv 1 \\pmod 5$。\n关于 $t$ 的同余方程是 $t \\cdot 4 \\equiv -\\frac{45}{5} \\pmod 5$，即 $4t \\equiv -9 \\equiv 1 \\pmod 5$。\n两边乘以 $4$，我们得到 $t \\equiv 4 \\pmod 5$。\n所以，提升后的解是 $x_1' = 4 + 5(4) = 24$。我们现在有 $x \\equiv 24 \\pmod{25}$。\n\n接下来，我们从模 $25$ 提升到模 $125$。解的形式为 $x_2' = 24 + 25t$。\n我们必须求解 $t f'(24) \\equiv -\\frac{f(24)}{25} \\pmod 5$。\n$f'(24) = 4(24)+3=99 \\equiv 4 \\pmod 5$。\n$f(24) = 2(24^2)+3(24)+1 = 2(576)+72+1 = 1152+73 = 1225$。\n关于 $t$ 的同余方程是 $t \\cdot 4 \\equiv -\\frac{1225}{25} \\pmod 5$，即 $4t \\equiv -49 \\equiv 1 \\pmod 5$。\n这与上一步中关于 $t$ 的同余方程相同，得到 $t \\equiv 4 \\pmod 5$。\n所以，提升后的解是 $x_2' = 24 + 25(4) = 24+100 = 124$。\n模 $125$ 的第二个解是 $x \\equiv 124 \\pmod{125}$。\n\n$2x^{2}+3x+1 \\equiv 0 \\pmod{125}$ 的两个解是 $x \\equiv 62 \\pmod{125}$ 和 $x \\equiv 124 \\pmod{125}$。最小非负剩余是 $62$ 和 $124$。\n我们可以通过注意到 $x=124 \\equiv -1 \\pmod{125}$ 来验证第二个解。\n$f(-1) = 2(-1)^2 + 3(-1) + 1 = 2 - 3 + 1 = 0$，这显然同余于 $0$ 模 $125$。\n对于 $x=62$，我们有 $2(62)+1=125 \\equiv 0 \\pmod{125}$。由于 $2x+1$ 是 $f(x)$ 的一个因子，所以 $f(62)$ 必须是 $125$ 的倍数。\n\n最终的解集是 $\\{62, 124\\}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 62  124 \\end{pmatrix}\n}\n$$", "id": "3088931"}]}