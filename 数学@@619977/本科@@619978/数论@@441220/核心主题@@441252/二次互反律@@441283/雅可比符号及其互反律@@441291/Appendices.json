{"hands_on_practices": [{"introduction": "雅可比符号的真正威力在于其互反律，它使得我们无需分解分母即可高效地进行计算。本练习旨在让你首先基于雅可比符号的各项性质，构建一个完整的计算策略，然后将其应用于一个具体例子。通过这个过程，你将掌握计算任意雅可比符号的标准算法。[@problem_id:3091696]", "problem": "设 $a$ 和 $n$ 是互质的奇正整数。从初等数论的基本原理出发，即根据 $n$ 的素数幂次分解定义的雅可比符号 $\\left(\\frac{a}{n}\\right)$、其乘法性、其分子对 $n$ 取模的不变性、关于 $\\left(\\frac{-1}{n}\\right)$ 和 $\\left(\\frac{2}{n}\\right)$ 的补充定律，以及二次互反律，描述一个逻辑上完备的计算策略，该策略能将任意 $\\left(\\frac{a}{n}\\right)$ 的实例规约到一个由值已知的平凡符号组成的乘积。你的描述应解释在这些基本事实下，为何每个规约步骤都是有效的。\n\n然后，实施你的策略以精确计算具体例子 $\\left(\\frac{12345}{2021}\\right)$。明确展示每个规约步骤和理由，并得出雅可比符号的精确整数值。不需要数值近似；将最终答案报告为单个整数。", "solution": "该问题是有效的，因为它在已建立的数论中有科学依据，提法恰当且客观。它要求描述一个标准算法并加以应用，这是一个形式化且可验证的任务。\n\n本文提出了一种基于所提供原理的、用于计算奇互质正整数 $a$ 和 $n$ 的雅可比符号 $\\left(\\frac{a}{n}\\right)$ 的逻辑完备策略。然后，该策略被用来计算具体例子 $\\left(\\frac{12345}{2021}\\right)$。\n\n**第一部分：雅可比符号的通用计算策略**\n\n设 $a$ 和 $n$ 为互质的奇正整数。我们寻求计算雅可比符号 $\\left(\\frac{a}{n}\\right)$ 的值，该值保证为 $1$ 或 $-1$。该策略是一个算法，它递归地降低符号中参数的复杂性，直到其值可以直接确定。该算法基于以下性质：\n1.  如果 $a \\equiv b \\pmod{n}$，则 $\\left(\\frac{a}{n}\\right) = \\left(\\frac{b}{n}\\right)$。\n2.  $\\left(\\frac{ab}{n}\\right) = \\left(\\frac{a}{n}\\right)\\left(\\frac{b}{n}\\right)$。\n3.  $\\left(\\frac{-1}{n}\\right) = (-1)^{(n-1)/2}$。\n4.  $\\left(\\frac{2}{n}\\right) = (-1)^{(n^2-1)/8}$。\n5.  对于互质的奇正整数 $m$ 和 $n$，有 $\\left(\\frac{m}{n}\\right)\\left(\\frac{n}{m}\\right) = (-1)^{((m-1)/2)((n-1)/2)}$。\n\n当给定一个符号 $\\left(\\frac{k}{m}\\right)$ 进行求值时，计算算法按以下步骤进行：\n\n**步骤 1：规约分子。**\n如果 $k \\ge m$，则用 $k' = k \\pmod{m}$ 替换 $k$。根据性质 (1)，$\\left(\\frac{k}{m}\\right) = \\left(\\frac{k'}{m}\\right)$。此步骤确保分子小于分母。问题规约为计算 $\\left(\\frac{k'}{m}\\right)$。\n\n**步骤 2：处理平凡分子。**\n如果分子 $k$ 变为 $1$，则符号 $\\left(\\frac{1}{m}\\right)$ 根据定义为 $1$，计算的此分支终止。如果分子 $k$ 是一个完全平方数，例如 $k=s^2$，则 $\\left(\\frac{k}{m}\\right) = \\left(\\frac{s^2}{m}\\right) = \\left(\\frac{s}{m}\\right)^2 = 1$，因为 $\\gcd(s, m) = 1$ 保证了 $\\left(\\frac{s}{m}\\right) \\neq 0$。\n\n**步骤 3：分解出 $2$ 的幂次。**\n如果分子 $k$ 是一个偶数，将其写为 $k = 2^s \\cdot t$，其中 $t$ 是奇数且 $s \\ge 1$。使用乘法性质 (2)，我们有：\n$$ \\left(\\frac{k}{m}\\right) = \\left(\\frac{2^s t}{m}\\right) = \\left(\\frac{2}{m}\\right)^s \\left(\\frac{t}{m}\\right) $$\n$\\left(\\frac{2}{m}\\right)$ 的值由补充定律 (4) 确定。如果 $m \\equiv 1, 7 \\pmod{8}$，它为 $1$；如果 $m \\equiv 3, 5 \\pmod{8}$，它为 $-1$。任务随后规约为计算符号 $\\left(\\frac{t}{m}\\right)$，此时其分子为奇数。\n\n**步骤 4：应用二次互反律。**\n如果分子 $k$ 是奇数且 $1  k  m$，则使用性质 (5) 来“翻转”符号：\n$$ \\left(\\frac{k}{m}\\right) = \\left(\\frac{m}{k}\\right) (-1)^{\\frac{k-1}{2} \\frac{m-1}{2}} $$\n符号因子 $(-1)^{\\frac{k-1}{2} \\frac{m-1}{2}}$ 等于 $-1$ 当且仅当 $k$ 和 $m$ 都与 $3 \\pmod{4}$ 同余；否则，它为 $1$。问题现在规约为计算 $\\left(\\frac{m}{k}\\right)$。\n\n**终止性：** 该算法总是会终止。每次应用步骤 4，都将一个符号 $\\left(\\frac{k}{m}\\right)$ 替换为 $\\left(\\frac{m}{k}\\right)$，后者通过步骤 1 规约后变为 $\\left(\\frac{m \\pmod{k}}{k}\\right)$。新的分母 $k$ 严格小于前一个分母 $m$。这产生了一个严格递减的正整数分母序列，该序列最终必然达到 $1$。雅可比符号 $\\left(\\frac{a'}{1}\\right)$ 被定义为 $1$，因此过程停止。最终的值是所有累积的符号因子的乘积。\n\n**第二部分：计算 $\\left(\\frac{12345}{2021}\\right)$**\n\n我们应用所描述的策略来计算 $\\left(\\frac{12345}{2021}\\right)$。整数 $a=12345$ 和 $n=2021$ 是正奇数。$a$ 的素因数分解是 $3 \\cdot 5 \\cdot 823$，$n$ 的素因数分解是 $43 \\cdot 47$。它们互质。\n\n1.  **规约分子：** 由于 $12345 > 2021$，我们求 $12345$ 除以 $2021$ 的余数。\n    $$ 12345 = 6 \\cdot 2021 + 219 $$\n    根据分子对 $n$ 取模的不变性，\n    $$ \\left(\\frac{12345}{2021}\\right) = \\left(\\frac{219}{2021}\\right) $$\n\n2.  **应用二次互反律：** 我们现在有符号 $\\left(\\frac{219}{2021}\\right)$，其中两个整数都是奇数且 $219  2021$。我们使用二次互反律：\n    $$ \\left(\\frac{219}{2021}\\right) = \\left(\\frac{2021}{219}\\right) (-1)^{\\frac{219-1}{2} \\frac{2021-1}{2}} = \\left(\\frac{2021}{219}\\right) (-1)^{109 \\cdot 1010} $$\n    由于指数 $109 \\cdot 1010$ 是偶数，符号因子为 $1$。或者，我们检查这两个整数模 $4$ 的情况。\n    $219 = 4 \\cdot 54 + 3 \\equiv 3 \\pmod{4}$\n    $2021 = 4 \\cdot 505 + 1 \\equiv 1 \\pmod{4}$\n    因为其中只有一个与 $3 \\pmod{4}$ 同余，所以符号因子为 $1$。因此，\n    $$ \\left(\\frac{219}{2021}\\right) = \\left(\\frac{2021}{219}\\right) $$\n\n3.  **规约分子：** 对于 $\\left(\\frac{2021}{219}\\right)$，我们求 $2021$ 除以 $219$ 的余数。\n    $$ 2021 = 9 \\cdot 219 + 50 $$\n    因此，\n    $$ \\left(\\frac{2021}{219}\\right) = \\left(\\frac{50}{219}\\right) $$\n\n4.  **分解分子：** 分子 $50$ 是偶数。我们将其分解为 $50 = 2 \\cdot 25$。使用乘法性质，我们得到：\n    $$ \\left(\\frac{50}{219}\\right) = \\left(\\frac{2 \\cdot 25}{219}\\right) = \\left(\\frac{2}{219}\\right) \\left(\\frac{25}{219}\\right) $$\n    我们分别计算每个符号。\n\n5.  **计算各分量：**\n    -   对于 $\\left(\\frac{2}{219}\\right)$，我们使用补充定律，这取决于 $219 \\pmod{8}$。\n        $$ 219 = 27 \\cdot 8 + 3 \\implies 219 \\equiv 3 \\pmod{8} $$\n        对于一个整数 $n \\equiv 3 \\pmod{8}$，该定律指出 $\\left(\\frac{2}{n}\\right) = -1$。所以，\n        $$ \\left(\\frac{2}{219}\\right) = -1 $$\n    -   对于 $\\left(\\frac{25}{219}\\right)$，分子是一个完全平方数，$25=5^2$。\n        $$ \\left(\\frac{25}{219}\\right) = \\left(\\frac{5^2}{219}\\right) $$\n        因为 $\\gcd(5, 219)=1$（因为 $219 = 3 \\cdot 73$），这个符号的值为 $1$。这可以从乘法性得出，因为 $\\left(\\frac{5^2}{219}\\right) = \\left(\\frac{5}{219}\\right)^2$，而 $1$ 或 $-1$ 的平方都是 $1$。\n        $$ \\left(\\frac{25}{219}\\right) = 1 $$\n\n6.  **合并结果：** 我们将这些值代回到步骤 4 的表达式中。\n    $$ \\left(\\frac{50}{219}\\right) = \\left(\\frac{2}{219}\\right) \\left(\\frac{25}{219}\\right) = (-1)(1) = -1 $$\n\n回顾我们的步骤，我们有：\n$$ \\left(\\frac{12345}{2021}\\right) = \\left(\\frac{219}{2021}\\right) = \\left(\\frac{2021}{219}\\right) = \\left(\\frac{50}{219}\\right) = -1 $$\n雅可比符号的精确整数值为 $-1$。", "answer": "$$\\boxed{-1}$$", "id": "3091696"}, {"introduction": "对于合数分母，勒让德符号与雅可比符号之间存在一个关键区别。当素数 $p$ 满足 $\\left(\\frac{a}{p}\\right)=1$ 时，我们能保证 $a$ 是模 $p$ 的二次剩余，但对于合数 $n$ 这点不再成立。本练习要求你找出一个“伪剩余”，即一个整数 $a$ 使得 $\\left(\\frac{a}{n}\\right)=1$ 但同余方程 $x^2 \\equiv a \\pmod{n}$ 无解，从而帮助你巩固这一至关重要的概念。[@problem_id:3091640]", "problem": "设 $n=77$ 是一个奇合数。仅使用对于奇素数 $p$ 的勒让德符号 $\\left(\\frac{a}{p}\\right)$ 和对于奇数 $n$ 的雅可比符号 $\\left(\\frac{a}{n}\\right)$ 的基本定义，以及公认的二次互反律及其经典的补充定律，求满足 $\\gcd(a,n)=1$ 且 $\\left(\\frac{a}{n}\\right)=1$ 但同余式 $x^{2}\\equiv a \\pmod{n}$ 无解的最小正整数 $a$。通过从第一性原理出发，推导为什么你所选的 $a$ 使得 $\\left(\\frac{a}{n}\\right)=1$ 的同时，又是模 $n$ 的至少一个素因子的二次非剩余，来证明你的选择。你的最终答案必须是单个整数 $a$。", "solution": "我们从核心定义开始。对于一个奇素数 $p$，勒让德符号 $\\left(\\frac{a}{p}\\right)$ 定义为\n$$\n\\left(\\frac{a}{p}\\right)=\n\\begin{cases}\n1  \\text{若 } a \\not\\equiv 0 \\pmod{p} \\text{ 且 } a \\text{ 是模 } p \\text{ 的二次剩余},\\\\\n-1  \\text{若 } a \\text{ 是模 } p \\text{ 的二次非剩余},\\\\\n0  \\text{若 } p \\mid a.\n\\end{cases}\n$$\n对于素数分解为 $n=\\prod_{i=1}^{k}p_{i}^{e_{i}}$ 的奇数 $n$，雅可比符号定义为\n$$\n\\left(\\frac{a}{n}\\right)=\\prod_{i=1}^{k}\\left(\\frac{a}{p_{i}}\\right)^{e_{i}}.\n$$\n当 $n$ 是无平方因子数时，如此处的 $n=77=7\\cdot 11$，这简化为\n$$\n\\left(\\frac{a}{77}\\right)=\\left(\\frac{a}{7}\\right)\\left(\\frac{a}{11}\\right).\n$$\n当 $n$ 是无平方因子数时，$x^{2}\\equiv a \\pmod{n}$ 有解的充要条件是 $a$ 是模 $n$ 的每个素因子的二次剩余。等价地，$x^{2}\\equiv a \\pmod{77}$ 有解当且仅当 $\\left(\\frac{a}{7}\\right)=1$ 且 $\\left(\\frac{a}{11}\\right)=1$。因此，要构造一个满足 $\\left(\\frac{a}{77}\\right)=1$ 但 $x^{2}\\equiv a \\pmod{77}$ 无解的 $a$，只需找到一个 $a$ 使得\n$$\n\\left(\\frac{a}{7}\\right)=-1 \\quad \\text{和} \\quad \\left(\\frac{a}{11}\\right)=-1,\n$$\n因为这样\n$$\n\\left(\\frac{a}{77}\\right)=\\left(\\frac{a}{7}\\right)\\left(\\frac{a}{11}\\right)=(-1)\\cdot(-1)=1,\n$$\n但 $a$ 不是模至少一个素因子（实际上是两个）的二次剩余，这使得 $x^{2}\\equiv a \\pmod{77}$ 无解。\n\n我们将寻找具有此性质的最小正整数 $a$。考虑 $a=6$，其分解为 $6=2\\cdot 3$。我们将通过补充定律和二次互反律来计算 $\\left(\\frac{6}{7}\\right)$ 和 $\\left(\\frac{6}{11}\\right)$。\n\n首先，计算 $\\left(\\frac{6}{7}\\right)=\\left(\\frac{2}{7}\\right)\\left(\\frac{3}{7}\\right)$。\n- 关于 $2$ 的补充定律指出，对于奇素数 $p$，有 $\\left(\\frac{2}{p}\\right)=(-1)^{\\frac{p^{2}-1}{8}}$。对于 $p=7$，\n$$\n\\left(\\frac{2}{7}\\right)=(-1)^{\\frac{7^{2}-1}{8}}=(-1)^{\\frac{49-1}{8}}=(-1)^{6}=1.\n$$\n- 对于 $\\left(\\frac{3}{7}\\right)$，使用二次互反律：对于不同的奇素数 $p$ 和 $q$，\n$$\n\\left(\\frac{p}{q}\\right)\\left(\\frac{q}{p}\\right)=(-1)^{\\frac{p-1}{2}\\cdot\\frac{q-1}{2}}.\n$$\n取 $p=3$ 和 $q=7$，我们得到\n$$\n\\left(\\frac{3}{7}\\right)\\left(\\frac{7}{3}\\right)=(-1)^{\\frac{3-1}{2}\\cdot\\frac{7-1}{2}}=(-1)^{1\\cdot 3}=-1.\n$$\n由于 $7\\equiv 1 \\pmod{3}$，我们有 $\\left(\\frac{7}{3}\\right)=\\left(\\frac{1}{3}\\right)=1$，因此\n$$\n\\left(\\frac{3}{7}\\right)=-1.\n$$\n因此，\n$$\n\\left(\\frac{6}{7}\\right)=\\left(\\frac{2}{7}\\right)\\left(\\frac{3}{7}\\right)=1\\cdot(-1)=-1.\n$$\n\n接下来，计算 $\\left(\\frac{6}{11}\\right)=\\left(\\frac{2}{11}\\right)\\left(\\frac{3}{11}\\right)$。\n- 对于 $\\left(\\frac{2}{11}\\right)$，补充定律给出\n$$\n\\left(\\frac{2}{11}\\right)=(-1)^{\\frac{11^{2}-1}{8}}=(-1)^{\\frac{121-1}{8}}=(-1)^{15}=-1.\n$$\n- 对于 $\\left(\\frac{3}{11}\\right)$，应用二次互反律，取 $p=3$ 和 $q=11$：\n$$\n\\left(\\frac{3}{11}\\right)\\left(\\frac{11}{3}\\right)=(-1)^{\\frac{3-1}{2}\\cdot\\frac{11-1}{2}}=(-1)^{1\\cdot 5}=-1.\n$$\n通过将 $11$ 模 $3$ 约化来计算 $\\left(\\frac{11}{3}\\right)$：由于 $11\\equiv 2 \\pmod{3}$，\n$$\n\\left(\\frac{11}{3}\\right)=\\left(\\frac{2}{3}\\right).\n$$\n模 $3$ 的唯一非零二次剩余是 $1$，所以 $2$ 是一个非剩余，且 $\\left(\\frac{2}{3}\\right)=-1$。因此，\n$$\n\\left(\\frac{3}{11}\\right)=\\frac{-1}{\\left(\\frac{11}{3}\\right)}=\\frac{-1}{-1}=1.\n$$\n所以，\n$$\n\\left(\\frac{6}{11}\\right)=\\left(\\frac{2}{11}\\right)\\left(\\frac{3}{11}\\right)=(-1)\\cdot 1=-1.\n$$\n\n综合这些，我们有\n$$\n\\left(\\frac{6}{77}\\right)=\\left(\\frac{6}{7}\\right)\\left(\\frac{6}{11}\\right)=(-1)\\cdot(-1)=1,\n$$\n并且由于 $\\left(\\frac{6}{7}\\right)=-1$（且 $\\left(\\frac{6}{11}\\right)=-1$），同余式 $x^{2}\\equiv 6 \\pmod{77}$ 无解。\n\n最后，我们通过检查与 $77$ 互质的更小的 $a$ 来验证其最小性：\n- 对于 $a=1$，对任意奇素数 $p$ 都有 $\\left(\\frac{1}{p}\\right)=1$，因此 $\\left(\\frac{1}{77}\\right)=1$ 且 $x^{2}\\equiv 1 \\pmod{77}$ 有解。\n- 对于 $a=2$，$\\left(\\frac{2}{7}\\right)=1$ 且 $\\left(\\frac{2}{11}\\right)=-1$，因此 $\\left(\\frac{2}{77}\\right)=-1$。\n- 对于 $a=3$，$\\left(\\frac{3}{7}\\right)=-1$ 且 $\\left(\\frac{3}{11}\\right)=1$，因此 $\\left(\\frac{3}{77}\\right)=-1$。\n- 对于 $a=4$，注意对任意奇素数 $p$ 都有 $\\left(\\frac{4}{p}\\right)=\\left(\\frac{2}{p}\\right)^{2}=1$，因此 $\\left(\\frac{4}{77}\\right)=1$ 且 $x^{2}\\equiv 4 \\pmod{77}$ 有解。\n- 对于 $a=5$，二次互反律得出 $\\left(\\frac{5}{7}\\right)=-1$ 和 $\\left(\\frac{5}{11}\\right)=1$，所以 $\\left(\\frac{5}{77}\\right)=-1$。\n\n$a\\in\\{1,2,3,4,5\\}$ 中没有一个数满足 $\\left(\\frac{a}{77}\\right)=1$ 且 $x^{2}\\equiv a \\pmod{77}$ 无解。因此，具有所需性质的最小正整数是 $a=6$。", "answer": "$$\\boxed{6}$$", "id": "3091640"}, {"introduction": "对于素数模，欧拉准则在幂运算与勒让德符号之间建立了深刻的联系。一个自然的问题是，这种关系是否可以利用欧拉函数推广到合数模。本练习将引导你通过一个具体的例子来探究这个问题，揭示为何这种推广会失败，并阐明其背后与中国剩余定理相关的深层结构原因。[@problem_id:3091660]", "problem": "设 $n$ 为一个奇正整数，$\\varphi(n)$ 表示欧拉函数，$\\left(\\frac{a}{n}\\right)$ 表示雅可比符号。回顾一下，对于一个奇素数 $p$，勒让德符号 $\\left(\\frac{a}{p}\\right)$ 的定义为：如果 $a$ 是模 $p$ 的二次剩余，则其值为 $1$，否则为 $-1$；而对于素因子分解为 $n=\\prod_{i=1}^{r} p_{i}^{e_{i}}$ 的奇数 $n$，雅可比符号定义为 $\\left(\\frac{a}{n}\\right)=\\prod_{i=1}^{r}\\left(\\frac{a}{p_{i}}\\right)^{e_{i}}$。你的基本工具仅限使用基本定义、中国剩余定理（CRT）以及二次互反律（包括其补充定律）。\n\n考虑特定的合数模 $n=21$ 和底数 $a=2$。\n\n1) 从基本原理出发，通过对素因子取模进行简化，并使用中国剩余定理进行重组，计算 $2^{\\frac{\\varphi(21)}{2}} \\bmod 21$。\n\n2) 计算雅可比符号 $\\left(\\frac{2}{21}\\right)$，方法是将其表示为关于素因子的勒让德符号之积，然后使用二次互反律及其补充定律计算这些勒让德符号的值。\n\n3) 使用你在第1)部分和第2)部分中的计算结果，确定差值\n$$\n2^{\\frac{\\varphi(21)}{2}}-\\left(\\frac{2}{21}\\right)\n$$\n的模 $21$ 的最小非负剩余。\n\n然后，（用文字并基于上述基础）解释为什么对于至少有两个不同素因子的奇合数模 $n$，即使在 $\\gcd(a,n)=1$ 的情况下，也可能出现 $a^{\\frac{\\varphi(n)}{2}} \\not\\equiv \\left(\\frac{a}{n}\\right)\\pmod{n}$ 的情况，并说明指数的结构、中国剩余定理和互反律是如何共同导致这种不一致的。\n\n你最终报告的答案必须是第3)部分中得到的模 $21$ 的单个最小非负剩余。无需四舍五入。", "solution": "该问题是有效的，因为它是初等数论中一个根据既定原则和定义而精心提出的问题。所有必要的信息均已提供，问题没有科学缺陷、歧义或矛盾。\n\n该问题要求进行与模 $n=21$ 和底数 $a=2$ 相关的三项计算，并附上一般性解释。我们将按顺序处理每个部分，仅使用允许的工具：基本定义、中国剩余定理（CRT）以及二次互反律（LQR）及其补充定律。\n\n**1) 计算 $2^{\\frac{\\varphi(21)}{2}} \\bmod 21$**\n\n首先，我们确定 $n=21$ 的欧拉函数 $\\varphi(n)$。$21$ 的素因子分解是 $3 \\times 7$。因为 $\\varphi$ 是一个积性函数，我们有：\n$$\n\\varphi(21) = \\varphi(3) \\times \\varphi(7) = (3-1) \\times (7-1) = 2 \\times 6 = 12\n$$\n表达式中的指数是 $\\frac{\\varphi(21)}{2} = \\frac{12}{2} = 6$。我们需要计算 $2^6 \\pmod{21}$。为此，我们使用中国剩余定理。我们将计算 $2^6$ 模 $21$ 的素因子 $3$ 和 $7$ 的值。\n\n设 $x = 2^6$。我们需要求解同余方程组：\n\\begin{align*}\nx \\equiv 2^6 \\pmod{3} \\\\\nx \\equiv 2^6 \\pmod{7}\n\\end{align*}\n\n对于模 $3$：\n$$\n2 \\equiv -1 \\pmod{3}\n$$\n因此，\n$$\nx \\equiv 2^6 \\equiv (-1)^6 \\equiv 1 \\pmod{3}\n$$\n\n对于模 $7$：\n我们可以直接计算 $2^6$ 或使用费马小定理。$2^3 = 8 \\equiv 1 \\pmod{7}$。因此，\n$$\nx \\equiv 2^6 \\equiv (2^3)^2 \\equiv 1^2 \\equiv 1 \\pmod{7}\n$$\n\n所以，我们需要找到一个整数 $x$ 使得 $x \\equiv 1 \\pmod{3}$ 且 $x \\equiv 1 \\pmod{7}$。通过观察可知，$x=1$ 是一个解。根据中国剩余定理，这个解在模 $\\operatorname{lcm}(3, 7) = 21$ 的意义下是唯一的。\n因此，我们得出结论：\n$$\n2^{\\frac{\\varphi(21)}{2}} \\equiv 1 \\pmod{21}\n$$\n\n**2) 计算雅可比符号 $\\left(\\frac{2}{21}\\right)$**\n\n对于一个奇整数 $n = \\prod_{i=1}^{r} p_i^{e_i}$，雅可比符号 $\\left(\\frac{a}{n}\\right)$ 定义为 $\\left(\\frac{a}{n}\\right) = \\prod_{i=1}^{r} \\left(\\frac{a}{p_i}\\right)^{e_i}$，其中 $\\left(\\frac{a}{p_i}\\right)$ 是勒让德符号。\n对于 $n=21$，其素因子分解是 $21=3 \\times 7$。因此，\n$$\n\\left(\\frac{2}{21}\\right) = \\left(\\frac{2}{3}\\right) \\left(\\frac{2}{7}\\right)\n$$\n我们使用二次互反律的第二补充定律来计算勒让德符号，该定律指出对于任何奇素数 $p$：\n$$\n\\left(\\frac{2}{p}\\right) = (-1)^{\\frac{p^2-1}{8}}\n$$\n\n对于素数 $p=3$：\n$$\n\\left(\\frac{2}{3}\\right) = (-1)^{\\frac{3^2-1}{8}} = (-1)^{\\frac{8}{8}} = (-1)^1 = -1\n$$\n这是因为 $2$ 不是模 $3$ 的二次剩余；二次剩余为 $\\{1^2 \\equiv 1, 2^2 \\equiv 1\\}$。\n\n对于素数 $p=7$：\n$$\n\\left(\\frac{2}{7}\\right) = (-1)^{\\frac{7^2-1}{8}} = (-1)^{\\frac{48}{8}} = (-1)^6 = 1\n$$\n这是因为 $2$ 是模 $7$ 的二次剩余；具体来说，$3^2 = 9 \\equiv 2 \\pmod{7}$。\n\n结合这些结果，我们求得雅可比符号的值：\n$$\n\\left(\\frac{2}{21}\\right) = \\left(\\frac{2}{3}\\right) \\left(\\frac{2}{7}\\right) = (-1) \\times (1) = -1\n$$\n\n**3) 计算差值并解释一般现象**\n\n我们被要求求出差值 $2^{\\frac{\\varphi(21)}{2}} - \\left(\\frac{2}{21}\\right)$ 模 $21$ 的最小非负剩余。\n从第1部分，我们有 $2^{\\frac{\\varphi(21)}{2}} \\equiv 1 \\pmod{21}$。\n从第2部分，我们有 $\\left(\\frac{2}{21}\\right) = -1$。\n代入这些值，我们得到：\n$$\n1 - (-1) = 2\n$$\n模 $21$ 的最小非负剩余是 $2$。\n\n对 $n=21$ 的计算说明了一个普遍原理。对于奇素数模 $p$，欧拉判别法指出，对于任何满足 $\\gcd(a,p)=1$ 的整数 $a$，有 $a^{\\frac{p-1}{2}} \\equiv \\left(\\frac{a}{p}\\right) \\pmod{p}$。然而，这个结论不能直接推广到奇合数模 $n$。\n\n设 $n$ 为一个至少有两个不同素因子的奇合数，比如 $n = p_1 p_2 \\dots p_r$ 其中 $r \\ge 2$。设 $a$ 是一个整数，使得 $\\gcd(a,n)=1$。\n\n我们来分析 $a^{\\frac{\\varphi(n)}{2}} \\pmod n$ 这一项。根据中国剩余定理，我们可以分析这个表达式模 $n$ 的每个素因子 $p_i$ 的情况。指数为\n$$\n\\frac{\\varphi(n)}{2} = \\frac{\\varphi(p_1)\\varphi(p_2)\\dots\\varphi(p_r)}{2} = \\frac{(p_1-1)(p_2-1)\\dots(p_r-1)}{2}\n$$\n对于任意给定的素因子 $p_i$，我们可以将这个指数写成：\n$$\n\\frac{\\varphi(n)}{2} = (p_i-1) \\times \\left( \\frac{1}{2}\\prod_{j \\neq i} (p_j-1) \\right)\n$$\n因为 $n$ 至少有两个不同的素因子（$r \\ge 2$），所以乘积 $\\prod_{j \\neq i} (p_j-1)$ 至少包含一个因子 $(p_j-1)$（对于某个 $j \\neq i$）。由于 $p_j$ 是奇素数，$p_j-1$ 是一个偶数。因此，$K_i = \\frac{1}{2}\\prod_{j \\neq i} (p_j-1)$ 是一个整数。\n所以，对于每一个 $i \\in \\{1, \\dots, r\\}$，指数 $\\frac{\\varphi(n)}{2}$ 都是 $p_i-1$ 的整数倍。\n根据费马小定理，由于 $\\gcd(a,p_i)=1$，我们有 $a^{p_i-1} \\equiv 1 \\pmod{p_i}$。\n因此，对于每个素因子 $p_i$：\n$$\na^{\\frac{\\varphi(n)}{2}} = a^{(p_i-1)K_i} = (a^{p_i-1})^{K_i} \\equiv 1^{K_i} \\equiv 1 \\pmod{p_i}\n$$\n由于 $a^{\\frac{\\varphi(n)}{2}}$ 模 $n$ 的所有素因子都同余于 $1$，中国剩余定理意味着 $a^{\\frac{\\varphi(n)}{2}} \\equiv 1 \\pmod{n}$。\n\n另一方面，雅可比符号 $\\left(\\frac{a}{n}\\right)$ 定义为勒让德符号的乘积 $\\left(\\frac{a}{n}\\right) = \\prod_{i=1}^{r}\\left(\\frac{a}{p_i}\\right)$。每个 $\\left(\\frac{a}{p_i}\\right)$ 的值是 $1$ 或 $-1$。如果因子中有奇数个 $-1$，则乘积可能为 $-1$。这些勒让德符号的值通常使用二次互反律及其补充定律来计算。\n\n不一致性恰好在 $\\left(\\frac{a}{n}\\right) = -1$ 时发生。在这种情况下，我们有 $a^{\\frac{\\varphi(n)}{2}} \\equiv 1 \\pmod n$，但是 $\\left(\\frac{a}{n}\\right)=-1$。因为 $n$ 是一个奇合数，$n > 2$，这意味着 $1 \\not\\equiv -1 \\pmod n$。\n欧拉判别法的直接推广之所以失效，是由于指数 $\\frac{\\varphi(n)}{2}$ 的代数结构。它由 $\\varphi(n)$ 构建而成，这使得它对于每个素因子 $p_i$ 都是模 $p_i$ 的乘法群的阶（即 $p_i-1$）的倍数，从而迫使幂运算的结果为 $1$。相比之下，雅可比符号源于一个不依赖于此指数结构的乘法定义，并且可以很容易地计算出值为 $-1$。对于合数 $n$，中国剩余定理与 $\\varphi(n)$ 结构的结合确保了 $a^{\\frac{\\varphi(n)}{2}} \\equiv 1 \\pmod n$，而决定 $\\left(\\frac{a}{n}\\right)$ 值的互反律允许其值为 $-1$，从而产生了所观察到的不等式。", "answer": "$$\n\\boxed{2}\n$$", "id": "3091660"}]}