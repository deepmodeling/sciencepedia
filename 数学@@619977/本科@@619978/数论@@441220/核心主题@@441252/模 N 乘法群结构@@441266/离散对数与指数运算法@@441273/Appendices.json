{"hands_on_practices": [{"introduction": "离散对数理论的基石是本原根的存在，它如同对数中的“底数”，能够生成整个乘法群。在着手解决离散对数问题之前，首要任务是确认我们选择的基数是否具备这一资格。这个练习 [@problem_id:3084338] 将指导你通过一个标准而有效的方法——利用群阶的素因子分解，来检验一个候选数是否为模素数下的本原根，这是后续所有索引运算的根本前提。", "problem": "设素数 $p=229$，并考虑模 $p$ 的单位乘法群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$。仅利用以下基本事实：$(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 是一个阶为 $p-1$ 的有限群，且根据拉格朗日定理，任何元素的阶都整除群的阶；通过分析 $p-1$ 的素因子分解并检验必要的阶，确定候选数 $g=6$ 是否是模 $p$ 的原根。然后，推导出 $g$ 模 $p$ 的确切乘法阶，记为 $\\operatorname{ord}_{p}(g)$。请將最终答案以单个整数的形式给出。", "solution": "本题要求判断整数 $g=6$ 是否为素数 $p=229$ 模下的原根，并求出其乘法阶 $\\operatorname{ord}_{p}(g)$。模素数 $p$ 的原根是乘法群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 中的一个元素 $g$，其阶等于群本身的阶。群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的阶由欧拉总计函数 $\\phi(p)$ 给出，对于素数 $p$，该函数值等于 $p-1$。\n\n在本题中，$p=229$，因此群的阶为 $p-1 = 229-1 = 228$。\n要使 $g=6$ 成为模 $229$ 的原根，其阶必须是 $228$。即 $\\operatorname{ord}_{229}(6)$ 必须为 $228$。\n\n检验一个元素 $g$ 是否为模 $p$ 的原根的一个标准判据依赖于 $p-1$ 的素因子分解。设 $p-1$ 的素因子分解为 $p-1 = q_1^{a_1} q_2^{a_2} \\cdots q_k^{a_k}$。一个元素 $g$ 是模 $p$ 的原根，当且仅当对于 $p-1$ 的所有不同素因子 $q_i$，以下条件成立：\n$$g^{\\frac{p-1}{q_i}} \\not\\equiv 1 \\pmod{p}$$\n这是因为如果 $g$ 的阶是 $p-1$ 的一个真因子，那么它必然整除 $\\frac{p-1}{q_i}$ 中的至少一个数。\n\n首先，我们求 $p-1 = 228$ 的素因子分解：\n$$228 = 2 \\times 114 = 2^2 \\times 57 = 2^2 \\times 3 \\times 19$$\n$228$ 的不同素因子是 $q_1=2$，$q_2=3$ 和 $q_3=19$。\n\n我们现在必须对 $g=6$ 和 $p=229$ 检验这三个条件：\n1. 检验 $6^{\\frac{228}{2}} \\pmod{229} \\not\\equiv 1 \\pmod{229}$ 是否成立。即 $6^{114} \\pmod{229}$。\n2. 检验 $6^{\\frac{228}{3}} \\pmod{229} \\not\\equiv 1 \\pmod{229}$ 是否成立。即 $6^{76} \\pmod{229}$。\n3. 检验 $6^{\\frac{228}{19}} \\pmod{229} \\not\\equiv 1 \\pmod{229}$ 是否成立。即 $6^{12} \\pmod{229}$。\n\n我们将使用模幂运算（即重复平方求幂法）来计算这些幂。\n\n$6^{12} \\pmod{229}$ 的计算：\n$6^1 \\equiv 6 \\pmod{229}$\n$6^2 \\equiv 36 \\pmod{229}$\n$6^4 \\equiv 36^2 = 1296 \\pmod{229}$。因为 $1296 = 5 \\times 229 + 151$，所以我们有 $6^4 \\equiv 151 \\pmod{229}$。\n$6^8 \\equiv 151^2 = 22801 \\pmod{229}$。因为 $22801 = 99 \\times 229 + 130$，所以我们有 $6^8 \\equiv 130 \\pmod{229}$。\n现在我们计算 $6^{12} = 6^{8+4} = 6^8 \\times 6^4$：\n$6^{12} \\equiv 130 \\times 151 = 19630 \\pmod{229}$。因为 $19630 = 85 \\times 229 + 165$，我们有：\n$$6^{12} \\equiv 165 \\pmod{229}$$\n因为 $165 \\not\\equiv 1 \\pmod{229}$，所以第三个条件满足。\n\n$6^{76} \\pmod{229}$ 的计算：\n我们从之前的结果继续进行平方运算：\n$6^{16} \\equiv 130^2 = 16900 \\pmod{229}$。因为 $16900 = 73 \\times 229 + 183$，所以我们有 $6^{16} \\equiv 183 \\pmod{229}$。\n$6^{32} \\equiv 183^2 = 33489 \\pmod{229}$。因为 $33489 = 146 \\times 229 + 55$，所以我们有 $6^{32} \\equiv 55 \\pmod{229}$。\n$6^{64} \\equiv 55^2 = 3025 \\pmod{229}$。因为 $3025 = 13 \\times 229 + 48$，所以我们有 $6^{64} \\equiv 48 \\pmod{229}$。\n指数 $76$ 的二进制展开是 $64 + 8 + 4$。所以，$6^{76} = 6^{64} \\times 6^8 \\times 6^4$：\n$6^{76} \\equiv 48 \\times 130 \\times 151 \\pmod{229}$。\n首先，$48 \\times 130 = 6240$。$6240 = 27 \\times 229 + 57$，所以 $48 \\times 130 \\equiv 57 \\pmod{229}$。\n然后，$57 \\times 151 = 8607$。$8607 = 37 \\times 229 + 144$，所以：\n$$6^{76} \\equiv 144 \\pmod{229}$$\n因为 $144 \\not\\equiv 1 \\pmod{229}$，所以第二个条件满足。\n\n$6^{114} \\pmod{229}$ 的计算：\n指数 $114$ 的二进制展开是 $64 + 32 + 16 + 2$。所以，$6^{114} = 6^{64} \\times 6^{32} \\times 6^{16} \\times 6^2$：\n$6^{114} \\equiv 48 \\times 55 \\times 183 \\times 36 \\pmod{229}$。\n首先，$48 \\times 55 = 2640$。$2640 = 11 \\times 229 + 121$，所以 $48 \\times 55 \\equiv 121 \\pmod{229}$。\n接着，$121 \\times 183 = 22143$。$22143 = 96 \\times 229 + 159$，所以 $121 \\times 183 \\equiv 159 \\pmod{229}$。\n最后，$159 \\times 36 = 5724$。$5724 = 24 \\times 229 + 228$，所以：\n$$6^{114} \\equiv 228 \\pmod{229}$$\n注意到 $228 \\equiv -1 \\pmod{229}$。因为 $228 \\not\\equiv 1 \\pmod{229}$，所以第一个条件满足。\n\n所有三个条件都已满足：\n$6^{228/2} \\equiv 228 \\not\\equiv 1 \\pmod{229}$\n$6^{228/3} \\equiv 144 \\not\\equiv 1 \\pmod{229}$\n$6^{228/19} \\equiv 165 \\not\\equiv 1 \\pmod{229}$\n\n因此，候选数 $g=6$ 确实是模 $p=229$ 的原根。\n\n问题要求的是 $g$ 模 $p$ 的确切乘法阶，记为 $\\operatorname{ord}_{p}(g)$。根据原根的定义，它的阶就是群的阶，即 $p-1$。\n因此，$6$ 模 $229$ 的阶是 $p-1 = 228$。\n$$\\operatorname{ord}_{229}(6) = 228$$", "answer": "$$\\boxed{228}$$", "id": "3084338"}, {"introduction": "一旦确定了本原根 $g$，我们就可以定义以 $g$ 为底的离散对数，并利用其强大的代数性质。本练习 [@problem_id:3084339] 旨在让你亲手验证离散对数的核心法则——索引算术，即群内的乘除运算如何转化为指数的加减运算。通过具体计算，你将深刻体会到离散对数如何将复杂的乘法结构映射为简单的线性关系，这正是其在数论和密码学中应用广泛的原因。", "problem": "考虑一个素数模 $p$ 和模 $p$ 的乘法单位群，记作 $\\mathbb{F}_{p}^{\\times}$。这个群是阶为 $p-1$ 的循环群。$\\mathbb{F}_{p}^{\\times}$ 的一个生成元 $g$ 被称为模 $p$ 的原根；对于这样的 $g$，每个 $x \\in \\mathbb{F}_{p}^{\\times}$ 都可以唯一地写成 $x \\equiv g^{k} \\pmod{p}$ 的形式，其中 $k$ 是一个满足 $0 \\leq k \\leq p-2$ 的整数。以 $g$ 为底、模 $p$ 的 $x$ 的离散对数，记作 $\\log_{g}(x)$，是满足 $g^{k} \\equiv x \\pmod{p}$ 的唯一整数 $k \\in \\{0,1,\\dots,p-2\\}$。指数运算指的是利用 $\\mathbb{F}_{p}^{\\times}$ 的结构来操作这些指数。\n\n令 $p=29$ 且 $g=2$，它是模 $29$ 的一个原根。令 $a=5$, $b=7$, $c=3$ 为 $\\mathbb{F}_{29}^{\\times}$ 中的元素。从 $\\mathbb{F}_{29}^{\\times}$ 的循环群结构和离散对数的定义出发，确定 $\\log_{g}\\!\\left(\\frac{ab}{c}\\right)$ 模 $p-1$ 的值，并分别计算 $\\log_{g}(a)$、$\\log_{g}(b)$ 和 $\\log_{g}(c)$ 模 $p-1$ 的值。将 $\\log_{g}\\!\\left(\\frac{ab}{c}\\right)$ 的值与由群结构证明的、单独计算的对数组合进行比较，并以 $\\{0,1,\\dots,p-2\\}$ 中单个整数的形式报告 $\\log_{g}\\!\\left(\\frac{ab}{c}\\right)$ 的值。无需舍入。", "solution": "乘法群 $\\mathbb{F}_{p}^{\\times}$ 是一个阶为 $p-1$ 的循环群。如果 $g$ 是模 $p$ 的一个原根，那么每个 $x \\in \\mathbb{F}_{p}^{\\times}$ 都可以写成 $x \\equiv g^{k} \\pmod{p}$ 的形式，其中 $k \\in \\{0,1,\\dots,p-2\\}$。离散对数 $\\log_{g}(x)$ 由 $g^{\\log_{g}(x)} \\equiv x \\pmod{p}$ 定义。循环结构意味着 $g$ 的指数上的算术对应于 $\\mathbb{F}_{p}^{\\times}$ 中的乘法，并且由于 $g^{p-1} \\equiv 1 \\pmod{p}$，指数是在模 $p-1$ 的意义下进行的。\n\n根据这些原理，如果 $x \\equiv g^{u}$ 且 $y \\equiv g^{v}$，那么 $xy \\equiv g^{u} g^{v} \\equiv g^{u+v} \\pmod{p}$，因此 $\\log_{g}(xy) \\equiv u+v \\equiv \\log_{g}(x) + \\log_{g}(y) \\pmod{p-1}$。同样地，$x^{-1} \\equiv g^{-u} \\pmod{p}$ 意味着 $\\log_{g}(x^{-1}) \\equiv -u \\equiv -\\log_{g}(x) \\pmod{p-1}$。因此，对于 $x,y,z \\in \\mathbb{F}_{p}^{\\times}$，我们有\n$$\n\\log_{g}\\!\\left(\\frac{xy}{z}\\right) \\equiv \\log_{g}(x) + \\log_{g}(y) - \\log_{g}(z) \\pmod{p-1}.\n$$\n我们将为 $p=29$ 和 $g=2$ 具体计算所有相关量。\n\n首先，我们计算 $2$ 在模 $29$ 下的幂，以建立一个表格并确定 $a, b, c$ 的离散对数。使用重复平方和模 $29$ 约简：\n\n$$\n\\begin{aligned}\n2^{1} \\equiv 2,\\quad 2^{2} \\equiv 4,\\quad 2^{3} \\equiv 8,\\quad 2^{4} \\equiv 16,\\quad 2^{5} \\equiv 32 \\equiv 3,\\\\\n2^{6} \\equiv 6,\\quad 2^{7} \\equiv 12,\\quad 2^{8} \\equiv 24,\\quad 2^{9} \\equiv 48 \\equiv 19,\\quad 2^{10} \\equiv 38 \\equiv 9,\\\\\n2^{11} \\equiv 18,\\quad 2^{12} \\equiv 36 \\equiv 7,\\quad 2^{13} \\equiv 14,\\quad 2^{14} \\equiv 28 \\equiv -1,\\\\\n2^{15} \\equiv -2 \\equiv 27,\\quad 2^{16} \\equiv -4 \\equiv 25,\\quad 2^{17} \\equiv -8 \\equiv 21,\\quad 2^{18} \\equiv -16 \\equiv 13,\\\\\n2^{19} \\equiv -32 \\equiv -3 \\equiv 26,\\quad 2^{20} \\equiv -6 \\equiv 23,\\quad 2^{21} \\equiv -12 \\equiv 17,\\quad 2^{22} \\equiv -24 \\equiv 5,\\\\\n2^{23} \\equiv -48 \\equiv -19 \\equiv 10,\\quad 2^{24} \\equiv -38 \\equiv -9 \\equiv 20,\\quad 2^{25} \\equiv -18 \\equiv 11,\\\\\n2^{26} \\equiv -36 \\equiv -7 \\equiv 22,\\quad 2^{27} \\equiv -14 \\equiv 15,\\quad 2^{28} \\equiv 1 \\pmod{29}.\n\\end{aligned}\n$$\n\n从表中可得：\n\n$$\n\\log_{2}(a) = \\log_{2}(5) = 22,\\quad \\log_{2}(b) = \\log_{2}(7) = 12,\\quad \\log_{2}(c) = \\log_{2}(3) = 5.\n$$\n\n接下来，在 $\\mathbb{F}_{29}^{\\times}$ 中计算 $\\frac{ab}{c}$。首先，$ab \\equiv 5 \\cdot 7 \\equiv 35 \\equiv 6 \\pmod{29}$。$c=3$ 在模 $29$ 下的逆是满足 $3d \\equiv 1 \\pmod{29}$ 的唯一 $d$。因为 $3 \\cdot 10 \\equiv 30 \\equiv 1 \\pmod{29}$，所以 $3$ 在模 $29$ 下的逆是 $10$。因此，\n\n$$\n\\frac{ab}{c} \\equiv 6 \\cdot 10 \\equiv 60 \\equiv 2 \\pmod{29}.\n$$\n\n因此 $\\log_{2}\\!\\left(\\frac{ab}{c}\\right) = \\log_{2}(2) = 1$。\n\n最后，与模 $p-1=28$ 的指数运算法则组合进行比较：\n\n$$\n\\log_{2}(a) + \\log_{2}(b) - \\log_{2}(c) \\equiv 22 + 12 - 5 \\equiv 29 \\equiv 1 \\pmod{28},\n$$\n\n这与直接计算的值 $\\log_{2}\\!\\left(\\frac{ab}{c}\\right) = 1$ 一致。因此，所求的值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3084339"}, {"introduction": "掌握了离散对数的定义和性质后，一个自然而核心的问题便是：如何高效地计算一个未知的离散对数？这个问题通常计算上非常困难，也是许多密码系统安全性的基础。这个高级练习 [@problem_id:3084374] 将引导你实践一种经典的计算方法——小步大步算法 (Baby-step Giant-step algorithm)，它通过一种巧妙的“时空权衡”策略，将指数搜索问题转化为寻找碰撞的问题，让你体验从理论到算法实践的飞跃。", "problem": "设 $p$ 为素数，$\\mathbb{F}_{p}^{\\times}$ 表示模 $p$ 的非零剩余类构成的乘法群。假设 $g \\in \\mathbb{F}_{p}^{\\times}$ 是 $\\mathbb{F}_{p}^{\\times}$ 的一个生成元，因此 $g$ 的阶为 $p-1$，并设 $h \\in \\mathbb{F}_{p}^{\\times}$。$h$ 以 $g$ 为底的离散对数定义为满足 $g^{x} \\equiv h \\pmod{p}$ 的整数 $x$，其中 $0 \\leq x \\leq p-2$。\n\n在具体实例 $p=347$，$g=2$ 和 $h=15$ 中进行计算。从群论定义出发，仅使用关于有限循环群的公认事实，通过以下推理路径确定 $\\log_{g}(h)$：\n- 根据有限群中阶的定义以及 $p-1$ 的因式分解，证明 $g$ 确实是 $\\mathbb{F}_{p}^{\\times}$ 的一个生成元。\n- 描述为何指数 $x$ 存在形如 $x = i m + j$ 的分解（对于合适的整数 $i$ 和 $j$，其中 $m$ 是您选择的一个正整数），并解释为何在一个预先计算的 $g$ 的幂的表格与一个涉及 $h$ 的序列之间找到一个碰撞，能将确定 $x$ 的问题简化为求解一个模群阶的线性同余方程。\n- 明确计算必要的表格以找到这样的碰撞，将问题简化为关于 $x$ 的线性同余方程，并求解满足 $g^{x} \\equiv h \\pmod{p}$ 的最小非负 $x$。\n\n给出您最终的答案，即集合 $\\{0,1,\\dots,p-2\\}$ 中唯一的最小非负整数代表。无需四舍五入，不涉及单位。您的最终答案必须是一个数字。", "solution": "问题要求在有限域 $\\mathbb{F}_{347}$ 的乘法群（记为 $\\mathbb{F}_{347}^{\\times}$）中，计算 $h=15$ 以 $g=2$ 为底的离散对数。这等价于找到在范围 $0 \\leq x \\leq p-2$ 内满足同余式 $g^x \\equiv h \\pmod{p}$ 的唯一整数 $x$，其中 $p=347$，$g=2$，$h=15$。问题指定了一个包含三部分的推理路径，我们将严格遵循。\n\n首先，我们必须证明 $g=2$ 确实是群 $\\mathbb{F}_{347}^{\\times}$ 的一个生成元。由于 $347$ 是一个素数，该群的阶为 $|\\mathbb{F}_{347}^{\\times}| = \\phi(347) = 347-1 = 346$。为证明 $g=2$ 是一个生成元，我们必须证明它模 $347$ 的乘法阶等于群的阶 $346$。根据拉格朗日定理，一个元素的阶必须整除群的阶。群阶的素因数分解为 $346 = 2 \\times 173$。数字 $173$ 是素数，因为它不能被任何小于或等于其平方根 $\\sqrt{173} \\approx 13.15$ 的素数整除。$346$ 的真因数是 $1$、$2$ 和 $173$。一个元素 $g$ 是生成元当且仅当对于 $p-1$ 的每个不同素因数 $q$，都有 $g^{(p-1)/q} \\not\\equiv 1 \\pmod{p}$。\n我们必须计算两个值：\n$1$. 对于素因数 $q_1=2$，我们检验 $g^{(p-1)/2} = 2^{346/2} = 2^{173} \\pmod{347}$。\n$2$. 对于素因数 $q_2=173$，我们检验 $g^{(p-1)/173} = 2^{346/173} = 2^2 \\pmod{347}$。\n\n对于第二种情况：\n$$2^2 = 4 \\not\\equiv 1 \\pmod{347}$$\n对于第一种情况，我们使用模幂运算计算 $2^{173} \\pmod{347}$。我们可以将 $173$ 写成 $173 = 17 \\times 10 + 3$。\n首先，$2^{10} = 1024 = 2 \\times 347 + 330 \\equiv 330 \\equiv -17 \\pmod{347}$。\n然后我们计算 $(-17)$ 的幂：\n$(-17)^2 \\equiv 289 \\equiv -58 \\pmod{347}$。\n$(-17)^4 \\equiv (-58)^2 = 3364 = 9 \\times 347 + 241 \\equiv 241 \\equiv -106 \\pmod{347}$。\n$(-17)^8 \\equiv (-106)^2 = 11236 = 32 \\times 347 + 132 \\equiv 132 \\pmod{347}$。\n$(-17)^{16} \\equiv 132^2 = 17424 = 50 \\times 347 + 74 \\equiv 74 \\pmod{347}$。\n现在，$(-17)^{17} = (-17)^{16} \\times (-17) \\equiv 74 \\times (-17) = -1258 = -4 \\times 347 + 130 \\equiv 130 \\pmod{347}$。\n最后，$2^{173} = (2^{10})^{17} \\cdot 2^3 \\equiv (-17)^{17} \\cdot 8 \\equiv 130 \\cdot 8 = 1040 = 2 \\times 347 + 346 \\equiv 346 \\equiv -1 \\pmod{347}$。\n因为 $2^{173} \\equiv -1 \\not\\equiv 1 \\pmod{347}$ 且 $2^2 \\not\\equiv 1 \\pmod{347}$，所以 $2$ 的阶不是 $346$ 的真因数。因此，$2$ 的阶是 $346$，并且 $g=2$ 是 $\\mathbb{F}_{347}^{\\times}$ 的一个生成元。\n\n第二，我们描述用于寻找 $x$ 的算法，即“小步大步法”（Baby-step Giant-step algorithm）。未知指数 $x$ 在范围 $0 \\leq x \\leq 345$ 内。我们选择一个整数 $m = \\lceil\\sqrt{p-1}\\rceil = \\lceil\\sqrt{346}\\rceil = 19$。任何这样的 $x$ 都可以唯一地写成 $x = im+j$ 的形式，其中 $i = \\lfloor x/m \\rfloor$ 且 $j = x \\pmod m$。$i$ 和 $j$ 的范围是 $0 \\leq j  m$ 和 $0 \\leq i \\leq \\lfloor (p-2)/m \\rfloor$。方程 $g^x \\equiv h \\pmod{p}$ 变为 $g^{im+j} \\equiv h \\pmod{p}$。\n这可以重新排列为 $g^j \\equiv h \\cdot g^{-im} \\pmod{p}$，等价于 $g^j \\equiv h \\cdot (g^{-m})^i \\pmod{p}$。\n这种形式的方程提示了一种“中间相遇”搜索。我们创建两个值列表：\n$1$. “小步”列表：$j \\in \\{0, 1, \\dots, m-1\\}$ 的 $g^j \\pmod{p}$ 的值。\n$2$. “大步”列表：$i \\in \\{0, 1, \\dots, m-1\\}$ 的 $h \\cdot (g^{-m})^i \\pmod{p}$ 的值。\n解 $x$ 的存在性保证了这两个列表之间会有一个公共值。如果我们对于特定的对 $(i, j)$ 找到了一个碰撞，$g^j \\equiv h \\cdot (g^{-m})^i$，那么我们就找到了 $x$ 的组成部分。原始方程 $g^x \\equiv h \\pmod p$ 等价于关于指数的同余式 $\\log_g(g^x) \\equiv \\log_g(h) \\pmod{p-1}$，即 $x \\equiv \\log_g(h) \\pmod{346}$。找到满足 $g^{im+j} \\equiv h \\pmod p$ 的碰撞 $(i,j)$，就有效地解决了关于未知数 $x$ 的线性同余方程 $x \\equiv im+j \\pmod{346}$。最小非负解就是 $x = im+j$。\n\n第三，我们计算必要的表格以找到碰撞并求解 $x$。\n这里 $p=347$，$g=2$，$h=15$，$m=19$。\n“小步”表由 $j \\in \\{0, 1, \\dots, 18\\}$ 的数对 $(j, 2^j \\pmod{347})$ 组成：\n$2^0 \\equiv 1$\n$2^1 \\equiv 2$\n$2^2 \\equiv 4$\n$2^3 \\equiv 8$\n$2^4 \\equiv 16$\n$2^5 \\equiv 32$\n$2^6 \\equiv 64$\n$2^7 \\equiv 128$\n$2^8 \\equiv 256$\n$2^9 \\equiv 512 \\equiv 165$\n$2^{10} \\equiv 330$\n$2^{11} \\equiv 660 \\equiv 313$\n$2^{12} \\equiv 626 \\equiv 279$\n$2^{13} \\equiv 558 \\equiv 211$\n$2^{14} \\equiv 422 \\equiv 75$\n$2^{15} \\equiv 150$\n$2^{16} \\equiv 300$\n$2^{17} \\equiv 600 \\equiv 253$\n$2^{18} \\equiv 506 \\equiv 159$\n我们存储这些值以便高效查找，例如，存储在一个将值映射到指数的哈希表中。\n\n对于“大步”，我们首先计算 $g^{-m} = 2^{-19} \\pmod{347}$。\n$g^m = 2^{19} = 2^{18} \\cdot 2 \\equiv 159 \\cdot 2 = 318 \\pmod{347}$。\n为求 $318$ 模 $347$ 的逆，我们使用扩展欧几里得算法：\n$347 = 1 \\cdot 318 + 29$\n$318 = 10 \\cdot 29 + 28$\n$29 = 1 \\cdot 28 + 1$\n反向回代：\n$1 = 29 - 28 = 29 - (318 - 10 \\cdot 29) = 11 \\cdot 29 - 318 = 11 \\cdot (347 - 318) - 318 = 11 \\cdot 347 - 12 \\cdot 318$。\n所以，$-12 \\cdot 318 \\equiv 1 \\pmod{347}$。逆是 $318^{-1} \\equiv -12 \\equiv 335 \\pmod{347}$。\n设 $\\gamma = g^{-m} \\equiv 335 \\pmod{347}$。我们现在计算序列 $h \\cdot \\gamma^i \\pmod{347}$，其中 $i=0, 1, 2, \\dots$，直到找到一个存在于我们小步表中的值。\n$i=0: 15 \\cdot \\gamma^0 \\equiv 15$。不在小步表中。\n$i=1: 15 \\cdot 335 \\equiv 15 \\cdot (-12) = -180 \\equiv 167$。不在小步表中。\n$i=2: 167 \\cdot (-12) = -2004 = -6 \\cdot 347 + 78 \\equiv 78$。不在小步表中。\n$i=3: 78 \\cdot (-12) = -936 = -3 \\cdot 347 + 105 \\equiv 105$。不在小步表中。\n$i=4: 105 \\cdot (-12) = -1260 = -4 \\cdot 347 + 128 \\equiv 128$。\n找到了一个碰撞！值 $128$ 在我们的小步表中。具体来说，$2^7 \\equiv 128 \\pmod{347}$。\n碰撞发生在 $i=4$ 的大步和 $j=7$ 的小步。我们有 $h \\cdot (g^{-m})^4 \\equiv g^7 \\pmod{347}$。\n这得出 $h \\equiv g^{4m+j} \\pmod{347}$。\n因此，指数 $x$ 由同余式 $x \\equiv 4m+j \\pmod{346}$ 确定。\n代入值 $m=19$，$i=4$ 和 $j=7$：\n$x = 19 \\cdot 4 + 7 = 76 + 7 = 83$。\n最小非负整数解是 $x=83$。该值在要求的范围 $0 \\le 83 \\le 345$ 内。\n为了验证，我们可以计算 $2^{83} \\pmod{347}$。\n$2^{83} = 2^{80} \\cdot 2^3$。如前所示，$2^{10} \\equiv -17 \\pmod{347}$。\n$2^{80} = (2^{10})^8 \\equiv (-17)^8 \\pmod{347}$。从我们为生成元测试所做的中间计算中，我们发现 $(-17)^8 \\equiv 132 \\pmod{347}$。\n因此，$2^{83} \\equiv 132 \\cdot 2^3 = 132 \\cdot 8 = 1056 = 3 \\times 347 + 15 \\equiv 15 \\pmod{347}$。\n计算正确。\n离散对数是 $\\log_2(15) = 83$。", "answer": "$$\\boxed{83}$$", "id": "3084374"}]}