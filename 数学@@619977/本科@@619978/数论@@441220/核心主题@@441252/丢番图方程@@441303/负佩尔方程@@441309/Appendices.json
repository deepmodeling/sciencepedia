{"hands_on_practices": [{"introduction": "在投入复杂的计算之前，我们通常可以利用更简单的工具来判断一个问题是否有解。本练习将运用基础的模算术（具体来说，是模$4$同余）为负佩尔方程 $x^2 - Dy^2 = -1$ 的可解性建立强有力的必要条件。这个过程展示了数论学家如何使用同余理论快速排除无解的情形，体现了其作为问题筛选工具的强大威力。[@problem_id:3092561]", "problem": "设 $D$ 是一个正的非平方整数，考虑关于整数 $x$ 和 $y$ 的负佩尔方程 $x^2 - D y^2 = -1$。使用奇偶性的定义和模4同余的基本性质（即，任何整数的平方模4同余于0或1），判断下列关于 $(x,y)$ 的奇偶性或整数解的（不）存在性的陈述中，哪些是必然正确的，这取决于 $D$ 模4的剩余类。选择所有适用的选项。\n\nA. 如果 $D \\equiv 0 \\pmod{4}$，方程 $x^2 - D y^2 = -1$ 没有整数解。\n\nB. 如果 $D \\equiv 1 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为偶数，$y$ 为奇数。\n\nC. 如果 $D \\equiv 2 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为奇数，$y$ 为奇数。\n\nD. 如果 $D \\equiv 3 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为奇数，$y$ 为偶数。\n\nE. 如果 $D \\equiv 3 \\pmod{4}$，方程 $x^2 - D y^2 = -1$ 没有整数解。\n\nF. 如果 $D \\equiv 1 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为奇数，$y$ 为偶数。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   $D$ 是一个正的非平方整数。\n-   方程是负佩尔方程：$x^2 - D y^2 = -1$。\n-   在整数 $\\mathbb{Z}$ 中寻找解 $(x, y)$。\n-   分析必须使用奇偶性的定义和模4同余的性质。\n-   提供的一个关键性质是，任何整数的平方模4同余于0或1。\n-   任务是确定给定陈述中哪些是必然正确的。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题定义明确，并且基于已建立的数论领域。\n-   **科学依据：** 负佩尔方程和模运算的使用是数论中的标准课题。关于模4平方的假设是一个基本事实。\n-   **适定性：** 问题陈述清晰，提供了得出正确结论所需的所有必要信息。对 $D$ 的约束是恰当的。\n-   **客观性：** 问题使用精确、客观的数学语言进行表述。\n\n### 步骤3：结论和行动\n问题陈述是有效的。将对选项进行完整的推导和评估。\n\n### 推导\n给定方程为 $x^2 - D y^2 = -1$。我们被要求使用模4同余来分析这个方程。\n该方程可以写成一个同余式：\n$$x^2 - D y^2 \\equiv -1 \\pmod{4}$$\n因为 $-1 \\equiv 3 \\pmod{4}$，所以同余式为：\n$$x^2 - D y^2 \\equiv 3 \\pmod{4}$$\n\n问题陈述中说明，并且这是一个基本事实，即任何整数 $n$ 的平方模4同余于0或1。\n-   如果 $n$ 是偶数，则 $n = 2k$（对于某个整数 $k$）。那么 $n^2 = (2k)^2 = 4k^2 \\equiv 0 \\pmod{4}$。\n-   如果 $n$ 是奇数，则 $n = 2k+1$（对于某个整数 $k$）。那么 $n^2 = (2k+1)^2 = 4k^2 + 4k + 1 \\equiv 1 \\pmod{4}$。\n所以，对于任何整数解 $(x, y)$，我们必须有 $x^2 \\in \\{0, 1\\} \\pmod{4}$ 和 $y^2 \\in \\{0, 1\\} \\pmod{4}$。\n\n我们分析 $D$ 模4的余数的四种可能情况。\n\n**情况1：$D \\equiv 0 \\pmod{4}$**\n同余式变为 $x^2 - (0) y^2 \\equiv 3 \\pmod{4}$，化简为：\n$$x^2 \\equiv 3 \\pmod{4}$$\n这是不可能的，因为一个整数的平方模4只能同余于0或1。因此，对于 $D \\equiv 0 \\pmod{4}$，方程 $x^2 - D y^2 = -1$ 没有整数解。\n\n**情况2：$D \\equiv 1 \\pmod{4}$**\n同余式变为：\n$$x^2 - y^2 \\equiv 3 \\pmod{4}$$\n我们检查 $x^2 \\pmod{4}$ 和 $y^2 \\pmod{4}$ 的可能性：\n-   如果 $x^2 \\equiv 0$ 且 $y^2 \\equiv 0$：$0 - 0 = 0 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 0$ 且 $y^2 \\equiv 1$：$0 - 1 = -1 \\equiv 3 \\pmod{4}$。这是一个有效的可能性。\n-   如果 $x^2 \\equiv 1$ 且 $y^2 \\equiv 0$：$1 - 0 = 1 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 1$ 且 $y^2 \\equiv 1$：$1 - 1 = 0 \\not\\equiv 3 \\pmod{4}$。\n满足同余式的唯一组合是 $x^2 \\equiv 0 \\pmod{4}$ 和 $y^2 \\equiv 1 \\pmod{4}$。这意味着 $x$ 必须是偶数，$y$ 必须是奇数。因此，如果对于 $D \\equiv 1 \\pmod{4}$ 存在解，它必须具有这种奇偶性。\n\n**情况3：$D \\equiv 2 \\pmod{4}$**\n同余式变为：\n$$x^2 - 2y^2 \\equiv 3 \\pmod{4}$$\n我们检查各种可能性：\n-   如果 $x^2 \\equiv 0$ 且 $y^2 \\equiv 0$：$0 - 2(0) = 0 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 0$ 且 $y^2 \\equiv 1$：$0 - 2(1) = -2 \\equiv 2 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 1$ 且 $y^2 \\equiv 0$：$1 - 2(0) = 1 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 1$ 且 $y^2 \\equiv 1$：$1 - 2(1) = -1 \\equiv 3 \\pmod{4}$。这是一个有效的可能性。\n满足同余式的唯一组合是 $x^2 \\equiv 1 \\pmod{4}$ 和 $y^2 \\equiv 1 \\pmod{4}$。这意味着 $x$ 必须是奇数，$y$ 必须是奇数。因此，如果对于 $D \\equiv 2 \\pmod{4}$ 存在解，它必须具有这种奇偶性。\n\n**情况4：$D \\equiv 3 \\pmod{4}$**\n同余式变为：\n$$x^2 - 3y^2 \\equiv 3 \\pmod{4}$$\n因为 $-3 \\equiv 1 \\pmod{4}$，这等价于：\n$$x^2 + y^2 \\equiv 3 \\pmod{4}$$\n我们检查两个平方数模4之和的可能性：\n-   如果 $x^2 \\equiv 0$ 且 $y^2 \\equiv 0$：$0 + 0 = 0 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 0$ 且 $y^2 \\equiv 1$：$0 + 1 = 1 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 1$ 且 $y^2 \\equiv 0$：$1 + 0 = 1 \\not\\equiv 3 \\pmod{4}$。\n-   如果 $x^2 \\equiv 1$ 且 $y^2 \\equiv 1$：$1 + 1 = 2 \\not\\equiv 3 \\pmod{4}$。\n没有组合满足该同余式。两个平方数模4之和只能得到0、1或2。永远不可能是3。因此，对于 $D \\equiv 3 \\pmod{4}$，方程 $x^2 - D y^2 = -1$ 没有整数解。\n\n### 逐项分析\n\n**A. 如果 $D \\equiv 0 \\pmod{4}$，方程 $x^2 - D y^2 = -1$ 没有整数解。**\n我们对情况1的分析表明，如果 $D \\equiv 0 \\pmod{4}$，方程化为 $x^2 \\equiv 3 \\pmod{4}$，这对于任何整数 $x$ 都是不可能的。\n结论：**正确**。\n\n**B. 如果 $D \\equiv 1 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为偶数，$y$ 为奇数。**\n我们对情况2的分析表明，同余式 $x^2 - y^2 \\equiv 3 \\pmod{4}$ 仅在 $x^2 \\equiv 0 \\pmod{4}$（所以 $x$ 是偶数）和 $y^2 \\equiv 1 \\pmod{4}$（所以 $y$ 是奇数）时成立。\n结论：**正确**。\n\n**C. 如果 $D \\equiv 2 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为奇数，$y$ 为奇数。**\n我们对情况3的分析表明，同余式 $x^2 - 2y^2 \\equiv 3 \\pmod{4}$ 仅在 $x^2 \\equiv 1 \\pmod{4}$（所以 $x$ 是奇数）和 $y^2 \\equiv 1 \\pmod{4}$（所以 $y$ 是奇数）时成立。\n结论：**正确**。\n\n**D. 如果 $D \\equiv 3 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为奇数，$y$ 为偶数。**\n我们对情况4的分析表明，对于 $D \\equiv 3 \\pmod{4}$，没有整数解。在形式逻辑中，形如“对于空集中的所有元素，性质P都为真”的陈述被认为是空洞地为真（vacuously true）。然而，问题旨在确定关于解的*奇偶性或不存在性*的必要属性。在这种情况下，基本的发现是解的不存在性，如选项E所述。陈述D虽然空洞地为真，但没有提供关于任何解的奇偶性的实际信息，并且是解集为空的一个逻辑产物。从数论分析得出的直接而有意义的结论是解不存在。\n结论：**不正确**。\n\n**E. 如果 $D \\equiv 3 \\pmod{4}$，方程 $x^2 - D y^2 = -1$ 没有整数解。**\n我们对情况4的分析表明，如果 $D \\equiv 3 \\pmod{4}$，方程化为 $x^2 + y^2 \\equiv 3 \\pmod{4}$，这对于任何整数 $x, y$ 都是不可能的。这个陈述是这种情况下的直接和主要结论。\n结论：**正确**。\n\n**F. 如果 $D \\equiv 1 \\pmod{4}$，任何整数解 $(x,y)$ 都必须是 $x$ 为奇数，$y$ 为偶数。**\n我们对情况2的分析表明，任何解都必须是 $x$ 为偶数，$y$ 为奇数。此陈述声称的奇偶性相反。\n结论：**不正确**。", "answer": "$$\\boxed{ABCE}$$", "id": "3092561"}, {"introduction": "求解佩尔型方程的经典方法与 $\\sqrt{D}$ 的连分数展开密切相关。本练习将引导你计算 $\\sqrt{29}$ 的连分数，并利用其周期的奇偶性来验证解的存在性。接着，你将通过计算渐近分数来找到方程的最小正整数解，从而加深对连分数与丢番图方程之间深刻联系的理解。[@problem_id:3092542]", "problem": "设 $D=29$。考虑 $\\sqrt{29}$ 的简单连分数（CF）展开式，其在首项之后为纯周期展开。从二次无理数和简单连分数的定义出发，计算 $\\sqrt{29}$ 的连分数展开，直至并包含一个完整周期。然后，仅使用二次无理数连分数的渐近分数的基本性质，判断负佩尔方程 $x^{2}-29y^{2}=-1$ 是否有整数解。如果有解，求出其最小正整数解 $(x,y)$，其中 $x>0$ 且 $y>0$。将你的最终答案以有序对 $(x,y)$ 的形式写成一个行矩阵。无需四舍五入。", "solution": "用户想要解决一个关于负佩尔方程的问题。\n第一步是验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   设 $D=29$。\n-   考虑 $\\sqrt{29}$ 的简单连分数（CF）展开。\n-   问题是判断负佩尔方程 $x^{2}-29y^{2}=-1$ 是否有整数解。\n-   如果存在解，找到最小正整数解 $(x,y)$，其中 $x>0$ 且 $y>0$。\n-   使用的方法基于二次无理数连分数的渐近分数的基本性质。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实不准确性**：该问题基于成熟的丢番图方程数学理论，特别是佩尔方程及其与连分数的联系。数字 $D=29$ 是一个正的非平方整数，对此理论是标准的。不存在科学或事实上的缺陷。\n2.  **不可形式化或不相关**：该问题是数论中的一个标准练习，直接涉及负佩尔方程的主题。它是完全可以形式化的。\n3.  **不完整或矛盾的设置**：该问题是自洽的。给定了 $D$ 的值，并且目标陈述清晰。没有矛盾之处。\n4.  **不切实际或不可行**：不适用于纯数学问题。\n5.  **不适定或结构不良**：该问题是适定的。$\\sqrt{29}$ 的连分数是唯一的。佩尔型方程最小正整数解的存在性和唯一性由理论保证。\n6.  **伪深刻、平凡或同义反复**：该问题需要多步计算和应用数论中的一个重要定理。它并非平凡问题。\n7.  **超出科学可验证性**：解题过程和中间步骤都可以通过标准的数学算法和定理进行验证。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它在数学上是合理的、适定的且无歧义的。我将继续提供完整解答。\n\n该问题要求我们判断负佩尔方程 $x^{2} - 29y^{2} = -1$ 的可解性，并在解存在的情况下，求出其最小正整数解。规定的方法是：使用 $\\sqrt{29}$ 的简单连分数展开。\n\n首先，我们计算 $\\sqrt{29}$ 的连分数展开。我们使用二次无理数 $\\sqrt{D}$ 的标准算法。设 $\\alpha_0 = \\sqrt{29}$。展开式由序列 $a_0, a_1, a_2, \\ldots$ 给出，其中 $a_n = \\lfloor \\alpha_n \\rfloor$ 且 $\\alpha_{n+1} = \\frac{1}{\\alpha_n - a_n}$。\n\n$a_0 = \\lfloor \\sqrt{29} \\rfloor$。因为 $5^{2} = 25$ 且 $6^{2} = 36$，我们有 $5  \\sqrt{29}  6$。因此，$a_0 = 5$。\n$\\alpha_1 = \\frac{1}{\\sqrt{29} - 5} = \\frac{\\sqrt{29} + 5}{29 - 25} = \\frac{\\sqrt{29} + 5}{4}$。\n$a_1 = \\lfloor \\frac{\\sqrt{29} + 5}{4} \\rfloor = \\lfloor \\frac{5.385... + 5}{4} \\rfloor = \\lfloor \\frac{10.385...}{4} \\rfloor = \\lfloor 2.596... \\rfloor = 2$。\n\n$\\alpha_2 = \\frac{1}{\\frac{\\sqrt{29} + 5}{4} - 2} = \\frac{1}{\\frac{\\sqrt{29} - 3}{4}} = \\frac{4}{\\sqrt{29} - 3} = \\frac{4(\\sqrt{29} + 3)}{29 - 9} = \\frac{4(\\sqrt{29} + 3)}{20} = \\frac{\\sqrt{29} + 3}{5}$。\n$a_2 = \\lfloor \\frac{\\sqrt{29} + 3}{5} \\rfloor = \\lfloor \\frac{5.385... + 3}{5} \\rfloor = \\lfloor \\frac{8.385...}{5} \\rfloor = \\lfloor 1.677... \\rfloor = 1$。\n\n$\\alpha_3 = \\frac{1}{\\frac{\\sqrt{29} + 3}{5} - 1} = \\frac{1}{\\frac{\\sqrt{29} - 2}{5}} = \\frac{5}{\\sqrt{29} - 2} = \\frac{5(\\sqrt{29} + 2)}{29 - 4} = \\frac{5(\\sqrt{29} + 2)}{25} = \\frac{\\sqrt{29} + 2}{5}$。\n$a_3 = \\lfloor \\frac{\\sqrt{29} + 2}{5} \\rfloor = \\lfloor \\frac{5.385... + 2}{5} \\rfloor = \\lfloor \\frac{7.385...}{5} \\rfloor = \\lfloor 1.477... \\rfloor = 1$。\n\n$\\alpha_4 = \\frac{1}{\\frac{\\sqrt{29} + 2}{5} - 1} = \\frac{1}{\\frac{\\sqrt{29} - 3}{5}} = \\frac{5}{\\sqrt{29} - 3} = \\frac{5(\\sqrt{29} + 3)}{29 - 9} = \\frac{5(\\sqrt{29} + 3)}{20} = \\frac{\\sqrt{29} + 3}{4}$。\n$a_4 = \\lfloor \\frac{\\sqrt{29} + 3}{4} \\rfloor = \\lfloor \\frac{5.385... + 3}{4} \\rfloor = \\lfloor \\frac{8.385...}{4} \\rfloor = \\lfloor 2.096... \\rfloor = 2$。\n\n$\\alpha_5 = \\frac{1}{\\frac{\\sqrt{29} + 3}{4} - 2} = \\frac{1}{\\frac{\\sqrt{29} - 5}{4}} = \\frac{4}{\\sqrt{29} - 5} = \\frac{4(\\sqrt{29} + 5)}{29 - 25} = \\frac{4(\\sqrt{29} + 5)}{4} = \\sqrt{29} + 5$。\n$a_5 = \\lfloor \\sqrt{29} + 5 \\rfloor = 5 + 5 = 10$。\n\n$\\alpha_6 = \\frac{1}{(\\sqrt{29} + 5) - 10} = \\frac{1}{\\sqrt{29} - 5}$。我们认出这个表达式来自 $\\alpha_1$ 的计算。\n$\\alpha_6 = \\frac{\\sqrt{29} + 5}{29 - 25} = \\frac{\\sqrt{29} + 5}{4} = \\alpha_1$。\n由于 $\\alpha_6 = \\alpha_1$，偏商序列 $a_n$ 将从 $a_1$ 开始周期性重复。$\\sqrt{29}$ 的连分数展开式为：\n$$ \\sqrt{29} = [a_0; \\overline{a_1, a_2, a_3, a_4, a_5}] = [5; \\overline{2, 1, 1, 2, 10}] $$\n周期的长度为 $k=5$。\n\n数论中的一个基本定理指出，负佩尔方程 $x^{2} - Dy^{2} = -1$ 有整数解的充要条件是 $\\sqrt{D}$ 的简单连分数展开的周期长度 $k$ 是一个奇数。在本例中，$D=29$，周期长度为 $k=5$，是奇数。因此，方程 $x^{2} - 29y^{2} = -1$ 有整数解。\n\n同一定理提供了一种求最小正整数解的方法。如果周期长度 $k$ 是奇数，则 $x^{2} - Dy^{2} = -1$ 的最小正整数解 $(x_1, y_1)$ 由 $\\sqrt{D}$ 的连分数的第 $(k-1)$ 个渐近分数 $C_{k-1} = \\frac{p_{k-1}}{q_{k-1}}$ 的分子 $p_{k-1}$ 和分母 $q_{k-1}$ 给出。\n对于 $k=5$，我们需要找到第 $(5-1)=4$ 个渐近分数，$C_4 = p_4/q_4$。渐近分数 $p_n/q_n$ 使用以下递推关系计算：\n$p_n = a_n p_{n-1} + p_{n-2}$\n$q_n = a_n q_{n-1} + q_{n-2}$\n初始值为 $p_{-2}=0, p_{-1}=1, q_{-2}=1, q_{-1}=0$。\n偏商为 $a_0=5, a_1=2, a_2=1, a_3=1, a_4=2$。\n\n$n=0$：\n$p_0 = a_0 p_{-1} + p_{-2} = 5(1) + 0 = 5$\n$q_0 = a_0 q_{-1} + q_{-2} = 5(0) + 1 = 1$\n\n$n=1$：\n$p_1 = a_1 p_0 + p_{-1} = 2(5) + 1 = 11$\n$q_1 = a_1 q_0 + q_{-1} = 2(1) + 0 = 2$\n\n$n=2$：\n$p_2 = a_2 p_1 + p_0 = 1(11) + 5 = 16$\n$q_2 = a_2 q_1 + q_0 = 1(2) + 1 = 3$\n\n$n=3$：\n$p_3 = a_3 p_2 + p_1 = 1(16) + 11 = 27$\n$q_3 = a_3 q_2 + q_1 = 1(3) + 2 = 5$\n\n$n=4$：\n$p_4 = a_4 p_3 + p_2 = 2(27) + 16 = 54 + 16 = 70$\n$q_4 = a_4 q_3 + q_2 = 2(5) + 3 = 10 + 3 = 13$\n\n最小正整数解为 $(x,y) = (p_4, q_4) = (70, 13)$。\n我们可以验证这个结果：\n$x^{2} - 29y^{2} = 70^{2} - 29(13^{2}) = 4900 - 29(169) = 4900 - 4901 = -1$。\n计算正确。最小正整数解为 $(70, 13)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 70  13 \\end{pmatrix} } $$", "id": "3092542"}, {"introduction": "在欧洲数学家发展出连分数理论很久之前，印度数学家就已经发明了一种非常高效的算法——Chakravala（意为“轮转”）法。本练习将让你应用这一古老而优雅的技巧来求解同一个方程 $x^2 - 29y^2 = -1$。你将从一个初始近似解出发，利用婆罗摩笈多恒等式进行迭代优化，亲眼见证该方法如何巧妙地收敛到我们之前用连分数法得到的那个最小解。[@problem_id:3092550]", "problem": "设 $D = 29$。考虑负佩尔方程 $x^{2} - D y^{2} = -1$。你的任务如下：\n\n1) 通过分析 $\\sqrt{D}$ 的简单连分数展开并确定其周期的奇偶性，来证明方程 $x^{2} - D y^{2} = -1$ 存在解。\n\n2) 从第一性原理出发，仅使用 Brahmagupta 恒等式\n$$\n(a^{2} - D b^{2})(c^{2} - D d^{2}) = (ac + D bd)^{2} - D(ad + bc)^{2},\n$$\n为 $D = 29$ 构建 Chakravala 方法，作为一个更新满足 $a^{2} - D b^{2} = k$ 的整数三元组 $(a,b,k)$ 的迭代过程。在每一步中，选择一个整数 $m$，它既能满足使下一个三元组各项为整数所必需的整除性条件，又能使 $|k|$ 变小，然后明确计算出所得的新三元组 $(a',b',k')$。从一个由最接近 $\\sqrt{D}$ 的整数导出的自然初始三元组开始，并持续进行直到达到 $k = -1$。\n\n3) 在你的构造中，证明每个更新后的三元组仍为整数，并且你所获得的 $|k|$ 值序列确实递减至 $1$。解释为什么当 $k = -1$ 时的最终三元组提供了方程 $x^{2} - D y^{2} = -1$ 的一个解，并通过将你的结果与第 (1) 部分的连分数分析联系起来，论证该解是最小解。\n\n将你的最终答案表示为单一的精确表达式 $x + y \\sqrt{29}$，它对应于 $x^{2} - 29 y^{2} = -1$ 的最小正整数解 $\\,(x,y)\\,$。不需要四舍五入，你的答案必须是精确值。", "solution": "我们首先回顾两个基本事实。首先，对于一个非平方数的正整数 $D$，负佩尔方程 $x^{2} - D y^{2} = -1$ 有整数解当且仅当 $\\sqrt{D}$ 的简单连分数展开的周期长度为奇数。其次，Chakravala 方法是基于 Brahmagupta 恒等式\n$$\n(a^{2} - D b^{2})(c^{2} - D d^{2}) = (ac + D bd)^{2} - D(ad + bc)^{2},\n$$\n的二次型复合的一种算法改进，它允许我们组合由 $x^{2} - D y^{2}$ 对 $k$ 的表示，以趋近于 $k = \\pm 1$。\n\n第 1 步：确定 $\\sqrt{29}$ 的简单连分数的周期，并推断 $x^{2} - 29 y^{2} = -1$ 的可解性。\n\n我们通过标准递推式计算 $\\sqrt{29}$ 的简单连分数展开。设 $a_{0} = \\lfloor \\sqrt{29} \\rfloor = 5$，并初始化 $m_{0} = 0$，$d_{0} = 1$，$a_{0} = 5$。对于 $n \\geq 0$ 定义\n$$\nm_{n+1} = d_{n} a_{n} - m_{n}, \\quad d_{n+1} = \\frac{29 - m_{n+1}^{2}}{d_{n}}, \\quad a_{n+1} = \\left\\lfloor \\frac{a_{0} + m_{n+1}}{d_{n+1}} \\right\\rfloor.\n$$\n计算前几项：\n- $n = 0$：$m_{1} = 1 \\cdot 5 - 0 = 5$, $d_{1} = \\frac{29 - 5^{2}}{1} = 4$, $a_{1} = \\left\\lfloor \\frac{5 + 5}{4} \\right\\rfloor = 2$。\n- $n = 1$：$m_{2} = 4 \\cdot 2 - 5 = 3$, $d_{2} = \\frac{29 - 3^{2}}{4} = 5$, $a_{2} = \\left\\lfloor \\frac{5 + 3}{5} \\right\\rfloor = 1$。\n- $n = 2$：$m_{3} = 5 \\cdot 1 - 3 = 2$, $d_{3} = \\frac{29 - 2^{2}}{5} = 5$, $a_{3} = \\left\\lfloor \\frac{5 + 2}{5} \\right\\rfloor = 1$。\n- $n = 3$：$m_{4} = 5 \\cdot 1 - 2 = 3$, $d_{4} = \\frac{29 - 3^{2}}{5} = 4$, $a_{4} = \\left\\lfloor \\frac{5 + 3}{4} \\right\\rfloor = 2$。\n- $n = 4$：$m_{5} = 4 \\cdot 2 - 3 = 5$, $d_{5} = \\frac{29 - 5^{2}}{4} = 1$, $a_{5} = \\left\\lfloor \\frac{5 + 5}{1} \\right\\rfloor = 10$。\n\n因此，\n$$\n\\sqrt{29} = [\\,5;\\overline{2,1,1,2,10}\\,],\n$$\n其周期长度为 $5$，是奇数。因此，根据通过连分数研究佩尔方程的标准理论，负佩尔方程 $x^{2} - 29 y^{2} = -1$ 有整数解。此外，对应于完整周期的渐近分数（即，指数等于周期长度的渐近分数）给出了 $x^{2} - 29 y^{2} = -1$ 的最小正整数解。\n\n第 2 步：从 Brahmagupta 恒等式推导 Chakravala 更新规则，并为 $D=29$ 构建迭代过程。\n\n假设 $(a,b,k)$ 满足 $a^{2} - D b^{2} = k$。我们试图与另一个表示 $(c,d,\\ell)$ 进行复合，以获得一个形式相同但 $|k|$ 更小的新三元组。Brahmagupta 恒等式给出\n$$\n(a^{2} - D b^{2})(c^{2} - D d^{2}) = (ac + D bd)^{2} - D(ad + bc)^{2}.\n$$\n如果我们为某个整数 $m$ 选择 $(c,d,\\ell) = (m,1,m^{2} - D)$，那么\n$$\n(a^{2} - D b^{2})(m^{2} - D) = (am + D b)^{2} - D(a + bm)^{2}.\n$$\n将两边同除以 $k$（稍后我们将施加一个整除性条件）可以启发我们定义\n$$\na' = \\frac{am + D b}{|k|}, \\quad b' = \\frac{a + bm}{|k|}, \\quad k' = \\frac{m^{2} - D}{k}.\n$$\n为确保 $a'$ 和 $b'$ 是整数，我们只需满足同余式\n$$\na + bm \\equiv 0 \\pmod{|k|}.\n$$\n在此条件下，$|k|$ 整除 $a + bm$，并且由于 $a^{2} - D b^{2} = k$，可以验证 $|k|$ 也整除 $am + D b$：\n$$\nam + D b \\equiv am - a^{2} b^{-1} \\equiv a(m - ab^{-1}) \\equiv a \\cdot 0 \\equiv 0 \\pmod{|k|},\n$$\n其中 $b^{-1}$ 表示 $b$ 模 $|k|$ 的模逆元（如果存在），并且通常来说，同余式 $a + bm \\equiv 0 \\pmod{|k|}$ 强制两个分子都为整数，因为\n$$\n(am + D b) - a(a + bm) = D b - a^{2} \\equiv -k \\equiv 0 \\pmod{|k|}.\n$$\n因此，该更新在整数上是良定义的。Chakravala 方法的启发式策略是选择满足 $a + bm \\equiv 0 \\pmod{|k|}$ 的 $m$，使得 $|m^{2} - D|$ 尽可能小，从而使 $|k'| = \\left|\\frac{m^{2} - D}{k}\\right|$ 向 $1$ 减小。\n\n我们现在对 $D=29$ 实现此方法。\n\n初始化。设 $a_{0} = \\lceil \\sqrt{29} \\rceil = 6$，$b_{0} = 1$，于是\n$$\nk_{0} = a_{0}^{2} - 29 b_{0}^{2} = 36 - 29 = 7.\n$$\n因此，初始三元组为 $(a,b,k) = (6,1,7)$。\n\n第一步。我们需要 $m \\equiv -a \\pmod{|k|}$，即 $m \\equiv -6 \\equiv 1 \\pmod{7}$。在与 $1 \\pmod{7}$ 同余的整数中，我们选择使 $|m^{2} - 29|$ 最小的 $m$。候选的 $m \\in \\{ \\ldots, -6, 1, 8, 15, \\ldots \\}$ 给出 $|(-6)^{2} - 29| = 7$，$|1^{2} - 29| = 28$，$|8^{2} - 29| = 35$。取 $m=1$ 可得到一次有效的约化并保持 $m$ 值较小。计算\n$$\na' = \\frac{6 \\cdot 1 + 29 \\cdot 1}{7} = \\frac{35}{7} = 5, \\quad b' = \\frac{6 + 1 \\cdot 1}{7} = \\frac{7}{7} = 1, \\quad k' = \\frac{1^{2} - 29}{7} = -4.\n$$\n新三元组：$(a,b,k) = (5,1,-4)$。\n\n第二步。施加条件 $m \\equiv -a \\pmod{|k|}$，即 $m \\equiv -5 \\equiv 3 \\pmod{4}$。在 $m \\equiv 3 \\pmod{4}$ 的条件下最小化 $|m^{2} - 29|$，候选值 $m \\in \\{ \\ldots, -1, 3, 7, 11, \\ldots \\}$ 给出 $|(-1)^{2} - 29| = 28$，$|3^{2} - 29| = 20$，$|7^{2} - 29| = 20$。选择 $m = 3$。则\n$$\na' = \\frac{5 \\cdot 3 + 29 \\cdot 1}{4} = \\frac{44}{4} = 11, \\quad b' = \\frac{5 + 1 \\cdot 3}{4} = \\frac{8}{4} = 2, \\quad k' = \\frac{3^{2} - 29}{-4} = 5.\n$$\n新三元组：$(a,b,k) = (11,2,5)$。\n\n第三步。我们需要 $m$ 满足 $a + b m \\equiv 0 \\pmod{|k|}$，即 $11 + 2 m \\equiv 0 \\pmod{5}$，所以 $2 m \\equiv -1 \\equiv 4 \\pmod{5}$，因此 $m \\equiv 2 \\pmod{5}$。在 $m \\equiv 2 \\pmod{5}$ 的条件下最小化 $|m^{2} - 29|$。候选值 $m \\in \\{ \\ldots, -3, 2, 7, 12, \\ldots \\}$ 给出 $|(-3)^{2} - 29| = 20$，$|2^{2} - 29| = 25$，$|7^{2} - 29| = 20$。选择 $m = 7$。则\n$$\na' = \\frac{11 \\cdot 7 + 29 \\cdot 2}{5} = \\frac{77 + 58}{5} = \\frac{135}{5} = 27, \\quad b' = \\frac{11 + 2 \\cdot 7}{5} = \\frac{25}{5} = 5, \\quad k' = \\frac{7^{2} - 29}{5} = 4.\n$$\n新三元组：$(a,b,k) = (27,5,4)$。\n\n第四步。施加条件 $m \\equiv -a \\pmod{|k|}$，即 $m \\equiv -27 \\equiv 1 \\pmod{4}$。为 $m \\equiv 1 \\pmod{4}$ 最小化 $|m^{2} - 29|$。候选值 $m \\in \\{ \\ldots, 1, 5, 9, \\ldots \\}$ 给出 $|1^{2} - 29| = 28$，$|5^{2} - 29| = 4$，$|9^{2} - 29| = 52$。选择 $m = 5$。则\n$$\na' = \\frac{27 \\cdot 5 + 29 \\cdot 5}{4} = \\frac{135 + 145}{4} = \\frac{280}{4} = 70, \\quad b' = \\frac{27 + 5 \\cdot 5}{4} = \\frac{27 + 25}{4} = \\frac{52}{4} = 13, \\quad k' = \\frac{5^{2} - 29}{4} = -1.\n$$\n我们已达到 $k' = -1$，因此 $(x,y) = (70,13)$ 是负佩尔方程\n$$\nx^{2} - 29 y^{2} = -1.\n$$\n的一个解。\n\n第 3 步：关于整数性、$|k|$ 的递减性以及最小性的证明。\n\n每一步的整数性可由同余式 $a + b m \\equiv 0 \\pmod{|k|}$ 以及关系式\n$$\n(am + D b) - a(a + bm) = D b - a^{2} = -k,\n$$\n得出，该关系式表明，如果 $|k|$ 整除 $a + b m$，那么它也整除 $am + D b$，因此 $a'$ 和 $b'$ 都是整数。$|k|$ 的减小是通过在整除性约束下选择使 $|m^{2} - D|$ 尽可能小的 $m$ 来实现的。在 $D = 29$ 的具体序列中，$|k|$ 的值经过了 $7 \\to 4 \\to 5 \\to 4 \\to 1$，在有限步内达到了 $|k| = 1$。\n\n为了论证最小性，我们援引第 1 步中的连分数分析。对于周期长度为奇数 $5$ 的 $\\sqrt{29} = [\\,5;\\overline{2,1,1,2,10}\\,]$，在周期长度处截断得到的渐近分数给出了负佩尔方程的最小解。通过\n$$\np_{-2} = 0, \\quad p_{-1} = 1, \\quad p_{n} = a_{n} p_{n-1} + p_{n-2}, \\quad\nq_{-2} = 1, \\quad q_{-1} = 0, \\quad q_{n} = a_{n} q_{n-1} + q_{n-2},\n$$\n计算渐近分数 $p_{n}/q_{n}$，其中 $a_{0} = 5$，$a_{1} = 2$，$a_{2} = 1$，$a_{3} = 1$，$a_{4} = 2$，我们得到\n$$\n\\frac{p_{0}}{q_{0}} = \\frac{5}{1}, \\quad \\frac{p_{1}}{q_{1}} = \\frac{11}{2}, \\quad \\frac{p_{2}}{q_{2}} = \\frac{16}{3}, \\quad \\frac{p_{3}}{q_{3}} = \\frac{27}{5}, \\quad \\frac{p_{4}}{q_{4}} = \\frac{70}{13}.\n$$\n由于周期长度为 $5$（奇数），渐近分数 $\\frac{p_{4}}{q_{4}} = \\frac{70}{13}$ 满足 $p_{4}^{2} - 29 q_{4}^{2} = -1$，从而给出了 $x^{2} - 29 y^{2} = -1$ 的最小正整数解 $(x,y) = (70,13)$。这与上面通过 Chakravala 方法得到的最终三元组相匹配，从而证实了方法的收敛性和解的最小性。\n\n因此，$x^{2} - 29 y^{2} = -1$ 的最小解是 $(x,y) = (70,13)$，所要求的表达式是 $x + y \\sqrt{29} = 70 + 13 \\sqrt{29}$。", "answer": "$$\\boxed{70+13\\sqrt{29}}$$", "id": "3092550"}]}