{"hands_on_practices": [{"introduction": "理论上的保证，如狄利克雷定理，可以通过计算来进行探索和验证。本练习将指导您编写一个程序，在给定范围内搜索对 $\\sqrt{3}$ 的“最佳”有理逼近。您将通过经验发现，这些最佳逼近并非随机出现，而恰好是连分数的收敛子，同时您还将验证狄利克雷定理和赫维茨定理给出的界限。这个实践将抽象的定理与具体的数值计算联系起来。[@problem_id:3083983]", "problem": "设 $\\alpha=\\sqrt{3}$ 为一个无理实数。对于整数 $p$ 和 $q\\ge 1$，定义绝对线性形式误差 $\\lvert q\\alpha - p\\rvert$ 和有理逼近误差 $\\lvert \\alpha - \\frac{p}{q}\\rvert$。本问题基于数论中以下广为接受的事实和定义：\n- 最近整数性质：对于固定的 $q$，使 $\\lvert q\\alpha - p\\rvert$ 最小化的整数 $p$ 是最接近 $q\\alpha$ 的整数。\n- 连分数与渐近分数：实数 $\\alpha$ 的简单连分数展开决定了一个由递推关系给出的渐近分数序列 $\\frac{p_n}{q_n}$，这些渐近分数在精确意义上提供了最佳有理逼近。\n- 狄利克雷逼近定理：对于任意实数 $\\alpha$ 和任意整数 $N\\ge 1$，存在整数 $p$ 和 $q$（其中 $1\\le q\\le N$），使得 $\\lvert q\\alpha - p\\rvert \\le \\frac{1}{N}$；此外，存在无穷多个分数 $\\frac{p}{q}$ 满足 $\\lvert \\alpha - \\frac{p}{q}\\rvert  \\frac{1}{q^2}$。\n- 赫维茨定理：对于任意无理数 $\\alpha$，存在无穷多个有理数 $\\frac{p}{q}$ 使得 $\\lvert \\alpha - \\frac{p}{q}\\rvert  \\frac{1}{\\sqrt{5}\\,q^2}$。常数 $\\frac{1}{\\sqrt{5}}$ 是最佳可能值。\n\n你的任务是实现一个完整的程序，该程序：\n1. 对于每个给定的界限 $N$，搜索所有满足 $1\\le q\\le N$ 的分母 $q$，并对每个 $q$ 选择使 $\\lvert q\\alpha - p\\rvert$ 最小化的整数 $p$。在所有满足 $1\\le q\\le N$ 的数对 $\\left(p,q\\right)$ 中，找出使 $\\lvert q\\alpha - p\\rvert$ 最小的数对 $\\left(p^\\ast,q^\\ast\\right)$，并记录最小值 $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert$。\n2. 计算 $\\alpha$ 的简单连分数展开，直到能生成所有满足 $q_n\\le N$ 的渐近分数 $\\frac{p_n}{q_n}$。确定通过暴力搜索找到的最佳数对 $\\left(p^\\ast,q^\\ast\\right)$ 是否是这些渐近分数中的一个。同时验证最佳渐近分数（即在所有满足 $q_n\\le N$ 的 $\\frac{p_n}{q_n}$ 中使 $\\lvert q_n\\alpha - p_n\\rvert$ 最小的那个）与暴力搜索得到的最佳结果是否匹配。\n3. 通过检查 $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert \\le \\frac{1}{N}$ 是否成立来验证 Dirichlet 界。\n4. 通过检查 $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast}\\right\\rvert  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2}$ 是否成立来验证 Hurwitz 界对于最佳数对 $\\left(p^\\ast,q^\\ast\\right)$ 的情况。\n\n仅使用纯数学量；不涉及物理单位。所有角度（如果有）均假定为无量纲。程序必须对固定的 $\\alpha=\\sqrt{3}$ 进行上述计算。\n\n测试套件：\n- 情况 A：$N=1$ (边界值，小)\n- 情况 B：$N=10^2$\n- 情况 C：$N=10^3$\n- 情况 D：$N=10^5$ (计算量大)\n\n对于每个测试用例，程序必须输出一个形式为 $[q^\\ast, p^\\ast, \\text{min\\_abs}, \\text{is\\_convergent}, \\text{dirichlet\\_ok}, \\text{hurwitz\\_ok}]$ 的列表，其中：\n- $q^\\ast$ 和 $p^\\ast$ 是整数，\n- $\\text{min\\_abs}$ 是一个浮点数，表示 $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert$，\n- $\\text{is\\_convergent}$ 是一个布尔值，指示 $\\left(p^\\ast,q^\\ast\\right)$ 是否为 $\\alpha$ 的连分数渐近分数，\n- $\\text{dirichlet\\_ok}$ 是一个布尔值，指示 $\\text{min\\_abs}\\le\\frac{1}{N}$ 是否成立，\n- $\\text{hurwitz\\_ok}$ 是一个布尔值，指示 $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast}\\right\\rvert  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2}$ 是否成立。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含四个测试用例的结果。结果为一个逗号分隔的列表，并用方括号括起来，每个测试用例的结果本身也是一个如上所述格式的列表。例如：`[[...],[...],[...],[...]]`，且不需要额外的空格。", "solution": "该问题要求对无理数 $\\alpha = \\sqrt{3}$ 进行丢番图逼近的计算分析。对于给定的分母 $q$ 的上界 $N$，我们的任务有几个目标：通过暴力搜索找到最佳有理逼近，将此结果与连分数理论进行比较，并验证逼近理论的两个基本定理，即 Dirichlet 定理和 Hurwitz 定理。\n\n解决方案是通过对每个以界限 $N$ 为特征的测试用例进行一系列计算和验证步骤来实现的。我们使用高精度浮点运算来处理无理数 $\\alpha$。对于具有给定界限 $N$ 的单个测试用例，总体流程如下。\n\n**步骤 1：暴力最小化线性形式误差**\n\n第一个任务是找到满足 $1 \\le q^\\ast \\le N$ 的整数对 $(p^\\ast, q^\\ast)$，该整数对使绝对线性形式误差 $\\lvert q\\alpha - p\\rvert$ 最小。对于任意给定的整数分母 $q \\ge 1$，使此误差最小化的整数 $p$ 是最接近 $q\\alpha$ 值的整数。这被称为 $q\\alpha$ 的最近整数，可以计算为 $p = \\text{round}(q\\alpha)$。\n\n我们遍历从 $1$ 到 $N$ 的所有可能的分母 $q$。对于每个 $q$，我们确定最优的 $p$ 并计算相应的误差 $\\epsilon_q = \\lvert q\\alpha - \\text{round}(q\\alpha)\\rvert$。我们记录迄今为止发现的最小误差 $\\epsilon_{min}$ 以及产生该误差的数对 $(p^\\ast, q^\\ast)$。\n\n$$ \\epsilon_{min} = \\min_{1 \\le q \\le N} \\min_{p \\in \\mathbb{Z}} \\lvert q\\alpha - p \\rvert = \\min_{1 \\le q \\le N} \\lvert q\\alpha - \\text{round}(q\\alpha) \\rvert $$\n\n最终的 $p^\\ast$、$q^\\ast$ 和 $\\epsilon_{min}$（在输出中表示为 `min_abs`）被记录下来。\n\n**步骤 2：与连分数渐近分数进行验证**\n\n连分数理论为寻找数的最佳有理逼近提供了一种强大的方法。一个关键结果，即 Lagrange 逼近定理，指出“第二类最佳逼近”（对于所有 $1 \\le q'  q$，满足 $\\lvert q\\alpha - p \\rvert  \\lvert q'\\alpha - p' \\rvert$ 的分数 $p/q$）的集合恰好是 $\\alpha$ 的主渐近分数的集合。因此，在步骤 1 中找到的、代表在 $1 \\le q \\le N$ 范围内的全局最小值的数对 $(p^\\ast, q^\\ast)$ 必须是这些渐近分数之一。\n\n为了验证这一点，我们首先生成 $\\alpha = \\sqrt{3}$ 的渐近分数序列 $\\frac{p_n}{q_n}$。$\\sqrt{3}$ 的简单连分数展开是周期的：$\\sqrt{3} = [1; \\overline{1, 2}]$。系数为 $a_0 = 1$，对于 $n \\ge 1$，$a_n=1$（如果 $n$ 是奇数）和 $a_n=2$（如果 $n$ 是偶数）。渐近分数 $p_n/q_n$ 使用标准递推关系生成：\n$$ p_n = a_n p_{n-1} + p_{n-2} $$\n$$ q_n = a_n q_{n-1} + q_{n-2} $$\n初始条件为 $p_{-1}=1, q_{-1}=0$ 和 $p_0=a_0=1, q_0=1$。\n\n我们生成所有满足 $q_n \\le N$ 的渐近分数 $(p_n, q_n)$ 并存储它们。然后我们检查步骤 1 中得到的数对 $(p^\\ast, q^\\ast)$ 是否存在于这个渐近分数集合中。此验证产生布尔值 `is_convergent`，根据理论，该值必须为真。\n\n**步骤 3：验证 Dirichlet 逼近定理**\n\n关于丢番图逼近的 Dirichlet 定理指出，对于任意实数 $\\alpha$ 和任意整数 $N \\ge 1$，存在整数 $p$ 和 $q$（其中 $1 \\le q \\le N$），使得 $\\lvert q\\alpha - p \\rvert \\le \\frac{1}{N}$。\n\n在步骤 1 中找到的值 $\\epsilon_{min} = \\lvert q^\\ast\\alpha - p^\\ast \\rvert$ 是在 $1 \\le q \\le N$ 范围内任何 $q$ 可能的最小误差。由于 Dirichlet 定理保证了至少存在一对 $(p,q)$ 满足该不等式，因此在所有这些数对中的最小误差也必须满足它。因此，我们验证条件：\n$$ \\epsilon_{min} \\le \\frac{1}{N} $$\n此检查产生布尔值 `dirichlet_ok`，对于所有 $N \\ge 1$，该值预期为真。\n\n**步骤 4：验证 Hurwitz 定理的界**\n\nHurwitz 定理指出，对于任意无理数 $\\alpha$，存在无穷多个有理数 $\\frac{p}{q}$，使得有理逼近误差满足：\n$$ \\left\\lvert \\alpha - \\frac{p}{q} \\right\\rvert  \\frac{1}{\\sqrt{5}\\,q^2} $$\n该定理保证了存在无穷多个这样的逼近，但并不保证每个最佳逼近（或每个渐近分数）都满足这个特定的界。对于在步骤 1 中找到的最佳逼近数对 $(p^\\ast, q^\\ast)$，我们明确检查该不等式是否成立。\n\n该数对的有理逼近误差为 $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast} \\right\\rvert = \\frac{\\lvert q^\\ast\\alpha - p^\\ast \\rvert}{q^\\ast} = \\frac{\\epsilon_{min}}{q^\\ast}$。因此，验证过程如下：\n$$ \\frac{\\epsilon_{min}}{q^\\ast}  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2} $$\n这会产生布尔值 `hurwitz_ok`。与之前的检查不同，不保证此结果对于每个 $N$ 都为真。\n\n完整的程序为测试套件中的每个 $N$ 值实现这四个步骤，并按规定格式化结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for the specified test cases and print the results.\n    \"\"\"\n\n    def get_cf_coeff_sqrt3(n):\n        \"\"\"\n        Returns the n-th coefficient (a_n) of the simple continued fraction of sqrt(3),\n        which is [1; 1, 2, 1, 2, ...].\n        \"\"\"\n        if n == 0:\n            return 1\n        return 1 if n % 2 != 0 else 2\n\n    def get_convergents_up_to_n(N_max):\n        \"\"\"\n        Generates convergents p_n/q_n for sqrt(3) until q_n > N_max.\n        Returns a set of (p, q) tuples for efficient lookup.\n        \"\"\"\n        convergents = set()\n        n = 0\n        p_prev, q_prev = 1, 0\n        a_n = get_cf_coeff_sqrt3(n)\n        p_curr, q_curr = a_n, 1\n        \n        while q_curr = N_max:\n            convergents.add((p_curr, q_curr))\n            \n            n += 1\n            a_n = get_cf_coeff_sqrt3(n)\n            \n            p_next = a_n * p_curr + p_prev\n            q_next = a_n * q_curr + q_prev\n            \n            p_prev, q_prev = p_curr, q_curr\n            p_curr, q_curr = p_next, q_next\n            \n        return convergents\n\n    def analyze_approximation(N):\n        \"\"\"\n        Performs the full Diophantine approximation analysis for a given denominator bound N.\n        \n        Returns:\n            A list containing [q*, p*, min_abs, is_convergent, dirichlet_ok, hurwitz_ok].\n        \"\"\"\n        alpha = np.sqrt(3)\n\n        # Task 1: Brute-force search for the best rational approximation.\n        min_abs_linear_error = np.inf\n        p_star, q_star = -1, -1\n\n        for q in range(1, N + 1):\n            p = int(round(q * alpha))\n            current_error = abs(q * alpha - p)\n\n            if current_error  min_abs_linear_error:\n                min_abs_linear_error = current_error\n                p_star = p\n                q_star = q\n\n        # Task 2: Compare with continued fraction convergents.\n        convergents = get_convergents_up_to_n(N)\n        is_convergent = (p_star, q_star) in convergents\n\n        # Task 3: Verify Dirichlet's approximation theorem bound.\n        dirichlet_bound = 1.0 / N\n        dirichlet_ok = min_abs_linear_error = dirichlet_bound\n\n        # Task 4: Verify Hurwitz's theorem bound for the best pair (p*, q*).\n        rational_approx_error = min_abs_linear_error / q_star\n        hurwitz_bound = 1.0 / (np.sqrt(5) * q_star**2)\n        hurwitz_ok = rational_approx_error  hurwitz_bound\n\n        return [q_star, p_star, min_abs_linear_error, is_convergent, dirichlet_ok, hurwitz_ok]\n\n    # Define the test cases from the problem statement.\n    test_cases = [1, 10**2, 10**3, 10**5]\n\n    results = []\n    for N_val in test_cases:\n        results.append(analyze_approximation(N_val))\n\n    # Format the results into the required single-line string.\n    def format_result(res):\n        q, p, err, is_c, is_d, is_h = res\n        return f\"[{q},{p},{err},{str(is_c).lower()},{str(is_d).lower()},{str(is_h).lower()}]\"\n\n    final_output_str = f\"[{','.join([format_result(r) for r in results])}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "3083983"}, {"introduction": "在通过计算探索了有理逼近之后，我们现在转向一个经典的分析问题。本练习聚焦于黄金比例 $\\varphi$，它在某种意义上是“最无理”的数。通过进行数值计算并为其逼近误差推导一个精确的解析公式，您将理解赫维茨定理中的常数 $\\sqrt{5}$ 为何是最佳的且无法改进。这个练习揭示了一个特定数字的属性与一个普适定理的极限之间的深刻联系。[@problem_id:3084017]", "problem": "设 $\\varphi$ 表示黄金比例 $\\varphi = \\frac{1+\\sqrt{5}}{2}$。考虑 $\\varphi$ 的简单连分数展开，并设 $\\frac{p_{n}}{q_{n}}$ 为其第 $n$ 个渐近分数，其中 $n \\geq 1$。已知 $\\varphi$ 的渐近分数是连续斐波那契数之比。仅使用简单连分数和渐近分数的基本定义、斐波那契数的递推关系，以及斐波那契数的 Binet 公式 $F_{n} = \\frac{\\varphi^{n} - \\psi^{n}}{\\sqrt{5}}$（其中 $\\psi = \\frac{1-\\sqrt{5}}{2}$），完成以下各项：\n\n1) 对 $n = 1, 2, 3, 4$，以 $4$ 位有效数字计算 $q_{n}^{2}\\,|\\varphi - p_{n}/q_{n}|$ 的值，并说明这些值是大于还是小于常数 $\\frac{1}{\\sqrt{5}}$。\n\n2) 从定义和 Binet 公式出发，推导一个仅含 $n$ 和 $\\varphi$ 的 $q_{n}^{2}\\,|\\varphi - p_{n}/q_{n}|$ 的闭式表达式。\n\n3) 使用第 $2)$ 部分得到的表达式，确定 $\\lim_{n \\to \\infty} q_{n}^{2}\\,|\\varphi - p_{n}/q_{n}|$ 的精确值，并在 Hurwitz 丢番图逼近定理中最佳常数的背景下，简要解释此极限的意义。\n\n给出第 $3)$ 部分中极限的精确值作为最终答案。无需单位，最终答案也无需四舍五入。", "solution": "此问题在数学上是正确的、自洽的，并且在数论领域内是适定的。我们将进行完整解答。\n\n黄金比例是 $\\varphi = \\frac{1+\\sqrt{5}}{2}$。它的简单连分数是 $[1; 1, 1, 1, \\dots]$。其渐近分数 $\\frac{p_n}{q_n}$ 是连续斐波那契数之比。斐波那契数列定义为 $F_0=0, F_1=1$，且当 $k \\ge 2$ 时，$F_{k} = F_{k-1} + F_{k-2}$。其前几项是 $0, 1, 1, 2, 3, 5, 8, 13, \\dots$。\n\n$[a_0; a_1, a_2, \\dots]$ 的渐近分数由递推关系 $p_k = a_k p_{k-1} + p_{k-2}$ 和 $q_k = a_k q_{k-1} + q_{k-2}$ 给出，初始值为 $p_{-1}=1, q_{-1}=0, p_0=a_0, q_0=1$。对于 $\\varphi$，我们有对所有 $k \\ge 0$，$a_k=1$。\n当 $n=0$ 时：$p_0/q_0 = 1/1 = F_2/F_1$。\n当 $n=1$ 时：$p_1/q_1 = (1 \\cdot 1 + 1)/(1 \\cdot 1 + 0) = 2/1 = F_3/F_2$。\n当 $n=2$ 时：$p_2/q_2 = (1 \\cdot 2 + 1)/(1 \\cdot 1 + 1) = 3/2 = F_4/F_3$。\n通过归纳法，第 $n$ 个渐近分数（按题目要求 $n \\ge 1$）是 $\\frac{p_n}{q_n} = \\frac{F_{n+2}}{F_{n+1}}$。因此，我们可得 $p_n = F_{n+2}$ 和 $q_n = F_{n+1}$。\n\n第 $k$ 个斐波那契数的 Binet 公式是 $F_k = \\frac{\\varphi^k - \\psi^k}{\\sqrt{5}}$，其中 $\\psi = \\frac{1-\\sqrt{5}}{2}$。数 $\\varphi$ 和 $\\psi$ 是二次方程 $x^2 - x - 1 = 0$ 的根，这意味着 $\\varphi^2 = \\varphi+1$，$\\psi^2 = \\psi+1$，$\\varphi+\\psi=1$ 和 $\\varphi\\psi=-1$。\n\n**1) 数值计算**\n\n我们计算 $n=1, 2, 3, 4$ 时 $q_n^2 \\, |\\varphi - p_n/q_n|$ 的值。我们将使用数值 $\\varphi \\approx 1.618034$ 和 $\\frac{1}{\\sqrt{5}} \\approx 0.447214$。\n\n当 $n=1$ 时：\n$q_1 = F_2 = 1$, $p_1 = F_3=2$。\n$q_1^2 \\, |\\varphi - p_1/q_1| = 1^2 |\\varphi - 2/1| = |1.618034 - 2| = |-0.381966| \\approx 0.3820$。\n此值小于 $\\frac{1}{\\sqrt{5}}$。\n\n当 $n=2$ 时：\n$q_2 = F_3 = 2$, $p_2 = F_4=3$。\n$q_2^2 \\, |\\varphi - p_2/q_2| = 2^2 |\\varphi - 3/2| = 4|1.618034 - 1.5| = 4(0.118034) \\approx 0.4721$。\n此值大于 $\\frac{1}{\\sqrt{5}}$。\n\n当 $n=3$ 时：\n$q_3 = F_4 = 3$, $p_3 = F_5=5$。\n$q_3^2 \\, |\\varphi - p_3/q_3| = 3^2 |\\varphi - 5/3| = 9|1.618034 - 1.666667| = 9|-0.048633| \\approx 0.4377$。\n此值小于 $\\frac{1}{\\sqrt{5}}$。\n\n当 $n=4$ 时：\n$q_4 = F_5 = 5$, $p_4 = F_6=8$。\n$q_4^2 \\, |\\varphi - p_4/q_4| = 5^2 |\\varphi - 8/5| = 25|1.618034 - 1.6| = 25(0.018034) \\approx 0.4508$。\n此值大于 $\\frac{1}{\\sqrt{5}}$。\n\n观察到 $q_n^2 \\, |\\varphi - p_n/q_n|$ 的值在常数 $\\frac{1}{\\sqrt{5}}$ 的上下交替。这与连分数理论一致，该理论指出渐近分数交替地小于和大于它们所逼近的无理数。\n\n**2) 闭式表达式**\n\n我们希望找到 $E_n = q_n^2 \\, |\\varphi - p_n/q_n|$ 的闭式表达式。我们首先代入 $p_n=F_{n+2}$ 和 $q_n=F_{n+1}$：\n$$E_n = F_{n+1}^2 \\left|\\varphi - \\frac{F_{n+2}}{F_{n+1}}\\right| = F_{n+1}^2 \\frac{|\\varphi F_{n+1} - F_{n+2}|}{|F_{n+1}|} = |F_{n+1}(\\varphi F_{n+1} - F_{n+2})|$$\n因为当 $n \\ge 1$ 时 $F_{n+1}  0$。\n\n我们来分析 $\\varphi F_{n+1} - F_{n+2}$ 这一项，使用 Binet 公式：\n$$\\varphi F_{n+1} - F_{n+2} = \\varphi \\left(\\frac{\\varphi^{n+1} - \\psi^{n+1}}{\\sqrt{5}}\\right) - \\left(\\frac{\\varphi^{n+2} - \\psi^{n+2}}{\\sqrt{5}}\\right)$$\n$$= \\frac{1}{\\sqrt{5}} \\left( \\varphi^{n+2} - \\varphi\\psi^{n+1} - \\varphi^{n+2} + \\psi^{n+2} \\right) = \\frac{1}{\\sqrt{5}} \\left( \\psi^{n+2} - \\varphi\\psi^{n+1} \\right)$$\n提出因子 $\\psi^{n+1}$：\n$$= \\frac{\\psi^{n+1}}{\\sqrt{5}} (\\psi - \\varphi)$$\n由于 $\\varphi - \\psi = \\frac{1+\\sqrt{5}}{2} - \\frac{1-\\sqrt{5}}{2} = \\sqrt{5}$，我们有 $\\psi - \\varphi = -\\sqrt{5}$。\n所以，$\\varphi F_{n+1} - F_{n+2} = \\frac{\\psi^{n+1}}{\\sqrt{5}}(-\\sqrt{5}) = -\\psi^{n+1}$。\n\n现在将此结果代回 $E_n$ 的表达式中：\n$$E_n = |F_{n+1}(-\\psi^{n+1})| = F_{n+1} |\\psi^{n+1}|$$\n我们再次使用 $F_{n+1}$ 的 Binet 公式：\n$$E_n = \\left(\\frac{\\varphi^{n+1} - \\psi^{n+1}}{\\sqrt{5}}\\right) |\\psi|^{n+1}$$\n注意 $\\psi = -1/\\varphi$，因此 $|\\psi| = 1/\\varphi$。表达式变为：\n$$E_n = \\left(\\frac{\\varphi^{n+1} - \\psi^{n+1}}{\\sqrt{5}}\\right) \\left(\\frac{1}{\\varphi}\\right)^{n+1} = \\frac{1}{\\sqrt{5}} \\left(1 - \\frac{\\psi^{n+1}}{\\varphi^{n+1}}\\right) = \\frac{1}{\\sqrt{5}} \\left(1 - \\left(\\frac{\\psi}{\\varphi}\\right)^{n+1}\\right)$$\n最后，代入 $\\psi/\\varphi = (-1/\\varphi)/\\varphi = -1/\\varphi^2$：\n$$E_n = \\frac{1}{\\sqrt{5}} \\left(1 - \\left(-\\frac{1}{\\varphi^2}\\right)^{n+1}\\right) = \\frac{1}{\\sqrt{5}} \\left(1 - \\frac{(-1)^{n+1}}{\\varphi^{2(n+1)}}\\right)$$\n这就是 $q_n^2 \\, |\\varphi - p_n/q_n|$ 以 $n$ 和 $\\varphi$ 表示的闭式表达式。\n\n**3) 极限及其解释**\n\n我们现在计算第 $2)$ 部分推导出的表达式在 $n \\to \\infty$ 时的极限：\n$$\\lim_{n \\to \\infty} q_n^2 \\, |\\varphi - p_n/q_n| = \\lim_{n \\to \\infty} \\frac{1}{\\sqrt{5}} \\left(1 - \\frac{(-1)^{n+1}}{\\varphi^{2n+2}}\\right)$$\n由于 $\\varphi = \\frac{1+\\sqrt{5}}{2} \\approx 1.618  1$，我们有 $|\\varphi|1$。当 $n \\to \\infty$ 时，分母 $\\varphi^{2n+2} \\to \\infty$。因此，$\\frac{(-1)^{n+1}}{\\varphi^{2n+2}}$ 这一项趋近于 $0$：\n$$\\lim_{n \\to \\infty} \\frac{(-1)^{n+1}}{\\varphi^{2n+2}} = 0$$\n因此极限为：\n$$\\lim_{n \\to \\infty} q_n^2 \\, |\\varphi - p_n/q_n| = \\frac{1}{\\sqrt{5}} (1 - 0) = \\frac{1}{\\sqrt{5}}$$\n\n这个结果是丢番图逼近理论的核心。Hurwitz 定理指出，对于任何无理数 $\\alpha$，存在无穷多个有理数 $\\frac{p}{q}$ 使得 $\\left|\\alpha - \\frac{p}{q}\\right|  \\frac{1}{\\sqrt{5}q^2}$。这个不等式可以改写为 $q^2\\left|\\alpha - \\frac{p}{q}\\right|  \\frac{1}{\\sqrt{5}}$。常数 $\\sqrt{5}$ 是最佳的，意味着如果将 $\\sqrt{5}$ 替换为任何更大的常数 $C > \\sqrt{5}$，该定理将不成立。\n\n我们的计算表明，对于无理数 $\\alpha = \\varphi$，其最佳有理逼近（即其渐近分数 $\\frac{p_n}{q_n}$）所产生的 $q_n^2|\\varphi - p_n/q_n|$ 的值恰好收敛到 $\\frac{1}{\\sqrt{5}}$。这意味着对于任何 $\\epsilon  0$，只有有限个有理数 $\\frac{p}{q}$ 满足 $|\\varphi - \\frac{p}{q}|  \\frac{1}{(\\sqrt{5}+\\epsilon)q^2}$，因为对于所有足够大的 $n$，我们有 $q_n^2|\\varphi - p_n/q_n| > \\frac{1}{\\sqrt{5}+\\epsilon}$。这证明了对于 $\\varphi$ 这样的数，Hurwitz 定理中的常数 $\\sqrt{5}$ 无法被改进，从而确立了该常数的最佳性。在这个意义上，$\\varphi$ 是最难被有理数逼近的无理数。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}}$$", "id": "3084017"}, {"introduction": "前面的实践建立了好的逼近就是连分数收敛子的思想。勒让德判据提供了一个精确的条件：如果 $|\\alpha - p/q| \\lt 1/(2q^2)$，那么 $p/q$ *必须* 是一个收敛子。本练习挑战您去研究等号成立的“临界”情况。通过反证法，您将证明对于任何无理数 $\\alpha$，等式 $|\\alpha - p/q| = 1/(2q^2)$ 永远不能成立，从而揭示有理逼近中一个令人惊讶的微妙特性。这个实践旨在磨练严谨的演绎推理能力。[@problem_id:3084006]", "problem": "设 $\\alpha$ 是一个无理实数，设 $p/q \\in \\mathbb{Q}$ 是最简分数，其中 $\\operatorname{gcd}(p,q)=1$ 且 $q \\geq 1$。在丢番图逼近理论中，狄利克雷定理保证了存在无穷多个有理逼近 $p/q$ 满足 $|\\alpha - p/q|  1/q^{2}$，而赫维茨定理将其加强为 $|\\alpha - p/q|  1/(\\sqrt{5}\\,q^{2})$ 无穷多次成立。一个由勒让德提出的经典改进断言，如果 $|\\alpha - p/q|  1/(2 q^{2})$，那么 $p/q$ 必定是 $\\alpha$ 的简单连分数展开中的一个收敛子（convergent）。分析临界情况\n$$\n\\left|\\alpha - \\frac{p}{q}\\right| \\;=\\; \\frac{1}{2 q^{2}}\n$$\n并判断下列哪个陈述是正确的。你的论证应从基本定义（连分数、收敛子和 $\\alpha$ 的无理性）出发，并且除了这些基本事实外，不应假设任何特殊情况的公式。\n\nA. 对于任何无理数 $\\alpha$，等式 $\\left|\\alpha - \\frac{p}{q}\\right| = \\frac{1}{2 q^{2}}$ 对任何最简分数 $p/q$ 都不成立；因此，“临界情况”在无理数设定下是空洞的。\n\nB. 如果等式 $\\left|\\alpha - \\frac{p}{q}\\right| = \\frac{1}{2 q^{2}}$ 对一个无理数 $\\alpha$ 成立，那么 $p/q$ 必定是 $\\alpha$ 的一个收敛子。\n\nC. 存在一个无理数 $\\alpha$ 和一个不是收敛子的最简分数 $p/q$，使得 $\\left|\\alpha - \\frac{p}{q}\\right| = \\frac{1}{2 q^{2}}$。\n\nD. 对于每个无理数 $\\alpha$，存在无穷多个收敛子 $p/q$ 满足 $\\left|\\alpha - \\frac{p}{q}\\right| = \\frac{1}{2 q^{2}}$。\n\n选择正确的选项，并从第一性原理出发证明你的选择。", "solution": "问题要求我们分析对于一个无理数 $\\alpha$ 和一个最简有理数 $p/q$ 的等式 $|\\alpha - p/q| = 1/(2q^2)$。我将通过考虑有理逼近 $p/q$ 的两种穷尽情况来分析此等式的有效性：它要么是 $\\alpha$ 的简单连分数展开中的一个收敛子，要么不是。\n\n设无理数 $\\alpha$ 的简单连分数展开为 $\\alpha = [a_0; a_1, a_2, \\dots]$，其中 $a_0 \\in \\mathbb{Z}$ 且当 $i \\ge 1$ 时 $a_i \\in \\mathbb{Z}_{0}$。$\\alpha$ 的收敛子记为 $p_n/q_n = [a_0; a_1, \\dots, a_n]$。数 $p_n$ 和 $q_n$ 是由以下递推关系定义的整数：\n$p_n = a_n p_{n-1} + p_{n-2}$\n$q_n = a_n q_{n-1} + q_{n-2}$\n初始条件为 $p_{-1}=1, q_{-1}=0$ 和 $p_0=a_0, q_0=1$。\n\n$\\alpha$ 的完全商（complete quotients）定义为 $\\alpha_n = [a_n; a_{n+1}, a_{n+2}, \\dots]$。对于任何 $n \\ge 0$，$\\alpha_n$ 是一个无理数，并且当 $n \\ge 1$ 时 $\\alpha_n  1$。$\\alpha$ 可以用其收敛子和完全商表示为：\n$$ \\alpha = \\frac{\\alpha_{n+1} p_n + p_{n-1}}{\\alpha_{n+1} q_n + q_{n-1}} $$\n\n由此，可以推导出收敛子逼近误差的基本公式：\n$$ \\alpha - \\frac{p_n}{q_n} = \\frac{\\alpha_{n+1} p_n + p_{n-1}}{\\alpha_{n+1} q_n + q_{n-1}} - \\frac{p_n}{q_n} = \\frac{p_{n-1}q_n - p_n q_{n-1}}{q_n(\\alpha_{n+1} q_n + q_{n-1})} $$\n一个从递推关系推导出的标准恒等式是 $p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1}$。因此：\n$$ \\left|\\alpha - \\frac{p_n}{q_n}\\right| = \\frac{1}{q_n(\\alpha_{n+1} q_n + q_{n-1})} = \\frac{1}{q_n^2(\\alpha_{n+1} + q_{n-1}/q_n)} $$\n\n现在，我们根据 $p/q$ 是否为收敛子来分析这个问题。\n\n**情况1：假设 $p/q$ 是 $\\alpha$ 的一个收敛子。**\n设 $p/q = p_n/q_n$ 对于某个 $n \\ge 0$。我们检验给定的等式：\n$$ \\left|\\alpha - \\frac{p_n}{q_n}\\right| = \\frac{1}{2q_n^2} $$\n代入误差公式：\n$$ \\frac{1}{q_n^2(\\alpha_{n+1} + q_{n-1}/q_n)} = \\frac{1}{2q_n^2} $$\n这可以简化为：\n$$ \\alpha_{n+1} + \\frac{q_{n-1}}{q_n} = 2 $$\n根据定义，$\\alpha$ 是一个无理数。因此，它的所有完全商 $\\alpha_{n+1} = [a_{n+1}; a_{n+2}, \\dots]$ 也都是无理数。数字 $q_n$ 和 $q_{n-1}$ 是整数，所以它们的比值 $q_{n-1}/q_n$ 是一个有理数。一个无理数 ($\\alpha_{n+1}$) 与一个有理数 ($q_{n-1}/q_n$) 的和总是一个无理数。然而，数字 $2$ 是有理数。一个无理数不能等于一个有理数。\n这是一个矛盾。因此，如果 $p/q$ 是 $\\alpha$ 的一个收敛子，则等式 $|\\alpha - p/q| = 1/(2q^2)$ 永远不能成立。\n\n这个发现立即让我们能够评估选项 B 和 D。\n-   **选项 B：** 陈述如果等式成立，$p/q$ 必定是一个收敛子。我们的分析显示了相反的情况：它*不能*是收敛子。因此，B 是**不正确**的。\n-   **选项 D：** 陈述存在无穷多个收敛子满足该等式。由于没有收敛子能满足它，这是**不正确**的。\n\n**情况2：假设 $p/q$ 不是 $\\alpha$ 的一个收敛子。**\n丢番图逼近中的一个关键定理（Borel 的一个结果，是 Legendre 定理的扩展）指出，任何满足 $|\\alpha - p/q|  1/(2q^2)$ 的有理逼近 $p/q$ 必须是 $\\alpha$ 的一个收敛子。因此，如果我们的等式成立，那么它不满足这个严格不等式，所以该定理不能直接应用。然而，一个更一般的结果是，任何“足够好”的逼近，要么是收敛子，要么是“中间分数”（intermediate fraction）（也称为中介分数 (mediant)）。任何满足 $|\\alpha - p/q|  1/q^2$ 的分数都是其中之一。因为 $1/2  1$，任何满足临界等式的分数都必须是这种类型。因为我们已经排除了收敛子，所以这样的 $p/q$ 必定是一个中间分数。\n\n一个中间分数的形式为 $p/q = \\frac{c p_k + p_{k-1}}{c q_k + q_{k-1}}$，对于某个 $k \\ge 0$ 和一个整数 $c$ 满足 $1 \\le c  a_{k+1}$。\n我们来分析这样一个分数的逼近误差。\n$$ \\alpha - \\frac{p}{q} = \\alpha - \\frac{c p_k + p_{k-1}}{c q_k + q_{k-1}} = \\frac{\\alpha_{k+1}p_k+p_{k-1}}{\\alpha_{k+1}q_k+q_{k-1}} - \\frac{c p_k + p_{k-1}}{c q_k + q_{k-1}} $$\n这个差的分子是：\n$$ (\\alpha_{k+1}p_k+p_{k-1})(cq_k+q_{k-1}) - (cp_k+p_{k-1})(\\alpha_{k+1}q_k+q_{k-1}) \\\\ = (\\alpha_{k+1}-c)(p_k q_{k-1} - p_{k-1} q_k) = (\\alpha_{k+1}-c)(-1)^{k-1} $$\n分母是 $(c q_k + q_{k-1})(\\alpha_{k+1} q_k + q_{k-1}) = q(\\alpha_{k+1} q_k + q_{k-1})$。\n所以，误差是：\n$$ \\left|\\alpha - \\frac{p}{q}\\right| = \\frac{|\\alpha_{k+1}-c|}{q(\\alpha_{k+1} q_k + q_{k-1})} $$\n因为 $c$ 是一个整数且 $c  a_{k+1} = \\lfloor \\alpha_{k+1} \\rfloor$，我们有 $\\alpha_{k+1} - c > 0$。所以 $|\\alpha_{k+1}-c|=\\alpha_{k+1}-c$。\n我们令它等于 $1/(2q^2)$：\n$$ \\frac{\\alpha_{k+1}-c}{q(\\alpha_{k+1} q_k + q_{k-1})} = \\frac{1}{2q^2} \\implies 2q(\\alpha_{k+1}-c) = \\alpha_{k+1} q_k + q_{k-1} $$\n代入 $q = c q_k + q_{k-1}$：\n$$ 2(c q_k + q_{k-1})(\\alpha_{k+1}-c) = \\alpha_{k+1} q_k + q_{k-1} $$\n我们展开并求解 $\\alpha_{k+1}$：\n$$ 2c\\alpha_{k+1}q_k - 2c^2q_k + 2\\alpha_{k+1}q_{k-1} - 2cq_{k-1} = \\alpha_{k+1} q_k + q_{k-1} \\\\ \\alpha_{k+1}(2cq_k + 2q_{k-1} - q_k) = 2c^2q_k + 2cq_{k-1} + q_{k-1} \\\\ \\alpha_{k+1}((2c-1)q_k + 2q_{k-1}) = 2c^2q_k + (2c+1)q_{k-1} $$\n$$ \\alpha_{k+1} = \\frac{2c^2q_k + (2c+1)q_{k-1}}{(2c-1)q_k + 2q_{k-1}} $$\n该等式的右边是整数 $c, q_k, q_{k-1}$ 的有理函数。由于 $c \\ge 1$，$q_k > q_{k-1} \\ge 1$（对于 $k \\ge 1$），分母是一个正整数。因此，右边是一个有理数。\n然而，左边的 $\\alpha_{k+1}$ 是一个无理数 $\\alpha$ 的完全商，因此它必须是无理数。\n这是一个矛盾。一个无理数不能等于一个有理数。\n\n因此，等式 $|\\alpha - p/q| = 1/(2q^2)$ 对于一个中间分数也不成立。由于任何满足此条件的分数必须是一个收敛子或一个中间分数，而两者都不可能，我们必须得出结论：最初假设存在这样一个分数的想法是错误的。\n\n这让我们能够评估选项 A 和 C。\n-   **选项 C：** 陈述存在一个无理数 $\\alpha$ 和一个非收敛子 $p/q$ 满足该等式。我们的分析表明这会导致矛盾。因此，C 是**不正确**的。\n-   **选项 A：** 陈述对于任何最简分数 $p/q$ 和任何无理数 $\\alpha$，该等式都不成立。这个结论得到了我们对两种情况（收敛子和非收敛子）的推导的支持，这两种情况穷尽了所有相关的可能性。因此，该等式代表了一个空洞的情况。A 是**正确**的。\n\n我的分析严格基于所要求的连分数的第一性原理，表明对于任何无理数 $\\alpha$，等式 $|\\alpha - p/q| = 1/(2q^2)$ 对于任何有理数 $p/q$ 都是不可能的。\n\n各选项的结论摘要：\nA. **正确**。假设该等式对一个无理数 $\\alpha$ 成立，会在所有可能的 $p/q$ 情况下导致矛盾。\nB. **不正确**。该等式不能对一个收敛子成立。\nC. **不正确**。该等式不能对中介分数类型的非收敛逼近成立，而它们是唯一的候选者。\nD. **不正确**。该等式不能对任何收敛子成立，更不用说无穷多个了。", "answer": "$$\\boxed{A}$$", "id": "3084006"}]}