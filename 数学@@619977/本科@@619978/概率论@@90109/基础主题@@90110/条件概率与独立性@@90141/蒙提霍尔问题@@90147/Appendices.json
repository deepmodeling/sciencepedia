{"hands_on_practices": [{"introduction": "让我们从一个经典蒙提霍尔问题的变体开始，将三扇门扩展到五扇。这个练习旨在巩固您对条件概率和总概率定律的理解。通过解决这个具体问题，您将亲身体验到，即使在规则稍有改变的情况下，支撑蒙提霍尔问题反直觉结论的核心逻辑依然适用。[@problem_id:1402148]", "problem": "一个热门的电视游戏节目向一位参赛者提供了五扇相同且关闭的门供其选择。一扇门后是一辆全新的汽车，另外四扇门后是山羊。参赛者的目标是选中有汽车的那扇门。\n\n游戏按以下阶段进行：\n1.  参赛者做出初始选择，从五扇门中选择一扇。\n2.  知道汽车位置的游戏节目主持人，会打开另外四扇门中的两扇。主持人总是选择后面是山羊的门。\n3.  在主持人展示了两只山羊之后，剩下三扇关闭的门：参赛者最初选择的门，以及另外两扇未打开的门。\n4.  参赛者可以选择坚持自己最初的选择，或者换到另外两扇未打开的门中的一扇。\n\n假设参赛者决定更换选择。他们的更换策略是，从另外两扇可用的关闭的门中选择一扇，并且选择这两扇门中任意一扇的概率相等。参赛者赢得汽车的概率是多少？\n\n请将你的答案表示为最简精确分数。", "solution": "设 $A$ 为初始选择是汽车的事件，$B$ 为初始选择是山羊的事件。设 $W$ 为参赛者在所述更换策略（在另外两扇未打开的门之间等可能地随机选择一扇）下获胜的事件。初始概率为 $P(A)=\\frac{1}{5}$ 和 $P(B)=\\frac{4}{5}$。\n\n如果事件 $A$ 发生，那么另外四扇门后都是山羊。主持人打开两扇有山羊的门，剩下两扇未打开的门，这两扇门后也都是山羊。换到这两扇门中的任意一扇都会导致失败，所以 $P(W \\mid A)=0$。\n\n如果事件 $B$ 发生，那么在另外四扇门中，恰好有一扇门后是汽车，三扇门后是山羊。主持人打开两扇有山羊的门，剩下两扇未打开的门，其中恰好一扇是汽车。然后参赛者在这两扇门之间等可能地选择，所以 $P(W \\mid B)=\\frac{1}{2}$。\n\n根据全概率公式，\n$$\nP(W)=P(W \\mid A)P(A)+P(W \\mid B)P(B)=0 \\cdot \\frac{1}{5}+\\frac{1}{2}\\cdot \\frac{4}{5}=\\frac{2}{5}.\n$$", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "1402148"}, {"introduction": "在解决了具体的五门问题后，下一步是挑战自己，将问题推广到一般情况。这个练习要求您为有 $N$ 扇门的游戏推导出一个通用的获胜概率公式。这不仅是对您代数能力的考验，更是对您是否能将概率原则从特定数字中抽象出来的深度检验。[@problem_id:1402141]", "problem": "一个名为“Galaxy of Gates”的未来主义游戏节目，已成为已知宇宙中最受欢迎的广播。其规则是一个经典概率谜题的宇宙尺度版本。有 $N$ 个完全相同的不透明传送门排成一圈，其中 $N$ 是一个整数且 $N \\ge 3$。其中一扇传送门后面藏着大奖：一艘具备超空间能力的星舰。其他 $N-1$ 扇传送门后面是毫无价值的彗星。\n\n作为参赛者，你选择一扇传送门。在你做出选择后，节目的主持人，一个名为“The Arbiter”的近乎全知的存在，他知道星舰在哪里，会打开*恰好一扇*其他的传送门。The Arbiter 总会打开一扇后面是彗星的传送门。在这次揭示之后，除了你最初的选择，还剩下 $N-2$ 扇未打开的传送门。\n\n现在，你获得了更换选择的机会。你决定始终采用“更换”策略：你将放弃你最初选择的传送门，并从其他 $N-2$ 扇未打开的传送门中随机均匀地选择一扇。\n\n请推导你赢得星舰的概率作为 $N$ 的函数的通用表达式。", "solution": "假设有 $N$ 扇传送门，其中只有一个有奖。你最初选择一扇传送门。The Arbiter 会打开另外一扇传送门以展示一颗彗星，除了你最初的选择外，还剩下 $N-2$ 扇未打开的传送门。然后你通过从这 $N-2$ 扇传送门中随机均匀地选择一扇来进行更换。\n\n通过以你最初的选择是否正确为条件来计算获胜概率。\n\n如果最初的选择就是奖品（概率为 $\\frac{1}{N}$），那么在 The Arbiter 打开一扇有彗星的门后，所有其他 $N-2$ 扇未打开的传送门后面都是彗星。更换选择会从这 $N-2$ 颗彗星中挑选，因此在这种情况下获胜的条件概率是 $0$。\n\n如果最初的选择是彗星（概率为 $\\frac{N-1}{N}$），那么在剩下的 $N-2$ 扇未打开的传送门（不包括你最初的选择和 The Arbiter 打开的那扇）中，恰好有一扇藏着奖品。由于你从这 $N-2$ 扇传送门中随机均匀地选择，因此获胜的条件概率是 $\\frac{1}{N-2}$。\n\n根据全概率定律，更换选择时的总获胜概率是\n$$\n\\frac{1}{N}\\cdot 0+\\frac{N-1}{N}\\cdot\\frac{1}{N-2}=\\frac{N-1}{N(N-2)}.\n$$", "answer": "$$\\boxed{\\frac{N-1}{N\\left(N-2\\right)}}$$", "id": "1402141"}, {"introduction": "理论推导是强大的，但我们如何凭经验验证我们的答案呢？这个练习将带您进入计算思维的领域，要求您设计一个蒙特卡洛模拟来估算获胜概率。通过将概率规则转化为算法步骤，您不仅能加深对问题本身的理解，还能掌握一种在科学和工程领域验证理论模型的有力工具。[@problem_id:1402172]", "problem": "一个著名的游戏节目被推广为包含 $N$ 扇相同的门。其中一扇门后是贵重奖品，另外 $N-1$ 扇门后是山羊。参赛者不知道奖品在哪里。游戏按以下步骤进行：\n1.  参赛者做出初始选择，挑选 $N$ 扇门中的一扇。\n2.  知道奖品位置的主持人，接着会打开另外 $k$ 扇门，其中 $1 \\le k \\le N-2$。主持人打开的门保证会露出山羊。\n3.  然后参赛者获得一个选择机会：要么坚持他们最初的选择，要么换到另一扇仍然关闭的门。\n\n我们关心的是“更换策略”，即参赛者总是放弃他们最初的选择，并从其余仍然关闭的门中随机挑选一扇。你的任务是识别出正确的算法，该算法用于设计一个蒙特卡洛模拟，以估计当参赛者采用这种更换策略时获胜的概率。\n\n设 `num_trials` 为模拟运行的总次数。下列哪个算法正确地估计了获胜概率？\n\nA. 初始化 `wins` = 0。对于 `i` 从 1 到 `num_trials`：\n   1. 随机将奖品分配到 1 到 $N$ 的一扇门后。\n   2. 随机选择参赛者的初始门。\n   3. 识别出 $N-1$ 扇非参赛者选择的门。主持人从这个集合中随机打开 $k$ 扇门。\n   4. 识别出剩余的关闭门集合。参赛者从这个集合中随机选择一扇新门。\n   5. 如果参赛者的新门有奖品，则 `wins` 加 1。\n   估计的概率为 `wins` / `num_trials`。\n\nB. 初始化 `wins` = 0。对于 `i` 从 1 到 `num_trials`：\n   1. 随机将奖品分配到 1 到 $N$ 的一扇门后。\n   2. 随机选择参赛者的初始门。\n   3. 识别出不含奖品且非参赛者选择的门集合。主持人从这个集合中随机打开 $k$ 扇门。\n   4. 识别出所有未被主持人打开的门集合。参赛者从这个集合中随机选择一扇新门。\n   5. 如果参赛者的新门有奖品，则 `wins` 加 1。\n   估计的概率为 `wins` / `num_trials`。\n\nC. 初始化 `wins` = 0。初始化 `valid_trials` = 0。当 `valid_trials`  `num_trials` 时：\n   1. 随机将奖品分配到 1 到 $N$ 的一扇门后。\n   2. 随机选择参赛者的初始门。\n   3. 如果参赛者的初始选择是奖品门，则丢弃此次试验并继续下一次迭代。\n   4. 识别出不含奖品且非参赛者选择的门集合。主持人从这个集合中随机打开 $k$ 扇门。\n   5. 识别出未被主持人打开且非参赛者初始选择的门集合。参赛者从这个集合中随机选择一扇门。\n   6. 如果参赛者的新门有奖品，则 `wins` 加 1。\n   7. `valid_trials` 加 1。\n   估计的概率为 `wins` / `valid_trials`。\n\nD. 初始化 `wins` = 0。对于 `i` 从 1 到 `num_trials`：\n   1. 随机将奖品分配到 1 到 $N$ 的一扇门后。\n   2. 随机选择参赛者的初始门。\n   3. 识别出不含奖品且非参赛者选择的门集合。主持人从这个集合中随机打开 $k$ 扇门。\n   4. 识别出未被主持人打开且非参赛者初始选择的门集合。参赛者从这个集合中随机选择一扇门。\n   5. 如果参赛者的新门有奖品，则 `wins` 加 1。\n   估计的概率为 `wins` / `num_trials`。", "solution": "令门由集合 $D=\\{1,2,\\dots,N\\}$ 标记。奖品位置 $P$ 在 $D$ 上均匀选择，参赛者的初始选择 $C$ 也在 $D$ 上均匀选择，且与 $P$ 无关。主持人知道 $P$ 并打开 $k$ 扇门，每扇门都保证会露出山羊；因此，每扇被打开的门都必须位于 $D\\setminus\\{C,P\\}$ 中。在主持人打开 $k$ 扇这样的门之后，仍然关闭的门的集合是 $D$ 减去那 $k$ 扇被打开的门。更换策略要求参赛者放弃 $C$，并从除了 $C$ 以外的其余关闭的门中均匀随机地选择一扇。\n\n在更换策略下，获胜的概率推导如下。如果 $C=P$，那么除了 $C$ 之外没有门后有奖品，所以更换策略的失败概率为 $1$。如果 $C \\neq P$，那么在保持关闭且不是 $C$ 的门中，恰好有一扇门后有奖品。这种门的总数是 $N-k-1$，所以在 $C \\neq P$ 的条件下，获胜的条件概率是 $1/(N-k-1)$。使用全概率公式，并且已知 $\\Pr(C \\neq P)=(N-1)/N$，无条件获胜概率是\n$$\n\\Pr(\\text{win by switching})=\\frac{N-1}{N}\\cdot\\frac{1}{N-k-1}.\n$$\n一个正确的蒙特卡洛算法必须复现主持人的约束条件和更换规则，以估计这个概率。\n\n算法 A 是不正确的，因为步骤3允许主持人从 $D\\setminus\\{C\\}$ 中选择 $k$ 扇门打开，但没有排除 $P$。这使得当 $C \\neq P$ 时，主持人打开有奖品的门的概率为正，这违反了主持人打开的门保证是山羊的规则，因此会使模拟产生偏差。\n\n算法 B 在步骤3中正确地将主持人打开的门限制在 $D\\setminus\\{C,P\\}$ 内，但是步骤4让参赛者从所有未被主持人打开的门中（即从 $D$ 中减去 $k$ 扇已打开的门）均匀选择。这个集合的大小为 $N-k$，并且包含了最初的选择 $C$。因此，参赛者将以 $1/(N-k)$ 的概率无意中“坚持”选择 $C$，这造成了坚持和更换行为的混合，而不是纯粹的更换策略。因此，它不能估计所求的概率。\n\n算法 C 通过丢弃 $C=P$ 的试验，使模拟以 $C \\neq P$ 为条件。在这种情况下，测得的成功率收敛于条件概率 $1/(N-k-1)$，而不是无条件获胜概率 $\\frac{N-1}{N}\\cdot\\frac{1}{N-k-1}$。由于要求估计的是无条件概率，因此该算法所述是不正确的。\n\n算法 D 强制执行了两个必要条件：主持人从 $D\\setminus\\{C,P\\}$（保证是山羊）中打开 $k$ 扇门，然后参赛者从排除掉主持人和自己初选的门的其余关闭门中（即从一个大小为 $N-k-1$ 的集合中）进行均匀选择。这实现了纯粹的更换策略，并对正确的获胜概率 $\\frac{N-1}{N}\\cdot\\frac{1}{N-k-1}$ 产生了一致的蒙特卡洛估计。\n\n因此，正确的算法是 D。", "answer": "$$\\boxed{D}$$", "id": "1402172"}]}