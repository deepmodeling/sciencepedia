{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，这个练习涉及独立随机变量的变换。此问题探讨了倒数变换，这是信号处理等领域中的一种常见操作 [@problem_id:1408113]。通过解决这个例子，你将在一个清晰的场景中应用雅可比方法，并发现柯西分布在倒数运算下非凡的“再生”性质。", "problem": "在信号处理的一个特定分支中，信号有时会通过遵循柯西分布的随机变量来建模。考虑两个独立的信号，其随机振幅 $X$ 和 $Y$ 各自服从标准柯西分布。一个标准柯西随机变量 $Z$ 的概率密度函数 (PDF) 由下式给出\n$$f_Z(z) = \\frac{1}{\\pi(1+z^2)}, \\quad \\text{for } -\\infty < z < \\infty$$\n通过取原始信号振幅的倒数，生成一组新的变量 $U$ 和 $V$，使得 $U = 1/X$ 和 $V = 1/Y$。求变换后变量 $U$ 和 $V$ 的联合概率密度函数 $f_{U,V}(u,v)$。", "solution": "设 $X$ 和 $Y$ 为独立的标准柯西随机变量，其联合密度为\n$$\nf_{X,Y}(x,y)=\\frac{1}{\\pi^{2}(1+x^{2})(1+y^{2})}, \\quad -\\infty<x<\\infty,\\ -\\infty<y<\\infty.\n$$\n定义变换 $U=1/X$ 和 $V=1/Y$。其反向映射为 $x=1/u$ 和 $y=1/v$。该反向映射的雅可比矩阵为\n$$\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\\n\\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{u^{2}} & 0 \\\\\n0 & -\\frac{1}{v^{2}}\n\\end{pmatrix},\n$$\n因此其行列式的绝对值为\n$$\n|J|=\\left|(-\\frac{1}{u^{2}})(-\\frac{1}{v^{2}})\\right|=\\frac{1}{u^{2}v^{2}}.\n$$\n根据变量替换公式，\n$$\nf_{U,V}(u,v)=f_{X,Y}\\!\\left(\\frac{1}{u},\\frac{1}{v}\\right)\\cdot\\frac{1}{u^{2}v^{2}}.\n$$\n代入 $f_{X,Y}$ 并化简，\n$$\nf_{U,V}(u,v)=\\frac{1}{\\pi^{2}\\left(1+\\frac{1}{u^{2}}\\right)\\left(1+\\frac{1}{v^{2}}\\right)}\\cdot\\frac{1}{u^{2}v^{2}}\n=\\frac{1}{\\pi^{2}(u^{2}+1)(v^{2}+1)}, \\quad -\\infty<u<\\infty,\\ -\\infty<v<\\infty.\n$$\n等价地，可以注意到 $U=g(X)$ 和 $V=h(Y)$，其中 $g(x)=1/x$ 和 $h(y)=1/y$。由于 $X$ 和 $Y$ 是独立的，因此 $U$ 和 $V$ 也是独立的，并且 $U$ 的边缘密度函数为\n$$\nf_{U}(u)=f_{X}\\!\\left(\\frac{1}{u}\\right)\\cdot\\left|\\frac{d}{du}\\left(\\frac{1}{u}\\right)\\right|=\\frac{1}{\\pi\\left(1+\\frac{1}{u^{2}}\\right)}\\cdot\\frac{1}{u^{2}}=\\frac{1}{\\pi(1+u^{2})},\n$$\n对 $V$ 也类似。因此 $f_{U,V}(u,v)=f_{U}(u)f_{V}(v)=\\frac{1}{\\pi^{2}(1+u^{2})(1+v^{2})}$，这与变量替换的结果一致。", "answer": "$$\\boxed{\\frac{1}{\\pi^{2}\\left(1+u^{2}\\right)\\left(1+v^{2}\\right)}}$$", "id": "1408113"}, {"introduction": "现实世界中的变换通常不是一对一的。这个练习引入了这种复杂性，探讨了一种不同的初始状态对 $(x,y)$ 会导致相同结果对 $(u,v)$ 的变换 [@problem_id:1408158]。从作为概率论基石的两个独立标准正态变量出发，你将学习一项关键技术：如何通过对所有可能的原像（preimages）进行求和，来找到正确的联合概率密度函数。", "problem": "设 $X$ 和 $Y$ 为相互独立的随机变量，均服从标准正态分布。我们通过以下变换定义两个新的随机变量 $U$ 和 $V$：\n$$U = X^2$$\n$$V = X+Y$$\n求其联合概率密度函数 (PDF) $f_{U,V}(u,v)$，其中 $u > 0$ 且 $v$ 为任意实数。", "solution": "设 $X$ 和 $Y$ 是相互独立的标准正态随机变量，因此它们的联合概率密度函数为\n$$\nf_{X,Y}(x,y)=\\frac{1}{2\\pi}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2}\\right).\n$$\n定义变换\n$$\nu=x^{2},\\qquad v=x+y.\n$$\n对于任意满足 $u>0$ 和 $v\\in\\mathbb{R}$ 的 $(u,v)$，该映射的原像由下式给出\n$$\nx=\\pm\\sqrt{u},\\qquad y=v-x.\n$$\n变换 $(x,y)\\mapsto(u,v)$ 的雅可比行列式为\n$$\nJ(x,y)=\\det\\begin{pmatrix}\n\\frac{\\partial u}{\\partial x} & \\frac{\\partial u}{\\partial y} \\\\ [4pt]\n\\frac{\\partial v}{\\partial x} & \\frac{\\partial v}{\\partial y}\n\\end{pmatrix}\n=\\det\\begin{pmatrix}\n2x & 0 \\\\ [4pt]\n1 & 1\n\\end{pmatrix}\n=2x,\n$$\n因此，对于每个分支 $x=\\pm\\sqrt{u}$，雅可比行列式的绝对值为 $|J|=2|x|=2\\sqrt{u}$。根据有限对一变换的变量替换公式，\n$$\nf_{U,V}(u,v)=\\sum_{x=\\pm\\sqrt{u}}\\frac{f_{X,Y}\\bigl(x,\\,v-x\\bigr)}{|2x|},\\qquad u>0.\n$$\n代入 $f_{X,Y}$ 并化简指数部分，\n$$\nx^{2}+(v-x)^{2}=v^{2}+2u-2vx,\n$$\n我们得到\n$$\nf_{U,V}(u,v)=\\sum_{x=\\pm\\sqrt{u}}\\frac{1}{2\\pi}\\exp\\!\\left(-\\frac{v^{2}+2u-2vx}{2}\\right)\\frac{1}{2\\sqrt{u}}\n=\\frac{1}{4\\pi\\sqrt{u}}\\exp\\!\\left(-u-\\frac{v^{2}}{2}\\right)\\sum_{x=\\pm\\sqrt{u}}\\exp(vx).\n$$\n代入 $x=\\pm\\sqrt{u}$ 可得 $\\sum_{x=\\pm\\sqrt{u}}\\exp(vx)=\\exp\\!\\left(v\\sqrt{u}\\right)+\\exp\\!\\left(-v\\sqrt{u}\\right)=2\\cosh\\!\\left(v\\sqrt{u}\\right)$。因此，\n$$\nf_{U,V}(u,v)=\\frac{1}{2\\pi\\sqrt{u}}\\exp\\!\\left(-u-\\frac{v^{2}}{2}\\right)\\cosh\\!\\left(v\\sqrt{u}\\right),\\qquad u>0,\\ v\\in\\mathbb{R},\n$$\n当 $u\\leq 0$ 时，$f_{U,V}(u,v)=0$。作为验证，对 $v$ 进行积分可以得到 $U$ 的边缘分布，即自由度为 1 的 $\\chi^{2}$ 分布：\n$$\n\\int_{-\\infty}^{\\infty}f_{U,V}(u,v)\\,dv=\\frac{1}{\\sqrt{2\\pi u}}\\exp\\!\\left(-\\frac{u}{2}\\right),\\qquad u>0,\n$$\n这验证了所求联合密度的正确性。", "answer": "$$\\boxed{\\frac{1}{2\\pi\\sqrt{u}}\\,\\exp\\!\\left(-u-\\frac{v^{2}}{2}\\right)\\,\\cosh\\!\\left(v\\sqrt{u}\\right)\\text{，其中 }u>0,\\ v\\in\\mathbb{R}}$$", "id": "1408158"}, {"introduction": "我们最后的练习题将多个关键概念融合成一个全面的综合性问题。在这里，我们从非独立的随机变量开始，这要求你首先根据条件概率和边缘概率构建它们的联合分布 [@problem_id:1408142]。随后，你将对一个类似于从极坐标到笛卡尔坐标转换的变换应用雅可比方法——这是物理学和工程学中的一个基本概念——以求得最终的联合概率密度函数。", "problem": "设 $X$ 和 $Y$ 为两个连续随机变量。变量 $X$ 在区间 $[0, \\pi]$ 上服从均匀分布。在给定 $X=x$ 的条件下，$Y$ 的条件分布是指数分布，其速率参数为 $\\lambda(x) = \\sin(x)$。\n\n由以下变换定义了两个新的随机变量 $U$ 和 $V$：\n$$U = Y \\sin(X)$$\n$$V = Y \\cos(X)$$\n\n求随机变量 $U$ 和 $V$ 的联合概率密度函数 (PDF)，记作 $f_{U,V}(u,v)$。你的最终答案应该是函数 $f_{U,V}(u,v)$ 在其支撑域上的一个单一闭式解析表达式。", "solution": "求解过程首先确定 $X$ 和 $Y$ 的联合概率密度函数 (PDF)，然后使用雅可比方法应用变量替换公式。\n\n**第一步：求 X 和 Y 的联合 PDF**\n\n$X$ 的 PDF，其在 $[0, \\pi]$ 上服从均匀分布，由下式给出：\n$$f_X(x) = \\begin{cases} \\frac{1}{\\pi} & \\text{若 } 0 \\le x \\le \\pi \\\\ 0 & \\text{其他} \\end{cases}$$\n\n给定 $X=x$ 时 $Y$ 的条件 PDF 是速率为 $\\lambda(x) = \\sin(x)$ 的指数分布。速率必须为正，因此我们考虑 $x \\in (0, \\pi)$。$X$ 精确等于 $0$ 或 $\\pi$ 的概率为零，所以这个限制不影响计算。对于 $x \\in (0, \\pi)$，条件 PDF 为：\n$$f_{Y|X}(y|x) = \\sin(x) \\exp(-y \\sin(x)), \\quad \\text{对于 } y > 0$$\n\n联合 PDF $f_{X,Y}(x,y)$ 是 $X$ 的边缘 PDF 与给定 $X$ 时 $Y$ 的条件 PDF 的乘积：\n$$f_{X,Y}(x,y) = f_{Y|X}(y|x) f_X(x)$$\n$$f_{X,Y}(x,y) = \\frac{\\sin(x)}{\\pi} \\exp(-y \\sin(x))$$\n该联合 PDF 的支撑域是区域 $S_{X,Y} = \\{ (x,y) \\in \\mathbb{R}^2 \\mid 0 < x < \\pi, y > 0 \\}$。\n\n**第二步：定义逆变换**\n\n从 $(X,Y)$ 到 $(U,V)$ 的变换由下式给出：\n$U = Y \\sin(X)$\n$V = Y \\cos(X)$\n\n我们需要找到逆变换，即用 $U$ 和 $V$ 来表示 $X$ 和 $Y$。\n首先，我们来求 $Y$。通过将两个方程平方并相加，我们得到：\n$$U^2 + V^2 = (Y \\sin(X))^2 + (Y \\cos(X))^2 = Y^2 (\\sin^2(X) + \\cos^2(X)) = Y^2$$\n因为 $Y > 0$，我们可以写成：\n$$Y = \\sqrt{U^2 + V^2}$$\n\n接下来，我们来求 $X$。我们有 $\\cos(X) = \\frac{V}{Y} = \\frac{V}{\\sqrt{U^2 + V^2}}$。由于 $X \\in (0, \\pi)$，反余弦函数将唯一确定 $X$。\n$$X = \\arccos\\left(\\frac{V}{\\sqrt{U^2 + V^2}}\\right)$$\n\n所以，逆变换 $h(u,v) = (x,y)$ 是：\n$x = h_1(u,v) = \\arccos\\left(\\frac{v}{\\sqrt{u^2 + v^2}}\\right)$\n$y = h_2(u,v) = \\sqrt{u^2 + v^2}$\n\n**第三步：确定 (U,V) 的支撑域**\n\n$(X,Y)$ 的支撑域是 $0 < X < \\pi$ 和 $Y > 0$。\n从 $U = Y \\sin(X)$：因为对于 $X \\in (0, \\pi)$，有 $Y > 0$ 和 $\\sin(X) > 0$，所以必须有 $U > 0$。\n从 $V = Y \\cos(X)$：因为 $Y > 0$，$V$ 的符号由 $\\cos(X)$ 决定。当 $X$ 在 $0$ 到 $\\pi$ 之间变化时，$\\cos(X)$ 在 $1$ 到 $-1$ 之间变化。因此，$V$ 可以取任何实数值。\n$(U,V)$ 的支撑域是右半平面：$S_{U,V} = \\{ (u,v) \\in \\mathbb{R}^2 \\mid u > 0 \\}$。\n\n**第四步：计算逆变换的雅可比行列式**\n\n雅可比行列式 $J$ 由 $J = \\det\\left(\\frac{\\partial(x,y)}{\\partial(u,v)}\\right) = \\det \\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix}$ 给出。\n\n首先，我们求 $y = \\sqrt{u^2 + v^2}$ 的偏导数：\n$\\frac{\\partial y}{\\partial u} = \\frac{u}{\\sqrt{u^2 + v^2}}$\n$\\frac{\\partial y}{\\partial v} = \\frac{v}{\\sqrt{u^2 + v^2}}$\n\n接下来，我们求 $x = \\arccos\\left(\\frac{v}{\\sqrt{u^2 + v^2}}\\right)$ 的偏导数。令 $z = \\frac{v}{\\sqrt{u^2+v^2}}$。\n使用链式法则和 $\\frac{d}{dz}(\\arccos(z)) = \\frac{-1}{\\sqrt{1-z^2}}$：\n$\\frac{\\partial x}{\\partial u} = \\frac{-1}{\\sqrt{1-z^2}} \\frac{\\partial z}{\\partial u}$\n$1 - z^2 = 1 - \\frac{v^2}{u^2+v^2} = \\frac{u^2}{u^2+v^2}$。因为 $u>0$，所以 $\\sqrt{1-z^2} = \\frac{u}{\\sqrt{u^2+v^2}}$。\n$\\frac{\\partial z}{\\partial u} = v \\frac{\\partial}{\\partial u}(u^2+v^2)^{-1/2} = v \\left(-\\frac{1}{2}(u^2+v^2)^{-3/2}(2u)\\right) = \\frac{-uv}{(u^2+v^2)^{3/2}}$。\n$\\frac{\\partial x}{\\partial u} = -\\frac{\\sqrt{u^2+v^2}}{u} \\left(\\frac{-uv}{(u^2+v^2)^{3/2}}\\right) = \\frac{v}{u^2+v^2}$。\n\n$\\frac{\\partial x}{\\partial v} = \\frac{-1}{\\sqrt{1-z^2}} \\frac{\\partial z}{\\partial v} = -\\frac{\\sqrt{u^2+v^2}}{u} \\frac{\\partial z}{\\partial v}$\n$\\frac{\\partial z}{\\partial v} = \\frac{1 \\cdot \\sqrt{u^2+v^2} - v \\cdot \\frac{v}{\\sqrt{u^2+v^2}}}{u^2+v^2} = \\frac{\\frac{u^2+v^2-v^2}{\\sqrt{u^2+v^2}}}{u^2+v^2} = \\frac{u^2}{(u^2+v^2)^{3/2}}$。\n$\\frac{\\partial x}{\\partial v} = -\\frac{\\sqrt{u^2+v^2}}{u} \\left(\\frac{u^2}{(u^2+v^2)^{3/2}}\\right) = \\frac{-u}{u^2+v^2}$。\n\n现在，我们计算行列式：\n$$J = \\det \\begin{pmatrix} \\frac{v}{u^2+v^2} & \\frac{-u}{u^2+v^2} \\\\ \\frac{u}{\\sqrt{u^2+v^2}} & \\frac{v}{\\sqrt{u^2+v^2}} \\end{pmatrix} = \\left(\\frac{v}{u^2+v^2}\\right)\\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right) - \\left(\\frac{-u}{u^2+v^2}\\right)\\left(\\frac{u}{\\sqrt{u^2+v^2}}\\right)$$\n$$J = \\frac{v^2}{(u^2+v^2)^{3/2}} + \\frac{u^2}{(u^2+v^2)^{3/2}} = \\frac{u^2+v^2}{(u^2+v^2)^{3/2}} = \\frac{1}{\\sqrt{u^2+v^2}}$$\n雅可比行列式的绝对值为 $|J| = \\frac{1}{\\sqrt{u^2+v^2}}$，因为该表达式恒为正。\n\n**第五步：应用变量替换公式**\n\n$U$ 和 $V$ 的联合 PDF 由下式给出：\n$$f_{U,V}(u,v) = f_{X,Y}(h_1(u,v), h_2(u,v)) |J|$$\n$$f_{U,V}(u,v) = f_{X,Y}\\left(\\arccos\\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right), \\sqrt{u^2+v^2}\\right) \\cdot \\frac{1}{\\sqrt{u^2+v^2}}$$\n我们需要在逆变换处计算 $f_{X,Y}(x,y) = \\frac{\\sin(x)}{\\pi} \\exp(-y \\sin(x))$ 的值。\n项 $\\sin(x)$ 变为：\n$$\\sin(x) = \\sin\\left(\\arccos\\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right)\\right) = \\sqrt{1 - \\left(\\frac{v}{\\sqrt{u^2+v^2}}\\right)^2} = \\sqrt{\\frac{u^2+v^2-v^2}{u^2+v^2}} = \\frac{|u|}{\\sqrt{u^2+v^2}}$$\n因为我们在区域 $u>0$ 内，这可以简化为 $\\sin(x) = \\frac{u}{\\sqrt{u^2+v^2}}$。\n指数项是 $y \\sin(x)$。代入变换定义，这恰好就是 $u$：\n$$y \\sin(x) = \\left(\\sqrt{u^2+v^2}\\right) \\left(\\frac{u}{\\sqrt{u^2+v^2}}\\right) = u$$\n现在我们组合出最终的 PDF：\n$$f_{U,V}(u,v) = \\left[ \\frac{1}{\\pi} \\left( \\frac{u}{\\sqrt{u^2+v^2}} \\right) \\exp(-u) \\right] \\cdot \\left( \\frac{1}{\\sqrt{u^2+v^2}} \\right)$$\n$$f_{U,V}(u,v) = \\frac{u}{\\pi (u^2+v^2)} \\exp(-u)$$\n此表达式在支撑域 $u>0$ 和 $v \\in \\mathbb{R}$ 上有效。在其他地方，$f_{U,V}(u,v)=0$。\n\n**第六步：最终答案**\n\n$U$ 和 $V$ 的联合 PDF 由上面推导出的表达式给出。", "answer": "$$\\boxed{\\frac{u}{\\pi (u^2 + v^2)} \\exp(-u)}$$", "id": "1408142"}]}