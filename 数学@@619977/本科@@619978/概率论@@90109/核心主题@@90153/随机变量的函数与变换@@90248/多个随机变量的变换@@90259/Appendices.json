{"hands_on_practices": [{"introduction": "在许多现实世界的应用中，我们常常关心两个随机变量之差的分布。这个练习以一个直观的商业场景——计算利润（收入减去成本）——为例，引导我们实践求两个独立随机变量之差的概率密度函数 [@problem_id:1408043]。通过求解此问题，你将掌握应用卷积公式这一核心技术，这是处理随机变量和与差的基础。", "problem": "一家金融科技初创公司分析其财务表现。其月收入 $R$ 和月运营成本 $C$ 被建模为独立的随机变量。根据历史数据和市场分析，发现 $R$ 和 $C$ 都在区间 $[10, 20]$ 上服从均匀分布，单位为千美元。\n\n月利润定义为收入与成本之差，即 $P = R - C$。\n\n确定月利润 $P$ 的概率密度函数（PDF）$f_P(p)$。该函数应对所有实数 $p$ 有定义。", "solution": "设 $R$ 和 $C$ 是独立的，且 $R \\sim \\text{Uniform}(10,20)$，$C \\sim \\text{Uniform}(10,20)$。它们的概率密度函数为\n$$\nf_{R}(r)=\\begin{cases}\n\\frac{1}{10}, & 10 \\leq r \\leq 20,\\\\\n0, & \\text{otherwise},\n\\end{cases}\n\\qquad\nf_{C}(c)=\\begin{cases}\n\\frac{1}{10}, & 10 \\leq c \\leq 20,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n定义利润 $P=R-C$。对于独立的随机变量，其差的密度由下式给出\n$$\nf_{P}(p)=\\int_{-\\infty}^{\\infty} f_{R}(p+c)\\,f_{C}(c)\\,dc.\n$$\n代入均匀分布的密度，当 $10 \\leq c \\leq 20$ 和 $10 \\leq p+c \\leq 20$ 同时成立时，被积函数恰好等于 $\\frac{1}{100}$，否则为 $0$。因此，\n$$\nf_{P}(p)=\\frac{1}{100}\\,\\lambda\\Big(\\,[10,20]\\cap[10-p,\\,20-p]\\,\\Big),\n$$\n其中 $\\lambda(\\cdot)$ 表示区间长度。对于固定的 $p$，交集的长度为\n$$\nL(p)=\\max\\!\\left(0,\\,\\min(20,\\,20-p)-\\max(10,\\,10-p)\\right).\n$$\n我们分段计算 $L(p)$。如果 $p \\in [0,10]$，那么 $\\min(20,20-p)=20-p$ 且 $\\max(10,10-p)=10$，因此 $L(p)=(20-p)-10=10-p$。如果 $p \\in [-10,0]$，那么 $\\min(20,20-p)=20$ 且 $\\max(10,10-p)=10-p$，因此 $L(p)=20-(10-p)=10+p$。如果 $|p|>10$，则区间不重叠，$L(p)=0$。综合这些情况，当 $|p|\\leq 10$ 时我们有 $L(p)=10-|p|$，否则 $L(p)=0$。因此\n$$\nf_{P}(p)=\\begin{cases}\n\\frac{10-|p|}{100}, & -10 \\leq p \\leq 10,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n作为检验，该积分等于一个底为 $20$、高为 $\\frac{10}{100}$ 的三角形的面积，即为 $1$，这证实了它是一个有效的密度函数。", "answer": "$$\\boxed{f_{P}(p)=\\begin{cases}\\frac{10-|p|}{100}, & -10 \\leq p \\leq 10,\\\\[4pt] 0, & \\text{otherwise}.\\end{cases}}$$", "id": "1408043"}, {"introduction": "统计学不仅处理单个随机变量，还研究从样本中提取的统计量。此问题探讨了样本极差，即样本最大值与最小值之差，这是衡量数据变异性的一个关键指标 [@problem_id:1407987]。解决这个问题需要你运用顺序统计量 (order statistics) 的知识，并执行变量变换，从而让你能够从底层原理推导出样本统计量的分布。", "problem": "一个质量控制系统被用来监控某个制造过程的产出。某个组件的一项关键性能指标，在经过归一化处理后，被发现可以很好地由一个服从区间 $[0, 1]$ 上均匀分布的随机变量来建模。为了评估一个生产批次的一致性，一位工程师随机抽取了 $n$ 个组件的样本，其中 $n \\ge 2$。该样本内的变异性由样本极差来量化，其定义为样本中观测到的该指标的最大值与最小值之差。\n\n设 $X_1, X_2, \\ldots, X_n$ 是 $n$ 个独立同分布 (i.i.d.) 的测量值，每个都从 Uniform$[0, 1]$ 分布中抽取。设它们的顺序统计量为 $X_{(1)} \\le X_{(2)} \\le \\ldots \\le X_{(n)}$。样本极差定义为 $R = X_{(n)} - X_{(1)}$。\n\n对于给定的样本量 $n$，极差 $r$ 取何值时，$R$ 的概率密度函数达到最大值？该值代表了最可能（或众数）的样本极差。请用含 $n$ 的封闭形式表达式给出你的答案。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是独立同分布的 Uniform$[0,1]$ 随机变量，并设 $U=X_{(1)}$ 和 $V=X_{(n)}$。对于一个概率密度函数为 $f$、累积分布函数为 $F$ 的连续分布，$(U,V)$ 的联合密度函数为\n$$\nf_{U,V}(u,v)=n(n-1)\\,[F(v)-F(u)]^{n-2}f(u)f(v),\\quad u\\le v.\n$$\n对于 Uniform$[0,1]$ 分布，$f(x)=1$ 且 $F(x)=x$，所以在 $0\\le u\\le v\\le 1$ 上，\n$$\nf_{U,V}(u,v)=n(n-1)\\,(v-u)^{n-2}.\n$$\n定义到极差和最小值的变换：$R=V-U$ 和 $W=U$，因此 $V=R+W$。雅可比行列式为 $1$。定义域映射为 $0\\le R\\le 1$ 和 $0\\le W\\le 1-R$。因此 $(R,W)$ 的联合密度函数为\n$$\nf_{R,W}(r,w)=n(n-1)\\,r^{n-2},\\quad 0\\le r\\le 1,\\ 0\\le w\\le 1-r.\n$$\n对 $W$进行边缘化，得到 $R$ 的密度函数：\n$$\nf_{R}(r)=\\int_{0}^{1-r} n(n-1)\\,r^{n-2}\\,dw = n(n-1)\\,r^{n-2}(1-r),\\quad 0\\le r\\le 1.\n$$\n为了求众数，我们在 $[0,1]$ 上最大化 $f_{R}(r)$。常数因子 $n(n-1)$ 不影响最大值点 (argmax)，所以定义 $g(r)=r^{n-2}(1-r)$。对于 $n\\ge 2$，\n$$\ng'(r)=(n-2)r^{n-3}(1-r)-r^{n-2}=r^{n-3}\\big[(n-2)-(n-1)r\\big].\n$$\n临界点出现在 $r=0$（当 $n>2$ 时，由因子 $r^{n-3}$ 导致）和\n$$\n(n-2)-(n-1)r=0\\quad\\Rightarrow\\quad r=\\frac{n-2}{n-1}.\n$$\n评估边界值：对于 $n>2$，$g(0)=0$ 和 $g(1)=0$，而 $g\\!\\left(\\frac{n-2}{n-1}\\right)>0$，所以内部点是唯一的最大值点。对于 $n=2$，$f_{R}(r)=2(1-r)$ 在 $[0,1]$ 上是递减的，因此最大值出现在 $r=0$ 处，这与 $n=2$ 时 $r=\\frac{n-2}{n-1}$ 的情况相符。因此，对于所有整数 $n\\ge 2$，$R$ 的众数是\n$$\nr^{\\ast}=\\frac{n-2}{n-1}.\n$$", "answer": "$$\\boxed{\\frac{n-2}{n-1}}$$", "id": "1407987"}, {"introduction": "当随机变量的组合变得更加复杂时，直接积分可能会变得异常繁琐。这个问题引入了一个由四个标准正态随机变量构成的 $2 \\times 2$ 随机矩阵的行列式 $D = X_1 X_4 - X_2 X_3$ [@problem_id:1408028]。此练习旨在展示特征函数法 (method of characteristic functions) 的强大威力，它为解决复杂乘积与差的分布问题提供了一条优雅的分析路径，最终导出一个简洁而优美的拉普拉斯分布。", "problem": "设 $X_1, X_2, X_3$ 和 $X_4$ 是四个独立同分布的随机变量，均服从均值为 0、方差为 1 的标准正态分布。根据表达式 $D = X_1 X_4 - X_2 X_3$ 构建一个新的随机变量 $D$。求 $D$ 的概率密度函数 (PDF)，我们将其记为 $f_D(d)$。您的最终答案应为一个以变量 $d$ 表示的表达式。", "solution": "设随机变量 $D$ 定义为 $D = X_1 X_4 - X_2 X_3$，其中 $X_i \\sim \\mathcal{N}(0, 1)$ 是独立同分布 (i.i.d.) 的随机变量，对于 $i=1, 2, 3, 4$。\n\n为了求出 $D$ 的概率密度函数 (PDF)，我们可以使用特征函数法。我们定义两个中间随机变量 $Y_1 = X_1 X_4$ 和 $Y_2 = X_2 X_3$。由于变量集合 $\\{X_1, X_4\\}$ 与变量集合 $\\{X_2, X_3\\}$ 相互独立，且它们的分布相同，所以随机变量 $Y_1$ 和 $Y_2$ 是独立同分布的。我们所关心的变量是 $D = Y_1 - Y_2$。\n\n$D$ 的特征函数由 $\\phi_D(t) = E[\\exp(itD)]$ 给出。利用 $Y_1$ 和 $Y_2$ 的独立性，我们可以写出：\n$$ \\phi_D(t) = E[\\exp(it(Y_1 - Y_2))] = E[\\exp(itY_1)] E[\\exp(-itY_2)] = \\phi_{Y_1}(t) \\phi_{Y_2}(-t) $$\n由于 $Y_1$ 和 $Y_2$ 是独立同分布的，它们的特征函数相同，即 $\\phi_{Y_1}(t) = \\phi_{Y_2}(t)$。这意味着 $\\phi_{Y_2}(-t) = \\phi_{Y_1}(-t)$。因此，我们有：\n$$ \\phi_D(t) = \\phi_{Y_1}(t) \\phi_{Y_1}(-t) $$\n我们的第一步是计算 $Y_1 = X_1 X_4$ 的特征函数。标准正态变量 $X$ 的概率密度函数是 $f_X(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-x^2/2)$。\n$$ \\phi_{Y_1}(t) = E[\\exp(itX_1 X_4)] = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(itx_1 x_4) f_{X_1}(x_1) f_{X_4}(x_4) dx_1 dx_4 $$\n$$ \\phi_{Y_1}(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(itx_1 x_4) \\exp\\left(-\\frac{x_1^2}{2}\\right) \\exp\\left(-\\frac{x_4^2}{2}\\right) dx_1 dx_4 $$\n我们可以通过累次积分来计算这个式子。我们首先对 $x_1$ 进行积分，并将 $x_4$ 视为常数：\n$$ I(x_4) = \\int_{-\\infty}^{\\infty} \\exp(itx_1 x_4) \\exp\\left(-\\frac{x_1^2}{2}\\right) dx_1 = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}(x_1^2 - 2itx_4 x_1)\\right) dx_1 $$\n我们在指数部分进行配方：$x_1^2 - 2itx_4 x_1 = (x_1 - itx_4)^2 - (itx_4)^2 = (x_1 - itx_4)^2 + t^2 x_4^2$。\n$$ I(x_4) = \\exp\\left(-\\frac{t^2 x_4^2}{2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x_1 - itx_4)^2}{2}\\right) dx_1 $$\n该积分为高斯积分。尽管均值是虚数，但在实轴上的积分是一个标准结果：$\\int_{-\\infty}^{\\infty} \\exp(-(z-c)^2 / (2\\sigma^2)) dz = \\sqrt{2\\pi\\sigma^2}$。这里，$\\sigma^2=1$，所以积分结果是 $\\sqrt{2\\pi}$。\n$$ I(x_4) = \\sqrt{2\\pi} \\exp\\left(-\\frac{t^2 x_4^2}{2}\\right) $$\n或者，可以认识到 $\\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp(ikx_1 - x_1^2/2) dx_1$ 是一个标准正态变量的特征函数，$\\phi_{X_1}(k) = \\exp(-k^2/2)$。令 $k=tx_4$，该积分为 $\\sqrt{2\\pi}\\phi_{X_1}(tx_4) = \\sqrt{2\\pi}\\exp(-(tx_4)^2/2)$。\n\n现在，我们将这个结果代回到 $\\phi_{Y_1}(t)$ 的表达式中：\n$$ \\phi_{Y_1}(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left( \\sqrt{2\\pi} \\exp\\left(-\\frac{t^2 x_4^2}{2}\\right) \\right) \\exp\\left(-\\frac{x_4^2}{2}\\right) dx_4 $$\n$$ \\phi_{Y_1}(t) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x_4^2}{2} (1+t^2)\\right) dx_4 $$\n这又是一个高斯积分。令 $\\sigma_{\\text{eff}}^2 = (1+t^2)^{-1}$。该积分的形式为 $\\int_{-\\infty}^{\\infty} \\exp(-x^2/(2\\sigma_{\\text{eff}}^2)) dx = \\sqrt{2\\pi \\sigma_{\\text{eff}}^2} = \\sqrt{2\\pi} (1+t^2)^{-1/2}$。\n$$ \\phi_{Y_1}(t) = \\frac{1}{\\sqrt{2\\pi}} \\left( \\sqrt{2\\pi} (1+t^2)^{-1/2} \\right) = \\frac{1}{\\sqrt{1+t^2}} $$\n现在我们可以计算 $D$ 的特征函数：\n$$ \\phi_{Y_1}(-t) = \\frac{1}{\\sqrt{1+(-t)^2}} = \\frac{1}{\\sqrt{1+t^2}} $$\n$$ \\phi_D(t) = \\phi_{Y_1}(t) \\phi_{Y_1}(-t) = \\frac{1}{\\sqrt{1+t^2}} \\frac{1}{\\sqrt{1+t^2}} = \\frac{1}{1+t^2} $$\n最后一步是找出概率密度函数 $f_D(d)$，其特征函数为 $\\phi_D(t) = \\frac{1}{1+t^2}$。我们可以通过傅里叶逆变换来求得：\n$$ f_D(d) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp(-itd) \\phi_D(t) dt = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{\\exp(-itd)}{1+t^2} dt $$\n这个特征函数是广为人知的。它对应于 Laplace 分布，其位置参数为 $\\mu=0$，尺度参数为 $b=1$。Laplace 分布的一般概率密度函数为 $f(x; \\mu, b) = \\frac{1}{2b} \\exp\\left(-\\frac{|x-\\mu|}{b}\\right)$。\n在我们的情况下，当 $\\mu=0$ 和 $b=1$ 时，$D$ 的概率密度函数为：\n$$ f_D(d) = \\frac{1}{2} \\exp(-|d|) $$", "answer": "$$\\boxed{\\frac{1}{2} \\exp(-|d|)}$$", "id": "1408028"}]}