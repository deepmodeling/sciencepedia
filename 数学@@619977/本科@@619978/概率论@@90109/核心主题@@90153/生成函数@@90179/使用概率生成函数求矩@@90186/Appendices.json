{"hands_on_practices": [{"introduction": "本练习旨在巩固利用概率生成函数（PGF）求期望值的核心技巧。我们将从一个给定的 PGF 出发，该 PGF 描述了一个随机算法的步数。通过计算 PGF 在 $s=1$ 处的导数，你将直接应用 $E[X] = G'(1)$ 这一基本关系，这是 PGF 工具箱中最基本也是最强大的工具之一。[@problem_id:1409497]", "problem": "一个计算机科学家团队正在分析一种特定递归算法的行为，该算法旨在在一个巨大的、结构化的状态空间中搜索解。该算法以离散的步骤探索该空间。在每一步中，它要么找到一个有效解并终止，要么继续进行下一步。这个过程是随机的，意味着在每一步都有一定的成功概率，并且每一步都与之前的步骤无关。\n\n设随机变量 $X$ 表示该算法直到找到解并终止所需的总步数。对该算法性能的理论分析得出了其概率生成函数 (PGF) $G_X(s)$，表达式如下：\n\n$$G_X(s) = \\frac{s}{4 - 3s}$$\n\n计算该算法找到解所需的期望步数 $E[X]$。", "solution": "对于一个取非负整数值的随机变量 $X$，其概率生成函数为 $G_{X}(s) = \\mathbb{E}[s^{X}]$，其期望由在 $s=1$ 处的导数给出：\n$$\n\\mathbb{E}[X] = G_{X}'(1).\n$$\n已知 $G_{X}(s) = \\dfrac{s}{4 - 3s}$，我们使用商法则对其进行微分。令 $f(s) = s$ 且 $g(s) = 4 - 3s$，则 $f'(s) = 1$ 且 $g'(s) = -3$。那么\n$$\nG_{X}'(s) = \\frac{f'(s)g(s) - f(s)g'(s)}{g(s)^{2}} = \\frac{(1)(4 - 3s) - s(-3)}{(4 - 3s)^{2}} = \\frac{4 - 3s + 3s}{(4 - 3s)^{2}} = \\frac{4}{(4 - 3s)^{2}}.\n$$\n在 $s=1$ 处求值，\n$$\n\\mathbb{E}[X] = G_{X}'(1) = \\frac{4}{(4 - 3)^{2}} = 4.\n$$\n作为一致性检验，我们将 PGF 重写为 $G_{X}(s) = \\dfrac{1}{4}\\dfrac{s}{1 - \\frac{3}{4}s}$。这是在 $\\{1,2,\\dots\\}$ 上、成功概率为 $p = \\dfrac{1}{4}$ 的几何分布的 PGF，其期望为 $\\mathbb{E}[X] = \\dfrac{1}{p} = 4$，这与使用导数方法得到的结果一致。", "answer": "$$\\boxed{4}$$", "id": "1409497"}, {"introduction": "这个练习将我们带入一个更复杂的领域：分支过程。在此问题中，一个信号级联过程的 PGF 并非直接给出，而是通过一个递归函数方程来定义。这个实践旨在展示一种强大的技术，即通过对方程本身进行微分来求解矩，而无需先解析地解出 PGF，这在处理递归结构时尤其有用。[@problem_id:1409566]", "problem": "一个特殊探测器内信号级联的简化模型描述如下。单个初始粒子进入探测器。可能发生两个互斥事件：\n1.  粒子以概率 $p$被直接吸收，产生固定数量 $k$ 的可探测信号。\n2.  粒子以概率 $1-p$裂变为两个相同的子粒子。每个子粒子随后独立地引发一个新的级联过程，其行为与原始的初始粒子完全相同。\n\n设 $X$ 为单个初始粒子产生的可探测信号总数的随机变量。系统设计使得概率 $p$ 满足 $1/2 < p < 1$，且 $k$ 是一个正整数。这确保了级联过程平均而言不会无限增长。\n\n求 $X$ 的期望值，记作 $E[X]$，用 $p$ 和 $k$ 表示。", "solution": "设 $G_X(s)$ 为随机变量 $X$ 的概率母函数 (PGF)，其定义为 $G_X(s) = E[s^X]$。我们可以通过对级联中的第一个事件进行条件分析，来构造一个关于 $G_X(s)$ 的函数方程。\n\n根据问题描述，对于初始粒子存在两种可能性：\n1.  以概率 $p$，过程终止并产生 $k$ 个信号。此时随机变量为常量 $k$。此结果的 PGF 为 $s^k$。\n2.  以概率 $1-p$，粒子裂变为两个子粒子。每个子粒子产生的信号总数设为 $X_1$ 和 $X_2$。在这种情况下，信号总数为 $X = X_1 + X_2$。由于每个子粒子的行为与原始初始粒子相同且相互独立，因此 $X_1$ 和 $X_2$ 是独立同分布的随机变量，与 $X$ 具有相同的分布。独立随机变量之和的 PGF 是它们各自 PGF 的乘积。因此，此结果的 PGF 为 $G_{X_1}(s)G_{X_2}(s) = G_X(s)G_X(s) = (G_X(s))^2$。\n\n使用全期望定律（或根据混合分布的性质），$X$ 的总 PGF 是每种情况下 PGF 的加权平均值：\n$$G_X(s) = p \\cdot s^k + (1-p) \\cdot (G_X(s))^2$$\n\n问题要求解 $X$ 的期望值，这可以通过 PGF 的关系式 $E[X] = G_X'(1)$ 求得。我们不需要显式地解出 $G_X(s)$ 的函数方程。相反，我们可以对整个方程关于 $s$求导。使用乘法法则和链式法则进行微分，我们得到：\n$$G_X'(s) = \\frac{d}{ds} \\left( p s^k + (1-p) (G_X(s))^2 \\right)$$\n$$G_X'(s) = p k s^{k-1} + (1-p) \\cdot 2 G_X(s) G_X'(s)$$\n\n现在，我们在 $s=1$ 处对这个微分后的方程求值。我们使用任何 PGF 的两个基本性质：\n1.  $G_X(1) = \\sum_{n=0}^{\\infty} P(X=n) (1)^n = \\sum P(X=n) = 1$。\n2.  $G_X'(1) = E[X]$。我们将 $E[X]$ 记为 $\\mu$。\n\n将 $s=1$、$G_X(1)=1$ 和 $G_X'(1)=\\mu$ 代入微分后的方程中：\n$$G_X'(1) = p k (1)^{k-1} + (1-p) \\cdot 2 G_X(1) G_X'(1)$$\n$$\\mu = p k + (1-p) \\cdot 2 \\cdot (1) \\cdot \\mu$$\n$$\\mu = pk + 2(1-p)\\mu$$\n\n现在，我们求解这个关于 $\\mu$ 的线性方程：\n$$\\mu - 2(1-p)\\mu = pk$$\n$$\\mu(1 - 2 + 2p) = pk$$\n$$\\mu(2p - 1) = pk$$\n\n因为问题陈述中 $1/2 < p < 1$，我们有 $2p - 1 > 0$，因此我们可以除以 $(2p-1)$ 来找到一个唯一的、正的、有限的均值。\n$$\\mu = \\frac{pk}{2p-1}$$\n\n该表达式给出了单个初始粒子产生的信号总数的期望值。", "answer": "$$\\boxed{\\frac{pk}{2p-1}}$$", "id": "1409566"}, {"introduction": "最后一个练习展示了 PGF 超越求标准矩的灵活性。你的任务是求解一个非多项式函数的期望 $E[1/(N+1)]$，这是某个网络模型中的一个关键性能指标。这个问题将引导你学习一种精妙的方法，它通过 PGF 的定积分来计算该期望，揭示了 PGF 与连续数学工具之间的深刻联系。[@problem_id:1409515]", "problem": "在通信网络的研究中，针对一个源在特定时间段内生成的数据包数量 $N$，提出了一个随机模型。数据包数量 $N$ 是一个非负整数值的随机变量。其统计特性完全由其概率生成函数（PGF）所刻画，定义为 $G_N(s) = E[s^N]$，其中 $E[\\cdot]$ 表示期望算子。\n\n对于此特定模型，其PGF由下式给出：\n$$\nG_N(s) = 1-p + \\frac{p(1-\\alpha)}{1-\\alpha s}\n$$\n其中 $p$ 和 $\\alpha$ 是模型的常数参数，满足 $0 < p < 1$ 和 $0 < \\alpha < 1$。\n\n网络服务质量的一个关键性能指标与数据包的处理延迟有关。该指标被发现在数学上等价于物理量 $\\frac{1}{N+1}$ 的期望值。\n\n请确定期望值 $E\\left[\\frac{1}{N+1}\\right]$ 关于参数 $p$ 和 $\\alpha$ 的表达式。", "solution": "目标是计算一个给定了概率生成函数（PGF）的非负整数随机变量 $N$ 的期望 $E\\left[\\frac{1}{N+1}\\right]$。\n\n令 $P(N=k)$ 为随机变量 $N$ 取值为 $k$ 的概率，其中 $k \\in \\{0, 1, 2, ...\\}$。$N$ 的函数（记为 $f(N)$）的期望由以下定义给出：\n$$\nE[f(N)] = \\sum_{k=0}^{\\infty} f(k) P(N=k)\n$$\n在本问题中，该函数为 $f(N) = \\frac{1}{N+1}$。将此代入期望的定义，我们得到：\n$$\nE\\left[\\frac{1}{N+1}\\right] = \\sum_{k=0}^{\\infty} \\frac{1}{k+1} P(N=k)\n$$\n我们可以将项 $\\frac{1}{k+1}$ 表示为一个定积分：\n$$\n\\frac{1}{k+1} = \\int_{0}^{1} s^k ds\n$$\n将此积分表达式代入期望的求和式中：\n$$\nE\\left[\\frac{1}{N+1}\\right] = \\sum_{k=0}^{\\infty} \\left( \\int_{0}^{1} s^k ds \\right) P(N=k)\n$$\n由于和式中的各项均为非负，我们可以交换求和与积分的顺序（根据Tonelli定理）：\n$$\nE\\left[\\frac{1}{N+1}\\right] = \\int_{0}^{1} \\left( \\sum_{k=0}^{\\infty} s^k P(N=k) \\right) ds\n$$\n我们识别出括号内的表达式即为 $N$ 的PGF的定义，即 $G_N(s) = \\sum_{k=0}^{\\infty} P(N=k)s^k$。因此，我们在所求期望与PGF之间建立了一个普遍关系：\n$$\nE\\left[\\frac{1}{N+1}\\right] = \\int_{0}^{1} G_N(s) ds\n$$\n现在，我们使用问题中给出的具体PGF：\n$$\nG_N(s) = 1-p + \\frac{p(1-\\alpha)}{1-\\alpha s}\n$$\n我们将此代入我们的积分表达式中：\n$$\nE\\left[\\frac{1}{N+1}\\right] = \\int_{0}^{1} \\left( 1-p + \\frac{p(1-\\alpha)}{1-\\alpha s} \\right) ds\n$$\n我们可以将积分拆分为两部分：\n$$\nE\\left[\\frac{1}{N+1}\\right] = \\int_{0}^{1} (1-p) ds + \\int_{0}^{1} \\frac{p(1-\\alpha)}{1-\\alpha s} ds\n$$\n第一个积分很简单：\n$$\n\\int_{0}^{1} (1-p) ds = [(1-p)s]_{0}^{1} = (1-p)(1) - (1-p)(0) = 1-p\n$$\n对于第二个积分，我们可以将常数提出：\n$$\n\\int_{0}^{1} \\frac{p(1-\\alpha)}{1-\\alpha s} ds = p(1-\\alpha) \\int_{0}^{1} \\frac{1}{1-\\alpha s} ds\n$$\n$\\frac{1}{1-\\alpha s}$ 关于 $s$ 的反导数是 $-\\frac{1}{\\alpha}\\ln(1-\\alpha s)$。因此，我们计算该定积分：\n$$\np(1-\\alpha) \\left[ -\\frac{1}{\\alpha}\\ln(1-\\alpha s) \\right]_{0}^{1} = -\\frac{p(1-\\alpha)}{\\alpha} [\\ln(1-\\alpha s)]_{0}^{1}\n$$\n$$\n= -\\frac{p(1-\\alpha)}{\\alpha} \\left( \\ln(1-\\alpha(1)) - \\ln(1-\\alpha(0)) \\right)\n$$\n$$\n= -\\frac{p(1-\\alpha)}{\\alpha} (\\ln(1-\\alpha) - \\ln(1))\n$$\n由于 $\\ln(1)=0$，上式可简化为：\n$$\n= -\\frac{p(1-\\alpha)}{\\alpha} \\ln(1-\\alpha)\n$$\n最后，我们将两个积分的结果合并，得到最终答案：\n$$\nE\\left[\\frac{1}{N+1}\\right] = (1-p) + \\left( -\\frac{p(1-\\alpha)}{\\alpha} \\ln(1-\\alpha) \\right) = 1-p - \\frac{p(1-\\alpha)}{\\alpha} \\ln(1-\\alpha)\n$$", "answer": "$$\\boxed{1-p - \\frac{p(1-\\alpha)}{\\alpha}\\ln(1-\\alpha)}$$", "id": "1409515"}]}