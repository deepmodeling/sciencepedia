{"hands_on_practices": [{"introduction": "现实世界中的许多现象，例如天气，都包含多种潜在状态。这个练习模拟了太阳能电池板在“晴天”和“阴天”两种状态下的能量输出，让你能够运用全概率定律来计算混合分布中的概率，这是处理异构数据的基本技能。[@problem_id:1375739]", "problem": "一个研究团队正在对某一特定地区一种新型太阳能电池板的每日能量产出进行建模。每日的能量产出（以千瓦时 kWh 为单位），我们称之为 $X$，被发现可以很好地用一个混合两种正态分布的模型来近似，这两种分布分别对应“阴天”或“晴天”。\n\n在分类为阴天的日子里，能量产出 $X_C$ 服从均值为 $\\mu_C = 12$ kWh、标准差为 $\\sigma_C = 2$ kWh 的正态分布。\n在分类为晴天的日子里，能量产出 $X_S$ 服从均值为 $\\mu_S = 28$ kWh、标准差为 $\\sigma_S = 4$ kWh 的正态分布。\n\n该地区的气象数据表明，任意一天是晴天的概率为 $p_S = 0.7$。任何非晴天的日子都被认为是阴天。\n\n为帮助您计算，您可以使用标准正态分布 $Z \\sim N(0, 1)$ 的累积分布函数 (CDF) 的以下值，其中 $\\Phi(z) = P(Z \\le z)$：\n$\\Phi(1.00) = 0.8413$\n$\\Phi(3.50) = 0.9998$\n\n计算随机选取一天，太阳能电池板产生的能量大于 $14$ kWh 的概率。将您的答案表示为四舍五入到四位有效数字的小数。", "solution": "令 $S$ 表示晴天，$C$ 表示阴天。根据全概率定律，\n$$\nP(X>14)=P(X>14\\mid S)P(S)+P(X>14\\mid C)P(C).\n$$\n已知 $p_{S}=P(S)=0.7$，因此 $P(C)=1-p_{S}=0.3$。\n\n对于一个正态随机变量 $X\\sim N(\\mu,\\sigma^{2})$，用 $Z=\\frac{X-\\mu}{\\sigma}\\sim N(0,1)$ 进行标准化。那么 $P(X>a)=P\\!\\left(Z>\\frac{a-\\mu}{\\sigma}\\right)$。\n\n阴天情况：$X_{C}\\sim N(\\mu_{C},\\sigma_{C}^{2})$，其中 $\\mu_{C}=12$，$\\sigma_{C}=2$。\n$$\nP(X_{C}>14)=P\\!\\left(Z>\\frac{14-12}{2}\\right)=P(Z>1)=1-\\Phi(1)=1-0.8413=0.1587.\n$$\n\n晴天情况：$X_{S}\\sim N(\\mu_{S},\\sigma_{S}^{2})$，其中 $\\mu_{S}=28$，$\\sigma_{S}=4$。\n$$\nP(X_{S}>14)=P\\!\\left(Z>\\frac{14-28}{4}\\right)=P(Z>-3.5)=\\Phi(3.5)=0.9998.\n$$\n\n合并：\n$$\nP(X>14)=0.3\\times 0.1587+0.7\\times 0.9998=0.04761+0.69986=0.74747.\n$$\n四舍五入到四位有效数字，结果为 $0.7475$。", "answer": "$$\\boxed{0.7475}$$", "id": "1375739"}, {"introduction": "混合模型的另一个重要应用是理解其整体变异性。本题以高峰期和非高峰期的交通流量为例，引导你使用全方差定律来计算混合泊松分布的总方差，让你深入理解混合分布的方差不仅取决于各组分的方差，还取决于各组分均值之间的差异。[@problem_id:1375781]", "problem": "一个交通监控系统记录在一分钟的时间间隔内，通过高速公路上一个特定点的车辆数量 $N$。交通流量被建模为存在于两种状态之一：“高峰时段”或“非高峰时段”。任何随机选择的一分钟时间间隔属于高峰时段的概率由一个常数 $w$ 给出，其中 $0 < w < 1$。\n\n在高峰时段的一分钟内，车辆数量 $N$ 服从均值为每分钟 $\\lambda_R$ 辆车的泊松分布。在非高峰时段的一分钟内，$N$ 服从另一个泊松分布，其均值为每分钟 $\\lambda_{OP}$ 辆车，其中 $\\lambda_R > \\lambda_{OP}$。\n\n你的任务是确定在随机选择的一分钟时间间隔内观测到的车辆数量的总方差 $\\operatorname{Var}(N)$。将你的答案表示为一个关于 $w$、$\\lambda_R$ 和 $\\lambda_{OP}$ 的单一闭式解析表达式。", "solution": "令 $S$ 表示交通状态，其中 $\\Pr(S=\\text{rush})=w$ 且 $\\Pr(S=\\text{off-peak})=1-w$。在给定 $S$ 的条件下，$N$ 服从泊松分布：$N|S=\\text{rush} \\sim \\text{Poisson}(\\lambda_{R})$ 且 $N|S=\\text{off-peak} \\sim \\text{Poisson}(\\lambda_{OP})$。对于参数为 $\\lambda$ 的泊松分布，其均值和方差均为 $\\lambda$，因此\n$$\n\\mathbb{E}[N \\mid S=\\text{rush}] = \\lambda_{R}, \\quad \\operatorname{Var}(N \\mid S=\\text{rush}) = \\lambda_{R},\n$$\n$$\n\\mathbb{E}[N \\mid S=\\text{off-peak}] = \\lambda_{OP}, \\quad \\operatorname{Var}(N \\mid S=\\text{off-peak}) = \\lambda_{OP}.\n$$\n根据全方差公式，\n$$\n\\operatorname{Var}(N) = \\mathbb{E}[\\operatorname{Var}(N \\mid S)] + \\operatorname{Var}(\\mathbb{E}[N \\mid S]).\n$$\n分别计算这两项。首先，\n$$\n\\mathbb{E}[\\operatorname{Var}(N \\mid S)] = w \\lambda_{R} + (1-w) \\lambda_{OP}.\n$$\n其次，定义 $M=\\mathbb{E}[N \\mid S]$，它以概率 $w$ 等于 $\\lambda_{R}$，以概率 $1-w$ 等于 $\\lambda_{OP}$。那么\n$$\n\\mathbb{E}[M] = w \\lambda_{R} + (1-w) \\lambda_{OP}, \\quad \\mathbb{E}[M^{2}] = w \\lambda_{R}^{2} + (1-w) \\lambda_{OP}^{2},\n$$\n所以\n$$\n\\operatorname{Var}(M) = \\mathbb{E}[M^{2}] - (\\mathbb{E}[M])^{2} = w \\lambda_{R}^{2} + (1-w) \\lambda_{OP}^{2} - (w \\lambda_{R} + (1-w) \\lambda_{OP})^{2}.\n$$\n展开并化简可得\n$$\n\\operatorname{Var}(M) = w(1-w)(\\lambda_{R} - \\lambda_{OP})^{2}.\n$$\n因此，\n$$\n\\operatorname{Var}(N) = w \\lambda_{R} + (1-w) \\lambda_{OP} + w(1-w)(\\lambda_{R} - \\lambda_{OP})^{2}.\n$$\n这就是所求的闭式表达式。", "answer": "$$\\boxed{w \\lambda_{R} + (1-w) \\lambda_{OP} + w(1-w)\\left(\\lambda_{R} - \\lambda_{OP}\\right)^{2}}$$", "id": "1375781"}, {"introduction": "在科学研究中，我们常常需要从实验数据中反推模型的未知参数。这个问题将你置于粒子物理学家的角色，挑战你利用测得的粒子寿命分布的各阶矩，来推断混合伽马分布中的一个关键参数 $\\alpha$。这个练习不仅综合了前面学到的知识，还展示了混合模型在从观测数据中揭示底层物理过程方面的强大能力。[@problem_id:1375763]", "problem": "在一个粒子物理实验中，观测到一个新发现的不稳定粒子通过两种不同的通道衰变。因此，单个粒子的寿命（由随机变量 $T$ 表示）被建模为一个统计混合模型。具体来说，其衰变有50%的几率遵循一个由形状参数为 $\\alpha$、尺度参数为 $\\beta_1$ 的伽马分布所描述的过程，另外50%的几率遵循另一个由形状参数同样为 $\\alpha$、但尺度参数为 $\\beta_2$ 的伽马分布所描述的过程。参数 $\\alpha, \\beta_1, \\beta_2$ 均为正实数，且 $\\beta_1 \\neq \\beta_2$。\n\n一个服从伽马分布的随机变量 $X$（形状参数为 $\\alpha > 0$，尺度参数为 $\\beta > 0$），记作 $X \\sim \\text{Gamma}(\\alpha, \\beta)$，其概率密度函数为：\n$$f(x; \\alpha, \\beta) = \\frac{1}{\\Gamma(\\alpha)\\beta^{\\alpha}} x^{\\alpha-1} \\exp\\left(-\\frac{x}{\\beta}\\right) \\quad \\text{for } x > 0$$\n其中 $\\Gamma(\\alpha)$ 是伽马函数。\n\n通过大量的衰变观测数据，物理学家们确定了寿命分布 $T$ 的前三阶原点矩。记这些矩为 $M_1 = E[T]$, $M_2 = E[T^2]$ 和 $M_3 = E[T^3]$。你的任务是找到一个仅用这些实验测得的矩 $M_1$、$M_2$ 和 $M_3$ 表示的公共形状参数 $\\alpha$ 的表达式。请以单一闭式解析表达式的形式给出最终答案。", "solution": "设两个尺度参数为 $\\beta_{1}$ 和 $\\beta_{2}$，公共形状参数为 $\\alpha>0$。对于 $X\\sim\\text{Gamma}(\\alpha,\\beta)$，其 $k$ 阶原点矩为\n$$\nE[X^{k}] = \\beta^{k}\\,\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)} = \\beta^{k}\\,\\alpha(\\alpha+1)\\cdots(\\alpha+k-1).\n$$\n对于这个50-50的混合分布，根据全期望定律，\n$$\nM_{k} = E[T^{k}] = \\frac{1}{2}\\left(\\beta_{1}^{k}+\\beta_{2}^{k}\\right)\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)}.\n$$\n定义 $S_{k}=\\frac{1}{2}(\\beta_{1}^{k}+\\beta_{2}^{k})$ 和 $c_{k}=\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)}$。那么对于 $k=1,2,3$，\n$$\nM_{k}=c_{k}S_{k},\\qquad c_{1}=\\alpha,\\; c_{2}=\\alpha(\\alpha+1),\\; c_{3}=\\alpha(\\alpha+1)(\\alpha+2).\n$$\n因此\n$$\nS_{1}=\\frac{M_{1}}{\\alpha},\\qquad S_{2}=\\frac{M_{2}}{\\alpha(\\alpha+1)},\\qquad S_{3}=\\frac{M_{3}}{\\alpha(\\alpha+1)(\\alpha+2)}.\n$$\n对于两个数 $\\beta_{1}、\\beta_{2}$，其幂和 $p_{k}=\\beta_{1}^{k}+\\beta_{2}^{k}$ 满足二阶递推关系 $p_{k}=(\\beta_{1}+\\beta_{2})p_{k-1}-\\beta_{1}\\beta_{2}\\,p_{k-2}$ (对于 $k\\geq 2$)。两边同除以2，可得 $S_k$ 具有相同的递推关系：\n$$\nS_{k}=(\\beta_{1}+\\beta_{2})S_{k-1}-\\beta_{1}\\beta_{2}\\,S_{k-2}.\n$$\n利用 $S_{1}=\\frac{\\beta_{1}+\\beta_{2}}{2}$ 和 $S_{2}=\\frac{(\\beta_{1}+\\beta_{2})^{2}-2\\beta_{1}\\beta_{2}}{2}$，可以得到\n$$\nS_{3}=(\\beta_{1}+\\beta_{2})S_{2}-\\beta_{1}\\beta_{2}S_{1}\n\\,=\\,3S_{1}S_{2}-2S_{1}^{3}.\n$$\n将 $S_{1},S_{2},S_{3}$ 用 $M_{1},M_{2},M_{3}$ 和 $\\alpha$ 的表达式代入，得到\n$$\n\\frac{M_{3}}{\\alpha(\\alpha+1)(\\alpha+2)} = 3\\frac{M_{1}}{\\alpha}\\cdot\\frac{M_{2}}{\\alpha(\\alpha+1)} - 2\\left(\\frac{M_{1}}{\\alpha}\\right)^{3}.\n$$\n方程两边同乘以 $\\alpha^{3}(\\alpha+1)(\\alpha+2)$，得到\n$$\nM_{3}\\,\\alpha^{2} = 3M_{1}M_{2}\\,\\alpha(\\alpha+2) - 2M_{1}^{3}(\\alpha+1)(\\alpha+2).\n$$\n展开并合并 $\\alpha$ 的同次幂，得到关于 $\\alpha$ 的二次方程：\n$$\n\\bigl(3M_{1}M_{2}-2M_{1}^{3}-M_{3}\\bigr)\\alpha^{2} + \\bigl(6M_{1}M_{2}-6M_{1}^{3}\\bigr)\\alpha - 4M_{1}^{3} = 0.\n$$\n令 $a_{2}=3M_{1}M_{2}-2M_{1}^{3}-M_{3}$，$a_{1}=6M_{1}(M_{2}-M_{1}^{2})$，以及 $a_{0}=-4M_{1}^{3}$。其判别式可简化为\n$$\n\\Delta = a_{1}^{2}-4a_{2}a_{0} = 4M_{1}^{2}\\Bigl((3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}\\Bigr).\n$$\n因此\n$$\n\\alpha = \\frac{-a_{1}+\\sqrt{\\Delta}}{2a_{2}} = \\frac{-6M_{1}(M_{2}-M_{1}^{2})+2M_{1}\\sqrt{(3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}}}{2\\bigl(3M_{1}M_{2}-2M_{1}^{3}-M_{3}\\bigr)}.\n$$\n选择平方根前的正号，是能够得到正值 $\\alpha$ 且在 $\\beta_{1}=\\beta_{2}$ 时能正确退化到单一伽马分布极限的分支。约去因子2，得到闭式表达式\n$$\n\\alpha = \\frac{M_{1}\\left(3M_{1}^{2}-3M_{2}+\\sqrt{(3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}}\\right)}{3M_{1}M_{2}-2M_{1}^{3}-M_{3}}.\n$$", "answer": "$$\\boxed{\\frac{M_{1}\\left(3M_{1}^{2}-3M_{2}+\\sqrt{(3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}}\\right)}{3M_{1}M_{2}-2M_{1}^{3}-M_{3}}}$$", "id": "1375763"}]}