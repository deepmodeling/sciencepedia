{"hands_on_practices": [{"introduction": "理解卡方分布最根本的方法之一是学习它是如何构建的。这个练习将带你追溯到卡方分布的源头，即它被定义为独立标准正态变量的平方和。这个概念不仅是理论上的，也是计算统计中生成卡方随机数的基础，通过这个练习，你可以将抽象的定义转化为一个具体的算法思想。[@problem_id:1903721]", "problem": "在开发一个自定义的统计模拟库时，一位程序员的任务是创建一个函数，用来从自由度为 $k$ 的卡方分布（记为 $\\chi^2(k)$）中生成随机变量，其中 $k$ 是一个正整数。唯一可用的工具是一个预先存在的函数 `get_std_normal()`，该函数返回一个从标准正态分布 $N(0, 1)$ 中抽取的随机数。\n\n程序员必须设计一个算法，通过一次或多次调用 `get_std_normal()` 来正确地从 $\\chi^2(k)$ 分布中生成一个随机变量。以下哪个提议的算法能正确完成这个任务？\n\nA. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 上。`sum_of_squares` 的最终值就是结果。\n\nB. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z$ 加到 `sum_val` 上。`sum_val` 的最终值就是结果。\n\nC. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z$ 加到 `sum_val` 上。最终结果是 `sum_val` 的平方。\n\nD. 调用 `get_std_normal()` 恰好一次以获得一个值 $z$。结果是 $k \\times z$。\n\nE. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 上。最终结果是 `sum_of_squares` 除以 $k$。", "solution": "设 $Z_{1},\\dots,Z_{k}$ 是独立的标准正态随机变量，每个变量都通过调用 get_std_normal() 获得，因此 $Z_{i} \\sim N(0,1)$ 并且这些 $Z_{i}$ 是相互独立的。根据卡方分布的定义性质，平方和\n$$\nQ=\\sum_{i=1}^{k} Z_{i}^{2}\n$$\n服从 $\\chi^{2}(k)$ 分布。这可以通过矩生成函数来验证：例如，对于 $t<\\frac{1}{2}$，$Z_{i}^{2}$ 的矩生成函数 (mgf) 是 $(1-2t)^{-1/2}$，并且根据独立性\n$$\nM_{Q}(t)=\\prod_{i=1}^{k}(1-2t)^{-1/2}=(1-2t)^{-k/2},\n$$\n即为 $\\chi^{2}(k)$ 的矩生成函数。因此，计算 $k$ 个独立标准正态随机变量的平方和正是正确的算法。\n\n现在评估每个提议的算法：\n\nA. 该算法计算 $Q=\\sum_{i=1}^{k} Z_{i}^{2}$，根据定义，它服从 $\\chi^{2}(k)$ 分布。因此 A 是正确的。\n\nB. 该算法计算 $S=\\sum_{i=1}^{k} Z_{i}$，它服从正态分布 $S \\sim N(0,k)$，而不是卡方分布。因此 B 是不正确的。\n\nC. 该算法计算 $S^{2}$，其中 $S=\\sum_{i=1}^{k} Z_{i} \\sim N(0,k)$。那么 $S/\\sqrt{k} \\sim N(0,1)$ 且 $S^{2}=k\\,(S/\\sqrt{k})^{2}$，所以 $S^{2}$ 服从 $k \\cdot \\chi^{2}(1)$ 分布，这不等于 $\\chi^{2}(k)$（除非 $k=1$）。因此 C 在一般情况下是不正确的。\n\nD. 该算法计算 $k Z$，其中单个 $Z \\sim N(0,1)$，得到 $N(0,k^{2})$ 分布，而不是卡方分布。因此 D 是不正确的。\n\nE. 该算法计算 $\\frac{1}{k}\\sum_{i=1}^{k} Z_{i}^{2}=\\frac{1}{k}\\,\\chi^{2}(k)$，这是一个尺度卡方变量，而不是 $\\chi^{2}(k)$。因此 E 是不正确的。\n\n因此，唯一正确的算法是 A。", "answer": "$$\\boxed{A}$$", "id": "1903721"}, {"introduction": "在了解了如何构建单个卡方变量之后，下一步是探究它们之间如何相互作用。这个练习将展示卡方分布一个非常重要的特性——可加性。该性质指出，独立的卡方变量之和仍然是一个卡方变量，其自由度是原来自由度之和，这个性质是许多统计推断方法（如方差分析ANOVA）的理论基石。[@problem_id:2278]", "problem": "设 $X$ 和 $Y$ 是独立的随机变量。已知变量 $X$ 服从自由度为 $k_X = 4$ 的卡方分布，记作 $X \\sim \\chi^2(4)$。它们的和 $Z = X+Y$ 也是一个卡方随机变量，服从自由度为 $k_Z = 10$ 的分布，即 $Z \\sim \\chi^2(10)$。\n\n为您提供卡方分布的以下基本性质：\n1.  **可加性：** 如果两个独立的随机变量 $U \\sim \\chi^2(k_1)$ 和 $V \\sim \\chi^2(k_2)$，那么它们的和 $U+V$ 也服从卡方分布，其自由度等于它们各自自由度之和：$U+V \\sim \\chi^2(k_1+k_2)$。此性质也意味着：如果 $U$ 和 $V$ 独立，且已知 $U$ 和 $U+V$ 都服从卡方分布，那么 $V$ 也必定服从卡方分布。\n2.  **方差公式：** 服从自由度为 $k$ 的卡方分布的随机变量 $W$ 的方差由公式 $\\text{Var}(W) = 2k$ 给出。\n\n根据这些信息，推导出随机变量 $Y$ 的方差。", "solution": "根据卡方分布的可加性，如果 $X\\sim\\chi^2(k_X)$ 和 $Y\\sim\\chi^2(k_Y)$ 相互独立，那么\n$$Z=X+Y\\sim\\chi^2(k_X+k_Y)\\,. $$\n在本题中，$k_X=4$ 且 $k_Z=10$，因此\n$$k_Y=k_Z-k_X=10-4=6\\,. $$\n\n自由度为 $k$ 的卡方随机变量的方差为 $\\text{Var}(W)=2k$。因此\n$$\\text{Var}(Y)=2k_Y=2\\cdot6=12\\,. $$", "answer": "$$\\boxed{12}$$", "id": "2278"}, {"introduction": "掌握了计算属性后，我们将注意力转向对分布形态的直观理解。这个练习鼓励你思考卡方分布的形状，特别是它的不对称性或偏度。理解这种正偏态对于正确解释依赖此分布的假设检验结果和构建置信区间至关重要，它能帮助你明白为什么卡方检验的拒绝域通常是单侧的。[@problem_id:1395039]", "problem": "设随机变量 $X$ 服从自由度为 $k=10$ 的卡方分布，记作 $X \\sim \\chi^2(10)$。自由度为 $k$ 的卡方分布的均值（或期望值）由 $\\mu = k$ 给出。该分布的中位数记作 $m$，是使该点的累积分布函数为 0.5 的值；即 $P(X \\le m) = 0.5$。\n\n对于此特定分布，以下哪个陈述正确描述了均值 $\\mu$ 和中位数 $m$ 之间的关系？\n\nA) $\\mu < m$\nB) $\\mu > m$\nC) $\\mu = m$\nD) 这种关系取决于从该分布中抽取的具体样本。\nE) 根据所提供的信息无法确定这种关系。", "solution": "问题要求我们确定自由度为 $k=10$ 的卡方分布的均值 $\\mu$ 和中位数 $m$ 之间的关系。\n\n首先，我们计算该分布的均值。问题陈述对于随机变量 $X \\sim \\chi^2(k)$，其均值为 $\\mu = k$。在本例中，$k=10$，所以均值为：\n$$ \\mu = 10 $$\n\n接下来，我们需要比较均值 $\\mu$ 和中位数 $m$。任何概率分布的均值和中位数之间的关系由其概率密度函数（PDF）的形状，特别是其对称性决定。\n对于一个完全对称的分布，均值和中位数相等。对于非对称或偏态分布，均值和中位数通常不相等。\n\n让我们分析卡方分布的形状。自由度为 $k$ 的卡方随机变量 $X$ 的概率密度函数（PDF）由下式给出：\n$$ f(x; k) = \\frac{1}{2^{k/2} \\Gamma(k/2)} x^{\\frac{k}{2} - 1} \\exp\\left(-\\frac{x}{2}\\right) \\quad \\text{for } x > 0 $$\n其中 $\\Gamma$ 是伽马函数。此分布的定义域是 $x \\in (0, \\infty)$。\n\n对于任何有限的 $k$ 值，此函数都不是对称的。具体来说，卡方分布是一个正偏态（或右偏态）分布。右偏态分布有一个向较高正值延伸的长尾。虽然当 $k$ 趋近于无穷大时，该分布变得更加对称（收敛于正态分布），但对于像 $k=10$ 这样的有限值，它表现出显著的正偏性。\n\n在正偏态分布中，均值会被较大的值拉向长的右尾。中位数是将概率质量一分为二的值，对尾部的这些极端值不太敏感。对于任何单峰、正偏态的连续分布，三个主要集中趋势度量有一个众所周知的排序：\n$$ \\text{mode} < \\text{median} < \\text{mean} $$\n\n由于自由度为 10 的卡方分布是正偏态的，其均值必须大于其中位数。\n因此，我们可以得出结论 $\\mu > m$。\n\n鉴于我们计算出的均值 $\\mu = 10$，这意味着中位数 $m$ 是某个小于 10 的值。\n让我们根据我们的结论 $\\mu > m$ 来回顾这些选项：\nA) $\\mu < m$：这是不正确的。\nB) $\\mu > m$：这与我们的结论相符。\nC) $\\mu = m$：这仅在对称分布的情况下才成立。\nD) 这种关系取决于从该分布中抽取的具体样本：这是不正确的。均值和中位数是总体分布的理论性质，而不是随机样本的性质。\nE) 根据所提供的信息无法确定这种关系：这是不正确的，因为卡方分布的性质足以确定这种关系。\n\n因此，正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "1395039"}]}