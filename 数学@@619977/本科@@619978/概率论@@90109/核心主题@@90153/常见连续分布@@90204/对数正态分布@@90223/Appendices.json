{"hands_on_practices": [{"introduction": "掌握一个概率分布的核心在于理解其基本性质，例如期望值。这个练习将指导你从第一性原理出发，推导对数正态分布的期望值。通过这个过程，你将看到底层正态分布的参数 $\\mu$ 和 $\\sigma^2$ 如何共同决定了对数正态变量的均值，这是一个重要且非直观的结果，对于金融和工程等领域的应用至关重要。[@problem_id:10657]", "problem": "如果一个随机变量 $X$ 的自然对数 $Y = \\ln(X)$ 服从正态分布，则称该随机变量 $X$ 服从对数正态分布。服从正态分布的变量 $Y$ 的概率密度函数 (PDF) 由下式给出：\n$$f_Y(y) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right)$$\n其中 $\\mu$ 是 $Y$ 的均值，$\\sigma^2$ 是 $Y$ 的方差。\n\n利用 $X$ 和 $Y$ 之间的关系以及给定的 $Y$ 的 PDF，推导随机变量 $X$ 的期望值，记为 $E[X]$。请用参数 $\\mu$ 和 $\\sigma$ 来表示你的答案。", "solution": "我们要计算\n$$E[X] = \\int_{0}^{\\infty} x f_{X}(x) \\,dx$$\n其中 $X=\\exp(Y)$ 且 $Y\\sim N(\\mu,\\sigma^2)$。使用变量代换 $y=\\ln(x)$ 可得 $x=e^{y}$ 和 $dx=e^{y}dy$，且 $X$ 的 PDF 为\n$$f_{X}(x)=f_{Y}(\\ln x)\\,\\frac{1}{x} \n=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\\,\\exp\\!\\Bigl(-\\frac{(\\ln x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr)\\,\\frac{1}{x}\\,. $$\n因此\n$$\nE[X]\n=\\int_{0}^{\\infty}x \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\n\\exp\\!\\Bigl(-\\frac{(\\ln x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr)\\,\\frac{1}{x} \\,dx\n=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\n\\int_{0}^{\\infty}\n\\exp\\!\\Bigl(-\\frac{(\\ln x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr) \\,dx.\n$$\n我们现在令\n$$t=\\frac{\\ln x-\\mu}{\\sigma},\\quad \\ln x=\\sigma t+\\mu,\\quad dx=\\sigma e^{\\sigma t+\\mu}\\,dt,$$\n这样 $x=e^{\\sigma t+\\mu}$，且积分限从 $x=0\\to t=-\\infty$、$x\\to\\infty\\to t=+\\infty$。代入可得\n$$\nE[X]\n=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\frac{(\\sigma t)^{2}}{2\\sigma^{2}}\\Bigr)\\,\\sigma e^{\\sigma t+\\mu}\\,dt\n=\\frac{\\sigma e^{\\mu}}{\\sqrt{2\\pi\\sigma^{2}}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\tfrac{t^{2}}{2}+\\sigma t\\Bigr)\\,dt.\n$$\n对指数部分进行配方：\n$$\n-\\tfrac{t^{2}}{2}+\\sigma t\n=-\\tfrac{1}{2}\\bigl(t^{2}-2\\sigma t\\bigr)\n=-\\tfrac{1}{2}\\bigl((t-\\sigma)^{2}-\\sigma^{2}\\bigr)\n=-\\tfrac{(t-\\sigma)^{2}}{2}+\\tfrac{\\sigma^{2}}{2}\\,.\n$$\n于是\n$$\nE[X]\n=\\frac{e^{\\mu}}{\\sqrt{2\\pi}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\tfrac{(t-\\sigma)^{2}}{2}+\\tfrac{\\sigma^{2}}{2}\\Bigr)\\,dt\n=e^{\\mu+\\frac{\\sigma^{2}}{2}}\n\\frac{1}{\\sqrt{2\\pi}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\tfrac{u^{2}}{2}\\Bigr)\\,du\n$$\n（令 $u=t-\\sigma$）。剩下的高斯积分为 $\\sqrt{2\\pi}$，从而得到最终结果。", "answer": "$$\\boxed{e^{\\mu + \\frac{\\sigma^{2}}{2}}}$$", "id": "10657"}, {"introduction": "理论知识的价值体现在解决实际问题上，而计算特定事件的发生概率是概率论应用的核心。本练习将向你展示如何利用对数正态分布与其对应的正态分布之间的关键联系。通过将问题转化为我们所熟悉的标准正态分布，你可以使用标准正态累积分布函数（CDF）$\\Phi(z)$ 来轻松求解概率，这是处理对数正态变量的一项基本技能。[@problem_id:10634]", "problem": "如果一个随机变量 $X$ 的自然对数 $Y = \\ln(X)$ 服从正态分布，则称该随机变量 $X$ 服从对数正态分布。正态变量 $Y$ 的概率密度函数 (PDF) 由下式给出：\n$$f_Y(y) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right)$$\n其中 $\\mu$ 是 $Y$ 的均值，$\\sigma$ 是 $Y$ 的标准差。\n\n*标准正态*分布（均值为 $0$、标准差为 $1$ 的正态分布）的累积分布函数 (CDF)（记为 $\\Phi(z)$）定义为一个标准正态随机变量小于或等于 $z$ 的概率。即：\n$$\\Phi(z) = P(Z \\le z) = \\int_{-\\infty}^{z} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{t^2}{2}\\right) dt$$\n\n根据这些信息，推导对数正态变量 $X$ 超过值 $e^{\\mu+\\sigma}$ 的概率表达式，即 $P(X > e^{\\mu+\\sigma})$。最终答案应使用标准正态CDF $\\Phi$ 来表示。", "solution": "我们有 $X$ 服从对数正态分布，且 $Y=\\ln X\\sim N(\\mu,\\sigma^2)$。 那么\n$$P\\bigl(X>e^{\\mu+\\sigma}\\bigr)\n  =P\\bigl(\\ln X>\\mu+\\sigma\\bigr)\n  =P\\bigl(Y>\\mu+\\sigma\\bigr).$$\n通过 $Z=(Y-\\mu)/\\sigma\\sim N(0,1)$ 来标准化 $Y$：\n$$P\\bigl(Y>\\mu+\\sigma\\bigr)\n  =P\\Bigl(\\frac{Y-\\mu}{\\sigma}>1\\Bigr)\n  =P(Z>1)\n  =1-\\Phi(1).$$", "answer": "$$\\boxed{1-\\Phi(1)}$$", "id": "10634"}, {"introduction": "在现实世界的数据分析中，我们通常拥有一组观测数据，并需要找出最能描述这些数据的分布参数。本练习将引导你应用统计推断中一个极为强大的工具——最大似然估计法（MLE）。你将学习如何为对数正态分布的参数 $\\mu$ 和 $\\sigma^2$ 推导其估计量，这个过程不仅能加深你对分布背后数学结构的理解，也为你掌握现代统计建模奠定了基础。[@problem_id:1401201]", "problem": "一组由 $n$ 个独立同分布 (i.i.d.) 的随机变量 $X_1, X_2, \\dots, X_n$ 所代表的测量值，服从对数正态分布。\n\n若一个随机变量 $X$ 的自然对数 $\\ln(X)$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，则称 $X$ 服从参数为 $\\mu$ 和 $\\sigma^2$ 的对数正态分布。$X$ 的概率密度函数 (PDF) 由下式给出：\n$$\nf(x; \\mu, \\sigma^2) = \\frac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(x) - \\mu)^2}{2\\sigma^2}\\right)\n$$\n其中 $x > 0$，$\\mu \\in \\mathbb{R}$，且 $\\sigma > 0$。\n\n给定一组观测样本数据 $x_1, x_2, \\dots, x_n$，求参数 $\\mu$ 和 $\\sigma^2$ 的最大似然估计量 (MLEs)，分别记为 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$。请用样本观测值表示 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$ 的最终表达式。", "solution": "设 $X_{1},\\dots,X_{n}$ 独立同分布，其对数正态密度函数为\n$$\nf(x;\\mu,\\sigma^{2})=\\frac{1}{x\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(\\ln(x)-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad x>0,\\ \\mu\\in\\mathbb{R},\\ \\sigma>0.\n$$\n对于观测值 $x_{1},\\dots,x_{n}$，其似然函数为\n$$\nL(\\mu,\\sigma^{2})=\\prod_{i=1}^{n}\\frac{1}{x_{i}\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(\\ln(x_{i})-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n其对数似然函数为\n$$\n\\ell(\\mu,\\sigma^{2})=\\ln L(\\mu,\\sigma^{2})=-n\\ln\\sigma-\\sum_{i=1}^{n}\\ln(x_{i})-\\frac{n}{2}\\ln(2\\pi)-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right)^{2}.\n$$\n等价地，使用 $\\ln\\sigma=\\frac{1}{2}\\ln(\\sigma^{2})$，\n$$\n\\ell(\\mu,\\sigma^{2})=-\\frac{n}{2}\\ln(\\sigma^{2})-\\sum_{i=1}^{n}\\ln(x_{i})-\\frac{n}{2}\\ln(2\\pi)-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right)^{2}.\n$$\n对 $\\mu$ 求导：\n$$\n\\frac{\\partial \\ell}{\\partial \\mu}=-\\frac{1}{2\\sigma^{2}}\\cdot 2\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right)(-1)=\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right).\n$$\n令其为零并求解：\n$$\n\\sum_{i=1}^{n}\\ln(x_{i})-n\\mu=0\\quad\\Rightarrow\\quad \\hat{\\mu}=\\frac{1}{n}\\sum_{i=1}^{n}\\ln(x_{i}).\n$$\n二阶导数 $\\partial^{2}\\ell/\\partial\\mu^{2}=-n/\\sigma^{2}<0$ 确认了 $\\mu$ 处为极大值。\n\n现在对 $\\sigma^{2}$ 求导。设 $S(\\mu)=\\sum_{i=1}^{n}(\\ln(x_{i})-\\mu)^{2}$。则\n$$\n\\ell(\\mu,\\sigma^{2})=-\\frac{n}{2}\\ln(\\sigma^{2})-\\sum_{i=1}^{n}\\ln(x_{i})-\\frac{n}{2}\\ln(2\\pi)-\\frac{S(\\mu)}{2\\sigma^{2}},\n$$\n所以\n$$\n\\frac{\\partial \\ell}{\\partial \\sigma^{2}}=-\\frac{n}{2}\\frac{1}{\\sigma^{2}}+\\frac{S(\\mu)}{2}\\frac{1}{\\sigma^{4}}.\n$$\n令其为零：\n$$\n-\\frac{n}{2}\\frac{1}{\\sigma^{2}}+\\frac{S(\\mu)}{2}\\frac{1}{\\sigma^{4}}=0\\ \\Longrightarrow\\ -n\\sigma^{2}+S(\\mu)=0\\ \\Longrightarrow\\ \\hat{\\sigma}^{2}=\\frac{S(\\hat{\\mu})}{n}.\n$$\n代入 $\\hat{\\mu}$：\n$$\n\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\frac{1}{n}\\sum_{j=1}^{n}\\ln(x_{j})\\right)^{2}.\n$$\n对变量 $t=\\sigma^{2}$ 进行二阶导数检验，可得 $\\ell''(t)=(n/2)t^{-2}-S(\\mu)t^{-3}$，当 $t=\\hat{\\sigma}^{2}$ 且 $S(\\hat{\\mu})=n\\hat{\\sigma}^{2}$ 时，得出 $\\ell''(\\hat{\\sigma}^{2})=-(n/2)\\hat{\\sigma}^{-4}<0$，这证实了该点为极大值。\n\n因此，最大似然估计量是变换后数据 $\\ln(x_{i})$ 的样本均值和（未修正的）样本方差。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{n}\\sum_{i=1}^{n}\\ln(x_{i}) & \\frac{1}{n}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\frac{1}{n}\\sum_{j=1}^{n}\\ln(x_{j})\\right)^{2}\\end{pmatrix}}$$", "id": "1401201"}]}