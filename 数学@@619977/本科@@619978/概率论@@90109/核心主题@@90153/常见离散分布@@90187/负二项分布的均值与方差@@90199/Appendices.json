{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，这个练习将帮助你熟悉负二项分布的关键度量。通过计算在达到预定成功次数（在本例中为“关键失败次数”）之前所需试验次数的标准差，你可以练习直接应用负二项分布的方差公式。这个练习旨在让你体会如何量化这类“等待直到”情景中的可变性或不确定性。[@problem_id:1373790]", "problem": "一个数据科学家团队正在评估一个用于预测用户流失的新机器学习模型的性能。该模型在一系列用户数据流上进行顺序测试。对单个用户数据的每次测试都是一次独立的试验。如果模型错误地将一个非流失用户预测为流失用户，则记录一次“严重失败”，该事件发生的恒定概率为 $p = 0.15$。为了充分评估模型的最坏情况性能，测试协议要求该过程持续进行，直到观察到恰好 $r=60$ 次严重失败为止。\n\n计算完成此协议必须测试的总用户数的标准差。将最终答案四舍五入到四位有效数字。", "solution": "设 $N$ 表示直到观察到恰好 $r=60$ 次严重失败时所测试的总用户数。每次用户测试都是一次独立的伯努利试验，发生严重失败的概率为 $p=0.15$。为获得 $r$ 次此类事件所需的试验次数服从参数为 $(r,p)$ 的负二项分布，该分布计算的是为达到 $r$ 次成功（此处指严重失败）所需的总试验次数。\n\n对于 $N \\sim \\text{NegBin}(r,p)$（为达到 $r$ 次成功，成功概率为 $p$ 的试验次数），其均值和方差为\n$$\n\\mathbb{E}[N] = \\frac{r}{p}, \\qquad \\operatorname{Var}(N) = \\frac{r(1-p)}{p^{2}}.\n$$\n因此，标准差为\n$$\n\\operatorname{SD}(N) = \\sqrt{\\operatorname{Var}(N)} = \\frac{\\sqrt{r(1-p)}}{p}.\n$$\n\n代入 $r=60$ 和 $p=0.15$ 可得\n$$\n\\operatorname{SD}(N) = \\frac{\\sqrt{60(1-0.15)}}{0.15} = \\frac{\\sqrt{51}}{0.15}.\n$$\n数值计算如下：\n$$\n\\sqrt{51} \\approx 7.141428428,\\quad \\frac{\\sqrt{51}}{0.15} \\approx 47.60952286.\n$$\n四舍五入到四位有效数字，得到 $47.61$。", "answer": "$$\\boxed{47.61}$$", "id": "1373790"}, {"introduction": "在掌握了基础计算之后，让我们来挑战一个更具分析性的问题。这个练习要求你扮演一名科学侦探的角色：根据观测到的均值和方差，反向推断出过程的内在参数 $r$ 和 $p$。这类“逆向问题”在科学研究和工程中非常普遍，它训练我们利用统计特性来揭示一个随机过程的根本机制。[@problem_id:1373740]", "problem": "在一次高能物理实验中，一位科学家正在寻找一种稀有粒子衰变的证据。该实验由一系列独立的试验（或称“运行”）组成，在任何单次运行中观测到特定衰变事件的概率是一个恒定值 $p$。实验被设计为持续进行，直到记录到预先设定的整数次成功探测，即 $r$ 次。\n\n令随机变量 $X$ 表示为实现第 $r$ 次成功探测所需的总运行次数。基于来自类似实验的大量历史数据，发现 $X$ 的期望值为 $\\mathbb{E}[X] = 20$，$X$ 的方差为 $\\operatorname{Var}(X) = 60$。\n\n使用这些信息，确定成功探测的整数次数 $r$，以及单次运行中成功探测的概率 $p$。将 $p$ 的最终答案表示为精确分数。", "solution": "随机变量 $X$ 服从参数为 $r$ 和 $p$ 的负二项分布，因为它计算的是在每次独立试验中成功概率为 $p$ 的情况下，获得 $r$ 次成功所需的试验次数。对于此分布，已知公式为\n$$\\mathbb{E}[X]=\\frac{r}{p},$$\n$$\\operatorname{Var}(X)=\\frac{r\\,(1-p)}{p^{2}}.$$\n我们已知 $\\mathbb{E}[X]=20$ 且 $\\operatorname{Var}(X)=60$。根据第一个方程，\n$$\\frac{r}{p}=20\\quad\\Longrightarrow\\quad r=20\\,p.$$\n将 $r=20\\,p$ 代入方差公式，得到\n$$\\frac{20\\,p\\,(1-p)}{p^{2}}=60\\quad\\Longrightarrow\\quad\\frac{20\\,(1-p)}{p}=60.$$\n方程两边同乘以 $p$，\n$$20\\,(1-p)=60\\,p\\quad\\Longrightarrow\\quad20-20\\,p=60\\,p\\quad\\Longrightarrow\\quad20=80\\,p\\quad\\Longrightarrow\\quad p=\\frac{1}{4}.$$\n最后，\n$$r=20\\,p=20\\cdot\\frac{1}{4}=5.$$\n因此，所需的成功次数为整数 $r=5$，单次运行的成功概率为 $p=\\frac{1}{4}$。", "answer": "$$\\boxed{\\begin{pmatrix}5 & \\frac{1}{4}\\end{pmatrix}}$$", "id": "1373740"}, {"introduction": "最后一个练习将引导你探索负二项分布背后一个深刻而关键的特性：无记忆性。问题要求你计算在已经取得部分成功后，还需要多少额外的试验才能达到最终目标。这个思想实验将挑战你对条件期望的直觉，并阐明对于一个由独立伯努利试验构成的过程，“过去”并不会影响对“未来”的期望。[@problem_id:1373765]", "problem": "在一项高能物理实验中，科学家们正在寻找一种特定的稀有粒子衰变。该实验被建模为一系列独立的伯努利试验，每次试验对应一个固定时长的离散时间间隔。在任何给定的时间间隔内，观测到恰好一次衰变事件（一次“成功”）的概率为 $p$，而观测到没有事件发生（一次“失败”）的概率为 $1-p$。在单个时间间隔内观测到多于一次事件的概率被认为是可忽略不计的。\n\n当观测到总共 $r$ 次衰变事件时，就正式宣布一项科学发现。该实验已经运行了总共 $k$ 个时间间隔，在此期间，记录到了恰好 $s$ 次衰变事件，其中 $s < r$。\n\n假设实验在这些相同条件下继续进行，要达到总共 $r$ 次衰变事件的目标，所需的*额外*时间间隔的期望数量是多少？请用 $p, r,$ 和 $s$ 表示您的答案，形式为一个闭式解析表达式。", "solution": "将每个时间间隔建模为一次独立的伯努利试验，其成功概率为 $p$（恰好一次衰变），失败概率为 $1-p$（没有衰变）。在观测到 $s$ 次成功之后，令 $T$ 表示达到总共 $r$ 次成功所需的额外时间间隔数，此时还需要 $r-s$ 次成功。\n\n定义 $X_{i}$ 为从 $(s+i-1)$ 次成功到 $(s+i)$ 次成功所需的时间间隔数，其中 $i=1,2,\\dots,r-s$。根据伯努利试验的独立性和平稳性，每个 $X_{i}$ 都是一个独立的几何随机变量（计算直到并包括成功那次的总试验次数），其参数为 $p$。即，对于 $n \\in \\{1,2,\\dots\\}$,\n$$\n\\mathbb{P}(X_{i}=n)=(1-p)^{n-1}p.\n$$\n令 $q=1-p$。$X_{i}$ 的期望为\n$$\n\\mathbb{E}[X_{i}]=\\sum_{n=1}^{\\infty} n q^{\\,n-1} p\n= p \\sum_{n=1}^{\\infty} n q^{\\,n-1}.\n$$\n使用幂级数恒等式（对 $|q|<1$ 成立），\n$$\n\\sum_{n=1}^{\\infty} n q^{\\,n-1}=\\frac{1}{(1-q)^{2}},\n$$\n我们得到\n$$\n\\mathbb{E}[X_{i}]=p \\cdot \\frac{1}{(1-q)^{2}}=p \\cdot \\frac{1}{p^{2}}=\\frac{1}{p}.\n$$\n达到 $r$ 次成功所需的总额外时间间隔数是以下各项之和\n$$\nT=\\sum_{i=1}^{r-s} X_{i},\n$$\n因此根据期望的线性性质以及 $X_{i}$ 的独立性，\n$$\n\\mathbb{E}[T]=\\sum_{i=1}^{r-s} \\mathbb{E}[X_{i}]=(r-s)\\cdot \\frac{1}{p}=\\frac{r-s}{p}.\n$$\n这个期望的额外时间与已经过的间隔数 $k$ 无关，仅取决于剩余所需的成功次数 $r-s$ 和每个时间间隔的成功概率 $p$。", "answer": "$$\\boxed{\\frac{r-s}{p}}$$", "id": "1373765"}]}