{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是实践。这个练习将带你从一个熟悉且直观的场景——掷骰子——入手，将一个实际问题转化为多项分布模型。通过这个练习，你将直接应用多项概率质量函数来计算特定组合结果出现的精确概率，这是掌握多项分布的基础。[@problem_id:12523]", "problem": "考虑一个有 $m$ 个面的公正骰子，其面上的数字为整数 $\\{1, 2, \\dots, m\\}$。该骰子被独立投掷 $n$ 次。投掷结果根据两个整数阈值 $a$ 和 $b$ 分为三个不同的类别，其中 $1 \\le a < b < m$。\n\n对于单次投掷，类别定义如下：\n- **类别 1**：结果小于或等于 $a$。\n- **类别 2**：结果大于 $a$ 且小于或等于 $b$。\n- **类别 3**：结果大于 $b$。\n\n推导一个通用表达式，用于计算类别 1 恰好出现 $n_1$ 次，类别 2 出现 $n_2$ 次，以及类别 3 出现 $n_3$ 次的概率，其中 $n_1 + n_2 + n_3 = n$。用 $n$、$m$、$a$、$b$、$n_1$、$n_2$ 和 $n_3$ 表示该表达式。", "solution": "我们将每次投掷划分为三个类别，其概率分别为\n$$p_1=\\frac{a}{m},\\quad p_2=\\frac{b-a}{m},\\quad p_3=\\frac{m-b}{m},$$  \n并注意到 $p_1+p_2+p_3=1$ 且 $n_1+n_2+n_3=n$。  \n\n根据多项分布，观察到类别 1 出现恰好 $n_1$ 次，类别 2 出现 $n_2$ 次，以及类别 3 出现 $n_3$ 次的概率为\n$$\n\\frac{n!}{n_1!\\,n_2!\\,n_3!}\\,p_1^{n_1}\\,p_2^{n_2}\\,p_3^{n_3}.\n$$  \n代入 $p_1,p_2,p_3$ 的表达式，即可得到所求的公式。", "answer": "$$\\boxed{\\frac{n!}{n_1!n_2!n_3!}\\Bigl(\\frac{a}{m}\\Bigr)^{n_1}\\Bigl(\\frac{b-a}{m}\\Bigr)^{n_2}\\Bigl(\\frac{m-b}{m}\\Bigr)^{n_3}}$$", "id": "12523"}, {"introduction": "在实际应用中，我们常常需要根据分析目的调整我们的观察视角。这个练习探讨了多项分布的一个重要且实用的性质：合并类别。你将学习到，当我们将原始的几个结果类别合并成一个更广泛的类别时，整个系统仍然可以用一个（更简单的）多项分布来描述，这展示了该模型的灵活性和内在一致性。[@problem_id:12547]", "problem": "一个实验包含 $n$ 次独立试验。每次试验可能产生四种互斥结果之一，分别标记为类别1、类别2、类别3和类别4。对于任意一次试验，结果为类别 $i$ 的概率是 $p_i$，其中 $i \\in \\{1, 2, 3, 4\\}$。这些概率在所有试验中保持不变，并且它们的总和为1：$p_1 + p_2 + p_3 + p_4 = 1$。\n\n这种情况可以用多项分布来描述。随机变量 $X_1, X_2, X_3, X_4$ 分别表示在 $n$ 次试验中每个类别被观测到的次数，其中 $\\sum_{i=1}^4 X_i = n$。\n\n现在，假设我们不再关心如何区分类别1和类别2。我们决定将它们合并成一个新的类别，称之为“A组”。另外两个类别保持不变。\n\n令随机变量 $X_A$ 为A组中的结果数量，$X_3$ 为类别3中的结果数量，$X_4$ 为类别4中的结果数量。\n\n推导观测到A组中有 $x_A$ 个项目、类别3中有 $x_3$ 个项目、类别4中有 $x_4$ 个项目的特定结果的概率质量函数，其中 $x_A + x_3 + x_4 = n$。用 $n$、$x_A$、$x_3$、$x_4$ 以及初始概率 $p_1, p_2, p_3, p_4$ 来表示你的答案。", "solution": "我们从四个类别的多项分布的概率质量函数（pmf）开始，其计数为 $x_1,x_2,x_3,x_4$ 且满足 $\\sum_{i=1}^4x_i=n$：\n$$\nP(X_1=x_1,X_2=x_2,X_3=x_3,X_4=x_4)\n=\\frac{n!}{x_1!\\,x_2!\\,x_3!\\,x_4!}\\,p_1^{x_1}p_2^{x_2}p_3^{x_3}p_4^{x_4}.\n$$\n我们希望在 $x_1+x_2=x_A$ 的约束下对 $X_1,X_2$ 进行边缘化。对所有可能的分割求和，\n$$\nP(X_A=x_A,X_3=x_3,X_4=x_4)\n=\\sum_{x_1+x_2=x_A}\\frac{n!}{x_1!\\,x_2!\\,x_3!\\,x_4!}\\,p_1^{x_1}p_2^{x_2}p_3^{x_3}p_4^{x_4}.\n$$\n提取不依赖于 $x_1,x_2$ 的项，并注意二项式展开：\n$$\nP=\\frac{n!}{x_3!\\,x_4!}\\,p_3^{x_3}p_4^{x_4}\n\\sum_{x_1+x_2=x_A}\\frac{1}{x_1!\\,x_2!}p_1^{x_1}p_2^{x_2}\n=\\frac{n!}{x_A!\\,x_3!\\,x_4!}\\,(p_1+p_2)^{x_A}p_3^{x_3}p_4^{x_4}.\n$$\n这就是分组后计数 $(X_A,X_3,X_4)$ 的概率质量函数（pmf），其中 $x_A+x_3+x_4=n$。", "answer": "$$\\boxed{\\frac{n!}{x_A!\\,x_3!\\,x_4!}(p_1+p_2)^{x_A}p_3^{x_3}p_4^{x_4}}$$", "id": "12547"}, {"introduction": "概率推理的精髓之一在于根据已知信息更新我们的判断。这个练习将带你进入一个更深入的层次，探索多项分布框架下的条件概率。当给定一个关于部分结果的特定信息时（例如，在批次中发现的总缺陷数），我们如何推断这些结果内部的构成？解决这个问题将揭示多项分布与二项分布之间深刻而有趣的关系。[@problem_id:1402359]", "problem": "在一家半导体制造厂中，微处理器被生产出来并接受质量控制测试。每个芯片被独立地归类为四种互斥状态之一：‘合格’（Pass，满足所有规格）、‘次要缺陷’（Minor Flaw，功能正常但有微小偏差）、‘主要缺陷’（Major Flaw，无法工作）或‘测试错误’（Test Error，测试结果不确定）。\n\n根据大量的历史数据，每种结果的概率是已知的：\n- 芯片‘合格’的概率是 $p_P$。\n- 芯片有‘次要缺陷’的概率是 $p_m$。\n- 芯片有‘主要缺陷’的概率是 $p_M$。\n- 出现‘测试错误’的概率是 $p_U$。\n这些概率之和为一：$p_P + p_m + p_M + p_U = 1$。\n\n一位质量保证工程师检查一个随机抽取的包含 $n$ 个微处理器的批次。在审查测试结果时，工程师发现该批次中总共有恰好 $k$ 个处理器有缺陷（即，它们要么有‘次要缺陷’，要么有‘主要缺陷’）。给定关于该批次的这一特定信息，确定在这 $k$ 个有缺陷的处理器中，恰好有 $j$ 个具有‘次要缺陷’的概率，其中 $0 \\le j \\le k$。\n\n请以一个关于 $j$、$k$、$p_m$ 和 $p_M$ 的单封闭形式解析表达式给出你的答案。", "solution": "令 $N_{m}$ 和 $N_{M}$ 分别表示在一批 $n$ 个芯片中具有‘次要缺陷’和‘主要缺陷’的芯片数量。定义 $p_{f} = p_{m} + p_{M}$ 为芯片有缺陷的总概率，以及 $p_{o} = 1 - p_{f} = p_{P} + p_{U}$ 为无缺陷或测试错误的概率。三元组 $(N_{m}, N_{M}, N_{o})$（其中 $N_{o} = n - N_{m} - N_{M}$）服从多项分布，其参数为 $n$ 和类别概率 $(p_{m}, p_{M}, p_{o})$。\n\n我们已知事件 $A = \\{N_{m} + N_{M} = k\\}$。我们要求解\n$$\n\\Pr(N_{m} = j \\mid A) = \\frac{\\Pr(N_{m} = j, N_{M} = k - j)}{\\Pr(N_{m} + N_{M} = k)}。\n$$\n分子是 $N_{o} = n - k$ 时的多项概率：\n$$\n\\Pr(N_{m} = j, N_{M} = k - j) = \\frac{n!}{j!\\,(k - j)!\\,(n - k)!}\\,p_{m}^{j}\\,p_{M}^{k - j}\\,p_{o}^{n - k}。\n$$\n分母仅取决于和 $N_{f} = N_{m} + N_{M}$，该和服从参数为 $(n, p_{f})$ 的二项分布：\n$$\n\\Pr(N_{m} + N_{M} = k) = \\binom{n}{k} p_{f}^{k} (1 - p_{f})^{n - k} = \\binom{n}{k} p_{f}^{k} p_{o}^{n - k}。\n$$\n因此，\n$$\n\\Pr(N_{m} = j \\mid N_{m} + N_{M} = k)\n= \\frac{\\frac{n!}{j!\\,(k - j)!\\,(n - k)!}\\,p_{m}^{j}\\,p_{M}^{k - j}\\,p_{o}^{n - k}}{\\binom{n}{k} p_{f}^{k} p_{o}^{n - k}}\n= \\frac{\\frac{n!}{j!\\,(k - j)!\\,(n - k)!}}{\\frac{n!}{k!\\,(n - k)!}} \\left(\\frac{p_{m}}{p_{f}}\\right)^{j} \\left(\\frac{p_{M}}{p_{f}}\\right)^{k - j}。\n$$\n使用 $\\frac{\\frac{n!}{j!\\,(k - j)!\\,(n - k)!}}{\\frac{n!}{k!\\,(n - k)!}} = \\frac{k!}{j!\\,(k - j)!} = \\binom{k}{j}$ 和 $p_{f} = p_{m} + p_{M}$，我们得到\n$$\n\\Pr(N_{m} = j \\mid N_{m} + N_{M} = k) = \\binom{k}{j} \\left(\\frac{p_{m}}{p_{m} + p_{M}}\\right)^{j} \\left(\\frac{p_{M}}{p_{m} + p_{M}}\\right)^{k - j}。\n$$\n这就是具有 $k$ 次试验和成功概率为 $\\frac{p_{m}}{p_{m} + p_{M}}$ 的二项分布，这与以‘有缺陷’为条件的预期相符。", "answer": "$$\\boxed{\\binom{k}{j}\\left(\\frac{p_{m}}{p_{m}+p_{M}}\\right)^{j}\\left(\\frac{p_{M}}{p_{m}+p_{M}}\\right)^{k-j}}$$", "id": "1402359"}]}