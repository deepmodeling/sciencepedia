{"hands_on_practices": [{"introduction": "我们从一个离散的例子开始，来巩固条件方差的基本计算。这个练习要求我们在已知一个随机选取的整数是素数的情况下，计算这个整数的方差。通过这个直接的计算，我们可以练习如何确定条件概率分布，并利用条件期望来求解条件方差 $\\mathrm{Var}(X|A) = \\mathbb{E}[X^2|A] - (\\mathbb{E}[X|A])^2$，这是理解更复杂情景的基础。[@problem_id:1351953]", "problem": "设 $X$ 是一个随机变量，表示从集合 $S = \\{1, 2, 3, \\dots, 30\\}$ 中均匀随机选取的一个整数。设 $A$ 是所选整数 $X$ 为质数的事件。\n\n计算在事件 $A$ 发生的条件下，$X$ 的方差。请将最终答案表示为最简精确分数形式。", "solution": "设 $X$ 在 $S=\\{1,2,\\dots,30\\}$ 上均匀分布，且设 $A$ 是 $X$ 为质数的事件。$S$ 中的质数是\n$$\n\\{2,3,5,7,11,13,17,19,23,29\\},\n$$\n因此 $|A|=10$，并且在给定 $A$ 的条件下，$X$ 在此集合上均匀分布：对于集合中的每个质数 $p$，都有 $\\mathbb{P}(X=p\\mid A)=\\frac{1}{10}$。\n\n计算条件期望：\n$$\n\\mathbb{E}[X\\mid A]=\\frac{1}{10}\\sum_{p\\in A}p=\\frac{1}{10}\\left(2+3+5+7+11+13+17+19+23+29\\right)=\\frac{129}{10}.\n$$\n\n计算条件二阶矩：\n$$\n\\mathbb{E}[X^{2}\\mid A]=\\frac{1}{10}\\sum_{p\\in A}p^{2}=\\frac{1}{10}\\left(4+9+25+49+121+169+289+361+529+841\\right)=\\frac{2397}{10}.\n$$\n\n使用方差恒等式 $\\operatorname{Var}(X\\mid A)=\\mathbb{E}[X^{2}\\mid A]-\\left(\\mathbb{E}[X\\mid A]\\right)^{2}$：\n$$\n\\operatorname{Var}(X\\mid A)=\\frac{2397}{10}-\\left(\\frac{129}{10}\\right)^{2}\n=\\frac{23970}{100}-\\frac{16641}{100}\n=\\frac{7329}{100}.\n$$\n此分数为最简形式，因为 $\\gcd(7329,100)=1$。", "answer": "$$\\boxed{\\frac{7329}{100}}$$", "id": "1351953"}, {"introduction": "从离散世界过渡到连续世界，我们来探讨一个几何概率问题。想象一个飞镖随机投向一个圆形靶子，我们只关心那些击中靶心的投掷，并计算飞镖落点到中心距离的方差。这个练习将帮助你掌握如何通过条件来修正连续随机变量的概率密度函数，并在此基础上计算其方variance，这在处理以几何或空间区域为条件的问题时非常有用。[@problem_id:1351920]", "problem": "一支飞镖被投向一个半径为 $R$ 的大圆形靶子。飞镖击中靶子的点由一个在整个靶盘面积上均匀分布的随机变量来描述。一个半径为 $r$（其中 $0 < r < R$）的较小同心圆定义了靶心区域。一位观察者注意到某次投掷落在了靶心内。\n\n设 $D$ 是表示飞镖落点到靶心距离的随机变量。计算在已知飞镖落在靶心内的情况下，$D$ 的方差。将你的答案表示为以靶心半径 $r$ 表示的封闭形式解析表达式。", "solution": "设随机变量 $D$ 表示飞镖落点到靶心的距离。飞镖的位置在半径为 $R$ 的靶盘上均匀分布。我们被要求计算在事件 $B$（即飞镖落在靶心内，也就是区域 $D \\le r$）发生的条件下，$D$ 的方差。这就是条件方差 $\\text{Var}(D|D \\le r)$。\n\n首先，我们确定 $D$ 的无条件概率分布。$D$ 的累积分布函数（CDF），对于一个在 $0$ 和 $R$ 之间的值 $d$，是概率 $P(D \\le d)$。由于分布在面积上是均匀的，这个概率是半径为 $d$ 的圆盘面积与半径为 $R$ 的总靶盘面积之比。\n$$F_D(d) = P(D \\le d) = \\frac{\\pi d^2}{\\pi R^2} = \\frac{d^2}{R^2} \\quad \\text{for } 0 \\le d \\le R$$\n$D$ 的概率密度函数（PDF）$f_D(d)$ 是 CDF 相对于 $d$ 的导数：\n$$f_D(d) = \\frac{\\mathrm{d}}{\\mathrm{d}d}F_D(d) = \\frac{2d}{R^2} \\quad \\text{for } 0 \\le d \\le R$$\n其他情况下 $f_D(d) = 0$。\n\n接下来，我们求解在事件 $B = \\{D \\le r\\}$ 条件下 $D$ 的条件 PDF。我们将这个条件 PDF 记为 $f_{D|B}(d)$。对于 $d > r$，概率为零。对于 $0 \\le d \\le r$，条件 CDF 为：\n$$F_{D|B}(d) = P(D \\le d | D \\le r) = \\frac{P(D \\le d \\text{ and } D \\le r)}{P(D \\le r)}$$\n因为 $d \\le r$，事件 $\\{D \\le d\\}$ 是 $\\{D \\le r\\}$ 的子集，所以它们的交集就是 $\\{D \\le d\\}$。\n$$F_{D|B}(d) = \\frac{P(D \\le d)}{P(D \\le r)} = \\frac{F_D(d)}{F_D(r)} = \\frac{d^2/R^2}{r^2/R^2} = \\frac{d^2}{r^2} \\quad \\text{for } 0 \\le d \\le r$$\n条件 PDF $f_{D|B}(d)$ 是 $0 \\le d \\le r$ 时条件 CDF 的导数：\n$$f_{D|B}(d) = \\frac{\\mathrm{d}}{\\mathrm{d}d} \\left( \\frac{d^2}{r^2} \\right) = \\frac{2d}{r^2} \\quad \\text{for } 0 \\le d \\le r$$\n其他情况下 $f_{D|B}(d) = 0$。这是我们将在所有后续计算中使用的 PDF。\n\n方差由公式 $\\text{Var}(D|B) = E[D^2|B] - (E[D|B])^2$ 给出。我们需要计算该条件分布的一阶矩和二阶矩。\n\n首先，我们计算条件期望（一阶矩）$E[D|B]$：\n$$E[D|B] = \\int_{-\\infty}^{\\infty} d \\cdot f_{D|B}(d) \\, \\mathrm{d}d = \\int_{0}^{r} d \\cdot \\frac{2d}{r^2} \\, \\mathrm{d}d$$\n$$E[D|B] = \\frac{2}{r^2} \\int_{0}^{r} d^2 \\, \\mathrm{d}d = \\frac{2}{r^2} \\left[ \\frac{d^3}{3} \\right]_{0}^{r} = \\frac{2}{r^2} \\left( \\frac{r^3}{3} - 0 \\right) = \\frac{2r}{3}$$\n\n接下来，我们计算条件二阶矩 $E[D^2|B]$：\n$$E[D^2|B] = \\int_{-\\infty}^{\\infty} d^2 \\cdot f_{D|B}(d) \\, \\mathrm{d}d = \\int_{0}^{r} d^2 \\cdot \\frac{2d}{r^2} \\, \\mathrm{d}d$$\n$$E[D^2|B] = \\frac{2}{r^2} \\int_{0}^{r} d^3 \\, \\mathrm{d}d = \\frac{2}{r^2} \\left[ \\frac{d^4}{4} \\right]_{0}^{r} = \\frac{2}{r^2} \\left( \\frac{r^4}{4} - 0 \\right) = \\frac{r^2}{2}$$\n\n最后，我们计算条件方差：\n$$\\text{Var}(D|B) = E[D^2|B] - (E[D|B])^2 = \\frac{r^2}{2} - \\left(\\frac{2r}{3}\\right)^2$$\n$$\\text{Var}(D|B) = \\frac{r^2}{2} - \\frac{4r^2}{9} = r^2 \\left( \\frac{1}{2} - \\frac{4}{9} \\right) = r^2 \\left( \\frac{9 - 8}{18} \\right) = \\frac{r^2}{18}$$", "answer": "$$\\boxed{\\frac{r^{2}}{18}}$$", "id": "1351920"}, {"introduction": "最后，我们将条件方差应用到一个更高级的统计建模场景中，这涉及到贝叶斯推断的思想。在这个假设的数据中心问题中，我们将利用一天的数据来更新我们对系统请求率的认知，并预测第二天的请求数的不确定性（方差）。这个练习旨在展示全方差公式，即 $\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y|X)] + \\mathrm{Var}(\\mathbb{E}[Y|X])$ 的威力，让你了解如何运用它来量化预测的总体方差。[@problem_id:1351900]", "problem": "一个数据中心的服务器负载是通过计算每天收到的用户请求数来监控的。该过程建模如下：潜在的日均请求率，由随机变量 $\\Lambda$ 表示，并非恒定不变。相反，它根据形状参数 $\\alpha = 10.0$、速率参数 $\\beta = 1.0$ (单位：每天) 的伽马分布逐日波动。\n\n对于某一天的特定速率值 $\\Lambda = \\lambda$，当天的实际请求数 $N$ 是一个服从均值为 $\\lambda$ 的泊松分布的随机变量。在给定每一天的速率 $\\Lambda$ 的条件下，任何一天的请求数与任何其他天的请求数是条件独立的。假设星期一和星期二的潜在速率 $\\Lambda$ 是相同的。\n\n假设在星期一观测到总共 $k = 12$ 个请求。根据星期一的观测结果，计算星期二预期请求数的方差。将最终答案四舍五入到三位有效数字。", "solution": "设共同日均速率的先验分布为 $\\Lambda \\sim \\mathrm{Gamma}(\\alpha,\\beta)$，其中形状参数为 $\\alpha$，速率参数为 $\\beta$。其密度函数为\n$$\nf(\\lambda)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda), \\quad \\lambda>0.\n$$\n给定 $\\Lambda=\\lambda$，一天的计数 $N$ 服从 $\\mathrm{Poisson}(\\lambda)$ 分布，因此观测到星期一的计数 $k$ 的似然函数为\n$$\n\\Pr(N=k \\mid \\lambda)=\\frac{\\exp(-\\lambda)\\lambda^{k}}{k!}.\n$$\n根据共轭性，给定星期一的观测值后，$\\Lambda$ 的后验分布为\n$$\nf(\\lambda \\mid k)\\propto \\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)\\cdot \\exp(-\\lambda)\\lambda^{k}\n=\\lambda^{\\alpha+k-1}\\exp\\bigl(-(\\beta+1)\\lambda\\bigr),\n$$\n即 $\\mathrm{Gamma}(\\alpha+k,\\beta+1)$ 分布。\n\n对于星期二的计数 $N_{T}$，后验预测方差使用全方差公式：\n$$\n\\mathrm{Var}(N_{T}\\mid k)=\\mathbb{E}\\!\\left[\\mathrm{Var}(N_{T}\\mid \\Lambda,k)\\mid k\\right]+\\mathrm{Var}\\!\\left(\\mathbb{E}[N_{T}\\mid \\Lambda,k]\\mid k\\right).\n$$\n给定 $\\Lambda$，则 $N_{T}\\mid \\Lambda \\sim \\mathrm{Poisson}(\\Lambda)$，所以 $\\mathrm{Var}(N_{T}\\mid \\Lambda)=\\Lambda$ 且 $\\mathbb{E}[N_{T}\\mid \\Lambda]=\\Lambda$。因此，\n$$\n\\mathrm{Var}(N_{T}\\mid k)=\\mathbb{E}[\\Lambda \\mid k]+\\mathrm{Var}(\\Lambda \\mid k).\n$$\n由于 $\\Lambda \\mid k \\sim \\mathrm{Gamma}(\\alpha+k,\\beta+1)$，我们有\n$$\n\\mathbb{E}[\\Lambda \\mid k]=\\frac{\\alpha+k}{\\beta+1}, \n\\qquad\n\\mathrm{Var}(\\Lambda \\mid k)=\\frac{\\alpha+k}{(\\beta+1)^{2}}.\n$$\n因此，\n$$\n\\mathrm{Var}(N_{T}\\mid k)=\\frac{\\alpha+k}{\\beta+1}+\\frac{\\alpha+k}{(\\beta+1)^{2}}.\n$$\n代入 $\\alpha=10$, $\\beta=1$, 和 $k=12$：\n$$\n\\mathrm{Var}(N_{T}\\mid k=12)=\\frac{22}{2}+\\frac{22}{4}=11+5.5=16.5.\n$$\n四舍五入到三位有效数字，方差为 $16.5$。", "answer": "$$\\boxed{16.5}$$", "id": "1351900"}]}