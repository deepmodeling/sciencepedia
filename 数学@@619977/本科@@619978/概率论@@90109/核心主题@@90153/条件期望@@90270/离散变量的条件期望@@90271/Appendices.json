{"hands_on_practices": [{"introduction": "这个练习将帮助我们巩固一个核心概念：对一个事件进行条件化如何改变样本空间，并由此影响随机变量的期望值。通过计算在一组随机变量的最小值已知大于某个阈值的条件下其最大值的期望，我们能直接练习条件期望的基本计算方法。这是一个很好的起点，可以让我们熟练掌握如何处理受限的概率空间。[@problem_id:1350718]", "problem": "考虑两个独立同分布 (i.i.d.) 的随机变量 $X_1$ 和 $X_2$。每个变量都服从整数集合 $\\{1, 2, \\dots, M\\}$ 上的离散均匀分布, 其中 $M$ 是一个大于2的整数。令 $Y = \\max(X_1, X_2)$ 为这两个变量的最大值, $Z = \\min(X_1, X_2)$ 为这两个变量的最小值。\n\n给定最小值 $Z$ 严格大于一个整数 $k$, 其中 $1 \\le k < M-1$, 求最大值的条件期望 $E[Y | Z > k]$ 的一个闭式表达式。您的最终表达式应以 $M$ 和 $k$ 表示。", "solution": "本题要求计算条件期望 $E[Y | Z > k]$，其中 $Y = \\max(X_1, X_2)$，$Z = \\min(X_1, X_2)$，且 $X_1, X_2$ 为独立同分布的随机变量，服从集合 $\\{1, 2, \\dots, M\\}$ 上的离散均匀分布。\n\n条件 $Z > k$ 意味着 $\\min(X_1, X_2) > k$。这等价于事件 $X_1 > k$ 和 $X_2 > k$ 同时发生。在此条件下，每个随机变量的样本空间被限制在整数集合 $\\{k+1, k+2, \\dots, M\\}$ 中。该集合中可能结果的数量为 $M-k$。\n\n我们定义新的随机变量 $X_1^*$ 和 $X_2^*$，表示在条件 $Z > k$ 下 $X_1$ 和 $X_2$ 的值。这些条件变量是独立的，并且在集合 $\\{k+1, k+2, \\dots, M\\}$ 上均匀分布。因此，问题等价于求这两个新变量最大值的期望，即 $E[\\max(X_1^*, X_2^*)]$。\n\n为了简化计算，我们可以进行一个线性变换。我们定义另一组变量 $X'_i = X_i^* - k$，其中 $i=1,2$。这些变量 $X'_1$ 和 $X'_2$ 将是独立同分布的，并服从集合 $\\{1, 2, \\dots, M-k\\}$ 上的离散均匀分布。我们用 $M' = M-k$ 表示这个新样本空间的大小。因此，$X'_i \\sim U\\{1, 2, \\dots, M'\\}$。\n\n条件变量的最大值与变换后变量的最大值相关：\n$\\max(X_1^*, X_2^*) = \\max(X'_1+k, X'_2+k) = \\max(X'_1, X'_2) + k$。\n令 $Y' = \\max(X'_1, X'_2)$。根据期望的线性性，我们有：\n$E[Y | Z > k] = E[\\max(X_1^*, X_2^*)] = E[Y' + k] = E[Y'] + k$。\n\n我们现在的任务是计算 $E[Y']$，即从 $U\\{1, 2, \\dots, M'\\}$ 中抽取的两个独立同分布变量的最大值的期望。\n对于一个非负整数值随机变量，其期望可以用以下公式计算：\n$E[Y'] = \\sum_{j=0}^{\\infty} P(Y' > j)$。\n由于 $Y'$ 的最大可能值为 $M'$，这个和变为：\n$E[Y'] = \\sum_{j=0}^{M'-1} P(Y' > j)$。\n\n我们可以将 $P(Y' > j)$ 表示为 $1 - P(Y' \\le j)$。$P(Y' \\le j)$ 是 $Y'$ 的累积分布函数（CDF），我们称之为 $F_{Y'}(j)$。\n$F_{Y'}(j) = P(Y' \\le j) = P(\\max(X'_1, X'_2) \\le j)$。\n这等价于 $P(X'_1 \\le j \\text{ 且 } X'_2 \\le j)$。由于 $X'_1$ 和 $X'_2$ 是独立的：\n$F_{Y'}(j) = P(X'_1 \\le j) \\cdot P(X'_2 \\le j)$。\n\n对于在 $\\{1, \\dots, M'\\}$ 上的离散均匀变量 $X'_i$，当整数 $j$ 在范围 $1 \\le j \\le M'$ 内时，概率 $P(X'_i \\le j)$ 为 $\\frac{j}{M'}$。\n因此，$Y'$ 的累积分布函数为 $F_{Y'}(j) = \\left(\\frac{j}{M'}\\right)^2$，其中 $j \\in \\{1, \\dots, M'\\}$。请注意 $F_{Y'}(0) = 0$。\n\n现在我们可以计算期望：\n$E[Y'] = \\sum_{j=0}^{M'-1} (1 - F_{Y'}(j)) = \\sum_{j=0}^{M'-1} \\left(1 - \\left(\\frac{j}{M'}\\right)^2\\right)$。\n我们可以拆分这个和：\n$E[Y'] = \\sum_{j=0}^{M'-1} 1 - \\sum_{j=0}^{M'-1} \\left(\\frac{j}{M'}\\right)^2 = M' - \\frac{1}{(M')^2} \\sum_{j=0}^{M'-1} j^2$。\n\n前 $N$ 个平方数的和由公式 $\\sum_{j=1}^{N} j^2 = \\frac{N(N+1)(2N+1)}{6}$ 给出。我们需要求和到 $M'-1$，所以我们设 $N=M'-1$：\n$\\sum_{j=1}^{M'-1} j^2 = \\frac{(M'-1)((M'-1)+1)(2(M'-1)+1)}{6} = \\frac{(M'-1)M'(2M'-1)}{6}$。\n因为 $j=0$ 项为零，所以 $\\sum_{j=0}^{M'-1} j^2 = \\sum_{j=1}^{M'-1} j^2$。\n\n将此代入 $E[Y']$ 的表达式中：\n$E[Y'] = M' - \\frac{1}{(M')^2} \\left( \\frac{(M'-1)M'(2M'-1)}{6} \\right)$。\n$E[Y'] = M' - \\frac{(M'-1)(2M'-1)}{6M'}$。\n\n为了简化，我们通分：\n$E[Y'] = \\frac{6(M')^2 - (M'-1)(2M'-1)}{6M'} = \\frac{6(M')^2 - (2(M')^2 - 3M' + 1)}{6M'} = \\frac{4(M')^2 + 3M' - 1}{6M'}$。\n分子可以因式分解为 $(4M'-1)(M'+1)$。\n所以，$E[Y'] = \\frac{(4M'-1)(M'+1)}{6M'}$。\n\n最后，我们将此结果代回到我们最初的条件期望方程中，并记住 $M' = M-k$：\n$E[Y | Z > k] = E[Y'] + k = \\frac{(4M'-1)(M'+1)}{6M'} + k$。\n$E[Y | Z > k] = \\frac{(4(M-k)-1)((M-k)+1)}{6(M-k)} + k$。\n\n这就是条件期望的最终闭式表达式。", "answer": "$$\\boxed{\\frac{(4(M-k)-1)(M-k+1)}{6(M-k)} + k}$$", "id": "1350718"}, {"introduction": "这个练习展示了概率思维如何巧妙地简化看似复杂的计数问题。我们不再直接计算繁琐的排列组合，而是引入指示变量和对称性论证，这是一种更优雅且强大的解题策略。通过解决这个问题，你将学会如何通过重新构建问题来找到简洁的解决方案，这在解决实际问题时尤其有用。[@problem_id:1350736]", "problem": "一副完美洗牌的标准52张扑克牌按顺序面朝下放置。这副牌包含4张A，4张K和44张其他牌。一个玩家从序列的第一张牌开始，逐一翻开这些牌。在出现第一张K之前，翻开的A的期望数量是多少？\n\n你的最终答案应该是一个单一的数值，表示为最简分数形式。", "solution": "设 $X$ 为在出现第一张K之前翻开的A的数量。对于每张A $j \\in \\{1,2,3,4\\}$，定义指示变量 $I_{j}$，若A $j$ 在牌堆中所有四张K之前出现，则 $I_{j}=1$，否则 $I_{j}=0$。当且仅当一张A的位置在第一张K之前时，它才会被计入 $X$ 中，这等价于它比每一张K都早出现；因此\n$$\nX=\\sum_{j=1}^{4} I_{j}.\n$$\n根据期望的线性性质，\n$$\n\\mathbb{E}[X]=\\sum_{j=1}^{4} \\mathbb{E}[I_{j}]=\\sum_{j=1}^{4} \\mathbb{P}(I_{j}=1).\n$$\n对于一张固定的A $j$，考虑由这张A和四张K组成的子集。在整副牌的均匀随机排列中，这五张牌的相对顺序是均匀随机的，因此根据对称性，A $j$ 在它们之中最早出现的概率为\n$$\n\\mathbb{P}(I_{j}=1)=\\frac{1}{5}.\n$$\n因此，\n$$\n\\mathbb{E}[X]=4 \\cdot \\frac{1}{5}=\\frac{4}{5}.\n$$\n其他44张牌的存在不影响此计算，因为只有四张A和四张K的相对顺序决定了哪些A在第一张K之前。", "answer": "$$\\boxed{\\frac{4}{5}}$$", "id": "1350736"}, {"introduction": "这个练习引入了一个更高级的应用场景，模拟了一个多阶段的随机过程。它要求我们将条件化与全期望定律（或称重期望定律）相结合，来求解一个随机变量个数的随机和的期望值，这在物理学、工程学和金融学等领域中非常常见。这个问题不仅综合了多个重要概念，还巧妙地利用了我们熟悉的几何分布的“无记忆性”，是检验你综合应用能力的好机会。[@problem_id:1350716]", "problem": "在一个简化的量子隧穿模型中，一个粒子进行一系列尝试以穿过一个势垒。在粒子成功隧穿之前所作的总尝试次数 $N$ 是一个随机变量，服从几何分布，其概率质量函数为 $P(N=n) = (1-p)^{n-1}p$，其中 $n = 1, 2, 3, \\dots$，$p$ 是单次尝试成功隧穿的概率。\n\n在每次尝试 $i$（其中 $i=1, 2, \\dots, N$）中，粒子会发射若干“探测”光子 $X_i$。在不同尝试中发射的光子数是独立同分布 (i.i.d.) 的随机变量，其中每个 $X_i$ 服从均值为 $\\lambda$ 的泊松分布。整个过程中发射的光子总数为 $S_N = \\sum_{i=1}^{N} X_i$。\n\n进行了一项实验，但由于早期探测系统的限制，我们只知道该粒子在前 $k$ 次尝试中均未成功隧穿。具体来说，我们得到的条件是 $N > k$。\n\n基于此信息，求粒子最终隧穿时已经发射的探测光子总数的期望值 $E[S_N | N > k]$。请用 $p$、$\\lambda$ 和 $k$ 将你的答案表示为单个闭式解析表达式。", "solution": "我们需要计算条件期望 $E[S_{N} \\mid N>k]$，其中 $S_{N}=\\sum_{i=1}^{N}X_{i}$，$X_{i}$ 是独立同分布、均值为 $\\lambda$ 的泊松随机变量，而 $N$ 是几何分布，其概率为 $P(N=n)=(1-p)^{n-1}p$，其中 $n\\in\\{1,2,\\dots\\}$。$X_{i}$ 与 $N$ 相互独立。\n\n根据全期望定律以及 $\\{X_{i}\\}$ 和 $N$ 的独立性，\n$$\nE[S_{N} \\mid N>k]\n= E\\!\\left[\\,E\\!\\left[\\sum_{i=1}^{N}X_{i}\\,\\middle|\\,N,\\,N>k\\right] \\middle| N>k\\right]\n= E\\!\\left[\\,E\\!\\left[\\sum_{i=1}^{N}X_{i}\\,\\middle|\\,N\\right] \\middle| N>k\\right].\n$$\n给定 $N$，我们有\n$$\nE\\!\\left[\\sum_{i=1}^{N}X_{i}\\,\\middle|\\,N\\right] = \\sum_{i=1}^{N}E[X_{i}] = N\\,\\lambda,\n$$\n因此\n$$\nE[S_{N} \\mid N>k] = E[N\\lambda \\mid N>k] = \\lambda\\,E[N \\mid N>k].\n$$\n\n我们现在计算 $E[N \\mid N>k]$。对于 $n>k$，\n$$\nP(N=n \\mid N>k) = \\frac{P(N=n)}{P(N>k)} = \\frac{(1-p)^{n-1}p}{(1-p)^{k}} = (1-p)^{n-k-1}p.\n$$\n因此，在 $N>k$ 的条件下，$N-k$ 服从在 $\\{1,2,\\dots\\}$ 上参数为 $p$ 的几何分布。于是\n$$\nE[N \\mid N>k] = k + E[N-k \\mid N>k] = k + \\frac{1}{p}.\n$$\n为求完整，这可以通过求和来验证。令 $q=1-p$。那么\n$$\nE[N \\mid N>k] = \\sum_{n=k+1}^{\\infty} n\\, q^{\\,n-k-1} p\n= \\sum_{m=1}^{\\infty} (k+m)\\, q^{\\,m-1} p\n= k \\sum_{m=1}^{\\infty} q^{\\,m-1} p + \\sum_{m=1}^{\\infty} m\\, q^{\\,m-1} p.\n$$\n使用几何级数恒等式\n$$\n\\sum_{m=1}^{\\infty} q^{\\,m-1} p = p \\sum_{m=0}^{\\infty} q^{m} = \\frac{p}{1-q} = 1,\n$$\n和\n$$\n\\sum_{m=1}^{\\infty} m\\, q^{\\,m-1} p = p \\frac{\\mathrm{d}}{\\mathrm{d}q} \\left(\\sum_{m=1}^{\\infty} q^{m}\\right)\n= p \\frac{\\mathrm{d}}{\\mathrm{d}q} \\left(\\frac{q}{1-q}\\right)\n= \\frac{p}{(1-q)^{2}} = \\frac{1}{p},\n$$\n我们得到 $E[N \\mid N>k] = k + \\frac{1}{p}$。\n\n因此，\n$$\nE[S_{N} \\mid N>k] = \\lambda \\left(k + \\frac{1}{p}\\right).\n$$", "answer": "$$\\boxed{\\lambda\\left(k+\\frac{1}{p}\\right)}$$", "id": "1350716"}]}