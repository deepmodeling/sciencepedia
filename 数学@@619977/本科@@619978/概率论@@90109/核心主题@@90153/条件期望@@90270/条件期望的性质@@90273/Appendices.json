{"hands_on_practices": [{"introduction": "本练习将通过一个直观的几何情景，帮助你打下坚实的理论基础。我们将探索当一个随机变量（$Y$）的取值已知时，如何更新我们对另一个相关随机变量（$X$）的期望。这个过程的核心在于推导出条件概率密度函数，并据此计算期望值，这是条件期望最基本的计算方法之一。[@problem_id:1381962]", "problem": "一根圆柱形光纤的纤芯内，一个杂质位于随机位置 $(X, Y)$。该光纤纤芯的横截面被建模为一个以原点为中心、半径为 $R$ 的圆盘。由于一种特定的制造工艺，杂质仅存在于纤芯的右半部分。因此，杂质的位置 $(X, Y)$ 是从由 $x^2 + y^2 \\le R^2$ 和 $x \\ge 0$ 定义的半圆盘区域上的均匀分布中选取的一个随机点。\n\n一次质量控制测量显示，该杂质的垂直位置为 $Y=y$，其中 $-R < y < R$。确定该杂质的水平位置期望值 $E[X|Y=y]$。将答案表示为 $R$ 和 $y$ 的函数。", "solution": "令 $S=\\{(x,y):x^{2}+y^{2}\\le R^{2},\\,x\\ge 0\\}$ 表示右半圆盘。联合密度在 $S$ 上是均匀的，因此\n$$\nf_{X,Y}(x,y)=\\frac{1}{|S|}\\quad\\text{对于 }(x,y)\\in S,\\qquad |S|=\\frac{1}{2}\\pi R^{2}.\n$$\n对于一个固定的 $y$ 且 $|y|<R$，$x$ 的取值范围满足 $0\\le x\\le \\sqrt{R^{2}-y^{2}}$。$Y$ 在 $y$ 处的边缘密度为\n$$\nf_{Y}(y)=\\int_{0}^{\\sqrt{R^{2}-y^{2}}} f_{X,Y}(x,y)\\,dx=\\frac{1}{|S|}\\int_{0}^{\\sqrt{R^{2}-y^{2}}} dx=\\frac{\\sqrt{R^{2}-y^{2}}}{|S|}.\n$$\n因此，在给定 $Y=y$ 的条件下，$X$ 的条件密度为\n$$\nf_{X\\mid Y}(x\\mid y)=\\frac{f_{X,Y}(x,y)}{f_{Y}(y)}=\\frac{1/|S|}{\\sqrt{R^{2}-y^{2}}/|S|}=\\frac{1}{\\sqrt{R^{2}-y^{2}}},\\quad 0\\le x\\le \\sqrt{R^{2}-y^{2}},\n$$\n这是在 $[0,\\sqrt{R^{2}-y^{2}}]$ 上的均匀分布。因此，\n$$\nE[X\\mid Y=y]=\\int_{0}^{\\sqrt{R^{2}-y^{2}}} x\\,\\frac{1}{\\sqrt{R^{2}-y^{2}}}\\,dx=\\frac{1}{\\sqrt{R^{2}-y^{2}}}\\cdot \\frac{1}{2}\\left.x^{2}\\right|_{0}^{\\sqrt{R^{2}-y^{2}}}=\\frac{1}{2}\\sqrt{R^{2}-y^{2}}.\n$$\n此结果对 $-R<y<R$ 成立。", "answer": "$$\\boxed{\\frac{1}{2}\\sqrt{R^{2}-y^{2}}}$$", "id": "1381962"}, {"introduction": "这个练习旨在阐明条件期望的一个核心性质：“已知信息可提取”（taking out what is known）。当我们要估计的随机变量（$X_1 X_2$）完全由条件变量（$S=X_1+X_2$）确定时，其条件期望就是它自身。通过这个简单的离散伯努利变量模型，我们将具体地看到这个抽象概念是如何应用的，从而加深对条件期望作为一种信息投影的理解。[@problem_id:1438518]", "problem": "部署了两个独立的传感器，传感器1和传感器2，用于检测特定的环境特征。在任何给定的观测周期内，每个传感器报告一个二元结果：如果检测到特征，则为'1'，否则为'0'。设 $X_1$ 和 $X_2$ 分别是代表传感器1和传感器2报告的随机变量。两个传感器独立运行且统计特性相同，报告'1'的概率均为 $p$。因此，$X_1$ 和 $X_2$ 可以被建模为独立同分布的伯努利随机变量。一位分析师需要估计联合检测事件，该事件由乘积 $X_1 X_2$ 捕捉。然而，分析师唯一可用的数据是检测总数，即和 $S = X_1 + X_2$。请在仅有关于和 $S$ 的信息的情况下，确定分析师对联合检测事件的最佳估计。用概率论的语言来说，就是求条件期望 $E[X_1 X_2 | S]$。请将您的答案表示为 $S$ 的函数。", "solution": "设 $X_{1}, X_{2} \\sim \\text{Bernoulli}(p)$ 是独立的，并且设 $S = X_{1} + X_{2}$。我们感兴趣的量是 $X_{1}X_{2}$，它当且仅当两个传感器都报告1时等于1。\n\n列出 $S$ 的可能取值，并确定每种情况下 $X_{1}X_{2}$ 的值：\n- 如果 $S=0$，那么 $(X_{1},X_{2})=(0,0)$，所以 $X_{1}X_{2}=0$。\n- 如果 $S=1$，那么 $X_{1},X_{2}$ 中一个为 $1$ 另一个为 $0$，所以 $X_{1}X_{2}=0$。\n- 如果 $S=2$，那么 $(X_{1},X_{2})=(1,1)$，所以 $X_{1}X_{2}=1$。\n\n因此，$X_{1}X_{2}$ 完全由 $S$ 决定，并且等于事件 $\\{S=2\\}$ 的指示函数。等价地，作为 $S \\in \\{0,1,2\\}$ 的函数，\n$$\nX_{1}X_{2} = \\frac{S(S-1)}{2},\n$$\n因为当 $S=0$ 或 $S=1$ 时，此表达式的值为 $0$，当 $S=2$ 时，其值为 $1$。\n\n因为 $X_{1}X_{2}$ 是 $S$ 的一个可测函数，根据条件期望的定义属性，\n$$\nE[X_{1}X_{2} \\mid S] = X_{1}X_{2} = \\frac{S(S-1)}{2}.\n$$\n这个结果不依赖于 $p$。", "answer": "$$\\boxed{\\frac{S(S-1)}{2}}$$", "id": "1438518"}, {"introduction": "现在，让我们来挑战一个更复杂的非线性变换问题。当条件变量（$P=V^2$）与原始信号（$V$）之间不是简单的线性关系时，我们该如何估计原始信号？这个问题将向你展示，即使条件信息不能完全确定原始值（因为 $V$ 可能是 $\\sqrt{P}$ 或 $-\\sqrt{P}$），我们仍然可以通过对所有可能性进行加权平均来找到最佳估计，这在信号处理等领域具有重要意义。[@problem_id:1327108]", "problem": "在一个数字通信系统中，接收到的信号脉冲的振幅（由随机变量 $V$ 表示）服从高斯分布。该信号具有一个非零的直流 (DC) 分量 $\\mu$，并受到均值为零的加性高斯噪声的干扰，导致总信号标准差为 $\\sigma$。因此，$V$ 的概率密度函数由 $f_V(v) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(v-\\mu)^2}{2\\sigma^2}\\right)$ 给出，其中 $\\mu$ 和 $\\sigma$ 是正常数。\n\n接收机电路中的一个非线性检测器测量一个量 $P$，它等于信号振幅的平方，即 $P = V^2$。为了实现最佳信号重建，有必要在给定该测量值 $P$ 的情况下，计算原始振幅 $V$ 的最佳估计。在最小化均方误差的意义下，这个最佳估计是给定 $P$ 时 $V$ 的条件期望。\n\n求条件期望 $E[V | P]$。你的答案应表示为测量量 $P$、直流分量 $\\mu$ 和标准差 $\\sigma$ 的函数。", "solution": "设 $V \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，其密度为 $f_{V}(v)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(v-\\mu)^{2}}{2\\sigma^{2}}\\right)$，且 $P=V^{2}$。我们要求解 $E[V \\mid P]$，它必须是 $P$ 的一个可测函数。对于 $p>0$，映射 $h(v)=v^{2}$ 有两个原像 $v_{1}=\\sqrt{p}$ 和 $v_{2}=-\\sqrt{p}$，其导数为 $h'(v)=2v$，因此 $|h'(v_{1})|=|h'(v_{2})|=2\\sqrt{p}$。给定 $P=p$ 时 $V$ 的条件分布是在 $\\{\\sqrt{p},-\\sqrt{p}\\}$ 上的离散分布，其权重与 $f_{V}(v_{i})/|h'(v_{i})|$ 成正比。因此，\n$$\nE[V \\mid P=p]\n=\\frac{\\sqrt{p}\\,\\frac{f_{V}(\\sqrt{p})}{2\\sqrt{p}}+(-\\sqrt{p})\\,\\frac{f_{V}(-\\sqrt{p})}{2\\sqrt{p}}}{\\frac{f_{V}(\\sqrt{p})}{2\\sqrt{p}}+\\frac{f_{V}(-\\sqrt{p})}{2\\sqrt{p}}}\n=\\sqrt{p}\\,\\frac{f_{V}(\\sqrt{p})-f_{V}(-\\sqrt{p})}{f_{V}(\\sqrt{p})+f_{V}(-\\sqrt{p})}.\n$$\n使用高斯密度函数，\n$$\nf_{V}(\\sqrt{p})=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(\\sqrt{p}-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad\nf_{V}(-\\sqrt{p})=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(\\sqrt{p}+\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n设\n$$\nA=\\exp\\!\\left(-\\frac{(\\sqrt{p}-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad\nB=\\exp\\!\\left(-\\frac{(\\sqrt{p}+\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n那么\n$$\nA=\\exp\\!\\left(-\\frac{p+\\mu^{2}}{2\\sigma^{2}}\\right)\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right),\\quad\nB=\\exp\\!\\left(-\\frac{p+\\mu^{2}}{2\\sigma^{2}}\\right)\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right),\n$$\n所以\n$$\n\\frac{A-B}{A+B}\n=\\frac{\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)-\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)}{\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)+\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)}\n=\\tanh\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right).\n$$\n因此，对于 $p>0$，\n$$\nE[V \\mid P=p]=\\sqrt{p}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right).\n$$\n当 $p=0$ 时，唯一的原像是 $v=0$，因此 $E[V \\mid P=0]=0$，这与上述表达式在 $p \\to 0^{+}$ 时的极限一致。因此，作为测量量 $P$ 的函数，\n$$\nE[V \\mid P]=\\sqrt{P}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{P}}{\\sigma^{2}}\\right).\n$$", "answer": "$$\\boxed{\\sqrt{P}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{P}}{\\sigma^{2}}\\right)}$$", "id": "1327108"}]}