{"hands_on_practices": [{"introduction": "在许多科学和工程应用中，我们常常测量一些基本量，但最终关心的是由这些量导出的一个新量。本练习探讨了土地测量中的一个此类情景：我们希望根据两直角边的样本均值，来确定计算出的斜边长度估计值的不确定性。这是一个应用二维德尔塔方法的绝佳起点，它展示了如何处理非线性函数以及变量间存在相关性的情况 [@problem_id:1403192]。", "problem": "一家土地勘测公司正在分析一大批矩形地块。对于每个地块，都测量了其两个垂直边 $X$ 和 $Y$ 的长度。这些测量值可以被视为随机变量的结果，其总体参数如下：\n- 边 $X$ 的平均长度：$\\mu_X = 120$ 米\n- 边 $Y$ 的平均长度：$\\mu_Y = 50$ 米\n- $X$ 的方差：$\\sigma_X^2 = 25 \\text{ m}^2$\n- $Y$ 的方差：$\\sigma_Y^2 = 16 \\text{ m}^2$\n- $X$ 和 $Y$ 之间的协方差：$\\sigma_{XY} = 10 \\text{ m}^2$\n\n对于一个包含 $n$ 个地块的大型随机样本，该公司使用样本均值 $\\bar{X}_n$ 和 $\\bar{Y}_n$ 代入公式 $H_n = \\sqrt{\\bar{X}_n^2 + \\bar{Y}_n^2}$ 来估计斜边的平均长度。对于足够大的样本量 $n$，该估计量 $H_n$ 的抽样分布可以近似为一个正态分布，其方差形式为 $V/n$。\n\n计算 $V$ 的值。以平方米（$\\text{m}^2$）为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "设 $(\\bar{X}_{n},\\bar{Y}_{n})$ 是来自 $(X,Y)$ 的 $n$ 个独立同分布观测值的样本均值，其均值为 $\\mu_{X},\\mu_{Y}$，方差为 $\\sigma_{X}^{2},\\sigma_{Y}^{2}$，协方差为 $\\sigma_{XY}$。根据多元中心极限定理，\n$$(\\bar{X}_{n},\\bar{Y}_{n}) \\overset{\\text{approx}}{\\sim} \\mathcal{N}\\!\\left(\\begin{pmatrix}\\mu_{X} \\\\ \\mu_{Y}\\end{pmatrix}, \\frac{1}{n}\\,\\boldsymbol{\\Sigma}\\right), \\quad \\boldsymbol{\\Sigma}=\\begin{pmatrix}\\sigma_{X}^{2}  \\sigma_{XY} \\\\ \\sigma_{XY}  \\sigma_{Y}^{2}\\end{pmatrix}.$$\n定义 $g(x,y)=\\sqrt{x^{2}+y^{2}}$。那么 $H_{n}=g(\\bar{X}_{n},\\bar{Y}_{n})$。对于大的 $n$，根据 delta 方法，$H_{n}$ 的渐近方差为\n$$\\operatorname{Var}(H_{n}) \\approx \\frac{1}{n}\\,\\nabla g(\\mu)^{\\top}\\boldsymbol{\\Sigma}\\,\\nabla g(\\mu), \\quad \\mu=\\begin{pmatrix}\\mu_{X}\\\\ \\mu_{Y}\\end{pmatrix}.$$\n计算梯度：\n$$\\nabla g(x,y)=\\begin{pmatrix}\\frac{\\partial g}{\\partial x}\\\\[4pt]\\frac{\\partial g}{\\partial y}\\end{pmatrix}=\\begin{pmatrix}\\frac{x}{\\sqrt{x^{2}+y^{2}}}\\\\[4pt]\\frac{y}{\\sqrt{x^{2}+y^{2}}}\\end{pmatrix}, \\quad \\Rightarrow \\quad \\nabla g(\\mu)=\\frac{1}{\\sqrt{\\mu_{X}^{2}+\\mu_{Y}^{2}}}\\begin{pmatrix}\\mu_{X}\\\\ \\mu_{Y}\\end{pmatrix}.$$\n因此，\n$$V=\\nabla g(\\mu)^{\\top}\\boldsymbol{\\Sigma}\\,\\nabla g(\\mu)=\\frac{1}{\\mu_{X}^{2}+\\mu_{Y}^{2}}\\left(\\mu_{X}^{2}\\sigma_{X}^{2}+2\\mu_{X}\\mu_{Y}\\sigma_{XY}+\\mu_{Y}^{2}\\sigma_{Y}^{2}\\right).$$\n代入给定值 $\\mu_{X}=120$, $\\mu_{Y}=50$, $\\sigma_{X}^{2}=25$, $\\sigma_{Y}^{2}=16$, $\\sigma_{XY}=10$：\n$$\\mu_{X}^{2}+\\mu_{Y}^{2}=120^{2}+50^{2}=14400+2500=16900,$$\n$$\\mu_{X}^{2}\\sigma_{X}^{2}=120^{2}\\cdot 25=360000,\\quad 2\\mu_{X}\\mu_{Y}\\sigma_{XY}=2\\cdot 120\\cdot 50\\cdot 10=120000,\\quad \\mu_{Y}^{2}\\sigma_{Y}^{2}=50^{2}\\cdot 16=40000,$$\n$$\\Rightarrow \\quad \\mu_{X}^{2}\\sigma_{X}^{2}+2\\mu_{X}\\mu_{Y}\\sigma_{XY}+\\mu_{Y}^{2}\\sigma_{Y}^{2}=360000+120000+40000=520000.$$\n因此，\n$$V=\\frac{520000}{16900}=\\frac{5200}{169}=\\frac{400}{13}\\approx 30.7692308.$$\n四舍五入到三位有效数字，得到 $V=30.8$。", "answer": "$$\\boxed{30.8}$$", "id": "1403192"}, {"introduction": "掌握了双变量的情形后，让我们将技能推广到更高维度。这个问题要求你分析梯形面积估计的不确定性，其面积是三个测量变量（两个平行边和高）的函数。通过推导其渐近方差的符号表达式，你将更深刻地理解原始测量的方差和协方差如何通过公式传播，最终影响估计量的精度 [@problem_id:1403188]。", "problem": "一家大地测量公司正在评估一大片被分割成许多梯形地块的土地。对于每个地块，都会进行三项测量：两条平行边的长度 $a$ 和 $b$，以及高 $h$。随机抽取 $n$ 个地块的样本，得到观测值 $(a_i, b_i, h_i)$，其中 $i=1, \\dots, n$。假设这些观测值是从一个总体中抽取的独立同分布样本，该总体的均值向量为\n$$\n\\mu = \\begin{pmatrix} \\mu_a \\\\ \\mu_b \\\\ \\mu_h \\end{pmatrix}\n$$\n且协方差矩阵为\n$$\n\\boldsymbol{\\Sigma} = \\begin{pmatrix}\n\\sigma_a^2  \\sigma_{ab}  \\sigma_{ah} \\\\\n\\sigma_{ab}  \\sigma_b^2  \\sigma_{bh} \\\\\n\\sigma_{ah}  \\sigma_{bh}  \\sigma_h^2\n\\end{pmatrix}\n$$\n总体中地块的平均面积为 $A = \\frac{1}{2}(\\mu_a + \\mu_b)\\mu_h$。使用样本均值 $\\bar{a}_n = \\frac{1}{n}\\sum a_i$、$\\bar{b}_n = \\frac{1}{n}\\sum b_i$ 和 $\\bar{h}_n = \\frac{1}{n}\\sum h_i$ 构建该平均面积的估计量，如下所示：\n$$\n\\hat{A}_n = \\frac{1}{2}(\\bar{a}_n + \\bar{b}_n)\\bar{h}_n\n$$\n根据统计理论，已知该估计量的分布是渐近正态的。具体来说，$\\sqrt{n}(\\hat{A}_n - A)$ 依分布收敛于一个均值为 0、渐近方差为 $V$ 的正态分布。\n\n请用参数 $\\mu_a, \\mu_b, \\mu_h, \\sigma_a^2, \\sigma_b^2, \\sigma_h^2, \\sigma_{ab}, \\sigma_{ah}$ 和 $\\sigma_{bh}$ 来表示渐近方差 $V$ 的表达式。", "solution": "令 $X_{i} = \\begin{pmatrix} a_{i} \\\\ b_{i} \\\\ h_{i} \\end{pmatrix}$，其均值为 $\\mu = \\begin{pmatrix} \\mu_{a} \\\\ \\mu_{b} \\\\ \\mu_{h} \\end{pmatrix}$，协方差为 $\\boldsymbol{\\Sigma}$。样本均值为 $\\bar{X}_{n} = \\begin{pmatrix} \\bar{a}_{n} \\\\ \\bar{b}_{n} \\\\ \\bar{h}_{n} \\end{pmatrix}$。根据多元中心极限定理，\n$$\n\\sqrt{n}\\left(\\bar{X}_{n} - \\mu\\right) \\xrightarrow{d} \\mathcal{N}(0,\\boldsymbol{\\Sigma}).\n$$\n定义光滑函数 $g:\\mathbb{R}^{3}\\to\\mathbb{R}$ 为 $g(a,b,h) = \\frac{1}{2}(a+b)h$。估计量为 $\\hat{A}_{n} = g(\\bar{X}_{n})$，目标参数为 $A = g(\\mu)$。根据 Delta 方法，\n$$\n\\sqrt{n}\\left(g(\\bar{X}_{n}) - g(\\mu)\\right) \\xrightarrow{d} \\mathcal{N}\\left(0,\\, \\nabla g(\\mu)^{\\top}\\boldsymbol{\\Sigma}\\,\\nabla g(\\mu)\\right).\n$$\n计算 $g$ 的梯度：\n$$\n\\frac{\\partial g}{\\partial a} = \\frac{1}{2}h,\\quad \\frac{\\partial g}{\\partial b} = \\frac{1}{2}h,\\quad \\frac{\\partial g}{\\partial h} = \\frac{1}{2}(a+b).\n$$\n在 $\\mu$ 处求值，可得\n$$\n\\nabla g(\\mu) = \\begin{pmatrix} \\frac{1}{2}\\mu_{h} \\\\ \\frac{1}{2}\\mu_{h} \\\\ \\frac{1}{2}(\\mu_{a}+\\mu_{b}) \\end{pmatrix}.\n$$\n令 $v_{a} = \\frac{1}{2}\\mu_{h}$，$v_{b} = \\frac{1}{2}\\mu_{h}$，以及 $v_{h} = \\frac{1}{2}(\\mu_{a}+\\mu_{b})$。设 $\\boldsymbol{\\Sigma}$ 的对角线元素为 $\\sigma_{a}^{2}, \\sigma_{b}^{2}, \\sigma_{h}^{2}$，非对角线元素为 $\\sigma_{ab}, \\sigma_{ah}, \\sigma_{bh}$，则渐近方差为\n$$\nV = \\nabla g(\\mu)^{\\top}\\boldsymbol{\\Sigma}\\,\\nabla g(\\mu) = v_{a}^{2}\\sigma_{a}^{2} + v_{b}^{2}\\sigma_{b}^{2} + v_{h}^{2}\\sigma_{h}^{2} + 2v_{a}v_{b}\\sigma_{ab} + 2v_{a}v_{h}\\sigma_{ah} + 2v_{b}v_{h}\\sigma_{bh}.\n$$\n代入 $v_{a}, v_{b}, v_{h}$，可得\n$$\nV = \\frac{1}{4}\\mu_{h}^{2}(\\sigma_{a}^{2} + \\sigma_{b}^{2}) + \\frac{1}{4}(\\mu_{a}+\\mu_{b})^{2}\\sigma_{h}^{2} + \\frac{1}{2}\\mu_{h}^{2}\\sigma_{ab} + \\frac{1}{2}\\mu_{h}(\\mu_{a}+\\mu_{b})\\sigma_{ah} + \\frac{1}{2}\\mu_{h}(\\mu_{a}+\\mu_{b})\\sigma_{bh}.\n$$\n等价地，对各项进行分组，\n$$\nV = \\frac{1}{4}\\left[\\mu_{h}^{2}(\\sigma_{a}^{2} + 2\\sigma_{ab} + \\sigma_{b}^{2}) + (\\mu_{a}+\\mu_{b})^{2}\\sigma_{h}^{2} + 2\\mu_{h}(\\mu_{a}+\\mu_{b})(\\sigma_{ah} + \\sigma_{bh})\\right].\n$$\n这就是所求的渐近方差。", "answer": "$$\\boxed{\\frac{1}{4}\\left[\\mu_{h}^{2}\\left(\\sigma_{a}^{2}+2\\sigma_{ab}+\\sigma_{b}^{2}\\right)+(\\mu_{a}+\\mu_{b})^{2}\\sigma_{h}^{2}+2\\mu_{h}(\\mu_{a}+\\mu_{b})(\\sigma_{ah}+\\sigma_{bh})\\right]}$$", "id": "1403188"}, {"introduction": "现在，让我们通过一个化学领域的数值计算问题，将理论付诸实践。稀释溶液的浓度是初始浓度和所用体积的函数，而所有这些量都存在测量误差。本练习要求你将德尔塔方法应用于一个包含比率的函数，并计算出最终浓度估计值的具体数值方差，从而巩固你解决实际应用问题的能力 [@problem_id:1403163]。", "problem": "在化学实验室中，一名技术员通过将母液与溶剂混合来制备稀溶液。溶质的最终浓度 $C_f$ 由母液的初始浓度 $C_i$、所用母液的初始体积 $V_i$ 以及所添加溶剂的体积 $V_s$ 决定，其计算公式如下：\n$$\nC_f = \\frac{C_i V_i}{V_i + V_s}\n$$\n为了考虑测量变异性，该技术员进行了 $n=100$ 次独立试验。在每次试验中，都对初始浓度、初始体积和溶剂体积进行一次新的测量。设这些测量的样本均值分别表示为 $\\bar{C}_i$、$\\bar{V}_i$ 和 $\\bar{V}_s$。$C_i$、$V_i$ 和 $V_s$ 的测量值假定为相互统计独立的。\n\n已知这些参数的真实均值为 $\\mu_C = 2.0$ M (摩尔浓度)，$\\mu_V = 50.0$ mL，以及 $\\mu_S = 150.0$ mL。单次测量的标准差分别为 $\\sigma_C = 0.1$ M，$\\sigma_V = 1.0$ mL，以及 $\\sigma_S = 2.0$ mL。\n\n最终浓度的一个估计值 $\\hat{C}_f$ 使用样本均值计算得出：\n$$\n\\hat{C}_f = \\frac{\\bar{C}_i \\bar{V}_i}{\\bar{V}_i + \\bar{V}_s}\n$$\n根据这些信息，计算估计量 $\\hat{C}_f$ 的近似渐近方差。请用 M$^2$ 作为单位表示你的答案，并四舍五入到三位有效数字。", "solution": "我们要求解估计量 $\\hat{C}_{f} = g(\\bar{C}_{i},\\bar{V}_{i},\\bar{V}_{s})$ 的渐近方差，其中\n$$\ng(C,V,S) = \\frac{CV}{V+S}.\n$$\n根据多元delta方法，由于 $\\bar{C}_{i}$、$\\bar{V}_{i}$ 和 $\\bar{V}_{s}$ 是来自独立测量的样本均值，其方差分别为 $\\sigma_{C}^{2}/n$、$\\sigma_{V}^{2}/n$ 和 $\\sigma_{S}^{2}/n$，且协方差为零，我们得到\n$$\n\\operatorname{avar}(\\hat{C}_{f}) = \\frac{1}{n}\\,\\nabla g(\\mu)^{\\top}\\,\\boldsymbol{\\Sigma}\\,\\nabla g(\\mu),\n$$\n其中 $\\mu = (\\mu_{C},\\mu_{V},\\mu_{S})$ 且 $\\boldsymbol{\\Sigma} = \\operatorname{diag}(\\sigma_{C}^{2},\\sigma_{V}^{2},\\sigma_{S}^{2})$。\n\n首先计算梯度分量。令 $D = V+S$。那么\n$$\n\\frac{\\partial g}{\\partial C} = \\frac{V}{V+S},\\quad\n\\frac{\\partial g}{\\partial V} = \\frac{\\partial}{\\partial V}\\left(C\\frac{V}{V+S}\\right) = C\\,\\frac{S}{(V+S)^{2}},\\quad\n\\frac{\\partial g}{\\partial S} = \\frac{\\partial}{\\partial S}\\left(C\\frac{V}{V+S}\\right) = -\\,C\\,\\frac{V}{(V+S)^{2}}.\n$$\n在点 $(\\mu_{C},\\mu_{V},\\mu_{S})$ 处求值，\n$$\na \\equiv \\left.\\frac{\\partial g}{\\partial C}\\right|_{\\mu} = \\frac{\\mu_{V}}{\\mu_{V}+\\mu_{S}},\\quad\nb \\equiv \\left.\\frac{\\partial g}{\\partial V}\\right|_{\\mu} = \\frac{\\mu_{C}\\mu_{S}}{(\\mu_{V}+\\mu_{S})^{2}},\\quad\nc \\equiv \\left.\\frac{\\partial g}{\\partial S}\\right|_{\\mu} = -\\,\\frac{\\mu_{C}\\mu_{V}}{(\\mu_{V}+\\mu_{S})^{2}}.\n$$\n因此，\n$$\n\\operatorname{avar}(\\hat{C}_{f}) = \\frac{1}{n}\\left(a^{2}\\sigma_{C}^{2} + b^{2}\\sigma_{V}^{2} + c^{2}\\sigma_{S}^{2}\\right).\n$$\n代入给定的数值 $\\mu_{C} = 2.0$，$\\mu_{V} = 50.0$，$\\mu_{S} = 150.0$，$\\sigma_{C} = 0.1$，$\\sigma_{V} = 1.0$，$\\sigma_{S} = 2.0$ 和 $n=100$。计算 $D = \\mu_{V}+\\mu_{S} = 200.0$，则\n$$\na = \\frac{50.0}{200.0} = 0.25,\\quad\nb = \\frac{2.0 \\times 150.0}{200.0^{2}} = 0.0075,\\quad\nc = -\\,\\frac{2.0 \\times 50.0}{200.0^{2}} = -0.0025.\n$$\n因此，\n$$\na^{2}\\sigma_{C}^{2} = (0.25)^{2}\\times(0.1)^{2} = 0.0625\\times 0.01 = 6.25\\times 10^{-4},\n$$\n$$\nb^{2}\\sigma_{V}^{2} = (0.0075)^{2}\\times 1.0^{2} = 5.625\\times 10^{-5},\n$$\n$$\nc^{2}\\sigma_{S}^{2} = (-0.0025)^{2}\\times (2.0)^{2} = 6.25\\times 10^{-6}\\times 4 = 2.5\\times 10^{-5}.\n$$\n将各项相加并除以 $n=100$ 可得\n$$\n\\operatorname{avar}(\\hat{C}_{f}) \\approx \\frac{6.25\\times 10^{-4} + 5.625\\times 10^{-5} + 2.5\\times 10^{-5}}{100}\n= \\frac{7.0625\\times 10^{-4}}{100}\n= 7.0625\\times 10^{-6}.\n$$\n四舍五入到三位有效数字，得到 $7.06\\times 10^{-6}$，单位为 $\\text{M}^{2}$。", "answer": "$$\\boxed{7.06 \\times 10^{-6}}$$", "id": "1403163"}]}