{"hands_on_practices": [{"introduction": "在处理从有限但庞大的总体中抽样的问题时，我们经常会遇到超几何分布。然而，当总体和样本数量非常大时，直接计算超几何概率可能变得异常繁琐。本练习将通过一个现实场景，向你展示如何运用二项分布作为一种高效且精确的近似方法，来解决这类问题并计算特定结果的概率。[@problem_id:1346396]", "problem": "一个大型社交媒体平台共有 $N = 10,000,000$ 名活跃用户。在该用户群体中，有 $K = 1,000$ 个账户被指定为经过认证的“网红”。为进行一项市场研究，一家公司从所有活跃用户中随机抽取了一个大小为 $n = 500$ 的样本。假设此样本为无放回抽样，计算样本中恰好包含一个网红账户的概率。\n\n请将您的答案以一个实数形式给出，并四舍五入到三位有效数字。", "solution": "从一个包含 $N$ 个总用户和 $K$ 个网红的有限总体中，进行无放回简单随机抽样，样本中网红账户的数量服从超几何分布。大小为 $n$ 的样本中恰好包含一个网红的概率为\n$$\nP(X=1)=\\frac{\\binom{K}{1}\\binom{N-K}{n-1}}{\\binom{N}{n}}。\n$$\n代入 $N=10^{7}$，$K=10^{3}$ 和 $n=500$，我们得到\n$$\nP(X=1)=\\frac{\\binom{10^{3}}{1}\\binom{10^{7}-10^{3}}{499}}{\\binom{10^{7}}{500}}。\n$$\n由于 $n \\ll N$，超几何分布可以很好地用二项分布来近似，其成功概率为 $p=K/N=10^{-4}$。因此，\n$$\nP(X=1)\\approx \\binom{500}{1}\\,p\\,(1-p)^{499}=500\\cdot 10^{-4}\\,(1-10^{-4})^{499}=0.05\\,(0.9999)^{499}。\n$$\n为了精确计算 $(0.9999)^{499}$，我们使用对数和泰勒展开 $\\ln(1-x)=-x-\\frac{x^{2}}{2}-\\frac{x^{3}}{3}-\\cdots$（对于 $|x|1$），其中 $x=10^{-4}$：\n$$\n\\ln\\big((0.9999)^{499}\\big)=499\\,\\ln(1-10^{-4})\\approx -499\\left(10^{-4}+\\frac{10^{-8}}{2}+\\frac{10^{-12}}{3}\\right)。\n$$\n这得到\n$$\n\\ln\\big((0.9999)^{499}\\big)\\approx -\\left(0.0499+0.000002495+1.663\\ldots\\times 10^{-10}\\right)\\approx -0.049902495,\n$$\n所以\n$$\n(0.9999)^{499}\\approx \\exp(-0.049902495)\\approx 0.951322。\n$$\n因此，\n$$\nP(X=1)\\approx 0.05\\times 0.951322\\approx 0.047566。\n$$\n考虑到当 $n/N=5\\times 10^{-5}$ 时，在三位有效数字的精度下，有限总体修正是可以忽略的，因此四舍五入到三位有效数字得到\n$$\nP(X=1)\\approx 0.0476。\n$$", "answer": "$$\\boxed{0.0476}$$", "id": "1346396"}, {"introduction": "在掌握了基本的二项近似之后，我们来探讨一个更进一步的简化技巧。在某些情况下，即使是二项分布的计算也存在优化的空间，特别是当我们处理的事件非常罕见时（即成功概率 $p$ 极小）。本练习将介绍泊松分布，它是在二项分布基础上处理稀有事件的强大工具，尤其适用于计算像“至多一次”这样的累积概率。[@problem_id:1346441]", "problem": "一家大型出版社刚刚完成了一部备受期待的小说的印刷，共计1,000,000册。由于印刷过程中的一个短暂校准错误，这些书中恰好有450册的某一特定页面被印反了，从而成为次品。一家大型连锁书店收到了一批120册这部小说，这些书是从全部印数中随机抽取的。\n\n使用合适的近似方法，计算该书店收到的这批书中最多包含一册有印刷错误的概率。将最终答案四舍五入到四位有效数字。", "solution": "设 $N=10^{6}$ 为总册数，$D=450$ 为次品册数，$n=120$ 为书店收到的样本量。设 $X$ 表示样本中的次品册数。其精确分布为超几何分布：\n$$\n\\Pr(X=k)=\\frac{\\binom{D}{k}\\binom{N-D}{n-k}}{\\binom{N}{n}},\\quad k=0,1,\\dots,n.\n$$\n我们要求解 $\\Pr(X\\le 1)=\\Pr(X=0)+\\Pr(X=1)$。因为 $n\\ll N$ 且 $p=D/N$ 非常小，所以超几何分布可以很好地用二项分布 $X\\sim\\text{Binomial}(n,p)$ 来近似，其中\n$$\np=\\frac{D}{N}=\\frac{450}{10^{6}}=0.00045.\n$$\n由于 $np=120\\times 0.00045=0.054\\ll 1$，使用泊松近似是合适的，其率 $\\lambda=np$ 为：\n$$\nX\\approx \\text{Poisson}(\\lambda),\\quad \\lambda=np=0.054.\n$$\n对于一个泊松变量，\n$$\n\\Pr(X\\le 1)=\\Pr(X=0)+\\Pr(X=1)=\\exp(-\\lambda)\\left(1+\\lambda\\right).\n$$\n代入 $\\lambda=0.054$，\n$$\n\\Pr(X\\le 1)\\approx \\exp(-0.054)\\left(1+0.054\\right).\n$$\n数值计算结果为，\n$$\n\\exp(-0.054)\\left(1+0.054\\right)\\approx 0.998593\\ldots\n$$\n四舍五入到四位有效数字，得到 $0.9986$。", "answer": "$$\\boxed{0.9986}$$", "id": "1346441"}, {"introduction": "现在，让我们将注意力从“在 $n$ 次试验中成功多少次？”转移到“需要多少次试验才能获得第一次成功？”。这种关于“等待时间”的问题在实际中同样常见。本练习旨在说明，当从大总体中抽样时，近似的思想同样适用，它允许我们用更简洁的几何分布来近似更复杂的负超几何分布，从而展示了这一核心概念的广泛适用性。[@problem_id:1346389]", "problem": "在一个工厂的质量控制部门，有一大批含 $1,000,000$ 个电阻器的货物需要检验。已知这批货物中恰好有 $500$ 个不合格的电阻器。一名检验员从这批货物中逐个随机抽取电阻器，且不放回。找到的第一个不合格电阻器恰好是抽取的第 $100$ 个的概率是多少？\n\n将最终答案四舍五入到四位有效数字。", "solution": "设 $N$ 为电阻器总数，$K$ 为不合格电阻器数量，$G = N - K$ 为合格电阻器数量，并设 $r$ 为首次抽到不合格电阻器时的抽取次数。抽样为不放回抽样。\n\n前 $r-1$ 次抽取全部合格，第 $r$ 次抽取不合格的概率为\n$$\nP(r) = \\left(\\prod_{i=0}^{r-2} \\frac{G - i}{N - i}\\right)\\cdot \\frac{K}{N - (r - 1)}.\n$$\n本题中，$N = 10^{6}$，$K = 500$，$G = 999{,}500$，$r = 100$，所以\n$$\nP(100) = \\left(\\prod_{i=0}^{98} \\frac{999{,}500 - i}{1{,}000{,}000 - i}\\right)\\cdot \\frac{500}{1{,}000{,}000 - 99}.\n$$\n\n为了数值计算到四位有效数字，设 $p = \\frac{K}{N} = 5 \\times 10^{-4}$。当 $N$ 很大且 $r \\ll N$ 时，\n$$\n\\prod_{i=0}^{98} \\frac{N - K - i}{N - i} = \\prod_{i=0}^{98} \\left(1 - \\frac{K}{N - i}\\right) \\approx (1 - p)^{99} \\cdot \\exp\\!\\left(\\sum_{i=0}^{98} \\left[\\ln\\!\\left(1 - \\frac{K}{N - i}\\right) - \\ln(1 - p)\\right]\\right).\n$$\n指数中的修正常数很小；到一阶近似，\n$$\n\\sum_{i=0}^{98} \\left[\\ln\\!\\left(1 - \\frac{K}{N - i}\\right) - \\ln(1 - p)\\right] \\approx -\\frac{p}{1 - p}\\sum_{i=0}^{98}\\sum_{m=1}^{\\infty} \\left(\\frac{i}{N}\\right)^{m} \\approx -\\frac{p}{1 - p}\\left(\\frac{\\sum i}{N} + \\frac{\\sum i^{2}}{N^{2}} + \\frac{\\sum i^{3}}{N^{3}}\\right),\n$$\n其中 $\\sum_{i=0}^{98} i = 4851$，$\\sum_{i=0}^{98} i^{2} = 318{,}549$，以及 $\\sum_{i=0}^{98} i^{3} = 23{,}532{,}201$。这会产生一个量级为 $10^{-5}$ 的相对修正，远小于主项。\n\n通过对数计算主因子 $(1 - p)^{99}$。对 $x = 0.0005$ 使用级数展开 $\\ln(1 - x) = -x - \\frac{x^{2}}{2} - \\frac{x^{3}}{3} - \\frac{x^{4}}{4} - \\cdots$，\n$$\n\\ln(1 - 0.0005) \\approx -0.0005 - \\frac{(0.0005)^{2}}{2} - \\frac{(0.0005)^{3}}{3} - \\frac{(0.0005)^{4}}{4} \\approx -0.0005001250000416823.\n$$\n因此\n$$\n(1 - p)^{99} = \\exp\\!\\big(99 \\ln(1 - 0.0005)\\big) \\approx \\exp(-0.04951237500412655).\n$$\n对 $a = 0.049512375$ 使用级数展开 $\\exp(-a) = 1 - a + \\frac{a^{2}}{2} - \\frac{a^{3}}{6} + \\frac{a^{4}}{24} - \\cdots$，并计算\n$$\na^{2} = 0.002451475278140625,\\quad a^{3} = 0.00012137836327452793,\\quad a^{4} = 0.000006009731039334655,\n$$\n可得\n$$\n\\exp(-a) \\approx 1 - 0.049512375 + \\frac{0.002451475278140625}{2} - \\frac{0.00012137836327452793}{6} + \\frac{0.000006009731039334655}{24} \\approx 0.9516933833173.\n$$\n因此\n$$\n(1 - p)^{99} \\approx 0.9516933833173,\\quad p(1 - p)^{99} \\approx 0.00047584669165865.\n$$\n精确表达式包含因子 $\\frac{K}{N - 99}$ 而不是 $p$，即需乘以 $\\frac{N}{N - 99}$。使用几何级数，\n$$\n\\frac{N}{N - 99} = \\frac{1}{1 - \\frac{99}{10^{6}}} \\approx 1 + \\frac{99}{10^{6}} + \\left(\\frac{99}{10^{6}}\\right)^{2} + \\left(\\frac{99}{10^{6}}\\right)^{3} \\approx 1.0000990098019703.\n$$\n来自分母项变化的微小乘积修正使结果相对改变了约 $-2.4 \\times 10^{-6}$，与上述调整相比，在四位有效数字的精度下可以忽略不计。综合上述计算，\n$$\nP(100) \\approx 0.00047584669165865 \\times 1.0000990098019703 \\approx 0.0004758927.\n$$\n四舍五入到四位有效数字得到 $0.0004759$。", "answer": "$$\\boxed{0.0004759}$$", "id": "1346389"}]}