{"hands_on_practices": [{"introduction": "当我们处理大量独立试验，例如在质量控制中检查成千上万的产品时，正态近似成为估算二项概率的强大工具。本练习将引导你应用连续性校正来解决一个典型问题：计算次品数量至少达到某个阈值的概率。通过这个实践，你将掌握处理形如 $P(X \\ge k)$ 这类不等式时的校正方法，这是应用正态近似时的基本功。[@problem_id:1352452]", "problem": "一家半导体制造厂生产一种特定类型的微处理器。根据质量保证部门的历史数据，平均有3%的微处理器存在轻微的制造缺陷。对于一个新的大订单，生产了一批5000个微处理器。假设每个微处理器的缺陷是独立发生的，估计这批微处理器中次品数量至少为165的概率。\n\n计算该概率并将最终答案四舍五入到四位有效数字。", "solution": "设$X$为这批微处理器中的次品数量。由于缺陷是独立的，且每个产品的缺陷概率为$p=0.03$，共$n=5000$个产品，我们有$X \\sim \\mathrm{Bin}(n,p)$，因此\n$$\n\\mu = \\mathbb{E}[X] = np = 5000 \\cdot 0.03 = 150,\\quad \\sigma^{2} = \\mathrm{Var}(X) = np(1-p) = 5000 \\cdot 0.03 \\cdot 0.97 = 145.5.\n$$\n我们要求解$P(X \\geq 165)$。当$n$很大且$np$和$n(1-p)$都很大时，适用De Moivre–Laplace正态近似：$X$可由$Y \\sim \\mathcal{N}(\\mu,\\sigma^{2})$近似。使用连续性校正，\n$$\nP(X \\geq 165) \\approx P(Y \\geq 164.5) = P\\!\\left(Z \\geq \\frac{164.5 - \\mu}{\\sigma}\\right),\n$$\n其中$Z \\sim \\mathcal{N}(0,1)$。代入$\\mu=150$和$\\sigma=\\sqrt{145.5}$可得\n$$\nz = \\frac{164.5 - 150}{\\sqrt{145.5}} = \\frac{14.5}{\\sqrt{145.5}} \\approx 1.2021.\n$$\n因此，\n$$\nP(X \\geq 165) \\approx P(Z \\geq 1.2021) = 1 - \\Phi(1.2021) \\approx 0.1147,\n$$\n其中$\\Phi$是标准正态累积分布函数。根据要求，最终值四舍五入到四位有效数字。", "answer": "$$\\boxed{0.1147}$$", "id": "1352452"}, {"introduction": "在统计学，特别是在民意调查和实验分析中，我们不仅关心事件发生的概率，还常常关心观测结果与期望值的偏离程度。本练习探讨了如何计算一个随机变量偏离其均值的可能性，这在评估抽样误差或结果的显著性时至关重要。你将学习如何将关于绝对偏差 $|X - \\mu|$ 的问题转化为标准正态近似问题，并正确应用连续性校正。[@problem_id:1352483]", "problem": "在一个大型民主国家，一项新的环境政策正在被审议。根据广泛的历史和人口数据，估计支持该政策的投票人口的真实比例恰好为 $0.52$。为了评估当前的公众情绪，一家民意调查机构对 $1200$ 名选民进行了一次全国性的随机调查。\n\n令 $X$ 为此次调查样本中表示支持该政策的选民人数。该机构希望了解观测到与期望结果有显著偏差的样本结果的概率。\n\n计算在民意调查中，观测到的支持者人数 $X$ 与期望的支持者人数的偏差超过 30 的近似概率。将你的答案表示为四舍五入到四位有效数字的小数。", "solution": "设 $X \\sim \\text{Binomial}(n, p)$，其中 $n=1200$ 且 $p=0.52$。其均值和方差为\n$$\\mu = \\mathbb{E}[X] = np = 1200 \\cdot 0.52 = 624, \\quad \\sigma^{2} = \\operatorname{Var}(X) = np(1-p) = 1200 \\cdot 0.52 \\cdot 0.48 = 299.52,$$\n所以 $\\sigma = \\sqrt{299.52}$。我们感兴趣的概率是\n$$\\mathbb{P\\!}\\left(|X - 624| > 30\\right) = \\mathbb{P}(X \\leq 593) + \\mathbb{P}(X \\geq 655)。$$\n使用带连续性校正的正态近似，设 $Y \\sim N(\\mu, \\sigma^{2})$。那么\n$$\\mathbb{P}(X \\leq 593) \\approx \\mathbb{P}(Y \\leq 593.5), \\quad \\mathbb{P}(X \\geq 655) \\approx \\mathbb{P}(Y \\geq 654.5)。$$\n用 $Z = \\frac{Y - \\mu}{\\sigma}$ 进行标准化，得到\n$$\\mathbb{P}(Y \\leq 593.5) = \\mathbb{P}\\!\\left(Z \\leq \\frac{593.5 - 624}{\\sigma}\\right) = \\mathbb{P}\\!\\left(Z \\leq -\\frac{30.5}{\\sigma}\\right),$$\n$$\\mathbb{P}(Y \\geq 654.5) = \\mathbb{P}\\!\\left(Z \\geq \\frac{654.5 - 624}{\\sigma}\\right) = \\mathbb{P}\\!\\left(Z \\geq \\frac{30.5}{\\sigma}\\right)。$$\n根据对称性，\n$$\\mathbb{P\\!}\\left(|X - 624| > 30\\right) \\approx 2 \\,\\mathbb{P}\\!\\left(Z \\geq \\frac{30.5}{\\sigma}\\right)。$$\n计算标准化阈值\n$$a = \\frac{30.5}{\\sigma} = \\frac{30.5}{\\sqrt{299.52}} \\approx 1.762329。$$\n因此，\n$$\\mathbb{P}\\!\\left(|X - 624| > 30\\right) \\approx 2 \\left[1 - \\Phi(a)\\right],$$\n其中 $\\Phi$ 是标准正态累积分布函数。使用 $\\Phi$ 的高精度近似值，可以得到\n$$1 - \\Phi(1.762329) \\approx 0.0390053,$$\n所以\n$$\\mathbb{P}\\!\\left(|X - 624| > 30\\right) \\approx 2 \\times 0.0390053 = 0.0780106。$$\n四舍五入到四位有效数字，得到 $0.07801$。", "answer": "$$\\boxed{0.07801}$$", "id": "1352483"}, {"introduction": "现实世界的问题往往比单一变量的分析更复杂，例如在选举中比较两位候选人的支持率。这个更具挑战性的练习将你的技能提升到一个新水平，要求你分析两个（相关的）二项随机变量之差的分布。通过解决这个问题，你不仅能巩固连续性校正的知识，还能深入理解如何处理随机变量的线性组合，包括计算它们的均值和方差，这是一个重要的进阶技能。[@problem_id:1352453]", "problem": "一家政治民意调查公司正在一个大都市区进行一项调查，以衡量两位主要候选人——候选人 A 和候选人 B——的支持率。根据大量以往数据，已知任何随机选择的选民支持候选人 A 的概率为 $p_A = 0.45$，支持候选人 B 的概率为 $p_B = 0.40$，或者犹豫不决/支持其他候选人的概率为 $p_I = 1 - p_A - p_B$。每位选民的偏好是相互独立的。\n\n该公司对一个由 $n = 2500$ 名选民组成的随机样本进行调查。设 $N_A$ 为样本中支持候选人 A 的选民人数，$N_B$ 为样本中支持候选人 B 的选民人数。\n\n计算候选人 A 相对于候选人 B 的领先优势（即差值 $N_A - N_B$）至少为 150 的近似概率。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $N_A$ 为样本量为 $n=2500$ 的选民中支持候选人 A 的人数的随机变量，$N_B$ 为支持候选人 B 的人数的随机变量。支持 A、B 和犹豫不决选民的计数向量 $(N_A, N_B, N_I)$ 服从多项分布，其参数为 $n=2500$，概率为 $p_A=0.45$、$p_B=0.40$ 和 $p_I=0.15$。\n\n我们关心的是随机变量 $D = N_A - N_B$，它代表候选人 A 相对于候选人 B 的领先优势。我们想计算概率 $P(D \\ge 150)$。由于 $n$ 很大，我们可以用正态分布来近似 $D$ 的分布。为此，我们首先需要求出 $D$ 的均值（期望值）和方差。\n\n$D$ 的期望值为：\n$$E[D] = E[N_A - N_B] = E[N_A] - E[N_B]$$\n$N_A$ 和 $N_B$ 的边际分布是二项分布。具体来说，$N_A \\sim \\text{Bin}(n, p_A)$ 且 $N_B \\sim \\text{Bin}(n, p_B)$。\n二项随机变量 $\\text{Bin}(k, p)$ 的期望值为 $kp$。因此，\n$$E[N_A] = n p_A$$\n$$E[N_B] = n p_B$$\n所以，$D$ 的均值为：\n$$\\mu_D = E[D] = n p_A - n p_B = n(p_A - p_B)$$\n代入给定值：\n$$\\mu_D = 2500(0.45 - 0.40) = 2500(0.05) = 125$$\n\n$D$ 的方差为：\n$$\\text{Var}(D) = \\text{Var}(N_A - N_B) = \\text{Var}(N_A) + \\text{Var}(N_B) - 2\\text{Cov}(N_A, N_B)$$\n对于边际二项分布：\n$$\\text{Var}(N_A) = n p_A (1-p_A)$$\n$$\\text{Var}(N_B) = n p_B (1-p_B)$$\n对于多项分布，两个计数 $N_i$ 和 $N_j$（当 $i \\neq j$ 时）之间的协方差由 $\\text{Cov}(N_i, N_j) = -n p_i p_j$ 给出。因此，\n$$\\text{Cov}(N_A, N_B) = -n p_A p_B$$\n将这些代入 $D$ 的方差公式：\n$$\\sigma_D^2 = \\text{Var}(D) = n p_A(1-p_A) + n p_B(1-p_B) - 2(-n p_A p_B)$$\n$$\\sigma_D^2 = n p_A - n p_A^2 + n p_B - n p_B^2 + 2n p_A p_B$$\n$$\\sigma_D^2 = n(p_A + p_B) - n(p_A^2 - 2p_A p_B + p_B^2)$$\n$$\\sigma_D^2 = n(p_A + p_B) - n(p_A - p_B)^2$$\n现在，我们代入数值：\n$$\\sigma_D^2 = 2500(0.45 + 0.40) - 2500(0.45 - 0.40)^2$$\n$$\\sigma_D^2 = 2500(0.85) - 2500(0.05)^2$$\n$$\\sigma_D^2 = 2125 - 2500(0.0025) = 2125 - 6.25 = 2118.75$$\n标准差为 $\\sigma_D = \\sqrt{2118.75} \\approx 46.02988$。\n\n我们现在用正态分布 $X \\sim N(\\mu_D=125, \\sigma_D^2=2118.75)$ 来近似 $D$ 的离散分布。我们想求 $P(D \\ge 150)$。由于 $D$ 是一个取整数值的随机变量，我们应用连续性校正。事件 $D \\ge 150$ 包括整数 $150, 151, 152, \\dots$。对于连续近似，这对应于区间 $[149.5, \\infty)$。\n所以，我们计算 $P(X \\ge 149.5)$。\n为了求这个概率，我们对变量 $X$进行标准化：\n$$Z = \\frac{X - \\mu_D}{\\sigma_D}$$\n概率变为：\n$$P(X \\ge 149.5) = P\\left(Z \\ge \\frac{149.5 - 125}{\\sqrt{2118.75}}\\right)$$\n$$P\\left(Z \\ge \\frac{24.5}{46.02988...}\\right)$$\n$$P(Z \\ge 0.532264...)$$\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF）。则 $P(Z \\ge z) = 1 - P(Z < z) = 1 - \\Phi(z)$。\n$$P(Z \\ge 0.532264...) = 1 - \\Phi(0.532264...)$$\n使用标准正态分布表或计算器，我们得到 $\\Phi(0.532264...) \\approx 0.702704$。\n所求的概率为：\n$$P \\approx 1 - 0.702704 = 0.297296$$\n将最终答案四舍五入到四位有效数字，我们得到 $0.2973$。", "answer": "$$\\boxed{0.2973}$$", "id": "1352453"}]}