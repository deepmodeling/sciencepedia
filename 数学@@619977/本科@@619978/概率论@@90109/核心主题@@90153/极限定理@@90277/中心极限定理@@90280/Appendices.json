{"hands_on_practices": [{"introduction": "中心极限定理最直接的应用之一是估计样本均值的分布。在许多现实场景中，例如质量控制，我们可能知道单个测量的均值和方差，但其确切的概率分布是未知的；本练习将向你展示如何利用中心极限定理，来计算一批产品的样本均值达到特定标准的概率，这是统计过程控制中的一项基本技能。[@problem_id:1959595]", "problem": "一家科技公司正在为便携式电子设备开发一种新型固态电池。单个生产级电池单元的能量容量是一个随机变量。虽然电池单元容量的确切分布复杂且未知，但生产线上的大量测试已确定其平均容量为 $\\mu = 4250$ 毫安时 (mAh)，标准差为 $\\sigma = 90$ mAh。为了进行质量控制，从每个生产批次中随机抽取 $n=36$ 个电池单元的样本，并测量其容量。如果这36个抽样电池单元的平均容量超过 $4220$ mAh 的最低阈值，则该批次将被批准发货。假设电池单元的容量是独立同分布的，一个随机选择的批次被批准发货的近似概率是多少？\n\n计算此概率，并将最终答案四舍五入到四位有效数字。", "solution": "设 $X_{1},\\dots,X_{n}$ 为独立同分布的电池单元容量，其均值为 $\\mu=4250$，标准差为 $\\sigma=90$。样本均值为 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$，其中 $n=36$。根据中心极限定理，对于足够大的 $n$，$\\bar{X}$ 的分布近似为正态分布，其均值为 $\\mu$，方差为 $\\sigma^{2}/n$：\n$$\n\\bar{X}\\approx \\mathcal{N}\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right).\n$$\n因此，\n$$\n\\mathbb{P}(\\bar{X}>4220)=\\mathbb{P}\\!\\left(\\frac{\\bar{X}-\\mu}{\\sigma/\\sqrt{n}}>\\frac{4220-\\mu}{\\sigma/\\sqrt{n}}\\right).\n$$\n代入 $\\mu=4250$，$\\sigma=90$ 和 $n=36$ 计算标准化阈值：\n$$\n\\frac{4220-4250}{90/\\sqrt{36}}=\\frac{-30}{90/6}=\\frac{-30}{15}=-2.\n$$\n设 $Z\\sim \\mathcal{N}(0,1)$。那么\n$$\n\\mathbb{P}(\\bar{X}>4220)=\\mathbb{P}(Z>-2)=1-\\Phi(-2)=\\Phi(2),\n$$\n使用标准正态累积分布函数 $\\Phi$ 的对称性 $\\Phi(-z)=1-\\Phi(z)$。数值上，$\\Phi(2)\\approx 0.977249868\\ldots$，四舍五入到四位有效数字为 $0.9772$。", "answer": "$$\\boxed{0.9772}$$", "id": "1959595"}, {"introduction": "除了样本均值，中心极限定理同样适用于独立同分布随机变量的总和。这个练习模拟了一个重复进行的游戏场景，通过计算单次游戏的期望和方差，你可以运用中心极限定理来近似计算多次游戏后总收益或总损失的概率分布。这项技能在风险评估和金融建模等领域至关重要。[@problem_id:1394705]", "problem": "一家娱乐公司设计了一款名为“巫师的赌注”的新嘉年华游戏。玩一局游戏，玩家需要支付3.00金币的费用。然后，玩家从一个装有大量魔法石的大瓮中抽取一颗魔法石。这些魔法石分为三种类型：\n\n1.  红宝石，奖励15.00金币。抽到红宝石的概率是0.05。\n2.  蓝宝石，奖励4.00金币。抽到蓝宝石的概率是0.25。\n3.  黑曜石，没有奖励（0.00金币）。抽到黑曜石的概率是0.70。\n\n一个赌徒决定连续玩这个游戏144次。设“总亏损”定义为支付的总金额减去赢得的总奖金。假设每局游戏的结果是独立的，使用正态近似法计算该赌徒在144局游戏后总亏损小于200.00金币的概率。\n\n将你的答案表示为保留四位有效数字的小数。", "solution": "设 $L$ 表示单局游戏的亏损，定义为支付金额减去奖金。支付金额为 $3$，奖金值为 $15$（概率 $0.05$）、$4$（概率 $0.25$）和 $0$（概率 $0.70$），则 $L$ 的分布为\n$$\nL=\\begin{cases}\n-12 & \\text{概率为 } 0.05,\\\\\n-1 & \\text{概率为 } 0.25,\\\\\n3 & \\text{概率为 } 0.70.\n\\end{cases}\n$$\n计算 $L$ 的均值和方差：\n$$\n\\mu_{L}=\\mathbb{E}[L]=(-12)(0.05)+(-1)(0.25)+(3)(0.70)=1.25,\n$$\n$$\n\\mathbb{E}[L^{2}]=(-12)^{2}(0.05)+(-1)^{2}(0.25)+(3)^{2}(0.70)=13.75,\n$$\n$$\n\\sigma_{L}^{2}=\\operatorname{Var}(L)=\\mathbb{E}[L^{2}]-(\\mathbb{E}[L])^{2}=13.75-(1.25)^{2}=12.1875.\n$$\n设 $S=\\sum_{i=1}^{144}L_{i}$ 为144次独立游戏的总亏损。则\n$$\n\\mu_{S}=\\mathbb{E}[S]=144\\,\\mu_{L}=144\\cdot 1.25=180,\\qquad \\sigma_{S}^{2}=\\operatorname{Var}(S)=144\\,\\sigma_{L}^{2}=144\\cdot 12.1875=1755.\n$$\n根据中心极限定理，$S$ 近似服从均值为 $180$、方差为 $1755$ 的正态分布。所求概率为\n$$\n\\mathbb{P}(S<200)\\approx \\Phi\\!\\left(\\frac{200-\\mu_{S}}{\\sigma_{S}}\\right)=\\Phi\\!\\left(\\frac{20}{\\sqrt{1755}}\\right).\n$$\n数值上，$\\sqrt{1755}\\approx 41.8927$，因此标准化值为\n$$\nz=\\frac{20}{\\sqrt{1755}}\\approx 0.47741,\n$$\n因此\n$$\n\\mathbb{P}(S<200)\\approx \\Phi(0.47741)\\approx 0.6835,\n$$\n保留四位有效数字。", "answer": "$$\\boxed{0.6835}$$", "id": "1394705"}, {"introduction": "中心极限定理的威力远不止于处理和与均值。在统计推断中，我们常常对样本比例的函数（例如比率或对数优势比）更感兴趣；通过结合使用Delta方法，我们可以将中心极限定理的结论推广到这些更复杂的统计量上，本练习将指导你推导对数优势比估计量的渐近方差，这在流行病学和临床试验等领域是一种核心分析工具。[@problem_id:852421]", "problem": "考虑分别从两个不同的伯努利总体中抽取的两个独立随机样本，其样本量分别为 $n_1$ 和 $n_2$。第一个总体的成功概率为 $p_1$，第二个总体的成功概率为 $p_2$。设 $X_1$ 和 $X_2$ 分别为在第一个和第二个样本中观测到的成功次数。那么，样本比例由 $\\hat{p}_1 = \\frac{X_1}{n_1}$ 和 $\\hat{p}_2 = \\frac{X_2}{n_2}$ 给出。\n\n在许多统计分析中，尤其是在流行病学和临床试验中，对数优势比是一个非常重要的量。真实对数优势比定义为 $\\theta = \\log\\left(\\frac{p_1/(1-p_1)}{p_2/(1-p_2)}\\right)$。基于样本比例，该量的估计量是样本对数优势比：\n$$\n\\hat{\\theta} = \\log\\left(\\frac{\\hat{p}_1/(1-\\hat{p}_1)}{\\hat{p}_2/(1-\\hat{p}_2)}\\right)\n$$\n假设样本量 $n_1$ 和 $n_2$ 足够大，中心极限定理可以通过Delta方法进行扩展，以找到 $\\hat{\\theta}$ 的近似分布。\n\n推导对数优势比估计量 $\\hat{\\theta}$ 的渐近方差 $\\text{Var}(\\hat{\\theta})$。", "solution": "问题要求推导对数优势比估计量 $\\hat{\\theta}$ 的渐近方差。我们可以使用多元Delta方法来求解。\n\n首先，根据中心极限定理，对于大样本量 $n_1$ 和 $n_2$，样本比例 $\\hat{p}_1$ 和 $\\hat{p}_2$ 近似服从正态分布：\n$$\n\\hat{p}_1 \\approx N\\left(p_1, \\frac{p_1(1-p_1)}{n_1}\\right)\n$$\n$$\n\\hat{p}_2 \\approx N\\left(p_2, \\frac{p_2(1-p_2)}{n_2}\\right)\n$$\n由于两个样本是独立的，随机变量 $\\hat{p}_1$ 和 $\\hat{p}_2$ 也是独立的。因此，样本比例向量 $\\hat{\\mathbf{p}} = (\\hat{p}_1, \\hat{p}_2)^T$ 服从渐近二元正态分布，其均值向量为 $\\boldsymbol{\\mu}$，协方差矩阵为 $\\boldsymbol{\\Sigma}$：\n$$\n\\boldsymbol{\\mu} = E[\\hat{\\mathbf{p}}] = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\Sigma} = \\text{Cov}(\\hat{\\mathbf{p}}) = \\begin{pmatrix} \\text{Var}(\\hat{p}_1) & \\text{Cov}(\\hat{p}_1, \\hat{p}_2) \\\\ \\text{Cov}(\\hat{p}_1, \\hat{p}_2) & \\text{Var}(\\hat{p}_2) \\end{pmatrix} = \\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1} & 0 \\\\ 0 & \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n$$\n估计量 $\\hat{\\theta}$ 是 $\\hat{p}_1$ 和 $\\hat{p}_2$ 的一个函数。设该函数为 $g(x, y)$:\n$$\ng(x, y) = \\log\\left(\\frac{x/(1-x)}{y/(1-y)}\\right) = \\log(x) - \\log(1-x) - \\log(y) + \\log(1-y)\n$$\n多元Delta方法指出，函数 $g(\\hat{\\mathbf{p}})$ 的渐近方差由下式给出：\n$$\n\\text{Var}(g(\\hat{\\mathbf{p}})) \\approx (\\nabla g(\\boldsymbol{\\mu}))^T \\boldsymbol{\\Sigma} (\\nabla g(\\boldsymbol{\\mu}))\n$$\n其中 $\\nabla g(\\boldsymbol{\\mu})$ 是函数 $g$ 在均值向量 $\\boldsymbol{\\mu} = (p_1, p_2)^T$ 处的梯度。\n\n首先，我们计算 $g(x, y)$ 的梯度：\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{1}{x} - \\frac{1}{1-x}(-1) = \\frac{1}{x} + \\frac{1}{1-x} = \\frac{1-x+x}{x(1-x)} = \\frac{1}{x(1-x)}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -\\frac{1}{y} + \\frac{1}{1-y}(-1) = -\\frac{1}{y} - \\frac{1}{1-y} = -\\frac{1-y+y}{y(1-y)} = -\\frac{1}{y(1-y)}\n$$\n因此梯度向量为 $\\nabla g(x,y) = \\left(\\frac{1}{x(1-x)}, -\\frac{1}{y(1-y)}\\right)^T$。\n\n接下来，我们计算在均值 $\\boldsymbol{\\mu} = (p_1, p_2)^T$ 处的梯度：\n$$\n\\nabla g(\\boldsymbol{\\mu}) = \\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n现在，我们可以将梯度和协方差矩阵代入Delta方法的方差公式中：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx \n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} & -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n\\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1} & 0 \\\\ 0 & \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n我们从左到右进行矩阵乘法。首先，将行向量（梯度的转置）与协方差矩阵相乘：\n$$\n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\cdot \\frac{p_1(1-p_1)}{n_1} + (-\\frac{1}{p_2(1-p_2)}) \\cdot 0 & \\frac{1}{p_1(1-p_1)} \\cdot 0 + (-\\frac{1}{p_2(1-p_2)}) \\cdot \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} \\frac{1}{n_1} & -\\frac{1}{n_2} \\end{pmatrix}\n$$\n最后，将得到的行向量与列向量（梯度）相乘：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx \\begin{pmatrix} \\frac{1}{n_1} & -\\frac{1}{n_2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n$$\n= \\left(\\frac{1}{n_1}\\right) \\left(\\frac{1}{p_1(1-p_1)}\\right) + \\left(-\\frac{1}{n_2}\\right) \\left(-\\frac{1}{p_2(1-p_2)}\\right)\n$$\n$$\n= \\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_2 p_2 (1-p_2)}\n$$\n这就是对数优势比估计量的渐近方差。", "answer": "$$\n\\boxed{\\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_2 p_2 (1-p_2)}}\n$$", "id": "852421"}]}