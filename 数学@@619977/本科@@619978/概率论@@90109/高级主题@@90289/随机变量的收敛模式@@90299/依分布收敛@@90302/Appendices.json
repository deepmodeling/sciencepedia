{"hands_on_practices": [{"introduction": "依分布收敛有时会产生一些与直觉相悖的结果。本练习旨在挑战我们的直觉，通过构建一个随机变量序列，其期望收敛到一个值，而其分布本身却收敛到另一个值的点质量分布。这个实践强调了严格依赖依分布收敛的正式定义（即累积分布函数的收敛）的重要性 [@problem_id:1353078]。", "problem": "考虑一个离散随机变量序列 $\\{X_n\\}_{n=1}^{\\infty}$。对于每个正整数 $n$，随机变量 $X_n$ 可以取两个值中的一个。随机变量 $X_n$ 以概率 $1 - \\frac{1}{n}$ 取值为 $\\frac{1}{n}$。以剩余的概率 $\\frac{1}{n}$，$X_n$ 取值为 $n$。\n\n当 $n$ 变得非常大时，$X_n$ 的概率分布收敛到一个极限分布。下列哪个选项正确地描述了这个极限分布？\n\nA. 在 0 处具有单点质量的离散分布。\n\nB. 在 0 和 1 处具有点质量的离散分布。\n\nC. 在区间 [0, 1] 上的连续均匀分布。\n\nD. 该序列不收敛于任何分布。\n\nE. 标准正态分布。", "solution": "给定一个随机变量序列 $\\{X_{n}\\}_{n=1}^{\\infty}$，其分布为\n$$\n\\mathbb{P}(X_{n}=\\tfrac{1}{n})=1-\\tfrac{1}{n}, \\qquad \\mathbb{P}(X_{n}=n)=\\tfrac{1}{n}.\n$$\n为了从依分布收敛的意义上确定极限分布，我们考虑分布函数 $F_{n}(x)=\\mathbb{P}(X_{n}\\le x)$。对于固定的 $n$，我们分段计算 $F_{n}(x)$：\n- 如果 $x<0$，则 $F_{n}(x)=0$，因为 $X_{n}>0$ 几乎必然成立。\n- 如果 $0\\le x<\\tfrac{1}{n}$，则 $F_{n}(x)=0$，因为 $X_{n}$ 的两个可能取值都大于 $x$。\n- 如果 $\\tfrac{1}{n}\\le x<n$，则 $F_{n}(x)=\\mathbb{P}(X_{n}=\\tfrac{1}{n})=1-\\tfrac{1}{n}$。\n- 如果 $x\\ge n$，则 $F_{n}(x)=1$。\n\n固定 $x\\in \\mathbb{R}$ 并令 $n\\to\\infty$：\n- 如果 $x<0$，则对所有 $n$ 都有 $F_{n}(x)=0$，所以 $\\lim_{n\\to\\infty}F_{n}(x)=0$。\n- 如果 $x>0$，则对于所有足够大的 $n$，我们有 $\\tfrac{1}{n}\\le x<n$，因此当 $n\\to\\infty$ 时，$F_{n}(x)=1-\\tfrac{1}{n}\\to 1$。\n- 在 $x=0$ 处，对所有 $n$ 都有 $F_{n}(0)=\\mathbb{P}(X_{n}\\le 0)=0$，所以 $\\lim_{n\\to\\infty}F_{n}(0)=0$；然而，依分布收敛仅要求在极限分布函数的连续点上收敛。\n\n定义 $F(x)$ 如下\n$$\nF(x)=\\begin{cases}\n0, & x<0,\\\\\n1, & x>0.\n\\end{cases}\n$$\n这个 $F$ 是在 $0$ 处的退化（点质量）分布的分布函数，在 $x=0$ 处有一个跳跃。由于对于 $F$ 的每个连续点 $x$（即，对于所有 $x\\neq 0$），都有 $\\lim_{n\\to\\infty}F_{n}(x)=F(x)$，根据依分布收敛的定义，可知 $X_{n}\\Rightarrow \\delta_{0}$，即一个在 0 处具有单点质量的离散分布。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1353078"}, {"introduction": "从基本定义出发，我们转向一个证明依分布收敛的最强大工具：中心极限定理。本练习将展示如何应用中心极限定理来求出标准化样本均值的极限分布，即使其原始分布（在此为几何分布）并非正态分布。这是统计推断中的一项基石技能 [@problem_id:1910214]。", "problem": "设 $X_1, X_2, \\dots, X_n$ 是一列独立同分布的随机变量，每个变量都服从成功概率为 $p$ 的几何分布。每个 $X_i$ 的概率质量函数为 $P(X_i=k) = (1-p)^{k-1}p$，其中 $k = 1, 2, 3, \\dots$。这表示获得首次成功所需的试验次数。\n\n设 $\\bar{X}_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 为这些变量的样本均值。考虑如下定义的标准化随机变量 $Z_n$：\n$$Z_n = \\frac{\\sqrt{n}(\\bar{X}_n - 1/p)}{\\sqrt{\\frac{1-p}{p^2}}}$$\n给定成功概率 $p=0.4$，计算极限 $\\lim_{n \\to \\infty} P(Z_n \\le 1.5)$ 的值。\n\n将最终答案四舍五入至四位有效数字。", "solution": "给定的 $X_{i}$ 是在 $\\{1,2,\\dots\\}$ 上独立同分布的随机变量，服从成功概率为 $p$ 的几何分布。对于此参数化，其均值和方差为\n$$\n\\mu=\\mathbb{E}[X_{i}]=\\frac{1}{p}, \\qquad \\sigma^{2}=\\operatorname{Var}(X_{i})=\\frac{1-p}{p^{2}}.\n$$\n样本均值为 $\\bar{X}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。根据林德伯格-勒维中心极限定理 (Lindeberg–Levy Central Limit Theorem, CLT)，由于 $X_{i}$ 是具有有限均值 $\\mu$ 和方差 $\\sigma^{2}$ 的独立同分布随机变量，我们有\n$$\n\\frac{\\sqrt{n}\\left(\\bar{X}_{n}-\\mu\\right)}{\\sigma}\\;\\xrightarrow{d}\\;N(0,1).\n$$\n问题中的标准化变量是\n$$\nZ_{n}=\\frac{\\sqrt{n}\\left(\\bar{X}_{n}-\\frac{1}{p}\\right)}{\\sqrt{\\frac{1-p}{p^{2}}}},\n$$\n这与使用 $\\mu=\\frac{1}{p}$ 和 $\\sigma=\\sqrt{\\frac{1-p}{p^{2}}}$ 的中心极限定理标准化形式相匹配。因此，\n$$\nZ_{n}\\;\\xrightarrow{d}\\;N(0,1).\n$$\n根据连续映射定理（或等价地，根据在极限累积分布函数连续点上的依分布收敛），对于任意实数 $a$，\n$$\n\\lim_{n\\to\\infty}\\mathbb{P}(Z_{n}\\le a)=\\Phi(a),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。取 $a=1.5$，并使用指定的 $p=0.4$（这不影响标准化极限），\n$$\n\\lim_{n\\to\\infty}\\mathbb{P}(Z_{n}\\le 1.5)=\\Phi(1.5).\n$$\n计算标准正态累积分布函数在 $1.5$ 处的值，并四舍五入至四位有效数字，可得\n$$\n\\Phi(1.5)\\approx 0.9332.\n$$", "answer": "$$\\boxed{0.9332}$$", "id": "1910214"}, {"introduction": "最后的这个练习将深入探讨一个更高级的主题：顺序统计量的极限行为。我们将分析来自均匀分布的样本极差，这需要将问题分解，分别研究最小值和最大值的极限行为，然后再将它们组合起来。本练习不仅展示了一种多步骤的解题策略，还揭示了两个收敛序列之和的极限分布，最终导出一个伽马分布 [@problem_id:1910222]。", "problem": "设 $U_1, U_2, \\dots, U_n$ 是从区间 $(0, 1)$ 上的标准均匀分布中抽取的样本量为 $n$ 的随机样本。该样本的顺序统计量记为 $U_{(1)} \\le U_{(2)} \\le \\dots \\le U_{(n)}$，其中 $U_{(1)}$ 是样本最小值，$U_{(n)}$ 是样本最大值。样本极差定义为随机变量 $R_n = U_{(n)} - U_{(1)}$。\n\n考虑一个新的随机变量 $W_n$ 定义为 $W_n = n(1 - R_n)$。当样本量 $n$ 趋于无穷大时，$W_n$ 的分布收敛到一个特定的极限分布。下列哪项描述了这个极限分布？\n\nA. 均值为 1、方差为 1 的正态分布，$N(1, 1)$。\n\nB. 率参数 $\\lambda = 1$ 的指数分布。\n\nC. 形状参数 $\\alpha = 2$、率参数 $\\lambda = 1$ 的伽马分布。\n\nD. 自由度为 2 的卡方分布，$\\chi^2(2)$。\n\nE. 所有概率质量都集中在点 2 上的退化分布。", "solution": "该问题要求随机变量 $W_n = n(1 - R_n)$ 的极限分布，其中 $R_n = U_{(n)} - U_{(1)}$ 是从 $\\text{Uniform}(0,1)$ 分布中抽取的样本量为 $n$ 的样本的极差。\n\n首先，我们可以将 $W_n$ 改写成一个更方便的形式。\n$$W_n = n(1 - (U_{(n)} - U_{(1)})) = n(1 - U_{(n)} + U_{(1)})$$\n我们可以把它分成两项：\n$$W_n = n U_{(1)} + n(1 - U_{(n)})$$\n我们定义两个新的随机变量序列：$X_n = n U_{(1)}$ 和 $Y_n = n(1 - U_{(n)})$。于是，$W_n = X_n + Y_n$。我们将通过先求出 $(X_n, Y_n)$ 的联合极限分布，然后应用连续映射定理来求 $W_n$ 的极限分布。\n\n一个标准均匀分布 $\\text{Uniform}(0,1)$ 的随机变量 $U$ 的累积分布函数(CDF)是 $F_U(u) = u$，其中 $u \\in (0, 1)$。\n\n我们来求 $X_n = nU_{(1)}$ 的极限分布。对任意 $x > 0$：\n$X_n$ 的CDF为 $F_{X_n}(x) = P(X_n \\le x) = P(nU_{(1)} \\le x) = P(U_{(1)} \\le x/n)$。\n处理其补事件会更容易一些：\n$P(U_{(1)} > x/n) = P(U_1 > x/n, U_2 > x/n, \\dots, U_n > x/n)$。\n由于 $U_i$ 是独立同分布 (i.i.d.) 的，这等于：\n$P(U_{(1)} > x/n) = [P(U_1 > x/n)]^n = (1 - P(U_1 \\le x/n))^n = (1 - F_U(x/n))^n = (1 - x/n)^n$。\n这个等式在 $0 < x/n < 1$ 时成立，对于足够大的 $n$ 这是满足的。\n当 $n \\to \\infty$ 时取极限：\n$\\lim_{n \\to \\infty} P(U_{(1)} > x/n) = \\lim_{n \\to \\infty} (1 - x/n)^n = \\exp(-x)$。\n因此，$X_n$ 的极限CDF为：\n$F_X(x) = \\lim_{n \\to \\infty} F_{X_n}(x) = 1 - \\lim_{n \\to \\infty} P(U_{(1)} > x/n) = 1 - \\exp(-x)$，对于 $x > 0$。\n这是率参数 $\\lambda=1$ 的指数分布的CDF。所以，$X_n \\xrightarrow{d} X \\sim \\text{Exp}(1)$。\n\n接下来，我们求 $Y_n = n(1 - U_{(n)})$ 的极限分布。对任意 $y > 0$：\n$Y_n$ 的CDF为 $F_{Y_n}(y) = P(Y_n \\le y) = P(n(1 - U_{(n)}) \\le y) = P(1 - U_{(n)} \\le y/n) = P(U_{(n)} \\ge 1-y/n)$。\n再次，我们考虑其补事件：\n$P(U_{(n)} < 1 - y/n) = P(U_1 < 1-y/n, \\dots, U_n < 1-y/n)$。\n由于 $U_i$ 是 i.i.d. 的：\n$P(U_{(n)} < 1 - y/n) = [P(U_1 < 1-y/n)]^n = (F_U(1-y/n))^n = (1-y/n)^n$。\n这个等式在 $0 < 1-y/n < 1$ 时成立，对于足够大的 $n$ 这是满足的。\n当 $n \\to \\infty$ 时取极限：\n$\\lim_{n \\to \\infty} P(U_{(n)} < 1-y/n) = \\lim_{n \\to \\infty} (1 - y/n)^n = \\exp(-y)$。\n因此，$Y_n$ 的极限CDF为：\n$F_Y(y) = \\lim_{n \\to \\infty} F_{Y_n}(y) = 1 - \\lim_{n \\to \\infty} P(U_{(n)} < 1-y/n) = 1 - \\exp(-y)$，对于 $y > 0$。\n这也是率参数 $\\lambda=1$ 的指数分布的CDF。所以，$Y_n \\xrightarrow{d} Y \\sim \\text{Exp}(1)$。\n\n现在，我们必须确定极限变量 $X$ 和 $Y$ 是否独立。为此，我们求 $(X_n, Y_n)$ 的联合CDF的极限。对 $x > 0, y > 0$：\n$F_{X_n, Y_n}(x,y) = P(X_n \\le x, Y_n \\le y) = P(nU_{(1)} \\le x, n(1-U_{(n)}) \\le y) = P(U_{(1)} \\le x/n, U_{(n)} \\ge 1-y/n)$。\n这是样本最小值至多为 $x/n$ 且样本最大值至少为 $1-y/n$ 的概率。计算补事件的概率更容易，即 $\\{U_{(1)} > x/n\\} \\cup \\{U_{(n)} < 1-y/n\\}$。\n使用容斥原理：\n$P(\\{U_{(1)} > x/n\\} \\cup \\{U_{(n)} < 1-y/n\\}) = P(U_{(1)} > x/n) + P(U_{(n)} < 1-y/n) - P(U_{(1)} > x/n, U_{(n)} < 1-y/n)$。\n我们已经求得 $P(U_{(1)} > x/n) = (1-x/n)^n$ 和 $P(U_{(n)} < 1-y/n) = (1-y/n)^n$。\n交事件 $\\{U_{(1)} > x/n, U_{(n)} < 1-y/n\\}$ 意味着所有 $U_i$ 都必须落在区间 $(x/n, 1-y/n)$ 内。该区间的长度为 $(1-y/n) - x/n = 1 - (x+y)/n$。\n$P(U_{(1)} > x/n, U_{(n)} < 1-y/n) = P(\\text{所有 } U_i \\in (x/n, 1-y/n)) = [1 - (x+y)/n]^n$。\n为使此式有效，我们需要 $x/n < 1-y/n$，这对于足够大的 $n$ 是成立的。\n所以，$\\lim_{n \\to \\infty} P(\\{U_{(1)} > x/n\\} \\cup \\{U_{(n)} < 1-y/n\\}) = \\exp(-x) + \\exp(-y) - \\exp(-(x+y))$。\n联合极限CDF是：\n$F_{X,Y}(x,y) = \\lim_{n \\to \\infty} F_{X_n, Y_n}(x,y) = 1 - (\\exp(-x) + \\exp(-y) - \\exp(-(x+y)))$。\n$F_{X,Y}(x,y) = 1 - \\exp(-x) - \\exp(-y) + \\exp(-x)\\exp(-y) = (1-\\exp(-x))(1-\\exp(-y))$。\n这是边缘CDF $F_X(x)F_Y(y)$ 的乘积。这证明了极限随机变量 $X$ 和 $Y$ 是独立的。\n\n由于 $W_n = X_n + Y_n$ 且 $(X_n, Y_n) \\xrightarrow{d} (X,Y)$，其中 $X$ 和 $Y$ 是独立同分布的 $\\text{Exp}(1)$ 随机变量，根据连续映射定理，$W_n$ 的分布收敛于 $W = X+Y$ 的分布。\n两个独立同分布的指数($\\lambda$)随机变量之和服从形状参数 $\\alpha=2$ 和率参数 $\\lambda$ 的伽马分布。在我们的情况下，$\\lambda=1$。\n因此，$W_n$ 的极限分布是 $\\text{Gamma}(2, 1)$ 分布。\n\n我们来检查一下选项：\nA. 正态分布 - 错误。\nB. $\\text{Exp}(1)$ 分布 - 错误。如果我们只考虑 $X_n$ 或 $Y_n$，这会是极限分布。\nC. $\\text{Gamma}(2, 1)$ 分布 - 正确。\nD. 自由度为 2 的卡方分布 ($\\chi^2(2)$)，等价于形状参数 $\\alpha=1$ 和率参数 $\\lambda=1/2$ 的伽马分布。这不是 $\\text{Gamma}(2, 1)$。所以，这是错误的。\nE. 退化分布 - 错误。极限分布是非退化的。", "answer": "$$\\boxed{C}$$", "id": "1910222"}]}