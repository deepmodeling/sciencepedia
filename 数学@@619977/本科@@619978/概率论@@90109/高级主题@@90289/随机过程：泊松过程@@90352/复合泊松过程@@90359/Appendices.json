{"hands_on_practices": [{"introduction": "我们从一个直观的例子开始，来建立对复合泊松过程的基本理解。在这个练习中，我们将探讨一个事件发生量级恒定的简化情景。通过计算特定时期内总累积量的概率，你将直接看到复合过程的行为如何由其底层的泊松计数过程决定，这为你掌握更复杂的模型奠定了坚实的基础 [@problem_id:1290788]。", "problem": "在某一特定的半干旱地区，重大降雨事件非常罕见。数十年的观测表明，这些事件的发生可以用一个泊松过程来建模，其平均速率为每年 $\\lambda$ 次事件。气候数据还表明，每一次重大降雨事件发生时，都会稳定地带来总量为 $c$ 毫米的降水。假设不同事件带来的降雨量是相互独立的。\n\n计算在一年内，这些重大事件带来的总累积降雨量不超过 $2c$ 的概率。请用一个关于 $\\lambda$ 的符号表达式来表示您的答案。", "solution": "设 $N$ 表示一年内重大降雨事件的次数。根据泊松过程的定义属性，长度为 $t$ 的时间区间内的事件计数服从参数为 $\\lambda t$ 的泊松分布。对于 $t=1$ 年，我们有\n$$\nN \\sim \\text{Poisson}(\\lambda),\n$$\n所以\n$$\n\\mathbb{P}(N=k)=\\exp(-\\lambda)\\frac{\\lambda^{k}}{k!}, \\quad k=0,1,2,\\ldots\n$$\n每次事件恰好带来 $c$ 毫米的降水，所以这些事件带来的年总降雨量为\n$$\nR=cN.\n$$\n假设 $c>0$，则条件 $R \\leq 2c$ 等价于 $cN \\leq 2c$，这又等价于 $N \\leq 2$。因此，\n$$\n\\mathbb{P}(R \\leq 2c)=\\mathbb{P}(N \\leq 2)=\\sum_{k=0}^{2}\\mathbb{P}(N=k)=\\sum_{k=0}^{2}\\exp(-\\lambda)\\frac{\\lambda^{k}}{k!}.\n$$\n提出因子 $\\exp(-\\lambda)$ 得到\n$$\n\\mathbb{P}(R \\leq 2c)=\\exp(-\\lambda)\\left(1+\\lambda+\\frac{\\lambda^{2}}{2}\\right)=\\exp(-\\lambda)\\sum_{k=0}^{2}\\frac{\\lambda^{k}}{k!}.\n$$", "answer": "$$\\boxed{\\exp(-\\lambda)\\left(1+\\lambda+\\frac{\\lambda^{2}}{2}\\right)}$$", "id": "1290788"}, {"introduction": "在掌握了基本概念之后，我们进而转向一个更普遍的情形，即每次事件的“跳跃”大小本身是一个随机变量。这个练习将引导你计算复合泊松过程的两个核心统计特征：均值和方差。通过这个源于粒子运动的假设性例子，你将学会应用复合泊松过程的矩公式，这是评估和预测这类随机系统长期行为的关键技能 [@problem_id:1317627]。", "problem": "一个亚原子粒子在一维空间中运动。其运动特征为一系列由碰撞引起的瞬时位移。在长度为 $t$ 的时间间隔内，碰撞次数 $N(t)$ 遵循一个速率为 $\\lambda$ 的泊松过程。每次碰撞导致一个位移 $Y_i$（其中 $i=1, 2, \\dots$）。位移 $\\{Y_i\\}$ 是独立同分布的随机变量，并且它们也独立于过程 $N(t)$。\n\n每次位移 $Y_i$ 的分布如下：\n- 以概率 $p$ 发生位移 $+\\delta$。\n- 以概率 $q$ 发生位移 $-2\\delta$。\n- 以概率 $1-p-q$ 发生位移 $0$。\n\n其中，$\\delta$ 是一个代表基本长度尺度的正常数，$p$ 和 $q$ 是概率。令 $X(t) = \\sum_{i=1}^{N(t)} Y_i$ 为粒子在时间 $t$ 后的净位移。若无碰撞发生，则位移为零。\n\n确定粒子在时间 $t$ 后的净位移的均值 $E[X(t)]$ 和方差 $Var(X(t))$。最终答案应为一对用 $\\lambda, t, \\delta, p, q$ 表示的均值和方差的表达式。", "solution": "设 $N(t)$ 服从参数为 $\\lambda t$ 的泊松分布，且独立于独立同分布的位移 $\\{Y_{i}\\}$。定义 $X(t)=\\sum_{i=1}^{N(t)} Y_{i}$，并约定若 $N(t)=0$ 则 $X(t)=0$。\n\n首先计算单次位移 $Y$ 的一阶矩和二阶矩。根据给定的分布，\n$$\nE[Y]=\\delta \\cdot p+(-2\\delta)\\cdot q+0\\cdot(1-p-q)=\\delta(p-2q),\n$$\n且\n$$\nE[Y^{2}]=\\delta^{2}\\cdot p+(4\\delta^{2})\\cdot q+0\\cdot(1-p-q)=\\delta^{2}(p+4q).\n$$\n\n在给定 $N(t)=n$ 的条件下，$X(t)$ 是 $n$ 个独立同分布项的和，故\n$$\nE[X(t)\\mid N(t)=n]=n\\,E[Y]=n\\,\\delta(p-2q),\n$$\n且\n$$\n\\operatorname{Var}(X(t)\\mid N(t)=n)=n\\,\\operatorname{Var}(Y)=n\\,(E[Y^{2}]-(E[Y])^{2}).\n$$\n\n应用全期望公式，并利用当 $N(t)\\sim\\text{Poisson}(\\lambda t)$ 时 $E[N(t)]=\\lambda t$ 的性质，可得\n$$\nE[X(t)]=E\\big[E[X(t)\\mid N(t)]\\big]=E[N(t)]\\,E[Y]=\\lambda t\\,\\delta(p-2q).\n$$\n\n应用全方差公式，\n$$\n\\operatorname{Var}(X(t))=E\\big[\\operatorname{Var}(X(t)\\mid N(t))\\big]+\\operatorname{Var}\\big(E[X(t)\\mid N(t)]\\big).\n$$\n代入条件矩，并注意到 $\\operatorname{Var}(N(t))=\\lambda t$，可得\n$$\n\\operatorname{Var}(X(t))=E[N(t)]\\,\\operatorname{Var}(Y)+\\operatorname{Var}(N(t))\\,(E[Y])^{2}\n=\\lambda t\\big(\\operatorname{Var}(Y)+(E[Y])^{2}\\big)=\\lambda t\\,E[Y^{2}].\n$$\n将上面求得的 $E[Y^{2}]=\\delta^{2}(p+4q)$ 代入，我们最终得到\n$$\n\\operatorname{Var}(X(t))=\\lambda t\\,\\delta^{2}(p+4q).\n$$\n\n因此，均值和方差分别为\n$$\nE[X(t)]=\\lambda t\\,\\delta(p-2q),\\qquad \\operatorname{Var}(X(t))=\\lambda t\\,\\delta^{2}(p+4q).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\lambda t \\delta (p-2 q) & \\lambda t \\delta^{2} (p+4 q)\\end{pmatrix}}$$", "id": "1317627"}, {"introduction": "最后一个练习将挑战你的逆向思维和综合应用能力。在实际问题中，我们常常只能观测到过程的宏观总体效应（如总体的均值和方差），而需要反过来推断其微观层面的驱动机制。这个练习模拟了这样一个场景，你需要利用已知的过程均值和方差来反解出单个事件跳跃大小的统计特性，从而加深对复合泊松过程背后深刻关系的理解 [@problem_id:715429]。", "problem": "一个随机过程 $X(t)$，表示一系列事件随时间累积的效应，被建模为一个复合泊松过程：\n$$\nX(t) = \\sum_{i=1}^{N(t)} Y_i\n$$\n在此模型中，$N(t)$ 是一个具有恒定速率 $\\lambda > 0$ 的齐次泊松过程，它计算截至时间 $t$ 发生的事件数量。各项 $\\{Y_i\\}_{i=1,2,...}$ 是独立同分布 (i.i.d.) 的随机变量，代表每次事件的幅度或“跳跃大小”。跳跃大小也独立于计数过程 $N(t)$。假设期望的跳跃大小为非负，即 $E[Y] \\ge 0$。\n\n聚合过程 $X(t)$ 的均值和方差已被确定，并且是时间的线性函数：\n1.  $E[X(t)] = At$\n2.  $\\text{Var}(X(t)) = Bt$\n\n此处，$A$ 和 $B$ 是已知的正常数。\n\n此外，所建模系统的一个特定特征规定了事件速率与其期望幅度之间的关系。该关系由下式给出：\n3.  $\\lambda = k E[Y]$\n\n其中 $k$ 是一个已知的正比例常数。\n\n利用这些信息，推导跳跃大小分布的方差 $\\text{Var}(Y)$ 关于常数 $A$、$B$ 和 $k$ 的闭式表达式。", "solution": "1. 对于一个速率为 $\\lambda$、跳跃分布为 $Y$（均值为 $\\mu=E[Y]$，方差为 $\\sigma^2=\\Var(Y)$）的复合泊松过程，\n   $$E[N(t)]=\\lambda t,\\quad \\Var(N(t))=\\lambda t.$$\n2. $X(t)=\\sum_{i=1}^{N(t)}Y_i$ 的均值为\n   $$E[X(t)]=E[N(t)]\\,\\mu=\\lambda t\\,\\mu=At\\quad\\Longrightarrow\\quad A=\\lambda\\mu.$$\n3. $X(t)$ 的方差为\n   $$\\Var(X(t))=E[N(t)]\\,\\sigma^2+\\Var(N(t))\\,\\mu^2=\\lambda t\\,\\sigma^2+\\lambda t\\,\\mu^2\n      =\\lambda(\\sigma^2+\\mu^2)\\,t=Bt\\quad\\Longrightarrow\\quad B=\\lambda(\\sigma^2+\\mu^2).$$\n4. 给定约束条件\n   $$\\lambda=k\\,E[Y]=k\\,\\mu,$$\n   从 $A=\\lambda\\mu$ 我们得到\n   $$A=k\\,\\mu^2\\quad\\Longrightarrow\\quad \\mu^2=\\frac{A}{k}.$$\n5. 从 $B=\\lambda(\\sigma^2+\\mu^2)=k\\,\\mu\\;(\\sigma^2+\\mu^2)$ 我们有\n   $$\\frac{B}{k\\,\\mu}=\\sigma^2+\\mu^2\n      \\quad\\Longrightarrow\\quad\n      \\sigma^2=\\frac{B}{k\\,\\mu}-\\mu^2.$$\n6. 代入 $\\mu=\\sqrt{A/k}$：\n   $$\\Var(Y)=\\sigma^2\n      =\\frac{B}{k\\sqrt{A/k}}-\\frac{A}{k}\n      =\\frac{B}{\\sqrt{kA}}-\\frac{A}{k}.$$", "answer": "$$\\boxed{\\frac{B}{\\sqrt{kA}}-\\frac{A}{k}}$$", "id": "715429"}]}