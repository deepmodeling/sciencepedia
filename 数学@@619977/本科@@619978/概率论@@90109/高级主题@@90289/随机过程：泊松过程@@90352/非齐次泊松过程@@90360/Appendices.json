{"hands_on_practices": [{"introduction": "非齐次泊松过程最直接的应用之一是预测随时间变化的事件的累积总量。这个练习将带我们进入一个实际的商业场景：预测一款新手机游戏的收入。通过这个练习 [@problem_id:1321729]，你将学习如何通过对速率函数 $\\lambda(t)$ 进行积分来计算预期事件数，并应用“稀疏化”这一重要技巧来处理只有部分事件符合特定条件的情况。", "problem": "一款新的手机游戏发布，其受欢迎程度迅速增长。观察到新玩家注册的速率随时间增加。这个过程可以建模为一个非齐次泊松过程，其中在时间 $t$（以游戏发布后的小时数计）的新注册速率由 $\\lambda(t) = a t^2$ 给出，其中 $a$ 是一个正常数。\n\n根据市场数据，已知任何给定的新玩家在注册时会以一个恒定的概率 $p$ 进行一次即时的应用内购买。每次此类购买的金额可以视为一个常数，即 $R$ 美元。\n\n假设每个玩家做出购买的决定是相互独立的，请找出在游戏发布后的前 $T$ 小时内，由这些即时应用内购买产生的总期望收入的表达式。请用参数 $a, p, R,$ 和 $T$ 来表示你的答案。", "solution": "在时间区间 $\\left[0,T\\right]$ 内的注册人数可以通过一个瞬时速率为 $\\lambda(t)=a t^{2}$ 的非齐次泊松过程来建模。到时间 $T$ 为止的累积速率（均值测度）是：\n$$\n\\Lambda(T)=\\int_{0}^{T}\\lambda(t)\\,dt=\\int_{0}^{T}a t^{2}\\,dt=\\frac{a T^{3}}{3}\n$$\n对于一个非齐次泊松过程，到时间 $T$ 为止的到达事件的期望数量是 $E[N(T)]=\\Lambda(T)$。\n\n每次到达事件以概率 $p$ 独立地导致一次即时购买。根据泊松过程的稀疏化特性，进行购买的到达事件构成一个速率为 $p\\,\\lambda(t)=p a t^{2}$ 的非齐次泊松过程。因此，到时间 $T$ 为止的购买玩家的期望数量是：\n$$\nE[N_{p}(T)]=\\int_{0}^{T}p a t^{2}\\,dt=p\\,\\Lambda(T)=\\frac{p a T^{3}}{3}\n$$\n每个购买玩家产生 $R$ 的收入，因此在 $\\left[0,T\\right]$ 上的总收入是 $R\\,N_{p}(T)$。利用期望的线性性质，\n$$\nE[\\text{Revenue in }[0,T]] = R\\,E[N_{p}(T)] = R\\,\\frac{p a T^{3}}{3}\n$$\n因此，在前 $T$ 小时内由即时应用内购买产生的总期望收入是 $\\frac{a p R T^{3}}{3}$。", "answer": "$$\\boxed{\\frac{a p R T^{3}}{3}}$$", "id": "1321729"}, {"introduction": "我们可以从两个核心视角来理解一个点过程：一是在特定时间段内的事件总数 $N(t)$，二是第 $n$ 个事件的到达时间 $S_n$。这个问题 [@problem_id:1377398] 旨在揭示这两个视角之间的根本联系，这是一个在理论和实践中都至关重要的关系。通过解决这个问题，你将掌握如何将关于到达时间的问题转化为关于事件计数的问题，从而利用泊松分布的强大特性来求解。", "problem": "一个天文台正在监测一场流星雨。流星的探测被建模为一个时间上的点过程。由于流星雨的动态特性，流星探测的瞬时率 $\\lambda(t)$ 不是恒定的，而是随时间线性增加。该过程从 $t=0$ 开始，其速率函数由 $\\lambda(t) = ct$ ($t \\ge 0$) 给出，其中 $t$ 的单位是小时，$c$ 是一个正常数，单位是流星数/小时的平方。\n\n该天文台的软件被设计为在探测到第三颗流星时，立即自动触发高分辨率成像序列。一项独立的、对遥远星系的关键观测计划在 $t=0$ 到 $t=T$ 期间进行。至关重要的是，流星成像序列不能中断这项主要观测。\n\n计算第三颗流星在时间 $T$ 之后才被探测到的概率，从而避免任何冲突。你的答案应该是一个用参数 $c$ 和 $T$ 表示的符号表达式。", "solution": "我们将流星探测建模为一个非齐次泊松过程，其瞬时率（强度）为 $\\lambda(t)=c t$ ($t \\ge 0$)，其中 $c>0$。相应的累积（均值）速率函数定义为：\n$$\n\\Lambda(t) = \\int_{0}^{t} \\lambda(s)\\, ds = \\int_{0}^{t} c s \\, ds = \\frac{c}{2} t^{2}\n$$\n一个强度为 $\\lambda(t)$、累积速率为 $\\Lambda(t)$ 的非齐次泊松过程的基本性质是，计数变量 $N(t)$ 服从均值为 $\\Lambda(t)$ 的泊松分布：\n$$\n\\mathbb{P}\\big(N(t)=n\\big) = \\exp\\!\\big(-\\Lambda(t)\\big)\\, \\frac{\\Lambda(t)^{n}}{n!}, \\quad n=0,1,2,\\dots\n$$\n令 $S_{3}$ 表示第三颗流星出现的时间。事件 $\\{S_{3} > T\\}$ 发生，当且仅当在时间 $T$ 之前观测到最多两颗流星，即：\n$$\n\\{S_{3} > T\\} \\equiv \\{N(T) \\le 2\\}\n$$\n因此，\n$$\n\\mathbb{P}(S_{3} > T) = \\sum_{n=0}^{2} \\mathbb{P}\\big(N(T)=n\\big) = \\sum_{n=0}^{2} \\exp\\!\\big(-\\Lambda(T)\\big)\\, \\frac{\\Lambda(T)^{n}}{n!}\n$$\n代入 $\\Lambda(T)=\\frac{c}{2}T^{2}$ 可得：\n$$\n\\mathbb{P}(S_{3} > T) = \\exp\\!\\left(-\\frac{c}{2} T^{2}\\right)\\, \\sum_{n=0}^{2} \\frac{\\left(\\frac{c}{2} T^{2}\\right)^{n}}{n!}\n$$\n等价地，展开这个有限和，\n$$\n\\mathbb{P}(S_{3} > T) = \\exp\\!\\left(-\\frac{c}{2} T^{2}\\right)\\left[1 + \\frac{c}{2} T^{2} + \\frac{1}{2}\\left(\\frac{c}{2} T^{2}\\right)^{2}\\right]\n$$\n这就是所求的第三颗流星在时间 $T$ 之后才被探测到的概率。", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{c}{2} T^{2}\\right)\\,\\sum_{n=0}^{2} \\frac{\\left(\\frac{c}{2} T^{2}\\right)^{n}}{n!}}$$", "id": "1377398"}, {"introduction": "假设我们知道在某个时间段内恰好发生了一个事件，我们能否推断出这个事件最可能发生在何时？这个问题 [@problem_id:1377436] 引导我们深入探讨事件时间的条件分布，这是非齐次泊松过程的一个更精妙的特性。解决这个问题将揭示速率函数 $\\lambda(t)$ 的一个更深层次的作用：在给定事件数量的情况下，它决定了事件发生时间的概率分布。", "problem": "一场强风暴给一个沿海地区造成了重大损失。一家保险公司使用非齐次泊松过程来模拟损失索赔的涌入。速率函数 $\\lambda(t)$ 表示每天预期到达的索赔数量，其模型由以下函数给出：\n$$ \\lambda(t) = C \\exp(-\\alpha t) $$\n其中 $t$ 是风暴结束后经过的时间，单位为天。根据类似事件的历史数据，该公司将模型参数设置为 $C = 50$ 索赔/天 和 $\\alpha = 0.1$ 天$^{-1}$。\n\n某个特定的案件档案被选中进行审计。已知的唯一信息是，该投保人在风暴结束后的头30天内恰好提出了一项索赔。计算该单项索赔是在头7天内提出的条件概率。\n\n将最终答案四舍五入到四位有效数字。", "solution": "对于一个速率为 $\\lambda(t)$ 的非齐次泊松过程，其均值函数为 $m(t)=\\int_{0}^{t}\\lambda(u)\\,du$，并且 $N(0,t)\\sim \\text{Poisson}(m(t))$。在区间 $[0,T]$ 上恰好发生一个事件的条件下，该事件发生时间的密度函数为 $f(t\\mid N(0,T)=1)=\\lambda(t)/m(T)$，定义在 $[0,T]$ 上。因此，对于 $0<s<T$，\n$$\n\\mathbb{P}(T_{1}\\le s\\mid N(0,T)=1)=\\frac{\\int_{0}^{s}\\lambda(t)\\,dt}{\\int_{0}^{T}\\lambda(t)\\,dt}\n$$\n当 $\\lambda(t)=C\\exp(-\\alpha t)$ 时，计算：\n$$\n\\int_{0}^{x}\\lambda(t)\\,dt=\\int_{0}^{x}C\\exp(-\\alpha t)\\,dt=\\frac{C}{\\alpha}\\left(1-\\exp(-\\alpha x)\\right)\n$$\n因此，\n$$\n\\mathbb{P}(T_{1}\\le 7\\mid N(0,30)=1)=\\frac{1-\\exp(-\\alpha\\cdot 7)}{1-\\exp(-\\alpha\\cdot 30)}\n$$\n代入 $\\alpha=0.1$ 得：\n$$\n\\frac{1-\\exp(-0.7)}{1-\\exp(-3)}\\approx \\frac{1-0.496585}{1-0.049787}\\approx \\frac{0.503415}{0.950213}\\approx 0.529791\\ldots\n$$\n四舍五入到四位有效数字，结果为 $0.5298$。", "answer": "$$\\boxed{0.5298}$$", "id": "1377436"}]}