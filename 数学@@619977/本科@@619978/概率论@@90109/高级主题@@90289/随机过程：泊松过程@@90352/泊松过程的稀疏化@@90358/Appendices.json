{"hands_on_practices": [{"introduction": "本练习旨在阐明泊松过程稀疏化最基本也是最重要的一个特性：分解后的过程是相互独立的。通过一个关于足球比赛进球的生动场景 [@problem_id:1407548]，我们将计算主队和客队各自的进球概率。这个练习将帮助你直观地理解，为何知道一个稀疏化过程的结果（例如主队进球数）并不会影响我们对另一个过程（客队进球数）的预测。", "problem": "在一个主要足球联赛中，分析表明进球服从一个泊松过程，其平均速率为每分钟 $\\lambda$ 个进球。对于任何一个给定的进球，由主队攻入的概率为 $p$，且与其他所有进球独立。考虑一场标准时长为 $T$ 分钟的比赛。在某场特定的比赛中，观测到主队恰好攻入了 $k$ 个球。那么，在该场比赛中，客队恰好攻入 $j$ 个球的概率是多少？\n\n请给出在 $\\lambda = 0.025$ 球/分钟，$p = 0.6$，$T = 90$ 分钟，$k=2$ 且 $j=2$ 的特定情况下的答案。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $N$ 为时间 $T$ 内的总进球数。由于进球服从速率为 $\\lambda$ 的泊松过程，我们有 $N \\sim \\text{Poisson}(\\lambda T)$。每个进球由主队攻入的概率为 $p$，由客队攻入的概率为 $1-p$，且与所有其他进球独立。\n\n根据泊松过程的分解性质，主队进球数 $N_{H}$ 和客队进球数 $N_{A}$ 是独立的泊松随机变量，其参数分别为\n$$\nN_{H} \\sim \\text{Poisson}(\\lambda p T), \\quad N_{A} \\sim \\text{Poisson}(\\lambda (1-p) T).\n$$\n因此，$N_{A}$ 独立于 $N_{H}$，所以\n$$\n\\mathbb{P}(N_{A}=j \\mid N_{H}=k) = \\mathbb{P}(N_{A}=j) = \\exp\\!\\big(-\\lambda(1-p)T\\big)\\,\\frac{\\big(\\lambda(1-p)T\\big)^{j}}{j!}.\n$$\n\n对于给定的值 $\\lambda=0.025$，$p=0.6$，$T=90$，$j=2$，$k=2$，计算客队的平均进球数\n$$\n\\mu_{A}=\\lambda(1-p)T=0.025 \\times 0.4 \\times 90=0.9.\n$$\n因此\n$$\n\\mathbb{P}(N_{A}=2 \\mid N_{H}=2)=\\exp(-0.9)\\,\\frac{0.9^{2}}{2!}.\n$$\n进行数值计算：\n$$\n0.9^{2}=0.81,\\quad \\frac{0.81}{2}=0.405,\\quad \\exp(-0.9)\\cdot 0.405 \\approx 0.164660712\\ldots\n$$\n四舍五入到四位有效数字，得到 $0.1647$。", "answer": "$$\\boxed{0.1647}$$", "id": "1407548"}, {"introduction": "除了计算事件数量，理解事件发生的时间点同样至关重要。本练习将我们的关注点从事件计数转移到事件之间的时间间隔 [@problem_id:1407550]。我们将分析数据中心中，两次关键错误之间的时间间隔的概率分布，这展示了稀疏化如何影响事件的到达间隔时间，并引出了重要的爱尔朗（Erlang）分布。", "problem": "在一个大型数据中心，一个服务器集群会生成错误消息。这些消息根据一个泊松过程到达一个中央日志系统，其恒定平均速率为每小时 $\\lambda$ 条消息。每条错误消息被独立地分类为“关键”的概率为 $p$，或“非关键”的概率为 $1-p$。关键消息的到达会触发自动警报。设 $T_1$ 是第一条关键消息的到达时间，$T_3$ 是第三条关键消息的到达时间，时间从初始观测点 $t=0$ 开始以小时为单位计量。求第一条和第三条关键消息之间的时间间隔大于指定时长 $\\tau$ 的概率的闭式解析表达式。", "solution": "根据泊松过程的稀疏化性质，将每条消息以概率 $p$ 独立地分类为关键消息，可以得出关键消息形成一个速率为 $\\mu=\\lambda p$ 的泊松过程。设此关键过程的到达间隔时间为 $\\{S_{i}\\}_{i\\geq 1}$，其中每个 $S_{i}$ 都是独立同分布的，且 $S_{i}\\sim \\text{Exp}(\\mu)$。到达时间满足 $T_{1}=S_{1}$，$T_{2}=S_{1}+S_{2}$ 和 $T_{3}=S_{1}+S_{2}+S_{3}$。因此，第一条和第三条关键消息之间的时间间隔为\n$$\nT_{3}-T_{1}=S_{2}+S_{3}.\n$$\n由于 $S_{2}$ 和 $S_{3}$ 是独立的 $\\text{Exp}(\\mu)$ 随机变量，$S:=S_{2}+S_{3}$ 服从形状参数为 $2$、速率为 $\\mu$ 的爱尔朗（伽马）分布。其概率密度函数为\n$$\nf_{S}(s)=\\mu^{2}s\\,\\exp(-\\mu s), \\quad s\\geq 0.\n$$\n我们需要计算对于 $\\tau\\geq 0$ 的 $P(T_{3}-T_{1}>\\tau)=P(S>\\tau)$。计算生存函数：\n$$\nP(S>\\tau)=\\int_{\\tau}^{\\infty}\\mu^{2}s\\,\\exp(-\\mu s)\\,ds.\n$$\n使用分部积分法计算该积分。令 $I=\\int_{\\tau}^{\\infty}s\\,\\exp(-\\mu s)\\,ds$。取 $u=s$ 且 $dv=\\exp(-\\mu s)\\,ds$，则 $du=ds$ 且 $v=-(1/\\mu)\\exp(-\\mu s)$。那么\n$$\nI=\\left[-\\frac{s}{\\mu}\\exp(-\\mu s)\\right]_{\\tau}^{\\infty}+\\int_{\\tau}^{\\infty}\\frac{1}{\\mu}\\exp(-\\mu s)\\,ds\n=\\frac{\\tau}{\\mu}\\exp(-\\mu \\tau)+\\frac{1}{\\mu^{2}}\\exp(-\\mu \\tau).\n$$\n因此，\n$$\nP(S>\\tau)=\\mu^{2}I=\\exp(-\\mu \\tau)\\left(1+\\mu \\tau\\right).\n$$\n将 $\\mu=\\lambda p$ 代入，得到所求的概率：\n$$\nP(T_{3}-T_{1}>\\tau)=\\exp(-\\lambda p\\,\\tau)\\left(1+\\lambda p\\,\\tau\\right).\n$$\n对于 $\\tau<0$，概率为 $1$，但上述表达式适用于 $\\tau\\geq 0$（这是时间间隔所关心的情况）。", "answer": "$$\\boxed{\\exp\\!\\left(-\\lambda p\\,\\tau\\right)\\left(1+\\lambda p\\,\\tau\\right)}$$", "id": "1407550"}, {"introduction": "在许多科学研究中，我们能观测到的往往是经过“稀疏化”之后的过程，即被探测到的粒子，而非其原始过程。最后一个练习将带我们进入统计推断的领域，展示如何利用观测到的事件数量来估计背后未知的原始过程速率 [@problem_id:1407560]。这个问题揭示了稀疏化模型在粒子物理和天体物理学等领域中，估算未知物理参数的强大能力。", "problem": "一个天体物理学家团队正在一个深层地下实验室进行一项实验，旨在探测一种被称为弱相互作用大质量粒子（WIMP）的假想粒子，该粒子是宇宙暗物质的一种候选者。\n\n理论模型预测，WIMP粒子以一个恒定但未知的平均速率$\\lambda$（单位时间内粒子数）遵循泊松过程穿过探测器所在的位置。\n\n探测器本身并非完美高效。当一个WIMP粒子穿过探测器时，它有恒定且已知的概率$p$会发生相互作用并产生一个可探测的信号。每个WIMP的探测都是一个独立事件。如果一个WIMP粒子没有发生相互作用，它就会在未被探测到的情况下穿过。\n\n在持续时间为$T$的连续观测期内，实验共记录到$n$个相互作用事件。根据这单次的实验结果，确定真实WIMP到达速率$\\lambda$的最可能值。将你的答案表示为关于观测计数$n$、观测时间$T$和探测概率$p$的公式。", "solution": "WIMP的到达过程被建模为速率为$\\lambda$的泊松过程。每个到达的WIMP以概率$p$被独立地探测到。根据泊松过程的减薄性质，被探测到的事件构成一个速率为$p \\lambda$的泊松过程。因此，在观测时间$T$内，总探测计数$N$服从均值为$p \\lambda T$的泊松分布：\n$$\nN \\sim \\text{Poisson}(p \\lambda T).\n$$\n给定观测到的计数为$n$，关于$\\lambda$的似然函数为\n$$\nL(\\lambda \\mid n) = \\mathbb{P}(N=n \\mid \\lambda) = \\frac{\\exp(-p \\lambda T)\\,(p \\lambda T)^{n}}{n!}.\n$$\n对数似然函数为\n$$\n\\ell(\\lambda) = \\ln L(\\lambda \\mid n) = -p \\lambda T + n \\ln(p \\lambda T) - \\ln(n!) = -p \\lambda T + n \\ln \\lambda + n \\ln p + n \\ln T - \\ln(n!).\n$$\n对$\\lambda$求导并令导数等于零，得到得分方程\n$$\n\\frac{d\\ell}{d\\lambda} = -p T + \\frac{n}{\\lambda} = 0 \\quad \\Longrightarrow \\quad \\hat{\\lambda} = \\frac{n}{p T}.\n$$\n为验证这是一个最大值，计算二阶导数：\n$$\n\\frac{d^{2}\\ell}{d\\lambda^{2}} = -\\frac{n}{\\lambda^{2}} \\le 0 \\quad \\text{for } \\lambda > 0,\n$$\n因此，该解确实是最大值点。当$n=0$时，对数似然函数是关于$\\lambda$的严格递减函数，在$\\lambda \\ge 0$上的最大值出现在$\\lambda=0$处，这与$\\hat{\\lambda} = \\frac{n}{p T}$的结果一致。\n\n因此，真实WIMP到达速率的最大似然估计量为$\\hat{\\lambda} = \\frac{n}{p T}$。", "answer": "$$\\boxed{\\frac{n}{p T}}$$", "id": "1407560"}]}