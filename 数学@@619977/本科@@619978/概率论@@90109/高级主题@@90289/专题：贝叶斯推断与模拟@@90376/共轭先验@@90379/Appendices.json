{"hands_on_practices": [{"introduction": "让我们通过一个经典的贝叶斯推断场景来开始我们的实践：更新我们对一个未知概率的信念。这个练习模拟了一个常见的商业问题——评估A/B测试中的点击率。我们将使用Beta分布来表示我们对概率$p$的先验信念，并展示当观察到二项分布的数据（例如，点击次数）时，共轭性如何使后验分布的计算变得异常简单和直观。[@problem_id:1909036]", "problem": "一家电子商务公司正在进行 A/B 测试，以评估其“添加到购物车”按钮的新设计。关键指标是点击率，即看到按钮的用户会点击它的概率 $p$。\n\n在进行实验之前，产品管理团队使用参数为 $\\alpha = 2$ 和 $\\beta = 18$ 的贝塔分布来量化他们对 $p$ 的先验信念。\n\n随后，该公司进行了一项实验，将新按钮设计展示给 $n=100$ 名随机选择的用户。在这些用户中，观察到有 $k=15$ 人点击了该按钮。\n\n假设点击次数服从二项分布，并使用团队的贝塔先验，关于 $p$ 的更新信念由一个后验分布来描述。这个后验分布也是一个贝塔分布，其新参数我们称之为 $\\alpha_{post}$ 和 $\\beta_{post}$。\n\n以下哪项代表了正确的后验超参数对 $(\\alpha_{post}, \\beta_{post})$？\n\nA. $(17, 103)$\n\nB. $(87, 33)$\n\nC. $(16, 86)$\n\nD. $(17, 85)$\n\nE. $(2, 18)$", "solution": "这个问题要求我们通过将贝塔先验与二项似然相结合，来求出概率 $p$ 的后验分布的参数。这是一个使用共轭先验进行贝叶斯推断的经典例子。\n\n其核心原理是贝叶斯定理，该定理指出，后验分布与数据的似然和参数的先验分布的乘积成正比。\n$$\n\\text{Posterior} \\propto \\text{Likelihood} \\times \\text{Prior}\n$$\n\n让我们为我们的具体问题定义各个组成部分。\n\n首先，概率 $p$ 的 **先验分布** 是一个贝塔分布，即 $p \\sim \\text{Beta}(\\alpha, \\beta)$。贝塔分布的概率密度函数 (PDF) 为：\n$$\nf(p; \\alpha, \\beta) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} p^{\\alpha-1} (1-p)^{\\beta-1}\n$$\n在我们的分析中，我们只需要分布的核，它包含函数中依赖于参数 $p$ 的部分。贝塔先验的核为：\n$$\nf(p; \\alpha, \\beta) \\propto p^{\\alpha-1} (1-p)^{\\beta-1}\n$$\n我们已知的先验超参数为 $\\alpha = 2$ 和 $\\beta = 18$。\n\n其次，**似然函数** 来自于实验数据。数据包括在 $n$ 次独立试验（用户）中观察到 $k$ 次成功（点击）。这可以用二项分布来建模，即 $k \\sim \\text{Binomial}(n, p)$。二项分布的概率质量函数给了我们对于给定的 $p$ 观察到 $k$ 次成功的似然：\n$$\nL(p | k, n) = \\binom{n}{k} p^k (1-p)^{n-k}\n$$\n同样，我们只关心依赖于 $p$ 的部分，所以似然的核是：\n$$\nL(p | k, n) \\propto p^k (1-p)^{n-k}\n$$\n我们已知的实验数据为 $n = 100$ 和 $k = 15$。\n\n现在，我们应用贝叶斯定理来求后验分布 $p(p | k, n, \\alpha, \\beta)$：\n$$\np(p | \\text{data}) \\propto L(p | \\text{data}) \\times f(p)\n$$\n代入似然和先验的核：\n$$\np(p | k, n, \\alpha, \\beta) \\propto \\left( p^k (1-p)^{n-k} \\right) \\times \\left( p^{\\alpha-1} (1-p)^{\\beta-1} \\right)\n$$\n我们可以通过将指数相加来合并这些项：\n$$\np(p | k, n, \\alpha, \\beta) \\propto p^{k + \\alpha - 1} (1-p)^{n - k + \\beta - 1}\n$$\n这个结果的函数形式是另一个贝塔分布的核。一个参数为 $\\alpha_{post}$ 和 $\\beta_{post}$ 的通用贝塔分布，其核与 $p^{\\alpha_{post}-1} (1-p)^{\\beta_{post}-1}$ 成正比。\n\n通过将我们推导出的后验核与通用的贝塔核进行比较，我们可以确定后验超参数：\n$$\n\\alpha_{post} - 1 = k + \\alpha - 1 \\implies \\alpha_{post} = k + \\alpha\n$$\n$$\n\\beta_{post} - 1 = n - k + \\beta - 1 \\implies \\beta_{post} = n - k + \\beta\n$$\n这些是贝塔-二项共轭对的一般更新规则。\n\n最后，我们代入问题中给出的数值：\n- 先验超参数：$\\alpha = 2$, $\\beta = 18$\n- 数据：$n = 100$, $k = 15$\n\n后验超参数 $\\alpha_{post}$ 是：\n$$\n\\alpha_{post} = 15 + 2 = 17\n$$\n后验超参数 $\\beta_{post}$ 是：\n$$\n\\beta_{post} = (100 - 15) + 18 = 85 + 18 = 103\n$$\n因此，后验分布是一个参数为 $\\alpha_{post} = 17$ 和 $\\beta_{post} = 103$ 的贝塔分布。这对后验超参数是 $(17, 103)$。\n\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1909036"}, {"introduction": "在掌握了如何为概率参数进行贝叶斯更新后，我们现在将注意力转向另一个重要领域：对事件发生率的建模。这个练习探讨了泊松过程中未知平均速率$\\lambda$的推断，例如每小时收到的电子邮件数量。我们将看到伽马分布作为泊松似然的共轭先验，并学习如何结合观测数据来更新我们对$\\lambda$的估计。[@problem_id:1909064]", "problem": "一位数据科学家正在对一名公司员工接收邮件的速率进行建模。邮件的到达被假定遵循泊松过程。未知的平均邮件到达率 $\\lambda$ 以每小时邮件数（emails per hour）为单位进行度量。\n\n该数据科学家对 $\\lambda$ 的先验信念通过一个形状参数为 $\\alpha = 10$、速率参数为 $\\beta = 2$ 的伽马分布（Gamma distribution）进行建模。此 Gamma($\\alpha, \\beta$) 分布的概率密度函数由下式给出：\n$$p(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\quad \\text{for } \\lambda > 0$$\n\n为了更新此信念，该数据科学家在 $T = 8$ 小时的时间段内观察了该员工。在此观察期间，该员工总共收到了 $n = 52$ 封邮件。\n\n假设在 $T$ 小时内收到的邮件数量遵循参数为 $\\lambda T$ 的泊松分布（Poisson distribution），请计算平均每小时邮件到达率的更新估计值，即 $\\lambda$ 的后验分布（posterior distribution）的均值。将您的答案以每小时邮件数为单位表示，并四舍五入到三位有效数字。", "solution": "问题要求计算邮件到达率 $\\lambda$ 的后验分布的均值。我们可以使用贝叶斯定理来找到后验分布，该定理指出后验分布正比于数据似然与参数先验分布的乘积。\n\n设观测数据为 $D$，即在 $T=8$ 小时内观测到 $n=52$ 封邮件。根据贝叶斯定理：\n$$p(\\lambda | D) \\propto P(D | \\lambda) \\times p(\\lambda)$$\n在这里，$p(\\lambda | D)$ 是后验分布，$P(D | \\lambda)$ 是似然函数，$p(\\lambda)$ 是先验分布。\n\n首先，我们定义似然函数。在时间间隔 $T$ 内的邮件数量 $n$ 被假定遵循参数为 $\\lambda T$ 的泊松分布。泊松分布的概率质量函数为 $P(k; \\mu) = \\frac{\\mu^k e^{-\\mu}}{k!}$。因此，在 $T=8$ 小时内观测到 $n=52$ 封邮件的似然函数为：\n$$L(\\lambda; n, T) = P(n | \\lambda, T) = \\frac{(T\\lambda)^n}{n!} \\exp(-T\\lambda)$$\n\n接下来，我们定义先验分布。$\\lambda$ 的先验分布被给定为形状参数为 $\\alpha=10$ 且速率参数为 $\\beta=2$ 的伽马分布：\n$$p(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda)$$\n\n现在，我们通过将似然函数与先验分布相乘来计算后验分布。我们可以忽略任何不依赖于 $\\lambda$ 的常数因子，因为它们将被吸收到后验分布的归一化常数中。\n$$p(\\lambda | n, T) \\propto \\left( \\frac{(T\\lambda)^n}{n!} \\exp(-T\\lambda) \\right) \\times \\left( \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\right)$$\n去掉常数 $\\frac{T^n}{n!}$ 和 $\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}$：\n$$p(\\lambda | n, T) \\propto (\\lambda^n \\exp(-T\\lambda)) \\times (\\lambda^{\\alpha-1} \\exp(-\\beta \\lambda))$$\n合并包含 $\\lambda$ 的项：\n$$p(\\lambda | n, T) \\propto \\lambda^n \\lambda^{\\alpha-1} \\exp(-T\\lambda) \\exp(-\\beta \\lambda)$$\n$$p(\\lambda | n, T) \\propto \\lambda^{n+\\alpha-1} \\exp(-(T+\\beta)\\lambda)$$\n\n所得的函数形式是伽马分布的核。这意味着后验分布也是一个伽马分布。一个形如 $f(x) \\propto x^{a-1} \\exp(-bx)$ 的分布是一个形状参数为 $a$、速率参数为 $b$ 的伽马分布。通过比较指数，我们可以确定后验分布的参数，我们称之为 $\\alpha'$ 和 $\\beta'$：\n形状参数：$\\alpha' = n + \\alpha$\n速率参数：$\\beta' = T + \\beta$\n\n现在，我们代入给定的数值：\n$\\alpha = 10$\n$\\beta = 2$\n$n = 52$\n$T = 8$\n\n后验伽马分布的参数为：\n$\\alpha' = 52 + 10 = 62$\n$\\beta' = 8 + 2 = 10$\n\n因此，$\\lambda$ 的后验分布是一个形状参数为 $\\alpha' = 62$、速率参数为 $\\beta' = 10$ 的伽马分布。\n$$\\lambda | n, T \\sim \\text{Gamma}(62, 10)$$\n\n问题要求计算这个后验分布的均值。形状参数为 $a$、速率参数为 $b$ 的伽马分布的均值由公式 $E[\\lambda] = \\frac{a}{b}$ 给出。\n因此，$\\lambda$ 的后验均值为：\n$$E[\\lambda | n, T] = \\frac{\\alpha'}{\\beta'} = \\frac{62}{10} = 6.2$$\n\n问题要求答案四舍五入到三位有效数字。计算出的值为6.2，表示为三位有效数字是6.20。单位是按要求表示的每小时邮件数。", "answer": "$$\\boxed{6.20}$$", "id": "1909064"}, {"introduction": "前面的练习处理的是离散的计数数据，现在我们转向连续测量值的世界。本练习将探讨如何更新我们对于一个正态分布总体均值的信念，这是一个在科学和工程领域无处不在的场景。通过这个例子，我们将发现一个深刻的结论：后验均值是先验均值和样本均值的一个加权平均，其权重由各自的精度（方差的倒数）决定。[@problem_id:1352230]", "problem": "一位材料科学家正在研究一种新合成的超导合金的性质。所关注的关键参数是真实平均临界温度，记为 $T_c$，在该温度下材料会转变为超导状态。\n\n根据理论模型和类似合金的性质，该科学家对 $T_c$ 的初始信念可以用一个均值为 $\\mu_0$、方差为 $\\sigma_0^2$ 的正态分布来描述。\n\n为了改进这一估计，该科学家进行了一项实验，准备了该合金的 $N$ 个相同样本，并测量了它们各自的临界温度。测量过程会受到实验噪声的影响。已知任何单次测量都是一个随机变量，它服从一个正态分布，其均值为真实平均临界温度 $T_c$，方差为 $\\sigma^2$。进行实验后，计算出这 $N$ 次测量的样本均值为 $\\bar{T}$。\n\n你的任务是通过结合初始信念和新的实验数据，确定科学家对平均临界温度的更新估计。请用 $\\mu_0, \\sigma_0, N, \\sigma$ 和 $\\bar{T}$ 的符号表达式来表示你的答案。", "solution": "我们将真实平均临界温度建模为一个随机变量，其先验分布为 $T_{c} \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$。实验产生了 $N$ 个独立同分布（i.i.d.）的测量值，噪声方差为 $\\sigma^{2}$，因此样本均值满足 $\\bar{T} \\mid T_{c} \\sim \\mathcal{N}(T_{c},\\sigma^{2}/N)$。\n\n使用贝叶斯法则和充分统计量 $\\bar{T}$，后验密度与先验和似然的乘积成正比：\n$$\np(T_{c}\\mid \\bar{T}) \\propto \\exp\\!\\left(-\\frac{(T_{c}-\\mu_{0})^{2}}{2\\sigma_{0}^{2}}\\right)\\,\\exp\\!\\left(-\\frac{(\\bar{T}-T_{c})^{2}}{2(\\sigma^{2}/N)}\\right)\n= \\exp\\!\\left(-\\frac{(T_{c}-\\mu_{0})^{2}}{2\\sigma_{0}^{2}}-\\frac{N(T_{c}-\\bar{T})^{2}}{2\\sigma^{2}}\\right).\n$$\n合并关于 $T_{c}$ 的项，我们得到一个二次型：\n$$\n-\\frac{1}{2}\\left(\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{N}{\\sigma^{2}}\\right)T_{c}^{2}\n-2\\left(\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{N\\bar{T}}{\\sigma^{2}}\\right)T_{c}\\right)+\\text{常数}.\n$$\n通过配方法可知，后验分布是正态分布，其精度为\n$$\n\\tau_{n}=\\frac{1}{\\sigma_{0}^{2}}+\\frac{N}{\\sigma^{2}}\n$$\n均值为\n$$\n\\mu_{n}=\\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{N\\bar{T}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{N}{\\sigma^{2}}}.\n$$\n因此，真实平均临界温度的更新估计（后验均值）为\n$$\n\\mu_{n}=\\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{N\\bar{T}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{N}{\\sigma^{2}}}.\n$$\n等价地，它是精度加权平均值 $\\mu_{n}=\\left(\\sigma^{2}\\mu_{0}+N\\sigma_{0}^{2}\\bar{T}\\right)\\big/\\left(\\sigma^{2}+N\\sigma_{0}^{2}\\right)$。", "answer": "$$\\boxed{\\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{N\\bar{T}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{N}{\\sigma^{2}}}}$$", "id": "1352230"}]}