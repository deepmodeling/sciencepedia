{"hands_on_practices": [{"introduction": "这个练习是逆变换法的最直接应用，是后续更复杂问题的重要基础。当你已经知道一个随机变量的累积分布函数（CDF）并且它很容易求逆时，你就可以直接通过代数运算找到所需的变换函数。通过这个练习，你将掌握从CDF $F(x)$ 出发，通过求解方程 $F(X)=U$ 来得到生成器 $X=F^{-1}(U)$ 的核心步骤 [@problem_id:1387343]。", "problem": "在一个旨在模拟特定聚合物降解的仿真中，已断裂的聚合物链的分数长度 $X$ 被建模为一个连续随机变量。随机变量 $X$ 可以在区间 $[0, 1]$ 内取值。其行为由累积分布函数 (CDF) $F(x) = x^5$（其中 $x \\in [0, 1]$）描述。\n\n为了给该模拟生成 $X$ 的随机样本，一个常用的技术是变换一个在区间 $[0, 1]$ 上均匀分布的随机变量 $U$。\n\n确定函数 $g(U)$，使得随机变量 $X = g(U)$ 服从由 CDF $F(x)$ 给出的分布。\n\n从以下选项中选择正确的函数。\n\nA. $g(U) = U^{1/5}$\n\nB. $g(U) = U^5$\n\nC. $g(U) = 5U^4$\n\nD. $g(U) = 1 - U^{1/5}$\n\nE. $g(U) = \\frac{1}{5} U$", "solution": "该问题要求我们找到一个变换 $g(U)$，它能将一个标准均匀随机变量 $U \\sim \\text{Uniform}(0,1)$ 转换为一个具有指定累积分布函数 (CDF) $F(x) = x^5$（其中 $x \\in [0,1]$）的随机变量 $X$。\n\n这项任务是逆变换采样法的直接应用。该方法指出，如果一个随机变量 $X$ 具有一个连续且严格递增的CDF，记为 $F_X(x)$，那么随机变量 $Y = F_X^{-1}(U)$（其中 $U \\sim \\text{Uniform}(0,1)$）与 $X$ 具有相同的分布。这里，$F_X^{-1}$ 是CDF的反函数，也称为分位数函数。\n\n我们的目标是找到函数 $g(U) = F^{-1}(U)$。\n\n首先，我们写下由逆变换法给出的关系。我们将CDF设为等于来自均匀分布的一个值 $u$：\n$$F(x) = u$$\n\n给定的CDF是 $F(x) = x^5$。将此代入方程，我们得到：\n$$x^5 = u$$\n\n现在，我们需要求解 $x$ 关于 $u$ 的表达式。这将给出反函数 $x = F^{-1}(u)$。我们可以通过对等式两边取五次方根来实现：\n$$(x^5)^{1/5} = u^{1/5}$$\n$$x = u^{1/5}$$\n\n由于 $X$ 的定义域是 $x \\in [0,1]$ 且 $U$ 的定义域是 $u \\in [0,1]$，因此主（正实数）根是正确的。\n\n因此，从一个均匀随机变量 $U$ 生成具有所需分布的随机变量 $X$ 的变换是：\n$$X = g(U) = U^{1/5}$$\n\n现在我们将此结果与给定的多项选择选项进行比较：\nA. $g(U) = U^{1/5}$\nB. $g(U) = U^5$\nC. $g(U) = 5U^4$（这是概率密度函数，$f(x) = \\frac{dF(x)}{dx}$）\nD. $g(U) = 1 - U^{1/5}$\nE. $g(U) = \\frac{1}{5} U$\n\n我们推导出的函数 $g(U) = U^{1/5}$ 与选项A匹配。", "answer": "$$\\boxed{A}$$", "id": "1387343"}, {"introduction": "在许多实际应用中，我们通常更容易获得概率密度函数（PDF）而非累积分布函数（CDF）。这个练习比上一个增加了一个关键步骤：在应用逆变换法之前，你必须先从给定的PDF通过积分求出其对应的CDF。这个过程不仅能加深你对PDF和CDF关系的理解，也是解决更广泛模拟问题的必备技能 [@problem_id:1387345]。", "problem": "在一个简化的网络流量分析模型中，一个数据包的大小 $X$（以某个任意数据单位计量）被视为一个连续随机变量。研究发现 $X$ 的概率分布遵循一个模型，其概率密度函数 (PDF) 为 $f(x) = cx^{-3}$ (当 $x \\ge 1$ 时)，其他情况下 $f(x) = 0$。这里，$c$ 是一个归一化常数。为了模拟该系统，需要基于一个在区间 $(0, 1)$ 上均匀分布的标准均匀随机变量 $U$ 来生成 $X$ 的随机值。请确定用 $U$ 表示随机变量 $X$ 的表达式，该表达式能正确地模拟此数据包大小分布。", "solution": "我们给定一个连续随机变量 $X$，其概率密度函数为 $f(x) = c x^{-3}$ (当 $x \\ge 1$ 时)，其他情况下 $f(x) = 0$。首先，通过施加总概率为 $1$ 的条件来确定归一化常数 $c$：\n$$\n\\int_{-\\infty}^{\\infty} f(x)\\,dx = \\int_{1}^{\\infty} c x^{-3}\\,dx = 1.\n$$\n计算该积分：\n$$\n\\int_{1}^{\\infty} x^{-3}\\,dx = \\left[ \\frac{x^{-2}}{-2} \\right]_{1}^{\\infty} = 0 - \\left( -\\frac{1}{2} \\right) = \\frac{1}{2}.\n$$\n因此，\n$$\nc \\cdot \\frac{1}{2} = 1 \\quad \\Rightarrow \\quad c = 2.\n$$\n所以，概率密度函数为 $f(x) = 2 x^{-3}$ (当 $x \\ge 1$ 时)。接下来，计算当 $x \\ge 1$ 时的累积分布函数 $F(x)$：\n$$\nF(x) = \\int_{1}^{x} 2 t^{-3}\\,dt = 2 \\left[ \\frac{t^{-2}}{-2} \\right]_{1}^{x} = \\left[ -t^{-2} \\right]_{1}^{x} = 1 - \\frac{1}{x^{2}}.\n$$\n当 $x  1$ 时，我们有 $F(x) = 0$。为了使用逆变换法从一个在 $(0,1)$ 上的标准均匀随机变量 $U$ 生成 $X$，我们令\n$$\nU = F(X) = 1 - \\frac{1}{X^{2}}\n$$\n然后解出 $X$：\n$$\n\\frac{1}{X^{2}} = 1 - U \\quad \\Rightarrow \\quad X^{2} = \\frac{1}{1 - U} \\quad \\Rightarrow \\quad X = (1 - U)^{-1/2}.\n$$\n由于 $X \\ge 1$ 且 $U \\in (0,1)$，取正根是合适的。因此，所需的变换为 $X = (1 - U)^{-1/2}$。", "answer": "$$\\boxed{(1-U)^{-1/2}}$$", "id": "1387345"}, {"introduction": "现实世界中的概率模型常常比简单的单调函数更复杂，分段函数就是一个常见的例子。本练习将挑战你为一个对称的三角分布构建模拟器，其PDF在不同区间上有不同的定义。你需要分段计算CDF并求逆，这展示了逆变换法在处理复杂分布时的灵活性和强大功能，是掌握高级模拟技术的重要一步 [@problem_id:1387399]。", "problem": "在计算统计学中，从指定的概率分布中生成随机数是一项基本任务。一种常用方法涉及将一个在区间 $[0, 1]$ 上均匀分布的随机变量 $U$ 变换为一个服从期望分布的新随机变量 $X$。\n\n考虑一个随机变量 $X$，它在区间 $[-c, c]$ 上具有对称三角形概率密度函数 (PDF)，其中 $c$ 是一个正常数。该 PDF 记为 $f(x)$，由下式给出：\n$$\nf(x) = \\begin{cases}\n\\frac{1}{c^2}(x+c)  \\text{for } -c \\le x  0 \\\\\n\\frac{1}{c^2}(c-x)  \\text{for } 0 \\le x \\le c \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n你的任务是找到变换函数 $X = g(U)$，该函数能从一个服从 $[0, 1]$ 上标准均匀分布的随机变量 $U$ 生成一个具有此三角形分布的随机变量 $X$。将你的答案表示为关于 $U$ 的分段函数。", "solution": "我们使用逆变换法：如果 $U \\sim \\text{Unif}(0,1)$ 且 $F$ 是 $X$ 的累积分布函数 (CDF)，那么 $X=F^{-1}(U)$ 就具有期望的分布。\n\n首先，从给定的 PDF 计算 CDF $F(x)$。对于 $-c \\le x  0$，\n$$\nF(x)=\\int_{-c}^{x} \\frac{1}{c^{2}}(t+c)\\,dt=\\frac{1}{c^{2}}\\left(\\frac{1}{2}x^{2}+c x+\\frac{1}{2}c^{2}\\right).\n$$\n这满足 $F(-c)=0$ 和 $F(0)=\\frac{1}{2}$。\n\n对于 $0 \\le x \\le c$，\n$$\nF(x)=F(0)+\\int_{0}^{x} \\frac{1}{c^{2}}(c-t)\\,dt=\\frac{1}{2}+\\frac{1}{c^{2}}\\left(c x-\\frac{1}{2}x^{2}\\right),\n$$\n得到 $F(c)=1$。\n\n为了求逆函数，设 $U=F(x)$ 并在每个分支上求解 $x$。\n\n对于 $U \\in [0,\\frac{1}{2}]$ (对应于 $x \\in [-c,0]$)，\n$$\nU=\\frac{1}{c^{2}}\\left(\\frac{1}{2}x^{2}+c x+\\frac{1}{2}c^{2}\\right)\n\\;\\Rightarrow\\;\nx^{2}+2 c x+c^{2}-2 c^{2}U=0\n\\;\\Rightarrow\\;\n(x+c)^{2}=2 c^{2}U,\n$$\n因此，由 $x \\in [-c,0]$ 可知 $x+c \\ge 0$，我们取正根：\n$$\nx=c\\left(\\sqrt{2U}-1\\right).\n$$\n\n对于 $U \\in [\\frac{1}{2},1]$ (对应于 $x \\in [0,c]$)，\n$$\nU=\\frac{1}{2}+\\frac{1}{c^{2}}\\left(c x-\\frac{1}{2}x^{2}\\right)\n\\;\\Rightarrow\\;\nx^{2}-2 c x+2 c^{2}\\left(U-\\frac{1}{2}\\right)=0\n\\;\\Rightarrow\\;\n(x-c)^{2}=2 c^{2}(1-U),\n$$\n因此，由 $x \\in [0,c]$ 可知 $x-c \\le 0$，我们取负根：\n$$\nx=c\\left(1-\\sqrt{2(1-U)}\\right).\n$$\n\n因此，变换 $X=g(U)$ 是以下关于 $U$ 的分段函数：\n$$\ng(U)=\n\\begin{cases}\nc\\left(\\sqrt{2U}-1\\right)  \\text{for } 0 \\leq U \\leq \\frac{1}{2}, \\\\\nc\\left(1-\\sqrt{2(1-U)}\\right)  \\text{for } \\frac{1}{2}  U \\leq 1.\n\\end{cases}\n$$", "answer": "$$\\boxed{\n\\begin{cases}\nc\\left(\\sqrt{2U}-1\\right)  \\text{for } 0 \\leq U \\leq \\frac{1}{2}, \\\\\nc\\left(1-\\sqrt{2(1-U)}\\right)  \\text{for } \\frac{1}{2}  U \\leq 1\n\\end{cases}\n}$$", "id": "1387399"}]}