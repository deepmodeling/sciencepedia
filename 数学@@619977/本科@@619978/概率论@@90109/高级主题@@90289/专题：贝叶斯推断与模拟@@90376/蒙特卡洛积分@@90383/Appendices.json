{"hands_on_practices": [{"introduction": "本次练习通过一个与机器人技术相关的场景，为您提供了一个体验蒙特卡洛方法的直观入口。您将应用基本的“击中或错过”技巧，通过简单地对一个给定的小数据集中的成功案例进行计数来估计概率。这项实践旨在建立您的直觉，理解如何使用随机抽样来近似那些可能难以通过解析方式计算的量 [@problem_id:1376841]。", "problem": "一位机器人工程师正在测试一种新的导航算法。一个机器人在二维平面中的最终位置误差由两个独立的随机变量 $X$ 和 $Y$ 建模，它们分别表示在两个相互垂直的坐标轴上的误差。$X$ 和 $Y$ 均服从标准正态分布，其概率密度函数 (PDF) 为 $f(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)$，其中 $-\\infty  z  \\infty$。如果机器人的最终位置误差位于以原点为中心的单位圆内，即满足条件 $X^2 + Y^2  1$，则该机器人的测试被视为成功。\n\n为了估计测试成功的概率，该工程师进行了一次模拟，并为配对 $(X, Y)$ 生成了一小组随机样本。生成了以下十对数值：\n(0.52, -0.31), (-1.21, 0.44), (0.87, 0.73), (-0.05, 0.55), (1.57, -0.62),\n(-0.48, 0.19), (0.91, -0.25), (-1.10, -0.89), (0.33, 0.15), (0.60, -0.95)。\n\n使用这组十个模拟数据点，估计测试成功的概率。将您的答案表示为保留三位有效数字的小数。", "solution": "我们被要求使用给定的大小为 $n=10$ 的样本来估计成功的概率。定义成功事件 $S$ 为 $p=\\mathbb{P}(S)$，其中试验成功条件为 $X^2+Y^21$。基于样本 $\\{ (X_i, Y_i) \\}_{i=1}^n$ 的蒙特卡洛估计量为\n$$\n\\hat{p}=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{1}\\{X_{i}^{2}+Y_{i}^{2}1\\}.\n$$\n我们对每一对数值计算 $X_{i}^{2}+Y_{i}^{2}$ 并与 $1$ 进行比较：\n- $(0.52,-0.31)$: $0.52^{2}+(-0.31)^{2}=0.2704+0.0961=0.3665  1$ (成功)。\n- $(-1.21,0.44)$: $(-1.21)^{2}+0.44^{2}=1.4641+0.1936=1.6577 > 1$ (失败)。\n- $(0.87,0.73)$: $0.87^{2}+0.73^{2}=0.7569+0.5329=1.2898 > 1$ (失败)。\n- $(-0.05,0.55)$: $(-0.05)^{2}+0.55^{2}=0.0025+0.3025=0.3050  1$ (成功)。\n- $(1.57,-0.62)$: $1.57^{2}+(-0.62)^{2}=2.4649+0.3844=2.8493 > 1$ (失败)。\n- $(-0.48,0.19)$: $(-0.48)^{2}+0.19^{2}=0.2304+0.0361=0.2665  1$ (成功)。\n- $(0.91,-0.25)$: $0.91^{2}+(-0.25)^{2}=0.8281+0.0625=0.8906  1$ (成功)。\n- $(-1.10,-0.89)$: $(-1.10)^{2}+(-0.89)^{2}=1.2100+0.7921=2.0021 > 1$ (失败)。\n- $(0.33,0.15)$: $0.33^{2}+0.15^{2}=0.1089+0.0225=0.1314  1$ (成功)。\n- $(0.60,-0.95)$: $0.60^{2}+(-0.95)^{2}=0.3600+0.9025=1.2625 > 1$ (失败)。\n\n在 $n=10$ 次试验中，有 $k=5$ 次成功，所以\n$$\n\\hat{p}=\\frac{k}{n}=\\frac{5}{10}=0.5.\n$$\n保留三位有效数字，结果为 $0.500$。", "answer": "$$\\boxed{0.500}$$", "id": "1376841"}, {"introduction": "在学习了基本机制之后，理解影响蒙特卡洛估计准确性的因素至关重要。本题要求您分析并比较两种不同被积函数的蒙特卡洛估计量的方差，从而揭示被积函数的形式如何影响估计的精度。理解这种关系是迈向开发更高效、更高级蒙特卡洛策略的第一步 [@problem_id:2188171]。", "problem": "在数值分析中，简单蒙特卡洛方法可用于近似计算定积分 $I = \\int_0^1 f(x) \\,dx$。该积分的估计量，记作 $\\hat{I}_N$，是通过从区间 $[0, 1]$ 上的均匀分布中抽取 $N$ 个独立的随机样本 $X_1, X_2, \\dots, X_N$，然后计算函数 $f$ 在这些点上的取值的样本均值来构造的：\n$$\n\\hat{I}_N = \\frac{1}{N} \\sum_{i=1}^N f(X_i)\n$$\n这个估计量的准确度通常通过其方差 $\\text{Var}(\\hat{I}_N)$ 来评估。\n\n考虑两个不同的积分：\n1. $I_A = \\int_0^1 x^8 \\,dx$\n2. $I_B = \\int_0^1 x^2 \\,dx$\n\n设 $\\hat{I}_{A,N}$ 和 $\\hat{I}_{B,N}$ 分别为 $I_A$ 和 $I_B$ 的简单蒙特卡洛估计量，两者都使用相同数量的样本 $N$ 构建。\n\n计算这两个估计量方差的比值 $\\frac{\\text{Var}(\\hat{I}_{A,N})}{\\text{Var}(\\hat{I}_{B,N})}$ 的精确值。将你的答案表示为一个最简精确分数。", "solution": "问题要求计算两个蒙特卡洛估计量方差的比值 $\\frac{\\text{Var}(\\hat{I}_{A,N})}{\\text{Var}(\\hat{I}_{B,N})}$。\n\n我们首先建立简单蒙特卡洛估计量 $\\hat{I}_N = \\frac{1}{N} \\sum_{i=1}^N f(X_i)$ 的方差的一般公式，其中 $X_i$ 是独立同分布 (i.i.d.) 的随机变量。\n$$\n\\text{Var}(\\hat{I}_N) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^N f(X_i)\\right)\n$$\n利用方差的性质，由于样本是独立的：\n$$\n\\text{Var}(\\hat{I}_N) = \\frac{1}{N^2} \\sum_{i=1}^N \\text{Var}(f(X_i)) = \\frac{1}{N^2} \\cdot N \\cdot \\text{Var}(f(X)) = \\frac{1}{N} \\text{Var}(f(X))\n$$\n这里，$X$ 是一个与每个 $X_i$ 具有相同分布的单个随机变量。在本问题中，$X$ 在 $[0, 1]$ 上服从均匀分布，记作 $X \\sim U(0,1)$。\n\n随机变量 $f(X)$ 的方差由公式 $\\text{Var}(f(X)) = E[(f(X))^2] - (E[f(X)])^2$ 给出。\n对于一个随机变量 $X \\sim U(0,1)$，任意函数 $g(X)$ 的期望是 $E[g(X)] = \\int_0^1 g(x) \\,dx$。\n因此，我们有：\n$E[f(X)] = \\int_0^1 f(x) \\,dx$\n$E[(f(X))^2] = \\int_0^1 (f(x))^2 \\,dx$\n将这些代入方差公式：\n$$\n\\text{Var}(f(X)) = \\int_0^1 (f(x))^2 \\,dx - \\left(\\int_0^1 f(x) \\,dx\\right)^2\n$$\n所以，该估计量的方差为：\n$$\n\\text{Var}(\\hat{I}_N) = \\frac{1}{N} \\left[ \\int_0^1 (f(x))^2 \\,dx - \\left(\\int_0^1 f(x) \\,dx\\right)^2 \\right]\n$$\n现在，我们将此公式应用于我们的两种情况。\n\n情况 A：$f_A(x) = x^8$\n首先，我们计算必要的积分：\n$$\n\\int_0^1 f_A(x) \\,dx = \\int_0^1 x^8 \\,dx = \\left[ \\frac{x^9}{9} \\right]_0^1 = \\frac{1}{9}\n$$\n$$\n\\int_0^1 (f_A(x))^2 \\,dx = \\int_0^1 (x^8)^2 \\,dx = \\int_0^1 x^{16} \\,dx = \\left[ \\frac{x^{17}}{17} \\right]_0^1 = \\frac{1}{17}\n$$\n现在我们计算 $f_A(X)$ 的方差：\n$$\n\\text{Var}(f_A(X)) = \\frac{1}{17} - \\left(\\frac{1}{9}\\right)^2 = \\frac{1}{17} - \\frac{1}{81} = \\frac{81 - 17}{17 \\cdot 81} = \\frac{64}{1377}\n$$\n估计量 $\\hat{I}_{A,N}$ 的方差是：\n$$\n\\text{Var}(\\hat{I}_{A,N}) = \\frac{1}{N} \\frac{64}{1377}\n$$\n\n情况 B：$f_B(x) = x^2$\n首先，我们计算必要的积分：\n$$\n\\int_0^1 f_B(x) \\,dx = \\int_0^1 x^2 \\,dx = \\left[ \\frac{x^3}{3} \\right]_0^1 = \\frac{1}{3}\n$$\n$$\n\\int_0^1 (f_B(x))^2 \\,dx = \\int_0^1 (x^2)^2 \\,dx = \\int_0^1 x^4 \\,dx = \\left[ \\frac{x^5}{5} \\right]_0^1 = \\frac{1}{5}\n$$\n现在我们计算 $f_B(X)$ 的方差：\n$$\n\\text{Var}(f_B(X)) = \\frac{1}{5} - \\left(\\frac{1}{3}\\right)^2 = \\frac{1}{5} - \\frac{1}{9} = \\frac{9 - 5}{45} = \\frac{4}{45}\n$$\n估计量 $\\hat{I}_{B,N}$ 的方差是：\n$$\n\\text{Var}(\\hat{I}_{B,N}) = \\frac{1}{N} \\frac{4}{45}\n$$\n\n最后，我们计算两个方差的比值。因子 $\\frac{1}{N}$ 是两者共有的，因此可以消掉。\n$$\n\\frac{\\text{Var}(\\hat{I}_{A,N})}{\\text{Var}(\\hat{I}_{B,N})} = \\frac{\\frac{1}{N} \\frac{64}{1377}}{\\frac{1}{N} \\frac{4}{45}} = \\frac{\\frac{64}{1377}}{\\frac{4}{45}} = \\frac{64}{1377} \\cdot \\frac{45}{4}\n$$\n我们可以化简这个表达式：\n$$\n\\frac{64}{4} \\cdot \\frac{45}{1377} = 16 \\cdot \\frac{45}{1377}\n$$\n从我们计算 $\\text{Var}(f_A(X))$ 的过程中我们记得 $1377 = 17 \\cdot 81$。我们也知道 $45 = 5 \\cdot 9$ 且 $81 = 9 \\cdot 9$。\n$$\n16 \\cdot \\frac{5 \\cdot 9}{17 \\cdot 81} = 16 \\cdot \\frac{5 \\cdot 9}{17 \\cdot 9 \\cdot 9} = 16 \\cdot \\frac{5}{17 \\cdot 9} = \\frac{80}{153}\n$$\n分数 $\\frac{80}{153}$ 是最简形式，因为 $80 = 2^4 \\cdot 5$ 和 $153 = 3^2 \\cdot 17$ 没有共同的素因子。", "answer": "$$\\boxed{\\frac{80}{153}}$$", "id": "2188171"}, {"introduction": "对于罕见事件，简单的蒙特卡洛方法可能效率低下。本练习在系统可靠性的背景下，介绍了一种强大的方差缩减技术——重要性抽样。通过计算该方法的核心组成部分——似然比，您将深入了解我们如何将抽样“集中”在重要区域，从而用更少的样本获得更准确的估计 [@problem_id:1376878]。", "problem": "一个复杂系统的可靠性正在被研究。其在发生某种特定类型故障前的总运行时间被建模为 $n=20$ 个独立同分布组件寿命的总和 $S = \\sum_{i=1}^{n} X_i$。每个组件的寿命 $X_i$ 服从指数概率分布，其速率参数为 $\\lambda=1$ 年$^{-1}$。如果总运行时间 $S > a$，其中 $a=40$ 年，则会触发一次关键且昂贵的维护事件。\n\n为了数值估计这一罕见事件的概率 $P(S > a)$，一位分析师决定使用重要性抽样方法。该方法涉及从一个新的分布中生成组件寿命 $Y_i$，这个新分布也是指数分布，但具有不同的速率参数 $\\theta$。\n\n在此情况下，选择有效的重要性抽样参数的一个常用启发式方法是，选择 $\\theta$ 值需满足 $E_{\\theta}[S_Y] = a$，其中 $S_Y = \\sum_{i=1}^{n} Y_i$。\n\n设 $f_S(s)$ 是真实总寿命 $S$ 的概率密度函数 (PDF)，并设 $g_{S,\\theta}(s)$ 是在由启发式方法确定的速率参数 $\\theta$ 下，重要性抽样方案的总寿命 $S_Y$ 的概率密度函数。计算在关键阈值 $s=a$ 处评估的似然比 $W(s) = \\frac{f_S(s)}{g_{S,\\theta}(s)}$ 的值。\n\n将您的答案表示为一个四舍五入到三位有效数字的实数。", "solution": "$n$ 个独立的 $\\operatorname{Exp}(\\lambda)$ 随机变量之和服从伽马分布，其形状参数为 $n$，速率参数为 $\\lambda$。因此，对于 $S=\\sum_{i=1}^{n}X_{i}$ 且 $X_{i}\\sim \\operatorname{Exp}(\\lambda)$，其概率密度函数为\n$$\nf_{S}(s)=\\frac{\\lambda^{n}}{\\Gamma(n)}\\,s^{n-1}\\exp(-\\lambda s),\\quad s0.\n$$\n在重要性抽样下，$Y_{i}\\sim \\operatorname{Exp}(\\theta)$ 相互独立，所以 $S_{Y}=\\sum_{i=1}^{n}Y_{i}$ 的概率密度函数为\n$$\ng_{S,\\theta}(s)=\\frac{\\theta^{n}}{\\Gamma(n)}\\,s^{n-1}\\exp(-\\theta s),\\quad s0.\n$$\n该启发式方法选择 $\\theta$ 以满足 $E_{\\theta}[S_{Y}]=a$。由于 $E_{\\theta}[S_{Y}]=n/\\theta$，这给出\n$$\n\\frac{n}{\\theta}=a\\quad\\Rightarrow\\quad \\theta=\\frac{n}{a}.\n$$\n在 $s$ 处的似然比为\n$$\nW(s)=\\frac{f_{S}(s)}{g_{S,\\theta}(s)}=\\frac{\\lambda^{n}\\exp(-\\lambda s)}{\\theta^{n}\\exp(-\\theta s)}=\\left(\\frac{\\lambda}{\\theta}\\right)^{n}\\exp\\bigl(-(\\lambda-\\theta)s\\bigr).\n$$\n当 $\\lambda=1$ 时，这简化为\n$$\nW(s)=\\theta^{-n}\\exp\\bigl(-(1-\\theta)s\\bigr).\n$$\n在 $s=a$ 处，使用 $\\theta=n/a$ 进行评估，得到\n$$\nW(a)=\\left(\\frac{a}{n}\\right)^{n}\\exp(n-a).\n$$\n对于 $n=20$ 和 $a=40$，\n$$\nW(40)=2^{20}\\exp(-20)\\approx 0.002161276\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.00216$。", "answer": "$$\\boxed{0.00216}$$", "id": "1376878"}]}