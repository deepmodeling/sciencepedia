{"hands_on_practices": [{"introduction": "在许多现实场景中，我们需要估计一个未知比例，例如产品合格率或事件发生概率。本练习将通过一个质量控制的实例，引导你应用贝叶斯方法中最基本的模型之一——贝塔-二项分布模型。通过这个练习，你将亲手实践如何将代表先验信念的贝塔分布与新观察到的数据（在本例中为功能芯片的数量）相结合，从而得到一个更新的、更精确的后验估计。[@problem_id:1345485]", "problem": "一位质量控制工程师正在评估一种用于生产半导体芯片的新制造工艺。一个新制造的芯片功能正常的真实但未知的概率用 $p$ 表示。根据初始的理论模型，该工程师假设 $p$ 在区间 $[0, 1]$ 内的任何取值都是等可能的。这种先验信念可以被形式化地描述为一个参数为 $\\alpha=1$ 和 $\\beta=1$ 的贝塔分布，即 $p \\sim \\text{Beta}(1, 1)$。\n\n随后，该工程师测试了由这个新工艺生产的一小批5个芯片，并发现其中4个功能正常。\n\n使用这个新数据，计算概率 $p$ 的更新后的贝叶斯估计值。具体来说，求出 $p$ 的后验均值。请将您的答案表示为一个最简分数。", "solution": "设一个芯片功能正常的概率为 $p$。先验分布为 $p \\sim \\text{Beta}(\\alpha, \\beta)$，其中 $\\alpha=1$ 且 $\\beta=1$。Beta$(\\alpha,\\beta)$ 先验分布的密度在 $[0,1]$ 上与 $p^{\\alpha-1}(1-p)^{\\beta-1}$ 成正比。\n\n从测试的 $n=5$ 个芯片中有 $x=4$ 个功能正常，其二项似然函数为\n$$\nL(p \\mid x) = \\binom{n}{x} p^{x} (1-p)^{n-x},\n$$\n作为 $p$ 的函数，该似然函数与 $p^{x}(1-p)^{n-x}$ 成正比。\n\n根据贝叶斯法则和贝塔-二项分布的共轭性，\n$$\nf(p \\mid x) \\propto L(p \\mid x)\\, f(p) \\propto p^{x+\\alpha-1}(1-p)^{n-x+\\beta-1},\n$$\n所以后验分布为\n$$\np \\mid x \\sim \\text{Beta}(\\alpha+x,\\ \\beta+n-x).\n$$\n将 $\\alpha=1$, $\\beta=1$, $x=4$ 和 $n=5$ 代入，得到\n$$\np \\mid x \\sim \\text{Beta}(1+4,\\ 1+5-4) = \\text{Beta}(5, 2).\n$$\n$\\text{Beta}(a,b)$ 分布的均值为 $\\frac{a}{a+b}$，因此\n$$\n\\mathbb{E}[p \\mid x] = \\frac{5}{5+2} = \\frac{5}{7}.\n$$\n因此，更新后的贝叶斯估计（后验均值）为 $\\frac{5}{7}$。", "answer": "$$\\boxed{\\frac{5}{7}}$$", "id": "1345485"}, {"introduction": "从离散概率转向连续测量值，是数据分析中的一个重要步骤。本练习将探讨如何估计一个服从正态分布的数据流的均值 $\\mu$，例如金融算法的平均回报率，这是一个在科学和工程领域无处不在的模型。你的任务是推导出后验均值的一般表达式，这个过程将揭示贝叶斯更新的核心思想：后验估计是先验信念和数据证据的精确度加权平均。[@problem_id:1345529]", "problem": "一家金融科技公司的数据科学家正在评估一种新的自动化高频交易（HFT）算法。该算法的周收益率（以百分比表示）被建模为一个随机变量，该随机变量服从一个具有未知真实均值 $\\mu$ 和已知方差 $\\sigma^2$ 的正态分布。\n\n基于对相似策略的模拟和分析，该科学家关于均值收益率 $\\mu$ 的先验信念被量化为一个均值为 $\\mu_0$、方差为 $\\sigma_0^2$ 的正态分布。\n\n为了在真实市场中测试该算法，它被运行了 $n$ 周。在此测试期间观测到的平均周收益率为 $\\bar{x}$。您的任务是根据这些新数据来更新科学家关于均值收益率 $\\mu$ 的信念。\n\n确定均值周收益率 $\\mu$ 的更新后期望值。请用先验均值 $\\mu_0$、先验方差 $\\sigma_0^2$、周数 $n$、已知的周收益率方差 $\\sigma^2$ 以及观测到的平均周收益率 $\\bar{x}$ 来表示您的答案的符号表达式。", "solution": "我们将周收益率建模为独立观测值 $x_{1},\\dots,x_{n}$，其中 $x_{i}\\,|\\,\\mu \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。均值的先验分布为 $\\mu \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$。根据贝叶斯定理以及正态似然与正态先验的共轭性，$\\mu$ 的后验分布也是正态分布。为了推导其均值，我们将似然函数用充分统计量 $\\bar{x}$ 表示：\n$$\np(x_{1:n}\\,|\\,\\mu)\\propto \\exp\\!\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}\\right)\n= \\exp\\!\\left(-\\frac{n}{2\\sigma^{2}}(\\bar{x}-\\mu)^{2}\\right)\\times C,\n$$\n其中 $C$ 不依赖于 $\\mu$。先验密度为\n$$\np(\\mu)\\propto \\exp\\!\\left(-\\frac{1}{2\\sigma_{0}^{2}}(\\mu-\\mu_{0})^{2}\\right).\n$$\n因此，$\\mu$ 的未归一化后验核为\n$$\np(\\mu\\,|\\,x_{1:n}) \\propto \\exp\\!\\left[-\\frac{1}{2}\\left(\\frac{n}{\\sigma^{2}}(\\mu-\\bar{x})^{2}+\\frac{1}{\\sigma_{0}^{2}}(\\mu-\\mu_{0})^{2}\\right)\\right].\n$$\n展开并合并关于 $\\mu$ 的项，得到\n$$\n-\\frac{1}{2}\\left[\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\sigma_{0}^{2}}\\right)\\mu^{2}\n-2\\left(\\frac{n\\bar{x}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\sigma_{0}^{2}}\\right)\\mu + \\text{const}\\right].\n$$\n通过配方法，上式等于\n$$\n-\\frac{1}{2}\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\sigma_{0}^{2}}\\right)\\left(\\mu-\\frac{\\frac{n\\bar{x}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\sigma_{0}^{2}}}{\\frac{n}{\\sigma^{2}}+\\frac{1}{\\sigma_{0}^{2}}}\\right)^{2}+\\text{const},\n$$\n因此后验分布是正态分布，其均值为\n$$\n\\mathbb{E}[\\mu\\,|\\,x_{1:n}] \\;=\\; \\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\bar{x}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}}.\n$$\n这就是更新后的均值周收益率的期望值。", "answer": "$$\\boxed{\\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\bar{x}}{\\sigma^{2}}}{\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}}}$$", "id": "1345529"}, {"introduction": "贝叶斯推断不仅是分析已有数据的工具，更是一种规划未来的强大框架。这个实践将带你从“推断”更进一步到“设计”，你将学习如何利用贝叶斯原理来回答一个至关重要的实践问题：“我们需要收集多少数据才能达到预期的精度？”。通过计算所需的最小样本量 $n$ 来降低对材料弹性模量估计的不确定性，你将体会到贝叶斯方法在指导科学研究和工程决策中的前瞻性价值。[@problem_id:1345481]", "problem": "一位材料科学家正在研究一种新开发的合金的弹性。根据理论模型和以往对类似材料的经验，该科学家对平均杨氏模量 $\\mu$ 的先验信念可以用一个正态分布来建模，其均值为 $\\mu_0 = 150 \\text{ GPa}$，方差为 $\\sigma_0^2 = 0.8 \\text{ GPa}^2$。\n\n为了精确这个估计，该科学家进行了一系列拉伸测试。每次测量值 $X_i$ 都假定其来自一个均值为 $\\mu$、已知测量方差为 $\\sigma^2 = 12.0 \\text{ GPa}^2$ 的正态分布，该方差考虑了仪器的精度和微小的环境波动。测量结果是独立同分布的。\n\n该科学家旨在减少关于 $\\mu$ 的不确定性。为了确保 $\\mu$ 的后验方差小于先验方差的四分之一，必须收集的最小整数测量次数 $n$ 是多少？", "solution": "设先验为 $\\mu \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$，数据模型为 $X_{i} \\mid \\mu \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，对于 $i=1,\\dots,n$ 独立，且 $\\sigma^{2}$ 已知。在方差已知的正态-正态共轭模型中，经过 $n$ 次观测后，$\\mu$ 的后验方差为\n$$\n\\sigma_{n}^{2}=\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}.\n$$\n我们要求后验方差小于先验方差的四分之一：\n$$\n\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}<\\frac{1}{4}\\sigma_{0}^{2}.\n$$\n由于所有量均为正，将不等式两边取倒数得到\n$$\n\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}>\\frac{4}{\\sigma_{0}^{2}}.\n$$\n整理以分离出 $n$：\n$$\n\\frac{n}{\\sigma^{2}}>\\frac{4}{\\sigma_{0}^{2}}-\\frac{1}{\\sigma_{0}^{2}}=\\frac{3}{\\sigma_{0}^{2}}\n\\quad\\Longrightarrow\\quad\nn>\\frac{3\\sigma^{2}}{\\sigma_{0}^{2}}.\n$$\n代入给定的方差值 $\\sigma^{2}=12.0$ 和 $\\sigma_{0}^{2}=0.8$：\n$$\nn>\\frac{3\\times 12.0}{0.8}=\\frac{36.0}{0.8}=45.\n$$\n因为该不等式是严格的，所以满足条件的最小整数 $n$ 是 $46$。", "answer": "$$\\boxed{46}$$", "id": "1345481"}]}