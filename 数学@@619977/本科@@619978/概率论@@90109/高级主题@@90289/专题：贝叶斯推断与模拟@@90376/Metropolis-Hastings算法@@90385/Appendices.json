{"hands_on_practices": [{"introduction": "我们的第一个动手实践将带你掌握Metropolis-Hastings算法中的核心计算。我们将从最简单的情形入手：对称提议分布，此时算法简化为最初的Metropolis算法。通过计算在离散的泊松分布（Poisson distribution）上的转移接受概率，你将亲身体验驱动采样器走向高概率区域的核心机制。[@problem_id:1962612]", "problem": "一位统计学家正在实现一个马尔可夫链蒙特卡洛（MCMC）模拟，以从一个目标概率分布中生成样本。选定的目标分布是泊松分布，它模拟在固定的时间或空间间隔内发生事件的次数 $k$。泊松分布的概率质量函数由下式给出：\n$$ P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$\n其中 $\\lambda$ 是事件的平均发生率。对于这个特定的模拟，参数被设置为 $\\lambda = 5$。\n\n该模拟使用 Metropolis-Hastings 算法和一个对称提议分布，这意味着从状态 $k_1$ 提议移动到状态 $k_2$ 的概率与从 $k_2$ 提议移动到 $k_1$ 的概率相同。\n\n假设链的当前状态是 $k=5$。该算法接着提议移动到一个新状态 $k'=6$。\n\n计算这个从 $k=5$ 到 $k'=6$ 的提议移动的接受概率。将你的答案表示为小数，并四舍五入到三位有效数字。", "solution": "在使用对称提议分布的 Metropolis-Hastings 算法中，从状态 $k$ 到 $k'$ 的提议移动的接受概率为\n$$\n\\alpha = \\min\\left(1, \\frac{\\pi(k')}{\\pi(k)}\\right),\n$$\n其中 $\\pi(\\cdot)$ 是目标概率质量函数。对于参数为 $\\lambda$ 的泊松分布，其概率质量函数（PMF）为\n$$\n\\pi(k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!}.\n$$\n因此，该比率可简化为\n$$\n\\frac{\\pi(k')}{\\pi(k)} = \\frac{\\lambda^{k'} \\exp(-\\lambda) / k'!}{\\lambda^{k} \\exp(-\\lambda) / k!} = \\lambda^{k'-k} \\frac{k!}{k'!}.\n$$\n当 $k=5$，$k'=6$，且 $\\lambda=5$ 时，我们有 $k'-k=1$ 且 $6! = 6 \\cdot 5!$，所以\n$$\n\\frac{\\pi(6)}{\\pi(5)} = \\lambda \\cdot \\frac{5!}{6!} = \\lambda \\cdot \\frac{1}{6} = \\frac{5}{6}.\n$$\n因此，接受概率为\n$$\n\\alpha = \\min\\left(1, \\frac{5}{6}\\right) = \\frac{5}{6}.\n$$\n表示为小数并四舍五入到三位有效数字，结果是 $0.833$。", "answer": "$$\\boxed{0.833}$$", "id": "1962612"}, {"introduction": "现实世界中的提议分布并非总是对称的。这个练习将通过引入一个非对称的随机游走提议，展示Metropolis-Hastings算法的全部威力。你将看到“Hastings修正项”（即提议概率的比率）如何确保采样器即使在提议机制本身存在偏向的情况下，依然能够收敛到正确的目标分布。[@problem_id:1343415]", "problem": "一位计算物理学家正在开发一个马尔可夫链蒙特卡洛 (MCMC) 模拟，用于从正整数集 $\\mathbb{Z}^+ = \\{1, 2, 3, \\dots\\}$ 上的一个特定目标概率分布中生成样本。目标分布 $\\pi(k)$ 与 $a^{k-1}$ 成正比，其中 $a$ 为某个常数，且 $0  a  1$。即 $\\pi(k) \\propto a^{k-1}$。\n\n该模拟使用 Metropolis-Hastings 算法和一个随机游走提议机制。从当前状态 $k$，根据以下规则提议一个候选状态 $j$：\n- 以概率 $p$，提议的候选状态为 $j = k+1$。\n- 以概率 $1-p$，提议的候选状态为 $j = k-1$。\n\n为确保过程保持在正整数上，施加了一个边界条件：如果当前状态为 $k=1$ 且选择了向 $k-1$ 的移动，则提议的候选状态将被设为 $j=1$。在所有其他情况下，提议按所述方式进行。\n\n提议向上移动的概率被设置为 $p = \\frac{1}{3}$。\n\n确定目标分布的参数 $a$ 的值，使得从任意状态 $k$ 到状态 $k+1$ 的任何提议移动的 Metropolis-Hastings 接受概率恰好为 $\\frac{1}{2}$。请将答案表示为单个数值。", "solution": "我们使用从状态 $k$ 到状态 $j$ 的提议移动的 Metropolis-Hastings 接受概率，其表达式为\n$$\n\\alpha(k \\to j) = \\min\\left(1, \\frac{\\pi(j)\\, q(k \\mid j)}{\\pi(k)\\, q(j \\mid k)}\\right).\n$$\n目标分布是 $\\mathbb{Z}^{+}$ 上的几何分布，满足 $\\pi(k) \\propto a^{k-1}$ 且 $0a1$，因此对于连续的状态，我们有\n$$\n\\frac{\\pi(k+1)}{\\pi(k)} = a.\n$$\n提议是一个最近邻随机游走，满足\n$$\nq(k+1 \\mid k) = p, \\qquad q(k \\mid k+1) = 1-p,\n$$\n在给定的边界规则下，这对所有 $k \\geq 1$ 都成立（边界仅影响从 $k=1$ 到 $k-1$ 的提议，而不影响此处所需的反向概率）。\n\n因此，对于向上的提议 $j = k+1$，Metropolis-Hastings 接受比为\n$$\nr(k \\to k+1) = \\frac{\\pi(k+1)\\, q(k \\mid k+1)}{\\pi(k)\\, q(k+1 \\mid k)} = \\frac{a \\, (1-p)}{p}.\n$$\n那么，接受概率为\n$$\n\\alpha(k \\to k+1) = \\min\\left(1, \\frac{a \\, (1-p)}{p}\\right).\n$$\n根据题意，从 $k$ 到 $k+1$ 的任何提议移动的接受概率必须恰好为 $\\frac{1}{2}$。由于当接受比小于1时，接受概率 $\\alpha$ 就等于该比值，我们令：\n$$\n\\frac{a \\, (1-p)}{p} = \\frac{1}{2}.\n$$\n将 $p = \\frac{1}{3}$ 代入，我们计算得\n$$\n\\frac{a \\left(1 - \\frac{1}{3}\\right)}{\\frac{1}{3}} = \\frac{a \\left(\\frac{2}{3}\\right)}{\\frac{1}{3}} = 2a = \\frac{1}{2},\n$$\n解得\n$$\na = \\frac{1}{4}.\n$$\n该值满足 $0a1$，并使得对于所有 $k$，接受概率都恰好为 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1343415"}, {"introduction": "一个高效的MCMC采样器需要仔细调优，而其中一个关键挑战就是选择提议步长。这个问题将带你从定量的角度审视“探索”与“接受率”之间的权衡。通过比较一个小的局部移动和一个大的探索性跳跃，你将理解为什么高接受率并不总是最优选择，以及提议设计如何影响采样器有效探索整个状态空间的能力。[@problem_id:1401728]", "problem": "一位研究人员正在实施 Metropolis-Hastings (MH) 算法，以从一维目标概率分布中生成样本。已知该分布的概率密度函数 $p(x)$ 与函数 $f(x)$ 成正比，其中 $f(x) = \\exp(8x^2 - x^4)$。该算法通过使用一个提议分布 $q(x'|x_t)$ 从当前状态 $x_t$ 提议一个新状态 $x'$ 来进行。在此特定实现中，提议分布是一个对称正态分布 $q(x'|x_t) = N(x'|x_t, \\sigma^2)$，这将 MH 过程简化为 Metropolis 算法。\n\n假设采样器当前处于状态 $x_t = 2.0$，这对应于目标概率密度的一个局部最大值（一个众数）。该研究人员希望了解对于不同类型的提议移动，接受概率会如何变化。他们考虑了两种具体的、假设性的提议：\n\n1.  向提议状态 $x'_S = 2.1$ 进行一次小的、局部的移动。\n2.  向提议状态 $x'_L = -1.5$ 进行一次大的、探索性的移动，该状态位于以 $x=0$ 为中心的低概率区域的另一侧。\n\n设 $A_S$ 是从 $x_t$ 到 $x'_S$ 的小范围移动的接受概率，而 $A_L$ 是从 $x_t$ 到 $x'_L$ 的大范围移动的接受概率。\n\n计算比率 $\\frac{A_S}{A_L}$。将您的最终答案四舍五入到三位有效数字。", "solution": "在 Metropolis-Hastings 算法中，从 $x_{t}$ 到 $x'$ 的提议的接受概率为\n$$\nA(x_{t}\\to x')=\\min\\left(1,\\frac{p(x')\\,q(x_{t}|x')}{p(x_{t})\\,q(x'|x_{t})}\\right).\n$$\n对于对称提议 $q(x'|x_{t})=q(x_{t}|x')$，这简化为 Metropolis 法则\n$$\nA(x_{t}\\to x')=\\min\\left(1,\\frac{p(x')}{p(x_{t})}\\right).\n$$\n给定 $p(x)\\propto f(x)$ 且 $f(x)=\\exp(8x^{2}-x^{4})$，归一化常数在比率中被抵消，因此\n$$\n\\frac{p(x')}{p(x_{t})}=\\frac{f(x')}{f(x_{t})}=\\exp\\!\\left(8\\bigl(x'^{2}-x_{t}^{2}\\bigr)-\\bigl(x'^{4}-x_{t}^{4}\\bigr)\\right).\n$$\n\n对于从 $x_{t}=2.0$ 到 $x'_{S}=2.1$ 的小范围移动：\n- $x_{t}^{2}=4$, $x_{t}^{4}=16$; $x_{S}'^{2}=4.41$, $x_{S}'^{4}=19.4481$。\n- 指数差：\n$$\n8\\bigl(4.41-4\\bigr)-\\bigl(19.4481-16\\bigr)=8\\cdot 0.41-3.4481=3.28-3.4481=-0.1681.\n$$\n因此\n$$\n\\frac{p(x'_{S})}{p(x_{t})}=\\exp(-0.1681)1,\\quad A_{S}=\\exp(-0.1681).\n$$\n\n对于从 $x_{t}=2.0$ 到 $x'_{L}=-1.5$ 的大范围移动：\n- $x_{L}'^{2}=2.25$, $x_{L}'^{4}=5.0625$。\n- 指数差：\n$$\n8\\bigl(2.25-4\\bigr)-\\bigl(5.0625-16\\bigr)=8\\cdot(-1.75)-(-10.9375)=-14+10.9375=-3.0625.\n$$\n因此\n$$\n\\frac{p(x'_{L})}{p(x_{t})}=\\exp(-3.0625)1,\\quad A_{L}=\\exp(-3.0625).\n$$\n\n因此，接受概率的比率为\n$$\n\\frac{A_{S}}{A_{L}}=\\frac{\\exp(-0.1681)}{\\exp(-3.0625)}=\\exp(2.8944)\\approx 18.1\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{18.1}$$", "id": "1401728"}]}