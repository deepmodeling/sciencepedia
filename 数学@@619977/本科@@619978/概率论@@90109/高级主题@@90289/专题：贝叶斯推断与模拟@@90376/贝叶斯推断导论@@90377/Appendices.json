{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于根据新证据更新我们的信念。这个练习提供了一个经典且直观的例子：评估一名篮球运动员的投篮能力。通过将关于其投篮命中率 $p$ 的先验信念（一个贝塔分布）与新的表现数据相结合，你将实践贝叶斯更新的核心机制，并计算其成功概率的后验期望值。[@problem_id:1923983]", "problem": "一位体育分析师正在评估一名篮球运动员的罚球能力。分析师将该球员每次投篮的内在成功概率（记为 $p$）建模为一个随机变量。分析师对 $p$ 的初始信念由一个参数为 $\\alpha_0 = 4$ 和 $\\beta_0 = 2$ 的贝塔分布表示。\n\n然后，分析师在一次练习赛中观察了该球员。球员被要求一直投篮，直到成功投进 $r=5$ 个罚球为止。分析师记录到，为了完成这 5 次成功投篮，该球员总共投了 $n=8$ 次。\n\n根据这个新的实验数据，分析师更新了他们关于 $p$ 的模型。更新后的 $p$ 模型也将是一个贝塔分布。根据这个更新后的模型，计算 $p$ 的期望值。将你的答案表示为保留三位有效数字的小数。", "solution": "我们用一个贝塔先验分布来为 $p$ 建模，$p \\sim \\mathrm{Beta}(\\alpha_{0},\\beta_{0})$，其中 $\\alpha_{0}=4$ 且 $\\beta_{0}=2$。对于 $0<p<1$，贝塔密度函数与 $p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}$ 成正比。\n\n数据来自一个负二项实验：为取得 $r$ 次成功所需的试验次数 $n$。在给定 $p$ 和 $r$ 的条件下观测到 $n$ 的似然函数，在不考虑与 $p$ 无关的因子的前提下，为：\n$$\n\\mathcal{L}(p\\,|\\,n,r) \\propto p^{r}(1-p)^{n-r}.\n$$\n根据共轭性，后验分布与先验分布和似然函数的乘积成正比：\n$$\n\\pi(p\\,|\\,\\text{data}) \\propto p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}\\cdot p^{r}(1-p)^{n-r}\n= p^{(\\alpha_{0}+r)-1}(1-p)^{(\\beta_{0}+n-r)-1},\n$$\n这是一个贝塔分布，\n$$\np\\,|\\,\\text{data} \\sim \\mathrm{Beta}(\\alpha_{0}+r,\\ \\beta_{0}+n-r).\n$$\n后验均值为\n$$\n\\mathbb{E}[p\\,|\\,\\text{data}] = \\frac{\\alpha_{0}+r}{\\alpha_{0}+r+\\beta_{0}+n-r}\n= \\frac{\\alpha_{0}+r}{\\alpha_{0}+\\beta_{0}+n}.\n$$\n代入 $\\alpha_{0}=4$, $\\beta_{0}=2$, $r=5$, 和 $n=8$ 可得\n$$\n\\mathbb{E}[p\\,|\\,\\text{data}] = \\frac{4+5}{4+2+8} = \\frac{9}{14}.\n$$\n作为保留三位有效数字的小数，\n$$\n\\frac{9}{14} \\approx 0.643.\n$$", "answer": "$$\\boxed{0.643}$$", "id": "1923983"}, {"introduction": "当一个事件从未被观察到时，我们能得出什么结论？这个发人深省的问题探讨了贝叶斯分析如何处理稀疏数据，这是在医学可靠性等领域中的常见挑战。你将使用一个无信息先验来建模初始的不确定性，并在观察到零次成功后，计算后验中位数，从而对一个极小成功率给出一个严谨而细致的估计。[@problem_id:1923968]", "problem": "一种新的高风险外科手术正在被开发，用于治疗此前被认为无法治愈的病症。该手术的真实成功概率（记为 $p$）是未知的。在进行任何临床试验之前，医学研究人员对这个概率没有任何先入为主的偏见，因此认为在区间 $[0, 1]$ 内，$p$ 的每一个可能值都是等可能的。\n\n随后，在 $n$ 位不同的患者身上尝试了该手术。在这 $n$ 次独立的试验中，每一次手术都未能成功。\n\n基于这 $n$ 次试验中成功次数为零的观测数据，形成了关于成功概率 $p$ 的更新信念。一位医学统计学家决定通过计算一个中心值 $p_{med}$ 来总结这一更新的信念。该值的定义是：在给定观测数据的情况下，真实成功率 $p$ 小于或等于 $p_{med}$ 的概率与 $p$ 大于 $p_{med}$ 的概率相等。\n\n求 $p_{med}$ 关于 $n$ 的解析形式闭式表达式。", "solution": "设 $p$ 表示成功概率。先验信念是在 $[0,1]$ 上的均匀分布，即 $\\operatorname{Beta}(1,1)$ 先验分布，其密度为 $\\pi(p)=1$（对于 $p\\in[0,1]$）。\n\n我们观测到 $n$ 次独立的伯努利试验，其中成功次数为 $k=0$。似然函数为\n$$\nL(p\\mid \\text{data}) \\propto p^{k}(1-p)^{n-k}=(1-p)^{n}.\n$$\n根据贝叶斯定理，后验分布正比于先验分布乘以似然函数：\n$$\n\\pi(p\\mid \\text{data}) \\propto \\pi(p)L(p\\mid \\text{data}) \\propto (1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n这是一个 $\\operatorname{Beta}(1,n+1)$ 分布。显式地进行归一化，\n$$\n\\int_{0}^{1} (1-p)^{n}\\,dp=\\frac{1}{n+1},\n$$\n所以后验密度函数为\n$$\nf(p\\mid \\text{data})=(n+1)(1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n后验累积分布函数为\n$$\nF(p)=\\int_{0}^{p} (n+1)(1-t)^{n}\\,dt.\n$$\n通过变量代换 $u=1-t$，$du=-dt$ 来计算该积分：\n$$\nF(p)=(n+1)\\int_{0}^{p} (1-t)^{n}\\,dt=(n+1)\\int_{1-p}^{1} u^{n}\\,du\n= (n+1)\\left[\\frac{u^{n+1}}{n+1}\\right]_{1-p}^{1}\n=1-(1-p)^{n+1}.\n$$\n后验中位数 $p_{med}$ 满足 $F(p_{med})=\\frac{1}{2}$，因此\n$$\n1-(1-p_{med})^{n+1}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n(1-p_{med})^{n+1}=\\frac{1}{2}.\n$$\n两边开 $(n+1)$ 次方根，得到\n$$\n1-p_{med}=2^{-\\frac{1}{n+1}},\n$$\n所以\n$$\np_{med}=1-2^{-\\frac{1}{n+1}}.\n$$\n该表达式对所有 $n\\geq 0$ 都成立，特别地，对于问题情境中的 $n\\geq 1$ 也成立。", "answer": "$$\\boxed{1-2^{-\\frac{1}{n+1}}}$$", "id": "1923968"}, {"introduction": "除了估计简单的概率，贝叶斯方法也是量化连续参数不确定性的强大工具。这项练习将我们的焦点从比例转移到工程传感器误差的方差 $\\sigma^2$ 上。你将学习如何利用共轭先验（逆伽马分布）来更新关于方差的信念，并构建一个可信区间，这是表达参数合理取值范围的标准贝叶斯方法。[@problem_id:1924015]", "problem": "一种新型微机电系统（MEMS）陀螺仪正在进行测试，以用于卫星姿态控制。该陀螺仪的随机漂移误差被建模为一个正态分布的随机变量，其均值恰好为零，因为任何系统性偏差都已在校准过程中被移除。该误差的方差（记为 $\\sigma^2$）是未知的。\n\n基于传感器噪声源的物理原理，一位领域专家建议，方差 $\\sigma^2$ 的一个合理的先验信念可以用逆伽马分布来描述，其形状参数为 $\\alpha_0 = 3$，尺度参数为 $\\beta_0 = 0.02$。逆伽马分布 $\\text{Inv-Gamma}(\\alpha, \\beta)$ 的概率密度函数 (PDF) 为 $f(x | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{-\\alpha-1} \\exp(-\\frac{\\beta}{x})$，其中 $x > 0$。\n\n在测试期间，记录了以下五个独立的漂移误差测量值（单位：度/小时）：\n$x_1 = -0.25$，$x_2 = 0.15$，$x_3 = 0.30$，$x_4 = -0.10$，$x_5 = 0.05$。\n\n你的任务是确定漂移误差标准差 $\\sigma$ 的一个 95% 等尾可信区间。\n\n在计算中，你可能需要卡方 ($\\chi^2$) 分布的以下分位数。对于自由度为 11 的 $\\chi^2$ 分布，其 0.025 分位数约等于 3.816，0.975 分位数约等于 21.920。\n\n计算 $\\sigma$ 的可信区间的下界和上界。将两者的最终答案四舍五入到三位有效数字，并以度/小时为单位表示。", "solution": "设 $x_{1},\\dots,x_{n}$ 独立，其中 $x_{i}\\mid\\sigma^{2}\\sim\\mathcal{N}(0,\\sigma^{2})$，且先验分布为 $\\sigma^{2}\\sim\\text{Inv-Gamma}(\\alpha_{0},\\beta_{0})$，其密度函数为 $f(x\\mid\\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x^{-\\alpha-1}\\exp\\!\\left(-\\frac{\\beta}{x}\\right)$，其中 $x>0$。根据共轭性，后验分布为\n$$\n\\sigma^{2}\\mid x_{1:n}\\sim\\text{Inv-Gamma}\\!\\left(\\alpha_{n},\\beta_{n}\\right),\n$$\n其中\n$$\n\\alpha_{n}=\\alpha_{0}+\\frac{n}{2},\\qquad \\beta_{n}=\\beta_{0}+\\frac{1}{2}\\sum_{i=1}^{n}x_{i}^{2}.\n$$\n使用 $n=5$，$\\alpha_{0}=3$，$\\beta_{0}=0.02$ 以及数据 $x_{1}=-0.25$，$x_{2}=0.15$，$x_{3}=0.30$，$x_{4}=-0.10$，$x_{5}=0.05$，计算\n$$\n\\sum_{i=1}^{5}x_{i}^{2}=(-0.25)^{2}+(0.15)^{2}+(0.30)^{2}+(-0.10)^{2}+(0.05)^{2}=0.1875,\n$$\n因此\n$$\n\\alpha_{n}=3+\\frac{5}{2}=\\frac{11}{2},\\qquad \\beta_{n}=0.02+\\frac{1}{2}\\cdot 0.1875=0.11375.\n$$\n若 $\\sigma^{2}\\sim\\text{Inv-Gamma}(\\alpha,\\beta)$，则变换\n$$\nU=\\frac{2\\beta}{\\sigma^{2}}\n$$\n满足 $U\\sim\\chi^{2}_{2\\alpha}$。因此，对于后验分布，有\n$$\n\\frac{2\\beta_{n}}{\\sigma^{2}}\\sim\\chi^{2}_{2\\alpha_{n}}=\\chi^{2}_{11}.\n$$\n令 $q_{p}$ 表示 $\\chi^{2}_{11}$ 的 $p$-分位数。通过反转尾部，可以得到 $\\sigma^{2}$ 的 95% 等尾可信区间为：\n$$\n\\left[\\frac{2\\beta_{n}}{q_{0.975}},\\,\\frac{2\\beta_{n}}{q_{0.025}}\\right].\n$$\n使用 $q_{0.025}\\approx 3.816$ 和 $q_{0.975}\\approx 21.920$ 以及 $2\\beta_{n}=0.2275$ 可得\n$$\n\\sigma^{2}\\text{ 的下界}=\\frac{0.2275}{21.920}\\approx 0.01037865,\\qquad\n\\sigma^{2}\\text{ 的上界}=\\frac{0.2275}{3.816}\\approx 0.05961740.\n$$\n由于 $\\sigma=\\sqrt{\\sigma^{2}}$ 是一个单调变换，因此 $\\sigma$ 的等尾可信区间是上述界限的平方根：\n$$\n\\sigma\\text{ 的下界}=\\sqrt{0.01037865}\\approx 0.1019,\\qquad\n\\sigma\\text{ 的上界}=\\sqrt{0.05961740}\\approx 0.2442.\n$$\n将两者四舍五入到三位有效数字，得到 $0.102$ 和 $0.244$，单位为度/小时。", "answer": "$$\\boxed{\\begin{pmatrix}0.102 & 0.244\\end{pmatrix}}$$", "id": "1924015"}]}