{"hands_on_practices": [{"introduction": "在深入探讨永恒的“最终灭绝”概念之前，让我们从一个更具体、更直接的问题开始：一个谱系在几代之内灭绝的概率是多少？这个练习将引导你逐步计算有限时间内的灭绝概率，这是理解分支过程动态演变的基础。通过迭代应用概率生成函数 $G(s)$，你将亲身体验概率是如何从一代传递到下一代的，即 $q_n = G(q_{n-1})$ [@problem_id:1362109]。", "problem": "考虑一个自我复制数字实体在大型计算机网络中传播的简化模型。我们从第 $n=0$ 代的单个实体实例开始。对于之后的每一代，每个现有的实体实例都将独立地尝试繁殖。每次繁殖尝试的结果遵循以下规则：\n- 以概率 $p_0$，实例复制失败并被删除，留下 0 个新实例。\n- 以概率 $p_2$，实例在两个不同的新主机上成功创建两个新实例，而原始实例被删除。\n\n没有其他可能的结果，因此 $p_0 + p_2 = 1$。我们假设概率相等，即 $p_0 = p_2 = 0.5$。\n\n从第 $n=0$ 代的一个实例开始，该数字实体的种群在第 $n=3$ 代灭绝的概率是多少？请用精确分数表示你的答案。", "solution": "将其建模为一个 Galton–Watson 分支过程，其后代生成函数为 $G(s)=p_{0}+p_{2}s^{2}$。当 $p_{0}=p_{2}=\\frac{1}{2}$ 时，我们得到 $G(s)=\\frac{1}{2}+\\frac{1}{2}s^{2}$。令 $q_{n}$ 表示从第 $0$ 代的单个初始实例开始，种群在第 $n$ 代灭绝的概率。根据全概率公式和后代的独立性，到第 $n$ 代灭绝的概率满足以下递推关系\n$$\nq_{n}=G(q_{n-1})=p_{0}+p_{2}\\,q_{n-1}^{2},\n$$\n初始条件为 $q_{0}=0$（因为在第 $0$ 代有一个实例）。代入 $p_{0}=p_{2}=\\frac{1}{2}$ 得\n$$\nq_{n}=\\frac{1}{2}+\\frac{1}{2}\\,q_{n-1}^{2}。\n$$\n依次计算：\n$$\nq_{1}=\\frac{1}{2}+\\frac{1}{2}\\cdot 0^{2}=\\frac{1}{2}，\n$$\n$$\nq_{2}=\\frac{1}{2}+\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{2}+\\frac{1}{8}=\\frac{5}{8}，\n$$\n$$\nq_{3}=\\frac{1}{2}+\\frac{1}{2}\\left(\\frac{5}{8}\\right)^{2}=\\frac{1}{2}+\\frac{25}{128}=\\frac{64}{128}+\\frac{25}{128}=\\frac{89}{128}。\n$$\n因此，种群在第 $n=3$ 代灭绝的概率是 $\\frac{89}{128}$。", "answer": "$$\\boxed{\\frac{89}{128}}$$", "id": "1362109"}, {"introduction": "现在，让我们将目光投向长远的未来，探讨一个谱系的最终命运。这个练习要求你计算一个谱系最终完全消失的概率，即“最终灭绝概率”。这里的核心是理解灭绝概率是后代分布的概率生成函数 $G(s)$ 的一个不动点，即满足方程 $q = G(q)$。当平均后代数大于1时，如何从多个解中选出正确的灭绝概率，是本练习的关键所在 [@problem_id:1362066]。", "problem": "在一个经典神话的现代新编中，一种名为“hydra”的生物工程有机体正在被研究。这种 hydra 以一个我们称之为“头”的特化细胞开始其生命。一项收容协议包括一次中和一个头。当一个头被中和时，会触发一个再生过程，经过一小段时间后，会产生一个随机数量的新头。\n\n替代一个被中和的头的新头数量的概率分布如下：\n-   有 $p_0 = \\frac{1}{4}$ 的概率形成零个新头。\n-   有 $p_1 = \\frac{1}{2}$ 的概率形成一个新头。\n-   有 $p_3 = \\frac{1}{4}$ 的概率形成三个新头。\n\n新头的数量只能是 0、1 或 3。只要至少还剩下一个头，一次中和一个头的过程就会继续下去。如果头的数量变为零，则认为该 hydra 有机体被“根除”。假设该过程从一个头开始，且如果需要可以无限期地继续下去，那么该 hydra 最终被根除的确切概率是多少？\n\n请以闭式解析表达式的形式给出答案。", "solution": "将此过程解释为一个 Galton–Watson 分支过程，其后代分布支持于 $\\{0,1,3\\}$，概率为 $p_{0}=\\frac{1}{4}$，$p_{1}=\\frac{1}{2}$，$p_{3}=\\frac{1}{4}$。令 $q$ 表示从单个头开始的灭绝概率。根据分支特性，$q$ 是不动点方程的最小非负解\n$$\nq = \\sum_{k} p_{k} q^{k} = \\frac{1}{4} + \\frac{1}{2} q + \\frac{1}{4} q^{3}.\n$$\n整理得，\n$$\nq - \\frac{1}{2} q - \\frac{1}{4} q^{3} = \\frac{1}{4} \\quad \\Longrightarrow \\quad \\frac{1}{2} q - \\frac{1}{4} q^{3} = \\frac{1}{4} \\quad \\Longrightarrow \\quad 2 q - q^{3} = 1.\n$$\n等价地，\n$$\nq^{3} - 2 q + 1 = 0.\n$$\n观察到 $q=1$ 是一个根，因为 $1 - 2 + 1 = 0$。将此三次方程因式分解为\n$$\nq^{3} - 2 q + 1 = (q - 1)(q^{2} + q - 1).\n$$\n二次因式通过二次公式得出根：\n$$\nq = \\frac{-1 \\pm \\sqrt{1 + 4}}{2} = \\frac{-1 \\pm \\sqrt{5}}{2}.\n$$\n因此，不动点是 $q=1$，$q=\\frac{-1 + \\sqrt{5}}{2}$，和 $q=\\frac{-1 - \\sqrt{5}}{2}$。由于 $q$ 是一个概率，我们舍去负根。为了在 $\\frac{-1 + \\sqrt{5}}{2}$ 和 $1$ 之间进行选择，我们使用平均后代数 $\\mu = \\sum k p_{k} = 0 \\cdot \\frac{1}{4} + 1 \\cdot \\frac{1}{2} + 3 \\cdot \\frac{1}{4} = \\frac{5}{4} > 1$，这意味着这是一个超临界过程，因此灭绝概率严格小于 $1$。因此，灭绝概率是 $[0,1)$ 中的较小不动点：\n$$\nq = \\frac{\\sqrt{5} - 1}{2}.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{5}-1}{2}}$$", "id": "1362066"}, {"introduction": "掌握了从给定的繁殖规则计算灭绝概率的方法后，我们来挑战一个“逆向工程”问题。在现实世界中，我们常常是观察到了一个现象（例如，某个物种的灭绝风险），然后希望推断其背后的机制。这个练习正是模拟了这一过程：已知一个谱系的最终灭绝概率，你的任务是反推出其繁殖过程中的一个关键参数。这不仅能巩固你对 $q = G(q)$ 关系的理解，还能让你体会到如何利用数学模型从观测数据中提取深刻的洞见 [@problem_id:1362118]。", "problem": "考虑一个自我复制数字实体（例如一段代码或一个网络迷因）传播的简化模型。该过程从第零代的一个实体开始，记为 $Z_0=1$。给定代中的每个实体独立地为下一代产生若干“后代”。对于这个特定过程，一个实体要么以概率 $p_0$ 产生0个后代（复制失败），要么以概率 $p_3$ 产生恰好3个后代（复制成功）。后代的数量没有其他可能的结果，因此必有 $p_0 + p_3 = 1$。\n\n如果任何一代的种群大小变为零，则称该过程灭绝。从长期数据中观察到，该过程从单个实体开始的最终灭绝概率恰好是 $1/2$。\n\n根据这些信息，确定概率 $p_0$ 的精确值。请以单一的封闭形式解析表达式（如分数）给出答案。", "solution": "令随机变量 $X$ 表示单个个体产生的后代数量。根据问题陈述，$X$ 的概率分布为 $P(X=0) = p_0$ 和 $P(X=3) = p_3 = 1 - p_0$。对于 $k \\notin \\{0, 3\\}$，所有其他概率 $P(X=k)$ 均为零。\n\n这个场景描述了一个 Galton-Watson 分支过程。分支过程理论中的一个基本结果指出，最终灭绝概率（记为 $\\pi$）是方程 $s = G(s)$ 的最小非负根，其中 $G(s)$ 是后代分布的概率生成函数 (PGF)。\n\nPGF $G(s)$ 定义为：\n$$G(s) = E[s^X] = \\sum_{k=0}^{\\infty} P(X=k) s^k$$\n\n对于给定的后代分布，PGF 为：\n$$G(s) = p_0 + (1-p_0)s^3$$\n\n灭绝概率 $\\pi$ 必须满足方程 $\\pi = G(\\pi)$。我们已知灭绝概率为 $\\pi = 1/2$。将此值代入方程，我们得到：\n$$\\frac{1}{2} = G\\left(\\frac{1}{2}\\right)$$\n$$\\frac{1}{2} = p_0 + (1-p_0)\\left(\\frac{1}{2}\\right)^3$$\n\n现在，我们必须解此方程以求出未知概率 $p_0$。\n$$\\frac{1}{2} = p_0 + (1-p_0)\\frac{1}{8}$$\n为消去分数，我们可以将整个方程乘以 8：\n$$8 \\times \\frac{1}{2} = 8 \\times p_0 + 8 \\times (1-p_0)\\frac{1}{8}$$\n$$4 = 8p_0 + (1-p_0)$$\n$$4 = 8p_0 + 1 - p_0$$\n$$4 = 7p_0 + 1$$\n两边减 1 得：\n$$3 = 7p_0$$\n最后，两边除以 7，我们得到 $p_0$ 的值：\n$$p_0 = \\frac{3}{7}$$\n\n我们应该验证这是否导出一个一致的模型。平均后代数是 $\\mu = G'(1)$。PGF的导数是 $G'(s) = 3(1-p_0)s^2$。在 $s=1$ 时，均值为 $\\mu = G'(1) = 3(1-p_0)$。当 $p_0 = 3/7$ 时，均值为 $\\mu = 3(1 - 3/7) = 3(4/7) = 12/7$。由于 $\\mu > 1$，灭绝概率不为 1，这与给定信息 $\\pi = 1/2 < 1$ 一致。不动点方程为 $s = \\frac{3}{7} + \\frac{4}{7}s^3$，即 $7s = 3 + 4s^3$，也就是 $4s^3 - 7s + 3 = 0$。我们知道 $s=1$ 恒为一个根。从我们的计算中，我们还知道 $s=1/2$ 也是一个根。由于这个三次方程的根之和为 0（因为 $s^2$ 的系数为零），第三个根必为 $-(1+1/2) = -3/2$。非负根是 $1/2$ 和 $1$。灭绝概率是其中最小的，即 $1/2$。这证实了我们的结果是正确的。", "answer": "$$\\boxed{\\frac{3}{7}}$$", "id": "1362118"}]}