{"hands_on_practices": [{"introduction": "我们从一个基本问题开始：经过几代之后，一个种群的平均规模会是多大？这个练习将引导你使用后代分布的均值来预测未来几代种群的期望大小。这是理解分支过程增长动态的基础，也是评估一个新突变或种群能否在初期立足的关键第一步 [@problem_id:1285799]。", "problem": "一位生物学家正在研究一种新发现的无害基因突变。研究始于单个生物体，该生物体构成第0代。该生物体及其后代根据特定的概率规则传递该突变。任何单个亲本遗传该突变的直接后代数量 $k$ 是一个服从几何分布的随机变量。该分布的概率质量函数由下式给出：\n$$P(\\text{k offspring}) = (1-p)^k p$$\n其中 $k = 0, 1, 2, \\dots$。\n\n对于此特定突变，参数 $p$ 已确定为 $p = 1/3$。假设所有个体的繁殖过程都是独立的，并遵循相同的分布。\n\n在第四代中，携带该突变的生物体的期望数量是多少？", "solution": "设 $K$ 表示单个个体的突变后代数量。根据假设， $K$ 服从在 $\\{0,1,2,\\dots\\}$ 上的几何分布，其概率质量函数为\n$$\n\\Pr(K=k) = (1-p)^{k} p, \\quad k=0,1,2,\\dots\n$$\n其均值为\n$$\n\\mathbb{E}[K] = \\sum_{k=0}^{\\infty} k \\, p (1-p)^{k}.\n$$\n设 $r = 1-p$ 且 $|r|<1$。几何级数满足\n$$\n\\sum_{k=0}^{\\infty} r^{k} = \\frac{1}{1-r}.\n$$\n对 $r$ 求导可得\n$$\n\\sum_{k=1}^{\\infty} k r^{k-1} = \\frac{1}{(1-r)^{2}},\n$$\n两边同乘以 $r$ 可得\n$$\n\\sum_{k=1}^{\\infty} k r^{k} = \\frac{r}{(1-r)^{2}}.\n$$\n因此，\n$$\n\\mathbb{E}[K] = p \\sum_{k=0}^{\\infty} k r^{k} = p \\cdot \\frac{r}{(1-r)^{2}} = p \\cdot \\frac{1-p}{p^{2}} = \\frac{1-p}{p}.\n$$\n对于一个 Galton–Watson 分支过程，其后代数量是独立同分布的，均值为 $m=\\mathbb{E}[K]$。如果 $Z_{n}$ 表示第 $n$ 代的个体数量，且 $Z_{0}=1$，则\n$$\n\\mathbb{E}[Z_{n+1} \\mid Z_{n}] = Z_{n} \\, m \\quad \\Longrightarrow \\quad \\mathbb{E}[Z_{n+1}] = m \\, \\mathbb{E}[Z_{n}],\n$$\n因此通过归纳法，\n$$\n\\mathbb{E}[Z_{n}] = m^{n}.\n$$\n这里 $p=\\frac{1}{3}$，因此\n$$\nm = \\frac{1-p}{p} = \\frac{1-\\frac{1}{3}}{\\frac{1}{3}} = \\frac{\\frac{2}{3}}{\\frac{1}{3}} = 2.\n$$\n对于第四代（$n=4$），\n$$\n\\mathbb{E}[Z_{4}] = 2^{4} = 16.\n$$", "answer": "$$\\boxed{16}$$", "id": "1285799"}, {"introduction": "了解期望种群规模很有用，但一个种群的最终命运——是永久存续还是最终灭绝——通常是更重要的问题。这个练习引入了灭绝概率的核心概念，并演示了如何使用强大的概率生成函数（PGF）来计算它。通过这个例子，你将学会判断一个过程是注定消亡，还是有潜力无限增长 [@problem_id:1285810]。", "problem": "一个“数码克隆”（一种自我复制的数字实体）的增殖简化模型可以用一个分支过程来描述。在每一代中，每个现有的数码克隆都尝试在不同的网络节点上创建两个自己的新副本。每次创建尝试都是独立的，且成功的概率为 $p=0.6$。在复制尝试之后，原始的数码克隆会失活。该过程从第0代开始，初始只有一个数码克隆。灭绝是指其数码克隆种群最终变为零的事件。计算最终灭绝的概率。将最终答案表示为最简形式的精确分数。", "solution": "将每个数码克隆的后代数量建模为一个 Galton–Watson 分支过程。每个数码克隆进行两次独立的复制尝试，每次成功的概率为 $p=0.6$，因此后代的数量 $X$ 服从二项分布 $X \\sim \\mathrm{Binomial}(2,p)$。$X$ 的概率生成函数为\n$$\nf(s)=\\sum_{k=0}^{2} \\binom{2}{k} p^{k} (1-p)^{2-k} s^{k}=(1-p+ps)^{2}.\n$$\n灭绝概率 $q$ 是不动点方程\n$$\nq=f(q).\n$$\n在 $[0,1]$ 区间内的最小解。\n因此，\n$$\nq=(1-p+pq)^{2}.\n$$\n将 $p=\\frac{3}{5}$（因为 $0.6=\\frac{3}{5}$）代入可得\n$$\nq=\\left(\\frac{2}{5}+\\frac{3}{5}q\\right)^{2}=\\frac{4}{25}+\\frac{12}{25}q+\\frac{9}{25}q^{2}.\n$$\n整理可得\n$$\n0=\\frac{4}{25}+\\frac{12}{25}q+\\frac{9}{25}q^{2}-q,\n$$\n两边乘以 $25$ 可得\n$$\n0=4+12q+9q^{2}-25q=4-13q+9q^{2}.\n$$\n解二次方程 $9q^{2}-13q+4=0$：\n$$\nq=\\frac{13\\pm\\sqrt{13^{2}-4\\cdot 9\\cdot 4}}{2\\cdot 9}=\\frac{13\\pm\\sqrt{169-144}}{18}=\\frac{13\\pm 5}{18}.\n$$\n因此，两个不动点是 $q=\\frac{18}{18}=1$ 和 $q=\\frac{8}{18}=\\frac{4}{9}$。因为平均后代数为 $2p=\\frac{6}{5}>1$，所以灭绝概率是较小的不动点，即 $q=\\frac{4}{9}$。", "answer": "$$\\boxed{\\frac{4}{9}}$$", "id": "1285810"}, {"introduction": "接下来，让我们探讨一个更微妙的情景。如果我们观察到一个种群已经成功存活了数代，这一信息将如何改变我们对其最终命运的预测？这个练习要求你计算一个条件灭绝概率，将你对概率生成函数的知识与条件概率的规则相结合，从而更深入地理解分支过程的随机行为 [@problem_id:1346919]。", "problem": "在一个受控的数字环境中，研究一个合成的“数字复制子”种群。该过程始于单个复制子，它构成第零代。每个复制子在其生命周期结束时，会独立于所有其他复制子产生一定数量的后代。任何给定复制子的后代数量是一个随机变量，受固定的概率分布支配。对于这种特定类型的复制子，它要么繁殖失败，产生0个后代，概率为$1/3$；要么成功分裂，产生恰好2个新后代，概率为$2/3$。繁殖没有其他可能的结果。\n\n令$Z_n$为第$n$代中的复制子数量，该过程从单个祖先开始，即$Z_0=1$。\n\n计算在该复制子种群的第二代（$Z_2$）至少包含一个复制子的条件下，该种群最终灭绝的概率。将你的最终答案表示为一个精确的分数。", "solution": "设$X$为单个复制子的后代数，其分布为$\\mathbb{P}(X=0)=\\frac{1}{3}$和$\\mathbb{P}(X=2)=\\frac{2}{3}$。其概率母函数为\n$$\nf(s)=\\frac{1}{3}+\\frac{2}{3}s^{2}.\n$$\n从一个祖先开始的灭绝概率$q$是$s=f(s)$在$[0,1]$中的最小解：\n$$\ns=\\frac{1}{3}+\\frac{2}{3}s^{2}\\quad\\Longleftrightarrow\\quad 2s^{2}-3s+1=0,\n$$\n其根为$s=\\frac{1}{2}$和$s=1$，因此$q=\\frac{1}{2}$。\n\n在Galton–Watson过程中，以$Z_{n}=k$为条件，由于各世系的独立性，最终灭绝的概率为$q^{k}$。因此，\n$$\n\\mathbb{P}(\\text{extinction}\\mid Z_{2}>0)=\\mathbb{E}\\big[q^{Z_{2}}\\mid Z_{2}>0\\big].\n$$\n\n我们计算$Z_{2}$的分布。首先，$Z_{1}=0$的概率为$\\frac{1}{3}$，$Z_{1}=2$的概率为$\\frac{2}{3}$。如果$Z_{1}=0$，则$Z_{2}=0$。如果$Z_{1}=2$，这两个个体独立地产生0个或2个后代，因此\n$$\n\\mathbb{P}(Z_{2}=0\\mid Z_{1}=2)=\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{9},\\quad\n\\mathbb{P}(Z_{2}=2\\mid Z_{1}=2)=2\\cdot\\frac{1}{3}\\cdot\\frac{2}{3}=\\frac{4}{9},\\quad\n\\mathbb{P}(Z_{2}=4\\mid Z_{1}=2)=\\left(\\frac{2}{3}\\right)^{2}=\\frac{4}{9}.\n$$\n因此，无条件概率为\n$$\n\\mathbb{P}(Z_{2}=0)=\\frac{1}{3}+\\frac{2}{3}\\cdot\\frac{1}{9}=\\frac{11}{27},\\quad\n\\mathbb{P}(Z_{2}=2)=\\frac{2}{3}\\cdot\\frac{4}{9}=\\frac{8}{27},\\quad\n\\mathbb{P}(Z_{2}=4)=\\frac{2}{3}\\cdot\\frac{4}{9}=\\frac{8}{27},\n$$\n所以\n$$\n\\mathbb{P}(Z_{2}>0)=1-\\frac{11}{27}=\\frac{16}{27}.\n$$\n\n使用$q=\\frac{1}{2}$，我们有\n$$\n\\mathbb{P}(\\text{extinction and }Z_{2}>0)=\\sum_{n\\in\\{2,4\\}}\\mathbb{P}(Z_{2}=n)\\,q^{n}\n=\\frac{8}{27}\\left(\\left(\\frac{1}{2}\\right)^{2}+\\left(\\frac{1}{2}\\right)^{4}\\right)\n=\\frac{8}{27}\\left(\\frac{1}{4}+\\frac{1}{16}\\right)\n=\\frac{8}{27}\\cdot\\frac{5}{16}\n=\\frac{5}{54}.\n$$\n因此，\n$$\n\\mathbb{P}(\\text{extinction}\\mid Z_{2}>0)=\\frac{\\frac{5}{54}}{\\frac{16}{27}}=\\frac{5}{32}.\n$$", "answer": "$$\\boxed{\\frac{5}{32}}$$", "id": "1346919"}]}