{"hands_on_practices": [{"introduction": "将条件期望视为一种几何投影，其一个基本性质便是线性。这个练习旨在验证条件期望算子确实满足线性，即一个线性组合的投影等于其各个分量投影的线性组合。通过解决这个问题，你将巩固对条件期望作为 $L^2$ 空间中线性算子的理解。[@problem_id:1350188]", "problem": "设 $(\\Omega, \\mathcal{F}, P)$ 是一个概率空间，令 $L^2(\\Omega, \\mathcal{F}, P)$ 是此空间上平方可积随机变量的希尔伯特空间，其内积为 $\\langle X, Y \\rangle = E[XY]$。设 $\\mathcal{G}$ 是 $\\mathcal{F}$ 的一个子$\\sigma$-代数。一个已知的结论是，条件期望算子 $E[\\cdot | \\mathcal{G}]$ 是从 $L^2(\\Omega, \\mathcal{F}, P)$ 到其闭子空间 $L^2(\\Omega, \\mathcal{G}, P)$ 的正交投影。\n\n我们将随机变量 $Z \\in L^2(\\Omega, \\mathcal{F}, P)$ 到子空间 $L^2(\\Omega, \\mathcal{G}, P)$ 的正交投影记为 $P_{\\mathcal{G}}(Z)$。根据上述内容，我们有恒等式 $P_{\\mathcal{G}}(Z) = E[Z | \\mathcal{G}]$。\n\n考虑两个任意的随机变量 $X, Y \\in L^2(\\Omega, \\mathcal{F}, P)$ 和一个任意的非零实常数 $c$。下列哪个表达式正确地表示了线性组合 $X + cY$ 到子空间 $L^2(\\Omega, \\mathcal{G}, P)$ 的投影？\n\nA. $P_{\\mathcal{G}}(X) + P_{\\mathcal{G}}(Y)$\n\nB. $P_{\\mathcal{G}}(X) + c P_{\\mathcal{G}}(Y)$\n\nC. $P_{\\mathcal{G}}(X) + c^2 P_{\\mathcal{G}}(Y)$\n\nD. $|c| P_{\\mathcal{G}}(X) + \\sqrt{1-c^2} P_{\\mathcal{G}}(Y)$\n\nE. $c P_{\\mathcal{G}}(X) + P_{\\mathcal{G}}(Y)$\n\nF. 该表达式取决于 $X$ 和 $Y$ 之间的相关性，无法一概而论。", "solution": "我们使用到闭子空间 $L^{2}(\\Omega, \\mathcal{G}, P)$ 的正交投影的刻画：对于任意 $Z \\in L^{2}(\\Omega, \\mathcal{F}, P)$，其投影 $U = P_{\\mathcal{G}}(Z) \\in L^{2}(\\Omega, \\mathcal{G}, P)$ 是满足下式的唯一元素：\n$$\nE\\big[(Z - U)H\\big] = 0 \\quad \\text{对于所有 } H \\in L^{2}(\\Omega, \\mathcal{G}, P).\n$$\n等价地，由于 $P_{\\mathcal{G}}(Z) = E[Z \\mid \\mathcal{G}]$，当 $U = E[Z \\mid \\mathcal{G}]$ 时，同样的正交性也成立。\n\n设 $U_{X} = P_{\\mathcal{G}}(X) = E[X \\mid \\mathcal{G}]$ 且 $U_{Y} = P_{\\mathcal{G}}(Y) = E[Y \\mid \\mathcal{G}]$。对于任意 $H \\in L^{2}(\\Omega, \\mathcal{G}, P)$，根据正交性的定义我们有\n$$\nE\\big[(X - U_{X})H\\big] = 0, \\qquad E\\big[(Y - U_{Y})H\\big] = 0.\n$$\n固定一个任意实常数 $c \\neq 0$ (该论证对 $c = 0$ 也成立）。考虑 $Z = X + cY$ 和候选者\n$$\nU := U_{X} + c\\,U_{Y} \\in L^{2}(\\Omega, \\mathcal{G}, P).\n$$\n那么，对于任意 $H \\in L^{2}(\\Omega, \\mathcal{G}, P)$，\n$$\nE\\big[(Z - U)H\\big] = E\\big[(X + cY - U_{X} - cU_{Y})H\\big]\n= E\\big[(X - U_{X})H\\big] + c\\,E\\big[(Y - U_{Y})H\\big] = 0 + c \\cdot 0 = 0.\n$$\n根据正交投影的唯一性，这意味着 $U = P_{\\mathcal{G}}(Z)$，因此\n$$\nP_{\\mathcal{G}}(X + cY) = P_{\\mathcal{G}}(X) + c\\,P_{\\mathcal{G}}(Y).\n$$\n等价地，根据条件期望的线性性质，\n$$\nE[X + cY \\mid \\mathcal{G}] = E[X \\mid \\mathcal{G}] + c\\,E[Y \\mid \\mathcal{G}],\n$$\n这与选项B相符。", "answer": "$$\\boxed{B}$$", "id": "1350188"}, {"introduction": "条件期望的投影观点在解决实际优化问题时尤为强大，例如在信号处理中寻找最佳线性估计。这个问题将抽象的理论置于一个具体的应用场景中：如何利用已知信号来最好地估计一个未知信号。你将看到，最小化均方误差等价于将被估计的信号（一个随机变量）投影到由参考信号张成的子空间上，而正交性原理为我们提供了一个直接的求解方法。[@problem_id:1350189]", "problem": "在信号处理中，一个常见的任务是从其他可获取的测量中估计一个感兴趣的信号 $S$。我们可以将信号 $S$ 和两个参考信号 $R_1$ 与 $R_2$ 建模为随机变量。对于本问题，假设所有信号都经过处理，其均值为零。这些随机变量是平方可积随机变量空间 $L^2$ 中的元素，其内积由 $\\langle A, B \\rangle = E[AB]$ 给出。\n\n目标是利用 $R_1$ 和 $R_2$ 找到 $S$ 的最佳线性估计。最佳线性估计是一个形式为 $\\hat{S} = a_1 R_1 + a_2 R_2$ 的随机变量，其中实系数 $a_1$ 和 $a_2$ 的选择旨在最小化均方误差 $E[(S - \\hat{S})^2]$。这个最优估计 $\\hat{S}$ 对应于 $S$ 在由 $\\{R_1, R_2\\}$ 张成的线性子空间上的正交投影。\n\n假设已知信号的以下统计特性：\n- $E[S^2] = 16$\n- $E[R_1^2] = 4$\n- $E[R_2^2] = 9$\n- $E[SR_1] = 3$\n- $E[SR_2] = -1$\n- $E[R_1 R_2] = 2$\n\n计算均方误差 $E[(S - \\hat{S})^2]$ 的最小可能值。", "solution": "我们在希尔伯特空间 $L^{2}$ 中进行研究，其内积为 $\\langle A,B\\rangle=E[AB]$。最佳线性估计 $\\hat{S}=a_{1}R_{1}+a_{2}R_{2}$ 是 $S$ 在 $\\operatorname{span}\\{R_{1},R_{2}\\}$ 上的正交投影，其特点是满足正交性条件 $E[(S-\\hat{S})R_{i}]=0$（对于 $i=1,2$）。\n\n定义系数向量 $a=\\begin{pmatrix}a_{1}\\\\ a_{2}\\end{pmatrix}$，协方差矩阵\n$$\nR=\\begin{pmatrix}\nE[R_{1}^{2}] & E[R_{1}R_{2}]\\\\\nE[R_{1}R_{2}] & E[R_{2}^{2}]\n\\end{pmatrix}\n=\\begin{pmatrix}\n4 & 2\\\\\n2 & 9\n\\end{pmatrix},\n$$\n以及互协方差向量\n$$\nc=\\begin{pmatrix}\nE[SR_{1}]\\\\\nE[SR_{2}]\n\\end{pmatrix}\n=\\begin{pmatrix}\n3\\\\\n-1\n\\end{pmatrix}.\n$$\n均方误差作为 $a$ 的函数是\n$$\nE[(S-\\hat{S})^{2}]=E[S^{2}]-2a^{T}c+a^{T}Ra.\n$$\n对 $a$ 进行最小化可得到正规方程组 $Ra=c$。由于 $\\det(R)=4\\cdot 9-2^{2}=32>0$，因此 $R$ 是可逆的，并且唯一的最小化向量是 $a=R^{-1}c$。将其代回误差表达式，得到最小均方误差\n$$\nE[(S-\\hat{S})^{2}]_{\\min}=E[S^{2}]-c^{T}R^{-1}c.\n$$\n\n计算 $R^{-1}$。对于 $R=\\begin{pmatrix}4&2\\\\2&9\\end{pmatrix}$，\n$$\nR^{-1}=\\frac{1}{32}\\begin{pmatrix}9 & -2\\\\ -2 & 4\\end{pmatrix}.\n$$\n则\n$$\nR^{-1}c=\\frac{1}{32}\\begin{pmatrix}9 & -2\\\\ -2 & 4\\end{pmatrix}\\begin{pmatrix}3\\\\ -1\\end{pmatrix}\n=\\frac{1}{32}\\begin{pmatrix}27+2\\\\ -6-4\\end{pmatrix}\n=\\begin{pmatrix}\\frac{29}{32}\\\\ -\\frac{5}{16}\\end{pmatrix},\n$$\n以及\n$$\nc^{T}R^{-1}c=\\begin{pmatrix}3 & -1\\end{pmatrix}\\begin{pmatrix}\\frac{29}{32}\\\\ -\\frac{5}{16}\\end{pmatrix}\n=\\frac{87}{32}+\\frac{5}{16}\n=\\frac{97}{32}.\n$$\n已知 $E[S^{2}]=16$，最小均方误差为\n$$\nE[(S-\\hat{S})^{2}]_{\\min}=16-\\frac{97}{32}\n=\\frac{512}{32}-\\frac{97}{32}\n=\\frac{415}{32}.\n$$", "answer": "$$\\boxed{\\frac{415}{32}}$$", "id": "1350189"}, {"introduction": "现实世界中的优化问题常常带有约束条件。这个问题提升了难度，要求你在寻找最佳逼近时，不仅要满足可测性（即函数形式）的约束，还要满足一个关于期望值的额外约束。通过解决这个带约束的最小化问题，你将学会如何将复杂的优化任务转化为几何投影，这深刻地揭示了该方法在处理更高级问题时的灵活性和强大威力。[@problem_id:1350191]", "problem": "考虑一个概率空间 $(\\Omega, \\mathcal{F}, P)$，其中 $\\Omega = [0,1] \\times [0,1]$ 是平面上的单位正方形，$\\mathcal{F}$ 是 $\\Omega$ 上的 Borel $\\sigma$-代数，而 $P$ 是均匀概率测度（即正方形上的 Lebesgue 测度）。$\\Omega$ 中的一个点用 $(\\omega_1, \\omega_2)$ 表示。\n\n在此空间上定义了一个随机变量 $X$，其函数为 $X(\\omega_1, \\omega_2) = 6\\omega_1^2 + 12\\omega_2$。\n\n我们寻求一个随机变量 $Y$，它在一组约束条件下可作为 $X$ 的“最佳近似”。近似的质量由均方误差 $E[(X-Y)^2]$ 来衡量。找出能最小化该量且同时满足以下两个条件的随机变量 $Y$：\n\n1.  在任意点 $(\\omega_1, \\omega_2)$ 处，$Y$ 的值必须仅依赖于第一个坐标 $\\omega_1$ 的值。也就是说，$Y$ 必须具有 $Y(\\omega_1, \\omega_2) = g(\\omega_1)$ 的形式，其中 $g$ 是某个函数。\n2.  $Y$ 的期望值必须恰好为 5，即 $E[Y] = 5$。\n\n确定这个最优随机变量 $Y$ 作为 $\\omega_1$ 和 $\\omega_2$ 的函数的表达式。", "solution": "我们通过在希尔伯特空间 $L^{2}(\\Omega,\\mathcal{F},P)$ 中进行投影，来最小化受约束的均方误差。容许的随机变量集合为 $\\{Y:Y(\\omega_{1},\\omega_{2})=g(\\omega_{1}),\\ \\mathbb{E}[Y]=5\\}$。\n\n为 $g$ 和乘子 $\\lambda$ 建立拉格朗日泛函：\n$$\n\\mathcal{L}(g,\\lambda)=\\mathbb{E}\\big[(X-g(\\omega_{1}))^{2}\\big]+2\\lambda\\big(\\mathbb{E}[g(\\omega_{1})]-5\\big).\n$$\n对于任何容许的扰动 $h(\\omega_{1})$，一阶最优性条件是\n$$\n\\frac{d}{d\\epsilon}\\Big|_{\\epsilon=0}\\mathcal{L}(g+\\epsilon h,\\lambda)\n=-2\\mathbb{E}\\big[(X-g(\\omega_{1}))h(\\omega_{1})\\big]+2\\lambda\\,\\mathbb{E}[h(\\omega_{1})]=0,\n$$\n这等价于\n$$\n\\mathbb{E}\\big[(g(\\omega_{1})-X+\\lambda)h(\\omega_{1})\\big]=0\\quad\\text{for all }h(\\omega_{1}).\n$$\n由于这对每一个关于 $\\omega_{1}$ 可测的 $h$ 都成立，它意味着\n$$\n\\mathbb{E}\\big[g(\\omega_{1})-X+\\lambda\\mid \\omega_{1}\\big]=0\n\\quad\\Longrightarrow\\quad\ng(\\omega_{1})=\\mathbb{E}[X\\mid \\omega_{1}]-\\lambda.\n$$\n使用 $\\omega_{1},\\omega_{2}$ 的独立性和均匀性来计算条件期望：\n$$\n\\mathbb{E}[X\\mid \\omega_{1}]\n=\\mathbb{E}[6\\omega_{1}^{2}+12\\omega_{2}\\mid \\omega_{1}]\n=6\\omega_{1}^{2}+12\\,\\mathbb{E}[\\omega_{2}]\n=6\\omega_{1}^{2}+6,\n$$\n因为 $\\mathbb{E}[\\omega_{2}]=\\frac{1}{2}$。因此\n$$\ng(\\omega_{1})=6\\omega_{1}^{2}+6-\\lambda.\n$$\n施加均值约束 $\\mathbb{E}[g(\\omega_{1})]=5$：\n$$\n5=\\mathbb{E}[g(\\omega_{1})]=\\mathbb{E}[6\\omega_{1}^{2}+6]-\\lambda\n=6\\,\\mathbb{E}[\\omega_{1}^{2}]+6-\\lambda.\n$$\n由于 $\\mathbb{E}[\\omega_{1}^{2}]=\\int_{0}^{1}x^{2}\\,dx=\\frac{1}{3}$，我们得到\n$$\n5=6\\cdot\\frac{1}{3}+6-\\lambda=2+6-\\lambda=8-\\lambda\\quad\\Longrightarrow\\quad \\lambda=3.\n$$\n因此，最优的随机变量是\n$$\nY(\\omega_{1},\\omega_{2})=g(\\omega_{1})=6\\omega_{1}^{2}+6-3=6\\omega_{1}^{2}+3,\n$$\n它只依赖于 $\\omega_{1}$ 并且满足 $\\mathbb{E}[Y]=6\\,\\mathbb{E}[\\omega_{1}^{2}]+3=2+3=5$。由于目标函数是严格凸的，且可行集是凸的，所以这个解是唯一的极小化子。", "answer": "$$\\boxed{6\\omega_{1}^{2}+3}$$", "id": "1350191"}]}