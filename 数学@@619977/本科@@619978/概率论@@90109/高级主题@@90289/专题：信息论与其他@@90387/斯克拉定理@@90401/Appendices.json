{"hands_on_practices": [{"introduction": "在我们应用 Sklar 定理解决实际问题之前，首先必须深刻理解其核心构件——copula 函数的定义。一个函数要成为一个有效的 copula，它必须满足一组特定的数学公理。这个练习旨在通过检验一个候选函数是否符合这些基本规则，来巩固你对 copula 公理的理解 [@problem_id:1387889]。这就像在学习下棋前先要了解每个棋子的走法一样，是掌握该工具的关键第一步。", "problem": "在概率论中，一个二元 copula 是一个函数 $C: [0, 1]^2 \\to [0, 1]$，它将单变量边缘分布与其完整的联合分布连接起来。一个函数要成为一个有效的二元 copula，必须满足以下三条公理：\n\n1.  **边界条件 (归零性):** 对于任意 $u, v \\in [0, 1]$，\n    $C(u, 0) = 0$ 且 $C(0, v) = 0$。\n\n2.  **边界条件 (边缘性):** 对于任意 $u, v \\in [0, 1]$，\n    $C(u, 1) = u$ 且 $C(1, v) = v$。\n\n3.  **2-递增性质:** 对于任意满足 $0 \\le u_1 \\le u_2 \\le 1$ 和 $0 \\le v_1 \\le v_2 \\le 1$ 的矩形 $[u_1, u_2] \\times [v_1, v_2]$，copula 赋予该矩形的体积（称为 $C$-体积）必须为非负。即，\n    $C(u_2, v_2) - C(u_2, v_1) - C(u_1, v_2) + C(u_1, v_1) \\ge 0$。\n\n考虑在定义域 $[0, 1]^2$ 上定义的函数 $F(u, v) = u \\sqrt{v}$。请确定该函数违反了有效 copula 的哪一条公理。\n\nA. 条件 $C(u, 0) = 0$。\n\nB. 条件 $C(u, 1) = u$。\n\nC. 条件 $C(1, v) = v$。\n\nD. 2-递增性质。\n\nE. 该函数是一个有效的 copula；没有违反任何性质。", "solution": "我们已知在 $[0,1]^{2}$ 上的函数 $F(u,v)=u\\sqrt{v}$，需要检查所列出的三条 copula 公理。\n\n首先是边界条件（归零性）：对于任意 $u,v\\in[0,1]$，\n$$\nF(u,0)=u\\sqrt{0}=0,\\quad F(0,v)=0\\cdot\\sqrt{v}=0,\n$$\n因此归零性条件成立。\n\n其次是边界条件（边缘性）：对于任意 $u,v\\in[0,1]$，\n$$\nF(u,1)=u\\sqrt{1}=u,\n$$\n这满足 $C(u,1)=u$。然而，\n$$\nF(1,v)=1\\cdot\\sqrt{v}=\\sqrt{v},\n$$\n当 $v\\in(0,1)$ 时，$\\sqrt{v}\\neq v$，因此条件 $C(1,v)=v$ 被违反。\n\n2-递增性质：对于任意满足 $0\\leq u_{1}\\leq u_{2}\\leq 1$ 和 $0\\leq v_{1}\\leq v_{2}\\leq 1$ 的矩形 $[u_{1},u_{2}]\\times[v_{1},v_{2}]$，其 $F$-体积为\n$$\nF(u_{2},v_{2})-F(u_{2},v_{1})-F(u_{1},v_{2})+F(u_{1},v_{1})\n= u_{2}\\sqrt{v_{2}}-u_{2}\\sqrt{v_{1}}-u_{1}\\sqrt{v_{2}}+u_{1}\\sqrt{v_{1}}\n= (u_{2}-u_{1})\\bigl(\\sqrt{v_{2}}-\\sqrt{v_{1}}\\bigr)\\geq 0,\n$$\n因为 $u_{2}\\geq u_{1}$ 且 $\\sqrt{v_{2}}\\geq\\sqrt{v_{1}}$。因此 2-递增性质成立。\n\n因此，唯一被违反的公理是边缘条件 $C(1,v)=v$。", "answer": "$$\\boxed{C}$$", "id": "1387889"}, {"introduction": "理解了 copula 的定义性公理后，下一步是将其付诸实践。Copula 函数在金融风险管理等领域有着广泛应用，用于模拟不同资产或事件之间的依赖关系。本练习将带你使用一个具体的 Archimedean copula——Joe copula，来计算一个实际场景中的联合违约概率 [@problem_id:1387879]。通过这个计算，你将直观地看到 copula 如何将边缘概率（$u$ 和 $v$）与一个特定的依赖结构（由参数 $\\theta$ 控制）结合起来，从而得到联合概率。", "problem": "在金融风险管理中，copula函数用于为不同随机变量之间的相依性建模，例如多个贷款的违约时间。Sklar定理指出，任何多元累积分布函数 $H(x_1, \\dots, x_d)$ 都可以用其边际累积分布函数 $F_1(x_1), \\dots, F_d(x_d)$ 和一个copula函数 $C$ 来表示，即 $H(x_1, \\dots, x_d) = C(F_1(x_1), \\dots, F_d(x_d))$。\n\n考虑一个包含两笔贷款的投资组合，其违约时间由随机变量 $X$ 和 $Y$ 表示。这些违约之间的相依性使用一种称为Joe copula的特定类型阿基米德copula进行建模，对于两个变量其定义如下：\n$$C(u, v) = 1 - \\left( (1-u)^\\theta + (1-v)^\\theta - (1-u)^\\theta (1-v)^\\theta \\right)^{1/\\theta}$$\n其中 $u = F_X(x)$ 和 $v = F_Y(y)$ 是边际概率，$\\theta \\ge 1$ 是一个控制相依性强度的参数。\n\n对于某一对特定的贷款，一位分析师确定参数为 $\\theta = 2$ 的Joe copula是一个合适的模型。我们关心的是两笔贷款都在其中位违约时间之前违约的联合概率。根据定义，一笔贷款的中位违约时间对应于其累积违约概率恰好为0.5的时间 $t$。假设两笔贷款的中位违约时间相同，计算两笔贷款都在此中位时间之前违约的联合概率。将您的答案表示为保留三位有效数字的小数。", "solution": "我们已知两个变量的Joe copula为，\n$$\nC(u,v)=1-\\left((1-u)^{\\theta}+(1-v)^{\\theta}-(1-u)^{\\theta}(1-v)^{\\theta}\\right)^{1/\\theta},\n$$\n参数为 $\\theta=2$。两笔贷款都在其中位时间之前违约的联合概率，对应于在 $u=v=\\frac{1}{2}$ 处计算copula的值，因为根据定义，中位时间 $t_{m}$ 满足 $F_{X}(t_{m})=F_{Y}(t_{m})=\\frac{1}{2}$。\n\n代入 $u=v=\\frac{1}{2}$ 和 $\\theta=2$：\n$$\nC\\!\\left(\\tfrac{1}{2},\\tfrac{1}{2}\\right)\n=1-\\left(\\left(1-\\tfrac{1}{2}\\right)^{2}+\\left(1-\\tfrac{1}{2}\\right)^{2}-\\left(1-\\tfrac{1}{2}\\right)^{2}\\left(1-\\tfrac{1}{2}\\right)^{2}\\right)^{1/2}.\n$$\n计算各个部分：\n$$\n1-\\tfrac{1}{2}=\\tfrac{1}{2},\\quad \\left(\\tfrac{1}{2}\\right)^{2}=\\tfrac{1}{4}.\n$$\n因此括号内的和为\n$$\n\\tfrac{1}{4}+\\tfrac{1}{4}-\\tfrac{1}{4}\\cdot\\tfrac{1}{4}\n=\\tfrac{1}{2}-\\tfrac{1}{16}\n=\\tfrac{8-1}{16}\n=\\tfrac{7}{16}.\n$$\n取 $1/2$ 次方，\n$$\n\\left(\\tfrac{7}{16}\\right)^{1/2}=\\sqrt{\\tfrac{7}{16}}=\\frac{\\sqrt{7}}{4}.\n$$\n因此，\n$$\nC\\!\\left(\\tfrac{1}{2},\\tfrac{1}{2}\\right)=1-\\frac{\\sqrt{7}}{4}.\n$$\n数值上，\n$$\n1-\\frac{\\sqrt{7}}{4}\\approx 1-0.6614378275=0.3385621725,\n$$\n保留三位有效数字后为 $0.339$。", "answer": "$$\\boxed{0.339}$$", "id": "1387879"}, {"introduction": "Copula 理论的一个强大之处在于它能将依赖结构与边缘分布分离开来，并与我们熟悉的统计量建立深刻联系。Spearman 秩相关系数 $\\rho_S$ 就是一个经典的例子，它是一种非参数的依赖度量。这个挑战性的练习将引导你推导出 $\\rho_S$ 如何完全由其底层的 copula 函数 $C(u,v)$ 决定 [@problem_id:1387887]。完成这个推导，你将揭示出 Spearman 秩相关系数的本质——一个独立于边缘分布的、纯粹的依赖度量。", "problem": "设 $(X, Y)$ 是一对连续随机变量，其边际累积分布函数 (CDF) 分别为 $F_X(x)$ 和 $F_Y(y)$，联合累积分布函数为 $H(x,y)$。\n\nSpearman 秩相关系数 $\\rho_S(X,Y)$ 定义为对概率积分变换后的变量 $U = F_X(X)$ 和 $V = F_Y(Y)$ 的 Pearson 相关系数。其定义由下式给出：\n$$\n\\rho_S(X, Y) = \\rho(U, V) = \\frac{\\text{Cov}(U,V)}{\\sqrt{\\text{Var}(U)\\text{Var}(V)}}\n$$\n\n根据 Sklar 定理，对于连续随机变量，存在一个唯一的函数 $C: [0,1]^2 \\to [0,1]$，称为 copula，它将联合累积分布函数与其边际分布函数联系起来。这个 copula 本身就是随机向量 $(U,V)$ 的联合累积分布函数，使得 $P(U \\le u, V \\le v) = C(u,v)$。\n\n使用这些定义，推导 Spearman 秩相关系数 $\\rho_S$ 的表达式，该表达式应为一个仅包含 copula 函数 $C(u,v)$ 和基本数学常数的泛函。你的最终表达式应为积分形式。", "solution": "设 $U=F_{X}(X)$ 和 $V=F_{Y}(Y)$。对于连续的边际分布，$U$ 和 $V$ 在 $[0,1]$ 上服从均匀分布，它们的联合累积分布函数是 copula $C$，所以 $P(U \\leq u, V \\leq v)=C(u,v)$。\n\n根据定义，\n$$\n\\rho_{S}(X,Y)=\\rho(U,V)=\\frac{\\operatorname{Cov}(U,V)}{\\sqrt{\\operatorname{Var}(U)\\operatorname{Var}(V)}}.\n$$\n因为 $U,V \\sim \\text{Unif}(0,1)$，我们有 $E[U]=E[V]=\\frac{1}{2}$ 并且\n$$\n\\operatorname{Var}(U)=E[U^{2}]-\\left(E[U]\\right)^{2}=\\int_{0}^{1}u^{2}\\,du-\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12},\n$$\n同样地，$\\operatorname{Var}(V)=\\frac{1}{12}$。因此 $\\sqrt{\\operatorname{Var}(U)\\operatorname{Var}(V)}=\\frac{1}{12}$。\n\n接下来，通过 $E[UV]$ 计算协方差：\n$$\n\\operatorname{Cov}(U,V)=E[UV]-E[U]E[V]=E[UV]-\\frac{1}{4}.\n$$\n使用对于 $[0,1]$ 上非负变量的期望积分表示法：\n$$\nE[UV]=\\int_{0}^{1}\\int_{0}^{1}P(U>u,V>v)\\,du\\,dv.\n$$\n根据容斥原理和 copula 的性质，\n$$\nP(U>u,V>v)=1-P(U \\leq u)-P(V \\leq v)+P(U \\leq u, V \\leq v)=1-u-v+C(u,v).\n$$\n因此，\n$$\nE[UV]=\\int_{0}^{1}\\int_{0}^{1}\\left(1-u-v+C(u,v)\\right)\\,du\\,dv\n=\\int_{0}^{1}\\int_{0}^{1}C(u,v)\\,du\\,dv,\n$$\n因为 $\\int_{0}^{1}\\int_{0}^{1}(1-u-v)\\,du\\,dv=1-\\frac{1}{2}-\\frac{1}{2}=0$。\n\n综合以上结果，\n$$\n\\operatorname{Cov}(U,V)=\\int_{0}^{1}\\int_{0}^{1}C(u,v)\\,du\\,dv-\\frac{1}{4},\n$$\n于是\n$$\n\\rho_{S}(X,Y)=\\frac{\\int_{0}^{1}\\int_{0}^{1}C(u,v)\\,du\\,dv-\\frac{1}{4}}{\\frac{1}{12}}\n=12\\int_{0}^{1}\\int_{0}^{1}C(u,v)\\,du\\,dv-3.\n$$\n等价地，使用 $\\int_{0}^{1}\\int_{0}^{1}uv\\,du\\,dv=\\frac{1}{4}$，我们可以写出\n$$\n\\rho_{S}(X,Y)=12\\int_{0}^{1}\\int_{0}^{1}\\left(C(u,v)-uv\\right)\\,du\\,dv,\n$$\n这是一个仅涉及 copula 和基本常数的积分表示。", "answer": "$$\\boxed{12\\int_{0}^{1}\\int_{0}^{1}C(u,v)\\,du\\,dv-3}$$", "id": "1387887"}]}