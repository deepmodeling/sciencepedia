{"hands_on_practices": [{"introduction": "皮尔逊相关系数是衡量线性关系的经典指标，但在变量间存在非线性关系时，它可能会产生误导。本练习旨在通过一个具体的思想实验来揭示皮尔逊相关系数的局限性。你将分析一个确定性函数关系（$Y=X^2$），计算其相关系数，并探索其背后真正的、由Copula描述的非单调依赖结构 [@problem_id:1353856]。", "problem": "一个随机变量 $X$ 服从区间 $[-1, 1]$ 上的连续均匀分布。第二个随机变量 $Y$ 由关系式 $Y = X^2$ 定义。您的任务是分析 $X$ 和 $Y$ 之间的相依性。\n\n1. 计算皮尔逊相关系数 $\\rho(X, Y)$。\n2. 变量 $X$ 和 $Y$ 是完全相依的，但它们的皮尔逊相关系数可能无法完全捕捉这种关系。其完整的相依结构由它们的copula（联结函数）描述。请确定以下哪个描述最能刻画连接 $X$ 和 $Y$ 的copula。\n\nA. 该copula表示完全正单调相依，其支集位于单位正方形的主对角线上。\n\nB. 该copula表示完全负单调相依，其支集位于单位正方形的反对角线上。\n\nC. 该copula是独立copula，其概率均匀分布在整个单位正方形上。\n\nD. 该copula表示非单调相依，其支集集中在单位正方形内的一条V形曲线上。\n\n请以一个数对的形式给出您的答案，该数对由相关系数的数值和正确选项对应的字母组成。", "solution": "设 $X$ 在 $[-1,1]$ 上均匀分布，因此其密度函数为 $f_{X}(x)=\\frac{1}{2}$，适用于 $x\\in[-1,1]$。定义 $Y=X^{2}$。皮尔逊相关系数为 $\\rho(X,Y)=\\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Y)}}$。\n\n首先计算所需的矩。由于 $X$ 关于 $0$ 对称，\n$$\n\\mathbb{E}[X]=\\int_{-1}^{1}x\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{2}}{2}\\right]_{-1}^{1}=0.\n$$\n并且，\n$$\n\\mathbb{E}[X^{2}]=\\int_{-1}^{1}x^{2}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{3}-\\left(-\\frac{1}{3}\\right)\\right)=\\frac{1}{3},\n$$\n所以 $\\mathbb{E}[Y]=\\mathbb{E}[X^{2}]=\\frac{1}{3}$。接着，\n$$\n\\mathbb{E}[X^{3}]=\\int_{-1}^{1}x^{3}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{4}}{4}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{4}-\\frac{1}{4}\\right)=0,\n$$\n因此 $\\mathbb{E}[XY]=\\mathbb{E}[X^{3}]=0$。于是，\n$$\n\\operatorname{Cov}(X,Y)=\\mathbb{E}[XY]-\\mathbb{E}[X]\\mathbb{E}[Y]=0-0\\cdot\\frac{1}{3}=0.\n$$\n为完整起见，计算方差以确认分母为正。我们有\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{1}{3},\n$$\n以及\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[X^{4}]=\\int_{-1}^{1}x^{4}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{5}}{5}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{5}-\\left(-\\frac{1}{5}\\right)\\right)=\\frac{1}{5},\n$$\n所以\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{1}{5}-\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{5}-\\frac{1}{9}=\\frac{4}{45}>0.\n$$\n所以，\n$$\n\\rho(X,Y)=\\frac{0}{\\sqrt{\\frac{1}{3}\\cdot\\frac{4}{45}}}=0.\n$$\n\n尽管 $Y$ 是 $X$ 的一个确定性函数，并且它们是完全相依的，但这种相依性在 $[-1,1]$ 上是非单调的，因此皮尔逊相关系数为零。为了确定copula，我们考虑概率积分变换 $U=F_{X}(X)$ 和 $V=F_{Y}(Y)$。对于 $x\\in[-1,1]$，\n$$\nF_{X}(x)=\\frac{x+1}{2},\\quad\\text{所以}\\quad U=\\frac{X+1}{2}.\n$$\n对于 $y\\in[0,1]$，\n$$\nF_{Y}(y)=\\mathbb{P}(X^{2}\\le y)=\\mathbb{P}(-\\sqrt{y}\\le X\\le \\sqrt{y})=\\int_{-\\sqrt{y}}^{\\sqrt{y}}\\frac{1}{2}\\,dx=\\sqrt{y},\n$$\n因此\n$$\nV=F_{Y}(Y)=\\sqrt{Y}=\\sqrt{X^{2}}=|X|.\n$$\n通过 $U$ 来表示 $X$ 可得 $X=2U-1$，所以这两个均匀分布变量之间的关系是\n$$\nV=|X|=|2U-1|.\n$$\n所以，该copula是奇异的，其支集集中在单位正方形内的V形曲线 $v=|2u-1|$ 上。这是一种非单调相依关系，对应于选项D。", "answer": "$$\\boxed{\\begin{pmatrix} 0 & D \\end{pmatrix}}$$", "id": "1353856"}, {"introduction": "理解了Copula为何重要之后，下一步是掌握其数学形式。从累积分布函数（CDF）推导概率密度函数（PDF）是一项基本技能，这对于基于似然的统计推断至关重要。本练习将引导你为Farlie-Gumbel-Morgenstern (FGM) 这一常见Copula家族推导其密度函数，从而让你熟练掌握Copula函数的核心微积分操作 [@problem_id:1353902]。", "problem": "在统计建模中，copula（联结函数）是一种多元累积分布函数，其中每个变量的边缘概率分布在区间 $[0, 1]$ 上是均匀分布。用于建模两个随机变量之间相依性的最简单的 copula 族之一是 Farlie-Gumbel-Morgenstern (FGM) 族。\n\n二元 FGM copula 的累积分布函数由下式给出：\n$$C(u,v) = uv[1+\\alpha(1-u)(1-v)]$$\n其中 $u, v \\in [0, 1]$，相依参数 $\\alpha$ 是一个满足 $|\\alpha| \\le 1$ 的实常数。\n\ncopula 密度函数，记为 $c(u,v)$，描述了一对特定值 $(u,v)$ 的相对可能性。求对应于 FGM copula 的 copula 密度函数 $c(u,v)$ 的解析表达式。", "solution": "copula 密度函数是 copula 分布函数的混合二阶偏导数：\n$$c(u,v)=\\frac{\\partial^{2}}{\\partial u \\partial v}C(u,v).$$\n给定 $C(u,v)=uv\\left[1+\\alpha(1-u)(1-v)\\right]$，首先使用乘法法则计算关于 $u$ 的偏导数：\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]+uv\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right].$$\n内部的导数是\n$$\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right]=\\alpha\\frac{\\partial}{\\partial u}\\left[(1-u)(1-v)\\right]=-\\alpha(1-v).$$\n因此，\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]-\\alpha uv(1-v).$$\n因式分解并简化：\n$$\\frac{\\partial C}{\\partial u}=v+\\alpha v(1-v)(1-2u).$$\n现在对 $v$ 求导：\n$$c(u,v)=\\frac{\\partial}{\\partial v}\\left[v+\\alpha v(1-v)(1-2u)\\right]=1+\\alpha(1-2u)\\frac{\\partial}{\\partial v}\\left[v-v^{2}\\right].$$\n由于 $\\frac{\\partial}{\\partial v}(v-v^{2})=1-2v$，我们得到\n$$c(u,v)=1+\\alpha(1-2u)(1-2v).$$", "answer": "$$\\boxed{1+\\alpha(1-2u)(1-2v)}$$", "id": "1353902"}, {"introduction": "Copula理论的一大优势是它能将抽象的依赖结构与具体、可解释的统计量联系起来。肯德尔等级相关系数 ($\\tau$) 是一个衡量变量序数关联性的重要指标。本练习展示了阿基米德Copula理论中的一个强大结论：如何直接从Copula的生成元函数 $\\phi(t)$ 推导出肯德尔 $\\tau$ 的解析表达式，为你搭建起从理论模型到实践度量的桥梁 [@problem_id:1927387]。", "problem": "在金融建模和风险管理领域，copula被用来描述随机变量之间的相关性。一类重要的copula是阿基米德族，它由一个称为生成元的函数构造而成。\n\n对于一个相关性结构由生成元为 $\\phi(t)$ 的阿基米德copula描述的连续二元分布，其总体版本的Kendall秩相关系数（记为 $\\tau$）可以通过以下公式直接从生成元计算得出：\n$$\n\\tau = 1 + 4 \\int_{0}^{1} \\frac{\\phi(t)}{\\phi'(t)} dt\n$$\n其中 $\\phi'(t)$ 是 $\\phi(t)$ 关于 $t$ 的一阶导数。\n\n考虑Clayton copula族，它是一种特定类型的阿基米德copula。Clayton族的生成元由下式给出：\n$$\n\\phi(t) = \\frac{1}{\\theta} (t^{-\\theta} - 1)\n$$\n其中 $\\theta > 0$ 是一个控制相关性强度的参数。$\\theta$ 的值越大，意味着正相关性越强。\n\n你的任务是为Clayton copula族的Kendall's tau ($\\tau$) 推导出一个关于参数 $\\theta$ 的闭式解析表达式。", "solution": "我们使用阿基米德copula的Kendall's tau公式：\n$$\n\\tau=1+4\\int_{0}^{1}\\frac{\\phi(t)}{\\phi'(t)}\\,dt,\n$$\n其中Clayton生成元为 $\\phi(t)=\\frac{1}{\\theta}\\big(t^{-\\theta}-1\\big)$，$\\theta>0$。\n\n首先计算导数：\n$$\n\\phi'(t)=\\frac{1}{\\theta}\\big(-\\theta\\big)t^{-\\theta-1}=-t^{-(\\theta+1)}.\n$$\n然后该比值化简为\n$$\n\\frac{\\phi(t)}{\\phi'(t)}=\\frac{\\frac{1}{\\theta}\\big(t^{-\\theta}-1\\big)}{-t^{-(\\theta+1)}}=\\frac{1}{\\theta}\\big(t^{\\theta+1}-t\\big).\n$$\n因此，\n$$\n\\int_{0}^{1}\\frac{\\phi(t)}{\\phi'(t)}\\,dt=\\frac{1}{\\theta}\\left(\\int_{0}^{1}t^{\\theta+1}\\,dt-\\int_{0}^{1}t\\,dt\\right)=\\frac{1}{\\theta}\\left(\\frac{1}{\\theta+2}-\\frac{1}{2}\\right).\n$$\n将结果代回到 $\\tau$ 的表达式中，\n$$\n\\tau=1+\\frac{4}{\\theta}\\left(\\frac{1}{\\theta+2}-\\frac{1}{2}\\right)=1+\\frac{4}{\\theta}\\cdot\\frac{-\\theta}{2(\\theta+2)}=1-\\frac{2}{\\theta+2}=\\frac{\\theta}{\\theta+2}.\n$$\n此式对于 $\\theta>0$ 成立，这保证了在 $t=0$ 处的可积性。", "answer": "$$\\boxed{\\frac{\\theta}{\\theta+2}}$$", "id": "1927387"}]}