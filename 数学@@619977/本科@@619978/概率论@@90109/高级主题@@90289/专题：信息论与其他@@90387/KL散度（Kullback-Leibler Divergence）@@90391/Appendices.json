{"hands_on_practices": [{"introduction": "要真正理解一个数学概念，最好的方法莫过于亲手实践。本练习将通过一个简单的硬币投掷模型，让你计算两个方向上的Kullback-Leibler (KL) 散度。通过这个计算，你将具体地体会到KL散度的一个核心特性——不对称性，并理解为何它是一种“散度”，而非像欧几里得距离那样的对称“度量”。[@problem_id:1370270]", "problem": "两位统计学家 Alice 和 Bob 的任务是为一次可能存在偏差的硬币抛掷结果创建一个概率模型。抛掷结果可以是正面 (H) 或反面 (T)。Alice 提出了一个模型，我们称之为分布 $P$，其中出现正面的概率为 $p_A = 0.2$。Bob 提出了另一个不同的模型，即分布 $Q$，其中出现正面的概率为 $p_B = 0.7$。\n\n为了量化这两个模型之间的差异，他们决定使用 Kullback-Leibler (KL) 散度，也称为相对熵。对于定义在相同概率空间 $\\mathcal{X}$ 上的两个离散概率分布 $P$ 和 $Q$，从 $Q$ 到 $P$ 的 KL 散度由以下公式给出：\n$$\nD_{KL}(P \\| Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)\n$$\n该值衡量了使用分布 $Q$ 来近似分布 $P$ 时所损失的信息量。\n\n您的任务是计算两个值：\n1. 从 Bob 的模型 ($Q$) 到 Alice 的模型 ($P$) 的 KL 散度，即 $D_{KL}(P \\| Q)$。\n2. 从 Alice 的模型 ($P$) 到 Bob 的模型 ($Q$) 的 KL 散度，即 $D_{KL}(Q \\| P)$。\n\n请按顺序计算 $D_{KL}(P \\| Q)$ 和 $D_{KL}(Q \\| P)$，并以一对数值的形式提供结果。将最终答案四舍五入至四位有效数字。", "solution": "我们将单次硬币抛掷建模为具有两个结果 $\\mathcal{X}=\\{H,T\\}$。Alice 的模型 $P$ 满足 $P(H)=p_{A}=0.2$ 且 $P(T)=1-p_{A}=0.8$。Bob 的模型 $Q$ 满足 $Q(H)=p_{B}=0.7$ 且 $Q(T)=1-p_{B}=0.3$。\n\n根据定义，对于同一空间上的离散分布，\n$$\nD_{KL}(P \\,\\|\\, Q)=\\sum_{x\\in\\mathcal{X}} P(x)\\,\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right).\n$$\n\n首先，计算 $D_{KL}(P \\,\\|\\, Q)$：\n$$\nD_{KL}(P \\,\\|\\, Q)=P(H)\\ln\\!\\left(\\frac{P(H)}{Q(H)}\\right)+P(T)\\ln\\!\\left(\\frac{P(T)}{Q(T)}\\right).\n$$\n代入 $P(H)=\\frac{1}{5}$，$Q(H)=\\frac{7}{10}$，$P(T)=\\frac{4}{5}$，$Q(T)=\\frac{3}{10}$：\n$$\nD_{KL}(P \\,\\|\\, Q)=\\frac{1}{5}\\ln\\!\\left(\\frac{\\frac{1}{5}}{\\frac{7}{10}}\\right)+\\frac{4}{5}\\ln\\!\\left(\\frac{\\frac{4}{5}}{\\frac{3}{10}}\\right)\n=\\frac{1}{5}\\ln\\!\\left(\\frac{2}{7}\\right)+\\frac{4}{5}\\ln\\!\\left(\\frac{8}{3}\\right).\n$$\n进行数值计算：\n$$\n\\frac{1}{5}\\ln\\!\\left(\\frac{2}{7}\\right)\\approx 0.2\\times(-1.2527629685)\\approx -0.2505525937,\\quad\n\\frac{4}{5}\\ln\\!\\left(\\frac{8}{3}\\right)\\approx 0.8\\times 0.9808292530\\approx 0.7846634024,\n$$\n所以\n$$\nD_{KL}(P \\,\\|\\, Q)\\approx -0.2505525937+0.7846634024\\approx 0.5341108087.\n$$\n\n接下来，计算 $D_{KL}(Q \\,\\|\\, P)$：\n$$\nD_{KL}(Q \\,\\|\\, P)=Q(H)\\ln\\!\\left(\\frac{Q(H)}{P(H)}\\right)+Q(T)\\ln\\!\\left(\\frac{Q(T)}{P(T)}\\right).\n$$\n代入 $Q(H)=\\frac{7}{10}$，$P(H)=\\frac{1}{5}$，$Q(T)=\\frac{3}{10}$，$P(T)=\\frac{4}{5}$：\n$$\nD_{KL}(Q \\,\\|\\, P)=\\frac{7}{10}\\ln\\!\\left(\\frac{\\frac{7}{10}}{\\frac{1}{5}}\\right)+\\frac{3}{10}\\ln\\!\\left(\\frac{\\frac{3}{10}}{\\frac{4}{5}}\\right)\n=\\frac{7}{10}\\ln\\!\\left(\\frac{7}{2}\\right)+\\frac{3}{10}\\ln\\!\\left(\\frac{3}{8}\\right).\n$$\n进行数值计算：\n$$\n\\frac{7}{10}\\ln\\!\\left(\\frac{7}{2}\\right)\\approx 0.7\\times 1.2527629685\\approx 0.8769340779,\\quad\n\\frac{3}{10}\\ln\\!\\left(\\frac{3}{8}\\right)\\approx 0.3\\times(-0.9808292530)\\approx -0.2942487759,\n$$\n所以\n$$\nD_{KL}(Q \\,\\|\\, P)\\approx 0.8769340779-0.2942487759\\approx 0.5826853020.\n$$\n\n将两个结果都四舍五入到四位有效数字，得到 $D_{KL}(P \\,\\|\\, Q)\\approx 0.5341$ 和 $D_{KL}(Q \\,\\|\\, P)\\approx 0.5827$。", "answer": "$$\\boxed{\\begin{pmatrix}0.5341 & 0.5827\\end{pmatrix}}$$", "id": "1370270"}, {"introduction": "在掌握了离散概率分布的KL散度计算后，我们将进一步探索连续分布的情形，这对于模拟设备寿命、等待时间等现实世界现象至关重要。本练习要求你为两个参数不同的指数分布推导出一个通用的KL散度表达式。这个过程不仅能加深你对连续KL散度积分形式的理解，还能锻炼你运用微积分解决概率论问题的能力。[@problem_id:1370289]", "problem": "在统计建模中，通常需要量化候选模型与真实、潜在的概率分布之间的差异。库尔贝克-莱布勒（Kullback-Leibler, KL）散度提供了衡量这种差异的一种方法。\n\n一个服从率参数为 $\\lambda > 0$ 的指数分布的随机变量 $X$ 的概率密度函数 (PDF) $f(x; \\lambda)$ 由下式给出：\n$$\nf(x; \\lambda) = \\begin{cases} \\lambda \\exp(-\\lambda x) & \\text{if } x \\ge 0 \\\\ 0 & \\text{if } x < 0 \\end{cases}\n$$\n对于两个分别具有概率密度函数 $p(x)$ 和 $q(x)$ 的连续概率分布 $P$ 和 $Q$，从 $Q$ 到 $P$ 的KL散度，记为 $D_{KL}(P \\| Q)$，定义为：\n$$\nD_{KL}(P \\| Q) = \\int_{-\\infty}^{\\infty} p(x) \\ln\\left(\\frac{p(x)}{q(x)}\\right) dx\n$$\n该积分在 $p(x) > 0$ 的定义域上进行计算。\n\n考虑两种用于描述设备寿命的模型。模型 $P$ 假设寿命服从率参数为 $\\lambda_p$ 的指数分布。模型 $Q$ 假设寿命服从一个不同的率参数 $\\lambda_q$ 的指数分布。\n\n你的任务是计算KL散度 $D_{KL}(P \\| Q)$。请提供一个用 $\\lambda_p$ 和 $\\lambda_q$ 表示的闭式解析表达式作为答案。", "solution": "给定两个指数分布：模型 $P$ 的率参数为 $\\lambda_{p} > 0$，模型 $Q$ 的率参数为 $\\lambda_{q} > 0$。它们的概率密度函数分别为\n$$\np(x) = \\begin{cases} \\lambda_{p} \\exp(-\\lambda_{p} x) & \\text{if } x \\ge 0 \\\\ 0 & \\text{if } x < 0 \\end{cases}, \\quad\nq(x) = \\begin{cases} \\lambda_{q} \\exp(-\\lambda_{q} x) & \\text{if } x \\ge 0 \\\\ 0 & \\text{if } x < 0 \\end{cases}.\n$$\n从 $Q$ 到 $P$ 的库尔贝克-莱布勒散度定义为\n$$\nD_{KL}(P \\,\\|\\, Q) = \\int_{-\\infty}^{\\infty} p(x) \\ln\\!\\left(\\frac{p(x)}{q(x)}\\right) \\, dx,\n$$\n并且积分是在 $p(x) > 0$ 的区域上进行的。在此，仅当 $x \\ge 0$ 时 $p(x) > 0$，在该区域上，由于 $\\lambda_{q} > 0$，同样有 $q(x) > 0$。\n\n对于 $x \\ge 0$，计算对数密度比：\n$$\n\\frac{p(x)}{q(x)} = \\frac{\\lambda_{p} \\exp(-\\lambda_{p} x)}{\\lambda_{q} \\exp(-\\lambda_{q} x)} = \\frac{\\lambda_{p}}{\\lambda_{q}} \\exp\\!\\big(-( \\lambda_{p} - \\lambda_{q}) x\\big),\n$$\n所以\n$$\n\\ln\\!\\left(\\frac{p(x)}{q(x)}\\right) = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) - (\\lambda_{p} - \\lambda_{q}) x = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + (\\lambda_{q} - \\lambda_{p}) x.\n$$\n因此，\n$$\nD_{KL}(P \\,\\|\\, Q) = \\int_{0}^{\\infty} \\lambda_{p} \\exp(-\\lambda_{p} x) \\left[ \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + (\\lambda_{q} - \\lambda_{p}) x \\right] dx.\n$$\n将该积分分成两部分：\n$$\nD_{KL}(P \\,\\|\\, Q) = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) \\int_{0}^{\\infty} \\lambda_{p} \\exp(-\\lambda_{p} x) \\, dx + (\\lambda_{q} - \\lambda_{p}) \\int_{0}^{\\infty} \\lambda_{p} x \\exp(-\\lambda_{p} x) \\, dx.\n$$\n第一个积分等于 $1$，因为 $p(x)$ 是一个概率密度：\n$$\n\\int_{0}^{\\infty} \\lambda_{p} \\exp(-\\lambda_{p} x) \\, dx = 1.\n$$\n对于第二个积分，进行换元，令 $u = \\lambda_{p} x$, $dx = du/\\lambda_{p}$：\n$$\n\\int_{0}^{\\infty} \\lambda_{p} x \\exp(-\\lambda_{p} x) \\, dx = \\int_{0}^{\\infty} \\lambda_{p} \\left(\\frac{u}{\\lambda_{p}}\\right) \\exp(-u) \\frac{du}{\\lambda_{p}} = \\frac{1}{\\lambda_{p}} \\int_{0}^{\\infty} u \\exp(-u) \\, du = \\frac{1}{\\lambda_{p}},\n$$\n因为 $\\int_{0}^{\\infty} u \\exp(-u) \\, du = 1$。\n\n将这些结果汇总，\n$$\nD_{KL}(P \\,\\|\\, Q) = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + (\\lambda_{q} - \\lambda_{p}) \\cdot \\frac{1}{\\lambda_{p}} = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + \\frac{\\lambda_{q}}{\\lambda_{p}} - 1.\n$$\n这是一个用 $\\lambda_{p}$ 和 $\\lambda_{q}$ 表示的闭式表达式，并且它是一个非负值，当且仅当 $\\lambda_{p} = \\lambda_{q}$ 时取等号。", "answer": "$$\\boxed{\\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + \\frac{\\lambda_{q}}{\\lambda_{p}} - 1}$$", "id": "1370289"}, {"introduction": "KL散度不仅是一个度量工具，更是在机器学习中用于优化的强大目标函数。本练习将带你一窥变分推断的核心思想：用一个简单的分布（如高斯分布）去近似一个复杂的分布。你将通过最小化“反向”KL散度（$D_{KL}(Q\\|P)$）来寻找最佳的近似模型，并在此过程中领会其独特的“模式寻求”（mode-seeking）行为，这在模型压缩和生成模型等领域有重要应用。[@problem_id:1370260]", "problem": "在机器学习和统计物理学的许多领域中，通常需要用一个更简单、易于处理的分布（如高斯分布 $Q(x)$）来近似一个复杂的概率分布 $P(x)$。寻找最佳近似的一种常用方法是最小化两个分布之间的 Kullback-Leibler (KL) 散度。\n\n考虑一个单连续变量 $x \\in (-\\infty, \\infty)$ 的目标概率分布 $P(x)$，它由势能函数 $U(x) = \\alpha x^4 - \\beta x^2$ 定义，其中 $\\alpha$ 和 $\\beta$ 是给定的正常实数常量。其概率密度函数为 $P(x) = \\frac{1}{Z} \\exp(-U(x))$，其中 $Z$ 是一个归一化常数。该分布具有两个不同的众数（峰值），对称地分布在 $x=0$ 的两侧。\n\n我们希望用一个高斯分布 $Q(x) = \\mathcal{N}(x | \\mu_Q, \\sigma_Q^2)$ 来近似 $P(x)$，其定义为 $Q(x) = \\frac{1}{\\sqrt{2\\pi\\sigma_Q^2}} \\exp\\left(-\\frac{(x - \\mu_Q)^2}{2\\sigma_Q^2}\\right)$。近似的质量由反向 KL 散度 $D_{KL}(Q\\|P)$ 来衡量，其表达式为：\n$$D_{KL}(Q\\|P) = \\int_{-\\infty}^{\\infty} Q(x) \\ln\\left(\\frac{Q(x)}{P(x)}\\right) dx$$\n\n对于本问题，为了使优化易于处理，我们假设近似高斯分布的方差固定为一个常数值 $\\sigma_Q^2 = v_0$。 $v_0$ 的取值满足 $v_0 < \\frac{\\beta}{6\\alpha}$。你的任务是找到使此 KL 散度最小化的均值 $\\mu_Q$ 的最优值。\n\n请找出最优均值的正值 $\\mu_Q^*$ 的符号表达式，用参数 $\\alpha$、$\\beta$ 和 $v_0$ 表示。", "solution": "我们从反向 Kullback-Leibler 散度的定义出发：\n$$\nD_{KL}(Q\\|P)=\\int_{-\\infty}^{\\infty} Q(x)\\ln\\left(\\frac{Q(x)}{P(x)}\\right)\\,dx= \\mathbb{E}_{Q}[\\ln Q(x)]-\\mathbb{E}_{Q}[\\ln P(x)].\n$$\n由于 $P(x)=\\frac{1}{Z}\\exp(-U(x))$ 且 $U(x)=\\alpha x^{4}-\\beta x^{2}$，我们有 $\\ln P(x)=-U(x)-\\ln Z$，因此\n$$\nD_{KL}(Q\\|P)=\\mathbb{E}_{Q}[\\ln Q(x)]+\\mathbb{E}_{Q}[U(x)]+\\ln Z.\n$$\n归一化常数 $\\ln Z$ 不依赖于高斯分布的参数，并且对于方差固定为 $v_0$ 的 $Q(x)=\\mathcal{N}(x\\mid \\mu_Q,v_0)$，\n$$\n\\mathbb{E}_{Q}[\\ln Q(x)]=-\\frac{1}{2}\\ln(2\\pi v_0)-\\frac{1}{2}\\mathbb{E}_{Q}\\left[\\frac{(x-\\mu_Q)^{2}}{v_0}\\right]=-\\frac{1}{2}\\ln(2\\pi v_0)-\\frac{1}{2},\n$$\n该项不依赖于 $\\mu_Q$。因此，对 $\\mu_Q$ 最小化 $D_{KL}(Q\\|P)$ 等价于对 $\\mu_Q$ 最小化 $\\mathbb{E}_{Q}[U(x)]$：\n$$\n\\min_{\\mu_Q}\\ \\mathbb{E}_{Q}[U(x)]=\\min_{\\mu_Q}\\ \\left(\\alpha\\,\\mathbb{E}_{Q}[x^{4}]-\\beta\\,\\mathbb{E}_{Q}[x^{2}]\\right).\n$$\n对于 $x\\sim \\mathcal{N}(\\mu_Q,v_0)$，可记 $x=\\mu_Q+\\varepsilon$，其中 $\\varepsilon\\sim \\mathcal{N}(0,v_0)$。使用标准高斯矩公式，\n$$\n\\mathbb{E}_{Q}[x^{2}]=\\mu_Q^{2}+v_0,\\qquad \\mathbb{E}_{Q}[x^{4}]=\\mu_Q^{4}+6\\mu_Q^{2}v_0+3v_0^{2}.\n$$\n因此\n$$\n\\mathbb{E}_{Q}[U(x)]=\\alpha\\left(\\mu_Q^{4}+6\\mu_Q^{2}v_0+3v_0^{2}\\right)-\\beta\\left(\\mu_Q^{2}+v_0\\right).\n$$\n舍去不依赖于 $\\mu_Q$ 的项，我们最小化以下四次函数：\n$$\nf(\\mu_Q)=\\alpha \\mu_Q^{4}+(6\\alpha v_0-\\beta)\\mu_Q^{2}.\n$$\n记 $c_{2}=6\\alpha v_0-\\beta$。其导数为\n$$\nf'(\\mu_Q)=4\\alpha \\mu_Q^{3}+2c_{2}\\mu_Q=2\\mu_Q\\left(2\\alpha \\mu_Q^{2}+c_{2}\\right).\n$$\n令 $f'(\\mu_Q)=0$，得到驻点位于 $\\mu_Q=0$ 和\n$$\n\\mu_Q^{2}=-\\frac{c_{2}}{2\\alpha}=\\frac{\\beta-6\\alpha v_0}{2\\alpha}.\n$$\n在给定假设 $v_0<\\frac{\\beta}{6\\alpha}$ 下，我们有 $\\beta-6\\alpha v_0>0$，因此非零驻点是实数。二阶导数为\n$$\nf''(\\mu_Q)=12\\alpha \\mu_Q^{2}+2c_{2}.\n$$\n在 $\\mu_Q=0$ 处，$f''(0)=2c_{2}<0$，所以 $\\mu_Q=0$ 是一个局部极大值点。在 $\\mu_Q^{2}=(\\beta-6\\alpha v_0)/(2\\alpha)$ 处，\n$$\nf''=12\\alpha \\cdot \\frac{\\beta-6\\alpha v_0}{2\\alpha}+2c_{2}=6(\\beta-6\\alpha v_0)+2(6\\alpha v_0-\\beta)=-4(6\\alpha v_0-\\beta)>0,\n$$\n所以这些点是极小值点。根据对称性，存在两个最优均值 $\\pm \\sqrt{(\\beta-6\\alpha v_0)/(2\\alpha)}$。因此，所求的正最优均值为\n$$\n\\mu_{Q}^{*}=\\sqrt{\\frac{\\beta-6\\alpha v_0}{2\\alpha}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{\\beta-6\\alpha v_0}{2\\alpha}}}$$", "id": "1370260"}]}