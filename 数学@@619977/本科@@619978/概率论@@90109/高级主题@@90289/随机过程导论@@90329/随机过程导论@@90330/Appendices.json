{"hands_on_practices": [{"introduction": "随机过程研究的是随时间演变的系统。马尔可夫链是其中最基本的模型之一，其核心思想是“未来只依赖于当前状态，而与如何到达当前状态的路径无关”。这个练习将国际象棋中马的移动作为马尔可夫链的一个直观例子，通过计算其在棋盘上的移动概率，帮助你将现实世界的规则转化为数学模型，并进行简单的预测。[@problem_id:1367723]", "problem": "一个马被放置在一个空的 3x3 棋盘上。棋盘上的方格由坐标（行，列）标识，其中行号和列号的范围为 1 到 3。马以“L”形移动：在一个基本方向（水平或垂直）上移动两格，然后在一个垂直方向上移动一格。只有当马落在 3x3 棋盘边界内的方格上时，该移动才被视为合法。\n\n马从角上的方格 (1,1) 开始。在每一步中，它都会随机选择一个合法的走法进行移动。如果从当前方格有 $k$ 种合法的走法，马会以 $1/k$ 的概率选择其中任何一种。\n\n计算马在连续走两步后回到起始方格 (1,1) 的概率。请用分数表示你的答案。", "solution": "马按向量 $(\\pm 2, \\pm 1)$ 或 $(\\pm 1, \\pm 2)$ 移动。在一个 $3 \\times 3$ 的棋盘上，从起始角 $(1,1)$ 出发，合法的目标位置是两个坐标都在 $\\{1,2,3\\}$ 范围内的位置。列举如下：\n- $(1\\pm 2,1\\pm 1)$ 得到 $(3,2)$ 是有效的，所有其他位置均无效。\n- $(1\\pm 1,1\\pm 2)$ 得到 $(2,3)$ 是有效的，所有其他位置均无效。\n因此，第一步的合法走法集合是 $S=\\{(3,2),(2,3)\\}$，其中 $|S|=2$，每种走法被选择的概率为 $1/2$。\n\n从 $(3,2)$ 出发，棋盘内的合法马步可通过加上相同的移动向量得到：\n- $(3\\pm 2,2\\pm 1)$ 得到 $(1,3)$ 和 $(1,1)$ 是有效的；其他位置则超出边界。\n- $(3\\pm 1,2\\pm 2)$ 均超出边界。\n因此，有 $k(3,2)=2$ 种合法走法，而 $(1,1)$ 是其中之一，所以从 $(3,2)$ 一步返回的概率为 $1/2$。\n\n从 $(2,3)$ 出发，类似地：\n- $(2\\pm 2,3\\pm 1)$ 均超出边界。\n- $(2\\pm 1,3\\pm 2)$ 得到 $(3,1)$ 和 $(1,1)$ 是有效的；其他位置则超出边界。\n因此 $k(2,3)=2$，从 $(2,3)$ 一步返回的概率为 $1/2$。\n\n根据全概率公式，设 $X_{t}$ 为移动 $t$ 步后的位置，\n$$\n\\Pr\\big(X_{2}=(1,1)\\big)\n=\\sum_{v\\in S}\\Pr\\big(X_{1}=v\\big)\\Pr\\big(X_{2}=(1,1)\\mid X_{1}=v\\big)\n=\\sum_{v\\in S}\\frac{1}{|S|}\\cdot\\frac{1}{k(v)}\n=2\\cdot\\frac{1}{2}\\cdot\\frac{1}{2}\n=\\frac{1}{2}.\n$$\n因此，在恰好移动两步后回到 $(1,1)$ 的概率是 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1367723"}, {"introduction": "理解了什么是马尔可夫过程后，辨别哪些过程不具备马尔可夫性质同样重要。这个练习旨在挑战你对马尔可夫“无记忆性”这一核心性质的理解。通过分析一个由独立随机变量构成的移动平均过程，你将学会如何严谨地检验一个过程的未来是否仅仅依赖于其当前状态，从而加深对马尔可夫过程本质的认识。[@problem_id:1367774]", "problem": "考虑一个独立同分布（i.i.d.）的随机变量序列 $\\{X_n\\}_{n \\ge 0}$，其中每个随机变量以相等的概率取值 $1$ 或 $-1$，即 $P(X_n=1) = P(X_n=-1) = 0.5$。\n\n由此序列构造出一个新的随机过程 $\\{Y_n\\}_{n \\ge 1}$，它是一个简单移动平均：\n$$Y_n = \\frac{1}{2}(X_n + X_{n-1})$$\n现在，考虑以下断言：“随机过程 $\\{Y_n\\}_{n \\ge 1}$ 是一个马尔可夫过程。”\n\n下列哪个陈述正确地评估了该断言并提供了正确的理由？\n\nA. 该断言为真。一个由独立同分布随机变量构成的过程总是一个马尔可夫过程。\n\nB. 该断言为假。为了预测 $Y_{n+1} = \\frac{1}{2}(X_{n+1} + X_n)$ 的分布，仅知道当前状态 $Y_n = \\frac{1}{2}(X_n + X_{n-1})$ 是不够的。过去的状态 $Y_{n-1}$ 提供了关于 $X_{n-1}$ 的更多信息，这反过来有助于从 $Y_n$ 中确定 $X_n$，从而改变了对 $Y_{n+1}$ 的预测。\n\nC. 该断言为真。未来状态 $Y_{n+1}$ 仅依赖于当前状态 $Y_n$ 和新的随机变量 $X_{n+1}$，这就是马尔可夫过程的定义。\n\nD. 该断言为假。一个过程只有在其期望非零时才能是马尔可夫过程，但 $E[Y_n] = 0$。\n\nE. 该断言为真。该过程是时间齐次的，意味着其转移概率与时间步长 $n$ 无关，这表明它必定是一个马尔可夫过程。", "solution": "给定独立同分布的随机变量 $\\{X_{n}\\}_{n \\ge 0}$，满足 $P(X_{n}=1)=P(X_{n}=-1)=\\frac{1}{2}$，以及一个由 $Y_{n}=\\frac{1}{2}(X_{n}+X_{n-1})$ 定义的过程 $\\{Y_{n}\\}_{n \\ge 1}$。$Y_{n}$ 的状态空间是 $\\{-1,0,1\\}$，因为 $X_{n}+X_{n-1}\\in\\{-2,0,2\\}$。\n\n马尔可夫性质要求对于所有 $n\\ge 1$ 以及所有状态 $y_{n+1},y_{n},y_{n-1},\\dots$，\n$$\nP\\big(Y_{n+1}=y_{n+1}\\,\\big|\\,Y_{n}=y_{n},Y_{n-1}=y_{n-1},\\dots\\big)\n=\nP\\big(Y_{n+1}=y_{n+1}\\,\\big|\\,Y_{n}=y_{n}\\big).\n$$\n我们将通过展示一个历史路径的例子来证明这一点不成立，在该例子中，当我们在 $Y_{n}$ 的基础上再加入 $Y_{n-1}$ 时，$Y_{n+1}$ 的条件分布会发生改变。\n\n首先，计算只给定 $Y_{n}=0$ 时 $Y_{n+1}$ 的分布。事件 $Y_{n}=0$ 等价于\n$$\n\\frac{1}{2}(X_{n}+X_{n-1})=0 \\quad\\Longleftrightarrow\\quad (X_{n},X_{n-1})\\in\\{(1,-1),(-1,1)\\}.\n$$\n根据 $X$ 的独立性和对称性，\n$$\nP\\big(X_{n}=1\\,\\big|\\,Y_{n}=0\\big)=\\frac{1}{2},\\qquad P\\big(X_{n}=-1\\,\\big|\\,Y_{n}=0\\big)=\\frac{1}{2}.\n$$\n以 $X_{n}$ 为条件，我们有\n$$\nY_{n+1}=\\frac{1}{2}(X_{n+1}+X_{n}).\n$$\n因此，\n- 如果 $X_{n}=1$，则 $Y_{n+1}\\in\\{0,1\\}$ 且\n$$\nP\\big(Y_{n+1}=1\\,\\big|\\,X_{n}=1\\big)=\\frac{1}{2},\\quad P\\big(Y_{n+1}=0\\,\\big|\\,X_{n}=1\\big)=\\frac{1}{2},\\quad P\\big(Y_{n+1}=-1\\,\\big|\\,X_{n}=1\\big)=0.\n$$\n- 如果 $X_{n}=-1$，则 $Y_{n+1}\\in\\{0,-1\\}$ 且\n$$\nP\\big(Y_{n+1}=-1\\,\\big|\\,X_{n}=-1\\big)=\\frac{1}{2},\\quad P\\big(Y_{n+1}=0\\,\\big|\\,X_{n}=-1\\big)=\\frac{1}{2},\\quad P\\big(Y_{n+1}=1\\,\\big|\\,X_{n}=-1\\big)=0.\n$$\n在给定 $Y_{n}=0$ 的条件下，对 $X_{n}$ 取平均，得到\n$$\nP\\big(Y_{n+1}=1\\,\\big|\\,Y_{n}=0\\big)=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4},\\quad\nP\\big(Y_{n+1}=-1\\,\\big|\\,Y_{n}=0\\big)=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4},\n$$\n因此\n$$\nP\\big(Y_{n+1}=0\\,\\big|\\,Y_{n}=0\\big)=1-\\frac{1}{4}-\\frac{1}{4}=\\frac{1}{2}.\n$$\n\n现在加入额外信息 $Y_{n-1}=1$。事件 $Y_{n-1}=1$ 意味着\n$$\n\\frac{1}{2}(X_{n-1}+X_{n-2})=1 \\quad\\Longleftrightarrow\\quad X_{n-1}=1\\ \\text{ and }\\ X_{n-2}=1.\n$$\n将 $Y_{n}=0$ 与 $X_{n-1}=1$ 结合起来，得到\n$$\n\\frac{1}{2}(X_{n}+X_{n-1})=0 \\ \\text{ and }\\ X_{n-1}=1 \\quad\\Longleftrightarrow\\quad X_{n}=-1.\n$$\n因此，在条件 $\\{Y_{n}=0,\\,Y_{n-1}=1\\}$ 下，我们确定地有 $X_{n}=-1$，所以\n$$\nP\\big(Y_{n+1}=1\\,\\big|\\,Y_{n}=0,\\,Y_{n-1}=1\\big)=P\\big(Y_{n+1}=1\\,\\big|\\,X_{n}=-1\\big)=0,\n$$\n而我们之前发现\n$$\nP\\big(Y_{n+1}=1\\,\\big|\\,Y_{n}=0\\big)=\\frac{1}{4}.\n$$\n由于这些概率不同，给定当前状态 $Y_{n}$ 时 $Y_{n+1}$ 的条件分布，会因为包含了过去状态 $Y_{n-1}$ 的信息而改变。这违反了马尔可夫性质。因此 $\\{Y_{n}\\}$ 不是一个马尔可夫过程。\n\n在所有选项中，这与选项 B 的推理相符。选项 A、C 和 E 错误地从独立同分布输入、仅依赖于 $Y_n$ 和新噪声、或时间齐次性来推断马尔可夫性；选项 D 无关且错误。", "answer": "$$\\boxed{B}$$", "id": "1367774"}, {"introduction": "随机游走是随机过程理论的基石，它模拟了从股价波动到粒子扩散等多种现象。本练习将引导你深入分析一维简单对称随机游走的统计特性。通过计算粒子位置的四阶矩，$E[S_N^4]$，你将练习处理随机变量求和的技巧，并理解如何运用期望和独立性来刻画一个过程的涨落和分布形态。[@problem_id:1367751]", "problem": "一个粒子在整数集上进行一维简单对称随机游走。粒子在时间 $n=0$ 时从原点（位置0）开始。在每个离散时间步 $n=1, 2, 3, \\dots$，粒子以 $1/2$ 的概率向右移动一个单位，或以 $1/2$ 的概率向左移动一个单位。每一步的方向都是随机的，且与之前的所有步独立。\n\n设 $S_N$ 表示粒子在 $N$ 步之后的位置。确定粒子在 $N$ 步后位置的四阶矩 $E[S_N^4]$ 的闭式解析表达式。您的答案应以 $N$ 的函数形式表示。", "solution": "设第 $i$ 步的结果由随机变量 $X_i$ 表示，其中 $i \\in \\{1, 2, \\dots, N\\}$。如果 $X_i = +1$，粒子向右移动一个单位；如果 $X_i = -1$，粒子向左移动一个单位。根据题目描述，这些结果是等可能且独立的。因此，随机变量 $X_i$ 是独立同分布的（i.i.d.），其概率质量函数为：\n$P(X_i = 1) = \\frac{1}{2}$\n$P(X_i = -1) = \\frac{1}{2}$\n\n粒子在 $N$ 步之后的位置 $S_N$ 是各单步结果的总和：\n$$S_N = \\sum_{i=1}^{N} X_i$$\n\n我们需要求 $S_N$ 的四阶矩，即 $E[S_N^4]$。我们首先计算单步变量 $X_i$ 的前几阶矩：\n一阶矩（均值）：\n$E[X_i] = (1)\\left(\\frac{1}{2}\\right) + (-1)\\left(\\frac{1}{2}\\right) = 0$\n二阶矩：\n$E[X_i^2] = (1)^2\\left(\\frac{1}{2}\\right) + (-1)^2\\left(\\frac{1}{2}\\right) = 1$\n三阶矩：\n$E[X_i^3] = (1)^3\\left(\\frac{1}{2}\\right) + (-1)^3\\left(\\frac{1}{2}\\right) = 0$\n四阶矩：\n$E[X_i^4] = (1)^4\\left(\\frac{1}{2}\\right) + (-1)^4\\left(\\frac{1}{2}\\right) = 1$\n\n现在，我们可以写出 $E[S_N^4]$ 的表达式：\n$$E[S_N^4] = E\\left[\\left(\\sum_{i=1}^{N} X_i\\right)^4\\right] = E\\left[\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sum_{k=1}^{N} \\sum_{l=1}^{N} X_i X_j X_k X_l\\right]$$\n根据期望的线性性质，我们可以将期望算子移到求和符号内部：\n$$E[S_N^4] = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sum_{k=1}^{N} \\sum_{l=1}^{N} E[X_i X_j X_k X_l]$$\n项 $E[X_i X_j X_k X_l]$ 的值取决于下标 $i, j, k, l$ 之间的关系。由于变量 $X_m$ 是独立的，如果某个下标与其他所有下标都不同，其期望可以被因子分解出来。例如，如果 $i \\neq j, i \\neq k, i \\neq l$，则 $E[X_i X_j X_k X_l] = E[X_i] E[X_j X_k X_l]$。由于 $E[X_i] = 0$，整个项的值变为零。\n\n因此，只有那些没有下标仅出现一次的项才不为零。对于下标集合 $\\{i, j, k, l\\}$，这留下了两种情况：\n情况1：所有四个下标都相同，即 $i=j=k=l$。\n这些项的形式为 $E[X_i^4]$。\n共有 $N$ 个这样的项，对应于 $i$ 从 1 到 $N$ 的每种选择。\n每个此类项的值为 $E[X_i^4] = 1$。\n此情况的总贡献为 $N \\times 1 = N$。\n\n情况2：下标由两个不同的配对组成，例如，$i=j$ 且 $k=l$，其中 $i \\neq k$。\n这些项的形式为 $E[X_i^2 X_k^2]$。由于 $i \\neq k$，变量 $X_i$ 和 $X_k$ 是独立的。所以，$E[X_i^2 X_k^2] = E[X_i^2] E[X_k^2]$。\n每个此类项的值为 $1 \\times 1 = 1$。\n我们需要计算在 $\\{1, ..., N\\}^4$ 中有多少个下标四元组 $(i, j, k, l)$ 属于此类别。这涉及到从 $N$ 个选项中选择两个不同的下标（我们称之为 $a$ 和 $b$），并将它们配对。\n形成下标对有三种方式：\n(a) $i=j$ 且 $k=l$，其中 $i \\neq k$。我们可以用 $N$ 种方式选择 $i$，用 $(N-1)$ 种方式选择 $k$。这给出 $N(N-1)$ 个项。\n(b) $i=k$ 且 $j=l$，其中 $i \\neq j$。我们可以用 $N$ 种方式选择 $i$，用 $(N-1)$ 种方式选择 $j$。这给出 $N(N-1)$ 个项。\n(c) $i=l$ 且 $j=k$，其中 $i \\neq j$。我们可以用 $N$ 种方式选择 $i$，用 $(N-1)$ 种方式选择 $j$。这给出 $N(N-1)$ 个项。\n在此情况下，总项数为 $3N(N-1)$。\n此情况的总贡献为 $3N(N-1) \\times 1 = 3N^2 - 3N$。\n\n四个下标的任何其他分区方式，例如三个相等而一个不同（如 $i=j=k \\neq l$），其期望都将为零，因为 $E[X_i^3X_l] = E[X_i^3]E[X_l] = 0 \\times E[X_l] = 0$。\n\n将两个非零情况的贡献相加：\n$$E[S_N^4] = (\\text{情况1的贡献}) + (\\text{情况2的贡献})$$\n$$E[S_N^4] = N + (3N^2 - 3N)$$\n$$E[S_N^4] = 3N^2 - 2N$$\n该表达式也可以写成 $N(3N-2)$。\n\n让我们对小的 $N$ 值进行检验：\n当 $N=1$ 时，$S_1 = X_1$。$E[S_1^4] = E[X_1^4] = 1$。我们的公式给出 $3(1)^2 - 2(1) = 1$。这是正确的。\n当 $N=2$ 时，$S_2 = X_1+X_2$。$E[S_2^4] = E[(X_1+X_2)^4] = E[X_1^4 + 4X_1^3X_2 + 6X_1^2X_2^2 + 4X_1X_2^3 + X_2^4]$。\n利用线性和独立性，这变为 $E[X_1^4] + 4E[X_1^3]E[X_2] + 6E[X_1^2]E[X_2^2] + 4E[X_1]E[X_2^3] + E[X_2^4]$。\n代入各阶矩的值：$1 + 4(0)(0) + 6(1)(1) + 4(0)(0) + 1 = 1+6+1=8$。\n我们的公式给出 $3(2)^2 - 2(2) = 12 - 4 = 8$。这也是正确的。\n最终表达式是正确的。", "answer": "$$\\boxed{3N^{2} - 2N}$$", "id": "1367751"}]}