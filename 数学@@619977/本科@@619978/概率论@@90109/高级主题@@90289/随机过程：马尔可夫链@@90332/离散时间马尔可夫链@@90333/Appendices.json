{"hands_on_practices": [{"introduction": "马尔可夫链的核心在于其能够预测一个系统在未来某个时间点处于特定状态的概率。这个练习将带你动手实践最基本也最重要的技能：利用转移概率矩阵计算多步转移概率。通过一个直观的品牌忠诚度模型，你将学会如何通过矩阵乘法来追踪概率分布随时间的变化。[@problem_id:1297421]", "problem": "一家市场研究公司正在分析两大领先智能手机品牌“Aura”和“Zenith”之间的消费者忠诚度。该公司使用一个离散时间马尔可夫链来模拟市场，其中状态是客户当前使用的智能手机品牌，时间步长为一周。\n\n根据广泛的调查数据，该公司确定了以下每周的品牌转换概率：\n- 使用Aura智能手机的客户下周继续使用Aura的概率为0.8。\n- 使用Zenith智能手机的客户下周继续使用Zenith的概率为0.7。\n\n假设不继续使用当前品牌的客户会转换到另一个品牌。\n\n如果一个客户今天正在使用Aura智能手机，那么三周后这位客户仍在使用Aura智能手机的概率是多少？将你的答案表示为保留三位有效数字的小数。", "solution": "设状态按 $(\\text{Aura}, \\text{Zenith})$ 排序。一步转移矩阵为\n$$\nP=\\begin{pmatrix}\n0.8 & 0.2 \\\\\n0.3 & 0.7\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{4}{5} & \\frac{1}{5} \\\\\n\\frac{3}{10} & \\frac{7}{10}\n\\end{pmatrix}.\n$$\n今天从Aura开始，对应的初始分布行向量为\n$$\nv_{0}=\\begin{pmatrix}1 & 0\\end{pmatrix}.\n$$\n三周（三步）后，分布为\n$$\nv_{3}=v_{0}P^{3},\n$$\n并且所求的概率是 $v_{3}$ 的第一个分量，等价于 $P^{3}$ 的 $(1,1)$ 项。\n\n计算 $P^{2}$：\n$$\nP^{2}=\\begin{pmatrix}\n\\frac{4}{5} & \\frac{1}{5} \\\\\n\\frac{3}{10} & \\frac{7}{10}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{4}{5} & \\frac{1}{5} \\\\\n\\frac{3}{10} & \\frac{7}{10}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\left(\\frac{4}{5}\\right)^{2}+\\frac{1}{5}\\cdot\\frac{3}{10} & \\frac{4}{5}\\cdot\\frac{1}{5}+\\frac{1}{5}\\cdot\\frac{7}{10} \\\\\n\\frac{3}{10}\\cdot\\frac{4}{5}+\\frac{7}{10}\\cdot\\frac{3}{10} & \\frac{3}{10}\\cdot\\frac{1}{5}+\\left(\\frac{7}{10}\\right)^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{7}{10} & \\frac{3}{10} \\\\\n\\frac{9}{20} & \\frac{11}{20}\n\\end{pmatrix}.\n$$\n然后计算 $P^{3}=P^{2}P$ 并提取其 $(1,1)$ 项：\n$$\n(P^{3})_{11}=\\frac{7}{10}\\cdot\\frac{4}{5}+\\frac{3}{10}\\cdot\\frac{3}{10}\n=\\frac{28}{50}+\\frac{9}{100}\n=\\frac{56}{100}+\\frac{9}{100}\n=\\frac{65}{100}\n=0.65.\n$$\n因此，一个今天从Aura开始的客户三周后仍在使用Aura的概率为 $0.65$，保留三位有效数字为 $0.650$。", "answer": "$$\\boxed{0.650}$$", "id": "1297421"}, {"introduction": "很多现实世界系统最终会进入某些“终点”或吸收状态。理解系统到达某个终点而非另一个的概率至关重要，例如在风险分析中。本练习介绍了一种强大的技术——“首步分析法”，用于计算吸收概率，让你能够解答一个机器在进入“失效”状态前先进入“维修”状态的可能性有多大。[@problem_id:1297439]", "problem": "一个描述某工业机械运行状态的简化模型由一个离散时间马尔可夫链描述，其状态空间为 $S = \\{1, 2, 3, 4\\}$。各状态定义如下：\n- 状态 1：维修中\n- 状态 2：空闲\n- 状态 3：运行中\n- 状态 4：严重故障\n\n在每个小时结束时观察机械的状态。一旦机械进入状态 1 或状态 4，它将保持在该状态。对于其他状态，一步转移概率如下：\n\n从状态 2（空闲）出发，机械转移到：\n- 状态 1 的概率为 $p_{21} = 0.1$\n- 状态 2 的概率为 $p_{22} = 0.5$\n- 状态 3 的概率为 $p_{23} = 0.3$\n- 状态 4 的概率为 $p_{24} = 0.1$\n\n从状态 3（运行中）出发，机械转移到：\n- 状态 1 的概率为 $p_{31} = 0.2$\n- 状态 2 的概率为 $p_{32} = 0.4$\n- 状态 3 的概率为 $p_{33} = 0.1$\n- 状态 4 的概率为 $p_{34} = 0.3$\n\n假设机械当前处于空闲状态（状态 2）。计算它在进入维修中状态（状态 1）之前进入严重故障状态（状态 4）的概率。将你的答案表示为精确分数。", "solution": "我们使用吸收马尔可夫链中的首达概率来为在进入状态 1（维修中）之前先进入状态 4（严重故障）这一事件建模。设 $h_{i}$ 表示从状态 $i$ 出发，链在到达状态 1 之前先到达状态 4 的概率。由于状态 $1$ 和状态 $4$ 是吸收态，边界条件为 $h_{1}=0$ 和 $h_{4}=1$。对暂态 2 和 3 进行首步分析，我们得到\n$$\nh_{2} = p_{22} h_{2} + p_{23} h_{3} + p_{24}\\cdot 1 + p_{21}\\cdot 0,\n\\quad\nh_{3} = p_{32} h_{2} + p_{33} h_{3} + p_{34}\\cdot 1 + p_{31}\\cdot 0.\n$$\n代入给定的转移概率（写成精确分数形式），\n$$\nh_{2} = \\frac{1}{2} h_{2} + \\frac{3}{10} h_{3} + \\frac{1}{10}, \n\\quad\nh_{3} = \\frac{2}{5} h_{2} + \\frac{1}{10} h_{3} + \\frac{3}{10}.\n$$\n重新整理，\n$$\n\\left(1 - \\frac{1}{2}\\right) h_{2} - \\frac{3}{10} h_{3} = \\frac{1}{10},\n\\quad\n-\\frac{2}{5} h_{2} + \\left(1 - \\frac{1}{10}\\right) h_{3} = \\frac{3}{10},\n$$\n化简为\n$$\n\\frac{1}{2} h_{2} - \\frac{3}{10} h_{3} = \\frac{1}{10},\n\\quad\n-\\frac{2}{5} h_{2} + \\frac{9}{10} h_{3} = \\frac{3}{10}.\n$$\n将两个方程两边同乘以 $10$，得到\n$$\n5 h_{2} - 3 h_{3} = 1,\n\\quad\n-4 h_{2} + 9 h_{3} = 3.\n$$\n由第一个方程，我们得到 $h_{2} = \\frac{1 + 3 h_{3}}{5}$。将其代入第二个方程，\n$$\n-4 \\cdot \\frac{1 + 3 h_{3}}{5} + 9 h_{3} = 3\n\\;\\Rightarrow\\;\n-\\frac{4}{5} - \\frac{12}{5} h_{3} + 9 h_{3} = 3\n\\;\\Rightarrow\\;\n\\frac{33}{5} h_{3} - \\frac{4}{5} = 3.\n$$\n两边乘以 $5$，\n$$\n33 h_{3} - 4 = 15 \\;\\Rightarrow\\; 33 h_{3} = 19 \\;\\Rightarrow\\; h_{3} = \\frac{19}{33}.\n$$\n然后\n$$\nh_{2} = \\frac{1 + 3 \\cdot \\frac{19}{33}}{5} = \\frac{\\frac{33}{33} + \\frac{57}{33}}{5} = \\frac{\\frac{90}{33}}{5} = \\frac{90}{165} = \\frac{6}{11}.\n$$\n因此，从状态 2（空闲）出发，在进入状态 1（维修中）之前先进入状态 4（严重故障）的概率是 $\\frac{6}{11}$。", "answer": "$$\\boxed{\\frac{6}{11}}$$", "id": "1297439"}, {"introduction": "除了预测未来的概率，马尔可夫链理论还能揭示系统状态的内在结构性质，例如周期性。一个状态的周期描述了系统返回该状态所必须遵循的时间步长规律，这对于理解系统的长期振荡行为至关重要。通过分析一个机器人在方形网格上的移动，你将学会如何确定状态的周期，从而更深入地理解马尔可夫链的结构。[@problem_id:1297460]", "problem": "一台小型自主清洁机器人在一个大型方形太阳能电池板装置上运行。在该正方形的四个角上各有一个充电站。我们可以按顺时针方向将这些站点标记为 $S_1, S_2, S_3$ 和 $S_4$。\n\n机器人的运动可以建模为一个离散时间马尔可夫链。在每个时间步，机器人从一个站点移动到相邻的站点。由于轻微的机械偏差，机器人的运动不是均匀随机的。从任何给定的站点，机器人以概率 $p = 3/5$ 移动到顺时针方向的下一个站点，并以概率 $1-p = 2/5$ 移动到逆时针方向的下一个站点。例如，从站点 $S_1$，它将以 $3/5$ 的概率移动到 $S_2$，或以 $2/5$ 的概率移动到 $S_4$。机器人不能停留在同一站点，也不能在单一步骤中移动到对角线相对的站点。\n\n马尔可夫链中一个状态的周期定义为从该状态出发，所有可能返回到该状态的步数的最大公约数。\n\n确定机器人位于站点 $S_1$ 时所对应状态的周期。", "solution": "我们将机器人建模为状态空间 $\\{S_{1},S_{2},S_{3},S_{4}\\}$ 上的一个离散时间马尔可夫链，其中机器人从任何状态以正概率移动到其两个相邻状态之一：顺时针方向的概率为 $p=\\frac{3}{5}$，逆时针方向的概率为 $1-p=\\frac{2}{5}$。因此，从每个站点出发，恰好有两个传出转移，且概率均为正。\n\n状态 $i$ 的周期 $d(i)$ 定义为\n$$\nd(i)=\\gcd\\{n\\geq 1: P_{ii}^{(n)}>0\\},\n$$\n其中 $P_{ii}^{(n)}$ 是返回到状态 $i$ 的 $n$ 步返回概率。\n\n首先，观察到底层图是一个4-环，这是一个二部图，其二分划分为 $\\{S_{1},S_{3}\\}$ 和 $\\{S_{2},S_{4}\\}$。每一次移动都会切换部分，因为机器人总是移动到相邻的站点，不能停留在原地。因此，从 $S_{1}\\in\\{S_{1},S_{3}\\}$ 出发，经过奇数步后，机器人必定位于 $\\{S_{2},S_{4}\\}$ 中，而不可能在 $S_{1}$。因此，对于所有奇数 $n$，\n$$\nP_{11}^{(n)}=0.\n$$\n\n接下来，我们证明偶数步的返回是以正概率发生的。在 $2$ 步内，机器人可以走 $S_{1}\\to S_{2}\\to S_{1}$ 路径，其概率为 $p(1-p)>0$，或者走 $S_{1}\\to S_{4}\\to S_{1}$ 路径，其概率为 $(1-p)p>0$，所以\n$$\nP_{11}^{(2)}\\geq p(1-p)+(1-p)p=2p(1-p)>0.\n$$\n对于任何偶数 $n=2k$，可以连接 $k$ 次2步往返路径（例如 $(S_{1}\\to S_{2}\\to S_{1})^{k}$），其概率为 $\\left(p(1-p)\\right)^{k}>0$。因此，对于每个偶数 $n=2k$，\n$$\nP_{11}^{(2k)}\\geq \\left(p(1-p)\\right)^{k}>0.\n$$\n\n结合这两个事实，集合 $\\{n\\geq 1: P_{11}^{(n)}>0\\}$ 正是所有正偶数的集合。其最大公约数是\n$$\n\\gcd\\{2,4,6,\\dots\\}=2.\n$$\n因此，状态 $S_{1}$ 的周期是 $2$。", "answer": "$$\\boxed{2}$$", "id": "1297460"}]}