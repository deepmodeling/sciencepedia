{"hands_on_practices": [{"introduction": "此练习探讨了随机过程最基本的问题之一：其长期行为是什么？我们将通过分析一个简单而强大的用户增长模型来推导其稳态分布。这个实践将演示如何使用细致平衡方程来寻找平衡概率，并揭示其与著名的泊松分布之间的惊人联系。[@problem_id:1389344]", "problem": "一个新的在线媒体平台正在为其订阅用户群建模。新订阅者以每天 $\\lambda$ 的恒定平均速率加入平台，此速率与当前订阅者数量无关。单个订阅者可能会取消其服务，且假设取消服务的决策是相互独立的。因此，如果平台上有 $i$ 个订阅者，订阅被取消的总速率为每天 $\\mu i$，其中 $\\mu$ 是一个代表单个订阅者取消速率的正常数。\n\n在平台运行了足够长的时间后，观察到订阅者数量在一个稳定的平均值附近波动，这表明系统已达到一个稳态。设 $N$ 为此稳态下订阅者数量的随机变量。\n\n对于任意非负整数 $k$，求平台恰好有 $k$ 个订阅者的概率 $P(N=k)$。请将您的答案表示为以 $\\lambda$、$\\mu$ 和 $k$ 表示的符号表达式。", "solution": "我们将订阅者数量建模为一个定义在非负整数集上的连续时间生灭过程，其中“生”（新订阅）以与状态无关的恒定速率 $\\lambda$ 发生，而“灭”（取消订阅）在状态为 $i$ 时以速率 $\\mu i$ 发生。令 $\\pi_{k}=P(N=k)$ 表示有 $k$ 个订阅者的平稳概率。\n\n在稳态下，对于生灭过程，相邻状态之间满足细致平衡方程。从状态 $k$ 到 $k+1$ 的流率等于从状态 $k+1$ 到 $k$ 的流率：\n$$\n\\pi_{k}\\lambda=\\pi_{k+1}\\mu(k+1), \\quad k\\geq 0.\n$$\n对 $\\pi_{k+1}$ 求解，得到如下递推关系\n$$\n\\pi_{k+1}=\\frac{\\lambda}{\\mu(k+1)}\\pi_{k}.\n$$\n迭代此关系可得，对于 $k\\geq 0$，\n$$\n\\pi_{k}=\\pi_{0}\\prod_{j=0}^{k-1}\\frac{\\lambda}{\\mu(j+1)}=\\pi_{0}\\frac{\\lambda^{k}}{\\mu^{k}k!}=\\pi_{0}\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}.\n$$\n\n为确定 $\\pi_{0}$，使用归一化条件 $\\sum_{k=0}^{\\infty}\\pi_{k}=1$：\n$$\n1=\\sum_{k=0}^{\\infty}\\pi_{k}=\\pi_{0}\\sum_{k=0}^{\\infty}\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}=\\pi_{0}\\exp\\!\\left(\\frac{\\lambda}{\\mu}\\right).\n$$\n因此\n$$\n\\pi_{0}=\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right).\n$$\n所以，平稳分布是均值为 $\\lambda/\\mu$ 的泊松分布，且对于任意非负整数 $k$，\n$$\nP(N=k)=\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right)\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}.\n$$", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right)\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}}$$", "id": "1389344"}, {"introduction": "并非所有过程都能达到稳定的平衡状态；有些过程注定会走向灭绝。此练习将我们的重点转移到种群的瞬态动力学上，特别是计算它消失所需的时间。通过计算亚临界过程的平均灭绝时间，我们学习一种分析此类系统寿命的宝贵技巧。[@problem_id:697884]", "problem": "考虑一个描述种群演化的线性生灭过程。在此模型中，每个个体以速率 $\\lambda$ 产生一个新个体，并以速率 $\\mu$ 死亡。因此，对于一个大小为 $n$ 的种群，总出生率为 $\\lambda_n = n\\lambda$，总死亡率为 $\\mu_n = n\\mu$。状态 $n=0$ 是一个吸收态，代表灭绝。\n\n我们关注的是亚临界过程，其中个体死亡率超过个体出生率，即 $\\mu > \\lambda$。在这种情况下，灭绝是必然发生的。\n\n该过程在时间 $t=0$ 时从单个个体开始。令 $T_E$ 为平均灭绝时间。\n\n推导 $T_E$ 关于参数 $\\lambda$ 和 $\\mu$ 的闭式表达式。", "solution": "1. 对于个体速率为 $\\lambda$ 和 $\\mu$ 的亚临界线性生灭过程，令 $m=\\mu-\\lambda>0$。从单个个体开始，到时间 $t$ 过程尚未灭绝的概率是\n$$P(T_E>t)\\;=\\;1 - P\\{t\\text{ 时为 }0\\}\\;=\\;\\frac{(\\mu-\\lambda)e^{-m t}}{\\mu - \\lambda e^{-m t}}\\,. $$\n\n2. 平均灭绝时间是\n$$E[T_E]\\;=\\;\\int_0^{\\infty}P(T_E>t)\\,dt \n\\;=\\;\\int_0^{\\infty}\\frac{(\\mu-\\lambda)e^{-m t}}{\\mu - \\lambda e^{-m t}}\\,dt\\,. $$\n\n3. 设 $x=e^{-m t}$，可得 $dx=-m e^{-m t}dt=-m x\\,dt$，因此 $dt=-\\frac{dx}{m x}$。当 $t$ 从 $0$ 变化至 $\\infty$ 时，$x$ 从 $1$ 变化至 $0$。因此\n$$E[T_E]\n=\\int_{x=1}^{0}\\frac{(\\mu-\\lambda)x}{\\mu-\\lambda x}\\Bigl(-\\frac{dx}{m x}\\Bigr)\n=\\frac{\\mu-\\lambda}{m}\\int_0^1\\frac{dx}{\\mu-\\lambda x}\n=\\int_0^1\\frac{dx}{\\mu-\\lambda x}\\,. $$\n\n4. 计算剩余的积分，\n$$\\int_0^1\\frac{dx}{\\mu-\\lambda x}\n=\\Bigl[-\\frac{1}{\\lambda}\\ln(\\mu-\\lambda x)\\Bigr]_0^1\n=\\frac{1}{\\lambda}\\ln\\!\\Bigl(\\frac{\\mu}{\\mu-\\lambda}\\Bigr)\\,. $$\n\n因此\n$$T_E=\\frac{1}{\\lambda}\\ln\\!\\Bigl(\\frac{\\mu}{\\mu-\\lambda}\\Bigr)\\,. $$", "answer": "$$\\boxed{\\frac{1}{\\lambda}\\ln\\!\\Bigl(\\frac{\\mu}{\\mu-\\lambda}\\Bigr)}$$", "id": "697884"}, {"introduction": "现在，让我们考虑一个被限制在有限状态范围内，且两端都有吸收壁的过程。这个实践要求您确定该过程在被任一边界吸收前所花费的平均时间。您将建立并求解一个线性方程组，这是分析有限马尔可夫链平均通过时间的一种强大方法。[@problem_id:697752]", "problem": "考虑一个连续时间马尔可夫链，具体来说是一个生灭过程，其状态空间为有限集 $S = \\{0, 1, 2, \\dots, N\\}$。状态 $0$ 和 $N$ 是吸收态，意味着一旦过程进入这两个状态中的任意一个，它将永远停留在那里。对于瞬时态 $i \\in \\{1, 2, \\dots, N-1\\}$，过程以速率 $\\lambda_i$ 从状态 $i$ 转移到状态 $i+1$（一次“出生”），并以速率 $\\mu_i$ 从状态 $i$ 转移到状态 $i-1$（一次“死亡”）。\n\n该过程的具体速率由下式给出：\n- 出生率：$\\lambda_i = i\\kappa$ 对于 $i \\in \\{1, 2, \\dots, N-1\\}$\n- 死亡率：$\\mu_i = (i+1)\\kappa$ 对于 $i \\in \\{1, 2, \\dots, N-1\\}$\n此处，$\\kappa$ 是一个正常数，其单位为时间的倒数。\n\n设 $T_k$ 为从状态 $k \\in \\{1, 2, \\dots, N-1\\}$ 开始，直到过程被状态 $0$ 或状态 $N$ 吸收的平均时间。平均吸收时间 $T_i$ 满足以下对于 $i \\in \\{1, 2, \\dots, N-1\\}$ 的线性方程组：\n$$\n(\\lambda_i + \\mu_i)T_i = 1 + \\lambda_i T_{i+1} + \\mu_i T_{i-1}\n$$\n边界条件为 $T_0 = 0$ 和 $T_N = 0$。\n\n推导平均吸收时间 $T_k$ 的闭式表达式，其形式为初始状态 $k$ 和总状态数 $N+1$ 的函数。", "solution": "我们从标准的生灭过程平均吸收时间方程开始，对于 $1\\le i\\le N-1$：\n$$\n(\\lambda_i+\\mu_i)T_i=1+\\lambda_iT_{i+1}+\\mu_iT_{i-1},\\quad\nT_0=T_N=0.\n$$\n整理得：\n$$\n\\lambda_i\\bigl(T_{i+1}-T_i\\bigr)\n=\\mu_i\\bigl(T_i-T_{i-1}\\bigr)-1.\n$$\n设 $\\Delta_i=T_i-T_{i-1}$。则\n$$\n\\Delta_{i+1}\n=\\frac{\\mu_i}{\\lambda_i}\\,\\Delta_i-\\frac1{\\lambda_i}\n,\\qquad\n\\frac{\\mu_i}{\\lambda_i}\n=\\frac{(i+1)\\kappa}{i\\kappa}\n=\\frac{i+1}i.\n$$\n因此，当 $\\alpha_m=(m+1)/m$ 且 $\\phi_0=1,\\;\\phi_j=\\prod_{m=1}^j\\alpha_m$ 时，通解为\n$$\n\\Delta_i\n=\\phi_{i-1}\\Bigl[c-\\sum_{m=1}^{\\,i-1}\\frac1{\\phi_m\\,\\lambda_m}\\Bigr].\n$$\n此处 $\\phi_{i-1}=\\prod_{m=1}^{i-1}\\frac{m+1}m=i$ 且\n$$\n\\sum_{m=1}^{i-1}\\frac1{\\phi_m\\lambda_m}\n=\\sum_{m=1}^{i-1}\\frac1{(m+1)(m\\kappa)}\n=\\frac1\\kappa\\sum_{m=1}^{i-1}\\Bigl(\\frac1m-\\frac1{m+1}\\Bigr)\n=\\frac{i-1}{i\\kappa}.\n$$\n因此\n$$\n\\Delta_i\n=i\\Bigl[c-\\frac{i-1}{i\\kappa}\\Bigr]\n=i\\,c-\\frac{i-1}{\\kappa}.\n$$\n应用条件 $\\sum_{i=1}^N\\Delta_i=T_N-T_0=0$：\n$$\n0=\\sum_{i=1}^N\\Bigl(i\\,c-\\frac{i-1}{\\kappa}\\Bigr)\n=c\\frac{N(N+1)}2-\\frac1\\kappa\\frac{N(N-1)}2\n\\;\\Longrightarrow\\;\nc=\\frac{N-1}{\\kappa(N+1)}.\n$$\n因此\n$$\n\\Delta_i\n=\\frac{i(N-1)}{\\kappa(N+1)}-\\frac{i-1}{\\kappa}\n=\\frac{N+1-2i}{\\kappa(N+1)},\n\\quad\nT_k=\\sum_{i=1}^k\\Delta_i\n=\\frac1{\\kappa(N+1)}\\bigl[k(N+1)-k(k+1)\\bigr]\n=\\frac{k(N-k)}{\\kappa(N+1)}.\n$$", "answer": "$$\\boxed{\\frac{k(N-k)}{\\kappa(N+1)}}$$", "id": "697752"}]}