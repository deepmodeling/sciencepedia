{"hands_on_practices": [{"introduction": "让我们通过一个直观的例子开启实践之旅：一个在网格中移动的机器人。此问题将引导你分析在一个中心有障碍物的 $3 \\times 3$ 网格上，处于对角的两个状态是否互通。通过亲手规划机器人的移动路径，你将具体地掌握状态间相互可达性的概念，这是理解互通类与不可约性等核心定义的关键第一步 [@problem_id:1348931]。", "problem": "一个小清洁机器人在一个 3x3 大小的方形网格上移动。单元格由坐标 $(i, j)$ 标识，其中 $i, j \\in \\{1, 2, 3\\}$。中心单元格 $(2, 2)$ 有一个充电站，它是一个不可通过的障碍物，机器人永远不能占据此单元格。\n\n在每个时间步，如果机器人位于某个单元格中，它会以等概率移动到其相邻的非障碍单元格之一。如果两个单元格共享一条公共边，则它们被视为相邻。机器人在任何给定时间步的位置被视为其状态，构成一个离散时间马尔可夫链。\n\n设机器人的状态空间为它可占据的所有有效单元格的集合。我们关心角状态 $S_A = (1, 1)$ 和 $S_B = (3, 3)$ 之间的关系。根据马尔可夫链中状态的可达性和互通性的标准定义，以下哪个陈述是正确的？\n\nA. 状态 $S_A$ 和 $S_B$ 互通。\n\nB. 状态 $S_A$ 和 $S_B$ 不互通，因为状态 $S_B$ 从状态 $S_A$ 不可达。\n\nC. 状态 $S_A$ 和 $S_B$ 不互通，因为状态 $S_A$ 从状态 $S_B$ 不可达。\n\nD. 从所提供的信息无法确定状态 $S_A$ 和 $S_B$ 之间的可达性。\n\nE. 这两个状态都是吸收态，因此不与任何其他状态互通。", "solution": "我们将机器人的运动建模为状态空间 $S=\\{(i,j):i,j\\in\\{1,2,3\\}\\}\\setminus\\{(2,2)\\}$上的一个离散时间马尔可夫链。从任意状态 $x\\in S$ 出发，机器人以等概率移动到其相邻的非障碍邻居之一。若 $d(x)$ 表示 $x$ 的这类邻居的数量，那么对于相邻的 $x,y\\in S$，\n$$\nP(x,y)=\\frac{1}{d(x)},\\quad P(x,y)=0\\ \\text{otherwise}.\n$$\n根据标准定义，如果存在 $n\\in\\mathbb{N}$ 使得 $P^{n}(x,y)>0$，则称状态 $y$ 可从状态 $x$ 到达。互通意味着相互可达。\n\n设 $S_{A}=(1,1)$ 且 $S_{B}=(3,3)$。考虑一条具体路径\n$$\n(1,1)\\to(1,2)\\to(1,3)\\to(2,3)\\to(3,3),\n$$\n该路径保持在 $S$ 内，且只包含相邻步骤。根据马尔可夫性质和 $P$ 的定义，\n$$\nP^{4}(S_{A},S_{B})\\ge P\\big((1,1),(1,2)\\big)\\,P\\big((1,2),(1,3)\\big)\\,P\\big((1,3),(2,3)\\big)\\,P\\big((2,3),(3,3)\\big)\n=\\prod_{t=0}^{3}\\frac{1}{d(x_{t})}>0,\n$$\n其中 $x_{0}=(1,1)$, $x_{1}=(1,2)$, $x_{2}=(1,3)$, $x_{3}=(2,3)$。因此 $S_{B}$ 可从 $S_{A}$ 到达。\n\n上面使用的每条边都是双向的，且概率为正，因为邻接关系是对称的，并且只要 $x$ 和 $y$ 相邻，就有 $P(x,y)=\\frac{1}{d(x)}>0$。因此反向路径\n$$\n(3,3)\\to(2,3)\\to(1,3)\\to(1,2)\\to(1,1)\n$$\n可得\n$$\nP^{4}(S_{B},S_{A})\\ge \\prod_{t=0}^{3}\\frac{1}{d(y_{t})}>0,\n$$\n所以 $S_{A}$ 可从 $S_{B}$ 到达。\n\n因此 $S_{A}$ 和 $S_{B}$ 相互可达，故它们互通。这排除了选项 B、C、D。它们不是吸收态，因为对于这些角状态和边状态，均有 $d(x)\\ge 2$，所以选项 E 是错误的。正确的陈述是 A。", "answer": "$$\\boxed{A}$$", "id": "1348931"}, {"introduction": "理解了完全互通的系统后，我们来挑战一个更复杂的场景，其中状态空间会分裂为多个独立的群体。在这个问题中，一个棋子依据特定规则在一条轨道上移动，导致一些状态成为“有去无回”的陷阱。这个练习将引导你系统性地识别出不同的互通类和暂态，从而实践将一个复杂的状态空间进行完整划分的技巧 [@problem_id:1348910]。", "problem": "一个兵在一个有七个格子的线性轨道上移动，格子编号从1到7。系统的状态是兵所占据的格子的编号，因此状态空间为 $S = \\{1, 2, 3, 4, 5, 6, 7\\}$。其移动由一个随机过程控制，该过程涉及两枚有偏置的硬币，硬币A和硬币B。硬币A掷出正面的概率为 $p$，硬币B掷出正面的概率为 $q$，其中已知 $0 < p < 1$ 和 $0 < q < 1$。\n\n移动规则如下：\n\n1.  **奇数号格子：** 如果兵位于奇数号格子（$i \\in \\{1, 3, 5, 7\\}$），则掷硬币A。如果结果为正面，兵试图向右移动一格（到位置 $i+1$）。如果结果为反面，兵试图向左移动一格（到位置 $i-1$）。\n2.  **偶数号格子：** 如果兵位于偶数号格子（$i \\in \\{2, 4, 6\\}$），则掷硬币B。如果结果为正面，兵试图向右移动两格（到位置 $i+2$）。如果结果为反面，兵试图向左移动两格（到位置 $i-2$）。\n3.  **边界和特殊规则：**\n    *   如果移动会导致兵到达编号小于1的格子，则兵不移动，在该回合停留在当前格子。\n    *   如果移动会导致兵到达编号为8或更大的格子，则兵会立即被移动到格子5。\n\n该马尔可夫链的状态空间 $S$ 可以被划分为一组不相交的互通类。当且仅当状态 $i$ 可从状态 $j$ 到达（记为 $j \\to i$）且状态 $j$ 可从状态 $i$ 到达（记为 $i \\to j$）时，我们定义两个状态 $i$ 和 $j$ 属于同一个互通类。如果兵有可能最终从格子 $i$ 移动到格子 $j$，则称状态 $j$ 可从 $i$ 到达。\n\n下列哪个选项代表了状态空间 $S$ 到其互通类的正确划分？\n\nA. $\\{1, 2, 3, 4, 5, 6, 7\\}$\n\nB. $\\{1\\}, \\{3\\}, \\{7\\}, \\{2, 4, 5, 6\\}$\n\nC. $\\{1, 3, 7\\}, \\{2, 4, 5, 6\\}$\n\nD. $\\{1\\}, \\{2, 4\\}, \\{5, 6\\}, \\{3\\}, \\{7\\}$\n\nE. $\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}, \\{7\\}$", "solution": "由于 $0<p<1$ 和 $0<q<1$，每次掷硬币的两种结果都以正概率发生，因此下面列出的每一步移动都具有正概率，从而确立了可达性。\n\n应用规则（包括边界/特殊移动），一步转移如下：\n- 从 $1$（奇数）：正面 $\\Rightarrow 2$，反面 $\\Rightarrow 1$。因此 $1\\to 2$ 且 $1\\to 1$。\n- 从 $2$（偶数）：正面 $\\Rightarrow 4$，反面 $\\Rightarrow 2$。因此 $2\\to 4$ 且 $2\\to 2$。\n- 从 $3$（奇数）：正面 $\\Rightarrow 4$，反面 $\\Rightarrow 2$。因此 $3\\to 4$ 且 $3\\to 2$。\n- 从 $4$（偶数）：正面 $\\Rightarrow 6$，反面 $\\Rightarrow 2$。因此 $4\\to 6$ 且 $4\\to 2$。\n- 从 $5$（奇数）：正面 $\\Rightarrow 6$，反面 $\\Rightarrow 4$。因此 $5\\to 6$ 且 $5\\to 4$。\n- 从 $6$（偶数）：正面试图移动到 $8$ 并被送到 $5$，反面 $\\Rightarrow 4$。因此 $6\\to 5$ 且 $6\\to 4$。\n- 从 $7$（奇数）：正面试图移动到 $8$ 并被送到 $5$，反面 $\\Rightarrow 6$。因此 $7\\to 5$ 且 $7\\to 6$。\n\n考虑子集 $\\{2,4,5,6\\}$。从 $2,4,5,6$ 中的任意一个状态出发，转移都保持在 $\\{2,4,5,6\\}$ 内部，所以这个集合是闭合的。此外，内部的状态是相互可达的：\n- 通过 $2\\to 4$ 和 $4\\to 2$，$2\\leftrightarrow 4$。\n- 通过 $4\\to 6$ 和 $6\\to 4$，$4\\leftrightarrow 6$。\n- 通过 $6\\to 5$ 和 $5\\to 6$，$6\\leftrightarrow 5$。\n- 通过 $5\\to 4$ 和 $4\\to 6\\to 5$，$5\\leftrightarrow 4$。\n这给出了 $\\{2,4,5,6\\}$ 中任意一对状态之间的路径。因此 $\\{2,4,5,6\\}$ 是一个互通类。\n\n从 $1$、$3$ 和 $7$ 可以进入 $\\{2,4,5,6\\}$：\n- $1\\to 2$，\n- $3\\to 2$ 或 $3\\to 4$，\n- $7\\to 6$ 或 $7\\to 5$。\n然而，$\\{2,4,5,6\\}$ 中的任何状态都无法到达 $1$、$3$ 或 $7$，因为从 $\\{2,4,5,6\\}$ 出发的所有转移都停留在这个集合内。因此，$1$、$3$ 和 $7$ 不与任何其他状态互通。\n\n最后，这三个状态彼此之间也不互通：\n- 从 $1$ 出发，任何移动到其他状态都会去到 $2$，之后链被困在闭合类中，无法到达 $3$ 或 $7$，所以 $1\\not\\to 3$ 且 $1\\not\\to 7$。\n- 从 $3$ 出发，任何移动都会去到 $2$ 或 $4$，然后停留在闭合类中，所以 $3\\not\\to 1$ 且 $3\\not\\to 7$。\n- 从 $7$ 出发，任何移动都会去到 $6$ 或 $5$，然后停留在闭合类中，所以 $7\\not\\to 1$ 且 $7\\not\\to 3$。\n\n因此，互通类是单元素集 $\\{1\\}$、$\\{3\\}$、$\\{7\\}$ 和闭合类 $\\{2,4,5,6\\}$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1348910"}, {"introduction": "最后，我们将实践从有限的状态空间推向无限的整数域。本题模拟了一个在整数轴上的随机游走，其转移概率 $p_i$ 具有周期性，但始终保证了向左 $(1-p_i)$ 和向右 $(p_i)$ 移动的可能性。你的任务不再是检查有限的路径，而是要运用更抽象的推理来判断整个无限状态空间是否构成一个单一的互通类。这个练习旨在提升你将核心概念应用于无限和抽象系统的能力，从而更深刻地理解不可约性 [@problem_id:1348897]。", "problem": "考虑一个离散时间马尔可夫链 $\\{X_n\\}_{n \\ge 0}$，其状态空间为 $S = \\mathbb{Z}$，即所有整数的集合。对于任何状态 $i \\in \\mathbb{Z}$，允许的转移是到相邻的整数 $i-1$ 和 $i+1$。转移概率由以下公式给出：\n$P(X_{n+1} = i+1 | X_n = i) = p_i$\n$P(X_{n+1} = i-1 | X_n = i) = 1 - p_i$\n\n向右移动的概率 $p_i$ 是周期的，其整数周期为 $k > 1$，使得对于所有 $i \\in \\mathbb{Z}$ 都有 $p_i = p_{i+k}$。此外，已知对于所有 $j \\in \\{0, 1, \\dots, k-1\\}$，都有 $0 < p_j < 1$。\n\n根据此定义，评估以下陈述：\nI. 状态 0 和状态 $k$ 互通。\nII. 该马尔可夫链是不可约的。\nIII. 该马尔可夫链恰好由 $k$ 个不同的互通类组成。\nIV. 在此链中，可达性不是对称关系；也就是说，存在状态 $i$ 和 $j$，使得 $j$ 可从 $i$ 到达，但 $i$ 不可从 $j$ 到达。\n\n以上陈述中哪些是正确的？\nA. 仅 II\n\nB. I, II 和 IV\n\nC. 仅 III 和 IV\n\nD. 仅 I 和 II\n\nE. 仅 IV", "solution": "我们考虑一个在 $S=\\mathbb{Z}$ 上的离散时间马尔可夫链，其转移为最近邻转移，转移概率为 $P(X_{n+1}=i+1 \\mid X_{n}=i)=p_{i}$ 和 $P(X_{n+1}=i-1 \\mid X_{n}=i)=1-p_{i}$，其中对于固定的整数周期 $k>1$ 有 $p_{i}=p_{i+k}$，并且对于所有 $j\\in\\{0,1,\\dots,k-1\\}$ 有 $0<p_{j}<1$。根据周期性，可以得出对于所有 $i\\in\\mathbb{Z}$，都有 $0<p_{i}<1$ 和 $0<1-p_{i}<1$。\n\n我们回顾一下定义。如果存在 $n\\in\\mathbb{N}$ 使得 $P^{n}(i,j)>0$，则称状态 $j$ 可从状态 $i$ 到达。如果两个状态 $i$ 和 $j$ 相互可达，则它们互通。如果所有状态都属于同一个互通类，则该链是不可约的。\n\n为了检验陈述 I（状态 0 和状态 $k$ 互通），我们构造具体的路径。从 0 到 $k$，考虑 $k$ 次向右移动的确定性路径：\n$$\n0 \\to 1 \\to 2 \\to \\dots \\to k.\n$$\n该路径的概率是乘积 $\\prod_{r=0}^{k-1} p_{r}$，由于每个 $p_{r}>0$，该乘积严格为正。因此 $P^{k}(0,k)\\ge \\prod_{r=0}^{k-1} p_{r}>0$，所以 $k$ 可从 $0$ 到达。对于反向，使用 $k$ 次向左移动：\n$$\nk \\to k-1 \\to \\dots \\to 0,\n$$\n其路径概率为 $\\prod_{r=1}^{k} (1-p_{r})$，由于每个 $1-p_{r}>0$，该乘积也严格为正。因此 $P^{k}(k,0)\\ge \\prod_{r=1}^{k}(1-p_{r})>0$，所以 $0$ 可从 $k$ 到达。因此，0 和 $k$ 互通，陈述 I 为真。\n\n为了检验陈述 II（不可约性），取任意的 $i,j\\in\\mathbb{Z}$。如果 $j\\ge i$，考虑 $j-i$ 次向右移动的路径\n$$\ni \\to i+1 \\to \\dots \\to j,\n$$\n其路径概率为 $\\prod_{r=i}^{j-1} p_{r}>0$，这意味着 $P^{j-i}(i,j)>0$。对于从 $j$ 到 $i$ 的反向，进行 $j-i$ 次向左移动，其路径概率为 $\\prod_{r=i+1}^{j} (1-p_{r})>0$，这意味着 $P^{j-i}(j,i)>0$。如果 $j<i$，则应用相同的推理，从 $i$ 到 $j$ 进行向左移动，从 $j$ 到 $i$ 进行向右移动。因此，任意一对状态都互通，所以该链是不可约的。陈述 II 为真。\n\n陈述 III 声称恰好有 $k$ 个不同的互通类。由于我们已经证明该链是不可约的，所以只有一个互通类，而不是 $k$ 个。因此陈述 III 为假。\n\n对于陈述 IV（可达性非对称），我们分析可达性的对称性。假设 $j$ 可从 $i$ 到达，那么存在 $n$ 和一条路径 $i=s_{0},s_{1},\\dots,s_{n}=j$，其中每一步 $s_{t+1}=s_{t}\\pm 1$，且路径概率 $\\prod_{t=0}^{n-1} \\left( \\mathbf{1}_{\\{s_{t+1}=s_{t}+1\\}}\\, p_{s_{t}} + \\mathbf{1}_{\\{s_{t+1}=s_{t}-1\\}}\\, (1-p_{s_{t}}) \\right)>0$。考虑反向路径 $j=s_{n},s_{n-1},\\dots,s_{0}=i$。每一步反向移动也是一个具有正概率的最近邻转移：如果正向步骤是 $s\\to s+1$，使用了 $p_{s}>0$，则反向步骤 $s+1\\to s$ 使用 $1-p_{s+1}>0$；如果正向步骤是 $s\\to s-1$，使用了 $1-p_{s}>0$，则反向步骤 $s-1\\to s$ 使用 $p_{s-1}>0$。因此，反向路径具有严格为正的概率，这意味着 $P^{n}(j,i)>0$。因此，在此链中可达性是对称的。声称存在非对称可达性的陈述 IV 是假的。\n\n综合这些结果：I 为真，II 为真，III 为假，IV 为假。正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "1348897"}]}