{"hands_on_practices": [{"introduction": "这个练习是赌徒破产问题的基石。我们将计算在一个非对称博弈（即硬币不公平）中，赌徒从初始资本 $i$ 出发，最终破产的概率。通过建立一个基于单步分析的递推关系并求解它，你将掌握解决此类随机过程问题的核心数学工具。[@problem_id:7867]", "problem": "一位名叫 Alice 的赌徒，进行一场连续的概率游戏。她以 $i$ 美元的初始赌本开始，其中 $i$ 是一个整数。她的目标是达到 $N$ 美元的总赌本，其中 $N > i$。如果她的赌本降至 $0$ 美元，她就破产了，必须停止游戏。\n\n在每一轮游戏中，她下注一美元。她以恒定的概率 $p$ 赢得该轮（赌本增加 1 美元），并以概率 $q = 1-p$ 输掉该轮（赌本减少 1 美元）。游戏使用的是一枚不公平的硬币，即 $p \\neq q$。\n\n设 $P_k$ 为在当前拥有 $k$ 美元的情况下，Alice 最终破产（即她的赌本达到 $0$）的概率。你的任务是求解给定初始赌本下的破产概率 $P_i$。\n\n请推导出一个关于破产概率 $P_i$ 的闭式表达式，该表达式用她的初始赌本 $i$、目标赌本 $N$ 以及概率 $p$ 和 $q$ 来表示。", "solution": "设 $P_k$ 为在起始赌本为 $k$ 的情况下，赌徒的赌本在达到 $N$ 之前先达到 $0$ 的概率。我们要求解的是 $P_i$。可能的赌本范围是整数集合 $\\{0, 1, 2, ..., N\\}$。\n\n首先，我们建立该问题的边界条件。\n如果起始赌本为 $k=0$，则赌徒已经破产。因此，破产概率为 $1$。\n$$\nP_0 = 1\n$$\n如果起始赌本为 $k=N$，则赌徒已达到目标，游戏结束。从此状态开始的破产概率为 $0$。\n$$\nP_N = 0\n$$\n\n对于任何满足 $0 < k < N$ 的中间赌本 $k$，我们可以通过对下一轮的结果进行条件分析，来建立 $P_k$ 的一个递推关系。\n- 以概率 $p$，赌徒赢得下一轮，她的赌本变为 $k+1$。从这个新状态开始的破产概率是 $P_{k+1}$。\n- 以概率 $q$，她输掉下一轮，她的赌本变为 $k-1$。从这个新状态开始的破产概率是 $P_{k-1}$。\n\n根据全概率定律，$P_k$ 是这两种结果的加权平均值：\n$$\nP_k = p P_{k+1} + q P_{k-1}\n$$\n由于 $p+q=1$，我们可以将 $P_k$ 重写为 $(p+q)P_k = pP_k + qP_k$。将此代入关系式中：\n$$\np P_k + q P_k = p P_{k+1} + q P_{k-1}\n$$\n重新整理各项，我们将含 $p$ 的项和含 $q$ 的项分别组合：\n$$\nq (P_k - P_{k-1}) = p (P_{k+1} - P_k)\n$$\n我们定义连续状态之间的概率差为 $\\Delta_k = P_k - P_{k-1}$。方程变为：\n$$\nq \\Delta_k = p \\Delta_{k+1}\n$$\n这样就得到了一个关于差值的简单关系：\n$$\n\\Delta_{k+1} = \\frac{q}{p} \\Delta_k\n$$\n这表明差值 $\\Delta_k$ 构成一个公比为 $r = q/p$ 的等比数列。我们可以用第一个差值 $\\Delta_1 = P_1 - P_0$ 来表示任何差值 $\\Delta_k$：\n$$\n\\Delta_k = \\left(\\frac{q}{p}\\right)^{k-1} \\Delta_1\n$$\n现在，我们可以通过从 $P_0$ 开始对这些差值求和来表示 $P_k$：\n$$\nP_k = P_0 + \\sum_{j=1}^{k} (P_j - P_{j-1}) = P_0 + \\sum_{j=1}^{k} \\Delta_j\n$$\n代入 $\\Delta_j$ 的表达式：\n$$\nP_k = P_0 + \\sum_{j=1}^{k} \\left(\\frac{q}{p}\\right)^{j-1} \\Delta_1 = P_0 + \\Delta_1 \\sum_{j=0}^{k-1} \\left(\\frac{q}{p}\\right)^j\n$$\n这个和是一个有限项的等比级数。由于题目说明 $p \\neq q$，公比 $r=q/p \\neq 1$。等比级数的求和公式为 $\\sum_{j=0}^{n} r^j = \\frac{1-r^{n+1}}{1-r}$。应用此公式：\n$$\nP_k = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\n我们有两个未知数，$P_0$ 和 $\\Delta_1$。我们使用边界条件来求解它们。我们已经知道 $P_0=1$。我们也可以将 $\\Delta_1$ 表示为 $P_1-P_0 = P_1 - 1$。\n所以，$\\Delta_1$ 是一个我们需要确定的未知常数。让我们使用另一个边界条件，$P_N=0$：\n$$\n0 = P_N = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\n代入 $P_0=1$：\n$$\n0 = 1 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\n求解 $\\Delta_1$：\n$$\n\\Delta_1 = - \\frac{1 - q/p}{1 - (q/p)^N}\n$$\n现在我们将 $\\Delta_1$ 的这个表达式代回我们的 $P_k$ 方程中：\n$$\nP_k = P_0 + \\left( - \\frac{1 - q/p}{1 - (q/p)^N} \\right) \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\n再次使用 $P_0=1$ 并通过消去 $(1-q/p)$ 项来进行化简：\n$$\nP_k = 1 - \\frac{1 - (q/p)^k}{1 - (q/p)^N}\n$$\n为了得到一个单一的分数项，我们通分：\n$$\nP_k = \\frac{(1 - (q/p)^N) - (1 - (q/p)^k)}{1 - (q/p)^N} = \\frac{1 - (q/p)^N - 1 + (q/p)^k}{1 - (q/p)^N}\n$$\n化简后得到从赌本 $k$ 开始的破产概率的通解：\n$$\nP_k = \\frac{(q/p)^k - (q/p)^N}{1 - (q/p)^N}\n$$\n问题要求的是从初始赌本 $i$ 开始的破产概率。我们只需在通解中令 $k=i$ 即可。\n$$\nP_i = \\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}\n$$\n这就是破产概率的最终表达式。", "answer": "$$\n\\boxed{\\frac{\\left(\\frac{q}{p}\\right)^i - \\left(\\frac{q}{p}\\right)^N}{1 - \\left(\\frac{q}{p}\\right)^N}}\n$$", "id": "7867"}, {"introduction": "在掌握了基本模型后，让我们来探讨一个看似更复杂的情形：如果博弈中存在平局的可能性会怎样？直觉上，这似乎会改变最终的破产概率。这个练习将挑战你的直觉，并揭示一个深刻的原理：对于最终的破产结局而言，重要的是赢与输的相对可能性，而过程中的平局只会延长博弈的时间。[@problem_id:7893]", "problem": "考虑一个经典赌徒破产问题的修改版本。一个赌徒从 $i$ 单位的初始资本开始，其中 $i$ 是一个满足 $0 < i < N$ 的整数。赌徒与一个拥有 $N-i$ 初始资本的对手进行一系列的对局。游戏中的总资本固定为 $N$ 单位。\n\n在每一局中，赌徒下注一单位。一局的可能结果有：\n- 赌徒以概率 $p$ 赢得此局。其资本增加一单位。\n- 赌徒以概率 $q$ 输掉此局。其资本减少一单位。\n- 此局为平局，概率为 $r$。赌徒的资本保持不变。\n\n每局的概率都是恒定的，其中 $p, q, r > 0$ 且 $p+q+r=1$。当赌徒的资本达到 0（称为“破产”事件）或 $N$（称为“胜利”事件）时，游戏结束。\n\n令 $P_i$ 为赌徒在初始资本为 $i$ 的情况下最终破产的概率。假设赢一局的概率不等于输一局的概率，即 $p \\neq q$。\n\n推导破产概率 $P_i$ 的通用表达式，用初始资本 $i$、总资本 $N$ 以及概率 $p$ 和 $q$ 来表示。", "solution": "我们用 $P_i$ 表示从资本 $i$ 开始最终破产的概率。由于每局赢的概率为 $p$，输的概率为 $q$，平局的概率为 $r$，且 $p+q+r=1$，对于 $1\\le i\\le N-1$ 的单步递推关系为\n$$P_i \\;=\\; p\\,P_{i+1}\\;+\\;q\\,P_{i-1}\\;+\\;r\\,P_i.$$\n整理，并使用 $1-r=p+q$，得到齐次差分方程\n$$p\\,P_{i+1} \\;-\\;(p+q)\\,P_i\\;+\\;q\\,P_{i-1}\\;=\\;0.$$\n其特征方程为\n$$p\\lambda^2-(p+q)\\lambda+q=0,$$\n其解为\n$$\\lambda_1=1,\\qquad \\lambda_2=\\frac{q}{p}\\quad(p\\neq q).$$\n因此，通解为\n$$P_i=A+B\\Bigl(\\frac{q}{p}\\Bigr)^i.$$\n施加边界条件 $P_0=1$ 和 $P_N=0$ 可得\n$$A+B=1,\\qquad A+B\\Bigl(\\frac{q}{p}\\Bigr)^N=0.$$\n求解 $A,B$ 可得\n$$B=\\frac{1}{1-(q/p)^N},\\quad A=-\\frac{(q/p)^N}{1-(q/p)^N}.$$\n因此，破产的概率为\n$$\nP_i\n=\\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}.\n$$", "answer": "$$\\boxed{\\frac{\\bigl(\\frac{q}{p}\\bigr)^i - \\bigl(\\frac{q}{p}\\bigr)^N}{1 - \\bigl(\\frac{q}{p}\\bigr)^N}}$$", "id": "7893"}, {"introduction": "现实世界中的许多过程的概率并非一成不变。这个练习将我们带出基本模型的简化假设，进入一个更动态的场景，其中每一步的输赢概率取决于赌徒当前的资本状态。通过解决这个位置依赖的随机游走问题，你将体会到递推关系方法的强大通用性，以及它如何应用于更复杂的随机模型。[@problem_id:1398174]", "problem": "一个粒子在整数集合 $\\{0, 1, 2, \\dots, N\\}$ 上进行一维随机游走，其中 $N$ 是一个大于 1 的正整数。位置 $0$ 和 $N$ 是吸收壁。当粒子处于任何满足 $0 < i < N$ 的整数位置 $i$ 时，它将在下一个离散时间步以概率 $p_i$ 移动到位置 $i+1$，或以概率 $q_i = 1-p_i$ 移动到位置 $i-1$。移动的概率是与位置相关的。具体来说，从任意状态 $i$ 向左移动（位置减小）的概率与向右移动（位置增大）的概率之比由下式给出：\n$$\n\\frac{q_i}{p_i} = \\frac{i}{i+1}\n$$\n假设粒子从初始位置 $k$ 开始，其中 $k$ 是一个满足 $0 < k < N$ 的整数。求该粒子在被吸收壁 $0$ 吸收之前，先被吸收壁 $N$ 吸收的概率。\n\n你的最终答案应为一个解析表达式，用 $k$、$N$ 和调和数函数 $H_n$ 表示。调和数函数定义为前 $n$ 个正整数的倒数之和：$H_n = \\sum_{j=1}^{n} \\frac{1}{j}$。", "solution": "设 $h_{i}$ 表示从位置 $i$ 开始的粒子在被 $0$ 吸收之前被 $N$ 吸收的概率。边界条件为 $h_{0}=0$ 和 $h_{N}=1$。对于 $0<i<N$，通过单步条件分析可得递推关系\n$$\nh_{i}=p_{i}h_{i+1}+q_{i}h_{i-1}.\n$$\n整理得，\n$$\np_{i}\\left(h_{i+1}-h_{i}\\right)=q_{i}\\left(h_{i}-h_{i-1}\\right).\n$$\n定义前向差分 $d_{i}=h_{i}-h_{i-1}$，其中 $i\\geq 1$。那么对于 $1\\leq i\\leq N-1$，\n$$\np_{i}d_{i+1}=q_{i}d_{i}\\quad\\Longrightarrow\\quad d_{i+1}=\\frac{q_{i}}{p_{i}}\\,d_{i}.\n$$\n利用 $r_{i}=\\frac{q_{i}}{p_{i}}$ 以及给定的比率 $r_{i}=\\frac{i}{i+1}$，我们得到\n$$\nd_{j}=d_{1}\\prod_{m=1}^{j-1}r_{m}=d_{1}\\prod_{m=1}^{j-1}\\frac{m}{m+1}=\\frac{d_{1}}{j}\\quad\\text{对于 }j=1,2,\\dots,N\n$$\n利用连乘积的对消特性 $\\prod_{m=1}^{j-1}\\frac{m}{m+1}=\\frac{1}{j}$。由于 $h_{0}=0$，我们有\n$$\nh_{k}=\\sum_{j=1}^{k}d_{j}=d_{1}\\sum_{j=1}^{k}\\frac{1}{j}=d_{1}H_{k}.\n$$\n应用边界条件 $h_{N}=1$ 可得\n$$\n1=h_{N}=d_{1}H_{N}\\quad\\Longrightarrow\\quad d_{1}=\\frac{1}{H_{N}}.\n$$\n因此，\n$$\nh_{k}=\\frac{H_{k}}{H_{N}}.\n$$\n这就是从 $k$ 开始的粒子在被 $0$ 吸收之前被 $N$ 吸收的所求概率。", "answer": "$$\\boxed{\\frac{H_{k}}{H_{N}}}$$", "id": "1398174"}]}