{"hands_on_practices": [{"introduction": "时间可逆性不仅是一个理论上的优美性质，它还是一个强大的计算工具。在许多现实世界的系统中，例如化学反应或蛋白质折叠模型，我们可能知道系统达到稳态时的概率分布，以及部分状态之间的转移速率。[@problem_id:1407749] 这个练习将向您展示，如何利用细致平衡条件，像侦探一样，根据已知信息推算出马尔可夫链转移矩阵中的未知元素，从而完整地刻画整个系统的动态行为。", "problem": "一个简化的蛋白质模型使用三种不同的状态来描述其构象：状态1、状态2和状态3。该蛋白质在离散时间步下在这些状态之间转换，遵循离散时间马尔可夫链的动力学。\n\n经过很长时间后，系统达到一个统计平衡状态，此时发现蛋白质处于每个状态的概率是恒定的。该平稳分布由向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$ 给出，其中 $\\pi_1 = 1/2$，$\\pi_2 = 1/4$，且 $\\pi_3 = 1/4$。\n\n已知其潜在的物理过程是时间可逆的，这意味着该马尔可夫链相对于其平稳分布 $\\pi$ 满足细致平衡条件。\n\n该链的转移矩阵 $P$ 中，从状态1转移到状态2的概率为 $P_{12} = 1/3$。从状态3转移到状态2的概率为 $P_{32} = 1/5$。\n\n根据这些信息，蛋白质在一个时间步内保持在状态2的概率是多少，即 $P_{22}$ 的值是多少？\n\nA. $1/15$\n\nB. $2/15$\n\nC. $1/5$\n\nD. $4/15$\n\nE. $7/15$\n\nF. $8/15$", "solution": "该链是时间可逆的，其平稳分布为 $\\pi=(\\pi_1, \\pi_2, \\pi_3)$，其中 $\\pi_1 = \\frac{1}{2}$，$\\pi_2 = \\frac{1}{4}$，且 $\\pi_3 = \\frac{1}{4}$。时间可逆性意味着满足细致平衡条件\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{对于所有 }i,j.\n$$\n使用给定的 $P_{12} = \\frac{1}{3}$，对状态1和状态2应用细致平衡条件：\n$$\n\\pi_1 P_{12} = \\pi_2 P_{21} \\;\\Rightarrow\\; \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{4} P_{21} \\;\\Rightarrow\\; P_{21} = \\frac{1/6}{1/4} = \\frac{2}{3}.\n$$\n使用给定的 $P_{32} = \\frac{1}{5}$，对状态3和状态2应用细致平衡条件：\n$$\n\\pi_3 P_{32} = \\pi_2 P_{23} \\;\\Rightarrow\\; \\frac{1}{4} \\cdot \\frac{1}{5} = \\frac{1}{4} P_{23} \\;\\Rightarrow\\; P_{23} = \\frac{1/20}{1/4} = \\frac{1}{5}.\n$$\n由于 $P$ 的每一行之和为1，对于第2行我们有\n$$\nP_{21} + P_{22} + P_{23} = 1.\n$$\n代入 $P_{21} = \\frac{2}{3}$ 和 $P_{23} = \\frac{1}{5}$ 得到\n$$\nP_{22} = 1 - \\frac{2}{3} - \\frac{1}{5} = \\frac{15}{15} - \\frac{10}{15} - \\frac{3}{15} = \\frac{2}{15}.\n$$\n这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1407749"}, {"introduction": "一个系统在什么条件下才是时间可逆的？仅仅会计算是不够的，理解其背后的物理或结构直觉更为重要。[@problem_id:1407763] 在这个练习中，我们将分析一个简单的环形随机游走模型，其中粒子可能倾向于向某个方向移动。您需要找出使这个过程满足时间可逆性的精确条件，从而揭示细致平衡、转移概率的对称性与系统中是否存在“净概率流”之间的深刻联系。", "problem": "一个粒子被限制在三个不同的位置之间移动，这三个位置标记为 1、2、3，并排列成一个环。粒子的位置在离散的时间步长上被观察。在每一步，如果粒子位于位置 $i \\in \\{1, 2, 3\\}$，它将以概率 $\\alpha$ 跳转到位置 $(i \\pmod 3) + 1$，或以概率 $1-\\alpha$ 跳转到位置 $((i-2) \\pmod 3) + 1$。参数 $\\alpha$ 是一个常数，满足 $0 < \\alpha < 1$。\n\n经过很长时间后，假设系统达到一个稳态，其特征为一个平稳概率分布 $(\\pi_1, \\pi_2, \\pi_3)$，其中 $\\pi_i$ 是在位置 $i$ 找到粒子的概率。如果对于这个平稳分布，从任何位置 $i$ 到任何位置 $j$ 的转移速率等于从位置 $j$ 回到位置 $i$ 的转移速率，则该过程被定义为时间可逆的。\n\n确定使该随机游走过程时间可逆的 $\\alpha$ 的具体数值。", "solution": "设马尔可夫链的状态空间为 $S = \\{1, 2, 3\\}$。问题描述了转移概率。我们用 $P_{ij}$ 表示从状态 $i$ 到状态 $j$ 的转移概率。问题陈述给出：\n- 从位置 $i$ 到位置 $(i \\pmod 3) + 1$：这对应于移动 $1 \\to 2$、$2 \\to 3$ 和 $3 \\to 1$。概率为 $\\alpha$。\n- 从位置 $i$ 到位置 $((i-2) \\pmod 3) + 1$：这对应于移动 $1 \\to 3$、$2 \\to 1$ 和 $3 \\to 2$。概率为 $1-\\alpha$。\n\n状态 $(1, 2, 3)$ 的转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\nP_{11} & P_{12} & P_{13} \\\\\nP_{21} & P_{22} & P_{23} \\\\\nP_{31} & P_{32} & P_{33}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & \\alpha & 1-\\alpha \\\\\n1-\\alpha & 0 & \\alpha \\\\\n\\alpha & 1-\\alpha & 0\n\\end{pmatrix}\n$$\n\n首先，我们必须找到平稳分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$，它满足方程 $\\pi P = \\pi$ 和归一化条件 $\\sum_{i=1}^{3} \\pi_i = 1$。方程 $\\pi P = \\pi$ 导出了以下线性方程组：\n1. $\\pi_1 = (1-\\alpha)\\pi_2 + \\alpha\\pi_3$\n2. $\\pi_2 = \\alpha\\pi_1 + (1-\\alpha)\\pi_3$\n3. $\\pi_3 = (1-\\alpha)\\pi_1 + \\alpha\\pi_2$\n\n由于问题的循环对称性（从任何位置跳转的规则在结构上是相同的），我们可以假设平稳分布是均匀的，即 $\\pi_1 = \\pi_2 = \\pi_3$。\n使用归一化条件 $\\pi_1 + \\pi_2 + \\pi_3 = 1$，我们得到 $3\\pi_1 = 1$，这意味着 $\\pi_1 = \\pi_2 = \\pi_3 = 1/3$。\n\n让我们验证对于任何 $\\alpha \\in (0,1)$，$\\pi = (1/3, 1/3, 1/3)$ 是否满足该方程组：\n对于方程 1：\n$$ (1-\\alpha)\\frac{1}{3} + \\alpha\\frac{1}{3} = \\frac{1-\\alpha+\\alpha}{3} = \\frac{1}{3} = \\pi_1 $$\n此式成立。通过对称性，其他两个方程也成立。因此，该马尔可夫链的平稳分布为 $\\pi = (1/3, 1/3, 1/3)$，与 $\\alpha$ 的值无关。\n\n现在，我们应用时间可逆性条件。问题将其表述为“从任何位置 $i$ 到任何位置 $j$ 的转移速率等于从位置 $j$ 回到位置 $i$ 的转移速率”。从 $i$ 到 $j$ 的转移速率是在状态 $i$ 的概率 ($\\pi_i$) 乘以从 $i$ 转移到 $j$ 的概率 ($P_{ij}$)。所以，时间可逆性的条件是细致平衡条件：\n$$ \\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{for all } i, j \\in S $$\n\n我们只需要对具有非零转移概率的状态对检查此条件。\n让我们检查状态对 (1, 2)：\n$$ \\pi_1 P_{12} = \\pi_2 P_{21} $$\n代入已知值：\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ 2\\alpha = 1 $$\n$$ \\alpha = \\frac{1}{2} $$\n\n让我们检查状态对 (2, 3)：\n$$ \\pi_2 P_{23} = \\pi_3 P_{32} $$\n代入已知值：\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ \\alpha = \\frac{1}{2} $$\n\n最后，让我们检查状态对 (3, 1)：\n$$ \\pi_3 P_{31} = \\pi_1 P_{13} $$\n代入已知值：\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ \\alpha = \\frac{1}{2} $$\n\n当且仅当 $\\alpha = 1/2$ 时，所有状态对都满足细致平衡条件。对于任何其他 $\\alpha$ 值，该链都不是时间可逆的。例如，如果 $\\alpha > 1/2$，则存在一个沿 $1 \\to 2 \\to 3 \\to 1$ 方向的净概率流。\n\n因此，使该过程时间可逆的 $\\alpha$ 的具体数值是 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1407763"}, {"introduction": "可逆马尔可夫链的原理可以优雅地扩展到具有巨大状态空间的复杂系统中。[@problem_id:1407802] 这个问题将我们带入高维的“超立方体”世界，这是统计物理、计算机科学和遗传学中常见的模型。通过这个练习，您将掌握一种源于细致平衡的强大技巧，它使我们能够直接比较不同系统状态的相对稳态概率，而无需计算整个庞大而复杂的平稳分布，这在处理大规模问题时尤其有用。", "problem": "考虑一个由$n$个相互作用元素组成的系统，其中系统的状态由一个二进制向量$x = (x_1, x_2, \\dots, x_n) \\in \\{0, 1\\}^n$表示。该系统根据一个定义在$n$-超立方体上的马尔可夫链在离散时间步上演化。\n\n转移机制如下：在任何给定状态$x$下，选择一个坐标索引$j \\in \\{1, \\dots, n\\}$进行翻转。选择索引$j$的概率取决于比特$x_j$的当前值。具体来说，如果$x_j=0$，则选择索引$j$的权重为$\\alpha_j$；如果$x_j=1$，则为$\\beta_j$，其中所有的$\\alpha_j$和$\\beta_j$都是正常数。选择索引$j$的概率是其权重除以当前状态$x$的所有权重之和。一旦选择了索引$j$，系统就确定性地转移到新状态$x^{(j)}$，该状态与$x$相同，只是第$j$个比特被翻转了。\n\n已知该马尔可夫链关于其唯一的平稳分布$\\pi(x)$是时间可逆的。\n\n对于一个$n=4$的系统，权重参数由向量$\\vec{\\alpha} = (1, 2, 3, 4)$和$\\vec{\\beta} = (4, 3, 2, 1)$给出。\n\n求状态$x_A = (1, 0, 1, 0)$和$x_B = (0, 1, 0, 1)$的平稳概率之比$\\pi(x_A) / \\pi(x_B)$。\n\n请以最简精确分数形式给出你的答案。", "solution": "设$w_{j}(x)$表示在状态$x$下选择坐标$j$所用的权重，即\n$$\nw_{j}(x) =\n\\begin{cases}\n\\alpha_{j}, & \\text{若 } x_{j}=0,\\\\\n\\beta_{j}, & \\text{若 } x_{j}=1,\n\\end{cases}\n$$\n并设$W(x) = \\sum_{k=1}^{n} w_{k}(x)$为状态$x$下的总权重。从$x$到$x^{(j)}$的转移概率为\n$$\nP(x, x^{(j)}) = \\frac{w_{j}(x)}{W(x)}.\n$$\n关于平稳分布$\\pi$的时间可逆性意味着细致平衡：\n$$\n\\pi(x) P(x, x^{(j)}) = \\pi(x^{(j)}) P(x^{(j)}, x).\n$$\n因此，对于相邻状态$x$和$x^{(j)}$，\n$$\n\\frac{\\pi(x)}{\\pi(x^{(j)})} = \\frac{P(x^{(j)}, x)}{P(x, x^{(j)})} = \\frac{w_{j}(x^{(j)})}{W(x^{(j)})} \\cdot \\frac{W(x)}{w_{j}(x)}.\n$$\n设$(x_{0}, x_{1}, \\dots, x_{m})$是从$x_{0}=x_{A}$到$x_{m}=x_{B}$的任意路径，其中每个$x_{s+1}$都是通过翻转$x_{s}$的一个坐标$j_{s}$得到的。将路径上的细致平衡比率相乘可得\n$$\n\\frac{\\pi(x_{A})}{\\pi(x_{B})}\n= \\prod_{s=0}^{m-1} \\frac{\\pi(x_{s})}{\\pi(x_{s+1})}\n= \\prod_{s=0}^{m-1} \\left( \\frac{w_{j_{s}}(x_{s+1})}{w_{j_{s}}(x_{s})} \\cdot \\frac{W(x_{s})}{W(x_{s+1})} \\right)\n= \\frac{W(x_{A})}{W(x_{B})} \\cdot \\prod_{s=0}^{m-1} \\frac{w_{j_{s}}(x_{s+1})}{w_{j_{s}}(x_{s})},\n$$\n因为$W$项连消为$W(x_{A})/W(x_{B})$。如果一个比特$j$从$x_{A}$到$x_{B}$被翻转一次，那么$w_{j}$贡献的因子是$w_{j}(x_{B})/w_{j}(x_{A})$；翻转偶数次的比特净贡献因子为$1$。因此，取一条最短路径，该路径恰好翻转$x_A$和$x_B$中不同的比特位，我们得到与路径无关的公式\n$$\n\\frac{\\pi(x_{A})}{\\pi(x_{B})} = \\frac{W(x_{A})}{W(x_{B})} \\prod_{j:\\, x_{A,j} \\neq x_{B,j}} \\frac{w_{j}(x_{B})}{w_{j}(x_{A})}.\n$$\n\n对于$n=4$，其中$\\vec{\\alpha}=(1,2,3,4)$和$\\vec{\\beta}=(4,3,2,1)$，我们计算$x_{A}=(1,0,1,0)$和$x_{B}=(0,1,0,1)$的$w_{j}(x)$和$W(x)$。\n\n对于$x_{A}=(1,0,1,0)$：\n- $w_{1}(x_{A})=\\beta_{1}=4$, $w_{2}(x_{A})=\\alpha_{2}=2$, $w_{3}(x_{A})=\\beta_{3}=2$, $w_{4}(x_{A})=\\alpha_{4}=4$,\n因此\n$$\nW(x_{A})=4+2+2+4=12.\n$$\n\n对于$x_{B}=(0,1,0,1)$：\n- $w_{1}(x_{B})=\\alpha_{1}=1$, $w_{2}(x_{B})=\\beta_{2}=3$, $w_{3}(x_{B})=\\alpha_{3}=3$, $w_{4}(x_{B})=\\beta_{4}=1$,\n因此\n$$\nW(x_{B})=1+3+3+1=8.\n$$\n\n$x_{A}$和$x_{B}$之间的所有四个坐标都不同，因此\n$$\n\\prod_{j=1}^{4} \\frac{w_{j}(x_{B})}{w_{j}(x_{A})}\n= \\frac{1}{4} \\cdot \\frac{3}{2} \\cdot \\frac{3}{2} \\cdot \\frac{1}{4}\n= \\frac{9}{64}.\n$$\n所以，\n$$\n\\frac{\\pi(x_{A})}{\\pi(x_{B})}\n= \\frac{W(x_{A})}{W(x_{B})} \\cdot \\frac{9}{64}\n= \\frac{12}{8} \\cdot \\frac{9}{64}\n= \\frac{27}{128}.\n$$\n这个分数已经是最简形式。", "answer": "$$\\boxed{\\frac{27}{128}}$$", "id": "1407802"}]}