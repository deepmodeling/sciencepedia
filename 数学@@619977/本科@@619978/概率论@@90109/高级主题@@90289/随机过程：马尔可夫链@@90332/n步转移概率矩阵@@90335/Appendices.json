{"hands_on_practices": [{"introduction": "我们将从一个基础练习开始，这个练习将帮助你掌握计算两步转移概率的核心方法。通过一个关于图书馆书籍状态的直观场景，你将学习如何构建一个转移概率矩阵 $P$，并用它来计算系统在两步之后的状态概率。这个过程是理解马尔可夫链如何通过矩阵乘法来描述系统演化的基础，也是进行更长期预测的第一步 [@problem_id:1377143]。", "problem": "大学图书馆中某本特定书籍的状态可以建模为一个离散时间随机过程。每天结束时观察这本书的状态。该书可能的状态有：“在架上”(S)、“已借出”(C)或“归架中”(R)。\n\n这些状态之间的转移遵循一组固定的概率：\n- 如果一本书在某一天处于“在架上”状态，那么它在第二天有 0.15 的概率变为“已借出”状态。否则，它将保持“在架上”状态。\n- 如果一本书处于“已借出”状态，那么它在第二天有 0.25 的概率被归还并进入“归架中”状态。否则，它将保持“已借出”状态。\n- 如果一本书处于“归架中”状态，那么它在第二天有 0.90 的概率被放回“在架上”。否则，它将保持“归架中”状态。\n\n假设一本书不能在一天内从“在架上”变为“归架中”，从“已借出”变为“在架上”，或从“归架中”变为“已借出”。\n\n假设某本书当前处于“在架上”状态。那么这本书在两天后再次处于“在架上”状态的概率是多少？将你的答案表示为保留三位有效数字的小数。", "solution": "设状态为 $S$ (在架上)、$C$ (已借出) 和 $R$ (归架中)。行/列顺序为 $(S,C,R)$ 的一步转移矩阵 $P$ 为\n$$\nP=\\begin{pmatrix}\n0.85 & 0.15 & 0 \\\\\n0 & 0.75 & 0.25 \\\\\n0.90 & 0 & 0.10\n\\end{pmatrix}.\n$$\n一本从状态 $S$ 开始的书，在两天后恰好处于状态 $S$ 的概率是两步转移概率 $(P^{2})_{SS}$，由下式给出\n$$\n(P^{2})_{SS}=\\sum_{x\\in\\{S,C,R\\}} P_{Sx}P_{xS}\n= P_{SS}P_{SS}+P_{SC}P_{CS}+P_{SR}P_{RS}.\n$$\n根据转移结构，$P_{SS}=0.85$, $P_{SC}=0.15$, $P_{CS}=0$, $P_{SR}=0$ 且 $P_{RS}=0.90$。因此，\n$$\n(P^{2})_{SS}=0.85^{2}+0.15\\cdot 0+0\\cdot 0.90=0.7225.\n$$\n保留三位有效数字得到 $0.723$。", "answer": "$$\\boxed{0.723}$$", "id": "1377143"}, {"introduction": "在掌握了单步和两步计算后，我们自然会思考：如何高效地预测系统在多步之后的状态？直接将矩阵连乘 $n$ 次在计算上可能非常低效。本练习将向你介绍一种更为优雅和强大的技术——矩阵对角化——来计算 $n$ 步转移矩阵 $P^n$。通过一个通勤者选择交通方式的日常案例，你将学会如何运用特征值和特征向量来简化高次幂矩阵的计算，这对于分析马尔可夫链的长期行为至关重要 [@problem_id:1377157]。", "problem": "一名通勤者每天上班的交通方式选择是在开私家车（状态1）和乘火车（状态2）之间。某一天的选择会受到前一天选择的影响。控制这一每日决策的概率如下：\n\n*   如果通勤者在第 $k$ 天开车，那么他们在第 $k+1$ 天也开车的概率是 $0.7$。\n*   如果通勤者在第 $k$ 天乘火车，那么他们在第 $k+1$ 天开车的概率是 $0.2$。\n\n假设在任何给定的第 $k$ 天，通勤者必须选择开车或乘火车，且这两种选择是互斥的。转移概率在所有天都是恒定的。\n\n求五步转移概率矩阵 $P^{(5)}$，其中矩阵的元素 $(i, j)$ 表示在某一天使用交通方式 $i$ 的通勤者将在五天后使用交通方式 $j$ 的概率。将你的最终答案以一个 $2 \\times 2$ 矩阵的形式呈现，并将每个元素四舍五入到四位有效数字。", "solution": "令状态1为‘开车’，状态2为‘乘火车’。我们已知在一天内从一个状态转移到另一个状态的概率。我们可以利用这些概率来构建一步转移概率矩阵 $P$。该矩阵的元素 $P_{ij}$ 是在一天内从状态 $i$ 转移到状态 $j$ 的概率。\n\n根据问题陈述：\n已知通勤者在第 $k$ 天开车，则其在第 $k+1$ 天也开车的概率是 $P_{11} = 0.7$。\n由于只有两个状态，所以在第 $k$ 天开车的情况下，在第 $k+1$ 天乘火车的概率必然是 $P_{12} = 1 - P_{11} = 1 - 0.7 = 0.3$。\n\n已知通勤者在第 $k$ 天乘火车，则其在第 $k+1$ 天开车的概率是 $P_{21} = 0.2$。\n同样地，在第 $k$ 天乘火车的情况下，在第 $k+1$ 天再次乘火车的概率是 $P_{22} = 1 - P_{21} = 1 - 0.2 = 0.8$。\n\n因此，一步转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix} 0.7 & 0.3 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\n五步转移概率矩阵 $P^{(5)}$ 由一步转移矩阵的五次方给出，即 $P^{(5)} = P^5$。为了高效计算，我们对矩阵 $P$ 进行对角化。矩阵 $P$ 的对角化形式为 $P = VDV^{-1}$，其中 $D$ 是由特征值组成的对角矩阵，而 $V$ 是一个其列为相应特征向量的矩阵。\n\n首先，我们通过求解特征方程 $\\det(P - \\lambda I) = 0$ 来求出 $P$ 的特征值（$\\lambda$）：\n$$\n\\det\\begin{pmatrix} 0.7-\\lambda & 0.3 \\\\ 0.2 & 0.8-\\lambda \\end{pmatrix} = (0.7-\\lambda)(0.8-\\lambda) - (0.3)(0.2) = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.56 - 0.06 = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.5 = 0\n$$\n这个二次方程可以因式分解为 $(\\lambda - 1)(\\lambda - 0.5) = 0$。\n特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = 0.5$。\n\n接下来，我们求解相应的特征向量。\n对于 $\\lambda_1 = 1$，我们求解 $(P - I)v_1 = 0$：\n$$\n\\begin{pmatrix} 0.7-1 & 0.3 \\\\ 0.2 & 0.8-1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} -0.3 & 0.3 \\\\ 0.2 & -0.2 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到方程 $-0.3x + 0.3y = 0$，可简化为 $x=y$。一个简单的特征向量选择是 $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = 0.5$，我们求解 $(P - 0.5I)v_2 = 0$：\n$$\n\\begin{pmatrix} 0.7-0.5 & 0.3 \\\\ 0.2 & 0.8-0.5 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0.2 & 0.3 \\\\ 0.2 & 0.3 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到方程 $0.2x + 0.3y = 0$，可简化为 $2x = -3y$。一个简单的特征向量选择是 $v_2 = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix}$。\n\n现在我们构造矩阵 $V$、$D$ 和 $V^{-1}$：\n$$\nV = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.5 \\end{pmatrix}\n$$\n$V$ 的逆矩阵是：\n$$\nV^{-1} = \\frac{1}{(1)(-2) - (3)(1)} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\frac{1}{-5} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2/5 & 3/5 \\\\ 1/5 & -1/5 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\n现在我们可以用公式 $P^5 = VD^5V^{-1}$ 计算 $P^5$。\n首先，我们求 $D^5$：\n$$\nD^5 = \\begin{pmatrix} 1^5 & 0 \\\\ 0 & (0.5)^5 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix}\n$$\n现在，我们进行矩阵乘法 $P^5 = V D^5 V^{-1}$：\n$$\nP^5 = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\n首先，计算 $V D^5$ 的乘积：\n$$\nV D^5 = \\begin{pmatrix} 1 \\cdot 1 & 3 \\cdot 0.03125 \\\\ 1 \\cdot 1 & -2 \\cdot 0.03125 \\end{pmatrix} = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix}\n$$\n然后，将结果乘以 $V^{-1}$：\n$$\nP^5 = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\n现在我们计算最终矩阵的元素：\n$$\nP^{(5)}_{11} = (1)(0.4) + (0.09375)(0.2) = 0.4 + 0.01875 = 0.41875\n$$\n$$\nP^{(5)}_{12} = (1)(0.6) + (0.09375)(-0.2) = 0.6 - 0.01875 = 0.58125\n$$\n$$\nP^{(5)}_{21} = (1)(0.4) + (-0.0625)(0.2) = 0.4 - 0.0125 = 0.3875\n$$\n$$\nP^{(5)}_{22} = (1)(0.6) + (-0.0625)(-0.2) = 0.6 + 0.0125 = 0.6125\n$$\n所以，五步转移矩阵是：\n$$\nP^{(5)} = \\begin{pmatrix} 0.41875 & 0.58125 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$\n最后，我们将每个元素四舍五入到四位有效数字：\n$P^{(5)}_{11} = 0.41875 \\approx 0.4188$\n$P^{(5)}_{12} = 0.58125 \\approx 0.5813$\n$P^{(5)}_{21} = 0.3875$ （已经是四位有效数字）\n$P^{(5)}_{22} = 0.6125$ （已经是四位有效数字）\n\n最终的矩阵是：\n$$\nP^{(5)} \\approx \\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}}\n$$", "id": "1377157"}, {"introduction": "现实世界中的概率问题往往带有附加条件。这个练习将挑战你将条件概率的概念与马尔可夫链模型相结合。你需要在一个已经给定部分信息的场景下，计算未来的状态概率。这个练习不仅能加深你对马尔可夫过程和条件概率公式 $P(A|B) = P(A \\cap B) / P(B)$ 的理解，还能锻炼你在复杂约束下进行严谨概率推理的能力 [@problem_id:1377144]。", "problem": "一个数据中心的专用服务器每天都会被监控。其运行状态被建模为一个具有四种可能状态的离散时间马尔可夫链：状态1（正常）、状态2（降频）、状态3（更新中）和状态4（崩溃）。状态转换每天根据以下的一步转移概率矩阵 $P$ 进行，其中条目 $p_{ij}$ 表示在一天内从状态 $i$ 转换到状态 $j$ 的概率：\n$$\nP = \\begin{pmatrix}\n1/2 & 1/4 & 1/8 & 1/8 \\\\\n1/4 & 1/2 & 1/4 & 0 \\\\\n3/4 & 0 & 1/4 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n假设服务器在第0天处于正常状态（状态1）。已知服务器在第1天没有进入崩溃状态，那么它在第2天处于更新中状态（状态3）的概率是多少？\n\n请将您的答案表示为最简分数。", "solution": "设 $X_{n}$ 表示第 $n$ 天的状态，初始条件为 $X_{0}=1$。我们需要求解条件概率 $P(X_{2}=3 \\mid X_{1} \\neq 4, X_{0}=1)$。\n\n根据关于第1天非崩溃状态的全概率公式和马尔可夫性质，\n$$\nP(X_{2}=3 \\mid X_{1} \\neq 4, X_{0}=1)\n=\\sum_{i=1}^{3} P(X_{2}=3 \\mid X_{1}=i, X_{0}=1)\\,P(X_{1}=i \\mid X_{1} \\neq 4, X_{0}=1)\n=\\frac{\\sum_{i=1}^{3} p_{1i}p_{i3}}{1-p_{14}}.\n$$\n分子是系统从状态1开始，经过两步到达状态3，并且中间步骤不为状态4的概率，这等于 $(P^2)_{13}$。我们来计算它：\n$$\n\\sum_{i=1}^{3} p_{1i}p_{i3}\n= p_{11}p_{13} + p_{12}p_{23} + p_{13}p_{33}\n= \\frac{1}{2}\\cdot\\frac{1}{8} + \\frac{1}{4}\\cdot\\frac{1}{4} + \\frac{1}{8}\\cdot\\frac{1}{4}\n= \\frac{1}{16} + \\frac{1}{16} + \\frac{1}{32}\n= \\frac{5}{32}.\n$$\n此外，分母为 $1-p_{14} = 1 - \\frac{1}{8} = \\frac{7}{8}$。所以，\n$$\nP(X_{2}=3 \\mid X_{1} \\neq 4, X_{0}=1)\n=\\frac{\\frac{5}{32}}{\\frac{7}{8}}=\\frac{5}{32}\\cdot\\frac{8}{7}=\\frac{5}{28}.\n$$\n等价地，由于 $X_{2}=3$ 意味着 $X_{1}\\neq 4$（状态4是吸收态，只会转移到自身），我们也可以写成\n$$\nP(X_{2}=3 \\mid X_{1} \\neq 4, X_{0}=1)=\\frac{P(X_{2}=3 \\mid X_{0}=1)}{P(X_{1}\\neq 4 \\mid X_{0}=1)}=\\frac{(P^{2})_{13}}{1-p_{14}}=\\frac{\\frac{5}{32}}{\\frac{7}{8}}=\\frac{5}{28}.\n$$\n因此所求概率为 $\\frac{5}{28}$。", "answer": "$$\\boxed{\\frac{5}{28}}$$", "id": "1377144"}]}