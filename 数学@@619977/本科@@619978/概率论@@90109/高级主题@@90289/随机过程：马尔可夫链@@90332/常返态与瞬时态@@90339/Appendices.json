{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方式就是实践。让我们从一个基本但至关重要的问题开始。对于有限状态马尔可夫链，遍历性和常返性之间存在着一个非常优美的基本定理。这个练习旨在考察你对这个核心概念的理解，通过一个看似特殊的约束（$P_{ii} = 0$）来测试你是否能抓住“有限”和“不可约”这两个关键属性的本质。[@problem_id:1329949]", "problem": "一个随机过程由一个离散时间马尔可夫链描述，该马尔可夫链定义在有限状态空间 $S = \\{s_1, s_2, \\ldots, s_N\\}$ 上，其中状态数 $N$ 是一个大于或等于3的整数。已知该链是不可约的，这意味着可以从任意状态到达任意其他状态（不一定在一步之内）。\n\n该系统动力学的一个奇特之处在于，过程不可能在两个连续的时间步中停留在同一状态。在数学上，这等价于转移概率矩阵 $P$ 的所有对角线元素均为零的性质，即对所有状态 $i \\in S$ 都有 $P_{ii} = 0$。\n\n仅根据所提供的信息，关于此马尔可夫链中状态的分类，可以得出什么确定性的结论？\n\nA. 所有状态都是暂留的。\n\nB. 所有状态都是常返的。\n\nC. 一些状态是常返的，一些状态是暂留的。\n\nD. 如果不知道转移矩阵 $P$ 的非对角线元素的具体值，则无法确定状态是常返还是暂留的。", "solution": "设 $(X_{n})_{n \\geq 0}$ 是一个离散时间马尔可夫链，其状态空间为有限集 $S=\\{s_{1},\\ldots,s_{N}\\}$（$N \\geq 3$），转移矩阵为 $P=(P_{ij})_{i,j \\in S}$，且满足：\n- 不可约性：对所有 $i,j \\in S$，存在 $n \\geq 1$ 使得 $(P^{n})_{ij} > 0$。\n- 无自环：对所有 $i \\in S$，$P_{ii} = 0$。\n\n我们需要仅根据这些信息，来判断状态的常返性与暂留性。\n\n首先，利用有限性和不可约性。由于 $P$ 是一个有限、不可约的非负矩阵，且每行元素之和为1，根据 Perron–Frobenius 定理，存在一个严格正向量 $\\pi \\in \\mathbb{R}^{N}$ 使得\n$$\nP^{\\top}\\pi = \\pi, \\qquad \\pi_{i} > 0 \\text{ for all } i \\in S.\n$$\n通过设定\n$$\n\\sum_{i \\in S} \\pi_{i} = 1\n$$\n将其归一化，得到一个概率向量。\n此时 $\\pi$ 是一个平稳分布：\n$$\n\\pi^{\\top} P = \\pi^{\\top}, \\qquad \\sum_{i \\in S} \\pi_{i} = 1, \\qquad \\pi_{i} > 0 \\ \\forall i.\n$$\n\n在一个不可约马尔可夫链中，平稳分布的存在意味着正常返。更准确地说，对每个状态 $i$，令其返回时间为\n$$\nT_{i}^{+} = \\inf\\{n \\geq 1 : X_{n} = i \\mid X_{0} = i\\}.\n$$\nKac 公式给出了以下恒等式\n$$\n\\mathbb{E}_{i}[T_{i}^{+}] = \\frac{1}{\\pi_{i}} \\quad \\text{for each } i \\in S,\n$$\n因此，因为 $\\pi_{i} > 0$，可得\n$$\n\\mathbb{E}_{i}[T_{i}^{+}]  \\infty.\n$$\n如果 $\\mathbb{P}_{i}(T_{i}^{+} = \\infty) > 0$，那么 $\\mathbb{E}_{i}[T_{i}^{+}]$ 将为无穷大。因此必然有\n$$\n\\mathbb{P}_{i}(T_{i}^{+}  \\infty) = 1,\n$$\n所以每个状态 $i$ 都是常返的（实际上是正常返的）。\n\n因此，在任何有限不可约马尔可夫链中，所有状态都是常返的，这与周期性无关。附加的约束 $P_{ii}=0$ 仅限制了周期（例如，它排除了单步返回，但如果奇数和偶数长度的返回路径都存在，它并不妨碍非周期性）；它不影响常返性的分类。\n\n因此，正确的选择是所有状态都是常返的。", "answer": "$$\\boxed{B}$$", "id": "1329949"}, {"introduction": "在掌握了有限状态空间的情况后，我们将视野扩展到无限状态空间，这里的规则变得更加微妙。与有限链不同，一个不可约的无限马尔可夫链并不保证是常返的。这个练习引入了“漂移”的概念，这是一个简洁而强大的工具，用于分析一维随机游走的长期行为，并判断其状态是瞬时的还是常返的。[@problem_id:1288903]", "problem": "一个描述点缺陷沿一维聚合物链运动的简化模型将缺陷的位置描述为整数集 $\\mathbb{Z}$ 上的随机游走。任意时刻系统的状态是缺陷的整数坐标 $n$。在每个离散时间步，缺陷的位置根据以下概率规则发生变化，这些规则受到聚合物不对称化学结构的影响：\n- 缺陷以概率 $p_R$ 向右移动一步（从 $n$ 到 $n+1$）。\n- 缺陷以概率 $p_L$ 向左移动一步（从 $n$ 到 $n-1$）。\n- 缺陷以概率 $p_S$ 停留在当前位置 $n$。\n\n这些概率由一个与聚合物材料性质相关的正常数 $k$ 给出：\n$p_R = \\frac{k+1}{2k+4}$，$p_L = \\frac{k}{2k+4}$，以及 $p_S = \\frac{3}{2k+4}$。\n\n由此随机游走形成的马尔可夫链是不可约的，这意味着所有状态都属于同一个互通类，因此具有相同的性质。分析此链中状态的性质，并从以下选项中选择正确的分类。\n\nA. 常返且非周期\n\nB. 常返且周期\n\nC. 瞬时且非周期\n\nD. 瞬时且周期\n\nE. 分类取决于正常数 $k$ 的具体值。", "solution": "我们验证转移概率。给定 $p_{R}=\\frac{k+1}{2k+4}$，$p_{L}=\\frac{k}{2k+4}$，以及 $p_{S}=\\frac{3}{2k+4}$，其中 $k>0$，我们有\n$$\np_{R}+p_{L}+p_{S}=\\frac{k+1}{2k+4}+\\frac{k}{2k+4}+\\frac{3}{2k+4}=\\frac{2k+4}{2k+4}=1,\n$$\n且当 $k>0$ 时每一项都严格为正，因此该链在 $\\mathbb{Z}$ 上是良定义的和不可约的，因为从任意状态 $n$ 都可以通过一系列概率为正的左移和右移到达任意状态 $m$。\n\n为了确定周期性，我们回忆状态 $i$ 的周期 $d(i)$ 为\n$$\nd(i)=\\gcd\\{n\\geq 1: P^{n}(i,i)>0\\}。\n$$\n由于 $P(i,i)=p_{S}>0$，我们有 $1\\in\\{n\\geq 1: P^{n}(i,i)>0\\}$，因此 $d(i)=1$。所以所有状态都是非周期的。\n\n为了确定常返性与瞬时性，考虑增量 $\\Delta X_{t}=X_{t+1}-X_{t}$，它满足\n$$\n\\Delta X_{t}=\\begin{cases}\n+1  \\text{以概率 } p_{R},\\\\\n-1  \\text{以概率 } p_{L},\\\\\n0  \\text{以概率 } p_{S}。\n\\end{cases}\n$$\n这些增量在时间上是独立同分布的，因为转移概率对于增量来说是时齐的且与状态无关。漂移（平均增量）为\n$$\n\\mu=\\mathbb{E}[\\Delta X_{t}]=p_{R}-p_{L}=\\frac{k+1}{2k+4}-\\frac{k}{2k+4}=\\frac{1}{2k+4}>0。\n$$\n根据强大数定律，对于 $S_{n}=X_{n}-X_{0}=\\sum_{t=0}^{n-1}\\Delta X_{t}$，\n$$\n\\frac{S_{n}}{n}\\to \\mu \\quad \\text{几乎必然成立,}\n$$\n因此 $S_{n}\\to +\\infty$ 几乎必然成立。所以，该随机游走会漂移到 $+\\infty$，并且几乎必然地只会有限次访问任何固定状态，这意味着所有状态都是瞬时的。\n\n综合以上两点，对于任意 $k>0$，该链都是瞬时且非周期的。因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1288903"}, {"introduction": "继续我们对无限状态链的探索，这个练习展示了无限链同样可以是常返的。该问题建立在二维随机游走模型之上，它挑战你透过表面上的修改（“懒惰”的移动机制）来识别其核心过程。通过解决这个问题，你将接触到概率论中的一个经典成果——Pólya 定理，并锻炼将一个看似复杂的问题简化为已知基本模型的重要解题技巧。[@problem_id:1384260]", "problem": "一个随机行走者在二维整数格点 $\\mathbb{Z}^2$ 上移动。行走者从原点 $\\mathbf{X}_0 = (0,0)$ 出发。在每个离散时间步 $n=1, 2, 3, \\ldots$，行走者首先以等概率 $1/4$ 选择其四个相邻位置（上、下、左、右）之一。令这个意向目的地为 $\\mathbf{y}'$。连接行走者当前位置 $\\mathbf{X}_{n-1}$ 与 $\\mathbf{y}'$ 的边以固定的概率 $p \\in (0,1)$ 是“可通过的”，并以概率 $1-p$ 是“不可通过的”。边的状态在每个时间步和每次可能的移动中都是独立确定的。如果选择的边是可通过的，行走者移动到新位置，即 $\\mathbf{X}_n = \\mathbf{y}'$。如果选择的边是不可通过的，行走者不移动，停留在当前位置，即 $\\mathbf{X}_n = \\mathbf{X}_{n-1}$。\n\n马尔可夫链中的一个状态，如果从该状态出发，最终返回该状态的概率为1，则该状态被定义为常返的。如果此概率小于1，则该状态为非常返的。对于所描述的随机行走，它是在 $\\mathbb{Z}^2$ 上的一个不可约马尔可夫链，所有状态都属于同一类型。\n\n确定对于概率 $p$ 的哪些取值，该随机行走是常返的。从以下选项中选择 $p$ 的正确取值范围。\n\nA. 仅当 $p=1$ 时，行走是常返的。\n\nB. 仅当 $p  1/2$ 时，行走是常返的。\n\nC. 对于所有 $p \\in (0, 1)$，行走是常返的。\n\nD. 仅当 $p  \\pi/4$ 时，行走是常返的。\n\nE. 对于所有 $p \\in (0, 1)$，行走是非常返的。", "solution": "在每个时间步，行走者均匀地选择四个邻居中的一个，然后当且仅当所选的边是可通过时才移动。因此，对于任何位置 $x \\in \\mathbb{Z}^{2}$ 及其四个邻居中的任意一个 $x+e$（其中 $e$ 是坐标单位向量或其负向量），\n$$\n\\mathbb{P}(X_{n}=x \\mid X_{n-1}=x)=1-p,\\quad \\mathbb{P}(X_{n}=x+e \\mid X_{n-1}=x)=\\frac{p}{4}.\n$$\n因此，该链是一个懒惰最近邻对称随机行走：它以概率 $1-p$ 停留在原地，并以概率 $p/4$ 移动到每个邻居。\n\n通过 $T_{0}=0$ 和\n$$\nT_{k}=\\inf\\{n>T_{k-1}: X_{n}\\neq X_{n-1}\\},\\quad k\\geq 1,\n$$\n定义移动时刻序列，即实际发生移动的时刻。令 $Y_{k}=X_{T_{k}}$ 为嵌入链，它只记录成功移动后的位置。\n\n我们首先确定停留时间的分布规律。在每一步，所选的边独立地以概率 $p$ 开放，因此在给定时间发生移动的指示变量是一个参数为 $p$ 的独立伯努利随机变量。因此，\n$$\nT_{k}-T_{k-1}\\ \\text{是独立同分布的，服从参数为 }p\\text{ 的几何分布}，\\quad \\mathbb{P}(T_{k}-T_{k-1}=m)=(1-p)^{m-1}p,\\ m\\in\\mathbb{N}.\n$$\n接下来，我们确定 $Y_{k}$ 的转移定律。当移动发生时，方向是最初选择的邻居，该选择在四个邻居中是均匀的，且独立于边是开放还是关闭的结果。因此，对于 $x$ 的每个邻居 $y$，\n$$\n\\mathbb{P}(Y_{k}=y \\mid Y_{k-1}=x)=\\frac{1}{4},\n$$\n并且 $Y_{k}$ 是在 $\\mathbb{Z}^{2}$ 上的简单对称随机行走。\n\n令 $\\tau_{Y}=\\inf\\{k\\geq 1: Y_{k}=0\\}$ 和 $\\tau_{X}=\\inf\\{n\\geq 1: X_{n}=0\\}$ 分别为嵌入链和原始链首次返回原点的时间。由于 $X_{n}$ 仅在移动时刻发生变化，并且对于所有满足 $T_{k}\\leq nT_{k+1}$ 的 $n$，$X_n$ 等于 $Y_{k}$，所以 $X$ 返回原点当且仅当 $Y$ 返回原点，实际上\n$$\n\\{\\tau_{X}\\infty\\}=\\{\\tau_{Y}\\infty\\},\\quad \\text{在 } \\{\\tau_{Y}\\infty\\} \\text{ 上有 } \\tau_{X}=T_{\\tau_{Y}}。\n$$\n因此，$X_{n}$ 的常返性或非常返性与 $Y_{k}$ 的相同。\n\n根据 Pólya 定理，在 $\\mathbb{Z}^{2}$ 上的简单对称随机行走是常返的，即\n$$\n\\mathbb{P}_{0}(\\tau_{Y}\\infty)=1.\n$$\n因此，\n$$\n\\mathbb{P}_{0}(\\tau_{X}\\infty)=1,\n$$\n所以所描述的行走对于每一个 $p\\in(0,1)$ 都是常返的。\n\n因此，正确的选项是，对于所有 $p\\in(0,1)$，行走是常返的。", "answer": "$$\\boxed{C}$$", "id": "1384260"}]}