{"hands_on_practices": [{"introduction": "这个练习将引导你完成求解一个简单马尔可夫链稳态分布的全过程。通过为一个在三个方块上移动的标记建模，你将学习如何构建转移矩阵并求解线性方程组，以确定系统在每个状态下花费的时间的长期比例。这是应用遍历性定理解决实际问题的基础技能[@problem_id:1360494]。", "problem": "一个小自动机在一个轨道上的三个方格（从左到右依次标记为 1、2 和 3）之间移动一个标记。标记的位置在离散时间步上根据一组固定的概率规则进行更新。该过程可以建模为一个马尔可夫链，其中状态是标记所占据方格的标签。\n\n标记移动的规则如下：\n- 如果标记位于方格 1，它在下一步总是会移动到方格 2。\n- 如果标记位于方格 2，它在下一步将以 $1/2$ 的概率移动到方格 1，或以 $1/2$ 的概率移动到方格 3。\n- 如果标记位于方格 3，它在下一步将以 $1/3$ 的概率移动到方格 2，或以 $2/3$ 的概率停留在方格 3。\n\n假设自动机运行很长时间，标记位于方格 2 的长期时间占比是多少？请用最简分数形式表示你的答案。", "solution": "将标记的位置建模为一个状态标记为 $1,2,3$ 的有限马尔可夫链。其转移矩阵 $P$（行索引为当前状态，列索引为下一状态）为\n$$\nP=\\begin{pmatrix}\n0  1  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2} \\\\\n0  \\frac{1}{3}  \\frac{2}{3}\n\\end{pmatrix}.\n$$\n该链是不可约的（每个状态都可以到达其他所有状态）且非周期的（状态 $3$ 有自循环），因此它有唯一的平稳分布 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3})$，满足 $\\pi=\\pi P$ 和 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$。将 $\\pi=\\pi P$ 按分量展开得到\n$$\n\\pi_{1}=\\frac{1}{2}\\pi_{2},\\qquad\n\\pi_{2}=\\pi_{1}+\\frac{1}{3}\\pi_{3},\\qquad\n\\pi_{3}=\\frac{1}{2}\\pi_{2}+\\frac{2}{3}\\pi_{3}.\n$$\n由第一个方程可得，$\\pi_{1}=\\frac{1}{2}\\pi_{2}$。由第三个方程可得，\n$$\n\\pi_{3}-\\frac{2}{3}\\pi_{3}=\\frac{1}{2}\\pi_{2}\\;\\;\\Longrightarrow\\;\\;\\frac{1}{3}\\pi_{3}=\\frac{1}{2}\\pi_{2}\\;\\;\\Longrightarrow\\;\\;\\pi_{3}=\\frac{3}{2}\\pi_{2}.\n$$\n代入归一化条件：\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}=\\frac{1}{2}\\pi_{2}+\\pi_{2}+\\frac{3}{2}\\pi_{2}=3\\pi_{2}=1,\n$$\n因此 $\\pi_{2}=\\frac{1}{3}$。这就是标记位于方格 $2$ 的长期时间占比。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1360494"}, {"introduction": "第二个练习探讨了著名的 Ehrenfest 瓮模型，这是统计力学中理解系统如何达到平衡的基石。通过分析服务器之间的负载均衡问题，你将看到细致平衡条件如何简化稳态分布的求解，并揭示其与二项式系数的优美联系。这个练习旨在展示遍历理论在分析更复杂的参数化系统时的威力[@problem_id:1360469]。", "problem": "考虑一个简化的模型，用于在两个相同的服务器（服务器A和服务器B）之间进行动态负载均衡。最初，总共有 $N$ 个独立的计算任务以某种方式分布在这两个服务器之间。该系统按离散时间步演化，规则如下：在每个时间步，从 $N$ 个任务中（无论其当前在哪台服务器上）均匀随机地选择一个，并立即将其移动到另一台服务器。\n\n假设系统运行很长时间后，它会趋于一个统计平衡状态。确定两个服务器之一完全为空（即所有 $N$ 个任务都位于另一个服务器上）的长期概率。\n\n将您的答案表示为关于 $N$ 的闭式解析表达式。", "solution": "令 $X_{t}$ 表示在时刻 $t$ 服务器A上的任务数量，因此 $X_{t}\\in\\{0,1,\\dots,N\\}$。该演化过程是一个生灭马尔可夫链，其转移概率为\n$$\n\\mathbb{P}(X_{t+1}=k+1\\,|\\,X_{t}=k)=\\frac{N-k}{N},\\qquad \\mathbb{P}(X_{t+1}=k-1\\,|\\,X_{t}=k)=\\frac{k}{N},\n$$\n其中，从服务器B上选择一个任务会将其移至A，使 $k$ 增加1；而从服务器A上选择一个任务会将其移至B，使 $k$ 减少1。在边界处，$k=0$ 以概率1转移到1，而 $k=N$ 以概率1转移到 $N-1$。\n\n我们通过对此可逆生灭链应用细致平衡条件来确定其平稳分布 $\\pi=\\{\\pi_{k}\\}_{k=0}^{N}$。假设\n$$\n\\pi_{k}=c\\,\\binom{N}{k},\\qquad k=0,1,\\dots,N,\n$$\n其中 $c0$ 为某个归一化常数。那么对于相邻状态 $k$ 和 $k+1$ 的细致平衡方程要求\n$$\n\\pi_{k}\\,\\mathbb{P}(k\\to k+1)=\\pi_{k+1}\\,\\mathbb{P}(k+1\\to k).\n$$\n代入这些表达式可得\n$$\nc\\,\\binom{N}{k}\\,\\frac{N-k}{N}=c\\,\\binom{N}{k+1}\\,\\frac{k+1}{N}.\n$$\n此式恒成立，因为\n$$\n\\binom{N}{k}\\,(N-k)=\\binom{N}{k+1}\\,(k+1).\n$$\n因此 $\\pi_{k}\\propto \\binom{N}{k}$。由归一化条件 $\\sum_{k=0}^{N}\\pi_{k}=1$ 可得\n$$\nc=\\left(\\sum_{k=0}^{N}\\binom{N}{k}\\right)^{-1}=2^{-N},\n$$\n所以唯一的平稳分布是\n$$\n\\pi_{k}=2^{-N}\\binom{N}{k},\\qquad k=0,1,\\dots,N.\n$$\n\n在平稳分布下，两个服务器之一完全为空的长期概率对应于事件 $\\{X=0\\}\\cup\\{X=N\\}$。因此，\n$$\n\\mathbb{P}(\\text{一个服务器为空})=\\pi_{0}+\\pi_{N}=2^{-N}\\binom{N}{0}+2^{-N}\\binom{N}{N}=2^{-N}+2^{-N}=2^{1-N}.\n$$\n这就是所求的关于 $N$ 的闭式表达式。", "answer": "$$\\boxed{2^{1-N}}$$", "id": "1360469"}, {"introduction": "遍历理论不仅能计算长期平均值，还能揭示系统的回归特性。这个洗牌问题引入了一个名为 Kac 引理的强大结果，它将一个状态的稳态概率 $pi_s$ 与其期望返回时间 $E_s[T_s^+]$ 联系起来。通过这个练习，你将深入思考转移矩阵的结构及其对系统长期行为的影响，体会遍历定理的深刻内涵[@problem_id:1360475]。", "problem": "我们研究一个简化的洗牌过程模型，使用一副包含四张不同卡牌的小牌堆，其初始状态为有序。单次“洗牌”操作包括：取出当前在牌堆顶部的牌，并将其重新插入四个可能的位置之一（即，放回顶部、第一张和第二张牌之间、第二张和第三张牌之间，或牌堆底部）。这四个位置中的每一个被选择的概率均相等。\n\n重复此过程，且每次洗牌都与之前的洗牌相互独立。我们关心的是牌堆需要多长时间才能恢复到其初始的有序状态。\n\n计算牌堆首次恢复到其初始有序状态所需的洗牌次数的期望值。初始状态被视为第 0 步，因此第一次可能的返回是在第 1 步。请以精确整数形式给出您的答案。", "solution": "设状态空间为四张不同卡牌的所有排列构成的集合；因此共有 $4!=24$ 个状态。\n\n一次洗牌定义如下：从一个状态 $s=(x_{1},x_{2},x_{3},x_{4})$，均匀地选择一个 $j\\in\\{1,2,3,4\\}$，并将 $x_{1}$ 移动到四个位置中的第 $j$ 个位置。将得到的状态记为 $T_{j}(s)$。转移概率为\n$$\nP(s,t)=\\begin{cases}\n\\frac{1}{4},  \\text{若 } t=T_{j}(s) \\text{ 对于某个 } j\\in\\{1,2,3,4\\},\\\\\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n\n我们证明转移矩阵是双随机的。固定任意一个目标状态 $t=(t_{1},t_{2},t_{3},t_{4})$。对于每个 $j\\in\\{1,2,3,4\\}$，定义一个唯一的前驱状态\n$$\ns_{j}(t)=(t_{j},\\,t_{1},\\,\\ldots,\\,t_{j-1},\\,t_{j+1},\\,\\ldots,\\,t_{4}).\n$$\n那么 $T_{j}(s_{j}(t))=t$。由于顶牌不同，对于不同的 $j$ 值，这些 $s_{j}(t)$ 也各不相同。因此，转移到状态 $t$ 的总输入概率为\n$$\n\\sum_{s}P(s,t)=\\sum_{j=1}^{4}\\frac{1}{4}=1,\n$$\n所以矩阵的每一列之和都等于 $1$。由于根据构造，每一行之和也为 $1$，因此该转移矩阵是双随机的。\n\n由此可知，这 $24$ 个状态上的均匀分布 $\\mu$（即对所有状态 $s$ 都有 $\\mu(s)=\\frac{1}{24}$）是平稳分布。\n\n该马尔可夫链是非周期的，因为 $P(s,s)=\\frac{1}{4}0$（选择 $j=1$ 会使状态保持不变）。它也是不可约的（从任何一个排列出发，通过重复的顶部插入操作可以实现任何其他排列）。因此，该链是正常返的且具有遍历性。\n\n根据标准的重现时间恒等式（马尔可夫链的 Kac 引理），从状态 $s$ 出发，首次返回到该状态 $s$ 的期望时间（$0$ 时刻之后的首次返回时间期望）等于其平稳概率的倒数：\n$$\n\\mathbb{E}_{s}[T_{s}^{+}]=\\frac{1}{\\mu(s)}.\n$$\n由于对于每个状态都有 $\\mu(s)=\\frac{1}{24}$，我们得到\n$$\n\\mathbb{E}_{s}[T_{s}^{+}]=24.\n$$\n\n因此，牌堆首次恢复到其初始有序状态所需的洗牌次数的期望值为 $24$。", "answer": "$$\\boxed{24}$$", "id": "1360475"}]}