{"hands_on_practices": [{"introduction": "第一个练习将查普曼-柯尔莫哥洛夫方程（Chapman-Kolmogorov equations）应用于一个具体的现实场景。通过计算一辆租赁汽车的两日转移概率，你将练习使用矩阵乘法这一基本技能，来确定一个简单时间均匀马尔可夫链中未来状态的可能性 [@problem_id:1347924]。这是预测此类系统长期行为的基础。", "problem": "一家租车公司在三个主要都市区之间运营一支车队：Aurelia (A)、Borealis (B) 和 Cygnus (C)。该公司的数据分析团队对车辆的每日移动情况进行了建模。根据他们的模型，任何一天车辆位置的概率仅取决于其前一天所在的位置。\n\n- 某一天位于 Aurelia 的一辆车，第二天有 50% 的概率仍位于 Aurelia，30% 的概率被移动到 Borealis，20% 的概率被移动到 Cygnus。\n- 某一天位于 Borealis 的一辆车，第二天有 20% 的概率被移动到 Aurelia，60% 的概率仍位于 Borealis，20% 的概率被移动到 Cygnus。\n- 某一天位于 Cygnus 的一辆车，第二天有 10% 的概率被移动到 Aurelia，10% 的概率被移动到 Borealis，80% 的概率仍位于 Cygnus。\n\n一位顾客从 Aurelia 分店租了一辆车。假设该模型准确无误，这辆特定的车在恰好两天后位于 Cygnus 的概率是多少？请用小数表示你的答案，并四舍五入到三位有效数字。", "solution": "设车辆在第 $t$ 天的位置为 $X_{t}\\in\\{A,B,C\\}$。根据马尔可夫性质和全概率定律，\n$$\nP(X_{2}=C \\mid X_{0}=A)=\\sum_{y\\in\\{A,B,C\\}} P(X_{1}=y \\mid X_{0}=A)\\,P(X_{2}=C \\mid X_{1}=y).\n$$\n根据给定的转移概率，\n$$\nP(X_{1}=A \\mid X_{0}=A)=0.5,\\quad P(X_{2}=C \\mid X_{1}=A)=0.2,\n$$\n$$\nP(X_{1}=B \\mid X_{0}=A)=0.3,\\quad P(X_{2}=C \\mid X_{1}=B)=0.2,\n$$\n$$\nP(X_{1}=C \\mid X_{0}=A)=0.2,\\quad P(X_{2}=C \\mid X_{1}=C)=0.8.\n$$\n因此，\n$$\nP(X_{2}=C \\mid X_{0}=A)=(0.5)(0.2)+(0.3)(0.2)+(0.2)(0.8)=0.10+0.06+0.16=0.32.\n$$\n四舍五入到三位有效数字，结果为 $0.320$。", "answer": "$$\\boxed{0.320}$$", "id": "1347924"}, {"introduction": "本问题超越了简单的正向预测，挑战你对过去进行推断。在给定系统的初始和最终状态的情况下，你将计算系统经过某一特定中间状态的概率 [@problem_id:1347939]。这种类型的计算在诊断和事后分析中至关重要，我们利用当前的观测来理解一个过程的历史轨迹。", "problem": "一个监控系统在每小时结束时追踪一个关键服务器组件的状态。该组件可能处于以下三种状态之一：状态1（最优）、状态2（降级）或状态3（故障）。状态之间的转移构成一个离散时间马尔可夫链。其一步转移概率矩阵 $P$，其中 $P_{ij} = P(X_{t+1}=j | X_t=i)$，由下式给出：\n$$\nP = \\begin{pmatrix}\n1 - 2\\alpha & 2\\alpha & 0 \\\\\n\\beta & 1 - \\beta - \\gamma & \\gamma \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n此处，$X_t$ 表示组件在时刻 $t$ 的状态。参数 $\\alpha, \\beta, \\gamma$ 是满足 $0 < 2\\alpha < 1$，$0 < \\beta < 1$，$0 < \\gamma < 1$ 且 $\\beta + \\gamma < 1$ 的常数。\n\n假设在时间 $t=0$ 时，观测到该组件处于最优状态（状态1）。两小时后，即在时间 $t=2$ 时，观测到其处于降级状态（状态2）。\n\n在这些观测条件下，计算该组件在时间 $t=1$ 时处于降级状态（状态2）的条件概率。将答案表示为以 $\\alpha$、$\\beta$ 和 $\\gamma$ 表示的闭式解析表达式。", "solution": "题目要求我们计算一个转移矩阵为 $P$ 的时间齐次马尔可夫链的条件概率 $P(X_{1}=2 \\mid X_{0}=1, X_{2}=2)$。根据条件概率的定义和马尔可夫性质（未来只依赖于当前状态），我们使用\n$$\nP(X_{1}=j \\mid X_{0}=i, X_{2}=k) = \\frac{P(X_{1}=j, X_{2}=k \\mid X_{0}=i)}{P(X_{2}=k \\mid X_{0}=i)}.\n$$\n根据马尔可夫性质，分子可以分解为\n$$\nP(X_{1}=j, X_{2}=k \\mid X_{0}=i) = P(X_{1}=j \\mid X_{0}=i)\\,P(X_{2}=k \\mid X_{1}=j) = P_{ij} P_{jk},\n$$\n而分母，根据全概率公式和马尔可夫性质，为\n$$\nP(X_{2}=k \\mid X_{0}=i) = \\sum_{m} P(X_{2}=k \\mid X_{1}=m)\\,P(X_{1}=m \\mid X_{0}=i) = \\sum_{m} P_{im} P_{mk}.\n$$\n因此，\n$$\nP(X_{1}=j \\mid X_{0}=i, X_{2}=k) = \\frac{P_{ij} P_{jk}}{\\sum_{m} P_{im} P_{mk}}.\n$$\n我们代入 $i=1$，$k=2$，并使用给定的 $P$。相关的非零项为\n$$\nP_{11} = 1 - 2\\alpha,\\quad P_{12} = 2\\alpha,\\quad P_{22} = 1 - \\beta - \\gamma,\\quad P_{13} = 0.\n$$\n由于 $P_{13}=0$，分母中的求和项简化为 $m \\in \\{1,2\\}$。对于 $j=2$，分子为\n$$\nP_{12} P_{22} = (2\\alpha)(1 - \\beta - \\gamma).\n$$\n分母为\n$$\n\\sum_{m} P_{1m}P_{m2} = P_{11}P_{12} + P_{12}P_{22} = (1 - 2\\alpha)(2\\alpha) + (2\\alpha)(1 - \\beta - \\gamma) = 2\\alpha(2 - 2\\alpha - \\beta - \\gamma).\n$$\n因此，\n$$\nP(X_{1}=2 \\mid X_{0}=1, X_{2}=2) = \\frac{(2\\alpha)(1 - \\beta - \\gamma)}{2\\alpha(2 - 2\\alpha - \\beta - \\gamma)} = \\frac{1 - \\beta - \\gamma}{2 - 2\\alpha - \\beta - \\gamma}.\n$$\n在给定的约束条件 $0<2\\alpha<1$，$0<\\beta<1$，$0<\\gamma<1$ 和 $\\beta+\\gamma<1$ 下，该表达式是良定义的，因为这些条件确保了分母为正。", "answer": "$$\\boxed{\\frac{1-\\beta-\\gamma}{2-2\\alpha-\\beta-\\gamma}}$$", "id": "1347939"}, {"introduction": "最后一个实践问题探讨了一个更复杂的非时齐马尔可夫链，其转移规则会随时间改变。你将计算一个由两个不同矩阵控制的系统中的两步转移概率，并以逐步的方式应用查普曼-柯尔莫哥洛夫方程的核心逻辑 [@problem_id:1347946]。这展示了该原理在模拟行为非恒定的动态系统时的通用性。", "problem": "一个特定数字元件的简化模型描述了其在离散时间步 $t=0, 1, 2, \\dots$ 的状态。该元件可以处于三种不同的状态之一：'低' (状态 1)，'高' (状态 2)，或 '错误' (状态 3)。状态转移由一个非齐次马尔可夫链过程控制，该过程受到两个不同且周期性施加的外部场的影响。\n\n从时间 $t=n$ 到 $t=n+1$ 的一步转移概率矩阵取决于 $n$ 是偶数还是奇数。\n- 如果时间步 $n$ 是偶数 ($n=0, 2, 4, \\dots$)，则转移概率由矩阵 $Q$ 给出。\n- 如果时间步 $n$ 是奇数 ($n=1, 3, 5, \\dots$)，则转移概率由矩阵 $P$ 给出。\n\n矩阵 $P$ 和 $Q$ 定义如下，其中第 $i$ 行第 $j$ 列的元素表示从状态 $i$ 转移到状态 $j$ 的概率：\n\n$$\nQ = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} & 0 \\\\ \\frac{1}{5} & \\frac{3}{5} & \\frac{1}{5} \\\\ \\frac{1}{10} & \\frac{1}{10} & \\frac{4}{5} \\end{pmatrix}, \\quad\nP = \\begin{pmatrix} \\frac{7}{10} & \\frac{2}{10} & \\frac{1}{10} \\\\ \\frac{1}{10} & \\frac{8}{10} & \\frac{1}{10} \\\\ \\frac{3}{10} & 0 & \\frac{7}{10} \\end{pmatrix}\n$$\n\n假设该元件在时间 $t=0$ 时处于 '低' 状态 (状态 1)，那么在时间 $t=2$ 时其处于 '错误' 状态 (状态 3) 的概率是多少？请用一个最简分数形式表示你的答案。", "solution": "我们将状态分布建模为一个行向量。设 $t=0$ 时的初始分布为 $p_{0}=(1,0,0)$，因为元件从状态 1 开始。该过程从 $t=0$ 到 $t=1$ (偶数 $n$) 使用 $Q$，从 $t=1$ 到 $t=2$ (奇数 $n$) 使用 $P$，因此\n$$\np_{2}=p_{0} Q P.\n$$\n所求概率是元件在 $t=2$ 时处于状态 3 的概率，即 $p_{2}$ 的第三个分量：\n$$\n[p_{2}]_{3} = \\sum_{k=1}^{3} (p_{0} Q)_{k} P_{k3} = \\sum_{k=1}^{3} Q_{1k} P_{k3}.\n$$\n使用给定的元素，\n$$\n[p_{2}]_{3} = Q_{11} P_{13} + Q_{12} P_{23} + Q_{13} P_{33} = \\frac{1}{2}\\cdot \\frac{1}{10} + \\frac{1}{2}\\cdot \\frac{1}{10} + 0\\cdot \\frac{7}{10} = \\frac{1}{10}.\n$$\n因此，该元件在时间 $t=2$ 时处于状态 3 的概率是 $\\frac{1}{10}$。", "answer": "$$\\boxed{\\frac{1}{10}}$$", "id": "1347946"}]}