{"hands_on_practices": [{"introduction": "我们从一个最基础的连续时间马尔可夫过程开始：一个双态系统。这个练习是理解科尔莫戈罗夫方程的基石。通过为一个随机交通灯建模，你将直接应用科尔莫戈罗夫向前方程，观察状态概率如何从一个初始条件随时间演化并趋于稳态，从而牢固掌握向前方程的核心机制 [@problem_id:1399783]。", "problem": "考虑一个由随机信号控制的单个交通路口的简化模型。交通信号灯可以处于两种状态之一：状态 0，此时南北方向为绿灯；或状态 1，此时东西方向为绿灯。该系统的行为是一个连续时间马尔可夫过程。\n\n该信号灯并非按固定计时器运行。而是，如果信号灯处于状态 0（‘南北绿灯’），它会以恒定速率 $\\lambda_1$ 切换到状态 1（‘东西绿灯’）。反之，如果信号灯处于状态 1，它会以恒定速率 $\\lambda_2$ 切换回状态 0。速率 $\\lambda_1$ 和 $\\lambda_2$ 的单位是时间的倒数。\n\n假设在时间 $t=0$ 时，系统确定处于状态 0（‘南北绿灯’）。\n\n确定在之后的某个时间 $t > 0$ 时，信号灯处于状态 0 的概率。答案应为一个以 $\\lambda_1$、$\\lambda_2$ 和 $t$ 表示的解析表达式。", "solution": "设 $X(t) \\in \\{0,1\\}$ 表示在时间 $t$ 时的交通信号灯状态，从 $0 \\to 1$ 的转移速率为 $\\lambda_{1}$，从 $1 \\to 0$ 的转移速率为 $\\lambda_{2}$。这是一个双态连续时间马尔可夫链，其生成元为\n$$\nQ=\\begin{pmatrix}\n-\\lambda_{1} & \\lambda_{1} \\\\\n\\lambda_{2} & -\\lambda_{2}\n\\end{pmatrix}.\n$$\n设 $p_{0}(t)=\\mathbb{P}(X(t)=0)$ 且 $p_{1}(t)=\\mathbb{P}(X(t)=1)=1-p_{0}(t)$。柯尔莫哥洛夫前向方程给出\n$$\n\\frac{d}{dt}p_{0}(t)=-\\lambda_{1}p_{0}(t)+\\lambda_{2}p_{1}(t)=-\\left(\\lambda_{1}+\\lambda_{2}\\right)p_{0}(t)+\\lambda_{2},\n$$\n初始条件为 $p_{0}(0)=1$。\n\n这是一个一阶线性常微分方程。使用积分因子 $\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)$，我们得到\n$$\n\\frac{d}{dt}\\Big(p_{0}(t)\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)\\Big)=\\lambda_{2}\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right).\n$$\n从 $0$ 积分到 $t$：\n$$\np_{0}(t)\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)-p_{0}(0)=\\lambda_{2}\\int_{0}^{t}\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})s\\right)\\,ds\n=\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}\\left(\\exp\\!\\left((\\lambda_{1}+\\lambda_{2})t\\right)-1\\right).\n$$\n解出 $p_{0}(t)$ 并代入 $p_{0}(0)=1$：\n$$\np_{0}(t)=\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right)+\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}\\left(1-\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right)\\right)\n=\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}+\\frac{\\lambda_{1}}{\\lambda_{1}+\\lambda_{2}}\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right).\n$$\n这就是所求的在时间 $t>0$ 时信号灯处于状态 0 的概率。", "answer": "$$\\boxed{\\frac{\\lambda_{2}}{\\lambda_{1}+\\lambda_{2}}+\\frac{\\lambda_{1}}{\\lambda_{1}+\\lambda_{2}}\\exp\\!\\left(-(\\lambda_{1}+\\lambda_{2})t\\right)}$$", "id": "1399783"}, {"introduction": "在基础模型之上，我们来探索一个更复杂且更具实际意义的场景：元件可靠性分析。这个问题引入了一个包含吸收态“失效”的三态过程，这在模拟随时间退化的系统中很常见。通过计算元件处于“磨损”状态概率最大的时刻，你将把概率动态与微积分优化相结合，这对于解决现实世界问题是一种强有力的综合技能 [@problem_id:1399745]。", "problem": "一个新制造的电子元件会发生磨损并最终失效。其状态可以被建模为一个具有三个状态的连续时间随机过程：状态1（“新”）、状态2（“磨损”）和状态3（“失效”）。一个元件的生命周期总是从状态1开始。\n\n从“新”状态到“磨损”状态的转变是一个具有恒定速率 $\\lambda_1$ 的泊松过程。类似地，从“磨损”状态到“失效”状态的转变是一个具有恒定速率 $\\lambda_2$ 的泊松过程。“失效”状态是一个吸收态，意味着一旦元件失效，就不会再发生转变。该模型反映了加速退化，因此给定条件为 $0 < \\lambda_1 < \\lambda_2$。\n\n确定元件处于“磨损”状态的概率达到最大值时的时间 $t$。将您的答案表示为一个用 $\\lambda_1$ 和 $\\lambda_2$ 表示的符号表达式。", "solution": "设 $T_{1}$ 表示从状态1转变到状态2的随机时间。由于此转变是一个速率为 $\\lambda_{1}$ 的泊松过程，我们有 $T_{1} \\sim \\text{Exp}(\\lambda_{1})$，其密度函数为 $f_{T_{1}}(s) = \\lambda_{1} \\exp(-\\lambda_{1} s)$，对于 $s \\geq 0$。设 $T_{2}$ 表示进入状态2后，从状态2转变到状态3的随机时间；由于此过程以恒定速率 $\\lambda_{2}$ 发生，并根据无记忆性，我们有 $T_{2} \\sim \\text{Exp}(\\lambda_{2})$ 且与 $T_{1}$ 独立。\n\n在时间 $t$，元件处于“磨损”状态，当且仅当到状态2的转变已在时间 $t$ 或之前发生，而到状态3的后续转变在时间 $t$ 之前尚未发生。该事件为 $\\{T_{1} \\leq t,\\ T_{1} + T_{2} > t\\}$。利用独立性，并以 $T_{1} = s$ 为条件，我们得到\n$$\nP_{2}(t) = \\int_{0}^{t} f_{T_{1}}(s) \\, \\mathbb{P}(T_{2} > t - s) \\, ds \n= \\int_{0}^{t} \\lambda_{1} \\exp(-\\lambda_{1} s) \\exp(-\\lambda_{2} (t - s)) \\, ds.\n$$\n提出因子 $\\exp(-\\lambda_{2} t)$ 并积分：\n$$\nP_{2}(t) = \\lambda_{1} \\exp(-\\lambda_{2} t) \\int_{0}^{t} \\exp\\big((\\lambda_{2} - \\lambda_{1}) s\\big) \\, ds \n= \\lambda_{1} \\exp(-\\lambda_{2} t) \\cdot \\frac{\\exp\\big((\\lambda_{2} - \\lambda_{1}) t\\big) - 1}{\\lambda_{2} - \\lambda_{1}}.\n$$\n这可以简化为已知的形式\n$$\nP_{2}(t) = \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\left( \\exp(-\\lambda_{1} t) - \\exp(-\\lambda_{2} t) \\right).\n$$\n\n为求使 $P_{2}(t)$ 最大化的时间 $t$，我们对 $P_2(t)$ 关于 $t$ 求导，并将导数设为零：\n$$\nP_{2}'(t) = \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\left( -\\lambda_{1} \\exp(-\\lambda_{1} t) + \\lambda_{2} \\exp(-\\lambda_{2} t) \\right) = 0.\n$$\n因此\n$$\n-\\lambda_{1} \\exp(-\\lambda_{1} t) + \\lambda_{2} \\exp(-\\lambda_{2} t) = 0\n\\quad \\Longleftrightarrow \\quad\n\\lambda_{2} \\exp(-\\lambda_{2} t) = \\lambda_{1} \\exp(-\\lambda_{1} t).\n$$\n重新整理可得\n$$\n\\exp\\big( -(\\lambda_{2} - \\lambda_{1}) t \\big) = \\frac{\\lambda_{1}}{\\lambda_{2}}\n\\quad \\Longrightarrow \\quad\nt^{\\ast} = \\frac{1}{\\lambda_{2} - \\lambda_{1}} \\ln\\!\\left( \\frac{\\lambda_{2}}{\\lambda_{1}} \\right).\n$$\n由于 $0 < \\lambda_{1} < \\lambda_{2}$，我们有 $\\ln(\\lambda_{2}/\\lambda_{1}) > 0$，所以 $t^{\\ast} \\geq 0$。此外，$P_{2}(0) = 0$ 且 $\\lim_{t \\to \\infty} P_{2}(t) = 0$，并在 $t^{\\ast}$ 处计算二阶导数可得\n$$\nP_{2}''(t^{\\ast}) = \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\left( \\lambda_{1}^{2} \\exp(-\\lambda_{1} t^{\\ast}) - \\lambda_{2}^{2} \\exp(-\\lambda_{2} t^{\\ast}) \\right) \n= \\frac{\\lambda_{1}}{\\lambda_{2} - \\lambda_{1}} \\lambda_{2} (\\lambda_{1} - \\lambda_{2}) \\exp(-\\lambda_{2} t^{\\ast}) < 0,\n$$\n这证实了 $t^{\\ast}$ 是使 $P_{2}(t)$ 最大化的唯一时间。\n\n因此，处于“磨损”状态的概率在以下时间达到最大值：\n$$\nt^{\\ast} = \\frac{1}{\\lambda_{2} - \\lambda_{1}} \\ln\\!\\left( \\frac{\\lambda_{2}}{\\lambda_{1}} \\right).\n$$", "answer": "$$\\boxed{\\frac{1}{\\lambda_{2}-\\lambda_{1}} \\ln\\!\\left(\\frac{\\lambda_{2}}{\\lambda_{1}}\\right)}$$", "id": "1399745"}, {"introduction": "现在，我们将关注点从系统在某个时刻“是否”处于某个状态，转移到它“何时”首次到达该状态。这个练习引入了首达时间的概念，这是从金融到物理学等众多应用中的一个关键指标。通过使用拉普拉斯变换——一种处理科尔莫戈罗夫向后方程的关键工具——你将学会计算系统失效时间的分布，从而更深入地理解过程的动态特性 [@problem_id:1399808]。", "problem": "对于单个量子点存储单元的状态，一个简化模型涉及一个在状态空间 $S = \\{0, 1, 2\\}$ 上的连续时间马尔可夫链。状态0代表期望的“数据写入”基态。状态1是一个不稳定的激发态。状态2是一个永久性的、不可恢复的“损坏”错误状态，它作为一个吸收态。\n\n从基态（状态0）开始，热能可以以速率 $\\alpha > 0$ 引起向激发态（状态1）的跃迁。从激发态（状态1）开始，该单元既可以以速率 $\\beta > 0$ 弛豫回基态，也可以以速率 $\\gamma > 0$ 隧穿到损坏态（状态2）。没有其他可能的跃迁。\n\n在时间 $t=0$ 时，该存储单元被初始化于基态（状态0）。该单元的可靠性与它在发生故障前保持功能正常的时间长度有关。设 $T$ 为从初始基态到损坏态的首达时间的随机变量。\n\n请推导这个首达时间 $T$ 的概率密度函数的拉普拉斯变换的表达式。答案请用变量 $s$ 和恒为正的速率 $\\alpha$、$\\beta$、$\\gamma$ 来表示。", "solution": "设 $X(t)$ 为系统在时间 $t$ 的状态。该系统是一个状态空间为 $S = \\{0, 1, 2\\}$ 的连续时间马尔可夫链。问题要求计算，在系统从状态0开始的条件下，到达状态2的首达时间的概率密度函数的拉普拉斯变换。设 $T_{iJ}$ 为从状态 $i$ 到目标状态集 $J$ 的首达时间。我们关心的是 $T_{02}$，因此起始状态是 $i=0$，目标集是 $J=\\{2\\}$。\n\n设 $\\phi_i(s) = E[\\exp(-s T_{iJ}) | X(0)=i]$ 是从状态 $i$ 到集合 $J$ 的首达时间的概率密度函数的拉普拉斯变换。我们的目标是求出目标集 $J=\\{2\\}$ 对应的 $\\phi_0(s)$。\n\n我们可以通过考虑一个无穷小时间间隔 $\\delta t$ 内的过程，来推导关于 $\\phi_i(s)$ 的一个方程组。对于任意状态 $i \\notin J$，我们以过程的第一步为条件。\n在一个微小的时间间隔 $\\delta t$ 内，从状态 $i$ 开始的系统，或者以概率 $q_{ij}\\delta t + o(\\delta t)$ 跳转到另一个状态 $j \\neq i$，或者以概率 $1 - q_i \\delta t + o(\\delta t)$ 仍停留在状态 $i$。其中 $q_{ij}$ 是从 $i$ 到 $j$ 的转移速率，而 $q_i = \\sum_{j \\neq i} q_{ij}$ 是离开状态 $i$ 的总速率。\n\n根据全期望定律和马尔可夫链的无记忆性：\n$$ \\phi_i(s) = E[\\exp(-s T_{iJ})] = (1 - q_i \\delta t) E[\\exp(-s(\\delta t + T_{iJ}))] + \\sum_{j \\neq i} (q_{ij}\\delta t) E[\\exp(-s(\\delta t + T_{jJ}))] + o(\\delta t) $$\n使用近似 $\\exp(-s\\delta t) \\approx 1-s\\delta t$以及增量与未来演化过程的独立性，上式变为：\n$$ \\phi_i(s) \\approx (1 - q_i \\delta t)(1 - s \\delta t) \\phi_i(s) + \\sum_{j \\neq i} (q_{ij}\\delta t)(1 - s \\delta t) \\phi_j(s) $$\n展开此式并只保留 $\\delta t$ 的一阶项：\n$$ \\phi_i(s) \\approx (1 - (q_i+s)\\delta t) \\phi_i(s) + \\sum_{j \\neq i} (q_{ij}\\delta t) \\phi_j(s) $$\n整理各项：\n$$ (q_i+s)\\delta t \\phi_i(s) \\approx \\sum_{j \\neq i} (q_{ij}\\delta t) \\phi_j(s) $$\n两边同除以 $\\delta t$ 并令 $\\delta t \\to 0$ 取极限，我们得到关于 $i \\notin J$ 的方程组：\n$$ (s + q_i) \\phi_i(s) = \\sum_{j \\neq i} q_{ij} \\phi_j(s) $$\n对于任意状态 $k \\in J$，根据定义，首达时间 $T_{kJ}$ 为零。因此，我们有边界条件：\n$$ \\phi_k(s) = E[\\exp(-s \\cdot 0)] = 1 \\quad \\text{for } k \\in J $$\n现在，我们将此框架应用于我们的具体问题。\n状态为 $\\{0, 1, 2\\}$。起始状态是 $i=0$，目标集是 $J=\\{2\\}$。\n非零转移速率为 $q_{01} = \\alpha$，$q_{10} = \\beta$ 和 $q_{12} = \\gamma$。\n对于非目标状态，总离开速率为 $q_0 = q_{01} = \\alpha$ 和 $q_1 = q_{10} + q_{12} = \\beta + \\gamma$。\n\n我们需要解出 $\\phi_0(s)$ 和 $\\phi_1(s)$。边界条件是 $\\phi_2(s) = 1$。\n\n对于状态 $i=0$（不在 $J$ 中）：\n$$ (s + q_0)\\phi_0(s) = q_{01}\\phi_1(s) + q_{02}\\phi_2(s) $$\n由于 $q_{02}=0$，上式简化为：\n$$ (s + \\alpha)\\phi_0(s) = \\alpha\\phi_1(s) \\quad (1) $$\n\n对于状态 $i=1$（不在 $J$ 中）：\n$$ (s + q_1)\\phi_1(s) = q_{10}\\phi_0(s) + q_{12}\\phi_2(s) $$\n代入速率和边界条件 $\\phi_2(s)=1$：\n$$ (s + \\beta + \\gamma)\\phi_1(s) = \\beta\\phi_0(s) + \\gamma \\cdot 1 \\quad (2) $$\n我们得到了一个关于 $\\phi_0(s)$ 和 $\\phi_1(s)$ 的二元线性方程组。我们要求解 $\\phi_0(s)$。\n从方程(1)，我们将 $\\phi_1(s)$ 用 $\\phi_0(s)$ 表示：\n$$ \\phi_1(s) = \\frac{s+\\alpha}{\\alpha}\\phi_0(s) $$\n现在，将此表达式代入方程(2)：\n$$ (s + \\beta + \\gamma)\\left(\\frac{s+\\alpha}{\\alpha}\\phi_0(s)\\right) = \\beta\\phi_0(s) + \\gamma $$\n我们来解 $\\phi_0(s)$。首先，将含有 $\\phi_0(s)$ 的项组合在一起：\n$$ \\left[ \\frac{(s + \\beta + \\gamma)(s+\\alpha)}{\\alpha} - \\beta \\right] \\phi_0(s) = \\gamma $$\n对括号内的项通分：\n$$ \\left[ \\frac{s^2 + \\alpha s + (\\beta+\\gamma)s + \\alpha(\\beta+\\gamma) - \\alpha\\beta}{\\alpha} \\right] \\phi_0(s) = \\gamma $$\n$$ \\left[ \\frac{s^2 + s(\\alpha+\\beta+\\gamma) + \\alpha\\beta + \\alpha\\gamma - \\alpha\\beta}{\\alpha} \\right] \\phi_0(s) = \\gamma $$\n$$ \\left[ \\frac{s^2 + s(\\alpha+\\beta+\\gamma) + \\alpha\\gamma}{\\alpha} \\right] \\phi_0(s) = \\gamma $$\n最后，解出 $\\phi_0(s)$：\n$$ \\phi_0(s) = \\frac{\\alpha\\gamma}{s^2 + s(\\alpha+\\beta+\\gamma) + \\alpha\\gamma} $$\n这就是所求的首达时间概率密度函数的拉普拉斯变换。", "answer": "$$\\boxed{\\frac{\\alpha \\gamma}{s^{2} + s(\\alpha + \\beta + \\gamma) + \\alpha \\gamma}}$$", "id": "1399808"}]}