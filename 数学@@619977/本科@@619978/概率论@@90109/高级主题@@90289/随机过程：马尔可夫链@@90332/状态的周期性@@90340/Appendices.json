{"hands_on_practices": [{"introduction": "理解周期性的第一步是处理一个清晰、确定的情况。这个练习使用一个简单的模运算规则来构建马尔可夫链，让你能够亲手计算状态的返回时间。通过这个例子 [@problem_id:1378756]，你将学会如何识别通信类，并运用最大公约数 ($GCD$) 来确定一个状态的周期，为后续更复杂的问题打下坚实基础。", "problem": "考虑一个定义在状态空间 $S = \\{0, 1, 2, 3, 4, 5, 6, 7, 8, 9\\}$ 上的离散时间马尔可夫链。其转移规则是确定性的：从任意状态 $i \\in S$，链以概率1转移到状态 $j = (i+2) \\pmod{10}$。从状态 $i$ 的所有其他转移的概率均为0。\n\n下列哪个陈述准确地描述了此马尔可夫链的性质？\n\nA. 该马尔可夫链是不可约的，且状态0的周期为5。\n\nB. 该马尔可夫链是非不可约的，且每个状态的周期都为5。\n\nC. 该马尔可夫链有5个互通类，且每个状态的周期都为2。\n\nD. 该马尔可夫链是不可约的，且状态0的周期为10。\n\nE. 该马尔可夫链是非不可约的，且状态0的周期与状态1的周期不同。", "solution": "转移规则是确定性的：从状态 $i$ 出发，链以概率 $1$ 转移到 $(i+2) \\bmod 10$。对于 $n \\in \\mathbb{N}$，从 $i$ 开始的第 $n$ 步位置为\n$$\nX_{n} \\equiv i + 2n \\pmod{10}.\n$$\n因此，第 $n$ 步的转移概率满足\n$$\np^{(n)}(i,j) = \\begin{cases}\n1, & \\text{若 } j \\equiv i + 2n \\pmod{10},\\\\\n0, & \\text{其他情况}。\n\\end{cases}\n$$\n\n不可约性由状态间的互通性决定。状态 $j$ 可从状态 $i$ 到达，当且仅当存在 $n \\geq 0$ 使得 $j \\equiv i + 2n \\pmod{10}$。线性同余方程\n$$\ni + 2n \\equiv j \\pmod{10}\n$$\n有解 $n$ 的充要条件是 $j - i$ 能被 $\\gcd(2,10) = 2$ 整除，即当且仅当 $j \\equiv i \\pmod{2}$。因此，从任意偶数状态 $i$ 只能到达偶数状态集合 $\\{0,2,4,6,8\\}$，从任意奇数状态 $i$ 只能到达奇数状态集合 $\\{1,3,5,7,9\\}$。这两个集合是封闭的，并构成互通类。因此，该链是非不可约的，并且它恰好有两个互通类：\n$$\nC_{\\text{偶}} = \\{0,2,4,6,8\\}, \\quad C_{\\text{奇}} = \\{1,3,5,7,9\\}.\n$$\n\n状态 $i$ 的周期 $d(i)$ 由下式给出\n$$\nd(i) = \\gcd\\{n \\geq 1 : p^{(n)}(i,i) > 0\\}。\n$$\n在 $n$ 步后返回状态 $i$ 需要\n$$\ni + 2n \\equiv i \\pmod{10} \\quad \\Longleftrightarrow \\quad 2n \\equiv 0 \\pmod{10} \\quad \\Longleftrightarrow \\quad n \\equiv 0 \\pmod{5}。\n$$\n因此，返回时间的集合是 $\\{5,10,15,\\ldots\\}$，并且\n$$\nd(i) = \\gcd\\{5,10,15,\\ldots\\} = 5\n$$\n对于任意状态 $i \\in S$。因此，每个状态的周期都为 $5$。\n\n综合这些事实：该链是非不可约的，并且每个状态的周期都为 $5$。在这些选项中，这对应于陈述B。", "answer": "$$\\boxed{B}$$", "id": "1378756"}, {"introduction": "状态的周期性本质上由状态转移图中的“环路”结构决定。这个练习 [@problem_id:1378758] 引导我们将注意力从纯粹的代数计算转移到对状态转移图的拓扑分析上。通过追踪从一个状态出发并返回的所有可能路径，你将深刻理解返回时间集合与图中不同长度的闭合路径之间的直接联系，从而揭示周期的几何意义。", "problem": "考虑一个在离散时间步中演化的系统，该系统可以处于四个可能的状态之一，标记为 $S_1, S_2, S_3, S_4$。状态之间的转移遵循齐次马尔可夫链的规则。令 $p_{ij}$ 表示从状态 $S_i$ 到状态 $S_j$ 的一步转移概率。\n\n仅有的非零转移概率如下所示：\n- $p_{12} = \\alpha$\n- $p_{13} = 1-\\alpha$\n- $p_{21} = 1$\n- $p_{31} = 1-\\beta$\n- $p_{34} = \\beta$\n- $p_{43} = 1$\n\n其中 $\\alpha$ 和 $\\beta$ 是常数，满足 $0 < \\alpha < 1$ 且 $0 < \\beta < 1$。所有其他一步转移概率均为零。\n\n求状态 $S_1$ 的周期。", "solution": "马尔可夫链中状态 $i$ 的周期定义为 $d(i)=\\gcd\\{n\\ge 1: p_{ii}^{(n)}>0\\}$，其中 $p_{ii}^{(n)}$ 是返回到状态 $i$ 的 $n$ 步返回概率。我们来确定返回到 $S_{1}$ 的时间集合。\n\n首先，存在一条经由 $S_{2}$ 的 2 步返回路径：$S_{1}\\to S_{2}\\to S_{1}$，其概率为 $\\alpha\\cdot 1>0$，因此 $p_{11}^{(2)}>0$。同样，也存在一条经由 $S_{3}$ 的 2 步返回路径：$S_{1}\\to S_{3}\\to S_{1}$，其概率为 $(1-\\alpha)(1-\\beta)>0$。\n\n更一般地，从 $S_{1}$ 出发，先进行 $S_{1}\\to S_{3}$（概率为 $1-\\alpha>0$），然后在 $S_{3}\\to S_{4}\\to S_{3}$ 之间循环 $m\\ge 0$ 次（每次循环长度为 2，发生概率为 $\\beta\\cdot 1$），最后进行 $S_{3}\\to S_{1}$（概率为 $1-\\beta>0$）。这得到一条长度为 $2m+2$ 步的返回路径，其概率为 $(1-\\alpha)\\beta^{m}(1-\\beta)>0$。因此，对于所有整数 $m\\ge 0$，$p_{11}^{(2m+2)}>0$，所以每个大于等于 2 的偶数 $n$ 都是一个返回时间。\n\n不可能存在奇数步的返回时间。实际上，状态空间可以被二分为 $\\{S_{1},S_{4}\\}$ 和 $\\{S_{2},S_{3}\\}$：从 $S_{1}$ 出发，一步之内会转移到 $\\{S_{2},S_{3}\\}$，并且每一步转移都会在这两个集合之间交替进行。因此，从 $S_{1}$ 出发，系统只能在偶数时间步处于 $\\{S_{1},S_{4}\\}$，这使得对于所有奇数 $n$，$p_{11}^{(n)}=0$。\n\n因此，集合 $\\{n\\ge 1: p_{11}^{(n)}>0\\}$ 正是 $\\{2,4,6,\\ldots\\}$，其最大公约数为 $2$。所以，状态 $S_{1}$ 的周期是 $2$。", "answer": "$$\\boxed{2}$$", "id": "1378758"}, {"introduction": "周期性在网络分析和随机游走等实际应用中扮演着重要角色。这个练习 [@problem_id:1378717] 模拟了一个在服务器集群中游走的数据包，其底层结构是一个被轻微修改的二分图。通过分析这个微小修改如何引入奇数长度的回路，你将发现周期性是如何从 $2$ 变为 $1$（即非周期）的，这对于理解马尔可夫链的长期收敛行为至关重要。", "problem": "一个分布式计算系统由两个名为 `North` 和 `South` 的服务器集群组成，每个集群恰好包含四个服务器。设 `North` 集群中的服务器为 $\\{N_1, N_2, N_3, N_4\\}$，`South` 集群中的服务器为 $\\{S_1, S_2, S_3, S_4\\}$。\n\n最初，网络拓扑的设计使得 `North` 集群中的每个服务器都与 `South` 集群中的每个服务器有直接的双向连接。同一集群内的服务器之间没有连接。\n\n进行了一次网络升级，在 `North` 集群的服务器 $N_1$ 和 $N_2$ 之间引入了一条新的直接双向连接。\n\n一个诊断包在其中一个服务器上被发起。在每个离散时间步，该包被转发到与其直接相连的一个服务器。下一个服务器的选择是从所有可用邻居的集合中以等概率作出的。这个过程可以被建模为一个马尔可夫链，其中状态是八个服务器。\n\n马尔可夫链中一个状态的周期定义为所有正整数 $n$ 的集合的最大公约数，其中 $n$ 满足在恰好 $n$ 步后返回到该状态的概率非零。\n\n确定对应于服务器 $N_3$ 的状态的周期。", "solution": "将数据包的转发过程建模为在一个无向图上的简单随机游走，该图的顶点是八个服务器。边包括所有的 $\\{N_{i},S_{j}\\}$（其中 $i,j\\in\\{1,2,3,4\\}$）以及额外的边 $\\{N_{1},N_{2}\\}$。对于在邻居中进行等概率选择的相应马尔可夫链，在 $n$ 步后返回到状态 $x$ 的概率严格为正，当且仅当存在一个从 $x$ 开始并在 $x$ 结束的长度为 $n$ 的闭路。状态 $x$ 的周期是\n$$\nd(x)=\\gcd\\{\\,n\\geq 1: P^{n}(x,x)>0\\,\\}.\n$$\n\n考虑 $x=N_{3}$。首先，存在一个长度为 2 的闭路：选择任意一个 $S_{j}$，则有 $N_{3}\\to S_{j}\\to N_{3}$。每次移动都沿着一条存在的边进行，并且沿每条边的转移概率都是一个正数（具体来说，是 $\\frac{1}{\\deg(N_{3})}$ 接着是 $\\frac{1}{\\deg(S_{j})}$），所以\n$$\nP^{2}(N_{3},N_{3})\\geq \\frac{1}{\\deg(N_{3})}\\cdot\\frac{1}{\\deg(S_{j})}>0.\n$$\n\n其次，增加的边 $\\{N_{1},N_{2}\\}$ 使得从 $N_{3}$ 出发存在一个奇数长度的闭路。例如，\n$$\nN_{3}\\to S_{1}\\to N_{1}\\to N_{2}\\to S_{2}\\to N_{3},\n$$\n其长度为 $5$。所有这些边都存在，所以这条 $5$ 步路径的概率是\n$$\n\\frac{1}{\\deg(N_{3})}\\cdot\\frac{1}{\\deg(S_{1})}\\cdot\\frac{1}{\\deg(N_{1})}\\cdot\\frac{1}{\\deg(N_{2})}\\cdot\\frac{1}{\\deg(S_{2})}>0,\n$$\n这意味着\n$$\nP^{5}(N_{3},N_{3})>0.\n$$\n\n因此，集合 $\\{n\\geq 1: P^{n}(N_{3},N_{3})>0\\}$ 同时包含 $2$ 和 $5$，所以\n$$\nd(N_{3})=\\gcd(\\{n\\geq 1: P^{n}(N_{3},N_{3})>0\\}) \\subseteq \\gcd(2,5)=1.\n$$\n由于周期必须为正整数，所以状态 $N_{3}$ 的周期是 $1$。", "answer": "$$\\boxed{1}$$", "id": "1378717"}]}