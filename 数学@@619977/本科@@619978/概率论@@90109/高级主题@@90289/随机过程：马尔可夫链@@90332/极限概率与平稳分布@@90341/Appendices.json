{"hands_on_practices": [{"introduction": "这个练习为平稳分布提供了一个实际应用场景。通过计算一个智能吸尘器在不同房间的长期停留概率，我们可以确定一个关键的性能指标——它的平均灰尘收集率。这个练习将平稳分布的抽象概念置于一个具体的、解决问题的背景中，帮助你理解其应用价值。[@problem_id:1370817]", "problem": "一台先进的自动吸尘器在一套三室公寓中运行，该公寓由客厅（状态1）、卧室（状态2）和厨房（状态3）组成。在每分钟结束时，吸尘器会决定是留在当前房间还是移动到另一个房间。其移动被建模为一个离散时间马尔可夫链。转移概率由矩阵 $P$ 给出，其中 $P_{ij}$ 是在一分钟内从房间 $i$ 移动到房间 $j$ 的概率：\n$$\nP = \\begin{pmatrix} 0 & 1/2 & 1/2 \\\\ 1/4 & 1/2 & 1/4 \\\\ 1/2 & 1/3 & 1/6 \\end{pmatrix}\n$$\n吸尘器收集灰尘的速率取决于其所在的房间。收集速率如下：\n- 客厅（状态1）：$d_1 = 5.0$ 克/分钟。\n- 卧室（状态2）：$d_2 = 2.0$ 克/分钟。\n- 厨房（状态3）：$d_3 = 8.0$ 克/分钟。\n\n假设吸尘器运行很长一段时间，其长期的平均灰尘收集速率是多少？答案以克/分钟为单位，并四舍五入到三位有效数字。", "solution": "我们使用马尔可夫链的平稳分布来建模长期的平均收集速率。设 $\\pi = (\\pi_{1},\\pi_{2},\\pi_{3})$ 为平稳分布，其满足 $\\pi P = \\pi$ 和 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$。写出 $\\pi P = \\pi$ 的分量方程：\n$$\n\\pi_{1} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3}, \\quad\n\\pi_{2} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{2}\\pi_{2} + \\tfrac{1}{3}\\pi_{3}, \\quad\n\\pi_{3} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{6}\\pi_{3}.\n$$\n从第二个方程可得，\n$$\n\\pi_{2} - \\tfrac{1}{2}\\pi_{2} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{3}\\pi_{3} \\;\\;\\Rightarrow\\;\\; \\tfrac{1}{2}\\pi_{2} = \\tfrac{1}{2}\\pi_{1} + \\tfrac{1}{3}\\pi_{3} \\;\\;\\Rightarrow\\;\\; \\pi_{2} = \\pi_{1} + \\tfrac{2}{3}\\pi_{3}.\n$$\n将第一个方程的 $\\pi_{1} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3}$ 代入上式：\n$$\n\\pi_{2} = \\left(\\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3}\\right) + \\tfrac{2}{3}\\pi_{3} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{7}{6}\\pi_{3}\n\\;\\;\\Rightarrow\\;\\; \\tfrac{3}{4}\\pi_{2} = \\tfrac{7}{6}\\pi_{3}\n\\;\\;\\Rightarrow\\;\\; \\pi_{2} = \\tfrac{14}{9}\\pi_{3}.\n$$\n则\n$$\n\\pi_{1} = \\tfrac{1}{4}\\pi_{2} + \\tfrac{1}{2}\\pi_{3} = \\tfrac{1}{4}\\cdot\\tfrac{14}{9}\\pi_{3} + \\tfrac{1}{2}\\pi_{3} = \\tfrac{7}{18}\\pi_{3} + \\tfrac{9}{18}\\pi_{3} = \\tfrac{8}{9}\\pi_{3}.\n$$\n施加 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$ 的条件可得\n$$\n\\left(\\tfrac{8}{9} + \\tfrac{14}{9} + 1\\right)\\pi_{3} = \\tfrac{31}{9}\\pi_{3} = 1 \\;\\;\\Rightarrow\\;\\; \\pi_{3} = \\tfrac{9}{31}, \\;\\; \\pi_{1} = \\tfrac{8}{31}, \\;\\; \\pi_{2} = \\tfrac{14}{31}.\n$$\n长期的平均灰尘收集速率等于每分钟速率 $d_{1}=5$、$d_{2}=2$、$d_{3}=8$ 的平稳期望：\n$$\n\\bar{d} = \\pi_{1}d_{1} + \\pi_{2}d_{2} + \\pi_{3}d_{3} = \\tfrac{8}{31}\\cdot 5 + \\tfrac{14}{31}\\cdot 2 + \\tfrac{9}{31}\\cdot 8 = \\tfrac{40+28+72}{31} = \\tfrac{140}{31}.\n$$\n因此 $\\bar{d} = \\tfrac{140}{31} \\approx 4.516129\\ldots$，四舍五入到三位有效数字为 $4.52$ 克/分钟。", "answer": "$$\\boxed{4.52}$$", "id": "1370817"}, {"introduction": "并非所有平稳分布的计算都需要解复杂的方程组。本题将探索一个在图上的随机游走模型，并揭示一个关于顶点属性与其长期概率之间的深刻联系。你将应用一个关键定理，该定理将访问顶点的平稳概率与其度数联系起来，为这类重要的马尔可夫链问题提供了一条优雅的捷径。[@problem_id:1370816]", "problem": "考虑一个由8个相互连接的站点组成的系统，标记为 $V = \\{A_1, A_2, A_3, A_4, B_1, B_2, B_3, B_4\\}$。这些站点之间的连接形成一个具有以下结构的图：\n1.  站点集合 $\\{A_1, A_2, A_3, A_4\\}$ 构成一个完全图；也就是说，该集合中的每个站点都与该集合中的所有其他站点相连。\n2.  站点集合 $\\{B_1, B_2, B_3, B_4\\}$ 也构成一个完全图。\n3.  站点 $A_4$ 和站点 $B_1$ 之间存在一条单一的连接，将这两个完全图连接起来。\n除此之外没有其他连接。\n\n一个粒子在该站点网络上进行随机游走。在每个离散时间步，位于某个站点的粒子会移动到其直接连接（相邻）的站点之一。目标站点是从所有可用的相邻站点中均匀随机选择的。\n\n经过非常多的时间步后，系统会趋于一个稳态，此时在任何给定站点找到该粒子的概率都变为常数。这被称为极限概率。\n\n确定在站点 $A_2$ 找到该粒子的极限概率。请将答案表示为最简精确分数。", "solution": "将此随机游走建模为在一个无向连通图上的马尔可夫链。对于一个顶点集为 $V$、边集为 $E$ 的无向图上的简单随机游走，从顶点 $u$ 到相邻顶点 $v$ 的转移概率为\n$$\nP(u \\to v) = \\frac{1}{\\deg(u)} \\quad \\text{如果 } \\{u,v\\} \\in E,\n$$\n否则为零。使用细致平衡的一个标准结果表明，其平稳分布 $\\pi$ 为\n$$\n\\pi(v) = \\frac{\\deg(v)}{2|E|} \\quad \\text{对于所有 } v \\in V,\n$$\n因为对于相邻的 $u,v$，\n$$\n\\pi(u)P(u \\to v) = \\frac{\\deg(u)}{2|E|} \\cdot \\frac{1}{\\deg(u)} = \\frac{1}{2|E|} = \\frac{\\deg(v)}{2|E|} \\cdot \\frac{1}{\\deg(v)} = \\pi(v)P(v \\to u).\n$$\n给定的图是连通的并且包含三角形（每个 $K_{4}$ 团），因此该链是不可约和非周期的，这意味着它会收敛到唯一的平稳分布。\n\n计算度数：\n- 在每个 $K_{4}$ 中，每个顶点在其团内的度为 $3$。\n- $A_{4}$ 和 $B_{1}$ 之间的桥接边增加了一条边，因此 $\\deg(A_{4}) = 4$ 且 $\\deg(B_{1}) = 4$。\n- 所有其他顶点的度仍为 $3$。\n\n因此，\n$$\n\\deg(A_{1})=\\deg(A_{2})=\\deg(A_{3})=3,\\quad \\deg(A_{4})=4,\\quad \\deg(B_{1})=4,\\quad \\deg(B_{2})=\\deg(B_{3})=\\deg(B_{4})=3.\n$$\n计算边数：每个 $K_{4}$ 贡献 $\\binom{4}{2}=6$ 条边，桥接边增加 $1$ 条边，所以\n$$\n|E| = 6 + 6 + 1 = 13, \\quad \\text{因此} \\quad 2|E| = 26.\n$$\n等价地，根据握手引理可得 $\\sum_{v \\in V} \\deg(v) = 3+3+3+4+4+3+3+3 = 26 = 2|E|$。\n\n因此，$A_{2}$ 处的极限概率为\n$$\n\\pi(A_{2}) = \\frac{\\deg(A_{2})}{2|E|} = \\frac{3}{26}.\n$$", "answer": "$$\\boxed{\\frac{3}{26}}$$", "id": "1370816"}, {"introduction": "看似复杂的系统往往隐藏着可以极大简化分析的内在对称性。这个练习涉及一个在正方形上的随机游走，其转移概率是可变的。通过识别和利用该系统的对称性，你可以显著减少未知变量的数量，从而以更少的代数运算量求出其平稳分布。[@problem_id:1370787]", "problem": "一个质点在正方形的四个顶点上进行随机游走，这些顶点按顺时针顺序标记为1、2、3和4。该游走的移动规则定义如下：\n- 如果质点位于顶点1或顶点3，它将以概率 $p$ 跳到其两个相邻顶点中的任意一个，或以概率 $1-2p$ 跳到对角顶点。\n- 如果质点位于顶点2或顶点4，它将以概率 $q$ 跳到其两个相邻顶点中的任意一个，或以概率 $1-2q$ 跳到对角顶点。\n\n参数 $p$ 和 $q$ 是常数，满足 $0 < p < 0.5$ 和 $0 < q < 0.5$。质点从某个顶点开始，根据这些规则在离散时间步下从一个顶点移动到另一个顶点。\n\n经过非常大量的步数后，在任何给定顶点上找到该质点的概率会趋近于一个稳态值。求在顶点1找到该质点的长期概率。将您的答案表示为关于 $p$ 和 $q$ 的闭式解析表达式。", "solution": "将此运动建模为以顶点为状态的马尔可夫链。设平稳分布为 $(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$，其满足 $\\pi=\\pi P$ 和 $\\sum_{i=1}^{4}\\pi_{i}=1$。根据转移规则：\n- 从顶点1：以概率 $p$ 到2，以概率 $p$ 到4，以概率 $1-2p$ 到3。\n- 从顶点3：以概率 $p$ 到2，以概率 $p$ 到4，以概率 $1-2p$ 到1。\n- 从顶点2：以概率 $q$ 到1，以概率 $q$ 到3，以概率 $1-2q$ 到4。\n- 从顶点4：以概率 $q$ 到1，以概率 $q$ 到3，以概率 $1-2q$ 到2。\n\n平稳方程为：\n$$\n\\pi_{1}=\\pi_{2}q+\\pi_{4}q+\\pi_{3}(1-2p),\n$$\n$$\n\\pi_{2}=\\pi_{1}p+\\pi_{3}p+\\pi_{4}(1-2q),\n$$\n$$\n\\pi_{3}=\\pi_{2}q+\\pi_{4}q+\\pi_{1}(1-2p),\n$$\n$$\n\\pi_{4}=\\pi_{1}p+\\pi_{3}p+\\pi_{2}(1-2q),\n$$\n以及 $\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=1$。\n\n根据交换 $1\\leftrightarrow 3$ 和 $2\\leftrightarrow 4$ 的对称性，唯一的平稳分布必须满足 $\\pi_{1}=\\pi_{3}$ 和 $\\pi_{2}=\\pi_{4}$。设 $a=\\pi_{1}=\\pi_{3}$ 且 $b=\\pi_{2}=\\pi_{4}$。那么归一化条件给出\n$$\n2a+2b=1\\quad\\Rightarrow\\quad a+b=\\frac{1}{2}.\n$$\n使用第一个平衡方程，\n$$\na=\\pi_{1}=\\pi_{2}q+\\pi_{4}q+\\pi_{3}(1-2p)=2bq+a(1-2p),\n$$\n整理后得到\n$$\n2pa=2qb\\quad\\Rightarrow\\quad pa=qb.\n$$\n因此 $a/b=q/p$。与 $a+b=\\frac{1}{2}$ 结合：\n$$\n\\frac{q}{p}b+b=\\frac{1}{2}\\quad\\Rightarrow\\quad b\\left(\\frac{q}{p}+1\\right)=\\frac{1}{2}\\quad\\Rightarrow\\quad b=\\frac{p}{2(p+q)}.\n$$\n所以，\n$$\na=\\frac{q}{p}\\,b=\\frac{q}{p}\\cdot\\frac{p}{2(p+q)}=\\frac{q}{2(p+q)}.\n$$\n由于当 $0<p,q<\\frac{1}{2}$ 时，该链是有限的、不可约的（所有状态互通），并且是非周期的（由于对角和相邻移动，两步和三步返回的概率都为正），所以长期概率等于平稳概率。因此，处于顶点1的长期概率是\n$$\n\\pi_{1}=a=\\frac{q}{2(p+q)}.\n$$", "answer": "$$\\boxed{\\frac{q}{2(p+q)}}$$", "id": "1370787"}]}