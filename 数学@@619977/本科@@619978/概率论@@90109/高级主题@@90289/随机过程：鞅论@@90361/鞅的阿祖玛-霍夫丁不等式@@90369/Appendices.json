{"hands_on_practices": [{"introduction": "我们的第一个练习将从一个随机图论中的基本模型——随机锦标赛图——开始。在这个练习中，我们将分析一个节点的“影响力分数”（即其出度）的集中性。这个出度可以表示为一个独立随机变量的和，这为我们应用霍夫丁不等式（Azuma-Hoeffding 不等式的一个特例）提供了一个理想的初始场景 [@problem_id:1345082]。通过这个练习，你将把抽象的集中不等式与随机结构的具体性质联系起来，为你理解更复杂的随机过程打下坚实的基础。", "problem": "考虑一个由 $n$ 个用户组成的社交网络的简化模型。用户之间的关系被建模为一个随机竞赛图。对于任意一对不同的用户，例如用户A和用户B，他们之间会建立一个有向的“关注”关系。对于所有用户对，方向是随机且独立选择的：用户A关注用户B的概率为 $1/2$，用户B关注用户A的概率也为 $1/2$。\n\n用户的“影响力分数”定义为他们的出度，即他们关注的其他用户的数量。\n\n我们关注这个包含 $n$ 个用户的网络中的某一个特定用户。设 $D$ 为该用户的影响力分数。期望影响力分数为 $E[D]$。你的任务是找到实际影响力分数 $D$ 与其期望值之差的绝对值至少为 $\\lambda > 0$ 的概率的一个上界。也就是说，确定概率 $P(|D - E[D]| \\ge \\lambda)$ 的一个上界。该上界应表示为 $n$ 和 $\\lambda$ 的函数。", "solution": "固定一个特定用户。对于每一个其他用户，定义如下的指示变量：对于其余的 $n-1$ 个用户中的第 $i$ 个，如果我们的固定用户关注该用户，则令 $X_{i}$ 为 $1$，否则为 $0$。根据竞赛图的构造，每对用户之间的方向都是独立选择的，且每个方向的概率为 $\\frac{1}{2}$，因此 $X_{i}$ 是独立同分布的，服从 $X_{i} \\sim \\text{Bernoulli}\\!\\left(\\frac{1}{2}\\right)$ 且 $X_{i} \\in [0,1]$。\n\n该固定用户的影响力分数即为出度\n$$\nD=\\sum_{i=1}^{n-1} X_{i}.\n$$\n根据期望的线性性质以及 $\\mathbb{E}[X_{i}]=\\frac{1}{2}$，我们有\n$$\n\\mathbb{E}[D]=\\sum_{i=1}^{n-1} \\mathbb{E}[X_{i}]=\\frac{n-1}{2}.\n$$\n\n为了约束偏差概率 $\\mathbb{P}(|D-\\mathbb{E}[D]|\\ge \\lambda)$，我们对有界独立变量 $X_{i}\\in[a_{i},b_{i}]$（其中 $a_{i}=0$ 且 $b_{i}=1$）应用 Hoeffding 不等式。对于 $S=\\sum_{i=1}^{n-1} X_{i}$ 和任意 $t>0$，\n$$\n\\mathbb{P}\\!\\left(S-\\mathbb{E}[S]\\ge t\\right)\\le \\exp\\!\\left(-\\frac{2 t^{2}}{\\sum_{i=1}^{n-1} (b_{i}-a_{i})^{2}}\\right)=\\exp\\!\\left(-\\frac{2 t^{2}}{n-1}\\right),\n$$\n以及类似地\n$$\n\\mathbb{P}\\!\\left(\\mathbb{E}[S]-S\\ge t\\right)\\le \\exp\\!\\left(-\\frac{2 t^{2}}{n-1}\\right).\n$$\n对两个尾部使用并集界（或利用对称性），令 $S=D$ 和 $t=\\lambda$，我们得到双边集中界\n$$\n\\mathbb{P}\\!\\left(|D-\\mathbb{E}[D]|\\ge \\lambda\\right)\\le 2 \\exp\\!\\left(-\\frac{2 \\lambda^{2}}{n-1}\\right).\n$$\n\n这就得到了所求的、以 $n$ 和 $\\lambda$ 为函数的上界。", "answer": "$$\\boxed{2 \\exp\\!\\left(-\\frac{2 \\lambda^{2}}{n-1}\\right)}$$", "id": "1345082"}, {"introduction": "接下来，我们将进入计算机科学的核心领域：随机算法的性能分析。经典的随机快速排序算法中，关键比较的次数 $C$ 是一个随机变量，其行为可以通过鞅来建模。这个问题展示了 Azuma-Hoeffding 不等式如何为算法性能提供强有力的非渐近界，从而让我们能够制定严格的服务水平协议（SLA） [@problem_id:1336225]。这个实践将你的理解从简单的独立变量和推向了更真实、存在依赖性的场景，突显了鞅和 Azuma-Hoeffding 不等式在分析动态过程中的真正威力。", "problem": "一位软件工程师正在分析一个遗留数据处理系统的性能。该系统的一个核心组件使用随机化快速排序算法对大批量唯一的数值型作业标识符进行排序。整个系统的性能对该排序步骤中执行的关键比较次数高度敏感。\n\n考虑在 $n$ 个不同元素的列表上单次运行随机化快速排序算法。令 $C$ 为关键比较的总次数，它是一个随机变量。该工程师的目标是建立一个稳健的性能保证。\n\n为此分析，您将获得以下信息：\n1.  待排序的元素数量为 $n = 40000$。\n2.  比较次数的期望值 $\\mu$ 由公式 $\\mu = 2n \\ln(n)$ 给出，其中 $\\ln$ 表示自然对数。\n3.  $C$ 的概率行为可以使用一种形式的 Azuma-Hoeffding 不等式进行限定。对于排序过程的一个合适的鞅表示，单步差分平方和的上界为 $\\frac{\\pi^2}{6} n^2$。\n4.  使用的具体不等式为：$P(|C - \\mu| \\ge t) \\le 2 \\exp\\left(-\\frac{t^2}{B}\\right)$，其中 $t > 0$ 且 $B$ 是第3点中提到的单步差分平方和的上界。\n\n一项新的服务水平协议 (SLA) 要求，比较次数 $C$ 超过其均值 $\\mu$ 的量多于均值的一个特定分数 $\\lambda$ 的概率必须极小。具体来说，要求是 $P(C - \\mu > \\lambda \\mu) \\le 10^{-12}$。\n\n确定满足此 SLA 的无量纲分式偏差 $\\lambda$ 的最小值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们已知对 $n$ 个不同元素进行单次随机化快速排序，总比较次数为 $C$，均值为 $\\mu=2n\\ln(n)$，并有一个 Azuma-Hoeffding 类型的尾部界\n$$\nP\\!\\left(|C-\\mu|\\ge t\\right)\\le 2\\exp\\!\\left(-\\frac{t^{2}}{B}\\right),\n$$\n其中 $B$ 由单步差分平方和定界，此处 $B=\\frac{\\pi^{2}}{6}n^{2}$。\n\nSLA 要求\n$$\nP\\!\\left(C-\\mu>\\lambda\\mu\\right)\\le 10^{-12}.\n$$\n由于 $P(C-\\mu>\\lambda\\mu)\\le P(|C-\\mu|\\ge \\lambda\\mu)$，我们只需强制满足\n$$\nP\\!\\left(|C-\\mu|\\ge \\lambda\\mu\\right)\\le 10^{-12}.\n$$\n根据给定的不等式，\n$$\nP\\!\\left(|C-\\mu|\\ge \\lambda\\mu\\right)\\le 2\\exp\\!\\left(-\\frac{\\lambda^{2}\\mu^{2}}{B}\\right).\n$$\n因此，SLA 的一个充分条件是\n$$\n2\\exp\\!\\left(-\\frac{\\lambda^{2}\\mu^{2}}{B}\\right)\\le 10^{-12}.\n$$\n取自然对数并重新整理可得\n$$\n-\\frac{\\lambda^{2}\\mu^{2}}{B}+\\ln 2\\le -12\\ln 10\n\\quad\\Longrightarrow\\quad\n\\frac{\\lambda^{2}\\mu^{2}}{B}\\ge 12\\ln 10+\\ln 2,\n$$\n所以\n$$\n\\lambda^{2}\\ge \\frac{B}{\\mu^{2}}\\left(12\\ln 10+\\ln 2\\right).\n$$\n使用 $\\mu=2n\\ln n$ 和 $B=\\frac{\\pi^{2}}{6}n^{2}$，\n$$\n\\frac{B}{\\mu^{2}}\n=\\frac{\\frac{\\pi^{2}}{6}n^{2}}{\\left(2n\\ln n\\right)^{2}}\n=\\frac{\\pi^{2}}{24(\\ln n)^{2}}.\n$$\n因此，最小的充分 $\\lambda$ 为\n$$\n\\lambda=\\frac{\\pi}{\\ln n}\\sqrt{\\frac{12\\ln 10+\\ln 2}{24}}.\n$$\n对于 $n=40000$，$\\ln n=\\ln(4\\times 10^{4})=\\ln 4+4\\ln 10$。代入数值，\n$$\n\\ln 2\\approx 0.6931471806,\\quad \\ln 10\\approx 2.302585093,\\quad \\ln 4=2\\ln 2\\approx 1.386294361,\n$$\n所以\n$$\n\\ln n\\approx 1.386294361+4\\times 2.302585093\\approx 10.596634733,\n$$\n且\n$$\n\\lambda\\approx \\frac{\\pi}{10.596634733}\\sqrt{\\frac{12\\ln 10+\\ln 2}{24}}\n\\approx 0.296470788\\times 1.086357989\\approx 0.322073409.\n$$\n四舍五入到三位有效数字得到 $0.322$。", "answer": "$$\\boxed{0.322}$$", "id": "1336225"}, {"introduction": "最后，我们将挑战一个更高级的问题，来分析随机递归树的全局属性——维纳指数 $W(T_n)$。这个问题引入了有界差分方法（bounded differences method），这是 Azuma-Hoeffding 不等式思想的重要推广，通常通过麦克迪尔米德不等式（McDiarmid's inequality）来实现 [@problem_id:1345075]。通过估算单个随机选择（新节点连接到哪个父节点）对最终结果（整个图的维纳指数）的最大影响，我们可以为这个复杂的全局量提供一个强大的集中界。这个练习将促使你在一个非平凡的设置中应用有界差分的核心概念，将你的技能从处理简单的和扩展到分析随机变量的复杂函数。", "problem": "一个在顶点集 $V=\\{1, 2, \\dots, n\\}$ 上的随机递归树 $T_n$ 的构造如下：该树从单个顶点 $T_1$ 开始。对于 $k=2, 3, \\dots, n$，树 $T_k$ 是通过向 $T_{k-1}$ 中添加顶点 $k$ 以及一条连接 $k$ 与一个从集合 $\\{1, 2, \\dots, k-1\\}$ 中均匀随机选择的父顶点的边来形成的。\n\n图 $G$ 的维纳指数，记作 $W(G)$，是所有无序不同顶点对之间最短路径距离的总和。即，$W(G) = \\sum_{\\{u,v\\} \\subseteq V} d(u,v)$，其中 $d(u,v)$ 是 $u$ 和 $v$ 之间最短路径上的边数。\n\n令 $W(T_n)$ 为 $n$ 个顶点上随机递归树的维纳指数。推导概率 $P(|W(T_n) - \\mathbb{E}[W(T_n)]| \\geq t)$ 的一个上界，其中 $t > 0$。你的最终答案应为一个关于 $n$ 和 $t$ 的闭式表达式。", "solution": "该问题要求给出随机递归树的维纳指数的集中不等式。该随机过程由一个包含 $n-1$ 个独立随机选择的序列决定：对于每个顶点 $k \\in \\{2, \\dots, n\\}$，我们从 $\\{1, \\dots, k-1\\}$ 中均匀选择一个父顶点 $J_k$。维纳指数 $W(T_n)$ 是这 $n-1$ 个随机变量的函数，$W(T_n) = f(J_2, J_3, \\dots, J_n)$。\n\n我们可以使用 McDiarmid 不等式来界定 $W(T_n)$ 与其期望的偏差。McDiarmid 不等式表明，如果一个关于独立随机变量的函数 $f(X_1, \\dots, X_m)$ 满足有界差分性质，\n$$\n\\sup_{x_1, \\dots, x_m, x'_i} |f(x_1, \\dots, x_i, \\dots, x_m) - f(x_1, \\dots, x'_i, \\dots, x_m)| \\leq c_i\n$$\n对于每个 $i \\in \\{1, \\dots, m\\}$ 均成立，那么对于任何 $t > 0$，\n$$\nP(|f(X_1, \\dots, X_m) - \\mathbb{E}[f]| \\geq t) \\leq 2 \\exp\\left(-\\frac{2t^2}{\\sum_{i=1}^m c_i^2}\\right).\n$$\n\n在我们的情况下，变量是 $J_2, \\dots, J_n$。我们需要找到对于 $k=2, \\dots, n$ 的界 $c_k$。常数 $c_k$ 是指在保持所有其他父顶点选择固定的情况下，仅改变顶点 $k$ 的父顶点时，维纳指数 $W(T_n)$ 可能产生的最大变化量。\n\n让我们固定所有 $i \\in \\{2, \\dots, n\\} \\setminus \\{k\\}$ 的父顶点选择 $J_i$。这定义了树 $T_{k-1}$ 的结构，并且也指定了所有顶点 $i > k$ 将如何连接到正在生长的树上。设当顶点 $k$ 连接到父顶点 $j_a \\in \\{1, \\dots, k-1\\}$ 时，得到的树为 $T$；当 $k$ 连接到另一个父顶点 $j_b \\in \\{1, \\dots, k-1\\}$ 时，得到的树为 $T'$。树 $T$ 和 $T'$ 具有相同的顶点集，仅相差一条边：$(k, j_a) \\in E(T)$ 和 $(k, j_b) \\in E(T')$。\n\n我们想要界定 $|W(T) - W(T')|$。从 $T$ 中移除边 $(k, j_a)$ 会将树分成两个连通分量。一个分量是以 $k$ 为根的子树，我们称之为 $S_k$。该子树包含顶点 $k$ 本身以及所有满足“从顶点 $i$ 到根集 $\\{1, \\dots, k-1\\}$ 的路径经过 $k$”的顶点 $i>k$ 。另一个分量是 $T \\setminus S_k$。在 $T'$ 中，子树 $S_k$ 连接到顶点 $j_b$ 而不是 $j_a$。\n\n两个顶点同在 $S_k$ 中或同在 $T \\setminus S_k$ 中的顶点对之间的距离保持不变。维纳指数的变化来自于一个顶点在 $S_k$ 中而另一个在 $T \\setminus S_k$ 中的顶点对。\n设 $u \\in S_k$ 且 $v \\in T \\setminus S_k$。\n在 $T$ 中，从 $u$ 到 $v$ 的路径经过边 $(k, j_a)$。因此，$d_T(u,v) = d_{S_k}(u,k) + 1 + d_{T \\setminus S_k}(j_a, v)$。\n在 $T'$ 中，从 $u$ 到 $v$ 的路径经过边 $(k, j_b)$。因此，$d_{T'}(u,v) = d_{S_k}(u,k) + 1 + d_{T \\setminus S_k}(j_b, v)$。\n注意，图 $T \\setminus S_k$ 和 $T' \\setminus S_k$ 是相同的。\n\n维纳指数的总变化量为：\n$$\n\\Delta W = W(T) - W(T') = \\sum_{u \\in S_k} \\sum_{v \\in T \\setminus S_k} (d_T(u,v) - d_{T'}(u,v))\n$$\n$$\n\\Delta W = \\sum_{u \\in S_k} \\sum_{v \\in T \\setminus S_k} (d_{T \\setminus S_k}(j_a,v) - d_{T \\setminus S_k}(j_b,v))\n$$\n$$\n\\Delta W = |S_k| \\sum_{v \\in T \\setminus S_k} (d_{T \\setminus S_k}(j_a,v) - d_{T \\setminus S_k}(j_b,v))\n$$\n为界定 $|\\Delta W|$，我们使用距离的三角不等式：$|d(j_a,v) - d(j_b,v)| \\le d(j_a,j_b)$。距离 $d(j_a, j_b)$ 是在图 $T\\setminus S_k$ 中计算的。由于 $j_a, j_b \\in \\{1,\\dots, k-1\\}$，它们之间的路径完全位于由 $\\{1,\\dots, k-1\\}$ 诱导的子图中，即 $T_{k-1}$。\n$$\n|\\Delta W| \\leq |S_k| \\sum_{v \\in T \\setminus S_k} |d_{T \\setminus S_k}(j_a,v) - d_{T \\setminus S_k}(j_b,v)| \\leq |S_k| \\sum_{v \\in T \\setminus S_k} d_{T_{k-1}}(j_a,j_b)\n$$\n$$\n|\\Delta W| \\leq |S_k| |V(T \\setminus S_k)| d_{T_{k-1}}(j_a,j_b) = |S_k| (n - |S_k|) d_{T_{k-1}}(j_a,j_b).\n$$\n为找到 $c_k$，我们必须在所有可能的配置下最大化这个量。决定 $S_k$ 的连接选择与决定 $T_{k-1}$ 的选择是独立的。\n我们分别最大化每一项：\n1.  $\\max d_{T_{k-1}}(j_a, j_b)$：在一个有 $k-1$ 个顶点的树中，任意两个顶点之间的最大距离（即其直径）至多为 $k-2$。当 $T_{k-1}$ 是一个路径图且 $j_a, j_b$ 是其端点时，会达到这个最大值。\n2.  $\\max_{|S_k|} |S_k|(n - |S_k|)$：子树 $S_k$ 的大小范围可以从 1 到 $n-k+1$。函数 $x(n-x)$ 在 $x=n/2$ 时取得最大值。因此， $|S_k|(n-|S_k|) \\leq \\frac{n^2}{4}$。\n\n结合这些界限，我们得到最坏情况下的变化量 $c_k$：\n$$\nc_k \\leq \\frac{n^2}{4}(k-2).\n$$\n现在我们为 McDiarmid 不等式计算平方和：\n$$\n\\sum_{k=2}^{n} c_k^2 \\leq \\sum_{k=2}^{n} \\left(\\frac{n^2}{4}(k-2)\\right)^2 = \\frac{n^4}{16} \\sum_{k=2}^{n} (k-2)^2.\n$$\n令 $j=k-2$。该和变为：\n$$\n\\sum_{j=0}^{n-2} j^2 = \\frac{(n-2)((n-2)+1)(2(n-2)+1)}{6} = \\frac{(n-2)(n-1)(2n-3)}{6}.\n$$\n因此，差的平方和的界为：\n$$\n\\sum_{k=2}^{n} c_k^2 \\leq \\frac{n^4}{16} \\frac{(n-2)(n-1)(2n-3)}{6} = \\frac{n^4(n-1)(n-2)(2n-3)}{96}.\n$$\n将此代入 McDiarmid 不等式，我们得到最终的概率上界：\n$$\nP(|W(T_n) - \\mathbb{E}[W(T_n)]| \\geq t) \\leq 2 \\exp\\left(-\\frac{2t^2}{\\frac{n^4(n-1)(n-2)(2n-3)}{96}}\\right)\n$$\n$$\nP(|W(T_n) - \\mathbb{E}[W(T_n)]| \\geq t) \\leq 2 \\exp\\left(-\\frac{192 t^2}{n^4(n-1)(n-2)(2n-3)}\\right).\n$$\n为使公式非退化，该问题仅在 $n \\ge 3$ 时有意义。对于 $n=2$，平方和为 0。\n\n最终表达式：\n对于 $n \\ge 3$：$2 \\exp\\left(-\\frac{192 t^2}{n^4(n-1)(n-2)(2n-3)}\\right)$。\n对于 $n=2$，$T_2$ 是固定的（边 (1,2)），$W(T_2)=1$，因此如果 $t>0$，概率为 0。该公式不适用。我们假设 $n \\ge 3$。\n该表达式也可以写成在指数中避免使用分数的形式。\n$2 \\exp\\left(-192 t^2 (n^4(n-1)(n-2)(2n-3))^{-1}\\right)$。", "answer": "$$\\boxed{2\\exp\\left(-\\frac{192t^{2}}{n^{4}(n-1)(n-2)(2n-3)}\\right)}$$", "id": "1345075"}]}