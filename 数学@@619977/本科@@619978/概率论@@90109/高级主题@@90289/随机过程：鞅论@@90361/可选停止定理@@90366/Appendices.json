{"hands_on_practices": [{"introduction": "我们的第一个练习将演示如何利用可选停止定理来量化随机事件的概率。我们将探讨一个带有负漂移的随机游走，直观上它倾向于向下移动。通过构建一个巧妙的指数鞅，我们可以将这个有偏的过程转换为一个“公平游戏”，然后应用可选停止定理来精确计算这个随机游走达到某个高度的概率。这个练习 [@problem_id:1403925] 是一个经典切入点，展示了将理论转化为强大计算工具的核心思想。", "problem": "一个粒子在整数集 $\\mathbb{Z}$ 上进行随机游走。粒子从位置 $S_0=0$ 开始。在每个离散时间步 $n = 1, 2, \\dots$，粒子的位置变化量为 $X_n$。增量 $X_n$ 是独立同分布的随机变量，其概率分布如下：\n$$\nP(X_n = +1) = p \\quad \\text{and} \\quad P(X_n = -1) = 1-p\n$$\n经过 $n$ 步后粒子的位置由和式 $S_n = \\sum_{i=1}^n X_i$ 给出。已知向右移动一个单位的概率 $p$ 是一个严格小于 $1/2$ 的常数。\n\n对于给定的正整数目标水平 $a > 0$，求粒子位置 $S_n$ 曾达到或超过 $a$ 的概率的一个上界。将答案表示为关于 $p$ 和 $a$ 的解析表达式。", "solution": "令 $q = 1 - p$，因为 $p < \\frac{1}{2}$，所以 $q > p$。考虑随机游走 $S_{n} = \\sum_{i=1}^{n} X_{i}$，其中 $X_{i} \\in \\{+1,-1\\}$，并定义目标水平 $a \\in \\mathbb{N}$。\n\n为了界定 $P\\!\\left(\\sup_{n \\geq 0} S_{n} \\geq a\\right)$，我们构建一个指数鞅。对于 $r > 0$，定义 $M_{n} = r^{S_{n}}$。由于 $X_{i}$ 是独立同分布的，\n$$\n\\mathbb{E}\\!\\left[r^{X_{1}}\\right] = p r + q r^{-1}.\n$$\n选择 $r$ 使其满足鞅条件 $\\mathbb{E}\\!\\left[r^{X_{1}}\\right] = 1$，这得到二次方程\n$$\np r^{2} - r + q = 0.\n$$\n该方程的根为 $r = 1$ 和 $r = \\frac{q}{p}$。因为 $q > p$，我们取 $r = \\frac{q}{p} > 1$。那么，其中 $M_{n} = r^{S_{n}}$ 的 $\\{M_{n}\\}_{n \\geq 0}$ 是一个鞅，且 $M_{0} = r^{S_{0}} = 1$。\n\n对于 $a, b \\in \\mathbb{N}$，定义停时 $T_{a} = \\inf\\{n \\geq 0 : S_{n} = a\\}$ 和 $T_{-b} = \\inf\\{n \\geq 0 : S_{n} = -b\\}$，并令 $T = \\min\\{T_{a}, T_{-b}\\}$。由于增量的有界性，可选停止定理适用，得到\n$$\n\\mathbb{E}\\!\\left[M_{T}\\right] = \\mathbb{E}\\!\\left[r^{S_{T}}\\right] = M_{0} = 1.\n$$\n令 $P_{a,b} = \\mathbb{P}(T_{a} < T_{-b})$。在事件 $\\{T_{a} < T_{-b}\\}$ 上，$S_{T} = a$；在事件 $\\{T_{-b} < T_{a}\\}$ 上，$S_{T} = -b$。因此\n$$\n1 = \\mathbb{E}\\!\\left[r^{S_{T}}\\right] = r^{a} P_{a,b} + r^{-b} (1 - P_{a,b}).\n$$\n解出 $P_{a,b}$：\n$$\n1 - r^{-b} = P_{a,b} \\left(r^{a} - r^{-b}\\right)\n\\quad \\Longrightarrow \\quad\nP_{a,b} = \\frac{1 - r^{-b}}{r^{a} - r^{-b}} = \\frac{r^{b} - 1}{r^{a+b} - 1}.\n$$\n令 $b \\to \\infty$ 并利用 $r > 1$，我们得到\n$$\n\\mathbb{P}\\!\\left(\\sup_{n \\geq 0} S_{n} \\geq a\\right)\n= \\lim_{b \\to \\infty} P_{a,b}\n= \\lim_{b \\to \\infty} \\frac{r^{b} - 1}{r^{a+b} - 1}\n= r^{-a}\n= \\left(\\frac{p}{q}\\right)^{a}\n= \\left(\\frac{p}{1 - p}\\right)^{a}.\n$$\n因此一个上界是\n$$\n\\mathbb{P}\\!\\left(\\sup_{n \\geq 0} S_{n} \\geq a\\right) \\leq \\left(\\frac{p}{1 - p}\\right)^{a},\n$$\n并且实际上，对于此随机游走，等号成立。", "answer": "$$\\boxed{\\left(\\frac{p}{1-p}\\right)^{a}}$$", "id": "1403925"}, {"introduction": "在掌握了基础方法后，我们来挑战一个更复杂但极为经典的“赌徒破产”问题。直接计算游戏持续时间的期望值非常困难，但可选停止定理为我们提供了一条优雅的解决路径。在这个练习 [@problem_id:809940] 中，我们将构造两个不同的鞅：一个用于计算赌徒最终获胜的概率，另一个则将游戏的终点位置与期望持续时间联系起来。这充分展示了可选停止定理的灵活性，即如何通过组合不同的鞅来解决一个多层次的问题。", "problem": "一个粒子在整数上进行一维随机游走。粒子在时间 $n$ 的位置记为 $X_n$。它从一个初始整数位置 $X_0 = i$ 开始，其中 $0 < i < N$。在每个离散时间步，粒子以概率 $p$ 向右移动一个单位，或以概率 $q=1-p$ 向左移动一个单位。该游走是有偏的，即 $p \\neq q$。当粒子的位置到达 0 或 $N$ 时，游走停止。发生这种情况的时间是停时 $T = \\inf\\{n \\ge 0: X_n=0 \\text{ 或 } X_n=N\\}$。\n\n对于此问题，您将需要以下定义：\n- 一个随机变量序列 $\\{M_n\\}_{n \\ge 0}$ 相对于一个σ-代数流 $\\{\\mathcal{F}_n\\}_{n \\ge 0}$（在这里，$\\mathcal{F}_n$ 是直到时间 $n$ 的游走历史）是一个**鞅**，如果对于所有 $n$ 都有 $E[|M_n|] < \\infty$，并且 $E[M_{n+1} | \\mathcal{F}_n] = M_n$。\n- **可选停止定理**指出，对于一个鞅 $M_n$ 和一个停时 $T$，在某些正则性条件下（您可以假设这些条件在此问题中成立），鞅在停时的期望等于其初始期望：$E[M_T] = E[M_0]$。\n\n您的任务是推导随机游走的期望时长 $E[T]$ 的一个闭式表达式，该表达式用参数 $i$、$N$、$p$ 和 $q$ 表示。推导必须遵循以下特定步骤：\n1.  定义过程 $M_n = X_n - n(p-q)$。证明 $M_n$ 是一个鞅，并使用可选停止定理找到期望停时 $E[T]$ 和期望终点位置 $E[X_T]$ 之间的关系。\n2.  定义过程 $Z_n = (q/p)^{X_n}$。证明 $Z_n$ 是一个鞅，并使用可选停止定理求出游走在位置 $N$ 结束的概率，即 $P(X_T=N)$。\n3.  结合前面步骤的结果，推导出 $E[T]$ 的最终显式表达式。", "solution": "1. 定义 $M_n = X_n - n(p-q)$。那么\n\n$$\nE[M_{n+1}-M_n\\mid\\mathcal F_n]\n=E[X_{n+1}-X_n\\mid\\mathcal F_n]-(p-q)\n=(p-q)-(p-q)=0,\n$$\n\n且 $E[|M_n|]<\\infty$，所以 $\\{M_n\\}$ 是一个鞅。根据停时 $T$ 处的可选停止定理，\n\n$$\nE[M_T]=E[M_0]\\quad\\Longrightarrow\\quad\nE[X_T - (p-q)T]=i\n\\quad\\Longrightarrow\\quad\nE[X_T]-(p-q)E[T]=i.\n\\tag{1}\n$$\n\n2. 定义 $Z_n=(q/p)^{X_n}$。那么\n\n$$\nE\\bigl[Z_{n+1}\\mid\\mathcal F_n\\bigr]\n=p\\,(q/p)^{X_n+1}+q\\,(q/p)^{X_n-1}\n=(q/p)^{X_n}\\bigl[p(q/p)+q(p/q)\\bigr]\n=(q/p)^{X_n},\n$$\n\n所以 $\\{Z_n\\}$ 是一个鞅。根据可选停止定理，\n\n$$\nE[Z_T]=E[Z_0]\\quad\\Longrightarrow\\quad\n(q/p)^i\n=E\\bigl[(q/p)^{X_T}\\bigr]\n=(q/p)^N P(X_T=N)+1\\cdot P(X_T=0).\n$$\n\n令 $\\alpha=P(X_T=N)$。那么\n\n$$\n(q/p)^i=\\alpha (q/p)^N+(1-\\alpha)\n\\;\\Longrightarrow\\;\n\\alpha=\\frac{1-(q/p)^i}{1-(q/p)^N}.\n\\tag{2}\n$$\n\n3. 从 (1) 我们有 $E[X_T]=N\\alpha$，所以\n\n$$\nN\\alpha-(p-q)E[T]=i\n\\quad\\Longrightarrow\\quad\nE[T]\n=\\frac{N\\alpha-i}{p-q}\n=\\frac{N\\frac{1-(q/p)^i}{1-(q/p)^N}-i}{p-q}.\n$$", "answer": "$$\\boxed{\\frac{N\\frac{1-(\\frac{q}{p})^i}{1-(\\frac{q}{p})^N}-i}{p-q}}$$", "id": "809940"}, {"introduction": "最后的练习将带领我们探索可选停止定理在更广阔领域中的应用，其威力远不止于处理随机游走首次到达边界的问题。本题 [@problem_id:809821] 提供了一个不那么直观的高阶多项式鞅，并引入了一个本身就是随机变量的停止时间。这个问题向我们揭示了，只要能找到或给定一个合适的鞅过程，可选停止定理就能成为计算被停过程矩的有力工具，从而获得关于该过程的深刻见解。", "problem": "考虑一个从 $S_0=0$ 出发的一维对称随机游走 $S_n = \\sum_{i=1}^n X_i$。步长 $X_i$ 是独立同分布的随机变量，满足 $P(X_i=1) = \\frac{1}{2}$ 和 $P(X_i=-1) = \\frac{1}{2}$。该随机游走被观测至一个随机时刻 $T$，该时刻 $T$ 独立于序列 $\\{X_i\\}$，并服从成功概率为 $p \\in (0, 1)$ 的几何分布。$T$ 的概率质量函数为 $P(T=k) = p(1-p)^{k-1}$，其中 $k=1, 2, 3, \\ldots$。\n\n已知对于此对称随机游走，由\n$$\nM_n = S_n^4 - 6nS_n^2 + 3n^2 + n\n$$\n定义的过程 $M_n$ 是关于自然滤子 $\\mathcal{F}_n = \\sigma(X_1, \\ldots, X_n)$ 的一个鞅。\n\n通过将可选停止定理应用于停时 $T$ 处的鞅 $M_n$，推导停止的随机游走位置的四阶矩 $E[S_T^4]$ 关于参数 $p$ 的闭式表达式。你可以假定可选停止定理的条件已满足。", "solution": "1. 相关公式：  \n   - 鞅性质和可选停止定理：\n     $$E[M_T]=E[M_0]=0,$$\n     其中 \n     $$M_n = S_n^4 - 6nS_n^2 + 3n^2 + n.$$\n   - 对称随机游走的条件矩：\n     $$E[S_n^2]=n,\\quad E[S_n^4]=3n^2 -2n.$$\n   - $T\\sim\\mathrm{Geom}(p)$ 的矩：\n     $$E[T]=\\frac1p,\\quad E[T^2]=\\frac{2-p}{p^2}.$$\n2. 应用可选停止定理：\n   $$0=E[M_T]=E\\bigl[S_T^4 -6T S_T^2 +3T^2 + T\\bigr]$$\n   $$\\implies E[S_T^4] = 6\\,E[T S_T^2] -3\\,E[T^2] - E[T].$$\n3. 计算混合矩：\n   $$E[T S_T^2]=E\\bigl[E[T S_T^2\\mid T]\\bigr]\n   =E\\bigl[T\\,E[S_T^2\\mid T]\\bigr]\n   =E[T\\cdot T]\n   =E[T^2].$$\n4. 代入：\n   $$E[S_T^4]\n   =6E[T^2]-3E[T^2]-E[T]\n   =3E[T^2]-E[T]\n   =3\\frac{2-p}{p^2}-\\frac1p\n   =\\frac{6-3p-p}{p^2}\n   =\\frac{6-4p}{p^2}.$$", "answer": "$$\\boxed{\\frac{6-4p}{p^2}}$$", "id": "809821"}]}