{"hands_on_practices": [{"introduction": "切尔诺夫界最直接的应用之一是估计独立随机变量之和的偏差概率。本练习通过一个关于电子元器件质量控制的场景，让您能够直接应用一个标准的切尔诺夫界公式进行计算。通过这个基础练习 [@problem_id:1348627]，您将为理解这些不等式的工作原理和威力迈出坚实的第一步。", "problem": "一家公司生产大批量的简易电子开关。每个开关都是独立生产的，其功能正常的概率恰好为 $p = 0.5$。该公司以每盒 $n=100$ 个为单位出售这些开关。令 $S$ 表示随机抽取的一盒中功能正常的开关总数。\n\n公司政策要求对任何出现异常结果的生产批次进行调查。他们不仅担心有缺陷的开关太多，也担心批次看起来“过于完美”，因为这可能表明他们的自动化测试设备存在缺陷（例如，在评估中过于宽松）。\n\n您的任务是分析出现这样一个“过于完美”批次的可能性。使用 Chernoff 界的一种特定形式，计算一盒中功能正常的开关数量超过 65 的概率的上界。\n\n对于独立伯努利随机变量之和 $S = \\sum_{i=1}^n X_i$，其均值为 $\\mu = E[S]$，对于任意 $0 < \\delta \\le 1$，以下 Chernoff 界不等式成立：\n$$P(S > (1+\\delta)\\mu) \\le \\exp\\left(-\\frac{\\delta^2 \\mu}{3}\\right)$$\n请以数值形式提供您的答案。将您的最终答案四舍五入到三位有效数字。", "solution": "令 $X_{i}$ 为独立的伯努利随机变量，其中 $P(X_{i}=1)=p=0.5$，且 $S=\\sum_{i=1}^{n}X_{i}$，$n=100$。那么均值为\n$$\n\\mu=E[S]=np=100\\times 0.5=50.\n$$\n我们寻求 $P(S>65)$ 的一个上界。使用给定的 Chernoff 界，对于 $0<\\delta\\le 1$，\n$$\nP\\!\\left(S>(1+\\delta)\\mu\\right)\\le \\exp\\!\\left(-\\frac{\\delta^{2}\\mu}{3}\\right).\n$$\n选择 $\\delta$ 使得 $(1+\\delta)\\mu=65$。解得，\n$$\n\\delta=\\frac{65}{\\mu}-1=\\frac{65}{50}-1=1.3-1=0.3,\n$$\n这满足 $0<\\delta\\le 1$。因此，\n$$\nP(S>65)\\le \\exp\\!\\left(-\\frac{\\delta^{2}\\mu}{3}\\right)=\\exp\\!\\left(-\\frac{(0.3)^{2}\\cdot 50}{3}\\right)=\\exp(-1.5).\n$$\n数值计算并四舍五入到三位有效数字，得到\n$$\n\\exp(-1.5)\\approx 0.223.\n$$", "answer": "$$\\boxed{0.223}$$", "id": "1348627"}, {"introduction": "现在，让我们换一个角度思考。在工程和实验设计中，我们常常需要确定需要多少次试验才能达到预期的置信水平，而不是仅仅为固定的试验次数计算一个概率。这个练习 [@problem_id:1348596] 探讨了这样一个“逆向问题”。通过计算随机数生成器所需的最小测试次数，您将学会如何运用切尔诺夫界来设计实验并确保其结果的可靠性。", "problem": "一家公司正在开发一种用于密码学应用的新型硬件随机数生成器 (RNG)。该RNG的一个关键特性是它必须是“公平的”，即生成 `1` 的概率与生成 `0` 的概率完全相同，即 $p=0.5$。\n\n为进行初步的质量保证测试，一位工程师将该生成器运行总共 $n$ 次，并记录产生的比特序列。如果观测到的序列中“1”的比例严格介于 0.4 和 0.6 之间，则该测试被视为“通过”。\n\n使用Chernoff型不等式，确定必须执行的最少试验次数 $n$，以保证测试通过的概率至少为 99%。你的最终答案必须是一个整数。", "solution": "令 $X_{1},\\dots,X_{n}$ 为独立同分布 (i.i.d.) 的伯努利变量，满足 $\\mathbb{P}(X_{i}=1)=\\mathbb{P}(X_{i}=0)=\\frac{1}{2}$。将样本均值记为 $\\hat{p}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。当 $0.4<\\hat{p}_{n}<0.6$ 时测试通过，即 $|\\hat{p}_{n}-\\frac{1}{2}|<\\frac{1}{10}$。测试失败事件为 $|\\hat{p}_{n}-\\frac{1}{2}|\\geq \\frac{1}{10}$。\n\n对于在 $[0,1]$ 区间内的有界独立同分布变量，使用Hoeffding（Chernoff型）不等式，\n$$\n\\mathbb{P}\\!\\left(\\left|\\hat{p}_{n}-\\mathbb{E}[X_{i}]\\right|\\geq \\epsilon\\right)\\leq 2\\exp\\!\\left(-2n\\epsilon^{2}\\right),\n$$\n其中 $\\epsilon=\\frac{1}{10}$ 且 $\\mathbb{E}[X_{i}]=\\frac{1}{2}$，我们得到\n$$\n\\mathbb{P}(\\text{fail})=\\mathbb{P}\\!\\left(\\left|\\hat{p}_{n}-\\tfrac{1}{2}\\right|\\geq \\tfrac{1}{10}\\right)\\leq 2\\exp\\!\\left(-2n\\cdot\\frac{1}{100}\\right)=2\\exp\\!\\left(-\\frac{n}{50}\\right).\n$$\n为保证 $\\mathbb{P}(\\text{pass})\\geq 0.99$，我们只需强制要求 $\\mathbb{P}(\\text{fail})\\leq \\frac{1}{100}$，即\n$$\n2\\exp\\!\\left(-\\frac{n}{50}\\right)\\leq \\frac{1}{100}.\n$$\n求解可得，\n$$\n\\exp\\!\\left(-\\frac{n}{50}\\right)\\leq \\frac{1}{200}\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{n}{50}\\leq \\ln\\!\\left(\\frac{1}{200}\\right)=-\\ln(200)\n\\;\\;\\Longrightarrow\\;\\;\nn\\geq 50\\ln(200).\n$$\n因此，最小整数为 $n=\\lceil 50\\ln(200)\\rceil$。使用 $\\ln(200)=\\ln 2+2\\ln 10\\approx 0.69314718056+2\\cdot 2.302585093\\approx 5.298317366$，我们得到\n$$\n50\\ln(200)\\approx 264.9158683,\n$$\n因此，满足要求的最小整数 $n$ 是 $265$。", "answer": "$$\\boxed{265}$$", "id": "1348596"}, {"introduction": "切尔诺夫界的真正威力在于其在分析复杂系统（如随机算法的效率）时的应用。最后的这个练习 [@problem_id:1348647] 将带您深入理论计算机科学的核心，探究著名的随机化快速排序算法。您将运用切尔诺夫界来证明此算法有极高的概率表现优异，为其性能提供一个强有力的保证，这也是现代算法分析的基石之一。", "problem": "考虑应用于一个包含 $n$ 个不同元素的数组的随机快速排序算法。在对子数组的每一步递归中，都会从该子数组中均匀随机地选择一个枢轴。如果所选的枢轴不在当前子数组中最小的25%或最大的25%的元素之列，我们称之为“平衡的”枢轴选择。换句话说，一个平衡的枢轴位于其所在元素集合的第25个百分位数和第75个百分位数之间。\n\n对于一个特定元素，当包含它的子数组缩小到大小为1时，其递归路径终止。该元素路径上的递归调用总数即为其“递归深度”。\n\n你的任务是为数组中任意元素的最大递归深度找到一个简化的、高概率的上界。具体来说，推导至少有一个元素的递归深度超过 $k_0 = \\frac{4 \\ln n}{\\ln(4/3)}$ 的概率的上界。\n\n在推导过程中，你可以使用以下用于下尾的乘法形式Chernoff界。令 $S$ 为一系列独立的Bernoulli随机变量之和，其均值为 $\\mu = E[S]$。对于任意 $0 < \\delta < 1$，以下不等式成立：\n$$P(S < (1-\\delta)\\mu) \\le \\exp\\left(-\\frac{\\mu\\delta^2}{2}\\right)$$\n\n将你的最终答案表示为关于 $n$ 的符号表达式。", "solution": "固定任意一个元素，并追踪其递归路径。对子数组的每一次递归调用都会从该子数组中均匀随机地选择一个枢轴。如果枢轴在子数组中的秩位于第25个百分位数到第75个百分位数之间，则称该枢轴选择是平衡的。一个平衡的枢轴会将继续包含我们固定元素的子数组的大小减小到至多为原来的 $\\frac{3}{4}$，因为分割后的两个部分的规模都至多是当前规模的 $\\frac{3}{4}$。\n\n令 $X_{i}$ 为该固定路径上第 $i$ 个枢轴是平衡的的指示变量。因为每个枢轴都是从当前子数组中独立且均匀地选择的，并且根据给定的定义，恰好有一半的秩是平衡的，所以对于每一个 $i$，我们有 $P(X_{i}=1)=\\frac{1}{2}$，且 $X_{i}$ 在各个步骤之间是独立的。定义 $S_{k}=\\sum_{i=1}^{k}X_{i}$，因此 $S_{k}$ 计算了路径上前 $k$ 步中出现的平衡枢轴的数量。其均值为\n$$\n\\mu=E[S_{k}]=\\frac{k}{2}.\n$$\n\n如果经过 $k$ 步后，我们所关注元素的递归尚未终止，那么包含它的子数组的大小至少为2。另一方面，每个平衡步骤将子数组大小乘以一个至多为 $\\frac{3}{4}$ 的因子，因此经过 $S_{k}$ 次平衡步骤后，子数组的大小至多为 $n\\left(\\frac{3}{4}\\right)^{S_{k}}$。因此，深度超过 $k$ 的事件意味着\n$$\nn\\left(\\frac{3}{4}\\right)^{S_{k}}\\geq 2 \\quad\\Rightarrow\\quad n\\left(\\frac{3}{4}\\right)^{S_{k}}>1 \\quad\\Rightarrow\\quad S_{k}\\leq \\frac{\\ln n}{\\ln(4/3)}.\n$$\n特别地，对于 $k=k_{0}=\\frac{4\\ln n}{\\ln(4/3)}$，我们有 $\\frac{\\ln n}{\\ln(4/3)}=\\frac{k_{0}}{4}$。因此，对于一个固定的元素，\n$$\nP(\\text{深度}>k_{0})\\leq P\\!\\left(S_{k_{0}}<\\frac{k_{0}}{4}\\right).\n$$\n\n将给定的乘法形式Chernoff界应用于 $S_{k_{0}}$，它是一系列独立的Bernoulli随机变量之和，均值为 $\\mu=\\frac{k_{0}}{2}$。令 $(1-\\delta)\\mu=\\frac{k_{0}}{4}$，可得 $1-\\delta=\\frac{1}{2}$，因此 $\\delta=\\frac{1}{2}$。该界给出\n$$\nP\\!\\left(S_{k_{0}}<\\frac{k_{0}}{4}\\right)\\leq \\exp\\!\\left(-\\frac{\\mu\\delta^{2}}{2}\\right)=\\exp\\!\\left(-\\frac{\\frac{k_{0}}{2}\\cdot \\frac{1}{4}}{2}\\right)=\\exp\\!\\left(-\\frac{k_{0}}{16}\\right).\n$$\n因此，对于一个固定的元素，\n$$\nP(\\text{深度}>k_{0})\\leq \\exp\\!\\left(-\\frac{k_{0}}{16}\\right).\n$$\n\n为了界定 $n$ 个元素中至少有一个的递归深度超过 $k_{0}$ 的概率，我们应用联合界（union bound）：\n$$\nP\\!\\left(\\max_{\\text{元素}} \\text{深度}>k_{0}\\right)\\leq n\\cdot \\exp\\!\\left(-\\frac{k_{0}}{16}\\right).\n$$\n代入 $k_{0}=\\frac{4\\ln n}{\\ln(4/3)}$ 并化简：\n$$\nn\\cdot \\exp\\!\\left(-\\frac{1}{16}\\cdot \\frac{4\\ln n}{\\ln(4/3)}\\right)\n= n\\cdot \\exp\\!\\left(-\\frac{\\ln n}{4\\ln(4/3)}\\right)\n= n^{\\,1-\\frac{1}{4\\ln(4/3)}}.\n$$\n\n这就得到了所求的、用 $n$ 表示的简化上界。", "answer": "$$\\boxed{n^{\\,1-\\frac{1}{4\\ln(4/3)}}}$$", "id": "1348647"}]}