{"hands_on_practices": [{"introduction": "理论的生命力在于其解释和预测具体现象的能力。让我们从最简单的一维情形——一根两端固定的弦的振动——开始，亲手验证韦尔定律。通过直接求解拉普拉斯算子在一维区间上的特征值问题，我们可以得到特征值计数函数的精确表达式，从而为韦尔定律提供一个坚实且清晰的起点。这项练习将向你展示，抽象的渐近公式是如何从一个具体、可解的物理模型中自然浮现的。[@problem_id:3078749]", "problem": "设 $\\Omega = (0,L)$，其中 $L>0$。考虑作用于 $\\Omega$ 上的二阶连续可微函数 $u$ 的狄利克雷拉普拉斯算子 $-\\Delta$，其中 $u$ 满足 $u(0)=u(L)=0$。该特征值问题为二阶线性常微分方程 (ODE) $-u''(x)=\\lambda u(x)$，并服从狄利克雷边界条件。定义特征值计数函数 $N(\\lambda)$ 为小于或等于给定阈值 $\\lambda>0$ 的特征值（计入重数）的数量。从该常微分方程及其边界条件出发，确定 $N(\\lambda)$ 的精确闭式表达式，并推导出当 $\\lambda\\to\\infty$ 时渐近式 $N(\\lambda)\\sim C\\,\\lambda^{1/2}$ 中的首项系数 $C$。以一个包含精确 $N(\\lambda)$ 和常数 $C$ 的单一表达式给出最终答案。无需四舍五入，也不涉及单位。回顾一下，一维单位球的体积（勒贝格测度）为 $\\omega_1=2$，$\\Omega$ 的体积为 $\\mathrm{vol}(\\Omega)=L$。", "solution": "所述问题具有科学依据，是适定、客观且自洽的。它是一维谱理论中的一个标准练习题，也是 Sturm-Liouville 问题的一个特例。所有必要的定义和条件都已给出，且没有矛盾或歧义。因此该问题是有效的，我们可以着手求解。\n\n我们的任务是找到在区间 $\\Omega = (0, L)$ 上服从狄利克雷边界条件的负拉普拉斯算子 $-\\Delta = -\\frac{d^2}{dx^2}$ 的特征值。特征值问题由以下常微分方程 (ODE) 给出：\n$$\n-u''(x) = \\lambda u(x) \\quad \\text{for } x \\in (0, L)\n$$\n边界条件为：\n$$\nu(0) = 0 \\quad \\text{and} \\quad u(L) = 0\n$$\n为确保有非平凡解 $u(x)$，特征值 $\\lambda$ 必须为正。在这些边界条件下，$\\lambda \\le 0$ 只会导致平凡解 $u(x)=0$。设 $\\lambda = k^2$，其中 $k$ 为某个大于0的实数。ODE 变为：\n$$\nu''(x) + k^2 u(x) = 0\n$$\n这是一个标准的二阶线性齐次常系数常微分方程。其通解为：\n$$\nu(x) = A \\cos(kx) + B \\sin(kx)\n$$\n其中 $A$ 和 $B$ 是积分常数。现在我们应用边界条件来确定这些常数，并找出 $k$ 的允许值。\n\n首先，应用条件 $u(0) = 0$：\n$$\nu(0) = A \\cos(k \\cdot 0) + B \\sin(k \\cdot 0) = A \\cdot 1 + B \\cdot 0 = A\n$$\n因此，我们必须有 $A=0$。解从而被限制为以下形式：\n$$\nu(x) = B \\sin(kx)\n$$\n接着，应用第二个条件 $u(L) = 0$：\n$$\nu(L) = B \\sin(kL) = 0\n$$\n对于非平凡解，我们必须有 $B \\neq 0$。这意味着正弦项必须为零：\n$$\n\\sin(kL) = 0\n$$\n如果参数 $kL$ 是 $\\pi$ 的整数倍，则此条件成立。即，\n$$\nkL = n\\pi \\quad \\text{其中 } n \\text{ 为某个整数}\n$$\n如果 $n=0$，则 $k=0$，这得到 $\\lambda=0$ 和 $u(x)=0$，即平凡解。如果 $n$ 是一个负整数，比如说 $n = -m$ ($m>0$)，那么 $k_n L = -m\\pi$，这得到 $u(x) = B \\sin(-\\frac{m\\pi x}{L}) = -B \\sin(\\frac{m\\pi x}{L})$。这只是对应于正整数 $m$ 的特征函数的标量倍，并且它产生相同的特征值 $\\lambda = (-\\frac{m\\pi}{L})^2 = (\\frac{m\\pi}{L})^2$。因此，为了获得一组唯一的特征值和对应的线性无关的特征函数，我们可以将 $n$ 限制为正整数，$n \\in \\{1, 2, 3, \\dots\\}$。\n\n从这个量子化条件，我们找到 $k$ 的允许值，记为 $k_n$：\n$$\nk_n = \\frac{n\\pi}{L} \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\n相应的特征值 $\\lambda_n$ 是：\n$$\n\\lambda_n = k_n^2 = \\left(\\frac{n\\pi}{L}\\right)^2 = \\frac{n^2\\pi^2}{L^2} \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\n这些是在区间 $(0, L)$ 上狄利克雷拉普拉斯算子的离散特征值。\n\n现在，我们确定特征值计数函数 $N(\\lambda)$，它被定义为小于或等于给定阈值 $\\lambda > 0$ 的特征值的数量。\n$$\nN(\\lambda) = \\#\\{\\lambda_n \\mid \\lambda_n \\le \\lambda\\}\n$$\n代入 $\\lambda_n$ 的表达式，我们需要计算满足以下不等式的正整数 $n$ 的数量：\n$$\n\\frac{n^2\\pi^2}{L^2} \\le \\lambda\n$$\n我们可以重新整理这个不等式来解出 $n$：\n$$\nn^2 \\le \\frac{\\lambda L^2}{\\pi^2}\n$$\n由于 $n$ 必须为正，我们对两边取正平方根：\n$$\nn \\le \\sqrt{\\frac{\\lambda L^2}{\\pi^2}} = \\frac{L\\sqrt{\\lambda}}{\\pi}\n$$\n函数 $N(\\lambda)$ 统计满足此条件的正整数 $n$ 的个数。这个数字恰好是小于或等于 $\\frac{L\\sqrt{\\lambda}}{\\pi}$ 的最大整数。这由向下取整函数给出。因此，特征值计数函数的精确闭式表达式为：\n$$\nN(\\lambda) = \\left\\lfloor \\frac{L\\sqrt{\\lambda}}{\\pi} \\right\\rfloor\n$$\n\n最后，我们需要推导当 $\\lambda \\to \\infty$ 时，渐近关系式 $N(\\lambda) \\sim C\\,\\lambda^{1/2}$ 中的首项系数 $C$。向下取整函数 $\\lfloor x \\rfloor$ 满足不等式 $x-1  \\lfloor x \\rfloor \\le x$。将此性质应用于我们的 $N(\\lambda)$ 表达式：\n$$\n\\frac{L\\sqrt{\\lambda}}{\\pi} - 1  N(\\lambda) \\le \\frac{L\\sqrt{\\lambda}}{\\pi}\n$$\n为了找到渐近行为，我们考虑当 $\\lambda \\to \\infty$ 时比值 $\\frac{N(\\lambda)}{\\lambda^{1/2}}$ 的极限。将不等式两边除以 $\\lambda^{1/2}$ 得到：\n$$\n\\frac{L}{\\pi} - \\frac{1}{\\sqrt{\\lambda}}  \\frac{N(\\lambda)}{\\sqrt{\\lambda}} \\le \\frac{L}{\\pi}\n$$\n在 $\\lambda \\to \\infty$ 的极限下，项 $\\frac{1}{\\sqrt{\\lambda}}$ 趋于 $0$。根据夹逼定理，我们有：\n$$\n\\lim_{\\lambda\\to\\infty} \\frac{N(\\lambda)}{\\sqrt{\\lambda}} = \\frac{L}{\\pi}\n$$\n这意味着对于大的 $\\lambda$，$N(\\lambda)$ 渐近等价于 $\\frac{L}{\\pi}\\sqrt{\\lambda}$。\n$$\nN(\\lambda) \\sim \\frac{L}{\\pi} \\lambda^{1/2}\n$$\n将此与给定的形式 $N(\\lambda) \\sim C\\,\\lambda^{1/2}$ 进行比较，我们确定常数 $C$ 为：\n$$\nC = \\frac{L}{\\pi}\n$$\n这个结果与 $d$ 维区域 $\\Omega$ 上 Weyl 定律的一般形式 $N(\\lambda) \\sim \\frac{\\omega_d \\mathrm{vol}(\\Omega)}{(2\\pi)^d} \\lambda^{d/2}$ 一致。对于我们的一维情况，$d=1$，$\\mathrm{vol}(\\Omega)=L$，单位球的体积为 $\\omega_1=2$。该公式得出 $N(\\lambda) \\sim \\frac{2L}{2\\pi} \\lambda^{1/2} = \\frac{L}{\\pi} \\lambda^{1/2}$，这证实了我们推导出的常数 $C$。\n\n最终结果是计数函数 $N(\\lambda)$ 的精确表达式和渐近常数 $C$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\left\\lfloor \\frac{L\\sqrt{\\lambda}}{\\pi} \\right\\rfloor  \\frac{L}{\\pi} \\end{pmatrix}}\n$$", "id": "3078749"}, {"introduction": "在理解了最基本的情形后，一个自然的问题是：边界的性质如何影响谱的渐近行为？这项练习通过比较同一区间上狄利克雷（固定边界）和诺伊曼（自由边界）两种不同边界条件下的特征值分布，来深入探讨这个问题。你将发现，韦尔定律的主项（与区域“体积”相关）在两种情况下保持不变，而边界条件的影响体现在了计数函数的次阶项上，揭示了谱几何中“体积”与“边界”贡献的深刻区别。[@problem_id:3078770]", "problem": "设 $I=[0,L]$ 且 $L0$，考虑一维拉普拉斯算子 $-\\frac{d^{2}}{dx^{2}}$ 在区间 $I$ 上，分别带有狄利克雷边界条件 $u(0)=u(L)=0$ 或诺伊曼边界条件 $u^{\\prime}(0)=u^{\\prime}(L)=0$。对于每种边界条件，定义特征值计数函数 $N(\\Lambda)$ 为小于或等于给定阈值 $\\Lambda \\ge 0$ 的特征值数量（计入重数）。从常微分方程 $-u^{\\prime\\prime}=\\lambda u$ 和给定的边界条件出发，确定这两个边值问题的显式特征值，并以闭合形式表示相关的计数函数 $N_{D}(\\Lambda)$ 和 $N_{N}(\\Lambda)$。然后计算以下两个极限：\n- 共同的首项外尔极限 $c:=\\lim_{\\Lambda\\to\\infty}\\frac{N_{D}(\\Lambda)}{\\sqrt{\\Lambda}}=\\lim_{\\Lambda\\to\\infty}\\frac{N_{N}(\\Lambda)}{\\sqrt{\\Lambda}}$。\n- 常数位移 $d:=\\lim_{\\Lambda\\to\\infty}\\big(N_{N}(\\Lambda)-N_{D}(\\Lambda)\\big)$。\n\n将您的最终结果表示为行矩阵 $\\big(c\\ d\\big)$。无需进行数值近似；请提供精确的解析表达式。", "solution": "该问题是适定的、有科学依据的，并包含了唯一解所需的所有信息。我们首先求解在区间 $I=[0,L]$ 上，针对两组不同边界条件的一维拉普拉斯算子的特征值问题。\n\n控制常微分方程为 $-u^{\\prime\\prime}(x)=\\lambda u(x)$，即 $u^{\\prime\\prime}(x)+\\lambda u(x)=0$。通解的形式取决于特征值 $\\lambda$ 的符号。\n\n情况1：$\\lambda  0$。设 $\\lambda = k^2$，其中 $k0$。方程变为 $u^{\\prime\\prime}(x)+k^{2}u(x)=0$，其通解为 $u(x) = A\\cos(kx) + B\\sin(kx)$。\n\n情况2：$\\lambda = 0$。方程变为 $u^{\\prime\\prime}(x)=0$，其通解为 $u(x) = Ax+B$。\n\n情况3：$\\lambda  0$。设 $\\lambda = -k^2$，其中 $k0$。方程变为 $u^{\\prime\\prime}(x)-k^{2}u(x)=0$，其通解为 $u(x) = A\\cosh(kx) + B\\sinh(kx)$。\n\n现在我们应用边界条件来求解每种情况下的具体特征值。\n\n**第1部分：狄利克雷边界条件**\n\n狄利克雷边界条件为 $u(0)=0$ 和 $u(L)=0$。\n\n-   对于 $\\lambda  0$，$u(x) = A\\cos(kx) + B\\sin(kx)$。应用 $u(0)=0$ 得到 $A\\cos(0) + B\\sin(0) = A = 0$。解简化为 $u(x) = B\\sin(kx)$。应用 $u(L)=0$ 得到 $B\\sin(kL)=0$。为得到非平凡解，我们要求 $B\\neq0$，这意味着 $\\sin(kL)=0$。如果 $kL = n\\pi$（其中 $n$ 为任意非零整数），则此条件成立。因为 $k0$ 和 $L0$，我们取 $n$ 为正整数，$n \\in \\{1, 2, 3, \\dots\\}$。因此，$k_n = \\frac{n\\pi}{L}$。对应的特征值为 $\\lambda_{n,D} = k_n^2 = \\left(\\frac{n\\pi}{L}\\right)^2$，其中 $n=1, 2, 3, \\dots$。\n\n-   对于 $\\lambda = 0$，$u(x) = Ax+B$。应用 $u(0)=0$ 得到 $B=0$。应用 $u(L)=0$ 得到 $AL=0$。因为 $L0$，我们必有 $A=0$。这只产生平凡解 $u(x)=0$，所以 $\\lambda=0$ 不是狄利克雷特征值。\n\n-   对于 $\\lambda  0$，$u(x) = A\\cosh(kx) + B\\sinh(kx)$。应用 $u(0)=0$ 得到 $A=0$。解变为 $u(x) = B\\sinh(kx)$。应用 $u(L)=0$ 得到 $B\\sinh(kL)=0$。因为 $k0$ 和 $L0$，所以 $\\sinh(kL)0$，我们必有 $B=0$。这同样只产生平凡解。不存在负的狄利克雷特征值。\n\n狄利克雷特征值的集合是 $\\{\\lambda_{n,D} = (\\frac{n\\pi}{L})^2 \\mid n=1, 2, 3, \\dots\\}$。特征值计数函数 $N_D(\\Lambda)$ 是小于或等于 $\\Lambda$ 的特征值的数量。\n$$\n\\left(\\frac{n\\pi}{L}\\right)^2 \\le \\Lambda \\implies n^2 \\le \\frac{\\Lambda L^2}{\\pi^2} \\implies n \\le \\frac{L\\sqrt{\\Lambda}}{\\pi}\n$$\n因为 $n$ 必须是正整数，所以满足条件的 $n$ 的数量由其上界的底函数给出。\n$$\nN_D(\\Lambda) = \\left\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\right\\rfloor\n$$\n\n**第2部分：诺伊曼边界条件**\n\n诺伊曼边界条件为 $u^{\\prime}(0)=0$ 和 $u^{\\prime}(L)=0$。我们首先求通解的导数。\n-   对于 $\\lambda  0$，$u^{\\prime}(x) = k(-A\\sin(kx) + B\\cos(kx))$。\n-   对于 $\\lambda = 0$，$u^{\\prime}(x) = A$。\n-   对于 $\\lambda  0$，$u^{\\prime}(x) = k(A\\sinh(kx) + B\\cosh(kx))$。\n\n-   对于 $\\lambda  0$，应用 $u^{\\prime}(0)=0$ 得到 $k(-A\\sin(0) + B\\cos(0)) = kB = 0$。因为 $k0$，这意味着 $B=0$。解简化为 $u(x) = A\\cos(kx)$，其导数为 $u^{\\prime}(x) = -kA\\sin(kx)$。应用 $u^{\\prime}(L)=0$ 得到 $-kA\\sin(kL)=0$。为得到非平凡解，$A\\neq0$，所以我们要求 $\\sin(kL)=0$。同前，这意味着 $kL = n\\pi$，其中 $n \\in \\{1, 2, 3, \\dots\\}$，从而得到正特征值 $\\lambda_{n,N} = k_n^2 = \\left(\\frac{n\\pi}{L}\\right)^2$，其中 $n=1, 2, 3, \\dots$。\n\n-   对于 $\\lambda = 0$，应用 $u^{\\prime}(0)=0$ 得到 $A=0$。条件 $u^{\\prime}(L)=0$ 也是 $A=0$。这些条件不约束 $B$。因此，对于任意 $B \\neq 0$，$u(x)=B$（一个常数）是一个非平凡的特征函数。因此，$\\lambda_{0,N}=0$ 是一个诺伊曼特征值。\n\n-   对于 $\\lambda  0$，应用 $u^{\\prime}(0)=0$ 得到 $k(A\\sinh(0) + B\\cosh(0)) = kB = 0$，所以 $B=0$。解变为 $u(x) = A\\cosh(kx)$，其导数为 $u^{\\prime}(x) = kA\\sinh(kx)$。应用 $u^{\\prime}(L)=0$ 得到 $kA\\sinh(kL)=0$。因为 $k0$ 和 $L0$，所以 $\\sinh(kL)0$，我们必有 $A=0$。这只产生平凡解。不存在负的诺伊曼特征值。\n\n诺伊曼特征值的集合包含零特征值，因此是 $\\{\\lambda_{n,N} = (\\frac{n\\pi}{L})^2 \\mid n=0, 1, 2, \\dots\\}$。特征值计数函数 $N_N(\\Lambda)$ 是：\n$$\n\\left(\\frac{n\\pi}{L}\\right)^2 \\le \\Lambda \\implies n \\le \\frac{L\\sqrt{\\Lambda}}{\\pi}\n$$\n由于 $n$ 是一个非负整数 ($n=0, 1, 2, \\dots$)，满足条件的 $n$ 的数量是集合 $\\{0, 1, \\dots, \\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\rfloor\\}$ 中整数的个数。这个数量是 $\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\rfloor + 1$。\n$$\nN_N(\\Lambda) = \\left\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\right\\rfloor + 1\n$$\n\n**第3部分：极限计算**\n\n我们现在计算所需的两个极限。\n\n首先，是共同的首项外尔极限 $c$。令 $X(\\Lambda) = \\frac{L\\sqrt{\\Lambda}}{\\pi}$。我们使用底函数的性质：$x-1  \\lfloor x \\rfloor \\le x$。因此，对于 $X(\\Lambda) > 0$：\n$$\n\\frac{X(\\Lambda)-1}{\\sqrt{\\Lambda}}  \\frac{N_D(\\Lambda)}{\\sqrt{\\Lambda}} = \\frac{\\lfloor X(\\Lambda) \\rfloor}{\\sqrt{\\Lambda}} \\le \\frac{X(\\Lambda)}{\\sqrt{\\Lambda}}\n$$\n代入 $X(\\Lambda)$：\n$$\n\\frac{\\frac{L\\sqrt{\\Lambda}}{\\pi}-1}{\\sqrt{\\Lambda}}  \\frac{N_D(\\Lambda)}{\\sqrt{\\Lambda}} \\le \\frac{\\frac{L\\sqrt{\\Lambda}}{\\pi}}{\\sqrt{\\Lambda}}\n$$\n$$\n\\frac{L}{\\pi} - \\frac{1}{\\sqrt{\\Lambda}}  \\frac{N_D(\\Lambda)}{\\sqrt{\\Lambda}} \\le \\frac{L}{\\pi}\n$$\n当 $\\Lambda \\to \\infty$ 时，$\\frac{1}{\\sqrt{\\Lambda}} \\to 0$。根据夹逼定理，$\\lim_{\\Lambda\\to\\infty} \\frac{N_D(\\Lambda)}{\\sqrt{\\Lambda}} = \\frac{L}{\\pi}$。\n\n对于诺伊曼情况：\n$$\n\\lim_{\\Lambda\\to\\infty} \\frac{N_N(\\Lambda)}{\\sqrt{\\Lambda}} = \\lim_{\\Lambda\\to\\infty} \\frac{\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\rfloor + 1}{\\sqrt{\\Lambda}} = \\lim_{\\Lambda\\to\\infty} \\left( \\frac{\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\rfloor}{\\sqrt{\\Lambda}} + \\frac{1}{\\sqrt{\\Lambda}} \\right) = \\frac{L}{\\pi} + 0 = \\frac{L}{\\pi}\n$$\n因此，共同的极限是 $c = \\frac{L}{\\pi}$。\n\n其次，是常数位移 $d$。\n$$\nd = \\lim_{\\Lambda\\to\\infty} \\left(N_N(\\Lambda) - N_D(\\Lambda)\\right)\n$$\n使用推导出的闭合形式表达式：\n$$\nN_N(\\Lambda) - N_D(\\Lambda) = \\left(\\left\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\right\\rfloor + 1\\right) - \\left\\lfloor \\frac{L\\sqrt{\\Lambda}}{\\pi} \\right\\rfloor = 1\n$$\n对于所有 $\\Lambda \\ge 0$，该差值为常数 1。因此，极限也是 1。\n$$\nd = \\lim_{\\Lambda\\to\\infty} 1 = 1\n$$\n\n最终结果为行矩阵 $(c \\ d)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{L}{\\pi}  1\n\\end{pmatrix}\n}\n$$", "id": "3078770"}, {"introduction": "分析推导在低维和简单几何形状中非常有效，但对于更复杂的现实世界问题，我们往往需要借助计算方法。这项练习将引导你从一维的精确解走向二维的数值探索。你将通过实现有限差分法来近似计算平面区域（如圆形和椭圆形）上的拉普拉斯算子特征值，并将数值结果与包含边界长度修正的二维韦尔定律（双项展开）进行比较。这个实践不仅能验证理论的准确性，还能让你体验理论数学与计算科学是如何相辅相成的。[@problem_id:3078791]", "problem": "考虑一个光滑有界平面区域 $\\Omega \\subset \\mathbb{R}^2$，其边界充分正则。设 $-\\Delta$ 是定义在 $\\Omega$ 上的 Dirichlet 拉普拉斯算子。谱计数函数 $N(\\lambda)$ 定义为 $-\\Delta$ 的 Dirichlet 特征值（计入重数）中小于或等于给定阈值 $\\lambda  0$ 的数量。您的任务是基于 $\\Omega$ 的几何量，推导、实现并测试一个关于 $N(\\lambda)$ 的两项渐近公式，并将其与通过有限差分法离散化得到的数值特征值计数进行比较。\n\n从基本原理出发，您必须：\n- 使用相空间体积启发式方法，得到依赖于面积 $|\\Omega|$ 的 $N(\\lambda)$ 的主项。\n- 通过在 $\\partial \\Omega$ 附近的局部分析来论证边界修正项，以获得依赖于边界长度 $|\\partial \\Omega|$ 和边界条件类型的次阶项。\n- 结合这些结果，用 $|\\Omega|$ 和 $|\\partial \\Omega|$ 来表述 $N(\\lambda)$ 的两项渐近预测。\n\n然后，实现一个数值计算过程：\n- 在一个覆盖该区域的均匀矩形网格上，使用五点有限差分格式对带有 Dirichlet 边界条件的 $-\\Delta$ 进行离散化。对于网格上的一个点 $(x,y)$，如果它位于 $\\Omega$ 内部，则将其包含在离散区域中；否则，通过将该节点从系统中排除来施加 Dirichlet 条件 $u=0$。对于在 $x$ 和 $y$ 方向上间距分别为 $h_x$ 和 $h_y$ 的网格，内部节点处的离散算子具有对角系数 $2/h_x^2 + 2/h_y^2$，以及到水平相邻节点和垂直相邻节点的非对角系数分别为 $-1/h_x^2$ 和 $-1/h_y^2$，这仅当这些相邻节点也为内部节点时成立。\n- 计算这个稀疏对称正定矩阵（代表 $-\\Delta$）的合理数量的最小特征值，并通过对小于或等于 $\\lambda$ 的离散特征值进行计数来近似 $N(\\lambda)$。\n- 对于每个测试用例，使用 $\\Omega$ 的面积和边界长度计算两项渐近预测，并将其与数值计数进行比较。\n\n待测试的区域：\n- 半径为 $R$ 的圆：$\\Omega = \\{(x,y): x^2 + y^2 \\le R^2\\}$。使用 $R = 1$。\n- 半轴为 $a$ 和 $b$ 的椭圆：$\\Omega = \\{(x,y): (x/a)^2 + (y/b)^2 \\le 1\\}$。使用 $a = 1.2$, $b = 0.8$。\n\n几何量：\n- 圆的面积：$|\\Omega| = \\pi R^2$；边界长度：$|\\partial \\Omega| = 2\\pi R$。\n- 椭圆的面积：$|\\Omega| = \\pi a b$；边界长度：使用 Ramanujan 的近似公式 $|\\partial \\Omega| \\approx \\pi \\left(3(a+b) - \\sqrt{(3a+b)(a+3b)}\\right)$。\n\n网格规格：\n- 使用一个 $49 \\times 49$ 大小的均匀网格，该网格覆盖包含每个区域的最小轴对齐矩形。对于圆，使用 $[-R,R] \\times [-R,R]$；对于椭圆，使用 $[-a,a] \\times [-b,b]$。\n\n测试套件：\n- 对于半径 $R=1$ 的圆：阈值 $\\lambda = 6$、$\\lambda = 30$、$\\lambda = 60$。\n- 对于半轴 $a=1.2, b=0.8$ 的椭圆：阈值 $\\lambda = 10$、$\\lambda = 30$、$\\lambda = 60$。\n\n对于每个测试用例，计算：\n- 通过对有限差分矩阵的离散特征值进行计数（$\\le \\lambda$），得到数值计数 $N_{\\mathrm{num}}(\\lambda)$。\n- 用 $|\\Omega|$、$|\\partial \\Omega|$ 和 $\\lambda$ 表示的两项渐近预测 $N_{\\mathrm{asymp}}(\\lambda)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是对应于上述确切顺序的测试用例的绝对差 $|N_{\\mathrm{num}}(\\lambda) - N_{\\mathrm{asymp}}(\\lambda)|$。这些条目必须是浮点数。例如，输出格式为 $[r_1,r_2,r_3,r_4,r_5,r_6]$。\n\n不涉及物理单位；如果在您的实现中内部出现角度，则以弧度为单位。最终答案必须是浮点数。", "solution": "该问题要求对平面区域 $\\Omega$ 上 Dirichlet 拉普拉斯算子的谱计数函数 $N(\\lambda)$ 的两项渐近公式进行推导和数值验证。\n\n### 1. 理论基础：$N(\\lambda)$ 的两项渐近公式\n\n区域 $\\Omega$ 上算子 $-\\Delta$ 的谱计数函数 $N(\\lambda)$ 定义为满足 $0  \\lambda_j \\le \\lambda$ 的特征值 $\\lambda_j$（计入重数）的数量。Weyl 定律为当 $\\lambda \\to \\infty$ 时 $N(\\lambda)$ 提供了一个渐近展开。\n\n#### 1.1. 主项：面积贡献\n\nWeyl 定律的主项可以通过半经典相空间论证推导得出。特征值问题 $-\\Delta u = \\lambda u$ 类似于限制在 $\\Omega$ 内的自由粒子的定态薛定谔方程。这样一个粒子的状态由其位置 $\\mathbf{x} \\in \\Omega$ 和动量矢量 $\\mathbf{k} \\in \\mathbb{R}^2$ 描述。相应的能量是 $E = |\\mathbf{k}|^2$。\n\n在量子理论中，每个不同的量子态在 $d$ 维相空间中占据一个体积 $(2\\pi)^d$。对于一个二维区域（$d=2$），这个体积是 $(2\\pi)^2$。能量不超过阈值 $\\lambda$ 的总状态数 $N(\\lambda)$ 近似等于相空间中的总可及体积除以单个状态的体积。可及相空间由满足能量条件 $|\\mathbf{k}|^2 \\le \\lambda$ 的位置 $\\mathbf{x} \\in \\Omega$ 和动量 $\\mathbf{k}$ 定义。\n\n因此，状态数可由以下积分近似：\n$$ N(\\lambda) \\approx \\frac{1}{(2\\pi)^2} \\iint_{\\Omega} d\\mathbf{x} \\iint_{|\\mathbf{k}|^2 \\le \\lambda} d\\mathbf{k} $$\n\n对位置坐标 $\\mathbf{x}$ 的积分得出区域的面积 $|\\Omega|$。对动量坐标 $\\mathbf{k}$ 的积分是动量平面中半径为 $\\sqrt{\\lambda}$ 的圆盘的面积，其值为 $\\pi (\\sqrt{\\lambda})^2 = \\pi\\lambda$。\n\n结合这些结果，得到 Weyl 定律的主项：\n$$ N(\\lambda) \\sim \\frac{|\\Omega| (\\pi\\lambda)}{(2\\pi)^2} = \\frac{|\\Omega|}{4\\pi} \\lambda $$\n这一项与 $\\Omega$ 的面积成正比，在 $\\lambda$ 很大时占主导地位，并代表了对态密度的体贡献，忽略了边界效应。\n\n#### 1.2. 次项：边界修正\n\n$\\partial\\Omega$ 上的边界条件改变了特征函数在边界附近的行为，这进而影响了态密度。这产生了一个与边界几何形状相关的修正项。\n\n对于 Dirichlet 边界条件（$u|_{\\partial\\Omega}=0$），特征函数被约束为零。这种约束比在自由空间（或环面上）中更具限制性，导致波函数的相对“挤压”。这导致它们的能量增加，以及低于给定能级 $\\lambda$ 的状态数出现相应的亏损。这个亏损与边界长度 $|\\partial\\Omega|$ 成正比。\n\n更严格的分析，例如使用热核或波迹方法，证实了这种启发式观点，并提供了第二项的精确形式。对于光滑有界区域 $\\Omega \\subset \\mathbb{R}^2$，Dirichlet 问题的两项渐近展开式为：\n$$ N(\\lambda) = \\frac{|\\Omega|}{4\\pi} \\lambda - \\frac{|\\partial\\Omega|}{4\\pi} \\sqrt{\\lambda} + o(\\sqrt{\\lambda}) \\quad \\text{as } \\lambda \\to \\infty $$\n第二项的负号反映了由 Dirichlet 条件引起的状态亏损。相反地，对于 Neumann 边界条件，此符号将为正。\n\n基于此推导，我们将使用的两项渐近预测为：\n$$ N_{\\mathrm{asymp}}(\\lambda) = \\frac{|\\Omega|}{4\\pi} \\lambda - \\frac{|\\partial\\Omega|}{4\\pi} \\sqrt{\\lambda} $$\n\n### 2. 数值实现策略\n\n我们将通过比较 $N_{\\mathrm{asymp}}(\\lambda)$ 与从拉普拉斯算子的有限差分离散化中获得的数值计数 $N_{\\mathrm{num}}(\\lambda)$ 来验证该公式。\n\n#### 2.1. 有限差分离散化\n连续特征值问题 $-\\Delta u = \\lambda u$ 被近似为一个矩阵特征值问题 $\\mathbf{A}\\mathbf{v} = \\lambda \\mathbf{v}$。在具有间距 $h_x$ 和 $h_y$ 的均匀网格上使用中心差分格式，内部网格点 $(x_i, y_j)$ 处的算子 $-\\Delta$ 可近似为：\n$$ (-\\Delta u)|_{(x_i,y_j)} \\approx -\\left( \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2} \\right) $$\n令其等于 $\\lambda u_{i,j}$ 并重新整理，得到对应于节点 $(i,j)$ 的离散方程：\n$$ \\left(\\frac{2}{h_x^2} + \\frac{2}{h_y^2}\\right) u_{i,j} - \\frac{1}{h_x^2} (u_{i+1,j} + u_{i-1,j}) - \\frac{1}{h_y^2} (u_{i,j+1} + u_{i,j-1}) = \\lambda u_{i,j} $$\n\n#### 2.2. 矩阵构建与特征值计算\n1.  **网格与节点识别**：在 $\\Omega$ 的最小包围盒上定义一个 $N_x \\times N_y$（$49 \\times 49$）的网格。严格位于 $\\Omega$ 内部的网格点被识别为“内部”节点，并成为我们系统中的自由度。假设有 $M$ 个这样的节点。\n2.  **矩阵组装**：构建一个代表离散算子的 $M \\times M$ 矩阵 $\\mathbf{A}$。建立一个从内部节点的二维坐标到一维矩阵索引 $k \\in \\{0, \\dots, M-1\\}$ 的映射。\n    - 节点 $k$ 的对角元是 $\\mathbf{A}_{k,k} = 2/h_x^2 + 2/h_y^2$。\n    - 一个非对角元 $\\mathbf{A}_{k,k'}$，其中 $k'$ 是 $k$ 的一个邻居，对于水平邻居设置为 $-1/h_x^2$，对于垂直邻居设置为 $-1/h_y^2$。\n    - 如果一个内部节点的邻居不是内部节点，Dirichlet 条件 $u=0$ 意味着其贡献为零。这通过仅为内部节点之间的连接创建矩阵项来自然地处理。\n3.  **特征系统求解**：得到的矩阵 $\\mathbf{A}$ 是实对称正定的。它的特征值，即 $-\\Delta$ 真实特征值的近似，使用 `scipy.linalg.eigh` 计算。\n4.  **计数**：数值计数 $N_{\\mathrm{num}}(\\lambda)$ 是计算出的不大于阈值 $\\lambda$ 的特征值的数量。\n\n#### 2.3. 测试用例\n将此过程应用于指定的区域：\n-   **圆**：$R=1$。包围盒 $[-1,1] \\times [-1,1]$。网格间距 $h_x = h_y = 2/(49-1) = 1/24$。$|\\Omega|=\\pi$，$|\\partial\\Omega|=2\\pi$。\n    - $N_{\\mathrm{asymp}}(\\lambda) = \\frac{\\pi}{4\\pi}\\lambda - \\frac{2\\pi}{4\\pi}\\sqrt{\\lambda} = \\frac{\\lambda}{4} - \\frac{\\sqrt{\\lambda}}{2}$。\n-   **椭圆**：$a=1.2, b=0.8$。包围盒 $[-1.2,1.2] \\times [-0.8,0.8]$。网格间距 $h_x=2.4/48=0.05$，$h_y=1.6/48=1/30$。$|\\Omega|=\\pi(1.2)(0.8)=0.96\\pi$。周长 $|\\partial\\Omega|$ 使用 Ramanujan 的近似公式计算：$|\\partial\\Omega| \\approx \\pi (3(a+b) - \\sqrt{(3a+b)(a+3b)})$。\n    - $N_{\\mathrm{asymp}}(\\lambda) = \\frac{0.96\\pi}{4\\pi}\\lambda - \\frac{|\\partial\\Omega|}{4\\pi}\\sqrt{\\lambda} = 0.24\\lambda - \\frac{|\\partial\\Omega|}{4\\pi}\\sqrt{\\lambda}$。\n\n对于每个测试用例 $(\\Omega, \\lambda)$，计算并报告绝对差 $|N_{\\mathrm{num}}(\\lambda) - N_{\\mathrm{asymp}}(\\lambda)|$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Derives, implements, and tests a two-term asymptotic formula for the\n    spectral counting function N(lambda) of the Dirichlet Laplacian on\n    planar domains, comparing it with numerical results from a finite\n    difference method.\n    \"\"\"\n    \n    # Test suite defines the domains and lambda thresholds.\n    test_suite = [\n        {'domain': 'circle', 'R': 1.0, 'lambdas': [6.0, 30.0, 60.0]},\n        {'domain': 'ellipse', 'a': 1.2, 'b': 0.8, 'lambdas': [10.0, 30.0, 60.0]}\n    ]\n\n    all_results = []\n\n    # Process each domain configuration and its associated tests.\n    for config in test_suite:\n        domain_type = config['domain']\n        lambdas = config['lambdas']\n        \n        # --- 1. Grid and Domain Setup ---\n        N = 49\n        \n        if domain_type == 'circle':\n            R = config['R']\n            x_range, y_range = [-R, R], [-R, R]\n            \n            # Function to check if a point is strictly inside the domain.\n            def is_inside(x, y):\n                return x**2 + y**2  R**2\n            \n            # Geometric properties for the asymptotic formula.\n            area = np.pi * R**2\n            perimeter = 2.0 * np.pi * R\n\n        elif domain_type == 'ellipse':\n            a, b = config['a'], config['b']\n            x_range, y_range = [-a, a], [-b, b]\n\n            # Function to check if a point is strictly inside the domain.\n            def is_inside(x, y):\n                return (x / a)**2 + (y / b)**2  1.0\n\n            # Geometric properties for the asymptotic formula.\n            area = np.pi * a * b\n            # Ramanujan’s approximation for the perimeter of an ellipse.\n            perimeter = np.pi * (3.0 * (a + b) - np.sqrt((3.0 * a + b) * (a + 3.0 * b)))\n\n        h_x = (x_range[1] - x_range[0]) / (N - 1)\n        h_y = (y_range[1] - y_range[0]) / (N - 1)\n        \n        x_coords = np.linspace(x_range[0], x_range[1], N)\n        y_coords = np.linspace(y_range[0], y_range[1], N)\n\n        # --- 2. Identify Interior Points and Build Mappings ---\n        interior_points = []  # Stores (i, j) grid indices of interior points.\n        grid_to_matrix_map = {}  # Maps (i, j) to a 1D matrix index k.\n        \n        # Dirichlet condition: u=0 on boundary. We select points strictly inside.\n        for j in range(N):\n            for i in range(N):\n                if is_inside(x_coords[i], y_coords[j]):\n                    k = len(interior_points)\n                    interior_points.append((i, j))\n                    grid_to_matrix_map[(i, j)] = k\n                    \n        M = len(interior_points)\n        if M == 0:\n            for l_val in lambdas:\n                N_asymp_zero = (area / (4.0 * np.pi)) * l_val - (perimeter / (4.0 * np.pi)) * np.sqrt(l_val)\n                all_results.append(abs(0 - N_asymp_zero))\n            continue\n            \n        # --- 3. Construct the Finite Difference Matrix A ---\n        A = np.zeros((M, M), dtype=np.float64)\n        \n        h_x2_inv = 1.0 / h_x**2\n        h_y2_inv = 1.0 / h_y**2\n        \n        for k, (i, j) in enumerate(interior_points):\n            # Diagonal element from the 5-point stencil for -Laplacian.\n            A[k, k] = 2.0 * h_x2_inv + 2.0 * h_y2_inv\n            \n            # Off-diagonal elements for neighbors that are also interior points.\n            neighbors = [(i + 1, j), (i - 1, j), (i, j + 1), (i, j - 1)]\n            h_inv_sq_vals = [h_x2_inv, h_x2_inv, h_y2_inv, h_y2_inv]\n            \n            for neighbor_idx, h_inv_sq in zip(neighbors, h_inv_sq_vals):\n                if neighbor_idx in grid_to_matrix_map:\n                    k_neighbor = grid_to_matrix_map[neighbor_idx]\n                    A[k, k_neighbor] = -h_inv_sq\n\n        # --- 4. Compute Eigenvalues of the Discrete Operator ---\n        # eigh is for symmetric matrices and returns sorted eigenvalues.\n        eigenvalues = eigh(A, eigvals_only=True)\n        \n        # --- 5. Calculate and Compare Numerical vs. Asymptotic Counts ---\n        for lambda_val in lambdas:\n            # Numerical count: number of discrete eigenvalues = lambda_val.\n            N_num = np.sum(eigenvalues = lambda_val)\n            \n            # Asymptotic prediction from the two-term Weyl's Law.\n            # N(λ) = (Area/4π)λ - (Perimeter/4π)√λ\n            term1 = (area / (4.0 * np.pi)) * lambda_val\n            term2 = (perimeter / (4.0 * np.pi)) * np.sqrt(lambda_val)\n            N_asymp = term1 - term2\n            \n            # Store the absolute difference for the final output.\n            all_results.append(abs(N_num - N_asymp))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3078791"}]}