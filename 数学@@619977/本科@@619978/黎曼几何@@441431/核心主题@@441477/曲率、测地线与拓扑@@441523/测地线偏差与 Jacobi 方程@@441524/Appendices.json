{"hands_on_practices": [{"introduction": "雅可比场描述了测地线族中相邻测地线之间的无穷小分离。理解雅可比场的一个直观方法是将其视为由空间的对称性（等距变换）生成的测地线变分场。这项练习 [@problem_id:3047806] 将在单位球面 $S^2$ 这一我们熟悉的空间上，通过旋转这种等距变换来具体构造雅可比场，从而将抽象的定义与几何直观联系起来，并验证它们确实满足雅可比方程。", "problem": "设 $S^{2} \\subset \\mathbb{R}^{3}$ 为单位球面 $S^2$，其上的圆度量由欧几里得内积诱导。考虑单位速率大圆（赤道）\n$$\n\\gamma(t) = (\\cos t,\\ \\sin t,\\ 0), \\quad t \\in \\mathbb{R},\n$$\n因此 $t$ 是弧长（等效地，以弧度为单位的角度参数）。沿 $\\gamma$ 的一个雅可比场定义为 $\\gamma$ 的一个由测地线构成的光滑变分 $\\alpha(s,t)$ 的变分向量场 $J(t) = \\frac{\\partial}{\\partial s}\\big|_{s=0}\\alpha(s,t)$，它满足测地偏离（雅可比）方程\n$$\n\\frac{D^{2}J}{dt^{2}} + R(J,\\dot{\\gamma})\\dot{\\gamma} = 0,\n$$\n其中 $R$ 是 $S^{2}$ 的黎曼曲率张量，$\\frac{D}{dt}$ 是沿 $\\gamma$ 的 Levi-Civita 协变导数。\n\n仅使用以下基本事实：\n- 等距同构将测地线映射到测地线，\n- 由单参数等距同构族得到的变分产生雅可比场，\n- 单位球面 $S^{2}$ 具有常截面曲率 $K = 1$，等价地，对于切向量 $X, Y, Z$ 有 $R(X,Y)Z = g(Y,Z)X - g(X,Z)Y$，\n\n完成以下任务：\n\n1. 显式构造沿 $\\gamma$ 的雅可比场 $J_{\\perp}(t)$，该场由绕大圆所在平面的正交轴（即 $z$ 轴）的单参数旋转群产生。将 $J_{\\perp}(t)$ 表示为 $\\mathbb{R}^{3}$ 中沿 $\\gamma$ 的向量场。\n\n2. 显式构造沿 $\\gamma$ 的雅可比场 $J_{\\parallel}(t)$，该场由绕大圆所在平面内的一条轴（例如 $x$ 轴）的单参数旋转群产生。将 $J_{\\parallel}(t)$ 表示为 $\\mathbb{R}^{3}$ 中沿 $\\gamma$ 的向量场。\n\n3. 使用给定的曲率公式，直接验证这两个场都满足沿 $\\gamma$ 的雅可比方程。\n\n将你的最终答案表示为一个包含两个条目的单行矩阵，顺序如下：首先是由绕正交轴旋转产生的 $J_{\\perp}(t)$，然后是由绕平面内轴旋转产生的 $J_{\\parallel}(t)$。无需四舍五入。角度以弧度为单位。", "solution": "该问题是有效的，因为它具有科学依据、问题设定良好，且所有术语和条件在黎曼几何中都是标准的。我们将通过构造雅可比场然后验证它们满足雅可比方程来求解。\n\n沿测地线 $\\gamma(t)$ 的雅可比场 $J(t)$ 可由单参数等距同构族 $\\phi_s$ 生成。$\\gamma$ 的相应变分由 $\\alpha(s,t) = \\phi_s(\\gamma(t))$ 给出。由于等距同构将测地线映射到测地线，对于固定的 $s$，每条曲线 $\\alpha(s, \\cdot)$ 都是一条测地线。雅可比场是变分向量场 $J(t) = \\frac{\\partial \\alpha}{\\partial s} \\Big|_{s=0}$。\n\n给定的测地线是单位球面 $S^2$ 的赤道，由弧长 $t$ 参数化：\n$$\n\\gamma(t) = (\\cos t, \\sin t, 0)\n$$\n切向量场为 $\\dot{\\gamma}(t) = \\frac{d\\gamma}{dt} = (-\\sin t, \\cos t, 0)$，其单位长度为 $|\\dot{\\gamma}(t)| = \\sqrt{(-\\sin t)^2 + (\\cos t)^2} = 1$。\n\n**1. 雅可比场 $J_{\\perp}(t)$ 的构造**\n\n这个雅可比场由绕 $z$ 轴的单参数旋转群产生，该轴垂直于大圆 $\\gamma(t)$ 所在的平面。绕 $z$ 轴旋转角度 $s$ 由以下矩阵给出：\n$$\nR_z(s) = \\begin{pmatrix} \\cos s  -\\sin s  0 \\\\ \\sin s  \\cos s  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n这是 $S^2$ 的一个单参数等距同构群 $\\phi_s(\\mathbf{x}) = R_z(s)\\mathbf{x}$。$\\gamma(t)$ 的变分是 $\\alpha(s,t) = \\phi_s(\\gamma(t)) = R_z(s)\\gamma(t)$。\n$$\n\\alpha(s,t) = \\begin{pmatrix} \\cos s  -\\sin s  0 \\\\ \\sin s  \\cos s  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\cos t \\\\ \\sin t \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\cos s \\cos t - \\sin s \\sin t \\\\ \\sin s \\cos t + \\cos s \\sin t \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\cos(s+t) \\\\ \\sin(s+t) \\\\ 0 \\end{pmatrix}\n$$\n雅可比场是关于 $s$ 在 $s=0$ 处的导数：\n$$\nJ_{\\perp}(t) = \\frac{\\partial \\alpha}{\\partial s} \\Big|_{s=0} = \\frac{\\partial}{\\partial s} \\begin{pmatrix} \\cos(s+t) \\\\ \\sin(s+t) \\\\ 0 \\end{pmatrix} \\Biggr|_{s=0} = \\begin{pmatrix} -\\sin(s+t) \\\\ \\cos(s+t) \\\\ 0 \\end{pmatrix} \\Biggr|_{s=0} = \\begin{pmatrix} -\\sin t \\\\ \\cos t \\\\ 0 \\end{pmatrix}\n$$\n因此，$J_{\\perp}(t) = (-\\sin t, \\cos t, 0)$。我们观察到 $J_{\\perp}(t) = \\dot{\\gamma}(t)$。\n\n**2. 雅可比场 $J_{\\parallel}(t)$ 的构造**\n\n这个雅可比场由绕大圆平面内的轴的旋转产生，我们选择 $x$ 轴。绕 $x$ 轴旋转角度 $s$ 由以下矩阵给出：\n$$\nR_x(s) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos s  -\\sin s \\\\ 0  \\sin s  \\cos s \\end{pmatrix}\n$$\n这是 $S^2$ 的一个单参数等距同构群 $\\phi_s(\\mathbf{x}) = R_x(s)\\mathbf{x}$。变分是 $\\alpha(s,t) = R_x(s)\\gamma(t)$：\n$$\n\\alpha(s,t) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos s  -\\sin s \\\\ 0  \\sin s  \\cos s \\end{pmatrix} \\begin{pmatrix} \\cos t \\\\ \\sin t \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\cos t \\\\ \\sin t \\cos s \\\\ \\sin t \\sin s \\end{pmatrix}\n$$\n雅可比场是关于 $s$ 在 $s=0$ 处的导数：\n$$\nJ_{\\parallel}(t) = \\frac{\\partial \\alpha}{\\partial s} \\Big|_{s=0} = \\frac{\\partial}{\\partial s} \\begin{pmatrix} \\cos t \\\\ \\sin t \\cos s \\\\ \\sin t \\sin s \\end{pmatrix} \\Biggr|_{s=0} = \\begin{pmatrix} 0 \\\\ -\\sin t \\sin s \\\\ \\sin t \\cos s \\end{pmatrix} \\Biggr|_{s=0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\sin t \\end{pmatrix}\n$$\n因此，$J_{\\parallel}(t) = (0, 0, \\sin t)$。\n\n**3. 雅可比方程的验证**\n\n雅可比方程是 $\\frac{D^{2}J}{dt^{2}} + R(J,\\dot{\\gamma})\\dot{\\gamma} = 0$。具有常截面曲率 $K=1$ 的 $S^2$ 的黎曼张量是 $R(X,Y)Z = g(Y,Z)X - g(X,Z)Y$。度量 $g$ 是 $\\mathbb{R}^3$ 上的标准点积。沿 $S^2$ 中曲线 $c(t)$ 的向量场 $V(t)$ 的协变导数 $\\frac{DV}{dt}$ 是其在 $\\mathbb{R}^3$ 中普通导数的切向分量，即 $\\frac{DV}{dt} = \\frac{dV}{dt} - (\\frac{dV}{dt} \\cdot c(t))c(t)$，因为 $c(t)$ 是球面在 $c(t)$ 点的单位法向量。\n\n**对 $J_{\\perp}(t)$ 的验证**\n我们有 $J_{\\perp}(t) = (-\\sin t, \\cos t, 0) = \\dot{\\gamma}(t)$。雅可比方程变为：\n$$\n\\frac{D^{2}\\dot{\\gamma}}{dt^{2}} + R(\\dot{\\gamma},\\dot{\\gamma})\\dot{\\gamma} = 0\n$$\n- 第一项：根据定义，测地线满足 $\\frac{D\\dot{\\gamma}}{dt} = 0$。零向量场的协变导数为零，所以 $\\frac{D^{2}\\dot{\\gamma}}{dt^{2}} = \\frac{D}{dt}(0) = 0$。\n- 第二项：黎曼张量在其前两个参数上是反对稱的，所以对任意向量场 $X,Y$ 都有 $R(X,X)Y=0$。因此，$R(\\dot{\\gamma},\\dot{\\gamma})\\dot{\\gamma} = 0$。\n方程变为 $0 + 0 = 0$，成立。\n\n**对 $J_{\\parallel}(t)$ 的验证**\n我们有 $J(t) = J_{\\parallel}(t) = (0, 0, \\sin t)$。我们需要计算雅可比方程中的两项。\n\n首先，我们计算 $\\frac{D^{2}J}{dt^{2}}$。\n在 $\\mathbb{R}^3$ 中的一阶导数是 $\\frac{dJ}{dt} = (0, 0, \\cos t)$。\n一阶协变导数是 $\\frac{DJ}{dt} = \\frac{dJ}{dt} - (\\frac{dJ}{dt} \\cdot \\gamma(t))\\gamma(t)$。\n点积为 $\\frac{dJ}{dt} \\cdot \\gamma(t) = (0, 0, \\cos t) \\cdot (\\cos t, \\sin t, 0) = 0$。\n所以，$\\frac{DJ}{dt} = \\frac{dJ}{dt} = (0, 0, \\cos t)$。我们称此向量场为 $V(t)$。\n\n二阶协变导数是 $\\frac{D^{2}J}{dt^{2}} = \\frac{DV}{dt} = \\frac{dV}{dt} - (\\frac{dV}{dt} \\cdot \\gamma(t))\\gamma(t)$。\n$V(t)$ 在 $\\mathbb{R}^3$ 中的导数是 $\\frac{dV}{dt} = \\frac{d}{dt}(0,0,\\cos t) = (0, 0, -\\sin t)$。\n点积为 $\\frac{dV}{dt} \\cdot \\gamma(t) = (0, 0, -\\sin t) \\cdot (\\cos t, \\sin t, 0) = 0$。\n所以，$\\frac{D^{2}J}{dt^{2}} = \\frac{dV}{dt} = (0, 0, -\\sin t)$。这恰好是 $-J(t)$。因此，$\\frac{D^{2}J_{\\parallel}}{dt^{2}} = -J_{\\parallel}(t)$。\n\n接下来，我们计算曲率项 $R(J_{\\parallel},\\dot{\\gamma})\\dot{\\gamma}$。使用给定的公式：\n$$\nR(J_{\\parallel},\\dot{\\gamma})\\dot{\\gamma} = g(\\dot{\\gamma}, \\dot{\\gamma})J_{\\parallel} - g(J_{\\parallel}, \\dot{\\gamma})\\dot{\\gamma}\n$$\n我们计算内积：\n- $g(\\dot{\\gamma}, \\dot{\\gamma}) = \\dot{\\gamma} \\cdot \\dot{\\gamma} = (-\\sin t, \\cos t, 0) \\cdot (-\\sin t, \\cos t, 0) = \\sin^2 t + \\cos^2 t = 1$。\n- $g(J_{\\parallel}, \\dot{\\gamma}) = J_{\\parallel} \\cdot \\dot{\\gamma} = (0, 0, \\sin t) \\cdot (-\\sin t, \\cos t, 0) = 0$。\n\n将这些代入曲率项表达式：\n$$\nR(J_{\\parallel},\\dot{\\gamma})\\dot{\\gamma} = (1) J_{\\parallel} - (0) \\dot{\\gamma} = J_{\\parallel}(t)\n$$\n最后，我们将我们的发现代入雅可比方程：\n$$\n\\frac{D^{2}J_{\\parallel}}{dt^{2}} + R(J_{\\parallel},\\dot{\\gamma})\\dot{\\gamma} = -J_{\\parallel}(t) + J_{\\parallel}(t) = 0\n$$\n方程成立。两个场都验证为雅可比场。", "answer": "$$\n\\boxed{\\begin{pmatrix} (-\\sin t, \\cos t, 0)  (0, 0, \\sin t) \\end{pmatrix}}\n$$", "id": "3047806"}, {"introduction": "雅可比场的一个核心应用是探测共轭点，即初始发散的测地线重新汇聚的点。这项练习 [@problem_id:3047824] 深入探讨了这一概念，通过求解球面上的雅可比方程来确定沿着一条测地线的共轭点的位置。理解共轭点是分析测地线何时不再是两点间最短路径的关键，并引出了莫尔斯指标 (Morse index) 这一用于研究测地线稳定性的重要工具。", "problem": "设 $S^{2}$ 是单位球面 $S^2$，其上赋有常截面曲率为 $1$ 的标准圆形黎曼度量。设 $\\gamma:[0,L]\\to S^{2}$ 是一条单位速率测地线，满足 $\\gamma(0)=p$ 和 $\\gamma(L)=q$，其中球面距离满足 $d(p,q)=L$。考虑与 $\\gamma$ 相关联的指数形式，该指数形式作用于沿 $\\gamma$ 且在端点处为零的法变分场 $J$ 的空间上。将 $\\gamma$ 的莫尔斯指数 $i(L)$（相对于固定端点）定义为指数形式在其上为负定的子空间的最大维数。零度 $n(L)$ 是该指数形式的核的维数。\n\n从雅可比场的定义（即涉及黎曼曲率张量的测地线偏差方程的解）和单位球面具有常截面曲率 $1$ 这一事实出发，确定测地线长度为 $L=\\pi$ 时的莫尔斯指数 $i(\\pi)$ 和零度 $n(\\pi)$，以及当 $\\pi  L  2\\pi$ 时测地线的莫尔斯指数 $i(L)$。", "solution": "该问题要求确定在单位球面 $S^{2}$ 上，一条测地线在两个不同长度区间上的莫尔斯指数以及在一个特定长度上的零度。单位球面是一个常截面曲率为 $K=1$ 的黎曼流形。莫尔斯指数和零度由沿测地线的共轭点的位置和重数决定。\n\n如果存在一个沿测地线 $\\gamma$ 的非零雅可比场 $J(t)$，它在两个端点处都为零（即 $J(0)=0$ 和 $J(L)=0$），那么点 $\\gamma(L)$ 就与 $\\gamma(0)$ 沿 $\\gamma$ 共轭。雅可比场是测地线偏差方程的解：\n$$\n\\nabla_{\\dot{\\gamma}} \\nabla_{\\dot{\\gamma}} J + R(J, \\dot{\\gamma})\\dot{\\gamma} = 0\n$$\n其中 $J$ 是垂直于测地线 $\\gamma$ 的向量场，$\\dot{\\gamma}$ 是 $\\gamma$ 的单位切向量，$\\nabla_{\\dot{\\gamma}}$ 是沿 $\\gamma$ 的协变导数，$R$ 是黎曼曲率张量。\n\n对于一个常截面曲率为 $K$ 的流形，曲率张量由 $R(X,Y)Z = K(\\langle Y,Z \\rangle X - \\langle X,Z \\rangle Y)$ 给出。由于 $J$ 垂直于 $\\dot{\\gamma}$，我们有 $\\langle J, \\dot{\\gamma} \\rangle = 0$。由于 $\\gamma$ 是一条单位速率测地线，$\\langle \\dot{\\gamma}, \\dot{\\gamma} \\rangle = 1$。曲率项简化为：\n$$\nR(J, \\dot{\\gamma})\\dot{\\gamma} = K(\\langle \\dot{\\gamma},\\dot{\\gamma} \\rangle J - \\langle J,\\dot{\\gamma} \\rangle \\dot{\\gamma}) = K(1 \\cdot J - 0 \\cdot \\dot{\\gamma}) = K J\n$$\n问题说明，对于 $S^{2}$，截面曲率为 $K=1$。因此，雅可比方程变为：\n$$\n\\nabla_{\\dot{\\gamma}} \\nabla_{\\dot{\\gamma}} J + J = 0\n$$\n为求解此向量微分方程，我们引入一个沿 $\\gamma$ 的法丛的平行标准正交标架。在 $n$ 维流形上，一条曲线的法丛维数为 $n-1$。对于球面 $S^{2}$，$n=2$，所以法丛是1维的。设 $E(t)$ 是沿 $\\gamma$ 的一个平行单位法向量场。任何法向量场 $J(t)$ 都可以写成 $J(t) = f(t)E(t)$ 的形式，其中 $f(t)$ 是某个标量函数。由于 $E(t)$是平行的，所以 $\\nabla_{\\dot{\\gamma}} E(t) = 0$。$J(t)$ 的协变导数为：\n$$\n\\nabla_{\\dot{\\gamma}} J = f'(t)E(t)\n$$\n$$\n\\nabla_{\\dot{\\gamma}} \\nabla_{\\dot{\\gamma}} J = f''(t)E(t)\n$$\n将此代入雅可比方程得到 $f''(t)E(t) + f(t)E(t) = 0$，简化为标量常微分方程：\n$$\nf''(t) + f(t) = 0\n$$\n$f(t)$ 的通解为 $f(t) = A \\cos(t) + B \\sin(t)$，其中 $A$ 和 $B$ 是实常数。因此，沿 $\\gamma$ 的一般法雅可比场为 $J(t) = (A \\cos(t) + B \\sin(t))E(t)$。\n\n为了找到与 $\\gamma(0)$ 共轭的点，我们寻找非零雅可比场 $J(t)$，使得对于某个 $L>0$ 有 $J(0)=0$ 和 $J(L)=0$。\n条件 $J(0)=0$ 意味着 $f(0)=0$。\n$$\nf(0) = A \\cos(0) + B \\sin(0) = A = 0\n$$\n所以，任何在 $t=0$ 处为零的雅可比场都必须是 $J(t) = B \\sin(t) E(t)$ 的形式。为使该场非零，我们必须有 $B \\neq 0$。\n第二个条件是 $J(L)=0$，即 $f(L)=0$。\n$$\nB \\sin(L) = 0\n$$\n因为 $B \\neq 0$，我们必须有 $\\sin(L)=0$。对于 $L>0$ 的解是 $L = k\\pi$，其中 $k$ 是任意正整数，即 $L \\in \\{\\pi, 2\\pi, 3\\pi, \\dots\\}$。这些是对应于沿 $\\gamma$ 的 $\\gamma(0)$ 的共轭点的参数值。\n\n共轭点 $\\gamma(L)$ 的重数是在 $t=0$ 和 $t=L$ 处为零的雅可比场的空间的维数。对于位于 $L=k\\pi$ 的共轭点，条件 $\\sin(k\\pi)=0$ 自动满足。因此，在 $t=0$ 和 $t=k\\pi$ 处为零的雅可比场的空间是 $\\{B \\sin(t) E(t) \\mid B \\in \\mathbb{R}\\}$。这是一个由场 $\\sin(t)E(t)$ 张成的1维空间。因此，$S^2$ 上的每个共轭点都有重数 $1$。\n\n莫尔斯指数 $i(L)$ 是在开区间 $(0,L)$ 内与 $\\gamma(0)$ 共轭的点数（按重数计数）。零度 $n(L)$ 是 $L$ 作为一个共轭点的重数。\n\n现在我们可以确定所需的值。\n\n1.  **当 $0  L  \\pi$ 时**: 在此区间内没有 $k\\pi$ 形式的数，因此在 $(0,L)$ 中没有共轭点。所以莫尔斯指数 $i(L)=0$。由于 $L$ 不是 $\\pi$ 的倍数，$L$ 本身不是共轭点，所以零度 $n(L)=0$。\n2.  **当 $L=\\pi$ 时**:\n    - 莫尔斯指数 $i(\\pi)$ 是在开区间 $(0,\\pi)$ 内的共轭点数。此区间内没有 $k\\pi$ 形式的数。所以 $i(\\pi)=0$。\n    - 零度 $n(\\pi)$ 是 $L=\\pi$ 作为一个共轭点的重数。由于 $L=\\pi$ 是 $k\\pi$ 的形式（$k=1$），它是一个共轭点。我们已确定其重数为1。所以 $n(\\pi)=1$。\n3.  **当 $\\pi  L  2\\pi$ 时**:\n    - 莫尔斯指数 $i(L)$ 是在开区间 $(0,L)$ 内的共轭点数。因为 $\\pi \\in (0,L)$，所以有一个共轭点 $t=\\pi$。其重数为1。因此，$i(L)=1$。\n    - 由于 $L$ 不是 $\\pi$ 的倍数，$L$ 本身不是共轭点，所以零度 $n(L)=0$。\n\n根据问题的要求，我们需要提供 $i(\\pi)$、$n(\\pi)$ 和 $i(L)$ for $\\pi  L  2\\pi$。这些值分别是 $0$、$1$ 和 $1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  1\n\\end{pmatrix}\n}\n$$", "id": "3047824"}, {"introduction": "曲率如何决定测地线的行为——汇聚、发散或保持平行？这项综合性练习 [@problem_id:3047795] 通过计算来回答这个问题。您将推导并数值求解适用于不同常曲率空间（球面、平面、双曲面）的标量雅可比方程 $y''(t) + K y(t) = 0$。通过观察解的行为，您可以直观地验证正曲率使测地线汇聚、负曲率使其发散、零曲率下其线性分离这一黎曼几何中的基本原理。", "problem": "给定三个黎曼曲面度量和一族测地线。您的任务是推导、建立并数值积分描述沿每条测地线的平行正交标架中测地偏离的相应标量二阶常微分方程（ODE）。然后，您必须分析标量函数 $y(t)$ 的零点间距，该函数编码了沿测地线的雅可比场的法向分量。您的最终程序必须针对指定的测试套件生成所要求的分析，并以文末描述的精确格式输出结果。\n\n起点和基本依据：\n- 从黎曼度量 $g$、Levi-Civita 联络 $\\nabla$、满足 $\\nabla_{\\dot{\\gamma}} \\dot{\\gamma} = 0$ 的测地线 $\\gamma(t)$ 以及沿 $\\gamma(t)$ 由测地线方程线性化定义的雅可比场 $J(t)$ 的定义开始。雅可比场方程将 $J(t)$ 沿 $\\gamma(t)$ 的二阶协变导数与作用在 $J(t)$ 和切向量 $\\dot{\\gamma}(t)$ 上的曲率联系起来。\n- 在二维情况下，沿 $\\gamma(t)$ 使用一个平行正交标架 $\\{T(t), E(t)\\}$，其中 $T(t)$ 是单位切向量 $T(t) = \\dot{\\gamma}(t)$，$E(t)$ 是沿 $\\gamma(t)$ 满足 $\\nabla_{T} E = 0$ 的单位法向量场。将一个法雅可比场分解为 $J(t) = y(t) E(t)$。根据沿测地线采样的高斯曲率，推导系数函数 $y(t)$ 的标量二阶常微分方程。\n- 您必须建立 $y(t)$ 的初值问题，初始条件为 $y(0) = 0$ 和 $y'(0) = 1$，并在给定的区间 $t \\in [0, t_{\\max}]$ 上对其进行数值积分。将 $t$ 视为弧长，因此所有报告的距离都是无量纲数。\n\n测试套件的曲面和度量：\n- 情况 $1$（正常数曲率）：半径为 $R = 2$ 的标准球面 $S^2$ 及其标准度量。考虑一条单位速率的大圆测地线（例如赤道）。沿该测地线采样的高斯曲率是空间常数，其值为 $K = \\frac{1}{R^{2}}$。\n- 情况 $2$（零曲率）：欧几里得平面 $\\mathbb{R}^{2}$ 及其标准度量。考虑一条单位速率的直线测地线。沿该测地线采样的高斯曲率是空间常数，其值为 $K = 0$。\n- 情况 $3$（负常数曲率）：Poincaré 半平面模型中的双曲平面，其度量为 $\\mathrm{d}s^{2} = \\frac{\\mathrm{d}x^{2} + \\mathrm{d}y^{2}}{y^{2}}$。考虑一条单位速率的垂直测地线。沿该测地线采样的高斯曲率是空间常数，其值为 $K = -1$。\n\n数值任务：\n- 对于每种情况，利用沿测地线采样的高斯曲率，建立由给定测地线上平行标架中的测地偏离所蕴含的 $y(t)$ 的标量常微分方程。在初始条件 $y(0)=0, y'(0)=1$ 下，从 $t=0$ 到 $t = t_{\\max} = 20$ 进行数值积分。\n- 在开区间 $(0, t_{\\max}]$ 内检测 $y(t)$ 的零点，并计算连续零点之间的间距。如果在 $(0, t_{\\max}]$ 内少于两个零点，则间距列表为空。\n\n测试套件：\n- 使用以下参数集，每个参数集由其常数高斯曲率值和积分上限指定：\n    - 情况 $1$：$K = \\frac{1}{4}$，$t_{\\max} = 20$。\n    - 情况 $2$：$K = 0$，$t_{\\max} = 20$。\n    - 情况 $3$：$K = -1$，$t_{\\max} = 20$。\n\n答案规格和输出格式：\n- 对于每种情况，输出在 $(0, t_{\\max}]$ 内 $y(t)$ 的连续零点之间的间距列表，该列表为浮点数列表。所有距离都是无量綱的。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个条目对应一个测试用例，其本身也是一个浮点数间距的列表。例如，最终输出必须形如 $[\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$，逗号后没有空格。具体来说，您的程序必须打印类似 $[[s_{1,1},s_{1,2},\\dots],[\\ ],[\\ ]]$ 的内容，其中 $s_{i,j}$ 表示第 $i$ 种情况的第 $j$ 个间距，对于少于两个零点的情况，则打印空列表。", "solution": "分析始于雅可比方程，该方程描述了雅可比场 $J(t)$ 沿测地线 $\\gamma(t)$ 的演化。雅可比场衡量了邻近测地线之间的无穷小分离。设 $T(t) = \\dot{\\gamma}(t)$ 为测地线的单位切向量，其中 $t$ 是弧长参数。雅可比方程为：\n$$ \\nabla_{T} \\nabla_{T} J + R(J, T) T = 0 $$\n此处，$\\nabla_{T}$ 是沿测地线的协变导数，$R$ 是黎曼曲率张量。\n\n在二维黎曼流形（一个曲面）上，我们可以简化此方程。我们关心的是测地线如何在其法向方向上发生偏离。我们沿 $\\gamma(t)$ 构建一个平行正交标架 $\\{T(t), E(t)\\}$。其中，$T(t)$ 是单位切向量，$E(t)$ 是与 $T(t)$ 正交的单位向量场（即 $g(T, E) = 0, g(E, E) = 1$）。该标架是平行移动的，这意味着 $\\nabla_T T = 0$（测地线方程）以及 $\\nabla_T E = 0$。\n\n一个雅可比场 $J(t)$可以分解为切向和法向分量。代表垂直于行进方向偏离的法雅可比场可写为：\n$$ J(t) = y(t) E(t) $$\n其中 $y(t)$ 是一个表示偏离大小的标量函数。\n\n现在我们将此形式的 $J(t)$ 代入雅可比方程。我们使用协变微分的莱布尼茨法则计算 $J(t)$ 的协变导数：\n$$ \\nabla_T J = \\nabla_T (y(t) E(t)) = (\\nabla_T y) E + y (\\nabla_T E) $$\n由于 $y(t)$ 是一个标量函数，其协变导数就是它关于 $t$ 的普通导数，即 $\\nabla_T y = \\frac{dy}{dt} = y'(t)$。根据我们标架的构造，$\\nabla_T E = 0$。因此，一阶导数为：\n$$ \\nabla_T J = y'(t) E(t) $$\n取二阶协变导数：\n$$ \\nabla_T \\nabla_T J = \\nabla_T (y'(t) E(t)) = (\\nabla_T y') E + y' (\\nabla_T E) = y''(t) E(t) $$\n\n接下来，我们分析曲率项 $R(J, T) T$。对于二维流形，黎曼张量在一个正交基 $\\{X, Y\\}$ 上的作用由 $R(X, Y)Y = K X$ 给出，其中 $K$ 是高斯曲率。\n在我们的例子中，正交基是 $\\{T, E\\}$，所以 $R(T, E)E = K T$。利用黎曼张量的对称性，有 $R(E, T)T = -R(T, E)T$。二维曲面上黎曼张量的一个更直接的公式是 $R(X, Y)Z = K(g(Y, Z)X - g(X, Z)Y)$。\n将 $J(t) = y(t)E(t)$ 代入曲率项：\n$$ R(J, T) T = R(y(t)E(t), T(t)) T(t) = y(t) R(E, T) T $$\n使用通用公式，令 $X=E, Y=T, Z=T$：\n$$ R(E, T) T = K(g(T, T)E - g(E, T)T) $$\n因为 $\\{T, E\\}$ 是一个正交标架，所以 $g(T, T)=1$ 且 $g(E, T)=0$。这可以简化为：\n$$ R(E, T)T = K(1 \\cdot E - 0 \\cdot T) = K E $$\n因此，曲率项变为：\n$$ R(J, T) T = y(t) K(\\gamma(t)) E(t) $$\n其中 $K(\\gamma(t))$ 是在点 $\\gamma(t)$ 处的高斯曲率。\n\n将二阶导数和曲率项代回雅可比方程：\n$$ y''(t) E(t) + y(t) K(\\gamma(t)) E(t) = 0 $$\n$$ (y''(t) + K(\\gamma(t)) y(t)) E(t) = 0 $$\n由于 $E(t)$ 是非零向量，其系数必须为零。这就得到了描述测地偏离的标量二阶常微分方程：\n$$ y''(t) + K(\\gamma(t)) y(t) = 0 $$\n\n**具体问题和数值方法**\n\n该问题指定了三种沿测地线高斯曲率 $K$ 为常数的情况。该常微分方程简化为一个常系数线性齐次常微分方程。我们必须求解以下初值问题（IVP）：\n$$ y''(t) + K y(t) = 0, \\quad y(0) = 0, \\quad y'(0) = 1 $$\n\n解的行为取决于 $K$ 的符号：\n1.  **情况1：正常数曲率 ($K > 0$)**：设 $K = \\omega^2$。方程为 $y'' + \\omega^2 y = 0$。解为 $y(t) = \\frac{1}{\\omega}\\sin(\\omega t)$。该解是振荡的，在 $t = n\\pi/\\omega$ (其中 $n$ 为整数) 处穿过零点。这些零点被称为共轭点，物理上代表测地线族重新聚焦的点。连续零点之间的间距是常数 $\\Delta t = \\pi/\\omega$。对于 $K = 1/4$，$\\omega = 1/2$，因此间距为 $2\\pi$。\n\n2.  **情况2：零曲率 ($K = 0$)**：方程为 $y'' = 0$。解为 $y(t) = t$。唯一的零点在 $t=0$ 处。测地线线性发散，这是欧几里得空间的一个熟知属性。\n\n3.  **情况3：负曲率 ($K  0$)**：设 $K = -\\alpha^2$。方程为 $y'' - \\alpha^2 y = 0$。解为 $y(t) = \\frac{1}{\\alpha}\\sinh(\\alpha t)$。唯一的零点在 $t=0$ 处。测地线指数级发散，这是双曲几何的特征。\n\n为了进行数值求解，我们将这个二阶常微分方程转换为一个由两个一阶常微分方程组成的系统。设状态向量为 $\\vec{z}(t) = [z_1(t), z_2(t)]^T = [y(t), y'(t)]^T$。该系统为：\n$$ \\frac{d\\vec{z}}{dt} = \\begin{pmatrix} z_2 \\\\ -K z_1 \\end{pmatrix} $$\n初始条件为 $\\vec{z}(0) = [0, 1]^T$。\n\n该初值问题使用数值积分器求解，具体是在 Python 中使用 `scipy.integrate.solve_ivp`。我们对给定的三个 $K$ 值：$1/4$、$0$ 和 $-1$，分别从 $t=0$ 积分到 $t=t_{\\max}=20$。\n\n为了在区间 $(0, t_{\\max}]$ 内找到 $y(t)$ 的零点，我们使用 `solve_ivp` 的事件检测功能。一个事件函数被提供给求解器，它仅返回 $y(t)$ 的值（即 $z_1(t)$）。求解器随后在积分过程中找到此函数的所有根。对根时间的列表进行后处理，以排除初始点 $t=0$，并计算连续正根之间的差值。如果找到的正根少于两个，则根据问题规范，间距列表为空。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the geodesic deviation equation for three cases of constant curvature,\n    finds the zeros of the deviation function y(t), and calculates the\n    spacings between them.\n    \"\"\"\n    # Test suite parameters: (Gaussian Curvature K, integration horizon t_max)\n    test_cases = [\n        (0.25, 20.0),  # Case 1: Sphere, K = 1/4\n        (0.0, 20.0),   # Case 2: Euclidean Plane, K = 0\n        (-1.0, 20.0)   # Case 3: Hyperbolic Plane, K = -1\n    ]\n\n    all_results = []\n\n    def ode_system(t, z, K):\n        \"\"\"\n        Defines the system of first-order ODEs equivalent to y'' + K*y = 0.\n        The state vector is z = [y, y'].\n        So, z' = [y', y''] = [z[1], -K*z[0]].\n        \"\"\"\n        return [z[1], -K * z[0]]\n\n    def find_zeros(t, z, K):\n        \"\"\"\n        Event function to detect zeros of y(t). The event occurs when z[0] = y = 0.\n        \"\"\"\n        return z[0]\n    \n    # Make the event non-terminal to find all zeros in the interval.\n    find_zeros.terminal = False\n\n    for K, t_max in test_cases:\n        # Initial conditions: y(0) = 0, y'(0) = 1\n        z0 = [0.0, 1.0]\n        t_span = [0.0, t_max]\n\n        # Use a numerical ODE solver with event detection.\n        # High precision is requested for accurate root finding.\n        sol = solve_ivp(\n            ode_system,\n            t_span,\n            z0,\n            args=(K,),\n            events=find_zeros,\n            dense_output=True,\n            rtol=1e-12,\n            atol=1e-12\n        )\n\n        # The solver returns a list of event times (zeros of y).\n        # We expect only one event type, so we access sol.t_events[0].\n        zero_times = sol.t_events[0]\n\n        # The problem asks for zeros in the open interval (0, t_max].\n        # We filter out the initial point t=0, allowing for small numerical noise.\n        # The threshold 1e-9 is safe given the integration tolerances.\n        significant_zeros = zero_times[zero_times > 1e-9]\n\n        # Calculate spacings between consecutive zeros if at least two are found.\n        spacings = []\n        if len(significant_zeros) >= 2:\n            spacings = np.diff(significant_zeros).tolist()\n        \n        all_results.append(spacings)\n\n    # Format the final output string according to the problem specification.\n    # The format must be a list of lists, e.g., [[s1,s2,...],[],[]]\n    # with no spaces after commas.\n    result_strings = []\n    for R in all_results:\n        # Format each float in the list to a standard string representation\n        # and join them with a comma.\n        formatted_list = ','.join(map(str, R))\n        result_strings.append(f\"[{formatted_list}]\")\n    \n    # Join the list strings with commas and enclose in the outer brackets.\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3047795"}]}