{"hands_on_practices": [{"introduction": "拉格朗日乘数法是解决受约束优化问题的强大工具，其应用远超理论范畴。本练习将通过一个直观的几何问题——在单位球体内嵌入一个体积最大的长方体，来展示如何运用此方法。通过求解这个问题 [@problem_id:1649732]，你将亲身体验如何将一个具体的设计或工程挑战转化为数学模型，并找到其最优解。", "problem": "在工程与设计中，一个常见的问题是如何最大化一个必须置于给定边界内的物体的可用空间。考虑一个内接于单位球体的长方体（盒子），该单位球体由方程 $x^2 + y^2 + z^2 = 1$ 定义。该长方体的八个顶点必须全部位于该球体的表面上。\n\n你的任务是确定这样一个长方体的最大可能体积。请将你的答案表示为一个单一、简化的解析表达式。", "solution": "设长方体的中心位于向量 $\\mathbf{r}_{0}$，其半边长分别为 $a$, $b$, $c > 0$，分别沿着一组标准正交方向 $\\mathbf{u}$, $\\mathbf{v}$, $\\mathbf{w}$。那么其八个顶点为\n$$\n\\mathbf{r}_{0} + s_{1} a \\mathbf{u} + s_{2} b \\mathbf{v} + s_{3} c \\mathbf{w}, \\quad s_{1},s_{2},s_{3} \\in \\{ -1, 1\\}.\n$$\n所有八个顶点都位于以原点为中心的单位球面上的条件是\n$$\n\\left\\| \\mathbf{r}_{0} + s_{1} a \\mathbf{u} + s_{2} b \\mathbf{v} + s_{3} c \\mathbf{w} \\right\\|^{2} = 1 \\quad \\text{for all } s_{1},s_{2},s_{3} \\in \\{ -1, 1\\}.\n$$\n定义 $\\mathbf{S}(s_{1},s_{2},s_{3}) = s_{1} a \\mathbf{u} + s_{2} b \\mathbf{v} + s_{3} c \\mathbf{w}$。那么对于任意固定的 $(s_{1},s_{2},s_{3})$，我们同时有\n$$\n\\|\\mathbf{r}_{0} + \\mathbf{S}\\|^{2} = \\mathbf{r}_{0}\\cdot \\mathbf{r}_{0} + \\mathbf{S}\\cdot \\mathbf{S} + 2 \\mathbf{r}_{0}\\cdot \\mathbf{S} = 1,\n$$\n和\n$$\n\\|\\mathbf{r}_{0} - \\mathbf{S}\\|^{2} = \\mathbf{r}_{0}\\cdot \\mathbf{r}_{0} + \\mathbf{S}\\cdot \\mathbf{S} - 2 \\mathbf{r}_{0}\\cdot \\mathbf{S} = 1.\n$$\n将这两个等式相减得到 $4\\,\\mathbf{r}_{0}\\cdot \\mathbf{S} = 0$，因此对于所有符号选择都有 $\\mathbf{r}_{0}\\cdot \\mathbf{S} = 0$。利用标准正交性，\n$$\n\\mathbf{r}_{0}\\cdot \\mathbf{S} = a(\\mathbf{r}_{0}\\cdot \\mathbf{u}) s_{1} + b(\\mathbf{r}_{0}\\cdot \\mathbf{v}) s_{2} + c(\\mathbf{r}_{0}\\cdot \\mathbf{w}) s_{3}.\n$$\n由于这个关于 $s_{1},s_{2},s_{3}$ 的线性形式对于所有符号组合都为零，且 $a,b,c>0$，可得 $\\mathbf{r}_{0}\\cdot \\mathbf{u} = \\mathbf{r}_{0}\\cdot \\mathbf{v} = \\mathbf{r}_{0}\\cdot \\mathbf{w} = 0$。因为 $\\mathbf{u},\\mathbf{v},\\mathbf{w}$ 张成整个空间，我们得出结论 $\\mathbf{r}_{0} = \\mathbf{0}$。因此该长方体以原点为中心。\n\n当 $\\mathbf{r}_{0} = \\mathbf{0}$ 时，任意顶点的范数平方为\n$$\n\\|\\mathbf{S}\\|^{2} = a^{2}\\|\\mathbf{u}\\|^{2} + b^{2}\\|\\mathbf{v}\\|^{2} + c^{2}\\|\\mathbf{w}\\|^{2} + 2ab\\, s_{1}s_{2}(\\mathbf{u}\\cdot \\mathbf{v}) + 2ac\\, s_{1}s_{3}(\\mathbf{u}\\cdot \\mathbf{w}) + 2bc\\, s_{2}s_{3}(\\mathbf{v}\\cdot \\mathbf{w}).\n$$\n由于 $\\mathbf{u},\\mathbf{v},\\mathbf{w}$ 是标准正交的，所有交叉项都为零，且 $\\|\\mathbf{S}\\|^{2} = a^{2} + b^{2} + c^{2}$。因此，每个顶点都位于单位球面上的条件简化为\n$$\na^{2} + b^{2} + c^{2} = 1.\n$$\n长方体的体积为\n$$\nV = (2a)(2b)(2c) = 8abc.\n$$\n我们必须在约束条件 $a^{2} + b^{2} + c^{2} = 1$ 和 $a,b,c>0$ 下最大化 $V = 8abc$。使用拉格朗日乘数法，在约束条件 $g(a,b,c) = a^{2} + b^{2} + c^{2} - 1 = 0$ 下最大化 $f(a,b,c) = abc$。令 $\\nabla f = \\lambda \\nabla g$，可得\n$$\nbc = 2\\lambda a,\\quad ac = 2\\lambda b,\\quad ab = 2\\lambda c.\n$$\n将前两个方程相除可得 $b/a = a/b$，所以 $a^{2} = b^{2}$，并且由于 $a,b>0$，有 $a = b$。比较第一个和第三个方程可得 $c/a = a/c$，因此 $c^{2} = a^{2}$ 且 $c = a$。因此 $a = b = c$。代入约束条件得到 $3a^{2} = 1$，所以 $a = 1/\\sqrt{3}$。因此，\n$$\nV_{\\max} = 8a^{3} = \\frac{8}{3\\sqrt{3}} = \\frac{8\\sqrt{3}}{9}.\n$$\n等号成立的条件也可由不等式 $\\frac{a^{2} + b^{2} + c^{2}}{3} \\geq (a^{2}b^{2}c^{2})^{1/3}$ 直接得出。在约束条件下，此不等式意味着 $abc \\leq \\frac{1}{3\\sqrt{3}}$，并且当 $a=b=c$ 时取等号。", "answer": "$$\\boxed{\\frac{8\\sqrt{3}}{9}}$$", "id": "1649732"}, {"introduction": "除了最大化问题，拉格朗日乘数法同样适用于最小化问题，例如寻找点与曲面之间的最短距离。这个练习 [@problem_id:1649764] 要求你找到双曲抛物面上距离一个给定外部点最近的点。这个过程将加深你对“梯度对齐”这一核心思想的理解，即在最短距离点，距离函数的梯度向量必然与约束曲面的法向量（梯度）平行。", "problem": "一个质点被约束在由方程 $z = x^2 - y^2$ 定义的双曲抛物面上运动。一个外部固定点位于坐标 $P_0 = (0, 2, 3.5)$ 处。求该曲面上距离点 $P_0$ 最近且位于第一卦限（其中 $x>0$，$y>0$ 且 $z>0$）的点的坐标 $(x, y, z)$。\n\n以行矩阵的形式表示你的答案，即坐标 $(x,y,z)$。", "solution": "我们需要最小化曲面 $z=x^{2}-y^{2}$ 上的点 $(x,y,z)$ 到点 $P_{0}=(0,2,\\frac{7}{2})$ 的欧几里得距离的平方。最小化距离的平方可以避免处理平方根，并得到相同的极小值点。定义\n$$\nS(x,y,z)=x^{2}+(y-2)^{2}+\\left(z-\\frac{7}{2}\\right)^{2}\n$$\n其约束条件为\n$$\nc(x,y,z)=z-x^{2}+y^{2}=0.\n$$\n使用拉格朗日乘数 $\\lambda$，建立方程组 $\\nabla S=\\lambda\\,\\nabla c$ 以及 $c=0$。计算梯度：\n$$\n\\frac{\\partial S}{\\partial x}=2x,\\quad \\frac{\\partial S}{\\partial y}=2(y-2),\\quad \\frac{\\partial S}{\\partial z}=2\\left(z-\\frac{7}{2}\\right),\n$$\n$$\n\\frac{\\partial c}{\\partial x}=-2x,\\quad \\frac{\\partial c}{\\partial y}=2y,\\quad \\frac{\\partial c}{\\partial z}=1.\n$$\n拉格朗日方程组为\n$$\n2x=\\lambda(-2x),\\qquad 2(y-2)=\\lambda(2y),\\qquad 2\\left(z-\\frac{7}{2}\\right)=\\lambda,\\qquad z-x^{2}+y^{2}=0.\n$$\n我们寻求第一卦限内的解，这要求 $x>0$，$y>0$，$z>0$。因此 $x\\neq 0$，从 $2x=-2\\lambda x$ 我们得到\n$$\n1=-\\lambda\\;\\;\\Longrightarrow\\;\\; \\lambda=-1.\n$$\n将 $\\lambda=-1$ 代入其他方程：\n$$\n2(y-2)=-2y\\;\\;\\Longrightarrow\\;\\; 2y-4=-2y\\;\\;\\Longrightarrow\\;\\; 4y=4\\;\\;\\Longrightarrow\\;\\; y=1,\n$$\n$$\n2\\left(z-\\frac{7}{2}\\right)=-1\\;\\;\\Longrightarrow\\;\\; z-\\frac{7}{2}=-\\frac{1}{2}\\;\\;\\Longrightarrow\\;\\; z=3.\n$$\n应用约束条件 $z=x^{2}-y^{2}$：\n$$\n3=x^{2}-1\\;\\;\\Longrightarrow\\;\\; x^{2}=4\\;\\;\\Longrightarrow\\;\\; x=\\pm 2.\n$$\n第一卦限要求 $x>0$，所以 $x=2$。该候选解满足 $y=1>0$ 和 $z=3>0$，因此它位于第一卦限。因此，在第一卦限内，曲面上距离 $P_{0}$ 最近的点是 $(2,1,3)$。", "answer": "$$\\boxed{\\begin{pmatrix}2 & 1 & 3\\end{pmatrix}}$$", "id": "1649764"}, {"introduction": "现实世界中的问题往往涉及多个约束条件。拉格朗日乘数法可以优雅地扩展到这类情况，此时目标函数的梯度可以表示为各个约束函数梯度的线性组合。在此练习 [@problem_id:1649749] 中，你将处理一个由圆柱体和平面相交所形成的曲线，并找出其上某坐标达到极值的点，从而练习处理形如 $\\nabla f = \\lambda_1 \\nabla g_1 + \\lambda_2 \\nabla g_2$ 的多约束优化问题。", "problem": "三维欧几里得空间中的一条曲线由两个曲面的交线定义：一个方程为 $y^2 + z^2 = 1$ 的柱面，以及一个方程为 $x - y - z = 0$ 的平面。该曲线上有两个点，其 $x$ 坐标在这些点上达到极值（一个最大值和一个最小值）。计算这两个极值点之间距离的平方。", "solution": "设待优化的函数为 $x$ 坐标，即 $f(x, y, z) = x$。\n该优化受两个约束条件限制。我们可以将约束条件写成函数值为零的形式：\n1.  柱面方程：$g_1(x, y, z) = y^2 + z^2 - 1 = 0$。\n2.  平面方程：$g_2(x, y, z) = x - y - z = 0$。\n\n我们使用针对两个约束条件的拉格朗日乘数法，该方法指出，在极值点处，如果约束函数的梯度线性无关，则目标函数的梯度是约束函数梯度的线性组合。该条件表示为 $\\nabla f = \\lambda \\nabla g_1 + \\mu \\nabla g_2$，其中 $\\lambda$ 和 $\\mu$ 是拉格朗日乘数。\n\n首先，我们计算函数 $f$、$g_1$ 和 $g_2$ 的梯度：\n$\\nabla f(x, y, z) = \\langle \\frac{\\partial f}{\\partial x}, \\frac{\\partial f}{\\partial y}, \\frac{\\partial f}{\\partial z} \\rangle = \\langle 1, 0, 0 \\rangle$\n$\\nabla g_1(x, y, z) = \\langle \\frac{\\partial g_1}{\\partial x}, \\frac{\\partial g_1}{\\partial y}, \\frac{\\partial g_1}{\\partial z} \\rangle = \\langle 0, 2y, 2z \\rangle$\n$\\nabla g_2(x, y, z) = \\langle \\frac{\\partial g_2}{\\partial x}, \\frac{\\partial g_2}{\\partial y}, \\frac{\\partial g_2}{\\partial z} \\rangle = \\langle 1, -1, -1 \\rangle$\n\n现在，我们根据 $\\nabla f = \\lambda \\nabla g_1 + \\mu \\nabla g_2$ 建立方程组：\n$\\langle 1, 0, 0 \\rangle = \\lambda \\langle 0, 2y, 2z \\rangle + \\mu \\langle 1, -1, -1 \\rangle$\n$\\langle 1, 0, 0 \\rangle = \\langle \\mu, 2\\lambda y - \\mu, 2\\lambda z - \\mu \\rangle$\n\n这个向量方程给出了以下三个标量方程：\n(1) $1 = \\mu$\n(2) $0 = 2\\lambda y - \\mu$\n(3) $0 = 2\\lambda z - \\mu$\n\n我们还有两个约束方程：\n(4) $y^2 + z^2 = 1$\n(5) $x = y + z$\n\n我们继续求解这个包含五个方程的方程组，以确定变量 $x, y, z, \\lambda, \\mu$。\n从方程(1)中，我们立即得出 $\\mu = 1$。\n\n将 $\\mu = 1$ 代入方程(2)和(3)：\n(2') $0 = 2\\lambda y - 1 \\implies 2\\lambda y = 1$\n(3') $0 = 2\\lambda z - 1 \\implies 2\\lambda z = 1$\n\n从(2')和(3')可知 $2\\lambda y = 2\\lambda z$。如果 $\\lambda \\neq 0$，我们可以两边除以 $2\\lambda$ 得到 $y = z$。如果 $\\lambda = 0$，方程(2')和(3')将变为 $0 = -1$，这是一个矛盾。因此，$\\lambda$ 必定不为零，所以可以断定 $y=z$。\n\n现在我们将 $y=z$ 代入约束方程(4)：\n$y^2 + y^2 = 1$\n$2y^2 = 1$\n$y^2 = \\frac{1}{2}$\n这给出了 $y$ 的两个可能值：$y = \\frac{1}{\\sqrt{2}}$ 和 $y = -\\frac{1}{\\sqrt{2}}$。\n\n由于 $z=y$，我们得到 $(y, z)$ 的两组解：\n情况1：$y = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}$ 且 $z = \\frac{\\sqrt{2}}{2}$。\n情况2：$y = -\\frac{1}{\\sqrt{2}} = -\\frac{\\sqrt{2}}{2}$ 且 $z = -\\frac{\\sqrt{2}}{2}$。\n\n接下来，我们使用约束方程(5)，$x = y + z$，来求出每种情况下对应的 $x$ 值。\n对于情况1：\n$x_1 = \\frac{\\sqrt{2}}{2} + \\frac{\\sqrt{2}}{2} = \\sqrt{2}$。\n这给出了点 $P_1 = (\\sqrt{2}, \\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$。此点对应于 $x$ 坐标的最大值。\n\n对于情况2：\n$x_2 = -\\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = -\\sqrt{2}$。\n这给出了点 $P_2 = (-\\sqrt{2}, -\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2})$。此点对应于 $x$ 坐标的最小值。\n\n我们找到了两个极值点：$P_{max} = (\\sqrt{2}, \\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$ 和 $P_{min} = (-\\sqrt{2}, -\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2})$。\n\n最后一步是计算这两点之间距离的平方 $d^2$。两点 $(x_a, y_a, z_a)$ 和 $(x_b, y_b, z_b)$ 之间距离的平方公式为 $d^2 = (x_a - x_b)^2 + (y_a - y_b)^2 + (z_a - z_b)^2$。\n$d^2 = (\\sqrt{2} - (-\\sqrt{2}))^2 + \\left(\\frac{\\sqrt{2}}{2} - \\left(-\\frac{\\sqrt{2}}{2}\\right)\\right)^2 + \\left(\\frac{\\sqrt{2}}{2} - \\left(-\\frac{\\sqrt{2}}{2}\\right)\\right)^2$\n$d^2 = (2\\sqrt{2})^2 + \\left(\\frac{2\\sqrt{2}}{2}\\right)^2 + \\left(\\frac{2\\sqrt{2}}{2}\\right)^2$\n$d^2 = (2\\sqrt{2})^2 + (\\sqrt{2})^2 + (\\sqrt{2})^2$\n$d^2 = (4 \\cdot 2) + 2 + 2$\n$d^2 = 8 + 2 + 2 = 12$。", "answer": "$$\\boxed{12}$$", "id": "1649749"}]}