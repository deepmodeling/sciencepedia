{"hands_on_practices": [{"introduction": "广义线性模型（GLM）的基石在于它能够将随机分量、系统分量和连接函数巧妙地结合起来。在实践中，我们通常使用极大似然法来估计模型参数，而构建对数似然函数正是这一过程的第一步。这个练习将指导你为一个经典的二项回归模型推导其对数似然函数，这是掌握广义线性模型参数估计原理的基础。[@problem_id:1919840]", "problem": "在广义线性模型（GLM）的背景下，考虑一个用于分析计数数据的二项回归模型。对于每个观测单元 $i$，我们观察到在已知的总试验次数 $n_i$ 中，“成功”的次数为 $y_i$。该模型假设随机变量 $Y_i$ 服从二项分布，$Y_i \\sim \\text{Binomial}(n_i, p_i)$，其中 $p_i$ 是单元 $i$ 中单次试验的成功概率。\n\n该模型通过一个 logit 连接函数将成功概率 $p_i$ 与一组解释变量（协变量）$\\mathbf{x}_i$ 联系起来。具体来说，该关系由以下公式给出：\n$$ \\text{logit}(p_i) = \\ln\\left(\\frac{p_i}{1-p_i}\\right) = \\eta_i $$\n其中 $\\eta_i = \\mathbf{x}_i^T \\boldsymbol{\\beta}$ 是线性预测子，$\\boldsymbol{\\beta}$ 是回归系数的向量。\n\n你的任务是推导来自单元 $i$ 的单个观测值 $y_i$ 的对数似然函数。请将你的最终答案（表示为 $\\ell(\\boldsymbol{\\beta}; y_i)$）用观测到的计数 $y_i$、总试验次数 $n_i$ 和线性预测子 $\\eta_i$ 来表示。", "solution": "对于单个观测值 $y_i$，其中 $Y_i \\sim \\text{Binomial}(n_i, p_i)$，其概率质量函数为\n$$\n\\Pr(Y_i = y_i) = \\binom{n_i}{y_i} p_i^{y_i} (1 - p_i)^{n_i - y_i}.\n$$\n该观测值的对数似然为\n$$\n\\ell(\\boldsymbol{\\beta}; y_i) = \\ln \\binom{n_i}{y_i} + y_i \\ln p_i + (n_i - y_i)\\ln(1 - p_i).\n$$\n使用 logit 连接函数，$\\eta_i = \\ln\\!\\left(\\frac{p_i}{1 - p_i}\\right)$，因此其反连接函数给出\n$$\np_i = \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}, \\qquad 1 - p_i = \\frac{1}{1 + \\exp(\\eta_i)}.\n$$\n因此，\n$$\n\\ln p_i = \\eta_i - \\ln\\!\\left(1 + \\exp(\\eta_i)\\right), \\qquad \\ln(1 - p_i) = -\\ln\\!\\left(1 + \\exp(\\eta_i)\\right).\n$$\n代入对数似然函数中，\n$$\n\\ell(\\boldsymbol{\\beta}; y_i) = \\ln \\binom{n_i}{y_i} + y_i\\left[\\eta_i - \\ln\\!\\left(1 + \\exp(\\eta_i)\\right)\\right] + (n_i - y_i)\\left[-\\ln\\!\\left(1 + \\exp(\\eta_i)\\right)\\right].\n$$\n合并同类项，\n$$\n\\ell(\\boldsymbol{\\beta}; y_i) = \\ln \\binom{n_i}{y_i} + y_i \\eta_i - n_i \\ln\\!\\left(1 + \\exp(\\eta_i)\\right).\n$$\n这就是用 $y_i$、$n_i$ 和 $\\eta_i$ 表示所求的对数似然函数。", "answer": "$$\\boxed{\\ln\\binom{n_i}{y_i} + y_i \\eta_i - n_i \\ln\\!\\left(1 + \\exp(\\eta_i)\\right)}$$", "id": "1919840"}, {"introduction": "在确定了模型的对数似然函数后，下一个关键问题是评估参数估计的精度。Fisher 信息是衡量数据中包含的关于未知参数信息量的核心指标，它直接关系到极大似然估计量的方差。通过在一个最简单的伯努利试验情景下计算 Fisher 信息，本练习能帮助你直观地理解这一重要概念，并为后续理解参数估计的置信区间和假设检验打下基础。[@problem_id:1919843]", "problem": "单个观测值（记为随机变量 $X$）从参数为 $p$ 的伯努利分布中抽取，其中 $0  p  1$。其概率质量函数为 $f(x; p) = p^x (1-p)^{1-x}$，其中 $x \\in \\{0, 1\\}$。\n\n您的任务是基于该单次观测，计算参数 $p$ 的费雪信息 $I(p)$。请以关于 $p$ 的解析表达式给出您的答案。", "solution": "我们从参数为 $p$ 的伯努利随机变量的概率质量函数开始，其形式为 $f(x;p)=p^{x}(1-p)^{1-x}$，其中 $x \\in \\{0,1\\}$。对于单个观测值 $X=x$，其对数似然函数为\n$$\n\\ell(p;x)=\\ln f(x;p)=x\\ln p+(1-x)\\ln(1-p).\n$$\n得分函数是对数似然函数关于 $p$ 的导数：\n$$\nU(p;X)=\\frac{\\partial}{\\partial p}\\ell(p;X)=\\frac{X}{p}-\\frac{1-X}{1-p}.\n$$\n对于一次观测，费雪信息定义为\n$$\nI(p)=\\mathbb{E}\\!\\left[\\,U(p;X)^{2}\\,\\right],\n$$\n其中期望的计算基于 $X \\sim \\text{Bernoulli}(p)$。由于 $X$ 分别以概率 $1-p$ 和 $p$ 取值 $0$ 和 $1$，我们在这两点上计算 $U(p;X)$ 的值：\n- 当 $X=1$ 时，则 $U(p;1)=\\frac{1}{p}$。\n- 当 $X=0$ 时，则 $U(p;0)=-\\frac{1}{1-p}$。\n因此，\n$$\nI(p)=p\\left(\\frac{1}{p}\\right)^{2}+(1-p)\\left(\\frac{1}{1-p}\\right)^{2}\n=\\frac{1}{p}+\\frac{1}{1-p}\n=\\frac{1}{p(1-p)}.\n$$\n这就得出了基于单次观测的伯努利分布参数 $p$ 的费雪信息。", "answer": "$$\\boxed{\\frac{1}{p(1-p)}}$$", "id": "1919843"}, {"introduction": "建立模型只是数据分析过程的一部分，同样重要的是对模型进行诊断和验证。在处理计数数据时，泊松回归是一个常用的工具，但它的一个核心假设是均值与方差相等，而真实数据往往存在“过度离散”（overdispersion）现象，即方差大于均值。这个练习模拟了一个生物统计学场景，教你如何通过计算离散参数 $\\hat{\\phi}$ 来检验模型是否存在过度离散，这是确保模型可靠性的一个关键实践步骤。[@problem_id:1919857]", "problem": "一位生物统计学家正在分析一个患者队列在一年期间观察到的未愈合溃疡数量的数据。由于该数据是计数数据，因此采用泊松回归模型（一种广义线性模型，GLM）来理解溃疡计数与几个患者特定协变量之间的关系。\n\n该研究共包括 $n = 120$ 名患者。拟合后的模型包含一个截距项和 $k=7$ 个不同的预测变量。运行回归分析后，统计软件报告的残差离差为 $208.5$。\n\n在标准的泊松模型中，响应变量的方差假定等于其均值。当观测到的方差大于均值时，就会出现过度离散。检验过度离散的一个简单方法是计算离散参数 $\\phi$ 的估计值。在没有过度离散的理想泊松模型中，该参数等于 1。使用所提供的信息，计算此模型的估计离散参数 $\\hat{\\phi}$。将结果以数值形式报告，并四舍五入到三位有效数字。", "solution": "在泊松 GLM 中，根据等离散假设，残差离差 $D$ 近似服从 $\\chi^{2}$ 分布，其自由度为残差自由度 $\\text{df} = n - p$，其中 $p$ 是估计参数的数量（包括截距项）。在评估过度离散时，离散参数的一个估计量为\n$$\n\\hat{\\phi} = \\frac{D}{\\text{df}} = \\frac{D}{n - p}.\n$$\n在此，$n = 120$，模型有一个截距项和 $k = 7$ 个预测变量，所以\n$$ p = 1 + k = 1 + 7 = 8, \\quad \\text{df} = n - p = 120 - 8 = 112. $$\n给定残差离差 $D = 208.5$，我们计算\n$$\n\\hat{\\phi} = \\frac{208.5}{112} = 1.861607142857\\ldots\n$$\n四舍五入到三位有效数字，结果为\n$$\n\\hat{\\phi} \\approx 1.86.\n$$", "answer": "$$\\boxed{1.86}$$", "id": "1919857"}]}