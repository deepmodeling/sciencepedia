{"hands_on_practices": [{"introduction": "在广义线性模型 (GLM) 的框架中，联结函数是连接响应变量期望值 $\\mu$ 与线性预测变量 $\\eta$ 的关键桥梁。这个练习将挑战你批判性地思考一个函数要成为有效的联结函数所必须具备的基本数学属性。通过分析一个不合适的函数提案，你将巩固对为何需要使用逻辑谛 (logit) 或概率单位 (probit) 等标准联结函数的理解 [@problem_id:1930962]。", "problem": "在广义线性模型（GLMs）的框架中，响应变量的期望值 $\\mu = E[Y]$ 与线性预测子 $\\eta = \\mathbf{x}^T\\beta$ 之间的关系是通过一个连接函数 $g$ 建立的。其核心方程是 $g(\\mu) = \\eta$。为了使该模型是良定的，连接函数必须将均值 $\\mu$ 的可能取值空间映射到线性预测子 $\\eta$ 的可能取值空间。\n\n考虑一个遵循伯努利分布的响应变量 $Y$，其中 $Y$ 可以取值为 $0$ 或 $1$。因此，该变量的均值 $\\mu = P(Y=1)$ 被限制在开区间 $(0,1)$ 内。线性预测子 $\\eta$ 作为解释变量的线性组合，理论上可以取实数线上的任何值，即 $\\eta \\in (-\\infty, \\infty)$。\n\n一位分析师提议使用函数 $g(\\mu) = \\mu^2$ 作为此伯努利 GLM 的连接函数。下列哪个陈述指出了该函数不适用于此目的的根本原因？\n\nA. 函数 $g(\\mu) = \\mu^2$ 不是伯努利分布的典则连接函数。\n\nB. 函数 $g(\\mu) = \\mu^2$ 在整个实数线上不是一对一的。\n\nC. 对于 $\\mu \\in (0,1)$，函数 $g(\\mu)$ 的值域没有覆盖整个实数集。\n\nD. 连接函数的反函数 $g^{-1}(\\eta)$ 不存在。\n\nE. 连接函数的二阶导数 $g''(\\mu)$ 不为零。", "solution": "在广义线性模型中，连接函数 $g$ 必须将均值参数空间映射到线性预测子空间，并且是可逆的，以便对于任何 $\\eta \\in (-\\infty,\\infty)$，其反函数 $g^{-1}(\\eta)$ 能在允许的范围内产生一个有效的均值 $\\mu$。对于伯努利响应，其均值满足 $\\mu \\in (0,1)$，因此一个有效的连接函数必须满足\n$$\ng:(0,1)\\to(-\\infty,\\infty)\n$$\n并且是一对一的，其反函数为\n$$\ng^{-1}:(-\\infty,\\infty)\\to(0,1).\n$$\n\n考虑 $g(\\mu)=\\mu^{2}$。对于 $\\mu \\in (0,1)$，我们有 $0<\\mu^{2}<1$，因此\n$$\ng\\big((0,1)\\big)=(0,1).\n$$\n因此，在 $\\mu$ 的容许定义域上，$g$ 的值域是 $(0,1)$，这没有覆盖 $(-\\infty,\\infty)$。所以，对于任何 $\\eta \\notin (0,1)$，不存在 $\\mu \\in (0,1)$ 使得 $g(\\mu)=\\eta$，并且其反函数 $g^{-1}(\\eta)=\\sqrt{\\eta}$ 无法对所有 $\\eta \\in (-\\infty,\\infty)$ 定义。这违反了连接映射必须是到线性预测子空间上的满射这一要求。\n\n评估各个选项：\n- A 不是根本原因；非典则连接函数仍然可以是有效的。\n- B 与所要求的定义域无关；在 $(0,1) 上，$g$ 是一对一的。\n- C 正确地指出 $g\\big((0,1)\\big)\\neq(-\\infty,\\infty)$，这是根本性的缺陷。\n- D 的陈述是错误的；反函数存在，但仅在受限的值域 $(0,1)$ 上存在，而不是在 $(-\\infty,\\infty)$ 上。\n- E 与连接函数的有效性无关。\n\n因此，根本原因在于 C 所描述的值域不匹配。", "answer": "$$\\boxed{C}$$", "id": "1930962"}, {"introduction": "拟合模型后，我们需要评估其拟合优度，而偏差 (Deviance) 是 GLM 中用于此目的的核心概念。这个实践将偏差的概念分解为其最基本的组成部分：单个数据点的贡献。通过为一个简单的伯努利试验计算这个值，你将直观地理解偏差是如何量化模型预测与实际结果之间差异的 [@problem_id:1930938]。", "problem": "一家金融服务公司开发了一个逻辑回归模型，用于预测贷款申请人是否会贷款违约。第 $i$ 个申请人的结果是一个二元变量 $y_i$，其中 $y_i=1$ 表示违约，$y_i=0$ 表示不违约。该模型提供了预测的违约概率 $\\hat{p}_i$。\n\n这类模型的拟合优度通常使用偏差（deviance）来评估，而偏差是基于对数似然函数的。单个观测值对总偏差的贡献，是由饱和模型（一个能完美拟合数据的模型）的对数似然与拟合模型对该观测值的对数似然之差的两倍给出的。\n\n考虑一个申请人，模型预测其违约概率为 $\\hat{p} = 0.80$。实际上，该申请人确实违约了，因此观测结果为 $y=1$。\n\n计算该单个观测值对模型总偏差的数值贡献。将您的最终答案四舍五入到四位有效数字。", "solution": "对于结果为 $y \\in \\{0,1\\}$ 且模型预测概率为 $\\hat{p}$ 的伯努利观测，拟合模型的对数似然贡献为\n$$\n\\ell_{\\text{fit}}(y;\\hat{p})=y\\ln(\\hat{p})+(1-y)\\ln(1-\\hat{p}).\n$$\n饱和模型完美地拟合了观测值，将概率 $1$ 赋给观测到的结果，所以其对数似然贡献为\n$$\n\\ell_{\\text{sat}}(y)=\\ln(1)=0.\n$$\n单个观测值的偏差贡献定义为\n$$\nD=2\\big(\\ell_{\\text{sat}}-\\ell_{\\text{fit}}\\big).\n$$\n当 $y=1$ 且 $\\hat{p}=0.80$ 时，我们有\n$$\n\\ell_{\\text{fit}}=\\ln(0.80),\n$$\n所以\n$$\nD=2\\big(0-\\ln(0.80)\\big)=-2\\ln(0.80)=2\\ln\\!\\left(\\frac{1}{0.80}\\right)=2\\ln(1.25).\n$$\n数值上，\n$$\n2\\ln(1.25)=2\\big(\\ln(5)-\\ln(4)\\big)\\approx 2\\times 0.2231435513\\approx 0.4462871026,\n$$\n四舍五入到四位有效数字为 $0.4463$。", "answer": "$$\\boxed{0.4463}$$", "id": "1930938"}, {"introduction": "对于二元结果，有多种联结函数可供选择，而它们之间的选择并不总是显而易见的。这个练习通过检验它们的敏感度（由导数 $\\frac{d\\mu}{d\\eta}$ 表示）来探索常用联结函数之间的实际差异。通过比较逻辑谛、概率单位和互补双对数联结在特定点的这个值，你将学习到联结函数的选择如何影响模型系数的解释以及其对预测变量变化的响应 [@problem_id:1930929]。", "problem": "在用于二元数据的广义线性模型 (GLM) 框架中，连接函数 $g(\\mu)$ 将响应变量的期望值 $\\mu = E[Y]$ 与线性预测子 $\\eta$ 联系起来。线性预测子是解释变量的线性组合。该关系由 $\\eta = g(\\mu)$ 给出，其中 $0 < \\mu < 1$。量 $\\frac{d\\mu}{d\\eta}$ 表示平均响应对线性预测子微小变化的敏感度。\n\n考虑以下三种常用的连接函数：\n1.  **Logit**：$\\eta = \\ln\\left(\\frac{\\mu}{1-\\mu}\\right)$\n2.  **Probit**：$\\eta = \\Phi^{-1}(\\mu)$，其中 $\\Phi^{-1}$ 是标准正态分布的分位数函数（累积分布函数的反函数）。标准正态分布的概率密度函数为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^{2}}{2}\\right)$。\n3.  **互补对数-对数 (cloglog)**：$\\eta = \\ln(-\\ln(1-\\mu))$\n\n对于这三个模型中的每一个，在平均响应为 $\\mu = 0.5$ 的点上，计算导数 $\\frac{d\\mu}{d\\eta}$ 的数值。\n\n请按 logit、probit、cloglog 模型的特定顺序，将您的三个结果表示为一组数字。将每个数值四舍五入到四位有效数字。", "solution": "我们需求解在 $\\mu=0.5$ 时每个连接函数的 $d\\mu/d\\eta$。在广义线性模型中，若连接函数为 $\\eta=g(\\mu)$，则其反函数为 $\\mu=g^{-1}(\\eta)$，且导数满足\n$$\n\\frac{d\\mu}{d\\eta}=\\frac{1}{g'(\\mu)}.\n$$\n\nLogit 连接函数：$g(\\mu)=\\ln\\!\\left(\\frac{\\mu}{1-\\mu}\\right)$。求导得：\n$$\ng'(\\mu)=\\frac{d}{d\\mu}\\left[\\ln(\\mu)-\\ln(1-\\mu)\\right]=\\frac{1}{\\mu}+\\frac{1}{1-\\mu}=\\frac{1}{\\mu(1-\\mu)}.\n$$\n因此，\n$$\n\\frac{d\\mu}{d\\eta}=\\mu(1-\\mu).\n$$\n在 $\\mu=0.5$ 时，$\\frac{d\\mu}{d\\eta}=0.5\\times 0.5=0.25$。\n\nProbit 连接函数：$g(\\mu)=\\Phi^{-1}(\\mu)$。根据反函数的求导法则，\n$$\ng'(\\mu)=\\frac{1}{\\Phi'\\!\\left(\\Phi^{-1}(\\mu)\\right)}=\\frac{1}{\\phi\\!\\left(\\Phi^{-1}(\\mu)\\right)}.\n$$\n因此，\n$$\n\\frac{d\\mu}{d\\eta}=\\phi\\!\\left(\\Phi^{-1}(\\mu)\\right).\n$$\n在 $\\mu=0.5$ 时，$\\eta=\\Phi^{-1}(0.5)=0$，且 $\\phi(0)=\\frac{1}{\\sqrt{2\\pi}}$。其数值为 $\\frac{1}{\\sqrt{2\\pi}}\\approx 0.3989$（保留四位有效数字）。\n\n互补对数-对数连接函数：$g(\\mu)=\\ln\\!\\big(-\\ln(1-\\mu)\\big)$。使用链式法则求导得：\n$$\ng'(\\mu)=\\frac{1}{-\\ln(1-\\mu)}\\cdot\\frac{d}{d\\mu}\\big[-\\ln(1-\\mu)\\big]=\\frac{1}{-\\ln(1-\\mu)}\\cdot\\frac{1}{1-\\mu}=\\frac{1}{(1-\\mu)\\big(-\\ln(1-\\mu)\\big)}.\n$$\n所以，\n$$\n\\frac{d\\mu}{d\\eta}=(1-\\mu)\\big(-\\ln(1-\\mu)\\big).\n$$\n在 $\\mu=0.5$ 时，该值为 $(1-0.5)\\big(-\\ln(0.5)\\big)=0.5\\ln 2\\approx 0.3466$（保留四位有效数字）。\n\n按 logit、probit、cloglog 的顺序收集结果并四舍五入到四位有效数字，得到 $0.2500$, $0.3989$, $0.3466$。", "answer": "$$\\boxed{\\begin{pmatrix}0.2500 & 0.3989 & 0.3466\\end{pmatrix}}$$", "id": "1930929"}]}