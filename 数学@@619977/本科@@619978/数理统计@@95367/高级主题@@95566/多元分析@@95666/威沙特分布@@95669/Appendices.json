{"hands_on_practices": [{"introduction": "维沙特分布不仅仅是一个理论上的概念，它直接源于对多变量数据的分析。第一个练习将我们置于一个常见的统计场景中：根据一组观测数据计算样本协方差。通过这个练习 [@problem_id:1967888]，你将学习如何从样本数据中确定维沙特分布的参数，并运用其关键性质来计算期望总变异，从而将抽象的理论与具体的统计量联系起来。", "problem": "一位生物统计学家正在分析一种新发现的兰花物种的表型数据。每个样本记录了四个关键的花部测量值：萼片长度、花瓣宽度、唇瓣长度和合蕊柱高度。这些测量值被建模为一个4维随机向量，假设其服从一个多元正态分布，具有未知的均值向量 $\\mu$ 和未知的总体协方差矩阵 $\\Sigma$。\n\n收集了一个包含 $n=25$ 株兰花的随机样本。设第 $i$ 株兰花的测量向量表示为 $X_i \\in \\mathbb{R}^4$。样本均值向量计算为 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n离差平方和与叉积和 (SSCP) 矩阵 $A$ 使用公式 $A = \\sum_{i=1}^{n} (X_i - \\bar{X})(X_i - \\bar{X})^T$ 计算。在多元统计中，一个标准结果是矩阵 $A$ 服从Wishart分布，记作 $A \\sim W_p(k, \\Sigma)$，其中 $p$ 是数据的维度，$k$ 是自由度。\n\n根据对相关物种的大量先前遗传分析，四个测量值（萼片长度、花瓣宽度、唇瓣长度和合蕊柱高度）的总体方差被可靠地估计为分别为 $10 \\text{ mm}^2$、$3 \\text{ mm}^2$、$8 \\text{ mm}^2$ 和 $4 \\text{ mm}^2$。\n\n该生物统计学家对中心化数据所捕获的期望总变异感兴趣。这对应于SSCP矩阵 $A$ 的迹的期望值。计算 $A$ 的迹的期望值。答案以 $\\text{mm}^2$ 为单位表示。", "solution": "设 $X_{i} \\in \\mathbb{R}^{4}$ 是独立同分布于 $N_{4}(\\mu,\\Sigma)$ 的随机向量，并定义SSCP矩阵 $A=\\sum_{i=1}^{n}(X_{i}-\\bar{X})(X_{i}-\\bar{X})^{T}$，其中 $n=25$。一个标准结果是 $A \\sim W_p(k, \\Sigma)$，其中 $p=4$ 且 $k=n-1=24$。对于一个Wishart随机矩阵 $W \\sim W_p(k, \\Sigma)$，其期望满足 $\\mathbb{E}[W]=k\\Sigma$。使用迹的线性性质和 $\\operatorname{tr}(cM)=c\\,\\operatorname{tr}(M)$，我们有\n$$\n\\mathbb{E}[\\operatorname{tr}(A)]=\\operatorname{tr}(\\mathbb{E}[A])=\\operatorname{tr}(k\\Sigma)=k\\,\\operatorname{tr}(\\Sigma).\n$$\n$\\Sigma$ 的迹等于四个测量值的总体方差之和，这些方差在问题中已给出，分别为 $10$、$3$、$8$ 和 $4$（单位为 $\\text{mm}^{2}$）。因此，\n$$\n\\operatorname{tr}(\\Sigma)=10+3+8+4=25 \\text{ mm}^{2},\n$$\n因此\n$$\n\\mathbb{E}[\\operatorname{tr}(A)]=24 \\times 25=600 \\text{ mm}^{2}.\n$$", "answer": "$$\\boxed{600}$$", "id": "1967888"}, {"introduction": "在了解了统计量的平均行为之后，理解其变异性也至关重要。这个练习 [@problem_id:1967831] 将我们从维沙特分布的一阶矩（期望）带到二阶矩（方差）。你将推导其对角线元素的方差，这对应于其中一个变量的样本方差，从而让你更深入地理解我们估计值的不确定性。", "problem": "在多元统计学领域，Wishart 分布是卡方分布在多维上的推广，对于推断协方差矩阵的性质至关重要。\n\n设 $W$ 是一个服从 Wishart 分布的 $p \\times p$ 随机矩阵，记为 $W \\sim W_p(n, \\Sigma)$，其中 $n$ 为自由度，$\\Sigma$ 是一个 $p \\times p$ 的对称正定尺度矩阵。随机矩阵 $W$ 的元素记为 $W_{ij}$，常数尺度矩阵 $\\Sigma$ 的元素记为 $\\Sigma_{ij}$。\n\n根据这些定义，确定随机矩阵 $W$ 的任一对角元素 $W_{ii}$ 的方差，记为 $Var(W_{ii})$，其中 $i \\in \\{1, 2, ..., p\\}$。最终答案应为一个以自由度 $n$ 和尺度矩阵的相应对角元素 $\\Sigma_{ii}$ 表示的闭式解析表达式。", "solution": "从 Wishart 分布的构造性定义出发：若 $X_{1},\\dots,X_{n}$ 独立同分布于 $N_{p}(0,\\Sigma)$，则\n$$\nW \\equiv \\sum_{t=1}^{n} X_{t} X_{t}^{\\top} \\sim W_{p}(n,\\Sigma).\n$$\n对于一个固定的索引 $i \\in \\{1,\\dots,p\\}$，$W$ 的 $(i,i)$ 元素为\n$$\nW_{ii}=\\sum_{t=1}^{n} X_{ti}^{2},\n$$\n其中 $X_{ti}$ 表示 $X_{t}$ 的第 $i$ 个分量。由于向量 $X_{t}$ 关于 $t$ 相互独立，因此对于固定的 $i$，随机变量 $X_{ti}^{2}$ 也关于 $t$ 相互独立。所以，\n$$\n\\operatorname{Var}(W_{ii})=\\operatorname{Var}\\!\\left(\\sum_{t=1}^{n} X_{ti}^{2}\\right)=\\sum_{t=1}^{n} \\operatorname{Var}(X_{ti}^{2})=n\\,\\operatorname{Var}(X_{1i}^{2}).\n$$\n因为 $X_{1i}\\sim N(0,\\Sigma_{ii})$，其二阶矩和四阶矩为\n$$\n\\mathbb{E}[X_{1i}^{2}] = \\Sigma_{ii}, \\qquad \\mathbb{E}[X_{1i}^{4}] = 3\\,\\Sigma_{ii}^{2}.\n$$\n因此，\n$$\n\\operatorname{Var}(X_{1i}^{2})=\\mathbb{E}[X_{1i}^{4}] - \\left(\\mathbb{E}[X_{1i}^{2}]\\right)^{2} = 3\\,\\Sigma_{ii}^{2} - \\Sigma_{ii}^{2} = 2\\,\\Sigma_{ii}^{2}.\n$$\n代回可得\n$$\n\\operatorname{Var}(W_{ii}) = n \\cdot 2\\,\\Sigma_{ii}^{2} = 2 n \\Sigma_{ii}^{2}.\n$$\n此结果也与 Wishart 矩阵项的通用协方差公式 $\\operatorname{Cov}(W_{ij},W_{kl})=n(\\Sigma_{ik}\\Sigma_{jl}+\\Sigma_{il}\\Sigma_{jk})$ 一致，当 $(i,j,k,l)=(i,i,i,i)$ 时，该公式可化简为 $2 n \\Sigma_{ii}^{2}$。", "answer": "$$\\boxed{2 n \\Sigma_{ii}^{2}}$$", "id": "1967831"}, {"introduction": "在许多高级统计模型中，尤其是在贝叶斯推断中，使用协方差矩阵的逆矩阵（即精度矩阵）通常更为方便。最后一个练习 [@problem_id:1967861] 探讨了维沙特矩阵的逆的期望值，这是贝叶斯分析中的一个基石性结论。掌握这一计算将为你提供一个强大的工具，并为你打开理解协方差结构先验在实践中如何应用的大门。", "problem": "在多变量数据的贝叶斯分析中，协方差矩阵的逆矩阵（即精度矩阵）通常扮演着核心角色。对协方差结构进行建模的一个基本工具是维沙特分布。\n\n考虑一组包含 $n$ 个独立同分布的随机向量 $X_1, X_2, \\dots, X_n$，每个向量都从一个均值向量为零、协方差矩阵为正定矩阵 $\\Sigma$ 的 $p$ 维正态分布中抽取，记作 $X_i \\sim N_p(0, \\Sigma)$。离差矩阵定义为 $W = \\sum_{i=1}^{n} X_i X_i^T$，它服从自由度为 $n$、尺度矩阵为 $\\Sigma$ 的维沙特分布，记作 $W \\sim W_p(n, \\Sigma)$。\n\n为使维沙特矩阵 $W$ 以概率 1 可逆，其自由度 $n$ 必须大于或等于维度 $p$。为使其逆矩阵的期望值存在，需要一个更严格的条件，$n  p+1$。\n\n假设 $n  p+1$，计算逆维沙特矩阵的期望值 $E[W^{-1}]$。您的答案应该是一个用 $n$、$p$ 和尺度矩阵 $\\Sigma$ 表示的闭式解析表达式。", "solution": "设 $X_{i} \\sim N_{p}(0,\\Sigma)$ 独立同分布，其中 $\\Sigma$ 是正定矩阵。离差矩阵 $W=\\sum_{i=1}^{n} X_{i}X_{i}^{T}$ 服从维沙特分布 $W \\sim W_{p}(n,\\Sigma)$，其在 $p \\times p$ 对称正定矩阵锥上的密度函数为\n$$\nf_{W}(W)=\\frac{1}{2^{np/2}|\\Sigma|^{n/2}\\Gamma_{p}\\!\\left(\\frac{n}{2}\\right)}\\,|W|^{(n-p-1)/2}\\exp\\!\\left(-\\frac{1}{2}\\operatorname{tr}(\\Sigma^{-1}W)\\right),\n$$\n其中 $\\Gamma_{p}(\\cdot)$ 是多变量伽马函数，并且 $n \\geq p$ 确保了矩阵以概率 1 可逆。\n\n定义矩阵逆变换 $S=W^{-1}$。在对称锥上，矩阵求逆的雅可比行列式为\n$$\ndW=|S|^{-(p+1)}\\,dS.\n$$\n将 $W=S^{-1}$ 代入 $f_{W}(W)$ 得到 $S$ 的密度函数：\n$$\nf_{S}(S)=\\frac{|\\Sigma|^{-n/2}}{2^{np/2}\\Gamma_{p}\\!\\left(\\frac{n}{2}\\right)}\\,|S^{-1}|^{(n-p-1)/2}\\exp\\!\\left(-\\frac{1}{2}\\operatorname{tr}(\\Sigma^{-1}S^{-1})\\right)\\,|S|^{-(p+1)}.\n$$\n使用 $|S^{-1}|=|S|^{-1}$，上式可简化为\n$$\nf_{S}(S)=\\frac{|\\Sigma|^{-n/2}}{2^{np/2}\\Gamma_{p}\\!\\left(\\frac{n}{2}\\right)}\\,|S|^{-(n+p+1)/2}\\exp\\!\\left(-\\frac{1}{2}\\operatorname{tr}(\\Sigma^{-1}S^{-1})\\right).\n$$\n这就是自由度为 $n$、尺度矩阵为 $\\Sigma^{-1}$ 的逆维沙特分布的密度函数，记作 $S \\sim IW_{p}(n,\\Sigma^{-1})$。\n\n逆维沙特分布的一个标准矩公式表明，如果 $S \\sim IW_{p}(\\nu,\\Psi)$ 且 $\\nup+1$，则\n$$\nE[S]=\\frac{\\Psi}{\\nu-p-1}.\n$$\n该结论是通过使用逆维沙特分布的归一化常数和矩阵变量伽马函数来计算一阶矩积分得到的，而该积分的期望值有限性恰好在所述条件 $\\nup+1$ 下成立。\n\n将 $\\nu=n$ 和 $\\Psi=\\Sigma^{-1}$ 应用于此公式，对于 $np+1$ 的情况，可得：\n$$\nE[W^{-1}]=E[S]=\\frac{\\Sigma^{-1}}{n-p-1}.\n$$\n这就是所要求的用 $n$、$p$ 和 $\\Sigma$ 表示的闭式表达式。", "answer": "$$\\boxed{\\frac{1}{n - p - 1}\\,\\Sigma^{-1}}$$", "id": "1967861"}]}