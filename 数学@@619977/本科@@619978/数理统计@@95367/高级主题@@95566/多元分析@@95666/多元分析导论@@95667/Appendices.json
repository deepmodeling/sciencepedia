{"hands_on_practices": [{"introduction": "在单变量统计中，方差是衡量数据离散程度的核心指标。在多变量分析中，协方差矩阵扮演着类似但更丰富的角色，它不仅描述了每个变量自身的变异，还揭示了变量之间的线性关系。通过一个具体的计算练习，我们将亲手构建一个样本协方差矩阵，这有助于我们直观地理解其对角线元素（方差）和非对角线元素（协方差）的实际意义。[@problem_id:1924314]", "problem": "一位农业科学家正在研究一种新的植物物种。他们收集了一个包含三株植物的小样本，记录了它们的高度（单位：厘米）和叶子数量的数据。测量值以（高度，叶子数量）对的形式记录。这三个数据点被视为二维列向量，如下所示：\n$$ \\mathbf{x}_1 = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{x}_2 = \\begin{pmatrix} 2 \\\\ 7 \\end{pmatrix}, \\quad \\mathbf{x}_3 = \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix} $$\n假设这三个数据点代表来自一个更大总体的随机样本，请计算这个二元数据集的无偏样本协方差矩阵 $S$。请将您的答案表示为一个 2x2 矩阵。", "solution": "要计算二元样本的无偏样本协方差矩阵，请使用定义\n$$S=\\frac{1}{n-1}\\sum_{i=1}^{n}\\left(\\mathbf{x}_{i}-\\bar{\\mathbf{x}}\\right)\\left(\\mathbf{x}_{i}-\\bar{\\mathbf{x}}\\right)^{T},$$\n其中 $n$ 是样本大小，$\\bar{\\mathbf{x}}$ 是样本均值向量，由下式给出\n$$\\bar{\\mathbf{x}}=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{x}_{i}.$$\n当 $n=3$ 且数据为 $\\mathbf{x}_{1}=\\begin{pmatrix}1\\\\4\\end{pmatrix}$，$\\mathbf{x}_{2}=\\begin{pmatrix}2\\\\7\\end{pmatrix}$，$\\mathbf{x}_{3}=\\begin{pmatrix}6\\\\1\\end{pmatrix}$ 时，均值向量为\n$$\\bar{\\mathbf{x}}=\\frac{1}{3}\\begin{pmatrix}1+2+6\\\\4+7+1\\end{pmatrix}=\\begin{pmatrix}3\\\\4\\end{pmatrix}.$$\n计算偏差：\n$$\\mathbf{d}_{1}=\\mathbf{x}_{1}-\\bar{\\mathbf{x}}=\\begin{pmatrix}-2\\\\0\\end{pmatrix},\\quad \\mathbf{d}_{2}=\\mathbf{x}_{2}-\\bar{\\mathbf{x}}=\\begin{pmatrix}-1\\\\3\\end{pmatrix},\\quad \\mathbf{d}_{3}=\\mathbf{x}_{3}-\\bar{\\mathbf{x}}=\\begin{pmatrix}3\\\\-3\\end{pmatrix}.$$\n计算外积：\n$$\\mathbf{d}_{1}\\mathbf{d}_{1}^{T}=\\begin{pmatrix}4&0\\\\0&0\\end{pmatrix},\\quad \\mathbf{d}_{2}\\mathbf{d}_{2}^{T}=\\begin{pmatrix}1&-3\\\\-3&9\\end{pmatrix},\\quad \\mathbf{d}_{3}\\mathbf{d}_{3}^{T}=\\begin{pmatrix}9&-9\\\\-9&9\\end{pmatrix}.$$\n将它们相加：\n$$\\sum_{i=1}^{3}\\mathbf{d}_{i}\\mathbf{d}_{i}^{T}=\\begin{pmatrix}4+1+9&0-3-9\\\\0-3-9&0+9+9\\end{pmatrix}=\\begin{pmatrix}14&-12\\\\-12&18\\end{pmatrix}.$$\n除以 $n-1=2$ 得到无偏样本协方差矩阵：\n$$S=\\frac{1}{2}\\begin{pmatrix}14&-12\\\\-12&18\\end{pmatrix}=\\begin{pmatrix}7&-6\\\\-6&9\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}7 & -6 \\\\ -6 & 9\\end{pmatrix}}$$", "id": "1924314"}, {"introduction": "计算出协方差矩阵后，下一步是解读它所蕴含的关于数据结构的信息。协方差矩阵的数学性质，如其行列式，能揭示数据在多维空间中的几何形态。这个练习通过一个引人深思的假设情景——协方差矩阵的行列式为零——引导我们思考抽象的代数性质与具体的数据点分布之间的深刻联系，这是理解数据冗余和降维等高级概念的关键一步。[@problem_id:1924300]", "problem": "一位工程专业的学生正在分析一个新型机械臂的运动。该机械臂的末端执行器被设计用于在三维空间中自由移动。为了表征其典型的操作空间，该学生收集了一个包含 $n$ 个位置测量值的大样本，其中每个测量值都是一个三维坐标向量 $\\mathbf{x}_i = (x_i, y_i, z_i)$，其中 $i=1, ..., n$。\n\n然后，该学生计算了这个数据集的 $3 \\times 3$ 样本协方差矩阵 $S$。完成计算后，他们惊讶地发现该协方差矩阵的行列式恰好为零，即 $\\det(S) = 0$。假设该学生的计算是正确的，且样本量 $n$ 大于 3，以下哪个选项为这一结果提供了最准确和最普遍的解释？\n\nA. 所有采集到的数据点完全位于三维空间中的同一个平面或同一直线上。\n\nB. 三个位置变量 $x$、$y$ 和 $z$ 相互不相关。\n\nC. 所有采集到的数据点都完全相同，即 $\\mathbf{x}_1 = \\mathbf{x}_2 = \\dots = \\mathbf{x}_n$。\n\nD. 数据的样本均值 $(\\bar{x}, \\bar{y}, \\bar{z})$ 必须是原点 $(0, 0, 0)$。\n\nE. 一定是发生了计算错误，因为来自真实世界测量的样本协方差矩阵的行列式不可能恰好为零。", "solution": "设观测值排列成一个 $n \\times 3$ 矩阵 $X$ 的行，并设 $\\bar{\\mathbf{x}} \\in \\mathbb{R}^{3}$ 为样本均值。定义中心化数据矩阵 $X_{c} = X - \\mathbf{1}\\bar{\\mathbf{x}}^{\\top}$，其中 $\\mathbf{1} \\in \\mathbb{R}^{n}$ 是全为1的向量。这个 $3 \\times 3$ 的样本协方差矩阵为\n$$\nS = \\frac{1}{n-1} X_{c}^{\\top} X_{c}.\n$$\n这是一个格拉姆矩阵（Gram matrix），因此是对称半正定矩阵。条件 $\\det(S) = 0$ 等价于 $S$ 是奇异矩阵，这又等价于 $\\operatorname{rank}(S) < 3$。\n\n由于 $S = \\frac{1}{n-1} X_{c}^{\\top} X_{c}$，$S$ 的奇异性等价于 $\\operatorname{rank}(X_{c}^{\\top} X_{c}) < 3$，而这又等价于 $\\operatorname{rank}(X_{c}) < 3$。等价地，存在一个非零向量 $v \\in \\mathbb{R}^{3}$ 使得\n$$\nS v = \\frac{1}{n-1} X_{c}^{\\top} X_{c} v = 0.\n$$\n由于 $v^{\\top} S v = \\frac{1}{n-1} \\| X_{c} v \\|^{2}$，等式 $S v = 0$ 意味着 $X_{c} v = 0$。按行写出，对于每个 $i$，有\n$$\n(\\mathbf{x}_{i} - \\bar{\\mathbf{x}})^{\\top} v = 0,\n$$\n所以每个中心化的观测值都位于穿过原点且与 $v$ 正交的平面上。因此，原始观测值 $\\mathbf{x}_{i}$ 都位于仿射平面 $\\{\\bar{\\mathbf{x}} + w : v^{\\top} w = 0\\}$ 中。如果 $\\operatorname{rank}(X_{c}) = 2$，这是一个平面；如果 $\\operatorname{rank}(X_{c}) = 1$，这些点位于一条直线上；如果 $\\operatorname{rank}(X_{c}) = 0$，所有点都相同（一个点）。因此，最准确和最普遍的解释是所有数据点都精确地位于一个共同的平面或直线上（所有点相同的情况作为一种退化子情况被包含在内）。\n\n对各选项的评估：\n- A 是正确的：它精确地指出数据位于一个低维仿射子空间（一个平面或一条直线）中，这等价于 $\\operatorname{rank}(X_{c}) < 3$，因此 $\\det(S)=0$。\n- B 是不正确的：相互不相关会使 $S$ 成为对角矩阵，但 $\\det(S)=0$ 并不意味着 $S$ 是对角矩阵；反之，如果 $S$ 是对角矩阵且方差为正，则 $\\det(S) > 0$。\n- C 的条件太强：所有点相同意味着 $\\det(S)=0$，但反之不一定成立；数据可以在一个或两个方向上（直线或平面）变化而无需完全相同。\n- D 是错误的：$S$ 的行列式仅取决于中心化的数据，并不会强制要求样本均值为原点。\n- E 是错误的：只要坐标之间存在精确的线性相关性，就可能出现精确的奇异性，因此不一定是计算错误。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1924300"}, {"introduction": "掌握了协方差矩阵的计算和解读之后，我们便可以利用它来对数据进行强大的变换。主成分分析 (Principal Component Analysis, PCA) 是多变量分析中最核心的技术之一，它旨在通过旋转坐标轴找到一个新的视角来简化数据结构。本练习将带我们一步步执行PCA的核心操作：寻找一个正交变换，以消除变量间的相关性，并将数据的主要变异方向（主成分）识别出来，这正是通过求解协方差矩阵的特征向量来实现的。[@problem_id:1924285]", "problem": "一位分析师正在研究两只股票每日百分比回报率的简化模型。回报率由一个零均值随机向量 $\\mathbf{X} = \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix}$ 表示，其协方差矩阵为\n$$\n\\Sigma = \\begin{pmatrix} 13 & -4 \\\\ -4 & 7 \\end{pmatrix}\n$$\n该分析师希望通过应用线性变换 $\\mathbf{Y} = \\mathbf{A} \\mathbf{X}$（其中 $\\mathbf{A}$ 是一个 $2 \\times 2$ 的实数矩阵）来构建一对新变量，称为主成分，$\\mathbf{Y} = \\begin{pmatrix} Y_1 \\\\ Y_2 \\end{pmatrix}$。该变换必须满足以下三个条件：\n1.  新变量 $Y_1$ 和 $Y_2$ 必须不相关。\n2.  变换矩阵 $\\mathbf{A}$ 必须是正交矩阵。\n3.  为确保解的唯一性，$Y_1$ 的方差必须大于或等于 $Y_2$ 的方差，并且矩阵 $\\mathbf{A}$ 的每一行的第一个元素都必须是非负的。\n\n确定变换矩阵 $\\mathbf{A}$。", "solution": "我们寻求一个线性变换 $\\mathbf{Y}=\\mathbf{A}\\mathbf{X}$，其中 $\\mathbf{A}$ 是一个 $2\\times 2$ 的实数矩阵，使得：\n- $Y_{1}$ 和 $Y_{2}$ 不相关，即 $\\operatorname{Cov}(\\mathbf{Y})=\\mathbf{A}\\Sigma\\mathbf{A}^{\\top}$ 是对角矩阵。\n- $\\mathbf{A}$ 是正交的，即 $\\mathbf{A}\\mathbf{A}^{\\top}=\\mathbf{I}$。\n- $\\operatorname{Var}(Y_{1})\\geq\\operatorname{Var}(Y_{2})$，并且 $\\mathbf{A}$ 的每一行的第一个元素是非负的。\n\n对于一个实对称协方差矩阵 $\\Sigma$，存在一个正交矩阵，其行是 $\\Sigma$ 的标准正交特征向量，并且该矩阵可以正交对角化 $\\Sigma$。因此，我们选择 $\\mathbf{A}$ 的行作为 $\\Sigma$ 的标准正交特征向量，并按特征值从大到小的顺序排列，使得第一个行向量对应较大的特征值。这样，$\\mathbf{A}\\Sigma\\mathbf{A}^{\\top}$ 就是一个对角矩阵，其对角线上的元素是特征值。\n\n通过特征方程计算 $\\Sigma=\\begin{pmatrix}13 & -4 \\\\ -4 & 7\\end{pmatrix}$ 的特征值：\n$$\n\\det(\\Sigma-\\lambda \\mathbf{I})=\\det\\begin{pmatrix}13-\\lambda & -4 \\\\ -4 & 7-\\lambda\\end{pmatrix}\n=(13-\\lambda)(7-\\lambda)-16\n=\\lambda^{2}-20\\lambda+75=0.\n$$\n因此\n$$\n\\lambda_{1,2}=\\frac{20\\pm\\sqrt{400-300}}{2}=\\frac{20\\pm 10}{2},\n$$\n所以特征值为 $\\lambda_{1}=15$ 和 $\\lambda_{2}=5$，其中 $\\lambda_{1}>\\lambda_{2}$。\n\n通过求解 $(\\Sigma-15\\mathbf{I})\\mathbf{v}=\\mathbf{0}$ 找到对应于 $\\lambda_{1}=15$ 的特征向量：\n$$\n\\begin{pmatrix}-2 & -4 \\\\ -4 & -8\\end{pmatrix}\\begin{pmatrix}x \\\\ y\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n\\implies -2x-4y=0 \\implies x=-2y.\n$$\n一个特征向量是 $\\begin{pmatrix}-2 \\\\ 1\\end{pmatrix}$。为满足符号约定（第一个元素非负），乘以 $-1$ 得到 $\\begin{pmatrix}2 \\\\ -1\\end{pmatrix}$。归一化至单位长度：\n$$\n\\left\\|\\begin{pmatrix}2 \\\\ -1\\end{pmatrix}\\right\\|=\\sqrt{2^{2}+(-1)^{2}}=\\sqrt{5},\\quad\n\\mathbf{u}_{1}=\\begin{pmatrix}\\frac{2}{\\sqrt{5}} \\\\ -\\frac{1}{\\sqrt{5}}\\end{pmatrix}.\n$$\n\n对于 $\\lambda_{2}=5$，求解 $(\\Sigma-5\\mathbf{I})\\mathbf{v}=\\mathbf{0}$：\n$$\n\\begin{pmatrix}8 & -4 \\\\ -4 & 2\\end{pmatrix}\\begin{pmatrix}x \\\\ y\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n\\implies 8x-4y=0 \\implies y=2x.\n$$\n一个特征向量是 $\\begin{pmatrix}1 \\\\ 2\\end{pmatrix}$，其第一个元素已经是非负的。归一化：\n$$\n\\left\\|\\begin{pmatrix}1 \\\\ 2\\end{pmatrix}\\right\\|=\\sqrt{1^{2}+2^{2}}=\\sqrt{5},\\quad\n\\mathbf{u}_{2}=\\begin{pmatrix}\\frac{1}{\\sqrt{5}} \\\\ \\frac{2}{\\sqrt{5}}\\end{pmatrix}.\n$$\n\n选择这些标准正交特征向量作为 $\\mathbf{A}$ 的行，并按顺序排列，使得第一行对应于较大的特征值 $\\lambda_{1}=15$，从而确保 $\\operatorname{Var}(Y_{1})\\geq\\operatorname{Var}(Y_{2})$。因此\n$$\n\\mathbf{A}=\\begin{pmatrix}\n\\frac{2}{\\sqrt{5}} & -\\frac{1}{\\sqrt{5}} \\\\\n\\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}}\n\\end{pmatrix}.\n$$\n这个矩阵 $\\mathbf{A}$ 是正交的（其行是标准正交的），每一行的第一个元素都是非负的，并且可以得到\n$$\n\\operatorname{Cov}(\\mathbf{Y})=\\mathbf{A}\\Sigma\\mathbf{A}^{\\top}=\\begin{pmatrix}15 & 0 \\\\ 0 & 5\\end{pmatrix},\n$$\n因此 $Y_{1}$ 和 $Y_{2}$ 不相关，且 $\\operatorname{Var}(Y_{1})>\\operatorname{Var}(Y_{2})$，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{\\sqrt{5}} & -\\frac{1}{\\sqrt{5}} \\\\ \\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}}\\end{pmatrix}}$$", "id": "1924285"}]}