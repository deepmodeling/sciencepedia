{"hands_on_practices": [{"introduction": "多变量正态分布的一个最基本也最强大的性质是，其分量的线性组合仍然服从正态分布。这个特性在金融、工程和生物医学等领域有广泛应用，因为它允许我们分析由多个相关变量构成的复合指标。本练习将通过一个经典的生物医学例子——计算脉压（收缩压与舒张压之差）的概率分布，来让你亲手实践这一核心概念。", "problem": "在一项大规模的流行病学研究中，个体收缩压（SBP）和舒张压（DBP）之间的关系使用二元正态分布进行建模。令随机变量 $X$ 代表收缩压，随机变量 $Y$ 代表舒张压，两者均以毫米汞柱（mmHg）为单位测量。特定人群的分布参数如下：\n\n- 平均收缩压为 $\\mu_X = 125$ mmHg。\n- 平均舒张压为 $\\mu_Y = 80$ mmHg。\n- 收缩压的标准差为 $\\sigma_X = 15$ mmHg。\n- 舒张压的标准差为 $\\sigma_Y = 10$ mmHg。\n- 收缩压和舒张压之间的相关系数为 $\\rho = 0.6$。\n\n心血管健康的一个关键临床指标是脉压，其定义为收缩压与舒张压之差。对于从该人群中随机选择的一个个体，计算其脉压大于 55 mmHg 的概率。将最终答案表示为四位有效数字的小数。", "solution": "设 $X$ 和 $Y$ 联合服从正态分布，其均值分别为 $\\mu_{X}$ 和 $\\mu_{Y}$，标准差分别为 $\\sigma_{X}$ 和 $\\sigma_{Y}$，相关系数为 $\\rho$。对于任何线性组合 $Z = aX + bY$，$Z$ 服从正态分布，其参数为\n$$\n\\mu_{Z} = a\\mu_{X} + b\\mu_{Y}, \\quad \\sigma_{Z}^{2} = a^{2}\\sigma_{X}^{2} + b^{2}\\sigma_{Y}^{2} + 2ab\\,\\rho\\,\\sigma_{X}\\sigma_{Y}.\n$$\n将脉压定义为 $Z = X - Y$（因此 $a=1$, $b=-1$）。那么\n$$\n\\mu_{Z} = \\mu_{X} - \\mu_{Y}, \\quad \\sigma_{Z}^{2} = \\sigma_{X}^{2} + \\sigma_{Y}^{2} - 2\\rho\\,\\sigma_{X}\\sigma_{Y}.\n$$\n代入给定参数，\n$$\n\\mu_{Z} = 125 - 80 = 45, \\quad \\sigma_{Z}^{2} = 15^{2} + 10^{2} - 2(0.6)(15)(10) = 225 + 100 - 180 = 145.\n$$\n因此 $Z \\sim \\mathcal{N}(45, 145)$。我们感兴趣的概率是\n$$\n\\mathbb{P}(Z > 55) = \\mathbb{P}\\!\\left(\\frac{Z - \\mu_{Z}}{\\sigma_{Z}} > \\frac{55 - 45}{\\sqrt{145}}\\right) = 1 - \\Phi\\!\\left(\\frac{10}{\\sqrt{145}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。数值上，$\\frac{10}{\\sqrt{145}} \\approx 0.8304548$，得出\n$$\n\\mathbb{P}(Z > 55) \\approx 1 - \\Phi(0.8304548) \\approx 0.2031,\n$$\n四舍五入到四位有效数字。", "answer": "$$\\boxed{0.2031}$$", "id": "1939198"}, {"introduction": "当处理多维数据时，简单的欧几里得距离可能无法准确衡量一个数据点与分布中心的“真实”偏差，因为它忽略了变量间的相关性。马氏距离 (Mahalanobis distance) 通过引入协方差矩阵，提供了一种更稳健的度量方式，它考虑了数据分布的形状。通过这个在制造业质量控制背景下的练习，你将学会如何计算马氏距离，并直观地理解它在识别异常点和衡量统计偏差方面的重要性。", "problem": "在一个用于定制电子电路的高精度制造过程中，测量了一个特殊电容器的两个关键性能特征：其电容 $X_1$ 和其等效串联电阻 (ESR) $X_2$。从大量的历史数据中得知，这些测量的向量 $\\mathbf{X} = [X_1, X_2]^T$ 服从二元正态分布。\n\n该过程的目标均值向量由下式给出：\n$$ \\boldsymbol{\\mu} = \\begin{pmatrix} 120.0 \\\\ 25.0 \\end{pmatrix} $$\n其中 $X_1$ 的单位是皮法 (pF)，$X_2$ 的单位是毫欧 (m$\\Omega$)。\n\n这两个特征的协方差矩阵为：\n$$ \\boldsymbol{\\Sigma} = \\begin{pmatrix} 16.0 & -6.0 \\\\ -6.0 & 9.0 \\end{pmatrix} $$\n其中对角线元素的单位分别为 $(\\text{pF})^2$ 和 $(\\text{m}\\Omega)^2$，非对角线元素的单位为 $\\text{pF} \\cdot \\text{m}\\Omega$。\n\n从生产线上取下一个电容器进行质量控制测试，其测得的特征为 $x_1 = 117.0$ pF 和 $x_2 = 28.0$ m$\\Omega$。为了在考虑其特征之间相关性的情况下，量化该特定组件偏离理想生产均值的程度，你需要计算它与均值之间的马氏距离 (Mahalanobis distance)。\n\n计算被测电容器的马氏距离。将你的最终答案四舍五入到三位有效数字。", "solution": "观测值 $\\mathbf{x}$ 与均值 $\\boldsymbol{\\mu}$（协方差矩阵为 $\\boldsymbol{\\Sigma}$）之间的马氏距离 (Mahalanobis distance) 定义为\n$$\nd = \\sqrt{(\\mathbf{x} - \\boldsymbol{\\mu})^{T}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x} - \\boldsymbol{\\mu})}.\n$$\n当 $\\mathbf{x} = \\begin{pmatrix} 117.0 \\\\ 28.0 \\end{pmatrix}$ 且 $\\boldsymbol{\\mu} = \\begin{pmatrix} 120.0 \\\\ 25.0 \\end{pmatrix}$ 时，偏差向量为\n$$\n\\mathbf{\\delta} = \\mathbf{x} - \\boldsymbol{\\mu} = \\begin{pmatrix} 117.0 - 120.0 \\\\ 28.0 - 25.0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 3 \\end{pmatrix}.\n$$\n对于协方差矩阵\n$$\n\\boldsymbol{\\Sigma} = \\begin{pmatrix} 16.0 & -6.0 \\\\ -6.0 & 9.0 \\end{pmatrix},\n$$\n其逆矩阵可使用 $2\\times 2$ 逆矩阵公式求得。行列式为\n$$\n\\det(\\boldsymbol{\\Sigma}) = (16.0)(9.0) - (-6.0)(-6.0) = 144 - 36 = 108,\n$$\n所以\n$$\n\\boldsymbol{\\Sigma}^{-1} = \\frac{1}{\\det(\\boldsymbol{\\Sigma})}\\begin{pmatrix} 9.0 & 6.0 \\\\ 6.0 & 16.0 \\end{pmatrix} = \\frac{1}{108}\\begin{pmatrix} 9 & 6 \\\\ 6 & 16 \\end{pmatrix}.\n$$\n计算二次型：\n$$\n\\boldsymbol{\\Sigma}^{-1}\\mathbf{\\delta} = \\frac{1}{108}\\begin{pmatrix} 9 & 6 \\\\ 6 & 16 \\end{pmatrix}\\begin{pmatrix} -3 \\\\ 3 \\end{pmatrix} = \\frac{1}{108}\\begin{pmatrix} -9 \\\\ 30 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{12} \\\\ \\frac{5}{18} \\end{pmatrix},\n$$\n接着\n$$\n(\\mathbf{\\delta})^{T}\\boldsymbol{\\Sigma}^{-1}\\mathbf{\\delta} = \\begin{pmatrix} -3 & 3 \\end{pmatrix}\\begin{pmatrix} -\\frac{1}{12} \\\\ \\frac{5}{18} \\end{pmatrix} = \\frac{1}{4} + \\frac{5}{6} = \\frac{13}{12}.\n$$\n因此，\n$$\nd = \\sqrt{\\frac{13}{12}} = \\frac{\\sqrt{39}}{6} \\approx 1.04083\\ldots\n$$\n四舍五入到三位有效数字得到 $1.04$。", "answer": "$$\\boxed{1.04}$$", "id": "1939259"}, {"introduction": "从分析转向综合，我们如何从零开始生成一个服从特定多变量正态分布的随机样本？这个问题在蒙特卡洛模拟、贝叶斯统计和机器学习中至关重要。其核心思想是，可以通过一个线性变换将独立的标准正态随机变量转化为具有特定均值和协方差结构的相关变量。本练习将指导你使用 Cholesky 分解法完成这一过程，为你搭建起从理论到计算实践的桥梁。", "problem": "在一个机械臂定位的模拟中，其末端坐标 $(x, y)$ 的误差被建模为一个随机向量 $\\boldsymbol{X} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$，该向量服从一个二元正态分布。该分布的均值向量 $\\boldsymbol{\\mu}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$ 分别为：\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} 5 \\\\ -2 \\end{pmatrix}, \\quad \\boldsymbol{\\Sigma} = \\begin{pmatrix} 4 & 1.2 \\\\ 1.2 & 9 \\end{pmatrix}\n$$\n为了生成这些误差的单个随机观测值，我们从一对独立的标准正态随机数开始，这些随机数是从标准正态分布 $N(0, 1)$ 中抽取的。假设在某一次特定的模拟运行中，这对标准正态随机数由向量 $\\boldsymbol{Z} = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ -1.5 \\end{pmatrix}$ 给出。\n\n你的任务是变换这个标准正态随机数向量 $\\boldsymbol{Z}$，以生成相应的随机观测向量 $\\boldsymbol{X}$，该向量服从指定的二元正态分布 $N(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$。\n\n计算向量 $\\boldsymbol{X}$ 的分量，并将你的答案以包含两个分量 $(x, y)$ 的行矩阵形式给出，结果四舍五入到三位有效数字。", "solution": "对于一个多元正态向量，我们可以通过仿射变换从 $\\boldsymbol{Z} \\sim N(\\boldsymbol{0}, \\boldsymbol{I})$ 生成 $X \\sim N(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$：\n$$\n\\boldsymbol{X}=\\boldsymbol{\\mu}+A\\boldsymbol{Z},\n$$\n其中 $A$ 满足 $A A^{\\mathsf{T}}=\\boldsymbol{\\Sigma}$。一个方便的选择是 Cholesky 因子 $L$，它是一个满足 $\\boldsymbol{\\Sigma}=L L^{\\mathsf{T}}$ 的下三角矩阵。\n\n设\n$$\n\\boldsymbol{\\mu}=\\begin{pmatrix}5\\\\-2\\end{pmatrix},\\quad\n\\boldsymbol{\\Sigma}=\\begin{pmatrix}4 & 1.2 \\\\ 1.2 & 9\\end{pmatrix},\\quad\n\\boldsymbol{Z}=\\begin{pmatrix}0.5 \\\\ -1.5\\end{pmatrix}.\n$$\n通过求解 $L L^{\\mathsf{T}}=\\boldsymbol{\\Sigma}$ 来计算 Cholesky 因子 $L=\\begin{pmatrix}l_{11}&0\\\\ l_{21}&l_{22}\\end{pmatrix}$：\n- 从 $l_{11}^{2}=4$ 可得 $l_{11}=2$。\n- 从 $l_{11}l_{21}=1.2$ 可得 $l_{21}=1.2/2=0.6$。\n- 从 $l_{21}^{2}+l_{22}^{2}=9$ 可得 $l_{22}^{2}=9-(0.6)^{2}=9-0.36=8.64$，因此 $l_{22}=\\sqrt{8.64} = \\sqrt{\\frac{216}{25}} = \\frac{6\\sqrt{6}}{5}$。\n\n因此\n$$\nL=\\begin{pmatrix}2 & 0\\\\ 0.6 & \\frac{6\\sqrt{6}}{5}\\end{pmatrix}.\n$$\n计算 $L\\boldsymbol{Z}$：\n$$\nL\\boldsymbol{Z}=\n\\begin{pmatrix}\n2 & 0\\\\\n0.6 & \\frac{6\\sqrt{6}}{5}\n\\end{pmatrix}\n\\begin{pmatrix} 0.5 \\\\ -1.5 \\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\cdot 0.5 + 0\\cdot(-1.5) \\\\\n0.6\\cdot 0.5 + \\frac{6\\sqrt{6}}{5}\\cdot(-1.5)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n0.3 - \\frac{9\\sqrt{6}}{5}\n\\end{pmatrix}.\n$$\n因此，\n$$\n\\boldsymbol{X}=\\boldsymbol{\\mu}+L\\boldsymbol{Z}\n=\n\\begin{pmatrix}\n5 \\\\ -2\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n1 \\\\ 0.3 - \\frac{9\\sqrt{6}}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n6 \\\\ -1.7 - \\frac{9\\sqrt{6}}{5}\n\\end{pmatrix}.\n$$\n数值上，$\\sqrt{6}\\approx 2.449489743$，所以\n$$\nx= 6,\\qquad y\\approx -1.7 - \\frac{9 \\times 2.449489743}{5} \\approx -6.1090815374.\n$$\n将每个分量四舍五入到三位有效数字，得到\n$$\nx\\approx 6.00,\\qquad y\\approx -6.11.\n$$\n因此所求的行矩阵是 $\\begin{pmatrix}6.00&-6.11\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}6.00 & -6.11\\end{pmatrix}}$$", "id": "1939256"}]}