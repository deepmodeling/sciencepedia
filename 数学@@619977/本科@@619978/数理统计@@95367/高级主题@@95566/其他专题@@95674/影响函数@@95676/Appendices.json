{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，计算泊松分布均值估计量的影响函数。这个练习是理解影响函数概念的理想起点，因为它直接关联于最常见的估计量——样本均值。通过这个实践，你将亲自推导出样本均值的影响函数是无界的，直观地揭示为什么单个极端异常值就能极大地扭曲估计结果。[@problem_id:1923520]", "problem": "考虑一组独立同分布的随机变量 $X_1, X_2, \\dots, X_n$，它们服从一个未知速率参数为 $\\lambda > 0$ 的泊松分布。该分布的概率质量函数为 $P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $k$ 为非负整数。一个泊松($\\lambda$)随机变量的期望值为 $E[X] = \\lambda$。\n\n$\\lambda$ 的矩估计量（记为 $\\hat{\\lambda}$）是通过令第一总体矩 $E[X]$ 等于第一样本矩 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n X_i$ 来求得的。这个估计过程可以由一个统计泛函 $T$ 表示，该泛函将一个累积分布函数（CDF）$G$ 映射到一个参数值。对于本问题，该泛函由 $G$ 分布下的期望值定义：$T(G) = \\int_{-\\infty}^{\\infty} x \\, dG(x)$。当将此泛函应用于数据的经验累积分布函数时，它将得到样本均值。\n\n影响函数（IF）衡量了在点 $x$ 处的一个无穷小污染对估计量的影响。对于一个泛函 $T$ 和一个真实的潜在分布 $F$，影响函数定义为：\n$$ \\text{IF}(x; T, F) = \\lim_{\\epsilon \\to 0^+} \\frac{T((1-\\epsilon)F + \\epsilon \\delta_x) - T(F)}{\\epsilon} $$\n其中 $\\delta_x$ 是在 $x$ 处的点质量的累积分布函数。\n\n你的任务是确定泊松($\\lambda$)分布参数 $\\lambda$ 的矩估计量的影响函数的解析形式。设 $F$ 为泊松($\\lambda$)分布的累积分布函数。你的答案需用变量 $x$ 和参数 $\\lambda$ 来表示。", "solution": "我们使用矩估计法来估计泊松参数，其中所用的泛函为均值：\n$$\nT(G) = \\int t \\, dG(t).\n$$\n对于一个泊松$(\\lambda)$随机变量的真实分布 $F$，我们有\n$$\nT(F) = \\int t \\, dF(t) = \\mathbb{E}_{F}[X] = \\lambda.\n$$\n为了计算在点 $x$ 处的影响函数，考虑受污染的分布\n$$\nG_{\\epsilon} = (1 - \\epsilon)F + \\epsilon \\delta_{x},\n$$\n其中 $\\epsilon \\in (0,1)$ 且 $\\delta_{x}$ 是在 $x$ 处的点质量。根据积分的线性性质，\n$$\nT(G_{\\epsilon}) = \\int t \\, dG_{\\epsilon}(t) = (1 - \\epsilon) \\int t \\, dF(t) + \\epsilon \\int t \\, d\\delta_{x}(t) = (1 - \\epsilon)\\lambda + \\epsilon x = \\lambda + \\epsilon(x - \\lambda).\n$$\n因此，\n$$\n\\text{IF}(x; T, F) = \\lim_{\\epsilon \\to 0^{+}} \\frac{T(G_{\\epsilon}) - T(F)}{\\epsilon} = \\lim_{\\epsilon \\to 0^{+}} \\frac{\\lambda + \\epsilon(x - \\lambda) - \\lambda}{\\epsilon} = x - \\lambda.\n$$\n因此，在泊松$(\\lambda)$模型下，$\\lambda$ 的矩估计量（即样本均值）的影响函数是 $x - \\lambda$。", "answer": "$$\\boxed{x-\\lambda}$$", "id": "1923520"}, {"introduction": "在掌握了单个估计量的影响函数计算后，一个自然而然的进阶步骤是比较不同统计量对异常值的敏感度。本练习将引导你分析和对比标准正态分布下样本均值和样本方差的影响函数。这个对比极具启发性，它将揭示为何样本方差对异常值的反应甚至比样本均值更为剧烈，其影响呈二次方增长，这对于评估数据分析中不同统计指标的稳健性至关重要。[@problem_id:1923527]", "problem": "在稳健统计中，影响函数是分析单个观测值对统计估计量影响的关键工具。对于一个统计泛函 $T$ 和一个累积分布函数（CDF）为 $F$ 的目标分布，其在点 $x$ 处的影响函数定义为：\n$$ IF(x; T, F) = \\lim_{\\epsilon \\to 0} \\frac{T((1-\\epsilon)F + \\epsilon \\delta_x) - T(F)}{\\epsilon} $$\n其中 $\\delta_x$ 表示将其所有质量集中在点 $x$ 处的分布的CDF。该函数衡量了泛函 $T$ 对点 $x$ 处无穷小污染的敏感度。\n\n考虑两个基本的统计估计量：均值和方差。它们对应的泛函分别是期望值，$T_{\\mu}(F) = \\int_{-\\infty}^{\\infty} y \\, dF(y)$，和方差，$T_{\\sigma^2}(F) = \\int_{-\\infty}^{\\infty} (y - T_{\\mu}(F))^2 \\, dF(y)$。\n\n让我们在标准正态分布（记为 $F=\\Phi$，其均值为0，方差为1）的背景下分析这些泛函。设 $IF_{\\mu}(x)$ 表示均值的影响函数，$IF_{\\sigma^2}(x)$ 表示方差的影响函数，两者都是相对于标准正态分布计算的。\n\n下列哪个陈述准确地描述了 $IF_{\\mu}(x)$ 和 $IF_{\\sigma^2}(x)$ 的性质？\n\nA. $IF_{\\mu}(x)$ 和 $IF_{\\sigma^2}(x)$ 都是有界函数，表明均值和方差都是稳健估计量。\n\nB. $IF_{\\mu}(x)$ 是 $x$ 的偶函数（即 $IF_{\\mu}(-x) = IF_{\\mu}(x)$），而 $IF_{\\sigma^2}(x)$ 是 $x$ 的奇函数（即 $IF_{\\sigma^2}(-x) = -IF_{\\sigma^2}(x)$）。\n\nC. 位于分布中心（$x=0$）的观测值对均值的估计没有影响，但它倾向于减小方差的估计。\n\nD. 当 $|x|$ 很大时，离群值对方差估计量的影响的增长速度慢于其对均值估计量的影响。\n\nE. 对于任意实数 $x$，这两个影响函数都总是非负的。", "solution": "我们使用影响函数的定义。对于任意泛函 $T$ 和分布 $F$，定义 $G_{\\epsilon}=(1-\\epsilon)F+\\epsilon \\delta_{x}$ 并且\n$$\nIF(x;T,F)=\\lim_{\\epsilon \\to 0}\\frac{T(G_{\\epsilon})-T(F)}{\\epsilon}.\n$$\n\n均值泛函。设 $T_{\\mu}(F)=\\int y\\,dF(y)$ 并记 $\\mu=T_{\\mu}(F)$。那么\n$$\nT_{\\mu}(G_{\\epsilon})=(1-\\epsilon)\\int y\\,dF(y)+\\epsilon\\int y\\,d\\delta_{x}(y)=(1-\\epsilon)\\mu+\\epsilon x=\\mu+\\epsilon(x-\\mu).\n$$\n因此，\n$$\nIF_{\\mu}(x;F)=x-\\mu.\n$$\n对于标准正态分布 $F=\\Phi$，我们有 $\\mu=0$，因此\n$$\nIF_{\\mu}(x)=x.\n$$\n\n方差泛函。设 $T_{\\sigma^{2}}(F)=\\int (y-\\mu)^{2}\\,dF(y)$，其中 $\\mu=T_{\\mu}(F)$，并记 $\\sigma^{2}=T_{\\sigma^{2}}(F)$。对于 $G_{\\epsilon}$，其均值为\n$$\n\\mu_{\\epsilon}=T_{\\mu}(G_{\\epsilon})=\\mu+\\epsilon(x-\\mu).\n$$\n那么\n$$\nT_{\\sigma^{2}}(G_{\\epsilon})=\\int (y-\\mu_{\\epsilon})^{2}\\,dG_{\\epsilon}(y)=(1-\\epsilon)\\int (y-\\mu_{\\epsilon})^{2}\\,dF(y)+\\epsilon(x-\\mu_{\\epsilon})^{2}.\n$$\n对 $\\epsilon$ 展开至一阶。首先，\n$$\n\\int (y-\\mu_{\\epsilon})^{2}\\,dF(y)=\\int \\big[(y-\\mu)-\\epsilon(x-\\mu)\\big]^{2}\\,dF(y)\n=\\int (y-\\mu)^{2}\\,dF(y)-2\\epsilon(x-\\mu)\\int (y-\\mu)\\,dF(y)+O(\\epsilon^{2})\n=\\sigma^{2}+O(\\epsilon^{2}),\n$$\n因为 $\\int (y-\\mu)\\,dF(y)=0$。接下来，\n$$\n(x-\\mu_{\\epsilon})^{2}=\\big[(x-\\mu)-\\epsilon(x-\\mu)\\big]^{2}=(x-\\mu)^{2}-2\\epsilon(x-\\mu)^{2}+O(\\epsilon^{2}).\n$$\n因此，\n$$\nT_{\\sigma^{2}}(G_{\\epsilon})=(1-\\epsilon)\\big[\\sigma^{2}+O(\\epsilon^{2})\\big]+\\epsilon\\big[(x-\\mu)^{2}-2\\epsilon(x-\\mu)^{2}+O(\\epsilon^{2})\\big]\n=\\sigma^{2}+\\epsilon\\big[(x-\\mu)^{2}-\\sigma^{2}\\big]+O(\\epsilon^{2}),\n$$\n由此可得\n$$\nIF_{\\sigma^{2}}(x;F)=(x-\\mu)^{2}-\\sigma^{2}.\n$$\n对于标准正态分布，$\\mu=0$ 且 $\\sigma^{2}=1$，所以\n$$\nIF_{\\sigma^{2}}(x)=x^{2}-1.\n$$\n\n现在使用 $IF_{\\mu}(x)=x$ 和 $IF_{\\sigma^{2}}(x)=x^{2}-1$ 来评估这些陈述：\n- 两者都是无界函数，所以A是错误的。\n- $IF_{\\mu}$ 是奇函数，不是偶函数；$IF_{\\sigma^{2}}$ 是偶函数，不是奇函数；因此B是错误的。\n- 在 $x=0$ 处，$IF_{\\mu}(0)=0$ 而 $IF_{\\sigma^{2}}(0)=-1<0$，所以位于中心的观测值对均值没有影响，并倾向于减小方差；C是正确的。\n- 当 $|x|$ 很大时，$|IF_{\\mu}(x)|\\sim |x|$ 而 $|IF_{\\sigma^{2}}(x)|\\sim x^{2}$，后者增长得更快，而不是更慢；D是错误的。\n- 符号不总是非负的（例如，对于均值，当 $x<0$ 时；对于方差，当 $|x|<1$ 时），所以E是错误的。\n\n因此，正确选项是C。", "answer": "$$\\boxed{C}$$", "id": "1923527"}, {"introduction": "前面练习揭示了传统估计量（如均值和方差）影响函数的无界性，这正是它们在异常值面前表现脆弱的根本原因。为了解决这个问题，统计学家开发了稳健估计量。本练习将向你介绍一类重要的稳健估计方法——M-估计量，特别是使用Tukey双权函数（Tukey's biweight）的例子。通过这个实践，你将探索如何构造一个有界的影响函数，使得估计量能够自动“忽略”远离数据中心的极端值，从而实现稳健性。[@problem_id:1923553]", "problem": "在稳健统计学中，M-估计量是一大类对异常值具有抵抗性的位置参数估计量。对于一个数据集 $\\{x_1, \\dots, x_n\\}$，位置M-估计量 $T_n$ 定义为使目标函数 $\\sum_{i=1}^n \\rho(x_i - t)$ 最小化的值 $t$，其中 $\\rho$ 是一个对称的非负损失函数。等价地，$T_n$ 是隐式方程 $\\sum_{i=1}^n \\psi(x_i - t) = 0$ 的一个解，其中 $\\psi(x) = \\frac{d\\rho(x)}{dx}$ 是得分函数。\n\n估计量 $T$ 在分布 $F$ 上的影响函数 $IF(x; T, F)$ 衡量了在点 $x$ 处的一个无穷小的污染对估计值的影响。对于一个带有得分函数 $\\psi$ 的M-估计量，当其在一个关于真实位置参数对称的分布 $F$（不失一般性地，我们可以假设该参数为0）上进行评估时，其影响函数与得分函数成正比：$IF(x; T, F) \\propto \\psi(x)$。\n\n为了完全拒绝极端异常值，我们使用“降回”M-估计量，对于这类估计量，当观测值离中心足够远时，其影响函数为零。这意味着它们的得分函数 $\\psi(x)$ 对于大于某个正常数 $k$ 的 $|x|$ 必须为零。最常见的降回得分函数之一是Tukey's biweight（或bisquare）函数，定义如下：\n$$\n\\psi_k(x) = \\begin{cases}\nx \\left(1 - \\left(\\frac{x}{k}\\right)^2\\right)^2 & \\text{if } |x| \\leq k \\\\\n0 & \\text{if } |x| > k\n\\end{cases}\n$$\n相应的损失函数 $\\rho_k(x)$ 是通过对得分函数积分得到的，并满足条件 $\\rho_k(0) = 0$。对于一个降回M-估计量，其损失函数 $\\rho_k(x)$ 是有界的，这意味着当 $|x|>k$ 时，它变为一个常数。\n\n我们希望通过将其损失函数的最大可能值 $\\sup_{x \\in \\mathbb{R}} \\rho_k(x)$ 设为1来对此估计量进行归一化。请确定实现此归一化的正常数 $k$ 的值。", "solution": "问题要求解出Tukey's biweight M-估计量的正常数 $k$ 的值，使得其损失函数 $\\rho_k(x)$ 的最大值等于1。\n\n得分函数由下式给出：\n$$\n\\psi_k(x) = \\begin{cases}\nx \\left(1 - \\left(\\frac{x}{k}\\right)^2\\right)^2 & \\text{if } |x| \\leq k \\\\\n0 & \\text{if } |x| > k\n\\end{cases}\n$$\n损失函数 $\\rho_k(x)$ 与得分函数 $\\psi_k(x)$ 的关系为 $\\psi_k(x) = \\frac{d\\rho_k(x)}{dx}$。我们可以通过对 $\\psi_k(u)$ 从0到 $x$ 积分来求得 $\\rho_k(x)$，并使用条件 $\\rho_k(0) = 0$。\n$$\n\\rho_k(x) = \\int_0^x \\psi_k(u) du\n$$\n我们首先展开当 $|u| \\leq k$ 时 $\\psi_k(u)$ 的表达式：\n$$\n\\psi_k(u) = u \\left(1 - \\frac{2u^2}{k^2} + \\frac{u^4}{k^4}\\right) = u - \\frac{2u^3}{k^2} + \\frac{u^5}{k^4}\n$$\n现在，我们对这个多项式积分，以求得在区间 $|x| \\leq k$ 上的 $\\rho_k(x)$。\n$$\n\\rho_k(x) = \\int_0^x \\left(u - \\frac{2u^3}{k^2} + \\frac{u^5}{k^4}\\right) du\n$$\n$$\n\\rho_k(x) = \\left[ \\frac{u^2}{2} - \\frac{2u^4}{4k^2} + \\frac{u^6}{6k^4} \\right]_0^x\n$$\n$$\n\\rho_k(x) = \\frac{x^2}{2} - \\frac{x^4}{2k^2} + \\frac{x^6}{6k^4} \\quad \\text{for } |x| \\leq k\n$$\n对于 $|x| > k$，得分函数 $\\psi_k(x)$ 为0。这意味着损失函数 $\\rho_k(x)$ 不再变化。因此，当 $x > k$ 时，$\\rho_k(x)$ 的值是一个常数，等于它在 $x=k$ 处的值。\n$$\n\\rho_k(x) = \\int_0^x \\psi_k(u) du = \\int_0^k \\psi_k(u) du + \\int_k^x 0 \\, du = \\int_0^k \\psi_k(u) du = \\rho_k(k)\n$$\n由于 $\\rho_k(x)$ 是一个偶函数，同样的结果也适用于 $x < -k$ 的情况，此时 $\\rho_k(x) = \\rho_k(-k) = \\rho_k(k)$。\n函数 $\\rho_k(x)$ 在 $x \\ge 0$ 上是非递减的，因为它的导数 $\\psi_k(x) = x(1-(x/k)^2)^2$ 在 $x \\in [0, k]$ 上是非负的。因此，$\\rho_k(x)$ 的最大值在任意满足 $|x| \\ge k$ 的点处取得，且等于 $\\rho_k(k)$。\n$$\n\\rho_{\\max} = \\sup_{x \\in \\mathbb{R}} \\rho_k(x) = \\rho_k(k)\n$$\n我们可以将 $x=k$ 代入 $\\rho_k(x)$ 的表达式来求得这个最大值：\n$$\n\\rho_{\\max} = \\frac{k^2}{2} - \\frac{k^4}{2k^2} + \\frac{k^6}{6k^4}\n$$\n$$\n\\rho_{\\max} = \\frac{k^2}{2} - \\frac{k^2}{2} + \\frac{k^2}{6}\n$$\n$$\n\\rho_{\\max} = \\frac{k^2}{6}\n$$\n题目要求将此最大值归一化为1。\n$$\n\\rho_{\\max} = 1\n$$\n$$\n\\frac{k^2}{6} = 1\n$$\n解出 $k$：\n$$\nk^2 = 6\n$$\n由于 $k$ 被定义为一个正常数，我们取其正平方根。\n$$\nk = \\sqrt{6}\n$$\n因此，使最大损失归一化为1的常数 $k$ 的值为 $\\sqrt{6}$。", "answer": "$$\\boxed{\\sqrt{6}}$$", "id": "1923553"}]}