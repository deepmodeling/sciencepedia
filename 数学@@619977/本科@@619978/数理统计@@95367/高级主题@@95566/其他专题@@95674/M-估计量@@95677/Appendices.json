{"hands_on_practices": [{"introduction": "M估计量理论的一个美妙之处在于它将许多我们熟知的统计量统一在一个通用框架下。这个练习将从一个最基础的M估计量入手，其定义函数为绝对值函数 $\\rho(u) = |u|$。通过解决这个问题，你将亲手验证一个重要的结论：在这种情况下，M估计量便是样本中位数，这为你理解M估计量如何推广经典统计概念提供了一个坚实的起点。[@problem_id:1932002]", "problem": "在稳健统计学中，M-估计量为定义位置估计量提供了一个通用框架。对于给定的数据样本 $\\{x_1, x_2, \\dots, x_n\\}$ 和一个选定的凸函数 $\\rho$，位置的M-估计量（记为 $\\hat{\\theta}$）是使目标函数 $S(\\theta) = \\sum_{i=1}^n \\rho(x_i - \\theta)$ 最小化的 $\\theta$ 值。\n\n考虑一个由绝对值函数 $\\rho(u) = |u|$ 定义的M-估计量。计算该M-估计量对于数据样本 $X = \\{2.5, 9.8, 15.1, 4.0, 21.3\\}$ 的值。将你的答案表示为单个数字。", "solution": "对于 $\\rho(u)=|u|$，我们得到M-估计量的目标函数为\n$$\nS(\\theta)=\\sum_{i=1}^{n} |x_{i}-\\theta|.\n$$\n由于 $|\\,\\cdot\\,|$ 是凸函数，因此 $S(\\theta)$ 关于 $\\theta$ 是凸的。$\\hat{\\theta}$ 最小化 $S(\\theta)$ 的一个充分必要条件是次梯度最优性条件\n$$\n0 \\in \\partial S(\\theta)=\\sum_{i=1}^{n} \\partial |x_{i}-\\theta|.\n$$\n对于每一项，关于 $\\theta$ 的次梯度是\n$$\n\\partial |x_{i}-\\theta|=\n\\begin{cases}\n\\{-1\\},  \\theta  x_{i},\\\\\n[-1,1],  \\theta = x_{i},\\\\\n\\{1\\},  \\theta  x_{i}.\n\\end{cases}\n$$\n令 $L(\\theta)$ 为严格小于 $\\theta$ 的 $x_i$ 的数量，$G(\\theta)$ 为严格大于 $\\theta$ 的 $x_i$ 的数量，$E(\\theta)$ 为等于 $\\theta$ 的 $x_i$ 的数量。那么次梯度的和是一个区间\n$$\n\\partial S(\\theta)=\\left[\\, -L(\\theta)+G(\\theta)-E(\\theta),\\; -L(\\theta)+G(\\theta)+E(\\theta)\\,\\right].\n$$\n条件 $0 \\in \\partial S(\\theta)$ 等价于\n$$\n-L(\\theta)+G(\\theta) \\in [-E(\\theta),\\,E(\\theta)],\n$$\n这又等价于以下不等式对\n$$\nL(\\theta) \\leq \\frac{n}{2} \\quad \\text{and} \\quad G(\\theta) \\leq \\frac{n}{2}.\n$$\n因此，任何最小化子 $\\hat{\\theta}$ 都必须是样本的中位数。对于样本量 $n$ 为奇数且所有值都不同的情况，唯一的最小化子是样本中位数，即中间的顺序统计量。\n\n对于数据 $X=\\{2.5, 9.8, 15.1, 4.0, 21.3\\}$，将这些值排序可得\n$$\n2.5  4.0  9.8  15.1  21.3.\n$$\n当 $n=5$ 时，中位数是第三个顺序统计量，即 $9.8$。因此，由 $\\rho(u)=|u|$ 定义的M-估计量是\n$$\n\\hat{\\theta}=9.8.\n$$", "answer": "$$\\boxed{9.8}$$", "id": "1932002"}, {"introduction": "在众多M估计量中，Huber估计量因其在稳健性和效率之间的出色平衡而备受推崇。它通过对远离中心的数据点施加有限的“影响”而非完全忽略，从而有效抵御异常值的干扰。本练习将带你计算一个具体数据集的Huber估计量，让你掌握其核心思想——如何通过求解以Huber $\\psi$ 函数定义的方程，得到一个对异常值不敏感的位置估计。[@problem_id:1952425]", "problem": "在稳健统计学中，M-估计量是一大类对离群值稳健的估计量。对于一个数据集 $\\{x_1, x_2, \\ldots, x_n\\}$，其位置M-估计量（记为 $\\hat{\\theta}$）被定义为以下方程的解：\n$$\n\\sum_{i=1}^{n} \\psi\\left(\\frac{x_i - \\theta}{S}\\right) = 0\n$$\n其中 $S$ 是一个稳健的尺度估计，而 $\\psi$ 是一个所选的影响函数。\n\n考虑 Huber $\\psi$-函数，它为给定的调节常数 $k  0$ 定义如下：\n$$\n\\psi_k(u) = \\begin{cases}\n-k  \\text{若 } u  -k \\\\\nu  \\text{若 } |u| \\leq k \\\\\nk  \\text{若 } u > k\n\\end{cases}\n$$\n该函数通过在 $\\pm k$ 处对大残差进行“截断”来限制其影响。\n\n一位工程师正在分析一组关于某组件长度的五个独立测量值。得到的测量值如下：\n$$\n\\{2.1, 2.5, 2.3, 2.6, 4.5\\}\n$$\n为了获得一个不过分受单个大值影响的位置估计，该工程师决定使用M-估计量。计算时，将使用固定的尺度估计 $S=1$ 和调节常数 $k=1.5$。\n\n计算该数据集的位置M-估计值 $\\hat{\\theta}$。请将答案四舍五入到三位有效数字。", "solution": "我们求解M-估计方程以求得 $\\hat{\\theta}$：\n$$\n\\sum_{i=1}^{5} \\psi_{k}\\!\\left(\\frac{x_{i}-\\theta}{S}\\right)=0,\n$$\n其中 $S=1$，$k=1.5$，且 $x=\\{2.1,2.5,2.3,2.6,4.5\\}$。当 $S=1$ 时，方程变为\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=0,\n$$\n其中 Huber 函数为：当 $|u|\\leq k$ 时 $\\psi_{k}(u)=u$；当 $|u|k$ 时 $\\psi_{k}(u)=\\pm k$ (符号与 $u$ 相同)。\n\n对于每个 $x_i$，当 $|x_{i}-\\theta|\\leq 1.5$ 时，该项是线性的（即未被截断），等价于 $\\theta\\in[x_{i}-1.5,\\,x_{i}+1.5]$。这些区间是：\n- $x_{1}=2.1$: $\\theta\\in[0.6,\\,3.6]$,\n- $x_{2}=2.5$: $\\theta\\in[1.0,\\,4.0]$,\n- $x_{3}=2.3$: $\\theta\\in[0.8,\\,3.8]$,\n- $x_{4}=2.6$: $\\theta\\in[1.1,\\,4.1]$,\n- $x_{5}=4.5$: $\\theta\\in[3.0,\\,6.0]$.\n\n考虑 $\\theta\\in[1.1,3.0)$ 的情况，此时前四项是线性的，而第五项由于 $4.5-\\theta1.5$ 被截断为 $+1.5$。于是，\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=\\sum_{i=1}^{4} (x_{i}-\\theta) + 1.5.\n$$\n使用 $\\sum_{i=1}^{4} x_{i}=2.1+2.5+2.3+2.6=9.5$，我们得到\n$$\n9.5 - 4\\theta + 1.5 = 0 \\;\\;\\Longrightarrow\\;\\; 11 - 4\\theta = 0 \\;\\;\\Longrightarrow\\;\\; \\hat{\\theta}=\\frac{11}{4}=2.75.\n$$\n检验在 $\\hat{\\theta}=2.75$ 处解的自洽性：\n- 对于 $x_{1},x_{2},x_{3},x_{4}$，我们有 $|x_{i}-\\hat{\\theta}|\\in\\{0.65,0.25,0.45,0.15\\}\\leq 1.5$，因此将它们作为线性项处理是正确的。\n- 对于 $x_{5}$，我们有 $|4.5-2.75|=1.751.5$，因此将其截断为 $+1.5$ 是正确的。\n\n因此，该解在此区域内是有效且唯一的。四舍五入到三位有效数字，结果为 $2.75$。", "answer": "$$\\boxed{2.75}$$", "id": "1952425"}, {"introduction": "更进一步，一些被称为“降回估计量”(redescending estimators)的M估计量会完全忽略极端异常值，这在某些情况下非常有效。然而，这种特性也带来了一个挑战：估计方程可能存在多个解。这个进阶练习旨在揭示这一复杂性，并指导你如何通过比较不同解对应的目标函数 $\\sum \\rho(x_i - \\theta)$ 的值，来确定真正的最优估计，从而加深对M估计量最小化本质的理解。[@problem_id:1931970]", "problem": "在稳健统计学中，M-估计量是用于估计位置参数 $\\theta$ 的一类广泛的估计量，它们通过最小化一个关于残差的函数之和来获得，或者等价地，作为某个方程的解。\n\n考虑一个用于数据集 $\\{x_1, \\dots, x_n\\}$ 的位置M-估计量 $T_n$。它被定义为以下方程关于 $\\theta$ 的解：\n$$ \\sum_{i=1}^{n} \\psi(x_i - \\theta) = 0 $$\n其中 $\\psi$ 是一个选定的函数。\n\n在一个特定的应用中，一位统计学家使用以下分段 $\\psi$-函数设计了一个自定义的M-估计量，该函数旨在忽略远离中心趋势的观测值：\n$$\n\\psi(u) =\n\\begin{cases}\nu  \\text{若 } |u| \\leq c \\\\\n0  \\text{若 } |u|  c\n\\end{cases}\n$$\n常数 $c$ 是一个调节参数，用于控制稳健性的程度。\n\n给定数据集 $X = \\{10, 12, 13, 15, 19, 20, 40\\}$ 和调节参数 $c=4$，计算M-估计量 $T_n$ 的值。将最终答案四舍五入至四位有效数字。", "solution": "我们求解 $T_{n}$ 以满足估计方程 $\\sum_{i=1}^{n} \\psi(x_{i}-\\theta)=0$。对于 $c=4$，所用的 $\\psi$ 函数为：\n$$\n\\psi(u)=\\begin{cases}u  \\text{若 } |u|\\leq 4 \\\\ 0  \\text{若 } |u|4 \\end{cases}\n$$\n对于数据 $X=\\{10,12,13,15,19,20,40\\}$。记指示函数 $I_{i}(\\theta)=\\mathbf{1}\\{|x_{i}-\\theta|\\leq 4\\}$，则估计方程为：\n$$\n\\sum_{i=1}^{n} (x_{i}-\\theta) I_{i}(\\theta)=0 \\quad \\Longleftrightarrow \\quad \\theta \\sum_{i=1}^{n} I_{i}(\\theta)=\\sum_{i=1}^{n} x_{i} I_{i}(\\theta).\n$$\n如果 $m(\\theta)=\\sum_{i=1}^{n} I_{i}(\\theta)\\geq 1$，这等价于不动点方程：\n$$\n\\theta=\\frac{\\sum_{i=1}^{n} x_{i} I_{i}(\\theta)}{\\sum_{i=1}^{n} I_{i}(\\theta)},\n$$\n即 $\\theta$ 等于那些与 $\\theta$ 相差不超过4的 $x_{i}$ 的均值。包含条件 $|x_{i}-\\theta|\\leq 4$ 等价于 $\\theta\\in[x_{i}-4,x_{i}+4]$。对于给定的数据，这些区间为：\n$$\n\\begin{aligned}\n10:\\ [6,14],\\quad 12:\\ [8,16],\\quad 13:\\ [9,17],\\quad 15:\\ [11,19],\\\\\n19:\\ [15,23],\\quad 20:\\ [16,24],\\quad 40:\\ [36,44].\n\\end{aligned}\n$$\n在连续的端点之间，所包含的集合 $S(\\theta)=\\{i: \\theta\\in[x_{i}-4,x_{i}+4]\\}$ 是常数，并且在此类区间内的任何解都必须等于相应 $x_{i}$ 的均值，同时该解也必须位于该区间内。检验这些区间可得到以下自洽解：\n- 对于 $\\theta\\in(11,14)$，$S=\\{10,12,13,15\\}$，均值 $=\\frac{10+12+13+15}{4}=12.5$，且 $12.5\\in(11,14)$，因此 $\\theta=12.5$ 是一个解。\n- 对于 $\\theta\\in(16,17)$，$S=\\{13,15,19,20\\}$，均值 $=\\frac{13+15+19+20}{4}=16.75$，且 $16.75\\in(16,17)$，因此 $\\theta=16.75$ 是一个解。\n- 对于 $\\theta\\in(17,19)$，$S=\\{15,19,20\\}$，均值 $=\\frac{15+19+20}{3}=18$，且 $18\\in(17,19)$，因此 $\\theta=18$ 是一个解。\n- 对于 $\\theta\\in(19,23)$，$S=\\{19,20\\}$，均值 $=\\frac{19+20}{2}=19.5$，且 $19.5\\in(19,23)$，因此 $\\theta=19.5$ 是一个解。\n- 对于 $\\theta\\in(36,44)$，$S=\\{40\\}$，均值 $=40$，且 $40\\in(36,44)$，因此 $\\theta=40$ 是一个解。\n\n因为 $\\psi$ 函数递降为零，所以估计方程可以有多个根。相应的M-估计量被定义为目标函数 $\\rho$ 的最小化子，其中 $\\rho$ 满足 $\\rho'(u)=\\psi(u)$。通过积分，\n$$\n\\rho(u)=\\int_{0}^{u} \\psi(t)\\,dt=\\begin{cases}\\frac{u^{2}}{2}  \\text{若 } |u|\\leq c\\\\ \\frac{c^{2}}{2}  \\text{若 } |u|c\\end{cases}\n$$\n当 $c=4$ 时，可得 $\\rho(u)=\\frac{u^{2}}{2}$ (若 $|u|\\leq 4$) 和 $\\rho(u)=8$ (若 $|u|4$ )。我们在候选根处计算 $\\sum_{i=1}^{n}\\rho(x_{i}-\\theta)$ 的值：\n\n- 当 $\\theta=12.5$ 时：残差 $(x_{i}-\\theta)$ 为 $-2.5,-0.5,0.5,2.5,6.5,7.5,27.5$，总和为\n$$\n\\frac{(-2.5)^{2}}{2}+\\frac{(-0.5)^{2}}{2}+\\frac{0.5^{2}}{2}+\\frac{2.5^{2}}{2}+8+8+8=3.125+0.125+0.125+3.125+24=30.5.\n$$\n- 当 $\\theta=16.75$ 时，总和为\n$$\n8+8+\\frac{(-3.75)^{2}}{2}+\\frac{(-1.75)^{2}}{2}+\\frac{2.25^{2}}{2}+\\frac{3.25^{2}}{2}+8=40.375.\n$$\n- 当 $\\theta=18$ 时，总和为\n$$\n8+8+8+\\frac{(-3)^{2}}{2}+\\frac{1^{2}}{2}+\\frac{2^{2}}{2}+8=39.\n$$\n- 当 $\\theta=19.5$ 时，总和为\n$$\n8+8+8+8+\\frac{(-0.5)^{2}}{2}+\\frac{0.5^{2}}{2}+8=40.25.\n$$\n- 当 $\\theta=40$ 时，总和为\n$$\n8+8+8+8+8+8+0=48.\n$$\n最小值在 $\\theta=12.5$ 处取得。因此，M-估计量 $T_{n}$ 是 $12.5$，四舍五入到四位有效数字为 $12.50$。", "answer": "$$\\boxed{12.50}$$", "id": "1931970"}]}