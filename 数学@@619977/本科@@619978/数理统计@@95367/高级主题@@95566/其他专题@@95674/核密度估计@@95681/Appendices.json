{"hands_on_practices": [{"introduction": "要掌握一个抽象的统计公式，最好的方法就是将其应用于一个具体的例子中。这个初始练习将引导你逐步完成一个计算，从而揭开核密度估计（KDE）公式的神秘面纱。通过使用一个简单的数据集和均匀核函数，你将精确地看到每个数据点如何根据其与目标点的接近程度，为该点的密度估计做出贡献，从而阐明 KDE 的核心机制。[@problem_id:1927602]", "problem": "在统计学中，核密度估计 (KDE) 是一种用于估计随机变量概率密度函数的非参数方法。基于一个包含 $n$ 个数据点 $\\{x_1, x_2, \\dots, x_n\\}$ 的样本，在点 $x$ 处的核密度估计 $\\hat{f}_h(x)$ 的通用公式由下式给出：\n$$ \\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - x_i}{h}\\right) $$\n其中 $h$ 是带宽，$K(u)$ 是核函数。\n\n考虑一个由三个观测值组成的小数据集：$\\{10, 12, 15\\}$。您的任务是计算在点 $x = 11$ 处的核密度估计值。为此估计，使用如下定义的均匀核：\n$$ K(u) = \\begin{cases} 0.5 & \\text{if } |u| \\le 1 \\\\ 0 & \\text{if } |u| > 1 \\end{cases} $$\n以及带宽 $h=2$。\n\n计算核密度估计值 $\\hat{f}_2(11)$。请将答案表示为最简分数。", "solution": "我们使用核密度估计公式\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-x_{i}}{h}\\right),\n$$\n其中 $n=3$，$h=2$，$x=11$，数据为 $\\{10,12,15\\}$。计算标准化自变量：\n$$\nu_{1}=\\frac{11-10}{2}=\\frac{1}{2},\\quad\nu_{2}=\\frac{11-12}{2}=-\\frac{1}{2},\\quad\nu_{3}=\\frac{11-15}{2}=-2.\n$$\n对于均匀核，当 $|u|\\leq 1$ 时 $K(u)=\\frac{1}{2}$，当 $|u|>1$ 时 $K(u)=0$。我们有\n$$\nK\\!\\left(\\tfrac{1}{2}\\right)=\\frac{1}{2},\\quad\nK\\!\\left(-\\tfrac{1}{2}\\right)=\\frac{1}{2},\\quad\nK(-2)=0.\n$$\n因此，核函数值的总和为\n$$\n\\sum_{i=1}^{3}K(u_{i})=\\frac{1}{2}+\\frac{1}{2}+0=1.\n$$\n代入估计量可得\n$$\n\\hat{f}_{2}(11)=\\frac{1}{(3)(2)}\\cdot 1=\\frac{1}{6}.\n$$", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1927602"}, {"introduction": "在学会了如何在单一点上计算 KDE 之后，让我们来探究估计量的一个更整体的特性。这项练习提出了一个思想实验：如果我们将整个数据集平移一个常数值，密度估计会发生什么变化？通过分析这种情况，你将发现 KDE 的一个优美而直观的性质，即平移等变性（translational equivariance），这将加深你对估计量如何稳健地追踪数据位置的理解。[@problem_id:1927606]", "problem": "一位统计学家正在分析一个由 $n$ 个观测值 $\\{X_1, X_2, \\ldots, X_n\\}$ 组成的数据集。为了估计数据采样所来自的潜在概率密度函数，他们计算了核密度估计 (Kernel Density Estimate, KDE)。该 KDE 记为 $\\hat{f}_h(x)$，是使用核函数 $K(u)$ 和带宽参数 $h > 0$ 计算的。KDE 的公式如下：\n$$\n\\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - X_i}{h}\\right)\n$$\n随后，为了重新校准，该统计学家决定对数据应用一个线性变换。一个名为 $\\{Y_1, Y_2, \\ldots, Y_n\\}$ 的新数据集被创建，其中每个新的数据点都是原始数据点的平移版本，由关系式 $Y_i = X_i + c$ 定义，其中 $c$ 为某个非零常数。\n\n然后，使用完全相同的核函数 $K(u)$ 和带宽 $h$，为这个变换后的数据集计算了一个新的 KDE，记为 $\\hat{g}_h(x)$。\n\n以下哪个选项正确地描述了新估计 $\\hat{g}_h(x)$ 与原始估计 $\\hat{f}_h(x)$ 之间的关系？\n\nA. $\\hat{g}_h(x) = \\hat{f}_h(x) + \\frac{c}{nh}$\n\nB. $\\hat{g}_h(x) = \\hat{f}_h(x+c)$\n\nC. $\\hat{g}_h(x) = \\hat{f}_h(x)$\n\nD. $\\hat{g}_h(x) = \\hat{f}_h(x-c)$\n\nE. $\\hat{g}_h(x) = \\hat{f}_h(x) + c$", "solution": "根据定义，基于 $\\{X_{i}\\}_{i=1}^{n}$、使用核函数 $K$ 和带宽 $h>0$ 的 KDE 为\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-X_{i}}{h}\\right).\n$$\n对于变换后的数据 $Y_{i}=X_{i}+c$，其 KDE (使用相同的 $K$ 和 $h$) 为\n$$\n\\hat{g}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-Y_{i}}{h}\\right).\n$$\n将 $Y_{i}=X_{i}+c$ 代入可得\n$$\n\\hat{g}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-(X_{i}+c)}{h}\\right)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{(x-c)-X_{i}}{h}\\right).\n$$\n根据 $\\hat{f}_{h}$ 的定义，上式右侧等于 $\\hat{f}_{h}(x-c)$，因为\n$$\n\\hat{f}_{h}(x-c)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{(x-c)-X_{i}}{h}\\right).\n$$\n因此，\n$$\n\\hat{g}_{h}(x)=\\hat{f}_{h}(x-c),\n$$\n这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1927606"}, {"introduction": "一个强大的模型，其优劣取决于其参数的设置，而对于 KDE 而言，最关键的参数就是带宽 $h$。这最后一项实践通过引入“留一法交叉验证”（LOOCV）来解决这个至关重要的实际问题，这是一种直接从数据中选择最优带宽的原则性方法。通过亲手计算 LOOCV 目标函数，你将亲身体验平衡偏差与方差权衡的机制，这是所有统计建模中的核心挑战。[@problem_id:1927653]", "problem": "一位数据科学家正在对一台新校准仪器的一小组归一化误差测量值进行初步分析。数据集为 $X = \\{x_1, x_2, x_3\\} = \\{-1, 0, 1\\}$。为了对这些误差的概率分布进行建模，该科学家采用了一种名为核密度估计（Kernel Density Estimation, KDE）的非参数方法来估计随机变量的概率密度函数。\n\nKDE 定义如下：\n$$ \\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x-x_i}{h}\\right) $$\n其中，$n$ 是数据点的数量，$h$ 是一个称为带宽的平滑参数，$K(u)$ 是核函数。在本分析中，使用标准高斯核：$K(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right)$。\n\n为了评估特定带宽的适用性，该科学家计算了留一法交叉验证（Leave-One-Out Cross-Validation, LOOCV）分数，这是一个旨在估计 KDE 误差的目标函数。该函数记为 $J(h)$，定义如下：\n$$ J(h) = \\int_{-\\infty}^{\\infty} \\left(\\hat{f}_h(x)\\right)^2 dx - \\frac{2}{n} \\sum_{i=1}^{n} \\hat{f}_{h, -i}(x_i) $$\n此处，$\\hat{f}_{h, -i}(x_i)$ 是在数据点 $x_i$ 处的“留一”密度估计，它是通过使用除 $x_i$ 自身之外的所有数据点构建 KDE 来计算的：\n$$ \\hat{f}_{h, -i}(x_i) = \\frac{1}{(n-1)h} \\sum_{j \\neq i} K\\left(\\frac{x_i - x_j}{h}\\right) $$\n你可以不经证明地使用以下高斯核的标准卷积恒等式：\n$$ \\int_{-\\infty}^{\\infty} K\\left(\\frac{x-a}{h}\\right) K\\left(\\frac{x-b}{h}\\right) dx = \\frac{h}{\\sqrt{4\\pi}}\\exp\\left(-\\frac{(a-b)^2}{4h^2}\\right) $$\n请计算给定数据集 $X=\\{-1, 0, 1\\}$ 在带宽 $h=1$ 时的 LOOCV 分数 $J(h)$ 的精确值。请将你的答案表示为包含 $\\pi$、$e$ 和数值常数的单个符号表达式。", "solution": "我们有 $n=3$，$h=1$，$X=\\{-1,0,1\\}$，以及 $K(u)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{u^{2}}{2}\\right)$。KDE 为 $\\hat{f}_{1}(x)=\\frac{1}{3}\\sum_{i=1}^{3}K(x-x_{i})$。\n\n首先，计算积分平方密度：\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx\n=\\frac{1}{9}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\int_{-\\infty}^{\\infty}K(x-x_{i})K(x-x_{j})\\,dx.\n$$\n使用所给的高斯卷积恒等式，其中 $h=1$，$a=x_{i}$，$b=x_{j}$，\n$$\n\\int_{-\\infty}^{\\infty}K(x-x_{i})K(x-x_{j})\\,dx=\\frac{1}{\\sqrt{4\\pi}}\\exp\\left(-\\frac{(x_{i}-x_{j})^{2}}{4}\\right).\n$$\n因此，\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx\n=\\frac{1}{9\\sqrt{4\\pi}}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\exp\\left(-\\frac{(x_{i}-x_{j})^{2}}{4}\\right).\n$$\n对于 $X=\\{-1,0,1\\}$，成对差的平方分别为 $0$（对角线上出现三次）、$1$（相邻点之间的四个有序非对角线对）和 $4$（$-1$ 和 $1$ 之间的两个有序非对角线对）。所以，\n$$\n\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\exp\\left(-\\frac{(x_{i}-x_{j})^{2}}{4}\\right)\n=3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp\\left(-1\\right).\n$$\n因此，\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx\n=\\frac{1}{9\\sqrt{4\\pi}}\\left(3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp(-1)\\right).\n$$\n\n接下来，计算留一项。对于 $h=1$，\n$$\n\\hat{f}_{1,-i}(x_{i})=\\frac{1}{2}\\sum_{j\\neq i}K(x_{i}-x_{j}).\n$$\n对每个 $x_i$ 进行计算：\n- 对于 $x_{1}=-1$：与其他点的差为 $-1$ 和 $-2$，所以\n$$\n\\hat{f}_{1,-1}(-1)=\\frac{1}{2}\\left(\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right)+\\frac{1}{\\sqrt{2\\pi}}\\exp(-2)\\right)=\\frac{1}{2\\sqrt{2\\pi}}\\left(\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n- 对于 $x_{2}=0$：差为 $1$ 和 $-1$，所以\n$$\n\\hat{f}_{1,-2}(0)=\\frac{1}{2}\\left(\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right)+\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right)\\right)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\right).\n$$\n- 对于 $x_{3}=1$：差为 $2$ 和 $1$，所以\n$$\n\\hat{f}_{1,-3}(1)=\\frac{1}{2\\sqrt{2\\pi}}\\left(\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n求和，\n$$\n\\sum_{i=1}^{3}\\hat{f}_{1,-i}(x_{i})=\\frac{1}{\\sqrt{2\\pi}}\\left(2\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n\n因此，LOOCV 分数为\n$$\nJ(1)=\\int_{-\\infty}^{\\infty}\\left(\\hat{f}_{1}(x)\\right)^{2}dx-\\frac{2}{3}\\sum_{i=1}^{3}\\hat{f}_{1,-i}(x_{i}),\n$$\n得出\n$$\nJ(1)=\\frac{1}{9\\sqrt{4\\pi}}\\left(3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp(-1)\\right)-\\frac{2}{3\\sqrt{2\\pi}}\\left(2\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right).\n$$\n这就是用 $\\pi$、$\\exp(\\cdot)$ 和数值常数表示的精确符号表达式。", "answer": "$$\\boxed{\\frac{1}{9\\sqrt{4\\pi}}\\left(3+4\\exp\\left(-\\frac{1}{4}\\right)+2\\exp(-1)\\right)-\\frac{2}{3\\sqrt{2\\pi}}\\left(2\\exp\\left(-\\frac{1}{2}\\right)+\\exp(-2)\\right)}$$", "id": "1927653"}]}