{"hands_on_practices": [{"introduction": "这项实践练习将带您逐步体验序贯概率比检验（SPRT）的具体流程。通过检查一个质量控制场景中的简短观测序列，您将手动计算每一步的似然比，并将其与决策边界进行比较。本练习旨在建立一个基础且直观的理解，即证据是如何序贯累积直至最终做出决策的 [@problem_id:1954406]。", "problem": "在一种新型半导体的质量控制过程中，组件被依次进行测试。每个组件要么是次品，要么是合格品。生产过程可能处于两种状态之一。在“正常”状态下，生产出次品的概率为 $p_0 = 1/3$。在“退化”状态下，该概率为 $p_1 = 2/3$。\n\n为了监控该过程，一位统计学家采用序贯概率比检验 (SPRT)。设第 $i$ 次测试的结果为 $X_i$，如果组件是次品，则 $X_i=1$，如果是合格品，则 $X_i=0$。该检验基于以下假设：\n- 原假设 $H_0$：生产过程处于“正常”状态 ($p = p_0 = 1/3$)。\n- 备择假设 $H_1$：生产过程处于“退化”状态 ($p = p_1 = 2/3$)。\n\n检验通过计算 $n$ 次观测后的似然比 $\\Lambda_n$ 来进行。决策规则是：如果 $\\Lambda_n \\ge A$，则停止并接受 $H_1$；如果 $\\Lambda_n \\le B$，则停止并接受 $H_0$；如果 $B < \\Lambda_n < A$，则继续测试。常数 $A$ 和 $B$ 被选择用来控制错误率，它们的自然对数形式为 $\\ln A = \\ln(4)$ 和 $\\ln B = -\\ln(4)$。\n\n确定导致检验终止并接受备择假设 $H_1$ 的两次观测的特定序列 $(X_1, X_2)$。答案应为一个由两个数字（0 或 1）组成的序列。", "solution": "在假设 $H_{0}: p=p_{0}=\\frac{1}{3}$ 和 $H_{1}: p=p_{1}=\\frac{2}{3}$ 下，序贯概率比检验使用 $n$ 次观测后的似然比，\n$$\n\\Lambda_{n}=\\prod_{i=1}^{n}\\frac{p_{1}^{X_{i}}(1-p_{1})^{1-X_{i}}}{p_{0}^{X_{i}}(1-p_{0})^{1-X_{i}}}.\n$$\n设 $S_{n}=\\sum_{i=1}^{n}X_{i}$。那么\n$$\n\\Lambda_{n}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{S_{n}}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{n-S_{n}}.\n$$\n代入 $p_{0}=\\frac{1}{3}$ 和 $p_{1}=\\frac{2}{3}$ 可得\n$$\n\\frac{p_{1}}{p_{0}}=\\frac{\\frac{2}{3}}{\\frac{1}{3}}=2,\\qquad \\frac{1-p_{1}}{1-p_{0}}=\\frac{\\frac{1}{3}}{\\frac{2}{3}}=\\frac{1}{2},\n$$\n因此\n$$\n\\Lambda_{n}=2^{S_{n}}\\left(\\frac{1}{2}\\right)^{n-S_{n}}=2^{2S_{n}-n}.\n$$\n决策阈值满足 $\\ln A=\\ln(4)$ 和 $\\ln B=-\\ln(4)$，所以 $A=\\exp(\\ln(4))=4$ 且 $B=\\exp(-\\ln(4))=\\frac{1}{4}$。停止规则是：如果 $\\Lambda_{n}\\geq 4$，接受 $H_{1}$；如果 $\\Lambda_{n}\\leq \\frac{1}{4}$，接受 $H_{0}$；否则继续。\n\n对于 $n=1$，$S_{1}\\in\\{0,1\\}$：\n- 如果 $X_{1}=1$，那么 $\\Lambda_{1}=2^{2\\cdot 1-1}=2<4$。\n- 如果 $X_{1}=0$，那么 $\\Lambda_{1}=2^{2\\cdot 0-1}=\\frac{1}{2}>\\frac{1}{4}$。\n因此，在一次观测后不做任何决定。\n\n对于 $n=2$，枚举所有序列并计算 $S_{2}$ 和 $\\Lambda_{2}=2^{2S_{2}-2}$：\n- $(0,0)$: $S_{2}=0$，$\\Lambda_{2}=2^{-2}=\\frac{1}{4}\\leq \\frac{1}{4}$，所以接受 $H_{0}$。\n- $(1,0)$ 或 $(0,1)$: $S_{2}=1$，$\\Lambda_{2}=2^{0}=1$，该值严格介于 $\\frac{1}{4}$ 和 $4$ 之间，所以继续。\n- $(1,1)$: $S_{2}=2$，$\\Lambda_{2}=2^{2}=4\\geq 4$，所以接受 $H_{1}$。\n\n因此，导致检验终止并接受 $H_{1}$ 的唯一的两次观测序列是 $(1,1)$。", "answer": "$$\\boxed{\\begin{pmatrix}1 & 1\\end{pmatrix}}$$", "id": "1954406"}, {"introduction": "本练习探讨了序贯检验中的一个特殊但极具启发性的场景。它展示了在某些情况下，一个单一的观测结果就可能具有决定性作用，从而立即得出结论，无需进一步抽样。理解这种极端情况凸显了似然比的核心力量：它能够以一种决定性的方式量化证据，尤其是当观测数据与其中一个假设完全不相容时 [@problem_id:1954394]。", "problem": "一位质量控制工程师正在评估一种特种电子元件的新制造工艺。已知一个元件的寿命（以千小时为单位）服从区间 $(0, \\theta)$ 上的均匀分布，记为 $U(0, \\theta)$。标准工艺生产的元件，其参数 $\\theta$ 已知为 $\\theta_0 = 1$。正在测试一种新的、可能经过改进的工艺，据称该工艺生产的元件其参数为 $\\theta_1 = 2$。\n\n工程师采用序贯概率比检验（SPRT）来在这两个相互竞争的假设之间做出决策：\n- 原假设 $H_0: \\theta = \\theta_0 = 1$\n- 备择假设 $H_1: \\theta = \\theta_1 = 2$\n\n该检验的设计要求最大 I 型错误概率为 $\\alpha = 0.05$，最大 II 型错误概率为 $\\beta = 0.10$。SPRT 过程涉及按顺序收集元件的寿命数据。在第 $n$ 次观测后，计算似然比 $\\lambda_n$ 并与两个阈值 $A$ 和 $B$ 进行比较。决策规则如下：\n- 如果 $\\lambda_n \\ge A$，停止抽样并拒绝 $H_0$。\n- 如果 $\\lambda_n \\le B$，停止抽样并接受 $H_0$。\n- 如果 $B < \\lambda_n < A$，继续抽样。\n\n阈值使用公式 $A \\approx (1-\\beta)/\\alpha$ 和 $B \\approx \\beta/(1-\\alpha)$ 进行近似计算。\n\n在测试过程中，观测到从新工艺中选出的第一个元件寿命为 $x_1 = 1.3$ 千小时。基于这单次观测，以下哪个陈述正确描述了其直接结果和推理？\n\nA. 继续测试，因为单个数据点不足以做出决策。\n\nB. 接受 $H_0$，因为观测值相对接近 $H_0$ 下的均值。\n\nC. 拒绝 $H_0$，因为在 $H_0$ 下此观测值的似然为零，导致似然比为无穷大。\n\nD. 继续测试，因为此观测值的似然比落在决策阈值 $A$ 和 $B$ 之间。\n\nE. 拒绝 $H_0$，因为似然比为负，低于下阈值 $B$。", "solution": "在参数 $\\theta$ 下的寿命模型为 $X \\sim U(0,\\theta)$，其密度函数为\n$$\nf(x \\mid \\theta) = \\begin{cases}\n\\frac{1}{\\theta}, & 0 < x < \\theta,\\\\\n0, & \\text{其他情况}.\n\\end{cases}\n$$\n假设为 $H_{0}:\\theta=\\theta_{0}=1$ 和 $H_{1}:\\theta=\\theta_{1}=2$。因此，在 $H_{0}$ 和 $H_{1}$ 下的密度函数分别为\n$$\nf_{0}(x)=\\begin{cases}\n1, & 0<x<1,\\\\\n0, & \\text{其他情况},\n\\end{cases}\n\\qquad\nf_{1}(x)=\\begin{cases}\n\\frac{1}{2}, & 0<x<2,\\\\\n0, & \\text{其他情况}.\n\\end{cases}\n$$\n第一次观测 $x_{1}$ 后的似然比为\n$$\n\\lambda_{1}=\\frac{f_{1}(x_{1})}{f_{0}(x_{1})}.\n$$\n对于观测到的 $x_{1}=1.3$，我们有 $1.3 \\notin (0,1)$ 且 $1.3 \\in (0,2)$，因此\n$$\nf_{0}(1.3)=0, \\qquad f_{1}(1.3)=\\frac{1}{2},\n$$\n这得出\n$$\n\\lambda_{1}=\\frac{\\frac{1}{2}}{0}=+\\infty.\n$$\nSPRT 阈值近似为\n$$\nA \\approx \\frac{1-\\beta}{\\alpha}=\\frac{1-\\frac{1}{10}}{\\frac{1}{20}}=18, \\qquad\nB \\approx \\frac{\\beta}{1-\\alpha}=\\frac{\\frac{1}{10}}{1-\\frac{1}{20}}=\\frac{2}{19}.\n$$\n由于 $\\lambda_{1}=+\\infty \\ge A$，检验立即停止并拒绝 $H_{0}$。因此，正确的陈述是拒绝 $H_{0}$，因为在 $H_{0}$ 下的似然为零，而在 $H_{1}$ 下为正，导致似然比为无穷大。主张继续测试的陈述是不正确的，且似然比不能为负。", "answer": "$$\\boxed{C}$$", "id": "1954394"}, {"introduction": "在理解了 SPRT 的运作方式后，一个关键问题随之而来：它的效率如何？这项实践练习将通过应用 Wald 的近似公式，向您介绍 SPRT 最著名的特性之一——样本效率。您将计算达到决策所需的期望样本数量，这是在临床试验或工业测试等资源受限应用中评估任何检验程序性能的关键指标 [@problem_id:1954399]。", "problem": "一家医疗设备公司正在测试一种用于检测特定生物标志物的新型生物传感器。该公司采用序贯概率比检验 (SPRT) 来对样本测量值 $X$ 的两种假设进行决策：\n- 原假设 $H_0$：生物标志物不存在。\n- 备择假设 $H_1$：生物标志物存在。\n\n该检验的设计要求I型错误概率（假阳性率）为 $\\alpha = 0.1$，II型错误概率（假阴性率）为 $\\beta = 0.1$。对于每个测试的样本，都会计算一个随机变量 $Z$，即似然比的对数。根据类似传感器的历史数据可知，如果生物标志物确实存在（即 $H_1$ 为真），单个样本的该对数似然比的期望值为 $E_{H_1}[Z] = 0.5$。\n\n使用Wald关于停止边界和期望样本量的近似，计算在假设被测材料中确实存在生物标志物的情况下，达到决策所需的期望样本数量。请用闭式解析表达式表示您的答案。", "solution": "我们考虑序贯概率比检验 (SPRT)，其中每个样本的对数似然比增量为 $Z_i$，累积对数似然为 $S_{n}=\\sum_{i=1}^{n}Z_{i}$。Wald近似将对数域中的决策边界设定为：\n$$\nb=\\ln\\!\\left(\\frac{1-\\beta}{\\alpha}\\right),\\qquad a=\\ln\\!\\left(\\frac{\\beta}{1-\\alpha}\\right),\n$$\n其中当 $S_{n}\\geq b$ 时接受 $H_{1}$，当 $S_{n}\\leq a$ 时接受 $H_{0}$。\n\n在 $H_{1}$ 为真的情况下，接受 $H_{1}$ 的概率约为 $1-\\beta$，接受 $H_{0}$ 的概率约为 $\\beta$。忽略超调量，在 $H_1$ 下对数似然的期望终端值为\n$$\nE_{H_{1}}[S_{N}]\\approx (1-\\beta)b+\\beta a.\n$$\n根据Wald恒等式，对于具有有限均值的独立同分布增量，有 $E_{H_{1}}[S_{N}]=E_{H_{1}}[Z]\\cdot E_{H_{1}}[N]$。因此，在 $H_1$ 下的期望样本量近似为\n$$\nE_{H_{1}}[N]\\approx \\frac{(1-\\beta)b+\\beta a}{E_{H_{1}}[Z]}.\n$$\n\n当 $\\alpha=\\beta=\\frac{1}{10}$ 时，我们计算边界：\n$$\nb=\\ln\\!\\left(\\frac{1-\\frac{1}{10}}{\\frac{1}{10}}\\right)=\\ln\\!\\left(\\frac{\\frac{9}{10}}{\\frac{1}{10}}\\right)=\\ln(9),\\qquad\na=\\ln\\!\\left(\\frac{\\frac{1}{10}}{1-\\frac{1}{10}}\\right)=\\ln\\!\\left(\\frac{\\frac{1}{10}}{\\frac{9}{10}}\\right)=\\ln\\!\\left(\\frac{1}{9}\\right)=-\\ln(9).\n$$\n因此，\n$$\n(1-\\beta)b+\\beta a=\\left(1-\\frac{1}{10}\\right)\\ln(9)+\\frac{1}{10}\\left[-\\ln(9)\\right]\n=\\left(\\frac{9}{10}-\\frac{1}{10}\\right)\\ln(9)=\\frac{4}{5}\\ln(9).\n$$\n使用 $E_{H_{1}}[Z]=\\frac{1}{2}$，\n$$\nE_{H_{1}}[N]\\approx \\frac{\\frac{4}{5}\\ln(9)}{\\frac{1}{2}}=\\frac{8}{5}\\ln(9)=\\frac{16}{5}\\ln(3).\n$$\n这就是在Wald近似下，当生物标志物确实存在时，所需期望样本数量的闭式解析表达式。", "answer": "$$\\boxed{\\frac{8}{5}\\ln(9)}$$", "id": "1954399"}]}