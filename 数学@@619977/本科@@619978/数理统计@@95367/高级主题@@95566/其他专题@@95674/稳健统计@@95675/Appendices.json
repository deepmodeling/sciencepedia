{"hands_on_practices": [{"introduction": "经典统计学中的样本标准差（$s$）是我们衡量数据离散程度的常用工具，但它对异常值极其敏感。本练习将通过直接计算和比较，让你亲身体验单个异常值如何不成比例地增大标准差，同时引出一种更稳健的离散度度量——中位数绝对偏差（Median Absolute Deviation, MAD）。通过这种对比，你将深刻理解为何在数据分析中引入稳健统计方法是至关重要的 [@problem_id:1952404]。", "problem": "在稳健统计学中，人们经常将样本标准差与对离群值不那么敏感的其他统计离散度度量进行比较。中位数绝对偏差 (MAD) 就是这样一种稳健的度量。对于一个数据集 $\\{x_1, x_2, \\dots, x_n\\}$，样本标准差由 $s = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n}(x_i - \\bar{x})^2}$ 给出，其中 $\\bar{x}$ 是样本均值。MAD 定义为数据与数据中位数之差的绝对值的中位数：$\\text{MAD} = \\text{median}(|x_i - M|)$，其中 $M = \\text{median}(\\{x_1, x_2, \\dots, x_n\\})$。\n\n如果一个数据集的样本标准差远大于其 MAD，则认为该数据集存在显著的离群值问题。考虑以下每个包含五个数据点的数据集：\n\nA. $\\{10, 11, 12, 13, 100\\}$\n\nB. $\\{10, 11, 12, 13, 14\\}$\n\nC. $\\{-50, 0, 1, 2, 50\\}$\n\nD. $\\{1, 3, 5, 7, 9\\}$\n\n这些数据集中，哪些满足样本标准差大于中位数绝对偏差十倍的条件（即 $s > 10 \\times \\text{MAD}$）？选择所有符合条件的选项。如果找到多个这样的数据集，请将对应的字母按字母顺序连接起来作为答案（例如，BD）。", "solution": "我们必须对每个数据集检验是否 $s > 10 \\times \\text{MAD}$。由于 $s \\geq 0$ 且 $\\text{MAD} \\geq 0$，这等价于检验 $s^{2} > 100 \\times \\text{MAD}^{2}$。对于一个包含 $n=5$ 个数据点的数据集 $\\{x_{1},\\dots,x_{n}\\}$，其样本方差为\n$$\ns^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2},\\quad \\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i},\n$$\n且 $\\text{MAD}=\\text{median}(|x_{i}-M|)$，其中 $M=\\text{median}(\\{x_{i}\\})$。\n\n数据集 A: $\\{10,11,12,13,100\\}$。计算 $\\bar{x}=\\frac{10+11+12+13+100}{5}=\\frac{146}{5}$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=\\frac{156770}{25}\\quad\\Rightarrow\\quad s^{2}=\\frac{1}{4}\\cdot\\frac{156770}{25}=\\frac{156770}{100}=\\frac{15677}{10}.\n$$\n中位数是 $M=12$，所以绝对偏差为 $\\{2,1,0,1,88\\}$，其中位数为 $1$，因此 $\\text{MAD}=1$。检验：\n$$\ns^{2}=\\frac{15677}{10}>100=100\\cdot \\text{MAD}^{2}\\quad\\Rightarrow\\quad s>10\\cdot \\text{MAD}.\n$$\n因此 A 满足条件。\n\n数据集 B: $\\{10,11,12,13,14\\}$。计算 $\\bar{x}=12$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=10\\quad\\Rightarrow\\quad s^{2}=\\frac{10}{4}=\\frac{5}{2}.\n$$\n中位数 $M=12$，绝对偏差为 $\\{2,1,0,1,2\\}$，其中位数为 $1$，所以 $\\text{MAD}=1$。检验：\n$$\ns^{2}=\\frac{5}{2}<100=100\\cdot \\text{MAD}^{2},\n$$\n所以 B 不满足条件。\n\n数据集 C: $\\{-50,0,1,2,50\\}$。计算 $\\bar{x}=\\frac{-50+0+1+2+50}{5}=\\frac{3}{5}$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=\\frac{125080}{25}\\quad\\Rightarrow\\quad s^{2}=\\frac{1}{4}\\cdot\\frac{125080}{25}=\\frac{6254}{5}.\n$$\n中位数 $M=1$，绝对偏差为 $\\{51,1,0,1,49\\}$，其中位数为 $1$，所以 $\\text{MAD}=1$。检验：\n$$\ns^{2}=\\frac{6254}{5}>100=100\\cdot \\text{MAD}^{2},\n$$\n所以 C 满足条件。\n\n数据集 D: $\\{1,3,5,7,9\\}$。计算 $\\bar{x}=5$。则\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=40\\quad\\Rightarrow\\quad s^{2}=\\frac{40}{4}=10.\n$$\n中位数 $M=5$，绝对偏差为 $\\{4,2,0,2,4\\}$，其中位数为 $2$，所以 $\\text{MAD}=2$。检验：\n$$\ns^{2}=10<100\\cdot 2^{2}=400,\n$$\n所以 D 不满足条件。\n\n因此，满足 $s>10\\times \\text{MAD}$ 的数据集是 A 和 C。", "answer": "$$\\boxed{AC}$$", "id": "1952404"}, {"introduction": "了解了经典估计量面对异常值时的脆弱性后，我们来学习一种简单而有效的解决方法。缩尾均值（Winsorized mean）提供了一种稳健的中心趋势估计方法，它不是直接丢弃极端值，而是用数据集中稍不极端的值来替换它们，从而“拉回”异常值的影响。这个练习将指导你计算一个 $20\\%$ 的缩尾均值，帮助你掌握这种调整极端数据影响的实用技巧 [@problem_id:1952397]。", "problem": "在一门数据分析课程中，一位教授正在评估学生们的期末考试表现。教授怀疑，传统的算术平均分因一些未做准备的学生的极低分数以及一些有专业经验的学生的极高分数而产生了偏差。为了更稳健地衡量班级的集中趋势，教授决定计算缩尾均值（Winsorized mean）。\n\n一个$p\\%$的缩尾均值的计算方法如下：首先，将数据从小到大排序。设$n$为数据点的数量。计算分布两端需要调整的数据点数量$k$，其值为小于或等于$n \\times (p/100)$的最大整数。然后，将$k$个最小的数据点替换为第$(k+1)$小的数据点。同样地，将$k$个最大的数据点替换为第$(k+1)$大的数据点（也就是排序后列表中的第$(n-k)$个数据点）。这个新形成的数据集的算术平均值就是缩尾均值。\n\n给定以下十五个（满分100的）考试分数：\n$$ \\{ 70, 62, 99, 58, 78, 12, 65, 81, 71, 25, 68, 98, 73, 31, 75 \\} $$\n\n计算这些分数的20%缩尾均值。将最终答案四舍五入到四位有效数字。", "solution": "对于比例为$p$的缩尾均值，在数据排序后，每端使用$k=\\lfloor n p \\rfloor$个替换值。当$n=15$且$p=0.20$时，我们有\n$$\nk=\\lfloor 15 \\cdot 0.20 \\rfloor=\\lfloor 3 \\rfloor=3.\n$$\n将分数升序排列得到\n$$\n\\{12,25,31,58,62,65,68,70,71,73,75,78,81,98,99\\}.\n$$\n将$k=3$个最小值$\\{12,25,31\\}$替换为第$(k+1)$个最小值$x_{(4)}=58$，并将$k=3$个最大值$\\{81,98,99\\}$替换为第$(k+1)$个最大值，即$x_{(12)}=78$。因此，缩尾处理后的数据集为\n$$\n\\{58,58,58,58,62,65,68,70,71,73,75,78,78,78,78\\}.\n$$\n其总和为\n$$\nS_{W}=4\\cdot 58+(62+65+68+70+71+73+75+78)+3\\cdot 78.\n$$\n计算中间部分的和：\n$$\n62+65+68+70+71+73+75+78=562,\n$$\n所以\n$$\nS_{W}=232+562+234=1028.\n$$\n20%的缩尾均值（$p=0.20$）为\n$$\n\\bar{x}_{W}=\\frac{S_{W}}{n}=\\frac{1028}{15}=68.\\overline{53}.\n$$\n四舍五入到四位有效数字得到$68.53$。", "answer": "$$\\boxed{68.53}$$", "id": "1952397"}, {"introduction": "在学习了具体的稳健估计量之后，我们现在转向一个更通用、更强大的框架：M-估计（M-estimators）。M-估计量是通过一个名为影响函数（influence function, $\\psi$）的工具来定义的，它使我们能够精确控制每个数据点对最终结果的影响。通过使用经典的Huber $\\psi$-函数解决这个练习，你将实践现代稳健统计的核心思想——如何通过系统性地限制异常值的影响来获得可靠的位置估计 $\\hat{\\theta}$ [@problem_id:1952425]。", "problem": "在稳健统计学中，M-估计量是一大类对离群值稳健的估计量。对于一个数据集 $\\{x_1, x_2, \\ldots, x_n\\}$，其位置的M-估计量（记为 $\\hat{\\theta}$）被定义为以下方程的解：\n$$\n\\sum_{i=1}^{n} \\psi\\left(\\frac{x_i - \\theta}{S}\\right) = 0\n$$\n其中 $S$ 是一个稳健的尺度估计，而 $\\psi$ 是一个选定的影响函数。\n\n考虑 Huber 的 $\\psi$-函数，对于给定的调节常数 $k > 0$，其定义如下：\n$$\n\\psi_k(u) = \\begin{cases}\n-k & \\text{如果 } u < -k \\\\\nu & \\text{如果 } |u| \\leq k \\\\\nk & \\text{如果 } u > k\n\\end{cases}\n$$\n该函数通过在 $\\pm k$ 处“裁剪”大的残差，来限制它们的影响。\n\n一位工程师正在分析一组关于某个组件长度的五个独立测量值。得到的测量值如下：\n$$\n\\{2.1, 2.5, 2.3, 2.6, 4.5\\}\n$$\n为了获得一个对单个大值不过分敏感的位置估计，该工程师决定使用M-估计量。在计算中，将使用固定的尺度估计 $S=1$ 和调节常数 $k=1.5$。\n\n计算该数据集的位置M-估计 $\\hat{\\theta}$。请将您的答案四舍五入到三位有效数字。", "solution": "我们需求解 M-估计方程以得到 $\\hat{\\theta}$\n$$\n\\sum_{i=1}^{5} \\psi_{k}\\!\\left(\\frac{x_{i}-\\theta}{S}\\right)=0,\n$$\n其中 $S=1$，$k=1.5$，且 $x=\\{2.1,2.5,2.3,2.6,4.5\\}$。当 $S=1$ 时，方程变为\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=0,\n$$\n其中 Huber 的函数为：如果 $|u|\\leq k$，则 $\\psi_{k}(u)=u$；如果 $|u|>k$，则 $\\psi_{k}(u)=\\pm k$，其符号与 $u$ 的符号相同。\n\n对于每个 $x_{i}$，当 $|x_{i}-\\theta|\\leq 1.5$ 时，该项是线性的（即，未被裁剪），这等价于 $\\theta\\in[x_{i}-1.5,\\,x_{i}+1.5]$。这些区间是：\n- $x_{1}=2.1$: $\\theta\\in[0.6,\\,3.6]$,\n- $x_{2}=2.5$: $\\theta\\in[1.0,\\,4.0]$,\n- $x_{3}=2.3$: $\\theta\\in[0.8,\\,3.8]$,\n- $x_{4}=2.6$: $\\theta\\in[1.1,\\,4.1]$,\n- $x_{5}=4.5$: $\\theta\\in[3.0,\\,6.0]$.\n\n考虑 $\\theta\\in[1.1,3.0)$，在此区间内，前四项是线性的，而第五项被裁剪为 $+1.5$，因为 $4.5-\\theta>1.5$。于是\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=\\sum_{i=1}^{4} (x_{i}-\\theta) + 1.5.\n$$\n使用 $\\sum_{i=1}^{4} x_{i}=2.1+2.5+2.3+2.6=9.5$，我们得到\n$$\n9.5 - 4\\theta + 1.5 = 0 \\;\\;\\Longrightarrow\\;\\; 11 - 4\\theta = 0 \\;\\;\\Longrightarrow\\;\\; \\hat{\\theta}=\\frac{11}{4}=2.75.\n$$\n检验在 $\\hat{\\theta}=2.75$ 处假设的一致性：\n- 对于 $x_{1},x_{2},x_{3},x_{4}$，有 $|x_{i}-\\hat{\\theta}|\\in\\{0.65,0.25,0.45,0.15\\}\\leq 1.5$，因此将它们作为线性项处理是正确的。\n- 对于 $x_{5}$，有 $|4.5-2.75|=1.75>1.5$，因此将其裁剪为 $+1.5$ 是正确的。\n\n因此，该解在该区域内是有效且唯一的。四舍五入到三位有效数字得到 $2.75$。", "answer": "$$\\boxed{2.75}$$", "id": "1952425"}]}