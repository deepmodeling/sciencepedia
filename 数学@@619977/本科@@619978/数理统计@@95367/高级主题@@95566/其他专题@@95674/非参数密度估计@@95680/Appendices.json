{"hands_on_practices": [{"introduction": "在我们使用核函数进行密度估计之前，必须确保其在数学上是有效的。本练习关注一个核心要求：任何核函数本身都必须是一个概率密度函数，这意味着它的总积分必须等于1。通过解决这个问题，你将练习如何将一个函数进行归一化，使其成为一个有效的核函数，这是核密度估计（KDE）中的一个基础步骤。[@problem_id:1939931]", "problem": "在核密度估计这一统计方法中，核函数 $K(u)$ 用于对数据点进行加权和平滑。为使在数学上有效，任何此类核函数本身必须是一个概率密度函数。考虑以下函数，称为双权（或四次）核，它因其平滑性而经常被使用：\n$$\nK(u) = \\begin{cases} c(1 - u^2)^2 & \\text{for } |u| \\le 1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n其中 $c$ 是一个正常数。请确定使 $K(u)$ 成为一个有效核的 $c$ 的精确数值。", "solution": "要成为实数轴上的一个有效概率密度函数，该核必须满足非负性和积分为一的条件。给定的 $K(u)$ 是非负的，因为对于所有 $u$，都有 $(1-u^{2})^{2} \\ge 0$，并且在 $|u| \\le 1$ 范围之外其值为零。因此，归一化条件决定了 $c$ 的值：\n$$\n\\int_{-\\infty}^{\\infty} K(u)\\,du \\;=\\; \\int_{-1}^{1} c\\left(1 - u^{2}\\right)^{2}\\,du \\;=\\; 1.\n$$\n展开平方项并逐项积分：\n$$\n\\int_{-1}^{1} c\\left(1 - 2u^{2} + u^{4}\\right)\\,du\n\\;=\\;\nc\\left(\\int_{-1}^{1} 1\\,du - 2\\int_{-1}^{1} u^{2}\\,du + \\int_{-1}^{1} u^{4}\\,du\\right).\n$$\n利用对称性和标准积分，\n$$\n\\int_{-1}^{1} 1\\,du = 2,\\quad \\int_{-1}^{1} u^{2}\\,du = \\frac{2}{3},\\quad \\int_{-1}^{1} u^{4}\\,du = \\frac{2}{5}.\n$$\n因此，\n$$\n\\int_{-1}^{1} c\\left(1 - u^{2}\\right)^{2}\\,du\n=\nc\\left(2 - 2\\cdot\\frac{2}{3} + \\frac{2}{5}\\right)\n=\nc\\left(2 - \\frac{4}{3} + \\frac{2}{5}\\right)\n=\nc\\left(\\frac{30}{15} - \\frac{20}{15} + \\frac{6}{15}\\right)\n=\nc\\cdot\\frac{16}{15}.\n$$\n令此式等于 $1$ 可得\n$$\nc\\cdot\\frac{16}{15} = 1 \\quad\\Rightarrow\\quad c = \\frac{15}{16}.\n$$\n因此，$c = \\frac{15}{16}$ 确保了 $K(u)$ 的积分为 $1$，使其成为一个有效的核。", "answer": "$$\\boxed{\\frac{15}{16}}$$", "id": "1939931"}, {"introduction": "了解了什么是核函数之后，让我们动手实践一下。这个练习将演示如何将核密度估计公式应用于一个具体的小型数据集。你将亲眼看到每个数据点如何贡献一个由核函数定义的“小山丘”，以及这些“小山丘”如何叠加起来形成最终的平滑密度曲线，从而将抽象的公式与实际应用联系起来。[@problem_id:1939894]", "problem": "一个材料科学实验室正在测试一种新型聚合物电池。他们进行了五次试验，测量在恒定负载下电池完全放电所需的时间。记录的放电时间（单位：小时）为：$\\{2.1, 2.5, 3.0, 3.8, 4.2\\}$。\n\n为了分析这个小样本，一位统计学家决定使用核密度估计（Kernel Density Estimator, KDE）来估计放电时间的基础概率密度函数。KDE由以下公式给出：\n$$ \\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - x_i}{h}\\right) $$\n其中，$n$ 是数据点的数量，$\\{x_1, \\dots, x_n\\}$ 是观测数据集，$h$ 是一个称为带宽的参数，而 $K(u)$ 是核函数。\n\n对于本次分析，选择三角核函数，其定义为：\n$$ K(u) = \\begin{cases} 1 - |u| & \\text{如果 } |u| \\le 1 \\\\ 0 & \\text{如果 } |u| > 1 \\end{cases} $$\n使用 $h = 1.0$ 小时的带宽，计算在 $x = 2.8$ 小时这一点上估计的概率密度 $\\hat{f}_h(x)$ 的数值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们已知核密度估计器为\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-x_{i}}{h}\\right),\n$$\n使用三角核函数\n$$\nK(u)=\\begin{cases}\n1-|u| & \\text{如果 } |u|\\leq 1\\\\\n0 & \\text{如果 } |u|>1\n\\end{cases}\n$$\n数据为 $\\{x_{i}\\}=\\{2.1,2.5,3.0,3.8,4.2\\}$，带宽 $h=1.0$，求值点为 $x=2.8$。这里 $n=5$。\n\n由于 $h=1$，我们有 $u_{i}=(x-x_{i})/h=x-x_{i}$。计算每个数据点的贡献：\n- 对于 $x_{1}=2.1$：$u_{1}=2.8-2.1=0.7$，因此 $|u_{1}|\\leq 1$ 且 $K(u_{1})=1-|0.7|=0.3$。\n- 对于 $x_{2}=2.5$：$u_{2}=2.8-2.5=0.3$，因此 $|u_{2}|\\leq 1$ 且 $K(u_{2})=1-|0.3|=0.7$。\n- 对于 $x_{3}=3.0$：$u_{3}=2.8-3.0=-0.2$，因此 $|u_{3}|\\leq 1$ 且 $K(u_{3})=1-|{-0.2}|=0.8$。\n- 对于 $x_{4}=3.8$：$u_{4}=2.8-3.8=-1.0$，因此 $|u_{4}|=1$ 且 $K(u_{4})=1-1=0$。\n- 对于 $x_{5}=4.2$：$u_{5}=2.8-4.2=-1.4$，因此 $|u_{5}|>1$ 且 $K(u_{5})=0$。\n\n因此\n$$\n\\sum_{i=1}^{5}K\\!\\left(\\frac{2.8-x_{i}}{1}\\right)=0.3+0.7+0.8+0+0=1.8.\n$$\n所以，\n$$\n\\hat{f}_{1}(2.8)=\\frac{1}{5\\cdot 1}\\times 1.8=0.36.\n$$\n四舍五入到三位有效数字，得到 $0.360$。", "answer": "$$\\boxed{0.360}$$", "id": "1939894"}, {"introduction": "带宽 $h$ 是核密度估计中的一个关键参数，它控制着最终估计曲线的平滑程度。这个思想实验通过一个独特的、假设的数据集来分离并凸显带宽的作用。通过分析这个特殊案例，你将对 $h$ 如何决定单个核的“宽度”，并进而影响施加于数据上的平滑水平，获得更深刻的直觉理解。[@problem_id:1939933]", "problem": "在统计学习领域，非参数方法被用于估计数据集的潜在概率分布，而无需假设其遵循已知的参数形式。一种常用的技术是核密度估计（KDE）。\n\n一位数据科学家正在处理一个包含 $n$ 个测量值的样本，记为 $X_1, X_2, \\dots, X_n$。由于一个持续的传感器错误，所有收集到的数据点都是相同的，具有相同的常数值 $c$。也就是说，对于所有的 $i=1, 2, \\dots, n$，都有 $X_i = c$。\n\n这位科学家接着对这个不寻常的数据集应用了高斯核密度估计。KDE 的公式，记为 $\\hat{f}_h(x)$，是：\n$$\n\\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^n K\\left(\\frac{x - X_i}{h}\\right)\n$$\n其中 $h > 0$ 是一个称为带宽的平滑参数，而 $K(u)$ 是核函数。对于本次分析，使用的是标准高斯核，其定义为：\n$$\nK(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}u^2\\right)\n$$\n\n下列哪个陈述准确地描述了最终得到的概率密度函数 $\\hat{f}_h(x)$？\n\nA. 一个均值为 $c$、方差为 $h^2$ 的正态分布。\n\nB. 一个均值为 $c$、方差为 $h^2/n$ 的正态分布。\n\nC. 一个由 $n$ 个不同的高斯分布组成的混合分布，所有分布的均值均为 $c$，方差均为 $h$。\n\nD. 在区间 $[c-h, c+h]$ 上的一个均匀分布。\n\nE. 一个均值为 $c$、方差为 $h$ 的正态分布。", "solution": "我们从核密度估计器的定义开始：\n$$\n\\hat{f}_{h}(x) = \\frac{1}{n h} \\sum_{i=1}^{n} K\\!\\left(\\frac{x - X_{i}}{h}\\right),\n$$\n其中高斯核为\n$$\nK(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{1}{2} u^{2}\\right).\n$$\n已知数据满足对于所有的 $i$ 都有 $X_{i} = c$，我们代入可得\n$$\n\\hat{f}_{h}(x) = \\frac{1}{n h} \\sum_{i=1}^{n} K\\!\\left(\\frac{x - c}{h}\\right).\n$$\n由于每个被加项都相同，所以这个和等于公共项的 $n$ 倍：\n$$\n\\hat{f}_{h}(x) = \\frac{1}{n h} \\cdot n \\cdot K\\!\\left(\\frac{x - c}{h}\\right) = \\frac{1}{h} \\, K\\!\\left(\\frac{x - c}{h}\\right).\n$$\n代入高斯核，\n$$\n\\hat{f}_{h}(x) = \\frac{1}{h} \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{1}{2} \\left(\\frac{x - c}{h}\\right)^{2}\\right)\n= \\frac{1}{h \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(x - c)^{2}}{2 h^{2}}\\right).\n$$\n均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态密度函数的一般形式是\n$$\n\\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(x - \\mu)^{2}}{2 \\sigma^{2}}\\right).\n$$\n通过直接比较，我们确定 $\\mu = c$ 且 $\\sigma^{2} = h^{2}$。因此，$\\hat{f}_{h}(x)$ 是一个均值为 $c$、方差为 $h^{2}$ 的正态分布，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1939933"}]}