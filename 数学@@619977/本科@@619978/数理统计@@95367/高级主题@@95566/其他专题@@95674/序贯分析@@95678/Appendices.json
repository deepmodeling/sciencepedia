{"hands_on_practices": [{"introduction": "此练习将引导你完成序贯概率比检验（SPRT）的核心决策过程，这是序贯分析的基石。当你面对两个相互竞争的假设时，SPRT 允许你根据逐个收集的数据动态地更新你的判断。通过这个实践，你将学会如何计算关键的似然比统计量，并将其与预设的决策边界进行比较，从而决定是接受原假设、拒绝原假设还是继续收集更多数据 [@problem_id:1954198]。", "problem": "一位软件工程师正在开发一种新的伪随机数生成器 (PRNG)，该生成器设计用于输出 0 到 9 的单个数字。为了验证其均匀性，设立了一项初步的质量保证测试。该测试关注一个特定的数字“7”，怀疑该数字存在一个错误，导致其在均匀分布的情况下出现频率高于预期。\n\n采用序贯概率比检验 (SPRT) 来在以下两个假设之间做出决策：\n- 原假设 $H_0$：PRNG 是均匀的，生成“7”的概率为 $p_0 = 0.1$。\n- 备择假设 $H_1$：存在错误，生成“7”的概率升高到 $p_1 = 0.2$。\n\n该检验的设计要求 I 类错误概率（当 $H_0$ 为真时拒绝 $H_0$）为 $\\alpha = 0.05$，II 类错误概率（当 $H_1$ 为真时未能拒绝 $H_0$）为 $\\beta = 0.10$。\n\n运行 PRNG 生成 40 个数字后，数字“7”出现了 7 次。基于此观察结果，在此阶段，SPRT 的结论是什么？\n\nA. 接受原假设 $H_0$。\nB. 拒绝原假设 $H_0$。\nC. 继续抽样。\nD. 两个假设的可能性相同。\nE. 检验参数在此场景下无效。", "solution": "我们将每次输出建模为一次伯努利试验 $X_{i}$，表示数字是否为 7 ($X_{i}=1$) 或不是 7 ($X_{i}=0$)，成功概率为 $p$。我们使用序贯概率比检验 (SPRT) 来检验 $H_{0}: p=p_{0}=0.1$ 对比 $H_{1}: p=p_{1}=0.2$。\n\n对于 $n$ 次观测和 $x$ 次成功，在概率 $p$ 下的似然（忽略结果的顺序）为 $L(p)\\propto p^{x}(1-p)^{n-x}$。似然比为\n$$\n\\Lambda_{n}=\\frac{L(p_{1})}{L(p_{0})}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{x}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{n-x}.\n$$\nSPRT 使用阈值\n$$\nA=\\frac{1-\\beta}{\\alpha},\\qquad B=\\frac{\\beta}{1-\\alpha},\n$$\n决策规则为：如果 $\\Lambda_{n}\\geq A$，则拒绝 $H_{0}$；如果 $\\Lambda_{n}\\leq B$，则接受 $H_{0}$；否则，继续抽样。\n\n在本题中，$\\alpha=0.05$，$\\beta=0.10$，$p_{0}=0.1$，$p_{1}=0.2$，$n=40$，且 $x=7$。因此\n$$\nA=\\frac{1-0.10}{0.05}=18,\\qquad B=\\frac{0.10}{1-0.05}=\\frac{2}{19}.\n$$\n计算似然比：\n$$\n\\Lambda_{40}=\\left(\\frac{0.2}{0.1}\\right)^{7}\\left(\\frac{1-0.2}{1-0.1}\\right)^{33}=2^{7}\\left(\\frac{8}{9}\\right)^{33}.\n$$\n等价地，取对数形式，\n$$\n\\ln \\Lambda_{40}=7\\ln 2+33\\ln\\left(\\frac{8}{9}\\right)=7\\ln 2+33\\left(3\\ln 2-2\\ln 3\\right)=106\\ln 2-66\\ln 3.\n$$\n数值计算结果为，\n$$\n\\ln \\Lambda_{40}\\approx 0.965190,\\quad \\text{所以}\\quad \\Lambda_{40}\\approx \\exp(0.965190)\\approx 2.625.\n$$\n与阈值比较：$B=\\frac{2}{19}\\approx 0.105263$ 且 $A=18$。由于 $B<\\Lambda_{40}<A$，SPRT 在此阶段的决策是继续抽样。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1954198"}, {"introduction": "在掌握了如何执行一次序贯检验之后，下一个自然而然的问题是：“这个检验的效率如何？” 平均样本数（ASN）是衡量序贯检验效率的关键指标，它通常能凸显序贯方法相对于固定样本量检验的优越性。这个练习将向你展示如何使用 Wald 的近似公式来估算在特定条件下得出结论所需的平均样本量，这让你能深入理解序贯分析在节约时间和资源方面的实际价值 [@problem_id:1954190]。", "problem": "一家半导体制造商正在评估一种旨在降低微芯片次品率的新制造工艺。旧工艺的历史次品率为 $p_0 = 0.10$。如果新工艺能达到 $p_1 = 0.05$ 的次品率，则被认为是一项重大改进。\n\n为了在原假设 $H_0: p = p_0$ 和备择假设 $H_1: p = p_1$ 之间做出决策，质量控制团队采用了序贯概率比检验 (SPRT)。该检验设计的I型错误概率为 $\\alpha = 0.05$（错误地断定新工艺有所改进），II型错误概率为 $\\beta = 0.10$（在新工艺确实有改进时未能检测出来）。\n\n每次微芯片检验都是一个独立的伯努利试验，其中‘1’表示有缺陷的芯片，‘0’表示功能正常的芯片。假设新工艺的真实次品率实际上仍然是 $p_0 = 0.10$，计算近似的平均样本数 (ASN)，即为了得出结论需要检验的微芯片的期望数量。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用SPRT来检验 $H_{0}: p=p_{0}$ 与 $H_{1}: p=p_{1}$。对于独立的伯努利($p$)观测值 $X_{i}\\in\\{0,1\\}$，单个观测值的对数似然比增量为\n$$\nY=\\ln\\Lambda_{1}=X\\ln\\left(\\frac{p_{1}}{p_{0}}\\right)+(1-X)\\ln\\left(\\frac{1-p_{1}}{1-p_{0}}\\right).\n$$\n在 $H_{0}$ 下，其期望值为\n$$\n\\mu_{0}=E_{0}[Y]=p_{0}\\ln\\left(\\frac{p_{1}}{p_{0}}\\right)+(1-p_{0})\\ln\\left(\\frac{1-p_{1}}{1-p_{0}}\\right).\n$$\n设I型和II型错误分别为 $\\alpha$ 和 $\\beta$，则SPRT的似然比边界为 $A=\\frac{1-\\beta}{\\alpha}$ 和 $B=\\frac{\\beta}{1-\\alpha}$，因此 $a=\\ln A$ 和 $b=\\ln B$。Wald 对 $H_{0}$ 下平均样本数的近似值为\n$$\nE_{0}[N]\\approx \\frac{\\alpha\\,a+(1-\\alpha)\\,b}{\\mu_{0}}.\n$$\n代入 $p_{0}=0.10$, $p_{1}=0.05$, $\\alpha=0.05$, $\\beta=0.10$。计算\n$$\na=\\ln\\left(\\frac{1-\\beta}{\\alpha}\\right)=\\ln(18),\\quad b=\\ln\\left(\\frac{\\beta}{1-\\alpha}\\right)=\\ln\\left(\\frac{0.10}{0.95}\\right),\n$$\n$$\n\\mu_{0}=0.10\\ln\\left(\\frac{0.05}{0.10}\\right)+0.90\\ln\\left(\\frac{0.95}{0.90}\\right)=0.10\\ln\\left(\\frac{1}{2}\\right)+0.90\\ln\\left(\\frac{19}{18}\\right).\n$$\n数值上，\n$$\na=\\ln(18)\\approx 2.890371758,\\quad b=\\ln\\left(\\frac{0.10}{0.95}\\right)\\approx -2.251291799,\n$$\n$$\n\\mu_{0}\\approx 0.10(-0.693147181)+0.90(0.054067221)\\approx -0.020654219.\n$$\n因此，\n$$\nE_{0}[N]\\approx \\frac{0.05\\cdot 2.890371758+0.95\\cdot(-2.251291799)}{-0.020654219}\\approx \\frac{-1.994208621}{-0.020654219}\\approx 96.6,\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{96.6}$$", "id": "1954190"}, {"introduction": "序贯分析的应用远不止于假设检验。这个最后的实践将带你探索其在参数估计领域的强大功能，特别是著名的 Stein 两阶段抽样程序。当总体方差 $\\sigma^2$ 未知时，传统的固定样本方法无法保证获得一个具有预定宽度的置信区间，而 Stein 的方法通过一个巧妙的两步过程解决了这一难题。通过这个练习，你将体会到序贯策略如何灵活地应对现实世界中的统计挑战，以高效的方式实现精确的估计目标 [@problem_id:1954192]。", "problem": "一个材料工程团队正在为航空航天应用开发一种新型轻质复合材料。认证的一个关键参数是材料的极限抗压强度。根据以往处理类似材料的经验，该团队将任何给定样本 $X_i$ 的抗压强度建模为一个服从正态分布 $N(\\mu, \\sigma^2)$ 的随机变量，其中平均强度 $\\mu$ 和方差 $\\sigma^2$ 均为未知。\n\n该团队的目标是通过构建一个预定固定宽度的置信区间来估计平均抗压强度 $\\mu$。具体来说，他们要求 $\\mu$ 的95%置信区间的总宽度不超过 $2d = 10$ MPa。由于总体方差 $\\sigma^2$ 未知，固定样本量的实验无法保证此精度。\n\n为了解决这个问题，该团队采用了Stein的两阶段抽样程序：\n1.  生产并测试一个包含 $n_0 = 20$ 个样本的试验批次，以获得方差的初始估计值 $S_{20}^2$。\n2.  使用这个试验方差估计值来确定达到所需置信区间宽度所需的总样本数 $N$。\n3.  如果 $N > n_0$，则额外测试 $N - n_0$ 个样本。\n4.  使用所有 $N$ 个样本计算 $\\mu$ 的最终置信区间。\n\n确定总样本量 $N$ 的规则基于试验研究的结果。已知在95%置信水平下，自由度为19的t分布的临界值为 $t_{19, 0.025} = 2.093$。\n\n计算此程序所需的近似总样本期望值 $E[N]$。在此计算中，假设材料抗压强度的真实（但工程师未知）标准差为 $\\sigma = 25$ MPa。\n\n将最终答案四舍五入到四位有效数字。", "solution": "我们将 $X_{i}$ 建模为 $X_{i} \\sim N(\\mu,\\sigma^{2})$，其中 $\\mu$ 和 $\\sigma^{2}$ 均未知。对于基于 $N$ 个观测值的 $\\mu$ 的双侧置信区间，其半宽为\n$$\nh_{N} \\equiv t_{N-1,\\,1-\\alpha/2}\\,\\frac{S_{N}}{\\sqrt{N}},\n$$\n且要求的总宽度约束 $2h_{N} \\leq 2d$ 等价于 $h_{N} \\leq d$。在Stein的两阶段抽样程序中，试验样本量为 $n_{0}$，一个常见的规则将总样本量设定为\n$$\nN = \\max\\left\\{n_{0}, \\left\\lceil \\frac{t_{n_{0}-1,\\,1-\\alpha/2}^{2} S_{n_{0}}^{2}}{d^{2}} \\right\\rceil \\right\\},\n$$\n因此，试验估计值 $S_{n_{0}}^{2}$ 和 $t_{n_{0}-1,\\,1-\\alpha/2}$ 决定了 $N$。此处 $n_{0}=20$，$\\alpha=0.05$，并且给定 $t_{19,\\,0.025}=2.093$。目标半宽为 $d=\\frac{10}{2}=5$ MPa。\n\n为了计算近似的总样本期望值 $E[N]$，我们利用在真实标准差 $\\sigma$ 下，试验方差满足\n$$\n\\frac{(n_{0}-1)S_{n_{0}}^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n_{0}-1} \\quad \\Rightarrow \\quad E[S_{n_{0}}^{2}] = \\sigma^{2}.\n$$\n通过将 $S_{n_{0}}^{2}$ 替换为其均值 $\\sigma^{2}$ 并忽略期望中的向上取整函数，我们近似地得到\n$$\nE[N] \\approx \\max\\left\\{n_{0}, \\frac{t_{n_{0}-1,\\,1-\\alpha/2}^{2} \\sigma^{2}}{d^{2}} \\right\\}.\n$$\n当 $\\sigma=25$ MPa, $n_{0}=20$, $d=5$ MPa, 且 $t_{19,\\,0.025}=2.093$ 时，\n$$\n\\frac{t_{19,\\,0.025}^{2}\\,\\sigma^{2}}{d^{2}}\n= \\frac{(2.093)^{2}\\,(25)^{2}}{(5)^{2}}\n= (2.093)^{2}\\times \\frac{625}{25}\n= (2.093)^{2}\\times 25.\n$$\n计算平方：\n$$\n(2.093)^{2} = 4.380649,\n$$\n因此\n$$\n(2.093)^{2}\\times 25 = 4.380649 \\times 25 = 109.516225.\n$$\n由于 $109.516225 > n_{0}=20$，最大值由该项取得，所以\n$$\nE[N] \\approx 109.516225.\n$$\n四舍五入到四位有效数字得到 $109.5$。", "answer": "$$\\boxed{109.5}$$", "id": "1954192"}]}