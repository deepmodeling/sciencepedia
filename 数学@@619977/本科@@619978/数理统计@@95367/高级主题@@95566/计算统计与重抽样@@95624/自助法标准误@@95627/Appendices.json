{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的应用开始：估算样本均值的标准误。这个练习将带你一步步走过自助法的核心流程——通过对原始样本进行重复抽样来模拟抽样分布，并以此来量化我们对总体均值估计的不确定性。这是理解自助法思想的完美起点。[@problem_id:1902064]", "problem": "一位环境科学家正在评估某条河流中一种特定污染物“化合物X”的浓度。采集了一个包含五个水质测量值的小样本，得到的浓度值（单位：百万分率 (PPM)）如下：\n$$ S = \\{10.2, 11.5, 9.8, 12.1, 10.9\\} $$\n为了估计样本均值浓度的变异性，采用了一种自助法（bootstrap）程序。从原始样本 $S$ 中，通过有放回抽样生成了四个自助样本，每个样本的大小为五。得到的自助样本如下：\n- 自助样本1：$\\{10.2, 12.1, 9.8, 10.2, 11.5\\}$\n- 自助样本2：$\\{11.5, 11.5, 10.9, 9.8, 12.1\\}$\n- 自助样本3：$\\{9.8, 12.1, 12.1, 10.9, 10.2\\}$\n- 自助样本4：$\\{10.9, 10.2, 9.8, 11.5, 10.9\\}$\n\n根据这四个自助样本，计算样本均值的自助标准误。请以PPM为单位表示最终答案，并四舍五入至三位有效数字。", "solution": "样本均值的自助标准误是各自助样本均值的标准差。对于自助法重复样本 $b=1,\\dots,B$（其中 $B=4$），设 $\\bar{x}^{*(b)}$ 为第 $b$ 个自助样本的均值，并设 $\\bar{\\bar{x}}^{*}=\\frac{1}{B}\\sum_{b=1}^{B}\\bar{x}^{*(b)}$ 为这些自助样本均值的平均值。自助标准误为\n$$\n\\operatorname{SE}_{\\text{boot}}=\\sqrt{\\frac{1}{B-1}\\sum_{b=1}^{B}\\left(\\bar{x}^{*(b)}-\\bar{\\bar{x}}^{*}\\right)^{2}}.\n$$\n计算各自助样本的均值：\n- 自助样本1：和 $=10.2+12.1+9.8+10.2+11.5=53.8$，因此 $\\bar{x}^{*(1)}=\\frac{53.8}{5}=10.76$。\n- 自助样本2：和 $=11.5+11.5+10.9+9.8+12.1=55.8$，因此 $\\bar{x}^{*(2)}=\\frac{55.8}{5}=11.16$。\n- 自助样本3：和 $=9.8+12.1+12.1+10.9+10.2=55.1$，因此 $\\bar{x}^{*(3)}=\\frac{55.1}{5}=11.02$。\n- 自助样本4：和 $=10.9+10.2+9.8+11.5+10.9=53.3$，因此 $\\bar{x}^{*(4)}=\\frac{53.3}{5}=10.66$。\n\n自助样本均值的平均值：\n$$\n\\bar{\\bar{x}}^{*}=\\frac{10.76+11.16+11.02+10.66}{4}=10.9.\n$$\n计算平方偏差：\n$$\n(10.76-10.9)^{2}=0.0196,\\quad (11.16-10.9)^{2}=0.0676,\\quad (11.02-10.9)^{2}=0.0144,\\quad (10.66-10.9)^{2}=0.0576,\n$$\n所以\n$$\n\\sum_{b=1}^{4}\\left(\\bar{x}^{*(b)}-\\bar{\\bar{x}}^{*}\\right)^{2}=0.0196+0.0676+0.0144+0.0576=0.1592.\n$$\n因此，\n$$\n\\operatorname{SE}_{\\text{boot}}=\\sqrt{\\frac{0.1592}{4-1}}=\\sqrt{0.053066\\overline{6}}\\approx 0.230362\\ldots\n$$\n四舍五入到三位有效数字，自助标准误为 $0.230$ PPM。", "answer": "$$\\boxed{0.230}$$", "id": "1902064"}, {"introduction": "在掌握了基础知识后，让我们来探索自助法真正的威力所在：处理那些没有简单解析公式的标准误的统计量。本练习将以四分位数极差（$IQR$）为例，这是一个衡量数据离散程度的稳健统计量。你将学会如何应用自助法来估计 $IQR$ 的标准误，从而体会到该方法在处理复杂统计量时的灵活性与实用性。[@problem_id:1902091]", "problem": "一位数据分析师正在研究一个小社区的房价波动性。他们收集了一个包含5个近期销售价格的小型随机样本。价格以千美元为单位，如下所示：\n\n$$ S = \\{420, 650, 350, 400, 500\\} $$\n\n该分析师对四分位距（IQR）的抽样变异性感兴趣，四分位距是统计离散程度的一个稳健度量。为了从单个样本 $S$ 中估计这种变异性，该分析师使用了自助法（bootstrap method）。他们通过对原始样本 $S$ 进行有放回的重抽样，生成了 $B=4$ 个自助样本。这四个自助样本是：\n\n- 自助样本 1：$\\{350, 350, 420, 500, 500\\}$\n- 自助样本 2：$\\{650, 400, 500, 400, 650\\}$\n- 自助样本 3：$\\{420, 500, 350, 420, 400\\}$\n- 自助样本 4：$\\{350, 650, 650, 420, 500\\}$\n\n就本问题而言，对于任何大小为 $n=5$ 的样本，第一四分位数（Q1）和第三四分位数（Q3）的定义如下：将数据按升序排序后，Q1是排序后列表中的第二个值，Q3是第四个值。IQR 则定义为 $Q3 - Q1$。\n\n使用提供的四个自助样本，计算样本IQR的自助标准误。将您的最终答案以千美元为单位表示，并四舍五入到四位有效数字。", "solution": "对于大小为 $n=5$ 的样本，根据给定的四分位数规则，四分位距（IQR）为 $Q3 - Q1$，其中，将数值按升序排序后，$Q1$ 是第二个值，$Q3$ 是第四个值。\n\n计算每个自助样本的IQR（数值单位为千美元）：\n- 自助样本1：排序后为 $\\{350,350,420,500,500\\}$，得到 $Q1=350$，$Q3=500$，所以 $\\operatorname{IQR}_{1}=500-350=150$。\n- 自助样本2：排序后为 $\\{400,400,500,650,650\\}$，得到 $Q1=400$，$Q3=650$，所以 $\\operatorname{IQR}_{2}=650-400=250$。\n- 自助样本3：排序后为 $\\{350,400,420,420,500\\}$，得到 $Q1=400$，$Q3=420$，所以 $\\operatorname{IQR}_{3}=420-400=20$。\n- 自助样本4：排序后为 $\\{350,420,500,650,650\\}$，得到 $Q1=420$，$Q3=650$，所以 $\\operatorname{IQR}_{4}=650-420=230$。\n\n设 $B=4$，并将自助IQR表示为 $\\hat{\\theta}^{*1},\\ldots,\\hat{\\theta}^{*4}$。自助标准误是自助复制样本的样本标准差：\n$$\n\\widehat{\\operatorname{se}}_{\\text{boot}}=\\left(\\frac{1}{B-1}\\sum_{b=1}^{B}\\left(\\hat{\\theta}^{*b}-\\bar{\\hat{\\theta}}^{*}\\right)^{2}\\right)^{\\frac{1}{2}},\n$$\n其中\n$$\n\\bar{\\hat{\\theta}}^{*}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{\\theta}^{*b}.\n$$\n\n在此例中，\n$$\n\\hat{\\theta}^{*1}=150,\\quad \\hat{\\theta}^{*2}=250,\\quad \\hat{\\theta}^{*3}=20,\\quad \\hat{\\theta}^{*4}=230,\n$$\n所以\n$$\n\\bar{\\hat{\\theta}}^{*}=\\frac{150+250+20+230}{4}=162.5.\n$$\n计算离差平方和：\n$$\n\\sum_{b=1}^{4}\\left(\\hat{\\theta}^{*b}-\\bar{\\hat{\\theta}}^{*}\\right)^{2}=(150-162.5)^{2}+(250-162.5)^{2}+(20-162.5)^{2}+(230-162.5)^{2}.\n$$\n计算每一项：\n$$\n(150-162.5)^{2}=156.25,\\quad (250-162.5)^{2}=7656.25,\\quad (20-162.5)^{2}=20306.25,\\quad (230-162.5)^{2}=4556.25.\n$$\n因此，\n$$\n\\sum_{b=1}^{4}\\left(\\hat{\\theta}^{*b}-\\bar{\\hat{\\theta}}^{*}\\right)^{2}=156.25+7656.25+20306.25+4556.25=32675.\n$$\n因此，\n$$\n\\widehat{\\operatorname{se}}_{\\text{boot}}=\\left(\\frac{32675}{4-1}\\right)^{\\frac{1}{2}}=\\left(\\frac{32675}{3}\\right)^{\\frac{1}{2}}\\approx 104.363148\\ldots\n$$\n四舍五入到四位有效数字得到 $104.4$（单位：千美元）。", "answer": "$$\\boxed{104.4}$$", "id": "1902091"}, {"introduction": "最后，我们将自助法的应用拓展到更复杂的预测模型中，这在现代数据科学和机器学习中非常普遍。本练习将介绍如何通过残差自助法（residual bootstrap）来估计一个多元线性回归模型的预测标准误。通过这个实践，你将看到自助法不仅仅是用于估计单个参数，更是评估复杂模型预测不确定性的强大工具。[@problem_id:1902043]", "problem": "一位数据科学家正在使用形式为 $Y_i = \\beta_0 + \\beta_1 X_{i1} + \\beta_2 X_{i2} + \\epsilon_i$ 的多元线性回归模型来分析一个数据集，其中假定误差 $\\epsilon_i$ 独立同分布，且均值为零。在使用普通最小二乘法 (OLS) 对数据样本拟合模型后，该科学家希望对一组新的预测变量值的预测不确定性进行估计。\n\n需要进行预测的新观测向量为 $\\mathbf{x}_{\\text{new}}$，对应的值为 $X_1 = 4$ 和 $X_2 = 2$。为了估计预测值 $\\hat{y}_{\\text{new}}$ 的标准误，该科学家采用了一种残差自助法 (residual bootstrap) 程序。在此程序中，研究者生成大量的响应变量的自助样本，对每个样本重新拟合回归模型，并每次都计算一个新的预测值。\n\n该科学家使用 $B=6$ 次自助法重复执行了此程序。对于新观测向量 $\\mathbf{x}_{\\text{new}}$，得到的六个预测值如下所示：\n$$ \\{ 21.6, 20.3, 22.1, 20.6, 21.1, 20.9 \\} $$\n使用这组自助法预测值，计算预测值 $\\hat{y}_{\\text{new}}$ 的标准误的自助法估计。将您的最终答案四舍五入到四位有效数字。", "solution": "我们要求在 $\\mathbf{x}_{\\text{new}}$ 处预测的标准误的自助法估计值。使用 $B$ 个自助法预测值 $\\{\\hat{y}_{\\text{new}}^{*(b)}: b=1,\\dots,B\\}$，标准误的标准自助法估计是样本标准差：\n$$\n\\widehat{\\operatorname{SE}}_{\\text{boot}}(\\hat{y}_{\\text{new}})=\\left[\\frac{1}{B-1}\\sum_{b=1}^{B}\\left(\\hat{y}_{\\text{new}}^{*(b)}-\\bar{\\hat{y}}_{\\text{new}}^{*}\\right)^{2}\\right]^{\\frac{1}{2}},\n$$\n其中 $\\bar{\\hat{y}}_{\\text{new}}^{*}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{y}_{\\text{new}}^{*(b)}$。\n\n给定 $B=6$ 和自助法预测值 $\\{21.6, 20.3, 22.1, 20.6, 21.1, 20.9\\}$，计算均值：\n$$\n\\bar{\\hat{y}}_{\\text{new}}^{*}=\\frac{21.6+20.3+22.1+20.6+21.1+20.9}{6}=\\frac{126.6}{6}=21.1.\n$$\n计算偏差及其平方：\n$$\n\\{0.5,-0.8,1.0,-0.5,0.0,-0.2\\}\\quad\\Rightarrow\\quad\\{0.25,0.64,1.00,0.25,0.00,0.04\\}.\n$$\n偏差平方和：\n$$\n\\sum_{b=1}^{6}\\left(\\hat{y}_{\\text{new}}^{*(b)}-\\bar{\\hat{y}}_{\\text{new}}^{*}\\right)^{2}=2.18.\n$$\n样本方差：\n$$\ns^{2}=\\frac{2.18}{6-1}=0.436.\n$$\n因此，自助法标准误是\n$$\n\\widehat{\\operatorname{SE}}_{\\text{boot}}(\\hat{y}_{\\text{new}})=\\sqrt{0.436}\\approx 0.6603,\n$$\n四舍五入到四位有效数字。", "answer": "$$\\boxed{0.6603}$$", "id": "1902043"}]}