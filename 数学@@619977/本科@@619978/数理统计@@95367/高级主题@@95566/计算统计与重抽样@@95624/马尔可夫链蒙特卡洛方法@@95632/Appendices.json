{"hands_on_practices": [{"introduction": "Metropolis-Hastings 算法的核心在于其接受概率，它巧妙地引导马尔可夫链趋向于目标分布。这个练习将让你亲手计算一个具体的接受概率，帮助你直观地理解算法是如何决定接受或拒绝一个新提议的状态的。这是掌握 MCMC 方法的第一个基本功 [@problem_id:1371728]。", "problem": "一位数据科学家正在实现一个马尔可夫链蒙特卡洛 (MCMC) 模拟，以从参数 $x$ 的后验概率分布中抽取样本。目标分布 $\\pi(x)$ 与参数负绝对值的指数成正比，即 $\\pi(x) \\propto \\exp(-|x|)$。\n\n该科学家使用 Metropolis 算法，其提议分布 $q(x'|x)$ 是对称的，即在给定当前状态 $x$ 的情况下提议新状态 $x'$ 的概率等于在给定 $x'$ 的情况下提议 $x$ 的概率 (即 $q(x'|x) = q(x|x')$)。\n\n假设在模拟的某一步中，链的当前状态为 $x = 1.5$。然后算法提议移动到一个新的候选状态 $x' = 2.0$。\n\n计算这个特定移动的接受概率。你的答案应该是一个无量纲的实数。将最终答案四舍五入至四位有效数字。", "solution": "对于一个从 $x$ 到 $x'$ 的移动，在对称提议分布 $q(x'|x)=q(x|x')$ 下，Metropolis 接受概率为\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\frac{\\pi(x')q(x|x')}{\\pi(x)q(x'|x)}\\right)=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x)}\\right).\n$$\n给定目标分布 $\\pi(x)\\propto \\exp(-|x|)$，该比率简化为\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\frac{\\exp(-|x'|)}{\\exp(-|x|)}=\\exp\\!\\left(-\\left(|x'|-|x|\\right)\\right).\n$$\n当 $x=1.5$ 且 $x'=2.0$ 时，我们有 $|x|=1.5$ 和 $|x'|=2.0$，因此\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\exp\\!\\left(-\\left(2.0-1.5\\right)\\right)=\\exp(-0.5).\n$$\n因此，\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\exp(-0.5)\\right)=\\exp(-0.5).\n$$\n数值上，当四舍五入到四位有效数字时，$\\exp(-0.5)\\approx 0.6065$。", "answer": "$$\\boxed{0.6065}$$", "id": "1371728"}, {"introduction": "与 Metropolis-Hastings 不同，吉布斯采样（Gibbs sampling）将一个复杂的多维采样问题分解为一系列更简单的一维采样。这个过程的关键在于从联合分布中推导出每个变量的“满条件分布”。通过这个练习，你将学会如何为一个定义在二维空间上的简单目标分布推导其满条件分布，这是构建任何吉布斯采样器的基础 [@problem_id:1932854]。", "problem": "吉布斯采样是一种马尔可夫链蒙特卡洛 (MCMC) 算法，用于生成一个观测序列来近似目标多元概率分布，当直接采样困难时，该算法尤其有用。实现吉布斯采样的一个关键步骤是推导模型中每个变量的全条件分布。\n\n考虑一个二元随机向量 $(X, Y)$，其联合概率密度函数 (PDF) $p(x, y)$ 在 $xy$-平面上的一个三角形区域 $\\mathcal{R}$ 内是均匀分布。该区域 $\\mathcal{R}$ 由不等式 $x>0$、$y>0$ 和 $x+y < 1$ 定义。因此，联合概率密度函数为：\n$$\np(x, y) =\n\\begin{cases}\n2 & \\text{if } (x,y) \\in \\mathcal{R} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n为了构建针对此分布的吉布斯采样，我们需要全条件分布 $p(x|y)$ 和 $p(y|x)$。\n\n下列哪个选项正确地指出了这两个条件分布？请注意，$\\text{Uniform}(a,b)$ 表示在区间 $(a,b)$ 上的均匀分布。\n\nA: $p(x|y)$ 对 $y \\in (0,1)$ 为 Uniform$(0, 1-y)$ 分布，$p(y|x)$ 对 $x \\in (0,1)$ 为 Uniform$(0, 1-x)$ 分布。\n\nB: $p(x|y)$ 对 $y \\in (0,1)$ 为 Uniform$(0, 1)$ 分布，$p(y|x)$ 对 $x \\in (0,1)$ 为 Uniform$(0, 1)$ 分布。\n\nC: $p(x|y)$ 对 $y \\in (0,1)$ 为 Uniform$(0, y)$ 分布，$p(y|x)$ 对 $x \\in (0,1)$ 为 Uniform$(0, x)$ 分布。\n\nD: 条件分布不是均匀分布。\n\nE: $p(x|y)$ 对 $y \\in (0,1)$ 为 Uniform$(y, 1)$ 分布，$p(y|x)$ 对 $x \\in (0,1)$ 为 Uniform$(x, 1)$ 分布。", "solution": "给定联合密度 $p(x,y)$，它在区域 $\\mathcal{R}=\\{(x,y): x>0,\\ y>0,\\ x+y<1\\}$ 上是均匀的，其中在 $\\mathcal{R}$ 上 $p(x,y)=2$，其他情况下为 $0$。为了得到全条件分布，我们通过边缘分布来使用条件分布的定义。\n\n首先，计算 $Y$ 的边缘密度。对于一个固定的 $y$，在 $0<y<1$ 的条件下，$x$ 的允许值满足 $0<x<1-y$。因此，\n$$\np_{Y}(y)=\\int_{-\\infty}^{\\infty} p(x,y)\\,dx=\\int_{0}^{1-y} 2\\,dx=2(1-y), \\quad \\text{for } 0<y<1,\n$$\n其他情况下 $p_{Y}(y)=0$。\n\n那么，在给定 $Y=y$ 的条件下，$X$ 的条件密度是\n$$\np_{X\\mid Y}(x\\mid y)=\\frac{p(x,y)}{p_{Y}(y)}=\\frac{2}{2(1-y)}=\\frac{1}{1-y},\n$$\n此式在 $p(x,y)>0$ 的支撑集上成立，即 $0<x<1-y$ (且 $0<y<1$)。这是在 $(0,1-y)$ 上的均匀分布的密度：\n$$\nX\\mid Y=y \\sim \\text{Uniform}(0,1-y), \\quad \\text{for } 0<y<1.\n$$\n\n根据对称性，计算 $X$ 的边缘密度：\n$$\np_{X}(x)=\\int_{-\\infty}^{\\infty} p(x,y)\\,dy=\\int_{0}^{1-x} 2\\,dy=2(1-x), \\quad \\text{for } 0<x<1,\n$$\n其他情况下 $p_{X}(x)=0$。\n\n那么，在给定 $X=x$ 的条件下，$Y$ 的条件密度是\n$$\np_{Y\\mid X}(y\\mid x)=\\frac{p(x,y)}{p_{X}(x)}=\\frac{2}{2(1-x)}=\\frac{1}{1-x},\n$$\n在 $0<y<1-x$ (且 $0<x<1$) 上成立。这是在 $(0,1-x)$ 上的均匀分布的密度：\n$$\nY\\mid X=x \\sim \\text{Uniform}(0,1-x), \\quad \\text{for } 0<x<1.\n$$\n\n因此，正确的选项是两个条件分布都在由约束 $x+y<1$ 决定的相应截断区间上是均匀分布，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1932854"}, {"introduction": "理论上正确的算法在实践中未必高效，MCMC 方法的性能往往取决于关键参数的调整。本练习将探讨随机游走 Metropolis 算法中一个至关重要的参数——提议分布的宽度（或步长）。你将通过分析过大或过小的步长如何影响采样器的接受率和探索效率，来理解这其中的权衡，这是一项优化 MCMC 性能的实用技能 [@problem_id:1932810]。", "problem": "一位分析师正在使用马尔可夫链蒙特卡洛 (MCMC) 方法，具体来说是随机游走Metropolis算法，从定义在实数轴上的一个连续、单峰的目标概率密度函数 $\\pi(x)$ 中生成样本。该算法流程如下：给定链的当前状态为 $x^{(t)}$，从一个对称的提议分布 $q(x'|x^{(t)})$ 中提议一个新的候选状态 $x'$。在此具体实现中，提议是通过添加一个随机扰动来生成的：$x' = x^{(t)} + \\epsilon$，其中 $\\epsilon$ 从均值为0、标准差为 $\\sigma$ 的正态分布中抽取，即 $\\epsilon \\sim N(0, \\sigma^2)$。提议的状态 $x'$ 以概率 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$被接受为下一个状态 $x^{(t+1)} = x'$。如果提议被拒绝，链将保持在当前状态，即 $x^{(t+1)} = x^{(t)}$。\n\n该分析师正在试验提议分布标准差的两种不同设置：\n1.  一个非常窄的提议分布，其中 $\\sigma = \\sigma_{small}$ 是一个非常小的正数。\n2.  一个非常宽的提议分布，其中 $\\sigma = \\sigma_{large}$ 是一个非常大的正数。\n\n假设链已在一个具有不可忽略概率的区域（例如，靠近 $\\pi(x)$ 的众数）被初始化。以下哪个陈述最准确地描述了MCMC链在这两种情况下的预期行为？\n\nA. 窄提议 ($\\sigma_{small}$) 会导致低接受率和慢速探索。宽提议 ($\\sigma_{large}$) 会导致高接受率和快速探索。\n\nB. 两种提议宽度将导致相似的接受率，但使用宽提议 ($\\sigma_{large}$) 的链将比使用窄提议 ($\\sigma_{small}$) 的链更快地探索状态空间。\n\nC. 窄提议 ($\\sigma_{small}$) 将导致非常高的接受率，但链将非常缓慢地探索状态空间。宽提议 ($\\sigma_{large}$) 将导致非常低的接受率，使链在多次迭代中停留在同一状态。\n\nD. 窄提议 ($\\sigma_{small}$) 会导致高接受率和快速探索。宽提议 ($\\sigma_{large}$) 会导致低接受率和慢速探索。\n\nE. 提议分布的宽度对算法性能的影响可以忽略不计；接受率和探索速度主要由目标分布 $\\pi(x)$ 的性质决定。", "solution": "该问题要求我们分析随机游走Metropolis算法的行为，重点关注提议分布 $N(0, \\sigma^2)$ 的宽度（标准差 $\\sigma$）如何影响链的接受率及其探索目标分布 $\\pi(x)$ 状态空间的能力。\n\n从 $x^{(t)}$ 到 $x'$ 的提议移动的接受概率由 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$ 给出。我们来分别分析这两种情况。\n\n**情况1：窄提议分布 ($\\sigma = \\sigma_{small}$)**\n\n当标准差 $\\sigma_{small}$ 非常小时，从 $N(0, \\sigma_{small}^2)$ 中抽取的随机扰动 $\\epsilon$ 的量级也会非常小。这意味着提议的状态 $x' = x^{(t)} + \\epsilon$ 将非常接近当前状态 $x^{(t)}$。\n\n由于目标分布 $\\pi(x)$ 是连续的，如果 $x'$ 非常接近 $x^{(t)}$，那么这两点的概率密度值 $\\pi(x')$ 和 $\\pi(x^{(t)})$ 将会非常相似。\n因此，比率 $\\frac{\\pi(x')}{\\pi(x^{(t)})}$ 将非常接近1。\n\n接受概率为 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$。由于该比率接近1，接受概率 $\\alpha$ 将会非常高（接近1）。这意味着几乎每一个提议的移动都会被接受。\n\n然而，由于每次接受的移动都只是离前一个位置迈出了一小步，链在状态空间中的移动非常缓慢。这是一种探索目标分布 $\\pi(x)$ 全范围（尤其是尾部）的低效方式。链表现出高自相关性，意味着连续的样本高度相关，需要非常大量的迭代才能获得一组具有代表性的独立样本。这构成了非常缓慢的探索。\n\n**情况2：宽提议分布 ($\\sigma = \\sigma_{large}$)**\n\n当标准差 $\\sigma_{large}$ 非常大时，随机扰动 $\\epsilon$ 的量级通常会很大。这意味着提议的状态 $x' = x^{(t)} + \\epsilon$ 很可能离当前状态 $x^{(t)}$ 非常远。\n\n我们已知目标分布 $\\pi(x)$ 是单峰的，并且链从一个高概率区域（靠近众数）开始。当链处于这样的区域时，$\\pi(x^{(t)})$ 相对较大。从 $x^{(t)}$ 进行一次大跳跃，很可能落入分布尾部很远的区域，那里的概率密度极低。因此，$\\pi(x') \\ll \\pi(x^{(t)})$ 的可能性非常高。\n\n在这种情况下，比率 $\\frac{\\pi(x')}{\\pi(x^{(t)})}$ 将非常接近0。\n\n接受概率为 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$。由于该比率非常小，接受概率 $\\alpha$ 也将非常小。这意味着绝大多数提议的移动都将被拒绝。\n\n当一个提议被拒绝时，链不会移动：$x^{(t+1)} = x^{(t)}$。因此，对于宽提议分布，链将在许多连续的迭代中停留在同一状态，等待一个罕见的、恰好落入另一个高概率区域的提议。这也是一种非常低效的状态空间探索方式。\n\n**结论与选项评估：**\n\n-   窄提议会带来**高接受率**但**慢速探索**。\n-   宽提议会带来**低接受率**和**慢速探索**（因为链会卡住）。\n\n让我们基于此分析评估给出的选项：\n\n-   **A：**不正确。它声称宽提议会导致高接受率。\n-   **B：**不正确。它声称两者有相似的接受率。\n-   **C：**这个陈述正确地捕捉了两种行为。窄提议导致高接受率但慢速探索。宽提议导致非常低的接受率，使链卡住。这是最准确的描述。\n-   **D：**不正确。它声称窄提议会导致快速探索。\n-   **E：**不正确。提议分布的宽度是一个关键的调节参数，它深刻地影响算法的性能。\n\n因此，最准确的陈述是C。", "answer": "$$\\boxed{C}$$", "id": "1932810"}]}