{"hands_on_practices": [{"introduction": "自助法最核心和直接的应用之一就是为未知参数构建置信区间。本练习模拟了一个常见的质量控制场景，旨在为产品的不良率（一个比例）估计其不确定性。通过这个实践，你将学会如何解读自助法模拟产生的大量重抽样统计量，并利用百分位数法来构建一个置信区间 [@problem_id:1959396]，这是运用自助法进行统计推断的一项基本技能。", "problem": "一家半导体制造厂的质量控制工程师负责评估一种新型处理器的可靠性。从一大批产品中随机抽取 $n=200$ 个处理器样本，并对它们进行严苛的压力测试。在该样本中，有 $x=24$ 个处理器未能通过测试。该工程师希望为整批产品中会在此测试中失效的真实但未知的处理器比例 $p$ 构建一个置信区间。\n\n为实现这一目标，工程师采用了一种计算方法。首先，生成大量的“自助样本”。每个自助样本的大小为 $n=200$，是通过从原始的200个处理器样本中进行*有放回*抽样创建的。对于每个自助样本，计算失效处理器的比例，我们称之为 $\\hat{p}^*$。这个过程重复 $B = 2000$ 次，得到2000个自助比例：$\\hat{p}^*_1, \\hat{p}^*_2, \\dots, \\hat{p}^*_{2000}$。\n\n然后将这2000个比例按升序排序，记为 $\\hat{p}^*_{(1)} \\le \\hat{p}^*_{(2)} \\le \\dots \\le \\hat{p}^*_{(2000)}$。工程师记录下构建95%置信区间所需的关键百分位数附近的值。从排序后的列表中记录的值如下：\n- 第49个值：$\\hat{p}^*_{(49)} = 0.075$\n- 第50个值：$\\hat{p}^*_{(50)} = 0.080$\n- 第51个值：$\\hat{p}^*_{(51)} = 0.080$\n- ...\n- 第1949个值：$\\hat{p}^*_{(1949)} = 0.160$\n- 第1950个值：$\\hat{p}^*_{(1950)} = 0.165$\n- 第1951个值：$\\hat{p}^*_{(1951)} = 0.165$\n\n使用这些信息，确定真实失效比例 $p$ 的95%百分位置信区间。提供该区间的下限和上限。将您的最终答案四舍五入到三位有效数字。", "solution": "目标是使用百分位自助法为有缺陷处理器的真实比例 $p$ 构建一个95%的置信区间。\n\n首先，我们记下从初始数据中观察到的样本比例 $\\hat{p}$。\n$$\n\\hat{p} = \\frac{x}{n} = \\frac{24}{200} = 0.12\n$$\n\n题目描述了百分位自助法的步骤。要构建一个 $(1-\\alpha) \\times 100\\%$ 的置信区间，我们需要从已排序的自助统计量分布中找到下限和上限。下限是自助分布的 $(\\alpha/2)$ 分位数，上限是 $(1-\\alpha/2)$ 分位数。\n\n对于95%的置信区间，我们有 $1-\\alpha = 0.95$，这意味着 $\\alpha = 0.05$。\n\n置信区间的下限对应于 $\\alpha/2$ 处的分位数：\n$$\n\\frac{\\alpha}{2} = \\frac{0.05}{2} = 0.025\n$$\n\n置信区间的上限对应于 $1 - \\alpha/2$ 处的分位数：\n$$\n1 - \\frac{\\alpha}{2} = 1 - 0.025 = 0.975\n$$\n\n我们有 $B = 2000$ 个自助样本，用它们计算出了2000个自助比例 $\\hat{p}^*$。将这些比例按升序排序，得到顺序统计量 $\\hat{p}^*_{(1)}, \\hat{p}^*_{(2)}, \\dots, \\hat{p}^*_{(2000)}$。\n\n为了找到对应于0.025分位数的值，我们计算其在排序后列表中的索引：\n$$\n\\text{Lower bound index} = B \\times \\frac{\\alpha}{2} = 2000 \\times 0.025 = 50\n$$\n因此，我们置信区间的下限是排序后列表中的第50个值，即 $\\hat{p}^*_{(50)}$。\n\n为了找到对应于0.975分位数的值，我们计算其在排序后列表中的索引：\n$$\n\\text{Upper bound index} = B \\times \\left(1 - \\frac{\\alpha}{2}\\right) = 2000 \\times 0.975 = 1950\n$$\n因此，我们置信区间的上限是排序后列表中的第1950个值，即 $\\hat{p}^*_{(1950)}$。\n\n题目提供了排序后列表中的必要值：\n- 下限 = $\\hat{p}^*_{(50)} = 0.080$\n- 上限 = $\\hat{p}^*_{(1950)} = 0.165$\n\n题目要求最终答案四舍五入到三位有效数字。下限是0.080，为了明确表示为三位有效数字，写作0.0800。上限0.165已经有三位有效数字。\n\n因此，95%的百分位自助法置信区间为 $[0.0800, 0.165]$。所要求的值是下限和上限。\n下限：0.0800\n上限：0.165", "answer": "$$\\boxed{\\begin{pmatrix} 0.0800 & 0.165 \\end{pmatrix}}$$", "id": "1959396"}, {"introduction": "除了估计不确定性，自助法也是一个评估估计量（estimator）性质的强大工具，例如偏差（bias）。本练习探讨了一个重要问题：在数据分布不对称的情况下，使用样本中位数来估计总体均值是否是一个好的选择。通过详尽列举一个极小样本所有可能的自助样本，你将亲手计算样本中位数的偏差的自助法估计值 [@problem_id:1959393]，从而深刻理解重抽样过程的本质以及自助法在检验统计量适用性上的应用。", "problem": "某半导体制造厂的一位分析师正在研究一种特定类型晶体管的导通电压。她收集了一个大小为 $n=3$ 的小样本，测量值记录为 $\\{1.1, 2.5, 6.2\\}$ 伏特。根据对制造过程的先验知识，她认为导通电压的潜在分布是右偏的，并且可以用自由度为3的卡方分布 $\\chi^2(3)$ 来建模。\n\n该分析师正在考虑使用样本中位数作为导通电压总体均值的估计量。为了评估该估计量的适用性，她决定估计其偏差。对于参数 $\\theta$，其估计量 $\\hat{\\theta}$ 的偏差定义为 $\\text{Bias}(\\hat{\\theta}) = E[\\hat{\\theta}] - \\theta$。\n\n使用自助法（bootstrap method），计算当样本中位数用作总体均值的估计量时，其估计偏差。偏差的自助法估计定义为：在所有自助样本上计算的统计量的平均值减去在原始样本上计算的统计量。为进行此计算，您必须考虑所有可以从原始数据中有放回地抽取的、大小为 $n=3$ 的可能的*不同*的自助样本。\n\n报告您计算出的估计偏差的最终答案，并四舍五入到两位有效数字。", "solution": "我们将观测样本记为 $x=\\{1.1,2.5,6.2\\}$，其中 $n=3$。我们感兴趣的统计量是样本中位数，对于原始样本，其值为\n$$\n\\tilde{x}=\\text{median}(1.1,2.5,6.2)=2.5.\n$$\n自助法偏差估计定义为\n$$\n\\widehat{\\text{Bias}}=\\overline{T^{*}}-T,\n$$\n其中 $T$ 是在原始样本上计算的统计量，而 $\\overline{T^{*}}$ 是在所有自助样本上计算的统计量的平均值。题目要求使用所有从 $\\{1.1,2.5,6.2\\}$ 中有放回地抽取的、大小为3的不同的自助样本（多重集）。这种不同的多重集的数量为\n$$\n\\binom{3+3-1}{3}=\\binom{5}{3}=10.\n$$\n这些多重集及其对应的中位数是：\n- $(1.1,1.1,1.1)\\rightarrow 1.1$,\n- $(1.1,1.1,2.5)\\rightarrow 1.1$,\n- $(1.1,1.1,6.2)\\rightarrow 1.1$,\n- $(1.1,2.5,2.5)\\rightarrow 2.5$,\n- $(1.1,2.5,6.2)\\rightarrow 2.5$,\n- $(1.1,6.2,6.2)\\rightarrow 6.2$,\n- $(2.5,2.5,2.5)\\rightarrow 2.5$,\n- $(2.5,2.5,6.2)\\rightarrow 2.5$,\n- $(2.5,6.2,6.2)\\rightarrow 6.2$,\n- $(6.2,6.2,6.2)\\rightarrow 6.2$.\n统计次数，中位数为 $1.1$ 的情况有 $3$ 种，为 $2.5$ 的情况有 $4$ 种，为 $6.2$ 的情况有 $3$ 种。因此，\n$$\n\\overline{T^{*}}=\\frac{3\\cdot 1.1+4\\cdot 2.5+3\\cdot 6.2}{10}=\\frac{31.9}{10}=3.19.\n$$\n从而，自助法偏差估计为\n$$\n\\widehat{\\text{Bias}}=\\overline{T^{*}}-\\tilde{x}=3.19-2.5=0.69.\n$$\n四舍五入到两位有效数字，估计偏差为 $0.69$。", "answer": "$$\\boxed{0.69}$$", "id": "1959393"}, {"introduction": "本练习展示了自助法的通用性，将其应用从简单统计量扩展到更复杂的模型参数。在线性回归等模型中，理论方法计算参数（如截距）的标准误通常依赖于可能不成立的严格假设，而自助法则提供了一种稳健的替代方案。你将实践如何通过对原始数据点进行重抽样来估计回归系数的标准误 [@problem_id:1959369]，这对于评估模型的稳定性和可靠性至关重要。", "problem": "一位房地产分析师正在研究房屋面积与其售价之间的关系。收集了一个小型数据集，其中包含四个关于房屋面积（单位：平方英尺）和售价（单位：千美元）的观测值：\n- (1000 平方英尺, 250千美元)\n- (1500 平方英尺, 300千美元)\n- (2000 平方英尺, 450千美元)\n- (2500 平方英尺, 500千美元)\n\n分析师拟合了一个形式为 $P = b_0 + b_1 S$ 的简单线性回归模型，其中 $P$ 是价格，$S$ 是面积。为了评估模型截距系数 $b_0$ 的不确定性，分析师采用了一种计算重抽样技术。该过程包括生成五个新的数据集，每个数据集的大小与原始数据集相同。每个新数据集都是通过从原始的四个数据点集合中，有放回地抽取四个数据点（即，面积-价格对）而创建的。对这五个重抽样数据集中的每一个，都拟合了一个新的简单线性回归模型。\n\n从这五个模型中计算出的截距系数 $b_0$ 分别为：\n79.6, 0.0, 61.1, 22.7, 60.0\n\n使用这五个截距值的集合作为样本，计算截距系数的估计标准误。将最终答案以千美元为单位表示，并四舍五入到三位有效数字。", "solution": "截距的自助法标准误是通过自助法截距估计值的样本标准差来估计的。设自助法估计值为 $\\hat{b}_{0}^{*(i)}$，其中 $i=1,\\dots,B$，且 $B=5$。估计量为\n$$\n\\widehat{\\operatorname{SE}}(\\hat{b}_{0})=\\sqrt{\\frac{1}{B-1}\\sum_{i=1}^{B}\\left(\\hat{b}_{0}^{*(i)}-\\bar{b}_{0}^{*}\\right)^{2}},\\quad \\bar{b}_{0}^{*}=\\frac{1}{B}\\sum_{i=1}^{B}\\hat{b}_{0}^{*(i)}.\n$$\n已知 $\\{\\hat{b}_{0}^{*(i)}\\}=\\{79.6,\\,0.0,\\,61.1,\\,22.7,\\,60.0\\}$（单位：千美元），首先计算均值：\n$$\n\\bar{b}_{0}^{*}=\\frac{79.6+0.0+61.1+22.7+60.0}{5}=\\frac{223.4}{5}=44.68.\n$$\n计算离差平方和：\n$$\n\\begin{aligned}\n(79.6-44.68)^{2}&=34.92^{2}=1219.4064,\\\\\n(0.0-44.68)^{2}&=44.68^{2}=1996.3024,\\\\\n(61.1-44.68)^{2}&=16.42^{2}=269.6164,\\\\\n(22.7-44.68)^{2}&=21.98^{2}=483.1204,\\\\\n(60.0-44.68)^{2}&=15.32^{2}=234.7024,\n\\end{aligned}\n$$\n所以\n$$\n\\sum_{i=1}^{5}\\left(\\hat{b}_{0}^{*(i)}-\\bar{b}_{0}^{*}\\right)^{2}=1219.4064+1996.3024+269.6164+483.1204+234.7024=4203.148.\n$$\n因此，样本方差和标准误为\n$$\ns^{2}=\\frac{4203.148}{5-1}=1050.787,\\qquad \\widehat{\\operatorname{SE}}(\\hat{b}_{0})=\\sqrt{1050.787}\\approx 32.416.\n$$\n以千美元为单位，并四舍五入到三位有效数字，估计的标准误为 $32.4$。", "answer": "$$\\boxed{32.4}$$", "id": "1959369"}]}