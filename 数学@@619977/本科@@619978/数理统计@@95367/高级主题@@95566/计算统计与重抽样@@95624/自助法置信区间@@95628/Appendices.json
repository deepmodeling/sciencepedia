{"hands_on_practices": [{"introduction": "Bootstrap方法的一大优势在于它能为那些没有简单标准误差公式的统计量（如中位数）提供置信区间。本练习将通过一个小的、可管理的bootstrap重抽样结果集，具体地引导你走过百分位方法的全过程。通过这个实践，你将掌握从bootstrap分布中确定置信区间的核心机制 [@problem_id:1901792]。", "problem": "一位分子生物学家正在研究特定基因“Gene-X”在某种条件下的表达水平。表达水平以标准化荧光强度来衡量。由于实验成本高昂，只能获得包含五个测量值的小样本。观测到的表达水平为：\n$$\n3.1, 4.5, 2.8, 5.9, 3.4\n$$\n为了估计总体中位数表达水平的变异性，该生物学家采用了一种非参数自助法程序。通过对原始五个数据点进行有放回的重抽样，创建了大量的自助样本。对每个自助样本，都计算其中位数。在生成了20个这样的自助中位数并按升序对其进行排序后，得到了以下有序中位数列表：\n$$\n2.8, 2.9, 3.1, 3.1, 3.1, 3.2, 3.3, 3.4, 3.4, 3.4, 3.5, 3.6, 3.9, 4.1, 4.2, 4.5, 4.5, 4.5, 4.8, 5.1\n$$\n使用百分位数法对这组20个已排序的自助中位数构建总体中位数表达水平的90%置信区间。以下哪项代表了正确的区间？\n\nA. [2.8, 4.8]\n\nB. [2.9, 5.1]\n\nC. [2.8, 5.1]\n\nD. [3.1, 4.5]\n\nE. [2.9, 4.8]", "solution": "我们需要使用已排序的自助中位数为总体中位数寻找一个百分位数自助置信区间。对于置信水平 $1-\\alpha=0.90$，百分位数法使用自助分布在概率 $\\alpha/2=0.05$ 和 $1-\\alpha/2=0.95$ 处的经验分位数。\n\n令 $B=20$ 为自助中位数的数量，并将排序后的自助中位数表示为 $m_{(1)} \\leq m_{(2)} \\leq \\cdots \\leq m_{(20)}$。使用经验分位数的最近秩定义，对应于概率 $p$ 的秩为\n$$\nr(p)=\\lceil B p \\rceil.\n$$\n因此，\n$$\nr(0.05)=\\lceil 20 \\times 0.05 \\rceil=\\lceil 1 \\rceil=1,\\quad r(0.95)=\\lceil 20 \\times 0.95 \\rceil=\\lceil 19 \\rceil=19.\n$$\n因此，90%的百分位置信区间是\n$$\n\\left[m_{(1)},\\,m_{(19)}\\right].\n$$\n从给定的排序列表中，$m_{(1)}=2.8$ 且 $m_{(19)}=4.8$，所以区间是 $[2.8, 4.8]$，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1901792"}, {"introduction": "Bootstrap的应用远不止于估计均值或中位数等简单参数。这个练习将探讨如何将其应用于一个更抽象但至关重要的统计量上，该统计量用于衡量分布的拟合优度。你将学习如何处理大规模模拟的输出（以频率表的形式），并从中构建置信区间，从而加深对bootstrap方法多功能性的理解 [@problem_id:1901810]。", "problem": "一位工程师正在分析一个新的数据库查询优化器的性能。收集了一个由 $n=8$ 个独立的查询执行时间（单位：毫秒）测量值组成的样本：$\\{15.3, 12.1, 18.6, 9.8, 21.0, 16.5, 13.5, 17.2\\}$。\n\n设 $F(x)$ 为查询执行时间的真实但未知的累积分布函数（CDF），并设 $F_n(x)$ 为根据该样本构建的经验累积分布函数（ECDF）。该工程师对统计量 $d_n$ 感兴趣，其定义为在所有可能的执行时间 $x$ 上，ECDF 与真实 CDF 之间的最大绝对差：\n$$d_n = \\sup_{x} |F_n(x) - F(x)|$$\n为了估计该值的不确定性，使用了百分位数自助法。总共生成了 $B=10000$ 个该统计量的自助法复制值，记为 $d_n^*$。每个复制值 $d_n^*$ 的计算方法是：从原始数据中有放回地抽取一个大小为 $n=8$ 的新样本，构建其经验累积分布函数 $F_n^*(x)$，然后找出值 $\\sup_x|F_n^*(x) - F_n(x)|$。\n\n在 10000 个自助法复制值中观察到的不同值的频率总结在下表中：\n\n| $d_n^*$ 的值 | 频率 |\n|:----------------:|:---------:|\n| 0.000            | 1373      |\n| 0.125            | 4390      |\n| 0.250            | 3088      |\n| 0.375            | 963       |\n| 0.500            | 172       |\n| 0.625            | 14        |\n\n根据自助法复制值的分布，为统计量 $d_n$ 构建一个 70% 的百分位数自助法置信区间。请以有序对 $(L, U)$ 的形式给出您的答案，其中 $L$ 是下界，$U$ 是上界。请将您最终的 $L$ 和 $U$ 值四舍五入到三位有效数字。", "solution": "我们旨在利用自助法复制值 $d_{n}^{*}$，为标量参数 $d_{n}$ 构建一个 0.70 百分位数自助法置信区间。对于置信水平为 $1-\\alpha=0.70$ 的百分位数法，其等尾区间由自助法分布的经验 $\\alpha/2$ 和 $1-\\alpha/2$ 分位数给出：\n$$\n(L,U)=\\left(\\hat{Q}_{d_{n}^{*}}(0.15),\\ \\hat{Q}_{d_{n}^{*}}(0.85)\\right),\n$$\n其中 $\\hat{Q}_{d_{n}^{*}}(p)$ 表示经验 $p$-分位数，定义为满足经验累积分布函数 $\\hat{F}_{d_{n}^{*}}(x)\\geq p$ 的最小值 $x$。\n\n根据所提供的 $B=10000$ 个复制值的频率，不同取值处的累积比例如下：\n$$\n\\begin{aligned}\nP(d_{n}^{*}\\leq 0.000)&=\\frac{1373}{10000}=0.1373,\\\\\nP(d_{n}^{*}\\leq 0.125)&=\\frac{1373+4390}{10000}=\\frac{5763}{10000}=0.5763,\\\\\nP(d_{n}^{*}\\leq 0.250)&=\\frac{8851}{10000}=0.8851,\\\\\nP(d_{n}^{*}\\leq 0.375)&=\\frac{9814}{10000}=0.9814,\\\\\nP(d_{n}^{*}\\leq 0.500)&=\\frac{9986}{10000}=0.9986,\\\\\nP(d_{n}^{*}\\leq 0.625)&=1.\n\\end{aligned}\n$$\n\n对于下分位数 $p=0.15$，我们发现 $0.1373<0.15\\leq 0.5763$，因此\n$$\n\\hat{Q}_{d_{n}^{*}}(0.15)=0.125.\n$$\n对于上分位数 $p=0.85$，我们发现 $0.5763<0.85\\leq 0.8851$，因此\n$$\n\\hat{Q}_{d_{n}^{*}}(0.85)=0.250.\n$$\n\n因此，该 0.70 百分位数自助法置信区间为 $(0.125,\\ 0.250)$。将每个端点四舍五入至三位有效数字，得到 $L=0.125$ 和 $U=0.250$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.125 & 0.250 \\end{pmatrix}}$$", "id": "1901810"}, {"introduction": "Bootstrap方法的强大功能同样延伸到了线性回归等复杂统计模型中，特别是在标准假设不成立时。本练习将介绍“狂野bootstrap”（wild bootstrap）这一专门技术，它被用来在模型误差方差不恒定（即存在异方差性）的情况下，构建可靠的回归系数置信区间。这个例子展示了bootstrap在解决高级建模问题中的灵活性与实用价值 [@problem_id:1901772]。", "problem": "一位材料工程师正在研究一种新型聚合物复合材料的特性。她研究了一种新型硬化剂的浓度与材料最终拉伸强度之间的关系。假设存在一个线性关系：$S_i = \\beta_0 + \\beta_1 C_i + \\epsilon_i$，其中 $S_i$ 是以吉帕斯卡（GPa）为单位的拉伸强度，$C_i$ 是以百分比（%）表示的硬化剂浓度，而 $\\epsilon_i$ 是误差项。该工程师对系数 $\\beta_1$ 特别感兴趣，它代表硬化剂浓度每增加一个百分点，拉伸强度（以GPa为单位）的边际增加量。\n\n收集数据后，初步分析表明误差项 $\\epsilon_i$ 的方差在不同浓度水平下可能并非恒定，这种情况会使 $\\beta_1$ 的标准置信区间失效。为了获得更可靠的区间，采用了一种稳健计算方法。该方法包括以下步骤，用以生成一个合理的斜率估计值分布：\n1.  对原始数据进行初始的普通最小二乘法（OLS）回归，以找到估计系数 $\\hat{\\beta}_0, \\hat{\\beta}_1$ 和残差 $\\hat{\\epsilon}_i = S_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i)$。\n2.  生成大量的（$B$个）新的“自助”数据集。对于每次重复 $b \\in \\{1, \\dots, B\\}$，通过 $\\epsilon_{i,b}^* = \\hat{\\epsilon}_i \\cdot v_{i,b}$ 创建一组新的伪误差，其中每个 $v_{i,b}$ 是从均值为0、方差为1的分布中独立随机抽取的样本。\n3.  使用原始拟合值构建新的伪响应：$S_{i,b}^* = (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i) + \\epsilon_{i,b}^*$。\n4.  对于每次重复 $b$，通过对 $S_{b}^*$ 和原始浓度 $C$ 进行OLS回归，估计出新的斜率系数 $\\hat{\\beta}_{1,b}^*$。\n\n此过程进行了 $B=4999$ 次重复。所得的 $4999$ 个斜率估计值 $\\{\\hat{\\beta}_{1,b}^*\\}$ 按升序排序。分析从排序后的列表中得出了以下关键值：\n- 第125个值为 $2.18$。\n- 来自原始数据的OLS估计值为 $\\hat{\\beta}_1 = 2.51$。\n- 第4875个值为 $2.93$。\n\n根据这些信息，确定斜率系数 $\\beta_1$ 的95%自助法百分位数置信区间。请将您的答案表示为行矩阵 `[lower_bound, upper_bound]` 的形式，数值单位为 GPa/%。所提供的值已达到所需精度，无需进一步四舍五入。", "solution": "题目要求我们基于 $B=4999$ 个自助法斜率估计值，求出斜率系数 $\\beta_{1}$ 的95%自助法百分位数置信区间。设排序后的自助法斜率由顺序统计量 $\\hat{\\beta}_{1,(1)}^{*} \\leq \\cdots \\leq \\hat{\\beta}_{1,(B)}^{*}$ 表示。\n\n对于名义双侧置信水平 $1-\\alpha=0.95$（即 $\\alpha=0.05$），百分位数法取自助法分布的经验 $\\alpha/2$ 和 $1-\\alpha/2$ 分位数。使用标准的 $(B+1)$ 索引规则，分位数的索引为\n$$\nk_{\\ell} = \\alpha/2 \\cdot (B+1), \\qquad k_{u} = (1-\\alpha/2) \\cdot (B+1).\n$$\n当 $B=4999$ 且 $\\alpha=0.05$ 时，\n$$\nk_{\\ell} = 0.025 \\cdot 5000 = 125, \\qquad k_{u} = 0.975 \\cdot 5000 = 4875.\n$$\n因此，95%自助法百分位数置信区间为\n$$\n\\left[\\, \\hat{\\beta}_{1,(125)}^{*},\\ \\hat{\\beta}_{1,(4875)}^{*} \\,\\right].\n$$\n根据提供的排序后的自助法输出，$\\hat{\\beta}_{1,(125)}^{*} = 2.18$ 且 $\\hat{\\beta}_{1,(4875)}^{*} = 2.93$。因此，95%自助法百分位数置信区间为\n$$\n[\\,2.18,\\ 2.93\\,].\n$$\n原始的OLS估计值 $\\hat{\\beta}_{1}=2.51$ 在构建百分位数区间时并不需要；提供该值是为了提供上下文信息。", "answer": "$$\\boxed{\\begin{pmatrix} 2.18 & 2.93 \\end{pmatrix}}$$", "id": "1901772"}]}