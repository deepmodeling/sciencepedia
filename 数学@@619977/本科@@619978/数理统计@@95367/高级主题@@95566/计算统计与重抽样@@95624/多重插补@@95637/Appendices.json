{"hands_on_practices": [{"introduction": "多重插补的有效性在很大程度上取决于插补模型的“相容性”（congeniality）。一个“一刀切”的方法，如标准线性回归，在面对非正态或有界数据时往往会失效。本练习 [@problem_id:1938743] 将挑战你批判性地思考如何为一个介于 $[0, 1]$ 之间的比例变量选择合适的插补策略，这种情况在现实世界中非常普遍，而使用不当的方法可能会产生无效的插补值并导致有偏的结论。", "problem": "一位社会科学家正在分析一个家庭调查数据集，以了解其支出模式。该数据集包含每个家庭的以下完全观测变量：\n- `LogIncome`: 家庭月总收入的自然对数。\n- `HouseholdSize`: 家庭中的人口数量。\n\n主要关注的变量是`FoodProportion`，它代表每月收入中用于食物的比例。该变量是连续的，理论上限制在区间 $[0, 1]$ 内。然而，由于调查中的未回答情况，`FoodProportion`变量存在缺失值。研究者决定在进行主要分析之前，使用多重插补（MI）来处理缺失数据。\n\n研究者提出了几种针对`FoodProportion`变量的插补策略，使用`LogIncome`和`HouseholdSize`作为预测变量。\n\nA. 直接使用标准线性回归模型对`FoodProportion`进行插补。\nB. 使用预测均值匹配（PMM），其底层模型是`FoodProportion`对预测变量的线性回归。\nC. 使用Beta回归对`FoodProportion`进行建模，其中均值使用logit链接函数。\nD. 对`FoodProportion`应用反正弦平方根变换（即，$Y' = \\arcsin(\\sqrt{\\text{FoodProportion}})$），使用线性回归对变换后的变量$Y'$进行插补，然后将结果反变换回来。\nE. 对`FoodProportion`应用logit变换（即，$Y' = \\ln(\\frac{\\text{FoodProportion}}{1-\\text{FoodProportion}})$），使用线性回归对变换后的变量$Y'$进行插补，然后将结果反变换回来。\nF. 将`FoodProportion`离散化为三个类别（‘低’、‘中’、‘高’），然后使用多项逻辑回归对缺失的类别进行插补。\n\n假设`FoodProportion`的观测值中没有恰好为0或1的，请从以上列表中选择所有在统计上适合此任务的策略。", "solution": "目标变量是一个支持集为$[0,1]$的连续比例，并且题目说明没有观测值恰好为$0$或$1$，因此观测数据实际上位于$(0,1)$区间内。为了使多重插补在统计上是恰当的，插补模型应能：(i) 生成尊重变量支持集的插补值；(ii) 与分数响应（fractional response）的数据生成结构相容；(iii) 避免可能导致插补值偏倚和扭曲不确定性的临时截断（ad hoc truncation）。\n\n评估每种提出的策略：\n\nA. 对原始比例进行标准线性回归插补，不能将插补值限制在$[0,1]$区间内。在正态误差线性模型下，预测值加上随机残差抽取值可能会落在$[0,1]$之外，从而违反了支持集。在$0$和$1$处进行事后截断是临时的做法，可能导致偏倚和不恰当的不确定性量化。因此，这在统计上是不恰当的。\n\nB. 预测均值匹配（PMM）使用线性模型来定义邻域，但插补的是实际观测到的供体值（donor values）。由于题目的假设，所有供体值都位于$(0,1)$内，因此PMM能保持支持集，并且对非正态性和异方差性具有稳健性。在随机缺失（missing at random）和预测变量设定正确的情况下，PMM对于有界连续结果在统计上是恰当的。因此，B是恰当的。\n\nC. 带有logit链接的Beta回归使用Beta分布对支持集在$(0,1)$上的响应进行建模。Beta分布的密度函数位于$(0,1)$上，并且能够适应比例数据典型的均值-方差关系。由于没有观测到零或一，Beta似然函数是良定义的（well-defined），在多重插补中进行适当的贝叶斯或近似贝叶斯抽样，会产生位于$(0,1)$内的插补值。因此，C是恰当的。\n\nD. 反正弦平方根变换 $Y'=\\arcsin(\\sqrt{p})$ 将 $p\\in(0,1)$ 映射到 $Y'\\in(0,\\frac{\\pi}{2})$。对 $Y'$ 进行线性插补可能会产生在 $(0,\\frac{\\pi}{2})$ 之外的 $Y'$ 值，但反变换 $p=\\sin^2(Y')$ 会将任何实数 $Y'$ 映射到 $[0,1]$ 内。尽管反变换后保持了边界，但这种变换是一种用于已知分母的二项比例的方差稳定化方法，它依赖于方差与 $p(1-p)/n$ 成正比。对于没有已知 $n$ 的一般连续比例，它缺乏有原则的分布合理性，并且如果插补的 $Y'$ 超出主区间，反变换后可能导致非单调关系，从而引起失真。鉴于存在正确设定的有界模型（B、C、E），该方法不被认为是统计上恰当的。\n\nE. logit变换 $Y'=\\ln\\!\\left(\\frac{p}{1-p}\\right)$ 将 $(0,1)$ 映射到 $\\mathbb{R}$。对 $Y'$ 进行带有随机残差的线性回归插补在 $\\mathbb{R}$ 上是良定义的，而反logit变换 $p=\\frac{\\exp(Y')}{1+\\exp(Y')}$ 保证插补值落在 $(0,1)$ 内。由于没有观测到零或一，这种方法对于分数响应是标准的且在统计上是恰当的。因此，E是恰当的。\n\nF. 将一个连续比例离散化为类别，并通过多项逻辑回归进行插补，会丢弃类别内的信息，引入测量误差，并且如果分析中将该变量用作连续变量，则会产生不相容性。这可能导致参数估计和标准误产生偏倚。因此，F对于插补一个连续比例在统计上是不恰当的。\n\n因此，在统计上恰当的策略是B、C和E。", "answer": "$$\\boxed{BCE}$$", "id": "1938743"}, {"introduction": "插补过程并非一个“黑箱”操作；在生成插补数据后，进行诊断性检查是确保其合理性的关键一步。本练习 [@problem_id:1938796] 侧重于使用有效的图形方法来比较观测数据和插补数据的分布。掌握这项基本技能，可以帮助你评估插补模型的表现，确保插补值与原始数据特征保持一致，从而建立对最终分析结果的信心。", "problem": "一名临床研究人员正在分析一项健康研究的数据集。其中一个关键的连续变量“收缩压”（Systolic Blood Pressure, SBP）存在许多缺失值。研究人员假设导致数据缺失的机制是随机缺失（Missing At Random, MAR），这意味着一个值缺失的概率可能取决于其他观察到的患者变量。为了解决这个问题，研究人员采用链式方程多重插补（Multiple Imputation by Chained Equations, MICE）来生成数据集的 $m=5$ 个不同的完整版本。\n\n此过程中的一个关键步骤是进行诊断性检查，以确保插补的 SBP 值是合理的。研究人员的目标是，通过图形化方式比较原始观测到的 SBP 值的边际分布与五个新生成的完整数据集中 SBP 变量的边际分布。\n\n对于这一特定目的，以下哪种图形化方法最有效、最全面？\n\nA. 创建五个独立的箱形图，每个箱形图对应五个完整数据集中的一个 SBP 变量。\nB. 构建一个单一的散点图，展示插补的 SBP 值与患者年龄的关系，使用汇集自所有五个插补的数据。\nC. 绘制一个单一的直方图，将所有观测到的 SBP 值与来自所有五个数据集的所有插补 SBP 值合并成一个大样本。\nD. 生成一个单一的图，其中叠加了六条不同的密度曲线：一条实线表示原始观测 SBP 值的分布，五条半透明线分别表示五个完整数据集中完整 SBP 变量（观测值加插补值）的分布。\nE. 计算观测数据的 SBP 均值和方差，以及五个完整数据集中每一个的 SBP 均值和方差，并将它们呈现在一个表格中。", "solution": "核心任务是找到最佳的图形化方法，用以比较一个观测变量的分布与经过多重插补后该变量的分布。一种有效的方法应该能够直接比较分布的形状（中心、离散程度、偏度、峰态），并且还应该能够可视化插补过程引入的不确定性（即 $m=5$ 个插补数据集之间的差异）。\n\n让我们根据这些标准评估每个选项：\n\n*   **选项 A**：这涉及到创建五个独立的箱形图。箱形图提供了分布的五数概括。虽然有用，但它们可能会掩盖如双峰性等重要的分布特征。此外，使用五个独立的图表使得与原始观测数据分布的直接比较变得繁琐。这种方法提供的信息不如能够显示完整分布形状的方法全面。\n\n*   **选项 B**：这个选项建议绘制插补 SBP 值与年龄的散点图。这类图表是检查插补模型是否保留了 SBP 与年龄之间*条件关系*（或二元分布）的关键诊断工具。然而，问题明确要求检查 SBP 变量本身的*边际分布*。因此，该图表没有解决主要目标。\n\n*   **选项 C**：将所有观测值和插补值合并到一个单一的直方图中是一种糟糕的诊断技术。此项检查的目的是*比较*观测数据的分布与插补数据的分布，而不是将它们合并。将数据合并到一个直方图中，使得无法检测出插补值是否与观测值具有不同的均值或形状。这种方法会掩盖插补模型中潜在的问题。\n\n*   **选项 D**：这个选项描述了叠加多个密度图。这是执行此诊断任务的标准且最有效的方法。密度图提供了整个概率分布的平滑估计，揭示了其形状、中心、离散程度和任何峰值。通过将观测数据的密度绘制为一条实线作为参考，并叠加五个完整数据集的密度曲线，研究人员可以进行即时且详细的视觉比较。这种方法同时实现了两个关键目标：\n    1.  它允许检查完整数据集的分布是否与观测数据的分布相似。巨大的差异可能表明插补模型存在问题。\n    2.  五个完整数据集的半透明曲线之间的离散程度，直接可视化了插补的不确定性。如果这些曲线差异很大，则表明插补值具有很高的不确定性。\n\n*   **选项 E**：这个选项建议将数值摘要（均值和方差）呈现在表格中。虽然这是一个有价值的定量检查，但问题明确要求一种*图形化方法*。该选项未能满足此要求。此外，像均值和方差这样的汇总统计量无法捕捉分布的完整形状，而这正是此诊断检查的一个关键方面。\n\n基于此分析，选项 D 是针对研究人员所述目标最全面、最合适的图形化方法。它直接比较了完整的边际分布，同时还展示了多重插补之间的变异性。", "answer": "$$\\boxed{D}$$", "id": "1938796"}, {"introduction": "多重插补的最后一步是将来自多个完整数据集的分析结果合成为一个统一的推断。本练习 [@problem_id:1938746] 让你直接实践应用鲁宾法则 (Rubin's rules) 来合并点估计量及其方差。通过这个计算，你将掌握如何整合“插补内部”方差和“插补之间”方差，从而正确地量化由数据缺失所带来的总体不确定性。", "problem": "一名数据分析师正在研究个人平均每周屏幕时间（以小时为单位）与标准化健康问卷得分之间的关系。由于调查存在未回应情况，一部分屏幕时间数据缺失。为解决此问题，该分析师采用多重插补方法，创建了 $m=5$ 个不同的完整数据集。\n\n对 $m=5$ 个数据集中的每一个，都进行了简单线性回归分析。该分析得出了估计的回归系数 $\\hat{\\beta}_j$（表示每周屏幕时间每增加一小时，健康问卷得分的变化量）及其对应的估计方差 $U_j$。五次独立分析的结果如下：\n\n- 数据集 1: $\\hat{\\beta}_1 = -0.45$, $U_1 = 0.012$\n- 数据集 2: $\\hat{\\beta}_2 = -0.51$, $U_2 = 0.015$\n- 数据集 3: $\\hat{\\beta}_3 = -0.48$, $U_3 = 0.014$\n- 数据集 4: $\\hat{\\beta}_4 = -0.55$, $U_4 = 0.013$\n- 数据集 5: $\\hat{\\beta}_5 = -0.46$, $U_5 = 0.011$\n\n使用 Rubin 法则合并多重插补的估计值，计算回归系数的最终合并点估计值及其相关的总方差。请以两个数值的形式提供您的答案：首先是合并系数，然后是总方差。将您的两个最终答案四舍五入至三位有效数字。", "solution": "我们使用 Rubin 法则进行多重插补。设 $m$ 为插补次数，$\\hat{\\beta}_{j}$ 为点估计值， $U_{j}$ 为其估计方差。合并点估计为\n$$\n\\bar{\\beta}=\\frac{1}{m}\\sum_{j=1}^{m}\\hat{\\beta}_{j}\n$$\n插补内方差为\n$$\n\\bar{U}=\\frac{1}{m}\\sum_{j=1}^{m}U_{j}\n$$\n插补间方差为\n$$\nB=\\frac{1}{m-1}\\sum_{j=1}^{m}\\left(\\hat{\\beta}_{j}-\\bar{\\beta}\\right)^{2}\n$$\n总方差为\n$$\nT=\\bar{U}+\\left(1+\\frac{1}{m}\\right)B.\n$$\n\n给定 $m=5$，$\\hat{\\beta}_{j}\\in\\{-0.45,-0.51,-0.48,-0.55,-0.46\\}$ 且 $U_{j}\\in\\{0.012,0.015,0.014,0.013,0.011\\}$：\n\n1) 合并估计值：\n$$\n\\sum_{j=1}^{5}\\hat{\\beta}_{j}=-0.45-0.51-0.48-0.55-0.46=-2.45,\\quad\n\\bar{\\beta}=\\frac{-2.45}{5}=-0.49.\n$$\n\n2) 插补内方差：\n$$\n\\sum_{j=1}^{5}U_{j}=0.012+0.015+0.014+0.013+0.011=0.065,\\quad\n\\bar{U}=\\frac{0.065}{5}=0.013.\n$$\n\n3) 插补间方差。与 $\\bar{\\beta}$ 的偏差为：\n$$\n0.04,\\,-0.02,\\,0.01,\\,-0.06,\\,0.03,\n$$\n平方后求和：\n$$\n0.04^{2}+(-0.02)^{2}+0.01^{2}+(-0.06)^{2}+0.03^{2}=0.0016+0.0004+0.0001+0.0036+0.0009=0.0066\n$$\n因此\n$$\nB=\\frac{0.0066}{5-1}=0.00165.\n$$\n\n4) 总方差：\n$$\nT=\\bar{U}+\\left(1+\\frac{1}{5}\\right)B=0.013+1.2\\times 0.00165=0.013+0.00198=0.01498.\n$$\n\n四舍五入至三位有效数字，得到 $\\bar{\\beta}=-0.490$ 和 $T=0.0150$。", "answer": "$$\\boxed{\\begin{pmatrix}-0.490 & 0.0150\\end{pmatrix}}$$", "id": "1938746"}]}