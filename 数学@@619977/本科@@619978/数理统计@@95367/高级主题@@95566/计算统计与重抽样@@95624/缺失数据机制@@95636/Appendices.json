{"hands_on_practices": [{"introduction": "这个练习提供了一组来自健康科技领域的实际情景。通过分析这些情况，你将实践应用完全随机缺失 (MCAR)、随机缺失 (MAR) 和非随机缺失 (MNAR) 的核心定义。正确区分这些机制是妥善处理缺失数据的第一步，也是最关键的一步。[@problem_id:1936102]", "problem": "一个数据科学家团队正在分析一款用于监测夜间睡眠质量的新健康应用程序的数据。主要关注的变量，我们称之为 `SleepScore`，是一个从 0（非常差）到 100（极好）的连续值。然而，他们注意到在相当多的夜晚，`SleepScore` 的值是缺失的。他们的任务是为他们从用户报告和内部日志中识别出的三种不同情况，确定其可能的缺失数据机制。\n\n缺失数据的三种主要机制是：\n-   **完全随机缺失 (MCAR):** 某个值缺失的概率与任何观测变量或未观测变量都无关。\n-   **随机缺失 (MAR):** 某个值缺失的概率仅取决于其他观测变量，而不取决于该变量本身的未观测值。\n-   **非随机缺失 (MNAR):** 某个值缺失的概率取决于该变量本身的未观测值。\n\n以下是该团队正在调查的三种情景。\n\n**情景1：** 在为期一周的时间里，一个软件漏洞导致，如果手机在睡眠结束时的电池电量（有记录）低于20%，应用程序便无法将其数据传输到中央服务器。在分析了完整数据后，团队发现手机的夜间终了电池电量与用户的实际 `SleepScore` 之间没有相关性。\n\n**情景2：** 该应用使用一个灵敏的麦克风来检测鼾声和呼吸模式。在一个罕见的“数据过载”错误中，如果应用检测到整夜持续的极大鼾声，它就会崩溃并且无法保存任何 `SleepScore` 数据。鼾声的强度是用于计算 `SleepScore` 的一个主要组成部分。\n\n**情景3：** 由于影响硬盘任意扇区的服务器硬件故障，一个随机样本的用户记录从数据库中被永久删除。\n\n为每个情景确定正确的缺失数据机制。\n\nA. 情景1: MAR, 情景2: MNAR, 情景3: MCAR\n\nB. 情景1: MCAR, 情景2: MNAR, 情景3: MAR\n\nC. 情景1: MAR, 情景2: MCAR, 情景3: MNAR\n\nD. 情景1: MNAR, 情景2: MAR, 情景3: MCAR\n\nE. 情景1: MCAR, 情景2: MAR, 情景3: MNAR", "solution": "设 $Y$ 表示未观测的真实关注变量 ($\\text{SleepScore}$)，设 $X$ 表示观测协变量（例如，手机的电池电量），并设 $R$ 为缺失指示符，当 $Y$ 被观测到时 $R=1$，当 $Y$ 缺失时 $R=0$。标准定义如下：\n$$\n\\text{MCAR: } P(R=0 \\mid Y,X)=P(R=0), \\quad\n\\text{MAR: } P(R=0 \\mid Y,X)=P(R=0 \\mid X), \\quad\n\\text{MNAR: } P(R=0 \\mid Y,X) \\text{ depends on } Y \\text{ given } X.\n$$\n\n情景1：当观测到的电池电量 $B$ 低于一个阈值时，数据传输失败。因此，缺失性取决于一个观测变量 $B$，而不取决于 $Y$，所以\n$$\nP(R=0 \\mid Y,B)=P(R=0 \\mid B),\n$$\n这是 MAR。“$B$ 与 $Y$ 不相关”这一点并不会将该机制转变为 MCAR，因为 MCAR 要求 $P(R=0 \\mid Y,X)$ 是一个常数，而在这里它随 $B$ 变化。\n\n情景2：应用在出现极大且持续的鼾声时崩溃，而鼾声是计算 $Y$ 的一个主要组成部分。因此，即使以任何观测变量 $X$ 为条件，缺失的概率也取决于 $Y$ 的（未观测）值。形式上，\n$$\nP(R=0 \\mid Y,X) \\text{ 随着 } Y \\text{ 变化},\n$$\n因此该机制是 MNAR。\n\n情景3：一个随机样本的记录由于任意的硬件扇区故障而被删除。这意味着删除事件与 $Y$ 和 $X$ 都无关：\n$$\nP(R=0 \\mid Y,X)=P(R=0),\n$$\n这是 MCAR。\n\n因此，正确的识别是：情景1是 MAR，情景2是 MNAR，情景3是 MCAR，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1936102"}, {"introduction": "现在，我们将注意力转向一种在调查研究中常见且尤其棘手的缺失数据形式。这个问题阐释了非随机缺失 (MNAR) 是如何因受访者行为而产生的，如果处理不当，将导致有偏的结论。对于任何处理由人类产生数据的人来说，理解这种情况至关重要。[@problem_id:1936087]", "problem": "一家政治研究公司正在进行一项全国性调查，以衡量公众对一项新的、极具争议性的税收改革法案的看法。他们要求受访者在一个从1（强烈反对）到10（强烈支持）的整数等级上评价他们对该法案的支持程度。设 $Y_i$ 为调查样本中第 $i$ 个个体的真实支持水平。\n\n收集数据后，分析师们注意到了一个奇特的模式。他们有充分的证据相信，持非常强烈意见的个体（即真实支持水平 $Y_i$ 为1、2、9或10的个体）更不愿意分享他们的观点，因此更有可能拒绝回答这个特定问题，从而导致 $Y_i$ 的数据缺失。相比之下，持温和意见的个体更愿意回答。\n\n分析师们正试图根据标准的统计术语对这种缺失数据模式进行分类，以决定一种合适的填补策略。三种主要的机制是：\n-   **完全随机缺失 (MCAR)**：一个数值缺失的概率与观测到的数据和未观测到的数据都无关。\n-   **随机缺失 (MAR)**：一个数值缺失的概率仅依赖于数据集中的其他观测变量，而不依赖于该缺失值本身（在以观测变量为条件后）。\n-   **非随机缺失 (MNAR)**：一个数值缺失的概率依赖于那个缺失变量的值。\n\n根据所描述的情景，以下哪项最能描述“支持水平”变量上数据缺失的机制？\n\nA. 完全随机缺失 (MCAR)\n\nB. 随机缺失 (MAR)\n\nC. 非随机缺失 (MNAR)\n\nD. 无应答偏误", "solution": "设 $Y_i$ 表示真实的支持水平，并设 $R_i$ 为缺失指示变量，当 $Y_i$ 被观测到时 $R_i=1$，当 $Y_i$ 缺失时 $R_i=0$。设 $X_i$ 表示数据集中的其他观测到的协变量（如果有的话）。\n\n根据情景描述，支持水平为 $Y_i \\in \\{1,2,9,10\\}$ 的个体有更高的无应答概率，所以\n$$\n\\Pr(R_i=0 \\mid Y_i=y) \\text{ 对于 } y \\in \\{1,2,9,10\\} \\text{ 的值比对于温和的 } y \\text{ 值要大。}\n$$\n因此，缺失机制直接依赖于 $Y_i$ 的值。\n\nMCAR 条件要求\n$$\nR_i \\perp (Y_i,X_i) \\quad \\text{或等价地} \\quad \\Pr(R_i=0 \\mid Y_i,X_i)=\\Pr(R_i=0),\n$$\n这个条件被违反了，因为 $\\Pr(R_i=0 \\mid Y_i)$ 随 $Y_i$ 变化。\n\nMAR 条件要求\n$$\nR_i \\perp Y_i \\mid X_i \\quad \\text{或等价地} \\quad \\Pr(R_i=0 \\mid Y_i,X_i)=\\Pr(R_i=0 \\mid X_i),\n$$\n这个条件也被违反了，因为即使在以 $X_i$ 为条件后，缺失的概率仍然依赖于 $Y_i$ 本身。\n\n因此，这种缺失是 MNAR，其特征为\n$$\n\\Pr(R_i=0 \\mid Y_i,X_i) \\text{ 依赖于 } Y_i.\n$$\n选项D指的是一个后果（由无应答引起的偏误），而不是一个正式的数据缺失机制。最能描述这种模式的机制是 MNAR。", "answer": "$$\\boxed{C}$$", "id": "1936087"}, {"introduction": "这最后一个练习将从概念分类转向形式化的数学建模，这代表了在掌握缺失数据理论方面迈出的重要一步。你将分析一个涉及未观测潜变量 $Z$ 的假设性临床试验模型，以推导出随机缺失 (MAR) 假设成立的精确数学条件。这项挑战将加深你对缺失数据机制背后统计基础的理解。[@problem_id:1936118]", "problem": "在一项旨在测试一种新药的临床研究中，研究人员遇到了患者脱落的情况，导致了结果数据缺失。他们提出了一个统计模型来理解这一现象。对于每位患者，该模型包括：\n- 一个结果变量$Y$，代表患者对药物的反应。\n- 一个二元协变量$X \\in \\{0, 1\\}$，表示患者属于两个诊所中的哪一个。\n- 一个未观测到的二元潜在类别$Z \\in \\{0, 1\\}$，代表一种内在的患者类型（例如，对药物反应良好或不良的遗传倾向）。\n- 一个响应指示变量$R \\in \\{0, 1\\}$，其中如果观测到结果$Y$，则$R=1$；如果患者脱落且$Y$缺失，则$R=0$。\n\n该模型由以下一组假设定义：\n1.  潜在类别$Z$服从伯努利分布，$P(Z=1) = \\pi_z$，其中$0 < \\pi_z < 1$。\n2.  诊所协变量$X$服从伯努利分布，$P(X=1) = \\pi_x$，其中$0 < \\pi_x < 1$。变量$X$和$Z$是统计独立的。\n3.  患者的结果$Y$，在给定其潜在类别$Z=z$的条件下，服从均值为$\\mu_z$、恒定方差为$\\sigma^2 > 0$的正态分布。假设结果$Y$在给定潜在类别$Z$的条件下与诊所$X$是条件独立的。\n4.  观测到结果$Y$的概率（即$R=1$）通过以下逻辑斯蒂回归模型同时依赖于诊所$X$和潜在类别$Z$：\n    $$ \\ln\\left(\\frac{P(R=1 | X=x, Z=z)}{1 - P(R=1 | X=x, Z=z)}\\right) = \\beta_0 + \\beta_x x + \\beta_z z $$\n    其中$\\beta_0, \\beta_x, \\beta_z$是有限的实值参数。响应$R$在给定$X$和$Z$的条件下与结果$Y$是条件独立的。\n\n在缺失数据分析中，一个关键概念是数据是否为随机缺失（Missing At Random, MAR）。如果一个值缺失的概率仅依赖于已观测到的信息，那么 MAR 假设成立。在本问题的背景下，缺失数据机制是 MAR 当且仅当响应的条件概率$P(R=1 | Y, X)$不依赖于（可能缺失的）结果$Y$的值。\n\n关于模型参数的下列哪个条件是缺失数据机制为随机缺失（MAR）的充分必要条件？\n\nA. $\\beta_x = 0$\n\nB. $\\beta_z = 0$\n\nC. $\\mu_0 = \\mu_1$\n\nD. $\\beta_x = 0$ 或 $\\mu_0 = \\mu_1$\n\nE. $\\beta_z = 0$ 或 $\\mu_0 = \\mu_1$\n\nF. $\\beta_x = 0$ 且 $\\mu_0 = \\mu_1$\n\nG. $\\beta_z = 0$ 且 $\\mu_0 = \\mu_1$\n\nH. 只要$\\beta_z \\neq 0$，该机制就始终是“非随机缺失”（MNAR）。", "solution": "我们要求满足随机缺失（MAR）条件：$P(R=1 \\mid Y=y, X=x)$对于任何$x$都必须不依赖于$y$。\n\n根据关于潜在类别$Z$的全概率公式以及已陈述的条件独立性，\n$$\nP(R=1 \\mid Y=y, X=x)\n=\\sum_{z \\in \\{0,1\\}} P(R=1 \\mid X=x, Z=z)\\,P(Z=z \\mid Y=y, X=x).\n$$\n根据模型，$R \\perp Y \\mid (X,Z)$ 且 $P(R=1 \\mid X=x, Z=z)=\\{1+\\exp[-(\\beta_{0}+\\beta_{x}x+\\beta_{z}z)]\\}^{-1}$。另外，利用$X \\perp Z$和$Y \\perp X \\mid Z$，我们有\n$$\nP(Z=z \\mid Y=y, X=x)=P(Z=z \\mid Y=y).\n$$\n定义$s(t)=\\{1+\\exp(-t)\\}^{-1}$，并令$p_{0}(x)=s(\\beta_{0}+\\beta_{x}x)$及$p_{1}(x)=s(\\beta_{0}+\\beta_{x}x+\\beta_{z})$。那么\n$$\nP(R=1 \\mid Y=y, X=x)=p_{0}(x)\\,[1-P(Z=1 \\mid Y=y)] + p_{1}(x)\\,P(Z=1 \\mid Y=y)\n= p_{0}(x) + \\{p_{1}(x)-p_{0}(x)\\} P(Z=1 \\mid Y=y).\n$$\n因此，$P(R=1 \\mid Y=y, X=x)$不依赖于$y$当且仅当对于所有$x$都有$p_{1}(x)=p_{0}(x)$，或者$P(Z=1 \\mid Y=y)$对于$y$是常数。\n\n第一种情况（响应不依赖于$Z$）：对于所有$x$都有$p_{1}(x)=p_{0}(x)$成立，当且仅当$\\beta_{z}=0$，因为$s(\\cdot)$是严格单调递增函数。\n\n第二种情况（结果不包含关于$Z$的信息）：$P(Z=1 \\mid Y=y)$关于$y$为常数，当且仅当$Y \\perp Z$。在本模型$Y \\mid Z=z \\sim \\mathcal{N}(\\mu_{z},\\sigma^{2})$的设定下，这发生当且仅当$\\mu_{0}=\\mu_{1}$。为说明否则$P(Z=1 \\mid Y=y)$会依赖于$y$，我们计算后验对数优势比：\n$$\n\\ln\\frac{P(Z=1 \\mid Y=y)}{P(Z=0 \\mid Y=y)}\n=\\ln\\frac{\\pi_{z}}{1-\\pi_{z}} + \\ln f_{1}(y) - \\ln f_{0}(y),\n$$\n其中$f_{z}(y)$是$\\mathcal{N}(\\mu_{z},\\sigma^{2})$的密度函数。使用\n$$\n\\ln f_{z}(y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^{2}) - \\frac{(y-\\mu_{z})^{2}}{2\\sigma^{2}},\n$$\n我们得到\n$$\n\\ln\\frac{P(Z=1 \\mid Y=y)}{P(Z=0 \\mid Y=y)} = \\ln\\frac{\\pi_{z}}{1-\\pi_{z}} + \\frac{-(y-\\mu_{1})^{2} + (y-\\mu_{0})^{2}}{2\\sigma^{2}}\n= \\ln\\frac{\\pi_{z}}{1-\\pi_{z}} + \\frac{\\mu_{1}-\\mu_{0}}{\\sigma^{2}}\\,y + \\text{const},\n$$\n其关于$y$的斜率为$(\\mu_{1}-\\mu_{0})/\\sigma^{2}$。该斜率为零当且仅当$\\mu_{1}=\\mu_{0}$，此时$P(Z=1 \\mid Y=y)$是常数；否则它随$y$变化。\n\n因此，$P(R=1 \\mid Y=y, X=x)$不依赖于$y$当且仅当$\\beta_{z}=0$或$\\mu_{0}=\\mu_{1}$。对$\\beta_{x}$无需施加限制，因为$X$是已观测变量，其效应不会在$P(R=1 \\mid Y=y, X=x)$中引入对$y$的依赖性。\n\n因此，在这些选项中，充分必要条件是$\\beta_{z}=0$或$\\mu_{0}=\\mu_{1}$。", "answer": "$$\\boxed{E}$$", "id": "1936118"}]}