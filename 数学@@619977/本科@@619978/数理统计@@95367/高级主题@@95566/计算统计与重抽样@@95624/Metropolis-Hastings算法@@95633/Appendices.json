{"hands_on_practices": [{"introduction": "Metropolis-Hastings 算法的核心在于其接受概率，它决定了我们是转移到新状态还是停留在当前状态。第一个练习将为你提供计算离散目标分布（泊松分布）接受概率的基础实践。通过这个使用对称提议分布的简单案例，你将掌握支撑整个方法的核心比率计算。[@problem_id:1962612]", "problem": "一位统计学家正在实施一个马尔可夫链蒙特卡洛 (MCMC) 模拟，以从一个目标概率分布中生成样本。所选的目标分布是泊松分布，该分布模拟在固定的时间或空间间隔内发生的事件数 $k$。泊松分布的概率质量函数由以下公式给出：\n$$ P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$\n其中 $\\lambda$ 是事件的平均发生率。对于本次特定的模拟，参数设置为 $\\lambda=5$。\n\n该模拟使用 Metropolis-Hastings 算法和一个对称提议分布，这意味着从状态 $k_1$ 提议移动到状态 $k_2$ 的概率与从 $k_2$ 提议移动到 $k_1$ 的概率相同。\n\n假设链的当前状态为 $k=5$。算法接着提议移动到一个新状态 $k'=6$。\n\n计算从 $k=5$ 到 $k'=6$ 这一提议移动的接受概率。将您的答案表示为保留三位有效数字的小数。", "solution": "在具有对称提议分布的 Metropolis-Hastings 算法中，从状态 $k$ 到 $k'$ 的提议移动的接受概率为\n$$\n\\alpha = \\min\\left(1, \\frac{\\pi(k')}{\\pi(k)}\\right),\n$$\n其中 $\\pi(\\cdot)$ 是目标概率质量函数。对于参数为 $\\lambda$ 的泊松分布，其概率质量函数 (PMF) 为\n$$\n\\pi(k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!}.\n$$\n因此，该比率可简化为\n$$\n\\frac{\\pi(k')}{\\pi(k)} = \\frac{\\lambda^{k'} \\exp(-\\lambda) / k'!}{\\lambda^{k} \\exp(-\\lambda) / k!} = \\lambda^{k'-k} \\frac{k!}{k'!}.\n$$\n当 $k=5$，$k'=6$ 且 $\\lambda=5$ 时，我们有 $k'-k=1$ 和 $6! = 6 \\cdot 5!$，所以\n$$\n\\frac{\\pi(6)}{\\pi(5)} = \\lambda \\cdot \\frac{5!}{6!} = \\lambda \\cdot \\frac{1}{6} = \\frac{5}{6}.\n$$\n因此，接受概率为\n$$\n\\alpha = \\min\\left(1, \\frac{5}{6}\\right) = \\frac{5}{6}.\n$$\n表示为保留三位有效数字的小数，结果是 $0.833$。", "answer": "$$\\boxed{0.833}$$", "id": "1962612"}, {"introduction": "MCMC 方法的强大之处远不止于从标准概率分布中抽样。本实践将演示如何使用 Metropolis 算法在一个二维平面 $\\mathbb{R}^2$ 上的复杂、自定义区域 $\\mathcal{S}$ 内进行均匀抽样。这个例子将“目标分布”($\\pi(x)$)这一抽象概念变得具体化，展示了它如何能简单地定义一个“有效”区域，从而让你对接受/拒绝机制有一个高度直观的理解。[@problem_id:1962636]", "problem": "一位数据科学家正在为一个系统建模，该系统的状态可以用一个二维空间中的点 $(x, y)$ 来描述。系统的有效状态被限制在一个特定区域 $\\mathcal{S} \\subset \\mathbb{R}^2$ 内。区域 $\\mathcal{S}$ 由以下不等式组定义：\n1. $y \\ge x^2$\n2. $x^2 + y^2 \\le 4$\n3. $x \\ge 0$\n\n为了探索这个状态空间，该科学家使用了 Metropolis 算法，它是 Metropolis-Hastings 算法在提议分布对称时的一个特例。目标是生成一个在区域 $\\mathcal{S}$ 内均匀分布的点序列。\n\n该算法按离散时间步进行。设系统在第 $t$ 步的状态为 $P_t = (x_t, y_t)$。为了生成第 $t+1$ 步的状态，会提出了一个新的候选状态 $P'_{t+1}$。然后根据 Metropolis 接受准则决定接受或拒绝该候选状态。如果接受，则 $P_{t+1} = P'_{t+1}$。如果拒绝，状态不发生改变，即 $P_{t+1} = P_t$。\n\n系统的初始状态为 $P_0 = (1.0, 1.5)$。按顺序提出了一个包含五个候选状态的序列：\n- $P'_1 = (1.1, 1.8)$\n- $P'_2 = (0.8, 1.7)$\n- $P'_3 = (0.6, 0.2)$\n- $P'_4 = (0.9, 1.9)$\n- $P'_5 = (0.7, 1.1)$\n\n确定在考虑了所有五个提议之后系统状态的坐标，记为 $P_5 = (x_5, y_5)$。", "solution": "我们的目标是区域 $\\mathcal{S}=\\{(x,y)\\in\\mathbb{R}^{2}: y\\ge x^{2},\\ x^{2}+y^{2}\\le 4,\\ x\\ge 0\\}$ 上的均匀分布。对于对称的提议分布，Metropolis 接受概率为\n$$\n\\alpha\\big(P_{t}\\to P'\\big)=\\min\\left(1,\\frac{\\pi(P')}{\\pi(P_{t})}\\right),\n$$\n其中 $\\pi$ 是目标密度。对于 $\\mathcal{S}$ 上的均匀目标分布，如果 $P\\in\\mathcal{S}$，则 $\\pi(P)=c>0$，否则 $\\pi(P)=0$。因此，\n- 如果 $P'\\in\\mathcal{S}$，则 $\\alpha=1$（接受），\n- 如果 $P'\\notin\\mathcal{S}$，则 $\\alpha=0$（拒绝）。\n\n我们首先验证初始状态 $P_{0}=(1.0,1.5)$ 在 $\\mathcal{S}$ 中：\n$$\nx_{0}=1.0\\ge 0,\\quad y_{0}=1.5\\ge x_{0}^{2}=1.0,\\quad x_{0}^{2}+y_{0}^{2}=1.0+2.25=3.25\\le 4,\n$$\n所以 $P_{0}\\in\\mathcal{S}$。\n\n我们现在检查每一个提议：\n\n1) $P'_{1}=(1.1,1.8)$:\n$$\nx=1.1\\ge 0,\\quad y=1.8\\ge x^{2}=1.21,\\quad x^{2}+y^{2}=1.21+3.24=4.45>4,\n$$\n所以 $P'_{1}\\notin\\mathcal{S}$，拒绝。因此 $P_{1}=P_{0}=(1.0,1.5)$。\n\n2) $P'_{2}=(0.8,1.7)$:\n$$\nx=0.8\\ge 0,\\quad y=1.7\\ge x^{2}=0.64,\\quad x^{2}+y^{2}=0.64+2.89=3.53\\le 4,\n$$\n所以 $P'_{2}\\in\\mathcal{S}$，接受。因此 $P_{2}=(0.8,1.7)$。\n\n3) $P'_{3}=(0.6,0.2)$:\n$$\nx=0.6\\ge 0,\\quad y=0.2\\ge x^{2}=0.36\\ \\text{is false},\n$$\n所以 $P'_{3}\\notin\\mathcal{S}$，拒绝。因此 $P_{3}=P_{2}=(0.8,1.7)$。\n\n4) $P'_{4}=(0.9,1.9)$:\n$$\nx=0.9\\ge 0,\\quad y=1.9\\ge x^{2}=0.81,\\quad x^{2}+y^{2}=0.81+3.61=4.42>4,\n$$\n所以 $P'_{4}\\notin\\mathcal{S}$，拒绝。因此 $P_{4}=(0.8,1.7)$。\n\n5) $P'_{5}=(0.7,1.1)$:\n$$\nx=0.7\\ge 0,\\quad y=1.1\\ge x^{2}=0.49,\\quad x^{2}+y^{2}=0.49+1.21=1.70\\le 4,\n$$\n所以 $P'_{5}\\in\\mathcal{S}$，接受。因此 $P_{5}=(0.7,1.1)$。\n\n因此，在五次提议后，状态为 $P_{5}=(0.7,1.1)$。", "answer": "$$\\boxed{\\begin{pmatrix}0.7 & 1.1\\end{pmatrix}}$$", "id": "1962636"}, {"introduction": "实现一个 MCMC 采样器是一回事，而确保其高效运行则是另一回事。最后一个实践深入探讨了 MCMC 诊断的一个关键方面：解读接受率。通过分析一个接受率非常高的场景，你将了解到提议分布的步长（$\\sigma$）与有效探索状态空间之间的关键权衡，这是任何实践者都需掌握的关键技能。[@problem_id:1962675]", "problem": "一位数据科学家正在使用 Metropolis 算法（Metropolis-Hastings 算法的一个特例）从一个一维、连续且单峰的目标概率密度函数 $\\pi(x)$ 中生成样本。该算法的工作原理如下：在每一步 $t$，给定当前状态 $x_t$，从一个对称的提议分布 $q(x'|x_t) = q(x_t|x')$ 中提议一个新的候选状态 $x'$。在这种情况下，提议分布是一个以当前状态为中心的正态分布，$x' \\sim N(x_t, \\sigma^2)$，其中标准差 $\\sigma$ 是一个控制步长的调节参数。\n\n新状态 $x'$ 以概率 $\\alpha = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x_t)}\\right)$ 被接受。如果被接受，下一个状态为 $x_{t+1} = x'$；否则，马尔可夫链保持在当前状态，$x_{t+1} = x_t$。\n\n在运行采样器大量迭代后，该数据科学家观察到接受率持续在 99.5% 左右。在马尔可夫链蒙特卡洛 (MCMC) 诊断的背景下，下列哪个陈述对这一观察结果提供了最准确且最可能的解释？\n\nA. 采样器表现最佳，因为高接受率确保了生成的样本是目标分布的完美代表。\n\nB. 提议步长 $\\sigma$ 可能过大，导致采样器在目标分布的尾部提议状态，而这些状态几乎总是被拒绝。\n\nC. 采样器已成功收敛到平稳分布，并且后续样本可以被视为从 $\\pi(x)$ 中进行的独立抽取。\n\nD. 提议步长 $\\sigma$ 可能过小，导致采样器探索状态空间的速度非常缓慢且效率低下，尽管大多数步骤都被接受了。\n\nE. 目标分布 $\\pi(x)$ 必定是近乎均匀的，这就是为什么几乎每个提议的状态都被接受。", "solution": "给定一个对称提议 $q(x'|x_{t})=q(x_{t}|x')$，Metropolis 接受概率简化为\n$$\n\\alpha(x_{t},x')=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x_{t})}\\right)=\\min\\left(1,\\exp\\left(\\ln\\pi(x')-\\ln\\pi(x_{t})\\right)\\right).\n$$\n令 $x'=x_{t}+\\epsilon$，其中 $\\epsilon\\sim N(0,\\sigma^{2})$。定义对数密度 $\\ell(x)=\\ln\\pi(x)$。对于可微的单峰 $\\pi$，在 $x_{t}$ 附近进行泰勒展开可得\n$$\n\\ell(x_{t}+\\epsilon)-\\ell(x_{t})=\\ell'(x_{t})\\,\\epsilon+\\frac{1}{2}\\ell''(x_{t})\\,\\epsilon^{2}+o(\\epsilon^{2}).\n$$\n当 $\\sigma$ 很小时，$\\epsilon$ 的量级通常是 $\\sigma$，因此对数密度的变化很小：\n$$\n\\ell(x_{t}+\\epsilon)-\\ell(x_{t})=\\mathcal{O}(\\sigma)+\\mathcal{O}(\\sigma^{2}).\n$$\n因此 $\\exp\\left(\\ell(x_{t}+\\epsilon)-\\ell(x_{t})\\right)\\approx 1$，这意味着 $\\alpha(x_{t},x')\\approx 1$。因此，接近 0.995 的接受率是步长 $\\sigma$ 非常小的一个标志：大多数提议的移动在 $\\pi$ 上产生的变化可以忽略不计，所以它们几乎总是被接受。然而，此时马尔可夫链以大小为 $\\epsilon=\\mathcal{O}(\\sigma)$ 的增量移动，因此每次迭代对状态空间的探索都很慢，并且马尔可夫链表现出高自相关性和差的混合效率。\n\n根据上述分析，我们来考虑每个选项：\n- A 是错误的，因为非常高的接受率并不意味着最佳性能或完美代表；过高的接受率通常表示步长过小和探索效率低下。\n- B 是错误的，因为过大的 $\\sigma$ 通常会驱使提议进入低密度区域，导致低接受率而非高接受率。\n- C 是错误的，因为仅凭接受率不能确定收敛，并且即使在平稳状态下，随机游走 Metropolis 样本也不是独立的；在步长很小的情况下，它们是强自相关的。\n- D 是正确的：非常高的接受率强烈表明 $\\sigma$ 过小，导致尽管大多数提议被接受，但探索速度缓慢。\n- E 是错误的，因为接近 1 的接受率并不要求 $\\pi$ 近乎均匀；它可能仅仅由非常小的 $\\sigma$ 引起。一个真正均匀的目标分布对于任何提议都会产生恰好为 1 的接受率，这与题意不符。\n\n因此，最准确的解释是提议步长过小，尽管接受率很高，但导致了低效的探索。", "answer": "$$\\boxed{D}$$", "id": "1962675"}]}