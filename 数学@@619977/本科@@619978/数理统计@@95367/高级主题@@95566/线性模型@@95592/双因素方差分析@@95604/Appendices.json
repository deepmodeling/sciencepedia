{"hands_on_practices": [{"introduction": "掌握双因素方差分析（Two-way ANOVA）的第一步是熟悉其计算过程。本练习提供了一个清晰的场景，让您一步步计算交互作用的 $F$ 统计量，这是衡量两个因素如何相互影响的关键指标。通过这个关于藻类生长的生物学实验案例，您将能熟练运用方差分析的核心公式，为解读更复杂的实验数据打下坚实基础。[@problem_id:1965185]", "problem": "一位环境科学家正在研究水温和光照对某种特定藻类生长速率的影响。生长速率以毫克/升/天（$\\text{mg/L/day}$）为单位进行测量。考虑了两种温度水平（因子A）：$15^{\\circ}\\text{C}$和$25^{\\circ}\\text{C}$。使用了三种光照水平（因子B）：低、中和高。对于 $2 \\times 3 = 6$ 种实验条件中的每一种，都准备了四个重复水样，并在设定的时间段后测量它们的藻类生长速率。收集的数据如下：\n\n| | 低光照 | 中光照 | 高光照 |\n| :--- | :--- | :--- | :--- |\n| **$15^{\\circ}\\text{C}$** | 4, 5, 5, 6 | 7, 8, 8, 9 | 10, 11, 11, 12 |\n| **$25^{\\circ}\\text{C}$** | 6, 7, 7, 8 | 12, 13, 13, 14 | 18, 19, 19, 21 |\n\n假设双因素方差分析（ANOVA）的标准模型适用于这些数据，计算温度和光照之间交互作用效应的F-统计量。将最终答案四舍五入到三位有效数字。", "solution": "令 $a=2$（温度水平），$b=3$（光照水平），以及每个单元格的重复次数 $n=4$。使用带交互作用的双因素方差分析模型：\n$$\ny_{ijk}=\\mu+\\alpha_{i}+\\beta_{j}+(\\alpha\\beta)_{ij}+\\varepsilon_{ijk},\n$$\n其中 $i=1,\\ldots,a$，$j=1,\\ldots,b$，$k=1,\\ldots,n$。\n\n计算单元格均值 $\\bar{y}_{ij.}$、行均值 $\\bar{y}_{i..}$、列均值 $\\bar{y}_{.j.}$ 和总均值 $\\bar{y}_{...}$：\n- 单元格均值：\n$$\n\\bar{y}_{11.}=5,\\quad \\bar{y}_{12.}=8,\\quad \\bar{y}_{13.}=11,\\quad \\bar{y}_{21.}=7,\\quad \\bar{y}_{22.}=13,\\quad \\bar{y}_{23.}=\\frac{77}{4}.\n$$\n- 行均值：\n$$\n\\bar{y}_{1..}=\\frac{96}{12}=8,\\quad \\bar{y}_{2..}=\\frac{157}{12}.\n$$\n- 列均值：\n$$\n\\bar{y}_{.1.}=\\frac{48}{8}=6,\\quad \\bar{y}_{.2.}=\\frac{84}{8}=\\frac{21}{2},\\quad \\bar{y}_{.3.}=\\frac{121}{8}.\n$$\n- 总均值：\n$$\n\\bar{y}_{...}=\\frac{253}{24}.\n$$\n\n交互作用对比为 $d_{ij}=\\bar{y}_{ij.}-\\bar{y}_{i..}-\\bar{y}_{.j.}+\\bar{y}_{...}$：\n$$\nd_{11}=\\frac{37}{24},\\quad d_{12}=\\frac{1}{24},\\quad d_{13}=-\\frac{19}{12},\\quad d_{21}=-\\frac{37}{24},\\quad d_{22}=-\\frac{1}{24},\\quad d_{23}=\\frac{19}{12}.\n$$\n因此交互作用平方和为\n$$\nSS_{AB}=n\\sum_{i=1}^{a}\\sum_{j=1}^{b} d_{ij}^{2}\n=4\\left[2\\left(\\frac{37}{24}\\right)^{2}+2\\left(\\frac{1}{24}\\right)^{2}+2\\left(\\frac{19}{12}\\right)^{2}\\right]\n=4\\cdot\\frac{469}{48}=\\frac{469}{12}.\n$$\n交互作用自由度为\n$$\ndf_{AB}=(a-1)(b-1)=2,\n$$\n所以\n$$\nMS_{AB}=\\frac{SS_{AB}}{df_{AB}}=\\frac{\\frac{469}{12}}{2}=\\frac{469}{24}.\n$$\n\n误差平方和是各组内平方和的总和：\n- 对于均值为整数的五个单元格，每个单元格的组内平方和为 $2$。\n- 对于均值为 $\\frac{77}{4}$ 的（$25^{\\circ}\\text{C}$， 高光照）单元格：\n$$\n(18-\\tfrac{77}{4})^{2}+(19-\\tfrac{77}{4})^{2}+(19-\\tfrac{77}{4})^{2}+(21-\\tfrac{77}{4})^{2}=\\frac{25}{16}+\\frac{1}{16}+\\frac{1}{16}+\\frac{49}{16}=\\frac{76}{16}=\\frac{19}{4}.\n$$\n因此\n$$\nSS_{E}=2+2+2+2+2+\\frac{19}{4}=\\frac{59}{4}.\n$$\n误差自由度为\n$$\ndf_{E}=ab(n-1)=2\\cdot 3\\cdot 3=18,\n$$\n所以\n$$\nMS_{E}=\\frac{SS_{E}}{df_{E}}=\\frac{\\frac{59}{4}}{18}=\\frac{59}{72}.\n$$\n\n因此，交互作用的 $F$-统计量为\n$$\nF_{AB}=\\frac{MS_{AB}}{MS_{E}}=\\frac{\\frac{469}{24}}{\\frac{59}{72}}=\\frac{469}{24}\\cdot\\frac{72}{59}=\\frac{1407}{59}\\approx 23.847\\ldots\n$$\n四舍五入到三位有效数字，结果为 $23.8$。", "answer": "$$\\boxed{23.8}$$", "id": "1965185"}, {"introduction": "在掌握了计算方法后，下一个关键技能是正确地解读结果。一个显著的交互作用是双因素方差分析中最重要也最容易被误解的发现之一。这个问题展示了一个现实情境，其中对主效应的盲目分析会导致错误的结论，它将挑战您批判性地思考，在存在交互作用时为何比较边际均值会产生误导，从而磨练您的分析判断能力。[@problem_id:1964658]", "problem": "一位农业科学家进行了一项实验，旨在研究三种不同类型的肥料（F1、F2、F3）和两种不同类型的土壤（S1、S2）对作物产量的影响，产量以公斤/小区（kg/plot）为单位测量。该实验采用完全随机设计，对 $3 \\times 2 = 6$ 个处理组合中的每一种都使用了10个小区。\n\n收集数据后，进行了双因素方差分析（ANOVA）。ANOVA表的结果表明，在α水平为0.05时，肥料类型和土壤类型之间的交互效应的F检验在统计上是显著的。ANOVA表中的均方误差（MSE）为25.0，自由度为54。\n\n分析师观察到以下肥料类型的单元格均值和边际均值：\n\n**单元格均值（公斤/小区）：**\n- 肥料F1，土壤S1：50.0\n- 肥料F1，土壤S2：70.0\n- 肥料F2，土壤S1：65.0\n- 肥料F2，土壤S2：65.0\n- 肥料F3，土壤S1：80.0\n- 肥料F3，土壤S2：50.0\n\n**肥料类型的边际均值（公斤/小区）：**\n- 肥料F1：60.0\n- 肥料F2：65.0\n- 肥料F3：65.0\n\n分析师忽略了显著的交互作用，继续使用Tukey's诚实显著性差异（HSD）程序对三种肥料类型的边际均值进行成对比较。基于此检验，分析师得出结论，F2和F3的平均产量在统计上是等效的，并且两者均显著高于F1的平均产量。\n\n以下哪个陈述对分析师对三种肥料类型的边际均值进行的事后比较提出了最准确和最根本的批评？\n\nA. 分析师应该使用Bonferroni校正而不是Tukey's HSD，因为在存在交互作用的情况下，它能更好地控制族系误差率。\n\nB. 比较存在缺陷，因为显著的交互效应违反了Tukey's HSD所需的方差齐性假设。\n\nC. 边际均值的比较在概念上具有误导性，因为显著交互作用的存在意味着肥料类型的效果取决于土壤类型，这使得肥料的“平均”效果无法解释。\n\nD. 分析师不能进行任何事后检验，因为交互作用的F检验是显著的，这使得任何进一步的成对比较都无效。\n\nE. Tukey's HSD的计算应该使用F分布的临界值，而不是学生化全距分布，因为这是一个双因素实验。", "solution": "我们将肥料类型（$i=1,2,3$）、土壤类型（$j=1,2$）和重复（$k=1,\\dots,10$）的双因素ANOVA模型形式化为\n$$\nY_{ijk}=\\mu+\\alpha_{i}+\\beta_{j}+(\\alpha\\beta)_{ij}+\\varepsilon_{ijk},\n$$\n其中$\\varepsilon_{ijk}\\sim\\text{i.i.d. }N(0,\\sigma^{2})$。对于交互项的统计上显著的F检验意味着，至少对于某些$(i,j)$对，$(\\alpha\\beta)_{ij}\\neq 0$。这直接意味着肥料的效果取决于土壤，即在不同土壤类型下，肥料水平之间的差异不是恒定的。\n\n肥料 $i$ 的边际均值是对土壤类型取平均值：\n$$\n\\bar{Y}_{i\\cdot\\cdot}=\\mu+\\alpha_{i}+\\frac{1}{2}\\sum_{j=1}^{2}\\beta_{j}+\\frac{1}{2}\\sum_{j=1}^{2}(\\alpha\\beta)_{ij}.\n$$\n由于$(\\alpha\\beta)_{ij}$非零且随 $j$ 变化，因此在对 $j$ 进行汇总时，量 $\\alpha_{i}$ 无法从 $(\\alpha\\beta)_{ij}$ 中分离解释。因此，比较不同 $i$ 的 $\\bar{Y}_{i\\cdot\\cdot}$ 并不是在估计一个单一、一致的肥料效应；它混淆了因土壤水平而异的效应。\n\n给定的单元格均值通过检查每种土壤内的简单效应明确地证明了这种依赖性：\n- 在土壤S1中：$F2-F1=65.0-50.0=15.0$, $F3-F2=80.0-65.0=15.0$, $F3-F1=80.0-50.0=30.0$。\n- 在土壤S2中：$F2-F1=65.0-70.0=-5.0$, $F3-F2=50.0-65.0=-15.0$, $F3-F1=50.0-70.0=-20.0$。\n这些效应在不同土壤中方向相反（一种交叉交互作用）。因此，肥料的边际均值（$60.0,65.0,65.0$）是对相反的效应进行平均，在不以土壤为条件的情况下，对于描述肥料效应没有意义。这使得在存在显著交互作用时，对肥料边际均值进行事后比较在概念上具有误导性；而应该比较简单效应（例如，每种土壤内的肥料效应）或使用针对交互作用定制的对比。\n\n现在评估各个选项：\n- A是错误的：根本问题不在于族系误差率控制方法的选择（Tukey vs Bonferroni），而在于交互作用下边际均值的可解释性。\n- B是错误的：显著的交互作用涉及均值结构，而不是方差齐性；它并不意味着违反了Tukey's HSD所需的等方差假设。\n- C是正确的：当交互作用显著时，肥料的效果取决于土壤，因此对土壤进行平均会产生一个无法解释的“平均”效应，并误导推断。\n- D是错误的：事后检验仍然是可能和适当的，但它们应针对简单效应或交互作用对比，而不是边际主效应。\n- E是错误的：即使在多因素设计中比较均值时，Tukey's HSD也使用学生化全距分布，而不是F分布。\n\n因此，最准确和最根本的批评是，当交互作用显著时，比较边际均值在概念上具有误导性。", "answer": "$$\\boxed{C}$$", "id": "1964658"}, {"introduction": "要想真正深入理解双因素方差分析，一个有效的方法是将其视为一个更广泛的统计模型家族——广义线性模型（General Linear Model, GLM）——的一部分。本练习通过要求您构建其设计矩阵 $X$，将熟悉的因子和效应结构转化为线性代数的语言，从而揭开方差分析模型的神秘面纱。这项实践揭示了方差分析底层的数学基础，并突出了其与线性回归的深刻联系。[@problem_id:1965175]", "problem": "一个软件工程团队正在对一个新的网络应用进行性能分析。他们测量了该应用在不同条件下的响应时间。该实验设计了两个因子：因子 A 是云提供商，有 $I=3$ 个水平（`Provider 1`、`Provider 2`、`Provider 3`）；因子 B 是数据库引擎，有 $J=2$ 个水平（`Engine A`、`Engine B`）。对于 $I \\times J = 6$ 种处理组合中的每一种，团队收集了 $K=2$ 个独立的响应时间测量值。\n\n团队使用带交互项的双因素方差分析（ANOVA）模型对响应时间 $y_{ijk}$ 进行建模：\n$$y_{ijk} = \\mu + \\alpha_i + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}$$\n其中 $i \\in \\{1, 2, 3\\}$，$j \\in \\{1, 2\\}$，$k \\in \\{1, 2\\}$。这里，$\\mu$ 是总平均响应时间，$\\alpha_i$ 是`Provider i`的主效应，$\\beta_j$ 是`Engine j`的主效应，$(\\alpha\\beta)_{ij}$ 是`Provider i`和`Engine j`之间的交互效应，$\\epsilon_{ijk}$ 代表随机误差。\n\n该模型可以表示为广义线性模型（GLM）的形式：$\\vec{Y} = X \\vec{\\beta} + \\vec{\\epsilon}$。为确保参数是唯一可识别的，我们施加了一个“设为零”（或称角点）约束系统：将每个因子的最后一个水平对应的效应以及任何涉及这些水平的交互作用都设为零。具体来说，$\\alpha_3 = 0$ 且 $\\beta_2 = 0$，这意味着交互项 $(\\alpha\\beta)_{12}$、$(\\alpha\\beta)_{22}$、$(\\alpha\\beta)_{31}$ 和 $(\\alpha\\beta)_{32}$ 也为零。\n\n观测向量 $\\vec{Y}$ 是一个 $N \\times 1$ 的列向量（其中 $N = I \\times J \\times K$），它是通过首先遍历重复索引 $k$，然后是引擎索引 $j$，最后是提供商索引 $i$ 的顺序堆叠观测值 $y_{ijk}$ 而得到的。即 $\\vec{Y} = [y_{111}, y_{112}, y_{121}, y_{122}, y_{211}, y_{212}, \\dots, y_{322}]^T$。\n\n你的任务是确定在这种特定实验设置和参数化下的设计矩阵 $X$。", "solution": "我们从带交互项的双因素方差分析模型开始\n$$y_{ijk}=\\mu+\\alpha_{i}+\\beta_{j}+(\\alpha\\beta)_{ij}+\\epsilon_{ijk},$$\n其中因子 $i\\in\\{1,2,3\\}$ 和 $j\\in\\{1,2\\}$，以及 $k\\in\\{1,2\\}$ 次重复。在角点约束 $\\alpha_{3}=0$ 和 $\\beta_{2}=0$ 下，涉及受约束水平的交互效应被设为零：$(\\alpha\\beta)_{12}=(\\alpha\\beta)_{22}=(\\alpha\\beta)_{31}=(\\alpha\\beta)_{32}=0$。因此，自由参数为\n$$\\vec{\\beta}=\\begin{bmatrix}\\mu & \\alpha_{1} & \\alpha_{2} & \\beta_{1} & (\\alpha\\beta)_{11} & (\\alpha\\beta)_{21}\\end{bmatrix}^{T}.$$\n对于来自单元格 $(i,j)$ 的一个观测值，设计矩阵 $X$ 的对应行具有指示这些效应是否存在的条目：\n$$[\\,1,\\ \\mathbb{I}\\{i=1\\},\\ \\mathbb{I}\\{i=2\\},\\ \\mathbb{I}\\{j=1\\},\\ \\mathbb{I}\\{i=1,j=1\\},\\ \\mathbb{I}\\{i=2,j=1\\}\\,].$$\n观测向量 $\\vec{Y}$ 按 $k$ 最快、其次是 $j$、然后是 $i$ 的顺序排列：$[y_{111},y_{112},y_{121},y_{122},y_{211},y_{212},y_{221},y_{222},y_{311},y_{312},y_{321},y_{322}]^{T}$。因此，$12\\times 6$ 的设计矩阵 $X$（其列的顺序与上面的 $\\vec{\\beta}$ 相同）是\n$$\\begin{pmatrix}\n1 & 1 & 0 & 1 & 1 & 0\\\\\n1 & 1 & 0 & 1 & 1 & 0\\\\\n1 & 1 & 0 & 0 & 0 & 0\\\\\n1 & 1 & 0 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 1 & 0 & 1\\\\\n1 & 0 & 1 & 1 & 0 & 1\\\\\n1 & 0 & 1 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 0 & 0 & 0\\\\\n1 & 0 & 0 & 1 & 0 & 0\\\\\n1 & 0 & 0 & 1 & 0 & 0\\\\\n1 & 0 & 0 & 0 & 0 & 0\\\\\n1 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}.$$\n每对相同的连续行对应于每个 $(i,j)$ 单元格内的两次重复。", "answer": "$$\\boxed{\\begin{pmatrix}\n1 & 1 & 0 & 1 & 1 & 0\\\\\n1 & 1 & 0 & 1 & 1 & 0\\\\\n1 & 1 & 0 & 0 & 0 & 0\\\\\n1 & 1 & 0 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 1 & 0 & 1\\\\\n1 & 0 & 1 & 1 & 0 & 1\\\\\n1 & 0 & 1 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 0 & 0 & 0\\\\\n1 & 0 & 0 & 1 & 0 & 0\\\\\n1 & 0 & 0 & 1 & 0 & 0\\\\\n1 & 0 & 0 & 0 & 0 & 0\\\\\n1 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}}$$", "id": "1965175"}]}