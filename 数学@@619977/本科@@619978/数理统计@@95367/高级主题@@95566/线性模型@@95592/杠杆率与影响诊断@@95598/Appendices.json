{"hands_on_practices": [{"introduction": "杠杆值的概念量化了单个数据点对回归模型的潜在影响，而这种潜力仅取决于其在预测变量空间中的位置。本练习提供了一个基础性的、分步的指南，教你如何在一个简单的线性回归模型中，直接从设计矩阵计算杠杆值。通过完成这个计算，你将具体地理解一个数据点的预测变量值（$x$值）与数据中心的距离是如何决定其杠杆大小的。[@problem_id:1930389]", "problem": "在线性回归的研究中，诊断工具对于识别有影响的数据点至关重要。统计杠杆值就是这样一种工具。考虑一个形式为 $Y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$ 的简单线性回归模型，其中 $\\beta_0$ 和 $\\beta_1$ 分别是截距和斜率参数，$\\epsilon_i$ 是独立的误差项。\n\n一个实验设计了三个观测值，对应的预测变量值为 $x_1 = -2$，$x_2 = 1$ 和 $x_3 = 4$。响应值 $y_i$ 未被提供。第 $i$ 个数据点的杠杆值定义为帽子矩阵 $H$ 的第 $i$ 个对角线元素 $h_{ii}$。帽子矩阵由表达式 $H = X(X^T X)^{-1} X^T$ 定义，其中 $X$ 是模型的设计矩阵。对于此模型，设计矩阵 $X$ 是一个 $3 \\times 2$ 的矩阵，其第一列全为1，第二列包含预测变量值 $x_i$。\n\n计算这三个给定数据点的杠杆值 $h_{11}$、$h_{22}$ 和 $h_{33}$。请将您的答案表示为一个行向量，按顺序包含这三个值，并使用它们精确的分数形式。", "solution": "在带有截距的简单线性回归中，设计矩阵的行向量为 $x_{i}^{T} = \\begin{pmatrix} 1 & x_{i} \\end{pmatrix}$。对于给定的 $x$ 值，设计矩阵为\n$$\nX = \\begin{pmatrix}\n1 & -2 \\\\\n1 & 1 \\\\\n1 & 4\n\\end{pmatrix}.\n$$\n帽子矩阵为 $H = X(X^{T}X)^{-1}X^{T}$，杠杆值为对角线元素 $h_{ii} = x_{i}^{T}(X^{T}X)^{-1}x_{i}$。\n\n首先计算 $X^{T}X$：\n$$\nX^{T}X = \\begin{pmatrix}\n\\sum_{i=1}^{3} 1 & \\sum_{i=1}^{3} x_{i} \\\\\n\\sum_{i=1}^{3} x_{i} & \\sum_{i=1}^{3} x_{i}^{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n3 & (-2)+1+4 \\\\\n(-2)+1+4 & (-2)^{2}+1^{2}+4^{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n3 & 3 \\\\\n3 & 21\n\\end{pmatrix}.\n$$\n$2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 的逆是 $\\frac{1}{ad-bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。因此\n$$\n(X^{T}X)^{-1} = \\frac{1}{3\\cdot 21 - 3\\cdot 3}\\begin{pmatrix} 21 & -3 \\\\ -3 & 3 \\end{pmatrix}\n= \\frac{1}{54}\\begin{pmatrix} 21 & -3 \\\\ -3 & 3 \\end{pmatrix}.\n$$\n现在为每个 $i$ 计算 $h_{ii} = x_{i}^{T}(X^{T}X)^{-1}x_{i}$。\n\n对于 $i=1$，有 $x_{1}=-2$，令 $v_{1}=\\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。则\n$$\n(X^{T}X)^{-1}v_{1} = \\frac{1}{54}\\begin{pmatrix} 21 & -3 \\\\ -3 & 3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n= \\frac{1}{54}\\begin{pmatrix} 21 + 6 \\\\ -3 - 6 \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{6} \\end{pmatrix},\n$$\n所以\n$$\nh_{11} = v_{1}^{T}(X^{T}X)^{-1}v_{1} = \\begin{pmatrix} 1 & -2 \\end{pmatrix}\\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{6} \\end{pmatrix}\n= \\frac{1}{2} + \\frac{1}{3} = \\frac{5}{6}.\n$$\n\n对于 $i=2$，有 $x_{2}=1$，令 $v_{2}=\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。则\n$$\n(X^{T}X)^{-1}v_{2} = \\frac{1}{54}\\begin{pmatrix} 21 & -3 \\\\ -3 & 3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n= \\frac{1}{54}\\begin{pmatrix} 18 \\\\ 0 \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{3} \\\\ 0 \\end{pmatrix},\n$$\n所以\n$$\nh_{22} = v_{2}^{T}(X^{T}X)^{-1}v_{2} = \\begin{pmatrix} 1 & 1 \\end{pmatrix}\\begin{pmatrix} \\frac{1}{3} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{3}.\n$$\n\n对于 $i=3$，有 $x_{3}=4$，令 $v_{3}=\\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}$。则\n$$\n(X^{T}X)^{-1}v_{3} = \\frac{1}{54}\\begin{pmatrix} 21 & -3 \\\\ -3 & 3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}\n= \\frac{1}{54}\\begin{pmatrix} 9 \\\\ 9 \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{6} \\end{pmatrix},\n$$\n所以\n$$\nh_{33} = v_{3}^{T}(X^{T}X)^{-1}v_{3} = \\begin{pmatrix} 1 & 4 \\end{pmatrix}\\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{6} \\end{pmatrix}\n= \\frac{1}{6} + \\frac{4}{6} = \\frac{5}{6}.\n$$\n\n作为检验，杠杆值的总和等于 $H$ 的迹，也就是模型的秩 $p=2$，并且确实有 $\\frac{5}{6}+\\frac{1}{3}+\\frac{5}{6}=\\frac{12}{6}=2$。\n\n因此，杠杆值按顺序为 $\\frac{5}{6}, \\frac{1}{3}, \\frac{5}{6}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{6} & \\frac{1}{3} & \\frac{5}{6}\\end{pmatrix}}$$", "id": "1930389"}, {"introduction": "杠杆值衡量了一个数据点影响模型的*潜力*，但其实际*影响*还取决于其残差的大小。本练习通过考察一个高杠杆数据点如何影响模型拟合度的常用指标——决定系数（$R^2$），来展示这一关键区别。你将量化移除一个观测点后 $R^2$ 的急剧变化，从而直观地理解一个数据点具有真正影响力的含义。[@problem_id:1930381]", "problem": "一位材料科学专业的本科生正在进行一项初步实验，研究一种新型聚合物共混物的固化时间与其产生的拉伸强度之间可能存在的线性关系。实验制备了四个具有不同固化时间的样品。记录的数据对（固化时间，单位：小时；拉伸强度，单位：吉帕斯卡 (GPa)）如下：\n(1, 2.0), (2, 2.5), (3, 1.5), and (10, 8.0)。\n\n为了拟合这些数据，提出了一个形式为 $S = \\beta_0 + \\beta_1 t + \\epsilon$ 的简单线性回归模型，其中 $S$ 是拉伸强度， $t$ 是固化时间。\n\n由于其高杠杆值，对应于最长固化时间的数据点被怀疑是一个影响点，可能人为地夸大了模型的拟合优度。为了验证这一点，请使用所有四个数据点计算模型的决定系数，记为 $R^2_{full}$。然后，移除具有最长固化时间的数据点，并基于剩余的三个点计算新模型的决定系数 $R^2_{reduced}$。\n\n您的任务是计算决定系数的绝对减少量，$\\Delta R^2 = R^2_{full} - R^2_{reduced}$。\n\n请将您的最终答案 $\\Delta R^2$ 四舍五入到三位有效数字。", "solution": "我们使用带截距项的简单线性回归来建立拉伸强度 $S$ 与固化时间 $t$ 之间的模型。对于一个带截距项的数据集 $\\{(t_{i},S_{i})\\}_{i=1}^{n}$，最小二乘斜率和截距为\n$$\n\\hat{\\beta}_{1}=\\frac{S_{tS}}{S_{tt}},\\qquad \\hat{\\beta}_{0}=\\bar{S}-\\hat{\\beta}_{1}\\bar{t},\n$$\n其中\n$$\n\\bar{t}=\\frac{1}{n}\\sum_{i=1}^{n}t_{i},\\quad \\bar{S}=\\frac{1}{n}\\sum_{i=1}^{n}S_{i},\\quad S_{tt}=\\sum_{i=1}^{n}(t_{i}-\\bar{t})^{2},\\quad S_{tS}=\\sum_{i=1}^{n}(t_{i}-\\bar{t})(S_{i}-\\bar{S}).\n$$\n当模型包含截距项时，决定系数为\n$$\nR^{2}=\\frac{\\text{SSR}}{\\text{SST}}=1-\\frac{\\text{SSE}}{\\text{SST}},\\qquad \\text{SSR}=\\frac{S_{tS}^{2}}{S_{tt}},\\qquad \\text{SST}=\\sum_{i=1}^{n}(S_{i}-\\bar{S})^{2}.\n$$\n\n完整模型（所有四个点）： $(t,S)\\in\\{(1,2.0),(2,2.5),(3,1.5),(10,8.0)\\}$。\n计算均值： $\\bar{t}=(1+2+3+10)/4=4$, $\\bar{S}=(2+2.5+1.5+8)/4=3.5$。\n计算平方和：\n$$\nS_{tt}=(1-4)^{2}+(2-4)^{2}+(3-4)^{2}+(10-4)^{2}=9+4+1+36=50,\n$$\n$$\nS_{tS}=(1-4)(2-3.5)+(2-4)(2.5-3.5)+(3-4)(1.5-3.5)+(10-4)(8-3.5)=4.5+2+2+27=\\frac{71}{2},\n$$\n$$\n\\text{SST}=(2-3.5)^{2}+(2.5-3.5)^{2}+(1.5-3.5)^{2}+(8-3.5)^{2}=2.25+1+4+20.25=\\frac{55}{2}.\n$$\n则\n$$\n\\text{SSR}=\\frac{S_{tS}^{2}}{S_{tt}}=\\frac{(71/2)^{2}}{50}=\\frac{5041}{200},\\qquad\nR^{2}_{\\text{full}}=\\frac{\\text{SSR}}{\\text{SST}}=\\frac{5041/200}{55/2}=\\frac{5041}{5500}.\n$$\n\n简化模型（移除 $t=10$ 的点）： $(t,S)\\in\\{(1,2.0),(2,2.5),(3,1.5)\\}$。\n计算均值： $\\bar{t}=(1+2+3)/3=2$, $\\bar{S}=(2+2.5+1.5)/3=2$。\n计算平方和：\n$$\nS_{tt}=(1-2)^{2}+(2-2)^{2}+(3-2)^{2}=1+0+1=2,\n$$\n$$\nS_{tS}=(1-2)(2-2)+(2-2)(2.5-2)+(3-2)(1.5-2)=0+0+(-0.5)=-\\frac{1}{2},\n$$\n$$\n\\text{SST}=(2-2)^{2}+(2.5-2)^{2}+(1.5-2)^{2}=0+0.25+0.25=\\frac{1}{2}.\n$$\n则\n$$\n\\text{SSR}=\\frac{S_{tS}^{2}}{S_{tt}}=\\frac{(1/2)^{2}}{2}=\\frac{1}{8},\\qquad\nR^{2}_{\\text{reduced}}=\\frac{\\text{SSR}}{\\text{SST}}=\\frac{(1/8)}{(1/2)}=\\frac{1}{4}.\n$$\n\n因此，$R^{2}$ 的绝对减少量为\n$$\n\\Delta R^{2}=R^{2}_{\\text{full}}-R^{2}_{\\text{reduced}}=\\frac{5041}{5500}-\\frac{1}{4}=\\frac{1833}{2750}\\approx 0.666545\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.667$。", "answer": "$$\\boxed{0.667}$$", "id": "1930381"}, {"introduction": "高杠杆对回归模型总是有害的吗？本练习通过引入“好杠杆”和“坏杠杆”的概念，挑战了这一简单化的观点。通过比较两个不同的高杠杆点对模型稳定性的影响，你将看到一个点如何能提高模型估计的精度，而另一个点却会引入显著的偏差。这个练习将帮助你建立一个更细致、更实用的视角来解读诊断图和识别有问题的数据点。[@problem_id:1930386]", "problem": "在回归分析中，其预测变量值远离所有预测变量均值的数据点被称为高杠杆点。这类点可以对估计的回归模型产生不成比例的影响。它们的影响可以是积极的，通过提高系数估计值的精确度；也可以是有害的，通过引入显著的偏差。\n\n一位研究人员正在研究一种新材料的工作温度（$T$，单位任意）与电阻（$R$，单位任意）之间的关系。提出了一个形式为 $R = \\beta_0 + \\beta_1 T + \\epsilon$ 的简单线性模型。在标准操作条件下，收集了一组初始的四次测量数据，我们称之为基础数据集 $D_0$：\n$$ D_0 = \\{ (1, 2.1), (2, 2.9), (3, 4.2), (4, 4.8) \\} $$\n\n为了探索该材料在更高温度下的特性，进行了两次额外的独立实验，每次实验产生一个高杠杆数据点：\n- 点 A：$(10, 11.1)$\n- 点 B：$(10, 5.0)$\n\n您的任务是分析这两个高杠杆点的影响。考虑两个独立的数据集：\n1.  $D_A$，由基础数据集 $D_0$ 添加点 A 构成。\n2.  $D_B$，由基础数据集 $D_0$ 添加点 B 构成。\n\n对每个数据集（$D_A$ 和 $D_B$），拟合一个简单线性回归模型。设 $se(\\hat{\\beta}_{1,A})$ 是拟合数据集 $D_A$ 的模型中估计斜率系数的标准误差，设 $se(\\hat{\\beta}_{1,B})$ 是拟合数据集 $D_B$ 的模型中的标准误差。\n\n计算比率 $R = \\frac{se(\\hat{\\beta}_{1,A})}{se(\\hat{\\beta}_{1,B})}$。将您的最终答案四舍五入到三位有效数字。", "solution": "我们用 $R=\\beta_{0}+\\beta_{1}T+\\epsilon$ 来建立 $R$ 关于 $T$ 的模型。对于带截距的简单线性回归，为数据集 $\\{(x_{i},y_{i})\\}_{i=1}^{n}$ 定义中心化和\n$$\nS_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2},\\quad S_{yy}=\\sum_{i=1}^{n}(y_{i}-\\bar{y})^{2},\\quad S_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y}),\n$$\n其中 $\\bar{x}=(\\sum x_{i})/n$ 且 $\\bar{y}=(\\sum y_{i})/n$。残差平方和为\n$$\n\\mathrm{SSE}=S_{yy}-\\frac{S_{xy}^{2}}{S_{xx}},\n$$\n斜率的标准误差为\n$$\nse(\\hat{\\beta}_{1})=\\sqrt{\\frac{\\hat{\\sigma}^{2}}{S_{xx}}}=\\sqrt{\\frac{\\mathrm{SSE}/(n-2)}{S_{xx}}}.\n$$\n因此，对于具有相同 $n$ 和 $S_{xx}$ 的两个数据集，斜率标准误差的比率可简化为\n$$\nR=\\frac{se(\\hat{\\beta}_{1,A})}{se(\\hat{\\beta}_{1,B})}=\\sqrt{\\frac{\\mathrm{SSE}_{A}}{\\mathrm{SSE}_{B}}}.\n$$\n\n计算基础数据集 $D_{0}=\\{(1,2.1),(2,2.9),(3,4.2),(4,4.8)\\}$ 的各项和：\n$$\n\\sum x=10,\\ \\sum y=14.0,\\ \\sum x^{2}=30,\\ \\sum y^{2}=53.5,\\ \\sum xy=39.7, \n$$\n$$\n\\bar{x}_{0}=2.5,\\ \\bar{y}_{0}=3.5,\\ S_{xx,0}=5,\\ S_{yy,0}=4.5,\\ S_{xy,0}=4.7.\n$$\n\n数据集 $D_{A}$ 添加了 $(10,11.1)$，所以 $n_{A}=5$ 并且\n$$\n\\sum x=20,\\ \\sum y=25.1,\\ \\sum x^{2}=130,\\ \\sum y^{2}=176.71,\\ \\sum xy=150.7,\n$$\n$$\n\\bar{x}_{A}=4,\\ \\bar{y}_{A}=5.02.\n$$\n因此，\n$$\nS_{xx,A}=130-5\\cdot 4^{2}=50,\\quad S_{yy,A}=176.71-5\\cdot(5.02)^{2}=50.708,\n$$\n$$\nS_{xy,A}=150.7-5\\cdot 4\\cdot 5.02=50.3.\n$$\n于是\n$$\n\\mathrm{SSE}_{A}=S_{yy,A}-\\frac{S_{xy,A}^{2}}{S_{xx,A}}=50.708-\\frac{(50.3)^{2}}{50}=50.708-50.6018=0.1062.\n$$\n\n数据集 $D_{B}$ 添加了 $(10,5.0)$，所以 $n_{B}=5$ 并且\n$$\n\\sum x=20,\\ \\sum y=19,\\ \\sum x^{2}=130,\\ \\sum y^{2}=78.5,\\ \\sum xy=89.7,\n$$\n$$\n\\bar{x}_{B}=4,\\ \\bar{y}_{B}=3.8.\n$$\n因此，\n$$\nS_{xx,B}=130-5\\cdot 4^{2}=50,\\quad S_{yy,B}=78.5-5\\cdot(3.8)^{2}=6.3,\n$$\n$$\nS_{xy,B}=89.7-5\\cdot 4\\cdot 3.8=13.7.\n$$\n于是\n$$\n\\mathrm{SSE}_{B}=S_{yy,B}-\\frac{S_{xy,B}^{2}}{S_{xx,B}}=6.3-\\frac{(13.7)^{2}}{50}=6.3-3.7538=2.5462.\n$$\n\n在 $S_{xx,A}=S_{xx,B}$ 且 $n_{A}=n_{B}$ 的情况下，标准误差的比率为\n$$\nR=\\sqrt{\\frac{\\mathrm{SSE}_{A}}{\\mathrm{SSE}_{B}}}=\\sqrt{\\frac{0.1062}{2.5462}}\\approx 0.204228\\ldots\n$$\n四舍五入到三位有效数字，得到 $R=0.204$。", "answer": "$$\\boxed{0.204}$$", "id": "1930386"}]}