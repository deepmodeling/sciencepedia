{"hands_on_practices": [{"introduction": "模型诊断的核心是超越诸如$R^2$之类的单一汇总统计量。一个模型可能在数学上解释了大部分方差，但如果它误解了变量间的真实关系，其预测和推断将是不可靠的。此练习 [@problem_id:1936332] 旨在强调使用残差图来直观地检验线性假设的重要性，并揭示一个明显的模式如何表明，即使在高$R^2$值的情况下，模型也可能存在根本性缺陷。", "problem": "一位材料科学家正在研究一种新型电池的工作温度与其有效寿命之间的关系。他们收集了50个电池的数据，记录了恒定的工作温度（$x$，单位为摄氏度）和寿命（$y$，单位为千小时）。\n\n该科学家进行了一项简单线性回归分析，并获得了以下拟合回归线：\n$$ \\hat{y} = 45.2 - 0.3x $$\n该模型的决定系数经计算为$R^2 = 0.85$。\n\n在检查诊断图时，该科学家观察到残差与拟合值（$\\hat{y}$）的散点图。该残差图上的点并未在零水平线周围随机散布。相反，它们形成了一个清晰、明确的U形（抛物线形）模式，对于中等拟合值，残差为负；对于低拟合值和高拟合值，残差为正。\n\n根据这些信息，以下哪个结论最为准确？\n\nA. 高达0.85的$R^2$值表明线性模型对数据拟合得非常好，而残差中的模式可以忽略，因为它很可能是由少数异常值引起的。\n\nB. 残差图中的清晰模式表明模型存在根本性问题，因此高$R^2$值必定是计算错误的结果。\n\nC. 该模型解释了寿命中很大一部分的方差，但残差中的U形模式表明温度和寿命之间的潜在关系是非线性的，这使得简单线性模型不适用。\n\nD. 残差图中的U形模式是多重共线性的典型标志，这意味着预测变量与其他未观测到的变量相关。\n\nE. 残差图中的U形模式表明误差的方差不是恒定的（即存在异方差性），并且数据应该使用对数进行转换。", "solution": "在简单线性回归中，假定的模型是 $y=\\beta_{0}+\\beta_{1}x+\\varepsilon$，其标准假设为 $E[\\varepsilon \\mid x]=0$ 和 $\\operatorname{Var}(\\varepsilon \\mid x)=\\sigma^{2}$，并且条件均值 $E[y \\mid x]$ 与 $x$ 呈线性关系。拟合值为 $\\hat{y}_{i}=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x_{i}$，残差为 $e_{i}=y_{i}-\\hat{y}_{i}$。如果模型设定正确，那么 $e_{i}$ 对 $\\hat{y}_{i}$ 的散点图应该不显示任何系统性模式；具体来说，我们期望在所有拟合值的范围内都有 $E[e \\mid \\hat{y}]=0$。\n\n残差对拟合值的散点图中出现清晰的U形（抛物线形）模式，表明 $E[e \\mid \\hat{y}]$ 并非一致为零，而是随着 $\\hat{y}$ 系统性地变化，这是均值结构设定不当的诊断信号，通常意味着 $y$ 和 $x$ 之间存在非线性关系。一个常见的原因是真实关系包含曲率，例如 $E[y \\mid x]=\\beta_{0}+\\beta_{1}x+\\beta_{2}x^{2}$ 且 $\\beta_{2}\\neq 0$。如果只拟合线性项，被忽略的曲率就会在残差中表现为U形模式。\n\n决定系数 $R^{2}$ 衡量的是被拟合线性函数解释的方差比例，即使函数形式不正确，它也可能很大；因此，高的 $R^{2}$ 值并不能验证线性假设或模型的适切性。因此，陈述A是错误的。\n\n没有理由根据残差中存在曲率就推断 $R^{2}$ 的计算有误；高 $R^{2}$ 值和设定不当的均值函数可以同时存在。因此，陈述B是错误的。\n\n多重共线性涉及多个预测变量之间的相关性，在只有一个预测变量的简单线性回归中不适用。U形的残差模式不是多重共线性的标志。因此，陈述D是错误的。\n\n异方差性指的是 $\\operatorname{Var}(\\varepsilon \\mid x)$ 随 $x$ 的变化而变化，并且在残差图中通常表现为漏斗形或扇形的散布，而不是形成U形的系统性符号变化。虽然转换有时可以同时解决非线性和异方差性问题，但这里主要的诊断发现是均值的非线性，而不是方差非恒定。因此，陈述E不是最准确的解释。\n\n因此，正确的结论是，该模型解释了很大一部分方差，但违反了线性假设；一个非线性模型（例如，包含 $x^{2}$ 项或进行其他适当的转换）更为合适。", "answer": "$$\\boxed{C}$$", "id": "1936332"}, {"introduction": "除了检验函数形式的正确性，验证模型误差项的独立性也同样关键，尤其是在处理时间序列数据时。残差中的自相关（或称序列相关）会严重影响我们对模型系数的推断。此练习 [@problem_id:1936355] 将引导您使用德宾-沃森（Durbin-Watson）统计量，这是一个用于检测一阶自相关的标准化工具，并解释其值如何揭示模型残差中隐藏的依赖结构。", "problem": "一位运营分析师的任务是为一家公司的月度小部件生产量建模。他们提出了一个简单线性回归模型，基于上一个月的原材料库存 $I_{t-1}$ 来预测当前月份的生产量 $P_t$。该模型的形式为 $P_t = \\beta_0 + \\beta_1 I_{t-1} + \\epsilon_t$，其中 $t$ 是月份的索引，$\\epsilon_t$ 代表误差项。在将模型拟合到连续60个月的数据后，该分析师检查了残差 $e_t$ 的性质，以评估模型的有效性。他们针对残差序列计算了 Durbin-Watson 统计量，并得到一个值为 $3.96$。\n\n根据这个结果，以下哪个是关于模型误差项的最可能结论？\n\nA. 误差项表现出强的一阶正自相关性。\n\nB. 误差项不存在自相关性。\n\nC. 模型存在严重的预测变量间多重共线性问题。\n\nD. 误差项表现出强的一阶负自相关性。\n\nE. 误差项的方差不恒定（异方差性）。", "solution": "我们从给定的月度生产量线性回归模型开始：\n$$\nP_{t}=\\beta_{0}+\\beta_{1} I_{t-1}+\\epsilon_{t},\n$$\n其中 $t$ 以月份为单位索引时间，$\\epsilon_{t}$ 是误差项。令 $e_{t}$ 表示对 $n=60$ 个月的数据拟合模型后得到的普通最小二乘法（OLS）残差。\n\n为了评估残差中的一阶自相关性，Durbin-Watson 统计量的计算公式为\n$$\nd=\\frac{\\sum_{t=2}^{n}\\left(e_{t}-e_{t-1}\\right)^{2}}{\\sum_{t=1}^{n} e_{t}^{2}}.\n$$\n它的取值范围是 $0 \\leq d \\leq 4$，其解释如下：\n- $d \\approx 2$ 表明不存在一阶自相关性。\n- $d  2$ 表明存在一阶正自相关性，当 $d$ 接近 $0$ 时表示强正自相关。\n- $d > 2$ 表明存在一阶负自相关性，当 $d$ 接近 $4$ 时表示强负自相关。\n\n$d$ 与残差的一阶自相关系数 $\\rho_{1}$ 之间也存在一个近似关系：\n$$\nd \\approx 2\\left(1-\\rho_{1}\\right).\n$$\n解出 $\\rho_{1}$ 可得\n$$\n\\rho_{1} \\approx 1-\\frac{d}{2}.\n$$\n根据报告的数值 $d=3.96$ 可得，\n$$\n\\rho_{1} \\approx 1-\\frac{3.96}{2}=1-1.98=-0.98,\n$$\n这表明存在非常强的一阶负自相关性。\n\n因此，最可能的结论是误差项表现出强的一阶负自相关性。\n\n为了排除其他选项：\n- 强正自相关对应的 $d$ 值应接近 $0$，而不是 $3.96$，因此 A 不符。\n- 无自相关对应的 $d$ 值应接近 $2$，而不是 $3.96$，因此 B 不符。\n- Durbin-Watson 统计量不是用来检验预测变量之间的多重共线性的，因此 C 在这里不相关。\n- Durbin-Watson 统计量检测的不是异方差性，它针对的是序列相关，因此 E 不相关。\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "1936355"}, {"introduction": "模型诊断不仅关注整体模式，还需识别对回归结果有不成比例影响的单个数据点。这些“影响点”可能会扭曲我们对变量关系的理解。此练习 [@problem_id:1936315] 通过一个具体的计算任务，向您介绍库克距离（Cook's Distance）这一关键指标，它结合了数据点的残差大小和杠杆率来量化其对模型的整体影响。", "problem": "一位材料科学家正在研究一种新的化学气相沉积工艺，用于制造超薄半导体薄膜。薄膜的厚度 $Y$（单位：纳米，nm）被假设与沉积持续时间 $X$（单位：秒，s）呈线性关系。一个形式为 $Y_i = \\beta_0 + \\beta_1 X_i + \\epsilon_i$ 的简单线性回归模型被拟合到来自 $n=30$ 次实验运行的数据。该模型有 $p=2$ 个估计参数（截距 $\\beta_0$ 和斜率 $\\beta_1$）。\n\n对所有30个数据点进行回归分析，得到以下汇总统计量：\n- 平均沉积持续时间为 $\\bar{x} = 55.0$ s。\n- 沉积持续时间的离差平方和为 $\\sum_{j=1}^{30} (x_j - \\bar{x})^2 = 25000$ s$^2$。\n- 模型的均方误差 (MSE) 为 $\\hat{\\sigma}^2 = 40.0$ nm$^2$。\n\n这位科学家特别关注某一次特定的实验运行，即第 $k$ 个观测值，该次实验是在异常条件下进行的。对于这个数据点：\n- 沉积持续时间为 $x_k = 155.0$ s。\n- 原始残差（观测厚度与预测厚度之差）为 $e_k = y_k - \\hat{y}_k = 5.0$ nm。\n\n为了评估这单个观测值对整体回归模型的影响，要求计算其 Cook 距离 $D_k$。必要的公式如下：\n- 第 $i$ 个观测值的杠杆值 $h_{ii}$ 由 $h_{ii} = \\frac{1}{n} + \\frac{(x_i - \\bar{x})^2}{\\sum_{j=1}^n (x_j - \\bar{x})^2}$ 给出。\n- 第 $i$ 个观测值的内学生化残差 $r_i$ 由 $r_i = \\frac{e_i}{\\hat{\\sigma}\\sqrt{1-h_{ii}}}$ 给出。\n- 第 $i$ 个观测值的 Cook 距离 $D_i$ 与这些量相关，其关系为 $D_i = \\frac{r_i^2}{p} \\frac{h_{ii}}{1-h_{ii}}$。\n\n计算这次特定实验运行的 Cook 距离 $D_k$ 的值。将你的最终答案四舍五入到三位有效数字。", "solution": "我们给定一个简单线性回归问题，其中有 $n=30$ 个观测值和 $p=2$ 个参数。对于第 $k$ 个观测值，我们使用所提供的公式计算其杠杆值、内学生化残差，然后计算 Cook 距离。\n\n首先，计算杠杆值 $h_{kk}$：\n$$\nh_{kk} = \\frac{1}{n} + \\frac{(x_{k} - \\bar{x})^{2}}{\\sum_{j=1}^{n} (x_{j} - \\bar{x})^{2}} = \\frac{1}{30} + \\frac{(155.0 - 55.0)^{2}}{25000} = \\frac{1}{30} + \\frac{10000}{25000} = \\frac{1}{30} + \\frac{2}{5} = \\frac{13}{30}.\n$$\n\n接下来，均方误差为 $\\hat{\\sigma}^2 = 40.0$，所以 $\\hat{\\sigma} = \\sqrt{40}$。内学生化残差为\n$$\nr_{k} = \\frac{e_{k}}{\\hat{\\sigma}\\sqrt{1 - h_{kk}}} = \\frac{5.0}{\\sqrt{40}\\sqrt{1 - \\frac{13}{30}}} = \\frac{5.0}{\\sqrt{40}\\sqrt{\\frac{17}{30}}}.\n$$\n计算 $r_{k}^{2}$ 会很方便：\n$$\nr_{k}^{2} = \\frac{e_{k}^{2}}{\\hat{\\sigma}^{2}(1 - h_{kk})} = \\frac{25}{40 \\cdot \\frac{17}{30}} = \\frac{25 \\cdot 30}{40 \\cdot 17} = \\frac{75}{68}.\n$$\n\n现在计算因子 $\\frac{h_{kk}}{1 - h_{kk}}$：\n$$\n\\frac{h_{kk}}{1 - h_{kk}} = \\frac{\\frac{13}{30}}{\\frac{17}{30}} = \\frac{13}{17}.\n$$\n\n此观测值的 Cook 距离为\n$$\nD_{k} = \\frac{r_{k}^{2}}{p}\\cdot \\frac{h_{kk}}{1 - h_{kk}} = \\frac{\\frac{75}{68}}{2} \\cdot \\frac{13}{17} = \\frac{75}{136} \\cdot \\frac{13}{17} = \\frac{975}{2312}.\n$$\n数值上，$\\frac{975}{2312} \\approx 0.4217\\ldots$，四舍五入到三位有效数字为 $0.422$。", "answer": "$$\\boxed{0.422}$$", "id": "1936315"}]}