{"hands_on_practices": [{"introduction": "在进行方差齐性检验（如 Bartlett 检验）或方差分析 (ANOVA) 之前，一个关键的预备步骤是估计一个共同的总体方差。这个估计值被称为“合并方差”($S_p^2$)，它是各组样本方差的加权平均值，权重由各组的自由度决定。这个练习将带你实践计算合并方差，这是掌握 Bartlett 检验及更广泛统计推断的基础。[@problem_id:1898010]", "problem": "一个材料科学研究团队正在研究一种新型有机发光二极管（OLED）的工作寿命。他们制造了四种不同的发光材料配方，标记为A、B、C和D。为了评估这些配方之间性能的一致性，他们测量了每组中几个器件的寿命。每个器件的寿命以千小时为单位记录。实验得出了这四组的以下摘要统计数据：\n\n-   **A组**：样本容量 $n_A = 10$，样本方差 $S_A^2 = 2.50$ (千小时)$^2$\n-   **B组**：样本容量 $n_B = 12$，样本方差 $S_B^2 = 3.10$ (千小时)$^2$\n-   **C组**：样本容量 $n_C = 11$，样本方差 $S_C^2 = 2.80$ (千小时)$^2$\n-   **D组**：样本容量 $n_D = 15$，样本方差 $S_D^2 = 3.50$ (千小时)$^2$\n\n作为比较各组的更广泛统计分析的初步步骤，有必要计算一个综合或“合并”所有四个样本信息的总体方差估计值。计算这些实验组的合并样本方差。\n\n你的答案以(千小时)$^2$为单位，并四舍五入到三位有效数字。", "solution": "为了在共同总体方差的假设下合并来自多个独立组的样本方差，合并样本方差被计算为各组样本方差的自由度加权平均值。其公式为\n$$\nS_{p}^{2}=\\frac{\\sum_{i=1}^{k}(n_{i}-1)S_{i}^{2}}{\\sum_{i=1}^{k}(n_{i}-1)},\n$$\n其中 $k$ 是组数，$n_{i}$ 是第 $i$ 组的样本容量，$S_{i}^{2}$ 是第 $i$ 组的样本方差。\n\n对于A、B、C、D四组：\n- 自由度：$(n_{A}-1)=9$，$(n_{B}-1)=11$，$(n_{C}-1)=10$，$(n_{D}-1)=14$。\n- 加权和：\n$$\n9\\cdot S_{A}^{2}=9\\cdot 2.50=22.5,\\quad\n11\\cdot S_{B}^{2}=11\\cdot 3.10=34.1,\n$$\n$$\n10\\cdot S_{C}^{2}=10\\cdot 2.80=28.0,\\quad\n14\\cdot S_{D}^{2}=14\\cdot 3.50=49.0.\n$$\n将分子和分母相加：\n$$\n\\sum_{i=1}^{4}(n_{i}-1)S_{i}^{2}=22.5+34.1+28.0+49.0=133.6,\n$$\n$$\n\\sum_{i=1}^{4}(n_{i}-1)=9+11+10+14=44.\n$$\n因此，\n$$\nS_{p}^{2}=\\frac{133.6}{44}=3.0363636\\ldots\n$$\n四舍五入到三位有效数字，合并样本方差为 $3.04$ (千小时)$^{2}$。", "answer": "$$\\boxed{3.04}$$", "id": "1898010"}, {"introduction": "掌握了合并方差的计算后，我们现在可以将所有部分组合起来，执行一个完整的 Bartlett 检验。这个练习提供了一个农业科学中的实际场景，你将需要从原始的摘要统计数据出发，一步步计算出 Bartlett 检验统计量 $T$ 的值。通过这个过程，你不仅能熟悉完整的检验流程，还能深入理解样本量的不均衡如何对检验结果产生显著影响。[@problem_id:1898016]", "problem": "一位农业科学家正在研究三种新肥料处理下作物产量的稳定性。为此，她收集了每种处理下多个地块的产量数据（单位：公斤/公顷）。目标是确定这三种处理的产量变异性是否相同。\n\n实验的汇总统计数据如下：\n- **处理1：** 样本量 $n_1 = 11$ 个地块，样本方差 $S_1^2 = 15.0\\ (\\text{公斤/公顷})^2$。\n- **处理2：** 样本量 $n_2 = 101$ 个地块，样本方差 $S_2^2 = 25.0\\ (\\text{公斤/公顷})^2$。\n- **处理3：** 样本量 $n_3 = 11$ 个地块，样本方差 $S_3^2 = 40.0\\ (\\text{公斤/公顷})^2$。\n\n这位科学家决定使用 Bartlett 检验来检验方差齐性。检验统计量 $T$ 的计算公式为：\n$$T = \\frac{(N-k) \\ln(S_p^2) - \\sum_{i=1}^{k} (n_i-1) \\ln(S_i^2)}{1 + \\frac{1}{3(k-1)} \\left( \\sum_{i=1}^{k} \\frac{1}{n_i-1} - \\frac{1}{N-k} \\right)}$$\n其中 $k$ 是组数，$n_i$ 是第 $i$ 组的样本量，$N = \\sum n_i$，$S_i^2$ 是第 $i$ 组的样本方差，$S_p^2 = \\frac{1}{N-k}\\sum_{i=1}^{k}(n_i-1)S_i^2$ 是合并方差。在方差相等的原假设下，$T$ 服从自由度为 $k-1$ 的卡方分布。\n\n在 $\\alpha = 0.05$ 的显著性水平下进行 Bartlett 检验。在此显著性水平下，相关卡方分布的临界值为 5.991。根据您的计算，选择正确陈述检验统计量 $T$ 的近似值和检验结论的选项。\n\nA. 检验统计量约为 $T \\approx 2.31$，我们未能拒绝原假设。没有充分的证据得出方差不相等的结论。\n\nB. 检验统计量约为 $T \\approx 2.31$，我们拒绝原假设。有充分的证据得出方差不相等的结论。\n\nC. 检验统计量约为 $T \\approx 7.54$，我们拒绝原假设。有充分的证据得出方差不相等的结论。\n\nD. 检验统计量约为 $T \\approx 7.54$，我们未能拒绝原假设。没有充分的证据得出方差不相等的结论。\n\nE. 检验无法进行，因为 Bartlett 检验要求所有组的样本量相等。", "solution": "我们使用 Bartlett 检验来检验 $k=3$ 个组的方差齐性。已知 $n_{1}=11$, $S_{1}^{2}=15.0$, $n_{2}=101$, $S_{2}^{2}=25.0$, $n_{3}=11$, $S_{3}^{2}=40.0$，首先计算总和与合并方差。总样本量为 $N=\\sum_{i=1}^{3} n_{i}=11+101+11=123$，因此 $N-k=123-3=120$。合并方差为\n$$\nS_{p}^{2}=\\frac{1}{N-k}\\sum_{i=1}^{3}(n_{i}-1)S_{i}^{2}\n=\\frac{1}{120}\\left(10\\cdot 15.0+100\\cdot 25.0+10\\cdot 40.0\\right)\n=\\frac{3050}{120}=\\frac{305}{12}\\approx 25.4166667.\n$$\nBartlett 检验统计量为\n$$\nT=\\frac{(N-k)\\ln(S_{p}^{2})-\\sum_{i=1}^{3}(n_{i}-1)\\ln(S_{i}^{2})}{1+\\frac{1}{3(k-1)}\\left(\\sum_{i=1}^{3}\\frac{1}{n_{i}-1}-\\frac{1}{N-k}\\right)}.\n$$\n计算分子：\n$$\n(N-k)\\ln(S_{p}^{2})=120\\ln\\!\\left(\\frac{305}{12}\\right)\\approx 120\\cdot 3.235405126=388.248615,\n$$\n$$\n\\sum_{i=1}^{3}(n_{i}-1)\\ln(S_{i}^{2})=10\\ln(15.0)+100\\ln(25.0)+10\\ln(40.0)\n$$\n其中\n$$\n\\ln(15.0)\\approx 2.708050200,\\quad \\ln(25.0)\\approx 3.218875824,\\quad \\ln(40.0)\\approx 3.688879454,\n$$\n所以\n$$\n\\sum_{i=1}^{3}(n_{i}-1)\\ln(S_{i}^{2})\\approx 10\\cdot 2.708050200+100\\cdot 3.218875824+10\\cdot 3.688879454=385.856879.\n$$\n因此分子是\n$$\n388.248615-385.856879=2.391736.\n$$\n计算分母中的修正项：\n$$\n\\sum_{i=1}^{3}\\frac{1}{n_{i}-1}=\\frac{1}{10}+\\frac{1}{100}+\\frac{1}{10}=0.21,\\quad \\frac{1}{N-k}=\\frac{1}{120}\\approx 0.008333333,\n$$\n$$\n1+\\frac{1}{3(k-1)}\\left(\\sum_{i=1}^{3}\\frac{1}{n_{i}-1}-\\frac{1}{N-k}\\right)=1+\\frac{1}{3\\cdot 2}\\left(0.21-0.008333333\\right)=1+ \\frac{1}{6}\\cdot 0.201666667\\approx 1.033611.\n$$\n因此，\n$$\nT\\approx \\frac{2.391736}{1.033611}\\approx 2.314.\n$$\n在方差相等的原假设下，将 $T$ 与自由度为 $k-1=2$ 的卡方分布进行比较。在显著性水平 $\\alpha=0.05$ 下，临界值为 $5.991$。由于 $T\\approx 2.31<5.991$，我们未能拒绝原假设。没有充分的证据得出方差不相等的结论。Bartlett 检验不要求相等的样本量，因此在这里适用。\n\n与 $T\\approx 2.31$ 且未能拒绝原假设相匹配的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1898016"}, {"introduction": "真正理解一个假设检验，不仅意味着能从数据正向计算出检验统计量，也意味着能够反向思考，从检验结果（如 p 值）推断出统计量的可能大小。这个练习将挑战你进行一次“统计侦探”工作：在已知检验的 p 值和实验设计的情况下，反向推算出 Bartlett 检验统计量 $B$ 的值。这个过程将加深你对检验统计量、其理论分布（$\\chi^2$ 分布）以及 p 值之间内在联系的理解。[@problem_id:1898021]", "problem": "一位数据科学家正在分析来自四个不同处理组的实验结果，以评估各组内测量值的方差是否相等。该科学家决定使用Bartlett检验来检验方差齐性。四个组中的每一个都包含恰好16个独立观测值。在对样本数据进行计算后，该检验得出的p值恰好为0.01。根据这些信息，确定计算出的Bartlett检验统计量的数值。\n\n将您的最终答案四舍五入至四位有效数字。", "solution": "设 $k$ 表示组的数量，$n_{i}$ 表示第 $i$ 组的样本量。对于Bartlett检验，在方差相等的零假设下并假定正态性，Bartlett检验统计量 $B$ 近似服从自由度为 $k-1$ 的卡方分布：\n$$\nB \\sim \\chi^{2}_{k-1}.\n$$\n此处，$k=4$，因此自由度为\n$$\nk-1=3.\n$$\n报告的p值是此卡方分布的上尾概率：\n$$\np=\\Pr\\!\\left(\\chi^{2}_{3} \\geq B\\right).\n$$\n给定 $p=0.01$，我们通过对卡方累积分布函数求逆来求解 $B$：\n$$\n\\Pr\\!\\left(\\chi^{2}_{3} \\leq B\\right)=1-p=0.99 \\quad \\Rightarrow \\quad B=F^{-1}_{\\chi^{2}_{3}}(0.99).\n$$\n根据自由度为 $3$ 时 $0.99$ 处的卡方分位数，\n$$\nB=F^{-1}_{\\chi^{2}_{3}}(0.99)\\approx 11.344866\\ldots\n$$\n四舍五入到四位有效数字得到 $11.34$。", "answer": "$$\\boxed{11.34}$$", "id": "1898021"}]}