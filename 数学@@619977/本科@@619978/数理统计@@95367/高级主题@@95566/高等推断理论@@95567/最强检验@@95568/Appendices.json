{"hands_on_practices": [{"introduction": "Neyman-Pearson引理为我们构建在给定显著性水平下最具统计效力的检验提供了理论基石。这个过程的核心在于比较不同观测结果下的似然比。本练习 [@problem_id:1937968] 将通过一个仅有三种可能输出的量子传感器的简单离散模型，引导你一步步构建拒绝域，从而直观地理解最强检验的构造逻辑。", "id": "1937968", "problem": "一个研究团队正在开发一种新型量子传感器，用于探测单个奇异粒子。基于单次测量，该传感器输出一个离散信号水平 $X$，其值可以取自集合 $\\{1, 2, 3\\}$。该传感器输出的统计行为取决于该粒子是否存在。\n\n原假设 $H_0$ 对应于粒子不存在的情况。在 $H_0$ 下，信号 $X$ 的概率质量函数由下式给出：\n$P(X=1|H_0) = 0.5$\n$P(X=2|H_0) = 0.4$\n$P(X=3|H_0) = 0.1$\n\n备择假设 $H_1$ 对应于粒子存在的情况。在 $H_1$ 下，信号 $X$ 的概率质量函数为：\n$P(X=1|H_1) = 0.1$\n$P(X=2|H_1) = 0.4$\n$P(X=3|H_1) = 0.5$\n\n该团队希望基于单次传感器读数构建一个决策规则（即一个统计检验）。“拒绝”原假设对应于得出粒子存在的结论。对于固定的检验水平（I类错误概率）$\\alpha = 0.1$，该检验必须是功效最强的检验。\n\n对于这个功效最强的检验，下列哪个集合代表其拒绝域？拒绝域是指在该区域内的观测值 $X$ 会导致原假设 $H_0$ 被拒绝的集合。\n\nA. $\\{1\\}$\nB. $\\{3\\}$\nC. $\\{1, 2\\}$\nD. $\\{2, 3\\}$\nE. $\\{1, 3\\}$\nF. $\\{2\\}$", "solution": "我们寻求基于单个观测值 $X \\in \\{1,2,3\\}$，用于检验 $H_{0}$ 对 $H_{1}$ 且检验水平为 $\\alpha=0.1$ 的功效最强的检验。根据 Neyman–Pearson 引理，在水平 $\\alpha$ 下，功效最强的检验在似然比 $\\Lambda(x)=\\frac{P(X=x \\mid H_{1})}{P(X=x \\mid H_{0})}$ 较大时拒绝 $H_{0}$，其阈值的选择需要满足检验水平的约束。\n\n计算似然比：\n$$\n\\Lambda(1)=\\frac{0.1}{0.5}=0.2,\\quad \\Lambda(2)=\\frac{0.4}{0.4}=1,\\quad \\Lambda(3)=\\frac{0.5}{0.1}=5.\n$$\n将它们按 $\\Lambda$ 值降序排列：$x=3$（最大），然后是 $x=2$，最后是 $x=1$。\n\n为了达到 $\\alpha=0.1$ 的检验水平，我们将具有最大似然比的结果逐个纳入拒绝域，直到拒绝域在 $H_0$ 下的总概率达到 $\\alpha$。如有必要，可在边界处使用随机化。在 $H_0$ 下，\n$$\nP_{0}(X=3)=0.1,\\quad P_{0}(X=2)=0.4,\\quad P_{0}(X=1)=0.5.\n$$\n单独取似然比最大的结果 $x=3$ 时，我们得到\n$$\nP_{0}(\\{3\\})=0.1=\\alpha,\n$$\n因此不需要随机化。包含任何其他结果都将超过检验水平的约束。因此，水平为 $\\alpha$ 的功效最强的检验当且仅当 $X=3$ 时拒绝 $H_0$。\n\n这对应的拒绝域为 $\\{3\\}$，与选项 B 相符。", "answer": "$$\\boxed{B}$$"}, {"introduction": "掌握了如何构建最强检验后，下一步是评估其性能。一个检验的“检验力”（Power）——即它正确拒绝原假设的能力——是衡量其有效性的关键指标。本练习 [@problem_id:1937923] 将场景从离散分布转移到更常见的正态分布，探讨在信号检测问题中，如何推导出一个最强检验的检验力表达式，并分析其跟样本量 $n$ 和显著性水平 $\\alpha$ 的关系。", "id": "1937923", "problem": "一个信号处理系统被设计用于从背景噪声中区分目标信号。当只有噪声存在时，测量值 $X$ 可以很好地用均值为0、方差为1的正态分布来建模，即 $N(0, 1)$。当目标信号存在时，该测量值可用均值为1、方差为1的正态分布来建模，即 $N(1, 1)$。\n\n为了做出决策，我们收集了一个包含 $n$ 个独立测量值的随机样本 $X_1, X_2, \\ldots, X_n$。我们构建了一个假设检验，其原假设为 $H_0: \\mu=0$（信号不存在），备择假设为 $H_1: \\mu=1$（信号存在）。\n\nNeyman-Pearson 引理保证了在显著性水平 $\\alpha$ 下，最优（MP）检验会在样本均值 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 大于某个临界值 $c$ 时拒绝原假设 $H_0$。\n\n您的任务是求出该最优检验的功效。请用一个解析表达式来表示您的答案，该表达式应包含样本量 $n$、显著性水平 $\\alpha$ 以及标准正态分布的累积分布函数 (CDF)，记为 $\\Phi(\\cdot)$。累积分布函数的反函数（或称分位数函数）可表示为 $\\Phi^{-1}(\\cdot)$。", "solution": "在原假设 $H_{0}:\\mu=0$ 下，每个 $X_{i}\\sim N(0,1)$ 且相互独立，因此样本均值 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$ 服从\n$$\n\\bar{X}\\mid H_{0}\\sim N\\!\\left(0,\\frac{1}{n}\\right).\n$$\n显著性水平为 $\\alpha$ 的最优检验在 $\\bar{X}>c$ 时拒绝 $H_{0}$，其中 $c$ 的选择须满足检验水平的约束条件\n$$\n\\Pr_{H_{0}}(\\bar{X}>c)=\\alpha.\n$$\n在 $H_{0}$ 下进行标准化可得\n$$\n\\Pr\\!\\left(Z>c\\sqrt{n}\\right)=\\alpha,\\quad Z\\sim N(0,1),\n$$\n所以\n$$\nc\\sqrt{n}=\\Phi^{-1}(1-\\alpha)\\quad\\Rightarrow\\quad c=\\frac{1}{\\sqrt{n}}\\Phi^{-1}(1-\\alpha).\n$$\n\n在备择假设 $H_{1}:\\mu=1$ 下，我们有\n$$\n\\bar{X}\\mid H_{1}\\sim N\\!\\left(1,\\frac{1}{n}\\right).\n$$\n因此，该检验的功效是\n$$\n\\Pr_{H_{1}}(\\bar{X}>c)=\\Pr\\!\\left(Z>(c-1)\\sqrt{n}\\right)=1-\\Phi\\!\\left((c-1)\\sqrt{n}\\right),\n$$\n其中 $Z\\sim N(0,1)$。代入 $c=\\frac{1}{\\sqrt{n}}\\Phi^{-1}(1-\\alpha)$ 可得\n$$\n(c-1)\\sqrt{n}=\\Phi^{-1}(1-\\alpha)-\\sqrt{n},\n$$\n因此功效等于\n$$\n1-\\Phi\\!\\left(\\Phi^{-1}(1-\\alpha)-\\sqrt{n}\\right)=\\Phi\\!\\left(\\sqrt{n}-\\Phi^{-1}(1-\\alpha)\\right).\n$$\n此表达式将功效表示为 $n$、$\\alpha$ 和 $\\Phi$ 的函数，其中 $\\Phi^{-1}$ 通过临界值出现。", "answer": "$$\\boxed{\\Phi\\!\\left(\\sqrt{n}-\\Phi^{-1}(1-\\alpha)\\right)}$$"}, {"introduction": "理论分析最终要服务于实践设计。在科学实验或工程应用中，我们不仅要控制犯第一类错误的概率 $\\alpha$，还希望检验有足够高的检验力（$1-\\beta$）来发现我们关心的效应。本练习 [@problem_id:1937987] 将前两个练习中的概念融会贯通，解决一个核心的设计问题：为了达到预设的显著性水平和检验力，我们至少需要多大的样本量 $n$？", "id": "1937987", "problem": "一个灵敏的科学仪器被设计用于产生一个服从正态分布的输出信号，其均值为 $\\mu$，已知方差为 $\\sigma^2 = 1$。在完美校准的情况下，信号均值为 $\\mu_0 = 0$。某个特定的故障会导致信号均值漂移到一个新值 $\\mu_1 = 0.5$。需要基于从该仪器中抽取的 $n$ 个独立测量的随机样本来设计一个诊断检验。\n\n该检验必须满足以下两项严格的性能标准：\n1. 在仪器实际上完美校准的情况下，错误地断定其发生故障的概率不得超过 $0.05$。\n2. 在故障确实发生的情况下，正确识别出该故障的概率必须至少为 $0.90$。\n\n确定为使该诊断检验能同时满足这两项标准，所需的最小整数样本容量 $n$。", "solution": "设 $X_{1},\\dots,X_{n}$ 独立，且 $X_{i} \\sim \\mathcal{N}(\\mu,1)$。我们检验 $H_{0}:\\mu=0$ 与单侧备择假设 $H_{1}:\\mu=0.5$。对于已知方差和均值更大的备择假设，一致最优势水平-$\\alpha$ 检验在 $\\bar{X}$ 较大时拒绝原假设。\n\n在 $H_{0}$ 之下，$\\bar{X} \\sim \\mathcal{N}(0,1/n)$。选择一个临界值 $c$ 使得显著性水平为 $0.05$：\n$$\n\\mathbb{P}_{\\mu=0}(\\bar{X} \\ge c)=0.05\n\\;\\Longleftrightarrow\\;\n\\mathbb{P}\\!\\left(Z \\ge c\\sqrt{n}\\right)=0.05\n\\;\\Longleftrightarrow\\;\nc\\sqrt{n}=z_{0.95},\n$$\n所以\n$$\nc=\\frac{z_{0.95}}{\\sqrt{n}},\n$$\n其中 $z_{p}=\\Phi^{-1}(p)$，$\\Phi$ 是标准正态累积分布函数。\n\n在 $\\mu=0.5$ 之下，检验功效为\n$$\n\\mathbb{P}_{\\mu=0.5}(\\bar{X} \\ge c)\n=\\mathbb{P}\\!\\left(\\frac{\\bar{X}-0.5}{1/\\sqrt{n}} \\ge (c-0.5)\\sqrt{n}\\right)\n=1-\\Phi\\!\\left((c-0.5)\\sqrt{n}\\right).\n$$\n将 $c=z_{0.95}/\\sqrt{n}$ 代入可得\n$$\n\\text{power}=1-\\Phi\\!\\left(z_{0.95}-0.5\\sqrt{n}\\right).\n$$\n要求该值至少为 $0.90$ 可得\n$$\n1-\\Phi\\!\\left(z_{0.95}-0.5\\sqrt{n}\\right) \\ge 0.90\n\\;\\Longleftrightarrow\\;\n\\Phi\\!\\left(z_{0.95}-0.5\\sqrt{n}\\right) \\le 0.10\n\\;\\Longleftrightarrow\\;\nz_{0.95}-0.5\\sqrt{n} \\le z_{0.10}.\n$$\n利用对称性 $z_{0.10}=-z_{0.90}$，上式变为\n$$\n0.5\\sqrt{n} \\ge z_{0.95}-z_{0.10}=z_{0.95}+z_{0.90}\n\\;\\Longleftrightarrow\\;\n\\sqrt{n} \\ge 2\\bigl(z_{0.95}+z_{0.90}\\bigr)\n\\;\\Longleftrightarrow\\;\nn \\ge \\left[2\\bigl(z_{0.95}+z_{0.90}\\bigr)\\right]^{2}.\n$$\n使用 $z_{0.95}\\approx 1.644853626$ 和 $z_{0.90}\\approx 1.281551566$，\n$$\n2\\bigl(z_{0.95}+z_{0.90}\\bigr) \\approx 5.852810384,\n\\quad\nn \\ge 34.256\\ldots\n$$\n因此，满足这两个条件的最小整数 $n$ 是 $35$。直接检验可得功效为 $=\\Phi\\!\\left(0.5\\sqrt{35}-z_{0.95}\\right)\\approx \\Phi(1.313)\\approx 0.905 \\ge 0.90$，而当 $n=34$ 时，功效低于 $0.90$。", "answer": "$$\\boxed{35}$$"}]}