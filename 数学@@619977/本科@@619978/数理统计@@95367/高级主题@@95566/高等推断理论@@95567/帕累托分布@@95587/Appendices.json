{"hands_on_practices": [{"introduction": "帕累托分布的一个显著特征是其“重尾”特性，这意味着极端事件的发生概率远高于正态分布等常见分布。这个练习将通过计算一个条件概率，帮助你直观地理解这一特性，并掌握如何运用帕累托分布的生存函数来解决实际问题 [@problem_id:1942994]。这个思想实验模拟了财富分布，让你探索在已知一个个体相对富裕的情况下，其属于极端富有阶层的可能性。", "problem": "在一个简化的经济模型中，某个群体中个人的年收入 $X$ 服从帕累托分布。个人收入小于或等于某个值 $x$ 的概率由以下累积分布函数 (CDF) 给出：\n$$F(x) = P(X \\le x) = 1 - \\left(\\frac{x_m}{x}\\right)^{\\alpha}$$\n此公式对收入 $x \\ge x_m$ 有效，其中 $x_m$ 是该群体中的最低可能收入，$\\alpha$ 是称为帕累托指数的形状参数。对于此模型，假设最低收入为 $x_m$，帕累托指数为 $\\alpha = 2$。\n\n如果一个人的收入超过 $1.5 x_m$，则被认为是“富裕的”。如果一个人的收入超过 $2 x_m$，则被认为是“富有的”。\n\n已知一个随机选择的个人是富裕的，那么此人同时也是富有的条件概率是多少？请将答案表示为精确的小数值。", "solution": "设 $X$ 服从帕累托分布，其累积分布函数为 $F(x)=1-\\left(\\frac{x_{m}}{x}\\right)^{\\alpha}$，适用于 $x \\ge x_{m}$ 且 $\\alpha=2$。其生存函数为\n$$\nS(x)=P(Xx)=1-F(x)=\\left(\\frac{x_{m}}{x}\\right)^{\\alpha}, \\quad x \\ge x_{m}.\n$$\n定义事件 $A=\\{X\\frac{3}{2}x_{m}\\}$ (富裕的) 和 $W=\\{X2x_{m}\\}$ (富有的)。由于 $W \\subset A$，所求的条件概率为\n$$\nP(W \\mid A)=\\frac{P(W \\cap A)}{P(A)}=\\frac{P(W)}{P(A)}=\\frac{S(2x_{m})}{S\\left(\\frac{3}{2}x_{m}\\right)}.\n$$\n使用 $\\alpha=2$，\n$$\nS(2x_{m})=\\left(\\frac{x_{m}}{2x_{m}}\\right)^{2}=\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{4}, \\quad\nS\\left(\\frac{3}{2}x_{m}\\right)=\\left(\\frac{x_{m}}{(3/2)x_{m}}\\right)^{2}=\\left(\\frac{2}{3}\\right)^{2}=\\frac{4}{9}.\n$$\n因此，\n$$\nP(W \\mid A)=\\frac{\\frac{1}{4}}{\\frac{4}{9}}=\\frac{9}{16}=0.5625.\n$$", "answer": "$$\\boxed{0.5625}$$", "id": "1942994"}, {"introduction": "理论知识的实践应用往往始于模拟。本练习将向你介绍一种从任何给定分布中生成随机样本的强大技术——反变换采样法 [@problem_id:1943026]。通过将一个均匀分布的随机数转换为服从帕累托分布的变量，你将学会如何为经济模型或风险分析等应用生成符合现实世界规律的模拟数据。", "problem": "一位经济学家正在开发一个仿真模型，用于模拟一个小型、孤立经济体中的财富分配。根据经验数据，个人财富 $X$（以千货币单位计）的分布可以很好地用帕累托分布来近似。该分布的概率密度函数 (PDF) 由下式给出：\n$$f(x; x_m, \\alpha) = \\frac{\\alpha x_m^{\\alpha}}{x^{\\alpha+1}} \\quad \\text{for } x \\ge x_m$$\n且对于 $x  x_m$ 有 $f(x) = 0$。\n\n该经济体模型的参数估计为最小财富 $x_m = 10$（以千货币单位计）和形状参数 $\\alpha = 1.5$。\n\n为了运行该仿真，经济学家需要为一个新的代理人生成一个初始财富值。该生成过程依赖于从一个标准均匀分布中抽取一个值并对其进行变换。一个伪随机数生成器从区间 $(0, 1)$ 上的均匀分布中产生了一个值 $u = 0.72$。\n\n使用这个值 $u$ 作为逆变换采样过程的输入，为新代理人生成的相应财富 $X$ 是多少？请以千货币单位给出你的答案，并四舍五入到三位有效数字。", "solution": "我们从给定的对于 $x \\ge x_{m}$ 的帕累托概率密度函数开始：\n$$\nf(x;x_{m},\\alpha)=\\frac{\\alpha x_{m}^{\\alpha}}{x^{\\alpha+1}}.\n$$\n对于 $x \\ge x_{m}$，累积分布函数 $F(x)$ 可通过对 PDF 从 $x_{m}$ 到 $x$ 积分得到：\n$$\nF(x)=\\int_{x_{m}}^{x}\\frac{\\alpha x_{m}^{\\alpha}}{t^{\\alpha+1}}\\,dt=\\alpha x_{m}^{\\alpha}\\int_{x_{m}}^{x}t^{-(\\alpha+1)}\\,dt.\n$$\n使用 $\\int t^{-(\\alpha+1)}\\,dt=-\\frac{1}{\\alpha}t^{-\\alpha}$，我们得到\n$$\nF(x)=\\alpha x_{m}^{\\alpha}\\left[-\\frac{1}{\\alpha}t^{-\\alpha}\\right]_{t=x_{m}}^{t=x}=-x_{m}^{\\alpha}x^{-\\alpha}+x_{m}^{\\alpha}x_{m}^{-\\alpha}=1-\\left(\\frac{x_{m}}{x}\\right)^{\\alpha}.\n$$\n因此，对于 $x \\ge x_{m}$，\n$$\nF(x)=1-\\left(\\frac{x_{m}}{x}\\right)^{\\alpha}.\n$$\n逆变换采样法设定 $U\\sim\\mathrm{Unif}(0,1)$，并求解 $U=F(X)$ 以得出 $X$。令 $U=u$ 为一个实现值。则\n$$\nu=1-\\left(\\frac{x_{m}}{X}\\right)^{\\alpha}\\quad\\Longrightarrow\\quad 1-u=\\left(\\frac{x_{m}}{X}\\right)^{\\alpha}.\n$$\n将两边同时取 $1/\\alpha$ 次幂，并求解 $X$ 可得\n$$\n\\frac{x_{m}}{X}=(1-u)^{1/\\alpha}\\quad\\Longrightarrow\\quad X=x_{m}(1-u)^{-1/\\alpha}.\n$$\n代入给定参数 $x_{m}=10$ 和 $\\alpha=1.5=\\frac{3}{2}$，所以 $-\\frac{1}{\\alpha}=-\\frac{2}{3}$，以及给定的 $u=0.72$：\n$$\nX=10\\,(1-0.72)^{-1/1.5}=10\\,(0.28)^{-2/3}.\n$$\n计算其数值并四舍五入到三位有效数字：\n$$\n(0.28)^{-2/3}\\approx 2.3369,\\quad X\\approx 10\\times 2.3369=23.369\\ \\text{(thousands)}\\ \\approx 23.4\\ \\text{(thousands)}.\n$$\n因此，生成的财富以千货币单位计为 $23.4$（保留三位有效数字）。", "answer": "$$\\boxed{23.4}$$", "id": "1943026"}, {"introduction": "当我们用一个数学模型（如帕累托分布）来描述真实世界的数据时，下一个关键步骤就是从数据中估计模型的参数。本练习将指导你运用极大似然估计（MLE）这一统计推断的基石方法，来推导帕累托分布形状参数 $\\alpha$ 的估计量 [@problem_id:1943033]。这个过程将使你掌握如何从观测样本（例如文件大小数据）中提取关键信息，以确定最能描述这些数据的分布形态。", "problem": "在分布式云存储系统中，大型文件的大小通常用幂律分布来建模。观测表明，对于大于某一最小尺寸的文件，其大小 $x$ 的分布可以很好地用帕累托I型分布来近似。该分布的概率密度函数（PDF）由下式给出：\n$$ f(x; \\alpha, x_m) = \\frac{\\alpha x_m^{\\alpha}}{x^{\\alpha+1}} \\quad \\text{for } x \\ge x_m $$\n其中 $x_m$ 是已知的最小文件大小（尺度参数），而 $\\alpha$ 是一个未知的形状参数，它刻画了分布的“尾部”特性。\n\n一位工程师收集了一个包含 $n$ 个文件大小的随机样本，记为 $x_1, x_2, \\dots, x_n$，这些样本值均大于或等于已知的最小尺寸 $x_m$。你的任务是基于这些观测数据，确定形状参数 $\\alpha$ 的最大似然估计量（MLE）。\n\n请推导 $\\alpha$ 的最大似然估计量 $\\hat{\\alpha}$ 的闭式解析表达式，该表达式应使用 $n$，$x_m$ 和观测数据 $x_i$ 来表示。", "solution": "对于来自帕累托I型分布（其中 $x_m$ 已知，参数 $\\alpha0$）的独立观测值 $x_{1},\\dots,x_{n}$，其联合似然函数为\n$$\nL(\\alpha)=\\prod_{i=1}^{n} f(x_{i};\\alpha,x_{m})\n=\\prod_{i=1}^{n}\\left(\\frac{\\alpha x_{m}^{\\alpha}}{x_{i}^{\\alpha+1}}\\right)\n=\\alpha^{n}\\,x_{m}^{n\\alpha}\\,\\prod_{i=1}^{n}x_{i}^{-(\\alpha+1)}.\n$$\n对数似然函数为\n$$\n\\ell(\\alpha)=\\ln L(\\alpha)=n\\ln\\alpha+n\\alpha\\ln x_{m}-(\\alpha+1)\\sum_{i=1}^{n}\\ln x_{i}.\n$$\n对 $\\alpha$ 求导并令其等于零，以求得最大值：\n$$\n\\frac{\\partial \\ell}{\\partial \\alpha}=\\frac{n}{\\alpha}+n\\ln x_{m}-\\sum_{i=1}^{n}\\ln x_{i}=0.\n$$\n解出 $\\alpha$ 可得\n$$\n\\hat{\\alpha}=\\frac{n}{\\sum_{i=1}^{n}\\ln x_{i}-n\\ln x_{m}}=\\frac{n}{\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{x_{i}}{x_{m}}\\right)}.\n$$\n为验证其为最大值，计算二阶导数：\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\alpha^{2}}=-\\frac{n}{\\alpha^{2}}0 \\quad \\text{for } \\alpha0,\n$$\n因此，该驻点确实是一个极大值点。因此，最大似然估计量为\n$$\n\\hat{\\alpha}=\\frac{n}{\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{x_{i}}{x_{m}}\\right)}.\n$$\n这要求至少有一个 $x_{i}x_{m}$，以确保分母为正且有限。", "answer": "$$\\boxed{\\frac{n}{\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{x_{i}}{x_{m}}\\right)}}$$", "id": "1943033"}]}