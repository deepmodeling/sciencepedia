{"hands_on_practices": [{"introduction": "我们的实践始于一个关于几何分布的经典问题。这个练习是理解Wilks定理的绝佳起点，它展示了在“正则”条件下，对单个参数进行检验时似然比检验（LRT）统计量的行为。通过这个基础案例，您将建立起对LRT渐近性质的直观理解。[@problem_id:1896229]", "problem": "一项实验重复投掷一枚有偏硬币，直到首次观察到“正面”为止。随机变量 $X$ 表示所需的总投掷次数。此过程由成功概率为 $p$ 的几何分布建模，其中 $p$ 是单次投掷得到“正面”的概率。$X$ 的概率质量函数 (PMF) 为 $P(X=k) = (1-p)^{k-1}p$，其中 $k=1, 2, 3, \\ldots$ 且 $0  p  1$。\n\n假设我们从此几何分布中获得了一个包含 $n$ 个独立同分布 (i.i.d.) 观测值的大样本 $X_1, X_2, \\ldots, X_n$。我们希望检验简单原假设 $H_0: p = p_0$ 与复合备择假设 $H_1: p \\neq p_0$，其中 $p_0$ 是区间 $(0, 1)$ 内的一个固定的已知值。\n\n该检验的似然比检验 (LRT) 统计量定义为：\n$$\n\\Lambda_n = \\frac{\\sup_{p \\in \\{p_0\\}} L(p|\\mathbf{x})}{\\sup_{p \\in (0,1)} L(p|\\mathbf{x})}\n$$\n其中 $L(p|\\mathbf{x})$ 是观测样本 $\\mathbf{x} = (x_1, \\ldots, x_n)$ 的似然函数。\n\n根据数理统计学中关于似然比检验的一个基本定理，在原假设 $H_0$ 成立的条件下，随着样本量 $n \\to \\infty$，变换后的统计量 $-2\\ln\\Lambda_n$ 的分布会收敛到一个特定的著名分布。\n\n$-2\\ln\\Lambda_n$ 的这个极限（渐近）分布是什么？\n\nA. 均值为 0、方差为 1 的正态分布，$N(0, 1)$。\nB. 自由度为 1 的卡方分布，$\\chi^2(1)$。\nC. 自由度为 $n-1$ 的卡方分布，$\\chi^2(n-1)$。\nD. 自由度为 $(1, n-1)$ 的 F 分布，$F_{1, n-1}$。\nE. 自由度为 $n-1$ 的 t 分布，$t_{n-1}$。", "solution": "我们观测到来自几何分布的独立同分布样本 $X_{1},\\ldots,X_{n}$，其概率质量函数为 $P(X=k)=(1-p)^{k-1}p$，其中 $k=1,2,\\ldots$ 且 $p\\in(0,1)$。样本 $\\mathbf{x}=(x_{1},\\ldots,x_{n})$ 的似然函数为\n$$\nL(p\\mid\\mathbf{x})=\\prod_{i=1}^{n}p(1-p)^{x_{i}-1}=p^{n}(1-p)^{\\sum_{i=1}^{n}x_{i}-n}.\n$$\n令 $S=\\sum_{i=1}^{n}x_{i}$。则对数似然函数为\n$$\n\\ell(p)=\\ln L(p\\mid\\mathbf{x})=n\\ln p+(S-n)\\ln(1-p).\n$$\n无约束的最大似然估计 (MLE) $\\hat{p}$ 是方程 $\\frac{\\partial}{\\partial p}\\ell(p)=0$ 的解：\n$$\n\\frac{\\partial}{\\partial p}\\ell(p)=\\frac{n}{p}-\\frac{S-n}{1-p}=0\n\\;\\;\\Longrightarrow\\;\\; n(1-p)-p(S-n)=0\n\\;\\;\\Longrightarrow\\;\\; n-pS=0\n\\;\\;\\Longrightarrow\\;\\; \\hat{p}=\\frac{n}{S}.\n$$\n似然比统计量为\n$$\n\\Lambda_{n}=\\frac{\\sup_{p\\in\\{p_{0}\\}}L(p\\mid\\mathbf{x})}{\\sup_{p\\in(0,1)}L(p\\mid\\mathbf{x})}\n=\\frac{L(p_{0}\\mid\\mathbf{x})}{L(\\hat{p}\\mid\\mathbf{x})}.\n$$\n在原假设 $H_{0}:p=p_{0}$ 且 $p_{0}\\in(0,1)$ 的条件下，这是一个在开放参数空间中的正则单参数问题，且几何分布族是正则指数族。因此，根据 Wilks 定理，当 $n\\to\\infty$ 时，$-2\\ln\\Lambda_{n}$ 的分布依分布收敛于一个卡方分布，其自由度等于无约束参数空间和受约束参数空间的维度之差。在这里，无约束模型的维度为 1，零模型的维度为 0，所以差值为 1。因此，\n$$\n-2\\ln\\Lambda_{n}\\;\\xrightarrow{d}\\;\\chi^{2}(1)\\quad\\text{在 }H_{0}\\text{ 成立的条件下}.\n$$\n因此，正确选项是自由度为 1 的卡方分布。", "answer": "$$\\boxed{B}$$", "id": "1896229"}, {"introduction": "接下来，我们将LRT的应用扩展到一个更为实用和复杂的场景：多元线性回归。在这个练习中，您将不再是检验单个参数的值，而是检验多个参数之间是否存在线性关系。这突显了LRT在评估和简化统计模型方面的强大功能，是数据分析中的一项核心技能。[@problem_id:1896221]", "problem": "一个数据科学团队正在分析影响其平台用户参与度的因素。他们提出了一个多元线性回归模型来预测用户每周在服务上花费的小时数 $Y$。该模型包括两个解释变量：$x_1$ 是一个代表用户接触名为“EngageMax”的内容排名算法的分数，而 $x_2$ 是一个代表接触不同算法“ExploreNow”的分数。\n\n模型由下式给出：\n$$Y_i = \\beta_0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\epsilon_i$$\n对于用户 $i = 1, \\dots, n$。误差项 $\\epsilon_i$ 被假定为独立同分布（i.i.d.）的正态随机变量，其均值为0，未知方差为 $\\sigma^2 > 0$。协变量 $x_{i1}$ 和 $x_{i2}$ 被视为固定的、非随机的量。\n\n该团队想确定这两种算法对用户参与度是否具有相同的影响。为此，他们构建了零假设 $H_0: \\beta_1 = \\beta_2$。他们构建了似然比检验（LRT）统计量 $T_n$，定义为：\n$$T_n = -2 \\ln\\left(\\frac{L_0}{L_1}\\right)$$\n其中 $L_0$ 表示在零假设 $H_0$ 下数据的最大化似然，而 $L_1$ 表示在完整的、无约束模型下的最大化似然。\n\n当样本量 $n$ 趋于无穷大时，检验统计量 $T_n$ 会收敛到一个特定的概率分布。下面哪个选项正确描述了这个极限分布？\n\nA. 一个自由度为1的卡方分布。\nB. 一个自由度为2的卡方分布。\nC. 一个自由度为3的卡方分布。\nD. 一个自由度为 $(1, n-3)$ 的F分布。\nE. 一个标准正态分布 $N(0,1)$。", "solution": "我们有带固定回归量的正态线性回归模型：\n$$Y_{i} = \\beta_{0} + \\beta_{1} x_{i1} + \\beta_{2} x_{i2} + \\epsilon_{i}, \\quad \\epsilon_{i} \\stackrel{\\text{i.i.d.}}{\\sim} N(0,\\sigma^{2}), \\quad i=1,\\dots,n.$$\n我们使用似然比检验来检验零假设 $H_{0}:\\beta_{1}=\\beta_{2}$，其统计量为\n$$T_{n} = -2 \\ln\\left(\\frac{L_{0}}{L_{1}}\\right),$$\n其中 $L_{0}$ 是在 $H_{0}$ 下的最大化似然，$L_{1}$ 是在完整模型下的最大化似然。\n\n根据 Wilks' 定理，在标准的正则性条件下（对于具有固定回归量和可识别参数的正态线性模型，这些条件是成立的），似然比统计量在 $H_{0}$ 下的渐近分布是\n$$T_{n} \\xrightarrow{d} \\chi^{2}_{k},$$\n其中 $k$ 是无约束模型和有约束模型参数空间维度之差。\n\n计算 $k$：\n- 无约束参数向量为 $(\\beta_{0},\\beta_{1},\\beta_{2},\\sigma^{2})$，其维度为 $4$。\n- 在 $H_{0}:\\beta_{1}=\\beta_{2}$ 下，我们可以重新参数化为 $(\\beta_{0},\\beta,\\sigma^{2})$，其中 $\\beta=\\beta_{1}=\\beta_{2}$，维度为 $3$。\n\n因此，独立约束的数量为 $k=4-3=1$，所以\n$$T_{n} \\xrightarrow{d} \\chi^{2}_{1}.$$\n这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1896221"}, {"introduction": "最后，我们来探讨一个挑战性的“非正则”案例，它揭示了理论的边界。虽然Wilks定理非常强大，但它依赖于某些前提条件，而这些条件在本例的均匀分布中并不满足。这个练习至关重要，因为它将促使您思考统计定理的适用范围，并理解为何检验统计量的渐近分布有时会偏离标准的 $\\chi^2$ 分布。[@problem_id:1896246]", "problem": "设 $X_1, X_2, \\dots, X_n$ 是一个来自区间 $[\\theta_1, \\theta_2]$ 上均匀分布的独立同分布随机样本，其中 $\\theta_1, \\theta_2 \\in \\mathbb{R}$ 且 $\\theta_1  \\theta_2$ 是未知参数。考虑一个假设检验，其原假设为 $H_0: \\theta_2 - \\theta_1 = c$，备择假设为 $H_1: \\theta_2 - \\theta_1 \\neq c$，其中 $c$ 是一个已知的正常数。\n\n令 $\\Lambda_n$ 表示此检验的似然比检验 (LRT) 统计量，定义为原假设下的最大似然与整个参数空间上的最大似然之比。在原假设 $H_0$ 为真的条件下，确定当样本量 $n$ 趋于无穷大时，统计量 $T_n = -2 \\ln \\Lambda_n$ 的极限分布。\n\n从以下选项中选择对极限分布的正确描述：\n\nA. 自由度为1的卡方分布。\nB. 自由度为2的卡方分布。\nC. 标准正态分布。\nD. 自由度为4的卡方分布。\nE. 率参数为1的指数分布。\nF. 形状参数为2、率参数为1的伽马分布。", "solution": "设 $X_{1},\\dots,X_{n}$ 独立同分布于 $\\operatorname{Uniform}[\\theta_{1},\\theta_{2}]$，其中 $\\theta_{1}\\theta_{2}$ 未知，并令 $R_{n}=X_{(n)}-X_{(1)}$ 表示样本极差。\n\n$(\\theta_{1},\\theta_{2})$ 的似然函数为\n$$\nL(\\theta_{1},\\theta_{2})=(\\theta_{2}-\\theta_{1})^{-n}\\,\\mathbf{1}\\{\\theta_{1}\\leq X_{(1)},\\,\\theta_{2}\\geq X_{(n)}\\}.\n$$\n在整个参数空间上最大化，得到无约束的最大似然估计 (MLE) 为 $\\hat{\\theta}_{1}=X_{(1)}$，$\\hat{\\theta}_{2}=X_{(n)}$，其最大似然值为\n$$\nL_{\\text{full}}=R_{n}^{-n}.\n$$\n在 $H_{0}:\\theta_{2}-\\theta_{1}=c$ 下，任何包含所有观测值且长度为 $c$ 的区间的似然均为 $c^{-n}$；这样的区间存在的充分必要条件是 $R_{n}\\leq c$。在 $H_{0}$ 下，此条件以概率 1 成立，所以有约束的最大值为\n$$\nL_{0}=c^{-n}.\n$$\n因此，似然比为\n$$\n\\Lambda_{n}=\\frac{L_{0}}{L_{\\text{full}}}=\\left(\\frac{R_{n}}{c}\\right)^{n},\n$$\n因此\n$$\nT_{n}=-2\\ln\\Lambda_{n}=2n\\ln\\left(\\frac{c}{R_{n}}\\right).\n$$\n\n为了得到在 $H_0$ 下 $T_n$ 的极限分布，将其重新参数化为 $Y_{i}=(X_{i}-\\theta_{1})/c\\sim \\operatorname{Uniform}[0,1]$。那么\n$$\nR_{n}=c\\bigl(Y_{(n)}-Y_{(1)}\\bigr),\\qquad D_{n}=c-R_{n}=c\\bigl[(1-Y_{(n)})+Y_{(1)}\\bigr]\\geq 0.\n$$\n均匀分布的经典极值理论给出\n$$\nnY_{(1)}\\xrightarrow{d}E_{1},\\qquad n(1-Y_{(n)})\\xrightarrow{d}E_{2},\n$$\n其中 $E_{1}$ 和 $E_{2}$ 是独立的 $\\operatorname{Exp}(1)$ 变量。因此\n$$\n\\frac{nD_{n}}{c}=n\\bigl[(1-Y_{(n)})+Y_{(1)}\\bigr]\\xrightarrow{d}E_{1}+E_{2}\\equiv G,\n$$\n其中 $G\\sim \\operatorname{Gamma}(2,1)$ (形状参数为 2，率参数为 1)。\n\n由于 $D_{n}/c$ 以 $n^{-1}$ 的速率依概率收敛到 0，使用泰勒展开\n$$\n\\ln\\left(\\frac{c}{R_{n}}\\right)=-\\ln\\left(1-\\frac{D_{n}}{c}\\right)=\\frac{D_{n}}{c}+o_{p}\\left(\\frac{D_{n}}{c}\\right).\n$$\n因此\n$$\nT_{n}=2n\\ln\\left(\\frac{c}{R_{n}}\\right)=2n\\frac{D_{n}}{c}+o_{p}(1)\\xrightarrow{d}2G.\n$$\n如果 $G\\sim \\operatorname{Gamma}(2,1)$，那么 $2G\\sim \\operatorname{Gamma}\\bigl(2,\\tfrac{1}{2}\\bigr)$，这是一个自由度为 4 的卡方分布。因此，在 $H_{0}$ 下，\n$$\nT_{n}\\xrightarrow{d}\\chi^{2}_{4}.\n$$\n\n因此正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "1896246"}]}