{"hands_on_practices": [{"introduction": "理论是基础，但真正的理解来自于实践。本节提供了一系列动手实践，旨在将瓦尔德检验（Wald test）的原理应用于实际问题中。我们将从一个基础但至关重要的应用开始：检验单个总体比例。这个场景在医学研究、民意调查和质量控制等领域非常普遍，通过这个练习，你将掌握构建瓦尔德检验统计量的核心逻辑。[@problem_id:1967067]", "problem": "一家制药公司正在为一种特定的心脏病开发一种新药“CardiaHeal”。根据历史数据，现有治疗方法的成功率为 $p_0 = 0.40$。该公司进行了一项临床试验，以确定CardiaHeal是否具有不同的成功率。在该试验中，一个包含 $n = 200$ 名该病症患者的随机样本接受了CardiaHeal的治疗。在这些患者中，有 $x = 95$ 名患者的治疗被认为是成功的。\n\n为了评估反对历史成功率的证据，一名研究人员决定进行一个以原假设为 $H_0: p = p_0$ 的双侧假设检验。\n\n计算此假设检验的Wald检验统计量的值。报告你的答案，保留三位有效数字。", "solution": "我们使用单个比例的Wald检验来检验 $H_{0}: p = p_{0}$，其中 $p_{0} = 0.40$。\n\n设样本量为 $n = 200$，成功次数为 $x = 95$。$p$ 的最大似然估计是样本比例\n$$\n\\hat{p} = \\frac{x}{n} = \\frac{95}{200} = 0.475.\n$$\n\n根据大样本理论，$\\hat{p}$ 近似服从均值为 $p$、方差为 $p(1-p)/n$ 的正态分布。Wald检验使用在无约束最大似然估计 $\\hat{p}$ 处计算的估计标准误：\n$$\n\\widehat{\\operatorname{SE}}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}\\left(1-\\hat{p}\\right)}{n}}.\n$$\n因此，Wald检验统计量为\n$$\nZ_{\\text{W}} = \\frac{\\hat{p} - p_{0}}{\\sqrt{\\frac{\\hat{p}\\left(1-\\hat{p}\\right)}{n}}}.\n$$\n\n代入数值，\n$$\nZ_{\\text{W}} = \\frac{0.475 - 0.40}{\\sqrt{\\frac{0.475 \\times 0.525}{200}}}\n= \\frac{0.075}{\\sqrt{\\frac{0.249375}{200}}}\n= \\frac{0.075}{\\sqrt{0.001246875}}\n\\approx \\frac{0.075}{0.0353253}\n\\approx 2.12.\n$$\n\n保留三位有效数字，Wald检验统计量为 $2.12$。", "answer": "$$\\boxed{2.12}$$", "id": "1967067"}, {"introduction": "掌握了单个参数的检验后，我们自然会想比较两个不同的组。这个练习将瓦尔德检验的框架扩展到一个常见的双样本问题中，这是评估新疗法、材料或教学方法有效性的标准步骤。在这里，你的任务是检验两个正态分布总体的均值之差 $\\mu_B - \\mu_A$ 是否等于一个特定的非零值，这将让你练习如何合并来自两个独立样本的信息来计算标准误。[@problem_id:1967083]", "problem": "一个材料科学实验室正在比较两种新配方的高强度聚合物，聚合物A和聚合物B。主要关注的特性是拉伸强度，单位为兆帕 (MPa)。根据合成工艺，已知两种聚合物的拉伸强度均服从正态分布。其工艺变异性已得到充分了解，因此已知聚合物A的标准差为 $\\sigma_A = 2.4$ MPa，聚合物B的标准差为 $\\sigma_B = 3.2$ MPa。\n\n研究团队有一个理论模型，该模型预测聚合物B的真实平均拉伸强度应恰好比聚合物A高 8.0 MPa。为验证这一说法，他们准备了两个独立的随机样本：一个包含 $n_A = 40$ 个聚合物A试样的样本，以及一个包含 $n_B = 50$ 个聚合物B试样的样本。经过测试，测得样本的平均拉伸强度分别为 $\\bar{x}_A = 121.5$ MPa 和 $\\bar{x}_B = 130.3$ MPa。\n\n您的任务是评估该团队的预测。设 $\\mu_A$ 和 $\\mu_B$ 分别为真实的平均拉伸强度，您将检验原假设 $H_0: \\mu_B - \\mu_A = 8.0$。请计算相应的标准化的Wald检验统计量的值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用针对已知方差的两个独立正态样本的Wald统计量来检验 $H_{0}: \\mu_{B} - \\mu_{A} = \\Delta_{0}$，其中 $\\Delta_{0} = 8.0$：\n$$\nZ \\;=\\; \\frac{\\left(\\bar{X}_{B} - \\bar{X}_{A}\\right) - \\Delta_{0}}{\\sqrt{\\frac{\\sigma_{A}^{2}}{n_{A}} + \\frac{\\sigma_{B}^{2}}{n_{B}}}}.\n$$\n代入给定值。观测到的差值为\n$$\n\\bar{X}_{B} - \\bar{X}_{A} = 130.3 - 121.5 = 8.8,\n$$\n所以分子为\n$$\n(8.8 - 8.0) = 0.8.\n$$\n计算标准误差：\n$$\n\\frac{\\sigma_{A}^{2}}{n_{A}} + \\frac{\\sigma_{B}^{2}}{n_{B}} \\;=\\; \\frac{(2.4)^{2}}{40} + \\frac{(3.2)^{2}}{50} \\;=\\; \\frac{5.76}{40} + \\frac{10.24}{50} \\;=\\; 0.144 + 0.2048 \\;=\\; 0.3488.\n$$\n因此\n$$\nZ \\;=\\; \\frac{0.8}{\\sqrt{0.3488}}.\n$$\n由于 $0.3488 = \\frac{3488}{10000} = \\frac{218}{625}$，我们有 $\\sqrt{0.3488} = \\frac{\\sqrt{218}}{25}$，从而得到精确形式\n$$\nZ \\;=\\; \\frac{0.8}{\\sqrt{0.3488}} \\;=\\; \\frac{0.8 \\times 25}{\\sqrt{218}} \\;=\\; \\frac{20}{\\sqrt{218}}.\n$$\n数值计算结果为，\n$$\nZ \\approx 1.35457,\n$$\n四舍五入到三位有效数字为 $1.35$。", "answer": "$$\\boxed{1.35}$$", "id": "1967083"}, {"introduction": "瓦尔德检验的真正威力在于其灵活性，能够检验涉及多个参数的复杂假设。这个高级练习将挑战你检验两个独立的泊松过程 (Poisson process) 的率参数 $\\lambda_1$ 和 $\\lambda_2$ 之间的线性关系。要解决这个问题，你需要应用“德尔塔方法”(delta method) 来估计复合参数估计量 $\\hat{\\lambda}_1 - 2\\hat{\\lambda}_2$ 的标准误，这是现代统计推断中一项至关重要的技术。[@problem_id:1967060]", "problem": "两个独立的天文巡天项目旨在探测Ia型超新星。第一个巡天项目在天空的特定区域运行了 $T_1 = 2.0$ 年，探测到 $x_1 = 125$ 颗超新星。第二个巡天项目在不同的区域观测了 $T_2 = 1.25$ 年，探测到 $x_2 = 35$ 颗超新星。\n\n假设对于每个巡天项目 $i \\in \\{1, 2\\}$，探测到的超新星数量 $X_i$ 服从泊松分布，其均值为 $\\lambda_i T_i$，其中 $\\lambda_i$ 是巡天项目 $i$ 观测区域内每年超新星发生的恒定平均速率。这两个过程在统计上是独立的。\n\n某个特定的宇宙学模型预测了两个观测区域中超新星速率之间的特定关系，即第一个区域的速率恰好是第二个区域速率的两倍。你的任务是检验这一预测。原假设为 $H_0: \\lambda_1 - 2\\lambda_2 = 0$，备择假设为 $H_a: \\lambda_1 - 2\\lambda_2 \\neq 0$。\n\n为该假设构建相应的瓦尔德检验（Wald test）。使用所提供的观测数据，计算瓦尔德检验统计量的数值，该统计量在原假设下渐近服从卡方（chi-squared）随机变量分布。将你的最终答案四舍五入到四位有效数字。", "solution": "我们对 $i \\in \\{1,2\\}$ 独立地建模为 $X_{i} \\sim \\text{Poisson}(\\lambda_{i} T_{i})$，其中 $T_{1}$ 和 $T_{2}$ 是固定的。每个速率的最大似然估计量是通过最大化泊松似然函数得到的，即 $\\hat{\\lambda}_{i} = X_{i}/T_{i}$。由于泊松随机变量的方差为 $\\operatorname{Var}(X_{i}) = \\lambda_{i} T_{i}$，因此可得\n$$\n\\operatorname{Var}(\\hat{\\lambda}_{i}) = \\operatorname{Var}\\!\\left(\\frac{X_{i}}{T_{i}}\\right) = \\frac{\\lambda_{i} T_{i}}{T_{i}^{2}} = \\frac{\\lambda_{i}}{T_{i}}.\n$$\n定义我们感兴趣的参数为 $g(\\lambda_{1},\\lambda_{2}) = \\lambda_{1} - 2\\lambda_{2}$，其梯度向量为 $Dg = \\begin{pmatrix}1 & -2\\end{pmatrix}$。根据德尔塔方法（delta method），并利用独立性和 $\\Sigma = \\operatorname{diag}\\!\\left(\\frac{\\lambda_{1}}{T_{1}}, \\frac{\\lambda_{2}}{T_{2}}\\right)$，\n$$\n\\operatorname{Var}\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2})\\big) \\approx Dg \\, \\Sigma \\, Dg^{\\top} = \\frac{\\lambda_{1}}{T_{1}} + 4 \\frac{\\lambda_{2}}{T_{2}}.\n$$\n用于检验 $H_{0}: \\lambda_{1} - 2\\lambda_{2} = 0$ 的瓦尔德统计量为\n$$\nW = \\frac{\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2}) - 0\\big)^{2}}{\\widehat{\\operatorname{Var}}\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2})\\big)},\n$$\n其中方差的代入估计量为\n$$\n\\widehat{\\operatorname{Var}}\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2})\\big) = \\frac{\\hat{\\lambda}_{1}}{T_{1}} + 4 \\frac{\\hat{\\lambda}_{2}}{T_{2}} = \\frac{X_{1}}{T_{1}^{2}} + 4 \\frac{X_{2}}{T_{2}^{2}}.\n$$\n因此，\n$$\nW = \\frac{\\left(\\frac{X_{1}}{T_{1}} - 2 \\frac{X_{2}}{T_{2}}\\right)^{2}}{\\frac{X_{1}}{T_{1}^{2}} + 4 \\frac{X_{2}}{T_{2}^{2}}} \\;\\;\\overset{H_{0}}{\\sim}\\;\\; \\chi^{2}_{1} \\text{ 渐近地。}\n$$\n代入数据 $T_{1} = 2.0$, $X_{1} = 125$, $T_{2} = 1.25 = \\frac{5}{4}$, $X_{2} = 35$：\n$$\n\\hat{\\lambda}_{1} = \\frac{125}{2} = 62.5,\\quad \\hat{\\lambda}_{2} = \\frac{35}{5/4} = 28,\n$$\n$$\ng(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2}) = 62.5 - 2 \\cdot 28 = 6.5 = \\frac{13}{2},\n$$\n$$\n\\widehat{\\operatorname{Var}} = \\frac{X_{1}}{T_{1}^{2}} + 4 \\frac{X_{2}}{T_{2}^{2}} = \\frac{125}{4} + 4 \\cdot \\frac{35}{(5/4)^{2}} = \\frac{125}{4} + 4 \\cdot \\frac{35}{25/16} = \\frac{125}{4} + \\frac{448}{5} = \\frac{2417}{20}.\n$$\n因此，\n$$\nW = \\frac{\\left(\\frac{13}{2}\\right)^{2}}{\\frac{2417}{20}} = \\frac{\\frac{169}{4}}{\\frac{2417}{20}} = \\frac{169}{4} \\cdot \\frac{20}{2417} = \\frac{845}{2417} \\approx 0.3496,\n$$\n其中数值结果四舍五入到四位有效数字。", "answer": "$$\\boxed{0.3496}$$", "id": "1967060"}]}