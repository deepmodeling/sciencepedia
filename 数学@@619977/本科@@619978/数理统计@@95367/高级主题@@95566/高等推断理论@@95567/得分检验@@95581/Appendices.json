{"hands_on_practices": [{"introduction": "让我们从一个基础但至关重要的例子开始。此练习将指导你为伯努利（Bernoulli）分布构建分数检验，这在检验总体比例的假设时非常常见。通过这个实践 [@problem_id:1953755]，你会发现分数检验与你可能已经熟悉的比例 $Z$ 检验之间的深刻联系，从而巩固你对这一统计工具背后核心逻辑的理解。", "problem": "考虑一个简化的数字通信信道模型，其中比特是逐个传输的。每个比特的传输都可能发生位翻转错误（0 变为 1，或 1 变为 0），其概率为一个恒定值 $p$。我们可以将每个比特发生错误的情况建模为一次独立的伯努利试验。设 $X_i$ 为第 $i$ 次比特传输的随机变量，其中当发生错误时 $X_i=1$，当传输成功时 $X_i=0$。\n\n一位工程师收集了一个大小为 $n$ 的传输随机样本，以检验错误率是否等于一个特定的设计值 $p_0$。样本中观测到的位翻转错误总数记为 $T = \\sum_{i=1}^{n} X_i$。\n\n您的任务是构建用于检验原假设 $H_0: p = p_0$ 与备择假设 $H_a: p \\neq p_0$ 的拉奥分数检验统计量。将该统计量表示为样本量 $n$、观测到的错误总数 $T$ 和假设的错误率 $p_0$ 的函数。", "solution": "我们将 $X_{i}$ 独立地建模为 $X_{i} \\sim \\text{Bernoulli}(p)$，因此 $T=\\sum_{i=1}^{n}X_{i} \\sim \\text{Binomial}(n,p)$。在给定 $T$ 的情况下，$p$ 的似然函数为\n$$\nL(p;T)=\\binom{n}{T}p^{T}(1-p)^{n-T},\n$$\n对数似然函数为\n$$\n\\ell(p)=\\ln L(p;T)=\\ln\\binom{n}{T}+T\\ln p+(n-T)\\ln(1-p).\n$$\n分数函数是关于 $p$ 的一阶导数：\n$$\nU(p)=\\frac{\\partial \\ell}{\\partial p}=\\frac{T}{p}-\\frac{n-T}{1-p}.\n$$\n费雪信息为\n$$\nI(p)=-\\mathbb{E}\\!\\left[\\frac{\\partial^{2}\\ell}{\\partial p^{2}}\\right]\n=-\\mathbb{E}\\!\\left[-\\frac{T}{p^{2}}-\\frac{n-T}{(1-p)^{2}}\\right]\n=\\frac{n}{p(1-p)},\n$$\n这里使用了 $\\mathbb{E}[T]=np$。在原假设 $H_{0}:p=p_{0}$（其中 $0<p_{0}<1$）下，在 $p_{0}$ 处计算分数函数和费雪信息：\n$$\nU(p_{0})=\\frac{T}{p_{0}}-\\frac{n-T}{1-p_{0}}=\\frac{T-np_{0}}{p_{0}(1-p_{0})},\\qquad I(p_{0})=\\frac{n}{p_{0}(1-p_{0})}.\n$$\n拉奥分数检验统计量是\n$$\nS=\\frac{U(p_{0})^{2}}{I(p_{0})}\n=\\frac{\\left(\\dfrac{T-np_{0}}{p_{0}(1-p_{0})}\\right)^{2}}{\\dfrac{n}{p_{0}(1-p_{0})}}\n=\\frac{(T-np_{0})^{2}}{n\\,p_{0}(1-p_{0})}.\n$$\n等价地，标准化分数为 $Z=(T-np_{0})/\\sqrt{n\\,p_{0}(1-p_{0})}$，且 $S=Z^{2}$。", "answer": "$$\\boxed{\\frac{(T-np_{0})^{2}}{n\\,p_{0}(1-p_{0})}}$$", "id": "1953755"}, {"introduction": "在掌握了伯努利模型的检验后，我们将方法推广到另一种常见的离散分布——几何分布。这个练习模拟了工业质量控制中的一个场景，即检验首次发现次品的“等待时间”模型。通过推导几何分布参数的分数检验 [@problem_id:1953900]，你将练习如何将似然函数、分数函数和费雪（Fisher）信息量这些核心概念应用到新的情境中。", "problem": "一位质量控制工程师正在监控一条特定类型电子元件的生产线。直至发现第一个有缺陷的元件为止所测试的元件数量，用随机变量 $X$ 表示，假设其服从几何分布。其概率质量函数 (PMF) 为 $f(x; p) = p(1-p)^{x-1}$，其中 $x = 1, 2, 3, \\dots$，而 $p$ 是一个元件有缺陷的概率。\n\n历史上，缺陷率一直稳定在一个已知值 $p_0$。为了评估最近对制造工艺的一项修改，该工程师收集了一个包含 $n$ 个独立观测值的随机样本 $X_1, X_2, \\dots, X_n$，其中每个 $X_i$ 代表在单次检验运行中直至发现第一个缺陷元件所需的试验次数。\n\n为了确定缺陷率是否与其历史值有所不同，该工程师希望检验原假设 $H_0: p = p_0$。基于此情景，推导用于此假设检验的拉奥分数检验统计量的一般形式。将您的答案表示为关于样本量 $n$、假设的缺陷率 $p_0$ 和样本均值 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^n X_i$ 的封闭形式解析表达式。", "solution": "我们观测到独立的 $X_{1},\\dots,X_{n}$，其几何分布的概率质量函数为 $f(x;p)=p(1-p)^{x-1}$，其中 $x\\in\\{1,2,\\dots\\}$。似然函数为\n$$\nL(p)=\\prod_{i=1}^{n} p(1-p)^{x_{i}-1}=p^{n}(1-p)^{\\sum_{i=1}^{n}x_{i}-n}=p^{n}(1-p)^{n\\bar{X}-n}.\n$$\n因此，对数似然函数为\n$$\n\\ell(p)=\\ln L(p)=n\\ln p+(n\\bar{X}-n)\\ln(1-p).\n$$\n分数函数为\n$$\nU(p)=\\frac{\\partial \\ell(p)}{\\partial p}=\\frac{n}{p}-\\frac{n\\bar{X}-n}{1-p}=n\\left(\\frac{1}{p}-\\frac{\\bar{X}-1}{1-p}\\right).\n$$\n二阶导数为\n$$\n\\ell''(p)=\\frac{\\partial^{2}\\ell(p)}{\\partial p^{2}}=-\\frac{n}{p^{2}}-\\frac{n\\bar{X}-n}{(1-p)^{2}}.\n$$\n（期望）费雪信息量为 $I(p)=-\\mathbb{E}_{p}[\\ell''(p)]$。使用几何分布的均值 $\\mathbb{E}_{p}[X]=\\frac{1}{p}$，我们得到 $\\mathbb{E}_{p}[n\\bar{X}-n]=n\\left(\\frac{1}{p}-1\\right)=n\\frac{1-p}{p}$，所以\n$$\nI(p)=\\frac{n}{p^{2}}+\\frac{n\\frac{1-p}{p}}{(1-p)^{2}}=\\frac{n}{p^{2}}+\\frac{n}{p(1-p)}=\\frac{n}{p^{2}(1-p)}.\n$$\n用于检验 $H_{0}:p=p_{0}$ 的拉奥分数检验统计量是\n$$\nS=\\frac{U(p_{0})^{2}}{I(p_{0})}.\n$$\n将 $U$ 和 $I$ 在 $p_{0}$ 处求值得到\n$$\nU(p_{0})=n\\left(\\frac{1}{p_{0}}-\\frac{\\bar{X}-1}{1-p_{0}}\\right)=\\frac{n\\left(1-p_{0}\\bar{X}\\right)}{p_{0}(1-p_{0})}, \\quad I(p_{0})=\\frac{n}{p_{0}^{2}(1-p_{0})}.\n$$\n因此，\n$$\nS=\\frac{\\left[\\frac{n\\left(1-p_{0}\\bar{X}\\right)}{p_{0}(1-p_{0})}\\right]^{2}}{\\frac{n}{p_{0}^{2}(1-p_{0})}}=n\\,\\frac{\\left(1-p_{0}\\bar{X}\\right)^{2}}{1-p_{0}}.\n$$\n在 $H_{0}$ 下，$S$ 渐近服从自由度为一的 $\\chi^{2}$ 分布。", "answer": "$$\\boxed{n\\,\\frac{\\left(1-p_{0}\\bar{X}\\right)^{2}}{1-p_{0}}}$$", "id": "1953900"}, {"introduction": "理论推导是基础，但将理论付诸实践同样重要。最后一个练习将我们的视野从离散分布扩展到连续分布，并引入了具体的数值计算。我们将探讨如何在经济学等领域应用分数检验来评估财富分配的帕累托（Pareto）模型 [@problem_id:1953913]。这个练习不仅要求你推导检验统计量，还需要你利用给定的样本数据计算出其具体数值，完整地走完一次假设检验的实际流程。", "problem": "经济学家正在研究某个特定国家的财富分配模型。他们使用帕累托I型分布(Pareto Type I distribution)来为个人的财富$X$（以百万美元为单位）建模。其概率密度函数(PDF)为 $f(x; \\alpha, x_m) = \\frac{\\alpha x_m^\\alpha}{x^{\\alpha+1}}$，其中 $x \\ge x_m > 0$。已知最小财富参数 $x_m$ 固定为 $x_m = 1$ 百万美元。决定财富不平等程度的形状参数 $\\alpha$ 是未知的。\n\n一种主流经济学理论提出，形状参数为 $\\alpha = 1.5$。为了检验这一理论，收集了一个包含 $n=100$ 个体的随机样本。该样本的数据得出的汇总统计量为 $\\sum_{i=1}^{100} \\ln(x_i) = 75$, 其中 $x_i$ 是样本中第 $i$ 个个体的财富。\n\n计算用于检验原假设 $H_0: \\alpha = 1.5$ 的拉奥分数检验(Rao's score test)统计量的值。将您的最终答案四舍五入到四位有效数字。", "solution": "对于一个已知 $x_{m}=1$ 的帕累托I型分布，其密度函数为 $f(x;\\alpha)=\\alpha x^{-(\\alpha+1)}$，其中 $x\\geq 1$。对于一个独立同分布(i.i.d.)样本 $\\{x_{i}\\}_{i=1}^{n}$，其对数似然函数为\n$$\n\\ell(\\alpha)=\\sum_{i=1}^{n}\\left[\\ln(\\alpha)-(\\alpha+1)\\ln(x_{i})\\right]\n= n\\ln(\\alpha)-(\\alpha+1)\\sum_{i=1}^{n}\\ln(x_{i}).\n$$\n分数函数(score function)为\n$$\nU(\\alpha)=\\frac{\\partial \\ell}{\\partial \\alpha}=\\frac{n}{\\alpha}-\\sum_{i=1}^{n}\\ln(x_{i}),\n$$\n而费雪信息(Fisher information)为\n$$\nI(\\alpha)=-\\mathbb{E}\\left[\\frac{\\partial^{2}\\ell}{\\partial \\alpha^{2}}\\right]\n=-\\mathbb{E}\\left[-\\frac{n}{\\alpha^{2}}\\right]=\\frac{n}{\\alpha^{2}}.\n$$\n用于检验 $H_{0}:\\alpha=\\alpha_{0}$ 的拉奥分数检验统计量为\n$$\nS=\\frac{U(\\alpha_{0})^{2}}{I(\\alpha_{0})}.\n$$\n当 $n=100$，$\\sum_{i=1}^{100}\\ln(x_{i})=75$ 且 $\\alpha_{0}=1.5$ 时，计算\n$$\nU(\\alpha_{0})=\\frac{100}{1.5}-75=\\frac{200}{3}-75=\\frac{200}{3}-\\frac{225}{3}=-\\frac{25}{3},\n$$\n以及\n$$\nI(\\alpha_{0})=\\frac{100}{(1.5)^{2}}=\\frac{100}{\\frac{9}{4}}=\\frac{400}{9}.\n$$\n因此，\n$$\nS=\\frac{\\left(-\\frac{25}{3}\\right)^{2}}{\\frac{400}{9}}=\\frac{\\frac{625}{9}}{\\frac{400}{9}}=\\frac{625}{400}=1.5625.\n$$\n四舍五入到四位有效数字，该检验统计量为 $1.563$。", "answer": "$$\\boxed{1.563}$$", "id": "1953913"}]}