{"hands_on_practices": [{"introduction": "理论学习的最佳方式莫过于实践。本节的第一个练习将带你从一个基础但至关重要的的问题入手。我们将为一个对数正态分布的参数构建一致最强检验（UMP test），当方差已知时，这个问题可以巧妙地转化为检验一个正态分布的均值。通过这个练习[@problem_id:1966299]，你将亲手计算检验的临界值，从而巩固UMP检验的基本构造方法，并将其与你可能已经熟悉的 $Z$ 检验联系起来。", "problem": "在一项环境科学研究中，一条河流中某种重金属污染物的浓度被认为服从对数正态分布。令随机变量 $X$ 表示该浓度。一个参数为 $\\mu$ 和 $\\sigma^2$ 的对数正态随机变量 $X$ 的概率密度函数 (PDF) 由下式给出：\n$$f(x; \\mu, \\sigma^2) = \\frac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(x) - \\mu)^2}{2\\sigma^2}\\right), \\quad \\text{for } x > 0$$\n其中 $\\mu$ 是该变量自然对数的均值，$\\sigma^2$ 是其方差。\n\n根据历史数据，已知方差参数稳定在 $\\sigma_0^2 = 4.0$。然而，最近该流域的工业活动被怀疑导致了污染物浓度中位数的增加，这对应于参数 $\\mu$ 的增加。为了检验这一怀疑，收集了一个容量为 $n=16$ 的随机水样。\n\n我们希望对参数 $\\mu$ 进行一次假设检验，显著性水平为 $\\alpha = 0.05$。原假设和备择假设设定如下：\n$$H_0: \\mu \\le 1.5$$\n$$H_1: \\mu > 1.5$$\n\n针对此问题的一致最强检验 (UMP) 的拒绝域形式为 $\\bar{Y} > c$，其中 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^{n} \\ln(X_i)$ 且 $c$ 是一个临界值。确定这个临界值 $c$ 的值。\n\n对于标准正态分布，您可以使用 $z=1.645$ 这一数值截取了分布最上方 5% 的近似值。请将最终答案表示为一个四舍五入到四位有效数字的数值。", "solution": "设 $X$ 是参数为 $(\\mu,\\sigma^{2})$ 的对数正态分布，因此 $Y=\\ln(X)$ 是正态分布，即 $Y \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。对于一个随机样本 $X_{1},\\dots,X_{n}$，定义 $Y_{i}=\\ln(X_{i})$，则 $Y_{i} \\stackrel{\\text{i.i.d.}}{\\sim} \\mathcal{N}(\\mu,\\sigma^{2})$。因此，样本均值 $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$ 服从正态分布\n$$\n\\bar{Y} \\sim \\mathcal{N}\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right).\n$$\n我们在显著性水平 $\\alpha=0.05$ 下，对 $H_{0}:\\mu \\le 1.5$ 和 $H_{1}:\\mu>1.5$ 进行检验，已知方差为 $\\sigma^{2}=\\sigma_{0}^{2}=4.0$，样本容量为 $n=16$。对于正态族中方差已知的单边检验，当 $\\bar{Y}$ 的值较大时，一致最强检验会拒绝原假设，其临界值 $c$ 的选取要使得在最不利情况 $\\mu=\\mu_{0}=1.5$ 下，\n$$\n\\mathbb{P}_{\\mu_{0}}\\!\\left(\\bar{Y}>c\\right)=\\alpha.\n$$\n标准化后，令\n$$\nZ=\\frac{\\bar{Y}-\\mu_{0}}{\\sigma/\\sqrt{n}} \\sim \\mathcal{N}(0,1)\\quad \\text{under } \\mu=\\mu_{0},\n$$\n于是条件变为\n$$\n\\mathbb{P}\\!\\left(Z>\\frac{c-\\mu_{0}}{\\sigma/\\sqrt{n}}\\right)=\\alpha.\n$$\n等价地，\n$$\n\\frac{c-\\mu_{0}}{\\sigma/\\sqrt{n}}=z_{1-\\alpha},\n$$\n其中 $z_{1-\\alpha}$ 是标准正态分布的 $(1-\\alpha)$ 分位数。于是，\n$$\nc=\\mu_{0}+z_{1-\\alpha}\\frac{\\sigma}{\\sqrt{n}}.\n$$\n使用 $\\mu_{0}=1.5$，$\\sigma=\\sqrt{4.0}=2$，$n=16$（因此 $\\sqrt{n}=4$），以及对于 $\\alpha=0.05$ 给定的近似值 $z_{1-\\alpha}=1.645$，我们得到\n$$\nc=1.5+1.645\\cdot \\frac{2}{4}=1.5+1.645\\cdot 0.5=1.5+0.8225=2.3225.\n$$\n四舍五入到四位有效数字，得出 $c=2.323$。", "answer": "$$\\boxed{2.323}$$", "id": "1966299"}, {"introduction": "在处理连续分布时，我们通常可以精确地达到任意指定的显著性水平 $\\alpha$。但当检验统计量服从像二项分布或泊松分布这样的离散分布时，情况会有所不同。这个练习[@problem_id:1966286]将引导你解决这个问题，通过构建一个随机化检验，来为一个二项分布的参数实现一个精确的显著性水平。这是一个重要的技巧，它揭示了在离散设定下，我们如何维持对第一类错误率的严格控制。", "problem": "一位质量控制工程师的任务是评估一个制造过程的次品率。从每一批非常大的组件中，随机抽取一个大小为 $n$ 的小样本进行检验。样本中发现的次品数量，用随机变量 $X$ 表示，被建模为二项分布，即 $X \\sim \\text{Binomial}(n, p)$，其中 $p$ 是该过程生产的次品的真实比例。\n\n该工程师希望检验原假设（即该过程处于可接受状态）$H_0: p \\le 0.5$，相对于备择假设（即该过程的次品率高到不可接受）$H_1: p > 0.5$。\n\n对于此检验，使用了一个大小为 $n=3$ 的样本。该工程师需要构建一个在精确显著性水平 $\\alpha = 0.2$ 下的一致最强（UMP）检验。由于检验统计量 $X$ 具有离散分布，要达到这个精确的显著性水平需要一个随机化检验。这种检验的结构由一个临界值 $c$ 和一个随机化概率 $\\gamma \\in [0, 1]$ 定义。决策规则如下：\n- 如果 $X > c$，拒绝原假设 $H_0$。\n- 如果 $X = c$，以概率 $\\gamma$ 拒绝原假设 $H_0$。\n- 如果 $X < c$，不拒绝原假设 $H_0$。\n\n基于此框架，确定此检验所需的随机化概率 $\\gamma$ 的具体值。请将您的答案表示为最简精确分数形式。", "solution": "我们将次品数建模为 $X \\sim \\text{Binomial}(n,p)$，其中 $n=3$。我们检验 $H_{0}: p \\leq \\frac{1}{2}$ 对 $H_{1}: p > \\frac{1}{2}$。对于二项数据的单边检验，该族在 $X$ 上具有单调似然比，因此根据 Karlin–Rubin 定理，显著性水平为 $\\alpha$ 的一致最强检验在 $X$ 值较大时拒绝原假设；在 $H_{0}$ 下的最不利值为 $p=\\frac{1}{2}$。因此，为达到精确显著性水平 $\\alpha=\\frac{1}{5}$，我们选择一个临界值 $c$ 和随机化概率 $\\gamma$ 使得\n$$\n\\sup_{p \\leq \\frac{1}{2}} \\Pr_{p}(\\text{reject})=\\Pr_{p=\\frac{1}{2}}(\\text{reject})=\\alpha=\\frac{1}{5}.\n$$\n因为当 $n=3$ 时 $X$ 是离散的，我们必须考虑上尾拒绝域。如果 $c=3$，那么在 $p=\\frac{1}{2}$ 下的拒绝概率最多为 $\\Pr(X=3 \\mid p=\\frac{1}{2})=\\frac{1}{8}$，这小于 $\\frac{1}{5}$；因此我们必须将 $X=2$ 通过随机化的方式包含在拒绝域中。因此取 $c=2$，这样检验在 $X=3$ 时总会拒绝，在 $X=2$ 时以概率 $\\gamma$ 拒绝。显著性水平的条件变为\n$$\n\\Pr_{p=\\frac{1}{2}}(\\text{reject})=\\Pr(X=3)+\\gamma\\,\\Pr(X=2)=\\alpha.\n$$\n对于 $X \\sim \\text{Binomial}(3,\\frac{1}{2})$，\n$$\n\\Pr(X=3)=\\binom{3}{3}\\left(\\frac{1}{2}\\right)^{3}=\\frac{1}{8}, \\qquad \\Pr(X=2)=\\binom{3}{2}\\left(\\frac{1}{2}\\right)^{3}=\\frac{3}{8}.\n$$\n施加精确显著性水平 $\\alpha=\\frac{1}{5}$ 的条件得到\n$$\n\\frac{1}{8}+\\gamma \\cdot \\frac{3}{8}=\\frac{1}{5}.\n$$\n解得，\n$$\n\\gamma=\\frac{\\frac{1}{5}-\\frac{1}{8}}{\\frac{3}{8}}=\\frac{\\frac{3}{40}}{\\frac{3}{8}}=\\frac{8}{40}=\\frac{1}{5}.\n$$\n因此所需的随机化概率为 $\\gamma=\\frac{1}{5}$。", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "1966286"}, {"introduction": "真实的统计问题往往比单样本检验更复杂，例如在A/B测试中比较两种方案的效果。这个练习[@problem_id:1966251]将我们带入一个更高级的场景：比较两个独立的泊松过程的率。这个问题的挑战在于存在一个“滋扰参数”（nuisance parameter），使得直接应用Karlin-Rubin定理变得困难。通过学习如何以总事件数为条件，我们将滋扰参数消除，从而将一个复杂的双样本问题简化为一个我们已经知道如何解决的单参数问题。这个强大的条件化方法是构建UMP检验的关键工具之一。", "problem": "在在线广告的背景下，一家公司在固定的相同时间段内对两个不同的广告活动（活动 A 和活动 B）进行 A/B 测试。每个活动产生的用户点击次数可以建模为独立的泊松过程。设 $X_A$ 为来自活动 A 的点击次数，假定其为服从均值为 $\\lambda_A$ 的泊松分布的随机变量。类似地，设 $X_B$ 为来自活动 B 的点击次数，服从均值为 $\\lambda_B$ 的泊松分布。两个随机变量 $X_A$ 和 $X_B$ 是独立的。\n\n该公司希望确定活动 A 是否显著优于活动 B。这可以被构建为一个关于点击率之比 $\\theta = \\lambda_A / \\lambda_B$ 的假设检验。原假设是活动 A 不比活动 B 更有效，$H_0: \\theta \\le 1$，备择假设是活动 A 更有效，$H_1: \\theta > 1$。\n\n设 $x_A$ 和 $x_B$ 分别是每个活动观察到的点击次数，总点击次数为 $s = x_A + x_B$。您的任务是确定检验水平为 $\\alpha$ 的一致最强 (UMP) 检验。\n\n对于 $H_0: \\lambda_A/\\lambda_B \\le 1$ 与 $H_1: \\lambda_A/\\lambda_B > 1$ 的检验水平为 $\\alpha$ 的 UMP 检验，以下哪项描述了其拒绝域？\n\nA. 如果 $x_A > k_s$ 则拒绝 $H_0$，其中临界值 $k_s$ 取决于总数 $s$，并根据二项分布选择以满足检验水平约束。\n\nB. 如果 $s > k$ 则拒绝 $H_0$，其中临界值 $k$ 是一个常数，根据泊松分布选择以满足检验水平约束。\n\nC. 如果比率 $x_A / x_B > k$ 则拒绝 $H_0$，其中临界值 $k$ 是一个常数，根据 F 分布选择以满足检验水平约束。\n\nD. 如果 $x_A < k_s$ 则拒绝 $H_0$，其中临界值 $k_s$ 取决于总数 $s$，并根据二项分布选择以满足检验水平约束。\n\nE. 如果 $x_A - x_B > k$ 则拒绝 $H_0$，其中临界值 $k$ 是一个常数，根据正态分布选择以满足检验水平约束。", "solution": "设 $X_A \\sim \\text{Poisson}(\\lambda_A)$ 和 $X_B \\sim \\text{Poisson}(\\lambda_B)$ 是独立的随机变量。$(X_A, X_B)$ 对观测值 $(x_A, x_B)$ 的联合概率质量函数 (PMF) 由下式给出：\n$$ P(X_A=x_A, X_B=x_B; \\lambda_A, \\lambda_B) = \\frac{e^{-\\lambda_A}\\lambda_A^{x_A}}{x_A!} \\frac{e^{-\\lambda_B}\\lambda_B^{x_B}}{x_B!} $$\n这可以写成：\n$$ f(x_A, x_B; \\lambda_A, \\lambda_B) = \\frac{1}{x_A! x_B!} \\exp\\left(x_A \\ln(\\lambda_A) + x_B \\ln(\\lambda_B) - (\\lambda_A+\\lambda_B)\\right) $$\n这是一个双参数指数族，具有二维充分统计量 $(X_A, X_B)$。假设是关于参数 $\\theta = \\lambda_A / \\lambda_B$。这是一个带有讨厌参数（例如 $\\lambda_A + \\lambda_B$）的复合假设。为了推导 UMP 检验，我们可以使用以讨厌参数的充分统计量为条件的方法。设 $S = X_A + X_B$。$S$ 的分布是均值为 $\\lambda_A + \\lambda_B$ 的泊松分布，因为独立泊松随机变量之和也是一个泊松随机变量。\n\n我们来求在给定 $S=s$ 的条件下 $X_A$ 的条件分布。对于 $x_A = 0, 1, \\dots, s$：\n$$ P(X_A=x_A | S=s) = \\frac{P(X_A=x_A, X_A+X_B=s)}{P(X_A+X_B=s)} = \\frac{P(X_A=x_A, X_B=s-x_A)}{P(S=s)} $$\n利用 $X_A$ 和 $X_B$ 的独立性：\n$$ P(X_A=x_A | S=s) = \\frac{\\frac{e^{-\\lambda_A}\\lambda_A^{x_A}}{x_A!} \\frac{e^{-\\lambda_B}\\lambda_B^{s-x_A}}{(s-x_A)!}}{\\frac{e^{-(\\lambda_A+\\lambda_B)}(\\lambda_A+\\lambda_B)^s}{s!}} $$\n$$ = \\frac{s!}{x_A!(s-x_A)!} \\frac{e^{-(\\lambda_A+\\lambda_B)}\\lambda_A^{x_A}\\lambda_B^{s-x_A}}{e^{-(\\lambda_A+\\lambda_B)}(\\lambda_A+\\lambda_B)^s} $$\n$$ = \\binom{s}{x_A} \\frac{\\lambda_A^{x_A}\\lambda_B^{s-x_A}}{(\\lambda_A+\\lambda_B)^s} = \\binom{s}{x_A} \\left(\\frac{\\lambda_A}{\\lambda_A+\\lambda_B}\\right)^{x_A} \\left(\\frac{\\lambda_B}{\\lambda_A+\\lambda_B}\\right)^{s-x_A} $$\n这是二项分布的 PMF，$X_A | (S=s) \\sim \\text{Binomial}(s, p)$，其中成功概率为 $p = \\frac{\\lambda_A}{\\lambda_A+\\lambda_B}$。\n\n现在，我们用 $p$ 来重新参数化假设。设 $\\theta = \\lambda_A / \\lambda_B$。\n$$ p = \\frac{\\lambda_A}{\\lambda_A+\\lambda_B} = \\frac{\\lambda_A/\\lambda_B}{(\\lambda_A/\\lambda_B) + 1} = \\frac{\\theta}{\\theta+1} $$\n函数 $g(\\theta) = \\frac{\\theta}{\\theta+1}$ 是关于 $\\theta$ 的严格增函数（对于 $\\theta > 0$）。因此，原假设检验等价于一个关于 $p$ 的检验。\n$H_0: \\theta \\le 1 \\iff p \\le \\frac{1}{1+1} = \\frac{1}{2}$\n$H_1: \\theta > 1 \\iff p > \\frac{1}{2}$\n\n问题现在简化为，为一个服从二项分布 $\\text{Binomial}(s, p)$（以观测到的总数 $s$ 为条件）的随机变量 $X_A$ 寻找一个关于 $H_0: p \\le 1/2$ 与 $H_1: p > 1/2$ 的 UMP 检验。该分布的 PMF $f(x_A; p) = \\binom{s}{x_A} p^{x_A} (1-p)^{s-x_A}$ 属于一个单参数指数族，其充分统计量为 $T(X_A) = X_A$。对于任何 $p_2 > p_1$，似然比都是 $X_A$ 的增函数。\n\n根据 Karlin-Rubin 定理，对于这个单边假设，存在一个检验水平为 $\\alpha$ 的 UMP 检验，其拒绝域形式为 $\\{x_A : x_A > k_s\\}$。临界值 $k_s$ 是在给定总数 $s$ 的情况下选择的，以满足检验水平约束：\n$$ \\sup_{p \\le 1/2} P_p(X_A > k_s | S=s) = P_{p=1/2}(X_A > k_s | S=s) \\le \\alpha $$\n等式成立是因为功效函数是 $p$ 的增函数。因此，对于给定的观测总数 $s=x_A+x_B$，如果观测到的计数 $x_A$ 大于某个临界值 $k_s$，则检验拒绝 $H_0$。该临界值由原假设下的分布，即 $\\text{Binomial}(s, 1/2)$，来确定。\n\n这与选项 A 一致。\n- 选项 B 检验的是总速率 $\\lambda_A+\\lambda_B$，而不是比率。\n- 选项 C 是一个直观但不正确的检验统计量形式，F 分布用于正态总体方差之比，而非泊松均值之比。\n- 选项 D 描述了针对备择假设 $H_1: \\lambda_A/\\lambda_B  1$ 的检验。\n- 选项 E 使用的统计量也不是 UMP 检验统计量，并且正态近似只是一种近似，而不是精确的 UMP 检验。", "answer": "$$\\boxed{A}$$", "id": "1966251"}]}