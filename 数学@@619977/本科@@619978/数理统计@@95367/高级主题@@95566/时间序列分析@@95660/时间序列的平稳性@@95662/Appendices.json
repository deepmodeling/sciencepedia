{"hands_on_practices": [{"introduction": "我们从一个基本问题开始：对数据进行简单的日常调整会如何影响其底层特性？本练习探讨了最基本的变换——加上一个常数值。通过检验一个简单的数值平移如何影响一个时间序列的均值、方差和自协方差，你将对平稳性这一属性的稳健性建立起基础的理解。[@problem_id:1964359]", "problem": "一位数据科学家正在分析一个代表某产品每日销售额波动的时间序列。设真实的、潜在的销售额波动过程用 $\\{X_t\\}$ 表示，其中 $t$ 是以天为单位的时间。已知过程 $\\{X_t\\}$ 是**弱平稳的**。如果一个时间序列 $\\{Z_t\\}$ 对于所有有效的时间指数 $t$ 和 $s$ 满足以下三个条件，则称其为弱平稳的：\n1. 均值为有限常数：$\\mathbb{E}[Z_t] = \\mu$。\n2. 方差为有限的非零常数：$\\text{Var}(Z_t) = \\sigma^2$。\n3. 任意两点之间的自协方差仅取决于它们之间的时滞：$\\text{Cov}(Z_t, Z_s) = \\gamma(|t-s|)$。\n\n由于一个固定的季节性促销活动，观察到的每日销售数据存在一个恒定的正向偏移。这个新的观测时间序列被建模为 $Y_t = X_t + c$，其中 $c$ 是一个非零实数常数，代表由促销带来的平均销售增长。\n\n根据所提供的信息，以下哪个陈述正确地描述了过程 $\\{Y_t\\}$？\n\nA. $Y_t$ 是弱平稳的。\n\nB. $Y_t$ 不是平稳的，因为其均值取决于时间 $t$。\n\nC. $Y_t$ 不是平稳的，因为其方差取决于时间 $t$。\n\nD. $Y_t$ 不是平稳的，因为其自协方差函数取决于具体的时间点 $t$ 和 $s$，而不仅仅是它们的时滞。\n\nE. $Y_t$ 不可能是弱平稳的，因为常数 $c$ 非零。", "solution": "要判断过程 $Y_t = X_t + c$ 是否为弱平稳的，我们必须在已知 $X_t$ 是一个弱平稳过程的情况下，检查它是否满足弱平稳的三个条件。\n\n弱平稳过程 $X_t$ 的性质如下：\n- $\\mathbb{E}[X_t] = \\mu_X$，其中 $\\mu_X$ 是一个常数。\n- $\\text{Var}(X_t) = \\sigma_X^2$，其中 $\\sigma_X^2$ 是一个有限常数。\n- $\\text{Cov}(X_t, X_s) = \\gamma_X(|t-s|)$，一个仅与时滞 $|t-s|$ 相关的函数。\n\n现在，我们来分析过程 $Y_t = X_t + c$。\n\n**条件1：$Y_t$ 的均值**\n我们利用期望算子的线性性质来计算 $Y_t$ 的期望值。\n$$ \\mathbb{E}[Y_t] = \\mathbb{E}[X_t + c] $$\n$$ \\mathbb{E}[Y_t] = \\mathbb{E}[X_t] + \\mathbb{E}[c] $$\n因为 $c$ 是一个常数，其期望值就是 $c$。我们已知 $\\mathbb{E}[X_t] = \\mu_X$。\n$$ \\mathbb{E}[Y_t] = \\mu_X + c $$\n令 $\\mu_Y = \\mu_X + c$。因为 $\\mu_X$ 和 $c$ 都是常数，所以它们的和 $\\mu_Y$ 也是一个常数。$Y_t$ 的均值不依赖于时间 $t$。因此，满足了弱平稳的第一个条件。这排除了选项 B。\n\n**条件2：$Y_t$ 的方差**\n我们计算 $Y_t$ 的方差。方差的一个关键性质是，给一个随机变量加上一个常数不会改变其方差，即对于任意随机变量 $Z$ 和常数 $k$，有 $\\text{Var}(Z+k) = \\text{Var}(Z)$。\n$$ \\text{Var}(Y_t) = \\text{Var}(X_t + c) $$\n$$ \\text{Var}(Y_t) = \\text{Var}(X_t) $$\n因为 $X_t$ 是弱平稳的，其方差是一个常数 $\\sigma_X^2$。\n$$ \\text{Var}(Y_t) = \\sigma_X^2 $$\n$Y_t$ 的方差是一个有限常数，且不依赖于时间 $t$。因此，满足了第二个条件。这排除了选项 C。\n\n**条件3：$Y_t$ 的自协方差**\n我们计算 $Y_t$ 在时间 $t$ 和时间 $s$ 之间的自协方差。协方差的一个关键性质是它对常数偏移的不变性，即对于随机变量 $A, B$ 和常数 $a, b$，有 $\\text{Cov}(A+a, B+b) = \\text{Cov}(A,B)$。\n$$ \\text{Cov}(Y_t, Y_s) = \\text{Cov}(X_t + c, X_s + c) $$\n$$ \\text{Cov}(Y_t, Y_s) = \\text{Cov}(X_t, X_s) $$\n因为 $X_t$ 是弱平稳的，其自协方差仅取决于时滞 $|t-s|$。\n$$ \\text{Cov}(Y_t, Y_s) = \\gamma_X(|t-s|) $$\n令 $\\gamma_Y(k) = \\gamma_X(k)$，其中 $k = |t-s|$。$Y_t$ 的自协方差仅取决于时滞 $k$，而不取决于具体的时间 $t$ 和 $s$。因此，满足了第三个条件。这排除了选项 D。\n\n**结论**\n过程 $Y_t$ 满足弱平稳的所有三个条件：其均值为常数，方差为常数，且其自协方差函数仅取决于时滞。因此，$Y_t$ 是一个弱平稳过程。$c$ 非零这一事实只是平移了过程的均值，但并不影响其平稳性，所以选项 E 是错误的。正确的陈述是 $Y_t$ 是弱平稳的。", "answer": "$$\\boxed{A}$$", "id": "1964359"}, {"introduction": "平稳性要求其所有条件必须同时得到满足。本练习设计了一个巧妙的场景，其中一些统计特性（如方差）看起来是恒定的，可能会误导分析师。通过仔细剖析一个均值随时间周期性变化的序列，你将学会严格验证弱平稳性每个条件的重要性，并避免落入常见的分析陷阱。[@problem_id:1964357]", "problem": "考虑一个为所有整数 $t$ 定义的时间序列过程 $X_t$。该过程基于一个潜在的白噪声过程 $\\epsilon_t$ 构建。白噪声过程是一系列独立同分布的随机变量，其均值为 $E[\\epsilon_t] = 0$，方差为一个恒定的有限值 $Var(\\epsilon_t) = \\sigma^2 > 0$。\n\n过程 $X_t$ 的定义如下：\n$$\nX_t = \\begin{cases}\n\\epsilon_t & \\text{若 } t \\text{ 为偶数} \\\\\n10 + \\epsilon_t & \\text{若 } t \\text{ 为奇数}\n\\end{cases}\n$$\n\n一个时间序列过程被认为是弱平稳（或协方差平稳）的，如果它满足以下三个条件：\n1.  均值 $E[X_t]$ 是一个不依赖于时间 $t$ 的常数。\n2.  方差 $Var(X_t)$ 是一个不依赖于时间 $t$ 的常数。\n3.  对于任意滞后 $h \\neq 0$，自协方差 $Cov(X_t, X_{t-h})$ 仅取决于滞后 $h$ 而不取决于时间 $t$。\n\n下列哪个陈述准确地描述了过程 $X_t$ 的平稳性？\n\nA. 该过程是弱平稳的。\n\nB. 仅满足条件1。\n\nC. 仅满足条件2。\n\nD. 仅满足条件1和3。\n\nE. 仅满足条件2和3。\n\nF. 三个条件均不满足。", "solution": "我们分析由 $t$ 为偶数时 $X_{t}=\\epsilon_{t}$ 和 $t$ 为奇数时 $X_{t}=10+\\epsilon_{t}$ 定义的 $X_t$ 的三个弱平稳性条件，其中 $\\{\\epsilon_{t}\\}$ 是白噪声，满足 $E[\\epsilon_{t}]=0$ 和 $\\operatorname{Var}(\\epsilon_{t})=\\sigma^{2}$，且 $\\epsilon_{t}$ 在时间上是独立的。\n\n1) 均值：根据期望的线性性质，以及加上一个常数会使均值发生位移，我们有\n$$\nE[X_{t}] =\n\\begin{cases}\nE[\\epsilon_{t}]=0 & \\text{若 $t$ 为偶数} \\\\\nE[10+\\epsilon_{t}]=10+E[\\epsilon_{t}]=10 & \\text{若 $t$ 为奇数}\n\\end{cases}\n$$\n因此 $E[X_{t}]$ 依赖于 $t$（在 $0$ 和 $10$ 之间交替），所以条件1不成立。\n\n2) 方差：使用对于任意常数 $a$ 都有 $\\operatorname{Var}(a+Y)=\\operatorname{Var}(Y)$ 的性质，我们得到\n$$\n\\operatorname{Var}(X_{t}) =\n\\begin{cases}\n\\operatorname{Var}(\\epsilon_{t})=\\sigma^{2} & \\text{若 $t$ 为偶数} \\\\\n\\operatorname{Var}(10+\\epsilon_{t})=\\operatorname{Var}(\\epsilon_{t})=\\sigma^{2} & \\text{若 $t$ 为奇数}\n\\end{cases}\n$$\n因此，对于所有的 $t$，$\\operatorname{Var}(X_{t})=\\sigma^{2}$，所以条件2成立。\n\n3) 自协方差：对于 $h\\neq 0$，利用协方差的双线性性质、对于常数 $a$ 有 $\\operatorname{Cov}(a,Y)=0$ 以及白噪声在时间上的独立性，我们有\n$$\n\\operatorname{Cov}(X_{t},X_{t-h})\n=\\operatorname{Cov}(\\mu_{t}+\\epsilon_{t},\\,\\mu_{t-h}+\\epsilon_{t-h})\n=\\operatorname{Cov}(\\epsilon_{t},\\epsilon_{t-h})\n$$\n其中 $\\mu_{t}\\in\\{0,10\\}$ 是确定性的位移。因为当 $h\\neq 0$ 时 $\\epsilon_{t}$ 和 $\\epsilon_{t-h}$ 是独立的，所以 $\\operatorname{Cov}(\\epsilon_{t},\\epsilon_{t-h})=0$。因此，当 $h\\neq 0$ 时，对于所有的 $t$，$\\operatorname{Cov}(X_{t},X_{t-h})=0$，这只取决于 $h$ 而不取决于 $t$。因此条件3成立。为了完整起见，当 $h=0$ 时，自协方差为 $\\operatorname{Var}(X_{t})=\\sigma^{2}$，正如在条件2中所示，它也与 $t$ 无关。\n\n结论：仅满足条件2和3。", "answer": "$$\\boxed{E}$$", "id": "1964357"}, {"introduction": "本练习将我们的视角从验证平稳性转向理解其在系统动态中的起源，从而将时间序列分析与随机过程理论联系起来。你将分析一个双状态马尔可夫链，这是描述系统在不同状态间切换的一个基本模型。这个问题挑战你从过程的转移规则本身推导出其统计特性，并理解平稳分布的概念如何确保其生成的时间序列是弱平稳的。[@problem_id:1964404]", "problem": "一个离散时间随机过程 $\\{X_t\\}_{t=0,1,2,...}$ 在集合 $S = \\{-1, 1\\}$ 中取值。该过程的演化由一个时齐马尔可夫链决定，其转移概率如下：\n- 在一个时间步长内，从状态 $-1$ 转移到状态 $1$ 的概率记为 $p$。\n- 在一个时间步长内，从状态 $1$ 转移到状态 $-1$ 的概率记为 $q$。\n\n参数 $p$ 和 $q$ 是满足 $0 < p < 1$ 和 $0 < q < 1$ 的常数。已知该过程是弱平稳的，这意味着其统计特性（如均值和方差）不随时间改变。这是通过确保初始状态 $X_0$ 是从该马尔可夫链的平稳分布中抽样得到的。\n\n观测到该过程滞后为1的自相关 $\\rho(1) = \\frac{\\mathrm{Cov}(X_t, X_{t+1})}{\\mathrm{Var}(X_t)}$ 的值为 $0.6$。\n\n根据这些信息，确定和 $p+q$ 的值。", "solution": "设转移概率如题所给，平稳分布为 $\\pi_{+}=\\mathbb{P}(X_{t}=1)$ 和 $\\pi_{-}=\\mathbb{P}(X_{t}=-1)$。平稳性要求 $\\pi_{-}p=\\pi_{+}q$，因此\n$$\n\\pi_{+}=\\frac{p}{p+q},\\qquad \\pi_{-}=\\frac{q}{p+q}.\n$$\n均值为：\n$$\nm=\\mathbb{E}[X_{t}]=1\\cdot \\pi_{+}+(-1)\\cdot \\pi_{-}=\\frac{p-q}{p+q}\n$$\n又因为 $X_{t}^{2}=1$，方差为：\n$$\n\\mathrm{Var}(X_{t}) = E[X_t^2] - m^2=1-m^{2}=1-\\left(\\frac{p-q}{p+q}\\right)^{2}=\\frac{4pq}{(p+q)^{2}}\n$$\n接下来，使用条件期望计算 $\\mathbb{E}[X_{t+1}\\mid X_{t}]$：\n$$\n\\mathbb{E}[X_{t+1}\\mid X_{t}=1]=1\\cdot(1-q)+(-1)\\cdot q=1-2q\n$$\n$$\n\\mathbb{E}[X_{t+1}\\mid X_{t}=-1]=1\\cdot p+(-1)\\cdot(1-p)=2p-1\n$$\n因此，我们有：\n$$\n\\mathbb{E}[X_{t}X_{t+1}] = \\mathbb{E}[X_t \\mathbb{E}[X_{t+1} | X_t]] = \\pi_+(1 \\cdot (1-2q)) + \\pi_-(-1 \\cdot (2p-1)) = \\frac{p(1-2q) - q(2p-1)}{p+q} = \\frac{p+q-4pq}{p+q}\n$$\n协方差为：\n$$\n\\mathrm{Cov}(X_{t},X_{t+1}) = \\mathbb{E}[X_{t}X_{t+1}] - m^{2} = \\frac{p+q-4pq}{p+q} - \\left(\\frac{p-q}{p+q}\\right)^{2} = \\frac{4pq(1-p-q)}{(p+q)^{2}}\n$$\n因此，滞后为1的自相关为：\n$$\n\\rho(1)=\\frac{\\mathrm{Cov}(X_{t},X_{t+1})}{\\mathrm{Var}(X_{t})}=1-p-q\n$$\n已知 $\\rho(1)=0.6$，我们得到：\n$$\n1-p-q=0.6\\quad\\Rightarrow\\quad p+q=0.4\n$$", "answer": "$$\\boxed{0.4}$$", "id": "1964404"}]}