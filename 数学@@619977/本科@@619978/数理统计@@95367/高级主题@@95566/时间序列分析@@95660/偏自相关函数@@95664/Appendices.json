{"hands_on_practices": [{"introduction": "理解偏自相关函数（PACF）的第一步是掌握其计算方法。这个练习将引导你运用 Durbin-Levinson 递推公式，从给定的自相关函数（ACF）值计算出 PACF 值。这不仅是一次数值计算，更是深入理解 ACF 和 PACF 之间内在联系的关键实践。", "problem": "在平稳时间序列的分析中，自相关函数 (ACF) 和偏自相关函数 (PACF) 是识别数据潜在结构的基本工具。对于一个给定的平稳过程，设 $\\rho(k)$ 表示滞后 $k$ 阶的理论自相关函数，它衡量相隔 $k$ 个时间步长的观测值之间的相关性。设 $\\phi_{kk}$ 表示滞后 $k$ 阶的理论偏自相关函数，它衡量在剔除了中间观测值的线性影响后，相隔 $k$ 个时间步长的观测值之间的相关性。\n\n假设一个平稳时间序列的理论自相关函数值为 $\\rho(1) = 0.8$ 和 $\\rho(2) = 0.5$。计算其滞后 2 阶的理论偏自相关函数值，记为 $\\phi_{22}$。将你的最终答案四舍五入到四位有效数字。", "solution": "我们使用关联理论自相关函数 $\\rho(k)$ 和偏自相关函数 $\\phi_{kk}$ 的 Durbin–Levinson 递归。对于 $k=1$，\n$$\n\\phi_{11}=\\rho(1).\n$$\n对于 $k=2$，递归给出\n$$\n\\phi_{22}=\\frac{\\rho(2)-\\phi_{11}\\rho(1)}{1-\\phi_{11}\\rho(1)}.\n$$\n代入 $\\phi_{11}=\\rho(1)$ 可得\n$$\n\\phi_{22}=\\frac{\\rho(2)-\\rho(1)^{2}}{1-\\rho(1)^{2}}.\n$$\n使用给定值 $\\rho(1)=0.8$ 和 $\\rho(2)=0.5$，\n$$\n\\phi_{22}=\\frac{0.5-0.8^{2}}{1-0.8^{2}}=\\frac{0.5-0.64}{1-0.64}=\\frac{-0.14}{0.36}=-\\frac{7}{18}\\approx -0.388888\\ldots\n$$\n四舍五入到四位有效数字得到 $-0.3889$。", "answer": "$$\\boxed{-0.3889}$$", "id": "1943287"}, {"introduction": "PACF 在模型识别中最重要的特性之一是其对自回归（AR）过程的“截尾”行为。本练习将通过一个二阶自回归 $AR(2)$ 模型来具体展示这一特性。你将发现，$AR(p)$ 模型的理论 PACF 在滞后 $p$ 阶之后会变为零，这个练习能让你亲身体会到为何 PACF 是识别 AR 模型阶数的有力工具。", "problem": "考虑一个平稳的二阶自回归 (AR) 模型，记为 AR(2)，该模型由以下针对时间序列 $\\{X_t\\}$ 的方程定义：\n$$X_t = 0.5 X_{t-1} - 0.3 X_{t-2} + \\epsilon_t$$\n其中，$\\{\\epsilon_t\\}$ 是一个白噪声过程，这意味着其元素是独立同分布的随机变量，均值为零，方差为常数 $\\sigma^2_\\epsilon$。\n\n确定该过程在滞后阶数为 2 时的理论偏自相关函数 (PACF) 的精确值。滞后阶数为 $k$ 时的 PACF 通常记为 $\\phi_{kk}$。要求您求出 $\\phi_{22}$ 的值。", "solution": "我们将给定的过程重写为标准 AR(2) 形式：\n$$\nX_{t}=\\phi_{1}X_{t-1}+\\phi_{2}X_{t-2}+\\epsilon_{t},\n$$\n其中 $\\phi_{1}=0.5$ 且 $\\phi_{2}=-0.3$，而 $\\{\\epsilon_{t}\\}$ 是方差为 $\\sigma_{\\epsilon}^{2}$ 的白噪声。\n\n滞后阶数为 2 时的理论偏自相关记为 $\\phi_{22}$，其定义为基于 $X_{t-1}$ 和 $X_{t-2}$ 对 $X_t$ 进行最佳线性预测时 $X_{t-2}$ 的系数。也就是说，$\\phi_{22}$ 等于能使 $E[u_{t}^{2}]$ 最小化的线性投影\n$$\nX_{t}=\\beta_{1}X_{t-1}+\\beta_{2}X_{t-2}+u_{t},\n$$\n中的值 $\\beta_{2}$。此投影的正规方程为\n$$\nE\\big[X_{t-1}(X_{t}-\\beta_{1}X_{t-1}-\\beta_{2}X_{t-2})\\big]=0,\\quad E\\big[X_{t-2}(X_{t}-\\beta_{1}X_{t-1}-\\beta_{2}X_{t-2})\\big]=0,\n$$\n令 $\\gamma(h)=\\operatorname{Cov}(X_{t},X_{t-h})$，则方程变为\n$$\n\\gamma(1)=\\beta_{1}\\gamma(0)+\\beta_{2}\\gamma(1),\\qquad \\gamma(2)=\\beta_{1}\\gamma(1)+\\beta_{2}\\gamma(0).\n$$\n以矩阵形式表示，\n$$\n\\begin{pmatrix}\n\\gamma(0) & \\gamma(1)\\\\\n\\gamma(1) & \\gamma(0)\n\\end{pmatrix}\n\\begin{pmatrix}\n\\beta_{1}\\\\\n\\beta_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\gamma(1)\\\\\n\\gamma(2)\n\\end{pmatrix}.\n$$\n\n对于 AR(2) 模型，当 $h=1,2$ 时，Yule–Walker 方程为：\n$$\n\\gamma(1)=\\phi_{1}\\gamma(0)+\\phi_{2}\\gamma(1),\\qquad \\gamma(2)=\\phi_{1}\\gamma(1)+\\phi_{2}\\gamma(0).\n$$\n这些方程与将 $(\\beta_{1},\\beta_{2})$ 替换为 $(\\phi_{1},\\phi_{2})$ 后的正规方程相同。在平稳性条件下，自协方差矩阵是正定的，因此是可逆的，所以正规方程的解是唯一的。因此，\n$$\n\\beta_{1}=\\phi_{1},\\qquad \\beta_{2}=\\phi_{2}.\n$$\n根据滞后阶数为 2 时的 PACF 的定义，$\\phi_{22}=\\beta_{2}=\\phi_{2}$。代入给定的系数可得\n$$\n\\phi_{22}=-0.3.\n$$", "answer": "$$\\boxed{-0.3}$$", "id": "1943263"}, {"introduction": "与 AR 模型不同，移动平均（MA）模型的 PACF 呈现出“拖尾”而非“截尾”的特征。这个练习让你为一阶移动平均 $MA(1)$ 模型推导其 PACF 的表达式。通过与前一个 AR 模型的练习对比，你将能更清晰地辨别 AR 和 MA 过程在 PACF 图上的典型模式，这对于混合模型（ARMA）的分析至关重要。", "problem": "在一次质量控制分析中，一个制造产品每日偏离目标重量的偏差被建模为一个平稳时间序列 $\\{X_t\\}$。一位分析师提出，该序列可以用一阶移动平均 MA(1) 模型来描述：\n$$ X_t = \\epsilon_t + \\theta \\epsilon_{t-1} $$\n其中 $\\{\\epsilon_t\\}$ 是一个白噪声过程（一个均值为零、方差恒为 $\\sigma^2_\\epsilon$ 的不相关随机变量序列），$\\theta$ 是模型参数，满足 $|\\theta|<1$。\n\n自相关函数 (ACF) $\\rho(k)$ 和偏自相关函数 (PACF) $\\phi_{kk}$ 是识别和验证时间序列模型的主要工具。对于所提出的 MA(1) 过程，已知其在滞后 $k=1$ 时的自相关函数为 $\\rho(1) = \\frac{\\theta}{1+\\theta^2}$，而在所有后续滞后上的自相关函数均为零，即对于所有整数 $k \\ge 2$，有 $\\rho(k)=0$。\n\n基于这些信息，确定此 MA(1) 过程在滞后 2 时的偏自相关函数 (PACF) 的理论值，记为 $\\phi_{22}$。请用参数 $\\theta$ 的单个符号表达式来表示你的答案。", "solution": "对于一个自相关函数为 $\\rho(k)$ 的平稳过程，其偏自相关系数 $\\{\\phi_{kk}\\}$ 可以通过 Durbin–Levinson 递推得到。具体来说，\n$$\n\\phi_{11}=\\rho(1), \\quad \\text{且对于 } k\\ge 2,\\quad \\phi_{kk}=\\frac{\\rho(k)-\\sum_{j=1}^{k-1}\\phi_{k-1,j}\\,\\rho(k-j)}{1-\\sum_{j=1}^{k-1}\\phi_{k-1,j}\\,\\rho(j)}.\n$$\n对于给定的 MA(1) 模型，$\\rho(1)=\\frac{\\theta}{1+\\theta^{2}}$ 且对于所有整数 $k\\ge 2$ 有 $\\rho(k)=0$。应用 $k=2$ 时的递推公式，我们使用 $\\phi_{11}=\\rho(1)$ 并得到\n$$\n\\phi_{22}=\\frac{\\rho(2)-\\phi_{11}\\rho(1)}{1-\\phi_{11}\\rho(1)}=\\frac{0-\\rho(1)^{2}}{1-\\rho(1)^{2}}=-\\frac{\\rho(1)^{2}}{1-\\rho(1)^{2}}.\n$$\n代入 $\\rho(1)=\\frac{\\theta}{1+\\theta^{2}}$ 可得\n$$\n\\rho(1)^{2}=\\frac{\\theta^{2}}{(1+\\theta^{2})^{2}}, \\quad 1-\\rho(1)^{2}=\\frac{(1+\\theta^{2})^{2}-\\theta^{2}}{(1+\\theta^{2})^{2}}=\\frac{1+\\theta^{2}+\\theta^{4}}{(1+\\theta^{2})^{2}}.\n$$\n因此，\n$$\n\\phi_{22}=-\\frac{\\dfrac{\\theta^{2}}{(1+\\theta^{2})^{2}}}{\\dfrac{1+\\theta^{2}+\\theta^{4}}{(1+\\theta^{2})^{2}}}=-\\frac{\\theta^{2}}{1+\\theta^{2}+\\theta^{4}}.\n$$", "answer": "$$\\boxed{-\\frac{\\theta^{2}}{1+\\theta^{2}+\\theta^{4}}}$$", "id": "1943283"}]}