{"hands_on_practices": [{"introduction": "Cox模型最核心的应用之一是量化不同组别之间的风险差异。风险比（Hazard Ratio, HR）是解释模型结果的关键指标。本练习旨在帮助你掌握最基本的技能：将模型估计出的系数 $\\beta$ 转换为直观易懂的风险比，并理解其在实际情境中的含义 [@problem_id:1911775]。", "problem": "在一项针对新型心血管药物“Cor-Stabil”的临床试验中，研究人员使用Cox比例风险模型来分析发生主要不良心脏事件的时间。该模型旨在评估药物的有效性，同时控制患者年龄的影响。\n\n患者的风险函数由以下模型给出：\n$$h(t | X_1, X_2) = h_0(t) \\exp(\\beta_1 X_1 + \\beta_2 X_2)$$\n此处，$h_0(t)$是基线风险函数。协变量为：\n- $X_1$：治疗组，一个二元变量，其中接受“Cor-Stabil”治疗的患者$X_1 = 1$，而安慰剂组的患者$X_1 = 0$。\n- $X_2$：研究开始时患者的年龄（以岁为单位），一个连续变量。\n\n分析数据后，估计的系数为 $\\beta_1 = \\ln(0.65)$ 和 $\\beta_2 = 0.03$。\n\n假设正在比较的两名患者年龄相同，计算服用“Cor-Stabil”的患者相对于服用安慰剂的患者的风险比。将您的答案表示为小数。", "solution": "Cox模型将时间 $t$ 时的风险函数定义为 $h(t \\mid X_{1}, X_{2}) = h_{0}(t)\\exp(\\beta_{1}X_{1} + \\beta_{2}X_{2})$。比较一名服用“Cor-Stabil”的患者（$X_{1}=1$）与一名同龄的服用安慰剂的患者（$X_{1}=0$）（因此两者的$X_2$相等）的风险比为\n$$\n\\text{HR} = \\frac{h(t \\mid X_{1}=1, X_{2}=a)}{h(t \\mid X_{1}=0, X_{2}=a)} = \\frac{h_{0}(t)\\exp(\\beta_{1}\\cdot 1 + \\beta_{2}a)}{h_{0}(t)\\exp(\\beta_{1}\\cdot 0 + \\beta_{2}a)}.\n$$\n约掉 $h_{0}(t)$ 和共同因子 $\\exp(\\beta_{2}a)$ 后可得\n$$\n\\text{HR} = \\exp(\\beta_{1}).\n$$\n已知 $\\beta_{1} = \\ln(0.65)$，利用 $\\exp(\\ln(x)) = x$ 可得\n$$\n\\text{HR} = \\exp(\\ln(0.65)) = 0.65.\n$$\n因此，在相同年龄下，服用 Cor-Stabil 相对于安慰剂的风险为 $0.65$。", "answer": "$$\\boxed{0.65}$$", "id": "1911775"}, {"introduction": "在统计推断中，仅有风险比的点估计是不够的，我们还需要量化其不确定性。这个练习将指导你如何为风险比构建置信区间，这是评估一个协变量效应是否具有统计显著性的关键步骤。通过这个实践，你将学会如何从模型系数的标准误出发，得到关于真实风险比范围的推断 [@problem_id:1911713]。", "problem": "在一项旨在治疗某种特定致命疾病的新治疗药物的临床试验中，研究人员使用Cox比例风险模型来评估该药物与安慰剂相比的有效性。该模型的主要目标是分析到发生关键不良事件为止的时间。模型包含一个单一协变量 $X$，对于治疗组的患者 $X=1$，对于安慰剂组的患者 $X=0$。患者的风险函数由 $h(t|X) = h_0(t)\\exp(\\beta X)$ 给出，其中 $h_0(t)$ 是基线风险函数，$\\beta$ 是对数风险比系数。\n\n根据研究数据，该系数的最大似然估计计算为 $\\hat{\\beta} = -0.500$。该估计的标准误为 $SE(\\hat{\\beta}) = 0.250$。\n\n风险比定义为 $\\exp(\\beta)$，表示治疗组的风险率与安慰剂组的风险率之比。为此风险比构建一个95%的置信区间。在计算中，请使用标准正态分布的临界值 $z_{0.025} = 1.96$。将您的答案报告为一对分别代表置信区间下限和上限的数字。将两个界限都四舍五入到三位有效数字。", "solution": "我们已知一个Cox比例风险模型，其风险函数为 $h(t|X) = h_{0}(t)\\exp(\\beta X)$，风险比定义为 $\\exp(\\beta)$。最大似然估计为 $\\hat{\\beta} = -0.500$，标准误为 $SE(\\hat{\\beta}) = 0.250$。为了构建风险比的95%置信区间，我们首先构建 $\\beta$ 的沃尔德置信区间：\n$$\n\\hat{\\beta} \\pm z_{0.025}\\,SE(\\hat{\\beta}) \\quad \\text{with} \\quad z_{0.025} = 1.96.\n$$\n代入给定值，\n$$\n-0.500 \\pm 1.96 \\times 0.250 = -0.500 \\pm 0.490,\n$$\n得出\n$$\n\\text{CI for } \\beta: \\; \\left[-0.990,\\,-0.010\\right].\n$$\n由于风险比是 $\\beta$ 的单调变换 $\\exp(\\beta)$，通过对端点取指数，可以获得风险比的95%置信区间：\n$$\n\\left[\\exp(-0.990),\\,\\exp(-0.010)\\right].\n$$\n计算并四舍五入到三位有效数字，\n$$\n\\exp(-0.990) \\approx 0.371576691 \\approx 0.372,\\quad \\exp(-0.010) \\approx 0.990049834 \\approx 0.990.\n$$\n因此，风险比的95%置信区间为 $\\left[0.372,\\,0.990\\right]$。", "answer": "$$\\boxed{\\begin{pmatrix}0.372 & 0.990\\end{pmatrix}}$$", "id": "1911713"}, {"introduction": "Cox模型不仅能比较相对风险，还能进行个体化的生存预测。本练习将展示如何结合模型系数和基准累积风险函数，来估计具有特定协变量值的个体在未来某一时间点的生存概率。这项技能对于风险评估和临床决策具有重要的实用价值 [@problem_id:1911715]。", "problem": "在一项针对一种新型电子元件的可靠性研究中，其故障时间使用 Cox 比例风险框架进行建模。一个元件在时间 $t$ 的风险率由模型 $h(t | Z) = h_0(t) \\exp(\\beta Z)$ 给出，其中 $t$ 是以年为单位的运行时间，$Z$ 是一个表示元件制造精度得分的连续协变量，$h_0(t)$ 是一个未指明的基线风险函数。\n\n具有协变量 $Z$ 的元件的累积风险函数为 $H(t | Z) = H_0(t) \\exp(\\beta Z)$，其中 $H_0(t) = \\int_0^t h_0(\\tau) d\\tau$ 是累积基线风险。元件存活超过时间 $t$ 的概率，即生存概率，由关系式 $S(t | Z) = \\exp(-H(t | Z))$ 给出。\n\n根据故障数据的分析，模型回归系数的最大似然估计为 $\\hat{\\beta} = \\ln(3)$。在5年这个时间点，累积基线风险的非参数估计为 $\\hat{H}_0(5) = 0.2$。\n\n使用这些估计值，计算一个制造精度得分为 $Z=1$ 的元件的预测5年生存概率。将您的最终答案四舍五入到四位有效数字。", "solution": "我们使用 Cox 比例风险模型。在时间 $t$、协变量值为 $Z$ 时的累积风险为 $H(t \\mid Z) = H_{0}(t)\\exp(\\beta Z)$，生存函数为 $S(t \\mid Z) = \\exp(-H(t \\mid Z))$。\n\n当 $t=5$ 且 $Z=1$ 时，使用估计值 $\\hat{\\beta} = \\ln(3)$ 和 $\\hat{H}_{0}(5)=0.2$，预测的累积风险为\n$$\n\\hat{H}(5 \\mid 1) = \\hat{H}_{0}(5)\\exp(\\hat{\\beta}\\cdot 1) = 0.2 \\exp(\\ln(3)) = 0.2 \\cdot 3 = 0.6.\n$$\n因此，预测的生存概率为\n$$\n\\hat{S}(5 \\mid 1) = \\exp\\!\\left(-\\hat{H}(5 \\mid 1)\\right) = \\exp(-0.6) = \\exp\\!\\left(-\\frac{3}{5}\\right).\n$$\n数值上，$\\exp(-0.6) \\approx 0.5488116361$，四舍五入到四位有效数字为 $0.5488$。", "answer": "$$\\boxed{0.5488}$$", "id": "1911715"}]}