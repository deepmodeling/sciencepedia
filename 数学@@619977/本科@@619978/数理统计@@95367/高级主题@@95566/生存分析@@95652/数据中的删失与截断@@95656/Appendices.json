{"hands_on_practices": [{"introduction": "本练习提供了一个经典的右删失情景——一项有时间限制的研究。当某些观测因达到预设的终点（如实验结束）而未能观察到完整事件时间时，就会发生右删失。学习为这类混合数据（包含完整观测值和删失观测值）构建似然函数，是进行最大似然估计的基本技能。通过这个实践[@problem_id:1902749]，你将为处理删失生存数据打下坚实的基础。", "problem": "在一个认知心理学实验中，一组学生需要解决一个复杂的谜题。假设学生解决谜题所需的时间服从一个未知平均时间为 $\\theta$ 的指数分布。该实验有时间限制：每名学生最多有 15.0 分钟的时间来解决谜题。如果学生在此时间内未能解决谜题，他们的尝试将被终止，其解答时间被记录为大于 15.0 分钟。这是一个右删失的案例。\n\n在一次实验中，有十名学生参与。成功完成谜题的五名学生的记录时间分别为 5.2、8.7、10.1、12.5 和 14.8 分钟。其余五名学生未能在 15.0 分钟的截止时间内解决谜题。\n\n使用所提供的数据，计算平均解谜时间 $\\theta$ 的最大似然估计 (MLE)。答案以分钟为单位，并四舍五入到三位有效数字。", "solution": "假设解谜时间是独立的，服从均值为 $\\theta$ 的指数分布，并在 $c=15.0$ 处右删失。对于每个未删失时间 $t_{i}$，其对似然函数的贡献是 $f(t_{i}\\mid\\theta)=\\frac{1}{\\theta}\\exp(-t_{i}/\\theta)$，而对于每个删失观测值，其贡献是 $S(c\\mid\\theta)=\\exp(-c/\\theta)$。\n\n令 $n=10$，$d=5$ 为未删失观测值的数量，$n-d=5$ 为在 $c=15.0$ 处删失的观测值数量。观测到的未删失时间为 $t_{1}=5.2$，$t_{2}=8.7$，$t_{3}=10.1$，$t_{4}=12.5$，$t_{5}=14.8$。似然函数是\n$$\nL(\\theta)=\\prod_{i=1}^{d}\\left(\\frac{1}{\\theta}\\exp\\left(-\\frac{t_{i}}{\\theta}\\right)\\right)\\times\\prod_{j=1}^{n-d}\\exp\\left(-\\frac{c}{\\theta}\\right)\n=\\theta^{-d}\\exp\\left(-\\frac{\\sum_{i=1}^{d}t_{i}+c(n-d)}{\\theta}\\right).\n$$\n定义 $T=\\sum_{i=1}^{d}t_{i}+c(n-d)$。对数似然函数是\n$$\n\\ell(\\theta)=-d\\ln\\theta-\\frac{T}{\\theta}.\n$$\n求导并令其为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=-\\frac{d}{\\theta}+\\frac{T}{\\theta^{2}}=0\n\\quad\\Longrightarrow\\quad\n\\hat{\\theta}=\\frac{T}{d}.\n$$\n二阶导数是\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\theta^{2}}=\\frac{d}{\\theta^{2}}-\\frac{2T}{\\theta^{3}},\n$$\n当 $\\hat{\\theta}=T/d$ 时，其值为 $-\\frac{d^{3}}{T^{2}}<0$，这证实了它是一个极大值。\n\n计算 $T$：\n$$\n\\sum_{i=1}^{5}t_{i}=5.2+8.7+10.1+12.5+14.8=51.3,\\quad c(n-d)=15.0\\times 5=75.0,\n$$\n所以\n$$\nT=51.3+75.0=126.3,\\quad \\hat{\\theta}=\\frac{126.3}{5}=25.26\\ \\text{分钟}。\n$$\n四舍五入到三位有效数字，$\\hat{\\theta}=25.3$ 分钟。", "answer": "$$\\boxed{25.3}$$", "id": "1902749"}, {"introduction": "在固定截止时间之外，本问题将删失建模为一个与目标事件（例如设备故障）相竞争的随机事件。这种“竞争风险”框架是思考生存数据的一种强大而现实的方式，其中事件的发生可能被另一个无关事件所阻止。通过这个练习[@problem_id:1902740]，你将推导出一个在可靠性工程和生存分析中至关重要的基础性结果，即失效率参数 $\\lambda$ 的最大似然估计量。", "problem": "一个材料科学实验室正在对新一代大功率发光二极管 (LED) 进行可靠性研究。一个 LED 的寿命 $T$ 定义为其失效前的时间，该寿命被建模为一个随机变量，服从未知的恒定失效率参数 $\\lambda > 0$ 的指数分布。\n\n对于每个测试中的 LED，都有一项关键的安全规程。如果某个单元的内部工作温度超过预设的安全阈值，该单元的测试将立即终止。这种删失事件是由随机因素引起的，例如微观缺陷或冷却系统的波动。因该温度限制导致单元测试终止的时间 $C$ 也被建模为一个随机变量。根据类似组件的历史数据，假定 $C$ 服从率参数为 $\\mu > 0$ 的指数分布。寿命 $T$ 和删失时间 $C$ 被假定为相互独立的随机变量。\n\n现对一批 $N$ 个相同的 LED 进行一项实验。对于每个 LED $i$（其中 $i=1, 2, \\ldots, N$），实验记录了观测时间 $y_i$ 和一个状态指示符 $\\delta_i$。时间 $y_i$ 是失效时间或删失时间，取两者中较早发生者。如果第 $i$ 个 LED 失效，则指示符为 $\\delta_i=1$；如果测试因温度安全规程而停止，则指示符为 $\\delta_i=0$。\n\n推导失效率的最大似然估计量 (MLE)，记为 $\\hat{\\lambda}$。将最终结果表示为一个闭式解析表达式，该表达式应由以下观测数据汇总统计量构成：观测到的总失效数 $D = \\sum_{i=1}^{N} \\delta_i$，以及所有观测时间的总和（总测试时间）$Y = \\sum_{i=1}^{N} y_i$。", "solution": "设 $T\\sim\\text{Exp}(\\lambda)$ 和 $C\\sim\\text{Exp}(\\mu)$ 相互独立。则对于 $t,c\\ge 0$，有 $f_{T}(t)=\\lambda\\exp(-\\lambda t)$，$S_{T}(t)=\\exp(-\\lambda t)$，$f_{C}(c)=\\mu\\exp(-\\mu c)$ 和 $S_{C}(c)=\\exp(-\\mu c)$。\n\n对于第 $i$ 个观测，我们记录 $y_{i}=\\min(T_{i},C_{i})$ 和 $\\delta_{i}=\\mathbf{1}\\{T_{i}<C_{i}\\}$。其对似然函数的贡献为\n- 若 $\\delta_{i}=1$：$f_{T}(y_{i})S_{C}(y_{i})=\\lambda\\exp(-\\lambda y_{i})\\exp(-\\mu y_{i})=\\lambda\\exp(-( \\lambda+\\mu )y_{i})$，\n- 若 $\\delta_{i}=0$：$f_{C}(y_{i})S_{T}(y_{i})=\\mu\\exp(-\\mu y_{i})\\exp(-\\lambda y_{i})=\\mu\\exp(-( \\lambda+\\mu )y_{i})$。\n\n因此，对于每个 $i$，\n$$\nL_{i}(\\lambda,\\mu)=\\left[\\lambda^{\\delta_{i}}\\mu^{1-\\delta_{i}}\\right]\\exp\\!\\left(-(\\lambda+\\mu)y_{i}\\right).\n$$\n考虑所有 $N$ 个单元，设 $D=\\sum_{i=1}^{N}\\delta_{i}$ 且 $Y=\\sum_{i=1}^{N}y_{i}$，则总似然函数为\n$$\nL(\\lambda,\\mu)=\\prod_{i=1}^{N}L_{i}(\\lambda,\\mu)=\\lambda^{D}\\mu^{N-D}\\exp\\!\\left(-(\\lambda+\\mu)Y\\right).\n$$\n对数似然函数为\n$$\n\\ell(\\lambda,\\mu)=D\\ln\\lambda+(N-D)\\ln\\mu-(\\lambda+\\mu)Y.\n$$\n为求 $\\lambda$ 的最大似然估计，对 $\\lambda$ 求导并令其等于零：\n$$\n\\frac{\\partial\\ell}{\\partial\\lambda}=\\frac{D}{\\lambda}-Y=0\\quad\\Longrightarrow\\quad \\hat{\\lambda}=\\frac{D}{Y}.\n$$\n二阶导数为 $\\frac{\\partial^{2}\\ell}{\\partial\\lambda^{2}}=-\\frac{D}{\\lambda^{2}}<0$ (当 $D>0$ 时)，这确认了该点是一个极大值。如果 $D=0$，$\\ell(\\lambda,\\mu)$ 是关于 $\\lambda$ 的递减函数，因此其上确界在边界 $\\lambda=0$ 处取得，这与连续扩展 $\\hat{\\lambda}=D/Y$ 所得的结果一致。", "answer": "$$\\boxed{\\frac{D}{Y}}$$", "id": "1902740"}, {"introduction": "此实践将我们的注意力转向左删失，当测量值低于仪器的检测极限时，这种情况经常发生。你不仅需要为左删失数据建立似然函数，还需要运用近似技巧来求解参数。这个问题[@problem_id:1902766]突显了应用统计学中的一个常见挑战，即精确解有时是难以处理的，需要我们寻求有效的近似方法。", "problem": "一个水质监测站使用传感器来测量某种化学污染物的浓度。假设在任何给定的水样中，浓度 $C$ 服从一个指数分布，其速率参数 $\\lambda > 0$ 未知。该浓度的概率密度函数 (PDF) 为 $f(c; \\lambda) = \\lambda \\exp(-\\lambda c)$，其中 $c \\ge 0$。\n\n该传感器有一个检测下限 $L$。如果一个样本的真实浓度 $C$ 小于 $L$，传感器只记录测量值低于该限值。如果浓度 $C \\ge L$，传感器记录其精确值。\n\n总共分析了 $N$ 个水样。观测到其中 $N_c$ 个样本的浓度低于检测下限。剩下的 $N_u = N - N_c$ 个样本给出了具体的测量浓度 $c_1, c_2, \\ldots, c_{N_u}$，这些测量值的总和记为 $S = \\sum_{i=1}^{N_u} c_i$。\n\n$\\lambda$ 的最大似然估计 (MLE)，记为 $\\hat{\\lambda}$，是使观测到此数据集的概率最大化的值。$\\hat{\\lambda}$ 的精确方程是超越方程，意味着它无法用初等函数求解。然而，在 $L$ 很小的情况下，可以找到一个有用的近似解。请找出一个在 $L$ 的一阶精度上准确的 $\\hat{\\lambda}$ 的表达式。将您的答案表示为仅包含 $N, N_c, L$ 和 $S$ 的单个闭式解析表达式。", "solution": "设 $C$ 服从速率为 $\\lambda>0$ 的指数分布，其概率密度函数为 $f(c;\\lambda)=\\lambda \\exp(-\\lambda c)$，其中 $c\\ge 0$。在存在左删失限值 $L$ 的情况下，对于 $N$ 个样本, 其中 $N_{c}$ 个被删失（$C<L$），$N_{u}=N-N_{c}$ 个为未删失的精确值 $c_{1},\\ldots,c_{N_{u}}$（其和为 $S=\\sum_{i=1}^{N_{u}} c_{i}$），其似然函数为\n$$\n\\mathcal{L}(\\lambda)=\\left[1-\\exp(-\\lambda L)\\right]^{N_{c}}\\prod_{i=1}^{N_{u}}\\lambda \\exp(-\\lambda c_{i}).\n$$\n对数似然函数为\n$$\n\\ell(\\lambda)=N_{c}\\ln\\!\\left(1-\\exp(-\\lambda L)\\right)+N_{u}\\ln \\lambda-\\lambda S.\n$$\n求导并令其为零以求得最大似然估计：\n$$\n\\frac{\\mathrm{d}\\ell}{\\mathrm{d}\\lambda}=N_{c}\\frac{L\\exp(-\\lambda L)}{1-\\exp(-\\lambda L)}+\\frac{N_{u}}{\\lambda}-S=0.\n$$\n对于较小的 $L$，我们对 $L$ 进行一阶展开。令 $y=\\lambda L$ 并使用 $\\exp(-y)=1-y+\\frac{y^{2}}{2}+O(y^{3})$ 和 $1-\\exp(-y)=y-\\frac{y^{2}}{2}+O(y^{3})$。则\n$$\n\\frac{L\\exp(-\\lambda L)}{1-\\exp(-\\lambda L)}= \\frac{L(1-y+\\frac{y^{2}}{2}+O(y^{3}))}{y(1-\\frac{y}{2}+O(y^{2}))}\n= \\frac{1}{\\lambda}\\left(1-\\frac{y}{2}+O(y^{2})\\right)\n= \\frac{1}{\\lambda}-\\frac{L}{2}+O(L^{2}).\n$$\n将此结果代入得分方程，并仅保留 $L$ 的一阶项：\n$$\nN_{c}\\left(\\frac{1}{\\lambda}-\\frac{L}{2}\\right)+\\frac{N_{u}}{\\lambda}-S=0\n\\quad\\Longrightarrow\\quad\n\\frac{N_{c}+N_{u}}{\\lambda}-\\frac{N_{c}L}{2}-S=0.\n$$\n由于 $N_{c}+N_{u}=N$，解出 $\\lambda$ 即可获得一阶近似值：\n$$\n\\hat{\\lambda}\\approx \\frac{N}{S+\\frac{N_{c}L}{2}}.\n$$\n当 $L=0$ 或 $N_{c}=0$ 时，此表达式简化为通常的 $\\hat{\\lambda}=N/S$，与预期相符。", "answer": "$$\\boxed{\\frac{N}{S+\\frac{N_{c}L}{2}}}$$", "id": "1902766"}]}