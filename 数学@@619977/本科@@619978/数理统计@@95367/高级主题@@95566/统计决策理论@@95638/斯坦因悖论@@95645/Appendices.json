{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。这个练习将带你进行詹姆斯-斯坦因（James-Stein, JS）估计器的首次计算。通过一个生物统计学中的假设场景，你将学习如何根据一个多维观测数据，计算收缩因子并将其应用于原始数据，从而得到一个比样本均值（即最大似然估计）在总均方误差上更优的估计值。这个基础计算是理解JS估计器工作原理的第一步。[@problem_id:1956802]", "problem": "一位生物统计学家正在分析一项高通量实验的数据，该实验同时测量了多个基因的表达水平。测量向量 $X = (X_1, X_2, \\dots, X_p)^T$ 被建模为从一个 $p$-维正态分布 $N_p(\\theta, \\sigma^2 I_p)$ 中抽取的一个样本。在此模型中，$\\theta = (\\theta_1, \\theta_2, \\dots, \\theta_p)^T$ 代表这些基因的真实但未知的平均表达水平向量，而 $I_p$ 是 $p \\times p$ 的单位矩阵。已知每个基因的测量过程具有共同方差 $\\sigma^2$，并且这些测量是统计独立的。\n\n对于一个包含 $p=5$ 个基因的特定实验，已知共同方差为 $\\sigma^2 = 2.25$。观测到的测量向量如下：\n$$\nx = \\begin{pmatrix} 4.1 \\\\ -2.3 \\\\ 0.8 \\\\ 5.0 \\\\ -1.5 \\end{pmatrix}\n$$\n为了估计真实的均值向量 $\\theta$，该统计学家决定使用 James-Stein 估计量 $\\hat{\\theta}_{JS}$。对于一个来自 $N_p(\\theta, \\sigma^2 I_p)$ 的观测值 $x$，该估计量定义为：\n$$\n\\hat{\\theta}_{JS} = \\left(1 - \\frac{(p-2)\\sigma^2}{\\|x\\|^2}\\right) x\n$$\n其中 $\\|x\\|^2 = \\sum_{i=1}^{p} x_i^2$ 是向量 $x$ 的欧几里得范数的平方。当 $p \\ge 3$ 时，该估计量的一个显著特点是其总均方误差一致低于标准的最大似然估计量 (MLE)（即 $x$）。\n\n根据给定数据，计算真实平均表达水平的 James-Stein 估计值 $\\hat{\\theta}_{JS}$。将您的最终答案表示为一个行向量，其中每个分量四舍五入到三位有效数字。", "solution": "我们获得一个来自 $N_{p}(\\theta,\\sigma^{2}I_{p})$ 的观测值 $x \\in \\mathbb{R}^{p}$ 以及 James-Stein 估计量\n$$\n\\hat{\\theta}_{JS}=\\left(1-\\frac{(p-2)\\sigma^{2}}{\\|x\\|^{2}}\\right)x,\n$$\n其中 $\\|x\\|^{2}=\\sum_{i=1}^{p}x_{i}^{2}$。对于此问题，$p=5$，$\\sigma^{2}=2.25$，且\n$$\nx=\\begin{pmatrix}4.1\\\\-2.3\\\\0.8\\\\5.0\\\\-1.5\\end{pmatrix}.\n$$\n首先计算范数的平方：\n$$\n\\|x\\|^{2}=4.1^{2}+(-2.3)^{2}+0.8^{2}+5.0^{2}+(-1.5)^{2}=16.81+5.29+0.64+25+2.25=49.99.\n$$\n计算收缩因子：\n$$\n1-\\frac{(p-2)\\sigma^{2}}{\\|x\\|^{2}}=1-\\frac{3\\cdot 2.25}{49.99}=1-\\frac{6.75}{49.99}=\\frac{4999-675}{4999}=\\frac{4324}{4999}\\approx 0.8649729946.\n$$\n因此，\n$$\n\\hat{\\theta}_{JS}=\\left(\\frac{4324}{4999}\\right)x.\n$$\n将此标量应用于每个分量：\n$$\n\\hat{\\theta}_{JS,1}=4.1\\cdot\\frac{4324}{4999}\\approx 3.5463893,\\quad\n\\hat{\\theta}_{JS,2}=-2.3\\cdot\\frac{4324}{4999}\\approx -1.9894379,\n$$\n$$\n\\hat{\\theta}_{JS,3}=0.8\\cdot\\frac{4324}{4999}\\approx 0.6919784,\\quad\n\\hat{\\theta}_{JS,4}=5.0\\cdot\\frac{4324}{4999}\\approx 4.324865,\n$$\n$$\n\\hat{\\theta}_{JS,5}=-1.5\\cdot\\frac{4324}{4999}=-\\frac{6486}{4999}\\approx -1.2974595.\n$$\n将每个分量四舍五入到三位有效数字，得到\n$$\n\\begin{pmatrix}\n3.55 & -1.99 & 0.692 & 4.32 & -1.30\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 3.55 & -1.99 & 0.692 & 4.32 & -1.30 \\end{pmatrix}}$$", "id": "1956802"}, {"introduction": "掌握了基础计算后，让我们来探索JS估计器一个著名且反直觉的特性。当观测数据向量的范数（即长度）非常小时，标准的JS估计器可能会产生一个负的收缩因子，这意味着最终的估计向量会指向与原始观测相反的方向。这个练习将通过一个天体物理学的假想案例，让你亲手计算并体验这种“负向收缩”现象，这对于理解为何需要对标准JS估计器进行改进至关重要。[@problem_id:1956809]", "problem": "一名天体物理学家正在测量天空中五个不同的、不重叠区域的微弱微波各向异性。理论上的“零模型”预测宇宙微波背景是完全均匀的，这意味着每个区域 $i$ 的真实平均各向异性 $\\theta_i$ 为零。因此，假设的真实均值向量为 $\\theta = (0, 0, 0, 0, 0)$。\n\n实验测量值在经过归一化和减去全局均值后，被收集到一个向量 $X = (x_1, x_2, x_3, x_4, x_5)$ 中。由于仪器噪声和量子涨落，该测量过程被建模为一个5维多元正态分布，$X \\sim N_5(\\theta, I_5)$，其中 $\\theta \\in \\mathbb{R}^5$ 是未知的均值向量，$I_5$ 是 $5 \\times 5$ 的单位矩阵。\n\n$\\theta$ 的常规估计是最大似然估计（MLE），即观测到的向量 $X$。另一种方法是 James-Stein 估计量，对于 $p \\ge 3$ 维定义如下：\n$$ \\delta_{JS}(X) = \\left(1 - \\frac{p-2}{||X||^2}\\right)X $$\n其中 $p$ 是向量 $X$ 的维度，$||X||^2 = \\sum_{i=1}^p x_i^2$。已知当对 $\\theta$ 的所有可能值取平均时，该估计量的总均方误差低于 MLE。\n\n假设实验观测得到的向量为 $X = (1.10, 0.60, -0.40, 0.30, 0.20)$。\n\n根据此观测结果，计算 James-Stein 估计 $\\delta_{JS}(X)$ 的第一个分量和第二个分量的数值。请按从第一个分量到第二个分量的顺序，以数对形式给出你的答案。将两个分量的最终答案四舍五入到三位有效数字。", "solution": "我们使用维度 $p=5$ 的 James-Stein 估计量：\n$$\n\\delta_{JS}(X)=\\left(1-\\frac{p-2}{\\|X\\|^{2}}\\right)X.\n$$\n给定 $X=(1.10,0.60,-0.40,0.30,0.20)$，首先计算其平方范数：\n$$\n\\|X\\|^{2}=\\sum_{i=1}^{5}x_{i}^{2}=1.10^{2}+0.60^{2}+(-0.40)^{2}+0.30^{2}+0.20^{2}=1.21+0.36+0.16+0.09+0.04=1.86.\n$$\n记 $1.86=\\frac{93}{50}$。当 $p=5$ 时，我们有 $p-2=3$，所以收缩因子为\n$$\n1-\\frac{p-2}{\\|X\\|^{2}}=1-\\frac{3}{93/50}=1-\\frac{150}{93}=1-\\frac{50}{31}=-\\frac{19}{31}.\n$$\n因此，\n$$\n\\delta_{JS}(X)=\\left(-\\frac{19}{31}\\right)X.\n$$\n第一个分量是\n$$\n\\delta_{JS,1}=\\left(-\\frac{19}{31}\\right)(1.10)=\\left(-\\frac{19}{31}\\right)\\left(\\frac{11}{10}\\right)=-\\frac{209}{310}\\approx -0.674193548，\n$$\n四舍五入到三位有效数字得到 $-0.674$。\n\n第二个分量是\n$$\n\\delta_{JS,2}=\\left(-\\frac{19}{31}\\right)(0.60)=\\left(-\\frac{19}{31}\\right)\\left(\\frac{3}{5}\\right)=-\\frac{57}{155}\\approx -0.367741935，\n$$\n四舍五入到三位有效数字得到 $-0.368$。\n\n因此，所要求的数对（按从第一个到第二个分量的顺序）是 $(-0.674,-0.368)$。", "answer": "$$\\boxed{\\begin{pmatrix}-0.674 & -0.368\\end{pmatrix}}$$", "id": "1956809"}, {"introduction": "上一个练习揭示了标准JS估计器的一个缺陷，即可能产生负向收缩。为了修正这个问题，统计学家提出了正部詹姆斯-斯坦因（positive-part James-Stein）估计器，它不允许收缩因子变为负数。这个练习要求你反向思考：构建一个具体的数据向量，使得标准JS估计器产生一个非零的、方向相反的估计，而正部估计器则直接将估计收缩至零。通过这个构造性任务，你将深刻理解这两种估计器之间的关键差异及其运作机制。[@problem_id:1956800]", "problem": "在估计一个多元正态分布的未知 $p$ 维均值向量 $\\theta$ 的背景下，令 $X$ 为来自 $N(\\theta, I_p)$ 的单个观测数据向量，其中 $I_p$ 是 $p \\times p$ 的单位矩阵。当维度 $p \\geq 3$ 时，用于估计 $\\theta$ 的标准 James-Stein 估计量由下式给出：\n$$ \\hat{\\theta}_{\\text{JS}}(X) = \\left(1 - \\frac{p-2}{\\|X\\|^2}\\right) X $$\n其中 $\\|X\\|^2 = \\sum_{i=1}^{p} X_i^2$ 是向量 $X$ 的欧几里得范数的平方。\n\n一个常见的修正是正部 James-Stein 估计量，它能防止压缩因子变为负数：\n$$ \\hat{\\theta}_{\\text{JS}}^{+}(X) = \\left(1 - \\frac{p-2}{\\|X\\|^2}\\right)_{+} X = \\max\\left(0, 1 - \\frac{p-2}{\\|X\\|^2}\\right) X $$\n\n考虑维度为 $p=3$ 的特定情况。你的任务是找出一个非零数据向量 $X \\in \\mathbb{R}^3$ 的具体例子，使得正部 James-Stein 估计 $\\hat{\\theta}_{\\text{JS}}^{+}(X)$ 为零向量，而标准 James-Stein 估计 $\\hat{\\theta}_{\\text{JS}}(X)$ 不为零向量。请将你的答案以数值行向量的形式呈现。", "solution": "给定 $p=3$ 以及如下估计量\n$$\\hat{\\theta}_{\\text{JS}}(X)=\\left(1-\\frac{p-2}{\\|X\\|^{2}}\\right)X, \\quad \\hat{\\theta}_{\\text{JS}}^{+}(X)=\\max\\left(0,1-\\frac{p-2}{\\|X\\|^{2}}\\right)X.$$\n代入 $p=3$ 得到压缩因子\n$$1-\\frac{p-2}{\\|X\\|^{2}}=1-\\frac{1}{\\|X\\|^{2}}.$$\n为使正部估计量得到零向量，我们需要 $\\max\\left(0,1-\\frac{1}{\\|X\\|^{2}}\\right)=0$，该式成立当且仅当 $1-\\frac{1}{\\|X\\|^{2}}\\leq 0$，即 $\\|X\\|^{2}\\leq 1$。\n我们还要求标准 James-Stein 估计不为零向量。这种情况在给定 $X\\neq 0$ 的情况下发生，即要求 $\\left(1-\\frac{1}{\\|X\\|^{2}}\\right)X\\neq 0$，这等价于 $1-\\frac{1}{\\|X\\|^{2}}\\neq 0$，即 $\\|X\\|^{2}\\neq 1$。\n结合这两个条件，我们需要任意满足 $0<\\|X\\|^{2}<1$ 的非零向量 $X$。一个简单的具体选择是\n$$X=\\begin{pmatrix}\\frac{1}{2}&0&0\\end{pmatrix},$$\n对此向量有\n$$\\|X\\|^{2}=\\left(\\frac{1}{2}\\right)^{2}+0+0=\\frac{1}{4}<1.$$\n于是\n$$1-\\frac{1}{\\|X\\|^{2}}=1-\\frac{1}{\\frac{1}{4}}=1-4=-3<0,$$\n所以\n$$\\hat{\\theta}_{\\text{JS}}^{+}(X)=0\\cdot X=\\begin{pmatrix}0&0&0\\end{pmatrix},$$\n而\n$$\\hat{\\theta}_{\\text{JS}}(X)=\\left(1-\\frac{1}{\\|X\\|^{2}}\\right)X=(-3)\\begin{pmatrix}\\frac{1}{2}&0&0\\end{pmatrix}=\\begin{pmatrix}-\\frac{3}{2}&0&0\\end{pmatrix}\\neq \\begin{pmatrix}0&0&0\\end{pmatrix}.$$\n因此，$X=\\begin{pmatrix}\\frac{1}{2}&0&0\\end{pmatrix}$ 满足所要求的性质。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & 0 & 0\\end{pmatrix}}$$", "id": "1956800"}]}