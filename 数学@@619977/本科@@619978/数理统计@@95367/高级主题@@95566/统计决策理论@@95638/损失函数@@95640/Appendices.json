{"hands_on_practices": [{"introduction": "在统计学中，我们如何从一组数据中选出一个“最佳”的代表值？答案取决于我们如何定义“最佳”。这个练习将引导你探索一种常见的选择：绝对误差损失函数。通过最小化数据点与估计值之间绝对差值的总和，我们将发现一个稳健的中心度量——中位数。这个实践将揭示损失函数的选择如何直接影响我们的估计结果，并强调中位数在处理异常值时的内在优势。[@problem_id:1931715]", "id": "1931715", "problem": "在统计估计领域，一个常见的任务是为一组测量值确定一个单一的代表值。这个值的选择通常取决于一个“损失函数”，该函数量化了估计不准确所带来的惩罚。\n\n一位工程师正在校准一个新型接近传感器。对于一个放置在固定但未知距离处的目标，该传感器报告了三个测量值：$x_1 = 1$、$x_2 = 5$ 和 $x_3 = 9$，单位均为毫米 (mm)。该工程师决定找到一个单一的常数估计值 $\\hat{\\theta}$，以最佳地代表真实距离。“最佳”的标准是该估计值必须最小化绝对误差之和。这个损失函数 $L(\\hat{\\theta})$ 定义为估计值 $\\hat{\\theta}$ 与每个单独测量值 $x_i$ 之间绝对差的总和。\n\n确定能使该损失函数最小化的估计值 $\\hat{\\theta}$ 的精确值。请以毫米为单位，给出数值答案。", "solution": "我们需要最小化与一个常数估计值的绝对偏差之和。将估计值 $\\hat{\\theta}$ 的损失函数定义为\n$$\nL(\\hat{\\theta})=\\sum_{i=1}^{3}|\\hat{\\theta}-x_{i}|=|\\hat{\\theta}-1|+|\\hat{\\theta}-5|+|\\hat{\\theta}-9|.\n$$\n估计理论中的一个标准结论是，数据的任意中位数都能最小化绝对偏差之和。为了直接验证这一点，我们将测量值排序为 $1<5<9$，并考虑在点 $\\hat{\\theta}\\in\\{1,5,9\\}$ 之外，$L$ 关于 $\\hat{\\theta}$ 的导数。使用 $\\frac{d}{d\\hat{\\theta}}|\\hat{\\theta}-a|=\\operatorname{sgn}(\\hat{\\theta}-a)$ (对于 $\\hat{\\theta}\\neq a$)，我们有：\n- 对于 $\\hat{\\theta}\\in(-\\infty,1)$：$\\operatorname{sgn}(\\hat{\\theta}-1)=-1$，$\\operatorname{sgn}(\\hat{\\theta}-5)=-1$，$\\operatorname{sgn}(\\hat{\\theta}-9)=-1$，因此 $L'(\\hat{\\theta})=-3$。\n- 对于 $\\hat{\\theta}\\in(1,5)$：符号分别为 $+1,-1,-1$，因此 $L'(\\hat{\\theta})=-1$。\n- 对于 $\\hat{\\theta}\\in(5,9)$：符号分别为 $+1,+1,-1$，因此 $L'(\\hat{\\theta})=+1$。\n- 对于 $\\hat{\\theta}\\in(9,\\infty)$：符号分别为 $+1,+1,+1$，因此 $L'(\\hat{\\theta})=+3$。\n\n因此，对于 $\\hat{\\theta}<5$ 有 $L'(\\hat{\\theta})<0$，对于 $\\hat{\\theta}>5$ 有 $L'(\\hat{\\theta})>0$。在 $\\hat{\\theta}=5$ 处，左导数为 $-1$，右导数为 $+1$，因此其次微分包含 $0$，这证实了在 $\\hat{\\theta}=5$ 处存在一个最小值点。因此，损失在数据的中位数处达到最小值，该中位数为 $5$。\n\n为了完整起见，在候选点求值可得 $L(5)=|5-1|+|5-5|+|5-9|=4+0+4=8$，该值小于在 $\\hat{\\theta}=1$ 或 $\\hat{\\theta}=9$ 处的值（二者均为 $12$），这与最小性是一致的。\n\n因此，最小化绝对误差之和的估计值是 $\\hat{\\theta}=5$ 毫米。", "answer": "$$\\boxed{5}$$"}, {"introduction": "与最小化总体误差不同，有时我们的目标是控制最坏情况下的风险。这个练习介绍了一种新的决策标准：极小化极大损失（minimax loss），即最小化最大绝对误差。我们将学习如何通过选择一个估计值来最小化它与任何单个数据点之间的最大可能偏差。这个方法引出了一个不同的最优估计——中程数（midrange），即数据集最大值和最小值的平均值，体现了与之前练习完全不同的优化哲学。[@problem_id:1931753]", "id": "1931753", "problem": "在统计建模中，损失函数量化了与不正确预测相关的“成本”。一位数据科学家的任务是，为一个给定的测量数据集选择一个单一的代表性常数，记为 $\\hat{\\theta}$。目标是选择 $\\hat{\\theta}$ 以最小化一个称为极小化极大损失（或最大绝对误差）的特定误差标准。\n\n对于一个观测数据集 $Y = \\{y_1, y_2, \\dots, y_n\\}$，这个损失函数 $L(\\hat{\\theta})$ 定义为任何观测值 $y_i$ 与常数估计 $\\hat{\\theta}$ 之间的最大绝对差：\n$$L(\\hat{\\theta}) = \\max_{i} |y_i - \\hat{\\theta}|$$\n考虑以下测量数据集：$Y = \\{1.0, 8.0, 2.0\\}$。\n\n确定对于此数据集能够最小化损失函数 $L(\\hat{\\theta})$ 的 $\\hat{\\theta}$ 的精确数值。", "solution": "我们需要最小化 $L(\\hat{\\theta})=\\max_{i}|y_{i}-\\hat{\\theta}|$，其中 $Y=\\{1.0,8.0,2.0\\}$。设 $a=\\min Y=1.0$ 且 $b=\\max Y=8.0$。对任意实数 $t$，定义 $d_{1}=|t-a|$ 和 $d_{2}=|t-b|$。根据三角不等式，\n$$\nd_{1}+d_{2}\\geq|b-a|=b-a,\n$$\n所以\n$$\n\\max(d_{1},d_{2})\\geq\\frac{d_{1}+d_{2}}{2}\\geq\\frac{b-a}{2}.\n$$\n等号成立当且仅当 $d_{1}=d_{2}=\\frac{b-a}{2}$，这在 $t=\\frac{a+b}{2}$ 时发生。因此，函数 $t\\mapsto\\max(|t-a|,|t-b|)$ 在 $t=\\frac{a+b}{2}$ 处取得最小值，最小值为 $\\frac{b-a}{2}$。\n\n因为每个 $y_{i}$ 都在 $[a,b]$ 区间内，对于中点 $m=\\frac{a+b}{2}$，我们有 $|m-y_{i}|\\leq\\max(|m-a|,|m-b|)=\\frac{b-a}{2}$ 对所有 $i$ 成立。因此，总损失 $L(\\hat{\\theta})=\\max_{i}|y_{i}-\\hat{\\theta}|$ 在 $\\hat{\\theta}=m$ 处最小化。\n\n代入 $a=1.0$ 和 $b=8.0$ 得\n$$\n\\hat{\\theta}=\\frac{a+b}{2}=\\frac{1.0+8.0}{2}=4.5.\n$$", "answer": "$$\\boxed{4.5}$$"}, {"introduction": "现在，让我们将损失函数的应用从处理离散数据点提升到分析连续的概率分布。在贝叶斯推断中，我们对未知参数的全部了解都体现在其后验分布中。这个练习将向你展示，选择不同的损失函数（如平方误差、绝对误差和0-1损失）等同于从后验分布中选择不同的概括性统计量（分别是均值、中位数和众数）。通过这个实践，你将深刻理解贝叶斯决策理论如何将损失函数的选择与参数估计的核心问题联系起来。[@problem_id:1931727]", "id": "1931727", "problem": "在贝叶斯统计推断中，一位研究者对一个未知参数 $\\theta$ 进行建模，其中 $\\theta$ 代表一个比例，因此已知其位于区间 $[0, 1]$ 内。在观测到一些数据后，该研究者确定 $\\theta$ 的后验概率密度函数由一个不对称的三角分布给出。\n\n具体来说，后验概率密度函数 $p(\\theta|\\text{data})$ 定义为：\n$$\np(\\theta|\\text{data}) = \\begin{cases} \n6\\theta & \\text{若 } 0 \\le \\theta < 1/3 \\\\\n3(1-\\theta) & \\text{若 } 1/3 \\le \\theta \\le 1 \n\\end{cases}\n$$\n在其他情况下 $p(\\theta|\\text{data}) = 0$。\n\n目标是确定从该后验分布中导出的 $\\theta$ 的三个不同的贝叶斯点估计量。这些估计量对应于最小化三种不同损失函数的后验期望值：\n1.  估计量 $\\hat{\\theta}_{SE}$，它最小化平方误差损失 $L(\\theta, \\hat{\\theta}) = (\\theta - \\hat{\\theta})^2$。\n2.  估计量 $\\hat{\\theta}_{AE}$，它最小化绝对误差损失 $L(\\theta, \\hat{\\theta}) = |\\theta - \\hat{\\theta}|$。\n3.  估计量 $\\hat{\\theta}_{01}$，它是当 $\\epsilon \\to 0$ 时，零一损失函数 $L(\\theta, \\hat{\\theta}) = \\mathbb{I}(|\\theta - \\hat{\\theta}| > \\epsilon)$ 的极限贝叶斯法则。\n\n确定三个估计量 $\\hat{\\theta}_{SE}$、$\\hat{\\theta}_{AE}$ 和 $\\hat{\\theta}_{01}$ 的精确值。以三元组 $(\\hat{\\theta}_{SE}, \\hat{\\theta}_{AE}, \\hat{\\theta}_{01})$ 的形式给出你的答案。", "solution": "该问题要求解出具有给定后验概率密度函数 (pdf) 的参数 $\\theta$ 的三个不同贝叶斯点估计量。每个估计量都对应于在后验分布上最小化特定损失函数的期望值。\n\n首先，我们来确定与每个估计量相对应的统计量：\n1.  最小化期望平方误差的估计量 $\\hat{\\theta}_{SE}$ 是后验分布的均值。$\\hat{\\theta}_{SE} = E[\\theta|\\text{data}]$。\n2.  最小化期望绝对误差的估计量 $\\hat{\\theta}_{AE}$ 是后验分布的中位数。\n3.  最小化零一损失（在连续情况下）的估计量 $\\hat{\\theta}_{01}$ 是后验分布的众数。\n\n后验概率密度函数给出如下：\n$$\np(\\theta|\\text{data}) = \\begin{cases} \n6\\theta & \\text{若 } 0 \\le \\theta < 1/3 \\\\\n3(1-\\theta) & \\text{若 } 1/3 \\le \\theta \\le 1 \n\\end{cases}\n$$\n\n让我们来计算这些量。\n\n**1. 众数 ($\\hat{\\theta}_{01}$) 的计算**\n\n众数是使后验概率密度函数 $p(\\theta|\\text{data})$ 最大化的 $\\theta$ 值。我们可以分析函数的两个部分。\n- 对于 $0 \\le \\theta < 1/3$，函数是 $f_1(\\theta) = 6\\theta$，它是严格递增的。\n- 对于 $1/3 \\le \\theta \\le 1$，函数是 $f_2(\\theta) = 3(1-\\theta)$，它是严格递减的。\n函数递增直到 $\\theta = 1/3$，然后开始递减。因此，概率密度函数的最大值出现在两部分交汇的点，即 $\\theta = 1/3$。\n因此，众数是 $\\hat{\\theta}_{01} = 1/3$。\n\n**2. 均值 ($\\hat{\\theta}_{SE}$) 的计算**\n\n均值是 $\\theta$ 的期望值，通过积分 $E[\\theta] = \\int_{-\\infty}^{\\infty} \\theta p(\\theta|\\text{data}) d\\theta$ 来计算。根据我们给定的概率密度函数，这变为：\n$$\n\\hat{\\theta}_{SE} = \\int_{0}^{1} \\theta p(\\theta|\\text{data}) d\\theta = \\int_{0}^{1/3} \\theta(6\\theta) d\\theta + \\int_{1/3}^{1} \\theta(3(1-\\theta)) d\\theta\n$$\n我们分别计算每个积分。\n$$\n\\int_{0}^{1/3} 6\\theta^2 d\\theta = \\left[ 2\\theta^3 \\right]_{0}^{1/3} = 2\\left(\\frac{1}{3}\\right)^3 - 0 = 2\\left(\\frac{1}{27}\\right) = \\frac{2}{27}\n$$\n$$\n\\int_{1/3}^{1} (3\\theta - 3\\theta^2) d\\theta = \\left[ \\frac{3\\theta^2}{2} - \\theta^3 \\right]_{1/3}^{1} = \\left(\\frac{3}{2} - 1\\right) - \\left(\\frac{3(1/3)^2}{2} - (1/3)^3\\right) = \\frac{1}{2} - \\left(\\frac{3/9}{2} - \\frac{1}{27}\\right) = \\frac{1}{2} - \\left(\\frac{1}{6} - \\frac{1}{27}\\right)\n$$\n$$\n= \\frac{1}{2} - \\frac{9-2}{54} = \\frac{1}{2} - \\frac{7}{54} = \\frac{27-7}{54} = \\frac{20}{54} = \\frac{10}{27}\n$$\n现在，我们将两个积分的结果相加：\n$$\n\\hat{\\theta}_{SE} = \\frac{2}{27} + \\frac{10}{27} = \\frac{12}{27} = \\frac{4}{9}\n$$\n所以，均值是 $\\hat{\\theta}_{SE} = 4/9$。\n\n**3. 中位数 ($\\hat{\\theta}_{AE}$) 的计算**\n\n中位数（我们称之为 $m$）是满足 $\\theta$ 小于 $m$ 的概率为 $0.5$ 的值。\n$$\n\\int_{0}^{m} p(\\theta|\\text{data}) d\\theta = 0.5\n$$\n首先，我们计算直到众数 $\\theta = 1/3$ 处的累积概率。\n$$\n\\int_{0}^{1/3} 6\\theta d\\theta = \\left[ 3\\theta^2 \\right]_{0}^{1/3} = 3\\left(\\frac{1}{3}\\right)^2 = 3\\left(\\frac{1}{9}\\right) = \\frac{1}{3}\n$$\n由于 $1/3 \\approx 0.333$ 小于 $0.5$，中位数必定位于第二个区间，即 $m > 1/3$。\n中位数 $m$ 满足的条件是：\n$$\n\\int_{0}^{1/3} p(\\theta|\\text{data}) d\\theta + \\int_{1/3}^{m} p(\\theta|\\text{data}) d\\theta = 0.5\n$$\n使用我们之前的计算结果：\n$$\n\\frac{1}{3} + \\int_{1/3}^{m} 3(1-\\theta) d\\theta = 0.5\n$$\n这意味着：\n$$\n\\int_{1/3}^{m} 3(1-\\theta) d\\theta = 0.5 - \\frac{1}{3} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}\n$$\n现在，我们计算这个积分：\n$$\n\\int_{1/3}^{m} 3(1-\\theta) d\\theta = \\left[ 3\\theta - \\frac{3\\theta^2}{2} \\right]_{1/3}^{m} = \\left(3m - \\frac{3m^2}{2}\\right) - \\left(3\\left(\\frac{1}{3}\\right) - \\frac{3(1/3)^2}{2}\\right)\n$$\n$$\n= \\left(3m - \\frac{3m^2}{2}\\right) - \\left(1 - \\frac{3/9}{2}\\right) = \\left(3m - \\frac{3m^2}{2}\\right) - \\left(1 - \\frac{1}{6}\\right) = 3m - \\frac{3m^2}{2} - \\frac{5}{6}\n$$\n令其等于 $1/6$：\n$$\n3m - \\frac{3m^2}{2} - \\frac{5}{6} = \\frac{1}{6}\n$$\n$$\n3m - \\frac{3m^2}{2} = \\frac{6}{6} = 1\n$$\n两边乘以 2 以消去分母，我们得到一个关于 $m$ 的二次方程：\n$$\n6m - 3m^2 = 2 \\implies 3m^2 - 6m + 2 = 0\n$$\n我们使用二次方程求根公式来解 $m$：\n$$\nm = \\frac{-(-6) \\pm \\sqrt{(-6)^2 - 4(3)(2)}}{2(3)} = \\frac{6 \\pm \\sqrt{36 - 24}}{6} = \\frac{6 \\pm \\sqrt{12}}{6} = \\frac{6 \\pm 2\\sqrt{3}}{6} = 1 \\pm \\frac{\\sqrt{3}}{3}\n$$\n我们得到两个可能的解：$m_1 = 1 + \\frac{\\sqrt{3}}{3}$ 和 $m_2 = 1 - \\frac{\\sqrt{3}}{3}$。\n由于 $\\theta$ 的定义域是 $[0, 1]$，解 $m_1 \\approx 1 + 0.577 = 1.577$ 超出了有效范围。另一个解是 $m_2 = 1 - \\frac{\\sqrt{3}}{3} \\approx 1 - 0.577 = 0.423$。这个值位于区间 $[1/3, 1] \\approx [0.333, 1]$ 内，所以这是正确的中位数。\n因此，中位数是 $\\hat{\\theta}_{AE} = 1 - \\frac{\\sqrt{3}}{3}$。\n\n**结论**\n这三个估计量是：\n- $\\hat{\\theta}_{SE}$ (均值) = $4/9$\n- $\\hat{\\theta}_{AE}$ (中位数) = $1 - \\frac{\\sqrt{3}}{3}$\n- $\\hat{\\theta}_{01}$ (众数) = $1/3$\n\n问题要求给出三元组 $(\\hat{\\theta}_{SE}, \\hat{\\theta}_{AE}, \\hat{\\theta}_{01})$。\n最终答案是 $(\\frac{4}{9}, 1 - \\frac{\\sqrt{3}}{3}, \\frac{1}{3})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{9} & 1 - \\frac{\\sqrt{3}}{3} & \\frac{1}{3} \\end{pmatrix}}$$"}]}