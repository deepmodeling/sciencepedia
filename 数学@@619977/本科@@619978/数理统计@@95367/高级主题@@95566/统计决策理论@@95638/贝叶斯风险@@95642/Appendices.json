{"hands_on_practices": [{"introduction": "这个练习将引导你完成一个计算贝叶斯风险的经典案例。在一个常见的工程场景中，我们将为指数分布的率参数估计贝叶斯风险，其中使用了共轭的伽马先验分布。这项实践旨在阐明在平方误差损失下计算贝叶斯风险的核心步骤，即对后验方差在数据的边际分布上求期望，从而为理解贝叶斯估计中的不确定性打下坚实的基础。[@problem_id:1898422]", "problem": "在可靠性工程中，电子元件的寿命通常用指数分布来建模。假设一种新型元件的失效时间 $X$ 服从一个未知速率参数为 $\\lambda > 0$ 的指数分布。其寿命的概率密度函数为 $f(x|\\lambda) = \\lambda \\exp(-\\lambda x)$，其中 $x > 0$。\n\n根据以往对类似元件的经验，我们对失效率 $\\lambda$ 有先验信念。我们使用一个伽马先验分布来为这种不确定性建模，其形状参数为已知的 $\\alpha > 0$，速率参数为已知的 $\\beta > 0$。$\\lambda$ 的先验概率密度函数为 $\\pi(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda)$，其中 $\\lambda > 0$。\n\n我们将对一个元件的寿命进行单次观测，记为 $X=x$，并用它来估计 $\\lambda$。我们的估计量 $\\hat{\\lambda}$ 的优劣通过平方误差损失函数来评估，该函数定义为 $L(\\lambda, \\hat{\\lambda}) = (\\lambda - \\hat{\\lambda})^2$。\n\n你的任务是在这些条件下，计算与估计 $\\lambda$ 相关的贝叶斯风险。贝叶斯风险是在参数的数据分布和先验分布上平均的最小可能期望损失。\n\n请用先验参数 $\\alpha$ 和 $\\beta$ 将你的答案表示为一个闭式解析表达式。", "solution": "我们从一个速率为 $\\lambda$ 的指数分布中得到单次观测 $X=x$，其中 $\\lambda$ 的先验分布是在速率参数化下的 $\\text{Gamma}(\\alpha,\\beta)$。损失函数为平方误差 $L(\\lambda,\\hat{\\lambda})=(\\lambda-\\hat{\\lambda})^{2}$。在平方误差损失下，贝叶斯估计量是后验均值，而贝叶斯风险等于后验方差的期望值：\n$$\n\\mathcal{R}_{B}=\\mathbb{E}_{X}\\!\\left[\\operatorname{Var}(\\lambda\\mid X)\\right].\n$$\n\n首先，计算后验分布。似然函数为 $f(x\\mid \\lambda)=\\lambda \\exp(-\\lambda x)$ ($x>0$)，先验分布为 $\\pi(\\lambda)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)$ ($\\lambda>0$)。根据共轭性，后验分布为\n$$\n\\lambda \\mid x \\sim \\text{Gamma}(\\alpha+1,\\beta+x),\n$$\n所以其方差为\n$$\n\\operatorname{Var}(\\lambda\\mid x)=\\frac{\\alpha+1}{(\\beta+x)^{2}}.\n$$\n因此，\n$$\n\\mathcal{R}_{B}=\\mathbb{E}_{X}\\!\\left[\\frac{\\alpha+1}{(\\beta+X)^{2}}\\right].\n$$\n\n接下来，计算 $X$ 的先验预测（边际）密度：\n$$\nf_{X}(x)=\\int_{0}^{\\infty} \\lambda \\exp(-\\lambda x)\\,\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)\\,d\\lambda\n=\\frac{\\beta^{\\alpha}\\Gamma(\\alpha+1)}{\\Gamma(\\alpha)}\\frac{1}{(\\beta+x)^{\\alpha+1}}\n=\\frac{\\alpha \\beta^{\\alpha}}{(\\beta+x)^{\\alpha+1}},\n$$\n其中 $x>0$。因此，\n$$\n\\mathcal{R}_{B}=(\\alpha+1)\\int_{0}^{\\infty}\\frac{1}{(\\beta+x)^{2}}\\cdot \\frac{\\alpha \\beta^{\\alpha}}{(\\beta+x)^{\\alpha+1}}\\,dx\n=\\alpha(\\alpha+1)\\beta^{\\alpha}\\int_{0}^{\\infty}(\\beta+x)^{-(\\alpha+3)}\\,dx.\n$$\n使用 $u=\\beta+x$ 计算该积分：\n$$\n\\int_{0}^{\\infty}(\\beta+x)^{-(\\alpha+3)}\\,dx=\\int_{\\beta}^{\\infty}u^{-(\\alpha+3)}\\,du=\\frac{\\beta^{-(\\alpha+2)}}{\\alpha+2}.\n$$\n于是，\n$$\n\\mathcal{R}_{B}=\\alpha(\\alpha+1)\\beta^{\\alpha}\\cdot \\frac{\\beta^{-(\\alpha+2)}}{\\alpha+2}=\\frac{\\alpha(\\alpha+1)}{\\alpha+2}\\cdot \\frac{1}{\\beta^{2}}.\n$$\n\n因此，在平方误差损失下，对于单次指数分布观测和 $\\text{Gamma}(\\alpha,\\beta)$ 先验，贝叶斯风险为 $\\frac{\\alpha(\\alpha+1)}{(\\alpha+2)\\beta^{2}}$。", "answer": "$$\\boxed{\\frac{\\alpha(\\alpha+1)}{(\\alpha+2)\\beta^{2}}}$$", "id": "1898422"}, {"introduction": "在掌握了基本的贝叶斯风险计算之后，让我们来探索一个更具概念性的问题。这个思想实验研究当我们的先验知识变得极其模糊时（即先验方差趋于无穷大），贝叶斯风险会如何表现。通过分析这个极限情况，你将深入理解贝叶斯方法与频率派方法之间的深刻联系，并揭示无信息先验在何种意义下会使贝叶斯分析的结果趋近于经典统计的结论。[@problem_id:1898419]", "problem": "考虑一个统计估计问题，我们想要估计一个未知参数 $\\mu$。我们关于 $\\mu$ 的先验信念由一个均值为 0、方差为 $\\tau^2$ (其中 $\\tau^2 > 0$) 的正态分布建模。我们将其记为 $\\mu \\sim N(0, \\tau^2)$。然后，我们观测一个来自正态分布的单个数据点 $X$，该分布的均值为 $\\mu$ 的真值，方差为 1，记为 $X | \\mu \\sim N(\\mu, 1)$。\n\n估计量（记为 $\\hat{\\mu}(X)$）的质量由平方误差损失函数 $L(\\mu, \\hat{\\mu}) = (\\mu - \\hat{\\mu})^2$ 来衡量。贝叶斯风险（我们将记为 $r(\\tau^2)$）被定义为最小可能期望损失，其中期望是针对 $\\mu$ 和 $X$ 的联合分布计算的。\n\n确定当先验方差趋于无穷大时，贝叶斯风险的极限值。即，计算 $\\lim_{\\tau^2 \\to \\infty} r(\\tau^2)$ 的值。请以单个数值形式给出最终答案。", "solution": "给定一个正态-正态模型，其先验为 $\\mu \\sim N(0,\\tau^{2})$，似然为 $X \\mid \\mu \\sim N(\\mu,1)$。在平方误差损失 $L(\\mu,\\hat{\\mu})=(\\mu-\\hat{\\mu})^{2}$ 下，贝叶斯估计量是后验均值：\n$$\n\\hat{\\mu}(X)=\\mathbb{E}[\\mu \\mid X].\n$$\n根据共轭性，后验分布是正态分布，其精度等于先验精度和似然精度之和。因此\n$$\n\\operatorname{Var}(\\mu \\mid X)=\\left(\\frac{1}{\\tau^{2}}+1\\right)^{-1}=\\frac{\\tau^{2}}{1+\\tau^{2}},\n$$\n且\n$$\n\\mathbb{E}[\\mu \\mid X]=\\operatorname{Var}(\\mu \\mid X)\\left(\\frac{0}{\\tau^{2}}+X\\right)=\\frac{\\tau^{2}}{1+\\tau^{2}}\\,X.\n$$\n贝叶斯风险是所有估计量中的最小期望损失，对于平方误差损失和贝叶斯法则，它等于期望后验方差：\n$$\nr(\\tau^{2})=\\mathbb{E}\\big[(\\mu-\\hat{\\mu}(X))^{2}\\big]=\\mathbb{E}\\big[\\operatorname{Var}(\\mu \\mid X)\\big]=\\frac{\\tau^{2}}{1+\\tau^{2}},\n$$\n其中期望的计算是平凡的，因为 $\\operatorname{Var}(\\mu \\mid X)$ 不依赖于 $X$。\n\n因此，当 $\\tau^{2}\\to\\infty$ 时，极限贝叶斯风险是\n$$\n\\lim_{\\tau^{2}\\to\\infty} r(\\tau^{2})=\\lim_{\\tau^{2}\\to\\infty} \\frac{\\tau^{2}}{1+\\tau^{2}}=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1898419"}, {"introduction": "贝叶斯估计量在理论上具有最优性，但在实际应用中我们可能面临各种限制。这个练习通过一个具体案例，比较了标准的贝叶斯估计量与一个受约束的决策规则的风险。通过计算并比较两种估计量的贝叶斯风险，你将能从量化的角度理解贝叶斯估计量的“最优”意味着什么，并体会现实世界中的约束如何影响估计性能。[@problem_id:1898413]", "problem": "一位工程师正在测试一个生产特定类型半导体的制造过程。每个半导体的质量可以被建模为一次独立的伯努利试验，其中半导体为无缺陷品的概率为 $p$。该工程师对 $p$ 值的先验信念由一个参数为 $\\alpha=1$ 和 $\\beta=1$ 的贝塔分布建模，即 $p \\sim \\text{Beta}(1, 1)$。为了更新这一信念，工程师测试了一批 $n=4$ 个半导体，并观察到无缺陷品的总数 $S$。\n\n工程师考虑了两种基于观测数据 $S$ 的关于参数 $p$ 的不同决策规则（估计量）。估计量 $\\delta$ 的性能通过平方误差损失函数 $L(p, \\delta) = (p - \\delta)^2$ 进行评估。\n\n第一个估计量 $\\delta_B$ 是该模型的标准贝叶斯估计量，它最小化后验期望损失。\n\n第二个估计量 $\\delta_C$ 是一个受约束的估计量。由于系统限制，该估计量必须从离散集合 $D = \\{0, 0.25, 0.5, 0.75, 1\\}$ 中选择其对 $p$ 的估计值。对于给定的成功次数 $S=k$，规则 $\\delta_C$ 从集合 $D$ 中选择使后验期望平方误差损失最小化的值。\n\n任何估计量 $\\delta$ 的总体性能由其贝叶斯风险 $r(\\delta)$ 来衡量，它是损失函数在 $p$ 的先验分布和数据 $S$ 的抽样分布上的期望值。\n\n计算这两个估计量的贝叶斯风险之差 $r(\\delta_C) - r(\\delta_B)$。请将您的答案表示为最简精确分数形式。", "solution": "设 $p \\sim \\text{Beta}(\\alpha,\\beta)$，其中 $\\alpha=\\beta=1$，且 $S \\mid p \\sim \\text{Binomial}(n,p)$，其中 $n=4$。在平方误差损失下，贝叶斯估计量是后验均值。给定 $S=k$ 时，后验分布为 $\\text{Beta}(\\alpha+k,\\beta+n-k)=\\text{Beta}(k+1,5-k)$，因此贝叶斯估计量为\n$$\n\\delta_{B}(k)=\\mathbb{E}[p \\mid S=k]=\\frac{k+\\alpha}{\\alpha+\\beta+n}=\\frac{k+1}{6}.\n$$\n记 $\\mu_{k}=\\delta_{B}(k)=\\frac{k+1}{6}$。\n\n对于任何估计量 $\\delta(S)$，后验期望平方损失可分解为\n$$\n\\mathbb{E}\\big[(p-\\delta(S))^{2}\\mid S\\big]=\\operatorname{Var}(p\\mid S)+\\big(\\mathbb{E}[p\\mid S]-\\delta(S)\\big)^{2}\n=\\operatorname{Var}(p\\mid S)+\\big(\\mu_{S}-\\delta(S)\\big)^{2}.\n$$\n因此，\n$$\nr(\\delta_{C})-r(\\delta_{B})=\\mathbb{E}\\big[(\\mu_{S}-\\delta_{C}(S))^{2}\\big],\n$$\n其中，期望是关于 $S$ 的先验预测分布计算的。\n\n受约束的估计量 $\\delta_{C}(k)$ 必须位于集合 $D=\\{0,\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{3}{4},1\\}$ 中，并且要最小化后验期望损失，根据上面的二次型，这等价于从 $D$ 中选择最接近 $\\mu_{k}$ 的元素。计算当 $k=0,1,2,3,4$ 时的 $\\mu_{k}$：\n$$\n\\mu_{0}=\\frac{1}{6},\\quad \\mu_{1}=\\frac{1}{3},\\quad \\mu_{2}=\\frac{1}{2},\\quad \\mu_{3}=\\frac{2}{3},\\quad \\mu_{4}=\\frac{5}{6}.\n$$\n$D$ 中最接近的元素为\n$$\n\\delta_{C}(0)=\\frac{1}{4},\\quad \\delta_{C}(1)=\\frac{1}{4},\\quad \\delta_{C}(2)=\\frac{1}{2},\\quad \\delta_{C}(3)=\\frac{3}{4},\\quad \\delta_{C}(4)=\\frac{3}{4}.\n$$\n因此，平方偏差为\n$$\n(\\mu_{0}-\\delta_{C}(0))^{2}=\\left(\\frac{1}{6}-\\frac{1}{4}\\right)^{2}=\\frac{1}{144},\\quad\n(\\mu_{1}-\\delta_{C}(1))^{2}=\\left(\\frac{1}{3}-\\frac{1}{4}\\right)^{2}=\\frac{1}{144},\n$$\n$$\n(\\mu_{2}-\\delta_{C}(2))^{2}=0,\\quad\n(\\mu_{3}-\\delta_{C}(3))^{2}=\\left(\\frac{2}{3}-\\frac{3}{4}\\right)^{2}=\\frac{1}{144},\\quad\n(\\mu_{4}-\\delta_{C}(4))^{2}=\\left(\\frac{5}{6}-\\frac{3}{4}\\right)^{2}=\\frac{1}{144}.\n$$\n\n在 $\\text{Beta}(1,1)$ 先验下，$S$ 的先验预测分布为\n$$\n\\mathbb{P}(S=k)=\\int_{0}^{1}\\binom{4}{k}p^{k}(1-p)^{4-k}\\,dp=\\binom{4}{k}B(k+1,5-k)=\\frac{1}{5},\n$$\n对于 $k=0,1,2,3,4$，因为 $B(k+1,5-k)=\\frac{k!(4-k)!}{5!}$ 并且 $\\binom{4}{k}\\frac{k!(4-k)!}{5!}=\\frac{1}{5}$。\n\n因此，\n$$\nr(\\delta_{C})-r(\\delta_{B})=\\sum_{k=0}^{4}\\mathbb{P}(S=k)\\,(\\mu_{k}-\\delta_{C}(k))^{2}\n=\\frac{1}{5}\\left(\\frac{1}{144}+\\frac{1}{144}+0+\\frac{1}{144}+\\frac{1}{144}\\right)\n=\\frac{4}{5}\\cdot\\frac{1}{144}\n=\\frac{1}{180}.\n$$", "answer": "$$\\boxed{\\frac{1}{180}}$$", "id": "1898413"}]}