{"hands_on_practices": [{"introduction": "不正常先验是贝叶斯统计中的一个强大工具，但其使用有一个关键前提：产生的后验分布必须是正常的。本练习旨在探讨我们收集的数据量与后验分布正当性之间的基本关系，揭示数据是如何“拯救”一个不正常先验的。通过研究指数分布模型，你将亲手计算出确保后验分布正常所需的最小样本量 [@problem_id:1922090]。", "problem": "一位统计学家正在分析某种电子元件的寿命。单个元件的寿命 $X$ 由一个指数分布建模，其率参数 $\\lambda > 0$ 未知。单个观测值的概率密度函数 (PDF) 为 $f(x|\\lambda) = \\lambda \\exp(-\\lambda x)$，其中 $x > 0$。\n\n为了对 $n$ 个元件的随机样本 $X_1, X_2, \\ldots, X_n$ 进行贝叶斯分析，该统计学家为参数 $\\lambda$ 选择了一个不正常先验分布。该先验由关系式 $p(\\lambda) \\propto \\lambda^{-3}$ 定义，其中 $\\lambda > 0$。不正常先验是指在其定义域上的积分不为有限值的先验。\n\n为了使贝叶斯推断有效，所得到的后验分布 $p(\\lambda | X_1, \\ldots, X_n)$ 必须是一个正常分布。如果一个分布在其整个定义域上的积分为有限值，则称其为“正常”的，这使得它可以被归一化为一个有效的概率分布。\n\n假设对于任何抽取的样本（即，对于 $n \\geq 1$），观测寿命之和为正，请确定所需的最小整数样本量 $n$，以确保 $\\lambda$ 的后验分布是正常的。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是独立同分布于 $\\operatorname{Exp}(\\lambda)$ 的随机变量，其密度函数为 $f(x \\mid \\lambda)=\\lambda \\exp(-\\lambda x)$，其中 $x>0$。联合似然函数是\n$$\nL(\\lambda \\mid x_{1},\\ldots,x_{n})=\\prod_{i=1}^{n}\\lambda \\exp(-\\lambda x_{i})=\\lambda^{n}\\exp\\!\\left(-\\lambda \\sum_{i=1}^{n}x_{i}\\right).\n$$\n令 $S=\\sum_{i=1}^{n}x_{i}$。先验是不正常的，其密度核为 $p(\\lambda)\\propto \\lambda^{-3}$，其中 $\\lambda>0$。那么后验密度核为\n$$\np(\\lambda \\mid x_{1},\\ldots,x_{n}) \\propto L(\\lambda \\mid x_{1},\\ldots,x_{n})\\,p(\\lambda)\n= \\lambda^{n}\\exp(-\\lambda S)\\cdot \\lambda^{-3}\n= \\lambda^{n-3}\\exp(-\\lambda S), \\quad \\lambda>0.\n$$\n假设 $S>0$，这与一个伽马分布的密度成正比，其形状参数为 $\\alpha=n-2$，率参数为 $\\beta=S$，因为伽马核为 $\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)$。后验分布是正常的当且仅当其在 $(0,\\infty)$ 上的积分为有限值：\n$$\n\\int_{0}^{\\infty}\\lambda^{n-3}\\exp(-S\\lambda)\\,d\\lambda<\\infty.\n$$\n使用标准的伽马积分，\n$$\n\\int_{0}^{\\infty}\\lambda^{a-1}\\exp(-\\beta \\lambda)\\,d\\lambda=\\frac{\\Gamma(a)}{\\beta^{a}} \\quad \\text{for } a>0,\\ \\beta>0,\n$$\n我们识别出 $a-1=n-3$，即 $a=n-2$，以及 $\\beta=S$。由于根据假设 $S>0$，积分的有限性要求 $a>0$，即，\n$$\nn-2>0 \\quad \\Longleftrightarrow \\quad n>2.\n$$\n因为 $n$ 是一个整数，确保后验分布正常的最小 $n$ 是 $n=3$。对于 $n=2$，被积函数在 $0$ 附近的行为类似于 $\\lambda^{-1}$，积分发散；对于 $n=1$，其在 $0$ 附近的行为类似于 $\\lambda^{-2}$，积分也发散。", "answer": "$$\\boxed{3}$$", "id": "1922090"}, {"introduction": "虽然数据通常可以确保后验分布的正常性，但这并非总是如此，某些不正常先验可能“过于宽泛”，以至于少量数据也无法使其正则化。本练习提供了一个重要的警示案例，将使用著名的Haldane先验来分析伯努利试验。你将发现，即使在观察到一个数据点后，后验分布有时仍然是不正常的，这凸显了在使用不正常先验时检验后验正当性的必要性 [@problem_id:1922144]。", "problem": "在贝叶斯推断中，如果一个参数的先验分布在其定义域上的积分不为有限值，则称该先验分布为*不正常的* (improper)。一个不正常的先验不能代表一个真实的概率分布。然而，在许多情况下，将一个不正常的先验与观测数据结合，可以得到一个*正常的* (proper) 后验分布，这是一个积分为一的有效概率分布。\n\n考虑一个单次实验，其结果可能为成功 ($X=1$) 或失败 ($X=0$) 。这被称为伯努利试验。成功的概率由一个未知参数 $p$ 决定，其中 $p$ 位于区间 $(0, 1)$ 内。单个观测值 $x$ 的概率质量函数（即似然）由 $f(x|p) = p^{x}(1-p)^{1-x}$ 给出。\n\n对于参数 $p$，我们采用 Haldane 先验，它是一个不正常的先验分布，由以下正比关系指定：\n$$\np(p) \\propto \\frac{1}{p(1-p)} \\quad \\text{for } 0 < p < 1\n$$\n假设实验进行了一次，结果为成功 ($x=1$)。后验分布 $p(p|x=1)$ 正比于似然与先验的乘积。\n\n以下哪个陈述正确地描述了参数 $p$ 的后验分布？\n\nA. 是的，参数 $p$ 的后验分布是正常的。\n\nB. 不，参数 $p$ 的后验分布是不正常的。\n\nC. 只有在观测到失败 ($x=0$) 而不是成功时，参数 $p$ 的后验分布才会是正常的。\n\nD. 由于先验分布是不正常的，因此无法确定后验分布的正常性。", "solution": "后验密度正比于似然与先验的乘积。对于观测值为 $x=1$ 的单次伯努利试验，其似然为\n$$\nf(1 \\mid p)=p^{1}(1-p)^{0}=p,\n$$\n且 Haldane 先验为\n$$\n\\pi(p)\\propto \\frac{1}{p(1-p)}, \\quad 0<p<1.\n$$\n因此，未归一化的后验为\n$$\n\\pi(p \\mid x=1)\\propto f(1 \\mid p)\\,\\pi(p)=p \\cdot \\frac{1}{p(1-p)}=\\frac{1}{1-p}, \\quad 0<p<1.\n$$\n为判断其正常性，我们检查它是否可以在 $(0,1)$ 上进行归一化。归一化常数应为\n$$\nC^{-1}=\\int_{0}^{1}\\frac{1}{1-p}\\,dp.\n$$\n通过换元 $u=1-p$, $du=-dp$，该积分变为\n$$\n\\int_{0}^{1}\\frac{1}{1-p}\\,dp=\\int_{1}^{0}\\frac{-1}{u}\\,du=\\int_{0}^{1}\\frac{1}{u}\\,du,\n$$\n该积分发散至 $+\\infty$。因此，不存在有限的归一化常数，后验分布是不正常的。\n\n为了完整起见，如果观测到 $x=0$，则未归一化的后验将为\n$$\n\\pi(p \\mid x=0)\\propto (1-p)\\cdot \\frac{1}{p(1-p)}=\\frac{1}{p},\n$$\n且\n$$\n\\int_{0}^{1}\\frac{1}{p}\\,dp=+\\infty,\n$$\n因此这种情况下的后验分布也是不正常的。所以，正确的陈述是：对于 $x=1$ 的后验分布是不正常的，并且尽管先验是不正常的，后验的正常性仍然可以被确定。", "answer": "$$\\boxed{B}$$", "id": "1922144"}, {"introduction": "当我们确认后验分布是正常的之后，下一个问题便是：我们选择的“无信息”先验对推断结果究竟有何影响？本练习将通过一个正态均值的例子，对比两种看似都代表“先验知识缺乏”的不正常先验。你将计算并比较这两种不同先验选择所导致的后验期望，从而深刻理解到，选择哪种不正常先验本身就是一个具有实际影响的主动建模决策 [@problem_id:1922111]。", "problem": "考虑从一个均值 $\\mu$ 未知、方差为 1 已知的正态分布中抽取的单个观测值 $x$。给定参数 $\\mu$，该观测值的概率密度函数 (PDF) 为 $f(x|\\mu) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}(x-\\mu)^2\\right)$。\n\n提出了两种不同的贝叶斯模型来对未知参数 $\\mu$ 进行推断。\n\n- **模型 1**：此模型对 $\\mu$ 使用一个不正常先验分布，其密度定义为 $p_1(\\mu) \\propto 1$，适用于所有实数 $\\mu$。\n- **模型 2**：此模型对 $\\mu$ 使用另一个不正常先验分布，其密度定义为 $p_2(\\mu) \\propto I(\\mu > 0)$，其中 $I(\\cdot)$ 是指示函数，当其参数为真时值为 1，否则为 0。\n\n令 $E_1[\\mu]$ 为根据模型 1 导出的后验分布下 $\\mu$ 的期望值，令 $E_2[\\mu]$ 为根据模型 2 导出的后验分布下 $\\mu$ 的期望值。\n\n确定比率 $\\frac{E_2[\\mu]}{E_1[\\mu]}$ 作为观测值 $x$ 的函数。最终表达式可包含标准正态 PDF $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$ 和标准正态累积分布函数 (CDF) $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t) dt$。", "solution": "我们有一个来自 $X \\mid \\mu \\sim \\mathcal{N}(\\mu,1)$ 的观测值 $x$，因此作为 $\\mu$ 的函数的似然函数正比于 $f(x \\mid \\mu) \\propto \\exp\\!\\left(-\\frac{1}{2}(x-\\mu)^{2}\\right)$，等价于 $f(x \\mid \\mu) \\propto \\phi(x-\\mu)$，其中 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{z^{2}}{2}\\right)$。\n\n模型 1 的先验为 $p_{1}(\\mu) \\propto 1$，适用于 $\\mu \\in \\mathbb{R}$。其后验分布为\n$$\np_{1}(\\mu \\mid x) \\propto f(x \\mid \\mu) p_{1}(\\mu) \\propto \\phi(x-\\mu).\n$$\n由于 $\\int_{-\\infty}^{\\infty} \\phi(x-\\mu)\\,d\\mu = 1$，归一化后的后验分布为 $p_{1}(\\mu \\mid x) = \\phi(\\mu - x)$，即 $\\mu \\mid x \\sim \\mathcal{N}(x,1)$。因此，\n$$\nE_{1}[\\mu] \\;=\\; \\int_{-\\infty}^{\\infty} \\mu\\, \\phi(\\mu - x)\\, d\\mu.\n$$\n通过变量替换 $t = \\mu - x$（因此 $\\mu = t + x$ 且 $d\\mu = dt$），我们得到\n$$\nE_{1}[\\mu] = \\int_{-\\infty}^{\\infty} (t + x)\\, \\phi(t)\\, dt \\;=\\; x \\int_{-\\infty}^{\\infty} \\phi(t)\\, dt \\;+\\; \\int_{-\\infty}^{\\infty} t\\, \\phi(t)\\, dt \\;=\\; x + 0 \\;=\\; x.\n$$\n\n模型 2 的先验为 $p_{2}(\\mu) \\propto I(\\mu > 0)$。其后验分布为\n$$\np_{2}(\\mu \\mid x) \\propto \\phi(x-\\mu)\\, I(\\mu > 0).\n$$\n为进行归一化，计算\n$$\n\\int_{0}^{\\infty} \\phi(x-\\mu)\\, d\\mu \\;=\\; \\int_{0}^{\\infty} \\phi(\\mu - x)\\, d\\mu \\;=\\; \\int_{-x}^{\\infty} \\phi(t)\\, dt \\;=\\; 1 - \\Phi(-x) \\;=\\; \\Phi(x),\n$$\n其中 $\\Phi$ 是标准正态 CDF，我们利用了性质 $\\Phi(-x) = 1 - \\Phi(x)$。因此，归一化后的后验分布为\n$$\np_{2}(\\mu \\mid x) \\;=\\; \\frac{\\phi(\\mu - x)}{\\Phi(x)}\\, I(\\mu > 0).\n$$\n因此，\n$$\nE_{2}[\\mu] \\;=\\; \\int_{0}^{\\infty} \\mu\\, \\frac{\\phi(\\mu - x)}{\\Phi(x)}\\, d\\mu \\;=\\; \\frac{1}{\\Phi(x)} \\int_{0}^{\\infty} \\mu\\, \\phi(\\mu - x)\\, d\\mu.\n$$\n应用变量替换 $t = \\mu - x$（因此 $\\mu = t + x$, $d\\mu = dt$，积分下限变为 $t = -x$）：\n$$\nE_{2}[\\mu] \\;=\\; \\frac{1}{\\Phi(x)} \\int_{-x}^{\\infty} (t + x)\\, \\phi(t)\\, dt \\;=\\; \\frac{1}{\\Phi(x)} \\left[ x \\int_{-x}^{\\infty} \\phi(t)\\, dt \\;+\\; \\int_{-x}^{\\infty} t\\, \\phi(t)\\, dt \\right].\n$$\n计算积分：\n- $\\int_{-x}^{\\infty} \\phi(t)\\, dt = 1 - \\Phi(-x) = \\Phi(x)$。\n- 对于第二个积分，利用 $\\frac{d}{dt}\\phi(t) = -t\\,\\phi(t)$，因此 $\\int t\\, \\phi(t)\\, dt = -\\phi(t) + C$，可得\n$$\n\\int_{-x}^{\\infty} t\\, \\phi(t)\\, dt \\;=\\; \\left[-\\phi(t)\\right]_{-x}^{\\infty} \\;=\\; 0 - \\left(-\\phi(-x)\\right) \\;=\\; \\phi(-x) \\;=\\; \\phi(x).\n$$\n因此，\n$$\nE_{2}[\\mu] \\;=\\; \\frac{1}{\\Phi(x)} \\left[ x\\, \\Phi(x) + \\phi(x) \\right] \\;=\\; x \\;+\\; \\frac{\\phi(x)}{\\Phi(x)}.\n$$\n\n最后，比率为\n$$\n\\frac{E_{2}[\\mu]}{E_{1}[\\mu]} \\;=\\; \\frac{x + \\frac{\\phi(x)}{\\Phi(x)}}{x} \\;=\\; 1 + \\frac{\\phi(x)}{x\\, \\Phi(x)},\n$$\n此式在 $x \\neq 0$ 时有定义；当 $x=0$ 时，由于 $E_{1}[\\mu]=0$，该比率无定义。", "answer": "$$\\boxed{1+\\frac{\\phi(x)}{x\\,\\Phi(x)}}$$", "id": "1922111"}]}