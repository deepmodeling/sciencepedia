{"hands_on_practices": [{"introduction": "掌握最高后验密度区间 (Highest Posterior Density Interval, HPDI) 的第一步是理解其严格的数学定义。本练习将通过一个非对称的贝叶斯后验分布（贝塔分布）来探讨定义 HPDI 的两个关键条件：指定的概率质量和端点处的等密度。理解这些条件有助于你将其与更简单的等尾区间区分开来，这是精确应用贝叶斯方法的关键 [@problem_id:1921049]。", "problem": "我们进行一项贝叶斯统计分析，以估计一个未知的总体比例，该比例由参数 $p$ 表示，其中 $0 < p < 1$。在收集和分析数据后，得到的 $p$ 的后验分布被确定为参数是 $\\alpha=3$ 和 $\\beta=9$ 的贝塔分布。\n\n回顾一下，对于一个服从形状参数为 $\\alpha$ 和 $\\beta$ 的贝塔分布（记作 $\\text{Beta}(\\alpha, \\beta)$）的参数 $\\theta$，其概率密度函数 (PDF) 由下式给出：\n$$f(\\theta | \\alpha, \\beta) = \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n对于 $0 < \\theta < 1$。此处，$B(\\alpha, \\beta)$ 是贝塔函数，作为归一化常数。\n\n我们想要找到参数 $p$ 的 95% 最高后验密度区间 (Highest Posterior Density Interval, HPDI)。一个 95% HPDI 被定义为区间 $[L, U]$，该区间包含 95% 的后验概率质量，并且具有最短的可能长度。对于像本题给出的这种单峰后验分布，这意味着在下界 $L$ 和上界 $U$ 处的后验密度之间存在一种特定的关系。\n\n下列哪对方程组正确且完整地定义了后验分布 $\\text{Beta}(3, 9)$ 的 95% HPDI 的端点 $L$ 和 $U$？\n\nA. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ 和 $U - L = 0.95$\n\nB. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ 和 $L^2 (1-L)^8 = U^2 (1-U)^8$\n\nC. $\\int_0^L \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$ 和 $\\int_U^1 \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$\n\nD. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ 和 $L = 0.025$\n\nE. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ 和 $L=U$", "solution": "$p$ 在 $\\text{Beta}(3,9)$ 分布下的后验密度为\n$$\nf(p)=\\frac{p^{2}(1-p)^{8}}{B(3,9)}, \\quad 0<p<1.\n$$\n对于单峰后验分布，一个 $0.95$ 最高后验密度区间 (HPDI) 被定义为满足以下条件的区间 $[L,U]$：\n1) 包含的概率质量为 $0.95$，这要求\n$$\n\\int_{L}^{U} f(p)\\,dp=\\int_{L}^{U} \\frac{p^{2}(1-p)^{8}}{B(3,9)}\\,dp=0.95,\n$$\n因为归一化密度在该区间上的积分必须等于所需的后验概率。\n2) 端点处的后验密度相等（这是定义 HPDI 的恒定密度阈值），这要求\n$$\nf(L)=f(U) \\quad \\Longleftrightarrow \\quad \\frac{L^{2}(1-L)^{8}}{B(3,9)}=\\frac{U^{2}(1-U)^{8}}{B(3,9)} \\quad \\Longleftrightarrow \\quad L^{2}(1-L)^{8}=U^{2}(1-U)^{8}.\n$$\n这两个方程共同唯一地定义了 $0.95$ HPDI 的 $L$ 和 $U$。这与选项 B 完全对应。选项 A 和 D 在概率条件中错误地省略了归一化常数（并包含了不正确的附加约束），选项 C 给出的是等尾区间条件而非最高密度区间条件，而选项 E 是退化的。", "answer": "$$\\boxed{B}$$", "id": "1921049"}, {"introduction": "在掌握了 HPDI 的理论定义后，让我们通过一个经典的分析案例进行计算。本练习将引导你为正态分布的均值参数 $\\mu$ 计算 HPDI，这是一个在科学和工程领域中常见的场景。你将会发现，在后验分布对称的特殊情况下，HPDI 的计算可以简化为我们所熟悉的中心可信区间，从而让你轻松地完成第一次 HPDI 的动手计算 [@problem_id:1921068]。", "problem": "一家制造商生产高精度电阻器。已知这些元件的电阻服从正态分布，其均值为 $\\mu$，标准差为 $\\sigma = 10.0$ 欧姆，该标准差是根据大量的历史数据确定的。在测试新生产批次之前，一位工程师对平均电阻 $\\mu$ 的先验信念被建模为均值为 $\\mu_0 = 1000.0$ 欧姆、标准差为 $\\tau = 4.0$ 欧姆的正态分布。\n\n从新批次中随机抽取 $n=25$ 个电阻器样本，测得其平均电阻为 $\\bar{x} = 998.5$ 欧姆。\n\n根据此样本和工程师的先验信念，确定该批次真实平均电阻 $\\mu$（单位：欧姆）的 99% 最高密度区间。给出区间的下界和上界，并将最终答案四舍五入到四位有效数字。", "solution": "抽样模型具有已知的标准差 $\\sigma$，因此样本均值 $\\bar{X}$ 满足 $\\bar{X}\\mid\\mu\\sim\\mathcal{N}\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right)$。先验分布为 $\\mu\\sim\\mathcal{N}(\\mu_{0},\\tau^{2})$。根据正态-正态共轭性，后验分布为 $\\mu\\mid\\bar{x}\\sim\\mathcal{N}(m_{n},v_{n})$，其中\n$$\nv_{n}=\\left(\\frac{1}{\\tau^{2}}+\\frac{1}{\\sigma^{2}/n}\\right)^{-1},\\qquad\nm_{n}=v_{n}\\left(\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{\\bar{x}}{\\sigma^{2}/n}\\right).\n$$\n代入 $\\sigma=10.0$, $n=25$, $\\mu_{0}=1000.0$, $\\tau=4.0$ 和 $\\bar{x}=998.5$，我们得到 $\\sigma^{2}/n=\\frac{100}{25}=4$，因此\n$$\nv_{n}=\\left(\\frac{1}{16}+\\frac{1}{4}\\right)^{-1}=\\left(\\frac{1}{16}+\\frac{4}{16}\\right)^{-1}=\\left(\\frac{5}{16}\\right)^{-1}=\\frac{16}{5}=3.2,\\qquad \\sqrt{v_{n}}=\\frac{4}{\\sqrt{5}}.\n$$\n对于均值，\n$$\nm_{n}=v_{n}\\left(\\frac{1000.0}{16}+\\frac{998.5}{4}\\right)=\\frac{16}{5}\\left(62.5+249.625\\right)=\\frac{16}{5}\\cdot 312.125=\\frac{4994}{5}=998.8.\n$$\n由于后验分布是正态且对称的，99% 最高密度区间等于中心 99% 可信区间，\n$$\n\\left[m_{n}-z_{0.995}\\sqrt{v_{n}},\\;m_{n}+z_{0.995}\\sqrt{v_{n}}\\right],\n$$\n其中 $z_{0.995}$ 是标准正态分布的 $0.995$ 分位数。使用 $z_{0.995}\\approx 2.575829$，半宽度为\n$$\nz_{0.995}\\sqrt{v_{n}}\\approx 2.575829\\cdot\\frac{4}{\\sqrt{5}}\\approx 4.60778354.\n$$\n因此，99% 最高密度区间的界限为\n$$\n998.8-4.60778354\\approx 994.19221646,\\qquad 998.8+4.60778354\\approx 1003.40778354.\n$$\n将每个界限四舍五入到四位有效数字，得到 $994.2$ 和 $1003$。", "answer": "$$\\boxed{\\begin{pmatrix} 994.2 & 1003 \\end{pmatrix}}$$", "id": "1921068"}, {"introduction": "在现代贝叶斯分析中，后验分布通常非常复杂，难以解析求解，因此我们常使用马尔可夫链蒙特卡洛 (Markov Chain Monte Carlo, MCMC) 等模拟方法。这就引出了一个实际问题：如何从一系列后验样本中估计 HPDI？本练习将介绍一种从离散样本中找出最短概率区间的核心算法，这是将贝叶斯理论应用于复杂模型的必备技能 [@problem_id:1921054]。", "problem": "一位研究人员正在使用贝叶斯推断来研究一个参数 $\\theta$，该参数代表一种新学习算法的平均效果。在运行马尔可夫链蒙特卡洛 (MCMC) 模拟后，她从 $\\theta$ 的后验分布中获得了大量样本 $\\{\\theta_1, \\theta_2, \\dots, \\theta_N\\}$。在她的分析中，她需要计算95%最高后验密度区间 (HPDI)。HPDI被定义为包含95%后验概率质量的最短可能区间。\n\n假设她有这组 $N$ 个后验样本，以下哪种算法能正确估计95%的HPDI？\n\nA.\n1. 将样本按升序排序得到 $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$。\n2. 令 $k = \\lceil 0.95 \\times N \\rceil$。\n3. 考虑所有形式为 $[\\theta_{(i)}, \\theta_{(i+k-1)}]$ 的区间，其中 $i=1, \\dots, N-k+1$。\n4. 选择使得宽度 $\\theta_{(i+k-1)} - \\theta_{(i)}$ 最小的区间。\n\nB.\n1. 将样本按升序排序得到 $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$。\n2. 计算下界索引 $l = \\lfloor 0.025 \\times N \\rfloor$ 和上界索引 $u = \\lceil 0.975 \\times N \\rceil$。\n3. 区间由 $[\\theta_{(l)}, \\theta_{(u)}]$ 给出。\n\nC.\n1. 计算样本均值 $\\bar{\\theta} = \\frac{1}{N} \\sum_{i=1}^N \\theta_i$ 和样本标准差 $s = \\sqrt{\\frac{1}{N-1} \\sum_{i=1}^N (\\theta_i - \\bar{\\theta})^2}$。\n2. 区间由 $[\\bar{\\theta} - 1.96 s, \\bar{\\theta} + 1.96 s]$ 给出。\n\nD.\n1. 对样本排序并找到中位数 $\\theta_{\\text{median}} = \\theta_{(\\lceil N/2 \\rceil)}$。\n2. 找到最小的值 $w$，使得区间 $[\\theta_{\\text{median}} - w, \\theta_{\\text{median}} + w]$ 恰好包含95%的样本。\n\nE.\n1. 估计样本的众数（频率最高的值）$\\theta_{\\text{mode}}$。\n2. 找到最小的值 $w$，使得区间 $[\\theta_{\\text{mode}} - w, \\theta_{\\text{mode}} + w]$ 恰好包含95%的样本。", "solution": "我们给定从 $\\theta$ 的后验分布中抽取的后验样本 $\\{\\theta_{1},\\dots,\\theta_{N}\\}$。根据定义，$0.95$ 最高后验密度区间 (HPDI) 是包含 $0.95$ 后验概率质量的最小宽度区间。对于一个连续的单峰后验密度 $p(\\theta\\mid\\text{data})$，HPDI可以表征为\n$$\nI^{\\ast}=\\arg\\min_{I:\\ \\int_{I} p(\\theta\\mid\\text{data})\\,d\\theta=0.95}\\ \\text{length}(I),\n$$\n并且HPDI包含所有密度超过某个阈值的点，该阈值的选择使得其内部的概率质量等于 $0.95$。利用后验样本，我们通过找到包含 $0.95$ 比例样本的最短区间来近似这个区间。\n\n要从样本中实现这一点，请按以下步骤操作。\n\n1. 对样本进行排序以获得顺序统计量 $\\{\\theta_{(1)},\\dots,\\theta_{(N)}\\}$。\n\n2. 令 $k=\\lceil 0.95 N\\rceil$。任何包含至少 $0.95$ 后验质量的区间，在样本的经验分布下，应至少包含 $k$ 个样本。在所有这些经验区间中，最短的候选区间恰好是那些端点为相邻顺序统计量且跨越了 $k$ 个样本的区间，即形式为 $[\\theta_{(i)},\\theta_{(i+k-1)}]$ 的区间，其中 $i=1,\\dots,N-k+1$。\n\n3. 对每个 $i$，计算宽度\n$$\nw_{i}=\\theta_{(i+k-1)}-\\theta_{(i)}.\n$$\n选择 $w_{i}$ 最小的区间。这个区间是包含至少 $0.95$ 样本的经验最短区间，也就是 $0.95$ HPDI 的标准基于样本的估计量。\n\n这个过程与算法A完全一致。\n\n现在我们来验证为什么其他选项通常不能产生HPDI。\n\n- 选项B使用 $0.025$ 和 $0.975$ 处的经验分位数构造等尾区间。这产生了一个中心或等尾可信区间，当后验分布不对称或多峰时，它不保证是覆盖 $0.95$ 概率的最短区间。因此，它通常不是HPDI。\n\n- 选项C使用 $\\bar{\\theta}\\pm 1.96\\,s$，它假设近似正态性，并构造一个以均值为中心的对称区间。这是一个正态近似可信区间，通常不是HPDI，特别是对于非正态或有偏的后验分布。\n\n- 选项D将区间以中位数为中心并强制对称。HPDI不必须是对称的，也不必以中位数为中心；强制对称性可能会产生比必要更宽的区间，因此这不是通用的HPDI。\n\n- 选项E将区间以众数为中心并强制对称。虽然对于单峰后验分布，HPDI通常包含众数，但除非后验分布本身是对称的，否则它不一定是对称的。强制对称性同样会使区间宽度并非最优，因此这不是通用的HPDI。\n\n因此，通常只有算法A能从后验样本中正确估计 $0.95$ HPDI。", "answer": "$$\\boxed{A}$$", "id": "1921054"}]}