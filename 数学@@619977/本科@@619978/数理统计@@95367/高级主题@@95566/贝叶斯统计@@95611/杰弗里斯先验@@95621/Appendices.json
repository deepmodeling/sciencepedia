{"hands_on_practices": [{"introduction": "我们从一个典型且重要的例子开始：为尺度参数（scale parameter）推导Jeffreys先验。在许多物理和工程模型中，例如本题中的瑞利分布（Rayleigh distribution），尺度参数描述了数据分散或伸缩的程度。通过这个练习，你将实践从对数似然函数出发计算费雪信息（Fisher Information）的基本步骤，并推导出针对尺度参数$\\sigma$的Jeffreys先验，这是一种在缺乏具体先验信息时广泛使用的“无信息”先验。[@problem_id:1925852]", "problem": "在无线通信领域，经历多径散射的接收信号其振幅通常用瑞利分布来建模。接收机的一项关键任务是估计噪声和信号环境的特征。一种方法是使用贝叶斯方法，这需要为模型的参数设定一个先验分布。\n\n考虑从一个瑞利分布中抽取的单次测量值 $x$，其概率密度函数 (PDF) 如下：\n$$f(x; \\sigma) = \\frac{x}{\\sigma^2} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\n其中 $x \\geq 0$。参数 $\\sigma > 0$ 是该分布的尺度参数。\n\n在没有很强先验信念的情况下开始贝叶斯分析，可以使用无信息先验。杰弗里斯先验是一种常用的选择，它源自似然函数的结构。对于参数 $\\theta$，杰弗里斯先验 $\\pi(\\theta)$ 定义为与费雪信息 $I(\\theta)$ 的平方根成正比：\n$$\\pi(\\theta) \\propto \\sqrt{I(\\theta)}$$\n单次观测的费雪信息由以下公式给出：\n$$I(\\theta) = -E\\left[\\frac{\\partial^2}{\\partial \\theta^2} \\ln f(x; \\theta)\\right]$$\n其中 $E[\\cdot]$ 表示关于分布 $f(x; \\theta)$ 的期望。\n\n确定瑞利分布尺度参数 $\\sigma$ 的杰弗里斯先验。你的答案应该是先验 $\\pi(\\sigma)$ 所正比于的 $\\sigma$ 的函数。", "solution": "我们已知从一个瑞利分布中进行的单次观测，其密度函数为\n$$\nf(x;\\sigma)=\\frac{x}{\\sigma^{2}}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right),\\quad x\\geq 0,\\ \\sigma>0.\n$$\n一个参数的杰弗里斯先验与费雪信息的平方根成正比。对于尺度参数 $\\sigma$，我们使用以下公式计算费雪信息\n$$\nI(\\sigma)=-E\\!\\left[\\frac{\\partial^{2}}{\\partial \\sigma^{2}}\\ln f(x;\\sigma)\\right].\n$$\n首先，计算单次观测的对数似然：\n$$\n\\ln f(x;\\sigma)=\\ln x-2\\ln \\sigma-\\frac{x^{2}}{2\\sigma^{2}}.\n$$\n对 $\\sigma$ 求导：\n$$\n\\frac{\\partial}{\\partial \\sigma}\\ln f(x;\\sigma)=-\\frac{2}{\\sigma}+\\frac{x^{2}}{\\sigma^{3}}.\n$$\n再次求导：\n$$\n\\frac{\\partial^{2}}{\\partial \\sigma^{2}}\\ln f(x;\\sigma)=\\frac{2}{\\sigma^{2}}-\\frac{3x^{2}}{\\sigma^{4}}.\n$$\n因此，\n$$\nI(\\sigma)=-E\\!\\left[\\frac{2}{\\sigma^{2}}-\\frac{3x^{2}}{\\sigma^{4}}\\right]=-\\frac{2}{\\sigma^{2}}+\\frac{3\\,E[x^{2}]}{\\sigma^{4}}.\n$$\n我们现在计算在瑞利$(\\sigma)$分布下 $E[x^{2}]$ 的值：\n$$\nE[x^{2}]=\\int_{0}^{\\infty}x^{2}\\,\\frac{x}{\\sigma^{2}}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)\\mathrm{d}x=\\frac{1}{\\sigma^{2}}\\int_{0}^{\\infty}x^{3}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)\\mathrm{d}x.\n$$\n使用换元法，令 $u=\\frac{x^{2}}{2\\sigma^{2}}$，则 $\\mathrm{d}u=\\frac{x\\,\\mathrm{d}x}{\\sigma^{2}}$ 且 $x^{3}\\mathrm{d}x=2\\sigma^{4}u\\,\\mathrm{d}u$。于是\n$$\nE[x^{2}]=\\frac{1}{\\sigma^{2}}\\int_{0}^{\\infty}2\\sigma^{4}u\\,\\exp(-u)\\,\\mathrm{d}u=2\\sigma^{2}\\int_{0}^{\\infty}u\\,\\exp(-u)\\,\\mathrm{d}u=2\\sigma^{2}.\n$$\n将 $E[x^{2}]=2\\sigma^{2}$ 代入费雪信息的表达式中：\n$$\nI(\\sigma)=-\\frac{2}{\\sigma^{2}}+\\frac{3\\cdot 2\\sigma^{2}}{\\sigma^{4}}=\\frac{4}{\\sigma^{2}}.\n$$\n杰弗里斯先验与 $\\sqrt{I(\\sigma)}$ 成正比，因此\n$$\n\\pi(\\sigma)\\propto \\sqrt{I(\\sigma)}=\\sqrt{\\frac{4}{\\sigma^{2}}}=\\frac{2}{\\sigma}\\propto \\frac{1}{\\sigma},\\quad \\sigma>0.\n$$", "answer": "$$\\boxed{\\frac{1}{\\sigma}}$$", "id": "1925852"}, {"introduction": "在掌握了连续分布参数的先验推导后，我们将目光转向离散数据模型。本练习将探讨负二项分布（Negative Binomial distribution）中的成功概率$p$，这是一个在计数数据分析中非常常见的模型。这个实践不仅能巩固你对于费雪信息和Jeffreys先验的计算流程的理解，还能让你体会到该方法如何同样优雅地适用于离散随机变量的参数推断。[@problem_id:1925869]", "problem": "一位统计学家正在对一系列独立的伯努利试验进行建模，每次试验的成功概率为 $p \\in (0, 1)$。试验将持续进行，直到观察到预先设定的固定次数的成功（记为正整数 $r$）为止。令随机变量 $X$ 表示在观察到第 $r$ 次成功之前发生的失败次数。$X$ 的概率质量函数由负二项分布给出：\n\n$$P(X=k | p, r) = \\binom{k+r-1}{k} p^r (1-p)^k, \\quad \\text{for } k = 0, 1, 2, \\dots$$\n\n为了对参数 $p$ 进行贝叶斯分析，该统计学家决定使用一个无信息先验。具体来说，他们选择使用 Jeffreys 先验。\n\n确定一个与成功概率 $p$ 的 Jeffreys 先验密度 $\\pi_J(p)$ 成正比的函数。参数 $r$ 被视为一个已知的常数。", "solution": "给定一个关于在固定的、预先确定的成功次数 $r$ 之前失败次数的负二项模型，其参数为 $p \\in (0,1)$，概率质量函数 (pmf) 为\n$$\nP(X=k \\mid p,r) = \\binom{k+r-1}{k} p^{r} (1-p)^{k}, \\quad k=0,1,2,\\dots\n$$\n将 $r$ 视为已知，我们利用 Fisher 信息来推导 $p$ 的 Jeffreys 先验：\n$$\n\\pi_{J}(p) \\propto \\sqrt{I(p)}.\n$$\n对于单个观测值 $X$，其对数似然函数（在不考虑与 $p$ 无关的加法常数的情况下）为\n$$\n\\ell(p;X) = r \\ln p + X \\ln(1-p).\n$$\n其关于 $p$ 的一阶和二阶导数分别为\n$$\n\\frac{\\partial \\ell}{\\partial p} = \\frac{r}{p} - \\frac{X}{1-p}, \\qquad \\frac{\\partial^{2} \\ell}{\\partial p^{2}} = -\\frac{r}{p^{2}} - \\frac{X}{(1-p)^{2}}.\n$$\nFisher 信息由下式给出\n$$\nI(p) = - \\mathbb{E}\\!\\left[ \\frac{\\partial^{2} \\ell}{\\partial p^{2}} \\right] = \\frac{r}{p^{2}} + \\frac{\\mathbb{E}[X]}{(1-p)^{2}}.\n$$\n对于采用这种参数化（第 $r$ 次成功前的失败次数）的负二项分布，其均值为\n$$\n\\mathbb{E}[X] = \\frac{r(1-p)}{p}.\n$$\n将其代入 $I(p)$ 的表达式中可得\n$$\nI(p) = \\frac{r}{p^{2}} + \\frac{r(1-p)}{p(1-p)^{2}} = \\frac{r}{p^{2}} + \\frac{r}{p(1-p)} = \\frac{r}{p^{2}(1-p)}.\n$$\n因此，Jeffreys 先验与该 Fisher 信息的平方根成正比：\n$$\n\\pi_{J}(p) \\propto \\sqrt{I(p)} = \\frac{\\sqrt{r}}{p\\,(1-p)^{\\frac{1}{2}}} \\propto p^{-1} (1-p)^{-\\frac{1}{2}}, \\quad 0<p<1.\n$$\n由于 Jeffreys 先验的定义允许相差一个乘法常数，我们可以省略因子 $\\sqrt{r}$（因为 $r$ 是已知的），从而得到其正比形式。", "answer": "$$\\boxed{p^{-1}\\,(1-p)^{-\\frac{1}{2}}}$$", "id": "1925869"}, {"introduction": "前面的练习处理的都是单参数模型，但现实世界中的统计模型往往更加复杂，包含多个未知参数。这个挑战性的练习将引导你进入多参数世界，为伽马分布（Gamma distribution）的形状参数$\\alpha$和率参数$\\beta$推导联合Jeffreys先验。你将学习如何构建费雪信息矩阵（Fisher Information Matrix），计算其行列式，并最终得到多维参数的Jeffreys先验，这是在更高级的贝叶斯分析中至关重要的一步。[@problem_id:1925872]", "problem": "在贝叶斯统计中，可以使用由Harold Jeffreys提出的方法来构建无信息先验。对于一个参数向量为 $\\boldsymbol{\\theta} = (\\theta_1, \\theta_2, \\dots, \\theta_k)$、基于数据 $x$ 的似然函数为 $L(\\boldsymbol{\\theta}|x)$ 的模型，多元杰弗里斯先验定义为与费雪信息矩阵 $\\mathcal{I}(\\boldsymbol{\\theta})$ 行列式的平方根成正比。即：\n$$ \\pi_J(\\boldsymbol{\\theta}) \\propto \\sqrt{\\det(\\mathcal{I}(\\boldsymbol{\\theta}))} $$\n费雪信息矩阵的第 $(i,j)$ 个元素由下式给出：\n$$ \\mathcal{I}_{ij}(\\boldsymbol{\\theta}) = -E\\left[\\frac{\\partial^2}{\\partial \\theta_i \\partial \\theta_j} \\ln L(\\boldsymbol{\\theta}|X)\\right] $$\n其中期望是关于随机变量 $X$ 计算的。\n\n考虑一个服从伽马分布的随机变量 $X$，该分布常用于模拟等待时间或降雨量。其概率密度函数 (PDF) 为：\n$$ f(x | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x) \\quad \\text{for } x > 0 $$\n其中 $\\alpha > 0$ 是形状参数，$\\beta > 0$ 是率参数，$\\Gamma(\\alpha)$ 是伽马函数。\n\n对于来自此分布的单个观测值 $x$，请确定其二元杰弗里斯先验 $\\pi_J(\\alpha, \\beta)$。您的任务是找到该先验与 $\\alpha$ 和 $\\beta$ 的哪个函数成正比。\n\n以下定义可能会有用：\n- 双伽马函数：$\\psi(\\alpha) = \\frac{d}{d\\alpha} \\ln \\Gamma(\\alpha)$\n- 三伽马函数：$\\psi_1(\\alpha) = \\frac{d}{d\\alpha} \\psi(\\alpha) = \\frac{d^2}{d\\alpha^2} \\ln \\Gamma(\\alpha)$\n\n请用 $\\alpha$、$\\beta$ 和三伽马函数 $\\psi_1(\\alpha)$ 给出最终表达式。", "solution": "该问题要求解伽马分布参数 $(\\alpha, \\beta)$ 的二元杰弗里斯先验与之成正比的表达式。根据所给定义，$\\pi_J(\\alpha, \\beta) \\propto \\sqrt{\\det(\\mathcal{I}(\\alpha, \\beta))}$。我们必须首先计算费雪信息矩阵 $\\mathcal{I}(\\alpha, \\beta)$。\n\n**第一步：求对数似然函数。**\n来自伽马$(\\alpha, \\beta)$分布的单个观测值 $x$ 的似然函数就是其概率密度函数本身：\n$$ L(\\alpha, \\beta|x) = f(x | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x) $$\n对数似然函数，记为 $\\ell(\\alpha, \\beta|x)$，是：\n$$ \\ell(\\alpha, \\beta|x) = \\ln L(\\alpha, \\beta|x) = \\alpha \\ln \\beta - \\ln \\Gamma(\\alpha) + (\\alpha-1) \\ln x - \\beta x $$\n\n**第二步：计算对数似然函数的二阶偏导数。**\n我们首先计算关于 $\\alpha$ 和 $\\beta$ 的一阶偏导数。\n$$ \\frac{\\partial \\ell}{\\partial \\alpha} = \\ln \\beta - \\frac{d}{d\\alpha}\\ln \\Gamma(\\alpha) + \\ln x = \\ln \\beta - \\psi(\\alpha) + \\ln x $$\n$$ \\frac{\\partial \\ell}{\\partial \\beta} = \\frac{\\alpha}{\\beta} - x $$\n现在，我们计算三个唯一的二阶偏导数：\n$$ \\frac{\\partial^2 \\ell}{\\partial \\alpha^2} = \\frac{\\partial}{\\partial \\alpha} (\\ln \\beta - \\psi(\\alpha) + \\ln x) = -\\frac{d}{d\\alpha}\\psi(\\alpha) = -\\psi_1(\\alpha) $$\n$$ \\frac{\\partial^2 \\ell}{\\partial \\beta^2} = \\frac{\\partial}{\\partial \\beta} \\left(\\frac{\\alpha}{\\beta} - x\\right) = -\\frac{\\alpha}{\\beta^2} $$\n$$ \\frac{\\partial^2 \\ell}{\\partial \\beta \\partial \\alpha} = \\frac{\\partial}{\\partial \\beta} \\left(\\frac{\\partial \\ell}{\\partial \\alpha}\\right) = \\frac{\\partial}{\\partial \\beta} (\\ln \\beta - \\psi(\\alpha) + \\ln x) = \\frac{1}{\\beta} $$\n根据克莱罗定理（Clairaut's theorem），$\\frac{\\partial^2 \\ell}{\\partial \\alpha \\partial \\beta} = \\frac{\\partial^2 \\ell}{\\partial \\beta \\partial \\alpha}$，因此我们得到了所有必要的组成部分。\n\n**第三步：计算费雪信息矩阵的元素。**\n费雪信息矩阵 $\\mathcal{I}(\\alpha, \\beta)$ 的元素由 $\\mathcal{I}_{ij} = -E\\left[\\frac{\\partial^2 \\ell}{\\partial \\theta_i \\partial \\theta_j}\\right]$ 给出。在我们的例子中，参数向量是 $\\boldsymbol{\\theta} = (\\alpha, \\beta)$。\n\n$$ \\mathcal{I}_{11} = -E\\left[\\frac{\\partial^2 \\ell}{\\partial \\alpha^2}\\right] = -E[-\\psi_1(\\alpha)] $$\n由于 $\\psi_1(\\alpha)$ 仅是 $\\alpha$ 的函数，不依赖于随机变量 $X$，其期望就是其本身。\n$$ \\mathcal{I}_{11} = \\psi_1(\\alpha) $$\n对于 $\\mathcal{I}_{22}$ 也类似：\n$$ \\mathcal{I}_{22} = -E\\left[\\frac{\\partial^2 \\ell}{\\partial \\beta^2}\\right] = -E\\left[-\\frac{\\alpha}{\\beta^2}\\right] = \\frac{\\alpha}{\\beta^2} $$\n对于非对角元素 $\\mathcal{I}_{12} = \\mathcal{I}_{21}$：\n$$ \\mathcal{I}_{12} = -E\\left[\\frac{\\partial^2 \\ell}{\\partial \\beta \\partial \\alpha}\\right] = -E\\left[\\frac{1}{\\beta}\\right] = -\\frac{1}{\\beta} $$\n\n**第四步：构建费雪信息矩阵并计算其行列式。**\n费雪信息矩阵为：\n$$ \\mathcal{I}(\\alpha, \\beta) = \\begin{pmatrix} \\mathcal{I}_{11} & \\mathcal{I}_{12} \\\\ \\mathcal{I}_{21} & \\mathcal{I}_{22} \\end{pmatrix} = \\begin{pmatrix} \\psi_1(\\alpha) & -1/\\beta \\\\ -1/\\beta & \\alpha/\\beta^2 \\end{pmatrix} $$\n该矩阵的行列式为：\n$$ \\det(\\mathcal{I}(\\alpha, \\beta)) = (\\psi_1(\\alpha))\\left(\\frac{\\alpha}{\\beta^2}\\right) - \\left(-\\frac{1}{\\beta}\\right)\\left(-\\frac{1}{\\beta}\\right) $$\n$$ \\det(\\mathcal{I}(\\alpha, \\beta)) = \\frac{\\alpha \\psi_1(\\alpha)}{\\beta^2} - \\frac{1}{\\beta^2} = \\frac{\\alpha \\psi_1(\\alpha) - 1}{\\beta^2} $$\n\n**第五步：确定杰弗里斯先验。**\n杰弗里斯先验与费雪信息矩阵行列式的平方根成正比。\n$$ \\pi_J(\\alpha, \\beta) \\propto \\sqrt{\\det(\\mathcal{I}(\\alpha, \\beta))} = \\sqrt{\\frac{\\alpha \\psi_1(\\alpha) - 1}{\\beta^2}} $$\n因为 $\\beta > 0$，我们可以简化此表达式：\n$$ \\pi_J(\\alpha, \\beta) \\propto \\frac{\\sqrt{\\alpha \\psi_1(\\alpha) - 1}}{\\beta} $$\n这就是二元杰弗里斯先验与之成正比的最终表达式。（注：对于 $\\alpha > 0$，三伽马函数的一个已知性质是 $\\alpha \\psi_1(\\alpha) > 1$，因此平方根下的项恒为正）。", "answer": "$$\\boxed{\\frac{\\sqrt{\\alpha \\psi_1(\\alpha) - 1}}{\\beta}}$$", "id": "1925872"}]}