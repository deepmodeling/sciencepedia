{"hands_on_practices": [{"introduction": "这个练习将引导你完成一个核心的贝叶斯工作流程：从观测数据中学习，更新我们的信念，然后利用这些更新后的信念来预测未来的事件。通过一个关于新材料制造成功率的假设场景，你将实践如何从一个无信息先验（均匀分布）开始，利用二项分布的观测结果更新得到后验分布，并最终计算关于未来产出的后验预测期望。这个过程完美地诠释了贝叶斯方法如何将推断与预测联系起来。[@problem_id:1899633]", "problem": "一家材料科学公司正在开发一种新型光伏电池。目前的生产工艺不稳定，每块生产出的电池都有一个未知但恒定的概率 $p$ 达到高效率标准。工程团队在没有任何初步数据的情况下，假设 $p$ 在 0 和 1 之间的任何值都是等可能的。\n\n在一次试生产中，制造了一批共 $n$ 块电池，经过测试，发现其中有 $k$ 块达到了高效率标准。该公司现在计划开始进行更大规模的生产，制造 $m$ 块新电池。\n\n使用贝叶斯方法，这批新的 $m$ 块电池中高效率电池的期望数量是多少？请用 $n$、$k$ 和 $m$ 推导该数量的符号表达式。", "solution": "设 $p$ 为制造出的电池达到高效率标准的未知概率。题目陈述，关于 $p$ 的先验信念是它在 0 和 1 之间的任何值都是等可能的。这对应于区间 $[0, 1]$ 上的均匀先验分布。该先验分布的概率密度函数 (PDF) 为：\n$$ \\pi(p) = 1, \\quad \\text{for } 0 \\le p \\le 1 $$\n这是贝塔分布的一个特例，具体为 $\\text{Beta}(\\alpha=1, \\beta=1)$。\n\n在试生产中，生产了 $n$ 块电池，这可以建模为 $n$ 次独立的伯努利试验。设 $X$ 为观测到的高效率电池数量的随机变量。观测结果为 $X=k$。在给定概率 $p$ 的情况下，在 $n$ 次试验中观测到 $k$ 次成功的概率服从二项分布。似然函数为：\n$$ L(p|X=k) = P(X=k|p) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n\n为了在观测到数据后更新我们对 $p$ 的信念，我们使用贝叶斯定理来找到 $p$ 的后验分布。后验概率密度函数 $\\pi(p|X=k)$ 正比于先验分布和似然函数的乘积：\n$$ \\pi(p|X=k) \\propto L(p|X=k) \\cdot \\pi(p) $$\n$$ \\pi(p|X=k) \\propto \\left( \\binom{n}{k} p^k (1-p)^{n-k} \\right) \\cdot 1 $$\n由于 $\\binom{n}{k}$ 相对于 $p$ 是一个常数，我们可以写成：\n$$ \\pi(p|X=k) \\propto p^k (1-p)^{n-k} $$\n这个表达式是贝塔分布的核。一个通用的贝塔分布 $\\text{Beta}(\\alpha, \\beta)$，其概率密度函数正比于 $p^{\\alpha-1}(1-p)^{\\beta-1}$。通过比较指数，我们可以确定我们后验分布的参数：\n$$ \\alpha - 1 = k \\implies \\alpha = k+1 $$\n$$ \\beta - 1 = n-k \\implies \\beta = n-k+1 $$\n因此，在给定数据 $X=k$ 的情况下，$p$ 的后验分布是一个参数为 $\\alpha=k+1$ 和 $\\beta=n-k+1$ 的贝塔分布：\n$$ p | (X=k) \\sim \\text{Beta}(k+1, n-k+1) $$\n\n问题要求在未来一批 $m$ 次试验中高效率电池的期望数量。设 $Y$ 为这未来 $m$ 次试验中成功次数的随机变量。给定一个 $p$ 值，$Y$ 服从二项分布，即 $Y|p \\sim \\text{Binomial}(m, p)$。$Y$ 在给定 $p$ 下的期望是 $E[Y|p] = mp$。\n\n我们需要找到 $Y$ 的贝叶斯预测期望，即 $Y$ 的期望在 $p$ 的后验分布上的平均值。这被记为 $E[Y|X=k]$。我们使用全期望定律：\n$$ E[Y|X=k] = E_{p|k}[E[Y|p]] $$\n其中外层期望是关于 $p$ 的后验分布计算的。\n代入 $E[Y|p] = mp$，我们得到：\n$$ E[Y|X=k] = E_{p|k}[mp] = m \\cdot E_{p|k}[p] $$\n项 $E_{p|k}[p]$ 是 $p$ 的后验分布的均值。一个 $\\text{Beta}(\\alpha, \\beta)$ 分布的均值由公式 $\\frac{\\alpha}{\\alpha+\\beta}$ 给出。\n对于我们的后验分布 $\\text{Beta}(k+1, n-k+1)$，其均值为：\n$$ E_{p|k}[p] = \\frac{k+1}{(k+1) + (n-k+1)} = \\frac{k+1}{n+2} $$\n这是在平方误差损失下对概率 $p$ 的贝叶斯点估计。\n\n最后，在接下来的 $m$ 次试验中，成功的期望数量是：\n$$ E[Y|X=k] = m \\cdot \\frac{k+1}{n+2} $$\n该表达式表示在给定数据下，对未来 $m$ 次试验中高效率电池数量的期望预测。", "answer": "$$\\boxed{m \\frac{k+1}{n+2}}$$", "id": "1899633"}, {"introduction": "在贝叶斯分析中，我们从哪里获得先验分布？它对我们的结论有多大影响？这个问题通过一个生动的思想实验直接探讨了这些根本性问题。我们将比较两位虚拟的统计学家——一位“乐观主义者”和一位“怀疑论者”——他们使用不同的先验信念来解释完全相同的、但极为有限的实验数据。通过计算并比较他们各自得出的后验期望值，你将亲身体会到，尤其是在数据稀少的情况下，先验选择是如何深刻地影响贝叶斯推断的结果。[@problem_id:1899686]", "problem": "一个材料科学实验室正在为高频应用开发一种新型半导体。一个关键的制造步骤有一定的成功概率 $p$。由于资源限制，只能进行一次半导体的生产尝试。这次尝试是成功的。\n\n两名统计学家，一位乐观主义者和一位怀疑主义者，负责基于这单次成功的结果为 $p$ 提供一个估计值。他们都同意将这次尝试的结果建模为伯努利试验，并使用贝叶斯框架。他们的分歧在于对成功概率 $p$ 的先验信念。\n\n乐观主义者对实验室的综合能力有信心，假设 $p$ 的一个“无信息”先验，这是一个参数为 $\\alpha_O = 1$ 和 $\\beta_O = 1$ 的贝塔分布。这个先验代表了对 $p$ 在0和1之间所有可能值的均匀信念。\n\n怀疑主义者意识到开发新材料时常见的高失败率，假设 $p$ 的一个“怀疑”先验，这是一个参数为 $\\alpha_S = 1$ 和 $\\beta_S = 5$ 的贝塔分布。这个先验表达了一种信念，即较低的 $p$ 值更有可能。\n\n在观察到单次成功试验后，两位统计学家都更新了他们的信念，并计算了他们各自对成功概率 $p$ 的后验期望值。怀疑主义者的后验期望值与乐观主义者的后验期望值之间的绝对差是多少？将你的答案表示为最简精确分数。", "solution": "将结果 $X$ 建模为成功概率为 $p$ 的伯努利试验。对于贝塔先验 $\\operatorname{Beta}(\\alpha,\\beta)$，在观察到 $s$ 次成功和 $f$ 次失败后，由于共轭性，后验分布为 $\\operatorname{Beta}(\\alpha+s,\\beta+f)$。$\\operatorname{Beta}(a,b)$ 分布的均值为 $a/(a+b)$。\n\n实验进行了一次且成功了，所以 $s=1$ 且 $f=0$。\n\n对于乐观主义者：先验为 $\\operatorname{Beta}(\\alpha_{O},\\beta_{O})$，其中 $\\alpha_{O}=1$，$\\beta_{O}=1$。后验分布为\n$$\n\\operatorname{Beta}(\\alpha_{O}+s,\\beta_{O}+f)=\\operatorname{Beta}(1+1, 1+0)=\\operatorname{Beta}(2,1),\n$$\n所以后验期望值为\n$$\n\\mathbb{E}_{O}[p]=\\frac{2}{2+1}=\\frac{2}{3}.\n$$\n\n对于怀疑主义者：先验为 $\\operatorname{Beta}(\\alpha_{S},\\beta_{S})$，其中 $\\alpha_{S}=1$，$\\beta_{S}=5$。后验分布为\n$$\n\\operatorname{Beta}(\\alpha_{S}+s,\\beta_{S}+f)=\\operatorname{Beta}(1+1, 5+0)=\\operatorname{Beta}(2,5),\n$$\n所以后验期望值为\n$$\n\\mathbb{E}_{S}[p]=\\frac{2}{2+5}=\\frac{2}{7}.\n$$\n\n怀疑主义者和乐观主义者的后验期望值之间的绝对差为\n$$\n\\left|\\mathbb{E}_{S}[p]-\\mathbb{E}_{O}[p]\\right|=\\left|\\frac{2}{7}-\\frac{2}{3}\\right|=\\left|\\frac{6-14}{21}\\right|=\\frac{8}{21}.\n$$", "answer": "$$\\boxed{\\frac{8}{21}}$$", "id": "1899686"}, {"introduction": "前面的练习主要关注于为连续参数（如成功概率 $p$）计算一个期望值估计量（后验均值）。然而，贝叶斯点估计不仅限于此。这个练习将我们带入一个参数空间为离散的情境，并介绍一种不同的估计方法：最大后验（MAP）估计。你的任务是基于单次掷骰子的结果，从一组有限的可能性中找出骰子面数的“最可能”值 $N$。这个过程将展示如何计算每个离散假设的后验概率，并找出使后验概率最大化的那个假设，从而拓宽你对贝叶斯估计方法的理解。[@problem_id:1899685]", "problem": "一家专门从事桌面游戏的公司正在测试一种用于生产非标准骰子的新制造工艺。任何给定骰子的面数（用参数 $N$ 表示）是未知的。根据制造规格，已知 $N$ 只能取三个可能值之一：6、8 或 12。最初，在没有实验数据的情况下，每种可能性都被认为是等可能的。\n\n为了确定特定骰子最有可能的面数，进行了一次单一的实验：将骰子掷一次，观察到的结果是“5”。假设骰子是公平的，这意味着对于给定的 $N$，标有 1 到 $N$ 的每个面被掷出的概率相等。\n\n你的任务是，在给定这个单一观察值的情况下，计算面数 $N$ 的最大后验（MAP）估计。", "solution": "设假设空间为 $\\mathcal{H}=\\{6,8,12\\}$。关于 $N$ 的先验是均匀的，因此对于每个 $N \\in \\mathcal{H}$，\n$$\nP(N)=\\frac{1}{3}.\n$$\n设单次观测值为 $X=5$。给定一个公平的 $N$ 面骰子，似然函数为\n$$\nP(X=5 \\mid N)=\\begin{cases}\n\\frac{1}{N}, & \\text{当 } 5 \\leq N,\\\\\n0, & \\text{当 } 5 > N.\n\\end{cases}\n$$\n因为 $5 \\leq 6$, $5 \\leq 8$ 且 $5 \\leq 12$，所以对于所有 $N \\in \\{6,8,12\\}$，我们有 $P(X=5 \\mid N)=\\frac{1}{N}$。\n\n根据贝叶斯法则，对于每个 $N \\in \\mathcal{H}$，后验概率为\n$$\nP(N \\mid X=5)=\\frac{P(N)\\,P(X=5 \\mid N)}{\\sum_{n \\in \\mathcal{H}} P(n)\\,P(X=5 \\mid n)}=\\frac{\\frac{1}{3}\\cdot \\frac{1}{N}}{\\sum_{n \\in \\{6,8,12\\}} \\frac{1}{3}\\cdot \\frac{1}{n}}=\\frac{\\frac{1}{N}}{\\sum_{n \\in \\{6,8,12\\}} \\frac{1}{n}}.\n$$\n因此，后验概率正比于 $\\frac{1}{N}$。最大后验（MAP）估计是使 $P(N \\mid X=5)$ 最大化的 $N$，这等价于使 $\\frac{1}{N}$ 最大化，因此需要选择最小的可行 $N$。在 $\\{6,8,12\\}$ 中，最小值为 6。\n\n因此，MAP 估计为 $N=6$。", "answer": "$$\\boxed{6}$$", "id": "1899685"}]}