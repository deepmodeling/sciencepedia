{"hands_on_practices": [{"introduction": "在贝叶斯统计中，正态-正态共轭模型是理解参数估计的基础。这个练习将带你计算正态分布均值的后验均值，这是一个核心技能。通过这个例子，你将亲身体会后验均值是如何作为先验信念和观测数据的“加权平均”而产生的，其中权重由各自的精度（即方差的倒数）决定。", "problem": "一位质量控制工程师正在分析一批新电子元件的电阻。这批元件中单个元件的电阻遵循一个正态分布 $N(\\mu, \\sigma^2)$，其电阻均值 $\\mu$ 未知，方差 $\\sigma^2 = 9 \\, \\Omega^2$ 已知。该工程师对均值电阻 $\\mu$ 的先验信念是，它遵循一个以目标设计值为中心的正态分布。具体来说，$\\mu$ 的先验分布为 $N(\\mu_0, \\tau^2)$，其均值 $\\mu_0 = 0 \\, \\Omega$，方差 $\\tau^2 = 1 \\, \\Omega^2$。\n\n工程师从这批元件中随机抽取一个，测得其电阻为 $x = 5 \\, \\Omega$。\n\n根据这次单次观测，计算 $\\mu$ 的后验均值。请将答案表示为精确分数。", "solution": "我们将观测值建模为 $x \\mid \\mu \\sim N(\\mu, \\sigma^{2})$，其中方差 $\\sigma^{2}$ 已知，先验分布为 $\\mu \\sim N(\\mu_{0}, \\tau^{2})$。正态-正态共轭更新给出的后验分布为 $\\mu \\mid x \\sim N(\\mu_{n}, \\tau_{n}^{2})$，其中\n$$\n\\tau_{n}^{2}=\\left(\\frac{1}{\\tau^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}, \\quad \\mu_{n}=\\tau_{n}^{2}\\left(\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{n \\bar{x}}{\\sigma^{2}}\\right).\n$$\n对于单次观测，$n=1$ 且 $\\bar{x}=x$，所以\n$$\n\\mu_{n}=\\frac{\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{x}{\\sigma^{2}}}{\\frac{1}{\\tau^{2}}+\\frac{1}{\\sigma^{2}}}.\n$$\n将 $\\mu_{0}=0$, $\\tau^{2}=1$, $\\sigma^{2}=9$ 和 $x=5$ 代入，我们得到\n$$\n\\mu_{n}=\\frac{0+\\frac{5}{9}}{1+\\frac{1}{9}}=\\frac{\\frac{5}{9}}{\\frac{10}{9}}=\\frac{5}{10}=\\frac{1}{2}.\n$$\n因此，后验均值为 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1945460"}, {"introduction": "在实际应用中，我们对参数的先验信念未必总是符合标准的共轭分布形式。这个练习将挑战你处理一个非共轭先验（三角形分布）的情况，并计算后验分布的众数。通过直接运用贝叶斯定理（后验 ∝ 似然 × 先验）并结合微积分知识，你将学会如何找到参数的“最可能”值，这对于理解众数作为点估计的意义至关重要。", "problem": "一个工程师团队正在测试一种新型固态晶体管，用于卫星的通信系统。该晶体管的可靠性，定义为在特定压力测试下其正常工作的概率 $p$，是未知的。基于理论模型和类似材料的性能，该团队对 $p$ 的先验信念由一个定义在区间 $[0, 1]$ 上的三角概率密度函数描述：\n$$ \\pi(p) = 2p, \\quad \\text{for } 0 \\le p \\le 1 $$\n这个先验分布反映了他们认为可靠性越高，可能性越大的信念。\n\n为了更新他们的信念，该团队进行了一项实验，包括对三个相同的晶体管进行三次独立的压力测试。实验结果是两个晶体管正常工作，一个失效。\n\n假设测试结果是独立的伯努利试验，计算可靠性概率 $p$ 的后验众数。后验众数是使后验概率密度函数最大化的参数值。", "solution": "问题要求我们找到概率 $p$ 的后验众数。在贝叶斯统计中，后验分布是通过贝叶斯定理将先验分布与似然函数相结合得到的。后验分布正比于似然函数与先验分布的乘积：\n$$ \\pi(p | \\text{data}) \\propto L(\\text{data} | p) \\times \\pi(p) $$\n后验众数是使该后验概率密度函数最大化的 $p$ 值。\n\n首先，我们确定先验分布。题目说明 $p$ 的先验概率密度函数（PDF）为：\n$$ \\pi(p) = 2p, \\quad \\text{for } p \\in [0, 1] $$\n\n接下来，我们确定似然函数。数据包含三次独立试验的结果：两次成功（正常工作）和一次失败。这是一个 $n=3$ 次试验和 $k=2$ 次成功的二项式实验。二项式结果的似然函数由下式给出：\n$$ L(k, n | p) = \\binom{n}{k} p^{k} (1-p)^{n-k} $$\n代入我们的数据，$n=3$和$k=2$，我们得到：\n$$ L(\\text{data} | p) = \\binom{3}{2} p^{2} (1-p)^{3-2} = 3p^{2}(1-p) $$\n\n现在，我们可以通过将似然函数与先验分布相乘来找到后验分布。我们只需要后验分布中依赖于 $p$ 的部分，因为任何常数因子都不会影响众数的位置。这部分通常被称为后验分布的核。\n$$ \\pi(p | \\text{data}) \\propto L(\\text{data} | p) \\times \\pi(p) $$\n$$ \\pi(p | \\text{data}) \\propto \\left( 3p^{2}(1-p) \\right) \\times (2p) $$\n$$ \\pi(p | \\text{data}) \\propto 6p^{3}(1-p) $$\n为了找到众数，我们需要找到区间 $[0, 1]$ 内使函数 $f(p) = p^{3}(1-p)$ 最大化的 $p$ 值。我们可以忽略常数因子 6。我们展开这个函数：\n$$ f(p) = p^3 - p^4 $$\n为了找到最大值，我们对 $f(p)$ 关于 $p$ 求导，并令其为零。\n$$ f'(p) = \\frac{d}{dp}(p^3 - p^4) = 3p^2 - 4p^3 $$\n令导数为零以找到临界点：\n$$ 3p^2 - 4p^3 = 0 $$\n$$ p^2(3 - 4p) = 0 $$\n这个方程在区间 $[0, 1]$ 内有两个解：$p=0$ 和 $3 - 4p = 0$，后者给出 $p = \\frac{3}{4}$。\n\n为了确定这些临界点中哪一个对应于最大值，我们可以使用二阶导数检验。$f(p)$ 的二阶导数是：\n$$ f''(p) = \\frac{d}{dp}(3p^2 - 4p^3) = 6p - 12p^2 $$\n现在我们计算在临界点处的二阶导数值：\n在 $p=0$ 处：\n$$ f''(0) = 6(0) - 12(0)^2 = 0 $$\n对于 $p=0$，二阶导数检验是无结论的。然而，通过检查一阶导数 $f'(p) = p^2(3-4p)$，我们看到对于一个小的正值 $p$ （例如 $p=0.1$），$f'(p)$ 是正的。这意味着函数从 $p=0$ 开始是增加的，所以 $p=0$ 必定是一个局部最小值，对应于零的后验概率。\n\n在 $p = \\frac{3}{4}$ 处：\n$$ f''\\left(\\frac{3}{4}\\right) = 6\\left(\\frac{3}{4}\\right) - 12\\left(\\frac{3}{4}\\right)^2 = \\frac{18}{4} - 12\\left(\\frac{9}{16}\\right) = \\frac{9}{2} - \\frac{27}{4} = \\frac{18}{4} - \\frac{27}{4} = -\\frac{9}{4} $$\n由于 $f''(\\frac{3}{4}) < 0$，函数 $f(p)$ 在 $p = \\frac{3}{4}$ 处有一个局部最大值。由于这是区间 $(0, 1)$ 内唯一的局部最大值，因此它也是 $p$ 定义域内的全局最大值。\n\n因此，可靠性概率 $p$ 的后验众数是 $\\frac{3}{4}$。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "1945427"}, {"introduction": "掌握了正向计算后，让我们来挑战一个更深层次的“逆向问题”。在这个练习中，你将不再是简单地从先验和数据计算后验，而是利用已知的先验均值和后验众数信息来反推先验分布的具体参数。这种逆向思维的训练能够极大地加深你对贝叶斯模型各组成部分之间相互关系的理解，并提升你解决复杂统计问题的能力。", "problem": "一位研究员正在研究一种新开发的化学反应。在特定条件下，该反应成功的概率用 $p$ 表示。研究员对此未知概率 $p$ 的先验信念使用参数为 $\\alpha > 0$ 和 $\\beta > 0$ 的贝塔分布 (Beta distribution) 进行建模。先验均值，代表研究员对成功概率的初始期望，给定为 $E[p] = 0.6$。\n\n在一系列初始实验中，研究员观察到 3 次成功反应和 7 次失败反应。用这 10 次观测结果更新先验信念后，研究员计算了 $p$ 的后验分布。发现该后验分布的众数（代表 $p$ 最可能的值）恰好位于 $p=0.5$。\n\n根据这些信息，确定先验参数 $\\alpha$ 的值。", "solution": "设先验分布为 $p \\sim \\mathrm{Beta}(\\alpha,\\beta)$，其先验均值为 $E[p]=\\frac{\\alpha}{\\alpha+\\beta}$。给定的先验均值 $E[p]=0.6=\\frac{3}{5}$ 意味着\n$$\n\\frac{\\alpha}{\\alpha+\\beta}=\\frac{3}{5}\n\\;\\;\\Longrightarrow\\;\\;\n5\\alpha=3(\\alpha+\\beta)\n\\;\\;\\Longrightarrow\\;\\;\n2\\alpha=3\\beta\n\\;\\;\\Longrightarrow\\;\\;\n\\alpha=\\frac{3}{2}\\beta.\n$$\n有 $x=3$ 次成功和 $n-x=7$ 次失败，则后验分布为 $\\mathrm{Beta}(\\alpha+3,\\beta+7)$。对于一个参数 $a>1$ 和 $b>1$ 的 $\\mathrm{Beta}(a,b)$ 分布，其众数为\n$$\n\\frac{a-1}{a+b-2}.\n$$\n因此，后验众数为\n$$\n\\frac{(\\alpha+3)-1}{(\\alpha+3)+(\\beta+7)-2}=\\frac{\\alpha+2}{\\alpha+\\beta+8}.\n$$\n题目指出该众数等于 $\\frac{1}{2}$，所以\n$$\n\\frac{\\alpha+2}{\\alpha+\\beta+8}=\\frac{1}{2}.\n$$\n代入 $\\alpha=\\frac{3}{2}\\beta$ 可得\n$$\n\\frac{\\frac{3}{2}\\beta+2}{\\frac{3}{2}\\beta+\\beta+8}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{\\frac{3}{2}\\beta+2}{\\frac{5}{2}\\beta+8}=\\frac{1}{2}.\n$$\n交叉相乘得到\n$$\n2\\left(\\frac{3}{2}\\beta+2\\right)=\\frac{5}{2}\\beta+8\n\\;\\;\\Longrightarrow\\;\\;\n3\\beta+4=\\frac{5}{2}\\beta+8\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{1}{2}\\beta=4\n\\;\\;\\Longrightarrow\\;\\;\n\\beta=8.\n$$\n因此，\n$$\n\\alpha=\\frac{3}{2}\\beta=\\frac{3}{2}\\cdot 8=12.\n$$\n快速验证：后验分布为 $\\mathrm{Beta}(12+3,8+7)=\\mathrm{Beta}(15,15)$，其众数为 $\\frac{15-1}{15+15-2}=\\frac{14}{28}=\\frac{1}{2}$，先验均值为 $\\frac{12}{12+8}=\\frac{3}{5}=0.6$，符合题意。", "answer": "$$\\boxed{12}$$", "id": "1945437"}]}