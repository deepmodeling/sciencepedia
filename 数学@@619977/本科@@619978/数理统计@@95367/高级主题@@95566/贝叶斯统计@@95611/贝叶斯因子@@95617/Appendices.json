{"hands_on_practices": [{"introduction": "这个练习是掌握贝叶斯因子的第一步。我们将从一个基本场景开始：在正态分布模型下比较两个简单的均值假设。通过这个在质量控制中常见的例子，你将学会如何直接将贝叶斯因子计算为似然比，为理解数据如何支持一个假设而非另一个假设打下坚实的基础 [@problem_id:1959110]。", "problem": "一位质量控制工程师正在监控一台填充咖啡袋的机器。该机器被校准为每袋目标平均重量 $\\mu_0 = 250.0$ 克。该工程师怀疑最近的一次软件更新可能已经使这个平均值发生了偏移。为此，建立了两个简单假设：一个是零假设 $H_0$，即平均重量未改变；另一个是备择假设 $H_1$，即平均重量已偏移到一个特定的新值 $\\mu_1 = 251.0$ 克。\n\n根据历史数据，已知一袋填充好的咖啡的重量可以很好地用一个正态分布来建模，其已知标准差为 $\\sigma = 2.0$ 克。\n\n为了研究这些假设，工程师从生产线上抽取了一个随机样本，并测量其重量为 $x = 250.8$ 克。\n\n假设数据生成过程服从正态分布 $N(\\mu, \\sigma^2)$，计算支持零假设 $H_0: \\mu = \\mu_0$ 相对于备择假设 $H_1: \\mu = \\mu_1$ 的贝叶斯因子 $B_{01}$。将你的答案以数值形式报告，并四舍五入到三位有效数字。", "solution": "我们有两个关于已知方差的正态分布均值的简单假设：$H_{0}: \\mu=\\mu_{0}$ 和 $H_{1}: \\mu=\\mu_{1}$。对于单个观测值 $x$，支持 $H_{0}$ 相对于 $H_{1}$ 的贝叶斯因子是边际似然的比率，对于简单假设，这等于似然比：\n$$\nB_{01}=\\frac{f(x \\mid \\mu_{0}, \\sigma^{2})}{f(x \\mid \\mu_{1}, \\sigma^{2})}.\n$$\n对于一个标准差 $\\sigma$ 已知的正态模型，其似然函数为\n$$\nf(x \\mid \\mu, \\sigma^{2})=\\frac{1}{\\sqrt{2 \\pi}\\sigma}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n因此，公共的归一化因子在比率中被消去，得到\n$$\nB_{01}=\\exp\\left(\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}\\right).\n$$\n代入给定值 $x=250.8$, $\\mu_{0}=250.0$, $\\mu_{1}=251.0$ 和 $\\sigma=2.0$，\n$$\n(x-\\mu_{1})^{2}=(-0.2)^{2}=0.04,\\quad (x-\\mu_{0})^{2}=(0.8)^{2}=0.64,\n$$\n所以\n$$\n\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}=\\frac{0.04-0.64}{2\\cdot 4}=\\frac{-0.60}{8}=-0.075.\n$$\n因此，\n$$\nB_{01}=\\exp(-0.075)\\approx 0.928,\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{0.928}$$", "id": "1959110"}, {"introduction": "在掌握了连续数据的基本计算后，我们现在将贝叶斯因子的应用扩展到离散数据。这个练习将带你处理计数数据（例如次品数量），这需要使用二项分布模型 [@problem_id:1959126]。通过解决这个问题，你将能够更灵活地在不同类型的场景中（如工业质量检测或 A/B 测试）量化证据。", "problem": "一家制造工厂为电动汽车生产高容量电池。历史上，该生产过程一直保持着 $1\\%$ 的稳定次品率。最近，工厂为一种关键原材料更换了新的供应商。一位工厂经理假设，这一变化可能已将次品率提高到了 $3\\%$。为了对此进行调查，从新的生产批次中随机抽取了 100 块电池作为样本，结果发现了 2 块次品电池。\n\n您的任务是量化支持该经理假设的证据。设 $H_0$ 为次品率为历史水平 $1\\%$ 的模型，设 $H_1$ 为次品率为疑似水平 $3\\%$ 的模型。请计算贝叶斯因子 $K$，即观测数据在模型 $H_1$ 下的似然与在模型 $H_0$ 下的似然之比。\n\n请将您的答案表示为一个实数，并四舍五入到三位有效数字。", "solution": "我们将 $n=100$ 块电池中次品电池的数量 $X$ 建模为参数是 $p$ 的二项分布。在假设 $H_{0}$ 下，$p_{0}=0.01$；在假设 $H_{1}$ 下，$p_{1}=0.03$。观测到 $x=2$ 个次品的似然函数为\n$$\nL(p)=\\binom{100}{2}p^{2}(1-p)^{98}.\n$$\n用于比较 $H_{1}$ 和 $H_{0}$ 的贝叶斯因子 $K$（即似然比）为\n$$\nK=\\frac{L(p_{1})}{L(p_{0})}=\\frac{\\binom{100}{2}p_{1}^{2}(1-p_{1})^{98}}{\\binom{100}{2}p_{0}^{2}(1-p_{0})^{98}}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{2}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{98}.\n$$\n代入 $p_{1}=0.03$ 和 $p_{0}=0.01$ 可得，\n$$\nK= \\left(\\frac{0.03}{0.01}\\right)^{2}\\left(\\frac{0.97}{0.99}\\right)^{98}=9\\left(\\frac{0.97}{0.99}\\right)^{98}.\n$$\n为了进行数值计算，我们使用对数：\n$$\n\\ln K=\\ln 9+98\\left(\\ln 0.97-\\ln 0.99\\right).\n$$\n计算可得 $98\\left(\\ln 0.97-\\ln 0.99\\right)\\approx -2.00007$，所以\n$$\nK\\approx 9\\exp(-2.00007)\\approx 9\\times 0.135326\\approx 1.22,\n$$\n结果四舍五入至三位有效数字。", "answer": "$$\\boxed{1.22}$$", "id": "1959126"}, {"introduction": "这个练习旨在激发更深层次的思考，它在贝叶斯方法和频率主义思想之间架起了一座桥梁。我们特意选取了一个在频率主义框架下达到传统统计显著性水平（$p=0.05$）的数据点 [@problem_id:1959068]。通过计算这个数据点对应的贝叶斯因子，你将能探索 $p$ 值与贝叶斯因子在衡量证据时的关系乃至分歧，从而培养对统计证据更批判性的理解。", "problem": "一位分析师正在研究一个信号，并获得了一个单一的测量值，$x = 1.645$。该测量值的统计模型是一个正态分布，$N(\\mu, 1)$，其均值 $\\mu$ 未知，方差已知为 1。该分布的概率密度函数为 $f(y | \\mu) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y-\\mu)^2}{2}\\right)$。\n\n该分析师希望比较关于均值 $\\mu$ 真实值的两个相互竞争的简单假设：\n- 原假设，$H_0: \\mu = 0$。\n- 备择假设，$H_1: \\mu = 2$。\n\n值得注意的是，在传统的频率学派框架下，对于原假设 $H_0: \\mu = 0$ 和单边备择假设 $H_a: \\mu > 0$ 进行检验时，观测值 $x = 1.645$ 得到的 p 值恰好为 $0.05$。\n\n你的任务是从贝叶斯视角评估证据。计算支持原假设 $H_0$ 相对于备择假设 $H_1$ 的贝叶斯因子，记为 $B_{01}$。将你的最终答案四舍五入至三位有效数字。", "solution": "在点质量假设下，支持原假设相对于备择假设的贝叶斯因子是似然比：\n$$\nB_{01}=\\frac{f(x\\mid \\mu=0)}{f(x\\mid \\mu=2)}.\n$$\n对于来自 $N(\\mu,1)$ 的单个观测值，其似然函数为\n$$\nf(x\\mid \\mu)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2}\\right).\n$$\n因此，\n$$\nB_{01}=\\frac{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-0)^{2}}{2}\\right)}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-2)^{2}}{2}\\right)}=\\exp\\left(\\frac{(x-2)^{2}-(x-0)^{2}}{2}\\right).\n$$\n对指数部分进行代数化简：\n$$\n(x-2)^{2}-(x-0)^{2}=(x^{2}-4x+4)-x^{2}=-4x+4=4(1-x),\n$$\n所以\n$$\nB_{01}=\\exp\\left(\\frac{4(1-x)}{2}\\right)=\\exp\\left(2-2x\\right).\n$$\n将观测值 $x=1.645$ 代入可得\n$$\nB_{01}=\\exp\\left(2-2\\cdot 1.645\\right)=\\exp(-1.29)\\approx 0.275,\n$$\n结果四舍五入至三位有效数字。", "answer": "$$\\boxed{0.275}$$", "id": "1959068"}]}