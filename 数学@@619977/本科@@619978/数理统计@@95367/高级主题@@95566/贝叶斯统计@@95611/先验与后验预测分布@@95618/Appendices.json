{"hands_on_practices": [{"introduction": "我们常常对生成数据的具体模型感到不确定。这个练习将展示我们如何更新关于底层模型（骰子的类型）的信念，并利用这些更新后的信念来预测未来的结果。这是一个在贝叶斯框架下应用全概率定律的基础实践，能够帮助你理解如何通过对模型参数的后验分布进行积分（或求和）来做出预测。[@problem_id:1946862]", "problem": "一位游戏博物馆的档案管理员正在整理一批来自一个历史协会的、不同寻常的多面体骰子。已知这些骰子是公平的（即，对于一个有 $N$ 个面的骰子，任何一个结果出现的概率都是 $1/N$）。这批收藏中的骰子有4、6或8个面，面上的数字从1开始连续编号。根据该协会的收藏记录，档案管理员为随机选中的一个骰子的面数 $N$ 建立了一个先验概率分布。先验概率如下：\n- 一个骰子有4个面的概率是 $P(N=4) = \\frac{1}{2}$。\n- 一个骰子有6个面的概率是 $P(N=6) = \\frac{1}{3}$。\n- 一个骰子有8个面的概率是 $P(N=8) = \\frac{1}{6}$。\n\n档案管理员从这批收藏中随机选择一个骰子并掷了一次，观察其结果。第一次投掷的结果，我们称之为 $D_1$，是3。档案管理员计划将同一个骰子再掷第二次。设第二次投掷的结果为 $D_2$。\n\n计算在已知第一次投掷结果的条件下，第二次投掷结果为7的概率。换句话说，求 $P(D_2=7 | D_1=3)$。请将您的答案表示为最简分数形式。", "solution": "设 $N\\in\\{4,6,8\\}$ 表示骰子的面数。先验概率为 $P(N=4)=\\frac{1}{2}$，$P(N=6)=\\frac{1}{3}$，以及 $P(N=8)=\\frac{1}{6}$。给定一个公平的 $N$ 面骰子，对于任何 $k\\in\\{1,\\dots,N\\}$，我们有 $P(D=k\\mid N)=\\frac{1}{N}$。由于 $3\\leq 4,6,8$，似然函数为 $P(D_{1}=3\\mid N=n)=\\frac{1}{n}$，其中 $n\\in\\{4,6,8\\}$。\n\n根据贝叶斯定理，\n$$\nP(N=n\\mid D_{1}=3)=\\frac{P(D_{1}=3\\mid N=n)P(N=n)}{\\sum_{m\\in\\{4,6,8\\}}P(D_{1}=3\\mid N=m)P(N=m)}=\\frac{\\frac{1}{n}P(N=n)}{\\frac{1}{4}\\cdot\\frac{1}{2}+\\frac{1}{6}\\cdot\\frac{1}{3}+\\frac{1}{8}\\cdot\\frac{1}{6}}.\n$$\n计算归一化分母：\n$$\n\\frac{1}{4}\\cdot\\frac{1}{2}+\\frac{1}{6}\\cdot\\frac{1}{3}+\\frac{1}{8}\\cdot\\frac{1}{6}=\\frac{1}{8}+\\frac{1}{18}+\\frac{1}{48}=\\frac{29}{144}.\n$$\n因此，\n$$\nP(N=4\\mid D_{1}=3)=\\frac{\\frac{1}{8}}{\\frac{29}{144}}=\\frac{18}{29},\\quad\nP(N=6\\mid D_{1}=3)=\\frac{\\frac{1}{18}}{\\frac{29}{144}}=\\frac{8}{29},\\quad\nP(N=8\\mid D_{1}=3)=\\frac{\\frac{1}{48}}{\\frac{29}{144}}=\\frac{3}{29}.\n$$\n\n给定 $N$，两次投掷是独立的，并且如果 $7\\leq n$，则 $P(D_{2}=7\\mid N=n)$ 等于 $\\frac{1}{n}$，否则为0。所以，\n$$\nP(D_{2}=7\\mid D_{1}=3)=\\sum_{n\\in\\{4,6,8\\}}P(D_{2}=7\\mid N=n)\\,P(N=n\\mid D_{1}=3)=\\frac{1}{8}\\cdot\\frac{3}{29}=\\frac{3}{232}.\n$$", "answer": "$$\\boxed{\\frac{3}{232}}$$", "id": "1946862"}, {"introduction": "从离散情况过渡到更常见的连续参数设定，这个问题将演示强大的正态-正态共轭模型。你将练习如何更新关于一个连续量 $\\mu$ 的先验信念，并推导出完整的后验预测分布。最终，你将运用此分布来计算未来测量值落在特定区间内的概率。[@problem_id:1946911]", "problem": "一位材料科学家正在研究一个与新制造晶体的压电响应相关的无量纲参数 $\\mu$。已知该测量仪器产生的读数服从正态分布，其真实均值为 $\\mu$，已知方差为 1。\n\n基于对相似材料的先验理论计算，该科学家使用均值为 0.5、方差为 0.25 的正态分布来为其对 $\\mu$ 的信念建模。\n\n该科学家随后进行了四次独立测量，得到以下数值：1.2、1.8、2.0 和 1.0。\n\n在使用该数据更新其对 $\\mu$ 的信念后，下一次单一测量值落在区间 $(-1, 1)$ 内的概率是多少？\n\n将你的最终答案四舍五入到三位有效数字。", "solution": "设测量模型为 $y_{i} \\mid \\mu \\sim \\text{Normal}(\\mu, \\sigma^{2})$，其中 $\\sigma^{2}=1$；先验分布为 $\\mu \\sim \\text{Normal}(m_{0}, v_{0})$，其中 $m_{0}=0.5$，$v_{0}=\\frac{1}{4}$。定义精度 $\\tau_{0}=\\frac{1}{v_{0}}$ 和 $\\tau=\\frac{1}{\\sigma^{2}}$。\n\n对于 $n$ 次独立观测 $y_{1},\\dots,y_{n}$，共轭正态后验分布为\n$$\nv_{n}=\\frac{1}{\\tau_{0}+n\\tau}, \\qquad m_{n}=v_{n}\\left(\\tau_{0}m_{0}+\\tau\\sum_{i=1}^{n}y_{i}\\right).\n$$\n此处 $n=4$ 且数据总和为 $\\sum_{i=1}^{4}y_{i}=1.2+1.8+2.0+1.0=6.0$。由 $v_{0}=\\frac{1}{4}$ 可知 $\\tau_{0}=4$，由 $\\sigma^{2}=1$ 可知 $\\tau=1$。因此\n$$\nv_{n}=\\frac{1}{4+4}=\\frac{1}{8}, \\qquad m_{n}=\\frac{1}{8}\\left(4\\cdot 0.5+1\\cdot 6\\right)=\\frac{1}{8}(2+6)=1.\n$$\n\n通过对 $\\mu$ 进行边际化，新测量值 $Y_{\\text{new}}$ 的后验预测分布是均值为 $m_{n}$、方差为 $\\sigma^{2}+v_{n}$ 的正态分布：\n$$\nY_{\\text{new}} \\mid \\text{data} \\sim \\text{Normal}\\left(m_{n},\\,\\sigma^{2}+v_{n}\\right)=\\text{Normal}\\left(1,\\,1+\\frac{1}{8}\\right)=\\text{Normal}\\left(1,\\,\\frac{9}{8}\\right).\n$$\n\n我们要求解 $P(-1<Y_{\\text{new}}<1\\mid \\text{data})$。设 $Z\\sim \\text{Normal}(0,1)$，并使用标准正态累积分布函数 $\\Phi$ 来表示此概率：\n$$\nP(-1<Y_{\\text{new}}<1)=\\Phi\\!\\left(\\frac{1-m_{n}}{\\sqrt{\\sigma^{2}+v_{n}}}\\right)-\\Phi\\!\\left(\\frac{-1-m_{n}}{\\sqrt{\\sigma^{2}+v_{n}}}\\right).\n$$\n代入 $m_{n}=1$ 和 $\\sigma^{2}+v_{n}=\\frac{9}{8}$ 可得\n$$\n\\frac{1-m_{n}}{\\sqrt{\\sigma^{2}+v_{n}}}=0, \\qquad \\frac{-1-m_{n}}{\\sqrt{\\sigma^{2}+v_{n}}}=\\frac{-2}{\\sqrt{9/8}}=-\\frac{4\\sqrt{2}}{3}.\n$$\n因此\n$$\nP(-1<Y_{\\text{new}}<1)=\\Phi(0)-\\Phi\\!\\left(-\\frac{4\\sqrt{2}}{3}\\right)=\\Phi\\!\\left(\\frac{4\\sqrt{2}}{3}\\right)-\\frac{1}{2}.\n$$\n使用 $\\Phi(x)=\\frac{1}{2}\\left[1+\\operatorname{erf}\\!\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$ 以及 $\\frac{1}{\\sqrt{2}}\\cdot \\frac{4\\sqrt{2}}{3}=\\frac{4}{3}$，\n$$\nP(-1<Y_{\\text{new}}<1)=\\frac{1}{2}\\operatorname{erf}\\!\\left(\\frac{4}{3}\\right).\n$$\n数值上，$\\operatorname{erf}\\!\\left(\\frac{4}{3}\\right)\\approx 0.940836$，所以\n$$\nP(-1<Y_{\\text{new}}<1)\\approx \\frac{1}{2}\\times 0.940836 \\approx 0.470418.\n$$\n四舍五入到三位有效数字，结果是 $0.470$。", "answer": "$$\\boxed{0.470}$$", "id": "1946911"}, {"introduction": "这个练习将引导你超越简单的概率计算，深入分析预测分布本身的性质。它突出了贝叶斯分析的一个关键方面：先验选择如何影响预测的不确定性。通过比较来自无信息先验和有信息先验的预测方差，你将深入理解在实践中整合先验知识所带来的具体影响。[@problem_id:1946883]", "problem": "在一家半导体制造厂，一批集成电路的质量由随机抽取一个电路为次品的概率 $\\theta$ 来评估。假定在一个大小为 $N$ 的样本中，次品的数量服从参数为 $\\theta$ 的二项分布。\n\n两位统计学家，一位初级分析师和一位高级分析师，负责预测未来一个生产批次中的次品数量。他们从贝叶斯的角度来处理这个问题。\n\n初级分析师由于缺乏关于此新工艺的具体历史数据，为 $\\theta$ 选择了一个无信息先验。他们使用参数为 $\\alpha_J = 1$ 和 $\\beta_J = 1$ 的 Beta 分布来为其信念建模。\n\n高级分析师根据类似制造工艺的经验，认为次品率可能接近 0.5。他们使用了一个信息量更大的先验，即参数为 $\\alpha_S = 10$ 和 $\\beta_S = 10$ 的 Beta 分布。\n\n随后，两位分析师都观察了来自一个测试批次的相同初始数据：一个包含 $n=20$ 个电路的样本被检验，发现其中有 $k=15$ 个次品。在用这些数据更新了他们的信念之后，他们被要求对一个未来的包含 $m=50$ 个电路的生产批次做出预测。\n\n设 $V_J$ 为初级分析师对新批次中次品数量的后验预测分布的方差，设 $V_S$ 为高级分析师的后验预测分布的方差。\n\n计算比率 $\\frac{V_J}{V_S}$。将最终答案四舍五入到四位有效数字。", "solution": "设次品概率为 $\\theta$，测试批次数据为 $n$ 个项目中存在 $k$ 个次品。对于一个 $\\mathrm{Beta}(\\alpha,\\beta)$ 先验和二项似然，后验分布为 $\\mathrm{Beta}(\\alpha',\\beta')$，其中 $\\alpha'=\\alpha+k$ 且 $\\beta'=\\beta+n-k$。对于一个未来大小为 $m$ 的生产批次，次品数量 $X$ 的后验预测分布为 $\\mathrm{Beta\\text{-}Binomial}(m,\\alpha',\\beta')$，其方差为\n$$\n\\operatorname{Var}(X)=m\\,\\frac{\\alpha'\\beta'}{(\\alpha'+\\beta')^{2}}\\cdot\\frac{\\alpha'+\\beta'+m}{\\alpha'+\\beta'+1}\n= m\\,\\frac{\\alpha'\\beta'(\\alpha'+\\beta'+m)}{(\\alpha'+\\beta')^{2}(\\alpha'+\\beta'+1)}.\n$$\n\n初级分析师：先验为 $\\mathrm{Beta}(1,1)$，因此对于 $n=20$ 和 $k=15$，\n$$\n\\alpha'_{J}=1+15=16,\\quad \\beta'_{J}=1+5=6.\n$$\n因此\n$$\nV_{J}=m\\,\\frac{16\\cdot 6\\,(16+6+m)}{(16+6)^{2}(16+6+1)}\n=50\\,\\frac{96\\cdot(22+50)}{22^{2}\\cdot 23}\n=50\\,\\frac{96\\cdot 72}{484\\cdot 23}\n=\\frac{345600}{11132}.\n$$\n\n高级分析师：先验为 $\\mathrm{Beta}(10,10)$，因此\n$$\n\\alpha'_{S}=10+15=25,\\quad \\beta'_{S}=10+5=15.\n$$\n因此\n$$\nV_{S}=m\\,\\frac{25\\cdot 15\\,(25+15+m)}{(25+15)^{2}(25+15+1)}\n=50\\,\\frac{375\\cdot(40+50)}{40^{2}\\cdot 41}\n=50\\,\\frac{375\\cdot 90}{1600\\cdot 41}\n=\\frac{1687500}{65600}.\n$$\n\n该比率为\n$$\n\\frac{V_{J}}{V_{S}}=\\frac{345600}{11132}\\cdot\\frac{65600}{1687500}\n=\\frac{345600\\cdot 65600}{11132\\cdot 1687500}.\n$$\n消去公因数：$\\gcd(65600,1687500)=100$，得到\n$$\n=\\frac{345600\\cdot 656}{11132\\cdot 16875}.\n$$\n对 $345600=2^{9}\\cdot 3^{3}\\cdot 5^{2}$ 和 $16875=3^{3}\\cdot 5^{4}$ 进行因式分解，所以\n$$\n\\frac{345600}{16875}=\\frac{2^{9}}{5^{2}}=\\frac{512}{25},\n$$\n因此\n$$\n\\frac{V_{J}}{V_{S}}=\\frac{512\\cdot 656}{25\\cdot 11132}.\n$$\n另外 $\\gcd(656,11132)=4$，所以\n$$\n\\frac{V_{J}}{V_{S}}=\\frac{512\\cdot 164}{25\\cdot 2783}=\\frac{83968}{69575}.\n$$\n数值上，\n$$\n\\frac{83968}{69575}\\approx 1.20687\\ldots,\n$$\n保留四位有效数字为 $1.207$。", "answer": "$$\\boxed{1.207}$$", "id": "1946883"}]}