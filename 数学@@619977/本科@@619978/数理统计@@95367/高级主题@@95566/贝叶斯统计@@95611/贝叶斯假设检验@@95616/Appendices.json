{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，它将帮助你直接应用贝叶斯因子的定义。该练习使用了一个常见的离散概率分布（几何分布），旨在巩固在两个竞争性简单假设下比较观测数据似然的核心概念。通过这个计算，你将掌握如何量化数据为一个假设相对于另一个假设所提供的证据强度。[@problem_id:1899175]", "problem": "在统计研究领域，一位研究人员正在研究一种新制造的电子开关的可靠性。该开关被设计为在第一次尝试时即激活，但制造过程中的不一致性可能导致其失效。开关首次激活所需的尝试次数 $X$ 假定服从几何分布。几何分布的概率质量函数由 $P(X=k | p) = (1-p)^{k-1}p$ 给出，其中 $k \\in \\{1, 2, 3, \\dots\\}$ 是首次成功时的试验次数，而 $p$ 是任意单次试验的成功概率。\n\n关于开关的质量，存在两个竞争性假设：\n- 原假设 ($H_0$)：开关是高质量的，其成功概率为 $p = 1/2$。\n- 备择假设 ($H_1$)：开关是标准质量的，其成功概率为 $p = 1/4$。\n\n从生产线上随机抽取一个开关进行测试。观察到该开关在第4次尝试时首次激活。\n\n基于此观察结果，计算支持原假设（$H_0$）相对于备择假设（$H_1$）的贝叶斯因子$K$。请将您的答案表示为一个最简分数。", "solution": "我们要求解的是基于观测数据 $X=4$ 时，支持 $H_0$ 相对于 $H_1$ 的贝叶斯因子。对于简单假设，贝叶斯因子定义为似然比：\n$$\nK=\\frac{P(X=4\\mid H_{0})}{P(X=4\\mid H_{1})}.\n$$\n在参数为 $p$ 的几何分布下，其概率质量函数为\n$$\nP(X=k\\mid p)=(1-p)^{k-1}p,\\quad k\\in\\{1,2,3,\\dots\\}.\n$$\n对于 $H_0$，我们有 $p=\\frac{1}{2}$。代入 $k=4$ 可得\n$$\nP(X=4\\mid H_{0})=(1-\\tfrac{1}{2})^{3}\\cdot\\tfrac{1}{2}=\\left(\\tfrac{1}{2}\\right)^{3}\\cdot\\tfrac{1}{2}=\\left(\\tfrac{1}{2}\\right)^{4}=\\frac{1}{16}.\n$$\n对于 $H_1$，我们有 $p=\\frac{1}{4}$。代入 $k=4$ 可得\n$$\nP(X=4\\mid H_{1})=(1-\\tfrac{1}{4})^{3}\\cdot\\tfrac{1}{4}=\\left(\\tfrac{3}{4}\\right)^{3}\\cdot\\tfrac{1}{4}=\\frac{27}{64}\\cdot\\frac{1}{4}=\\frac{27}{256}.\n$$\n因此，贝叶斯因子为\n$$\nK=\\frac{\\frac{1}{16}}{\\frac{27}{256}}=\\frac{1}{16}\\cdot\\frac{256}{27}=\\frac{16}{27}.\n$$\n此分数已为最简形式。", "answer": "$$\\boxed{\\frac{16}{27}}$$", "id": "1899175"}, {"introduction": "在计算出单个贝叶斯因子之后，更进一步是理解证据如何随数据的变化而动态演变。这个练习探讨了贝叶斯因子作为数据函数的行为，设定在一个连续数据（正态分布）的背景下。通过找到那个使证据对两个假设提供同等支持的精确数据点，你将对贝叶斯分析中如何权衡证据建立更深刻的直觉。[@problem_id:1899165]", "problem": "一位统计学家正在分析一个测量过程，并对某个物理参数 $\\theta$ 提出了两种相互竞争的理论。这些理论被表述为两个简单假设：\n- 零假设, $H_0: \\theta = 1$。\n- 备择假设, $H_1: \\theta = 2$。\n\n为了在这两个假设之间做出抉择，我们进行了一次测量，得到测量值 $x$。根据该测量设备的性质可知，观测值 $x$ 服从正态分布，其均值为 $\\theta$，方差为 $\\sigma^2 = 1$。也就是说，在参数 $\\theta$ 给定的条件下，观测到值为 $x$ 的概率密度函数为：\n$$p(x|\\theta) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\theta)^2}{2}\\right)$$\n\n在贝叶斯假设检验中，数据提供的证据由贝叶斯因子 $B_{10}$ 来量化，它是数据在备择假设下的似然与在零假设下的似然之比：\n$$B_{10} = \\frac{p(x|H_1)}{p(x|H_0)}$$\n\n贝叶斯因子 $B_{10} = 1$ 表示观测数据没有提供任何证据以偏好其中一个假设。\n\n请确定观测值 $x$ 的确切数值，该值将导致贝叶斯因子恰好为 1，从而为 $H_0$ 和 $H_1$ 提供同等支持。", "solution": "给定方差为 $\\sigma^{2}=1$ 的正态模型的两个简单假设：\n$H_{0}: \\theta=1$ 和 $H_{1}: \\theta=2$，其密度函数为\n$$\np(x \\mid \\theta)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-\\theta)^{2}}{2}\\right).\n$$\n支持 $H_1$ 相对于 $H_0$ 的贝叶斯因子为\n$$\nB_{10}=\\frac{p(x \\mid H_{1})}{p(x \\mid H_{0})}\n=\\frac{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-2)^{2}}{2}\\right)}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-1)^{2}}{2}\\right)}\n=\\exp\\left(-\\frac{(x-2)^{2}-(x-1)^{2}}{2}\\right).\n$$\n为了获得同等支持，设 $B_{10}=1$。取自然对数可得\n$$\n\\ln B_{10}=0 \\quad \\Longrightarrow \\quad -\\frac{(x-2)^{2}-(x-1)^{2}}{2}=0,\n$$\n因此\n$$\n(x-2)^{2}-(x-1)^{2}=0.\n$$\n展开两个平方项：\n$$\n(x-2)^{2}=x^{2}-4x+4, \\qquad (x-1)^{2}=x^{2}-2x+1.\n$$\n相减：\n$$\n(x^{2}-4x+4)-(x^{2}-2x+1)=-2x+3=0.\n$$\n解出 $x$：\n$$\n-2x+3=0 \\quad \\Longrightarrow \\quad x=\\frac{3}{2}.\n$$\n因此，$x=\\frac{3}{2}$ 会得到恰好为 $1$ 的贝叶斯因子，从而为 $H_{0}$ 和 $H_{1}$ 提供同等支持。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1899165"}, {"introduction": "本章的最后一个练习将理论与实践决策紧密联系起来，解决了一个在科学和工业研究中至关重要的现实问题：“需要多少证据才足够？”。你将确定为了让对一个假设的后验置信度达到特定阈值，需要累积多少观测数据。这个过程清晰地展示了如何运用贝叶斯推理来指导实验设计和做出有依据的决策。[@problem_id:1899173]", "problem": "一个材料科学实验室正在开发一种旨在抵抗特定类型应力断裂的新合金。现有的标准合金在特定应力测试下失效的概率为 $0.6$，这意味着其成功的概率为 $0.4$。理论上，新合金被认为更优越，其预期成功概率为 $0.6$。然而，由于制造过程的复杂性，新合金也可能并不比旧合金好。\n\n在投入昂贵的大规模生产之前，研究团队持有的初始信念是：新合金的真实成功概率为 $0.6$ 的可能性为 50%，而其真实成功概率仅为 $0.4$ 的可能性也为 50%。他们决定对新合金的样本进行一系列初步的应力测试。\n\n团队必须观察到多少次连续的成功测试（即合金未发生断裂的测试），才能更新他们的信念，使得他们认定该合金的真实成功率为 $0.6$ 的概率大于 $0.95$？", "solution": "令 $H_{1}$ 表示真实成功概率为 $0.6$，$H_{0}$ 表示真实成功概率为 $0.4$。先验概率为 $P(H_{1})=P(H_{0})=\\frac{1}{2}$。对于 $n$ 次独立且全部成功的测试，似然为\n$$\nP(\\text{data}\\mid H_{1})=(0.6)^{n},\\qquad P(\\text{data}\\mid H_{0})=(0.4)^{n}.\n$$\n根据贝叶斯定理，在给定 $n$ 次成功的情况下，$H_{1}$ 的后验概率为\n$$\nP(H_{1}\\mid \\text{data})=\\frac{P(\\text{data}\\mid H_{1})P(H_{1})}{P(\\text{data}\\mid H_{1})P(H_{1})+P(\\text{data}\\mid H_{0})P(H_{0})}\n=\\frac{(0.6)^{n}}{(0.6)^{n}+(0.4)^{n}}\n=\\frac{1}{1+\\left(\\frac{0.4}{0.6}\\right)^{n}}\n=\\frac{1}{1+\\left(\\frac{2}{3}\\right)^{n}}.\n$$\n我们需要 $P(H_{1}\\mid \\text{data})>0.95$，因此\n$$\n\\frac{1}{1+\\left(\\frac{2}{3}\\right)^{n}}> \\frac{19}{20}\n\\;\\;\\Longleftrightarrow\\;\\;\n1+\\left(\\frac{2}{3}\\right)^{n}<\\frac{20}{19}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\left(\\frac{2}{3}\\right)^{n}<\\frac{1}{19}.\n$$\n取自然对数（注意 $\\ln\\!\\left(\\frac{2}{3}\\right)<0$）可得\n$$\nn>\\frac{\\ln\\!\\left(\\frac{1}{19}\\right)}{\\ln\\!\\left(\\frac{2}{3}\\right)}=\\frac{\\ln(19)}{\\ln\\!\\left(\\frac{3}{2}\\right)}.\n$$\n为了找到最小整数 $n$，我们精确地检验 $n=7$ 和 $n=8$ 的情况：\n$$\n\\left(\\frac{2}{3}\\right)^{7}=\\frac{128}{2187}\\quad\\text{且}\\quad 19\\cdot 128=2432>2187\\;\\Rightarrow\\;\\left(\\frac{2}{3}\\right)^{7}>\\frac{1}{19},\n$$\n所以当 $n=7$ 时，$P(H_{1}\\mid \\text{data})<\\frac{19}{20}=0.95$。接下来，\n$$\n\\left(\\frac{2}{3}\\right)^{8}=\\frac{256}{6561}\\quad\\text{且}\\quad 19\\cdot 256=4864<6561\\;\\Rightarrow\\;\\left(\\frac{2}{3}\\right)^{8}<\\frac{1}{19},\n$$\n所以当 $n=8$ 时，$P(H_{1}\\mid \\text{data})>\\frac{19}{20}=0.95$。因此，所需的最少连续成功次数为 $8$。", "answer": "$$\\boxed{8}$$", "id": "1899173"}]}