{"hands_on_practices": [{"introduction": "理论知识只有通过实践才能真正掌握。我们从一个基础练习开始，这个练习将直接检验你对负二项分布核心定义的理解。通过计算在特定试验次数上达到预定成功次数的概率，你将练习使用负二项分布的概率质量函数（PMF），这是后续更复杂应用的基石。[@problem_id:12863]", "problem": "考虑一个独立的伯努利试验序列，其中每次试验可能出现两种结果之一：“成功”或“失败”。在任何给定的试验中，成功的概率是恒定的，记为 $p$，而失败的概率是 $1-p$。\n\n令随机变量 $X$ 为第 $r$ 次成功发生时的试验次数。在本题中，我们关心的是求第 3 次成功发生在第 10 次试验上的概率这一特定情况。\n\n推导当 $r=3$ 次成功时，概率 $P(X=10)$ 的表达式。你的最终答案应该是一个用成功概率 $p$ 表示的闭式表达式。", "solution": "我们用负二项分布来为在成功概率为 $p$ 的独立伯努利试验中获得 $r$ 次成功所需的试验次数 $X$ 建模。第 $r$ 次成功发生在第 $n$ 次试验上的概率是\n$$\nP(X=n)\\;=\\;\\binom{n-1}{r-1}\\,p^r\\,(1-p)^{\\,n-r}\\,.\n$$\n当 $r=3$ 且 $n=10$ 时，这给出\n$$\nP(X=10)\n=\\binom{10-1}{3-1}\\,p^3\\,(1-p)^{10-3}\n=\\binom{9}{2}\\,p^3\\,(1-p)^7.\n$$\n由于\n$$\n\\binom{9}{2}=\\frac{9\\cdot8}{2}=36,\n$$\n我们得到\n$$\nP(X=10)=36\\,p^3\\,(1-p)^7.\n$$", "answer": "$$\\boxed{36\\,p^3\\,(1-p)^7}$$", "id": "12863"}, {"introduction": "现在，让我们进入一个更具挑战性的场景，它涉及到条件概率。这个问题引入了先验信息——即已知最初几次试验的结果为失败，这要求你重新评估后续事件的概率。这个练习巧妙地揭示了负二项分布所依赖的伯努利过程的“无记忆性”，这个特性是在处理随机过程时简化复杂计算的关键。[@problem_id:1939527]", "problem": "一位在制药实验室的研究人员正在筛选一个大型化学化合物库，以寻找一种能够抑制特定酶的化合物。对每种化合物的筛选过程被视为一次独立的试验。任何给定化合物是抑制剂（即“成功”）的概率为 $p$，其中 $0 < p < 1$。该研究人员计划继续测试化合物，直到找到恰好 $r=4$ 种抑制剂。\n\n假设已知前 $k=6$ 次测试的化合物*不是*抑制剂（即它们是失败的）。在给定此信息的情况下，总共需要进行恰好 $n=15$ 次试验才能找到这4种抑制剂的概率是多少？\n\n将您的答案表示为 $p$ 的函数。", "solution": "设试验是独立的，成功概率为 $p$，并令 $N$ 表示获得 $r=4$ 次成功所需的总试验次数。我们已知前 $k=6$ 次试验是失败的。我们要求解\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6}).\n$$\n根据条件概率的定义，\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6})=\\frac{\\Pr(N=15, F_{1},\\ldots,F_{6})}{\\Pr(F_{1},\\ldots,F_{6})}.\n$$\n由于试验的独立性，我们有\n$$\n\\Pr(F_{1},\\ldots,F_{6})=(1-p)^{6}.\n$$\n对于分子中的联合事件，事件 $N=15$ 意味着在前 $14$ 次试验中有恰好 $3$ 次成功，且第 $15$ 次试验是成功的。在已知前 $6$ 次试验均失败的条件下，这等价于在第 $7$ 次到第 $14$ 次试验中有恰好 $3$ 次成功，且第 $15$ 次试验是成功的。根据独立性，\n$$\n\\Pr(N=15, F_{1},\\ldots,F_{6})=(1-p)^{6}\\left[\\binom{8}{3}p^{3}(1-p)^{5}\\right]p=\\binom{8}{3}p^{4}(1-p)^{11}.\n$$\n因此，\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6})=\\frac{\\binom{8}{3}p^{4}(1-p)^{11}}{(1-p)^{6}}=\\binom{8}{3}p^{4}(1-p)^{5}.\n$$\n等价地，以前 $6$ 次失败为条件，意味着获得 $4$ 次成功所需的额外试验次数服从参数为 $r=4$ 和 $p$ 的负二项分布，因此对于 $15-6=9$ 次额外试验，\n$$\n\\Pr(N=15 \\mid F_{1},\\ldots,F_{6})=\\binom{9-1}{4-1}p^{4}(1-p)^{9-4}=\\binom{8}{3}p^{4}(1-p)^{5}.\n$$", "answer": "$$\\boxed{\\binom{8}{3}p^{4}(1-p)^{5}}$$", "id": "1939527"}, {"introduction": "最后，我们将理论从纯粹的概率计算推向统计推断的实际应用。在这个练习中，你将扮演一名研究人员，需要根据实验数据来估计模型的关键参数。你将运用强大的最大似然估计（MLE）方法，这是现代统计学的核心技术之一，用以寻找能够最佳解释观测数据的成功概率 $p$。[@problem_id:1321150]", "problem": "一个网络安全研究团队正在评估一种用于检测网络流中恶意数据包的新算法。该算法构成一个入侵检测系统 (IDS)。在一个受控环境中，数据包被逐个流式传输到该检测系统。每个数据包是恶意的并被算法正确识别的概率是恒定且独立的，记为 $p$，这种情况被定义为一次“成功”。如果一个数据包由于任何原因（即，它是良性的或是一个被漏掉的恶意数据包）而未构成一次成功，则被视为一次“失败”。\n\n为了测试该算法的性能，该团队进行了 $n$ 次独立实验。在每次实验 $i$（对于 $i=1, \\dots, n$）中，团队记录在观测到恰好 $r$ 次成功之前发生的失败次数 $X_i$。$r$ 的值是一个预先设定的正整数，并且对所有实验都相同。\n\n给定这 $n$ 次实验的观测数据 $x_1, x_2, \\dots, x_n$，求成功概率 $p$ 的最大似然估计量 $\\hat{p}$。请将您的答案表示为以 $r$、$n$ 和观测到的总失败次数 $S = \\sum_{i=1}^{n} x_i$ 表示的符号表达式。", "solution": "我们对每次实验建模如下。设 $X_{i}$ 表示在实验 $i$ 中，第 $r$ 次成功之前发生的失败次数，每次试验的成功概率为常数 $p$，且各次试验和实验之间相互独立。那么，$X_{i}$ 服从负二项分布（计算第 $r$ 次成功前的失败次数），其概率质量函数为\n$$\n\\Pr(X_{i}=x_{i}\\,|\\,p)=\\binom{x_{i}+r-1}{x_{i}}(1-p)^{x_{i}}p^{r},\\quad x_{i}=0,1,2,\\dots.\n$$\n给定 $n$ 次独立实验的观测值 $x_{1},\\dots,x_{n}$，似然函数为\n$$\nL(p)=\\prod_{i=1}^{n}\\binom{x_{i}+r-1}{x_{i}}(1-p)^{x_{i}}p^{r}.\n$$\n设 $S=\\sum_{i=1}^{n}x_{i}$。似然函数可分解为\n$$\nL(p)=\\left[\\prod_{i=1}^{n}\\binom{x_{i}+r-1}{x_{i}}\\right](1-p)^{S}p^{nr}.\n$$\n由于二项式系数的乘积不依赖于 $p$，其对数似然函数为\n$$\n\\ell(p)=\\ln L(p)=\\text{常数}+S\\ln(1-p)+nr\\ln p.\n$$\n对 $p$ 求导并令其等于零，得到得分方程：\n$$\n\\frac{d\\ell}{dp}=\\frac{nr}{p}-\\frac{S}{1-p}=0.\n$$\n解出 $p$ 可得\n$$\n\\frac{nr}{p}=\\frac{S}{1-p}\\quad\\Longrightarrow\\quad nr(1-p)=Sp\\quad\\Longrightarrow\\quad nr= p(nr+S)\\quad\\Longrightarrow\\quad \\hat{p}=\\frac{nr}{nr+S}.\n$$\n为验证该临界点是一个最大值，我们计算二阶导数：\n$$\n\\frac{d^{2}\\ell}{dp^{2}}=-\\frac{nr}{p^{2}}-\\frac{S}{(1-p)^{2}}<0\n$$\n对于 $p\\in(0,1)$，该式小于0，这证实了它是一个最大值。因此，最大似然估计量是\n$$\n\\hat{p}=\\frac{nr}{nr+S}.\n$$", "answer": "$$\\boxed{\\frac{nr}{nr+S}}$$", "id": "1321150"}]}