{"hands_on_practices": [{"introduction": "这第一个练习将让你扮演一位研究稀有基因变异的植物学家。通过计算找到特定数量四叶草的概率，你将亲眼见证，在处理大量试验和极低成功率的情况下，泊松分布如何作为一个强大而实用的工具来近似二项概率 [@problem_id:1950634]。这种方法不仅简化了复杂的计算，还能提供一个高度准确的结果。", "problem": "一位植物学家正在对白三叶草（*Trifolium repens*）的遗传变异进行大规模的田野研究。根据大量的历史数据，我们知道四叶草的自然出现是一个罕见事件，对于任何一株三叶草来说，其概率为 $p = 1/1200$。该植物学家从一大片草地上随机检查了 $3000$ 株三叶草样本。\n\n假设四叶草的出现是独立事件，计算植物学家在整个样本中找到少于三株四叶草的概率。\n\n将您的答案表示为一个数值，并四舍五入到四位有效数字。", "solution": "设 $X$ 是在 $n=3000$ 次独立试验中找到的四叶草数量，每次成功的概率为 $p=\\frac{1}{1200}$。那么 $X \\sim \\mathrm{Binomial}(n,p)$，所求概率为\n$$\n\\Pr(X<3)=\\sum_{k=0}^{2}\\binom{3000}{k}p^{k}(1-p)^{3000-k}.\n$$\n令 $q=1-p=\\frac{1199}{1200}$。记 $P_{k}=\\Pr(X=k)=\\binom{3000}{k}p^{k}q^{3000-k}$。那么\n$$\n\\Pr(X<3)=P_{0}+P_{1}+P_{2}.\n$$\n通过对数计算 $P_{0}=q^{3000}$。使用级数 $\\ln(1-t)=-t-\\frac{t^{2}}{2}-\\frac{t^{3}}{3}-\\frac{t^{4}}{4}-\\cdots$，其中 $t=p=\\frac{1}{1200}$，\n$$\n\\ln q=\\ln\\!\\left(1-\\frac{1}{1200}\\right)\\approx -\\frac{1}{1200}-\\frac{1}{2\\cdot 1200^{2}}-\\frac{1}{3\\cdot 1200^{3}}-\\frac{1}{4\\cdot 1200^{4}},\n$$\n所以\n$$\n3000\\ln q\\approx -2.501042245632,\\quad P_{0}=q^{3000}=\\exp(3000\\ln q)\\approx \\exp(-2.501042245632)\\approx 0.08199949046.\n$$\n使用二项递推公式\n$$\n\\frac{P_{k+1}}{P_{k}}=\\frac{n-k}{k+1}\\cdot\\frac{p}{q}.\n$$\n对于 $k=0$，\n$$\nP_{1}=P_{0}\\cdot \\frac{n}{1}\\cdot\\frac{p}{q}=P_{0}\\cdot \\frac{3000}{1199}\\approx 0.08199949046\\times 2.5020829858225\\approx 0.20516952993.\n$$\n对于 $k=1$，\n$$\nP_{2}=P_{1}\\cdot \\frac{n-1}{2}\\cdot\\frac{p}{q}=P_{1}\\cdot \\frac{2999}{2398}\\approx 0.20516952993\\times 1.25062552127\\approx 0.25659015405.\n$$\n因此，\n$$\n\\Pr(X<3)=P_{0}+P_{1}+P_{2}\\approx 0.08199949046+0.20516952993+0.25659015405\\approx 0.5437591744.\n$$\n四舍五入到四位有效数字，概率为 $0.5438$。", "answer": "$$\\boxed{0.5438}$$", "id": "1950634"}, {"introduction": "从应用转向批判性思维，这个练习将挑战你作为一名高级工程师，评估一个使用泊松近似的建议。该场景涉及一个制造过程，其中近似的条件可能无法满足 [@problem_id:1950665]。你的任务是找出为什么这种近似不合适的根本原因，从而加深你对基本标准——即大量的试验次数 $n$ 和小的成功概率 $p$——的理解。", "problem": "一位质量控制工程师正在监控一种特定类型电阻器的新制造过程。每批次包含 $n=25$ 个电阻器。由于该过程是新开发的，任何单个电阻器有缺陷的概率 $p$ 相对较高，估计为 $p=0.2$。设随机变量 $X$ 表示一批次中有缺陷电阻器的数量。$X$ 的真实分布是二项分布 $B(n=25, p=0.2)$。\n\n一名实习生建议，为简化过程控制计算，可以用泊松分布来近似缺陷数量 $X$。该实习生的理由是，每批次的预期缺陷数 $\\lambda = np = 25 \\times 0.2 = 5$ 是一个适中的数值，因此使用均值为 $\\lambda=5$ 的泊松分布是合适的模型。\n\n作为高级工程师，您必须评估这一建议。在这一特定情景下，以下哪个陈述对使用泊松近似法提出了最准确和最根本的批评？\n\nA. 该建议是有效的。只要期望值 $\\lambda = np$ 是一个适中的数，泊松近似就是合适的，这里 $\\lambda=5$ 正是这种情况。\n\nB. 该建议是无效的。泊松近似仅在试验次数 $n$ 非常大时（例如，通常的规则是 $n > 100$）才适用。由于 $n=25$，近似效果很差。\n\nC. 该建议是无效的。泊松近似的一个关键要求是事件发生的概率 $p$ 必须非常小。由于 $p=0.2$，这个条件被严重违反了。\n\nD. 该建议是无效的。泊松分布只用于模拟在连续时间或空间间隔内发生的事件数，而不适用于此类离散的试验次数。\n\nE. 该建议是有效的。真实二项分布的方差是 $np(1-p) = 4$，这与所提出的泊松分布的均值 $\\lambda=5$ 非常接近，表明拟合良好。", "solution": "设 $X \\sim \\mathrm{Bin}(n,p)$，其概率质量函数为\n$$\n\\Pr(X=k)=\\binom{n}{k} p^{k} (1-p)^{n-k}.\n$$\n使用均值为 $\\lambda=np$ 的泊松近似的合理性，是基于 $n \\to \\infty$，$p \\to 0$，且 $\\lambda=np$ 保持不变的极限情况。在该情况下，可以证明\n$$\n\\binom{n}{k} p^{k} \\approx \\frac{\\lambda^{k}}{k!},\n\\quad\n(1-p)^{n}=\\exp\\!\\big(n \\ln(1-p)\\big)=\\exp\\!\\big(-\\lambda - \\tfrac{n p^{2}}{2} - \\tfrac{n p^{3}}{3} - \\cdots \\big)\n\\approx \\exp(-\\lambda),\n$$\n其中，除了 $p \\ll 1$ 之外，该近似还要求 $n p^{2} \\ll 1$（且更高阶项可忽略）。因此，二项分布的泊松近似效果要好，一个基本要求是 $p$ 必须非常小，同时 $n$ 要足够大，以使 $\\lambda=np$ 的大小适中。\n\n在当前情况下，$n=25$ 且 $p=0.2$。条件 $p \\ll 1$ 被严重违反了。来自 $\\ln(1-p)$ 的指数中的误差项的量级为 $n p^{2}$，当 $p$ 不小时，该项不可忽略。因此，最准确的批评集中在 $p$ 不够小这一点上。\n\n评估各选项：\n- A 是不正确的，因为仅有适中的 $\\lambda$ 是不够的；还需要 $p \\ll 1$。\n- B 具有误导性，因为仅有大的 $n$ 本身并不能保证好的泊松近似；关键在于 $p$ 非常小而 $\\lambda=np$ 固定。\n- C 是正确的：一个关键要求是 $p$ 要非常小，而 $p=0.2$ 并不满足此条件。\n- D 是不正确的，因为泊松分布也用作稀有事件情况下二项分布的近似，而不仅用于连续时间或空间的计数。\n- E 是不正确的，因为匹配或比较均值和方差并非泊松近似的准则；实际上，$\\mathrm{Var}[\\mathrm{Bin}(n,p)]=np(1-p)=\\lambda(1-p)$ 与泊松方差 $\\lambda$ 相差一个因子 $1-p$，其相对差异等于 $p$，在此处 $p$ 并不小。\n\n因此，最准确和最根本的批评是 $p$ 不够小，这使得泊松近似在此情景下无效。", "answer": "$$\\boxed{C}$$", "id": "1950665"}, {"introduction": "最后的这个练习将你的理解提升到一个更高的层次，要求你量化泊松近似的精度。你将为一个量子点显示器制造的质量控制场景，确定近似的相对误差变得显著的临界点 [@problem_id:1950649]。这个问题要求你分析近似误差的数学形式，从而让你深刻洞察计算简便性与准确性之间的权衡。", "problem": "在量子点显示器的生产过程中，每个像素在制造时有很小的独立概率成为“坏点”（无功能），该概率为 $p = 0.01$。显示器在大型晶圆上制造，每个晶圆包含总共 $n$ 个像素。\n\n为了进行质量控制分析，考虑使用两种模型来描述晶圆上坏点的数量：\n1.  **精确模型**，该模型假设坏点数量服从二项分布。\n2.  **泊松近似**，该模型在计算上更简单，并假设坏点数量服从泊松分布，其均值 $\\lambda$ 等于精确模型中坏点数量的期望值。\n\n如果在计算完美晶圆（零坏点）的概率时，相对误差达到某一阈值，则认为该近似失效。相对误差是相对于精确概率定义的。\n\n确定晶圆上像素的最小数量 $n$，使得在预测零坏点时，相对误差至少为 1%。也就是说，找到满足以下条件的最小整数 $n$：\n$$ \\frac{|P_{approx}(0) - P_{exact}(0)|}{P_{exact}(0)} \\ge 0.01 $$\n其中 $P_{exact}(0)$ 是零坏点的精确概率，而 $P_{approx}(0)$ 是由泊松近似给出的概率。你的最终答案应该是一个整数。", "solution": "设 $X$ 为晶圆上的坏点数量。在精确模型下，$X \\sim \\text{Binomial}(n,p)$ 且 $p=0.01$，因此零坏点的精确概率为\n$$\nP_{\\text{exact}}(0) = (1-p)^{n}.\n$$\n在 $\\lambda = np$ 的泊松近似下，零坏点的概率为\n$$\nP_{\\text{approx}}(0) = \\exp(-\\lambda) = \\exp(-np).\n$$\n相对于精确概率的相对误差为\n$$\nE(n) = \\frac{|P_{\\text{approx}}(0) - P_{\\text{exact}}(0)|}{P_{\\text{exact}}(0)}.\n$$\n对于 $0<p<1$，注意到 $\\ln(1-p) = -p - \\frac{p^{2}}{2} - \\frac{p^{3}}{3} - \\cdots < -p$，因此\n$$\n(1-p)^{n} = \\exp\\!\\big(n\\ln(1-p)\\big) < \\exp(-np),\n$$\n所以有 $P_{\\text{approx}}(0) > P_{\\text{exact}}(0)$，并且可以去掉绝对值符号：\n$$\nE(n) = \\frac{\\exp(-np) - (1-p)^{n}}{(1-p)^{n}} = \\exp(-np)\\,(1-p)^{-n} - 1.\n$$\n将此重写为\n$$\nE(n) = \\exp\\!\\big(n[-p - \\ln(1-p)]\\big) - 1.\n$$\n定义 $g(p) = -p - \\ln(1-p)$，对于 $0<p<1$ 满足 $g(p) > 0$。那么\n$$\nE(n) = \\exp\\!\\big(n\\,g(p)\\big) - 1.\n$$\n失效标准是 $E(n) \\ge 0.01$，即\n$$\n\\exp\\!\\big(n\\,g(p)\\big) \\ge 1.01 \\quad \\Longleftrightarrow \\quad n \\ge \\frac{\\ln(1.01)}{g(p)}.\n$$\n当 $p = 0.01$ 时，我们有\n$$\ng(0.01) = -0.01 - \\ln(0.99) = \\frac{(0.01)^{2}}{2} + \\frac{(0.01)^{3}}{3} + \\frac{(0.01)^{4}}{4} + \\cdots \\approx 0.0000503358535,\n$$\n且\n$$\n\\ln(1.01) \\approx 0.009950330853.\n$$\n因此\n$$\n\\frac{\\ln(1.01)}{g(0.01)} \\approx \\frac{0.009950330853}{0.0000503358535} \\approx 197.6788.\n$$\n所以，满足该不等式的最小整数 $n$ 是\n$$\nn = 198.\n$$\n对该值附近的数值进行快速检验可以证实其单调性：对于 $n=197$，$E(197) = \\exp(197\\,g) - 1 \\approx 0.009965 < 0.01$，而对于 $n=198$，$E(198) = \\exp(198\\,g) - 1 \\approx 0.010016 > 0.01$，因此 $198$ 是最小的。", "answer": "$$\\boxed{198}$$", "id": "1950649"}]}