{"hands_on_practices": [{"introduction": "掌握了超几何分布的核心概念后，最好的学习方法就是通过实践来巩固。这个练习将带你进入一个典型的考古学场景，你需要应用超几何分布的概率质量函数（PMF）来计算一个具体事件发生的精确概率。这是理解和应用该分布的基础，也是后续更复杂分析的起点。[@problem_id:1307565]", "problem": "一个考古团队在一个挖掘现场出土了25片古代陶器碎片。经过初步清洗和分析，他们发现其中8片陶片带有独特的‘交叉影线’装饰标记，这是确定该遗址年代的一个关键指标。为了进行更详细的分析，首席考古学家从这批陶片中随机抽取了5片样本送往实验室。所选样本中恰好有2片带有交叉影线标记的概率是多少？\n\n计算你的答案并四舍五入到四位有效数字。", "solution": "由于是无放回抽样，我们使用超几何分布来模拟样本中带有交叉影线标记的陶片数量。设总体大小为 $N=25$，成功项（带有交叉影线标记的陶片）的数量为 $K=8$，样本大小为 $n=5$，我们想要恰好 $k=2$ 次成功。概率为\n$$\nP(X=2)=\\frac{\\binom{K}{k}\\binom{N-K}{n-k}}{\\binom{N}{n}}=\\frac{\\binom{8}{2}\\binom{17}{3}}{\\binom{25}{5}}.\n$$\n\n明确地计算每个二项式系数：\n$$\n\\binom{8}{2}=\\frac{8!}{2!\\,6!}=28,\\quad\n\\binom{17}{3}=\\frac{17\\cdot 16\\cdot 15}{3\\cdot 2\\cdot 1}=680,\\quad\n\\binom{25}{5}=\\frac{25\\cdot 24\\cdot 23\\cdot 22\\cdot 21}{5\\cdot 4\\cdot 3\\cdot 2\\cdot 1}=53130.\n$$\n因此，\n$$\nP=\\frac{28\\cdot 680}{53130}=\\frac{19040}{53130}.\n$$\n通过将分子和分母同时除以它们的最大公约数 $\\gcd(19040,53130)=70$ 来化简分数：\n$$\nP=\\frac{272}{759}.\n$$\n计算其小数近似值并四舍五入到四位有效数字：\n$$\n\\frac{272}{759}\\approx 0.358366\\ldots \\approx 0.3584\\ \\text{(到四位有效数字)}.\n$$", "answer": "$$\\boxed{0.3584}$$", "id": "1307565"}, {"introduction": "计算单个结果的概率是第一步，但一个更深入的问题是：“在一次抽样中，最有可能出现的结果是什么？” 这项练习将引导你从分析层面探索超几何分布的性质，通过研究连续概率的比值来推导其众数（mode）的通用公式。掌握这项技能对于在质量控制等领域中预测最常见结果至关重要。[@problem_id:1921890]", "problem": "某半导体制造厂的一名质检工程师正在检验一批高性能微处理器。该批次共有 $N$ 个微处理器，其中有未知数量 $K$ 个是次品。工程师从该批次中随机抽取一个包含 $n$ 个微处理器的样本进行无放回抽样检测。\n\n令随机变量 $X$ 表示在样本中发现的次品微处理器的数量。发现恰好 $k$ 个次品微处理器的概率由超几何概率质量函数给出：\n$$\nP(X=k) = \\frac{\\binom{K}{k} \\binom{N-K}{n-k}}{\\binom{N}{n}}\n$$\n其中 $\\binom{a}{b}$ 是二项式系数“a选b”，表示 $\\frac{a!}{b!(a-b)!}$。$k$ 的可能取值是满足 $\\max(0, n - (N-K)) \\le k \\le \\min(n, K)$ 的整数。\n\n您的任务是确定该分布众数的一般解析式。众数代表在样本中最可能发现的次品微处理器的数量。请用一个关于 $N$、$K$ 和 $n$ 的封闭形式表达式来表示您的答案。您可以使用向下取整函数 $\\lfloor x \\rfloor$，它给出小于或等于 $x$ 的最大整数。", "solution": "我们寻求使超几何概率质量函数\n$$\nP(X=k)=\\frac{\\binom{K}{k}\\binom{N-K}{n-k}}{\\binom{N}{n}},\n$$\n最大化的 $k$ 值，其中 $k$ 在其支撑集 $\\max(0,\\,n-(N-K))\\leq k\\leq \\min(n,\\,K)$ 内。由于分母 $\\binom{N}{n}$ 不依赖于 $k$，众数的位置由分子作为 $k$ 的函数的行为决定。一个标准方法是考察连续概率的比值：\n$$\nR_{k}\\equiv \\frac{P(X=k+1)}{P(X=k)}=\\frac{\\binom{K}{k+1}}{\\binom{K}{k}}\\cdot \\frac{\\binom{N-K}{n-(k+1)}}{\\binom{N-K}{n-k}}.\n$$\n使用恒等式 $\\frac{\\binom{a}{b+1}}{\\binom{a}{b}}=\\frac{a-b}{b+1}$ 和 $\\frac{\\binom{a}{b-1}}{\\binom{a}{b}}=\\frac{b}{a-b+1}$，我们得到\n$$\n\\frac{\\binom{K}{k+1}}{\\binom{K}{k}}=\\frac{K-k}{k+1},\\qquad \\frac{\\binom{N-K}{n-k-1}}{\\binom{N-K}{n-k}}=\\frac{n-k}{N-K-n+k+1}.\n$$\n因此，\n$$\nR_{k}=\\frac{K-k}{k+1}\\cdot \\frac{n-k}{N-K-n+k+1}.\n$$\n当 $R_{k}\\geq 1$ 时，序列 $P(X=k)$ 增加；当 $R_{k}\\leq 1$ 时，序列 $P(X=k)$ 减少（超几何分布是单峰的）。因此，众数 $m$ 的特征是 $R_{m-1}\\geq 1$ 且 $R_{m}\\leq 1$。求解 $R_{k}\\geq 1$：\n$$\n\\frac{K-k}{k+1}\\cdot \\frac{n-k}{N-K-n+k+1}\\geq 1\n\\;\\;\\Longleftrightarrow\\;\\;\n(K-k)(n-k)\\geq (k+1)(N-K-n+k+1).\n$$\n展开两侧并化简。令 $q = \\frac{(K+1)(n+1)}{N+2}$。经过代数运算，该不等式化简为 $k \\le q - 1$。\n因此，使 $R_k \\ge 1$ 成立的最大整数是 $\\lfloor q - 1 \\rfloor$。这意味着概率 $P(X=k)$ 递增直到 $k = \\lfloor q - 1 \\rfloor + 1 = \\lfloor q \\rfloor$，然后开始递减。所以，众数是：\n$$\nm=\\left\\lfloor \\frac{(K+1)(n+1)}{N+2}\\right\\rfloor.\n$$\n如果 $\\frac{(K+1)(n+1)}{N+2}$恰好是整数，则存在两个相邻的众数，$m$ 和 $m-1$，它们具有相同的最大概率；上述表达式给出了其中较大的一个。所产生的值位于允许的支撑集内，与边界情况一致。", "answer": "$$\\boxed{\\left\\lfloor \\frac{(n+1)(K+1)}{N+2}\\right\\rfloor}$$", "id": "1921890"}, {"introduction": "在许多科学和工业应用中，我们面临的挑战恰恰相反：我们不知道总体的确切构成，但可以通过样本来推断。这个终极练习将问题反转，向你展示如何利用样本数据来估计总体的未知参数，这正是统计推断中最大似然估计（Maximum Likelihood Estimation）思想的体现。通过这个古生物学案例，你将学会如何从部分信息中做出关于整体的最优猜测。[@problem_id:1307555]", "problem": "一队古生物学家发现了一个新的化石层，其中包含总共40块保存完好、各不相同的化石。该团队怀疑其中一些化石来自侏罗纪时期。为了进行初步评估，他们从这批化石中随机抽取了6块作为样本进行详细分析。在这个样本中，他们鉴定出恰好有2块化石来自侏罗纪时期。假设最初的抽样是无放回抽样，那么在全部40块化石中，侏罗纪化石的总数最有可能为多少？答案必须是一个整数。", "solution": "设总体大小为 $N=40$，样本大小为 $n=6$，未知的侏罗纪化石总数为 $K$，样本中观测到的侏罗纪化石数量为 $x=2$。在无放回抽样的情况下，$X$ 服从超几何分布：\n$$\n\\Pr(X=x \\mid K)=\\frac{\\binom{K}{x}\\binom{N-K}{n-x}}{\\binom{N}{n}}.\n$$\n我们希望找到使该概率（作为 $K$ 的函数，即似然函数）最大化的 $K$ 值。由于分母 $\\binom{N}{n}$ 不依赖于 $K$，最大化似然函数等价于最大化分子：\n$$\nL(K)=\\binom{K}{2}\\binom{40-K}{4}\n$$\n在所有使二项式系数有定义的整数 $K$（即 $2 \\le K \\le 36$）上。\n\n为了找到最大值，我们考察连续似然值的比值 $r(K)=\\frac{L(K+1)}{L(K)}$，并找出 $r(K) \\ge 1$ 的 $K$ 值。\n$$\nr(K)=\\frac{\\binom{K+1}{2}\\binom{39-K}{4}}{\\binom{K}{2}\\binom{40-K}{4}}.\n$$\n使用恒等式 $\\binom{a+1}{b}/\\binom{a}{b} = \\frac{a+1}{a-b+1}$，我们得到：\n$$\n\\frac{\\binom{K+1}{2}}{\\binom{K}{2}}=\\frac{K+1}{K-1} \\quad \\text{和} \\quad \\frac{\\binom{39-K}{4}}{\\binom{40-K}{4}}=\\frac{36-K}{40-K}.\n$$\n因此\n$$\nr(K)=\\frac{(K+1)(36-K)}{(K-1)(40-K)}.\n$$\n我们需要找到使 $r(K) \\ge 1$ 的最大整数 $K$。\n$$\n(K+1)(36-K)\\ge (K-1)(40-K)\n$$\n展开两边：\n$$\n-K^{2}+35K+36 \\ge -K^{2}+41K-40\n$$\n化简不等式：\n$$\n76 \\ge 6K \\;\\;\\Longleftrightarrow\\;\\; K \\le \\frac{76}{6} = \\frac{38}{3} \\approx 12.67.\n$$\n因此，对于整数 $K$，当 $K \\le 12$ 时，$r(K) > 1$，似然函数 $L(K)$ 增加。当 $K \\ge 13$ 时，$r(K)  1$，似然函数 $L(K)$ 减少。这意味着似然函数在 $K=13$ 处达到其最大值。\n因此，该化石收藏中侏罗纪化石最可能的总数是 $13$。", "answer": "$$\\boxed{13}$$", "id": "1307555"}]}