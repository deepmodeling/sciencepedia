{"hands_on_practices": [{"introduction": "我们从一个经典的概率论场景——瓮中抽球——开始我们的实践。这个练习旨在帮助你掌握离散概率背景下条件概率的基本计算 [@problem_id:1906185]。通过分析在已知第一次抽取结果的条件下样本中红球总数的概率分布，你将直观地理解“条件”如何改变了我们对随机事件可能性的评估，这是构建更复杂概率模型的基础。", "problem": "一个瓮中共有 $N$ 个球，其中 $K$ 个是红球，剩下的 $N-K$ 个是黑球。从瓮中不放回地随机抽取 $n$ 个球，其中 $1 \\le n \\le N$ 且 $1 \\le K < N$。设随机变量 $X$ 表示抽取的 $n$ 个球样本中的红球总数。给定事件 $E$（定义为第一次抽出的球是红球），求条件概率 $P(X=k | E)$。将答案表示为 $k, n, N,$ 和 $K$ 的函数。假设 $k$ 是在此条件分布的有效支撑集内的一个整数。", "solution": "设瓮中包含 $K$ 个红球和 $N-K$ 个黑球，并从中不放回地抽取 $n$ 个球。定义 $E$ 为第一次抽出的球是红球的事件。以 $E$ 为条件。\n\n在事件 $E$ 发生的条件下，第一次抽出（红）球后，瓮中还剩下 $N-1$ 个球，其中 $K-1$ 个是红球，$N-K$ 个是黑球。剩下的 $n-1$ 次抽取是从这 $N-1$ 个球中不放回地进行的。设 $Y$ 表示在剩下的 $n-1$ 次抽取中抽到的红球数。那么，在整个样本中红球的总数满足\n$$\nX=1+Y.\n$$\n因此，对于有效支撑集中的任何整数 $k$，有\n$$\nP(X=k \\mid E)=P(Y=k-1).\n$$\n由于 $Y$ 服从超几何分布，其总体大小为 $N-1$，成功项目数为 $K-1$，抽取样本大小为 $n-1$，因此其概率质量函数为\n$$\nP(Y=y)=\\frac{\\binom{K-1}{y}\\binom{N-K}{(n-1)-y}}{\\binom{N-1}{n-1}}.\n$$\n代入 $y=k-1$ 可得\n$$\nP(X=k \\mid E)=\\frac{\\binom{K-1}{k-1}\\binom{N-K}{n-k}}{\\binom{N-1}{n-1}},\n$$\n其中整数 $k$ 满足 $\\max\\{1,\\,n-(N-K)\\}\\leq k \\leq \\min\\{n,\\,K\\}$。", "answer": "$$\\boxed{\\frac{\\binom{K-1}{k-1}\\binom{N-K}{n-k}}{\\binom{N-1}{n-1}}}$$", "id": "1906185"}, {"introduction": "接下来，我们将从离散世界过渡到连续世界。这个练习探讨了定义在二维连续空间上的条件期望 [@problem_id:1906194]。通过研究一个从平行四边形区域内均匀选取的点，你将学习如何计算一个变量 $Y$ 的期望值，而这个期望值依赖于另一个变量 $X$ 的具体取值。此问题强调了条件作用的几何直觉，即对联合概率密度函数进行“切片”分析。", "problem": "一个点 $(X, Y)$ 从 $xy$-平面上的区域 $\\mathcal{R}$ 内的一个均匀分布中随机选取。区域 $\\mathcal{R}$ 是一个顶点坐标为 $(0,0)$、$(2,0)$、$(3,1)$ 和 $(1,1)$ 的平行四边形。求在 $X=x$ 的条件下 $Y$ 的条件期望，记为 $E[Y|X=x]$。答案应为一个关于 $x$ 的表达式，并且对所有条件期望有定义的 $x$ 值均有效。", "solution": "该区域是顶点为 $(0,0)$、$(2,0)$、$(3,1)$ 和 $(1,1)$ 的平行四边形。其边位于直线 $y=0$、$y=1$、$y=x$ 和 $y=x-2$ 上。这个平行四边形的面积是由张成向量 $(2,0)$ 和 $(1,1)$ 构成的行列式的绝对值，即 $|2\\cdot 1-0\\cdot 1|=2$。因此，联合密度在 $\\mathcal{R}$ 上为常数且等于 $f_{X,Y}(x,y)=\\frac{1}{2}$，在其他地方为零。\n\n对于一个固定的 $x$，穿过 $\\mathcal{R}$ 的垂直切片给出了 $y$ 的区间：\n- 对于 $0 \\leq x \\leq 1$，$y$ 的范围是从 $a(x)=0$ 到 $b(x)=x$。\n- 对于 $1 \\leq x \\leq 2$，$y$ 的范围是从 $a(x)=0$ 到 $b(x)=1$。\n- 对于 $2 \\leq x \\leq 3$，$y$ 的范围是从 $a(x)=x-2$ 到 $b(x)=1$。\n\n对于任何具有非空切片的 $x$，其边缘密度为\n$$\nf_{X}(x)=\\int f_{X,Y}(x,y)\\,dy=\\frac{1}{2}\\bigl(b(x)-a(x)\\bigr),\n$$\n且条件期望为\n$$\nE[Y\\mid X=x]=\\frac{1}{f_{X}(x)}\\int y\\,f_{X,Y}(x,y)\\,dy\n=\\frac{1}{\\frac{1}{2}(b-a)}\\cdot\\frac{1}{2}\\int_{a}^{b}y\\,dy\n=\\frac{1}{b-a}\\cdot\\frac{1}{2}\\bigl(b^{2}-a^{2}\\bigr)\n=\\frac{a(x)+b(x)}{2},\n$$\n即切片的中点。\n\n将每个 $x$ 范围的边界代入：\n- 对于 $0 \\leq x \\leq 1$，$E[Y\\mid X=x]=\\frac{0+x}{2}=\\frac{x}{2}$。\n- 对于 $1 \\leq x \\leq 2$，$E[Y\\mid X=x]=\\frac{0+1}{2}=\\frac{1}{2}$。\n- 对于 $2 \\leq x \\leq 3$，$E[Y\\mid X=x]=\\frac{(x-2)+1}{2}=\\frac{x-1}{2}$。\n\n这些公式在边界点 $x=0,1,2,3$ 处也成立。在 $[0,3]$ 之外，条件期望是未定义的，因为 $f_{X}(x)=0$。", "answer": "$$\\boxed{\\begin{cases}\\frac{x}{2}, & 0 \\leq x \\leq 1,\\\\[4pt]\\frac{1}{2}, & 1 \\leq x \\leq 2,\\\\[4pt]\\frac{x-1}{2}, & 2 \\leq x \\leq 3.\\end{cases}}$$", "id": "1906194"}, {"introduction": "最后，我们将条件分布的概念应用于一个涉及正态分布的强大且普遍的场景。这个问题模拟了信号处理中的一个常见情景：原始信号被噪声干扰，而我们只能观测到它们的总和 [@problem_id:1906118]。通过推导在给定观测总和的条件下原始信号的分布，你将发现关于高斯分布的一个核心结论，并体会到条件作用如何被用来从含噪数据中“滤出”或估计未知量。", "problem": "在一个简化的通信系统模型中，原始信号 $X$ 受到加性噪声 $Y$ 的干扰。假设信号 $X$ 和噪声 $Y$ 都可以建模为独立同分布的随机变量，且均服从标准正态分布。标准正态分布是指均值为 0、方差为 1 的正态分布。\n\n接收端的观察者无法单独观测到原始信号 $X$ 或噪声 $Y$。他们只能观测到接收到的总信号，即两者的和 $S = X+Y$。为了估计原始信号，理解在给定特定观测值的条件下 $X$ 的统计特性至关重要。\n\n假设接收端测量到的总信号为 $S=s$，其中 $s$ 是一个实数常量。请确定在此测量条件下原始信号 $X$ 的条件概率分布。以下哪项正确描述了该条件分布？\n\nA. 均值为 $s$，方差为 $1$ 的正态分布。\n\nB. 均值为 $\\frac{s}{2}$，方差为 $\\frac{1}{2}$ 的正态分布。\n\nC. 均值为 $\\frac{s}{2}$，方差为 $2$ 的正态分布。\n\nD. 在区间 $[s-\\sqrt{3}, s+\\sqrt{3}]$ 上的均匀分布。\n\nE. 均值为 $0$，方差为 $\\frac{1}{2}$ 的正态分布。\n\nF. 自由度为 1 的卡方分布。", "solution": "设 $X$ 和 $Y$ 相互独立，且 $X \\sim \\mathcal{N}(0,1)$，$Y \\sim \\mathcal{N}(0,1)$。定义 $S=X+Y$。由于 $(X,Y)$ 服从联合正态分布，且 $S$ 是 $(X,Y)$ 的线性函数，因此 $(X,S)$ 也服从联合正态分布。\n\n计算一阶矩和二阶矩：\n- $\\mathbb{E}[X]=0$，$\\mathbb{E}[S]=\\mathbb{E}[X+Y]=0$。\n- $\\operatorname{Var}(X)=1$，$\\operatorname{Var}(S)=\\operatorname{Var}(X)+\\operatorname{Var}(Y)=2$（根据独立性）。\n- $\\operatorname{Cov}(X,S)=\\operatorname{Cov}(X,X+Y)=\\operatorname{Var}(X)+\\operatorname{Cov}(X,Y)=1+0=1$（根据独立性）。\n\n对于联合正态变量，条件分布 $X \\mid S=s$ 是正态分布，其均值为\n$$\n\\mathbb{E}[X \\mid S=s]=\\mathbb{E}[X]+\\frac{\\operatorname{Cov}(X,S)}{\\operatorname{Var}(S)}\\left(s-\\mathbb{E}[S]\\right)=0+\\frac{1}{2}s=\\frac{s}{2},\n$$\n且方差为\n$$\n\\operatorname{Var}(X \\mid S)=\\operatorname{Var}(X)-\\frac{\\operatorname{Cov}(X,S)^{2}}{\\operatorname{Var}(S)}=1-\\frac{1^{2}}{2}=\\frac{1}{2}.\n$$\n\n因此，$X \\mid S=s \\sim \\mathcal{N}\\!\\left(\\frac{s}{2},\\frac{1}{2}\\right)$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1906118"}]}