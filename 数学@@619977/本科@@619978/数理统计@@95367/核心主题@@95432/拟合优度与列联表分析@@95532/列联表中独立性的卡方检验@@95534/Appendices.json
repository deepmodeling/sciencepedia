{"hands_on_practices": [{"introduction": "第一个练习为应用卡方检验提供了基础实践。通过分析关于学生学习偏好的假设性调查数据，你将逐步完成从列联表中计算 $\\chi^2$ 统计量的基本步骤。掌握这一基本流程是检验两个分类变量之间独立性的关键第一步。[@problem_id:1904614]", "problem": "一所大学的校务研究办公室正在调查学生的年级与他们偏好的学习方式之间是否存在关联。一项针对1100名本科生的随机抽样调查的结果汇总在下方的列联表中。行代表学生的年级（大一、大二、大三、大四），列代表他们偏好的学习方式（完全线下授课、混合式、完全线上授课）。\n\n观测频数如下：\n- **大一**：完全线下授课155人，混合式85人，完全线上授课30人。\n- **大二**：完全线下授课120人，混合式110人，完全线上授课50人。\n- **大三**：完全线下授课90人，混合式135人，完全线上授课65人。\n- **大四**：完全线下授课75人，混合式100人，完全线上授课85人。\n\n为了确定这两个分类变量是否独立，将进行卡方（$\\chi^2$）独立性检验。根据这些数据计算卡方检验统计量的值。将您的最终答案四舍五入至四位有效数字。", "solution": "我们使用卡方检验来检验年级（行）和偏好的学习方式（列）之间的独立性。对于一个观测频数为 $O_{ij}$、行合计为 $R_{i}$、列合计为 $C_{j}$、总计为 $N$ 的列联表，在独立性假设下，期望频数为\n$$\nE_{ij}=\\frac{R_{i}C_{j}}{N},\n$$\n卡方统计量为\n$$\n\\chi^{2}=\\sum_{i}\\sum_{j}\\frac{(O_{ij}-E_{ij})^{2}}{E_{ij}}.\n$$\n首先计算行合计、列合计和总计：\n$$\n\\begin{aligned}\n&\\text{行合计: } R_{\\text{F}}=155+85+30=270,\\quad R_{\\text{So}}=120+110+50=280,\\\\\n&R_{\\text{J}}=90+135+65=290,\\quad R_{\\text{Se}}=75+100+85=260.\\\\\n&\\text{列合计: } C_{\\text{IP}}=155+120+90+75=440,\\\\\n&\\hspace{38mm} C_{\\text{H}}=85+110+135+100=430,\\\\\n&\\hspace{38mm} C_{\\text{OL}}=30+50+65+85=230.\\\\\n&\\text{总计: } N=1100.\n\\end{aligned}\n$$\n计算每个单元格的期望频数 $E_{ij}=(R_{i}C_{j})/N$：\n$$\n\\begin{aligned}\n&E_{\\text{F,IP}}=\\frac{270\\cdot 440}{1100}=108,\\quad E_{\\text{F,H}}=\\frac{270\\cdot 430}{1100}=\\frac{1161}{11},\\quad E_{\\text{F,OL}}=\\frac{270\\cdot 230}{1100}=\\frac{621}{11},\\\\\n&E_{\\text{So,IP}}=\\frac{280\\cdot 440}{1100}=112,\\quad E_{\\text{So,H}}=\\frac{280\\cdot 430}{1100}=\\frac{1204}{11},\\quad E_{\\text{So,OL}}=\\frac{280\\cdot 230}{1100}=\\frac{644}{11},\\\\\n&E_{\\text{J,IP}}=\\frac{290\\cdot 440}{1100}=116,\\quad E_{\\text{J,H}}=\\frac{290\\cdot 430}{1100}=\\frac{1247}{11},\\quad E_{\\text{J,OL}}=\\frac{290\\cdot 230}{1100}=\\frac{667}{11},\\\\\n&E_{\\text{Se,IP}}=\\frac{260\\cdot 440}{1100}=104,\\quad E_{\\text{Se,H}}=\\frac{260\\cdot 430}{1100}=\\frac{1118}{11},\\quad E_{\\text{Se,OL}}=\\frac{260\\cdot 230}{1100}=\\frac{598}{11}.\n\\end{aligned}\n$$\n现在计算每一项的贡献值 $(O_{ij}-E_{ij})^{2}/E_{ij}$：\n$$\n\\begin{aligned}\n&\\text{F,IP: } \\frac{(155-108)^{2}}{108}=\\frac{2209}{108},\\quad\n\\text{F,H: } \\frac{\\left(85-\\frac{1161}{11}\\right)^{2}}{\\frac{1161}{11}}=\\frac{51076}{12771},\\quad\n\\text{F,OL: } \\frac{\\left(30-\\frac{621}{11}\\right)^{2}}{\\frac{621}{11}}=\\frac{9409}{759},\\\\\n&\\text{So,IP: } \\frac{(120-112)^{2}}{112}=\\frac{64}{112}=\\frac{4}{7},\\quad\n\\text{So,H: } \\frac{\\left(110-\\frac{1204}{11}\\right)^{2}}{\\frac{1204}{11}}=\\frac{9}{3311},\\quad\n\\text{So,OL: } \\frac{\\left(50-\\frac{644}{11}\\right)^{2}}{\\frac{644}{11}}=\\frac{2209}{1771},\\\\\n&\\text{J,IP: } \\frac{(90-116)^{2}}{116}=\\frac{676}{116}=\\frac{169}{29},\\quad\n\\text{J,H: } \\frac{\\left(135-\\frac{1247}{11}\\right)^{2}}{\\frac{1247}{11}}=\\frac{56644}{13717},\\quad\n\\text{J,OL: } \\frac{\\left(65-\\frac{667}{11}\\right)^{2}}{\\frac{667}{11}}=\\frac{2304}{7337},\\\\\n&\\text{Se,IP: } \\frac{(75-104)^{2}}{104}=\\frac{841}{104},\\quad\n\\text{Se,H: } \\frac{\\left(100-\\frac{1118}{11}\\right)^{2}}{\\frac{1118}{11}}=\\frac{162}{6149},\\quad\n\\text{Se,OL: } \\frac{\\left(85-\\frac{598}{11}\\right)^{2}}{\\frac{598}{11}}=\\frac{113569}{6578}.\n\\end{aligned}\n$$\n将所有贡献值相加，得到卡方统计量：\n$$\n\\chi^{2}=\\frac{2209}{108}+\\frac{51076}{12771}+\\frac{9409}{759}+\\frac{4}{7}+\\frac{9}{3311}+\\frac{2209}{1771}+\\frac{169}{29}+\\frac{56644}{13717}+\\frac{2304}{7337}+\\frac{841}{104}+\\frac{162}{6149}+\\frac{113569}{6578}.\n$$\n对此和进行数值计算可得\n$$\n\\chi^{2}\\approx 74.320079\\ldots\n$$\n四舍五入到四位有效数字，得到 $74.32$。", "answer": "$$\\boxed{74.32}$$", "id": "1904614"}, {"introduction": "在掌握了基础计算之后，本实践将介绍现实世界数据分析中的一个关键环节。通过一个国际象棋分析的场景，你将学习如何检验卡方检验假设的有效性，并在期望频数过低时，应用合并类别的标准修正方法。这项技能对于确保你结论的统计严谨性至关重要。[@problem_id:1904570]", "problem": "一个数据科学家团队正在分析一个包含400局通讯国际象棋比赛的数据集，以研究棋手实力水平与他们在对抗西西里防御时的开局体系选择之间可能存在的关系。棋手的实力根据ELO等级分系统分为四个等级段，该系统是一种计算对抗性比赛中选手相对实力水平的方法。开局选择被分为两大类：“开放式西西里”体系，通常导致激烈、战术性的局面；以及“封闭式西西里”体系，通常产生更具战略性、局面性的对弈。\n\n这400局比赛的观测频率总结在下表中：\n\n| 棋手ELO等级分段 | 开放式西西里 | 封闭式西西里 |\n| :--- | :---: | :---: |\n| 低于 1500 | 60 | 30 |\n| 1500 至 1999 | 120 | 80 |\n| 2000 至 2399 | 75 | 25 |\n| 2400 或更高 | 8 | 2 |\n\n为了评估开局体系的选择是否独立于棋手的ELO等级分段，您的任务是计算相应的卡方（$\\chi^2$）检验统计量。在必要时，合并相邻的类别以确保检验假设的有效性，并使用合并后的表格进行计算。\n\n计算$\\chi^2$统计量的值。将您的最终答案四舍五入到四位有效数字。", "solution": "问题要求我们计算卡方（$\\chi^2$）统计量，以检验两个分类变量之间的独立性：棋手ELO等级分段和开局体系的选择。\n\n首先，我们建立原假设和备择假设。\n$H_0$：开局体系的选择与棋手的ELO等级分段无关。\n$H_a$：开局体系的选择与棋手的ELO等级分段有关。\n\n观测频率$O_{ij}$已在问题描述中给出。我们可以为表格增加行和列的总计。\n\n| ELO分段 | 开放式西西里 | 封闭式西西里 | 行总计 |\n| :--- | :---: | :---: | :---: |\n| < 1500 | 60 | 30 | 90 |\n| 1500-1999 | 120 | 80 | 200 |\n| 2000-2399 | 75 | 25 | 100 |\n|  2400 | 8 | 2 | 10 |\n| **列总计**| **263** | **137** | **400** |\n\n总观测数为$N = 400$。\n\n卡方检验要求我们在原假设为真的前提下，计算每个单元格的期望频率$E_{ij}$。第$i$行和第$j$列单元格的期望频率计算公式为：\n$$E_{ij} = \\frac{(\\text{行总计}_i) \\times (\\text{列总计}_j)}{N}$$\n\n我们来计算原始4x2表格的期望频率：\n$E_{11} = \\frac{90 \\times 263}{400} = 59.175$\n$E_{12} = \\frac{90 \\times 137}{400} = 30.825$\n$E_{21} = \\frac{200 \\times 263}{400} = 131.5$\n$E_{22} = \\frac{200 \\times 137}{400} = 68.5$\n$E_{31} = \\frac{100 \\times 263}{400} = 65.75$\n$E_{32} = \\frac{100 \\times 137}{400} = 34.25$\n$E_{41} = \\frac{10 \\times 263}{400} = 6.575$\n$E_{42} = \\frac{10 \\times 137}{400} = 3.425$\n\n卡方检验有效性的一个通用经验法则是，所有期望频率都应至少为5。我们观察到$E_{42} = 3.425$，小于5。为了解决这个问题，我们必须合并类别。最合乎逻辑的方法是将最小的类别（“$\\ge$ 2400”）与相邻的类别（“2000-2399”）合并，形成一个新的类别：“$\\ge$ 2000”。\n\n我们现在通过将它们的观测频率相加，构建一个包含合并类别的新列联表。\n\n合并后新的观测频率表：\n| ELO分段 | 开放式西西里 | 封闭式西西里 | 行总计 |\n|---|---|---|---|\n|  1500 | 60 | 30 | 90 |\n| 1500-1999 | 120 | 80 | 200 |\n|  2000 | 75+8 = 83 | 25+2 = 27 | 100+10 = 110 |\n| **列总计** | **263** | **137** | **400** |\n\n现在，我们为这个新的3x2表格重新计算期望频率。我们将其记为$E'_{ij}$。\n$E'_{11} = \\frac{90 \\times 263}{400} = 59.175$\n$E'_{12} = \\frac{90 \\times 137}{400} = 30.825$\n$E'_{21} = \\frac{200 \\times 263}{400} = 131.5$\n$E'_{22} = \\frac{200 \\times 137}{400} = 68.5$\n$E'_{31} = \\frac{110 \\times 263}{400} = 72.325$\n$E'_{32} = \\frac{110 \\times 137}{400} = 37.675$\n\n所有新的期望频率都大于5，因此现在可以进行卡方检验。卡方统计量使用以下公式计算：\n$$\\chi^2 = \\sum_{i,j} \\frac{(O_{ij} - E'_{ij})^2}{E'_{ij}}$$\n我们计算合并后的3x2表格中每个单元格的贡献值：\n- 单元格 (1,1): $\\frac{(60 - 59.175)^2}{59.175} = \\frac{0.825^2}{59.175} = \\frac{0.680625}{59.175} \\approx 0.0115019$\n- 单元格 (1,2): $\\frac{(30 - 30.825)^2}{30.825} = \\frac{(-0.825)^2}{30.825} = \\frac{0.680625}{30.825} \\approx 0.0220803$\n- 单元格 (2,1): $\\frac{(120 - 131.5)^2}{131.5} = \\frac{(-11.5)^2}{131.5} = \\frac{132.25}{131.5} \\approx 1.0057034$\n- 单元格 (2,2): $\\frac{(80 - 68.5)^2}{68.5} = \\frac{11.5^2}{68.5} = \\frac{132.25}{68.5} \\approx 1.9306569$\n- 单元格 (3,1): $\\frac{(83 - 72.325)^2}{72.325} = \\frac{10.675^2}{72.325} = \\frac{113.955625}{72.325} \\approx 1.5756323$\n- 单元格 (3,2): $\\frac{(27 - 37.675)^2}{37.675} = \\frac{(-10.675)^2}{37.675} = \\frac{113.955625}{37.675} \\approx 3.0247012$\n\n将这些值相加，得到卡方统计量：\n$\\chi^2 \\approx 0.0115019 + 0.0220803 + 1.0057034 + 1.9306569 + 1.5756323 + 3.0247012$\n$\\chi^2 \\approx 7.570276$\n\n将结果四舍五入到四位有效数字，我们得到7.570。", "answer": "$$\\boxed{7.570}$$", "id": "1904570"}, {"introduction": "当一个大型列联表的卡方检验显示出显著关联时，接下来的问题往往是“这种关联源于何处？”。这个高级问题探讨了分解技术，即通过折叠列联表进行更具针对性的分析。通过处理一个假设性材料科学实验的数据，你将学习如何分离和检验数据中的特定关系，从而从一个笼统的发现走向更具体的洞察。[@problem_id:1904581]", "problem": "一个材料科学研究团队正在研究一种新型聚合物复合材料在不同热负荷下的失效特性。在他们的实验中，样品被置于四个离散的温度范围（低、中、高、极端）之一，直到发生失效。失效的类型被分为三类之一：脆性断裂（Fracture）、层间分层（Delamination）或粘弹性变形（Deformation）。\n\n从大量测试中观察到的每种温度和失效模式组合的频率总结在下面的 $3 \\times 4$ 列联表中：\n\n| 失效模式 | 低温 | 中温 | 高温 | 极端温度 |\n|:--------------|:---------:|:------------:|:----------:|:-------------:|\n| 断裂      | 50        | 40           | 20         | 10            |\n| 分层  | 20        | 30           | 45         | 55            |\n| 变形   | 10        | 15           | 35         | 40            |\n\n对完整的 $3 \\times 4$ 表格的初步分析已经证实，温度范围和失效模式之间存在统计上显著的关联。为了查明这种关联的来源，研究负责人提出了一项特定的后续分析。他们有兴趣检验一个原假设，即温度与“断裂”模式对“非断裂”模式（其中“非断裂”是“分层”和“变形”的组合类别）的发生之间没有关联。\n\n针对这项特定的分区分析，计算 Pearson 卡方统计量的值。该分析比较了在四个温度范围内，“断裂”类别与合并的“非断裂”类别。将您的最终答案表示为一个无量纲值，四舍五入到四位有效数字。", "solution": "为了检验温度与“断裂”对“非断裂”模式的发生是否存在关联，我们首先将原始的 $3 \\times 4$ 表格折叠成一个 $2 \\times 4$ 表格。\n\n**1. 创建分区列联表**\n我们将“分层”和“变形”的频数合并为“非断裂”类别。新的观测频数 ($O_{ij}$) 表如下：\n| 失效模式 | 低温 | 中温 | 高温 | 极端温度 | 行总计 |\n|:---|:---:|:---:|:---:|:---:|:---:|\n| 断裂 | 50 | 40 | 20 | 10 | **120** |\n| 非断裂 | 30 | 45 | 80 | 95 | **250** |\n| **列总计** | **80** | **85** | **100** | **105** | **370** |\n总样本量 $N=370$。\n\n**2. 计算卡方统计量**\n在独立性假设下，期望频数 $E_{ij} = (\\text{行总计}_i \\times \\text{列总计}_j) / N$。卡方统计量为 $\\chi^2 = \\sum \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}$。我们逐列计算对总 $\\chi^2$ 值的贡献。\n\n*   **低温 (列总计=80):**\n    *   $E_{\\text{断裂}} = (120 \\times 80) / 370 = 960/37$\n    *   $E_{\\text{非断裂}} = (250 \\times 80) / 370 = 2000/37$\n    *   贡献 = $\\frac{(50 - 960/37)^2}{960/37} + \\frac{(30 - 2000/37)^2}{2000/37} = \\frac{7921}{240}$\n\n*   **中温 (列总计=85):**\n    *   $E_{\\text{断裂}} = (120 \\times 85) / 370 = 1020/37$\n    *   $E_{\\text{非断裂}} = (250 \\times 85) / 370 = 2125/37$\n    *   贡献 = $\\frac{(40 - 1020/37)^2}{1020/37} + \\frac{(45 - 2125/37)^2}{2125/37} = \\frac{2116}{255}$\n\n*   **高温 (列总计=100):**\n    *   $E_{\\text{断裂}} = (120 \\times 100) / 370 = 1200/37$\n    *   $E_{\\text{非断裂}} = (250 \\times 100) / 370 = 2500/37$\n    *   贡献 = $\\frac{(20 - 1200/37)^2}{1200/37} + \\frac{(80 - 2500/37)^2}{2500/37} = \\frac{529}{75}$\n\n*   **极端温度 (列总计=105):**\n    *   $E_{\\text{断裂}} = (120 \\times 105) / 370 = 1260/37$\n    *   $E_{\\text{非断裂}} = (250 \\times 105) / 370 = 2625/37$\n    *   贡献 = $\\frac{(10 - 1260/37)^2}{1260/37} + \\frac{(95 - 2625/37)^2}{2625/37} = \\frac{7921}{315}$\n\n**3. 汇总并得出结论**\n将各列的贡献值相加：\n$$ \\chi^2 = \\frac{7921}{240} + \\frac{2116}{255} + \\frac{529}{75} + \\frac{7921}{315} $$\n$$ \\chi^2 \\approx 33.0042 + 8.2980 + 7.0533 + 25.1460 \\approx 73.5015 $$\n四舍五入到四位有效数字，Pearson卡方统计量的值为 $73.50$。", "answer": "$$\\boxed{73.50}$$", "id": "1904581"}]}