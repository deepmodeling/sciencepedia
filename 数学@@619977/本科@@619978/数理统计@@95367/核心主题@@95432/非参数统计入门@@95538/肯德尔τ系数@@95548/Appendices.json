{"hands_on_practices": [{"introduction": "本练习模拟了一个常见的数据科学任务：评估一个机器学习模型的排序性能。你将从两组原始排名数据出发，完整地计算出肯德尔(Kendall)的$\\tau$系数。这个过程不仅能让你熟练掌握$\\tau$系数的基本计算，还能通过计算“逆序数”来加深对一致对与不一致对概念的理解。[@problem_id:1927383]", "problem": "一家大型电子商务公司的数据科学团队开发了一种新的机器学习模型，用于根据预测的用户参与度对产品进行排名。为了评估该模型的性能，他们将其输出与一组人类专家创建的“黄金标准”排名进行比较。对于一个包含 $n=10$ 个不同产品的样本，获得了两种排名。这些产品的ID被标记为1到10。下表显示了人类专家（排名 H）和新算法（排名 A）为每个产品分配的排名。排名1为最高排名。\n\n| 产品ID | 专家排名 ($X$) | 算法排名 ($Y$) |\n|------------|--------------|--------------|\n| 1          | 1            | 3            |\n| 2          | 2            | 1            |\n| 3          | 3            | 5            |\n| 4          | 4            | 2            |\n| 5          | 5            | 8            |\n| 6          | 6            | 6            |\n| 7          | 7            | 9            |\n| 8          | 8            | 4            |\n| 9          | 9            | 10           |\n| 10         | 10           | 7            |\n\n该团队决定使用肯德尔等级相关系数 $\\tau$ 来衡量两种排名之间的一致性。对于一组 $n$ 个没有平级的配对观测值 $(x_1, y_1), (x_2, y_2), \\dots, (x_n, y_n)$，一对配对 $((x_i, y_i), (x_j, y_j))$ 定义为：\n- **一致的**：如果排名具有相同的相对顺序，即 $(x_i - x_j)(y_i - y_j) > 0$。\n- **不一致的**：如果排名具有相反的相对顺序，即 $(x_i - x_j)(y_i - y_j) < 0$。\n\n令 $N_c$ 为一致配对的总数，$N_d$ 为不一致配对的总数。肯德尔tau系数则定义为：\n$$\n\\tau = \\frac{N_c - N_d}{N_c + N_d}\n$$\n不同的配对对总数为 $\\binom{n}{2} = N_c + N_d$。\n\n计算给定数据的肯德尔tau系数 $\\tau$ 的值。将您的答案表示为保留三位有效数字的小数。", "solution": "我们有无平级的排名，因此对于 $n=10$ 个项目，不同配对的总数为\n$$\n\\binom{n}{2}=\\binom{10}{2}=45,\n$$\n并且 $N_c+N_d=45$。\n\n按 $X$（专家排名）对项目排序，其排名为$1,2,\\dots,10$。在此顺序下，对应的 $Y$（算法排名）序列是\n$$\n(3,\\,1,\\,5,\\,2,\\,8,\\,6,\\,9,\\,4,\\,10,\\,7).\n$$\n在没有平级的情况下，对于 $i<j$ 的一对 $(i,j)$，当且仅当 $Y_{i}>Y_{j}$ 时，它是不一致的。因此，$N_d$ 等于这个 $Y$ 序列中逆序对的数量。通过对每个位置，将其后更小的条目数量相加来计数逆序对：\n- 对于 $3$：其后更小的数是 $1,2$ $\\Rightarrow 2$。\n- 对于 $1$：没有 $\\Rightarrow 0$。\n- 对于 $5$：其后更小的数是 $2,4$ $\\Rightarrow 2$。\n- 对于 $2$：没有 $\\Rightarrow 0$。\n- 对于 $8$：其后更小的数是 $6,4,7$ $\\Rightarrow 3$。\n- 对于 $6$：其后更小的数是 $4$ $\\Rightarrow 1$。\n- 对于 $9$：其后更小的数是 $4,7$ $\\Rightarrow 2$。\n- 对于 $4$：没有 $\\Rightarrow 0$。\n- 对于 $10$：其后更小的数是 $7$ $\\Rightarrow 1$。\n- 对于 $7$：没有 $\\Rightarrow 0$。\n\n因此，\n$$\nN_d=2+0+2+0+3+1+2+0+1+0=11,\n$$\n因此\n$$\nN_c=45-11=34.\n$$\n肯德尔tau系数为\n$$\n\\tau=\\frac{N_c-N_d}{N_c+N_d}=\\frac{34-11}{45}=\\frac{23}{45}.\n$$\n作为保留三位有效数字的小数，\n$$\n\\tau=\\frac{23}{45}\\approx 0.511111\\ldots \\approx 0.511.\n$$", "answer": "$$\\boxed{0.511}$$", "id": "1927383"}, {"introduction": "这项练习将引导你从单纯的计算转向概念性的问题解决。你需要找出一个未知的排名值，使得整个数据集的一致对数量与不一致对数量完全相等，即肯德尔$\\tau$系数为零。通过这个过程，你将对“无相关性”在排序数据中的实际含义获得更深刻的直观理解。[@problem_id:1927372]", "problem": "两名学生，Jane和Tom，被要求对四门大学课程（微积分、物理、化学、生物）从1（最简单）到4（最难）进行排名。Jane对微积分、物理、化学和生物的排名分别为1、2、3和4。Tom对相同课程的排名分别为2、4、1和一个未知整数$k$。我们可以将这些排名表示为一组四个成对观测值$(x_i, y_i)$，其中$x_i$是Jane对第$i$门课程的排名，$y_i$是Tom的排名。数据集为：$(1, 2)$、$(2, 4)$、$(3, 1)$、$(4, k)$。\n\n对于一对观测值$((x_i, y_i), (x_j, y_j))$，如果学生对课程的相对排名顺序相同，即$(x_i - x_j)(y_i - y_j) > 0$，则认为该对是**一致的**。如果他们的相对排名顺序相反，即$(x_i - x_j)(y_i - y_j) < 0$，则认为该对是**不一致的**。\n\n假设Tom的排名$k$是一个整数，且Tom的所有排名都不同，这意味着$k$不等于1、2或4。求出$k$的值，使得数据集中一致对的总数与不一致对的总数完全相等。", "solution": "我们将这四个成对观测值按Jane的排名（$x$递增）排序，那么按此顺序，Tom的排名序列为$(y_{1},y_{2},y_{3},y_{4})=(2,4,1,k)$。对于每一对索引为$i<j$的观测值，由于$(x_{i}-x_{j})<0$，而一致性要求$(x_{i}-x_{j})(y_{i}-y_{j})>0$，这等价于$y_{i}-y_{j}<0$。因此，如果$y_{i}<y_{j}$，这对是一致的；如果$y_{i}>y_{j}$，这对是不一致的。\n\n总共有$\\binom{4}{2}=6$对观测值。设$C$表示一致对的数量，$D$表示不一致对的数量。在没有平局的情况下，$C+D=6$。“一致对等于不一致对”的条件意味着$C=D$，因此\n$$\nC=D=\\frac{6}{2}=3.\n$$\n\n我们来明确地计算$C$。首先考虑不涉及$k$的三对：\n- 对(1,2)：比较$2$和$4$，我们有$2<4$（一致）。\n- 对(1,3)：比较$2$和$1$，我们有$2>1$（不一致）。\n- 对(2,3)：比较$4$和$1$，我们有$4>1$（不一致）。\n\n因此，在这三对中，恰好有$1$个一致对。\n\n接下来，考虑涉及$k$的三对：\n- 对(1,4)：比较$2$和$k$，当且仅当$k>2$时为一致。\n- 对(2,4)：比较$4$和$k$，当且仅当$k>4$时为一致。\n- 对(3,4)：比较$1$和$k$，当且仅当$k>1$时为一致。\n\n因此，\n$$\nC=1+\\mathbf{1}_{\\{k>2\\}}+\\mathbf{1}_{\\{k>4\\}}+\\mathbf{1}_{\\{k>1\\}},\n$$\n其中$\\mathbf{1}_{\\{\\cdot\\}}$是条件的指示函数。要求$C=3$可得\n$$\n\\mathbf{1}_{\\{k>2\\}}+\\mathbf{1}_{\\{k>4\\}}+\\mathbf{1}_{\\{k>1\\}}=2.\n$$\n现在我们根据整数$k$的取值范围进行分析（由于排名必须不同，故$k\\neq 1,2,4$）：\n- 如果$k>4$，那么所有三个指示函数都等于$1$，总和为$3$（太大）。\n- 如果$2<k<4$，那么指示函数分别为$1,0,1$，总和为$2$。这个区间内唯一的整数是$k=3$。\n- 如果$1<k<2$，那么指示函数分别为$0,0,1$，总和为$1$（太小），但这个区间内没有整数。\n- 如果$k<1$，那么所有三个指示函数都为$0$，总和为$0$（太小）。\n\n因此，满足排名互不相同的唯一整数解是$k=3$。这也符合从1到4的排名尺度且所有排名互不相同的要求。\n\n所以，使得一致对数量和不一致对数量相等的$k$值为$k=3$。", "answer": "$$\\boxed{3}$$", "id": "1927372"}, {"introduction": "最后的这项练习是一个“逆向工程”挑战，它要求你构建一个能产生特定相关系数值的排名。这个任务将全面检验你对肯德尔$\\tau$系数的理解，特别是让你体会一个排列（即排名）的内部结构是如何直接决定最终的统计值的。通过解决这个问题，你将加深对组合学原理与统计测量之间内在联系的认识。[@problem_id:1927363]", "problem": "两个相互竞争的网络搜索引擎 AlphaSearch 和 BetaSearch，根据它们对某一特定查询的前四个最相关文档（D1, D2, D3, D4）的排名进行评估。AlphaSearch 返回的排名为 D1 第1，D2 第2，D3 第3，D4 第4。这可以用排名向量 $R_A = (1, 2, 3, 4)$ 来表示，其中第 $i$ 个元素是文档 D$i$ 的排名。\n\n两个排名之间的关系可以使用肯德尔 tau 相关系数 $\\tau$ 来量化。其定义为：\n$$\n\\tau = \\frac{N_c - N_d}{N_c + N_d}\n$$\n其中 $N_c$ 是一致对的数量，$N_d$ 是不一致对的数量。如果一对文档 (D$i$, D$j$) 在两个排名中的相对顺序相同，则认为它们是**一致的**。如果它们的相对顺序相反，则该对是**不一致的**。文档的不同配对总数为 $N_c + N_d$。\n\n为 BetaSearch 构建一个可能的排名向量 $R_B$，使得 $R_A$ 和 $R_B$ 之间的肯德尔 tau 系数恰好为 $\\tau = -1/3$。你的答案应该是排名向量 $R_B$，它是数字 $(1, 2, 3, 4)$ 的一个排列。将此向量表示为行矩阵。", "solution": "我们已知 $R_{A} = (1, 2, 3, 4)$，需要找到 $(1, 2, 3, 4)$ 的一个排列 $R_{B}$，使得 $R_{A}$ 和 $R_{B}$ 之间的肯德尔 tau 系数等于 $\\tau = -\\frac{1}{3}$。肯德尔 tau 的定义为\n$$\n\\tau = \\frac{N_{c} - N_{d}}{N_{c} + N_{d}},\n$$\n其中 $N_{c}$ 是一致对的数量，$N_{d}$ 是不一致对的数量。对于 $4$ 个文档，不同配对的总数为\n$$\nN_{c} + N_{d} = \\binom{4}{2} = 6.\n$$\n代入 $\\tau = -\\frac{1}{3}$ 得\n$$\n\\frac{N_{c} - N_{d}}{6} = -\\frac{1}{3} \\quad \\Longrightarrow \\quad N_{c} - N_{d} = -2.\n$$\n求解方程组\n$$\n\\begin{cases}\nN_{c} + N_{d} = 6,\\\\\nN_{c} - N_{d} = -2,\n\\end{cases}\n$$\n解得\n$$\nN_{c} = 2, \\quad N_{d} = 4.\n$$\n由于 $R_{A}$ 是按文档索引的自然顺序（即 $D1 \\prec D2 \\prec D3 \\prec D4$），对于一个满足 $i<j$ 的文档对 $(i,j)$，如果 $R_{B,i} < R_{B,j}$ 则它是一致对，如果 $R_{B,i} > R_{B,j}$ 则是逆序对。因此，我们需要一个具有恰好 $4$ 个逆序的排列 $R_{B}$，这等价于不一致对的数量 $N_d=4$。\n\n考虑排列\n$$\nR_{B} = (3, 4, 1, 2).\n$$\n检查所有满足 $i<j$ 的配对 $(i,j)$：\n- $(1,2)$: $3 < 4$ 是一致对。\n- $(1,3)$: $3 > 1$ 是不一致对。\n- $(1,4)$: $3 > 2$ 是不一致对。\n- $(2,3)$: $4 > 1$ 是不一致对。\n- $(2,4)$: $4 > 2$ 是不一致对。\n- $(3,4)$: $1 < 2$ 是一致对。\n\n因此 $N_{c} = 2$ 且 $N_{d} = 4$，得到\n$$\n\\tau = \\frac{2 - 4}{6} = -\\frac{1}{3},\n$$\n符合要求。因此，一个有效的选择是行矩阵 $\\begin{pmatrix} 3 & 4 & 1 & 2 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 4 & 1 & 2 \\end{pmatrix}}$$", "id": "1927363"}]}