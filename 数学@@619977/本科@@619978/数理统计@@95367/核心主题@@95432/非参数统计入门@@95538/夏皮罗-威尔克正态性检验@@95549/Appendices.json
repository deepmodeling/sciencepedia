{"hands_on_practices": [{"introduction": "为了真正掌握夏皮罗-威尔克检验，我们首先需要动手计算其核心统计量。这个练习将带你一步步计算 $W$ 统计量，让你直观地理解它是如何通过加权计算来衡量数据与正态分布的拟合程度。通过处理一个特意设计的非正态数据集，你将能更深刻地体会到 $W$ 值如何反映数据对正态性的偏离。[@problem_id:1954943]", "problem": "在新一代微机电系统（MEMS）的质量控制中，一位材料科学家测量了一小批六个原型谐振器的谐振频率。其目标是评估这些频率是否服从正态分布，这是后续统计过程控制方法的关键假设。测得的频率（单位为千赫兹，kHz）如下：\n$$ \\{11.2, 13.2, 11.2, 13.2, 11.2, 13.2\\} $$\n该科学家决定使用夏皮罗-威尔克正态性检验。夏皮罗-威尔克统计量 $W$ 使用以下公式计算：\n$$ W = \\frac{b^2}{S^2} $$\n其中 $S^2$ 是与样本均值的偏差平方和，由 $S^2 = \\sum_{j=1}^{n} (x_j - \\bar{x})^2$ 给出。项 $b$ 是对称顺序统计量之间差值的加权和，计算公式为 $b = \\sum_{i=1}^{k} a_i (x_{(n-i+1)} - x_{(i)})$，其中 $x_{(j)}$ 是样本中第 $j$ 小的值。对于样本量 $n=6$，整数 $k$ 为 $3$，所需的系数 $a_i$ 如下：\n$a_1 = 0.6431$\n$a_2 = 0.2806$\n$a_3 = 0.0875$\n\n计算此数据集的夏皮罗-威尔克统计量 $W$ 的值。统计量 $W$ 是一个无量纲量。将最终答案四舍五入到四位有效数字。", "solution": "该问题要求我们为一个包含六个测量值的给定数据集计算夏皮罗-威尔克统计量 $W$。该数据集为 $X = \\{11.2, 13.2, 11.2, 13.2, 11.2, 13.2\\}$。\n\n步骤 1：确定样本量并计算样本均值。\n样本量为 $n=6$。\n样本均值 $\\bar{x}$ 是所有观测值的总和除以样本量。\n$$ \\bar{x} = \\frac{11.2 + 13.2 + 11.2 + 13.2 + 11.2 + 13.2}{6} = \\frac{3 \\times 11.2 + 3 \\times 13.2}{6} = \\frac{33.6 + 39.6}{6} = \\frac{73.2}{6} = 12.2 $$\n样本均值为 $\\bar{x} = 12.2$ kHz。\n\n步骤 2：计算偏差平方和 $S^2$。\n$S^2$ 是 $W$ 统计量的分母。\n每个数据点与均值的偏差 $(x_j - \\bar{x})$ 为：\n对于三个值为 11.2 的数据点：$11.2 - 12.2 = -1.0$\n对于三个值为 13.2 的数据点：$13.2 - 12.2 = 1.0$\n现在，我们将这些偏差的平方相加：\n$$ S^2 = \\sum_{j=1}^{6} (x_j - \\bar{x})^2 = 3 \\times (-1.0)^2 + 3 \\times (1.0)^2 = 3 \\times 1 + 3 \\times 1 = 6 $$\n因此，$S^2 = 6$。\n\n步骤 3：确定样本的顺序统计量。\n顺序统计量 $x_{(i)}$ 是按升序排列的样本值。\n$x_{(1)} = 11.2$\n$x_{(2)} = 11.2$\n$x_{(3)} = 11.2$\n$x_{(4)} = 13.2$\n$x_{(5)} = 13.2$\n$x_{(6)} = 13.2$\n\n步骤 4：计算项 $b$。\n对于 $n=6$，$b$ 的计算公式为 $b = \\sum_{i=1}^{3} a_i (x_{(6-i+1)} - x_{(i)})$。\n展开为：\n$$ b = a_1 (x_{(6)} - x_{(1)}) + a_2 (x_{(5)} - x_{(2)}) + a_3 (x_{(4)} - x_{(3)}) $$\n使用给定的系数和顺序统计量：\n$a_1 = 0.6431$\n$a_2 = 0.2806$\n$a_3 = 0.0875$\n\n顺序统计量的差值为：\n$x_{(6)} - x_{(1)} = 13.2 - 11.2 = 2.0$\n$x_{(5)} - x_{(2)} = 13.2 - 11.2 = 2.0$\n$x_{(4)} - x_{(3)} = 13.2 - 11.2 = 2.0$\n\n现在，将这些值代入 $b$ 的表达式中：\n$$ b = 0.6431 \\times (2.0) + 0.2806 \\times (2.0) + 0.0875 \\times (2.0) $$\n$$ b = (0.6431 + 0.2806 + 0.0875) \\times 2.0 $$\n$$ b = (1.0112) \\times 2.0 = 2.0224 $$\n\n步骤 5：计算夏皮罗-威尔克统计量 $W$。\n公式为 $W = b^2 / S^2$。\n$$ W = \\frac{(2.0224)^2}{6} = \\frac{4.09006176}{6} = 0.68167696 $$\n\n步骤 6：将结果四舍五入到四位有效数字。\n计算值为 $0.68167696...$。前四位有效数字是 6、8、1、6。第五位有效数字是 7，大于或等于 5，因此我们将第四位数字进一。\n$$ W \\approx 0.6817 $$", "answer": "$$\\boxed{0.6817}$$", "id": "1954943"}, {"introduction": "掌握夏皮罗-威尔克检验的下一步，是从“计算”转向“预测”。这个思想实验挑战你根据数据的真实分布（一个均匀分布）来预测检验结果，而不是直接进行计算。这种练习能极大地锻炼你对分布形状的直觉，并理解为何夏皮罗-威尔克检验对诸如均匀分布这样对称但非正态的分布同样敏感。[@problem_id:1954964]", "problem": "一位统计学家正在分析一个数据集，其中包含对一个Web服务器响应时间的 $n=50$ 次测量。该统计学家不知道的是，这个服务器有一个严格的超时机制，其响应时间完全符合区间 $[5, 25]$ 毫秒上的连续均匀分布。\n\n这位统计学家按照标准程序，决定执行夏皮罗-威尔克检验，以检查数据是否可以用正态分布来建模。原假设 $H_0$ 是数据样本来自一个正态分布的总体。备择假设 $H_1$ 是样本并非来自一个正态分布的总体。该检验会计算一个统计量 $W$ 和一个对应的p值。\n\n根据数据的真实潜在分布，以下哪项是夏皮罗-威尔克检验最可能的结果？\n\nA. 检验统计量 $W$ 将接近1，且p值会很大（例如，大于0.10）。\n\nB. 检验统计量 $W$ 将显著小于1，且p值会很小（例如，小于0.05）。\n\nC. 检验统计量 $W$ 将接近1，但p值会很小（例如，小于0.05）。\n\nD. 检验统计量 $W$ 将显著小于1，但p值会很大（例如，大于0.10）。\n\nE. 检验结果将无法得出结论，因为均匀分布是对称的，而夏皮罗-威尔克检验对对称的非正态分布不敏感。", "solution": "假设样本为 $\\{X_{1},\\dots,X_{n}\\}$，其中 $n=50$，独立同分布地从区间 $[5,25]$ 上的连续均匀分布中抽取。这个分布不是正态分布：它具有有界支撑、在 $[5,25]$ 上密度恒定，并且其尾部行为与具有无界支撑和钟形密度的正态分布有根本的不同。\n\n夏皮罗-威尔克检验统计量的定义为\n$$\nW = \\frac{\\left(\\sum_{i=1}^{n} a_{i} X_{(i)}\\right)^{2}}{\\sum_{i=1}^{n} \\left(X_{i}-\\bar{X}\\right)^{2}},\n$$\n其中 $X_{(1)} \\leq \\dots \\leq X_{(n)}$ 是顺序统计量，$\\bar{X}$ 是样本均值，权重 $a_{i}$ 仅取决于 $n$，并根据标准正态样本的顺序统计量的期望值和协方差结构计算得出。在原假设 $H_{0}$（正态性）下，$W$ 的值趋近于 1；显著偏离正态性会产生较小的 $W$ 值。p值是根据 $W$ 在原假设下的分布计算的，因此一个小的 $W$ 值会产生一个小的p值。\n\n一个关键特性是位置-尺度不变性：如果 $Y_{i}=\\alpha X_{i}+\\beta$ 且 $\\alpha>0$，那么从 $\\{Y_{i}\\}$ 计算出的 $W$ 统计量与从 $\\{X_{i}\\}$ 计算出的值完全相同。由于 $X_{i}\\sim \\text{Uniform}[5,25]$ 是 $\\text{Uniform}[0,1]$ 的一个仿射变换，因此对于 $[5,25]$ 的 $W$ 值与对于 $[0,1]$ 的 $W$ 值相同，在这两种情况下分布都是非正态的。\n\n夏皮罗-威尔克检验对于连续的非正态备择假设是一致的：如果真实分布不是正态的，那么当 $n\\to\\infty$ 时，检验拒绝 $H_{0}$ 的概率趋于1。这意味着观测到的 $W$ 值将位于其零分布（即原假设为真时的分布）的下尾，且p值将趋于0。当样本量 $n=50$ 时，该检验对于像均匀分布这样具有有界支撑和平坦密度的强非正态形状，通常具有很高的检验效力。因此，最可能的结果是 $W$ 将显著小于1，并且p值会很小（例如，小于0.05）。\n\n评估各个选项：\n- 选项A描述了 $W\\approx 1$ 和一个大的p值，这是在正态性假设下预期的结果，而不是在均匀分布的备择假设下。\n- 选项B与在样本量足够的情况下、一个明确的非正态备择假设下的预期结果一致：$W$ 显著小于1和一个小的p值。\n- 选项C（$W\\approx 1$ 但p值很小）与在 $H_0$ 下根据 $W$ 值确定夏皮罗-威尔克p值的方式存在内在矛盾。\n- 选项D（$W$ 值小但p值很大）也存在矛盾，因为小的 $W$ 值对应于 $H_0$ 下分布的下尾，会产生一个小的p值。\n- 选项E是错误的：夏皮罗-威尔克检验对包括均匀分布在内的多种对称非正态分布都敏感，其检测能力并不仅限于偏度。\n\n因此，最可能的结果由选项B描述。", "answer": "$$\\boxed{B}$$", "id": "1954964"}, {"introduction": "理论和计算最终要服务于实际应用。这个练习将你置于一个常见的数据科学场景中：检验线性回归模型的残差是否满足正态性假设。通过解读夏皮罗-威尔克检验的 $p$ 值，你将学习如何根据统计证据做出关键的建模决策，这是连接统计检验与科学实践的重要一环。[@problem_id:1954981]", "problem": "一位数据科学家正在构建一个线性回归模型，以预测商业建筑的月度能耗。为了使模型的标准统计推断（例如模型系数的置信区间和假设检验）可靠，一个关键假设是模型的残差来自正态分布。为了评估这一假设，该数据科学家对从模型中获得的残差集进行了夏皮罗-威尔克检验。该检验得出的p值为$0.02$。检验中使用的显著性水平为$\\alpha = 0.05$。\n\n基于这一结果，以下哪个是最准确的实践结论？\n\nA. 有充分的证据表明残差服从正态分布，因此满足了模型假设。\n\nB. 证据表明，残差服从正态分布的假设被违背了。\n\nC. p值为$0.02$表示残差实际上服从正态分布的概率为$2\\%$。\n\nD. 由于检验结果在统计上是显著的，证明该模型是一个好的预测模型。\n\nE. 检验结果不确定，因为p值非常小，需要一个更大的p值才能做出决定。", "solution": "线性回归系数的推断通常假设残差 $e_{i}$ 是独立同分布(i.i.d.)的，即 $e_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$。为了评估其正态性，我们应用了夏皮罗-威尔克检验。\n\n建立假设：\n$$\nH_{0}：\\text{残差来自一个正态分布}\n$$\n$$\nH_{1}：\\text{残差不来自一个正态分布}\n$$\n\n检验得出的p值为 $p=0.02$，而选定的显著性水平为 $\\alpha=0.05$。决策规则是：\n$$\n\\text{如果 } p \\leq \\alpha，\\text{则拒绝 } H_{0}。\n$$\n由于 $0.02 < 0.05$，我们拒绝原假设 $H_{0}$。实际的结论是，有统计学证据表明残差不服从正态分布；因此，正态性假设很可能被违背了。\n\n评估各个选项：\n- A 是错误的，因为拒绝 $H_{0}$ 与得出残差服从正态分布的结论相矛盾。\n- B 是正确的，因为拒绝原假设意味着有证据反对正态性。\n- C 是错误的，因为p值不是原假设 $H_{0}$ 为真的概率；它是在 $H_{0}$ 为真的前提下，观测到至少与实际观测到的检验统计量一样极端的统计量的概率。\n- D 是错误的，因为这里的“显著性”反映的是对正态性的偏离，而不是模型的预测性能。\n- E 是错误的，因为在给定的 $\\alpha$ 水平下，一个小的p值会导致一个明确的“拒绝 $H_{0}$”的决定。\n\n因此，最准确的实践结论是B。", "answer": "$$\\boxed{B}$$", "id": "1954981"}]}