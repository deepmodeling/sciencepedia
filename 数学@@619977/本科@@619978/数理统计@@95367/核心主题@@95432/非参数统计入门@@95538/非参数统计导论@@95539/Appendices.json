{"hands_on_practices": [{"introduction": "在参数统计中，我们通常假设数据服从正态分布来构建均值的置信区间。然而，当数据分布未知或明显不呈对称形态时，我们如何为数据的中心位置（如中位数）构建一个可靠的区间估计呢？本练习将引导你使用一种强大的非参数方法——基于顺序统计量的方法——来为总体中位数 $\\eta$ 构建置信区间。这个过程不依赖于任何关于数据具体分布形态的假设，其巧妙之处在于将样本的排序与二项分布概率联系起来，让你亲身体验非参数统计的灵活性与严谨性。[@problem_id:1924528]", "problem": "在一项针对新型抗炎药的临床研究中，研究人员测量了受试者在给药后特定生物标志物的恢复时间。观察了一个大小为 $n=15$ 的随机样本，并记录了他们的恢复时间 $T_1, T_2, \\dots, T_{15}$。假设这些时间是从一个连续分布中抽取的，该分布的恢复时间中位数未知，记为 $\\eta$。\n\n一种估计中位数的常用非参数方法是使用有序样本值（顺序统计量）$T_{(1)} \\le T_{(2)} \\le \\dots \\le T_{(15)}$ 来构建置信区间。我们感兴趣的是找到一个形如 $[T_{(i)}, T_{(j)}]$ 的对称置信区间，其中下标满足关系 $j = n - i + 1$。\n\n哪一对下标 $(i, j)$ 能够产生一个关于中位数 $\\eta$ 的置信区间，其置信水平最接近 90%？\n\nA. $(3, 13)$\n\nB. $(4, 12)$\n\nC. $(5, 11)$\n\nD. $(6, 10)$\n\nE. $(7, 9)$", "solution": "设 $X$ 为严格小于（未知）中位数 $\\eta$ 的观测值的数量。在从连续分布进行独立同分布抽样的假设下，$X \\sim \\mathrm{Binomial}(n, \\frac{1}{2})$，并且 $\\mathbb{P}(T_{(i)} \\le \\eta \\le T_{(j)})$ 可以使用顺序统计量逻辑计算，其中出现相等值的概率为零。\n\n对于一个固定的 $\\eta$：\n- $T_{(i)} \\le \\eta$ 当且仅当至少有 $i$ 个观测值小于 $\\eta$，即 $X \\ge i$。\n- $\\eta \\le T_{(j)}$ 当且仅当至多有 $j-1$ 个观测值小于 $\\eta$，即 $X \\le j-1$。\n\n因此，\n$$\n\\{T_{(i)} \\le \\eta \\le T_{(j)}\\} \\iff \\{i \\le X \\le j-1\\}.\n$$\n对于一个对称区间，有 $j = n - i + 1$，我们得到 $j - 1 = n - i$，因此\n$$\n\\mathbb{P}(T_{(i)} \\le \\eta \\le T_{(n-i+1)}) = \\mathbb{P}(i \\le X \\le n - i).\n$$\n当 $X \\sim \\mathrm{Binomial}(n, \\frac{1}{2})$ 时，利用对称性，\n$$\n\\mathbb{P}(i \\le X \\le n - i) = 1 - 2\\,\\mathbb{P}(X \\le i - 1).\n$$\n\n对于 $n = 15$，我们写出\n$$\n\\mathbb{P}(X \\le k) = 2^{-15} \\sum_{x=0}^{k} \\binom{15}{x}.\n$$\n设 $S_{k} = \\sum_{x=0}^{k} \\binom{15}{x}$。那么对于下标 $i$ 的覆盖率为\n$$\n\\mathbb{P}(i \\le X \\le 15 - i) = 1 - 2 \\cdot 2^{-15} S_{i-1} = 1 - 2^{-14} S_{i-1}.\n$$\n\n计算所需的二项式系数和部分和：\n$$\n\\binom{15}{0}=1,\\ \\binom{15}{1}=15,\\ \\binom{15}{2}=105,\\ \\binom{15}{3}=455,\\ \\binom{15}{4}=1365,\\ \\binom{15}{5}=3003,\\ \\binom{15}{6}=5005,\\ \\binom{15}{7}=6435,\n$$\n$$\nS_{0}=1,\\ S_{1}=16,\\ S_{2}=121,\\ S_{3}=576,\\ S_{4}=1941,\\ S_{5}=4944,\\ S_{6}=9949,\\quad 2^{14}=16384.\n$$\n\n因此，对于候选的 $i$ 值，其覆盖率分别为：\n- $i=3$: $1 - \\frac{121}{16384} = \\frac{16263}{16384}$,\n- $i=4$: $1 - \\frac{576}{16384} = \\frac{15808}{16384}$,\n- $i=5$: $1 - \\frac{1941}{16384} = \\frac{14443}{16384}$,\n- $i=6$: $1 - \\frac{4944}{16384} = \\frac{11440}{16384}$,\n- $i=7$: $1 - \\frac{9949}{16384} = \\frac{6435}{16384}$.\n\n我们将每个值与 $9/10$ 进行比较，计算其精确差值：\n- 对于 $i=5$：$\\left|\\frac{14443}{16384} - \\frac{9}{10}\\right| = \\frac{|144430 - 147456|}{163840} = \\frac{3026}{163840}$。\n- 对于 $i=4$：$\\left|\\frac{15808}{16384} - \\frac{9}{10}\\right| = \\frac{|158080 - 147456|}{163840} = \\frac{10624}{163840}$。\n- 对于 $i=3$：$\\left|\\frac{16263}{16384} - \\frac{9}{10}\\right| = \\frac{|162630 - 147456|}{163840} = \\frac{15174}{163840}$。\n- 对于 $i=6$：$\\left|\\frac{11440}{16384} - \\frac{9}{10}\\right| = \\frac{|114400 - 147456|}{163840} = \\frac{33056}{163840}$。\n- 对于 $i=7$：$\\left|\\frac{6435}{16384} - \\frac{9}{10}\\right| = \\frac{|64350 - 147456|}{163840} = \\frac{83106}{163840}$。\n\n最小的差值出现在 $i=5$ 处，对应的区间为 $(i,j) = (5,11)$。\n\n因此，最接近 9/10 置信水平的选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1924528"}, {"introduction": "在评估机器学习模型或任何预测模型的性能时，一个关键步骤是分析其预测误差。一个理想的模型，其误差应均匀分布在零点两侧，即误差分布关于零对称。本练习提供了一个检验这种对称性的非参数方法——威尔科克森符号秩检验 (Wilcoxon Signed-Rank Test)。通过计算其检验统计量 $W^+$，你将学会如何量化样本数据对于“关于零对称”这一原假设的支持程度，这是模型诊断和验证中的一项核心技能。[@problem_id:1924555]", "problem": "一位数据科学家正在评估一个用于预测某金融指数的新机器学习模型。该模型的性能通过分析其预测误差来严格评估，预测误差定义为 $e_i = (\\text{实际值})_i - (\\text{预测值})_i$。为了使该模型被认为是无偏的（这是后续风险分析的一项要求），其误差的潜在分布应关于零对称。\n\n从该模型的近期表现中收集了一个包含11个预测误差的样本：\n$\\{1.2, -0.8, 2.5, -1.5, -0.8, 3.1, 0.0, -2.1, 1.7, 0.9, 1.4\\}$\n\n为了正式研究误差分布的对称性，您需要计算一个基于秩的检验统计量。计算该统计量（我们将其表示为 $W^+$）的步骤如下：\n1.  从数据集中移除任何等于零的观测值。令新的、缩减后的样本量为 $n$。\n2.  取剩余的 $n$ 个非零观测值的绝对值。\n3.  将这 $n$ 个绝对值从小到大（秩为1）到大（秩为 $n$）进行排序。如果绝对值出现结（ties），则为每个结中的观测值分配它们本应占有的秩的平均值。\n4.  检验统计量 $W^+$ 定义为非零数据集中原始值为正的观测值所对应的秩之和。\n\n计算检验统计量 $W^+$ 的值。", "solution": "我们从误差数据集 $ \\{1.2, -0.8, 2.5, -1.5, -0.8, 3.1, 0.0, -2.1, 1.7, 0.9, 1.4\\}$ 开始。按照步骤进行：\n1) 移除零值：舍去 $0.0$，剩下 $n=10$ 个非零观测值。\n2) 取非零观测值的绝对值：\n$\\{1.2, 0.8, 2.5, 1.5, 0.8, 3.1, 2.1, 1.7, 0.9, 1.4\\}.$\n3) 将这些绝对值从小到大排序，对结采用平均秩。排序后的绝对值为\n$0.8, 0.8, 0.9, 1.2, 1.4, 1.5, 1.7, 2.1, 2.5, 3.1,$\n因此，秩的分配如下：\n- $0.8$（出现两次）的秩均为 $\\frac{1+2}{2}=1.5$，\n- $0.9 \\to 3$，\n- $1.2 \\to 4$，\n- $1.4 \\to 5$，\n- $1.5 \\to 6$，\n- $1.7 \\to 7$，\n- $2.1 \\to 8$，\n- $2.5 \\to 9$，\n- $3.1 \\to 10$。\n将秩按顺序映射回原始的非零观测值：\n- $1.2$（正）的秩为 $4$，\n- $-0.8$（负）的秩为 $1.5$，\n- $2.5$（正）的秩为 $9$，\n- $-1.5$（负）的秩为 $6$，\n- $-0.8$（负）的秩为 $1.5$，\n- $3.1$（正）的秩为 $10$，\n- $-2.1$（负）的秩为 $8$，\n- $1.7$（正）的秩为 $7$，\n- $0.9$（正）的秩为 $3$，\n- $1.4$（正）的秩为 $5$。\n4) 将原始值为正的观测值所对应的秩相加，得到 $W^{+}$：\n$$W^{+} = 4 + 9 + 10 + 7 + 3 + 5 = 38.$$\n作为一致性检验，所有秩的总和为 $ \\frac{n(n+1)}{2} = \\frac{10 \\cdot 11}{2} = 55$，因此负观测值的秩之和为 $55 - 38 = 17$，这与分配给负值的秩相符，从而验证了计算的正确性。\n因此，所求的检验统计量为 $W^{+} = 38$。", "answer": "$$\\boxed{38}$$", "id": "1924555"}, {"introduction": "比较两组独立样本是否存在显著差异是统计分析中最常见的任务之一。当数据不满足正态性假设，使得传统的 $t$ 检验不再适用时，威尔科克森秩和检验（或称曼-惠特尼U检验）便成为首选的非参数替代方案。本练习将带你处理一个比较两款独立游戏日下载量的实际场景，通过合并数据、排序、处理数据结 (ties) 并计算秩和，你将掌握比较两个独立总体位置参数的核心非参数技术。[@problem_id:1924536]", "problem": "一位数据分析师正在研究两款独立开发的视频游戏“Aetherfall”和“Byte Runner”的初期市场反响。该分析师收集了每款游戏在短期内的每日下载量数据。其目标是比较这两组下载量计数的分布位置，而不对其形状做任何假设（例如，不假设它们服从正态分布）。\n\n记录的每日下载量如下：\n- **Aetherfall**：$X = \\{155, 190, 172, 215, 160, 185, 205\\}$\n- **Byte Runner**：$Y = \\{180, 220, 195, 230, 172, 210, 200, 240, 165\\}$\n\n为了执行一个对潜在分布具有稳健性的双样本检验，通常的第一步是合并所有观测值，将它们从小到大进行排序，然后基于这些秩计算一个检验统计量。\n\n计算游戏“Aetherfall”的每日下载量所对应的秩之和。", "solution": "我们的目标是计算“Aetherfall”样本的Wilcoxon型秩和。步骤如下：\n- 合并两个样本，并将所有观测值从小到大排序，对相同值（结）赋予平均秩。\n- 将“Aetherfall”观测值对应的秩相加。\n\n合并并排序所有观测值（Aetherfall 标记为 X，Byte Runner 标记为 Y）：155(X), 160(X), 165(Y), 172(X), 172(Y), 180(Y), 185(X), 190(X), 195(Y), 200(Y), 205(X), 210(Y), 215(X), 220(Y), 230(Y), 240(Y)。总共有 $n=16$ 个观测值，因此秩为 $1,2,\\ldots,16$。唯一的相同值（结）出现在 $172$，有两个观测值；对应的秩 $4$ 和 $5$ 被它们的平均值 $4.5$ 替代。\n\n因此，分配的秩如下：\n- $155(X)\\to 1$, $160(X)\\to 2$, $165(Y)\\to 3$, $172(X)\\to 4.5$, $172(Y)\\to 4.5$, $180(Y)\\to 6$, $185(X)\\to 7$, $190(X)\\to 8$, $195(Y)\\to 9$, $200(Y)\\to 10$, $205(X)\\to 11$, $210(Y)\\to 12$, $215(X)\\to 13$, $220(Y)\\to 14$, $230(Y)\\to 15$, $240(Y)\\to 16$。\n\n计算 Aetherfall (X) 的秩和：\n$$1+2+4.5+7+8+11+13=46.5.$$\n作为检验，总秩和为 $\\frac{n(n+1)}{2}=\\frac{16\\cdot 17}{2}=136$，因此 Byte Runner 的秩和为 $136-46.5=89.5$，这与分配的秩是一致的。", "answer": "$$\\boxed{46.5}$$", "id": "1924536"}]}