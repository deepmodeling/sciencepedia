{"hands_on_practices": [{"introduction": "在深入研究公式之前，建立对曼-惠特尼U统计量核心概念的直观理解至关重要。这个练习将U统计量定义为一个简单的计数过程：一组中的数值小于另一组数值的配对总数。通过亲手计算，您可以掌握U检验的基本逻辑，即它直接比较两个样本的相对大小关系。[@problem_id:1962435]", "problem": "一个材料科学研究小组正在测试两种分别命名为配方A和配方B的新型生物可降解聚合物，以评估它们在环境应力下的性能。为此，他们在一段加速老化期后，测量了每种配方的几个样品的极限拉伸强度。每种配方的测量结果以兆帕（MPa）为单位记录下来。\n\n配方A的测量数据集为 $S_A = \\{15, 25, 30\\}$。\n配方B的测量数据集为 $S_B = \\{12, 22, 28, 40\\}$。\n\n为了进行初步比较，研究人员决定计算一个我们称之为 $U_A$ 的非参数统计量。该统计量定义为可以组成的测量值对 $(a, b)$ 的总数，其中 $a$ 是来自集合 $S_A$ 的值，$b$ 是来自集合 $S_B$ 的值，并且配方A的值小于配方B的值（即 $a  b$）。\n\n计算统计量 $U_A$ 的值。", "solution": "给定 $S_{A}=\\{15,25,30\\}$ 和 $S_{B}=\\{12,22,28,40\\}$。根据定义，统计量 $U_{A}$ 是指满足 $a\\in S_{A}$ 和 $b\\in S_{B}$ 且 $ab$ 的有序对 $(a,b)$ 的数量。形式上，\n$$\nU_{A}=\\sum_{a\\in S_{A}}\\left|\\{\\,b\\in S_{B}:ab\\,\\}\\right|.\n$$\n计算每个 $a\\in S_{A}$ 的贡献值：\n- 对于 $a=15$：与 $S_{B}$ 中的值进行比较，有 $1522$、$1528$、$1540$，而 $1512$ 不成立。因此，计数为 $3$。\n- 对于 $a=25$：比较可知 $2528$、$2540$，而 $2512$ 和 $2522$ 不成立。因此，计数为 $2$。\n- 对于 $a=30$：比较可知 $3040$，而 $3012$、$3022$ 和 $3028$ 不成立。因此，计数为 $1$。\n\n将这些贡献值相加，\n$$\nU_{A}=3+2+1=6.\n$$", "answer": "$$\\boxed{6}$$", "id": "1962435"}, {"introduction": "虽然直接计数有助于理解概念，但在处理较大数据集时效率低下。这个练习将介绍计算U统计量的更常用、更实用的方法：秩和法。通过将两个样本合并排序并计算其中一个样本的秩和，我们可以高效地得出U值，这也是统计软件中通常采用的计算方式。[@problem_id:1962467]", "problem": "一位农业科学家正在研究两种不同的生物肥料“Zymox”和“GroFast”对某一特定品种豆类植物生长的有效性。实验随机选取了两组幼苗。一组8株植物使用 Zymox 处理，另一组7株植物使用 GroFast 处理。所有其他生长条件，如光照、水分和土壤，在两组间均保持一致。经过六周的生长期后，科学家测量了每株植物的最终高度。\n\nZymox 处理组植物记录的高度（单位：厘米）如下：\n$H_Z = \\{25.1, 28.5, 23.9, 30.2, 29.8, 33.1, 26.5, 30.2\\}$\n\nGroFast 处理组植物记录的高度（单位：厘米）如下：\n$H_G = \\{31.5, 34.0, 27.6, 35.8, 29.1, 32.4, 33.5\\}$\n\n为评估两种肥料产生的植物高度分布是否存在显著差异，采用了一种非参数统计检验。请计算这两个样本的 Mann-Whitney U 检验统计量的值。", "solution": "我们将 Zymox 组记为样本1，其大小为 $n_{Z}=8$，将 GroFast 组记为样本2，其大小为 $n_{G}=7$。合并后的样本总量为 $N=n_{Z}+n_{G}=15$。\n\nMann-Whitney 检验步骤：\n1) 合并所有观测值并按从小到大的顺序排序，若有相同值（结），则取其平均秩次。\n2) 计算其中一组（例如 Zymox 组）的秩和：$R_{Z}$。\n3) 使用 Mann-Whitney 公式：\n$$\nU_{Z}=R_{Z}-\\frac{n_{Z}(n_{Z}+1)}{2},\\quad U_{G}=R_{G}-\\frac{n_{G}(n_{G}+1)}{2},\\quad U_{Z}+U_{G}=n_{Z}n_{G}.\n$$\n\n将全部15个高度值按升序排列，唯一的相同值出现在Zymox组内部，即两个值为$30.2$的观测，它们的平均秩次均为$8.5$。Zymox 组的观测值得到的秩次为\n$$\n1,\\;2,\\;3,\\;5,\\;7,\\;8.5,\\;8.5,\\;12.\n$$\n因此，Zymox 组的秩和为\n$$\nR_{Z}=1+2+3+5+7+8.5+8.5+12=47.\n$$\n因此，\n$$\nU_{Z}=R_{Z}-\\frac{n_{Z}(n_{Z}+1)}{2}=47-\\frac{8\\cdot 9}{2}=47-36=11.\n$$\n根据互补关系，\n$$\nU_{G}=n_{Z}n_{G}-U_{Z}=8\\cdot 7-11=56-11=45.\n$$\n按照惯例，Mann-Whitney 检验统计量取 $U_{Z}$ 和 $U_{G}$ 中的较小者，即 $11$。", "answer": "$$\\boxed{11}$$", "id": "1962467"}, {"introduction": "掌握了如何计算U统计量后，下一个关键问题是“为什么”以及“何时”使用它。U检验的真正威力在于其对非正态数据（尤其是异常值）的稳健性。本练习通过一个具体的例子，展示了参数化的t检验如何因一个异常值而失效，而基于秩的U检验却能正确地识别出显著差异，从而突显了其在现实世界数据分析中的价值。[@problem_id:1962463]", "problem": "一位材料科学家正在研究一种名为“合金A”的新型实验性合金，其设计旨在提高与标准配方“合金B”相比的断裂韧性。为了对它们进行比较，该科学家测量了每种合金五个样本的断裂韧性。结果如下所示，单位为兆帕乘以米的平方根 (MPa$\\sqrt{\\text{m}}$)：\n\n-   **合金A（实验性）：** {10.5, 9.5, 11.0, 0.5, 10.0}\n-   **合金B（标准）：** {12.0, 13.5, 11.5, 13.0, 12.5}\n\n该科学家希望检验一个原假设，即两种合金的断裂韧性分布的集中趋势（位置）没有差异，其备择假设为存在差异（双尾检验）。这将使用两种不同的统计检验，在显著性水平 $\\alpha = 0.05$ 下进行。\n\n为本题之目的，假设以下临界值：\n1.  在适当的自由度下，双尾学生t检验的临界值为2.306。如果计算出的t统计量的绝对值大于此临界值，则拒绝原假设。\n2.  对于样本量 $n_1=5$ 和 $n_2=5$，双尾曼-惠特尼U检验的临界值为2。如果计算出的U统计量小于或等于此临界值，则拒绝原假设。\n\n以下哪个陈述正确描述了从双样本t检验和曼-惠特尼U检验中得出的结论？\n\nA. 两种检验都拒绝原假设。\n\nB. 两种检验都未能拒绝原假设。\n\nC. t检验拒绝原假设，但曼-惠特尼U检验不拒绝。\n\nD. 曼-惠特尼U检验拒绝原假设，但t检验不拒绝。", "solution": "我们将合金A的样本量表示为 $n_{1}=5$，合金B的样本量表示为 $n_{2}=5$。我们使用双样本学生t检验（合并方差）和曼-惠特尼U检验来检验原假设 $H_{0}$：位置无差异，备择假设为双侧，显著性水平均为 $\\alpha=0.05$。\n\n对于t检验，我们首先计算样本均值和方差。对于合金A，观测值为 $\\{10.5,9.5,11.0,0.5,10.0\\}$。均值为\n$$\n\\bar{x}_{A}=\\frac{10.5+9.5+11.0+0.5+10.0}{5}=\\frac{41.5}{5}=8.3.\n$$\n离差平方和为\n$$\n\\sum_{i=1}^{5}(x_{Ai}-\\bar{x}_{A})^{2}=(2.2)^{2}+(1.2)^{2}+(2.7)^{2}+(-7.8)^{2}+(1.7)^{2}=77.3,\n$$\n所以样本方差为\n$$\ns_{A}^{2}=\\frac{77.3}{n_{1}-1}=\\frac{77.3}{4}=19.325.\n$$\n对于合金B, 观测值为 $\\{12.0,13.5,11.5,13.0,12.5\\}$。均值为\n$$\n\\bar{x}_{B}=\\frac{12.0+13.5+11.5+13.0+12.5}{5}=\\frac{62.5}{5}=12.5.\n$$\n离差平方和为\n$$\n( -0.5 )^{2}+(1.0)^{2}+(-1.0)^{2}+(0.5)^{2}+0^{2}=2.5,\n$$\n所以样本方差为\n$$\ns_{B}^{2}=\\frac{2.5}{n_{2}-1}=\\frac{2.5}{4}=0.625.\n$$\n在等方差t检验下，合并方差及其平方根为\n$$\ns_{p}^{2}=\\frac{(n_{1}-1)s_{A}^{2}+(n_{2}-1)s_{B}^{2}}{n_{1}+n_{2}-2}=\\frac{4\\cdot 19.325+4\\cdot 0.625}{8}=\\frac{79.8}{8}=9.975,\\quad s_{p}=\\sqrt{9.975}.\n$$\n检验统计量为\n$$\nt=\\frac{\\bar{x}_{A}-\\bar{x}_{B}}{s_{p}\\sqrt{\\frac{1}{n_{1}}+\\frac{1}{n_{2}}}}=\\frac{8.3-12.5}{\\sqrt{9.975}\\,\\sqrt{\\frac{1}{5}+\\frac{1}{5}}}=\\frac{-4.2}{\\sqrt{9.975}\\,\\sqrt{0.4}}=\\frac{-4.2}{\\sqrt{3.99}}.\n$$\n自由度为 $n_{1}+n_{2}-2=8$，给定的临界值为 $2.306$，我们将 $|t|=\\frac{4.2}{\\sqrt{3.99}}\\approx 2.10$ 与 $2.306$ 进行比较。由于 $|t|2.306$，t检验未能拒绝 $H_{0}$。\n\n对于曼-惠特尼U检验，我们对合并后的样本从小到大进行排序。带分组标签的排序值为：$0.5$ (A), $9.5$ (A), $10.0$ (A), $10.5$ (A), $11.0$ (A), $11.5$ (B), $12.0$ (B), $12.5$ (B), $13.0$ (B), $13.5$ (B)。合金A的秩为 $1,2,3,4,5$，所以合金A的秩和为\n$$\nR_{A}=1+2+3+4+5=15.\n$$\n合金A的曼-惠特尼统计量为\n$$\nU_{A}=R_{A}-\\frac{n_{1}(n_{1}+1)}{2}=15-\\frac{5\\cdot 6}{2}=15-15=0.\n$$\n类似地，$U_{B}=n_{1}n_{2}-U_{A}=25-0=25$，检验统计量为 $U=\\min\\{U_{A},U_{B}\\}=0$。考虑到对于 $n_{1}=n_{2}=5$ 给定的双尾临界值为 $2$，如果 $U\\leq 2$，我们拒绝 $H_{0}$。由于 $U=0\\leq 2$，曼-惠特尼U检验拒绝 $H_{0}$。\n\n因此，曼-惠特尼U检验拒绝原假设，而t检验不拒绝。正确选项是D。", "answer": "$$\\boxed{D}$$", "id": "1962463"}]}