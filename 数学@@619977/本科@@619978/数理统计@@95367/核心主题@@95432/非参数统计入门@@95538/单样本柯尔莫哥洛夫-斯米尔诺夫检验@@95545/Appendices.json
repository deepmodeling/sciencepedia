{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，将柯尔莫哥洛夫-斯米尔诺夫（KS）检验应用于一个假设的均匀分布。这个练习旨在帮助你掌握计算KS检验统计量 $D_n$ 的核心步骤。通过使用一个简单的均匀分布，你可以专注于计算经验累积分布函数（ECDF）与理论累积分布函数（CDF）之间的最大偏差，而不会被复杂的理论分布所困扰 [@problem_id:1927831]。", "problem": "一位考古学家假设，在某考古遗址发现的一种特定类型的陶瓷碎片的深度是均匀分布的。根据她的模型，这些深度（以米为单位）应服从一个最小值在0.5米、最大值在2.5米之间的连续均匀分布。为了检验这个假设，收集了一个包含8个碎片的小型随机样本，并测量了它们的深度。观测到的深度按升序排列如下：\n\n0.6, 0.9, 1.1, 1.3, 1.8, 2.0, 2.1, 2.4.\n\n令 $F(x)$ 为假设的均匀分布的累积分布函数 (CDF)，令 $S_n(x)$ 为样本量为 $n=8$ 的样本的经验累积分布函数 (ECDF)。用于评估拟合优度的检验统计量定义为 $D_n = \\sup_x |S_n(x) - F(x)|$。\n\n计算给定样本的检验统计量 $D_n$ 的值。将最终答案四舍五入到四位有效数字。", "solution": "我们检验样本是否符合假设的在 $[a,b]=[0.5,2.5]$ 上的连续均匀分布。其累积分布函数为\n$$\nF(x)=\n\\begin{cases}\n0, & x<0.5,\\\\\n\\dfrac{x-0.5}{2.0}, & 0.5 \\leq x \\leq 2.5,\\\\\n1, & x>2.5.\n\\end{cases}\n$$\n令有序样本为 $x_{(1)},\\dots,x_{(8)}$，其中 $x_{(i)}\\in\\{0.6,0.9,1.1,1.3,1.8,2.0,2.1,2.4\\}$。经验累积分布函数 $S_{n}(x)$ 是一个右连续阶梯函数，在每个 $x_{(i)}$ 处有大小为 $\\frac{1}{n}$ 的跳跃。对于柯尔莫哥洛夫-斯米尔诺夫统计量，\n$$\nD_{n}=\\sup_{x}|S_{n}(x)-F(x)|=\\max\\left\\{D^{+},D^{-}\\right\\},\n$$\n其中\n$$\nD^{+}=\\max_{1\\leq i\\leq n}\\left(\\frac{i}{n}-F\\!\\left(x_{(i)}\\right)\\right),\\quad\nD^{-}=\\max_{1\\leq i\\leq n}\\left(F\\!\\left(x_{(i)}\\right)-\\frac{i-1}{n}\\right).\n$$\n计算 $F(x_{(i)})=(x_{(i)}-0.5)/2$：\n- $x_{(1)}=0.6$：$F=0.05$；$\\frac{1}{8}-F=0.125-0.05=0.075$；$F-\\frac{0}{8}=0.05$。\n- $x_{(2)}=0.9$：$F=0.20$；$\\frac{2}{8}-F=0.25-0.20=0.05$；$F-\\frac{1}{8}=0.20-0.125=0.075$。\n- $x_{(3)}=1.1$：$F=0.30$；$\\frac{3}{8}-F=0.375-0.30=0.075$；$F-\\frac{2}{8}=0.30-0.25=0.05$。\n- $x_{(4)}=1.3$：$F=0.40$；$\\frac{4}{8}-F=0.5-0.40=0.10$；$F-\\frac{3}{8}=0.40-0.375=0.025$。\n- $x_{(5)}=1.8$：$F=0.65$；$\\frac{5}{8}-F=0.625-0.65=-0.025$；$F-\\frac{4}{8}=0.65-0.5=0.15$。\n- $x_{(6)}=2.0$：$F=0.75$；$\\frac{6}{8}-F=0.75-0.75=0$；$F-\\frac{5}{8}=0.75-0.625=0.125$。\n- $x_{(7)}=2.1$：$F=0.80$；$\\frac{7}{8}-F=0.875-0.80=0.075$；$F-\\frac{6}{8}=0.80-0.75=0.05$。\n- $x_{(8)}=2.4$：$F=0.95$；$\\frac{8}{8}-F=1-0.95=0.05$；$F-\\frac{7}{8}=0.95-0.875=0.075$。\n\n因此，\n$$\nD^{+}=\\max\\{0.075,0.05,0.075,0.10,-0.025,0,0.075,0.05\\}=0.10,\n$$\n$$\nD^{-}=\\max\\{0.05,0.075,0.05,0.025,0.15,0.125,0.05,0.075\\}=0.15,\n$$\n所以\n$$\nD_{n}=\\max\\{D^{+},D^{-}\\}=0.15.\n$$\n四舍五入到四位有效数字得到 $0.1500$。", "answer": "$$\\boxed{0.1500}$$", "id": "1927831"}, {"introduction": "掌握了基础计算之后，我们来处理统计学中最重要的分布——正态分布。这个练习不仅要求你计算KS统计量，更重要的是，它将引导你完成整个假设检验的流程：将计算出的 $D_n$ 值与给定的临界值进行比较，从而做出统计决策。这个质量控制的场景展示了KS检验在工业应用中的实际价值 [@problem_id:1927872]。", "problem": "一位质量控制工程师正在评估一条生产高精度滚珠轴承的生产线的产出。生产标准要求滚珠轴承的直径服从均值为 $\\mu = 5.000$ 毫米、标准差为 $\\sigma = 0.010$ 毫米的正态分布。随机抽取了8个滚珠轴承的样本，并测量了它们的直径。测量结果按升序排列如下：\n\n{4.985, 4.993, 5.001, 5.008, 5.012, 5.015, 5.021, 5.028} (单位均为毫米)。\n\n您的任务是使用拟合优度分析，在显著性水平 $\\alpha = 0.05$ 下，评估该样本与指定生产标准的一致性。\n\n为帮助您进行分析，以下是标准正态累积分布函数 $\\Phi(z)$ 的所需值，其中 $z$ 是标准分数：\n$\\Phi(-1.50) = 0.0668$\n$\\Phi(-0.70) = 0.2420$\n$\\Phi(0.10) = 0.5398$\n$\\Phi(0.80) = 0.7881$\n$\\Phi(1.20) = 0.8849$\n$\\Phi(1.50) = 0.9332$\n$\\Phi(2.10) = 0.9821$\n$\\Phi(2.80) = 0.9974$\n\n在显著性水平 $\\alpha=0.05$ 下，对于样本量 $n=8$ 的相应检验统计量的临界值为 $0.454$。\n\n根据您的分析，下列哪个陈述是正确的结论？\n\nA. 检验统计量约为 0.413，数据与指定的正态分布一致。\n\nB. 检验统计量约为 0.413，数据与指定的正态分布不一致。\n\nC. 检验统计量约为 0.288，数据与指定的正态分布一致。\n\nD. 检验统计量约为 0.288，数据与指定的正态分布不一致。", "solution": "我们使用单样本柯尔莫哥洛夫-斯米尔诺夫（Kolmogorov–Smirnov）拟合优度检验，在显著性水平 $\\alpha=0.05$ 下，检验原假设 $H_{0}$：直径是来自 $N(\\mu,\\sigma^{2})$ 的独立同分布（i.i.d.）样本，其中 $\\mu=5.000$ 且 $\\sigma=0.010$，备择假设为一般性备择假设。该检验适用于完全指定的连续分布。对于有序观测值 $x_{(1)} \\leq \\dots \\leq x_{(n)}$，K–S 统计量定义为\n$$\nD^{+}=\\max_{1\\leq i\\leq n}\\left\\{\\frac{i}{n}-F(x_{(i)})\\right\\},\\quad\nD^{-}=\\max_{1\\leq i\\leq n}\\left\\{F(x_{(i)})-\\frac{i-1}{n}\\right\\},\\quad\nD=\\max\\{D^{+},D^{-}\\},\n$$\n其中 $F$ 是假设的累积分布函数。这里 $F(x)=\\Phi\\!\\left(\\frac{x-\\mu}{\\sigma}\\right)$，$\\Phi$ 是标准正态累积分布函数（CDF）。\n\n使用所提供的值计算标准化分数 $z_{i}=(x_{(i)}-\\mu)/\\sigma$ 和 $F(x_{(i)})=\\Phi(z_{i})$。对于给定的数据 $\\{4.985,4.993,5.001,5.008,5.012,5.015,5.021,5.028\\}$ 和 $(\\mu,\\sigma)=(5.000,0.010)$，计算出的 $z$-分数为 $-1.50,-0.70,0.10,0.80,1.20,1.50,2.10,2.80$，得到的 $F$ 值为 $0.0668,0.2420,0.5398,0.7881,0.8849,0.9332,0.9821,0.9974$。当 $n=8$ 时，我们有 $\\frac{i}{n}=0.125,0.250,0.375,0.500,0.625,0.750,0.875,1.000$ 和 $\\frac{i-1}{n}=0,0.125,0.250,0.375,0.500,0.625,0.750,0.875$。\n\n现在计算每个 $i$ 的差值：\n- $i=1$: $D^{+}_{1}=0.125-0.0668=0.0582$, $D^{-}_{1}=0.0668-0=0.0668$.\n- $i=2$: $D^{+}_{2}=0.250-0.2420=0.0080$, $D^{-}_{2}=0.2420-0.125=0.1170$.\n- $i=3$: $D^{+}_{3}=0.375-0.5398=-0.1648$, $D^{-}_{3}=0.5398-0.250=0.2898$.\n- $i=4$: $D^{+}_{4}=0.500-0.7881=-0.2881$, $D^{-}_{4}=0.7881-0.375=0.4131$.\n- $i=5$: $D^{+}_{5}=0.625-0.8849=-0.2599$, $D^{-}_{5}=0.8849-0.500=0.3849$.\n- $i=6$: $D^{+}_{6}=0.750-0.9332=-0.1832$, $D^{-}_{6}=0.9332-0.625=0.3082$.\n- $i=7$: $D^{+}_{7}=0.875-0.9821=-0.1071$, $D^{-}_{7}=0.9821-0.750=0.2321$.\n- $i=8$: $D^{+}_{8}=1.000-0.9974=0.0026$, $D^{-}_{8}=0.9974-0.875=0.1224$.\n\n因此 $D^{+}=\\max\\{0.0582,0.0080,0.0026\\}=0.0582$，$D^{-}=\\max\\{0.0668,0.1170,0.2898,0.4131,0.3849,0.3082,0.2321,0.1224\\}=0.4131$，所以 $D=\\max\\{0.0582,0.4131\\}=0.4131\\approx 0.413$。\n\n在 $\\alpha=0.05$ 和 $n=8$ 的条件下，所提供的临界值为 $D_{0.05}=0.454$。由于 $D=0.4131  0.454$，我们不拒绝 $H_{0}$。因此，该样本与指定的正态分布是一致的。在选项中，这对应于检验统计量约为 $0.413$ 且结论为一致的陈述，即选项A。", "answer": "$$\\boxed{A}$$", "id": "1927872"}, {"introduction": "最后，我们通过一个来自现代物理学前沿的例子，来探索KS检验的强大功能。本练习将检验样本数据是否符合随机矩阵理论中的Wigner分布，这展示了KS检验在验证科学理论模型方面的广泛适用性。这个挑战性的问题将促使你将相同的基本方法应用于一个新颖且不熟悉的分布，从而加深对该检验通用性的理解 [@problem_id:1927852]。", "problem": "在量子混沌和复杂系统的研究中，随机矩阵理论提供了强大的统计模型。其中一个模型是高斯酉系综（GUE），它描述了某些量子系统中能级的统计特性。GUE 的一个关键预测涉及相邻能级（本征值）之间的归一化间距 $s$ 的分布。该分布被假设遵循 Wigner 猜测，其累积分布函数（CDF）$F_0(s)$ 由下式给出：\n$$F_0(s) = 1 - \\exp\\left(-\\frac{\\pi}{4}s^2\\right), \\quad \\text{for } s \\ge 0$$\n一位物理学家在模拟一个复杂量子系统时，获得了一个包含八个归一化本征值间距的小样本。观测值为：\n0.91, 1.75, 0.45, 1.15, 0.18, 1.30, 2.40, 0.62\n为了检验该样本是否来自 Wigner 猜测分布的假设，请计算柯尔莫哥洛夫-斯米尔诺夫单样本检验统计量 $D_n$。\n\n报告检验统计量 $D_n$ 的最终答案，四舍五入至四位有效数字。", "solution": "柯尔莫哥洛夫-斯米尔诺夫单样本统计量通过以下方式，比较大小为 $n$ 的样本的经验累积分布函数 $F_{n}(s)$ 与一个假设的连续累积分布函数 $F_{0}(s)$：\n$$\nD_{n}=\\sup_{s\\in\\mathbb{R}}|F_{n}(s)-F_{0}(s)|=\\max\\{D^{+},D^{-}\\},\n$$\n其中，对于排序后的样本值 $x_{(1)}\\leq\\cdots\\leq x_{(n)}$，\n$$\nD^{+}=\\max_{1\\leq i\\leq n}\\left(\\frac{i}{n}-F_{0}(x_{(i)})\\right),\\qquad\nD^{-}=\\max_{1\\leq i\\leq n}\\left(F_{0}(x_{(i)})-\\frac{i-1}{n}\\right).\n$$\n这里，$F_{0}(s)=1-\\exp\\!\\left(-\\frac{\\pi}{4}s^{2}\\right)$ (对于 $s\\geq 0$)，且（排序后的）样本为 $x_{(1)}=0.18$，$x_{(2)}=0.45$，$x_{(3)}=0.62$，$x_{(4)}=0.91$，$x_{(5)}=1.15$，$x_{(6)}=1.30$，$x_{(7)}=1.75$，$x_{(8)}=2.40$，其中 $n=8$。\n\n数值计算 $F_{0}(x_{(i)})=1-\\exp\\!\\left(-\\frac{\\pi}{4}x_{(i)}^{2}\\right)$：\n- $x_{(1)}=0.18$：$\\frac{\\pi}{4}x_{(1)}^{2}\\approx 0.0254469$，所以 $F_{0}(x_{(1)})\\approx 0.025126$。\n- $x_{(2)}=0.45$：$\\frac{\\pi}{4}x_{(2)}^{2}\\approx 0.1590431$，所以 $F_{0}(x_{(2)})\\approx 0.147068$。\n- $x_{(3)}=0.62$：$\\frac{\\pi}{4}x_{(3)}^{2}\\approx 0.3019071$，所以 $F_{0}(x_{(3)})\\approx 0.260921$。\n- $x_{(4)}=0.91$：$\\frac{\\pi}{4}x_{(4)}^{2}\\approx 0.6503882$，所以 $F_{0}(x_{(4)})\\approx 0.478157$。\n- $x_{(5)}=1.15$：$\\frac{\\pi}{4}x_{(5)}^{2}\\approx 1.0386891$，所以 $F_{0}(x_{(5)})\\approx 0.646065$。\n- $x_{(6)}=1.30$：$\\frac{\\pi}{4}x_{(6)}^{2}\\approx 1.3273229$，所以 $F_{0}(x_{(6)})\\approx 0.734484$。\n- $x_{(7)}=1.75$：$\\frac{\\pi}{4}x_{(7)}^{2}\\approx 2.4052819$，所以 $F_{0}(x_{(7)})\\approx 0.909760$。\n- $x_{(8)}=2.40$：$\\frac{\\pi}{4}x_{(8)}^{2}\\approx 4.5238934$，所以 $F_{0}(x_{(8)})\\approx 0.989153$。\n\n现在使用 $i/n$ 和 $(i-1)/n$（其中 $n=8$）来计算 $D^{+}$ 和 $D^{-}$：\n- $i=1$：$D^{+}_{1}=0.125-0.025126=0.099874$，$D^{-}_{1}=0.025126-0=0.025126$。\n- $i=2$：$D^{+}_{2}=0.25-0.147068=0.102932$，$D^{-}_{2}=0.147068-0.125=0.022068$。\n- $i=3$：$D^{+}_{3}=0.375-0.260921=0.114079$，$D^{-}_{3}=0.260921-0.25=0.010921$。\n- $i=4$：$D^{+}_{4}=0.5-0.478157=0.021843$，$D^{-}_{4}=0.478157-0.375=0.103157$。\n- $i=5$：$D^{+}_{5}=0.625-0.646065=-0.021065$（对最大值无贡献），$D^{-}_{5}=0.646065-0.5=0.146065$。\n- $i=6$：$D^{+}_{6}=0.75-0.734484=0.015516$，$D^{-}_{6}=0.734484-0.625=0.109484$。\n- $i=7$：$D^{+}_{7}=0.875-0.909760=-0.034760$（无贡献），$D^{-}_{7}=0.909760-0.75=0.159760$。\n- $i=8$：$D^{+}_{8}=1-0.989153=0.010847$，$D^{-}_{8}=0.989153-0.875=0.114153$。\n\n因此，\n$$\nD^{+}=\\max\\{0.099874,0.102932,0.114079,0.021843,0.015516,0.010847\\}=0.114079,\n$$\n$$\nD^{-}=\\max\\{0.025126,0.022068,0.010921,0.103157,0.146065,0.109484,0.159760,0.114153\\}=0.159760.\n$$\n所以，\n$$\nD_{n}=\\max(D^{+},D^{-})=0.159760\\approx 0.1598\\ (\\text{保留四位有效数字})。\n$$", "answer": "$$\\boxed{0.1598}$$", "id": "1927852"}]}