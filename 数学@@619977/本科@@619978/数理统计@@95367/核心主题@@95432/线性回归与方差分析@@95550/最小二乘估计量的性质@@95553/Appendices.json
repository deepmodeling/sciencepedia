{"hands_on_practices": [{"introduction": "在实践中，我们变量的单位往往是任意选择的（例如，米或公里）。本练习 [@problem_id:1948136] 旨在探讨重新缩放（rescaling）预测变量如何影响斜率和截距的最小二乘估计量。理解这种关系对于正确解释回归输出以及比较使用不同尺度变量的模型至关重要。", "problem": "考虑一个简单的线性回归模型，用于描述响应变量 $Y$ 和预测变量 $x$ 之间的关系。对于一组 $n$ 个观测值 $(x_i, Y_i)$，其模型由下式给出\n$$Y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i, \\quad i = 1, 2, \\ldots, n$$\n其中 $\\beta_0$ 和 $\\beta_1$ 分别是截距和斜率参数。误差项 $\\epsilon_i$ 被假定为独立同分布的随机变量，其均值为 $E[\\epsilon_i] = 0$，方差为 $\\text{Var}(\\epsilon_i) = \\sigma^2$。原始模型的最小二乘估计量记为 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$。\n\n一位研究人员决定通过乘以一个非零常数 $c$ 来重新缩放预测变量。定义一个新的预测变量 $x_i'$ 为 $x_i' = c x_i$。然后使用这个经过缩放的预测变量进行新的回归，模型如下：\n$$Y_i = \\beta_0' + \\beta_1' x_i' + \\epsilon_i$$\n这个新模型的最小二乘估计量记为 $\\hat{\\beta}_0'$ 和 $\\hat{\\beta}_1'$。\n\n新估计量（$\\hat{\\beta}_0'$、$\\hat{\\beta}_1'$）与原始估计量（$\\hat{\\beta}_0$、$\\hat{\\beta}_1$）之间有什么关系？新斜率估计量的方差 $\\text{Var}(\\hat{\\beta}_1')$ 与原始斜率估计量的方差 $\\text{Var}(\\hat{\\beta}_1)$ 之间又有什么关系？\n\nA. $\\hat{\\beta}_0' = \\hat{\\beta}_0$, $\\hat{\\beta}_1' = \\frac{\\hat{\\beta}_1}{c}$, and $\\text{Var}(\\hat{\\beta}_1') = \\frac{\\text{Var}(\\hat{\\beta}_1)}{c^2}$\n\nB. $\\hat{\\beta}_0' = c\\hat{\\beta}_0$, $\\hat{\\beta}_1' = c\\hat{\\beta}_1$, and $\\text{Var}(\\hat{\\beta}_1') = c^2\\text{Var}(\\hat{\\beta}_1)$\n\nC. $\\hat{\\beta}_0' = \\hat{\\beta}_0$, $\\hat{\\beta}_1' = c\\hat{\\beta}_1$, and $\\text{Var}(\\hat{\\beta}_1') = c^2\\text{Var}(\\hat{\\beta}_1)$\n\nD. $\\hat{\\beta}_0' = \\frac{\\hat{\\beta}_0}{c}$, $\\hat{\\beta}_1' = \\frac{\\hat{\\beta}_1}{c}$, and $\\text{Var}(\\hat{\\beta}_1') = \\frac{\\text{Var}(\\hat{\\beta}_1)}{c^2}$\n\nE. $\\hat{\\beta}_0' = \\hat{\\beta}_0$, $\\hat{\\beta}_1' = \\frac{\\hat{\\beta}_1}{c^2}$, and $\\text{Var}(\\hat{\\beta}_1') = \\frac{\\text{Var}(\\hat{\\beta}_1)}{c^4}", "solution": "我们从原始的简单线性回归模型开始\n$$\nY_i=\\beta_{0}+\\beta_{1}x_i+\\epsilon_i,\\quad i=1,2,\\ldots,n,\n$$\n其中 $E[\\epsilon_i]=0$ 且 $\\text{Var}(\\epsilon_i)=\\sigma^{2}$。普通最小二乘 (OLS) 的斜率和截距估计量可以写成\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}},\\quad \\hat{\\beta}_{0}=\\bar{Y}-\\hat{\\beta}_{1}\\bar{x},\n$$\n其中\n$$\nS_{xy}=\\sum_{i=1}^{n}(x_i-\\bar{x})(Y_i-\\bar{Y}),\\quad S_{xx}=\\sum_{i=1}^{n}(x_i-\\bar{x})^{2},\n$$\n以及 $\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_i$, $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_i$。\n\n现在定义重新缩放的预测变量 $x_i'=c\\,x_i$（其中 $c\\neq 0$），并拟合模型\n$$\nY_i=\\beta_{0}'+\\beta_{1}'x_i'+\\epsilon_i.\n$$\n相应的样本均值满足 $\\bar{x}'=c\\,\\bar{x}$。对于变换后的和，注意到\n$$\nx_i'-\\bar{x}'=c(x_i-\\bar{x}),\n$$\n所以\n$$\nS_{x'y}=\\sum_{i=1}^{n}(x_i'-\\bar{x}')(Y_i-\\bar{Y})=\\sum_{i=1}^{n}c(x_i-\\bar{x})(Y_i-\\bar{Y})=c\\,S_{xy},\n$$\n以及\n$$\nS_{x'x'}=\\sum_{i=1}^{n}(x_i'-\\bar{x}')^{2}=\\sum_{i=1}^{n}c^{2}(x_i-\\bar{x})^{2}=c^{2}S_{xx}.\n$$\n因此，新的 OLS 斜率是\n$$\n\\hat{\\beta}_{1}'=\\frac{S_{x'y}}{S_{x'x'}}=\\frac{c\\,S_{xy}}{c^{2}S_{xx}}=\\frac{1}{c}\\hat{\\beta}_{1}.\n$$\n新的截距是\n$$\n\\hat{\\beta}_{0}'=\\bar{Y}-\\hat{\\beta}_{1}'\\bar{x}'=\\bar{Y}-\\left(\\frac{1}{c}\\hat{\\beta}_{1}\\right)(c\\,\\bar{x})=\\bar{Y}-\\hat{\\beta}_{1}\\bar{x}=\\hat{\\beta}_{0}.\n$$\n\n对于同方差模型下斜率估计量的方差，标准公式给出\n$$\n\\text{Var}(\\hat{\\beta}_{1})=\\frac{\\sigma^{2}}{S_{xx}},\\quad \\text{and}\\quad \\text{Var}(\\hat{\\beta}_{1}')=\\frac{\\sigma^{2}}{S_{x'x'}}=\\frac{\\sigma^{2}}{c^{2}S_{xx}}=\\frac{1}{c^{2}}\\text{Var}(\\hat{\\beta}_{1}).\n$$\n等价地，因为 $\\hat{\\beta}_{1}'=(1/c)\\hat{\\beta}_{1}$ 且 $c$ 是确定性的，所以 $\\text{Var}(\\hat{\\beta}_{1}')=(1/c^{2})\\text{Var}(\\hat{\\beta}_{1})$。\n\n因此，这些关系是 $\\hat{\\beta}_{0}'=\\hat{\\beta}_{0}$、$\\hat{\\beta}_{1}'=\\hat{\\beta}_{1}/c$ 和 $\\text{Var}(\\hat{\\beta}_{1}')=\\text{Var}(\\hat{\\beta}_{1})/c^{2}$，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1948136"}, {"introduction": "线性回归的一个核心假设是模型正确地指定了变量之间的关系。但如果这个假设被违反了会发生什么？这个问题 [@problem_id:1948138] 探讨了当我们错误地将一个线性模型拟合到由二次过程生成的数据时，斜率估计量所产生的偏差，这是一个被称为“模型设定偏误” (misspecification bias) 的基本概念。", "problem": "一位研究人员正在研究一个物理过程，其中响应变量 $Y$ 理论上预期与预测变量 $x$ 存在通过原点的二次关系。对于一组 $n$ 个观测值，其数据生成过程由以下模型正确描述：\n$$Y_i = \\beta_1 x_i^2 + \\epsilon_i, \\quad \\text{for } i = 1, \\dots, n$$\n其中 $\\beta_1$ 是一个非零实常数，预测变量值 $x_i$ 被视为固定的已知常数，而 $\\epsilon_i$ 是独立同分布的随机误差，满足 $E[\\epsilon_i] = 0$ 和 $Var(\\epsilon_i) = \\sigma^2$。\n\n然而，该研究人员并未意识到真实模型，而是使用普通最小二乘法（OLS）对数据拟合了一个简单线性回归模型：\n$$Y_i = \\alpha_0 + \\alpha_1 x_i + \\nu_i$$\n设 $\\hat{\\alpha}_1$ 为斜率参数 $\\alpha_1$ 的OLS估计量。你的任务是推导该估计量的期望值 $E[\\hat{\\alpha}_1]$ 的表达式。\n\n请用真实参数 $\\beta_1$、样本量 $n$ 以及预测变量的以下汇总统计量来表示你的答案：$S_1 = \\sum_{i=1}^n x_i$，$S_2 = \\sum_{i=1}^n x_i^2$ 和 $S_3 = \\sum_{i=1}^n x_i^3$。", "solution": "我们从真实的数据生成模型 $Y_{i}=\\beta_{1}x_{i}^{2}+\\epsilon_{i}$（其中 $E[\\epsilon_{i}]=0$ 且 $Var(\\epsilon_{i})=\\sigma^{2}$）开始，研究人员拟合了带有截距的设定错误的线性模型：\n$$\nY_{i}=\\alpha_{0}+\\alpha_{1}x_{i}+\\nu_{i}。\n$$\n设 $x_{i}$ 为固定常数，并定义 $\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}=\\frac{S_{1}}{n}$ 和 $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$。在带有截距的模型中，普通最小二乘法（OLS）的斜率估计量为\n$$\n\\hat{\\alpha}_{1}=\\frac{S_{xy}}{S_{xx}},\n$$\n其中\n$$\nS_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})(Y_{i}-\\bar{Y}), \\quad S_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}。\n$$\n因为 $x_{i}$ 是固定的，所以 $S_{xx}$ 是非随机的。此外，由于 $\\sum_{i=1}^{n}(x_{i}-\\bar{x})=0$，我们可以将 $S_{xy}$ 写为\n$$\nS_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})Y_{i}。\n$$\n对误差取期望，并使用 $E[Y_{i}]=\\beta_{1}x_{i}^{2}$，我们得到\n$$\nE[S_{xy}]=\\sum_{i=1}^{n}(x_{i}-\\bar{x})E[Y_{i}]\n=\\sum_{i=1}^{n}(x_{i}-\\bar{x})\\beta_{1}x_{i}^{2}\n=\\beta_{1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})x_{i}^{2}。\n$$\n现在简化求和项：\n$$\n\\sum_{i=1}^{n}(x_{i}-\\bar{x})x_{i}^{2}=\\sum_{i=1}^{n}x_{i}^{3}-\\bar{x}\\sum_{i=1}^{n}x_{i}^{2}\n=S_{3}-\\frac{S_{1}}{n}S_{2}。\n$$\n因此，\n$$\nE[S_{xy}]=\\beta_{1}\\left(S_{3}-\\frac{S_{1}S_{2}}{n}\\right)。\n$$\n接下来，用 $S_{1}$ 和 $S_{2}$ 计算 $S_{xx}$：\n$$\nS_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}=\\sum_{i=1}^{n}x_{i}^{2}-n\\bar{x}^{2}\n=S_{2}-\\frac{S_{1}^{2}}{n}。\n$$\n因此，由于 $S_{xx}$ 是非随机的，\n$$\nE[\\hat{\\alpha}_{1}]=\\frac{E[S_{xy}]}{S_{xx}}\n=\\frac{\\beta_{1}\\left(S_{3}-\\frac{S_{1}S_{2}}{n}\\right)}{S_{2}-\\frac{S_{1}^{2}}{n}}\n=\\beta_{1}\\,\\frac{nS_{3}-S_{1}S_{2}}{nS_{2}-S_{1}^{2}}。\n$$\n这就将在设定错误的线性模型下OLS斜率的期望值表示为了 $\\beta_{1}$、$n$、$S_{1}$、$S_{2}$ 和 $S_{3}$ 的函数。", "answer": "$$\\boxed{\\beta_{1}\\,\\frac{nS_{3}-S_{1}S_{2}}{nS_{2}-S_{1}^{2}}}$$", "id": "1948138"}, {"introduction": "在多元回归中，当存在其他预测变量时，我们如何解释单个系数的含义？这个练习 [@problem_id:1948175] 将通过一个强大的定理（Frisch-Waugh-Lovell 定理）向我们展示，多元回归系数可以通过一系列更简单的回归来计算。这种“部分剔除”（partialling out）的过程，为我们理解“控制”混淆变量的真正含义提供了深刻而直观的洞察。", "problem": "一位数据科学家正在为一个服务器的中央处理器（CPU）负载建模。该模型旨在基于两个预测变量来预测CPU负载（$Y$，以百分比计）：活跃用户会话数（$X_1$）和网络带宽利用率（$X_2$，单位为 Mbps）。多元线性回归模型由下式给出：\n$$\nY_i = \\beta_0 + \\beta_1 X_{i1} + \\beta_2 X_{i2} + \\epsilon_i\n$$\n其中 $\\epsilon_i$ 是均值为零的独立同分布误差项，下标 $i$ 表示来自 $n$ 个观测值样本中的第 $i$ 个观测值。\n\n该科学家特别感兴趣的是，在考虑了网络带宽（$X_2$）的影响后，量化活跃用户会话数（$X_1$）对CPU负载的独特贡献。为了研究这一点，他们执行了两次初步的普通最小二乘法（OLS）回归。\n\n首先，他们将CPU负载（$Y$）对截距项和网络带宽（$X_2$）进行回归。设此次回归的残差由向量 $r_Y$ 表示。\n其次，他们将活跃用户会话数（$X_1$）对截距项和网络带宽（$X_2$）进行回归。设这第二次回归的残差由向量 $r_{X_1}$ 表示。\n\n从这两组残差中，计算出以下汇总统计量：\n- 第二次回归的残差平方和：$\\sum_{i=1}^{n} (r_{X_1,i})^2 = 88.4$。\n- 两次回归对应残差的乘积和：$\\sum_{i=1}^{n} r_{Y,i} \\, r_{X_1,i} = 153.7$。\n\n仅使用这些汇总统计量，确定完整多元回归模型中系数 $\\beta_1$ 的OLS估计值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们的目标是在 $Y$ 对截距项、$X_{1}$ 和 $X_{2}$ 的多元回归中估计 $\\hat{\\beta}_{1}$。根据 Frisch–Waugh–Lovell 定理，OLS 估计值 $\\hat{\\beta}_{1}$ 等于将 $Y$ 对 $[1, X_{2}]$ 回归的残差，对 $X_{1}$ 对 $[1, X_{2}]$ 回归的残差进行回归所得的斜率。将包含截距项和 $X_{2}$ 列的矩阵记为 $Z$，并定义残差生成矩阵 $M_{Z} = I - Z(Z^{\\top}Z)^{-1}Z^{\\top}$。那么\n$$\nr_{Y} = M_{Z}Y, \\quad r_{X_{1}} = M_{Z}X_{1}.\n$$\n在没有截距项的情况下，$r_{Y}$ 对 $r_{X_{1}}$ 回归的 OLS 系数最小化了\n$$\nS(\\alpha) = \\|r_{Y} - \\alpha r_{X_{1}}\\|^{2} = (r_{Y} - \\alpha r_{X_{1}})^{\\top}(r_{Y} - \\alpha r_{X_{1}}).\n$$\n求导并令其为零可得\n$$\n\\frac{dS}{d\\alpha} = -2 r_{X_{1}}^{\\top} r_{Y} + 2 \\alpha \\, r_{X_{1}}^{\\top} r_{X_{1}} = 0 \\;\\;\\Rightarrow\\;\\; \\hat{\\alpha} = \\frac{r_{X_{1}}^{\\top} r_{Y}}{r_{X_{1}}^{\\top} r_{X_{1}}}.\n$$\n根据 Frisch–Waugh–Lovell 定理，$\\hat{\\beta}_{1} = \\hat{\\alpha}$。使用所提供的汇总统计量，\n$$\nr_{X_{1}}^{\\top} r_{X_{1}} = \\sum_{i=1}^{n} (r_{X_{1},i})^{2} = 88.4, \\quad r_{X_{1}}^{\\top} r_{Y} = \\sum_{i=1}^{n} r_{X_{1},i} r_{Y,i} = 153.7,\n$$\n所以\n$$\n\\hat{\\beta}_{1} = \\frac{153.7}{88.4} \\approx 1.7386877828\\ldots\n$$\n四舍五入到三位有效数字，\n$$\n\\hat{\\beta}_{1} \\approx 1.74.\n$$", "answer": "$$\\boxed{1.74}$$", "id": "1948175"}]}