{"hands_on_practices": [{"introduction": "在回归分析中，首要任务之一是确定变量之间是否存在显著的线性关系。这个练习将带你亲手实践回归参数推断中最基本也是最重要的技能：对斜率系数进行假设检验。通过一个关于生物刺激素对作物产量影响的假设性场景，你将从原始的汇总统计数据出发，一步步计算出用于检验斜率 $\\beta_1$ 是否显著大于零的 $t$ 统计量，从而掌握检验自变量与因变量关系显著性的核心方法。[@problem_id:1923256]", "problem": "一个农业研究所正在研究一种新型生物刺激素对藜麦产量的影响。在一项对照实验中，对 $n=20$ 块相同的土地施用了不同量的生物刺激素。提出了一个简单线性回归模型 $Y = \\beta_0 + \\beta_1 x + \\epsilon$，用来关联藜麦产量 $Y$（单位：公斤/公顷）与所施用的生物刺激素的量 $x$（单位：升/公顷）。随机误差 $\\epsilon$ 假定为相互独立且服从均值为0、方差恒为 $\\sigma^2$ 的正态分布。\n\n研究人员想要确定是否有证据表明该生物刺激素对产量有积极影响。为此，他们将对回归线的斜率进行假设检验。\n\n根据实验数据，计算出以下汇总统计量：\n- $\\sum_{i=1}^{20} x_i = 100$\n- $\\sum_{i=1}^{20} y_i = 35000$\n- $\\sum_{i=1}^{20} x_i^2 = 620$\n- $\\sum_{i=1}^{20} y_i^2 = 61850000$\n- $\\sum_{i=1}^{20} x_i y_i = 181000$\n\n计算用于检验原假设 $H_0: \\beta_1 = 0$ 与备择假设 $H_a: \\beta_1 > 0$ 的检验统计量的值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用 $t$ 统计量来检验 $H_{0}: \\beta_{1}=0$ 与 $H_{a}: \\beta_{1}>0$。\n$$\nt=\\frac{\\hat{\\beta}_{1}-0}{\\operatorname{SE}(\\hat{\\beta}_{1})}\n$$\n对于简单线性回归，我们首先计算所需的各项平方和：\n$$\nS_{xx}=\\sum x_{i}^{2}-\\frac{\\left(\\sum x_{i}\\right)^{2}}{n} = 620-\\frac{100^{2}}{20}=620-500=120\n$$\n$$\nS_{yy}=\\sum y_{i}^{2}-\\frac{\\left(\\sum y_{i}\\right)^{2}}{n} = 61850000-\\frac{35000^{2}}{20}=61850000-61250000=600000\n$$\n$$\nS_{xy}=\\sum x_{i}y_{i}-\\frac{\\left(\\sum x_{i}\\right)\\left(\\sum y_{i}\\right)}{n} = 181000-\\frac{(100)(35000)}{20}=181000-175000=6000\n$$\n斜率的估计值为：\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}}=\\frac{6000}{120}=50\n$$\n误差平方和 (SSE) 为：\n$$\n\\text{SSE}=S_{yy}-\\hat{\\beta}_{1}S_{xy}=600000-(50)(6000)=300000\n$$\n误差方差的估计值 $\\hat{\\sigma}^2$ 为：\n$$\n\\hat{\\sigma}^{2}=\\frac{\\text{SSE}}{n-2}=\\frac{300000}{18}=\\frac{50000}{3}\n$$\n$\\hat{\\beta}_{1}$ 的标准误为：\n$$\n\\operatorname{SE}(\\hat{\\beta}_{1})=\\sqrt{\\frac{\\hat{\\sigma}^{2}}{S_{xx}}}=\\sqrt{\\frac{50000/3}{120}}=\\sqrt{\\frac{5000}{36}} = \\frac{\\sqrt{5000}}{6}\n$$\n因此，检验统计量为：\n$$\nt=\\frac{\\hat{\\beta}_{1}}{\\operatorname{SE}(\\hat{\\beta}_{1})} = \\frac{50}{\\sqrt{5000}/6} = \\frac{300}{\\sqrt{5000}} = \\frac{300}{50\\sqrt{2}} = \\frac{6}{\\sqrt{2}} = 3\\sqrt{2} \\approx 4.2426\n$$\n自由度为 $n-2=18$。将检验统计量的值四舍五入到三位有效数字，我们得到 4.24。", "answer": "$$\\boxed{4.24}$$", "id": "1923256"}, {"introduction": "一旦我们确认变量间存在显著关系，下一个自然的问题就是：如何利用这个模型进行具体的预测？这个练习将焦点从假设检验转移到区间估计，指导你如何为一个特定的预测变量值构建平均响应的置信区间。通过分析线上辅导平台使用时长与学生成绩的案例，你将学会如何量化我们预测的确定性，这是在商业预测和科学研究中至关重要的技能。[@problem_id:1923200]", "problem": "一所大学的数据科学团队正在分析一个新的在线辅导平台的使用情况与学生在一门具有挑战性的物理入门课程中的表现之间的关系。他们从一个由25名学生组成的随机样本中收集数据。令 $Y$ 为课程的最终成绩（满分100分的数值分数），令 $X$ 为学生每周使用该辅导平台的平均小时数。\n\n该团队拟合了一个形式为 $Y_i = \\beta_0 + \\beta_1 X_i + \\epsilon_i$ 的简单线性回归模型，其中误差 $\\epsilon_i$ 假定为独立且服从均值为0、方差恒为 $\\sigma^2$ 的正态分布。\n\n从这25名学生的样本中，分析得出以下汇总统计数据：\n- 估计的截距：$\\hat{\\beta}_0 = 63.0$\n- 估计的斜率：$\\hat{\\beta}_1 = 3.0$\n- 每周小时数的样本均值：$\\bar{x} = 4.0$ 小时\n- 每周小时数的离差平方和：$S_{xx} = \\sum_{i=1}^{25} (x_i - \\bar{x})^2 = 100.0 \\text{ 小时}^2$\n- 回归的标准误：$s_e = 5.0$ 分\n\n使用这些信息，为所有每周在该平台上花费恰好 $x_0 = 5.0$ 小时的学生子群体的真实平均最终成绩构建一个95%的置信区间。此计算所需的t分布的临界值为 $t_{0.025, 23} = 2.069$。\n\n按顺序提供置信区间的下限和上限。将您的最终答案四舍五入到四位有效数字。", "solution": "我们拟合简单线性回归模型 $Y_{i}=\\beta_{0}+\\beta_{1}X_{i}+\\epsilon_{i}$，其中 $\\epsilon_{i}\\sim \\mathcal{N}(0,\\sigma^{2})$ 且相互独立。在 $x_{0}$ 处的平均响应为 $\\mu_{Y|X=x_{0}}=\\beta_{0}+\\beta_{1}x_{0}$，其估计值为 $\\hat{Y}(x_{0})=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x_{0}$。对于 $x_{0}=5.0$，点估计为\n$$\n\\hat{Y}(5)=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}\\cdot 5=63.0+3.0\\cdot 5=78.0.\n$$\n在 $x_{0}$ 处估计的平均响应的标准误为\n$$\n\\operatorname{SE}\\big(\\hat{Y}(x_{0})\\big)=s_{e}\\sqrt{\\frac{1}{n}+\\frac{(x_{0}-\\bar{x})^{2}}{S_{xx}}},\n$$\n其中 $n=25$，$\\bar{x}=4.0$，$S_{xx}=100.0$ 且 $s_{e}=5.0$。将这些值代入 $x_{0}=5.0$ 可得\n$$\n\\operatorname{SE}\\big(\\hat{Y}(5)\\big)=5.0\\sqrt{\\frac{1}{25}+\\frac{(5.0-4.0)^{2}}{100.0}}=5.0\\sqrt{0.04+0.01}=5.0\\sqrt{0.05}=\\frac{\\sqrt{5}}{2}.\n$$\n在 $x_{0}$ 处平均响应的双侧 $95\\%$ 置信区间为\n$$\n\\hat{Y}(x_{0})\\pm t_{0.025,\\,n-2}\\,\\operatorname{SE}\\big(\\hat{Y}(x_{0})\\big),\n$$\n其中 $t_{0.025,\\,23}=2.069$。因此，\n$$\n78.0\\pm 2.069\\cdot \\frac{\\sqrt{5}}{2}.\n$$\n计算边际误差，\n$$\n2.069\\cdot \\frac{\\sqrt{5}}{2}\\approx 2.3132123227,\n$$\n所以区间大约是\n$$\n[78.0-2.3132123227,\\;78.0+2.3132123227]=[75.6867876773,\\;80.3132123227].\n$$\n四舍五入到四位有效数字，得到下限和上限分别为 $75.69$ 和 $80.31$。", "answer": "$$\\boxed{\\begin{pmatrix} 75.69 & 80.31 \\end{pmatrix}}$$", "id": "1923200"}, {"introduction": "现实世界中的复杂现象往往由多个因素共同决定，因此多元线性回归是更强大的分析工具。这个练习将引导你从简单回归迈向多元回归，并掌握一种更为通用的假设检验方法——F检验。你将通过一个经济学模型，学习如何同时检验关于多个回归系数的复杂联合假设，这对于回答涉及多个变量相互关系的精细科学或经济问题至关重要。[@problem_id:1923209]", "problem": "一位经济学家正在研究某种特定农产品的价格。他们提出了一个多元线性回归模型，以根据几个因素来解释该商品的价格。该模型由下式给出：\n\n$$P_i = \\beta_0 + \\beta_1 S_i + \\beta_2 D_i + \\beta_3 I_i + \\epsilon_i$$\n\n其中，对于每个观测值 $i$：\n- $P_i$ 是商品的价格。\n- $S_i$ 是总供给的度量。\n- $D_i$ 是总需求的度量。\n- $I_i$ 是一个综合通货膨胀指数。\n- $\\epsilon_i$ 是误差项，假设为独立同分布 (i.i.d.) 的正态随机变量，其均值为 0，方差为 $\\sigma^2$。\n\n该模型使用普通最小二乘法 (OLS) 对一个包含 $n=54$ 个观测值的数据集进行拟合。对完整模型的分析得出了以下结果：\n\n估计的系数向量为 $\\hat{\\boldsymbol{\\beta}} = (\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_2, \\hat{\\beta}_3)^T = (10.5, -2.1, 3.2, 1.5)^T$。\n\n完整模型的误差平方和为 $SSE_F = 450.0$。\n\n如果 $\\mathbf{X}$ 是模型的设计矩阵，则矩阵 $(\\mathbf{X}^T\\mathbf{X})^{-1}$ 由下式给出：\n$$ (\\mathbf{X}^T\\mathbf{X})^{-1} = \\begin{pmatrix} 0.8 & -0.1 & -0.2 & 0.05 \\\\ -0.1 & 0.5 & 0.1 & -0.1 \\\\ -0.2 & 0.1 & 0.6 & -0.2 \\\\ 0.05 & -0.1 & -0.2 & 0.4 \\end{pmatrix} $$\n\n该经济学家希望检验一个特定的联合原假设 $H_0$，该假设包含两个论断：\n1. 供给的影响与需求的影响大小相等、方向相反。\n2. 通货膨胀指数的影响恰好为 1.0。\n\n计算用于检验此联合原假设的 F 统计量的值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用一般线性 F 检验来检验该联合线性假设。该假设可以表示为：\n$$H_{0}:\\ \\beta_{1}+\\beta_{2}=0,\\ \\ \\text{且}\\ \\ \\beta_{3}=1$$\n我们可以将此假设写成矩阵形式 $\\mathbf{R}\\boldsymbol{\\beta} = \\mathbf{r}$。考虑到参数顺序为 $(\\beta_{0},\\beta_{1},\\beta_{2},\\beta_{3})$，限制矩阵 $\\mathbf{R}$ 和向量 $\\mathbf{r}$ 为：\n$$\n\\mathbf{R}=\\begin{pmatrix}\n0 & 1 & 1 & 0\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix},\\quad\n\\mathbf{r}=\\begin{pmatrix}\n0\\\\\n1\n\\end{pmatrix}.\n$$\nF 统计量的通用公式是：\n$$\nF=\\frac{(\\mathbf{R}\\hat{\\boldsymbol{\\beta}}-\\mathbf{r})^{T}\\left[\\mathbf{R}(\\mathbf{X}^{T}\\mathbf{X})^{-1}\\mathbf{R}^{T}\\right]^{-1}(\\mathbf{R}\\hat{\\boldsymbol{\\beta}}-\\mathbf{r})}{q} \\Big/ \\frac{SSE_F}{n-p}\n$$\n其中 $q=2$ 是限制条件的数量，$n=54$ 是观测数量，$p=4$ 是模型中的参数数量（包括截距）。\n\n首先，计算分子中的差异向量 $\\mathbf{d}=\\mathbf{R}\\hat{\\boldsymbol{\\beta}}-\\mathbf{r}$：\n$$\n\\mathbf{d}=\\mathbf{R}\\hat{\\boldsymbol{\\beta}}-\\mathbf{r}\n=\\begin{pmatrix} \\hat{\\beta}_{1}+\\hat{\\beta}_{2} \\\\ \\hat{\\beta}_{3} \\end{pmatrix}-\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n=\\begin{pmatrix} -2.1+3.2 \\\\ 1.5 \\end{pmatrix}-\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n=\\begin{pmatrix} 1.1 \\\\ 0.5 \\end{pmatrix}.\n$$\n接着，计算中间的矩阵 $\\mathbf{S}=\\mathbf{R}(\\mathbf{X}^{T}\\mathbf{X})^{-1}\\mathbf{R}^{T}$：\n$$\n\\mathbf{S}=\\mathbf{R}(\\mathbf{X}^{T}\\mathbf{X})^{-1}\\mathbf{R}^{T}\n=\\begin{pmatrix}\n0 & 1 & 1 & 0\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix} 0.8 & -0.1 & -0.2 & 0.05 \\\\ -0.1 & 0.5 & 0.1 & -0.1 \\\\ -0.2 & 0.1 & 0.6 & -0.2 \\\\ 0.05 & -0.1 & -0.2 & 0.4 \\end{pmatrix}\n\\begin{pmatrix}\n0 & 0\\\\\n1 & 0\\\\\n1 & 0\\\\\n0 & 1\n\\end{pmatrix}\n=\\begin{pmatrix}\n0.5+0.1 & -0.1-0.2\\\\\n-0.1-0.2 & 0.4\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.6 & -0.3\\\\\n-0.3 & 0.4\n\\end{pmatrix}.\n$$\n抱歉，对 $\\mathbf{S}$ 的计算有误。让我们重新计算 $\\mathbf{R}(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{R}^T$。\n$s_{11} = (\\text{var}(\\hat{\\beta}_1) + \\text{var}(\\hat{\\beta}_2) + 2\\text{cov}(\\hat{\\beta}_1, \\hat{\\beta}_2)) = 0.5 + 0.6 + 2(0.1) = 1.3$\n$s_{22} = \\text{var}(\\hat{\\beta}_3) = 0.4$\n$s_{12} = s_{21} = \\text{cov}(\\hat{\\beta}_1+\\hat{\\beta}_2, \\hat{\\beta}_3) = \\text{cov}(\\hat{\\beta}_1, \\hat{\\beta}_3) + \\text{cov}(\\hat{\\beta}_2, \\hat{\\beta}_3) = -0.1 + (-0.2) = -0.3$\n所以矩阵 $\\mathbf{S}$ 应该是：\n$$\n\\mathbf{S}=\\begin{pmatrix}\n1.3 & -0.3\\\\\n-0.3 & 0.4\n\\end{pmatrix}\n$$\n其逆矩阵为：\n$$\n\\mathbf{S}^{-1}=\\frac{1}{(1.3)(0.4)-(-0.3)^2}\\begin{pmatrix} 0.4 & 0.3\\\\ 0.3 & 1.3 \\end{pmatrix}\n=\\frac{1}{0.52-0.09}\\begin{pmatrix} 0.4 & 0.3\\\\ 0.3 & 1.3 \\end{pmatrix}\n=\\frac{1}{0.43}\\begin{pmatrix} 0.4 & 0.3\\\\ 0.3 & 1.3 \\end{pmatrix}.\n$$\n现在计算二次型项 $Q = \\mathbf{d}^{T}\\mathbf{S}^{-1}\\mathbf{d}$：\n$$\nQ=(1.1, 0.5) \\left[ \\frac{1}{0.43}\\begin{pmatrix} 0.4 & 0.3\\\\ 0.3 & 1.3 \\end{pmatrix} \\right] \\begin{pmatrix} 1.1 \\\\ 0.5 \\end{pmatrix}\n=\\frac{1}{0.43}(1.1, 0.5) \\begin{pmatrix} (0.4)(1.1) + (0.3)(0.5) \\\\ (0.3)(1.1) + (1.3)(0.5) \\end{pmatrix}\n=\\frac{1}{0.43}(1.1, 0.5) \\begin{pmatrix} 0.59 \\\\ 0.98 \\end{pmatrix}\n$$\n$$\nQ = \\frac{1}{0.43} [ (1.1)(0.59) + (0.5)(0.98) ] = \\frac{0.649 + 0.49}{0.43} = \\frac{1.139}{0.43} \\approx 2.648837.\n$$\nF 统计量的分母是均方误差 (MSE)，$\\hat{\\sigma}^{2}$：\n$$\n\\hat{\\sigma}^{2}=\\frac{SSE_{F}}{n-p}=\\frac{450.0}{54-4}=\\frac{450}{50}=9.0.\n$$\n最后，计算 F 统计量：\n$$\nF=\\frac{Q/q}{\\hat{\\sigma}^{2}}=\\frac{2.648837 / 2}{9.0} = \\frac{1.3244185}{9.0} \\approx 0.147158.\n$$\n四舍五入到三位有效数字，F 统计量为 $0.147$。", "answer": "$$\\boxed{0.147}$$", "id": "1923209"}]}