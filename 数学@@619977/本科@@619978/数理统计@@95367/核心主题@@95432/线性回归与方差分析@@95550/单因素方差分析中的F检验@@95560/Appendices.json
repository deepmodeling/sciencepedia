{"hands_on_practices": [{"introduction": "掌握单因素方差分析（ANOVA）的第一步是熟悉其核心计算过程。这个练习将引导你从组间平方和（SSB）与组内平方和（SSW）出发，通过计算自由度、均方（$MSB$ 和 $MSW$），最终得出 $F$ 统计量。通过这个基于农业研究的实际场景，你将巩固 $F$ 检验的基本计算框架。[@problem_id:1960654]", "problem": "一个农业研究所正在进行一项研究，以比较四种新开发的有机肥料配方对某种作物产量的影响。实验共有20块相同的地块可供使用。这些地块被随机分成四组，每组5块地块分别施用四种不同肥料配方中的一种。在生长季结束时，测量每个地块的作物产量。\n\n对收集的数据进行统计分析后，得到以下信息：\n- 四个不同肥料组之间的作物产量变异，称为组间平方和，为85.5。\n- 每个肥料组内部的作物产量随机变异，称为组内平方和，为131.2。\n\n为了确定四个肥料组的平均作物产量之间是否存在统计学上的显著差异，需要计算F统计量，这是方差分析 (ANOVA) 的一部分。根据所提供的数据计算此F统计量的值。将最终答案四舍五入到三位有效数字。", "solution": "我们有一个包含四个组和总共 $N=20$ 个观测值的方差分析（ANOVA），因此组数 $k=4$。给定的组间平方和为 $\\text{SSB}=85.5$，组内平方和为 $\\text{SSW}=131.2$。\n\n单因素方差分析中的F统计量定义为\n$$\nF=\\frac{\\text{MSB}}{\\text{MSW}},\n$$\n其中组间均方为\n$$\n\\text{MSB}=\\frac{\\text{SSB}}{df_{\\text{between}}}=\\frac{\\text{SSB}}{k-1},\n$$\n组内均方为\n$$\n\\text{MSW}=\\frac{\\text{SSW}}{df_{\\text{within}}}=\\frac{\\text{SSW}}{N-k}.\n$$\n\n计算自由度：\n$$\ndf_{\\text{between}}=k-1=4-1=3, \\quad df_{\\text{within}}=N-k=20-4=16.\n$$\n\n计算均方：\n$$\n\\text{MSB}=\\frac{85.5}{3}=28.5, \\quad \\text{MSW}=\\frac{131.2}{16}=8.2.\n$$\n\n因此，F统计量为\n$$\nF=\\frac{28.5}{8.2}=\\frac{285}{82}\\approx 3.475609756\\ldots\n$$\n四舍五入到三位有效数字，\n$$\nF\\approx 3.48.\n$$", "answer": "$$\\boxed{3.48}$$", "id": "1960654"}, {"introduction": "为了真正理解一个统计概念，探索一些思想实验或极端情况往往非常有帮助。这个练习设定了一个特殊场景：所有样本组的均值完全相等。通过分析这种情况，你将更深刻地理解 $F$ 统计量的分子（组间均方 $MSB$）所代表的“组间变异”的本质，并揭示为何 $F$ 检验能够有效地衡量组间差异。[@problem_id:1960676]", "problem": "一个生物统计学家团队正在进行一项研究，以比较旨在降低收缩压的 $k$ 种新药物配方的功效。该研究涉及 $N$ 名受试者，他们被随机分配到 $k$ 个治疗组中的一个。设 $n_i$ 为第 $i$ 组的受试者人数，其中 $i=1, \\dots, k$。该研究的设计要求 $k \\ge 2$ 且每组至少有两名受试者，即对所有 $i$ 都有 $n_i \\ge 2$。\n\n治疗期结束后，测量每位受试者收缩压的降低值。设 $y_{ij}$ 为第 $i$ 组中第 $j$ 名受试者的测量值。第 $i$ 组血压降低值的样本均值记为 $\\bar{y}_{i.}$。\n\n在分析初步结果时，该团队观察到了一个奇特的结果：所有 $k$ 组的样本均值降低值完全相同。即 $\\bar{y}_{1.} = \\bar{y}_{2.} = \\dots = \\bar{y}_{k.}$。然而，至少有一个组内的测量值不完全相同，这意味着整个数据集内部存在非零的样本方差。\n\n该团队决定进行单因素方差分析（ANOVA）来正式检验各组均值之间是否存在差异。根据所有样本均值均相同的观察结果，他们将计算出的F统计量的数值是多少？", "solution": "在有 $k$ 个组且总样本量为 $N=\\sum_{i=1}^{k} n_{i}$ 的单因素方差分析中，定义组均值为 $\\bar{y}_{i.}=\\frac{1}{n_{i}}\\sum_{j=1}^{n_{i}} y_{ij}$，总均值为\n$$\n\\bar{y}_{..}=\\frac{1}{N}\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}} y_{ij}=\\frac{1}{N}\\sum_{i=1}^{k} n_{i}\\bar{y}_{i.}.\n$$\n组间平方和为\n$$\nSS_{\\text{B}}=\\sum_{i=1}^{k} n_{i}\\bigl(\\bar{y}_{i.}-\\bar{y}_{..}\\bigr)^{2}.\n$$\n根据所有样本均值均相同的观察，即 $\\bar{y}_{1.}=\\cdots=\\bar{y}_{k.}$，可以得出对于每一个 $i$ 都有 $\\bar{y}_{i.}=\\bar{y}_{..}$，因此\n$$\nSS_{\\text{B}}=\\sum_{i=1}^{k} n_{i}\\cdot 0^{2}=0.\n$$\n组内平方和为\n$$\nSS_{\\text{W}}=\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}}\\bigl(y_{ij}-\\bar{y}_{i.}\\bigr)^{2}.\n$$\n因为至少有一个组的测量值不完全相同，所以这个和中至少有一项为正，且所有项都非负，因此 $SS_{\\text{W}}>0$。\n\n均方为\n$$\nMS_{\\text{B}}=\\frac{SS_{\\text{B}}}{k-1}, \\qquad MS_{\\text{W}}=\\frac{SS_{\\text{W}}}{N-k}.\n$$\n因为 $k\\ge 2$，所以分母 $k-1>0$，因此 $MS_{\\text{B}}=0$。此外，由于每个 $n_{i}\\ge 2$ 且 $k\\ge 2$，我们有 $N\\ge 2k$，因此 $N-k\\ge k\\ge 2$，所以 $MS_{\\text{W}}$ 的分母为正，并且由于 $SS_{\\text{W}}>0$，可以得出 $MS_{\\text{W}}>0$。\n\n方差分析的F统计量为\n$$\nF=\\frac{MS_{\\text{B}}}{MS_{\\text{W}}}=\\frac{0}{MS_{\\text{W}}}=0.\n$$\n因此，计算出的F统计量为零。", "answer": "$$\\boxed{0}$$", "id": "1960676"}, {"introduction": "在进行假设检验之后，一个自然而然的问题是：如果真实的效应存在，我们的实验有多大把握能够检测到它？这个问题引出了统计功效（statistical power）的重要概念，这是实验设计的核心考量之一。本练习将 $F$ 检验的应用提升到新的层次，通过计算非中心性参数 $\\lambda$ 来量化实验检测特定效应大小的能力，让你体验如何在实验设计阶段就评估其有效性。[@problem_id:1960646]", "problem": "一家生物技术研究公司正在评估四种新的营养配方（$F_1, F_2, F_3, F_4$），用于培养一种特定的微藻菌株。主要关注的指标是藻类的比增长率。根据大量的先期研究，已知任何给定配方的增长率都服从正态分布，并且所有配方共享一个共同的总体方差 $\\sigma^2 = 0.0144$。\n\n该公司计划进行一项采用均衡设计的实验，对 $k=4$ 种配方中的每一种使用 $n=8$ 个独立的培养样本。将进行一项统计检验，以比较四种配方的平均增长率。原假设（$H_0: \\mu_1 = \\mu_2 = \\mu_3 = \\mu_4$，即所有四个平均增长率相等）将与其对立的备择假设（即至少有一个平均值不同）进行检验。该检验将在 $\\alpha = 0.05$ 的显著性水平下进行。检验统计量是组间均方与组内均方之比。\n\n研究人员希望评估其实验设计的灵敏度。他们特别感兴趣的是其检测一个具有实际重要性的特定情景的能力，在该情景下，真实的平均增长率为 $\\mu_1 = 0.70$, $\\mu_2 = 0.75$, $\\mu_3 = 0.80$, 和 $\\mu_4 = 0.75$。\n\n计算在该特定的备择情景下，实验将正确拒绝原假设的概率。\n\n为了您的计算，提供了以下信息：\n- 在 $\\alpha=0.05$ 显著性水平下，检验的临界值为 $F_c = 2.947$。\n- 设 $X$ 是一个随机变量，服从自由度为 $\\nu_1, \\nu_2$、非中心参数为 $\\lambda$ 的非中心F分布。其累积分布函数记为 $F_{\\nu_1, \\nu_2, \\lambda}(x)$。对于与本问题相关的特定参数，已知 $F_{\\nu_1, \\nu_2, \\lambda}(F_c) = 0.1983$。\n\n报告你的答案，保留四位有效数字。", "solution": "该问题要求计算单因素方差分析（ANOVA）F检验的功效。功效是在特定的备择假设 $H_1$ 为真时，正确拒绝原假设 $H_0$ 的概率。\n\n首先，我们确定实验设计的参数。我们有 $k=4$ 个组（配方），每个组有 $n=8$ 个观测值。总观测数为 $N = kn = 4 \\times 8 = 32$。共同总体方差为 $\\sigma^2 = 0.0144$。显著性水平为 $\\alpha = 0.05$。\n\n单因素方差分析的检验统计量为 $F = \\frac{MSB}{MSW}$，其中 $MSB$ 是组间均方，$MSW$ 是组内均方。在原假设 $H_0: \\mu_1 = \\mu_2 = \\mu_3 = \\mu_4$ 下，F统计量服从自由度为 $\\nu_1 = k-1 = 4-1 = 3$ 和 $\\nu_2 = N-k = 32-4 = 28$ 的中心F分布。如果观测到的F统计量超过临界值 $F_c = 2.947$，则检验拒绝 $H_0$。\n\n在给定的特定备择假设下，即真实平均值为 $\\mu_1 = 0.70, \\mu_2 = 0.75, \\mu_3 = 0.80, \\mu_4 = 0.75$ 时，F统计量服从自由度为 $\\nu_1=3, \\nu_2=28$、非中心参数为 $\\lambda$ 的非中心F分布。\n\n非中心参数的计算公式为：\n$$\n\\lambda = \\frac{n}{\\sigma^2} \\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2\n$$\n其中 $\\bar{\\mu}$ 是特定备择假设下各总体均值的总平均值。\n\n我们首先计算 $\\bar{\\mu}$：\n$$\n\\bar{\\mu} = \\frac{1}{k} \\sum_{i=1}^{k} \\mu_i = \\frac{0.70 + 0.75 + 0.80 + 0.75}{4} = \\frac{3.00}{4} = 0.75\n$$\n\n接下来，我们计算各组均值与总平均值之间的离差平方和：\n$$\n\\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2 = (0.70 - 0.75)^2 + (0.75 - 0.75)^2 + (0.80 - 0.75)^2 + (0.75 - 0.75)^2\n$$\n$$\n\\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2 = (-0.05)^2 + (0)^2 + (0.05)^2 + (0)^2 = 0.0025 + 0 + 0.0025 + 0 = 0.0050\n$$\n\n现在我们可以计算非中心参数 $\\lambda$：\n$$\n\\lambda = \\frac{n}{\\sigma^2} \\sum_{i=1}^{k} (\\mu_i - \\bar{\\mu})^2 = \\frac{8}{0.0144} \\times 0.0050\n$$\n$$\n\\lambda = \\frac{0.04}{0.0144} = \\frac{400}{144} = \\frac{100}{36} = \\frac{25}{9}\n$$\n所以, $\\lambda \\approx 2.777...$。\n\n检验的功效是在此备择假设为真时拒绝 $H_0$ 的概率。这意味着需要计算观测到的F统计量（服从非中心F分布 $F'$）大于临界值 $F_c$ 的概率。\n$$\n\\text{功效} = P(F' > F_c | H_1 \\text{ 为真})\n$$\n这个非中心F分布的参数为 $\\nu_1=3$, $\\nu_2=28$, 和 $\\lambda = 25/9$。\n\n功效可以使用非中心F分布的累积分布函数（CDF）$F_{\\nu_1, \\nu_2, \\lambda}(x)$ 来计算：\n$$\n\\text{功效} = 1 - P(F' \\le F_c) = 1 - F_{\\nu_1, \\nu_2, \\lambda}(F_c)\n$$\n题目提供了相关参数在临界值处的CDF值：$F_{\\nu_1, \\nu_2, \\lambda}(F_c) = 0.1983$。“相关参数”确实是我们已经计算出的那些参数（$\\nu_1=3, \\nu_2=28, \\lambda=25/9$）。\n\n因此，功效为：\n$$\n\\text{功效} = 1 - 0.1983 = 0.8017\n$$\n问题要求计算实验正确拒绝原假设的概率，这正是检验的功效。结果已经保留了四位有效数字。", "answer": "$$\\boxed{0.8017}$$", "id": "1960646"}]}