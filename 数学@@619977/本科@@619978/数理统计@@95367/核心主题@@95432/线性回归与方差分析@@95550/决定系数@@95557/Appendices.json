{"hands_on_practices": [{"introduction": "决定系数 $R^2$ 的核心思想是将数据的总变异分解为模型可以解释的部分和无法解释的部分。这个练习将直接应用 $R^2$ 的基本定义，$R^2 = \\frac{SSR}{SST}$，来巩固总平方和（$SST$）与回归平方和（$SSR$）之间的关系。这是理解 $R^2$ 作为模型解释力衡量标准的第一步，也是后续更复杂分析的基础。[@problem_id:1904808]", "problem": "一位城市规划专业的学生正在研究城市区域的人口密度与其公共交通系统的日均乘客量之间的关系。在收集了不同区域的数据后，该学生进行了一项简单线性回归分析来为此关系建模。分析显示，总平方和 (SST) 为 240，它代表了日均乘客量数据围绕其均值的总变异。该模型的决定系数 $R^2$ 被计算得出为 0.25。决定系数衡量了因变量（乘客量）的方差中可由自变量（人口密度）预测的部分所占的比例。\n\n计算回归平方和 (SSR)，它量化了由回归模型解释的乘客量数据中的变异量。", "solution": "令 $SST$ 表示总平方和，$SSR$ 表示回归平方和，$SSE$ 表示误差平方和。标准的分解公式为\n$$\nSST = SSR + SSE.\n$$\n决定系数的定义为\n$$\nR^2 = \\frac{SSR}{SST}.\n$$\n求解 $SSR$ 可得\n$$\nSSR = R^2 \\cdot SST.\n$$\n代入给定值 $R^2 = 0.25$ 和 $SST = 240$，\n$$\nSSR = 0.25 \\cdot 240 = \\frac{1}{4} \\cdot 240 = 60.\n$$\n因此，回归平方和为 $60$。", "answer": "$$\\boxed{60}$$", "id": "1904808"}, {"introduction": "在掌握了基本计算之后，我们来探索一个 $R^2$ 在简单线性回归中不那么直观的特性。这个思想实验探讨了如果我们颠倒自变量和因变量的角色会发生什么，这在探索性数据分析中是常有的考量。其结果揭示了决定系数与皮尔逊相关系数之間的深刻联系，强调了在简单线性回归中，$R^2$ 本质上是衡量线性关联強度的一个对称指标。[@problem_id:1904814]", "problem": "一位环境科学家正在研究土壤中某种污染物的浓度与一种特定本地植物生长速率之间的关系。一项初步研究收集了来自四个不同地点的数据。设 $x$ 为污染物浓度，单位为百万分率 (ppm)，$y$ 为植物生长速率，单位为厘米/周 (cm/week)。记录的数据对 $(x_i, y_i)$ 为：$(1, 2)$、$(2, 3)$、$(4, 5)$ 和 $(5, 4)$。\n\n该科学家考虑使用两种不同的简单线性回归模型来分析这些数据：\n1.  **模型 A**：一个用污染物浓度 ($x$) 预测植物生长速率 ($y$) 的模型。设此模型的决定系数为 $R^2_A$。\n2.  **模型 B**：一个用植物生长速率 ($y$) 预测污染物浓度 ($x$) 的模型。设此模型的决定系数为 $R^2_B$。\n\n根据所提供的数据，以下哪个陈述正确描述了 $R^2_A$ 和 $R^2_B$ 之间的关系？\n\nA. $R^2_A > R^2_B$\n\nB. $R^2_A  R^2_B$\n\nC. $R^2_A = R^2_B$\n\nD. 如果不知道两个模型的明确回归线方程，则无法确定它们之间的关系。\n\nE. $R^2_B$ 是一个无效的概念，因为相关性不代表因果关系，从结果 ($y$) 预测原因 ($x$) 在统计上是无意义的。", "solution": "设数据为 $\\{(x_{i},y_{i})\\}_{i=1}^{n}$，其中 $n=4$。定义样本均值 $\\bar{x}$ 和 $\\bar{y}$，以及中心化和\n$$\nS_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2},\\quad S_{yy}=\\sum_{i=1}^{n}(y_{i}-\\bar{y})^{2},\\quad S_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y}),\n$$\n和 Pearson 相关系数\n$$\nr=\\frac{S_{xy}}{\\sqrt{S_{xx}S_{yy}}}.\n$$\n\n模型 A（$y$ 对 $x$ 进行带截距的回归）：普通最小二乘法系数满足\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}},\\qquad \\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x}.\n$$\n拟合偏差满足 $\\,\\hat{y}_{i}-\\bar{y}=\\hat{\\beta}_{1}(x_{i}-\\bar{x})\\,$, 所以回归平方和是\n$$\n\\mathrm{SSR}_{y\\mid x}=\\sum_{i=1}^{n}(\\hat{y}_{i}-\\bar{y})^{2}=\\hat{\\beta}_{1}^{2}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}=\\left(\\frac{S_{xy}}{S_{xx}}\\right)^{2}S_{xx}=\\frac{S_{xy}^{2}}{S_{xx}}.\n$$\n总平方和是 $\\mathrm{SST}_{y}=S_{yy}$。因此决定系数是\n$$\nR^{2}_{A}=\\frac{\\mathrm{SSR}_{y\\mid x}}{\\mathrm{SST}_{y}}=\\frac{S_{xy}^{2}}{S_{xx}S_{yy}}=r^{2}.\n$$\n\n模型 B（$x$ 对 $y$ 进行带截距的回归）：根据对称性，\n$$\n\\hat{\\alpha}_{1}=\\frac{S_{xy}}{S_{yy}},\\qquad \\hat{\\alpha}_{0}=\\bar{x}-\\hat{\\alpha}_{1}\\bar{y},\n$$\n并且拟合偏差满足 $\\,\\hat{x}_{i}-\\bar{x}=\\hat{\\alpha}_{1}(y_{i}-\\bar{y})\\,$. 因此\n$$\n\\mathrm{SSR}_{x\\mid y}=\\sum_{i=1}^{n}(\\hat{x}_{i}-\\bar{x})^{2}=\\hat{\\alpha}_{1}^{2}\\sum_{i=1}^{n}(y_{i}-\\bar{y})^{2}=\\left(\\frac{S_{xy}}{S_{yy}}\\right)^{2}S_{yy}=\\frac{S_{xy}^{2}}{S_{yy}},\n$$\n其中 $\\mathrm{SST}_{x}=S_{xx}$，得到\n$$\nR^{2}_{B}=\\frac{\\mathrm{SSR}_{x\\mid y}}{\\mathrm{SST}_{x}}=\\frac{S_{xy}^{2}}{S_{xx}S_{yy}}=r^{2}.\n$$\n\n因此 $R^2_A = R^2_B$；两者都等于 $x$ 和 $y$ 之间 Pearson 相关系数的平方。这个结论对于任何在简单线性回归（带截距）中两个变量方差均不为零的数据集都成立，因此不需要明确的回归线方程，并且无论因果解释如何，$R^2_B$ 都是一个有效的概念。\n\n因此正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1904814"}, {"introduction": "$R^2$ 通常被直观地理解为“模型解释的方差比例”，其值介于 $0$ 和 $1$ 之间。然而，这种直观理解是有前提的，即模型必须包含截距项。本练习将通过一个“通过原点的回归”的特例，展示标准 $R^2$ 公式可以产生负值。这个结果是一个重要的警示，它提醒我们，模型的表现可能比一个只预测平均值的基准模型还要差，并强调了在评估模型时理解 $R^2$ 定义背后假設的重要性。[@problem_id:1904857]", "problem": "一位电气工程师正在对一种新型电阻元件进行特性分析。根据基于欧姆定律的理论模型，元件两端的电压 $V$ 应与通过它的电流 $I$ 成正比，这意味着关系式为 $V = \\beta I$，其中 $\\beta$ 是电阻。这对应于一个强制通过原点的线性回归模型。\n\n为了检验这一点，该工程师进行了一个小型实验，并收集了以下三个数据点，其中电流 $I$ 的单位为安培 (A)，电压 $V$ 的单位为微伏 ($\\mu$V)：\n$(I_1, V_1) = (10, 1)$\n$(I_2, V_2) = (11, 2)$\n$(I_3, V_3) = (12, 0)$\n\n为了评估强制通过原点的回归模型 $V = \\beta I$ 的拟合优度，该工程师决定计算决定系数 $R^2$。$R^2$ 的标准定义如下：\n$$R^2 = 1 - \\frac{SSE}{SST}$$\n其中：\n- 误差平方和 (SSE) 定义为 $SSE = \\sum_{i=1}^{n} (V_i - \\hat{V}_i)^2$，其中 $\\hat{V}_i$ 是模型对电流 $I_i$ 的预测电压。\n- 总平方和 (SST) 定义为 $SST = \\sum_{i=1}^{n} (V_i - \\bar{V})^2$，其中 $\\bar{V}$ 是观测电压的样本均值。\n\n对于强制通过原点的回归模型，斜率的最小二乘估计由 $\\hat{\\beta} = \\frac{\\sum I_i V_i}{\\sum I_i^2}$ 给出。\n\n计算此模型和数据集的决定系数 $R^2$ 的值。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用强制通过原点的回归模型 $V=\\beta I$。最小二乘估计量由 $\\hat{\\beta}=\\frac{\\sum I_{i}V_{i}}{\\sum I_{i}^{2}}$ 给出。对于数据 $(I_{1},V_{1})=(10,1)$、$(I_{2},V_{2})=(11,2)$、$(I_{3},V_{3})=(12,0)$，计算所需的总和：\n$$\\sum I_{i}V_{i}=10\\cdot 1+11\\cdot 2+12\\cdot 0=32,$$\n$$\\sum I_{i}^{2}=10^{2}+11^{2}+12^{2}=100+121+144=365.$$\n因此，\n$$\\hat{\\beta}=\\frac{32}{365}.$$\n预测值为 $\\hat{V}_{i}=\\hat{\\beta}I_{i}$，所以\n$$\\hat{V}_{1}=\\frac{32}{365}\\cdot 10=\\frac{320}{365}=\\frac{64}{73},\\quad \\hat{V}_{2}=\\frac{32}{365}\\cdot 11=\\frac{352}{365},\\quad \\hat{V}_{3}=\\frac{32}{365}\\cdot 12=\\frac{384}{365}.$$\n残差为\n$$r_{1}=V_{1}-\\hat{V}_{1}=1-\\frac{64}{73}=\\frac{9}{73},\\quad r_{2}=2-\\frac{352}{365}=\\frac{378}{365},\\quad r_{3}=0-\\frac{384}{365}=-\\frac{384}{365}.$$\n因此，误差平方和为\n$$SSE=\\left(\\frac{9}{73}\\right)^{2}+\\left(\\frac{378}{365}\\right)^{2}+\\left(\\frac{384}{365}\\right)^{2}=\\frac{81}{5329}+\\frac{142884+147456}{133225}=\\frac{292365}{133225}=\\frac{801}{365}.$$\n另外，使用强制通过原点回归的恒等式，\n$$SSE=\\sum V_{i}^{2}-\\frac{\\left(\\sum I_{i}V_{i}\\right)^{2}}{\\sum I_{i}^{2}}=5-\\frac{32^{2}}{365}=\\frac{801}{365},$$\n这与直接计算的结果相符。观测电压的样本均值为\n$$\\bar{V}=\\frac{1+2+0}{3}=1,$$\n所以总平方和为\n$$SST=\\sum\\left(V_{i}-\\bar{V}\\right)^{2}=(1-1)^{2}+(2-1)^{2}+(0-1)^{2}=0+1+1=2.$$\n因此，\n$$R^2=1-\\frac{SSE}{SST}=1-\\frac{\\frac{801}{365}}{2}=1-\\frac{801}{730}=-\\frac{71}{730}\\approx -0.0973,$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{-0.0973}$$", "id": "1904857"}]}