{"hands_on_practices": [{"introduction": "理论学习之后，让我们通过动手实践来巩固对置信区间的理解。第一个练习将探讨一种常见但重要的变体：单侧置信区间。在许多工程和质量控制场景中，我们更关心参数是否高于或低于某个阈值，而不是将其精确地框定在两个值之间。本练习将通过一个估计LED平均寿命的实际问题，引导你使用关键变量法（pivotal method）来构造一个95%的单侧置信下界，这对于评估产品的最低性能保证至关重要。[@problem_id:1912972]", "problem": "一位质量控制工程师正在测试一种新型发光二极管（LED）以确定其平均寿命。假设这些LED的寿命服从指数分布，其未知平均寿命为 $\\theta$。一个包含 $n=10$ 个LED的随机样本被测试直至失效，其寿命（单位：千小时）记录如下：\n$$3.5, 1.7, 4.2, 8.8, 0.9, 2.4, 5.6, 6.1, 3.9, 2.9$$\n该工程师希望找到一个值 $L$，使得他们有95%的置信度确信真实的平均寿命 $\\theta$ 大于 $L$。这个值 $L$ 被称为 $\\theta$ 的95%置信下限。\n\n一个已知的统计结果是，如果 $X_1, \\ldots, X_n$ 是来自平均值为 $\\theta$ 的指数分布的独立同分布随机变量，那么统计量 $\\frac{2 \\sum_{i=1}^n X_i}{\\theta}$ 服从自由度为 $2n$ 的卡方分布。已知自由度为20的卡方分布的第95百分位数是31.410。\n\n计算平均寿命 $\\theta$ 的95%置信下限。答案以千小时为单位，保留三位有效数字。", "solution": "设 $X_{1},\\ldots,X_{n}$ 独立同分布于平均值为 $\\theta$ 的指数分布。定义 $S=\\sum_{i=1}^{n}X_{i}$。所述的枢轴量为\n$$\n\\frac{2S}{\\theta}\\sim \\chi^{2}_{2n}.\n$$\n$\\theta$ 的单侧0.95置信下限 $L$ 可通过使用 $\\chi^{2}$ 分布的0.95分位数得到。具体来说，\n$$\n\\mathbb{P}_{\\theta}\\!\\left(\\frac{2S}{\\theta}\\leq \\chi^{2}_{2n,0.95}\\right)=0.95\n\\quad\\Longleftrightarrow\\quad\n\\mathbb{P}_{\\theta}\\!\\left(\\theta\\geq \\frac{2S}{\\chi^{2}_{2n,0.95}}\\right)=0.95,\n$$\n所以置信下限为\n$$\nL=\\frac{2S}{\\chi^{2}_{2n,0.95}}.\n$$\n当 $n=10$ 且观测到的寿命（单位：千小时）为\n$$\n3.5,\\, 1.7,\\, 4.2,\\, 8.8,\\, 0.9,\\, 2.4,\\, 5.6,\\, 6.1,\\, 3.9,\\, 2.9,\n$$\n样本总和为\n$$\nS=3.5+1.7+4.2+8.8+0.9+2.4+5.6+6.1+3.9+2.9=40.0.\n$$\n已知 $\\chi^{2}_{20,0.95}=31.410$，则置信下限为\n$$\nL=\\frac{2\\times 40.0}{31.410}=\\frac{80}{31.410}\\approx 2.55,\n$$\n单位为千小时，保留三位有效数字。", "answer": "$$\\boxed{2.55}$$", "id": "1912972"}, {"introduction": "置信区间的计算公式看似简单，但其有效性严格依赖于背后的统计假设。如果假设不成立，我们计算出的置信水平（如95%）可能与真实的覆盖概率相去甚远。这个练习通过一个关于自动驾驶汽车LIDAR传感器的思想实验，揭示了系统偏差（systematic bias）这一隐蔽“杀手”如何破坏置信区间的可靠性。通过计算在存在未知偏差时，区间未能覆盖真实参数的实际概率，你将深刻体会到审视模型假设在科学实践中的重要性。[@problem_id:1912969]", "problem": "一辆自动驾驶汽车配备了激光雷达（Light Detection and Ranging, LIDAR）系统，用于测量其与周围物体的距离。工程规格说明，对于一个处于真实距离 $\\theta$ 的静止物体，LIDAR的测量值呈正态分布，其随机误差的标准差已知为 $\\sigma = 25.0$ 厘米。\n\n在一次校准测试中，该车停在一个固定目标前。后来发现，LIDAR单元存在一个持续的、未知的系统性偏差 $\\delta$，导致其所有的距离读数都偏移了这个恒定的量。因此，测量值 $Y$ 是来自正态分布 $N(\\theta + \\delta, \\sigma^2)$ 的随机样本。\n\n该车的软件没有意识到系统性偏差 $\\delta$ 的存在，它采集了 $n=64$ 个测量值的样本。然后，它基于其读数均值代表真实距离 $\\theta$ 这一错误假设，计算了该均值的95%置信区间。在这次特定的测试中，系统性偏差恰好为 $\\delta = 10.0$ 厘米。\n\n计算该车软件所计算的95%置信区间未能包含真实距离 $\\theta$ 的概率。将你的答案表示为保留四位有效数字的小数。", "solution": "设测量值为 $Y_{1},\\dots,Y_{n}$，其中 $Y_{i} \\sim N(\\theta+\\delta,\\sigma^{2})$ 且相互独立。样本均值 $\\bar{Y}$ 则满足\n$$\n\\bar{Y} \\sim N(\\theta+\\delta,\\tfrac{\\sigma^{2}}{n})。\n$$\n该软件为（假定的）均值构建的双侧95%置信区间为\n$$\n\\bar{Y} \\pm z_{0.975}\\,\\frac{\\sigma}{\\sqrt{n}},\n$$\n其中 $z_{0.975}$ 是标准正态分布的 $0.975$ 分位数，并且软件将其解释为 $\\theta$ 的置信区间。该区间包含 $\\theta$ 当且仅当\n$$\n|\\bar{Y}-\\theta| \\leq z_{0.975}\\,\\frac{\\sigma}{\\sqrt{n}}。\n$$\n定义标准化变量\n$$\nW \\equiv \\frac{\\bar{Y}-\\theta}{\\sigma/\\sqrt{n}}。\n$$\n由于 $\\bar{Y}-\\theta \\sim N(\\delta,\\tfrac{\\sigma^{2}}{n})$，可得\n$$\nW \\sim N\\!\\left(\\frac{\\delta}{\\sigma/\\sqrt{n}},\\,1\\right)=N\\!\\left(\\frac{\\delta\\sqrt{n}}{\\sigma},\\,1\\right)。\n$$\n令 $\\lambda \\equiv \\delta\\sqrt{n}/\\sigma$。那么，覆盖概率为\n$$\nP\\!\\left(|W|\\leq z_{0.975}\\right)=P\\!\\left(-z_{0.975}\\leq W \\leq z_{0.975}\\right)=\\Phi\\!\\left(z_{0.975}-\\lambda\\right)-\\Phi\\!\\left(-z_{0.975}-\\lambda\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。因此，失效概率为\n$$\n1-\\left[\\Phi\\!\\left(z_{0.975}-\\lambda\\right)-\\Phi\\!\\left(-z_{0.975}-\\lambda\\right)\\right]。\n$$\n\n现在代入给定值 $\\sigma=25.0$ 厘米，$n=64$ 和 $\\delta=10.0$ 厘米。计算\n$$\n\\lambda=\\frac{\\delta\\sqrt{n}}{\\sigma}=\\frac{10.0\\times 8}{25.0}=3.2。\n$$\n使用 $z_{0.975}\\approx 1.959963984$ 进行求值\n$$\n\\Phi\\!\\left(z_{0.975}-\\lambda\\right)=\\Phi(-1.240036)\\approx 0.1075,\\quad \\Phi\\!\\left(-z_{0.975}-\\lambda\\right)=\\Phi(-5.159964)\\approx 1.2\\times 10^{-7}。\n$$\n因此，覆盖概率约为 $0.1075$，而失效概率为\n$$\n1-0.1075\\approx 0.8925。\n$$\n保留四位有效数字，计算出的95%置信区间未能包含 $\\theta$ 的概率为 $0.8925$。", "answer": "$$\\boxed{0.8925}$$", "id": "1912969"}, {"introduction": "我们之前遇到的置信区间大多依赖于数据服从特定概率分布（如正态分布）的假设。然而，当这些假设不成立或我们无法验证时，应该怎么办？本练习将带你探索一种强大的“非参数”方法，它无需对数据分布做过多假设，便能为总体中位数（median）构造一个置信区间。通过处理一组OLED寿命数据，你将学习如何利用顺序统计量（order statistics）和二项分布的原理来构建一个稳健的区间，这极大地扩展了你的统计工具箱。[@problem_id:1913038]", "problem": "一位材料科学家正在评估一种新的有机发光二极管（OLED）制造工艺。一个关键的性能指标是其工作寿命。随机抽取了20个新制造的OLED进行测试直至失效，并记录了它们的寿命（以千小时为单位）。观测到的寿命经排序后如下：\n\n18.5, 19.1, 20.3, 21.8, 22.5, 23.9, 24.1, 25.0, 26.7, 27.8, 29.2, 30.1, 31.5, 33.0, 34.6, 36.4, 38.9, 41.2, 44.0, 47.3\n\n仅假设寿命的潜在分布是连续的，请为总体寿命中位数构建一个非参数置信区间。该区间的置信水平应至少为95%。以下哪项代表了所构建的区间（以千小时为单位）？\n\nA. (23.9, 34.6)\n\nB. (22.5, 36.4)\n\nC. (24.1, 33.0)\n\nD. (22.5, 34.6)\n\nE. (25.0, 31.5)", "solution": "我们要在仅假设分布为连续的情况下，为总体中位数构建一个非参数置信区间。设真实中位数为 $m$，因此对于任何观测值 $X$，有 $\\Pr(X \\le m) = \\frac{1}{2}$。对于一个大小为 $n$ 的样本，小于或等于 $m$ 的观测值数量服从二项分布 $\\operatorname{Binomial}(n, \\frac{1}{2})$。因此，一个用于 $m$ 的等尾非参数置信区间由以下顺序统计量区间给出\n$$\n\\left(X_{(k)},\\,X_{(n-k+1)}\\right),\n$$\n其覆盖概率为\n$$\n1 - 2 \\sum_{i=0}^{k-1} \\binom{n}{i} 2^{-n}.\n$$\n我们需要找到最小的整数 $k$，使得\n$$\n\\sum_{i=0}^{k-1} \\binom{n}{i} 2^{-n} \\le \\frac{1}{40},\n$$\n因为至少 $0.95$ 的置信水平要求每侧的尾部概率至多为 $\\frac{1}{40}$。\n\n当 $n=20$ 且 $2^{20} = 1\\,048\\,576$ 时，计算左尾累积和：\n$$\n\\sum_{i=0}^{5} \\binom{20}{i} = \\binom{20}{0}+\\binom{20}{1}+\\binom{20}{2}+\\binom{20}{3}+\\binom{20}{4}+\\binom{20}{5} = 1+20+190+1140+4845+15\\,504 = 21\\,700,\n$$\n所以\n$$\n\\sum_{i=0}^{5} \\binom{20}{i} 2^{-20} = \\frac{21\\,700}{1\\,048\\,576} < \\frac{1}{40}.\n$$\n但是\n$$\n\\sum_{i=0}^{6} \\binom{20}{i} = 21\\,700 + \\binom{20}{6} = 21\\,700 + 38\\,760 = 60\\,460,\n$$\n所以\n$$\n\\sum_{i=0}^{6} \\binom{20}{i} 2^{-20} = \\frac{60\\,460}{1\\,048\\,576} > \\frac{1}{40}.\n$$\n因此，满足该要求的最小 $k$ 值是 $k=6$。由此得到的置信水平为\n$$\n1 - 2 \\cdot \\frac{21\\,700}{1\\,048\\,576} \\;=\\; 1 - \\frac{21\\,700}{524\\,288} \\;\\ge\\; 0.95.\n$$\n因此，置信区间为 $\\left(X_{(6)}, X_{(15)}\\right)$。根据排序后的数据，$X_{(6)} = 23.9,\\quad X_{(15)} = 34.6,$ 所以该区间是 $(23.9, 34.6)$，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1913038"}]}