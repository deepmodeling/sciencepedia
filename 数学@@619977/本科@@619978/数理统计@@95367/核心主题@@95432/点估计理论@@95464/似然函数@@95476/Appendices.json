{"hands_on_practices": [{"introduction": "掌握似然函数概念的最好方法，莫过于亲手构建一个。本练习将作为一个基础热身，我们从一个非常简单的伯努利过程（可以想象成抛硬币）的具体数据出发，一步步构建其似然函数。通过这个过程，你将直观地理解似然性如何随着参数 $p$ 的变化而变化，并为寻找“最可能”的参数值打下基础。[@problem_id:1961909]", "problem": "一个实验过程可建模为一系列独立的伯努利试验。对于每次试验，其结果 $Y$ 可能是成功（用 $Y=1$ 表示）或失败（用 $Y=0$ 表示）。成功的概率由参数 $p$ 给出，其中 $p \\in [0, 1]$。因此，单次试验的概率质量函数为 $f(y|p) = p^y (1-p)^{1-y}$，其中 $y \\in \\{0, 1\\}$。\n\n现进行一次小规模实验，得到一个包含三次独立试验结果的序列：第一次试验成功，第二次失败，第三次成功。也就是说，观测数据为序列 $(y_1, y_2, y_3) = (1, 0, 1)$。\n\n似然函数 $L(p)$ 表示观测到这一特定数据序列的概率，它是参数 $p$ 的函数。对于独立试验，它是个体概率的乘积：$L(p) = f(y_1|p) \\times f(y_2|p) \\times f(y_3|p)$。\n\n求使该似然函数 $L(p)$ 最大化的参数 $p$ 的值。请将答案表示为最简分数形式。", "solution": "对于参数为 $p$ 的伯努利试验，其概率质量函数为 $f(y \\mid p) = p^{y}(1-p)^{1-y}$，其中 $y \\in \\{0,1\\}$。对于独立试验，观测到 $(y_{1},y_{2},y_{3})=(1,0,1)$ 的似然是其概率的乘积\n$$\nL(p)=\\prod_{i=1}^{3} f(y_{i}\\mid p)\n= p^{y_{1}}(1-p)^{1-y_{1}} \\cdot p^{y_{2}}(1-p)^{1-y_{2}} \\cdot p^{y_{3}}(1-p)^{1-y_{3}}.\n$$\n代入 $y_{1}=1$，$y_{2}=0$，$y_{3}=1$ 可得\n$$\nL(p)=p^{1}(1-p)^{0}\\cdot p^{0}(1-p)^{1}\\cdot p^{1}(1-p)^{0}=p^{2}(1-p).\n$$\n为了在 $p \\in [0,1]$ 上求 $L(p)$ 的最大值，一个方便的方法是最大化其对数似然函数\n$$\n\\ell(p)=\\ln L(p)=2\\ln p+\\ln(1-p).\n$$\n求导并令其为零：\n$$\n\\ell'(p)=\\frac{2}{p}-\\frac{1}{1-p}=0\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{2}{p}=\\frac{1}{1-p}\n\\;\\;\\Longrightarrow\\;\\;\n2(1-p)=p\n\\;\\;\\Longrightarrow\\;\\;\n2-2p=p\n\\;\\;\\Longrightarrow\\;\\;\np=\\frac{2}{3}.\n$$\n验证这是一个最大值：其二阶导数为\n$$\n\\ell''(p)=-\\frac{2}{p^{2}}-\\frac{1}{(1-p)^{2}}<0 \\quad \\text{for} \\quad p\\in(0,1),\n$$\n因此该临界点是一个严格局部极大值点。检查边界值，$L(0)=0$ 且 $L(1)=0$，因此在 $[0,1]$ 上的全局最大值在内部点 $p=\\frac{2}{3}$ 处取得。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1961909"}, {"introduction": "构建了似然函数之后，其核心应用便是找出最能解释观测数据的参数值，即最大似然估计（Maximum Likelihood Estimator, MLE）。这个练习将我们带入连续分布的世界，使用在可靠性工程中常见的伽马分布。你的任务是运用微积分的知识来推导尺度参数 $\\theta$ 的最大似然估计量，这是现代统计推断的一块基石。[@problem_id:1961965]", "problem": "一位工程师正在研究一种特定电子元件的可靠性。元件的寿命（以小时为单位）被建模为一个连续随机变量 $X$，它服从伽马分布（Gamma distribution），其形状参数 $k > 0$ 已知，而尺度参数 $\\theta > 0$ 未知。该分布的概率密度函数 (PDF) 由下式给出：\n$$f(x; k, \\theta) = \\frac{1}{\\Gamma(k)\\theta^k} x^{k-1} \\exp\\left(-\\frac{x}{\\theta}\\right), \\quad \\text{for } x > 0$$\n其中 $\\Gamma(k)$ 是在 $k$ 处求值的伽马函数。\n\n为了估计未知参数 $\\theta$，该工程师测试了一个由 $n$ 个元件组成的随机样本，并记录了它们的寿命，记为 $x_1, x_2, \\ldots, x_n$。\n\n你的任务是求出尺度参数 $\\theta$ 的最大似然估计量 (Maximum Likelihood Estimator, MLE)。请将估计量（记为 $\\hat{\\theta}$）的最终答案用已知的形状参数 $k$ 和样本均值 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$ 表示。", "solution": "我们假设观测到的寿命 $x_{1},\\ldots,x_{n}$ 是独立同分布的，服从 $\\Gamma(k,\\theta)$ 分布，其中 $k>0$ 已知，$\\theta>0$ 未知。联合似然函数为\n$$\nL(\\theta; x_{1},\\ldots,x_{n})=\\prod_{i=1}^{n}\\frac{1}{\\Gamma(k)\\theta^{k}}x_{i}^{k-1}\\exp\\left(-\\frac{x_{i}}{\\theta}\\right).\n$$\n对似然函数取自然对数，得到对数似然函数\n$$\n\\ell(\\theta)=\\ln L(\\theta; x_{1},\\ldots,x_{n})=\\sum_{i=1}^{n}\\left[-\\ln\\Gamma(k)-k\\ln\\theta+(k-1)\\ln x_{i}-\\frac{x_{i}}{\\theta}\\right].\n$$\n对 $\\theta$ 求导，并利用 $\\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\ln\\theta=\\frac{1}{\\theta}$ 和 $\\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\left(-\\frac{x_{i}}{\\theta}\\right)=\\frac{x_{i}}{\\theta^{2}}$，我们得到\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^{n}\\left[-\\frac{k}{\\theta}+\\frac{x_{i}}{\\theta^{2}}\\right]=-\\,\\frac{nk}{\\theta}+\\frac{1}{\\theta^{2}}\\sum_{i=1}^{n}x_{i}.\n$$\n为了求得最大似然估计量 (MLE)，令得分方程为零，\n$$\n-\\,\\frac{nk}{\\theta}+\\frac{1}{\\theta^{2}}\\sum_{i=1}^{n}x_{i}=0,\n$$\n两边同乘以 $\\theta^{2}>0$ 得\n$$\n-nk\\,\\theta+\\sum_{i=1}^{n}x_{i}=0.\n$$\n解出 $\\theta$ 得\n$$\n\\hat{\\theta}=\\frac{1}{nk}\\sum_{i=1}^{n}x_{i}=\\frac{\\bar{x}}{k},\n$$\n其中 $\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}$ 是样本均值。为验证这是一个极大值，计算二阶导数\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\theta^{2}}=\\sum_{i=1}^{n}\\left[\\frac{k}{\\theta^{2}}-\\frac{2x_{i}}{\\theta^{3}}\\right]=\\frac{nk}{\\theta^{2}}-\\frac{2}{\\theta^{3}}\\sum_{i=1}^{n}x_{i}.\n$$\n将其在 $\\hat{\\theta}$ 处求值，并利用 $\\sum_{i=1}^{n}x_{i}=nk\\,\\hat{\\theta}$，\n$$\n\\left.\\frac{\\partial^{2}\\ell}{\\partial \\theta^{2}}\\right|_{\\theta=\\hat{\\theta}}=\\frac{nk}{\\hat{\\theta}^{2}}-\\frac{2}{\\hat{\\theta}^{3}}(nk\\,\\hat{\\theta})=-\\frac{nk}{\\hat{\\theta}^{2}}<0,\n$$\n证实了 $\\hat{\\theta}$ 使得对数似然函数最大化。因此，最大似然估计量 (MLE) 是 $\\bar{x}/k$。", "answer": "$$\\boxed{\\frac{\\bar{x}}{k}}$$", "id": "1961965"}, {"introduction": "最后的这个练习提出了一个更精妙也更有趣的挑战：当我们想要估计的参数本身就定义了数据可能的取值范围（即分布的支持集）时，应该如何处理？我们将研究一个移位的指数分布，并探索在这种情况下如何最大化似然函数。这个例子提醒我们，标准的微积分方法（求导）并非总是直接适用，从而磨练我们分析问题的敏锐度。[@problem_id:1961936]", "problem": "一家制造商正在测试一种新型微芯片。一批共 $n$ 个相同的芯片被进行压力测试。该测试在一个未知但固定的时间 $\\mu > 0$ 开始。第 $i$ 个芯片的失效时间，从零时刻开始测量，被记录为 $X_i$。已知芯片的寿命，定义为从测试开始到其失效的持续时间，服从速率参数为 1 的指数分布。因此，单个芯片失效时间 $X_i$ 的概率密度函数由下式给出：\n$$f(x | \\mu) = \\begin{cases} \\exp(-(x-\\mu)) & \\text{if } x \\ge \\mu \\\\ 0 & \\text{if } x < \\mu \\end{cases}$$\n假设观测到一个包含 $n$ 个失效时间的随机样本 $x_1, x_2, \\ldots, x_n$。你的任务是确定未知开始时间 $\\mu$ 的似然函数 $L(\\mu | x_1, x_2, \\ldots, x_n)$。答案应该是一个对所有实数 $\\mu$ 都有效的单一表达式。", "solution": "每个失效时间都具有速率参数为 1 的平移指数密度，可以使用指示函数写为\n$$\nf(x_{i}\\mid \\mu)=\\exp\\!\\bigl(-(x_{i}-\\mu)\\bigr)\\,\\mathbf{1}\\{x_{i}\\ge \\mu\\}.\n$$\n假设 $n$ 个观测值是独立的，似然函数是各个密度的乘积：\n$$\nL(\\mu\\mid x_{1},\\ldots,x_{n})=\\prod_{i=1}^{n} f(x_{i}\\mid \\mu)\n=\\prod_{i=1}^{n}\\left[\\exp\\!\\bigl(-(x_{i}-\\mu)\\bigr)\\,\\mathbf{1}\\{x_{i}\\ge \\mu\\}\\right].\n$$\n将指数项和指示函数项分别收集起来，得到\n$$\nL(\\mu\\mid x_{1},\\ldots,x_{n})\n=\\exp\\!\\left(-\\sum_{i=1}^{n}x_{i}+n\\mu\\right)\\,\\prod_{i=1}^{n}\\mathbf{1}\\{x_{i}\\ge \\mu\\}.\n$$\n等价地，由于 $\\prod_{i=1}^{n}\\mathbf{1}\\{x_{i}\\ge \\mu\\}=\\mathbf{1}\\{\\mu\\le x_{(1)}\\}$，其中 $x_{(1)}=\\min_{1\\le i\\le n}x_{i}$，因此该表达式对所有实数 $\\mu$ 均有效。", "answer": "$$\\boxed{\\exp\\!\\left(-\\sum_{i=1}^{n}x_{i}+n\\mu\\right)\\prod_{i=1}^{n}\\mathbf{1}\\{x_{i}\\ge \\mu\\}}$$", "id": "1961936"}]}