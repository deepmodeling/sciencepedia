{"hands_on_practices": [{"introduction": "让我们从一个基础且常见的场景开始：对离散事件（如产品缺陷）进行建模。这个练习将带你应用最大似然估计来处理泊松分布，这是一个用于描述在固定时间或空间内事件发生次数的强大工具。通过这个练习，你将亲手推导出泊松分布参数的估计量，并理解它如何直接关联到我们关心的统计量，如方差。[@problem_id:1917484]", "problem": "一家纺织品制造商正在实施一项新的质量控制协议。在一块随机选择的一平方米织物上发现的瑕疵（如抽丝或变色）数量，可以用一个泊松分布来建模，其率参数 $\\lambda$ 未知。这个参数 $\\lambda$ 代表每平方米的平均瑕疵数。\n\n为了评估一批新织物，一位质量控制工程师检查了 $n=8$ 个独立的一平方米布块，并记录了每个布块上的瑕疵数量。观测到的计数如下：\n$$3, 5, 2, 4, 3, 4, 6, 3$$\n\n假设这些观测值是来自该泊松分布的独立同分布样本，求这批织物每平方米瑕疵数方差的最大似然估计 (MLE)。", "solution": "设 $X_{1},\\dots,X_{n}$ 独立同分布于 $\\operatorname{Poisson}(\\lambda)$，其概率质量函数 (pmf) 为\n$$ P(X=x)=\\frac{\\lambda^{x}\\exp(-\\lambda)}{x!}, $$\n对于 $x\\in\\{0,1,2,\\dots\\}$。对于观测值 $x_{1},\\dots,x_{n}$，其似然函数为\n$$\nL(\\lambda)=\\prod_{i=1}^{n}\\frac{\\lambda^{x_{i}}\\exp(-\\lambda)}{x_{i}!}\n=\\frac{\\lambda^{\\sum_{i=1}^{n}x_{i}}\\exp(-n\\lambda)}{\\prod_{i=1}^{n}x_{i}!}.\n$$\n对数似然函数为\n$$\n\\ell(\\lambda)=\\ln L(\\lambda)=\\left(\\sum_{i=1}^{n}x_{i}\\right)\\ln\\lambda - n\\lambda - \\sum_{i=1}^{n}\\ln(x_{i}!).\n$$\n对 $\\lambda$ 求导并令其为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda}=\\frac{\\sum_{i=1}^{n}x_{i}}{\\lambda}-n=0\n\\quad\\Longrightarrow\\quad\n\\hat{\\lambda}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n二阶导数为 $\\frac{\\partial^{2}\\ell}{\\partial \\lambda^{2}}=-\\frac{\\sum_{i=1}^{n}x_{i}}{\\lambda^{2}}<0$（对于 $\\lambda>0$），这证实了该点为极大值点。\n\n对于泊松分布，方差等于其参数：$\\operatorname{Var}(X)=\\lambda$。因此，方差的 MLE 就是 $\\lambda$ 的 MLE：\n$$\n\\widehat{\\operatorname{Var}}(X)=\\hat{\\lambda}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n根据给定的数据 $3,5,2,4,3,4,6,3$，我们有\n$$\n\\sum_{i=1}^{8}x_{i}=3+5+2+4+3+4+6+3=30,\\quad n=8,\n$$\n所以\n$$\n\\widehat{\\operatorname{Var}}(X)=\\hat{\\lambda}=\\frac{30}{8}=\\frac{15}{4}.\n$$", "answer": "$$\\boxed{\\frac{15}{4}}$$", "id": "1917484"}, {"introduction": "接下来，我们将从离散计数转向连续测量，例如科学实验中的测量误差。这个练习将探讨拉普拉斯分布，它常用于对具有比正态分布更重尾部的数据进行建模。你将学习如何处理包含绝对值函数的似然函数，并推导出该分布尺度参数的估计量，这个过程将加深你对最大似然估计法普遍适用性的理解。[@problem_id:1917514]", "problem": "在量子光学领域，研究人员正在开发一种先进的传感器，用于检测真空中的微小能量涨落。理论模型预测，在传感器被校准为平均误差为零后，每次测量的误差（由随机变量 $X$ 表示）服从拉普拉斯分布。该分布的展形（也即传感器的精度）由一个未知的尺度参数 $b > 0$ 来刻画。\n\n在给定尺度参数 $b$ 的条件下，单次测量误差 $x$ 的概率密度函数 (PDF) 为：\n$$ f(x | b) = \\frac{1}{2b} \\exp\\left( -\\frac{|x|}{b} \\right), \\quad \\text{for } -\\infty < x < \\infty $$\n\n现进行一项实验，得到一个包含 $n$ 个独立测量值的随机样本：$x_1, x_2, \\ldots, x_n$。你的任务是确定尺度参数 $b$ 的最大似然估计量 (MLE)。将你的答案（记作 $\\hat{b}$）表示为一个关于样本量 $n$ 和测量值 $x_i$ 的闭式解析表达式。", "solution": "我们有来自均值为零、尺度为 $b>0$ 的拉普拉斯密度的独立观测值 $x_{1},\\ldots,x_{n}$：\n$$\nf(x\\mid b)=\\frac{1}{2b}\\exp\\!\\left(-\\frac{|x|}{b}\\right).\n$$\n给定样本，关于 $b$ 的似然函数为\n$$\nL(b)=\\prod_{i=1}^{n}\\frac{1}{2b}\\exp\\!\\left(-\\frac{|x_{i}|}{b}\\right)\n=\\left(\\frac{1}{2b}\\right)^{n}\\exp\\!\\left(-\\frac{1}{b}\\sum_{i=1}^{n}|x_{i}|\\right).\n$$\n对数似然函数为\n$$\n\\ell(b)=\\ln L(b)=-n\\ln 2 - n\\ln b - \\frac{1}{b}\\sum_{i=1}^{n}|x_{i}|.\n$$\n对 $b$ 求导并令其等于零：\n$$\n\\frac{d\\ell}{db}=-\\frac{n}{b}+\\frac{1}{b^{2}}\\sum_{i=1}^{n}|x_{i}|=0.\n$$\n令 $S=\\sum_{i=1}^{n}|x_{i}|$。则得分方程变为\n$$\n-\\frac{n}{b}+\\frac{S}{b^{2}}=0 \\quad\\Longrightarrow\\quad S=nb \\quad\\Longrightarrow\\quad \\hat{b}=\\frac{S}{n}=\\frac{1}{n}\\sum_{i=1}^{n}|x_{i}|.\n$$\n为验证其为最大值，计算二阶导数：\n$$\n\\frac{d^{2}\\ell}{db^{2}}=\\frac{n}{b^{2}}-\\frac{2S}{b^{3}}.\n$$\n在 $b=\\hat{b}=S/n$ 处，\n$$\n\\frac{d^{2}\\ell}{db^{2}}\\bigg|_{b=\\hat{b}}=\\frac{n}{(S/n)^{2}}-\\frac{2S}{(S/n)^{3}}=\\frac{n^{3}}{S^{2}}-\\frac{2n^{3}}{S^{2}}=-\\frac{n^{3}}{S^{2}},\n$$\n当 $S>0$ 时，该值为负，证实了这是一个最大值。在 $S=0$ 的退化情况下，当 $b\\to 0^{+}$ 时，似然函数是无界的，估计量取边界值 $0$，这与 $\\hat{b}=(1/n)\\sum_{i=1}^{n}|x_{i}|$ 的结果是一致的。\n因此，最大似然估计量是绝对值的样本均值。", "answer": "$$\\boxed{\\frac{1}{n}\\sum_{i=1}^{n}|x_{i}|}$$", "id": "1917514"}, {"introduction": "最后，我们来解决一个经典且有趣的生态学问题：估算野生动物种群数量。这个问题引入了一种不同的挑战，因为我们估计的参数——总种群大小 $N$——本身是一个离散的整数。因此，我们不能简单地通过求导来找到最大值，而是需要使用一种称为似然比的方法来确定哪个整数值的 $N$ 最能解释我们观测到的数据。[@problem_id:1917490]", "problem": "一位野生动物生物学家正在进行一项研究，以估算一个孤立湖泊中特定鱼类的种群数量。这个实验被称为“捕获-再捕获”研究，分两个阶段进行。在第一阶段，生物学家捕获、标记并释放了 $k$ 条鱼。在留出足够时间让被标记的鱼与整个种群充分混合后，进行第二阶段。在这一阶段，从湖中捕获了一个大小为 $n$ 的样本。经检查发现，其中有 $m$ 条鱼是第一阶段被标记的。\n\n我们假设湖中的总鱼群数量（记为 $N$）在两个阶段之间保持不变（即没有出生、死亡、迁入或迁出）。我们还假设种群中的每条鱼在任一样本中被捕获的机会均等，并且标记不会脱落或影响鱼被再次捕获的先验概率。\n\n您的任务是找到一个关于 $N$ 值的公式，该公式使得观测到的结果（在大小为 $n$ 的第二个样本中发现 $m$ 条被标记的鱼）最可能发生。这个值被称为 $N$ 的最大似然估计。请用一个包含 $k$、$n$ 和 $m$ 的单一公式来表示您的答案。", "solution": "第二个样本中被标记的“成功”项目的数量服从超几何分布，其参数为总种群大小 $N$、标记项目数 $k$、抽样大小 $n$以及观测到的成功次数 $m$。似然函数，视为关于 $N$ 的函数（其中 $k,n,m$ 固定），为\n$$\nL(N)=\\Pr(M=m\\mid N)=\\frac{\\binom{k}{m}\\binom{N-k}{\\,n-m\\,}}{\\binom{N}{n}},\n$$\n其可行域为 $N\\in\\{N_{\\min},N_{\\min}+1,\\ldots\\}$，其中 $N_{\\min}=k+n-m$（因此 $0\\leq n-m\\leq N-k$）。因子 $\\binom{k}{m}$ 不依赖于 $N$，因此最大化 $L(N)$ 等价于最大化\n$$\n\\tilde{L}(N)=\\frac{\\binom{N-k}{\\,n-m\\,}}{\\binom{N}{n}}.\n$$\n\n为了在整数 $N \\geq N_{\\min}$ 上找到最大值点，我们考虑连续似然值的比率：\n$$\nr(N)=\\frac{\\tilde{L}(N+1)}{\\tilde{L}(N)}\n=\\frac{\\binom{N+1-k}{\\,n-m\\,}}{\\binom{N-k}{\\,n-m\\,}}\\cdot\\frac{\\binom{N}{n}}{\\binom{N+1}{n}}.\n$$\n使用恒等式 $\\frac{\\binom{a+1}{b}}{\\binom{a}{b}}=\\frac{a+1}{a+1-b}$ 和 $\\frac{\\binom{A}{B}}{\\binom{A+1}{B}}=\\frac{A+1-B}{A+1}$，令 $a=N-k$，$b=n-m$，$A=N$，$B=n$，我们得到\n$$\nr(N)=\\frac{N+1-k}{N+1-k-(n-m)}\\cdot\\frac{N+1-n}{N+1}\n=\\frac{(N+1-k)(N+1-n)}{(N+1-k-n+m)(N+1)}.\n$$\n为了确定序列 $\\tilde{L}(N)$ 的增减性，解不等式 $r(N)\\geq 1$：\n$$\n\\frac{(N+1-k)(N+1-n)}{(N+1-k-n+m)(N+1)}\\geq 1\n\\;\\Longleftrightarrow\\;\n(N+1-k)(N+1-n)\\geq (N+1-k-n+m)(N+1).\n$$\n令 $X=N+1$。展开两侧，\n$$\n(X-k)(X-n)\\geq (X-k-n+m)X\n\\;\\Longleftrightarrow\\;\nX^{2}-X(k+n)+kn \\geq X^{2}-X(k+n-m).\n$$\n两边减去 $X^{2}$ 并合并同类项，得到\n$$\n-X(k+n)+kn \\geq -X(k+n-m)\n\\;\\Longleftrightarrow\\;\nkn - mX \\geq 0\n\\;\\Longleftrightarrow\\;\nX \\leq \\frac{kn}{m}.\n$$\n因此，对于 $m>0$，当且仅当 $N+1\\leq \\frac{kn}{m}$ 时，有 $r(N)\\geq 1$。因此，当 $N$ 增加到满足 $N+1\\leq \\frac{kn}{m}$ 的最大值 $N$ 时，$\\tilde{L}(N)$ 是非递减的，此后是非递增的。因此，任何最大值点 $N^{\\ast}$ 必须满足\n$$\nr(N^{\\ast}-1)\\geq 1\n\\quad\\text{and}\\quad\nr(N^{\\ast})\\leq 1,\n$$\n这等价于\n$$\nN^{\\ast} \\leq \\frac{kn}{m}\n\\quad\\text{and}\\quad\nN^{\\ast}+1 \\geq \\frac{kn}{m}.\n$$\n因此，当 $\\frac{kn}{m}$ 不是整数时，唯一的最大化整数是\n$$\nN^{\\ast}=\\left\\lfloor \\frac{kn}{m}\\right\\rfloor.\n$$\n当 $\\frac{kn}{m}$ 是整数时，$N^{\\ast}=\\frac{kn}{m}-1$ 和 $N^{\\ast}=\\frac{kn}{m}$ 都能达到相同的最大似然值；选择 $N^{\\ast}=\\left\\lfloor \\frac{kn}{m}\\right\\rfloor$ 会选中一个有效的最大值点。可行性约束是自动满足的，因为\n$$\n\\frac{kn}{m}\\geq k+n-m\n\\quad\\text{because}\\quad\nkn - m(k+n-m)=(k-m)(n-m)\\geq 0,\n$$\n所以 $\\left\\lfloor \\frac{kn}{m}\\right\\rfloor \\geq k+n-m$。\n\n如果 $m=0$，那么对于所有可行的 $N$ 都有 $r(N)\\geq 1$，所以 $\\tilde{L}(N)$ 是无界非递减的，不存在有限的最大值点（似然值随 $N$ 的增加而增加）。因此，对于 $m>0$，最大似然估计由下面的单一公式给出。", "answer": "$$\\boxed{\\left\\lfloor \\frac{k n}{m} \\right\\rfloor}$$", "id": "1917490"}]}