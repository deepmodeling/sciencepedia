{"hands_on_practices": [{"introduction": "理论的最佳理解来自于实践。本节的第一个练习将引导您完成计算II类错误概率（$\\beta$）的基本步骤。我们将采用一个经典的统计检验场景：对一个正态分布总体的均值进行双边Z检验。这个练习旨在巩固核心逻辑：首先根据原假设（$H_0$）确定“不拒绝域”，然后计算在某个具体的备择假设（$H_a$）为真时，样本结果落入该区域的概率。[@problem_id:1965595]", "problem": "一家名为“QuantumCharge”的科技公司声称，其新款长寿命电池的平均寿命正好为10.0年。根据对类似电池的大量先前测试可知，其寿命的总体标准差为$\\sigma = 2.0$年，且寿命呈正态分布。\n\n一个消费者权益组织决定检验这一说法。他们收集了一个包含$n=36$块电池的随机样本，并进行了一次双边假设检验。原假设是平均寿命为10.0年（$H_0: \\mu = 10.0$），备择假设是平均寿命不为10.0年（$H_a: \\mu \\neq 10.0$）。检验在$\\alpha = 0.05$的显著性水平下进行。\n\n假设在该权益组织不知情的情况下，所有QuantumCharge电池的真实平均寿命实际上是$\\mu_a = 11.0$年。计算在这些条件下发生第二类错误（Type II error）的概率$\\beta$。将你的答案以小数形式给出，并四舍五入到四位有效数字。", "solution": "当我们未能在原假设（$H_0$）实际上为假时拒绝它，就会发生第二类错误。发生第二类错误的概率用$\\beta$表示。在本题中，我们已知原假设$H_0: \\mu = 10.0$是错误的，真实的平均值为$\\mu_a = 11.0$。\n\n首先，我们必须确定在原假设下样本均值$\\bar{X}$的“不拒绝”域（也称为接受域）。由于总体标准差$\\sigma$已知且总体呈正态分布，该检验是一个双边Z检验。\n\n给定的参数是：\n- 原假设均值：$\\mu_0 = 10.0$\n- 真实备择均值：$\\mu_a = 11.0$\n- 总体标准差：$\\sigma = 2.0$\n- 样本量：$n = 36$\n- 显著性水平：$\\alpha = 0.05$\n\n均值的标准误（SE）计算如下：\n$$ SE = \\frac{\\sigma}{\\sqrt{n}} = \\frac{2.0}{\\sqrt{36}} = \\frac{2.0}{6} = \\frac{1}{3} $$\n在原假设下，样本均值$\\bar{X}$的抽样分布是正态分布，其均值为$\\mu_0=10.0$，标准差为$SE = 1/3$。也就是说，$\\bar{X} \\sim N(10.0, (1/3)^2)$。\n\n对于一个$\\alpha = 0.05$的双边检验，我们在分布的每个尾部有$\\alpha/2 = 0.025$的面积。与这些尾部概率相对应的标准正态分布的临界z值为$z_{\\alpha/2} = z_{0.025} = 1.96$和$-z_{\\alpha/2} = -z_{0.025} = -1.96$。\n\n如果检验统计量$Z = \\frac{\\bar{X} - \\mu_0}{SE}$落在这些临界值之间，我们就不拒绝$H_0$：\n$$ -1.96 \\le \\frac{\\bar{X} - 10.0}{1/3} \\le 1.96 $$\n我们可以解出$\\bar{X}$来找到接受域的边界：\n$$ 10.0 - 1.96 \\left(\\frac{1}{3}\\right) \\le \\bar{X} \\le 10.0 + 1.96 \\left(\\frac{1}{3}\\right) $$\n下界是$\\bar{x}_{c, \\text{lower}} = 10.0 - \\frac{1.96}{3}$，上界是$\\bar{x}_{c, \\text{upper}} = 10.0 + \\frac{1.96}{3}$。\n因此，$\\bar{X}$的接受域大约是$[9.3467, 10.6533]$。如果观测到的样本均值落在这个区间内，我们就不拒绝$H_0$。\n\n现在，我们计算第二类错误的概率$\\beta$。这是在真实均值为$\\mu_a = 11.0$的条件下，观测到的样本均值$\\bar{X}$落入接受域的概率。在这个备择假设下，$\\bar{X}$的抽样分布是$N(\\mu_a, (SE)^2)$，即$N(11.0, (1/3)^2)$。\n\n$$ \\beta = P(\\bar{x}_{c, \\text{lower}} \\le \\bar{X} \\le \\bar{x}_{c, \\text{upper}} \\mid \\mu = \\mu_a) $$\n为了求这个概率，我们相对于真实均值$\\mu_a = 11.0$和标准误$SE = 1/3$来标准化接受域的边界。设$Z'$为一个标准正态随机变量。\n\n下界的Z分数是：\n$$ Z'_{\\text{lower}} = \\frac{\\bar{x}_{c, \\text{lower}} - \\mu_a}{SE} = \\frac{\\left(10.0 - \\frac{1.96}{3}\\right) - 11.0}{1/3} = \\frac{-1.0 - \\frac{1.96}{3}}{1/3} = -3.0 - 1.96 = -4.96 $$\n上界的Z分数是：\n$$ Z'_{\\text{upper}} = \\frac{\\bar{x}_{c, \\text{upper}} - \\mu_a}{SE} = \\frac{\\left(10.0 + \\frac{1.96}{3}\\right) - 11.0}{1/3} = \\frac{-1.0 + \\frac{1.96}{3}}{1/3} = -3.0 + 1.96 = -1.04 $$\n所以，第二类错误的概率是标准正态变量$Z'$落在$-4.96$和$-1.04$之间的概率：\n$$ \\beta = P(-4.96 \\le Z' \\le -1.04) = \\Phi(-1.04) - \\Phi(-4.96) $$\n其中$\\Phi(z)$是标准正态分布的累积分布函数。使用标准正态分布表或计算器：\n$$ \\Phi(-1.04) \\approx 0.14917 $$\n$$ \\Phi(-4.96) \\approx 0.00000035 $$\n因此，\n$$ \\beta \\approx 0.14917 - 0.00000035 = 0.14916965 $$\n将结果四舍五入到四位有效数字，我们得到$0.1492$。", "answer": "$$\\boxed{0.1492}$$", "id": "1965595"}, {"introduction": "II类错误的概念并非只适用于正态分布。这个练习将探讨如何为二项分布的结果计算 $\\beta$ 值，这在产品质量检验、用户行为研究或A/B测试等领域中非常常见。通过这个练习，您将理解核心原理如何应用于离散概率分布，此时我们需要使用求和而非积分来计算概率。[@problem_id:1965621]", "problem": "一家软件公司为一项困难的二元图像分类任务开发了一种新的机器学习算法。从历史上看，用于此任务的算法表现并不比随机猜测好。设 $p$ 为新算法正确分类图像的真实概率。该公司希望检验原假设 $H_0: p = 0.5$ 与备择假设 $H_1: p > 0.5$。\n\n一位质量保证（QA）工程师用一个包含 $n=12$ 张不同图像的基准集进行了一项实验。设随机变量 $X$ 为算法正确分类的图像数量。决策规则是，如果观察到的正确分类数等于或大于9，则拒绝原假设。\n\n假设在现实中，新算法的真实成功概率为 $p=0.75$。在此条件下，计算II类错误的概率，记作 $\\beta$。将你的答案四舍五入到四位有效数字。", "solution": "第二类错误发生在备择假设 $H_1$ 为真，但我们未能拒绝原假设 $H_0$ 的情况。我们将正确分类的图像数量建模为二项随机变量 $X \\sim \\text{Binomial}(n,p)$，其中 $n=12$。检验的决策规则是在观测值 $X \\ge 9$ 时拒绝 $H_0$。因此，第二类错误对应于在备择假设（真实成功概率 $p=0.75$）为真的情况下，观测值 $X \\le 8$。\n\n其概率 $\\beta$ 计算如下：\n$$\n\\beta = \\Pr(X \\leq 8 \\mid n=12, p=0.75) = \\sum_{k=0}^{8} \\binom{12}{k} (0.75)^{k} (0.25)^{12-k}.\n$$\n等价地，我们可以计算功效（$1-\\beta$），即 $\\Pr(X \\geq 9)$，然后求其补集：\n$$\n\\beta = 1 - \\Pr(X \\geq 9) = 1 - \\sum_{k=9}^{12} \\binom{12}{k} (0.75)^{k} (0.25)^{12-k}.\n$$\n设 $p=\\frac{3}{4}$ 且 $q=\\frac{1}{4}$。那么\n$$\n\\Pr(X \\geq 9) = \\sum_{k=9}^{12} \\binom{12}{k} \\left(\\frac{3}{4}\\right)^{k} \\left(\\frac{1}{4}\\right)^{12-k}\n= \\left(\\frac{3}{4}\\right)^{9} \\left(\\frac{1}{4}\\right)^{3} \\left[ \\binom{12}{9} + \\binom{12}{10}\\frac{3}{1} + \\binom{12}{11}\\frac{9}{1} + \\binom{12}{12}\\frac{27}{1} \\right].\n$$\n使用二项式系数值 $\\binom{12}{9}=220$，$\\binom{12}{10}=66$，$\\binom{12}{11}=12$，$\\binom{12}{12}=1$，方括号中的值等于：\n$$\n220 + 66 \\cdot 3 + 12 \\cdot 9 + 1 \\cdot 27 = 553.\n$$\n因此，\n$$\n\\Pr(X \\geq 9) = 553 \\cdot \\frac{3^{9}}{4^{12}} = \\frac{10{,}884{,}699}{16{,}777{,}216}.\n$$\n所以，\n$$\n\\beta = 1 - \\frac{10{,}884{,}699}{16{,}777{,}216} = \\frac{5{,}892{,}517}{16{,}777{,}216} \\approx 0.35122138.\n$$\n将结果四舍五入到四位有效数字，为 $0.3512$。", "answer": "$$\\boxed{0.3512}$$", "id": "1965621"}, {"introduction": "在检验设计完成后被动地计算 $\\beta$ 值，远不如在实验规划阶段就主动地控制它。这个练习将带您从计算转向设计，展示如何确定研究项目所需的最小样本量，以达到预期的统计功效（即 $1-\\beta$）。对于任何领域的科研人员和数据分析师来说，这都是一项至关重要的技能，能确保研究投入的资源足以高概率地检测到我们关心的真实效应。[@problem_id:1965641]", "problem": "环境科学家正在监测一个大湖中一种新管制农药的浓度。根据对类似湖泊的大量历史数据，已知该农药浓度服从正态分布，其标准差为 $\\sigma = 2.0$ ppm（百万分之几）。监管限制对应的平均浓度为 $\\mu_0 = 10.0$ ppm。科学家们希望建立一套监测方案，以检验该湖的平均浓度是否超过此限制。\n\n他们决定进行一次显著性水平为 $\\alpha = 0.05$ 的假设检验，以检验原假设 $H_0: \\mu = \\mu_0$ 和备择假设 $H_a: \\mu > \\mu_0$。该方案必须足够灵敏，以便有高的概率检测出有意义的违规。具体来说，如果真实平均浓度为 $\\mu_a = 11.0$ ppm，他们要求正确断定平均浓度超过限制的概率至少为 $0.90$。\n\n为了满足这些要求，科学家们必须采集的最少水样数量 $n$ 是多少？答案必须为整数。", "solution": "我们假设采集的 $n$ 个水样浓度 $X_{1},\\dots,X_{n}$ 是来自正态分布 $N(\\mu,\\sigma^{2})$ 的独立同分布（i.i.d.）随机变量，其中已知总体标准差 $\\sigma=2.0$ ppm。我们的目标是在显著性水平 $\\alpha=0.05$ 下检验原假设 $H_{0}:\\mu=\\mu_{0}=10.0$ 与备择假设 $H_{a}:\\mu>\\mu_{0}$。\n这是一个单侧Z检验，其检验统计量为：\n$$\nZ=\\frac{\\overline{X}-\\mu_{0}}{\\sigma/\\sqrt{n}},\n$$\n当 $Z$ 大于临界值 $z_{1-\\alpha}$ 时，我们拒绝 $H_{0}$。其中 $z_{p}$ 表示标准正态分布的第 $p$ 个分位数。\n\n统计功效（Power）是在备择假设 $\\mu=\\mu_{a}$ 为真时，我们正确拒绝 $H_0$ 的概率。在此条件下，检验统计量 $Z$ 服从均值为 $\\frac{\\mu_{a}-\\mu_{0}}{\\sigma/\\sqrt{n}}$、方差为1的正态分布。因此，检验在 $\\mu_{a}$ 处的功效为：\n$$\n\\text{Power}(\\mu_{a})=\\mathbb{P}\\!\\left(Z>z_{1-\\alpha}\\mid \\mu=\\mu_{a}\\right)=1-\\Phi\\!\\left(z_{1-\\alpha}-\\frac{\\mu_{a}-\\mu_{0}}{\\sigma}\\sqrt{n}\\right).\n$$\n题目要求在 $\\mu_a=11.0$ ppm 时，功效至少为 $0.90$（即第二类错误概率 $\\beta \\le 0.10$）。这等价于：\n$$\n1-\\Phi\\!\\left(z_{1-\\alpha}-\\frac{\\mu_{a}-\\mu_{0}}{\\sigma}\\sqrt{n}\\right)\\geq 0.90\n\\;\\;\\Longleftrightarrow\\;\\;\n\\Phi\\!\\left(z_{1-\\alpha}-\\frac{\\mu_{a}-\\mu_{0}}{\\sigma}\\sqrt{n}\\right)\\leq 0.10.\n$$\n对不等式两边取标准正态累积分布函数的逆函数（即分位数函数），我们得到：\n$$\nz_{1-\\alpha}-\\frac{\\mu_{a}-\\mu_{0}}{\\sigma}\\sqrt{n}\\leq z_{0.10}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{\\mu_{a}-\\mu_{0}}{\\sigma}\\sqrt{n}\\geq z_{1-\\alpha}-z_{0.10}.\n$$\n利用标准正态分布的对称性 $z_{0.10}=-z_{0.90}$，上式变为：\n$$\n\\frac{\\mu_{a}-\\mu_{0}}{\\sigma}\\sqrt{n}\\geq z_{1-\\alpha}+z_{0.90}\n\\;\\;\\Longleftrightarrow\\;\\;\nn\\geq \\left(\\frac{\\sigma\\left(z_{1-\\alpha}+z_{0.90}\\right)}{\\mu_{a}-\\mu_{0}}\\right)^{2}.\n$$\n现在代入具体数值：\n- 显著性水平 $\\alpha=0.05 \\implies z_{1-\\alpha}=z_{0.95}\\approx 1.644853$\n- 要求功效为 $0.90 \\implies z_{1-\\beta}=z_{0.90}\\approx 1.281552$\n- 总体标准差 $\\sigma=2.0$\n- 效应量 $\\mu_{a}-\\mu_{0}=11.0-10.0=1.0$\n\n计算得到：\n$$\nn\\geq \\left(\\frac{2.0\\left(1.644853+1.281552\\right)}{1.0}\\right)^{2}\n=\\left(2.0\\times 2.926405\\right)^{2}\n\\approx 5.852810^{2}\n\\approx 34.25.\n$$\n因为样本量 $n$ 必须是整数，所以我们必须向上取整以满足该不等式。不小于 $34.25$ 的最小整数是 $35$。因此，需要采集的最少水样数量为35。", "answer": "$$\\boxed{35}$$", "id": "1965641"}]}