{"hands_on_practices": [{"introduction": "检验统计量的构建是假设检验的第一步。一个好的检验统计量能够有效地概括样本信息，以判断原假设是否成立。本练习将带您回到最基本的场景：检验一个二元结果（如“合格”或“不合格”）的比例。通过这个练习，您将学会如何为一个关于比例的假设检验选择最直接的检验统计量，并确定在原假设 $H_0$ 成立时其精确的概率分布，这是执行精确检验的理论基石 [@problem_id:1958165]。", "problem": "一家半导体制造商开发了一种在硅晶片上制造逻辑门的新蚀刻工艺。该公司的内部规范声称，此工艺生产的次品门的比例恰好是 $p_0$。为了验证这一说法，一位质量控制工程师计划进行一项实验。从生产线上随机抽取 $n$ 个逻辑门的样本，并对每个门进行测试。这些测试是独立的，每个门被分类为“次品”或“非次品”。\n\n令 $X_i$ 为第 $i$ 个被测门的指示随机变量，如果该门是次品，则 $X_i=1$，否则 $X_i=0$。该工程师的目标是执行一个精确假设检验，检验原假设 $H_0: p = p_0$ 与双侧备择假设 $H_1: p \\neq p_0$，其中 $p$ 是次品门的真实比例。\n\n检验统计量，我们称之为 $T$，被选择为样本中观察到的次品门的总数。对于一项*精确*检验，假设原假设 $H_0$ 为真，以下哪个陈述正确地指出了检验统计量 $T$ 及其精确概率分布？\n\nA. 检验统计量是 $T = \\frac{\\sum_{i=1}^{n} X_i - n p_0}{\\sqrt{n p_0 (1-p_0)}}$，其在 $H_0$ 下的分布是标准正态分布，$N(0,1)$。\nB. 检验统计量是 $T = \\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布是参数为 $\\lambda = n p_0$ 的泊松分布。\nC. 检验统计量是 $T = \\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布是参数为 $n$ 和 $p_0$ 的二项分布。\nD. 检验统计量是 $T = \\frac{1}{n}\\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布是参数为 $p_0$ 的伯努利分布。\nE. 检验统计量是 $T = \\sum_{i=1}^{n} X_i$，其在 $H_0$ 下的分布是参数为 $p_0$ 的几何分布。", "solution": "在原假设 $H_{0}: p = p_{0}$ 下，每个指示变量 $X_{i}$ 是一个参数为 $p_{0}$ 的伯努利随机变量，即 $\\Pr(X_{i}=1 \\mid H_{0}) = p_{0}$ 且 $\\Pr(X_{i}=0 \\mid H_{0}) = 1 - p_{0}$。问题陈述中说明了测试是独立的，因此在 $H_{0}$ 下，$X_{1}, \\ldots, X_{n}$ 是独立同分布于 $\\text{Bernoulli}(p_{0})$。\n\n选择的检验统计量是次品总数，\n$$\nT = \\sum_{i=1}^{n} X_{i}.\n$$\n关于独立伯努利随机变量之和的一个基本结论是，其和服从二项分布。因此，在 $H_{0}$ 下，\n$$\nT \\sim \\text{Binomial}(n, p_{0}),\n$$\n其精确的概率质量函数为\n$$\n\\Pr(T = k \\mid H_{0}) = \\binom{n}{k} p_{0}^{k} (1 - p_{0})^{n-k}, \\quad k = 0, 1, \\ldots, n.\n$$\n\n这证实了在 $H_{0}$ 下 $T$ 的精确分布是参数为 $n$ 和 $p_{0}$ 的二项分布，这与选项 C 相符。为了完整性，我们讨论其他选项：选项 A 通过中心极限定理对 $T$ 进行标准化以使用正态近似，这不是精确的；选项 B 使用泊松近似，这在 $n$ 很大且 $p_{0}$ 很小时有效，但也不是精确的；选项 D 使用样本比例，其精确分布是经过缩放的二项分布，而非伯努利分布；选项 E 指的是几何分布，它适用于直到出现第一个次品所需的试验次数，这与所定义的 $T$ 不符。", "answer": "$$\\boxed{C}$$", "id": "1958165"}, {"introduction": "当检验单个参数之后，我们常常需要评估一组观测数据是否符合一个特定的理论概率分布模型。卡方（$\\chi^2$）拟合优度检验是解决此类问题的经典工具，它通过比较观测频数与理论预期频数之间的差异来做出判断。本练习将您置于一个网络流量分析的实际场景中，要求您亲手计算 $\\chi^2$ 统计量，以检验用户会话请求数是否遵循泊松分布。这个过程将加深您对如何应用 $\\chi^2$ 检验来评估模型拟合度的理解 [@problem_id:1958160]。", "problem": "一位热门视频流服务的网络管理员正在分析高峰时段的流量模式。该管理员假设每秒到达的新用户会话请求数遵循泊松分布，其均值为 $\\lambda = 3.0$。为检验此假设，管理员记录了 200 个不同的一秒时间间隔内的请求数。观测到的频率总结在下表中：\n\n| 每秒请求数 | 观测频率（时间间隔数） |\n|:-----------------------------:|:----------------------------------------:|\n| 0                             | 8                                        |\n| 1                             | 32                                       |\n| 2                             | 45                                       |\n| 3                             | 50                                       |\n| 4                             | 35                                       |\n| 5                             | 20                                       |\n| 6 或更多                     | 10                                       |\n\n使用这些数据，计算卡方（$\\chi^2$）拟合优度检验统计量的值，以评估管理员的假设。将您的最终答案四舍五入到三位有效数字。", "solution": "我们对 $N=200$ 个一秒时间间隔检验一个均值为 $\\lambda=3$ 的泊松模型。对于一个泊松$(\\lambda)$随机变量 $X$，其概率为 $p_{k}=\\Pr(X=k)=\\exp(-\\lambda)\\lambda^{k}/k!$。每个类别的期望频率为 $E_{k}=N\\,p_{k}$，对于分组的尾部 $k\\geq 6$，我们使用 $p_{\\geq 6}=1-\\sum_{k=0}^{5}p_{k}$，其期望频率为 $E_{\\geq 6}=N\\,p_{\\geq 6}$。当 $\\lambda=3$ 时，\n$$\n\\begin{aligned}\np_{0}&=\\exp(-3),\\\\\np_{1}&=3\\exp(-3),\\\\\np_{2}&=\\frac{3^{2}}{2}\\exp(-3),\\\\\np_{3}&=\\frac{3^{3}}{3!}\\exp(-3)=p_{2},\\\\\np_{4}&=\\frac{3}{4}p_{3},\\\\\np_{5}&=\\frac{3}{5}p_{4},\\\\\np_{\\geq 6}&=1-\\sum_{k=0}^{5}p_{k}.\n\\end{aligned}\n$$\n数值上，\n$$\n\\begin{aligned}\n&p_{0}\\approx 0.0497871,\\quad p_{1}\\approx 0.149361,\\quad p_{2}\\approx 0.224042,\\quad p_{3}\\approx 0.224042,\\\\\n&p_{4}\\approx 0.168031,\\quad p_{5}\\approx 0.100819,\\quad p_{\\geq 6}\\approx 0.0839179,\n\\end{aligned}\n$$\n因此\n$$\n\\begin{aligned}\n&E_{0}\\approx 9.95741,\\; E_{1}\\approx 29.87224,\\; E_{2}\\approx 44.80836,\\; E_{3}\\approx 44.80836,\\\\\n&E_{4}\\approx 33.60627,\\; E_{5}\\approx 20.16376,\\; E_{\\geq 6}\\approx 16.78359,\n\\end{aligned}\n$$\n它们的和为 $200$，符合要求。卡方统计量为\n$$\n\\chi^{2}=\\sum_{\\text{cats}}\\frac{(O-E)^{2}}{E},\n$$\n观测计数为 $(O_{0},O_{1},O_{2},O_{3},O_{4},O_{5},O_{\\geq 6})=(8,32,45,50,35,20,10)$。计算每一项：\n$$\n\\begin{aligned}\n&\\frac{(8-9.95741)^{2}}{9.95741}\\approx 0.3847,\\quad \\frac{(32-29.87224)^{2}}{29.87224}\\approx 0.1516,\\\\\n&\\frac{(45-44.80836)^{2}}{44.80836}\\approx 0.000820,\\quad \\frac{(50-44.80836)^{2}}{44.80836}\\approx 0.6013,\\\\\n&\\frac{(35-33.60627)^{2}}{33.60627}\\approx 0.0578,\\quad \\frac{(20-20.16376)^{2}}{20.16376}\\approx 0.00133,\\\\\n&\\frac{(10-16.78359)^{2}}{16.78359}\\approx 2.7406.\n\\end{aligned}\n$$\n求和得出\n$$\n\\chi^{2}\\approx 3.94,\n$$\n四舍五入到三位有效数字为 $3.94$。", "answer": "$$\\boxed{3.94}$$", "id": "1958160"}, {"introduction": "当面对不标准的假设或复杂模型时，我们可能无法直接找到一个现成的、直观的检验统计量。在这种情况下，广义似然比检验（GLRT）提供了一种强大且具有普适性的系统方法来构建检验统计量。本练习将挑战您从第一性原理出发，为正态分布中一个非常规的假设 $H_0: \\mu = \\sigma$ 推导广义似然比检验统计量 $\\Lambda$。通过解决这个问题，您将实践如何通过最大化似然函数来构造统计量，从而深刻理解假设检验与最大似然原理之间的内在联系 [@problem_id:1958121]。", "problem": "某种光纤的质量控制协议要求其平均折射率 $\\mu$ 必须等于其标准差 $\\sigma$。假设随机选取的光纤的折射率服从正态分布 $N(\\mu, \\sigma^2)$，其中 $\\mu$ 和 $\\sigma$ 均为正数。采集一个大小为 $n$ 的随机样本 $X_1, \\dots, X_n$ 来检验原假设 $H_0: \\mu = \\sigma$ 与备择假设 $H_A: \\mu \\neq \\sigma$。令 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^n X_i$ 为样本均值，令 $S^2 = \\frac{1}{n}\\sum_{i=1}^n (X_i - \\bar{X})^2$ 为无约束模型下，方差的最大似然估计量。推导广义似然比检验统计量 $\\Lambda$ 关于 $n$、$\\bar{X}$ 和 $S^2$ 的解析表达式。", "solution": "我们观测到来自 $N(\\mu,\\sigma^{2})$ 的独立同分布观测值 $X_{1},\\dots,X_{n}$，其中 $\\mu>0$ 且 $\\sigma>0$。似然函数为\n$$\nL(\\mu,\\sigma^{2})=(2\\pi)^{-n/2}\\sigma^{-n}\\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\mu)^{2}\\right).\n$$\n无约束下的最大似然估计量为 $\\hat{\\mu}=\\bar{X}$ 和 $\\hat{\\sigma}^{2}=S^{2}$，其中 $S^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}$。无约束模型下的最大化似然为\n$$\n\\sup_{\\mu,\\sigma>0}L=L(\\bar{X},S^{2})=(2\\pi)^{-n/2}(S^{2})^{-n/2}\\exp\\left(-\\frac{n}{2}\\right).\n$$\n\n在 $H_{0}:\\mu=\\sigma=\\theta>0$ 下，似然函数变为\n$$\nL_{0}(\\theta)=(2\\pi)^{-n/2}\\theta^{-n}\\exp\\left(-\\frac{1}{2\\theta^{2}}\\sum_{i=1}^{n}(X_{i}-\\theta)^{2}\\right).\n$$\n将 $\\sum_{i=1}^{n}(X_{i}-\\theta)^{2}=nS^{2}+n(\\bar{X}-\\theta)^{2}$ 代入，因此\n$$\n\\ln L_{0}(\\theta)=-\\frac{n}{2}\\ln(2\\pi)-n\\ln\\theta-\\frac{n}{2\\theta^{2}}\\left(S^{2}+(\\bar{X}-\\theta)^{2}\\right).\n$$\n对 $\\theta$ 求导并令其为零：\n$$\n\\frac{d}{d\\theta}\\ln L_{0}(\\theta)=-\\frac{n}{\\theta}+\\frac{1}{\\theta^{3}}\\sum_{i=1}^{n}(X_{i}-\\theta)^{2}-\\frac{n}{\\theta^{2}}(\\theta-\\bar{X})=0.\n$$\n两边乘以 $\\theta^{3}$ 并使用 $\\sum_{i=1}^{n}(X_{i}-\\theta)^{2}=\\sum_{i=1}^{n}X_{i}^{2}-2n\\theta\\bar{X}+n\\theta^{2}$ 得到\n$$\n\\sum_{i=1}^{n}X_{i}^{2}-n\\theta\\bar{X}-n\\theta^{2}=0.\n$$\n两边除以 $n$ 并使用 $\\frac{1}{n}\\sum_{i=1}^{n}X_{i}^{2}=\\bar{X}^{2}+S^{2}$ 得到二次方程\n$$\n\\theta^{2}+\\bar{X}\\theta-(\\bar{X}^{2}+S^{2})=0.\n$$\n由于 $\\theta>0$，约束下的最大似然估计量(MLE)是\n$$\n\\hat{\\theta}=\\frac{-\\bar{X}+\\sqrt{5\\bar{X}^{2}+4S^{2}}}{2}.\n$$\n在 $H_{0}$ 下的最大化似然为\n$$\n\\sup_{H_{0}}L=L_{0}(\\hat{\\theta})=(2\\pi)^{-n/2}\\hat{\\theta}^{-n}\\exp\\left(-\\frac{n}{2\\hat{\\theta}^{2}}\\left(S^{2}+(\\bar{X}-\\hat{\\theta})^{2}\\right)\\right).\n$$\n\n广义似然比为\n$$\n\\Lambda=\\frac{\\sup_{H_{0}}L}{\\sup L}=\\left(\\frac{S^{2}}{\\hat{\\theta}^{2}}\\right)^{n/2}\\exp\\left(-\\frac{n}{2}\\left(\\frac{S^{2}+(\\bar{X}-\\hat{\\theta})^{2}}{\\hat{\\theta}^{2}}-1\\right)\\right).\n$$\n使用得分方程 $S^{2}+\\bar{X}^{2}-\\hat{\\theta}\\bar{X}-\\hat{\\theta}^{2}=0$，我们简化\n$$\n\\frac{S^{2}+(\\bar{X}-\\hat{\\theta})^{2}}{\\hat{\\theta}^{2}}=\\frac{2\\hat{\\theta}^{2}-\\hat{\\theta}\\bar{X}}{\\hat{\\theta}^{2}}=2-\\frac{\\bar{X}}{\\hat{\\theta}},\n$$\n所以\n$$\n\\Lambda=\\left(\\frac{S^{2}}{\\hat{\\theta}^{2}}\\right)^{n/2}\\exp\\left(-\\frac{n}{2}+\\frac{n\\bar{X}}{2\\hat{\\theta}}\\right).\n$$\n代入 $\\hat{\\theta}=\\frac{-\\bar{X}+\\sqrt{5\\bar{X}^{2}+4S^{2}}}{2}$，将所有项表示为 $n$、$\\bar{X}$ 和 $S^2$ 的函数。注意到 $\\frac{S^{2}}{\\hat{\\theta}^{2}}=\\frac{4S^{2}}{(\\sqrt{5\\bar{X}^{2}+4S^{2}}-\\bar{X})^{2}}$ 和 $\\frac{\\bar{X}}{\\hat{\\theta}}=\\frac{2\\bar{X}}{\\sqrt{5\\bar{X}^{2}+4S^{2}}-\\bar{X}}$，广义似然比检验(GLRT)统计量为\n$$\n\\Lambda=\\left(\\frac{4S^{2}}{(\\sqrt{5\\bar{X}^{2}+4S^{2}}-\\bar{X})^{2}}\\right)^{\\frac{n}{2}}\\exp\\left(-\\frac{n}{2}+\\frac{n\\bar{X}}{\\sqrt{5\\bar{X}^{2}+4S^{2}}-\\bar{X}}\\right).\n$$\n这就是所需的关于 $n$、$\\bar{X}$ 和 $S^{2}$ 的解析表达式。", "answer": "$$\\boxed{\\left(\\frac{4S^{2}}{\\left(\\sqrt{5\\bar{X}^{2}+4S^{2}}-\\bar{X}\\right)^{2}}\\right)^{\\frac{n}{2}}\\exp\\left(-\\frac{n}{2}+\\frac{n\\bar{X}}{\\sqrt{5\\bar{X}^{2}+4S^{2}}-\\bar{X}}\\right)}$$", "id": "1958121"}]}