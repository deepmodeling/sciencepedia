{"hands_on_practices": [{"introduction": "本练习将带我们回归构建最优检验的核心——Neyman-Pearson引理。通过一个关于均匀分布的假设检验问题，我们将从第一性原理出发，学习如何通过分析似然比来构造最强有力的检验拒绝域，尤其是在似然比并非连续函数这种非标准情况下。这个实践旨在深化对似然比检验本质的理解，并展示如何处理包含随机化决策的检验问题[@problem_id:1912211]。", "problem": "从一个概率分布中抽取一个大小为 $n=2$ 的随机样本，记为 $X_1$ 和 $X_2$。该分布的概率密度函数为 $f(x;\\theta) = 1$（当 $x \\in (\\theta, \\theta+1)$ 时），而在其他情况下为 $0$。这是一个在区间 $(\\theta, \\theta+1)$ 上的均匀分布。\n\n考虑一个假设检验，其原假设为 $H_0: \\theta = 0$，备择假设为 $H_1: \\theta = 0.5$。为此，我们构建一个最有效检验，其指定的显著性水平（检验水平）为 $\\alpha = 0.1$。\n\n计算此检验的功效。请将答案表示为小数。", "solution": "我们有 $X_{1},X_{2}$ 独立同分布，其密度函数为 $f(x;\\theta)=1$（在 $(\\theta,\\theta+1)$ 上）且在其他情况下为 $0$。我们通过 Neyman–Pearson 引理构建一个最有效检验，在检验水平 $\\alpha=0.1$ 下检验 $H_{0}:\\theta=0$ 与 $H_{1}:\\theta=0.5$。\n\n在 $H_{0}$ 下，联合支撑集为 $S_{0}=(0,1)^{2}$；在 $H_{1}$ 下，联合支撑集为 $S_{1}=(0.5,1.5)^{2}$。对于一个样本 $(x_{1},x_{2})$，似然比为\n$$\n\\Lambda(x_{1},x_{2})=\\frac{f(x_{1};0.5)f(x_{2};0.5)}{f(x_{1};0)f(x_{2};0)}.\n$$\n因为每个联合密度在其支撑集上的值为 $1$，而在支撑集外的值为 $0$，所以 $\\Lambda$ 只取 $0,1,\\infty$ 这几个值，具体来说：\n- 如果 $(x_{1},x_{2})\\in S_{1}\\setminus S_{0}$，则 $\\Lambda=\\infty$，在这里意味着 $x_{1},x_{2}$ 中至少有一个落在 $(1,1.5)$ 区间内；\n- 如果 $(x_{1},x_{2})\\in S_{0}\\cap S_{1}=(0.5,1)^{2}$，则 $\\Lambda=1$；\n- 如果 $(x_{1},x_{2})\\in S_{0}\\setminus S_{1}$，则 $\\Lambda=0$，在这里意味着 $x_{1},x_{2}$ 中至少有一个落在 $(0,0.5)$ 区间内。\n\n根据 Neyman–Pearson 引理，检验水平为 $\\alpha$ 的最有效检验在 $\\Lambda>\\eta$ 时拒绝 $H_{0}$，并在 $\\Lambda=\\eta$ 的集合上进行随机化，以达到确切的检验水平。由于在 $H_{0}$ 下，$(x_{1},x_{2})\\in S_{1}\\setminus S_{0}$ 的概率为 $0$，为了达到检验水平 $\\alpha$，我们必须在 $\\Lambda=1$ 的集合 $A=(0.5,1)^{2}$ 上进行随机化。设当 $(X_{1},X_{2})\\in A$ 时，检验以概率 $r$ 拒绝；当 $(X_{1},X_{2})\\in B=S_{1}\\setminus S_{0}$ 时，以概率 $1$ 拒绝；其他情况下不拒绝。\n\n在 $H_{0}$ 下，$X_{i}\\sim \\text{Uniform}(0,1)$，所以 $P_{0}(A)=P_{0}(X_{1}\\in(0.5,1),X_{2}\\in(0.5,1))=(\\frac{1}{2})^{2}=\\frac{1}{4}$。检验水平条件要求\n$$\n\\alpha=P_{0}(\\text{拒绝})=r\\,P_{0}(A)=r\\cdot \\frac{1}{4},\n$$\n所以\n$$\nr=\\frac{\\alpha}{P_{0}(A)}=\\frac{0.1}{\\frac{1}{4}}=0.4.\n$$\n\n现在计算在 $H_{1}$ 下的功效。此时 $X_{i}\\sim \\text{Uniform}(0.5,1.5)$。那么 $P_{0.5}(A)=P_{0.5}(X_{1},X_{2}\\in(0.5,1))=(\\frac{1}{2})^{2}=\\frac{1}{4}$ 且 $P_{0.5}(B)=1-P_{0.5}(A)=1-\\frac{1}{4}=\\frac{3}{4}$，因为在 $H_{1}$ 下，只有 $A$ 和 $B$ 这两种情况具有正概率。因此，功效为\n$$\nP_{0.5}(\\text{拒绝})=P_{0.5}(B)\\cdot 1 + P_{0.5}(A)\\cdot r=\\frac{3}{4}+\\frac{1}{4}\\cdot 0.4=0.75+0.1=0.85.\n$$\n因此，检验水平为 $0.1$ 的最有效检验的功效是 $0.85$。", "answer": "$$\\boxed{0.85}$$", "id": "1912211"}, {"introduction": "在掌握了简单假设检验后，我们现在将目光投向更具实际意义的复合假设问题。本练习介绍了一致最强检验 (UMP) 的概念，它是在特定条件下对于一类假设都具有最优性的检验。我们将通过一个关于零截尾泊松分布的生态学案例，运用Karlin-Rubin定理，并根据给定的显著性水平 $\\alpha$ 来确定检验统计量的具体临界值[@problem_id:1912193]。", "problem": "一个野生动物生物学家团队正在一个受保护的栖息地研究一种特定鸟类的繁殖成功率。他们观察到，一对筑巢的鸟儿总会至少养活一只幼鸟。他们使用零截断泊松（ZTP）分布来模拟一个成功鸟巢中幼鸟的数量 $X$。一个速率参数为 $\\lambda > 0$ 的ZTP随机变量的概率质量函数（PMF）由下式给出：\n$$ P(X=k) = \\frac{\\lambda^k}{k! (e^\\lambda - 1)} \\quad \\text{for } k = 1, 2, 3, \\ldots $$\n生物学家们从 $n=8$ 个鸟巢的随机样本中收集数据，记录下的幼鸟数量为 $X_1, X_2, \\ldots, X_8$。一个标准的生态学理论预测，速率参数应为 $\\lambda=2$。生物学家们希望检验最近的环境变化是否导致了此速率的增加。他们设立了如下的假设检验：\n$H_0: \\lambda \\le 2$ 对立于备择假设 $H_1: \\lambda > 2$。\n\n该团队决定使用 $\\alpha = 0.10$ 的显著性水平。根据统计理论中的一个已知结果，此问题的一致最强检验 (UMP) 的临界域（拒绝域）由以下形式的规则定义：如果 $\\sum_{i=1}^8 X_i \\ge k$，则拒绝 $H_0$，其中 $k$ 为某个整数。\n\n为了找到 $k$ 的具体值，该团队使用统计软件计算了在原假设的边界条件 $\\lambda=2$ 下，检验统计量 $Y = \\sum_{i=1}^8 X_i$ 的累积分布函数（CDF）。下面提供了 $Y$ 的部分CDF表：\n- $P(Y \\le 21) = 0.8851$\n- $P(Y \\le 22) = 0.9214$\n- $P(Y \\le 23) = 0.9498$\n- $P(Y \\le 24) = 0.9696$\n\n确定定义此UMP检验临界域的最小整数 $k$ 值。", "solution": "我们有来自参数为 $\\lambda$ 的零截断泊松分布的独立同分布的 $X_{1},\\ldots,X_{8}$，其概率质量函数可写作\n$$\nP(X=k)=\\frac{\\lambda^{k}}{k!\\left(\\exp(\\lambda)-1\\right)},\\quad k=1,2,\\ldots\n$$\n该模型是一个单参数指数族，其似然比在统计量 $Y=\\sum_{i=1}^{8}X_{i}$ 上是单调的。根据 Karlin–Rubin 定理，对于检验 $H_{0}:\\lambda\\le 2$ 对立于 $H_{1}:\\lambda>2$，显著性水平为 $\\alpha$ 的一致最大功效检验在 $Y$ 值较大时拒绝 $H_{0}$，即其临界域的形式为 $\\{Y\\ge k\\}$，其中 $k$ 为某个整数阈值。\n\n为了在显著性水平 $\\alpha=0.10$ 下选择 $k$，我们在 $H_{0}$ 的边界，即 $\\lambda=2$ 下，施加检验势的约束：\n$$\nP_{\\lambda=2}(Y\\ge k)\\le 0.10,\n$$\n并且我们选择满足此条件的最小整数 $k$ 以使功效最大化。等价地，\n$$\nP_{\\lambda=2}(Y\\le k-1)\\ge 0.90.\n$$\n使用在 $\\lambda=2$ 条件下提供的累积概率：\n- 对于 $k=22$：$P(Y\\ge 22)=1-P(Y\\le 21)=1-0.8851=0.1149>0.10$，因此 $k=22$ 不可接受。\n- 对于 $k=23$：$P(Y\\ge 23)=1-P(Y\\le 22)=1-0.9214=0.0786\\le 0.10$，因此 $k=23$ 满足水平约束。\n\n因为 $k=22$ 不满足条件而 $k=23$ 满足，所以最小的整数 $k$ 是 $k=23$。", "answer": "$$\\boxed{23}$$", "id": "1912193"}, {"introduction": "并非所有的假设检验问题都存在一个唯一的“最佳”拒绝域。本练习探讨了双边检验的情形，在这种情况下，一致最强检验 (UMP) 通常是不存在的。通过比较标准对称双尾检验与一个非对称检验的功效，我们将深入理解检验拒绝域的“形状”如何影响其在不同备择方向上的探测能力，这揭示了在设计检验时必须做出的重要权衡[@problem_id:1912207]。", "problem": "一位质量控制工程师正在对一大批电阻器的平均电阻进行假设检验。已知一个电阻器的电阻（记为 $X$）服从均值为 $\\mu$、已知标准差为 $\\sigma = 4.0$ 欧姆的正态分布。目标平均电阻为 $\\mu_0 = 100.0$ 欧姆。该工程师基于一个大小为 $n=16$ 的随机样本，检验原假设 $H_0: \\mu = \\mu_0$ 与双侧备择假设 $H_1: \\mu \\neq \\mu_0$。检验的显著性水平为 $\\alpha = 0.05$。\n\n工程师考虑了检验统计量 $Z = \\frac{\\bar{X} - \\mu_0}{\\sigma/\\sqrt{n}}$ 的两种不同拒绝域，其中 $\\bar{X}$ 是样本均值。两种检验的检验水平均为 $\\alpha$。\n\n**检验 S (对称):** 这是标准的双尾检验。当 $|Z| > z_{\\alpha/2}$ 时拒绝 $H_0$，其中 $z_p$ 是标准正态分布的上 $p$-分位数（即 $P(N(0,1) > z_p) = p$）。\n\n**检验 A (非对称):** 该检验使用非对称拒绝域。第一类错误的总概率仍为 $\\alpha$，但它被分配到左尾的概率为 $\\alpha/4$，分配到右尾的概率为 $3\\alpha/4$。\n\n检验的功效是指在备择假设下，对于某个特定的 $\\mu$ 值，检验能正确拒绝原假设的概率。工程师想要在真实平均电阻为 $\\mu_1 = 102.0$ 欧姆的情况下，比较这两种检验的功效。\n\n计算在 $\\mu_1 = 102.0$ 欧姆时，检验 A 的功效与检验 S 的功效之比。\n\n为方便计算，您可以使用以下标准正态分位数及其累积分布函数 (CDF) $\\Phi(z)$ 的值：\n- 分位数: $z_{0.025} = 1.960$, $z_{0.0125} = 2.241$, $z_{0.0375} = 1.781$。\n- CDF 值: $\\Phi(-4.241) = 1.12 \\times 10^{-5}$, $\\Phi(-3.960) = 3.72 \\times 10^{-5}$, $\\Phi(0.040) = 0.5160$, $\\Phi(0.219) = 0.5867$。\n\n将最终答案四舍五入到四位有效数字。", "solution": "我们在 $\\sigma$ 已知的情况下，使用统计量 $Z=\\dfrac{\\bar{X}-\\mu_{0}}{\\sigma/\\sqrt{n}}$ 来检验 $H_{0}:\\mu=\\mu_{0}$。在真实均值为 $\\mu$ 时，$Z$ 的分布是正态分布，其均值为\n$$\n\\delta=\\frac{\\mu-\\mu_{0}}{\\sigma/\\sqrt{n}}\n$$\n方差为1。在本题中，$\\sigma=4.0$，$n=16$，$\\mu_{0}=100.0$，我们在 $\\mu_{1}=102.0$ 处计算功效，所以\n$$\n\\delta=\\frac{102.0-100.0}{4.0/\\sqrt{16}}=\\frac{2.0}{1.0}=2,\n$$\n因此在 $\\mu=\\mu_{1}$ 的条件下，$Z\\sim N(2,1)$。\n\n检验 S (对称) 在 $|Z|>z_{\\alpha/2}$ 时拒绝原假设，其中 $\\alpha=0.05$，所以 $z_{\\alpha/2}=z_{0.025}=1.960$。其在 $\\mu_{1}$ 处的功效为\n$$\n\\pi_{S}(\\mu_{1})=\\Pr_{\\mu_{1}}(|Z|>1.960)=\\Pr(Z<-1.960)+\\Pr(Z>1.960).\n$$\n设 $Z=2+Y$ 且 $Y\\sim N(0,1)$，则\n$$\n\\Pr(Z>1.960)=\\Pr\\!\\left(Y>1.960-2\\right)=\\Pr(Y>-0.040)=\\Phi(0.040),\n$$\n$$\n\\Pr(Z<-1.960)=\\Pr\\!\\left(Y<-1.960-2\\right)=\\Phi(-3.960).\n$$\n使用所给的值 $\\Phi(0.040)=0.5160$ 和 $\\Phi(-3.960)=3.72\\times 10^{-5}$，我们得到\n$$\n\\pi_{S}(\\mu_{1})=0.5160+3.72\\times 10^{-5}=0.5160372.\n$$\n\n检验 A (非对称) 将 $\\alpha/4$ 的概率分配给左尾，将 $3\\alpha/4$ 的概率分配给右尾。其临界值为 $c_{L}$ 和 $c_{R}$，满足 $\\Pr_{H_{0}}(Z<c_{L})=\\alpha/4=0.0125$ 且 $\\Pr_{H_{0}}(Z>c_{R})=3\\alpha/4=0.0375$。根据给定的分位数，$c_{L}=-z_{0.0125}=-2.241$ 且 $c_{R}=z_{0.0375}=1.781$。其在 $\\mu_{1}$ 处的功效为\n$$\n\\pi_{A}(\\mu_{1})=\\Pr_{\\mu_{1}}(Z<-2.241)+\\Pr_{\\mu_{1}}(Z>1.781).\n$$\n同样设 $Z=2+Y$，$Y\\sim N(0,1)$，则\n$$\n\\Pr(Z<-2.241)=\\Pr\\!\\left(Y<-2.241-2\\right)=\\Phi(-4.241),\n$$\n$$\n\\Pr(Z>1.781)=\\Pr\\!\\left(Y>1.781-2\\right)=\\Pr(Y>-0.219)=\\Phi(0.219).\n$$\n使用所给的值 $\\Phi(-4.241)=1.12\\times 10^{-5}$ 和 $\\Phi(0.219)=0.5867$，我们得到\n$$\n\\pi_{A}(\\mu_{1})=0.5867+1.12\\times 10^{-5}=0.5867112.\n$$\n\n所求的功效之比为\n$$\nR=\\frac{\\pi_{A}(\\mu_{1})}{\\pi_{S}(\\mu_{1})}=\\frac{0.5867112}{0.5160372}\\approx 1.136955\\ldots\n$$\n四舍五入到四位有效数字，\n$$\nR\\approx 1.137.\n$$", "answer": "$$\\boxed{1.137}$$", "id": "1912207"}]}