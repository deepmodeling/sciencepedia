{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于根据观测数据更新我们对未知参数的信念。本练习将通过一个经典场景来实践这一过程：使用伽玛-泊松共轭模型来估计一个事件的发生率。通过这个练习，你将看到当先验分布与似然函数具有共轭关系时，后验分布的计算如何被极大地简化，只需通过简单的算术运算即可更新分布的参数。", "problem": "一位物理学家正在使用一种新传感器研究宇宙射线探测的速率。在固定的时间间隔内，探测到的次数 $k$ 服从泊松分布，其率参数 $\\lambda$ 未知。泊松分布的概率质量函数为 $P(k|\\lambda) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $k = 0, 1, 2, \\dots$。\n\n在进行实验之前，该物理学家关于速率 $\\lambda$（单位：次/小时）的先验信念可以用一个伽马分布来描述。形状参数为 $\\alpha$、率参数为 $\\beta$ 的伽马分布的概率密度函数为 $p(\\lambda|\\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta\\lambda)$，其中 $\\lambda > 0$。该物理学家的先验分布由形状参数 $\\alpha_{prior} = 10$ 和率参数 $\\beta_{prior} = 2$ 指定。\n\n在单次一小时的观测期内，该物理学家记录到5次宇宙射线探测。\n\n根据这次观测，确定 $\\lambda$ 的后验分布的形状参数和率参数。请将你的答案表示为一个数对：先写后验形状参数，再写后验率参数。", "solution": "我们将一小时内的计数建模为 $k \\sim \\text{Poisson}(\\lambda)$，其似然函数为\n$$\nP(k \\mid \\lambda)=\\frac{\\lambda^{k}\\exp(-\\lambda)}{k!}.\n$$\n$\\lambda$ 的先验分布为 $\\lambda \\sim \\text{Gamma}(\\alpha_{\\text{prior}},\\beta_{\\text{prior}})$，其密度函数为\n$$\np(\\lambda \\mid \\alpha_{\\text{prior}},\\beta_{\\text{prior}})=\\frac{\\beta_{\\text{prior}}^{\\alpha_{\\text{prior}}}}{\\Gamma(\\alpha_{\\text{prior}})}\\lambda^{\\alpha_{\\text{prior}}-1}\\exp(-\\beta_{\\text{prior}}\\lambda), \\quad \\lambda>0.\n$$\n根据贝叶斯法则，后验分布正比于似然乘以先验：\n$$\np(\\lambda \\mid k)\\propto P(k\\mid \\lambda)\\,p(\\lambda \\mid \\alpha_{\\text{prior}},\\beta_{\\text{prior}})\n\\propto \\left[\\lambda^{k}\\exp(-\\lambda)\\right]\\left[\\lambda^{\\alpha_{\\text{prior}}-1}\\exp(-\\beta_{\\text{prior}}\\lambda)\\right].\n$$\n合并 $\\lambda$ 的幂次项和指数项：\n$$\np(\\lambda \\mid k)\\propto \\lambda^{(\\alpha_{\\text{prior}}+k)-1}\\exp\\!\\left(-(\\beta_{\\text{prior}}+1)\\lambda\\right).\n$$\n这是一个伽马分布的核，其形状参数为 $\\alpha_{\\text{post}}=\\alpha_{\\text{prior}}+k$，率参数为 $\\beta_{\\text{post}}=\\beta_{\\text{prior}}+1$（其中的 $+1$ 来自于一小时的观测窗口）。\n\n代入给定值 $\\alpha_{\\text{prior}}=10$，$\\beta_{\\text{prior}}=2$ 和 $k=5$：\n$$\n\\alpha_{\\text{post}}=10+5=15, \\quad \\beta_{\\text{post}}=2+1=3.\n$$\n因此，后验分布为 $\\text{Gamma}(15,3)$，所以所求的数对是后验形状参数和率参数 $(15,3)$。", "answer": "$$\\boxed{\\begin{pmatrix}15 & 3\\end{pmatrix}}$$", "id": "1909044"}, {"introduction": "许多现实世界的问题涉及对多个类别进行建模，例如文本分类或本例中的天体分类。狄利克雷-多项式模型是处理这类问题的强大工具，其中狄利克雷分布是多项式似然函数的共轭先验。这个练习将带你从单参数模型过渡到多参数模型，体验如何更新一个概率向量的信念，同时保持其各分量之和为1的约束。", "problem": "一位天文学家正在使用一种新的自动分类算法，对一台巡天望远镜观测到的天体进行分类。该算法将每个探测到的天体分为三类之一：恒星 (Star)、星系 (Galaxy) 或星云 (Nebula)。设任一给定天体属于这三类的未知概率分别为 $p_S$、$p_G$ 和 $p_N$，其中 $p_S + p_G + p_N = 1$。\n\n这位天文学家对概率向量 $\\mathbf{p} = (p_S, p_G, p_N)$ 的先验信念由一个狄利克雷分布 (Dirichlet distribution) 建模，其参数为 $\\boldsymbol{\\alpha} = (\\alpha_S, \\alpha_G, \\alpha_N) = (3, 5, 2)$。\n\n经过一次试运行，该算法被应用于一组新的观测数据，得出以下计数：40个恒星，50个星系和10个星云。\n\n在观测到这些新数据后，概率向量 $\\mathbf{p}$ 的后验狄利克雷分布 (posterior Dirichlet distribution) 的参数是什么？请以行矩阵 $\\begin{pmatrix} \\alpha'_S & \\alpha'_G & \\alpha'_N \\end{pmatrix}$ 的形式给出你的答案。", "solution": "我们用参数为 $\\boldsymbol{\\alpha}=(\\alpha_{S},\\alpha_{G},\\alpha_{N})=(3,5,2)$ 的狄利克雷先验 (Dirichlet prior) 对类别概率 $\\mathbf{p}=(p_{S},p_{G},p_{N})$ 进行建模，记作 $\\mathbf{p}\\sim\\mathrm{Dir}(\\alpha_{S},\\alpha_{G},\\alpha_{N})$。数据由多项式采样 (multinomial sampling) 的计数组成：$n_{S}=40$，$n_{G}=50$ 和 $n_{N}=10$。根据狄利克雷-多项式共轭性 (Dirichlet-multinomial conjugacy)，后验分布也是狄利克雷分布，其更新后的参数按分量由下式给出：\n$$\n\\alpha'_{k}=\\alpha_{k}+n_{k}\\quad\\text{for}\\quad k\\in\\{S,G,N\\}.\n$$\n应用此更新规则可得\n$$\n\\alpha'_{S}=3+40=43,\\quad \\alpha'_{G}=5+50=55,\\quad \\alpha'_{N}=2+10=12.\n$$\n因此，后验狄利克雷分布的参数为\n$$\n\\begin{pmatrix}43 & 55 & 12\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}43 & 55 & 12\\end{pmatrix}}$$", "id": "1909019"}, {"introduction": "在科学测量中，我们常常假设测量误差服从正态分布。当未知参数的先验信念也为正态分布时，便构成了正态-正态共轭模型，这在处理连续数据时非常有用。本练习探讨了一个特殊但极具启发性的情况：当观测数据的均值恰好等于先验均值时会发生什么。通过这个思想实验，你将深入理解贝叶斯更新不仅修正我们对参数的中心估计，更重要的是它如何量化并更新我们的确定性（即精度）。", "problem": "一位研究人员试图确定一个基本物理常数，记为 $\\mu$。基于现有的理论工作，该研究人员对 $\\mu$ 的先验信念被建模为一个均值为 $\\mu_0$、方差为 $\\sigma_0^2$ 的正态分布。为了改进这一估计，该研究人员进行了一项包含 $n$ 次独立测量的实验，这些测量值被假定来自一个均值为 $\\mu$、已知恒定仪器方差为 $\\sigma^2$ 的正态分布。实验完成后，研究人员计算了测量值的样本均值 $\\bar{x}$。一次非常巧合的情况下，计算出的样本均值与先验均值相同，即 $\\bar{x} = \\mu_0$。\n\n在这个贝叶斯框架内，研究人员将其对 $\\mu$ 的信念更新为后验分布。请找出在此特定条件下，$\\mu$ 的后验均值和后验方差的简化表达式。你的答案应该是一对表达式，第一个是后验均值，第二个是后验方差，用部分或全部给定参数：$\\mu_0, \\sigma_0^2, n,$ 和 $\\sigma^2$ 来表示。", "solution": "我们将先验和似然建模如下。参数的先验是高斯分布：$\\mu \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$。数据由 $n$ 个独立观测值 $x_{1},\\ldots,x_{n}$ 组成，其中 $x_{i} \\mid \\mu \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，因此样本均值满足 $\\bar{x} \\mid \\mu \\sim \\mathcal{N}\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right)$。\n\n由于正态先验与已知方差的正态似然共轭，$\\mu$ 的后验分布也是正态分布。写出后验密度（忽略比例常数）并合并关于 $\\mu$ 的项，\n$$\np(\\mu \\mid \\bar{x}) \\propto \\exp\\!\\left(-\\frac{1}{2\\sigma_{0}^{2}}(\\mu-\\mu_{0})^{2}\\right)\\exp\\!\\left(-\\frac{n}{2\\sigma^{2}}(\\bar{x}-\\mu)^{2}\\right).\n$$\n展开并对 $\\mu$ 进行配方，二次项系数（后验精度）为\n$$\na \\equiv \\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}},\n$$\n线性项系数为\n$$\nb \\equiv \\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\,\\bar{x}}{\\sigma^{2}}.\n$$\n因此，后验分布为 $\\mathcal{N}(m_{n},v_{n})$，其中\n$$\nv_{n}=\\frac{1}{a}=\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\right)^{-1}=\\frac{\\sigma_{0}^{2}\\sigma^{2}}{\\sigma^{2}+n\\sigma_{0}^{2}},\n\\qquad\nm_{n}=\\frac{b}{a}=v_{n}\\left(\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\,\\bar{x}}{\\sigma^{2}}\\right).\n$$\n在 $\\bar{x}=\\mu_{0}$ 的特定条件下，后验均值简化为\n$$\nm_{n}=v_{n}\\left(\\frac{\\mu_{0}}{\\sigma_{0}^{2}}+\\frac{n\\,\\mu_{0}}{\\sigma^{2}}\\right)=\\mu_{0}\\,v_{n}\\left(\\frac{1}{\\sigma_{0}^{2}}+\\frac{n}{\\sigma^{2}}\\right)=\\mu_{0},\n$$\n后验方差保持为\n$$\nv_{n}=\\frac{\\sigma_{0}^{2}\\sigma^{2}}{\\sigma^{2}+n\\sigma_{0}^{2}}.\n$$\n因此，后验均值等于共同值 $\\mu_{0}$，而后验方差是先验精度与数据精度的调和平均组合。", "answer": "$$\\boxed{\\begin{pmatrix}\\mu_{0} & \\dfrac{\\sigma_{0}^{2}\\sigma^{2}}{\\sigma^{2}+n\\sigma_{0}^{2}}\\end{pmatrix}}$$", "id": "1909023"}]}