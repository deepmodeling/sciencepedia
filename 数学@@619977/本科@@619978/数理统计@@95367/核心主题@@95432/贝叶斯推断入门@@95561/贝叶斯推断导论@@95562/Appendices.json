{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于利用观测数据更新我们对未知参数的信念。本练习将通过一个经典场景——估计一个过程的成功概率——来实践这一基本机制。我们将学习如何将关于成功概率 $p$ 的先验信念（用贝塔分布表示）与几何分布的观测数据相结合，从而推导出更新后的后验分布。[@problem_id:1923967]", "problem": "一位量子工程师正在测试一个用于初始化量子比特 (qubit) 的新协议。在任何一次尝试中，成功初始化的概率是一个未知的常数 $p$，其中 $0 < p < 1$。每次初始化尝试都是一次独立试验。\n\n该工程师对概率 $p$ 的先验信念由一个具有已知超参数 $\\alpha_0 > 0$ 和 $\\beta_0 > 0$ 的贝塔分布 (Beta distribution) 描述。对于变量 $x \\in [0, 1]$，一个 $\\text{Beta}(\\alpha, \\beta)$ 分布的概率密度函数正比于 $x^{\\alpha-1}(1-x)^{\\beta-1}$。\n\n在一个实验中，该工程师重复进行初始化尝试，直到首次成功实现初始化。观测到首次成功发生在第 $k$ 次尝试。\n\n根据这一观测结果，工程师更新了他们对 $p$ 的信念。$p$ 的后验分布也是一个贝塔分布。以下哪项代表了这个后验分布的新参数 $(\\alpha_{\\text{post}}, \\beta_{\\text{post}})$？\n\nA. $(\\alpha_0 + k, \\beta_0 + 1)$\n\nB. $(\\alpha_0 + k - 1, \\beta_0 + 1)$\n\nC. $(\\alpha_0 + 1, \\beta_0 + k)$\n\nD. $(\\alpha_0 + 1, \\beta_0 + k - 1)$\n\nE. $(\\alpha_0, \\beta_0 + k - 1)$", "solution": "令 $p \\in (0,1)$ 表示每次尝试的成功概率。$p$ 的先验分布是 $\\text{Beta}(\\alpha_{0},\\beta_{0})$，其密度（不考虑归一化常数）为\n$$\nf(p)\\propto p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}.\n$$\n观测结果是首次成功发生在第 $k$ 次尝试。在成功概率为 $p$ 的独立伯努利试验中，该事件的似然由几何模型给出：\n$$\n\\mathcal{L}(p;k)=P(K=k\\mid p)=(1-p)^{k-1}p,\n$$\n因为它包含了 $k-1$ 次失败和随之而来的一次成功。\n\n根据贝叶斯法则 (Bayes’ rule)，后验密度为\n$$\nf(p\\mid k)=\\frac{\\mathcal{L}(p;k)f(p)}{\\int_{0}^{1}\\mathcal{L}(p;k)f(p)\\,dp}\\propto \\mathcal{L}(p;k)f(p).\n$$\n代入先验核与似然函数，\n$$\nf(p\\mid k)\\propto \\left[p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}\\right]\\left[(1-p)^{k-1}p\\right]\n= p^{\\alpha_{0}-1+1}(1-p)^{\\beta_{0}-1+k-1}\n= p^{\\alpha_{0}}(1-p)^{\\beta_{0}+k-2}.\n$$\n识别出贝塔分布的核 $p^{\\alpha_{\\text{post}}-1}(1-p)^{\\beta_{\\text{post}}-1}$，我们可以确定\n$$\n\\alpha_{\\text{post}}-1=\\alpha_{0}\\quad\\Rightarrow\\quad \\alpha_{\\text{post}}=\\alpha_{0}+1,\\qquad\n\\beta_{\\text{post}}-1=\\beta_{0}+k-2\\quad\\Rightarrow\\quad \\beta_{\\text{post}}=\\beta_{0}+k-1.\n$$\n等价地，观测结果“首次成功在第 $k$ 次”编码了 1 次成功和 $k-1$ 次失败，从而得出标准的贝塔更新 $\\alpha_{0}\\mapsto \\alpha_{0}+1$ 和 $\\beta_{0}\\mapsto \\beta_{0}+k-1$。因此，正确选项是 $(\\alpha_{0}+1,\\beta_{0}+k-1)$。", "answer": "$$\\boxed{D}$$", "id": "1923967"}, {"introduction": "点估计虽然有用，但无法完全捕捉我们对参数的不确定性。本练习探讨了如何使用后验中位数作为未知参数的稳健点估计。这个思想实验特别有趣，因为它处理了一个只包含失败观测的极端情况，在这种情况下，贝叶斯方法展示了其独特的洞察力。[@problem_id:1923968]", "problem": "一种新的高风险外科手术正在被开发，用于治疗一种以前被认为是无法治愈的疾病。该手术的真实成功概率（记为 $p$）是未知的。在进行任何临床试验之前，医学研究人员对这个概率没有任何预设的偏见，因此认为 $p$ 在区间 $[0, 1]$ 中的每个可能值都是等可能的。\n\n然后，该手术在 $n$ 个不同的患者身上进行了尝试。在这 $n$ 次独立的试验中，每一次手术都未能成功。\n\n基于这 $n$ 次试验中零次成功的观测数据，研究人员对成功概率 $p$ 形成了更新的信念。一位医学统计学家决定通过计算一个中心值 $p_{med}$ 来总结这个更新的信念。该值的定义是：在给定观测数据的情况下，真实成功率 $p$ 小于或等于 $p_{med}$ 的概率与大于 $p_{med}$ 的概率相等。\n\n求出 $p_{med}$ 关于 $n$ 的闭式解析表达式。", "solution": "设 $p$ 表示成功概率。先验信念是在 $[0,1]$ 上的均匀分布，即 $\\operatorname{Beta}(1,1)$ 先验，其密度为 $\\pi(p)=1$（对于 $p\\in[0,1]$）。\n\n我们观测到 $n$ 次独立的伯努利试验，其中成功次数 $k=0$。似然函数为\n$$\nL(p\\mid \\text{data}) \\propto p^{k}(1-p)^{n-k}=(1-p)^{n}.\n$$\n根据贝叶斯定理，后验概率与先验概率乘以似然函数成正比：\n$$\n\\pi(p\\mid \\text{data}) \\propto \\pi(p)L(p\\mid \\text{data}) \\propto (1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n这是一个 $\\operatorname{Beta}(1,n+1)$ 分布。为了进行显式归一化，\n$$\n\\int_{0}^{1} (1-p)^{n}\\,dp=\\frac{1}{n+1},\n$$\n因此后验密度为\n$$\nf(p\\mid \\text{data})=(n+1)(1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n后验累积分布函数为\n$$\nF(p)=\\int_{0}^{p} (n+1)(1-t)^{n}\\,dt.\n$$\n通过换元 $u=1-t$, $du=-dt$ 来计算积分：\n$$\nF(p)=(n+1)\\int_{0}^{p} (1-t)^{n}\\,dt=(n+1)\\int_{1-p}^{1} u^{n}\\,du\n= (n+1)\\left[\\frac{u^{n+1}}{n+1}\\right]_{1-p}^{1}\n=1-(1-p)^{n+1}.\n$$\n后验中位数 $p_{med}$ 满足 $F(p_{med})=\\frac{1}{2}$，因此\n$$\n1-(1-p_{med})^{n+1}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n(1-p_{med})^{n+1}=\\frac{1}{2}.\n$$\n两边取 $(n+1)$ 次方根，得到\n$$\n1-p_{med}=2^{-\\frac{1}{n+1}},\n$$\n所以\n$$\np_{med}=1-2^{-\\frac{1}{n+1}}.\n$$\n该表达式对所有 $n\\geq 0$ 均有效，特别地，对于问题背景中的 $n\\geq 1$ 也有效。", "answer": "$$\\boxed{1-2^{-\\frac{1}{n+1}}}$$", "id": "1923968"}, {"introduction": "点估计虽然有用，但无法完全捕捉我们对参数的不确定性。本练习将带领我们超越单点估计，学习构建可信区间，这是贝叶斯方法中表示参数合理取值范围的关键工具。我们将为一个工程应用中的方差参数 $\\sigma^2$ 计算一个95%的可信区间，这是一个在质量控制和系统可靠性分析中非常常见的任务。[@problem_id:1924015]", "problem": "一种新型微机电系统(MEMS)陀螺仪正在进行测试，以用于卫星姿态控制。该陀螺仪的随机漂移误差被建模为一个均值恰好为零的正态分布随机变量，因为任何系统性偏差都已在校准过程中被移除。该误差的方差（记为 $\\sigma^2$）是未知的。\n\n基于传感器噪声源的物理原理，一位领域专家建议，方差 $\\sigma^2$ 的一个合理先验信念可以用一个逆伽马分布来描述，其形状参数为 $\\alpha_0 = 3$，尺度参数为 $\\beta_0 = 0.02$。逆伽马分布 $\\text{Inv-Gamma}(\\alpha, \\beta)$ 的概率密度函数(PDF)由 $f(x | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{-\\alpha-1} \\exp(-\\frac{\\beta}{x})$ 给出，其中 $x > 0$。\n\n在测试期间，记录了以下五个独立的漂移误差测量值（单位为度/小时）：\n$x_1 = -0.25$，$x_2 = 0.15$，$x_3 = 0.30$，$x_4 = -0.10$，$x_5 = 0.05$。\n\n你的任务是确定漂移误差标准差 $\\sigma$ 的一个 95% 等尾可信区间。\n\n为了计算，你可能需要卡方($\\chi^2$)分布的以下分位数。对于自由度为 11 的 $\\chi^2$ 分布，其 0.025 分位数约为 3.816，0.975 分位数约为 21.920。\n\n计算 $\\sigma$ 的可信区间的下界和上界。将两个界限的最终答案四舍五入到三位有效数字，并以度/小时为单位表示。", "solution": "令 $x_{1},\\dots,x_{n}$ 为独立同分布样本，其中 $x_{i}\\mid\\sigma^{2}\\sim\\mathcal{N}(0,\\sigma^{2})$，先验分布为 $\\sigma^{2}\\sim\\text{Inv-Gamma}(\\alpha_{0},\\beta_{0})$，其密度函数为 $f(x\\mid\\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x^{-\\alpha-1}\\exp\\!\\left(-\\frac{\\beta}{x}\\right)$，其中 $x>0$。根据共轭性，后验分布为\n$$\n\\sigma^{2}\\mid x_{1:n}\\sim\\text{Inv-Gamma}\\!\\left(\\alpha_{n},\\beta_{n}\\right),\n$$\n其中\n$$\n\\alpha_{n}=\\alpha_{0}+\\frac{n}{2},\\qquad \\beta_{n}=\\beta_{0}+\\frac{1}{2}\\sum_{i=1}^{n}x_{i}^{2}.\n$$\n使用 $n=5$、$\\alpha_{0}=3$、$\\beta_{0}=0.02$ 以及数据 $x_{1}=-0.25$、$x_{2}=0.15$、$x_{3}=0.30$、$x_{4}=-0.10$、$x_{5}=0.05$，计算\n$$\n\\sum_{i=1}^{5}x_{i}^{2}=(-0.25)^{2}+(0.15)^{2}+(0.30)^{2}+(-0.10)^{2}+(0.05)^{2}=0.1875,\n$$\n因此\n$$\n\\alpha_{n}=3+\\frac{5}{2}=\\frac{11}{2},\\qquad \\beta_{n}=0.02+\\frac{1}{2}\\cdot 0.1875=0.11375.\n$$\n如果 $\\sigma^{2}\\sim\\text{Inv-Gamma}(\\alpha,\\beta)$，则变换\n$$\nU=\\frac{2\\beta}{\\sigma^{2}}\n$$\n满足 $U\\sim\\chi^{2}_{2\\alpha}$。因此，对于后验分布，\n$$\n\\frac{2\\beta_{n}}{\\sigma^{2}}\\sim\\chi^{2}_{2\\alpha_{n}}=\\chi^{2}_{11}.\n$$\n令 $q_{p}$ 表示 $\\chi^{2}_{11}$ 的 $p$-分位数。$\\sigma^{2}$ 的一个 95% 等尾可信区间可通过对尾部进行反转得到：\n$$\n\\left[\\frac{2\\beta_{n}}{q_{0.975}},\\,\\frac{2\\beta_{n}}{q_{0.025}}\\right].\n$$\n使用 $q_{0.025}\\approx 3.816$ 和 $q_{0.975}\\approx 21.920$ 以及 $2\\beta_{n}=0.2275$ 可得\n$$\n\\text{lower bound for }\\sigma^{2}=\\frac{0.2275}{21.920}\\approx 0.01037865,\\qquad\n\\text{upper bound for }\\sigma^{2}=\\frac{0.2275}{3.816}\\approx 0.05961740.\n$$\n由于 $\\sigma=\\sqrt{\\sigma^{2}}$ 是一个单调变换，$\\sigma$ 的等尾可信区间是上述界限的平方根：\n$$\n\\text{lower bound for }\\sigma=\\sqrt{0.01037865}\\approx 0.1019,\\qquad\n\\text{upper bound for }\\sigma=\\sqrt{0.05961740}\\approx 0.2442.\n$$\n将两者四舍五入到三位有效数字，得到 $0.102$ 和 $0.244$，单位为度/小时。", "answer": "$$\\boxed{\\begin{pmatrix}0.102 & 0.244\\end{pmatrix}}$$", "id": "1924015"}]}