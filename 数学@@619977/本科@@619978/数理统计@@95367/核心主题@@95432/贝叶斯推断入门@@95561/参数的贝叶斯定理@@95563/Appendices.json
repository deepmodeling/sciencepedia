{"hands_on_practices": [{"introduction": "这个首个练习是贝叶斯更新的一个基本范例。我们将探索如何将关于成功概率的先验信念（用贝塔分布建模）与新数据（来自几何分布）相结合，从而得出一个更新、更全面的后验信念。这个使用共轭先验的过程是贝叶斯分析的基石，它简化了后验分布的计算。[@problem_id:1898877]", "id": "1898877", "problem": "一家教育科技公司的数据科学家正在分析玩家在一款新益智游戏中的表现。玩家首次成功解谜所需的尝试次数 $K$ 服从几何分布，其概率质量函数为 $P(K=k|p) = p(1-p)^{k-1}$，其中 $k=1, 2, 3, \\dots$。这里，$p$ 是在任何单次尝试中解开谜题的未知概率，对于给定玩家，该概率假定为常数。\n\n该科学家使用贝叶斯方法来更新她对参数 $p$ 的信念。她对 $p$ 的先验信念由参数为 $\\alpha_0 = 4$ 和 $\\beta_0 = 6$ 的贝塔分布描述。\n\n一名来自目标受众的玩家被招募进行测试，并观察到他/她首次成功解谜花费了 $k_{obs} = 8$ 次尝试。根据这一观测结果，计算科学家对概率 $p$ 的更新估计值。具体来说，计算 $p$ 的后验均值。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们用几何似然函数来为首次成功前的尝试次数建模\n$$\nP(K=k \\mid p)=p(1-p)^{k-1}, \\quad k=1,2,3,\\dots .\n$$\n$p$ 的先验分布是 $\\operatorname{Beta}(\\alpha_{0},\\beta_{0})$，其密度函数正比于\n$$\n\\pi(p)\\propto p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}.\n$$\n给定单个观测值 $k_{\\text{obs}}$，根据贝叶斯法则，后验分布正比于似然函数与先验分布的乘积：\n$$\n\\pi(p \\mid k_{\\text{obs}})\\propto \\left[p(1-p)^{k_{\\text{obs}}-1}\\right]\\cdot p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}\n= p^{\\alpha_{0}}(1-p)^{\\beta_{0}+k_{\\text{obs}}-2}.\n$$\n识别出贝塔分布的核，后验分布为\n$$\np \\mid k_{\\text{obs}} \\sim \\operatorname{Beta}\\big(\\alpha_{0}+1,\\ \\beta_{0}+k_{\\text{obs}}-1\\big).\n$$\n对于 $\\operatorname{Beta}(\\alpha,\\beta)$ 分布，后验均值为\n$$\n\\mathbb{E}[p \\mid k_{\\text{obs}}]=\\frac{\\alpha}{\\alpha+\\beta}.\n$$\n代入 $\\alpha_{0}=4$, $\\beta_{0}=6$ 和 $k_{\\text{obs}}=8$，我们得到\n$$\n\\alpha=\\alpha_{0}+1=5,\\qquad \\beta=\\beta_{0}+k_{\\text{obs}}-1=13,\n$$\n所以\n$$\n\\mathbb{E}[p \\mid k_{\\text{obs}}]=\\frac{5}{5+13}=\\frac{5}{18}.\n$$\n数值上，$\\frac{5}{18}=0.277777\\ldots$，四舍五入到四位有效数字是 $0.2778$。", "answer": "$$\\boxed{0.2778}$$"}, {"introduction": "在获得后验分布之后，我们常常希望为参数找到一个单一的点估计值。本练习介绍最大后验（MAP）估计，它旨在找到在给定数据和先验的情况下最可能的参数值。我们将使用均匀分布来模拟材料强度，并观察到数据如何约束我们参数的可能取值范围——这是现实世界估计问题中的一个关键细节。[@problem_id:1898906]", "id": "1898906", "problem": "一位材料科学家正在开发一种用于3D打印的新型丝材。该丝材的断裂强度（以兆帕 (MPa) 为单位）在理论上服从0和一个最大强度 $\\theta$ 之间的均匀分布。这个最大强度 $\\theta$ 是一个未知参数，它取决于具体的生产批次。\n\n根据材料成分理论，该科学家对 $\\theta$ 的先验信念由一个形状参数为 $\\alpha = 4$、尺度参数为 $\\beta = 120$ 的逆伽玛分布所描述。$\\theta$ 的先验概率密度函数为 $p(\\theta) \\propto \\theta^{-(\\alpha+1)} \\exp(-\\frac{\\beta}{\\theta})$，其中 $\\theta > 0$。\n\n为了估计一个新批次的 $\\theta$ 值，随机抽取了 $n=6$ 根丝材进行测试，直至其断裂。记录的断裂强度如下：\n$S = \\{32.5, 41.2, 28.9, 35.1, 45.8, 38.0\\}$ MPa。\n\n假设观测到的强度是来自 Uniform$(0, \\theta)$ 分布的独立同分布样本，请求出参数 $\\theta$ 的最大后验 (MAP) 估计值。\n\n请用MPa作答，并将估计的最大强度值四舍五入至四位有效数字。", "solution": "问题要求解参数 $\\theta$ 的最大后验 (MAP) 估计。MAP 估计是使后验分布 $p(\\theta|\\mathbf{s})$ 最大化的 $\\theta$ 值，后验分布由贝叶斯定理确定：$p(\\theta|\\mathbf{s}) \\propto L(\\mathbf{s}|\\theta) p(\\theta)$，其中 $L(\\mathbf{s}|\\theta)$ 是似然函数，$p(\\theta)$ 是先验分布。\n\n**第一步：定义似然函数**\n观测值 $s_1, \\ldots, s_n$ 是来自 Uniform$(0, \\theta)$ 分布的独立同分布 (i.i.d.) 样本。单个观测值 $s_i$ 的概率密度函数 (PDF) 为 $f(s_i|\\theta) = \\frac{1}{\\theta}$ (当 $0 \\le s_i \\le \\theta$ 时)，否则为 0。\n\n似然函数 $L(\\mathbf{s}|\\theta)$ 是在给定参数 $\\theta$ 的条件下观测到数据 $\\mathbf{s} = \\{s_1, \\ldots, s_n\\}$ 的联合概率：\n$$L(\\mathbf{s}|\\theta) = \\prod_{i=1}^{n} f(s_i|\\theta) = \\prod_{i=1}^{n} \\left(\\frac{1}{\\theta}\\right) I(0 \\le s_i \\le \\theta)$$\n其中 $I(\\cdot)$ 是指示函数。条件 $0 \\le s_i \\le \\theta$ 必须对所有的 $i$ 都成立。这等价于要求 $\\theta$ 必须大于或等于样本中的最大值。令 $s_{\\max} = \\max(s_1, \\ldots, s_n)$。因此，似然函数可以写为：\n$$L(\\mathbf{s}|\\theta) = \\left(\\frac{1}{\\theta}\\right)^n I(\\theta \\ge s_{\\max}) = \\theta^{-n} I(\\theta \\ge s_{\\max})$$\n\n**第二步：定义先验分布**\n$\\theta$ 的先验分布是逆伽玛分布 IG$(\\alpha, \\beta)$，其概率密度函数正比于：\n$$p(\\theta) \\propto \\theta^{-(\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right) \\quad \\text{for } \\theta > 0$$\n给定的超参数为 $\\alpha = 4$ 和 $\\beta = 120$。\n\n**第三步：确定后验分布**\n后验分布正比于似然函数与先验分布的乘积：\n$$p(\\theta|\\mathbf{s}) \\propto L(\\mathbf{s}|\\theta) p(\\theta)$$\n$$p(\\theta|\\mathbf{s}) \\propto \\left( \\theta^{-n} I(\\theta \\ge s_{\\max}) \\right) \\left( \\theta^{-(\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right) \\right)$$\n合并各项并将指示函数纳入 $\\theta$ 的定义域：\n$$p(\\theta|\\mathbf{s}) \\propto \\theta^{-n - (\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right) = \\theta^{-(n+\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right), \\quad \\text{for } \\theta \\ge s_{\\max}$$\n\n**第四步：求解 MAP 估计**\nMAP 估计是使后验分布最大化的 $\\theta$ 值。通常，最大化后验分布的自然对数会更容易，因为对数是单调函数。\n令 $g(\\theta) = \\ln(p(\\theta|\\mathbf{s}))$。对于 $\\theta \\ge s_{\\max}$：\n$$g(\\theta) = \\text{const} - (n+\\alpha+1)\\ln(\\theta) - \\frac{\\beta}{\\theta}$$\n为了找到最大值，我们对 $g(\\theta)$ 关于 $\\theta$ 求导，并令其等于零。\n$$\\frac{dg}{d\\theta} = -\\frac{n+\\alpha+1}{\\theta} + \\frac{\\beta}{\\theta^2}$$\n令导数为零，得到临界点，我们将其记为 $\\theta^*$：\n$$-\\frac{n+\\alpha+1}{\\theta^*} + \\frac{\\beta}{(\\theta^*)^2} = 0 \\implies \\frac{\\beta}{(\\theta^*)^2} = \\frac{n+\\alpha+1}{\\theta^*} \\implies \\theta^* = \\frac{\\beta}{n+\\alpha+1}$$\n这个值 $\\theta^*$ 是无约束后验分布的众数。二阶导数 $\\frac{d^2g}{d\\theta^2} = \\frac{n+\\alpha+1}{\\theta^2} - \\frac{2\\beta}{\\theta^3}$ 在 $\\theta=\\theta^*$ 处为负，确认了这是一个最大值点。\n\n然而，后验分布仅在 $\\theta \\ge s_{\\max}$ 上有定义。我们必须在这个受限的定义域上找到后验函数的最大值。\n函数 $g(\\theta)$ 在 $\\theta < \\theta^*$ 时是递增的，在 $\\theta > \\theta^*$ 时是递减的。这导致两种情况：\n1. 如果 $\\theta^* \\ge s_{\\max}$：无约束最大值位于有效定义域内。因此，MAP 估计为 $\\theta_{\\text{MAP}} = \\theta^*$。\n2. 如果 $\\theta^* < s_{\\max}$：无约束最大值位于有效定义域之外。在定义域 $[\\,s_{\\max}, \\infty)$ 上，该函数是严格递减的。因此，最大值出现在边界处，即 $\\theta_{\\text{MAP}} = s_{\\max}$。\n\n综合这两种情况，MAP 估计由 $\\theta_{\\text{MAP}} = \\max(s_{\\max}, \\theta^*)$ 给出。\n\n**第五步：计算数值**\n问题提供了以下数值：\n- $n = 6$\n- $\\alpha = 4$\n- $\\beta = 120$\n- 数据 $\\mathbf{s} = \\{32.5, 41.2, 28.9, 35.1, 45.8, 38.0\\}$ MPa\n\n首先，我们找到数据样本中的最大值：\n$$s_{\\max} = \\max\\{32.5, 41.2, 28.9, 35.1, 45.8, 38.0\\} = 45.8 \\text{ MPa}$$\n\n接下来，我们计算无约束众数 $\\theta^*$：\n$$\\theta^* = \\frac{\\beta}{n+\\alpha+1} = \\frac{120}{6+4+1} = \\frac{120}{11} \\approx 10.909 \\text{ MPa}$$\n\n现在，我们通过比较 $s_{\\max}$ 和 $\\theta^*$ 来找到 MAP 估计：\n$$\\theta_{\\text{MAP}} = \\max(s_{\\max}, \\theta^*) = \\max(45.8, 10.909) = 45.8 \\text{ MPa}$$\n\n问题要求答案保留四位有效数字。\n$$\\theta_{\\text{MAP}} = 45.80$$", "answer": "$$\\boxed{45.80}$$"}, {"introduction": "在贝叶斯分析中一个常见的问题是：“先验从何而来？” 这个实践问题直接回答了这一点，演示了如何将专家的主观信念转化为一个形式化的先验分布。通过利用专家对未知比例陈述的中位数和置信区间，我们将确定一个合适的贝塔先验分布的参数，从而在定性知识和定量建模之间架起一座桥梁。[@problem_id:1898866]", "id": "1898866", "problem": "一个天体物理学家团队正在尝试估计某一类可能拥有大气生物特征的系外行星所占的比例 $\\theta$。为了给这个未知比例建立一个先验分布，他们咨询了一位行星科学领域的资深专家。该专家表示，他们的主观看法是 $\\theta$ 的中位数为 0.5，并且真实比例 $\\theta$ 有 50% 的概率落在 0.42 和 0.58 之间。\n\n该团队决定使用贝塔分布 Beta($\\alpha, \\beta$)来为这一先验信念建模。该分布的概率密度函数在 $x \\in [0, 1]$ 上正比于 $x^{\\alpha-1}(1-x)^{\\beta-1}$，其参数 $\\alpha, \\beta > 0$。对于此任务，你可以假设，对于没有严重偏斜且参数足够大的贝塔分布，其中心分位数可以用正态分布来近似。具体来说，第 25 和第 75 百分位数可以分别近似为 $\\mu - z^* \\sigma$ 和 $\\mu + z^* \\sigma$，其中 $\\mu$ 是均值，$\\sigma$ 是标准差，常数 $z^*$ 约等于 $0.6745$。\n\n假设专家的主观看法能被此模型和近似方法充分描述，请确定贝塔分布的参数 $\\alpha$ 和 $\\beta$。按顺序报告 $\\alpha$ 和 $\\beta$ 的值，并四舍五入到三位有效数字。", "solution": "我们将先验分布建模为 $\\theta \\sim \\text{Beta}(\\alpha,\\beta)$。对于贝塔分布，其均值和方差为\n$$\\mu=\\frac{\\alpha}{\\alpha+\\beta}, \\qquad \\sigma^{2}=\\frac{\\alpha\\beta}{(\\alpha+\\beta)^{2}(\\alpha+\\beta+1)}.$$\n\n专家指出中位数为 $0.5$，并且分布的中心 $50$ 百分比位于 $0.42$ 和 $0.58$ 之间。在给定的中心分位数正态近似下，第一和第三四分位数满足\n$$Q_{1}\\approx \\mu - z^{*}\\sigma, \\qquad Q_{3}\\approx \\mu + z^{*}\\sigma,$$\n其中 $z^{*}\\approx 0.6745$。 区间 $[0.42,\\,0.58]$ 代表了四分位距，所以\n$$Q_{1}=0.42, \\qquad Q_{3}=0.58.$$\n\n将这两个值相加再除以 $2$ 得到均值：\n$$\\mu \\approx \\frac{Q_{1}+Q_{3}}{2}=\\frac{0.42+0.58}{2}=0.5.$$\n因此\n$$\\frac{\\alpha}{\\alpha+\\beta}=0.5 \\quad \\Longrightarrow \\quad \\alpha=\\beta.$$\n令 $\\alpha=\\beta=a$。那么方差简化为\n$$\\sigma^{2}=\\frac{a^{2}}{(2a)^{2}(2a+1)}=\\frac{1}{4(2a+1)}, \\qquad \\sigma=\\frac{1}{2\\sqrt{2a+1}}.$$\n\n根据 $Q_{3}-\\mu\\approx z^{*}\\sigma$，我们有\n$$0.58-0.50 = z^{*}\\sigma \\quad \\Longrightarrow \\quad \\sigma=\\frac{0.08}{z^{*}}.$$\n将其与用 $a$ 表示的 $\\sigma$ 的表达式相等，\n$$\\frac{1}{2\\sqrt{2a+1}}=\\frac{0.08}{z^{*}} \\quad \\Longrightarrow \\quad \\sqrt{2a+1}=\\frac{z^{*}}{0.16} \\quad \\Longrightarrow \\quad 2a+1=\\left(\\frac{z^{*}}{0.16}\\right)^{2}.$$\n因此\n$$a=\\frac{1}{2}\\left[\\left(\\frac{z^{*}}{0.16}\\right)^{2}-1\\right].$$\n\n当 $z^{*}=0.6745$ 时，\n$$\\frac{z^{*}}{0.16}=\\frac{0.6745}{0.16}=4.215625,\\quad \\left(\\frac{z^{*}}{0.16}\\right)^{2}=17.771494140625,$$\n所以\n$$a=\\frac{17.771494140625-1}{2}=8.3857470703125.$$\n\n因此，$\\alpha=\\beta\\approx 8.3857470703125$，四舍五入到三位有效数字后得到\n$$\\alpha\\approx 8.39,\\qquad \\beta\\approx 8.39.$$", "answer": "$$\\boxed{\\begin{pmatrix}8.39 & 8.39\\end{pmatrix}}$$"}]}