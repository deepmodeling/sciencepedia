{"hands_on_practices": [{"introduction": "我们从一个经典的谜题开始，它将贝叶斯推断的核心逻辑剥离出来。在这个场景中，我们不确定正在使用的是两枚硬币中的哪一枚，这是一个涉及离散可能性的情况。本练习将指导你如何利用观测数据来更新你对持有硬币的信念，并利用这些更新后的信念来预测未来的结果 [@problem_id:1946640]。这个例子完美地展示了证据如何系统地在相互竞争的假设之间转移我们的置信度。", "problem": "一位魔术师口袋里有两枚外观相同的硬币。一枚是公平的硬币，其掷出正面或反面的概率相等。另一枚是有偏差的硬币，其掷出正面的概率为 0.25。魔术师从口袋里随机选择一枚硬币，每枚硬币被选中的机会均等。然后他将这枚选中的硬币抛掷三次，观察到的结果序列是正面、反面、反面。他将要第四次抛掷同一枚硬币。计算第四次抛掷结果为反面的概率。将你的答案以四位有效数字的小数形式给出。", "solution": "设 $F$ 为选中公平硬币的事件， $B$ 为选中带偏硬币的事件。先验概率为 $P(F) = \\frac{1}{2}$ 和 $P(B) = \\frac{1}{2}$。设观察到的数据为 $D =$ HTT。根据在给定硬币类型条件下抛掷的独立性：\n$$\nP(D \\mid F) = \\left(\\frac{1}{2}\\right)^{3} = \\frac{1}{8}, \\quad\nP(D \\mid B) = \\frac{1}{4} \\cdot \\left(\\frac{3}{4}\\right)^{2} = \\frac{9}{64}.\n$$\n根据贝叶斯定理，\n$$\nP(F \\mid D) = \\frac{P(D \\mid F)P(F)}{P(D \\mid F)P(F) + P(D \\mid B)P(B)} = \\frac{\\frac{1}{8}\\cdot \\frac{1}{2}}{\\frac{1}{8}\\cdot \\frac{1}{2} + \\frac{9}{64}\\cdot \\frac{1}{2}} = \\frac{\\frac{1}{16}}{\\frac{1}{16} + \\frac{9}{128}} = \\frac{\\frac{1}{16}}{\\frac{17}{128}} = \\frac{8}{17}.\n$$\n因此\n$$\nP(B \\mid D) = 1 - P(F \\mid D) = \\frac{9}{17}.\n$$\n根据全概率定律，第四次抛掷为反面的预测概率为\n$$\nP(T \\mid D) = P(T \\mid F)P(F \\mid D) + P(T \\mid B)P(B \\mid D) = \\frac{1}{2}\\cdot \\frac{8}{17} + \\frac{3}{4}\\cdot \\frac{9}{17} = \\frac{4}{17} + \\frac{27}{68} = \\frac{16}{68} + \\frac{27}{68} = \\frac{43}{68}.\n$$\n转换为小数并四舍五入到四位有效数字，得到 $0.6324$。", "answer": "$$\\boxed{0.6324}$$", "id": "1946640"}, {"introduction": "从离散假设转向连续参数，下一个问题将处理一个常见的工程场景。我们将估计一个由指数分布建模的过程的未知速率参数 $\\lambda$。这个练习引入了共轭先验这一强大概念，它极大地简化了后验分布的计算，并要求你找出后验众数，这是一种从我们更新后的信念中推导出点估计的主要方法 [@problem_id:1946583]。", "problem": "一个工程团队正在测试一种新型实验性发光二极管（LED）的寿命。单个LED的寿命 $X$（以千小时为单位）服从一个指数分布，其速率参数 $\\lambda > 0$ 未知。在给定参数 $\\lambda$ 的条件下，寿命 $X$ 的概率密度函数（PDF）为：\n$$f(x|\\lambda) = \\lambda \\exp(-\\lambda x) \\quad \\text{for } x \\ge 0$$\n基于以往对类似技术的经验，该团队关于速率参数 $\\lambda$ 的先验信念服从一个伽马分布，其形状参数为 $\\alpha = 2$，速率参数为 $\\beta = 3$。该先验分布的概率密度函数正比于：\n$$p(\\lambda) \\propto \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\quad \\text{for } \\lambda > 0$$\n选取一个LED进行测试，观测到其寿命为 $x = 5$ 千小时。求在此观测条件下 $\\lambda$ 的后验分布的众数。请以精确值的形式表示答案。", "solution": "问题要求解参数 $\\lambda$ 的后验分布的众数。我们可以使用连续参数的贝叶斯定理来找到后验分布。该定理指出，后验概率密度正比于似然函数与先验概率密度的乘积。\n\n后验概率密度函数由下式给出：\n$$p(\\lambda | x) \\propto f(x | \\lambda) p(\\lambda)$$\n\n我们已知似然函数，即对于单个观测值 $x=5$ 的指数分布的概率密度函数：\n$$f(x=5 | \\lambda) = \\lambda \\exp(-5\\lambda)$$\n\n我们也已知 $\\lambda$ 的先验分布是一个伽马分布，其形状参数为 $\\alpha=2$，速率参数为 $\\beta=3$。其先验概率密度函数正比于：\n$$p(\\lambda) \\propto \\lambda^{\\alpha-1} \\exp(-\\beta\\lambda) = \\lambda^{2-1} \\exp(-3\\lambda) = \\lambda^{1} \\exp(-3\\lambda)$$\n\n现在，我们将似然函数与先验概率密度相乘，得到未归一化的后验分布：\n$$p(\\lambda | x=5) \\propto \\left( \\lambda \\exp(-5\\lambda) \\right) \\cdot \\left( \\lambda^{1} \\exp(-3\\lambda) \\right)$$\n合并含 $\\lambda$ 的项：\n$$p(\\lambda | x=5) \\propto \\lambda^{1+1} \\exp(-5\\lambda - 3\\lambda)$$\n$$p(\\lambda | x=5) \\propto \\lambda^{2} \\exp(-8\\lambda)$$\n\n该表达式是伽马分布的核。一个形状参数为 $\\alpha_{\\text{post}}$、速率参数为 $\\beta_{\\text{post}}$ 的伽马分布，其概率密度函数正比于 $\\lambda^{\\alpha_{\\text{post}}-1} \\exp(-\\beta_{\\text{post}}\\lambda)$。将此形式与我们的结果进行比较，可以确定后验分布的参数：\n$$\\alpha_{\\text{post}} - 1 = 2 \\implies \\alpha_{\\text{post}} = 3$$\n$$\\beta_{\\text{post}} = 8$$\n因此，$\\lambda$ 的后验分布是一个伽马分布，即 $\\lambda | (x=5) \\sim \\text{Gamma}(3, 8)$。\n\n一个分布的众数是使其概率密度函数达到最大值的变量值。为求后验分布的众数，我们需要找到使 $p(\\lambda|x=5)$ 最大化的 $\\lambda$ 值。通常，对概率密度函数的自然对数求最大值会更容易。令 $L(\\lambda) = \\ln(p(\\lambda|x=5))$。\n$$L(\\lambda) = \\ln(C \\lambda^{2} \\exp(-8\\lambda)) = \\ln(C) + 2\\ln(\\lambda) - 8\\lambda$$\n其中 $C$ 是归一化常数。\n\n为求最大值，我们将 $L(\\lambda)$ 对 $\\lambda$ 求导，并令其等于零：\n$$\\frac{d L(\\lambda)}{d \\lambda} = \\frac{2}{\\lambda} - 8$$\n将导数设为零以求临界点：\n$$\\frac{2}{\\lambda} - 8 = 0 \\implies \\frac{2}{\\lambda} = 8 \\implies \\lambda = \\frac{2}{8} = \\frac{1}{4}$$\n\n为确认该临界点是一个最大值点，我们可以检验二阶导数：\n$$\\frac{d^2 L(\\lambda)}{d \\lambda^2} = -\\frac{2}{\\lambda^2}$$\n由于 $\\lambda$ 必须为正，二阶导数恒为负。这证实了 $\\lambda = 1/4$ 是一个局部最大值点。由于这是定义域 $\\lambda > 0$ 内唯一的临界点，因此它也是全局最大值点，即后验分布的众数。\n\n另外，当 $\\alpha > 1$ 时，Gamma($\\alpha, \\beta$) 分布的众数由公式 $\\frac{\\alpha-1}{\\beta}$ 给出。我们的后验分布是 Gamma(3, 8)。因为 $\\alpha_{\\text{post}} = 3 > 1$，我们可以使用此公式：\n$$\\text{Mode} = \\frac{\\alpha_{\\text{post}} - 1}{\\beta_{\\text{post}}} = \\frac{3-1}{8} = \\frac{2}{8} = \\frac{1}{4}$$\n两种方法均得出相同结果。$\\lambda$ 的后验分布的众数是 $1/4$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1946583"}, {"introduction": "我们的最后一个练习将深入探讨贝叶斯统计中最重要——有时也最具争议性——的方面之一：先验分布的选择。通过使用两种不同的先验（一个弱信息先验和一个无信息先验）来分析相同的数据，你将直接比较它们对最终参数估计的影响。这个练习 [@problem_id:1946616] 强调了初始假设如何影响最终结论，并鼓励你在模型构建中采取深思熟虑的方法。", "problem": "一位数字营销分析师正在对每小时点击特定广告链接的用户数量进行建模。假设点击次数 $X$ 服从泊松分布，其平均率 $\\lambda$ 未知。为了估计这个率，该分析师在 $n$ 个独立同分布 (i.i.d.) 的一小时区间内收集数据，记录了点击次数 $x_1, x_2, \\dots, x_n$。\n\n提出了两种不同的贝叶斯模型来推断 $\\lambda$ 的值。在每个模型中，$\\lambda$ 的估计值取为后验分布的众数，也称为最大后验 (MAP) 估计。\n\n- **模型 A** 使用标准的指数先验分布作为率的先验：$p_A(\\lambda) = \\exp(-\\lambda)$，其中 $\\lambda > 0$。记其后验众数为 $\\hat{\\lambda}_A$。\n- **模型 B** 使用一个常见的无信息非正常先验，即泊松率的杰弗里斯先验：$p_B(\\lambda) \\propto \\frac{1}{\\sqrt{\\lambda}}$，其中 $\\lambda > 0$。记其后验众数为 $\\hat{\\lambda}_B$。\n\n你的任务是计算这两个估计量之差 $\\hat{\\lambda}_A - \\hat{\\lambda}_B$。请将你的答案表示为关于区间数 $n$ 和样本均值 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$ 的解析表达式。", "solution": "设 $X_{1},\\dots,X_{n}$ 在给定 $\\lambda$ 的条件下独立同分布，且 $X_{i}\\mid\\lambda\\sim\\text{Poisson}(\\lambda)$。记 $S=\\sum_{i=1}^{n}x_{i}=n\\bar{x}$。似然函数为\n$$\nL(\\lambda\\mid x_{1:n})=\\prod_{i=1}^{n}\\frac{\\exp(-\\lambda)\\lambda^{x_{i}}}{x_{i}!}\\propto \\exp(-n\\lambda)\\lambda^{S}.\n$$\n其对数（不计加法常数）为\n$$\n\\ell(\\lambda)=-n\\lambda+S\\ln\\lambda.\n$$\n\n模型 A 使用 $p_{A}(\\lambda)=\\exp(-\\lambda)$，其中 $\\lambda>0$。后验分布（不计乘法常数）为\n$$\np(\\lambda\\mid x_{1:n},A)\\propto \\exp(-n\\lambda)\\lambda^{S}\\cdot \\exp(-\\lambda)=\\exp(-(n+1)\\lambda)\\lambda^{S},\n$$\n其对数后验为\n$$\n\\ell_{A}(\\lambda)=-(n+1)\\lambda+S\\ln\\lambda.\n$$\n求导并令其为零：\n$$\n\\frac{d\\ell_{A}}{d\\lambda}=-(n+1)+\\frac{S}{\\lambda}=0\\quad\\Longrightarrow\\quad \\hat{\\lambda}_{A}=\\frac{S}{n+1}.\n$$\n对于 $S>0$，二阶导数 $-\\frac{S}{\\lambda^{2}}<0$ 确认了在内部有一个众数；对于 $S=0$，众数在边界 $\\lambda=0$ 处。\n\n模型 B 使用 $p_{B}(\\lambda)\\propto \\lambda^{-1/2}$，其中 $\\lambda>0$。后验分布（不计乘法常数）为\n$$\np(\\lambda\\mid x_{1:n},B)\\propto \\exp(-n\\lambda)\\lambda^{S}\\cdot \\lambda^{-1/2}=\\exp(-n\\lambda)\\lambda^{S-\\frac{1}{2}},\n$$\n其对数后验为\n$$\n\\ell_{B}(\\lambda)=-n\\lambda+\\left(S-\\frac{1}{2}\\right)\\ln\\lambda.\n$$\n求导并令其为零：\n$$\n\\frac{d\\ell_{B}}{d\\lambda}=-n+\\frac{S-\\frac{1}{2}}{\\lambda}=0\\quad\\Longrightarrow\\quad \\hat{\\lambda}_{B}=\\frac{S-\\frac{1}{2}}{n}.\n$$\n对于 $S\\geq 1$，这是一个内部众数；对于 $S=0$，众数在边界 $\\lambda=0$ 处。\n\n对于 $S\\geq 1$（至少观察到一次点击的典型情况），差值为\n$$\n\\hat{\\lambda}_{A}-\\hat{\\lambda}_{B}=\\frac{S}{n+1}-\\frac{S-\\frac{1}{2}}{n}.\n$$\n代入 $S=n\\bar{x}$ 并化简：\n$$\n\\hat{\\lambda}_{A}-\\hat{\\lambda}_{B}=\\frac{n\\bar{x}}{n+1}-\\left(\\bar{x}-\\frac{1}{2n}\\right)\n=-\\frac{\\bar{x}}{n+1}+\\frac{1}{2n}.\n$$\n因此，用 $n$ 和 $\\bar{x}$ 表示，\n$$\n\\hat{\\lambda}_{A}-\\hat{\\lambda}_{B}=\\frac{1}{2n}-\\frac{\\bar{x}}{n+1}.\n$$\n（如果 $S=0$，两个众数都在 $0$ 处，差值为 $0$；上述表达式在 $S\\geq 1$ 时适用。）", "answer": "$$\\boxed{\\frac{1}{2n}-\\frac{\\bar{x}}{n+1}}$$", "id": "1946616"}]}