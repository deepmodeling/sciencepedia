{"hands_on_practices": [{"introduction": "理解全方差定律始于将其应用于一个清晰的多阶段过程。第一个练习模拟了一个简单的两阶段随机游戏，为练习分解总方差提供了一个具体的场景。通过计算这个游戏中的方差，你将获得计算条件方差的期望值 $\\mathbb{E}[\\operatorname{Var}(X|K)]$ 和条件期望的方差 $\\operatorname{Var}(\\mathbb{E}[X|K])$ 的实践经验。[@problem_id:1401034]", "problem": "一名玩家参与一个两阶段的概率游戏。在第一阶段，他们掷一个公平的六面骰子。设掷骰子的结果为随机变量 $K$。在第二阶段，玩家抽取一个有货币价值的奖品，其价值由随机变量 $X$ 表示。抽取奖品价值的分布取决于掷骰子的结果。具体来说，对于给定的骰子结果 $K=k$，奖品价值 $X$ 从一个均值为 $k$、方差为 $k^2$ 的分布中抽取。\n\n计算奖品价值的总方差 $\\operatorname{Var}(X)$。将您的答案表示为最简精确分数。", "solution": "设 $K$ 为掷一个公平六面骰子的结果，因此 $K \\in \\{1,2,3,4,5,6\\}$，每个结果的概率相等。给定 $K=k$时，$X$ 的条件期望和条件方差分别为 $\\mathbb{E}[X \\mid K=k]=k$ 和 $\\operatorname{Var}(X \\mid K=k)=k^{2}$。\n\n根据全方差公式，\n$$\n\\operatorname{Var}(X)=\\mathbb{E}\\!\\left[\\operatorname{Var}(X \\mid K)\\right]+\\operatorname{Var}\\!\\left(\\mathbb{E}[X \\mid K]\\right).\n$$\n使用给定的条件矩，上式变为\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[K^{2}]+\\operatorname{Var}(K).\n$$\n\n计算公平骰子结果 $K$ 的矩：\n$$\n\\mathbb{E}[K]=\\frac{1}{6}\\sum_{k=1}^{6}k=\\frac{21}{6}=\\frac{7}{2},\n$$\n$$\n\\mathbb{E}[K^{2}]=\\frac{1}{6}\\sum_{k=1}^{6}k^{2}=\\frac{91}{6}.\n$$\n因此，\n$$\n\\operatorname{Var}(K)=\\mathbb{E}[K^{2}]-(\\mathbb{E}[K])^{2}=\\frac{91}{6}-\\left(\\frac{7}{2}\\right)^{2}=\\frac{91}{6}-\\frac{49}{4}=\\frac{35}{12}.\n$$\n所以，\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[K^{2}]+\\operatorname{Var}(K)=\\frac{91}{6}+\\frac{35}{12}=\\frac{182+35}{12}=\\frac{217}{12}.\n$$\n此分数为最简形式。", "answer": "$$\\boxed{\\frac{217}{12}}$$", "id": "1401034"}, {"introduction": "全方差定律的两个组成部分揭示了随机性的不同来源。这个问题呈现了一个独特的场景，其中总方差完全来自其中一个来源。通过这个涉及随机选择三角函数的思想实验，你将探索一种条件期望为常数的情况，这导致“均值的方差”项为零，从而阐明了方差分解的一个关键方面。[@problem_id:1929471]", "problem": "考虑一个两阶段的随机过程。\n在第一阶段，选择一个函数，我们称之为 $F$。该函数有 $1/2$ 的概率为 $F(x) = \\sin(x)$，并有剩余的 $1/2$ 概率为 $F(x) = \\cos(x)$。\n在第二阶段，一个角度 $\\Theta$ 作为随机变量从区间 $[0, 2\\pi]$ 上的连续均匀分布中抽取。\n然后定义一个新的随机变量 $Y$ 为所选函数 $F$ 应用于随机角度 $\\Theta$ 的结果，即 $Y = F(\\Theta)$。\n\n计算随机变量 $Y$ 的总方差。", "solution": "令 $S$ 表示函数的随机选择，有 $\\mathbb{P}(S=\\sin)=\\mathbb{P}(S=\\cos)=\\frac{1}{2}$。令 $\\Theta$ 与 $S$ 相互独立，并在 $[0,2\\pi]$ 上均匀分布。定义当 $S=\\sin$ 时 $Y=\\sin(\\Theta)$，当 $S=\\cos$ 时 $Y=\\cos(\\Theta)$。\n\n根据全方差公式，\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}\\!\\left[\\operatorname{Var}(Y\\mid S)\\right]+\\operatorname{Var}\\!\\left(\\mathbb{E}[Y\\mid S]\\right).\n$$\n\n首先计算条件期望。对于 $S=\\sin$，\n$$\n\\mathbb{E}[Y\\mid S=\\sin]=\\mathbb{E}[\\sin(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin(x)\\,dx=0,\n$$\n以及对于 $S=\\cos$，\n$$\n\\mathbb{E}[Y\\mid S=\\cos]=\\mathbb{E}[\\cos(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\cos(x)\\,dx=0.\n$$\n因此 $\\mathbb{E}[Y\\mid S]=0$ 几乎必然成立，所以\n$$\n\\operatorname{Var}\\!\\left(\\mathbb{E}[Y\\mid S]\\right)=0.\n$$\n\n接下来计算条件方差。对于 $S=\\sin$，\n$$\n\\operatorname{Var}(Y\\mid S=\\sin)=\\mathbb{E}[\\sin^{2}(\\Theta)]-\\left(\\mathbb{E}[\\sin(\\Theta)]\\right)^{2}=\\mathbb{E}[\\sin^{2}(\\Theta)],\n$$\n并且\n$$\n\\mathbb{E}[\\sin^{2}(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin^{2}(x)\\,dx=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\frac{1-\\cos(2x)}{2}\\,dx=\\frac{1}{2\\pi}\\left[\\frac{x}{2}-\\frac{\\sin(2x)}{4}\\right]_{0}^{2\\pi}=\\frac{1}{2}.\n$$\n同理，对于 $S=\\cos$，\n$$\n\\operatorname{Var}(Y\\mid S=\\cos)=\\mathbb{E}[\\cos^{2}(\\Theta)]=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\cos^{2}(x)\\,dx=\\frac{1}{2}.\n$$\n因此，\n$$\n\\mathbb{E}\\!\\left[\\operatorname{Var}(Y\\mid S)\\right]=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}.\n$$\n\n综合起来，我们得到\n$$\n\\operatorname{Var}(Y)=\\frac{1}{2}+0=\\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1929471"}, {"introduction": "全方差定律在分析具有随机步数的过程中尤其强大，这是模拟和现实世界随机模型中的一个共同特征。这个高级问题挑战你计算一个随机数量的随机变量之和的方差。解决这个在精算科学和排队论等领域至关重要的问题，将巩固你将该定律应用于复杂嵌套随机过程的能力。[@problem_id:1401012]", "problem": "一台计算服务器被编程用于运行一个迭代模拟。该模拟以离散时间步进行。在每一步 $i$，模拟会生成一个实值数值更新 $X_i$。这些更新值 $X_1, X_2, X_3, \\dots$ 是独立同分布 (i.i.d.) 的随机变量，其均值为 $\\mathbb{E}[X_i] = \\mu$，方差为 $\\operatorname{Var}(X_i) = \\sigma^2$。均值 $\\mu$ 非零，方差 $\\sigma^2$ 有限且为正。\n\n该模拟包含一个概率性停止法则。每一步之后，都会进行一次独立检查來决定是否终止。在任何给定步骤后终止的概率是一个常数 $p$，其中 $p \\in (0, 1)$。保证该模拟至少运行一步。设 $T$ 为代表模拟运行总步数的随机变量。\n\n模拟的最終输出是所有生成的更新值的累积和，记为 $S_T = \\sum_{i=1}^{T} X_i$。\n\n请确定该最終输出的方差 $\\operatorname{Var}(S_T)$ 的一个闭式表达式，并用参数 $\\mu$、$\\sigma^2$ 和 $p$ 表示。", "solution": "设 $\\{X_{i}\\}_{i \\geq 1}$ 为独立同分布的随机变量，其均值为 $\\mathbb{E}[X_{i}] = \\mu$，方差为 $\\operatorname{Var}(X_{i}) = \\sigma^{2}$。设 $T$ 独立于 $X_{i}$，且服从支持集为 $\\{1,2,\\dots\\}$、参数为 $p \\in (0,1)$ 的几何分布，因此 $\\mathbb{P}(T=t) = p(1-p)^{t-1}$。\n\n我们要求解 $S_{T} = \\sum_{i=1}^{T} X_{i}$ 的方差 $\\operatorname{Var}(S_{T})$。根据全方差定律，\n$$\n\\operatorname{Var}(S_{T}) = \\mathbb{E}\\!\\left[\\operatorname{Var}(S_{T}\\mid T)\\right] + \\operatorname{Var}\\!\\left(\\mathbb{E}[S_{T}\\mid T]\\right).\n$$\n给定 $T=t$，$S_{T}$ 是 $t$ 个独立同分布变量的和，因此\n$$\n\\mathbb{E}[S_{T}\\mid T=t] = t\\mu,\\qquad \\operatorname{Var}(S_{T}\\mid T=t) = t\\sigma^{2}.\n$$\n所以，$\\operatorname{Var}(S_{T}) = \\mathbb{E}[t\\sigma^2] + \\operatorname{Var}(t\\mu) = \\sigma^{2}\\mathbb{E}[T] + \\mu^{2}\\operatorname{Var}(T)$。\n\n剩下的任务是计算当 $T \\sim \\operatorname{Geom}(p)$ 且支持集为 $\\{1,2,\\dots\\}$ 时的期望 $\\mathbb{E}[T]$ 和方差 $\\operatorname{Var}(T)$。设 $q = 1 - p$。那么\n$$\n\\mathbb{E}[T] = \\sum_{t=1}^{\\infty} t\\, p q^{t-1} = p \\sum_{t=1}^{\\infty} t q^{t-1}.\n$$\n使用几何级数 $\\sum_{t=0}^{\\infty} q^{t} = \\frac{1}{1-q}$（对于 $|q|<1$）并对 $q$ 求导，可得\n$$\n\\sum_{t=1}^{\\infty} t q^{t-1} = \\frac{1}{(1-q)^{2}},\n$$\n所以\n$$\n\\mathbb{E}[T] = p \\cdot \\frac{1}{(1-q)^{2}} = p \\cdot \\frac{1}{p^{2}} = \\frac{1}{p}.\n$$\n接下来，\n$$\n\\mathbb{E}[T^{2}] = \\sum_{t=1}^{\\infty} t^{2} p q^{t-1} = p \\sum_{t=1}^{\\infty} t^{2} q^{t-1}.\n$$\n从 $g(q) = \\sum_{t=1}^{\\infty} t q^{t} = \\frac{q}{(1-q)^{2}}$ 出发，对其求导可得\n$$\n\\sum_{t=1}^{\\infty} t^{2} q^{t-1} = g'(q) = \\frac{1+q}{(1-q)^{3}},\n$$\n因此\n$$\n\\mathbb{E}[T^{2}] = p \\cdot \\frac{1+q}{(1-q)^{3}} = p \\cdot \\frac{2 - p}{p^{3}} = \\frac{2 - p}{p^{2}}.\n$$\n所以，\n$$\n\\operatorname{Var}(T) = \\mathbb{E}[T^{2}] - (\\mathbb{E}[T])^{2} = \\frac{2 - p}{p^{2}} - \\frac{1}{p^{2}} = \\frac{1 - p}{p^{2}}.\n$$\n代入 $\\operatorname{Var}(S_{T})$ 的表达式中，得到\n$$\n\\operatorname{Var}(S_{T}) = \\sigma^{2}\\left(\\frac{1}{p}\\right) + \\mu^{2}\\left(\\frac{1 - p}{p^{2}}\\right) = \\frac{\\sigma^{2}}{p} + \\frac{\\mu^{2}(1 - p)}{p^{2}}.\n$$\n这就是所求的闭式表达式。", "answer": "$$\\boxed{\\frac{\\sigma^{2}}{p}+\\frac{\\mu^{2}(1-p)}{p^{2}}}$$", "id": "1401012"}]}