{"hands_on_practices": [{"introduction": "第一个实践是一个基础练习，它展示了单随机变量变换的核心机制。我们将从一个已知的分布——卡方分布（chi-squared distribution）出发，通过变量变换方法来求其平方根的分布，这个过程将演示如何从现有分布中推导出新的分布[@problem_id:1956488]。", "problem": "设 $X$ 是一个服从自由度为 1 的卡方分布的随机变量，记作 $X \\sim \\chi^2(1)$。自由度为 $k$ 的卡方分布的概率密度函数 (PDF) 的一般形式为：\n$$f_X(x; k) = \\frac{1}{2^{k/2} \\Gamma\\left(\\frac{k}{2}\\right)} x^{\\frac{k}{2} - 1} \\exp\\left(-\\frac{x}{2}\\right), \\quad \\text{for } x > 0$$\n其中 $\\Gamma(z)$ 是伽玛函数。已知 $\\Gamma(1/2) = \\sqrt{\\pi}$。\n\n考虑一个新的随机变量 $Y$，定义为 $X$ 的平方根，即 $Y = \\sqrt{X}$。\n下列哪个表达式正确地表示了随机变量 $Y$ 的概率密度函数，记作 $f_Y(y)$？\n\nA. $f_Y(y) = \\sqrt{\\frac{2}{\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$，对于 $y > 0$\n\nB. $f_Y(y) = y \\exp\\left(-\\frac{y^2}{2}\\right)$，对于 $y > 0$\n\nC. $f_Y(y) = \\frac{1}{2}\\exp\\left(-\\frac{y}{2}\\right)$，对于 $y > 0$\n\nD. $f_Y(y) = \\frac{1}{\\sqrt{2\\pi y}} \\exp\\left(-\\frac{y}{2}\\right)$，对于 $y > 0$\n\nE. $f_Y(y) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$，对于 $y > 0$", "solution": "我们从自由度为1的卡方分布密度函数开始。对于 $k=1$，$X$ 的概率密度函数为\n$$\nf_{X}(x) = \\frac{1}{2^{1/2}\\Gamma\\left(\\frac{1}{2}\\right)} x^{\\frac{1}{2}-1} \\exp\\left(-\\frac{x}{2}\\right), \\quad x>0.\n$$\n使用 $\\Gamma\\left(\\frac{1}{2}\\right)=\\sqrt{\\pi}$，可将其简化为\n$$\nf_{X}(x) = \\frac{1}{2^{1/2}\\sqrt{\\pi}}\\, x^{-1/2}\\, \\exp\\left(-\\frac{x}{2}\\right), \\quad x>0.\n$$\n定义 $Y=\\sqrt{X}$。则变换关系为 $x = y^{2}$，其中 $y>0$。由于 $x=y^{2}$ 在 $y>0$ 上是严格递增的，根据变量转换公式可得\n$$\nf_{Y}(y) = f_{X}(x)\\left|\\frac{dx}{dy}\\right| \\bigg|_{x=y^{2}} = f_{X}\\left(y^{2}\\right)\\cdot 2y, \\quad y>0.\n$$\n将 $x=y^{2}$ 代入 $f_{X}$，\n$$\nf_{X}\\left(y^{2}\\right) = \\frac{1}{2^{1/2}\\sqrt{\\pi}} \\left(y^{2}\\right)^{-1/2} \\exp\\left(-\\frac{y^{2}}{2}\\right) = \\frac{1}{2^{1/2}\\sqrt{\\pi}} \\cdot \\frac{1}{y}\\, \\exp\\left(-\\frac{y^{2}}{2}\\right).\n$$\n因此，\n$$\nf_{Y}(y) = \\frac{1}{2^{1/2}\\sqrt{\\pi}} \\cdot \\frac{1}{y}\\, \\exp\\left(-\\frac{y^{2}}{2}\\right)\\cdot 2y = \\frac{2}{2^{1/2}\\sqrt{\\pi}} \\exp\\left(-\\frac{y^{2}}{2}\\right) = \\sqrt{\\frac{2}{\\pi}}\\, \\exp\\left(-\\frac{y^{2}}{2}\\right), \\quad y>0.\n$$\n这与选项A相符。", "answer": "$$\\boxed{A}$$", "id": "1956488"}, {"introduction": "从单个随机变量扩展到两个随机变量，本实践介绍了变量变换技术最重要的应用之一：求随机变量和的分布。我们将使用卷积公式，来确定一个标准正态随机变量与一个指数随机变量之和的分布。这种情况在信号处理领域很常见，例如真实信号受到噪声干扰的模型[@problem_id:1902973]。", "problem": "在一个简化的粒子探测器模型中，一次事件记录到的能量 $Z$ 是两个独立分量的和：粒子的真实能量 $Y$ 和一个随机电子噪声分量 $X$。噪声 $X$ 被建模为一个服从标准正态分布的随机变量。其概率密度函数 (PDF) 是 $f_X(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^2}{2}\\right)$，对于 $-\\infty < x < \\infty$。真实能量 $Y$ 被建模为一个服从率参数 $\\lambda > 0$ 的指数分布的随机变量。其 PDF 为 $f_Y(y) = \\lambda \\exp(-\\lambda y)$ （对于 $y \\ge 0$），且 $f_Y(y) = 0$ （对于 $y < 0$）。记录到的总能量为 $Z = X+Y$。\n\n作为参考，标准正态随机变量的累积分布函数 (CDF) 记作 $\\Phi(v) = \\int_{-\\infty}^{v} \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{t^2}{2}\\right) dt$。\n\n求随机变量 $Z$ 的 PDF $f_Z(z)$。请将答案表示为单一的闭式解析表达式。", "solution": "设 $X$ 和 $Y$ 为相互独立的随机变量，其中 $X \\sim \\mathcal{N}(0,1)$ 且 $Y \\sim \\text{Exp}(\\lambda)$。它们的和 $Z=X+Y$ 的 PDF 由卷积公式给出：\n$$\nf_{Z}(z)=\\int_{-\\infty}^{\\infty} f_{X}(z-y) f_{Y}(y) \\, dy.\n$$\n由于当 $y<0$ 时 $f_{Y}(y)=0$，上式可简化为：\n$$\nf_{Z}(z)=\\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(z-y)^{2}}{2}\\right) \\, \\lambda \\exp(-\\lambda y) \\, dy.\n$$\n合并指数项：\n$$\n-\\frac{(z-y)^{2}}{2}-\\lambda y=-\\frac{z^{2}}{2}+zy-\\frac{y^{2}}{2}-\\lambda y=-\\frac{1}{2}\\left(y-(z-\\lambda)\\right)^{2}+\\frac{1}{2}(z-\\lambda)^{2}-\\frac{z^{2}}{2}.\n$$\n于是，\n$$\nf_{Z}(z)=\\lambda \\exp\\!\\left(\\frac{1}{2}(z-\\lambda)^{2}-\\frac{z^{2}}{2}\\right)\\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{1}{2}\\left(y-(z-\\lambda)\\right)^{2}\\right) dy.\n$$\n作代换 $t=y-(z-\\lambda)$，则当 $y=0$ 时，$t=-(z-\\lambda)$；当 $y \\to \\infty$ 时，$t \\to \\infty$。积分部分变为：\n$$\n\\int_{-(z-\\lambda)}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{t^{2}}{2}\\right) dt\n=1-\\Phi\\!\\left(-(z-\\lambda)\\right)=\\Phi(z-\\lambda).\n$$\n简化预因子中的指数部分，\n$$\n\\frac{1}{2}(z-\\lambda)^{2}-\\frac{z^{2}}{2}=-\\lambda z+\\frac{\\lambda^{2}}{2}.\n$$\n因此，\n$$\nf_{Z}(z)=\\lambda \\exp\\!\\left(-\\lambda z+\\frac{\\lambda^{2}}{2}\\right)\\Phi(z-\\lambda), \\quad -\\infty<z<\\infty.\n$$\n这就是 $Z$ 的 PDF 的一个单一闭式解析表达式。", "answer": "$$\\boxed{\\lambda \\exp\\!\\left(-\\lambda z+\\frac{\\lambda^{2}}{2}\\right)\\Phi(z-\\lambda)}$$", "id": "1902973"}, {"introduction": "最后的这个实践提供了一个更复杂、多步骤的挑战，在一个真实的工程背景下展示了这些技术的多功能性。我们将推导两个独立随机变量之比的分布，而这两个随机变量本身又是来自两个不同样本的最大值。这个问题将顺序统计量的概念与比率的变量变换方法相结合，能将你的解题技巧提升到一个新的水平[@problem_id:1902985]。", "problem": "在半导体可靠性分析领域，微芯片的寿命可能会受到晶体缺陷生长的限制。两种相互竞争的制造工艺，Process Alpha和Process Beta，正在接受评估。对于来自Process Alpha的器件，已经确定随机选择的关键缺陷的尺寸分布遵循累积分布函数（CDF）$F_{\\text{Alpha}}(x) = (x/L_{\\alpha})^{a}$，其中$0 < x < L_{\\alpha}$。对于来自Process Beta的器件，缺陷尺寸同样由CDF $F_{\\text{Beta}}(y) = (y/L_{\\beta})^{b}$ 建模，其中 $0 < y < L_{\\beta}$。在这些模型中，$a > 0$ 和 $b > 0$ 是表征缺陷生长物理特性的无量纲形状参数，而 $L_{\\alpha} > 0$ 和 $L_{\\beta} > 0$ 是每种工艺固有的可能最大缺陷尺寸。\n\n为了进行比较性压力测试，一位工程师从Process Alpha中抽取了 $n$ 个器件的样本，并从Process Beta中抽取了 $m$ 个器件的样本。在Process Alpha样本中观测到的最大缺陷尺寸记为 $X_{(n)}$，在Process Beta样本中观测到的最大缺陷尺寸记为 $Y_{(m)}$。所有观测到的缺陷尺寸都假定为独立的随机变量。\n\n比较这两种工艺相对稳健性的一个关键指标是它们观测到的最大缺陷尺寸之比，$Z = X_{(n)} / Y_{(m)}$。你的任务是推导出该比率的完整概率密度函数（PDF），$f_Z(z)$。将最终答案表示为关于 $z$ 和参数 $n, m, a, b, L_{\\alpha}$ 及 $L_{\\beta}$ 的单个解析函数。", "solution": "设 $X_{1},\\dots,X_{n}$ 为来自Process Alpha的独立同分布（i.i.d.）的缺陷尺寸，其累积分布函数（CDF）为 $F_{\\text{Alpha}}(x)=(x/L_{\\alpha})^{a}$ (在 $0<x<L_{\\alpha}$ 上)，概率密度函数（PDF）为\n$$\nf_{\\text{Alpha}}(x)=\\frac{d}{dx}F_{\\text{Alpha}}(x)=\\frac{a}{L_{\\alpha}^{a}}x^{a-1},\\quad 0<x<L_{\\alpha}.\n$$\n最大值 $X_{(n)}=\\max\\{X_{1},\\dots,X_{n}\\}$ 的CDF为 $F_{X_{(n)}}(x)=\\left(F_{\\text{Alpha}}(x)\\right)^{n}=(x/L_{\\alpha})^{a n}$ (对于 $0<x<L_{\\alpha}$)，因此其PDF为\n$$\nf_{X_{(n)}}(x)=\\frac{d}{dx}F_{X_{(n)}}(x)=\\frac{a n}{L_{\\alpha}^{a n}}x^{a n-1},\\quad 0<x<L_{\\alpha}.\n$$\n类似地，设 $Y_{1},\\dots,Y_{m}$ 为来自Process Beta的独立同分布（i.i.d.）的缺陷尺寸，其CDF为 $F_{\\text{Beta}}(y)=(y/L_{\\beta})^{b}$ (在 $0<y<L_{\\beta}$ 上)，PDF为\n$$\nf_{\\text{Beta}}(y)=\\frac{b}{L_{\\beta}^{b}}y^{b-1},\\quad 0<y<L_{\\beta}.\n$$\n最大值 $Y_{(m)}$ 的PDF为\n$$\nf_{Y_{(m)}}(y)=\\frac{b m}{L_{\\beta}^{b m}}y^{b m-1},\\quad 0<y<L_{\\beta}.\n$$\n因为Alpha和Beta的样本是独立的，所以 $X_{(n)}$ 和 $Y_{(m)}$ 是独立的。定义比率 $Z=X_{(n)}/Y_{(m)}$。对于 $z>0$，使用变换 $(x,y)\\mapsto(z,y)$，其中 $x=z y$。雅可比行列式为 $|J|=y$，所以 $(Z,Y_{(m)})$ 的联合密度为\n$$\nf_{Z,Y_{(m)}}(z,y)=y\\,f_{X_{(n)}}(z y)\\,f_{Y_{(m)}}(y).\n$$\n支持集的约束条件是 $0<y<L_{\\beta}$ 和 $0<z y<L_{\\alpha}$，即 $0<y<\\min\\{L_{\\beta},L_{\\alpha}/z\\}$。因此，对于 $z>0$，\n$$\nf_{Z}(z)=\\int_{0}^{\\min\\{L_{\\beta},\\,L_{\\alpha}/z\\}} y\\,f_{X_{(n)}}(z y)\\,f_{Y_{(m)}}(y)\\,dy.\n$$\n代入各PDF，\n$$\nf_{X_{(n)}}(z y)=\\frac{a n}{L_{\\alpha}^{a n}}(z y)^{a n-1}=\\frac{a n\\,z^{a n-1}}{L_{\\alpha}^{a n}}\\,y^{a n-1},\n$$\n和\n$$\nf_{Y_{(m)}}(y)=\\frac{b m}{L_{\\beta}^{b m}}y^{b m-1},\n$$\n得到被积函数\n$$\ny\\,f_{X_{(n)}}(z y)\\,f_{Y_{(m)}}(y)=\\frac{a n\\,b m}{L_{\\alpha}^{a n}L_{\\beta}^{b m}}\\,z^{a n-1}\\,y^{a n+b m-1}.\n$$\n于是，\n$$\nf_{Z}(z)=\\frac{a n\\,b m}{L_{\\alpha}^{a n}L_{\\beta}^{b m}}\\,z^{a n-1}\\int_{0}^{\\min\\{L_{\\beta},\\,L_{\\alpha}/z\\}} y^{a n+b m-1}\\,dy\n=\\frac{a n\\,b m}{a n+b m}\\,\\frac{z^{a n-1}}{L_{\\alpha}^{a n}L_{\\beta}^{b m}}\\left(\\min\\left\\{L_{\\beta},\\frac{L_{\\alpha}}{z}\\right\\}\\right)^{a n+b m}.\n$$\n在以下两种情况下计算最小值：\n- 如果 $0<z\\leq L_{\\alpha}/L_{\\beta}$，则 $\\min\\{L_{\\beta},L_{\\alpha}/z\\}=L_{\\beta}$，得到\n$$\nf_{Z}(z)=\\frac{a n\\,b m}{a n+b m}\\left(\\frac{L_{\\beta}}{L_{\\alpha}}\\right)^{a n}z^{a n-1}.\n$$\n- 如果 $z> L_{\\alpha}/L_{\\beta}$，则 $\\min\\{L_{\\beta},L_{\\alpha}/z\\}=L_{\\alpha}/z$，得到\n$$\nf_{Z}(z)=\\frac{a n\\,b m}{a n+b m}\\left(\\frac{L_{\\alpha}}{L_{\\beta}}\\right)^{b m}z^{-(b m+1)}.\n$$\n为完整起见，当 $z\\leq 0$ 时，$f_{Z}(z)=0$。最终得到的PDF在 $z=L_{\\alpha}/L_{\\beta}$ 处是连续的，并且其在 $(0,\\infty)$ 上的积分为1。", "answer": "$$\\boxed{\nf_{Z}(z)=\n\\begin{cases}\n0, & z\\leq 0,\\\\[6pt]\n\\dfrac{a n\\,b m}{a n+b m}\\left(\\dfrac{L_{\\beta}}{L_{\\alpha}}\\right)^{a n} z^{a n-1}, & 0<z\\leq \\dfrac{L_{\\alpha}}{L_{\\beta}},\\\\[10pt]\n\\dfrac{a n\\,b m}{a n+b m}\\left(\\dfrac{L_{\\alpha}}{L_{\\beta}}\\right)^{b m} z^{-(b m+1)}, & z> \\dfrac{L_{\\alpha}}{L_{\\beta}}.\n\\end{cases}\n}$$", "id": "1902985"}]}