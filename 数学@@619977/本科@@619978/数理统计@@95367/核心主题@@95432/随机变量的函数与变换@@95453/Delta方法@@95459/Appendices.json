{"hands_on_practices": [{"introduction": "理论通过实践才能焕发生机。第一个练习将通过一个直观的物理情景，帮助你掌握德尔塔方法的基本应用。在这个练习中，我们将探讨一个基本物理量（速度）的测量不确定性，如何通过一个非线性函数（动能公式 $K = \\frac{1}{2}mv^2$）传递给一个派生量（动能）。通过解决这个问题，你将学会如何应用德尔塔方法来估计一个基于样本均值构造的非线性估计量的方差。[@problem_id:1959819]", "problem": "在一项等离子体物理实验中，一组 $n$ 个相同的、无相互作用的离子被限制在一个电磁阱中。测量了每个离子 $i$ 沿某一特定轴向的速度分量 $X_i$。测量值 $\\{X_1, X_2, \\dots, X_n\\}$ 可以被建模为来自一个分布的独立同分布随机变量，其均值为 $E[X_i] = v$，方差为 $\\text{Var}(X_i) = \\sigma^2$。已知每个离子的质量为 $m$。\n\n为了估计与平均速度分量相关的动能，一位研究人员提出了估计量 $\\hat{K} = \\frac{1}{2}m\\bar{X}_n^2$，其中 $\\bar{X}_n = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 是速度测量值的样本均值。\n\n求估计量 $\\hat{K}$ 的渐近方差。答案用 $m, v, \\sigma^2,$ 和 $n$ 表示。", "solution": "我们给定独立同分布的随机变量 $\\{X_{i}\\}_{i=1}^{n}$，其均值为 $E[X_{i}]=v$，方差为 $\\text{Var}(X_{i})=\\sigma^{2}$。定义样本均值为 $\\bar{X}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。我们感兴趣的估计量是 $\\hat{K}=\\frac{1}{2}m\\bar{X}_{n}^{2}$。\n\n根据中心极限定理，\n$$\n\\sqrt{n}\\left(\\bar{X}_{n}-v\\right)\\xrightarrow{d}\\mathcal{N}\\left(0,\\sigma^{2}\\right),\n$$\n因此，渐近地，$\\bar{X}_{n}$ 近似服从均值为 $v$、方差为 $\\sigma^{2}/n$ 的正态分布。\n\n令 $g(x)=\\frac{1}{2}mx^{2}$。则 $g'(x)=mx$。根据 Delta 方法，\n$$\n\\sqrt{n}\\left(g(\\bar{X}_{n})-g(v)\\right)\\xrightarrow{d}\\mathcal{N}\\left(0,\\left(g'(v)\\right)^{2}\\sigma^{2}\\right).\n$$\n因此，$g(\\bar{X}_{n})=\\hat{K}$ 的渐近方差为\n$$\n\\text{avar}(\\hat{K})\\approx\\frac{\\left(g'(v)\\right)^{2}\\sigma^{2}}{n}=\\frac{m^{2}v^{2}\\sigma^{2}}{n}.\n$$\n等价地，$\\text{Var}(\\hat{K})= \\frac{m^{2}v^{2}\\sigma^{2}}{n}+o\\!\\left(\\frac{1}{n}\\right)$。注意，如果 $v=0$，一阶 Delta 方法将得到零；在这种特殊情况下，方差是更小阶的，具体为 $O\\!\\left(n^{-2}\\right)$。对于 $v\\neq 0$，主导的渐近方差是 $\\frac{m^{2}v^{2}\\sigma^{2}}{n}$。", "answer": "$$\\boxed{\\frac{m^{2}v^{2}\\sigma^{2}}{n}}$$", "id": "1959819"}, {"introduction": "掌握了基本应用后，我们来探讨一个在统计学中更为核心的问题。这个练习聚焦于估计一个非常常见的统计量——伯努利试验方差 $p(1-p)$——其估计量 $g(\\hat{p}) = \\hat{p}(1-\\hat{p})$ 的不确定性。这个问题不仅能巩固你对德尔塔方法的理解，还会让你洞察其应用的微妙之处，特别是当变换函数的一阶导数在某点为零时（例如当 $p=1/2$ 时）的情况。[@problem_id:1959831]", "problem": "设 $X_1, X_2, \\ldots, X_n$ 是一个由独立同分布的随机变量组成的序列，服从参数为 $p$ 的伯努利分布，其中 $0 < p < 1$。样本比例定义为 $\\hat{p} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。该样本比例是真实比例 $p$ 的一个无偏估计量。\n\n考虑单个伯努利试验方差的估计量，它被定义为样本比例的函数：$V = g(\\hat{p}) = \\hat{p}(1-\\hat{p})$。中心极限定理表明，当样本量 $n$ 趋于无穷大时，$\\sqrt{n}(\\hat{p} - p)$ 的分布收敛于一个正态分布。因此，经过中心化和缩放的估计量 $\\sqrt{n}(V - p(1-p))$ 的分布也收敛于一个均值为 0 的正态分布。\n\n确定 $\\sqrt{n}(V - p(1-p))$ 的这个极限正态分布的方差。请用参数 $p$ 的闭式解析表达式来表示你的答案。", "solution": "设 $X_{1},\\ldots,X_{n}$ 为独立同分布的伯努利$(p)$随机变量，其中 $0<p<1$。样本比例为 $\\hat{p}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$，因此根据中心极限定理，\n$$\n\\sqrt{n}\\,(\\hat{p}-p)\\;\\xrightarrow{d}\\;N\\bigl(0,\\;p(1-p)\\bigr).\n$$\n定义 $V=g(\\hat{p})$，其中 $g(x)=x(1-x)$。我们寻求 $\\sqrt{n}\\bigl(g(\\hat{p})-g(p)\\bigr)$ 的极限方差。\n\n计算 $g$ 的导数：\n$$\ng'(x)=1-2x,\\qquad g''(x)=-2.\n$$\n对 $g$ 在 $p$ 处应用二阶泰勒展开：\n$$\ng(\\hat{p})-g(p)=g'(p)(\\hat{p}-p)+\\frac{1}{2}g''(\\tilde{p})\\,(\\hat{p}-p)^{2},\n$$\n其中 $\\tilde{p}$ 介于 $\\hat{p}$ 和 $p$ 之间。两边乘以 $\\sqrt{n}$：\n$$\n\\sqrt{n}\\bigl(g(\\hat{p})-g(p)\\bigr)=g'(p)\\sqrt{n}\\,(\\hat{p}-p)+\\frac{1}{2}g''(\\tilde{p})\\,\\sqrt{n}\\,(\\hat{p}-p)^{2}.\n$$\n由于 $\\sqrt{n}(\\hat{p}-p)=O_{p}(1)$，我们有 $\\sqrt{n}(\\hat{p}-p)^{2}=\\frac{1}{\\sqrt{n}}\\bigl(\\sqrt{n}(\\hat{p}-p)\\bigr)^{2}=o_{p}(1)$，并且 $g''(\\tilde{p})$ 是有界的。因此第二项为 $o_{p}(1)$。根据斯卢茨基定理和 Delta 方法，\n$$\n\\sqrt{n}\\bigl(g(\\hat{p})-g(p)\\bigr)\\;\\xrightarrow{d}\\;N\\Bigl(0,\\;\\bigl(g'(p)\\bigr)^{2}\\,p(1-p)\\Bigr).\n$$\n代入 $g'(p)=1-2p$ 可得渐近方差\n$$\n\\bigl(1-2p\\bigr)^{2}\\,p(1-p).\n$$\n注意，当 $p=\\frac{1}{2}$ 时，此方差等于 $0$，对应于 $\\sqrt{n}$ 缩放下的一个退化极限。", "answer": "$$\\boxed{(1-2p)^{2}p(1-p)}$$", "id": "1959831"}, {"introduction": "现实世界中的许多问题都涉及多个相互关联的变量。因此，最后一个练习将带领你从单变量世界迈向多变量领域。通过一个机器人定位的现代应用场景，你将学习如何将德尔塔方法扩展到处理多个变量的函数。这个练习不仅要求你计算函数（距离公式 $D = \\sqrt{x^2 + y^2}$）对多个变量的偏导数，还强调了如何整合这些变量之间的协方差，从而更精确地评估最终估计量的不确定性。[@problem_id:1396672]", "problem": "一个固定信标位于二维平面上的真实笛卡尔坐标 $(x_0, y_0)$ 处。一个移动机器人对信标的位置进行了 $n$ 次测量。第 $i$ 次测量是一个随机向量 $(X_i, Y_i)$。这 $n$ 次测量是独立同分布的 (i.i.d.)，具有以下统计特性：\n- 均值：$E[X_i] = x_0$ 且 $E[Y_i] = y_0$。\n- 方差：$\\text{Var}(X_i) = \\sigma^2$ 且 $\\text{Var}(Y_i) = \\sigma^2$。\n- 协方差：$\\text{Cov}(X_i, Y_i) = \\rho \\sigma^2$，其中 $\\rho$ 是 x 和 y 坐标测量误差之间的相关系数。\n\n机器人计算样本均值 $\\bar{X}_n = \\frac{1}{n} \\sum_{i=1}^n X_i$ 和 $\\bar{Y}_n = \\frac{1}{n} \\sum_{i=1}^n Y_i$。然后使用估计量 $D_n = \\sqrt{\\bar{X}_n^2 + \\bar{Y}_n^2}$ 来估计信标到原点的距离。\n\n当 $n$ 很大时，$D_n$ 的分布可以由一个正态分布来近似。请找出这个近似正态分布的方差的表达式。您的答案应以 $x_0, y_0, \\sigma, \\rho$ 和 $n$ 表示。假设 $(x_0, y_0) \\neq (0,0)$。", "solution": "我们要求解估计量 $D_{n}=\\sqrt{\\bar{X}_{n}^{2}+\\bar{Y}_{n}^{2}}$ 的大样本（渐近）方差，其中 $(\\bar{X}_{n},\\bar{Y}_{n})$ 是独立同分布观测值的样本均值，其均值向量为 $(x_{0},y_{0})$，协方差矩阵为\n$$\n\\Sigma=\\sigma^{2}\\begin{pmatrix}1 & \\rho \\\\ \\rho & 1\\end{pmatrix}.\n$$\n根据多元中心极限定理，\n$$\n\\sqrt{n}\\left(\\begin{pmatrix}\\bar{X}_{n} \\\\ \\bar{Y}_{n}\\end{pmatrix}-\\begin{pmatrix}x_{0} \\\\ y_{0}\\end{pmatrix}\\right)\\;\\xrightarrow{d}\\;\\mathcal{N}\\!\\left(\\begin{pmatrix}0 \\\\ 0\\end{pmatrix},\\Sigma\\right).\n$$\n定义函数 $g:\\mathbb{R}^{2}\\to\\mathbb{R}$ 为 $g(x,y)=\\sqrt{x^{2}+y^{2}}$。由于 $(x_{0},y_{0})\\neq(0,0)$，$g$ 在 $(x_{0},y_{0})$ 处可微，其梯度为\n$$\n\\nabla g(x_{0},y_{0})=\\begin{pmatrix}\\dfrac{x_{0}}{\\sqrt{x_{0}^{2}+y_{0}^{2}}} \\\\ \\dfrac{y_{0}}{\\sqrt{x_{0}^{2}+y_{0}^{2}}}\\end{pmatrix}.\n$$\n根据 Delta 方法，\n$$\n\\sqrt{n}\\left(g(\\bar{X}_{n},\\bar{Y}_{n})-g(x_{0},y_{0})\\right)\\;\\xrightarrow{d}\\;\\mathcal{N}\\!\\left(0,\\nabla g(x_{0},y_{0})^{\\top}\\Sigma\\,\\nabla g(x_{0},y_{0})\\right).\n$$\n因此，$D_{n}=g(\\bar{X}_{n},\\bar{Y}_{n})$ 的渐近方差为\n$$\n\\frac{1}{n}\\,\\nabla g(x_{0},y_{0})^{\\top}\\Sigma\\,\\nabla g(x_{0},y_{0}).\n$$\n令 $r_{0}=\\sqrt{x_{0}^{2}+y_{0}^{2}}$。则\n$$\n\\nabla g(x_{0},y_{0})^{\\top}\\Sigma\\,\\nabla g(x_{0},y_{0})\n=\\frac{\\sigma^{2}}{r_{0}^{2}}\\begin{pmatrix}x_{0} & y_{0}\\end{pmatrix}\n\\begin{pmatrix}1 & \\rho \\\\ \\rho & 1\\end{pmatrix}\n\\begin{pmatrix}x_{0} \\\\ y_{0}\\end{pmatrix}\n=\\frac{\\sigma^{2}}{r_{0}^{2}}\\left(x_{0}^{2}+2\\rho x_{0}y_{0}+y_{0}^{2}\\right).\n$$\n将 $r_{0}^{2}=x_{0}^{2}+y_{0}^{2}$ 代入，得到渐近方差\n$$\n\\operatorname{Var}(D_{n})\\approx \\frac{\\sigma^{2}}{n}\\,\\frac{x_{0}^{2}+2\\rho x_{0}y_{0}+y_{0}^{2}}{x_{0}^{2}+y_{0}^{2}}.\n$$\n这就是对于大样本 $n$，$D_{n}$ 的近似正态分布的方差。", "answer": "$$\\boxed{\\frac{\\sigma^{2}}{n}\\,\\frac{x_{0}^{2}+2\\rho x_{0}y_{0}+y_{0}^{2}}{x_{0}^{2}+y_{0}^{2}}}$$", "id": "1396672"}]}