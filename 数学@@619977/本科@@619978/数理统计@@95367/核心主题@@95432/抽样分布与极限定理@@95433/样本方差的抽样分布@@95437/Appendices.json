{"hands_on_practices": [{"introduction": "我们将从一个最简单的情境入手，来揭开样本方差的卡方分布的神秘面纱。当样本量为 $n=2$ 时，你会发现样本方差的公式可以被简化，从而直接与我们所熟悉的正态分布建立联系。这个练习将向你展示自由度为1的卡方分布是如何自然产生的，从而为理解更一般性的定理打下坚实的直觉基础。[@problem_id:1953272]", "id": "1953272", "problem": "在制造高精度陀螺仪的质量控制过程中，一个传感器对一个组件的角漂移率进行两次独立测量，$X_1$ 和 $X_2$。每次测量都被建模为一个随机变量，该随机变量服从一个均值为$\\mu$（真实的漂移率）、方差为已知的$\\sigma^2$的正态分布。这对测量的样本方差计算为 $S^2 = \\sum_{i=1}^{2} (X_i - \\bar{X})^2$，其中 $\\bar{X}$ 是这两次测量的样本均值。\n\n如果观测到的样本方差与固有的过程方差相比过大，该批次的组件将接受二次审查。请计算样本方差 $S^2$ 超过真实总体方差 $\\sigma^2$ 四倍的精确概率。\n\n您的最终答案应该是一个解析表达式。您可以在表达式中使用标准正态累积分布函数（CDF），对于标准正态随机变量 $Z \\sim N(0,1)$，记为 $\\Phi(z) = P(Z \\le z)$。", "solution": "我们已知两次独立测量 $X_{1}$ 和 $X_{2}$，其中 $X_{i} \\sim N(\\mu,\\sigma^{2})$，以及统计量 $S^{2} = \\sum_{i=1}^{2} (X_{i} - \\bar{X})^{2}$，其中 $\\bar{X} = (X_{1}+X_{2})/2$。对于 $n=2$，我们明确地计算 $S^{2}$：\n$$\nX_{1} - \\bar{X} = \\frac{X_{1} - X_{2}}{2}, \\quad X_{2} - \\bar{X} = \\frac{X_{2} - X_{1}}{2} = -\\frac{X_{1} - X_{2}}{2}.\n$$\n因此，\n$$\nS^{2} = \\left(\\frac{X_{1} - X_{2}}{2}\\right)^{2} + \\left(-\\frac{X_{1} - X_{2}}{2}\\right)^{2} = \\frac{(X_{1} - X_{2})^{2}}{2}.\n$$\n定义 $D = X_{1} - X_{2}$。根据独立性和正态性，两个独立正态变量的差仍然是正态分布，其均值等于均值之差，方差等于方差之和，所以\n$$\nD \\sim N(0, 2\\sigma^{2}).\n$$\n因此，\n$$\n\\frac{S^{2}}{\\sigma^{2}} = \\frac{D^{2}/2}{\\sigma^{2}} = \\left(\\frac{D}{\\sqrt{2}\\,\\sigma}\\right)^{2}.\n$$\n令 $Z = D/(\\sqrt{2}\\,\\sigma) \\sim N(0,1)$，则 $S^{2}/\\sigma^{2} = Z^{2}$。我们要求解\n$$\n\\mathbb{P}\\!\\left(S^{2} > 4\\sigma^{2}\\right) = \\mathbb{P}\\!\\left(\\frac{S^{2}}{\\sigma^{2}} > 4\\right) = \\mathbb{P}\\!\\left(Z^{2} > 4\\right) = \\mathbb{P}(|Z| > 2).\n$$\n对于一个标准正态变量 $Z$，$\\mathbb{P}(|Z| > 2) = 2\\left(1 - \\Phi(2)\\right)$，其中 $\\Phi$ 是标准正态累积分布函数。因此，精确概率是 $2\\left(1 - \\Phi(2)\\right)$。", "answer": "$$\\boxed{2\\left(1-\\Phi(2)\\right)}$$"}, {"introduction": "在建立了基本直觉之后，让我们将理解推广到一个更普遍且实用的场景中。在这个练习中，你将扮演一位质量控制工程师，需要为样本方差设定一个阈值以监控生产过程的稳定性。你需要运用样本方差与卡方分布之间关系的核心定理来计算一个概率边界，这是统计过程控制中的一项关键技能。[@problem_id:1953229]", "id": "1953229", "problem": "一家制造工厂生产高精度球形滚珠轴承。该生产工艺的设计使得滚珠轴承的直径呈正态分布，其总体方差为 $\\sigma^2 = 0.0250$ 平方毫米 (mm$^2$)。为确保生产过程的一致性，质量控制团队会定期抽取滚珠轴承的随机样本并测量其直径。\n\n现选取一个大小为 $n=20$ 的滚珠轴承样本。样本方差使用公式 $S^2 = \\frac{1}{n-1}\\sum_{i=1}^{n}(X_i - \\bar{X})^2$ 进行计算，其中 $X_i$ 是第 $i$ 个轴承的直径，$\\bar{X}$ 是样本的平均直径。\n\n团队规定，当样本方差异常高时，需对生产过程进行审查。请确定样本方差的阈值 $k$，使得 $S^2$ 小于 $k$ 的概率为 90%。答案以 mm$^2$ 为单位，并保留三位有效数字。您可能需要使用卡方分布表，自由度为 19、右尾概率为 0.10 的相关值为 $\\chi^2_{0.10, 19} = 27.204$。", "solution": "给定一个方差为 $\\sigma^{2}$ 的正态总体，并从中抽取一个大小为 $n$ 的样本，则统计量\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n-1}.\n$$\n我们要求解 $k$ 使得 $\\Pr(S^{2} < k) = 0.90$。利用变换的单调性，\n$$\n\\Pr\\!\\left(S^{2} < k\\right) = \\Pr\\!\\left(\\frac{(n-1)S^{2}}{\\sigma^{2}} < \\frac{(n-1)k}{\\sigma^{2}}\\right) = 0.90.\n$$\n设 $q$ 表示 $\\chi^{2}_{n-1}$ 的 $0.90$ 分位数。根据题目的约定，$\\chi^{2}_{0.10,19} = 27.204$ 是右尾概率为 $0.10$ 的点，因此\n$$\n\\Pr\\!\\left(\\chi^{2}_{19} < 27.204\\right) = 0.90,\n$$\n因此当 $n-1=19$ 时，$q = 27.204$。所以，\n$$\n\\frac{(n-1)k}{\\sigma^{2}} = 27.204 \\quad \\Longrightarrow \\quad k = \\frac{\\sigma^{2}\\cdot 27.204}{n-1}.\n$$\n代入 $\\sigma^{2} = 0.0250$ 和 $n-1 = 19$，\n$$\nk = \\frac{0.0250 \\times 27.204}{19} = \\frac{27.204}{760} \\approx 0.035794736842\\ \\text{mm}^{2}.\n$$\n保留三位有效数字，得到\n$$\nk \\approx 0.0358\\ \\text{mm}^{2}.\n$$", "answer": "$$\\boxed{0.0358}$$"}, {"introduction": "对一个统计分布的深刻理解，意味着你能够模拟它。这项最终练习旨在连接抽象理论与现代计算实践。你的任务是设计一个简洁而强大的算法，利用卡方分布随机数生成器来产生样本方差的模拟值，这是进行统计模拟和蒙特卡洛研究的基石。[@problem_id:1953257]", "id": "1953257", "problem": "一位质量控制工程师正在进行一项统计模拟，以研究某个制造过程的变异性。该过程生产的滚珠轴承的直径已知服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。该工程师计划模拟采集一个大小为 $n$ 的滚珠轴承随机样本，并计算样本方差，其定义为 $S^2 = \\frac{1}{n-1}\\sum_{i=1}^n (X_i - \\bar{X})^2$，其中 $\\bar{X}$ 是样本均值。\n\n为了高效地进行模拟，该工程师将使用一个统计软件库，该库提供一个函数 `chi2.rand(df)`，此函数返回一个来自具有 `df` 个自由度的卡方分布的随机变量。目标是设计一个算法，通过直接使用 `chi2.rand(df)` 函数来生成样本方差的一个模拟值，记为 $s^2$。\n\n下列哪个算法正确描述了如何从 $S^2$ 的抽样分布中生成这样一个值 $s^2$？\n\nA. 使用 `y = chi2.rand(n-1)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{\\sigma^2 y}{n-1}$。\nB. 使用 `y = chi2.rand(n)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{\\sigma^2 y}{n}$。\nC. 从标准正态分布 $N(0, 1)$ 中生成 $n$ 个随机值 $x_1, \\dots, x_n$。计算模拟值为 $s^2 = \\sum_{i=1}^n x_i^2$。\nD. 使用 `y = chi2.rand(n-1)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{\\sigma^2 y}{n}$。\nE. 使用 `y = chi2.rand(n)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{(n-1) y}{\\sigma^2}$。", "solution": "设 $X_{1},\\dots,X_{n}$ 独立同分布于 $N(\\mu,\\sigma^{2})$。样本方差为\n$$\nS^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2},\n$$\n其中 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。\n\n通过定义 $Z_{i}=\\frac{X_{i}-\\mu}{\\sigma}$（$i=1,\\dots,n$）进行标准化。那么 $Z_{i}\\sim N(0,1)$ 独立同分布，且标准化变量的样本均值为 $\\bar{Z}=\\frac{\\bar{X}-\\mu}{\\sigma}$。使用恒等式\n$$\n\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}=\\sigma^{2}\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2},\n$$\n我们将样本方差重写为\n$$\nS^{2}=\\frac{\\sigma^{2}}{n-1}\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2}.\n$$\n根据 Cochran 定理（或关于正态样本的标准结论），二次型\n$$\n\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2}\n$$\n服从自由度为 $n-1$ 的卡方分布，即\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}}\\sim \\chi^{2}_{n-1}.\n$$\n等价地，如果 $Y\\sim \\chi^{2}_{n-1}$，那么\n$$\nS^{2}=\\frac{\\sigma^{2}}{n-1}Y.\n$$\n因此，要从 $S^{2}$ 的抽样分布中模拟一次抽样值 $s^{2}$，需生成 $y=\\texttt{chi2.rand}(n-1)$ 并设定\n$$\ns^{2}=\\frac{\\sigma^{2}y}{n-1}.\n$$\n这正是选项 A。其他选项要么使用了错误的自由度，要么使用了错误的缩放因子，要么没有生成以样本均值为中心的样本方差分布（这会使自由度减一）。", "answer": "$$\\boxed{A}$$"}]}