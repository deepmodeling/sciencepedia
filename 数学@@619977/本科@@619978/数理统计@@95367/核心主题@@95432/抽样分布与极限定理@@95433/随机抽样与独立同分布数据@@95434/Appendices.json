{"hands_on_practices": [{"introduction": "在统计学中，我们常常使用样本统计量来估计未知的总体参数。然而，一个好的估计量应该具备哪些性质？无偏性是其中一个关键的衡量标准。这个练习将带你探究一个核心问题：为什么我们熟悉的样本协方差公式中，分母是 $n-1$ 而不是 $n$？通过推导“朴素”样本协方差的偏差，你将亲手揭示出为了得到无偏估计，这个修正的数学必然性 [@problem_id:1949420]。", "problem": "在统计分析中，通常会从数据样本中估计总体参数。考虑一组 $n$ 个二元数据点 $(X_1, Y_1), (X_2, Y_2), \\dots, (X_n, Y_n)$，它们构成一个来自某总体的随机样本。该样本被认为是独立同分布 (IID) 的，意味着每对 $(X_i, Y_i)$ 都从相同的底层二元概率分布中抽取，并且与其他所有数据对相互独立。\n\n设总体参数如下：\n- $X$ 的总体均值：$E[X_i] = \\mu_X$\n- $Y$ 的总体均值：$E[Y_i] = \\mu_Y$\n- $X$ 的总体方差：$\\operatorname{Var}(X_i) = \\sigma_X^2$\n- $Y$ 的总体方差：$\\operatorname{Var}(Y_i) = \\sigma_Y^2$\n- $X$ 和 $Y$ 的总体协方差：$\\operatorname{Cov}(X_i, Y_i) = E[(X_i - \\mu_X)(Y_i - \\mu_Y)] = \\sigma_{xy}$\n\n一个类似于正态性假设下的最大似然估计量的总体协方差“朴素”估计量，定义为：\n$$ \\hat{\\sigma}_{xy} = \\frac{1}{n} \\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y}) $$\n其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 和 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i$ 是样本均值。\n\n估计量的偏差是其期望值与被估计参数的真值之差。对于这个估计量，其偏差由 $B(\\hat{\\sigma}_{xy}) = E[\\hat{\\sigma}_{xy}] - \\sigma_{xy}$ 给出。\n\n求出该朴素样本协方差估计量 $\\hat{\\sigma}_{xy}$ 的偏差。请用关于总体协方差 $\\sigma_{xy}$ 和样本大小 $n$ 的闭式解析表达式来表示你的答案。", "solution": "我们从朴素样本协方差估计量的定义开始：\n$$\n\\hat{\\sigma}_{xy}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})(Y_{i}-\\bar{Y}),\n$$\n其中 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$ 且 $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$。\n\n首先，使用中心化交叉乘积的代数恒等式：\n$$\n\\sum_{i=1}^{n}(X_{i}-\\bar{X})(Y_{i}-\\bar{Y})\n=\\sum_{i=1}^{n}X_{i}Y_{i}-\\bar{Y}\\sum_{i=1}^{n}X_{i}-\\bar{X}\\sum_{i=1}^{n}Y_{i}+n\\bar{X}\\bar{Y}.\n$$\n由于 $\\sum_{i=1}^{n}X_{i}=n\\bar{X}$ 且 $\\sum_{i=1}^{n}Y_{i}=n\\bar{Y}$，上式可简化为\n$$\n\\sum_{i=1}^{n}(X_{i}-\\bar{X})(Y_{i}-\\bar{Y})=\\sum_{i=1}^{n}X_{i}Y_{i}-n\\bar{X}\\bar{Y}.\n$$\n因此，\n$$\nE[\\hat{\\sigma}_{xy}]=\\frac{1}{n}\\sum_{i=1}^{n}E[X_{i}Y_{i}]-E[\\bar{X}\\bar{Y}].\n$$\n\n计算每个期望值：\n1) 根据协方差的定义，$\\operatorname{Cov}(X_{i},Y_{i})=E[X_{i}Y_{i}]-\\mu_{X}\\mu_{Y}=\\sigma_{xy}$，因此\n$$\nE[X_{i}Y_{i}]=\\sigma_{xy}+\\mu_{X}\\mu_{Y}.\n$$\n于是，\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}E[X_{i}Y_{i}]=\\sigma_{xy}+\\mu_{X}\\mu_{Y}.\n$$\n\n2) 对于 $E[\\bar{X}\\bar{Y}]$，可以写成\n$$\n\\bar{X}\\bar{Y}=\\frac{1}{n^{2}}\\sum_{i=1}^{n}\\sum_{j=1}^{n}X_{i}Y_{j}.\n$$\n因为数据对 $(X_{i},Y_{i})$ 是独立同分布的，并且对于不同的 $i$ 是相互独立的，所以当 $i\\neq j$ 时：$X_{i}$ 与 $Y_{j}$ 相互独立，有 $E[X_{i}Y_{j}]=E[X_{i}]E[Y_{j}]=\\mu_{X}\\mu_{Y}$。当 $i=j$ 时，$E[X_{i}Y_{i}]=\\sigma_{xy}+\\mu_{X}\\mu_{Y}$。因此，\n$$\nE[\\bar{X}\\bar{Y}]=\\frac{1}{n^{2}}\\left[n(\\sigma_{xy}+\\mu_{X}\\mu_{Y})+n(n-1)\\mu_{X}\\mu_{Y}\\right]\n=\\frac{\\sigma_{xy}}{n}+\\mu_{X}\\mu_{Y}.\n$$\n\n代入回去，\n$$\nE[\\hat{\\sigma}_{xy}]=\\left(\\sigma_{xy}+\\mu_{X}\\mu_{Y}\\right)-\\left(\\frac{\\sigma_{xy}}{n}+\\mu_{X}\\mu_{Y}\\right)\n=\\left(1-\\frac{1}{n}\\right)\\sigma_{xy}=\\frac{n-1}{n}\\,\\sigma_{xy}.\n$$\n\n因此偏差为\n$$\nB(\\hat{\\sigma}_{xy})=E[\\hat{\\sigma}_{xy}]-\\sigma_{xy}=\\frac{n-1}{n}\\sigma_{xy}-\\sigma_{xy}=-\\frac{1}{n}\\sigma_{xy}.\n$$", "answer": "$$\\boxed{-\\frac{\\sigma_{xy}}{n}}$$", "id": "1949420"}, {"introduction": "独立同分布（i.i.d.）假设是许多统计模型的基石，但“独立性”在现实世界中并非总是成立。本练习探讨了一个常见的情景——从有限总体中进行无放回抽样——在这种情况下，每次抽取的观测值不再是相互独立的 [@problem_id:1949462]。通过计算两次抽取结果之间的协方差，你将从数学上证明这种依赖关系，并理解为何在处理有限总体问题时需要特殊的分析方法。", "problem": "一家制造商生产了一批数量为 $N$ 的先进微处理器。为了进行质量控制，需要对每个芯片测量一项关键性能指标。设第 $i$ 个芯片的该指标值为 $c_i$，其中 $i=1, \\ldots, N$。所有 $N$ 个指标值的集合 $\\{c_1, \\ldots, c_N\\}$ 构成一个有限总体。该指标的总体均值为 $\\mu$，总体方差为 $\\sigma^2$，定义为 $\\sigma^2 = \\frac{1}{N} \\sum_{i=1}^{N} (c_i - \\mu)^2$。\n\n一名检验员进行一次大小为二的简单随机抽样，即从这批芯片中不放回地抽取两个不同的芯片。设随机变量 $X_1$ 表示第一个被选出芯片的指标值，$X_2$ 表示第二个被选出芯片的指标值。\n\n求这两个测量值之间的协方差 $\\operatorname{Cov}(X_1, X_2)$。将答案表示为以总体大小 $N$ 和总体方差 $\\sigma^2$ 表示的闭式解析表达式。", "solution": "设有限总体为值 $\\{c_{1},\\ldots,c_{N}\\}$，其总体均值为 $\\mu$，方差为 $\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N}(c_{i}-\\mu)^{2}$。检验员不放回地抽取两个不同的芯片，$X_{1}$ 和 $X_{2}$ 分别表示第一次和第二次抽取观测到的指标值。\n\n首先，计算期望：\n$$\n\\mathbb{E}[X_{1}]=\\sum_{i=1}^{N}c_{i}\\cdot\\frac{1}{N}=\\frac{1}{N}\\sum_{i=1}^{N}c_{i}=\\mu,\n\\qquad\n\\mathbb{E}[X_{2}]=\\mu,\n$$\n根据对称性和均匀抽样。\n\n接下来，计算 $\\mathbb{E}[X_{1}X_{2}]$。因为是无放回抽样，对于 $i\\neq j$，\n$$\n\\mathbb{P}(X_{1}=c_{i},X_{2}=c_{j})=\\frac{1}{N}\\cdot\\frac{1}{N-1}.\n$$\n因此，\n$$\n\\mathbb{E}[X_{1}X_{2}]\n=\\sum_{i=1}^{N}\\sum_{\\substack{j=1\\\\ j\\neq i}}^{N} c_{i}c_{j}\\cdot\\frac{1}{N}\\cdot\\frac{1}{N-1}\n=\\frac{1}{N(N-1)}\\sum_{i\\neq j}c_{i}c_{j}.\n$$\n使用恒等式\n$$\n\\sum_{i\\neq j}c_{i}c_{j}=\\left(\\sum_{i=1}^{N}c_{i}\\right)^{2}-\\sum_{i=1}^{N}c_{i}^{2}=(N\\mu)^{2}-\\sum_{i=1}^{N}c_{i}^{2}.\n$$\n根据 $\\sigma^{2}$ 的定义，\n$$\n\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N}(c_{i}-\\mu)^{2}\n=\\frac{1}{N}\\left(\\sum_{i=1}^{N}c_{i}^{2}-2\\mu\\sum_{i=1}^{N}c_{i}+N\\mu^{2}\\right)\n=\\frac{1}{N}\\left(\\sum_{i=1}^{N}c_{i}^{2}-N\\mu^{2}\\right),\n$$\n所以\n$$\n\\sum_{i=1}^{N}c_{i}^{2}=N(\\sigma^{2}+\\mu^{2}).\n$$\n因此，\n$$\n\\sum_{i\\neq j}c_{i}c_{j}=N^{2}\\mu^{2}-N(\\sigma^{2}+\\mu^{2})=N(N-1)\\mu^{2}-N\\sigma^{2}.\n$$\n将此结果代入 $\\mathbb{E}[X_{1}X_{2}]$ 可得\n$$\n\\mathbb{E}[X_{1}X_{2}]\n=\\frac{1}{N(N-1)}\\left(N(N-1)\\mu^{2}-N\\sigma^{2}\\right)\n=\\mu^{2}-\\frac{\\sigma^{2}}{N-1}.\n$$\n最后，协方差为\n$$\n\\operatorname{Cov}(X_{1},X_{2})=\\mathbb{E}[X_{1}X_{2}]-\\mathbb{E}[X_{1}]\\mathbb{E}[X_{2}]\n=\\left(\\mu^{2}-\\frac{\\sigma^{2}}{N-1}\\right)-\\mu^{2}\n=-\\frac{\\sigma^{2}}{N-1}.\n$$", "answer": "$$\\boxed{-\\frac{\\sigma^{2}}{N-1}}$$", "id": "1949462"}, {"introduction": "一个估计量的价值不仅在于其是否无偏，还在于其稳定性，而方差是衡量稳定性的重要指标。这个源于数字信号处理领域的实际问题，要求你计算信号功率估计量的方差 [@problem_id:1949474]。这个练习将强化你运用i.i.d.性质来处理随机变量求和的能力，并需要你结合正态分布的高阶矩知识，解决一个综合性的统计问题。", "problem": "在数字信号处理（DSP）领域，一个常见的任务是表征含噪信号。考虑一个由 $n$ 个电压测量值组成的序列 $V_1, V_2, \\ldots, V_n$。该序列被建模为一个随机样本，其中每个测量值 $V_i$ 都取自一个正态分布，该分布具有一个恒定但未知的均值直流偏移 $\\mu$ 和一个恒定但未知的噪声方差 $\\sigma^2$。这些测量值是独立同分布的 (i.i.d.)。\n\n一位工程师提出了一个简单的统计量 $T$，用于量化采样周期内接收信号的平均功率。该统计量定义为电压平方值的均值：\n$$T = \\frac{1}{n} \\sum_{i=1}^{n} V_i^2$$\n为了评估该统计量的可靠性，理解其变异性至关重要。确定统计量 $T$ 的方差。你的答案应该是一个用样本大小 $n$、均值直流偏移 $\\mu$ 和噪声方差 $\\sigma^2$ 表示的单一闭式解析表达式。", "solution": "我们定义 $Y_{i} = V_{i}^{2}$，因此 $T = \\frac{1}{n} \\sum_{i=1}^{n} Y_{i}$。因为 $V_{i}$ 是独立同分布的，所以 $Y_{i}$ 也是独立同分布的。因此，利用独立变量和的方差性质，\n$$\n\\operatorname{Var}(T) = \\operatorname{Var}\\!\\left(\\frac{1}{n} \\sum_{i=1}^{n} Y_{i}\\right) = \\frac{1}{n^{2}} \\sum_{i=1}^{n} \\operatorname{Var}(Y_{i}) = \\frac{1}{n} \\operatorname{Var}(Y_{1}) = \\frac{1}{n} \\operatorname{Var}(V^{2}),\n$$\n其中 $V \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。\n\n我们通过矩来计算 $\\operatorname{Var}(V^{2})$。首先，\n$$\n\\mathbb{E}[V^{2}] = \\operatorname{Var}(V) + (\\mathbb{E}[V])^{2} = \\sigma^{2} + \\mu^{2}.\n$$\n为了求 $\\mathbb{E}[V^{4}]$，我们将 $V$ 写成 $V = \\mu + Z$，其中 $Z \\sim \\mathcal{N}(0,\\sigma^{2})$。那么\n$$\nV^{4} = (\\mu + Z)^{4} = \\mu^{4} + 4 \\mu^{3} Z + 6 \\mu^{2} Z^{2} + 4 \\mu Z^{3} + Z^{4}.\n$$\n取期望并利用 $\\mathbb{E}[Z] = 0$、$\\mathbb{E}[Z^{3}] = 0$、$\\mathbb{E}[Z^{2}] = \\sigma^{2}$，以及对于零均值正态分布有 $\\mathbb{E}[Z^{4}] = 3 \\sigma^{4}$，我们得到\n$$\n\\mathbb{E}[V^{4}] = \\mu^{4} + 6 \\mu^{2} \\sigma^{2} + 3 \\sigma^{4}.\n$$\n因此，\n$$\n\\operatorname{Var}(V^{2}) = \\mathbb{E}[V^{4}] - \\big(\\mathbb{E}[V^{2}]\\big)^{2} = \\left(\\mu^{4} + 6 \\mu^{2} \\sigma^{2} + 3 \\sigma^{4}\\right) - \\left(\\mu^{2} + \\sigma^{2}\\right)^{2} = 4 \\mu^{2} \\sigma^{2} + 2 \\sigma^{4}.\n$$\n最后，\n$$\n\\operatorname{Var}(T) = \\frac{1}{n} \\operatorname{Var}(V^{2}) = \\frac{1}{n} \\left(4 \\mu^{2} \\sigma^{2} + 2 \\sigma^{4}\\right) = \\frac{2 \\sigma^{2} \\left(2 \\mu^{2} + \\sigma^{2}\\right)}{n}.\n$$", "answer": "$$\\boxed{\\frac{2 \\sigma^{2} \\left(2 \\mu^{2} + \\sigma^{2}\\right)}{n}}$$", "id": "1949474"}]}