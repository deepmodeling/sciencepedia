{"hands_on_practices": [{"introduction": "理解一个概率分布的最佳方式之一是了解如何从更基础的分布中生成它。这个练习将带你回到卡方分布的根本定义：即作为独立标准正态随机变量的平方和。通过设计一个模拟算法，你不仅能掌握其理论基础，还能为在计算机模拟中应用卡方分布打下实践基础。[@problem_id:1903721]", "problem": "在开发一个自定义统计模拟库时，一名程序员的任务是创建一个函数，用于从具有 $k$ 个自由度的卡方分布（记为 $\\chi^2(k)$）中生成随机变量，其中 $k$ 是一个正整数。唯一可用的工具是一个预先存在的函数 `get_std_normal()`，该函数返回一个从标准正态分布 $N(0, 1)$ 中抽取的随机数。\n\n该程序员必须设计一个算法，通过一次或多次调用 `get_std_normal()` 来正确地从 $\\chi^2(k)$ 分布中生成一个随机变量。以下提出的算法中，哪一个能正确完成此任务？\n\nA. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 上。`sum_of_squares` 的最终值即为结果。\n\nB. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并把 $z$ 加到 `sum_val` 上。`sum_val` 的最终值即为结果。\n\nC. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并把 $z$ 加到 `sum_val` 上。最终结果是 `sum_val` 的平方。\n\nD. 调用 `get_std_normal()` 恰好一次以得到一个值 $z$。结果是 $k \\times z$。\n\nE. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 上。最终结果是 `sum_of_squares` 除以 $k$。", "solution": "令 $Z_{1},\\dots,Z_{k}$ 为独立的标准正态随机变量，每个变量都通过调用 get_std_normal() 获得，因此 $Z_{i} \\sim N(0,1)$ 且各 $Z_{i}$ 是相互独立的。根据卡方分布的定义属性，平方和\n$$\nQ=\\sum_{i=1}^{k} Z_{i}^{2}\n$$\n服从 $\\chi^{2}(k)$ 分布。这可以通过矩生成函数来验证：对于 $t<\\frac{1}{2}$， $Z_{i}^{2}$ 的矩生成函数是 $(1-2t)^{-1/2}$，并且根据独立性，\n$$\nM_{Q}(t)=\\prod_{i=1}^{k}(1-2t)^{-1/2}=(1-2t)^{-k/2},\n$$\n这正是 $\\chi^{2}(k)$ 分布的矩生成函数。因此，计算 $k$ 个独立的标准正态随机变量的平方和正是正确的算法。\n\n现在评估每个提出的算法：\n\nA. 该算法计算 $Q=\\sum_{i=1}^{k} Z_{i}^{2}$，根据定义，它服从 $\\chi^{2}(k)$ 分布。因此 A 是正确的。\n\nB. 该算法计算 $S=\\sum_{i=1}^{k} Z_{i}$，它服从正态分布 $S \\sim N(0,k)$，而不是卡方分布。因此 B 是不正确的。\n\nC. 该算法计算 $S^{2}$，其中 $S=\\sum_{i=1}^{k} Z_{i} \\sim N(0,k)$。那么 $S/\\sqrt{k} \\sim N(0,1)$ 且 $S^{2}=k\\,(S/\\sqrt{k})^{2}$，所以 $S^{2}$ 服从 $k \\cdot \\chi^{2}(1)$ 分布，除非 $k=1$，否则它不是 $\\chi^{2}(k)$ 分布。因此 C 在一般情况下是不正确的。\n\nD. 该算法计算 $k Z$，其中单个 $Z \\sim N(0,1)$，得到的是 $N(0,k^{2})$ 分布，而不是卡方分布。因此 D 是不正确的。\n\nE. 该算法计算 $\\frac{1}{k}\\sum_{i=1}^{k} Z_{i}^{2}=\\frac{1}{k}\\,\\chi^{2}(k)$，这是一个缩放的卡方变量，而不是 $\\chi^{2}(k)$ 变量。因此 E 是不正确的。\n\n因此，唯一正确的算法是 A。", "answer": "$$\\boxed{A}$$", "id": "1903721"}, {"introduction": "卡方分布的许多应用都依赖于其均值和方差等基本性质，而这些性质都与一个关键参数——自由度 $k$ ——紧密相连。这个练习是一个快速而核心的检验，旨在巩固你对卡方分布均值 $E[X] = k$ 与方差 $\\text{Var}(X) = 2k$ 之间关系的理解。掌握这个关系对于后续进行假设检验和区间估计至关重要。[@problem_id:2324]", "problem": "已知一个随机变量 $X$ 服从卡方分布，记为 $X \\sim \\chi^2(k)$，其中 $k$ 是自由度。卡方分布是一种在统计推断中广泛使用的连续概率分布。\n\n自由度为 $k$ 的卡方分布的基本性质是其均值（期望值）和方差：\n- 均值：$E[X] = k$\n- 方差：$\\text{Var}(X) = 2k$\n\n已知一个特定的卡方随机变量 $X$ 的均值为 $\\mu = 6$，求 $X$ 的方差。", "solution": "对于 $X\\sim\\chi^2(k)$，我们有标准结果\n$$E[X]=k,\\qquad \\mathrm{Var}(X)=2k.$$\n已知 $E[X]=\\mu=6$，因此\n$$k=6.$$\n代入方差公式可得\n$$\\mathrm{Var}(X)=2k=2\\cdot6=12.$$", "answer": "$$\\boxed{12}$$", "id": "2324"}, {"introduction": "理论知识的价值最终体现在解决实际问题上，而卡方分布是统计推断中用于此目的的强大工具。本练习将你置于一个经典的科学场景——拟合优度检验中，你需要使用卡方分布来评估一个遗传模型是否与观测数据相符。通过这个实践，你将学会如何使用统计表来计算p值，这是统计学家做出决策的关键一步。[@problem_id:1903706]", "problem": "一组农学家正在研究一种新发现的植物物种的花色遗传。根据他们的遗传模型，将一对特定的亲本植物进行杂交，应能产生具有四种不同花色（红色、蓝色、黄色、白色）的后代，且这些花色遵循一个固定的理论比例。为了检验这个模型，他们进行了一项实验，并统计了每个颜色类别中后代的数量。\n\n他们使用卡方拟合优度检验。检验统计量（记为 $X$）是根据观测计数和期望计数计算得出的。在他们的遗传模型是正确的（即原假设）这一前提下，该检验统计量 $X$ 服从卡方分布。此检验的自由度 ($df$) 由 $k - 1$ 给出，其中 $k$ 是类别的数量（在本例中为四种花色）。\n\n完成实验后，农学家们计算出检验统计量的值为 $X_{\\text{obs}} = 6.251$。在统计检验中，p值指的是在原假设为真的前提下，获得一个至少与实际观测结果一样极端或更极端的检验结果的概率。对于此检验，更极端的结果对应于更大的检验统计量值。\n\n使用所提供的卡方分布累积概率表 $P(X \\le \\chi^2)$，确定一个服从相应卡方分布的随机变量大于观测到的检验统计量 $6.251$ 的概率。请将您的答案表示为小数。\n\n**卡方分布累积概率表**\n下表给出了在选定的自由度 ($df$) 和累积概率 $p$ 下的 $\\chi^2$ 值。给定行和列的条目是 $\\chi^2$ 的值，使得 $P(X \\le \\chi^2) = p$。\n\n| | **累积概率 (p)** | | | |\n| :---: | :---: | :---: | :---: | :---: |\n| **自由度 (df)** | **0.05** | **0.10** | **0.90** | **0.95** |\n| **2** | 0.103 | 0.211 | 4.605 | 5.991 |\n| **3** | 0.352 | 0.584 | 6.251 | 7.815 |\n| **4** | 0.711 | 1.064 | 7.779 | 9.488 |", "solution": "我们有 $k=4$ 个颜色类别，因此卡方拟合优度检验的自由度为 $df=k-1=4-1=3$。观测到的检验统计量为 $X_{\\text{obs}}=6.251$。我们要求解概率 $P(X>6.251)$，其中 $X \\sim \\chi^2(3)$。\n\n根据所提供的表格，当 $df=3$ 时，累积概率 $p=0.90$ 对应的条目为 $\\chi^{2}=6.251$。根据表格的定义，这意味着 $P(X\\leq 6.251)=0.90$。\n\n因此，\n$$\nP(X>6.251)=1-P(X\\leq 6.251)=1-0.90=0.10.\n$$", "answer": "$$\\boxed{0.10}$$", "id": "1903706"}]}