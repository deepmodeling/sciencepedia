{"hands_on_practices": [{"introduction": "我们从一个经典的离散分布例子开始，来练习寻找最小充分统计量的基本步骤。这个练习将带你应用因子分解定理来识别一个充分统计量，然后通过似然比方法来验证其最小性。掌握这个过程是理解更复杂统计推断问题的基础。[@problem_id:1935626]", "problem": "设 $X_1, X_2, \\ldots, X_n$ 是来自一个分布的大小为 $n$ 的随机样本，该分布表示在一系列独立伯努利试验中为取得首次成功所需的试验次数。这些随机变量是独立同分布的 (i.i.d.)。在任何单次试验中，成功的概率为 $p$，其中 $0 < p < 1$。每个 $X_i$ 的概率质量函数 (PMF) 由下式给出：\n$$f(x; p) = (1-p)^{x-1} p, \\quad \\text{其中 } x = 1, 2, 3, \\ldots$$\n求参数 $p$ 的一个最小充分统计量。请将答案表示为样本观测值 $x_1, x_2, \\ldots, x_n$ 的函数。", "solution": "为了找到参数 $p$ 的最小充分统计量，我们首先使用奈曼-费雪因子分解定理找到一个充分统计量，然后证明其最小性。\n\n令 $\\mathbf{x} = (x_1, x_2, \\ldots, x_n)$ 表示随机样本 $\\mathbf{X} = (X_1, X_2, \\ldots, X_n)$ 的一个观测结果。第一步是写出样本的联合概率质量函数 (PMF)，也称为似然函数 $L(p; \\mathbf{x})$。由于随机变量 $X_i$ 是独立同分布的，联合 PMF 是各个 PMF 的乘积：\n$$L(p; \\mathbf{x}) = \\prod_{i=1}^{n} f(x_i; p) = \\prod_{i=1}^{n} \\left( (1-p)^{x_i-1} p \\right)$$\n我们可以通过组合包含 $p$ 和 $(1-p)$ 的项来简化此表达式：\n$$L(p; \\mathbf{x}) = \\left( \\prod_{i=1}^{n} (1-p)^{x_i-1} \\right) \\left( \\prod_{i=1}^{n} p \\right)$$\n利用指数和乘积的性质，上式变为：\n$$L(p; \\mathbf{x}) = (1-p)^{\\sum_{i=1}^{n} (x_i-1)} p^n$$\n$$L(p; \\mathbf{x}) = (1-p)^{(\\sum_{i=1}^{n} x_i) - n} p^n$$\n奈曼-费雪因子分解定理指出，一个统计量 $T(\\mathbf{X})$ 是参数 $\\theta$ 的充分统计量，当且仅当似然函数可以被分解为两个非负函数 $g(T(\\mathbf{x}); \\theta)$ 和 $h(\\mathbf{x})$ 的乘积，使得 $L(\\theta; \\mathbf{x}) = g(T(\\mathbf{x}); \\theta) \\cdot h(\\mathbf{x})$。其中函数 $g$ 仅通过统计量 $T(\\mathbf{x})$ 依赖于数据 $\\mathbf{x}$，而函数 $h$ 仅依赖于数据 $\\mathbf{x}$ 而不依赖于参数 $\\theta$。\n\n在我们的例子中，我们可以确定这些函数为：\n$$g(T(\\mathbf{x}); p) = (1-p)^{(\\sum_{i=1}^{n} x_i) - n} p^n$$\n$$h(\\mathbf{x}) = 1$$\n函数 $g$ 仅通过和 $\\sum_{i=1}^{n} x_i$ 依赖于数据 $\\mathbf{x}$。因此，根据因子分解定理，统计量 $T(\\mathbf{X}) = \\sum_{i=1}^{n} X_i$ 是 $p$ 的一个充分统计量。\n\n接下来，我们必须验证这个统计量是否是最小的。一个充分统计量 $T(\\mathbf{X})$ 是最小的，如果对于任意两个样本点 $\\mathbf{x}$ 和 $\\mathbf{y}$，似然比 $L(p; \\mathbf{x}) / L(p; \\mathbf{y})$ 作为一个关于 $p$ 的函数是常数，当且仅当 $T(\\mathbf{x}) = T(\\mathbf{y})$。\n\n我们来计算两个样本点 $\\mathbf{x} = (x_1, \\ldots, x_n)$ 和 $\\mathbf{y} = (y_1, \\ldots, y_n)$ 的似然比：\n$$\\frac{L(p; \\mathbf{x})}{L(p; \\mathbf{y})} = \\frac{(1-p)^{(\\sum_{i=1}^{n} x_i) - n} p^n}{(1-p)^{(\\sum_{i=1}^{n} y_i) - n} p^n}$$\n$p^n$ 项相互抵消，我们可以合并以 $(1-p)$ 为底的项：\n$$\\frac{L(p; \\mathbf{x})}{L(p; \\mathbf{y})} = (1-p)^{(\\sum_{i=1}^{n} x_i) - n - ((\\sum_{i=1}^{n} y_i) - n)}$$\n$$\\frac{L(p; \\mathbf{x})}{L(p; \\mathbf{y})} = (1-p)^{(\\sum_{i=1}^{n} x_i) - (\\sum_{i=1}^{n} y_i)}$$\n为使该比率成为一个不依赖于参数 $p$ 的常数，$(1-p)$ 的指数必须为零。这是因为如果指数不为零，那么当 $p$ 在其定义域 $(0,1)$ 内变化时，该表达式的值将会改变。\n指数为零当且仅当：\n$$(\\sum_{i=1}^{n} x_i) - (\\sum_{i=1}^{n} y_i) = 0$$\n这等价于：\n$$\\sum_{i=1}^{n} x_i = \\sum_{i=1}^{n} y_i$$\n这正是条件 $T(\\mathbf{x}) = T(\\mathbf{y})$。由于似然比不依赖于 $p$ 当且仅当 $T(\\mathbf{x}) = T(\\mathbf{y})$，我们得出结论，统计量 $T(\\mathbf{X}) = \\sum_{i=1}^{n} X_i$ 是 $p$ 的一个最小充分统计量。\n\n问题要求将统计量表示为样本观测值的函数，即 $T(\\mathbf{x}) = \\sum_{i=1}^{n} x_i$。", "answer": "$$\\boxed{\\sum_{i=1}^{n} x_{i}}$$", "id": "1935626"}, {"introduction": "现在，让我们将最小充分性的概念应用到一个更具体的科学场景中：群体遗传学的哈代-温伯格平衡模型。这个问题展示了如何处理多项分布，并揭示了最小充分统计量如何将多个观测数据（基因型计数）压缩成一个更有意义的单一数值（等位基因总数）。通过这个练习，你将体会到统计量在现实世界数据简化中的强大作用。[@problem_id:1935612]", "problem": "在群体遗传学中，一个基本概念是哈代-温伯格平衡，它描述了一个没有在演化中的群体的遗传构成。对于一个具有两个等位基因 A 和 a 的基因，设群体中等位基因 A 的频率为 $\\theta$，等位基因 a 的频率为 $1-\\theta$，其中参数 $\\theta$ 位于区间 $(0, 1)$ 内。根据哈代-温伯格原理，三种可能的基因型——AA、Aa 和 aa——的期望频率分别为 $\\theta^2$、$2\\theta(1-\\theta)$ 和 $(1-\\theta)^2$。\n\n一位遗传学家从这个大群体中收集了一个包含 $n$ 个个体的随机样本，以估计等位基因频率 $\\theta$。设样本中基因型为 AA 的个体数量为 $N_1$，基因型为 Aa 的个体数量为 $N_2$，基因型为 aa 的个体数量为 $N_3$。总样本量为 $n = N_1 + N_2 + N_3$。观测到的计数向量 $(N_1, N_2, N_3)$ 可以被建模为从一个多项分布中的一次抽取。\n\n根据观测到的计数 $(N_1, N_2, N_3)$，确定参数 $\\theta$ 的一个最小充分统计量。你的答案应该是一个用 $N_1$、$N_2$ 和 $N_3$ 表示的表达式。", "solution": "设在哈代-温伯格平衡下，基因型 AA 的概率为 $p_{1}=\\theta^{2}$，Aa 的概率为 $p_{2}=2\\theta(1-\\theta)$，aa 的概率为 $p_{3}=(1-\\theta)^{2}$。对于观测计数 $(N_{1},N_{2},N_{3})$ 和固定的总数 $n=N_{1}+N_{2}+N_{3}$，多项模型下的联合概率质量函数为\n$$\nf_{\\theta}(N_{1},N_{2},N_{3})=\\frac{n!}{N_{1}!N_{2}!N_{3}!}\\left(\\theta^{2}\\right)^{N_{1}}\\left(2\\theta(1-\\theta)\\right)^{N_{2}}\\left((1-\\theta)^{2}\\right)^{N_{3}}.\n$$\n这可以简化为\n$$\nf_{\\theta}(N_{1},N_{2},N_{3})=\\frac{n!}{N_{1}!N_{2}!N_{3}!}\\,2^{N_{2}}\\,\\theta^{2N_{1}+N_{2}}(1-\\theta)^{2N_{3}+N_{2}}.\n$$\n根据奈曼-费雪因子分解定理，当 $n$ 固定且已知时，我们可以写出\n$$\nf_{\\theta}(N_{1},N_{2},N_{3})=\\underbrace{\\theta^{T}(1-\\theta)^{2n-T}}_{g_{\\theta}(T)}\\;\\underbrace{\\frac{n!}{N_{1}!N_{2}!N_{3}!}\\,2^{N_{2}}}_{h(N_{1},N_{2},N_{3})},\n$$\n其中 $T=2N_{1}+N_{2}$。因此，$T=2N_{1}+N_{2}$ 是 $\\theta$ 的一个充分统计量。\n\n为证明其最小充分性，使用 Lehmann–Scheffé–Bahadur 准则：对于具有相同 $n$ 的两个结果 $(n_{1},n_{2},n_{3})$ 和 $(m_{1},m_{2},m_{3})$，考虑\n$$\n\\frac{f_{\\theta}(n_{1},n_{2},n_{3})}{f_{\\theta}(m_{1},m_{2},m_{3})}\n=\\frac{\\frac{n!}{n_{1}!n_{2}!n_{3}!}2^{n_{2}}\\theta^{2n_{1}+n_{2}}(1-\\theta)^{2n_{3}+n_{2}}}{\\frac{n!}{m_{1}!m_{2}!m_{3}!}2^{m_{2}}\\theta^{2m_{1}+m_{2}}(1-\\theta)^{2m_{3}+m_{2}}}\n=C(n,m)\\left(\\frac{\\theta}{1-\\theta}\\right)^{(2n_{1}+n_{2})-(2m_{1}+m_{2})},\n$$\n其中 $C(n,m)$ 不含 $\\theta$。该比率与 $\\theta$ 无关当且仅当 $2n_{1}+n_{2}=2m_{1}+m_{2}$。因此，由该分布族导出的等价类恰好是那些具有相同 $T=2N_{1}+N_{2}$ 值的类，这证明了 $T$ 是最小充分的。\n\n因此，$\\theta$ 的一个最小充分统计量是样本中 A 等位基因的总数，即 $2N_{1}+N_{2}$。", "answer": "$$\\boxed{2N_{1}+N_{2}}$$", "id": "1935612"}, {"introduction": "最后，我们来挑战一种不同类型的问题，即参数决定了数据取值范围（支撑集）的情况。与之前关注求和的例子不同，处理这类“非常规”分布时，样本的极值（最大值和最小值）变得至关重要。这个练习将向你展示如何利用次序统计量来构建最小充分统计量，从而拓宽你对充分性原理适用范围的理解。[@problem_id:1935627]", "problem": "一位质量控制工程师正在分析一个生产高精度金属棒的制造过程。每根金属棒的长度被建模为服从区间 $[\\theta, 2\\theta]$ 上均匀分布的一个随机变量，其中参数 $\\theta > 0$ 是机器当前校准状态的一个未知特性。为了监测和估计 $\\theta$，该工程师收集了一个由 $n$ 个棒长组成的随机样本，记为 $X_1, X_2, \\dots, X_n$。\n\n为了在不损失关于参数 $\\theta$ 的信息的情况下有效地总结数据，该工程师需要计算一个最小充分统计量。令 $X_{(1)}$ 为样本中的最小值（最小顺序统计量），$X_{(n)}$ 为样本中的最大值（最大顺序统计量）。\n\n下列哪一项代表了参数 $\\theta$ 的一个最小充分统计量？\n\nA. $X_{(n)}$\n\nB. $\\frac{X_{(1)}}{X_{(n)}}$\n\nC. $(X_{(1)}, X_{(n)})$\n\nD. $X_{(1)} + X_{(n)}$\n\nE. $X_{(n)} - X_{(1)}$\n\nF. $\\frac{1}{n} \\sum_{i=1}^{n} X_i$", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的，其密度为\n$$\nf(x\\mid \\theta)=\\frac{1}{\\theta}\\,\\mathbf{1}\\{\\theta \\leq x \\leq 2\\theta\\},\\quad \\theta>0.\n$$\n对于一个样本 $\\mathbf{x}=(x_{1},\\dots,x_{n})$，其联合密度为\n$$\nf(\\mathbf{x}\\mid \\theta)=\\prod_{i=1}^{n}\\frac{1}{\\theta}\\,\\mathbf{1}\\{\\theta \\leq x_{i} \\leq 2\\theta\\}\n=\\theta^{-n}\\,\\mathbf{1}\\{\\theta \\leq x_{(1)}\\}\\,\\mathbf{1}\\{2\\theta \\geq x_{(n)}\\}.\n$$\n等价地，\n$$\nf(\\mathbf{x}\\mid \\theta)=\\theta^{-n}\\,\\mathbf{1}\\left\\{\\frac{x_{(n)}}{2} \\leq \\theta \\leq x_{(1)}\\right\\}.\n$$\n这表明似然函数仅通过 $(x_{(1)},x_{(n)})$ 依赖于数据。定义 $T(\\mathbf{x})=(x_{(1)},x_{(n)})$。于是我们可以将联合密度写为\n$$\nf(\\mathbf{x}\\mid \\theta)=g(T(\\mathbf{x}),\\theta)\\,h(\\mathbf{x}),\n$$\n其中 $g((a,b),\\theta)=\\theta^{-n}\\,\\mathbf{1}\\{b/2 \\leq \\theta \\leq a\\}$ 且 $h(\\mathbf{x})=1$。根据奈曼-费雪分解定理，$T=(X_{(1)},X_{(n)})$ 是 $\\theta$ 的充分统计量。\n\n为证明其最小充分性，使用 Lehmann–Scheffé 准则：统计量 $T$ 是最小充分的，当且仅当对于任意两个样本 $\\mathbf{x}$ 和 $\\mathbf{y}$，\n$$\n\\frac{f(\\mathbf{x}\\mid \\theta)}{f(\\mathbf{y}\\mid \\theta)} \\text{ is free of } \\theta \\quad \\Longleftrightarrow \\quad T(\\mathbf{x})=T(\\mathbf{y}).\n$$\n计算\n$$\n\\frac{f(\\mathbf{x}\\mid \\theta)}{f(\\mathbf{y}\\mid \\theta)}=\\frac{\\theta^{-n}\\,\\mathbf{1}\\{x_{(n)}/2 \\leq \\theta \\leq x_{(1)}\\}}{\\theta^{-n}\\,\\mathbf{1}\\{y_{(n)}/2 \\leq \\theta \\leq y_{(1)}\\}}=\\frac{\\mathbf{1}\\{x_{(n)}/2 \\leq \\theta \\leq x_{(1)}\\}}{\\mathbf{1}\\{y_{(n)}/2 \\leq \\theta \\leq y_{(1)}\\}}.\n$$\n该比值是关于 $\\theta$ 的常数，当且仅当两个示性函数对（除去一个零测集之外的）所有 $\\theta$ 都相等，而这又当且仅当区间 $[x_{(n)}/2,x_{(1)}]$ 和 $[y_{(n)}/2,y_{(1)}]$ 完全相同。这等价于 $x_{(1)}=y_{(1)}$ 和 $x_{(n)}=y_{(n)}$，即 $T(\\mathbf{x})=T(\\mathbf{y})$。因此，$T=(X_{(1)},X_{(n)})$ 是最小充分统计量。\n\n在给出的选项中，仅有选项 C 同时包含 $X_{(1)}$ 和 $X_{(n)}$，故最小充分统计量是 $(X_{(1)},X_{(n)})$。", "answer": "$$\\boxed{C}$$", "id": "1935627"}]}