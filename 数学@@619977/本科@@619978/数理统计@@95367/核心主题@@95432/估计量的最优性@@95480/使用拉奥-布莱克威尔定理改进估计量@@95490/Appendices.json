{"hands_on_practices": [{"introduction": "本练习将带你处理经典的泊松分布。你将从一个基于单个观测值的参数 $\\lambda^2$ 的无偏估计量出发，通过对充分统计量（样本总和）取条件期望，来构造一个更优的估计量。这个过程清晰地展示了Rao-Blackwell定理如何利用样本的集体信息来降低估计的方差 [@problem_id:1922440]。", "problem": "设 $X_1, X_2, \\ldots, X_n$ 是来自一个均值 $\\lambda > 0$ 未知的泊松分布的大小为 $n > 1$ 的独立同分布随机样本。我们感兴趣的是估计参数 $\\theta = \\lambda^2$。\n\n可以证明，统计量 $T = X_1(X_1 - 1)$ 是 $\\theta$ 的一个无偏估计量。然而，这个估计量并非最优，因为它仅基于单个观测值 $X_1$。为了构造一个统计上更有效的估计量，可以计算在给定 $\\lambda$ 的充分统计量下 $T$ 的条件期望。对于泊松样本，其充分统计量是所有观测值的和，$S = \\sum_{i=1}^n X_i$。\n\n你的任务是计算改进的估计量 $T'$，它被定义为在给定 $S$ 下 $T$ 的条件期望。\n$$T' = E[T | S]$$\n请将你的最终答案表示为充分统计量 $S$ 和样本大小 $n$ 的解析函数。", "solution": "设 $X_{1},\\ldots,X_{n}$ 独立同分布于 $\\operatorname{Poisson}(\\lambda)$，且 $S=\\sum_{i=1}^{n}X_{i}$ 是 $\\lambda$ 的充分统计量。定义 $T=X_{1}(X_{1}-1)$。根据 Rao-Blackwell 定理，改进的估计量是 $T'=\\mathbb{E}[T\\mid S]$。\n\n对于独立同分布的泊松变量，在给定 $S=s$ 的条件下，向量 $(X_{1},\\ldots,X_{n})$ 服从试验次数为 $s$、各单元概率均等于 $1/n$ 的多项分布。特别地，\n$$\nX_{1}\\mid S=s \\sim \\operatorname{Binomial}\\!\\left(s,\\frac{1}{n}\\right).\n$$\n使用恒等式 $\\mathbb{E}[X(X-1)]=\\operatorname{Var}(X)+\\{\\mathbb{E}[X]\\}^{2}-\\mathbb{E}[X]$，并将其应用于给定 $S=s$ 的条件，我们计算\n$$\n\\mathbb{E}\\!\\left[X_{1}(X_{1}-1)\\mid S=s\\right]\n=\\operatorname{Var}(X_{1}\\mid S=s)+\\left(\\mathbb{E}[X_{1}\\mid S=s]\\right)^{2}-\\mathbb{E}[X_{1}\\mid S=s].\n$$\n对于 $X_{1}\\mid S=s\\sim \\operatorname{Binomial}(s,1/n)$，我们有\n$$\n\\mathbb{E}[X_{1}\\mid S=s]=\\frac{s}{n},\\qquad \\operatorname{Var}(X_{1}\\mid S=s)=\\frac{s}{n}\\left(1-\\frac{1}{n}\\right)=\\frac{s(n-1)}{n^{2}}.\n$$\n因此，\n$$\n\\mathbb{E}\\!\\left[X_{1}(X_{1}-1)\\mid S=s\\right]\n=\\frac{s(n-1)}{n^{2}}+\\left(\\frac{s}{n}\\right)^{2}-\\frac{s}{n}\n=\\frac{s^{2}-s}{n^{2}}\n=\\frac{s(s-1)}{n^{2}}.\n$$\n由于这对每一个 $s$ 都成立，所以作为 $S$ 的函数的改进估计量是\n$$\nT'=\\mathbb{E}[T\\mid S]=\\frac{S(S-1)}{n^{2}}.\n$$\n作为无偏性的检验，注意到 $S\\sim \\operatorname{Poisson}(n\\lambda)$，所以 $\\mathbb{E}[S(S-1)]=(n\\lambda)^{2}$，因此 $\\mathbb{E}[T']=\\lambda^{2}$，这与目标参数 $\\theta$ 一致。", "answer": "$$\\boxed{\\frac{S(S-1)}{n^{2}}}$$", "id": "1922440"}, {"introduction": "在这个实践中，我们将探讨指数分布，这在可靠性工程和生存分析中很常见。我们将从一个仅依赖于最早故障时间的初始估计量开始，然后运用Rao-Blackwell定理，将其改进为基于所有样本信息的估计量。你会发现，这个改进后的估计量竟是我们非常熟悉的形式——样本均值，这揭示了该定理深刻的直观意义 [@problem_id:1922392]。", "problem": "一位质量控制工程师正在研究一种特定电子元件的寿命。任何给定元件的寿命 $X$ 由指数分布建模，其未知平均寿命为 $\\theta$。其概率密度函数为 $f(x; \\theta) = \\frac{1}{\\theta} \\exp(-x/\\theta)$，其中 $x > 0$。\n\n一个由 $n$ 个新元件组成的随机样本，其寿命分别为 $X_1, X_2, \\dots, X_n$，被用于进行寿命测试。为了快速估计平均寿命 $\\theta$，一位工程师提出了一个基于首次失效时间的初始估计量 $W$，首次失效时间用一阶顺序统计量 $X_{(1)} = \\min(X_1, X_2, \\dots, X_n)$ 表示。该具体估计量为 $W = nX_{(1)}$。已知 $W$ 是 $\\theta$ 的一个无偏估计量。\n\n为了获得更精确的估计，还计算了所有元件的总观测寿命 $T = \\sum_{i=1}^n X_i$。您的任务是通过将初始估计量 $W$ 对总寿命 $T$ 取条件，来找到一个改进的 $\\theta$ 的估计量，我们称之为 $W^*$。\n\n请确定改进估计量 $W^* = E[W | T]$ 的表达式。请用 $T$ 和 $n$ 表示您的答案。", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的随机变量，其密度函数为 $f(x;\\theta)=\\frac{1}{\\theta}\\exp(-x/\\theta)$，其中 $x>0$。$(X_{1},\\dots,X_{n})$ 的联合密度函数为\n$$\nf(x_{1},\\dots,x_{n};\\theta)=\\theta^{-n}\\exp\\!\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n}x_{i}\\right),\\quad x_{i}>0.\n$$\n设 $T=\\sum_{i=1}^{n}X_{i}$。在给定 $T=t$ 的条件下，$\\sum x_{i}=t$ 是固定的，并且在单纯形 $\\{x_{i}\\ge 0,\\ \\sum x_{i}=t\\}$ 上的联合密度函数变为常数（因为在给定 $T=t$ 的情况下，因子 $\\exp(-t/\\theta)$ 是一个常数）。因此，在给定 $T=t$ 的条件下，比例向量 $U_{i}=X_{i}/t$ 在单纯形 $\\{u_{i}\\ge 0,\\ \\sum u_{i}=1\\}$ 上是均匀分布的，即 $(U_{1},\\dots,U_{n})\\sim\\text{Dirichlet}(1,\\dots,1)$，并且\n$$\nX_{(1)}=t\\,U_{(1)},\\quad U_{(1)}=\\min(U_{1},\\dots,U_{n}).\n$$\n我们要求解 $W^{*}=E[W\\mid T]=n\\,E[X_{(1)}\\mid T]=n\\,E[X_{(1)}\\mid T=t]$，并在最后用 $T$ 替换 $t$。因此我们需要计算 $E[X_{(1)}\\mid T=t]=t\\,E[U_{(1)}]$。\n\n为了计算均匀单纯形上的 $E[U_{(1)}]$，我们使用生存函数。对于 $u\\in[0,1/n]$，事件 $\\{U_{(1)}>u\\}$ 等价于对所有 $i$ 都有 $U_{i}\\ge u$，在进行变量替换 $V_{i}=U_{i}-u$ 后，这变成了单纯形 $\\{V_{i}\\ge 0,\\ \\sum V_{i}=1-nu\\}$。其体积（因此在均匀分布下的概率）与 $(1-nu)^{n-1}$ 成比例。对于 $u>1/n$，该事件为空事件。因此，\n$$\nP(U_{(1)}>u)=\n\\begin{cases}\n(1-nu)^{n-1}, & 0\\le u\\le \\frac{1}{n},\\\\\n0, & u> \\frac{1}{n}.\n\\end{cases}\n$$\n因此\n$$\nE[U_{(1)}]=\\int_{0}^{1}P(U_{(1)}>u)\\,du=\\int_{0}^{1/n}(1-nu)^{n-1}\\,du.\n$$\n令 $y=1-nu$，则 $du=-\\frac{1}{n}dy$，积分边界从 $u=0\\mapsto y=1$ 和 $u=1/n\\mapsto y=0$ 变为\n$$\nE[U_{(1)}]=\\frac{1}{n}\\int_{0}^{1}y^{n-1}\\,dy=\\frac{1}{n}\\cdot\\frac{1}{n}=\\frac{1}{n^{2}}.\n$$\n所以，\n$$\nE[X_{(1)}\\mid T=t]=t\\cdot\\frac{1}{n^{2}},\\quad\\text{所以}\\quad W^{*}=n\\,E[X_{(1)}\\mid T]=n\\cdot\\frac{T}{n^{2}}=\\frac{T}{n}.\n$$\n因此，改进后的估计量是样本均值 $T/n$。", "answer": "$$\\boxed{\\frac{T}{n}}$$", "id": "1922392"}, {"introduction": "这个练习将挑战你对充分统计量的传统认知。对于一个均匀分布，其参数 $\\theta$ 的充分统计量并非样本总和，而是样本最大值。我们将从一个基于样本最小值的估计量出发，通过对样本最大值取条件，来系统地改进它，从而展示Rao-Blackwell定理在处理非标准充分统计量时的强大能力 [@problem_id:1922455]。", "problem": "设 $X_1, \\dots, X_n$ 是来自区间 $(0, \\theta)$ 上连续均匀分布的大小为 $n > 1$ 的一个随机样本，其中 $\\theta > 0$ 是一个未知参数。该分布的概率密度函数为：当 $0 < x < \\theta$ 时，$f(x) = \\frac{1}{\\theta}$，其他情况下 $f(x)=0$。\n\n令 $X_{(1)} = \\min(X_1, \\dots, X_n)$ 为样本最小值，$X_{(n)} = \\max(X_1, \\dots, X_n)$ 为样本最大值。\n\n$\\theta$ 的一个初始（但非最优）的无偏估计量由 $T = (n+1)X_{(1)}$ 给出。通过利用样本最大值 $X_{(n)}$ 中包含的信息，可以构造一个新的估计量 $T'$，它对于 $\\theta$ 也是无偏的，但具有更小的方差。\n\n求此改进估计量 $T'$ 的表达式。你的答案应为样本大小 $n$ 和样本最大值 $X_{(n)}$ 的函数。", "solution": "我们从来自区间 $(0,\\theta)$ 上均匀分布的样本的联合密度开始：\n$$\nf(x_{1},\\dots,x_{n};\\theta)=\\theta^{-n}\\,\\mathbb{I}\\{0<x_{(1)}<x_{(n)}<\\theta\\},\n$$\n其可分解为 $h(x_{1},\\dots,x_{n})\\,g_{\\theta}(x_{(n)})$，其中 $g_{\\theta}(x_{(n)})=\\theta^{-n}\\,\\mathbb{I}\\{x_{(n)}<\\theta\\}$。根据因子分解定理，$X_{(n)}$ 是 $\\theta$ 的一个充分统计量。\n\n给定任意无偏估计量 $T$，Rao-Blackwell 定理指出 $T'=\\mathbb{E}[T\\mid X_{(n)}]$ 对 $\\theta$ 也是无偏的，并且其方差不大于 $T$ 的方差。此处，$T=(n+1)X_{(1)}$ 是 $\\theta$ 的一个无偏估计量，因此我们设\n$$\nT'=\\mathbb{E}[(n+1)X_{(1)}\\mid X_{(n)}].\n$$\n\n为计算此条件期望，固定 $t\\in(0,\\theta)$ 并以 $X_{(n)}=t$ 为条件。给定 $X_{(n)}=t$，剩下的 $n-1$ 个观测值的行为就像它们是从 $\\text{Uniform}(0,t)$ 中独立同分布地抽取的，而 $X_{(1)}$ 是这 $n-1$ 个值的最小值。因此，$X_{(1)}$ 在给定 $X_{(n)}=t$ 时的条件密度为\n$$\nf_{X_{(1)}\\mid X_{(n)}=t}(y)=\\frac{n-1}{t}\\left(1-\\frac{y}{t}\\right)^{n-2},\\qquad 0<y<t.\n$$\n因此，\n$$\n\\mathbb{E}[X_{(1)}\\mid X_{(n)}=t]\n=\\int_{0}^{t}y\\,\\frac{n-1}{t}\\left(1-\\frac{y}{t}\\right)^{n-2}\\,dy.\n$$\n通过换元 $u=y/t$，$dy=t\\,du$，上式变为\n$$\n\\mathbb{E}[X_{(1)}\\mid X_{(n)}=t]\n=(n-1)t\\int_{0}^{1}u(1-u)^{n-2}\\,du\n=(n-1)t\\,\\mathrm{B}(2,n-1),\n$$\n其中 $\\mathrm{B}(a,b)=\\int_{0}^{1}u^{a-1}(1-u)^{b-1}\\,du=\\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}$。于是，\n$$\n\\mathbb{E}[X_{(1)}\\mid X_{(n)}=t]\n=(n-1)t\\,\\frac{\\Gamma(2)\\Gamma(n-1)}{\\Gamma(n+1)}\n=(n-1)t\\,\\frac{1!\\,(n-2)!}{n!}\n=\\frac{t}{n}.\n$$\n所以，\n$$\nT'=(n+1)\\,\\mathbb{E}[X_{(1)}\\mid X_{(n)}]\n=(n+1)\\,\\frac{X_{(n)}}{n}\n=\\frac{n+1}{n}\\,X_{(n)}.\n$$\n无偏性可以直接验证：$X_{(n)}$ 的密度函数为 $f_{X_{(n)}}(t)=\\frac{n}{\\theta^{n}}t^{n-1}$ (对于 $0<t<\\theta$)，因此\n$$\n\\mathbb{E}[X_{(n)}]=\\int_{0}^{\\theta}t\\,\\frac{n}{\\theta^{n}}t^{n-1}\\,dt=\\frac{n}{n+1}\\,\\theta,\n$$\n从而\n$$\n\\mathbb{E}[T']=\\frac{n+1}{n}\\,\\mathbb{E}[X_{(n)}]=\\frac{n+1}{n}\\cdot\\frac{n}{n+1}\\,\\theta=\\theta.\n$$\n根据 Rao-Blackwell 定理，$\\mathrm{Var}(T')\\le \\mathrm{Var}(T)$，并且 $T'$ 按要求使用了充分统计量 $X_{(n)}$ 中的信息。因此，改进后的估计量是\n$$\nT'=\\frac{n+1}{n}\\,X_{(n)}.\n$$", "answer": "$$\\boxed{\\frac{n+1}{n}\\,X_{(n)}}$$", "id": "1922455"}]}