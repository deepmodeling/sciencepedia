{"hands_on_practices": [{"introduction": "本练习旨在阐释Rao-Blackwell定理的核心机制。我们将从一个非常简单甚至可以说是“浪费”数据的初始估计量 $T = I(X_1=1)$ 出发，通过一个具体的计算过程，来体会该定理如何系统性地改进估计量。通过对这个基于单一观测值的估计量进行Rao-Blackwell化，你将亲手将一个低效的估计量，转化为一个利用了全部样本信息的更优估计量。[@problem_id:1950047]", "problem": "设 $X_1, X_2, \\ldots, X_n$ 是来自几何分布的一个大小为 $n \\ge 2$ 的随机样本，表示为获得一次成功所需的试验次数。其概率质量函数为 $P(X=k) = p(1-p)^{k-1}$，其中 $k=1, 2, 3, \\ldots$，$p \\in (0,1)$ 是单次试验成功的未知概率参数。\n\n提出了一个关于 $p$ 的初始简单估计量，它仅基于第一次观测：$T = I(X_1=1)$，其中 $I(\\cdot)$ 是指示函数（如果事件 $A$ 为真，则 $I(A)=1$；否则为 $0$）。虽然这个估计量对于 $p$ 是无偏的，但它是无效的，因为它丢弃了来自其他 $n-1$ 次观测的信息。\n\n为了构建一个更优的估计量，我们可以将 $T$ 对整个样本中观测到的总试验次数进行条件化，该总次数是充分统计量 $S = \\sum_{i=1}^{n} X_i$。\n\n你的任务是找到改进后的估计量 $T'$，它被定义为 $T$ 在给定 $S$ 下的条件期望。请确定 $T' = E[T | S]$ 的表达式。你的最终答案应该是一个关于 $n$ 和 $S$ 的函数。", "solution": "我们寻求 Rao–Blackwell 化的估计量 $T' = \\mathbb{E}[T \\mid S]$，其中 $T = I(X_{1}=1)$ 且 $S = \\sum_{i=1}^{n} X_{i}$。由于 $T$ 是一个指示函数，$\\mathbb{E}[T \\mid S] = \\mathbb{P}(X_{1}=1 \\mid S)$。\n\n首先，计算联合分布并确定在给定 $S$ 下的条件分布。$(X_{1},\\ldots,X_{n})$ 的联合概率质量函数为\n$$\n\\mathbb{P}(X_{1}=x_{1},\\ldots,X_{n}=x_{n})\n= \\prod_{i=1}^{n} p(1-p)^{x_{i}-1}\n= p^{n} (1-p)^{\\sum_{i=1}^{n} x_{i}-n}\n= p^{n} (1-p)^{S-n}.\n$$\n固定 $S=s$ 且 $s \\geq n$。这表明对于所有和为 $s$ 的正整数 $n$ 元组 $(x_{1},\\ldots,x_{n})$，其联合概率仅取决于 $s$，而与具体的组合方式无关。因此，在 $S=s$ 的条件下，$(X_{1},\\ldots,X_{n})$ 在所有和为 $s$ 的正整数 $n$ 元组集合上服从均匀分布。\n\n这种组合的总数为\n$$\nN_{\\text{total}}(s,n) = \\binom{s-1}{n-1}.\n$$\n在 $S=s$ 的条件下，事件 $\\{X_{1}=1\\}$ 对应于选择余下的 $(n-1)$ 个正整数，使它们的和为 $s-1$，其数量为\n$$\nN_{X_{1}=1}(s,n) = \\binom{s-2}{n-2}.\n$$\n因此，\n$$\n\\mathbb{P}(X_{1}=1 \\mid S=s) = \\frac{N_{X_{1}=1}(s,n)}{N_{\\text{total}}(s,n)} = \\frac{\\binom{s-2}{n-2}}{\\binom{s-1}{n-1}}.\n$$\n化简该比率，\n$$\n\\frac{\\binom{s-2}{n-2}}{\\binom{s-1}{n-1}}\n= \\frac{\\frac{(s-2)!}{(n-2)!(s-n)!}}{\\frac{(s-1)!}{(n-1)!(s-n)!}}\n= \\frac{(s-2)!(n-1)!}{(n-2)!(s-1)!}\n= \\frac{n-1}{s-1}.\n$$\n因此，\n$$\nT' = \\mathbb{E}[I(X_{1}=1) \\mid S] = \\mathbb{P}(X_{1}=1 \\mid S) = \\frac{n-1}{S-1}.\n$$\n此表达式仅依赖于 $n$ 和 $S$，符合要求。", "answer": "$$\\boxed{\\frac{n-1}{S-1}}$$", "id": "1950047"}, {"introduction": "在掌握了Rao-Blackwell化的基本流程后，本练习将向你展示一个更优雅、更强大的技巧——对称性论证。你将发现，利用样本观测值的可交换性，我们可以轻松地计算出条件期望，从而将初始估计量改进为我们非常熟悉的样本均值。这个问题不仅连接了理论与直觉，还为我们通向了估计理论的终极目标之一：一致最小方差无偏估计量(UMVUE)。[@problem_id:1950082]", "problem": "一位软件工程师正在测试一种新的随机算法。算法首次成功所需的尝试次数是一个随机变量 $X$，它服从几何分布，其概率质量函数为 $P(X=k) = (1-p)^{k-1}p$，其中 $k=1, 2, 3, \\ldots$，$p$ 是每次尝试成功的未知概率。该工程师将此实验独立重复 $n$ 次，得到一个随机样本 $X_1, X_2, \\ldots, X_n$。\n\n我们感兴趣的参数是成功一次所需尝试次数的期望值，$\\theta = 1/p$。一个针对 $\\theta$ 的初始、简单的无偏估计量是 $T_0 = X_1$。你的任务是求出 $\\theta$ 的一致最小方差无偏估计量 (UMVUE)。\n\n你的答案需要用样本和 $S = \\sum_{i=1}^n X_i$ 与样本大小 $n$ 来表示。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是独立的 $\\operatorname{Geom}(p)$ 随机变量，其概率质量函数为 $P(X=k)=(1-p)^{k-1}p$，其中 $k=1,2,\\ldots$，并设 $S=\\sum_{i=1}^{n}X_{i}$。联合概率质量函数可分解为\n$$\nP(X_{1}=x_{1},\\ldots,X_{n}=x_{n})\n=\\prod_{i=1}^{n}\\left[(1-p)^{x_{i}-1}p\\right]\n=p^{n}(1-p)^{\\sum_{i=1}^{n}(x_{i}-1)}\n=p^{n}(1-p)^{S-n},\n$$\n此式仅通过 $S$ 依赖于 $p$，因此根据因子分解定理，$S$ 是 $p$ 的充分统计量。\n\n$S$ 的分布是负二项分布，其概率质量函数为\n$$\nP(S=s)=\\binom{s-1}{n-1}p^{n}(1-p)^{s-n},\\quad s=n,n+1,\\ldots\n$$\n为证明完备性，假设函数 $g$ 对所有 $p\\in(0,1)$ 满足 $\\mathbb{E}_{p}[g(S)]=0$。那么\n$$\n\\sum_{s=n}^{\\infty}g(s)\\binom{s-1}{n-1}p^{n}(1-p)^{s-n}=0\\quad\\text{for all }p\\in(0,1).\n$$\n两边同除以 $p^{n}$ 并令 $q=1-p$，得到\n$$\n\\sum_{k=0}^{\\infty}g(n+k)\\binom{n+k-1}{n-1}q^{k}=0\\quad\\text{for all }q\\in(0,1).\n$$\n这是一个关于 $q$ 的幂级数，它在一个区间上恒为零，因此所有系数都必须为零，这意味着对所有 $k$，都有 $g(n+k)\\binom{n+k-1}{n-1}=0$，故对所有 $s$，都有 $g(s)=0$。因此，$S$ 是一个完备充分统计量。\n\n我们感兴趣的参数是 $\\theta=1/p$。由于\n$$\n\\mathbb{E}[X_{1}]=p\\sum_{k=1}^{\\infty}k(1-p)^{k-1}\n=p\\cdot\\frac{1}{\\left(1-(1-p)\\right)^{2}}\n=\\frac{1}{p}=\\theta,\n$$\n估计量 $T_{0}=X_{1}$ 是 $\\theta$ 的无偏估计。根据 Rao–Blackwell 定理，估计量\n$$\nT^{*}=\\mathbb{E}[T_{0}\\mid S]=\\mathbb{E}[X_{1}\\mid S]\n$$\n的方差不大于 $T_{0}$ 的方差，并且是充分统计量 $S$ 的函数。根据在给定 $S=s$ 条件下的可交换性，所有的 $\\mathbb{E}[X_{i}\\mid S=s]$ 都相等，并且\n$$\n\\sum_{i=1}^{n}\\mathbb{E}[X_{i}\\mid S=s]=\\mathbb{E}\\left[\\sum_{i=1}^{n}X_{i}\\mid S=s\\right]=s,\n$$\n所以 $\\mathbb{E}[X_{1}\\mid S=s]=s/n$。因此，\n$$\nT^{*}=\\frac{S}{n}.\n$$\n由于 $S$ 是完备充分统计量，根据 Lehmann–Scheffé 定理，$T^{*}=S/n$ 是 $\\theta$ 的 UMVUE。\n\n最后，注意 $\\mathbb{E}[S/n]=\\mathbb{E}[X_{1}]=1/p=\\theta$，这证实了其无偏性。", "answer": "$$\\boxed{\\frac{S}{n}}$$", "id": "1950082"}, {"introduction": "此练习将Rao-Blackwell定理的应用从离散分布扩展到连续分布，展示了其普适性。在一个关于均匀分布的假设性场景中，我们将处理一种新的情况：充分统计量不再是样本和，而是样本最大值 $M_{(n)}$。这个练习的核心在于掌握处理连续型随机变量和次序统计量的条件期望技巧，并理解Rao-Blackwell定理的普适性，而非场景本身的真实性。[@problem_id:1950098]", "problem": "在一个简化的宇宙学模型中，一个新形成的微晕的质量 $M$ 被假设为一个随机变量，服从区间 $(0, \\Theta)$ 上的均匀分布，其中 $\\Theta > 0$ 是一个未知的宇宙学参数，表示在给定空间区域内此类晕的最大可能质量。一组天体物理学家收集了 $n$ 个此类微晕质量的随机样本，记为 $M_1, M_2, \\ldots, M_n$。\n\n一位初级研究员建议使用样本极差 $R = M_{(n)} - M_{(1)}$ 作为与参数 $\\Theta$ 相关的一个简单统计量。这里，$M_{(1)}$ 和 $M_{(n)}$ 分别是样本中观测到的最小和最大质量。虽然 $R$ 是一个有效的统计量，但它并不是最优的，因为它没有利用 $\\Theta$ 的完备充分统计量所包含的全部信息。\n\n根据 Rao-Blackwell 定理，可以通过将初始估计量以充分统计量为条件来构造一个改进的估计量。你的任务是应用此原理来改进样本极差 $R$。通过计算在给定 $\\Theta$ 的完备充分统计量的条件下 $R$ 的条件期望，来推导该改进的估计量。将你的最终答案表示为关于 $M_{(n)}$ 和样本大小 $n$ 的解析表达式。", "solution": "设 $M_{1},\\ldots,M_{n}$ 是独立同分布于 $\\mathrm{Unif}(0,\\Theta)$。最大顺序统计量 $M_{(n)}$ 是 $\\Theta$ 的一个完备充分统计量（其分布仅通过尺度依赖于 $\\Theta$，且 $M_{(n)}/\\Theta$ 服从 $\\mathrm{Beta}(n,1)$ 分布，这保证了完备性）。根据 Rao-Blackwell 定理，将初始估计量 $R=M_{(n)}-M_{(1)}$ 以 $M_{(n)}$ 为条件可得到一个改进的估计量：\n$$\n\\delta^{*}(M_{(n)})=\\mathbb{E}[R \\mid M_{(n)}]=\\mathbb{E}[M_{(n)}-M_{(1)} \\mid M_{(n)}].\n$$\n将 $M_{(n)}$ 的一个实现值记为 $t$。给定 $M_{(n)}=t$，其余的 $n-1$ 个观测值独立同分布于 $\\mathrm{Unif}(0,t)$。设 $V_{(1)}$ 表示这 $n-1$ 个独立同分布于 $\\mathrm{Unif}(0,t)$ 的变量中的最小值。那么\n$$\n\\mathbb{E}[R \\mid M_{(n)}=t]=t-\\mathbb{E}[V_{(1)}].\n$$\n为了计算 $\\mathbb{E}[V_{(1)}]$，设 $U_{1},\\ldots,U_{m}$ 独立同分布于 $\\mathrm{Unif}(0,1)$，其中 $m=n-1$，且 $U_{(1)}=\\min(U_{1},\\ldots,U_{m})$。$U_{(1)}$ 的密度为 $f_{U_{(1)}}(u)=m(1-u)^{m-1}$，其中 $0<u<1$。因此\n$$\n\\mathbb{E}[U_{(1)}]=\\int_{0}^{1}u\\,m(1-u)^{m-1}\\,du\n= m\\,\\mathrm{B}(2,m)\n= m\\,\\frac{\\Gamma(2)\\Gamma(m)}{\\Gamma(m+2)}\n= \\frac{1}{m+1}.\n$$\n通过尺度变换，$V_{(1)}\\stackrel{d}{=}t\\,U_{(1)}$，所以 $\\mathbb{E}[V_{(1)}]=t\\,\\mathbb{E}[U_{(1)}]=t\\cdot\\frac{1}{m+1}=t\\cdot\\frac{1}{n}$。所以，\n$$\n\\mathbb{E}[R \\mid M_{(n)}=t]=t-\\frac{t}{n}=t\\cdot\\frac{n-1}{n}.\n$$\n将 $t$ 替换为 $M_{(n)}$ 得到经过 Rao-Blackwell 化的估计量\n$$\n\\delta^{*}(M_{(n)})=\\frac{n-1}{n}\\,M_{(n)}.\n$$\n这是完备充分统计量 $M_{(n)}$ 的函数，因此是所求的改进估计量。", "answer": "$$\\boxed{\\frac{n-1}{n}\\,M_{(n)}}$$", "id": "1950098"}]}