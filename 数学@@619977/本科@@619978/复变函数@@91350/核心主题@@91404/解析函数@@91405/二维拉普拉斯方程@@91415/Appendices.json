{"hands_on_practices": [{"introduction": "调和函数在物理学中很少单独出现；它们通常成对存在，其中一个代表势函数（如静电势），另一个代表流函数（如电场线）。这两个函数通过柯西-黎曼方程联系在一起，互为调和共轭。这个练习将让你亲身实践如何根据给定的一个调和函数 $u(x,y)$，通过求解柯西-黎曼方程来找到它的“伴侣”函数 $v(x,y)$，从而加深对这些基本关系的理解 [@problem_id:2249510]。", "problem": "在一个简化的二维信息流模型中，任意点 $(x,y)$ 处的“信息势” $u(x,y)$ 是一个调和函数，即它满足拉普拉斯方程 $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$。该势描述了信息传播的趋势。\n\n与每个信息势 $u(x,y)$ 相关联的是一个“信息流函数” $v(x,y)$，它描述了信息通量的路径。势函数和流函数由以下偏微分方程组联系：\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial u}{\\partial x}\n$$\n$$\n\\frac{\\partial v}{\\partial x} = -\\frac{\\partial u}{\\partial y}\n$$\n考虑一个具体情况，其中信息势由一个简单的线性函数给出：\n$$\nu(x,y) = ax + by\n$$\n其中 $a$ 和 $b$ 是任意实常数。\n\n确定与该势相对应的信息流函数 $v(x,y)$ 的最一般形式。你的答案应该是一个用 $x$、$y$、常数 $a$ 和 $b$ 以及一个应表示为 $C$ 的任意积分常数所构成的表达式。", "solution": "我们已知关系式\n$$\n\\frac{\\partial v}{\\partial y}=\\frac{\\partial u}{\\partial x}, \\qquad \\frac{\\partial v}{\\partial x}=-\\frac{\\partial u}{\\partial y},\n$$\n以及势函数\n$$\nu(x,y)=a x + b y,\n$$\n其中 $a$ 和 $b$ 是常数。计算 $u$ 所需的偏导数：\n$$\n\\frac{\\partial u}{\\partial x}=a, \\qquad \\frac{\\partial u}{\\partial y}=b.\n$$\n代入给定的方程组得到\n$$\n\\frac{\\partial v}{\\partial y}=a, \\qquad \\frac{\\partial v}{\\partial x}=-b.\n$$\n对第一个方程关于 $y$ 积分：\n$$\nv(x,y)=a y + f(x),\n$$\n其中 $f$ 是 $x$ 的任意函数。将此表达式对 $x$ 求导，并使用第二个方程：\n$$\n\\frac{\\partial v}{\\partial x}=f'(x)=-b \\quad \\Rightarrow \\quad f(x)=-b x + C,\n$$\n其中 $C$ 是一个积分常数。因此，\n$$\nv(x,y)=a y - b x + C.\n$$\n直接检验表明 $\\frac{\\partial v}{\\partial y}=a=\\frac{\\partial u}{\\partial x}$ 且 $\\frac{\\partial v}{\\partial x}=-b=-\\frac{\\partial u}{\\partial y}$，因此这是与给定势函数相对应的最一般的流函数。", "answer": "$$\\boxed{a y - b x + C}$$", "id": "2249510"}, {"introduction": "调和函数的一个核心性质是极值原理，它指出非恒定的调和函数其最大值和最小值必然出现在定义域的边界上。这一原理在物理和工程问题中极为有用，因为它将寻找极值点的范围从整个区域缩小到了其边界。本练习将指导你应用该原理，在一个单位圆盘上寻找一个具体势函数 $\\Phi(x, y)$ 的最大值和最小值，让你体验理论在解决实际问题中的威力 [@problem_id:2249485]。", "problem": "在物理学中，解析复函数的实部通常表示一个标量势，例如静电势或温度分布。这类函数是调和的，意味着它们在复函数是解析的区域内满足拉普拉斯方程。\n\n考虑一个定义在闭单位圆盘 $D = \\{z \\in \\mathbb{C} : |z| \\leq 1\\}$ 上的调和势函数 $\\Phi(x, y)$，其中 $z=x+iy$。该势由 $\\Phi(x, y) = \\text{Re}(F(z))$ 给出，其中复函数为 $F(z) = (z-a)^2$。常数 $a$ 是一个实数，其值为 $a=1/2$。\n\n你的任务是找出圆盘 $D$ 上势函数 $\\Phi(x,y)$ 达到其绝对最大值和绝对最小值的点。以下哪个选项正确地指出了最大值位置（记为 $z_{max}$）和最小值位置（记为 $z_{min}$）？\n\nA. $z_{max} = 1$; $z_{min} = -1$.\n\nB. $z_{max} = -1$; $z_{min}$ 是集合 $\\{ \\frac{1}{4} + i\\frac{\\sqrt{15}}{4}, \\frac{1}{4} - i\\frac{\\sqrt{15}}{4} \\}$ 中的两个点。\n\nC. $z_{max}$ 是集合 $\\{1, -1\\}$ 中的两个点; $z_{min}$ 是集合 $\\{i, -i\\}$ 中的两个点。\n\nD. $z_{max} = 1/2$; $z_{min} = -1$.\n\nE. $z_{max} = 1$; $z_{min}$ 是集合 $\\{ \\frac{1}{2} + i\\frac{\\sqrt{3}}{2}, \\frac{1}{2} - i\\frac{\\sqrt{3}}{2} \\}$ 中的两个点。", "solution": "我们已知在闭单位圆盘 $D=\\{z\\in\\mathbb{C}:|z|\\leq 1\\}$ 上，有 $F(z)=(z-a)^{2}$，其中 $a=\\frac{1}{2}$ 为实数，且 $\\Phi(x,y)=\\operatorname{Re}(F(z))$。由于 $F$ 在 $D$ 的一个邻域上是解析的，因此 $\\Phi$ 在 $D$ 上是调和的。根据调和函数的最大/最小值原理，一个非常数的调和函数在其边界 $|z|=1$ 上达到其绝对最大值和最小值。\n\n记 $z=x+iy$，并设 $u=x-\\frac{1}{2}$，$v=y$。那么\n$$\nF(z)=(u+iv)^{2}=u^{2}-v^{2}+2iuv,\n$$\n所以\n$$\n\\Phi(x,y)=\\operatorname{Re}(F(z))=u^{2}-v^{2}=(x-\\tfrac{1}{2})^{2}-y^{2}.\n$$\n在边界 $x^{2}+y^{2}=1$ 上，令 $x=\\cos\\theta$，$y=\\sin\\theta$。则\n$$\n\\Phi(\\theta)=(\\cos\\theta-\\tfrac{1}{2})^{2}-\\sin^{2}\\theta=\\cos^{2}\\theta-\\cos\\theta+\\tfrac{1}{4}-(1-\\cos^{2}\\theta)=2\\cos^{2}\\theta-\\cos\\theta-\\tfrac{3}{4}.\n$$\n令 $u=\\cos\\theta\\in[-1,1]$。则\n$$\n\\Phi(u)=2u^{2}-u-\\tfrac{3}{4}.\n$$\n这是一个关于 $u$ 的二次函数，其首项系数为正，因此它在 $[-1,1]$ 上的最小值出现在顶点 $u=\\frac{1}{4}$ 处，而其在 $[-1,1]$ 上的最大值出现在某个端点处。计算其值：\n$$\n\\Phi\\!\\left(\\tfrac{1}{4}\\right)=2\\cdot\\tfrac{1}{16}-\\tfrac{1}{4}-\\tfrac{3}{4}=\\tfrac{1}{8}-1=-\\tfrac{7}{8},\n$$\n$$\n\\Phi(-1)=2\\cdot 1-(-1)-\\tfrac{3}{4}=\\tfrac{9}{4},\\quad \\Phi(1)=2\\cdot 1-1-\\tfrac{3}{4}=\\tfrac{1}{4}.\n$$\n因此，绝对最大值出现在 $u=-1$ 处，即 $x=\\cos\\theta=-1$，$y=0$，所以 $z_{\\max}=-1$。绝对最小值点出现在 $u=\\cos\\theta=\\frac{1}{4}$ 的位置，这给出 $x=\\frac{1}{4}$ 和 $y=\\pm\\sqrt{1-\\frac{1}{16}}=\\pm\\frac{\\sqrt{15}}{4}$，即 $z_{\\min}\\in\\left\\{\\frac{1}{4}\\pm i\\frac{\\sqrt{15}}{4}\\right\\}$。\n\n这些位置与选项 B 相符。", "answer": "$$\\boxed{B}$$", "id": "2249485"}, {"introduction": "除了极值原理，平均值性质是调和函数的另一个优美而深刻的特征，它表明在某点的值等于其周围任何一个圆上的函数值的平均。这个练习将引导你通过编写程序来数值验证这一性质，从而在理论与计算实践之间架起一座桥梁。通过比较调和函数与非调和函数的行为，你将对拉普拉斯方程解的独特性质有更直观和具体的认识 [@problem_id:2406764]。", "problem": "您将设计并实现一个程序，以数值方式验证与二维拉普拉斯方程解相关的中值性质。本任务的基础是调和函数的定义——一个满足二维拉普拉斯方程 $\\Delta u = u_{xx} + u_{yy} = 0$ 的足够光滑的函数 $u(x,y)$——以及在平面上沿圆周对函数求平均值的经典概念。请完全使用纯数学术语进行操作。所有角度必须以弧度为单位。\n\n您的任务如下：\n-对每个测试用例，考虑一个定义在 $\\mathbb{R}^2$ 子集上的函数 $u(x,y)$、一个中心点 $(x_0,y_0)$、一个半径 $r \\ge 0$ 和一个正整数 $M$。\n- 通过 $\\theta \\in [0,2\\pi)$ 定义圆的参数化，将以 $(x_0,y_0)$ 为中心、半径为 $r$ 的圆定义为 $(x(\\theta),y(\\theta)) = (x_0 + r\\cos\\theta, y_0 + r\\sin\\theta)$。\n- 将 $u$ 沿圆的角度平均值定义为在 $\\theta \\in [0,2\\pi)$ 上的积分平均值。使用 $M$ 个等间距样本 $\\theta_j = \\frac{2\\pi j}{M}$（其中 $j=0,1,\\dots,M-1$）来数值近似此角度平均值。使用简单的等间距样本均值作为角度平均值的数值近似。当 $r = 0$ 时，将该圆解释为单点 $(x_0,y_0)$，其平均值取为 $u(x_0,y_0)$。\n- 对每个测试用例，计算中心点函数值与圆上数值角度平均值之间的绝对差，即计算 $\\left|u(x_0,y_0) - \\overline{u}\\right|$，其中 $\\overline{u}$ 是上述的数值平均值。\n\n实现以下包含6个情况的测试套件，这些情况共同检验了典型行为、边界情况以及与非调和函数的对比。在所有情况下，角度均以弧度为单位：\n- 情况1（2次调和多项式）：$u(x,y) = x^2 - y^2$，其中 $(x_0,y_0) = (0.1,-0.2)$，$r = 0.4$，$M = 4096$。\n- 情况2（3次调和多项式）：$u(x,y) = x^3 - 3xy^2$，其中 $(x_0,y_0) = (-0.3,0.25)$，$r = 0.2$，$M = 4096$。\n- 情况3（调和但非多项式；仅在原点奇异）：$u(x,y) = \\log\\!\\big(\\sqrt{x^2 + y^2}\\big)$，其中 $(x_0,y_0) = (0.5,0.4)$，$r = 0.3$，$M = 8192$。在此情况下，整个圆与原点的距离严格大于0。\n- 情况4（非调和对照）：$u(x,y) = x^2 + y^2$，其中 $(x_0,y_0) = (0.1,0.2)$，$r = 0.4$，$M = 4096$。\n- 情况5（退化半径）：$u(x,y) = x^2 - y^2$，其中 $(x_0,y_0) = (-0.75,0.6)$，$r = 0.0$，$M = 16$。\n- 情况6（对非多项式调和函数的粗略采样）：$u(x,y) = \\log\\!\\big(\\sqrt{x^2 + y^2}\\big)$，其中 $(x_0,y_0) = (0.5,0.4)$，$r = 0.3$，$M = 32$。\n\n您的程序必须：\n- 实现上述数值程序，以 $M$ 个样本的离散均值来近似角度平均值。\n- 对每种情况，计算并收集浮点数形式的绝对差 $\\left|u(x_0,y_0) - \\overline{u}\\right|$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况1到6的顺序排列结果，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$，其中每个 $r_k$ 是情况 $k$ 的浮点数绝对差。", "solution": "所述问题是成立、自洽且科学上可靠的。它提出了计算物理学中的一个标准任务：对一个基本数学定理进行数值验证。我们将着手推导解决方案。\n\n这个问题的核心在于调和函数的中值性质。如果一个双实变函数 $u(x,y)$ 在域 $\\Omega \\subseteq \\mathbb{R}^2$ 上属于 $C^2$ 类，并且在整个 $\\Omega$ 上满足二维拉普拉斯方程，则称其为该域上的调和函数：\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\n调和函数的中值定理是位势论中的一个核心结果。该定理指出，如果 $u$ 是域 $\\Omega$ 上的一个调和函数，那么对于 $\\Omega$ 中的任意点 $(x_0, y_0)$ 以及任何以 $(x_0, y_0)$ 为中心且完全包含在 $\\Omega$ 内的圆盘 $D$，函数在圆盘中心的值等于其在该圆盘边界圆上的值的平均值。\n\n设圆由 $C_r$ 表示，其中心为 $(x_0, y_0)$，半径为 $r > 0$。我们可以使用角度 $\\theta \\in [0, 2\\pi)$ 将此圆参数化为 $(x(\\theta), y(\\theta)) = (x_0 + r\\cos\\theta, y_0 + r\\sin\\theta)$。该定理表述为：\n$$\nu(x_0, y_0) = \\frac{1}{2\\pi r} \\oint_{C_r} u(x,y) \\, ds = \\frac{1}{2\\pi} \\int_0^{2\\pi} u(x_0 + r\\cos\\theta, y_0 + r\\sin\\theta) \\, d\\theta\n$$\n其中 $ds$ 是弧长元。问题要求我们数值验证此性质。\n\n指定的数值程序是用离散样本均值来近似连续积分平均值。我们将角度 $\\theta$ 离散化为 $M$ 个等间距的点：\n$$\n\\theta_j = \\frac{2\\pi j}{M}, \\quad \\text{for } j = 0, 1, \\dots, M-1\n$$\n圆上的对应点为 $(x_j, y_j) = (x_0 + r\\cos\\theta_j, y_0 + r\\sin\\theta_j)$。平均值的数值近似（我们记为 $\\overline{u}$）就是这些点上函数值的算术平均值：\n$$\n\\overline{u} = \\frac{1}{M} \\sum_{j=0}^{M-1} u(x_j, y_j)\n$$\n这是一种标准的数值积分技术，对于一个周期函数在其周期上的积分，它等价于矩形法则或梯形法则。\n\n目标是为几个测试用例计算绝对差 $\\left|u(x_0, y_0) - \\overline{u}\\right|$。对于半径 $r=0$ 的特殊情况，圆退化为点 $(x_0, y_0)$。问题正确地指明，在这种情况下，平均值就是 $u(x_0, y_0)$，因此绝对差恰好为 $0$。\n\n我们将基于这些原则分析测试用例：\n\n-   情况1、2、3和6涉及的函数在包含积分圆的域上是调和的。\n    -   在情况1中，$u(x,y) = x^2 - y^2$。我们验证其调和性：$u_{xx} = 2$，$u_{yy} = -2$，所以 $\\Delta u = 2-2=0$。\n    -   在情况2中，$u(x,y) = x^3 - 3xy^2$。我们验证：$u_{xx} = 6x$，$u_{yy} = -6x$，所以 $\\Delta u = 6x-6x=0$。\n    -   情况3和6使用 $u(x,y) = \\log\\sqrt{x^2+y^2} = \\frac{1}{2}\\log(x^2+y^2)$。此函数除了原点(0,0)外处处调和。对于给定的参数 $(x_0,y_0)=(0.5,0.4)$ 和 $r=0.3$，中心点到原点的距离是 $\\sqrt{0.5^2+0.4^2} = \\sqrt{0.41} \\approx 0.64$。由于 $r < \\sqrt{0.41}$，该圆不包含位于(0,0)的奇点，因此函数在圆上及圆内是调和的。\n    -   对于这些调和情况，理论上的差值为0。因此，计算量 $\\left|u(x_0, y_0) - \\overline{u}\\right|$ 是离散近似的数值误差的度量。对于 $\\sin\\theta$ 和 $\\cos\\theta$ 的多项式函数，梯形法则极其精确，因此对于具有大 $M$ 值的用例1和2，误差应接近机器精度。对于 $M=8192$ 的情况3，误差应该很小。对于 $M$ 值小得多（$M=32$）的情况6，预计数值误差将显著大于情况3。\n\n-   情况4提供了一个与非调和函数的对比，$u(x,y) = x^2 + y^2$。此处 $\\Delta u = 2+2=4 \\neq 0$。中值定理不适用。精确的积分平均值为 $u(x_0,y_0)+r^2$。理论差值为 $\\left|u(x_0,y_0) - (u(x_0,y_0)+r^2)\\right| = r^2$。对于 $r=0.4$ 来说，这个值是 $0.16$。数值结果应非常接近此值，因为对于该被积函数，数值积分是精确的。\n\n-   情况5是一个 $r=0$ 的退化情况。按照规定，$\\overline{u} = u(x_0, y_0)$，因此差值 $\\left|u(x_0, y_0) - \\overline{u}\\right|$ 恰好为0。\n\n实现将包含一个主函数，该函数遍历所提供的测试用例。对每个用例，它将计算 $u(x_0, y_0)$ 的值，并根据离散求和公式计算 $\\overline{u}$。然后计算并存储绝对差。一个特殊条件按定义处理 $r=0$ 的情况。最后，收集结果并将其格式化为所需的输出字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically verifying the mean value property for\n    harmonic functions.\n    \"\"\"\n\n    # Define the functions for each test case.\n    # Note: Using np.sqrt and np.log for vectorized operations.\n    u1 = lambda x, y: x**2 - y**2\n    u2 = lambda x, y: x**3 - 3*x*y**2\n    u3 = lambda x, y: np.log(np.sqrt(x**2 + y**2))\n    u4 = lambda x, y: x**2 + y**2\n    # Case 5 uses the same function as Case 1.\n    u5 = u1\n    # Case 6 uses the same function as Case 3.\n    u6 = u3\n\n    test_cases = [\n        # (function, (x0, y0), r, M)\n        {'u': u1, 'center': (0.1, -0.2), 'r': 0.4, 'M': 4096},\n        {'u': u2, 'center': (-0.3, 0.25), 'r': 0.2, 'M': 4096},\n        {'u': u3, 'center': (0.5, 0.4), 'r': 0.3, 'M': 8192},\n        {'u': u4, 'center': (0.1, 0.2), 'r': 0.4, 'M': 4096},\n        {'u': u5, 'center': (-0.75, 0.6), 'r': 0.0, 'M': 16},\n        {'u': u6, 'center': (0.5, 0.4), 'r': 0.3, 'M': 32},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        u_func = case['u']\n        x0, y0 = case['center']\n        r = case['r']\n        M = case['M']\n\n        # Calculate the function value at the center.\n        u_at_center = u_func(x0, y0)\n\n        # Calculate the numerical average on the circle.\n        if r == 0.0:\n            # Per problem definition, the average is the function value at the center.\n            u_average = u_at_center\n        else:\n            # Generate M equispaced angles from 0 to 2*pi (exclusive of 2*pi).\n            # theta_j = 2*pi*j/M for j=0, ..., M-1.\n            thetas = np.linspace(0, 2 * np.pi, M, endpoint=False)\n            \n            # Parametrize the circle points.\n            x_coords = x0 + r * np.cos(thetas)\n            y_coords = y0 + r * np.sin(thetas)\n            \n            # Evaluate the function at all points on the circle.\n            u_values_on_circle = u_func(x_coords, y_coords)\n            \n            # Compute the sample mean.\n            u_average = np.mean(u_values_on_circle)\n\n        # Compute the absolute difference.\n        abs_diff = np.abs(u_at_center - u_average)\n        results.append(abs_diff)\n    \n    # Format the output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2406764"}]}