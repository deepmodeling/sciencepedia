{"hands_on_practices": [{"introduction": "林德斯特伦定理通过元逻辑属性来刻画一阶逻辑（FOL）。其中一个基本的属性是相对化封闭性，它允许我们在一个结构的可定义部分上“放大”，并仍然使用相同的逻辑来讨论其属性。这个练习 [@problem_id:2976150] 旨在探讨这一强大特性的工作机制，这对于理解一阶逻辑的稳健性至关重要。", "problem": "设 $\\sigma$ 是一个关系词汇，$\\mathcal{L}$ 是一个定义在 $\\sigma$-结构上的逻辑，它在布尔连接词下以及对新的一元谓词符号的相对化下是封闭的。回顾以下模型论中的基本定义和事实，你可以将其视为已知：(i) 给定一个论域为 $M$ 的 $\\sigma$-结构 $\\mathfrak{M}$ 和一个子集 $S \\subseteq M$，诱导 $\\sigma$-子结构 $\\mathfrak{M} \\upharpoonright S$ 是一个以 $S$ 为论域的结构，其中每个关系符号 $R \\in \\sigma$ 被解释为 $R^{\\mathfrak{M}}$ 在 $S$ 的元组上的限制；(ii) 如果存在一个带有一个自由变量的公式 $\\delta(x) \\in \\mathcal{L}$，使得 $S = \\{ a \\in M : \\mathfrak{M} \\models \\delta(a) \\}$，则子集 $S \\subseteq M$ 是可定义的；(iii) 对于任意不在 $\\sigma$ 中的新的一元谓词符号 $U$，一个解释 $(\\mathfrak{M}, U)$ 是一个 $\\sigma \\cup \\{U\\}$-结构，它通过选择一个 $U^{\\mathfrak{M}} \\subseteq M$ 来扩展 $\\mathfrak{M}$。\n\n选择一个选项，该选项正确地解释了 $\\mathcal{L}$ 中相对化的封闭性如何实现可定义性从整个结构到可定义子结构的转移，并提供了一个使用一元谓词符号 $U$ 的正确具体示例。\n\nA. 如果 $\\mathcal{L}$ 在相对化下封闭，那么对于每个 $\\sigma$-公式 $\\varphi(\\bar{x}) \\in \\mathcal{L}$，都存在一个 $\\sigma \\cup \\{U\\}$-公式 $\\varphi^{U}(\\bar{x}) \\in \\mathcal{L}$，使得对于每个 $\\sigma$-结构 $\\mathfrak{M}$，每个 $S \\subseteq M$，以及每个赋值 $\\bar{a} \\in S^{|\\bar{x}|}$，都有\n$$\n\\mathfrak{M} \\upharpoonright S \\models \\varphi(\\bar{a}) \\quad \\text{iff} \\quad (\\mathfrak{M}, U^{\\mathfrak{M}} := S) \\models \\varphi^{U}(\\bar{a}).\n$$\n映射 $\\varphi \\mapsto \\varphi^{U}$ 是通过将量词限制到 $U$ 来给出的：原子公式和布尔组合保持不变，$(\\exists y\\, \\psi)^{U} := \\exists y\\,(U(y) \\wedge \\psi^{U})$ 以及 $(\\forall y\\, \\psi)^{U} := \\forall y\\,(U(y) \\rightarrow \\psi^{U})$。因此，如果 $S$ 可由一个 $\\sigma$-公式 $\\delta(x)$ 定义，那么由 $\\varphi$ 定义的 $\\mathfrak{M} \\upharpoonright S$ 的性质，在 $\\mathfrak{M}$ 中是由通过将 $\\varphi^{U}$ 中的 $U$ 替换为 $\\delta$ 所得到的 $\\sigma$-公式定义的。具体示例：在由一元谓词 $R$ 扩展的图语言 $\\sigma = \\{E\\}$ 中，令 $\\delta(x) := R(x)$，因此 $S = \\{a \\in M : R(a)\\}$。对于表示“存在一个三角形”的公式 $\\varphi$，例如，\n$$\n\\varphi := \\exists x \\exists y \\exists z \\Big( x \\neq y \\wedge y \\neq z \\wedge z \\neq x \\wedge E(x,y) \\wedge E(y,z) \\wedge E(z,x) \\Big),\n$$\n相对化 $\\varphi^{U}$ 是通过在所有量词中插入 $U$-守卫得到的。用 $R$ 替换 $U$ 会产生一个 $\\sigma \\cup \\{R\\}$-公式，该公式在任何 $(\\mathfrak{M},R)$ 中成立，当且仅当在 $R$-顶点上的诱导子图包含一个三角形。\n\nB. 相对化的封闭性要求为每个关系 $R \\in \\sigma$ 引入一个新的关系符号 $R_{U}$ 来表示其在 $U$ 上的限制，并且只有在这样的扩展之后，才能表达诱导子结构的性质；如果不通过所有 $R_{U}$ 来扩展符号集，即使对于简单的存在公式，可定义性的转移也会失败。\n\nC. 对一元谓词 $U$ 的相对化在一阶逻辑中是不可用的；要谈论一个可定义的子结构，必须对 $U$ 进行二阶量化，因此相对化的封闭性是一个严格的二阶性质，不能用于在一阶上下文中转移可定义性。\n\nD. 相对化的封闭性只确保全称语句在子结构下（通过限制论域）被保持，但存在性内容会丢失；因此，可定义性只对 $\\forall$-语句转移，并且对于任意公式没有通用的相对化方案。\n\nE. 正确的相对化方法是保持 $\\exists$-量词不变，仅将 $\\forall y\\, \\psi$ 替换为 $\\forall y\\,(U(y) \\rightarrow \\psi)$，同时将每个原子公式 $R(t_{1},\\dots,t_{n})$ 重写为 $U(t_{1}) \\wedge \\cdots \\wedge U(t_{n}) \\wedge R(t_{1},\\dots,t_{n})$；这确保了 $U$ 之外的赋值被排除，并且是向可定义子结构转移可定义性的充分必要条件。", "solution": "问题的核心是逻辑中“相对化封闭性”的概念。该性质断言，对于任何公式 $\\varphi$，都存在一个相对化后的公式 $\\varphi^U$，使得 $\\varphi$ 在子结构 $\\mathfrak{M} \\upharpoonright S$ 中为真，当且仅当 $\\varphi^U$ 在以 $S$ 解释 $U$ 的扩展结构 $(\\mathfrak{M}, U)$ 中为真。\n\n选项A正确地描述了这一过程。标准的相对化方法如下：\n1.  原子公式和布尔组合保持不变。\n2.  量词被限制在由一元谓词 $U$ 定义的论域内。具体来说，$(\\exists y\\, \\psi)^{U}$ 变为 $\\exists y\\,(U(y) \\wedge \\psi^{U})$，而 $(\\forall y\\, \\psi)^{U}$ 变为 $\\forall y\\,(U(y) \\rightarrow \\psi^{U})$。\n如果子集 $S$ 本身是由一个 $\\sigma$-公式 $\\delta(x)$ 定义的，那么我们可以在 $\\varphi^U$ 中用 $\\delta(t)$ 替换所有出现的 $U(t)$，从而得到一个在原始词汇表 $\\sigma$ 中的新公式，它在 $\\mathfrak{M}$ 中捕捉了 $\\varphi$ 在子结构 $\\mathfrak{M} \\upharpoonright S$ 中的性质。选项A提供的例子——检查诱导子图中的三角形——完美地说明了这一点。因此，选项A是正确的。\n\n其他选项均存在错误：\n-   选项B错误地声称需要为每个关系符号引入新的相对化符号 $R_U$。标准的相对化过程通过限制量词来处理，不需要改变关系符号。\n-   选项C错误地断言相对化在一阶逻辑中不可用或需要二阶量化。事实上，相对化是一阶逻辑模型论中的一个基本句法工具。\n-   选项D将相对化与子结构下的保持性定理（如Łoś-Tarski定理）相混淆，并错误地声称存在性内容会丢失。\n-   选项E提出了一个不正确的相对化方案，它错误地修改了原子公式并保持存在量词不变，这会导致在处理否定等情况时得出错误的逻辑结论。", "answer": "$$\\boxed{A}$$", "id": "2976150"}, {"introduction": "紧致性定理与 Löwenheim-Skolem 性质是林德斯特伦定理中定义一阶逻辑独特性质的两个关键支柱。证明一阶逻辑的紧致性需要一个模型论中的精密工具：超积。这个练习 [@problem_id:2976157] 深入探讨了超积构造及与之相关的 Łoś 定理，揭示了驱动一阶逻辑最重要特性之一的代数引擎。", "problem": "在一阶逻辑 (FO) 的语境下，选择一个能正确并精确地完成以下所有任务的选项：使用一个超滤子定义一族结构的超积，陈述适用于 FO 公式（而不仅是句子）的 Łoś 定理，并以适用于 Lindström 定理的水平解释为什么 Łoś 定理能支持 FO 的紧致性定理。\n\nA. 给定一族 $\\mathcal{L}$-结构 $\\{\\mathcal{M}_i : i \\in I\\}$ 和 $I$ 上的一个超滤子 $\\mathcal{U}$，其超积 $\\prod_{i \\in I} \\mathcal{M}_i / \\mathcal{U}$ 的论域是由函数 $a : I \\to \\bigsqcup_{i \\in I} M_i$ (其中 $a(i) \\in M_i$) 的 $\\mathcal{U}$-等价类组成的集合，其中 $a \\sim b$ 当且仅当 $\\{ i \\in I : a(i) = b(i) \\} \\in \\mathcal{U}$。对于每个元数为 $n$ 的函数符号 $f$，定义 $f^{\\prod/\\mathcal{U}}([a_1],\\dots,[a_n]) = [i \\mapsto f^{\\mathcal{M}_i}(a_1(i),\\dots,a_n(i))]$。对于每个元数为 $n$ 的关系符号 $R$，规定 $R^{\\prod/\\mathcal{U}}([a_1],\\dots,[a_n])$ 成立当且仅当 $\\{ i \\in I : R^{\\mathcal{M}_i}(a_1(i),\\dots,a_n(i)) \\} \\in \\mathcal{U}$。Łoś 定理：对于任意 FO 公式 $\\varphi(x_1,\\dots,x_n)$ 和超积中的元素 $[a_1],\\dots,[a_n]$，$$\\prod_{i \\in I} \\mathcal{M}_i / \\mathcal{U} \\models \\varphi([a_1],\\dots,[a_n]) \\quad \\text{当且仅当} \\quad \\{ i \\in I : \\mathcal{M}_i \\models \\varphi(a_1(i),\\dots,a_n(i)) \\} \\in \\mathcal{U}。$$ 这支持了紧致性定理：给定一个 FO 句子集 $\\Gamma$，其任意有限子集都是可满足的，用 $I$ 来索引 $\\Gamma$ 的所有有限子集 $\\Delta$，并为每个子集选取模型 $\\mathcal{M}_\\Delta \\models \\Delta$。令 $\\mathcal{U}$ 为 $I$ 上的一个超滤子，它扩张了由锥 $X_\\varphi = \\{ \\Delta \\in I : \\varphi \\in \\Delta \\}$ (对于 $\\varphi \\in \\Gamma$) 生成的滤子。根据 Łoś 定理，$\\prod_{\\Delta \\in I} \\mathcal{M}_\\Delta / \\mathcal{U} \\models \\Gamma$，从而证明了紧致性。这是 Lindström 定理中一个关键要素，该定理将 FO 刻画为满足紧致性和向下 Löwenheim–Skolem 性质的抽象逻辑中的极大者。\n\nB. 关于 $I$ 上的一个滤子 $\\mathcal{F}$，$\\{\\mathcal{M}_i : i \\in I\\}$ 的超积是笛卡尔积 $\\prod_{i \\in I} M_i$，其中的符号按点解释。Łoś 定理指出，对于每个 FO 句子 $\\sigma$，$\\prod_{i \\in I} \\mathcal{M}_i \\models \\sigma$ 当且仅当 $\\{ i \\in I : \\mathcal{M}_i \\models \\sigma \\} \\in \\mathcal{F}$。这证明了完全性定理，因此蕴含了紧致性，而紧致性是 Lindström 定理的主要假设。\n\nC. 超积是通过取笛卡尔积 $\\prod_{i \\in I} M_i$ 并逐坐标解释关系和函数而形成的，使用余有限滤子来定义真值：一个公式在超积中成立，当且仅当它在除了有限多个 $i \\in I$ 之外的所有 $\\mathcal{M}_i$ 中都成立。Łoś 定理对句子成立，但对带有自由变量的公式不成立，而这足以通过一个简单的编码论证推导出紧致性，这也是 Lindström 定理中的主要工具。\n\nD. 超积是直积的任意一个在投影下封闭的子结构，而 Łoś 定理断言，如果每个 $\\mathcal{M}_i$ 都满足一个 FO 句子 $\\sigma$，那么其积也满足 $\\sigma$；这得出了向上 Löwenheim–Skolem 定理，该定理又蕴含了紧致性，并构成了 Lindström 定理的核心。", "solution": "问题陈述要求选择一个选项，该选项能够正确定义超积构造，陈述适用于一阶公式的 Łoś 定理，并在 Lindström 定理的背景下解释该定理在证明一阶逻辑 (FO) 紧致性定理中的作用。问题陈述本身是数理逻辑领域一个任务的有效指令。它具有科学依据，问题提出得当，且客观。我将逐一分析每个选项。\n\n正确答案所需的核心组成部分是：\n1.  **超积定义**：对结构 $\\prod_{i \\in I} \\mathcal{M}_i / \\mathcal{U}$ 的精确定义，包括其论域（作为笛卡尔积 $\\prod_{i \\in I} M_i$ 上的等价类）以及函数和关系符号的解释。等价关系必须通过索引集 $I$ 上的一个超滤子 $\\mathcal{U}$ 来定义。\n2.  **Łoś 定理**：对任意 FO 公式 $\\varphi(x_1, \\ldots, x_n)$（而不仅是句子）的定理的正确陈述。该定理建立了一个等价关系：一个公式在超积中对于给定的元素赋值为真，当且仅当该公式在分量结构中（使用相应的分量赋值）为真的索引集合是该超滤子的一个成员。\n3.  **与紧致性和 Lindström 定理的联系**：使用超积正确概述 FO 紧致性定理的证明。这涉及到从一个无限可满足的句子集 $\\Gamma$ 的有限子集的模型中，为 $\\Gamma$ 构造一个模型。解释还应正确地将此结果置于 Lindström 定理的背景下，该定理根据紧致性和向下 Löwenheim-Skolem 性质来刻画 FO。\n\n**选项 A 的分析**\n\n1.  **超积定义**：选项 A 将超积 $\\prod_{i \\in I} \\mathcal{M}_i / \\mathcal{U}$ 的论域定义为函数 $a: I \\to \\bigsqcup_{i \\in I} M_i$（其中 $a(i) \\in M_i$）的 $\\mathcal{U}$-等价类的集合。这是对笛卡尔积 $\\prod_{i \\in I} M_i$ 中元素的正确（尽管略显冗长）描述。等价关系被正确地陈述为 $a \\sim b$ 当且仅当 $\\{ i \\in I : a(i) = b(i) \\} \\in \\mathcal{U}$。一个 $n$-元函数符号 $f$ 的解释由 $f^{\\prod/\\mathcal{U}}([a_1],\\dots,[a_n]) = [i \\mapsto f^{\\mathcal{M}_i}(a_1(i),\\dots,a_n(i))]$ 给出，一个 $n$-元关系符号 $R$ 的解释为 $R^{\\prod/\\mathcal{U}}([a_1],\\dots,[a_n])$ 成立当且仅当 $\\{ i \\in I : R^{\\mathcal{M}_i}(a_1(i),\\dots,a_n(i)) \\} \\in \\mathcal{U}$。这些定义是标准且正确的。\n\n2.  **Łoś 定理**：该选项陈述，对于任何 FO 公式 $\\varphi(x_1, \\ldots, x_n)$ 和超积中的元素 $[a_1], \\ldots, [a_n]$，我们有 $\\prod_{i \\in I} \\mathcal{M}_i / \\mathcal{U} \\models \\varphi([a_1],\\dots,[a_n])$ 当且仅当 $\\{ i \\in I : \\mathcal{M}_i \\models \\varphi(a_1(i),\\dots,a_n(i)) \\} \\in \\mathcal{U}$。这是 Łoś 定理的正确且普遍的形式，适用于所有公式，符合问题要求。\n\n3.  **与紧致性和 Lindström 定理的联系**：该解释正确地概述了紧致性定理的标准超积证明。它从一个句子集 $\\Gamma$ 开始，其中每个有限子集 $\\Delta$ 都有一个模型 $\\mathcal{M}_\\Delta$。索引集 $I$ 是所有这些有限子集 $\\Delta$ 的集合。它正确地指出了需要在 $I$ 上存在一个超滤子 $\\mathcal{U}$，该超滤子扩张了由集合 $X_\\varphi = \\{ \\Delta \\in I : \\varphi \\in \\Delta \\}$（对于每个 $\\varphi \\in \\Gamma$）生成的滤子。这样一个超滤子的存在性由超滤子引理（选择公理的一个推论）保证。它正确地得出结论，通过将 Łoś 定理应用于超积 $\\prod_{\\Delta \\in I} \\mathcal{M}_\\Delta / \\mathcal{U}$，可以证明这个结构是 $\\Gamma$ 中所有句子的模型。对于任何 $\\sigma \\in \\Gamma$，集合 $X_\\sigma \\in \\mathcal{U}$。因为对于任何 $\\Delta \\in X_\\sigma$，我们有 $\\sigma \\in \\Delta$，因此 $\\mathcal{M}_\\Delta \\models \\sigma$，所以 $X_\\sigma \\subseteq \\{ \\Delta \\in I : \\mathcal{M}_\\Delta \\models \\sigma \\}$。由于超滤子在超集下是封闭的，我们有 $\\{ \\Delta \\in I : \\mathcal{M}_\\Delta \\models \\sigma \\} \\in \\mathcal{U}$，因此根据 Łoś 定理，超积模型化 $\\sigma$。最后，它正确地陈述了这对 Lindström 定理的重要性：FO 被刻画为满足紧致性和向下 Löwenheim-Skolem 性质的极大抽象逻辑。整个解释是准确且相关的。\n\n**选项 A 的结论**：正确。\n\n**选项 B 的分析**\n\n1.  **超积定义**：此选项声称结构是关于一个*滤子* $\\mathcal{F}$ 构建的，而不是超滤子。它还指出论域是笛卡尔积 $\\prod_{i \\in I} M_i$，忽略了通过等价关系取商的关键步骤。这描述的是直积，而不是超积。\n\n2.  **Łoś 定理**：它错误地陈述了适用于滤子 $\\mathcal{F}$ 和直积结构的定理。Łoś 定理从根本上依赖于*超滤子*和商结构的性质。此外，它将定理限制在句子上，这与问题规范相矛盾。\n\n3.  **与紧致性的联系**：它提出了一个混乱的主张，即 Łoś 定理证明了完全性定理，从而蕴含了紧致性。紧致性定理的超积证明是一个纯语义的证明，它绕过了完全性定理核心的句法概念。\n\n**选项 B 的结论**：不正确。\n\n**选项 C 的分析**\n\n1.  **超积定义**：它错误地将滤子特化为*余有限滤子*。虽然余有限滤子是一个滤子，但只有当索引集 $I$ 是有限的时它才是一个超滤子（在这种情况下，超积与其中一个分量结构同构）。对于无限集，它不是一个超滤子。超积的概念需要一个一般的超滤子。它也忽略了商构造。\n\n2.  **Łoś 定理**：它做出了一个事实性错误的断言，即 Łoś 定理“对句子成立，但对带有自由变量的公式不成立”。该定理的力量和效用恰恰来自于它对所有一阶公式都成立，这是通过对公式复杂度的归纳来证明的。\n\n3.  **与紧致性的联系**：该解释建立在定理仅限于句子的错误前提之上。\n\n**选项 C 的结论**：不正确。\n\n**选项 D 的分析**\n\n1.  **超积定义**：它提供了一个定义——“直积的任意一个在投影下封闭的子结构”——这与超积的标准定义完全无关。超积是直积的一个*商*。\n\n2.  **Łoś 定理**：它将定理错误地陈述为一个简单的保持性质：“如果每个 $\\mathcal{M}_i$ 都满足一个 FO 句子 $\\sigma$，那么其积也满足 $\\sigma$”。这是实际定理的一个弱推论，并且对于积而言，仅对某些类型的句子（全称句子）成立。Łoś 定理是一个强大得多的双条件转移原理。\n\n3.  **与紧致性的联系**：它错误地将 Łoś 定理与*向上* Löwenheim-Skolem 定理联系起来，然后再与紧致性联系起来。更重要的是，它错误地识别了 Lindström 定理的组成部分，该定理使用的是*向下* Löwenheim-Skolem 性质，而不是向上的。\n\n**选项 D 的结论**：不正确。\n\n**结论**\n\n只有选项 A 对所有三个要求的部分都提供了完全正确和精确的说明：超积的定义，适用于公式的 Łoś 定理的陈述，以及其在证明紧致性定理中的作用及其与 Lindström 定理的相关性的解释。", "answer": "$$\\boxed{A}$$", "id": "2976157"}, {"introduction": "林斯特伦定理的真正意义在于它所揭示的权衡：任何比一阶逻辑表达能力更强的逻辑都必须牺牲紧致性或 Löwenheim-Skolem 性质。这个动手练习 [@problem_id:3046177] 使用 Ehrenfeucht–Fraïssé 对策这一具体方法，来证明一阶逻辑一个著名的局限性——它无法定义图的连通性。这个练习将林斯特伦定理的抽象结论具体化，清晰地展示了为了换取一阶逻辑的优良性质，我们“放弃”了什么样的表达能力。", "problem": "设 $\\mathcal{L}$ 是简单无向图的语言，其上只有一个二元关系符号 $E$。对于整数 $m \\geq 1$，定义两个有限的 $\\mathcal{L}$-结构：\n- $G_{m}$ 是有 $2^{m+1}$ 个顶点的圈图（每个顶点的度为2，且唯一的简单圈长度为 $2^{m+1}$）。\n- $H_{m}$ 是两个圈图的不交并，每个圈图有 $2^{m}$ 个顶点（因此 $H_{m}$ 总共有 $2^{m+1}$ 个顶点，分成恰好两个连通分量）。\n\n考虑在语言 $\\mathcal{L}$ 中，关于结构对 $(G_{m},H_{m})$ 的 $r$ 轮 Ehrenfeucht–Fraïssé (EF) 博弈。\n\n仅使用一阶逻辑（first-order logic (FOL)）、EF 博弈的基本定义和性质，以及紧致性定理和 Löwenheim–Skolem 定理的陈述：\n1. 确定最大的整数 $r$（作为 $m$ 的一个显式函数），使得 Duplicator 在关于 $(G_{m},H_{m})$ 的 $r$ 轮 EF 博弈中拥有获胜策略。\n2. 证明这个 EF 博弈的计算结果如何蕴含有限图的连通性不能被任何单个 FOL 语句所定义，并解释这与 Lindström 定理中 FOL 的极大性有何关联（即任何扩展 FOL 且同时满足紧致性定理和 Löwenheim–Skolem 定理的抽象逻辑，其所能定义的同构不变性质不会严格多于 FOL）。\n\n你必须提供这个最大的 $r$ 的精确封闭形式表达式作为最终答案。无需四舍五入。最终答案必须是只含 $m$ 的单个表达式。", "solution": "该问题主要要求两件事：首先，确定最大的整数 $r$，使得 Duplicator 在一对图结构 $(G_m, H_m)$ 上的 $r$ 轮 Ehrenfeucht–Fraïssé (EF) 博弈中拥有获胜策略；其次，将此结果与一阶逻辑 (FOL) 中图连通性的不可定义性以及 Lindström 定理联系起来。\n\n### 第一部分：确定最大的 $r$\n\n我们用 $A \\equiv_r B$ 来表示“Duplicator 在结构 $A$ 和 $B$ 的 $r$ 轮 EF 博弈中拥有获胜策略”这一关系。问题是找到最大的整数 $r$ 使得 $G_m \\equiv_r H_m$。这等价于找到最小的整数 $r$ 使得 $G_m \\not\\equiv_r H_m$，这个值将是 $r_{max}+1$。Spoiler 在 $r$ 轮博弈中拥有获胜策略，当且仅当在语言 $\\mathcal{L}$ 中存在一个量词秩至多为 $r$ 的语句 $\\Phi$，使得 $G_m$ 和 $H_m$ 中一个满足 $\\Phi$ 而另一个不满足。\n\n首先，我们来分析这两个结构。\n- $G_m$ 是圈图 $C_{2^{m+1}}$。它是一个连通图。顶点数为 $2^{m+1}$。任意两顶点 $u,v$ 之间的距离 $d_{G_m}(u,v)$ 是良定义且有限的，最大值为 $2^{m+1}/2 = 2^m$。\n- $H_m$ 是两个圈图 $C_{2^m} \\sqcup C_{2^m}$ 的不交并。它有两个连通分量。总顶点数为 $2 \\times 2^m = 2^{m+1}$。如果两个顶点 $u,v$ 在 $H_m$ 的同一个分量中，它们之间的最大距离为 $2^m/2 = 2^{m-1}$。如果它们在不同的分量中，它们之间没有路径，因此距离为无穷大。\n\n我们的目标是证明最大的 $r$ 是 $m$。这涉及两个断言：\n1. $G_m \\equiv_m H_m$ (Duplicator 赢得 $m$ 轮博弈)。\n2. $G_m \\not\\equiv_{m+1} H_m$ (Spoiler 赢得 $(m+1)$ 轮博弈)。\n\n**断言2：Spoiler 赢得 $(m+1)$ 轮博弈。**\n为证明 Spoiler 获胜，我们需要构造一个量词秩为 $m+1$ 的语句 $\\Phi$，该语句能够区分 $G_m$ 和 $H_m$。\n\n这两个图的一个关键区别是 $G_m$ 是连通的，其直径为 $2^m$，而 $H_m$ 的任何连通分量的直径为 $2^{m-1}$。我们利用这一点。\n在模型论中，这是一个标准结果：属性“$d(x,y) \\le 2^k$”可以用一个量词秩为 $k$ 的公式 $\\phi_k(x,y)$ 来表示。这些公式是归纳定义的：\n- $\\phi_0(x,y) := (x=y) \\lor E(x,y)$。其量词秩为0。\n- $\\phi_{k+1}(x,y) := \\exists z (\\phi_k(x,z) \\land \\phi_k(z,y))$。$\\phi_{k+1}$ 的量词秩为 $qr(\\phi_k) + 1$，因此 $qr(\\phi_k) = k$。\n\n注意，$\\mathcal{M} \\models \\phi_k(u,v)$ 当且仅当在结构 $\\mathcal{M}$ 中，顶点 $u$ 和 $v$ 之间存在一条长度至多为 $2^k$ 的路径。\n\n考虑语句 $\\theta$：\n$$ \\theta := \\exists x \\forall y (\\phi_m(x,y)) $$\n我们来分析 $\\theta$ 的量词秩。公式 $\\phi_m(x,y)$ 的量词秩为 $m$。公式 $\\forall y (\\phi_m(x,y))$ 的秩为 $m$。通过在前面加上 $\\exists x$，秩变为 $m+1$。所以，$qr(\\theta) = m+1$。\n\n现在，我们来检验 $\\theta$ 是否能区分 $G_m$ 和 $H_m$。\n- **在 $G_m$ 中**：语句 $\\theta$ 断言存在一个顶点 $x$，从它出发到任何其他顶点 $y$ 都有一条长度至多为 $2^m$ 的路径。在 $G_m=C_{2^{m+1}}$ 中，任意两顶点间的最大距离恰好是 $2^m$。所以，对任意顶点 $x$，任何其他顶点 $y$ 与它的距离 $d_{G_m}(x,y) \\le 2^m$。这意味着对所有 $y$，$\\phi_m(x,y)$ 为真。因此，$\\forall y (\\phi_m(x,y))$ 对任意选择的 $x$ 都为真。所以，$G_m \\models \\theta$。\n\n- **在 $H_m$ 中**：语句 $\\theta$ 断言同样的性质。我们任取一个顶点 $x$。这个顶点 $x$ 属于两个连通分量之一，比如 $C_A$。现在，我们从另一个连通分量 $C_B$ 中任取一个顶点 $y$。由于 $x$ 和 $y$ 之间没有路径，公式 $\\phi_m(x,y)$ 为假。因此，对任意选择的 $x$，公式 $\\forall y (\\phi_m(x,y))$ 都为假（因为它对另一个分量中的任何 $y$ 都不成立）。所以，不存在这样的 $x$，即 $H_m \\not\\models \\theta$。\n\n由于 $\\theta$ 是一个量词秩为 $m+1$ 的语句，它在 $G_m$ 中为真，在 $H_m$ 中为假，因此这两个结构不是 $(m+1)$-初等等价的。这意味着 Spoiler 在 $(m+1)$ 轮 EF 博弈中拥有获胜策略。因此，$r_{max}  m+1$。\n\n**断言1：Duplicator 赢得 $m$ 轮博弈。**\n证明 Duplicator 赢得 $m$ 轮博弈的过程更为复杂。它需要证明 Duplicator 可以在 $m$ 轮中维持一个特定的不变量。Duplicator 策略在 $k$ 轮（其中 $k \\le m$，已选择的点对为 $(g_1,h_1), \\dots, (g_k,h_k)$）之后的不变量是：映射 $g_i \\mapsto h_i$ 是一个局部同构，并且对于任意两个已选择的顶点 $g_i, g_j$，它们的距离性质被“局部”保持。一个常见的此类不变量是：对于已选点 $g_i, g_j$ 及其像 $h_i, h_j$，只要距离 $d(g_i, g_j)$ 小于 $2^{m-k}$，就有 $d(g_i, g_j) = d(h_i, h_j)$。\n证明的精髓在于，在 $k \\le m$ 轮中，Spoiler 施加的 $k$ 个约束不足以在一个局部上是路径的图中耗尽 Duplicator 的所有可能性。圈的闭合发生在 ($2^m$ 和 $2^{m+1}$) 这样的尺度上，这个尺度太大，以至于在少于 $m+1$ 轮的博弈中无法被检测到。因为 Spoiler 无法在 $m$ 轮内迫使 Duplicator“看到”整个结构，Duplicator 就可以继续找到局部上一致的移动。\n因此，$G_m \\equiv_m H_m$，这意味着 $r_{max} \\ge m$。\n\n结合这两个断言，使得 Duplicator 拥有获胜策略的最大整数 $r$ 是 $m$。\n\n### 第二部分：对连通性和 Lindström 定理的启示\n\n**FOL 中连通性的不可定义性**\nEF 博弈的结果为“图的连通性对于有限图类而言不是一个一阶可定义的属性”提供了一个直接的证明。\n论证通过反证法进行：\n1. 为了引出矛盾，假设存在一个单一的 FOL 语句（我们称之为 $\\Phi_{conn}$）定义了有限图的连通性。这意味着对于任何有限图 $G$，$G \\models \\Phi_{conn}$ 当且仅当 $G$ 是连通的。\n2. 设这个假设的语句 $\\Phi_{conn}$ 的量词秩为 $q$。\n3. 现在，考虑本问题中的特定结构对 $(G_m, H_m)$，其中 $m=q$。\n4. 从第一部分我们知道 $G_q \\equiv_q H_q$。根据 EF 博弈的基本性质，这意味着 $G_q$ 和 $H_q$ 满足所有量词秩至多为 $q$（包括 $q$）的 FOL 语句。\n5. 由于 $qr(\\Phi_{conn}) = q$，那么必然有 $G_q \\models \\Phi_{conn} \\iff H_q \\models \\Phi_{conn}$。\n6. 根据其构造，$G_q$ 是一个圈图，因此是连通的。根据我们对 $\\Phi_{conn}$ 的假设，必然有 $G_q \\models \\Phi_{conn}$。\n7. 从第 5 步和第 6 步，可推断出我们也必须有 $H_q \\models \\Phi_{conn}$。\n8. 然而，根据构造，$H_q$ 是两个圈的不交并，所以它是不连通的。根据我们对 $\\Phi_{conn}$ 的假设，这意味着 $H_q \\not\\models \\Phi_{conn}$。\n9. 我们得到了一个矛盾：$H_q$ 既必须满足又必须不满足 $\\Phi_{conn}$。因此，我们的初始假设必定是错误的。不存在这样的单个 FOL 语句 $\\Phi_{conn}$。\n\n**与 Lindström 定理的联系**\nLindström 定理将 FOL 刻画为极大的“正则”逻辑。它指出，任何扩展了 FOL 表达能力并且还满足两个关键元逻辑性质——紧致性定理和向下 Löwenheim-Skolem 性质——的抽象逻辑 $\\mathcal{L}'$，其表达能力必须等价于 FOL。\n\n我们关于连通性的结果完美地阐释了这一原则：\n1. 我们已经证明，图的连通性在 FOL 中是不可定义的。\n2. 这意味着一个假设的逻辑，比如 $\\mathcal{L}_{conn} = \\text{FOL} + \\{\\text{CONN}\\}$（其中 CONN 是一个仅在连通图中为真的语句），其表达能力将严格强于 FOL。\n3. 根据 Lindström 定理，由于 $\\mathcal{L}_{conn}$ 的表达能力比 FOL 更强，它必须不满足以下至少一个条件：紧致性定理或向下 Löwenheim-Skolem 性质。\n4. 确实，可以证明一个能够表达连通性的逻辑必须违反紧致性定理。考虑语句集合 $\\Gamma = \\{ \\neg \\psi_n(c, d) \\mid n \\in \\mathbb{N} \\}$，其中 $\\psi_n(c,d)$ 是一个 FOL 公式，陈述“常数 $c$ 和 $d$ 之间存在一条长度为 $n$ 的路径”。在此基础上加上来自我们假设逻辑的语句 $\\text{CONN}(c,d)$（表示c,d连通）。$\\Gamma \\cup \\{\\text{CONN}(c,d)\\}$ 的任何有限子集都是可满足的（在一个有两个分量的结构中，其中 $c$ 和 $d$ 相距很远）。然而，如果整个集合是可满足的，那么模型将断言 $c,d$ 连通，但它们之间不存在任何有限长度的路径，这在标准释义下是矛盾的。这展示了紧致性的失效。\n\n总之，在 $(G_m, H_m)$ 上的 EF 博弈为 FOL 的表达能力局限性提供了一个具体的例子。Lindström 定理将这一观察普遍化，确立了这种局限性并非偶然的弱点，而是一种本质的权衡：为了获得定义像连通性这类属性的能力，必须牺牲像紧致性这样使得 FOL 具有良好行为的基础而强大的性质。", "answer": "$$ \\boxed{m} $$", "id": "3046177"}]}