{"hands_on_practices": [{"introduction": "这个练习将瓦瑟斯坦距离的核心思想——最优运输问题——转化为一个直观的物流运输谜题。通过解决这个谜题，您将亲手构建一个“运输方案”，以最低成本在不同地点之间移动“质量”。这个实践将抽象的定义变得具体化，并将其与一个可触摸的优化任务联系起来。[@problem_id:1465059]", "problem": "考虑一个简单的资源分配物流问题。一家公司有两个供应站，位于一条笔直公路上的 $x_1=0$ 和 $x_2=2$ 位置。每个供应站储存的资源恰好是总可用资源的一半。这些资源需要被运送到位于同一公路上的两个分配中心，其位置分别为 $y_1=1$ 和 $y_2=3$。每个分配中心需要的资源也恰好是总资源的一半。\n\n这种分配问题可以用测度论中的一个概念——最优运输来建模。初始资源分布由一个概率测度 $\\mu = \\frac{1}{2}\\delta_0 + \\frac{1}{2}\\delta_2$ 表示，其中 $\\delta_x$ 是狄拉克δ测度，表示在位置 $x$ 处的一个点质量。分配中心的目标分布由测度 $\\nu = \\frac{1}{2}\\delta_1 + \\frac{1}{2}\\delta_3$ 给出。\n\n“运输方案”指定了从每个供应站移动多少资源到每个分配中心。对于这个离散情况，一个运输方案 $\\gamma$ 可以用一个 $2 \\times 2$ 矩阵 $\\Gamma = (\\gamma_{ij})$ 来表示，其中 $\\gamma_{ij}$ 是从供应站 $i$（位于位置 $x_i$）移动到分配中心 $j$（位于位置 $y_j$）的资源占总资源的分数。一个有效的方案必须满足供需约束：从每个供应站运出的总资源和每个分配中心接收的总资源必须与给定的分布相匹配。\n\n将单位资源从位置 $x$ 运输到位置 $y$ 的成本与运输距离成正比，因此我们可以将成本定义为 $c(x,y) = |x-y|$。给定方案的总运输成本是所有单独运输成本的总和，并按每条路径上运输的资源分数进行加权。最优运输的目标是找到使这个总成本最小化的方案。\n\n你的任务是确定此场景下的最优运输方案。找到使总运输成本最小化的矩阵 $\\Gamma_{opt} = \\begin{pmatrix} \\gamma_{11} & \\gamma_{12} \\\\ \\gamma_{21} & \\gamma_{22} \\end{pmatrix}$。元素 $\\gamma_{11}$ 代表从供应站 $x_1=0$ 运到分配中心 $y_1=1$ 的资源分数，$\\gamma_{12}$ 代表从 $x_1=0$ 运到 $y_2=3$ 的资源分数，$\\gamma_{21}$ 代表从 $x_2=2$ 运到 $y_1=1$ 的资源分数，$\\gamma_{22}$ 代表从 $x_2=2$ 运到 $y_2=3$ 的资源分数。", "solution": "问题要求找到最优运输方案 $\\gamma$（由矩阵 $\\Gamma = (\\gamma_{ij})$ 表示），该方案能够最小化将质量从分布 $\\mu = \\frac{1}{2}\\delta_0 + \\frac{1}{2}\\delta_2$ 移动到分布 $\\nu = \\frac{1}{2}\\delta_1 + \\frac{1}{2}\\delta_3$ 的成本。\n\n首先，我们建立运输矩阵 $\\Gamma$ 的元素 $\\gamma_{ij}$ 的约束条件。矩阵的索引方式为：$i=1$ 对应源点 $x_1=0$，$i=2$ 对应源点 $x_2=2$，$j=1$ 对应目标点 $y_1=1$，$j=2$ 对应目标点 $y_2=3$。\n\n边际约束要求每行的和等于相应源点的质量，每列的和等于相应目标点的质量。\n\n行和（供应约束）：\n1.  离开 $x_1=0$ 的总质量必须为 $\\mu(\\{0\\}) = 1/2$。因此，$\\gamma_{11} + \\gamma_{12} = \\frac{1}{2}$。\n2.  离开 $x_2=2$ 的总质量必须为 $\\mu(\\{2\\}) = 1/2$。因此，$\\gamma_{21} + \\gamma_{22} = \\frac{1}{2}$。\n\n列和（需求约束）：\n1.  到达 $y_1=1$ 的总质量必须为 $\\nu(\\{1\\}) = 1/2$。因此，$\\gamma_{11} + \\gamma_{21} = \\frac{1}{2}$。\n2.  到达 $y_2=3$ 的总质量必须为 $\\nu(\\{3\\}) = 1/2$。因此，$\\gamma_{12} + \\gamma_{22} = \\frac{1}{2}$。\n\n此外，移动的质量不能为负，因此对于所有的 $i,j \\in \\{1, 2\\}$，都有 $\\gamma_{ij} \\ge 0$。\n\n接下来，我们定义需要最小化的总成本函数。将单位质量从源点 $x_i$ 移动到目标点 $y_j$ 的成本为 $c_{ij} = |x_i - y_j|$。我们来计算成本矩阵 $C = (c_{ij})$：\n$c_{11} = |x_1 - y_1| = |0 - 1| = 1$\n$c_{12} = |x_1 - y_2| = |0 - 3| = 3$\n$c_{21} = |x_2 - y_1| = |2 - 1| = 1$\n$c_{22} = |x_2 - y_2| = |2 - 3| = 1$\n\n所以成本矩阵是 $C = \\begin{pmatrix} 1 & 3 \\\\ 1 & 1 \\end{pmatrix}$。\n\n我们希望最小化的总运输成本由成本与相应质量分数的乘积之和给出：\n$$ \\mathcal{C}(\\Gamma) = \\sum_{i=1}^{2}\\sum_{j=1}^{2} c_{ij} \\gamma_{ij} = 1\\gamma_{11} + 3\\gamma_{12} + 1\\gamma_{21} + 1\\gamma_{22} $$\n\n现在我们来解决这个约束最小化问题。关于 $\\gamma_{ij}$ 的四个线性约束不是独立的。让我们用一个变量（比如 $\\gamma_{11}$）来表示所有变量。设 $\\gamma_{11} = t$。\n根据第一个行和约束：$\\gamma_{12} = \\frac{1}{2} - \\gamma_{11} = \\frac{1}{2} - t$。\n根据第一个列和约束：$\\gamma_{21} = \\frac{1}{2} - \\gamma_{11} = \\frac{1}{2} - t$。\n根据第二个行和约束：$\\gamma_{22} = \\frac{1}{2} - \\gamma_{21} = \\frac{1}{2} - \\left(\\frac{1}{2} - t\\right) = t$。\n我们可以检查这也满足第二个列和约束：$\\gamma_{12} + \\gamma_{22} = (\\frac{1}{2} - t) + t = \\frac{1}{2}$。\n\n所以，任何有效的运输方案都可以写成单个参数 $t$ 的函数：\n$$ \\Gamma(t) = \\begin{pmatrix} t & \\frac{1}{2} - t \\\\ \\frac{1}{2} - t & t \\end{pmatrix} $$\n非负约束 $\\gamma_{ij} \\ge 0$ 意味着 $t \\ge 0$ 和 $\\frac{1}{2} - t \\ge 0$，即 $t \\le \\frac{1}{2}$。因此，$t$ 的有效范围是 $0 \\le t \\le \\frac{1}{2}$。\n\n现在，我们将总成本 $\\mathcal{C}$ 表示为 $t$ 的函数：\n$$ \\mathcal{C}(t) = 1(t) + 3\\left(\\frac{1}{2} - t\\right) + 1\\left(\\frac{1}{2} - t\\right) + 1(t) $$\n$$ \\mathcal{C}(t) = t + \\frac{3}{2} - 3t + \\frac{1}{2} - t + t $$\n$$ \\mathcal{C}(t) = \\left(\\frac{3}{2} + \\frac{1}{2}\\right) + (1 - 3 - 1 + 1)t $$\n$$ \\mathcal{C}(t) = 2 - 2t $$\n\n为了在区间 $t \\in [0, \\frac{1}{2}]$ 上最小化 $\\mathcal{C}(t) = 2 - 2t$，我们需要使 $-2t$ 这一项尽可能小。这意味着我们应该选择 $t$ 的最大可能值。在 $t$ 的定义域内，其最大值为 $t = \\frac{1}{2}$。\n\n将 $t = \\frac{1}{2}$ 代入我们的参数化矩阵 $\\Gamma(t)$，我们得到最优运输方案：\n$\\gamma_{11} = t = \\frac{1}{2}$\n$\\gamma_{12} = \\frac{1}{2} - t = \\frac{1}{2} - \\frac{1}{2} = 0$\n$\\gamma_{21} = \\frac{1}{2} - t = \\frac{1}{2} - \\frac{1}{2} = 0$\n$\\gamma_{22} = t = \\frac{1}{2}$\n\n因此，最优运输矩阵是：\n$$ \\Gamma_{opt} = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} $$\n该方案对应于将供应站 $x_1=0$ 的所有资源运往分配中心 $y_1=1$，并将供应站 $x_2=2$ 的所有资源运往分配中心 $y_2=3$。这是一个 Monge 解，它避免了成本更高的“交叉”运输（例如，从 $x_1=0$ 到 $y_2=3$）。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}}$$", "id": "1465059"}, {"introduction": "虽然运输方案提供了基本定义，但在实数轴上，一个强大的公式简化了 $W_1$ 距离的计算。本练习介绍的方法是通过积分累积分布函数（CDFs）之间的绝对差来计算距离。您将把这个方法应用于离散概率测度，从而具体理解 CDF 曲线之间的几何面积如何对应于运输成本。[@problem_id:1465007]", "problem": "在最优输运领域，1-Wasserstein 距离用于衡量将一个概率分布转换为另一个概率分布的“代价”。对于实直线 $\\mathbb{R}$ 上的两个概率测度 $\\mu$ 和 $\\nu$，这个距离（记作 $W_1(\\mu, \\nu)$）可以使用它们各自的累积分布函数 (CDF) 来计算。一个测度 $\\sigma$ 的 CDF，记作 $F_\\sigma(t)$，定义为区间 $(-\\infty, t]$ 的总测度，即 $F_\\sigma(t) = \\sigma((-\\infty, t])$。1-Wasserstein 距离则由它们 CDF 之间的总面积给出：\n\n$$W_1(\\mu, \\nu) = \\int_{-\\infty}^{\\infty} |F_\\mu(t) - F_\\nu(t)| \\, dt$$\n\n狄拉克 delta 测度 $\\delta_a$ 表示一个概率分布，其中全部概率质量都集中在单一点 $a$ 上。\n\n考虑实直线上的两个离散概率测度 $\\mu$ 和 $\\nu$，定义如下：\n- 测度 $\\mu$ 由 $\\mu = \\frac{1}{3}\\delta_{-2} + \\frac{2}{3}\\delta_{1}$ 给出。这意味着 $\\mu$ 在点 $x=-2$ 处放置了 $1/3$ 的概率质量，在点 $x=1$ 处放置了 $2/3$ 的概率质量。\n- 测度 $\\nu$ 由 $\\nu = \\frac{1}{2}\\delta_{0} + \\frac{1}{2}\\delta_{3}$ 给出。这意味着 $\\nu$ 在点 $x=0$ 处放置了 $1/2$ 的概率质量，在点 $x=3$ 处放置了 $1/2$ 的概率质量。\n\n计算这两个测度之间的 1-Wasserstein 距离 $W_1(\\mu, \\nu)$。请用最简精确分数表示你的答案。", "solution": "我们使用实直线上的 1-Wasserstein 距离公式：\n$$\nW_{1}(\\mu,\\nu)=\\int_{-\\infty}^{\\infty}\\left|F_{\\mu}(t)-F_{\\nu}(t)\\right|\\,dt.\n$$\n对于给定的离散测度，它们的 CDF 是阶梯函数。由 $\\mu=\\frac{1}{3}\\delta_{-2}+\\frac{2}{3}\\delta_{1}$，我们有\n$$\nF_{\\mu}(t)=\\begin{cases}\n0, & t<-2,\\\\\n\\frac{1}{3}, & -2\\le t<1,\\\\\n1, & t\\ge 1.\n\\end{cases}\n$$\n由 $\\nu=\\frac{1}{2}\\delta_{0}+\\frac{1}{2}\\delta_{3}$，我们有\n$$\nF_{\\nu}(t)=\\begin{cases}\n0, & t<0,\\\\\n\\frac{1}{2}, & 0\\le t<3,\\\\\n1, & t\\ge 3.\n\\end{cases}\n$$\nCDF 发生变化的唯一点是 $-2,0,1,3$。在这些点之间的每个区间上，$|F_{\\mu}-F_{\\nu}|$ 是一个常数，因此积分是这些区间上 (区间长度)$\\times$(绝对差) 的总和。\n\n- 对于 $(-\\infty,-2)$：$F_{\\mu}=0$，$F_{\\nu}=0$，所以贡献为 $0$。\n- 对于 $[-2,0)$：$F_{\\mu}=\\frac{1}{3}$，$F_{\\nu}=0$，所以贡献为 $(0-(-2))\\cdot\\left|\\frac{1}{3}-0\\right|=2\\cdot\\frac{1}{3}=\\frac{2}{3}$。\n- 对于 $[0,1)$：$F_{\\mu}=\\frac{1}{3}$，$F_{\\nu}=\\frac{1}{2}$，所以贡献为 $(1-0)\\cdot\\left|\\frac{1}{3}-\\frac{1}{2}\\right|=1\\cdot\\frac{1}{6}=\\frac{1}{6}$。\n- 对于 $[1,3)$：$F_{\\mu}=1$，$F_{\\nu}=\\frac{1}{2}$，所以贡献为 $(3-1)\\cdot\\left|1-\\frac{1}{2}\\right|=2\\cdot\\frac{1}{2}=1$。\n- 对于 $[3,\\infty)$：$F_{\\mu}=1$，$F_{\\nu}=1$，所以贡献为 $0$。\n\n将这些贡献相加得到\n$$\nW_{1}(\\mu,\\nu)=\\frac{2}{3}+\\frac{1}{6}+1=\\frac{11}{6}.\n$$", "answer": "$$\\boxed{\\frac{11}{6}}$$", "id": "1465007"}, {"introduction": "现在，让我们将技能从离散点扩展到连续分布。这个问题挑战您计算两个均匀分布之间的 $W_1$ 距离，它们代表了质量的连续分布。其解将揭示一个优美而直观的结果，展示了瓦瑟斯坦距离如何与分布的几何分离相关联，从而加深了您对其作为比较概率测度的自然度量的理解。[@problem_id:1465037]", "problem": "在测度论和统计学中，瓦瑟斯坦距离提供了一种衡量两个概率分布之间“距离”的方法。对于两个一维概率分布 $\\mu$ 和 $\\nu$ ，其累积分布函数（CDF）分别为 $F_\\mu(x)$ 和 $F_\\nu(x)$ ，它们之间的1-瓦瑟斯坦距离定义为：\n$$\nW_1(\\mu, \\nu) = \\int_{-\\infty}^{\\infty} |F_\\mu(x) - F_\\nu(x)| dx\n$$\n\n考虑两个不同的均匀概率分布 $\\mu_A$ 和 $\\mu_B$。\n分布 $\\mu_A$ 在以 $c_A$ 为中心、半宽为 $R > 0$ 的区间上是均匀的，即区间 $[c_A - R, c_A + R]$。\n分布 $\\mu_B$ 在以 $c_B$ 为中心、半宽同样为 $R$ 的区间上是均匀的，即区间 $[c_B - R, c_B + R]$。\n\n假设 $c_B > c_A$ 且两个区间不相交，即满足条件 $c_A + R \\le c_B - R$。\n\n计算这两个分布之间的1-瓦瑟斯坦距离 $W_1(\\mu_A, \\mu_B)$。请用 $c_A$ 和 $c_B$ 的闭式解析表达式表示您的答案。", "solution": "问题要求计算两个均匀分布之间的1-瓦瑟斯坦距离 $W_1(\\mu_A, \\mu_B)$，其中 $\\mu_A$ 分布在 $[c_A - R, c_A + R]$ 上，$\\mu_B$ 分布在 $[c_B - R, c_B + R]$ 上。该距离定义为 $W_1(\\mu_A, \\mu_B) = \\int_{-\\infty}^{\\infty} |F_A(x) - F_B(x)| dx$，其中 $F_A(x)$ 和 $F_B(x)$ 分别是 $\\mu_A$ 和 $\\mu_B$ 的累积分布函数（CDF）。\n\n首先，我们必须确定每个分布的CDF。\n对于区间 $[a, b]$ 上的均匀分布，其概率密度函数（PDF）$p(x)$ 为：当 $x \\in [a, b]$ 时，$p(x) = \\frac{1}{b-a}$，否则为 $0$。其累积分布函数 $F(x) = \\int_{-\\infty}^x p(t) dt$ 为：当 $x \\in [a, b]$ 时是 $\\frac{x-a}{b-a}$，当 $x < a$ 时为 $0$，当 $x > b$ 时为 $1$。\n\n对于区间 $[c_A - R, c_A + R]$ 上的分布 $\\mu_A$，区间长度为 $(c_A + R) - (c_A - R) = 2R$。PDF为 $p_A(x) = \\frac{1}{2R}$，对于 $x \\in [c_A - R, c_A + R]$。\nCDF $F_A(x)$ 为：\n$$\nF_A(x) = \n\\begin{cases}\n    0 & \\text{若 } x < c_A - R \\\\\n    \\frac{x - (c_A - R)}{2R} & \\text{若 } c_A - R \\le x \\le c_A + R \\\\\n    1 & \\text{若 } x > c_A + R\n\\end{cases}\n$$\n\n类似地，对于区间 $[c_B - R, c_B + R]$ 上的分布 $\\mu_B$，区间长度为 $2R$，PDF为 $p_B(x) = \\frac{1}{2R}$，对于 $x \\in [c_B - R, c_B + R]$。\nCDF $F_B(x)$ 为：\n$$\nF_B(x) = \n\\begin{cases}\n    0 & \\text{若 } x < c_B - R \\\\\n    \\frac{x - (c_B - R)}{2R} & \\text{若 } c_B - R \\le x \\le c_B + R \\\\\n    1 & \\text{若 } x > c_B + R\n\\end{cases}\n$$\n\n现在，我们必须计算积分 $W_1(\\mu_A, \\mu_B) = \\int_{-\\infty}^{\\infty} |F_A(x) - F_B(x)| dx$。\n题目给出 $c_B > c_A$ 且 $c_A + R \\le c_B - R$。这个顺序意味着分段CDF的关键点排序为 $c_A - R < c_A + R \\le c_B - R < c_B + R$。我们可以根据这些点将整个实线上的积分分成五个区域。\n\n1.  对于 $x < c_A - R$：\n    $F_A(x) = 0$ 且 $F_B(x) = 0$。因此， $|F_A(x) - F_B(x)| = 0$。在 $(-\\infty, c_A - R)$ 上的积分为 $0$。\n\n2.  对于 $c_A - R \\le x \\le c_A + R$：\n    $F_A(x) = \\frac{x - c_A + R}{2R}$ 且 $F_B(x) = 0$（因为 $x \\le c_A + R \\le c_B - R$）。\n    此区域的积分为：\n    $$\n    I_1 = \\int_{c_A - R}^{c_A + R} \\left| \\frac{x - c_A + R}{2R} - 0 \\right| dx = \\int_{c_A - R}^{c_A + R} \\frac{x - c_A + R}{2R} dx\n    $$\n    这个积分代表一个直角三角形的面积，其底为 $(c_A + R) - (c_A - R) = 2R$，高为 $F_A(c_A+R) = \\frac{(c_A+R)-c_A+R}{2R} = 1$。面积为 $\\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} (2R)(1) = R$。\n\n3.  对于 $c_A + R < x < c_B - R$：\n    $F_A(x) = 1$ 且 $F_B(x) = 0$。因此，$|F_A(x) - F_B(x)| = |1 - 0| = 1$。\n    此区域的积分为：\n    $$\n    I_2 = \\int_{c_A + R}^{c_B - R} 1 \\, dx = [x]_{c_A + R}^{c_B - R} = (c_B - R) - (c_A + R) = c_B - c_A - 2R\n    $$\n\n4.  对于 $c_B - R \\le x \\le c_B + R$：\n    $F_A(x) = 1$ 且 $F_B(x) = \\frac{x - c_B + R}{2R}$。\n    此区域的积分为：\n    $$\n    I_3 = \\int_{c_B - R}^{c_B + R} \\left| 1 - \\frac{x - c_B + R}{2R} \\right| dx = \\int_{c_B - R}^{c_B + R} \\left| \\frac{2R - (x - c_B + R)}{2R} \\right| dx = \\int_{c_B - R}^{c_B + R} \\frac{c_B + R - x}{2R} dx\n    $$\n    在此区间内，$c_B + R - x$ 项是非负的。这个积分代表一个直角三角形的面积，其底为 $(c_B + R) - (c_B - R) = 2R$，在 $x=c_B-R$ 处的高为 $\\frac{c_B+R-(c_B-R)}{2R} = \\frac{2R}{2R} = 1$。面积为 $\\frac{1}{2} (2R)(1) = R$。\n\n5.  对于 $x > c_B + R$：\n    $F_A(x) = 1$ 且 $F_B(x) = 1$。因此， $|F_A(x) - F_B(x)| = 0$。在 $(c_B + R, \\infty)$ 上的积分为 $0$。\n\n总的1-瓦瑟斯坦距离是这些区域上积分的总和：\n$$\nW_1(\\mu_A, \\mu_B) = I_1 + I_2 + I_3 = R + (c_B - c_A - 2R) + R\n$$\n$$\nW_1(\\mu_A, \\mu_B) = c_B - c_A\n$$\n结果表明，该距离仅取决于两个分布的中心 $c_A$ 和 $c_B$ 之间的差值，而与半宽 $R$ 无关。在 $c_B > c_A$ 的情况下，这就是两个中心之间的距离。", "answer": "$$\\boxed{c_B - c_A}$$", "id": "1465037"}]}