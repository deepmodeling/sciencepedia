{"hands_on_practices": [{"introduction": "在任何最优运输问题中，成本函数的选择都是最根本的，因为它定义了“效率”的含义。第一个练习将具体比较两种不同的成本函数——标准距离成本和一个简单的二元成本——如何为相同的初始和最终质量分布导出不同的最优运输策略。通过解决这个问题 [@problem_id:1456712]，您将对成本结构如何塑造解决方案获得实践性的理解。", "problem": "在最优输运领域，一个核心问题是找到将一个质量分布 $\\mu$ 重新分配成目标分布 $\\nu$ 的最有效方式。“效率”由总成本来衡量，该成本取决于所选的成本函数 $c(x,y)$，它表示将单位质量从位置 $x$ 移动到位置 $y$ 的成本。\n\n考虑实数线上的两个离散概率分布 $\\mu$ 和 $\\nu$。源分布 $\\mu$ 由下式给出\n$$ \\mu = 0.4 \\delta_{-1} + 0.6 \\delta_{2} $$\n其中 $\\delta_x$ 表示狄拉克δ测度，代表位于位置 $x$ 的一个点质量。目标分布 $\\nu$ 由下式给出\n$$ \\nu = 0.5 \\delta_{-1} + 0.2 \\delta_{1} + 0.3 \\delta_{2} $$\n根据一个输运方案 $\\pi$，将 $\\mu$ 输运到 $\\nu$ 的总成本由移动无穷小质量的成本之和给出。对于离散测度，这表示为 $C(\\pi) = \\sum_{i,j} c(x_i, y_j) \\pi_{ij}$，其中 $\\pi_{ij}$ 是从 $\\mu$ 的一个源点 $x_i$ 移动到 $\\nu$ 的一个目标点 $y_j$ 的质量。最优输运成本是在所有有效的输运方案 $\\pi$ 中可能的最小成本。\n\n针对两种不同的成本函数，计算将 $\\mu$ 变换为 $\\nu$ 的最优输运成本：\n(a) 标准距离成本：$c_a(x, y) = |x - y|$。\n(b) 二元成本：$c_b(x, y) = 1$ 如果 $x \\neq y$，且 $c_b(x, y) = 0$ 如果 $x = y$。\n\n设情况 (a) 的最优成本为 $C_a$，情况 (b) 的最优成本为 $C_b$。请提供 $C_a$ 和 $C_b$ 的值。", "solution": "我们将源点和质量记为 $x_{1}=-1$ 质量为 $0.4$，以及 $x_{2}=2$ 质量为 $0.6$。目标点和需求量为 $y_{1}=-1$ 需求量为 $0.5$，$y_{2}=1$ 需求量为 $0.2$，以及 $y_{3}=2$ 需求量为 $0.3$。一个离散的输运方案由非负变量 $\\pi_{ij}$ 给出，表示从 $x_{i}$ 移动到 $y_{j}$ 的质量，并受到以下守恒约束\n$$\n\\pi_{11}+\\pi_{12}+\\pi_{13}=0.4,\\quad \\pi_{21}+\\pi_{22}+\\pi_{23}=0.6,\n$$\n$$\n\\pi_{11}+\\pi_{21}=0.5,\\quad \\pi_{12}+\\pi_{22}=0.2,\\quad \\pi_{13}+\\pi_{23}=0.3,\n$$\n且 $\\pi_{ij}\\ge 0$。\n\n对于成本 (a)，$c_{a}(x,y)=|x-y|$，非零距离为\n$$\n|{-1}-(-1)|=0,\\quad |{-1}-1|=2,\\quad |{-1}-2|=3,\\quad |2-(-1)|=3,\\quad |2-1|=1,\\quad |2-2|=0.\n$$\n为了最小化成本，首先在零成本的路径上分配尽可能多的质量：设 $\\pi_{11}=\\min(0.4,0.5)=0.4$ 和 $\\pi_{23}=\\min(0.6,0.3)=0.3$。然后根据约束条件，\n$$\n\\pi_{21}=0.5-\\pi_{11}=0.1,\\quad \\pi_{13}=0.3-\\pi_{23}=0,\\quad \\pi_{22}=0.6-\\pi_{21}-\\pi_{23}=0.2,\\quad \\pi_{12}=0.4-\\pi_{11}-\\pi_{13}=0.\n$$\n总成本为\n$$\nC_{a}=\\sum_{i,j}|x_{i}-y_{j}|\\pi_{ij}=0\\cdot \\pi_{11}+2\\cdot \\pi_{12}+3\\cdot \\pi_{13}+3\\cdot \\pi_{21}+1\\cdot \\pi_{22}+0\\cdot \\pi_{23}=3\\cdot 0.1+1\\cdot 0.2=0.5=\\frac{1}{2}.\n$$\n根据实数线上的单调（递增）耦合，或者等效地，在给定的剩余需求下，优先考虑零成本路径，然后是较低成本的路径，该方案是最优的。\n\n对于成本 (b)，$c_{b}(x,y)=1$ 如果 $x\\neq y$ 且 $c_{b}(x,y)=0$ 如果 $x=y$，总成本简化为移出其原始位置的总质量。写作\n$$\nC_{b}=\\sum_{i,j}c_{b}(x_{i},y_{j})\\pi_{ij}=\\sum_{i}\\left(\\sum_{j}\\pi_{ij}-\\sum_{j:y_{j}=x_{i}}\\pi_{ij}\\right)=1-\\left(\\pi_{11}+\\pi_{23}\\right),\n$$\n我们看到最小化 $C_{b}$ 等价于最大化保持在相同位置的质量，即 $\\pi_{11}+\\pi_{23}$。约束条件意味着 $\\pi_{11}\\le \\min(0.4,0.5)=0.4$ 和 $\\pi_{23}\\le \\min(0.6,0.3)=0.3$，并且这些可以同时达到（如上所示），得到 $\\pi_{11}+\\pi_{23}=0.7$。因此\n$$\nC_{b}=1-0.7=0.3=\\frac{3}{10}.\n$$\n因此最优成本为 $C_{a}=\\frac{1}{2}$ 和 $C_{b}=\\frac{3}{10}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{3}{10}\\end{pmatrix}}$$", "id": "1456712"}, {"introduction": "优化领域中一个常见的问题是：最优解是否唯一？在最优运输理论中，答案并非总是肯定的。这个实践问题 [@problem_id:1456725] 展示了一个精心构建的场景，其中一整族不同的运输方案都具有同等的最优性。通过分析这种情况，您会发现最优解的集合有时可能是一个丰富的几何对象，而不仅仅是单个点。", "problem": "在最优运输理论中，一个核心问题是找到一种最有效的方式，将质量分布从源分布转移到目标分布。这通过找到一个最小化总“代价”的“运输方案”来量化。\n\n考虑实线上的四个不同点：$x_1 = -2$，$x_2 = -1$，$x_3 = 1$ 和 $x_4 = 2$。\n设在这些点上定义了源概率测度 $\\mu$ 和目标概率测度 $\\nu$ 如下：\n-   源测度 $\\mu$ 由 $\\mu(\\{x_1\\}) = \\frac{1}{2}$，$\\mu(\\{x_2\\}) = \\frac{1}{2}$，以及 $\\mu(\\{x_3\\}) = \\mu(\\{x_4\\}) = 0$ 给出。\n-   目标测度 $\\nu$ 由 $\\nu(\\{x_3\\}) = \\frac{1}{2}$，$\\nu(\\{x_4\\}) = \\frac{1}{2}$，以及 $\\nu(\\{x_1\\}) = \\nu(\\{x_2\\}) = 0$ 给出。\n\n一个运输方案 $\\gamma$ 是一个 $4 \\times 4$ 矩阵，其元素 $\\gamma_{ij} \\ge 0$，其中 $\\gamma_{ij}$ 表示从点 $x_i$ 移动到点 $x_j$ 的质量大小。\n如果一个方案 $\\gamma$ 满足边际约束，则称其为“可行的”方案：\n-   每一行的和等于对应源点的质量：$\\sum_{j=1}^4 \\gamma_{ij} = \\mu(\\{x_i\\})$ 对于 $i=1, 2, 3, 4$。\n-   每一列的和等于对应目标点的质量：$\\sum_{i=1}^4 \\gamma_{ij} = \\nu(\\{x_j\\})$ 对于 $j=1, 2, 3, 4$。\n\n从点 $x$ 运输单位质量到点 $y$ 的代价由距离 $c(x,y) = |x-y|$ 给出。一个运输方案 $\\gamma$ 的总代价是 $C(\\gamma) = \\sum_{i=1}^4 \\sum_{j=1}^4 \\gamma_{ij} c(x_i, x_j)$。一个“最优”方案是使这个总代价最小化的可行方案。\n\n下面是五个代表潜在运输方案的矩阵。其中哪些矩阵代表了将质量从 $\\mu$ 移动到 $\\nu$ 的可行且最优的运输方案？\n\nA.\n$$ \\begin{pmatrix} 0 & 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 0 & \\frac{1}{2} \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\nB.\n$$ \\begin{pmatrix} 0 & 0 & 0 & \\frac{1}{2} \\\\ 0 & 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\nC.\n$$ \\begin{pmatrix} 0 & 0 & \\frac{1}{4} & \\frac{1}{4} \\\\ 0 & 0 & \\frac{1}{4} & \\frac{1}{4} \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\nD.\n$$ \\begin{pmatrix} 0 & 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\nE.\n$$ \\begin{pmatrix} 0 & 0 & \\frac{1}{4} & 0 \\\\ 0 & 0 & \\frac{1}{4} & \\frac{1}{2} \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$", "solution": "问题要求我们识别出给定的方案中哪些是既可行又最优的。我们将首先刻画所有可行方案的集合并计算它们的代价。然后我们将检查每个选项。\n\n一个可行运输方案 $\\gamma = (\\gamma_{ij})$ 必须满足由源测度 $\\mu$ 和目标测度 $\\nu$ 决定的边际约束。\n源测度是在点 $(x_1, x_2, x_3, x_4)$ 上的 $\\mu = (\\frac{1}{2}, \\frac{1}{2}, 0, 0)$。\n目标测度是在点 $(x_1, x_2, x_3, x_4)$ 上的 $\\nu = (0, 0, \\frac{1}{2}, \\frac{1}{2})$。\n\n一个可行方案 $\\gamma$ 的边际约束是：\n1.  行和（源约束）：\n    -   $\\sum_{j=1}^4 \\gamma_{1j} = \\mu(\\{x_1\\}) = \\frac{1}{2}$\n    -   $\\sum_{j=1}^4 \\gamma_{2j} = \\mu(\\{x_2\\}) = \\frac{1}{2}$\n    -   $\\sum_{j=1}^4 \\gamma_{3j} = \\mu(\\{x_3\\}) = 0$\n    -   $\\sum_{j=1}^4 \\gamma_{4j} = \\mu(\\{x_4\\}) = 0$\n2.  列和（目标约束）：\n    -   $\\sum_{i=1}^4 \\gamma_{i1} = \\nu(\\{x_1\\}) = 0$\n    -   $\\sum_{i=1}^4 \\gamma_{i2} = \\nu(\\{x_2\\}) = 0$\n    -   $\\sum_{i=1}^4 \\gamma_{i3} = \\nu(\\{x_3\\}) = \\frac{1}{2}$\n    -   $\\sum_{i=1}^4 \\gamma_{i4} = \\nu(\\{x_4\\}) = \\frac{1}{2}$\n\n根据这些约束，由于所有 $\\gamma_{ij} \\ge 0$，我们可以推断出矩阵 $\\gamma$ 中唯一可能非零的元素是 $\\gamma_{13}, \\gamma_{14}, \\gamma_{23}, \\gamma_{24}$。所有其他元素必须为零。\n\n让我们将可行方案的空间参数化。设 $\\gamma_{13} = a$。\n根据第一个行和约束，$\\gamma_{13} + \\gamma_{14} = \\frac{1}{2}$，所以 $\\gamma_{14} = \\frac{1}{2} - a$。\n根据第三个列和约束，$\\gamma_{13} + \\gamma_{23} = \\frac{1}{2}$，所以 $\\gamma_{23} = \\frac{1}{2} - a$。\n根据第二个行和约束，$\\gamma_{23} + \\gamma_{24} = \\frac{1}{2}$，所以 $\\gamma_{24} = \\frac{1}{2} - \\gamma_{23} = \\frac{1}{2} - (\\frac{1}{2} - a) = a$。\n第四个列和为 $\\gamma_{14} + \\gamma_{24} = (\\frac{1}{2} - a) + a = \\frac{1}{2}$，这是自动满足的。\n\n由于所有元素必须非负，我们有 $a \\ge 0$ 和 $\\frac{1}{2} - a \\ge 0$，这意味着 $0 \\le a \\le \\frac{1}{2}$。\n因此，任何可行方案都必须是以下形式：\n$$ \\gamma(a) = \\begin{pmatrix} 0 & 0 & a & \\frac{1}{2}-a \\\\ 0 & 0 & \\frac{1}{2}-a & a \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} \\quad \\text{对于 } a \\in \\left[0, \\frac{1}{2}\\right] $$\n\n接下来，我们计算任意一个可行方案的总代价 $C(\\gamma(a))$。首先，我们需要相关点对的具体代价 $c(x_i, x_j) = |x_i - x_j|$：\n-   $c(x_1, x_3) = |-2 - 1| = 3$\n-   $c(x_1, x_4) = |-2 - 2| = 4$\n-   $c(x_2, x_3) = |-1 - 1| = 2$\n-   $c(x_2, x_4) = |-1 - 2| = 3$\n\n总代价是：\n$$ C(\\gamma(a)) = \\gamma_{13} c(x_1, x_3) + \\gamma_{14} c(x_1, x_4) + \\gamma_{23} c(x_2, x_3) + \\gamma_{24} c(x_2, x_4) $$\n$$ C(\\gamma(a)) = a(3) + \\left(\\frac{1}{2}-a\\right)(4) + \\left(\\frac{1}{2}-a\\right)(2) + a(3) $$\n$$ C(\\gamma(a)) = 3a + 2 - 4a + 1 - 2a + 3a $$\n$$ C(\\gamma(a)) = (3 - 4 - 2 + 3)a + (2 + 1) = 0a + 3 $$\n$$ C(\\gamma(a)) = 3 $$\n\n对于任何可行方案，即对于任何 $a \\in [0, 1/2]$，代价都是常数 3。这意味着*每一个*可行方案都是最优方案。最小代价是 3。\n\n现在我们检查每个选项：\n-   **方案 A**：该矩阵对应于 $a = 1/2$ 时的形式 $\\gamma(a)$。由于 $1/2 \\in [0, 1/2]$，该方案是可行的。因为所有可行方案都是最优的，所以方案 A 是最优的。\n-   **方案 B**：该矩阵对应于 $a = 0$ 时的形式 $\\gamma(a)$。由于 $0 \\in [0, 1/2]$，该方案是可行的。因为所有可行方案都是最优的，所以方案 B 是最优的。\n-   **方案 C**：该矩阵对应于 $a = 1/4$ 时的形式 $\\gamma(a)$。由于 $1/4 \\in [0, 1/2]$，该方案是可行的。因为所有可行方案都是最优的，所以方案 C 是最优的。\n-   **方案 D**：我们检查它是否可行。\n    -   行和：$\\frac{1}{2}$，$\\frac{1}{2}$，0，0。这与 $\\mu$ 匹配。\n    -   列和：0，0，$\\frac{1}{2}+\\frac{1}{2}=1$，0。这与 $\\nu = (0,0,\\frac{1}{2},\\frac{1}{2})$ 不匹配。\n    -   方案 D 是不可行的。\n-   **方案 E**：我们检查它是否可行。\n    -   行和：$\\frac{1}{4}+0=\\frac{1}{4}$，$\\frac{1}{4}+\\frac{1}{2}=\\frac{3}{4}$，0，0。这与 $\\mu = (\\frac{1}{2},\\frac{1}{2},0,0)$ 不匹配。\n    -   方案 E 是不可行的。\n\n因此，既可行又最优的方案只有 A、B 和 C。", "answer": "$$\\boxed{ABC}$$", "id": "1456725"}, {"introduction": "离散问题通过运输方案（矩阵）求解，而连续问题通常需要寻找一个最优运输映射，即一个规定每个粒子应移动到何处的函数 $T(x)$。本练习 [@problem_id:1456745] 将引导您使用一种经典方法，在二次成本函数下求解一维空间中的这种映射。您将利用源测度和目标测度的累积分布函数来构建唯一且单调递增的最优映射。", "problem": "考虑一个一维物质重分布场景。一家公司需要重塑一堆分布在区间 $[0, 1]$ 上的颗粒状材料。初始质量分布由线性密度函数 $\\rho_0(x) = 2x$（对于 $x \\in [0, 1]$）描述，在其他地方为零。期望的最终构型是均匀质量分布，由密度函数 $\\rho_1(y) = 1$（对于 $y \\in [0, 1]$）描述，在其他地方为零。\n\n将单位质量从位置 $x$ 移动到位置 $y$ 的成本由二次成本函数 $c(x, y) = (x - y)^2$ 给出。这种重分布是通过一个输运映射 $T: [0, 1] \\to [0, 1]$ 实现的，其中初始位置为 $x$ 的粒子被移动到最终位置 $y = T(x)$。目标是找到使总运输成本最小化的具体映射 $T(x)$，该成本由积分 $\\int_0^1 c(x, T(x)) \\rho_0(x) \\, dx$ 定义。在一维情况下，对于这种类型的成本函数，已知这个最优映射是唯一的且单调递增的。\n\n确定这个最优输运映射 $T(x)$ 的显式函数形式。", "solution": "在一维情况下，对于严格凸的二次成本 $c(x,y)=(x-y)^{2}$ 以及绝对连续的源密度和目标密度，唯一的最优输运映射是由以下公式给出的递增单调重排：\n$$\nT(x)=F_{1}^{-1}\\big(F_{0}(x)\\big),\n$$\n其中 $F_{0}$ 和 $F_{1}$ 分别是 $\\rho_{0}$ 和 $\\rho_{1}$ 的累积分布函数（CDF）。\n\n计算在 $[0,1]$ 上的累积分布函数：\n$$\nF_{0}(x)=\\int_{0}^{x}2t\\,dt=x^{2},\\quad F_{1}(y)=\\int_{0}^{y}1\\,ds=y.\n$$\n由于在 $[0,1]$ 上有 $F_{1}(y)=y$，其反函数为 $F_{1}^{-1}(u)=u$（对于 $u\\in[0,1]$）。因此，\n$$\nT(x)=F_{1}^{-1}\\big(F_{0}(x)\\big)=F_{1}^{-1}\\big(x^{2}\\big)=x^{2}.\n$$\n\n作为一致性检验，使用递增映射 $T$ 的质量守恒（雅可比）方程：\n$$\n\\rho_{0}(x)=\\rho_{1}\\big(T(x)\\big)\\,T'(x).\n$$\n当 $\\rho_{0}(x)=2x$ 且 $\\rho_{1}\\equiv 1$ 时，此方程给出 $T'(x)=2x$，其解为 $T(x)=x^{2}+C$。边界条件由 $F_{1}(T(0))=F_{0}(0)=0$ 得出，这意味着 $T(0)=0$，因此 $C=0$。因此 $T(x)=x^{2}$，它将 $[0,1]$ 映射到 $[0,1]$ 并产生目标密度。", "answer": "$$\\boxed{T(x) = x^2}$$", "id": "1456745"}]}