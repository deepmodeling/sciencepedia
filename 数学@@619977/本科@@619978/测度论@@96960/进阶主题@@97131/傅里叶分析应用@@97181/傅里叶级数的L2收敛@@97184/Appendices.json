{"hands_on_practices": [{"introduction": "傅里叶级数的核心思想之一是用简单的正弦和余弦波来逼近更复杂的函数。这个练习将带你从一个最基础的函数 $f(x) = x$ 出发，亲手计算其一阶傅里叶逼近，并量化逼近的好坏程度——即计算函数与其逼近之间的 $L^2$ 误差。通过这个经典的例子，你将具体地体会到傅里叶级数在 $L^2$ 空间中的逼近能力。[@problem_id:1426224]", "problem": "在信号处理的研究中，周期函数通常使用傅里叶级数分解为简单正弦函数的和。本题探讨了对一个简单线性函数进行基本近似的质量。\n\n考虑定义在区间 $[-\\pi, \\pi]$ 上的函数 $f(x) = x$。在此区间上，函数 $g(x)$ 的傅里叶级数由下式给出：\n$$S_g(x) = \\frac{a_0}{2} + \\sum_{n=1}^\\infty (a_n \\cos(nx) + b_n \\sin(nx))$$\n其中系数计算如下：\n$$a_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} g(x) \\cos(nx) dx \\quad (n \\ge 0)$$\n$$b_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} g(x) \\sin(nx) dx \\quad (n \\ge 1)$$\n\n该级数的第 $N$ 部分和，记为 $S_N g(x)$，是将求和截断至 $n=N$ 所得的和。此近似的误差可以通过函数与其近似之差的 $L^2$ 范数的平方来量化。\n\n设 $S_1 f(x)$ 为函数 $f(x) = x$ 在 $[-\\pi, \\pi]$ 上的傅里叶级数的第一部分和。计算平方 $L^2$ 误差的精确值，该值定义为 $E_1 = \\int_{-\\pi}^{\\pi} (f(x) - S_1 f(x))^2 dx$。将答案表示为含 $\\pi$ 的精确符号表达式。", "solution": "我们计算 $f(x)=x$ 在 $[-\\pi,\\pi]$ 上的傅里叶系数。由于 $f$ 是奇函数，根据奇偶对称性，$a_{0}=0$ 且对所有 $n\\geq 1$ 都有 $a_{n}=0$，因为 $x\\cos(nx)$ 是奇函数。对于 $n\\geq 1$，\n$$\nb_{n}=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi}x\\sin(nx)\\,dx.\n$$\n被积函数 $x\\sin(nx)$ 是偶函数，所以\n$$\nb_{n}=\\frac{2}{\\pi}\\int_{0}^{\\pi}x\\sin(nx)\\,dx.\n$$\n使用分部积分法，令 $u=x$，$dv=\\sin(nx)\\,dx$，则 $du=dx$ 且 $v=-\\cos(nx)/n$。于是\n$$\n\\int_{0}^{\\pi}x\\sin(nx)\\,dx=\\left.-\\frac{x\\cos(nx)}{n}\\right|_{0}^{\\pi}+\\int_{0}^{\\pi}\\frac{\\cos(nx)}{n}\\,dx\n=\\left.-\\frac{x\\cos(nx)}{n}\\right|_{0}^{\\pi}+\\left.\\frac{\\sin(nx)}{n^{2}}\\right|_{0}^{\\pi}.\n$$\n代入积分限计算可得\n$$\n\\int_{0}^{\\pi}x\\sin(nx)\\,dx=-\\frac{\\pi\\cos(n\\pi)}{n}+\\frac{\\sin(n\\pi)}{n^{2}}-0=-\\frac{\\pi(-1)^{n}}{n}.\n$$\n因此\n$$\nb_{n}=\\frac{2}{\\pi}\\left(-\\frac{\\pi(-1)^{n}}{n}\\right)=-\\frac{2(-1)^{n}}{n}=\\frac{2(-1)^{n+1}}{n}.\n$$\n因此，第一部分和是\n$$\nS_{1}f(x)=b_{1}\\sin(x)=2\\sin(x).\n$$\n平方 $L^{2}$ 误差为\n$$\nE_{1}=\\int_{-\\pi}^{\\pi}\\left(x-2\\sin x\\right)^{2}\\,dx=\\int_{-\\pi}^{\\pi}\\left(x^{2}-4x\\sin x+4\\sin^{2}x\\right)\\,dx.\n$$\n我们分别计算各项。首先，\n$$\n\\int_{-\\pi}^{\\pi}x^{2}\\,dx=\\left.\\frac{x^{3}}{3}\\right|_{-\\pi}^{\\pi}=\\frac{2\\pi^{3}}{3}.\n$$\n其次，$x\\sin x$ 是偶函数，因此\n$$\n\\int_{-\\pi}^{\\pi}x\\sin x\\,dx=2\\int_{0}^{\\pi}x\\sin x\\,dx.\n$$\n在 $[0,\\pi]$ 上使用分部积分法，令 $u=x$，$dv=\\sin x\\,dx$（则 $v=-\\cos x$），\n$$\n\\int_{0}^{\\pi}x\\sin x\\,dx=\\left.-x\\cos x\\right|_{0}^{\\pi}+\\int_{0}^{\\pi}\\cos x\\,dx=-\\pi\\cos\\pi+\\left.\\sin x\\right|_{0}^{\\pi}=\\pi.\n$$\n从而\n$$\n\\int_{-\\pi}^{\\pi}x\\sin x\\,dx=2\\pi.\n$$\n最后，使用 $\\sin^{2}x=\\frac{1-\\cos(2x)}{2}$，\n$$\n\\int_{-\\pi}^{\\pi}\\sin^{2}x\\,dx=\\int_{-\\pi}^{\\pi}\\frac{1}{2}\\,dx-\\int_{-\\pi}^{\\pi}\\frac{\\cos(2x)}{2}\\,dx=\\left.\\frac{x}{2}\\right|_{-\\pi}^{\\pi}-\\left.\\frac{\\sin(2x)}{4}\\right|_{-\\pi}^{\\pi}=\\pi.\n$$\n将这些结果汇总，\n$$\nE_{1}=\\frac{2\\pi^{3}}{3}-4\\cdot(2\\pi)+4\\cdot\\pi=\\frac{2\\pi^{3}}{3}-4\\pi.\n$$\n作为一致性检验，根据帕塞瓦尔恒等式，在此归一化条件下，截断至 $N=1$ 后的剩余能量为\n$$\nE_{1}=\\pi\\sum_{n=2}^{\\infty}b_{n}^{2}=\\pi\\sum_{n=2}^{\\infty}\\frac{4}{n^{2}}=4\\pi\\left(\\sum_{n=1}^{\\infty}\\frac{1}{n^{2}}-1\\right)=4\\pi\\left(\\frac{\\pi^{2}}{6}-1\\right)=\\frac{2\\pi^{3}}{3}-4\\pi,\n$$\n该结果与直接计算的结果相符。", "answer": "$$\\boxed{\\frac{2}{3}\\pi^{3}-4\\pi}$$", "id": "1426224"}, {"introduction": "从信号处理的角度看，一个函数的 $L^2$ 范数的平方代表其总“能量”。贝塞尔不等式告诉我们，任何有限项傅里叶逼近所包含的能量都不会超过原函数的总能量。这个练习通过计算一个简单的阶梯函数（特征函数）及其低阶傅里叶逼近，让你验证这一基本原理，并精确计算出被截断的高频部分带走了多少能量。[@problem_id:1426197]", "problem": "考虑一个函数 $f(x)$，它属于空间 $L^2([-\\pi, \\pi])$，即在区间 $[-\\pi, \\pi]$ 上的平方可积函数空间。该函数定义为区间 $[0, \\pi/2]$ 上的特征函数（也称为指示函数）：\n$$\nf(x) = \\chi_{[0, \\pi/2]}(x) = \\begin{cases} 1 & \\text{if } 0 \\le x \\le \\pi/2 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n$f(x)$ 的复傅里叶级数由 $\\sum_{n=-\\infty}^{\\infty} c_n e^{inx}$ 给出，其中系数 $c_n$ 通过以下公式计算：\n$$\nc_n = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(x) e^{-inx} dx\n$$\n贝塞尔不等式指出，对于任意整数 $N \\ge 0$，傅里叶级数部分和的能量小于或等于函数的总能量。这表示为：\n$$\n\\sum_{n=-N}^{N} |c_n|^2 \\le \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |f(x)|^2 dx\n$$\n这两个量之间的差值代表了函数能量中未被其傅里叶级数前 $2N+1$ 项所捕获的部分。\n\n你的任务是计算当 $N=1$ 时这个能量差。也就是，计算由以下公式定义的量 $D$ 的值：\n$$\nD = \\left( \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |f(x)|^2 dx \\right) - \\left( \\sum_{n=-1}^{1} |c_n|^2 \\right)\n$$\n将你的答案表示为单个闭式解析表达式。", "solution": "我们以符号方式计算 $D$ 定义中的每一项。\n\n首先，$f$ 在 $[-\\pi,\\pi]$ 上的总 $L^{2}$ 能量是\n$$\n\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}|f(x)|^{2}\\,dx=\\frac{1}{2\\pi}\\int_{0}^{\\pi/2}1\\,dx=\\frac{1}{2\\pi}\\cdot\\frac{\\pi}{2}=\\frac{1}{4}.\n$$\n\n接下来，复傅里叶系数是\n$$\nc_{n}=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}f(x)\\exp(-inx)\\,dx=\\frac{1}{2\\pi}\\int_{0}^{\\pi/2}\\exp(-inx)\\,dx.\n$$\n对于 $n=0$，\n$$\nc_{0}=\\frac{1}{2\\pi}\\int_{0}^{\\pi/2}1\\,dx=\\frac{1}{4},\n$$\n所以 $|c_{0}|^{2}=\\frac{1}{16}$。\n\n对于 $n\\neq 0$，\n$$\nc_{n}=\\frac{1}{2\\pi}\\left[\\frac{\\exp(-inx)}{-in}\\right]_{0}^{\\pi/2}\n=\\frac{1}{2\\pi}\\cdot\\frac{\\exp(-in\\pi/2)-1}{-in}\n=\\frac{1}{2\\pi in}\\left(1-\\exp\\!\\left(-in\\frac{\\pi}{2}\\right)\\right).\n$$\n对于 $n=1$，\n$$\nc_{1}=\\frac{1}{2\\pi i}\\left(1-\\exp\\!\\left(-i\\frac{\\pi}{2}\\right)\\right)\n=\\frac{1}{2\\pi i}(1-(-i))=\\frac{1}{2\\pi i}(1+i),\n$$\n因此\n$$\n|c_{1}|^{2}=\\frac{|1+i|^{2}}{(2\\pi)^{2}}=\\frac{2}{4\\pi^{2}}=\\frac{1}{2\\pi^{2}}.\n$$\n对于 $n=-1$，\n$$\nc_{-1}=\\frac{1}{-2\\pi i}\\left(1-\\exp\\!\\left(i\\frac{\\pi}{2}\\right)\\right)\n=\\frac{1}{-2\\pi i}(1-i)=\\frac{1}{2\\pi}(1+i),\n$$\n所以\n$$\n|c_{-1}|^{2}=\\frac{|1+i|^{2}}{(2\\pi)^{2}}=\\frac{1}{2\\pi^{2}}.\n$$\n\n因此，\n$$\n\\sum_{n=-1}^{1}|c_{n}|^{2}=|c_{-1}|^{2}+|c_{0}|^{2}+|c_{1}|^{2}\n=\\frac{1}{2\\pi^{2}}+\\frac{1}{16}+\\frac{1}{2\\pi^{2}}=\\frac{1}{16}+\\frac{1}{\\pi^{2}}.\n$$\n所求的差值为\n$$\nD=\\frac{1}{4}-\\left(\\frac{1}{16}+\\frac{1}{\\pi^{2}}\\right)=\\frac{3}{16}-\\frac{1}{\\pi^{2}}.\n$$\n这是非负的，与贝塞尔不等式一致。", "answer": "$$\\boxed{\\frac{3}{16}-\\frac{1}{\\pi^{2}}}$$", "id": "1426197"}, {"introduction": "在实际应用中，我们常常需要在满足特定约束的条件下寻找最佳逼近。这个问题将引导你解决一个更高级的优化问题：在所有二次三角多项式中，找到一个与 $\\cos(x)$ 函数正交，同时又最接近于 $f(x) = e^x$ 的多项式。解决这个问题将展示在傅里叶（系数）域中处理约束条件的强大优势，这是希尔伯特空间投影理论一个优雅的应用。[@problem_id:1426180]", "problem": "设 $L^2([-\\pi, \\pi])$ 是在区间 $[-\\pi, \\pi]$ 上的复值平方可积函数构成的希尔伯特空间，其内积定义为 $\\langle g, h \\rangle = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} g(x) \\overline{h(x)} \\,dx$。设 $i$ 表示虚数单位。\n\n设 $T_2$ 是阶数至多为 2 的三角多项式空间。一个实值多项式 $p(x) \\in T_2$ 可以唯一地写为 $p(x) = \\sum_{m=-2}^{2} c_m e^{imx}$，其系数满足实数条件 $c_{-m} = \\overline{c_m}$。\n\n考虑在区间 $[-\\pi, \\pi]$ 上的实值函数 $f(x) = \\exp(x)$。我们寻找多项式 $p(x) \\in T_2$，它是 $f(x)$ 的最佳 $L^2$-逼近，且满足约束条件，即 $p(x)$ 必须与函数 $g(x) = \\cos(x)$ 正交。也就是说，求一个实值多项式 $p(x) \\in T_2$，它在约束条件 $\\langle p, g \\rangle = 0$ 下，最小化平方误差 $\\|f-p\\|^2$。\n\n求此最优多项式 $p(x)$ 的系数 $c_1$。", "solution": "问题要求解一个实值三角多项式 $p(x) \\in T_2$ 的系数 $c_1$，该多项式为 $f(x)=\\exp(x)$ 最小化平方误差 $\\|f-p\\|^2$，并满足约束条件 $\\langle p, \\cos(x) \\rangle = 0$。\n\n空间 $L^2([-\\pi, \\pi])$ 是一个希尔伯特空间，其标准正交基为 $\\{e^{imx}\\}_{m \\in \\mathbb{Z}}$。我们可以用这个基来表示函数 $f(x)$ 和多项式 $p(x)$。\n$f(x)$ 的傅里叶级数为 $f(x) = \\sum_{m=-\\infty}^{\\infty} \\hat{f}(m) e^{imx}$，其中 $\\hat{f}(m) = \\langle f, e^{imx} \\rangle$ 是 $f$ 的傅里叶系数。\n多项式 $p(x)$ 形式为 $p(x) = \\sum_{m=-2}^{2} c_m e^{imx}$。\n\n平方误差由差的平方范数给出：\n$$ \\|f - p\\|^2 = \\left\\| \\sum_{m=-\\infty}^{\\infty} \\hat{f}(m) e^{imx} - \\sum_{m=-2}^{2} c_m e^{imx} \\right\\|^2 $$\n我们可以将差重写为：\n$$ f(x) - p(x) = \\sum_{m=-2}^{2} (\\hat{f}(m) - c_m) e^{imx} + \\sum_{|m|>2} \\hat{f}(m) e^{imx} $$\n根据希尔伯特空间中的勾股定理（因为对于 $|m| \\leq 2$ 和 $|m|>2$ 的基函数集合是正交的），平方范数是两部分平方范数之和：\n$$ \\|f-p\\|^2 = \\left\\| \\sum_{m=-2}^{2} (\\hat{f}(m) - c_m) e^{imx} \\right\\|^2 + \\left\\| \\sum_{|m|>2} \\hat{f}(m) e^{imx} \\right\\|^2 $$\n利用基函数的标准正交性，上式变为：\n$$ \\|f-p\\|^2 = \\sum_{m=-2}^{2} |\\hat{f}(m) - c_m|^2 + \\sum_{|m|>2} |\\hat{f}(m)|^2 $$\n为了最小化此误差，我们需要选择系数 $c_m$ 来最小化第一项和，因为第二项和与 $p(x)$ 的选择无关。因此，我们的目标是在 $p(x)$ 的给定约束条件下，最小化 $\\sum_{m=-2}^{2} |\\hat{f}(m) - c_m|^2$。\n\n$p(x)$ 的约束条件是：\n1. $p(x)$ 是实值的，这意味着对于 $m \\in \\{0,1,2\\}$，有 $c_{-m} = \\overline{c_m}$。\n2. $\\langle p, \\cos(x) \\rangle = 0$。\n\n我们来分析第二个约束条件。由于 $\\cos(x) = \\frac{e^{ix} + e^{-ix}}{2}$：\n$$ \\langle p, \\cos(x) \\rangle = \\left\\langle \\sum_{m=-2}^{2} c_m e^{imx}, \\frac{e^{ix} + e^{-ix}}{2} \\right\\rangle = \\frac{1}{2} \\left( \\left\\langle \\sum_{m=-2}^{2} c_m e^{imx}, e^{ix} \\right\\rangle + \\left\\langle \\sum_{m=-2}^{2} c_m e^{imx}, e^{-ix} \\right\\rangle \\right) $$\n根据标准正交性，$\\langle e^{imx}, e^{ikx} \\rangle = \\delta_{mk}$。该表达式简化为：\n$$ \\frac{1}{2} (c_1 + c_{-1}) = 0 \\implies c_1 + c_{-1} = 0 $$\n将此与实数条件 $c_{-1} = \\overline{c_1}$ 结合，我们得到 $c_1 + \\overline{c_1} = 0$，这意味着 $2\\text{Re}(c_1)=0$。因此，$c_1$ 必须是一个纯虚数。设 $c_1 = i\\beta$，其中 $\\beta \\in \\mathbb{R}$。\n\n对于系数 $|\\hat{f}(m) - c_m|^2$ 的最小化问题可以逐项处理。对于 $m=0, \\pm 2$，除了实数条件外，对 $c_0, c_2, c_{-2}$ 没有其他约束。通过设置 $c_m = \\hat{f}(m)$（对于 $m=0, \\pm 2$），可以使项 $|\\hat{f}(0)-c_0|^2$、 $|\\hat{f}(2)-c_2|^2$ 和 $|\\hat{f}(-2)-c_{-2}|^2$ 最小化。\n\n对于 $m = \\pm 1$，系数 $c_1$ 和 $c_{-1}$ 被约束条件耦合。我们需要在 $c_{-1} = -c_1$ 的约束下最小化 $E(c_1, c_{-1}) = |\\hat{f}(1) - c_1|^2 + |\\hat{f}(-1) - c_{-1}|^2$。\n$$ E(c_1) = |\\hat{f}(1) - c_1|^2 + |\\hat{f}(-1) + c_1|^2 $$\n接下来，我们计算 $f(x) = e^x$ 的傅里叶系数。\n$$ \\hat{f}(m) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} e^x e^{-imx} \\,dx = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} e^{(1-im)x} \\,dx $$\n$$ \\hat{f}(m) = \\frac{1}{2\\pi} \\left[ \\frac{e^{(1-im)x}}{1-im} \\right]_{-\\pi}^{\\pi} = \\frac{1}{2\\pi(1-im)} (e^{\\pi-im\\pi} - e^{-\\pi+im\\pi}) $$\n使用 $e^{\\pm im\\pi} = (-1)^m$，我们得到：\n$$ \\hat{f}(m) = \\frac{(-1)^m}{2\\pi(1-im)} (e^{\\pi} - e^{-\\pi}) = \\frac{(-1)^m \\sinh(\\pi)}{\\pi(1-im)} $$\n当 $m=1$ 时：\n$$ \\hat{f}(1) = \\frac{-\\sinh(\\pi)}{\\pi(1-i)} = \\frac{-\\sinh(\\pi)(1+i)}{\\pi(1-i)(1+i)} = \\frac{-\\sinh(\\pi)(1+i)}{2\\pi} = -\\frac{\\sinh(\\pi)}{2\\pi} - i\\frac{\\sinh(\\pi)}{2\\pi} $$\n当 $m=-1$ 时：\n$$ \\hat{f}(-1) = \\frac{-\\sinh(\\pi)}{\\pi(1+i)} = \\frac{-\\sinh(\\pi)(1-i)}{\\pi(1+i)(1-i)} = \\frac{-\\sinh(\\pi)(1-i)}{2\\pi} = -\\frac{\\sinh(\\pi)}{2\\pi} + i\\frac{\\sinh(\\pi)}{2\\pi} $$\n对于实函数，正如预期的那样，$\\hat{f}(-1) = \\overline{\\hat{f}(1)}$。\n\n设 $\\hat{f}(1) = A+iB$，其中 $A = B = -\\frac{\\sinh(\\pi)}{2\\pi}$。则 $\\hat{f}(-1) = A-iB$。设 $c_1=i\\beta$。我们要最小化：\n$$ E(\\beta) = |(A+iB) - i\\beta|^2 + |(A-iB) + i\\beta|^2 $$\n$$ E(\\beta) = |A + i(B-\\beta)|^2 + |A - i(B-\\beta)|^2 $$\n$$ E(\\beta) = (A^2 + (B-\\beta)^2) + (A^2 + (B-\\beta)^2) = 2A^2 + 2(B-\\beta)^2 $$\n当 $(B-\\beta)^2$ 最小时，此表达式关于 $\\beta$ 达到最小值，这发生在 $\\beta=B$ 时。\n因此，最优系数 $c_1$ 是 $c_1 = i\\beta = iB$。\n代入 $B$ 的值：\n$$ c_1 = i \\left(-\\frac{\\sinh(\\pi)}{2\\pi}\\right) = -i \\frac{\\sinh(\\pi)}{2\\pi} $$", "answer": "$$\\boxed{-i\\frac{\\sinh(\\pi)}{2\\pi}}$$", "id": "1426180"}]}