{"hands_on_practices": [{"introduction": "掌握平行输运的第一步是进行一次直接的计算。这个练习将我们带回熟悉的欧几里得平面，但改用极坐标系。通过这个练习，你将亲手计算克氏符（Christoffel symbols），理解它们如何仅仅因为坐标系的选取而非空间本身的弯曲而出现，并沿着一条简单的闭合路径——圆周——求解平行输运方程，最终揭示平直空间中非平凡坐标系下的和乐（holonomy）现象。[@problem_id:2986898]", "problem": "考虑穿孔平面 $\\mathbb{R}^{2}\\setminus\\{0\\}$，其在极坐标 $(r,\\theta)$ 下的黎曼度量为 $g=dr^{2}+r^{2}\\,d\\theta^{2}$。设 $\\gamma:[0,2\\pi]\\to \\mathbb{R}^{2}\\setminus\\{0\\}$ 为一个固定半径 $r_{0}>0$ 的圆，其参数化为 $\\gamma(\\theta)=(r_{0},\\theta)$。利用 Levi-Civita 联络的定义性质（度量兼容性和无挠性），通过推导并求解向量场 $V(\\theta)$ 在坐标基 $\\{\\partial_{r},\\partial_{\\theta}\\}$ 下各分量的平行输运方程，计算切向量 $V(0)\\in T_{\\gamma(0)}(\\mathbb{R}^{2}\\setminus\\{0\\})$ 沿 $\\gamma$ 的平行输运。然后，将基点 $\\gamma(0)$ 处的和乐表示为二维特殊正交群 $\\mathrm{SO}(2)$ 的一个元素。由此，确定在完整一圈 $\\theta:0\\to 2\\pi$ 后得到的和乐角，该角定义为 $[0,2\\pi)$ 内代表该和乐元素的唯一旋转角。以弧度表示和乐角。最终答案只需提供和乐角，无需四舍五入。", "solution": "### 解题推导\n\n该问题要求我们计算一个向量在赋予了平坦欧几里得度量的穿孔平面上沿一个圆进行平行输运后的和乐角。我们在极坐标 $(x^1, x^2) = (r, \\theta)$ 中进行计算。\n\n首先，我们确定度量张量 $g$ 的分量。从表达式 $g = dr^{2} + r^{2}\\,d\\theta^{2}$，我们有：\n$$\ng_{ij} = \\begin{pmatrix} g_{rr} & g_{r\\theta} \\\\ g_{\\theta r} & g_{\\theta\\theta} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & r^2 \\end{pmatrix}\n$$\n逆度量张量为：\n$$\ng^{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & r^{-2} \\end{pmatrix}\n$$\n\n接下来，我们使用公式计算 Levi-Civita 联络的第二类 Christoffel 符号 $\\Gamma^k_{ij}$：\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{jl}}{\\partial x^i} + \\frac{\\partial g_{il}}{\\partial x^j} - \\frac{\\partial g_{ij}}{\\partial x^l} \\right)\n$$\n度量分量对坐标的偏导数中唯一不为零的是：\n$$\n\\frac{\\partial g_{\\theta\\theta}}{\\partial r} = \\frac{\\partial (r^2)}{\\partial r} = 2r\n$$\n其他所有导数，如 $\\frac{\\partial g_{rr}}{\\partial r}$、$\\frac{\\partial g_{rr}}{\\partial \\theta}$ 和 $\\frac{\\partial g_{\\theta\\theta}}{\\partial \\theta}$，均为零。\n\n我们现在计算非零的 Christoffel 符号：\n$$\n\\Gamma^r_{\\theta\\theta} = \\frac{1}{2} g^{rr} \\left( \\frac{\\partial g_{\\theta r}}{\\partial \\theta} + \\frac{\\partial g_{\\theta r}}{\\partial \\theta} - \\frac{\\partial g_{\\theta\\theta}}{\\partial r} \\right) = \\frac{1}{2} (1) (0 + 0 - 2r) = -r\n$$\n$$\n\\Gamma^\\theta_{r\\theta} = \\Gamma^\\theta_{\\theta r} = \\frac{1}{2} g^{\\theta\\theta} \\left( \\frac{\\partial g_{\\theta\\theta}}{\\partial r} + \\frac{\\partial g_{r\\theta}}{\\partial \\theta} - \\frac{\\partial g_{r\\theta}}{\\partial\\theta} \\right) = \\frac{1}{2} (r^{-2}) (2r) = \\frac{1}{r}\n$$\n所有其他的 Christoffel 符号 $\\Gamma^k_{ij}$ 均为零。\n\n沿曲线 $\\gamma$ 进行平行输运的向量场为 $V(\\theta) = V^r(\\theta) \\partial_r + V^\\theta(\\theta) \\partial_\\theta$。平行输运方程为 $\\nabla_{\\dot{\\gamma}}V = 0$。曲线由 $\\gamma(\\theta) = (r_0, \\theta)$ 给出，因此 $r(\\theta) = r_0$ 且 $\\theta(\\theta) = \\theta$。曲线的切向量是 $\\dot{\\gamma} = \\frac{dr}{d\\theta}\\partial_r + \\frac{d\\theta}{d\\theta}\\partial_\\theta = 0 \\cdot \\partial_r + 1 \\cdot \\partial_\\theta = \\partial_\\theta$。\n\n平行输运方程的分量形式为：\n$$\n\\frac{d V^k}{d\\theta} + \\Gamma^k_{ij} \\frac{dx^i}{d\\theta} V^j = 0\n$$\n其中参数是 $\\theta$，沿曲线的坐标是 $x^1=r=r_0$ 和 $x^2=\\theta$。导数为 $\\frac{dx^1}{d\\theta} = \\frac{dr}{d\\theta} = 0$ 和 $\\frac{dx^2}{d\\theta} = \\frac{d\\theta}{d\\theta} = 1$。\n\n对于 $k=r$：\n$$\n\\frac{dV^r}{d\\theta} + \\sum_{i,j} \\Gamma^r_{ij} \\frac{dx^i}{d\\theta} V^j = 0\n$$\n求和中唯一非零的项是 $i=j=\\theta$ 时：\n$$\n\\frac{dV^r}{d\\theta} + \\Gamma^r_{\\theta\\theta} \\frac{d\\theta}{d\\theta} V^\\theta = 0 \\implies \\frac{dV^r}{d\\theta} + (-r_0)(1)V^\\theta = 0 \\implies \\frac{dV^r}{d\\theta} = r_0 V^\\theta\n$$\n\n对于 $k=\\theta$：\n$$\n\\frac{dV^\\theta}{d\\theta} + \\sum_{i,j} \\Gamma^\\theta_{ij} \\frac{dx^i}{d\\theta} V^j = 0\n$$\n唯一非零的项是 $i=\\theta, j=r$ 时：\n$$\n\\frac{dV^\\theta}{d\\theta} + \\Gamma^\\theta_{\\theta r} \\frac{d\\theta}{d\\theta} V^r = 0 \\implies \\frac{dV^\\theta}{d\\theta} + \\left(\\frac{1}{r_0}\\right)(1)V^r = 0 \\implies \\frac{dV^\\theta}{d\\theta} = -\\frac{1}{r_0} V^r\n$$\n\n我们得到以下线性常微分方程组：\n$$\n\\begin{cases} \\frac{dV^r}{d\\theta} = r_0 V^\\theta \\\\ \\frac{dV^\\theta}{d\\theta} = -\\frac{1}{r_0} V^r \\end{cases}\n$$\n为求解该方程组，我们将第一个方程对 $\\theta$ 求导：\n$$\n\\frac{d^2 V^r}{d\\theta^2} = r_0 \\frac{dV^\\theta}{d\\theta}\n$$\n将第二个方程代入上式得到：\n$$\n\\frac{d^2 V^r}{d\\theta^2} = r_0 \\left(-\\frac{1}{r_0} V^r\\right) = -V^r\n$$\n这导致齐次二阶常微分方程：\n$$\n\\frac{d^2 V^r}{d\\theta^2} + V^r = 0\n$$\n$V^r(\\theta)$ 的通解为：\n$$\nV^r(\\theta) = A \\cos(\\theta) + B \\sin(\\theta)\n$$\n我们利用第一个常微分方程找到 $V^\\theta(\\theta)$：\n$$\nV^\\theta(\\theta) = \\frac{1}{r_0} \\frac{dV^r}{d\\theta} = \\frac{1}{r_0} (-A \\sin(\\theta) + B \\cos(\\theta))\n$$\n常数 $A$ 和 $B$ 由 $\\theta=0$ 时的初始条件确定。设初始向量为 $V(0) = V^r(0)\\partial_r + V^\\theta(0)\\partial_\\theta$。\n在 $\\theta=0$ 处：\n$$\nV^r(0) = A \\cos(0) + B \\sin(0) = A\n$$\n$$\nV^\\theta(0) = \\frac{1}{r_0}(-A \\sin(0) + B \\cos(0)) = \\frac{B}{r_0} \\implies B=r_0 V^\\theta(0)\n$$\n将 $A$ 和 $B$ 代回，分量的解为：\n$$\nV^r(\\theta) = V^r(0) \\cos(\\theta) + r_0 V^\\theta(0) \\sin(\\theta)\n$$\n$$\nV^\\theta(\\theta) = -\\frac{V^r(0)}{r_0} \\sin(\\theta) + V^\\theta(0) \\cos(\\theta)\n$$\n\n和乐变换是将在闭环上平行输运后，初始向量 $V(0)$ 映射到最终向量 $V(2\\pi)$ 的线性映射。我们在 $\\theta=2\\pi$ 处计算分量：\n$$\nV^r(2\\pi) = V^r(0) \\cos(2\\pi) + r_0 V^\\theta(0) \\sin(2\\pi) = V^r(0) \\cdot 1 + r_0 V^\\theta(0) \\cdot 0 = V^r(0)\n$$\n$$\nV^\\theta(2\\pi) = -\\frac{V^r(0)}{r_0} \\sin(2\\pi) + V^\\theta(0) \\cos(2\\pi) = -\\frac{V^r(0)}{r_0} \\cdot 0 + V^\\theta(0) \\cdot 1 = V^\\theta(0)\n$$\n在闭环结束时向量的分量与初始分量相同。初始向量是 $V(0) = V^r(0)\\partial_r|_{\\gamma(0)} + V^\\theta(0)\\partial_\\theta|_{\\gamma(0)}$。最终向量是 $V(2\\pi) = V^r(2\\pi)\\partial_r|_{\\gamma(2\\pi)} + V^\\theta(2\\pi)\\partial_\\theta|_{\\gamma(2\\pi)}$。\n基点是 $\\gamma(0) = (r_0, 0)$ 和 $\\gamma(2\\pi) = (r_0, 2\\pi)$。在穿孔平面中，它们对应于同一点 $(x,y)=(r_0,0)$。坐标基向量 $\\partial_r$ 和 $\\partial_\\theta$ 通过它们在固定笛卡尔基下的表达式依赖于 $\\theta$，但这种依赖性是 $2\\pi$ 周期的。因此，$\\partial_r|_{\\gamma(0)} = \\partial_r|_{\\gamma(2\\pi)}$ 且 $\\partial_\\theta|_{\\gamma(0)} = \\partial_\\theta|_{\\gamma(2\\pi)}$。\n由于在闭环的起点和终点，分量和基向量都相同，所以最终向量与初始向量相同：$V(2\\pi) = V(0)$。\n\n因此，和乐变换是切空间 $T_{\\gamma(0)}(\\mathbb{R}^2\\setminus\\{0\\})$ 上的恒等映射。为了将其表示为 $\\mathrm{SO}(2)$ 的一个元素，我们考虑它在切空间的任意标准正交基下的矩阵表示。在任何这样的基中，恒等映射都由单位矩阵表示：\n$$\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n这个矩阵是 $\\mathrm{SO}(2)$ 的一个元素，对应于一个角度为 $\\phi$ 的旋转。$\\mathrm{SO}(2)$ 中旋转矩阵的一般形式是 $\\begin{pmatrix} \\cos\\phi & -\\sin\\phi \\\\ \\sin\\phi & \\cos\\phi \\end{pmatrix}$。对于单位矩阵，我们有 $\\cos\\phi=1$ 和 $\\sin\\phi=0$，这意味着（在 $[0, 2\\pi)$ 范围内）角度 $\\phi$ 为 $0$。\n\n因此，在完整一圈后得到的和乐角是 0 弧度。对于一个平坦流形而言，这个结果是预料之中的，因为极坐标中非零的 Christoffel 符号仅仅是为了解释坐标基底自身的旋转，从而使得平行输运的向量在一个固定的全局坐标系中保持不变。", "answer": "$$\n\\boxed{0}\n$$", "id": "2986898"}, {"introduction": "虽然解析解能提供深刻的洞察，但在弯曲流形上的许多实际问题需要依赖数值方法。这项实践将指导你在一个典型的弯曲空间——二维球面 $S^2$ 上，实现一个数值平行输运算法。通过将平行输运的微分方程（ODE）转化为代码，你将对向量如何在曲面上移动获得一种可操作的理解，并能动手验证平行输运的线性和可逆性等关键理论性质。[@problem_id:2986923]", "problem": "考虑在球坐标系 $(\\theta,\\phi)$ 中配备了其标准黎曼度规的 2-球面 $S^2$，其中 $\\theta \\in (0,\\pi)$ 且 $\\phi \\in (-\\pi,\\pi]$。在这些坐标中，度规张量为 $g_{ij} = \\mathrm{diag}(1,\\sin^2 \\theta)$。Levi-Civita 联络是与度规相容且无挠的，在这些坐标中，其 Christoffel 符号满足 $\\Gamma^{\\theta}_{\\phi\\phi} = -\\sin \\theta \\cos \\theta$ 和 $\\Gamma^{\\phi}_{\\theta\\phi} = \\Gamma^{\\phi}_{\\phi\\theta} = \\cot \\theta$，而所有其他的 $\\Gamma^i_{jk}$ 均为 0。设 $c:[s,t]\\to S^2$ 为一条光滑曲线，其坐标表达式为 $c(\\tau)=(\\theta(\\tau),\\phi(\\tau))$。如果沿曲线 $c$ 的切向量 $V(\\tau)$ 沿 $c$ 的协变导数为零，即 $\\nabla_{\\dot{c}(\\tau)} V(\\tau)=0$，则称该向量是平行的。在坐标中，此条件对应于常微分方程 (ODE)：\n$$\n\\frac{dV^i}{d\\tau}(\\tau) + \\Gamma^i_{jk}\\big(c(\\tau)\\big)\\,\\frac{dx^j}{d\\tau}(\\tau)\\,V^k(\\tau) = 0,\\quad i\\in\\{\\theta,\\phi\\},\n$$\n其中重复指标表示求和，且 $x^j$ 是坐标函数。沿 $c$ 的平行标准正交标架 $(E_1(\\tau),E_2(\\tau))$ 是通过对每个基向量求解相同的 ODE 得到的，其初始条件为 $\\tau=s$ 处的一个标准正交基。对于具有给定度规的 2-球面，在坐标基下，点 $(\\theta,\\phi)$ 处的一个标准正交基由 $E_1=(1,0)$ 和 $E_2=\\big(0,1/\\sin \\theta\\big)$ 给出。\n\n你的任务是通过对向量和在 $\\tau=s$ 处初始化的平行标架的坐标 ODE 进行积分，来实现一个数值平行输运算法。使用以下测试套件来验证平行输运的不同性质。所有角度必须以弧度表示。\n\n实现以下四个测试曲线和初始数据，并为每个测试按要求生成一个实数值结果。在所有情况下，使用给定的 $s$ 和 $t$ 构成的坐标区间 $\\tau\\in[s,t]$，并通过积分 ODE 来计算平行输运。\n\n- 测试 A (赤道，路径上 Christoffel 符号为零)：\n  曲线：$\\theta(\\tau)=\\pi/2$, $\\phi(\\tau)=\\tau$，其中 $s=0$ 且 $t=1.25$。\n  $\\tau=s$ 处的初始向量分量：$V^\\theta(s)=0.3$, $V^\\phi(s)=0.4$。\n  要求的结果：数值输运后的最终向量分量 $(V^\\theta(t),V^\\phi(t))$ 与初始分量 $(V^\\theta(s),V^\\phi(s))$ 之差的欧几里得 2-范数。\n\n- 测试 B (子午线，解析比较)：\n  曲线：$\\theta(\\tau)=\\theta_0+\\tau$, $\\phi(\\tau)=\\phi_0$，其中 $s=0$, $t=\\theta_1-\\theta_0$, $\\theta_0=0.7$, $\\theta_1=1.4$, 且 $\\phi_0=0.3$。\n  $\\tau=s$ 处的初始向量分量：$V^\\theta(s)=0.1$, $V^\\phi(s)=0.8$。\n  $\\tau=t$ 处输运后分量的解析预测：$V^\\theta(t)=V^\\theta(s)$ 和 $V^\\phi(t)=V^\\phi(s)\\,\\dfrac{\\sin \\theta_0}{\\sin \\theta_1}$。\n  要求的结果：数值输运后的最终向量与此解析预测之差的欧几里得 2-范数。\n\n- 测试 C (一般中纬度路径，平行输运的可逆性)：\n  曲线：$\\theta(\\tau)=0.4\\pi+0.2\\sin \\tau$, $\\phi(\\tau)=0.1+1.3\\,\\tau+0.2\\sin(2\\tau)$，其中 $s=0$ 且 $t=1.0$。\n  $\\tau=s$ 处的初始向量分量：$V^\\theta(s)=0.5$, $V^\\phi(s)=-0.3$。\n  要求的结果：初始分量 $(V^\\theta(s),V^\\phi(s))$ 与先向前输运到 $\\tau=t$ 再沿同一曲线从 $\\tau=t$ 向后输运回 $\\tau=s$ 后得到的分量之差的欧几里得 2-范数。\n\n- 测试 D (近极点路径，基于标架的输运与直接输运的比较)：\n  曲线：$\\theta(\\tau)=0.2+0.1\\,\\tau$, $\\phi(\\tau)=2\\,\\tau+0.1\\sin(3\\tau)$，其中 $s=0$ 且 $t=0.6$。\n  $\\tau=s$ 处的初始向量分量：$V^\\theta(s)=0.7$, $V^\\phi(s)=0.9$。\n  使用 $E_1=(1,0)$ 和 $E_2=\\big(0,1/\\sin \\theta(s)\\big)$ 在 $\\tau=s$ 处构建一个平行标准正交标架，传播该标架，并通过保持标架系数不变来在 $\\tau=t$ 处重构输运后的向量。将这个基于标架输运的向量与通过直接对 $V(\\tau)$ 的坐标 ODE 积分得到的向量进行比较。\n  要求的结果：基于标架输运的最终向量与直接输运的最终向量之差的欧几里得 2-范数。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，$[r_A, r_B, r_C, r_D]$），列表中的每个条目都是按上述方式计算的浮点数。角度单位必须是弧度。不允许有任何其他输出。", "solution": "问题的核心是求解用于平行输运的常微分方程组（ODEs）。一个分量为 $V^i(\\tau)$ 的向量场 $V(\\tau)$，如果其沿着坐标为 $x^j(\\tau)$ 的曲线 $c(\\tau)$ 的切向量 $\\dot{c}(\\tau)$ 的协变导数为零，则称其是平行的。该条件在坐标中表示为：\n$$\n\\frac{d V^i}{d \\tau} + \\Gamma^i_{jk}(c(\\tau)) \\frac{d x^j}{d \\tau} V^k(\\tau) = 0\n$$\n其中 $\\Gamma^i_{jk}$ 是 Levi-Civita 联络的 Christoffel 符号。对于球坐标 $x^1 = \\theta$ 和 $x^2 = \\phi$ 下的 2-球面 $S^2$，非零的 Christoffel 符号为 $\\Gamma^{\\theta}_{\\phi\\phi} = -\\sin\\theta\\cos\\theta$ 和 $\\Gamma^{\\phi}_{\\theta\\phi} = \\Gamma^{\\phi}_{\\phi\\theta} = \\cot\\theta$。\n\n设向量分量为 $V = (V^\\theta, V^\\phi)$，曲线速度为 $(\\dot{\\theta}, \\dot{\\phi})$。对每个分量 $i \\in \\{\\theta, \\phi\\}$ 展开平行输运方程，可得到如下常微分方程组：\n对于 $i=\\theta$：\n$$\n\\frac{d V^\\theta}{d \\tau} = - \\Gamma^\\theta_{jk} \\dot{x}^j V^k = - \\Gamma^\\theta_{\\phi\\phi} \\dot{\\phi} V^\\phi = -(-\\sin\\theta\\cos\\theta) \\dot{\\phi} V^\\phi = \\sin\\theta\\cos\\theta \\dot{\\phi} V^\\phi\n$$\n对于 $i=\\phi$：\n$$\n\\frac{d V^\\phi}{d \\tau} = - \\Gamma^\\phi_{jk} \\dot{x}^j V^k = - (\\Gamma^\\phi_{\\theta\\phi} \\dot{\\theta} V^\\phi + \\Gamma^\\phi_{\\phi\\theta} \\dot{\\phi} V^\\theta) = -(\\cot\\theta \\dot{\\theta} V^\\phi + \\cot\\theta \\dot{\\phi} V^\\theta) = -\\cot\\theta (\\dot{\\theta} V^\\phi + \\dot{\\phi} V^\\theta)\n$$\n该系统是一个一阶线性常微分方程初值问题，可以使用标准数值方法求解。我们将采用一个高精度的自适应步长积分器，例如由 `scipy.integrate.solve_ivp` 提供的积分器，来计算向量分量 $V^\\theta(\\tau)$ 和 $V^\\phi(\\tau)$ 的演化。这四个测试验证了平行输运的不同基本性质。\n\n测试 A：此测试涉及沿赤道 $\\theta(\\tau) = \\pi/2$ 的输运，这是一条测地线。沿着这条曲线，$\\cos(\\pi/2) = 0$ 且 $\\cot(\\pi/2)=0$，导致所有相关的 Christoffel 符号都为零。ODE 系统简化为 $\\frac{d V^\\theta}{d \\tau} = 0$ 和 $\\frac{d V^\\phi}{d \\tau} = 0$。因此，向量分量必须保持不变。数值测试通过检查在 $\\tau=1.25$ 处的最终向量与在 $\\tau=0$ 处的初始向量在数值误差范围内是否相同来验证这一点。\n\n测试 B：此测试涉及沿子午线 $\\phi(\\tau) = \\phi_0$ 的输运，这也是一条测地线。由于 $\\dot{\\phi}=0$， $V^\\theta$ 的 ODE 变为 $\\frac{d V^\\theta}{d \\tau} = 0$，所以 $V^\\theta$ 是常数。$V^\\phi$ 的 ODE 变为 $\\frac{d V^\\phi}{d \\tau} = -\\cot\\theta(\\tau) \\dot{\\theta}(\\tau) V^\\phi$。当 $\\theta(\\tau) = \\theta_0 + \\tau$ 且 $\\dot{\\theta}=1$ 时，这是一个可分离的 ODE，其已知解析解为 $V^\\phi(t) = V^\\phi(s)(\\sin\\theta_0/\\sin\\theta_1)$。此测试将数值求解器与精确解进行比较以验证其正确性。\n\n测试 C：此测试验证平行输运的可逆性。Levi-Civita 联络是一种度规联络，这意味着平行输运是切空间之间的等距同构。将一个向量沿一条曲线从点 $p$ 向前输运到点 $q$，然后再沿同一条曲线从 $q$ 向后输运回 $p$，必须能恢复原始向量。这是通过从 $\\tau=0$ 到 $\\tau=1.0$ 进行数值积分，然后再从 $\\tau=1.0$ 积分回 $\\tau=0$ 来进行测试的。\n\n测试 D：此测试验证平行输运算子 $\\mathcal{P}$ 的线性性。该算子是线性的，即 $\\mathcal{P}(aU+bW) = a\\mathcal{P}(U) + b\\mathcal{P}(W)$。此性质允许通过输运切空间的一个基来输运任意向量。我们在 $\\tau=s$ 处初始化一个标准正交标架 $(E_1(s), E_2(s))$，将初始向量 $V(s)$ 在此标架中分解为 $V(s) = a_1 E_1(s) + a_2 E_2(s)$，然后输运这些基向量以在 $\\tau=t$ 处获得标架 $(E_1(t), E_2(t))$。输运后的向量随后被重构为 $V(t) = a_1 E_1(t) + a_2 E_2(t)$。将这个基于标架的结果与直接输运 $V(s)$ 得到的向量进行比较。两个结果必须在数值误差范围内一致。系数 $a_1$ 和 $a_2$ 通过求解线性方程组 $V(s) = a_1 E_1(s) + a_2 E_2(s)$ 得到。对于给定的基 $E_1(s)=(1,0)$ 和 $E_2(s)=(0, 1/\\sin\\theta(s))$，解为 $a_1=V^\\theta(s)$和 $a_2=V^\\phi(s)\\sin\\theta(s)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef dV_dtau_func(tau, V_components, curve, curve_dot):\n    \"\"\"\n    Computes the time derivative of vector components for parallel transport.\n    \n    This function represents the right-hand side of the parallel transport ODE:\n    dV^i/dtau = -Gamma^i_jk * dx^j/dtau * V^k\n    \n    Args:\n        tau (float): The curve parameter (time).\n        V_components (np.ndarray): A 1D array [V_theta, V_phi].\n        curve (callable): A function tau -> [theta(tau), phi(tau)].\n        curve_dot (callable): A function tau -> [dtheta/dtau, dphi/dtau].\n    \n    Returns:\n        list: The derivatives [dV_theta/dtau, dV_phi/dtau].\n    \"\"\"\n    V_theta, V_phi = V_components\n    theta, _ = curve(tau)\n    dtheta_dtau, dphi_dtau = curve_dot(tau)\n\n    # Avoid division by zero at poles, though problem constraints prevent this.\n    if theta <= 0 or theta >= np.pi:\n        return [0.0, 0.0]\n\n    sin_theta = np.sin(theta)\n    cos_theta = np.cos(theta)\n    cot_theta = cos_theta / sin_theta\n    \n    # ODE for V^theta\n    dV_theta_dtau = sin_theta * cos_theta * dphi_dtau * V_phi\n    \n    # ODE for V^phi\n    dV_phi_dtau = -cot_theta * (dtheta_dtau * V_phi + dphi_dtau * V_theta)\n    \n    return [dV_theta_dtau, dV_phi_dtau]\n\ndef parallel_transport_solver(curve, curve_dot, t_span, V_initial):\n    \"\"\"\n    Numerically solves the parallel transport ODE for a given vector.\n    \n    Args:\n        curve (callable): Function defining the curve c(tau).\n        curve_dot (callable): Function defining the curve's derivative c'(tau).\n        t_span (tuple): The integration interval (start, end).\n        V_initial (np.ndarray): The initial vector components.\n    \n    Returns:\n        np.ndarray: The components of the transported vector at the end of the interval.\n    \"\"\"\n    sol = solve_ivp(\n        fun=dV_dtau_func,\n        t_span=t_span,\n        y0=V_initial,\n        args=(curve, curve_dot),\n        method='DOP853',\n        dense_output=True,\n        rtol=1e-12,\n        atol=1e-12\n    )\n    return sol.y[:, -1]\n\ndef solve():\n    \"\"\"\n    Runs the four test cases for parallel transport and prints the results.\n    \"\"\"\n    results = []\n    \n    # Test A: Equator path\n    s_A, t_A = 0.0, 1.25\n    curve_A = lambda tau: np.array([np.pi / 2, tau])\n    curve_dot_A = lambda tau: np.array([0.0, 1.0])\n    V_initial_A = np.array([0.3, 0.4])\n    V_final_A = parallel_transport_solver(curve_A, curve_dot_A, (s_A, t_A), V_initial_A)\n    result_A = np.linalg.norm(V_final_A - V_initial_A)\n    results.append(result_A)\n\n    # Test B: Meridian path\n    theta_0, theta_1, phi_0 = 0.7, 1.4, 0.3\n    s_B, t_B = 0.0, theta_1 - theta_0\n    curve_B = lambda tau: np.array([theta_0 + tau, phi_0])\n    curve_dot_B = lambda tau: np.array([1.0, 0.0])\n    V_initial_B = np.array([0.1, 0.8])\n    V_final_B_num = parallel_transport_solver(curve_B, curve_dot_B, (s_B, t_B), V_initial_B)\n    V_final_B_analytic = np.array([\n        V_initial_B[0],\n        V_initial_B[1] * np.sin(theta_0) / np.sin(theta_1)\n    ])\n    result_B = np.linalg.norm(V_final_B_num - V_final_B_analytic)\n    results.append(result_B)\n\n    # Test C: Reversibility\n    s_C, t_C = 0.0, 1.0\n    curve_C = lambda tau: np.array([0.4 * np.pi + 0.2 * np.sin(tau), 0.1 + 1.3 * tau + 0.2 * np.sin(2 * tau)])\n    curve_dot_C = lambda tau: np.array([0.2 * np.cos(tau), 1.3 + 0.4 * np.cos(2 * tau)])\n    V_initial_C = np.array([0.5, -0.3])\n    V_at_t_C = parallel_transport_solver(curve_C, curve_dot_C, (s_C, t_C), V_initial_C)\n    V_back_at_s_C = parallel_transport_solver(curve_C, curve_dot_C, (t_C, s_C), V_at_t_C)\n    result_C = np.linalg.norm(V_back_at_s_C - V_initial_C)\n    results.append(result_C)\n\n    # Test D: Frame-based vs. direct transport\n    s_D, t_D = 0.0, 0.6\n    curve_D = lambda tau: np.array([0.2 + 0.1 * tau, 2 * tau + 0.1 * np.sin(3 * tau)])\n    curve_dot_D = lambda tau: np.array([0.1, 2.0 + 0.3 * np.cos(3 * tau)])\n    V_initial_D = np.array([0.7, 0.9])\n    \n    # Direct transport of the vector\n    V_final_direct = parallel_transport_solver(curve_D, curve_dot_D, (s_D, t_D), V_initial_D)\n\n    # Frame-based transport\n    theta_s = curve_D(s_D)[0]\n    E1_s = np.array([1.0, 0.0])\n    E2_s = np.array([0.0, 1.0 / np.sin(theta_s)])\n    \n    E1_t = parallel_transport_solver(curve_D, curve_dot_D, (s_D, t_D), E1_s)\n    E2_t = parallel_transport_solver(curve_D, curve_dot_D, (s_D, t_D), E2_s)\n    \n    # Decompose V_initial in the initial frame and reconstruct at the end\n    a1 = V_initial_D[0]\n    a2 = V_initial_D[1] * np.sin(theta_s)\n    \n    V_final_frame = a1 * E1_t + a2 * E2_t\n    \n    result_D = np.linalg.norm(V_final_direct - V_final_frame)\n    results.append(result_D)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2986923"}, {"introduction": "在掌握了对单个联络的计算后，这项高级理论练习将我们引向更抽象的层面：探索不同联络之间的关系。当你对一个联络施加一个微小的扰动时，相应的平行输运映射会如何改变？这个练习要求你从基本定义出发，推导出这种变化的一阶近似，这不仅是高级几何中的一项核心技能，也在规范场论等物理领域有着深刻的应用。[@problem_id:2986896]", "problem": "设 $(M,g)$ 是一个光滑黎曼流形，其Levi-Civita联络为 $\\nabla$。设 $\\nabla'$ 是切丛 $TM$ 上的另一个线性联络，使得对于任意光滑向量场 $X,Y$，其差由一个张量 $A \\in T^{\\ast}M \\otimes \\mathrm{End}(TM)$ 给出，即 $$(\\nabla' - \\nabla)_{X} Y \\;=\\; A(X)Y.$$ 固定一条光滑曲线 $\\gamma : [0,t] \\to M$，其速度为 $\\dot{\\gamma}$，起始点为 $\\gamma(0) \\in M$。对每个 $\\varepsilon \\in \\mathbb{R}$，定义一个单参数联络族 $$\\nabla^{\\varepsilon} \\;=\\; \\nabla + \\varepsilon A.$$ 设 $P^{\\varepsilon}_{t\\leftarrow s} : T_{\\gamma(s)}M \\to T_{\\gamma(t)}M$ 表示与 $\\nabla^{\\varepsilon}$ 相伴的、沿着 $\\gamma$ 从 $s$ 到 $t$ 的平行输运，并记 $P^{0}_{t\\leftarrow s}$ 为与 $\\nabla$ 相伴的平行输运。\n\n仅使用平行输运作为沿 $\\gamma$ 的一阶常微分方程 (ODE) 解的定义性质，推导一阶变分算子 $$\\Delta P_{t} \\;=\\; \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} P^{\\varepsilon}_{t\\leftarrow 0} : T_{\\gamma(0)}M \\to T_{\\gamma(t)}M$$ 的一个显式闭式解析表达式，该表达式用 $A(\\dot{\\gamma})$ 和基底输运 $P^{0}_{t\\leftarrow s}$ 表示。你的答案必须是写成沿 $\\gamma$ 的积分的单个表达式，并且必须是精确的（没有近似或舍入）。不要陈述或使用任何预先推导的变分公式；从平行输运的ODE定义和线性积分方程的基本性质出发。", "solution": "问题要求推导平行输运算子的一阶变分。我们从平行输运作为一阶常微分方程 (ODE) 解的基本定义出发。\n\n设 $v_0 \\in T_{\\gamma(0)}M$ 为一个任意初始向量。对每个 $\\varepsilon \\in \\mathbb{R}$，设 $V^\\varepsilon(s)$ 是通过关于联络 $\\nabla^\\varepsilon$ 平行输运 $v_0$ 得到的沿曲线 $\\gamma$ 的向量场。根据定义，$V^\\varepsilon(s) = P^{\\varepsilon}_{s \\leftarrow 0} v_0$。向量场 $V^\\varepsilon(s)$ 是以下初值问题的唯一解：\n$$\n\\begin{cases}\n\\nabla^{\\varepsilon}_{\\dot{\\gamma}(s)} V^\\varepsilon(s) = 0 & \\text{对于 } s \\in [0,t] \\\\\nV^\\varepsilon(0) = v_0\n\\end{cases}\n$$\n联络 $\\nabla^\\varepsilon$ 定义为 $\\nabla^\\varepsilon = \\nabla + \\varepsilon A$，其中 $\\nabla = \\nabla^0$ 是Levi-Civita联络。将此代入ODE，得到：\n$$\n\\nabla_{\\dot{\\gamma}(s)} V^\\varepsilon(s) + \\varepsilon A(\\dot{\\gamma}(s)) V^\\varepsilon(s) = 0\n$$\n这是一个关于单参数向量场族 $V^\\varepsilon(s)$ 的方程。我们关心其在 $\\varepsilon=0$ 处的一阶变分。让我们定义变分向量场 $\\dot{V}(s)$ 为：\n$$\n\\dot{V}(s) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} V^\\varepsilon(s)\n$$\n假设 $V^\\varepsilon(s)$ 是 $\\varepsilon$ 的光滑函数，我们可以对该ODE关于 $\\varepsilon$ 求导。协变导数 $\\nabla_{\\dot{\\gamma}(s)}$ 作为关于参数 $s$ 的线性微分算子，其系数不依赖于 $\\varepsilon$。因此，我们可以交换求导顺序：\n$$\n\\frac{d}{d\\varepsilon} \\left( \\nabla_{\\dot{\\gamma}(s)} V^\\varepsilon(s) \\right) = \\nabla_{\\dot{\\gamma}(s)} \\left(\\frac{d}{d\\varepsilon} V^\\varepsilon(s) \\right)\n$$\n对ODE的第二项应用乘法法则，我们得到：\n$$\n\\frac{d}{d\\varepsilon} \\left( \\varepsilon A(\\dot{\\gamma}(s)) V^\\varepsilon(s) \\right) = A(\\dot{\\gamma}(s)) V^\\varepsilon(s) + \\varepsilon A(\\dot{\\gamma}(s)) \\frac{d}{d\\varepsilon}V^\\varepsilon(s)\n$$\n对整个ODE关于 $\\varepsilon$ 求导，得出：\n$$\n\\nabla_{\\dot{\\gamma}(s)} \\left(\\frac{d}{d\\varepsilon} V^\\varepsilon(s) \\right) + A(\\dot{\\gamma}(s)) V^\\varepsilon(s) + \\varepsilon A(\\dot{\\gamma}(s)) \\frac{d}{d\\varepsilon}V^\\varepsilon(s) = 0\n$$\n现在，我们令 $\\varepsilon=0$。设 $V^0(s) = V^\\varepsilon(s)|_{\\varepsilon=0} = P^0_{s \\leftarrow 0} v_0$ 是使用基底联络 $\\nabla$ 平行输运的向量场。在 $\\varepsilon=0$ 时，该方程简化为关于变分场 $\\dot{V}(s)$ 的一个ODE：\n$$\n\\nabla_{\\dot{\\gamma}(s)} \\dot{V}(s) + A(\\dot{\\gamma}(s)) V^0(s) = 0\n$$\n这是一个关于 $\\dot{V}(s)$ 沿 $\\gamma$ 的非齐次线性一阶ODE：\n$$\n\\nabla_{\\dot{\\gamma}(s)} \\dot{V}(s) = -A(\\dot{\\gamma}(s)) V^0(s)\n$$\n为了解这个ODE，我们需要 $\\dot{V}(s)$ 在 $s=0$ 处的初始条件。$V^\\varepsilon(s)$ 的初始条件是 $V^\\varepsilon(0) = v_0$，它与 $\\varepsilon$ 无关。因此，\n$$\n\\dot{V}(0) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} V^\\varepsilon(0) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} v_0 = 0\n$$\n我们现在必须求解这个初值问题：\n$$\n\\begin{cases}\n\\nabla_{\\dot{\\gamma}(s)} \\dot{V}(s) = -A(\\dot{\\gamma}(s)) V^0(s) \\\\\n\\dot{V}(0) = 0\n\\end{cases}\n$$\n这类方程可以使用类似于常数变易法的方法求解，该方法由Duhamel原理所概括。对于一个具有初始条件 $X(0)$ 的一般非齐次方程 $\\nabla_{\\dot{\\gamma}(s)} X(s) = F(s)$，其解由下式给出：\n$$\nX(t) = P^0_{t \\leftarrow 0} X(0) + \\int_0^t P^0_{t \\leftarrow s} F(s) ds\n$$\n其中 $P^0_{t \\leftarrow s}$ 是齐次方程（即对于 $\\nabla$）的平行输运算子。在我们的情况中，向量场是 $\\dot{V}(s)$，强迫项是 $F(s) = -A(\\dot{\\gamma}(s)) V^0(s)$，初始条件是 $\\dot{V}(0)=0$。将这些代入通解，得到：\n$$\n\\dot{V}(t) = P^0_{t \\leftarrow 0} (0) + \\int_0^t P^0_{t \\leftarrow s} \\left( -A(\\dot{\\gamma}(s)) V^0(s) \\right) ds\n$$\n$$\n\\dot{V}(t) = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) V^0(s) ds\n$$\n现在，我们代入 $V^0(s)$ 的表达式，它是初始向量 $v_0$ 关于 $\\nabla$ 的平行输运：$V^0(s) = P^0_{s \\leftarrow 0} v_0$。这得出：\n$$\n\\dot{V}(t) = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) (P^0_{s \\leftarrow 0} v_0) ds\n$$\n我们寻求的算子是 $\\Delta P_t = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} P^{\\varepsilon}_{t\\leftarrow 0}$。根据其定义，它作用于初始向量 $v_0$ 如下：\n$$\n(\\Delta P_t) v_0 = \\left( \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} P^{\\varepsilon}_{t\\leftarrow 0} \\right) v_0 = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} (P^{\\varepsilon}_{t\\leftarrow 0} v_0) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} V^\\varepsilon(t) = \\dot{V}(t)\n$$\n因此，我们有：\n$$\n(\\Delta P_t) v_0 = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} v_0 ds\n$$\n这个方程可以重写为：\n$$\n(\\Delta P_t) v_0 = \\left( - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} ds \\right) v_0\n$$\n因为这个等式对任意初始向量 $v_0 \\in T_{\\gamma(0)}M$ 都成立，所以我们可以直接令算子相等。该积分定义了一个从 $T_{\\gamma(0)}M$ 到 $T_{\\gamma(t)}M$ 的线性映射。对于每个 $s \\in [0,t]$，被积项是线性映射的复合：首先是 $P^0_{s \\leftarrow 0}: T_{\\gamma(0)}M \\to T_{\\gamma(s)}M$，然后是 $A(\\dot{\\gamma}(s)): T_{\\gamma(s)}M \\to T_{\\gamma(s)}M$，最后是 $P^0_{t \\leftarrow s}: T_{\\gamma(s)}M \\to T_{\\gamma(t)}M$。所得到的一阶变分算子的表达式是：\n$$\n\\Delta P_{t} = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} ds\n$$\n这就是所要求的、按要求从第一性原理推导出的显式闭式解析表达式。", "answer": "$$\n\\boxed{- \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} ds}\n$$", "id": "2986896"}]}