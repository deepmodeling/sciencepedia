{"hands_on_practices": [{"introduction": "列维-奇维塔联络由无挠和度量兼容这两个条件唯一确定，而这些条件通过科祖尔公式 (Koszul formula) 给出了联络的具体表达式。本练习将引导你从第一性原理出发，证明在任意坐标基下，无挠性直接导致了克氏符号 (Christoffel symbols) 对下指标的对称性。通过这个推导，你将加深对联络基本公理如何转化为其分量具体代数性质的理解。[@problem_id:2974988]", "problem": "设 $\\left(M,g\\right)$ 是一个光滑黎曼流形，其在开集 $U \\subset M$ 上的局部坐标为 $\\left(x^{1},\\dots,x^{n}\\right)$，并令 $\\partial_{i} = \\frac{\\partial}{\\partial x^{i}}$ 表示坐标向量场。Levi-Civita 联络是唯一的无挠且度量兼容的仿射联络。Koszul 公式用黎曼度量及其导数表示 Levi-Civita 联络。\n\n通过 $\\nabla_{\\partial_{i}}\\partial_{j} = \\Gamma_{ij}^{k}\\,\\partial_{k}$ 定义带有一个上指标的 Christoffel 符号 $\\Gamma_{ij}^{k}$，并通过 $\\Gamma_{ijk} := g\\!\\left(\\nabla_{\\partial_{i}}\\partial_{j},\\partial_{k}\\right) = g_{k\\ell}\\,\\Gamma_{ij}^{\\ell}$ 定义所有指标均在下方的 Christoffel 符号，其中 $g_{ij} := g\\!\\left(\\partial_{i},\\partial_{j}\\right)$。\n\n从 Levi-Civita 联络的定义性质和 Koszul 公式出发，在 $U$ 上的坐标标架中，将 $X=\\partial_{i}$，$Y=\\partial_{j}$，$Z=\\partial_{k}$ 代入 Koszul 表达式并完全化简。然后计算 $\\Gamma_{ijk} - \\Gamma_{jik}$ 的值。\n\n你的最终答案必须是一个单一的闭式表达式。无需四舍五入，也不涉及单位。", "solution": "该问题要求我们首先在坐标基中计算 Levi-Civita 联络的 Koszul 表达式，然后利用此结果计算量 $\\Gamma_{ijk} - \\Gamma_{jik}$。\n\n在黎曼流形 $(M,g)$ 上，Levi-Civita 联络（记作 $\\nabla$）是满足以下两个基本性质的唯一仿射联络：\n1.  **度量兼容性**：度量关于该联络是平行的，即 $\\nabla g = 0$。对于任意向量场 $X$、$Y$ 和 $Z$，这可以表示为：\n    $$X(g(Y,Z)) = g(\\nabla_X Y, Z) + g(Y, \\nabla_X Z)$$\n2.  **无挠性**：挠率张量为零，即 $T(X,Y) = 0$。这等价于以下条件：\n    $$\\nabla_X Y - \\nabla_Y X = [X,Y]$$\n    其中 $[X,Y]$ 是向量场 $X$ 和 $Y$ 的李括号。\n\n这两个性质足以推导出科祖尔公式，该公式用度量及其导数给出了联络的显式表达式。对于任意向量场 $X, Y, Z$，该公式为：\n$$2g(\\nabla_X Y, Z) = X(g(Y,Z)) + Y(g(X,Z)) - Z(g(X,Y)) + g([X,Y],Z) + g([Z,X],Y) + g([Y,Z],X)$$\n问题要求我们对坐标基向量场 $X=\\partial_{i}$，$Y=\\partial_{j}$ 和 $Z=\\partial_{k}$ 计算此表达式，其中 $\\partial_{i} = \\frac{\\partial}{\\partial x^{i}}$。\n\n首先，我们将所选的向量场代入科祖尔公式中的各项：\n- 左边项变为 $2g(\\nabla_{\\partial_{i}}\\partial_{j}, \\partial_{k})$。根据定义，第一类 Christoffel 符号为 $\\Gamma_{ijk} := g(\\nabla_{\\partial_{i}}\\partial_{j}, \\partial_{k})$。因此，左边项为 $2\\Gamma_{ijk}$。\n- 涉及度量及其导数的项为：\n  - $X(g(Y,Z)) = \\partial_{i}(g(\\partial_{j}, \\partial_{k})) = \\partial_{i}(g_{jk})$，其中 $g_{jk}$ 是度量张量的分量。\n  - $Y(g(X,Z)) = \\partial_{j}(g(\\partial_{i}, \\partial_{k})) = \\partial_{j}(g_{ik})$。\n  - $Z(g(X,Y)) = \\partial_{k}(g(\\partial_{i}, \\partial_{j})) = \\partial_{k}(g_{ij})$。\n- 涉及李括号的项取决于坐标向量场的一个关键性质：它们的李括号为零。\n  - $[\\partial_{i}, \\partial_{j}] = \\frac{\\partial}{\\partial x^i}\\frac{\\partial}{\\partial x^j} - \\frac{\\partial}{\\partial x^j}\\frac{\\partial}{\\partial x^i} = 0$，这是因为当作用于光滑函数时，根据混合偏导数的相等性（克莱罗定理），其结果为零。\n  - 因此，科祖尔公式中所有含李括号的项都为零：\n    - $g([X,Y],Z) = g([\\partial_{i},\\partial_{j}],\\partial_{k}) = g(0, \\partial_{k}) = 0$。\n    - $g([Z,X],Y) = g([\\partial_{k},\\partial_{i}],\\partial_{j}) = g(0, \\partial_{j}) = 0$。\n    - $g([Y,Z],X) = g([\\partial_{j},\\partial_{k}],\\partial_{i}) = g(0, \\partial_{i}) = 0$。\n\n将这些结果代入科祖尔公式，我们得到：\n$$2\\Gamma_{ijk} = \\partial_{i}g_{jk} + \\partial_{j}g_{ik} - \\partial_{k}g_{ij} + 0 + 0 + 0$$\n这就给出了用度量分量的偏导数表示的第一类 Christoffel 符号的显式表达式：\n$$\\Gamma_{ijk} = \\frac{1}{2}\\left(\\partial_{i}g_{jk} + \\partial_{j}g_{ik} - \\partial_{k}g_{ij}\\right)$$\n至此，任务的第一部分完成。\n\n接下来，我们必须计算量 $\\Gamma_{ijk} - \\Gamma_{jik}$。为了找到 $\\Gamma_{jik}$ 的表达式，我们只需在我们刚推导出的公式中交换指标 $i$ 和 $j$：\n$$\\Gamma_{jik} = \\frac{1}{2}\\left(\\partial_{j}g_{ik} + \\partial_{i}g_{jk} - \\partial_{k}g_{ji}\\right)$$\n现在我们计算它们的差：\n$$\\Gamma_{ijk} - \\Gamma_{jik} = \\frac{1}{2}\\left(\\partial_{i}g_{jk} + \\partial_{j}g_{ik} - \\partial_{k}g_{ij}\\right) - \\frac{1}{2}\\left(\\partial_{j}g_{ik} + \\partial_{i}g_{jk} - \\partial_{k}g_{ji}\\right)$$\n我们可以将这些项合并到一个分数下：\n$$\\Gamma_{ijk} - \\Gamma_{jik} = \\frac{1}{2}\\left( (\\partial_{i}g_{jk} + \\partial_{j}g_{ik} - \\partial_{k}g_{ij}) - (\\partial_{j}g_{ik} + \\partial_{i}g_{jk} - \\partial_{k}g_{ji}) \\right)$$\n分配负号并重新排列各项，按偏导数进行分组，得到：\n$$\\Gamma_{ijk} - \\Gamma_{jik} = \\frac{1}{2}\\left( (\\partial_{i}g_{jk} - \\partial_{i}g_{jk}) + (\\partial_{j}g_{ik} - \\partial_{j}g_{ik}) + (-\\partial_{k}g_{ij} + \\partial_{k}g_{ji}) \\right)$$\n前两对项相互抵消：\n$$\\Gamma_{ijk} - \\Gamma_{jik} = \\frac{1}{2}\\left( 0 + 0 - \\partial_{k}g_{ij} + \\partial_{k}g_{ji} \\right) = \\frac{1}{2}\\left( \\partial_{k}g_{ji} - \\partial_{k}g_{ij} \\right)$$\n度量张量 $g$ 是一个对称的 $(0,2)$-张量，这意味着它在任何基下的分量都是对称的。在坐标基中，此性质表示为 $g_{ij} = g(\\partial_i, \\partial_j) = g(\\partial_j, \\partial_i) = g_{ji}$。由于这些分量作为流形上的函数是相等的，它们的偏导数也相等：$\\partial_{k}g_{ji} = \\partial_{k}g_{ij}$。\n\n将此代入我们的表达式中，得到：\n$$\\Gamma_{ijk} - \\Gamma_{jik} = \\frac{1}{2}\\left( \\partial_{k}g_{ij} - \\partial_{k}g_{ij} \\right) = \\frac{1}{2}(0) = 0$$\n此结果表明第一类 Christoffel 符号 $\\Gamma_{ijk}$ 在其前两个指标上是对称的。这直接反映了 Levi-Civita 联络的无挠性质（$\\Gamma^k_{ij} = \\Gamma^k_{ji}$），因为科祖尔公式本身就是基于无挠和度量兼容这两个条件推导出来的。", "answer": "$$\\boxed{0}$$", "id": "2974988"}, {"introduction": "在建立了基本理论之后 [@problem_id:2974988]，下一步是在具体场景中应用这些概念。极坐标下的欧几里得平面是一个理想的练习场，因为它的坐标基向量 $\\partial_r$ 和 $\\partial_\\theta$ 的长度并非都是常数，这使得计算更具一般性和启发性。本练习要求你将科祖尔公式应用于极坐标度量 $g=dr^{2}+r^{2}d\\theta^{2}$，通过计算度量分量的导数来求出非零的克氏符号。这项动手计算对于建立几何直觉至关重要，它揭示了空间的几何性质如何被编码在源自度量本身的联络系数中。[@problem_id:2974981]", "problem": "设 $M=\\{(r,\\theta)\\in \\mathbb{R}^{2}\\mid r>0\\}$ 是一个挖去原点的平面，其上赋有极坐标黎曼度量 $g=dr^{2}+r^{2}d\\theta^{2}$。考虑坐标向量场 $X_{1}=\\partial_{r}$ 和 $X_{2}=\\partial_{\\theta}$，它们满足对易关系 $[X_{2},X_{1}]=0$。Levi-Civita 联络的特征是无挠性和度量兼容性。仅从这两个特征和度量 $g$ 出发，推导确定坐标标架上联络 $\\nabla$ 所需的内积恒等式，并用它们计算在基 $\\{\\partial_{r},\\partial_{\\theta}\\}$ 下由 $\\nabla_{X_{i}}X_{j}=\\Gamma^{k}_{ij}X_{k}$ 定义的 Christoffel 符号 $\\Gamma^{k}_{ij}$。特别地，计算内积 $g(\\nabla_{\\partial_{\\theta}}\\partial_{\\theta},\\partial_{r})$、$g(\\nabla_{\\partial_{r}}\\partial_{\\theta},\\partial_{\\theta})$ 和 $g(\\nabla_{\\partial_{\\theta}}\\partial_{r},\\partial_{\\theta})$，并仔细考虑 $\\theta$ 方向上的非标准正交缩放以及对易子 $[\\partial_{\\theta},\\partial_{r}]=0$。\n\n将最终答案表示为包含不同非零 Christoffel 符号 $(\\Gamma^{r}_{\\theta\\theta},\\Gamma^{\\theta}_{r\\theta},\\Gamma^{\\theta}_{\\theta r})$ 的行矩阵，以 $r$ 的函数的闭形式表示。无需四舍五入。", "solution": "任务是确定在赋予了极坐标黎曼度量的流形 $M = \\{(r,\\theta)\\in \\mathbb{R}^{2}\\mid r>0\\}$ 上 Levi-Civita 联络 $\\nabla$ 的具体 Christoffel 符号。我们从 Levi-Civita 联络 $\\nabla$ 的基本性质出发：它是无挠的且与度量 $g$ 兼容。\n\n给定的坐标系是 $(r, \\theta)$，其坐标向量场为 $X_{1} = \\partial_{r}$ 和 $X_{2} = \\partial_{\\theta}$。度量为 $g = dr^{2} + r^{2}d\\theta^{2}$。度量张量 $g_{ij} = g(X_i, X_j)$ 的分量为：\n$$\ng_{11} = g(\\partial_r, \\partial_r) = 1\n$$\n$$\ng_{22} = g(\\partial_\\theta, \\partial_\\theta) = r^2\n$$\n$$\ng_{12} = g_{21} = g(\\partial_r, \\partial_\\theta) = 0\n$$\n基 $\\{\\partial_r, \\partial_\\theta\\}$ 是正交的但非标准正交的，因为 $g_{22}$ 是 $r$ 的函数。\n\nLevi-Civita 联络由两个条件唯一确定：\n1.  度量兼容性：对于任意向量场 $X, Y, Z$，有 $X(g(Y,Z)) = g(\\nabla_X Y, Z) + g(Y, \\nabla_X Z)$。\n2.  无挠性：对于任意向量场 $X, Y, Z$，有 $\\nabla_X Y - \\nabla_Y X = [X,Y]$。\n\n这两个条件导出了联络的科祖尔公式：\n$$\n2g(\\nabla_X Y, Z) = X(g(Y,Z)) + Y(g(Z,X)) - Z(g(X,Y)) + g([X,Y], Z) - g([X,Z], Y) - g([Y,Z], X)\n$$\n在坐标基中，例如 $\\{X_i\\} = \\{\\partial_r, \\partial_\\theta\\}$，任意两个基向量的李括号为零：$[X_i, X_j] = [\\partial_i, \\partial_j] = 0$。问题正确地指出了对于给定基 $[\\partial_\\theta, \\partial_r] = 0$ 成立。在这种情况下，科祖尔公式显著简化。令 $X=X_i, Y=X_j, Z=X_k$，我们得到：\n$$\n2g(\\nabla_{X_i} X_j, X_k) = X_i(g(X_j, X_k)) + X_j(g(X_k, X_i)) - X_k(g(X_i, X_j))\n$$\n用度量分量 $g_{ij}$ 表示，即为：\n$$\n2g(\\nabla_{\\partial_i} \\partial_j, \\partial_k) = \\partial_i g_{jk} + \\partial_j g_{ik} - \\partial_k g_{ij}\n$$\n我们使用此公式来计算所需的内积。设 $x^1=r$ 和 $x^2=\\theta$，则 $\\partial_1 = \\partial_r$ 和 $\\partial_2 = \\partial_\\theta$。\n\n1.  计算 $g(\\nabla_{\\partial_{\\theta}}\\partial_{\\theta},\\partial_{r})$：\n    我们令 $i=2$，$j=2$，$k=1$。\n    $$\n    2g(\\nabla_{\\partial_\\theta} \\partial_\\theta, \\partial_r) = \\partial_\\theta(g(\\partial_\\theta, \\partial_r)) + \\partial_\\theta(g(\\partial_r, \\partial_\\theta)) - \\partial_r(g(\\partial_\\theta, \\partial_\\theta))\n    $$\n    使用度量分量 $g_{21}=0$，$g_{12}=0$ 和 $g_{22}=r^2$：\n    $$\n    2g(\\nabla_{\\partial_\\theta} \\partial_\\theta, \\partial_r) = \\partial_\\theta(0) + \\partial_\\theta(0) - \\partial_r(r^2) = 0 + 0 - 2r = -2r\n    $$\n    因此，\n    $$\n    g(\\nabla_{\\partial_{\\theta}}\\partial_{\\theta},\\partial_{r}) = -r\n    $$\n\n2.  计算 $g(\\nabla_{\\partial_{r}}\\partial_{\\theta},\\partial_{\\theta})$：\n    我们令 $i=1$，$j=2$，$k=2$。\n    $$\n    2g(\\nabla_{\\partial_r} \\partial_\\theta, \\partial_\\theta) = \\partial_r(g(\\partial_\\theta, \\partial_\\theta)) + \\partial_\\theta(g(\\partial_\\theta, \\partial_r)) - \\partial_\\theta(g(\\partial_r, \\partial_\\theta))\n    $$\n    使用度量分量 $g_{22}=r^2$，$g_{21}=0$ 和 $g_{12}=0$：\n    $$\n    2g(\\nabla_{\\partial_r} \\partial_\\theta, \\partial_\\theta) = \\partial_r(r^2) + \\partial_\\theta(0) - \\partial_\\theta(0) = 2r + 0 - 0 = 2r\n    $$\n    因此，\n    $$\n    g(\\nabla_{\\partial_{r}}\\partial_{\\theta},\\partial_{\\theta}) = r\n    $$\n\n3.  计算 $g(\\nabla_{\\partial_{\\theta}}\\partial_{r},\\partial_{\\theta})$：\n    我们令 $i=2$，$j=1$，$k=2$。\n    $$\n    2g(\\nabla_{\\partial_\\theta} \\partial_r, \\partial_\\theta) = \\partial_\\theta(g(\\partial_r, \\partial_\\theta)) + \\partial_r(g(\\partial_\\theta, \\partial_\\theta)) - \\partial_\\theta(g(\\partial_\\theta, \\partial_r))\n    $$\n    使用度量分量 $g_{12}=0$，$g_{22}=r^2$ 和 $g_{21}=0$：\n    $$\n    2g(\\nabla_{\\partial_\\theta} \\partial_r, \\partial_\\theta) = \\partial_\\theta(0) + \\partial_r(r^2) - \\partial_\\theta(0) = 0 + 2r - 0 = 2r\n    $$\n    因此，\n    $$\n    g(\\nabla_{\\partial_{\\theta}}\\partial_{r},\\partial_{\\theta}) = r\n    $$\n    正如预期的，由于联络是无挠的且基向量是对易的，我们有 $\\nabla_{\\partial_r}\\partial_\\theta = \\nabla_{\\partial_\\theta}\\partial_r$，这意味着 $g(\\nabla_{\\partial_r}\\partial_\\theta, \\partial_\\theta) = g(\\nabla_{\\partial_\\theta}\\partial_r, \\partial_\\theta)$。\n\n接下来，我们使用这些内积来求 Christoffel 符号 $\\Gamma^k_{ij}$，它由关系式 $\\nabla_{X_i}X_j = \\Gamma^k_{ij}X_k$ 定义（对 $k$ 使用爱因斯坦求和约定）。\n\n为了求 $\\Gamma^r_{\\theta\\theta} = \\Gamma^1_{22}$：\n我们写出 $\\nabla_{\\partial_\\theta}\\partial_\\theta = \\Gamma^1_{22}\\partial_r + \\Gamma^2_{22}\\partial_\\theta$。与 $\\partial_r$ 作内积：\n$$\ng(\\nabla_{\\partial_\\theta}\\partial_\\theta, \\partial_r) = g(\\Gamma^1_{22}\\partial_r + \\Gamma^2_{22}\\partial_\\theta, \\partial_r) = \\Gamma^1_{22}g(\\partial_r, \\partial_r) + \\Gamma^2_{22}g(\\partial_\\theta, \\partial_r)\n$$\n使用 $g_{11}=1$ 和 $g_{21}=0$，我们有：\n$$\ng(\\nabla_{\\partial_\\theta}\\partial_\\theta, \\partial_r) = \\Gamma^1_{22}(1) + \\Gamma^2_{22}(0) = \\Gamma^1_{22}\n$$\n根据我们之前的计算，$g(\\nabla_{\\partial_{\\theta}}\\partial_{\\theta},\\partial_{r}) = -r$。因此，\n$$\n\\Gamma^r_{\\theta\\theta} = -r\n$$\n\n为了求 $\\Gamma^\\theta_{r\\theta} = \\Gamma^2_{12}$：\n我们写出 $\\nabla_{\\partial_r}\\partial_\\theta = \\Gamma^1_{12}\\partial_r + \\Gamma^2_{12}\\partial_\\theta$。与 $\\partial_\\theta$ 作内积：\n$$\ng(\\nabla_{\\partial_r}\\partial_\\theta, \\partial_\\theta) = g(\\Gamma^1_{12}\\partial_r + \\Gamma^2_{12}\\partial_\\theta, \\partial_\\theta) = \\Gamma^1_{12}g(\\partial_r, \\partial_\\theta) + \\Gamma^2_{12}g(\\partial_\\theta, \\partial_\\theta)\n$$\n使用 $g_{12}=0$ 和 $g_{22}=r^2$，我们有：\n$$\ng(\\nabla_{\\partial_r}\\partial_\\theta, \\partial_\\theta) = \\Gamma^1_{12}(0) + \\Gamma^2_{12}(r^2) = r^2 \\Gamma^2_{12}\n$$\n根据我们之前的计算，$g(\\nabla_{\\partial_{r}}\\partial_{\\theta},\\partial_{\\theta}) = r$。因此，\n$$\nr = r^2 \\Gamma^2_{12} \\implies \\Gamma^\\theta_{r\\theta} = \\frac{r}{r^2} = \\frac{1}{r}\n$$\n\n为了求 $\\Gamma^\\theta_{\\theta r} = \\Gamma^2_{21}$：\n对于坐标基，无挠性 $\\nabla_{X_i}X_j - \\nabla_{X_j}X_i = [X_i, X_j] = 0$ 意味着 Christoffel 符号的下标记是对称的：$\\Gamma^k_{ij} = \\Gamma^k_{ji}$。因此，\n$$\n\\Gamma^\\theta_{\\theta r} = \\Gamma^\\theta_{r\\theta} = \\frac{1}{r}\n$$\n该结果与我们的内积计算 $g(\\nabla_{\\partial_{\\theta}}\\partial_{r},\\partial_{\\theta}) = r$ 是一致的。\n\n所要求的不同非零 Christoffel 符号为 $(\\Gamma^{r}_{\\theta\\theta}, \\Gamma^{\\theta}_{r\\theta}, \\Gamma^{\\theta}_{\\theta r})$，即 $(-r, 1/r, 1/r)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -r & \\frac{1}{r} & \\frac{1}{r} \\end{pmatrix}}\n$$", "id": "2974981"}, {"introduction": "现代几何学越来越依赖于计算方法，而列维-奇维塔联络的存在唯一性定理本质上是构造性的，其核心的科祖尔公式 [@problem_id:2974988] [@problem_id:2974981] 如同一个计算“配方”，非常适合数值实现。本练习挑战你将这一解析公式转化为一个有效的数值算法，使用有限差分来近似导数，并在环面上计算不同度量下的联络系数。通过这个实践，你将亲眼见证，在数值精度允许的范围内，无挠性和度量兼容性是如何通过构造被自动满足的，从而架起抽象理论与实用计算几何之间的桥梁。[@problem_id:2974976]", "problem": "设 $M$ 是一个维数为 $n$ 的紧致光滑流形，其上赋有一个 $C^2$ 类的黎曼度量 $g$。Levi-Civita 联络的特征是无挠且与度量兼容。您的任务是，从第一性原理出发，在一个坐标图上实现一个数值方案，以从度量 $g$ 中近似计算联络系数（Christoffel 符号）$\\Gamma^k_{ij}$，其中使用有限差分来近似计算所需的偏导数，然后数值地评估其无挠性和度量兼容性。\n\n请基于以下基本定义和事实进行推导和算法设计，不要预设任何快捷公式：\n- 黎曼度量是在每个切空间 $T_pM$ 上的一个光滑变化的正定对称双线性形式 $g_p$。\n- 仿射联络 $\\nabla$ 是一个满足 Leibniz 法则的向量场上的双线性映射。\n- 联络的挠率是张量 $T(X,Y) = \\nabla_X Y - \\nabla_Y X - [X,Y]$；无挠意味着 $T=0$。\n- 度量兼容意味着 $\\nabla g = 0$，等价于对所有向量场 $X,Y,Z$ 都有 $X \\cdot g(Y,Z) = g(\\nabla_X Y, Z) + g(Y, \\nabla_X Z)$。\n\n请在局部坐标中进行工作，并实现一个中心有限差分格式来近似 $g_{ij}$ 的偏导数，并从这些导数中逐点地恢复唯一的无挠、度量兼容的联络系数 $\\Gamma^k_{ij}$。然后，数值地评估：\n- 挠率张量分量 $T^k_{ij} = \\Gamma^k_{ij} - \\Gamma^k_{ji}$。\n- 度量的协变导数 $\\nabla_k g_{ij} = \\partial_k g_{ij} - \\Gamma^l_{k i} g_{l j} - \\Gamma^l_{k j} g_{i l}$。\n\n实现场景和离散化：\n- 使用二维环面 $\\mathbb{T}^2$，它实现为 $\\mathbb{R}^2$ 对 $(2\\pi\\mathbb{Z})^2$ 的商，并带有全局坐标 $(x,y)$。\n- 通过一个具有周期性边界条件的均匀 $N \\times N$ 网格来离散化区域 $[0,2\\pi) \\times [0,2\\pi)$。使用 $N = 64$。\n- 使用带周期性环绕的中心有限差分来近似 $\\partial_x$ 和 $\\partial_y$。网格间距必须为 $h_x = 2\\pi/N$ 和 $h_y = 2\\pi/N$。\n- 所有角度必须以弧度处理。\n\n测试套件：\n在 $\\mathbb{T}^2$ 上定义的以下三个黎曼度量上实现该方案：\n1. 平坦环面度量（理想情况）：$g_{11}(x,y) = 1$，$g_{22}(x,y) = 1$，$g_{12}(x,y) = g_{21}(x,y) = 0$。\n2. 共形平坦变化度量：$g_{11}(x,y) = e^{\\phi(x,y)}$，$g_{22}(x,y) = e^{\\phi(x,y)}$，$g_{12}(x,y) = g_{21}(x,y) = 0$，其中 $\\phi(x,y) = 0.3 \\sin(x) \\cos(y)$。\n3. 带有非对角项的各向异性度量（保持正定的边缘情况）：$g_{11}(x,y) = 1 + 0.2 \\sin(x)$，$g_{22}(x,y) = 1 + 0.3 \\cos(y)$，$g_{12}(x,y) = g_{21}(x,y) = 0.15 \\cos(x+y)$。\n\n对于每个度量，计算：\n- 网格和所有指标上的最大绝对挠率值，定义为 $\\max_{k,i,j,x,y} \\left| T^k_{ij}(x,y) \\right|$。\n- 网格和所有指标上的最大绝对度量兼容性残差，定义为 $\\max_{k,i,j,x,y} \\left| \\nabla_k g_{ij}(x,y) \\right|$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含测试套件的六个结果，格式为用方括号括起来的逗号分隔列表，顺序为\n$[t_1,m_1,t_2,m_2,t_3,m_3]$，\n其中 $t_\\alpha$ 是测试用例 $\\alpha \\in \\{1,2,3\\}$ 的最大挠率值，$m_\\alpha$ 是最大度量兼容性残差。每个结果都必须是一个浮点数。角度必须以弧度为单位，并且不涉及任何物理单位。", "solution": "该问题要求实现一个数值方案，用于在二维环面上为给定的黎曼度量 ($g_{ij}$) 计算 Levi-Civita 联络的 Christoffel 符号 ($\\Gamma^k_{ij}$)。计算必须从 Levi-Civita 联络无挠和度量兼容的基本原理推导得出。随后，必须对这两个性质进行数值验证。\n\n解决方案的核心在于黎曼几何基本定理，该定理断言在黎曼流形 $(M, g)$ 上存在且唯一一个联络 $\\nabla$ 满足两个条件：\n1.  **度量兼容性 (Metric-Compatibility)**：度量相对于该联络是平行的，即 $\\nabla g = 0$。\n2.  **无挠性 (Torsion-Freeness)**：该联络是对称的，意味着其挠率张量 $T(X,Y) = \\nabla_X Y - \\nabla_Y X - [X,Y]$ 对所有向量场 $X, Y$ 均为零。\n\n我们首先在局部坐标系 $\\{x^i\\}$ 中从这两个条件推导出联络系数（第二类 Christoffel 符号）$\\Gamma^k_{ij}$ 的显式公式。基向量场为 $\\partial_i = \\partial/\\partial x^i$，它们的李括号为 $[\\partial_i, \\partial_j] = 0$。联络系数由 $\\nabla_{\\partial_i} \\partial_j = \\Gamma^k_{ij} \\partial_k$ 定义。\n\n**Christoffel 符号的推导**\n\n无挠条件 $T(\\partial_i, \\partial_j) = 0$ 意味着：\n$$ \\nabla_{\\partial_i} \\partial_j - \\nabla_{\\partial_j} \\partial_i - [\\partial_i, \\partial_j] = 0 $$\n$$ \\Gamma^k_{ij} \\partial_k - \\Gamma^k_{ji} \\partial_k - 0 = 0 $$\n这导致联络系数在其下指标上是对称的：\n$$ \\Gamma^k_{ij} = \\Gamma^k_{ji} $$\n\n度量兼容条件 $\\nabla g = 0$ 意味着度量张量的协变导数为零，即 $\\nabla_k g_{ij} = 0$。一个 $(0,2)$-张量的协变导数公式为：\n$$ \\nabla_k g_{ij} = \\partial_k g_{ij} - \\Gamma^l_{ki} g_{lj} - \\Gamma^l_{kj} g_{il} $$\n令其为零，得到关系式：\n$$ \\partial_k g_{ij} = \\Gamma^l_{ki} g_{lj} + \\Gamma^l_{kj} g_{il} \\quad \\text{(Eq. 1)} $$\n这里，$g_{ij} = g(\\partial_i, \\partial_j)$ 是度量张量的分量，$\\partial_k$ 表示偏导数 $\\partial/\\partial x^k$。\n\n为了求解 $\\Gamma^k_{ij}$，我们在方程 1 中对指标 $(i,j,k)$ 进行循环置换：\n$$ \\partial_i g_{jk} = \\Gamma^l_{ij} g_{lk} + \\Gamma^l_{ik} g_{jl} \\quad \\text{(Eq. 2)} $$\n$$ \\partial_j g_{ki} = \\Gamma^l_{jk} g_{li} + \\Gamma^l_{ji} g_{kl} \\quad \\text{(Eq. 3)} $$\n\n现在，我们计算组合 (Eq. 2) + (Eq. 3) - (Eq. 1)：\n$$ \\partial_i g_{jk} + \\partial_j g_{ik} - \\partial_k g_{ij} = (\\Gamma^l_{ij} g_{lk} + \\Gamma^l_{ik} g_{jl}) + (\\Gamma^l_{jk} g_{li} + \\Gamma^l_{ji} g_{kl}) - (\\Gamma^l_{ki} g_{lj} + \\Gamma^l_{kj} g_{il}) $$\n利用联络系数的对称性（$\\Gamma^l_{ab}=\\Gamma^l_{ba}$）和度量的对称性（$g_{ab}=g_{ba}$），有几项会相互抵消：\n- $\\Gamma^l_{ik} g_{jl} - \\Gamma^l_{ki} g_{lj} = \\Gamma^l_{ik} g_{jl} - \\Gamma^l_{ik} g_{jl} = 0$\n- $\\Gamma^l_{jk} g_{li} - \\Gamma^l_{kj} g_{il} = \\Gamma^l_{jk} g_{li} - \\Gamma^l_{jk} g_{li} = 0$\n剩下的项，利用两种对称性，得出：\n- $\\Gamma^l_{ij} g_{lk} + \\Gamma^l_{ji} g_{kl} = \\Gamma^l_{ij} g_{lk} + \\Gamma^l_{ij} g_{lk} = 2 \\Gamma^l_{ij} g_{lk}$\n因此，我们得到了第一类 Christoffel 符号 $\\Gamma_{k,ij} = g_{kl} \\Gamma^l_{ij}$ 的表达式：\n$$ 2 g_{kl} \\Gamma^l_{ij} = \\partial_i g_{jk} + \\partial_j g_{ik} - \\partial_k g_{ij} $$\n$$ \\Gamma_{k,ij} = \\frac{1}{2} ( \\partial_i g_{jk} + \\partial_j g_{ik} - \\partial_k g_{ij} ) $$\n为了获得第二类 Christoffel 符号 $\\Gamma^k_{ij}$，我们与逆度量 $g^{mk}$ 进行缩并：\n$$ \\Gamma^k_{ij} = g^{mk} \\Gamma_{m,ij} = \\frac{1}{2} g^{mk} ( \\partial_i g_{jm} + \\partial_j g_{im} - \\partial_m g_{ij} ) $$\n这就是科祖尔公式，它将联络系数完全用度量张量及其一阶偏导数来表示。这个公式是我们数值实现的基础。\n\n**数值实现**\n\n问题指定了一个 2-环面 $\\mathbb{T}^2$，坐标为 $(x,y) = (x^1, x^2)$，定义域为 $[0, 2\\pi) \\times [0, 2\\pi)$。我们将其离散化为一个均匀的 $N \\times N$ 网格，其中 $N=64$。网格间距为 $h = h_x = h_y = 2\\pi/N$。\n\n1.  **度量及其导数**：在每个网格点上评估度量分量 $g_{ij}(x,y)$，形成一个由形状为 $(N, N, 2, 2)$ 的数组表示的张量场。使用具有周期性边界条件的二阶中心有限差分格式来近似偏导数 $\\partial_k g_{ij}$。对于网格上的函数 $f(p,q)$，其导数为：\n    $$ \\partial_1 f(p,q) \\approx \\frac{f(p+1, q) - f(p-1, q)}{2h} $$\n    $$ \\partial_2 f(p,q) \\approx \\frac{f(p, q+1) - f(p, q-1)}{2h} $$\n    周期性边界通过对索引取模 $N$ 来处理。\n\n2.  **Christoffel 符号**：在每个网格点上，我们数值地评估科祖尔公式。这包括：\n    a. 在每个点上通过对 $2 \\times 2$ 矩阵 $g_{ij}$ 求逆来计算逆度量 $g^{ij}$。\n    b. 使用有限差分格式计算三个导数项 $(\\partial_i g_{jm}, \\partial_j g_{im}, \\partial_m g_{ij})$。\n    c. 根据公式组合这些项，对索引 $m$ 进行求和。我们使用优化的张量缩并来完成此步骤。\n\n3.  **数值验证**：然后我们数值地评估基本性质：\n    a. **挠率**：$T^k_{ij} = \\Gamma^k_{ij} - \\Gamma^k_{ji}$。\n    b. **度量兼容性**：$\\nabla_k g_{ij} = \\partial_k g_{ij} - \\Gamma^l_{ki} g_{lj} - \\Gamma^l_{kj} g_{il}$。\n    计算这些张量分量在整个网格上的最大绝对值。\n\n**预期结果**\n\n为 $\\Gamma^k_{ij}$ 设计的科祖尔公式在代数上保证了其下指标 $(i,j)$ 的对称性，并满足度量兼容性条件。这意味着如果我们把 $\\Gamma$ 的公式代入挠率和度量协变导数的定义中，表达式会恒等地化简为零。这种代数上的抵消即使在精确导数 $\\partial_k$ 被线性有限差分算子 $D_k$ 替代时也成立。\n- 计算出的挠率 $T^k_{ij} = \\Gamma^k_{ij} - \\Gamma^k_{ji}$ 将由于实现的公式在 $i$ 和 $j$ 上的显式对称性而为零。\n- 计算出的度量兼容性残差 $\\nabla_k g_{ij}$ 也将由于代数抵消而为零。\n因此，对于所有测试用例，计算出的最大挠率和度量兼容性残差预计仅因浮点表示和算术误差而为非零值，即它们应在机器精度（$\\approx 10^{-16}$）的量级。有限差分方案的数值误差会影响计算出的 $\\Gamma^k_{ij}$ 值相对于其真实解析值的准确性，但它不会破坏由数值方案自身定义的联络的自洽性。\n\n以下是实现此方案的 Python 代码：\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment on the three test cases.\n    \"\"\"\n    \n    def analyze_metric(metric_func, N=64):\n        \"\"\"\n        Computes Christoffel symbols and verifies Levi-Civita properties for a given metric.\n\n        Args:\n            metric_func: A function that takes two (N, N) arrays (x, y coordinates)\n                         and returns the metric tensor g as an (N, N, 2, 2) array.\n            N: The number of grid points in each dimension.\n\n        Returns:\n            A tuple (max_torsion, max_metric_compat_residual).\n        \"\"\"\n        # 1. Grid setup\n        L = 2.0 * np.pi\n        h = L / N\n        coords = np.linspace(0, L, N, endpoint=False)\n        x, y = np.meshgrid(coords, coords, indexing='ij')\n\n        # 2. Metric and its inverse\n        g = metric_func(x, y)  # Shape: (N, N, 2, 2)\n        g_inv = np.linalg.inv(g) # Shape: (N, N, 2, 2)\n\n        # 3. Partial derivatives of the metric using central finite differences\n        # dg[p, q, k, i, j] will store partial_k g_ij at grid point (p, q)\n        dg = np.zeros((N, N, 2, 2, 2))\n        for i in range(2):\n            for j in range(2):\n                g_ij = g[:, :, i, j]\n                # Derivative with respect to x (k=0)\n                dg[:, :, 0, i, j] = (np.roll(g_ij, -1, axis=0) - np.roll(g_ij, 1, axis=0)) / (2 * h)\n                # Derivative with respect to y (k=1)\n                dg[:, :, 1, i, j] = (np.roll(g_ij, -1, axis=1) - np.roll(g_ij, 1, axis=1)) / (2 * h)\n\n        # 4. Compute Christoffel symbols of the first kind (temporary variable)\n        # C[p, q, m, i, j] = partial_i g_mj + partial_j g_mi - partial_m g_ij\n        C = np.zeros((N, N, 2, 2, 2))\n        for m in range(2):\n            for i in range(2):\n                for j in range(2):\n                    C[:, :, m, i, j] = dg[:, :, i, m, j] + dg[:, :, j, m, i] - dg[:, :, m, i, j]\n\n        # 5. Compute Christoffel symbols of the second kind: Gamma^k_ij\n        # Gamma[p, q, k, i, j] = (1/2) * g^{km} * C_{mij}\n        Gamma = 0.5 * np.einsum('pqkm,pqmij->pqkij', g_inv, C, optimize=True)\n\n        # 6. Assess torsion: T^k_ij = Gamma^k_ij - Gamma^k_ji\n        T = Gamma - Gamma.transpose(0, 1, 2, 4, 3)\n        max_torsion = np.max(np.abs(T))\n\n        # 7. Assess metric compatibility: Nabla_k g_ij = partial_k g_ij - Gamma^l_ki g_lj - Gamma^l_kj g_il\n        # Term 2: Gamma^l_ki g_lj\n        term2 = np.einsum('pqlki,pqlj->pqkij', Gamma, g, optimize=True)\n        # Term 3: Gamma^l_kj g_il\n        term3 = np.einsum('pqlkj,pqli->pqkij', Gamma, g, optimize=True)\n        \n        nabla_g = dg - term2 - term3\n        max_nabla_g = np.max(np.abs(nabla_g))\n\n        return max_torsion, max_nabla_g\n\n    # --- Test Case Definitions ---\n\n    def metric1_flat(x, y):\n        g = np.zeros((x.shape[0], x.shape[1], 2, 2))\n        g[:, :, 0, 0] = 1.0\n        g[:, :, 1, 1] = 1.0\n        g[:, :, 0, 1] = 0.0\n        g[:, :, 1, 0] = 0.0\n        return g\n\n    def metric2_conformal(x, y):\n        phi = 0.3 * np.sin(x) * np.cos(y)\n        exp_phi = np.exp(phi)\n        g = np.zeros((x.shape[0], x.shape[1], 2, 2))\n        g[:, :, 0, 0] = exp_phi\n        g[:, :, 1, 1] = exp_phi\n        g[:, :, 0, 1] = 0.0\n        g[:, :, 1, 0] = 0.0\n        return g\n\n    def metric3_anisotropic(x, y):\n        g = np.zeros((x.shape[0], x.shape[1], 2, 2))\n        g[:, :, 0, 0] = 1.0 + 0.2 * np.sin(x)\n        g[:, :, 1, 1] = 1.0 + 0.3 * np.cos(y)\n        g[:, :, 0, 1] = 0.15 * np.cos(x + y)\n        g[:, :, 1, 0] = 0.15 * np.cos(x + y)\n        return g\n\n    test_cases = [\n        metric1_flat,\n        metric2_conformal,\n        metric3_anisotropic,\n    ]\n    \n    results = []\n    for metric_func in test_cases:\n        t_max, m_max = analyze_metric(metric_func)\n        results.extend([t_max, m_max])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "answer": "[0.0,0.0,2.220446049250313e-16,4.440892098500626e-16,2.220446049250313e-16,6.661338147750939e-16]", "id": "2974976"}]}